(self.webpackChunkeveryboard=self.webpackChunkeveryboard||[]).push([[179],{8740:(th,U8,Na)=>{"use strict";function en(n){return"function"==typeof n}function Xr(n){const e=n(r=>{Error.call(r),r.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const h3=Xr(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((r,s)=>`${s+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function gc(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class H1{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const i of e)i.remove(this);else e.remove(this);const{initialTeardown:r}=this;if(en(r))try{r()}catch(i){t=i instanceof h3?i.errors:[i]}const{_finalizers:s}=this;if(s){this._finalizers=null;for(const i of s)try{ln(i)}catch(o){t=t??[],o instanceof h3?t=[...t,...o.errors]:t.push(o)}}if(t)throw new h3(t)}}add(t){var e;if(t&&t!==this)if(this.closed)ln(t);else{if(t instanceof H1){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&gc(e,t)}remove(t){const{_finalizers:e}=this;e&&gc(e,t),t instanceof H1&&t._removeParent(this)}}H1.EMPTY=(()=>{const n=new H1;return n.closed=!0,n})();const A0=H1.EMPTY;function mc(n){return n instanceof H1||n&&"closed"in n&&en(n.remove)&&en(n.add)&&en(n.unsubscribe)}function ln(n){en(n)?n():n.unsubscribe()}const Aa={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},_c={setTimeout(n,t,...e){const{delegate:r}=_c;return r?.setTimeout?r.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=_c;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function d3(n){_c.setTimeout(()=>{const{onUnhandledError:t}=Aa;if(!t)throw n;t(n)})}function Di(){}const $s=O0("C",void 0,void 0);function O0(n,t,e){return{kind:n,value:t,error:e}}let vc=null;function ct(n){if(Aa.useDeprecatedSynchronousErrorHandling){const t=!vc;if(t&&(vc={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:r}=vc;if(vc=null,e)throw r}}else n()}class Yt extends H1{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,mc(t)&&t.add(this)):this.destination=W8}static create(t,e,r){return new er(t,e,r)}next(t){this.isStopped?rh(function nh(n){return O0("N",n,void 0)}(t),this):this._next(t)}error(t){this.isStopped?rh(function d4(n){return O0("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?rh($s,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const n1=Function.prototype.bind;function ws(n,t){return n1.call(n,t)}class yn{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(r){p3(r)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(r){p3(r)}else p3(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){p3(e)}}}class er extends Yt{constructor(t,e,r){let s;if(super(),en(t)||!t)s={next:t??void 0,error:e??void 0,complete:r??void 0};else{let i;this&&Aa.useDeprecatedNextContext?(i=Object.create(t),i.unsubscribe=()=>this.unsubscribe(),s={next:t.next&&ws(t.next,i),error:t.error&&ws(t.error,i),complete:t.complete&&ws(t.complete,i)}):s=t}this.destination=new yn(s)}}function p3(n){Aa.useDeprecatedSynchronousErrorHandling?function rt(n){Aa.useDeprecatedSynchronousErrorHandling&&vc&&(vc.errorThrown=!0,vc.error=n)}(n):d3(n)}function rh(n,t){const{onStoppedNotification:e}=Aa;e&&_c.setTimeout(()=>e(n,t))}const W8={closed:!0,next:Di,error:function G8(n){throw n},complete:Di},dm="function"==typeof Symbol&&Symbol.observable||"@@observable";function p4(n){return n}function pm(n){return 0===n.length?p4:1===n.length?n[0]:function(e){return n.reduce((r,s)=>s(r),e)}}let gr=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const r=new n;return r.source=this,r.operator=e,r}subscribe(e,r,s){const i=function q8(n){return n&&n instanceof Yt||function nP(n){return n&&en(n.next)&&en(n.error)&&en(n.complete)}(n)&&mc(n)}(e)?e:new er(e,r,s);return ct(()=>{const{operator:o,source:c}=this;i.add(o?o.call(i,c):c?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return new(r=sh(r))((s,i)=>{const o=new er({next:c=>{try{e(c)}catch(u){i(u),o.unsubscribe()}},error:i,complete:s});this.subscribe(o)})}_subscribe(e){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(e)}[dm](){return this}pipe(...e){return pm(e)(this)}toPromise(e){return new(e=sh(e))((r,s)=>{let i;this.subscribe(o=>i=o,o=>s(o),()=>r(i))})}}return n.create=t=>new n(t),n})();function sh(n){var t;return null!==(t=n??Aa.Promise)&&void 0!==t?t:Promise}const WV=Xr(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let pi=(()=>{class n extends gr{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const r=new ih(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new WV}next(e){ct(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(e)}})}error(e){ct(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){ct(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:r,isStopped:s,observers:i}=this;return r||s?A0:(this.currentObservers=null,i.push(e),new H1(()=>{this.currentObservers=null,gc(i,e)}))}_checkFinalizedStatuses(e){const{hasError:r,thrownError:s,isStopped:i}=this;r?e.error(s):i&&e.complete()}asObservable(){const e=new gr;return e.source=this,e}}return n.create=(t,e)=>new ih(t,e),n})();class ih extends pi{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===r||r.call(e,t)}error(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===r||r.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,r;return null!==(r=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==r?r:A0}}function gm(n){return en(n?.lift)}function or(n){return t=>{if(gm(t))return t.lift(function(e){try{return n(e,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Qr(n,t,e,r,s){return new rP(n,t,e,r,s)}class rP extends Yt{constructor(t,e,r,s,i,o){super(t),this.onFinalize=i,this.shouldUnsubscribe=o,this._next=e?function(c){try{e(c)}catch(u){t.error(u)}}:super._next,this._error=s?function(c){try{s(c)}catch(u){t.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(c){t.error(c)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function un(n,t){return or((e,r)=>{let s=0;e.subscribe(Qr(r,i=>{r.next(n.call(t,i,s++))}))})}function Z8(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(n);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(e[r[s]]=n[r[s]])}return e}function Hr(n){return this instanceof Hr?(this.v=n,this):new Hr(n)}function L2(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,r=e.apply(n,t||[]),i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(v){r[v]&&(s[v]=function(T){return new Promise(function(I,z){i.push([v,T,I,z])>1||c(v,T)})})}function c(v,T){try{!function u(v){v.value instanceof Hr?Promise.resolve(v.value.v).then(h,g):m(i[0][2],v)}(r[v](T))}catch(I){m(i[0][3],I)}}function h(v){c("next",v)}function g(v){c("throw",v)}function m(v,T){v(T),i.shift(),i.length&&c(i[0][0],i[0][1])}}function uP(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n=function vm(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(i){e[i]=n[i]&&function(o){return new Promise(function(c,u){!function s(i,o,c,u){Promise.resolve(u).then(function(h){i({value:h,done:c})},o)}(c,u,(o=n[i](o)).done,o.value)})}}}const Mm=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Sm(n){return en(n?.then)}function ch(n){return en(n[dm])}function Pm(n){return Symbol.asyncIterator&&en(n?.[Symbol.asyncIterator])}function Oa(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const S1=function I0(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Ia(n){return en(n?.[S1])}function Zo(n){return L2(this,arguments,function*(){const e=n.getReader();try{for(;;){const{value:r,done:s}=yield Hr(e.read());if(s)return yield Hr(void 0);yield yield Hr(r)}}finally{e.releaseLock()}})}function Tm(n){return en(n?.getReader)}function mo(n){if(n instanceof gr)return n;if(null!=n){if(ch(n))return function g4(n){return new gr(t=>{const e=n[dm]();if(en(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(Mm(n))return function k2(n){return new gr(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}(n);if(Sm(n))return function wm(n){return new gr(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,d3)})}(n);if(Pm(n))return m4(n);if(Ia(n))return function fP(n){return new gr(t=>{for(const e of n)if(t.next(e),t.closed)return;t.complete()})}(n);if(Tm(n))return function lh(n){return m4(Zo(n))}(n)}throw Oa(n)}function m4(n){return new gr(t=>{(function hP(n,t){var e,r,s,i;return function oP(n,t,e,r){return new(e||(e=Promise))(function(i,o){function c(g){try{h(r.next(g))}catch(m){o(m)}}function u(g){try{h(r.throw(g))}catch(m){o(m)}}function h(g){g.done?i(g.value):function s(i){return i instanceof e?i:new e(function(o){o(i)})}(g.value).then(c,u)}h((r=r.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=uP(n);!(r=yield e.next()).done;)if(t.next(r.value),t.closed)return}catch(o){s={error:o}}finally{try{r&&!r.done&&(i=e.return)&&(yield i.call(e))}finally{if(s)throw s.error}}t.complete()})})(n,t).catch(e=>t.error(e))})}function bs(n,t,e,r=0,s=!1){const i=t.schedule(function(){e(),s?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(i),!s)return i}function Le(n,t,e=1/0){return en(t)?Le((r,s)=>un((i,o)=>t(r,i,s,o))(mo(n(r,s))),e):("number"==typeof t&&(e=t),or((r,s)=>function _o(n,t,e,r,s,i,o,c){const u=[];let h=0,g=0,m=!1;const v=()=>{m&&!u.length&&!h&&t.complete()},T=z=>h<r?I(z):u.push(z),I=z=>{i&&t.next(z),h++;let Z=!1;mo(e(z,g++)).subscribe(Qr(t,te=>{s?.(te),i?T(te):t.next(te)},()=>{Z=!0},void 0,()=>{if(Z)try{for(h--;u.length&&h<r;){const te=u.shift();o?bs(t,o,()=>I(te)):I(te)}v()}catch(te){t.error(te)}}))};return n.subscribe(Qr(t,T,()=>{m=!0,v()})),()=>{c?.()}}(r,s,n,e)))}function _4(n=1/0){return Le(p4,n)}const xa=new gr(n=>n.complete());function v4(n){return n[n.length-1]}function jt(n){return en(v4(n))?n.pop():void 0}function g3(n){return function zl(n){return n&&en(n.schedule)}(v4(n))?n.pop():void 0}function C4(n,t=0){return or((e,r)=>{e.subscribe(Qr(r,s=>bs(r,n,()=>r.next(s),t),()=>bs(r,n,()=>r.complete(),t),s=>bs(r,n,()=>r.error(s),t)))})}function La(n,t=0){return or((e,r)=>{r.add(n.schedule(()=>e.subscribe(r),t))})}function X8(n,t){if(!n)throw new Error("Iterable cannot be null");return new gr(e=>{bs(e,t,()=>{const r=n[Symbol.asyncIterator]();bs(e,t,()=>{r.next().then(s=>{s.done?e.complete():e.next(s.value)})},0,!0)})})}function Jr(n,t){return t?function x0(n,t){if(null!=n){if(ch(n))return function K8(n,t){return mo(n).pipe(La(t),C4(t))}(n,t);if(Mm(n))return function Co(n,t){return new gr(e=>{let r=0;return t.schedule(function(){r===n.length?e.complete():(e.next(n[r++]),e.closed||this.schedule())})})}(n,t);if(Sm(n))return function Vl(n,t){return mo(n).pipe(La(t),C4(t))}(n,t);if(Pm(n))return X8(n,t);if(Ia(n))return function uh(n,t){return new gr(e=>{let r;return bs(e,t,()=>{r=n[S1](),bs(e,t,()=>{let s,i;try{({value:s,done:i}=r.next())}catch(o){return void e.error(o)}i?e.complete():e.next(s)},0,!0)}),()=>en(r?.return)&&r.return()})}(n,t);if(Tm(n))return function Hl(n,t){return X8(Zo(n),t)}(n,t)}throw Oa(n)}(n,t):mo(n)}function Q8(n,t,...e){if(!0===t)return void n();if(!1===t)return;const r=new er({next:()=>{r.unsubscribe(),n()}});return t(...e).subscribe(r)}function g1(n){for(let t in n)if(n[t]===g1)return t;throw Error("Could not find renamed property on target object.")}function fh(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function F1(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(F1).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function L0(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const Nm=g1({__forward_ref__:g1});function m1(n){return n.__forward_ref__=m1,n.toString=function(){return F1(this())},n}function Kt(n){return Fl(n)?n():n}function Fl(n){return"function"==typeof n&&n.hasOwnProperty(Nm)&&n.__forward_ref__===m1}class Te extends Error{constructor(t,e){super(function Cc(n,t){return`NG0${Math.abs(n)}${t?": "+t.trim():""}`}(t,e)),this.code=t}}function Xt(n){return"string"==typeof n?n:null==n?"":String(n)}function $l(n,t){throw new Te(-201,!1)}function _1(n,t,e,r){throw new Error(`ASSERTION ERROR: ${n}`+(null==r?"":` [Expected=> ${e} ${r} ${t} <=Actual]`))}function Xe(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Fr(n){return{providers:n.providers||[],imports:n.imports||[]}}function Tn(n){return xm(n,Ul)||xm(n,gh)}function xm(n,t){return n.hasOwnProperty(t)?n[t]:null}function D0(n){return n&&(n.hasOwnProperty(_e)||n.hasOwnProperty(mh))?n[_e]:null}const Ul=g1({\u0275prov:g1}),_e=g1({\u0275inj:g1}),gh=g1({ngInjectableDef:g1}),mh=g1({ngInjectorDef:g1});var $t=(()=>(($t=$t||{})[$t.Default=0]="Default",$t[$t.Host=1]="Host",$t[$t.Self=2]="Self",$t[$t.SkipSelf=4]="SkipSelf",$t[$t.Optional=8]="Optional",$t))();let _h;function yo(n){const t=_h;return _h=n,t}function vh(n,t,e){const r=Tn(n);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:e&$t.Optional?null:void 0!==t?t:void $l(F1(n))}function v3(n){return{toString:n}.toString()}var _i=(()=>((_i=_i||{})[_i.OnPush=0]="OnPush",_i[_i.Default=1]="Default",_i))(),O1=(()=>{return(n=O1||(O1={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",O1;var n})();const G1=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),j={},p1=[],n5=g1({\u0275cmp:g1}),Ch=g1({\u0275dir:g1}),yh=g1({\u0275pipe:g1}),z0=g1({\u0275mod:g1}),yc=g1({\u0275fac:g1}),Ec=g1({__NG_ELEMENT_ID__:g1});let vP=0;function vt(n){return v3(()=>{const e=!0===n.standalone,r={},s={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===_i.OnPush,directiveDefs:null,pipeDefs:null,standalone:e,dependencies:e&&n.dependencies||null,getStandaloneInjector:null,selectors:n.selectors||p1,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||O1.Emulated,id:"c"+vP++,styles:n.styles||p1,_:null,setInput:null,schemas:n.schemas||null,tView:null},i=n.dependencies,o=n.features;return s.inputs=Mh(n.inputs,r),s.outputs=Mh(n.outputs),o&&o.forEach(c=>c(s)),s.directiveDefs=i?()=>("function"==typeof i?i():i).map(Eh).filter(s5):null,s.pipeDefs=i?()=>("function"==typeof i?i():i).map(D2).filter(s5):null,s})}function Eh(n){return v1(n)||R2(n)}function s5(n){return null!==n}function qs(n){return v3(()=>({type:n.type,bootstrap:n.bootstrap||p1,declarations:n.declarations||p1,imports:n.imports||p1,exports:n.exports||p1,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Mh(n,t){if(null==n)return j;const e={};for(const r in n)if(n.hasOwnProperty(r)){let s=n[r],i=s;Array.isArray(s)&&(i=s[1],s=s[0]),e[s]=r,t&&(t[s]=i)}return e}const Ht=vt;function js(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function v1(n){return n[n5]||null}function R2(n){return n[Ch]||null}function D2(n){return n[yh]||null}function Vi(n,t){const e=n[z0]||null;if(!e&&!0===t)throw new Error(`Type ${F1(n)} does not have '\u0275mod' property.`);return e}function Hi(n){return Array.isArray(n)&&"object"==typeof n[1]}function mr(n){return Array.isArray(n)&&!0===n[1]}function Ci(n){return 0!=(8&n.flags)}function Po(n){return 2==(2&n.flags)}function To(n){return 1==(1&n.flags)}function ds(n){return null!==n.template}function Zl(n){return 0!=(256&n[2])}function Ko(n,t){return n.hasOwnProperty(yc)?n[yc]:null}class EP{constructor(t,e,r){this.previousValue=t,this.currentValue=e,this.firstChange=r}isFirstChange(){return this.firstChange}}function H2(){return Vm}function Vm(n){return n.type.prototype.ngOnChanges&&(n.setInput=Hm),MP}function MP(){const n=u5(this),t=n?.current;if(t){const e=n.previous;if(e===j)n.previous=t;else for(let r in t)e[r]=t[r];n.current=null,this.ngOnChanges(t)}}function Hm(n,t,e,r){const s=u5(n)||function SP(n,t){return n[Fm]=t}(n,{previous:j,current:null}),i=s.current||(s.current={}),o=s.previous,c=this.declaredInputs[e],u=o[c];i[c]=new EP(u&&u.currentValue,t,o===j),n[r]=t}H2.ngInherit=!0;const Fm="__ngSimpleChanges__";function u5(n){return n[Fm]||null}function _r(n){for(;Array.isArray(n);)n=n[0];return n}function F0(n,t){return _r(t[n])}function F2(n,t){return _r(t[n.index])}function bh(n,t){return n.data[t]}function M4(n,t){return n[t]}function m2(n,t){const e=t[n];return Hi(e)?e:e[0]}function Xl(n){return 64==(64&n[2])}function Sc(n,t){return null==t?null:n[t]}function Gm(n){n[18]=0}function Nh(n,t){n[5]+=t;let e=n,r=n[3];for(;null!==r&&(1===t&&1===e[5]||-1===t&&0===e[5]);)r[5]+=t,e=r,r=r[3]}const tn={lFrame:Rh(null),bindingsEnabled:!0};function Ah(){return tn.bindingsEnabled}function Oe(){return tn.lFrame.lView}function qn(){return tn.lFrame.tView}function he(n){return tn.lFrame.contextLView=n,n[8]}function ce(n){return tn.lFrame.contextLView=null,n}function Or(){let n=Wm();for(;null!==n&&64===n.type;)n=n.parent;return n}function Wm(){return tn.lFrame.currentTNode}function S4(){const n=tn.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}function ka(n,t){const e=tn.lFrame;e.currentTNode=n,e.isParent=t}function Br(){return tn.lFrame.isParent}function Oh(){tn.lFrame.isParent=!1}function _2(){const n=tn.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function Ra(){return tn.lFrame.bindingIndex}function Jl(){return tn.lFrame.bindingIndex++}function bo(n){const t=tn.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function B2(n){tn.lFrame.inI18n=n}function LP(n,t){const e=tn.lFrame;e.bindingIndex=e.bindingRootIndex=n,Pc(t)}function Pc(n){tn.lFrame.currentDirectiveIndex=n}function Lh(){return tn.lFrame.currentQueryIndex}function $0(n){tn.lFrame.currentQueryIndex=n}function jm(n){const t=n[1];return 2===t.type?t.declTNode:1===t.type?n[6]:null}function m5(n,t,e){if(e&$t.SkipSelf){let s=t,i=n;for(;!(s=s.parent,null!==s||e&$t.Host||(s=jm(i),null===s||(i=i[15],10&s.type))););if(null===s)return!1;t=s,n=i}const r=tn.lFrame=kh();return r.currentTNode=t,r.lView=n,!0}function P4(n){const t=kh(),e=n[1];tn.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function kh(){const n=tn.lFrame,t=null===n?null:n.child;return null===t?Rh(n):t}function Rh(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function Zm(){const n=tn.lFrame;return tn.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const U0=Zm;function T4(){const n=Zm();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function $2(){return tn.lFrame.selectedIndex}function Tc(n){tn.lFrame.selectedIndex=n}function C1(){const n=tn.lFrame;return bh(n.tView,n.selectedIndex)}function B(){tn.lFrame.currentNamespace="svg"}function Nc(n,t){for(let e=t.directiveStart,r=t.directiveEnd;e<r;e++){const i=n.data[e].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:c,ngAfterViewInit:u,ngAfterViewChecked:h,ngOnDestroy:g}=i;o&&(n.contentHooks||(n.contentHooks=[])).push(-e,o),c&&((n.contentHooks||(n.contentHooks=[])).push(e,c),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(e,c)),u&&(n.viewHooks||(n.viewHooks=[])).push(-e,u),h&&((n.viewHooks||(n.viewHooks=[])).push(e,h),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(e,h)),null!=g&&(n.destroyHooks||(n.destroyHooks=[])).push(e,g)}}function Xo(n,t,e){Ym(n,t,3,e)}function W0(n,t,e,r){(3&n[2])===e&&Ym(n,t,e,r)}function q0(n,t){let e=n[2];(3&e)===t&&(e&=2047,e+=1,n[2]=e)}function Ym(n,t,e,r){const i=r??-1,o=t.length-1;let c=0;for(let u=void 0!==r?65535&n[18]:0;u<o;u++)if("number"==typeof t[u+1]){if(c=t[u],null!=r&&c>=r)break}else t[u]<0&&(n[18]+=65536),(c<i||-1==i)&&(Km(n,e,t,u),n[18]=(4294901760&n[18])+u+2),u++}function Km(n,t,e,r){const s=e[r]<0,i=e[r+1],c=n[s?-e[r]:e[r]];if(s){if(n[2]>>11<n[18]>>16&&(3&n[2])===t){n[2]+=2048;try{i.call(c)}finally{}}}else try{i.call(c)}finally{}}class j0{constructor(t,e,r){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=r}}function Da(n,t,e){let r=0;for(;r<e.length;){const s=e[r];if("number"==typeof s){if(0!==s)break;r++;const i=e[r++],o=e[r++],c=e[r++];n.setAttribute(t,o,c,i)}else{const i=s,o=e[++r];Jm(i)?n.setProperty(t,i,o):n.setAttribute(t,i,o),r++}}return r}function Qm(n){return 3===n||4===n||6===n}function Jm(n){return 64===n.charCodeAt(0)}function n6(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let r=0;r<t.length;r++){const s=t[r];"number"==typeof s?e=s:0===e||zh(n,e,s,null,-1===e||2===e?t[++r]:null)}}return n}function zh(n,t,e,r,s){let i=0,o=n.length;if(-1===t)o=-1;else for(;i<n.length;){const c=n[i++];if("number"==typeof c){if(c===t){o=-1;break}if(c>t){o=i-1;break}}}for(;i<n.length;){const c=n[i];if("number"==typeof c)break;if(c===e){if(null===r)return void(null!==s&&(n[i+1]=s));if(r===n[i+1])return void(n[i+2]=s)}i++,null!==r&&i++,null!==s&&i++}-1!==o&&(n.splice(o,0,t),i=o+1),n.splice(i++,0,e),null!==r&&n.splice(i++,0,r),null!==s&&n.splice(i++,0,s)}function Vh(n){return-1!==n}function b4(n){return 32767&n}function N4(n,t){let e=function e_(n){return n>>16}(n),r=t;for(;e>0;)r=r[15],e--;return r}let v5=!0;function P3(n){const t=v5;return v5=n,t}let t_=0;const Ac={};function C5(n,t){const e=Y0(n,t);if(-1!==e)return e;const r=t[1];r.firstCreatePass&&(n.injectorIndex=t.length,Fh(r.data,n),Fh(t,null),Fh(r.blueprint,null));const s=Jo(n,t),i=n.injectorIndex;if(Vh(s)){const o=b4(s),c=N4(s,t),u=c[1].data;for(let h=0;h<8;h++)t[i+h]=c[o+h]|u[o+h]}return t[i+8]=s,i}function Fh(n,t){n.push(0,0,0,0,0,0,0,0,t)}function Y0(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function Jo(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,r=null,s=t;for(;null!==s;){if(r=s_(s),null===r)return-1;if(e++,s=s[15],-1!==r.injectorIndex)return r.injectorIndex|e<<16}return-1}function r6(n,t,e){!function lH(n,t,e){let r;"string"==typeof e?r=e.charCodeAt(0)||0:e.hasOwnProperty(Ec)&&(r=e[Ec]),null==r&&(r=e[Ec]=t_++);const s=255&r;t.data[n+(s>>5)]|=1<<s}(n,t,e)}function Bh(n,t,e){if(e&$t.Optional||void 0!==n)return n;$l()}function $h(n,t,e,r){if(e&$t.Optional&&void 0===r&&(r=null),0==(e&($t.Self|$t.Host))){const s=n[9],i=yo(void 0);try{return s?s.get(t,r,e&$t.Optional):vh(t,r,e&$t.Optional)}finally{yo(i)}}return Bh(r,0,e)}function y5(n,t,e,r=$t.Default,s){if(null!==n){if(1024&t[2]){const o=function E5(n,t,e,r,s){let i=n,o=t;for(;null!==i&&null!==o&&1024&o[2]&&!(256&o[2]);){const c=T3(i,o,e,r|$t.Self,Ac);if(c!==Ac)return c;let u=i.parent;if(!u){const h=o[21];if(h){const g=h.get(e,Ac,r);if(g!==Ac)return g}u=s_(o),o=o[15]}i=u}return s}(n,t,e,r,Ac);if(o!==Ac)return o}const i=T3(n,t,e,r,Ac);if(i!==Ac)return i}return $h(t,e,r,s)}function T3(n,t,e,r,s){const i=function K0(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty(Ec)?n[Ec]:void 0;return"number"==typeof t?t>=0?255&t:i6:t}(e);if("function"==typeof i){if(!m5(t,n,r))return r&$t.Host?Bh(s,0,r):$h(t,e,r,s);try{const o=i(r);if(null!=o||r&$t.Optional)return o;$l()}finally{U0()}}else if("number"==typeof i){let o=null,c=Y0(n,t),u=-1,h=r&$t.Host?t[16][6]:null;for((-1===c||r&$t.SkipSelf)&&(u=-1===c?Jo(n,t):t[c+8],-1!==u&&r_(r,!1)?(o=t[1],c=b4(u),t=N4(u,t)):c=-1);-1!==c;){const g=t[1];if(n_(i,c,g.data)){const m=Uh(c,t,e,o,r,h);if(m!==Ac)return m}u=t[c+8],-1!==u&&r_(r,t[1].data[c+8]===h)&&n_(i,c,t)?(o=g,c=b4(u),t=N4(u,t)):c=-1}}return s}function Uh(n,t,e,r,s,i){const o=t[1],c=o.data[n+8],g=$r(c,o,e,null==r?Po(c)&&v5:r!=o&&0!=(3&c.type),s&$t.Host&&i===c);return null!==g?Ns(t,o,g,c):Ac}function $r(n,t,e,r,s){const i=n.providerIndexes,o=t.data,c=1048575&i,u=n.directiveStart,g=i>>20,v=s?c+g:n.directiveEnd;for(let T=r?c:c+g;T<v;T++){const I=o[T];if(T<u&&e===I||T>=u&&I.type===e)return T}if(s){const T=o[u];if(T&&ds(T)&&T.type===e)return u}return null}function Ns(n,t,e,r){let s=n[e];const i=t.data;if(function kP(n){return n instanceof j0}(s)){const o=s;o.resolving&&function k0(n,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${n}`:"";throw new Te(-200,`Circular dependency in DI detected for ${n}${e}`)}(function Lt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Xt(n)}(i[e]));const c=P3(o.canSeeViewProviders);o.resolving=!0;const u=o.injectImpl?yo(o.injectImpl):null;m5(n,r,$t.Default);try{s=n[e]=o.factory(void 0,i,n,r),t.firstCreatePass&&e>=r.directiveStart&&function t6(n,t,e){const{ngOnChanges:r,ngOnInit:s,ngDoCheck:i}=t.type.prototype;if(r){const o=Vm(t);(e.preOrderHooks||(e.preOrderHooks=[])).push(n,o),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,o)}s&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-n,s),i&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n,i),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,i))}(e,i[e],t)}finally{null!==u&&yo(u),P3(c),o.resolving=!1,U0()}}return s}function n_(n,t,e){return!!(e[t+(n>>5)]&1<<n)}function r_(n,t){return!(n&$t.Self||n&$t.Host&&t)}class s6{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,r){return y5(this._tNode,this._lView,t,r,e)}}function i6(){return new s6(Or(),Oe())}function es(n){return v3(()=>{const t=n.prototype.constructor,e=t[yc]||Gh(t),r=Object.prototype;let s=Object.getPrototypeOf(n.prototype).constructor;for(;s&&s!==r;){const i=s[yc]||Gh(s);if(i&&i!==e)return i;s=Object.getPrototypeOf(s)}return i=>new i})}function Gh(n){return Fl(n)?()=>{const t=Gh(Kt(n));return t&&t()}:Ko(n)}function s_(n){const t=n[1],e=t.type;return 2===e?t.declTNode:1===e?n[6]:null}function X0(n){return function DP(n,t){if("class"===t)return n.classes;if("style"===t)return n.styles;const e=n.attrs;if(e){const r=e.length;let s=0;for(;s<r;){const i=e[s];if(Qm(i))break;if(0===i)s+=2;else if("number"==typeof i)for(s++;s<r&&"string"==typeof e[s];)s++;else{if(i===t)return e[s+1];s+=2}}}return null}(Or(),n)}const o6="__parameters__";function I4(n,t,e){return v3(()=>{const r=function M5(n){return function(...e){if(n){const r=n(...e);for(const s in r)this[s]=r[s]}}}(t);function s(...i){if(this instanceof s)return r.apply(this,i),this;const o=new s(...i);return c.annotation=o,c;function c(u,h,g){const m=u.hasOwnProperty(o6)?u[o6]:Object.defineProperty(u,o6,{value:[]})[o6];for(;m.length<=g;)m.push(null);return(m[g]=m[g]||[]).push(o),u}}return e&&(s.prototype=Object.create(e.prototype)),s.prototype.ngMetadataName=n,s.annotationCls=s,s})}class It{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=Xe({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function U2(n,t){void 0===t&&(t=n);for(let e=0;e<n.length;e++){let r=n[e];Array.isArray(r)?(t===n&&(t=n.slice(0,e)),U2(r,t)):t!==n&&t.push(r)}return t}function ea(n,t){n.forEach(e=>Array.isArray(e)?ea(e,t):t(e))}function Oc(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function l6(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function x4(n,t){const e=[];for(let r=0;r<n;r++)e.push(t);return e}function G2(n,t,e){let r=W2(n,t);return r>=0?n[1|r]=e:(r=~r,function qh(n,t,e,r){let s=n.length;if(s==t)n.push(e,r);else if(1===s)n.push(r,n[0]),n[0]=e;else{for(s--,n.push(n[s-1],n[s]);s>t;)n[s]=n[s-2],s--;n[t]=e,n[t+1]=r}}(n,r,t,e)),r}function Zs(n,t){const e=W2(n,t);if(e>=0)return n[1|e]}function W2(n,t){return function T5(n,t,e){let r=0,s=n.length>>e;for(;s!==r;){const i=r+(s-r>>1),o=n[i<<e];if(t===o)return i<<e;o>t?s=i:r=i+1}return~(s<<e)}(n,t,1)}const tu={},nu="__NG_DI_FLAG__",Ys="ngTempTokenPath",FP=/\n/gm,N5="__source";let ru;function f6(n){const t=ru;return ru=n,t}function BP(n,t=$t.Default){if(void 0===ru)throw new Te(-203,!1);return null===ru?vh(n,void 0,t):ru.get(n,t&$t.Optional?null:void 0,t)}function xe(n,t=$t.Default){return(function QV(){return _h}()||BP)(Kt(n),t)}function Ir(n,t=$t.Default){return"number"!=typeof t&&(t=0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)),xe(n,t)}function Xh(n){const t=[];for(let e=0;e<n.length;e++){const r=Kt(n[e]);if(Array.isArray(r)){if(0===r.length)throw new Te(900,!1);let s,i=$t.Default;for(let o=0;o<r.length;o++){const c=r[o],u=f_(c);"number"==typeof u?-1===u?s=c.token:i|=u:s=c}t.push(xe(s,i))}else t.push(xe(r))}return t}function L4(n,t){return n[nu]=t,n.prototype[nu]=t,n}function f_(n){return n[nu]}const Ks=L4(I4("Optional"),8),su=L4(I4("SkipSelf"),4);let id,O5,I5;function d_(){return void 0!==id?id:typeof document<"u"?document:void 0}function N3(n){return function od(){if(void 0===O5&&(O5=null,G1.trustedTypes))try{O5=G1.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return O5}()?.createHTML(n)||n}function x5(n){return function ad(){if(void 0===I5&&(I5=null,G1.trustedTypes))try{I5=G1.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return I5}()?.createHTML(n)||n}class A3{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class JP extends A3{getTypeName(){return"HTML"}}class eT extends A3{getTypeName(){return"Style"}}class tT extends A3{getTypeName(){return"Script"}}class g_ extends A3{getTypeName(){return"URL"}}class m_ extends A3{getTypeName(){return"ResourceURL"}}function Bi(n){return n instanceof A3?n.changingThisBreaksApplicationSecurity:n}function $i(n,t){const e=function __(n){return n instanceof A3&&n.getTypeName()||null}(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===t}function y_(n){const t=new xt(n);return function iT(){try{return!!(new window.DOMParser).parseFromString(N3(""),"text/html")}catch{return!1}}()?new E_(t):t}class E_{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(N3(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch{return null}}}class xt{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const r=this.inertDocument.createElement("body");e.appendChild(r)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=N3(t),e;const r=this.inertDocument.createElement("body");return r.innerHTML=N3(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(r),r}stripCustomNsAttrs(t){const e=t.attributes;for(let s=e.length-1;0<s;s--){const o=e.item(s).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&t.removeAttribute(o)}let r=t.firstChild;for(;r;)r.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(r),r=r.nextSibling}}const M_=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function Io(n){return(n=String(n)).match(M_)?n:"unsafe:"+n}function Va(n){const t={};for(const e of n.split(","))t[e]=!0;return t}function au(...n){const t={};for(const e of n)for(const r in e)e.hasOwnProperty(r)&&(t[r]=!0);return t}const S_=Va("area,br,col,hr,img,wbr"),P_=Va("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),L5=Va("rp,rt"),cu=au(S_,au(P_,Va("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),au(L5,Va("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),au(L5,P_)),k5=Va("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),R5=au(k5,Va("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Va("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),oT=Va("script,style,template");class aT{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,r=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?r=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,r&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let s=this.checkClobberedElement(e,e.nextSibling);if(s){e=s;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!cu.hasOwnProperty(e))return this.sanitizedSomething=!0,!oT.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const r=t.attributes;for(let s=0;s<r.length;s++){const i=r.item(s),o=i.name,c=o.toLowerCase();if(!R5.hasOwnProperty(c)){this.sanitizedSomething=!0;continue}let u=i.value;k5[c]&&(u=Io(u)),this.buf.push(" ",o,'="',w_(u),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();cu.hasOwnProperty(e)&&!S_.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(w_(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const cT=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,lT=/([^\#-~ |!])/g;function w_(n){return n.replace(/&/g,"&amp;").replace(cT,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(lT,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let D5;function ld(n,t){let e=null;try{D5=D5||y_(n);let r=t?String(t):"";e=D5.getInertBodyElement(r);let s=5,i=r;do{if(0===s)throw new Error("Failed to sanitize html because the input is unstable");s--,r=i,i=e.innerHTML,e=D5.getInertBodyElement(r)}while(r!==i);return N3((new aT).sanitizeChildren(Ui(e)||e))}finally{if(e){const r=Ui(e)||e;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function Ui(n){return"content"in n&&function lu(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var W1=(()=>((W1=W1||{})[W1.NONE=0]="NONE",W1[W1.HTML=1]="HTML",W1[W1.STYLE=2]="STYLE",W1[W1.SCRIPT=3]="SCRIPT",W1[W1.URL=4]="URL",W1[W1.RESOURCE_URL=5]="RESOURCE_URL",W1))();function ud(n){const t=g6();return t?x5(t.sanitize(W1.HTML,n)||""):$i(n,"HTML")?x5(Bi(n)):ld(d_(),Xt(n))}function Ic(n){const t=g6();return t?t.sanitize(W1.URL,n)||"":$i(n,"URL")?Bi(n):Io(Xt(n))}function g6(){const n=Oe();return n&&n[12]}const du=new It("ENVIRONMENT_INITIALIZER"),N_=new It("INJECTOR",-1),A_=new It("INJECTOR_DEF_TYPES");class O_{get(t,e=tu){if(e===tu){const r=new Error(`NullInjectorError: No provider for ${F1(t)}!`);throw r.name="NullInjectorError",r}return e}}function pu(...n){return{\u0275providers:hd(0,n)}}function hd(n,...t){const e=[],r=new Set;let s;return ea(t,i=>{const o=i;xc(o,e,[],r)&&(s||(s=[]),s.push(o))}),void 0!==s&&I_(s,e),e}function I_(n,t){for(let e=0;e<n.length;e++){const{providers:s}=n[e];ea(s,i=>{t.push(i)})}}function xc(n,t,e,r){if(!(n=Kt(n)))return!1;let s=null,i=D0(n);const o=!i&&v1(n);if(i||o){if(o&&!o.standalone)return!1;s=n}else{const u=n.ngModule;if(i=D0(u),!i)return!1;s=u}const c=r.has(s);if(o){if(c)return!1;if(r.add(s),o.dependencies){const u="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const h of u)xc(h,t,e,r)}}else{if(!i)return!1;{if(null!=i.imports&&!c){let h;r.add(s);try{ea(i.imports,g=>{xc(g,t,e,r)&&(h||(h=[]),h.push(g))})}finally{}void 0!==h&&I_(h,t)}if(!c){const h=Ko(s)||(()=>new s);t.push({provide:s,useFactory:h,deps:p1},{provide:A_,useValue:s,multi:!0},{provide:du,useValue:()=>xe(s),multi:!0})}const u=i.providers;null==u||c||ea(u,g=>{t.push(g)})}}return s!==n&&void 0!==n.providers}const uT=g1({provide:String,useValue:g1});function q2(n){return null!==n&&"object"==typeof n&&uT in n}function D4(n){return"function"==typeof n}const pd=new It("Set Injector scope."),V5={},k_={};let gd;function O3(){return void 0===gd&&(gd=new O_),gd}class na{}class H5 extends na{constructor(t,e,r,s){super(),this.parent=e,this.source=r,this.scopes=s,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,B5(t,o=>this.processProvider(o)),this.records.set(N_,z4(void 0,this)),s.has("environment")&&this.records.set(na,z4(void 0,this));const i=this.records.get(pd);null!=i&&"string"==typeof i.value&&this.scopes.add(i.value),this.injectorDefTypes=new Set(this.get(A_.multi,p1,$t.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();for(const t of this._onDestroyHooks)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(t){this._onDestroyHooks.push(t)}runInContext(t){this.assertNotDestroyed();const e=f6(this),r=yo(void 0);try{return t()}finally{f6(e),yo(r)}}get(t,e=tu,r=$t.Default){this.assertNotDestroyed();const s=f6(this),i=yo(void 0);try{if(!(r&$t.SkipSelf)){let c=this.records.get(t);if(void 0===c){const u=function z_(n){return"function"==typeof n||"object"==typeof n&&n instanceof It}(t)&&Tn(t);c=u&&this.injectableDefInScope(u)?z4(Gi(t),V5):null,this.records.set(t,c)}if(null!=c)return this.hydrate(t,c)}return(r&$t.Self?O3():this.parent).get(t,e=r&$t.Optional&&e===tu?null:e)}catch(o){if("NullInjectorError"===o.name){if((o[Ys]=o[Ys]||[]).unshift(F1(t)),s)throw o;return function $P(n,t,e,r){const s=n[Ys];throw t[N5]&&s.unshift(t[N5]),n.message=function Hn(n,t,e,r=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let s=F1(t);if(Array.isArray(t))s=t.map(F1).join(" -> ");else if("object"==typeof t){let i=[];for(let o in t)if(t.hasOwnProperty(o)){let c=t[o];i.push(o+":"+("string"==typeof c?JSON.stringify(c):F1(c)))}s=`{${i.join(", ")}}`}return`${e}${r?"("+r+")":""}[${s}]: ${n.replace(FP,"\n  ")}`}("\n"+n.message,s,e,r),n.ngTokenPath=s,n[Ys]=null,n}(o,t,"R3InjectorError",this.source)}throw o}finally{yo(i),f6(s)}}resolveInjectorInitializers(){const t=f6(this),e=yo(void 0);try{const r=this.get(du.multi,p1,$t.Self);for(const s of r)s()}finally{f6(t),yo(e)}}toString(){const t=[],e=this.records;for(const r of e.keys())t.push(F1(r));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Te(205,!1)}processProvider(t){let e=D4(t=Kt(t))?t:Kt(t&&t.provide);const r=function hT(n){return q2(n)?z4(void 0,n.useValue):z4(F5(n),V5)}(t);if(D4(t)||!0!==t.multi)this.records.get(e);else{let s=this.records.get(e);s||(s=z4(void 0,V5,!0),s.factory=()=>Xh(s.multi),this.records.set(e,s)),e=t,s.multi.push(t)}this.records.set(e,r)}hydrate(t,e){return e.value===V5&&(e.value=k_,e.value=e.factory()),"object"==typeof e.value&&e.value&&function D_(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=Kt(t.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function Gi(n){const t=Tn(n),e=null!==t?t.factory:Ko(n);if(null!==e)return e;if(n instanceof It)throw new Te(204,!1);if(n instanceof Function)return function gu(n){const t=n.length;if(t>0)throw x4(t,"?"),new Te(204,!1);const e=function Lm(n){const t=n&&(n[Ul]||n[gh]);if(t){const e=function Ws(n){if(n.hasOwnProperty("name"))return n.name;const t=(""+n).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),t}return null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new Te(204,!1)}function F5(n,t,e){let r;if(D4(n)){const s=Kt(n);return Ko(s)||Gi(s)}if(q2(n))r=()=>Kt(n.useValue);else if(function L_(n){return!(!n||!n.useFactory)}(n))r=()=>n.useFactory(...Xh(n.deps||[]));else if(function dd(n){return!(!n||!n.useExisting)}(n))r=()=>xe(Kt(n.useExisting));else{const s=Kt(n&&(n.useClass||n.provide));if(!function R_(n){return!!n.deps}(n))return Ko(s)||Gi(s);r=()=>new s(...Xh(n.deps))}return r}function z4(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function dT(n){return!!n.\u0275providers}function B5(n,t){for(const e of n)Array.isArray(e)?B5(e,t):dT(e)?B5(e.\u0275providers,t):t(e)}class V_{}class _T{resolveComponentFactory(t){throw function gT(n){const t=Error(`No component factory found for ${F1(n)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=n,t}(t)}}let ra=(()=>{class n{}return n.NULL=new _T,n})();function EH(){return m6(Or(),Oe())}function m6(n,t){return new j2(F2(n,t))}let j2=(()=>{class n{constructor(e){this.nativeElement=e}}return n.__NG_ELEMENT_ID__=EH,n})();function $5(n){return n instanceof j2?n.nativeElement:n}class _6{}let Wi=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function vT(){const n=Oe(),e=m2(Or().index,n);return(Hi(e)?e:n)[11]}(),n})(),MH=(()=>{class n{}return n.\u0275prov=Xe({token:n,providedIn:"root",factory:()=>null}),n})();class v6{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const H_=new v6("14.2.10"),vd={};function yd(n){return n.ngOriginalError}class C6{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t);this._console.error("ERROR",t),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&yd(t);for(;e&&yd(e);)e=yd(e);return e||null}}const bT=/^>|^->|<!--|-->|--!>|<!-$/g,NT=/(<|>)/;const Ed=new Map;let U_=0;const q5="__ngContext__";function E2(n,t){Hi(t)?(n[q5]=t[20],function kT(n){Ed.set(n[20],n)}(t)):n[q5]=t}function sa(n){return n instanceof Function?n():n}var Y2=(()=>((Y2=Y2||{})[Y2.Important=1]="Important",Y2[Y2.DashCase=2]="DashCase",Y2))();let Pd;function Td(n,t){return Pd(n,t)}function vu(n){const t=n[3];return mr(t)?t[3]:t}function wd(n){return Ha(n[13])}function bd(n){return Ha(n[4])}function Ha(n){for(;null!==n&&!mr(n);)n=n[4];return n}function V4(n,t,e,r,s){if(null!=r){let i,o=!1;mr(r)?i=r:Hi(r)&&(o=!0,r=r[0]);const c=_r(r);0===n&&null!==e?null==s?sv(t,e,c):Rc(t,e,c,s||null,!0):1===n&&null!==e?Rc(t,e,c,s||null,!0):2===n?uv(t,c,o):3===n&&t.destroyNode(c),null!=i&&function tw(n,t,e,r,s){const i=e[7];i!==_r(e)&&V4(t,n,r,i,s);for(let c=10;c<e.length;c++){const u=e[c];M6(u[1],u,n,t,r,i)}}(t,n,i,e,s)}}function Nd(n,t){return n.createText(t)}function ev(n,t,e){n.setValue(t,e)}function qT(n,t){return n.createComment(function $_(n){return n.replace(bT,t=>t.replace(NT,"\u200b$1\u200b"))}(t))}function Ad(n,t,e){return n.createElement(t,e)}function tv(n,t){const e=n[9],r=e.indexOf(t),s=t[3];512&t[2]&&(t[2]&=-513,Nh(s,-1)),e.splice(r,1)}function Od(n,t){if(n.length<=10)return;const e=10+t,r=n[e];if(r){const s=r[17];null!==s&&s!==n&&tv(s,r),t>0&&(n[e-1][4]=r[4]);const i=l6(n,10+t);!function jT(n,t){M6(n,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);const o=i[19];null!==o&&o.detachView(i[1]),r[3]=null,r[4]=null,r[2]&=-65}return r}function nv(n,t){if(!(128&t[2])){const e=t[11];e.destroyNode&&M6(n,t,e,3,null,null),function KT(n){let t=n[13];if(!t)return Id(n[1],n);for(;t;){let e=null;if(Hi(t))e=t[13];else{const r=t[10];r&&(e=r)}if(!e){for(;t&&!t[4]&&t!==n;)Hi(t)&&Id(t[1],t),t=t[3];null===t&&(t=n),Hi(t)&&Id(t[1],t),e=t&&t[4]}t=e}}(t)}}function Id(n,t){if(!(128&t[2])){t[2]&=-65,t[2]|=128,function JT(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let r=0;r<e.length;r+=2){const s=t[e[r]];if(!(s instanceof j0)){const i=e[r+1];if(Array.isArray(i))for(let o=0;o<i.length;o+=2){const c=s[i[o]],u=i[o+1];try{u.call(c)}finally{}}else try{i.call(s)}finally{}}}}(n,t),function xd(n,t){const e=n.cleanup,r=t[7];let s=-1;if(null!==e)for(let i=0;i<e.length-1;i+=2)if("string"==typeof e[i]){const o=e[i+1],c="function"==typeof o?o(t):_r(t[o]),u=r[s=e[i+2]],h=e[i+3];"boolean"==typeof h?c.removeEventListener(e[i],u,h):h>=0?r[s=h]():r[s=-h].unsubscribe(),i+=2}else{const o=r[s=e[i+1]];e[i].call(o)}if(null!==r){for(let i=s+1;i<r.length;i++)(0,r[i])();t[7]=null}}(n,t),1===t[1].type&&t[11].destroy();const e=t[17];if(null!==e&&mr(t[3])){e!==t[3]&&tv(e,t);const r=t[19];null!==r&&r.detachView(n)}!function RT(n){Ed.delete(n[20])}(t)}}function rv(n,t,e){return Ld(n,t.parent,e)}function Ld(n,t,e){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return e[0];if(2&r.flags){const s=n.data[r.directiveStart].encapsulation;if(s===O1.None||s===O1.Emulated)return null}return F2(r,e)}function Rc(n,t,e,r,s){n.insertBefore(t,e,r,s)}function sv(n,t,e){n.appendChild(t,e)}function Dc(n,t,e,r,s){null!==r?Rc(n,t,e,r,s):sv(n,t,e)}function y6(n,t){return n.parentNode(t)}function av(n,t,e){return lv(n,t,e)}function cv(n,t,e){return 40&n.type?F2(n,e):null}let kd,lv=cv;function Z5(n,t){lv=n,kd=t}function Cu(n,t,e,r){const s=rv(n,r,t),i=t[11],c=av(r.parent||t[6],r,t);if(null!=s)if(Array.isArray(e))for(let u=0;u<e.length;u++)Dc(i,s,e[u],c,!1);else Dc(i,s,e,c,!1);void 0!==kd&&kd(i,r,t,e,s)}function yu(n,t){if(null!==t){const e=t.type;if(3&e)return F2(t,n);if(4&e)return E6(-1,n[t.index]);if(8&e){const r=t.child;if(null!==r)return yu(n,r);{const s=n[t.index];return mr(s)?E6(-1,s):_r(s)}}if(32&e)return Td(t,n)()||_r(n[t.index]);{const r=H4(n,t);return null!==r?Array.isArray(r)?r[0]:yu(vu(n[16]),r):yu(n,t.next)}}return null}function H4(n,t){return null!==t?n[16][6].projection[t.projection]:null}function E6(n,t){const e=10+n+1;if(e<t.length){const r=t[e],s=r[1].firstChild;if(null!==s)return yu(r,s)}return t[7]}function uv(n,t,e){const r=y6(n,t);r&&function iv(n,t,e,r){n.removeChild(t,e,r)}(n,r,t,e)}function Rd(n,t,e,r,s,i,o){for(;null!=e;){const c=r[e.index],u=e.type;if(o&&0===t&&(c&&E2(_r(c),r),e.flags|=4),64!=(64&e.flags))if(8&u)Rd(n,t,e.child,r,s,i,!1),V4(t,n,s,c,i);else if(32&u){const h=Td(e,r);let g;for(;g=h();)V4(t,n,s,g,i);V4(t,n,s,c,i)}else 16&u?fv(n,t,r,e,s,i):V4(t,n,s,c,i);e=o?e.projectionNext:e.next}}function M6(n,t,e,r,s,i){Rd(e,r,n.firstChild,t,s,i,!1)}function fv(n,t,e,r,s,i){const o=e[16],u=o[6].projection[r.projection];if(Array.isArray(u))for(let h=0;h<u.length;h++)V4(t,n,s,u[h],i);else Rd(n,t,u,o[3],s,i,!0)}function Eu(n,t,e){n.setAttribute(t,"style",e)}function Y5(n,t,e){""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}function dv(n,t,e){let r=n.length;for(;;){const s=n.indexOf(t,e);if(-1===s)return s;if(0===s||n.charCodeAt(s-1)<=32){const i=t.length;if(s+i===r||n.charCodeAt(s+i)<=32)return s}e=s+1}}const pv="ng-template";function Dd(n,t,e){let r=0;for(;r<n.length;){let s=n[r++];if(e&&"class"===s){if(s=n[r],-1!==dv(s.toLowerCase(),t,0))return!0}else if(1===s){for(;r<n.length&&"string"==typeof(s=n[r++]);)if(s.toLowerCase()===t)return!0;return!1}}return!1}function Mu(n){return 4===n.type&&n.value!==pv}function gv(n,t,e){return t===(4!==n.type||e?n.value:pv)}function nw(n,t,e){let r=4;const s=n.attrs||[],i=function rw(n){for(let t=0;t<n.length;t++)if(Qm(n[t]))return t;return n.length}(s);let o=!1;for(let c=0;c<t.length;c++){const u=t[c];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!gv(n,u,e)||""===u&&1===t.length){if(ia(r))return!1;o=!0}}else{const h=8&r?u:t[++c];if(8&r&&null!==n.attrs){if(!Dd(n.attrs,h,e)){if(ia(r))return!1;o=!0}continue}const m=mv(8&r?"class":u,s,Mu(n),e);if(-1===m){if(ia(r))return!1;o=!0;continue}if(""!==h){let v;v=m>i?"":s[m+1].toLowerCase();const T=8&r?v:null;if(T&&-1!==dv(T,h,0)||2&r&&h!==v){if(ia(r))return!1;o=!0}}}}else{if(!o&&!ia(r)&&!ia(u))return!1;if(o&&ia(u))continue;o=!1,r=u|1&r}}return ia(r)||o}function ia(n){return 0==(1&n)}function mv(n,t,e,r){if(null===t)return-1;let s=0;if(r||!e){let i=!1;for(;s<t.length;){const o=t[s];if(o===n)return s;if(3===o||6===o)i=!0;else{if(1===o||2===o){let c=t[++s];for(;"string"==typeof c;)c=t[++s];continue}if(4===o)break;if(0===o){s+=4;continue}}s+=i?1:2}return-1}return function sw(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const r=n[e];if("number"==typeof r)return-1;if(r===t)return e;e++}return-1}(t,n)}function _v(n,t,e=!1){for(let r=0;r<t.length;r++)if(nw(n,t[r],e))return!0;return!1}function Cv(n,t){e:for(let e=0;e<t.length;e++){const r=t[e];if(n.length===r.length){for(let s=0;s<n.length;s++)if(n[s]!==r[s])continue e;return!0}}return!1}function zd(n,t){return n?":not("+t.trim()+")":t}function iw(n){let t=n[0],e=1,r=2,s="",i=!1;for(;e<n.length;){let o=n[e];if("string"==typeof o)if(2&r){const c=n[++e];s+="["+o+(c.length>0?'="'+c+'"':"")+"]"}else 8&r?s+="."+o:4&r&&(s+=" "+o);else""!==s&&!ia(o)&&(t+=zd(i,s),s=""),r=o,i=i||!ia(r);e++}return""!==s&&(t+=zd(i,s)),t}const an={};function M(n){Ev(qn(),Oe(),$2()+n,!1)}function Ev(n,t,e,r){if(!r)if(3==(3&t[2])){const i=n.preOrderCheckHooks;null!==i&&Xo(t,i,e)}else{const i=n.preOrderHooks;null!==i&&W0(t,i,0,e)}Tc(e)}function Bd(n,t=null,e=null,r){const s=Pv(n,t,e,r);return s.resolveInjectorInitializers(),s}function Pv(n,t=null,e=null,r,s=new Set){const i=[e||p1,pu(n)];return r=r||("object"==typeof n?void 0:F1(n)),new H5(i,t||O3(),r||null,s)}let Xs=(()=>{class n{static create(e,r){if(Array.isArray(e))return Bd({name:""},r,e,"");{const s=e.name??"";return Bd({name:s},e.parent,e.providers,s)}}}return n.THROW_IF_NOT_FOUND=tu,n.NULL=new O_,n.\u0275prov=Xe({token:n,providedIn:"any",factory:()=>xe(N_)}),n.__NG_ELEMENT_ID__=-1,n})();function Q(n,t=$t.Default){const e=Oe();return null===e?xe(n,t):y5(Or(),e,Kt(n),t)}function J5(){throw new Error("invalid")}function e7(n,t){return n<<17|t<<2}function oa(n){return n>>17&32767}function Yd(n){return 2|n}function Fa(n){return(131068&n)>>2}function B4(n,t){return-131069&n|t<<2}function Kd(n){return 1|n}function zv(n,t){const e=n.contentQueries;if(null!==e)for(let r=0;r<e.length;r+=2){const s=e[r],i=e[r+1];if(-1!==i){const o=n.data[i];$0(s),o.contentQueries(2,t[i],i)}}}function i7(n,t,e,r,s,i,o,c,u,h,g){const m=t.blueprint.slice();return m[0]=s,m[2]=76|r,(null!==g||n&&1024&n[2])&&(m[2]|=1024),Gm(m),m[3]=m[15]=n,m[8]=e,m[10]=o||n&&n[10],m[11]=c||n&&n[11],m[12]=u||n&&n[12]||null,m[9]=h||n&&n[9]||null,m[6]=i,m[20]=function nr(){return U_++}(),m[21]=g,m[16]=2==t.type?n[16]:m,m}function P6(n,t,e,r,s){let i=n.data[t];if(null===i)i=o7(n,t,e,r,s),function No(){return tn.lFrame.inI18n}()&&(i.flags|=64);else if(64&i.type){i.type=e,i.value=r,i.attrs=s;const o=S4();i.injectorIndex=null===o?-1:o.injectorIndex}return ka(i,!0),i}function o7(n,t,e,r,s){const i=Wm(),o=Br(),u=n.data[t]=function YH(n,t,e,r,s,i){return{type:e,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:s,attrs:i,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?i:i&&i.parent,e,t,r,s);return null===n.firstChild&&(n.firstChild=u),null!==i&&(o?null==i.child&&null!==u.parent&&(i.child=u):null===i.next&&(i.next=u)),u}function $4(n,t,e,r){if(0===e)return-1;const s=t.length;for(let i=0;i<e;i++)t.push(r),n.blueprint.push(r),n.data.push(null);return s}function a7(n,t,e){P4(t);try{const r=n.viewQuery;null!==r&&c9(1,r,e);const s=n.template;null!==s&&Vv(n,t,s,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&zv(n,t),n.staticViewQueries&&c9(2,n.viewQuery,e);const i=n.components;null!==i&&function Iw(n,t){for(let e=0;e<t.length;e++)nF(n,t[e])}(t,i)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{t[2]&=-5,T4()}}function c7(n,t,e,r){const s=t[2];if(128!=(128&s)){P4(t);try{Gm(t),function qm(n){return tn.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&Vv(n,t,e,2,r);const o=3==(3&s);if(o){const h=n.preOrderCheckHooks;null!==h&&Xo(t,h,null)}else{const h=n.preOrderHooks;null!==h&&W0(t,h,0,null),q0(t,0)}if(function tF(n){for(let t=wd(n);null!==t;t=bd(t)){if(!t[2])continue;const e=t[9];for(let r=0;r<e.length;r++){const s=e[r],i=s[3];0==(512&s[2])&&Nh(i,1),s[2]|=512}}}(t),function Bw(n){for(let t=wd(n);null!==t;t=bd(t))for(let e=10;e<t.length;e++){const r=t[e],s=r[1];Xl(r)&&c7(s,r,s.template,r[8])}}(t),null!==n.contentQueries&&zv(n,t),o){const h=n.contentCheckHooks;null!==h&&Xo(t,h)}else{const h=n.contentHooks;null!==h&&W0(t,h,1),q0(t,1)}!function r9(n,t){const e=n.hostBindingOpCodes;if(null!==e)try{for(let r=0;r<e.length;r++){const s=e[r];if(s<0)Tc(~s);else{const i=s,o=e[++r],c=e[++r];LP(o,i),c(2,t[i])}}}finally{Tc(-1)}}(n,t);const c=n.components;null!==c&&function Ow(n,t){for(let e=0;e<t.length;e++)$w(n,t[e])}(t,c);const u=n.viewQuery;if(null!==u&&c9(2,u,r),o){const h=n.viewCheckHooks;null!==h&&Xo(t,h)}else{const h=n.viewHooks;null!==h&&W0(t,h,2),q0(t,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),t[2]&=-41,512&t[2]&&(t[2]&=-513,Nh(t[3],-1))}finally{T4()}}}function Vv(n,t,e,r,s){const i=$2(),o=2&r;try{Tc(-1),o&&t.length>22&&Ev(n,t,22,!1),e(r,s)}finally{Tc(i)}}function Hv(n,t,e){if(Ci(t)){const s=t.directiveEnd;for(let i=t.directiveStart;i<s;i++){const o=n.data[i];o.contentQueries&&o.contentQueries(1,e[i],i)}}}function s9(n,t,e){!Ah()||(function Uv(n,t,e,r){const s=e.directiveStart,i=e.directiveEnd;n.firstCreatePass||C5(e,t),E2(r,t);const o=e.initialInputs;for(let c=s;c<i;c++){const u=n.data[c],h=ds(u);h&&Hw(t,e,u);const g=Ns(t,n,c,e);E2(g,t),null!==o&&eF(0,c-s,g,u,0,o),h&&(m2(e.index,t)[8]=g)}}(n,t,e,F2(e,t)),128==(128&e.flags)&&function Dw(n,t,e){const r=e.directiveStart,s=e.directiveEnd,i=e.index,o=function xh(){return tn.lFrame.currentDirectiveIndex}();try{Tc(i);for(let c=r;c<s;c++){const u=n.data[c],h=t[c];Pc(c),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&zw(u,h)}}finally{Tc(-1),Pc(o)}}(n,t,e))}function T6(n,t,e=F2){const r=t.localNames;if(null!==r){let s=t.index+1;for(let i=0;i<r.length;i+=2){const o=r[i+1],c=-1===o?e(t,n):n[o];n[s++]=c}}}function Fv(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=Bv(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):t}function Bv(n,t,e,r,s,i,o,c,u,h){const g=22+r,m=g+s,v=function xw(n,t){const e=[];for(let r=0;r<t;r++)e.push(r<n?null:an);return e}(g,m),T="function"==typeof h?h():h;return v[1]={type:n,blueprint:v,template:e,queries:null,viewQuery:c,declTNode:t,data:v.slice().fill(null,g),bindingStartIndex:g,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof i?i():i,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:T,incompleteFirstPass:!1}}function kw(n,t,e,r){const s=Kv(t);null===e?s.push(r):(s.push(e),n.firstCreatePass&&Xv(n).push(r,s.length-1))}function w6(n,t,e){for(let r in n)if(n.hasOwnProperty(r)){const s=n[r];(e=null===e?{}:e).hasOwnProperty(r)?e[r].push(t,s):e[r]=[t,s]}return e}function l7(n,t){const r=t.directiveEnd,s=n.data,i=t.attrs,o=[];let c=null,u=null;for(let h=t.directiveStart;h<r;h++){const g=s[h],m=g.inputs,v=null===i||Mu(t)?null:Fw(m,i);o.push(v),c=w6(m,h,c),u=w6(g.outputs,h,u)}null!==c&&(c.hasOwnProperty("class")&&(t.flags|=16),c.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=o,t.inputs=c,t.outputs=u}function qi(n,t,e,r,s,i,o,c){const u=F2(t,e);let g,h=t.inputs;!c&&null!=h&&(g=h[r])?(p7(n,e,g,r,s),Po(t)&&$v(e,t.index)):3&t.type&&(r=function u7(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(r),s=null!=o?o(s,t.value||"",r):s,i.setProperty(u,r,s))}function $v(n,t){const e=m2(t,n);16&e[2]||(e[2]|=32)}function U4(n,t,e,r){let s=!1;if(Ah()){const i=function Gv(n,t,e){const r=n.directiveRegistry;let s=null;if(r)for(let i=0;i<r.length;i++){const o=r[i];_v(e,o.selectors,!1)&&(s||(s=[]),r6(C5(e,t),n,o.type),ds(o)?(i9(n,e),s.unshift(o)):s.push(o))}return s}(n,t,e),o=null===r?null:{"":-1};if(null!==i){s=!0,Wv(e,n.data.length,i.length);for(let g=0;g<i.length;g++){const m=i[g];m.providersResolver&&m.providersResolver(m)}let c=!1,u=!1,h=$4(n,t,i.length,null);for(let g=0;g<i.length;g++){const m=i[g];e.mergedAttrs=n6(e.mergedAttrs,m.hostAttrs),qv(n,e,t,h,m),JH(h,m,o),null!==m.contentQueries&&(e.flags|=8),(null!==m.hostBindings||null!==m.hostAttrs||0!==m.hostVars)&&(e.flags|=128);const v=m.type.prototype;!c&&(v.ngOnChanges||v.ngOnInit||v.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e.index),c=!0),!u&&(v.ngOnChanges||v.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e.index),u=!0),h++}l7(n,e)}o&&function Vw(n,t,e){if(t){const r=n.localNames=[];for(let s=0;s<t.length;s+=2){const i=e[t[s+1]];if(null==i)throw new Te(-301,!1);r.push(t[s],i)}}}(e,r,o)}return e.mergedAttrs=n6(e.mergedAttrs,e.attrs),s}function f7(n,t,e,r,s,i){const o=i.hostBindings;if(o){let c=n.hostBindingOpCodes;null===c&&(c=n.hostBindingOpCodes=[]);const u=~t.index;(function Rw(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(c)!=u&&c.push(u),c.push(r,s,o)}}function zw(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function i9(n,t){t.flags|=2,(n.components||(n.components=[])).push(t.index)}function JH(n,t,e){if(e){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)e[t.exportAs[r]]=n;ds(t)&&(e[""]=n)}}function Wv(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}function qv(n,t,e,r,s){n.data[r]=s;const i=s.factory||(s.factory=Ko(s.type)),o=new j0(i,ds(s),Q);n.blueprint[r]=o,e[r]=o,f7(n,t,0,r,$4(n,e,s.hostVars,an),s)}function Hw(n,t,e){const r=F2(t,n),s=Fv(e),i=n[10],o=h7(n,i7(n,s,null,e.onPush?32:16,r,t,i,i.createRenderer(r,e),null,null,null));n[t.index]=o}function Ba(n,t,e,r,s,i){const o=F2(n,t);o9(t[11],o,i,n.value,e,r,s)}function o9(n,t,e,r,s,i,o){if(null==i)n.removeAttribute(t,s,e);else{const c=null==o?Xt(i):o(i,r||"",s);n.setAttribute(t,s,c,e)}}function eF(n,t,e,r,s,i){const o=i[t];if(null!==o){const c=r.setInput;for(let u=0;u<o.length;){const h=o[u++],g=o[u++],m=o[u++];null!==c?r.setInput(e,m,h,g):e[g]=m}}}function Fw(n,t){let e=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;n.hasOwnProperty(s)&&(null===e&&(e=[]),e.push(s,n[s],t[r+1])),r+=2}else r+=2;else r+=4}return e}function jv(n,t,e,r){return new Array(n,!0,!1,t,null,0,r,e,null,null)}function $w(n,t){const e=m2(t,n);if(Xl(e)){const r=e[1];48&e[2]?c7(r,e,r.template,e[8]):e[5]>0&&a9(e)}}function a9(n){for(let r=wd(n);null!==r;r=bd(r))for(let s=10;s<r.length;s++){const i=r[s];if(Xl(i))if(512&i[2]){const o=i[1];c7(o,i,o.template,i[8])}else i[5]>0&&a9(i)}const e=n[1].components;if(null!==e)for(let r=0;r<e.length;r++){const s=m2(e[r],n);Xl(s)&&s[5]>0&&a9(s)}}function nF(n,t){const e=m2(t,n),r=e[1];(function Uw(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])})(r,e),a7(r,e,e[8])}function h7(n,t){return n[13]?n[14][4]=t:n[13]=t,n[14]=t,t}function Zv(n){for(;n;){n[2]|=32;const t=vu(n);if(Zl(n)&&!t)return n;n=t}return null}function d7(n,t,e,r=!0){const s=t[10];s.begin&&s.begin();try{c7(n,t,n.template,e)}catch(o){throw r&&Jv(t,o),o}finally{s.end&&s.end()}}function c9(n,t,e){$0(0),t(n,e)}function Kv(n){return n[7]||(n[7]=[])}function Xv(n){return n.cleanup||(n.cleanup=[])}function Jv(n,t){const e=n[9],r=e?e.get(C6,null):null;r&&r.handleError(t)}function p7(n,t,e,r,s){for(let i=0;i<e.length;){const o=e[i++],c=e[i++],u=t[o],h=n.data[o];null!==h.setInput?h.setInput(u,s,r,c):u[c]=s}}function Vc(n,t,e){const r=F0(t,n);ev(n[11],r,e)}function Pu(n,t,e){let r=e?n.styles:null,s=e?n.classes:null,i=0;if(null!==t)for(let o=0;o<t.length;o++){const c=t[o];"number"==typeof c?i=c:1==i?s=L0(s,c):2==i&&(r=L0(r,c+": "+t[++o]+";"))}e?n.styles=r:n.stylesWithoutHost=r,e?n.classes=s:n.classesWithoutHost=s}function g7(n,t,e,r,s=!1){for(;null!==e;){const i=t[e.index];if(null!==i&&r.push(_r(i)),mr(i))for(let c=10;c<i.length;c++){const u=i[c],h=u[1].firstChild;null!==h&&g7(u[1],u,h,r)}const o=e.type;if(8&o)g7(n,t,e.child,r);else if(32&o){const c=Td(e,t);let u;for(;u=c();)r.push(u)}else if(16&o){const c=H4(t,e);if(Array.isArray(c))r.push(...c);else{const u=vu(t[16]);g7(u[1],u,c,r,!0)}}e=s?e.projectionNext:e.next}return r}class m7{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return g7(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(mr(t)){const e=t[8],r=e?e.indexOf(this):-1;r>-1&&(Od(t,r),l6(e,r))}this._attachedToViewContainer=!1}nv(this._lView[1],this._lView)}onDestroy(t){kw(this._lView[1],this._lView,null,t)}markForCheck(){Zv(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){d7(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Te(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function YT(n,t){M6(n,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Te(902,!1);this._appRef=t}}class Ww extends m7{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;d7(t[1],t,t[8],!1)}checkNoChanges(){}get context(){return null}}class l9 extends ra{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=v1(t);return new Tu(e,this.ngModule)}}function qw(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class tC{constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,r){const s=this.injector.get(t,vd,r);return s!==vd||e===vd?s:this.parentInjector.get(t,e,r)}}class Tu extends V_{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function ow(n){return n.map(iw).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return qw(this.componentDef.inputs)}get outputs(){return qw(this.componentDef.outputs)}create(t,e,r,s){let i=(s=s||this.ngModule)instanceof na?s:s?.injector;i&&null!==this.componentDef.getStandaloneInjector&&(i=this.componentDef.getStandaloneInjector(i)||i);const o=i?new tC(t,i):t,c=o.get(_6,null);if(null===c)throw new Te(407,!1);const u=o.get(MH,null),h=c.createRenderer(null,this.componentDef),g=this.componentDef.selectors[0][0]||"div",m=r?function Lw(n,t,e){return n.selectRootElement(t,e===O1.ShadowDom)}(h,r,this.componentDef.encapsulation):Ad(h,g,function eC(n){const t=n.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(g)),v=this.componentDef.onPush?288:272,T=Bv(0,null,null,1,0,null,null,null,null,null),I=i7(null,T,null,v,null,null,c,h,u,o,null);let z,Z;P4(I);try{const te=function Zw(n,t,e,r,s,i){const o=e[1];e[22]=n;const u=P6(o,22,2,"#host",null),h=u.mergedAttrs=t.hostAttrs;null!==h&&(Pu(u,h,!0),null!==n&&(Da(s,n,h),null!==u.classes&&Y5(s,n,u.classes),null!==u.styles&&Eu(s,n,u.styles)));const g=r.createRenderer(n,t),m=i7(e,Fv(t),null,t.onPush?32:16,e[22],u,r,g,i||null,null,null);return o.firstCreatePass&&(r6(C5(u,e),o,t.type),i9(o,u),Wv(u,e.length,1)),h7(e,m),e[22]=m}(m,this.componentDef,I,c,h);if(m)if(r)Da(h,m,["ng-version",H_.full]);else{const{attrs:me,classes:J}=function yv(n){const t=[],e=[];let r=1,s=2;for(;r<n.length;){let i=n[r];if("string"==typeof i)2===s?""!==i&&t.push(i,n[++r]):8===s&&e.push(i);else{if(!ia(s))break;s=i}r++}return{attrs:t,classes:e}}(this.componentDef.selectors[0]);me&&Da(h,m,me),J&&J.length>0&&Y5(h,m,J.join(" "))}if(Z=bh(T,22),void 0!==e){const me=Z.projection=[];for(let J=0;J<this.ngContentSelectors.length;J++){const Ne=e[J];me.push(null!=Ne?Array.from(Ne):null)}}z=function rC(n,t,e,r){const s=e[1],i=function QH(n,t,e){const r=Or();n.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),qv(n,r,t,$4(n,t,1,null),e),l7(n,r));const s=Ns(t,n,r.directiveStart,r);E2(s,t);const i=F2(r,t);return i&&E2(i,t),s}(s,e,t);if(n[8]=e[8]=i,null!==r)for(const c of r)c(i,t);if(t.contentQueries){const c=Or();t.contentQueries(1,i,c.directiveStart)}const o=Or();return!s.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(Tc(o.index),f7(e[1],o,0,o.directiveStart,o.directiveEnd,t),zw(t,i)),i}(te,this.componentDef,I,[d]),a7(T,I,null)}finally{T4()}return new jw(this.componentType,z,m6(Z,I),I,Z)}}class jw extends class pT{}{constructor(t,e,r,s,i){super(),this.location=r,this._rootLView=s,this._tNode=i,this.instance=e,this.hostView=this.changeDetectorRef=new Ww(s),this.componentType=t}setInput(t,e){const r=this._tNode.inputs;let s;if(null!==r&&(s=r[t])){const i=this._rootLView;p7(i[1],i,s,t,e),$v(i,this._tNode.index)}}get injector(){return new s6(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function d(){const n=Or();Nc(Oe()[1],n)}function l(n){let t=function a(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const r=[n];for(;t;){let s;if(ds(n))s=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Te(903,!1);s=t.\u0275dir}if(s){if(e){r.push(s);const o=n;o.inputs=p(n.inputs),o.declaredInputs=p(n.declaredInputs),o.outputs=p(n.outputs);const c=s.hostBindings;c&&b(n,c);const u=s.viewQuery,h=s.contentQueries;if(u&&_(n,u),h&&C(n,h),fh(n.inputs,s.inputs),fh(n.declaredInputs,s.declaredInputs),fh(n.outputs,s.outputs),ds(s)&&s.data.animation){const g=n.data;g.animation=(g.animation||[]).concat(s.data.animation)}}const i=s.features;if(i)for(let o=0;o<i.length;o++){const c=i[o];c&&c.ngInherit&&c(n),c===l&&(e=!1)}}t=Object.getPrototypeOf(t)}!function f(n){let t=0,e=null;for(let r=n.length-1;r>=0;r--){const s=n[r];s.hostVars=t+=s.hostVars,s.hostAttrs=n6(s.hostAttrs,e=n6(e,s.hostAttrs))}}(r)}function p(n){return n===j?{}:n===p1?[]:n}function _(n,t){const e=n.viewQuery;n.viewQuery=e?(r,s)=>{t(r,s),e(r,s)}:t}function C(n,t){const e=n.contentQueries;n.contentQueries=e?(r,s,i)=>{t(r,s,i),e(r,s,i)}:t}function b(n,t){const e=n.hostBindings;n.hostBindings=e?(r,s)=>{t(r,s),e(r,s)}:t}let ne=null;function Ee(){if(!ne){const n=G1.Symbol;if(n&&n.iterator)ne=n.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const r=t[e];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(ne=r)}}}return ne}function ke(n){return!!pt(n)&&(Array.isArray(n)||!(n instanceof Map)&&Ee()in n)}function pt(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function fn(n,t,e){return n[t]=e}function T1(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function K2(n,t,e,r){const s=T1(n,t,e);return T1(n,t+1,r)||s}function V(n,t,e,r){const s=Oe();return T1(s,Jl(),t)&&(qn(),Ba(C1(),s,n,t,e,r)),V}function c1(n,t,e,r){return T1(n,Jl(),e)?t+Xt(e)+r:an}function As(n,t,e,r,s,i){const c=K2(n,Ra(),e,s);return bo(2),c?t+Xt(e)+r+Xt(s)+i:an}function xo(n,t,e,r,s,i,o,c){const h=function ca(n,t,e,r,s){const i=K2(n,t,e,r);return T1(n,t+2,s)||i}(n,Ra(),e,s,o);return bo(3),h?t+Xt(e)+r+Xt(s)+i+Xt(o)+c:an}function wu(n,t,e,r,s,i){const o=Oe(),c=c1(o,t,e,r);return c!==an&&Ba(C1(),o,n,c,s,i),wu}function k(n,t,e,r,s,i,o,c){const u=Oe(),h=qn(),g=n+22,m=h.firstCreatePass?function e3e(n,t,e,r,s,i,o,c,u){const h=t.consts,g=P6(t,n,4,o||null,Sc(h,c));U4(t,e,g,Sc(h,u)),Nc(t,g);const m=g.tViews=Bv(2,g,r,s,i,t.directiveRegistry,t.pipeRegistry,null,t.schemas,h);return null!==t.queries&&(t.queries.template(t,g),m.queries=t.queries.embeddedTView(g)),g}(g,h,u,t,e,r,s,i,o):h.data[g];ka(m,!1);const v=u[11].createComment("");Cu(h,u,v,m),E2(v,u),h7(u,u[g]=jv(v,u,v,m)),To(m)&&s9(h,u,m),null!=o&&T6(u,m,c)}function s1(n){return M4(function p5(){return tn.lFrame.contextLView}(),22+n)}function w(n,t,e){const r=Oe();return T1(r,Jl(),t)&&qi(qn(),C1(),r,n,t,r[11],e,!1),w}function Yw(n,t,e,r,s){const o=s?"class":"style";p7(n,e,t.inputs[o],o,r)}function N(n,t,e,r){const s=Oe(),i=qn(),o=22+n,c=s[11],u=s[o]=Ad(c,t,function bc(){return tn.lFrame.currentNamespace}()),h=i.firstCreatePass?function n3e(n,t,e,r,s,i,o){const c=t.consts,h=P6(t,n,2,s,Sc(c,i));return U4(t,e,h,Sc(c,o)),null!==h.attrs&&Pu(h,h.attrs,!1),null!==h.mergedAttrs&&Pu(h,h.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,h),h}(o,i,s,0,t,e,r):i.data[o];ka(h,!0);const g=h.mergedAttrs;null!==g&&Da(c,u,g);const m=h.classes;null!==m&&Y5(c,u,m);const v=h.styles;return null!==v&&Eu(c,u,v),64!=(64&h.flags)&&Cu(i,s,u,h),0===function bP(){return tn.lFrame.elementDepthCount}()&&E2(u,s),function NP(){tn.lFrame.elementDepthCount++}(),To(h)&&(s9(i,s,h),Hv(i,h,s)),null!==r&&T6(s,h),N}function A(){let n=Or();Br()?Oh():(n=n.parent,ka(n,!1));const t=n;!function AP(){tn.lFrame.elementDepthCount--}();const e=qn();return e.firstCreatePass&&(Nc(e,n),Ci(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function Dh(n){return 0!=(16&n.flags)}(t)&&Yw(e,t,Oe(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function Z0(n){return 0!=(32&n.flags)}(t)&&Yw(e,t,Oe(),t.stylesWithoutHost,!1),A}function X(n,t,e,r){return N(n,t,e,r),A(),X}function nn(n,t,e){const r=Oe(),s=qn(),i=n+22,o=s.firstCreatePass?function r3e(n,t,e,r,s){const i=t.consts,o=Sc(i,r),c=P6(t,n,8,"ng-container",o);return null!==o&&Pu(c,o,!0),U4(t,e,c,Sc(i,s)),null!==t.queries&&t.queries.elementStart(t,c),c}(i,s,r,t,e):s.data[i];ka(o,!0);const c=r[i]=r[11].createComment("");return Cu(s,r,c,o),E2(c,r),To(o)&&(s9(s,r,o),Hv(s,o,r)),null!=e&&T6(r,o),nn}function rn(){let n=Or();const t=qn();return Br()?Oh():(n=n.parent,ka(n,!1)),t.firstCreatePass&&(Nc(t,n),Ci(n)&&t.queries.elementEnd(n)),rn}function we(){return Oe()}function u9(n){return!!n&&"function"==typeof n.then}const Kw=function pF(n){return!!n&&"function"==typeof n.subscribe};function se(n,t,e,r){const s=Oe(),i=qn(),o=Or();return function mF(n,t,e,r,s,i,o,c){const u=To(r),g=n.firstCreatePass&&Xv(n),m=t[8],v=Kv(t);let T=!0;if(3&r.type||c){const Z=F2(r,t),te=c?c(Z):Z,me=v.length,J=c?He=>c(_r(He[r.index])):r.index;let Ne=null;if(!c&&u&&(Ne=function s3e(n,t,e,r){const s=n.cleanup;if(null!=s)for(let i=0;i<s.length-1;i+=2){const o=s[i];if(o===e&&s[i+1]===r){const c=t[7],u=s[i+2];return c.length>u?c[u]:null}"string"==typeof o&&(i+=2)}return null}(n,t,s,r.index)),null!==Ne)(Ne.__ngLastListenerFn__||Ne).__ngNextListenerFn__=i,Ne.__ngLastListenerFn__=i,T=!1;else{i=vF(r,t,m,i,!1);const He=e.listen(te,s,i);v.push(i,He),g&&g.push(s,J,me,me+1)}}else i=vF(r,t,m,i,!1);const I=r.outputs;let z;if(T&&null!==I&&(z=I[s])){const Z=z.length;if(Z)for(let te=0;te<Z;te+=2){const qe=t[z[te]][z[te+1]].subscribe(i),Dt=v.length;v.push(i,qe),g&&g.push(s,r.index,Dt,-(Dt+1))}}}(i,s,s[11],o,n,t,0,r),se}function _F(n,t,e,r){try{return!1!==e(r)}catch(s){return Jv(n,s),!1}}function vF(n,t,e,r,s){return function i(o){if(o===Function)return r;Zv(2&n.flags?m2(n.index,t):t);let u=_F(t,0,r,o),h=i.__ngNextListenerFn__;for(;h;)u=_F(t,0,h,o)&&u,h=h.__ngNextListenerFn__;return s&&!1===u&&(o.preventDefault(),o.returnValue=!1),u}}function E(n=1){return function _5(n){return(tn.lFrame.contextLView=function G0(n,t){for(;n>0;)t=t[15],n--;return t}(n,tn.lFrame.contextLView))[8]}(n)}function i3e(n,t){let e=null;const r=function vv(n){const t=n.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(n);for(let s=0;s<t.length;s++){const i=t[s];if("*"!==i){if(null===r?_v(n,i,!0):Cv(r,i))return s}else e=s}return e}function Xw(n,t,e){return L1(n,"",t,"",e),Xw}function L1(n,t,e,r,s){const i=Oe(),o=c1(i,t,e,r);return o!==an&&qi(qn(),C1(),i,n,o,i[11],s,!1),L1}function je(n,t,e,r,s,i,o){const c=Oe(),u=As(c,t,e,r,s,i);return u!==an&&qi(qn(),C1(),c,n,u,c[11],o,!1),je}function D3(n,t,e,r,s,i,o,c,u){const h=Oe(),g=xo(h,t,e,r,s,i,o,c);return g!==an&&qi(qn(),C1(),h,n,g,h[11],u,!1),D3}function bF(n,t,e,r,s){const i=n[e+1],o=null===t;let c=r?oa(i):Fa(i),u=!1;for(;0!==c&&(!1===u||o);){const g=n[c+1];c3e(n[c],t)&&(u=!0,n[c+1]=r?Kd(g):Yd(g)),c=r?oa(g):Fa(g)}u&&(n[e+1]=r?Yd(i):Kd(i))}function c3e(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&W2(n,t)>=0}const Qs={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function NF(n){return n.substring(Qs.key,Qs.keyEnd)}function l3e(n){return n.substring(Qs.value,Qs.valueEnd)}function OF(n,t){const e=Qs.textEnd;let r=Qs.key=_7(n,t,e);return e===r?-1:(r=Qs.keyEnd=function d3e(n,t,e){let r;for(;t<e&&(45===(r=n.charCodeAt(t))||95===r||(-33&r)>=65&&(-33&r)<=90||r>=48&&r<=57);)t++;return t}(n,r,e),r=xF(n,r,e),r=Qs.value=_7(n,r,e),r=Qs.valueEnd=function p3e(n,t,e){let r=-1,s=-1,i=-1,o=t,c=o;for(;o<e;){const u=n.charCodeAt(o++);if(59===u)return c;34===u||39===u?c=o=LF(n,u,o,e):t===o-4&&85===i&&82===s&&76===r&&40===u?c=o=LF(n,41,o,e):u>32&&(c=o),i=s,s=r,r=-33&u}return c}(n,r,e),xF(n,r,e))}function _7(n,t,e){for(;t<e&&n.charCodeAt(t)<=32;)t++;return t}function xF(n,t,e,r){return(t=_7(n,t,e))<e&&t++,t}function LF(n,t,e,r){let s=-1,i=e;for(;i<r;){const o=n.charCodeAt(i++);if(o==t&&92!==s)return i;s=92==o&&92===s?0:o}throw new Error}function sC(n,t){return function Hc(n,t,e,r){const s=Oe(),i=qn(),o=bo(2);i.firstUpdatePass&&DF(i,n,o,r),t!==an&&T1(s,o,t)&&VF(i,i.data[$2()],s,s[11],n,s[o+1]=function S3e(n,t){return null==n||("string"==typeof t?n+=t:"object"==typeof n&&(n=F1(Bi(n)))),n}(t,e),r,o)}(n,t,null,!0),sC}function Q2(n){!function Fc(n,t,e,r){const s=qn(),i=bo(2);s.firstUpdatePass&&DF(s,null,i,r);const o=Oe();if(e!==an&&T1(o,i,e)){const c=s.data[$2()];if(FF(c,r)&&!RF(s,i)){let u=r?c.classesWithoutHost:c.stylesWithoutHost;null!==u&&(e=L0(u,e||"")),Yw(s,c,o,e,r)}else!function M3e(n,t,e,r,s,i,o,c){s===an&&(s=p1);let u=0,h=0,g=0<s.length?s[0]:null,m=0<i.length?i[0]:null;for(;null!==g||null!==m;){const v=u<s.length?s[u+1]:void 0,T=h<i.length?i[h+1]:void 0;let z,I=null;g===m?(u+=2,h+=2,v!==T&&(I=m,z=T)):null===m||null!==g&&g<m?(u+=2,I=g):(h+=2,I=m,z=T),null!==I&&VF(n,t,e,r,I,z,o,c),g=u<s.length?s[u]:null,m=h<i.length?i[h]:null}}(s,c,o,o[11],o[i+1],o[i+1]=function E3e(n,t,e){if(null==e||""===e)return p1;const r=[],s=Bi(e);if(Array.isArray(s))for(let i=0;i<s.length;i++)n(r,s[i],!0);else if("object"==typeof s)for(const i in s)s.hasOwnProperty(i)&&n(r,i,s[i]);else"string"==typeof s&&t(r,s);return r}(n,t,e),r,i)}}(zF,g3e,n,!1)}function g3e(n,t){for(let e=function f3e(n){return function IF(n){Qs.key=0,Qs.keyEnd=0,Qs.value=0,Qs.valueEnd=0,Qs.textEnd=n.length}(n),OF(n,_7(n,0,Qs.textEnd))}(t);e>=0;e=OF(t,e))zF(n,NF(t),l3e(t))}function RF(n,t){return t>=n.expandoStartIndex}function DF(n,t,e,r){const s=n.data;if(null===s[e+1]){const i=s[$2()],o=RF(n,e);FF(i,r)&&null===t&&!o&&(t=!1),t=function _3e(n,t,e,r){const s=function g5(n){const t=tn.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}(n);let i=r?t.residualClasses:t.residualStyles;if(null===s)0===(r?t.classBindings:t.styleBindings)&&(e=f9(e=Qw(null,n,t,e,r),t.attrs,r),i=null);else{const o=t.directiveStylingLast;if(-1===o||n[o]!==s)if(e=Qw(s,n,t,e,r),null===i){let u=function v3e(n,t,e){const r=e?t.classBindings:t.styleBindings;if(0!==Fa(r))return n[oa(r)]}(n,t,r);void 0!==u&&Array.isArray(u)&&(u=Qw(null,n,t,u[1],r),u=f9(u,t.attrs,r),function C3e(n,t,e,r){n[oa(e?t.classBindings:t.styleBindings)]=r}(n,t,r,u))}else i=function y3e(n,t,e){let r;const s=t.directiveEnd;for(let i=1+t.directiveStylingLast;i<s;i++)r=f9(r,n[i].hostAttrs,e);return f9(r,t.attrs,e)}(n,t,r)}return void 0!==i&&(r?t.residualClasses=i:t.residualStyles=i),e}(s,i,t,r),function o3e(n,t,e,r,s,i){let o=i?t.classBindings:t.styleBindings,c=oa(o),u=Fa(o);n[r]=e;let g,h=!1;if(Array.isArray(e)){const m=e;g=m[1],(null===g||W2(m,g)>0)&&(h=!0)}else g=e;if(s)if(0!==u){const v=oa(n[c+1]);n[r+1]=e7(v,c),0!==v&&(n[v+1]=B4(n[v+1],r)),n[c+1]=function zH(n,t){return 131071&n|t<<17}(n[c+1],r)}else n[r+1]=e7(c,0),0!==c&&(n[c+1]=B4(n[c+1],r)),c=r;else n[r+1]=e7(u,0),0===c?c=r:n[u+1]=B4(n[u+1],r),u=r;h&&(n[r+1]=Yd(n[r+1])),bF(n,g,r,!0),bF(n,g,r,!1),function a3e(n,t,e,r,s){const i=s?n.residualClasses:n.residualStyles;null!=i&&"string"==typeof t&&W2(i,t)>=0&&(e[r+1]=Kd(e[r+1]))}(t,g,n,r,i),o=e7(c,u),i?t.classBindings=o:t.styleBindings=o}(s,i,t,e,o,r)}}function Qw(n,t,e,r,s){let i=null;const o=e.directiveEnd;let c=e.directiveStylingLast;for(-1===c?c=e.directiveStart:c++;c<o&&(i=t[c],r=f9(r,i.hostAttrs,s),i!==n);)c++;return null!==n&&(e.directiveStylingLast=c),r}function f9(n,t,e){const r=e?1:2;let s=-1;if(null!==t)for(let i=0;i<t.length;i++){const o=t[i];"number"==typeof o?s=o:s===r&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),G2(n,o,!!e||t[++i]))}return void 0===n?null:n}function zF(n,t,e){G2(n,t,Bi(e))}function VF(n,t,e,r,s,i,o,c){if(!(3&t.type))return;const u=n.data,h=u[c+1];iC(function Iv(n){return 1==(1&n)}(h)?HF(u,t,e,s,Fa(h),o):void 0)||(iC(i)||function Cw(n){return 2==(2&n)}(h)&&(i=HF(u,null,e,s,c,o)),function hv(n,t,e,r,s){if(t)s?n.addClass(e,r):n.removeClass(e,r);else{let i=-1===r.indexOf("-")?void 0:Y2.DashCase;null==s?n.removeStyle(e,r,i):("string"==typeof s&&s.endsWith("!important")&&(s=s.slice(0,-10),i|=Y2.Important),n.setStyle(e,r,s,i))}}(r,o,F0($2(),e),s,i))}function HF(n,t,e,r,s,i){const o=null===t;let c;for(;s>0;){const u=n[s],h=Array.isArray(u),g=h?u[1]:u,m=null===g;let v=e[s+1];v===an&&(v=m?p1:void 0);let T=m?Zs(v,r):g===r?v:void 0;if(h&&!iC(T)&&(T=Zs(u,r)),iC(T)&&(c=T,o))return c;const I=n[s+1];s=o?oa(I):Fa(I)}if(null!==t){let u=i?t.residualClasses:t.residualStyles;null!=u&&(c=Zs(u,r))}return c}function iC(n){return void 0!==n}function FF(n,t){return 0!=(n.flags&(t?16:32))}function Et(n,t=""){const e=Oe(),r=qn(),s=n+22,i=r.firstCreatePass?P6(r,s,1,t,null):r.data[s],o=e[s]=Nd(e[11],t);Cu(r,e,o,i),ka(i,!1)}function jn(n){return Ei("",n,""),jn}function Ei(n,t,e){const r=Oe(),s=c1(r,n,t,e);return s!==an&&Vc(r,$2(),s),Ei}function oC(n,t,e,r,s){const i=Oe(),o=As(i,n,t,e,r,s);return o!==an&&Vc(i,$2(),o),oC}function Jw(n,t,e,r,s,i,o){const c=Oe(),u=xo(c,n,t,e,r,s,i,o);return u!==an&&Vc(c,$2(),u),Jw}function eb(n,t,e){const r=Oe();return T1(r,Jl(),t)&&qi(qn(),C1(),r,n,t,r[11],e,!0),eb}const bu=void 0;var U3e=["en",[["a","p"],["AM","PM"],bu],[["AM","PM"],bu,bu],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],bu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],bu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",bu,"{1} 'at' {0}",bu],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function $3e(n){const e=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===r?1:5}];let v7={};function Yi(n){const t=function W3e(n){return n.toLowerCase().replace(/_/g,"-")}(n);let e=sB(t);if(e)return e;const r=t.split("-")[0];if(e=sB(r),e)return e;if("en"===r)return U3e;throw new Te(701,!1)}function sB(n){return n in v7||(v7[n]=G1.ng&&G1.ng.common&&G1.ng.common.locales&&G1.ng.common.locales[n]),v7[n]}var ft=(()=>((ft=ft||{})[ft.LocaleId=0]="LocaleId",ft[ft.DayPeriodsFormat=1]="DayPeriodsFormat",ft[ft.DayPeriodsStandalone=2]="DayPeriodsStandalone",ft[ft.DaysFormat=3]="DaysFormat",ft[ft.DaysStandalone=4]="DaysStandalone",ft[ft.MonthsFormat=5]="MonthsFormat",ft[ft.MonthsStandalone=6]="MonthsStandalone",ft[ft.Eras=7]="Eras",ft[ft.FirstDayOfWeek=8]="FirstDayOfWeek",ft[ft.WeekendRange=9]="WeekendRange",ft[ft.DateFormat=10]="DateFormat",ft[ft.TimeFormat=11]="TimeFormat",ft[ft.DateTimeFormat=12]="DateTimeFormat",ft[ft.NumberSymbols=13]="NumberSymbols",ft[ft.NumberFormats=14]="NumberFormats",ft[ft.CurrencyCode=15]="CurrencyCode",ft[ft.CurrencySymbol=16]="CurrencySymbol",ft[ft.CurrencyName=17]="CurrencyName",ft[ft.Currencies=18]="Currencies",ft[ft.Directionality=19]="Directionality",ft[ft.PluralCase=20]="PluralCase",ft[ft.ExtraData=21]="ExtraData",ft))();const q3e=["zero","one","two","few","many"],C7="en-US",aC={marker:"element"},cC={marker:"ICU"};var ts=(()=>((ts=ts||{})[ts.SHIFT=2]="SHIFT",ts[ts.APPEND_EAGERLY=1]="APPEND_EAGERLY",ts[ts.COMMENT=2]="COMMENT",ts))();let iB=C7;function oB(n){(function zi(n,t){null==n&&_1(t,n,null,"!=")})(n,"Expected localeId to be defined"),"string"==typeof n&&(iB=n.toLowerCase().replace(/_/g,"-"))}function aB(n,t,e){const r=t.insertBeforeIndex,s=Array.isArray(r)?r[0]:r;return null===s?cv(n,0,e):_r(e[s])}function cB(n,t,e,r,s){const i=t.insertBeforeIndex;if(Array.isArray(i)){let o=r,c=null;if(3&t.type||(c=o,o=s),null!==o&&0==(2&t.flags))for(let u=1;u<i.length;u++)Rc(n,o,e[i[u]],c,!1)}}function lB(n,t){if(n.push(t),n.length>1)for(let e=n.length-2;e>=0;e--){const r=n[e];uB(r)||K3e(r,t)&&null===X3e(r)&&Q3e(r,t.index)}}function uB(n){return!(64&n.type)}function K3e(n,t){return uB(t)||n.index>t.index}function X3e(n){const t=n.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function Q3e(n,t){const e=n.insertBeforeIndex;Array.isArray(e)?e[0]=t:(Z5(aB,cB),n.insertBeforeIndex=t)}function h9(n,t){const e=n.data[t];return null===e||"string"==typeof e?null:e.hasOwnProperty("currentCaseLViewIndex")?e:e.value}function t4e(n,t,e){const r=o7(n,e,64,null,null);return lB(t,r),r}function lC(n,t){const e=t[n.currentCaseLViewIndex];return null===e?e:e<0?~e:e}function fB(n){return n>>>17}function hB(n){return(131070&n)>>>1}let d9=0,p9=0;function pB(n,t,e,r){const s=e[11];let o,i=null;for(let c=0;c<t.length;c++){const u=t[c];if("string"==typeof u){const h=t[++c];null===e[h]&&(e[h]=Nd(s,u))}else if("number"==typeof u)switch(1&u){case 0:const h=fB(u);let g,m;if(null===i&&(i=h,o=y6(s,r)),h===i?(g=r,m=o):(g=null,m=_r(e[h])),null!==m){const z=hB(u);Rc(s,m,e[z],g,!1);const te=h9(n,z);if(null!==te&&"object"==typeof te){const me=lC(te,e);null!==me&&pB(n,te.create[me],e,e[te.anchorIdx])}}break;case 1:const T=t[++c],I=t[++c];o9(s,F0(u>>>1,e),null,null,T,I,null)}else switch(u){case cC:const h=t[++c],g=t[++c];null===e[g]&&E2(e[g]=qT(s,h),e);break;case aC:const m=t[++c],v=t[++c];null===e[v]&&E2(e[v]=Ad(s,m,null),e)}}}function gB(n,t,e,r,s){for(let i=0;i<e.length;i++){const o=e[i],c=e[++i];if(o&s){let u="";for(let h=i+1;h<=i+c;h++){const g=e[h];if("string"==typeof g)u+=g;else if("number"==typeof g)if(g<0)u+=Xt(t[r-g]);else{const m=g>>>2;switch(3&g){case 1:const v=e[++h],T=e[++h],I=n.data[m];"string"==typeof I?o9(t[11],t[m],null,I,v,u,T):qi(n,I,t,v,u,t[11],T,!1);break;case 0:const z=t[m];null!==z&&ev(t[11],z,u);break;case 2:o4e(n,h9(n,m),t,u);break;case 3:mB(n,h9(n,m),r,t)}}}}else{const u=e[i+1];if(u>0&&3==(3&u)){const g=h9(n,u>>>2);t[g.currentCaseLViewIndex]<0&&mB(n,g,r,t)}}i+=c}}function mB(n,t,e,r){let s=r[t.currentCaseLViewIndex];if(null!==s){let i=d9;s<0&&(s=r[t.currentCaseLViewIndex]=~s,i=-1),gB(n,r,t.update[s],e,i)}}function o4e(n,t,e,r){const s=function a4e(n,t){let e=n.cases.indexOf(t);if(-1===e)switch(n.type){case 1:{const r=function j3e(n,t){const e=function rB(n){return Yi(n)[ft.PluralCase]}(t)(parseInt(n,10)),r=q3e[e];return void 0!==r?r:"other"}(t,function Y3e(){return iB}());e=n.cases.indexOf(r),-1===e&&"other"!==r&&(e=n.cases.indexOf("other"));break}case 0:e=n.cases.indexOf("other")}return-1===e?null:e}(t,r);if(lC(t,e)!==s&&(_B(n,t,e),e[t.currentCaseLViewIndex]=null===s?null:~s,null!==s)){const o=e[t.anchorIdx];o&&pB(n,t.create[s],e,o)}}function _B(n,t,e){let r=lC(t,e);if(null!==r){const s=t.remove[r];for(let i=0;i<s.length;i++){const o=s[i];if(o>0){const c=F0(o,e);null!==c&&uv(e[11],c)}else _B(n,h9(n,~o),e)}}}function c4e(){const n=[];let e,r,t=-1;function i(c,u){t=0;const h=lC(c,u);r=null!==h?c.remove[h]:p1}function o(){if(t<r.length){const c=r[t++];return c>0?e[c]:(n.push(t,r),i(e[1].data[~c],e),o())}return 0===n.length?null:(r=n.pop(),t=n.pop(),o())}return function s(c,u){for(e=u;n.length;)n.pop();return i(c.value,u),o}}const uC=/\ufffd(\d+):?\d*\ufffd/gi,u4e=/\ufffd(\d+)\ufffd/,CB=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,f4e=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,h4e=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,d4e=/\uE500/g;function yB(n,t,e,r,s,i,o){const c=$4(n,r,1,null);let u=c<<ts.SHIFT,h=S4();t===h&&(h=null),null===h&&(u|=ts.APPEND_EAGERLY),o&&(u|=ts.COMMENT,function Q_(n){void 0===Pd&&(Pd=n())}(c4e)),s.push(u,null===i?"":i);const g=o7(n,c,o?32:1,null===i?"":i,null);lB(e,g);const m=g.index;return ka(g,!1),null!==h&&t!==h&&function e4e(n,t){let e=n.insertBeforeIndex;null===e?(Z5(aB,cB),e=n.insertBeforeIndex=[null,t]):(function a1(n,t,e){n!=t&&_1(e,n,t,"==")}(Array.isArray(e),!0,"Expecting array here"),e.push(t))}(h,m),g}function m4e(n,t,e,r,s,i,o){const c=o.match(uC),u=yB(n,t,e,i,r,c?null:o,!1);c&&m9(s,o,u.index,null,0,null)}function m9(n,t,e,r,s,i){const o=n.length,c=o+1;n.push(null,null);const u=o+2,h=t.split(uC);let g=0;for(let m=0;m<h.length;m++){const v=h[m];if(1&m){const T=s+parseInt(v,10);n.push(-1-T),g|=EB(T)}else""!==v&&n.push(v)}return n.push(e<<2|(r?1:0)),r&&n.push(r,i),n[o]=g,n[c]=n.length-u,g}function EB(n){return 1<<Math.min(n,31)}function MB(n){let t,i,e="",r=0,s=!1;for(;null!==(t=f4e.exec(n));)s?t[0]===`\ufffd/*${i}\ufffd`&&(r=t.index,s=!1):(e+=n.substring(r,t.index+t[0].length),i=t[1],s=!0);return e+=n.slice(r),e}function SB(n,t,e,r,s,i){let o=0;const c={type:s.type,currentCaseLViewIndex:$4(n,t,1,null),anchorIdx:i,cases:[],create:[],remove:[],update:[]};(function P4e(n,t,e){n.push(EB(t.mainBinding),2,-1-t.mainBinding,e<<2|2)})(e,s,i),function J3e(n,t,e){const r=n.data[t];null===r?n.data[t]=e:r.value=e}(n,i,c);const u=s.values;for(let h=0;h<u.length;h++){const g=u[h],m=[];for(let v=0;v<g.length;v++){const T=g[v];if("string"!=typeof T){const I=m.push(T)-1;g[v]=`\x3c!--\ufffd${I}\ufffd--\x3e`}}o=M4e(n,c,t,e,r,s.cases[h],g.join(""),m)|o}o&&function T4e(n,t,e){n.push(t,1,e<<2|3)}(e,o,i)}function E4e(n){const t=[],e=[];let r=1,s=0;const i=tb(n=n.replace(CB,function(o,c,u){return r="select"===u?0:1,s=parseInt(c.slice(1),10),""}));for(let o=0;o<i.length;){let c=i[o++].trim();1===r&&(c=c.replace(/\s*(?:=)?(\w+)\s*/,"$1")),c.length&&t.push(c);const u=tb(i[o++]);t.length>e.length&&e.push(u)}return{type:r,mainBinding:s,cases:t,values:e}}function tb(n){if(!n)return[];let t=0;const e=[],r=[],s=/[{}]/g;let i;for(s.lastIndex=0;i=s.exec(n);){const c=i.index;if("}"==i[0]){if(e.pop(),0==e.length){const u=n.substring(t,c);CB.test(u)?r.push(E4e(u)):r.push(u),t=c+1}}else{if(0==e.length){const u=n.substring(t,c);r.push(u),t=c+1}e.push("{")}}const o=n.substring(t);return r.push(o),r}function M4e(n,t,e,r,s,i,o,c){const u=[],h=[],g=[];t.cases.push(i),t.create.push(u),t.remove.push(h),t.update.push(g);const v=y_(d_()).getInertBodyElement(o),T=Ui(v)||v;return T?PB(n,t,e,r,u,h,g,T,s,c,0):0}function PB(n,t,e,r,s,i,o,c,u,h,g){let m=0,v=c.firstChild;for(;v;){const T=$4(n,e,1,null);switch(v.nodeType){case Node.ELEMENT_NODE:const I=v,z=I.tagName.toLowerCase();if(cu.hasOwnProperty(z)){nb(s,aC,z,u,T),n.data[T]=z;const J=I.attributes;for(let Ne=0;Ne<J.length;Ne++){const He=J.item(Ne),qe=He.name.toLowerCase();He.value.match(uC)?R5.hasOwnProperty(qe)&&m9(o,He.value,T,He.name,0,k5[qe]?Io:null):w4e(s,T,He)}m=PB(n,t,e,r,s,i,o,v,T,h,g+1)|m,TB(i,T,g)}break;case Node.TEXT_NODE:const Z=v.textContent||"",te=Z.match(uC);nb(s,null,te?"":Z,u,T),TB(i,T,g),te&&(m=m9(o,Z,T,null,0,null)|m);break;case Node.COMMENT_NODE:const me=u4e.exec(v.textContent||"");if(me){const Ne=h[parseInt(me[1],10)];nb(s,cC,"",u,T),SB(n,e,r,u,Ne,T),S4e(i,T,g)}}v=v.nextSibling}return m}function TB(n,t,e){0===e&&n.push(t)}function S4e(n,t,e){0===e&&(n.push(~t),n.push(t))}function nb(n,t,e,r,s){null!==t&&n.push(t),n.push(e,s,function n4e(n,t,e){return n|t<<17|e<<1}(0,r,s))}function w4e(n,t,e){n.push(t<<1|1,e.name,e.value)}function $a(n,t,e=-1){const r=qn(),s=Oe(),i=22+n,o=Sc(r.consts,t),c=S4();r.firstCreatePass&&function g4e(n,t,e,r,s,i){const o=S4(),c=[],u=[],h=[[]];s=function y4e(n,t){if(function C4e(n){return-1===n}(t))return MB(n);{const e=n.indexOf(`:${t}\ufffd`)+2+t.toString().length,r=n.search(new RegExp(`\ufffd\\/\\*\\d+:${t}\ufffd`));return MB(n.substring(e,r))}}(s,i);const g=function p4e(n){return n.replace(d4e," ")}(s).split(h4e);for(let m=0;m<g.length;m++){let v=g[m];if(0==(1&m)){const T=tb(v);for(let I=0;I<T.length;I++){let z=T[I];if(0==(1&I)){const Z=z;""!==Z&&m4e(n,o,h[0],c,u,e,Z)}else{const Z=z;if("object"!=typeof Z)throw new Error(`Unable to parse ICU expression in "${s}" message.`);SB(n,e,u,t,Z,yB(n,o,h[0],e,c,"",!0).index)}}}else{const T=47===v.charCodeAt(0),z=(v.charCodeAt(T?1:0),22+Number.parseInt(v.substring(T?2:1)));if(T)h.shift(),ka(S4(),!1);else{const Z=t4e(n,h[0],z);h.unshift([]),ka(Z,!0)}}}n.data[r]={create:c,update:u}}(r,null===c?0:c.index,s,i,o,e);const u=r.data[i],g=Ld(r,c===s[6]?null:c,s);(function i4e(n,t,e,r){const s=n[11];for(let i=0;i<t.length;i++){const o=t[i++],c=t[i],u=(o&ts.COMMENT)===ts.COMMENT,h=(o&ts.APPEND_EAGERLY)===ts.APPEND_EAGERLY,g=o>>>ts.SHIFT;let m=n[g];null===m&&(m=n[g]=u?s.createComment(c):Nd(s,c)),h&&null!==e&&Rc(s,e,m,r,!1)}})(s,u.create,g,c&&8&c.type?s[c.index]:null),B2(!0)}function Ua(){B2(!1)}function de(n,t,e){$a(n,t,e),Ua()}function w1(n){return function r4e(n){n&&(d9|=1<<Math.min(p9,31)),p9++}(T1(Oe(),Jl(),n)),w1}function k1(n){!function s4e(n,t,e){if(p9>0){const r=n.data[e];gB(n,t,Array.isArray(r)?r:r.update,Ra()-p9-1,d9)}d9=0,p9=0}(qn(),Oe(),n+22)}function rb(n,t,e,r,s){if(n=Kt(n),Array.isArray(n))for(let i=0;i<n.length;i++)rb(n[i],t,e,r,s);else{const i=qn(),o=Oe();let c=D4(n)?n:Kt(n.provide),u=F5(n);const h=Or(),g=1048575&h.providerIndexes,m=h.directiveStart,v=h.providerIndexes>>20;if(D4(n)||!n.multi){const T=new j0(u,s,Q),I=ib(c,t,s?g:g+v,m);-1===I?(r6(C5(h,o),i,c),sb(i,n,t.length),t.push(c),h.directiveStart++,h.directiveEnd++,s&&(h.providerIndexes+=1048576),e.push(T),o.push(T)):(e[I]=T,o[I]=T)}else{const T=ib(c,t,g+v,m),I=ib(c,t,g,g+v),z=T>=0&&e[T],Z=I>=0&&e[I];if(s&&!Z||!s&&!z){r6(C5(h,o),i,c);const te=function F4e(n,t,e,r,s){const i=new j0(n,e,Q);return i.multi=[],i.index=t,i.componentProviders=0,bB(i,s,r&&!e),i}(s?H4e:V4e,e.length,s,r,u);!s&&Z&&(e[I].providerFactory=te),sb(i,n,t.length,0),t.push(c),h.directiveStart++,h.directiveEnd++,s&&(h.providerIndexes+=1048576),e.push(te),o.push(te)}else sb(i,n,T>-1?T:I,bB(e[s?I:T],u,!s&&r));!s&&r&&Z&&e[I].componentProviders++}}}function sb(n,t,e,r){const s=D4(t),i=function fT(n){return!!n.useClass}(t);if(s||i){const u=(i?Kt(t.useClass):t).prototype.ngOnDestroy;if(u){const h=n.destroyHooks||(n.destroyHooks=[]);if(!s&&t.multi){const g=h.indexOf(e);-1===g?h.push(e,[r,u]):h[g+1].push(r,u)}else h.push(e,u)}}}function bB(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function ib(n,t,e,r){for(let s=e;s<r;s++)if(t[s]===n)return s;return-1}function V4e(n,t,e,r){return ob(this.multi,[])}function H4e(n,t,e,r){const s=this.multi;let i;if(this.providerFactory){const o=this.providerFactory.componentProviders,c=Ns(e,e[1],this.providerFactory.index,r);i=c.slice(0,o),ob(s,i);for(let u=o;u<c.length;u++)i.push(c[u])}else i=[],ob(s,i);return i}function ob(n,t){for(let e=0;e<n.length;e++)t.push((0,n[e])());return t}function xr(n,t=[]){return e=>{e.providersResolver=(r,s)=>function z4e(n,t,e){const r=qn();if(r.firstCreatePass){const s=ds(n);rb(e,r.data,r.blueprint,s,!0),rb(t,r.data,r.blueprint,s,!1)}}(r,s?s(n):n,t)}}class Nu{}class NB{}class AB extends Nu{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new l9(this);const r=Vi(t);this._bootstrapComponents=sa(r.bootstrap),this._r3Injector=Pv(t,e,[{provide:Nu,useValue:this},{provide:ra,useValue:this.componentFactoryResolver}],F1(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class ab extends NB{constructor(t){super(),this.moduleType=t}create(t){return new AB(this.moduleType,t)}}class $4e extends Nu{constructor(t,e,r){super(),this.componentFactoryResolver=new l9(this),this.instance=null;const s=new H5([...t,{provide:Nu,useValue:this},{provide:ra,useValue:this.componentFactoryResolver}],e||O3(),r,new Set(["environment"]));this.injector=s,s.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function fC(n,t,e=null){return new $4e(n,t,e).injector}let U4e=(()=>{class n{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e.id)){const r=hd(0,e.type),s=r.length>0?fC([r],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e.id,s)}return this.cachedInjectors.get(e.id)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=Xe({token:n,providedIn:"environment",factory:()=>new n(xe(na))}),n})();function OB(n){n.getStandaloneInjector=t=>t.get(U4e).getOrCreateStandaloneInjector(n)}function ar(n,t,e){const r=_2()+n,s=Oe();return s[r]===an?fn(s,r,e?t.call(e):t()):function q1(n,t){return n[t]}(s,r)}function N6(n,t,e,r){return zB(Oe(),_2(),n,t,e,r)}function _9(n,t){const e=n[t];return e===an?void 0:e}function zB(n,t,e,r,s,i){const o=t+e;return T1(n,o,s)?fn(n,o+1,i?r.call(i,s):r(s)):_9(n,o+1)}function Ga(n,t){const e=qn();let r;const s=n+22;e.firstCreatePass?(r=function ole(n,t){if(t)for(let e=t.length-1;e>=0;e--){const r=t[e];if(n===r.name)return r}}(t,e.pipeRegistry),e.data[s]=r,r.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(s,r.onDestroy)):r=e.data[s];const i=r.factory||(r.factory=Ko(r.type)),o=yo(Q);try{const c=P3(!1),u=i();return P3(c),function t3e(n,t,e,r){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=r}(e,Oe(),s,u),u}finally{yo(o)}}function Bc(n,t,e){const r=n+22,s=Oe(),i=M4(s,r);return v9(s,r)?zB(s,_2(),t,i.transform,e,i):i.transform(e)}function $B(n,t,e,r){const s=n+22,i=Oe(),o=M4(i,s);return v9(i,s)?function VB(n,t,e,r,s,i,o){const c=t+e;return K2(n,c,s,i)?fn(n,c+2,o?r.call(o,s,i):r(s,i)):_9(n,c+2)}(i,_2(),t,o.transform,e,r,o):o.transform(e,r)}function v9(n,t){return n[1].data[t].pure}function lb(n){return t=>{setTimeout(n,void 0,t)}}const cr=class ule extends pi{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,r){let s=t,i=e||(()=>null),o=r;if(t&&"object"==typeof t){const u=t;s=u.next?.bind(u),i=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(i=lb(i),s&&(s=lb(s)),o&&(o=lb(o)));const c=super.subscribe({next:s,error:i,complete:o});return t instanceof H1&&t.add(c),c}};function fle(){return this._results[Ee()]()}class ub{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Ee(),r=ub.prototype;r[e]||(r[e]=fle)}get changes(){return this._changes||(this._changes=new cr)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const r=this;r.dirty=!1;const s=U2(t);(this._changesDetected=!function Wh(n,t,e){if(n.length!==t.length)return!1;for(let r=0;r<n.length;r++){let s=n[r],i=t[r];if(e&&(s=e(s),i=e(i)),i!==s)return!1}return!0}(r._results,s,e))&&(r._results=s,r.length=s.length,r.last=s[this.length-1],r.first=s[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let G4=(()=>{class n{}return n.__NG_ELEMENT_ID__=ple,n})();const hle=G4,dle=class extends hle{constructor(t,e,r){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=r}createEmbeddedView(t,e){const r=this._declarationTContainer.tViews,s=i7(this._declarationLView,r,t,16,null,r.declTNode,null,null,null,null,e||null);s[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(s[19]=o.createEmbeddedView(r)),a7(r,s,t),new m7(s)}};function ple(){return hC(Or(),Oe())}function hC(n,t){return 4&n.type?new dle(t,n,m6(n,t)):null}let la=(()=>{class n{}return n.__NG_ELEMENT_ID__=gle,n})();function gle(){return WB(Or(),Oe())}const mle=la,UB=class extends mle{constructor(t,e,r){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=r}get element(){return m6(this._hostTNode,this._hostLView)}get injector(){return new s6(this._hostTNode,this._hostLView)}get parentInjector(){const t=Jo(this._hostTNode,this._hostLView);if(Vh(t)){const e=N4(t,this._hostLView),r=b4(t);return new s6(e[1].data[r+8],e)}return new s6(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=GB(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,r){let s,i;"number"==typeof r?s=r:null!=r&&(s=r.index,i=r.injector);const o=t.createEmbeddedView(e||{},i);return this.insert(o,s),o}createComponent(t,e,r,s,i){const o=t&&!function v2(n){return"function"==typeof n}(t);let c;if(o)c=e;else{const m=e||{};c=m.index,r=m.injector,s=m.projectableNodes,i=m.environmentInjector||m.ngModuleRef}const u=o?t:new Tu(v1(t)),h=r||this.parentInjector;if(!i&&null==u.ngModule){const v=(o?h:this.parentInjector).get(na,null);v&&(i=v)}const g=u.create(h,s,void 0,i);return this.insert(g.hostView,c),g}insert(t,e){const r=t._lView,s=r[1];if(function B0(n){return mr(n[3])}(r)){const g=this.indexOf(t);if(-1!==g)this.detach(g);else{const m=r[3],v=new UB(m,m[6],m[3]);v.detach(v.indexOf(t))}}const i=this._adjustIndex(e),o=this._lContainer;!function XT(n,t,e,r){const s=10+r,i=e.length;r>0&&(e[s-1][4]=t),r<i-10?(t[4]=e[s],Oc(e,10+r,t)):(e.push(t),t[4]=null),t[3]=e;const o=t[17];null!==o&&e!==o&&function QT(n,t){const e=n[9];t[16]!==t[3][3][16]&&(n[2]=!0),null===e?n[9]=[t]:e.push(t)}(o,t);const c=t[19];null!==c&&c.insertView(n),t[2]|=64}(s,r,o,i);const c=E6(i,o),u=r[11],h=y6(u,o[7]);return null!==h&&function ZT(n,t,e,r,s,i){r[0]=s,r[6]=t,M6(n,r,e,1,s,i)}(s,o[6],u,r,h,c),t.attachToViewContainerRef(),Oc(fb(o),i,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=GB(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),r=Od(this._lContainer,e);r&&(l6(fb(this._lContainer),e),nv(r[1],r))}detach(t){const e=this._adjustIndex(t,-1),r=Od(this._lContainer,e);return r&&null!=l6(fb(this._lContainer),e)?new m7(r):null}_adjustIndex(t,e=0){return t??this.length+e}};function GB(n){return n[8]}function fb(n){return n[8]||(n[8]=[])}function WB(n,t){let e;const r=t[n.index];if(mr(r))e=r;else{let s;if(8&n.type)s=_r(r);else{const i=t[11];s=i.createComment("");const o=F2(n,t);Rc(i,y6(i,o),s,function ov(n,t){return n.nextSibling(t)}(i,o),!1)}t[n.index]=e=jv(r,t,s,n),h7(t,e)}return new UB(e,n,t)}class hb{constructor(t){this.queryList=t,this.matches=null}clone(){return new hb(this.queryList)}setDirty(){this.queryList.setDirty()}}class db{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const r=null!==t.contentQueries?t.contentQueries[0]:e.length,s=[];for(let i=0;i<r;i++){const o=e.getByIndex(i);s.push(this.queries[o.indexInDeclarationView].clone())}return new db(s)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==KB(t,e).matches&&this.queries[e].setDirty()}}class qB{constructor(t,e,r=null){this.predicate=t,this.flags=e,this.read=r}}class pb{constructor(t=[]){this.queries=t}elementStart(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let r=0;r<this.length;r++){const s=null!==e?e.length:0,i=this.getByIndex(r).embeddedTView(t,s);i&&(i.indexInDeclarationView=r,null!==e?e.push(i):e=[i])}return null!==e?new pb(e):null}template(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class gb{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new gb(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let r=t.parent;for(;null!==r&&8&r.type&&r.index!==e;)r=r.parent;return e===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const r=this.metadata.predicate;if(Array.isArray(r))for(let s=0;s<r.length;s++){const i=r[s];this.matchTNodeWithReadOption(t,e,Cle(e,i)),this.matchTNodeWithReadOption(t,e,$r(e,t,i,!1,!1))}else r===G4?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,$r(e,t,r,!1,!1))}matchTNodeWithReadOption(t,e,r){if(null!==r){const s=this.metadata.read;if(null!==s)if(s===j2||s===la||s===G4&&4&e.type)this.addMatch(e.index,-2);else{const i=$r(e,t,s,!1,!1);null!==i&&this.addMatch(e.index,i)}else this.addMatch(e.index,r)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function Cle(n,t){const e=n.localNames;if(null!==e)for(let r=0;r<e.length;r+=2)if(e[r]===t)return e[r+1];return null}function Ele(n,t,e,r){return-1===e?function yle(n,t){return 11&n.type?m6(n,t):4&n.type?hC(n,t):null}(t,n):-2===e?function Mle(n,t,e){return e===j2?m6(t,n):e===G4?hC(t,n):e===la?WB(t,n):void 0}(n,t,r):Ns(n,n[1],e,t)}function jB(n,t,e,r){const s=t[19].queries[r];if(null===s.matches){const i=n.data,o=e.matches,c=[];for(let u=0;u<o.length;u+=2){const h=o[u];c.push(h<0?null:Ele(t,i[h],o[u+1],e.metadata.read))}s.matches=c}return s.matches}function mb(n,t,e,r){const s=n.queries.getByIndex(e),i=s.matches;if(null!==i){const o=jB(n,t,s,e);for(let c=0;c<i.length;c+=2){const u=i[c];if(u>0)r.push(o[c/2]);else{const h=i[c+1],g=t[-u];for(let m=10;m<g.length;m++){const v=g[m];v[17]===v[3]&&mb(v[1],v,h,r)}if(null!==g[9]){const m=g[9];for(let v=0;v<m.length;v++){const T=m[v];mb(T[1],T,h,r)}}}}}return r}function Wa(n){const t=Oe(),e=qn(),r=Lh();$0(r+1);const s=KB(e,r);if(n.dirty&&function Um(n){return 4==(4&n[2])}(t)===(2==(2&s.metadata.flags))){if(null===s.matches)n.reset([]);else{const i=s.crossesNgTemplate?mb(e,t,r,[]):jB(e,t,s,r);n.reset(i,$5),n.notifyOnChanges()}return!0}return!1}function V3(n,t,e){const r=qn();r.firstCreatePass&&(function YB(n,t,e){null===n.queries&&(n.queries=new pb),n.queries.track(new gb(t,e))}(r,new qB(n,t,e),-1),2==(2&t)&&(r.staticViewQueries=!0)),function ZB(n,t,e){const r=new ub(4==(4&e));kw(n,t,r,r.destroy),null===t[19]&&(t[19]=new db),t[19].queries.push(new hb(r))}(r,Oe(),t)}function qa(){return function Sle(n,t){return n[19].queries[t].queryList}(Oe(),Lh())}function KB(n,t){return n.queries.getByIndex(t)}function l1(n,t){return hC(n,t)}function pC(...n){}const gC=new It("Application Initializer");let mC=(()=>{class n{constructor(e){this.appInits=e,this.resolve=pC,this.reject=pC,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,s)=>{this.resolve=r,this.reject=s})}runInitializers(){if(this.initialized)return;const e=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let s=0;s<this.appInits.length;s++){const i=this.appInits[s]();if(u9(i))e.push(i);else if(Kw(i)){const o=new Promise((c,u)=>{i.subscribe({complete:c,error:u})});e.push(o)}}Promise.all(e).then(()=>{r()}).catch(s=>{this.reject(s)}),0===e.length&&r(),this.initialized=!0}}return n.\u0275fac=function(e){return new(e||n)(xe(gC,8))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const y9=new It("AppId",{providedIn:"root",factory:function g$(){return`${Mb()}${Mb()}${Mb()}`}});function Mb(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const m$=new It("Platform Initializer"),E9=new It("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),_$=new It("appBootstrapListener"),v$=new It("AnimationModuleType");let Gle=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const H3=new It("LocaleId",{providedIn:"root",factory:()=>Ir(H3,$t.Optional|$t.SkipSelf)||function Wle(){return typeof $localize<"u"&&$localize.locale||C7}()});class jle{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}let Sb=(()=>{class n{compileModuleSync(e){return new ab(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const r=this.compileModuleSync(e),i=sa(Vi(e).declarations).reduce((o,c)=>{const u=v1(c);return u&&o.push(new Tu(u)),o},[]);return new jle(r,i)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Kle=(()=>Promise.resolve(0))();function Pb(n){typeof Zone>"u"?Kle.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class vr{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new cr(!1),this.onMicrotaskEmpty=new cr(!1),this.onStable=new cr(!1),this.onError=new cr(!1),typeof Zone>"u")throw new Te(908,!1);Zone.assertZonePatched();const s=this;if(s._nesting=0,s._outer=s._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const i=Zone.AsyncStackTaggingZoneSpec;s._inner=s._inner.fork(new i("Angular"))}Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&e,s.shouldCoalesceRunChangeDetection=r,s.lastRequestAnimationFrameId=-1,s.nativeRequestAnimationFrame=function Xle(){let n=G1.requestAnimationFrame,t=G1.cancelAnimationFrame;if(typeof Zone<"u"&&n&&t){const e=n[Zone.__symbol__("OriginalDelegate")];e&&(n=e);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function e6e(n){const t=()=>{!function Jle(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(G1,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,wb(n),n.isCheckStableRunning=!0,Tb(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),wb(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,r,s,i,o,c)=>{try{return E$(n),e.invokeTask(s,i,o,c)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===i.type||n.shouldCoalesceRunChangeDetection)&&t(),M$(n)}},onInvoke:(e,r,s,i,o,c,u)=>{try{return E$(n),e.invoke(s,i,o,c,u)}finally{n.shouldCoalesceRunChangeDetection&&t(),M$(n)}},onHasTask:(e,r,s,i)=>{e.hasTask(s,i),r===s&&("microTask"==i.change?(n._hasPendingMicrotasks=i.microTask,wb(n),Tb(n)):"macroTask"==i.change&&(n.hasPendingMacrotasks=i.macroTask))},onHandleError:(e,r,s,i)=>(e.handleError(s,i),n.runOutsideAngular(()=>n.onError.emit(i)),!1)})}(s)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!vr.isInAngularZone())throw new Te(909,!1)}static assertNotInAngularZone(){if(vr.isInAngularZone())throw new Te(909,!1)}run(t,e,r){return this._inner.run(t,e,r)}runTask(t,e,r,s){const i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+s,t,Qle,pC,pC);try{return i.runTask(o,e,r)}finally{i.cancelTask(o)}}runGuarded(t,e,r){return this._inner.runGuarded(t,e,r)}runOutsideAngular(t){return this._outer.run(t)}}const Qle={};function Tb(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function wb(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function E$(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function M$(n){n._nesting--,Tb(n)}class t6e{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new cr,this.onMicrotaskEmpty=new cr,this.onStable=new cr,this.onError=new cr}run(t,e,r){return t.apply(e,r)}runGuarded(t,e,r){return t.apply(e,r)}runOutsideAngular(t){return t()}runTask(t,e,r,s){return t.apply(e,r)}}const S$=new It(""),_C=new It("");let Ab,bb=(()=>{class n{constructor(e,r,s){this._ngZone=e,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Ab||(function n6e(n){Ab=n}(s),s.addToWindow(r)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{vr.assertNotInAngularZone(),Pb(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Pb(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(e)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,r,s){let i=-1;r&&r>0&&(i=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==i),e(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:s})}whenStable(e,r,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,r,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,r,s){return[]}}return n.\u0275fac=function(e){return new(e||n)(xe(vr),xe(Nb),xe(_C))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})(),Nb=(()=>{class n{constructor(){this._applications=new Map}registerApplication(e,r){this._applications.set(e,r)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,r=!0){return Ab?.findTestabilityInTree(this,e,r)??null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),A6=null;const P$=new It("AllowMultipleToken"),Ob=new It("PlatformDestroyListeners");class T${constructor(t,e){this.name=t,this.token=e}}function b$(n,t,e=[]){const r=`Platform: ${t}`,s=new It(r);return(i=[])=>{let o=Ib();if(!o||o.injector.get(P$,!1)){const c=[...e,...i,{provide:s,useValue:!0}];n?n(c):function i6e(n){if(A6&&!A6.get(P$,!1))throw new Te(400,!1);A6=n;const t=n.get(A$);(function w$(n){const t=n.get(m$,null);t&&t.forEach(e=>e())})(n)}(function N$(n=[],t){return Xs.create({name:t,providers:[{provide:pd,useValue:"platform"},{provide:Ob,useValue:new Set([()=>A6=null])},...n]})}(c,r))}return function a6e(n){const t=Ib();if(!t)throw new Te(401,!1);return t}()}}function Ib(){return A6?.get(A$)??null}let A$=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,r){const s=function I$(n,t){let e;return e="noop"===n?new t6e:("zone.js"===n?void 0:n)||new vr(t),e}(r?.ngZone,function O$(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(r)),i=[{provide:vr,useValue:s}];return s.run(()=>{const o=Xs.create({providers:i,parent:this.injector,name:e.moduleType.name}),c=e.create(o),u=c.injector.get(C6,null);if(!u)throw new Te(402,!1);return s.runOutsideAngular(()=>{const h=s.onError.subscribe({next:g=>{u.handleError(g)}});c.onDestroy(()=>{vC(this._modules,c),h.unsubscribe()})}),function x$(n,t,e){try{const r=e();return u9(r)?r.catch(s=>{throw t.runOutsideAngular(()=>n.handleError(s)),s}):r}catch(r){throw t.runOutsideAngular(()=>n.handleError(r)),r}}(u,s,()=>{const h=c.injector.get(mC);return h.runInitializers(),h.donePromise.then(()=>(oB(c.injector.get(H3,C7)||C7),this._moduleDoBootstrap(c),c))})})}bootstrapModule(e,r=[]){const s=L$({},r);return function r6e(n,t,e){const r=new ab(e);return Promise.resolve(r)}(0,0,e).then(i=>this.bootstrapModuleFactory(i,s))}_moduleDoBootstrap(e){const r=e.injector.get(M9);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(s=>r.bootstrap(s));else{if(!e.instance.ngDoBootstrap)throw new Te(403,!1);e.instance.ngDoBootstrap(r)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Te(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const e=this._injector.get(Ob,null);e&&(e.forEach(r=>r()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(e){return new(e||n)(xe(Xs))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function L$(n,t){return Array.isArray(t)?t.reduce(L$,n):{...n,...t}}let M9=(()=>{class n{constructor(e,r,s){this._zone=e,this._injector=r,this._exceptionHandler=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const i=new gr(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),o=new gr(c=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{vr.assertNotInAngularZone(),Pb(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const h=this._zone.onUnstable.subscribe(()=>{vr.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{u.unsubscribe(),h.unsubscribe()}});this.isStable=function bm(...n){const t=g3(n),e=function Y8(n,t){return"number"==typeof v4(n)?n.pop():t}(n,1/0),r=n;return r.length?1===r.length?mo(r[0]):_4(e)(Jr(r,t)):xa}(i,o.pipe(function dP(n={}){const{connector:t=(()=>new pi),resetOnError:e=!0,resetOnComplete:r=!0,resetOnRefCountZero:s=!0}=n;return i=>{let o,c,u,h=0,g=!1,m=!1;const v=()=>{c?.unsubscribe(),c=void 0},T=()=>{v(),o=u=void 0,g=m=!1},I=()=>{const z=o;T(),z?.unsubscribe()};return or((z,Z)=>{h++,!m&&!g&&v();const te=u=u??t();Z.add(()=>{h--,0===h&&!m&&!g&&(c=Q8(I,s))}),te.subscribe(Z),!o&&h>0&&(o=new er({next:me=>te.next(me),error:me=>{m=!0,v(),c=Q8(T,e,me),te.error(me)},complete:()=>{g=!0,v(),c=Q8(T,r),te.complete()}}),mo(z).subscribe(o))})(i)}}()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,r){const s=e instanceof V_;if(!this._injector.get(mC).done)throw!s&&function E4(n){const t=v1(n)||R2(n)||D2(n);return null!==t&&t.standalone}(e),new Te(405,false);let o;o=s?e:this._injector.get(ra).resolveComponentFactory(e),this.componentTypes.push(o.componentType);const c=function s6e(n){return n.isBoundToModule}(o)?void 0:this._injector.get(Nu),h=o.create(Xs.NULL,[],r||o.selector,c),g=h.location.nativeElement,m=h.injector.get(S$,null);return m?.registerApplication(g),h.onDestroy(()=>{this.detachView(h.hostView),vC(this.components,h),m?.unregisterApplication(g)}),this._loadComponent(h),h}tick(){if(this._runningTick)throw new Te(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const r=e;this._views.push(r),r.attachToAppRef(this)}detachView(e){const r=e;vC(this._views,r),r.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(_$,[]).concat(this._bootstrapListeners).forEach(s=>s(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>vC(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new Te(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(e){return new(e||n)(xe(vr),xe(na),xe(C6))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function vC(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}let R$=!0,Au=(()=>{class n{}return n.__NG_ELEMENT_ID__=u6e,n})();function u6e(n){return function f6e(n,t,e){if(Po(n)&&!e){const r=m2(n.index,t);return new m7(r,r)}return 47&n.type?new m7(t[16],t):null}(Or(),Oe(),16==(16&n))}class F${constructor(){}supports(t){return ke(t)}create(t){return new _6e(t)}}const m6e=(n,t)=>t;class _6e{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||m6e}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,r=this._removalsHead,s=0,i=null;for(;e||r;){const o=!r||e&&e.currentIndex<$$(r,s,i)?e:r,c=$$(o,s,i),u=o.currentIndex;if(o===r)s--,r=r._nextRemoved;else if(e=e._next,null==o.previousIndex)s++;else{i||(i=[]);const h=c-s,g=u-s;if(h!=g){for(let v=0;v<h;v++){const T=v<i.length?i[v]:i[v]=0,I=T+v;g<=I&&I<h&&(i[v]=T+1)}i[o.previousIndex]=g-h}}c!==u&&t(o,c,u)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!ke(t))throw new Te(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let s,i,o,e=this._itHead,r=!1;if(Array.isArray(t)){this.length=t.length;for(let c=0;c<this.length;c++)i=t[c],o=this._trackByFn(c,i),null!==e&&Object.is(e.trackById,o)?(r&&(e=this._verifyReinsertion(e,i,o,c)),Object.is(e.item,i)||this._addIdentityChange(e,i)):(e=this._mismatch(e,i,o,c),r=!0),e=e._next}else s=0,function Je(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{const e=n[Ee()]();let r;for(;!(r=e.next()).done;)t(r.value)}}(t,c=>{o=this._trackByFn(s,c),null!==e&&Object.is(e.trackById,o)?(r&&(e=this._verifyReinsertion(e,c,o,s)),Object.is(e.item,c)||this._addIdentityChange(e,c)):(e=this._mismatch(e,c,o,s),r=!0),e=e._next,s++}),this.length=s;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,r,s){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,s)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(r,s))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,s)):t=this._addAfter(new v6e(e,r),i,s),t}_verifyReinsertion(t,e,r,s){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==i?t=this._reinsertAfter(i,t._prev,s):t.currentIndex!=s&&(t.currentIndex=s,this._addToMoves(t,s)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const s=t._prevRemoved,i=t._nextRemoved;return null===s?this._removalsHead=i:s._nextRemoved=i,null===i?this._removalsTail=s:i._prevRemoved=s,this._insertAfter(t,e,r),this._addToMoves(t,r),t}_moveAfter(t,e,r){return this._unlink(t),this._insertAfter(t,e,r),this._addToMoves(t,r),t}_addAfter(t,e,r){return this._insertAfter(t,e,r),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,r){const s=null===e?this._itHead:e._next;return t._next=s,t._prev=e,null===s?this._itTail=t:s._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new B$),this._linkedRecords.put(t),t.currentIndex=r,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,r=t._next;return null===e?this._itHead=r:e._next=r,null===r?this._itTail=e:r._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new B$),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class v6e{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class C6e{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===e||e<=r.currentIndex)&&Object.is(r.trackById,t))return r;return null}remove(t){const e=t._prevDup,r=t._nextDup;return null===e?this._head=r:e._nextDup=r,null===r?this._tail=e:r._prevDup=e,null===this._head}}class B${constructor(){this.map=new Map}put(t){const e=t.trackById;let r=this.map.get(e);r||(r=new C6e,this.map.set(e,r)),r.add(t)}get(t,e){const s=this.map.get(t);return s?s.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function $$(n,t,e){const r=n.previousIndex;if(null===r)return r;let s=0;return e&&r<e.length&&(s=e[r]),r+t+s}class U${constructor(){}supports(t){return t instanceof Map||pt(t)}create(){return new y6e}}class y6e{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||pt(t)))throw new Te(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(r,s)=>{if(e&&e.key===s)this._maybeAddToChanges(e,r),this._appendAfter=e,e=e._next;else{const i=this._getOrCreateRecordForKey(s,r);e=this._insertBeforeOrAppend(e,i)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let r=e;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const r=t._prev;return e._next=t,e._prev=r,t._prev=e,r&&(r._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const s=this._records.get(t);this._maybeAddToChanges(s,e);const i=s._prev,o=s._next;return i&&(i._next=o),o&&(o._prev=i),s._next=null,s._prev=null,s}const r=new E6e(t);return this._records.set(t,r),r.currentValue=e,this._addToAdditions(r),r}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(r=>e(t[r],r))}}class E6e{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function G$(){return new EC([new F$])}let EC=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(null!=r){const s=r.factories.slice();e=e.concat(s)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||G$()),deps:[[n,new su,new Ks]]}}find(e){const r=this.factories.find(s=>s.supports(e));if(null!=r)return r;throw new Te(901,!1)}}return n.\u0275prov=Xe({token:n,providedIn:"root",factory:G$}),n})();function W$(){return new S9([new U$])}let S9=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(r){const s=r.factories.slice();e=e.concat(s)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||W$()),deps:[[n,new su,new Ks]]}}find(e){const r=this.factories.find(s=>s.supports(e));if(r)return r;throw new Te(901,!1)}}return n.\u0275prov=Xe({token:n,providedIn:"root",factory:W$}),n})();const P6e=b$(null,"core",[]);let T6e=(()=>{class n{constructor(e){}}return n.\u0275fac=function(e){return new(e||n)(xe(M9))},n.\u0275mod=qs({type:n}),n.\u0275inj=Fr({}),n})();function q4(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}let MC=null;function F3(){return MC}const Os=new It("DocumentToken");let Db=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Xe({token:n,factory:function(){return function A6e(){return xe(q$)}()},providedIn:"platform"}),n})();const O6e=new It("Location Initialized");let q$=(()=>{class n extends Db{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return F3().getBaseHref(this._doc)}onPopState(e){const r=F3().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){const r=F3().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,r,s){j$()?this._history.pushState(e,r,s):this.location.hash=s}replaceState(e,r,s){j$()?this._history.replaceState(e,r,s):this.location.hash=s}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return n.\u0275fac=function(e){return new(e||n)(xe(Os))},n.\u0275prov=Xe({token:n,factory:function(){return function I6e(){return new q$(xe(Os))}()},providedIn:"platform"}),n})();function j$(){return!!window.history.pushState}function zb(n,t){if(0==n.length)return t;if(0==t.length)return n;let e=0;return n.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?n+t.substring(1):1==e?n+t:n+"/"+t}function Z$(n){const t=n.match(/#|\?|$/),e=t&&t.index||n.length;return n.slice(0,e-("/"===n[e-1]?1:0))+n.slice(e)}function j4(n){return n&&"?"!==n[0]?"?"+n:n}let Iu=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Xe({token:n,factory:function(){return Ir(K$)},providedIn:"root"}),n})();const Y$=new It("appBaseHref");let K$=(()=>{class n extends Iu{constructor(e,r){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??Ir(Os).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return zb(this._baseHref,e)}path(e=!1){const r=this._platformLocation.pathname+j4(this._platformLocation.search),s=this._platformLocation.hash;return s&&e?`${r}${s}`:r}pushState(e,r,s,i){const o=this.prepareExternalUrl(s+j4(i));this._platformLocation.pushState(e,r,o)}replaceState(e,r,s,i){const o=this.prepareExternalUrl(s+j4(i));this._platformLocation.replaceState(e,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(xe(Db),xe(Y$,8))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),x6e=(()=>{class n extends Iu{constructor(e,r){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(e){const r=zb(this._baseHref,e);return r.length>0?"#"+r:r}pushState(e,r,s,i){let o=this.prepareExternalUrl(s+j4(i));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(e,r,o)}replaceState(e,r,s,i){let o=this.prepareExternalUrl(s+j4(i));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(e,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(xe(Db),xe(Y$,8))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})(),Vb=(()=>{class n{constructor(e){this._subject=new cr,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const r=this._locationStrategy.getBaseHref();this._baseHref=Z$(X$(r)),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+j4(r))}normalize(e){return n.stripTrailingSlash(function k6e(n,t){return n&&t.startsWith(n)?t.substring(n.length):t}(this._baseHref,X$(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,r="",s=null){this._locationStrategy.pushState(s,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+j4(r)),s)}replaceState(e,r="",s=null){this._locationStrategy.replaceState(s,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+j4(r)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(s=>s(e,r))}subscribe(e,r,s){return this._subject.subscribe({next:e,error:r,complete:s})}}return n.normalizeQueryParams=j4,n.joinWithSlash=zb,n.stripTrailingSlash=Z$,n.\u0275fac=function(e){return new(e||n)(xe(Iu))},n.\u0275prov=Xe({token:n,factory:function(){return function L6e(){return new Vb(xe(Iu))}()},providedIn:"root"}),n})();function X$(n){return n.replace(/\/index.html$/,"")}var ko=(()=>((ko=ko||{})[ko.Decimal=0]="Decimal",ko[ko.Percent=1]="Percent",ko[ko.Currency=2]="Currency",ko[ko.Scientific=3]="Scientific",ko))(),gs=(()=>((gs=gs||{})[gs.Format=0]="Format",gs[gs.Standalone=1]="Standalone",gs))(),Zn=(()=>((Zn=Zn||{})[Zn.Narrow=0]="Narrow",Zn[Zn.Abbreviated=1]="Abbreviated",Zn[Zn.Wide=2]="Wide",Zn[Zn.Short=3]="Short",Zn))(),Gr=(()=>((Gr=Gr||{})[Gr.Short=0]="Short",Gr[Gr.Medium=1]="Medium",Gr[Gr.Long=2]="Long",Gr[Gr.Full=3]="Full",Gr))(),Zt=(()=>((Zt=Zt||{})[Zt.Decimal=0]="Decimal",Zt[Zt.Group=1]="Group",Zt[Zt.List=2]="List",Zt[Zt.PercentSign=3]="PercentSign",Zt[Zt.PlusSign=4]="PlusSign",Zt[Zt.MinusSign=5]="MinusSign",Zt[Zt.Exponential=6]="Exponential",Zt[Zt.SuperscriptingExponent=7]="SuperscriptingExponent",Zt[Zt.PerMille=8]="PerMille",Zt[Zt.Infinity=9]="Infinity",Zt[Zt.NaN=10]="NaN",Zt[Zt.TimeSeparator=11]="TimeSeparator",Zt[Zt.CurrencyDecimal=12]="CurrencyDecimal",Zt[Zt.CurrencyGroup=13]="CurrencyGroup",Zt))();function SC(n,t){return Za(Yi(n)[ft.DateFormat],t)}function PC(n,t){return Za(Yi(n)[ft.TimeFormat],t)}function TC(n,t){return Za(Yi(n)[ft.DateTimeFormat],t)}function ja(n,t){const e=Yi(n),r=e[ft.NumberSymbols][t];if(typeof r>"u"){if(t===Zt.CurrencyDecimal)return e[ft.NumberSymbols][Zt.Decimal];if(t===Zt.CurrencyGroup)return e[ft.NumberSymbols][Zt.Group]}return r}function J$(n){if(!n[ft.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[ft.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Za(n,t){for(let e=t;e>-1;e--)if(typeof n[e]<"u")return n[e];throw new Error("Locale data API: locale data undefined")}function Fb(n){const[t,e]=n.split(":");return{hours:+t,minutes:+e}}const j6e=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,P9={},Z6e=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Js=(()=>((Js=Js||{})[Js.Short=0]="Short",Js[Js.ShortGMT=1]="ShortGMT",Js[Js.Long=2]="Long",Js[Js.Extended=3]="Extended",Js))(),sn=(()=>((sn=sn||{})[sn.FullYear=0]="FullYear",sn[sn.Month=1]="Month",sn[sn.Date=2]="Date",sn[sn.Hours=3]="Hours",sn[sn.Minutes=4]="Minutes",sn[sn.Seconds=5]="Seconds",sn[sn.FractionalSeconds=6]="FractionalSeconds",sn[sn.Day=7]="Day",sn))(),bn=(()=>((bn=bn||{})[bn.DayPeriods=0]="DayPeriods",bn[bn.Days=1]="Days",bn[bn.Months=2]="Months",bn[bn.Eras=3]="Eras",bn))();function eU(n,t,e,r){let s=function r0e(n){if(rU(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[s,i=1,o=1]=n.split("-").map(c=>+c);return wC(s,i-1,o)}const e=parseFloat(n);if(!isNaN(n-e))return new Date(e);let r;if(r=n.match(j6e))return function s0e(n){const t=new Date(0);let e=0,r=0;const s=n[8]?t.setUTCFullYear:t.setFullYear,i=n[8]?t.setUTCHours:t.setHours;n[9]&&(e=Number(n[9]+n[10]),r=Number(n[9]+n[11])),s.call(t,Number(n[1]),Number(n[2])-1,Number(n[3]));const o=Number(n[4]||0)-e,c=Number(n[5]||0)-r,u=Number(n[6]||0),h=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return i.call(t,o,c,u,h),t}(r)}const t=new Date(n);if(!rU(t))throw new Error(`Unable to convert "${n}" into a date`);return t}(n);t=Z4(e,t)||t;let c,o=[];for(;t;){if(c=Z6e.exec(t),!c){o.push(t);break}{o=o.concat(c.slice(1));const g=o.pop();if(!g)break;t=g}}let u=s.getTimezoneOffset();r&&(u=nU(r,u),s=function n0e(n,t,e){const r=e?-1:1,s=n.getTimezoneOffset();return function t0e(n,t){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+t),n}(n,r*(nU(t,s)-s))}(s,r,!0));let h="";return o.forEach(g=>{const m=function e0e(n){if($b[n])return $b[n];let t;switch(n){case"G":case"GG":case"GGG":t=lr(bn.Eras,Zn.Abbreviated);break;case"GGGG":t=lr(bn.Eras,Zn.Wide);break;case"GGGGG":t=lr(bn.Eras,Zn.Narrow);break;case"y":t=xs(sn.FullYear,1,0,!1,!0);break;case"yy":t=xs(sn.FullYear,2,0,!0,!0);break;case"yyy":t=xs(sn.FullYear,3,0,!1,!0);break;case"yyyy":t=xs(sn.FullYear,4,0,!1,!0);break;case"Y":t=OC(1);break;case"YY":t=OC(2,!0);break;case"YYY":t=OC(3);break;case"YYYY":t=OC(4);break;case"M":case"L":t=xs(sn.Month,1,1);break;case"MM":case"LL":t=xs(sn.Month,2,1);break;case"MMM":t=lr(bn.Months,Zn.Abbreviated);break;case"MMMM":t=lr(bn.Months,Zn.Wide);break;case"MMMMM":t=lr(bn.Months,Zn.Narrow);break;case"LLL":t=lr(bn.Months,Zn.Abbreviated,gs.Standalone);break;case"LLLL":t=lr(bn.Months,Zn.Wide,gs.Standalone);break;case"LLLLL":t=lr(bn.Months,Zn.Narrow,gs.Standalone);break;case"w":t=Bb(1);break;case"ww":t=Bb(2);break;case"W":t=Bb(1,!0);break;case"d":t=xs(sn.Date,1);break;case"dd":t=xs(sn.Date,2);break;case"c":case"cc":t=xs(sn.Day,1);break;case"ccc":t=lr(bn.Days,Zn.Abbreviated,gs.Standalone);break;case"cccc":t=lr(bn.Days,Zn.Wide,gs.Standalone);break;case"ccccc":t=lr(bn.Days,Zn.Narrow,gs.Standalone);break;case"cccccc":t=lr(bn.Days,Zn.Short,gs.Standalone);break;case"E":case"EE":case"EEE":t=lr(bn.Days,Zn.Abbreviated);break;case"EEEE":t=lr(bn.Days,Zn.Wide);break;case"EEEEE":t=lr(bn.Days,Zn.Narrow);break;case"EEEEEE":t=lr(bn.Days,Zn.Short);break;case"a":case"aa":case"aaa":t=lr(bn.DayPeriods,Zn.Abbreviated);break;case"aaaa":t=lr(bn.DayPeriods,Zn.Wide);break;case"aaaaa":t=lr(bn.DayPeriods,Zn.Narrow);break;case"b":case"bb":case"bbb":t=lr(bn.DayPeriods,Zn.Abbreviated,gs.Standalone,!0);break;case"bbbb":t=lr(bn.DayPeriods,Zn.Wide,gs.Standalone,!0);break;case"bbbbb":t=lr(bn.DayPeriods,Zn.Narrow,gs.Standalone,!0);break;case"B":case"BB":case"BBB":t=lr(bn.DayPeriods,Zn.Abbreviated,gs.Format,!0);break;case"BBBB":t=lr(bn.DayPeriods,Zn.Wide,gs.Format,!0);break;case"BBBBB":t=lr(bn.DayPeriods,Zn.Narrow,gs.Format,!0);break;case"h":t=xs(sn.Hours,1,-12);break;case"hh":t=xs(sn.Hours,2,-12);break;case"H":t=xs(sn.Hours,1);break;case"HH":t=xs(sn.Hours,2);break;case"m":t=xs(sn.Minutes,1);break;case"mm":t=xs(sn.Minutes,2);break;case"s":t=xs(sn.Seconds,1);break;case"ss":t=xs(sn.Seconds,2);break;case"S":t=xs(sn.FractionalSeconds,1);break;case"SS":t=xs(sn.FractionalSeconds,2);break;case"SSS":t=xs(sn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=NC(Js.Short);break;case"ZZZZZ":t=NC(Js.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=NC(Js.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=NC(Js.Long);break;default:return null}return $b[n]=t,t}(g);h+=m?m(s,e,u):"''"===g?"'":g.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),h}function wC(n,t,e){const r=new Date(0);return r.setFullYear(n,t,e),r.setHours(0,0,0),r}function Z4(n,t){const e=function R6e(n){return Yi(n)[ft.LocaleId]}(n);if(P9[e]=P9[e]||{},P9[e][t])return P9[e][t];let r="";switch(t){case"shortDate":r=SC(n,Gr.Short);break;case"mediumDate":r=SC(n,Gr.Medium);break;case"longDate":r=SC(n,Gr.Long);break;case"fullDate":r=SC(n,Gr.Full);break;case"shortTime":r=PC(n,Gr.Short);break;case"mediumTime":r=PC(n,Gr.Medium);break;case"longTime":r=PC(n,Gr.Long);break;case"fullTime":r=PC(n,Gr.Full);break;case"short":const s=Z4(n,"shortTime"),i=Z4(n,"shortDate");r=bC(TC(n,Gr.Short),[s,i]);break;case"medium":const o=Z4(n,"mediumTime"),c=Z4(n,"mediumDate");r=bC(TC(n,Gr.Medium),[o,c]);break;case"long":const u=Z4(n,"longTime"),h=Z4(n,"longDate");r=bC(TC(n,Gr.Long),[u,h]);break;case"full":const g=Z4(n,"fullTime"),m=Z4(n,"fullDate");r=bC(TC(n,Gr.Full),[g,m])}return r&&(P9[e][t]=r),r}function bC(n,t){return t&&(n=n.replace(/\{([^}]+)}/g,function(e,r){return null!=t&&r in t?t[r]:e})),n}function Uc(n,t,e="-",r,s){let i="";(n<0||s&&n<=0)&&(s?n=1-n:(n=-n,i=e));let o=String(n);for(;o.length<t;)o="0"+o;return r&&(o=o.slice(o.length-t)),i+o}function xs(n,t,e=0,r=!1,s=!1){return function(i,o){let c=function K6e(n,t){switch(n){case sn.FullYear:return t.getFullYear();case sn.Month:return t.getMonth();case sn.Date:return t.getDate();case sn.Hours:return t.getHours();case sn.Minutes:return t.getMinutes();case sn.Seconds:return t.getSeconds();case sn.FractionalSeconds:return t.getMilliseconds();case sn.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,i);if((e>0||c>-e)&&(c+=e),n===sn.Hours)0===c&&-12===e&&(c=12);else if(n===sn.FractionalSeconds)return function Y6e(n,t){return Uc(n,3).substring(0,t)}(c,t);const u=ja(o,Zt.MinusSign);return Uc(c,t,u,r,s)}}function lr(n,t,e=gs.Format,r=!1){return function(s,i){return function X6e(n,t,e,r,s,i){switch(e){case bn.Months:return function V6e(n,t,e){const r=Yi(n),i=Za([r[ft.MonthsFormat],r[ft.MonthsStandalone]],t);return Za(i,e)}(t,s,r)[n.getMonth()];case bn.Days:return function z6e(n,t,e){const r=Yi(n),i=Za([r[ft.DaysFormat],r[ft.DaysStandalone]],t);return Za(i,e)}(t,s,r)[n.getDay()];case bn.DayPeriods:const o=n.getHours(),c=n.getMinutes();if(i){const h=function $6e(n){const t=Yi(n);return J$(t),(t[ft.ExtraData][2]||[]).map(r=>"string"==typeof r?Fb(r):[Fb(r[0]),Fb(r[1])])}(t),g=function U6e(n,t,e){const r=Yi(n);J$(r);const i=Za([r[ft.ExtraData][0],r[ft.ExtraData][1]],t)||[];return Za(i,e)||[]}(t,s,r),m=h.findIndex(v=>{if(Array.isArray(v)){const[T,I]=v,z=o>=T.hours&&c>=T.minutes,Z=o<I.hours||o===I.hours&&c<I.minutes;if(T.hours<I.hours){if(z&&Z)return!0}else if(z||Z)return!0}else if(v.hours===o&&v.minutes===c)return!0;return!1});if(-1!==m)return g[m]}return function D6e(n,t,e){const r=Yi(n),i=Za([r[ft.DayPeriodsFormat],r[ft.DayPeriodsStandalone]],t);return Za(i,e)}(t,s,r)[o<12?0:1];case bn.Eras:return function H6e(n,t){return Za(Yi(n)[ft.Eras],t)}(t,r)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(s,i,n,t,e,r)}}function NC(n){return function(t,e,r){const s=-1*r,i=ja(e,Zt.MinusSign),o=s>0?Math.floor(s/60):Math.ceil(s/60);switch(n){case Js.Short:return(s>=0?"+":"")+Uc(o,2,i)+Uc(Math.abs(s%60),2,i);case Js.ShortGMT:return"GMT"+(s>=0?"+":"")+Uc(o,1,i);case Js.Long:return"GMT"+(s>=0?"+":"")+Uc(o,2,i)+":"+Uc(Math.abs(s%60),2,i);case Js.Extended:return 0===r?"Z":(s>=0?"+":"")+Uc(o,2,i)+":"+Uc(Math.abs(s%60),2,i);default:throw new Error(`Unknown zone width "${n}"`)}}}function tU(n){return wC(n.getFullYear(),n.getMonth(),n.getDate()+(4-n.getDay()))}function Bb(n,t=!1){return function(e,r){let s;if(t){const i=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,o=e.getDate();s=1+Math.floor((o+i)/7)}else{const i=tU(e),o=function J6e(n){const t=wC(n,0,1).getDay();return wC(n,0,1+(t<=4?4:11)-t)}(i.getFullYear()),c=i.getTime()-o.getTime();s=1+Math.round(c/6048e5)}return Uc(s,n,ja(r,Zt.MinusSign))}}function OC(n,t=!1){return function(e,r){return Uc(tU(e).getFullYear(),n,ja(r,Zt.MinusSign),t)}}const $b={};function nU(n,t){n=n.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(e)?t:e}function rU(n){return n instanceof Date&&!isNaN(n.valueOf())}const i0e=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function qb(n){const t=parseInt(n);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+n);return t}function aU(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const r=e.indexOf("="),[s,i]=-1==r?[e,""]:[e.slice(0,r),e.slice(r+1)];if(s.trim()===t)return decodeURIComponent(i)}return null}let On=(()=>{class n{constructor(e,r,s,i){this._iterableDiffers=e,this._keyValueDiffers=r,this._ngEl=s,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(ke(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachChangedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachRemovedItem(r=>{r.previousValue&&this._toggleClass(r.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(r=>{if("string"!=typeof r.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${F1(r.item)}`);this._toggleClass(r.item,!0)}),e.forEachRemovedItem(r=>this._toggleClass(r.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!0)):Object.keys(e).forEach(r=>this._toggleClass(r,!!e[r])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!1)):Object.keys(e).forEach(r=>this._toggleClass(r,!1)))}_toggleClass(e,r){(e=e.trim())&&e.split(/\s+/g).forEach(s=>{r?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}}return n.\u0275fac=function(e){return new(e||n)(Q(EC),Q(S9),Q(j2),Q(Wi))},n.\u0275dir=Ht({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})();class v0e{constructor(t,e,r,s){this.$implicit=t,this.ngForOf=e,this.index=r,this.count=s}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Fn=(()=>{class n{constructor(e,r,s){this._viewContainer=e,this._template=r,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const r=this._viewContainer;e.forEachOperation((s,i,o)=>{if(null==s.previousIndex)r.createEmbeddedView(this._template,new v0e(s.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)r.remove(null===i?void 0:i);else if(null!==i){const c=r.get(i);r.move(c,o),uU(c,s)}});for(let s=0,i=r.length;s<i;s++){const c=r.get(s).context;c.index=s,c.count=i,c.ngForOf=this._ngForOf}e.forEachIdentityChange(s=>{uU(r.get(s.currentIndex),s)})}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(Q(la),Q(G4),Q(EC))},n.\u0275dir=Ht({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function uU(n,t){n.context.$implicit=t.item}let hn=(()=>{class n{constructor(e,r){this._viewContainer=e,this._context=new y0e,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){fU("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){fU("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(Q(la),Q(G4))},n.\u0275dir=Ht({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class y0e{constructor(){this.$implicit=null,this.ngIf=null}}function fU(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${F1(t)}'.`)}let pU=(()=>{class n{constructor(e){this._locale=e}transform(e,r,s){if(!function Kb(n){return!(null==n||""===n||n!=n)}(e))return null;s=s||this._locale;try{return function f0e(n,t,e){return function Gb(n,t,e,r,s,i,o=!1){let c="",u=!1;if(isFinite(n)){let h=function d0e(n){let r,s,i,o,c,t=Math.abs(n)+"",e=0;for((s=t.indexOf("."))>-1&&(t=t.replace(".","")),(i=t.search(/e/i))>0?(s<0&&(s=i),s+=+t.slice(i+1),t=t.substring(0,i)):s<0&&(s=t.length),i=0;"0"===t.charAt(i);i++);if(i===(c=t.length))r=[0],s=1;else{for(c--;"0"===t.charAt(c);)c--;for(s-=i,r=[],o=0;i<=c;i++,o++)r[o]=Number(t.charAt(i))}return s>22&&(r=r.splice(0,21),e=s-1,s=1),{digits:r,exponent:e,integerLen:s}}(n);o&&(h=function h0e(n){if(0===n.digits[0])return n;const t=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(0===t?n.digits.push(0,0):1===t&&n.digits.push(0),n.integerLen+=2),n}(h));let g=t.minInt,m=t.minFrac,v=t.maxFrac;if(i){const me=i.match(i0e);if(null===me)throw new Error(`${i} is not a valid digit info`);const J=me[1],Ne=me[3],He=me[5];null!=J&&(g=qb(J)),null!=Ne&&(m=qb(Ne)),null!=He?v=qb(He):null!=Ne&&m>v&&(v=m)}!function p0e(n,t,e){if(t>e)throw new Error(`The minimum number of digits after fraction (${t}) is higher than the maximum (${e}).`);let r=n.digits,s=r.length-n.integerLen;const i=Math.min(Math.max(t,s),e);let o=i+n.integerLen,c=r[o];if(o>0){r.splice(Math.max(n.integerLen,o));for(let m=o;m<r.length;m++)r[m]=0}else{s=Math.max(0,s),n.integerLen=1,r.length=Math.max(1,o=i+1),r[0]=0;for(let m=1;m<o;m++)r[m]=0}if(c>=5)if(o-1<0){for(let m=0;m>o;m--)r.unshift(0),n.integerLen++;r.unshift(1),n.integerLen++}else r[o-1]++;for(;s<Math.max(0,i);s++)r.push(0);let u=0!==i;const h=t+n.integerLen,g=r.reduceRight(function(m,v,T,I){return I[T]=(v+=m)<10?v:v-10,u&&(0===I[T]&&T>=h?I.pop():u=!1),v>=10?1:0},0);g&&(r.unshift(g),n.integerLen++)}(h,m,v);let T=h.digits,I=h.integerLen;const z=h.exponent;let Z=[];for(u=T.every(me=>!me);I<g;I++)T.unshift(0);for(;I<0;I++)T.unshift(0);I>0?Z=T.splice(I,T.length):(Z=T,T=[0]);const te=[];for(T.length>=t.lgSize&&te.unshift(T.splice(-t.lgSize,T.length).join(""));T.length>t.gSize;)te.unshift(T.splice(-t.gSize,T.length).join(""));T.length&&te.unshift(T.join("")),c=te.join(ja(e,r)),Z.length&&(c+=ja(e,s)+Z.join("")),z&&(c+=ja(e,Zt.Exponential)+"+"+z)}else c=ja(e,Zt.Infinity);return c=n<0&&!u?t.negPre+c+t.negSuf:t.posPre+c+t.posSuf,c}(n,function Wb(n,t="-"){const e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=n.split(";"),s=r[0],i=r[1],o=-1!==s.indexOf(".")?s.split("."):[s.substring(0,s.lastIndexOf("0")+1),s.substring(s.lastIndexOf("0")+1)],c=o[0],u=o[1]||"";e.posPre=c.substring(0,c.indexOf("#"));for(let g=0;g<u.length;g++){const m=u.charAt(g);"0"===m?e.minFrac=e.maxFrac=g+1:"#"===m?e.maxFrac=g+1:e.posSuf+=m}const h=c.split(",");if(e.gSize=h[1]?h[1].length:0,e.lgSize=h[2]||h[1]?(h[2]||h[1]).length:0,i){const g=s.length-e.posPre.length-e.posSuf.length,m=i.indexOf("#");e.negPre=i.substring(0,m).replace(/'/g,""),e.negSuf=i.slice(m+g).replace(/'/g,"")}else e.negPre=t+e.posPre,e.negSuf=e.posSuf;return e}(function Hb(n,t){return Yi(n)[ft.NumberFormats][t]}(t,ko.Decimal),ja(t,Zt.MinusSign)),t,Zt.Group,Zt.Decimal,e)}(function Xb(n){if("string"==typeof n&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if("number"!=typeof n)throw new Error(`${n} is not a number`);return n}(e),s,r)}catch(i){throw function Gc(n,t){return new Te(2100,!1)}()}}}return n.\u0275fac=function(e){return new(e||n)(Q(H3,16))},n.\u0275pipe=js({name:"number",type:n,pure:!0,standalone:!0}),n})();let q0e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=qs({type:n}),n.\u0275inj=Fr({}),n})();let K0e=(()=>{class n{}return n.\u0275prov=Xe({token:n,providedIn:"root",factory:()=>new X0e(xe(Os),window)}),n})();class X0e{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function Q0e(n,t){const e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let s=r.currentNode;for(;s;){const i=s.shadowRoot;if(i){const o=i.getElementById(t)||i.querySelector(`[name="${t}"]`);if(o)return o}s=r.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),r=e.left+this.window.pageXOffset,s=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(r-i[0],s-i[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=mU(this.window.history)||mU(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function mU(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class _U{}class eN extends class mue extends class N6e{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function b6e(n){MC||(MC=n)}(new eN)}onAndCancel(t,e,r){return t.addEventListener(e,r,!1),()=>{t.removeEventListener(e,r,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function _ue(){return b9=b9||document.querySelector("base"),b9?b9.getAttribute("href"):null}();return null==e?null:function vue(n){LC=LC||document.createElement("a"),LC.setAttribute("href",n);const t=LC.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){b9=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return aU(document.cookie,t)}}let LC,b9=null;const EU=new It("TRANSITION_ID"),yue=[{provide:gC,useFactory:function Cue(n,t,e){return()=>{e.get(mC).donePromise.then(()=>{const r=F3(),s=t.querySelectorAll(`style[ng-transition="${n}"]`);for(let i=0;i<s.length;i++)r.remove(s[i])})}},deps:[EU,Os,Xs],multi:!0}];let Mue=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})();const kC=new It("EventManagerPlugins");let RC=(()=>{class n{constructor(e,r){this._zone=r,this._eventNameToPlugin=new Map,e.forEach(s=>s.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,r,s){return this._findPluginFor(r).addEventListener(e,r,s)}addGlobalEventListener(e,r,s){return this._findPluginFor(r).addGlobalEventListener(e,r,s)}getZone(){return this._zone}_findPluginFor(e){const r=this._eventNameToPlugin.get(e);if(r)return r;const s=this._plugins;for(let i=0;i<s.length;i++){const o=s[i];if(o.supports(e))return this._eventNameToPlugin.set(e,o),o}throw new Error(`No event manager plugin found for event ${e}`)}}return n.\u0275fac=function(e){return new(e||n)(xe(kC),xe(vr))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})();class MU{constructor(t){this._doc=t}addGlobalEventListener(t,e,r){const s=F3().getGlobalEventTarget(this._doc,t);if(!s)throw new Error(`Unsupported event target ${s} for event ${e}`);return this.addEventListener(s,e,r)}}let SU=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(e){const r=new Set;e.forEach(s=>{this._stylesSet.has(s)||(this._stylesSet.add(s),r.add(s))}),this.onStylesAdded(r)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})(),N9=(()=>{class n extends SU{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,r,s){e.forEach(i=>{const o=this._doc.createElement("style");o.textContent=i,s.push(r.appendChild(o))})}addHost(e){const r=[];this._addStylesToHost(this._stylesSet,e,r),this._hostNodes.set(e,r)}removeHost(e){const r=this._hostNodes.get(e);r&&r.forEach(PU),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((r,s)=>{this._addStylesToHost(e,s,r)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(PU))}}return n.\u0275fac=function(e){return new(e||n)(xe(Os))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})();function PU(n){F3().remove(n)}const tN={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},nN=/%COMP%/g;function DC(n,t,e){for(let r=0;r<t.length;r++){let s=t[r];Array.isArray(s)?DC(n,s,e):(s=s.replace(nN,n),e.push(s))}return e}function bU(n){return t=>{if("__ngUnwrap__"===t)return n;!1===n(t)&&(t.preventDefault(),t.returnValue=!1)}}let zC=(()=>{class n{constructor(e,r,s){this.eventManager=e,this.sharedStylesHost=r,this.appId=s,this.rendererByCompId=new Map,this.defaultRenderer=new rN(e)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;switch(r.encapsulation){case O1.Emulated:{let s=this.rendererByCompId.get(r.id);return s||(s=new Nue(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,s)),s.applyToHost(e),s}case 1:case O1.ShadowDom:return new Aue(this.eventManager,this.sharedStylesHost,e,r);default:if(!this.rendererByCompId.has(r.id)){const s=DC(r.id,r.styles,[]);this.sharedStylesHost.addStyles(s),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(e){return new(e||n)(xe(RC),xe(N9),xe(y9))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})();class rN{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(tN[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){(AU(t)?t.content:t).appendChild(e)}insertBefore(t,e,r){t&&(AU(t)?t.content:t).insertBefore(e,r)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let r="string"==typeof t?document.querySelector(t):t;if(!r)throw new Error(`The selector "${t}" did not match any elements`);return e||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,r,s){if(s){e=s+":"+e;const i=tN[s];i?t.setAttributeNS(i,e,r):t.setAttribute(e,r)}else t.setAttribute(e,r)}removeAttribute(t,e,r){if(r){const s=tN[r];s?t.removeAttributeNS(s,e):t.removeAttribute(`${r}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,r,s){s&(Y2.DashCase|Y2.Important)?t.style.setProperty(e,r,s&Y2.Important?"important":""):t.style[e]=r}removeStyle(t,e,r){r&Y2.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,r){t[e]=r}setValue(t,e){t.nodeValue=e}listen(t,e,r){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,bU(r)):this.eventManager.addEventListener(t,e,bU(r))}}function AU(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class Nue extends rN{constructor(t,e,r,s){super(t),this.component=r;const i=DC(s+"-"+r.id,r.styles,[]);e.addStyles(i),this.contentAttr=function Tue(n){return"_ngcontent-%COMP%".replace(nN,n)}(s+"-"+r.id),this.hostAttr=function wue(n){return"_nghost-%COMP%".replace(nN,n)}(s+"-"+r.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const r=super.createElement(t,e);return super.setAttribute(r,this.contentAttr,""),r}}class Aue extends rN{constructor(t,e,r,s){super(t),this.sharedStylesHost=e,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const i=DC(s.id,s.styles,[]);for(let o=0;o<i.length;o++){const c=document.createElement("style");c.textContent=i[o],this.shadowRoot.appendChild(c)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,r){return super.insertBefore(this.nodeOrShadowRoot(t),e,r)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let Oue=(()=>{class n extends MU{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,s){return e.addEventListener(r,s,!1),()=>this.removeEventListener(e,r,s)}removeEventListener(e,r,s){return e.removeEventListener(r,s)}}return n.\u0275fac=function(e){return new(e||n)(xe(Os))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})();const OU=["alt","control","meta","shift"],Iue={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},xue={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let Lue=(()=>{class n extends MU{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,r,s){const i=n.parseEventName(r),o=n.eventCallback(i.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>F3().onAndCancel(e,i.domEventName,o))}static parseEventName(e){const r=e.toLowerCase().split("."),s=r.shift();if(0===r.length||"keydown"!==s&&"keyup"!==s)return null;const i=n._normalizeKey(r.pop());let o="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),o="code."),OU.forEach(h=>{const g=r.indexOf(h);g>-1&&(r.splice(g,1),o+=h+".")}),o+=i,0!=r.length||0===i.length)return null;const u={};return u.domEventName=s,u.fullKey=o,u}static matchEventFullKeyCode(e,r){let s=Iue[e.key]||e.key,i="";return r.indexOf("code.")>-1&&(s=e.code,i="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),OU.forEach(o=>{o!==s&&(0,xue[o])(e)&&(i+=o+".")}),i+=s,i===r)}static eventCallback(e,r,s){return i=>{n.matchEventFullKeyCode(i,e)&&s.runGuarded(()=>r(i))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return n.\u0275fac=function(e){return new(e||n)(xe(Os))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})();const xU=[{provide:E9,useValue:"browser"},{provide:m$,useValue:function kue(){eN.makeCurrent()},multi:!0},{provide:Os,useFactory:function Due(){return function KP(n){id=n}(document),document},deps:[]}],zue=b$(P6e,"browser",xU),LU=new It(""),kU=[{provide:_C,useClass:class Eue{addToWindow(t){G1.getAngularTestability=(r,s=!0)=>{const i=t.findTestabilityInTree(r,s);if(null==i)throw new Error("Could not find testability for element.");return i},G1.getAllAngularTestabilities=()=>t.getAllTestabilities(),G1.getAllAngularRootElements=()=>t.getAllRootElements(),G1.frameworkStabilizers||(G1.frameworkStabilizers=[]),G1.frameworkStabilizers.push(r=>{const s=G1.getAllAngularTestabilities();let i=s.length,o=!1;const c=function(u){o=o||u,i--,0==i&&r(o)};s.forEach(function(u){u.whenStable(c)})})}findTestabilityInTree(t,e,r){return null==e?null:t.getTestability(e)??(r?F3().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:S$,useClass:bb,deps:[vr,Nb,_C]},{provide:bb,useClass:bb,deps:[vr,Nb,_C]}],RU=[{provide:pd,useValue:"root"},{provide:C6,useFactory:function Rue(){return new C6},deps:[]},{provide:kC,useClass:Oue,multi:!0,deps:[Os,vr,E9]},{provide:kC,useClass:Lue,multi:!0,deps:[Os]},{provide:zC,useClass:zC,deps:[RC,N9,y9]},{provide:_6,useExisting:zC},{provide:SU,useExisting:N9},{provide:N9,useClass:N9,deps:[Os]},{provide:RC,useClass:RC,deps:[kC,vr]},{provide:_U,useClass:Mue,deps:[]},[]];let DU=(()=>{class n{constructor(e){}static withServerTransition(e){return{ngModule:n,providers:[{provide:y9,useValue:e.appId},{provide:EU,useExisting:y9},yue]}}}return n.\u0275fac=function(e){return new(e||n)(xe(LU,12))},n.\u0275mod=qs({type:n}),n.\u0275inj=Fr({providers:[...RU,...kU],imports:[q0e,T6e]}),n})(),zU=(()=>{class n{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return n.\u0275fac=function(e){return new(e||n)(xe(Os))},n.\u0275prov=Xe({token:n,factory:function(e){let r=null;return r=e?new e:function Hue(){return new zU(xe(Os))}(),r},providedIn:"root"}),n})();typeof window<"u"&&window;let FU=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Xe({token:n,factory:function(e){let r=null;return r=e?new(e||n):xe(BU),r},providedIn:"root"}),n})(),BU=(()=>{class n extends FU{constructor(e){super(),this._doc=e}sanitize(e,r){if(null==r)return null;switch(e){case W1.NONE:return r;case W1.HTML:return $i(r,"HTML")?Bi(r):ld(this._doc,String(r)).toString();case W1.STYLE:return $i(r,"Style")?Bi(r):r;case W1.SCRIPT:if($i(r,"Script"))return Bi(r);throw new Error("unsafe value used in a script context");case W1.URL:return $i(r,"URL")?Bi(r):Io(String(r));case W1.RESOURCE_URL:if($i(r,"ResourceURL"))return Bi(r);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function v_(n){return new JP(n)}(e)}bypassSecurityTrustStyle(e){return function C_(n){return new eT(n)}(e)}bypassSecurityTrustScript(e){return function nT(n){return new tT(n)}(e)}bypassSecurityTrustUrl(e){return function rT(n){return new g_(n)}(e)}bypassSecurityTrustResourceUrl(e){return function sT(n){return new m_(n)}(e)}}return n.\u0275fac=function(e){return new(e||n)(xe(Os))},n.\u0275prov=Xe({token:n,factory:function(e){let r=null;return r=e?new e:function que(n){return new BU(n.get(Os))}(xe(Xs)),r},providedIn:"root"}),n})();const{isArray:jue}=Array,{getPrototypeOf:Zue,prototype:Yue,keys:Kue}=Object;function $U(n){if(1===n.length){const t=n[0];if(jue(t))return{args:t,keys:null};if(function Xue(n){return n&&"object"==typeof n&&Zue(n)===Yue}(t)){const e=Kue(t);return{args:e.map(r=>t[r]),keys:e}}}return{args:n,keys:null}}const{isArray:Que}=Array;function UU(n){return un(t=>function Jue(n,t){return Que(t)?n(...t):n(t)}(n,t))}function GU(n,t){return n.reduce((e,r,s)=>(e[r]=t[s],e),{})}let WU=(()=>{class n{constructor(e,r){this._renderer=e,this._elementRef=r,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(e,r){this._renderer.setProperty(this._elementRef.nativeElement,e,r)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return n.\u0275fac=function(e){return new(e||n)(Q(Wi),Q(j2))},n.\u0275dir=Ht({type:n}),n})(),xu=(()=>{class n extends WU{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=es(n)))(r||n)}}(),n.\u0275dir=Ht({type:n,features:[l]}),n})();const B3=new It("NgValueAccessor"),t8e={provide:B3,useExisting:m1(()=>oN),multi:!0};let oN=(()=>{class n extends xu{writeValue(e){this.setProperty("checked",e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=es(n)))(r||n)}}(),n.\u0275dir=Ht({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,r){1&e&&se("change",function(i){return r.onChange(i.target.checked)})("blur",function(){return r.onTouched()})},features:[xr([t8e]),l]}),n})();const n8e={provide:B3,useExisting:m1(()=>$3),multi:!0},s8e=new It("CompositionEventMode");let $3=(()=>{class n extends WU{constructor(e,r,s){super(e,r),this._compositionMode=s,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function r8e(){const n=F3()?F3().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return n.\u0275fac=function(e){return new(e||n)(Q(Wi),Q(j2),Q(s8e,8))},n.\u0275dir=Ht({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,r){1&e&&se("input",function(i){return r._handleInput(i.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(i){return r._compositionEnd(i.target.value)})},features:[xr([n8e]),l]}),n})();function I6(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function qU(n){return null!=n&&"number"==typeof n.length}const Si=new It("NgValidators"),x6=new It("NgAsyncValidators"),o8e=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class A9{static min(t){return function jU(n){return t=>{if(I6(t.value)||I6(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}(t)}static max(t){return function ZU(n){return t=>{if(I6(t.value)||I6(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}(t)}static required(t){return YU(t)}static requiredTrue(t){return function KU(n){return!0===n.value?null:{required:!0}}(t)}static email(t){return function XU(n){return I6(n.value)||o8e.test(n.value)?null:{email:!0}}(t)}static minLength(t){return function QU(n){return t=>I6(t.value)||!qU(t.value)?null:t.value.length<n?{minlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static maxLength(t){return JU(t)}static pattern(t){return function eG(n){if(!n)return VC;let t,e;return"string"==typeof n?(e="","^"!==n.charAt(0)&&(e+="^"),e+=n,"$"!==n.charAt(n.length-1)&&(e+="$"),t=new RegExp(e)):(e=n.toString(),t=n),r=>{if(I6(r.value))return null;const s=r.value;return t.test(s)?null:{pattern:{requiredPattern:e,actualValue:s}}}}(t)}static nullValidator(t){return null}static compose(t){return oG(t)}static composeAsync(t){return aG(t)}}function YU(n){return I6(n.value)?{required:!0}:null}function JU(n){return t=>qU(t.value)&&t.value.length>n?{maxlength:{requiredLength:n,actualLength:t.value.length}}:null}function VC(n){return null}function tG(n){return null!=n}function nG(n){return u9(n)?Jr(n):n}function rG(n){let t={};return n.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function sG(n,t){return t.map(e=>e(n))}function iG(n){return n.map(t=>function a8e(n){return!n.validate}(t)?t:e=>t.validate(e))}function oG(n){if(!n)return null;const t=n.filter(tG);return 0==t.length?null:function(e){return rG(sG(e,t))}}function aN(n){return null!=n?oG(iG(n)):null}function aG(n){if(!n)return null;const t=n.filter(tG);return 0==t.length?null:function(e){return function e8e(...n){const t=jt(n),{args:e,keys:r}=$U(n),s=new gr(i=>{const{length:o}=e;if(!o)return void i.complete();const c=new Array(o);let u=o,h=o;for(let g=0;g<o;g++){let m=!1;mo(e[g]).subscribe(Qr(i,v=>{m||(m=!0,h--),c[g]=v},()=>u--,void 0,()=>{(!u||!m)&&(h||i.next(r?GU(r,c):c),i.complete())}))}});return t?s.pipe(UU(t)):s}(sG(e,t).map(nG)).pipe(un(rG))}}function cN(n){return null!=n?aG(iG(n)):null}function cG(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function lG(n){return n._rawValidators}function uG(n){return n._rawAsyncValidators}function lN(n){return n?Array.isArray(n)?n:[n]:[]}function HC(n,t){return Array.isArray(n)?n.includes(t):n===t}function fG(n,t){const e=lN(t);return lN(n).forEach(s=>{HC(e,s)||e.push(s)}),e}function hG(n,t){return lN(t).filter(e=>!HC(n,e))}class dG{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=aN(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=cN(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class Xi extends dG{get formDirective(){return null}get path(){return null}}class L6 extends dG{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class pG{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Y4=(()=>{class n extends pG{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(Q(L6,2))},n.\u0275dir=Ht({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,r){2&e&&sC("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[l]}),n})(),Lu=(()=>{class n extends pG{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(Q(Xi,10))},n.\u0275dir=Ht({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,r){2&e&&sC("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[l]}),n})();const O9="VALID",BC="INVALID",M7="PENDING",I9="DISABLED";function dN(n){return($C(n)?n.validators:n)||null}function mG(n){return Array.isArray(n)?aN(n):n||null}function pN(n,t){return($C(t)?t.asyncValidators:n)||null}function _G(n){return Array.isArray(n)?cN(n):n||null}function $C(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function vG(n,t,e){const r=n.controls;if(!(t?Object.keys(r):r).length)throw new Te(1e3,"");if(!r[e])throw new Te(1001,"")}function CG(n,t,e){n._forEachChild((r,s)=>{if(void 0===e[s])throw new Te(1002,"")})}class UC{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=mG(this._rawValidators),this._composedAsyncValidatorFn=_G(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===O9}get invalid(){return this.status===BC}get pending(){return this.status==M7}get disabled(){return this.status===I9}get enabled(){return this.status!==I9}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=mG(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=_G(t)}addValidators(t){this.setValidators(fG(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(fG(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(hG(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(hG(t,this._rawAsyncValidators))}hasValidator(t){return HC(this._rawValidators,t)}hasAsyncValidator(t){return HC(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=M7,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=I9,this.errors=null,this._forEachChild(r=>{r.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=O9,this._forEachChild(r=>{r.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===O9||this.status===M7)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?I9:O9}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=M7,this._hasOwnPendingAsyncValidator=!0;const e=nG(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((r,s)=>r&&r._find(s),this)}getError(t,e){const r=e?this.get(e):this;return r&&r.errors?r.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new cr,this.statusChanges=new cr}_calculateStatus(){return this._allControlsDisabled()?I9:this.errors?BC:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(M7)?M7:this._anyControlsHaveStatus(BC)?BC:O9}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){$C(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}}class k6 extends UC{constructor(t,e,r){super(dN(e),pN(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,r={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){CG(this,0,t),Object.keys(t).forEach(r=>{vG(this,!0,r),this.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(r=>{const s=this.controls[r];s&&s.patchValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((r,s)=>{r.reset(t[s],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,r)=>(t[r]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,r)=>!!r._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const r=this.controls[e];r&&t(r,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[e,r]of Object.entries(this.controls))if(this.contains(e)&&t(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,r,s)=>((r.enabled||this.disabled)&&(e[s]=r.value),e))}_reduceChildren(t,e){let r=t;return this._forEachChild((s,i)=>{r=e(r,s,i)}),r}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}class yG extends k6{}function GC(n,t){return[...t.path,n]}function x9(n,t){gN(n,t),t.valueAccessor.writeValue(n.value),n.disabled&&t.valueAccessor.setDisabledState?.(!0),function g8e(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&EG(n,t)})}(n,t),function _8e(n,t){const e=(r,s)=>{t.valueAccessor.writeValue(r),s&&t.viewToModelUpdate(r)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function m8e(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&EG(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function p8e(n,t){if(t.valueAccessor.setDisabledState){const e=r=>{t.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function WC(n,t,e=!0){const r=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(r),t.valueAccessor.registerOnTouched(r)),jC(n,t),n&&(t._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function qC(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function gN(n,t){const e=lG(n);null!==t.validator?n.setValidators(cG(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const r=uG(n);null!==t.asyncValidator?n.setAsyncValidators(cG(r,t.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const s=()=>n.updateValueAndValidity();qC(t._rawValidators,s),qC(t._rawAsyncValidators,s)}function jC(n,t){let e=!1;if(null!==n){if(null!==t.validator){const s=lG(n);if(Array.isArray(s)&&s.length>0){const i=s.filter(o=>o!==t.validator);i.length!==s.length&&(e=!0,n.setValidators(i))}}if(null!==t.asyncValidator){const s=uG(n);if(Array.isArray(s)&&s.length>0){const i=s.filter(o=>o!==t.asyncValidator);i.length!==s.length&&(e=!0,n.setAsyncValidators(i))}}}const r=()=>{};return qC(t._rawValidators,r),qC(t._rawAsyncValidators,r),e}function EG(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function MG(n,t){gN(n,t)}function mN(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}function PG(n,t){n._syncPendingControls(),t.forEach(e=>{const r=e.control;"submit"===r.updateOn&&r._pendingChange&&(e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function _N(n,t){if(!t)return null;let e,r,s;return Array.isArray(t),t.forEach(i=>{i.constructor===$3?e=i:function y8e(n){return Object.getPrototypeOf(n.constructor)===xu}(i)?r=i:s=i}),s||r||e||null}const M8e={provide:Xi,useExisting:m1(()=>k9)},L9=(()=>Promise.resolve())();let k9=(()=>{class n extends Xi{constructor(e,r){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new cr,this.form=new k6({},aN(e),cN(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){L9.then(()=>{const r=this._findContainer(e.path);e.control=r.registerControl(e.name,e.control),x9(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){L9.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){L9.then(()=>{const r=this._findContainer(e.path),s=new k6({});MG(s,e),r.registerControl(e.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){L9.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,r){L9.then(()=>{this.form.get(e.path).setValue(r)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,PG(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return n.\u0275fac=function(e){return new(e||n)(Q(Si,10),Q(x6,10))},n.\u0275dir=Ht({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,r){1&e&&se("submit",function(i){return r.onSubmit(i)})("reset",function(){return r.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[xr([M8e]),l]}),n})();function TG(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}function wG(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const ua=class extends UC{constructor(t=null,e,r){super(dN(e),pN(r,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),$C(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=wG(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){TG(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){TG(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){wG(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}},T8e={provide:L6,useExisting:m1(()=>R9)},AG=(()=>Promise.resolve())();let R9=(()=>{class n extends L6{constructor(e,r,s,i,o){super(),this._changeDetectorRef=o,this.control=new ua,this._registered=!1,this.update=new cr,this._parent=e,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=_N(0,i)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const r=e.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),mN(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){x9(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){AG.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const r=e.isDisabled.currentValue,s=0!==r&&q4(r);AG.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?GC(e,this._parent):[e]}}return n.\u0275fac=function(e){return new(e||n)(Q(Xi,9),Q(Si,10),Q(x6,10),Q(B3,10),Q(Au,8))},n.\u0275dir=Ht({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[xr([T8e]),l,H2]}),n})(),ku=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ht({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})(),IG=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=qs({type:n}),n.\u0275inj=Fr({}),n})();const A8e={provide:B3,useExisting:m1(()=>ZC),multi:!0};let ZC=(()=>{class n extends xu{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=r=>{e(""==r?null:parseFloat(r))}}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=es(n)))(r||n)}}(),n.\u0275dir=Ht({type:n,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,r){1&e&&se("change",function(i){return r.onChange(i.target.value)})("input",function(i){return r.onChange(i.target.value)})("blur",function(){return r.onTouched()})},features:[xr([A8e]),l]}),n})();const vN=new It("NgModelWithFormControlWarning"),O8e={provide:L6,useExisting:m1(()=>CN)};let CN=(()=>{class n extends L6{constructor(e,r,s,i){super(),this._ngModelWarningConfig=i,this.update=new cr,this._ngModelWarningSent=!1,this._setValidators(e),this._setAsyncValidators(r),this.valueAccessor=_N(0,s)}set isDisabled(e){}ngOnChanges(e){if(this._isControlChanged(e)){const r=e.form.previousValue;r&&WC(r,this,!1),x9(this.form,this),this.form.updateValueAndValidity({emitEvent:!1})}mN(e,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&WC(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_isControlChanged(e){return e.hasOwnProperty("form")}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(e){return new(e||n)(Q(Si,10),Q(x6,10),Q(B3,10),Q(vN,8))},n.\u0275dir=Ht({type:n,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[xr([O8e]),l,H2]}),n})();const I8e={provide:Xi,useExisting:m1(()=>Ru)};let Ru=(()=>{class n extends Xi{constructor(e,r){super(),this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new cr,this._setValidators(e),this._setAsyncValidators(r)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(jC(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const r=this.form.get(e.path);return x9(r,e),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),r}getControl(e){return this.form.get(e.path)}removeControl(e){WC(e.control||null,e,!1),function E8e(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,r){this.form.get(e.path).setValue(r)}onSubmit(e){return this.submitted=!0,PG(this.form,this.directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const r=e.control,s=this.form.get(e.path);r!==s&&(WC(r||null,e),(n=>n instanceof ua)(s)&&(x9(s,e),e.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const r=this.form.get(e.path);MG(r,e),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const r=this.form.get(e.path);r&&function v8e(n,t){return jC(n,t)}(r,e)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){gN(this.form,this),this._oldForm&&jC(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(e){return new(e||n)(Q(Si,10),Q(x6,10))},n.\u0275dir=Ht({type:n,selectors:[["","formGroup",""]],hostBindings:function(e,r){1&e&&se("submit",function(i){return r.onSubmit(i)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[xr([I8e]),l,H2]}),n})();const k8e={provide:L6,useExisting:m1(()=>S7)};let S7=(()=>{class n extends L6{constructor(e,r,s,i,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.update=new cr,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=_N(0,i)}set isDisabled(e){}ngOnChanges(e){this._added||this._setUpControl(),mN(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return GC(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(e){return new(e||n)(Q(Xi,13),Q(Si,10),Q(x6,10),Q(B3,10),Q(vN,8))},n.\u0275dir=Ht({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[xr([k8e]),l,H2]}),n})();const R8e={provide:B3,useExisting:m1(()=>YC),multi:!0};function kG(n,t){return null==n?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let YC=(()=>{class n extends xu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const s=kG(this._getOptionId(e),e);this.setProperty("value",s)}registerOnChange(e){this.onChange=r=>{this.value=this._getOptionValue(r),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r),e))return r;return null}_getOptionValue(e){const r=function D8e(n){return n.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r):e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=es(n)))(r||n)}}(),n.\u0275dir=Ht({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,r){1&e&&se("change",function(i){return r.onChange(i.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[xr([R8e]),l]}),n})(),D9=(()=>{class n{constructor(e,r,s){this._element=e,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(kG(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(Q(j2),Q(Wi),Q(YC,9))},n.\u0275dir=Ht({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();const z8e={provide:B3,useExisting:m1(()=>MN),multi:!0};function RG(n,t){return null==n?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let MN=(()=>{class n extends xu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let r;if(this.value=e,Array.isArray(e)){const s=e.map(i=>this._getOptionId(i));r=(i,o)=>{i._setSelected(s.indexOf(o.toString())>-1)}}else r=(s,i)=>{s._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(e){this.onChange=r=>{const s=[],i=r.selectedOptions;if(void 0!==i){const o=i;for(let c=0;c<o.length;c++){const h=this._getOptionValue(o[c].value);s.push(h)}}else{const o=r.options;for(let c=0;c<o.length;c++){const u=o[c];if(u.selected){const h=this._getOptionValue(u.value);s.push(h)}}}this.value=s,e(s)}}_registerOption(e){const r=(this._idCounter++).toString();return this._optionMap.set(r,e),r}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r)._value,e))return r;return null}_getOptionValue(e){const r=function V8e(n){return n.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r)._value:e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=es(n)))(r||n)}}(),n.\u0275dir=Ht({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,r){1&e&&se("change",function(i){return r.onChange(i.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[xr([z8e]),l]}),n})(),z9=(()=>{class n{constructor(e,r,s){this._element=e,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(RG(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(RG(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(Q(j2),Q(Wi),Q(MN,9))},n.\u0275dir=Ht({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();let Du=(()=>{class n{constructor(){this._validator=VC}ngOnChanges(e){if(this.inputName in e){const r=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):VC,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ht({type:n,features:[H2]}),n})();const B8e={provide:Si,useExisting:m1(()=>zu),multi:!0};let zu=(()=>{class n extends Du{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=q4,this.createValidator=e=>YU}enabled(e){return e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=es(n)))(r||n)}}(),n.\u0275dir=Ht({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,r){2&e&&V("required",r._enabled?"":null)},inputs:{required:"required"},features:[xr([B8e]),l]}),n})();const W8e={provide:Si,useExisting:m1(()=>SN),multi:!0};let SN=(()=>{class n extends Du{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>function DG(n){return"number"==typeof n?n:parseInt(n,10)}(e),this.createValidator=e=>JU(e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=es(n)))(r||n)}}(),n.\u0275dir=Ht({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,r){2&e&&V("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},features:[xr([W8e]),l]}),n})(),GG=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=qs({type:n}),n.\u0275inj=Fr({imports:[IG]}),n})(),j8e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=qs({type:n}),n.\u0275inj=Fr({imports:[GG]}),n})(),WG=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:vN,useValue:e.warnOnNgModelWithFormControl}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=qs({type:n}),n.\u0275inj=Fr({imports:[GG]}),n})();class qG extends UC{constructor(t,e,r){super(dN(e),pN(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,r={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(t,e={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,r={}){let s=this._adjustIndex(t);s<0&&(s=0),this.controls[s]&&this.controls[s]._registerOnCollectionChange(()=>{}),this.controls.splice(s,1),e&&(this.controls.splice(s,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){CG(this,0,t),t.forEach((r,s)=>{vG(this,!1,s),this.at(s).setValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((r,s)=>{this.at(s)&&this.at(s).patchValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((r,s)=>{r.reset(t[s],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,r)=>!!r._syncPendingControls()||e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,r)=>{t(e,r)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}}function jG(n){return!!n&&(void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn)}let Z8e=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){const e=new n;return e.useNonNullable=!0,e}group(e,r=null){const s=this._reduceControls(e);let i={};return jG(r)?i=r:null!==r&&(i.validators=r.validator,i.asyncValidators=r.asyncValidator),new k6(s,i)}record(e,r=null){const s=this._reduceControls(e);return new yG(s,r)}control(e,r,s){let i={};return this.useNonNullable?(jG(r)?i=r:(i.validators=r,i.asyncValidators=s),new ua(e,{...i,nonNullable:!0})):new ua(e,r,s)}array(e,r,s){const i=e.map(o=>this._createControl(o));return new qG(i,r,s)}_reduceControls(e){const r={};return Object.keys(e).forEach(s=>{r[s]=this._createControl(e[s])}),r}_createControl(e){return e instanceof ua||e instanceof UC?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:WG}),n})();function Ut(...n){return Jr(n,g3(n))}function R6(n,t){return en(t)?Le(n,t,1):Le(n,1)}function K4(n,t){return or((e,r)=>{let s=0;e.subscribe(Qr(r,i=>n.call(t,i,s++)&&r.next(i)))})}class ZG{}class YG{}class X4{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(e=>{const r=e.indexOf(":");if(r>0){const s=e.slice(0,r),i=s.toLowerCase(),o=e.slice(r+1).trim();this.maybeSetNormalizedName(s,i),this.headers.has(i)?this.headers.get(i).push(o):this.headers.set(i,[o])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let r=t[e];const s=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(s,r),this.maybeSetNormalizedName(e,s))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof X4?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new X4;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof X4?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let r=t.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(t.name,e);const s=("a"===t.op?this.headers.get(e):void 0)||[];s.push(...r),this.headers.set(e,s);break;case"d":const i=t.value;if(i){let o=this.headers.get(e);if(!o)return;o=o.filter(c=>-1===i.indexOf(c)),0===o.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,o)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class Y8e{encodeKey(t){return KG(t)}encodeValue(t){return KG(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const X8e=/%(\d[a-f0-9])/gi,Q8e={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function KG(n){return encodeURIComponent(n).replace(X8e,(t,e)=>Q8e[e]??t)}function KC(n){return`${n}`}class D6{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new Y8e,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function K8e(n,t){const e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(s=>{const i=s.indexOf("="),[o,c]=-1==i?[t.decodeKey(s),""]:[t.decodeKey(s.slice(0,i)),t.decodeValue(s.slice(i+1))],u=e.get(o)||[];u.push(c),e.set(o,u)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const r=t.fromObject[e],s=Array.isArray(r)?r.map(KC):[KC(r)];this.map.set(e,s)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(r=>{const s=t[r];Array.isArray(s)?s.forEach(i=>{e.push({param:r,value:i,op:"a"})}):e.push({param:r,value:s,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(r=>e+"="+this.encoder.encodeValue(r)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new D6({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(KC(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let r=this.map.get(t.param)||[];const s=r.indexOf(KC(t.value));-1!==s&&r.splice(s,1),r.length>0?this.map.set(t.param,r):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class J8e{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function XG(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function QG(n){return typeof Blob<"u"&&n instanceof Blob}function JG(n){return typeof FormData<"u"&&n instanceof FormData}class V9{constructor(t,e,r,s){let i;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function e5e(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||s?(this.body=void 0!==r?r:null,i=s):i=r,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params)),this.headers||(this.headers=new X4),this.context||(this.context=new J8e),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=e;else{const c=e.indexOf("?");this.urlWithParams=e+(-1===c?"?":c<e.length-1?"&":"")+o}}else this.params=new D6,this.urlWithParams=e}serializeBody(){return null===this.body?null:XG(this.body)||QG(this.body)||JG(this.body)||function t5e(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof D6?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||JG(this.body)?null:QG(this.body)?this.body.type||null:XG(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof D6?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const e=t.method||this.method,r=t.url||this.url,s=t.responseType||this.responseType,i=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,c=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let u=t.headers||this.headers,h=t.params||this.params;const g=t.context??this.context;return void 0!==t.setHeaders&&(u=Object.keys(t.setHeaders).reduce((m,v)=>m.set(v,t.setHeaders[v]),u)),t.setParams&&(h=Object.keys(t.setParams).reduce((m,v)=>m.set(v,t.setParams[v]),h)),new V9(e,r,i,{params:h,headers:u,context:g,reportProgress:c,responseType:s,withCredentials:o})}}var Ls=(()=>((Ls=Ls||{})[Ls.Sent=0]="Sent",Ls[Ls.UploadProgress=1]="UploadProgress",Ls[Ls.ResponseHeader=2]="ResponseHeader",Ls[Ls.DownloadProgress=3]="DownloadProgress",Ls[Ls.Response=4]="Response",Ls[Ls.User=5]="User",Ls))();class PN{constructor(t,e=200,r="OK"){this.headers=t.headers||new X4,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class TN extends PN{constructor(t={}){super(t),this.type=Ls.ResponseHeader}clone(t={}){return new TN({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class XC extends PN{constructor(t={}){super(t),this.type=Ls.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new XC({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class eW extends PN{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function wN(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let n5e=(()=>{class n{constructor(e){this.handler=e}request(e,r,s={}){let i;if(e instanceof V9)i=e;else{let u,h;u=s.headers instanceof X4?s.headers:new X4(s.headers),s.params&&(h=s.params instanceof D6?s.params:new D6({fromObject:s.params})),i=new V9(e,r,void 0!==s.body?s.body:null,{headers:u,context:s.context,params:h,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials})}const o=Ut(i).pipe(R6(u=>this.handler.handle(u)));if(e instanceof V9||"events"===s.observe)return o;const c=o.pipe(K4(u=>u instanceof XC));switch(s.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return c.pipe(un(u=>{if(null!==u.body&&!(u.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return u.body}));case"blob":return c.pipe(un(u=>{if(null!==u.body&&!(u.body instanceof Blob))throw new Error("Response is not a Blob.");return u.body}));case"text":return c.pipe(un(u=>{if(null!==u.body&&"string"!=typeof u.body)throw new Error("Response is not a string.");return u.body}));default:return c.pipe(un(u=>u.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(e,r={}){return this.request("DELETE",e,r)}get(e,r={}){return this.request("GET",e,r)}head(e,r={}){return this.request("HEAD",e,r)}jsonp(e,r){return this.request("JSONP",e,{params:(new D6).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,r={}){return this.request("OPTIONS",e,r)}patch(e,r,s={}){return this.request("PATCH",e,wN(s,r))}post(e,r,s={}){return this.request("POST",e,wN(s,r))}put(e,r,s={}){return this.request("PUT",e,wN(s,r))}}return n.\u0275fac=function(e){return new(e||n)(xe(ZG))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})();class tW{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const nW=new It("HTTP_INTERCEPTORS");let r5e=(()=>{class n{intercept(e,r){return r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})();const s5e=/^\)\]\}',?\n/;let rW=(()=>{class n{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new gr(r=>{const s=this.xhrFactory.build();if(s.open(e.method,e.urlWithParams),e.withCredentials&&(s.withCredentials=!0),e.headers.forEach((T,I)=>s.setRequestHeader(T,I.join(","))),e.headers.has("Accept")||s.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const T=e.detectContentTypeHeader();null!==T&&s.setRequestHeader("Content-Type",T)}if(e.responseType){const T=e.responseType.toLowerCase();s.responseType="json"!==T?T:"text"}const i=e.serializeBody();let o=null;const c=()=>{if(null!==o)return o;const T=s.statusText||"OK",I=new X4(s.getAllResponseHeaders()),z=function i5e(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(s)||e.url;return o=new TN({headers:I,status:s.status,statusText:T,url:z}),o},u=()=>{let{headers:T,status:I,statusText:z,url:Z}=c(),te=null;204!==I&&(te=typeof s.response>"u"?s.responseText:s.response),0===I&&(I=te?200:0);let me=I>=200&&I<300;if("json"===e.responseType&&"string"==typeof te){const J=te;te=te.replace(s5e,"");try{te=""!==te?JSON.parse(te):null}catch(Ne){te=J,me&&(me=!1,te={error:Ne,text:te})}}me?(r.next(new XC({body:te,headers:T,status:I,statusText:z,url:Z||void 0})),r.complete()):r.error(new eW({error:te,headers:T,status:I,statusText:z,url:Z||void 0}))},h=T=>{const{url:I}=c(),z=new eW({error:T,status:s.status||0,statusText:s.statusText||"Unknown Error",url:I||void 0});r.error(z)};let g=!1;const m=T=>{g||(r.next(c()),g=!0);let I={type:Ls.DownloadProgress,loaded:T.loaded};T.lengthComputable&&(I.total=T.total),"text"===e.responseType&&!!s.responseText&&(I.partialText=s.responseText),r.next(I)},v=T=>{let I={type:Ls.UploadProgress,loaded:T.loaded};T.lengthComputable&&(I.total=T.total),r.next(I)};return s.addEventListener("load",u),s.addEventListener("error",h),s.addEventListener("timeout",h),s.addEventListener("abort",h),e.reportProgress&&(s.addEventListener("progress",m),null!==i&&s.upload&&s.upload.addEventListener("progress",v)),s.send(i),r.next({type:Ls.Sent}),()=>{s.removeEventListener("error",h),s.removeEventListener("abort",h),s.removeEventListener("load",u),s.removeEventListener("timeout",h),e.reportProgress&&(s.removeEventListener("progress",m),null!==i&&s.upload&&s.upload.removeEventListener("progress",v)),s.readyState!==s.DONE&&s.abort()}})}}return n.\u0275fac=function(e){return new(e||n)(xe(_U))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})();const bN=new It("XSRF_COOKIE_NAME"),NN=new It("XSRF_HEADER_NAME");class sW{}let o5e=(()=>{class n{constructor(e,r,s){this.doc=e,this.platform=r,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=aU(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return n.\u0275fac=function(e){return new(e||n)(xe(Os),xe(E9),xe(bN))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})(),AN=(()=>{class n{constructor(e,r){this.tokenService=e,this.headerName=r}intercept(e,r){const s=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||s.startsWith("http://")||s.startsWith("https://"))return r.handle(e);const i=this.tokenService.getToken();return null!==i&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,i)})),r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(xe(sW),xe(NN))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})(),a5e=(()=>{class n{constructor(e,r){this.backend=e,this.injector=r,this.chain=null}handle(e){if(null===this.chain){const r=this.injector.get(nW,[]);this.chain=r.reduceRight((s,i)=>new tW(s,i),this.backend)}return this.chain.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(xe(YG),xe(Xs))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})(),c5e=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:AN,useClass:r5e}]}}static withOptions(e={}){return{ngModule:n,providers:[e.cookieName?{provide:bN,useValue:e.cookieName}:[],e.headerName?{provide:NN,useValue:e.headerName}:[]]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=qs({type:n}),n.\u0275inj=Fr({providers:[AN,{provide:nW,useExisting:AN,multi:!0},{provide:sW,useClass:o5e},{provide:bN,useValue:"XSRF-TOKEN"},{provide:NN,useValue:"X-XSRF-TOKEN"}]}),n})(),l5e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=qs({type:n}),n.\u0275inj=Fr({providers:[n5e,{provide:ZG,useClass:a5e},rW,{provide:YG,useExisting:rW}],imports:[c5e.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),n})();class Wc extends pi{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:r}=this;if(t)throw e;return this._throwIfClosed(),r}next(t){super.next(this._value=t)}}const QC=Xr(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function iW(...n){const t=g3(n),e=jt(n),{args:r,keys:s}=$U(n);if(0===r.length)return Jr([],t);const i=new gr(function u5e(n,t,e=p4){return r=>{oW(t,()=>{const{length:s}=n,i=new Array(s);let o=s,c=s;for(let u=0;u<s;u++)oW(t,()=>{const h=Jr(n[u],t);let g=!1;h.subscribe(Qr(r,m=>{i[u]=m,g||(g=!0,c--),c||r.next(e(i.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,t,s?o=>GU(s,o):p4));return e?i.pipe(UU(e)):i}function oW(n,t,e){n?bs(e,n,t):t()}function ON(...n){return function f5e(){return _4(1)}()(Jr(n,g3(n)))}function aW(n){return new gr(t=>{mo(n()).subscribe(t)})}function H9(n,t){const e=en(n)?n:()=>n,r=s=>s.error(e());return new gr(t?s=>t.schedule(r,0,s):r)}function IN(){return or((n,t)=>{let e=null;n._refCount++;const r=Qr(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const s=n._connection,i=e;e=null,s&&(!i||s===i)&&s.unsubscribe(),t.unsubscribe()});n.subscribe(r),r.closed||(e=n.connect())})}class cW extends gr{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,gm(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new H1;const e=this.getSubject();t.add(this.source.subscribe(Qr(e,void 0,()=>{this._teardown(),e.complete()},r=>{this._teardown(),e.error(r)},()=>this._teardown()))),t.closed&&(this._connection=null,t=H1.EMPTY)}return t}refCount(){return IN()(this)}}function U3(n,t){return or((e,r)=>{let s=null,i=0,o=!1;const c=()=>o&&!s&&r.complete();e.subscribe(Qr(r,u=>{s?.unsubscribe();let h=0;const g=i++;mo(n(u,g)).subscribe(s=Qr(r,m=>r.next(t?t(u,m,g,h++):m),()=>{s=null,c()}))},()=>{o=!0,c()}))})}function F9(n){return n<=0?()=>xa:or((t,e)=>{let r=0;t.subscribe(Qr(e,s=>{++r<=n&&(e.next(s),n<=r&&e.complete())}))})}function JC(n){return or((t,e)=>{let r=!1;t.subscribe(Qr(e,s=>{r=!0,e.next(s)},()=>{r||e.next(n),e.complete()}))})}function lW(n=d5e){return or((t,e)=>{let r=!1;t.subscribe(Qr(e,s=>{r=!0,e.next(s)},()=>r?e.complete():e.error(n())))})}function d5e(){return new QC}function z6(n,t){const e=arguments.length>=2;return r=>r.pipe(n?K4((s,i)=>n(s,i,r)):p4,F9(1),e?JC(t):lW(()=>new QC))}function J2(n,t,e){const r=en(n)||t||e?{next:n,error:t,complete:e}:n;return r?or((s,i)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let c=!0;s.subscribe(Qr(i,u=>{var h;null===(h=r.next)||void 0===h||h.call(r,u),i.next(u)},()=>{var u;c=!1,null===(u=r.complete)||void 0===u||u.call(r),i.complete()},u=>{var h;c=!1,null===(h=r.error)||void 0===h||h.call(r,u),i.error(u)},()=>{var u,h;c&&(null===(u=r.unsubscribe)||void 0===u||u.call(r)),null===(h=r.finalize)||void 0===h||h.call(r)}))}):p4}function V6(n){return or((t,e)=>{let i,r=null,s=!1;r=t.subscribe(Qr(e,void 0,void 0,o=>{i=mo(n(o,V6(n)(t))),r?(r.unsubscribe(),r=null,i.subscribe(e)):s=!0})),s&&(r.unsubscribe(),r=null,i.subscribe(e))})}function p5e(n,t,e,r,s){return(i,o)=>{let c=e,u=t,h=0;i.subscribe(Qr(o,g=>{const m=h++;u=c?n(u,g,m):(c=!0,g),r&&o.next(u)},s&&(()=>{c&&o.next(u),o.complete()})))}}function uW(n,t){return or(p5e(n,t,arguments.length>=2,!0))}function xN(n){return n<=0?()=>xa:or((t,e)=>{let r=[];t.subscribe(Qr(e,s=>{r.push(s),n<r.length&&r.shift()},()=>{for(const s of r)e.next(s);e.complete()},void 0,()=>{r=null}))})}function fW(n,t){const e=arguments.length>=2;return r=>r.pipe(n?K4((s,i)=>n(s,i,r)):p4,xN(1),e?JC(t):lW(()=>new QC))}function LN(n){return or((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}const Rn="primary",B9=Symbol("RouteTitle");class _5e{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function P7(n){return new _5e(n)}function v5e(n,t,e){const r=e.path.split("/");if(r.length>n.length||"full"===e.pathMatch&&(t.hasChildren()||r.length<n.length))return null;const s={};for(let i=0;i<r.length;i++){const o=r[i],c=n[i];if(o.startsWith(":"))s[o.substring(1)]=c;else if(o!==c.path)return null}return{consumed:n.slice(0,r.length),posParams:s}}function G3(n,t){const e=n?Object.keys(n):void 0,r=t?Object.keys(t):void 0;if(!e||!r||e.length!=r.length)return!1;let s;for(let i=0;i<e.length;i++)if(s=e[i],!hW(n[s],t[s]))return!1;return!0}function hW(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;const e=[...n].sort(),r=[...t].sort();return e.every((s,i)=>r[i]===s)}return n===t}function dW(n){return Array.prototype.concat.apply([],n)}function pW(n){return n.length>0?n[n.length-1]:null}function ei(n,t){for(const e in n)n.hasOwnProperty(e)&&t(n[e],e)}function H6(n){return Kw(n)?n:u9(n)?Jr(Promise.resolve(n)):Ut(n)}const E5e={exact:function _W(n,t,e){if(!Hu(n.segments,t.segments)||!ey(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(const r in t.children)if(!n.children[r]||!_W(n.children[r],t.children[r],e))return!1;return!0},subset:vW},gW={exact:function M5e(n,t){return G3(n,t)},subset:function S5e(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>hW(n[e],t[e]))},ignored:()=>!0};function mW(n,t,e){return E5e[e.paths](n.root,t.root,e.matrixParams)&&gW[e.queryParams](n.queryParams,t.queryParams)&&!("exact"===e.fragment&&n.fragment!==t.fragment)}function vW(n,t,e){return CW(n,t,t.segments,e)}function CW(n,t,e,r){if(n.segments.length>e.length){const s=n.segments.slice(0,e.length);return!(!Hu(s,e)||t.hasChildren()||!ey(s,e,r))}if(n.segments.length===e.length){if(!Hu(n.segments,e)||!ey(n.segments,e,r))return!1;for(const s in t.children)if(!n.children[s]||!vW(n.children[s],t.children[s],r))return!1;return!0}{const s=e.slice(0,n.segments.length),i=e.slice(n.segments.length);return!!(Hu(n.segments,s)&&ey(n.segments,s,r)&&n.children[Rn])&&CW(n.children[Rn],t,i,r)}}function ey(n,t,e){return t.every((r,s)=>gW[e](n[s].parameters,r.parameters))}class Vu{constructor(t,e,r){this.root=t,this.queryParams=e,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=P7(this.queryParams)),this._queryParamMap}toString(){return w5e.serialize(this)}}class Bn{constructor(t,e){this.segments=t,this.children=e,this.parent=null,ei(e,(r,s)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ty(this)}}class $9{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=P7(this.parameters)),this._parameterMap}toString(){return SW(this)}}function Hu(n,t){return n.length===t.length&&n.every((e,r)=>e.path===t[r].path)}let yW=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Xe({token:n,factory:function(){return new RN},providedIn:"root"}),n})();class RN{parse(t){const e=new R5e(t);return new Vu(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${U9(t.root,!0)}`,r=function A5e(n){const t=Object.keys(n).map(e=>{const r=n[e];return Array.isArray(r)?r.map(s=>`${ny(e)}=${ny(s)}`).join("&"):`${ny(e)}=${ny(r)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${r}${"string"==typeof t.fragment?`#${function b5e(n){return encodeURI(n)}(t.fragment)}`:""}`}}const w5e=new RN;function ty(n){return n.segments.map(t=>SW(t)).join("/")}function U9(n,t){if(!n.hasChildren())return ty(n);if(t){const e=n.children[Rn]?U9(n.children[Rn],!1):"",r=[];return ei(n.children,(s,i)=>{i!==Rn&&r.push(`${i}:${U9(s,!1)}`)}),r.length>0?`${e}(${r.join("//")})`:e}{const e=function T5e(n,t){let e=[];return ei(n.children,(r,s)=>{s===Rn&&(e=e.concat(t(r,s)))}),ei(n.children,(r,s)=>{s!==Rn&&(e=e.concat(t(r,s)))}),e}(n,(r,s)=>s===Rn?[U9(n.children[Rn],!1)]:[`${s}:${U9(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Rn]?`${ty(n)}/${e[0]}`:`${ty(n)}/(${e.join("//")})`}}function EW(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ny(n){return EW(n).replace(/%3B/gi,";")}function DN(n){return EW(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ry(n){return decodeURIComponent(n)}function MW(n){return ry(n.replace(/\+/g,"%20"))}function SW(n){return`${DN(n.path)}${function N5e(n){return Object.keys(n).map(t=>`;${DN(t)}=${DN(n[t])}`).join("")}(n.parameters)}`}const O5e=/^[^\/()?;=#]+/;function sy(n){const t=n.match(O5e);return t?t[0]:""}const I5e=/^[^=?&#]+/,L5e=/^[^&#]+/;class R5e{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Bn([],{}):new Bn([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(r[Rn]=new Bn(t,e)),r}parseSegment(){const t=sy(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Te(4009,!1);return this.capture(t),new $9(ry(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=sy(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const s=sy(this.remaining);s&&(r=s,this.capture(r))}t[ry(e)]=ry(r)}parseQueryParam(t){const e=function x5e(n){const t=n.match(I5e);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const o=function k5e(n){const t=n.match(L5e);return t?t[0]:""}(this.remaining);o&&(r=o,this.capture(r))}const s=MW(e),i=MW(r);if(t.hasOwnProperty(s)){let o=t[s];Array.isArray(o)||(o=[o],t[s]=o),o.push(i)}else t[s]=i}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=sy(this.remaining),s=this.remaining[r.length];if("/"!==s&&")"!==s&&";"!==s)throw new Te(4010,!1);let i;r.indexOf(":")>-1?(i=r.slice(0,r.indexOf(":")),this.capture(i),this.capture(":")):t&&(i=Rn);const o=this.parseChildren();e[i]=1===Object.keys(o).length?o[Rn]:new Bn([],o),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Te(4011,!1)}}function zN(n){return n.segments.length>0?new Bn([],{[Rn]:n}):n}function iy(n){const t={};for(const r of Object.keys(n.children)){const i=iy(n.children[r]);(i.segments.length>0||i.hasChildren())&&(t[r]=i)}return function D5e(n){if(1===n.numberOfChildren&&n.children[Rn]){const t=n.children[Rn];return new Bn(n.segments.concat(t.segments),t.children)}return n}(new Bn(n.segments,t))}function Fu(n){return n instanceof Vu}function H5e(n,t,e,r,s){if(0===e.length)return T7(t.root,t.root,t.root,r,s);const i=function wW(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new TW(!0,0,n);let t=0,e=!1;const r=n.reduce((s,i,o)=>{if("object"==typeof i&&null!=i){if(i.outlets){const c={};return ei(i.outlets,(u,h)=>{c[h]="string"==typeof u?u.split("/"):u}),[...s,{outlets:c}]}if(i.segmentPath)return[...s,i.segmentPath]}return"string"!=typeof i?[...s,i]:0===o?(i.split("/").forEach((c,u)=>{0==u&&"."===c||(0==u&&""===c?e=!0:".."===c?t++:""!=c&&s.push(c))}),s):[...s,i]},[]);return new TW(e,t,r)}(e);return i.toRoot()?T7(t.root,t.root,new Bn([],{}),r,s):function o(u){const h=function B5e(n,t,e,r){if(n.isAbsolute)return new w7(t.root,!0,0);if(-1===r)return new w7(e,e===t.root,0);return function bW(n,t,e){let r=n,s=t,i=e;for(;i>s;){if(i-=s,r=r.parent,!r)throw new Te(4005,!1);s=r.segments.length}return new w7(r,!1,s-i)}(e,r+(G9(n.commands[0])?0:1),n.numberOfDoubleDots)}(i,t,n.snapshot?._urlSegment,u),g=h.processChildren?q9(h.segmentGroup,h.index,i.commands):HN(h.segmentGroup,h.index,i.commands);return T7(t.root,h.segmentGroup,g,r,s)}(n.snapshot?._lastPathIndex)}function G9(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function W9(n){return"object"==typeof n&&null!=n&&n.outlets}function T7(n,t,e,r,s){let o,i={};r&&ei(r,(u,h)=>{i[h]=Array.isArray(u)?u.map(g=>`${g}`):`${u}`}),o=n===t?e:PW(n,t,e);const c=zN(iy(o));return new Vu(c,i,s)}function PW(n,t,e){const r={};return ei(n.children,(s,i)=>{r[i]=s===t?e:PW(s,t,e)}),new Bn(n.segments,r)}class TW{constructor(t,e,r){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=r,t&&r.length>0&&G9(r[0]))throw new Te(4003,!1);const s=r.find(W9);if(s&&s!==pW(r))throw new Te(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class w7{constructor(t,e,r){this.segmentGroup=t,this.processChildren=e,this.index=r}}function HN(n,t,e){if(n||(n=new Bn([],{})),0===n.segments.length&&n.hasChildren())return q9(n,t,e);const r=function U5e(n,t,e){let r=0,s=t;const i={match:!1,pathIndex:0,commandIndex:0};for(;s<n.segments.length;){if(r>=e.length)return i;const o=n.segments[s],c=e[r];if(W9(c))break;const u=`${c}`,h=r<e.length-1?e[r+1]:null;if(s>0&&void 0===u)break;if(u&&h&&"object"==typeof h&&void 0===h.outlets){if(!AW(u,h,o))return i;r+=2}else{if(!AW(u,{},o))return i;r++}s++}return{match:!0,pathIndex:s,commandIndex:r}}(n,t,e),s=e.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const i=new Bn(n.segments.slice(0,r.pathIndex),{});return i.children[Rn]=new Bn(n.segments.slice(r.pathIndex),n.children),q9(i,0,s)}return r.match&&0===s.length?new Bn(n.segments,{}):r.match&&!n.hasChildren()?FN(n,t,e):r.match?q9(n,0,s):FN(n,t,e)}function q9(n,t,e){if(0===e.length)return new Bn(n.segments,{});{const r=function $5e(n){return W9(n[0])?n[0].outlets:{[Rn]:n}}(e),s={};return ei(r,(i,o)=>{"string"==typeof i&&(i=[i]),null!==i&&(s[o]=HN(n.children[o],t,i))}),ei(n.children,(i,o)=>{void 0===r[o]&&(s[o]=i)}),new Bn(n.segments,s)}}function FN(n,t,e){const r=n.segments.slice(0,t);let s=0;for(;s<e.length;){const i=e[s];if(W9(i)){const u=G5e(i.outlets);return new Bn(r,u)}if(0===s&&G9(e[0])){r.push(new $9(n.segments[t].path,NW(e[0]))),s++;continue}const o=W9(i)?i.outlets[Rn]:`${i}`,c=s<e.length-1?e[s+1]:null;o&&c&&G9(c)?(r.push(new $9(o,NW(c))),s+=2):(r.push(new $9(o,{})),s++)}return new Bn(r,{})}function G5e(n){const t={};return ei(n,(e,r)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[r]=FN(new Bn([],{}),0,e))}),t}function NW(n){const t={};return ei(n,(e,r)=>t[r]=`${e}`),t}function AW(n,t,e){return n==e.path&&G3(t,e.parameters)}class Q4{constructor(t,e){this.id=t,this.url=e}}class BN extends Q4{constructor(t,e,r="imperative",s=null){super(t,e),this.type=0,this.navigationTrigger=r,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class F6 extends Q4{constructor(t,e,r){super(t,e),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class oy extends Q4{constructor(t,e,r,s){super(t,e),this.reason=r,this.code=s,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class OW extends Q4{constructor(t,e,r,s){super(t,e),this.error=r,this.target=s,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class W5e extends Q4{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class q5e extends Q4{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class j5e extends Q4{constructor(t,e,r,s,i){super(t,e),this.urlAfterRedirects=r,this.state=s,this.shouldActivate=i,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Z5e extends Q4{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Y5e extends Q4{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class K5e{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class X5e{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Q5e{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class J5e{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class e7e{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class t7e{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class IW{constructor(t,e,r){this.routerEvent=t,this.position=e,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class xW{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=$N(t,this._root);return e?e.children.map(r=>r.value):[]}firstChild(t){const e=$N(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=UN(t,this._root);return e.length<2?[]:e[e.length-2].children.map(s=>s.value).filter(s=>s!==t)}pathFromRoot(t){return UN(t,this._root).map(e=>e.value)}}function $N(n,t){if(n===t.value)return t;for(const e of t.children){const r=$N(n,e);if(r)return r}return null}function UN(n,t){if(n===t.value)return[t];for(const e of t.children){const r=UN(n,e);if(r.length)return r.unshift(t),r}return[]}class J4{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function b7(n){const t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}class LW extends xW{constructor(t,e){super(t),this.snapshot=e,GN(this,t)}toString(){return this.snapshot.toString()}}function kW(n,t){const e=function r7e(n,t){const o=new ay([],{},{},"",{},Rn,t,null,n.root,-1,{});return new DW("",new J4(o,[]))}(n,t),r=new Wc([new $9("",{})]),s=new Wc({}),i=new Wc({}),o=new Wc({}),c=new Wc(""),u=new Qi(r,s,o,c,i,Rn,t,e.root);return u.snapshot=e.root,new LW(new J4(u,[]),e)}class Qi{constructor(t,e,r,s,i,o,c,u){this.url=t,this.params=e,this.queryParams=r,this.fragment=s,this.data=i,this.outlet=o,this.component=c,this.title=this.data?.pipe(un(h=>h[B9]))??Ut(void 0),this._futureSnapshot=u}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(un(t=>P7(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(un(t=>P7(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function RW(n,t="emptyOnly"){const e=n.pathFromRoot;let r=0;if("always"!==t)for(r=e.length-1;r>=1;){const s=e[r],i=e[r-1];if(s.routeConfig&&""===s.routeConfig.path)r--;else{if(i.component)break;r--}}return function s7e(n){return n.reduce((t,e)=>({params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(r))}class ay{constructor(t,e,r,s,i,o,c,u,h,g,m,v){this.url=t,this.params=e,this.queryParams=r,this.fragment=s,this.data=i,this.outlet=o,this.component=c,this.title=this.data?.[B9],this.routeConfig=u,this._urlSegment=h,this._lastPathIndex=g,this._correctedLastPathIndex=v??g,this._resolve=m}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=P7(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=P7(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class DW extends xW{constructor(t,e){super(e),this.url=t,GN(this,e)}toString(){return zW(this._root)}}function GN(n,t){t.value._routerState=n,t.children.forEach(e=>GN(n,e))}function zW(n){const t=n.children.length>0?` { ${n.children.map(zW).join(", ")} } `:"";return`${n.value}${t}`}function WN(n){if(n.snapshot){const t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,G3(t.queryParams,e.queryParams)||n.queryParams.next(e.queryParams),t.fragment!==e.fragment&&n.fragment.next(e.fragment),G3(t.params,e.params)||n.params.next(e.params),function C5e(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!G3(n[e],t[e]))return!1;return!0}(t.url,e.url)||n.url.next(e.url),G3(t.data,e.data)||n.data.next(e.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function qN(n,t){const e=G3(n.params,t.params)&&function P5e(n,t){return Hu(n,t)&&n.every((e,r)=>G3(e.parameters,t[r].parameters))}(n.url,t.url);return e&&!(!n.parent!=!t.parent)&&(!n.parent||qN(n.parent,t.parent))}function j9(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){const r=e.value;r._futureSnapshot=t.value;const s=function o7e(n,t,e){return t.children.map(r=>{for(const s of e.children)if(n.shouldReuseRoute(r.value,s.value.snapshot))return j9(n,r,s);return j9(n,r)})}(n,t,e);return new J4(r,s)}{if(n.shouldAttach(t.value)){const i=n.retrieve(t.value);if(null!==i){const o=i.route;return o.value._futureSnapshot=t.value,o.children=t.children.map(c=>j9(n,c)),o}}const r=function a7e(n){return new Qi(new Wc(n.url),new Wc(n.params),new Wc(n.queryParams),new Wc(n.fragment),new Wc(n.data),n.outlet,n.component,n)}(t.value),s=t.children.map(i=>j9(n,i));return new J4(r,s)}}const jN="ngNavigationCancelingError";function VW(n,t){const{redirectTo:e,navigationBehaviorOptions:r}=Fu(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,s=HW(!1,0,t);return s.url=e,s.navigationBehaviorOptions=r,s}function HW(n,t,e){const r=new Error("NavigationCancelingError: "+(n||""));return r[jN]=!0,r.cancellationCode=t,e&&(r.url=e),r}function FW(n){return BW(n)&&Fu(n.url)}function BW(n){return n&&n[jN]}class c7e{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Z9,this.attachRef=null}}let Z9=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(e,r){const s=this.getOrCreateContext(e);s.outlet=r,this.contexts.set(e,s)}onChildOutletDestroyed(e){const r=this.getContext(e);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let r=this.getContext(e);return r||(r=new c7e,this.contexts.set(e,r)),r}getContext(e){return this.contexts.get(e)||null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const cy=!1;let ZN=(()=>{class n{constructor(e,r,s,i,o){this.parentContexts=e,this.location=r,this.changeDetector=i,this.environmentInjector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new cr,this.deactivateEvents=new cr,this.attachEvents=new cr,this.detachEvents=new cr,this.name=s||Rn,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Te(4012,cy);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Te(4012,cy);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Te(4012,cy);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,r){this.activated=e,this._activatedRoute=r,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,r){if(this.isActivated)throw new Te(4013,cy);this._activatedRoute=e;const s=this.location,o=e._futureSnapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new l7e(e,c,s.injector);if(r&&function u7e(n){return!!n.resolveComponentFactory}(r)){const h=r.resolveComponentFactory(o);this.activated=s.createComponent(h,s.length,u)}else this.activated=s.createComponent(o,{index:s.length,injector:u,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(e){return new(e||n)(Q(Z9),Q(la),X0("name"),Q(Au),Q(na))},n.\u0275dir=Ht({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0}),n})();class l7e{constructor(t,e,r){this.route=t,this.childContexts=e,this.parent=r}get(t,e){return t===Qi?this.route:t===Z9?this.childContexts:this.parent.get(t,e)}}let YN=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=vt({type:n,selectors:[["ng-component"]],standalone:!0,features:[OB],decls:1,vars:0,template:function(e,r){1&e&&X(0,"router-outlet")},dependencies:[ZN],encapsulation:2}),n})();function $W(n,t){return n.providers&&!n._injector&&(n._injector=fC(n.providers,t,`Route: ${n.path}`)),n._injector??t}function XN(n){const t=n.children&&n.children.map(XN),e=t?{...n,children:t}:{...n};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==Rn&&(e.component=YN),e}function Ya(n){return n.outlet||Rn}function UW(n,t){const e=n.filter(r=>Ya(r)===t);return e.push(...n.filter(r=>Ya(r)!==t)),e}function Y9(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class g7e{constructor(t,e,r,s){this.routeReuseStrategy=t,this.futureState=e,this.currState=r,this.forwardEvent=s}activate(t){const e=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,r,t),WN(this.futureState.root),this.activateChildRoutes(e,r,t)}deactivateChildRoutes(t,e,r){const s=b7(e);t.children.forEach(i=>{const o=i.value.outlet;this.deactivateRoutes(i,s[o],r),delete s[o]}),ei(s,(i,o)=>{this.deactivateRouteAndItsChildren(i,r)})}deactivateRoutes(t,e,r){const s=t.value,i=e?e.value:null;if(s===i)if(s.component){const o=r.getContext(s.outlet);o&&this.deactivateChildRoutes(t,e,o.children)}else this.deactivateChildRoutes(t,e,r);else i&&this.deactivateRouteAndItsChildren(e,r)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const r=e.getContext(t.value.outlet),s=r&&t.value.component?r.children:e,i=b7(t);for(const o of Object.keys(i))this.deactivateRouteAndItsChildren(i[o],s);if(r&&r.outlet){const o=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:o,route:t,contexts:c})}}deactivateRouteAndOutlet(t,e){const r=e.getContext(t.value.outlet),s=r&&t.value.component?r.children:e,i=b7(t);for(const o of Object.keys(i))this.deactivateRouteAndItsChildren(i[o],s);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(t,e,r){const s=b7(e);t.children.forEach(i=>{this.activateRoutes(i,s[i.value.outlet],r),this.forwardEvent(new t7e(i.value.snapshot))}),t.children.length&&this.forwardEvent(new J5e(t.value.snapshot))}activateRoutes(t,e,r){const s=t.value,i=e?e.value:null;if(WN(s),s===i)if(s.component){const o=r.getOrCreateContext(s.outlet);this.activateChildRoutes(t,e,o.children)}else this.activateChildRoutes(t,e,r);else if(s.component){const o=r.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){const c=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),o.children.onOutletReAttached(c.contexts),o.attachRef=c.componentRef,o.route=c.route.value,o.outlet&&o.outlet.attach(c.componentRef,c.route.value),WN(c.route.value),this.activateChildRoutes(t,null,o.children)}else{const c=Y9(s.snapshot),u=c?.get(ra)??null;o.attachRef=null,o.route=s,o.resolver=u,o.injector=c,o.outlet&&o.outlet.activateWith(s,o.injector),this.activateChildRoutes(t,null,o.children)}}else this.activateChildRoutes(t,null,r)}}class GW{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class ly{constructor(t,e){this.component=t,this.route=e}}function m7e(n,t,e){const r=n._root;return K9(r,t?t._root:null,e,[r.value])}function N7(n,t){const e=Symbol(),r=t.get(n,e);return r===e?"function"!=typeof n||function mi(n){return null!==Tn(n)}(n)?t.get(n):n:r}function K9(n,t,e,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const i=b7(t);return n.children.forEach(o=>{(function v7e(n,t,e,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const i=n.value,o=t?t.value:null,c=e?e.getContext(n.value.outlet):null;if(o&&i.routeConfig===o.routeConfig){const u=function C7e(n,t,e){if("function"==typeof e)return e(n,t);switch(e){case"pathParamsChange":return!Hu(n.url,t.url);case"pathParamsOrQueryParamsChange":return!Hu(n.url,t.url)||!G3(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!qN(n,t)||!G3(n.queryParams,t.queryParams);default:return!qN(n,t)}}(o,i,i.routeConfig.runGuardsAndResolvers);u?s.canActivateChecks.push(new GW(r)):(i.data=o.data,i._resolvedData=o._resolvedData),K9(n,t,i.component?c?c.children:null:e,r,s),u&&c&&c.outlet&&c.outlet.isActivated&&s.canDeactivateChecks.push(new ly(c.outlet.component,o))}else o&&X9(t,c,s),s.canActivateChecks.push(new GW(r)),K9(n,null,i.component?c?c.children:null:e,r,s)})(o,i[o.value.outlet],e,r.concat([o.value]),s),delete i[o.value.outlet]}),ei(i,(o,c)=>X9(o,e.getContext(c),s)),s}function X9(n,t,e){const r=b7(n),s=n.value;ei(r,(i,o)=>{X9(i,s.component?t?t.children.getContext(o):null:t,e)}),e.canDeactivateChecks.push(new ly(s.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,s))}function Q9(n){return"function"==typeof n}function QN(n){return n instanceof QC||"EmptyError"===n?.name}const uy=Symbol("INITIAL_VALUE");function A7(){return U3(n=>iW(n.map(t=>t.pipe(F9(1),function h5e(...n){const t=g3(n);return or((e,r)=>{(t?ON(n,e,t):ON(n,e)).subscribe(r)})}(uy)))).pipe(un(t=>{for(const e of t)if(!0!==e){if(e===uy)return uy;if(!1===e||e instanceof Vu)return e}return!0}),K4(t=>t!==uy),F9(1)))}function WW(n){return function tP(...n){return pm(n)}(J2(t=>{if(Fu(t))throw VW(0,t)}),un(t=>!0===t))}const JN={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function qW(n,t,e,r,s){const i=eA(n,t,e);return i.matched?function D7e(n,t,e,r){const s=t.canMatch;return s&&0!==s.length?Ut(s.map(o=>{const c=N7(o,n);return H6(function T7e(n){return n&&Q9(n.canMatch)}(c)?c.canMatch(t,e):n.runInContext(()=>c(t,e)))})).pipe(A7(),WW()):Ut(!0)}(r=$W(t,r),t,e).pipe(un(o=>!0===o?i:{...JN})):Ut(i)}function eA(n,t,e){if(""===t.path)return"full"===t.pathMatch&&(n.hasChildren()||e.length>0)?{...JN}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const s=(t.matcher||v5e)(e,n,t);if(!s)return{...JN};const i={};ei(s.posParams,(c,u)=>{i[u]=c.path});const o=s.consumed.length>0?{...i,...s.consumed[s.consumed.length-1].parameters}:i;return{matched:!0,consumedSegments:s.consumed,remainingSegments:e.slice(s.consumed.length),parameters:o,positionalParamSegments:s.posParams??{}}}function fy(n,t,e,r,s="corrected"){if(e.length>0&&function H7e(n,t,e){return e.some(r=>hy(n,t,r)&&Ya(r)!==Rn)}(n,e,r)){const o=new Bn(t,function V7e(n,t,e,r){const s={};s[Rn]=r,r._sourceSegment=n,r._segmentIndexShift=t.length;for(const i of e)if(""===i.path&&Ya(i)!==Rn){const o=new Bn([],{});o._sourceSegment=n,o._segmentIndexShift=t.length,s[Ya(i)]=o}return s}(n,t,r,new Bn(e,n.children)));return o._sourceSegment=n,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:[]}}if(0===e.length&&function F7e(n,t,e){return e.some(r=>hy(n,t,r))}(n,e,r)){const o=new Bn(n.segments,function z7e(n,t,e,r,s,i){const o={};for(const c of r)if(hy(n,e,c)&&!s[Ya(c)]){const u=new Bn([],{});u._sourceSegment=n,u._segmentIndexShift="legacy"===i?n.segments.length:t.length,o[Ya(c)]=u}return{...s,...o}}(n,t,e,r,n.children,s));return o._sourceSegment=n,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:e}}const i=new Bn(n.segments,n.children);return i._sourceSegment=n,i._segmentIndexShift=t.length,{segmentGroup:i,slicedSegments:e}}function hy(n,t,e){return(!(n.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}function jW(n,t,e,r){return!!(Ya(n)===r||r!==Rn&&hy(t,e,n))&&("**"===n.path||eA(t,n,e).matched)}function ZW(n,t,e){return 0===t.length&&!n.children[e]}const dy=!1;class py{constructor(t){this.segmentGroup=t||null}}class YW{constructor(t){this.urlTree=t}}function J9(n){return H9(new py(n))}function KW(n){return H9(new YW(n))}class G7e{constructor(t,e,r,s,i){this.injector=t,this.configLoader=e,this.urlSerializer=r,this.urlTree=s,this.config=i,this.allowRedirects=!0}apply(){const t=fy(this.urlTree.root,[],[],this.config).segmentGroup,e=new Bn(t.segments,t.children);return this.expandSegmentGroup(this.injector,this.config,e,Rn).pipe(un(i=>this.createUrlTree(iy(i),this.urlTree.queryParams,this.urlTree.fragment))).pipe(V6(i=>{if(i instanceof YW)return this.allowRedirects=!1,this.match(i.urlTree);throw i instanceof py?this.noMatchError(i):i}))}match(t){return this.expandSegmentGroup(this.injector,this.config,t.root,Rn).pipe(un(s=>this.createUrlTree(iy(s),t.queryParams,t.fragment))).pipe(V6(s=>{throw s instanceof py?this.noMatchError(s):s}))}noMatchError(t){return new Te(4002,dy)}createUrlTree(t,e,r){const s=zN(t);return new Vu(s,e,r)}expandSegmentGroup(t,e,r,s){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(t,e,r).pipe(un(i=>new Bn([],i))):this.expandSegment(t,r,e,r.segments,s,!0)}expandChildren(t,e,r){const s=[];for(const i of Object.keys(r.children))"primary"===i?s.unshift(i):s.push(i);return Jr(s).pipe(R6(i=>{const o=r.children[i],c=UW(e,i);return this.expandSegmentGroup(t,c,o,i).pipe(un(u=>({segment:u,outlet:i})))}),uW((i,o)=>(i[o.outlet]=o.segment,i),{}),fW())}expandSegment(t,e,r,s,i,o){return Jr(r).pipe(R6(c=>this.expandSegmentAgainstRoute(t,e,r,c,s,i,o).pipe(V6(h=>{if(h instanceof py)return Ut(null);throw h}))),z6(c=>!!c),V6((c,u)=>{if(QN(c))return ZW(e,s,i)?Ut(new Bn([],{})):J9(e);throw c}))}expandSegmentAgainstRoute(t,e,r,s,i,o,c){return jW(s,e,i,o)?void 0===s.redirectTo?this.matchSegmentAgainstRoute(t,e,s,i,o):c&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o):J9(e):J9(e)}expandSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o){return"**"===s.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,r,s,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,r,s){const i=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?KW(i):this.lineralizeSegments(r,i).pipe(Le(o=>{const c=new Bn(o,{});return this.expandSegment(t,c,e,o,s,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o){const{matched:c,consumedSegments:u,remainingSegments:h,positionalParamSegments:g}=eA(e,s,i);if(!c)return J9(e);const m=this.applyRedirectCommands(u,s.redirectTo,g);return s.redirectTo.startsWith("/")?KW(m):this.lineralizeSegments(s,m).pipe(Le(v=>this.expandSegment(t,e,r,v.concat(h),o,!1)))}matchSegmentAgainstRoute(t,e,r,s,i){return"**"===r.path?(t=$W(r,t),r.loadChildren?(r._loadedRoutes?Ut({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(t,r)).pipe(un(c=>(r._loadedRoutes=c.routes,r._loadedInjector=c.injector,new Bn(s,{})))):Ut(new Bn(s,{}))):qW(e,r,s,t).pipe(U3(({matched:o,consumedSegments:c,remainingSegments:u})=>o?this.getChildConfig(t=r._injector??t,r,s).pipe(Le(g=>{const m=g.injector??t,v=g.routes,{segmentGroup:T,slicedSegments:I}=fy(e,c,u,v),z=new Bn(T.segments,T.children);if(0===I.length&&z.hasChildren())return this.expandChildren(m,v,z).pipe(un(J=>new Bn(c,J)));if(0===v.length&&0===I.length)return Ut(new Bn(c,{}));const Z=Ya(r)===i;return this.expandSegment(m,z,v,I,Z?Rn:i,!0).pipe(un(me=>new Bn(c.concat(me.segments),me.children)))})):J9(e)))}getChildConfig(t,e,r){return e.children?Ut({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?Ut({routes:e._loadedRoutes,injector:e._loadedInjector}):function R7e(n,t,e,r){const s=t.canLoad;return void 0===s||0===s.length?Ut(!0):Ut(s.map(o=>{const c=N7(o,n);return H6(function E7e(n){return n&&Q9(n.canLoad)}(c)?c.canLoad(t,e):n.runInContext(()=>c(t,e)))})).pipe(A7(),WW())}(t,e,r).pipe(Le(s=>s?this.configLoader.loadChildren(t,e).pipe(J2(i=>{e._loadedRoutes=i.routes,e._loadedInjector=i.injector})):function $7e(n){return H9(HW(dy,3))}())):Ut({routes:[],injector:t})}lineralizeSegments(t,e){let r=[],s=e.root;for(;;){if(r=r.concat(s.segments),0===s.numberOfChildren)return Ut(r);if(s.numberOfChildren>1||!s.children[Rn])return H9(new Te(4e3,dy));s=s.children[Rn]}}applyRedirectCommands(t,e,r){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,r)}applyRedirectCreateUrlTree(t,e,r,s){const i=this.createSegmentGroup(t,e.root,r,s);return new Vu(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const r={};return ei(t,(s,i)=>{if("string"==typeof s&&s.startsWith(":")){const c=s.substring(1);r[i]=e[c]}else r[i]=s}),r}createSegmentGroup(t,e,r,s){const i=this.createSegments(t,e.segments,r,s);let o={};return ei(e.children,(c,u)=>{o[u]=this.createSegmentGroup(t,c,r,s)}),new Bn(i,o)}createSegments(t,e,r,s){return e.map(i=>i.path.startsWith(":")?this.findPosParam(t,i,s):this.findOrReturn(i,r))}findPosParam(t,e,r){const s=r[e.path.substring(1)];if(!s)throw new Te(4001,dy);return s}findOrReturn(t,e){let r=0;for(const s of e){if(s.path===t.path)return e.splice(r),s;r++}return t}}class q7e{}class Y7e{constructor(t,e,r,s,i,o,c,u){this.injector=t,this.rootComponentType=e,this.config=r,this.urlTree=s,this.url=i,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=c,this.urlSerializer=u}recognize(){const t=fy(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,Rn).pipe(un(e=>{if(null===e)return null;const r=new ay([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Rn,this.rootComponentType,null,this.urlTree.root,-1,{}),s=new J4(r,e),i=new DW(this.url,s);return this.inheritParamsAndData(i._root),i}))}inheritParamsAndData(t){const e=t.value,r=RW(e,this.paramsInheritanceStrategy);e.params=Object.freeze(r.params),e.data=Object.freeze(r.data),t.children.forEach(s=>this.inheritParamsAndData(s))}processSegmentGroup(t,e,r,s){return 0===r.segments.length&&r.hasChildren()?this.processChildren(t,e,r):this.processSegment(t,e,r,r.segments,s)}processChildren(t,e,r){return Jr(Object.keys(r.children)).pipe(R6(s=>{const i=r.children[s],o=UW(e,s);return this.processSegmentGroup(t,o,i,s)}),uW((s,i)=>s&&i?(s.push(...i),s):null),function g5e(n,t=!1){return or((e,r)=>{let s=0;e.subscribe(Qr(r,i=>{const o=n(i,s++);(o||t)&&r.next(i),!o&&r.complete()}))})}(s=>null!==s),JC(null),fW(),un(s=>{if(null===s)return null;const i=XW(s);return function K7e(n){n.sort((t,e)=>t.value.outlet===Rn?-1:e.value.outlet===Rn?1:t.value.outlet.localeCompare(e.value.outlet))}(i),i}))}processSegment(t,e,r,s,i){return Jr(e).pipe(R6(o=>this.processSegmentAgainstRoute(o._injector??t,o,r,s,i)),z6(o=>!!o),V6(o=>{if(QN(o))return ZW(r,s,i)?Ut([]):Ut(null);throw o}))}processSegmentAgainstRoute(t,e,r,s,i){if(e.redirectTo||!jW(e,r,s,i))return Ut(null);let o;if("**"===e.path){const c=s.length>0?pW(s).parameters:{},u=JW(r)+s.length;o=Ut({snapshot:new ay(s,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,tq(e),Ya(e),e.component??e._loadedComponent??null,e,QW(r),u,nq(e),u),consumedSegments:[],remainingSegments:[]})}else o=qW(r,e,s,t).pipe(un(({matched:c,consumedSegments:u,remainingSegments:h,parameters:g})=>{if(!c)return null;const m=JW(r)+u.length;return{snapshot:new ay(u,g,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,tq(e),Ya(e),e.component??e._loadedComponent??null,e,QW(r),m,nq(e),m),consumedSegments:u,remainingSegments:h}}));return o.pipe(U3(c=>{if(null===c)return Ut(null);const{snapshot:u,consumedSegments:h,remainingSegments:g}=c;t=e._injector??t;const m=e._loadedInjector??t,v=function X7e(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(e),{segmentGroup:T,slicedSegments:I}=fy(r,h,g,v.filter(Z=>void 0===Z.redirectTo),this.relativeLinkResolution);if(0===I.length&&T.hasChildren())return this.processChildren(m,v,T).pipe(un(Z=>null===Z?null:[new J4(u,Z)]));if(0===v.length&&0===I.length)return Ut([new J4(u,[])]);const z=Ya(e)===i;return this.processSegment(m,v,T,I,z?Rn:i).pipe(un(Z=>null===Z?null:[new J4(u,Z)]))}))}}function Q7e(n){const t=n.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function XW(n){const t=[],e=new Set;for(const r of n){if(!Q7e(r)){t.push(r);continue}const s=t.find(i=>r.value.routeConfig===i.value.routeConfig);void 0!==s?(s.children.push(...r.children),e.add(s)):t.push(r)}for(const r of e){const s=XW(r.children);t.push(new J4(r.value,s))}return t.filter(r=>!e.has(r))}function QW(n){let t=n;for(;t._sourceSegment;)t=t._sourceSegment;return t}function JW(n){let t=n,e=t._segmentIndexShift??0;for(;t._sourceSegment;)t=t._sourceSegment,e+=t._segmentIndexShift??0;return e-1}function tq(n){return n.data||{}}function nq(n){return n.resolve||{}}function rq(n){return"string"==typeof n.title||null===n.title}function tA(n){return U3(t=>{const e=n(t);return e?Jr(e).pipe(un(()=>t)):Ut(t)})}let sq=(()=>{class n{buildTitle(e){let r,s=e.root;for(;void 0!==s;)r=this.getResolvedTitleForRoute(s)??r,s=s.children.find(i=>i.outlet===Rn);return r}getResolvedTitleForRoute(e){return e.data[B9]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Xe({token:n,factory:function(){return Ir(iq)},providedIn:"root"}),n})(),iq=(()=>{class n extends sq{constructor(e){super(),this.title=e}updateTitle(e){const r=this.buildTitle(e);void 0!==r&&this.title.setTitle(r)}}return n.\u0275fac=function(e){return new(e||n)(xe(zU))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class ofe{}class cfe extends class afe{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const my=new It("",{providedIn:"root",factory:()=>({})}),nA=new It("ROUTES");let rA=(()=>{class n{constructor(e,r){this.injector=e,this.compiler=r,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return Ut(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const r=H6(e.loadComponent()).pipe(J2(i=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=i}),LN(()=>{this.componentLoaders.delete(e)})),s=new cW(r,()=>new pi).pipe(IN());return this.componentLoaders.set(e,s),s}loadChildren(e,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Ut({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const i=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe(un(c=>{this.onLoadEndListener&&this.onLoadEndListener(r);let u,h,g=!1;Array.isArray(c)?h=c:(u=c.create(e).injector,h=dW(u.get(nA,[],$t.Self|$t.Optional)));return{routes:h.map(XN),injector:u}}),LN(()=>{this.childrenLoaders.delete(r)})),o=new cW(i,()=>new pi).pipe(IN());return this.childrenLoaders.set(r,o),o}loadModuleFactoryOrRoutes(e){return H6(e()).pipe(Le(r=>r instanceof NB||Array.isArray(r)?Ut(r):Jr(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(e){return new(e||n)(xe(Xs),xe(Sb))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class ufe{}class ffe{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function hfe(n){throw n}function dfe(n,t,e){return t.parse("/")}const pfe={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},gfe={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function aq(){const n=Ir(yW),t=Ir(Z9),e=Ir(Vb),r=Ir(Xs),s=Ir(Sb),i=Ir(nA,{optional:!0})??[],o=Ir(my,{optional:!0})??{},c=Ir(iq),u=Ir(sq,{optional:!0}),h=Ir(ufe,{optional:!0}),g=Ir(ofe,{optional:!0}),m=new $n(null,n,t,e,r,s,dW(i));return h&&(m.urlHandlingStrategy=h),g&&(m.routeReuseStrategy=g),m.titleStrategy=u??c,function mfe(n,t){n.errorHandler&&(t.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(t.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(t.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(t.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(t.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(t.canceledNavigationResolution=n.canceledNavigationResolution)}(o,m),m}let $n=(()=>{class n{constructor(e,r,s,i,o,c,u){this.rootComponentType=e,this.urlSerializer=r,this.rootContexts=s,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new pi,this.errorHandler=hfe,this.malformedUriErrorHandler=dfe,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>Ut(void 0),this.urlHandlingStrategy=new ffe,this.routeReuseStrategy=new cfe,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=o.get(rA),this.configLoader.onLoadEndListener=v=>this.triggerEvent(new X5e(v)),this.configLoader.onLoadStartListener=v=>this.triggerEvent(new K5e(v)),this.ngModule=o.get(Nu),this.console=o.get(Gle);const m=o.get(vr);this.isNgZoneEnabled=m instanceof vr&&vr.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=function y5e(){return new Vu(new Bn([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=kW(this.currentUrlTree,this.rootComponentType),this.transitions=new Wc({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(e){const r=this.events;return e.pipe(K4(s=>0!==s.id),un(s=>({...s,extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),U3(s=>{let i=!1,o=!1;return Ut(s).pipe(J2(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),U3(c=>{const u=this.browserUrlTree.toString(),h=!this.navigated||c.extractedUrl.toString()!==u||u!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||h)&&this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return cq(c.source)&&(this.browserUrlTree=c.extractedUrl),Ut(c).pipe(U3(m=>{const v=this.transitions.getValue();return r.next(new BN(m.id,this.serializeUrl(m.extractedUrl),m.source,m.restoredState)),v!==this.transitions.getValue()?xa:Promise.resolve(m)}),function W7e(n,t,e,r){return U3(s=>function U7e(n,t,e,r,s){return new G7e(n,t,e,r,s).apply()}(n,t,e,s.extractedUrl,r).pipe(un(i=>({...s,urlAfterRedirects:i}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),J2(m=>{this.currentNavigation={...this.currentNavigation,finalUrl:m.urlAfterRedirects},s.urlAfterRedirects=m.urlAfterRedirects}),function efe(n,t,e,r,s,i){return Le(o=>function Z7e(n,t,e,r,s,i,o="emptyOnly",c="legacy"){return new Y7e(n,t,e,r,s,o,c,i).recognize().pipe(U3(u=>null===u?function j7e(n){return new gr(t=>t.error(n))}(new q7e):Ut(u)))}(n,t,e,o.urlAfterRedirects,r.serialize(o.urlAfterRedirects),r,s,i).pipe(un(c=>({...o,targetSnapshot:c}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),J2(m=>{if(s.targetSnapshot=m.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!m.extras.skipLocationChange){const T=this.urlHandlingStrategy.merge(m.urlAfterRedirects,m.rawUrl);this.setBrowserUrl(T,m)}this.browserUrlTree=m.urlAfterRedirects}const v=new W5e(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);r.next(v)}));if(h&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:v,extractedUrl:T,source:I,restoredState:z,extras:Z}=c,te=new BN(v,this.serializeUrl(T),I,z);r.next(te);const me=kW(T,this.rootComponentType).snapshot;return Ut(s={...c,targetSnapshot:me,urlAfterRedirects:T,extras:{...Z,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=c.rawUrl,c.resolve(null),xa}),J2(c=>{const u=new q5e(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot);this.triggerEvent(u)}),un(c=>s={...c,guards:m7e(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),function b7e(n,t){return Le(e=>{const{targetSnapshot:r,currentSnapshot:s,guards:{canActivateChecks:i,canDeactivateChecks:o}}=e;return 0===o.length&&0===i.length?Ut({...e,guardsResult:!0}):function N7e(n,t,e,r){return Jr(n).pipe(Le(s=>function k7e(n,t,e,r,s){const i=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return i&&0!==i.length?Ut(i.map(c=>{const u=Y9(t)??s,h=N7(c,u);return H6(function P7e(n){return n&&Q9(n.canDeactivate)}(h)?h.canDeactivate(n,t,e,r):u.runInContext(()=>h(n,t,e,r))).pipe(z6())})).pipe(A7()):Ut(!0)}(s.component,s.route,e,t,r)),z6(s=>!0!==s,!0))}(o,r,s,n).pipe(Le(c=>c&&function y7e(n){return"boolean"==typeof n}(c)?function A7e(n,t,e,r){return Jr(t).pipe(R6(s=>ON(function I7e(n,t){return null!==n&&t&&t(new Q5e(n)),Ut(!0)}(s.route.parent,r),function O7e(n,t){return null!==n&&t&&t(new e7e(n)),Ut(!0)}(s.route,r),function L7e(n,t,e){const r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(o=>function _7e(n){const t=n.routeConfig?n.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:n,guards:t}:null}(o)).filter(o=>null!==o).map(o=>aW(()=>Ut(o.guards.map(u=>{const h=Y9(o.node)??e,g=N7(u,h);return H6(function S7e(n){return n&&Q9(n.canActivateChild)}(g)?g.canActivateChild(r,n):h.runInContext(()=>g(r,n))).pipe(z6())})).pipe(A7())));return Ut(i).pipe(A7())}(n,s.path,e),function x7e(n,t,e){const r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return Ut(!0);const s=r.map(i=>aW(()=>{const o=Y9(t)??e,c=N7(i,o);return H6(function M7e(n){return n&&Q9(n.canActivate)}(c)?c.canActivate(t,n):o.runInContext(()=>c(t,n))).pipe(z6())}));return Ut(s).pipe(A7())}(n,s.route,e))),z6(s=>!0!==s,!0))}(r,i,n,t):Ut(c)),un(c=>({...e,guardsResult:c})))})}(this.ngModule.injector,c=>this.triggerEvent(c)),J2(c=>{if(s.guardsResult=c.guardsResult,Fu(c.guardsResult))throw VW(0,c.guardsResult);const u=new j5e(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.triggerEvent(u)}),K4(c=>!!c.guardsResult||(this.restoreHistory(c),this.cancelNavigationTransition(c,"",3),!1)),tA(c=>{if(c.guards.canActivateChecks.length)return Ut(c).pipe(J2(u=>{const h=new Z5e(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(h)}),U3(u=>{let h=!1;return Ut(u).pipe(function tfe(n,t){return Le(e=>{const{targetSnapshot:r,guards:{canActivateChecks:s}}=e;if(!s.length)return Ut(e);let i=0;return Jr(s).pipe(R6(o=>function nfe(n,t,e,r){const s=n.routeConfig,i=n._resolve;return void 0!==s?.title&&!rq(s)&&(i[B9]=s.title),function rfe(n,t,e,r){const s=function sfe(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===s.length)return Ut({});const i={};return Jr(s).pipe(Le(o=>function ife(n,t,e,r){const s=Y9(t)??r,i=N7(n,s);return H6(i.resolve?i.resolve(t,e):s.runInContext(()=>i(t,e)))}(n[o],t,e,r).pipe(z6(),J2(c=>{i[o]=c}))),xN(1),function m5e(n){return un(()=>n)}(i),V6(o=>QN(o)?xa:H9(o)))}(i,n,t,r).pipe(un(o=>(n._resolvedData=o,n.data=RW(n,e).resolve,s&&rq(s)&&(n.data[B9]=s.title),null)))}(o.route,r,n,t)),J2(()=>i++),xN(1),Le(o=>i===s.length?Ut(e):xa))})}(this.paramsInheritanceStrategy,this.ngModule.injector),J2({next:()=>h=!0,complete:()=>{h||(this.restoreHistory(u),this.cancelNavigationTransition(u,"",2))}}))}),J2(u=>{const h=new Y5e(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(h)}))}),tA(c=>{const u=h=>{const g=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&g.push(this.configLoader.loadComponent(h.routeConfig).pipe(J2(m=>{h.component=m}),un(()=>{})));for(const m of h.children)g.push(...u(m));return g};return iW(u(c.targetSnapshot.root)).pipe(JC(),F9(1))}),tA(()=>this.afterPreactivation()),un(c=>{const u=function i7e(n,t,e){const r=j9(n,t._root,e?e._root:void 0);return new LW(r,t)}(this.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return s={...c,targetRouterState:u}}),J2(c=>{this.currentUrlTree=c.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(c.urlAfterRedirects,c.rawUrl),this.routerState=c.targetRouterState,"deferred"===this.urlUpdateStrategy&&(c.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,c),this.browserUrlTree=c.urlAfterRedirects)}),((n,t,e)=>un(r=>(new g7e(t,r.targetRouterState,r.currentRouterState,e).activate(n),r)))(this.rootContexts,this.routeReuseStrategy,c=>this.triggerEvent(c)),J2({next(){i=!0},complete(){i=!0}}),LN(()=>{i||o||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),V6(c=>{if(o=!0,BW(c)){FW(c)||(this.navigated=!0,this.restoreHistory(s,!0));const u=new oy(s.id,this.serializeUrl(s.extractedUrl),c.message,c.cancellationCode);if(r.next(u),FW(c)){const h=this.urlHandlingStrategy.merge(c.url,this.rawUrlTree),g={skipLocationChange:s.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||cq(s.source)};this.scheduleNavigation(h,"imperative",null,g,{resolve:s.resolve,reject:s.reject,promise:s.promise})}else s.resolve(!1)}else{this.restoreHistory(s,!0);const u=new OW(s.id,this.serializeUrl(s.extractedUrl),c,s.targetSnapshot??void 0);r.next(u);try{s.resolve(this.errorHandler(c))}catch(h){s.reject(h)}}return xa}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}setTransition(e){this.transitions.next({...this.transitions.value,...e})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const r="popstate"===e.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{const s={replaceUrl:!0},i=e.state?.navigationId?e.state:null;if(i){const c={...i};delete c.navigationId,delete c.\u0275routerPageId,0!==Object.keys(c).length&&(s.state=c)}const o=this.parseUrl(e.url);this.scheduleNavigation(o,r,i,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){this.config=e.map(XN),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,r={}){const{relativeTo:s,queryParams:i,fragment:o,queryParamsHandling:c,preserveFragment:u}=r,h=s||this.routerState.root,g=u?this.currentUrlTree.fragment:o;let m=null;switch(c){case"merge":m={...this.currentUrlTree.queryParams,...i};break;case"preserve":m=this.currentUrlTree.queryParams;break;default:m=i||null}return null!==m&&(m=this.removeEmptyProps(m)),H5e(h,this.currentUrlTree,e,m,g??null)}navigateByUrl(e,r={skipLocationChange:!1}){const s=Fu(e)?e:this.parseUrl(e),i=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(i,"imperative",null,r)}navigate(e,r={skipLocationChange:!1}){return function _fe(n){for(let t=0;t<n.length;t++){if(null==n[t])throw new Te(4008,false)}}(e),this.navigateByUrl(this.createUrlTree(e,r),r)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let r;try{r=this.urlSerializer.parse(e)}catch(s){r=this.malformedUriErrorHandler(s,this.urlSerializer,e)}return r}isActive(e,r){let s;if(s=!0===r?{...pfe}:!1===r?{...gfe}:r,Fu(e))return mW(this.currentUrlTree,e,s);const i=this.parseUrl(e);return mW(this.currentUrlTree,i,s)}removeEmptyProps(e){return Object.keys(e).reduce((r,s)=>{const i=e[s];return null!=i&&(r[s]=i),r},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new F6(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),e.resolve(!0)},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}scheduleNavigation(e,r,s,i,o){if(this.disposed)return Promise.resolve(!1);let c,u,h;o?(c=o.resolve,u=o.reject,h=o.promise):h=new Promise((v,T)=>{c=v,u=T});const g=++this.navigationId;let m;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(s=this.location.getState()),m=s&&s.\u0275routerPageId?s.\u0275routerPageId:i.replaceUrl||i.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):m=0,this.setTransition({id:g,targetPageId:m,source:r,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:i,resolve:c,reject:u,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(v=>Promise.reject(v))}setBrowserUrl(e,r){const s=this.urlSerializer.serialize(e),i={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(s)||r.extras.replaceUrl?this.location.replaceState(s,"",i):this.location.go(s,"",i)}restoreHistory(e,r=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===s?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===s&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(s)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,r,s){const i=new oy(e.id,this.serializeUrl(e.extractedUrl),r,s);this.triggerEvent(i),e.resolve(!1)}generateNgRouterState(e,r){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:r}:{navigationId:e}}}return n.\u0275fac=function(e){J5()},n.\u0275prov=Xe({token:n,factory:function(){return aq()},providedIn:"root"}),n})();function cq(n){return"imperative"!==n}let ep=(()=>{class n{constructor(e,r,s,i,o){this.router=e,this.route=r,this.tabIndexAttribute=s,this.renderer=i,this.el=o,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.onChanges=new pi,this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(e){this._preserveFragment=q4(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=q4(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=q4(e)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(e){if(null!=this.tabIndexAttribute)return;const r=this.renderer,s=this.el.nativeElement;null!==e?r.setAttribute(s,"tabindex",e):r.removeAttribute(s,"tabindex")}ngOnChanges(e){this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){return null===this.urlTree||this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(Q($n),Q(Qi),X0("tabindex"),Q(Wi),Q(j2))},n.\u0275dir=Ht({type:n,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,r){1&e&&se("click",function(){return r.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[H2]}),n})(),Bu=(()=>{class n{constructor(e,r,s){this.router=e,this.route=r,this.locationStrategy=s,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.href=null,this.onChanges=new pi,this.subscription=e.events.subscribe(i=>{i instanceof F6&&this.updateTargetUrlAndHref()})}set preserveFragment(e){this._preserveFragment=q4(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=q4(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=q4(e)}get replaceUrl(){return this._replaceUrl}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:null}ngOnChanges(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(e,r,s,i,o){return!!(0!==e||r||s||i||o||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!1)}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(Q($n),Q(Qi),Q(Iu))},n.\u0275dir=Ht({type:n,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,r){1&e&&se("click",function(i){return r.onClick(i.button,i.ctrlKey,i.shiftKey,i.altKey,i.metaKey)}),2&e&&V("target",r.target)("href",r.href,Ic)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[H2]}),n})();class lq{}let yfe=(()=>{class n{constructor(e,r,s,i,o){this.router=e,this.injector=s,this.preloadingStrategy=i,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(K4(e=>e instanceof F6),R6(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,r){const s=[];for(const i of r){i.providers&&!i._injector&&(i._injector=fC(i.providers,e,`Route: ${i.path}`));const o=i._injector??e,c=i._loadedInjector??o;i.loadChildren&&!i._loadedRoutes&&void 0===i.canLoad||i.loadComponent&&!i._loadedComponent?s.push(this.preloadConfig(o,i)):(i.children||i._loadedRoutes)&&s.push(this.processRoutes(c,i.children??i._loadedRoutes))}return Jr(s).pipe(_4())}preloadConfig(e,r){return this.preloadingStrategy.preload(r,()=>{let s;s=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(e,r):Ut(null);const i=s.pipe(Le(o=>null===o?Ut(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??e,o.routes))));return r.loadComponent&&!r._loadedComponent?Jr([i,this.loader.loadComponent(r)]).pipe(_4()):i})}}return n.\u0275fac=function(e){return new(e||n)(xe($n),xe(Sb),xe(na),xe(lq),xe(rA))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const sA=new It("");let uq=(()=>{class n{constructor(e,r,s={}){this.router=e,this.viewportScroller=r,this.options=s,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},s.scrollPositionRestoration=s.scrollPositionRestoration||"disabled",s.anchorScrolling=s.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof BN?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof F6&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof IW&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,r){this.router.triggerEvent(new IW(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(e){J5()},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})();function O7(n,t){return{\u0275kind:n,\u0275providers:t}}function iA(n){return[{provide:nA,multi:!0,useValue:n}]}function hq(){const n=Ir(Xs);return t=>{const e=n.get(M9);if(t!==e.components[0])return;const r=n.get($n),s=n.get(dq);1===n.get(oA)&&r.initialNavigation(),n.get(pq,null,$t.Optional)?.setUpPreloading(),n.get(sA,null,$t.Optional)?.init(),r.resetRootComponentType(e.componentTypes[0]),s.next(),s.complete()}}const dq=new It("",{factory:()=>new pi}),oA=new It("",{providedIn:"root",factory:()=>1});const pq=new It("");function Pfe(n){return O7(0,[{provide:pq,useExisting:yfe},{provide:lq,useExisting:n}])}const gq=new It("ROUTER_FORROOT_GUARD"),Tfe=[Vb,{provide:yW,useClass:RN},{provide:$n,useFactory:aq},Z9,{provide:Qi,useFactory:function fq(n){return n.routerState.root},deps:[$n]},rA];function wfe(){return new T$("Router",$n)}let bfe=(()=>{class n{constructor(e){}static forRoot(e,r){return{ngModule:n,providers:[Tfe,[],iA(e),{provide:gq,useFactory:Ife,deps:[[$n,new Ks,new su]]},{provide:my,useValue:r||{}},r?.useHash?{provide:Iu,useClass:x6e}:{provide:Iu,useClass:K$},{provide:sA,useFactory:()=>{const n=Ir($n),t=Ir(K0e),e=Ir(my);return e.scrollOffset&&t.setOffset(e.scrollOffset),new uq(n,t,e)}},r?.preloadingStrategy?Pfe(r.preloadingStrategy).\u0275providers:[],{provide:T$,multi:!0,useFactory:wfe},r?.initialNavigation?xfe(r):[],[{provide:mq,useFactory:hq},{provide:_$,multi:!0,useExisting:mq}]]}}static forChild(e){return{ngModule:n,providers:[iA(e)]}}}return n.\u0275fac=function(e){return new(e||n)(xe(gq,8))},n.\u0275mod=qs({type:n}),n.\u0275inj=Fr({imports:[YN]}),n})();function Ife(n){return"guarded"}function xfe(n){return["disabled"===n.initialNavigation?O7(3,[{provide:gC,multi:!0,useFactory:()=>{const t=Ir($n);return()=>{t.setUpLocationChangeListener()}}},{provide:oA,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?O7(2,[{provide:oA,useValue:0},{provide:gC,multi:!0,deps:[Xs],useFactory:t=>{const e=t.get(O6e,Promise.resolve());let r=!1;return()=>e.then(()=>new Promise(i=>{const o=t.get($n),c=t.get(dq);(function s(i){t.get($n).events.pipe(K4(c=>c instanceof F6||c instanceof oy||c instanceof OW),un(c=>c instanceof F6||c instanceof oy&&(0===c.code||1===c.code)&&null),K4(c=>null!==c),F9(1)).subscribe(()=>{i()})})(()=>{i(!0),r=!0}),o.afterPreactivation=()=>(i(!0),r||c.closed?Ut(void 0):c),o.initialNavigation()}))}}]).\u0275providers:[]]}const mq=new It("");class _q{}const el="*";function vq(n,t=null){return{type:2,steps:n,options:t}}function Cq(n){return{type:6,styles:n,offset:null}}function yq(n){Promise.resolve().then(n)}class tp{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){yq(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class Eq{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,r=0,s=0;const i=this.players.length;0==i?yq(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++e==i&&this._onFinish()}),o.onDestroy(()=>{++r==i&&this._onDestroy()}),o.onStart(()=>{++s==i&&this._onStart()})}),this.totalTime=this.players.reduce((o,c)=>Math.max(o,c.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(r=>{const s=r.totalTime?Math.min(1,e/r.totalTime):1;r.setPosition(s)})}getPosition(){const t=this.players.reduce((e,r)=>null===e||r.totalTime>e.totalTime?r:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}function Mq(n){return new Te(3e3,!1)}function ghe(){return typeof window<"u"&&typeof window.document<"u"}function cA(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function B6(n){switch(n.length){case 0:return new tp;case 1:return n[0];default:return new Eq(n)}}function Sq(n,t,e,r,s=new Map,i=new Map){const o=[],c=[];let u=-1,h=null;if(r.forEach(g=>{const m=g.get("offset"),v=m==u,T=v&&h||new Map;g.forEach((I,z)=>{let Z=z,te=I;if("offset"!==z)switch(Z=t.normalizePropertyName(Z,o),te){case"!":te=s.get(z);break;case el:te=i.get(z);break;default:te=t.normalizeStyleValue(z,Z,te,o)}T.set(Z,te)}),v||c.push(T),h=T,u=m}),o.length)throw function rhe(n){return new Te(3502,!1)}();return c}function lA(n,t,e,r){switch(t){case"start":n.onStart(()=>r(e&&uA(e,"start",n)));break;case"done":n.onDone(()=>r(e&&uA(e,"done",n)));break;case"destroy":n.onDestroy(()=>r(e&&uA(e,"destroy",n)))}}function uA(n,t,e){const i=fA(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,e.totalTime??n.totalTime,!!e.disabled),o=n._data;return null!=o&&(i._data=o),i}function fA(n,t,e,r,s="",i=0,o){return{element:n,triggerName:t,fromState:e,toState:r,phaseName:s,totalTime:i,disabled:!!o}}function fa(n,t,e){let r=n.get(t);return r||n.set(t,r=e),r}function Pq(n){const t=n.indexOf(":");return[n.substring(1,t),n.slice(t+1)]}let hA=(n,t)=>!1,Tq=(n,t,e)=>[],wq=null;function dA(n){const t=n.parentNode||n.host;return t===wq?null:t}(cA()||typeof Element<"u")&&(ghe()?(wq=(()=>document.documentElement)(),hA=(n,t)=>{for(;t;){if(t===n)return!0;t=dA(t)}return!1}):hA=(n,t)=>n.contains(t),Tq=(n,t,e)=>{if(e)return Array.from(n.querySelectorAll(t));const r=n.querySelector(t);return r?[r]:[]});let $u=null,bq=!1;const Nq=hA,Aq=Tq;let Oq=(()=>{class n{validateStyleProperty(e){return function _he(n){$u||($u=function vhe(){return typeof document<"u"?document.body:null}()||{},bq=!!$u.style&&"WebkitAppearance"in $u.style);let t=!0;return $u.style&&!function mhe(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in $u.style,!t&&bq&&(t="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in $u.style)),t}(e)}matchesElement(e,r){return!1}containsElement(e,r){return Nq(e,r)}getParentElement(e){return dA(e)}query(e,r,s){return Aq(e,r,s)}computeStyle(e,r,s){return s||""}animate(e,r,s,i,o,c=[],u){return new tp(s,i)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})(),pA=(()=>{class n{}return n.NOOP=new Oq,n})();const gA="ng-enter",yy="ng-leave",Ey="ng-trigger",My=".ng-trigger",xq="ng-animating",mA=".ng-animating";function tl(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:_A(parseFloat(t[1]),t[2])}function _A(n,t){return"s"===t?1e3*n:n}function Sy(n,t,e){return n.hasOwnProperty("duration")?n:function Ehe(n,t,e){let s,i=0,o="";if("string"==typeof n){const c=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===c)return t.push(Mq()),{duration:0,delay:0,easing:""};s=_A(parseFloat(c[1]),c[2]);const u=c[3];null!=u&&(i=_A(parseFloat(u),c[4]));const h=c[5];h&&(o=h)}else s=n;if(!e){let c=!1,u=t.length;s<0&&(t.push(function Rfe(){return new Te(3100,!1)}()),c=!0),i<0&&(t.push(function Dfe(){return new Te(3101,!1)}()),c=!0),c&&t.splice(u,0,Mq())}return{duration:s,delay:i,easing:o}}(n,t,e)}function np(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function Lq(n){const t=new Map;return Object.keys(n).forEach(e=>{t.set(e,n[e])}),t}function $6(n,t=new Map,e){if(e)for(let[r,s]of e)t.set(r,s);for(let[r,s]of n)t.set(r,s);return t}function Rq(n,t,e){return e?t+":"+e+";":""}function Dq(n){let t="";for(let e=0;e<n.style.length;e++){const r=n.style.item(e);t+=Rq(0,r,n.style.getPropertyValue(r))}for(const e in n.style)n.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=Rq(0,The(e),n.style[e]));n.setAttribute("style",t)}function W3(n,t,e){n.style&&(t.forEach((r,s)=>{const i=CA(s);e&&!e.has(s)&&e.set(s,n.style[i]),n.style[i]=r}),cA()&&Dq(n))}function Uu(n,t){n.style&&(t.forEach((e,r)=>{const s=CA(r);n.style[s]=""}),cA()&&Dq(n))}function rp(n){return Array.isArray(n)?1==n.length?n[0]:vq(n):n}const vA=new RegExp("{{\\s*(.+?)\\s*}}","g");function zq(n){let t=[];if("string"==typeof n){let e;for(;e=vA.exec(n);)t.push(e[1]);vA.lastIndex=0}return t}function sp(n,t,e){const r=n.toString(),s=r.replace(vA,(i,o)=>{let c=t[o];return null==c&&(e.push(function Vfe(n){return new Te(3003,!1)}()),c=""),c.toString()});return s==r?n:s}function Py(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const Phe=/-+([a-z0-9])/g;function CA(n){return n.replace(Phe,(...t)=>t[1].toUpperCase())}function The(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function ha(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function Hfe(n){return new Te(3004,!1)}()}}function Vq(n,t){return window.getComputedStyle(n)[t]}function Ihe(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(r=>function xhe(n,t,e){if(":"==n[0]){const u=function Lhe(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,r)=>parseFloat(r)>parseFloat(e);case":decrement":return(e,r)=>parseFloat(r)<parseFloat(e);default:return t.push(function Jfe(n){return new Te(3016,!1)}()),"* => *"}}(n,e);if("function"==typeof u)return void t.push(u);n=u}const r=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return e.push(function Qfe(n){return new Te(3015,!1)}()),t;const s=r[1],i=r[2],o=r[3];t.push(Hq(s,o));"<"==i[0]&&!("*"==s&&"*"==o)&&t.push(Hq(o,s))}(r,e,t)):e.push(n),e}const Ny=new Set(["true","1"]),Ay=new Set(["false","0"]);function Hq(n,t){const e=Ny.has(n)||Ay.has(n),r=Ny.has(t)||Ay.has(t);return(s,i)=>{let o="*"==n||n==s,c="*"==t||t==i;return!o&&e&&"boolean"==typeof s&&(o=s?Ny.has(n):Ay.has(n)),!c&&r&&"boolean"==typeof i&&(c=i?Ny.has(t):Ay.has(t)),o&&c}}const khe=new RegExp("s*:selfs*,?","g");function yA(n,t,e,r){return new Rhe(n).build(t,e,r)}class Rhe{constructor(t){this._driver=t}build(t,e,r){const s=new Vhe(e);return this._resetContextStyleTimingState(s),ha(this,rp(t),s)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let r=e.queryCount=0,s=e.depCount=0;const i=[],o=[];return"@"==t.name.charAt(0)&&e.errors.push(function Bfe(){return new Te(3006,!1)}()),t.definitions.forEach(c=>{if(this._resetContextStyleTimingState(e),0==c.type){const u=c,h=u.name;h.toString().split(/\s*,\s*/).forEach(g=>{u.name=g,i.push(this.visitState(u,e))}),u.name=h}else if(1==c.type){const u=this.visitTransition(c,e);r+=u.queryCount,s+=u.depCount,o.push(u)}else e.errors.push(function $fe(){return new Te(3007,!1)}())}),{type:7,name:t.name,states:i,transitions:o,queryCount:r,depCount:s,options:null}}visitState(t,e){const r=this.visitStyle(t.styles,e),s=t.options&&t.options.params||null;if(r.containsDynamicStyles){const i=new Set,o=s||{};r.styles.forEach(c=>{c instanceof Map&&c.forEach(u=>{zq(u).forEach(h=>{o.hasOwnProperty(h)||i.add(h)})})}),i.size&&(Py(i.values()),e.errors.push(function Ufe(n,t){return new Te(3008,!1)}()))}return{type:0,name:t.name,style:r,options:s?{params:s}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const r=ha(this,rp(t.animation),e);return{type:1,matchers:Ihe(t.expr,e.errors),animation:r,queryCount:e.queryCount,depCount:e.depCount,options:Gu(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(r=>ha(this,r,e)),options:Gu(t.options)}}visitGroup(t,e){const r=e.currentTime;let s=0;const i=t.steps.map(o=>{e.currentTime=r;const c=ha(this,o,e);return s=Math.max(s,e.currentTime),c});return e.currentTime=s,{type:3,steps:i,options:Gu(t.options)}}visitAnimate(t,e){const r=function Fhe(n,t){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return EA(Sy(n,t).duration,0,"");const e=n;if(e.split(/\s+/).some(i=>"{"==i.charAt(0)&&"{"==i.charAt(1))){const i=EA(0,0,"");return i.dynamic=!0,i.strValue=e,i}const s=Sy(e,t);return EA(s.duration,s.delay,s.easing)}(t.timings,e.errors);e.currentAnimateTimings=r;let s,i=t.styles?t.styles:Cq({});if(5==i.type)s=this.visitKeyframes(i,e);else{let o=t.styles,c=!1;if(!o){c=!0;const h={};r.easing&&(h.easing=r.easing),o=Cq(h)}e.currentTime+=r.duration+r.delay;const u=this.visitStyle(o,e);u.isEmptyStep=c,s=u}return e.currentAnimateTimings=null,{type:4,timings:r,style:s,options:null}}visitStyle(t,e){const r=this._makeStyleAst(t,e);return this._validateStyleAst(r,e),r}_makeStyleAst(t,e){const r=[],s=Array.isArray(t.styles)?t.styles:[t.styles];for(let c of s)"string"==typeof c?c===el?r.push(c):e.errors.push(new Te(3002,!1)):r.push(Lq(c));let i=!1,o=null;return r.forEach(c=>{if(c instanceof Map&&(c.has("easing")&&(o=c.get("easing"),c.delete("easing")),!i))for(let u of c.values())if(u.toString().indexOf("{{")>=0){i=!0;break}}),{type:6,styles:r,easing:o,offset:t.offset,containsDynamicStyles:i,options:null}}_validateStyleAst(t,e){const r=e.currentAnimateTimings;let s=e.currentTime,i=e.currentTime;r&&i>0&&(i-=r.duration+r.delay),t.styles.forEach(o=>{"string"!=typeof o&&o.forEach((c,u)=>{const h=e.collectedStyles.get(e.currentQuerySelector),g=h.get(u);let m=!0;g&&(i!=s&&i>=g.startTime&&s<=g.endTime&&(e.errors.push(function Wfe(n,t,e,r,s){return new Te(3010,!1)}()),m=!1),i=g.startTime),m&&h.set(u,{startTime:i,endTime:s}),e.options&&function She(n,t,e){const r=t.params||{},s=zq(n);s.length&&s.forEach(i=>{r.hasOwnProperty(i)||e.push(function zfe(n){return new Te(3001,!1)}())})}(c,e.options,e.errors)})})}visitKeyframes(t,e){const r={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function qfe(){return new Te(3011,!1)}()),r;let i=0;const o=[];let c=!1,u=!1,h=0;const g=t.steps.map(te=>{const me=this._makeStyleAst(te,e);let J=null!=me.offset?me.offset:function Hhe(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(e instanceof Map&&e.has("offset")){const r=e;t=parseFloat(r.get("offset")),r.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const e=n;t=parseFloat(e.get("offset")),e.delete("offset")}return t}(me.styles),Ne=0;return null!=J&&(i++,Ne=me.offset=J),u=u||Ne<0||Ne>1,c=c||Ne<h,h=Ne,o.push(Ne),me});u&&e.errors.push(function jfe(){return new Te(3012,!1)}()),c&&e.errors.push(function Zfe(){return new Te(3200,!1)}());const m=t.steps.length;let v=0;i>0&&i<m?e.errors.push(function Yfe(){return new Te(3202,!1)}()):0==i&&(v=1/(m-1));const T=m-1,I=e.currentTime,z=e.currentAnimateTimings,Z=z.duration;return g.forEach((te,me)=>{const J=v>0?me==T?1:v*me:o[me],Ne=J*Z;e.currentTime=I+z.delay+Ne,z.duration=Ne,this._validateStyleAst(te,e),te.offset=J,r.styles.push(te)}),r}visitReference(t,e){return{type:8,animation:ha(this,rp(t.animation),e),options:Gu(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:Gu(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:Gu(t.options)}}visitQuery(t,e){const r=e.currentQuerySelector,s=t.options||{};e.queryCount++,e.currentQuery=t;const[i,o]=function Dhe(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(khe,"")),n=n.replace(/@\*/g,My).replace(/@\w+/g,e=>My+"-"+e.slice(1)).replace(/:animating/g,mA),[n,t]}(t.selector);e.currentQuerySelector=r.length?r+" "+i:i,fa(e.collectedStyles,e.currentQuerySelector,new Map);const c=ha(this,rp(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=r,{type:11,selector:i,limit:s.limit||0,optional:!!s.optional,includeSelf:o,animation:c,originalSelector:t.selector,options:Gu(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function Kfe(){return new Te(3013,!1)}());const r="full"===t.timings?{duration:0,delay:0,easing:"full"}:Sy(t.timings,e.errors,!0);return{type:12,animation:ha(this,rp(t.animation),e),timings:r,options:null}}}class Vhe{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Gu(n){return n?(n=np(n)).params&&(n.params=function zhe(n){return n?np(n):null}(n.params)):n={},n}function EA(n,t,e){return{duration:n,delay:t,easing:e}}function MA(n,t,e,r,s,i,o=null,c=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:r,duration:s,delay:i,totalTime:s+i,easing:o,subTimeline:c}}class Oy{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let r=this._map.get(t);r||this._map.set(t,r=[]),r.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const Uhe=new RegExp(":enter","g"),Whe=new RegExp(":leave","g");function SA(n,t,e,r,s,i=new Map,o=new Map,c,u,h=[]){return(new qhe).buildKeyframes(n,t,e,r,s,i,o,c,u,h)}class qhe{buildKeyframes(t,e,r,s,i,o,c,u,h,g=[]){h=h||new Oy;const m=new PA(t,e,h,s,i,g,[]);m.options=u;const v=u.delay?tl(u.delay):0;m.currentTimeline.delayNextStep(v),m.currentTimeline.setStyles([o],null,m.errors,u),ha(this,r,m);const T=m.timelines.filter(I=>I.containsAnimation());if(T.length&&c.size){let I;for(let z=T.length-1;z>=0;z--){const Z=T[z];if(Z.element===e){I=Z;break}}I&&!I.allowOnlyTimelineStyles()&&I.setStyles([c],null,m.errors,u)}return T.length?T.map(I=>I.buildKeyframes()):[MA(e,[],[],[],0,v,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const r=e.subInstructions.get(e.element);if(r){const s=e.createSubContext(t.options),i=e.currentTimeline.currentTime,o=this._visitSubInstructions(r,s,s.options);i!=o&&e.transformIntoNewTimeline(o)}e.previousNode=t}visitAnimateRef(t,e){const r=e.createSubContext(t.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,r),this.visitReference(t.animation,r),e.transformIntoNewTimeline(r.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,r){for(const s of t){const i=s?.delay;if(i){const o="number"==typeof i?i:tl(sp(i,s?.params??{},e.errors));r.delayNextStep(o)}}}_visitSubInstructions(t,e,r){let i=e.currentTimeline.currentTime;const o=null!=r.duration?tl(r.duration):null,c=null!=r.delay?tl(r.delay):null;return 0!==o&&t.forEach(u=>{const h=e.appendInstructionToTimeline(u,o,c);i=Math.max(i,h.duration+h.delay)}),i}visitReference(t,e){e.updateOptions(t.options,!0),ha(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const r=e.subContextCount;let s=e;const i=t.options;if(i&&(i.params||i.delay)&&(s=e.createSubContext(i),s.transformIntoNewTimeline(),null!=i.delay)){6==s.previousNode.type&&(s.currentTimeline.snapshotCurrentStyles(),s.previousNode=Iy);const o=tl(i.delay);s.delayNextStep(o)}t.steps.length&&(t.steps.forEach(o=>ha(this,o,s)),s.currentTimeline.applyStylesToKeyframe(),s.subContextCount>r&&s.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const r=[];let s=e.currentTimeline.currentTime;const i=t.options&&t.options.delay?tl(t.options.delay):0;t.steps.forEach(o=>{const c=e.createSubContext(t.options);i&&c.delayNextStep(i),ha(this,o,c),s=Math.max(s,c.currentTimeline.currentTime),r.push(c.currentTimeline)}),r.forEach(o=>e.currentTimeline.mergeTimelineCollectedStyles(o)),e.transformIntoNewTimeline(s),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const r=t.strValue;return Sy(e.params?sp(r,e.params,e.errors):r,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const r=e.currentAnimateTimings=this._visitTiming(t.timings,e),s=e.currentTimeline;r.delay&&(e.incrementTime(r.delay),s.snapshotCurrentStyles());const i=t.style;5==i.type?this.visitKeyframes(i,e):(e.incrementTime(r.duration),this.visitStyle(i,e),s.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const r=e.currentTimeline,s=e.currentAnimateTimings;!s&&r.hasCurrentStyleProperties()&&r.forwardFrame();const i=s&&s.easing||t.easing;t.isEmptyStep?r.applyEmptyStep(i):r.setStyles(t.styles,i,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const r=e.currentAnimateTimings,s=e.currentTimeline.duration,i=r.duration,c=e.createSubContext().currentTimeline;c.easing=r.easing,t.styles.forEach(u=>{c.forwardTime((u.offset||0)*i),c.setStyles(u.styles,u.easing,e.errors,e.options),c.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(c),e.transformIntoNewTimeline(s+i),e.previousNode=t}visitQuery(t,e){const r=e.currentTimeline.currentTime,s=t.options||{},i=s.delay?tl(s.delay):0;i&&(6===e.previousNode.type||0==r&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Iy);let o=r;const c=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!s.optional,e.errors);e.currentQueryTotal=c.length;let u=null;c.forEach((h,g)=>{e.currentQueryIndex=g;const m=e.createSubContext(t.options,h);i&&m.delayNextStep(i),h===e.element&&(u=m.currentTimeline),ha(this,t.animation,m),m.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,m.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(o),u&&(e.currentTimeline.mergeTimelineCollectedStyles(u),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const r=e.parentContext,s=e.currentTimeline,i=t.timings,o=Math.abs(i.duration),c=o*(e.currentQueryTotal-1);let u=o*e.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":u=c-u;break;case"full":u=r.currentStaggerTime}const g=e.currentTimeline;u&&g.delayNextStep(u);const m=g.currentTime;ha(this,t.animation,e),e.previousNode=t,r.currentStaggerTime=s.currentTime-m+(s.startTime-r.currentTimeline.startTime)}}const Iy={};class PA{constructor(t,e,r,s,i,o,c,u){this._driver=t,this.element=e,this.subInstructions=r,this._enterClassName=s,this._leaveClassName=i,this.errors=o,this.timelines=c,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Iy,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new xy(this._driver,e,0),c.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const r=t;let s=this.options;null!=r.duration&&(s.duration=tl(r.duration)),null!=r.delay&&(s.delay=tl(r.delay));const i=r.params;if(i){let o=s.params;o||(o=this.options.params={}),Object.keys(i).forEach(c=>{(!e||!o.hasOwnProperty(c))&&(o[c]=sp(i[c],o,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const r=t.params={};Object.keys(e).forEach(s=>{r[s]=e[s]})}}return t}createSubContext(t=null,e,r){const s=e||this.element,i=new PA(this._driver,s,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(s,r||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(t),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(t){return this.previousNode=Iy,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,r){const s={duration:e??t.duration,delay:this.currentTimeline.currentTime+(r??0)+t.delay,easing:""},i=new jhe(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,s,t.stretchStartingKeyframe);return this.timelines.push(i),s}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,r,s,i,o){let c=[];if(s&&c.push(this.element),t.length>0){t=(t=t.replace(Uhe,"."+this._enterClassName)).replace(Whe,"."+this._leaveClassName);let h=this._driver.query(this.element,t,1!=r);0!==r&&(h=r<0?h.slice(h.length+r,h.length):h.slice(0,r)),c.push(...h)}return!i&&0==c.length&&o.push(function Xfe(n){return new Te(3014,!1)}()),c}}class xy{constructor(t,e,r,s){this._driver=t,this.element=e,this.startTime=r,this._elementTimelineStylesLookup=s,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new xy(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,r]of this._globalTimelineStyles)this._backFill.set(e,r||el),this._currentKeyframe.set(e,el);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,r,s){e&&this._previousKeyframe.set("easing",e);const i=s&&s.params||{},o=function Zhe(n,t){const e=new Map;let r;return n.forEach(s=>{if("*"===s){r=r||t.keys();for(let i of r)e.set(i,el)}else $6(s,e)}),e}(t,this._globalTimelineStyles);for(let[c,u]of o){const h=sp(u,i,r);this._pendingStyles.set(c,h),this._localTimelineStyles.has(c)||this._backFill.set(c,this._globalTimelineStyles.get(c)??el),this._updateStyle(c,h)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,r)=>{const s=this._styleSummary.get(r);(!s||e.time>s.time)&&this._updateStyle(r,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,r=1===this._keyframes.size&&0===this.duration;let s=[];this._keyframes.forEach((c,u)=>{const h=$6(c,new Map,this._backFill);h.forEach((g,m)=>{"!"===g?t.add(m):g===el&&e.add(m)}),r||h.set("offset",u/this.duration),s.push(h)});const i=t.size?Py(t.values()):[],o=e.size?Py(e.values()):[];if(r){const c=s[0],u=new Map(c);c.set("offset",0),u.set("offset",1),s=[c,u]}return MA(this.element,s,i,o,this.duration,this.startTime,this.easing,!1)}}class jhe extends xy{constructor(t,e,r,s,i,o,c=!1){super(t,e,o.delay),this.keyframes=r,this.preStyleProps=s,this.postStyleProps=i,this._stretchStartingKeyframe=c,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:r,easing:s}=this.timings;if(this._stretchStartingKeyframe&&e){const i=[],o=r+e,c=e/o,u=$6(t[0]);u.set("offset",0),i.push(u);const h=$6(t[0]);h.set("offset",$q(c)),i.push(h);const g=t.length-1;for(let m=1;m<=g;m++){let v=$6(t[m]);const T=v.get("offset");v.set("offset",$q((e+T*r)/o)),i.push(v)}r=o,e=0,s="",t=i}return MA(this.element,t,this.preStyleProps,this.postStyleProps,r,e,s,!0)}}function $q(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class TA{}const Yhe=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class Khe extends TA{normalizePropertyName(t,e){return CA(t)}normalizeStyleValue(t,e,r,s){let i="";const o=r.toString().trim();if(Yhe.has(e)&&0!==r&&"0"!==r)if("number"==typeof r)i="px";else{const c=r.match(/^[+-]?[\d\.]+([a-z]*)$/);c&&0==c[1].length&&s.push(function Ffe(n,t){return new Te(3005,!1)}())}return o+i}}function Uq(n,t,e,r,s,i,o,c,u,h,g,m,v){return{type:0,element:n,triggerName:t,isRemovalTransition:s,fromState:e,fromStyles:i,toState:r,toStyles:o,timelines:c,queriedElements:u,preStyleProps:h,postStyleProps:g,totalTime:m,errors:v}}const wA={};class Gq{constructor(t,e,r){this._triggerName=t,this.ast=e,this._stateStyles=r}match(t,e,r,s){return function Xhe(n,t,e,r,s){return n.some(i=>i(t,e,r,s))}(this.ast.matchers,t,e,r,s)}buildStyles(t,e,r){let s=this._stateStyles.get("*");return void 0!==t&&(s=this._stateStyles.get(t?.toString())||s),s?s.buildStyles(e,r):new Map}build(t,e,r,s,i,o,c,u,h,g){const m=[],v=this.ast.options&&this.ast.options.params||wA,I=this.buildStyles(r,c&&c.params||wA,m),z=u&&u.params||wA,Z=this.buildStyles(s,z,m),te=new Set,me=new Map,J=new Map,Ne="void"===s,He={params:Qhe(z,v),delay:this.ast.options?.delay},qe=g?[]:SA(t,e,this.ast.animation,i,o,I,Z,He,h,m);let Dt=0;if(qe.forEach(M1=>{Dt=Math.max(M1.duration+M1.delay,Dt)}),m.length)return Uq(e,this._triggerName,r,s,Ne,I,Z,[],[],me,J,Dt,m);qe.forEach(M1=>{const Yr=M1.element,dc=fa(me,Yr,new Set);M1.preStyleProps.forEach(di=>dc.add(di));const go=fa(J,Yr,new Set);M1.postStyleProps.forEach(di=>go.add(di)),Yr!==e&&te.add(Yr)});const A1=Py(te.values());return Uq(e,this._triggerName,r,s,Ne,I,Z,qe,A1,me,J,Dt)}}function Qhe(n,t){const e=np(t);for(const r in n)n.hasOwnProperty(r)&&null!=n[r]&&(e[r]=n[r]);return e}class Jhe{constructor(t,e,r){this.styles=t,this.defaultParams=e,this.normalizer=r}buildStyles(t,e){const r=new Map,s=np(this.defaultParams);return Object.keys(t).forEach(i=>{const o=t[i];null!==o&&(s[i]=o)}),this.styles.styles.forEach(i=>{"string"!=typeof i&&i.forEach((o,c)=>{o&&(o=sp(o,s,e));const u=this.normalizer.normalizePropertyName(c,e);o=this.normalizer.normalizeStyleValue(c,u,o,e),r.set(u,o)})}),r}}class tde{constructor(t,e,r){this.name=t,this.ast=e,this._normalizer=r,this.transitionFactories=[],this.states=new Map,e.states.forEach(s=>{this.states.set(s.name,new Jhe(s.style,s.options&&s.options.params||{},r))}),Wq(this.states,"true","1"),Wq(this.states,"false","0"),e.transitions.forEach(s=>{this.transitionFactories.push(new Gq(t,s,this.states))}),this.fallbackTransition=function nde(n,t,e){return new Gq(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,c)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,r,s){return this.transitionFactories.find(o=>o.match(t,e,r,s))||null}matchStyles(t,e,r){return this.fallbackTransition.buildStyles(t,e,r)}}function Wq(n,t,e){n.has(t)?n.has(e)||n.set(e,n.get(t)):n.has(e)&&n.set(t,n.get(e))}const rde=new Oy;class sde{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const r=[],i=yA(this._driver,e,r,[]);if(r.length)throw function she(n){return new Te(3503,!1)}();this._animations.set(t,i)}_buildPlayer(t,e,r){const s=t.element,i=Sq(0,this._normalizer,0,t.keyframes,e,r);return this._driver.animate(s,i,t.duration,t.delay,t.easing,[],!0)}create(t,e,r={}){const s=[],i=this._animations.get(t);let o;const c=new Map;if(i?(o=SA(this._driver,e,i,gA,yy,new Map,new Map,r,rde,s),o.forEach(g=>{const m=fa(c,g.element,new Map);g.postStyleProps.forEach(v=>m.set(v,null))})):(s.push(function ihe(){return new Te(3300,!1)}()),o=[]),s.length)throw function ohe(n){return new Te(3504,!1)}();c.forEach((g,m)=>{g.forEach((v,T)=>{g.set(T,this._driver.computeStyle(m,T,el))})});const h=B6(o.map(g=>{const m=c.get(g.element);return this._buildPlayer(g,new Map,m)}));return this._playersById.set(t,h),h.onDestroy(()=>this.destroy(t)),this.players.push(h),h}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const r=this.players.indexOf(e);r>=0&&this.players.splice(r,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function ahe(n){return new Te(3301,!1)}();return e}listen(t,e,r,s){const i=fA(e,"","","");return lA(this._getPlayer(t),r,i,s),()=>{}}command(t,e,r,s){if("register"==r)return void this.register(t,s[0]);if("create"==r)return void this.create(t,e,s[0]||{});const i=this._getPlayer(t);switch(r){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(s[0]));break;case"destroy":this.destroy(t)}}}const qq="ng-animate-queued",bA="ng-animate-disabled",lde=[],jq={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},ude={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Ka="__ng_removed";class NA{constructor(t,e=""){this.namespaceId=e;const r=t&&t.hasOwnProperty("value");if(this.value=function pde(n){return n??null}(r?t.value:t),r){const i=np(t);delete i.value,this.options=i}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const r=this.options.params;Object.keys(e).forEach(s=>{null==r[s]&&(r[s]=e[s])})}}}const ip="void",AA=new NA(ip);class fde{constructor(t,e,r){this.id=t,this.hostElement=e,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Xa(e,this._hostClassName)}listen(t,e,r,s){if(!this._triggers.has(e))throw function che(n,t){return new Te(3302,!1)}();if(null==r||0==r.length)throw function lhe(n){return new Te(3303,!1)}();if(!function gde(n){return"start"==n||"done"==n}(r))throw function uhe(n,t){return new Te(3400,!1)}();const i=fa(this._elementListeners,t,[]),o={name:e,phase:r,callback:s};i.push(o);const c=fa(this._engine.statesByElement,t,new Map);return c.has(e)||(Xa(t,Ey),Xa(t,Ey+"-"+e),c.set(e,AA)),()=>{this._engine.afterFlush(()=>{const u=i.indexOf(o);u>=0&&i.splice(u,1),this._triggers.has(e)||c.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function fhe(n){return new Te(3401,!1)}();return e}trigger(t,e,r,s=!0){const i=this._getTrigger(e),o=new OA(this.id,e,t);let c=this._engine.statesByElement.get(t);c||(Xa(t,Ey),Xa(t,Ey+"-"+e),this._engine.statesByElement.set(t,c=new Map));let u=c.get(e);const h=new NA(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&u&&h.absorbOptions(u.options),c.set(e,h),u||(u=AA),h.value!==ip&&u.value===h.value){if(!function vde(n,t){const e=Object.keys(n),r=Object.keys(t);if(e.length!=r.length)return!1;for(let s=0;s<e.length;s++){const i=e[s];if(!t.hasOwnProperty(i)||n[i]!==t[i])return!1}return!0}(u.params,h.params)){const z=[],Z=i.matchStyles(u.value,u.params,z),te=i.matchStyles(h.value,h.params,z);z.length?this._engine.reportError(z):this._engine.afterFlush(()=>{Uu(t,Z),W3(t,te)})}return}const v=fa(this._engine.playersByElement,t,[]);v.forEach(z=>{z.namespaceId==this.id&&z.triggerName==e&&z.queued&&z.destroy()});let T=i.matchTransition(u.value,h.value,t,h.params),I=!1;if(!T){if(!s)return;T=i.fallbackTransition,I=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:T,fromState:u,toState:h,player:o,isFallbackTransition:I}),I||(Xa(t,qq),o.onStart(()=>{I7(t,qq)})),o.onDone(()=>{let z=this.players.indexOf(o);z>=0&&this.players.splice(z,1);const Z=this._engine.playersByElement.get(t);if(Z){let te=Z.indexOf(o);te>=0&&Z.splice(te,1)}}),this.players.push(o),v.push(o),o}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,r)=>{this._elementListeners.set(r,e.filter(s=>s.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(r=>r.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const r=this._engine.driver.query(t,My,!0);r.forEach(s=>{if(s[Ka])return;const i=this._engine.fetchNamespacesByElement(s);i.size?i.forEach(o=>o.triggerLeaveAnimation(s,e,!1,!0)):this.clearElementCache(s)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(s=>this.clearElementCache(s)))}triggerLeaveAnimation(t,e,r,s){const i=this._engine.statesByElement.get(t),o=new Map;if(i){const c=[];if(i.forEach((u,h)=>{if(o.set(h,u.value),this._triggers.has(h)){const g=this.trigger(t,h,ip,s);g&&c.push(g)}}),c.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,o),r&&B6(c).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),r=this._engine.statesByElement.get(t);if(e&&r){const s=new Set;e.forEach(i=>{const o=i.name;if(s.has(o))return;s.add(o);const u=this._triggers.get(o).fallbackTransition,h=r.get(o)||AA,g=new NA(ip),m=new OA(this.id,o,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:o,transition:u,fromState:h,toState:g,player:m,isFallbackTransition:!0})})}}removeNode(t,e){const r=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let s=!1;if(r.totalAnimations){const i=r.players.length?r.playersByQueriedElement.get(t):[];if(i&&i.length)s=!0;else{let o=t;for(;o=o.parentNode;)if(r.statesByElement.get(o)){s=!0;break}}}if(this.prepareLeaveAnimationListeners(t),s)r.markElementAsRemoved(this.id,t,!1,e);else{const i=t[Ka];(!i||i===jq)&&(r.afterFlush(()=>this.clearElementCache(t)),r.destroyInnerAnimations(t),r._onRemovalComplete(t,e))}}insertNode(t,e){Xa(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(r=>{const s=r.player;if(s.destroyed)return;const i=r.element,o=this._elementListeners.get(i);o&&o.forEach(c=>{if(c.name==r.triggerName){const u=fA(i,r.triggerName,r.fromState.value,r.toState.value);u._data=t,lA(r.player,c.phase,u,c.callback)}}),s.markedForDestroy?this._engine.afterFlush(()=>{s.destroy()}):e.push(r)}),this._queue=[],e.sort((r,s)=>{const i=r.transition.ast.depCount,o=s.transition.ast.depCount;return 0==i||0==o?i-o:this._engine.driver.containsElement(r.element,s.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(r=>r.element===t)||e,e}}class hde{constructor(t,e,r){this.bodyNode=t,this.driver=e,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,i)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(r=>{r.queued&&t.push(r)})}),t}createNamespace(t,e){const r=new fde(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(r,e):(this.newHostElements.set(e,r),this.collectEnterElement(e)),this._namespaceLookup[t]=r}_balanceNamespaceList(t,e){const r=this._namespaceList,s=this.namespacesByHostElement;if(r.length-1>=0){let o=!1,c=this.driver.getParentElement(e);for(;c;){const u=s.get(c);if(u){const h=r.indexOf(u);r.splice(h+1,0,t),o=!0;break}c=this.driver.getParentElement(c)}o||r.unshift(t)}else r.push(t);return s.set(e,t),t}register(t,e){let r=this._namespaceLookup[t];return r||(r=this.createNamespace(t,e)),r}registerTrigger(t,e,r){let s=this._namespaceLookup[t];s&&s.register(e,r)&&this.totalAnimations++}destroy(t,e){if(!t)return;const r=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(r.hostElement),delete this._namespaceLookup[t];const s=this._namespaceList.indexOf(r);s>=0&&this._namespaceList.splice(s,1)}),this.afterFlushAnimationsDone(()=>r.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,r=this.statesByElement.get(t);if(r)for(let s of r.values())if(s.namespaceId){const i=this._fetchNamespace(s.namespaceId);i&&e.add(i)}return e}trigger(t,e,r,s){if(Ly(e)){const i=this._fetchNamespace(t);if(i)return i.trigger(e,r,s),!0}return!1}insertNode(t,e,r,s){if(!Ly(e))return;const i=e[Ka];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;const o=this.collectedLeaveElements.indexOf(e);o>=0&&this.collectedLeaveElements.splice(o,1)}if(t){const o=this._fetchNamespace(t);o&&o.insertNode(e,r)}s&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Xa(t,bA)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),I7(t,bA))}removeNode(t,e,r,s){if(Ly(e)){const i=t?this._fetchNamespace(t):null;if(i?i.removeNode(e,s):this.markElementAsRemoved(t,e,!1,s),r){const o=this.namespacesByHostElement.get(e);o&&o.id!==t&&o.removeNode(e,s)}}else this._onRemovalComplete(e,s)}markElementAsRemoved(t,e,r,s,i){this.collectedLeaveElements.push(e),e[Ka]={namespaceId:t,setForRemoval:s,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:i}}listen(t,e,r,s,i){return Ly(e)?this._fetchNamespace(t).listen(e,r,s,i):()=>{}}_buildInstruction(t,e,r,s,i){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,r,s,t.fromState.options,t.toState.options,e,i)}destroyInnerAnimations(t){let e=this.driver.query(t,My,!0);e.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,mA,!0),e.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return B6(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[Ka];if(e&&e.setForRemoval){if(t[Ka]=jq,e.namespaceId){this.destroyInnerAnimations(t);const r=this._fetchNamespace(e.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(bA)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,s)=>this._balanceNamespaceList(r,s)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)Xa(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{e=this._flushAnimations(r,t)}finally{for(let s=0;s<r.length;s++)r[s]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],e.length?B6(e).onDone(()=>{r.forEach(s=>s())}):r.forEach(s=>s())}}reportError(t){throw function hhe(n){return new Te(3402,!1)}()}_flushAnimations(t,e){const r=new Oy,s=[],i=new Map,o=[],c=new Map,u=new Map,h=new Map,g=new Set;this.disabledNodes.forEach(_t=>{g.add(_t);const Ft=this.driver.query(_t,".ng-animate-queued",!0);for(let qt=0;qt<Ft.length;qt++)g.add(Ft[qt])});const m=this.bodyNode,v=Array.from(this.statesByElement.keys()),T=Kq(v,this.collectedEnterElements),I=new Map;let z=0;T.forEach((_t,Ft)=>{const qt=gA+z++;I.set(Ft,qt),_t.forEach(t1=>Xa(t1,qt))});const Z=[],te=new Set,me=new Set;for(let _t=0;_t<this.collectedLeaveElements.length;_t++){const Ft=this.collectedLeaveElements[_t],qt=Ft[Ka];qt&&qt.setForRemoval&&(Z.push(Ft),te.add(Ft),qt.hasAnimation?this.driver.query(Ft,".ng-star-inserted",!0).forEach(t1=>te.add(t1)):me.add(Ft))}const J=new Map,Ne=Kq(v,Array.from(te));Ne.forEach((_t,Ft)=>{const qt=yy+z++;J.set(Ft,qt),_t.forEach(t1=>Xa(t1,qt))}),t.push(()=>{T.forEach((_t,Ft)=>{const qt=I.get(Ft);_t.forEach(t1=>I7(t1,qt))}),Ne.forEach((_t,Ft)=>{const qt=J.get(Ft);_t.forEach(t1=>I7(t1,qt))}),Z.forEach(_t=>{this.processLeaveNode(_t)})});const He=[],qe=[];for(let _t=this._namespaceList.length-1;_t>=0;_t--)this._namespaceList[_t].drainQueuedTransitions(e).forEach(qt=>{const t1=qt.player,Bt=qt.element;if(He.push(t1),this.collectedEnterElements.length){const Ri=Bt[Ka];if(Ri&&Ri.setForMove){if(Ri.previousTriggersValues&&Ri.previousTriggersValues.has(qt.triggerName)){const $8=Ri.previousTriggersValues.get(qt.triggerName),pc=this.statesByElement.get(qt.element);if(pc&&pc.has(qt.triggerName)){const eP=pc.get(qt.triggerName);eP.value=$8,pc.set(qt.triggerName,eP)}}return void t1.destroy()}}const h4=!m||!this.driver.containsElement(m,Bt),ba=J.get(Bt),N0=I.get(Bt),Kr=this._buildInstruction(qt,r,N0,ba,h4);if(Kr.errors&&Kr.errors.length)return void qe.push(Kr);if(h4)return t1.onStart(()=>Uu(Bt,Kr.fromStyles)),t1.onDestroy(()=>W3(Bt,Kr.toStyles)),void s.push(t1);if(qt.isFallbackTransition)return t1.onStart(()=>Uu(Bt,Kr.fromStyles)),t1.onDestroy(()=>W3(Bt,Kr.toStyles)),void s.push(t1);const Wce=[];Kr.timelines.forEach(Ri=>{Ri.stretchStartingKeyframe=!0,this.disabledNodes.has(Ri.element)||Wce.push(Ri)}),Kr.timelines=Wce,r.append(Bt,Kr.timelines),o.push({instruction:Kr,player:t1,element:Bt}),Kr.queriedElements.forEach(Ri=>fa(c,Ri,[]).push(t1)),Kr.preStyleProps.forEach((Ri,$8)=>{if(Ri.size){let pc=u.get($8);pc||u.set($8,pc=new Set),Ri.forEach((eP,GV)=>pc.add(GV))}}),Kr.postStyleProps.forEach((Ri,$8)=>{let pc=h.get($8);pc||h.set($8,pc=new Set),Ri.forEach((eP,GV)=>pc.add(GV))})});if(qe.length){const _t=[];qe.forEach(Ft=>{_t.push(function dhe(n,t){return new Te(3505,!1)}())}),He.forEach(Ft=>Ft.destroy()),this.reportError(_t)}const Dt=new Map,A1=new Map;o.forEach(_t=>{const Ft=_t.element;r.has(Ft)&&(A1.set(Ft,Ft),this._beforeAnimationBuild(_t.player.namespaceId,_t.instruction,Dt))}),s.forEach(_t=>{const Ft=_t.element;this._getPreviousPlayers(Ft,!1,_t.namespaceId,_t.triggerName,null).forEach(t1=>{fa(Dt,Ft,[]).push(t1),t1.destroy()})});const M1=Z.filter(_t=>Qq(_t,u,h)),Yr=new Map;Yq(Yr,this.driver,me,h,el).forEach(_t=>{Qq(_t,u,h)&&M1.push(_t)});const go=new Map;T.forEach((_t,Ft)=>{Yq(go,this.driver,new Set(_t),u,"!")}),M1.forEach(_t=>{const Ft=Yr.get(_t),qt=go.get(_t);Yr.set(_t,new Map([...Array.from(Ft?.entries()??[]),...Array.from(qt?.entries()??[])]))});const di=[],Gn=[],Rl={};o.forEach(_t=>{const{element:Ft,player:qt,instruction:t1}=_t;if(r.has(Ft)){if(g.has(Ft))return qt.onDestroy(()=>W3(Ft,t1.toStyles)),qt.disabled=!0,qt.overrideTotalTime(t1.totalTime),void s.push(qt);let Bt=Rl;if(A1.size>1){let ba=Ft;const N0=[];for(;ba=ba.parentNode;){const Kr=A1.get(ba);if(Kr){Bt=Kr;break}N0.push(ba)}N0.forEach(Kr=>A1.set(Kr,Bt))}const h4=this._buildAnimation(qt.namespaceId,t1,Dt,i,go,Yr);if(qt.setRealPlayer(h4),Bt===Rl)di.push(qt);else{const ba=this.playersByElement.get(Bt);ba&&ba.length&&(qt.parentPlayer=B6(ba)),s.push(qt)}}else Uu(Ft,t1.fromStyles),qt.onDestroy(()=>W3(Ft,t1.toStyles)),Gn.push(qt),g.has(Ft)&&s.push(qt)}),Gn.forEach(_t=>{const Ft=i.get(_t.element);if(Ft&&Ft.length){const qt=B6(Ft);_t.setRealPlayer(qt)}}),s.forEach(_t=>{_t.parentPlayer?_t.syncPlayerEvents(_t.parentPlayer):_t.destroy()});for(let _t=0;_t<Z.length;_t++){const Ft=Z[_t],qt=Ft[Ka];if(I7(Ft,yy),qt&&qt.hasAnimation)continue;let t1=[];if(c.size){let h4=c.get(Ft);h4&&h4.length&&t1.push(...h4);let ba=this.driver.query(Ft,mA,!0);for(let N0=0;N0<ba.length;N0++){let Kr=c.get(ba[N0]);Kr&&Kr.length&&t1.push(...Kr)}}const Bt=t1.filter(h4=>!h4.destroyed);Bt.length?mde(this,Ft,Bt):this.processLeaveNode(Ft)}return Z.length=0,di.forEach(_t=>{this.players.push(_t),_t.onDone(()=>{_t.destroy();const Ft=this.players.indexOf(_t);this.players.splice(Ft,1)}),_t.play()}),di}elementContainsData(t,e){let r=!1;const s=e[Ka];return s&&s.setForRemoval&&(r=!0),this.playersByElement.has(e)&&(r=!0),this.playersByQueriedElement.has(e)&&(r=!0),this.statesByElement.has(e)&&(r=!0),this._fetchNamespace(t).elementContainsData(e)||r}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,r,s,i){let o=[];if(e){const c=this.playersByQueriedElement.get(t);c&&(o=c)}else{const c=this.playersByElement.get(t);if(c){const u=!i||i==ip;c.forEach(h=>{h.queued||!u&&h.triggerName!=s||o.push(h)})}}return(r||s)&&(o=o.filter(c=>!(r&&r!=c.namespaceId||s&&s!=c.triggerName))),o}_beforeAnimationBuild(t,e,r){const i=e.element,o=e.isRemovalTransition?void 0:t,c=e.isRemovalTransition?void 0:e.triggerName;for(const u of e.timelines){const h=u.element,g=h!==i,m=fa(r,h,[]);this._getPreviousPlayers(h,g,o,c,e.toState).forEach(T=>{const I=T.getRealPlayer();I.beforeDestroy&&I.beforeDestroy(),T.destroy(),m.push(T)})}Uu(i,e.fromStyles)}_buildAnimation(t,e,r,s,i,o){const c=e.triggerName,u=e.element,h=[],g=new Set,m=new Set,v=e.timelines.map(I=>{const z=I.element;g.add(z);const Z=z[Ka];if(Z&&Z.removedBeforeQueried)return new tp(I.duration,I.delay);const te=z!==u,me=function _de(n){const t=[];return Xq(n,t),t}((r.get(z)||lde).map(Dt=>Dt.getRealPlayer())).filter(Dt=>!!Dt.element&&Dt.element===z),J=i.get(z),Ne=o.get(z),He=Sq(0,this._normalizer,0,I.keyframes,J,Ne),qe=this._buildPlayer(I,He,me);if(I.subTimeline&&s&&m.add(z),te){const Dt=new OA(t,c,z);Dt.setRealPlayer(qe),h.push(Dt)}return qe});h.forEach(I=>{fa(this.playersByQueriedElement,I.element,[]).push(I),I.onDone(()=>function dde(n,t,e){let r=n.get(t);if(r){if(r.length){const s=r.indexOf(e);r.splice(s,1)}0==r.length&&n.delete(t)}return r}(this.playersByQueriedElement,I.element,I))}),g.forEach(I=>Xa(I,xq));const T=B6(v);return T.onDestroy(()=>{g.forEach(I=>I7(I,xq)),W3(u,e.toStyles)}),m.forEach(I=>{fa(s,I,[]).push(T)}),T}_buildPlayer(t,e,r){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,r):new tp(t.duration,t.delay)}}class OA{constructor(t,e,r){this.namespaceId=t,this.triggerName=e,this.element=r,this._player=new tp,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,r)=>{e.forEach(s=>lA(t,r,void 0,s))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){fa(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function Ly(n){return n&&1===n.nodeType}function Zq(n,t){const e=n.style.display;return n.style.display=t??"none",e}function Yq(n,t,e,r,s){const i=[];e.forEach(u=>i.push(Zq(u)));const o=[];r.forEach((u,h)=>{const g=new Map;u.forEach(m=>{const v=t.computeStyle(h,m,s);g.set(m,v),(!v||0==v.length)&&(h[Ka]=ude,o.push(h))}),n.set(h,g)});let c=0;return e.forEach(u=>Zq(u,i[c++])),o}function Kq(n,t){const e=new Map;if(n.forEach(c=>e.set(c,[])),0==t.length)return e;const s=new Set(t),i=new Map;function o(c){if(!c)return 1;let u=i.get(c);if(u)return u;const h=c.parentNode;return u=e.has(h)?h:s.has(h)?1:o(h),i.set(c,u),u}return t.forEach(c=>{const u=o(c);1!==u&&e.get(u).push(c)}),e}function Xa(n,t){n.classList?.add(t)}function I7(n,t){n.classList?.remove(t)}function mde(n,t,e){B6(e).onDone(()=>n.processLeaveNode(t))}function Xq(n,t){for(let e=0;e<n.length;e++){const r=n[e];r instanceof Eq?Xq(r.players,t):t.push(r)}}function Qq(n,t,e){const r=e.get(n);if(!r)return!1;let s=t.get(n);return s?r.forEach(i=>s.add(i)):t.set(n,r),e.delete(n),!0}class ky{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(s,i)=>{},this._transitionEngine=new hde(t,e,r),this._timelineEngine=new sde(t,e,r),this._transitionEngine.onRemovalComplete=(s,i)=>this.onRemovalComplete(s,i)}registerTrigger(t,e,r,s,i){const o=t+"-"+s;let c=this._triggerCache[o];if(!c){const u=[],g=yA(this._driver,i,u,[]);if(u.length)throw function nhe(n,t){return new Te(3404,!1)}();c=function ede(n,t,e){return new tde(n,t,e)}(s,g,this._normalizer),this._triggerCache[o]=c}this._transitionEngine.registerTrigger(e,s,c)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,r,s){this._transitionEngine.insertNode(t,e,r,s)}onRemove(t,e,r,s){this._transitionEngine.removeNode(t,e,s||!1,r)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,r,s){if("@"==r.charAt(0)){const[i,o]=Pq(r);this._timelineEngine.command(i,e,o,s)}else this._transitionEngine.trigger(t,e,r,s)}listen(t,e,r,s,i){if("@"==r.charAt(0)){const[o,c]=Pq(r);return this._timelineEngine.listen(o,e,c,i)}return this._transitionEngine.listen(t,e,r,s,i)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let yde=(()=>{class n{constructor(e,r,s){this._element=e,this._startStyles=r,this._endStyles=s,this._state=0;let i=n.initialStylesByElement.get(e);i||n.initialStylesByElement.set(e,i=new Map),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&W3(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(W3(this._element,this._initialStyles),this._endStyles&&(W3(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Uu(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Uu(this._element,this._endStyles),this._endStyles=null),W3(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function IA(n){let t=null;return n.forEach((e,r)=>{(function Ede(n){return"display"===n||"position"===n})(r)&&(t=t||new Map,t.set(r,e))}),t}class Jq{constructor(t,e,r,s){this.element=t,this.keyframes=e,this.options=r,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const e=[];return t.forEach(r=>{e.push(Object.fromEntries(r))}),e}_triggerWebAnimation(t,e,r){return t.animate(this._convertKeyframesToObject(e),r)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,s)=>{"offset"!==s&&t.set(s,this._finished?r:Vq(this.element,s))}),this.currentSnapshot=t}triggerCallback(t){const e="start"===t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class Mde{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,e){return!1}containsElement(t,e){return Nq(t,e)}getParentElement(t){return dA(t)}query(t,e,r){return Aq(t,e,r)}computeStyle(t,e,r){return window.getComputedStyle(t)[e]}animate(t,e,r,s,i,o=[]){const u={duration:r,delay:s,fill:0==s?"both":"forwards"};i&&(u.easing=i);const h=new Map,g=o.filter(T=>T instanceof Jq);(function whe(n,t){return 0===n||0===t})(r,s)&&g.forEach(T=>{T.currentSnapshot.forEach((I,z)=>h.set(z,I))});let m=function Mhe(n){return n.length?n[0]instanceof Map?n:n.map(t=>Lq(t)):[]}(e).map(T=>$6(T));m=function bhe(n,t,e){if(e.size&&t.length){let r=t[0],s=[];if(e.forEach((i,o)=>{r.has(o)||s.push(o),r.set(o,i)}),s.length)for(let i=1;i<t.length;i++){let o=t[i];s.forEach(c=>o.set(c,Vq(n,c)))}}return t}(t,m,h);const v=function Cde(n,t){let e=null,r=null;return Array.isArray(t)&&t.length?(e=IA(t[0]),t.length>1&&(r=IA(t[t.length-1]))):t instanceof Map&&(e=IA(t)),e||r?new yde(n,e,r):null}(t,m);return new Jq(t,m,u,v)}}let Sde=(()=>{class n extends _q{constructor(e,r){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(r.body,{id:"0",encapsulation:O1.None,styles:[],data:{animation:[]}})}build(e){const r=this._nextAnimationId.toString();this._nextAnimationId++;const s=Array.isArray(e)?vq(e):e;return ej(this._renderer,null,r,"register",[s]),new Pde(r,this._renderer)}}return n.\u0275fac=function(e){return new(e||n)(xe(_6),xe(Os))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})();class Pde extends class kfe{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new Tde(this._id,t,e||{},this._renderer)}}class Tde{constructor(t,e,r,s){this.id=t,this.element=e,this._renderer=s,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return ej(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function ej(n,t,e,r,s){return n.setProperty(t,`@@${e}:${r}`,s)}const tj="@.disabled";let wde=(()=>{class n{constructor(e,r,s){this.delegate=e,this.engine=r,this._zone=s,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),r.onRemovalComplete=(i,o)=>{const c=o?.parentNode(i);c&&o.removeChild(c,i)}}createRenderer(e,r){const i=this.delegate.createRenderer(e,r);if(!(e&&r&&r.data&&r.data.animation)){let g=this._rendererCache.get(i);return g||(g=new nj("",i,this.engine,()=>this._rendererCache.delete(i)),this._rendererCache.set(i,g)),g}const o=r.id,c=r.id+"-"+this._currentId;this._currentId++,this.engine.register(c,e);const u=g=>{Array.isArray(g)?g.forEach(u):this.engine.registerTrigger(o,c,e,g.name,g)};return r.data.animation.forEach(u),new bde(this,c,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,r,s){e>=0&&e<this._microtaskId?this._zone.run(()=>r(s)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(i=>{const[o,c]=i;o(c)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([r,s]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(e){return new(e||n)(xe(_6),xe(ky),xe(vr))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})();class nj{constructor(t,e,r,s){this.namespaceId=t,this.delegate=e,this.engine=r,this._onDestroy=s,this.destroyNode=this.delegate.destroyNode?i=>e.destroyNode(i):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,r,s=!0){this.delegate.insertBefore(t,e,r),this.engine.onInsert(this.namespaceId,e,t,s)}removeChild(t,e,r){this.engine.onRemove(this.namespaceId,e,this.delegate,r)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,r,s){this.delegate.setAttribute(t,e,r,s)}removeAttribute(t,e,r){this.delegate.removeAttribute(t,e,r)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,r,s){this.delegate.setStyle(t,e,r,s)}removeStyle(t,e,r){this.delegate.removeStyle(t,e,r)}setProperty(t,e,r){"@"==e.charAt(0)&&e==tj?this.disableAnimations(t,!!r):this.delegate.setProperty(t,e,r)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,r){return this.delegate.listen(t,e,r)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class bde extends nj{constructor(t,e,r,s,i){super(e,r,s,i),this.factory=t,this.namespaceId=e}setProperty(t,e,r){"@"==e.charAt(0)?"."==e.charAt(1)&&e==tj?this.disableAnimations(t,r=void 0===r||!!r):this.engine.process(this.namespaceId,t,e.slice(1),r):this.delegate.setProperty(t,e,r)}listen(t,e,r){if("@"==e.charAt(0)){const s=function Nde(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let i=e.slice(1),o="";return"@"!=i.charAt(0)&&([i,o]=function Ade(n){const t=n.indexOf(".");return[n.substring(0,t),n.slice(t+1)]}(i)),this.engine.listen(this.namespaceId,s,i,o,c=>{this.factory.scheduleListenerCallback(c._data||-1,r,c)})}return this.delegate.listen(t,e,r)}}let Ode=(()=>{class n extends ky{constructor(e,r,s,i){super(e.body,r,s)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(e){return new(e||n)(xe(Os),xe(pA),xe(TA),xe(M9))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac}),n})();const rj=[{provide:_q,useClass:Sde},{provide:TA,useFactory:function Ide(){return new Khe}},{provide:ky,useClass:Ode},{provide:_6,useFactory:function xde(n,t,e){return new wde(n,t,e)},deps:[zC,ky,vr]}],xA=[{provide:pA,useFactory:()=>new Mde},{provide:v$,useValue:"BrowserAnimations"},...rj],sj=[{provide:pA,useClass:Oq},{provide:v$,useValue:"NoopAnimations"},...rj];let Lde=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?sj:xA}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=qs({type:n}),n.\u0275inj=Fr({providers:xA,imports:[DU]}),n})();const ms=void 0,Rde=["fr",[["AM","PM"],ms,ms],ms,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],ms,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],ms,[["av. J.-C.","ap. J.-C."],ms,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1}, {0}","{1} '\xe0' {0}",ms],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BYN:[ms,"\u0440."],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[ms,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[ms,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[ms,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[ms,"\xa5"],KMF:[ms,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[ms,"$C"],NZD:["$NZ","$"],PHP:[ms,"\u20b1"],RHD:["$RH"],RON:[ms,"L"],RWF:[ms,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[ms,"$T"],TTD:["$TT","$"],TWD:[ms,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[ms,"$"],XPF:["FCFP"],ZMW:[ms,"Kw"]},"ltr",function kde(n){const e=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length,s=parseInt(n.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 0===e||1===e?1:0===s&&0!==e&&e%1e6==0&&0===r||!(s>=0&&s<=5)?4:5}];function ij(n,t,e,r,s,i,o){try{var c=n[i](o),u=c.value}catch(h){return void e(h)}c.done?t(u):Promise.resolve(u).then(r,s)}function O(n){return function(){var t=this,e=arguments;return new Promise(function(r,s){var i=n.apply(t,e);function o(u){ij(i,r,s,o,c,"next",u)}function c(u){ij(i,r,s,o,c,"throw",u)}o(void 0)})}}const oj=function(n){const t=[];let e=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=63&s|128):55296==(64512&s)&&r+1<n.length&&56320==(64512&n.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&n.charCodeAt(++r)),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=63&s|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=63&s|128)}return t},kA={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,c=o?n[s+1]:0,u=s+2<n.length,h=u?n[s+2]:0;let v=(15&c)<<2|h>>6,T=63&h;u||(T=64,o||(v=64)),r.push(e[i>>2],e[(3&i)<<4|c>>4],e[v],e[T])}return r.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(oj(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):function(n){const t=[];let e=0,r=0;for(;e<n.length;){const s=n[e++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[e++];t[r++]=String.fromCharCode((31&s)<<6|63&i)}else if(s>239&&s<365){const u=((7&s)<<18|(63&n[e++])<<12|(63&n[e++])<<6|63&n[e++])-65536;t[r++]=String.fromCharCode(55296+(u>>10)),t[r++]=String.fromCharCode(56320+(1023&u))}else{const i=n[e++],o=n[e++];t[r++]=String.fromCharCode((15&s)<<12|(63&i)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=e[n.charAt(s++)],c=s<n.length?e[n.charAt(s)]:0;++s;const h=s<n.length?e[n.charAt(s)]:64;++s;const m=s<n.length?e[n.charAt(s)]:64;if(++s,null==i||null==c||null==h||null==m)throw Error();r.push(i<<2|c>>4),64!==h&&(r.push(c<<4&240|h>>2),64!==m&&r.push(h<<6&192|m))}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Dy=function(n){return function(n){const t=oj(n);return kA.encodeByteArray(t,!0)}(n).replace(/\./g,"")},zy=function(n){try{return kA.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function M2(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function RA(){const n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof n&&void 0!==n.id}function Wu(){return"object"==typeof indexedDB}function op(){return new Promise((n,t)=>{try{let e=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{var i;t((null===(i=s.error)||void 0===i?void 0:i.message)||"")}}catch(e){t(e)}})}function DA(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const zA=()=>{try{return function Wde(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const n=process.env.__FIREBASE_DEFAULTS__;return n?JSON.parse(n):void 0})()||(()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&zy(n[1]);return t&&JSON.parse(t)})()}catch(n){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`)}},cj=n=>{var t,e;return null===(e=null===(t=zA())||void 0===t?void 0:t.emulatorHosts)||void 0===e?void 0:e[n]},lj=n=>{var t;return null===(t=zA())||void 0===t?void 0:t[`_${n}`]};class Vy{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,r))}}}class Qa extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,Qa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,q3.prototype.create)}}class q3{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},s=`${this.service}/${t}`,i=this.errors[t],o=i?function Jde(n,t){return n.replace(e9e,(e,r)=>{const s=t[r];return null!=s?String(s):`<${r}?>`})}(i,r):"Error";return new Qa(s,`${this.serviceName}: ${o} (${s}).`,r)}}const e9e=/\{\$([^}]+)}/g;function Fy(n,t){if(n===t)return!0;const e=Object.keys(n),r=Object.keys(t);for(const s of e){if(!r.includes(s))return!1;const i=n[s],o=t[s];if(fj(i)&&fj(o)){if(!Fy(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!e.includes(s))return!1;return!0}function fj(n){return null!==n&&"object"==typeof n}function ap(n){const t=[];for(const[e,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function cp(n){const t={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");t[decodeURIComponent(s)]=decodeURIComponent(i)}}),t}function lp(n){const t=n.indexOf("?");if(!t)return"";const e=n.indexOf("#",t);return n.substring(t,e>0?e:void 0)}class r9e{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(r=>{this.error(r)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,r){let s;if(void 0===t&&void 0===e&&void 0===r)throw new Error("Missing Observer.");s=function s9e(n,t){if("object"!=typeof n||null===n)return!1;for(const e of t)if(e in n&&"function"==typeof n[e])return!0;return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:r},void 0===s.next&&(s.next=VA),void 0===s.error&&(s.error=VA),void 0===s.complete&&(s.complete=VA);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(t){void 0===this.observers||void 0===this.observers[t]||(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function VA(){}function FA(n,t=1e3,e=2){const r=t*Math.pow(e,n),s=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+s)}function Wr(n){return n&&n._delegate?n._delegate:n}class Pi{constructor(t,e,r){this.name=t,this.instanceFactory=e,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const qu="[DEFAULT]";class u9e{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const r=new Vy;if(this.instancesDeferred.set(e,r),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const r=this.normalizeInstanceIdentifier(t?.identifier),s=null!==(e=t?.optional)&&void 0!==e&&e;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(s)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function h9e(n){return"EAGER"===n.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:qu})}catch{}for(const[e,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(t=qu){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}delete(){var t=this;return O(function*(){const e=Array.from(t.instances.values());yield Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(t=qu){return this.instances.has(t)}getOptions(t=qu){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:e});for(const[i,o]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(i)&&o.resolve(s);return s}onInit(t,e){var r;const s=this.normalizeInstanceIdentifier(e),i=null!==(r=this.onInitCallbacks.get(s))&&void 0!==r?r:new Set;i.add(t),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&t(o,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const r=this.onInitCallbacks.get(e);if(r)for(const s of r)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(n=t,n===qu?void 0:n),options:e}),this.instances.set(t,r),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}var n;return r||null}normalizeInstanceIdentifier(t=qu){return this.component?this.component.multipleInstances?t:qu:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class d9e{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new u9e(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const BA=[];var u1=(()=>{return(n=u1||(u1={}))[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",u1;var n})();const hj={debug:u1.DEBUG,verbose:u1.VERBOSE,info:u1.INFO,warn:u1.WARN,error:u1.ERROR,silent:u1.SILENT},p9e=u1.INFO,g9e={[u1.DEBUG]:"log",[u1.VERBOSE]:"log",[u1.INFO]:"info",[u1.WARN]:"warn",[u1.ERROR]:"error"},m9e=(n,t,...e)=>{if(t<n.logLevel)return;const r=(new Date).toISOString(),s=g9e[t];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[s](`[${r}]  ${n.name}:`,...e)};class x7{constructor(t){this.name=t,this._logLevel=p9e,this._logHandler=m9e,this._userLogHandler=null,BA.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in u1))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?hj[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,u1.DEBUG,...t),this._logHandler(this,u1.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,u1.VERBOSE,...t),this._logHandler(this,u1.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,u1.INFO,...t),this._logHandler(this,u1.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,u1.WARN,...t),this._logHandler(this,u1.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,u1.ERROR,...t),this._logHandler(this,u1.ERROR,...t)}}let dj,pj;const gj=new WeakMap,$A=new WeakMap,mj=new WeakMap,UA=new WeakMap,GA=new WeakMap;let WA={get(n,t,e){if(n instanceof IDBTransaction){if("done"===t)return $A.get(n);if("objectStoreNames"===t)return n.objectStoreNames||mj.get(n);if("store"===t)return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return nl(n[t])},set:(n,t,e)=>(n[t]=e,!0),has:(n,t)=>n instanceof IDBTransaction&&("done"===t||"store"===t)||t in n};function P9e(n){return"function"==typeof n?function S9e(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function C9e(){return pj||(pj=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(n)?function(...t){return n.apply(qA(this),t),nl(gj.get(this))}:function(...t){return nl(n.apply(qA(this),t))}:function(t,...e){const r=n.call(qA(this),t,...e);return mj.set(r,t.sort?t.sort():[t]),nl(r)}}(n):(n instanceof IDBTransaction&&function E9e(n){if($A.has(n))return;const t=new Promise((e,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{e(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});$A.set(n,t)}(n),((n,t)=>t.some(e=>n instanceof e))(n,function v9e(){return dj||(dj=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(n,WA):n)}function nl(n){if(n instanceof IDBRequest)return function y9e(n){const t=new Promise((e,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{e(nl(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&gj.set(e,n)}).catch(()=>{}),GA.set(t,n),t}(n);if(UA.has(n))return UA.get(n);const t=P9e(n);return t!==n&&(UA.set(n,t),GA.set(t,n)),t}const qA=n=>GA.get(n);function By(n,t,{blocked:e,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,t),c=nl(o);return r&&o.addEventListener("upgradeneeded",u=>{r(nl(o.result),u.oldVersion,u.newVersion,nl(o.transaction))}),e&&o.addEventListener("blocked",()=>e()),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",()=>s())}).catch(()=>{}),c}function jA(n,{blocked:t}={}){const e=indexedDB.deleteDatabase(n);return t&&e.addEventListener("blocked",()=>t()),nl(e).then(()=>{})}const T9e=["get","getKey","getAll","getAllKeys","count"],w9e=["put","add","delete","clear"],ZA=new Map;function _j(n,t){if(!(n instanceof IDBDatabase)||t in n||"string"!=typeof t)return;if(ZA.get(t))return ZA.get(t);const e=t.replace(/FromIndex$/,""),r=t!==e,s=w9e.includes(e);if(!(e in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!T9e.includes(e))return;const i=function(){var o=O(function*(c,...u){const h=this.transaction(c,s?"readwrite":"readonly");let g=h.store;return r&&(g=g.index(u.shift())),(yield Promise.all([g[e](...u),s&&h.done]))[0]});return function(u){return o.apply(this,arguments)}}();return ZA.set(t,i),i}!function M9e(n){WA=n(WA)}(n=>({...n,get:(t,e,r)=>_j(t,e)||n.get(t,e,r),has:(t,e)=>!!_j(t,e)||n.has(t,e)}));class b9e{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function N9e(n){return"VERSION"===n.getComponent()?.type}(e)){const r=e.getImmediate();return`${r.library}/${r.version}`}return null}).filter(e=>e).join(" ")}}const YA="@firebase/app",ju=new x7("@firebase/app"),$y="[DEFAULT]",epe={[YA]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Zu=new Map,Uy=new Map;function tpe(n,t){try{n.container.addComponent(t)}catch(e){ju.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function Ji(n){const t=n.name;if(Uy.has(t))return ju.debug(`There were multiple attempts to register component ${t}.`),!1;Uy.set(t,n);for(const e of Zu.values())tpe(e,n);return!0}function L7(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}const rl=new q3("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class rpe{constructor(t,e,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Pi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw rl.create("app-deleted",{appName:this._name})}}const k7="9.14.0";function Cj(n,t={}){let e=n;"object"!=typeof t&&(t={name:t});const r=Object.assign({name:$y,automaticDataCollectionEnabled:!1},t),s=r.name;if("string"!=typeof s||!s)throw rl.create("bad-app-name",{appName:String(s)});if(e||(e=(()=>{var n;return null===(n=zA())||void 0===n?void 0:n.config})()),!e)throw rl.create("no-options");const i=Zu.get(s);if(i){if(Fy(e,i.options)&&Fy(r,i.config))return i;throw rl.create("duplicate-app",{appName:s})}const o=new d9e(s);for(const u of Uy.values())o.addComponent(u);const c=new rpe(e,r,o);return Zu.set(s,c),c}function KA(n=$y){const t=Zu.get(n);if(!t&&n===$y)return Cj();if(!t)throw rl.create("no-app",{appName:n});return t}function yj(){return Array.from(Zu.values())}function ns(n,t,e){var r;let s=null!==(r=epe[n])&&void 0!==r?r:n;e&&(s+=`-${e}`);const i=s.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const c=[`Unable to register library "${s}" with version "${t}":`];return i&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&c.push("and"),o&&c.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void ju.warn(c.join(" "))}Ji(new Pi(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}const up="firebase-heartbeat-store";let QA=null;function Ej(){return QA||(QA=By("firebase-heartbeat-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(up)}}).catch(n=>{throw rl.create("idb-open",{originalErrorMessage:n.message})})),QA}function JA(){return(JA=O(function*(n){var t;try{return(yield Ej()).transaction(up).objectStore(up).get(Sj(n))}catch(e){if(e instanceof Qa)ju.warn(e.message);else{const r=rl.create("idb-get",{originalErrorMessage:null===(t=e)||void 0===t?void 0:t.message});ju.warn(r.message)}}})).apply(this,arguments)}function Mj(n,t){return eO.apply(this,arguments)}function eO(){return(eO=O(function*(n,t){var e;try{const s=(yield Ej()).transaction(up,"readwrite");return yield s.objectStore(up).put(t,Sj(n)),s.done}catch(r){if(r instanceof Qa)ju.warn(r.message);else{const s=rl.create("idb-set",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message});ju.warn(s.message)}}})).apply(this,arguments)}function Sj(n){return`${n.name}!${n.options.appId}`}class lpe{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new fpe(e),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){var t=this;return O(function*(){const r=t.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Pj();if(null===t._heartbeatsCache&&(t._heartbeatsCache=yield t._heartbeatsCachePromise),t._heartbeatsCache.lastSentHeartbeatDate!==s&&!t._heartbeatsCache.heartbeats.some(i=>i.date===s))return t._heartbeatsCache.heartbeats.push({date:s,agent:r}),t._heartbeatsCache.heartbeats=t._heartbeatsCache.heartbeats.filter(i=>{const o=new Date(i.date).valueOf();return Date.now()-o<=2592e6}),t._storage.overwrite(t._heartbeatsCache)})()}getHeartbeatsHeader(){var t=this;return O(function*(){if(null===t._heartbeatsCache&&(yield t._heartbeatsCachePromise),null===t._heartbeatsCache||0===t._heartbeatsCache.heartbeats.length)return"";const e=Pj(),{heartbeatsToSend:r,unsentEntries:s}=function upe(n,t=1024){const e=[];let r=n.slice();for(const s of n){const i=e.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Tj(e)>t){i.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),Tj(e)>t){e.pop();break}r=r.slice(1)}return{heartbeatsToSend:e,unsentEntries:r}}(t._heartbeatsCache.heartbeats),i=Dy(JSON.stringify({version:2,heartbeats:r}));return t._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(t._heartbeatsCache.heartbeats=s,yield t._storage.overwrite(t._heartbeatsCache)):(t._heartbeatsCache.heartbeats=[],t._storage.overwrite(t._heartbeatsCache)),i})()}}function Pj(){return(new Date).toISOString().substring(0,10)}class fpe{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return O(function*(){return!!Wu()&&op().then(()=>!0).catch(()=>!1)})()}read(){var t=this;return O(function*(){return(yield t._canUseIndexedDBPromise)&&(yield function ope(n){return JA.apply(this,arguments)}(t.app))||{heartbeats:[]}})()}overwrite(t){var e=this;return O(function*(){var r;if(yield e._canUseIndexedDBPromise){const i=yield e.read();return Mj(e.app,{lastSentHeartbeatDate:null!==(r=t.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}})()}add(t){var e=this;return O(function*(){var r;if(yield e._canUseIndexedDBPromise){const i=yield e.read();return Mj(e.app,{lastSentHeartbeatDate:null!==(r=t.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}})()}}function Tj(n){return Dy(JSON.stringify({version:2,heartbeats:n})).length}!function hpe(n){Ji(new Pi("platform-logger",t=>new b9e(t),"PRIVATE")),Ji(new Pi("heartbeat",t=>new lpe(t),"PRIVATE")),ns(YA,"0.8.4",n),ns(YA,"0.8.4","esm2017"),ns("fire-js","")}("");var wt,dpe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},sl={},tO=tO||{},dn=dpe||self;function Gy(){}function Wy(n){var t=typeof n;return"array"==(t="object"!=t?t:n?Array.isArray(n)?"array":t:"null")||"object"==t&&"number"==typeof n.length}function fp(n){var t=typeof n;return"object"==t&&null!=n||"function"==t}var nO="closure_uid_"+(1e9*Math.random()>>>0),gpe=0;function mpe(n,t,e){return n.call.apply(n.bind,arguments)}function _pe(n,t,e){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),n.apply(t,s)}}return function(){return n.apply(t,arguments)}}function Ti(n,t,e){return(Ti=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?mpe:_pe).apply(null,arguments)}function qy(n,t){var e=Array.prototype.slice.call(arguments,1);return function(){var r=e.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function ti(n,t){function e(){}e.prototype=t.prototype,n.X=t.prototype,n.prototype=new e,n.prototype.constructor=n,n.Wb=function(r,s,i){for(var o=Array(arguments.length-2),c=2;c<arguments.length;c++)o[c-2]=arguments[c];return t.prototype[s].apply(r,o)}}function U6(){this.s=this.s,this.o=this.o}U6.prototype.s=!1,U6.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function ppe(n){Object.prototype.hasOwnProperty.call(n,nO)&&n[nO]||(n[nO]=++gpe)}(this)},U6.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const wj=Array.prototype.indexOf?function(n,t){return Array.prototype.indexOf.call(n,t,void 0)}:function(n,t){if("string"==typeof n)return"string"!=typeof t||1!=t.length?-1:n.indexOf(t,0);for(let e=0;e<n.length;e++)if(e in n&&n[e]===t)return e;return-1};function rO(n){const t=n.length;if(0<t){const e=Array(t);for(let r=0;r<t;r++)e[r]=n[r];return e}return[]}function bj(n,t){for(let e=1;e<arguments.length;e++){const r=arguments[e];if(Wy(r)){const s=n.length||0,i=r.length||0;n.length=s+i;for(let o=0;o<i;o++)n[s+o]=r[o]}else n.push(r)}}function wi(n,t){this.type=n,this.g=this.target=t,this.defaultPrevented=!1}wi.prototype.h=function(){this.defaultPrevented=!0};var Cpe=function(){if(!dn.addEventListener||!Object.defineProperty)return!1;var n=!1,t=Object.defineProperty({},"passive",{get:function(){n=!0}});try{dn.addEventListener("test",Gy,t),dn.removeEventListener("test",Gy,t)}catch{}return n}();function jy(n){return/^[\s\xa0]*$/.test(n)}var Nj=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function sO(n,t){return n<t?-1:n>t?1:0}function Zy(){var n=dn.navigator;return n&&(n=n.userAgent)?n:""}function j3(n){return-1!=Zy().indexOf(n)}function iO(n){return iO[" "](n),n}iO[" "]=Gy;var Yy,n,Epe=j3("Opera"),R7=j3("Trident")||j3("MSIE"),Aj=j3("Edge"),oO=Aj||R7,Oj=j3("Gecko")&&!(-1!=Zy().toLowerCase().indexOf("webkit")&&!j3("Edge"))&&!(j3("Trident")||j3("MSIE"))&&!j3("Edge"),Mpe=-1!=Zy().toLowerCase().indexOf("webkit")&&!j3("Edge");function Ij(){var n=dn.document;return n?n.documentMode:void 0}e:{var aO="",cO=(n=Zy(),Oj?/rv:([^\);]+)(\)|;)/.exec(n):Aj?/Edge\/([\d\.]+)/.exec(n):R7?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):Mpe?/WebKit\/(\S+)/.exec(n):Epe?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(cO&&(aO=cO?cO[1]:""),R7){var lO=Ij();if(null!=lO&&lO>parseFloat(aO)){Yy=String(lO);break e}}Yy=aO}var Spe={};var Tpe=dn.document&&R7&&(Ij()||parseInt(Yy,10))||void 0;function hp(n,t){if(wi.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var e=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=t,t=n.relatedTarget){if(Oj){e:{try{iO(t.nodeName);var s=!0;break e}catch{}s=!1}s||(t=null)}}else"mouseover"==e?t=n.fromElement:"mouseout"==e&&(t=n.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:wpe[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&hp.X.h.call(this)}}ti(hp,wi);var wpe={2:"touch",3:"pen",4:"mouse"};hp.prototype.h=function(){hp.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var dp="closure_listenable_"+(1e6*Math.random()|0),bpe=0;function Npe(n,t,e,r,s){this.listener=n,this.proxy=null,this.src=t,this.type=e,this.capture=!!r,this.ha=s,this.key=++bpe,this.ba=this.ea=!1}function Ky(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function fO(n,t,e){for(const r in n)t.call(e,n[r],r,n)}function Lj(n){const t={};for(const e in n)t[e]=n[e];return t}const kj="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Rj(n,t){let e,r;for(let s=1;s<arguments.length;s++){for(e in r=arguments[s],r)n[e]=r[e];for(let i=0;i<kj.length;i++)e=kj[i],Object.prototype.hasOwnProperty.call(r,e)&&(n[e]=r[e])}}function Xy(n){this.src=n,this.g={},this.h=0}function hO(n,t){var e=t.type;if(e in n.g){var i,r=n.g[e],s=wj(r,t);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(Ky(t),0==n.g[e].length&&(delete n.g[e],n.h--))}}function dO(n,t,e,r){for(var s=0;s<n.length;++s){var i=n[s];if(!i.ba&&i.listener==t&&i.capture==!!e&&i.ha==r)return s}return-1}Xy.prototype.add=function(n,t,e,r,s){var i=n.toString();(n=this.g[i])||(n=this.g[i]=[],this.h++);var o=dO(n,t,r,s);return-1<o?(t=n[o],e||(t.ea=!1)):((t=new Npe(t,this.src,i,!!r,s)).ea=e,n.push(t)),t};var pO="closure_lm_"+(1e6*Math.random()|0),gO={};function Dj(n,t,e,r,s){if(r&&r.once)return Vj(n,t,e,r,s);if(Array.isArray(t)){for(var i=0;i<t.length;i++)Dj(n,t[i],e,r,s);return null}return e=CO(e),n&&n[dp]?n.N(t,e,fp(r)?!!r.capture:!!r,s):zj(n,t,e,!1,r,s)}function zj(n,t,e,r,s,i){if(!t)throw Error("Invalid event type");var o=fp(s)?!!s.capture:!!s,c=_O(n);if(c||(n[pO]=c=new Xy(n)),(e=c.add(t,e,r,o,i)).proxy)return e;if(r=function Ape(){const t=Ope;return function n(e){return t.call(n.src,n.listener,e)}}(),e.proxy=r,r.src=n,r.listener=e,n.addEventListener)Cpe||(s=o),void 0===s&&(s=!1),n.addEventListener(t.toString(),r,s);else if(n.attachEvent)n.attachEvent(Fj(t.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return e}function Vj(n,t,e,r,s){if(Array.isArray(t)){for(var i=0;i<t.length;i++)Vj(n,t[i],e,r,s);return null}return e=CO(e),n&&n[dp]?n.O(t,e,fp(r)?!!r.capture:!!r,s):zj(n,t,e,!0,r,s)}function Hj(n,t,e,r,s){if(Array.isArray(t))for(var i=0;i<t.length;i++)Hj(n,t[i],e,r,s);else r=fp(r)?!!r.capture:!!r,e=CO(e),n&&n[dp]?(n=n.i,(t=String(t).toString())in n.g&&-1<(e=dO(i=n.g[t],e,r,s))&&(Ky(i[e]),Array.prototype.splice.call(i,e,1),0==i.length&&(delete n.g[t],n.h--))):n&&(n=_O(n))&&(t=n.g[t.toString()],n=-1,t&&(n=dO(t,e,r,s)),(e=-1<n?t[n]:null)&&mO(e))}function mO(n){if("number"!=typeof n&&n&&!n.ba){var t=n.src;if(t&&t[dp])hO(t.i,n);else{var e=n.type,r=n.proxy;t.removeEventListener?t.removeEventListener(e,r,n.capture):t.detachEvent?t.detachEvent(Fj(e),r):t.addListener&&t.removeListener&&t.removeListener(r),(e=_O(t))?(hO(e,n),0==e.h&&(e.src=null,t[pO]=null)):Ky(n)}}}function Fj(n){return n in gO?gO[n]:gO[n]="on"+n}function Ope(n,t){if(n.ba)n=!0;else{t=new hp(t,this);var e=n.listener,r=n.ha||n.src;n.ea&&mO(n),n=e.call(r,t)}return n}function _O(n){return(n=n[pO])instanceof Xy?n:null}var vO="__closure_events_fn_"+(1e9*Math.random()>>>0);function CO(n){return"function"==typeof n?n:(n[vO]||(n[vO]=function(t){return n.handleEvent(t)}),n[vO])}function S2(){U6.call(this),this.i=new Xy(this),this.P=this,this.I=null}function ni(n,t){var e,r=n.I;if(r)for(e=[];r;r=r.I)e.push(r);if(n=n.P,r=t.type||t,"string"==typeof t)t=new wi(t,n);else if(t instanceof wi)t.target=t.target||n;else{var s=t;Rj(t=new wi(r,n),s)}if(s=!0,e)for(var i=e.length-1;0<=i;i--){var o=t.g=e[i];s=Qy(o,r,!0,t)&&s}if(s=Qy(o=t.g=n,r,!0,t)&&s,s=Qy(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Qy(o=t.g=e[i],r,!1,t)&&s}function Qy(n,t,e,r){if(!(t=n.i.g[String(t)]))return!0;t=t.concat();for(var s=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.ba&&o.capture==e){var c=o.listener,u=o.ha||o.src;o.ea&&hO(n.i,o),s=!1!==c.call(u,r)&&s}}return s&&!r.defaultPrevented}ti(S2,U6),S2.prototype[dp]=!0,S2.prototype.removeEventListener=function(n,t,e,r){Hj(this,n,t,e,r)},S2.prototype.M=function(){if(S2.X.M.call(this),this.i){var t,n=this.i;for(t in n.g){for(var e=n.g[t],r=0;r<e.length;r++)Ky(e[r]);delete n.g[t],n.h--}}this.I=null},S2.prototype.N=function(n,t,e,r){return this.i.add(String(n),t,!1,e,r)},S2.prototype.O=function(n,t,e,r){return this.i.add(String(n),t,!0,e,r)};var yO=dn.JSON.stringify;function Ipe(){var n=Uj;let t=null;return n.g&&(t=n.g,n.g=n.g.next,n.g||(n.h=null),t.next=null),t}var EO,Bj=new class{constructor(n,t){this.i=n,this.j=t,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new Lpe,n=>n.reset());class Lpe{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function kpe(n){dn.setTimeout(()=>{throw n},0)}function $j(n,t){EO||function Rpe(){var n=dn.Promise.resolve(void 0);EO=function(){n.then(Dpe)}}(),MO||(EO(),MO=!0),Uj.add(n,t)}var MO=!1,Uj=new class xpe{constructor(){this.h=this.g=null}add(t,e){const r=Bj.get();r.set(t,e),this.h?this.h.next=r:this.g=r,this.h=r}};function Dpe(){for(var n;n=Ipe();){try{n.h.call(n.g)}catch(e){kpe(e)}var t=Bj;t.j(n),100>t.h&&(t.h++,n.next=t.g,t.g=n)}MO=!1}function Jy(n,t){S2.call(this),this.h=n||1,this.g=t||dn,this.j=Ti(this.lb,this),this.l=Date.now()}function SO(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function PO(n,t,e){if("function"==typeof n)e&&(n=Ti(n,e));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=Ti(n.handleEvent,n)}return 2147483647<Number(t)?-1:dn.setTimeout(n,t||0)}function Gj(n){n.g=PO(()=>{n.g=null,n.i&&(n.i=!1,Gj(n))},n.j);const t=n.h;n.h=null,n.m.apply(null,t)}ti(Jy,S2),(wt=Jy.prototype).ca=!1,wt.R=null,wt.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),ni(this,"tick"),this.ca&&(SO(this),this.start()))}},wt.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},wt.M=function(){Jy.X.M.call(this),SO(this),delete this.g};class zpe extends U6{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:Gj(this)}M(){super.M(),this.g&&(dn.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function pp(n){U6.call(this),this.h=n,this.g={}}ti(pp,U6);var Wj=[];function qj(n,t,e,r){Array.isArray(e)||(e&&(Wj[0]=e.toString()),e=Wj);for(var s=0;s<e.length;s++){var i=Dj(t,e[s],r||n.handleEvent,!1,n.h||n);if(!i)break;n.g[i.key]=i}}function jj(n){fO(n.g,function(t,e){this.g.hasOwnProperty(e)&&mO(t)},n),n.g={}}function eE(){this.g=!0}function D7(n,t,e,r){n.info(function(){return"XMLHTTP TEXT ("+t+"): "+function Bpe(n,t){if(!n.g)return t;if(!t)return null;try{var e=JSON.parse(t);if(e)for(n=0;n<e.length;n++)if(Array.isArray(e[n])){var r=e[n];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<s.length;o++)s[o]=""}}}return yO(e)}catch{return t}}(n,e)+(r?" "+r:"")})}pp.prototype.M=function(){pp.X.M.call(this),jj(this)},pp.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},eE.prototype.Aa=function(){this.g=!1},eE.prototype.info=function(){};var Yu={},Zj=null;function tE(){return Zj=Zj||new S2}function Yj(n){wi.call(this,Yu.Pa,n)}function gp(n){const t=tE();ni(t,new Yj(t))}function Kj(n,t){wi.call(this,Yu.STAT_EVENT,n),this.stat=t}function eo(n){const t=tE();ni(t,new Kj(t,n))}function Xj(n,t){wi.call(this,Yu.Qa,n),this.size=t}function mp(n,t){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return dn.setTimeout(function(){n()},t)}Yu.Pa="serverreachability",ti(Yj,wi),Yu.STAT_EVENT="statevent",ti(Kj,wi),Yu.Qa="timingevent",ti(Xj,wi);var nE={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},Qj={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function TO(){}function eZ(){}TO.prototype.h=null;var NO,_p={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function wO(){wi.call(this,"d")}function bO(){wi.call(this,"c")}function rE(){}function vp(n,t,e,r){this.l=n,this.j=t,this.m=e,this.U=r||1,this.S=new pp(this),this.O=$pe,this.T=new Jy(n=oO?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new tZ}function tZ(){this.i=null,this.g="",this.h=!1}ti(wO,wi),ti(bO,wi),ti(rE,TO),rE.prototype.g=function(){return new XMLHttpRequest},rE.prototype.i=function(){return{}},NO=new rE;var $pe=45e3,AO={},sE={};function OO(n,t,e){n.K=1,n.v=cE(il(t)),n.s=e,n.P=!0,nZ(n,null)}function nZ(n,t){n.F=Date.now(),Cp(n),n.A=il(n.v);var e=n.A,r=n.U;Array.isArray(r)||(r=[String(r)]),hZ(e.i,"t",r),n.C=0,e=n.l.H,n.h=new tZ,n.g=DZ(n.l,e?t:null,!n.s),0<n.N&&(n.L=new zpe(Ti(n.La,n,n.g),n.N)),qj(n.S,n.g,"readystatechange",n.ib),t=n.H?Lj(n.H):{},n.s?(n.u||(n.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,t)):(n.u="GET",n.g.da(n.A,n.u,null,t)),gp(),function Vpe(n,t,e,r,s,i){n.info(function(){if(n.g)if(i)for(var o="",c=i.split("&"),u=0;u<c.length;u++){var h=c[u].split("=");if(1<h.length){var g=h[0];h=h[1];var m=g.split("_");o=2<=m.length&&"type"==m[1]?o+(g+"=")+h+"&":o+(g+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+t+"\n"+e+"\n"+o})}(n.j,n.u,n.A,n.m,n.U,n.s)}function rZ(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function sZ(n,t,e){let s,r=!0;for(;!n.I&&n.C<e.length;){if(s=Upe(n,e),s==sE){4==t&&(n.o=4,eo(14),r=!1),D7(n.j,n.m,null,"[Incomplete Response]");break}if(s==AO){n.o=4,eo(15),D7(n.j,n.m,e,"[Invalid Chunk]"),r=!1;break}D7(n.j,n.m,s,null),IO(n,s)}rZ(n)&&s!=sE&&s!=AO&&(n.h.g="",n.C=0),4!=t||0!=e.length||n.h.h||(n.o=1,eo(16),r=!1),n.i=n.i&&r,r?0<e.length&&!n.$&&(n.$=!0,(t=n.l).g==n&&t.$&&!t.K&&(t.j.info("Great, no buffering proxy detected. Bytes received: "+e.length),HO(t),t.K=!0,eo(11))):(D7(n.j,n.m,e,"[Invalid Chunked Response]"),Ku(n),yp(n))}function Upe(n,t){var e=n.C,r=t.indexOf("\n",e);return-1==r?sE:(e=Number(t.substring(e,r)),isNaN(e)?AO:(r+=1)+e>t.length?sE:(t=t.substr(r,e),n.C=r+e,t))}function Cp(n){n.V=Date.now()+n.O,iZ(n,n.O)}function iZ(n,t){if(null!=n.B)throw Error("WatchDog timer not null");n.B=mp(Ti(n.gb,n),t)}function iE(n){n.B&&(dn.clearTimeout(n.B),n.B=null)}function yp(n){0==n.l.G||n.I||xZ(n.l,n)}function Ku(n){iE(n);var t=n.L;t&&"function"==typeof t.na&&t.na(),n.L=null,SO(n.T),jj(n.S),n.g&&(t=n.g,n.g=null,t.abort(),t.na())}function IO(n,t){try{var e=n.l;if(0!=e.G&&(e.g==n||xO(e.h,n)))if(!n.J&&xO(e.h,n)&&3==e.G){try{var r=e.Fa.g.parse(t)}catch{r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!e.u){if(e.g){if(!(e.g.F+3e3<n.F))break e;pE(e),hE(e)}VO(e),eo(18)}}else e.Ba=s[1],0<e.Ba-e.T&&37500>s[2]&&e.L&&0==e.A&&!e.v&&(e.v=mp(Ti(e.cb,e),6e3));if(1>=gZ(e.h)&&e.ja){try{e.ja()}catch{}e.ja=void 0}}else Qu(e,11)}else if((n.J||e.g==n)&&pE(e),!jy(t))for(s=e.Fa.g.parse(t),t=0;t<s.length;t++){let h=s[t];if(e.T=h[0],h=h[1],2==e.G)if("c"==h[0]){e.I=h[1],e.ka=h[2];const g=h[3];null!=g&&(e.ma=g,e.j.info("VER="+e.ma));const m=h[4];null!=m&&(e.Ca=m,e.j.info("SVER="+e.Ca));const v=h[5];null!=v&&"number"==typeof v&&0<v&&(e.J=r=1.5*v,e.j.info("backChannelRequestTimeoutMs_="+r)),r=e;const T=n.g;if(T){const I=T.g?T.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(I){var i=r.h;i.g||-1==I.indexOf("spdy")&&-1==I.indexOf("quic")&&-1==I.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(LO(i,i.h),i.h=null))}if(r.D){const z=T.g?T.g.getResponseHeader("X-HTTP-Session-Id"):null;z&&(r.za=z,Lr(r.F,r.D,z))}}e.G=3,e.l&&e.l.xa(),e.$&&(e.P=Date.now()-n.F,e.j.info("Handshake RTT: "+e.P+"ms"));var o=n;if((r=e).sa=RZ(r,r.H?r.ka:null,r.V),o.J){mZ(r.h,o);var c=o,u=r.J;u&&c.setTimeout(u),c.B&&(iE(c),Cp(c)),r.g=o}else OZ(r);0<e.i.length&&dE(e)}else"stop"!=h[0]&&"close"!=h[0]||Qu(e,7);else 3==e.G&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?Qu(e,7):zO(e):"noop"!=h[0]&&e.l&&e.l.wa(h),e.A=0)}gp()}catch{}}function oZ(n,t){if(n.forEach&&"function"==typeof n.forEach)n.forEach(t,void 0);else if(Wy(n)||"string"==typeof n)Array.prototype.forEach.call(n,t,void 0);else for(var e=function Wpe(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(Wy(n)||"string"==typeof n){var t=[];n=n.length;for(var e=0;e<n;e++)t.push(e);return t}t=[],e=0;for(const r in n)t[e++]=r;return t}}}(n),r=function Gpe(n){if(n.W&&"function"==typeof n.W)return n.W();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(Wy(n)){for(var t=[],e=n.length,r=0;r<e;r++)t.push(n[r]);return t}for(r in t=[],e=0,n)t[e++]=n[r];return t}(n),s=r.length,i=0;i<s;i++)t.call(void 0,r[i],e&&e[i],n)}(wt=vp.prototype).setTimeout=function(n){this.O=n},wt.ib=function(n){n=n.target;const t=this.L;t&&3==ol(n)?t.l():this.La(n)},wt.La=function(n){try{if(n==this.g)e:{const g=ol(this.g);var t=this.g.Ea();if(this.g.aa(),!(3>g)&&(3!=g||oO||this.g&&(this.h.h||this.g.fa()||PZ(this.g)))){this.I||4!=g||7==t||gp(),iE(this);var e=this.g.aa();this.Y=e;t:if(rZ(this)){var r=PZ(this.g);n="";var s=r.length,i=4==ol(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Ku(this),yp(this);var o="";break t}this.h.i=new dn.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,n+=this.h.i.decode(r[t],{stream:i&&t==s-1});r.splice(0,s),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==e,function Hpe(n,t,e,r,s,i,o){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+t+"\n"+e+"\n"+i+" "+o})}(this.j,this.u,this.A,this.m,this.U,g,e),this.i){if(this.Z&&!this.J){t:{if(this.g){var c,u=this.g;if((c=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!jy(c)){var h=c;break t}}h=null}if(!(e=h)){this.i=!1,this.o=3,eo(12),Ku(this),yp(this);break e}D7(this.j,this.m,e,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,IO(this,e)}this.P?(sZ(this,g,o),oO&&this.i&&3==g&&(qj(this.S,this.T,"tick",this.hb),this.T.start())):(D7(this.j,this.m,o,null),IO(this,o)),4==g&&Ku(this),this.i&&!this.I&&(4==g?xZ(this.l,this):(this.i=!1,Cp(this)))}else 400==e&&0<o.indexOf("Unknown SID")?(this.o=3,eo(12)):(this.o=0,eo(13)),Ku(this),yp(this)}}}catch{}},wt.hb=function(){if(this.g){var n=ol(this.g),t=this.g.fa();this.C<t.length&&(iE(this),sZ(this,n,t),this.i&&4!=n&&Cp(this))}},wt.cancel=function(){this.I=!0,Ku(this)},wt.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function Fpe(n,t){n.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(gp(),eo(17)),Ku(this),this.o=2,yp(this)):iZ(this,this.V-n)};var aZ=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Xu(n,t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Xu){this.h=void 0!==t?t:n.h,oE(this,n.j),this.s=n.s,this.g=n.g,aE(this,n.m),this.l=n.l,t=n.i;var e=new Sp;e.i=t.i,t.g&&(e.g=new Map(t.g),e.h=t.h),cZ(this,e),this.o=n.o}else n&&(e=String(n).match(aZ))?(this.h=!!t,oE(this,e[1]||"",!0),this.s=Ep(e[2]||""),this.g=Ep(e[3]||"",!0),aE(this,e[4]),this.l=Ep(e[5]||"",!0),cZ(this,e[6]||"",!0),this.o=Ep(e[7]||"")):(this.h=!!t,this.i=new Sp(null,this.h))}function il(n){return new Xu(n)}function oE(n,t,e){n.j=e?Ep(t,!0):t,n.j&&(n.j=n.j.replace(/:$/,""))}function aE(n,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);n.m=t}else n.m=null}function cZ(n,t,e){t instanceof Sp?(n.i=t,function Qpe(n,t){t&&!n.j&&(G6(n),n.i=null,n.g.forEach(function(e,r){var s=r.toLowerCase();r!=s&&(uZ(this,r),hZ(this,s,e))},n)),n.j=t}(n.i,n.h)):(e||(t=Mp(t,Kpe)),n.i=new Sp(t,n.h))}function Lr(n,t,e){n.i.set(t,e)}function cE(n){return Lr(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Ep(n,t){return n?t?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function Mp(n,t,e){return"string"==typeof n?(n=encodeURI(n).replace(t,jpe),e&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function jpe(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Xu.prototype.toString=function(){var n=[],t=this.j;t&&n.push(Mp(t,lZ,!0),":");var e=this.g;return(e||"file"==t)&&(n.push("//"),(t=this.s)&&n.push(Mp(t,lZ,!0),"@"),n.push(encodeURIComponent(String(e)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(e=this.m)&&n.push(":",String(e))),(e=this.l)&&(this.g&&"/"!=e.charAt(0)&&n.push("/"),n.push(Mp(e,"/"==e.charAt(0)?Ype:Zpe,!0))),(e=this.i.toString())&&n.push("?",e),(e=this.o)&&n.push("#",Mp(e,Xpe)),n.join("")};var lZ=/[#\/\?@]/g,Zpe=/[#\?:]/g,Ype=/[#\?]/g,Kpe=/[#\?@]/g,Xpe=/#/g;function Sp(n,t){this.h=this.g=null,this.i=n||null,this.j=!!t}function G6(n){n.g||(n.g=new Map,n.h=0,n.i&&function qpe(n,t){if(n){n=n.split("&");for(var e=0;e<n.length;e++){var r=n[e].indexOf("="),s=null;if(0<=r){var i=n[e].substring(0,r);s=n[e].substring(r+1)}else i=n[e];t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(n.i,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function uZ(n,t){G6(n),t=z7(n,t),n.g.has(t)&&(n.i=null,n.h-=n.g.get(t).length,n.g.delete(t))}function fZ(n,t){return G6(n),t=z7(n,t),n.g.has(t)}function hZ(n,t,e){uZ(n,t),0<e.length&&(n.i=null,n.g.set(z7(n,t),rO(e)),n.h+=e.length)}function z7(n,t){return t=String(t),n.j&&(t=t.toLowerCase()),t}function dZ(n){this.l=n||ege,n=dn.PerformanceNavigationTiming?0<(n=dn.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(dn.g&&dn.g.Ga&&dn.g.Ga()&&dn.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(wt=Sp.prototype).add=function(n,t){G6(this),this.i=null,n=z7(this,n);var e=this.g.get(n);return e||this.g.set(n,e=[]),e.push(t),this.h+=1,this},wt.forEach=function(n,t){G6(this),this.g.forEach(function(e,r){e.forEach(function(s){n.call(t,s,r,this)},this)},this)},wt.oa=function(){G6(this);const n=Array.from(this.g.values()),t=Array.from(this.g.keys()),e=[];for(let r=0;r<t.length;r++){const s=n[r];for(let i=0;i<s.length;i++)e.push(t[r])}return e},wt.W=function(n){G6(this);let t=[];if("string"==typeof n)fZ(this,n)&&(t=t.concat(this.g.get(z7(this,n))));else{n=Array.from(this.g.values());for(let e=0;e<n.length;e++)t=t.concat(n[e])}return t},wt.set=function(n,t){return G6(this),this.i=null,fZ(this,n=z7(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[t]),this.h+=1,this},wt.get=function(n,t){return n&&0<(n=this.W(n)).length?String(n[0]):t},wt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],t=Array.from(this.g.keys());for(var e=0;e<t.length;e++){var r=t[e];const i=encodeURIComponent(String(r)),o=this.W(r);for(r=0;r<o.length;r++){var s=i;""!==o[r]&&(s+="="+encodeURIComponent(String(o[r]))),n.push(s)}}return this.i=n.join("&")};var ege=10;function pZ(n){return!!n.h||!!n.g&&n.g.size>=n.j}function gZ(n){return n.h?1:n.g?n.g.size:0}function xO(n,t){return n.h?n.h==t:!!n.g&&n.g.has(t)}function LO(n,t){n.g?n.g.add(t):n.h=t}function mZ(n,t){n.h&&n.h==t?n.h=null:n.g&&n.g.has(t)&&n.g.delete(t)}function _Z(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let t=n.i;for(const e of n.g.values())t=t.concat(e.D);return t}return rO(n.i)}function kO(){}function tge(){this.g=new kO}function nge(n,t,e){const r=e||"";try{oZ(n,function(s,i){let o=s;fp(s)&&(o=yO(s)),t.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw t.push(r+"type="+encodeURIComponent("_badmap")),s}}function lE(n,t,e,r,s){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,s(r)}catch{}}function Pp(n){this.l=n.ac||null,this.j=n.jb||!1}function uE(n,t){S2.call(this),this.D=n,this.u=t,this.m=void 0,this.readyState=RO,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}dZ.prototype.cancel=function(){if(this.i=_Z(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},kO.prototype.stringify=function(n){return dn.JSON.stringify(n,void 0)},kO.prototype.parse=function(n){return dn.JSON.parse(n,void 0)},ti(Pp,TO),Pp.prototype.g=function(){return new uE(this.l,this.j)},Pp.prototype.i=function(n){return function(){return n}}({}),ti(uE,S2);var RO=0;function vZ(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function Tp(n){n.readyState=4,n.l=null,n.j=null,n.A=null,wp(n)}function wp(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(wt=uE.prototype).open=function(n,t){if(this.readyState!=RO)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=t,this.readyState=1,wp(this)},wt.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(t.body=n),(this.D||dn).fetch(new Request(this.B,t)).then(this.Wa.bind(this),this.ga.bind(this))},wt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Tp(this)),this.readyState=RO},wt.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,wp(this)),this.g&&(this.readyState=3,wp(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof dn.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;vZ(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},wt.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var t=n.value?n.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!n.done}))&&(this.response=this.responseText+=t)}n.done?Tp(this):wp(this),3==this.readyState&&vZ(this)}},wt.Va=function(n){this.g&&(this.response=this.responseText=n,Tp(this))},wt.Ua=function(n){this.g&&(this.response=n,Tp(this))},wt.ga=function(){this.g&&Tp(this)},wt.setRequestHeader=function(n,t){this.v.append(n,t)},wt.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},wt.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],t=this.h.entries();for(var e=t.next();!e.done;)n.push((e=e.value)[0]+": "+e[1]),e=t.next();return n.join("\r\n")},Object.defineProperty(uE.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var sge=dn.JSON.parse;function rs(n){S2.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=CZ,this.K=this.L=!1}ti(rs,S2);var CZ="",ige=/^https?$/i,oge=["POST","PUT"];function yZ(n,t){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=t,n.m=5,EZ(n),fE(n)}function EZ(n){n.D||(n.D=!0,ni(n,"complete"),ni(n,"error"))}function MZ(n){if(n.h&&typeof tO<"u"&&(!n.C[1]||4!=ol(n)||2!=n.aa()))if(n.v&&4==ol(n))PO(n.Ha,0,n);else if(ni(n,"readystatechange"),4==ol(n)){n.h=!1;try{const c=n.aa();e:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var e;if(!(e=t)){var r;if(r=0===c){var s=String(n.H).match(aZ)[1]||null;if(!s&&dn.self&&dn.self.location){var i=dn.self.location.protocol;s=i.substr(0,i.length-1)}r=!ige.test(s?s.toLowerCase():"")}e=r}if(e)ni(n,"complete"),ni(n,"success");else{n.m=6;try{var o=2<ol(n)?n.g.statusText:""}catch{o=""}n.j=o+" ["+n.aa()+"]",EZ(n)}}finally{fE(n)}}}function fE(n,t){if(n.g){SZ(n);const e=n.g,r=n.C[0]?Gy:null;n.g=null,n.C=null,t||ni(n,"ready");try{e.onreadystatechange=r}catch{}}}function SZ(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(dn.clearTimeout(n.A),n.A=null)}function ol(n){return n.g?n.g.readyState:0}function PZ(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case CZ:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function TZ(n){let t="";return fO(n,function(e,r){t+=r,t+=":",t+=e,t+="\r\n"}),t}function DO(n,t,e){e:{for(r in e){var r=!1;break e}r=!0}r||(e=TZ(e),"string"==typeof n?null!=e&&encodeURIComponent(String(e)):Lr(n,t,e))}function bp(n,t,e){return e&&e.internalChannelParams&&e.internalChannelParams[n]||t}function wZ(n){this.Ca=0,this.i=[],this.j=new eE,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=bp("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=bp("baseRetryDelayMs",5e3,n),this.bb=bp("retryDelaySeedMs",1e4,n),this.$a=bp("forwardChannelMaxRetries",2,n),this.ta=bp("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new dZ(n&&n.concurrentRequestLimit),this.Fa=new tge,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function zO(n){if(bZ(n),3==n.G){var t=n.U++,e=il(n.F);Lr(e,"SID",n.I),Lr(e,"RID",t),Lr(e,"TYPE","terminate"),Np(n,e),(t=new vp(n,n.j,t,void 0)).K=2,t.v=cE(il(e)),e=!1,dn.navigator&&dn.navigator.sendBeacon&&(e=dn.navigator.sendBeacon(t.v.toString(),"")),!e&&dn.Image&&((new Image).src=t.v,e=!0),e||(t.g=DZ(t.l,null),t.g.da(t.v)),t.F=Date.now(),Cp(t)}kZ(n)}function hE(n){n.g&&(HO(n),n.g.cancel(),n.g=null)}function bZ(n){hE(n),n.u&&(dn.clearTimeout(n.u),n.u=null),pE(n),n.h.cancel(),n.m&&("number"==typeof n.m&&dn.clearTimeout(n.m),n.m=null)}function dE(n){pZ(n.h)||n.m||(n.m=!0,$j(n.Ja,n),n.C=0)}function NZ(n,t){var e;e=t?t.m:n.U++;const r=il(n.F);Lr(r,"SID",n.I),Lr(r,"RID",e),Lr(r,"AID",n.T),Np(n,r),n.o&&n.s&&DO(r,n.o,n.s),e=new vp(n,n.j,e,n.C+1),null===n.o&&(e.H=n.s),t&&(n.i=t.D.concat(n.i)),t=AZ(n,e,1e3),e.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),LO(n.h,e),OO(e,r,t)}function Np(n,t){n.ia&&fO(n.ia,function(e,r){Lr(t,r,e)}),n.l&&oZ({},function(e,r){Lr(t,r,e)})}function AZ(n,t,e){e=Math.min(n.i.length,e);var r=n.l?Ti(n.l.Ra,n.l,n):null;e:{var s=n.i;let i=-1;for(;;){const o=["count="+e];-1==i?0<e?(i=s[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let c=!0;for(let u=0;u<e;u++){let h=s[u].h;const g=s[u].g;if(h-=i,0>h)i=Math.max(0,s[u].h-100),c=!1;else try{nge(g,o,"req"+h+"_")}catch{r&&r(g)}}if(c){r=o.join("&");break e}}}return n=n.i.splice(0,e),t.D=n,r}function OZ(n){n.g||n.u||(n.Z=1,$j(n.Ia,n),n.A=0)}function VO(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=mp(Ti(n.Ia,n),LZ(n,n.A)),n.A++,0))}function HO(n){null!=n.B&&(dn.clearTimeout(n.B),n.B=null)}function IZ(n){n.g=new vp(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var t=il(n.sa);Lr(t,"RID","rpc"),Lr(t,"SID",n.I),Lr(t,"CI",n.L?"0":"1"),Lr(t,"AID",n.T),Lr(t,"TYPE","xmlhttp"),Np(n,t),n.o&&n.s&&DO(t,n.o,n.s),n.J&&n.g.setTimeout(n.J);var e=n.g;n=n.ka,e.K=1,e.v=cE(il(t)),e.s=null,e.P=!0,nZ(e,n)}function pE(n){null!=n.v&&(dn.clearTimeout(n.v),n.v=null)}function xZ(n,t){var e=null;if(n.g==t){pE(n),HO(n),n.g=null;var r=2}else{if(!xO(n.h,t))return;e=t.D,mZ(n.h,t),r=1}if(0!=n.G)if(n.pa=t.Y,t.i)if(1==r){e=t.s?t.s.length:0,t=Date.now()-t.F;var s=n.C;ni(r=tE(),new Xj(r,e)),dE(n)}else OZ(n);else if(3==(s=t.o)||0==s&&0<n.pa||!(1==r&&function cge(n,t){return!(gZ(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=t.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=mp(Ti(n.Ja,n,t),LZ(n,n.C)),n.C++,0)))}(n,t)||2==r&&VO(n)))switch(e&&0<e.length&&(t=n.h,t.i=t.i.concat(e)),s){case 1:Qu(n,5);break;case 4:Qu(n,10);break;case 3:Qu(n,6);break;default:Qu(n,2)}}function LZ(n,t){let e=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(e*=2),e*t}function Qu(n,t){if(n.j.info("Error code "+t),2==t){var e=null;n.l&&(e=null);var r=Ti(n.kb,n);e||(e=new Xu("//www.google.com/images/cleardot.gif"),dn.location&&"http"==dn.location.protocol||oE(e,"https"),cE(e)),function rge(n,t){const e=new eE;if(dn.Image){const r=new Image;r.onload=qy(lE,e,r,"TestLoadImage: loaded",!0,t),r.onerror=qy(lE,e,r,"TestLoadImage: error",!1,t),r.onabort=qy(lE,e,r,"TestLoadImage: abort",!1,t),r.ontimeout=qy(lE,e,r,"TestLoadImage: timeout",!1,t),dn.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else t(!1)}(e.toString(),r)}else eo(2);n.G=0,n.l&&n.l.va(t),kZ(n),bZ(n)}function kZ(n){if(n.G=0,n.la=[],n.l){const t=_Z(n.h);(0!=t.length||0!=n.i.length)&&(bj(n.la,t),bj(n.la,n.i),n.h.i.length=0,rO(n.i),n.i.length=0),n.l.ua()}}function RZ(n,t,e){var r=e instanceof Xu?il(e):new Xu(e,void 0);if(""!=r.g)t&&(r.g=t+"."+r.g),aE(r,r.m);else{var s=dn.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var i=new Xu(null,void 0);r&&oE(i,r),t&&(i.g=t),s&&aE(i,s),e&&(i.l=e),r=i}return t=n.za,(e=n.D)&&t&&Lr(r,e,t),Lr(r,"VER",n.ma),Np(n,r),r}function DZ(n,t,e){if(t&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new rs(e&&n.Da&&!n.ra?new Pp({jb:!0}):n.ra)).Ka(n.H),t}function zZ(){}function gE(){if(R7&&!(10<=Number(Tpe)))throw Error("Environmental error: no available transport.")}function da(n,t){S2.call(this),this.g=new wZ(t),this.l=n,this.h=t&&t.messageUrlParams||null,n=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(n?n["X-WebChannel-Content-Type"]=t.messageContentType:n={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(n?n["X-WebChannel-Client-Profile"]=t.ya:n={"X-WebChannel-Client-Profile":t.ya}),this.g.S=n,(n=t&&t.Yb)&&!jy(n)&&(this.g.o=n),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!jy(t)&&(this.g.D=t,null!==(n=this.h)&&t in n&&t in(n=this.h)&&delete n[t]),this.j=new V7(this)}function VZ(n){wO.call(this);var t=n.__sm__;if(t){e:{for(const e in t){n=e;break e}n=void 0}(this.i=n)&&(n=this.i,t=null!==t&&n in t?t[n]:void 0),this.data=t}else this.data=n}function HZ(){bO.call(this),this.status=1}function V7(n){this.g=n}(wt=rs.prototype).Ka=function(n){this.L=n},wt.da=function(n,t,e,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);t=t?t.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():NO.g(),this.C=function Jj(n){return n.h||(n.h=n.i())}(this.u?this.u:NO),this.g.onreadystatechange=Ti(this.Ha,this);try{this.F=!0,this.g.open(t,String(n),!0),this.F=!1}catch(i){return void yZ(this,i)}if(n=e||"",e=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)e.set(s,r[s]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const i of r.keys())e.set(i,r.get(i))}r=Array.from(e.keys()).find(i=>"content-type"==i.toLowerCase()),s=dn.FormData&&n instanceof dn.FormData,!(0<=wj(oge,t))||r||s||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of e)this.g.setRequestHeader(i,o);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{SZ(this),0<this.B&&((this.K=function age(n){return R7&&function Ppe(){return function ype(n){var t=Spe;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=n(9)}(function(){let n=0;const t=Nj(String(Yy)).split("."),e=Nj("9").split("."),r=Math.max(t.length,e.length);for(let o=0;0==n&&o<r;o++){var s=t[o]||"",i=e[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],0==s[0].length&&0==i[0].length)break;n=sO(0==s[1].length?0:parseInt(s[1],10),0==i[1].length?0:parseInt(i[1],10))||sO(0==s[2].length,0==i[2].length)||sO(s[2],i[2]),s=s[3],i=i[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ti(this.qa,this)):this.A=PO(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(i){yZ(this,i)}},wt.qa=function(){typeof tO<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ni(this,"timeout"),this.abort(8))},wt.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,ni(this,"complete"),ni(this,"abort"),fE(this))},wt.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),fE(this,!0)),rs.X.M.call(this)},wt.Ha=function(){this.s||(this.F||this.v||this.l?MZ(this):this.fb())},wt.fb=function(){MZ(this)},wt.aa=function(){try{return 2<ol(this)?this.g.status:-1}catch{return-1}},wt.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}},wt.Sa=function(n){if(this.g){var t=this.g.responseText;return n&&0==t.indexOf(n)&&(t=t.substring(n.length)),sge(t)}},wt.Ea=function(){return this.m},wt.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(wt=wZ.prototype).ma=8,wt.G=1,wt.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const s=new vp(this,this.j,n,void 0);let i=this.s;if(this.S&&(i?(i=Lj(i),Rj(i,this.S)):i=this.S),null!==this.o||this.N||(s.H=i,i=null),this.O)e:{for(var t=0,e=0;e<this.i.length;e++){var r=this.i[e];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=e;break e}if(4096===t||e===this.i.length-1){t=e+1;break e}}t=1e3}else t=1e3;t=AZ(this,s,t),Lr(e=il(this.F),"RID",n),Lr(e,"CVER",22),this.D&&Lr(e,"X-HTTP-Session-Id",this.D),Np(this,e),i&&(this.N?t="headers="+encodeURIComponent(String(TZ(i)))+"&"+t:this.o&&DO(e,this.o,i)),LO(this.h,s),this.Ya&&Lr(e,"TYPE","init"),this.O?(Lr(e,"$req",t),Lr(e,"SID","null"),s.Z=!0,OO(s,e,null)):OO(s,e,t),this.G=2}}else 3==this.G&&(n?NZ(this,n):0==this.i.length||pZ(this.h)||NZ(this))},wt.Ia=function(){if(this.u=null,IZ(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=mp(Ti(this.eb,this),n)}},wt.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,eo(10),hE(this),IZ(this))},wt.cb=function(){null!=this.v&&(this.v=null,hE(this),VO(this),eo(19))},wt.kb=function(n){n?(this.j.info("Successfully pinged google.com"),eo(2)):(this.j.info("Failed to ping google.com"),eo(1))},(wt=zZ.prototype).xa=function(){},wt.wa=function(){},wt.va=function(){},wt.ua=function(){},wt.Ra=function(){},gE.prototype.g=function(n,t){return new da(n,t)},ti(da,S2),da.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,t=this.l,e=this.h||void 0;eo(0),n.V=t,n.ia=e||{},n.L=n.Y,n.F=RZ(n,null,n.V),dE(n)},da.prototype.close=function(){zO(this.g)},da.prototype.u=function(n){var t=this.g;if("string"==typeof n){var e={};e.__data__=n,n=e}else this.v&&((e={}).__data__=yO(n),n=e);t.i.push(new class{constructor(n,t){this.h=n,this.g=t}}(t.ab++,n)),3==t.G&&dE(t)},da.prototype.M=function(){this.g.l=null,delete this.j,zO(this.g),delete this.g,da.X.M.call(this)},ti(VZ,wO),ti(HZ,bO),ti(V7,zZ),V7.prototype.xa=function(){ni(this.g,"a")},V7.prototype.wa=function(n){ni(this.g,new VZ(n))},V7.prototype.va=function(n){ni(this.g,new HZ)},V7.prototype.ua=function(){ni(this.g,"b")},gE.prototype.createWebChannel=gE.prototype.g,da.prototype.send=da.prototype.u,da.prototype.open=da.prototype.m,da.prototype.close=da.prototype.close,nE.NO_ERROR=0,nE.TIMEOUT=8,nE.HTTP_ERROR=6,Qj.COMPLETE="complete",eZ.EventType=_p,_p.OPEN="a",_p.CLOSE="b",_p.ERROR="c",_p.MESSAGE="d",S2.prototype.listen=S2.prototype.N,rs.prototype.listenOnce=rs.prototype.O,rs.prototype.getLastError=rs.prototype.Oa,rs.prototype.getLastErrorCode=rs.prototype.Ea,rs.prototype.getStatus=rs.prototype.aa,rs.prototype.getResponseJson=rs.prototype.Sa,rs.prototype.getResponseText=rs.prototype.fa,rs.prototype.send=rs.prototype.da,rs.prototype.setWithCredentials=rs.prototype.Ka;var lge=sl.createWebChannelTransport=function(){return new gE},uge=sl.getStatEventTarget=function(){return tE()},FO=sl.ErrorCode=nE,fge=sl.EventType=Qj,hge=sl.Event=Yu,FZ=sl.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},dge=sl.FetchXmlHttpFactory=Pp,mE=sl.WebChannel=eZ,pge=sl.XhrIo=rs;const BZ="@firebase/firestore";class P2{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}P2.UNAUTHENTICATED=new P2(null),P2.GOOGLE_CREDENTIALS=new P2("google-credentials-uid"),P2.FIRST_PARTY=new P2("first-party-uid"),P2.MOCK_USER=new P2("mock-user");let H7="9.14.0";const W6=new x7("@firebase/firestore");function BO(){return W6.logLevel}function Be(n,...t){if(W6.logLevel<=u1.DEBUG){const e=t.map($O);W6.debug(`Firestore (${H7}): ${n}`,...e)}}function _s(n,...t){if(W6.logLevel<=u1.ERROR){const e=t.map($O);W6.error(`Firestore (${H7}): ${n}`,...e)}}function F7(n,...t){if(W6.logLevel<=u1.WARN){const e=t.map($O);W6.warn(`Firestore (${H7}): ${n}`,...e)}}function $O(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function St(n="Unexpected state"){const t=`FIRESTORE (${H7}) INTERNAL ASSERTION FAILED: `+n;throw _s(t),new Error(t)}function Qt(n,t){n||St()}function st(n,t){return n}const Me={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ve extends Qa{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class e2{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class $Z{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class gge{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(P2.UNAUTHENTICATED))}shutdown(){}}class mge{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class _ge{constructor(t){this.t=t,this.currentUser=P2.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){var r=this;let s=this.i;const i=h=>this.i!==s?(s=this.i,e(h)):Promise.resolve();let o=new e2;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new e2,t.enqueueRetryable(()=>i(this.currentUser))};const c=()=>{const h=o;t.enqueueRetryable(O(function*(){yield h.promise,yield i(r.currentUser)}))},u=h=>{Be("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),c()};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(Be("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new e2)}},0),c()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(r=>this.i!==t?(Be("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Qt("string"==typeof r.accessToken),new $Z(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Qt(null===t||"string"==typeof t),new P2(t)}}class vge{constructor(t,e,r,s){this.h=t,this.l=e,this.m=r,this.g=s,this.type="FirstParty",this.user=P2.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(Qt(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.p.set("Authorization",t),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class Cge{constructor(t,e,r,s){this.h=t,this.l=e,this.m=r,this.g=s}getToken(){return Promise.resolve(new vge(this.h,this.l,this.m,this.g))}start(t,e){t.enqueueRetryable(()=>e(P2.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class UZ{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class yge{constructor(t){this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(t,e){const r=i=>{null!=i.error&&Be("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.A;return this.A=i.token,Be("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?e(i.token):Promise.resolve()};this.o=i=>{t.enqueueRetryable(()=>r(i))};const s=i=>{Be("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.T.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.T.getImmediate({optional:!0});i?s(i):Be("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(Qt("string"==typeof e.token),this.A=e.token,new UZ(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Ege(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(let r=0;r<n;r++)e[r]=Math.floor(256*Math.random());return e}class GZ{static R(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let r="";for(;r.length<20;){const s=Ege(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<e&&(r+=t.charAt(s[i]%t.length))}return r}}function pn(n,t){return n<t?-1:n>t?1:0}function B7(n,t,e){return n.length===t.length&&n.every((r,s)=>e(r,t[s]))}class qr{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Ve(Me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Ve(Me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ve(Me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ve(Me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return qr.fromMillis(Date.now())}static fromDate(t){return qr.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),r=Math.floor(1e6*(t-1e3*e));return new qr(e,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?pn(this.nanoseconds,t.nanoseconds):pn(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Jt{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Jt(t)}static min(){return new Jt(new qr(0,0))}static max(){return new Jt(new qr(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Ap{constructor(t,e,r){void 0===e?e=0:e>t.length&&St(),void 0===r?r=t.length-e:r>t.length-e&&St(),this.segments=t,this.offset=e,this.len=r}get length(){return this.len}isEqual(t){return 0===Ap.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Ap?t.forEach(r=>{e.push(r)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,r=this.limit();e<r;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const r=Math.min(t.length,e.length);for(let s=0;s<r;s++){const i=t.get(s),o=e.get(s);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class f1 extends Ap{construct(t,e,r){return new f1(t,e,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const r of t){if(r.indexOf("//")>=0)throw new Ve(Me.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);e.push(...r.split("/").filter(s=>s.length>0))}return new f1(e)}static emptyPath(){return new f1([])}}const Mge=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class vs extends Ap{construct(t,e,r){return new vs(t,e,r)}static isValidIdentifier(t){return Mge.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),vs.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new vs(["__name__"])}static fromServerFormat(t){const e=[];let r="",s=0;const i=()=>{if(0===r.length)throw new Ve(Me.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(r),r=""};let o=!1;for(;s<t.length;){const c=t[s];if("\\"===c){if(s+1===t.length)throw new Ve(Me.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const u=t[s+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ve(Me.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,s+=2}else"`"===c?(o=!o,s++):"."!==c||o?(r+=c,s++):(i(),s++)}if(i(),o)throw new Ve(Me.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new vs(e)}static emptyPath(){return new vs([])}}class tt{constructor(t){this.path=t}static fromPath(t){return new tt(f1.fromString(t))}static fromName(t){return new tt(f1.fromString(t).popFirst(5))}static empty(){return new tt(f1.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===f1.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return f1.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new tt(new f1(t.slice()))}}function jZ(n){return new pa(n.readTime,n.key,-1)}class pa{constructor(t,e,r){this.readTime=t,this.documentKey=e,this.largestBatchId=r}static min(){return new pa(Jt.min(),tt.empty(),-1)}static max(){return new pa(Jt.max(),tt.empty(),-1)}}function GO(n,t){let e=n.readTime.compareTo(t.readTime);return 0!==e?e:(e=tt.comparator(n.documentKey,t.documentKey),0!==e?e:pn(n.largestBatchId,t.largestBatchId))}const ZZ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";function q6(n){return WO.apply(this,arguments)}function WO(){return WO=O(function*(n){if(n.code!==Me.FAILED_PRECONDITION||n.message!==ZZ)throw n;Be("LocalStore","Unexpectedly lost primary lease")}),WO.apply(this,arguments)}class ve{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&St(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new ve((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(t,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(e,i).next(r,s)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof ve?e:ve.resolve(e)}catch(e){return ve.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):ve.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):ve.reject(e)}static resolve(t){return new ve((e,r)=>{e(t)})}static reject(t){return new ve((e,r)=>{r(t)})}static waitFor(t){return new ve((e,r)=>{let s=0,i=0,o=!1;t.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&e()},u=>r(u))}),o=!0,i===s&&e()})}static or(t){let e=ve.resolve(!1);for(const r of t)e=e.next(s=>s?ve.resolve(s):r());return e}static forEach(t,e){const r=[];return t.forEach((s,i)=>{r.push(e.call(this,s,i))}),this.waitFor(r)}static mapArray(t,e){return new ve((r,s)=>{const i=t.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const h=u;e(t[h]).next(g=>{o[h]=g,++c,c===i&&r(o)},g=>s(g))}})}static doWhile(t,e){return new ve((r,s)=>{const i=()=>{!0===t()?e().next(()=>{i()},s):r()};i()})}}function j6(n){return"IndexedDbTransactionError"===n.name}class Ro{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=r=>this.ut(r),this.ct=r=>e.writeSequenceNumber(r))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}function KZ(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function t8(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function XZ(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}Ro.at=-1;class ss{constructor(t,e){this.comparator=t,this.root=e||ri.EMPTY}insert(t,e){return new ss(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,ri.BLACK,null,null))}remove(t){return new ss(this.comparator,this.root.remove(t,this.comparator).copy(null,null,ri.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const r=this.comparator(t,e.key);if(0===r)return e.value;r<0?e=e.left:r>0&&(e=e.right)}return null}indexOf(t){let e=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(t,r.key);if(0===s)return e+r.left.size;s<0?r=r.left:(e+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,r)=>(t(e,r),!1))}toString(){const t=[];return this.inorderTraversal((e,r)=>(t.push(`${e}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new yE(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new yE(this.root,t,this.comparator,!1)}getReverseIterator(){return new yE(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new yE(this.root,t,this.comparator,!0)}}class yE{constructor(t,e,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?r(t.key,e):1,e&&s&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class ri{constructor(t,e,r,s,i){this.key=t,this.value=e,this.color=r??ri.RED,this.left=s??ri.EMPTY,this.right=i??ri.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,r,s,i){return new ri(t??this.key,e??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,r){let s=this;const i=r(t,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(t,e,r),null):0===i?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ri.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let r,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),0===e(t,s.key)){if(s.right.isEmpty())return ri.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,ri.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,ri.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw St();const t=this.left.check();if(t!==this.right.check())throw St();return t+(this.isRed()?0:1)}}ri.EMPTY=null,ri.RED=!0,ri.BLACK=!1,ri.EMPTY=new class{constructor(){this.size=0}get key(){throw St()}get value(){throw St()}get color(){throw St()}get left(){throw St()}get right(){throw St()}copy(n,t,e,r,s){return this}insert(n,t,e){return new ri(n,t)}remove(n,t){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class j1{constructor(t){this.comparator=t,this.data=new ss(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,r)=>(t(e),!1))}forEachInRange(t,e){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let r;for(r=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new QZ(this.data.getIterator())}getIteratorFrom(t){return new QZ(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(r=>{e=e.add(r)}),e}isEqual(t){if(!(t instanceof j1)||this.size!==t.size)return!1;const e=this.data.getIterator(),r=t.data.getIterator();for(;e.hasNext();){const s=e.getNext().key,i=r.getNext().key;if(0!==this.comparator(s,i))return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new j1(this.comparator);return e.data=t,e}}class QZ{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ga{constructor(t){this.fields=t,t.sort(vs.comparator)}static empty(){return new ga([])}unionWith(t){let e=new j1(vs.comparator);for(const r of this.fields)e=e.add(r);for(const r of t)e=e.add(r);return new ga(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return B7(this.fields,t.fields,(e,r)=>e.isEqual(r))}}class t2{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new t2(e)}static fromUint8Array(t){const e=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(t);return new t2(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return pn(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}t2.EMPTY_BYTE_STRING=new t2("");const Oge=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Z6(n){if(Qt(!!n),"string"==typeof n){let t=0;const e=Oge.exec(n);if(Qt(!!e),e[1]){let s=e[1];s=(s+"000000000").substr(0,9),t=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:is(n.seconds),nanos:is(n.nanos)}}function is(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function n8(n){return"string"==typeof n?t2.fromBase64String(n):t2.fromUint8Array(n)}function jO(n){var t,e;return"server_timestamp"===(null===(e=((null===(t=n?.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===e?void 0:e.stringValue)}function JZ(n){const t=n.mapValue.fields.__previous_value__;return jO(t)?JZ(t):t}function xp(n){const t=Z6(n.mapValue.fields.__local_write_time__.timestampValue);return new qr(t.seconds,t.nanos)}class Ige{constructor(t,e,r,s,i,o,c,u){this.databaseId=t,this.appId=e,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.useFetchStreams=u}}class r8{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new r8("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof r8&&t.projectId===this.projectId&&t.database===this.database}}function Lp(n){return null==n}function kp(n){return 0===n&&1/n==-1/0}const Y6_mapValue={fields:{__type__:{stringValue:"__max__"}}};function s8(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?jO(n)?4:sY(n)?9007199254740991:10:St()}function Z3(n,t){if(n===t)return!0;const e=s8(n);if(e!==s8(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return xp(n).isEqual(xp(t));case 3:return function(r,s){if("string"==typeof r.timestampValue&&"string"==typeof s.timestampValue&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=Z6(r.timestampValue),o=Z6(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return s=t,n8(n.bytesValue).isEqual(n8(s.bytesValue));case 7:return n.referenceValue===t.referenceValue;case 8:return function(r,s){return is(r.geoPointValue.latitude)===is(s.geoPointValue.latitude)&&is(r.geoPointValue.longitude)===is(s.geoPointValue.longitude)}(n,t);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return is(r.integerValue)===is(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=is(r.doubleValue),o=is(s.doubleValue);return i===o?kp(i)===kp(o):isNaN(i)&&isNaN(o)}return!1}(n,t);case 9:return B7(n.arrayValue.values||[],t.arrayValue.values||[],Z3);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(KZ(i)!==KZ(o))return!1;for(const c in i)if(i.hasOwnProperty(c)&&(void 0===o[c]||!Z3(i[c],o[c])))return!1;return!0}(n,t);default:return St()}var s}function Rp(n,t){return void 0!==(n.values||[]).find(e=>Z3(e,t))}function K6(n,t){if(n===t)return 0;const e=s8(n),r=s8(t);if(e!==r)return pn(e,r);switch(e){case 0:case 9007199254740991:return 0;case 1:return pn(n.booleanValue,t.booleanValue);case 2:return function(s,i){const o=is(s.integerValue||s.doubleValue),c=is(i.integerValue||i.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(n,t);case 3:return tY(n.timestampValue,t.timestampValue);case 4:return tY(xp(n),xp(t));case 5:return pn(n.stringValue,t.stringValue);case 6:return function(s,i){const o=n8(s),c=n8(i);return o.compareTo(c)}(n.bytesValue,t.bytesValue);case 7:return function(s,i){const o=s.split("/"),c=i.split("/");for(let u=0;u<o.length&&u<c.length;u++){const h=pn(o[u],c[u]);if(0!==h)return h}return pn(o.length,c.length)}(n.referenceValue,t.referenceValue);case 8:return function(s,i){const o=pn(is(s.latitude),is(i.latitude));return 0!==o?o:pn(is(s.longitude),is(i.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return function(s,i){const o=s.values||[],c=i.values||[];for(let u=0;u<o.length&&u<c.length;++u){const h=K6(o[u],c[u]);if(h)return h}return pn(o.length,c.length)}(n.arrayValue,t.arrayValue);case 10:return function(s,i){if(s===Y6_mapValue&&i===Y6_mapValue)return 0;if(s===Y6_mapValue)return 1;if(i===Y6_mapValue)return-1;const o=s.fields||{},c=Object.keys(o),u=i.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let g=0;g<c.length&&g<h.length;++g){const m=pn(c[g],h[g]);if(0!==m)return m;const v=K6(o[c[g]],u[h[g]]);if(0!==v)return v}return pn(c.length,h.length)}(n.mapValue,t.mapValue);default:throw St()}}function tY(n,t){if("string"==typeof n&&"string"==typeof t&&n.length===t.length)return pn(n,t);const e=Z6(n),r=Z6(t),s=pn(e.seconds,r.seconds);return 0!==s?s:pn(e.nanos,r.nanos)}function U7(n){return ZO(n)}function ZO(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const s=Z6(r);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?n8(n.bytesValue).toBase64():"referenceValue"in n?tt.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(t=n.geoPointValue).latitude},${t.longitude})`:"arrayValue"in n?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=ZO(o);return s+"]"}(n.arrayValue):"mapValue"in n?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const c of s)o?o=!1:i+=",",i+=`${c}:${ZO(r.fields[c])}`;return i+"}"}(n.mapValue):St();var t}function i8(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function YO(n){return!!n&&"integerValue"in n}function Dp(n){return!!n&&"arrayValue"in n}function nY(n){return!!n&&"nullValue"in n}function rY(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ME(n){return!!n&&"mapValue"in n}function zp(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const t={mapValue:{fields:{}}};return t8(n.mapValue.fields,(e,r)=>t.mapValue.fields[e]=zp(r)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=zp(n.arrayValue.values[e]);return t}return Object.assign({},n)}function sY(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}class si{constructor(t){this.value=t}static empty(){return new si({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let r=0;r<t.length-1;++r)if(e=(e.mapValue.fields||{})[t.get(r)],!ME(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=zp(e)}setAll(t){let e=vs.emptyPath(),r={},s=[];t.forEach((o,c)=>{if(!e.isImmediateParentOf(c)){const u=this.getFieldsMap(e);this.applyChanges(u,r,s),r={},s=[],e=c.popLast()}o?r[c.lastSegment()]=zp(o):s.push(c.lastSegment())});const i=this.getFieldsMap(e);this.applyChanges(i,r,s)}delete(t){const e=this.field(t.popLast());ME(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Z3(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let r=0;r<t.length;++r){let s=e.mapValue.fields[t.get(r)];ME(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(r)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,r){t8(e,(s,i)=>t[s]=i);for(const s of r)delete t[s]}clone(){return new si(zp(this.value))}}function aY(n){const t=[];return t8(n.fields,(e,r)=>{const s=new vs([e]);if(ME(r)){const i=aY(r.mapValue).fields;if(0===i.length)t.push(s);else for(const o of i)t.push(s.child(o))}else t.push(s)}),new ga(t)}class ur{constructor(t,e,r,s,i,o){this.key=t,this.documentType=e,this.version=r,this.readTime=s,this.data=i,this.documentState=o}static newInvalidDocument(t){return new ur(t,0,Jt.min(),Jt.min(),si.empty(),0)}static newFoundDocument(t,e,r){return new ur(t,1,e,Jt.min(),r,0)}static newNoDocument(t,e){return new ur(t,2,e,Jt.min(),si.empty(),0)}static newUnknownDocument(t,e){return new ur(t,3,e,Jt.min(),si.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=si.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=si.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Jt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof ur&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new ur(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class kge{constructor(t,e=null,r=[],s=[],i=null,o=null,c=null){this.path=t,this.collectionGroup=e,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.ht=null}}function cY(n,t=null,e=[],r=[],s=null,i=null,o=null){return new kge(n,t,e,r,s,i,o)}function o8(n){const t=st(n);if(null===t.ht){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(r=>{return(s=r).field.canonicalString()+s.op.toString()+U7(s.value);var s}).join(","),e+="|ob:",e+=t.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),Lp(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(r=>U7(r)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(r=>U7(r)).join(",")),t.ht=e}return t.ht}function Vp(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let s=0;s<n.orderBy.length;s++)if(!Uge(n.orderBy[s],t.orderBy[s]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let s=0;s<n.filters.length;s++)if((e=n.filters[s]).op!==(r=t.filters[s]).op||!e.field.isEqual(r.field)||!Z3(e.value,r.value))return!1;var e,r;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!dY(n.startAt,t.startAt)&&dY(n.endAt,t.endAt)}function SE(n){return tt.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}class ii extends class{}{constructor(t,e,r){super(),this.field=t,this.op=e,this.value=r}static create(t,e,r){return t.isKeyField()?"in"===e||"not-in"===e?this.lt(t,e,r):new Dge(t,e,r):"array-contains"===e?new Hge(t,r):"in"===e?new Fge(t,r):"not-in"===e?new Bge(t,r):"array-contains-any"===e?new $ge(t,r):new ii(t,e,r)}static lt(t,e,r){return"in"===e?new zge(t,r):new Vge(t,r)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.ft(K6(e,this.value)):null!==e&&s8(this.value)===s8(e)&&this.ft(K6(e,this.value))}ft(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return St()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Dge extends ii{constructor(t,e,r){super(t,e,r),this.key=tt.fromName(r.referenceValue)}matches(t){const e=tt.comparator(t.key,this.key);return this.ft(e)}}class zge extends ii{constructor(t,e){super(t,"in",e),this.keys=fY(0,e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class Vge extends ii{constructor(t,e){super(t,"not-in",e),this.keys=fY(0,e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function fY(n,t){var e;return((null===(e=t.arrayValue)||void 0===e?void 0:e.values)||[]).map(r=>tt.fromName(r.referenceValue))}class Hge extends ii{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Dp(e)&&Rp(e.arrayValue,this.value)}}class Fge extends ii{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Rp(this.value.arrayValue,e)}}class Bge extends ii{constructor(t,e){super(t,"not-in",e)}matches(t){if(Rp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Rp(this.value.arrayValue,e)}}class $ge extends ii{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Dp(e)||!e.arrayValue.values)&&e.arrayValue.values.some(r=>Rp(this.value.arrayValue,r))}}class X6{constructor(t,e){this.position=t,this.inclusive=e}}class G7{constructor(t,e="asc"){this.field=t,this.dir=e}}function Uge(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}function hY(n,t,e){let r=0;for(let s=0;s<n.position.length;s++){const i=t[s],o=n.position[s];if(r=i.field.isKeyField()?tt.comparator(tt.fromName(o.referenceValue),e.key):K6(o,e.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function dY(n,t){if(null===n)return null===t;if(null===t||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!Z3(n.position[e],t.position[e]))return!1;return!0}class al{constructor(t,e=null,r=[],s=[],i=null,o="F",c=null,u=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this._t=null,this.wt=null}}function W7(n){return new al(n)}function gY(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function KO(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function XO(n){for(const t of n.filters)if(t.dt())return t.field;return null}function QO(n){return null!==n.collectionGroup}function q7(n){const t=st(n);if(null===t._t){t._t=[];const e=XO(t),r=KO(t);if(null!==e&&null===r)e.isKeyField()||t._t.push(new G7(e)),t._t.push(new G7(vs.keyField(),"asc"));else{let s=!1;for(const i of t.explicitOrderBy)t._t.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t._t.push(new G7(vs.keyField(),i))}}}return t._t}function to(n){const t=st(n);if(!t.wt)if("F"===t.limitType)t.wt=cY(t.path,t.collectionGroup,q7(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const i of q7(t))e.push(new G7(i.field,"desc"===i.dir?"asc":"desc"));const r=t.endAt?new X6(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new X6(t.startAt.position,t.startAt.inclusive):null;t.wt=cY(t.path,t.collectionGroup,e,t.filters,t.limit,r,s)}return t.wt}function TE(n,t,e){return new al(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function Hp(n,t){return Vp(to(n),to(t))&&n.limitType===t.limitType}function mY(n){return`${o8(to(n))}|lt:${n.limitType}`}function JO(n){return`Query(target=${function Rge(n){let t=n.path.canonicalString();return null!==n.collectionGroup&&(t+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(t+=`, filters: [${n.filters.map(e=>{return`${(r=e).field.canonicalString()} ${r.op} ${U7(r.value)}`;var r}).join(", ")}]`),Lp(n.limit)||(t+=", limit: "+n.limit),n.orderBy.length>0&&(t+=`, orderBy: [${n.orderBy.map(e=>{return`${(r=e).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),n.startAt&&(t+=", startAt: ",t+=n.startAt.inclusive?"b:":"a:",t+=n.startAt.position.map(e=>U7(e)).join(",")),n.endAt&&(t+=", endAt: ",t+=n.endAt.inclusive?"a:":"b:",t+=n.endAt.position.map(e=>U7(e)).join(",")),`Target(${t})`}(to(n))}; limitType=${n.limitType})`}function eI(n,t){return t.isFoundDocument()&&function(e,r){const s=r.key.path;return null!==e.collectionGroup?r.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(s):tt.isDocumentKey(e.path)?e.path.isEqual(s):e.path.isImmediateParentOf(s)}(n,t)&&function(e,r){for(const s of e.explicitOrderBy)if(!s.field.isKeyField()&&null===r.data.field(s.field))return!1;return!0}(n,t)&&function(e,r){for(const s of e.filters)if(!s.matches(r))return!1;return!0}(n,t)&&(r=t,!((e=n).startAt&&!function(s,i,o){const c=hY(s,i,o);return s.inclusive?c<=0:c<0}(e.startAt,q7(e),r)||e.endAt&&!function(s,i,o){const c=hY(s,i,o);return s.inclusive?c>=0:c>0}(e.endAt,q7(e),r)));var e,r}function vY(n){return(t,e)=>{let r=!1;for(const s of q7(n)){const i=Gge(s,t,e);if(0!==i)return i;r=r||s.field.isKeyField()}return 0}}function Gge(n,t,e){const r=n.field.isKeyField()?tt.comparator(t.key,e.key):function(s,i,o){const c=i.data.field(s),u=o.data.field(s);return null!==c&&null!==u?K6(c,u):St()}(n.field,t,e);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return St()}}function CY(n,t){if(n.gt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:kp(t)?"-0":t}}function yY(n){return{integerValue:""+n}}function EY(n,t){return function eY(n){return"number"==typeof n&&Number.isInteger(n)&&!kp(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}(t)?yY(t):CY(n,t)}class wE{constructor(){this._=void 0}}function Wge(n,t,e){return n instanceof j7?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&(i.fields.__previous_value__=s),{mapValue:i}}(e,t):n instanceof a8?SY(n,t):n instanceof c8?PY(n,t):function(r,s){const i=MY(r,s),o=TY(i)+TY(r.yt);return YO(i)&&YO(r.yt)?yY(o):CY(r.It,o)}(n,t)}function qge(n,t,e){return n instanceof a8?SY(n,t):n instanceof c8?PY(n,t):e}function MY(n,t){return n instanceof Z7?YO(e=t)||(r=e)&&"doubleValue"in r?t:{integerValue:0}:null;var r,e}class j7 extends wE{}class a8 extends wE{constructor(t){super(),this.elements=t}}function SY(n,t){const e=wY(t);for(const r of n.elements)e.some(s=>Z3(s,r))||e.push(r);return{arrayValue:{values:e}}}class c8 extends wE{constructor(t){super(),this.elements=t}}function PY(n,t){let e=wY(t);for(const r of n.elements)e=e.filter(s=>!Z3(s,r));return{arrayValue:{values:e}}}class Z7 extends wE{constructor(t,e){super(),this.It=t,this.yt=e}}function TY(n){return is(n.integerValue||n.doubleValue)}function wY(n){return Dp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Fp{constructor(t,e){this.field=t,this.transform=e}}class Zge{constructor(t,e){this.version=t,this.transformResults=e}}class kr{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new kr}static exists(t){return new kr(void 0,t)}static updateTime(t){return new kr(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function bE(n,t){return void 0!==n.updateTime?t.isFoundDocument()&&t.version.isEqual(n.updateTime):void 0===n.exists||n.exists===t.isFoundDocument()}class NE{}function bY(n,t){if(!n.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return n.isNoDocument()?new K7(n.key,kr.none()):new Y7(n.key,n.data,kr.none());{const e=n.data,r=si.empty();let s=new j1(vs.comparator);for(let i of t.fields)if(!s.has(i)){let o=e.field(i);null===o&&i.length>1&&(i=i.popLast(),o=e.field(i)),null===o?r.delete(i):r.set(i,o),s=s.add(i)}return new cl(n.key,r,new ga(s.toArray()),kr.none())}}function Yge(n,t,e){n instanceof Y7?function(r,s,i){const o=r.value.clone(),c=OY(r.fieldTransforms,s,i.transformResults);o.setAll(c),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(n,t,e):n instanceof cl?function(r,s,i){if(!bE(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=OY(r.fieldTransforms,s,i.transformResults),c=s.data;c.setAll(AY(r)),c.setAll(o),s.convertToFoundDocument(i.version,c).setHasCommittedMutations()}(n,t,e):t.convertToNoDocument(e.version).setHasCommittedMutations()}function Bp(n,t,e,r){return n instanceof Y7?function(s,i,o,c){if(!bE(s.precondition,i))return o;const u=s.value.clone(),h=IY(s.fieldTransforms,c,i);return u.setAll(h),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),null}(n,t,e,r):n instanceof cl?function(s,i,o,c){if(!bE(s.precondition,i))return o;const u=IY(s.fieldTransforms,c,i),h=i.data;return h.setAll(AY(s)),h.setAll(u),i.convertToFoundDocument(i.version,h).setHasLocalMutations(),null===o?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(n,t,e,r):(o=e,bE(n.precondition,i=t)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o);var i,o}function Kge(n,t){let e=null;for(const r of n.fieldTransforms){const s=t.data.field(r.field),i=MY(r.transform,s||null);null!=i&&(null===e&&(e=si.empty()),e.set(r.field,i))}return e||null}function NY(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(e=n.fieldTransforms)&&void 0===r||e&&r&&B7(e,r,(s,i)=>function jge(n,t){return n.field.isEqual(t.field)&&(r=t.transform,(e=n.transform)instanceof a8&&r instanceof a8||e instanceof c8&&r instanceof c8?B7(e.elements,r.elements,Z3):e instanceof Z7&&r instanceof Z7?Z3(e.yt,r.yt):e instanceof j7&&r instanceof j7);var e,r}(s,i))))&&(0===n.type?n.value.isEqual(t.value):1!==n.type||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask));var e,r}class Y7 extends NE{constructor(t,e,r,s=[]){super(),this.key=t,this.value=e,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class cl extends NE{constructor(t,e,r,s,i=[]){super(),this.key=t,this.data=e,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function AY(n){const t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const r=n.data.field(e);t.set(e,r)}}),t}function OY(n,t,e){const r=new Map;Qt(n.length===e.length);for(let s=0;s<e.length;s++){const i=n[s],o=i.transform,c=t.data.field(i.field);r.set(i.field,qge(o,c,e[s]))}return r}function IY(n,t,e){const r=new Map;for(const s of n){const i=s.transform,o=e.data.field(s.field);r.set(s.field,Wge(i,o,t))}return r}class K7 extends NE{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class tI extends NE{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Xge{constructor(t){this.count=t}}var ks,h1;function xY(n){switch(n){default:return St();case Me.CANCELLED:case Me.UNKNOWN:case Me.DEADLINE_EXCEEDED:case Me.RESOURCE_EXHAUSTED:case Me.INTERNAL:case Me.UNAVAILABLE:case Me.UNAUTHENTICATED:return!1;case Me.INVALID_ARGUMENT:case Me.NOT_FOUND:case Me.ALREADY_EXISTS:case Me.PERMISSION_DENIED:case Me.FAILED_PRECONDITION:case Me.ABORTED:case Me.OUT_OF_RANGE:case Me.UNIMPLEMENTED:case Me.DATA_LOSS:return!0}}function LY(n){if(void 0===n)return _s("GRPC error has no .code"),Me.UNKNOWN;switch(n){case ks.OK:return Me.OK;case ks.CANCELLED:return Me.CANCELLED;case ks.UNKNOWN:return Me.UNKNOWN;case ks.DEADLINE_EXCEEDED:return Me.DEADLINE_EXCEEDED;case ks.RESOURCE_EXHAUSTED:return Me.RESOURCE_EXHAUSTED;case ks.INTERNAL:return Me.INTERNAL;case ks.UNAVAILABLE:return Me.UNAVAILABLE;case ks.UNAUTHENTICATED:return Me.UNAUTHENTICATED;case ks.INVALID_ARGUMENT:return Me.INVALID_ARGUMENT;case ks.NOT_FOUND:return Me.NOT_FOUND;case ks.ALREADY_EXISTS:return Me.ALREADY_EXISTS;case ks.PERMISSION_DENIED:return Me.PERMISSION_DENIED;case ks.FAILED_PRECONDITION:return Me.FAILED_PRECONDITION;case ks.ABORTED:return Me.ABORTED;case ks.OUT_OF_RANGE:return Me.OUT_OF_RANGE;case ks.UNIMPLEMENTED:return Me.UNIMPLEMENTED;case ks.DATA_LOSS:return Me.DATA_LOSS;default:return St()}}(h1=ks||(ks={}))[h1.OK=0]="OK",h1[h1.CANCELLED=1]="CANCELLED",h1[h1.UNKNOWN=2]="UNKNOWN",h1[h1.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",h1[h1.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",h1[h1.NOT_FOUND=5]="NOT_FOUND",h1[h1.ALREADY_EXISTS=6]="ALREADY_EXISTS",h1[h1.PERMISSION_DENIED=7]="PERMISSION_DENIED",h1[h1.UNAUTHENTICATED=16]="UNAUTHENTICATED",h1[h1.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",h1[h1.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",h1[h1.ABORTED=10]="ABORTED",h1[h1.OUT_OF_RANGE=11]="OUT_OF_RANGE",h1[h1.UNIMPLEMENTED=12]="UNIMPLEMENTED",h1[h1.INTERNAL=13]="INTERNAL",h1[h1.UNAVAILABLE=14]="UNAVAILABLE",h1[h1.DATA_LOSS=15]="DATA_LOSS";class Q6{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),r=this.inner[e];if(void 0!==r)for(const[s,i]of r)if(this.equalsFn(s,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const r=this.mapKeyFn(t),s=this.inner[r];if(void 0===s)return this.inner[r]=[[t,e]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],t))return void(s[i]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),r=this.inner[e];if(void 0===r)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return 1===r.length?delete this.inner[e]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(t){t8(this.inner,(e,r)=>{for(const[s,i]of r)t(s,i)})}isEmpty(){return XZ(this.inner)}size(){return this.innerSize}}const Qge=new ss(tt.comparator);function Do(){return Qge}const kY=new ss(tt.comparator);function $p(...n){let t=kY;for(const e of n)t=t.insert(e.key,e);return t}function RY(n){let t=kY;return n.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function Y3(){return Up()}function DY(){return Up()}function Up(){return new Q6(n=>n.toString(),(n,t)=>n.isEqual(t))}const Jge=new ss(tt.comparator),eme=new j1(tt.comparator);function En(...n){let t=eme;for(const e of n)t=t.add(e);return t}const tme=new j1(pn);function AE(){return tme}class Gp{constructor(t,e,r,s,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,e,r){const s=new Map;return s.set(t,Wp.createSynthesizedTargetChangeForCurrentChange(t,e,r)),new Gp(Jt.min(),s,AE(),Do(),En())}}class Wp{constructor(t,e,r,s,i){this.resumeToken=t,this.current=e,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,e,r){return new Wp(r,e,En(),En(),En())}}class OE{constructor(t,e,r,s){this.Tt=t,this.removedTargetIds=e,this.key=r,this.Et=s}}class zY{constructor(t,e){this.targetId=t,this.At=e}}class VY{constructor(t,e,r=t2.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=e,this.resumeToken=r,this.cause=s}}class HY{constructor(){this.Rt=0,this.bt=BY(),this.Pt=t2.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(t){t.approximateByteSize()>0&&(this.Vt=!0,this.Pt=t)}xt(){let t=En(),e=En(),r=En();return this.bt.forEach((s,i)=>{switch(i){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:r=r.add(s);break;default:St()}}),new Wp(this.Pt,this.vt,t,e,r)}Nt(){this.Vt=!1,this.bt=BY()}kt(t,e){this.Vt=!0,this.bt=this.bt.insert(t,e)}Ot(t){this.Vt=!0,this.bt=this.bt.remove(t)}Mt(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class nme{constructor(t){this.Bt=t,this.Lt=new Map,this.Ut=Do(),this.qt=FY(),this.Kt=new j1(pn)}Gt(t){for(const e of t.Tt)t.Et&&t.Et.isFoundDocument()?this.Qt(e,t.Et):this.jt(e,t.key,t.Et);for(const e of t.removedTargetIds)this.jt(e,t.key,t.Et)}Wt(t){this.forEachTarget(t,e=>{const r=this.zt(e);switch(t.state){case 0:this.Ht(e)&&r.Ct(t.resumeToken);break;case 1:r.Ft(),r.St||r.Nt(),r.Ct(t.resumeToken);break;case 2:r.Ft(),r.St||this.removeTarget(e);break;case 3:this.Ht(e)&&(r.$t(),r.Ct(t.resumeToken));break;case 4:this.Ht(e)&&(this.Jt(e),r.Ct(t.resumeToken));break;default:St()}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Lt.forEach((r,s)=>{this.Ht(s)&&e(s)})}Yt(t){const e=t.targetId,r=t.At.count,s=this.Xt(e);if(s){const i=s.target;if(SE(i))if(0===r){const o=new tt(i.path);this.jt(e,o,ur.newNoDocument(o,Jt.min()))}else Qt(1===r);else this.Zt(e)!==r&&(this.Jt(e),this.Kt=this.Kt.add(e))}}te(t){const e=new Map;this.Lt.forEach((i,o)=>{const c=this.Xt(o);if(c){if(i.current&&SE(c.target)){const u=new tt(c.target.path);null!==this.Ut.get(u)||this.ee(o,u)||this.jt(o,u,ur.newNoDocument(u,t))}i.Dt&&(e.set(o,i.xt()),i.Nt())}});let r=En();this.qt.forEach((i,o)=>{let c=!0;o.forEachWhile(u=>{const h=this.Xt(u);return!h||2===h.purpose||(c=!1,!1)}),c&&(r=r.add(i))}),this.Ut.forEach((i,o)=>o.setReadTime(t));const s=new Gp(t,e,this.Kt,this.Ut,r);return this.Ut=Do(),this.qt=FY(),this.Kt=new j1(pn),s}Qt(t,e){if(!this.Ht(t))return;const r=this.ee(t,e.key)?2:0;this.zt(t).kt(e.key,r),this.Ut=this.Ut.insert(e.key,e),this.qt=this.qt.insert(e.key,this.ne(e.key).add(t))}jt(t,e,r){if(!this.Ht(t))return;const s=this.zt(t);this.ee(t,e)?s.kt(e,1):s.Ot(e),this.qt=this.qt.insert(e,this.ne(e).delete(t)),r&&(this.Ut=this.Ut.insert(e,r))}removeTarget(t){this.Lt.delete(t)}Zt(t){const e=this.zt(t).xt();return this.Bt.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Mt(t){this.zt(t).Mt()}zt(t){let e=this.Lt.get(t);return e||(e=new HY,this.Lt.set(t,e)),e}ne(t){let e=this.qt.get(t);return e||(e=new j1(pn),this.qt=this.qt.insert(t,e)),e}Ht(t){const e=null!==this.Xt(t);return e||Be("WatchChangeAggregator","Detected inactive target",t),e}Xt(t){const e=this.Lt.get(t);return e&&e.St?null:this.Bt.se(t)}Jt(t){this.Lt.set(t,new HY),this.Bt.getRemoteKeysForTarget(t).forEach(e=>{this.jt(t,e,null)})}ee(t,e){return this.Bt.getRemoteKeysForTarget(t).has(e)}}function FY(){return new ss(tt.comparator)}function BY(){return new ss(tt.comparator)}const rme={asc:"ASCENDING",desc:"DESCENDING"},sme={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class ime{constructor(t,e){this.databaseId=t,this.gt=e}}function qp(n,t){return n.gt?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function $Y(n,t){return n.gt?t.toBase64():t.toUint8Array()}function ome(n,t){return qp(n,t.toTimestamp())}function T2(n){return Qt(!!n),Jt.fromTimestamp(function(t){const e=Z6(t);return new qr(e.seconds,e.nanos)}(n))}function nI(n,t){return(e=n,new f1(["projects",e.projectId,"databases",e.database])).child("documents").child(t).canonicalString();var e}function UY(n){const t=f1.fromString(n);return Qt(XY(t)),t}function jp(n,t){return nI(n.databaseId,t.path)}function K3(n,t){const e=UY(t);if(e.get(1)!==n.databaseId.projectId)throw new Ve(Me.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new Ve(Me.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new tt(WY(e))}function rI(n,t){return nI(n.databaseId,t)}function Zp(n){return new f1(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function WY(n){return Qt(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function qY(n,t,e){return{name:jp(n,t),fields:e.value.mapValue.fields}}function ZY(n,t){return{documents:[rI(n,t.path)]}}function iI(n,t){const e={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(e.parent=rI(n,r),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=rI(n,r.popLast()),e.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(u){if(0===u.length)return;const h=u.map(g=>function(m){if("=="===m.op){if(rY(m.value))return{unaryFilter:{field:X7(m.field),op:"IS_NAN"}};if(nY(m.value))return{unaryFilter:{field:X7(m.field),op:"IS_NULL"}}}else if("!="===m.op){if(rY(m.value))return{unaryFilter:{field:X7(m.field),op:"IS_NOT_NAN"}};if(nY(m.value))return{unaryFilter:{field:X7(m.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:X7(m.field),op:hme(m.op),value:m.value}}}(g));return 1===h.length?h[0]:{compositeFilter:{op:"AND",filters:h}}}(t.filters);s&&(e.structuredQuery.where=s);const i=function(u){if(0!==u.length)return u.map(h=>{return{field:X7((g=h).field),direction:fme(g.dir)};var g})}(t.orderBy);i&&(e.structuredQuery.orderBy=i);const o=(h=t.limit,n.gt||Lp(h)?h:{value:h});var h,c,u;return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt={before:(c=t.startAt).inclusive,values:c.position}),t.endAt&&(e.structuredQuery.endAt={before:!(u=t.endAt).inclusive,values:u.position}),e}function YY(n){let t=function GY(n){const t=UY(n);return 4===t.length?f1.emptyPath():WY(t)}(n.parent);const e=n.structuredQuery,r=e.from?e.from.length:0;let s=null;if(r>0){Qt(1===r);const g=e.from[0];g.allDescendants?s=g.collectionId:t=t.child(g.collectionId)}let i=[];e.where&&(i=KY(e.where));let o=[];e.orderBy&&(o=e.orderBy.map(g=>{return new G7(Q7((m=g).field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction));var m}));let c=null;e.limit&&(c=function(g){let m;return m="object"==typeof g?g.value:g,Lp(m)?null:m}(e.limit));let u=null;var g;e.startAt&&(u=new X6((g=e.startAt).values||[],!!g.before));let h=null;return e.endAt&&(h=function(g){return new X6(g.values||[],!g.before)}(e.endAt)),function pY(n,t,e,r,s,i,o,c){return new al(n,t,e,r,s,i,o,c)}(t,s,o,i,c,"F",u,h)}function KY(n){return n?void 0!==n.unaryFilter?[pme(n)]:void 0!==n.fieldFilter?[dme(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(t=>KY(t)).reduce((t,e)=>t.concat(e)):St():[]}function fme(n){return rme[n]}function hme(n){return sme[n]}function X7(n){return{fieldPath:n.canonicalString()}}function Q7(n){return vs.fromServerFormat(n.fieldPath)}function dme(n){return ii.create(Q7(n.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return St()}}(n.fieldFilter.op),n.fieldFilter.value)}function pme(n){switch(n.unaryFilter.op){case"IS_NAN":const t=Q7(n.unaryFilter.field);return ii.create(t,"==",{doubleValue:NaN});case"IS_NULL":const e=Q7(n.unaryFilter.field);return ii.create(e,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Q7(n.unaryFilter.field);return ii.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Q7(n.unaryFilter.field);return ii.create(s,"!=",{nullValue:"NULL_VALUE"});default:return St()}}function gme(n){const t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function XY(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class aI{constructor(t,e,r,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(t,e){const r=e.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(t.key)&&Yge(i,t,r[s])}}applyToLocalView(t,e){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(e=Bp(r,t,e,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(e=Bp(r,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const r=DY();return this.mutations.forEach(s=>{const i=t.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=e.has(s.key)?null:c;const u=bY(o,c);null!==u&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(Jt.min())}),r}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),En())}isEqual(t){return this.batchId===t.batchId&&B7(this.mutations,t.mutations,(e,r)=>NY(e,r))&&B7(this.baseMutations,t.baseMutations,(e,r)=>NY(e,r))}}class cI{constructor(t,e,r,s){this.batch=t,this.commitVersion=e,this.mutationResults=r,this.docVersions=s}static from(t,e,r){Qt(t.mutations.length===r.length);let s=Jge;const i=t.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new cI(t,e,r,s)}}class lI{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class J6{constructor(t,e,r,s,i=Jt.min(),o=Jt.min(),c=t2.EMPTY_BYTE_STRING){this.target=t,this.targetId=e,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c}withSequenceNumber(t){return new J6(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,e){return new J6(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new J6(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}class sK{constructor(t){this.re=t}}function uI(n){const t=YY({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?TE(t,t.limit,"L"):t}class h8{constructor(){}ce(t,e){this.ae(t,e),e.he()}ae(t,e){if("nullValue"in t)this.le(e,5);else if("booleanValue"in t)this.le(e,10),e.fe(t.booleanValue?1:0);else if("integerValue"in t)this.le(e,15),e.fe(is(t.integerValue));else if("doubleValue"in t){const r=is(t.doubleValue);isNaN(r)?this.le(e,13):(this.le(e,15),kp(r)?e.fe(0):e.fe(r))}else if("timestampValue"in t){const r=t.timestampValue;this.le(e,20),"string"==typeof r?e.de(r):(e.de(`${r.seconds||""}`),e.fe(r.nanos||0))}else if("stringValue"in t)this._e(t.stringValue,e),this.we(e);else if("bytesValue"in t)this.le(e,30),e.me(n8(t.bytesValue)),this.we(e);else if("referenceValue"in t)this.ge(t.referenceValue,e);else if("geoPointValue"in t){const r=t.geoPointValue;this.le(e,45),e.fe(r.latitude||0),e.fe(r.longitude||0)}else"mapValue"in t?sY(t)?this.le(e,Number.MAX_SAFE_INTEGER):(this.ye(t.mapValue,e),this.we(e)):"arrayValue"in t?(this.pe(t.arrayValue,e),this.we(e)):St()}_e(t,e){this.le(e,25),this.Ie(t,e)}Ie(t,e){e.de(t)}ye(t,e){const r=t.fields||{};this.le(e,55);for(const s of Object.keys(r))this._e(s,e),this.ae(r[s],e)}pe(t,e){const r=t.values||[];this.le(e,50);for(const s of r)this.ae(s,e)}ge(t,e){this.le(e,37),tt.fromName(t).path.forEach(r=>{this.le(e,60),this.Ie(r,e)})}le(t,e){t.fe(e)}we(t){t.fe(2)}}h8.Te=new h8;class Bme{constructor(){this.Ye=new hI}addToCollectionParentIndex(t,e){return this.Ye.add(e),ve.resolve()}getCollectionParents(t,e){return ve.resolve(this.Ye.getEntries(e))}addFieldIndex(t,e){return ve.resolve()}deleteFieldIndex(t,e){return ve.resolve()}getDocumentsMatchingTarget(t,e){return ve.resolve(null)}getIndexType(t,e){return ve.resolve(0)}getFieldIndexes(t,e){return ve.resolve([])}getNextCollectionGroupToUpdate(t){return ve.resolve(null)}getMinOffset(t,e){return ve.resolve(pa.min())}getMinOffsetFromCollectionGroup(t,e){return ve.resolve(pa.min())}updateCollectionGroup(t,e,r){return ve.resolve()}updateIndexEntries(t,e){return ve.resolve()}}class hI{constructor(){this.index={}}add(t){const e=t.lastSegment(),r=t.popLast(),s=this.index[e]||new j1(f1.comparator),i=!s.has(r);return this.index[e]=s.add(r),i}has(t){const e=t.lastSegment(),r=t.popLast(),s=this.index[e];return s&&s.has(r)}getEntries(t){return(this.index[t]||new j1(f1.comparator)).toArray()}}new Uint8Array(0);class zo{constructor(t,e,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=r}static withCacheSize(t){return new zo(t,zo.DEFAULT_COLLECTION_PERCENTILE,zo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}zo.DEFAULT_COLLECTION_PERCENTILE=10,zo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zo.DEFAULT=new zo(41943040,zo.DEFAULT_COLLECTION_PERCENTILE,zo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zo.DISABLED=new zo(-1,0,0);class g8{constructor(t){this.bn=t}next(){return this.bn+=2,this.bn}static Pn(){return new g8(0)}static vn(){return new g8(-1)}}class Xme{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class TK{constructor(t,e,r,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=r,this.indexManager=s}getDocument(t,e){let r=null;return this.documentOverlayCache.getOverlay(t,e).next(s=>(r=s,this.getBaseDocument(t,e,r))).next(s=>(null!==r&&Bp(r.mutation,s,ga.empty(),qr.now()),s))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.getLocalViewOfDocuments(t,r,En()).next(()=>r))}getLocalViewOfDocuments(t,e,r=En()){const s=Y3();return this.populateOverlays(t,s,e).next(()=>this.computeViews(t,e,s,r).next(i=>{let o=$p();return i.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(t,e){const r=Y3();return this.populateOverlays(t,r,e).next(()=>this.computeViews(t,e,r,En()))}populateOverlays(t,e,r){const s=[];return r.forEach(i=>{e.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(t,s).next(i=>{i.forEach((o,c)=>{e.set(o,c)})})}computeViews(t,e,r,s){let i=Do();const o=Up(),c=Up();return e.forEach((u,h)=>{const g=r.get(h.key);s.has(h.key)&&(void 0===g||g.mutation instanceof cl)?i=i.insert(h.key,h):void 0!==g&&(o.set(h.key,g.mutation.getFieldMask()),Bp(g.mutation,h,g.mutation.getFieldMask(),qr.now()))}),this.recalculateAndSaveOverlays(t,i).next(u=>(u.forEach((h,g)=>o.set(h,g)),e.forEach((h,g)=>{var m;return c.set(h,new Xme(g,null!==(m=o.get(h))&&void 0!==m?m:null))}),c))}recalculateAndSaveOverlays(t,e){const r=Up();let s=new ss((o,c)=>o-c),i=En();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(o=>{for(const c of o)c.keys().forEach(u=>{const h=e.get(u);if(null===h)return;let g=r.get(u)||ga.empty();g=c.applyToLocalView(h,g),r.set(u,g);const m=(s.get(c.batchId)||En()).add(u);s=s.insert(c.batchId,m)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,g=u.value,m=DY();g.forEach(v=>{if(!i.has(v)){const T=bY(e.get(v),r.get(v));null!==T&&m.set(v,T),i=i.add(v)}}),o.push(this.documentOverlayCache.saveOverlays(t,h,m))}return ve.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,e,r){return tt.isDocumentKey((s=e).path)&&null===s.collectionGroup&&0===s.filters.length?this.getDocumentsMatchingDocumentQuery(t,e.path):QO(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,r):this.getDocumentsMatchingCollectionQuery(t,e,r);var s}getNextDocuments(t,e,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,r.largestBatchId,s-i.size):ve.resolve(Y3());let c=-1,u=i;return o.next(h=>ve.forEach(h,(g,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(g)?ve.resolve():this.getBaseDocument(t,g,m).next(v=>{u=u.insert(g,v)}))).next(()=>this.populateOverlays(t,h,i)).next(()=>this.computeViews(t,u,h,En())).next(g=>({batchId:c,changes:RY(g)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new tt(e)).next(r=>{let s=$p();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(t,e,r){const s=e.collectionGroup;let i=$p();return this.indexManager.getCollectionParents(t,s).next(o=>ve.forEach(o,c=>{const u=(h=e,g=c.child(s),new al(g,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt));var h,g;return this.getDocumentsMatchingCollectionQuery(t,u,r).next(h=>{h.forEach((g,m)=>{i=i.insert(g,m)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(t,e,r){let s;return this.remoteDocumentCache.getAllFromCollection(t,e.path,r).next(i=>(s=i,this.documentOverlayCache.getOverlaysForCollection(t,e.path,r.largestBatchId))).next(i=>{i.forEach((c,u)=>{const h=u.getKey();null===s.get(h)&&(s=s.insert(h,ur.newInvalidDocument(h)))});let o=$p();return s.forEach((c,u)=>{const h=i.get(c);void 0!==h&&Bp(h.mutation,u,ga.empty(),qr.now()),eI(e,u)&&(o=o.insert(c,u))}),o})}getBaseDocument(t,e,r){return null===r||1===r.mutation.type?this.remoteDocumentCache.getEntry(t,e):ve.resolve(ur.newInvalidDocument(e))}}class Qme{constructor(t){this.It=t,this.Zn=new Map,this.ts=new Map}getBundleMetadata(t,e){return ve.resolve(this.Zn.get(e))}saveBundleMetadata(t,e){var r;return this.Zn.set(e.id,{id:(r=e).id,version:r.version,createTime:T2(r.createTime)}),ve.resolve()}getNamedQuery(t,e){return ve.resolve(this.ts.get(e))}saveNamedQuery(t,e){return this.ts.set(e.name,{name:(r=e).name,query:uI(r.bundledQuery),readTime:T2(r.readTime)}),ve.resolve();var r}}class Jme{constructor(){this.overlays=new ss(tt.comparator),this.es=new Map}getOverlay(t,e){return ve.resolve(this.overlays.get(e))}getOverlays(t,e){const r=Y3();return ve.forEach(e,s=>this.getOverlay(t,s).next(i=>{null!==i&&r.set(s,i)})).next(()=>r)}saveOverlays(t,e,r){return r.forEach((s,i)=>{this.ue(t,e,i)}),ve.resolve()}removeOverlaysForBatchId(t,e,r){const s=this.es.get(r);return void 0!==s&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.es.delete(r)),ve.resolve()}getOverlaysForCollection(t,e,r){const s=Y3(),i=e.length+1,o=new tt(e.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!e.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return ve.resolve(s)}getOverlaysForCollectionGroup(t,e,r,s){let i=new ss((h,g)=>h-g);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===e&&h.largestBatchId>r){let g=i.get(h.largestBatchId);null===g&&(g=Y3(),i=i.insert(h.largestBatchId,g)),g.set(h.getKey(),h)}}const c=Y3(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,g)=>c.set(h,g)),!(c.size()>=s)););return ve.resolve(c)}ue(t,e,r){const s=this.overlays.get(r.key);if(null!==s){const o=this.es.get(s.largestBatchId).delete(r.key);this.es.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new lI(e,r));let i=this.es.get(e);void 0===i&&(i=En(),this.es.set(e,i)),this.es.set(e,i.add(r.key))}}class dI{constructor(){this.ns=new j1(b2.ss),this.rs=new j1(b2.os)}isEmpty(){return this.ns.isEmpty()}addReference(t,e){const r=new b2(t,e);this.ns=this.ns.add(r),this.rs=this.rs.add(r)}us(t,e){t.forEach(r=>this.addReference(r,e))}removeReference(t,e){this.cs(new b2(t,e))}hs(t,e){t.forEach(r=>this.removeReference(r,e))}ls(t){const e=new tt(new f1([])),r=new b2(e,t),s=new b2(e,t+1),i=[];return this.rs.forEachInRange([r,s],o=>{this.cs(o),i.push(o.key)}),i}fs(){this.ns.forEach(t=>this.cs(t))}cs(t){this.ns=this.ns.delete(t),this.rs=this.rs.delete(t)}ds(t){const e=new tt(new f1([])),r=new b2(e,t),s=new b2(e,t+1);let i=En();return this.rs.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(t){const e=new b2(t,0),r=this.ns.firstAfterOrEqual(e);return null!==r&&t.isEqual(r.key)}}class b2{constructor(t,e){this.key=t,this._s=e}static ss(t,e){return tt.comparator(t.key,e.key)||pn(t._s,e._s)}static os(t,e){return pn(t._s,e._s)||tt.comparator(t.key,e.key)}}class e_e{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.ws=1,this.gs=new j1(b2.ss)}checkEmpty(t){return ve.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,r,s){const i=this.ws;this.ws++;const o=new aI(i,e,r,s);this.mutationQueue.push(o);for(const c of s)this.gs=this.gs.add(new b2(c.key,i)),this.indexManager.addToCollectionParentIndex(t,c.key.path.popLast());return ve.resolve(o)}lookupMutationBatch(t,e){return ve.resolve(this.ys(e))}getNextMutationBatchAfterBatchId(t,e){const s=this.ps(e+1),i=s<0?0:s;return ve.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ve.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(t){return ve.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const r=new b2(e,0),s=new b2(e,Number.POSITIVE_INFINITY),i=[];return this.gs.forEachInRange([r,s],o=>{const c=this.ys(o._s);i.push(c)}),ve.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let r=new j1(pn);return e.forEach(s=>{const i=new b2(s,0),o=new b2(s,Number.POSITIVE_INFINITY);this.gs.forEachInRange([i,o],c=>{r=r.add(c._s)})}),ve.resolve(this.Is(r))}getAllMutationBatchesAffectingQuery(t,e){const r=e.path,s=r.length+1;let i=r;tt.isDocumentKey(i)||(i=i.child(""));const o=new b2(new tt(i),0);let c=new j1(pn);return this.gs.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(u._s)),!0)},o),ve.resolve(this.Is(c))}Is(t){const e=[];return t.forEach(r=>{const s=this.ys(r);null!==s&&e.push(s)}),e}removeMutationBatch(t,e){Qt(0===this.Ts(e.batchId,"removed")),this.mutationQueue.shift();let r=this.gs;return ve.forEach(e.mutations,s=>{const i=new b2(s.key,e.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.gs=r})}An(t){}containsKey(t,e){const r=new b2(e,0),s=this.gs.firstAfterOrEqual(r);return ve.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return ve.resolve()}Ts(t,e){return this.ps(t)}ps(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}ys(t){const e=this.ps(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class t_e{constructor(t){this.Es=t,this.docs=new ss(tt.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const r=e.key,s=this.docs.get(r),i=s?s.size:0,o=this.Es(e);return this.docs=this.docs.insert(r,{document:e.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const r=this.docs.get(e);return ve.resolve(r?r.document.mutableCopy():ur.newInvalidDocument(e))}getEntries(t,e){let r=Do();return e.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():ur.newInvalidDocument(s))}),ve.resolve(r)}getAllFromCollection(t,e,r){let s=Do();const i=new tt(e.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:c,value:{document:u}}=o.getNext();if(!e.isPrefixOf(c.path))break;c.path.length>e.length+1||GO(jZ(u),r)<=0||(s=s.insert(u.key,u.mutableCopy()))}return ve.resolve(s)}getAllFromCollectionGroup(t,e,r,s){St()}As(t,e){return ve.forEach(this.docs,r=>e(r))}newChangeBuffer(t){return new n_e(this)}getSize(t){return ve.resolve(this.size)}}class n_e extends class Zme{constructor(){this.changes=new Q6(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,ur.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const r=this.changes.get(e);return void 0!==r?ve.resolve(r):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}{constructor(t){super(),this.Yn=t}applyChanges(t){const e=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?e.push(this.Yn.addEntry(t,s)):this.Yn.removeEntry(r)}),ve.waitFor(e)}getFromCache(t,e){return this.Yn.getEntry(t,e)}getAllFromCache(t,e){return this.Yn.getEntries(t,e)}}class r_e{constructor(t){this.persistence=t,this.Rs=new Q6(e=>o8(e),Vp),this.lastRemoteSnapshotVersion=Jt.min(),this.highestTargetId=0,this.bs=0,this.Ps=new dI,this.targetCount=0,this.vs=g8.Pn()}forEachTarget(t,e){return this.Rs.forEach((r,s)=>e(s)),ve.resolve()}getLastRemoteSnapshotVersion(t){return ve.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return ve.resolve(this.bs)}allocateTargetId(t){return this.highestTargetId=this.vs.next(),ve.resolve(this.highestTargetId)}setTargetsMetadata(t,e,r){return r&&(this.lastRemoteSnapshotVersion=r),e>this.bs&&(this.bs=e),ve.resolve()}Dn(t){this.Rs.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.vs=new g8(e),this.highestTargetId=e),t.sequenceNumber>this.bs&&(this.bs=t.sequenceNumber)}addTargetData(t,e){return this.Dn(e),this.targetCount+=1,ve.resolve()}updateTargetData(t,e){return this.Dn(e),ve.resolve()}removeTargetData(t,e){return this.Rs.delete(e.target),this.Ps.ls(e.targetId),this.targetCount-=1,ve.resolve()}removeTargets(t,e,r){let s=0;const i=[];return this.Rs.forEach((o,c)=>{c.sequenceNumber<=e&&null===r.get(c.targetId)&&(this.Rs.delete(o),i.push(this.removeMatchingKeysForTargetId(t,c.targetId)),s++)}),ve.waitFor(i).next(()=>s)}getTargetCount(t){return ve.resolve(this.targetCount)}getTargetData(t,e){const r=this.Rs.get(e)||null;return ve.resolve(r)}addMatchingKeys(t,e,r){return this.Ps.us(e,r),ve.resolve()}removeMatchingKeys(t,e,r){this.Ps.hs(e,r);const s=this.persistence.referenceDelegate,i=[];return s&&e.forEach(o=>{i.push(s.markPotentiallyOrphaned(t,o))}),ve.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.Ps.ls(e),ve.resolve()}getMatchingKeysForTargetId(t,e){const r=this.Ps.ds(e);return ve.resolve(r)}containsKey(t,e){return ve.resolve(this.Ps.containsKey(e))}}class wK{constructor(t,e){this.Vs={},this.overlays={},this.Ss=new Ro(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=t(this),this.Cs=new r_e(this),this.indexManager=new Bme,this.remoteDocumentCache=new t_e(r=>this.referenceDelegate.xs(r)),this.It=new sK(e),this.Ns=new Qme(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Jme,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let r=this.Vs[t.toKey()];return r||(r=new e_e(e,this.referenceDelegate),this.Vs[t.toKey()]=r),r}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(t,e,r){Be("MemoryPersistence","Starting transaction:",t);const s=new s_e(this.Ss.next());return this.referenceDelegate.ks(),r(s).next(i=>this.referenceDelegate.Os(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ms(t,e){return ve.or(Object.values(this.Vs).map(r=>()=>r.containsKey(t,e)))}}class s_e extends class Tge{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}{constructor(t){super(),this.currentSequenceNumber=t}}class HE{constructor(t){this.persistence=t,this.Fs=new dI,this.$s=null}static Bs(t){return new HE(t)}get Ls(){if(this.$s)return this.$s;throw St()}addReference(t,e,r){return this.Fs.addReference(r,e),this.Ls.delete(r.toString()),ve.resolve()}removeReference(t,e,r){return this.Fs.removeReference(r,e),this.Ls.add(r.toString()),ve.resolve()}markPotentiallyOrphaned(t,e){return this.Ls.add(e.toString()),ve.resolve()}removeTarget(t,e){this.Fs.ls(e.targetId).forEach(s=>this.Ls.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(s=>{s.forEach(i=>this.Ls.add(i.toString()))}).next(()=>r.removeTargetData(t,e))}ks(){this.$s=new Set}Os(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ve.forEach(this.Ls,r=>{const s=tt.fromPath(r);return this.Us(t,s).next(i=>{i||e.removeEntry(s,Jt.min())})}).next(()=>(this.$s=null,e.apply(t)))}updateLimboDocument(t,e){return this.Us(t,e).next(r=>{r?this.Ls.delete(e.toString()):this.Ls.add(e.toString())})}xs(t){return 0}Us(t,e){return ve.or([()=>ve.resolve(this.Fs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ms(t,e)])}}class _I{constructor(t,e,r,s){this.targetId=t,this.fromCache=e,this.Si=r,this.Di=s}static Ci(t,e){let r=En(),s=En();for(const i of e.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new _I(t,e.fromCache,r,s)}}class NK{constructor(){this.xi=!1}initialize(t,e){this.Ni=t,this.indexManager=e,this.xi=!0}getDocumentsMatchingQuery(t,e,r,s){return this.ki(t,e).next(i=>i||this.Oi(t,e,s,r)).next(i=>i||this.Mi(t,e))}ki(t,e){if(gY(e))return ve.resolve(null);let r=to(e);return this.indexManager.getIndexType(t,r).next(s=>0===s?null:(null!==e.limit&&1===s&&(e=TE(e,null,"F"),r=to(e)),this.indexManager.getDocumentsMatchingTarget(t,r).next(i=>{const o=En(...i);return this.Ni.getDocuments(t,o).next(c=>this.indexManager.getMinOffset(t,r).next(u=>{const h=this.Fi(e,c);return this.$i(e,h,o,u.readTime)?this.ki(t,TE(e,null,"F")):this.Bi(t,h,e,u)}))})))}Oi(t,e,r,s){return gY(e)||s.isEqual(Jt.min())?this.Mi(t,e):this.Ni.getDocuments(t,r).next(i=>{const o=this.Fi(e,i);return this.$i(e,o,r,s)?this.Mi(t,e):(BO()<=u1.DEBUG&&Be("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),JO(e)),this.Bi(t,o,e,function qZ(n,t){const e=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=Jt.fromTimestamp(1e9===r?new qr(e+1,0):new qr(e,r));return new pa(s,tt.empty(),t)}(s,-1)))})}Fi(t,e){let r=new j1(vY(t));return e.forEach((s,i)=>{eI(t,i)&&(r=r.add(i))}),r}$i(t,e,r,s){if(null===t.limit)return!1;if(r.size!==e.size)return!0;const i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Mi(t,e){return BO()<=u1.DEBUG&&Be("QueryEngine","Using full collection scan to execute query:",JO(e)),this.Ni.getDocumentsMatchingQuery(t,e,pa.min())}Bi(t,e,r,s){return this.Ni.getDocumentsMatchingQuery(t,r,s).next(i=>(e.forEach(o=>{i=i.insert(o.key,o)}),i))}}class o_e{constructor(t,e,r,s){this.persistence=t,this.Li=e,this.It=s,this.Ui=new ss(pn),this.qi=new Q6(i=>o8(i),Vp),this.Ki=new Map,this.Gi=t.getRemoteDocumentCache(),this.Cs=t.getTargetCache(),this.Ns=t.getBundleCache(),this.Qi(r)}Qi(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new TK(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.Ui))}}function OK(n,t){return vI.apply(this,arguments)}function vI(){return vI=O(function*(n,t){const e=st(n);return yield e.persistence.runTransaction("Handle user change","readonly",r=>{let s;return e.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,e.Qi(t),e.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],c=[];let u=En();for(const h of s){o.push(h.batchId);for(const g of h.mutations)u=u.add(g.key)}for(const h of i){c.push(h.batchId);for(const g of h.mutations)u=u.add(g.key)}return e.localDocuments.getDocuments(r,u).next(h=>({ji:h,removedBatchIds:o,addedBatchIds:c}))})})}),vI.apply(this,arguments)}function a_e(n,t){const e=st(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=t.batch.keys(),i=e.Gi.newChangeBuffer({trackRemovals:!0});return function(o,c,u,h){const g=u.batch,m=g.keys();let v=ve.resolve();return m.forEach(T=>{v=v.next(()=>h.getEntry(c,T)).next(I=>{const z=u.docVersions.get(T);Qt(null!==z),I.version.compareTo(z)<0&&(g.applyToRemoteDocument(I,u),I.isValidDocument()&&(I.setReadTime(u.commitVersion),h.addEntry(I)))})}),v.next(()=>o.mutationQueue.removeMutationBatch(c,g))}(e,r,t,i).next(()=>i.apply(r)).next(()=>e.mutationQueue.performConsistencyCheck(r)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(r,s,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let c=En();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(c=c.add(o.batch.mutations[u].key));return c}(t))).next(()=>e.localDocuments.getDocuments(r,s))})}function IK(n){const t=st(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Cs.getLastRemoteSnapshotVersion(e))}function c_e(n,t){const e=st(n),r=t.snapshotVersion;let s=e.Ui;return e.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=e.Gi.newChangeBuffer({trackRemovals:!0});s=e.Ui;const c=[];t.targetChanges.forEach((g,m)=>{const v=s.get(m);if(!v)return;c.push(e.Cs.removeMatchingKeys(i,g.removedDocuments,m).next(()=>e.Cs.addMatchingKeys(i,g.addedDocuments,m)));let T=v.withSequenceNumber(i.currentSequenceNumber);var I,z,Z;t.targetMismatches.has(m)?T=T.withResumeToken(t2.EMPTY_BYTE_STRING,Jt.min()).withLastLimboFreeSnapshotVersion(Jt.min()):g.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(g.resumeToken,r)),s=s.insert(m,T),z=T,Z=g,(0===(I=v).resumeToken.approximateByteSize()||z.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=3e8||Z.addedDocuments.size+Z.modifiedDocuments.size+Z.removedDocuments.size>0)&&c.push(e.Cs.updateTargetData(i,T))});let u=Do(),h=En();if(t.documentUpdates.forEach(g=>{t.resolvedLimboDocuments.has(g)&&c.push(e.persistence.referenceDelegate.updateLimboDocument(i,g))}),c.push(function xK(n,t,e){let r=En(),s=En();return e.forEach(i=>r=r.add(i)),t.getEntries(n,r).next(i=>{let o=Do();return e.forEach((c,u)=>{const h=i.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(Jt.min())?(t.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||0===u.version.compareTo(h.version)&&h.hasPendingWrites?(t.addEntry(u),o=o.insert(c,u)):Be("LocalStore","Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{Wi:o,zi:s}})}(i,o,t.documentUpdates).next(g=>{u=g.Wi,h=g.zi})),!r.isEqual(Jt.min())){const g=e.Cs.getLastRemoteSnapshotVersion(i).next(m=>e.Cs.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(g)}return ve.waitFor(c).next(()=>o.apply(i)).next(()=>e.localDocuments.getLocalViewOfDocuments(i,u,h)).next(()=>u)}).then(i=>(e.Ui=s,i))}function l_e(n,t){const e=st(n);return e.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function tf(n,t){const e=st(n);return e.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return e.Cs.getTargetData(r,t).next(i=>i?(s=i,ve.resolve(s)):e.Cs.allocateTargetId(r).next(o=>(s=new J6(t,o,0,r.currentSequenceNumber),e.Cs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=e.Ui.get(r.targetId);return(null===s||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(e.Ui=e.Ui.insert(r.targetId,r),e.qi.set(t,r.targetId)),r})}function nf(n,t,e){return CI.apply(this,arguments)}function CI(){return CI=O(function*(n,t,e){const r=st(n),s=r.Ui.get(t),i=e?"readwrite":"readwrite-primary";try{e||(yield r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!j6(o))throw o;Be("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}r.Ui=r.Ui.remove(t),r.qi.delete(s.target)}),CI.apply(this,arguments)}function BE(n,t,e){const r=st(n);let s=Jt.min(),i=En();return r.persistence.runTransaction("Execute query","readonly",o=>function(c,u,h){const g=st(c),m=g.qi.get(h);return void 0!==m?ve.resolve(g.Ui.get(m)):g.Cs.getTargetData(u,h)}(r,o,to(t)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(o,c.targetId).next(u=>{i=u})}).next(()=>r.Li.getDocumentsMatchingQuery(o,t,e?s:Jt.min(),e?i:En())).next(c=>(function RK(n,t,e){let r=n.Ki.get(t)||Jt.min();e.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.Ki.set(t,r)}(r,function _Y(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}(t),c),{documents:c,Hi:i})))}class PI{constructor(){this.activeTargetIds=AE()}er(t){this.activeTargetIds=this.activeTargetIds.add(t)}nr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}tr(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class VK{constructor(){this.Lr=new PI,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,r){}addLocalQueryTarget(t){return this.Lr.er(t),this.Ur[t]||"not-current"}updateQueryState(t,e,r){this.Ur[t]=e}removeLocalQueryTarget(t){this.Lr.nr(t)}isLocalQueryTarget(t){return this.Lr.activeTargetIds.has(t)}clearQueryState(t){delete this.Ur[t]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(t){return this.Lr.activeTargetIds.has(t)}start(){return this.Lr=new PI,Promise.resolve()}handleUserChange(t,e,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class h_e{qr(t){}shutdown(){}}class HK{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(t){this.Wr.push(t)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){Be("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Wr)t(0)}jr(){Be("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Wr)t(1)}static C(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const d_e={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class p_e{constructor(t){this.Hr=t.Hr,this.Jr=t.Jr}Yr(t){this.Xr=t}Zr(t){this.eo=t}onMessage(t){this.no=t}close(){this.Jr()}send(t){this.Hr(t)}so(){this.Xr()}io(t){this.eo(t)}ro(t){this.no(t)}}class g_e extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.oo=(t.ssl?"https":"http")+"://"+t.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(t,e,r,s,i){const o=this.ho(t,e);Be("RestConnection","Sending: ",o,r);const c={};return this.lo(c,s,i),this.fo(t,o,c,r).then(u=>(Be("RestConnection","Received: ",u),u),u=>{throw F7("RestConnection",`${t} failed with error: `,u,"url: ",o,"request:",r),u})}_o(t,e,r,s,i,o){return this.ao(t,e,r,s,i)}lo(t,e,r){t["X-Goog-Api-Client"]="gl-js/ fire/"+H7,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((s,i)=>t[i]=s),r&&r.headers.forEach((s,i)=>t[i]=s)}ho(t,e){return`${this.oo}/v1/${e}:${d_e[t]}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}fo(t,e,r,s){return new Promise((i,o)=>{const c=new pge;c.setWithCredentials(!0),c.listenOnce(fge.COMPLETE,()=>{var h;try{switch(c.getLastErrorCode()){case FO.NO_ERROR:const g=c.getResponseJson();Be("Connection","XHR received:",JSON.stringify(g)),i(g);break;case FO.TIMEOUT:Be("Connection",'RPC "'+t+'" timed out'),o(new Ve(Me.DEADLINE_EXCEEDED,"Request time out"));break;case FO.HTTP_ERROR:const m=c.getStatus();if(Be("Connection",'RPC "'+t+'" failed with status:',m,"response text:",c.getResponseText()),m>0){let v=c.getResponseJson();Array.isArray(v)&&(v=v[0]);const T=null===(h=v)||void 0===h?void 0:h.error;if(T&&T.status&&T.message){const I=function(z){const Z=z.toLowerCase().replace(/_/g,"-");return Object.values(Me).indexOf(Z)>=0?Z:Me.UNKNOWN}(T.status);o(new Ve(I,T.message))}else o(new Ve(Me.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new Ve(Me.UNAVAILABLE,"Connection failed."));break;default:St()}}finally{Be("Connection",'RPC "'+t+'" completed.')}});const u=JSON.stringify(s);c.send(e,"POST",u,r,15)})}wo(t,e,r){const s=[this.oo,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=lge(),o=uge(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(c.xmlHttpFactory=new dge({})),this.lo(c.initMessageHeaders,e,r),c.encodeInitMessageHeaders=!0;const u=s.join("");Be("Connection","Creating WebChannel: "+u,c);const h=i.createWebChannel(u,c);let g=!1,m=!1;const v=new p_e({Hr:I=>{m?Be("Connection","Not sending because WebChannel is closed:",I):(g||(Be("Connection","Opening WebChannel transport."),h.open(),g=!0),Be("Connection","WebChannel sending:",I),h.send(I))},Jr:()=>h.close()}),T=(I,z,Z)=>{I.listen(z,te=>{try{Z(te)}catch(me){setTimeout(()=>{throw me},0)}})};return T(h,mE.EventType.OPEN,()=>{m||Be("Connection","WebChannel transport opened.")}),T(h,mE.EventType.CLOSE,()=>{m||(m=!0,Be("Connection","WebChannel transport closed"),v.io())}),T(h,mE.EventType.ERROR,I=>{m||(m=!0,F7("Connection","WebChannel transport errored:",I),v.io(new Ve(Me.UNAVAILABLE,"The operation could not be completed")))}),T(h,mE.EventType.MESSAGE,I=>{var z;if(!m){const Z=I.data[0];Qt(!!Z);const te=Z,me=te.error||(null===(z=te[0])||void 0===z?void 0:z.error);if(me){Be("Connection","WebChannel received error:",me);const J=me.status;let Ne=function(qe){const Dt=ks[qe];if(void 0!==Dt)return LY(Dt)}(J),He=me.message;void 0===Ne&&(Ne=Me.INTERNAL,He="Unknown error status: "+J+" with message "+me.message),m=!0,v.io(new Ve(Ne,He)),h.close()}else Be("Connection","WebChannel received:",Z),v.ro(Z)}}),T(o,hge.STAT_EVENT,I=>{I.stat===FZ.PROXY?Be("Connection","Detected buffering proxy"):I.stat===FZ.NOPROXY&&Be("Connection","Detected no buffering proxy")}),setTimeout(()=>{v.so()},0),v}}function GE(){return typeof document<"u"?document:null}function sg(n){return new ime(n,!0)}class wI{constructor(t,e,r=1e3,s=1.5,i=6e4){this.Hs=t,this.timerId=e,this.mo=r,this.yo=s,this.po=i,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(t){this.cancel();const e=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),s=Math.max(0,e-r);s>0&&Be("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Io} ms, delay with jitter: ${e} ms, last attempt: ${r} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,s,()=>(this.Eo=Date.now(),t())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class BK{constructor(t,e,r,s,i,o,c,u){this.Hs=t,this.vo=r,this.Vo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new wI(t,e)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}stop(){var t=this;return O(function*(){t.No()&&(yield t.close(0))})()}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.$o()))}Bo(t){this.Lo(),this.stream.send(t)}$o(){var t=this;return O(function*(){if(t.ko())return t.close(0)})()}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}close(t,e){var r=this;return O(function*(){r.Lo(),r.Uo(),r.xo.cancel(),r.So++,4!==t?r.xo.reset():e&&e.code===Me.RESOURCE_EXHAUSTED?(_s(e.toString()),_s("Using maximum backoff delay to prevent overloading the backend."),r.xo.Ao()):e&&e.code===Me.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.qo(),r.stream.close(),r.stream=null),r.state=t,yield r.listener.Zr(e)})()}qo(){}auth(){this.state=1;const t=this.Ko(this.So),e=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.So===e&&this.Go(r,s)},r=>{t(()=>{const s=new Ve(Me.UNKNOWN,"Fetching auth token failed: "+r.message);return this.Qo(s)})})}Go(t,e){const r=this.Ko(this.So);this.stream=this.jo(t,e),this.stream.Yr(()=>{r(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(s=>{r(()=>this.Qo(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Oo(){var t=this;this.state=5,this.xo.Ro(O(function*(){t.state=0,t.start()}))}Qo(t){return Be("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Ko(t){return e=>{this.Hs.enqueueAndForget(()=>this.So===t?e():(Be("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class m_e extends BK{constructor(t,e,r,s,i,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,r,s,o),this.It=i}jo(t,e){return this.connection.wo("Listen",t,e)}onMessage(t){this.xo.reset();const e=function cme(n,t){let e;if("targetChange"in t){const r="NO_CHANGE"===(u=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===u?1:"REMOVE"===u?2:"CURRENT"===u?3:"RESET"===u?4:St(),s=t.targetChange.targetIds||[],i=function(u,h){return u.gt?(Qt(void 0===h||"string"==typeof h),t2.fromBase64String(h||"")):(Qt(void 0===h||h instanceof Uint8Array),t2.fromUint8Array(h||new Uint8Array))}(n,t.targetChange.resumeToken),o=t.targetChange.cause,c=o&&function(u){const h=void 0===u.code?Me.UNKNOWN:LY(u.code);return new Ve(h,u.message||"")}(o);e=new VY(r,s,i,c||null)}else if("documentChange"in t){const r=t.documentChange,s=K3(n,r.document.name),i=T2(r.document.updateTime),o=new si({mapValue:{fields:r.document.fields}}),c=ur.newFoundDocument(s,i,o);e=new OE(r.targetIds||[],r.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){const r=t.documentDelete,s=K3(n,r.document),i=r.readTime?T2(r.readTime):Jt.min(),o=ur.newNoDocument(s,i);e=new OE([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in t){const r=t.documentRemove,s=K3(n,r.document);e=new OE([],r.removedTargetIds||[],s,null)}else{if(!("filter"in t))return St();{const r=t.filter,i=new Xge(r.count||0);e=new zY(r.targetId,i)}}var u;return e}(this.It,t),r=function(s){if(!("targetChange"in s))return Jt.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?Jt.min():i.readTime?T2(i.readTime):Jt.min()}(t);return this.listener.Wo(e,r)}zo(t){const e={};e.database=Zp(this.It),e.addTarget=function(s,i){let o;const c=i.target;return o=SE(c)?{documents:ZY(s,c)}:{query:iI(s,c)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=$Y(s,i.resumeToken):i.snapshotVersion.compareTo(Jt.min())>0&&(o.readTime=qp(s,i.snapshotVersion.toTimestamp())),o}(this.It,t);const r=function ume(n,t){const e=function(r,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return St()}}(0,t.purpose);return null==e?null:{"goog-listen-tags":e}}(0,t);r&&(e.labels=r),this.Bo(e)}Ho(t){const e={};e.database=Zp(this.It),e.removeTarget=t,this.Bo(e)}}class __e extends BK{constructor(t,e,r,s,i,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,r,s,o),this.It=i,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Jo&&this.Xo([])}jo(t,e){return this.connection.wo("Write",t,e)}onMessage(t){if(Qt(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Jo){this.xo.reset();const e=function lme(n,t){return n&&n.length>0?(Qt(void 0!==t),n.map(e=>function(r,s){let i=T2(r.updateTime?r.updateTime:s);return i.isEqual(Jt.min())&&(i=T2(s)),new Zge(i,r.transformResults||[])}(e,t))):[]}(t.writeResults,t.commitTime),r=T2(t.commitTime);return this.listener.Zo(r,e)}return Qt(!t.writeResults||0===t.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const t={};t.database=Zp(this.It),this.Bo(t)}Xo(t){const e={streamToken:this.lastStreamToken,writes:t.map(r=>function Yp(n,t){let e;if(t instanceof Y7)e={update:qY(n,t.key,t.value)};else if(t instanceof K7)e={delete:jp(n,t.key)};else if(t instanceof cl)e={update:qY(n,t.key,t.data),updateMask:gme(t.fieldMask)};else{if(!(t instanceof tI))return St();e={verify:jp(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof j7)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof a8)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof c8)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Z7)return{fieldPath:i.field.canonicalString(),increment:o.yt};throw St()}(0,r))),t.precondition.isNone||(e.currentDocument=void 0!==(s=t.precondition).updateTime?{updateTime:ome(n,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:St()),e;var s}(this.It,r))};this.Bo(e)}}class v_e extends class{}{constructor(t,e,r,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=r,this.It=s,this.nu=!1}su(){if(this.nu)throw new Ve(Me.FAILED_PRECONDITION,"The client has already been terminated.")}ao(t,e,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.ao(t,e,r,s,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===Me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ve(Me.UNKNOWN,s.toString())})}_o(t,e,r,s){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection._o(t,e,r,i,o,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===Me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ve(Me.UNKNOWN,i.toString())})}terminate(){this.nu=!0}}class y_e{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(t){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.cu("Offline")))}set(t){this.lu(),this.iu=0,"Online"===t&&(this.ou=!1),this.cu(t)}cu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}au(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(_s(e),this.ou=!1):Be("OnlineStateTracker",e)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class E_e{constructor(t,e,r,s,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=r,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=i,this.mu.qr(c=>{r.enqueueAndForget(O(function*(){var u;ll(o)&&(Be("RemoteStore","Restarting streams for network reachability change."),yield(u=O(function*(h){const g=st(h);g._u.add(4),yield rf(g),g.gu.set("Unknown"),g._u.delete(4),yield ig(g)}),function(h){return u.apply(this,arguments)})(o))}))}),this.gu=new y_e(r,s)}}function ig(n){return NI.apply(this,arguments)}function NI(){return NI=O(function*(n){if(ll(n))for(const t of n.wu)yield t(!0)}),NI.apply(this,arguments)}function rf(n){return AI.apply(this,arguments)}function AI(){return AI=O(function*(n){for(const t of n.wu)yield t(!1)}),AI.apply(this,arguments)}function WE(n,t){const e=st(n);e.du.has(t.targetId)||(e.du.set(t.targetId,t),xI(e)?II(e):af(e).ko()&&OI(e,t))}function og(n,t){const e=st(n),r=af(e);e.du.delete(t),r.ko()&&$K(e,t),0===e.du.size&&(r.ko()?r.Fo():ll(e)&&e.gu.set("Unknown"))}function OI(n,t){n.yu.Mt(t.targetId),af(n).zo(t)}function $K(n,t){n.yu.Mt(t),af(n).Ho(t)}function II(n){n.yu=new nme({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),se:t=>n.du.get(t)||null}),af(n).start(),n.gu.uu()}function xI(n){return ll(n)&&!af(n).No()&&n.du.size>0}function ll(n){return 0===st(n)._u.size}function UK(n){n.yu=void 0}function M_e(n){return LI.apply(this,arguments)}function LI(){return LI=O(function*(n){n.du.forEach((t,e)=>{OI(n,t)})}),LI.apply(this,arguments)}function S_e(n,t){return kI.apply(this,arguments)}function kI(){return kI=O(function*(n,t){UK(n),xI(n)?(n.gu.hu(t),II(n)):n.gu.set("Unknown")}),kI.apply(this,arguments)}function P_e(n,t,e){return RI.apply(this,arguments)}function RI(){return RI=O(function*(n,t,e){if(n.gu.set("Online"),t instanceof VY&&2===t.state&&t.cause)try{yield(r=O(function*(s,i){const o=i.cause;for(const c of i.targetIds)s.du.has(c)&&(yield s.remoteSyncer.rejectListen(c,o),s.du.delete(c),s.yu.removeTarget(c))}),function(s,i){return r.apply(this,arguments)})(n,t)}catch(r){Be("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),yield qE(n,r)}else if(t instanceof OE?n.yu.Gt(t):t instanceof zY?n.yu.Yt(t):n.yu.Wt(t),!e.isEqual(Jt.min()))try{const r=yield IK(n.localStore);e.compareTo(r)>=0&&(yield function(s,i){const o=s.yu.te(i);return o.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=s.du.get(u);h&&s.du.set(u,h.withResumeToken(c.resumeToken,i))}}),o.targetMismatches.forEach(c=>{const u=s.du.get(c);if(!u)return;s.du.set(c,u.withResumeToken(t2.EMPTY_BYTE_STRING,u.snapshotVersion)),$K(s,c);const h=new J6(u.target,c,1,u.sequenceNumber);OI(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(n,e))}catch(r){Be("RemoteStore","Failed to raise snapshot:",r),yield qE(n,r)}var r}),RI.apply(this,arguments)}function qE(n,t,e){return DI.apply(this,arguments)}function DI(){return DI=O(function*(n,t,e){if(!j6(t))throw t;n._u.add(1),yield rf(n),n.gu.set("Offline"),e||(e=()=>IK(n.localStore)),n.asyncQueue.enqueueRetryable(O(function*(){Be("RemoteStore","Retrying IndexedDB access"),yield e(),n._u.delete(1),yield ig(n)}))}),DI.apply(this,arguments)}function GK(n,t){return t().catch(e=>qE(n,e,t))}function sf(n){return zI.apply(this,arguments)}function zI(){return zI=O(function*(n){const t=st(n),e=n0(t);let r=t.fu.length>0?t.fu[t.fu.length-1].batchId:-1;for(;T_e(t);)try{const s=yield l_e(t.localStore,r);if(null===s){0===t.fu.length&&e.Fo();break}r=s.batchId,w_e(t,s)}catch(s){yield qE(t,s)}WK(t)&&qK(t)}),zI.apply(this,arguments)}function T_e(n){return ll(n)&&n.fu.length<10}function w_e(n,t){n.fu.push(t);const e=n0(n);e.ko()&&e.Yo&&e.Xo(t.mutations)}function WK(n){return ll(n)&&!n0(n).No()&&n.fu.length>0}function qK(n){n0(n).start()}function b_e(n){return VI.apply(this,arguments)}function VI(){return VI=O(function*(n){n0(n).eu()}),VI.apply(this,arguments)}function N_e(n){return HI.apply(this,arguments)}function HI(){return HI=O(function*(n){const t=n0(n);for(const e of n.fu)t.Xo(e.mutations)}),HI.apply(this,arguments)}function A_e(n,t,e){return FI.apply(this,arguments)}function FI(){return FI=O(function*(n,t,e){const r=n.fu.shift(),s=cI.from(r,t,e);yield GK(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),yield sf(n)}),FI.apply(this,arguments)}function O_e(n,t){return BI.apply(this,arguments)}function BI(){return BI=O(function*(n,t){var e;t&&n0(n).Yo&&(yield(e=O(function*(r,s){if(xY(i=s.code)&&i!==Me.ABORTED){const o=r.fu.shift();n0(r).Mo(),yield GK(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield sf(r)}var i}),function(r,s){return e.apply(this,arguments)})(n,t)),WK(n)&&qK(n)}),BI.apply(this,arguments)}function jK(n,t){return $I.apply(this,arguments)}function $I(){return $I=O(function*(n,t){const e=st(n);e.asyncQueue.verifyOperationInProgress(),Be("RemoteStore","RemoteStore received new credentials");const r=ll(e);e._u.add(3),yield rf(e),r&&e.gu.set("Unknown"),yield e.remoteSyncer.handleCredentialChange(t),e._u.delete(3),yield ig(e)}),$I.apply(this,arguments)}function GI(){return GI=O(function*(n,t){const e=st(n);t?(e._u.delete(2),yield ig(e)):t||(e._u.add(2),yield rf(e),e.gu.set("Unknown"))}),GI.apply(this,arguments)}function af(n){return n.pu||(n.pu=function(t,e,r){const s=st(t);return s.su(),new m_e(e,s.connection,s.authCredentials,s.appCheckCredentials,s.It,r)}(n.datastore,n.asyncQueue,{Yr:M_e.bind(null,n),Zr:S_e.bind(null,n),Wo:P_e.bind(null,n)}),n.wu.push(function(){var t=O(function*(e){e?(n.pu.Mo(),xI(n)?II(n):n.gu.set("Unknown")):(yield n.pu.stop(),UK(n))});return function(e){return t.apply(this,arguments)}}())),n.pu}function n0(n){return n.Iu||(n.Iu=function(t,e,r){const s=st(t);return s.su(),new __e(e,s.connection,s.authCredentials,s.appCheckCredentials,s.It,r)}(n.datastore,n.asyncQueue,{Yr:b_e.bind(null,n),Zr:O_e.bind(null,n),tu:N_e.bind(null,n),Zo:A_e.bind(null,n)}),n.wu.push(function(){var t=O(function*(e){e?(n.Iu.Mo(),yield sf(n)):(yield n.Iu.stop(),n.fu.length>0&&(Be("RemoteStore",`Stopping write stream with ${n.fu.length} pending writes`),n.fu=[]))});return function(e){return t.apply(this,arguments)}}())),n.Iu}class WI{constructor(t,e,r,s,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new e2,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(t,e,r,s,i){const o=Date.now()+r,c=new WI(t,e,o,s,i);return c.start(r),c}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ve(Me.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function cf(n,t){if(_s("AsyncQueue",`${t}: ${n}`),j6(n))return new Ve(Me.UNAVAILABLE,`${t}: ${n}`);throw n}class lf{constructor(t){this.comparator=t?(e,r)=>t(e,r)||tt.comparator(e.key,r.key):(e,r)=>tt.comparator(e.key,r.key),this.keyedMap=$p(),this.sortedSet=new ss(this.comparator)}static emptySet(t){return new lf(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,r)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof lf)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;e.hasNext();){const s=e.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const r=new lf;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=e,r}}class ZK{constructor(){this.Tu=new ss(tt.comparator)}track(t){const e=t.doc.key,r=this.Tu.get(e);r?0!==t.type&&3===r.type?this.Tu=this.Tu.insert(e,t):3===t.type&&1!==r.type?this.Tu=this.Tu.insert(e,{type:r.type,doc:t.doc}):2===t.type&&2===r.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):2===t.type&&0===r.type?this.Tu=this.Tu.insert(e,{type:0,doc:t.doc}):1===t.type&&0===r.type?this.Tu=this.Tu.remove(e):1===t.type&&2===r.type?this.Tu=this.Tu.insert(e,{type:1,doc:r.doc}):0===t.type&&1===r.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):St():this.Tu=this.Tu.insert(e,t)}Eu(){const t=[];return this.Tu.inorderTraversal((e,r)=>{t.push(r)}),t}}class uf{constructor(t,e,r,s,i,o,c,u,h){this.query=t,this.docs=e,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(t,e,r,s,i){const o=[];return e.forEach(c=>{o.push({type:0,doc:c})}),new uf(t,e,lf.emptySet(e),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Hp(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,r=t.docChanges;if(e.length!==r.length)return!1;for(let s=0;s<e.length;s++)if(e[s].type!==r[s].type||!e[s].doc.isEqual(r[s].doc))return!1;return!0}}class I_e{constructor(){this.Au=void 0,this.listeners=[]}}class x_e{constructor(){this.queries=new Q6(t=>mY(t),Hp),this.onlineState="Unknown",this.Ru=new Set}}function qI(n,t){return jI.apply(this,arguments)}function jI(){return jI=O(function*(n,t){const e=st(n),r=t.query;let s=!1,i=e.queries.get(r);if(i||(s=!0,i=new I_e),s)try{i.Au=yield e.onListen(r)}catch(o){const c=cf(o,`Initialization of query '${JO(t.query)}' failed`);return void t.onError(c)}e.queries.set(r,i),i.listeners.push(t),t.bu(e.onlineState),i.Au&&t.Pu(i.Au)&&KI(e)}),jI.apply(this,arguments)}function ZI(n,t){return YI.apply(this,arguments)}function YI(){return YI=O(function*(n,t){const e=st(n),r=t.query;let s=!1;const i=e.queries.get(r);if(i){const o=i.listeners.indexOf(t);o>=0&&(i.listeners.splice(o,1),s=0===i.listeners.length)}if(s)return e.queries.delete(r),e.onUnlisten(r)}),YI.apply(this,arguments)}function L_e(n,t){const e=st(n);let r=!1;for(const s of t){const o=e.queries.get(s.query);if(o){for(const c of o.listeners)c.Pu(s)&&(r=!0);o.Au=s}}r&&KI(e)}function k_e(n,t,e){const r=st(n),s=r.queries.get(t);if(s)for(const i of s.listeners)i.onError(e);r.queries.delete(t)}function KI(n){n.Ru.forEach(t=>{t.next()})}class XI{constructor(t,e,r){this.query=t,this.vu=e,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=r||{}}Pu(t){if(!this.options.includeMetadataChanges){const r=[];for(const s of t.docChanges)3!==s.type&&r.push(s);t=new uf(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Vu?this.Du(t)&&(this.vu.next(t),e=!0):this.Cu(t,this.onlineState)&&(this.xu(t),e=!0),this.Su=t,e}onError(t){this.vu.error(t)}bu(t){this.onlineState=t;let e=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,t)&&(this.xu(this.Su),e=!0),e}Cu(t,e){return!t.fromCache||(!this.options.Nu||!("Offline"!==e))&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Du(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Su&&this.Su.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges}xu(t){t=uf.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Vu=!0,this.vu.next(t)}}class XK{constructor(t){this.key=t}}class QK{constructor(t){this.key=t}}class JK{constructor(t,e){this.query=t,this.Uu=e,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=En(),this.mutatedKeys=En(),this.Gu=vY(t),this.Qu=new lf(this.Gu)}get ju(){return this.Uu}Wu(t,e){const r=e?e.zu:new ZK,s=e?e.Qu:this.Qu;let i=e?e.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u="F"===this.query.limitType&&s.size===this.query.limit?s.last():null,h="L"===this.query.limitType&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((g,m)=>{const v=s.get(g),T=eI(this.query,m)?m:null,I=!!v&&this.mutatedKeys.has(v.key),z=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let Z=!1;v&&T?v.data.isEqual(T.data)?I!==z&&(r.track({type:3,doc:T}),Z=!0):this.Hu(v,T)||(r.track({type:2,doc:T}),Z=!0,(u&&this.Gu(T,u)>0||h&&this.Gu(T,h)<0)&&(c=!0)):!v&&T?(r.track({type:0,doc:T}),Z=!0):v&&!T&&(r.track({type:1,doc:v}),Z=!0,(u||h)&&(c=!0)),Z&&(T?(o=o.add(T),i=z?i.add(g):i.delete(g)):(o=o.delete(g),i=i.delete(g)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const g="F"===this.query.limitType?o.last():o.first();o=o.delete(g.key),i=i.delete(g.key),r.track({type:1,doc:g})}return{Qu:o,zu:r,$i:c,mutatedKeys:i}}Hu(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,r){const s=this.Qu;this.Qu=t.Qu,this.mutatedKeys=t.mutatedKeys;const i=t.zu.Eu();i.sort((h,g)=>function(m,v){const T=I=>{switch(I){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return St()}};return T(m)-T(v)}(h.type,g.type)||this.Gu(h.doc,g.doc)),this.Ju(r);const o=e?this.Yu():[],c=0===this.Ku.size&&this.current?1:0,u=c!==this.qu;return this.qu=c,0!==i.length||u?{snapshot:new uf(this.query,t.Qu,s,i,t.mutatedKeys,0===c,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),Xu:o}:{Xu:o}}bu(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new ZK,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(t){return!this.Uu.has(t)&&!!this.Qu.has(t)&&!this.Qu.get(t).hasLocalMutations}Ju(t){t&&(t.addedDocuments.forEach(e=>this.Uu=this.Uu.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.Uu=this.Uu.delete(e)),this.current=t.current)}Yu(){if(!this.current)return[];const t=this.Ku;this.Ku=En(),this.Qu.forEach(r=>{this.Zu(r.key)&&(this.Ku=this.Ku.add(r.key))});const e=[];return t.forEach(r=>{this.Ku.has(r)||e.push(new QK(r))}),this.Ku.forEach(r=>{t.has(r)||e.push(new XK(r))}),e}tc(t){this.Uu=t.Hi,this.Ku=En();const e=this.Wu(t.documents);return this.applyChanges(e,!0)}ec(){return uf.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}class z_e{constructor(t,e,r){this.query=t,this.targetId=e,this.view=r}}class V_e{constructor(t){this.key=t,this.nc=!1}}class H_e{constructor(t,e,r,s,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.sc={},this.ic=new Q6(c=>mY(c),Hp),this.rc=new Map,this.oc=new Set,this.uc=new ss(tt.comparator),this.cc=new Map,this.ac=new dI,this.hc={},this.lc=new Map,this.fc=g8.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}function F_e(n,t){return QI.apply(this,arguments)}function QI(){return QI=O(function*(n,t){const e=Ex(n);let r,s;const i=e.ic.get(t);if(i)r=i.targetId,e.sharedClientState.addLocalQueryTarget(r),s=i.view.ec();else{const o=yield tf(e.localStore,to(t));e.isPrimaryClient&&WE(e.remoteStore,o);const c=e.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=yield JI(e,t,r,"current"===c,o.resumeToken)}return s}),QI.apply(this,arguments)}function JI(n,t,e,r,s){return ex.apply(this,arguments)}function ex(){return ex=O(function*(n,t,e,r,s){n._c=(m,v,T)=>{return(I=O(function*(z,Z,te,me){let J=Z.view.Wu(te);J.$i&&(J=yield BE(z.localStore,Z.query,!1).then(({documents:qe})=>Z.view.Wu(qe,J)));const Ne=me&&me.targetChanges.get(Z.targetId),He=Z.view.applyChanges(J,z.isPrimaryClient,Ne);return ux(z,Z.targetId,He.Xu),He.snapshot}),function(z,Z,te,me){return I.apply(this,arguments)})(n,m,v,T);var I};const i=yield BE(n.localStore,t,!0),o=new JK(t,i.Hi),c=o.Wu(i.documents),u=Wp.createSynthesizedTargetChangeForCurrentChange(e,r&&"Offline"!==n.onlineState,s),h=o.applyChanges(c,n.isPrimaryClient,u);ux(n,e,h.Xu);const g=new z_e(t,e,o);return n.ic.set(t,g),n.rc.has(e)?n.rc.get(e).push(t):n.rc.set(e,[t]),h.snapshot}),ex.apply(this,arguments)}function B_e(n,t){return tx.apply(this,arguments)}function tx(){return tx=O(function*(n,t){const e=st(n),r=e.ic.get(t),s=e.rc.get(r.targetId);if(s.length>1)return e.rc.set(r.targetId,s.filter(i=>!Hp(i,t))),void e.ic.delete(t);e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(r.targetId),e.sharedClientState.isActiveQueryTarget(r.targetId)||(yield nf(e.localStore,r.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(r.targetId),og(e.remoteStore,r.targetId),ff(e,r.targetId)}).catch(q6))):(ff(e,r.targetId),yield nf(e.localStore,r.targetId,!0))}),tx.apply(this,arguments)}function nx(){return nx=O(function*(n,t,e){const r=Mx(n);try{const s=yield function(i,o){const c=st(i),u=qr.now(),h=o.reduce((v,T)=>v.add(T.key),En());let g,m;return c.persistence.runTransaction("Locally write mutations","readwrite",v=>{let T=Do(),I=En();return c.Gi.getEntries(v,h).next(z=>{T=z,T.forEach((Z,te)=>{te.isValidDocument()||(I=I.add(Z))})}).next(()=>c.localDocuments.getOverlayedDocuments(v,T)).next(z=>{g=z;const Z=[];for(const te of o){const me=Kge(te,g.get(te.key).overlayedDocument);null!=me&&Z.push(new cl(te.key,me,aY(me.value.mapValue),kr.exists(!0)))}return c.mutationQueue.addMutationBatch(v,u,Z,o)}).next(z=>{m=z;const Z=z.applyToLocalDocumentSet(g,I);return c.documentOverlayCache.saveOverlays(v,z.batchId,Z)})}).then(()=>({batchId:m.batchId,changes:RY(g)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,c){let u=i.hc[i.currentUser.toKey()];u||(u=new ss(pn)),u=u.insert(o,c),i.hc[i.currentUser.toKey()]=u}(r,s.batchId,e),yield ul(r,s.changes),yield sf(r.remoteStore)}catch(s){const i=cf(s,"Failed to persist write");e.reject(i)}}),nx.apply(this,arguments)}function eX(n,t){return rx.apply(this,arguments)}function rx(){return rx=O(function*(n,t){const e=st(n);try{const r=yield c_e(e.localStore,t);t.targetChanges.forEach((s,i)=>{const o=e.cc.get(i);o&&(Qt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.nc=!0:s.modifiedDocuments.size>0?Qt(o.nc):s.removedDocuments.size>0&&(Qt(o.nc),o.nc=!1))}),yield ul(e,r,t)}catch(r){yield q6(r)}}),rx.apply(this,arguments)}function tX(n,t,e){const r=st(n);if(r.isPrimaryClient&&0===e||!r.isPrimaryClient&&1===e){const s=[];r.ic.forEach((i,o)=>{const c=o.view.bu(t);c.snapshot&&s.push(c.snapshot)}),function(i,o){const c=st(i);c.onlineState=o;let u=!1;c.queries.forEach((h,g)=>{for(const m of g.listeners)m.bu(o)&&(u=!0)}),u&&KI(c)}(r.eventManager,t),s.length&&r.sc.Wo(s),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function U_e(n,t,e){return sx.apply(this,arguments)}function sx(){return sx=O(function*(n,t,e){const r=st(n);r.sharedClientState.updateQueryState(t,"rejected",e);const s=r.cc.get(t),i=s&&s.key;if(i){let o=new ss(tt.comparator);o=o.insert(i,ur.newNoDocument(i,Jt.min()));const c=En().add(i),u=new Gp(Jt.min(),new Map,new j1(pn),o,c);yield eX(r,u),r.uc=r.uc.remove(i),r.cc.delete(t),fx(r)}else yield nf(r.localStore,t,!1).then(()=>ff(r,t,e)).catch(q6)}),sx.apply(this,arguments)}function G_e(n,t){return ix.apply(this,arguments)}function ix(){return ix=O(function*(n,t){const e=st(n),r=t.batch.batchId;try{const s=yield a_e(e.localStore,t);lx(e,r,null),cx(e,r),e.sharedClientState.updateMutationState(r,"acknowledged"),yield ul(e,s)}catch(s){yield q6(s)}}),ix.apply(this,arguments)}function W_e(n,t,e){return ox.apply(this,arguments)}function ox(){return ox=O(function*(n,t,e){const r=st(n);try{const s=yield function(i,o){const c=st(i);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return c.mutationQueue.lookupMutationBatch(u,o).next(g=>(Qt(null!==g),h=g.keys(),c.mutationQueue.removeMutationBatch(u,g))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>c.localDocuments.getDocuments(u,h))})}(r.localStore,t);lx(r,t,e),cx(r,t),r.sharedClientState.updateMutationState(t,"rejected",e),yield ul(r,s)}catch(s){yield q6(s)}}),ox.apply(this,arguments)}function cx(n,t){(n.lc.get(t)||[]).forEach(e=>{e.resolve()}),n.lc.delete(t)}function lx(n,t,e){const r=st(n);let s=r.hc[r.currentUser.toKey()];if(s){const i=s.get(t);i&&(e?i.reject(e):i.resolve(),s=s.remove(t)),r.hc[r.currentUser.toKey()]=s}}function ff(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const r of n.rc.get(t))n.ic.delete(r),e&&n.sc.wc(r,e);n.rc.delete(t),n.isPrimaryClient&&n.ac.ls(t).forEach(r=>{n.ac.containsKey(r)||nX(n,r)})}function nX(n,t){n.oc.delete(t.path.canonicalString());const e=n.uc.get(t);null!==e&&(og(n.remoteStore,e),n.uc=n.uc.remove(t),n.cc.delete(e),fx(n))}function ux(n,t,e){for(const r of e)r instanceof XK?(n.ac.addReference(r.key,t),j_e(n,r)):r instanceof QK?(Be("SyncEngine","Document no longer in limbo: "+r.key),n.ac.removeReference(r.key,t),n.ac.containsKey(r.key)||nX(n,r.key)):St()}function j_e(n,t){const e=t.key,r=e.path.canonicalString();n.uc.get(e)||n.oc.has(r)||(Be("SyncEngine","New document in limbo: "+e),n.oc.add(r),fx(n))}function fx(n){for(;n.oc.size>0&&n.uc.size<n.maxConcurrentLimboResolutions;){const t=n.oc.values().next().value;n.oc.delete(t);const e=new tt(f1.fromString(t)),r=n.fc.next();n.cc.set(r,new V_e(e)),n.uc=n.uc.insert(e,r),WE(n.remoteStore,new J6(to(W7(e.path)),r,2,Ro.at))}}function ul(n,t,e){return hx.apply(this,arguments)}function hx(){return hx=O(function*(n,t,e){const r=st(n),s=[],i=[],o=[];var c;r.ic.isEmpty()||(r.ic.forEach((c,u)=>{o.push(r._c(u,t,e).then(h=>{if((h||e)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,h?.fromCache?"not-current":"current"),h){s.push(h);const g=_I.Ci(u.targetId,h);i.push(g)}}))}),yield Promise.all(o),r.sc.Wo(s),yield(c=O(function*(u,h){const g=st(u);try{yield g.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>ve.forEach(h,v=>ve.forEach(v.Si,T=>g.persistence.referenceDelegate.addReference(m,v.targetId,T)).next(()=>ve.forEach(v.Di,T=>g.persistence.referenceDelegate.removeReference(m,v.targetId,T)))))}catch(m){if(!j6(m))throw m;Be("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const v=m.targetId;if(!m.fromCache){const T=g.Ui.get(v),z=T.withLastLimboFreeSnapshotVersion(T.snapshotVersion);g.Ui=g.Ui.insert(v,z)}}}),function(u,h){return c.apply(this,arguments)})(r.localStore,i))}),hx.apply(this,arguments)}function Z_e(n,t){return dx.apply(this,arguments)}function dx(){return dx=O(function*(n,t){const e=st(n);if(!e.currentUser.isEqual(t)){Be("SyncEngine","User change. New user:",t.toKey());const r=yield OK(e.localStore,t);e.currentUser=t,(s=e).lc.forEach(o=>{o.forEach(c=>{c.reject(new Ve(Me.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.lc.clear(),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),yield ul(e,r.ji)}var s}),dx.apply(this,arguments)}function Y_e(n,t){const e=st(n),r=e.cc.get(t);if(r&&r.nc)return En().add(r.key);{let s=En();const i=e.rc.get(t);if(!i)return s;for(const o of i){const c=e.ic.get(o);s=s.unionWith(c.view.ju)}return s}}function Ex(n){const t=st(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=eX.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Y_e.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=U_e.bind(null,t),t.sc.Wo=L_e.bind(null,t.eventManager),t.sc.wc=k_e.bind(null,t.eventManager),t}function Mx(n){const t=st(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=G_e.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=W_e.bind(null,t),t}class sve{constructor(){this.synchronizeTabs=!1}initialize(t){var e=this;return O(function*(){e.It=sg(t.databaseInfo.databaseId),e.sharedClientState=e.gc(t),e.persistence=e.yc(t),yield e.persistence.start(),e.localStore=e.Ic(t),e.gcScheduler=e.Tc(t,e.localStore),e.indexBackfillerScheduler=e.Ec(t,e.localStore)})()}Tc(t,e){return null}Ec(t,e){return null}Ic(t){return function AK(n,t,e,r){return new o_e(n,t,e,r)}(this.persistence,new NK,t.initialUser,this.It)}yc(t){return new wK(HE.Bs,this.It)}gc(t){return new VK}terminate(){var t=this;return O(function*(){t.gcScheduler&&t.gcScheduler.stop(),yield t.sharedClientState.shutdown(),yield t.persistence.shutdown()})()}}class Sx{initialize(t,e){var r=this;return O(function*(){r.localStore||(r.localStore=t.localStore,r.sharedClientState=t.sharedClientState,r.datastore=r.createDatastore(e),r.remoteStore=r.createRemoteStore(e),r.eventManager=r.createEventManager(e),r.syncEngine=r.createSyncEngine(e,!t.synchronizeTabs),r.sharedClientState.onlineStateHandler=s=>tX(r.syncEngine,s,1),r.remoteStore.remoteSyncer.handleCredentialChange=Z_e.bind(null,r.syncEngine),yield function UI(n,t){return GI.apply(this,arguments)}(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(t){return new x_e}createDatastore(t){const e=sg(t.databaseInfo.databaseId),r=new g_e(t.databaseInfo);return new v_e(t.authCredentials,t.appCheckCredentials,r,e)}createRemoteStore(t){return e=this.localStore,r=this.datastore,s=t.asyncQueue,i=c=>tX(this.syncEngine,c,0),o=HK.C()?new HK:new h_e,new E_e(e,r,s,i,o);var e,r,s,i,o}createSyncEngine(t,e){return function(r,s,i,o,c,u,h){const g=new H_e(r,s,i,o,c,u);return h&&(g.dc=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return(t=O(function*(e){const r=st(e);Be("RemoteStore","RemoteStore shutting down."),r._u.add(5),yield rf(r),r.mu.shutdown(),r.gu.set("Unknown")}),function(e){return t.apply(this,arguments)})(this.remoteStore);var t}}function Px(n,t,e){if(!e)throw new Ve(Me.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function iX(n){if(!tt.isDocumentKey(n))throw new Ve(Me.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function oX(n){if(tt.isDocumentKey(n))throw new Ve(Me.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function jE(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const t=(e=n).constructor?e.constructor.name:null;return t?`a custom ${t} object`:"an object"}}var e;return"function"==typeof n?"a function":St()}function i1(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new Ve(Me.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=jE(n);throw new Ve(Me.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}const cX=new Map;class lX{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ve(Me.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Ve(Me.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function ave(n,t,e,r){if(!0===t&&!0===r)throw new Ve(Me.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class ag{constructor(t,e,r,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lX({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Ve(Me.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Ve(Me.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lX(t),void 0!==t.credentials&&(this._authCredentials=function(e){if(!e)return new gge;switch(e.type){case"gapi":return new Cge(e.client,e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Ve(Me.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=cX.get(t);e&&(Be("ComponentProvider","Removing Datastore"),cX.delete(t),e.terminate())}(this),Promise.resolve()}}function uX(n,t,e,r={}){var s;const i=(n=i1(n,ag))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==t&&F7("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},i),{host:`${t}:${e}`,ssl:!1})),r.mockUserToken){let o,c;if("string"==typeof r.mockUserToken)o=r.mockUserToken,c=P2.MOCK_USER;else{o=function Xde(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=t||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Dy(JSON.stringify({alg:"none",type:"JWT"})),Dy(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(s=n._app)||void 0===s?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new Ve(Me.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new P2(u)}n._authCredentials=new mge(new $Z(o,c))}}class Cs{constructor(t,e,r){this.converter=e,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Q3(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Cs(this.firestore,t,this._key)}}class bi{constructor(t,e,r){this.converter=e,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new bi(this.firestore,t,this._query)}}class Q3 extends bi{constructor(t,e,r){super(t,e,W7(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Cs(this.firestore,null,new tt(t))}withConverter(t){return new Q3(this.firestore,t,this._path)}}function cve(n,t,...e){if(n=Wr(n),Px("collection","path",t),n instanceof ag){const r=f1.fromString(t,...e);return oX(r),new Q3(n,null,r)}{if(!(n instanceof Cs||n instanceof Q3))throw new Ve(Me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(f1.fromString(t,...e));return oX(r),new Q3(n.firestore,null,r)}}function fX(n,t,...e){if(n=Wr(n),1===arguments.length&&(t=GZ.R()),Px("doc","path",t),n instanceof ag){const r=f1.fromString(t,...e);return iX(r),new Cs(n,null,new tt(r))}{if(!(n instanceof Cs||n instanceof Q3))throw new Ve(Me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(f1.fromString(t,...e));return iX(r),new Cs(n.firestore,n instanceof Q3?n.converter:null,new tt(r))}}class ZE{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Rc(this.observer.next,t)}error(t){this.observer.error?this.Rc(this.observer.error,t):_s("Uncaught Error in snapshot listener:",t.toString())}bc(){this.muted=!0}Rc(t,e){this.muted||setTimeout(()=>{this.muted||t(e)},0)}}class pve{constructor(t,e,r,s){var i=this;this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=r,this.databaseInfo=s,this.user=P2.UNAUTHENTICATED,this.clientId=GZ.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var o=O(function*(c){Be("FirestoreClient","Received user=",c.uid),yield i.authCredentialListener(c),i.user=c});return function(c){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(r,o=>(Be("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var t=this;return O(function*(){return{asyncQueue:t.asyncQueue,databaseInfo:t.databaseInfo,clientId:t.clientId,authCredentials:t.authCredentials,appCheckCredentials:t.appCheckCredentials,initialUser:t.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Ve(Me.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var t=this;this.asyncQueue.enterRestrictedMode();const e=new e2;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(O(function*(){try{t.onlineComponents&&(yield t.onlineComponents.terminate()),t.offlineComponents&&(yield t.offlineComponents.terminate()),t.authCredentials.shutdown(),t.appCheckCredentials.shutdown(),e.resolve()}catch(r){const s=cf(r,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}function pX(n,t){return Tx.apply(this,arguments)}function Tx(){return Tx=O(function*(n,t){n.asyncQueue.verifyOperationInProgress(),Be("FirestoreClient","Initializing OfflineComponentProvider");const e=yield n.getConfiguration();yield t.initialize(e);let r=e.initialUser;n.setCredentialChangeListener(function(){var s=O(function*(i){r.isEqual(i)||(yield OK(t.localStore,i),r=i)});return function(i){return s.apply(this,arguments)}}()),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=t}),Tx.apply(this,arguments)}function gX(n,t){return wx.apply(this,arguments)}function wx(){return wx=O(function*(n,t){n.asyncQueue.verifyOperationInProgress();const e=yield bx(n);Be("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield t.initialize(e,r),n.setCredentialChangeListener(s=>jK(t.remoteStore,s)),n.setAppCheckTokenChangeListener((s,i)=>jK(t.remoteStore,i)),n.onlineComponents=t}),wx.apply(this,arguments)}function bx(n){return Nx.apply(this,arguments)}function Nx(){return Nx=O(function*(n){return n.offlineComponents||(Be("FirestoreClient","Using default OfflineComponentProvider"),yield pX(n,new sve)),n.offlineComponents}),Nx.apply(this,arguments)}function YE(n){return Ax.apply(this,arguments)}function Ax(){return Ax=O(function*(n){return n.onlineComponents||(Be("FirestoreClient","Using default OnlineComponentProvider"),yield gX(n,new Sx)),n.onlineComponents}),Ax.apply(this,arguments)}function hf(n){return xx.apply(this,arguments)}function xx(){return xx=O(function*(n){const t=yield YE(n),e=t.eventManager;return e.onListen=F_e.bind(null,t.syncEngine),e.onUnlisten=B_e.bind(null,t.syncEngine),e}),xx.apply(this,arguments)}class Mve{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.Uc=!1,this.qc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new wI(this,"async_queue_retry"),this.Wc=()=>{const e=GE();e&&Be("AsyncQueue","Visibility state changed to "+e.visibilityState),this.xo.Po()};const t=GE();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.Uc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.zc(),this.Hc(t)}enterRestrictedMode(t){if(!this.Uc){this.Uc=!0,this.Qc=t||!1;const e=GE();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Wc)}}enqueue(t){if(this.zc(),this.Uc)return new Promise(()=>{});const e=new e2;return this.Hc(()=>this.Uc&&this.Qc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Lc.push(t),this.Jc()))}Jc(){var t=this;return O(function*(){if(0!==t.Lc.length){try{yield t.Lc[0](),t.Lc.shift(),t.xo.reset()}catch(e){if(!j6(e))throw e;Be("AsyncQueue","Operation failed with retryable error: "+e)}t.Lc.length>0&&t.xo.Ro(()=>t.Jc())}})()}Hc(t){const e=this.Bc.then(()=>(this.Gc=!0,t().catch(r=>{throw this.Kc=r,this.Gc=!1,_s("INTERNAL UNHANDLED ERROR: ",function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+"\n"+i.stack),o}(r)),r}).then(r=>(this.Gc=!1,r))));return this.Bc=e,e}enqueueAfterDelay(t,e,r){this.zc(),this.jc.indexOf(t)>-1&&(e=0);const s=WI.createAndSchedule(this,t,e,r,i=>this.Yc(i));return this.qc.push(s),s}zc(){this.Kc&&St()}verifyOperationInProgress(){}Xc(){var t=this;return O(function*(){let e;do{e=t.Bc,yield e}while(e!==t.Bc)})()}Zc(t){for(const e of this.qc)if(e.timerId===t)return!0;return!1}ta(t){return this.Xc().then(()=>{this.qc.sort((e,r)=>e.targetTimeMs-r.targetTimeMs);for(const e of this.qc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Xc()})}ea(t){this.jc.push(t)}Yc(t){const e=this.qc.indexOf(t);this.qc.splice(e,1)}}function Lx(n){return function(t,e){if("object"!=typeof t||null===t)return!1;const r=t;for(const s of["next","error","complete"])if(s in r&&"function"==typeof r[s])return!0;return!1}(n)}class Cr extends ag{constructor(t,e,r,s){super(t,e,r,s),this.type="firestore",this._queue=new Mve,this._persistenceKey=s?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||yX(this),this._firestoreClient.terminate()}}function Pve(n,t){const r="string"==typeof n?n:t||"(default)",s=L7("object"==typeof n?n:KA(),"firestore").getImmediate({identifier:r});if(!s._initialized){const i=(n=>{const t=cj("firestore");if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(e+1),10);return"["===t[0]?[t.substring(1,e-1),r]:[t.substring(0,e),r]})();i&&uX(s,...i)}return s}function Rs(n){return n._firestoreClient||yX(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function yX(n){var t;const e=n._freezeSettings(),r=(i=(null===(t=n._app)||void 0===t?void 0:t.options.appId)||"",new Ige(n._databaseId,i,n._persistenceKey,(c=e).host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,c.useFetchStreams));var i,c;n._firestoreClient=new pve(n._authCredentials,n._appCheckCredentials,n._queue,r)}class _8{constructor(t){this._byteString=t}static fromBase64String(t){try{return new _8(t2.fromBase64String(t))}catch(e){throw new Ve(Me.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new _8(t2.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class df{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Ve(Me.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new vs(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class XE{constructor(t){this._methodName=t}}class kx{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Ve(Me.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Ve(Me.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return pn(this._lat,t._lat)||pn(this._long,t._long)}}const Tve=/^__.*__$/;class wve{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return null!==this.fieldMask?new cl(t,this.data,this.fieldMask,e,this.fieldTransforms):new Y7(t,this.data,e,this.fieldTransforms)}}class SX{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return new cl(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function PX(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw St()}}class QE{constructor(t,e,r,s,i,o){this.settings=t,this.databaseId=e,this.It=r,this.ignoreUndefinedProperties=s,void 0===i&&this.na(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(t){return new QE(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(t){var e;const r=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.ia({path:r,oa:!1});return s.ua(t),s}ca(t){var e;const r=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.ia({path:r,oa:!1});return s.na(),s}aa(t){return this.ia({path:void 0,oa:!0})}ha(t){return eM(t,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(t){return void 0!==this.fieldMask.find(e=>t.isPrefixOf(e))||void 0!==this.fieldTransforms.find(e=>t.isPrefixOf(e.field))}na(){if(this.path)for(let t=0;t<this.path.length;t++)this.ua(this.path.get(t))}ua(t){if(0===t.length)throw this.ha("Document fields must not be empty");if(PX(this.sa)&&Tve.test(t))throw this.ha('Document fields cannot begin and end with "__"')}}class bve{constructor(t,e,r){this.databaseId=t,this.ignoreUndefinedProperties=e,this.It=r||sg(t)}da(t,e,r,s=!1){return new QE({sa:t,methodName:e,fa:r,path:vs.emptyPath(),oa:!1,la:s},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function pf(n){const t=n._freezeSettings(),e=sg(n._databaseId);return new bve(n._databaseId,!!t.ignoreUndefinedProperties,e)}function Rx(n,t,e,r,s,i={}){const o=n.da(i.merge||i.mergeFields?2:0,t,e,s);zx("Data must be an object, but it was:",o,r);const c=AX(r,o);let u,h;if(i.merge)u=new ga(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const g=[];for(const m of i.mergeFields){const v=Vx(t,m,e);if(!o.contains(v))throw new Ve(Me.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);IX(g,v)||g.push(v)}u=new ga(g),h=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,h=o.fieldTransforms;return new wve(new si(c),u,h)}class cg extends XE{_toFieldTransform(t){if(2!==t.sa)throw t.ha(1===t.sa?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof cg}}class Dx extends XE{_toFieldTransform(t){return new Fp(t.path,new j7)}isEqual(t){return t instanceof Dx}}function v8(n,t){if(OX(n=Wr(n)))return zx("Unsupported field value:",t,n),AX(n,t);if(n instanceof XE)return function(e,r){if(!PX(r.sa))throw r.ha(`${e._methodName}() can only be used with update() and set()`);if(!r.path)throw r.ha(`${e._methodName}() is not currently supported inside arrays`);const s=e._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,t),null;if(void 0===n&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.oa&&4!==t.sa)throw t.ha("Nested arrays are not supported");return function(e,r){const s=[];let i=0;for(const o of e){let c=v8(o,r.aa(i));null==c&&(c={nullValue:"NULL_VALUE"}),s.push(c),i++}return{arrayValue:{values:s}}}(n,t)}return function(e,r){if(null===(e=Wr(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return EY(r.It,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const s=qr.fromDate(e);return{timestampValue:qp(r.It,s)}}if(e instanceof qr){const s=new qr(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:qp(r.It,s)}}if(e instanceof kx)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof _8)return{bytesValue:$Y(r.It,e._byteString)};if(e instanceof Cs){const s=r.databaseId,i=e.firestore._databaseId;if(!i.isEqual(s))throw r.ha(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:nI(e.firestore._databaseId||r.databaseId,e._key.path)}}throw r.ha(`Unsupported field value: ${jE(e)}`)}(n,t)}function AX(n,t){const e={};return XZ(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):t8(n,(r,s)=>{const i=v8(s,t.ra(r));null!=i&&(e[r]=i)}),{mapValue:{fields:e}}}function OX(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof qr||n instanceof kx||n instanceof _8||n instanceof Cs||n instanceof XE)}function zx(n,t,e){if(!OX(e)||"object"!=typeof(r=e)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=jE(e);throw t.ha("an object"===r?n+" a custom object":n+" "+r)}var r}function Vx(n,t,e){if((t=Wr(t))instanceof df)return t._internalPath;if("string"==typeof t)return JE(n,t);throw eM("Field path arguments must be of type string or ",n,!1,void 0,e)}const Ive=new RegExp("[~\\*/\\[\\]]");function JE(n,t,e){if(t.search(Ive)>=0)throw eM(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new df(...t.split("."))._internalPath}catch{throw eM(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function eM(n,t,e,r,s){const i=r&&!r.isEmpty(),o=void 0!==s;let c=`Function ${t}() called with invalid data`;e&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new Ve(Me.INVALID_ARGUMENT,c+n+u)}function IX(n,t){return n.some(e=>e.isEqual(t))}class Hx{constructor(t,e,r,s,i){this._firestore=t,this._userDataWriter=e,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Cs(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new xve(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(tM("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class xve extends Hx{data(){return super.data()}}function tM(n,t){return"string"==typeof t?JE(n,t):t instanceof df?t._internalPath:t._delegate._internalPath}function xX(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Ve(Me.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Fx{}function Lve(n,...t){for(const e of t)n=e._apply(n);return n}class kve extends Fx{constructor(t,e,r){super(),this.ma=t,this.ga=e,this.ya=r,this.type="where"}_apply(t){const e=pf(t.firestore),r=function(s,i,o,c,u,h,g){let m;if(u.isKeyField()){if("array-contains"===h||"array-contains-any"===h)throw new Ve(Me.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if("in"===h||"not-in"===h){VX(g,h);const T=[];for(const I of g)T.push(zX(c,s,I));m={arrayValue:{values:T}}}else m=zX(c,s,g)}else"in"!==h&&"not-in"!==h&&"array-contains-any"!==h||VX(g,h),m=function NX(n,t,e,r=!1){return v8(e,n.da(r?4:3,t))}(o,"where",g,"in"===h||"not-in"===h);const v=ii.create(u,h,m);return function(T,I){if(I.dt()){const Z=XO(T);if(null!==Z&&!Z.isEqual(I.field))throw new Ve(Me.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${Z.toString()}' and '${I.field.toString()}'`);const te=KO(T);null!==te&&HX(0,I.field,te)}const z=function(Z,te){for(const me of Z.filters)if(te.indexOf(me.op)>=0)return me.op;return null}(T,function(Z){switch(Z){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(I.op));if(null!==z)throw new Ve(Me.INVALID_ARGUMENT,z===I.op?`Invalid query. You cannot use more than one '${I.op.toString()}' filter.`:`Invalid query. You cannot use '${I.op.toString()}' filters with '${z.toString()}' filters.`)}(s,v),v}(t._query,0,e,t.firestore._databaseId,this.ma,this.ga,this.ya);return new bi(t.firestore,t.converter,function(s,i){const o=s.filters.concat([i]);return new al(s.path,s.collectionGroup,s.explicitOrderBy.slice(),o,s.limit,s.limitType,s.startAt,s.endAt)}(t._query,r))}}function Rve(n,t,e){const r=t,s=tM("where",n);return new kve(s,r,e)}class Dve extends Fx{constructor(t,e){super(),this.ma=t,this.pa=e,this.type="orderBy"}_apply(t){const e=function(r,s,i){if(null!==r.startAt)throw new Ve(Me.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new Ve(Me.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new G7(s,i);return function(c,u){if(null===KO(c)){const h=XO(c);null!==h&&HX(0,h,u.field)}}(r,o),o}(t._query,this.ma,this.pa);return new bi(t.firestore,t.converter,function(r,s){const i=r.explicitOrderBy.concat([s]);return new al(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(t._query,e))}}function zve(n,t="asc"){const e=t,r=tM("orderBy",n);return new Dve(r,e)}class LX extends Fx{constructor(t,e,r){super(),this.type=t,this.Ia=e,this.Ta=r}_apply(t){return new bi(t.firestore,t.converter,TE(t._query,this.Ia,this.Ta))}}function Vve(n){return function aX(n,t){if(t<=0)throw new Ve(Me.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${t}.`)}("limit",n),new LX("limit",n,"F")}function zX(n,t,e){if("string"==typeof(e=Wr(e))){if(""===e)throw new Ve(Me.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!QO(t)&&-1!==e.indexOf("/"))throw new Ve(Me.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const r=t.path.child(f1.fromString(e));if(!tt.isDocumentKey(r))throw new Ve(Me.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return i8(n,new tt(r))}if(e instanceof Cs)return i8(n,e._key);throw new Ve(Me.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${jE(e)}.`)}function VX(n,t){if(!Array.isArray(n)||0===n.length)throw new Ve(Me.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(n.length>10)throw new Ve(Me.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function HX(n,t,e){if(!e.isEqual(t))throw new Ve(Me.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${e.toString()}' instead.`)}function Bx(n,t,e){let r;return r=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,r}class C8{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class gf extends Hx{constructor(t,e,r,s,i,o){super(t,e,r,s,o),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new nM(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const r=this._document.data.field(tM("DocumentSnapshot.get",t));if(null!==r)return this._userDataWriter.convertValue(r,e.serverTimestamps)}}}class nM extends gf{data(t={}){return super.data(t)}}class mf{constructor(t,e,r,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new C8(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach(r=>{t.call(e,new nM(this._firestore,this._userDataWriter,r.key,r,new C8(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Ve(Me.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new nM(r._firestore,r._userDataWriter,o.doc.key,o.doc,new C8(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:i++}))}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||3!==o.type).map(o=>{const c=new nM(r._firestore,r._userDataWriter,o.doc.key,o.doc,new C8(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,h=-1;return 0!==o.type&&(u=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),1!==o.type&&(i=i.add(o.doc),h=i.indexOf(o.doc.key)),{type:Fve(o.type),doc:c,oldIndex:u,newIndex:h}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Fve(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return St()}}function Bve(n){n=i1(n,Cs);const t=i1(n.firestore,Cr);return function vX(n,t,e={}){const r=new e2;return n.asyncQueue.enqueueAndForget(O(function*(){return function(s,i,o,c,u){const h=new ZE({next:m=>{i.enqueueAndForget(()=>ZI(s,g));const v=m.docs.has(o);!v&&m.fromCache?u.reject(new Ve(Me.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&m.fromCache&&c&&"server"===c.source?u.reject(new Ve(Me.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),g=new XI(W7(o.path),h,{includeMetadataChanges:!0,Nu:!0});return qI(s,g)}(yield hf(n),n.asyncQueue,t,e,r)})),r.promise}(Rs(t),n._key).then(e=>$x(t,n,e))}class r0 extends class Hve{convertValue(t,e="none"){switch(s8(t)){case 0:return null;case 1:return t.booleanValue;case 2:return is(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(n8(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw St()}}convertObject(t,e){const r={};return t8(t.fields,(s,i)=>{r[s]=this.convertValue(i,e)}),r}convertGeoPoint(t){return new kx(is(t.latitude),is(t.longitude))}convertArray(t,e){return(t.values||[]).map(r=>this.convertValue(r,e))}convertServerTimestamp(t,e){switch(e){case"previous":const r=JZ(t);return null==r?null:this.convertValue(r,e);case"estimate":return this.convertTimestamp(xp(t));default:return null}}convertTimestamp(t){const e=Z6(t);return new qr(e.seconds,e.nanos)}convertDocumentKey(t,e){const r=f1.fromString(t);Qt(XY(r));const s=new r8(r.get(1),r.get(3)),i=new tt(r.popFirst(5));return s.isEqual(e)||_s(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),i}}{constructor(t){super(),this.firestore=t}convertBytes(t){return new _8(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Cs(this.firestore,null,e)}}function $ve(n){n=i1(n,bi);const t=i1(n.firestore,Cr),e=Rs(t),r=new r0(t);return xX(n._query),function CX(n,t,e={}){const r=new e2;return n.asyncQueue.enqueueAndForget(O(function*(){return function(s,i,o,c,u){const h=new ZE({next:m=>{i.enqueueAndForget(()=>ZI(s,g)),m.fromCache&&"server"===c.source?u.reject(new Ve(Me.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),g=new XI(o,h,{includeMetadataChanges:!0,Nu:!0});return qI(s,g)}(yield hf(n),n.asyncQueue,t,e,r)})),r.promise}(e,n._query).then(s=>new mf(t,r,n,s))}function Uve(n,t,e){n=i1(n,Cs);const r=i1(n.firestore,Cr),s=Bx(n.converter,t,e);return lg(r,[Rx(pf(r),"setDoc",n._key,s,null!==n.converter,e).toMutation(n._key,kr.none())])}function Gve(n,t,e,...r){n=i1(n,Cs);const s=i1(n.firestore,Cr),i=pf(s);let o;return o="string"==typeof(t=Wr(t))||t instanceof df?function bX(n,t,e,r,s,i){const o=n.da(1,t,e),c=[Vx(t,r,e)],u=[s];if(i.length%2!=0)throw new Ve(Me.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<i.length;v+=2)c.push(Vx(t,i[v])),u.push(i[v+1]);const h=[],g=si.empty();for(let v=c.length-1;v>=0;--v)if(!IX(h,c[v])){const T=c[v];let I=u[v];I=Wr(I);const z=o.ca(T);if(I instanceof cg)h.push(T);else{const Z=v8(I,z);null!=Z&&(h.push(T),g.set(T,Z))}}const m=new ga(h);return new SX(g,m,o.fieldTransforms)}(i,"updateDoc",n._key,t,e,r):function wX(n,t,e,r){const s=n.da(1,t,e);zx("Data must be an object, but it was:",s,r);const i=[],o=si.empty();t8(r,(u,h)=>{const g=JE(t,u,e);h=Wr(h);const m=s.ca(g);if(h instanceof cg)i.push(g);else{const v=v8(h,m);null!=v&&(i.push(g),o.set(g,v))}});const c=new ga(i);return new SX(o,c,s.fieldTransforms)}(i,"updateDoc",n._key,t),lg(s,[o.toMutation(n._key,kr.exists(!0))])}function Wve(n){return lg(i1(n.firestore,Cr),[new K7(n._key,kr.none())])}function qve(n,t){const e=i1(n.firestore,Cr),r=fX(n),s=Bx(n.converter,t);return lg(e,[Rx(pf(n.firestore),"addDoc",r._key,s,null!==n.converter,{}).toMutation(r._key,kr.exists(!1))]).then(()=>r)}function jve(n,...t){var e,r,s;n=Wr(n);let i={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||Lx(t[o])||(i=t[o],o++);const c={includeMetadataChanges:i.includeMetadataChanges};if(Lx(t[o])){const m=t[o];t[o]=null===(e=m.next)||void 0===e?void 0:e.bind(m),t[o+1]=null===(r=m.error)||void 0===r?void 0:r.bind(m),t[o+2]=null===(s=m.complete)||void 0===s?void 0:s.bind(m)}let u,h,g;if(n instanceof Cs)h=i1(n.firestore,Cr),g=W7(n._key.path),u={next:m=>{t[o]&&t[o]($x(h,n,m))},error:t[o+1],complete:t[o+2]};else{const m=i1(n,bi);h=i1(m.firestore,Cr),g=m._query;const v=new r0(h);u={next:T=>{t[o]&&t[o](new mf(h,v,m,T))},error:t[o+1],complete:t[o+2]},xX(n._query)}return function(m,v,T,I){const z=new ZE(I),Z=new XI(v,z,T);return m.asyncQueue.enqueueAndForget(O(function*(){return qI(yield hf(m),Z)})),()=>{z.bc(),m.asyncQueue.enqueueAndForget(O(function*(){return ZI(yield hf(m),Z)}))}}(Rs(h),g,c,u)}function lg(n,t){return function(e,r){const s=new e2;return e.asyncQueue.enqueueAndForget(O(function*(){return function $_e(n,t,e){return nx.apply(this,arguments)}(yield function Ix(n){return YE(n).then(t=>t.syncEngine)}(e),r,s)})),s.promise}(Rs(n),t)}function $x(n,t,e){const r=e.docs.get(t._key),s=new r0(n);return new gf(n,s,t._key,r,new C8(e.hasPendingWrites,e.fromCache),t.converter)}function s0(){return new Dx("serverTimestamp")}function BX(n,t){if(null!=n&&null!=t&&"object"==typeof n){if(null!=n.equals)return n.equals(t);{const e=n,r=t;for(const s of Object.keys(e)){if(!(s in r))return!1;if(!1===BX(e[s],r[s]))return!1}return!0}}return n===t}function Ux(n){return null==n||function Xve(n){return"object"==typeof n&&null!=n&&null!=n.equals}(n)||function cwe(n){return"string"==typeof n||"number"==typeof n||"boolean"==typeof n||null===n}(n)||function Qve(n){if("object"==typeof n){for(const t in n)if(null!=n[t]&&!1===Ux(n[t]))return!1;return null!=n&&n.constructor.prototype===Object.prototype}return!1}(n)}function jc(n,t){if(Ux(n)&&Ux(t))return BX(n,t);throw new Error(`Comparing non comparable objects: ${n.constructor.name} and ${t.constructor.name}`)}!function(n,t=!0){H7="9.14.0",Ji(new Pi("firestore",(e,{instanceIdentifier:r,options:s})=>{const i=e.getProvider("app").getImmediate(),o=new Cr(new _ge(e.getProvider("auth-internal")),new yge(e.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Ve(Me.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new r8(c.options.projectId,u)}(i,r),i);return s=Object.assign({useFetchStreams:t},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),ns(BZ,"3.7.3",n),ns(BZ,"3.7.3","esm2017")}();class S{constructor(t){this.value=t}static of(t){return new S(t)}static ofNullable(t){return null==t?S.empty():S.of(t)}static empty(){return new S(null)}isPresent(){return null!=this.value}isAbsent(){return null==this.value}get(){if(this.isPresent())return this.value;throw new Error("Value is absent")}getOrElse(t){return this.isPresent()?this.value:t}equals(t){return this.isAbsent()?t.isAbsent():!t.isAbsent()&&jc(this.value,t.value)}equalsValue(t){return this.equals(S.of(t))}toString(){return this.isAbsent()?"MGPOptional.empty()":`MGPOptional.of(${this.value})`}map(t){return this.isPresent()?S.of(t(this.get())):S.empty()}}class K{static success(t){return new Jve(t)}static failure(t){return new eCe(t)}constructor(){}equals(t){return this.isFailure()?t.isFailure()&&this.getReason()===t.getReason():!t.isFailure()&&jc(this.get(),t.get())}}class Jve extends K{constructor(t){super(),this.value=t}isSuccess(){return!0}isFailure(){return!1}get(){return this.value}getReason(){throw new Error("Cannot get failure reason from a success")}getReasonOr(t){return t}toOptional(){return S.of(this.value)}toString(){return`MGPFallible.success(${this.value})`}}class eCe extends K{constructor(t){super(),this.reason=t}isSuccess(){return!1}isFailure(){return!0}get(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}getReason(){return this.reason}getReasonOr(t){return this.getReason()}toOptional(){return S.empty()}toString(){return`MGPFallible.failure(${this.reason})`}}class G{constructor(t){this.reason=t}static ofFallible(t){return t.isSuccess()?G.SUCCESS:G.failure(t.getReason())}static failure(t){return new G(t)}isFailure(){return!1===this.isSuccess()}isSuccess(){return null==this.reason}getReason(){if(this.isSuccess())throw new Error("MGPValidation: Cannot extract failure reason from success.");return this.reason}toFallible(t){return this.isSuccess()?K.success(t):K.failure(this.getReason())}toFailedFallible(){if(this.isSuccess())throw new Error("MGPValidation: cannot convert into failed fallible.");return K.failure(this.getReason())}}G.SUCCESS=new G(null),ns("firebase","9.14.0","app");const $X="@firebase/installations",Gx="0.5.16",GX=`w:${Gx}`,WX="FIS_v2",fl=new q3("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function qX(n){return n instanceof Qa&&n.code.includes("request-failed")}function Wx({projectId:n}){return`https://firebaseinstallations.googleapis.com/v1/projects/${n}/installations`}function jX(n){return{token:n.token,requestStatus:2,expiresIn:cCe(n.expiresIn),creationTime:Date.now()}}function qx(n,t){return jx.apply(this,arguments)}function jx(){return jx=O(function*(n,t){const r=(yield t.json()).error;return fl.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}),jx.apply(this,arguments)}function ZX({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function YX(n,{refreshToken:t}){const e=ZX(n);return e.append("Authorization",function lCe(n){return`${WX} ${n}`}(t)),e}function Zx(n){return Yx.apply(this,arguments)}function Yx(){return Yx=O(function*(n){const t=yield n();return t.status>=500&&t.status<600?n():t}),Yx.apply(this,arguments)}function cCe(n){return Number(n.replace("s","000"))}function uCe(n,t){return Kx.apply(this,arguments)}function Kx(){return Kx=O(function*({appConfig:n,heartbeatServiceProvider:t},{fid:e}){const r=Wx(n),s=ZX(n),i=t.getImmediate({optional:!0});if(i){const h=yield i.getHeartbeatsHeader();h&&s.append("x-firebase-client",h)}const c={method:"POST",headers:s,body:JSON.stringify({fid:e,authVersion:WX,appId:n.appId,sdkVersion:GX})},u=yield Zx(()=>fetch(r,c));if(u.ok){const h=yield u.json();return{fid:h.fid||e,registrationStatus:2,refreshToken:h.refreshToken,authToken:jX(h.authToken)}}throw yield qx("Create Installation",u)}),Kx.apply(this,arguments)}function KX(n){return new Promise(t=>{setTimeout(t,n)})}const hCe=/^[cdef][\w-]{21}$/;function dCe(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const e=function pCe(n){return function fCe(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}(n).substr(0,22)}(n);return hCe.test(e)?e:""}catch{return""}}function _f(n){return`${n.appName}!${n.appId}`}const vf=new Map;function XX(n,t){const e=_f(n);QX(e,t),function _Ce(n,t){const e=function JX(){return!y8&&"BroadcastChannel"in self&&(y8=new BroadcastChannel("[Firebase] FID Change"),y8.onmessage=n=>{QX(n.data.key,n.data.fid)}),y8}();e&&e.postMessage({key:n,fid:t}),function eQ(){0===vf.size&&y8&&(y8.close(),y8=null)}()}(e,t)}function QX(n,t){const e=vf.get(n);if(e)for(const r of e)r(t)}let y8=null;const E8="firebase-installations-store";let Qx=null;function Jx(){return Qx||(Qx=By("firebase-installations-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(E8)}})),Qx}function sM(n,t){return eL.apply(this,arguments)}function eL(){return eL=O(function*(n,t){const e=_f(n),s=(yield Jx()).transaction(E8,"readwrite"),i=s.objectStore(E8),o=yield i.get(e);return yield i.put(t,e),yield s.done,(!o||o.fid!==t.fid)&&XX(n,t.fid),t}),eL.apply(this,arguments)}function tL(n){return nL.apply(this,arguments)}function nL(){return nL=O(function*(n){const t=_f(n),r=(yield Jx()).transaction(E8,"readwrite");yield r.objectStore(E8).delete(t),yield r.done}),nL.apply(this,arguments)}function ug(n,t){return rL.apply(this,arguments)}function rL(){return rL=O(function*(n,t){const e=_f(n),s=(yield Jx()).transaction(E8,"readwrite"),i=s.objectStore(E8),o=yield i.get(e),c=t(o);return void 0===c?yield i.delete(e):yield i.put(c,e),yield s.done,c&&(!o||o.fid!==c.fid)&&XX(n,c.fid),c}),rL.apply(this,arguments)}function sL(n){return iL.apply(this,arguments)}function iL(){return iL=O(function*(n){let t;const e=yield ug(n.appConfig,r=>{const s=yCe(r),i=ECe(n,s);return t=i.registrationPromise,i.installationEntry});return""===e.fid?{installationEntry:yield t}:{installationEntry:e,registrationPromise:t}}),iL.apply(this,arguments)}function yCe(n){return nQ(n||{fid:dCe(),registrationStatus:0})}function ECe(n,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(fl.create("app-offline"))};const e={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function MCe(n,t){return oL.apply(this,arguments)}(n,e);return{installationEntry:e,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:SCe(n)}:{installationEntry:t}}function oL(){return oL=O(function*(n,t){try{const e=yield uCe(n,t);return sM(n.appConfig,e)}catch(e){throw qX(e)&&409===e.customData.serverCode?yield tL(n.appConfig):yield sM(n.appConfig,{fid:t.fid,registrationStatus:0}),e}}),oL.apply(this,arguments)}function SCe(n){return aL.apply(this,arguments)}function aL(){return aL=O(function*(n){let t=yield tQ(n.appConfig);for(;1===t.registrationStatus;)yield KX(100),t=yield tQ(n.appConfig);if(0===t.registrationStatus){const{installationEntry:e,registrationPromise:r}=yield sL(n);return r||e}return t}),aL.apply(this,arguments)}function tQ(n){return ug(n,t=>{if(!t)throw fl.create("installation-not-found");return nQ(t)})}function nQ(n){return function PCe(n){return 1===n.registrationStatus&&n.registrationTime+1e4<Date.now()}(n)?{fid:n.fid,registrationStatus:0}:n}function TCe(n,t){return cL.apply(this,arguments)}function cL(){return cL=O(function*({appConfig:n,heartbeatServiceProvider:t},e){const r=wCe(n,e),s=YX(n,e),i=t.getImmediate({optional:!0});if(i){const h=yield i.getHeartbeatsHeader();h&&s.append("x-firebase-client",h)}const c={method:"POST",headers:s,body:JSON.stringify({installation:{sdkVersion:GX,appId:n.appId}})},u=yield Zx(()=>fetch(r,c));if(u.ok)return jX(yield u.json());throw yield qx("Generate Auth Token",u)}),cL.apply(this,arguments)}function wCe(n,{fid:t}){return`${Wx(n)}/${t}/authTokens:generate`}function lL(n){return uL.apply(this,arguments)}function uL(){return uL=O(function*(n,t=!1){let e;const r=yield ug(n.appConfig,i=>{if(!sQ(i))throw fl.create("not-registered");const o=i.authToken;if(!t&&ACe(o))return i;if(1===o.requestStatus)return e=bCe(n,t),i;{if(!navigator.onLine)throw fl.create("app-offline");const c=ICe(i);return e=NCe(n,c),c}});return e?yield e:r.authToken}),uL.apply(this,arguments)}function bCe(n,t){return fL.apply(this,arguments)}function fL(){return fL=O(function*(n,t){let e=yield rQ(n.appConfig);for(;1===e.authToken.requestStatus;)yield KX(100),e=yield rQ(n.appConfig);const r=e.authToken;return 0===r.requestStatus?lL(n,t):r}),fL.apply(this,arguments)}function rQ(n){return ug(n,t=>{if(!sQ(t))throw fl.create("not-registered");return function xCe(n){return 1===n.requestStatus&&n.requestTime+1e4<Date.now()}(t.authToken)?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t})}function NCe(n,t){return hL.apply(this,arguments)}function hL(){return hL=O(function*(n,t){try{const e=yield TCe(n,t),r=Object.assign(Object.assign({},t),{authToken:e});return yield sM(n.appConfig,r),e}catch(e){if(!qX(e)||401!==e.customData.serverCode&&404!==e.customData.serverCode){const r=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});yield sM(n.appConfig,r)}else yield tL(n.appConfig);throw e}}),hL.apply(this,arguments)}function sQ(n){return void 0!==n&&2===n.registrationStatus}function ACe(n){return 2===n.requestStatus&&!function OCe(n){const t=Date.now();return t<n.creationTime||n.creationTime+n.expiresIn<t+36e5}(n)}function ICe(n){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:t})}function dL(){return dL=O(function*(n){const t=n,{installationEntry:e,registrationPromise:r}=yield sL(t);return r?r.catch(console.error):lL(t).catch(console.error),e.fid}),dL.apply(this,arguments)}function pL(){return pL=O(function*(n,t=!1){const e=n;return yield RCe(e),(yield lL(e,t)).token}),pL.apply(this,arguments)}function RCe(n){return gL.apply(this,arguments)}function gL(){return gL=O(function*(n){const{registrationPromise:t}=yield sL(n);t&&(yield t)}),gL.apply(this,arguments)}function vL(n){return fl.create("missing-app-config-values",{valueName:n})}const iQ="installations",FCe=n=>{const t=n.getProvider("app").getImmediate(),e=function VCe(n){if(!n||!n.options)throw vL("App Configuration");if(!n.name)throw vL("App Name");const t=["projectId","apiKey","appId"];for(const e of t)if(!n.options[e])throw vL(e);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}(t);return{app:t,appConfig:e,heartbeatServiceProvider:L7(t,"heartbeat"),_delete:()=>Promise.resolve()}},BCe=n=>{const e=L7(n.getProvider("app").getImmediate(),iQ).getImmediate();return{getId:()=>function LCe(n){return dL.apply(this,arguments)}(e),getToken:s=>function kCe(n){return pL.apply(this,arguments)}(e,s)}};(function $Ce(){Ji(new Pi(iQ,FCe,"PUBLIC")),Ji(new Pi("installations-internal",BCe,"PRIVATE"))})(),ns($X,Gx),ns($X,Gx,"esm2017");const CL="@firebase/remote-config",Vo=new q3("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class JCe{constructor(t,e,r,s){this.client=t,this.storage=e,this.storageCache=r,this.logger=s}isCachedDataFresh(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const r=Date.now()-e,s=r<=t;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${t}. Is cache hit: ${s}.`),s}fetch(t){var e=this;return O(function*(){const[r,s]=yield Promise.all([e.storage.getLastSuccessfulFetchTimestampMillis(),e.storage.getLastSuccessfulFetchResponse()]);if(s&&e.isCachedDataFresh(t.cacheMaxAgeMillis,r))return s;t.eTag=s&&s.eTag;const i=yield e.client.fetch(t),o=[e.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===i.status&&o.push(e.storage.setLastSuccessfulFetchResponse(i)),yield Promise.all(o),i})()}}function eye(n=navigator){return n.languages&&n.languages[0]||n.language}class tye{constructor(t,e,r,s,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=r,this.projectId=s,this.apiKey=i,this.appId=o}fetch(t){var e=this;return O(function*(){var r,s,i;const[o,c]=yield Promise.all([e.firebaseInstallations.getId(),e.firebaseInstallations.getToken()]),h=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${e.projectId}/namespaces/${e.namespace}:fetch?key=${e.apiKey}`,g={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},m={sdk_version:e.sdkVersion,app_instance_id:o,app_instance_id_token:c,app_id:e.appId,language_code:eye()},v={method:"POST",headers:g,body:JSON.stringify(m)},T=fetch(h,v),I=new Promise((Ne,He)=>{t.signal.addEventListener(()=>{const qe=new Error("The operation was aborted.");qe.name="AbortError",He(qe)})});let z;try{yield Promise.race([T,I]),z=yield T}catch(Ne){let He="fetch-client-network";throw"AbortError"===(null===(r=Ne)||void 0===r?void 0:r.name)&&(He="fetch-timeout"),Vo.create(He,{originalErrorMessage:null===(s=Ne)||void 0===s?void 0:s.message})}let Z=z.status;const te=z.headers.get("ETag")||void 0;let me,J;if(200===z.status){let Ne;try{Ne=yield z.json()}catch(He){throw Vo.create("fetch-client-parse",{originalErrorMessage:null===(i=He)||void 0===i?void 0:i.message})}me=Ne.entries,J=Ne.state}if("INSTANCE_STATE_UNSPECIFIED"===J?Z=500:"NO_CHANGE"===J?Z=304:("NO_TEMPLATE"===J||"EMPTY_CONFIG"===J)&&(me={}),304!==Z&&200!==Z)throw Vo.create("fetch-status",{httpStatus:Z});return{status:Z,eTag:te,config:me}})()}}class sye{constructor(t,e){this.client=t,this.storage=e}fetch(t){var e=this;return O(function*(){const r=(yield e.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return e.attemptFetch(t,r)})()}attemptFetch(t,{throttleEndTimeMillis:e,backoffCount:r}){var s=this;return O(function*(){yield function nye(n,t){return new Promise((e,r)=>{const s=Math.max(t-Date.now(),0),i=setTimeout(e,s);n.addEventListener(()=>{clearTimeout(i),r(Vo.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(t.signal,e);try{const i=yield s.client.fetch(t);return yield s.storage.deleteThrottleMetadata(),i}catch(i){if(!function rye(n){if(!(n instanceof Qa&&n.customData))return!1;const t=Number(n.customData.httpStatus);return 429===t||500===t||503===t||504===t}(i))throw i;const o={throttleEndTimeMillis:Date.now()+FA(r),backoffCount:r+1};return yield s.storage.setThrottleMetadata(o),s.attemptFetch(t,o)}})()}}class aye{constructor(t,e,r,s,i){this.app=t,this._client=e,this._storageCache=r,this._storage=s,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function oM(n,t){var e;const r=n.target.error||void 0;return Vo.create(t,{originalErrorMessage:r&&(null===(e=r)||void 0===e?void 0:e.message)})}const M8="app_namespace_store";class fye{constructor(t,e,r,s=function uye(){return new Promise((n,t)=>{var e;try{const r=indexedDB.open("firebase_remote_config",1);r.onerror=s=>{t(oM(s,"storage-open"))},r.onsuccess=s=>{n(s.target.result)},r.onupgradeneeded=s=>{0===s.oldVersion&&s.target.result.createObjectStore(M8,{keyPath:"compositeKey"})}}catch(r){t(Vo.create("storage-open",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message}))}})}()){this.appId=t,this.appName=e,this.namespace=r,this.openDbPromise=s}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(t){return this.set("last_fetch_status",t)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(t){return this.set("last_successful_fetch_timestamp_millis",t)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(t){return this.set("last_successful_fetch_response",t)}getActiveConfig(){return this.get("active_config")}setActiveConfig(t){return this.set("active_config",t)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(t){return this.set("active_config_etag",t)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(t){return this.set("throttle_metadata",t)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(t){var e=this;return O(function*(){const r=yield e.openDbPromise;return new Promise((s,i)=>{var o;const u=r.transaction([M8],"readonly").objectStore(M8),h=e.createCompositeKey(t);try{const g=u.get(h);g.onerror=m=>{i(oM(m,"storage-get"))},g.onsuccess=m=>{const v=m.target.result;s(v?v.value:void 0)}}catch(g){i(Vo.create("storage-get",{originalErrorMessage:null===(o=g)||void 0===o?void 0:o.message}))}})})()}set(t,e){var r=this;return O(function*(){const s=yield r.openDbPromise;return new Promise((i,o)=>{var c;const h=s.transaction([M8],"readwrite").objectStore(M8),g=r.createCompositeKey(t);try{const m=h.put({compositeKey:g,value:e});m.onerror=v=>{o(oM(v,"storage-set"))},m.onsuccess=()=>{i()}}catch(m){o(Vo.create("storage-set",{originalErrorMessage:null===(c=m)||void 0===c?void 0:c.message}))}})})()}delete(t){var e=this;return O(function*(){const r=yield e.openDbPromise;return new Promise((s,i)=>{var o;const u=r.transaction([M8],"readwrite").objectStore(M8),h=e.createCompositeKey(t);try{const g=u.delete(h);g.onerror=m=>{i(oM(m,"storage-delete"))},g.onsuccess=()=>{s()}}catch(g){i(Vo.create("storage-delete",{originalErrorMessage:null===(o=g)||void 0===o?void 0:o.message}))}})})()}createCompositeKey(t){return[this.appId,this.appName,this.namespace,t].join()}}class hye{constructor(t){this.storage=t}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var t=this;return O(function*(){const e=t.storage.getLastFetchStatus(),r=t.storage.getLastSuccessfulFetchTimestampMillis(),s=t.storage.getActiveConfig(),i=yield e;i&&(t.lastFetchStatus=i);const o=yield r;o&&(t.lastSuccessfulFetchTimestampMillis=o);const c=yield s;c&&(t.activeConfig=c)})()}setLastFetchStatus(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)}setLastSuccessfulFetchTimestampMillis(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)}setActiveConfig(t){return this.activeConfig=t,this.storage.setActiveConfig(t)}}function pye(){return PL.apply(this,arguments)}function PL(){return(PL=O(function*(){if(!Wu())return!1;try{return yield op()}catch{return!1}})).apply(this,arguments)}!function dye(){Ji(new Pi("remote-config",function n(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),s=t.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Vo.create("registration-window");if(!Wu())throw Vo.create("indexed-db-unavailable");const{projectId:i,apiKey:o,appId:c}=r.options;if(!i)throw Vo.create("registration-project-id");if(!o)throw Vo.create("registration-api-key");if(!c)throw Vo.create("registration-app-id");const u=new fye(c,r.name,e=e||"firebase"),h=new hye(u),g=new x7(CL);g.logLevel=u1.ERROR;const m=new tye(s,k7,e,i,o,c),v=new sye(m,u),T=new JCe(v,u,h,g),I=new aye(r,T,h,u,g);return function KCe(n){const t=Wr(n);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(()=>{t._isInitializationComplete=!0}))}(I),I},"PUBLIC").setMultipleInstances(!0)),ns(CL,"0.3.15"),ns(CL,"0.3.15","esm2017")}();const gye="/firebase-messaging-sw.js",mye="/firebase-cloud-messaging-push-scope",lQ="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",uQ="google.c.a.c_id",vye="google.c.a.c_l",Cye="google.c.a.ts",yye="google.c.a.e";var Cf=(()=>(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"}(Cf||(Cf={})),Cf))();function hl(n){const t=new Uint8Array(n);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Eye(n){const e=(n+"=".repeat((4-n.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(e),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}const TL="fcm_token_details_db",fQ="fcm_token_object_Store";function Sye(n){return wL.apply(this,arguments)}function wL(){return wL=O(function*(n){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(i=>i.name).includes(TL))return null;let t=null;return(yield By(TL,5,{upgrade:(r=O(function*(s,i,o,c){var u;if(i<2||!s.objectStoreNames.contains(fQ))return;const h=c.objectStore(fQ),g=yield h.index("fcmSenderId").get(n);if(yield h.clear(),g)if(2===i){const m=g;if(!m.auth||!m.p256dh||!m.endpoint)return;t={token:m.fcmToken,createTime:null!==(u=m.createTime)&&void 0!==u?u:Date.now(),subscriptionOptions:{auth:m.auth,p256dh:m.p256dh,endpoint:m.endpoint,swScope:m.swScope,vapidKey:"string"==typeof m.vapidKey?m.vapidKey:hl(m.vapidKey)}}}else if(3===i){const m=g;t={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:hl(m.auth),p256dh:hl(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:hl(m.vapidKey)}}}else if(4===i){const m=g;t={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:hl(m.auth),p256dh:hl(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:hl(m.vapidKey)}}}}),function(i,o,c,u){return r.apply(this,arguments)})})).close(),yield jA(TL),yield jA("fcm_vapid_details_db"),yield jA("undefined"),Pye(t)?t:null;var r}),wL.apply(this,arguments)}function Pye(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:t}=n;return"number"==typeof n.createTime&&n.createTime>0&&"string"==typeof n.token&&n.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}const S8="firebase-messaging-store";let bL=null;function NL(){return bL||(bL=By("firebase-messaging-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(S8)}})),bL}function hQ(n){return AL.apply(this,arguments)}function AL(){return AL=O(function*(n){const t=LL(n),r=yield(yield NL()).transaction(S8).objectStore(S8).get(t);if(r)return r;{const s=yield Sye(n.appConfig.senderId);if(s)return yield OL(n,s),s}}),AL.apply(this,arguments)}function OL(n,t){return IL.apply(this,arguments)}function IL(){return IL=O(function*(n,t){const e=LL(n),s=(yield NL()).transaction(S8,"readwrite");return yield s.objectStore(S8).put(t,e),yield s.done,t}),IL.apply(this,arguments)}function bye(n){return xL.apply(this,arguments)}function xL(){return xL=O(function*(n){const t=LL(n),r=(yield NL()).transaction(S8,"readwrite");yield r.objectStore(S8).delete(t),yield r.done}),xL.apply(this,arguments)}function LL({appConfig:n}){return n.appId}const oi=new q3("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function Aye(n,t){return kL.apply(this,arguments)}function kL(){return kL=O(function*(n,t){var e;const r=yield VL(n),s=pQ(t),i={method:"POST",headers:r,body:JSON.stringify(s)};let o;try{o=yield(yield fetch(zL(n.appConfig),i)).json()}catch(c){throw oi.create("token-subscribe-failed",{errorInfo:null===(e=c)||void 0===e?void 0:e.toString()})}if(o.error)throw oi.create("token-subscribe-failed",{errorInfo:o.error.message});if(!o.token)throw oi.create("token-subscribe-no-token");return o.token}),kL.apply(this,arguments)}function Oye(n,t){return RL.apply(this,arguments)}function RL(){return RL=O(function*(n,t){var e;const r=yield VL(n),s=pQ(t.subscriptionOptions),i={method:"PATCH",headers:r,body:JSON.stringify(s)};let o;try{o=yield(yield fetch(`${zL(n.appConfig)}/${t.token}`,i)).json()}catch(c){throw oi.create("token-update-failed",{errorInfo:null===(e=c)||void 0===e?void 0:e.toString()})}if(o.error)throw oi.create("token-update-failed",{errorInfo:o.error.message});if(!o.token)throw oi.create("token-update-no-token");return o.token}),RL.apply(this,arguments)}function dQ(n,t){return DL.apply(this,arguments)}function DL(){return DL=O(function*(n,t){var e;const s={method:"DELETE",headers:yield VL(n)};try{const o=yield(yield fetch(`${zL(n.appConfig)}/${t}`,s)).json();if(o.error)throw oi.create("token-unsubscribe-failed",{errorInfo:o.error.message})}catch(i){throw oi.create("token-unsubscribe-failed",{errorInfo:null===(e=i)||void 0===e?void 0:e.toString()})}}),DL.apply(this,arguments)}function zL({projectId:n}){return`https://fcmregistrations.googleapis.com/v1/projects/${n}/registrations`}function VL(n){return HL.apply(this,arguments)}function HL(){return HL=O(function*({appConfig:n,installations:t}){const e=yield t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${e}`})}),HL.apply(this,arguments)}function pQ({p256dh:n,auth:t,endpoint:e,vapidKey:r}){const s={web:{endpoint:e,auth:t,p256dh:n}};return r!==lQ&&(s.web.applicationPubKey=r),s}function xye(n){return FL.apply(this,arguments)}function FL(){return FL=O(function*(n){const t=yield kye(n.swRegistration,n.vapidKey),e={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:t.endpoint,auth:hl(t.getKey("auth")),p256dh:hl(t.getKey("p256dh"))},r=yield hQ(n.firebaseDependencies);if(r){if(Rye(r.subscriptionOptions,e))return Date.now()>=r.createTime+6048e5?Lye(n,{token:r.token,createTime:Date.now(),subscriptionOptions:e}):r.token;try{yield dQ(n.firebaseDependencies,r.token)}catch(s){console.warn(s)}return mQ(n.firebaseDependencies,e)}return mQ(n.firebaseDependencies,e)}),FL.apply(this,arguments)}function gQ(n){return BL.apply(this,arguments)}function BL(){return BL=O(function*(n){const t=yield hQ(n.firebaseDependencies);t&&(yield dQ(n.firebaseDependencies,t.token),yield bye(n.firebaseDependencies));const e=yield n.swRegistration.pushManager.getSubscription();return!e||e.unsubscribe()}),BL.apply(this,arguments)}function Lye(n,t){return $L.apply(this,arguments)}function $L(){return $L=O(function*(n,t){try{const e=yield Oye(n.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:e,createTime:Date.now()});return yield OL(n.firebaseDependencies,r),e}catch(e){throw yield gQ(n),e}}),$L.apply(this,arguments)}function mQ(n,t){return UL.apply(this,arguments)}function UL(){return UL=O(function*(n,t){const r={token:yield Aye(n,t),createTime:Date.now(),subscriptionOptions:t};return yield OL(n,r),r.token}),UL.apply(this,arguments)}function kye(n,t){return GL.apply(this,arguments)}function GL(){return GL=O(function*(n,t){return(yield n.pushManager.getSubscription())||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Eye(t)})}),GL.apply(this,arguments)}function Rye(n,t){return t.vapidKey===n.vapidKey&&t.endpoint===n.endpoint&&t.auth===n.auth&&t.p256dh===n.p256dh}function _Q(n){const t={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return function Dye(n,t){if(!t.notification)return;n.notification={};const e=t.notification.title;e&&(n.notification.title=e);const r=t.notification.body;r&&(n.notification.body=r);const s=t.notification.image;s&&(n.notification.image=s);const i=t.notification.icon;i&&(n.notification.icon=i)}(t,n),function zye(n,t){!t.data||(n.data=t.data)}(t,n),function Vye(n,t){var e,r,s,i,o;if(!(t.fcmOptions||null!==(e=t.notification)&&void 0!==e&&e.click_action))return;n.fcmOptions={};const c=null!==(s=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==s?s:null===(i=t.notification)||void 0===i?void 0:i.click_action;c&&(n.fcmOptions.link=c);const u=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;u&&(n.fcmOptions.analyticsLabel=u)}(t,n),t}function Hye(n){return"object"==typeof n&&!!n&&uQ in n}function vQ(n,t){const e=[];for(let r=0;r<n.length;r++)e.push(n.charAt(r)),r<t.length&&e.push(t.charAt(r));return e.join("")}function WL(n){return oi.create("missing-app-config-values",{valueName:n})}vQ("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),vQ("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Bye{constructor(t,e,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=function Fye(n){if(!n||!n.options)throw WL("App Configuration Object");if(!n.name)throw WL("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:e}=n;for(const r of t)if(!e[r])throw WL(r);return{appName:n.name,projectId:e.projectId,apiKey:e.apiKey,appId:e.appId,senderId:e.messagingSenderId}}(t);this.firebaseDependencies={app:t,appConfig:s,installations:e,analyticsProvider:r}}_delete(){return Promise.resolve()}}function CQ(n){return qL.apply(this,arguments)}function qL(){return qL=O(function*(n){var t;try{n.swRegistration=yield navigator.serviceWorker.register(gye,{scope:mye}),n.swRegistration.update().catch(()=>{})}catch(e){throw oi.create("failed-service-worker-registration",{browserErrorMessage:null===(t=e)||void 0===t?void 0:t.message})}}),qL.apply(this,arguments)}function $ye(n,t){return jL.apply(this,arguments)}function jL(){return jL=O(function*(n,t){if(!t&&!n.swRegistration&&(yield CQ(n)),t||!n.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw oi.create("invalid-sw-registration");n.swRegistration=t}}),jL.apply(this,arguments)}function Uye(n,t){return ZL.apply(this,arguments)}function ZL(){return ZL=O(function*(n,t){t?n.vapidKey=t:n.vapidKey||(n.vapidKey=lQ)}),ZL.apply(this,arguments)}function YL(){return YL=O(function*(n,t){if(!navigator)throw oi.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw oi.create("permission-blocked");return yield Uye(n,t?.vapidKey),yield $ye(n,t?.serviceWorkerRegistration),xye(n)}),YL.apply(this,arguments)}function Gye(n,t,e){return KL.apply(this,arguments)}function KL(){return KL=O(function*(n,t,e){const r=Wye(t);(yield n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:e[uQ],message_name:e[vye],message_time:e[Cye],message_device_time:Math.floor(Date.now()/1e3)})}),KL.apply(this,arguments)}function Wye(n){switch(n){case Cf.NOTIFICATION_CLICKED:return"notification_open";case Cf.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function XL(){return XL=O(function*(n,t){const e=t.data;if(!e.isFirebaseMessaging)return;n.onMessageHandler&&e.messageType===Cf.PUSH_RECEIVED&&("function"==typeof n.onMessageHandler?n.onMessageHandler(_Q(e)):n.onMessageHandler.next(_Q(e)));const r=e.data;Hye(r)&&"1"===r[yye]&&(yield Gye(n,e.messageType,r))}),XL.apply(this,arguments)}const EQ="@firebase/messaging",jye=n=>{const t=new Bye(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",e=>function qye(n,t){return XL.apply(this,arguments)}(t,e)),t},Zye=n=>{const t=n.getProvider("messaging").getImmediate();return{getToken:r=>function yQ(n,t){return YL.apply(this,arguments)}(t,r)}};function SQ(){return QL.apply(this,arguments)}function QL(){return(QL=O(function*(){try{yield op()}catch{return!1}return typeof window<"u"&&Wu()&&DA()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function Yye(){Ji(new Pi("messaging",jye,"PUBLIC")),Ji(new Pi("messaging-internal",Zye,"PRIVATE")),ns(EQ,"0.11.0"),ns(EQ,"0.11.0","esm2017")}();const aM="analytics",Qye="firebase_id",tEe="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",PQ="https://www.googletagmanager.com/gtag/js",ai=new x7("@firebase/analytics");function TQ(n){return Promise.all(n.map(t=>t.catch(e=>e)))}function nEe(n,t){const e=document.createElement("script");e.src=`${PQ}?l=${n}&id=${t}`,e.async=!0,document.head.appendChild(e)}function sEe(n,t,e,r,s,i){return tk.apply(this,arguments)}function tk(){return tk=O(function*(n,t,e,r,s,i){const o=r[s];try{if(o)yield t[o];else{const u=(yield TQ(e)).find(h=>h.measurementId===s);u&&(yield t[u.appId])}}catch(c){ai.error(c)}n("config",s,i)}),tk.apply(this,arguments)}function iEe(n,t,e,r,s){return nk.apply(this,arguments)}function nk(){return nk=O(function*(n,t,e,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const c=yield TQ(e);for(const u of o){const h=c.find(m=>m.measurementId===u),g=h&&t[h.appId];if(!g){i=[];break}i.push(g)}}0===i.length&&(i=Object.values(t)),yield Promise.all(i),n("event",r,s||{})}catch(i){ai.error(i)}}),nk.apply(this,arguments)}function cEe(n){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(PQ)&&e.src.includes(n))return e;return null}const ma=new q3("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),wQ=new class hEe{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function dEe(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function pEe(n){return rk.apply(this,arguments)}function rk(){return rk=O(function*(n){var t;const{appId:e,apiKey:r}=n,s={method:"GET",headers:dEe(r)},i=tEe.replace("{app-id}",e),o=yield fetch(i,s);if(200!==o.status&&304!==o.status){let c="";try{const u=yield o.json();null!==(t=u.error)&&void 0!==t&&t.message&&(c=u.error.message)}catch{}throw ma.create("config-fetch-failed",{httpStatus:o.status,responseMessage:c})}return o.json()}),rk.apply(this,arguments)}function gEe(n){return sk.apply(this,arguments)}function sk(){return sk=O(function*(n,t=wQ,e){const{appId:r,apiKey:s,measurementId:i}=n.options;if(!r)throw ma.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw ma.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new vEe;return setTimeout(O(function*(){c.abort()}),void 0!==e?e:6e4),bQ({appId:r,apiKey:s,measurementId:i},o,c,t)}),sk.apply(this,arguments)}function bQ(n,t,e){return ik.apply(this,arguments)}function ik(){return ik=O(function*(n,{throttleEndTimeMillis:t,backoffCount:e},r,s=wQ){var i,o;const{appId:c,measurementId:u}=n;try{yield mEe(r,t)}catch(h){if(u)return ai.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${null===(i=h)||void 0===i?void 0:i.message}]`),{appId:c,measurementId:u};throw h}try{const h=yield pEe(n);return s.deleteThrottleMetadata(c),h}catch(h){const g=h;if(!_Ee(g)){if(s.deleteThrottleMetadata(c),u)return ai.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${g?.message}]`),{appId:c,measurementId:u};throw h}const m=503===Number(null===(o=g?.customData)||void 0===o?void 0:o.httpStatus)?FA(e,s.intervalMillis,30):FA(e,s.intervalMillis),v={throttleEndTimeMillis:Date.now()+m,backoffCount:e+1};return s.setThrottleMetadata(c,v),ai.debug(`Calling attemptFetch again in ${m} millis`),bQ(n,v,r,s)}}),ik.apply(this,arguments)}function mEe(n,t){return new Promise((e,r)=>{const s=Math.max(t-Date.now(),0),i=setTimeout(e,s);n.addEventListener(()=>{clearTimeout(i),r(ma.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function _Ee(n){if(!(n instanceof Qa&&n.customData))return!1;const t=Number(n.customData.httpStatus);return 429===t||500===t||503===t||504===t}class vEe{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}let ok,hk;function ak(){return ak=O(function*(n,t,e,r,s){if(s&&s.global)n("event",e,r);else{const i=yield t;n("event",e,Object.assign(Object.assign({},r),{send_to:i}))}}),ak.apply(this,arguments)}function NQ(n){hk=n}function AQ(n){ok=n}function PEe(){return dk.apply(this,arguments)}function dk(){return dk=O(function*(){var n;if(!Wu())return ai.warn(ma.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield op()}catch(t){return ai.warn(ma.create("indexeddb-unavailable",{errorInfo:null===(n=t)||void 0===n?void 0:n.toString()}).message),!1}return!0}),dk.apply(this,arguments)}function pk(){return pk=O(function*(n,t,e,r,s,i,o){var c;const u=gEe(n);u.then(T=>{e[T.measurementId]=T.appId,n.options.measurementId&&T.measurementId!==n.options.measurementId&&ai.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${T.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(T=>ai.error(T)),t.push(u);const h=PEe().then(T=>{if(T)return r.getId()}),[g,m]=yield Promise.all([u,h]);cEe(i)||nEe(i,g.measurementId),hk&&(s("consent","default",hk),NQ(void 0)),s("js",new Date);const v=null!==(c=o?.config)&&void 0!==c?c:{};return v.origin="firebase",v.update=!0,null!=m&&(v[Qye]=m),s("config",g.measurementId,v),ok&&(s("set",ok),AQ(void 0)),g.measurementId}),pk.apply(this,arguments)}class wEe{constructor(t){this.app=t}_delete(){return delete dl[this.app.options.appId],Promise.resolve()}}let dl={},OQ=[];const IQ={};let LQ,pl,cM="dataLayer",gk=!1;function NEe(n,t,e){!function bEe(){const n=[];if(RA()&&n.push("This is a browser extension environment."),DA()||n.push("Cookies are not available."),n.length>0){const t=n.map((r,s)=>`(${s+1}) ${r}`).join(" "),e=ma.create("invalid-analytics-context",{errorInfo:t});ai.warn(e.message)}}();const r=n.options.appId;if(!r)throw ma.create("no-app-id");if(!n.options.apiKey){if(!n.options.measurementId)throw ma.create("no-api-key");ai.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=dl[r])throw ma.create("already-exists",{id:r});if(!gk){!function rEe(n){let t=[];Array.isArray(window[n])?t=window[n]:window[n]=t}(cM);const{wrappedGtag:i,gtagCore:o}=function aEe(n,t,e,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&"function"==typeof window[s]&&(i=window[s]),window[s]=function oEe(n,t,e,r){function i(){return(i=O(function*(o,c,u){try{"event"===o?yield iEe(n,t,e,c,u):"config"===o?yield sEe(n,t,e,r,c,u):"consent"===o?n("consent","update",u):n("set",c)}catch(h){ai.error(h)}})).apply(this,arguments)}return function s(o,c,u){return i.apply(this,arguments)}}(i,n,t,e),{gtagCore:i,wrappedGtag:window[s]}}(dl,OQ,IQ,cM,"gtag");pl=i,LQ=o,gk=!0}return dl[r]=function TEe(n,t,e,r,s,i,o){return pk.apply(this,arguments)}(n,OQ,IQ,t,LQ,cM,e),new wEe(n)}function OEe(){return mk.apply(this,arguments)}function mk(){return(mk=O(function*(){if(RA()||!DA()||!Wu())return!1;try{return yield op()}catch{return!1}})).apply(this,arguments)}const kQ="@firebase/analytics";!function xEe(){Ji(new Pi(aM,(t,{options:e})=>NEe(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e),"PUBLIC")),Ji(new Pi("analytics-internal",function n(t){try{const e=t.getProvider(aM).getImmediate();return{logEvent:(r,s,i)=>function IEe(n,t,e,r){n=Wr(n),function CEe(n,t,e,r,s){return ak.apply(this,arguments)}(pl,dl[n.app.options.appId],t,e,r).catch(s=>ai.error(s))}(e,r,s,i)}}catch(e){throw ma.create("interop-component-reg-failed",{reason:e})}},"PRIVATE")),ns(kQ,"0.8.4"),ns(kQ,"0.8.4","esm2017")}();class LEe extends H1{constructor(t,e){super()}schedule(t,e=0){return this}}const lM={setInterval(n,t,...e){const{delegate:r}=lM;return r?.setInterval?r.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=lM;return(t?.clearInterval||clearInterval)(n)},delegate:void 0};class DQ extends LEe{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var r;if(this.closed)return this;this.state=t;const s=this.id,i=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(i,s,e)),this.pending=!0,this.delay=e,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(i,this.id,e),this}requestAsyncId(t,e,r=0){return lM.setInterval(t.flush.bind(t,this),r)}recycleAsyncId(t,e,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return e;null!=e&&lM.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let s,r=!1;try{this.work(t)}catch(i){r=!0,s=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:r}=e;this.work=this.state=this.scheduler=null,this.pending=!1,gc(r,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const _k={now:()=>(_k.delegate||Date).now(),delegate:void 0};class fg{constructor(t,e=fg.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,r){return new this.schedulerActionCtor(this,t).schedule(r,e)}}fg.now=_k.now;class zQ extends fg{constructor(t,e=fg.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let r;this._active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}}const DEe=new class REe extends zQ{}(class kEe extends DQ{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(t,e,r):(t.flush(this),0)}}),zEe=new zQ(DQ),uM=new v6("7.4.1"),vk="__angularfire_symbol__analyticsIsSupportedValue",Ck="__angularfire_symbol__analyticsIsSupported",yk="__angularfire_symbol__remoteConfigIsSupportedValue",Ek="__angularfire_symbol__remoteConfigIsSupported",Mk="__angularfire_symbol__messagingIsSupportedValue",Sk="__angularfire_symbol__messagingIsSupported";function Tk(n,t,e){if(t){if(1===t.length)return t[0];const i=t.filter(o=>o.app===e);if(1===i.length)return i[0]}return e.container.getProvider(n).getImmediate({optional:!0})}globalThis[Ck]||(globalThis[Ck]=OEe().then(n=>globalThis[vk]=n).catch(()=>globalThis[vk]=!1)),globalThis[Sk]||(globalThis[Sk]=SQ().then(n=>globalThis[Mk]=n).catch(()=>globalThis[Mk]=!1)),globalThis[Ek]||(globalThis[Ek]=pye().then(n=>globalThis[yk]=n).catch(()=>globalThis[yk]=!1));const wk=(n,t)=>{const e=t?[t]:yj(),r=[];return e.forEach(s=>{s.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r};function yf(){}class VQ{constructor(t,e=DEe){this.zone=t,this.delegate=e}now(){return this.delegate.now()}schedule(t,e,r){const s=this.zone;return this.delegate.schedule(function(o){s.runGuarded(()=>{t.apply(this,[o])})},e,r)}}class VEe{constructor(t){this.zone=t,this.task=null}call(t,e){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",yf,{},yf,yf)),e.pipe(J2({next:r,complete:r,error:r})).subscribe(t).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let bk=(()=>{class n{constructor(e){this.ngZone=e,this.outsideAngular=e.runOutsideAngular(()=>new VQ(Zone.current)),this.insideAngular=e.run(()=>new VQ(Zone.current,zEe)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return n.\u0275fac=function(e){return new(e||n)(xe(vr))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function P8(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}function HEe(n){return P8().ngZone.runOutsideAngular(()=>n())}function T8(n){return P8().ngZone.run(()=>n())}function FEe(n){return P8(),function BEe(n){return function(e){return(e=e.lift(new VEe(n.ngZone))).pipe(La(n.outsideAngular),C4(n.insideAngular))}}(P8())(n)}const $Ee=(n,t)=>function(){const r=arguments;return t&&setTimeout(()=>{"scheduled"===t.state&&t.invoke()},10),T8(()=>n.apply(void 0,r))},yr=(n,t)=>function(){let e;const r=arguments;for(let i=0;i<arguments.length;i++)"function"==typeof r[i]&&(t&&(e||(e=T8(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",yf,{},yf,yf)))),r[i]=$Ee(r[i],e));const s=HEe(()=>n.apply(this,r));if(!t){if(s instanceof gr){const i=P8();return s.pipe(La(i.outsideAngular),C4(i.insideAngular))}return T8(()=>s)}return s instanceof gr?s.pipe(FEe):s instanceof Promise?T8(()=>new Promise((i,o)=>s.then(c=>T8(()=>i(c)),c=>T8(()=>o(c))))):"function"==typeof s&&e?function(){return setTimeout(()=>{e&&"scheduled"===e.state&&e.invoke()},10),s.apply(this,arguments)}:T8(()=>s)};class Ef{constructor(t){return t}}class Nk{constructor(){return yj()}}const Ak=new It("angularfire2._apps"),GEe={provide:Ef,useFactory:function UEe(n){return n&&1===n.length?n[0]:new Ef(KA())},deps:[[new Ks,Ak]]},WEe={provide:Nk,deps:[[new Ks,Ak]]};function qEe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new Ef(r)}}let jEe=(()=>{class n{constructor(e){ns("angularfire",uM.full,"core"),ns("angularfire",uM.full,"app"),ns("angular",H_.full,e.toString())}}return n.\u0275fac=function(e){return new(e||n)(xe(E9))},n.\u0275mod=qs({type:n}),n.\u0275inj=Fr({providers:[GEe,WEe]}),n})();const YEe=yr(Cj,!0),Ok=new Map,HQ={activated:!1,tokenObservers:[]},KEe={initialized:!1,enabled:!1};function ci(n){return Ok.get(n)||Object.assign({},HQ)}function fM(){return KEe}class nMe{constructor(t,e,r,s,i){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=r,this.lowerBound=s,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=s,s>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(t){var e=this;return O(function*(){e.stop();try{e.pending=new Vy,yield function rMe(n){return new Promise(t=>{setTimeout(t,n)})}(e.getNextRun(t)),e.pending.resolve(),yield e.pending.promise,e.pending=new Vy,yield e.operation(),e.pending.resolve(),yield e.pending.promise,e.process(!0).catch(()=>{})}catch(r){e.retryPolicy(r)?e.process(!1).catch(()=>{}):e.stop()}})()}getNextRun(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e}}}const ro=new q3("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function BQ(n){if(!ci(n).activated)throw ro.create("use-before-activation",{appName:n.name})}function Lk(n,t){return kk.apply(this,arguments)}function kk(){return kk=O(function*({url:n,body:t},e){var r,s;const i={"Content-Type":"application/json"},o=e.getImmediate({optional:!0});if(o){const T=yield o.getHeartbeatsHeader();T&&(i["X-Firebase-Client"]=T)}const c={method:"POST",body:JSON.stringify(t),headers:i};let u,h;try{u=yield fetch(n,c)}catch(T){throw ro.create("fetch-network-error",{originalErrorMessage:null===(r=T)||void 0===r?void 0:r.message})}if(200!==u.status)throw ro.create("fetch-status-error",{httpStatus:u.status});try{h=yield u.json()}catch(T){throw ro.create("fetch-parse-error",{originalErrorMessage:null===(s=T)||void 0===s?void 0:s.message})}const g=h.ttl.match(/^([\d.]+)(s)$/);if(!g||!g[2]||isNaN(Number(g[1])))throw ro.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${h.ttl}`});const m=1e3*Number(g[1]),v=Date.now();return{token:h.token,expireTimeMillis:v+m,issuedAtTimeMillis:v}}),kk.apply(this,arguments)}function aMe(n,t){const{projectId:e,appId:r,apiKey:s}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${e}/apps/${r}:exchangeDebugToken?key=${s}`,body:{debug_token:t}}}const hg="firebase-app-check-store";let pM=null;function UQ(){return pM||(pM=new Promise((n,t)=>{var e;try{const r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=s=>{n(s.target.result)},r.onerror=s=>{var i;t(ro.create("storage-open",{originalErrorMessage:null===(i=s.target.error)||void 0===i?void 0:i.message}))},r.onupgradeneeded=s=>{0===s.oldVersion&&s.target.result.createObjectStore(hg,{keyPath:"compositeKey"})}}catch(r){t(ro.create("storage-open",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message}))}}),pM)}function Rk(){return Rk=O(function*(n,t){const r=(yield UQ()).transaction(hg,"readwrite"),i=r.objectStore(hg).put({compositeKey:n,value:t});return new Promise((o,c)=>{i.onsuccess=u=>{o()},r.onerror=u=>{var h;c(ro.create("storage-set",{originalErrorMessage:null===(h=u.target.error)||void 0===h?void 0:h.message}))}})}),Rk.apply(this,arguments)}const dg=new x7("@firebase/app-check");function Vk(n,t){return Wu()?function fMe(n,t){return function GQ(n,t){return Rk.apply(this,arguments)}(function qQ(n){return`${n.options.appId}-${n.name}`}(n),t)}(n,t).catch(e=>{dg.warn(`Failed to write token to IndexedDB. Error: ${e}`)}):Promise.resolve()}function jQ(){return fM().enabled}function ZQ(){return Fk.apply(this,arguments)}function Fk(){return Fk=O(function*(){const n=fM();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),Fk.apply(this,arguments)}const _Me={error:"UNKNOWN_ERROR"};function vMe(n){return kA.encodeString(JSON.stringify(n),!1)}function gM(n){return Bk.apply(this,arguments)}function Bk(){return Bk=O(function*(n,t=!1){const e=n.app;BQ(e);const r=ci(e);let i,s=r.token;if(s&&!Mf(s)&&(r.token=void 0,s=void 0),!s){const u=yield r.cachedTokenPromise;u&&(Mf(u)?s=u:yield Vk(e,void 0))}if(!t&&s&&Mf(s))return{token:s.token};let c,o=!1;if(jQ()){r.exchangeTokenPromise||(r.exchangeTokenPromise=Lk(aMe(e,yield ZQ()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);const u=yield r.exchangeTokenPromise;return yield Vk(e,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),s=yield ci(e).exchangeTokenPromise}catch(u){"appCheck/throttled"===u.code?dg.warn(u.message):dg.error(u),i=u}return s?i?c=Mf(s)?{token:s.token,internalError:i}:XQ(i):(c={token:s.token},r.token=s,yield Vk(e,s)):c=XQ(i),o&&KQ(e,c),c}),Bk.apply(this,arguments)}function Uk(n,t){const e=ci(n),r=e.tokenObservers.filter(s=>s.next!==t);0===r.length&&e.tokenRefresher&&e.tokenRefresher.isRunning()&&e.tokenRefresher.stop(),e.tokenObservers=r}function YQ(n){const{app:t}=n,e=ci(t);let r=e.tokenRefresher;r||(r=function CMe(n){const{app:t}=n;return new nMe(O(function*(){let r;if(r=ci(t).token?yield gM(n,!0):yield gM(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{const e=ci(t);if(e.token){let r=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,e.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),e.tokenRefresher=r),!r.isRunning()&&e.isTokenAutoRefreshEnabled&&r.start()}function KQ(n,t){const e=ci(n).tokenObservers;for(const r of e)try{"EXTERNAL"===r.type&&null!=t.error?r.error(t.error):r.next(t)}catch{}}function Mf(n){return n.expireTimeMillis-Date.now()>0}function XQ(n){return{token:vMe(_Me),error:n}}class yMe{constructor(t,e){this.app=t,this.heartbeatServiceProvider=e}_delete(){const{tokenObservers:t}=ci(this.app);for(const e of t)Uk(this.app,e.next);return Promise.resolve()}}const iJ="app-check-internal";!function kMe(){Ji(new Pi("app-check",n=>function EMe(n,t){return new yMe(n,t)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,t,e)=>{n.getProvider(iJ).initialize()})),Ji(new Pi(iJ,n=>function MMe(n){return{getToken:t=>gM(n,t),addTokenListener:t=>function $k(n,t,e,r){const{app:s}=n,i=ci(s);if(i.tokenObservers=[...i.tokenObservers,{next:e,error:r,type:t}],i.token&&Mf(i.token)){const c=i.token;Promise.resolve().then(()=>{e({token:c.token}),YQ(n)}).catch(()=>{})}i.cachedTokenPromise.then(()=>YQ(n))}(n,"INTERNAL",t),removeTokenListener:t=>Uk(n.app,t)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),ns("@firebase/app-check","0.5.17")}();class jk{constructor(){return wk("app-check")}}typeof window<"u"&&window;const HMe=function aJ(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},cJ=new q3("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),lJ=new x7("@firebase/auth");function _M(n,...t){lJ.logLevel<=u1.ERROR&&lJ.error(`Auth (${k7}): ${n}`,...t)}function Ho(n,...t){throw Yk(n,...t)}function _a(n,...t){return Yk(n,...t)}function uJ(n,t,e){const r=Object.assign(Object.assign({},HMe()),{[t]:e});return new q3("auth","Firebase",r).create(t,{appName:n.name})}function Sf(n,t,e){if(!(t instanceof e))throw e.name!==t.constructor.name&&Ho(n,"argument-error"),uJ(n,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Yk(n,...t){if("string"!=typeof n){const e=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(e,...r)}return cJ.create(n,...t)}function Ke(n,t,...e){if(!n)throw Yk(t,...e)}function J3(n){const t="INTERNAL ASSERTION FAILED: "+n;throw _M(t),new Error(t)}function gl(n,t){n||J3(t)}const fJ=new Map;function ml(n){gl(n instanceof Function,"Expected a class definition");let t=fJ.get(n);return t?(gl(t instanceof n,"Instance stored in cache mismatched with class"),t):(t=new n,fJ.set(n,t),t)}function pg(){var n;return typeof self<"u"&&(null===(n=self.location)||void 0===n?void 0:n.href)||""}function hJ(){var n;return typeof self<"u"&&(null===(n=self.location)||void 0===n?void 0:n.protocol)||null}class gg{constructor(t,e){this.shortDelay=t,this.longDelay=e,gl(e>t,"Short delay should be less than long delay!"),this.isMobile=function Bde(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(M2())}()||function Ude(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()}get(){return function $Me(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function Kk(){return"http:"===hJ()||"https:"===hJ()}()||RA()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Xk(n,t){gl(n.emulator,"Emulator should always be set here");const{url:e}=n.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}class dJ{static initialize(t,e,r){this.fetchImpl=t,e&&(this.headersImpl=e),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void J3("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void J3("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void J3("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const GMe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},WMe=new gg(3e4,6e4);function n2(n,t){return n.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:n.tenantId}):t}function N2(n,t,e,r){return Qk.apply(this,arguments)}function Qk(){return Qk=O(function*(n,t,e,r,s={}){return pJ(n,s,O(function*(){let i={},o={};r&&("GET"===t?o=r:i={body:JSON.stringify(r)});const c=ap(Object.assign({key:n.config.apiKey},o)).slice(1),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode),dJ.fetch()(gJ(n,n.config.apiHost,e,c),Object.assign({method:t,headers:u,referrerPolicy:"no-referrer"},i))}))}),Qk.apply(this,arguments)}function pJ(n,t,e){return Jk.apply(this,arguments)}function Jk(){return Jk=O(function*(n,t,e){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},GMe),t);try{const s=new qMe(n),i=yield Promise.race([e(),s.promise]);s.clearNetworkTimeout();const o=yield i.json();if("needConfirmation"in o)throw mg(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===u)throw mg(n,"credential-already-in-use",o);if("EMAIL_EXISTS"===u)throw mg(n,"email-already-in-use",o);if("USER_DISABLED"===u)throw mg(n,"user-disabled",o);const g=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw uJ(n,g,h);Ho(n,g)}}catch(s){if(s instanceof Qa)throw s;Ho(n,"network-request-failed")}}),Jk.apply(this,arguments)}function _l(n,t,e,r){return eR.apply(this,arguments)}function eR(){return eR=O(function*(n,t,e,r,s={}){const i=yield N2(n,t,e,r,s);return"mfaPendingCredential"in i&&Ho(n,"multi-factor-auth-required",{_serverResponse:i}),i}),eR.apply(this,arguments)}function gJ(n,t,e,r){const s=`${t}${e}?${r}`;return n.config.emulator?Xk(n.config,s):`${n.config.apiScheme}://${s}`}class qMe{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,r)=>{this.timer=setTimeout(()=>r(_a(this.auth,"network-request-failed")),WMe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function mg(n,t,e){const r={appName:n.name};e.email&&(r.email=e.email),e.phoneNumber&&(r.phoneNumber=e.phoneNumber);const s=_a(n,t,r);return s.customData._tokenResponse=e,s}function tR(){return tR=O(function*(n,t){return N2(n,"POST","/v1/accounts:delete",t)}),tR.apply(this,arguments)}function YMe(n,t){return rR.apply(this,arguments)}function rR(){return rR=O(function*(n,t){return N2(n,"POST","/v1/accounts:lookup",t)}),rR.apply(this,arguments)}function _g(n){if(n)try{const t=new Date(Number(n));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}function sR(){return sR=O(function*(n,t=!1){const e=Wr(n),r=yield e.getIdToken(t),s=vM(r);Ke(s&&s.exp&&s.auth_time&&s.iat,e.auth,"internal-error");const i="object"==typeof s.firebase?s.firebase:void 0,o=i?.sign_in_provider;return{claims:s,token:r,authTime:_g(iR(s.auth_time)),issuedAtTime:_g(iR(s.iat)),expirationTime:_g(iR(s.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}),sR.apply(this,arguments)}function iR(n){return 1e3*Number(n)}function vM(n){var t;const[e,r,s]=n.split(".");if(void 0===e||void 0===r||void 0===s)return _M("JWT malformed, contained fewer than 3 sections"),null;try{const i=zy(r);return i?JSON.parse(i):(_M("Failed to decode base64 JWT payload"),null)}catch(i){return _M("Caught error parsing JWT payload as JSON",null===(t=i)||void 0===t?void 0:t.toString()),null}}function vl(n,t){return oR.apply(this,arguments)}function oR(){return oR=O(function*(n,t,e=!1){if(e)return t;try{return yield t}catch(r){throw r instanceof Qa&&QMe(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}}),oR.apply(this,arguments)}function QMe({code:n}){return"auth/user-disabled"===n||"auth/user-token-expired"===n}class JMe{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const r=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),r}{this.errorBackoff=3e4;const s=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(t=!1){var e=this;if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(O(function*(){yield e.iteration()}),r)}iteration(){var t=this;return O(function*(){var e;try{yield t.user.getIdToken(!0)}catch(r){return void("auth/network-request-failed"===(null===(e=r)||void 0===e?void 0:e.code)&&t.schedule(!0))}t.schedule()})()}}class mJ{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=_g(this.lastLoginAt),this.creationTime=_g(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function vg(n){return aR.apply(this,arguments)}function aR(){return aR=O(function*(n){var t;const e=n.auth,r=yield n.getIdToken(),s=yield vl(n,YMe(e,{idToken:r}));Ke(s?.users.length,e,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=null!==(t=i.providerUserInfo)&&void 0!==t&&t.length?nSe(i.providerUserInfo):[],c=tSe(n.providerData,o),g=!!n.isAnonymous&&!(n.email&&i.passwordHash||c?.length),m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new mJ(i.createdAt,i.lastLoginAt),isAnonymous:g};Object.assign(n,m)}),aR.apply(this,arguments)}function cR(){return cR=O(function*(n){const t=Wr(n);yield vg(t),yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}),cR.apply(this,arguments)}function tSe(n,t){return[...n.filter(r=>!t.some(s=>s.providerId===r.providerId)),...t]}function nSe(n){return n.map(t=>{var{providerId:e}=t,r=Z8(t,["providerId"]);return{providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function lR(){return lR=O(function*(n,t){const e=yield pJ(n,{},O(function*(){const r=ap({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=gJ(n,s,"/v1/token",`key=${i}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",dJ.fetch()(o,{method:"POST",headers:c,body:r})}));return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}),lR.apply(this,arguments)}class Cg{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Ke(t.idToken,"internal-error"),Ke(typeof t.idToken<"u","internal-error"),Ke(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):function XMe(n){const t=vM(n);return Ke(t,"internal-error"),Ke(typeof t.exp<"u","internal-error"),Ke(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}getToken(t,e=!1){var r=this;return O(function*(){return Ke(!r.accessToken||r.refreshToken,t,"user-token-expired"),e||!r.accessToken||r.isExpired?r.refreshToken?(yield r.refresh(t,r.refreshToken),r.accessToken):null:r.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(t,e){var r=this;return O(function*(){const{accessToken:s,refreshToken:i,expiresIn:o}=yield function rSe(n,t){return lR.apply(this,arguments)}(t,e);r.updateTokensAndExpiration(s,i,Number(o))})()}updateTokensAndExpiration(t,e,r){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(t,e){const{refreshToken:r,accessToken:s,expirationTime:i}=e,o=new Cg;return r&&(Ke("string"==typeof r,"internal-error",{appName:t}),o.refreshToken=r),s&&(Ke("string"==typeof s,"internal-error",{appName:t}),o.accessToken=s),i&&(Ke("number"==typeof i,"internal-error",{appName:t}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Cg,this.toJSON())}_performRefresh(){return J3("not implemented")}}function o0(n,t){Ke("string"==typeof n||typeof n>"u","internal-error",{appName:t})}class w8{constructor(t){var{uid:e,auth:r,stsTokenManager:s}=t,i=Z8(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new JMe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new mJ(i.createdAt||void 0,i.lastLoginAt||void 0)}getIdToken(t){var e=this;return O(function*(){const r=yield vl(e,e.stsTokenManager.getToken(e.auth,t));return Ke(r,e.auth,"internal-error"),e.accessToken!==r&&(e.accessToken=r,yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)),r})()}getIdTokenResult(t){return function KMe(n){return sR.apply(this,arguments)}(this,t)}reload(){return function eSe(n){return cR.apply(this,arguments)}(this)}_assign(t){this!==t&&(Ke(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>Object.assign({},e)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){return new w8(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(t){Ke(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(t,e=!1){var r=this;return O(function*(){let s=!1;t.idToken&&t.idToken!==r.stsTokenManager.accessToken&&(r.stsTokenManager.updateFromServerResponse(t),s=!0),e&&(yield vg(r)),yield r.auth._persistUserIfCurrent(r),s&&r.auth._notifyListenersIfCurrent(r)})()}delete(){var t=this;return O(function*(){const e=yield t.getIdToken();return yield vl(t,function jMe(n,t){return tR.apply(this,arguments)}(t.auth,{idToken:e})),t.stsTokenManager.clearRefreshToken(),t.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var r,s,i,o,c,u,h,g;const m=null!==(r=e.displayName)&&void 0!==r?r:void 0,v=null!==(s=e.email)&&void 0!==s?s:void 0,T=null!==(i=e.phoneNumber)&&void 0!==i?i:void 0,I=null!==(o=e.photoURL)&&void 0!==o?o:void 0,z=null!==(c=e.tenantId)&&void 0!==c?c:void 0,Z=null!==(u=e._redirectEventId)&&void 0!==u?u:void 0,te=null!==(h=e.createdAt)&&void 0!==h?h:void 0,me=null!==(g=e.lastLoginAt)&&void 0!==g?g:void 0,{uid:J,emailVerified:Ne,isAnonymous:He,providerData:qe,stsTokenManager:Dt}=e;Ke(J&&Dt,t,"internal-error");const A1=Cg.fromJSON(this.name,Dt);Ke("string"==typeof J,t,"internal-error"),o0(m,t.name),o0(v,t.name),Ke("boolean"==typeof Ne,t,"internal-error"),Ke("boolean"==typeof He,t,"internal-error"),o0(T,t.name),o0(I,t.name),o0(z,t.name),o0(Z,t.name),o0(te,t.name),o0(me,t.name);const M1=new w8({uid:J,auth:t,email:v,emailVerified:Ne,displayName:m,isAnonymous:He,photoURL:I,phoneNumber:T,tenantId:z,stsTokenManager:A1,createdAt:te,lastLoginAt:me});return qe&&Array.isArray(qe)&&(M1.providerData=qe.map(Yr=>Object.assign({},Yr))),Z&&(M1._redirectEventId=Z),M1}static _fromIdTokenResponse(t,e,r=!1){return O(function*(){const s=new Cg;s.updateFromServerResponse(e);const i=new w8({uid:e.localId,auth:t,stsTokenManager:s,isAnonymous:r});return yield vg(i),i})()}}const _J=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return O(function*(){return!0})()}_set(e,r){var s=this;return O(function*(){s.storage[e]=r})()}_get(e){var r=this;return O(function*(){const s=r.storage[e];return void 0===s?null:s})()}_remove(e){var r=this;return O(function*(){delete r.storage[e]})()}_addListener(e,r){}_removeListener(e,r){}}return n.type="NONE",n})();function CM(n,t,e){return`firebase:${n}:${t}:${e}`}class Pf{constructor(t,e,r){this.persistence=t,this.auth=e,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=CM(this.userKey,s.apiKey,i),this.fullPersistenceKey=CM("persistence",s.apiKey,i),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}getCurrentUser(){var t=this;return O(function*(){const e=yield t.persistence._get(t.fullUserKey);return e?w8._fromJSON(t.auth,e):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(t){var e=this;return O(function*(){if(e.persistence===t)return;const r=yield e.getCurrentUser();return yield e.removeCurrentUser(),e.persistence=t,r?e.setCurrentUser(r):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(t,e,r="authUser"){return O(function*(){if(!e.length)return new Pf(ml(_J),t,r);const s=(yield Promise.all(e.map(function(){var h=O(function*(g){if(yield g._isAvailable())return g});return function(g){return h.apply(this,arguments)}}()))).filter(h=>h);let i=s[0]||ml(_J);const o=CM(r,t.config.apiKey,t.name);let c=null;for(const h of e)try{const g=yield h._get(o);if(g){const m=w8._fromJSON(t,g);h!==i&&(c=m),i=h;break}}catch{}const u=s.filter(h=>h._shouldAllowMigration);return i._shouldAllowMigration&&u.length?(i=u[0],c&&(yield i._set(o,c.toJSON())),yield Promise.all(e.map(function(){var h=O(function*(g){if(g!==i)try{yield g._remove(o)}catch{}});return function(g){return h.apply(this,arguments)}}())),new Pf(i,t,r)):new Pf(i,t,r)})()}}function vJ(n){const t=n.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(EJ(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(CJ(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(SJ(t))return"Blackberry";if(PJ(t))return"Webos";if(uR(t))return"Safari";if((t.includes("chrome/")||yJ(t))&&!t.includes("edge/"))return"Chrome";if(MJ(t))return"Android";{const r=n.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===r?.length)return r[1]}return"Other"}function CJ(n=M2()){return/firefox\//i.test(n)}function uR(n=M2()){const t=n.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function yJ(n=M2()){return/crios\//i.test(n)}function EJ(n=M2()){return/iemobile/i.test(n)}function MJ(n=M2()){return/android/i.test(n)}function SJ(n=M2()){return/blackberry/i.test(n)}function PJ(n=M2()){return/webos/i.test(n)}function yM(n=M2()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function TJ(n=M2()){return yM(n)||MJ(n)||PJ(n)||SJ(n)||/windows phone/i.test(n)||EJ(n)}function wJ(n,t=[]){let e;switch(n){case"Browser":e=vJ(M2());break;case"Worker":e=`${vJ(M2())}-${n}`;break;default:e=n}const r=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${k7}/${r}`}class aSe{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const r=i=>new Promise((o,c)=>{try{o(t(i))}catch(u){c(u)}});r.onAbort=e,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}runMiddleware(t){var e=this;return O(function*(){var r;if(e.auth.currentUser===t)return;const s=[];try{for(const i of e.queue)yield i(t),i.onAbort&&s.push(i.onAbort)}catch(i){s.reverse();for(const o of s)try{o()}catch{}throw e.auth._errorFactory.create("login-blocked",{originalMessage:null===(r=i)||void 0===r?void 0:r.message})}})()}}class cSe{constructor(t,e,r){this.app=t,this.heartbeatServiceProvider=e,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new bJ(this),this.idTokenSubscription=new bJ(this),this.beforeStateQueue=new aSe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=cJ,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(t,e){var r=this;return e&&(this._popupRedirectResolver=ml(e)),this._initializationPromise=this.queue(O(function*(){var s,i;if(!r._deleted&&(r.persistenceManager=yield Pf.create(r,t),!r._deleted)){if(null!==(s=r._popupRedirectResolver)&&void 0!==s&&s._shouldInitProactively)try{yield r._popupRedirectResolver._initialize(r)}catch{}yield r.initializeCurrentUser(e),r.lastNotifiedUid=(null===(i=r.currentUser)||void 0===i?void 0:i.uid)||null,!r._deleted&&(r._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var t=this;return O(function*(){if(t._deleted)return;const e=yield t.assertedPersistence.getCurrentUser();if(t.currentUser||e){if(t.currentUser&&e&&t.currentUser.uid===e.uid)return t._currentUser._assign(e),void(yield t.currentUser.getIdToken());yield t._updateCurrentUser(e,!0)}})()}initializeCurrentUser(t){var e=this;return O(function*(){var r;const s=yield e.assertedPersistence.getCurrentUser();let i=s,o=!1;if(t&&e.config.authDomain){yield e.getOrInitRedirectPersistenceManager();const c=null===(r=e.redirectUser)||void 0===r?void 0:r._redirectEventId,u=i?._redirectEventId,h=yield e.tryRedirectSignIn(t);(!c||c===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return e.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield e.beforeStateQueue.runMiddleware(i)}catch(c){i=s,e._popupRedirectResolver._overrideRedirectResult(e,()=>Promise.reject(c))}return i?e.reloadAndSetCurrentUserOrClear(i):e.directlySetCurrentUser(null)}return Ke(e._popupRedirectResolver,e,"argument-error"),yield e.getOrInitRedirectPersistenceManager(),e.redirectUser&&e.redirectUser._redirectEventId===i._redirectEventId?e.directlySetCurrentUser(i):e.reloadAndSetCurrentUserOrClear(i)})()}tryRedirectSignIn(t){var e=this;return O(function*(){let r=null;try{r=yield e._popupRedirectResolver._completeRedirectFn(e,t,!0)}catch{yield e._setRedirectUser(null)}return r})()}reloadAndSetCurrentUserOrClear(t){var e=this;return O(function*(){var r;try{yield vg(t)}catch(s){if("auth/network-request-failed"!==(null===(r=s)||void 0===r?void 0:r.code))return e.directlySetCurrentUser(null)}return e.directlySetCurrentUser(t)})()}useDeviceLanguage(){this.languageCode=function UMe(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}()}_delete(){var t=this;return O(function*(){t._deleted=!0})()}updateCurrentUser(t){var e=this;return O(function*(){const r=t?Wr(t):null;return r&&Ke(r.auth.config.apiKey===e.config.apiKey,e,"invalid-user-token"),e._updateCurrentUser(r&&r._clone(e))})()}_updateCurrentUser(t,e=!1){var r=this;return O(function*(){if(!r._deleted)return t&&Ke(r.tenantId===t.tenantId,r,"tenant-id-mismatch"),e||(yield r.beforeStateQueue.runMiddleware(t)),r.queue(O(function*(){yield r.directlySetCurrentUser(t),r.notifyAuthListeners()}))})()}signOut(){var t=this;return O(function*(){return yield t.beforeStateQueue.runMiddleware(null),(t.redirectPersistenceManager||t._popupRedirectResolver)&&(yield t._setRedirectUser(null)),t._updateCurrentUser(null,!0)})()}setPersistence(t){var e=this;return this.queue(O(function*(){yield e.assertedPersistence.setPersistence(ml(t))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new q3("auth","Firebase",t())}onAuthStateChanged(t,e,r){return this.registerStateListener(this.authStateSubscription,t,e,r)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,r){return this.registerStateListener(this.idTokenSubscription,t,e,r)}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}_setRedirectUser(t,e){var r=this;return O(function*(){const s=yield r.getOrInitRedirectPersistenceManager(e);return null===t?s.removeCurrentUser():s.setCurrentUser(t)})()}getOrInitRedirectPersistenceManager(t){var e=this;return O(function*(){if(!e.redirectPersistenceManager){const r=t&&ml(t)||e._popupRedirectResolver;Ke(r,e,"argument-error"),e.redirectPersistenceManager=yield Pf.create(e,[ml(r._redirectPersistence)],"redirectUser"),e.redirectUser=yield e.redirectPersistenceManager.getCurrentUser()}return e.redirectPersistenceManager})()}_redirectUserForId(t){var e=this;return O(function*(){var r,s;return e._isInitialized&&(yield e.queue(O(function*(){}))),(null===(r=e._currentUser)||void 0===r?void 0:r._redirectEventId)===t?e._currentUser:(null===(s=e.redirectUser)||void 0===s?void 0:s._redirectEventId)===t?e.redirectUser:null})()}_persistUserIfCurrent(t){var e=this;return O(function*(){if(t===e.currentUser)return e.queue(O(function*(){return e.directlySetCurrentUser(t)}))})()}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,r,s){if(this._deleted)return()=>{};const i="function"==typeof e?e:e.next.bind(e),o=this._isInitialized?Promise.resolve():this._initializationPromise;return Ke(o,this,"internal-error"),o.then(()=>i(this.currentUser)),"function"==typeof e?t.addObserver(e,r,s):t.addObserver(e)}directlySetCurrentUser(t){var e=this;return O(function*(){e.currentUser&&e.currentUser!==t&&e._currentUser._stopProactiveRefresh(),t&&e.isProactiveRefreshEnabled&&t._startProactiveRefresh(),e.currentUser=t,t?yield e.assertedPersistence.setCurrentUser(t):yield e.assertedPersistence.removeCurrentUser()})()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Ke(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=wJ(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var t=this;return O(function*(){var e;const r={"X-Client-Version":t.clientVersion};t.app.options.appId&&(r["X-Firebase-gmpid"]=t.app.options.appId);const s=yield null===(e=t.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader();return s&&(r["X-Firebase-Client"]=s),r})()}}function Fo(n){return Wr(n)}class bJ{constructor(t){this.auth=t,this.observer=null,this.addObserver=function n9e(n,t){const e=new r9e(n,t);return e.subscribe.bind(e)}(e=>this.observer=e)}get next(){return Ke(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function NJ(n,t,e){const r=Fo(n);Ke(r._canInitEmulator,r,"emulator-config-failed"),Ke(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const s=!!e?.disableWarnings,i=AJ(t),{host:o,port:c}=function lSe(n){const t=AJ(n),e=/(\/\/)?([^?#/]+)/.exec(n.substr(t.length));if(!e)return{host:"",port:null};const r=e[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:OJ(r.substr(i.length+1))}}{const[i,o]=r.split(":");return{host:i,port:OJ(o)}}}(t);r.config.emulator={url:`${i}//${o}${null===c?"":`:${c}`}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||function uSe(){function n(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",n):n())}()}function AJ(n){const t=n.indexOf(":");return t<0?"":n.substr(0,t+1)}function OJ(n){if(!n)return null;const t=Number(n);return isNaN(t)?null:t}class fR{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return J3("not implemented")}_getIdTokenResponse(t){return J3("not implemented")}_linkToIdToken(t,e){return J3("not implemented")}_getReauthenticationResolver(t){return J3("not implemented")}}function dR(){return dR=O(function*(n,t){return N2(n,"POST","/v1/accounts:update",t)}),dR.apply(this,arguments)}function gR(){return gR=O(function*(n,t){return _l(n,"POST","/v1/accounts:signInWithPassword",n2(n,t))}),gR.apply(this,arguments)}function EM(n,t){return mR.apply(this,arguments)}function mR(){return mR=O(function*(n,t){return N2(n,"POST","/v1/accounts:sendOobCode",n2(n,t))}),mR.apply(this,arguments)}function dSe(n,t){return _R.apply(this,arguments)}function _R(){return _R=O(function*(n,t){return EM(n,t)}),_R.apply(this,arguments)}function pSe(n,t){return vR.apply(this,arguments)}function vR(){return vR=O(function*(n,t){return EM(n,t)}),vR.apply(this,arguments)}function ER(){return ER=O(function*(n,t){return _l(n,"POST","/v1/accounts:signInWithEmailLink",n2(n,t))}),ER.apply(this,arguments)}function MR(){return MR=O(function*(n,t){return _l(n,"POST","/v1/accounts:signInWithEmailLink",n2(n,t))}),MR.apply(this,arguments)}class yg extends fR{constructor(t,e,r,s=null){super("password",r),this._email=t,this._password=e,this._tenantId=s}static _fromEmailAndPassword(t,e){return new yg(t,e,"password")}static _fromEmailAndCode(t,e,r=null){return new yg(t,e,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if(e?.email&&e?.password){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}_getIdTokenResponse(t){var e=this;return O(function*(){switch(e.signInMethod){case"password":return function hSe(n,t){return gR.apply(this,arguments)}(t,{returnSecureToken:!0,email:e._email,password:e._password});case"emailLink":return function _Se(n,t){return ER.apply(this,arguments)}(t,{email:e._email,oobCode:e._password});default:Ho(t,"internal-error")}})()}_linkToIdToken(t,e){var r=this;return O(function*(){switch(r.signInMethod){case"password":return function xJ(n,t){return dR.apply(this,arguments)}(t,{idToken:e,returnSecureToken:!0,email:r._email,password:r._password});case"emailLink":return function vSe(n,t){return MR.apply(this,arguments)}(t,{idToken:e,email:r._email,oobCode:r._password});default:Ho(t,"internal-error")}})()}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}function Cl(n,t){return SR.apply(this,arguments)}function SR(){return SR=O(function*(n,t){return _l(n,"POST","/v1/accounts:signInWithIdp",n2(n,t))}),SR.apply(this,arguments)}class Tf extends fR{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new Tf(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Ho("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:r,signInMethod:s}=e,i=Z8(e,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Tf(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(t){return Cl(t,this.buildRequest())}_linkToIdToken(t,e){const r=this.buildRequest();return r.idToken=e,Cl(t,r)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,Cl(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=ap(e)}return t}}class Mg{constructor(t){var e,r,s,i,o,c;const u=cp(lp(t)),h=null!==(e=u.apiKey)&&void 0!==e?e:null,g=null!==(r=u.oobCode)&&void 0!==r?r:null,m=function TSe(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(s=u.mode)&&void 0!==s?s:null);Ke(h&&g&&m,"argument-error"),this.apiKey=h,this.operation=m,this.code=g,this.continueUrl=null!==(i=u.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(c=u.tenantId)&&void 0!==c?c:null}static parseLink(t){const e=function wSe(n){const t=cp(lp(n)).link,e=t?cp(lp(t)).deep_link_id:null,r=cp(lp(n)).deep_link_id;return(r?cp(lp(r)).link:null)||r||e||t||n}(t);try{return new Mg(e)}catch{return null}}}let LJ=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(e,r){return yg._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const s=Mg.parseLink(r);return Ke(s,"argument-error"),yg._fromEmailAndCode(e,s.code,s.tenantId)}}return n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink",n})();class a0{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class kJ extends a0{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}let bSe=(()=>{class n extends kJ{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Tf._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return n.credentialFromTaggedObject(e)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:s}=e;if(!r&&!s)return null;try{return n.credential(r,s)}catch{return null}}}return n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com",n})();function RJ(n,t){return AR.apply(this,arguments)}function AR(){return AR=O(function*(n,t){return _l(n,"POST","/v1/accounts:signUp",n2(n,t))}),AR.apply(this,arguments)}class Ja{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static _fromIdTokenResponse(t,e,r,s=!1){return O(function*(){const i=yield w8._fromIdTokenResponse(t,r,s),o=DJ(r);return new Ja({user:i,providerId:o,_tokenResponse:r,operationType:e})})()}static _forOperation(t,e,r){return O(function*(){yield t._updateTokensIfNecessary(r,!0);const s=DJ(r);return new Ja({user:t,providerId:s,_tokenResponse:r,operationType:e})})()}}function DJ(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class SM extends Qa{constructor(t,e,r,s){var i;super(e.code,e.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,SM.prototype),this.customData={appName:t.name,tenantId:null!==(i=t.tenantId)&&void 0!==i?i:void 0,_serverResponse:e.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(t,e,r,s){return new SM(t,e,r,s)}}function zJ(n,t,e,r){return("reauthenticate"===t?e._getReauthenticationResolver(n):e._getIdTokenResponse(n)).catch(i=>{throw"auth/multi-factor-auth-required"===i.code?SM._fromErrorAndOperation(n,i,t,r):i})}function xR(n,t){return LR.apply(this,arguments)}function LR(){return LR=O(function*(n,t,e=!1){const r=yield vl(n,t._linkToIdToken(n.auth,yield n.getIdToken()),e);return Ja._forOperation(n,"link",r)}),LR.apply(this,arguments)}function RR(){return RR=O(function*(n,t,e=!1){var r;const{auth:s}=n,i="reauthenticate";try{const o=yield vl(n,zJ(s,i,t,n),e);Ke(o.idToken,s,"internal-error");const c=vM(o.idToken);Ke(c,s,"internal-error");const{sub:u}=c;return Ke(n.uid===u,s,"user-mismatch"),Ja._forOperation(n,i,o)}catch(o){throw"auth/user-not-found"===(null===(r=o)||void 0===r?void 0:r.code)&&Ho(s,"user-mismatch"),o}}),RR.apply(this,arguments)}function FJ(n,t){return DR.apply(this,arguments)}function DR(){return DR=O(function*(n,t,e=!1){const r="signIn",s=yield zJ(n,r,t),i=yield Ja._fromIdTokenResponse(n,r,s);return e||(yield n._updateCurrentUser(i.user)),i}),DR.apply(this,arguments)}function VR(){return VR=O(function*(n,t){return FJ(Fo(n),t)}),VR.apply(this,arguments)}function TM(n,t,e){var r;Ke((null===(r=e.url)||void 0===r?void 0:r.length)>0,n,"invalid-continue-uri"),Ke(typeof e.dynamicLinkDomain>"u"||e.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),t.continueUrl=e.url,t.dynamicLinkDomain=e.dynamicLinkDomain,t.canHandleCodeInApp=e.handleCodeInApp,e.iOS&&(Ke(e.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),t.iOSBundleId=e.iOS.bundleId),e.android&&(Ke(e.android.packageName.length>0,n,"missing-android-pkg-name"),t.androidInstallApp=e.android.installApp,t.androidMinimumVersionCode=e.android.minimumVersion,t.androidPackageName=e.android.packageName)}function LSe(n,t,e){return WR.apply(this,arguments)}function WR(){return WR=O(function*(n,t,e){const r=Wr(n),s={requestType:"PASSWORD_RESET",email:t};e&&TM(r,s,e),yield pSe(r,s)}),WR.apply(this,arguments)}function RSe(n,t,e){return KR.apply(this,arguments)}function KR(){return KR=O(function*(n,t,e){const r=Fo(n),s=yield RJ(r,{returnSecureToken:!0,email:t,password:e}),i=yield Ja._fromIdTokenResponse(r,"signIn",s);return yield r._updateCurrentUser(i.user),i}),KR.apply(this,arguments)}function DSe(n,t,e){return function zR(n,t){return VR.apply(this,arguments)}(Wr(n),LJ.credential(t,e))}function VSe(n,t){return tD.apply(this,arguments)}function tD(){return tD=O(function*(n,t){const e=Wr(n),s={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};t&&TM(e.auth,s,t);const{email:i}=yield dSe(e.auth,s);i!==n.email&&(yield n.reload())}),tD.apply(this,arguments)}function HSe(n,t){return rD.apply(this,arguments)}function rD(){return rD=O(function*(n,t){return N2(n,"POST","/v1/accounts:update",t)}),rD.apply(this,arguments)}function FSe(n,t){return sD.apply(this,arguments)}function sD(){return sD=O(function*(n,{displayName:t,photoURL:e}){if(void 0===t&&void 0===e)return;const r=Wr(n),i={idToken:yield r.getIdToken(),displayName:t,photoUrl:e,returnSecureToken:!0},o=yield vl(r,HSe(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const c=r.providerData.find(({providerId:u})=>"password"===u);c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),yield r._updateTokensIfNecessary(o)}),sD.apply(this,arguments)}function ZSe(n,t,e,r){return Wr(n).onAuthStateChanged(t,e,r)}const wM="__sak";class $J{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(wM,"1"),this.storage.removeItem(wM),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const tPe=(()=>{class n extends $J{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function QSe(){const n=M2();return uR(n)||yM(n)}()&&function oSe(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=TJ(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const s=this.storage.getItem(r),i=this.localCache[r];s!==i&&e(r,i,s)}}onStorageEvent(e,r=!1){if(!e.key)return void this.forAllChangedKeys((c,u,h)=>{this.notifyListeners(c,h)});const s=e.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const c=this.storage.getItem(s);if(e.newValue!==c)null!==e.newValue?this.storage.setItem(s,e.newValue):this.storage.removeItem(s);else if(this.localCache[s]===e.newValue&&!r)return}const i=()=>{const c=this.storage.getItem(s);!r&&this.localCache[s]===c||this.notifyListeners(s,c)},o=this.storage.getItem(s);!function iSe(){return function Gde(){const n=M2();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}()&&10===document.documentMode}()||o===e.newValue||e.newValue===e.oldValue?i():setTimeout(i,10)}notifyListeners(e,r){this.localCache[e]=r;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:s}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(e,r){var s=()=>super._set,i=this;return O(function*(){yield s().call(i,e,r),i.localCache[e]=JSON.stringify(r)})()}_get(e){var r=()=>super._get,s=this;return O(function*(){const i=yield r().call(s,e);return s.localCache[e]=JSON.stringify(i),i})()}_remove(e){var r=()=>super._remove,s=this;return O(function*(){yield r().call(s,e),delete s.localCache[e]})()}}return n.type="LOCAL",n})(),UJ=(()=>{class n extends $J{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}return n.type="SESSION",n})();let rPe=(()=>{class n{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const s=new n(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}handleEvent(e){var r=this;return O(function*(){const s=e,{eventId:i,eventType:o,data:c}=s.data,u=r.handlersMap[o];if(!u?.size)return;s.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const h=Array.from(u).map(function(){var m=O(function*(v){return v(s.origin,c)});return function(v){return m.apply(this,arguments)}}()),g=yield function nPe(n){return Promise.all(n.map(function(){var t=O(function*(e){try{return{fulfilled:!0,value:yield e}}catch(r){return{fulfilled:!1,reason:r}}});return function(e){return t.apply(this,arguments)}}()))}(h);s.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:g})})()}_subscribe(e,r){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return n.receivers=[],n})();function bM(n="",t=10){let e="";for(let r=0;r<t;r++)e+=Math.floor(10*Math.random());return n+e}class sPe{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}_send(t,e,r=50){var s=this;return O(function*(){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,c;return new Promise((u,h)=>{const g=bM("",20);i.port1.start();const m=setTimeout(()=>{h(new Error("unsupported_event"))},r);c={messageChannel:i,onMessage(v){const T=v;if(T.data.eventId===g)switch(T.data.status){case"ack":clearTimeout(m),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(T.data.response);break;default:clearTimeout(m),clearTimeout(o),h(new Error("invalid_response"))}}},s.handlers.add(c),i.port1.addEventListener("message",c.onMessage),s.target.postMessage({eventType:t,eventId:g,data:e},[i.port2])}).finally(()=>{c&&s.removeMessageHandler(c)})})()}}function r2(){return window}function fD(){return typeof r2().WorkerGlobalScope<"u"&&"function"==typeof r2().importScripts}function hD(){return(hD=O(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const GJ="firebaseLocalStorageDb",NM="firebaseLocalStorage",WJ="fbase_key";class Pg{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function AM(n,t){return n.transaction([NM],t?"readwrite":"readonly").objectStore(NM)}function dD(){const n=indexedDB.open(GJ,1);return new Promise((t,e)=>{n.addEventListener("error",()=>{e(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(NM,{keyPath:WJ})}catch(s){e(s)}}),n.addEventListener("success",O(function*(){const r=n.result;r.objectStoreNames.contains(NM)?t(r):(r.close(),yield function uPe(){const n=indexedDB.deleteDatabase(GJ);return new Pg(n).toPromise()}(),t(yield dD()))}))})}function qJ(n,t,e){return pD.apply(this,arguments)}function pD(){return pD=O(function*(n,t,e){const r=AM(n,!0).put({[WJ]:t,value:e});return new Pg(r).toPromise()}),pD.apply(this,arguments)}function gD(){return gD=O(function*(n,t){const e=AM(n,!1).get(t),r=yield new Pg(e).toPromise();return void 0===r?null:r.value}),gD.apply(this,arguments)}function jJ(n,t){const e=AM(n,!0).delete(t);return new Pg(e).toPromise()}const pPe=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var e=this;return O(function*(){return e.db||(e.db=yield dD()),e.db})()}_withRetries(e){var r=this;return O(function*(){let s=0;for(;;)try{const i=yield r._openDb();return yield e(i)}catch(i){if(s++>3)throw i;r.db&&(r.db.close(),r.db=void 0)}})()}initializeServiceWorkerMessaging(){var e=this;return O(function*(){return fD()?e.initializeReceiver():e.initializeSender()})()}initializeReceiver(){var e=this;return O(function*(){e.receiver=rPe._getInstance(function cPe(){return fD()?self:null}()),e.receiver._subscribe("keyChanged",function(){var r=O(function*(s,i){return{keyProcessed:(yield e._poll()).includes(i.key)}});return function(s,i){return r.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var r=O(function*(s,i){return["keyChanged"]});return function(s,i){return r.apply(this,arguments)}}())})()}initializeSender(){var e=this;return O(function*(){var r,s;if(e.activeServiceWorker=yield function oPe(){return hD.apply(this,arguments)}(),!e.activeServiceWorker)return;e.sender=new sPe(e.activeServiceWorker);const i=yield e.sender._send("ping",{},800);!i||(null===(r=i[0])||void 0===r?void 0:r.fulfilled)&&(null===(s=i[0])||void 0===s?void 0:s.value.includes("keyChanged"))&&(e.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(e){var r=this;return O(function*(){if(r.sender&&r.activeServiceWorker&&function aPe(){var n;return(null===(n=navigator?.serviceWorker)||void 0===n?void 0:n.controller)||null}()===r.activeServiceWorker)try{yield r.sender._send("keyChanged",{key:e},r.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return O(function*(){try{if(!indexedDB)return!1;const e=yield dD();return yield qJ(e,wM,"1"),yield jJ(e,wM),!0}catch{}return!1})()}_withPendingWrite(e){var r=this;return O(function*(){r.pendingWrites++;try{yield e()}finally{r.pendingWrites--}})()}_set(e,r){var s=this;return O(function*(){return s._withPendingWrite(O(function*(){return yield s._withRetries(i=>qJ(i,e,r)),s.localCache[e]=r,s.notifyServiceWorker(e)}))})()}_get(e){var r=this;return O(function*(){const s=yield r._withRetries(i=>function fPe(n,t){return gD.apply(this,arguments)}(i,e));return r.localCache[e]=s,s})()}_remove(e){var r=this;return O(function*(){return r._withPendingWrite(O(function*(){return yield r._withRetries(s=>jJ(s,e)),delete r.localCache[e],r.notifyServiceWorker(e)}))})()}_poll(){var e=this;return O(function*(){const r=yield e._withRetries(o=>{const c=AM(o,!1).getAll();return new Pg(c).toPromise()});if(!r)return[];if(0!==e.pendingWrites)return[];const s=[],i=new Set;for(const{fbase_key:o,value:c}of r)i.add(o),JSON.stringify(e.localCache[o])!==JSON.stringify(c)&&(e.notifyListeners(o,c),s.push(o));for(const o of Object.keys(e.localCache))e.localCache[o]&&!i.has(o)&&(e.notifyListeners(o,null),s.push(o));return s})()}notifyListeners(e,r){this.localCache[e]=r;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(r)}startPolling(){var e=this;this.stopPolling(),this.pollTimer=setInterval(O(function*(){return e._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return n.type="LOCAL",n})();function YJ(n){return`__${n}${Math.floor(1e6*Math.random())}`}function N8(n,t){return t?ml(t):(Ke(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}YJ("rcb"),new gg(3e4,6e4);class TD extends fR{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Cl(t,this._buildIdpRequest())}_linkToIdToken(t,e){return Cl(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return Cl(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function IPe(n){return FJ(n.auth,new TD(n),n.bypassAuthState)}function xPe(n){const{auth:t,user:e}=n;return Ke(e,t,"internal-error"),function HJ(n,t){return RR.apply(this,arguments)}(e,new TD(n),n.bypassAuthState)}function LPe(n){return wD.apply(this,arguments)}function wD(){return wD=O(function*(n){const{auth:t,user:e}=n;return Ke(e,t,"internal-error"),xR(e,new TD(n),n.bypassAuthState)}),wD.apply(this,arguments)}class XJ{constructor(t,e,r,s,i=!1){this.auth=t,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){var t=this;return new Promise(function(){var e=O(function*(r,s){t.pendingPromise={resolve:r,reject:s};try{t.eventManager=yield t.resolver._initialize(t.auth),yield t.onExecution(),t.eventManager.registerConsumer(t)}catch(i){t.reject(i)}});return function(r,s){return e.apply(this,arguments)}}())}onAuthEvent(t){var e=this;return O(function*(){const{urlResponse:r,sessionId:s,postBody:i,tenantId:o,error:c,type:u}=t;if(c)return void e.reject(c);const h={auth:e.auth,requestUri:r,sessionId:s,tenantId:o||void 0,postBody:i||void 0,user:e.user,bypassAuthState:e.bypassAuthState};try{e.resolve(yield e.getIdpTask(u)(h))}catch(g){e.reject(g)}})()}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return IPe;case"linkViaPopup":case"linkViaRedirect":return LPe;case"reauthViaPopup":case"reauthViaRedirect":return xPe;default:Ho(this.auth,"internal-error")}}resolve(t){gl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){gl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const kPe=new gg(2e3,1e4);function RPe(n,t,e){return bD.apply(this,arguments)}function bD(){return bD=O(function*(n,t,e){const r=Fo(n);Sf(n,t,a0);const s=N8(r,e);return new OD(r,"signInViaPopup",t,s).executeNotNull()}),bD.apply(this,arguments)}let OD=(()=>{class n extends XJ{constructor(e,r,s,i,o){super(e,r,i,o),this.provider=s,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){var e=this;return O(function*(){const r=yield e.execute();return Ke(r,e.auth,"internal-error"),r})()}onExecution(){var e=this;return O(function*(){gl(1===e.filter.length,"Popup operations only handle one event");const r=bM();e.authWindow=yield e.resolver._openPopup(e.auth,e.provider,e.filter[0],r),e.authWindow.associatedEvent=r,e.resolver._originValidation(e.auth).catch(s=>{e.reject(s)}),e.resolver._isIframeWebStorageSupported(e.auth,s=>{s||e.reject(_a(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation()})()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(_a(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,s;this.pollId=null!==(s=null===(r=this.authWindow)||void 0===r?void 0:r.window)&&void 0!==s&&s.closed?window.setTimeout(()=>{this.pollId=null,this.reject(_a(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(e,kPe.get())};e()}}return n.currentPopupAction=null,n})();const Tg=new Map;class zPe extends XJ{constructor(t,e,r=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,r),this.eventId=null}execute(){var t=()=>super.execute,e=this;return O(function*(){let r=Tg.get(e.auth._key());if(!r){try{const i=(yield function VPe(n,t){return ID.apply(this,arguments)}(e.resolver,e.auth))?yield t().call(e):null;r=()=>Promise.resolve(i)}catch(s){r=()=>Promise.reject(s)}Tg.set(e.auth._key(),r)}return e.bypassAuthState||Tg.set(e.auth._key(),()=>Promise.resolve(null)),r()})()}onAuthEvent(t){var e=()=>super.onAuthEvent,r=this;return O(function*(){if("signInViaRedirect"===t.type)return e().call(r,t);if("unknown"!==t.type){if(t.eventId){const s=yield r.auth._redirectUserForId(t.eventId);if(s)return r.user=s,e().call(r,t);r.resolve(null)}}else r.resolve(null)})()}onExecution(){return O(function*(){})()}cleanUp(){}}function ID(){return ID=O(function*(n,t){const e=JJ(t),r=QJ(n);if(!(yield r._isAvailable()))return!1;const s="true"===(yield r._get(e));return yield r._remove(e),s}),ID.apply(this,arguments)}function HPe(n,t){Tg.set(n._key(),t)}function QJ(n){return ml(n._redirectPersistence)}function JJ(n){return CM("pendingRedirect",n.config.apiKey,n.name)}function eee(n,t){return VD.apply(this,arguments)}function VD(){return VD=O(function*(n,t,e=!1){const r=Fo(n),s=N8(r,t),o=yield new zPe(r,s,e).execute();return o&&!e&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,t)),o}),VD.apply(this,arguments)}class GPe{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(t,r)&&(e=!0,this.sendToConsumer(t,r),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!function WPe(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ree(n);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var r;if(t.error&&!ree(t)){const s=(null===(r=t.error.code)||void 0===r?void 0:r.split("auth/")[1])||"internal-error";e.onError(_a(this.auth,s))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const r=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&r}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(nee(t))}saveEventToCache(t){this.cachedEventUids.add(nee(t)),this.lastProcessedEventTime=Date.now()}}function nee(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(t=>t).join("-")}function ree({type:n,error:t}){return"unknown"===n&&"auth/no-auth-event"===t?.code}function qPe(n){return FD.apply(this,arguments)}function FD(){return FD=O(function*(n,t={}){return N2(n,"GET","/v1/projects",t)}),FD.apply(this,arguments)}const jPe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ZPe=/^https?/;function BD(){return BD=O(function*(n){if(n.config.emulator)return;const{authorizedDomains:t}=yield qPe(n);for(const e of t)try{if(KPe(e))return}catch{}Ho(n,"unauthorized-domain")}),BD.apply(this,arguments)}function KPe(n){const t=pg(),{protocol:e,hostname:r}=new URL(t);if(n.startsWith("chrome-extension://")){const o=new URL(n);return""===o.hostname&&""===r?"chrome-extension:"===e&&n.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===e&&o.hostname===r}if(!ZPe.test(e))return!1;if(jPe.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const XPe=new gg(3e4,6e4);function see(){const n=r2().___jsl;if(n?.H)for(const t of Object.keys(n.H))if(n.H[t].r=n.H[t].r||[],n.H[t].L=n.H[t].L||[],n.H[t].r=[...n.H[t].L],n.CP)for(let e=0;e<n.CP.length;e++)n.CP[e]=null}let IM=null;function JPe(n){return IM=IM||function QPe(n){return new Promise((t,e)=>{var r,s,i;function o(){see(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{see(),e(_a(n,"network-request-failed"))},timeout:XPe.get()})}if(null!==(s=null===(r=r2().gapi)||void 0===r?void 0:r.iframes)&&void 0!==s&&s.Iframe)t(gapi.iframes.getContext());else{if(null===(i=r2().gapi)||void 0===i||!i.load){const c=YJ("iframefcb");return r2()[c]=()=>{gapi.load?o():e(_a(n,"network-request-failed"))},function ZJ(n){return new Promise((t,e)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=t,r.onerror=s=>{const i=_a("internal-error");i.customData=s,e(i)},r.type="text/javascript",r.charset="UTF-8",function vPe(){var n,t;return null!==(t=null===(n=document.getElementsByTagName("head"))||void 0===n?void 0:n[0])&&void 0!==t?t:document}().appendChild(r)})}(`https://apis.google.com/js/api.js?onload=${c}`).catch(u=>e(u))}o()}}).catch(t=>{throw IM=null,t})}(n),IM}const eTe=new gg(5e3,15e3),rTe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},sTe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function iTe(n){const t=n.config;Ke(t.authDomain,n,"auth-domain-config-required");const e=t.emulator?Xk(t,"emulator/auth/iframe"):`https://${n.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:n.name,v:k7},s=sTe.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${e}?${ap(r).slice(1)}`}function $D(){return $D=O(function*(n){const t=yield JPe(n),e=r2().gapi;return Ke(e,n,"internal-error"),t.open({where:document.body,url:iTe(n),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:rTe,dontclear:!0},r=>new Promise(function(){var s=O(function*(i,o){yield r.restyle({setHideOnLeave:!1});const c=_a(n,"network-request-failed"),u=r2().setTimeout(()=>{o(c)},eTe.get());function h(){r2().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{o(c)})});return function(i,o){return s.apply(this,arguments)}}()))}),$D.apply(this,arguments)}const aTe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class iee{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function oee(n,t,e,r,s,i){Ke(n.config.authDomain,n,"auth-domain-config-required"),Ke(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:e,redirectUrl:r,v:k7,eventId:s};if(t instanceof a0){t.setDefaultLanguage(n.languageCode),o.providerId=t.providerId||"",function t9e(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,h]of Object.entries(i||{}))o[u]=h}if(t instanceof kJ){const u=t.getScopes().filter(h=>""!==h);u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const c=o;for(const u of Object.keys(c))void 0===c[u]&&delete c[u];return`${function mTe({config:n}){return n.emulator?Xk(n,"emulator/auth/handler"):`https://${n.authDomain}/__/auth/handler`}(n)}?${ap(c).slice(1)}`}const UD="webStorageSupport",vTe=class _Te{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=UJ,this._completeRedirectFn=eee,this._overrideRedirectResult=HPe}_openPopup(t,e,r,s){var i=this;return O(function*(){var o;gl(null===(o=i.eventManagers[t._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()");const c=oee(t,e,r,pg(),s);return function hTe(n,t,e,r=500,s=600){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},aTe),{width:r.toString(),height:s.toString(),top:i,left:o}),h=M2().toLowerCase();e&&(c=yJ(h)?"_blank":e),CJ(h)&&(t=t||"http://localhost",u.scrollbars="yes");const g=Object.entries(u).reduce((v,[T,I])=>`${v}${T}=${I},`,"");if(function sSe(n=M2()){var t;return yM(n)&&!(null===(t=window.navigator)||void 0===t||!t.standalone)}(h)&&"_self"!==c)return function dTe(n,t){const e=document.createElement("a");e.href=n,e.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(r)}(t||"",c),new iee(null);const m=window.open(t||"",c,g);Ke(m,n,"popup-blocked");try{m.focus()}catch{}return new iee(m)}(t,c,bM())})()}_openRedirect(t,e,r,s){var i=this;return O(function*(){return yield i._originValidation(t),function iPe(n){r2().location.href=n}(oee(t,e,r,pg(),s)),new Promise(()=>{})})()}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:s,promise:i}=this.eventManagers[e];return s?Promise.resolve(s):(gl(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(t);return this.eventManagers[e]={promise:r},r.catch(()=>{delete this.eventManagers[e]}),r}initAndGetManager(t){var e=this;return O(function*(){const r=yield function oTe(n){return $D.apply(this,arguments)}(t),s=new GPe(t);return r.register("authEvent",i=>(Ke(i?.authEvent,t,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),e.eventManagers[t._key()]={manager:s},e.iframes[t._key()]=r,s})()}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(UD,{type:UD},s=>{var i;const o=null===(i=s?.[0])||void 0===i?void 0:i[UD];void 0!==o&&e(!!o),Ho(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=function YPe(n){return BD.apply(this,arguments)}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return TJ()||uR()||yM()}};var cee="@firebase/auth";class CTe{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}getToken(t){var e=this;return O(function*(){return e.assertAuthConfigured(),yield e.auth._initializationPromise,e.auth.currentUser?{accessToken:yield e.auth.currentUser.getIdToken(t)}:null})()}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(r=>{var s;t((null===(s=r)||void 0===s?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);!e||(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Ke(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const STe=lj("authIdTokenMaxAge")||300;let uee=null;const PTe=n=>function(){var t=O(function*(e){const r=e&&(yield e.getIdTokenResult()),s=r&&((new Date).getTime()-Date.parse(r.issuedAtTime))/1e3;if(s&&s>STe)return;const i=r?.token;uee!==i&&(uee=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});return function(e){return t.apply(this,arguments)}}();function TTe(n=KA()){const t=L7(n,"auth");if(t.isInitialized())return t.getImmediate();const e=function FMe(n,t){const e=L7(n,"auth");if(e.isInitialized()){const s=e.getImmediate();if(Fy(e.getOptions(),t??{}))return s;Ho(s,"already-initialized")}return e.initialize({options:t})}(n,{popupRedirectResolver:vTe,persistence:[pPe,tPe,UJ]}),r=lj("authTokenSyncURL");if(r){const i=PTe(r);(function jSe(n,t,e){Wr(n).beforeAuthStateChanged(t,e)})(e,i,()=>i(e.currentUser)),function qSe(n,t,e,r){Wr(n).onIdTokenChanged(t,e,r)}(e,o=>i(o))}const s=cj("auth");return s&&NJ(e,`http://${s}`),e}!function ETe(n){Ji(new Pi("auth",(t,{options:e})=>{const r=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),{apiKey:i,authDomain:o}=r.options;return((c,u)=>{Ke(i&&!i.includes(":"),"invalid-api-key",{appName:c.name}),Ke(!o?.includes(":"),"argument-error",{appName:c.name});const h={apiKey:i,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:wJ(n)},g=new cSe(c,u,h);return function BMe(n,t){const e=t?.persistence||[],r=(Array.isArray(e)?e:[e]).map(ml);t?.errorMap&&n._updateErrorMap(t.errorMap),n._initializeWithPersistence(r,t?.popupRedirectResolver)}(g,e),g})(r,s)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,r)=>{t.getProvider("auth-internal").initialize()})),Ji(new Pi("auth-internal",t=>{const e=Fo(t.getProvider("auth").getImmediate());return new CTe(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),ns(cee,"0.20.11",function yTe(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(n)),ns(cee,"0.20.11","esm2017")}("Browser");class xM{constructor(t){return t}}class hee{constructor(){return wk("auth")}}const GD=new It("angularfire2.auth-instances");function bTe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new xM(r)}}const NTe={provide:hee,deps:[[new Ks,GD]]},ATe={provide:xM,useFactory:function wTe(n,t){const e=Tk("auth",n,t);return e&&new xM(e)},deps:[[new Ks,GD],Ef]};let OTe=(()=>{class n{constructor(){ns("angularfire",uM.full,"auth")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=qs({type:n}),n.\u0275inj=Fr({providers:[ATe,NTe]}),n})();const LTe=yr(RSe,!0),kTe=yr(TTe,!0),RTe=yr(ZSe,!0),DTe=yr(VSe,!0),zTe=yr(LSe,!0),VTe=yr(DSe,!0),HTe=yr(RPe,!0),FTe=yr(FSe,!0);class c0{constructor(t){return t}}const WD=new It("angularfire2.firestore-instances");function UTe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new c0(r)}}const GTe={provide:class BTe{constructor(){return wk("firestore")}},deps:[[new Ks,WD]]},WTe={provide:c0,useFactory:function $Te(n,t){const e=Tk("firestore",n,t);return e&&new c0(e)},deps:[[new Ks,WD],Ef]};let qTe=(()=>{class n{constructor(){ns("angularfire",uM.full,"fst")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=qs({type:n}),n.\u0275inj=Fr({providers:[WTe,GTe]}),n})();const ZTe=yr(qve,!0),YTe=yr(cve,!0),XTe=yr(Wve,!0),wg=yr(fX,!0),QTe=yr(Bve,!0),JTe=yr($ve,!0),ewe=yr(Pve,!0),twe=yr(Vve,!0),pee=yr(jve,!0),nwe=yr(zve,!0),LM=yr(Lve,!0),rwe=yr(Uve,!0),swe=yr(Gve,!0),iwe=yr(Rve,!0);let bg=(()=>{class n{constructor(e,r){this.collectionName=e,this.firestore=r,this.subDAOs={};this.collection=YTe(r,this.collectionName).withConverter({fromFirestore:i=>i.data(),toFirestore:i=>i})}create(e){var r=this;return O(function*(){return Y(n.VERBOSE,{called:r.collectionName+".create",newElement:e}),(yield ZTe(r.collection,e)).id})()}read(e){var r=this;return O(function*(){Y(n.VERBOSE,{called:r.collectionName+".read",id:e});const s=yield QTe(wg(r.collection,e));return s.exists()?S.of(Ae.getNonNullable(s.data())):S.empty()})()}exists(e){var r=this;return O(function*(){return Y(n.VERBOSE,{called:r.collectionName+".exists",id:e}),(yield r.read(e)).isPresent()})()}update(e,r){var s=this;return O(function*(){return Y(n.VERBOSE,{called:s.collectionName+".update",id:e,update:r}),swe(wg(s.collection,e),r)})()}delete(e){return Y(n.VERBOSE,{called:this.collectionName+".delete",id:e}),XTe(wg(this.collection,e))}set(e,r){return Y(n.VERBOSE,{called:this.collectionName+".set",id:e,element:r}),rwe(wg(this.collection,e),r)}subscribeToChanges(e,r){return new H1(pee(wg(this.collection,e),s=>{r(S.ofNullable(s.data()))}))}findWhere(e,r,s){var i=this;return O(function*(){const o=i.constructQuery(e,r,s);return(yield JTe(o)).docs.map(u=>({id:u.id,data:u.data()}))})()}observingWhere(e,r,s){Y(n.VERBOSE,{called:this.collectionName+".observingWhere"});const i=this.constructQuery(e,s);return new H1(pee(i,o=>{const c=[],u=[],h=[];o.docChanges().forEach(g=>{const m={id:g.doc.id,data:g.doc.data()};switch(g.type){case"added":c.push(m);break;case"modified":u.push(m);break;case"removed":h.push(m)}}),c.length>0&&(Y(n.VERBOSE,"firebase gave us "+c.length+" NEW "+this.collectionName),r.onDocumentCreated(c)),u.length>0&&(Y(n.VERBOSE,"firebase gave us "+u.length+" MODIFIED "+this.collectionName),r.onDocumentModified(u)),h.length>0&&(Y(n.VERBOSE,"firebase gave us "+h.length+" DELETED "+this.collectionName),r.onDocumentDeleted(h))}))}constructQuery(e,r,s){let i=LM(this.collection);null!=r&&(i=LM(i,nwe(r))),null!=s&&(i=LM(i,twe(s)));for(const o of e)i=LM(i,iwe(o[0],o[1],o[2]));return i}subCollectionDAO(e,r){const s=`${this.collection.path}/${e}/${r}`;if(s in this.subDAOs)return this.subDAOs[s];{const i=new class extends n{constructor(o){super(s,o)}}(this.firestore);return this.subDAOs[s]=i,i}}}return n.VERBOSE=!1,n})(),owe=(()=>{class n extends bg{constructor(e){super("errors",e)}}return n.\u0275fac=function(e){return new(e||n)(xe(c0))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var awe=Na(2486);let In=(()=>{class n{infoMessage(e){this.message(e,"is-info")}gameMessage(e){this.message(e,"is-warning")}criticalMessage(e){this.message(e,"is-danger")}message(e,r){(0,awe.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:r,dismissible:!0})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class ys{constructor(t,e,r){this.errorDAO=t,this.router=e,this.messageDisplayer=r,ys.setSingletonInstance(this)}static setSingletonInstance(t){ys.singleton=S.of(t)}static logErrorAndFail(t,e,r){throw ys.logError(t,e,r),new Error(`${t}: ${e} (extra data: ${JSON.stringify(r)})`)}static logError(t,e,r){if(this.singleton.isAbsent())throw new Error(`${t}: ${e} (extra data: ${JSON.stringify(r)})`);return this.singleton.get().logError(t,e,r),G.failure(t+": "+e)}findErrors(t,e,r,s){return this.errorDAO.findWhere(void 0===s?[["component","==",t],["route","==",e],["message","==",r]]:[["component","==",t],["route","==",e],["message","==",r],["data","==",s]])}logError(t,e,r){var s=this;return O(function*(){s.messageDisplayer.criticalMessage($localize`An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible.`);const i=s.router.url,o=yield s.findErrors(t,i,e,r);if(0===o.length){const c={component:t,route:i,message:e,firstEncounter:s0(),lastEncounter:s0(),occurences:1};null!=r&&(c.data=r),yield s.errorDAO.create(c)}else{const c=o[0].id,u=o[0].data;yield s.errorDAO.update(c,{lastEncounter:s0(),occurences:u.occurences+1})}})()}}ys.singleton=S.empty(),ys.\u0275fac=function(t){return new(t||ys)(xe(owe),xe($n),xe(In))},ys.\u0275prov=Xe({token:ys,factory:ys.\u0275fac,providedIn:"root"});class Ae{static expectToBe(t,e,r){if(t!==e)throw void 0!==r?new Error(r):new Error(`A default switch case did not observe the correct value, expected ${e}, but got ${t} instead.`)}static expectToBeMultiple(t,e){let r=!1;for(const s of e)if(t===s){r=!0;break}if(!1===r)throw new Error(`A default switch case did not observe the correct value, expected a value among ${e}, but got ${t} instead.`)}static getNonNullable(t){if(null==t)throw new Error("Expected value not to be null or undefined, but it was.");return t}static assert(t,e){if(!1===t)throw ys.logError("Assertion failure",e),new Error(`Assertion failure: ${e}`)}}function Y(n,t){n&&console.log(t)}let lwe=(()=>{class n extends bg{constructor(e){super("chats",e),Y(n.VERBOSE,"ChatDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(xe(c0))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),gee=(()=>{class n{}return n.CANNOT_SEND_MESSAGE=()=>$localize`You're not allowed to send a message here.`,n.FORBIDDEN_MESSAGE=()=>$localize`This message is forbidden.`,n})(),kM=(()=>{class n{constructor(e){this.chatDAO=e,Y(n.VERBOSE,"ChatService.constructor")}addMessage(e,r){var s=this;return O(function*(){return s.chatDAO.subCollectionDAO(e,"messages").create(r)})()}getLastMessages(e,r){var s=this;return O(function*(){return s.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",r)})()}subscribeToMessages(e,r){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],r,"postedTime")}deleteChat(e){var r=this;return O(function*(){return Y(n.VERBOSE,"ChatService.deleteChat "+e),r.chatDAO.delete(e)})()}createNewChat(e){var r=this;return O(function*(){return r.chatDAO.set(e,{})})()}sendMessage(e,r,s,i){var o=this;return O(function*(){if(!1===o.userCanSendMessage(r.name,e))return G.failure(gee.CANNOT_SEND_MESSAGE());if(o.isForbiddenMessage(s))return G.failure(gee.FORBIDDEN_MESSAGE());const c={content:s,sender:r,postedTime:s0(),currentTurn:i};return yield o.addMessage(e,c),G.SUCCESS})()}userCanSendMessage(e,r){return""!==e}isForbiddenMessage(e){return""===e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(xe(lwe))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Se(n,t){if(!1===n)throw ys.logError("Assertion failure",t),new Error(`Assertion failure: ${t}`)}let RM=(()=>{class n extends bg{constructor(e){super(n.COLLECTION_NAME,e),Y(n.VERBOSE,"UserDAO.constructor")}}return n.VERBOSE=!1,n.COLLECTION_NAME="users",n.\u0275fac=function(e){return new(e||n)(xe(c0))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Ng=(()=>{class n{constructor(e){this.userDAO=e}usernameIsAvailable(e){var r=this;return O(function*(){return 0===(yield r.userDAO.findWhere([["username","==",e]])).length})()}setUsername(e,r){var s=this;return O(function*(){yield s.userDAO.update(e,{username:r})})()}markAsVerified(e){var r=this;return O(function*(){yield r.userDAO.update(e,{verified:!0})})()}observeUser(e,r){return this.userDAO.subscribeToChanges(e,r)}getUserLastUpdateTime(e){var r=this;return O(function*(){const s=yield r.userDAO.read(e);if(s.isAbsent())return S.empty();{const i=s.get().lastUpdateTime;return Se(null!=i,"should not receive a lastUpdateTime equal to null"),S.of(i)}})()}updatePresenceToken(e){return this.userDAO.update(e,{lastUpdateTime:s0()})}}return n.\u0275fac=function(e){return new(e||n)(xe(RM))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class mee extends pi{constructor(t=1/0,e=1/0,r=_k){super(),this._bufferSize=t,this._windowTime=e,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,e)}next(t){const{isStopped:e,_buffer:r,_infiniteTimeWindow:s,_timestampProvider:i,_windowTime:o}=this;e||(r.push(t),!s&&r.push(i.now()+o)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(t),{_infiniteTimeWindow:r,_buffer:s}=this,i=s.slice();for(let o=0;o<i.length&&!t.closed;o+=r?1:2)t.next(i[o]);return this._checkFinalizedStatuses(t),e}_trimBuffer(){const{_bufferSize:t,_timestampProvider:e,_buffer:r,_infiniteTimeWindow:s}=this,i=(s?1:2)*t;if(t<1/0&&i<r.length&&r.splice(0,r.length-i),!s){const o=e.now();let c=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)c=u;c&&r.splice(0,c+1)}}}let Ag=(()=>{class n{}return n.YOU_ARE_ALREADY_PLAYING=()=>$localize`You are already playing in another game.`,n.YOU_ARE_ALREADY_CREATING=()=>$localize`You are already the creator of another game.`,n.YOU_ARE_ALREADY_CHOSEN_OPPONENT=()=>$localize`You are already the chosen opponent in another game.`,n.YOU_ARE_ALREADY_CANDIDATE=()=>$localize`You are already candidate in another game.`,n.YOU_ARE_ALREADY_OBSERVING=()=>$localize`You are already observing another game.`,n})();class l0{static createUserWithEmailAndPassword(t,e,r){return LTe(t,e,r)}static sendEmailVerification(t){return DTe(t)}static sendPasswordResetEmail(t,e){return zTe(t,e)}static signInWithEmailAndPassword(t,e,r){return O(function*(){return(yield VTe(t,e,r)).user})()}static signInWithPopup(t,e){return O(function*(){return(yield HTe(t,e)).user})()}static updateProfile(t,e){return FTe(t,e)}}class A8{constructor(t,e,r,s){this.id=t,this.email=e,this.username=r,this.verified=s}isConnected(){return this.email.isPresent()}toMinimalUser(){return{id:this.id,name:this.username.get()}}equals(t){return this.id===t.id&&this.email.equals(t.email)&&this.username.equals(t.username)&&this.verified===t.verified}}A8.NOT_CONNECTED=new A8("",S.empty(),S.empty(),!1);let Es=(()=>{class n{constructor(e,r,s){var i=this;this.userDAO=e,this.userService=r,this.auth=s,this.user=S.empty(),this.userSubscription=new H1,Y(n.VERBOSE,"ConnectedUserService constructor"),this.userRS=new mee(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new H1(RTe(this.auth,function(){var o=O(function*(c){null==c?(Y(n.VERBOSE,"User is not connected"),i.userSubscription.unsubscribe(),i.userRS.next(A8.NOT_CONNECTED),i.user=S.empty()):(Se(i.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),i.userSubscription=i.userDAO.subscribeToChanges(c.uid,u=>{if(u.isPresent()){const h=u.get(),g=h.username;Y(n.VERBOSE,`User ${g} is connected, and the verified status is ${i.emailVerified(c)}`);const m=!0===i.emailVerified(c)&&null!=g;if(!0===m&&!1===h.verified)return i.userService.markAsVerified(c.uid);const v=new A8(c.uid,S.ofNullable(c.email),S.ofNullable(g),m);!1===i.user.equalsValue(v)&&(i.user=S.of(v),i.userRS.next(v))}}))});return function(c){return o.apply(this,arguments)}}()))}emailVerified(e){return e.emailVerified}sendPasswordResetEmail(e){var r=this;return O(function*(){try{return yield l0.sendPasswordResetEmail(r.auth,e),G.SUCCESS}catch(s){return G.failure(r.mapFirebaseError(s))}})()}doRegister(e,r,s){var i=this;return O(function*(){return Y(n.VERBOSE,"ConnectedUserService.doRegister("+r+")"),(yield i.userService.usernameIsAvailable(e))?i.registerAfterUsernameCheck(e,r,s):K.failure($localize`This username is already in use.`)})()}registerAfterUsernameCheck(e,r,s){var i=this;return O(function*(){try{const o=yield l0.createUserWithEmailAndPassword(i.auth,r,s);yield l0.signInWithEmailAndPassword(i.auth,r,s);const c=Ae.getNonNullable(o.user);return yield i.createUser(c.uid,e),K.success(c)}catch(o){return K.failure(i.mapFirebaseError(o))}})()}mapFirebaseError(e){switch(e.code){case"auth/email-already-in-use":return $localize`This email address is already in use.`;case"auth/invalid-email":return $localize`This email address is invalid.`;case"auth/user-not-found":case"auth/wrong-password":return $localize`You have entered invalid credentials.`;case"auth/invalid-credential":return $localize`The credential is invalid or has expired, please try again.`;case"auth/weak-password":return $localize`Your password is too weak, please use a stronger password.`;case"auth/too-many-requests":return $localize`There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later.`;case"auth/popup-closed-by-user":return $localize`You closed the authentication popup without finalizing your log in.`;case"auth/popup-blocked":return $localize`The authentication popup was blocked. Try again after disabling popup blocking.`;default:return ys.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}sendEmailVerification(){var e=this;return O(function*(){Y(n.VERBOSE,"ConnectedUserService.sendEmailVerification()");const r=S.ofNullable(e.auth.currentUser);if(!r.isPresent())return ys.logError("ConnectedUserService","Unlogged users cannot request for email verification");if(e.emailVerified(r.get()))return ys.logError("ConnectedUserService","Verified users should not ask email verification after being verified");try{return yield l0.sendEmailVerification(r.get()),G.SUCCESS}catch(s){return G.failure(e.mapFirebaseError(s))}})()}doEmailLogin(e,r){var s=this;return O(function*(){Y(n.VERBOSE,"ConnectedUserService.doEmailLogin("+e+")");try{return yield l0.signInWithEmailAndPassword(s.auth,e,r),G.SUCCESS}catch(i){return G.failure(s.mapFirebaseError(i))}})()}createUser(e,r){var s=this;return O(function*(){null==r?yield s.userDAO.set(e,{verified:!1}):yield s.userDAO.set(e,{username:r,verified:!1})})()}doGoogleLogin(){var e=this;return O(function*(){return G.ofFallible(yield e.registerOrLoginWithGoogle())})()}registerOrLoginWithGoogle(){var e=this;return O(function*(){try{const r=new bSe;r.addScope("profile"),r.addScope("email");const s=yield l0.signInWithPopup(e.auth,r);return!1===(yield e.userDAO.exists(s.uid))&&(yield e.createUser(s.uid)),K.success(s)}catch(r){return K.failure(e.mapFirebaseError(r))}})()}disconnect(){var e=this;return O(function*(){return S.ofNullable(e.auth.currentUser).isPresent()?(yield e.auth.signOut(),G.SUCCESS):G.failure("Cannot disconnect a non-connected user")})()}subscribeToUser(e){return this.userObs.subscribe(e)}setUsername(e){var r=this;return O(function*(){if(""===e)return G.failure($localize`Your username may not be empty.`);try{if(!1===(yield r.userService.usernameIsAvailable(e)))return G.failure($localize`This username is already in use, please select a different one.`);const i=Ae.getNonNullable(r.auth.currentUser);return yield l0.updateProfile(i,{displayName:e}),yield r.userService.setUsername(i.uid,e),yield r.userService.markAsVerified(i.uid),yield r.reloadUser(),G.SUCCESS}catch(s){return G.failure(r.mapFirebaseError(s))}})()}setPicture(e){var r=this;return O(function*(){try{const s=Ae.getNonNullable(r.auth.currentUser);return yield l0.updateProfile(s,{photoURL:e}),G.SUCCESS}catch(s){return G.failure(r.mapFirebaseError(s))}})()}reloadUser(){var e=this;return O(function*(){const r=Ae.getNonNullable(e.auth.currentUser);yield r.getIdToken(!0),yield r.reload()})()}sendPresenceToken(){return Se(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(xe(RM),xe(Ng),xe(xM))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Nn{constructor(t){this.value=t}}Nn.HARD_DRAW=new Nn(0),Nn.RESIGN=new Nn(1),Nn.ESCAPE=new Nn(2),Nn.VICTORY=new Nn(3),Nn.TIMEOUT=new Nn(4),Nn.UNACHIEVED=new Nn(5),Nn.AGREED_DRAW_BY_ZERO=new Nn(6),Nn.AGREED_DRAW_BY_ONE=new Nn(7);class DM{constructor(t,e){this.id=t,this.data=e}getTurn(){return this.data.turn}isHardDraw(){return this.data.result===Nn.HARD_DRAW.value}isAgreedDraw(){return this.data.result===Nn.AGREED_DRAW_BY_ZERO.value||this.data.result===Nn.AGREED_DRAW_BY_ONE.value}getDrawAccepter(){return this.data.result===Nn.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(Se(this.data.result===Nn.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),Ae.getNonNullable(this.data.playerOne))}isWin(){return this.data.result===Nn.VICTORY.value}isTimeout(){return this.data.result===Nn.TIMEOUT.value}isResign(){return this.data.result===Nn.RESIGN.value}getWinner(){return S.ofNullable(this.data.winner)}getLoser(){return S.ofNullable(this.data.loser)}setWinnerAndLoser(t,e){return new DM(this.id,{...this.data,winner:t,loser:e})}}class Ds{constructor(t){this.value=t}static of(t){switch(t){case"CREATOR":return Ds.CREATOR;case"RANDOM":return Ds.RANDOM;default:return Se("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),Ds.CHOSEN_PLAYER}}}Ds.CREATOR=new Ds("CREATOR"),Ds.RANDOM=new Ds("RANDOM"),Ds.CHOSEN_PLAYER=new Ds("CHOSEN_PLAYER");class Er{constructor(t){this.value=t}static of(t){switch(t){case"STANDARD":return Er.STANDARD;case"BLITZ":return Er.BLITZ;case"CUSTOM":return Er.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}Er.STANDARD=new Er("STANDARD"),Er.BLITZ=new Er("BLITZ"),Er.CUSTOM=new Er("CUSTOM"),Er.NORMAL_MOVE_DURATION=120,Er.NORMAL_PART_DURATION=1800,Er.BLITZ_MOVE_DURATION=30,Er.BLITZ_PART_DURATION=900;class zs{constructor(t){this.value=t}}zs.PART_CREATED=new zs(0),zs.CONFIG_PROPOSED=new zs(2),zs.PART_STARTED=new zs(3),zs.PART_FINISHED=new zs(4);class u0{}class e4 extends u0{static disjunction3(t,e,r,s,i){return new class extends e4{encodeMove(o){return s(o)?{type:"T1",encoded:t.encode(o)}:i(o)?{type:"T2",encoded:e.encode(o)}:{type:"T3",encoded:r.encode(o)}}decodeMove(o){const c=Ae.getNonNullable(o).type,u=Ae.getNonNullable(o).encoded;return"T1"===c?t.decode(u):"T2"===c?e.decode(u):r.decode(u)}}}encode(t){return this.encodeMove(t)}decode(t){return Se(!1===Array.isArray(t),"MoveEncoder.decode called with an array"),this.decodeMove(t)}}class on extends e4{static ofN(t,e,r){return new class extends on{maxValue(){return t}encodeNumber(s){return e(s)}decodeNumber(s){return r(s)}}}static tuple(t,e,r){return new class extends on{maxValue(){let s=0;return Object.keys(t).forEach(i=>{s=s*t[i].shift()+t[i].maxValue()}),s}encodeNumber(s){const i=e(s);let o=0;return Object.keys(i).forEach(c=>{o=o*t[c].shift()+t[c].encode(i[c])}),o}decodeNumber(s){const i={};let o=s;return Object.keys(t).reverse().forEach(c=>{const u=o%t[c].shift();o=(o-u)/t[c].shift(),i[c]=t[c].decode(u)}),r(i)}}}static disjunction(t,e,r){return new class extends on{maxValue(){return Math.max(2*t.maxValue(),2*e.maxValue()+1)}encodeNumber(s){return r(s)?2*t.encodeNumber(s):2*e.encodeNumber(s)+1}decodeNumber(s){return s%2==0?t.decodeNumber(s/2):e.decodeNumber((s-1)/2)}}}static numberEncoder(t){return new class extends on{maxValue(){return t}encodeNumber(e){if(e>t)throw new Error("Cannot encode number bigger than the max with numberEncoder");return e}decodeNumber(e){if(e>t)throw new Error("Cannot decode number bigger than the max with numberEncoder");return e}}}shift(){return this.maxValue()+1}encodeMove(t){return this.encodeNumber(t)}decodeMove(t){return Se("number"==typeof t,"Invalid encoded number"),this.decodeNumber(t)}}on.booleanEncoder=new class extends on{maxValue(){return 1}encodeNumber(n){return n?1:0}decodeNumber(n){if(0===n)return!1;if(1===n)return!0;throw new Error("Invalid encoded boolean")}};class qD{constructor(){this.value=2}isPlayer(){return!1}toString(){return"PLAYER_NONE"}equals(t){return this===t}}qD.NONE=new qD;class F{constructor(t){this.value=t}static of(t){return 0===t?F.ZERO:(Ae.expectToBe(t,1),F.ONE)}static fromTurn(t){return t%2==0?F.ZERO:F.ONE}isPlayer(){return!0}toString(){return this===F.ZERO?"PLAYER_ZERO":(Ae.expectToBe(this,F.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}equals(t){return this===t}getScoreModifier(){return 0===this.value?-1:1}getPreVictory(){return this.getVictoryValue()-this.getScoreModifier()}getDefeatValue(){return this===F.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}getVictoryValue(){return this===F.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}getOpponent(){return this===F.ZERO?F.ONE:(Ae.expectToBe(this,F.ONE),F.ZERO)}}var fe;F.numberEncoder=on.ofN(2,n=>n.value,n=>2===n?fe.NONE:F.of(n)),F.ZERO=new F(0),F.ONE=new F(1),F.PLAYERS=[F.ZERO,F.ONE],function(n){n.ZERO=F.ZERO,n.ONE=F.ONE,n.NONE=qD.NONE}(fe||(fe={}));class Rr{static rematchAccepted(t,e){return _ee("RematchAccepted",{typeGame:t,partId:e})}static getPlayer(t){return F.of(Ae.getNonNullable(t.data).player)}static getTypeGame(t){return Ae.getNonNullable(t.data).typeGame}static getPartId(t){return Ae.getNonNullable(t.data).partId}}function _ee(n,t){return{code:n,data:t}}function f0(n){return t=>_ee(n,{player:t.value})}Rr.drawProposed=f0("DrawProposed"),Rr.drawRefused=f0("DrawRefused"),Rr.takeBackAsked=f0("TakeBackAsked"),Rr.takeBackRefused=f0("TakeBackRefused"),Rr.takeBackAccepted=f0("TakeBackAccepted"),Rr.rematchProposed=f0("RematchProposed"),Rr.addTurnTime=f0("AddTurnTime"),Rr.addGlobalTime=f0("AddGlobalTime");class ht{static mapBiArray(t,e){const r=[];let s=0;for(;s<t.length;){r[s]=[];let i=0;for(;i<t[s].length;)r[s][i]=e(t[s][i]),i++;s++}return r}static createTable(t,e,r){const s=[];let i=e-1;for(;i>=0;){s[i]=[];let o=t-1;for(;o>=0;)s[i][o]=r,o--;i--}return s}static copyBiArray(t){const e=[];let r=0;for(;r<t.length;)e[r]=ht.copyImmutableArray(t[r]),r++;return e}static copyImmutableArray(t){const e=[];let r=0;for(;r<t.length;)e[r]=t[r],r++;return e}static sortByDescending(t,e){t.sort((r,s)=>{const i=e(r),o=e(s);return i<o?1:i>o?-1:0})}static compareArray(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!1===jc(t[r],e[r]))return!1;return!0}static compareTable(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!1===ht.compareArray(t[r],e[r]))return!1;return!0}}let vee=(()=>{class n extends bg{constructor(e){super("parts",e),Y(n.VERBOSE,"PartDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(xe(c0))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class zM{constructor(t,e,r){this.onDocumentCreated=t,this.onDocumentModified=e,this.onDocumentDeleted=r}}let uwe=(()=>{class n extends bg{constructor(e){super("config-room",e),Y(n.VERBOSE,"ConfigRoomDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(xe(c0))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),jD=(()=>{class n{constructor(e,r){this.configRoomDAO=e,this.connectedUserService=r,Y(n.VERBOSE,"ConfigRoomService.constructor")}addCandidate(e,r){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(r.id,r)}removeCandidate(e,r){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(r.id)}subscribeToChanges(e,r){return this.configRoomDAO.subscribeToChanges(e,r)}subscribeToCandidates(e,r){let s=[];const i=new zM(c=>{for(const u of c)s.push(u.data);r(s)},c=>{for(const u of c)s=s.map(h=>h.id===u.data.id?u.data:h);r(s)},c=>{for(const u of c)s=s.filter(h=>h.id!==u.data.id);r(s)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],i)}createInitialConfigRoom(e){var r=this;return O(function*(){Y(n.VERBOSE,"ConfigRoomService.createInitialConfigRoom("+e+")");const s=r.connectedUserService.user.get().toMinimalUser();return r.configRoomDAO.set(e,{chosenOpponent:null,firstPlayer:Ds.RANDOM.value,partType:Er.STANDARD.value,partStatus:zs.PART_CREATED.value,maximalMoveDuration:Er.NORMAL_MOVE_DURATION,totalPartDuration:Er.NORMAL_PART_DURATION,creator:s})})()}joinGame(e){var r=this;return O(function*(){Y(n.VERBOSE,"ConfigRoomService.joinGame("+e+")");const s=r.connectedUserService.user.get().toMinimalUser(),i=yield r.configRoomDAO.read(e);return i.isAbsent()?G.failure(n.GAME_DOES_NOT_EXIST()):(i.get().creator.id!==s.id&&(yield r.addCandidate(e,s)),G.SUCCESS)})()}cancelJoining(e){var r=this;return O(function*(){Y(n.VERBOSE,`ConfigRoomService.cancelJoining(${e})`);const s=r.connectedUserService.user.get().toMinimalUser(),i=yield r.configRoomDAO.read(e);if(!i.isAbsent()){const o=i.get(),c=[r.removeCandidate(e,s)];o.chosenOpponent?.id===s.id&&c.push(r.configRoomDAO.update(e,{chosenOpponent:null,partStatus:zs.PART_CREATED.value})),yield Promise.all(c)}})()}deleteConfigRoom(e,r){var s=this;return O(function*(){Y(n.VERBOSE,`ConfigRoomService.deleteConfigRoom(${e}`),yield Promise.all(r.map(i=>s.removeCandidate(e,i))),yield s.configRoomDAO.delete(e)})()}proposeConfig(e,r,s,i,o,c){var u=this;return O(function*(){return Y(n.VERBOSE,{configRoomService_proposeConfig:{configRoomId:e,maximalMoveDuration:i,firstPlayer:o,totalPartDuration:c}}),u.configRoomDAO.update(e,{partStatus:zs.CONFIG_PROPOSED.value,chosenOpponent:r,partType:s.value,maximalMoveDuration:i,totalPartDuration:c,firstPlayer:o.value})})()}setChosenOpponent(e,r){return Y(n.VERBOSE,`ConfigRoomService.setChosenOpponent(${e}, ${r.name})`),this.configRoomDAO.update(e,{chosenOpponent:r})}reviewConfig(e){var r=this;return O(function*(){return Y(n.VERBOSE,`ConfigRoomService.reviewConfig(${e})`),r.configRoomDAO.update(e,{partStatus:zs.PART_CREATED.value})})()}reviewConfigAndRemoveChosenOpponent(e){var r=this;return O(function*(){return Y(n.VERBOSE,`ConfigRoomService.reviewConfigAndRemoveChosenOpponent(${e})`),r.configRoomDAO.update(e,{partStatus:zs.PART_CREATED.value,chosenOpponent:null})})()}acceptConfig(e){return Y(n.VERBOSE,`ConfigRoomService.acceptConfig(${e}`),this.configRoomDAO.update(e,{partStatus:zs.PART_STARTED.value})}createConfigRoom(e,r){var s=this;return O(function*(){return Y(n.VERBOSE,`ConfigRoomService.create(${e}`+JSON.stringify(r)+")"),s.configRoomDAO.set(e,r)})()}readConfigRoomById(e){var r=this;return O(function*(){return Y(n.VERBOSE,`ConfigRoomService.readConfigRoomById(${e})`),(yield r.configRoomDAO.read(e)).get()})()}}return n.VERBOSE=!1,n.GAME_DOES_NOT_EXIST=()=>$localize`Game does not exist`,n.\u0275fac=function(e){return new(e||n)(xe(uwe),xe(Es))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),VM=(()=>{class n{constructor(e,r,s,i){this.partDAO=e,this.connectedUserService=r,this.configRoomService=s,this.chatService=i,Y(n.VERBOSE,"GameService.constructor")}updateAndBumpIndex(e,r,s,i){var o=this;return O(function*(){return i={...i,lastUpdate:{index:s+1,player:r.value}},o.partDAO.update(e,i)})()}getPartValidity(e,r){var s=this;return O(function*(){const i=yield s.partDAO.read(e);return i.isAbsent()?G.failure("NONEXISTENT_PART"):i.get().typeGame===r?G.SUCCESS:G.failure("WRONG_GAME_TYPE")})()}createUnstartedPart(e){Y(n.VERBOSE,"GameService.createPart("+e+")");const r=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({lastUpdate:{index:0,player:0},typeGame:e,playerZero:r,turn:-1,result:Nn.UNACHIEVED.value,listMoves:[]})}createChat(e){return Y(n.VERBOSE,"GameService.createChat("+e+")"),this.chatService.createNewChat(e)}createPartConfigRoomAndChat(e){var r=this;return O(function*(){Y(n.VERBOSE,`GameService.createGame(${e})`);const s=yield r.createUnstartedPart(e);return yield r.configRoomService.createInitialConfigRoom(s),yield r.createChat(s),s})()}startGameWithConfig(e,r,s,i){Y(n.VERBOSE,"GameService.startGameWithConfig("+e+", "+JSON.stringify(i));const o=this.getStartingConfig(i);return this.updateAndBumpIndex(e,r,s,o)}getStartingConfig(e){let s,i,r=Ds.of(e.firstPlayer);return r===Ds.RANDOM&&(r=Math.random()<.5?Ds.CREATOR:Ds.CHOSEN_PLAYER),r===Ds.CREATOR?(s=e.creator,i=Ae.getNonNullable(e.chosenOpponent)):(s=Ae.getNonNullable(e.chosenOpponent),i=e.creator),{playerZero:s,playerOne:i,turn:0,beginning:s0(),remainingMsForZero:1e3*e.totalPartDuration,remainingMsForOne:1e3*e.totalPartDuration}}deletePart(e){return Y(n.VERBOSE,"GameService.deletePart("+e+")"),this.partDAO.delete(e)}acceptConfig(e,r){var s=this;return O(function*(){return Y(n.VERBOSE,{gameService_acceptConfig:{partId:e,configRoom:r}}),yield s.configRoomService.acceptConfig(e),s.startGameWithConfig(e,F.ONE,0,r)})()}subscribeToChanges(e,r){return this.partDAO.subscribeToChanges(e,r)}resign(e,r,s,i,o){return this.updateAndBumpIndex(e,s,r,{winner:i,loser:o,result:Nn.RESIGN.value,request:null})}notifyTimeout(e,r,s,i,o){return this.updateAndBumpIndex(e,r,s,{winner:i,loser:o,result:Nn.TIMEOUT.value,request:null})}sendRequest(e,r,s,i){return this.updateAndBumpIndex(e,r,s,{request:i})}proposeDraw(e,r,s){return this.sendRequest(e,s,r,Rr.drawProposed(s))}acceptDraw(e,r,s){return this.updateAndBumpIndex(e,s,r,{result:(s===F.ZERO?Nn.AGREED_DRAW_BY_ZERO:Nn.AGREED_DRAW_BY_ONE).value,request:null})}refuseDraw(e,r,s){return this.sendRequest(e,s,r,Rr.drawRefused(s))}proposeRematch(e,r,s){return this.sendRequest(e,s,r,Rr.rematchProposed(s))}acceptRematch(e,r,s){var i=this;return O(function*(){Y(n.VERBOSE,{called:"GameService.acceptRematch(",partDocument:e});const o=Ae.getNonNullable(e.data),c=yield i.configRoomService.readConfigRoomById(e.id);let u;const h=i.connectedUserService.user.get().toMinimalUser();let g;o.playerZero.id===h.id?(g=Ae.getNonNullable(o.playerOne),u=Ds.CHOSEN_PLAYER):(g=o.playerZero,u=Ds.CREATOR);const m={...c,firstPlayer:u.value,creator:h,chosenOpponent:g,partStatus:zs.PART_STARTED.value},v=i.getStartingConfig(m),T={lastUpdate:{index:0,player:s.value},typeGame:o.typeGame,result:Nn.UNACHIEVED.value,listMoves:[],...v},I=yield i.partDAO.create(T);return yield i.configRoomService.createConfigRoom(I,m),yield i.createChat(I),i.sendRequest(e.id,s,r,Rr.rematchAccepted(o.typeGame,I))})()}askTakeBack(e,r,s){return this.sendRequest(e,s,r,Rr.takeBackAsked(s))}acceptTakeBack(e,r,s,i){var o=this;return O(function*(){Se(Rr.getPlayer(Ae.getNonNullable(r.data.request))!==s,"Illegal to accept your own request");const u=Rr.takeBackAccepted(s);let h=r.data.listMoves.slice(0,r.data.listMoves.length-1);h.length%2===s.value&&(h=h.slice(0,h.length-1));const g={request:u,listMoves:h,turn:h.length,lastUpdateTime:s0(),remainingMsForZero:Ae.getNonNullable(r.data.remainingMsForZero)-i[0],remainingMsForOne:Ae.getNonNullable(r.data.remainingMsForOne)-i[1]},m=r.data.lastUpdate.index;return yield o.updateAndBumpIndex(e,s,m,g)})()}refuseTakeBack(e,r,s){const i=Rr.takeBackRefused(s);return this.updateAndBumpIndex(e,s,r,{request:i})}addGlobalTime(e,r,s,i){var o=this;return O(function*(){let c={request:Rr.addGlobalTime(i.getOpponent())};return c=i===F.ZERO?{...c,remainingMsForOne:Ae.getNonNullable(s.remainingMsForOne)+3e5}:{...c,remainingMsForZero:Ae.getNonNullable(s.remainingMsForZero)+3e5},yield o.updateAndBumpIndex(e,i,r,c)})()}addTurnTime(e,r,s){var i=this;return O(function*(){const o={request:Rr.addTurnTime(e.getOpponent())};return yield i.updateAndBumpIndex(s,e,r,o)})()}updateDBBoard(e,r,s,i,o,c,u,h){var g=this;return O(function*(){Y(n.VERBOSE,{gameService_updateDBBoard:{partId:e,encodedMove:s,scores:o,msToSubstract:i,notifyDraw:c,winner:u,loser:h}});const m=(yield g.partDAO.read(e)).get(),v=m.lastUpdate.index,T=m.turn+1,I=ht.copyImmutableArray(m.listMoves);I[I.length]=s;let z={listMoves:I,turn:T,request:null,lastUpdateTime:s0()};return z=g.updateScore(z,o),z=g.substractMs(z,m,i),null!=u?z={...z,winner:u,loser:h,result:Nn.VICTORY.value}:!0===c&&(z={...z,result:Nn.HARD_DRAW.value}),yield g.updateAndBumpIndex(e,r,v,z)})()}updateScore(e,r){return void 0!==r?{...e,scorePlayerZero:r[0],scorePlayerOne:r[1]}:e}substractMs(e,r,s){return s[0]>0?{...e,remainingMsForZero:Ae.getNonNullable(r.remainingMsForZero)-s[0]}:s[1]>0?{...e,remainingMsForOne:Ae.getNonNullable(r.remainingMsForOne)-s[1]}:e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(xe(vee),xe(Es),xe(jD),xe(kM))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var $ee={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},Zee={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},Yee={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]};class Og{static getNavigatorLanguage(){return navigator.language}static getLocale(){const r=(localStorage.getItem("locale")??Og.getNavigatorLanguage()??"fr").slice(0,2).toLowerCase();return["en","fr"].some(s=>s===r)?r:"fr"}}let ete=(()=>{class n{changeTheme(e){localStorage.setItem("theme",e)}getTheme(){return S.ofNullable(localStorage.getItem("theme"))}changeLanguage(e){localStorage.setItem("locale",e.toLowerCase())}getLanguage(){return Og.getLocale()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),HM=(()=>{class n{constructor(e,r){this.document=e,this.userSettingsService=r,this.availableThemes=["dark","light"];const s=this.getStoredTheme();s.isPresent()?this.loadTheme(s.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}getStoredTheme(){const e=this.userSettingsService.getTheme();if(e.isPresent()){const r=e.get();if(this.availableThemes.some(s=>s===r))return S.of(r)}return S.empty()}loadTheme(e){this.loadStyle(e+".css"),this.theme=e}loadStyle(e){const r=this.document.getElementsByTagName("head")[0],s=this.document.getElementById("theme");if(null!=s)s.href=e;else{const i=this.document.createElement("link");i.id="theme",i.rel="stylesheet",i.href=`${e}`,r.appendChild(i)}}getTheme(){return this.theme}}return n.\u0275fac=function(e){return new(e||n)(xe(Os),xe(ete))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function tte(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),e.push.apply(e,r)}return e}function Ct(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?tte(Object(e),!0).forEach(function(r){s2(n,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):tte(Object(e)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(e,r))})}return n}function FM(n){return(FM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(n)}function nte(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function s2(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function YD(n,t){return function qke(n){if(Array.isArray(n))return n}(n)||function Zke(n,t){var e=null==n?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var o,c,r=[],s=!0,i=!1;try{for(e=e.call(n);!(s=(o=e.next()).done)&&(r.push(o.value),!t||r.length!==t);s=!0);}catch(u){i=!0,c=u}finally{try{!s&&null!=e.return&&e.return()}finally{if(i)throw c}}return r}}(n,t)||rte(n,t)||function Kke(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xg(n){return function Wke(n){if(Array.isArray(n))return KD(n)}(n)||function jke(n){if(typeof Symbol<"u"&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||rte(n)||function Yke(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rte(n,t){if(n){if("string"==typeof n)return KD(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);if("Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e)return Array.from(n);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return KD(n,t)}}function KD(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}var ste=function(){},XD={},ite={},ote=null,ate={mark:ste,measure:ste};try{typeof window<"u"&&(XD=window),typeof document<"u"&&(ite=document),typeof MutationObserver<"u"&&(ote=MutationObserver),typeof performance<"u"&&(ate=performance)}catch{}var UM,GM,WM,qM,jM,cte=(XD.navigator||{}).userAgent,lte=void 0===cte?"":cte,h0=XD,Mr=ite,ute=ote,$M=ate,yl=!!Mr.documentElement&&!!Mr.head&&"function"==typeof Mr.addEventListener&&"function"==typeof Mr.createElement,fte=~lte.indexOf("MSIE")||~lte.indexOf("Trident/"),El="___FONT_AWESOME___",dte="svg-inline--fa",O8="data-fa-i2svg",JD="data-fa-pseudo-element",ez="data-prefix",tz="data-icon",pte="fontawesome-i2svg",eRe=["HTML","HEAD","STYLE","SCRIPT"],gte=function(){try{return!0}catch{return!1}}(),Sr="classic",os="sharp",nz=[Sr,os];function Lg(n){return new Proxy(n,{get:function(e,r){return r in e?e[r]:e[Sr]}})}var kg=Lg((s2(UM={},Sr,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),s2(UM,os,{fa:"solid",fass:"solid","fa-solid":"solid"}),UM)),Rg=Lg((s2(GM={},Sr,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),s2(GM,os,{solid:"fass"}),GM)),Dg=Lg((s2(WM={},Sr,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),s2(WM,os,{fass:"fa-solid"}),WM)),tRe=Lg((s2(qM={},Sr,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),s2(qM,os,{"fa-solid":"fass"}),qM)),nRe=/fa(s|r|l|t|d|b|k|ss)?[\-\ ]/,mte="fa-layers-text",rRe=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,sRe=Lg((s2(jM={},Sr,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),s2(jM,os,{900:"fass"}),jM)),_te=[1,2,3,4,5,6,7,8,9,10],iRe=_te.concat([11,12,13,14,15,16,17,18,19,20]),oRe=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],zg=new Set;Object.keys(Rg[Sr]).map(zg.add.bind(zg)),Object.keys(Rg[os]).map(zg.add.bind(zg));var aRe=[].concat(nz,xg(zg),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul","duotone-group","swap-opacity","primary","secondary"]).concat(_te.map(function(n){return"".concat(n,"x")})).concat(iRe.map(function(n){return"w-".concat(n)})),Vg=h0.FontAwesomeConfig||{};Mr&&"function"==typeof Mr.querySelector&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(n){var t=YD(n,2),r=t[1],s=function lRe(n){return""===n||"false"!==n&&("true"===n||n)}(function cRe(n){var t=Mr.querySelector("script["+n+"]");if(t)return t.getAttribute(n)}(t[0]));null!=s&&(Vg[r]=s)});var vte={styleDefault:"solid",familyDefault:"classic",cssPrefix:"fa",replacementClass:dte,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};Vg.familyPrefix&&(Vg.cssPrefix=Vg.familyPrefix);var wf=Ct(Ct({},vte),Vg);wf.autoReplaceSvg||(wf.observeMutations=!1);var bt={};Object.keys(vte).forEach(function(n){Object.defineProperty(bt,n,{enumerable:!0,set:function(e){wf[n]=e,Hg.forEach(function(r){return r(bt)})},get:function(){return wf[n]}})}),Object.defineProperty(bt,"familyPrefix",{enumerable:!0,set:function(t){wf.cssPrefix=t,Hg.forEach(function(e){return e(bt)})},get:function(){return wf.cssPrefix}}),h0.FontAwesomeConfig=bt;var Hg=[],t4={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function Fg(){for(var n=12,t="";n-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function bf(n){for(var t=[],e=(n||[]).length>>>0;e--;)t[e]=n[e];return t}function rz(n){return n.classList?bf(n.classList):(n.getAttribute("class")||"").split(" ").filter(function(t){return t})}function Cte(n){return"".concat(n).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function ZM(n){return Object.keys(n||{}).reduce(function(t,e){return t+"".concat(e,": ").concat(n[e].trim(),";")},"")}function sz(n){return n.size!==t4.size||n.x!==t4.x||n.y!==t4.y||n.rotate!==t4.rotate||n.flipX||n.flipY}function yte(){var n="fa",t=dte,e=bt.cssPrefix,r=bt.replacementClass,s=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-counter-scale, 0.25));\n          transform: scale(var(--fa-counter-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(var(--fa-li-width, 2em) * -1);\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  -webkit-animation-name: fa-beat;\n          animation-name: fa-beat;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  -webkit-animation-name: fa-bounce;\n          animation-name: fa-bounce;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  -webkit-animation-name: fa-fade;\n          animation-name: fa-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  -webkit-animation-name: fa-beat-fade;\n          animation-name: fa-beat-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  -webkit-animation-name: fa-flip;\n          animation-name: fa-flip;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  -webkit-animation-name: fa-shake;\n          animation-name: fa-shake;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 2s);\n          animation-duration: var(--fa-animation-duration, 2s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));\n          animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    -webkit-animation-delay: -1ms;\n            animation-delay: -1ms;\n    -webkit-animation-duration: 1ms;\n            animation-duration: 1ms;\n    -webkit-animation-iteration-count: 1;\n            animation-iteration-count: 1;\n    transition-delay: 0s;\n    transition-duration: 0s;\n  }\n}\n@-webkit-keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@-webkit-keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@-webkit-keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@-webkit-keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@-webkit-keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@-webkit-keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  -webkit-transform: rotate(var(--fa-rotate-angle, none));\n          transform: rotate(var(--fa-rotate-angle, none));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';if(e!==n||r!==t){var i=new RegExp("\\.".concat(n,"\\-"),"g"),o=new RegExp("\\--".concat(n,"\\-"),"g"),c=new RegExp("\\.".concat(t),"g");s=s.replace(i,".".concat(e,"-")).replace(o,"--".concat(e,"-")).replace(c,".".concat(r))}return s}var Ete=!1;function iz(){bt.autoAddCss&&!Ete&&(function hRe(n){if(n&&yl){var t=Mr.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=n;for(var e=Mr.head.childNodes,r=null,s=e.length-1;s>-1;s--){var i=e[s],o=(i.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=i)}Mr.head.insertBefore(t,r)}}(yte()),Ete=!0)}var vRe={mixout:function(){return{dom:{css:yte,insertCss:iz}}},hooks:function(){return{beforeDOMElementCreation:function(){iz()},beforeI2svg:function(){iz()}}}},Ml=h0||{};Ml[El]||(Ml[El]={}),Ml[El].styles||(Ml[El].styles={}),Ml[El].hooks||(Ml[El].hooks={}),Ml[El].shims||(Ml[El].shims=[]);var Zc=Ml[El],Mte=[],YM=!1;function yRe(n){!yl||(YM?setTimeout(n,0):Mte.push(n))}function Bg(n){var t=n.tag,e=n.attributes,r=void 0===e?{}:e,s=n.children,i=void 0===s?[]:s;return"string"==typeof n?Cte(n):"<".concat(t," ").concat(function pRe(n){return Object.keys(n||{}).reduce(function(t,e){return t+"".concat(e,'="').concat(Cte(n[e]),'" ')},"").trim()}(r),">").concat(i.map(Bg).join(""),"</").concat(t,">")}function Ste(n,t,e){if(n&&n[t]&&n[t][e])return{prefix:t,iconName:e,icon:n[t][e]}}yl&&((YM=(Mr.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Mr.readyState))||Mr.addEventListener("DOMContentLoaded",function n(){Mr.removeEventListener("DOMContentLoaded",n),YM=1,Mte.map(function(t){return t()})}));var oz=function(t,e,r,s){var u,h,g,i=Object.keys(t),o=i.length,c=void 0!==s?function(t,e){return function(r,s,i,o){return t.call(e,r,s,i,o)}}(e,s):e;for(void 0===r?(u=1,g=t[i[0]]):(u=0,g=r);u<o;u++)g=c(g,t[h=i[u]],h,t);return g};function az(n){var t=function MRe(n){for(var t=[],e=0,r=n.length;e<r;){var s=n.charCodeAt(e++);if(s>=55296&&s<=56319&&e<r){var i=n.charCodeAt(e++);56320==(64512&i)?t.push(((1023&s)<<10)+(1023&i)+65536):(t.push(s),e--)}else t.push(s)}return t}(n);return 1===t.length?t[0].toString(16):null}function Pte(n){return Object.keys(n).reduce(function(t,e){var r=n[e];return r.icon?t[r.iconName]=r.icon:t[e]=r,t},{})}function cz(n,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.skipHooks,s=void 0!==r&&r,i=Pte(t);"function"!=typeof Zc.hooks.addPack||s?Zc.styles[n]=Ct(Ct({},Zc.styles[n]||{}),i):Zc.hooks.addPack(n,Pte(t)),"fas"===n&&cz("fa",t)}var KM,XM,QM,Nf=Zc.styles,PRe=Zc.shims,TRe=(s2(KM={},Sr,Object.values(Dg[Sr])),s2(KM,os,Object.values(Dg[os])),KM),lz=null,Tte={},wte={},bte={},Nte={},Ate={},wRe=(s2(XM={},Sr,Object.keys(kg[Sr])),s2(XM,os,Object.keys(kg[os])),XM);function NRe(n,t){var e=t.split("-"),r=e[0],s=e.slice(1).join("-");return r!==n||""===s||function bRe(n){return~aRe.indexOf(n)}(s)?null:s}var Ote=function(){var t=function(i){return oz(Nf,function(o,c,u){return o[u]=oz(c,i,{}),o},{})};Tte=t(function(s,i,o){return i[3]&&(s[i[3]]=o),i[2]&&i[2].filter(function(u){return"number"==typeof u}).forEach(function(u){s[u.toString(16)]=o}),s}),wte=t(function(s,i,o){return s[o]=o,i[2]&&i[2].filter(function(u){return"string"==typeof u}).forEach(function(u){s[u]=o}),s}),Ate=t(function(s,i,o){var c=i[2];return s[o]=o,c.forEach(function(u){s[u]=o}),s});var e="far"in Nf||bt.autoFetchSvg,r=oz(PRe,function(s,i){var o=i[0],c=i[1],u=i[2];return"far"===c&&!e&&(c="fas"),"string"==typeof o&&(s.names[o]={prefix:c,iconName:u}),"number"==typeof o&&(s.unicodes[o.toString(16)]={prefix:c,iconName:u}),s},{names:{},unicodes:{}});bte=r.names,Nte=r.unicodes,lz=JM(bt.styleDefault,{family:bt.familyDefault})};function uz(n,t){return(Tte[n]||{})[t]}function x8(n,t){return(Ate[n]||{})[t]}function Ite(n){return bte[n]||{prefix:null,iconName:null}}function p0(){return lz}function JM(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.family,r=void 0===e?Sr:e,s=kg[r][n],i=Rg[r][n]||Rg[r][s],o=n in Zc.styles?n:null;return i||o||null}(function fRe(n){Hg.push(n)})(function(n){lz=JM(n.styleDefault,{family:bt.familyDefault})}),Ote();var xte=(s2(QM={},Sr,Object.keys(Dg[Sr])),s2(QM,os,Object.keys(Dg[os])),QM);function eS(n){var t,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.skipLookups,s=void 0!==r&&r,i=(s2(t={},Sr,"".concat(bt.cssPrefix,"-").concat(Sr)),s2(t,os,"".concat(bt.cssPrefix,"-").concat(os)),t),o=null,c=Sr;(n.includes(i[Sr])||n.some(function(h){return xte[Sr].includes(h)}))&&(c=Sr),(n.includes(i[os])||n.some(function(h){return xte[os].includes(h)}))&&(c=os);var u=n.reduce(function(h,g){var m=NRe(bt.cssPrefix,g);if(Nf[g]?(g=TRe[c].includes(g)?tRe[c][g]:g,o=g,h.prefix=g):wRe[c].indexOf(g)>-1?(o=g,h.prefix=JM(g,{family:c})):m?h.iconName=m:g!==bt.replacementClass&&g!==i[Sr]&&g!==i[os]&&h.rest.push(g),!s&&h.prefix&&h.iconName){var v="fa"===o?Ite(h.iconName):{},T=x8(h.prefix,h.iconName);v.prefix&&(o=null),h.iconName=v.iconName||T||h.iconName,h.prefix=v.prefix||h.prefix,"far"===h.prefix&&!Nf.far&&Nf.fas&&!bt.autoFetchSvg&&(h.prefix="fas")}return h},{prefix:null,iconName:null,rest:[]});return(n.includes("fa-brands")||n.includes("fab"))&&(u.prefix="fab"),(n.includes("fa-duotone")||n.includes("fad"))&&(u.prefix="fad"),!u.prefix&&c===os&&(Nf.fass||bt.autoFetchSvg)&&(u.prefix="fass",u.iconName=x8(u.prefix,u.iconName)||u.iconName),("fa"===u.prefix||"fa"===o)&&(u.prefix=p0()||"fas"),u}var IRe=function(){function n(){(function $ke(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")})(this,n),this.definitions={}}return function Uke(n,t,e){t&&nte(n.prototype,t),e&&nte(n,e),Object.defineProperty(n,"prototype",{writable:!1})}(n,[{key:"add",value:function(){for(var e=this,r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];var o=s.reduce(this._pullDefinitions,{});Object.keys(o).forEach(function(c){e.definitions[c]=Ct(Ct({},e.definitions[c]||{}),o[c]),cz(c,o[c]);var u=Dg[Sr][c];u&&cz(u,o[c]),Ote()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,r){var s=r.prefix&&r.iconName&&r.icon?{0:r}:r;return Object.keys(s).map(function(i){var o=s[i],c=o.prefix,u=o.iconName,h=o.icon,g=h[2];e[c]||(e[c]={}),g.length>0&&g.forEach(function(m){"string"==typeof m&&(e[c][m]=h)}),e[c][u]=h}),e}}]),n}(),Lte=[],Af={},Of={},xRe=Object.keys(Of);function hz(n,t){for(var e=arguments.length,r=new Array(e>2?e-2:0),s=2;s<e;s++)r[s-2]=arguments[s];var i=Af[n]||[];return i.forEach(function(o){t=o.apply(null,[t].concat(r))}),t}function L8(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];var s=Af[n]||[];s.forEach(function(i){i.apply(null,e)})}function Sl(){var n=arguments[0],t=Array.prototype.slice.call(arguments,1);return Of[n]?Of[n].apply(null,t):void 0}function dz(n){"fa"===n.prefix&&(n.prefix="fas");var t=n.iconName,e=n.prefix||p0();if(t)return t=x8(e,t)||t,Ste(kte.definitions,e,t)||Ste(Zc.styles,e,t)}var kte=new IRe,RRe={i2svg:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return yl?(L8("beforeI2svg",t),Sl("pseudoElements2svg",t),Sl("i2svg",t)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.autoReplaceSvgRoot;!1===bt.autoReplaceSvg&&(bt.autoReplaceSvg=!0),bt.observeMutations=!0,yRe(function(){zRe({autoReplaceSvgRoot:e}),L8("watch",t)})}},va={noAuto:function(){bt.autoReplaceSvg=!1,bt.observeMutations=!1,L8("noAuto")},config:bt,dom:RRe,parse:{icon:function(t){if(null===t)return null;if("object"===FM(t)&&t.prefix&&t.iconName)return{prefix:t.prefix,iconName:x8(t.prefix,t.iconName)||t.iconName};if(Array.isArray(t)&&2===t.length){var e=0===t[1].indexOf("fa-")?t[1].slice(3):t[1],r=JM(t[0]);return{prefix:r,iconName:x8(r,e)||e}}if("string"==typeof t&&(t.indexOf("".concat(bt.cssPrefix,"-"))>-1||t.match(nRe))){var s=eS(t.split(" "),{skipLookups:!0});return{prefix:s.prefix||p0(),iconName:x8(s.prefix,s.iconName)||s.iconName}}if("string"==typeof t){var i=p0();return{prefix:i,iconName:x8(i,t)||t}}}},library:kte,findIconDefinition:dz,toHtml:Bg},zRe=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.autoReplaceSvgRoot,r=void 0===e?Mr:e;(Object.keys(Zc.styles).length>0||bt.autoFetchSvg)&&yl&&bt.autoReplaceSvg&&va.dom.i2svg({node:r})};function tS(n,t){return Object.defineProperty(n,"abstract",{get:t}),Object.defineProperty(n,"html",{get:function(){return n.abstract.map(function(r){return Bg(r)})}}),Object.defineProperty(n,"node",{get:function(){if(yl){var r=Mr.createElement("div");return r.innerHTML=n.html,r.children}}}),n}function pz(n){var t=n.icons,e=t.main,r=t.mask,s=n.prefix,i=n.iconName,o=n.transform,c=n.symbol,u=n.title,h=n.maskId,g=n.titleId,m=n.extra,v=n.watchable,T=void 0!==v&&v,I=r.found?r:e,z=I.width,Z=I.height,te="fak"===s,me=[bt.replacementClass,i?"".concat(bt.cssPrefix,"-").concat(i):""].filter(function(M1){return-1===m.classes.indexOf(M1)}).filter(function(M1){return""!==M1||!!M1}).concat(m.classes).join(" "),J={children:[],attributes:Ct(Ct({},m.attributes),{},{"data-prefix":s,"data-icon":i,class:me,role:m.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(z," ").concat(Z)})},Ne=te&&!~m.classes.indexOf("fa-fw")?{width:"".concat(z/Z*16*.0625,"em")}:{};T&&(J.attributes[O8]=""),u&&(J.children.push({tag:"title",attributes:{id:J.attributes["aria-labelledby"]||"title-".concat(g||Fg())},children:[u]}),delete J.attributes.title);var He=Ct(Ct({},J),{},{prefix:s,iconName:i,main:e,mask:r,maskId:h,transform:o,symbol:c,styles:Ct(Ct({},Ne),m.styles)}),qe=r.found&&e.found?Sl("generateAbstractMask",He)||{children:[],attributes:{}}:Sl("generateAbstractIcon",He)||{children:[],attributes:{}},A1=qe.attributes;return He.children=qe.children,He.attributes=A1,c?function HRe(n){var e=n.iconName,r=n.children,s=n.attributes,i=n.symbol,o=!0===i?"".concat(n.prefix,"-").concat(bt.cssPrefix,"-").concat(e):i;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:Ct(Ct({},s),{},{id:o}),children:r}]}]}(He):function VRe(n){var t=n.children,e=n.main,r=n.mask,s=n.attributes,i=n.styles,o=n.transform;if(sz(o)&&e.found&&!r.found){var h={x:e.width/e.height/2,y:.5};s.style=ZM(Ct(Ct({},i),{},{"transform-origin":"".concat(h.x+o.x/16,"em ").concat(h.y+o.y/16,"em")}))}return[{tag:"svg",attributes:s,children:t}]}(He)}function Rte(n){var t=n.content,e=n.width,r=n.height,s=n.transform,i=n.title,o=n.extra,c=n.watchable,u=void 0!==c&&c,h=Ct(Ct(Ct({},o.attributes),i?{title:i}:{}),{},{class:o.classes.join(" ")});u&&(h[O8]="");var g=Ct({},o.styles);sz(s)&&(g.transform=function mRe(n){var t=n.transform,e=n.width,s=n.height,i=void 0===s?16:s,o=n.startCentered,c=void 0!==o&&o,u="";return u+=c&&fte?"translate(".concat(t.x/16-(void 0===e?16:e)/2,"em, ").concat(t.y/16-i/2,"em) "):c?"translate(calc(-50% + ".concat(t.x/16,"em), calc(-50% + ").concat(t.y/16,"em)) "):"translate(".concat(t.x/16,"em, ").concat(t.y/16,"em) "),(u+="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "))+"rotate(".concat(t.rotate,"deg) ")}({transform:s,startCentered:!0,width:e,height:r}),g["-webkit-transform"]=g.transform);var m=ZM(g);m.length>0&&(h.style=m);var v=[];return v.push({tag:"span",attributes:h,children:[t]}),i&&v.push({tag:"span",attributes:{class:"sr-only"},children:[i]}),v}function FRe(n){var t=n.content,e=n.title,r=n.extra,s=Ct(Ct(Ct({},r.attributes),e?{title:e}:{}),{},{class:r.classes.join(" ")}),i=ZM(r.styles);i.length>0&&(s.style=i);var o=[];return o.push({tag:"span",attributes:s,children:[t]}),e&&o.push({tag:"span",attributes:{class:"sr-only"},children:[e]}),o}var gz=Zc.styles;function mz(n){var t=n[0],e=n[1],i=YD(n.slice(4),1)[0];return{found:!0,width:t,height:e,icon:Array.isArray(i)?{tag:"g",attributes:{class:"".concat(bt.cssPrefix,"-").concat("duotone-group")},children:[{tag:"path",attributes:{class:"".concat(bt.cssPrefix,"-").concat("secondary"),fill:"currentColor",d:i[0]}},{tag:"path",attributes:{class:"".concat(bt.cssPrefix,"-").concat("primary"),fill:"currentColor",d:i[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:i}}}}var BRe={found:!1,width:512,height:512};function _z(n,t){var e=t;return"fa"===t&&null!==bt.styleDefault&&(t=p0()),new Promise(function(r,s){if(Sl("missingIconAbstract"),"fa"===e){var o=Ite(n)||{};n=o.iconName||n,t=o.prefix||t}if(n&&t&&gz[t]&&gz[t][n])return r(mz(gz[t][n]));(function $Re(n,t){!gte&&!bt.showMissingIcons&&n&&console.error('Icon with name "'.concat(n,'" and prefix "').concat(t,'" is missing.'))})(n,t),r(Ct(Ct({},BRe),{},{icon:bt.showMissingIcons&&n&&Sl("missingIconAbstract")||{}}))})}var Dte=function(){},vz=bt.measurePerformance&&$M&&$M.mark&&$M.measure?$M:{mark:Dte,measure:Dte},$g='FA "6.2.1"',Cz_begin=function(t){return vz.mark("".concat($g," ").concat(t," begins")),function(){return function(t){vz.mark("".concat($g," ").concat(t," ends")),vz.measure("".concat($g," ").concat(t),"".concat($g," ").concat(t," begins"),"".concat($g," ").concat(t," ends"))}(t)}},nS=function(){};function Vte(n){return"string"==typeof(n.getAttribute?n.getAttribute(O8):null)}function jRe(n){return Mr.createElementNS("http://www.w3.org/2000/svg",n)}function ZRe(n){return Mr.createElement(n)}function Hte(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.ceFn,r=void 0===e?"svg"===n.tag?jRe:ZRe:e;if("string"==typeof n)return Mr.createTextNode(n);var s=r(n.tag);Object.keys(n.attributes||[]).forEach(function(o){s.setAttribute(o,n.attributes[o])});var i=n.children||[];return i.forEach(function(o){s.appendChild(Hte(o,{ceFn:r}))}),s}var rS={replace:function(t){var e=t[0];if(e.parentNode)if(t[1].forEach(function(s){e.parentNode.insertBefore(Hte(s),e)}),null===e.getAttribute(O8)&&bt.keepOriginalSource){var r=Mr.createComment(function YRe(n){var t=" ".concat(n.outerHTML," ");return"".concat(t,"Font Awesome fontawesome.com ")}(e));e.parentNode.replaceChild(r,e)}else e.remove()},nest:function(t){var e=t[0],r=t[1];if(~rz(e).indexOf(bt.replacementClass))return rS.replace(t);var s=new RegExp("".concat(bt.cssPrefix,"-.*"));if(delete r[0].attributes.id,r[0].attributes.class){var i=r[0].attributes.class.split(" ").reduce(function(c,u){return u===bt.replacementClass||u.match(s)?c.toSvg.push(u):c.toNode.push(u),c},{toNode:[],toSvg:[]});r[0].attributes.class=i.toSvg.join(" "),0===i.toNode.length?e.removeAttribute("class"):e.setAttribute("class",i.toNode.join(" "))}var o=r.map(function(c){return Bg(c)}).join("\n");e.setAttribute(O8,""),e.innerHTML=o}};function Fte(n){n()}function Bte(n,t){var e="function"==typeof t?t:nS;if(0===n.length)e();else{var r=Fte;"async"===bt.mutateApproach&&(r=h0.requestAnimationFrame||Fte),r(function(){var s=function qRe(){return!0===bt.autoReplaceSvg?rS.replace:rS[bt.autoReplaceSvg]||rS.replace}(),i=Cz_begin("mutate");n.map(s),i(),e()})}}var yz=!1;function $te(){yz=!0}function Ez(){yz=!1}var sS=null;function Ute(n){if(ute&&bt.observeMutations){var t=n.treeCallback,e=void 0===t?nS:t,r=n.nodeCallback,s=void 0===r?nS:r,i=n.pseudoElementsCallback,o=void 0===i?nS:i,c=n.observeMutationsRoot,u=void 0===c?Mr:c;sS=new ute(function(h){if(!yz){var g=p0();bf(h).forEach(function(m){if("childList"===m.type&&m.addedNodes.length>0&&!Vte(m.addedNodes[0])&&(bt.searchPseudoElements&&o(m.target),e(m.target)),"attributes"===m.type&&m.target.parentNode&&bt.searchPseudoElements&&o(m.target.parentNode),"attributes"===m.type&&Vte(m.target)&&~oRe.indexOf(m.attributeName))if("class"===m.attributeName&&function GRe(n){var t=n.getAttribute?n.getAttribute(ez):null,e=n.getAttribute?n.getAttribute(tz):null;return t&&e}(m.target)){var v=eS(rz(m.target)),I=v.iconName;m.target.setAttribute(ez,v.prefix||g),I&&m.target.setAttribute(tz,I)}else(function WRe(n){return n&&n.classList&&n.classList.contains&&n.classList.contains(bt.replacementClass)})(m.target)&&s(m.target)})}}),yl&&sS.observe(u,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function XRe(n){var t=n.getAttribute("style"),e=[];return t&&(e=t.split(";").reduce(function(r,s){var i=s.split(":"),o=i[0],c=i.slice(1);return o&&c.length>0&&(r[o]=c.join(":").trim()),r},{})),e}function QRe(n){var t=n.getAttribute("data-prefix"),e=n.getAttribute("data-icon"),r=void 0!==n.innerText?n.innerText.trim():"",s=eS(rz(n));return s.prefix||(s.prefix=p0()),t&&e&&(s.prefix=t,s.iconName=e),s.iconName&&s.prefix||(s.prefix&&r.length>0&&(s.iconName=function ARe(n,t){return(wte[n]||{})[t]}(s.prefix,n.innerText)||uz(s.prefix,az(n.innerText))),!s.iconName&&bt.autoFetchSvg&&n.firstChild&&n.firstChild.nodeType===Node.TEXT_NODE&&(s.iconName=n.firstChild.data)),s}function JRe(n){var t=bf(n.attributes).reduce(function(s,i){return"class"!==s.name&&"style"!==s.name&&(s[i.name]=i.value),s},{}),e=n.getAttribute("title"),r=n.getAttribute("data-fa-title-id");return bt.autoA11y&&(e?t["aria-labelledby"]="".concat(bt.replacementClass,"-title-").concat(r||Fg()):(t["aria-hidden"]="true",t.focusable="false")),t}function Gte(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0},e=QRe(n),r=e.iconName,s=e.prefix,i=e.rest,o=JRe(n),c=hz("parseNodeAttributes",{},n),u=t.styleParser?XRe(n):[];return Ct({iconName:r,title:n.getAttribute("title"),titleId:n.getAttribute("data-fa-title-id"),prefix:s,transform:t4,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:i,styles:u,attributes:o}},c)}var tDe=Zc.styles;function Wte(n){var t="nest"===bt.autoReplaceSvg?Gte(n,{styleParser:!1}):Gte(n);return~t.extra.classes.indexOf(mte)?Sl("generateLayersText",n,t):Sl("generateSvgReplacementMutation",n,t)}var g0=new Set;function qte(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!yl)return Promise.resolve();var e=Mr.documentElement.classList,r=function(m){return e.add("".concat(pte,"-").concat(m))},s=function(m){return e.remove("".concat(pte,"-").concat(m))},i=bt.autoFetchSvg?g0:nz.map(function(g){return"fa-".concat(g)}).concat(Object.keys(tDe));i.includes("fa")||i.push("fa");var o=[".".concat(mte,":not([").concat(O8,"])")].concat(i.map(function(g){return".".concat(g,":not([").concat(O8,"])")})).join(", ");if(0===o.length)return Promise.resolve();var c=[];try{c=bf(n.querySelectorAll(o))}catch{}if(!(c.length>0))return Promise.resolve();r("pending"),s("complete");var u=Cz_begin("onTree"),h=c.reduce(function(g,m){try{var v=Wte(m);v&&g.push(v)}catch(T){gte||"MissingIcon"===T.name&&console.error(T)}return g},[]);return new Promise(function(g,m){Promise.all(h).then(function(v){Bte(v,function(){r("active"),r("complete"),s("pending"),"function"==typeof t&&t(),u(),g()})}).catch(function(v){u(),m(v)})})}function nDe(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Wte(n).then(function(e){e&&Bte([e],t)})}function rDe(n){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:dz(t||{}),s=e.mask;return s&&(s=(s||{}).icon?s:dz(s||{})),n(r,Ct(Ct({},e),{},{mask:s}))}}nz.map(function(n){g0.add("fa-".concat(n))}),Object.keys(kg[Sr]).map(g0.add.bind(g0)),Object.keys(kg[os]).map(g0.add.bind(g0)),g0=xg(g0);var sDe=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.transform,s=void 0===r?t4:r,i=e.symbol,o=void 0!==i&&i,c=e.mask,u=void 0===c?null:c,h=e.maskId,g=void 0===h?null:h,m=e.title,v=void 0===m?null:m,T=e.titleId,I=void 0===T?null:T,z=e.classes,Z=void 0===z?[]:z,te=e.attributes,me=void 0===te?{}:te,J=e.styles,Ne=void 0===J?{}:J;if(t){var He=t.prefix,qe=t.iconName,Dt=t.icon;return tS(Ct({type:"icon"},t),function(){return L8("beforeDOMElementCreation",{iconDefinition:t,params:e}),bt.autoA11y&&(v?me["aria-labelledby"]="".concat(bt.replacementClass,"-title-").concat(I||Fg()):(me["aria-hidden"]="true",me.focusable="false")),pz({icons:{main:mz(Dt),mask:u?mz(u.icon):{found:!1,width:null,height:null,icon:{}}},prefix:He,iconName:qe,transform:Ct(Ct({},t4),s),symbol:o,title:v,maskId:g,titleId:I,extra:{attributes:me,styles:Ne,classes:Z}})})}},iDe={mixout:function(){return{icon:rDe(sDe)}},hooks:function(){return{mutationObserverCallbacks:function(e){return e.treeCallback=qte,e.nodeCallback=nDe,e}}},provides:function(t){t.i2svg=function(e){var r=e.node,i=e.callback;return qte(void 0===r?Mr:r,void 0===i?function(){}:i)},t.generateSvgReplacementMutation=function(e,r){var s=r.iconName,i=r.title,o=r.titleId,c=r.prefix,u=r.transform,h=r.symbol,g=r.mask,m=r.maskId,v=r.extra;return new Promise(function(T,I){Promise.all([_z(s,c),g.iconName?_z(g.iconName,g.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(z){var Z=YD(z,2);T([e,pz({icons:{main:Z[0],mask:Z[1]},prefix:c,iconName:s,transform:u,symbol:h,maskId:m,title:i,titleId:o,extra:v,watchable:!0})])}).catch(I)})},t.generateAbstractIcon=function(e){var h,r=e.children,s=e.attributes,i=e.main,o=e.transform,u=ZM(e.styles);return u.length>0&&(s.style=u),sz(o)&&(h=Sl("generateAbstractTransformGrouping",{main:i,transform:o,containerWidth:i.width,iconWidth:i.width})),r.push(h||i.icon),{children:r,attributes:s}}}},oDe={mixout:function(){return{layer:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.classes,i=void 0===s?[]:s;return tS({type:"layer"},function(){L8("beforeDOMElementCreation",{assembler:e,params:r});var o=[];return e(function(c){Array.isArray(c)?c.map(function(u){o=o.concat(u.abstract)}):o=o.concat(c.abstract)}),[{tag:"span",attributes:{class:["".concat(bt.cssPrefix,"-layers")].concat(xg(i)).join(" ")},children:o}]})}}}},aDe={mixout:function(){return{counter:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.title,i=void 0===s?null:s,o=r.classes,c=void 0===o?[]:o,u=r.attributes,h=void 0===u?{}:u,g=r.styles,m=void 0===g?{}:g;return tS({type:"counter",content:e},function(){return L8("beforeDOMElementCreation",{content:e,params:r}),FRe({content:e.toString(),title:i,extra:{attributes:h,styles:m,classes:["".concat(bt.cssPrefix,"-layers-counter")].concat(xg(c))}})})}}}},cDe={mixout:function(){return{text:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.transform,i=void 0===s?t4:s,o=r.title,c=void 0===o?null:o,u=r.classes,h=void 0===u?[]:u,g=r.attributes,m=void 0===g?{}:g,v=r.styles,T=void 0===v?{}:v;return tS({type:"text",content:e},function(){return L8("beforeDOMElementCreation",{content:e,params:r}),Rte({content:e,transform:Ct(Ct({},t4),i),title:c,extra:{attributes:m,styles:T,classes:["".concat(bt.cssPrefix,"-layers-text")].concat(xg(h))}})})}}},provides:function(t){t.generateLayersText=function(e,r){var s=r.title,i=r.transform,o=r.extra,c=null,u=null;if(fte){var h=parseInt(getComputedStyle(e).fontSize,10),g=e.getBoundingClientRect();c=g.width/h,u=g.height/h}return bt.autoA11y&&!s&&(o.attributes["aria-hidden"]="true"),Promise.resolve([e,Rte({content:e.innerHTML,width:c,height:u,transform:i,title:s,extra:o,watchable:!0})])}}},lDe=new RegExp('"',"ug"),jte=[1105920,1112319];function Zte(n,t){var e="".concat("data-fa-pseudo-element-pending").concat(t.replace(":","-"));return new Promise(function(r,s){if(null!==n.getAttribute(e))return r();var o=bf(n.children).filter(function(Dt){return Dt.getAttribute(JD)===t})[0],c=h0.getComputedStyle(n,t),u=c.getPropertyValue("font-family").match(rRe),h=c.getPropertyValue("font-weight"),g=c.getPropertyValue("content");if(o&&!u)return n.removeChild(o),r();if(u&&"none"!==g&&""!==g){var m=c.getPropertyValue("content"),v=~["Sharp"].indexOf(u[2])?os:Sr,T=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(u[2])?Rg[v][u[2].toLowerCase()]:sRe[v][h],I=function uDe(n){var t=n.replace(lDe,""),e=function SRe(n,t){var s,e=n.length,r=n.charCodeAt(t);return r>=55296&&r<=56319&&e>t+1&&(s=n.charCodeAt(t+1))>=56320&&s<=57343?1024*(r-55296)+s-56320+65536:r}(t,0),r=e>=jte[0]&&e<=jte[1],s=2===t.length&&t[0]===t[1];return{value:az(s?t[0]:t),isSecondary:r||s}}(m),z=I.value,Z=I.isSecondary,te=u[0].startsWith("FontAwesome"),me=uz(T,z),J=me;if(te){var Ne=function ORe(n){var t=Nte[n],e=uz("fas",n);return t||(e?{prefix:"fas",iconName:e}:null)||{prefix:null,iconName:null}}(z);Ne.iconName&&Ne.prefix&&(me=Ne.iconName,T=Ne.prefix)}if(!me||Z||o&&o.getAttribute(ez)===T&&o.getAttribute(tz)===J)r();else{n.setAttribute(e,J),o&&n.removeChild(o);var He=function eDe(){return{iconName:null,title:null,titleId:null,prefix:null,transform:t4,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}(),qe=He.extra;qe.attributes[JD]=t,_z(me,T).then(function(Dt){var A1=pz(Ct(Ct({},He),{},{icons:{main:Dt,mask:{prefix:null,iconName:null,rest:[]}},prefix:T,iconName:J,extra:qe,watchable:!0})),M1=Mr.createElement("svg");"::before"===t?n.insertBefore(M1,n.firstChild):n.appendChild(M1),M1.outerHTML=A1.map(function(Yr){return Bg(Yr)}).join("\n"),n.removeAttribute(e),r()}).catch(s)}}else r()})}function fDe(n){return Promise.all([Zte(n,"::before"),Zte(n,"::after")])}function hDe(n){return!(n.parentNode===document.head||~eRe.indexOf(n.tagName.toUpperCase())||n.getAttribute(JD)||n.parentNode&&"svg"===n.parentNode.tagName)}function Yte(n){if(yl)return new Promise(function(t,e){var r=bf(n.querySelectorAll("*")).filter(hDe).map(fDe),s=Cz_begin("searchPseudoElements");$te(),Promise.all(r).then(function(){s(),Ez(),t()}).catch(function(){s(),Ez(),e()})})}var Kte=!1,Xte=function(t){return t.toLowerCase().split(" ").reduce(function(r,s){var i=s.toLowerCase().split("-"),o=i[0],c=i.slice(1).join("-");if(o&&"h"===c)return r.flipX=!0,r;if(o&&"v"===c)return r.flipY=!0,r;if(c=parseFloat(c),isNaN(c))return r;switch(o){case"grow":r.size=r.size+c;break;case"shrink":r.size=r.size-c;break;case"left":r.x=r.x-c;break;case"right":r.x=r.x+c;break;case"up":r.y=r.y-c;break;case"down":r.y=r.y+c;break;case"rotate":r.rotate=r.rotate+c}return r},{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0})},Mz={x:0,y:0,width:"100%",height:"100%"};function Qte(n){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return n.attributes&&(n.attributes.fill||t)&&(n.attributes.fill="black"),n}function mDe(n){return"g"===n.tag?n.children:[n]}var _De={hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-mask"),i=s?eS(s.split(" ").map(function(o){return o.trim()})):{prefix:null,iconName:null,rest:[]};return i.prefix||(i.prefix=p0()),e.mask=i,e.maskId=r.getAttribute("data-fa-mask-id"),e}}},provides:function(t){t.generateAbstractMask=function(e){var r=e.children,s=e.attributes,i=e.main,o=e.mask,c=e.maskId,g=i.icon,v=o.icon,T=function gRe(n){var t=n.transform,r=n.iconWidth,s={transform:"translate(".concat(n.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),o="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),c="rotate(".concat(t.rotate," 0 0)");return{outer:s,inner:{transform:"".concat(i," ").concat(o," ").concat(c)},path:{transform:"translate(".concat(r/2*-1," -256)")}}}({transform:e.transform,containerWidth:o.width,iconWidth:i.width}),I={tag:"rect",attributes:Ct(Ct({},Mz),{},{fill:"white"})},z=g.children?{children:g.children.map(Qte)}:{},Z={tag:"g",attributes:Ct({},T.inner),children:[Qte(Ct({tag:g.tag,attributes:Ct(Ct({},g.attributes),T.path)},z))]},te={tag:"g",attributes:Ct({},T.outer),children:[Z]},me="mask-".concat(c||Fg()),J="clip-".concat(c||Fg()),Ne={tag:"mask",attributes:Ct(Ct({},Mz),{},{id:me,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[I,te]},He={tag:"defs",children:[{tag:"clipPath",attributes:{id:J},children:mDe(v)},Ne]};return r.push(He,{tag:"rect",attributes:Ct({fill:"currentColor","clip-path":"url(#".concat(J,")"),mask:"url(#".concat(me,")")},Mz)}),{children:r,attributes:s}}}};!function LRe(n,t){var e=t.mixoutsTo;Lte=n,Af={},Object.keys(Of).forEach(function(r){-1===xRe.indexOf(r)&&delete Of[r]}),Lte.forEach(function(r){var s=r.mixout?r.mixout():{};if(Object.keys(s).forEach(function(o){"function"==typeof s[o]&&(e[o]=s[o]),"object"===FM(s[o])&&Object.keys(s[o]).forEach(function(c){e[o]||(e[o]={}),e[o][c]=s[o][c]})}),r.hooks){var i=r.hooks();Object.keys(i).forEach(function(o){Af[o]||(Af[o]=[]),Af[o].push(i[o])})}r.provides&&r.provides(Of)})}([vRe,iDe,oDe,aDe,cDe,{hooks:function(){return{mutationObserverCallbacks:function(e){return e.pseudoElementsCallback=Yte,e}}},provides:function(t){t.pseudoElements2svg=function(e){var r=e.node;bt.searchPseudoElements&&Yte(void 0===r?Mr:r)}}},{mixout:function(){return{dom:{unwatch:function(){$te(),Kte=!0}}}},hooks:function(){return{bootstrap:function(){Ute(hz("mutationObserverCallbacks",{}))},noAuto:function(){!function KRe(){!sS||sS.disconnect()}()},watch:function(e){var r=e.observeMutationsRoot;Kte?Ez():Ute(hz("mutationObserverCallbacks",{observeMutationsRoot:r}))}}}},{mixout:function(){return{parse:{transform:function(e){return Xte(e)}}}},hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-transform");return s&&(e.transform=Xte(s)),e}}},provides:function(t){t.generateAbstractTransformGrouping=function(e){var r=e.main,s=e.transform,o=e.iconWidth,c={transform:"translate(".concat(e.containerWidth/2," 256)")},u="translate(".concat(32*s.x,", ").concat(32*s.y,") "),h="scale(".concat(s.size/16*(s.flipX?-1:1),", ").concat(s.size/16*(s.flipY?-1:1),") "),g="rotate(".concat(s.rotate," 0 0)"),T={outer:c,inner:{transform:"".concat(u," ").concat(h," ").concat(g)},path:{transform:"translate(".concat(o/2*-1," -256)")}};return{tag:"g",attributes:Ct({},T.outer),children:[{tag:"g",attributes:Ct({},T.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:Ct(Ct({},r.icon.attributes),T.path)}]}]}}}},_De,{provides:function(t){var e=!1;h0.matchMedia&&(e=h0.matchMedia("(prefers-reduced-motion: reduce)").matches),t.missingIconAbstract=function(){var r=[],s={fill:"currentColor"},i={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};r.push({tag:"path",attributes:Ct(Ct({},s),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var o=Ct(Ct({},i),{},{attributeName:"opacity"}),c={tag:"circle",attributes:Ct(Ct({},s),{},{cx:"256",cy:"364",r:"28"}),children:[]};return e||c.children.push({tag:"animate",attributes:Ct(Ct({},i),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:Ct(Ct({},o),{},{values:"1;0;1;1;0;1;"})}),r.push(c),r.push({tag:"path",attributes:Ct(Ct({},s),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:e?[]:[{tag:"animate",attributes:Ct(Ct({},o),{},{values:"1;0;0;0;0;1;"})}]}),e||r.push({tag:"path",attributes:Ct(Ct({},s),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:Ct(Ct({},o),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:r}}}},{hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-symbol");return e.symbol=null!==s&&(""===s||s),e}}}}],{mixoutsTo:va});var EDe=va.parse,MDe=va.icon;const SDe=["*"],wDe=n=>{const t={"fa-spin":n.spin,"fa-pulse":n.pulse,"fa-fw":n.fixedWidth,"fa-border":n.border,"fa-inverse":n.inverse,"fa-layers-counter":n.counter,"fa-flip-horizontal":"horizontal"===n.flip||"both"===n.flip,"fa-flip-vertical":"vertical"===n.flip||"both"===n.flip,[`fa-${n.size}`]:null!==n.size,[`fa-rotate-${n.rotate}`]:null!==n.rotate,[`fa-pull-${n.pull}`]:null!==n.pull,[`fa-stack-${n.stackItemSize}`]:null!=n.stackItemSize};return Object.keys(t).map(e=>t[e]?e:null).filter(e=>e)};let ADe=(()=>{class n{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ODe=(()=>{class n{constructor(){this.definitions={}}addIcons(...e){for(const r of e){r.prefix in this.definitions||(this.definitions[r.prefix]={}),this.definitions[r.prefix][r.iconName]=r;for(const s of r.icon[2])"string"==typeof s&&(this.definitions[r.prefix][s]=r)}}addIconPacks(...e){for(const r of e){const s=Object.keys(r).map(i=>r[i]);this.addIcons(...s)}}getIconDefinition(e,r){return e in this.definitions&&r in this.definitions[e]?this.definitions[e][r]:null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),IDe=(()=>{class n{constructor(){this.stackItemSize="1x"}ngOnChanges(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ht({type:n,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[H2]}),n})(),xDe=(()=>{class n{constructor(e,r){this.renderer=e,this.elementRef=r}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${e.size.currentValue}`),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${e.size.previousValue}`))}}return n.\u0275fac=function(e){return new(e||n)(Q(Wi),Q(j2))},n.\u0275cmp=vt({type:n,selectors:[["fa-stack"]],inputs:{size:"size"},features:[H2],ngContentSelectors:SDe,decls:1,vars:0,template:function(e,r){1&e&&(function CF(n){const t=Oe()[16][6];if(!t.projection){const r=t.projection=x4(n?n.length:1,null),s=r.slice();let i=t.child;for(;null!==i;){const o=n?i3e(i,n):0;null!==o&&(s[o]?s[o].projectionNext=i:r[o]=i,s[o]=i),i=i.next}}}(),function yF(n,t=0,e){const r=Oe(),s=qn(),i=P6(s,22+n,16,null,e||null);null===i.projection&&(i.projection=t),Oh(),64!=(64&i.flags)&&function ew(n,t,e){fv(t[11],0,t,e,rv(n,e,t),av(e.parent||t[6],e,t))}(s,r,i)}(0))},encapsulation:2}),n})(),If=(()=>{class n{constructor(e,r,s,i,o){this.sanitizer=e,this.config=r,this.iconLibrary=s,this.stackItem=i,this.classes=[],null!=o&&null==i&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(e){if(null==this.icon&&null==this.config.fallbackIcon)return(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})();let r=null;if(r=this.icon??this.config.fallbackIcon,e){const s=this.findIconDefinition(r);if(null!=s){const i=this.buildParams();this.renderIcon(s,i)}}}render(){this.ngOnChanges({})}findIconDefinition(e){const r=((n,t)=>(n=>void 0!==n.prefix&&void 0!==n.iconName)(n)?n:Array.isArray(n)&&2===n.length?{prefix:n[0],iconName:n[1]}:"string"==typeof n?{prefix:t,iconName:n}:void 0)(e,this.config.defaultPrefix);return"icon"in r?r:this.iconLibrary.getIconDefinition(r.prefix,r.iconName)??((n=>{throw new Error(`Could not find icon with iconName=${n.iconName} and prefix=${n.prefix} in the icon library.`)})(r),null)}buildParams(){const e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},r="string"==typeof this.transform?EDe.transform(this.transform):this.transform;return{title:this.title,transform:r,classes:[...wDe(e),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(e,r){const s=MDe(e,r);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(s.html.join("\n"))}}return n.\u0275fac=function(e){return new(e||n)(Q(FU),Q(ADe),Q(ODe),Q(IDe,8),Q(xDe,8))},n.\u0275cmp=vt({type:n,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,r){2&e&&(eb("innerHTML",r.renderedIconHTML,ud),V("title",r.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[H2],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),LDe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=qs({type:n}),n.\u0275inj=Fr({}),n})();var wz={prefix:"fas",iconName:"reply",icon:[512,512,[61714,"mail-reply"],"f3e5","M205 34.8c11.5 5.1 19 16.6 19 29.2v64H336c97.2 0 176 78.8 176 176c0 113.3-81.5 163.9-100.2 174.1c-2.5 1.4-5.3 1.9-8.1 1.9c-10.9 0-19.7-8.9-19.7-19.7c0-7.5 4.3-14.4 9.8-19.5c9.4-8.8 22.2-26.4 22.2-56.7c0-53-43-96-96-96H224v64c0 12.6-7.4 24.1-19 29.2s-25 3-34.4-5.4l-160-144C3.9 225.7 0 217.1 0 208s3.9-17.7 10.6-23.8l160-144c9.4-8.5 22.9-10.6 34.4-5.4z"]},Bz={prefix:"fas",iconName:"eye",icon:[576,512,[128065],"f06e","M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"]},F2e={prefix:"fas",iconName:"gear",icon:[512,512,[9881,"cog"],"f013","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336c44.2 0 80-35.8 80-80s-35.8-80-80-80s-80 35.8-80 80s35.8 80 80 80z"]},X2e={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M256 64H384v64H256V64zM240 0c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h48v32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96v32H80c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H240c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H192V288H448v32H400c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H560c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H512V288h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V192h48c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48H240zM96 448V384H224v64H96zm320-64H544v64H416V384z"]},_oe={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"]},uV={prefix:"fas",iconName:"desktop",icon:[576,512,[128421,61704,"desktop-alt"],"f390","M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64H240l-10.7 32H160c-17.7 0-32 14.3-32 32s14.3 32 32 32H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H346.7L336 416H512c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64zM512 64V288H64V64H512z"]},Joe={prefix:"fas",iconName:"book-open",icon:[576,512,[128214,128366],"f518","M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C87.5 32 35.1 48.6 9 59.9c-5.6 2.4-9 8-9 14V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V73.9c0-6.1-3.4-11.6-9-14C540.9 48.6 488.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z"]};class bae{static toComparableObjectSet(t){const e=[];return t.forEach(r=>{e.some(s=>s.equals(r))||e.push(r)}),e}static toComparableSet(t){const e=[];return t.forEach(r=>{e.some(s=>jc(s,r))||e.push(r)}),e}}class Z1{constructor(t){this.values=void 0===t?[]:bae.toComparableSet(t)}equals(t){if(t.size()!==this.size())return!1;for(const e of this)if(!1===t.contains(e))return!1;return!0}toString(){let t="";for(const e of this)t+=null==e?"null, ":e.toString()+", ";return"["+t.slice(0,-2)+"]"}add(t){return!this.contains(t)&&(this.values.push(t),!0)}union(t){for(const e of t)this.add(e)}contains(t){for(const e of this.values)if(jc(e,t))return!0;return!1}size(){return this.values.length}toList(){const t=[];for(const e of this)t.push(e);return t}getAnyElement(){return this.size()>0?S.of(this.values[0]):S.empty()}isEmpty(){return 0===this.values.length}[Symbol.iterator](){return this.values.values()}}class Qn{constructor(t=[],e=!1){this.map=t,this.isImmutable=e}static from(t){const e=Object.keys(t),r=new Qn;for(const s of e)r.set(s,t[s]);return r}makeImmutable(){this.isImmutable=!0}get(t){for(const e of this.map)if(jc(e.key,t))return S.of(e.value);return S.empty()}forEach(t){for(let e=0;e<this.map.length;e++)t(this.getByIndex(e))}getByIndex(t){return this.map[t]}putAll(t){this.checkImmutability("putAll");for(const e of t.map)this.put(e.key,e.value)}checkImmutability(t){if(this.isImmutable)throw new Error("Cannot call "+t+" on immutable map!")}put(t,e){this.checkImmutability("put");for(const r of this.map)if(jc(r.key,t)){const s=r.value;return r.value=e,S.of(s)}return this.map.push({key:t,value:e}),S.empty()}containsKey(t){return this.map.some(e=>jc(e.key,t))}size(){return this.map.length}listKeys(){return this.map.map(t=>t.key)}getKeySet(){return new Z1(this.listKeys())}filter(t){const e=new Qn;for(const r of this.map)t(r.key,r.value)&&e.set(r.key,r.value);return e}replace(t,e){if(this.checkImmutability("replace"),this.get(t).isAbsent())throw new Error("No Value to replace for key "+t.toString()+"!");return this.put(t,e),e}set(t,e){if(this.checkImmutability("set"),this.containsKey(t))throw new Error("Key "+t.toString()+" already exist in Map!");this.map.push({key:t,value:e})}delete(t){this.checkImmutability("delete");for(let e=0;e<this.map.length;e++)if(jc(this.map[e].key,t)){const s=this.map[e].value,i=this.map.slice(0,e),o=this.map.slice(e+1);return this.map=i.concat(o),s}throw new Error('No Value to delete for key "'+t.toString()+'"!')}getCopy(){const t=new this.constructor;for(const e of this.listKeys())t.set(e,this.get(e).get());return t}equals(t){const e=this.getKeySet(),r=t.getKeySet();if(!1===e.equals(r))return!1;for(const s of e){const i=this.get(s).get(),o=t.get(s);if(Se(o.isPresent(),"value is absent in a map even though its key is present!"),!1===jc(i,o.get()))return!1}return!0}}class k8 extends Qn{reverse(){const t=new k8;for(const e of this.listKeys()){const r=this.get(e).get();if(t.containsKey(r))t.get(r).get().add(e);else{const s=new Z1;s.add(e),t.set(r,s)}}return t}}class li{constructor(t,e){this.userDAO=t,this.connectedUserService=e,this.userSubscription=new H1,this.observedPartLoading=!0,this.observedPart=S.empty(),this.observedPartRS=new mee(1),this.observedPartObs=this.observedPartRS.asObservable(),this.authSubscription=this.connectedUserService.subscribeToUser(r=>{this.onUserUpdate(r)})}onUserUpdate(t){t===A8.NOT_CONNECTED?(this.authSubscription.unsubscribe(),this.observedPartRS.next(S.empty())):this.userSubscription=this.userDAO.subscribeToChanges(t.id,e=>{Se(e.isPresent(),"When observing part service, user was expected to already have a document!");const r=e.get();this.updateObservedPartWithDoc(r.observedPart)})}updateObservedPartWithDoc(t){const e=this.observedPart,r=null==t&&e.isAbsent(),s=null!=t&&e.equalsValue(t);(!1===r&&!1===s||this.observedPartLoading)&&(this.observedPartLoading=!1,this.observedPart=S.ofNullable(t),this.observedPartRS.next(this.observedPart))}updateObservedPart(t){if(Se(this.connectedUserService.user.isPresent(),"Should not call updateObservedPart when not connected"),this.observedPart.isPresent()){const r={...this.observedPart.get(),...t};return this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:r})}{const r=Object.keys({id:"id",role:"Candidate",typeGame:"P4"});for(const s of r)Se(null!=t[s],"field "+s+" should be set before updating observedPart");return this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:t})}}removeObservedPart(){return Se(this.connectedUserService.user.isPresent(),"Should not call removeObservedPart when not connected"),this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:null})}subscribeToObservedPart(t){return this.observedPartObs.subscribe(t)}canUserCreate(){if(this.observedPart.isAbsent())return G.SUCCESS;{const t=li.roleToMessage.get(this.observedPart.get().role).get()();return G.failure(t)}}canUserJoin(t,e){if(this.observedPart.isAbsent()||this.observedPart.get().id===t)return G.SUCCESS;if(e&&"Observer"===this.observedPart.get().role)return G.SUCCESS;{const r=li.roleToMessage.get(this.observedPart.get().role).get()();return G.failure(r)}}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}function nct(n,t){if(1&n&&(nn(0),de(1,27),rn()),2&n){const e=E(2);M(1),w1(e.observedPart.get().typeGame)(null==e.observedPart.get().opponent?null:e.observedPart.get().opponent.name),k1(1)}}function rct(n,t){if(1&n&&(nn(0),de(1,29),rn()),2&n){const e=E(3);M(1),w1(e.observedPart.get().typeGame)(null==e.observedPart.get().opponent?null:e.observedPart.get().opponent.name),k1(1)}}function sct(n,t){if(1&n&&(nn(0),de(1,30),rn()),2&n){const e=E(3);M(1),w1(e.observedPart.get().typeGame),k1(1)}}function ict(n,t){if(1&n&&(k(0,rct,2,2,"ng-container",23),k(1,sct,2,1,"ng-template",null,28,l1)),2&n){const e=s1(2);w("ngIf",E(2).observedPart.get().opponent)("ngIfElse",e)}}function oct(n,t){if(1&n){const e=we();N(0,"a",25),se("click",function(){return he(e),ce(E().navigateToPart())}),k(1,nct,2,2,"ng-container",23),k(2,ict,3,2,"ng-template",null,26,l1),A()}if(2&n){const e=s1(3),r=E();M(1),w("ngIf","Observer"===r.observedPart.get().role||"Candidate"===r.observedPart.get().role)("ngIfElse",e)}}function act(n,t){if(1&n&&(nn(0),X(1,"fa-icon",31),rn()),2&n){const e=E();M(1),w("icon",e.faSpinner)}}function cct(n,t){if(1&n){const e=we();nn(0),N(1,"div",9)(2,"a",33),Et(3),A(),N(4,"div",12)(5,"a",34),se("click",function(){return he(e),ce(E(2).logout())}),de(6,35),A()()(),rn()}if(2&n){const e=E(2);M(3),jn(e.username.get())}}li.roleToMessage=new Qn([{key:"Candidate",value:Ag.YOU_ARE_ALREADY_CANDIDATE},{key:"ChosenOpponent",value:Ag.YOU_ARE_ALREADY_CHOSEN_OPPONENT},{key:"Creator",value:Ag.YOU_ARE_ALREADY_CREATING},{key:"Player",value:Ag.YOU_ARE_ALREADY_PLAYING},{key:"Observer",value:Ag.YOU_ARE_ALREADY_OBSERVING}]),li.\u0275fac=function(t){return new(t||li)(xe(RM),xe(Es))},li.\u0275prov=Xe({token:li,factory:li.\u0275fac,providedIn:"root"});const lct=function(){return["/register"]},uct=function(){return["/login"]};function fct(n,t){1&n&&(N(0,"div",36)(1,"a",37)(2,"strong"),de(3,38),A()(),N(4,"a",39),de(5,40),A()()),2&n&&(M(1),w("routerLink",ar(2,lct)),M(3),w("routerLink",ar(3,uct)))}function hct(n,t){if(1&n&&(k(0,cct,7,1,"ng-container",23),k(1,fct,6,4,"ng-template",null,32,l1)),2&n){const e=s1(2);w("ngIf",E().username.isPresent())("ngIfElse",e)}}const Nae=function(){return["/"]},dct=function(){return["/play"]},pct=function(){return["/lobby"]},gct=function(){return["/local"]},mct=function(){return["/tutorial"]},_ct=function(){return["/settings"]};let vct=(()=>{class n{constructor(e,r,s,i){this.router=e,this.connectedUserService=r,this.observedPartService=s,this.userService=i,this.loading=!0,this.username=S.empty(),this.faCog=F2e,this.faSpinner=_oe,this.showMenu=!1,this.observedPart=S.empty()}ngOnInit(){this.userSubscription=this.connectedUserService.subscribeToUser(e=>{this.loading=!1,this.username=e.username.isPresent()?e.username:e.email}),this.observedPartSubscription=this.observedPartService.subscribeToObservedPart(e=>{this.observedPart=e})}logout(){var e=this;return O(function*(){yield e.connectedUserService.disconnect(),yield e.router.navigate(["/"])})()}navigateToPart(){var e=this;return O(function*(){return e.router.navigate(["/play",e.observedPart.get().typeGame,e.observedPart.get().id])})()}ngOnDestroy(){this.userSubscription.unsubscribe(),this.observedPartSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(Q($n),Q(Es),Q(li),Q(Ng))},n.\u0275cmp=vt({type:n,selectors:[["app-header"]],decls:36,vars:20,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,v,T,I;return t=$localize`Home`,e=$localize`Play online`,r=$localize`Create a game`,s=$localize`Join a game`,i=$localize`Play offline`,o=$localize`Create a game`,c=$localize`Learn the rules`,u=$localize`Settings`,h=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: by ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,g=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: against ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: (waiting for opponent)`,v=$localize`Log out`,T=$localize`Register`,I=$localize`Log in`,[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],t,[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],e,[1,"navbar-dropdown"],r,s,i,o,c,[1,"navbar-end"],["id","observedPartLink","class","navbar-item",3,"click",4,"ngIf"],["data-tooltip",u,1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],["id","observedPartLink",1,"navbar-item",3,"click"],["activeUser",""],h,["waitingForOpponent",""],g,m,[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","connectedUserName",1,"navbar-link"],["id","logout",1,"navbar-item",3,"click"],v,[1,"buttons"],[1,"button","is-primary",3,"routerLink"],T,[1,"button","is-light",3,"routerLink"],I]},template:function(e,r){if(1&e&&(N(0,"nav",0)(1,"div",1)(2,"a",2),X(3,"img",3),A(),N(4,"a",4),se("click",function(){return r.showMenu=!r.showMenu}),X(5,"span",5)(6,"span",5)(7,"span",5),A()(),N(8,"div",6),se("click",function(){return r.showMenu=!r.showMenu}),N(9,"div",7)(10,"a",2),de(11,8),A(),N(12,"div",9)(13,"a",10),de(14,11),A(),N(15,"div",12)(16,"a",2),de(17,13),A(),N(18,"a",2),de(19,14),A()()(),N(20,"div",9)(21,"a",10),de(22,15),A(),N(23,"div",12)(24,"a",2),de(25,16),A(),N(26,"a",2),de(27,17),A()()()(),N(28,"div",18),k(29,oct,4,2,"a",19),N(30,"a",20),X(31,"fa-icon",21),A(),N(32,"div",22),k(33,act,2,1,"ng-container",23),k(34,hct,3,2,"ng-template",null,24,l1),A()()()()),2&e){const s=s1(35);M(2),w("routerLink",ar(13,Nae)),M(2),w("ngClass",r.showMenu?"is-active":""),M(4),w("ngClass",r.showMenu?"is-active":""),M(2),w("routerLink",ar(14,Nae)),M(6),w("routerLink",ar(15,dct)),M(2),w("routerLink",ar(16,pct)),M(6),w("routerLink",ar(17,gct)),M(2),w("routerLink",ar(18,mct)),M(3),w("ngIf",r.observedPart.isPresent()),M(1),w("routerLink",ar(19,_ct)),M(1),w("icon",r.faCog),M(2),w("ngIf",r.loading)("ngIfElse",s)}},dependencies:[On,hn,Bu,If],encapsulation:2}),n})(),Cct=(()=>{class n{constructor(e,r){this._themeService=e,this._errorLoggerService=r,this.faTwitter=Yee,this.faFacebook=$ee,this.faGithub=Zee}}return n.\u0275fac=function(e){return new(e||n)(Q(HM),Q(ys))},n.\u0275cmp=vt({type:n,selectors:[["app-root"]],decls:18,vars:3,consts:function(){let t;return t=$localize`If you like ${"\ufffd#8\ufffd"}:START_TAG_STRONG:EveryBoard${"\ufffd/#8\ufffd"}:CLOSE_TAG_STRONG:, follow us!`,[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],t,["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoard"],["href","https://facebook.com/EveryBoard"]]},template:function(e,r){1&e&&(X(0,"app-header"),N(1,"main",0),X(2,"router-outlet"),A(),N(3,"footer",1)(4,"div",2)(5,"p")(6,"span"),$a(7,3),X(8,"strong"),Ua(),A(),Et(9," \xa0 "),N(10,"a",4),X(11,"fa-icon",5),A(),Et(12,"\xa0 "),N(13,"a",6),X(14,"fa-icon",5),A(),Et(15,"\xa0 "),N(16,"a",7),X(17,"fa-icon",5),A()()()()),2&e&&(M(11),w("icon",r.faGithub),M(3),w("icon",r.faTwitter),M(3),w("icon",r.faFacebook))},dependencies:[ZN,If,vct],encapsulation:2}),n})();class Un{constructor(t,e){this.x=t,this.y=e}equals(t){return this.x===t.x&&this.y===t.y}}class vV extends Un{isDown(){return 1===this.y}isUp(){return-1===this.y}isLeft(){return-1===this.x}isRight(){return 1===this.x}toInt(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}toString(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}class CV{of(t,e){for(const r of this.all)if(r.x===t&&r.y===e)return K.success(r);return K.failure("Invalid x and y in direction construction")}fromDelta(t,e){return 0===t&&0===e?K.failure("Empty delta for direction"):Math.abs(t)===Math.abs(e)||0===t||0===e?this.of(Math.sign(t),Math.sign(e)):K.failure(Mct.DIRECTION_MUST_BE_LINEAR())}fromMove(t,e){return this.fromDelta(e.x-t.x,e.y-t.y)}fromString(t){switch(t){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return K.failure(`Invalid direction string ${t}`)}}fromInt(t){switch(t){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return K.failure(`Invalid int direction: ${t}`)}}}class Pe extends vV{constructor(t,e){super(t,e)}isDiagonal(){return 0!==this.x&&0!==this.y}getOpposite(){return Pe.factory.of(-this.x,-this.y).get()}}Pe.UP=new Pe(0,-1),Pe.UP_RIGHT=new Pe(1,-1),Pe.RIGHT=new Pe(1,0),Pe.DOWN_RIGHT=new Pe(1,1),Pe.DOWN=new Pe(0,1),Pe.DOWN_LEFT=new Pe(-1,1),Pe.LEFT=new Pe(-1,0),Pe.UP_LEFT=new Pe(-1,-1),Pe.factory=new class extends CV{constructor(){super(...arguments),this.all=[Pe.UP,Pe.UP_RIGHT,Pe.RIGHT,Pe.DOWN_RIGHT,Pe.DOWN,Pe.DOWN_LEFT,Pe.LEFT,Pe.UP_LEFT]}},Pe.DIRECTIONS=Pe.factory.all,Pe.DIAGONALS=[Pe.UP_RIGHT,Pe.DOWN_RIGHT,Pe.DOWN_LEFT,Pe.UP_LEFT],Pe.ORTHOGONALS=[Pe.UP,Pe.RIGHT,Pe.DOWN,Pe.LEFT],Pe.encoder=new class yct extends u0{encode(t){return t.toString()}decode(t){return Se("string"==typeof t,"Invalid encoded direction"),Pe.factory.fromString(t).get()}};class De extends vV{constructor(t,e){super(t,e)}getOpposite(){return De.factory.of(-this.x,-this.y).get()}rotateClockwise(){return De.factory.of(-this.y,this.x).get()}}De.UP=new De(0,-1),De.RIGHT=new De(1,0),De.DOWN=new De(0,1),De.LEFT=new De(-1,0),De.factory=new class extends CV{constructor(){super(...arguments),this.all=[De.UP,De.RIGHT,De.DOWN,De.LEFT]}of(n,t){return 0===n&&-1===t?K.success(De.UP):1===n&&0===t?K.success(De.RIGHT):0===n&&1===t?K.success(De.DOWN):-1===n&&0===t?K.success(De.LEFT):K.failure("Invalid orthogonal from x and y")}},De.ORTHOGONALS=De.factory.all,De.encoder=new class Ect extends u0{encode(t){return t.toString()}decode(t){return Se("string"==typeof t,"Invalid encoded orthogonal"),De.factory.fromString(t).get()}};class Aae extends on{maxValue(){return 3}encodeNumber(t){return t===De.UP?0:t===De.RIGHT?1:t===De.DOWN?2:3}decodeNumber(t){switch(t){case 0:return De.UP;case 1:return De.RIGHT;case 2:return De.DOWN;default:return Ae.expectToBe(t,3,`Encoded orthogonal should be 3 for LEFT but got ${t} instead`),De.LEFT}}}let Mct=(()=>{class n{}return n.DIRECTION_MUST_BE_LINEAR=()=>$localize`You must move in a straight line! You can only move orthogonally or diagonally!`,n})();class P{constructor(t,e){this.x=t,this.y=e}static numberEncoder(t,e){return on.tuple([on.numberEncoder(t),on.numberEncoder(e)],r=>[r.x,r.y],r=>new P(r[0],r[1]))}getNext(t,e){return new P(this.x+(e=e??1)*t.x,this.y+e*t.y)}getPrevious(t,e){return this.getNext(t,-(e=e??1))}getLeft(t){return new P(this.x+t.y,this.y+-t.x)}getRight(t){return new P(this.x+-t.y,this.y+t.x)}getOpposite(){return new P(-this.x,-this.y)}isInRange(t,e){return!(this.x<0||this.y<0||this.x>=t||this.y>=e)}isNotInRange(t,e){return this.x<0||this.y<0||this.x>=t||this.y>=e}getDirectionToward(t){return Pe.factory.fromMove(this,t)}getOrthogonalDistance(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}getDistance(t){if(!t.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");const e=Math.abs(t.x-this.x),r=Math.abs(t.y-this.y);return Math.max(e,r)}isHexagonallyAlignedWith(t){const e=this.x-t.x,r=this.y-t.y;return e!==r&&(e===-r||e*r==0)}isAlignedWith(t){const e=Math.abs(this.x-t.x),r=Math.abs(this.y-t.y);return e===r||e*r==0}getVectorToward(t){return new P(t.x-this.x,t.y-this.y)}getMinimalVectorToward(t){return this.getVectorToward(t).toVector()}getCoordsToward(t){if(t.equals(this))return[];if(!t.isAlignedWith(this))return[];const e=this.getDirectionToward(t).get();let r=this.getNext(e,1);const s=[];for(;!1===r.equals(t);)s.push(r),r=r.getNext(e,1);return s}toVector(){const t=Math.abs(this.x),e=Math.abs(this.y),r=Math.max(t,e);let s=this.x,i=this.y,o=2;for(;o<=r;)s%o==0&&i%o==0?(s/=o,i/=o):o++;return new P(s,i)}isBetween(t,e){const r=t.getMinimalVectorToward(this),s=e.getMinimalVectorToward(this);return r.equals(s.getOpposite())}getUntil(t){const e=[],r=this.getDirectionToward(t).get();let s=this.getNext(r);for(;!1===s.equals(t);)e.push(s),s=s.getNext(r);return e}equals(t){return this===t||t.x===this.x&&t.y===this.y}compareTo(t){return t.y===this.y?t.x===this.x?0:this.x<t.x?-1:1:this.y<t.y?-1:1}toString(){return"("+this.x+", "+this.y+")"}}P.encoder=new class extends u0{encode(n){return{x:n.x,y:n.y}}decode(n){const t=n;return Se(null!=t.x&&"number"==typeof t.x&&null!=t.y&&"number"==typeof t.y,"Invalid encoded coord"),new P(t.x,t.y)}};let m0=(()=>{class n{constructor(e){this.messageDisplayer=e,this.Player=F,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.scores=S.empty(),this.imagesLocation="assets/images/",this.hasAsymetricBoard=!1,this.rotation=""}message(e){this.messageDisplayer.gameMessage(e)}cancelMove(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?G.SUCCESS:(this.messageDisplayer.gameMessage(e),G.failure(e))}cancelMoveAttempt(){}getPlayerClass(e){switch(e){case F.ZERO:return"player0-fill";case F.ONE:return"player1-fill";default:return Ae.expectToBe(e,fe.NONE),""}}pass(){var e=this;return O(function*(){return ys.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name})})()}getTurn(){return this.rules.node.gameState.turn}getCurrentPlayer(){return this.rules.node.gameState.getCurrentPlayer()}getState(){return this.rules.node.gameState}getPreviousState(){return this.rules.node.mother.get().gameState}range(e){const r=[];for(let s=0;s<e;s++)r.push(s);return r}}return n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,r){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Zg=(()=>{class n extends m0{getHexaCoordsBy(e,r){const s=new P(e,r);return this.getHexaCoordsAt(s)}getHexaCoordsAt(e){let r="";const s=this.hexaLayout.getHexaCoordsAt(e);for(const i of s)r+=i.x+" "+i.y+" ";return r+=s[0].x+" "+s[0].y,r}getCenterBy(e,r){const s=new P(e,r);return this.getCenterAt(s)}getCenterAt(e){return this.hexaLayout.getCenterAt(e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=es(n)))(r||n)}}(),n.\u0275cmp=vt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();class be{constructor(t){this.value=t}static from(t){switch(t){case be.ZERO.value:return be.ZERO;case be.ONE.value:return be.ONE;case be.EMPTY.value:return be.EMPTY;case be.UNREACHABLE.value:return be.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+t)}}static ofPlayer(t){return t===F.ZERO?be.ZERO:(Ae.expectToBe(t,F.ONE),be.ONE)}equals(t){return this===t}is(t){return this.value===t.value}isPlayer(){return this===be.ZERO||this===be.ONE}}be.ZERO=new be(F.ZERO.value),be.ONE=new be(F.ONE.value),be.EMPTY=new be(fe.NONE.value),be.UNREACHABLE=new be(3);class Ie extends vV{constructor(t,e){super(t,e)}static getAngle(t){switch(t){case Ie.UP:return 0;case Ie.UP_RIGHT:return 60;case Ie.RIGHT:return 120;case Ie.DOWN:return 180;case Ie.DOWN_LEFT:return 240;default:return Ae.expectToBe(t,Ie.LEFT),300}}getOpposite(){return Ie.factory.of(-this.x,-this.y).get()}}Ie.UP=new Ie(0,-1),Ie.LEFT=new Ie(-1,0),Ie.UP_RIGHT=new Ie(1,-1),Ie.DOWN_LEFT=new Ie(-1,1),Ie.RIGHT=new Ie(1,0),Ie.DOWN=new Ie(0,1),Ie.factory=new class extends CV{constructor(){super(...arguments),this.all=[Ie.UP,Ie.UP_RIGHT,Ie.RIGHT,Ie.DOWN,Ie.DOWN_LEFT,Ie.LEFT]}},Ie.encoder=new class Sct extends on{maxValue(){return 5}encodeNumber(t){switch(t){case Ie.UP:return 0;case Ie.UP_RIGHT:return 1;case Ie.RIGHT:return 2;case Ie.DOWN:return 3;case Ie.DOWN_LEFT:return 4;default:return 5}}decodeNumber(t){return Se(0<=t&&t<=5,"Invalid encoded number for HexaDirection "+t),Ie.factory.all[t]}};class Yg{constructor(t,e,r){this.size=t,this.origin=e,this.orientation=r}getCenterAt(t){const e=this.orientation.conversionMatrix;return new P(this.size*(e[0]*t.x+e[1]*t.y)+this.origin.x,this.size*(e[2]*t.x+e[3]*t.y)+this.origin.y)}getCornerOffset(t){const e=2*Math.PI*(this.orientation.startAngle+t)/6;return new P(this.size*Math.cos(e),this.size*Math.sin(e))}getHexaCoordsAt(t){const e=this.getCenterAt(t),r=[];for(let s=0;s<6;s+=1){const i=this.getCornerOffset(s);r.push(new P(e.x+i.x,e.y+i.y))}return r}}class Oae{}class ES extends Oae{constructor(){super(),this.startAngle=.5,this.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],this.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3]}}ES.INSTANCE=new ES;class o2 extends Oae{constructor(){super(),this.startAngle=0,this.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],this.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3]}isOnBorder(t,e){return this.isOnTopRightBorder(t,e)||this.isOnRightBorder(t,e)||this.isOnBottomRightBorder(t,e)||this.isOnBottomLeftBorder(t,e)||this.isOnLeftBorder(t,e)||this.isOnTopLeftBorder(t,e)}isOnTopRightBorder(t,e){return 0===e.y}isOnRightBorder(t,e){return e.x===t.width-1}isOnLeftBorder(t,e){return 0===e.x}isOnBottomLeftBorder(t,e){return e.y===t.height-1}isOnTopLeftBorder(t,e){return null!=t.excludedSpaces[e.y]?e.x===t.excludedSpaces[e.y]:e.y===t.excludedSpaces.length&&0===e.x}isOnBottomRightBorder(t,e){return null!=t.excludedSpaces[t.height-1-e.y]?t.width-1-e.x===t.excludedSpaces[t.height-1-e.y]:t.height-1-e.y===t.excludedSpaces.length&&e.x===t.width-1}getAllBorders(t){const e=[];return t.forEachCoord((r,s)=>{this.isOnBorder(t,r)&&e.push(r)}),e}isTopCorner(t,e){return this.isOnTopLeftBorder(t,e)&&this.isOnTopRightBorder(t,e)}isTopLeftCorner(t,e){return this.isOnTopLeftBorder(t,e)&&this.isOnLeftBorder(t,e)}isTopRightCorner(t,e){return this.isOnTopRightBorder(t,e)&&this.isOnRightBorder(t,e)}isBottomCorner(t,e){return this.isOnBottomLeftBorder(t,e)&&this.isOnBottomRightBorder(t,e)}isBottomLeftCorner(t,e){return this.isOnBottomLeftBorder(t,e)&&this.isOnLeftBorder(t,e)}isBottomRightCorner(t,e){return this.isOnBottomRightBorder(t,e)&&this.isOnRightBorder(t,e)}}o2.INSTANCE=new o2;let Mt=(()=>{class n{}return n.CANNOT_CHOOSE_OPPONENT_PIECE=()=>$localize`You cannot pick a piece of the opponent.`,n.MUST_CLICK_ON_EMPTY_SPACE=()=>$localize`You must click on an empty space.`,n.MUST_CLICK_ON_EMPTY_SQUARE=()=>$localize`You must click on an empty square.`,n.CANNOT_SELF_CAPTURE=()=>$localize`Your landing space should be empty or contain a piece of the opponent.`,n.MUST_CHOOSE_PLAYER_PIECE=()=>$localize`You must pick one of your pieces.`,n.CANNOT_PASS=()=>$localize`You cannot pass your turn.`,n.MUST_LAND_ON_EMPTY_SPACE=()=>$localize`You must drop your piece on an empty space.`,n.MUST_PASS=()=>$localize`You must pass your turn.`,n.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=()=>$localize`You have selected an empty space, you must select one of your own pieces.`,n.MOVE_CANNOT_BE_STATIC=()=>$localize`You must choose different starting and ending coordinates.`,n.SOMETHING_IN_THE_WAY=()=>$localize`There is a piece between the piece you chose and its landing space.`,n})();class rr{constructor(t,e){this.ruler=t,this.name=e}toString(){return this.name}}class dt{constructor(t){this.value=t}static fromWinner(t){return t.isPlayer()?new dt(t.getVictoryValue()):new dt(0)}toString(){return""+this.value}}class MS{constructor(t){this.turn=t}getCurrentPlayer(){return F.fromTurn(this.turn)}getCurrentOpponent(){return this.turn%2==1?F.ZERO:F.ONE}}class Vs extends MS{constructor(t,e){super(e),this.board=t}getPieceAt(t){if(this.isOnBoard(t))return this.board[t.y][t.x];throw new Error("Accessing coord not on board "+t+".")}tryToGetPieceAt(t){return this.isOnBoard(t)?S.of(this.board[t.y][t.x]):S.empty()}isOnBoard(t){return t.isInRange(this.board[0].length,this.board.length)}getPieceAtXY(t,e){return this.getPieceAt(new P(t,e))}forEachCoord(t){for(const[e,r]of this.getCoordsAndContents())t(e,r)}getCoordsAndContents(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[e].length;r++){const s=new P(r,e);this.isOnBoard(s)&&t.push([s,this.getPieceAt(s)])}return t}getCopiedBoard(){return ht.copyBiArray(this.board)}}class Pl extends Vs{static getInitialState(){const t=be.EMPTY,e=be.UNREACHABLE,r=be.ZERO,s=be.ONE;return new Pl([[e,e,e,e,s,s,s,s,s],[e,e,e,s,s,s,s,s,s],[e,e,t,t,s,s,s,t,t],[e,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,e],[t,t,r,r,r,t,t,e,e],[r,r,r,r,r,r,e,e,e],[r,r,r,r,r,e,e,e,e]],0)}isInBoard(t){return t.isInRange(9,9)&&this.getPieceAt(t)!==be.UNREACHABLE}isPiece(t){return this.getPieceAt(t).isPlayer()}getScores(){const t=[14,14];for(let e=0;e<9;e++)for(let r=0;r<9;r++)this.getPieceAtXY(r,e)===be.ZERO&&(t[1]=t[1]-1),this.getPieceAtXY(r,e)===be.ONE&&(t[0]=t[0]-1);return t}}class so{}class Yc extends so{constructor(t,e){super(),this.coord=new P(t,e)}}class a2 extends Yc{constructor(t,e,r){if(super(t.x,t.y),this.dir=e,this.lastPiece=r,t.isNotInRange(9,9))throw new Error("Coord "+t.toString()+" out of range, invalid move!")}static fromSingleCoord(t,e){try{return K.success(new a2(t,e,S.empty()))}catch(r){return K.failure(r.message)}}static fromDoubleCoord(t,e,r){const s=[t,e];ht.sortByDescending(s,a2.sortCoord);const i=s[1].getDirectionToward(s[0]).get(),o=Ie.factory.fromDelta(i.x,i.y);if(o.isFailure())return K.failure("Invalid direction");const c=o.get();return s[1].getDistance(s[0])>2?K.failure("Distance between first coord and last coord is too great"):c.equals(r)?a2.fromSingleCoord(s[1],r):c.getOpposite().equals(r)?a2.fromSingleCoord(s[0],r):K.success(new a2(s[1],r,S.of(s[0])))}static sortCoord(t){return 9*t.y+t.x}toString(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}isSingleCoord(){return this.lastPiece.isAbsent()}equals(t){return t.coord.equals(this.coord)&&t.dir.equals(this.dir)&&t.lastPiece.equals(this.lastPiece)}}a2.encoder=new class extends on{maxValue(){return 104831}encodeNumber(n){const t=9*n.coord.x*8+8*n.coord.y+n.dir.toInt();if(n.isSingleCoord())return t;{const e=n.lastPiece.get();return 9*e.x*2*9*9*8+2*e.y*9*9*8+648+t}}decodeNumber(n){const t=n%8;n=(n-t)/8;const r=Ie.factory.fromInt(t).get(),s=n%9,i=(n=(n-s)/9)%9;n=(n-i)/9;const o=new P(i,s);if(0===n)return a2.fromSingleCoord(o,r).get();{const c=(n=(n-1)/2)%9,u=(n=(n-c)/9)%9;n=(n-u)/9;const h=new P(u,c);return a2.fromDoubleCoord(o,h,r).get()}}};var Mn=(()=>(function(n){n.VICTORY="VICTORY",n.PRE_VICTORY="PRE_VICTORY",n.DEFAULT="DEFAULT"}(Mn||(Mn={})),Mn))();let SS=(()=>{class n{}return n.createdNodes=0,n.minimaxTime=0,n})();class fr{constructor(t,e=S.empty(),r=S.empty(),s){if(this.gameState=t,this.mother=e,this.move=r,this.minimaxCreator=s,this.childs=S.empty(),this.hopedValue=new Qn,this.ownValue=new Qn,this.possibleMoves=new Qn,this.ownValue=new Qn,null!=s){const o=s.getBoardValue(this);this.ownValue.set(s.name,o),this.hopedValue.set(s.name,o.value)}SS.createdNodes++,Y(fr.VERBOSE||!1,"creating "+this.myToString())}static getScoreStatus(t){return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER?(Y(fr.VERBOSE||!1,"VICTORY"),Mn.VICTORY):t===Number.MIN_SAFE_INTEGER+1?(Y(fr.VERBOSE||!1,"PRE_VICTORY_MIN"),Mn.PRE_VICTORY):t===Number.MAX_SAFE_INTEGER-1?(Y(fr.VERBOSE||!1,"PRE_VICTORY_MAX"),Mn.PRE_VICTORY):(Y(fr.VERBOSE||!1,"DEFAULT"),Mn.DEFAULT)}findBestMove(t,e,r=!1,s=!0){const i=(new Date).getTime();let o=this.alphaBeta(t,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,e,r,s);for(;o.gameState.turn>this.gameState.turn+1;)o=o.mother.get(),t--;return SS.minimaxTime+=(new Date).getTime()-i,o.move.get()}alphaBeta(t,e,r,s,i,o){if(t<1)return Y(fr.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+t),this;if(s.ruler.getGameStatus(this).isEndGame)return Y(fr.VERBOSE||!1,"isLeaf-EndGame("+fr.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+t),this;const u=this.getPossibleMoves(s);Se(u.size()>0,"Minimax "+s.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=S.of([]));const h=this.getBestChilds(u,t,e,r,s,i,o),g=this.getBestChildAmongst(h,i),m=g.hopedValue.get(s.toString()).get();return this.hopedValue.put(s.toString(),m),g}getPossibleMoves(t){const e=this.possibleMoves.get(t.name);if(e.isAbsent()){const r=t.getListMoves(this);return this.possibleMoves.set(t.name,new Z1(r)),new Z1(r)}return e.get()}getBestChilds(t,e,r,s,i,o,c){let u=[];const h=this.gameState.getCurrentPlayer();let g=h===F.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER;const m=h===F.ZERO?(v,T)=>v<T:(v,T)=>v>T;for(const v of t){const I=this.getOrCreateChild(v,i).alphaBeta(e-1,r,s,i,o,c),z=I.getHopedValue(i);if(m(z,g)||0===u.length?(g=z,u=[I]):z===g&&u.push(I),c&&m(g,h===F.ZERO?r:s))break;h===F.ZERO?s=Math.min(g,s):r=Math.max(g,r)}return u}getBestChildAmongst(t,e){return e?t[Math.floor(Math.random()*t.length)]:t[0]}getOrCreateChild(t,e){let r=this.getSonByMove(t);if(r.isAbsent()){const s=e.ruler.isLegal(t,this.gameState),i=t.toString();Se(s.isSuccess(),'The minimax "'+e.name+'" has proposed an illegal move ('+i+"), this should not happen.");const o=e.ruler.applyLegalMove(t,this.gameState,s.get());r=S.of(new fr(o,S.of(this),S.of(t),e)),this.childs.get().push(r.get())}return r.get()}getSonByMove(t){Se(this.childs.isPresent(),"Cannot get son of uncalculated node");for(const e of this.childs.get())if(e.move.isPresent()&&e.move.equalsValue(t))return S.of(e);return S.empty()}getHopedValue(t){return this.hopedValue.get(t.name).get()}getOwnValue(t){const e=this.ownValue.get(t.name);if(e.isAbsent()){const r=t.getBoardValue(this);return this.ownValue.set(t.name,r),r}return e.get()}myToString(){let t="",e=this;if(e.mother.isAbsent())return"NodeInitial: "+e.gameState.turn;for(;e.mother.isPresent();)t=(e.move.isAbsent()?" ":" > "+e.move.get().toString()+"> ")+e.gameState.turn+" "+t,e=e.mother.get();return"Node: "+t}hasMoves(){return this.childs.isPresent()}countDescendants(){if(this.childs.isAbsent())return 0;let t=this.childs.get().length;for(const e of this.childs.get())t+=e.countDescendants();return t}}fr.VERBOSE=!1,fr.minimaxes=new Qn;class ze{constructor(t,e){this.isEndGame=t,this.winner=e}static getVictory(t){return t===F.ZERO?ze.ZERO_WON:ze.ONE_WON}static getDefeat(t){return t===F.ZERO?ze.ONE_WON:ze.ZERO_WON}toBoardValue(){return this.winner.isPlayer()?this.winner.getVictoryValue():0}}ze.ZERO_WON=new ze(!0,F.ZERO),ze.ONE_WON=new ze(!0,F.ONE),ze.DRAW=new ze(!0,fe.NONE),ze.ONGOING=new ze(!1,fe.NONE);class hr{constructor(t){this.stateType=t,this.setInitialBoard()}choose(t){Y(!1,"Rules.choose: "+t.toString()+" was proposed");const r=this.isLegal(t,this.node.gameState);if(this.node.hasMoves()){Y(!1,"Rules.choose: current node has moves");const o=this.node.getSonByMove(t);if(o.isPresent())return Se(r.isSuccess(),"Rules.choose: Move is illegal: "+r.getReasonOr("")),Y(!1,"Rules.choose: and this proposed move is found in the list, so it is legal"),this.node=o.get(),!0}if(Y(!1,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),r.isFailure())return Y(!1,"Rules.choose: Move is illegal: "+r.getReason()),!1;Y(!1,"Rules.choose: Move is legal, let's apply it");const s=this.applyLegalMove(t,this.node.gameState,r.get()),i=new fr(s,S.of(this.node),S.of(t));return this.node=i,!0}setInitialBoard(){const t=this.stateType.getInitialState();fr.ruler=this,this.node=new fr(t)}applyMoves(t,e,r){let s=0;for(const i of t){const o=r(i),c=this.isLegal(o,e);Se(c.isSuccess(),"Can't create state from invalid moves ("+s+"): "+c.toString()+"."),e=this.applyLegalMove(o,e,c.get()),s++}return e}}let _0=(()=>{class n{}return n.CANNOT_MOVE_MORE_THAN_THREE_PIECES=()=>$localize`You cannot move more than 3 of your pieces!`,n.NOT_ENOUGH_PIECE_TO_PUSH=()=>$localize`You don't have enough pieces to push that group!`,n.CANNOT_PUSH_YOUR_OWN_PIECES=()=>$localize`You cannot push this piece because it is blocked by one of yours!`,n.MUST_ONLY_TRANSLATE_YOUR_PIECES=()=>$localize`This line contains pieces of your opponent or empty spaces, which is forbidden.`,n.TRANSLATION_IMPOSSIBLE=()=>$localize`This move is impossible, some landing spaces are occupied.`,n.LINE_AND_COORD_NOT_ALIGNED=()=>$localize`This space is not aligned with the current line.`,n})();class Kc extends hr{static isLegal(t,e){const r=this.getFirstPieceValidity(t,e);return r.isFailure()?r.toFailedFallible():t.isSingleCoord()?Kc.isLegalPush(t,e):Kc.isLegalSideStep(t,e)}static getFirstPieceValidity(t,e){const r=e.getPieceAt(t.coord);return!1===e.isPiece(t.coord)?G.failure(Mt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):r===be.ofPlayer(e.getCurrentOpponent())?G.failure(Mt.CANNOT_CHOOSE_OPPONENT_PIECE()):G.SUCCESS}static isLegalPush(t,e){let r=1,s=t.coord.getNext(t.dir);const i=be.ofPlayer(e.getCurrentPlayer()),o=be.EMPTY,c=e.getCopiedBoard();for(c[t.coord.y][t.coord.x]=o;r<=3&&e.isOnBoard(s)&&e.getPieceAt(s)===i;)r++,s=s.getNext(t.dir);return r>3?K.failure(_0.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===e.isInBoard(s)||(c[s.y][s.x]=i,e.getPieceAt(s)===o)?K.success(c):Kc.isLegalRealPush(s,t,e,r,c)}static isLegalRealPush(t,e,r,s,i){let o=0;const c=be.ofPlayer(r.getCurrentOpponent()),u=be.ofPlayer(r.getCurrentPlayer());for(;o<s&&r.isOnBoard(t)&&r.getPieceAt(t)===c;)o++,t=t.getNext(e.dir);return o>=s?K.failure(_0.NOT_ENOUGH_PIECE_TO_PUSH()):t.isInRange(9,9)&&(r.getPieceAt(t)===be.EMPTY&&(i[t.y][t.x]=c),r.getPieceAt(t)===u)?K.failure(_0.CANNOT_PUSH_YOUR_OWN_PIECES()):K.success(i)}static isLegalSideStep(t,e){let r=t.lastPiece.get();const s=t.coord.getDirectionToward(r).get();r=r.getNext(s);let i=t.coord;const o=be.ofPlayer(e.getCurrentPlayer()),c=e.getCopiedBoard();for(;!1===i.equals(r)&&i.isInRange(9,9);){if(e.getPieceAt(i)!==o)return K.failure(_0.MUST_ONLY_TRANSLATE_YOUR_PIECES());const u=i.getNext(t.dir);if(c[i.y][i.x]=be.EMPTY,u.isInRange(9,9)){if(e.isPiece(u))return K.failure(_0.TRANSLATION_IMPOSSIBLE());e.getPieceAt(u)===be.EMPTY&&(c[u.y][u.x]=o)}i=i.getNext(s)}return K.success(c)}static getGameStatus(t){const e=t.gameState.getScores();return e[0]>5?ze.ZERO_WON:e[1]>5?ze.ONE_WON:ze.ONGOING}applyLegalMove(t,e,r){return new Pl(r,e.turn+1)}isLegal(t,e){return Kc.isLegal(t,e)}getGameStatus(t){return Kc.getGameStatus(t)}}class Tct extends rr{getListMoves(t){const e=[],r=t.gameState,s=r.getCurrentPlayer();for(let i=0;i<9;i++)for(let o=0;o<9;o++){const c=new P(o,i);if(!1!==r.getPieceAt(c).is(s))for(const u of Ie.factory.all){const h=a2.fromSingleCoord(c,u).get();if(this.isAcceptablePush(h,r)){e.push(h);for(const g of Ie.factory.all)for(let m=1;m<=2&&!g.equals(u);m++){const v=c.getNext(g,m);if(!v.isInRange(9,9))break;{const T=a2.fromDoubleCoord(c,v,u).get();Kc.isLegal(T,r).isSuccess()&&e.push(T)}}}}}return new Z1(e).toList()}isAcceptablePush(t,e){const r=e.getScores(),s=Kc.isLegal(t,e);if(s.isSuccess()){const i=e.getCurrentOpponent().value;return!(new Pl(s.get(),e.turn+1).getScores()[i]>r[i])}return!1}getBoardValue(t){const e=Kc.getGameStatus(t);if(e.isEndGame)return new dt(e.toBoardValue());const r=t.gameState.getScores();return new dt(r[1]-r[0])}}class pe{constructor(t,e,r){this.title=t,this.instruction=e,this.state=r,this.previousMove=S.empty(),this.previousState=S.empty()}static fromMove(t,e,r,s,i,o){return new wct(t,e,r,s,i,o)}static forClick(t,e,r,s,i,o){return new Nct(t,e,r,s,i,o)}static anyMove(t,e,r,s,i){return new bct(t,e,r,s,i)}static fromPredicate(t,e,r,s,i,o){return new Act(t,e,r,s,i,o)}static informational(t,e,r){return new Oct(t,e,r)}isMove(){return!1}isAnyMove(){return!1}isClick(){return!1}isPredicate(){return!1}isInformation(){return!1}hasSolution(){return!1}withPreviousMove(t){return this.previousMove=S.of(t),this}withPreviousState(t){return this.previousState=S.of(t),this}}class PS extends pe{constructor(t,e,r,s){super(t,e,r),this.successMessage=s}hasSolution(){return!0}getSuccessMessage(){return this.successMessage}}class wct extends PS{constructor(t,e,r,s,i,o){super(t,e,r,i),this.acceptedMoves=s,this.failureMessage=o,Se(s.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational")}isMove(){return!0}getSolution(){return this.acceptedMoves[0]}getFailureMessage(){return this.failureMessage}}class bct extends PS{constructor(t,e,r,s,i){super(t,e,r,i),this.solutionMove=s}getSolution(){return this.solutionMove}isAnyMove(){return!0}}class Nct extends PS{constructor(t,e,r,s,i,o){super(t,e,r,i),this.acceptedClicks=s,this.failureMessage=o}isClick(){return!0}getSolution(){return this.acceptedClicks[0]}getFailureMessage(){return this.failureMessage}}class Act extends PS{constructor(t,e,r,s,i,o){super(t,e,r,o),this.solutionMove=s,this.predicate=i}getSolution(){return this.solutionMove}isPredicate(){return!0}}class Oct extends pe{isInformation(){return!0}}class Pr{}const vn=be.EMPTY,Hs=be.UNREACHABLE,ec=be.ZERO,xf=be.ONE;class Iae extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Initial board and goal of the game`,$localize`At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!`,Pl.getInitialState()),pe.anyMove($localize`Moving a piece`,$localize`At each turn, move one, two, or three pieces either along their line, or on their side.
        For your moves you can therefore choose between up to 6 directions.
        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).
        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>
        You're playing Dark, make any move!`,Pl.getInitialState(),a2.fromSingleCoord(new P(2,6),Ie.UP).get(),$localize`Congratulations!`),pe.fromMove($localize`Pushing`,$localize`To push one opponent piece, you must move at least two of your pieces.
        To push two opponent pieces, you must move three of your pieces.
        If one of your pieces is in the way, it will be impossible to push.
        You cannot move more than three pieces.<br/><br/>
        Only one push towards the right is possible here, find it. (You're playing Dark).`,new Pl([[Hs,Hs,Hs,Hs,vn,ec,ec,xf,xf],[Hs,Hs,Hs,vn,vn,vn,vn,vn,vn],[Hs,Hs,vn,ec,ec,ec,xf,ec,vn],[Hs,vn,vn,vn,vn,vn,vn,vn,vn],[vn,vn,vn,vn,ec,ec,ec,xf,xf],[vn,vn,vn,vn,vn,vn,vn,vn,Hs],[vn,vn,vn,vn,ec,xf,vn,Hs,Hs],[vn,vn,vn,ec,vn,vn,Hs,Hs,Hs],[vn,vn,ec,vn,vn,Hs,Hs,Hs,Hs]],0),[a2.fromSingleCoord(new P(4,4),Ie.RIGHT).get()],$localize`Congratulations! You know everything you need to start a game!`,$localize`Failed!`)]}}function Ict(n,t){if(1&n){const e=we();B(),N(0,"circle",6),se("click",function(){he(e);const s=E(2).index,i=E().index;return ce(E().onPieceClick(s,i))}),A()}if(2&n){const e=E(2).index,r=E().index,s=E();je("id","piece_",e,"_",r,""),w("ngClass",s.getPieceClasses(e,r)),V("cx",s.getCenterBy(e,r).x)("cy",s.getCenterBy(e,r).y)("r",.5*s.SPACE_SIZE)}}function xct(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"polygon",4),se("click",function(){he(e);const s=E().index,i=E().index;return ce(E().onSpaceClick(s,i))}),A(),k(2,Ict,1,6,"circle",5),A()}if(2&n){const e=E(),r=e.index,s=e.$implicit,i=E().index,o=E();M(1),je("id","space_",r,"_",i,""),w("ngClass",o.getSquareClasses(r,i)),V("points",o.getHexaCoordsBy(r,i)),M(1),w("ngIf",o.isPiece(s))}}function Lct(n,t){if(1&n&&(B(),N(0,"g"),k(1,xct,3,5,"g",3),A()),2&n){const e=t.$implicit,r=E(2);M(1),w("ngIf",r.isBoard(e))}}function kct(n,t){if(1&n&&(B(),N(0,"g"),k(1,Lct,2,1,"g",1),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}function Rct(n,t){1&n&&(B(),N(0,"marker",7),X(1,"polygon",8),A()),2&n&&L1("id","arrowhead_",t.$implicit.dir.toString(),"")}function Dct(n,t){if(1&n){const e=we();B(),N(0,"g"),X(1,"line",9),N(2,"line",10),se("click",function(){const i=he(e).$implicit;return ce(E().chooseDirection(i.dir))}),A(),N(3,"polygon",11),se("click",function(){const i=he(e).$implicit;return ce(E().chooseDirection(i.dir))}),A()()}if(2&n){const e=t.$implicit;M(1),L1("id","line_start_",e.dir.toString(),""),V("x1",e.startCenter.x)("y1",e.startCenter.y)("x2",e.middle.x)("y2",e.middle.y),M(1),L1("id","line_end_",e.dir.toString(),""),V("x1",e.middle.x)("y1",e.middle.y)("x2",e.landingCenter.x)("y2",e.landingCenter.y),M(1),L1("id","direction_",e.dir.toString(),""),V("transform",e.transformation)}}class zct{constructor(t,e,r,s,i,o){this.startCenter=t,this.middle=e,this.landingCenter=r,this.landing=s,this.dir=i,this.transformation=o}}let Vct=(()=>{class n extends Zg{constructor(e){super(e),this.moveds=[],this.directions=[],this.selecteds=[],this.rules=new Kc(Pl),this.availableMinimaxes=[new Tct(this.rules,"Dummy")],this.encoder=a2.encoder,this.tutorial=(new Iae).tutorial,this.scores=S.of([0,0]),this.SPACE_SIZE=30,this.hexaLayout=new Yg(this.SPACE_SIZE,new P(-8*this.SPACE_SIZE,2*this.SPACE_SIZE),ES.INSTANCE),this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.hexaBoard=this.getState().getCopiedBoard(),this.scores=S.of(this.getState().getScores())}hidePreviousMove(){this.moveds=[]}cancelMoveAttempt(){this.directions=[],this.selecteds=[]}showPreviousMove(){const e=this.rules.node.move.get();e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}showPushingMove(e){const r=this.rules.node.mother.get().gameState;let s=e.coord;for(this.moveds=[s],s=s.getNext(e.dir);s.isInRange(9,9)&&r.isPiece(s);)this.moveds.push(s),s=s.getNext(e.dir);s.isInRange(9,9)&&this.moveds.push(s)}showSideStepMove(e){let r=e.lastPiece.get();const s=e.coord.getDirectionToward(r).get();r=r.getNext(s);let i=e.coord;for(;!1===i.equals(r);)this.moveds.push(i),this.moveds.push(i.getNext(e.dir)),i=i.getNext(s)}onPieceClick(e,r){var s=this;return O(function*(){const i=s.canUserPlay("#piece_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState().getCurrentOpponent();return s.hexaBoard[r][e].is(o)?s.opponentClick(e,r):0===s.selecteds.length?s.firstClick(e,r):1===s.selecteds.length?s.secondClick(e,r):s.thirdClick(e,r)})()}opponentClick(e,r){var s=this;return O(function*(){return(yield s.tryChoosingDirection(e,r)).isSuccess()?G.SUCCESS:s.cancelMove(Mt.CANNOT_CHOOSE_OPPONENT_PIECE())})()}firstClick(e,r){var s=this;return O(function*(){return s.selecteds=[new P(e,r)],s.showPossibleDirections(),G.SUCCESS})()}showPossibleDirections(){this.directions=[],this.showDirection(1===this.selecteds.length)}showDirection(e){const r=this.getState(),s=be.ofPlayer(r.getCurrentPlayer()),i=this.selecteds[0],o=this.selecteds[this.selecteds.length-1];for(const c of Ie.factory.all){let h,u=i.getNext(c,1);if(r.isOnBoard(u)&&r.getPieceAt(u)===s){if(e)continue;if(u=o.getNext(c,1),r.isOnBoard(u)&&r.getPieceAt(u)===s)continue}if(h=e?a2.fromSingleCoord(i,c).get():a2.fromDoubleCoord(i,o,c).get(),this.rules.isLegal(h,r).isSuccess()){const m=this.getCenterAt(i),v=this.getCenterAt(u),T=this.getMiddleOfArrow(c,u,v),I=v.x+" "+v.y,z=Ie.getAngle(c)+150,J=new zct(m,T,v,u,c,"rotate("+z+" "+I+") translate("+I+")");this.directions.push(J)}}}getMiddleOfArrow(e,r,s){const i=r.getPrevious(e),o=this.getCenterAt(i);return new P(o.x+(s.x-o.x)/2,o.y+(s.y-o.y)/2)}isBoard(e){return e!==be.UNREACHABLE}isPiece(e){return e!==be.EMPTY}secondClick(e,r){var s=this;return O(function*(){const i=s.selecteds[0],o=new P(e,r);if(o.equals(i))return s.cancelMoveAttempt(),G.SUCCESS;if(!1===o.isHexagonallyAlignedWith(i))return s.cancelMoveAttempt(),s.firstClick(e,r);const c=o.getDistance(i);if(c>2)return s.cancelMove(_0.CANNOT_MOVE_MORE_THAN_THREE_PIECES());const u=i.getDirectionToward(o).get();s.selecteds=[i];for(let h=0;h<c;h++)s.selecteds.push(i.getNext(u,h+1));if(3===s.selecteds.length){const h=s.selecteds[1],g=s.getState().getCurrentPlayer();if(!1===s.hexaBoard[h.y][h.x].is(g))return s.cancelMoveAttempt(),s.firstClick(e,r)}return s.showPossibleDirections(),G.SUCCESS})()}thirdClick(e,r){var s=this;return O(function*(){const i=new P(e,r),o=s.selecteds[0];if(i.equals(o))return s.deselectExtremity(!0);const c=s.selecteds[s.selecteds.length-1];return i.equals(c)?s.deselectExtremity(!1):3===s.selecteds.length&&i.equals(s.selecteds[1])?(s.cancelMoveAttempt(),G.SUCCESS):s.tryExtension(i,o,c)})()}tryExtension(e,r,s){var i=this;return O(function*(){const o=Pe.factory.fromMove(r,e);if(o.isSuccess()){const u=Pe.factory.fromMove(s,e);if(o.equals(u)){const h=r.getDistance(e),g=s.getDistance(e);return 2===Math.max(h,g)?(i.selecteds.push(e),ht.sortByDescending(i.selecteds,a2.sortCoord),i.showPossibleDirections(),G.SUCCESS):i.cancelMove(_0.CANNOT_MOVE_MORE_THAN_THREE_PIECES())}}const c=i.cancelMove(_0.LINE_AND_COORD_NOT_ALIGNED());return yield i.firstClick(e.x,e.y),c})()}deselectExtremity(e){var r=this;return O(function*(){return r.selecteds=r.selecteds.slice(e?1:0,e?void 0:-1),r.showPossibleDirections(),G.SUCCESS})()}chooseDirection(e){var r=this;return O(function*(){const s=r.canUserPlay("#direction_"+e.toString());return s.isFailure()?r.cancelMove(s.getReason()):r._chooseDirection(e)})()}_chooseDirection(e){var r=this;return O(function*(){const s=r.getState();let i;const o=r.selecteds[0];return i=1===r.selecteds.length?a2.fromSingleCoord(o,e).get():a2.fromDoubleCoord(o,r.selecteds[r.selecteds.length-1],e).get(),r.chooseMove(i,s,r.scores.get())})()}onSpaceClick(e,r){var s=this;return O(function*(){const i=s.canUserPlay("#space_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.tryChoosingDirection(e,r)})()}tryChoosingDirection(e,r){var s=this;return O(function*(){const i=new P(e,r);for(const o of s.directions)if(o.landing.equals(i))return s._chooseDirection(o.dir);return G.failure("not a direction")})()}getSquareClasses(e,r){const s=new P(e,r),i=[];return this.moveds.some(o=>o.equals(s))&&i.push("moved-fill"),i}getPieceClasses(e,r){const s=new P(e,r),i=F.of(this.hexaBoard[r][e].value),o=[this.getPlayerClass(i)];return this.selecteds.some(c=>c.equals(s))&&o.push("selected-stroke"),o}}return n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-abalone"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,r){1&e&&(B(),N(0,"svg",0),k(1,kct,2,1,"g",1),N(2,"defs"),k(3,Rct,2,1,"marker",2),A(),k(4,Dct,4,12,"g",1),A()),2&e&&(M(1),w("ngForOf",r.hexaBoard),M(2),w("ngForOf",r.directions),M(1),w("ngForOf",r.directions))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Cn{constructor(t){this.x=t}static from(t){switch(t){case 0:return Cn.ZERO;case 1:return Cn.ONE;case 2:return Cn.TWO;default:return Se(3===t,"Invalid Apagos Coord "+t),Cn.THREE}}equals(t){return this.x===t.x}}Cn.ZERO=new Cn(0),Cn.ONE=new Cn(1),Cn.TWO=new Cn(2),Cn.THREE=new Cn(3);let Lf=(()=>{class n{}return n.PIECE_SHOULD_MOVE_DOWNWARD=()=>$localize`Pieces should only move downward!`,n.CANNOT_LAND_ON_A_FULL_SQUARE=()=>$localize`That square is already full, you cannot put a piece in it!`,n.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=()=>$localize`You have no pieces in that square, select one that contains at least one of your pieces!`,n.NO_PIECE_REMAINING_TO_DROP=()=>$localize`There are no remaining pieces of that color to drop!`,n.NO_POSSIBLE_TRANSFER_REMAINS=()=>$localize`There is no possible transfer from that square!`,n})();class R1 extends so{constructor(t,e,r){super(),this.landing=t,this.piece=e,this.starting=r}static drop(t,e){return Ae.getNonNullable(R1.ALL_MOVES.find(s=>s.landing.equals(t)&&s.piece.equalsValue(e)&&s.starting.equals(S.empty())))}static transfer(t,e){if(t.x<=e.x)return K.failure(Lf.PIECE_SHOULD_MOVE_DOWNWARD());const r=Ae.getNonNullable(R1.ALL_MOVES.find(s=>s.landing.equals(e)&&s.piece.equals(S.empty())&&s.starting.equals(S.of(t))));return K.success(r)}isDrop(){return this.piece.isPresent()}toString(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}equals(t){return!1!==this.starting.equals(t.starting)&&!1!==this.landing.equals(t.landing)&&this.piece.equals(t.piece)}}R1.ALL_MOVES=[new R1(Cn.ZERO,S.of(F.ZERO),S.empty()),new R1(Cn.ONE,S.of(F.ZERO),S.empty()),new R1(Cn.TWO,S.of(F.ZERO),S.empty()),new R1(Cn.THREE,S.of(F.ZERO),S.empty()),new R1(Cn.ZERO,S.of(F.ONE),S.empty()),new R1(Cn.ONE,S.of(F.ONE),S.empty()),new R1(Cn.TWO,S.of(F.ONE),S.empty()),new R1(Cn.THREE,S.of(F.ONE),S.empty()),new R1(Cn.TWO,S.empty(),S.of(Cn.THREE)),new R1(Cn.ONE,S.empty(),S.of(Cn.THREE)),new R1(Cn.ZERO,S.empty(),S.of(Cn.THREE)),new R1(Cn.ONE,S.empty(),S.of(Cn.TWO)),new R1(Cn.ZERO,S.empty(),S.of(Cn.TWO)),new R1(Cn.ZERO,S.empty(),S.of(Cn.ONE))],R1.encoder=new class extends on{maxValue(){return R1.ALL_MOVES.length}encodeNumber(n){const t=R1.ALL_MOVES.findIndex(e=>e.equals(n));return Se(t>=0,n.toString()+" is not part of possibles moves of Apagos!"),t}decodeNumber(n){return Se(n<R1.ALL_MOVES.length,n+" is not a valid encoded number for ApagosMove decoder"),R1.ALL_MOVES[n]}};class Kg{constructor(t){this.containing=t}static from(t,e,r){if(t+e>r)return K.failure("invalid starting space");const s=new Qn([{key:F.ZERO,value:t},{key:F.ONE,value:e},{key:fe.NONE,value:r}]);s.makeImmutable();const i=new Kg(s);return K.success(i)}isFull(){return this.count(F.ZERO)+this.count(F.ONE)>=this.count(fe.NONE)}count(t){return this.containing.get(t).get()}addPiece(t){let e=this.count(F.ZERO),r=this.count(F.ONE);const s=this.count(fe.NONE);return t===F.ZERO?e++:r++,Kg.from(e,r,s).get()}substractPiece(t){let e=this.count(F.ZERO),r=this.count(F.ONE);const s=this.count(fe.NONE);return t===F.ZERO?e--:r--,Kg.from(e,r,s).get()}getDominatingPlayer(){const t=this.count(F.ZERO),e=this.count(F.ONE);return t>e?F.ZERO:e>t?F.ONE:fe.NONE}equals(t){return this.containing.equals(t.containing)}}let v0=(()=>{class n extends MS{constructor(e,r,s){super(e),this.board=r,this.remaining=s,this.remaining.makeImmutable()}static getInitialState(){return n.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}static fromRepresentation(e,r,s,i){const o=[];for(let u=0;u<4;u++){const v=Kg.from(r[0][u],r[1][u],r[2][u]).get();o.push(v)}const c=new Qn;return c.set(F.ZERO,s),c.set(F.ONE,i),new n(e,o,c)}getPieceAt(e){return this.board[e.x]}updateAt(e,r){const s=[];for(let o=0;o<4;o++)s.push(e.x===o?r:this.board[o]);const i=this.getRemainingCopy();return new n(this.turn,s,i)}getRemainingCopy(){return this.remaining.getCopy()}getRemaining(e){return this.remaining.get(e).get()}equals(e){return this.turn===e.turn&&ht.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}return n.PIECES_PER_PLAYER=10,n})();class n4 extends hr{constructor(){super(v0)}static get(){return n4.singleton.isAbsent()&&(n4.singleton=S.of(new n4)),n4.singleton.get()}applyLegalMove(t,e,r){return t.isDrop()?this.applyLegalDrop(t,e):this.applyLegalTransfer(t,e)}applyLegalDrop(t,e){const r=e.getRemainingCopy(),s=r.get(t.piece.get()).get();r.put(t.piece.get(),s-1);const i=new v0(e.turn+1,e.board,r),o=t.piece.get(),c=i.getPieceAt(t.landing).addPiece(o);if(t.landing===Cn.THREE)return i.updateAt(t.landing,c);{const u=Cn.from(t.landing.x+1),h=i.getPieceAt(u);return i.updateAt(t.landing,h).updateAt(u,c)}}applyLegalTransfer(t,e){const r=e.getCurrentPlayer(),s=t.starting.get(),i=e.getPieceAt(s).substractPiece(r),o=e.getPieceAt(t.landing).addPiece(r);let c=e.updateAt(s,i);return c=c.updateAt(t.landing,o),new v0(c.turn+1,c.board,c.remaining)}isLegal(t,e){return e.getPieceAt(t.landing).isFull()?K.failure(Lf.CANNOT_LAND_ON_A_FULL_SQUARE()):t.isDrop()?this.isLegalDrop(t,e):this.isLegalSlideDown(t,e)}isLegalDrop(t,e){return e.getRemaining(t.piece.get())<=0?K.failure(Lf.NO_PIECE_REMAINING_TO_DROP()):K.success(void 0)}isLegalSlideDown(t,e){const r=e.getCurrentPlayer();return 0===e.getPieceAt(t.starting.get()).count(r)?K.failure(Lf.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):K.success(void 0)}getGameStatus(t){const e=t.gameState;for(let s=0;s<4;s++)if(!1===e.getPieceAt(Cn.from(s)).isFull())return ze.ONGOING;const r=e.getPieceAt(Cn.THREE).getDominatingPlayer();return Se(r.isPlayer(),"winner can only be a player if the game is finished"),ze.getVictory(r)}}n4.singleton=S.empty();class Hct extends rr{getListMoves(t){const e=t.gameState;return R1.ALL_MOVES.filter(function r(s){return n4.get().isLegal(s,e).isSuccess()})}getBoardValue(t){const e=n4.get().getGameStatus(t);if(e.isEndGame)return dt.fromWinner(e.winner);const r=t.gameState.board[3].getDominatingPlayer();return r.isPlayer()?new dt(r.getScoreModifier()):new dt(0)}}class xae extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Initial board and goal of the game`,$localize`At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!`,v0.getInitialState()),pe.anyMove($localize`Drop`,$localize`There are two kind of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right. You're playing Light.<br/><br/>Drop a piece on one of those three squares.`,v0.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),R1.drop(Cn.ZERO,F.ZERO),$localize`Congratulations!`),pe.fromPredicate($localize`Transfer`,$localize`The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from a higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!`,v0.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),R1.transfer(Cn.TWO,Cn.ZERO).get(),(t,e,r)=>t.isDrop()?G.failure($localize`This move is a drop, please do a transfer!`):G.SUCCESS,$localize`Congratulations!`),pe.fromPredicate($localize`Victory`,$localize`When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!`,v0.fromRepresentation(2,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),R1.drop(Cn.TWO,F.ONE),(t,e,r)=>t.isDrop()?t.piece.equalsValue(F.ONE)?G.SUCCESS:G.failure($localize`You actively made your opponent win!`):G.failure($localize`Wrong choice, your opponent will win in the next turn no matter which piece is dropped!`),$localize`Congratulations!`)]}}function Fct(n,t){if(1&n&&(B(),X(0,"circle",5)),2&n){const e=t.$implicit,r=E();V("cx",r.getRemainingPieceCx(e))("cy",r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function Bct(n,t){if(1&n&&(B(),X(0,"circle",6)),2&n){const e=t.$implicit,r=E();V("cx",r.BOARD_WIDTH-r.getRemainingPieceCx(e))("cy",r.BOARD_HEIGHT-r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function $ct(n,t){if(1&n){const e=we();B(),N(0,"polygon",9),se("click",function(){he(e);const s=E().index,i=E();return ce(i.onArrowClick(s,i.PlayerOrNone.ZERO))}),A()}if(2&n){const e=E().index,r=E();L1("id","dropArrow_zero_",e,""),w("ngClass",r.getArrowClasses(e,r.PlayerOrNone.ZERO)),V("points",r.ARROW_COORD)("transform","translate("+r.SPACE_SIZE/2+" "+-r.SPACE_SIZE/2+")")}}function Uct(n,t){if(1&n){const e=we();B(),N(0,"polygon",9),se("click",function(){he(e);const s=E().index,i=E();return ce(i.onArrowClick(s,i.PlayerOrNone.ONE))}),A()}if(2&n){const e=E().index,r=E();L1("id","dropArrow_one_",e,""),w("ngClass",r.getArrowClasses(e,r.PlayerOrNone.ONE)),V("points",r.ARROW_COORD)("transform","translate(0 "+-r.SPACE_SIZE/2+")")}}function Gct(n,t){if(1&n){const e=we();B(),nn(0),N(1,"circle",10),se("click",function(){he(e);const s=E().index;return ce(E().onSquareClick(s))}),A(),rn()}if(2&n){const e=t.$implicit,r=E(),s=r.index,i=r.$implicit,o=E();M(1),D3("id","square_",s,"_piece_",e,"_out_of_",i.count(o.PlayerOrNone.NONE),""),w("ngClass",o.getPieceClasses(s,e,i)),V("cx",o.getCircleCenter(s,e,i).x)("cy",o.getCircleCenter(s,e,i).y)}}function Wct(n,t){if(1&n){const e=we();B(),N(0,"g"),k(1,$ct,1,4,"polygon",7),k(2,Uct,1,4,"polygon",7),N(3,"rect",8),se("click",function(){const i=he(e).index;return ce(E().onSquareClick(i))}),A(),k(4,Gct,2,6,"ng-container",4),A()}if(2&n){const e=t.$implicit,r=t.index,s=E();V("transform",s.getBlockTransform(r)),M(1),w("ngIf",s.canDisplayArrow(r,s.PlayerOrNone.ZERO)),M(1),w("ngIf",s.canDisplayArrow(r,s.PlayerOrNone.ONE)),M(1),L1("id","square_",r,""),w("ngClass",s.getSquareClasses(r)),V("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),M(1),w("ngForOf",s.range(e.count(s.PlayerOrNone.NONE)))}}let qct=(()=>{class n extends m0{constructor(e){super(e),this.PlayerOrNone=fe,this.BOARD_WIDTH=4*this.SPACE_SIZE,this.BOARD_HEIGHT=4.5*this.SPACE_SIZE,this.ARROW_COORD=n.getArrowCoord(),this.PIECES_PER_PLAYER=v0.PIECES_PER_PLAYER,this.selectedPiece=S.empty(),this.leftPiece=S.empty(),this.droppedPiece=S.empty(),this.displayableArrow=[],this.rules=n4.get(),this.hasAsymetricBoard=!0,this.availableMinimaxes=[new Hct(this.rules,"ApagosDummyMinimax")],this.encoder=R1.encoder,this.tutorial=(new xae).tutorial,this.PIECE_RADIUS=2*this.SPACE_SIZE/(this.PIECES_PER_PLAYER+.5),this.updateBoard()}static getArrowCoord(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}cancelMoveAttempt(){this.selectedPiece=S.empty(),this.showPossibleDrops()}updateBoard(){const e=this.getState();this.board=e.board,this.remainingZero=e.remaining.get(F.ZERO).get(),this.remainingOne=e.remaining.get(F.ONE).get(),this.hideLastMove(),this.rules.node.move.isPresent()&&this.showLastMove(),this.showPossibleDrops()}hideLastMove(){this.movedSquare=[],this.droppedPiece=S.empty(),this.leftPiece=S.empty(),this.selectedPiece=S.empty()}showLastMove(){const e=this.rules.node.move.get();e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}showLastDrop(e){const r=e.piece.get();let s=e.landing.x;this.movedSquare=[s],3!==e.landing.x&&(s+=1,this.movedSquare.push(s));const o=this.getLowestPlayerPiece(this.board[s],r);this.droppedPiece=S.of({square:s,piece:o})}getLowestPlayerPiece(e,r){const s=e.count(r);return r===F.ZERO?s-1:e.count(fe.NONE)-s}showLastTransfer(e){const r=this.rules.node.mother.get().gameState,s=r.getCurrentPlayer(),i=e.starting.get().x,c=this.getLowestPlayerPiece(r.board[i],s);this.leftPiece=S.of({square:i,piece:c});const u=e.landing.x,g=this.getLowestPlayerPiece(this.board[u],s);this.droppedPiece=S.of({square:u,piece:g})}showPossibleDrops(){this.displayableArrow=[];const e=this.getState();for(let r=0;r<4;r++)!1===e.board[r].isFull()&&(e.remaining.get(F.ZERO).get()>0&&this.displayableArrow.push({x:r,player:F.ZERO}),e.remaining.get(F.ONE).get()>0&&this.displayableArrow.push({x:r,player:F.ONE}))}getCircleCenter(e,r,s){const i=this.SPACE_SIZE/2,o=this.SPACE_SIZE/2;if(1===s.count(fe.NONE))return new P(i,o);const c=s.count(fe.NONE),u=2*r*Math.PI/c-Math.PI/2,h=.3*this.SPACE_SIZE,g=h*Math.cos(u),m=h*Math.sin(u);return new P(i+g,o+m)}canDisplayArrow(e,r){return this.displayableArrow.some(s=>s.x===e&&s.player.equals(r))}getArrowClasses(e,r){return[this.getPlayerClass(r)]}getBlockTransform(e){return"translate("+e*this.SPACE_SIZE+", "+((3-e)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}getSquareClasses(e){const r=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?r.push("selected-stroke"):this.movedSquare.includes(e)&&r.push("last-move-stroke"),r}onArrowClick(e,r){var s=this;return O(function*(){const o=s.canUserPlay("#dropArrow_"+(r===F.ZERO?"zero":"one")+"_"+e);if(o.isFailure())return s.cancelMove(o.getReason());const c=Cn.from(e);let u;if(s.selectedPiece.isPresent()){const g=s.selectedPiece.get().square;u=R1.transfer(Cn.from(g),c).get()}else u=R1.drop(c,r);const h=s.getState();return s.chooseMove(u,h)})()}getPieceClasses(e,r,s){const i={square:e,piece:r},o=[];let c=s.count(F.ZERO),u=s.count(F.ONE);if(this.selectedPiece.equalsValue(i))o.push("selected-stroke");else if(this.droppedPiece.equalsValue(i))o.push("last-move-stroke");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===r)return o.push("captured-stroke"),o;this.getState().getCurrentOpponent()===F.ZERO?c++:u++}const h=s.count(fe.NONE)-(u+c),g=this.getPieceColor(r,c,h);return""!==g&&o.push(g),o}getPieceColor(e,r,s){return e<r?"player0-fill":e>=r+s?"player1-fill":""}onSquareClick(e){var r=this;return O(function*(){const s=r.canUserPlay("#square_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(r.selectedPiece.isPresent()&&r.selectedPiece.get().square===e)return r.cancelMoveAttempt(),G.SUCCESS;const i=r.getState().getCurrentPlayer(),o=r.board[e];return o.count(i)<=0?r.cancelMove(Lf.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(r.selectedPiece=S.of({square:e,piece:r.getLowestPlayerPiece(o,i)}),0===r.showAndGetPossibleTranfers().length?r.cancelMove(Lf.NO_POSSIBLE_TRANSFER_REMAINS()):G.SUCCESS)})()}showAndGetPossibleTranfers(){this.displayableArrow=[];let e=this.selectedPiece.get().square-1;const r=this.getState().getCurrentPlayer();for(;0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:r}),e--;return this.displayableArrow}getRemainingPieceCx(e){return(e+.5)*this.PIECE_RADIUS*1.5}}return n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-apagos"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1-fill",4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1-fill"],[1,"base","mid-stroke","player0-fill"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(e,r){1&e&&(B(),N(0,"svg",0)(1,"g"),k(2,Fct,1,3,"circle",1),k(3,Bct,1,3,"circle",2),A(),N(4,"g",3),k(5,Wct,5,8,"g",4),A()()),2&e&&(V("viewBox",-r.STROKE_WIDTH/2+" "+-r.STROKE_WIDTH/2+" "+(r.BOARD_WIDTH+r.STROKE_WIDTH)+" "+(r.BOARD_HEIGHT+r.STROKE_WIDTH)),M(1),V("transform","rotate("+180*r.role.value+" "+r.BOARD_WIDTH/2+" "+r.BOARD_HEIGHT/2+")"),M(1),w("ngForOf",r.range(r.remainingOne)),M(1),w("ngForOf",r.range(r.remainingZero)),M(2),w("ngForOf",r.board))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Bo=(()=>{class n extends m0{getViewBox(){return-.5*this.STROKE_WIDTH+" "+-.5*this.STROKE_WIDTH+" "+(this.board.length*this.SPACE_SIZE+this.STROKE_WIDTH)+" "+(this.board[0].length*this.SPACE_SIZE+this.STROKE_WIDTH)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=es(n)))(r||n)}}(),n.\u0275cmp=vt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();class Ni extends Vs{constructor(t,e,r){super(t,e),this.captured=r}static getInitialState(){const t=ht.createTable(6,2,4);return new Ni(t,0,[0,0])}getCapturedCopy(){return[this.captured[0],this.captured[1]]}}let yV=(()=>{class n{}return n.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=()=>$localize`You cannot distribute from the opponent's home.`,n.MUST_CHOOSE_NON_EMPTY_HOUSE=()=>$localize`You should choose a non-empty house to distribute.`,n.SHOULD_DISTRIBUTE=()=>$localize`You should distribute but you do not.`,n})(),r4=(()=>{class n extends hr{applyLegalMove(e,r,s){Y(n.VERBOSE,{called:"AwaleRules.applyLegalMove",move:e,state:r});const i=e.x,o=r.getCurrentPlayer(),u=r.getCurrentOpponent().value,h=r.getCopiedBoard(),g=n.distribute(i,u,h),m=g[g.length-1];return m.y===u?new Ni(h,r.turn+1,r.captured):this.applyPotentialCapture(o,m,h,r)}applyPotentialCapture(e,r,s,i){const o=i.getCurrentOpponent(),c=[i.captured[0],i.captured[1]],u=n.captureIfLegal(r.x,r.y,e,s);c[e.value]+=u.capturedSum;const h=u.resultingBoard;if(n.mustMansoon(e,h)){const g=n.mansoon(o,h);return c[o.value]+=g.capturedSum,new Ni(g.resultingBoard,i.turn+1,c)}return new Ni(h,i.turn+1,c)}static mustMansoon(e,r){return n.isStarving(e,r)&&!1===n.canDistribute(e.getOpponent(),r)}static mansoon(e,r){const s=ht.copyBiArray(r);let i=0;const o=[[0,0,0,0,0,0],[0,0,0,0,0,0]];let c=0;const u=e.getOpponent().value;do{i+=s[u][c],o[u][c]=s[u][c],s[u][c]=0,c++}while(c<6);return{capturedSum:i,captureMap:o,resultingBoard:s}}static isLegal(e,r){const s=r.getCurrentOpponent(),i=s.value,o=e.x;if(0===r.getPieceAtXY(o,i))return K.failure(yV.MUST_CHOOSE_NON_EMPTY_HOUSE());const c=n.isStarving(s,r.board),u=!1===n.doesDistribute(o,i,r.board);return c&&u?K.failure(yV.SHOULD_DISTRIBUTE()):K.success(void 0)}isLegal(e,r){return n.isLegal(e,r)}static doesDistribute(e,r,s){return 0===r?s[r][e]>5-e:s[r][e]>e}static canDistribute(e,r){for(let s=0;s<6;s++)if(n.doesDistribute(s,e.getOpponent().value,r))return!0;return!1}static isStarving(e,r){let s=0;const i=e.getOpponent().value;do{if(r[i][s++]>0)return!1}while(s<6);return!0}static distribute(e,r,s){const i=e,o=r;let c=s[r][e];const u=[];for(s[r][e]=0;c>0;)0===r?5===e?r=1:e++:0===e?r=0:e--,(e!==i||r!==o)&&(s[r][e]+=1,u.push(new P(e,r)),c--);return u}static capture(e,r,s,i){const o=ht.copyBiArray(i);Se(r!==s.getOpponent().value,"AwaleRules.capture cannot capture the players house");let u=o[r][e],h=0;const g=[[0,0,0,0,0,0],[0,0,0,0,0,0]];if(u<2||u>3)return{capturedSum:0,captureMap:g,resultingBoard:o};let m=-1,v=-1;s===F.ONE&&(m=1,v=6);do{g[r][e]=u,h+=u,o[r][e]=0,u=o[r][e+=m]}while(e!==v&&(2===u||3===u));return{capturedSum:h,captureMap:g,resultingBoard:o}}static captureIfLegal(e,r,s,i){const o=ht.copyBiArray(i),c=n.capture(e,r,s,i),u=n.isStarving(s.getOpponent(),c.resultingBoard);return c.capturedSum>0&&u?{capturedSum:0,resultingBoard:o,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]]}:c}static getGameStatus(e){const r=e.gameState;return r.captured[0]>24?ze.ZERO_WON:r.captured[1]>24?ze.ONE_WON:24===r.captured[0]&&24===r.captured[1]?ze.DRAW:ze.ONGOING}getGameStatus(e){return n.getGameStatus(e)}}return n.VERBOSE=!1,n})();class d1 extends so{constructor(t){super(),this.x=t}static from(t){switch(t){case 0:return d1.ZERO;case 1:return d1.ONE;case 2:return d1.TWO;case 3:return d1.THREE;case 4:return d1.FOUR;default:return Se(5===t,"Invalid x for AwaleMove: "+t),d1.FIVE}}equals(t){return t===this||t.x===this.x}toString(){return"AwaleMove("+this.x+")"}}d1.ZERO=new d1(0),d1.ONE=new d1(1),d1.TWO=new d1(2),d1.THREE=new d1(3),d1.FOUR=new d1(4),d1.FIVE=new d1(5),d1.encoder=new class extends on{maxValue(){return 5}encodeNumber(n){return n.x}decodeNumber(n){return d1.from(n)}};class jct extends rr{getListMoves(t){const e=[],r=t.gameState,i=(r.turn+1)%2;let o,c=0;do{0!==r.getPieceAtXY(c,i)&&(o=d1.from(c),r4.isLegal(o,r).isSuccess()&&(o=d1.from(c),e.push(o))),c++}while(c<6);return this.orderMoves(t,e)}orderMoves(t,e){const r=t.gameState.getCurrentPlayer(),s=t.gameState.getCurrentOpponent().value,i=r.value;return ht.sortByDescending(e,o=>{const c=t.gameState.getCopiedBoard(),u=c[s][o.x],h=r4.distribute(o.x,s,c),g=h[h.length-1];let m,v=0;return g.y===s?(m=0,u<=6&&(v=10)):m=r4.captureIfLegal(g.x,i,r,c).capturedSum,100*m+v-u}),e}getBoardValue(t){const e=r4.getGameStatus(t);if(e.isEndGame)return dt.fromWinner(e.winner);const s=t.gameState.getCapturedCopy();return new dt(s[1]-s[0])}}class Lae extends Pr{constructor(){super(...arguments),this.tutorial=[pe.anyMove($localize`Sowing`,$localize`Awal is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.
         Let's see how seeds are sown. The spaces in Awal are called the houses.
         As you're playing first, the 6 houses on the bottom are yours.<br/><br>
         Click on any of them to sow the seeds it contains: they will be sown clockwise, one seed per house.`,Ni.getInitialState(),d1.ZERO,$localize`Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.
        This is how seeds are sown:
        one by one from the house next to the one they come from, clockwise.`),pe.anyMove($localize`Big sowing`,$localize`You are still the first player.
        When there are enough seeds to make a full turn, something else happens.<br/><br/>
        Sow the house that contains 12 seeds.`,new Ni([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,[0,0]),d1.ONE,$localize`See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds).`),pe.fromMove($localize`Simple capture`,$localize`After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.<br/><br/>The houses on the bottom are yours, do a capture!`,new Ni([[0,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[d1.ZERO],$localize`Well done! This was a simple capture, now let us see how to make multiple captures.`,$localize`Failed. Try again and sow from the leftmost house.`),pe.fromMove($localize`Multiple captures`,$localize`By sowing from your leftmost house, you will end in the opponent's second leftmost house, which contains now 3, so this will be a capture. But now, the house right before it contains 2, which is also capturable, so, that house will get captured as well!<br/><br/>The houses on the bottom are yours, do a capture!`,new Ni([[2,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[d1.ZERO],$localize`Nice, you win 3 points from the first house, and 2 from the second!`,$localize`Failed. Try again.`),pe.fromMove($localize`Interrupted capture`,$localize`By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>The houses on the bottom are yours, do a capture!`,new Ni([[1,0,1,0,0,1],[3,0,0,0,1,0]],0,[0,0]),[d1.ZERO],$localize`Notice that because the second house was not capturable, the capture was interrupted and you have not captured the first house.`,$localize`Failed. Try again.`),pe.fromMove($localize`Capture on the other side only`,$localize`Your houses are the one below. Try to capture the two leftmost houses of the opponent.`,new Ni([[2,2,0,0,1,0],[1,3,0,0,0,0]],0,[0,0]),[d1.ONE],$localize`Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!`,$localize`You have only captured one house, try again!`),pe.fromMove($localize`Do not starve`,$localize`You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>
        Your houses are the one below. Try it.`,new Ni([[1,1,1,1,1,0],[5,0,0,1,0,0]],0,[0,0]),[d1.ZERO],$localize`Sadly, you cannot capture here, otherwise the opponent could not play after you.
        When this happens, the move can be made, but no capture takes place!`,$localize`Failed. Try again.`),pe.anyMove($localize`Feeding is mandatory`,$localize`You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>Go ahead!`,new Ni([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,[0,0]),d1.THREE,$localize`Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.
        It is often a good way to have easy captures!`),pe.anyMove($localize`End of the game`,$localize`A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>Your houses are still the bottom one, sow the leftmost house.`,new Ni([[4,4,3,2,1,0],[1,0,0,0,0,0]],0,[0,0]),d1.ZERO,$localize`Also, as soon as on player cannot play, the other player captures all the seeds in its own side.
         Here, it was the first player's turn, and the second player has taken all the remaining seeds.`)]}}function Zct(n,t){if(1&n){const e=we();B(),N(0,"text",7),se("click",function(){he(e);const s=E().index,i=E().index;return ce(E().onClick(s,i))}),Et(1),A()}if(2&n){const e=E().index,r=E().index,s=E();je("id","captured_",e,"_",r,""),V("x",65+100*e)("y",81+120*r)("transform",s.getPieceRotation(e,r)),M(1),Ei(" ",-s.captured[r][e]," ")}}function Yct(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"circle",4),se("click",function(){const i=he(e).index,o=E().index;return ce(E().onClick(i,o))}),A(),N(2,"text",5),se("click",function(){const i=he(e).index,o=E().index;return ce(E().onClick(i,o))}),Et(3),A(),k(4,Zct,2,6,"text",6),A()}if(2&n){const e=t.$implicit,r=t.index,s=E().index,i=E();M(1),je("id","click_",r,"_",s,""),w("ngClass",i.getSpaceClasses(r,s)),V("cx",i.getPieceCx(r))("cy",i.getPieceCy(s)),M(1),je("id","number_",r,"__",s,""),V("x",50+100*r)("y",66+120*s)("transform",i.getPieceRotation(r,s)),M(1),Ei(" ",e," "),M(1),w("ngIf",i.captured[s][r]>0)}}function Kct(n,t){if(1&n&&(B(),N(0,"g"),k(1,Yct,5,12,"g",2),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}let Xct=(()=>{class n extends Bo{constructor(e){super(e),this.last=S.empty(),this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[],this.hasAsymetricBoard=!0,this.scores=S.of([0,0]),this.rules=new r4(Ni),this.availableMinimaxes=[new jct(this.rules,"AwaleMinimax")],this.encoder=d1.encoder,this.tutorial=(new Lae).tutorial,this.updateBoard()}updateBoard(){const e=this.getState();this.scores=S.of(e.getCapturedCopy()),this.hidePreviousMove();const r=this.rules.node.move;if(this.board=e.getCopiedBoard(),r.isPresent()){const s=e.getCurrentPlayer().value;this.last=S.of(new P(r.get().x,s)),this.showPreviousMove()}else this.last=S.empty()}hidePreviousMove(){this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[]}showPreviousMove(){const e=this.rules.node.move.get(),r=this.rules.node.mother.get().gameState,s=ht.copyBiArray(r.board),i=r.getCurrentOpponent().value;this.filledCoords=r4.distribute(e.x,i,s);const o=this.filledCoords[this.filledCoords.length-1];if(o.y!==i){const c=r4.captureIfLegal(o.x,o.y,r.getCurrentPlayer(),s);this.captured=c.captureMap;const u=this.getState().getCurrentPlayer();r4.mustMansoon(u.getOpponent(),c.resultingBoard)&&(this.captured=r4.mansoon(u,c.resultingBoard).captureMap)}}onClick(e,r){var s=this;return O(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(r===s.getState().getCurrentPlayer().value)return s.cancelMove(yV.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME());s.last=S.empty();const o=d1.from(e);return s.chooseMove(o,s.getState())})()}getSpaceClasses(e,r){const s=new P(e,r),i="player"+(r+1)%2+"-fill";return this.captured[r][e]>0?["captured-fill","moved-stroke"]:this.last.equalsValue(s)?["moved-stroke","last-move-stroke",i]:this.filledCoords.some(o=>o.equals(s))?["moved-stroke",i]:[i]}getPieceCx(e){return 50+100*e}getPieceCy(e){return 50+120*e}getPieceRotation(e,r){return"rotate("+180*this.role.value+" "+this.getPieceCx(e)+" "+this.getPieceCy(r)+")"}}return n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-awale-component"]],features:[l],decls:4,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"id","click"],["class","text-20 text-center",3,"id","click",4,"ngIf"],[1,"text-20","text-center",3,"id","click"]],template:function(e,r){1&e&&(B(),N(0,"svg",0),X(1,"rect",1),k(2,Kct,2,1,"g",2),X(3,"line",3),A()),2&e&&(V("transform",r.rotation),M(2),w("ngForOf",r.board))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class tc extends Yc{constructor(t,e){if(super(t.x,t.y),t.equals(e))throw new Error(Mt.MOVE_CANNOT_BE_STATIC());this.end=e}static getEncoder(t,e,r){return new class extends on{constructor(){super(...arguments),this.shiftAX=e,this.shiftDY=this.shiftAX*t,this.shiftDX=this.shiftDY*e}maxValue(){return(t-1)*this.shiftDX+(e-1)*this.shiftDY+(t-1)*this.shiftAX+(e-1)}encodeNumber(s){return s.coord.x*this.shiftDX+s.coord.y*this.shiftDY+s.end.x*this.shiftAX+s.end.y}decodeNumber(s){const i=s%e;s/=e;const c=new P((s-=s%1)%t,i);s/=t;const u=(s-=s%1)%e;s/=e;const g=new P((s-=s%1)%t,u);return r(g,c)}}}length(){return this.coord.getDistance(this.end)}getDirection(){return Pe.factory.fromMove(this.coord,this.end)}}let TS=(()=>{class n{}return n.LANDING_ON_OCCUPIED_SQUARE=()=>$localize`You cannot land on an occupied square.`,n.THRONE_IS_LEFT_FOR_GOOD=()=>$localize`Once you left the central throne, you cannot return to it.`,n.SOLDIERS_CANNOT_SIT_ON_THRONE=()=>$localize`Soldiers cannot sit on the throne.`,n.MOVE_MUST_BE_ORTHOGONAL=()=>$localize`Tafl moves must be orthogonal.`,n})();class EV extends tc{constructor(t,e){if(super(t,e),t.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+t.toString()+".");if(e.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+e.toString()+".");const r=t.getDirectionToward(e);if(r.isFailure()||r.get().isDiagonal())throw new Error(TS.MOVE_MUST_BE_ORTHOGONAL())}equals(t){return t===this||!1!==t.coord.equals(this.coord)&&t.end.equals(this.end)}toString(){return"TaflMove("+this.coord+"->"+this.end+")"}}class io extends EV{static of(t,e){return new io(t,e)}static from(t,e){try{const r=new io(t,e);return K.success(r)}catch(r){return K.failure(r.message)}}getMaximalDistance(){return 7}}io.encoder=tc.getEncoder(7,7,io.of);const Qct={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:F.ZERO};class cn{constructor(t,e){this.owner=t,this.king=e}isKing(){return this.king}getOwner(){return this.owner}}cn.UNOCCUPIED=new cn(fe.NONE,!1),cn.PLAYER_ONE_KING=new cn(fe.ONE,!0),cn.INVADERS=new cn(fe.ZERO,!1),cn.DEFENDERS=new cn(fe.ONE,!1);class B1{constructor(t){this.value=t}}B1.NONE=new B1("NONE"),B1.OPPONENT=new B1("OPPONENT"),B1.PLAYER=new B1("PLAYER");class MV extends Vs{isCentralThrone(t){return t.equals(this.getCentralThrone())}getCentralThrone(){const t=(this.board.length-1)/2;return new P(t,t)}getRelativeOwner(t,e){const r=this.getAbsoluteOwner(e);let s;return s=r===fe.NONE?B1.NONE:t===r?B1.PLAYER:B1.OPPONENT,s}getAbsoluteOwner(t){return this.getPieceAt(t).getOwner()}}class Xc extends MV{static getInitialState(){const t=cn.UNOCCUPIED,e=cn.INVADERS,r=cn.DEFENDERS;return new Xc([[t,t,t,e,t,t,t],[t,t,t,e,t,t,t],[t,t,t,r,t,t,t],[e,e,r,cn.PLAYER_ONE_KING,r,e,e],[t,t,t,r,t,t,t],[t,t,t,e,t,t,t],[t,t,t,e,t,t,t]],0)}from(t,e){return new Xc(t,e)}}let SV=(()=>{class n extends hr{constructor(e,r,s){super(e),this.config=r,this.generateMove=s}isLegal(e,r){Y(n.VERBOSE,{tablutRules_isLegal:{move:e,state:r}});const s=r.getCurrentPlayer(),i=this.getMoveValidity(s,e,r);return i.isFailure()?K.failure(i.getReason()):K.success(void 0)}getMoveValidity(e,r,s){const i=s.getRelativeOwner(e,r.coord);if(i===B1.NONE)return G.failure(Mt.MUST_CHOOSE_PLAYER_PIECE());if(i===B1.OPPONENT)return G.failure(Mt.CANNOT_CHOOSE_OPPONENT_PIECE());if(s.getRelativeOwner(e,r.end)!==B1.NONE)return G.failure(TS.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(s,r.end)){if(!s.getPieceAt(r.coord).isKing())return G.failure(TS.SOLDIERS_CANNOT_SIT_ON_THRONE());if(s.isCentralThrone(r.end)&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return G.failure(TS.THRONE_IS_LEFT_FOR_GOOD())}const c=r.coord.getDirectionToward(r.end).get(),u=r.coord.getOrthogonalDistance(r.end);let h=r.coord.getNext(c);for(let g=1;g<u;g++){if(s.getPieceAt(h)!==cn.UNOCCUPIED)return G.failure(Mt.SOMETHING_IN_THE_WAY());h=h.getNext(c)}return G.SUCCESS}isThrone(e,r){return!!this.isExternalThrone(r)||e.isCentralThrone(r)}isExternalThrone(e){const r=this.config.WIDTH-1;return!(0!==e.x&&e.x!==r||0!==e.y&&e.y!==r)}tryCapture(e,r,s,i){const o=r.getNext(s);return o.isInRange(this.config.WIDTH,this.config.WIDTH)&&i.getRelativeOwner(e,o)===B1.OPPONENT?i.getPieceAt(o).isKing()?this.captureKing(e,r,s,i):this.capturePawn(e,r,s,i):S.empty()}captureKing(e,r,s,i){const o=r.getNext(s),{backCoord:c,back:u,backInRange:h,left:g,leftCoord:m,right:v,rightCoord:T}=this.getSurroundings(o,s,e,i);return!1===h?this.captureKingAgainstTheWall(g,v,o):u===B1.NONE&&this.isThrone(i,c)?this.captureKingAgainstThrone(c,o,g,v):u===B1.PLAYER?this.captureKingWithAtLeastASandwich(i,o,g,m,v,T):S.empty()}getSurroundings(e,r,s,i){const o=e.getNext(r),c=o.isInRange(this.config.WIDTH,this.config.WIDTH),u=c?i.getRelativeOwner(s,o):B1.NONE,h=e.getLeft(r),m=h.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(s,h):B1.NONE,v=e.getRight(r),I=v.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(s,v):B1.NONE;return{backCoord:o,back:u,backInRange:c,leftCoord:h,left:m,rightCoord:v,right:I}}captureKingAgainstTheWall(e,r,s){let o=e===B1.PLAYER?1:0;return o+=r===B1.PLAYER?1:0,2===o&&this.config.BORDER_CAN_SURROUND_KING?(Y(n.VERBOSE||!1,"king captured by 3 invaders against 1 border"),S.of(s)):S.empty()}captureKingAgainstThrone(e,r,s,i){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return S.of(r)}else{const c=i===B1.PLAYER,u=s===B1.PLAYER||c;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&u)return S.of(r)}return S.empty()}capturePawn(e,r,s,i){const c=r.getNext(s),u=c.getNext(s);let h=B1.NONE;return u.isInRange(this.config.WIDTH,this.config.WIDTH)&&(h=i.getRelativeOwner(e,u)),h===B1.NONE?!1===this.isThrone(i,u)?(Y(n.VERBOSE||!1,"cannot capture a pawn without an ally; "+c+"threatened by "+e+"'s pawn in  "+r+" coming from this direction ("+s.x+", "+s.y+")cannot capture a pawn without an ally behind"),S.empty()):(Y(n.VERBOSE||!1,"pawn captured by 1 opponent and 1 throne; "+c+"threatened by "+e+"'s pawn in  "+r+" coming from this direction ("+s.x+", "+s.y+")"),S.of(c)):h===B1.PLAYER?(Y(n.VERBOSE||!1,"pawn captured by 2 opponents; "+c+"threatened by "+e+"'s pawn in  "+r+" coming from this direction ("+s.x+", "+s.y+")"),S.of(c)):(Y(n.VERBOSE||!1,"no captures; "+c+"threatened by "+e+"'s pawn in  "+r+" coming from this direction ("+s.x+", "+s.y+")"),S.empty())}captureKingWithAtLeastASandwich(e,r,s,i,o,c){if(!1===this.kingTouchCentralThrone(e,r)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return S.of(r);const h=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,g=this.isThrone(e,i),m=s===B1.PLAYER||g&&h,v=this.isThrone(e,c);return m&&(o===B1.PLAYER||v&&h)?(Y(n.VERBOSE||!1,"king captured by 4 invaders"),S.of(r)):S.empty()}kingTouchCentralThrone(e,r){const s=e.getCentralThrone();return r.getOrthogonalDistance(s)<=1}applyLegalMove(e,r){Y(n.VERBOSE,{TablutRules_applyLegalMove:{move:e,state:r}});const s=r.turn,i=r.getCopiedBoard(),o=r.getCurrentPlayer(),c=e.coord,u=e.end;i[u.y][u.x]=i[c.y][c.x],i[c.y][c.x]=cn.UNOCCUPIED;for(const h of De.ORTHOGONALS){const g=this.tryCapture(o,e.end,h,r);g.isPresent()&&(i[g.get().y][g.get().x]=cn.UNOCCUPIED)}return r.from(i,s+1)}getGameStatus(e){const s=this.getWinner(e.gameState);return s.isPresent()?ze.getVictory(s.get()):ze.ONGOING}getWinner(e){const s=this.getKingCoord(e);if(s.isAbsent())return Y(!1,"The king is dead, victory to invader"),S.of(this.getInvader());const i=s.get();return this.isExternalThrone(i)?(Y(!1,"The king escape, victory to defender"),S.of(this.getDefender())):this.isPlayerImmobilized(F.ZERO,e)?(Y(!1,"Zero has no move, victory to one"),S.of(F.ONE)):this.isPlayerImmobilized(F.ONE,e)?(Y(!1,"One has no move, victory to zero"),S.of(F.ZERO)):(Y(!1,"no victory"),S.empty())}getKingCoord(e){Y(n.VERBOSE,{TablutRules_getKingCoord:{state:e,con:this.config}});for(let r=0;r<this.config.WIDTH;r++)for(let s=0;s<this.config.WIDTH;s++)if(e.getPieceAtXY(s,r).isKing())return S.of(new P(s,r));return S.empty()}getInvader(){return this.config.INVADER}getDefender(){return this.config.INVADER.getOpponent()}isPlayerImmobilized(e,r){return 0===this.getPlayerListMoves(e,r).length}getPlayerListMoves(e,r){const i=[],o=this.getPlayerListPawns(e,r);Y(n.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:e,state:r}});for(const c of o){const u=this.getPossibleDestinations(c,r);for(const h of u){const g=this.generateMove(c,h);i.push(g)}}return i}getPlayerListPawns(e,r){const s=[];for(let i=0;i<this.config.WIDTH;i++)for(let o=0;o<this.config.WIDTH;o++){const c=new P(o,i);r.getAbsoluteOwner(c)===e&&s.push(c)}return s}getPossibleDestinations(e,r){const s=[];let i;for(const o of De.ORTHOGONALS){i=e.getNext(o,1);let c=!1;for(;i.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===c;)r.getAbsoluteOwner(i)===fe.NONE?this.isExternalThrone(i)?r.getPieceAt(e).isKing()&&s.push(i):r.isCentralThrone(i)?r.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&s.push(i):s.push(i):c=!0,i=i.getNext(o,1)}return s}}return n.VERBOSE=!1,n})();class R8 extends SV{constructor(){super(Xc,Qct,io.of)}static get(){return null==R8.singleton&&(R8.singleton=new R8),fr.ruler=this.singleton,R8.singleton}}class PV extends Bo{constructor(t,e,r){super(t),this.VERBOSE=e,this.generateMove=r,this.viewInfo={pieceClasses:[]},this.EMPTY=cn.UNOCCUPIED,this.captureds=[],this.chosen=S.empty(),this.lastMove=S.empty()}getViewBox(){const t=-this.STROKE_WIDTH,e=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return t+" "+t+" "+e+" "+e}updateBoard(){Y(this.VERBOSE,"taflComponent.updateBoard"),this.lastMove=this.rules.node.move,this.board=this.getState().getCopiedBoard(),this.captureds=[],this.lastMove.isPresent()&&this.showPreviousMove(),this.updateViewInfo()}showPreviousMove(){const t=this.rules.node.mother.get().gameState,e=this.getState().getCurrentOpponent();for(const r of De.ORTHOGONALS){const s=this.lastMove.get().end.getNext(r,1);if(s.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){const o=t.getRelativeOwner(e,s)===B1.OPPONENT,u=this.getState().getPieceAt(s)===cn.UNOCCUPIED;o&&u&&this.captureds.push(s)}}}updateViewInfo(){const t=[];for(let e=0;e<this.board.length;e++){const r=[];for(let s=0;s<this.board[0].length;s++){let i=[];i=this.board[e][s].getOwner()===fe.NONE?[""]:this.getPieceClasses(s,e),r.push(i)}t.push(r)}this.viewInfo={pieceClasses:t}}onClick(t,e){var r=this;return O(function*(){Y(r.VERBOSE,"TaflComponent.onClick("+t+", "+e+")");const s=r.canUserPlay("#click_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new P(t,e);return r.chosen.equalsValue(i)?(r.cancelMoveAttempt(),G.SUCCESS):r.chosen.isAbsent()||r.pieceBelongToCurrentPlayer(i)?r.choosePiece(i):r.chooseDestination(t,e)})()}chooseDestination(t,e){var r=this;return O(function*(){Y(r.VERBOSE,"TaflComponent.chooseDestination");const s=r.chosen.get(),i=new P(t,e),o=r.generateMove(s,i);return o.isSuccess()?yield r.chooseMove(o.get(),r.getState()):r.cancelMove(o.getReason())})()}choosePiece(t){return Y(this.VERBOSE,"TaflComponent.choosePiece"),this.board[t.y][t.x]===cn.UNOCCUPIED?this.cancelMove(Mt.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(t)?(this.chosen=S.of(t),this.updateViewInfo(),Y(this.VERBOSE,"selected piece = ("+t.x+", "+t.y+")"),G.SUCCESS):this.cancelMove(Mt.CANNOT_CHOOSE_OPPONENT_PIECE())}pieceBelongToCurrentPlayer(t){const e=this.getState(),r=e.getCurrentPlayer();return e.getRelativeOwner(r,t)===B1.PLAYER}cancelMoveAttempt(){this.chosen=S.empty(),this.updateViewInfo()}isThrone(t,e){const r=this.getState();return this.rules.isThrone(r,new P(t,e))}isCentralThrone(t,e){return this.getState().isCentralThrone(new P(t,e))}getPieceClasses(t,e){const r=[],s=new P(t,e),i=this.getState().getAbsoluteOwner(s);return r.push(this.getPlayerClass(i)),this.chosen.equalsValue(s)&&r.push("selected-stroke"),r}getRectClasses(t,e){const r=[],s=new P(t,e);if(this.captureds.some(i=>i.equals(s)))r.push("captured-fill");else if(this.lastMove.isPresent()){const i=this.lastMove.get().coord,o=this.lastMove.get().end;(s.equals(i)||s.equals(o))&&r.push("moved-fill")}return r}getClickables(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[e].length;r++){const s=new P(r,e);this.isClickable(s)&&t.push(s)}return t}isClickable(t){return this.pieceBelongToCurrentPlayer(t)}isInvader(t,e){return this.board[e][t]===cn.INVADERS}isKing(t,e){return this.board[e][t].isKing()}}class wS extends rr{getListMoves(t){Y(!1,{TaflMinimax_getListMoves:{node:t}});const r=t.gameState,s=r.getCurrentPlayer(),i=this.ruler.getPlayerListMoves(s,r);return this.orderMoves(r,i)}orderMoves(t,e){const r=this.ruler.getKingCoord(t).get();return t.getCurrentPlayer()===this.ruler.config.INVADER?ht.sortByDescending(e,s=>-s.end.getOrthogonalDistance(r)):ht.sortByDescending(e,s=>s.coord.equals(r)?this.ruler.isExternalThrone(s.end)?2:1:0),e}getBoardValue(t){const e=t.gameState,r=this.ruler.getWinner(e);if(r.isPresent())return new dt(r.get().getVictoryValue());const s=this.ruler.getPlayerListPawns(F.ZERO,e).length,i=this.ruler.getPlayerListPawns(F.ONE,e).length;let o=[1,2][this.ruler.config.INVADER.value];o*=F.ZERO.getScoreModifier();let c=[2,1][this.ruler.config.INVADER.value];return c*=F.ONE.getScoreModifier(),new dt(s*o+i*c)}}class bS{constructor(t,e){this.directThreats=t,this.mover=e}equals(t){return t.directThreats.equals(this.directThreats)&&t.mover.equals(this.mover)}}class kae extends bS{constructor(t,e){super(new Z1([t]),e),this.directThreat=t,this.mover=e}}class Jct extends Z1{constructor(t){if(super(),this.map=[],this.values=[],void 0!==t)for(const e of t)this.add(e)}add(t){const e=this.toFields(t);let r=this.map;for(const i of e[0])void 0===r[i]&&(r[i]=[]),r=r[i];const s=e[1];return void 0===r[s]&&(r[s]=!0,this.values.push(t),!0)}contains(t){const e=this.toFields(t);let r=this.map;for(const i of e[0]){if(void 0===r[i])return!1;r=r[i]}return void 0!==r[e[1]]}[Symbol.iterator](){return this.values.values()}}class dr extends Jct{toFields(t){return[[t.y],t.x]}}class NS extends wS{constructor(t,e){super(t,e),this.width=this.ruler.config.WIDTH,this.maxInfluence=16*(2*this.width-2),this.scoreByThreatenedPiece=16*this.maxInfluence+1,this.scoreBySafePiece=16*this.scoreByThreatenedPiece+1}getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return new dt(e.toBoardValue());const r=t.gameState,s=cn.UNOCCUPIED;let i=0;const o=this.getPiecesMap(r),c=this.getThreatMap(r,o),u=this.filterThreatMap(c,r);for(const h of F.PLAYERS)for(const g of o.get(h).get())if(u.get(g).isPresent())i+=h.getScoreModifier()*this.scoreByThreatenedPiece;else{i+=h.getScoreModifier()*this.scoreBySafePiece;let m=0;for(const v of De.ORTHOGONALS){let T=g.getNext(v,1);for(;T.isInRange(this.width,this.width)&&r.getPieceAt(T)===s;)m++,T=T.getNext(v,1)}i+=m*h.getScoreModifier()}return new dt(i)}getPiecesMap(t){const e=cn.UNOCCUPIED,r=[],s=[];for(let o=0;o<this.width;o++)for(let c=0;c<this.width;c++){const u=new P(c,o);t.getPieceAt(u)!==e&&(t.getAbsoluteOwner(u)===F.ZERO?r.push(u):s.push(u))}return new Qn([{key:F.ZERO,value:new dr(r)},{key:F.ONE,value:new dr(s)}])}getThreatMap(t,e){const r=new Qn;for(const s of F.PLAYERS)for(const i of e.get(s).get()){const o=this.getThreats(i,t);this.isThreatReal(i,t,o)&&r.set(i,new Z1(o))}return r}getThreats(t,e){const r=e.getAbsoluteOwner(t);Se(r.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");const s=r.getOpponent(),i=[];for(const o of De.ORTHOGONALS){const c=t.getPrevious(o,1);if(this.isAThreat(c,e,s)){const u=[];for(const h of De.ORTHOGONALS){if(h===o.getOpposite())continue;let g=t.getNext(o,1);for(;g.isInRange(this.width,this.width)&&e.getPieceAt(g)===cn.UNOCCUPIED;)g=g.getNext(h);g.isInRange(this.width,this.width)&&e.getAbsoluteOwner(g)===s&&!1===t.getNext(o,1).equals(g)&&u.push(g)}i.push(new kae(c,new dr(u)))}}return i}isAThreat(t,e,r){return!(t.isNotInRange(this.width,this.width)||e.getAbsoluteOwner(t)!==r&&(!this.ruler.isThrone(e,t)||r!==F.ONE&&e.getPieceAt(t)!==cn.UNOCCUPIED))}isThreatReal(t,e,r){if(0===r.length)return!1;if(e.getPieceAt(t).isKing())return 3===r.length;for(const s of r)if(s.mover.size()>0)return!0;return!1}filterThreatMap(t,e){const r=new Qn,s=t.listKeys(),i=s.filter(c=>e.getAbsoluteOwner(c)===e.getCurrentPlayer()),o=new dr(s.filter(c=>e.getAbsoluteOwner(c)===e.getCurrentOpponent()));for(const c of i){const u=t.get(c).get(),h=[];for(const g of u)if(!1===o.contains(g.directThreat)){const m=[];for(const v of g.mover)!1===o.contains(v)&&m.push(v);m.length>0&&h.push(new kae(g.directThreat,new dr(m)))}h.length>0&&r.set(c,new Z1(h))}for(const c of o){const u=t.get(c).get();r.set(c,u)}return r}}class Qc extends NS{getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return new dt(e.toBoardValue());const r=t.gameState,s=this.ruler.config.WIDTH,i=cn.UNOCCUPIED;let o=0;const c=this.getPiecesMap(r),u=this.getThreatMap(r,c),h=this.filterThreatMap(u,r);for(const g of F.PLAYERS){const m=new dr;for(const v of c.get(g).get())if(h.get(v).isPresent())o+=g.getScoreModifier()*Qc.SCORE_BY_THREATENED_PIECE;else{o+=g.getScoreModifier()*Qc.SCORE_BY_SAFE_PIECE;for(const T of De.ORTHOGONALS){let I=v.getNext(T,1);for(;I.isInRange(s,s)&&r.getPieceAt(I)===i;)m.add(I),I=I.getNext(T,1)}}for(const v of m){const T=this.getControlledPieceValue(v.x,v.y,s);o+=g.getScoreModifier()*T}}return new dt(o)}getControlledPieceValue(t,e,r){let s=1;return(0===t||t===r-1)&&(s*=r),(0===e||e===r-1)&&(s*=r),s}}Qc.SCORE_BY_THREATENED_PIECE=530,Qc.SCORE_BY_SAFE_PIECE=16*Qc.SCORE_BY_THREATENED_PIECE+1;class kf extends Qc{getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return new dt(e.toBoardValue());const r=t.gameState,s=this.ruler.config.WIDTH,i=cn.UNOCCUPIED;let o=0,c=0,u=0;const h=this.getPiecesMap(r),g=this.getThreatMap(r,h),m=this.filterThreatMap(g,r);for(const T of F.PLAYERS){const I=new dr;for(const z of h.get(T).get())if(m.get(z).isPresent())c+=T.getScoreModifier();else{o+=T.getScoreModifier();for(const Z of De.ORTHOGONALS){let te=z.getNext(Z,1);for(;te.isInRange(s,s)&&r.getPieceAt(te)===i;)I.add(te),te=te.getNext(Z,1)}}for(const z of I){const Z=this.getControlledPieceValue(z.x,z.y,s);u+=T.getScoreModifier()*Z}}const v=this.getStepForEscape(r);return new dt(531*v*17*17+531*o*17+531*c+u)}getStepForEscape(t){const e=this.ruler.getKingCoord(t).get();return this._getStepForEscape(t,1,[e],[]).getOrElse(Number.MAX_SAFE_INTEGER)}_getStepForEscape(t,e,r,s){const i=this.getNextGen(t,r,s);return 0===i.length?S.empty():i.some(o=>this.ruler.isExternalThrone(o))?S.of(e):(e++,s.push(...i),this._getStepForEscape(t,e,i,s))}getNextGen(t,e,r){const s=[];for(const i of e)for(const o of De.ORTHOGONALS){let c=i.getNext(o,1);for(;c.isInRange(this.ruler.config.WIDTH,this.ruler.config.WIDTH)&&t.getPieceAt(c)===cn.UNOCCUPIED;)r.every(u=>!1===u.equals(c))&&s.push(c),c=c.getNext(o,1)}return s}}kf.SCORE_BY_THREATENED_PIECE=530,kf.SCORE_BY_SAFE_PIECE=16*Qc.SCORE_BY_THREATENED_PIECE+1,kf.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];const ee=cn.UNOCCUPIED,$1=cn.INVADERS,$o=cn.DEFENDERS,Xg=cn.PLAYER_ONE_KING;class Rae extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Goal of the game`,$localize`Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,Xc.getInitialState()),pe.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,Xc.getInitialState(),io.of(new P(3,1),new P(1,1)),$localize`Congratulations!`),pe.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it.`,new Xc([[ee,ee,ee,$1,ee,ee,ee],[ee,ee,ee,$1,ee,ee,ee],[$1,ee,ee,$o,ee,ee,ee],[ee,ee,$o,Xg,$o,$1,$1],[ee,ee,$1,ee,ee,ee,ee],[ee,ee,ee,$o,ee,$1,ee],[ee,ee,ee,$1,ee,ee,ee]],1),[io.of(new P(3,5),new P(2,5))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),pe.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it.`,new Xc([[ee,ee,ee,$1,ee,ee,ee],[ee,ee,$1,ee,ee,ee,ee],[ee,ee,ee,$o,ee,ee,ee],[$1,$o,ee,ee,$o,$1,$1],[ee,$o,ee,ee,ee,ee,ee],[ee,$1,ee,Xg,ee,$1,ee],[ee,ee,ee,$1,ee,ee,ee]],12),[io.of(new P(2,1),new P(3,1)),io.of(new P(3,0),new P(3,1))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),pe.fromMove($localize`Capturing the king on his throne`,$localize`To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>Capture the king.`,new Xc([[ee,ee,ee,ee,ee,ee,ee],[ee,ee,ee,$o,ee,ee,ee],[ee,ee,ee,$1,ee,ee,ee],[ee,$1,ee,Xg,$1,ee,ee],[ee,ee,ee,$1,ee,ee,ee],[ee,$o,ee,ee,ee,ee,ee],[ee,ee,ee,ee,ee,ee,ee]],72),[io.of(new P(1,3),new P(2,3))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),pe.fromMove($localize`Capturing the king next to his throne`,$localize`Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>Capture the king.`,new Xc([[ee,ee,$1,ee,ee,ee,ee],[ee,ee,ee,$1,ee,ee,ee],[ee,ee,ee,Xg,$1,ee,ee],[ee,$1,$o,ee,$o,ee,ee],[ee,ee,ee,$1,ee,ee,ee],[ee,ee,ee,ee,ee,ee,ee],[ee,ee,ee,ee,ee,ee,ee]],72),[io.of(new P(2,0),new P(2,2))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed!`),pe.fromMove($localize`Capturing the king far from his throne`,$localize`When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>Capture the king.`,new Xc([[ee,ee,ee,ee,ee,ee,ee],[ee,ee,ee,ee,ee,ee,ee],[ee,$1,ee,$1,ee,ee,ee],[$1,ee,ee,ee,$o,ee,ee],[ee,ee,ee,$o,ee,ee,ee],[ee,ee,ee,ee,ee,ee,ee],[ee,Xg,ee,$1,ee,ee,ee]],72),[io.of(new P(3,6),new P(2,6))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed!`)]}}function e3t(n,t){1&n&&(B(),X(0,"polygon",8))}function t3t(n,t){1&n&&(B(),X(0,"rect",9))}function n3t(n,t){if(1&n&&(B(),N(0,"g"),k(1,e3t,1,0,"polygon",6),k(2,t3t,1,0,"ng-template",null,7,l1),A()),2&n){const e=s1(3),r=E().index,s=E().index,i=E();M(1),w("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function r3t(n,t){if(1&n&&(B(),N(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),A()),2&n){const e=E(2).index,r=E().index,s=E();M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function s3t(n,t){if(1&n&&(B(),X(0,"polyline",16)),2&n){const e=E(3).index,r=E().index;w("ngClass",E().viewInfo.pieceClasses[r][e])}}function i3t(n,t){if(1&n&&(B(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=E(3).index,r=E().index,s=E();w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function o3t(n,t){if(1&n&&(B(),k(0,s3t,1,1,"polyline",14),k(1,i3t,4,20,"ng-template",null,15,l1)),2&n){const e=s1(2),r=E(2).index,s=E().index;w("ngIf",E().isKing(r,s))("ngIfElse",e)}}function a3t(n,t){if(1&n&&(B(),N(0,"g"),X(1,"circle",10),k(2,r3t,6,25,"g",11),k(3,o3t,3,2,"ng-template",null,12,l1),A()),2&n){const e=s1(4),r=E().index,s=E().index,i=E();M(1),je("id","piece_",r,"_",s,""),w("ngClass",i.viewInfo.pieceClasses[s][r]),V("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),M(1),w("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function c3t(n,t){if(1&n){const e=we();B(),N(0,"g",3),se("click",function(){const i=he(e).index,o=E().index;return ce(E().onClick(i,o))}),X(1,"rect",4),k(2,n3t,4,2,"g",5),k(3,a3t,5,8,"g",5),A()}if(2&n){const e=t.index,r=E().index,s=E();je("id","click_",e,"_",r,""),V("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),M(1),w("ngClass",s.getRectClasses(e,r)),V("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),M(1),w("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),M(1),w("ngIf",s.board[r][e]!==s.EMPTY)}}function l3t(n,t){if(1&n&&(B(),N(0,"g"),k(1,c3t,4,8,"g",2),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}function u3t(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"rect",17),se("click",function(){const i=he(e).$implicit;return ce(E().onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=E();M(1),je("id","click_",e.x,"_",e.y,""),V("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let f3t=(()=>{class n extends PV{constructor(e){super(e,!1,io.from),this.rules=R8.get(),this.availableMinimaxes=[new wS(this.rules,"DummyBot"),new NS(this.rules,"Piece > Influence"),new Qc(this.rules,"Piece > Control"),new kf(this.rules,"Escape > Piece > Control")],this.encoder=io.encoder,this.tutorial=(new Rae).tutorial}ngOnInit(){this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-brandhub"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(B(),N(0,"svg",0),k(1,l3t,2,1,"g",1),k(2,u3t,2,6,"g",1),A()),2&e&&(V("viewBox",r.getViewBox()),M(1),w("ngForOf",r.board),M(1),w("ngForOf",r.getClickables()))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Dae=(()=>{class n extends m0{constructor(){super(...arguments),this.SPACE_SIZE=50}getTriangleCornerCoords(e,r){return(e+r)%2==1?this.getDownwardCoordinate(e,r):this.getUpwardCoordinate(e,r)}getTriangleCoordinate(e,r){return this.getTriangleCornerCoords(e,r).map(o=>o.x+","+o.y).reduce((o,c)=>o+","+c)}getDownwardCoordinate(e,r){const i=.5*this.SPACE_SIZE*(e+1),o=.5*this.SPACE_SIZE*(e+2),c=this.SPACE_SIZE*r,u=this.SPACE_SIZE*(r+1),h=new P(.5*this.SPACE_SIZE*e,c);return[h,new P(i,u),new P(o,c),h]}getUpwardCoordinate(e,r){const i=.5*this.SPACE_SIZE*(e+1),o=.5*this.SPACE_SIZE*(e+2),c=this.SPACE_SIZE*r,u=this.SPACE_SIZE*(r+1),h=new P(.5*this.SPACE_SIZE*e,u);return[h,new P(i,c),new P(o,u),h]}getPyramidCoordinate(e,r){return(e+r)%2==1?this.getDownwardPyramidCoordinate(e,r):this.getUpwardPyramidCoordinate(e,r)}getDownwardPyramidCoordinate(e,r){const s=this.SPACE_SIZE*e/2,i=this.SPACE_SIZE*r,o=s+", "+i,c=s+this.SPACE_SIZE+", "+i,u=s+this.SPACE_SIZE/2+", "+(i+this.SPACE_SIZE),h=s+this.SPACE_SIZE/2+", "+(i+this.SPACE_SIZE/2);return o+","+u+","+h+","+o+","+h+","+c+","+o+","+c+","+u+","+h+","+c}getUpwardPyramidCoordinate(e,r){const s=this.SPACE_SIZE*e/2,i=(r+1)*this.SPACE_SIZE,o=s+", "+i,c=s+this.SPACE_SIZE+", "+i,u=s+this.SPACE_SIZE/2+", "+(i-this.SPACE_SIZE),h=s+this.SPACE_SIZE/2+", "+(i-this.SPACE_SIZE/2);return o+","+u+","+h+","+o+","+h+","+c+","+o+","+c+","+u+","+h+","+c}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=es(n)))(r||n)}}(),n.\u0275cmp=vt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),Rf=(()=>{class n{}return n.INVALID_DISTANCE=()=>$localize`Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is.`,n.NOT_ENOUGH_TILES_TO_EXCHANGE=()=>$localize`You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it.`,n.FIRST_CLICK_SHOULD_NOT_BE_NULL=()=>$localize`Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles.`,n.CANNOT_CAPTURE_FROM_EMPTY=()=>$localize`You cannot capture from an empty space.`,n.CANNOT_CAPTURE_OWN_PIECES=()=>$localize`You cannot capture your own pieces.`,n})();class Y1{constructor(t,e){this.direction=t,this.str=e}static fromCoords(t,e){const r=t.getVectorToward(e),s=Y1.STEPS.findIndex(i=>i.direction.equals(r));if(-1===s)throw new Error(Rf.INVALID_DISTANCE());return Y1.STEPS[s]}toInt(){return Y1.STEPS.findIndex(t=>t.direction.equals(this.direction))}equals(t){return this===t}toString(){return this.str}}Y1.LEFT=new Y1(new Un(-2,0),"LEFT"),Y1.UP_LEFT=new Y1(Pe.UP_LEFT,"UP_LEFT"),Y1.UP_RIGHT=new Y1(Pe.UP_RIGHT,"UP_RIGHT"),Y1.RIGHT=new Y1(new Un(2,0),"RIGHT"),Y1.DOWN_LEFT=new Y1(Pe.DOWN_LEFT,"DOWN_LEFT"),Y1.DOWN_RIGHT=new Y1(Pe.DOWN_RIGHT,"DOWN_RIGHT"),Y1.STEPS=[Y1.LEFT,Y1.UP_LEFT,Y1.UP_RIGHT,Y1.RIGHT,Y1.DOWN_LEFT,Y1.DOWN_RIGHT];class Ms extends so{constructor(t,e,r,s){super(),this.start=t,this.step=e,this.landingCoord=r,this.capture=s}static fromMovement(t,e){if(t.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");const r=new P(t.x+e.direction.x,t.y+e.direction.y);if(r.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new Ms(S.of(t),S.of(e),S.of(r),S.empty())}static fromTilesExchange(t){if(t.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new Ms(S.empty(),S.empty(),S.empty(),S.of(t))}static fromCoordToCoord(t,e){const r=Y1.fromCoords(t,e);return Ms.fromMovement(t,r)}isTileExchange(){return this.capture.isPresent()}toString(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}equals(t){return!(!this.capture.equals(t.capture)||!this.start.equals(t.start)||!this.step.equals(t.step))}}Ms.encoder=new class extends on{maxValue(){return 1035}encodeNumber(n){if(n.isTileExchange()){const t=n.capture.get().y;return 10*n.capture.get().x+t}{const t=n.start.get().y,e=n.start.get().x;return 150*(n.step.get().toInt()+1)+10*e+t}}decodeNumber(n){if(n%1!=0)throw new Error("EncodedMove must be an integer.");const t=n%10,e=(n=(n-t)/10)%15;return 0==(n=(n-e)/15)?Ms.fromTilesExchange(new P(e,t)):Ms.fromMovement(new P(e,t),Y1.STEPS[n-1])}};class nc{static getNeighbors(t){let e;const r=new P(t.x-1,t.y),s=new P(t.x+1,t.y);return e=(t.x+t.y)%2==1?[r,s,new P(t.x,t.y-1)]:[r,s,new P(t.x,t.y+1)],e}static getFakeNeighbors(t){return new P(t.x,(t.x+t.y)%2==1?t.y+1:t.y-1)}static getCommonNeighbor(t,e){const r=nc.getNeighbors(t),s=nc.getNeighbors(e);let i=0;for(;i<r.length;){const o=r[i];let c=0;for(;c<s.length;){if(o.equals(s[c]))return S.of(o);c++}i++}return S.empty()}static isSpaceDark(t){return(t.x+t.y)%2==0}}class D8 extends Vs{static getEmptyNeighbors(t,e,r){const s=[];for(const i of nc.getNeighbors(e))i.isInRange(t[0].length,t.length)&&t[i.y][i.x]===r&&s.push(i);return s}getEmptyNeighbors(t,e){return D8.getEmptyNeighbors(this.board,t,e)}}class y1 extends D8{constructor(t,e,r,s){super(t,e),this.tiles=r,this.captures=s}static getTilesUpperLeftCoord(t){const e=t.x-t.x%3;let r=t.y;return r-=e%2==0?t.y%2:(t.y+1)%2,new P(e,r)}static getPresentNeighborEntrances(t){return[new P(t.x+1,t.y-1),new P(t.x+3,t.y+0),new P(t.x+3,t.y+1),new P(t.x+1,t.y+2),new P(t.x-1,t.y+1),new P(t.x-1,t.y+0)].filter(y1.isInRange)}static getInitialState(){const t=be.EMPTY,e=be.UNREACHABLE,r=be.ZERO,s=be.ONE;return new y1([[e,e,e,e,e,e,r,t,r,e,e,e,e,e,e],[e,e,e,t,t,r,t,t,t,r,t,t,e,e,e],[t,s,t,s,t,t,r,t,r,t,t,s,t,s,t],[s,t,t,t,s,t,t,t,t,t,s,t,t,t,s],[t,s,t,s,t,t,t,t,t,t,t,s,t,s,t],[t,r,t,r,t,t,t,t,t,t,t,r,t,r,t],[r,t,t,t,r,t,t,t,t,t,r,t,t,t,r],[t,r,t,r,t,t,s,t,s,t,t,r,t,r,t],[e,e,e,t,t,s,t,t,t,s,t,t,e,e,e],[e,e,e,e,e,e,s,t,s,e,e,e,e,e,e]],0,[0,0],[0,0])}applyLegalMovement(t){Y(y1.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:t}});const e=t.start.get(),r=t.landingCoord.get(),s=this.getCopiedBoard();return s[r.y][r.x]=be.ofPlayer(this.getCurrentPlayer()),s[e.y][e.x]=be.EMPTY,new y1(s,this.turn,this.tiles,this.captures)}doMovementCaptures(t){Y(y1.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:t}});const e=this.getCapturedNeighbors(t.landingCoord.get());let r=this;for(const s of e)r=r.capture(s);return r}getCapturedNeighbors(t){const e=this.getCurrentOpponent();return nc.getNeighbors(t).filter(s=>!s.isNotInRange(15,10)&&!!this.getPieceAt(s).is(e)&&this.isSurrounded(s))}isSurrounded(t){return 0===this.getEmptyNeighbors(t,be.EMPTY).length}capture(t){Y(y1.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:t}});const e=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return Y(y1.VERBOSE,t.toString()+" has been captured"),e[t.y][t.x]=be.EMPTY,r[this.getCurrentPlayer().value]+=1,new y1(e,this.turn,this.tiles,r)}removeTilesIfNeeded(t,e){Y(y1.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,piece:t,countTiles:e}});let r=this;const s=y1.getTilesUpperLeftCoord(t);if(this.isTileEmpty(s)&&this.isDeconnectable(s)){r=this.deconnectTile(s,e);const i=y1.getPresentNeighborEntrances(s);for(const o of i){const c=r.getPieceAt(o);c===be.EMPTY?r=r.removeTilesIfNeeded(o,e):c.is(this.getCurrentOpponent())&&r.isSurrounded(o)&&(r=r.capture(o))}}return r}isTileEmpty(t){Se(this.getPieceAt(t)!==be.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(let e=0;e<2;e++)for(let r=0;r<3;r++){const s=t.getNext(new Un(r,e),1);if(this.getPieceAt(s)!==be.EMPTY)return!1}return!0}isDeconnectable(t){const e=this.getPresentNeighborTilesRelativeIndexes(t);if(e.length>3)return!1;let r=0;for(let s=1;s<e.length;s++)!1===this.areNeighbor(e[s-1],e[s])&&(r+=1);return!1===this.areNeighbor(e[0],e[e.length-1])&&(r+=1),r<=1}areNeighbor(t,e){return t+1===e||0===t&&5===e}getPresentNeighborTilesRelativeIndexes(t){const e=[];let r=S.empty();for(let s=0;s<6;s++){const o=t.getNext(y1.NEIGHBORS_TILES_DIRECTIONS[s],1);o.isInRange(15,10)&&this.getPieceAt(o)!==be.UNREACHABLE&&(r.isAbsent()&&(r=S.of(s)),e.push(s-r.get()))}return e}deconnectTile(t,e){Y(y1.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:t,countTiles:e}});const r=this.getCopiedBoard(),s=t.x,i=t.y;for(let c=0;c<2;c++)for(let u=0;u<3;u++)r[i+c][s+u]=be.UNREACHABLE;const o=[this.tiles[0],this.tiles[1]];return e&&(o[this.getCurrentPlayer().value]+=1),new y1(r,this.turn,o,this.captures)}getLegalLandings(t){const e=[];for(const r of Y1.STEPS){const s=t.getNext(r.direction,1);this.isOnBoard(s)&&this.getPieceAt(s)===be.EMPTY&&e.push(s)}return e}getPiecesByFreedom(){const t=[[0,0,0,0],[0,0,0,0]];for(let e=0;e<10;e++)for(let r=0;r<15;r++){const s=this.board[e][r];if(s.isPlayer()){const i=this.getEmptyNeighbors(new P(r,e),be.EMPTY).length;t[s.value][i]=t[s.value][i]+1}}return t}}y1.VERBOSE=!1,y1.NEIGHBORS_TILES_DIRECTIONS=[new Un(0,-2),new Un(3,-1),new Un(3,1),new Un(0,2),new Un(-3,1),new Un(-3,-1)],y1.isInRange=n=>n.isInRange(15,10);let AS=(()=>{class n extends hr{applyLegalMove(e,r,s){return e.isTileExchange()?this.applyLegalTileExchange(e,r):this.applyLegalMovement(e,r)}applyLegalTileExchange(e,r){const s=r.getCopiedBoard(),i=e.capture.get();s[i.y][i.x]=be.EMPTY;const o=[r.captures[0],r.captures[1]];o[r.getCurrentPlayer().value]+=1;const c=[r.tiles[0],r.tiles[1]];c[r.getCurrentPlayer().value]-=2;const u=new y1(s,r.turn,c,o),h=u.removeTilesIfNeeded(i,!1),g=new y1(h.getCopiedBoard(),h.turn+1,h.tiles,h.captures);return Y(n.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:r,afterCapture:u,afterTileRemoval:h,resultingState:g}}),g}applyLegalMovement(e,r){const s=r.applyLegalMovement(e),i=s.removeTilesIfNeeded(e.start.get(),!0),o=i.doMovementCaptures(e),c=new y1(o.board,r.turn+1,o.tiles,o.captures);return Y(n.VERBOSE,{ab_state:r,afterMovement:s,afterTilesRemoved:i,afterCaptures:o,resultingState:c}),c}isLegal(e,r){return e.isTileExchange()?this.isLegalTileExchange(e,r):this.isLegalMovement(e,r)}isLegalTileExchange(e,r){if(r.tiles[r.getCurrentPlayer().value]<2)return K.failure(Rf.NOT_ENOUGH_TILES_TO_EXCHANGE());const s=r.getPieceAt(e.capture.get());return s===be.UNREACHABLE||s===be.EMPTY?K.failure(Rf.CANNOT_CAPTURE_FROM_EMPTY()):s.is(r.getCurrentPlayer())?K.failure(Rf.CANNOT_CAPTURE_OWN_PIECES()):K.success(void 0)}isLegalMovement(e,r){if(r.getPieceAt(e.start.get())===be.UNREACHABLE){const o="Cannot start with a coord outside the board "+e.start.get().toString()+".";return K.failure(o)}if(r.getPieceAt(e.landingCoord.get())===be.UNREACHABLE){const o="Cannot end with a coord outside the board "+e.landingCoord.get().toString()+".";return K.failure(o)}const s=r.getPieceAt(e.start.get());return s===be.EMPTY?K.failure(Mt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):s.is(r.getCurrentOpponent())?K.failure(Mt.CANNOT_CHOOSE_OPPONENT_PIECE()):r.getPieceAt(e.landingCoord.get()).is(r.getCurrentPlayer())?K.failure(Mt.MUST_LAND_ON_EMPTY_SPACE()):K.success(void 0)}static getGameStatus(e){const r=e.gameState;return r.captures[0]>=18?ze.ZERO_WON:r.captures[1]>=18?ze.ONE_WON:ze.ONGOING}getGameStatus(e){return n.getGameStatus(e)}}return n.VERBOSE=!1,n})();class zae extends rr{getListMoves(t){let e=this.getListExchanges(t);return e=e.concat(this.getListMovement(t)),this.putCaptureFirst(t,e)}getListExchanges(t){const e=[],r=t.gameState,s=r.getCurrentPlayer().value,i=be.ofPlayer(r.getCurrentOpponent());if(r.tiles[s]<2)return e;for(let o=0;o<10;o++)for(let c=0;c<15;c++){const u=new P(c,o);if(r.getPieceAt(u)===i){const h=Ms.fromTilesExchange(u);e.push(h)}}return e}getListMovement(t){const e=[],r=t.gameState,s=r.getCurrentPlayer();for(let i=0;i<10;i++)for(let o=0;o<15;o++){const c=new P(o,i);if(r.getPieceAt(c).is(s)){const u=r.getLegalLandings(c);for(const h of u){const g=Ms.fromCoordToCoord(c,h);e.push(g)}}}return e}getBoardValue(t){const e=AS.getGameStatus(t);if(e.isEndGame)return dt.fromWinner(e.winner);const r=t.gameState,s=r.getPiecesByFreedom(),i=this.getPiecesScore(s);return new dt(2*r.captures[1]+i[1]-(2*r.captures[0]+i[0]))}getPiecesScore(t){return[this.getPlayerPiecesScore(t[0]),this.getPlayerPiecesScore(t[1])]}getPlayerPiecesScore(t){return 3*t[0]+1*t[1]+3*t[2]+3*t[3]}putCaptureFirst(t,e){return ht.sortByDescending(e,r=>this.moveCapturesList(t,r).length),e}moveCapturesList(t,e){return e.isTileExchange()?[e.capture.get()]:t.gameState.applyLegalMovement(e).removeTilesIfNeeded(e.start.get(),!0).getCapturedNeighbors(e.landingCoord.get())}}let h3t=(()=>{class n extends zae{getBoardValue(e){const r=AS.getGameStatus(e);if(r.isEndGame)return dt.fromWinner(r.winner);const s=e.gameState,i=this.getPiecesMap(s),o=this.getThreatMap(s,i),c=this.filterThreatMap(o,s);let u=0;for(const h of F.PLAYERS)for(const g of i.get(h).get())c.get(g).isPresent()?u+=h.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE:u+=h.getScoreModifier()*n.SCORE_BY_SAFE_PIECE;return u+=s.tiles[1]-s.tiles[0],new dt(u)}getPiecesMap(e){const r=new Qn,s=[],i=[];for(let o=0;o<10;o++)for(let c=0;c<15;c++){const u=new P(c,o),h=e.getPieceAt(u);h===be.ZERO?s.push(u):h===be.ONE&&i.push(u)}return r.set(F.ZERO,new dr(s)),r.set(F.ONE,new dr(i)),r}getThreatMap(e,r){const s=new Qn;for(const i of F.PLAYERS)for(const o of r.get(i).get()){const c=this.getThreat(o,e);c.isPresent()&&s.set(o,c.get())}return s}getThreat(e,r){const i=F.of(r.getPieceAt(e).value).getOpponent();let o=S.empty(),c=S.empty(),u=[];const h=nc.getNeighbors(e).filter(g=>g.isInRange(15,10));for(const g of h){const m=r.getPieceAt(g);if(m.is(i))u.push(g),this.tileCouldBeRemovedThisTurn(g,r,i)&&(c=S.of(g));else if(m===be.EMPTY){if(o.isPresent())return S.empty();o=S.of(g)}}if(o.isPresent()){const g=[];for(const m of Y1.STEPS){const v=o.get().getNext(m.direction,1);v.isInRange(15,10)&&r.getPieceAt(v).is(i)&&!1===u.some(T=>T.equals(v))&&g.push(v)}if(g.length>0)return S.of(new bS(new dr(u),new dr(g)))}if(c.isPresent()){u=u.filter(m=>m.equals(c.get()));const g=new dr(u);return S.of(new bS(g,new dr([c.get()])))}return S.empty()}tileCouldBeRemovedThisTurn(e,r,s){const i=s.getOpponent();if(!1===r.isDeconnectable(e))return!1;let c=S.empty();const u=y1.getTilesUpperLeftCoord(e);for(let h=0;h<2;h++)for(let g=0;g<3;g++){const m=u.getNext(new Un(g,h),1);if(r.getPieceAt(m).is(s)){if(!this.pieceCouldLeaveTheTile(m,r))return!1;c=S.of(m)}else if(r.getPieceAt(m).is(i))return!1}return c.isPresent()}pieceCouldLeaveTheTile(e,r){const s=y1.getTilesUpperLeftCoord(e);for(const i of Y1.STEPS){const o=e.getNext(i.direction,1),c=y1.getTilesUpperLeftCoord(o);if(!1===s.equals(c)&&r.getPieceAt(o)===be.EMPTY)return!0}return!1}filterThreatMap(e,r){const s=new Qn,i=e.listKeys(),o=i.filter(u=>r.getPieceAt(u).is(r.getCurrentPlayer())),c=new dr(i.filter(u=>r.getPieceAt(u).is(r.getCurrentOpponent())));for(const u of o){const h=e.get(u).get();let g=S.empty();for(const m of h.directThreats)if(!1===c.contains(m)){const v=[];for(const T of h.mover)!1===c.contains(T)&&v.push(T);v.length>0&&(g=S.of(new bS(h.directThreats,new dr(v))))}g.isPresent()&&s.set(u,g.get())}for(const u of c){const h=e.get(u).get();s.set(u,h)}return s}}return n.SCORE_BY_THREATENED_PIECE=1e3,n.SCORE_BY_SAFE_PIECE=1e6,n})();const ae=be.EMPTY,H=be.UNREACHABLE,D1=be.ZERO,Yn=be.ONE;class Vae extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Board and goal of the game`,$localize`Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.
         The triangles are the spaces on which pieces move during the game.
         The tiles can be removed from the board (you will see how later).
         The dark pieces belong to the first player and can only move on the dark spaces,
         while the light pieces belong to the second player and can only move on the light spaces.
         The goal of the game is to capture all of the opponent's pieces.`,y1.getInitialState()),pe.anyMove($localize`Move`,$localize`To move a piece, you need to:
        <ol>
          <li>Click on one of your pieces.</li>
          <li>Click on one of the triangular space highlighted in yellow.</li>
        </ol>
        You can pass through the opponent's pieces.
        You're playing first, hence you're playing Dark.<br/><br/>
        Perform any move.`,y1.getInitialState(),Ms.fromCoordToCoord(new P(3,5),new P(5,5)),$localize`Congratulations! Let's see captures now.`),pe.fromMove($localize`Capture`,$localize`Every piece has three neighboring triangular spaces (2 on the sides).
        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!
        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>
        You're playing Light, make a capture.`,new y1([[H,H,H,H,H,H,D1,ae,D1,H,H,H,H,H,H],[H,H,H,D1,ae,ae,ae,ae,ae,D1,ae,ae,H,H,H],[ae,Yn,ae,Yn,D1,Yn,ae,ae,D1,ae,ae,Yn,ae,Yn,ae],[Yn,ae,ae,ae,ae,ae,ae,ae,ae,ae,Yn,ae,ae,ae,Yn],[ae,Yn,ae,Yn,ae,ae,ae,ae,ae,ae,ae,Yn,ae,Yn,ae],[ae,D1,ae,D1,ae,ae,ae,ae,ae,ae,ae,D1,ae,D1,ae],[D1,ae,ae,ae,D1,ae,ae,ae,ae,ae,D1,ae,ae,ae,D1],[ae,D1,ae,D1,ae,ae,Yn,ae,Yn,ae,ae,D1,ae,D1,ae],[H,H,H,ae,ae,Yn,ae,ae,ae,Yn,ae,ae,H,H,H],[H,H,H,H,H,H,Yn,ae,Yn,H,H,H,H,H,H]],3,[0,0],[0,0]),[Ms.fromCoordToCoord(new P(5,2),new P(4,1)),Ms.fromCoordToCoord(new P(3,4),new P(4,3))],$localize`Congratulations!`,$localize`Failed, you have not captured any piece.`),pe.fromMove($localize`Gain a tile`,$localize`When a tile is empty, it can become removable from the board.
        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.
        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.
        For example, here, the topmost dark piece will not disconnect its tile when leaving it.
        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>
        Perform a move that lets you gain two tiles.`,new y1([[H,H,H,H,H,H,ae,ae,ae,H,H,H,H,H,H],[H,H,H,H,H,H,Yn,ae,ae,H,H,H,H,H,H],[ae,ae,ae,H,H,H,ae,ae,ae,H,H,H,H,H,H],[ae,ae,Yn,ae,ae,ae,ae,D1,ae,H,H,H,H,H,H],[ae,ae,ae,Yn,ae,ae,ae,ae,ae,H,H,H,H,H,H],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,D1,H,H,H],[ae,ae,D1,ae,ae,Yn,ae,ae,ae,ae,D1,ae,ae,ae,D1],[ae,ae,ae,ae,ae,ae,Yn,ae,Yn,ae,ae,D1,ae,D1,ae],[H,H,H,ae,ae,Yn,ae,ae,ae,Yn,ae,ae,H,H,H],[H,H,H,H,H,H,Yn,ae,Yn,H,H,H,H,H,H]],2,[0,0],[0,0]),[Ms.fromCoordToCoord(new P(2,6),new P(4,6)),Ms.fromCoordToCoord(new P(2,6),new P(3,5)),Ms.fromCoordToCoord(new P(2,6),new P(3,7))],$localize`Congratulations!`,$localize`Failed, you have not gained the two tiles that you could, try again!`),pe.fromMove($localize`Exchanging a tile`,$localize`When you have a tile, you can see it on the left of the board.
        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.
        This will cost you two tiles.
        If any tiles are removed during that turn, nobody will get them.<br/><br/>
        Gain some time and capture the last piece!`,new y1([[H,H,H,H,H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H,H,H,H,H],[H,H,H,ae,ae,D1,H,H,H,H,H,H,H,H,H],[H,H,H,ae,ae,ae,ae,ae,ae,H,H,H,H,H,H],[H,H,H,ae,ae,ae,Yn,ae,Yn,H,H,H,H,H,H],[H,H,H,ae,ae,Yn,ae,ae,ae,H,H,H,H,H,H],[H,H,H,H,H,H,Yn,ae,Yn,H,H,H,H,H,H]],1,[0,2],[0,0]),[Ms.fromTilesExchange(new P(5,5))],$localize`Congratulations!`,$localize`It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!`),pe.fromMove($localize`Special capture`,$localize`When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!
        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>
        A move that demonstrate both of these things can be done on this board by Light. Try it!`,new y1([[H,H,H,H,H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,ae,ae,D1,H,H,H,H,H,H],[H,H,H,ae,ae,D1,ae,ae,ae,H,H,H,H,H,H],[H,H,H,ae,D1,Yn,ae,Yn,ae,H,H,H,H,H,H],[H,H,H,ae,Yn,D1,ae,ae,ae,H,H,H,H,H,H],[H,H,H,ae,ae,Yn,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H,H,H,H,H]],1,[0,0],[0,0]),[Ms.fromCoordToCoord(new P(7,6),new P(6,5)),Ms.fromCoordToCoord(new P(7,6),new P(8,5))],$localize`Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.
        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space.`,$localize`Failed!`)]}}function d3t(n,t){if(1&n&&(B(),X(0,"polygon",13)),2&n){const e=E().index,r=E().index,s=E();w("ngClass",s.getPyramidClass(e,r)),V("points",s.getPyramidCoordinate(e,r))}}function p3t(n,t){if(1&n&&(B(),X(0,"polygon",15)),2&n){const e=E(2).index,r=E().index,s=E();w("ngClass",s.getEmptyClass(e,r)),V("points",s.getTriangleCoordinate(e,r))}}function g3t(n,t){if(1&n&&(B(),k(0,p3t,1,2,"polygon",14)),2&n){const e=E().index,r=E().index;w("ngIf",E().isEmptySpace(e,r))}}function m3t(n,t){if(1&n&&(B(),X(0,"polygon",16)),2&n){const e=E().index,r=E().index,s=E();je("id","dark_line_",e,"_",r,""),V("points",s.getLineCoordinate(e,r))}}function _3t(n,t){if(1&n&&(B(),X(0,"polygon",17)),2&n){const e=E().index,r=E().index,s=E();je("id","dark_line_",e,"_",r,""),V("points",s.getLineCoordinate(e,r))}}function v3t(n,t){if(1&n){const e=we();B(),N(0,"g",8),se("click",function(){const i=he(e).index,o=E().index;return ce(E().onClick(i,o))}),k(1,d3t,1,2,"polygon",9),k(2,g3t,1,1,"ng-template",null,10,l1),k(4,m3t,1,3,"polygon",11),k(5,_3t,1,3,"polygon",12),A()}if(2&n){const e=t.$implicit,r=t.index,s=s1(3),i=E().index,o=E();je("id","click_",r,"_",i,""),M(1),w("ngIf",o.isPyramid(r,i))("ngIfElse",s),M(3),w("ngIf",e!==o.NONE),M(1),w("ngIf",e!==o.NONE)}}function C3t(n,t){if(1&n&&(B(),N(0,"g"),k(1,v3t,6,6,"g",7),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}function y3t(n,t){if(1&n&&(B(),X(0,"polygon",18)),2&n){const e=t.$implicit;V("points",E().getTriangleCoordinate(e.x,e.y))}}function E3t(n,t){if(1&n&&(B(),X(0,"polygon",19)),2&n){const e=E();V("points",e.getTriangleCoordinate(e.lastStart.get().x,e.lastStart.get().y))}}function M3t(n,t){if(1&n&&(B(),X(0,"polygon",19)),2&n){const e=E();V("points",e.getTriangleCoordinate(e.lastEnd.get().x,e.lastEnd.get().y))}}function S3t(n,t){if(1&n&&(B(),X(0,"polygon",20)),2&n){const e=E();je("id","selected_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),V("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y))}}function P3t(n,t){if(1&n&&(B(),N(0,"g",21),X(1,"polygon",22),N(2,"text",23),Et(3),A()()),2&n){const e=E();M(1),V("points",e.getTilesCountCoordinate(0,0))("stroke",e.lastTurnWasTilesExchange(0)?"yellow":"black"),M(1),V("x",e.SPACE_SIZE/2+0*e.SPACE_SIZE)("y",16+e.SPACE_SIZE/2+0*e.SPACE_SIZE)("font-size",e.SPACE_SIZE/2),M(1),jn(e.tiles[0])}}function T3t(n,t){if(1&n&&(B(),N(0,"g",24),X(1,"polygon",25),N(2,"text",26),Et(3),A()()),2&n){const e=E();M(1),V("points",e.getTilesCountCoordinate(0,9))("stroke",e.lastTurnWasTilesExchange(1)?"yellow":"black"),M(1),V("x",e.SPACE_SIZE/2+0*e.SPACE_SIZE)("y",16+e.SPACE_SIZE/2+9*e.SPACE_SIZE)("font-size",e.SPACE_SIZE/2),M(1),jn(e.tiles[1])}}let w3t=(()=>{class n extends Dae{constructor(e){super(e),this.tiles=[0,0],this.NONE=be.UNREACHABLE,this.chosenCoord=S.empty(),this.lastStart=S.empty(),this.lastEnd=S.empty(),this.possibleLandings=[],this.scores=S.of([0,0]),this.rules=new AS(y1),this.availableMinimaxes=[new zae(this.rules,"Normal"),new h3t(this.rules,"Piece > Threat > Tiles")],this.encoder=Ms.encoder,this.tutorial=(new Vae).tutorial,this.SPACE_SIZE=70,this.updateBoard()}updateBoard(){this.chosenCoord=S.empty(),this.state=this.getState(),this.scores=S.of(this.state.captures),this.tiles=this.state.tiles;const e=this.rules.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=S.empty(),this.lastEnd=S.empty()),this.board=this.getState().board}showHighlight(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}cancelMoveAttempt(){this.chosenCoord=S.empty(),this.possibleLandings=[]}onClick(e,r){var s=this;return O(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new P(e,r),c=s.state.getCurrentPlayer();return s.chosenCoord.equalsValue(o)?(s.cancelMoveAttempt(),G.SUCCESS):s.chosenCoord.isAbsent()||s.state.getPieceAt(o).is(c)?s.firstClick(o):s.secondClick(o)})()}firstClick(e){var r=this;return O(function*(){const s=r.state.getPieceAt(e);if(s.is(r.state.getCurrentOpponent())){const i=Ms.fromTilesExchange(e);return r.chooseMove(i,r.state,r.state.captures)}return s.is(r.state.getCurrentPlayer())?(r.chosenCoord=S.of(e),r.showHighlight(),G.SUCCESS):r.cancelMove(Rf.FIRST_CLICK_SHOULD_NOT_BE_NULL())})()}secondClick(e){var r=this;return O(function*(){if(r.possibleLandings.some(s=>s.equals(e))){const s=Ms.fromCoordToCoord(r.chosenCoord.get(),e);return r.chooseMove(s,r.state,r.state.captures)}return r.cancelMove(Rf.INVALID_DISTANCE())})()}isPyramid(e,r){return this.board[r][e].isPlayer()||this.wasOpponent(e,r)}wasOpponent(e,r){const s=this.rules.node.mother;return s.isPresent()&&s.get().gameState.getPieceAtXY(e,r).is(s.get().gameState.getCurrentOpponent())}getPyramidClass(e,r){const s=this.board[r][e];return s===be.ZERO?this.getPlayerClass(F.ZERO):s===be.ONE?this.getPlayerClass(F.ONE):"captured-fill"}isEmptySpace(e,r){return this.board[r][e]===be.EMPTY||this.wasRemoved(e,r)}wasRemoved(e,r){const i=this.rules.node.mother;if(this.board[r][e]===be.UNREACHABLE&&i.isPresent()){const o=i.get().gameState.getPieceAtXY(e,r);return o===be.EMPTY||o.is(i.get().gameState.getCurrentPlayer())}return!1}getEmptyClass(e,r){return this.board[r][e]===be.EMPTY?(e+r)%2==1?"background":"background2":"captured-alternate-fill"}getTilesCountCoordinate(e,r){const s=100*e,i=100*r,o=s+25;return o+", "+i+", "+(s+75)+", "+i+", "+(s+100)+", "+(i+50)+", "+(s+75)+", "+(i+100)+", "+(s+25)+", "+(i+100)+", "+(s+0)+", "+(i+50)+", "+o+", "+i}getLineCoordinate(e,r){const s=this.getTriangleCornerCoords(e,r);return e%3==0?s[0].x+","+s[0].y+","+s[1].x+","+s[1].y:e%3==1?s[0].x+","+s[0].y+","+s[2].x+","+s[2].y:s[1].x+","+s[1].y+","+s[2].x+","+s[2].y}mustShowTilesOf(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}lastTurnWasTilesExchange(e){return!this.rules.node.mother.isAbsent()&&this.rules.node.mother.get().gameState.tiles[e]>this.tiles[e]}}return n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-coerceo"]],features:[l],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke",4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke",4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],["id","tilesCountZero",4,"ngIf"],["id","tilesCountOne",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptySpace",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","selectable-stroke"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke",3,"id"],["id","tilesCountZero"],["stroke-linecap","round",1,"base","player0-fill"],["id","playerZeroTilesCount","text-anchor","middle",1,"text"],["id","tilesCountOne"],["stroke-linecap","round",1,"base","player1-fill"],["id","playerOneTilesCount","text-anchor","middle",1,"text"]],template:function(e,r){1&e&&(B(),N(0,"svg",0),k(1,C3t,2,1,"g",1),k(2,y3t,1,1,"polygon",2),k(3,E3t,1,1,"polygon",3),k(4,M3t,1,1,"polygon",3),k(5,S3t,1,3,"polygon",4),k(6,P3t,4,6,"g",5),k(7,T3t,4,6,"g",6),A()),2&e&&(V("viewBox","-5 -5 "+(10+8*r.SPACE_SIZE)+" "+(10+10*r.SPACE_SIZE)),M(1),w("ngForOf",r.board),M(1),w("ngForOf",r.possibleLandings),M(1),w("ngIf",r.lastStart.isPresent()),M(1),w("ngIf",r.lastEnd.isPresent()),M(1),w("ngIf",r.chosenCoord.isPresent()),M(1),w("ngIf",r.mustShowTilesOf(0)),M(1),w("ngIf",r.mustShowTilesOf(1)))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Tl=(()=>{class n{}return n.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=()=>$localize`Your piece should land on a neighboring square.`,n.CANNOT_DROP_AFTER_TURN_40=()=>$localize`You cannot drop a piece during the moving phase.`,n.CANNOT_MOVE_BEFORE_TURN_40=()=>$localize`You cannot move a piece before both players have dropped all of their pieces.`,n.MUST_JUMP_OVER_PIECES=()=>$localize`A jump must be made over a piece, not over an empty square.`,n.MUST_DROP_IN_CENTRAL_ZONE=()=>$localize`A drop must occur in the central zone of the board.`,n.INVALID_JUMP=()=>$localize`A jump must land two squares from its original position, and be done in a straight line in any direction.`,n.SAME_LOCATION_VISITED_IN_JUMP=()=>$localize`You are visiting the same location twice in a move, you are not allowed to do so.`,n})();class Nt extends Vs{static getInitialState(){const t=ht.createTable(Nt.WIDTH,Nt.HEIGHT,fe.NONE);return new Nt(t,0)}isShelter(t){return 0===t.x||t.x===Nt.WIDTH-1?Nt.SHELTERS_INDICES.some(e=>t.y===e):(0===t.y||t.y===Nt.HEIGHT-1)&&Nt.SHELTERS_INDICES.some(e=>t.x===e)}isCentralZone(t){return t.x>=Nt.CENTRAL_ZONE_TOP_LEFT.x&&t.x<=Nt.CENTRAL_ZONE_BOTTOM_RIGHT.x&&t.y>=Nt.CENTRAL_ZONE_TOP_LEFT.y&&t.y<=Nt.CENTRAL_ZONE_BOTTOM_RIGHT.y}isDropPhase(){return this.turn<40}getSidePieces(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}Nt.WIDTH=17,Nt.HEIGHT=17,Nt.CENTRAL_ZONE_TOP_LEFT=new P(4,6),Nt.CENTRAL_ZONE_BOTTOM_RIGHT=new P(12,10),Nt.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],Nt.ALL_SHELTERS=new Z1(Nt.SHELTERS_INDICES.flatMap(n=>[new P(n,0),new P(n,Nt.HEIGHT-1),new P(0,n),new P(Nt.WIDTH-1,n)])).toList();class C0 extends Yc{constructor(t){super(t.x,t.y)}static of(t){return t.isInRange(Nt.WIDTH,Nt.HEIGHT)?K.success(new C0(t)):K.failure("Move out of board")}toString(){return`ConspirateursMoveDrop(${this.coord.toString()})`}equals(t){return!!t.isDrop()&&this.coord.equals(t.coord)}isDrop(){return!0}isSimple(){return!1}isJump(){return!1}}C0.encoder=class Pct{static getEncoder(t,e,r){return new class extends on{constructor(){super(...arguments),this.shiftX=e}maxValue(){return(t-1)*this.shiftX+(e-1)}encodeNumber(s){return s.coord.x*this.shiftX+s.coord.y}decodeNumber(s){const i=s%e;s/=e;const c=new P((s-=s%1)%t,i);return r(c)}}}}.getEncoder(Nt.WIDTH,Nt.HEIGHT,n=>C0.of(n).get());class y0 extends tc{constructor(t,e){super(t,e)}static of(t,e){return t.isInRange(Nt.WIDTH,Nt.HEIGHT)&&e.isInRange(Nt.WIDTH,Nt.HEIGHT)?t.isAlignedWith(e)&&1===t.getDistance(e)?K.success(new y0(t,e)):K.failure(Tl.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):K.failure("Move out of board")}toString(){return`ConspirateursMoveSimple(${this.coord.toString()} -> ${this.end.toString()})`}equals(t){return!(!t.isSimple()||t!==this&&(!1===t.coord.equals(this.coord)||!1===t.end.equals(this.end)))}isDrop(){return!1}isSimple(){return!0}isJump(){return!1}}y0.encoder=tc.getEncoder(Nt.WIDTH,Nt.HEIGHT,(n,t)=>y0.of(n,t).get());class Jc extends so{constructor(t){super(),this.coords=t}static of(t){if(t.length<2)return K.failure("ConspirateursMoveJump requires at least one jump, so two coords");for(const r of t)if(r.isNotInRange(Nt.WIDTH,Nt.HEIGHT))return K.failure("Move out of board");for(let r=1;r<t.length;r++)if(t[r-1].getDirectionToward(t[r]).isFailure()||2!==t[r-1].getDistance(t[r]))return K.failure(Tl.INVALID_JUMP());return new dr(t).size()===t.length?K.success(new Jc(t)):K.failure(Tl.SAME_LOCATION_VISITED_IN_JUMP())}addJump(t){const e=ht.copyImmutableArray(this.coords);return e.push(t),Jc.of(e)}getStartingCoord(){return this.coords[0]}getEndingCoord(){return this.coords[this.coords.length-1]}getLandingCoords(){return this.coords.slice(1)}getJumpedOverCoords(){const t=[];for(let e=1;e<this.coords.length;e++){const r=this.coords[e-1].getDirectionToward(this.coords[e]).get();t.push(this.coords[e-1].getNext(r,1))}return t}toString(){return`ConspirateursMoveJump(${this.coords.map(e=>e.toString()).reduce((e,r)=>e+" -> "+r)})`}equals(t){return!(t.isSimple()||t.isDrop()||t!==this&&(!1===this.getStartingCoord().equals(t.getStartingCoord())||!1===this.getEndingCoord().equals(t.getEndingCoord())))}isDrop(){return!1}isSimple(){return!1}isJump(){return!0}}Jc.encoder=new class extends e4{constructor(){super(...arguments),this.coordEncoder=P.numberEncoder(Nt.WIDTH,Nt.HEIGHT)}encodeMove(n){return{coords:n.coords.map(this.coordEncoder.encodeNumber)}}decodeMove(n){Se(null!=Ae.getNonNullable(n).coords,"Encoded ConspirateursMoveJump should contain coords");const e=Ae.getNonNullable(n).coords.map(this.coordEncoder.decodeNumber);return Jc.of(e).get()}};const b3t=e4.disjunction3(C0.encoder,y0.encoder,Jc.encoder,n=>n.isDrop(),n=>n.isSimple());class Ca extends hr{constructor(){super(Nt)}static get(){return Ca.singleton.isAbsent()&&(Ca.singleton=S.of(new Ca)),Ca.singleton.get()}applyLegalMove(t,e,r){const s=e.getCopiedBoard();if(t.isDrop())s[t.coord.y][t.coord.x]=e.getCurrentPlayer();else if(t.isSimple())s[t.coord.y][t.coord.x]=fe.NONE,s[t.end.y][t.end.x]=e.getCurrentPlayer();else{const i=t.getStartingCoord(),o=t.getEndingCoord();s[i.y][i.x]=fe.NONE,s[o.y][o.x]=e.getCurrentPlayer()}return new Nt(s,e.turn+1)}isLegal(t,e){return t.isDrop()?this.dropLegality(t,e):t.isSimple()?this.simpleMoveLegality(t,e):this.jumpLegality(t,e)}dropLegality(t,e){return e.turn>=40?K.failure(Tl.CANNOT_DROP_AFTER_TURN_40()):e.getPieceAt(t.coord).isPlayer()?K.failure(Mt.MUST_LAND_ON_EMPTY_SPACE()):!1===e.isCentralZone(t.coord)?K.failure(Tl.MUST_DROP_IN_CENTRAL_ZONE()):K.success(void 0)}simpleMoveLegality(t,e){return e.turn<40?K.failure(Tl.CANNOT_MOVE_BEFORE_TURN_40()):e.getPieceAt(t.coord)!==e.getCurrentPlayer()?K.failure(Mt.MUST_CHOOSE_PLAYER_PIECE()):e.getPieceAt(t.end).isPlayer()?K.failure(Mt.MUST_LAND_ON_EMPTY_SPACE()):K.success(void 0)}jumpLegality(t,e){if(e.turn<40)return K.failure(Tl.CANNOT_MOVE_BEFORE_TURN_40());if(e.getPieceAt(t.getStartingCoord())!==e.getCurrentPlayer())return K.failure(Mt.MUST_CHOOSE_PLAYER_PIECE());for(const r of t.getJumpedOverCoords())if(e.getPieceAt(r)===fe.NONE)return K.failure(Tl.MUST_JUMP_OVER_PIECES());for(const r of t.getLandingCoords())if(e.getPieceAt(r).isPlayer())return K.failure(Mt.MUST_LAND_ON_EMPTY_SPACE());return K.success(void 0)}jumpTargetsFrom(t){const e=[new P(t.x+2,t.y),new P(t.x-2,t.y),new P(t.x,t.y+2),new P(t.x,t.y-2),new P(t.x+2,t.y+2),new P(t.x+2,t.y-2),new P(t.x-2,t.y+2),new P(t.x-2,t.y-2)],r=[];for(const s of e)Jc.of([t,s]).isSuccess()&&r.push(s);return r}nextJumps(t,e){const r=t.getEndingCoord(),s=[];for(const i of this.jumpTargetsFrom(r)){const o=t.addJump(i);o.isSuccess()&&this.jumpLegality(o.get(),e).isSuccess()&&s.push(o.get())}return s}jumpHasPossibleNextTargets(t,e){return this.nextJumps(t,e).length>0}getGameStatus(t){const e=t.gameState,r=[0,0];for(const s of Nt.ALL_SHELTERS){const i=e.getPieceAt(s);if(i.isPlayer()&&(r[i.value]+=1,20===r[i.value]))return ze.getVictory(i)}return ze.ONGOING}}Ca.singleton=S.empty();class N3t extends rr{getListMoves(t){return this.sortByNumberOfJump(t.gameState.turn<40?this.getListMovesDrop(t.gameState):this.getListMovesAfterDrop(t.gameState))}sortByNumberOfJump(t){return t.sort((e,r)=>{const s=e.isDrop()?1:e.isSimple()?2:e.coords.length;return(r.isDrop()?1:r.isSimple()?2:r.coords.length)-s})}getListMovesDrop(t){const e=[],r=Nt.CENTRAL_ZONE_TOP_LEFT,s=Nt.CENTRAL_ZONE_BOTTOM_RIGHT;for(let i=r.y;i<=s.y;i++)for(let o=r.x;o<=s.x;o++)t.getPieceAtXY(o,i)===fe.NONE&&e.push(C0.of(new P(o,i)).get());return e}getListMovesAfterDrop(t){let e=[];const r=t.getCurrentPlayer();for(let s=0;s<Nt.HEIGHT;s++)for(let i=0;i<Nt.WIDTH;i++){const o=new P(i,s);t.getPieceAt(o)===r&&(e=e.concat(this.getListSimpleMoves(t,o)),e=e.concat(this.getListJumps(t,o)))}return e}getListSimpleMoves(t,e){const r=[],s=[new P(e.x+1,e.y),new P(e.x-1,e.y),new P(e.x,e.y+1),new P(e.x,e.y-1),new P(e.x+1,e.y+1),new P(e.x+1,e.y-1),new P(e.x-1,e.y+1),new P(e.x-1,e.y-1)];for(const i of s){const o=y0.of(e,i);o.isSuccess()&&Ca.get().simpleMoveLegality(o.get(),t).isSuccess()&&r.push(o.get())}return r}getListJumps(t,e){const r=new Z1;for(const s of Ca.get().jumpTargetsFrom(e)){const i=Jc.of([e,s]).get();Ca.get().jumpLegality(i,t).isSuccess()&&(r.add(i),r.union(this.getListJumpStartingFrom(t,i)))}return r.toList()}getListJumpStartingFrom(t,e){const r=Ca.get().nextJumps(e,t),s=new Z1(r);for(const i of r)s.union(this.getListJumpStartingFrom(t,i));return s}getBoardValue(t){const e=t.gameState;let r=0;const s=new Qn([{key:F.ZERO,value:0},{key:F.ONE,value:0}]);for(let i=0;i<Nt.HEIGHT;i++)for(let o=0;o<Nt.WIDTH;o++){const c=new P(o,i),u=e.getPieceAt(c);if(u.isPlayer())if(e.isShelter(c)){if(r+=20*u.getScoreModifier(),s.replace(u,s.get(u).get()+1),20===s.get(u).get())return new dt(u.getVictoryValue())}else{let h=100;for(const g of Nt.ALL_SHELTERS)if(e.getPieceAt(g)===fe.NONE){const m=c.getOrthogonalDistance(g);h=Math.min(h,m)}r-=u.getScoreModifier()*h}}return new dt(r)}}const y=fe.NONE,At=fe.ZERO,Tt=fe.ONE;class Hae extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Board and aim of the game`,$localize`Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially.`,Nt.getInitialState()),pe.anyMove($localize`Initial phase`,$localize`In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>Drop one of your piece in the central zone.`,Nt.getInitialState(),C0.of(new P(7,7)).get(),$localize`Congratulations!`),pe.fromPredicate($localize`Simple move`,$localize`Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move.`,new Nt([[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,At,At,Tt,Tt,At,At,Tt,At,Tt,y,y,y,y],[y,y,y,y,At,Tt,At,Tt,At,At,At,At,Tt,y,y,y,y],[y,y,y,y,At,Tt,y,y,y,y,y,Tt,At,y,y,y,y],[y,y,y,y,Tt,At,At,Tt,Tt,Tt,At,At,At,y,y,y,y],[y,y,y,y,Tt,At,Tt,Tt,Tt,Tt,Tt,Tt,At,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y]],40),y0.of(new P(4,6),new P(3,5)).get(),(t,e,r)=>t.isSimple()?G.SUCCESS:G.failure($localize`You have made a jump, not a simple move. Try again!`),$localize`Congratulations!`),pe.fromPredicate($localize`Jumps`,$localize`The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful).`,new Nt([[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,At,At,Tt,Tt,At,At,Tt,At,Tt,y,y,y,y],[y,y,y,y,At,Tt,At,Tt,At,At,At,At,Tt,y,y,y,y],[y,y,y,y,At,Tt,y,y,y,y,y,Tt,At,y,y,y,y],[y,y,y,y,Tt,At,At,Tt,Tt,Tt,At,At,At,y,y,y,y],[y,y,y,y,Tt,At,Tt,Tt,Tt,Tt,Tt,Tt,At,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y]],40),Jc.of([new P(6,7),new P(6,5)]).get(),(t,e,r)=>t.isJump()?G.SUCCESS:G.failure($localize`You have not performed a jump. Try again!`),$localize`Congratulations!`),pe.fromMove($localize`Chaining jumps in a single move`,$localize`Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it.`,new Nt([[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,Tt,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,Tt,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,Tt,y,y,y,y,y,y,y,y,y],[y,y,y,y,At,At,y,Tt,At,At,Tt,At,Tt,y,y,y,y],[y,y,y,y,At,y,At,Tt,At,At,At,At,Tt,y,y,y,y],[y,y,y,y,At,Tt,y,y,y,y,y,Tt,At,y,y,y,y],[y,y,y,y,Tt,At,At,Tt,Tt,Tt,At,At,At,y,y,y,y],[y,y,y,y,Tt,At,Tt,Tt,Tt,Tt,Tt,Tt,At,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y]],40),[Jc.of([new P(8,6),new P(6,4),new P(6,2),new P(6,0)]).get()],$localize`Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does.`,$localize`You have not performed a triple jump. Try again!`)]}}function A3t(n,t){if(1&n){const e=we();B(),N(0,"rect",9),se("click",function(){he(e);const s=E().$implicit;return ce(E(2).onClick(s.coord))}),A()}if(2&n){const e=E().$implicit,r=E(2);V("x",1.5*r.STROKE_WIDTH+r.SPACE_SIZE*e.coord.x+r.STROKE_WIDTH)("y",1.5*r.STROKE_WIDTH+r.SPACE_SIZE*e.coord.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE-3*r.STROKE_WIDTH)("height",r.SPACE_SIZE-3*r.STROKE_WIDTH)}}function O3t(n,t){if(1&n){const e=we();B(),N(0,"circle",6),se("click",function(){he(e);const s=E().$implicit;return ce(E(2).onClick(s.coord))}),A()}if(2&n){const e=E(),r=e.index,s=e.$implicit,i=E().index,o=E();je("id","piece_",r,"_",i,""),w("ngClass",s.pieceClasses),V("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function I3t(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"rect",6),se("click",function(){const i=he(e).$implicit;return ce(E(2).onClick(i.coord))}),A(),k(2,A3t,1,4,"rect",7),k(3,O3t,1,6,"circle",8),A()}if(2&n){const e=t.$implicit,r=t.index,s=E().index,i=E();M(1),je("id","click_",r,"_",s,""),w("ngClass",e.squareClasses),V("x",i.SPACE_SIZE*r+i.STROKE_WIDTH)("y",i.SPACE_SIZE*s+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),M(1),w("ngIf",e.isShelter),M(1),w("ngIf",e.hasPiece)}}function x3t(n,t){if(1&n&&(B(),N(0,"g"),k(1,I3t,4,9,"g",1),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}function L3t(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"rect",10),se("click",function(){const i=he(e).$implicit;return ce(E().onClick(i))}),A()()}if(2&n){const e=t.$implicit,r=E();M(1),w("ngClass",r.viewInfo.boardInfo[e.y][e.x].shelterClasses),V("x",r.SPACE_SIZE*e.x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*e.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function k3t(n,t){if(1&n&&(B(),X(0,"circle",11)),2&n){const e=t.$implicit,r=E();L1("id","sidePiece_0_",e,""),V("cx",-r.PIECE_RADIUS)("cy",1670-e*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function R3t(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=t.$implicit,r=E();L1("id","sidePiece_1_",e,""),V("cx",1715+r.PIECE_RADIUS)("cy",1670-e*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function D3t(n,t){if(1&n&&(B(),X(0,"rect",13)),2&n){const e=E();V("x",e.SPACE_SIZE*e.CENTRAL_ZONE_START.x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.CENTRAL_ZONE_START.y+e.STROKE_WIDTH)("width",e.CENTRAL_ZONE_SIZE.x*e.SPACE_SIZE)("height",e.CENTRAL_ZONE_SIZE.y*e.SPACE_SIZE)}}let z3t=(()=>{class n extends m0{constructor(e){super(e),this.ALL_SHELTERS=Nt.ALL_SHELTERS,this.CENTRAL_ZONE_START=Nt.CENTRAL_ZONE_TOP_LEFT,this.CENTRAL_ZONE_SIZE=new Un(Nt.CENTRAL_ZONE_BOTTOM_RIGHT.x-Nt.CENTRAL_ZONE_TOP_LEFT.x+1,Nt.CENTRAL_ZONE_BOTTOM_RIGHT.y-Nt.CENTRAL_ZONE_TOP_LEFT.y+1),this.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},this.selected=S.empty(),this.jumpInConstruction=S.empty(),this.PIECE_RADIUS=this.SPACE_SIZE/2-this.STROKE_WIDTH,this.rules=Ca.get(),this.availableMinimaxes=[new N3t(this.rules,"ConspirateursMinimax")],this.encoder=b3t,this.tutorial=(new Hae).tutorial}ngOnInit(){this.updateBoard()}updateBoard(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}updateViewInfo(){const e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(let r=0;r<Nt.HEIGHT;r++){this.viewInfo.boardInfo.push([]);for(let s=0;s<Nt.WIDTH;s++){const i=new P(s,r),o=e.getPieceAt(i),c={coord:i,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(o)],hasPiece:o.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[r].push(c)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}updateOccupiedShelters(){for(const e of Nt.ALL_SHELTERS){const r=this.viewInfo.boardInfo[e.y][e.x];r.isShelter=!0,r.hasPiece&&r.shelterClasses.push("selectable-stroke")}}updateSelected(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){const e=this.jumpInConstruction.get(),r=e.getStartingCoord(),s=e.getEndingCoord();this.viewInfo.boardInfo[r.y][r.x].hasPiece=!1,this.viewInfo.boardInfo[s.y][s.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected-stroke"],this.viewInfo.boardInfo[s.y][s.x].hasPiece=!0;for(const i of e.coords)this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("moved-fill")}else{const e=this.selected.get();this.viewInfo.boardInfo[e.y][e.x].pieceClasses.push("selected-stroke")}}updateVictory(){const e=this.getState(),r=Ca.get().getGameStatus(this.rules.node);if(!0===r.isEndGame)for(const s of Nt.ALL_SHELTERS)e.getPieceAt(s)===r.winner&&this.viewInfo.boardInfo[s.y][s.x].squareClasses.push("victory-fill")}showLastMove(){const e=this.rules.node.move.get();if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved-fill");else if(e.isSimple())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved-fill"),this.viewInfo.boardInfo[e.end.y][e.end.x].squareClasses.push("moved-fill");else{this.viewInfo.lastMoveArrow="";for(const r of e.coords)this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved-fill"),this.viewInfo.lastMoveArrow+=r.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=r.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}cancelMoveAttempt(){this.jumpInConstruction=S.empty(),this.selected=S.empty(),this.updateBoard()}onClick(e){var r=this;return O(function*(){const s=r.canUserPlay("#click_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());const i=r.getState();if(i.getPieceAt(e)===r.getCurrentPlayer())return r.selected.equalsValue(e)?r.cancelMoveAttempt():(r.selected=S.of(e),r.jumpInConstruction=S.empty()),r.updateViewInfo(),G.SUCCESS;if(r.jumpInConstruction.isPresent())return r.constructJump(e);if(r.selected.isPresent())return r.selectNextCoord(e);if(i.isDropPhase()){const o=C0.of(e);return Se(o.isSuccess(),"ConspirateursMove should be valid by construction"),r.chooseMove(o.get(),i)}return r.cancelMove(Mt.MUST_CHOOSE_PLAYER_PIECE())})()}constructJump(e){var r=this;return O(function*(){const s=r.jumpInConstruction.get(),i=r.getState();if(e.equals(s.getEndingCoord()))return r.chooseMove(s,i);{const o=s.addJump(e);if(o.isFailure())return r.cancelMove(o.getReason());const c=r.rules.jumpLegality(o.get(),i);return c.isFailure()?r.cancelMove(c.getReason()):r.updateJump(o.get())}})()}updateJump(e){var r=this;return O(function*(){const s=r.getState();return r.rules.jumpHasPossibleNextTargets(e,s)?(r.jumpInConstruction=S.of(e),r.updateViewInfo(),G.SUCCESS):r.chooseMove(e,s)})()}selectNextCoord(e){var r=this;return O(function*(){const s=r.selected.get(),i=y0.of(s,e);if(i.isSuccess())return r.chooseMove(i.get(),r.getState());{const o=Jc.of([s,e]);return o.isFailure()?r.cancelMove(o.getReason()):r.updateJump(o.get())}})()}}return n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-conspirateurs"]],features:[l],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1-fill",3,"id",4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0-fill",3,"id"],[1,"base","mid-stroke","player1-fill",3,"id"],[1,"base","no-fill","selectable-stroke","mid-stroke"]],template:function(e,r){1&e&&(B(),N(0,"svg",0),k(1,x3t,2,1,"g",1),k(2,L3t,2,5,"g",1),k(3,k3t,1,4,"circle",2),k(4,R3t,1,4,"circle",3),k(5,D3t,1,4,"rect",4),X(6,"polyline",5),A()),2&e&&(M(1),w("ngForOf",r.viewInfo.boardInfo),M(1),w("ngForOf",r.ALL_SHELTERS),M(1),w("ngForOf",r.range(r.viewInfo.sidePieces[0])),M(1),w("ngForOf",r.range(r.viewInfo.sidePieces[1])),M(1),w("ngIf",r.viewInfo.dropPhase),M(1),V("points",r.viewInfo.lastMoveArrow))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class gn{constructor(t,e){this.owner=t,this.otherPieceType=e}static of(t,e){return t===F.ZERO?e?gn.ZERO_SECOND:gn.ZERO_FIRST:t===F.ONE?e?gn.ONE_SECOND:gn.ONE_FIRST:gn.EMPTY}toString(){return`DiamPiece(${this.owner}, ${this.otherPieceType})`}}gn.encoder=on.tuple([F.numberEncoder,on.booleanEncoder],n=>[n.owner,n.otherPieceType],n=>gn.of(n[0],n[1])),gn.EMPTY=new gn(fe.NONE,!1),gn.ZERO_FIRST=new gn(F.ZERO,!1),gn.ZERO_SECOND=new gn(F.ZERO,!0),gn.ONE_FIRST=new gn(F.ONE,!1),gn.ONE_SECOND=new gn(F.ONE,!0),gn.PLAYER_PIECES=[gn.ZERO_FIRST,gn.ZERO_SECOND,gn.ONE_FIRST,gn.ONE_SECOND];class Df extends so{constructor(t,e){if(super(),this.target=t,this.piece=e,e===gn.EMPTY)throw new Error("Cannot drop an empty piece")}isDrop(){return!0}getTarget(){return this.target}equals(t){return!(this.target!==t.target||this.piece!==t.piece)}toString(){return`DiamMoveDrop(${this.target}, ${this.piece})`}}Df.encoder=on.tuple([on.numberEncoder(7),gn.encoder],n=>[n.target,n.piece],n=>new Df(n[0],n[1]));class Ai extends so{constructor(t,e){super(),this.start=t,this.moveDirection=e}static fromRepresentation(t,e){return new Ai(new P(t.x,3-t.y),e)}isDrop(){return!1}getTarget(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}equals(t){return!(!1===this.start.equals(t.start)||this.moveDirection!==t.moveDirection)}toString(){return`DiamMoveShift(${this.start}, ${this.moveDirection})`}}Ai.encoder=on.tuple([P.numberEncoder(8,4),on.booleanEncoder],n=>[n.start,"clockwise"===n.moveDirection],n=>new Ai(n[0],n[1]?"clockwise":"counterclockwise"));const V3t=on.disjunction(Df.encoder,Ai.encoder,n=>n.isDrop());let Qg=(()=>{class n{}return n.NO_MORE_PIECES_OF_THIS_TYPE=()=>$localize`You do not have any pieces of this type anymore.`,n.SPACE_IS_FULL=()=>$localize`You cannot play here: this space is already full.`,n.TARGET_STACK_TOO_HIGH=()=>$localize`You cannot add more pieces to the target stack, as it will contain more than 4 pieces.`,n.MUST_SHIFT_TO_NEIGHBOR=()=>$localize`To perform a shift, you must move the pieces to a neighboring space.`,n.MUST_SELECT_PIECE_FIRST=()=>$localize`You must first select either a piece from the side, or a stack of pieces to shift on the board.`,n})(),Dr=(()=>{class n extends Vs{constructor(e,r,s){super(e,s),this.remainingPieces=r}static getInitialState(){const e=gn.EMPTY;return new n([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}static fromRepresentation(e,r){const s=e.reverse(),i=[4,4,4,4];for(let o=0;o<n.HEIGHT;o++)for(let c=0;c<n.WIDTH;c++){const u=s[o][c];s[o][c]!==gn.EMPTY&&i[n.pieceIndex(u)]--}return Se(i.every(o=>o>=0),"Invalid DiamState representation uses too many pieces"),new n(s,i,r)}static pieceIndex(e){switch(e){case gn.ZERO_FIRST:return 0;case gn.ZERO_SECOND:return 1;case gn.ONE_FIRST:return 2;default:return Ae.expectToBe(e,gn.ONE_SECOND),3}}getRemainingPiecesOf(e){return this.remainingPieces[n.pieceIndex(e)]}getStackHeight(e){let r=0;for(let s=0;s<n.HEIGHT&&this.getPieceAtXY(e,s)!==gn.EMPTY;s++)r++;return r}}return n.WIDTH=8,n.HEIGHT=4,n})();class e3 extends hr{constructor(){super(Dr)}static get(){return e3.singleton.isAbsent()&&(e3.singleton=S.of(new e3)),e3.singleton.get()}applyLegalMove(t,e,r){return t.isDrop()?this.applyLegalDrop(t,e):this.applyLegalShift(t,e)}applyLegalDrop(t,e){const r=ht.copyBiArray(e.board);r[e.getStackHeight(t.target)][t.target]=t.piece;const s=ht.copyImmutableArray(e.remainingPieces);return s[Dr.pieceIndex(t.piece)]-=1,new Dr(r,s,e.turn+1)}applyLegalShift(t,e){const r=ht.copyBiArray(e.board),s=t.getTarget();let i=e.getStackHeight(s),o=t.start.y;for(;o<Dr.HEIGHT&&e.getPieceAtXY(t.start.x,o)!==gn.EMPTY;)r[i][s]=e.getPieceAtXY(t.start.x,o),r[o][t.start.x]=gn.EMPTY,i++,o++;return new Dr(r,e.remainingPieces,e.turn+1)}isLegal(t,e){return t.isDrop()?this.isDropLegal(t,e):this.isShiftLegal(t,e)}isDropLegal(t,e){return t.piece.owner!==e.getCurrentPlayer()?K.failure(Mt.MUST_CHOOSE_PLAYER_PIECE()):0===e.getRemainingPiecesOf(t.piece)?K.failure(Qg.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(t,e)}dropHeightValidity(t,e){return e.getStackHeight(t.target)===Dr.HEIGHT?K.failure(Qg.SPACE_IS_FULL()):K.success(void 0)}isShiftLegal(t,e){return e.getPieceAt(t.start).owner!==e.getCurrentPlayer()?K.failure(Mt.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(t,e)}shiftHeightValidity(t,e){const r=e.getStackHeight(t.start.x)-t.start.y;return e.getStackHeight(t.getTarget())+r>Dr.HEIGHT?K.failure(Qg.TARGET_STACK_TOO_HIGH()):K.success(void 0)}getGameStatus(t){const e=this.findHighestAlignment(t.gameState);if(e.isPresent()){const r=t.gameState.getPieceAt(e.get());return Se(r.owner.isPlayer(),"highest alignment is owned by a player"),ze.getVictory(r.owner)}return ze.ONGOING}findHighestAlignment(t){for(let e=0;e<Dr.WIDTH/2;e++)for(let r=Dr.HEIGHT-1;r>0;r--){const s=t.getPieceAtXY(e,r),i=t.getPieceAtXY(e+Dr.WIDTH/2,r);if(s!==gn.EMPTY&&s===i)return S.of(new P(e,r))}return S.empty()}pieceCanMove(t,e){return!!this.isShiftLegal(new Ai(e,"clockwise"),t).isSuccess()||!!this.isShiftLegal(new Ai(e,"counterclockwise"),t).isSuccess()}}e3.singleton=S.empty();class H3t extends rr{getListMoves(t){const e=t.gameState,r=this.getListDrops(e),s=this.getListShifts(e);return r.concat(s)}getListShifts(t){const e=[],r=this.getShiftSources(t);for(const s of r)for(const i of[new Ai(s,"clockwise"),new Ai(s,"counterclockwise")])e3.get().shiftHeightValidity(i,t).isSuccess()&&e.push(i);return e}getListDrops(t){const e=this.getRemainingPiecesForCurrentPlayer(t),r=[];for(let s=0;s<Dr.WIDTH;s++)for(const i of e){const o=new Df(s,i);e3.get().dropHeightValidity(o,t).isSuccess()&&r.push(o)}return r}getRemainingPiecesForCurrentPlayer(t){const e=[];for(const r of gn.PLAYER_PIECES)this.currentPlayerCanDropPiece(t,r)&&e.push(r);return e}currentPlayerCanDropPiece(t,e){return t.getCurrentPlayer()===e.owner&&t.getRemainingPiecesOf(e)>0}getShiftSources(t){const e=[],r=t.getCurrentPlayer();for(let s=0;s<Dr.HEIGHT;s++)for(let i=0;i<Dr.WIDTH;i++)t.getPieceAtXY(i,s).owner===r&&e.push(new P(i,s));return e}getBoardValue(t){const e=e3.get().getGameStatus(t);return new dt(e.isEndGame?e.toBoardValue():0)}}const Qe=gn.EMPTY,zf=gn.ZERO_FIRST,Fae=gn.ZERO_SECOND,OS=gn.ONE_FIRST,TV=gn.ONE_SECOND;class Bae{constructor(){this.tutorial=[pe.informational($localize`Initial board and player pieces`,$localize`Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right.`,Dr.getInitialState()),pe.fromMove($localize`Goal of the game`,$localize`At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>Do it!`,Dr.fromRepresentation([[Qe,Qe,Qe,Qe,Qe,Qe,Qe,Qe],[Qe,Qe,Qe,Qe,Qe,Qe,Qe,Qe],[Qe,Qe,Qe,Qe,OS,Qe,Qe,Qe],[zf,Qe,Qe,Qe,zf,Qe,Qe,Qe]],3),[new Df(0,gn.ONE_FIRST)],$localize`Congratulations, you won!`,$localize`Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board.`),pe.fromMove($localize`Types of move`,$localize`You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board.`,Dr.fromRepresentation([[Qe,Qe,Qe,Qe,Qe,Qe,Qe,Qe],[Qe,Qe,Qe,Qe,TV,Qe,Qe,Qe],[Qe,Qe,Qe,Qe,zf,Qe,Qe,Qe],[OS,Qe,Qe,Qe,Fae,Qe,Qe,Qe]],4),[Ai.fromRepresentation(new P(4,3),"counterclockwise"),Ai.fromRepresentation(new P(4,3),"clockwise"),Ai.fromRepresentation(new P(4,2),"counterclockwise"),Ai.fromRepresentation(new P(4,2),"clockwise")],$localize`Congratulations!`,$localize`Failed, try to move one of your piece that is already on the board.`),pe.fromMove($localize`Special case`,$localize`It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!`,Dr.fromRepresentation([[Qe,Qe,Qe,Qe,zf,Qe,Qe,Qe],[Qe,Qe,Qe,Qe,TV,Qe,Qe,zf],[Qe,Qe,Qe,Qe,zf,Qe,Qe,TV],[Qe,OS,Qe,Qe,Fae,Qe,Qe,OS]],8),[Ai.fromRepresentation(new P(4,2),"counterclockwise")],$localize`Congratulations!`,$localize`Failed, try to shift a stack of pieces to the left.`)]}}function F3t(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"path",5),se("click",function(){const i=he(e).$implicit;return ce(E().onSpaceClick(i))}),A(),N(2,"path",6),se("click",function(){const i=he(e).$implicit;return ce(E().onSpaceClick(i))}),A()()}if(2&n){const e=t.$implicit,r=E();M(1),L1("id","click_",e,""),w("ngClass",r.viewInfo.boardInfo[e].spaceClasses),V("d",r.BOARD_PATHS[e]),M(1),w("ngClass",r.viewInfo.boardInfo[e].spaceClasses),V("d",r.DECORATION_PATHS[e])}}function B3t(n,t){if(1&n){const e=we();B(),N(0,"g",8),se("click",function(){const i=he(e).$implicit,o=E().$implicit;return ce(E().onPieceInGameClick(o,i.y))}),X(1,"use",9)(2,"use",10),A()}if(2&n){const e=t.$implicit;je("id","click_",E().$implicit,"_",e.y,""),w("ngClass",e.foregroundClasses),M(1),w("ngClass",e.backgroundClasses),V("x",e.drawPosition.x)("y",e.drawPosition.y),M(1),V("x",e.drawPosition.x)("y",e.drawPosition.y)}}function $3t(n,t){if(1&n&&(B(),N(0,"g"),k(1,B3t,3,8,"g",7),A()),2&n){const e=t.$implicit,r=E();M(1),w("ngForOf",r.viewInfo.boardInfo[e].pieces)}}function U3t(n,t){if(1&n){const e=we();B(),N(0,"g",12),se("click",function(){const s=he(e),i=s.$implicit,o=s.index;return ce(E(2).onRemainingPieceClick(i.actualPiece,o))}),X(1,"use",9)(2,"use",10),A()}if(2&n){const e=t.$implicit,r=t.index;D3("id","piece_",e.actualPiece.owner.toString(),"_",e.actualPiece.otherPieceType?1:0,"_",r,""),w("ngClass",e.foregroundClasses),M(1),w("ngClass",e.backgroundClasses),V("x",e.drawPosition.x)("y",e.drawPosition.y),M(1),V("x",e.drawPosition.x)("y",e.drawPosition.y)}}function G3t(n,t){if(1&n&&(B(),N(0,"g"),k(1,U3t,3,9,"g",11),A()),2&n){const e=t.$implicit,r=E();M(1),w("ngForOf",r.viewInfo.remainingPieces.get(e).get())}}const W3t=function(){return[0,1,2,3,4,5,6,7]},q3t=function(){return[2,1,3,0,4,7,5,6]};class t3 extends m0{constructor(t){super(t),this.BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],this.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],this.selected=S.empty(),this.viewInfo={boardInfo:[],remainingPieces:new Qn([{key:F.ZERO,value:[]},{key:F.ONE,value:[]}])},this.rules=e3.get(),this.availableMinimaxes=[new H3t(this.rules,"DiamDummyMinimax")],this.encoder=V3t,this.tutorial=(new Bae).tutorial}ngOnInit(){this.updateBoard()}onSpaceClick(t){var e=this;return O(function*(){const r=e.canUserPlay("#click_"+t);return r.isFailure()?e.cancelMove(r.getReason()):e.onSpaceClickAfterCheck(t)})()}onSpaceClickAfterCheck(t){var e=this;return O(function*(){if(e.selected.isPresent()){const r=e.selected.get();let s;if("pieceFromReserve"===r.type)s=new Df(t,r.piece);else if((r.position.x+1)%Dr.WIDTH===t)s=new Ai(r.position,"clockwise");else{if((r.position.x+(Dr.WIDTH-1))%Dr.WIDTH!==t)return e.cancelMove(Qg.MUST_SHIFT_TO_NEIGHBOR());s=new Ai(r.position,"counterclockwise")}return e.chooseMove(s,e.getState())}return e.cancelMove(Qg.MUST_SELECT_PIECE_FIRST())})()}onPieceInGameClick(t,e){var r=this;return O(function*(){const s=r.canUserPlay("#click_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new P(t,e);return r.getState().getPieceAt(i).owner===r.getCurrentPlayer()?(r.isSelected(null,i)?r.cancelMoveAttempt():r.selected=S.of({type:"pieceFromBoard",position:i}),r.updateViewInfo(),G.SUCCESS):r.selected.isPresent()?r.onSpaceClickAfterCheck(t):r.cancelMove(Mt.MUST_CHOOSE_PLAYER_PIECE())})()}onRemainingPieceClick(t,e){var r=this;return O(function*(){const s=r.canUserPlay(r.getPieceId(t,e));return s.isFailure()?r.cancelMove(s.getReason()):t.owner===r.getCurrentPlayer()?(r.selected=r.isSelected(t)?S.empty():S.of({type:"pieceFromReserve",piece:t}),r.updateViewInfo(),G.SUCCESS):r.cancelMove(Mt.MUST_CHOOSE_PLAYER_PIECE())})()}getPieceId(t,e){return"#piece_"+t.owner.toString()+"_"+(t.otherPieceType?1:0)+"_"+e}isSelected(t,e){return!this.selected.isAbsent()&&(null==t&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(e):this.selected.get().piece===t)}updateBoard(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}getLastMovedFromDrop(t,e){const r=this.getDrawPositionRemainingPiece(t.piece,e.getRemainingPiecesOf(t.piece)-1),s=t.getTarget(),i=e.getStackHeight(t.getTarget()),o=this.getDrawPositionOnBoard(s,i),c=new P(s,i);return[{start:S.empty(),end:c,startDrawPosition:r,endDrawPosition:o}]}getLastMovedFromShift(t,e){const r=t.start.x,s=t.getTarget();let i=e.getStackHeight(s);const o=[];for(let c=t.start.y;c<Dr.HEIGHT&&e.getPieceAtXY(r,c)!==gn.EMPTY;c++,i++)o.push({start:S.of(new P(r,c)),end:new P(s,i),startDrawPosition:this.getDrawPositionOnBoard(r,c),endDrawPosition:this.getDrawPositionOnBoard(s,i)});return o}updateViewInfo(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}updateBoardInfo(){for(let t=0;t<Dr.WIDTH;t++)this.viewInfo.boardInfo[t]={x:t,spaceClasses:[],pieces:this.getPieces(t)}}showLastMove(){this.showLastMoveOnSpaces(),this.showLastMoveOnPieces()}showLastMoveOnSpaces(){const t=this.rules.node.move;Se(t.isPresent(),"showLastMoveOnSpaces called without a last move");const e=t.get();for(let r=0;r<Dr.WIDTH;r++){const s=[];e.isDrop()?e.getTarget()===r&&s.push("moved-fill"):(e.getTarget()===r||e.start.x===r)&&s.push("moved-fill"),this.viewInfo.boardInfo[r].spaceClasses=s}}showLastMoveOnPieces(){const t=this.rules.node.move;Se(t.isPresent(),"showLastMoveOnPieces called without a last move");const e=t.get(),r=this.getPreviousState();let s=[];s=e.isDrop()?this.getLastMovedFromDrop(e,r):this.getLastMovedFromShift(e,r);for(const i of s)this.viewInfo.boardInfo[i.end.x].pieces[i.end.y].foregroundClasses.push("last-move-stroke")}updateRemainingPiecesInfo(){const t=this.getCurrentPlayer();this.viewInfo.remainingPieces=new Qn([{key:F.ZERO,value:[]},{key:F.ONE,value:[]}]);const e=this.isPlayerTurn();for(const r of gn.PLAYER_PIECES){const s=this.getState().getRemainingPiecesOf(r);for(let i=0;i<s;i++){const o=[];this.isTopPieceOfReserveAndSelected(i,s,r)&&o.push("selected-stroke"),e&&i===s-1&&r.owner===t&&o.push("clickable-stroke-hover");const c=this.viewInfo.remainingPieces.get(r.owner).get(),u=[];u.push(r.otherPieceType?"player"+r.owner.value+"-alternate-fill":"player"+r.owner.value+"-fill"),c.push({backgroundClasses:u,foregroundClasses:o,y:i,drawPosition:this.getDrawPositionRemainingPiece(r,i),actualPiece:r}),this.viewInfo.remainingPieces.put(r.owner,c)}}}isTopPieceOfReserveAndSelected(t,e,r){if(this.selected.isPresent()){const s=this.selected.get();return"pieceFromReserve"===s.type&&s.piece===r&&t===e-1}return!1}getDrawPositionRemainingPiece(t,e){let r,s;return r=t.owner===F.ZERO?-100:600,s=t.otherPieceType?100:450,new P(r,s).getNext(new Un(0,-e*t3.PIECE_HEIGHT))}getPieces(t){const e=this.rules.findHighestAlignment(this.getState()),r=this.isPlayerTurn(),s=[];for(let i=0;i<Dr.HEIGHT;i++){const o=this.getState().getPieceAtXY(t,i),c=new P(t,i);if(o!==gn.EMPTY){const u=[];this.pieceFromBoardIsSelected(t,i)&&u.push("selected-stroke"),this.isVictory(t,i,e)&&u.push("victory-stroke"),r&&this.rules.pieceCanMove(this.getState(),c)&&u.push("clickable-stroke-hover"),s.push({backgroundClasses:["player"+o.owner.value+(o.otherPieceType?"-alternate-fill":"-fill")],foregroundClasses:u,y:i,drawPosition:this.getDrawPositionOnBoard(t,i),actualPiece:o})}}return s}pieceFromBoardIsSelected(t,e){if(this.selected.isPresent()){const r=this.selected.get();return"pieceFromBoard"===r.type&&r.position.x===t&&r.position.y===e}return!1}isVictory(t,e,r){if(r.isPresent()){const s=r.get();return s.x%4==t%4&&s.y===e}return!1}getDrawPositionOnBoard(t,e){return t3.CENTER[t].getNext(new Un(0,-e*t3.PIECE_HEIGHT))}cancelMoveAttempt(){this.selected=S.empty(),this.updateBoard()}}t3.CENTER=[new P(40,160),new P(100,50),new P(255,2),new P(400,50),new P(460,160),new P(400,270),new P(255,320),new P(100,270)],t3.PIECE_HEIGHT=36,t3.\u0275fac=function(t){return new(t||t3)(Q(In))},t3.\u0275cmp=vt({type:t3,selectors:[["app-diam"]],features:[l],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 1.4319358,16.913484 V 49.329973 H 1.482219 A 39.498175,14.141265 0 0 0 40.938372,63.011675 39.498175,14.141265 0 0 0 80.394523,49.329973 h 0.06885 V 16.913484 h -0.02864 A 39.769348,14.114049 0 0 1 40.941466,29.431707 39.769348,14.114049 0 0 1 1.4481812,16.913484 Z"],["cx","40.952408","cy","15.225397","rx","39.769348","ry","14.11405"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(t,e){1&t&&(B(),N(0,"svg",0)(1,"defs")(2,"g",1),X(3,"path",2)(4,"ellipse",3),A()(),k(5,F3t,3,5,"g",4),k(6,$3t,2,1,"g",4),k(7,G3t,2,1,"g",4),A()),2&t&&(M(5),w("ngForOf",ar(3,W3t)),M(1),w("ngForOf",ar(4,q3t)),M(1),w("ngForOf",e.Player.PLAYERS))},dependencies:[On,Fn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class ya{constructor(t,e){this.offset=t,this.constant=e}static fromTwoCoords(t,e){const r=t.x,s=e.x,i=t.y,o=e.y,c=r+i,u=s+o;return r===s&&i!==o&&c!==u?S.of(ya.constantQ(r)):r!==s&&i===o&&c!==u?S.of(ya.constantR(i)):r!==s&&i!==o&&c===u?S.of(ya.constantS(c)):S.empty()}static constantQ(t){return new ya(t,"q")}static constantR(t){return new ya(t,"r")}static constantS(t){return new ya(t,"s")}static areOnSameLine(t){if(t.length<2)return!0;const e=ya.fromTwoCoords(t[0],t[1]);if(e.isAbsent())return!1;const r=e.get();for(const s of t.slice(2))if(!1===r.contains(s))return!1;return!0}toString(){return`Line(${this.constant}, ${this.offset})`}equals(t){return this===t||!(this.offset!==t.offset||this.constant!==t.constant)}contains(t){switch(this.constant){case"q":return t.x===this.offset;case"r":return t.y===this.offset;case"s":return t.x+t.y===this.offset}}getDirection(){switch(this.constant){case"q":return Ie.DOWN;case"r":return Ie.RIGHT;case"s":return Ie.DOWN_LEFT}}}class z8 extends Vs{constructor(t,e,r,s,i,o){super(e,t),this.board=e,this.width=r,this.height=s,this.excludedSpaces=i,this.empty=o,Se(this.excludedSpaces.length<this.height/2+1,"Invalid excluded spaces specification for HexagonalGameState.")}static neighbors(t,e){return[new P(t.x+e,t.y-e),new P(t.x+e,t.y),new P(t.x-e,t.y+e),new P(t.x-e,t.y),new P(t.x,t.y+e),new P(t.x,t.y-e)]}setAt(t,e){if(this.isOnBoard(t))return this.setAtUnsafe(t,e);throw new Error("Setting coord not on board: "+t+".")}equalsT(t,e){if(this===t)return!0;if(this.width!==t.width||this.height!==t.height||!1===e(this.empty,t.empty)||this.excludedSpaces.length!==t.excludedSpaces.length)return!1;for(let r=0;r<this.excludedSpaces.length;r++)if(this.excludedSpaces[r]!==t.excludedSpaces[r])return!1;for(const r of this.allCoords())if(!1===e(this.getPieceAt(r),t.getPieceAt(r)))return!1;return!0}allCoords(){const t=[];return this.forEachCoord(e=>{t.push(e)}),t}allLines(){const t=[];for(let e=0;e<this.width;e++)t.push(ya.constantQ(e));for(let e=0;e<this.height;e++)t.push(ya.constantR(e));for(let e=this.excludedSpaces.length;e<this.height+this.excludedSpaces.length;e++)t.push(ya.constantS(e));return t}getEntranceOnLine(t){let e,r;switch(t.constant){case"q":return r=null!=this.excludedSpaces[t.offset]?this.excludedSpaces[t.offset]:0,this.findEntranceFrom(t,new P(t.offset,r));case"r":return e=null!=this.excludedSpaces[t.offset]?this.excludedSpaces[t.offset]:0,this.findEntranceFrom(t,new P(e,t.offset));case"s":return this.findEntranceFrom(t,t.offset<this.width?new P(t.offset,0):new P(this.width-1,t.offset-this.width+1))}}findEntranceFrom(t,e){const r=t.getDirection();let s=e;for(let o=0;o<Math.max(this.width,this.height);o++){if(this.isOnBoard(s))return s;s=s.getNext(r)}const i=ys.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:e.toString(),line:t.toString()});throw new Error(i.getReason())}}class Kn{constructor(t,e,r){this.owner=t,this.size=e,this.source=r}static append(t,e){return new Kn(t.owner,t.size+e.size,t.source||e.source)}getValue(){return Kn.encoder.encodeNumber(this)}getOwner(){return this.owner}belongsTo(t){return this.owner===t}containsSource(){return this.source}isEmpty(){return 0===this.size}getSize(){return this.size}toString(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}}Kn.sizeEncoder=on.numberEncoder(49),Kn.encoder=on.tuple([on.booleanEncoder,F.numberEncoder,Kn.sizeEncoder],n=>[n.source,n.owner,n.size],n=>new Kn(n[1],n[2],n[0])),Kn.MAX_SIZE=49,Kn.EMPTY=new Kn(fe.NONE,0,!1),Kn.UNREACHABLE=new Kn(fe.NONE,-1,!1),Kn.PLAYER_ZERO=new Kn(F.ZERO,1,!1),Kn.PLAYER_ONE=new Kn(F.ONE,1,!1),Kn.SOURCE=new Kn(fe.NONE,1,!0);let Ea=(()=>{class n extends z8{constructor(e,r,s){super(r,e,n.WIDTH,n.HEIGHT,n.EXCLUDED_SPACES,Kn.EMPTY),this.alreadyPassed=s}static balancedBoard(){const e=Kn.UNREACHABLE,r=Kn.PLAYER_ZERO,s=Kn.PLAYER_ONE,i=Kn.SOURCE;return[[e,e,r,s,s,s,r,r,s,i,s],[e,s,s,r,r,r,s,s,r,s,s],[s,s,s,s,r,i,s,r,r,r,r],[r,r,s,r,r,s,s,s,r,r,e],[r,i,r,s,s,r,r,r,s,e,e]]}static isOnBoard(e){return!e.isNotInRange(n.WIDTH,n.HEIGHT)&&n.balancedBoard()[e.y][e.x]!==Kn.UNREACHABLE}static getInitialState(){return new n(n.balancedBoard(),0,!1)}getAllPieces(){const e=[];for(let r=0;r<n.HEIGHT;r++)for(let s=0;s<n.WIDTH;s++){const i=new P(s,r);this.isOnBoard(i)&&!1===this.getPieceAt(i).isEmpty()&&e.push(i)}return e}numberOfNeighbors(e){return z8.neighbors(e,1).filter(r=>this.isOnBoard(r)&&!1===this.getPieceAt(r).isEmpty()).length}setAtUnsafe(e,r){const s=ht.copyBiArray(this.board);return s[e.y][e.x]=r,new n(s,this.turn,this.alreadyPassed)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Kn.UNREACHABLE}}return n.WIDTH=11,n.HEIGHT=5,n.EXCLUDED_SPACES=[2,1],n})();class Tr extends tc{constructor(t,e){super(t,e)}static of(t,e){if(-1===t.x&&-1===t.y&&-2===e.x&&-2===e.y)return Tr.PASS;if(!Ea.isOnBoard(t))throw new Error("Starting coord of DvonnMove must be on the board, not at "+t.toString());if(!Ea.isOnBoard(e))throw new Error("End coord of DvonnMove must be on the board, not at "+t.toString());if(t.y===e.y)return new Tr(t,e);if(t.x===e.x)return new Tr(t,e);if(t.x+t.y===e.x+e.y)return new Tr(t,e);throw new Error("Invalid move")}toString(){return this===Tr.PASS?"DvonnMove.PASS":"DvonnMove("+this.coord+"->"+this.end+")"}length(){return this.coord.y===this.end.y?Math.abs(this.coord.x-this.end.x):Math.abs(this.coord.y-this.end.y)}equals(t){return t===this||!!t.coord.equals(this.coord)&&t.end.equals(this.end)}}Tr.PASS=new Tr(new P(-1,-1),new P(-2,-2)),Tr.encoder=new class extends on{maxValue(){return 42148}encodeNumber(n){return 4096*n.coord.x+256*n.coord.y+16*n.end.x+n.end.y}decodeNumber(n){if(n<0)return Tr.PASS;const t=n%16,e=(n=n/16|0)%16,r=(n=n/16|0)%16;return new Tr(new P((n=n/16|0)%16,r),new P(e,t))}};let Vf=(()=>{class n{}return n.NOT_PLAYER_PIECE=()=>$localize`You must select a piece or a stack of your color.`,n.EMPTY_STACK=()=>$localize`You must select a stack.`,n.TOO_MANY_NEIGHBORS=()=>$localize`This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors.`,n.CANT_REACH_TARGET=()=>$localize`This stack cannot move because it could never land on another piece.`,n.INVALID_MOVE_LENGTH=()=>$localize`A stack must always be moved by as many spaces as there are pieces in the stack.`,n.EMPTY_TARGET_STACK=()=>$localize`The stack must land on an occupied space.`,n})();class c2 extends hr{static getGameStatus(t){const e=t.gameState,r=c2.getScores(e);return 0===c2.getMovablePieces(e).length?r[0]>r[1]?ze.ZERO_WON:r[0]<r[1]?ze.ONE_WON:ze.DRAW:ze.ONGOING}static getMovablePieces(t){return c2.getFreePieces(t).filter(e=>c2.pieceHasTarget(t,e))}static getFreePieces(t){return t.getAllPieces().filter(e=>t.getPieceAt(e).belongsTo(t.getCurrentPlayer())&&t.numberOfNeighbors(e)<6)}static pieceHasTarget(t,e){const r=t.getPieceAt(e).getSize();return void 0!==z8.neighbors(e,r).find(i=>t.isOnBoard(i)&&!t.getPieceAt(i).isEmpty())}static pieceTargets(t,e){const r=t.getPieceAt(e).getSize();return z8.neighbors(e,r).filter(i=>t.isOnBoard(i)&&!1===t.getPieceAt(i).isEmpty())}static getScores(t){let e=0,r=0;return t.getAllPieces().map(s=>{const i=t.getPieceAt(s);i.belongsTo(F.ZERO)?e+=i.getSize():i.belongsTo(F.ONE)&&(r+=i.getSize())}),[e,r]}isMovablePiece(t,e){Se(t.isOnBoard(e),"piece is not on the board");const r=t.getPieceAt(e);return r.getSize()<1?G.failure(Vf.EMPTY_STACK()):r.belongsTo(t.getCurrentPlayer())?t.numberOfNeighbors(e)>=6?G.failure(Vf.TOO_MANY_NEIGHBORS()):c2.pieceHasTarget(t,e)?G.SUCCESS:G.failure(Vf.CANT_REACH_TARGET()):G.failure(Vf.NOT_PLAYER_PIECE())}canOnlyPass(t){return 0===c2.getMovablePieces(t).length}sourceCoords(t){return t.getAllPieces().filter(e=>t.getPieceAt(e).containsSource())}markPiecesConnectedTo(t,e,r){z8.neighbors(e,1).forEach(s=>{t.isOnBoard(s)&&!r[s.y][s.x]&&!t.getPieceAt(s).isEmpty()&&(r[s.y][s.x]=!0,this.markPiecesConnectedTo(t,s,r))})}removeDisconnectedPieces(t){const e=ht.createTable(Ea.WIDTH,Ea.HEIGHT,!1);this.sourceCoords(t).forEach(s=>{e[s.y][s.x]=!0,this.markPiecesConnectedTo(t,s,e)});let r=t;return r.getAllPieces().forEach(s=>{e[s.y][s.x]||(r=r.setAt(s,Kn.EMPTY))}),r}applyLegalMove(t,e,r){if(t===Tr.PASS)return new Ea(e.board,e.turn+1,!0);{const s=e.getPieceAt(t.coord),i=e.getPieceAt(t.end),o=e.setAt(t.coord,Kn.EMPTY).setAt(t.end,Kn.append(s,i));return this.removeDisconnectedPieces(new Ea(o.board,e.turn+1,!1))}}isLegal(t,e){if(0===c2.getMovablePieces(e).length)return t!==Tr.PASS||e.alreadyPassed?K.failure(Mt.MUST_PASS()):K.success(void 0);if(t===Tr.PASS)return K.failure(Mt.CANNOT_PASS());const r=this.isMovablePiece(e,t.coord);if(r.isFailure())return r.toFailedFallible();const s=e.getPieceAt(t.coord);return t.length()!==s.getSize()?K.failure(Vf.INVALID_MOVE_LENGTH()):e.getPieceAt(t.end).isEmpty()?K.failure(Vf.EMPTY_TARGET_STACK()):K.success(void 0)}getGameStatus(t){return c2.getGameStatus(t)}}class $ae extends rr{getListMoves(t){const e=t.move,r=t.gameState,s=[];return c2.getMovablePieces(r).forEach(i=>c2.pieceTargets(r,i).forEach(o=>{const c=Tr.of(i,o);s.push(c)})),0===s.length&&!1===e.equalsValue(Tr.PASS)&&s.push(Tr.PASS),s}getBoardValue(t){const e=t.gameState,r=c2.getScores(e);return 0===c2.getMovablePieces(e).length?new dt(r[0]>r[1]?Number.MIN_SAFE_INTEGER:r[0]<r[1]?Number.MAX_SAFE_INTEGER:0):new dt(r[0]-r[1])}}class j3t extends $ae{getListMoves(t){const e=t.gameState,r=super.getListMoves(t),s=e.getCurrentPlayer().getOpponent();return ht.sortByDescending(r,i=>{Se(i!==Tr.PASS,"Cannot sort with DvonnMove.PASS");const o=e.getPieceAt(i.end);return o.belongsTo(s)?o.getSize():0}),r}getBoardValue(t){const e=c2.getGameStatus(t);if(e.isEndGame)return new dt(e.toBoardValue());const r=t.gameState,s=c2.getScores(r),i=r.getAllPieces(),o=i.length,c=i.filter(m=>r.getPieceAt(m).belongsTo(F.ZERO)).length,u=i.filter(m=>r.getPieceAt(m).belongsTo(F.ONE)).length;return new dt((u*s[1]-c*s[0])/o)}}const ue=Kn.EMPTY,zr=Kn.UNREACHABLE,E0=Kn.SOURCE,Hf=Kn.PLAYER_ZERO,Ff=Kn.PLAYER_ONE,Z3t=new Kn(F.ZERO,2,!1),wV=new Kn(F.ONE,2,!1),Uae=new Kn(F.ZERO,4,!1),Y3t=new Kn(F.ONE,4,!1);class Gae extends Pr{constructor(){super(...arguments),this.tutorial=[pe.anyMove($localize`Moving`,$localize`At Dvonn, each hexagonal space contains a stack of pieces.
        If no number is indicated on a stack, it means that it only contains one piece.
        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.
        The owner of a stack is the one that has a piece at the top of the stack.
        Only the owner of a stack can move it.
        A stack cannot be moved if it is surrounded by 6 other stacks.
        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.
        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.
        Therefore, there are six possible directions.
        The player with dark pieces starts.<br/><br/>
        You're playing Dark, click on a stack and move it by one space.`,Ea.getInitialState(),Tr.of(new P(2,0),new P(3,0)),$localize`Congratulations!`),pe.fromPredicate($localize`Disconnection`,$localize`Pieces with a lightning strike are called "sources".
        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>
        You're playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!`,new Ea([[zr,zr,Ff,E0,ue,ue,ue,ue,ue,ue,ue],[zr,ue,Hf,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,Y3t,ue,ue,ue,ue,Ff,E0,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue,zr],[ue,ue,ue,ue,ue,ue,ue,ue,ue,zr,zr]],0,!1),Tr.of(new P(2,1),new P(2,0)),(t,e,r)=>t.end.equals(new P(3,0))?G.failure($localize`You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it.`):(Se(t.end.equals(new P(2,0)),"player made an impossible move"),G.SUCCESS),$localize`Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!
        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.
        Disconnected stacks will not be visible at the next turn.`),pe.fromPredicate($localize`Moving on a source`,$localize`You are allowed to move your stacks on any other stack.
        This means that you can take control of a source by moving one of your stack on top of it.
        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>
        You're playing Dark and you can take control of a source, do it!`,new Ea([[zr,zr,E0,Ff,ue,ue,ue,ue,ue,ue,ue],[zr,Hf,Hf,ue,ue,ue,ue,ue,ue,ue,ue],[ue,Ff,Hf,Ff,ue,ue,Hf,wV,E0,ue,ue],[ue,ue,Ff,ue,ue,ue,ue,ue,ue,ue,zr],[ue,ue,ue,ue,ue,ue,ue,ue,ue,zr,zr]],0,!1),Tr.of(new P(2,1),new P(2,0)),(t,e,r)=>t.end.equals(new P(2,0))?G.SUCCESS:G.failure($localize`You have not taken possession of a source, try again.`),$localize`Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!`),pe.informational($localize`Passing`,$localize`It can happen that you have no possible move to make.
        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>
        This is a situation that occurs here for Dark.`,new Ea([[zr,zr,E0,ue,ue,ue,ue,ue,ue,ue,ue],[zr,ue,Z3t,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,wV,ue,ue,ue,ue,wV,E0,Uae,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue,zr],[ue,ue,ue,ue,ue,ue,ue,ue,ue,zr,zr]],0,!1)),pe.fromMove($localize`End of the game`,$localize`When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>
        Make your last move.`,new Ea([[zr,zr,E0,ue,ue,ue,ue,ue,ue,ue,ue],[zr,ue,Hf,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,E0,Uae,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue,zr],[ue,ue,ue,ue,ue,ue,ue,ue,ue,zr,zr]],0,!1),[Tr.of(new P(2,1),new P(2,0))],$localize`Congratulations, you won 6 - 0!`,$localize`Bad idea, by moving on the source you would have won a point.`)]}}function K3t(n,t){if(1&n&&(B(),X(0,"circle",10)),2&n){const e=E().$implicit,r=E().$implicit,s=E();w("ngClass",s.getPieceClasses(e)),V("cx",s.getCenterAt(r).x)("cy",s.getCenterAt(r).y)("r",s.SPACE_SIZE)}}function X3t(n,t){if(1&n&&(B(),X(0,"polygon",11)),2&n){const e=E().$implicit,r=E().$implicit,s=E();V("transform",1===e.getSize()?"translate("+(s.getCenterAt(r).x-18)+" "+(s.getCenterAt(r).y-16)+") scale(0.10)":"translate("+(s.getCenterAt(r).x-3)+" "+(s.getCenterAt(r).y-12)+") scale(0.07)")}}function Q3t(n,t){if(1&n){const e=we();B(),N(0,"text",12),se("click",function(){he(e);const s=E(2).$implicit;return ce(E().onClick(s.x,s.y))}),Et(1),A()}if(2&n){const e=E().$implicit,r=E().$implicit,s=E();V("x",e.containsSource()?s.getCenterAt(r).x-7:s.getCenterAt(r).x)("y",s.getCenterAt(r).y),M(1),jn(e.getSize())}}function J3t(n,t){if(1&n){const e=we();B(),N(0,"g",5),se("click",function(){he(e);const s=E().$implicit;return ce(E().onClick(s.x,s.y))}),X(1,"polygon",6),k(2,K3t,1,4,"circle",7),k(3,X3t,1,1,"polygon",8),k(4,Q3t,2,3,"text",9),A()}if(2&n){const e=t.$implicit,r=E().$implicit,s=E();je("id","click_",r.x,"_",r.y,""),M(1),V("points",s.getHexaCoordsAt(r)),M(1),w("ngIf",e.getSize()>0),M(1),w("ngIf",e.containsSource()),M(1),w("ngIf",e.getSize()>1)}}const e4t=function(n){return[n]};function t4t(n,t){if(1&n&&(B(),N(0,"g"),k(1,J3t,5,6,"g",4),A()),2&n){const e=t.$implicit,r=E();M(1),w("ngForOf",N6(1,e4t,r.state.getPieceAt(e)))}}function n4t(n,t){if(1&n&&(B(),N(0,"text",16),Et(1),A()),2&n){const e=E().$implicit,r=E();V("x",r.getCenterAt(e.coord).x)("y",r.getCenterAt(e.coord).y),M(1),jn(e.spaceContent.getSize())}}function r4t(n,t){if(1&n&&(B(),N(0,"g"),X(1,"polygon",13)(2,"circle",14),k(3,n4t,2,3,"text",15),A()),2&n){const e=t.$implicit,r=E();M(1),V("points",r.getHexaCoordsAt(e.coord)),M(1),je("id","captured_",e.coord.x,"_",e.coord.y,""),w("ngClass",r.getPieceClasses(e.spaceContent)),V("cx",r.getCenterAt(e.coord).x)("cy",r.getCenterAt(e.coord).y)("r",r.SPACE_SIZE),M(1),w("ngIf",e.spaceContent.getSize()>1)}}function s4t(n,t){if(1&n&&(B(),nn(0),X(1,"polygon",17)(2,"polygon",17),rn()),2&n){const e=E();M(1),V("points",e.getHexaCoordsAt(e.lastMove.get().coord)),M(1),V("points",e.getHexaCoordsAt(e.lastMove.get().end))}}function i4t(n,t){if(1&n&&(B(),X(0,"polygon",18)),2&n){const e=E();V("points",e.getHexaCoordsAt(e.chosen.get()))}}let o4t=(()=>{class n extends Zg{constructor(e){super(e),this.lastMove=S.empty(),this.chosen=S.empty(),this.disconnecteds=[],this.rules=new c2(Ea),this.availableMinimaxes=[new $ae(this.rules,"DvonnMinimax"),new j3t(this.rules,"DvonnMinimaxMaximizeStacks")],this.encoder=Tr.encoder,this.tutorial=(new Gae).tutorial,this.SPACE_SIZE=30,this.canPass=!1,this.scores=S.of(c2.getScores(this.getState())),this.hexaLayout=new Yg(1.5*this.SPACE_SIZE,new P(-this.SPACE_SIZE,2*this.SPACE_SIZE),ES.INSTANCE),this.state=this.getState(),this.hexaBoard=this.getState().board}hideLastMove(){this.lastMove=S.empty()}updateBoard(){this.cancelMoveAttempt(),this.state=this.getState(),this.lastMove=this.rules.node.move,this.disconnecteds=[],this.lastMove.isPresent()?this.calculateDisconnecteds():this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=S.of(c2.getScores(this.state))}calculateDisconnecteds(){const e=this.rules.node.mother.get().gameState,r=this.getState();for(let s=0;s<r.board.length;s++)for(let i=0;i<r.board[s].length;i++){const o=new P(i,s);if(!0===r.isOnBoard(o)&&!1===o.equals(this.lastMove.get().coord)){const c=r.getPieceAt(o),u=e.getPieceAt(o);if(c.isEmpty()&&!u.isEmpty()){const g={coord:new P(i,s),spaceContent:u};this.disconnecteds.push(g)}}}}cancelMoveAttempt(){this.chosen=S.empty()}pass(){var e=this;return O(function*(){return Se(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield e.chooseMove(Tr.PASS,e.getState())})()}onClick(e,r){var s=this;return O(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.chosen.isAbsent()?s.choosePiece(e,r):s.chosen.equalsValue(new P(e,r))?(s.cancelMoveAttempt(),G.SUCCESS):yield s.chooseDestination(e,r)})()}choosePiece(e,r){const s=new P(e,r),i=this.rules.isMovablePiece(this.getState(),s);return i.isSuccess()?(this.chosen=S.of(s),G.SUCCESS):this.cancelMove(i.getReason())}chooseDestination(e,r){var s=this;return O(function*(){const i=s.chosen.get(),o=new P(e,r),c=Tr.of(i,o);return s.chooseMove(c,s.getState())})()}getPieceClasses(e){if(e.containsSource()&&1===e.getSize())return["nonplayer-fill","dashed-stroke"];const r=this.getPlayerClass(e.getOwner());return e.containsSource()?[r,"nonplayer-stroke","dashed-stroke"]:[r]}}return n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-dvonn"]],features:[l],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected-stroke",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"ngClass",4,"ngIf"],["class","nonplayer-light-fill","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"nonplayer-light-fill"],["dy","13",1,"text-center","text-medium",3,"click"],[1,"base","mid-stroke","captured-fill"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-big","dy","17",4,"ngIf"],["dy","17",1,"text-center","text-big"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke"]],template:function(e,r){1&e&&(B(),N(0,"svg",0),k(1,t4t,2,3,"g",1),k(2,r4t,4,8,"g",1),k(3,s4t,3,2,"ng-container",2),k(4,i4t,1,1,"polygon",3),A()),2&e&&(M(1),w("ngForOf",r.state.allCoords()),M(1),w("ngForOf",r.disconnecteds),M(1),w("ngIf",r.lastMove.isPresent()),M(1),w("ngIf",r.chosen.isPresent()))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();var K1=(()=>(function(n){n[n.NONE=0]="NONE",n[n.SMALL=1]="SMALL",n[n.MEDIUM=2]="MEDIUM",n[n.BIG=3]="BIG"}(K1||(K1={})),K1))();class Ze{constructor(t){this.value=t}static of(t){switch(t){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+t+" for EncapsulePiece")}}static ofSizeAndPlayer(t,e){return e===F.ZERO&&t===K1.BIG?Ze.BIG_DARK:e===F.ZERO&&t===K1.MEDIUM?Ze.MEDIUM_DARK:e===F.ZERO&&t===K1.SMALL?Ze.SMALL_DARK:e===F.ONE&&t===K1.BIG?Ze.BIG_LIGHT:e===F.ONE&&t===K1.MEDIUM?Ze.MEDIUM_LIGHT:e===F.ONE&&t===K1.SMALL?Ze.SMALL_LIGHT:Ze.NONE}getPlayer(){switch(this){case Ze.SMALL_DARK:case Ze.MEDIUM_DARK:case Ze.BIG_DARK:return F.ZERO;case Ze.SMALL_LIGHT:case Ze.MEDIUM_LIGHT:case Ze.BIG_LIGHT:return F.ONE;default:return fe.NONE}}getSize(){switch(this){case Ze.BIG_DARK:case Ze.BIG_LIGHT:return K1.BIG;case Ze.MEDIUM_DARK:case Ze.MEDIUM_LIGHT:return K1.MEDIUM;case Ze.SMALL_DARK:case Ze.SMALL_LIGHT:return K1.SMALL;default:return Ae.expectToBe(this,Ze.NONE),K1.NONE}}belongsTo(t){return this.getPlayer()===t}equals(t){return this===t}toString(){switch(this){case Ze.BIG_DARK:return"BIG_DARK";case Ze.BIG_LIGHT:return"BIG_LIGHT";case Ze.MEDIUM_DARK:return"MEDIUM_DARK";case Ze.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case Ze.SMALL_DARK:return"SMALL_DARK";case Ze.SMALL_LIGHT:return"SMALL_LIGHT";default:return Ae.expectToBe(this,Ze.NONE),"EMPTY"}}}Ze.SMALL_DARK=new Ze(0),Ze.SMALL_LIGHT=new Ze(1),Ze.MEDIUM_DARK=new Ze(2),Ze.MEDIUM_LIGHT=new Ze(3),Ze.BIG_DARK=new Ze(4),Ze.BIG_LIGHT=new Ze(5),Ze.NONE=new Ze(6);class wl extends Vs{constructor(t,e,r){super(t,e),this.remainingPieces=r}static getInitialState(){const e=new jr(fe.NONE,fe.NONE,fe.NONE).encode(),r=ht.createTable(3,3,e),s=ht.mapBiArray(r,o=>jr.decode(o));return new wl(s,0,[Ze.BIG_DARK,Ze.BIG_DARK,Ze.BIG_LIGHT,Ze.BIG_LIGHT,Ze.MEDIUM_DARK,Ze.MEDIUM_DARK,Ze.MEDIUM_LIGHT,Ze.MEDIUM_LIGHT,Ze.SMALL_DARK,Ze.SMALL_DARK,Ze.SMALL_LIGHT,Ze.SMALL_LIGHT])}getRemainingPieces(){return ht.copyImmutableArray(this.remainingPieces)}getRemainingPiecesOfPlayer(t){return this.getRemainingPieces().filter(e=>e.getPlayer()===t)}pieceBelongsToCurrentPlayer(t){return t.belongsTo(this.getCurrentPlayer())}isDroppable(t){return this.pieceBelongsToCurrentPlayer(t)&&this.isInRemainingPieces(t)}isInRemainingPieces(t){return this.remainingPieces.some(e=>e===t)}getPlayerRemainingPieces(){return this.remainingPieces.filter(t=>this.pieceBelongsToCurrentPlayer(t))}}class jr{constructor(t,e,r){this.small=t,this.medium=e,this.big=r}static decode(t){Se(t%1==0,"EncapsuleSpace must be encoded as integer: "+t),Se(t>=0,"To small representation for EncapsuleSpace: "+t),Se(t<=26,"To big representation for EncapsuleSpace: "+t);const e=F.numberEncoder.decodeNumber(t%3);t-=e.value;const r=F.numberEncoder.decodeNumber((t/=3)%3);t-=r.value;const s=F.numberEncoder.decodeNumber(t/=3);return new jr(e,r,s)}isEmpty(){return this.small===fe.NONE&&this.medium===fe.NONE&&this.big===fe.NONE}toList(){const t=[];return this.small.isPlayer()&&t.push(Ze.ofSizeAndPlayer(K1.SMALL,this.small)),this.medium.isPlayer()&&t.push(Ze.ofSizeAndPlayer(K1.MEDIUM,this.medium)),this.big.isPlayer()&&t.push(Ze.ofSizeAndPlayer(K1.BIG,this.big)),t}toOrderedPieceNames(){const t=Ze.ofSizeAndPlayer(K1.SMALL,this.small),e=Ze.ofSizeAndPlayer(K1.MEDIUM,this.medium),r=Ze.ofSizeAndPlayer(K1.BIG,this.big);return[t.toString(),e.toString(),r.toString()]}getBiggest(){return this.big===F.ZERO?Ze.BIG_DARK:this.big===F.ONE?Ze.BIG_LIGHT:this.medium===F.ZERO?Ze.MEDIUM_DARK:this.medium===F.ONE?Ze.MEDIUM_LIGHT:this.small===F.ZERO?Ze.SMALL_DARK:this.small===F.ONE?Ze.SMALL_LIGHT:Ze.NONE}tryToSuperposePiece(t){const e=this.getBiggest().getSize();if(t===Ze.NONE)throw new Error("Cannot move EMPTY on a space");return t.getSize()>e?S.of(this.put(t)):S.empty()}removeBiggest(){const t=this.getBiggest();if(t===Ze.NONE)throw new Error("Cannot removed piece from empty space");let e;const r=t.getSize();switch(r){case K1.BIG:e=new jr(this.small,this.medium,fe.NONE);break;case K1.MEDIUM:e=new jr(this.small,fe.NONE,fe.NONE);break;default:Ae.expectToBe(r,K1.SMALL),e=new jr(fe.NONE,fe.NONE,fe.NONE)}return{removedSpace:e,removedPiece:t}}put(t){if(t===Ze.NONE)throw new Error("Cannot put NONE on space");const e=t.getPlayer(),r=t.getSize();switch(r){case K1.BIG:return new jr(this.small,this.medium,e);case K1.MEDIUM:return Se(this.big===fe.NONE,"Cannot put a piece on top of a bigger one"),new jr(this.small,e,this.big);default:return Ae.expectToBe(r,K1.SMALL),Se(this.big===fe.NONE,"Cannot put a piece on top of a bigger one"),Se(this.medium===fe.NONE,"Cannot put a piece on top of a bigger one"),new jr(e,this.medium,this.big)}}encode(){return this.small.value+3*this.medium.value+9*this.big.value}belongsTo(t){return this.getBiggest().getPlayer()===t}toString(){const t=this.toOrderedPieceNames();return"("+t[0]+", "+t[1]+", "+t[2]+")"}}jr.EMPTY=new jr(fe.NONE,fe.NONE,fe.NONE);let Jg=(()=>{class n{}return n.PIECE_OUT_OF_STOCK=()=>$localize`You do not have pieces of this type anymore.`,n.INVALID_PLACEMENT=()=>$localize`You must put your piece on an empty square or on a smaller piece.`,n.NOT_DROPPABLE=()=>$localize`You must pick your piece among the remaining ones.`,n.INVALID_PIECE_SELECTED=()=>$localize`You must pick one of your remaining pieces or one piece on the board that is the biggest of its square.`,n.END_YOUR_MOVE=()=>$localize`You are performing a move, you must select a landing square.`,n})();class rc extends hr{static isVictory(t){const e=t.getCopiedBoard();for(const r of rc.LINES){const i=rc.isVictoriousLine([e[r[0].y][r[0].x],e[r[1].y][r[1].x],e[r[2].y][r[2].x]]);if(i.isPresent())return i}return S.empty()}static isVictoriousLine(t){const r=t.map(s=>s.getBiggest()).map(s=>s.getPlayer());return r[0]===fe.NONE?S.empty():r[0]===r[1]&&r[1]===r[2]?S.of(r[0]):S.empty()}static isLegal(t,e){let s;if(Y(!1,t.toString()),t.isDropping()){if(s=t.piece.get(),!1===e.pieceBelongsToCurrentPlayer(s))return K.failure(Mt.MUST_CHOOSE_PLAYER_PIECE());if(!1===e.isInRemainingPieces(s))return K.failure(Jg.PIECE_OUT_OF_STOCK())}else{const c=t.startingCoord.get();if(s=e.getPieceAt(c).getBiggest(),!1===e.pieceBelongsToCurrentPlayer(s))return K.failure(Mt.MUST_CHOOSE_PLAYER_PIECE())}const o=e.getPieceAt(t.landingCoord).tryToSuperposePiece(s);return o.isPresent()?K.success(o.get()):K.failure(Jg.INVALID_PLACEMENT())}isLegal(t,e){return rc.isLegal(t,e)}applyLegalMove(t,e,r){const s=e.getCopiedBoard();let i=e.getRemainingPieces();const o=e.turn+1;let c;if(s[t.landingCoord.y][t.landingCoord.x]=jr.decode(r.encode()),t.isDropping()){c=t.piece.get();const h=i.indexOf(c);i=i.slice(0,h).concat(i.slice(h+1))}else{const h=t.startingCoord.get(),g=s[h.y][h.x].encode(),v=jr.decode(g).removeBiggest();s[h.y][h.x]=jr.decode(v.removedSpace.encode()),c=v.removedPiece}return new wl(s,o,i)}static getGameStatus(t){const r=rc.isVictory(t.gameState);return r.isPresent()?ze.getVictory(r.get()):ze.ONGOING}getGameStatus(t){return rc.getGameStatus(t)}}rc.LINES=[[new P(0,0),new P(0,1),new P(0,2)],[new P(1,0),new P(1,1),new P(1,2)],[new P(2,0),new P(2,1),new P(2,2)],[new P(0,0),new P(1,0),new P(2,0)],[new P(0,1),new P(1,1),new P(2,1)],[new P(0,2),new P(1,2),new P(2,2)],[new P(0,0),new P(1,1),new P(2,2)],[new P(0,2),new P(1,1),new P(2,0)]];class Fs extends so{constructor(t,e,r){super(),this.startingCoord=t,this.landingCoord=e,this.piece=r}static fromMove(t,e){if(t.equals(e))throw new Error("Starting coord and landing coord must be separate coords");return new Fs(S.of(t),e,S.empty())}static fromDrop(t,e){return new Fs(S.empty(),e,S.of(t))}isDropping(){return this.startingCoord.isAbsent()}equals(t){return this===t||!1!==t.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(t.startingCoord)&&this.piece.equals(t.piece)}toString(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}Fs.encoder=new class extends on{maxValue(){return 161}encodeNumber(n){const t=n.landingCoord.x,e=n.landingCoord.y;if(n.isDropping())return 18*n.piece.get().value+6*t+2*e+0;{const s=n.startingCoord.get().y;return 54*n.startingCoord.get().x+18*s+6*t+2*e+1}}decodeNumber(n){const t=n%2;n-=t;const e=(n/=2)%3;n-=e;const r=(n/=3)%3;n-=r,n/=3;const s=new P(r,e);if(0===t){const i=Ze.of(n);return Fs.fromDrop(i,s)}{const i=n%3;n-=i;const c=new P((n/=3)%3,i);return Fs.fromMove(c,s)}}};class a4t extends rr{getBoardValue(t){const e=rc.getGameStatus(t);return new dt(e.toBoardValue())}getListMoves(t){const e=[],r=t.gameState,s=r.getCopiedBoard(),i=r.getCurrentPlayer(),o=bae.toComparableObjectSet(r.getPlayerRemainingPieces());for(let c=0;c<3;c++)for(let u=0;u<3;u++){const h=new P(u,c);for(const g of o){const m=Fs.fromDrop(g,h);rc.isLegal(m,r).isSuccess()&&e.push(m)}if(s[c][u].belongsTo(i))for(let g=0;g<3;g++)for(let m=0;m<3;m++){const v=new P(m,g);if(!v.equals(h)){const T=Fs.fromMove(h,v);rc.isLegal(T,r).isSuccess()&&e.push(T)}}}return e}}const oo=new jr(fe.NONE,fe.NONE,fe.NONE),Wae=new jr(F.ZERO,fe.NONE,fe.NONE),c4t=new jr(fe.NONE,F.ZERO,fe.NONE),l4t=new jr(fe.NONE,fe.NONE,F.ZERO),qae=new jr(F.ONE,fe.NONE,fe.NONE),IS=new jr(fe.NONE,fe.NONE,F.ONE),u4t=new jr(F.ONE,F.ZERO,fe.NONE),f4t=new jr(F.ZERO,F.ZERO,fe.NONE);class jae extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Goal of the game`,$localize`The goal of Encapsule is to align three of your pieces.
        Here, we have a victory of the dark player.`,new wl([[Wae,qae,IS],[oo,c4t,oo],[oo,oo,l4t]],0,[Ze.SMALL_DARK,Ze.MEDIUM_DARK,Ze.BIG_DARK,Ze.SMALL_LIGHT,Ze.MEDIUM_LIGHT,Ze.MEDIUM_LIGHT,Ze.BIG_LIGHT])),pe.anyMove($localize`Putting a piece`,$localize`This is the initial board. You're playing Dark.<br/><br/>
        Pick one of your piece on the side of the board and put it on the board.`,wl.getInitialState(),Fs.fromDrop(Ze.SMALL_DARK,new P(1,1)),$localize`Congratulations!`),pe.fromMove($localize`Moving`,$localize`Another possible action is to move one of your pieces that is already on the board.<br/><br/>
        Click on your dark piece and then on any empty square of the board.`,new wl([[Wae,IS,oo],[oo,oo,oo],[oo,oo,oo]],0,[]),[Fs.fromMove(new P(0,0),new P(2,0)),Fs.fromMove(new P(0,0),new P(0,1)),Fs.fromMove(new P(0,0),new P(1,1)),Fs.fromMove(new P(0,0),new P(2,1)),Fs.fromMove(new P(0,0),new P(0,2)),Fs.fromMove(new P(0,0),new P(1,2)),Fs.fromMove(new P(0,0),new P(2,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),pe.fromPredicate($localize`Particularity`,$localize`At Encapsule, pieces encapsulate each other.
        It is therefore possible to have up to three pieces per square!
        However, only the biggest piece of each square counts:
        you cannot win with a piece that is "hidden" by a bigger piece.
        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.
        Finally, you cannot encapsulate a piece with a smaller piece.
        You're playing Dark and you can win now in various ways.<br/><br/>
        Try to win by making a move, and not by putting a new piece on the board.`,new wl([[u4t,oo,qae],[f4t,IS,IS],[oo,oo,oo]],0,[Ze.MEDIUM_DARK,Ze.BIG_DARK,Ze.MEDIUM_LIGHT,Ze.MEDIUM_LIGHT]),Fs.fromMove(new P(0,1),new P(0,2)),(t,e,r)=>{if(t.landingCoord.equals(new P(0,2))){if(t.isDropping())return G.failure($localize`You won, but the exercise is to win while moving a piece!`);if(t.startingCoord.equalsValue(new P(0,1)))return G.SUCCESS}return G.failure($localize`Failed. Try again.`)},$localize`Congratulations!`)]}}function h4t(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"circle",5),se("click",function(){const s=he(e),i=s.$implicit,o=s.index,c=E().$implicit;return ce(E().onPieceClick(c.value,i,o))}),A()()}if(2&n){const e=t.$implicit,r=t.index,s=E().$implicit,i=E();M(1),D3("id","piece_",s.value,"_",e.toString(),"_",r,""),w("ngClass",i.getSidePieceClasses(e,r)),V("transform","rotate("+180*(i.role.value+s.value)+" "+i.CENTER+" "+i.CENTER+")")("r",i.getPieceRadius(e))("cx",i.getRemainingPieceCenterCoord(s,r).x)("cy",i.getRemainingPieceCenterCoord(s,r).y)}}function d4t(n,t){if(1&n&&(B(),N(0,"g",null,4),k(2,h4t,2,8,"g",1),A()),2&n){const e=t.$implicit,r=E();M(2),w("ngForOf",r.getRemainingPieces(e))}}function p4t(n,t){if(1&n){const e=we();B(),N(0,"circle",8),se("click",function(){he(e);const s=E().index,i=E().index;return ce(E().onBoardClick(s,i))}),A()}if(2&n){const e=t.$implicit,r=E().index,s=E().index,i=E();w("ngClass",i.getPieceClasses(e)),V("r",i.getPieceRadius(e))("cx",i.getPieceCenter(r))("cy",i.getPieceCenter(s))}}function g4t(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"rect",6),se("click",function(){const i=he(e).index,o=E().index;return ce(E().onBoardClick(i,o))}),A(),k(2,p4t,1,4,"circle",7),A()}if(2&n){const e=t.$implicit,r=t.index,s=E().index,i=E();M(1),je("id","click_",r,"_",s,""),w("ngClass",i.getRectClasses(r,s)),V("x",i.SPACE_SIZE*r+i.STROKE_WIDTH)("y",i.SPACE_SIZE*s+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),M(1),w("ngForOf",i.getListPieces(e))}}function m4t(n,t){if(1&n&&(B(),N(0,"g"),k(1,g4t,3,8,"g",1),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}function _4t(n,t){if(1&n){const e=we();B(),N(0,"rect",9),se("click",function(){he(e);const s=E();return ce(s.onBoardClick(s.chosenCoord.get().x,s.chosenCoord.get().y))}),A()}if(2&n){const e=E();je("id","chosenCoord_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),V("x",e.SPACE_SIZE*e.chosenCoord.get().x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.chosenCoord.get().y+e.STROKE_WIDTH)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}let v4t=(()=>{class n extends Bo{constructor(e){super(e),this.CENTER=this.getPieceCenter(1),this.UPLEFT=-(this.SPACE_SIZE+.5*this.STROKE_WIDTH),this.WIDTH=5*this.SPACE_SIZE+3*this.STROKE_WIDTH,this.lastLandingCoord=S.empty(),this.lastStartingCoord=S.empty(),this.chosenCoord=S.empty(),this.chosenPiece=S.empty(),this.remainingPieceCenterCoords=new Qn,this.rules=new rc(wl),this.availableMinimaxes=[new a4t(this.rules,"EncapsuleMinimax")],this.encoder=Fs.encoder,this.tutorial=(new jae).tutorial,this.updateBoard()}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard();const r=this.rules.node.move;this.calculateLeftPieceCoords(),r.isPresent()?(this.lastLandingCoord=S.of(r.get().landingCoord),this.lastStartingCoord=r.get().startingCoord):(this.lastLandingCoord=S.empty(),this.lastStartingCoord=S.empty())}getListPieces(e){return e.toList()}getRemainingPieces(e){return this.getState().getRemainingPiecesOfPlayer(e)}onBoardClick(e,r){var s=this;return O(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new P(e,r),c=s.getState();if(s.chosenCoord.isAbsent()){if(s.chosenCoord=S.of(o),s.chosenPiece.isPresent()){const u=Fs.fromDrop(s.chosenPiece.get(),o);return s.chooseMove(u,s.getState())}return!1===c.getPieceAt(o).belongsTo(c.getCurrentPlayer())?s.cancelMove(Jg.INVALID_PIECE_SELECTED()):G.SUCCESS}if(s.chosenCoord.equalsValue(o))return s.cancelMoveAttempt(),G.SUCCESS;{const u=Fs.fromMove(s.chosenCoord.get(),o);return s.chooseMove(u,s.getState())}})()}cancelMoveAttempt(){this.chosenCoord=S.empty(),this.chosenPiece=S.empty(),this.chosenPieceIndex=S.empty()}onPieceClick(e,r,s){var i=this;return O(function*(){const o="#piece_"+e+"_"+r.toString()+"_"+s,c=i.canUserPlay(o);return c.isFailure()?i.cancelMove(c.getReason()):!1===i.getState().isDroppable(r)?i.cancelMove(Jg.NOT_DROPPABLE()):i.chosenCoord.isAbsent()?(i.chosenPiece.equalsValue(r)&&i.chosenPieceIndex.equalsValue(s)?(i.chosenPiece=S.empty(),i.chosenPieceIndex=S.empty()):(i.chosenPiece=S.of(r),i.chosenPieceIndex=S.of(s)),G.SUCCESS):i.cancelMove(Jg.END_YOUR_MOVE())})()}getRectClasses(e,r){return this.isSelected(e,r)?"moved-fill":""}isSelected(e,r){const s=new P(e,r);return!(!this.lastStartingCoord.equalsValue(s)&&!this.lastLandingCoord.equalsValue(s))}getPieceClasses(e){return[this.getPieceStrokeClass(e)]}getPieceCenter(e){return this.SPACE_SIZE*e+this.STROKE_WIDTH+this.SPACE_SIZE/2}getPieceStrokeClass(e){const r=e.getPlayer();return Se(r.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+r.value+"-stroke"}getPieceRadius(e){switch(e.getSize()){case K1.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case K1.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return Ae.expectToBe(e.getSize(),K1.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}getSidePieceClasses(e,r){const s=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex.equalsValue(r)&&s.push("selected-stroke"),s}isSelectedPiece(e){return this.chosenPiece.equalsValue(e)}calculateLeftPieceCoords(){this.remainingPieceCenterCoords=new Qn;for(const e of F.PLAYERS){const r=[],s=this.getRemainingPieces(e);for(let i=0;i<s.length;i++){let o,c=0,u=0;i<=2?(o=new P(2-i,3),u=this.STROKE_WIDTH):(o=new P(-1,5-i),c=-this.STROKE_WIDTH);const h=this.getPieceCenter(o.x),g=this.getPieceCenter(o.y);r.push(new P(h+c,g+u))}this.remainingPieceCenterCoords.set(e,r)}}getRemainingPieceCenterCoord(e,r){return this.remainingPieceCenterCoords.get(e).get()[r]}}return n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-encapsule"]],features:[l],decls:6,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected-stroke","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingPieces",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected-stroke",3,"id","click"]],template:function(e,r){1&e&&(B(),N(0,"svg",0),k(1,d4t,3,1,"g",1),N(2,"g",null,2),k(4,m4t,2,1,"g",1),k(5,_4t,1,6,"rect",3),A()()),2&e&&(V("viewBox",r.UPLEFT+" "+r.UPLEFT+" "+r.WIDTH+" "+r.WIDTH),M(1),w("ngForOf",r.Player.PLAYERS),M(3),w("ngForOf",r.board),M(1),w("ngIf",r.chosenCoord.isPresent()))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class sc extends Yc{constructor(t,e,r,s,i){if(super(t,e),this.movedPieces=r,this.stepSize=s,this.direction=i,this.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+this.coord.toString()+".");if(r<1)throw new Error("Must select minimum one piece (got "+r+").");if(s<1)throw new Error("Step size must be minimum one (got "+s+").");if(s>r)throw new Error("Cannot move a phalanx further than its size (got step size "+s+" for "+r+" pieces).")}toString(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}equals(t){return this===t||!(!this.coord.equals(t.coord)||this.movedPieces!==t.movedPieces||this.stepSize!==t.stepSize)&&this.direction.equals(t.direction)}}sc.encoder=new class extends on{maxValue(){return 122303}encodeNumber(n){const t=n.direction.toInt();return 8*n.coord.x*7*13*12+8*n.coord.y*7*13+8*(n.movedPieces-1)*7+8*(n.stepSize-1)+t}decodeNumber(n){if(n%1!=0)throw new Error("EncodedMove must be an integer.");const t=n%8;n-=t;const e=(n/=8)%7;n-=e;const r=(n/=7)%13;n-=r;const s=(n/=13)%12;n-=s;const i=n/=12,o=Pe.factory.fromInt(t);return new sc(i,s,r+1,e+1,o.get())}};class n3 extends Vs{static getInitialState(){const t=fe.NONE,e=fe.ZERO,r=fe.ONE;return new n3([[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e]],0)}count(t,e){let r=0;for(let s=0;s<14;s++)this.board[e][s]===t&&r++;return r}doesOwnPiece(t){for(let e=0;e<12;e++)for(let r=0;r<14;r++)if(this.board[e][r]===t)return!0;return!1}}let ic=(()=>{class n{}return n.PHALANX_IS_LEAVING_BOARD=()=>$localize`The move distance of your phalanx puts it out of the board.`,n.SOMETHING_IN_PHALANX_WAY=()=>$localize`There is something in the way of your phalanx.`,n.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=()=>$localize`Your phalanx must be bigger than the one you are capturing.`,n.SQUARE_NOT_ALIGNED_WITH_SELECTED=()=>$localize`This square is not aligned with the selected piece.`,n.SINGLE_PIECE_MUST_MOVE_BY_ONE=()=>$localize`A single piece can only move by one square.`,n.SINGLE_PIECE_CANNOT_CAPTURE=()=>$localize`A single piece cannot make a capture.`,n.SQUARE_NOT_ALIGNED_WITH_PHALANX=()=>$localize`This square is not aligned with the direction of the phalanx.`,n.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=()=>$localize`A phalanx can't contain pieces outside of the board.`,n.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE=()=>$localize`A phalanx cannot contain an empty square.`,n.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=()=>$localize`A phalanx cannot contain a piece of the opponent.`,n})();class M0 extends hr{static isLegal(t,e){const r=this.getPhalanxValidity(e,t);if(r.isFailure())return K.failure(r.getReason());const s=this.getLandingStatus(e,t);if(s.isFailure())return s;const i=ht.copyBiArray(s.get()),o=e.getCurrentOpponent(),c=M0.getCaptureValidity(e,i,t,o);return c.isFailure()?c:K.success(c.get())}static getPhalanxValidity(t,e){let r=e.coord,s=0;const i=t.getCurrentOpponent();for(;s<e.movedPieces;){if(r.isNotInRange(14,12))return G.failure(ic.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());const o=t.getPieceAt(r);if(o===fe.NONE)return G.failure(ic.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(o===i)return G.failure(ic.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());r=r.getNext(e.direction,1),s++}return G.SUCCESS}static getLandingStatus(t,e){const r=t.getCopiedBoard(),s=t.getCurrentPlayer();let i=e.coord,o=e.coord.getNext(e.direction,e.movedPieces),c=0;for(;c+1<e.stepSize;){if(r[i.y][i.x]=fe.NONE,r[o.y][o.x]=s,o.isNotInRange(14,12))return K.failure(ic.PHALANX_IS_LEAVING_BOARD());if(t.getPieceAt(o).isPlayer())return K.failure(ic.SOMETHING_IN_PHALANX_WAY());c++,o=o.getNext(e.direction,1),i=i.getNext(e.direction,1)}return o.isNotInRange(14,12)?K.failure(ic.PHALANX_IS_LEAVING_BOARD()):t.getPieceAt(o)===s?K.failure(Mt.CANNOT_SELF_CAPTURE()):(r[i.y][i.x]=fe.NONE,r[o.y][o.x]=s,K.success(r))}static getCaptureValidity(t,e,r,s){let i=r.coord.getNext(r.direction,r.movedPieces+r.stepSize-1),o=0;for(;i.isInRange(14,12)&&t.getPieceAt(i)===s;){if(o>0&&(e[i.y][i.x]=fe.NONE),o++,o>=r.movedPieces)return K.failure(ic.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(r.direction,1)}return K.success(e)}isLegal(t,e){return M0.isLegal(t,e)}applyLegalMove(t,e,r){return new n3(r,e.turn+1)}getGameStatus(t){const e=t.gameState,r=e.count(F.ZERO,0),s=e.count(F.ONE,11);if(e.turn%2==0){if(r>s)return ze.ZERO_WON}else if(s>r)return ze.ONE_WON;return!1===e.doesOwnPiece(F.ZERO)?ze.ONE_WON:!1===e.doesOwnPiece(F.ONE)?ze.ZERO_WON:ze.ONGOING}}class em extends rr{static getListMoves(t){const e=t.gameState.getCurrentPlayer(),r=t.gameState.getCurrentOpponent(),s=fe.NONE;let i=[];const o=t.gameState;let c;for(let u=0;u<12;u++)for(let h=0;h<14;h++){const g=new P(h,u);if(o.getPieceAt(g)===e)for(const m of Pe.DIRECTIONS){let v=1,T=g.getNext(m,1);for(;T.isInRange(14,12)&&o.getPieceAt(T)===e;)v+=1,T=T.getNext(m,1);let I=1;for(;T.isInRange(14,12)&&I<=v&&o.getPieceAt(T)===s;)c=new sc(h,u,v,I,m),i=this.addMove(i,c,o),I++,T=T.getNext(m,1);T.isInRange(14,12)&&I<=v&&o.getPieceAt(T)===r&&(c=new sc(h,u,v,I,m),i=this.addMove(i,c,o))}}return i}static addMove(t,e,r){return M0.isLegal(e,r).isSuccess()&&t.push(e),t}getListMoves(t){const e=em.getListMoves(t);return ht.sortByDescending(e,r=>r.stepSize),e}getBoardValue(t){const e=this.ruler.getGameStatus(t);return new dt(e.isEndGame?e.toBoardValue():this.getPieceCountPlusRowDomination(t.gameState))}getPieceCountPlusRowDomination(t){let o=0;for(let c=0;c<12;c++){let u=0;const h=[0,0];for(let g=0;g<14;g++){const m=new P(g,c),v=t.getPieceAt(m);if(v.isPlayer()){const T=v.getScoreModifier();o+=2002*T,h[v.value]=T,u+=T;for(const I of[Pe.UP_LEFT,Pe.UP,Pe.UP_RIGHT]){let z=m.getNext(I,1);for(;z.isInRange(14,12)&&t.getPieceAt(z)===v;)o+=1*T,z=z.getNext(I,1)}}}0!==u&&(o+=Math.abs(u)/u*2),o+=1*h.reduce((g,m)=>g+m)}return o}}class C4t extends rr{getListMoves(t){const e=em.getListMoves(t);return this.orderMovesByPhalanxSizeAndFilter(e,t.gameState)}orderMovesByPhalanxSizeAndFilter(t,e){return ht.sortByDescending(t,r=>r.movedPieces),t.length>40?t.filter(s=>!!this.moveIsCapture(s,e)||s.movedPieces*Math.random()>1):t}moveIsCapture(t,e){const r=t.coord.getNext(t.direction,t.movedPieces+t.stepSize-1);return e.board[r.y][r.x]===e.getCurrentOpponent()}getBoardValue(t){const e=this.ruler.getGameStatus(t);return new dt(e.isEndGame?e.toBoardValue():this.getPieceCountThenSupportThenAdvancement(t.gameState))}getPieceCountThenSupportThenAdvancement(t){let o=0;for(let c=0;c<12;c++)for(let u=0;u<14;u++){const h=new P(u,c),g=t.getPieceAt(h);if(g.isPlayer()){let m,v;g===F.ZERO?(m=12-c,v=[Pe.UP_LEFT,Pe.UP,Pe.UP_RIGHT]):(m=c+1,v=[Pe.DOWN_LEFT,Pe.DOWN,Pe.DOWN_RIGHT]);const T=g.getScoreModifier();o+=m*T,o+=149629*T;for(const I of v){let z=h.getNext(I,1);for(;z.isInRange(14,12)&&t.getPieceAt(z)===g;)o+=337*T,z=z.getNext(I,1)}}}return o}}class y4t extends em{constructor(){super(...arguments),this.DOMINANCE_FACTOR=20,this.DEFENSE_FACTOR=5,this.TERRITORY_FACTOR=2,this.OFFENSE_FACTOR=10,this.CENTER_FACTOR=5,this.MOBILITY_FACTOR=.12}getDominance(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new P(s,r));i.isPlayer()&&(e+=i.getScoreModifier())}return e*this.DOMINANCE_FACTOR}getDefense(t){let e=0;for(let r=0;r<14;r++)t.getPieceAt(new P(r,11))===F.ZERO&&(e+=F.ZERO.getScoreModifier()),t.getPieceAt(new P(r,0))===F.ONE&&(e+=F.ONE.getScoreModifier());return e*this.DEFENSE_FACTOR}getTerritory(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new P(s,r));if(i.isPlayer()){for(let o=-1;o<=1;o++)for(let c=-1;c<=1;c++){const u=new P(s+o,r+c);if(u.isInRange(14,12)){const h=t.getPieceAt(u);(h===i||h===fe.NONE)&&(e+=1*i.getScoreModifier())}}e-=i.getScoreModifier()}}return e*this.TERRITORY_FACTOR}getOffense(t){let e=0;for(let r=0;r<14;r++)t.getPieceAt(new P(r,0))===F.ZERO&&(e+=F.ZERO.getScoreModifier()),t.getPieceAt(new P(r,11))===F.ONE&&(e+=F.ONE.getScoreModifier());return e*this.OFFENSE_FACTOR}getCenter(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new P(s,r));i.isPlayer()&&(e+=i.getScoreModifier()*Math.sqrt((s-6.5)*(s-6.5)))}return e*this.CENTER_FACTOR}getMobility(t){let e=0,r=0,s=0;for(let i=0;i<12;i++)for(let o=0;o<14;o++){const c=new P(o,i),u=t.getPieceAt(c);if(u.isPlayer())for(const h of Pe.DIRECTIONS){let g=1,m=c.getNext(h,1);for(;m.isInRange(14,12)&&t.getPieceAt(m)===u;)g+=1,m=m.getNext(h,1);let v=1;for(;m.isInRange(14,12)&&v<=g&&t.getPieceAt(m)===fe.NONE;)v++,m=m.getNext(h,1);e+=v*v*u.getScoreModifier(),u===F.ZERO?r=Math.max(r,v):u===F.ONE&&(s=Math.max(s,v))}}return(e+r*F.ZERO.getScoreModifier()+s*F.ONE.getScoreModifier())*this.MOBILITY_FACTOR}getBoardValue(t){const e=t.gameState,r=this.ruler.getGameStatus(t);if(r.isEndGame)return new dt(r.toBoardValue());const s=this.getDominance(e),i=this.getDefense(e),o=this.getTerritory(e),c=this.getCenter(e),u=this.getOffense(e),h=this.getMobility(e);return new dt(s+i+o+c+u+h)}}const x=fe.NONE,wr=fe.ZERO,z1=fe.ONE;class Zae extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Initial board`,$localize`This is the initial board of Epaminondas.
        The top line is the starting line of Light.
        The bottom line is the starting line of Dark.`,n3.getInitialState()),pe.informational($localize`Goal of the game (1/2)`,$localize`After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line
        than the number of pieces the opponent has on the player's starting line, the player wins.
        Here, it's Dark's turn to play: Dark has therefore won.`,new n3([[x,x,x,x,x,wr,x,x,z1,z1,z1,z1,z1,z1],[x,x,x,x,x,wr,x,x,x,x,x,x,z1,z1],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,z1,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,wr,wr,wr,wr,x,x,x]],0)),pe.informational($localize`Goal of the game (2/2)`,$localize`Here, it is Light's turn.
        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line.`,new n3([[x,x,x,x,x,wr,x,x,x,x,z1,z1,z1,z1],[x,x,x,x,x,wr,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,z1,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,z1,z1,x,x,x,wr,wr,x,wr,wr,wr,wr]],1)),pe.fromPredicate($localize`Moving a piece`,$localize`Here is the starting board. Dark plays first.
        Let's start with moving a single piece:
        <ol>
            <li>Click on a piece.</li>
            <li>Click on a empty neighboring square.</li>
        </ol>`,n3.getInitialState(),new sc(0,10,1,1,Pe.UP),(t,e,r)=>1===t.movedPieces?G.SUCCESS:G.failure($localize`Congratulations, you are in advance. But this is not the exercise here, try again.`),$localize`This is how you move a single piece.`),pe.fromPredicate($localize`Moving a phalanx`,$localize`Let us now see how to move multiple pieces along a line, which is called a phalanx:
        <ol>
            <li>Click on the first piece of the phalanx.</li>
            <li>Click on the last piece of the phalanx.</li>
            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>
        </ol><br/>
        Move a phalanx!`,n3.getInitialState(),new sc(0,11,2,1,Pe.UP),(t,e,r)=>t.movedPieces>1?G.SUCCESS:G.failure($localize`Failed! You moved only one piece.`),$localize`Congratulations!
        The moved pieces can be horizontally, vertically, or diagonally aligned.
        The move should be made along this axis, forward or backwards.
        There can be no opponent nor holes in the phalanx.`),pe.fromMove($localize`Capture`,$localize`In order to capture pieces of the opponent:
        <ol>
            <li>It must be aligned with the phalanx you are moving.</li>
            <li>It must be strictly shorter than your phalanx.</li>
            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>
        </ol><br/>
        Capture a phalanx.`,new n3([[x,x,x,x,x,x,x,x,z1,z1,z1,z1,z1,z1],[x,x,x,x,x,x,z1,x,x,x,x,x,x,x],[x,x,x,x,x,z1,x,x,x,x,x,x,x,x],[x,x,z1,x,z1,x,x,x,x,x,x,x,x,x],[x,x,z1,z1,x,x,x,x,x,x,x,x,x,x],[x,x,z1,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,wr,x,x,x,x,x,x,x,x,x,x,x],[x,x,wr,x,x,x,x,z1,x,x,x,x,x,x],[x,x,wr,x,x,x,x,x,x,x,x,x,x,x],[x,x,wr,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,wr,wr,wr,wr,wr,wr,wr]],0),[new sc(2,10,4,2,Pe.UP)],$localize`Congratulations, you made it!
        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment.`,$localize`Failed, you have not captured the phalanx.`)]}}function E4t(n,t){if(1&n){const e=we();B(),N(0,"circle",4),se("click",function(){he(e);const s=E().index,i=E().index;return ce(E().onClick(s,i))}),A()}if(2&n){const e=E().index,r=E().index,s=E();w("ngClass",s.getPieceClasses(e,r)),V("cx",s.SPACE_SIZE*e+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.STROKE_WIDTH+s.SPACE_SIZE/2)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function M4t(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"rect",2),se("click",function(){const i=he(e).index,o=E().index;return ce(E().onClick(i,o))}),A(),k(2,E4t,1,4,"circle",3),A()}if(2&n){const e=t.index,r=E().index,s=E();M(1),je("id","click_",e,"_",r,""),w("ngClass",s.getRectClasses(e,r)),V("x",s.SPACE_SIZE*e+s.STROKE_WIDTH)("y",s.SPACE_SIZE*r+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),M(1),w("ngIf",s.board[r][e]!==s.NONE)}}function S4t(n,t){if(1&n&&(B(),N(0,"g"),k(1,M4t,3,8,"g",1),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}function P4t(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"rect",5),se("click",function(){const i=he(e).$implicit;return ce(E().onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=E();M(1),V("x",r.SPACE_SIZE*e.x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*e.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let T4t=(()=>{class n extends Bo{constructor(e){super(e),this.NONE=fe.NONE,this.firstPiece=S.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=S.empty(),this.phalanxDirection=S.empty(),this.phalanxMiddles=[],this.moveds=[],this.captureds=[],this.hasAsymetricBoard=!0,this.rules=new M0(n3),this.availableMinimaxes=[new em(this.rules,"Normal"),new C4t(this.rules,"Positional"),new y4t(this.rules,"Attack")],this.encoder=sc.encoder,this.tutorial=(new Zae).tutorial,this.updateBoard()}updateBoard(){this.firstPiece=S.empty(),this.lastPiece=S.empty(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.board=this.getState().getCopiedBoard()}showPreviousMove(){const e=this.rules.node.move.get();let r=e.coord;this.moveds=[r];for(let o=1;o<e.stepSize+e.movedPieces;o++)r=r.getNext(e.direction,1),this.moveds.push(r);const s=this.rules.node.mother.get(),i=s.gameState.getCurrentOpponent();for(;r.isInRange(14,12)&&s.gameState.getPieceAt(r)===i;)this.captureds.push(r),r=r.getNext(e.direction,1)}onClick(e,r){var s=this;return O(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.firstPiece.isAbsent()?s.firstClick(e,r):s.lastPiece.isAbsent()?s.secondClick(e,r):s.thirdClick(e,r)})()}firstClick(e,r){var s=this;return O(function*(){const i=s.getState().getCurrentOpponent(),o=s.getState().getCurrentPlayer();switch(s.board[r][e]){case o:return s.firstPiece=S.of(new P(e,r)),s.validExtensions=s.getValidExtensions(o),s.phalanxValidLandings=s.getPhalanxValidLandings(),G.SUCCESS;case i:return s.cancelMove(Mt.CANNOT_CHOOSE_OPPONENT_PIECE());default:return Ae.expectToBe(s.board[r][e],fe.NONE),s.cancelMove(Mt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())}})()}hidePreviousMove(){this.captureds=[],this.moveds=[]}getValidExtensions(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}getFirstPieceExtensions(e){const r=[];for(const s of Pe.DIRECTIONS){let i=this.firstPiece.get().getNext(s,1);for(;i.isInRange(14,12)&&this.board[i.y][i.x]===e;)r.push(i),i=i.getNext(s,1)}return r}getPhalanxValidExtensions(e){let r=Pe.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get();const s=this.lastPiece.get().getNext(r,1),i=this.getExtensionsToward(s,r,e);r=r.getOpposite();const o=this.firstPiece.get().getNext(r,1),c=this.getExtensionsToward(o,r,e);return i.concat(c)}getExtensionsToward(e,r,s){const i=[];for(;e.isInRange(14,12)&&this.board[e.y][e.x]===s;)i.push(e),e=e.getNext(r,1);return i}getPhalanxValidLandings(){if(this.lastPiece.isPresent()){const e=this.firstPiece.get(),r=this.lastPiece.get(),s=Math.abs(e.x-r.x),i=Math.abs(e.y-r.y),o=Math.max(s,i)+1;let c=Pe.factory.fromMove(e,r).get();const u=r.getNext(c,1),h=this.getLandingsToward(u,c,o);c=c.getOpposite();const g=e.getNext(c,1);return this.getLandingsToward(g,c,o).concat(h)}return this.getNeighboringEmptySpaces()}getNeighboringEmptySpaces(){const e=[];for(const r of Pe.DIRECTIONS){const s=this.firstPiece.get().getNext(r,1);s.isInRange(14,12)&&this.board[s.y][s.x]===fe.NONE&&e.push(s)}return e}getLandingsToward(e,r,s){const i=this.getState().getCurrentPlayer(),o=this.getState().getCurrentOpponent(),c=[];for(;e.isInRange(14,12)&&c.length<s&&this.board[e.y][e.x]!==i;){if(this.board[e.y][e.x]===o)return this.getPhalanxLength(e,r,o)<s&&c.push(e),c;c.push(e),e=e.getNext(r,1)}return c}getPhalanxLength(e,r,s){let i=0;for(;e.isInRange(14,12)&&this.board[e.y][e.x]===s;)i++,e=e.getNext(r,1);return i}cancelMoveAttempt(){this.firstPiece=S.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=S.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}secondClick(e,r){var s=this;return O(function*(){const i=new P(e,r),o=s.firstPiece.get();if(i.equals(o))return s.cancelMoveAttempt(),G.SUCCESS;const c=s.getState().getCurrentOpponent(),u=s.getState().getCurrentPlayer();if(!i.isAlignedWith(o))return s.cancelMove(ic.SQUARE_NOT_ALIGNED_WITH_SELECTED());const h=i.getDistance(o),g=o.getDirectionToward(i).get();switch(s.board[r][e]){case fe.NONE:return 1===h?s.tryMove(new sc(o.x,o.y,1,1,g)):s.cancelMove(ic.SINGLE_PIECE_MUST_MOVE_BY_ONE());case c:return s.cancelMove(ic.SINGLE_PIECE_CANNOT_CAPTURE());default:Ae.expectToBe(s.board[r][e],u);const m=new sc(o.x,o.y,h,1,g),v=s.getState(),T=M0.getPhalanxValidity(v,m);return T.isFailure()?s.cancelMove(T.getReason()):(s.lastPiece=S.of(i),s.validExtensions=s.getValidExtensions(u),s.phalanxValidLandings=s.getPhalanxValidLandings(),s.phalanxMiddles=o.getCoordsToward(i),s.phalanxDirection=S.of(g),G.SUCCESS)}})()}thirdClick(e,r){var s=this;return O(function*(){const i=s.getState().getCurrentPlayer(),o=new P(e,r);if(s.firstPiece.equalsValue(o))return s.moveFirstPiece(i);if(s.lastPiece.equalsValue(o))return s.moveLastPiece(i);const c=s.firstPiece.get(),u=s.lastPiece.get();if(!o.isAlignedWith(c))return s.cancelMove(ic.SQUARE_NOT_ALIGNED_WITH_PHALANX());let h=Pe.factory.fromMove(c,u).get();const g=Pe.factory.fromMove(c,o).get();if(h===g.getOpposite()&&(s.firstPiece=S.of(u),s.lastPiece=S.of(c),h=g),h!==g)return s.cancelMove(ic.SQUARE_NOT_ALIGNED_WITH_PHALANX());if(s.board[r][e]===i)return s.thirdClickOnPlayerPiece(o,h,i);{const m=s.firstPiece.get().getDistance(s.lastPiece.get())+1,v=s.lastPiece.get().getDistance(o),T=new sc(s.firstPiece.get().x,s.firstPiece.get().y,m,v,h);return s.tryMove(T)}})()}thirdClickOnPlayerPiece(e,r,s){var i=this;return O(function*(){i.lastPiece=S.of(e);const o=i.firstPiece.get().getDistance(e)+1,c=new sc(i.firstPiece.get().x,i.firstPiece.get().y,o,1,r),u=M0.getPhalanxValidity(i.rules.node.gameState,c);return u.isFailure()?i.cancelMove(u.getReason()):(i.phalanxMiddles=i.firstPiece.get().getCoordsToward(i.lastPiece.get()),i.validExtensions=i.getValidExtensions(s),i.phalanxValidLandings=i.getPhalanxValidLandings(),G.SUCCESS)})()}moveFirstPiece(e){var r=this;return O(function*(){return r.firstPiece=S.of(r.firstPiece.get().getNext(r.phalanxDirection.get(),1)),r.firstPiece.equals(r.lastPiece)?yield r.moveOnlyPiece(e):(r.phalanxMiddles=r.phalanxMiddles.slice(1),r.validExtensions=r.getPhalanxValidExtensions(e)),r.phalanxValidLandings=r.getPhalanxValidLandings(),G.SUCCESS})()}moveLastPiece(e){var r=this;return O(function*(){return r.lastPiece=S.of(r.lastPiece.get().getPrevious(r.phalanxDirection.get(),1)),r.firstPiece.equals(r.lastPiece)?r.moveOnlyPiece(e):(r.phalanxMiddles=r.firstPiece.get().getCoordsToward(r.lastPiece.get()),r.validExtensions=r.getPhalanxValidExtensions(e),r.phalanxValidLandings=r.getPhalanxValidLandings(),G.SUCCESS)})()}moveOnlyPiece(e){var r=this;return O(function*(){return r.lastPiece=S.empty(),r.validExtensions=r.getFirstPieceExtensions(e),r.phalanxDirection=S.empty(),r.phalanxMiddles=[],r.phalanxValidLandings=r.getPhalanxValidLandings(),G.SUCCESS})()}tryMove(e){const r=this.getState();return this.cancelMove(),this.chooseMove(e,r)}getPieceClasses(e,r){const s=this.getPlayerClass(this.board[r][e]);return this.getPieceStrokeClasses(e,r).concat([s])}getPieceStrokeClasses(e,r){const s=new P(e,r);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(s)||this.lastPiece.equalsValue(s)||this.phalanxMiddles.some(i=>i.equals(s))?["selected-stroke"]:[]}getRectClasses(e,r){const s=new P(e,r);return this.captureds.some(i=>i.equals(s))?["captured-fill"]:this.moveds.some(i=>i.equals(s))?["moved-fill"]:[]}getHighlightedCoords(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}getCurrentPlayerPieces(){const e=[],s=this.getState().getCurrentPlayer();for(let i=0;i<this.board.length;i++)for(let o=0;o<this.board[i].length;o++)this.board[i][o]===s&&e.push(new P(o,i));return e}}return n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-epaminondas"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable-stroke",3,"click"]],template:function(e,r){1&e&&(B(),N(0,"svg",0),k(1,S4t,2,1,"g",1),k(2,P4t,2,4,"g",1),A()),2&e&&(V("transform",r.rotation),M(1),w("ngForOf",r.board),M(1),w("ngForOf",r.getHighlightedCoords()))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();function Yae(n){return new class extends u0{encode(t){return t.isPresent()?n.encode(t.get()):null}decode(t){return null===t?S.empty():S.of(n.decode(t))}}}class l2{constructor(t){if(t.length<4)throw new Error("Cannot create a GipfCapture with less than 4 captured pieces");if(!1===ya.areOnSameLine(t))throw new Error("Cannot create a GipfCapture with pieces that are not on the same line");this.capturedSpaces=ht.copyImmutableArray(t).sort((r,s)=>{if(r.x===s.x){if(r.y===s.y)throw new Error("Cannot create a GipfCapture with duplicate coords");return r.y>s.y?1:-1}return r.x>s.x?1:-1});let e=S.empty();for(const r of this.capturedSpaces){if(e.isPresent()&&1!==e.get().getDistance(r))throw new Error("Cannot create a GipfCapture with non-consecutive coords");e=S.of(r)}}toString(){let t="";for(const e of this.capturedSpaces)""!==t&&(t+=","),t+=e.toString();return t}size(){return this.capturedSpaces.length}forEach(t){this.capturedSpaces.forEach(t)}contains(t){for(let e=0;e<this.capturedSpaces.length;e++)if(this.capturedSpaces[e].equals(t))return!0;return!1}intersectsWith(t){return this.capturedSpaces.some(e=>t.contains(e))}getLine(){return ya.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}equals(t){if(this===t)return!0;if(this.capturedSpaces.length!==t.capturedSpaces.length)return!1;for(let e=0;e<this.capturedSpaces.length;e++)if(!this.capturedSpaces[e].equals(t.capturedSpaces[e]))return!1;return!0}}l2.encoder=new class extends u0{encode(n){return n.capturedSpaces.map(t=>P.encoder.encode(t))}decode(n){return new l2(n.map(e=>P.encoder.decode(e)))}};class Ma{constructor(t,e){this.coord=t,this.direction=e}toString(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}equals(t){return!!this.coord.equals(t.coord)&&this.direction.equals(t.direction)}}Ma.encoder=new class extends u0{constructor(){super(...arguments),this.optionalDirectionEncoder=Yae(Ie.encoder)}encode(n){return{coord:P.encoder.encode(n.coord),direction:this.optionalDirectionEncoder.encode(n.direction)}}decode(n){const t=n;return Se(null!=t.coord,"Invalid encoded GipfPlacement"),new Ma(P.encoder.decode(t.coord),this.optionalDirectionEncoder.decode(t.direction))}};class Uo extends so{constructor(t,e,r){super(),this.placement=t,this.initialCaptures=e,this.finalCaptures=r}toString(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(t){let e="";for(const r of t)""!==e&&(e+=","),e+="["+r.toString()+"]";return e}equals(t){return this===t||!(!1===this.placement.equals(t.placement)||!1===ht.compareArray(this.initialCaptures,t.initialCaptures)||!1===ht.compareArray(this.finalCaptures,t.finalCaptures))}encode(){return Uo.encoder.encode(this)}decode(t){return Uo.encoder.decode(t)}}Uo.encoder=new class extends e4{encodeMove(n){const t={placement:Ma.encoder.encode(n.placement)};return n.initialCaptures.map((e,r)=>{t["initialCapture"+r]=l2.encoder.encode(e)}),n.finalCaptures.map((e,r)=>{t["finalCapture"+r]=l2.encoder.encode(e)}),t}decodeMove(n){const t=n;return Se(null!=t.placement,"Invalid encoded GipfMove"),new Uo(Ma.encoder.decode(t.placement),this.decodeArray(t,"initialCapture",l2.encoder.decode),this.decodeArray(t,"finalCapture",l2.encoder.decode))}decodeArray(n,t,e){const r=[];for(let s=0;null!=n[t+s];s++)r.push(e(n[t+s]));return r}};class Sa extends z8{constructor(t,e,r,s){super(e,t,7,7,[3,2,1],be.EMPTY),this.sidePieces=r,this.capturedPieces=s}static getInitialState(){const t=be.EMPTY,e=be.UNREACHABLE,r=be.ZERO,s=be.ONE;return new Sa([[e,e,e,s,t,t,r],[e,e,t,t,t,t,t],[e,t,t,t,t,t,t],[r,t,t,t,t,t,s],[t,t,t,t,t,t,e],[t,t,t,t,t,e,e],[s,t,t,r,e,e,e]],0,[12,12],[0,0])}equals(t){return this.turn===t.turn&&this.sidePieces[0]===t.sidePieces[0]&&this.sidePieces[1]===t.sidePieces[1]&&this.capturedPieces[0]===t.capturedPieces[0]&&this.capturedPieces[1]===t.capturedPieces[1]&&ht.compareTable(this.board,t.board)}getNumberOfPiecesToPlace(t){return this.sidePieces[t.value]}getNumberOfPiecesCaptured(t){return this.capturedPieces[t.value]}setAtUnsafe(t,e){const r=ht.copyBiArray(this.board);return r[t.y][t.x]=e,new Sa(r,this.turn,this.sidePieces,this.capturedPieces)}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==be.UNREACHABLE}}let oc=(()=>{class n{}return n.CAPTURE_MUST_BE_ALIGNED=()=>$localize`You can only capture when 4 or more of your pieces are aligned, and it is not the case.`,n.INVALID_CAPTURED_PIECES=()=>$localize`You must select a valid capture that contains 4 pieces or more.`,n.MISSING_CAPTURES=()=>$localize`There are still possible captures to be done.`,n.PLACEMENT_NOT_ON_BORDER=()=>$localize`Pieces must be inserted in spaces on the edge of the board.`,n.INVALID_PLACEMENT_DIRECTION=()=>$localize`You must select a valid placement direction.`,n.PLACEMENT_WITHOUT_DIRECTION=()=>$localize`You must select a placement with a direction alongside the insertion space.`,n.PLACEMENT_ON_COMPLETE_LINE=()=>$localize`You cannot place a piece on a complete line.`,n.AMBIGUOUS_CAPTURE_COORD=()=>$localize`This piece belongs to two captures. Please select another piece in the capture you'd like to make.`,n.NO_DIRECTIONS_AVAILABLE=()=>$localize`You cannot insert a piece here, as all lines are full. Select another space.`,n})();class Dn extends hr{applyLegalMove(t,e,r){return new Sa(r.board,r.turn+1,r.sidePieces,r.capturedPieces)}static applyCaptures(t,e){let r=e;return t.forEach(s=>{r=Dn.applyCapture(s,r)}),r}static applyCapture(t,e){const r=e.getCurrentPlayer();let s=e;const i=[e.sidePieces[0],e.sidePieces[1]],o=[e.capturedPieces[0],e.capturedPieces[1]];return t.forEach(c=>{const u=e.getPieceAt(c);s=s.setAt(c,be.EMPTY),u.is(r)?i[r.value]+=1:o[r.value]+=1}),new Sa(s.board,e.turn,i,o)}static getPlacements(t){const e=[];return o2.INSTANCE.getAllBorders(t).forEach(r=>{t.getPieceAt(r)===be.EMPTY?e.push(new Ma(r,S.empty())):Dn.getAllDirectionsForEntrance(t,r).forEach(s=>{!1===Dn.isLineComplete(t,r,s)&&e.push(new Ma(r,S.of(s)))})}),e}static isLineComplete(t,e,r){return Dn.nextGapInLine(t,e,r).isAbsent()}static nextGapInLine(t,e,r){for(let s=e;t.isOnBoard(s);s=s.getNext(r))if(t.getPieceAt(s)===be.EMPTY)return S.of(s);return S.empty()}static applyPlacement(t,e){const r=e.getCurrentPlayer();let s=e,i=be.ofPlayer(e.getCurrentPlayer());if(t.direction.isAbsent()){const c=t.coord;if(e.getPieceAt(c)!==be.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");s=s.setAt(c,i)}else for(let c=t.coord;s.isOnBoard(c)&&i!==be.EMPTY;c=c.getNext(t.direction.get())){const u=e.getPieceAt(c);s=s.setAt(c,i),i=u}const o=[e.sidePieces[0],e.sidePieces[1]];return o[r.value]-=1,new Sa(s.board,e.turn,o,e.capturedPieces)}getPiecesMoved(t,e,r){const s=Dn.applyCaptures(e,t);if(r.direction.isAbsent())return[r.coord];{const i=r.direction.get(),o=[];o.push(r.coord);let c=r.coord.getNext(i);for(;s.isOnBoard(c)&&s.getPieceAt(c)!==be.EMPTY;)o.push(c),c=c.getNext(i);return Se(s.isOnBoard(c)&&s.getPieceAt(c)===be.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(c),o}}static getAllDirectionsForEntrance(t,e){if(o2.INSTANCE.isTopLeftCorner(t,e))return[Ie.RIGHT,Ie.DOWN,Ie.UP_RIGHT];if(o2.INSTANCE.isTopCorner(t,e))return[Ie.DOWN,Ie.DOWN_LEFT,Ie.RIGHT];if(o2.INSTANCE.isTopRightCorner(t,e))return[Ie.DOWN_LEFT,Ie.DOWN,Ie.LEFT];if(o2.INSTANCE.isBottomLeftCorner(t,e))return[Ie.UP_RIGHT,Ie.UP,Ie.RIGHT];if(o2.INSTANCE.isBottomCorner(t,e))return[Ie.UP,Ie.LEFT,Ie.UP_RIGHT];if(o2.INSTANCE.isBottomRightCorner(t,e))return[Ie.LEFT,Ie.UP,Ie.DOWN_LEFT];if(o2.INSTANCE.isOnTopLeftBorder(t,e))return[Ie.RIGHT,Ie.DOWN];if(o2.INSTANCE.isOnLeftBorder(t,e))return[Ie.UP_RIGHT,Ie.RIGHT];if(o2.INSTANCE.isOnBottomLeftBorder(t,e))return[Ie.UP,Ie.UP_RIGHT];if(o2.INSTANCE.isOnBottomRightBorder(t,e))return[Ie.LEFT,Ie.UP];if(o2.INSTANCE.isOnRightBorder(t,e))return[Ie.LEFT,Ie.DOWN_LEFT];if(o2.INSTANCE.isOnTopRightBorder(t,e))return[Ie.DOWN_LEFT,Ie.DOWN];throw new Error("not a border")}isLegal(t,e){const r=this.capturesValidity(e,t.initialCaptures);if(r.isFailure())return r.toFailedFallible();const s=Dn.applyCaptures(t.initialCaptures,e),i=this.noMoreCapturesValidity(s);if(i.isFailure())return i.toFailedFallible();const o=this.placementValidity(s,t.placement);if(o.isFailure())return o.toFailedFallible();const c=Dn.applyPlacement(t.placement,s),u=this.capturesValidity(c,t.finalCaptures);if(u.isFailure())return u.toFailedFallible();const h=Dn.applyCaptures(t.finalCaptures,c),g=this.noMoreCapturesValidity(h);return g.isFailure()?g.toFailedFallible():K.success(h)}capturesValidity(t,e){let r=t;for(const s of e){const i=this.captureValidity(r,s);if(i.isFailure())return i;r=Dn.applyCapture(s,r)}return G.SUCCESS}captureValidity(t,e){const r=t.getCurrentPlayer(),s=Dn.getLinePortionWithFourPiecesOfPlayer(t,r,e.getLine());if(s.isAbsent())return G.failure(oc.CAPTURE_MUST_BE_ALIGNED());const i=s.get();return Dn.getCapturable(t,i).equals(e)?G.SUCCESS:G.failure(oc.INVALID_CAPTURED_PIECES())}static getLinePortionsWithFourPiecesOfPlayer(t,e){const r=[];return t.allLines().forEach(s=>{const i=Dn.getLinePortionWithFourPiecesOfPlayer(t,e,s);i.isPresent()&&r.push(i.get())}),r}static getLinePortionWithFourPiecesOfPlayer(t,e,r){let s=0;const i=t.getEntranceOnLine(r),o=r.getDirection();let c=i;for(let u=i;t.isOnBoard(u);u=u.getNext(o))if(t.getPieceAt(u).is(e)?(0===s&&(c=u),s+=1):s=0,4===s)return S.of({0:c,1:u,2:o});return S.empty()}noMoreCapturesValidity(t){const e=t.getCurrentPlayer();return 0===Dn.getLinePortionsWithFourPiecesOfPlayer(t,e).length?G.SUCCESS:G.failure(oc.MISSING_CAPTURES())}placementValidity(t,e){const r=this.placementCoordValidity(t,e.coord);if(r.isFailure())return r;if(t.getPieceAt(e.coord)!==be.EMPTY){if(e.direction.isAbsent())return G.failure(oc.PLACEMENT_WITHOUT_DIRECTION());if(Dn.isLineComplete(t,e.coord,e.direction.get()))return G.failure(oc.PLACEMENT_ON_COMPLETE_LINE());for(const s of Dn.getAllDirectionsForEntrance(t,e.coord))if(s===e.direction.get())return G.SUCCESS;return G.failure(oc.INVALID_PLACEMENT_DIRECTION())}return G.SUCCESS}placementCoordValidity(t,e){return o2.INSTANCE.isOnBorder(t,e)?G.SUCCESS:G.failure(oc.PLACEMENT_NOT_ON_BORDER())}static getCapturable(t,e){const r=[],s=e[0],i=e[1],o=e[2],c=o.getOpposite();let u=s.getNext(c);for(;t.isOnBoard(u)&&t.getPieceAt(u)!==be.EMPTY;)r.push(u),u=u.getNext(c);for(let h=s;!h.equals(i);h=h.getNext(o))r.push(h);for(let h=i;t.isOnBoard(h)&&t.getPieceAt(h)!==be.EMPTY;h=h.getNext(o))r.push(h);return new l2(r)}static getPossibleCaptures(t){const e=t.getCurrentPlayer(),r=[];return Dn.getLinePortionsWithFourPiecesOfPlayer(t,e).forEach(s=>{r.push(Dn.getCapturable(t,s))}),r}static getPlayerScore(t,e){const r=t.getNumberOfPiecesToPlace(e);if(0===r&&0===Dn.getPossibleCaptures(t).length)return S.empty();const s=t.getNumberOfPiecesCaptured(e);return S.of(r+3*s)}static isGameOver(t){const e=Dn.getPlayerScore(t,F.ZERO),r=Dn.getPlayerScore(t,F.ONE);return e.isAbsent()||r.isAbsent()}getGameStatus(t){const e=t.gameState,r=Dn.getPlayerScore(e,F.ZERO),s=Dn.getPlayerScore(e,F.ONE);return r.isAbsent()?ze.ONE_WON:s.isAbsent()?ze.ZERO_WON:ze.ONGOING}}class tm extends rr{static getPossibleCaptureCombinationsFromPossibleCaptures(t){const e=tm.computeIntersections(t);let r=[[]];return t.forEach((s,i)=>{if(0===e[i].length)r.forEach(o=>{o.push(i)});else{const o=[],c=e[i].some(u=>u>i);for(const u of r)!0===u.some(g=>e[i].some(m=>g===m))?o.push(ht.copyImmutableArray(u)):c?(o.push(ht.copyImmutableArray(u)),u.push(i),o.push(ht.copyImmutableArray(u))):(u.push(i),o.push(ht.copyImmutableArray(u)));r=o}}),r.map(s=>s.map(i=>t[i]))}static computeIntersections(t){const e=[];return t.forEach((r,s)=>{e.push([]),t.forEach((i,o)=>{s!==o&&r.intersectsWith(i)&&e[s].push(o)})}),e}getBoardValue(t){const e=t.gameState,r=Dn.getPlayerScore(e,F.ZERO),s=Dn.getPlayerScore(e,F.ONE);return r.isAbsent()?new dt(F.ONE.getVictoryValue()):s.isAbsent()?new dt(F.ZERO.getVictoryValue()):new dt(r.get()-s.get())}getListMoves(t){return this.getListMoveFromState(t.gameState)}getListMoveFromState(t){const e=[];return Dn.isGameOver(t)||this.getPossibleCaptureCombinations(t).forEach(r=>{const s=Dn.applyCaptures(r,t);Dn.getPlacements(s).forEach(i=>{const o=Dn.applyPlacement(i,s);this.getPossibleCaptureCombinations(o).forEach(c=>{const u=new Uo(i,r,c);e.push(u)})})}),e}getPossibleCaptureCombinations(t){const e=Dn.getPossibleCaptures(t);return tm.getPossibleCaptureCombinationsFromPossibleCaptures(e)}}class Kae{constructor(t,e,r,s,i,o){this.source=t,this.destination=e,this.x1=r,this.y1=s,this.x2=i,this.y2=o}}const Jn=be.UNREACHABLE,at=be.EMPTY,br=be.ZERO,s4=be.ONE;class Xae extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Goal of the game`,$localize`The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.
        This is the initial board.
        Each player has 12 pieces on the side and 3 pieces on the board.
        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.
        The first player plays with the dark pieces, the second player plays with the light pieces.`,Sa.getInitialState()),pe.anyMove($localize`Pushing`,$localize`Pieces can only enter the board through the edges. To insert a new piece:
        <ol>
            <li>Click on a space on the edge of the board.</li>
            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>
        </ol>
        You cannot push when a line is full.<br/><br/>
        You're playing Dark, insert a piece.`,Sa.getInitialState(),new Uo(new Ma(new P(3,0),S.of(Ie.DOWN)),[],[]),$localize`Congratulations!`),pe.fromMove($localize`Capture (1/3)`,$localize`To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.
        There are multiple important aspects of a capture:
        <ol>
            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>
            <li>As soon as there is an empty space on the line, the capture stops.</li>
            <li>Your own pieces that are captured go back to your stock.
                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>
            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.
                This means that a turn happens in three phases:
                <ol type="A">
                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>
                    <li>Make your insertion.</li>
                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>
                </ol>
            </li>
        </ol><br/>
        You're playing Dark, you can make a capture, do it.`,new Sa([[Jn,Jn,Jn,br,s4,at,at],[Jn,Jn,at,at,at,at,at],[Jn,at,at,at,at,at,at],[br,br,br,at,at,at,at],[s4,at,at,at,at,at,Jn],[at,at,at,s4,at,Jn,Jn],[at,at,at,s4,Jn,Jn,Jn]],42,[8,8],[0,0]),[new Uo(new Ma(new P(0,3),S.of(Ie.RIGHT)),[],[new l2([new P(0,3),new P(1,3),new P(2,3),new P(3,3)])])],$localize`Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.
        Let's now see how captures can really be useful.`,$localize`Failed!`),pe.fromMove($localize`Capture (2/3)`,$localize`Here, there are three different ways of capturing.
        <ol>
          <li>One way does not capture any of your opponent's pieces.</li>
          <li>Another way captures one of your opponent's pieces.</li>
          <li>The last way captures two of your opponent's pieces.</li>
        </ol>
        <br/><br/>
        Pick the last one.`,new Sa([[Jn,Jn,Jn,at,at,at,at],[Jn,Jn,at,s4,at,at,at],[Jn,at,at,br,at,at,at],[br,br,br,s4,at,at,at],[at,at,at,br,at,at,Jn],[at,at,at,br,at,Jn,Jn],[at,at,at,s4,Jn,Jn,Jn]],42,[8,4],[2,3]),[new Uo(new Ma(new P(0,3),S.of(Ie.RIGHT)),[],[new l2([new P(3,1),new P(3,2),new P(3,3),new P(3,4),new P(3,5),new P(3,6)])])],$localize`Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.
        The most you can get is 3 per capture.`,$localize`Failed, the best capture was taking 2 of your opponent's pieces`),pe.fromMove($localize`Capture (3/3)`,$localize`Here, you must capture at the beginning of your turn.
        This is due to a move of your opponent at the previous turn
        (even though this is a fictitious board for pedagogical purpose).
        After your capture, by performing the right move you can even capture two more of your opponent's pieces!
        Keep it mind that the most useful in a capture is to take your opponent's pieces.`,new Sa([[Jn,Jn,Jn,br,at,at,br],[Jn,Jn,at,br,at,at,br],[Jn,br,br,at,br,s4,br],[at,at,at,br,at,at,br],[at,at,at,br,at,at,Jn],[br,br,br,s4,s4,Jn,Jn],[at,at,at,br,Jn,Jn,Jn]],42,[3,4],[2,3]),[new Uo(new Ma(new P(3,6),S.of(Ie.UP)),[new l2([new P(6,0),new P(6,1),new P(6,2),new P(6,3)])],[new l2([new P(0,5),new P(1,5),new P(2,5),new P(3,5),new P(4,5)]),new l2([new P(1,2),new P(2,2),new P(3,2),new P(4,2),new P(5,2)])]),new Uo(new Ma(new P(4,6),S.of(Ie.UP)),[new l2([new P(6,0),new P(6,1),new P(6,2),new P(6,3)])],[new l2([new P(0,5),new P(1,5),new P(2,5),new P(3,5),new P(4,5)]),new l2([new P(3,0),new P(3,1),new P(3,2),new P(3,3),new P(3,4)])]),new Uo(new Ma(new P(3,6),S.of(Ie.UP)),[new l2([new P(6,0),new P(6,1),new P(6,2),new P(6,3)])],[new l2([new P(1,2),new P(2,2),new P(3,2),new P(4,2),new P(5,2)]),new l2([new P(0,5),new P(1,5),new P(2,5),new P(3,5),new P(4,5)])])],$localize`Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces.`,$localize`Failed, the best capture takes 2 of your opponent's pieces.`)]}}function b4t(n,t){if(1&n&&(B(),X(0,"circle",13)),2&n){const e=E().$implicit,r=E();w("ngClass",r.getPieceClass(e)),V("cx",r.getCenterAt(e).x)("cy",r.getCenterAt(e).y)("r",r.SPACE_SIZE)}}function N4t(n,t){if(1&n){const e=we();B(),N(0,"g",10),se("click",function(){const i=he(e).$implicit;return ce(E().onClick(i))}),X(1,"polygon",11),k(2,b4t,1,4,"circle",12),A()}if(2&n){const e=t.$implicit,r=E();je("id","click_",e.x,"_",e.y,""),M(1),je("id","space_",e.x,"_",e.y,""),w("ngClass",r.getSpaceClass(e)),V("points",r.getHexaCoordsAt(e)),M(1),w("ngIf",r.isPiece(e))}}function A4t(n,t){if(1&n){const e=we();B(),N(0,"polygon",16),se("click",function(){const i=he(e).$implicit;return ce(E(2).onClick(i))}),A()}if(2&n){const e=t.$implicit;V("points",E(2).getHexaCoordsAt(e))}}function O4t(n,t){if(1&n&&(B(),N(0,"g",14),k(1,A4t,1,1,"polygon",15),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e.capturedSpaces)}}function I4t(n,t){if(1&n){const e=we();B(),N(0,"line",17),se("click",function(){const i=he(e).$implicit;return ce(E().onClick(i.destination))}),A()}if(2&n){const e=t.$implicit;V("x1",e.x1)("y1",e.y1)("x2",e.x2)("y2",e.y2)}}function x4t(n,t){if(1&n&&(B(),N(0,"g"),X(1,"circle",18),A()),2&n){const e=t.$implicit,r=E().$implicit,s=E();M(1),je("id","piece_",r.value,"_",e,""),w("ngClass",s.getPlayerClass(r)),V("cx",s.getRemainingPieceCx(r,e))("cy",s.getRemainingPieceCy(r))("r",.5*s.SPACE_SIZE)}}function L4t(n,t){if(1&n&&(B(),N(0,"g"),k(1,x4t,2,6,"g",8),A()),2&n){const e=t.$implicit,r=E();M(1),w("ngForOf",r.getPlayerSidePieces(e))}}function k4t(n,t){if(1&n&&(B(),X(0,"line",19)),2&n){const e=E();V("x1",e.inserted.get().x1)("y1",e.inserted.get().y1)("x2",e.inserted.get().x2)("y2",e.inserted.get().y2)}}let R4t=(()=>{class n extends Zg{constructor(e){super(e),this.inserted=S.empty(),this.arrows=[],this.captured=[],this.moved=[],this.HEXAGON_WIDTH=this.SPACE_SIZE,this.SHARED_HEXAGON_X=Math.cos(30)*this.HEXAGON_WIDTH*.5,this.BOARD_WIDTH=this.HEXAGON_WIDTH+6*(this.HEXAGON_WIDTH-this.SHARED_HEXAGON_X)+3*this.STROKE_WIDTH/2,this.BOARD_HEIGHT=7*this.HEXAGON_WIDTH+4.5*this.STROKE_WIDTH,this.movePhase=n.PHASE_PLACEMENT_COORD,this.possibleCaptures=[],this.initialCaptures=[],this.placement=S.empty(),this.placementEntrance=S.empty(),this.finalCaptures=[],this.hasAsymetricBoard=!0,this.scores=S.of([0,0]),this.rules=new Dn(Sa),this.availableMinimaxes=[new tm(this.rules,"GipfMinimax")],this.encoder=Uo.encoder,this.tutorial=(new Xae).tutorial,this.SPACE_SIZE=40,this.constructedState=this.getState(),this.hexaLayout=new Yg(1.5*this.SPACE_SIZE,new P(this.HEXAGON_WIDTH/2+3*this.STROKE_WIDTH/4,-this.HEXAGON_WIDTH),o2.INSTANCE)}updateBoard(){this.showLastMove(),this.cancelMoveAttempt()}showLastMove(){this.inserted=S.empty();const e=this.rules.node.move;if(e.isPresent()&&e.get().placement.direction.isPresent()){const r=e.get().placement;this.inserted=S.of(this.arrowTowards(r.coord,r.direction.get()))}this.cancelMoveAttempt()}arrowTowards(e,r){const s=e.getNext(r.getOpposite()),i=this.getCenterAt(e),o=this.getCenterAt(s);return new Kae(s,e,o.x,o.y,i.x,i.y)}markCapture(e){e.forEach(r=>{this.captured.push(r)})}getAllCoords(){return this.constructedState.allCoords()}getPlayerSidePieces(e){const r=this.constructedState.getNumberOfPiecesToPlace(e),s=[];for(let i=0;i<r;i+=1)s.push(i);return s}isPiece(e){return this.getPiece(e)!==be.EMPTY}getPiece(e){return this.constructedState.getPieceAt(e)}onClick(e){var r=this;return O(function*(){const s=r.canUserPlay("#click_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());switch(r.movePhase){case n.PHASE_INITIAL_CAPTURE:case n.PHASE_FINAL_CAPTURE:return r.selectCapture(e);case n.PHASE_PLACEMENT_COORD:return r.selectPlacementCoord(e);default:return Ae.expectToBe(r.movePhase,n.PHASE_PLACEMENT_DIRECTION),r.selectPlacementDirectionOrPlacementCoord(e)}})()}selectCapture(e){var r=this;return O(function*(){const s=[];if(r.possibleCaptures.forEach(o=>{o.contains(e)&&s.push(o)}),s.length>1)return r.cancelMove(oc.AMBIGUOUS_CAPTURE_COORD());if(0===s.length)return r.cancelMove(oc.MISSING_CAPTURES());const i=s[0];return r.constructedState=Dn.applyCapture(i,r.constructedState),r.markCapture(i),r.possibleCaptures=Dn.getPossibleCaptures(r.constructedState),r.movePhase===n.PHASE_INITIAL_CAPTURE?(r.initialCaptures.push(i),0===r.possibleCaptures.length?r.moveToPlacementPhase():G.SUCCESS):(Ae.expectToBe(r.movePhase,n.PHASE_FINAL_CAPTURE),r.finalCaptures.push(i),0===r.possibleCaptures.length?r.tryMove(r.initialCaptures,r.placement.get(),r.finalCaptures):G.SUCCESS)})()}moveToPlacementPhase(){return this.movePhase=n.PHASE_PLACEMENT_COORD,G.SUCCESS}moveToInitialCaptureOrPlacementPhase(){return this.possibleCaptures=Dn.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?n.PHASE_PLACEMENT_COORD:n.PHASE_INITIAL_CAPTURE,G.SUCCESS}moveToFinalCapturePhaseOrTryMove(){var e=this;return O(function*(){return e.possibleCaptures=Dn.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove(e.initialCaptures,e.placement.get(),e.finalCaptures):(e.movePhase=n.PHASE_FINAL_CAPTURE,G.SUCCESS)})()}computeArrows(e){this.arrows=[];for(const r of Dn.getAllDirectionsForEntrance(this.constructedState,e))if(!1===Dn.isLineComplete(this.constructedState,e,r)){const s=e.getNext(r),i=this.getCenterAt(e),o=this.getCenterAt(s);this.arrows.push(new Kae(e,s,i.x,i.y,o.x,o.y))}}selectPlacementCoord(e){var r=this;return O(function*(){const s=r.rules.placementCoordValidity(r.constructedState,e);return s.isFailure()?r.cancelMove(s.getReason()):r.placementEntrance.equalsValue(e)?(r.cancelMoveAttempt(),G.SUCCESS):(r.placementEntrance=S.of(e),r.constructedState.getPieceAt(e)===be.EMPTY?r.selectPlacementDirection(S.empty()):(r.movePhase=n.PHASE_PLACEMENT_DIRECTION,r.computeArrows(e),0===r.arrows.length&&r.cancelMove(oc.NO_DIRECTIONS_AVAILABLE()),G.SUCCESS))})()}selectPlacementDirection(e){var r=this;return O(function*(){r.placement=S.of(new Ma(r.placementEntrance.get(),e));const s=r.rules.placementValidity(r.constructedState,r.placement.get());return s.isFailure()?r.cancelMove(s.getReason()):(r.arrows=[],r.constructedState=Dn.applyPlacement(r.placement.get(),r.constructedState),r.moveToFinalCapturePhaseOrTryMove())})()}selectPlacementDirectionOrPlacementCoord(e){var r=this;return O(function*(){const s=r.placementEntrance.get();if(!1===s.isAlignedWith(e)||1!==s.getDistance(e))return r.selectPlacementCoord(e);const i=Ie.factory.fromMove(s,e);return r.selectPlacementDirection(i.toOptional())})()}tryMove(e,r,s){var i=this;return O(function*(){const o=new Uo(r,e,s);return yield i.chooseMove(o,i.getState(),i.scores.get())})()}cancelMoveAttempt(){this.constructedState=this.getState(),this.captured=[],this.moved=[];const e=this.rules.node.move;if(e.isPresent()){const r=e.get(),s=this.rules.node.mother.get().gameState;r.initialCaptures.forEach(i=>this.markCapture(i)),r.finalCaptures.forEach(i=>this.markCapture(i)),this.moved=this.rules.getPiecesMoved(s,r.initialCaptures,r.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=S.empty(),this.placement=S.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}getSpaceClass(e){return this.captured.some(r=>r.equals(e))?"captured-fill":this.moved.some(r=>r.equals(e))?"moved-fill":""}getPieceClass(e){const r=this.getPiece(e);return this.getPlayerClass(F.of(r.value))}getRemainingPieceCy(e){return e===F.ONE?25:this.BOARD_HEIGHT-25}getRemainingPieceCx(e,r){const s=20+r*this.SPACE_SIZE*.5;return e===F.ONE?s:this.BOARD_WIDTH-(15+s)}}return n.PHASE_INITIAL_CAPTURE=0,n.PHASE_PLACEMENT_COORD=1,n.PHASE_PLACEMENT_DIRECTION=2,n.PHASE_FINAL_CAPTURE=3,n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-gipf"]],features:[l],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved-fill","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],["class","arrow","marker-end","url(#arrowhead)",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,r){1&e&&(B(),N(0,"svg",0)(1,"defs")(2,"marker",1),X(3,"polygon",2),A(),N(4,"marker",3),X(5,"polygon",4),A()(),k(6,N4t,3,7,"g",5),k(7,O4t,2,1,"g",6),k(8,I4t,1,4,"line",7),k(9,L4t,2,1,"g",8),k(10,k4t,1,4,"line",9),A()),2&e&&(V("viewBox",-r.STROKE_WIDTH+" 0 "+r.BOARD_WIDTH+" "+r.BOARD_HEIGHT)("transform",r.rotation),M(6),w("ngForOf",r.getAllCoords()),M(1),w("ngForOf",r.possibleCaptures),M(1),w("ngForOf",r.arrows),M(1),w("ngForOf",r.Player.PLAYERS),M(1),w("ngIf",r.inserted.isPresent()))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class U1 extends Yc{equals(t){return this===t||this.coord.equals(t.coord)}toString(){return this===U1.PASS?"GoMove.PASS":this===U1.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}U1.PASS=new U1(-1,0),U1.ACCEPT=new U1(-2,0),U1.PASS_NUMBER=-1,U1.ACCEPT_NUMBER=-2,U1.encoder=new class extends on{maxValue(){return 360}encodeNumber(n){return 19*n.coord.y+n.coord.x}decodeNumber(n){if(n===U1.PASS_NUMBER)return U1.PASS;const t=n%19;return new U1(t,(n-t)/19)}};class Fe{constructor(t,e){this.player=t,this.type=e}equals(t){return t===this}toString(){switch(this){case Fe.DARK:return"GoPiece.DARK";case Fe.LIGHT:return"GoPiece.LIGHT";case Fe.EMPTY:return"GoPiece.EMPTY";case Fe.DEAD_DARK:return"GoPiece.DEAD_DARK";case Fe.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case Fe.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return Se(this===Fe.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}static pieceBelongTo(t,e){return e===t.player&&"territory"!==t.type}static ofPlayer(t){return t===F.ZERO?Fe.DARK:Fe.LIGHT}isOccupied(){return[Fe.DARK,Fe.LIGHT,Fe.DEAD_DARK,Fe.DEAD_LIGHT].includes(this)}isEmpty(){return[Fe.DARK_TERRITORY,Fe.LIGHT_TERRITORY,Fe.EMPTY].includes(this)}isDead(){return[Fe.DEAD_DARK,Fe.DEAD_LIGHT].includes(this)}isTerritory(){return[Fe.DARK_TERRITORY,Fe.LIGHT_TERRITORY].includes(this)}getOwner(){return this.player}nonTerritory(){return Se(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),Fe.EMPTY}}Fe.DARK=new Fe(F.ZERO,"alive"),Fe.LIGHT=new Fe(F.ONE,"alive"),Fe.EMPTY=new Fe(fe.NONE,"empty"),Fe.DEAD_DARK=new Fe(F.ZERO,"dead"),Fe.DEAD_LIGHT=new Fe(F.ONE,"dead"),Fe.DARK_TERRITORY=new Fe(fe.NONE,"territory"),Fe.LIGHT_TERRITORY=new Fe(fe.NONE,"territory");var xn=(()=>(function(n){n.PLAYING="PLAYING",n.PASSED="PASSED",n.COUNTING="COUNTING",n.ACCEPT="ACCEPT",n.FINISHED="FINISHED"}(xn||(xn={})),xn))();let Ss=(()=>{class n extends Vs{constructor(e,r,s,i,o){super(e,s),this.captured=r,this.koCoord=i,this.phase=o}static getInitialState(){const e=n.getStartingBoard();return new n(e,[0,0],0,S.empty(),xn.PLAYING)}getCapturedCopy(){return[this.captured[0],this.captured[1]]}static getStartingBoard(){return ht.createTable(n.WIDTH,n.HEIGHT,Fe.EMPTY)}copy(){return new n(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}isDead(e){return this.getPieceAt(e).isDead()}isTerritory(e){return this.getPieceAt(e).isTerritory()}}return n.WIDTH=13,n.HEIGHT=13,n})(),S0=(()=>{class n{constructor(e){this.color=e}selfContains(e){return this.getCoords().some(s=>s.equals(e))}static insertAsEntryPoint(e,r){return 0===e.length?[r]:r.compareTo(e[0])<0?[r].concat(e):e.concat([r])}}return n.VERBOSE=!1,n})();class V4t extends S0{constructor(t,e,r,s,i,o){super(t),this.emptyCoords=e,this.darkCoords=r,this.lightCoords=s,this.deadDarkCoords=i,this.deadLightCoords=o}getCoords(){return this.color===Fe.DARK?this.darkCoords:this.color===Fe.LIGHT?this.lightCoords:this.color===Fe.DEAD_DARK?this.deadDarkCoords:this.color===Fe.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}contains(t){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(r=>r.equals(t))}addPawn(t,e){switch(Se(!1===this.contains(t),"This group already contains "+t.toString()),e){case Fe.DARK:this.darkCoords=S0.insertAsEntryPoint(this.darkCoords,t);break;case Fe.LIGHT:this.lightCoords=S0.insertAsEntryPoint(this.lightCoords,t);break;case Fe.DEAD_DARK:this.deadDarkCoords=S0.insertAsEntryPoint(this.deadDarkCoords,t);break;case Fe.DEAD_LIGHT:this.deadLightCoords=S0.insertAsEntryPoint(this.deadLightCoords,t);break;default:Ae.expectToBeMultiple(e,[Fe.EMPTY,Fe.DARK_TERRITORY,Fe.LIGHT_TERRITORY]),this.emptyCoords=S0.insertAsEntryPoint(this.emptyCoords,t)}}isMonoWrapped(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}getWrapper(){const t=new Qn;t.set(Fe.EMPTY,this.emptyCoords.length),t.set(Fe.DARK,this.darkCoords.length+this.deadLightCoords.length),t.set(Fe.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),t.put(this.color.nonTerritory(),0);const e=t.filter((r,s)=>s>0);if(1===e.size())return e.getByIndex(0).key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}getNeighborsEntryPoints(){const t=[];return this.color!==Fe.EMPTY&&this.emptyCoords.length>0&&t.push(this.emptyCoords[0]),this.color!==Fe.DARK&&this.darkCoords.length>0&&t.push(this.darkCoords[0]),this.color!==Fe.LIGHT&&this.lightCoords.length>0&&t.push(this.lightCoords[0]),this.color!==Fe.DEAD_DARK&&this.deadDarkCoords.length>0&&t.push(this.deadDarkCoords[0]),this.color!==Fe.DEAD_LIGHT&&this.deadLightCoords.length>0&&t.push(this.deadLightCoords[0]),t}}class nm extends class z4t{getGroupDatas(t,e){Y(S0.VERBOSE,"GroupDatas.getGroupDatas("+t+", "+e+")");const s=this.getNewInstance(e[t.y][t.x]);return this._getGroupDatas(t,e,s)}_getGroupDatas(t,e,r){Y(S0.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:r,coord:t}});const s=e[t.y][t.x];if(r.addPawn(t,s),s===r.color)for(const i of this.getDirections()){const o=t.getNext(i);o.isInRange(e[0].length,e.length)&&(r.contains(o)||(r=this._getGroupDatas(o,e,r)))}return r}}{getNewInstance(t){return new V4t(t,[],[],[],[],[])}getDirections(){return De.ORTHOGONALS}}let rm=(()=>{class n{}return n.ILLEGAL_KO=()=>$localize`This move is a ko, you must play somewhere else before you can play in this intersection again.`,n.CANNOT_PASS_AFTER_PASSED_PHASE=()=>$localize`We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn.`,n.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=()=>$localize`You cannot accept before the counting phase.`,n.OCCUPIED_INTERSECTION=()=>$localize`This intersection is already occupied.`,n.CANNOT_COMMIT_SUICIDE=()=>$localize`You cannot commit suicide.`,n})(),r3=(()=>{class n extends hr{static isLegal(e,r){if(Y(n.VERBOSE||!1,{isLegal:{move:e,state:r}}),n.isPass(e)){const i=r.phase===xn.PLAYING,o=r.phase===xn.PASSED;return Y(n.VERBOSE||!1,"GoRules.isLegal at "+r.phase+(i||o?" forbid":" allowed")+" passing on "+r.getCopiedBoard()),i||o?K.success([]):K.failure(rm.CANNOT_PASS_AFTER_PASSED_PHASE())}if(n.isAccept(e)){const o=r.phase===xn.ACCEPT;return r.phase===xn.COUNTING||o?K.success([]):K.failure(rm.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return n.isOccupied(e.coord,r.getCopiedBoard())?(Y(n.VERBOSE||!1,"GoRules.isLegal: move is marking"),n.isLegalDeadMarking(e,r)?K.success([]):K.failure(rm.OCCUPIED_INTERSECTION())):(Y(n.VERBOSE||!1,"GoRules.isLegal: move is normal stuff: "+e.toString()),n.isLegalNormalMove(e,r))}static getNewKo(e,r,s){if(1===s.length){const i=s[0],o=e.coord,c=r[o.y][o.x],h=(new nm).getGroupDatas(o,r),g=h.emptyCoords,m=Fe.pieceBelongTo(c,F.ZERO)?h.darkCoords:h.lightCoords;if(1===g.length&&g[0].equals(i)&&1===m.length)return S.of(i)}return S.empty()}static markTerritoryAndCount(e){Y(n.VERBOSE,{markTerritoryAndCount:{state:e}});const r=e.getCopiedBoard(),s=n.getTerritoryLikeGroup(e),i=e.getCapturedCopy();for(const o of s){const c=o.getWrapper();if(c===Fe.LIGHT){i[1]+=o.emptyCoords.length;for(const u of o.getCoords())r[u.y][u.x]=Fe.LIGHT_TERRITORY}else{Se(c===Fe.DARK,"territory should be wrapped by dark or light, not by "+c.toString()),i[0]+=o.emptyCoords.length;for(const u of o.getCoords())r[u.y][u.x]=Fe.DARK_TERRITORY}}return new Ss(r,i,e.turn,e.koCoord,e.phase)}static removeAndSubstractTerritory(e){const r=e.getCopiedBoard(),s=e.getCapturedCopy();let i;for(let o=0;o<e.board.length;o++)for(let c=0;c<e.board[0].length;c++)i=r[o][c],i===Fe.DARK_TERRITORY?(r[o][c]=Fe.EMPTY,s[0]=s[0]-1):i===Fe.LIGHT_TERRITORY&&(r[o][c]=Fe.EMPTY,s[1]=s[1]-1);return new Ss(r,s,e.turn,e.koCoord,e.phase)}static getEmptyZones(e){return n.getGroupsDatasWhere(e.getCopiedBoard(),r=>r.isEmpty())}static getGroupsDatasWhere(e,r){const s=[];let i,o,c;const u=new nm;for(let h=0;h<e.length;h++)for(let g=0;g<e[0].length;g++)i=new P(g,h),c=e[h][g],r(c)&&(s.some(m=>m.selfContains(i))||(o=u.getGroupDatas(i,e),s.push(o)));return s}static addDeadToScore(e){const r=e.getCapturedCopy();let o,s=r[1],i=r[0];for(let c=0;c<e.board.length;c++)for(let u=0;u<e.board[0].length;u++)o=e.getPieceAtXY(u,c),o===Fe.DEAD_DARK?s++:o===Fe.DEAD_LIGHT&&i++;return[i,s]}static switchAliveness(e,r){const s=r.getCopiedBoard();Se(!1===s[e.y][e.x].isEmpty(),"Can't switch emptyness aliveness");const c=(new nm).getGroupDatas(e,s),u=r.getCapturedCopy();switch(c.color){case Fe.DEAD_DARK:u[1]-=2*c.deadDarkCoords.length;for(const h of c.deadDarkCoords)s[h.y][h.x]=Fe.DARK;break;case Fe.DEAD_LIGHT:u[0]-=2*c.deadLightCoords.length;for(const h of c.deadLightCoords)s[h.y][h.x]=Fe.LIGHT;break;case Fe.LIGHT:u[0]+=2*c.lightCoords.length;for(const h of c.lightCoords)s[h.y][h.x]=Fe.DEAD_LIGHT;break;default:Ae.expectToBe(c.color,Fe.DARK),u[1]+=2*c.darkCoords.length;for(const h of c.darkCoords)s[h.y][h.x]=Fe.DEAD_DARK}return new Ss(s,u,r.turn,r.koCoord,r.phase)}static getGameStatus(e){const r=e.gameState;return r.phase===xn.FINISHED?r.captured[0]>r.captured[1]?ze.ZERO_WON:r.captured[1]>r.captured[0]?ze.ONE_WON:ze.DRAW:ze.ONGOING}static isPass(e){return e.equals(U1.PASS)}static isAccept(e){return e.equals(U1.ACCEPT)}static isLegalDeadMarking(e,r){return n.isOccupied(e.coord,r.getCopiedBoard())&&(r.phase===xn.COUNTING||r.phase===xn.ACCEPT)}static isLegalNormalMove(e,r){const s=r.getCopiedBoard();if(n.isKo(e,r))return K.failure(rm.ILLEGAL_KO());[xn.COUNTING,xn.ACCEPT].includes(r.phase)&&(r=n.resurrectStones(r));const i=n.getCaptureState(e,r);if(Jae.isCapturing(i))return K.success(i.capturedCoords);{s[e.coord.y][e.coord.x]=r.turn%2==0?Fe.DARK:Fe.LIGHT;const u=0===(new nm).getGroupDatas(e.coord,s).emptyCoords.length;return s[e.coord.y][e.coord.x]=Fe.EMPTY,u?K.failure(rm.CANNOT_COMMIT_SUICIDE()):K.success([])}}static isOccupied(e,r){return r[e.y][e.x].isOccupied()}static isKo(e,r){return!!r.koCoord.isPresent()&&e.coord.equals(r.koCoord.get())}static getCaptureState(e,r){Y(n.VERBOSE||!1,{getCaptureState:{move:e,state:r}});const i=new Jae;let o;for(const c of De.ORTHOGONALS)o=n.getCapturedInDirection(e.coord,c,r),o.length>0&&i.capturedCoords.every(u=>!o[0].equals(u))&&(i.capturedCoords=i.capturedCoords.concat(o));return i}static getCapturedInDirection(e,r,s){const o=s.getCopiedBoard(),c=e.getNext(r);if(c.isInRange(s.board[0].length,s.board.length)&&o[c.y][c.x]===(s.turn%2==0?Fe.LIGHT:Fe.DARK)){Y(n.VERBOSE||!1,"a group could be captured");const g=(new nm).getGroupDatas(c,o);if(n.isCapturableGroup(g,s.koCoord))return Y(n.VERBOSE||!1,{neightbooringGroupCoord:g.getCoords(),message:"is capturable"}),g.getCoords()}return[]}static isCapturableGroup(e,r){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===r.equalsValue(e.emptyCoords[0])}static getTerritoryLikeGroup(e){return n.getEmptyZones(e).filter(s=>s.isMonoWrapped())}static applyPass(e){const r=e.getCopiedBoard(),s=e.getCapturedCopy(),i=e.turn;let o,c;return e.phase===xn.PASSED?(o=xn.COUNTING,c=new Ss(r,s,i+1,S.empty(),o),c=n.markTerritoryAndCount(c)):(Se(e.phase===xn.PLAYING,"Cannot pass in counting phase!"),o=xn.PASSED,c=new Ss(r,s,i+1,S.empty(),o)),c}static applyLegalAccept(e){const r=e.getCopiedBoard();let s;return s=e.phase===xn.COUNTING?xn.ACCEPT:xn.FINISHED,new Ss(r,e.getCapturedCopy(),e.turn+1,S.empty(),s)}static applyNormalLegalMove(e,r,s){let i;Y(n.VERBOSE,{applyNormalLegal:{currentState:r,legalMove:e,status}}),i=[xn.COUNTING,xn.ACCEPT].includes(r.phase)?n.resurrectStones(r):r.copy();const o=e.coord.x,c=e.coord.y,u=i.getCopiedBoard(),h=i.turn,g=Fe.ofPlayer(i.getCurrentPlayer()),m=h+1;u[c][o]=g;for(const I of s)u[I.y][I.x]=Fe.EMPTY;const v=n.getNewKo(e,u,s),T=i.getCapturedCopy();return T[g.player.value]+=s.length,new Ss(u,T,m,v,xn.PLAYING)}static resurrectStones(e){for(let r=0;r<e.board.length;r++)for(let s=0;s<e.board[0].length;s++)e.getPieceAtXY(s,r).isDead()&&(e=n.switchAliveness(new P(s,r),e));return n.removeAndSubstractTerritory(e)}static applyDeadMarkingMove(e,r){Y(n.VERBOSE,{applyDeadMarkingMove:{legalMove:e,state:r}});const s=n.removeAndSubstractTerritory(r),i=n.switchAliveness(e.coord,s),o=new Ss(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,S.empty(),xn.COUNTING);return n.markTerritoryAndCount(o)}isLegal(e,r){return n.isLegal(e,r)}applyLegalMove(e,r,s){return Y(n.VERBOSE,{applyLegalMove:{legalMove:e,state:r,status:s}}),n.isPass(e)?(Y(n.VERBOSE,"GoRules.applyLegalMove: isPass"),n.applyPass(r)):n.isAccept(e)?(Y(n.VERBOSE,"GoRules.applyLegalMove: isAccept"),n.applyLegalAccept(r)):n.isLegalDeadMarking(e,r)?(Y(n.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),n.applyDeadMarkingMove(e,r)):(Y(n.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),n.applyNormalLegalMove(e,r,s))}getGameStatus(e){return n.getGameStatus(e)}}return n.VERBOSE=!1,n})();class Jae{constructor(){this.capturedCoords=[]}static isCapturing(t){return t.capturedCoords.length>0}}class H4t extends rr{getListMoves(t){Y(r3.VERBOSE||!1,"GoRules.getListMoves");const r=t.gameState,s=this.getPlayingMovesList(r);if(r.phase===xn.PLAYING||r.phase===xn.PASSED)return s.push(U1.PASS),s;{Y(r3.VERBOSE||!1,"GoRules.getListMoves in counting phase");const i=this.getCountingMovesList(r);return 0===i.length?[U1.ACCEPT]:i}}getPlayingMovesList(t){const e=[];let r;for(let s=0;s<t.board.length;s++)for(let i=0;i<t.board[0].length;i++)r=new U1(i,s),t.getPieceAt(r.coord)===Fe.EMPTY&&r3.isLegal(r,t).isSuccess()&&e.push(r);return e}getCountingMovesList(t){const e=[],r=this.getCorrectBoard(t).getCopiedBoard(),s=r3.getGroupsDatasWhere(r,i=>i!==Fe.EMPTY);for(const i of s){const o=i.getCoords()[0],c=r[o.y][o.x];if(t.getPieceAt(o)!==c){const h=new U1(o.x,o.y);return e.push(h),e}}return e}getCorrectBoard(t){const r=this.mapBoard(t.getCopiedBoard(),o=>o===Fe.DARK?Fe.DEAD_DARK:o===Fe.LIGHT?Fe.DEAD_LIGHT:o.isTerritory()?Fe.EMPTY:o),s=new Ss(r,t.getCapturedCopy(),t.turn,t.koCoord,t.phase),i=r3.getTerritoryLikeGroup(s);return this.setAliveUniqueWrapper(s,i)}mapBoard(t,e){for(let r=0;r<t.length;r++)for(let s=0;s<t[0].length;s++)t[r][s]=e(t[r][s]);return t}setAliveUniqueWrapper(t,e){let s,r=t.copy();for(const i of e){s=i.deadDarkCoords.concat(i.deadLightCoords);for(const o of s)r.isDead(o)&&(r=r3.switchAliveness(o,r))}return r}getBoardValue(t){const e=t.gameState,r=r3.getGameStatus(t);if(r.isEndGame)return new dt(r.toBoardValue());Y(r3.VERBOSE||!1,"GoRules.getBoardValue");const i=r3.markTerritoryAndCount(e),o=i.getCapturedCopy(),c=this.getDeadStones(i);return new dt(o[1]+2*c[0]-(o[0]+2*c[1]))}getDeadStones(t){const e=[0,0];for(let r=0;r<t.board.length;r++)for(let s=0;s<t.board[0].length;s++){const i=t.getPieceAtXY(s,r);"dead"===i.type&&(e[i.player.value]=e[i.player.value]+1)}return e}}const nt=Fe.LIGHT,Ye=Fe.DARK,bV=Fe.DEAD_LIGHT,Bf=Fe.LIGHT_TERRITORY,ac=Fe.DARK_TERRITORY,ge=Fe.EMPTY;class ece extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Preliminary information`,$localize`The game of Go is played on a board called a Goban, and the stones are placed on the intersections.
        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.
        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).
        For this tutorial, we will use a smaller board for pedagogical purposes.`,Ss.getInitialState()),pe.informational($localize`Goal of the game`,$localize`The goal of the game is to have the most points at the end of the game.
        We call "territories" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.
        Here, Dark has 9 territories on the left, and Light has 8 on the right.
        The top part belongs to no one.
        Each player's score at the end of the game is the sum of that player's territories and captures.`,new Ss([[ge,Ye,ge,ge,nt,nt],[ge,Ye,ge,ge,nt,ge],[ge,Ye,Ye,nt,nt,ge],[ge,ge,Ye,nt,ge,ge],[ge,ge,Ye,nt,ge,ge],[ge,ge,Ye,nt,ge,ge]],[0,0],0,S.empty(),xn.PLAYING)),pe.fromMove($localize`Simple capture`,$localize`An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).
        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.
        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>
        The light piece only has one liberty left, play there.`,new Ss([[ge,ge,ge,ge,ge],[ge,ge,Ye,ge,ge],[ge,Ye,nt,ge,ge],[ge,ge,Ye,ge,ge],[ge,ge,ge,ge,ge]],[0,0],0,S.empty(),xn.PLAYING),[new U1(3,2)],$localize`Congratulations, you have earned one point.`,$localize`Failed, try again by playing on one of the intersections directly next to the light stone.`),pe.fromMove($localize`Capturing multiple stones`,$localize`Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>
        The light group here only has one liberty left, capture it.`,new Ss([[ge,Ye,ge,ge,ge],[Ye,nt,ge,ge,ge],[Ye,nt,nt,Ye,ge],[ge,Ye,Ye,ge,ge],[ge,ge,ge,ge,ge]],[0,0],0,S.empty(),xn.PLAYING),[new U1(2,1)],$localize`Congratulations, you have earned three points and formed a territory.`,$localize`Failed, you have not captured the group. Play on the last liberty of that group.`),pe.informational($localize`Suicide`,$localize`In Go, suicide is forbidden.
        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.
        Here, the top left intersection is a suicide for Light.
        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player.`,new Ss([[ge,Ye,ge,ge,ge],[Ye,ge,ge,ge,ge],[Ye,ge,ge,ge,nt],[nt,Ye,ge,nt,ge],[ge,nt,ge,nt,Ye]],[0,0],0,S.empty(),xn.PLAYING)),pe.informational($localize`Life and death (death)`,$localize`From the capture rule follows the life and death notion:
        dead stones are stones that are definitely capturable (without losing anything else).
        Alive stones are stones that can never be captured.
        From the capture rule, Dark can play inside Light's territory and make a capture.
        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).
        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories.`,new Ss([[ge,ge,ge,ge,ge],[Ye,Ye,Ye,ge,ge],[nt,nt,Ye,ge,ge],[ge,nt,Ye,ge,ge],[nt,nt,Ye,ge,ge]],[0,0],0,S.empty(),xn.PLAYING)),pe.informational($localize`Life and death (eyes)`,$localize`Here, Light cannot play on the top left, nor on the bottom left.
        Light will never be able to capture Dark.
        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive.`,new Ss([[ge,Ye,nt,ge,ge],[nt,Ye,nt,ge,ge],[Ye,Ye,nt,ge,ge],[nt,Ye,nt,ge,ge],[ge,Ye,nt,ge,ge]],[0,0],0,S.empty(),xn.PLAYING)),pe.informational($localize`Seki`,$localize`If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.
        Similarly, if Light plays on the middle line, Dark will capture Light.
        In other words, there is no point in playing on the middle line.
        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral.`,new Ss([[ge,nt,Ye,ge,nt,Ye,ge],[ge,nt,Ye,Ye,nt,Ye,ge],[ge,nt,Ye,Ye,nt,Ye,ge],[ge,nt,Ye,Ye,nt,Ye,ge],[ge,nt,Ye,nt,nt,Ye,ge],[ge,nt,Ye,nt,nt,Ye,ge],[ge,nt,Ye,ge,nt,Ye,ge]],[0,0],0,S.empty(),xn.PLAYING)),pe.fromMove($localize`Ko`,$localize`A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>
        Capture the light stone.`,new Ss([[ge,ge,ge,ge,ge,ge,ge],[ge,ge,ge,ge,ge,ge,ge],[ge,ge,ge,Ye,nt,ge,ge],[ge,ge,Ye,nt,ge,nt,ge],[ge,ge,ge,Ye,nt,ge,ge],[ge,ge,ge,ge,ge,ge,ge],[ge,ge,ge,ge,ge,ge,ge]],[0,0],0,S.empty(),xn.PLAYING),[new U1(4,3)],$localize`Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.
        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.
        This rule is called the Ko.
        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after.`,$localize`Failed!`),pe.fromMove($localize`End of the game`,$localize`When a player feels that there is no advantage to putting a new stone, that player can pass a turn.
        The game phase stops when both players pass consecutively, and we move on to the counting phase.
        The dead groups are then marked by clicking on them.
        Every intersection in a player's territory earns that player a point.
        The winner is the one with most points.<br/><br/>
        A last stone is dead, mark it.`,new Ss([[nt,Ye,Ye,Ye,Ye,Ye,ac,ac,ac],[nt,nt,nt,nt,Ye,Ye,Ye,ac,ac],[nt,Bf,nt,nt,Ye,bV,bV,Ye,ac],[Ye,nt,nt,nt,nt,Ye,ac,ac,ac],[ge,nt,Bf,nt,Ye,Ye,bV,Ye,ac],[nt,Bf,nt,nt,Ye,Ye,Ye,Ye,Ye],[nt,nt,Ye,Ye,Ye,nt,nt,Ye,nt],[Ye,Ye,Ye,nt,nt,nt,Bf,nt,nt],[ac,ac,Ye,Ye,Ye,nt,nt,Bf,Bf]],[0,0],0,S.empty(),xn.COUNTING),[new U1(0,3)],$localize`Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.
        The intersections where the prisoners are count as Dark's territory
        Light has 8 territories and 1 prisoner.
        The end result is therefore 18 - 9 for Dark.`,$localize`Failed, try again.`)]}}function F4t(n,t){if(1&n&&(B(),X(0,"circle",10)),2&n){const e=E(2).index,r=E().index;V("cx",25+50*e)("cy",25+50*r)("r",22)}}function B4t(n,t){if(1&n){const e=we();B(),N(0,"line",11),se("click",function(){he(e);const s=E(2).index,i=E().index;return ce(E().onClick(s,i))}),A()}if(2&n){const e=E(2).index,r=E().index;V("x1",50*e)("y1",50*r)("x2",50+50*e)("y2",50+50*r)}}function $4t(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"circle",7),se("click",function(){he(e);const s=E().index,i=E().index;return ce(E().onClick(s,i))}),A(),k(2,F4t,1,3,"circle",8),k(3,B4t,1,4,"line",9),A()}if(2&n){const e=E().index,r=E().index,s=E();M(1),w("ngClass",s.getSpaceClass(e,r)),V("cx",25+50*e)("cy",25+50*r)("r",22),M(1),w("ngIf",s.isLastSpace(e,r)),M(1),w("ngIf",s.isDead(e,r))}}function U4t(n,t){if(1&n){const e=we();B(),N(0,"circle",15),se("click",function(){he(e);const s=E(2).index,i=E().index;return ce(E().onClick(s,i))}),A()}if(2&n){const e=E(2),r=e.index,s=e.$implicit,i=E().index,o=E();V("cx",25+50*r)("cy",25+50*i)("r",10)("class",s===o.GoPiece.LIGHT_TERRITORY?"player1-fill":"player0-fill")}}function G4t(n,t){if(1&n){const e=we();B(),N(0,"rect",12),se("click",function(){he(e);const s=E().index,i=E().index;return ce(E().onClick(s,i))}),A(),N(1,"line",13),se("click",function(){he(e);const s=E().index,i=E().index;return ce(E().onClick(s,i))}),A(),N(2,"line",13),se("click",function(){he(e);const s=E().index,i=E().index;return ce(E().onClick(s,i))}),A(),k(3,U4t,1,4,"circle",14)}if(2&n){const e=E().index,r=E().index,s=E();je("id","click_",e,"_",r,""),V("x",50*e)("y",50*r),M(1),V("x1",50*e)("y1",25+50*r)("x2",50+50*e)("y2",25+50*r),M(1),V("x1",25+50*e)("y1",50*r)("x2",25+50*e)("y2",50+50*r),M(1),w("ngIf",s.isTerritory(e,r))}}function W4t(n,t){if(1&n&&(B(),N(0,"g"),k(1,$4t,4,6,"g",5),k(2,G4t,4,13,"ng-template",null,6,l1),A()),2&n){const e=t.index,r=s1(3),s=E().index,i=E();M(1),w("ngIf",i.spaceIsFull(e,s))("ngIfElse",r)}}function q4t(n,t){if(1&n&&(B(),N(0,"g"),k(1,W4t,4,2,"g",2),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}function j4t(n,t){if(1&n&&(B(),X(0,"rect",16)),2&n){const e=E();V("x",12.5+50*e.ko.get().x)("y",12.5+50*e.ko.get().y)}}function Z4t(n,t){if(1&n){const e=we();B(),N(0,"circle",17),se("click",function(){const i=he(e).$implicit;return ce(E().onClick(i.x,i.y))}),A()}if(2&n){const e=t.$implicit;V("cx",25+50*e.x)("cy",25+50*e.y)("r",7)}}let Y4t=(()=>{class n extends Bo{constructor(e){super(e),this.ko=S.empty(),this.last=S.empty(),this.captures=[],this.GoPiece=Fe,this.scores=S.of([0,0]),this.rules=new r3(Ss),this.availableMinimaxes=[new H4t(this.rules,"GoMinimax")],this.encoder=U1.encoder,this.tutorial=(new ece).tutorial,this.canPass=!0,this.updateBoard()}onClick(e,r){var s=this;return O(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());s.last=S.empty();const o=new U1(e,r);return s.chooseMove(o,s.getState(),s.scores.get())})()}updateBoard(){Y(n.VERBOSE,"updateBoard");const e=this.getState(),r=this.rules.node.move,s=e.phase;this.board=e.getCopiedBoard(),this.scores=S.of(e.getCapturedCopy()),this.ko=e.koCoord,r.isPresent()?this.showCaptures():this.captures=[],this.last=r.map(i=>i.coord),this.canPass=s!==xn.FINISHED}showCaptures(){const e=this.rules.node.mother.get().gameState;this.captures=[];for(let r=0;r<this.board.length;r++)for(let s=0;s<this.board[0].length;s++){const i=new P(s,r),o=!1===e.getPieceAt(i).isEmpty(),c=this.board[r][s]===Fe.EMPTY,u=!1===this.ko.equalsValue(i);o&&c&&u&&this.captures.push(i)}}pass(){var e=this;return O(function*(){const r=e.getState().phase;return r===xn.PLAYING||r===xn.PASSED?e.onClick(U1.PASS.coord.x,U1.PASS.coord.y):(Se(r===xn.COUNTING||r===xn.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(U1.ACCEPT.coord.x,U1.ACCEPT.coord.y))})()}getSpaceClass(e,r){const s=this.getState().getPieceAtXY(e,r);return this.getPlayerClass(s.getOwner())}spaceIsFull(e,r){return this.getState().getPieceAtXY(e,r)!==Fe.EMPTY&&!this.isTerritory(e,r)}isLastSpace(e,r){if(this.last.isPresent()){const s=this.last.get();return e===s.x&&r===s.y}return!1}isDead(e,r){return this.getState().isDead(new P(e,r))}isTerritory(e,r){return this.getState().isTerritory(new P(e,r))}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-go"]],features:[l],decls:5,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["width","25","height","25","class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured-fill",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke last-move-stroke",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke"],[1,"base","no-fill","captured-stroke",3,"click"],["width","50","height","50","fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],["width","25","height","25",1,"captured-stroke","mid-stroke","no-fill"],[1,"captured-fill",3,"click"]],template:function(e,r){1&e&&(B(),N(0,"svg",0),X(1,"rect",1),k(2,q4t,2,1,"g",2),k(3,j4t,1,2,"rect",3),k(4,Z4t,1,3,"circle",4),A()),2&e&&(V("viewBox","0 -3 "+50*r.board.length+" "+(6+50*r.board.length)),M(1),V("width",50*r.board.length)("height",50*r.board.length),M(1),w("ngForOf",r.board),M(1),w("ngIf",r.ko.isPresent()),M(1),w("ngForOf",r.captures))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class ao extends EV{static of(t,e){return new ao(t,e)}static from(t,e){try{const r=new ao(t,e);return K.success(r)}catch(r){return K.failure(r.message)}}getMaximalDistance(){return 11}}ao.encoder=tc.getEncoder(11,11,ao.of);const K4t={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:11,INVADER:F.ZERO};class s3 extends MV{static getInitialState(){const t=cn.UNOCCUPIED,e=cn.INVADERS,r=cn.DEFENDERS;return new s3([[t,t,t,e,e,e,e,e,t,t,t],[t,t,t,t,t,e,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t],[e,t,t,t,t,r,t,t,t,t,e],[e,t,t,t,r,r,r,t,t,t,e],[e,e,t,r,r,cn.PLAYER_ONE_KING,r,r,t,e,e],[e,t,t,t,r,r,r,t,t,t,e],[e,t,t,t,t,r,t,t,t,t,e],[t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,e,t,t,t,t,t],[t,t,t,e,e,e,e,e,t,t,t]],0)}from(t,e){return new s3(t,e)}}class V8 extends SV{constructor(){super(s3,K4t,ao.of)}static get(){return null==V8.singleton&&(V8.singleton=new V8),fr.ruler=this.singleton,V8.singleton}}const R=cn.UNOCCUPIED,Gt=cn.INVADERS,Zr=cn.DEFENDERS,xS=cn.PLAYER_ONE_KING;class tce extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Goal of the game`,$localize`Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,s3.getInitialState()),pe.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,s3.getInitialState(),ao.of(new P(5,1),new P(1,1)),$localize`Congratulations!`),pe.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it.`,new s3([[R,R,R,R,Gt,Gt,Gt,Gt,R,R,R],[R,R,R,R,R,Gt,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[Gt,R,R,R,R,Zr,R,R,R,R,Gt],[Gt,R,R,Gt,Zr,Zr,Zr,R,R,R,Gt],[Gt,Gt,R,Zr,Zr,xS,Zr,Zr,R,Gt,Gt],[Gt,R,R,R,Zr,Zr,Zr,R,R,R,Gt],[Gt,R,R,R,R,Zr,R,R,R,R,Gt],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,Gt,R,R,R,R,R],[R,R,R,Gt,Gt,Gt,Gt,Gt,R,R,R]],1),[ao.of(new P(5,3),new P(3,3))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`).withPreviousMove(ao.of(new P(3,0),new P(3,4))).withPreviousState(s3.getInitialState()),pe.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it.`,new s3([[R,R,R,Gt,Gt,Gt,Gt,Gt,R,R,R],[R,Zr,R,R,R,Gt,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,Zr,R,R,R,R,Gt],[Gt,R,R,R,R,Zr,Zr,R,R,R,Gt],[Gt,Gt,xS,R,Zr,R,Zr,Zr,R,R,Gt],[R,R,Gt,R,R,Zr,Zr,R,R,R,Gt],[Gt,R,R,R,R,Zr,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,Gt,R,R,R,R,R,R,R,R,R],[R,R,R,Gt,Gt,Gt,Gt,R,Gt,R,R]],12),[ao.of(new P(3,0),new P(3,5)),ao.of(new P(3,10),new P(3,5))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),pe.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>Capture the king.`,new s3([[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,Gt,R,R,R,R,R,R,R,R,R],[Gt,xS,R,Gt,R,R,R,R,R,R,R],[R,Gt,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R]],72),[ao.of(new P(3,4),new P(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),pe.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>Capture the king.`,new s3([[R,R,Gt,xS,Gt,R,R,R,R,R,R],[R,R,R,R,R,R,Zr,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,Gt,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R]],72),[ao.of(new P(3,3),new P(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed!`)]}}function X4t(n,t){1&n&&(B(),X(0,"polygon",8))}function Q4t(n,t){1&n&&(B(),X(0,"rect",9))}function J4t(n,t){if(1&n&&(B(),N(0,"g"),k(1,X4t,1,0,"polygon",6),k(2,Q4t,1,0,"ng-template",null,7,l1),A()),2&n){const e=s1(3),r=E().index,s=E().index,i=E();M(1),w("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function elt(n,t){if(1&n&&(B(),N(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),A()),2&n){const e=E(2).index,r=E().index,s=E();M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function tlt(n,t){if(1&n&&(B(),X(0,"polyline",16)),2&n){const e=E(3).index,r=E().index;w("ngClass",E().viewInfo.pieceClasses[r][e])}}function nlt(n,t){if(1&n&&(B(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=E(3).index,r=E().index,s=E();w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function rlt(n,t){if(1&n&&(B(),k(0,tlt,1,1,"polyline",14),k(1,nlt,4,20,"ng-template",null,15,l1)),2&n){const e=s1(2),r=E(2).index,s=E().index;w("ngIf",E().isKing(r,s))("ngIfElse",e)}}function slt(n,t){if(1&n&&(B(),N(0,"g"),X(1,"circle",10),k(2,elt,6,25,"g",11),k(3,rlt,3,2,"ng-template",null,12,l1),A()),2&n){const e=s1(4),r=E().index,s=E().index,i=E();M(1),je("id","piece_",r,"_",s,""),w("ngClass",i.viewInfo.pieceClasses[s][r]),V("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),M(1),w("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function ilt(n,t){if(1&n){const e=we();B(),N(0,"g",3),se("click",function(){const i=he(e).index,o=E().index;return ce(E().onClick(i,o))}),X(1,"rect",4),k(2,J4t,4,2,"g",5),k(3,slt,5,8,"g",5),A()}if(2&n){const e=t.index,r=E().index,s=E();je("id","click_",e,"_",r,""),V("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),M(1),w("ngClass",s.getRectClasses(e,r)),V("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),M(1),w("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),M(1),w("ngIf",s.board[r][e]!==s.EMPTY)}}function olt(n,t){if(1&n&&(B(),N(0,"g"),k(1,ilt,4,8,"g",2),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}function alt(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"rect",17),se("click",function(){const i=he(e).$implicit;return ce(E().onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=E();M(1),je("id","click_",e.x,"_",e.y,""),V("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let clt=(()=>{class n extends PV{constructor(e){super(e,!1,ao.from),this.rules=V8.get(),this.availableMinimaxes=[new wS(this.rules,"DummyBot"),new NS(this.rules,"Piece > Influence"),new Qc(this.rules,"Piece > Control"),new kf(this.rules,"Escape > Piece > Control")],this.encoder=ao.encoder,this.tutorial=(new tce).tutorial}ngOnInit(){this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-hnefatafl"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(B(),N(0,"svg",0),k(1,olt,2,1,"g",1),k(2,alt,2,6,"g",1),A()),2&e&&(V("viewBox",r.getViewBox()),M(1),w("ngForOf",r.board),M(1),w("ngForOf",r.getClickables()))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class mn{constructor(t,e,r){this.value=t,this.name=e,this.rgb=r}static of(t){switch(t){case 0:return mn.ANY;case 1:return mn.ORANGE;case 2:return mn.BLUE;case 3:return mn.PURPLE;case 4:return mn.PINK;case 5:return mn.YELLOW;case 6:return mn.RED;case 7:return mn.GREEN;default:return Ae.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),mn.BROWN}}}mn.ANY=new mn(0,"any","#000"),mn.ORANGE=new mn(1,"orange","#d67421"),mn.BLUE=new mn(2,"blue","#006bac"),mn.PURPLE=new mn(3,"purple","#6f3787"),mn.PINK=new mn(4,"pink","#d2719e"),mn.YELLOW=new mn(5,"yellow","#e2c200"),mn.RED=new mn(6,"red","#d23339"),mn.GREEN=new mn(7,"green","#009157"),mn.BROWN=new mn(8,"brown","#562500");class Ln{constructor(t,e){this.player=t,this.color=e}static of(t,e){return new Ln(t,mn.of(e))}static createPlayerColors(t){return{ORANGE:new Ln(t,mn.ORANGE),BLUE:new Ln(t,mn.BLUE),PURPLE:new Ln(t,mn.PURPLE),PINK:new Ln(t,mn.PINK),YELLOW:new Ln(t,mn.YELLOW),RED:new Ln(t,mn.RED),GREEN:new Ln(t,mn.GREEN),BROWN:new Ln(t,mn.BROWN)}}equals(t){return t.player===this.player&&t.color===this.color}isEmpty(){return this.player.equals(fe.NONE)}belongsTo(t){return this.player===t}}Ln.EMPTY=new Ln(fe.NONE,mn.ANY),Ln.ZERO=Ln.createPlayerColors(F.ZERO),Ln.ONE=Ln.createPlayerColors(F.ONE);class u2{static getColorAt(t,e){return u2.COLORS[e][t]}static getInitialBoard(){const t=Ln.EMPTY;return[[1,2,3,4,5,6,7,8].map(e=>Ln.of(F.ONE,e)),[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[8,7,6,5,4,3,2,1].map(e=>Ln.of(F.ZERO,e))]}static isEmptyAt(t,e){return t[e.y][e.x].equals(Ln.EMPTY)}static allPieceCoords(t){const e=[];for(let r=0;r<t.length;r++)for(let s=0;s<t[r].length;s++){const i=new P(s,r);u2.isEmptyAt(t,i)||e.push(i)}return e}}u2.INITIAL=u2.getInitialBoard(),u2.SIZE=8,u2.COLORS=ht.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],mn.of);class NV extends so{constructor(){super()}isPieceMove(){return!1}length(){return 0}equals(t){return this===t}toString(){return"KamisadoMove(PASS)"}}NV.PASS=new NV;class AV extends tc{constructor(t,e){super(t,e)}static of(t,e){if(t.isNotInRange(u2.SIZE,u2.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+t.toString());if(e.isNotInRange(u2.SIZE,u2.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+e.toString());return new AV(t,e)}isPieceMove(){return!0}equals(t){return t===this||!!t.isPieceMove()&&!1!==t.coord.equals(this.coord)&&t.end.equals(this.end)}toString(){return"KamisadoMove("+this.coord+"->"+this.end+")"}}var co;!function(n){n.PASS=NV.PASS,n.of=function t(e,r){return AV.of(e,r)},n.encoder=new class extends on{maxValue(){return 34952}encodeNumber(e){return e.isPieceMove()?4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y:0}decodeNumber(e){if(0===e)return n.PASS;const r=e%16,s=(e=e/16|0)%16,i=(e=e/16|0)%16;return n.of(new P((e=e/16|0)%16,i),new P(s,r))}}}(co||(co={}));class i3 extends Vs{constructor(t,e,r,s,i){super(ht.copyBiArray(i),t),this.colorToPlay=e,this.coordToPlay=r,this.alreadyPassed=s}static getInitialState(){return new i3(0,mn.ANY,S.empty(),!1,u2.INITIAL)}}let sm=(()=>{class n{}return n.NOT_RIGHT_COLOR=()=>$localize`This piece is not of the color you have to play.`,n.DIRECTION_NOT_ALLOWED=()=>$localize`You can only move forward, orthogonally or diagonally.`,n.MOVE_BLOCKED=()=>$localize`This move is blocked by another piece.`,n.PLAY_WITH_SELECTED_PIECE=()=>$localize`You must play with the selected piece.`,n})();class lo extends hr{static getColorMatchingPiece(t){return t.coordToPlay.isPresent()?[t.coordToPlay.get()]:[new P(0,7),new P(1,7),new P(2,7),new P(3,7),new P(4,7),new P(5,7),new P(6,7),new P(7,7)]}static getMovablePieces(t){return lo.getColorMatchingPiece(t).filter(e=>{for(const r of this.playerDirections(t.getCurrentPlayer())){const s=e.getNext(r);if(t.isOnBoard(s)&&u2.isEmptyAt(t.board,s))return!0}return!1})}static playerDirections(t){return t===F.ONE?[Pe.DOWN,Pe.DOWN_LEFT,Pe.DOWN_RIGHT]:[Pe.UP,Pe.UP_LEFT,Pe.UP_RIGHT]}static directionAllowedForPlayer(t,e){return e===F.ZERO?t.y<0:t.y>0}static getListMovesFromState(t){const e=lo.getMovablePieces(t);return 0===e.length?(Se(!1===t.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[co.PASS]):lo.getListMovesFromNonBlockedState(t,e)}static getListMovesFromNonBlockedState(t,e){const r=[],s=t.getCurrentPlayer();for(const i of e)for(const o of lo.playerDirections(s))for(let c=1;c<u2.SIZE;c++){const u=i.getNext(o,c);if(!t.isOnBoard(u)||!u2.isEmptyAt(t.board,u))break;{const h=co.of(i,u);r.push(h)}}return r}static mustPass(t){return 0===this.getMovablePieces(t).length}static getFurthestPiecePositions(t){let e=7,r=0;return u2.allPieceCoords(t.board).forEach(s=>{const i=t.getPieceAt(s);Se(i!==Ln.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),i.player===F.ONE?r=Math.max(r,s.y):e=Math.min(e,s.y)}),[e,r]}static isLegal(t,e){if(t.isPieceMove()){const r=t.coord,s=t.end,i=e.colorToPlay,o=e.getPieceAt(r);if(!o.belongsTo(e.getCurrentPlayer()))return K.failure(Mt.MUST_CHOOSE_PLAYER_PIECE());if(i!==mn.ANY&&o.color!==i)return K.failure(sm.NOT_RIGHT_COLOR());if(!e.getPieceAt(s).isEmpty())return K.failure(Mt.MUST_CLICK_ON_EMPTY_SPACE());const u=Pe.factory.fromMove(r,s);if(u.isFailure())return K.failure(sm.DIRECTION_NOT_ALLOWED());const h=u.get();if(!lo.directionAllowedForPlayer(h,e.getCurrentPlayer()))return K.failure(sm.DIRECTION_NOT_ALLOWED());let g=r;for(;!g.equals(s);)if(g=g.getNext(h),!e.getPieceAt(g).isEmpty())return K.failure(sm.MOVE_BLOCKED());return K.success(void 0)}return this.isLegalPass(e)}static isLegalPass(t){return this.mustPass(t)&&!t.alreadyPassed?K.success(void 0):K.failure(Mt.CANNOT_PASS())}nextCoordToPlay(t,e){return S.ofNullable(u2.allPieceCoords(t.board).find(r=>{const s=t.getPieceAt(r);return s.player===t.getCurrentOpponent()&&s.color===e}))}applyLegalMove(t,e,r){if(t.isPieceMove()){const s=t.coord,i=t.end,o=e.getCopiedBoard();o[i.y][i.x]=o[s.y][s.x],o[s.y][s.x]=Ln.EMPTY;const c=u2.getColorAt(i.x,i.y),u=this.nextCoordToPlay(e,c);return new i3(e.turn+1,c,u,!1,o)}{const s=this.nextCoordToPlay(e,e.colorToPlay);return new i3(e.turn+1,e.colorToPlay,s,!0,e.board)}}isLegal(t,e){return lo.isLegal(t,e)}getGameStatus(t){const e=t.gameState,r=e.getCurrentPlayer();if(lo.mustPass(e)&&e.alreadyPassed)return ze.getDefeat(r);const[s,i]=lo.getFurthestPiecePositions(e);return 7===i?ze.ONE_WON:0===s?ze.ZERO_WON:ze.ONGOING}}class llt extends rr{getListMoves(t){const e=lo.getListMovesFromState(t.gameState);return ht.sortByDescending(e,r=>r.length()),e}getBoardValue(t){const e=t.gameState,r=e.getCurrentPlayer();if(lo.mustPass(e)&&e.alreadyPassed)return new dt(r.getDefeatValue());const[s,i]=lo.getFurthestPiecePositions(e);return new dt(7===i?F.ONE.getVictoryValue():0===s?F.ZERO.getVictoryValue():i-(7-s))}}const re=Ln.EMPTY,LS=Ln.ZERO.ORANGE,kS=Ln.ONE.ORANGE,RS=Ln.ZERO.BLUE,DS=Ln.ONE.BLUE,OV=Ln.ZERO.PURPLE,im=Ln.ONE.PURPLE,zS=Ln.ZERO.PINK,VS=Ln.ONE.PINK,HS=Ln.ZERO.YELLOW,FS=Ln.ONE.YELLOW,BS=Ln.ZERO.RED,$S=Ln.ONE.RED,US=Ln.ZERO.GREEN,GS=Ln.ONE.GREEN,WS=Ln.ZERO.BROWN,qS=Ln.ONE.BROWN;class nce extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Goal of the game`,$localize`At Kamisado, there are two ways to win the game:
        either by moving one of your pieces on the opponent's starting line,
        or by forcing the opponent to make a move that blocks the entire game.
        Here, Dark wins because its brown piece is on Light's starting line, on the top left.`,new i3(5,mn.ORANGE,S.empty(),!1,[[WS,DS,im,VS,FS,$S,GS,qS],[re,re,re,re,re,re,re,re],[re,re,re,re,re,re,re,re],[re,re,re,re,re,re,re,re],[re,re,re,kS,re,re,re,re],[re,re,re,re,re,re,re,re],[re,re,re,re,re,re,re,re],[re,US,BS,HS,zS,OV,RS,LS]])).withPreviousMove(co.of(new P(0,7),new P(0,0))),pe.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
        At Kamisado, pieces can only move forward, vertically or diagonally.
        You're playing first, with dark pieces, you can make your first move.<br/><br/>
        Click on the piece of your choice and click on the landing square.`,i3.getInitialState(),co.of(new P(7,7),new P(3,3)),$localize`Perfect! Note that each of your piece has a different color.`),pe.fromMove($localize`Moving`,$localize`Let us now consider the move of Light, after the blue piece has been moved by Dark.
        All moves after the initial move must be made from the piece that corresponds to the color
        of the square upon which the last move ended.
        Here, the last move ended on the pink square, hence the pink piece must move.
        It is already selected, you do not have to click on it.<br/><br/>
        Move it on a blue square.`,new i3(1,mn.PINK,S.of(new P(3,0)),!1,[[kS,DS,im,VS,FS,$S,GS,qS],[re,re,re,re,re,re,re,re],[re,re,re,re,re,re,re,re],[re,re,re,re,re,re,re,re],[re,re,re,re,re,re,re,re],[re,re,re,re,re,re,RS,re],[re,re,re,re,re,re,re,re],[WS,US,BS,HS,zS,OV,re,LS]]),[co.of(new P(3,0),new P(3,6)),co.of(new P(3,0),new P(4,1))],$localize`Congratulations!`,$localize`You have not moved your pink piece on a blue square!`).withPreviousMove(co.of(new P(6,7),new P(6,5))),pe.informational($localize`Stuck situation`,$localize`Dark moved to another pink square, hence you have to move your pink piece again.
        However, your pink piece is stuck! In this case, you must pass your turn.
        Dark will now have to play by moving its pink piece.`,new i3(1,mn.PINK,S.of(new P(3,6)),!1,[[kS,DS,im,re,FS,$S,GS,qS],[re,re,re,re,re,re,re,re],[re,re,re,re,re,re,re,re],[re,re,re,re,re,re,re,re],[re,re,re,re,re,re,re,RS],[re,re,re,re,re,re,re,re],[re,re,re,VS,re,re,re,re],[WS,US,BS,HS,zS,OV,re,LS]])).withPreviousMove(co.of(new P(6,5),new P(7,4))),pe.fromMove($localize`Victory by blocking`,$localize`At any time, if a player blocks the entire game, that player loses.
        In other words, if a player forces its opponent to move a piece that the opponent cannot move,
        and the player cannot move its own piece of the same color, then that player loses.
        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>
        Try to make this move.`,new i3(2,mn.RED,S.of(new P(2,4)),!1,[[re,DS,im,re,re,$S,re,re],[re,re,re,FS,re,re,re,re],[re,re,re,VS,re,im,re,re],[re,re,re,HS,re,re,re,re],[re,re,BS,re,re,re,re,re],[re,re,re,re,re,re,GS,re],[kS,re,re,re,re,zS,re,qS],[WS,US,re,re,re,re,RS,LS]]),[co.of(new P(2,4),new P(0,2))],$localize`Perfect!
         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.
         Your orange piece will be stuck and you will have to pass your turn.
         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.
         In this case, the last player to have moved a piece loses.
         Here, your opponent will have moved its green piece last, you therefore win!`,$localize`Failed!`).withPreviousMove(co.of(new P(4,0),new P(3,1)))]}}function ult(n,t){if(1&n&&(B(),X(0,"circle",8)),2&n){const e=E(),r=e.$implicit,s=e.index,i=E().index,o=E();w("ngClass",o.piecePlayerClass(r)),V("cx",o.SPACE_SIZE/2+s*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+i*o.SPACE_SIZE)("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)}}function flt(n,t){if(1&n&&(B(),X(0,"rect",9)),2&n){const e=E(),r=e.index,s=e.$implicit,i=E().index,o=E();V("x",o.SPACE_SIZE/2+r*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+i*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(s)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(s)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)("fill",o.pieceColor(s))}}function hlt(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"g",4),se("click",function(){const i=he(e).index,o=E().index;return ce(E().onClick(i,o))}),X(2,"rect",5),k(3,ult,1,4,"circle",6),k(4,flt,1,7,"rect",7),A()()}if(2&n){const e=t.$implicit,r=t.index,s=E().index,i=E();M(1),je("id","click_",r,"_",s,""),M(1),V("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)("fill",i.backgroundColor(r,s)),M(1),w("ngIf",e!==i.UNOCCUPIED),M(1),w("ngIf",e!==i.UNOCCUPIED)}}function dlt(n,t){if(1&n&&(B(),N(0,"g"),k(1,hlt,5,9,"g",1),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}function plt(n,t){if(1&n&&(B(),N(0,"g"),X(1,"rect",10)(2,"rect",10),A()),2&n){const e=E();M(1),V("x",e.lastPieceMove.get().coord.x*e.SPACE_SIZE)("y",e.lastPieceMove.get().coord.y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE),M(1),V("x",e.lastPieceMove.get().end.x*e.SPACE_SIZE)("y",e.lastPieceMove.get().end.y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function glt(n,t){if(1&n&&(B(),X(0,"circle",11)),2&n){const e=E();V("cx",e.SPACE_SIZE/2+e.chosen.get().x*e.SPACE_SIZE)("cy",e.SPACE_SIZE/2+e.chosen.get().y*e.SPACE_SIZE)("r",e.SPACE_SIZE/2-e.STROKE_WIDTH)}}let mlt=(()=>{class n extends Bo{constructor(e){super(e),this.UNOCCUPIED=Ln.EMPTY,this.lastMove=S.empty(),this.lastPieceMove=S.empty(),this.chosen=S.empty(),this.chosenAutomatically=!1,this.hasAsymetricBoard=!0,this.rules=new lo(i3),this.availableMinimaxes=[new llt(this.rules,"KamisadoMinimax")],this.encoder=co.encoder,this.tutorial=(new nce).tutorial,this.canPass=!1,this.updateBoard()}backgroundColor(e,r){return u2.getColorAt(e,r).rgb}isPlayerZero(e){return e.player===F.ZERO}pieceColor(e){return e.color.rgb}piecePlayerClass(e){return this.getPlayerClass(e.player)}updateBoard(){const e=this.getState();if(this.board=e.getCopiedBoard(),this.lastMove=this.rules.node.move,this.lastPieceMove=S.empty(),this.lastMove.isPresent()){const s=this.lastMove.get();s.isPieceMove()&&(this.lastPieceMove=S.of(s))}this.canPass=lo.mustPass(e);const r=this.rules.getGameStatus(this.rules.node)!==ze.ONGOING;this.canPass||e.coordToPlay.isAbsent()||r?(this.chosenAutomatically=!1,this.chosen=S.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}pass(){var e=this;return O(function*(){return Se(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(co.PASS,e.getState())})()}onClick(e,r){var s=this;return O(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new P(e,r);if(s.canPass)return s.cancelMove(Mt.MUST_PASS());if(s.chosen.isAbsent())return s.choosePiece(e,r);if(!1===s.chosenAutomatically&&s.chosen.equalsValue(o))return s.cancelMoveAttempt(),G.SUCCESS;{const c=s.getState().getPieceAtXY(e,r),u=s.getState().getCurrentPlayer();return c.belongsTo(u)?s.chosenAutomatically?s.cancelMove(sm.PLAY_WITH_SELECTED_PIECE()):(s.chosen=S.of(o),G.SUCCESS):yield s.chooseDestination(e,r)}})()}choosePiece(e,r){const s=this.getState().getPieceAtXY(e,r),i=this.getState().getCurrentOpponent();return s.belongsTo(i)?this.cancelMove(Mt.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=S.of(new P(e,r)),G.SUCCESS)}chooseDestination(e,r){var s=this;return O(function*(){const i=s.chosen.get(),o=new P(e,r),c=co.of(i,o);return s.chooseMove(c,s.getState())})()}cancelMoveAttempt(){this.chosenAutomatically||(this.chosen=S.empty())}}return n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-kamisado"]],features:[l],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill selected-stroke",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","last-move-stroke"],["id","selectedPiece",1,"base","mid-stroke","no-fill","selected-stroke"]],template:function(e,r){1&e&&(B(),N(0,"svg",0),k(1,dlt,2,1,"g",1),k(2,plt,3,8,"g",2),k(3,glt,1,3,"circle",3),A()),2&e&&(V("viewBox",r.getViewBox())("transform",r.rotation),M(1),w("ngForOf",r.board),M(1),w("ngIf",r.lastPieceMove.isPresent()),M(1),w("ngIf",r.chosen.isPresent()))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),as=(()=>{class n extends Vs{static getInitialState(){const e=fe.NONE,r=fe.ZERO,s=fe.ONE;return new n([[e,r,r,r,r,r,r,e],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[e,r,r,r,r,r,r,e]],0)}static isOnBoard(e){return e.isInRange(n.SIZE,n.SIZE)}}return n.SIZE=8,n})();class A2 extends tc{constructor(t,e,r){super(t,e),this.direction=r,this.direction=Pe.factory.fromMove(t,e).get()}static of(t,e){const r=Pe.factory.fromMove(t,e);return r.isFailure()?K.failure(r.getReason()):t.isNotInRange(as.SIZE,as.SIZE)?K.failure("start coord is not in range"):e.isNotInRange(as.SIZE,as.SIZE)?K.failure("end coord is not in range"):K.success(new A2(t,e,r.get()))}equals(t){return t===this||!!t.coord.equals(this.coord)&&t.end.equals(this.end)}toString(){return"LinesOfActionMove("+this.coord+"->"+this.end+")"}encode(){return A2.encoder.encode(this)}decode(t){return A2.encoder.decode(t)}}A2.encoder=tc.getEncoder(as.SIZE,as.SIZE,(n,t)=>A2.of(n,t).get());let IV=(()=>{class n{}return n.INVALID_MOVE_LENGTH=()=>$localize`Your move should have a length equal to the number of pieces that exist on the same line.`,n.CANNOT_JUMP_OVER_OPPONENT=()=>$localize`You cannot jump over the opponent's pieces.`,n.PIECE_CANNOT_MOVE=()=>$localize`This piece has no possible move, select another one.`,n})();class Oi extends hr{static getListMovesFromState(t){const e=[];if(Oi.getVictory(t).isPresent())return e;for(let r=0;r<as.SIZE;r++)for(let s=0;s<as.SIZE;s++){const i=new P(s,r);if(t.getPieceAt(i).isPlayer())for(const c of Oi.possibleTargets(t,i)){const u=A2.of(i,c).get();e.push(u)}}return e}static getNumberOfGroups(t){const e=ht.createTable(as.SIZE,as.SIZE,-1),r=[0,0];let s=0;for(let i=0;i<as.SIZE;i++)for(let o=0;o<as.SIZE;o++)if(-1===e[i][o]){const c=t.getPieceAt(new P(o,i));c.isPlayer()&&(s+=1,Oi.markGroupStartingAt(t,e,new P(o,i),s),r[c.value]+=1)}return r}static markGroupStartingAt(t,e,r,s){const i=[r],o=t.getPieceAt(r);for(;i.length>0;){const c=Ae.getNonNullable(i.pop());if(-1===e[c.y][c.x]){const u=t.getPieceAt(c);if(u===o){e[c.y][c.x]=s;for(const h of Pe.DIRECTIONS){const g=c.getNext(h);t.isOnBoard(g)&&i.push(g)}}else u===fe.NONE&&(e[c.y][c.x]=0)}}}applyLegalMove(t,e,r){const s=e.getCopiedBoard();return s[t.coord.y][t.coord.x]=fe.NONE,s[t.end.y][t.end.x]=e.getCurrentPlayer(),new as(s,e.turn+1)}static isLegal(t,e){return e.getPieceAt(t.coord)!==e.getCurrentPlayer()?K.failure(Mt.MUST_CHOOSE_PLAYER_PIECE()):t.length()!==this.numberOfPiecesOnLine(e,t.coord,t.direction)?K.failure(IV.INVALID_MOVE_LENGTH()):t.coord.getCoordsToward(t.end).some(r=>e.getPieceAt(r)===e.getCurrentOpponent())?K.failure(IV.CANNOT_JUMP_OVER_OPPONENT()):e.getPieceAt(t.end)===e.getCurrentPlayer()?K.failure(Mt.CANNOT_SELF_CAPTURE()):K.success(void 0)}isLegal(t,e){return Oi.isLegal(t,e)}static numberOfPiecesOnLine(t,e,r){let s=0;for(const i of Oi.getLineCoords(e,r))t.getPieceAt(i).isPlayer()&&(s+=1);return s}static getLineCoords(t,e){const r=Oi.getEntranceAndForwardDirection(t,e);let s=r[0];const i=r[1],o=[];for(;as.isOnBoard(s);)o.push(s),s=s.getNext(i);return o}static getEntranceAndForwardDirection(t,e){switch(e){case Pe.UP:case Pe.DOWN:return[new P(t.x,0),Pe.DOWN];case Pe.LEFT:case Pe.RIGHT:return[new P(0,t.y),Pe.RIGHT];case Pe.UP_RIGHT:case Pe.DOWN_LEFT:return[new P(Math.max(0,t.x+t.y-7),Math.min(7,t.x+t.y)),Pe.UP_RIGHT];default:return Ae.expectToBeMultiple(e,[Pe.UP_LEFT,Pe.DOWN_RIGHT]),[new P(t.x-Math.min(t.x,t.y),t.y-Math.min(t.x,t.y)),Pe.DOWN_RIGHT]}}static getVictory(t){const[e,r]=Oi.getNumberOfGroups(t);return 1===e&&1===r?S.of(fe.NONE):1===e?S.of(F.ZERO):1===r?S.of(F.ONE):S.empty()}static possibleTargets(t,e){const r=[];for(const s of Pe.DIRECTIONS){const i=Oi.numberOfPiecesOnLine(t,e,s),o=e.getNext(s,i);if(t.isOnBoard(o)){const c=A2.of(e,o).get();Oi.isLegal(c,t).isSuccess()&&r.push(o)}}return r}getGameStatus(t){const e=t.gameState,[r,s]=Oi.getNumberOfGroups(e);return 1===r&&s>1?ze.ZERO_WON:r>1&&1===s?ze.ONE_WON:ze.ONGOING}}class _lt extends rr{getListMoves(t){return Oi.getListMovesFromState(t.gameState)}getBoardValue(t){const e=t.gameState,[r,s]=Oi.getNumberOfGroups(e);return new dt(1===r&&s>1?F.ZERO.getVictoryValue():r>1&&1===s?F.ONE.getVictoryValue():100/r*F.ZERO.getScoreModifier()+100/s*F.ONE.getScoreModifier())}}const q=fe.NONE,sr=fe.ZERO,X1=fe.ONE;class rce{constructor(){this.tutorial=[pe.informational($localize`Goal of the game`,$localize`At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.
        Here, Dark wins the game:
        Dark's pieces are forming a single group, while Light's pieces form three groups.`,new as([[q,q,q,q,q,q,q,q],[X1,q,q,q,sr,q,q,X1],[q,q,sr,sr,X1,q,q,q],[q,q,q,sr,q,q,q,q],[q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q]],0)),pe.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
         Moves can be made orthogonally or diagonally.
         The length of a move is equal to the number of pieces that are on the line of the move.
         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>
         You're playing Dark, make the first move!`,as.getInitialState(),A2.of(new P(1,7),new P(1,5)).get(),$localize`Congratulations!`),pe.fromMove($localize`Jumping`,$localize`During a move, it is possible to jump above your own pieces.
        But it is forbidden to jump over the opponent's pieces.<br/><br/>
        You're playing Dark, make a jump over one of your pieces on the following board.`,new as([[q,q,q,q,q,q,q,q],[q,q,X1,sr,sr,q,q,q],[q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,X1],[q,q,q,q,q,q,q,sr]],0),[A2.of(new P(3,1),new P(6,1)).get()],$localize`Congratulations!`,$localize`Failed. You did not jump over one of your pieces.`),pe.fromMove($localize`Moving`,$localize`Here is a different board. Pick the dark piece in the middle (line 4, column 4)
        and observe its possible moves.
        Horizontally, this piece can move only of one square because it is the only piece on this line.
        Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.
        But it can only go up, as below it the landing square is occupied by one of your pieces.
        Diagonally, only one move is possible: on the diagonal that contains three pieces,
        only in the direction where it does not jump over one of the opponent's pieces.
        On the other diagonal, there are too many pieces to end the move on the board.<br/><br/>
        Make one of these moves.`,new as([[q,q,q,q,q,q,X1,q],[q,q,q,q,q,sr,q,q],[q,q,q,q,X1,q,q,q],[q,q,q,sr,q,q,q,q],[q,q,q,q,q,q,q,X1],[q,q,q,q,q,X1,q,X1],[q,q,q,sr,q,q,X1,X1],[q,q,q,sr,q,q,q,q]],0),[A2.of(new P(3,3),new P(3,0)).get(),A2.of(new P(3,3),new P(0,0)).get(),A2.of(new P(3,3),new P(2,3)).get(),A2.of(new P(3,3),new P(4,3)).get()],$localize`Congratulations!`,$localize`Failed. This was not one of the expected moves.`),pe.fromPredicate($localize`Capturing`,$localize`If a move ends on an opponent's piece, it is captured and removed from the board.
        However, a move cannot end on one of the player's pieces.
        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!
        If a player has only one piece, that player wins the game.<br/><br/>
        On the following board, try to capture one piece with Dark.`,new as([[q,sr,q,sr,sr,sr,sr,q],[X1,q,q,q,q,q,q,X1],[q,q,sr,q,X1,q,q,q],[X1,q,q,q,q,q,q,X1],[X1,q,q,q,q,q,q,X1],[X1,q,q,q,q,q,q,X1],[X1,q,q,q,q,q,q,X1],[q,sr,sr,sr,sr,sr,sr,q]],0),A2.of(new P(2,2),new P(4,2)).get(),(t,e,r)=>e.getPieceAt(t.end)===fe.ONE?G.SUCCESS:G.failure($localize`Failed!`),$localize`Congratulations!`),pe.fromMove($localize`Tie`,$localize`In the special case where a move ends up connecting all pieces of both player, simultaneously,
        then the game ends up with a tie.<br/><br/>
        You're playing Dark, force the tie in one move.`,new as([[q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q],[sr,q,q,sr,X1,sr,q,q],[q,q,q,sr,q,q,q,X1],[q,q,q,q,q,q,q,X1],[q,q,q,q,q,q,q,X1],[q,q,q,q,q,q,q,X1],[q,q,q,q,q,q,q,q]],0),[A2.of(new P(0,2),new P(4,2)).get()],$localize`Congratulations!`,$localize`Failed!`)]}}function vlt(n,t){if(1&n&&(B(),X(0,"circle",6)),2&n){const e=E().index,r=E().index,s=E();je("id","piece_",e,"_",r,""),w("ngClass",s.getPieceClasses(e,r)),V("cx",s.SPACE_SIZE/2+e*s.SPACE_SIZE)("cy",s.SPACE_SIZE/2+r*s.SPACE_SIZE)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function Clt(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"g",3),se("click",function(){const i=he(e).index,o=E().index;return ce(E().onClick(i,o))}),X(2,"rect",4),k(3,vlt,1,6,"circle",5),A()()}if(2&n){const e=t.$implicit,r=t.index,s=E().index,i=E();M(1),je("id","click_",r,"_",s,""),M(1),w("ngClass",i.getSquareClasses(r,s)),V("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),M(1),w("ngIf",e!==i.EMPTY)}}function ylt(n,t){if(1&n&&(B(),N(0,"g"),k(1,Clt,4,8,"g",1),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}function Elt(n,t){if(1&n){const e=we();B(),N(0,"rect",7),se("click",function(){const i=he(e).$implicit;return ce(E().onClick(i.x,i.y))}),A()}if(2&n){const e=t.$implicit,r=E();V("x",e.x*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("y",e.y*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("width",r.INDICATOR_SIZE)("height",r.INDICATOR_SIZE)}}let Mlt=(()=>{class n extends Bo{constructor(e){super(e),this.INDICATOR_SIZE=20,this.EMPTY=fe.NONE,this.targets=[],this.selected=S.empty(),this.lastMove=S.empty(),this.captured=S.empty(),this.rules=new Oi(as),this.availableMinimaxes=[new _lt(this.rules,"LinesOfActionMinimax")],this.encoder=A2.encoder,this.tutorial=(new rce).tutorial,this.updateBoard()}onClick(e,r){var s=this;return O(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new P(e,r);if(s.selected.equalsValue(o))return s.cancelMoveAttempt(),G.SUCCESS;const c=s.getState().getCurrentPlayer();return s.selected.isAbsent()||s.getState().getPieceAt(o)===c?s.select(o):s.concludeMove(o)})()}concludeMove(e){var r=this;return O(function*(){const s=A2.of(r.selected.get(),e);return s.isSuccess()?r.chooseMove(s.get(),r.rules.node.gameState):r.cancelMove(s.getReason())})()}select(e){var r=this;return O(function*(){return r.getState().getPieceAt(e)!==r.getState().getCurrentPlayer()?r.cancelMove(Mt.MUST_CHOOSE_PLAYER_PIECE()):(r.selected=S.of(e),r.targets=Oi.possibleTargets(r.getState(),r.selected.get()),0===r.targets.length?r.cancelMove(IV.PIECE_CANNOT_MOVE()):G.SUCCESS)})()}updateBoard(){if(this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){const e=this.lastMove.get();this.captured=this.getPreviousState().getPieceAt(e.end).isPlayer()?S.of(e.end):S.empty()}}cancelMoveAttempt(){this.selected=S.empty(),this.targets=[]}getSquareClasses(e,r){const s=new P(e,r);if(this.lastMove.isPresent()){const i=this.lastMove.get().coord,o=this.lastMove.get().end;if(this.captured.isPresent()&&s.equals(this.captured.get()))return["captured-fill"];if(s.equals(i)||s.equals(o))return["moved-fill"]}return[]}getPieceClasses(e,r){const s=this.board[r][e],i=new P(e,r),o=[this.getPlayerClass(s)];return this.selected.isPresent()&&this.selected.get().equals(i)&&o.push("selected-stroke"),o}}return n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-linesofaction"]],features:[l],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"indicator",3,"click"]],template:function(e,r){1&e&&(B(),N(0,"svg",0),k(1,ylt,2,1,"g",1),k(2,Elt,1,4,"rect",2),A()),2&e&&(M(1),w("ngForOf",r.board),M(1),w("ngForOf",r.targets))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class i4 extends Yc{constructor(t,e,r,s={top:0,bottom:0,left:0,right:0}){super(t.x,t.y),this.direction=e,this.orientation=r,this.captures=s}toString(){return`LodestoneMove(${this.coord.toString()}, ${this.direction}, ${this.orientation}, { top: ${this.captures.top}, bottom: ${this.captures.bottom}, left: ${this.captures.left}, right: ${this.captures.right} })`}equals(t){return this===t||!(!1===this.coord.equals(t.coord)||this.orientation!==t.orientation||this.direction!==t.direction||this.captures.top!==t.captures.top||this.captures.bottom!==t.captures.bottom||this.captures.left!==t.captures.left||this.captures.right!==t.captures.right)}}i4.encoder=new class extends e4{encodeMove(n){return{coord:P.encoder.encode(n.coord),direction:n.direction,orientation:n.orientation,captures:n.captures}}decodeMove(n){const t=n;return Se(null!=t.coord,"Invalid encoded LodestoneMove"),Se(null!=t.direction,"Invalid encoded LodestoneMove"),Se(null!=t.orientation,"Invalid encoded LodestoneMove"),Se(null!=t.captures,"Invalid encoded LodestoneMove"),new i4(P.encoder.decode(t.coord),t.direction,t.orientation,t.captures)}};let $f=(()=>{class n{}return n.MUST_FLIP_LODESTONE=()=>$localize`You must flip your lodestone before putting it back on the board.`,n.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES=()=>$localize`As long as there are pressure plates, you must place all the pieces that you have captured on them.`,n.TARGET_IS_CRUMBLED=()=>$localize`You must place your lodestone on a non-crumbled square!`,n.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE=()=>$localize`You placed too many captures on the same pressure plate, which has not enough space left.`,n.MUST_PLACE_CAPTURES=()=>$localize`You must place your captures on the pressure plates, on the side of the board.`,n.NO_CAPTURES_TO_PLACE_YET=()=>$localize`You cannot place any capture now, you must first place your lodestone on the board!`,n})();class Ii{constructor(t){this.unreachable=t}isLodestone(){return!1}isPlayerPiece(){return!1}isEmpty(){return!0}isUnreachable(){return this.unreachable}equals(t){return this===t}}Ii.UNREACHABLE=new Ii(!0),Ii.EMPTY=new Ii(!1);class cc{constructor(t){this.owner=t}static of(t){return t===F.ZERO?cc.ZERO:cc.ONE}isLodestone(){return!1}isPlayerPiece(){return!0}isEmpty(){return!1}isUnreachable(){return!1}equals(t){return this===t}}cc.ZERO=new cc(F.ZERO),cc.ONE=new cc(F.ONE);class uo{constructor(t,e,r){this.owner=t,this.direction=e,this.orientation=r}static of(t,e){return uo.LODESTONES[t.value][e.direction][e.orientation]}isLodestone(){return!0}isPlayerPiece(){return!1}isEmpty(){return!1}isUnreachable(){return!1}equals(t){return this===t}}uo.LODESTONES={0:{push:{diagonal:new uo(F.ZERO,"push","diagonal"),orthogonal:new uo(F.ZERO,"push","orthogonal")},pull:{diagonal:new uo(F.ZERO,"pull","diagonal"),orthogonal:new uo(F.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new uo(F.ONE,"push","diagonal"),orthogonal:new uo(F.ONE,"push","orthogonal")},pull:{diagonal:new uo(F.ONE,"pull","diagonal"),orthogonal:new uo(F.ONE,"pull","orthogonal")}}};class pr{constructor(t,e){this.width=t,this.pieces=e}remainingSpaces(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}addCaptured(t,e){if(this.pieces.length+e>=this.width)return 5===this.width?pr.EMPTY_3.addCaptured(t,e+this.pieces.length-5):(Se(this.pieces.length+e===3,"should never put more pieces than the plate can support"),S.empty());{const r=ht.copyImmutableArray(this.pieces);for(let s=0;s<e;s++)r.push(cc.of(t));return S.of(new pr(this.width,r))}}getPieceAt(t){return t<this.pieces.length?this.pieces[t]:Ii.EMPTY}}pr.POSITIONS=["top","bottom","left","right"],pr.EMPTY_5=new pr(5,[]),pr.EMPTY_3=new pr(3,[]);let Q1=(()=>{class n extends Vs{constructor(e,r,s,i){super(e,r),this.lodestones=s,this.pressurePlates=i}static getInitialState(){const e=Ii.EMPTY,r=cc.ZERO,s=cc.ONE;return new n([[e,e,r,s,r,s,e,e],[e,r,s,r,s,r,s,e],[r,s,r,s,r,s,r,s],[s,r,s,e,e,r,s,r],[r,s,r,e,e,s,r,s],[s,r,s,r,s,r,s,r],[e,s,r,s,r,s,r,e],[e,e,s,r,s,r,e,e]],0,new Qn,{top:S.of(pr.EMPTY_5),bottom:S.of(pr.EMPTY_5),left:S.of(pr.EMPTY_5),right:S.of(pr.EMPTY_5)})}withBoard(e){return new n(e,this.turn,this.lodestones,this.pressurePlates)}remainingSpaces(){const e=this.remainingSpacesDetails();return e.top+e.bottom+e.left+e.right}remainingSpacesDetails(){const e={top:0,bottom:0,left:0,right:0};for(const r of pr.POSITIONS){const s=this.pressurePlates[r];s.isPresent()&&(e[r]=s.get().remainingSpaces())}return e}numberOfPieces(){const e=[0,0];for(let r=0;r<n.SIZE;r++)for(let s=0;s<n.SIZE;s++){const i=this.getPieceAtXY(s,r);i.isPlayerPiece()&&(e[i.owner.value]+=1)}return e}getScores(){const e=this.numberOfPieces();return[24-e[1],24-e[0]]}nextLodestoneDirection(){const e=this.getCurrentPlayer(),r=this.lodestones.get(e);if(!r.isPresent())return S.empty();{const s=this.getPieceAt(r.get());switch(Se(s.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+r.get()),s.direction){case"push":return S.of("pull");case"pull":return S.of("push")}}}}return n.SIZE=8,n})();class ui extends hr{constructor(){super(Q1)}static get(){return ui.singleton.isAbsent()&&(ui.singleton=S.of(new ui)),ui.singleton.get()}applyLegalMove(t,e,r){const s=e.getCurrentPlayer(),i=s.getOpponent(),o=ht.copyBiArray(r.board),c=e.lodestones.getCopy();c.put(s,t.coord);const u={...e.pressurePlates};return this.updatePressurePlates(o,u,c,i,t.captures),new Q1(o,e.turn+1,c,u)}updatePressurePlates(t,e,r,s,i){for(const o of pr.POSITIONS)e[o]=this.updatePressurePlate(t,o,e[o],r,s,i[o])}updatePressurePlate(t,e,r,s,i,o){if(r.isPresent()){const c=r.get().addCaptured(i,o),u=ui.THREATENED_COORD_RANGE.get(e).get();return c.isAbsent()?(this.removePressurePlate(t,u.startForBigPlate,u.direction,s),this.removePressurePlate(t,u.startForSmallPlate,u.direction,s)):c.get().width<r.get().width&&this.removePressurePlate(t,u.startForBigPlate,u.direction,s),c}return r}removePressurePlate(t,e,r,s){for(let i=e;i.isInRange(Q1.SIZE,Q1.SIZE);i=i.getNext(r)){for(const o of F.PLAYERS)s.get(o).equalsValue(i)&&s.delete(o);t[i.y][i.x]=Ii.UNREACHABLE}}isLegal(t,e){const r=this.isLegalWithoutCaptures(e,t.coord,t.direction);if(r.isFailure())return K.failure(r.getReason());const s=this.applyMoveWithoutPlacingCaptures(e,t.coord,t);if(t.captures.top+t.captures.bottom+t.captures.left+t.captures.right!==Math.min(s.captures.length,e.remainingSpaces()))return K.failure($f.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());for(const c of pr.POSITIONS){const u=e.pressurePlates[c];if(u.isPresent()&&u.get().remainingSpaces()<t.captures[c])return K.failure($f.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}return K.success(s)}applyMoveWithoutPlacingCaptures(t,e,r){let s;const i=ht.copyBiArray(t.board),o=t.lodestones.get(t.getCurrentPlayer());if(o.isPresent()){const c=o.get();i[c.y][c.x]=Ii.EMPTY}return s="pull"===r.direction?this.applyPull(t,i,e,r.orientation):this.applyPush(t,i,e,r.orientation),s.board[e.y][e.x]=uo.of(t.getCurrentPlayer(),r),s.moved.push(e),s}applyPull(t,e,r,s){const i=t.getCurrentPlayer(),o=i.getOpponent(),c=[],u=[],h="diagonal"===s?Pe.DIAGONALS:Pe.ORTHOGONALS;for(const g of h)for(let m=r.getNext(g);t.isOnBoard(m);m=m.getNext(g)){const v=e[m.y][m.x],T=m.getNext(g);if(t.isOnBoard(T)){const I=e[T.y][T.x];I.isPlayerPiece()&&I.owner===i&&(v.isEmpty()?(u.push(m),e[m.y][m.x]=I,u.push(T),e[T.y][T.x]=Ii.EMPTY):v.isPlayerPiece()&&v.owner===o&&(c.push(m),e[m.y][m.x]=I,u.push(T),e[T.y][T.x]=Ii.EMPTY))}}return{board:e,captures:c,moved:u}}applyPush(t,e,r,s){const o=t.getCurrentPlayer().getOpponent(),c=[],u=[],h="diagonal"===s?Pe.DIAGONALS:Pe.ORTHOGONALS;for(const g of h)for(let v=r.getNext(g,Q1.SIZE);!1===v.equals(r);v=v.getPrevious(g))if(t.isOnBoard(v)){const T=e[v.y][v.x];if(T.isPlayerPiece()&&T.owner===o){const I=v.getNext(g);if(t.isOnBoard(I)){const z=e[I.y][I.x];z.isUnreachable()?(c.push(v),e[v.y][v.x]=Ii.EMPTY):z.isEmpty()&&(u.push(I),e[I.y][I.x]=T,u.push(v),e[v.y][v.x]=Ii.EMPTY)}else c.push(v),e[v.y][v.x]=Ii.EMPTY}}return{board:e,captures:c,moved:u}}isLegalWithoutCaptures(t,e,r){const s=this.isTargetLegal(t,e);if(s.isFailure())return s;const i=t.nextLodestoneDirection();return!1===(i.isAbsent()||i.equalsValue(r))?G.failure($f.MUST_FLIP_LODESTONE()):G.SUCCESS}isTargetLegal(t,e){const r=t.getPieceAt(e);if(r.isUnreachable())return G.failure($f.TARGET_IS_CRUMBLED());if(r.isPlayerPiece())return G.failure(Mt.MUST_CLICK_ON_EMPTY_SQUARE());const s=t.getCurrentPlayer();return r.isLodestone()&&r.owner!==s?G.failure(Mt.MUST_CLICK_ON_EMPTY_SQUARE()):G.SUCCESS}getGameStatus(t){const r=t.gameState.numberOfPieces();return 0===r[0]&&0===r[1]?ze.DRAW:0===r[0]?ze.ONE_WON:0===r[1]?ze.ZERO_WON:ze.ONGOING}}ui.THREATENED_COORD_RANGE=Qn.from({top:{startForBigPlate:new P(0,0),startForSmallPlate:new P(0,1),direction:Pe.RIGHT},bottom:{startForBigPlate:new P(0,Q1.SIZE-1),startForSmallPlate:new P(0,Q1.SIZE-2),direction:Pe.RIGHT},left:{startForBigPlate:new P(0,0),startForSmallPlate:new P(1,0),direction:Pe.DOWN},right:{startForBigPlate:new P(Q1.SIZE-1,0),startForSmallPlate:new P(Q1.SIZE-2,0),direction:Pe.DOWN}}),ui.singleton=S.empty();class Slt extends rr{getListMoves(t){const e=t.gameState;return this.flatMapEmptyCoords(e,r=>{const s=[];for(const i of this.nextDirection(e)){const o=["diagonal","orthogonal"];for(const c of o){const g=ui.get().applyMoveWithoutPlacingCaptures(e,r,{direction:i,orientation:c}).captures.length;for(const m of this.captureCombinations(e,g))s.push(new i4(r,i,c,m))}}return s})}captureCombinations(t,e){if(0===e)return new Z1([{top:0,bottom:0,left:0,right:0}]);{const r=new Z1,s=t.remainingSpacesDetails(),i=this.captureCombinations(t,e-1);for(const o of i)o.top+1<=s.top&&r.add({...o,top:o.top+1}),o.bottom+1<=s.bottom&&r.add({...o,bottom:o.bottom+1}),o.left+1<=s.left&&r.add({...o,left:o.left+1}),o.right+1<=s.right&&r.add({...o,right:o.right+1});return 0===r.size()?i:r}}flatMapEmptyCoords(t,e){let r=[];for(let s=0;s<Q1.SIZE;s++)for(let i=0;i<Q1.SIZE;i++){const o=new P(i,s),c=t.getPieceAt(o);(c.isEmpty()&&!1===c.isUnreachable()||c.isLodestone()&&c.owner===t.getCurrentPlayer())&&(r=r.concat(e(o)))}return r}nextDirection(t){const e=t.nextLodestoneDirection();return e.isPresent()?[e.get()]:["push","pull"]}getBoardValue(t){const e=t.gameState.getScores();let r;return r=24===e[0]&&24!==e[1]?F.ZERO.getVictoryValue():24!==e[0]&&24===e[1]?F.ONE.getVictoryValue():e[0]*F.ZERO.getScoreModifier()+e[1]*F.ONE.getScoreModifier(),new dt(r)}}const $e=Ii.UNREACHABLE,oe=Ii.EMPTY,cs=cc.ZERO,xi=cc.ONE,om=uo.of(F.ONE,{direction:"push",orientation:"orthogonal"}),xV={top:S.of(pr.EMPTY_5),bottom:S.of(pr.EMPTY_5),left:S.of(pr.EMPTY_5),right:S.of(pr.EMPTY_5)};class sce extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Board and aim of the game`,$localize`Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone.`,Q1.getInitialState()),pe.forClick($localize`Selecting a lodestone`,$localize`To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally.`,Q1.getInitialState(),["#lodestone_push_diagonal"],$localize`Congratulations!`,$localize`This is not the right lodestone, try again.`),pe.informational($localize`The repelling lodestone`,$localize`Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured.`,Q1.getInitialState()),pe.informational($localize`The attracting lodestone`,$localize`When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it.`,Q1.getInitialState()),pe.informational($localize`Flipping the lodestone`,$localize`Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn.`,Q1.getInitialState()),pe.fromPredicate($localize`Capturing`,$localize`To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates.`,Q1.getInitialState(),new i4(new P(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),(t,e,r)=>32===r.remainingSpaces()?G.failure($localize`You have not captured any of the opponent's pieces, try again!`):G.SUCCESS,"Congratulations!"),pe.fromPredicate($localize`Crumbling a first pressure plate`,$localize`When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble.`,new Q1([[oe,oe,oe,oe,xi,oe,oe,oe],[oe,oe,cs,oe,oe,xi,oe,oe],[oe,oe,om,oe,oe,oe,oe,cs],[oe,oe,oe,oe,xi,oe,oe,cs],[oe,oe,oe,oe,oe,cs,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe]],0,new Qn([{key:F.ONE,value:new P(2,2)}]),{...xV,top:pr.EMPTY_5.addCaptured(F.ONE,4)}),new i4(new P(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),(t,e,r)=>5===r.pressurePlates.top.get().width?G.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble!`):G.SUCCESS,"Congratulations!"),pe.fromPredicate($localize`Crumbling a second pressure plate`,$localize`Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble.`,new Q1([[$e,$e,$e,$e,$e,$e,$e,$e],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,cs],[oe,oe,oe,oe,oe,cs,oe,cs],[oe,om,oe,oe,xi,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,xi,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe]],0,new Qn([{key:F.ONE,value:new P(1,4)}]),{...xV,top:pr.EMPTY_3.addCaptured(F.ONE,2)}),new i4(new P(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),(t,e,r)=>r.pressurePlates.top.isPresent()?G.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble a second time!`):G.SUCCESS,"Congratulations!"),pe.informational($localize`Minimal board`,$localize`After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board.`,new Q1([[$e,$e,$e,$e,$e,$e,$e,$e],[$e,$e,$e,$e,$e,$e,$e,$e],[$e,$e,cs,xi,oe,oe,$e,$e],[$e,$e,om,xi,oe,oe,$e,$e],[$e,$e,oe,cs,cs,oe,$e,$e],[$e,$e,cs,oe,oe,oe,$e,$e],[$e,$e,$e,$e,$e,$e,$e,$e],[$e,$e,$e,$e,$e,$e,$e,$e]],0,new Qn([{key:F.ONE,value:new P(2,3)}]),{top:S.empty(),bottom:S.empty(),left:S.empty(),right:S.empty()})),pe.fromMove($localize`Making the lodestone fall`,$localize`If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!`,new Q1([[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,xi,oe,oe],[oe,oe,oe,om,oe,oe,cs,oe],[oe,oe,cs,cs,xi,oe,oe,cs],[oe,oe,oe,oe,oe,cs,oe,oe],[oe,oe,cs,oe,oe,oe,oe,oe],[oe,oe,xi,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe]],0,new Qn([{key:F.ONE,value:new P(3,2)}]),{...xV,top:pr.EMPTY_5.addCaptured(F.ONE,4)}),[new i4(new P(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize`Congratulations! At your next turn, you will be allowed to place your lodestone on any side.`,$localize`Failed, try again.`),pe.fromMove($localize`End of the game`,$localize`In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!`,new Q1([[$e,$e,$e,$e,$e,$e,$e,$e],[$e,$e,$e,$e,$e,$e,$e,$e],[$e,xi,cs,xi,oe,oe,$e,$e],[$e,xi,om,oe,xi,oe,$e,$e],[$e,oe,oe,cs,cs,oe,$e,$e],[$e,xi,cs,oe,xi,oe,$e,$e],[$e,oe,oe,oe,cs,oe,$e,$e],[$e,$e,$e,$e,$e,$e,$e,$e]],0,new Qn([{key:F.ONE,value:new P(2,3)}]),{top:S.empty(),bottom:pr.EMPTY_3.addCaptured(F.ZERO,2),left:S.of(pr.EMPTY_3),right:S.empty()}),[new i4(new P(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize`Congratulations, you won!`,$localize`This is not the winning move. Try again.`)]}}function Plt(n,t){if(1&n&&(B(),X(0,"circle",10)),2&n){const e=E(2),r=e.index,s=e.$implicit,i=E().index,o=E();je("id","piece_",r,"_",i,""),w("ngClass",s.pieceClasses),V("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Tlt(n,t){if(1&n&&(B(),X(0,"polygon",15)),2&n){const e=E().$implicit,r=E(3).$implicit,s=E(2);wu("transform","rotate(",90*e,")"),w("ngClass",r.lodestone.movingClass),V("points",s.TRIANGLE_OUT)}}function wlt(n,t){if(1&n&&(B(),X(0,"polygon",15)),2&n){const e=E().$implicit,r=E(3).$implicit,s=E(2);wu("transform","rotate(",90*e,")"),w("ngClass",r.lodestone.movingClass),V("points",s.TRIANGLE_IN)}}function blt(n,t){if(1&n&&(B(),N(0,"g"),k(1,Tlt,1,3,"polygon",14),k(2,wlt,1,3,"polygon",14),A()),2&n){const e=E(3).$implicit;M(1),w("ngIf","push"===e.lodestone.direction),M(1),w("ngIf","pull"===e.lodestone.direction)}}const ice=function(){return[0,1,2,3]};function Nlt(n,t){if(1&n&&(B(),N(0,"g",11),X(1,"circle",12)(2,"circle",13),N(3,"g"),k(4,blt,3,2,"g",1),A()()),2&n){const e=E(2),r=e.index,s=e.$implicit,i=E().index,o=E();V("transform",o.getSquareTransform(r,i)),M(1),w("ngClass",s.lodestone.selectedClass),V("r",o.PIECE_RADIUS),M(1),w("ngClass",s.lodestone.pieceClasses),V("r",o.PIECE_RADIUS/4),M(1),wu("transform","rotate(","diagonal"===s.lodestone.orientation?45:0,")"),M(1),w("ngForOf",ar(7,ice))}}function Alt(n,t){if(1&n){const e=we();B(),N(0,"g",6),se("click",function(){he(e);const s=E().$implicit;return ce(E(2).selectCoord(s.coord))}),X(1,"rect",7),k(2,Plt,1,6,"circle",8),k(3,Nlt,5,8,"g",9),A()}if(2&n){const e=E(),r=e.index,s=e.$implicit,i=E().index,o=E();je("id","square_",r,"_",i,""),M(1),w("ngClass",s.squareClasses),V("x",o.SPACE_SIZE*r+o.STROKE_WIDTH)("y",o.SPACE_SIZE*i+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),M(1),w("ngIf",s.hasPiece),M(1),w("ngIf",s.lodestone)}}function Olt(n,t){if(1&n&&(B(),N(0,"g"),k(1,Alt,4,9,"g",5),A()),2&n){const e=t.$implicit;M(1),w("ngIf",!1===e.crumbled)}}function Ilt(n,t){if(1&n&&(B(),N(0,"g"),k(1,Olt,2,1,"g",1),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}function xlt(n,t){if(1&n&&(B(),N(0,"g",16),X(1,"circle",17),A()),2&n){const e=t.$implicit,r=t.index,s=E();L1("id","capture_",r,""),V("transform",s.getCaptureTransform(r)),M(1),w("ngClass",e.pieceClasses),V("r",s.PIECE_RADIUS)}}function Llt(n,t){if(1&n&&(B(),N(0,"g"),X(1,"polygon",15),A()),2&n){const e=t.$implicit,r=E().$implicit,s=E();M(1),wu("transform","rotate(",90*e,")"),w("ngClass",r.movingClass),V("points","push"===r.direction?s.TRIANGLE_OUT:s.TRIANGLE_IN)}}function klt(n,t){if(1&n){const e=we();B(),N(0,"g",6),se("click",function(){const i=he(e).$implicit;return ce(E().selectLodestone(i))}),X(1,"circle",12)(2,"circle",13),N(3,"g"),k(4,Llt,2,3,"g",1),A()()}if(2&n){const e=t.$implicit,r=t.index,s=E();je("id","lodestone_",e.direction,"_",e.orientation,""),V("transform",s.getAvailableLodestoneTransform(r)),M(1),w("ngClass",e.selectedClass),V("r",s.PIECE_RADIUS),M(1),w("ngClass",e.pieceClasses),V("r",s.PIECE_RADIUS/4),M(1),wu("transform","rotate(","diagonal"===e.orientation?45:0,")"),M(1),w("ngForOf",ar(9,ice))}}function Rlt(n,t){if(1&n&&(B(),X(0,"circle",10)),2&n){const e=E(),r=e.index,s=e.$implicit,i=E().$implicit,o=E();je("id","platePiece_",i.position,"_",r,""),w("ngClass",s.pieceClasses),V("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*s.coord.x+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s.coord.y+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Dlt(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"g",6),se("click",function(){const s=he(e),i=s.$implicit,o=s.index,c=E().$implicit;return ce(E().onPressurePlateClick(i.temporary,c.position,o))}),X(2,"rect",18),k(3,Rlt,1,6,"circle",8),A()()}if(2&n){const e=t.$implicit,r=t.index,s=E().$implicit,i=E();V("transform",i.getPressurePlateTransform(s.position)),M(1),je("id","plate_",s.position,"_",r,""),M(1),je("id","plateSquare_",s.position,"_",r,""),w("ngClass",e.squareClasses),V("x",i.SPACE_SIZE*e.coord.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*e.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),M(1),w("ngIf",e.hasPiece)}}function zlt(n,t){if(1&n&&(B(),N(0,"g",16),k(1,Dlt,4,11,"g",1),A()),2&n){const e=t.$implicit;L1("id","pressurePlate_",e.position,""),M(1),w("ngForOf",e.coords)}}function Vlt(n,t){if(1&n&&(B(),X(0,"rect",19)),2&n){const e=E();je("id","selection_",e.viewInfo.selected.get().x,"_",e.viewInfo.selected.get().y,""),V("x",e.SPACE_SIZE*e.viewInfo.selected.get().x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.viewInfo.selected.get().y+e.STROKE_WIDTH)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}class fi extends m0{constructor(t){super(t),this.viewInfo={availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:S.empty(),pressurePlateShift:{top:new Un(0,0),left:new Un(0,0),right:new Un(0,0),bottom:new Un(0,0)}},this.stateAfterPlacingLodestone=S.empty(),this.lastInfos=S.empty(),this.capturesToPlace=0,this.selectedCoord=S.empty(),this.selectedLodestone=S.empty(),this.captures={top:0,bottom:0,left:0,right:0},this.rules=ui.get(),this.tutorial=(new sce).tutorial,this.availableMinimaxes=[new Slt(this.rules,"LodestoneDummyMinimax")],this.encoder=i4.encoder,this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH);const e=.8*this.PIECE_RADIUS,r=.3*this.PIECE_RADIUS,s=.2*this.PIECE_RADIUS;this.TRIANGLE_OUT=`${e},0 ${r},${s} ${r},-${s}`,this.TRIANGLE_IN=`${r},0 ${e},${r} ${e},-${r}`,this.displayedState=this.getState(),this.scores=S.of([0,0])}ngOnInit(){this.updateBoard()}selectCoord(t){var e=this;return O(function*(){const r=e.canUserPlay("#square_"+t.x+"_"+t.y);if(r.isFailure())return e.cancelMove(r.getReason());if(e.capturesToPlace>0)return e.cancelMove($f.MUST_PLACE_CAPTURES());const s=ui.get().isTargetLegal(e.getState(),t);return s.isFailure()?e.cancelMove(s.getReason()):e.selectedCoord.equalsValue(t)?(e.cancelMoveAttempt(),G.SUCCESS):(e.selectedCoord=S.of(t),e.selectedLodestone.isPresent()?e.putLodestone():(e.updateViewInfo(),G.SUCCESS))})()}selectLodestone(t){var e=this;return O(function*(){const r=e.canUserPlay("#lodestone_"+t.direction+"_"+t.orientation);if(r.isFailure())return e.cancelMove(r.getReason());Se(0===e.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed");const s=e.getCurrentPlayer(),i=uo.of(s,t);return e.selectedLodestone.equalsValue(i)?(e.cancelMoveAttempt(),G.SUCCESS):(e.selectedLodestone=S.of(i),e.selectedCoord.isPresent()?e.putLodestone():(e.updateViewInfo(),G.SUCCESS))})()}putLodestone(){var t=this;return O(function*(){Se(t.selectedCoord.isPresent(),"coord should have been selected"),Se(t.selectedLodestone.isPresent(),"lodestone should have been selected");const e=t.selectedCoord.get(),r=t.selectedLodestone.get(),s=t.getState();Se(ui.get().isLegalWithoutCaptures(s,e,r.direction).isSuccess(),"Lodestone component should only allow creation of legal moves");const o=ui.get().applyMoveWithoutPlacingCaptures(s,e,r);return t.lastInfos=S.of(o),t.capturesToPlace=Math.min(o.captures.length,s.remainingSpaces()),0===t.capturesToPlace?t.applyMove():(t.displayedState=t.displayedState.withBoard(o.board),t.stateAfterPlacingLodestone=S.of(t.displayedState),t.updateViewInfo(),G.SUCCESS)})()}applyMove(){var t=this;return O(function*(){Se(t.selectedCoord.isPresent(),"coord should have been selected"),Se(t.selectedLodestone.isPresent(),"lodestone should have been selected");const e=t.selectedCoord.get(),r=t.selectedLodestone.get(),s=new i4(e,r.direction,r.orientation,t.captures);return t.chooseMove(s,t.getState())})()}onPressurePlateClick(t,e,r){return t?this.deselectPressurePlate(e,r):this.selectPressurePlate(e,r)}selectPressurePlate(t,e){var r=this;return O(function*(){const s=r.canUserPlay("#plate_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(0===r.capturesToPlace)return r.cancelMove($f.NO_CAPTURES_TO_PLACE_YET());r.capturesToPlace--,r.captures[t]++;const i=r.stateAfterPlacingLodestone.get(),o=r.getCurrentPlayer().getOpponent(),c=ht.copyBiArray(i.board),u={...i.pressurePlates},h=i.lodestones.getCopy();return ui.get().updatePressurePlates(c,u,h,o,r.captures),r.displayedState=new Q1(c,i.turn,h,u),0===r.capturesToPlace?r.applyMove():(r.updateViewInfo(),r.showPressurePlateDifferences(r.getState(),r.displayedState,!0),G.SUCCESS)})()}deselectPressurePlate(t,e){var r=this;return O(function*(){const s=r.canUserPlay("#plate_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());r.capturesToPlace++,r.captures[t]--;const i=r.stateAfterPlacingLodestone.get(),o=r.getCurrentPlayer().getOpponent(),c=ht.copyBiArray(i.board),u={...i.pressurePlates},h=i.lodestones.getCopy();return ui.get().updatePressurePlates(c,u,h,o,r.captures),r.displayedState=new Q1(c,i.turn,h,u),r.updateViewInfo(),r.showPressurePlateDifferences(r.getState(),r.displayedState,!0),G.SUCCESS})()}updateBoard(){this.cancelMoveAttempt(),this.rules.node.move.isPresent()&&this.showLastMove(),this.scores=S.of(this.getState().getScores())}cancelMoveAttempt(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=S.empty(),this.lastInfos=S.empty();const t=this.displayedState.lodestones.get(this.getCurrentPlayer());if(t.isPresent()){const e=ht.copyBiArray(this.displayedState.board);e[t.get().y][t.get().x]=Ii.EMPTY,this.displayedState=this.displayedState.withBoard(e)}this.selectedCoord=S.empty(),this.selectedLodestone=S.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}updateViewInfo(){const e=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(e),this.viewInfo.opponentClass=this.getPlayerClass(e.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}showBoard(){this.viewInfo.boardInfo=[];for(let t=0;t<Q1.SIZE;t++){this.viewInfo.boardInfo.push([]);for(let e=0;e<Q1.SIZE;e++){const r=new P(e,t);this.viewInfo.boardInfo[t].push(this.getSquareInfo(r))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:S.empty()}getSquareInfo(t){const e=this.displayedState.getPieceAt(t),r={coord:t,squareClasses:[],crumbled:e.isUnreachable(),hasPiece:e.isPlayerPiece(),pieceClasses:[]};return e.isPlayerPiece()&&(r.pieceClasses=[this.getPlayerClass(e.owner)]),e.isLodestone()&&(r.lodestone={direction:e.direction,pieceClasses:[this.getPlayerClass(e.owner)],selectedClass:"",movingClass:"",orientation:e.orientation},r.lodestone.movingClass=this.getPlayerClass("push"===e.direction?e.owner.getOpponent():e.owner)),r}showAvailableLodestones(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{const t=this.getState().getCurrentPlayer(),e=this.getState().nextLodestoneDirection();if(e.isPresent()){const r=e.get();this.viewInfo.availableLodestones=[this.nextLodestone(t,{direction:r,orientation:"orthogonal"}),this.nextLodestone(t,{direction:r,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(t,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(t,{direction:"push",orientation:"diagonal"}),this.nextLodestone(t,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(t,{direction:"pull",orientation:"diagonal"})]}}showCapturesToPlace(){const t=this.getCurrentPlayer().getOpponent();this.viewInfo.capturesToPlace=[];for(let e=0;e<this.capturesToPlace;e++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(t)]})}nextLodestone(t,e){const r=uo.of(t,e),s={direction:r.direction,orientation:r.orientation,pieceClasses:[this.getPlayerClass(r.owner)],movingClass:"",selectedClass:""};return s.movingClass=this.getPlayerClass("push"===r.direction?r.owner.getOpponent():r.owner),this.selectedLodestone.equalsValue(r)&&(s.selectedClass="selected-stroke"),s}showPressurePlates(){this.viewInfo.pressurePlates=[];for(const t of pr.POSITIONS){const e=[],r=this.displayedState.pressurePlates[t];if(r.isPresent()){const s=fi.PRESSURE_PLATES_POSITIONS.get(t).get(),i=r.get().width;let o=5===i?s.startForBigPlate:s.startForSmallPlate;for(let c=0;c<i;c++){o=o.getNext(s.direction);const u=r.get().getPieceAt(c);let h="";u.isPlayerPiece()&&(h=this.getPlayerClass(u.owner)),e.push({coord:o,hasPiece:u.isPlayerPiece(),pieceClasses:[h],squareClasses:[],temporary:!1})}}this.viewInfo.pressurePlates.push({position:t,coords:e})}}showLastMove(){const t=this.rules.node.mother.get().gameState,e=this.rules.node.move.get();this.lastInfos=S.of(ui.get().applyMoveWithoutPlacingCaptures(t,e.coord,e)),this.updateViewInfo();const r=this.getState();this.showPressurePlateDifferences(t,r,!1)}showPressurePlateDifferences(t,e,r){for(const s of pr.POSITIONS)this.showPressurePlateDifference(t.pressurePlates[s],e.pressurePlates[s],s,r)}showPressurePlateDifference(t,e,r,s){if(t.isPresent()&&e.isPresent()){const i=t.get(),o=e.get(),c=Ae.getNonNullable(this.viewInfo.pressurePlates.find(u=>u.position===r));if(i.width===o.width)for(let u=0;u<o.width;u++){const h=i.getPieceAt(u),g=o.getPieceAt(u);!1===h.equals(g)&&(c.coords[u].squareClasses.push("moved-fill"),c.coords[u].temporary=s,s&&c.coords[u].pieceClasses.push("semi-transparent"))}else for(const u of c.coords)u.squareClasses.push("moved-fill")}}showMovedAndCaptured(t){for(const e of t.moved)this.viewInfo.boardInfo[e.y][e.x].squareClasses.push("moved-fill");for(const e of t.captures)this.viewInfo.boardInfo[e.y][e.x].squareClasses.push("captured-fill")}computePressurePlateShift(){const t=this.displayedState,e=this.getPressurePlateShift(t.pressurePlates.left),r=this.getPressurePlateShift(t.pressurePlates.right),s=this.getPressurePlateShift(t.pressurePlates.top),i=this.getPressurePlateShift(t.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new P(.5*(e-r),0),this.viewInfo.pressurePlateShift.bottom=new P(.5*(e-r),0),this.viewInfo.pressurePlateShift.left=new P(0,.5*(s-i)),this.viewInfo.pressurePlateShift.right=new P(0,.5*(s-i))}getPressurePlateShift(t){return t.isAbsent()?2:3===t.get().width?1:0}getSquareTransform(t,e){return`translate(${t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2}, ${e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getCaptureTransform(t){return`translate(${(t+(Q1.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getAvailableLodestoneTransform(t){return`translate(${(t+(Q1.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getPressurePlateTransform(t){return`translate(${this.viewInfo.pressurePlateShift[t].x*this.SPACE_SIZE}, ${this.viewInfo.pressurePlateShift[t].y*this.SPACE_SIZE})`}}fi.PRESSURE_PLATE_EXTRA_SHIFT=.2,fi.PRESSURE_PLATES_POSITIONS=Qn.from({top:{startForBigPlate:new P(.5,-1-fi.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new P(1.5,0-fi.PRESSURE_PLATE_EXTRA_SHIFT),direction:Pe.RIGHT},bottom:{startForBigPlate:new P(.5,8+fi.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new P(1.5,7+fi.PRESSURE_PLATE_EXTRA_SHIFT),direction:Pe.RIGHT},left:{startForBigPlate:new P(-1-fi.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new P(0-fi.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Pe.DOWN},right:{startForBigPlate:new P(8+fi.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new P(7+fi.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Pe.DOWN}}),fi.\u0275fac=function(t){return new(t||fi)(Q(In))},fi.\u0275cmp=vt({type:fi,selectors:[["app-lodestone"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(t,e){1&t&&(B(),N(0,"svg",0),k(1,Ilt,2,1,"g",1),k(2,xlt,2,4,"g",2),k(3,klt,5,10,"g",3),k(4,zlt,2,2,"g",2),k(5,Vlt,1,6,"rect",4),A()),2&t&&(M(1),w("ngForOf",e.viewInfo.boardInfo),M(1),w("ngForOf",e.viewInfo.capturesToPlace),M(1),w("ngForOf",e.viewInfo.availableLodestones),M(1),w("ngForOf",e.viewInfo.pressurePlates),M(1),w("ngIf",e.viewInfo.selected.isPresent()))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let jS=(()=>{class n{}return n.START_COORD_OUT_OF_RANGE=()=>$localize`Start coord cannot be out of range`,n.END_COORD_OUT_OF_RANGE=()=>$localize`End coord cannot be out of range`,n.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP=()=>$localize`Pawns must move one step diagonally.`,n.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS=()=>$localize`Drones must move one or two steps in any direction.`,n})();class ls extends tc{constructor(t,e,r){super(t,e),this.calledTheClock=r}static from(t,e,r=!1){if(t.isNotInRange(4,8))return K.failure(jS.START_COORD_OUT_OF_RANGE());if(e.isNotInRange(4,8))return K.failure(jS.END_COORD_OUT_OF_RANGE());if(e.equals(t))return K.failure(Mt.MOVE_CANNOT_BE_STATIC());const s=Pe.factory.fromDelta(e.x-t.x,e.y-t.y);return s.isFailure()?K.failure(s.getReason()):K.success(new ls(t,e,r))}toString(){return"MartianChessMove(("+this.coord.x+", "+this.coord.y+") -> ("+this.end.x+", "+this.end.y+")"+(this.calledTheClock?", CALL_THE_CLOCK":"")+")"}equals(t){return!1!==this.coord.equals(t.coord)&&!1!==this.end.equals(t.end)&&this.calledTheClock===t.calledTheClock}isValidForPawn(){const t=Math.abs(this.coord.x-this.end.x),e=Math.abs(this.coord.y-this.end.y);return 1===t&&1===e}isValidForDrone(){return this.coord.getDistance(this.end)<=2}isUndoneBy(t){if(t.isAbsent())return!1;const e=t.get();return e.end.equals(this.coord)&&e.coord.equals(this.end)}}ls.encoder=on.tuple([P.numberEncoder(4,8),P.numberEncoder(4,8),on.booleanEncoder],n=>[n.coord,n.end,n.calledTheClock],n=>ls.from(n[0],n[1],n[2]).get());class kt{constructor(t){this.value=t}static tryMerge(t,e){Se(t!==kt.EMPTY&&e!==kt.EMPTY,"tryMerge cannot be called with empty pieces");const s=t.value+e.value;return 2===s||3===s?S.of(kt.from(s)):S.empty()}static from(t){return t===kt.DRONE.value?kt.DRONE:(Ae.expectToBe(t,kt.QUEEN.value),kt.QUEEN)}getValue(){return this.value}equals(t){return this.getValue()===t.getValue()}}kt.EMPTY=new kt(0),kt.PAWN=new kt(1),kt.DRONE=new kt(2),kt.QUEEN=new kt(3);class Hlt extends rr{constructor(t,e){super(t,e),this.ruler=t}getListMoves(t){const e=t.gameState,r=e.getCurrentPlayer(),s=e.getPlayerTerritory(r);let i=[];for(const o of s)for(let c=0;c<4;c++)switch(e.getPieceAtXY(c,o)){case kt.PAWN:i=i.concat(this.getMovesForPawnAt(e,c,o));break;case kt.DRONE:i=i.concat(this.getMovesForDroneAt(e,c,o));break;case kt.QUEEN:i=i.concat(this.getMovesForQueenAt(e,c,o))}return i}getMovesForPawnAt(t,e,r){const s=new P(e,r),i=[];for(const o of Pe.DIAGONALS){const c=s.getNext(o);c.isInRange(4,8)&&i.push(c)}return this.addLegalMoves(t,s,i)}addLegalMoves(t,e,r){const s=[],i=t.getPieceAt(e),o=!1===t.isTherePieceOnPlayerSide(kt.DRONE),c=!1===t.isTherePieceOnPlayerSide(kt.QUEEN),u=t.lastMove;for(const h of r){const g=t.getPieceAt(h);if(g===kt.EMPTY)this.add(s,ls.from(e,h).get(),u);else if(t.isInPlayerTerritory(h)){const m=kt.tryMerge(g,i);if(m.isPresent()){const v=m.get(),T=ls.from(e,h).get();(v===kt.DRONE&&o||v===kt.QUEEN&&c)&&this.add(s,T,u)}}else this.add(s,ls.from(e,h).get(),u)}return s}add(t,e,r){!1===e.isUndoneBy(r)&&t.push(e)}getMovesForDroneAt(t,e,r){const s=new P(e,r),i=this.getLandingCoordsForLinearMove(s,t,2);return this.addLegalMoves(t,s,i)}getLandingCoordsForLinearMove(t,e,r){const s=[];for(const i of Pe.DIRECTIONS){let o=1,c=t.getNext(i,o),u=e.tryToGetPieceAt(c),h=u.equalsValue(kt.EMPTY);for(;h;)s.push(c),o++,c=t.getNext(i,o),u=e.tryToGetPieceAt(c),h=u.equalsValue(kt.EMPTY)&&o<r;u.isPresent()&&s.push(c)}return s}getMovesForQueenAt(t,e,r){const s=new P(e,r),i=this.getLandingCoordsForQueen(s,t);return this.addLegalMoves(t,s,i)}getLandingCoordsForQueen(t,e){return this.getLandingCoordsForLinearMove(t,e,8)}getBoardValue(t){const e=this.ruler.getGameStatus(t);let r;if(e.isEndGame)r=e.toBoardValue();else{const s=t.gameState.getScoreOf(F.ZERO);r=t.gameState.getScoreOf(F.ONE)-s}return new dt(r)}}class H8{constructor(t){this.captures=t,t.makeImmutable()}static from(t){const e=new Qn;for(const r of t)H8.addToMap(e,r);return new H8(e)}static addToMap(t,e){const r=t.get(e);r.isPresent()?t.replace(e,r.get()+1):t.set(e,1)}toValue(){let t=0;return this.captures.forEach(e=>{t+=e.key.getValue()*e.value}),t}add(t){const e=this.captures.getCopy();return H8.addToMap(e,t),new H8(e)}}class Ps extends Vs{constructor(t,e,r=S.empty(),s=S.empty(),i){super(t,e),this.lastMove=r,this.countDown=s,null==i&&(i=new Qn([{key:F.ZERO,value:H8.from([])},{key:F.ONE,value:H8.from([])}])),i.makeImmutable(),this.captured=i}static getInitialState(){const t=kt.EMPTY,e=kt.PAWN,r=kt.DRONE,s=kt.QUEEN;return new Ps([[s,s,r,t],[s,r,e,t],[r,e,e,t],[t,t,t,t],[t,t,t,t],[t,e,e,r],[t,e,r,s],[t,r,s,s]],0,S.empty())}getPlayerTerritory(t){return t===F.ZERO?Ps.PLAYER_ZERO_TERRITORY:Ps.PLAYER_ONE_TERRITORY}isTherePieceOnPlayerSide(t){const e=this.getCurrentPlayer(),r=this.getPlayerTerritory(e);for(const s of r)for(let i=0;i<4;i++)if(this.getPieceAtXY(i,s)===t)return!0;return!1}getScoreOf(t){return this.captured.get(t).get().toValue()}getEmptyTerritory(){return this.isTerritoryEmpty(F.ZERO)?S.of(F.ZERO):this.isTerritoryEmpty(F.ONE)?S.of(F.ONE):S.empty()}isTerritoryEmpty(t){const e=this.getPlayerTerritory(t);for(const r of e)for(let s=0;s<4;s++)if(this.getPieceAtXY(s,r)!==kt.EMPTY)return!1;return!0}isInOpponentTerritory(t){const e=this.getCurrentOpponent();return this.getPlayerTerritory(e).contains(t.y)}isInPlayerTerritory(t){const e=this.getCurrentPlayer();return this.getPlayerTerritory(e).contains(t.y)}getCapturesOf(t){const e=this.captured.get(t).get();return[e.captures.get(kt.PAWN).getOrElse(0),e.captures.get(kt.DRONE).getOrElse(0),e.captures.get(kt.QUEEN).getOrElse(0)]}}Ps.PLAYER_ZERO_TERRITORY=new Z1([4,5,6,7]),Ps.PLAYER_ONE_TERRITORY=new Z1([0,1,2,3]);let ZS=(()=>{class n{}return n.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY=()=>$localize`You must pick a piece from your side of the board in order to move it.`,n.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT=()=>$localize`This is not a valid promotion nor a valid capture.`,n.CANNOT_UNDO_LAST_MOVE=()=>$localize`You cannot perform a move that is the reverse of the previous one.`,n})();class Uf extends hr{applyLegalMove(t,e,r){const s=e.getCopiedBoard();s[t.coord.y][t.coord.x]=kt.EMPTY,s[t.end.y][t.end.x]=r.finalPiece;const o=r.score;let c=e.countDown;if(c.isPresent())if(this.isCapture(t,e))c=Uf.STARTING_COUNT_DOWN;else{const h=e.countDown.get();c=S.of(h-1)}return t.calledTheClock&&(c=Uf.STARTING_COUNT_DOWN),new Ps(s,e.turn+1,S.of(t),c,o)}isLegal(t,e){this.assertNonDoubleClockCall(t,e);const r=this.isLegalMove(t,e);if(r.isFailure())return K.failure(r.getReason());if(t.isUndoneBy(e.lastMove))return K.failure(ZS.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(t,e))return this.isLegalFieldPromotion(t,e);const s=e.getPieceAt(t.coord),i=e.captured.getCopy();if(this.isCapture(t,e)){const c=e.getCurrentPlayer();let u=i.get(c).get();const h=e.getPieceAt(t.end);u=u.add(h),i.replace(c,u),i.makeImmutable()}return K.success({finalPiece:s,score:i})}assertNonDoubleClockCall(t,e){Se(!1===(e.countDown.isPresent()&&t.calledTheClock),"Should not call the clock twice")}isCapture(t,e){const r=e.isInOpponentTerritory(t.end),s=e.getPieceAt(t.end)!==kt.EMPTY;return r&&s}isFieldPromotion(t,e){const r=e.isInPlayerTerritory(t.end),s=e.getPieceAt(t.end)!==kt.EMPTY;return r&&s}isLegalFieldPromotion(t,e){const r=this.getPromotedPiece(t,e);if(r.isAbsent())return K.failure(ZS.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());const s=r.get();if(e.isTherePieceOnPlayerSide(s))return K.failure(ZS.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());{const i={finalPiece:s,score:e.captured.getCopy()};return K.success(i)}}isLegalMove(t,e){if(!1===e.isInPlayerTerritory(t.coord))return K.failure(ZS.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());const s=e.getPieceAt(t.coord);if(s===kt.EMPTY)return K.failure(Mt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s===kt.PAWN)return t.isValidForPawn()?K.success(void 0):K.failure(jS.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(s===kt.DRONE&&!1===t.isValidForDrone())return K.failure(jS.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());for(const i of t.coord.getUntil(t.end))if(e.getPieceAt(i)!==kt.EMPTY)return K.failure(Mt.SOMETHING_IN_THE_WAY());return K.success(void 0)}getPromotedPiece(t,e){const r=e.getPieceAt(t.coord),s=e.getPieceAt(t.end);return kt.tryMerge(r,s)}getGameStatus(t){const e=t.gameState;if(e.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(e,ze.DRAW);if(e.getEmptyTerritory().isPresent()){const s=e.getCurrentOpponent(),i=ze.getVictory(s);return this.getGameStatusScoreVictoryOr(e,i)}return ze.ONGOING}getGameStatusScoreVictoryOr(t,e){const r=t.getScoreOf(F.ZERO),s=t.getScoreOf(F.ONE);return r>s?ze.ZERO_WON:s>r?ze.ONE_WON:e}}Uf.STARTING_COUNT_DOWN=S.of(7);let oce=(()=>{class n{}return n.YOU_DID_NOT_CAPTURE_ANY_PIECE=()=>$localize`Failed, you did not capture any piece.`,n})();const ie=kt.EMPTY,hi=kt.PAWN,bl=kt.DRONE,P0=kt.QUEEN,ace=()=>$localize`This is not a field promotion!`;class cce extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Goal of the game`,$localize`At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal.`,Ps.getInitialState()),pe.informational($localize`The pieces`,$localize`The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>`,Ps.getInitialState()),pe.fromPredicate($localize`Moving pawns`,$localize`Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn.`,Ps.getInitialState(),ls.from(new P(2,5),new P(1,4)).get(),(t,e,r)=>r.getPieceAt(t.end)===kt.PAWN?G.SUCCESS:G.failure($localize`This is not a pawn!`),$localize`Congratulations!`),pe.fromPredicate($localize`Moving drones`,$localize`Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone.`,Ps.getInitialState(),ls.from(new P(1,7),new P(0,7)).get(),(t,e,r)=>r.getPieceAt(t.end)===kt.DRONE?G.SUCCESS:G.failure($localize`This is not a drone!`),$localize`Congratulations!`),pe.fromPredicate($localize`Moving queens`,$localize`Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen.`,new Ps([[bl,hi,ie,ie],[P0,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,P0,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[P0,bl,hi,ie]],1),ls.from(new P(2,3),new P(2,7)).get(),(t,e,r)=>r.getPieceAt(t.end)===kt.QUEEN?G.SUCCESS:G.failure($localize`This is not a queen!`),$localize`Congratulations!`),pe.fromMove($localize`Capture`,$localize`When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it.`,new Ps([[bl,hi,hi,ie],[ie,ie,ie,ie],[P0,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,hi,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,bl,hi,ie]],1),[ls.from(new P(0,2),new P(2,4)).get()],$localize`Congratulations! By capturing that pawn, you won one point.`,oce.YOU_DID_NOT_CAPTURE_ANY_PIECE()),pe.fromMove($localize`Field Promotion (1/2)`,$localize`It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it.`,new Ps([[ie,ie,ie,P0],[ie,hi,ie,ie],[ie,ie,hi,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,P0],[ie,ie,bl,ie],[ie,hi,ie,ie]],1),[ls.from(new P(1,1),new P(2,2)).get(),ls.from(new P(2,2),new P(1,1)).get()],$localize`Congratulations!`,ace()),pe.fromPredicate($localize`Field Promotion (2/2)`,$localize`The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it.`,new Ps([[hi,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,bl,ie],[ie,hi,ie,ie]],0),ls.from(new P(1,7),new P(2,6)).get(),(t,e,r)=>r.getPieceAt(t.end)===kt.QUEEN?G.SUCCESS:G.failure(ace()),$localize`Congratulations!`),pe.fromPredicate($localize`Call the clock`,$localize`When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You're playing Dark. Call the clock and perform a move.`,Ps.getInitialState(),ls.from(new P(1,5),new P(0,4),!0).get(),(t,e,r)=>t.calledTheClock?G.SUCCESS:G.failure($localize`You did not call the clock!`),$localize`Congratulations!`),pe.fromMove($localize`Restarting the clock`,$localize`If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You are playing Dark, do a capture to restart the countdown.`,new Ps([[ie,ie,ie,ie],[ie,hi,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,hi],[ie,ie,bl,ie],[ie,hi,ie,ie]],15,S.empty(),S.of(1)),[ls.from(new P(1,1),new P(2,2)).get()],$localize`Congratulations!`,$localize`This is not a capture, the game is now over, please retry!`),pe.anyMove($localize`End game (by clock)`,$localize`When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You are playing Dark, do the last move.`,new Ps([[ie,ie,ie,P0],[ie,hi,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[bl,ie,ie,ie],[ie,ie,ie,ie],[ie,bl,ie,ie]],15,S.empty(),S.of(1)),ls.from(new P(1,1),new P(2,2)).get(),$localize`Congratulations!`),pe.fromPredicate($localize`End by emptyness`,$localize`When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!`,new Ps([[ie,ie,ie,P0],[ie,hi,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,hi,ie],[ie,ie,ie,ie],[ie,ie,ie,ie],[ie,ie,ie,ie]],0),ls.from(new P(2,4),new P(1,3)).get(),(t,e,r)=>3===t.end.y?G.SUCCESS:G.failure($localize`Your piece is still in you territory!`),$localize`Congratulations!`)]}}function Flt(n,t){if(1&n&&(B(),X(0,"g",19)),2&n){const e=E(2).index,r=E().index,s=E();Q2(s.style),je("mainShapeId","pawn_",e,"_",r,""),w("pieceClasses",s.getPieceClasses(e,r))}}function Blt(n,t){if(1&n&&(B(),X(0,"g",20)),2&n){const e=E(2).index,r=E().index,s=E();Q2(s.style),je("mainShapeId","drone_",e,"_",r,""),w("pieceClasses",s.getPieceClasses(e,r))}}function $lt(n,t){if(1&n&&(B(),X(0,"g",21)),2&n){const e=E(2).index,r=E().index,s=E();Q2(s.style),je("mainShapeId","queen_",e,"_",r,""),w("pieceClasses",s.getPieceClasses(e,r))}}function Ult(n,t){if(1&n&&(B(),N(0,"g"),k(1,Flt,1,5,"g",16),k(2,Blt,1,5,"g",17),k(3,$lt,1,5,"g",18),A()),2&n){const e=E(),r=e.index,s=e.$implicit,i=E().index,o=E();V("transform",o.getPieceLocation(r,i)),M(1),w("ngIf",s===o.pieces.PAWN),M(1),w("ngIf",s===o.pieces.DRONE),M(1),w("ngIf",s===o.pieces.QUEEN)}}function Glt(n,t){if(1&n){const e=we();B(),N(0,"g",14),se("click",function(){const i=he(e).index,o=E().index;return ce(E().onClick(i,o))}),X(1,"rect",15),k(2,Ult,4,4,"g",13),A()}if(2&n){const e=t.$implicit,r=t.index,s=E().index,i=E();je("id","click_",r,"_",s,""),V("transform",i.getPieceTranslation(s)),M(1),je("id","square_",r,"_",s,""),w("ngClass",i.getSquareClasses(r,s)),V("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),M(1),w("ngIf",e!==i.pieces.EMPTY)}}function Wlt(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"rect",22),se("click",function(){const i=he(e).$implicit;return ce(E(3).onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=E(3);M(1),je("id","indicator_",e.x,"_",e.y,""),V("transform",r.getPieceTranslation(e.y))("x",e.x*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("y",e.y*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("width",r.INDICATOR_SIZE)("height",r.INDICATOR_SIZE)}}function qlt(n,t){if(1&n&&(B(),N(0,"g"),k(1,Wlt,2,7,"g",1),A()),2&n){const e=E(2);M(1),w("ngForOf",e.selectedPieceInfo.get().legalLandings)}}function jlt(n,t){if(1&n&&(B(),N(0,"g"),k(1,Glt,3,11,"g",12),k(2,qlt,2,1,"g",13),A()),2&n){const e=t.$implicit,r=E();M(1),w("ngForOf",e),M(1),w("ngIf",r.selectedPieceInfo.isPresent())}}function Zlt(n,t){if(1&n&&(B(),N(0,"text",23),Et(1),A()),2&n){const e=E();w("ngClass","player"+e.getCurrentPlayer().value)("ngClass",e.getClockCircleClasses()),V("x",.5*e.SPACE_SIZE)("y",.5*e.SPACE_SIZE),M(1),jn(e.countDown.get())}}function Ylt(n,t){if(1&n&&(B(),X(0,"polyline",24)),2&n){const e=E();w("ngClass",e.getClockCircleClasses()),V("points",e.clockNeedlesPoints)}}const YS=function(n){return[n]};function Klt(n,t){if(1&n){const e=we();B(),nn(0),N(1,"g",27),se("click",function(){const i=he(e).index;return ce(E(2).chooseStyle(i))}),A(),rn()}if(2&n){const e=t.$implicit,r=t.index,s=E(2);M(1),Q2(e.style),w("id",e.name)("pieceClasses",N6(5,YS,"player"+s.getCurrentPlayer().value+"-fill")),V("transform","translate(0, "+-(r+1)*s.SPACE_SIZE+")")}}function Xlt(n,t){if(1&n&&(B(),N(0,"g",25),X(1,"rect",26),k(2,Klt,2,7,"ng-container",1),A()),2&n){const e=E();M(1),V("x",0)("y",-e.listOfStyles.length*e.SPACE_SIZE)("width",1*e.SPACE_SIZE)("height",e.listOfStyles.length*e.SPACE_SIZE),M(1),w("ngForOf",e.listOfStyles)}}function Qlt(n,t){if(1&n&&(B(),N(0,"text",33),Et(1),A()),2&n){const e=E(2).$implicit,r=E().$implicit,s=E();w("ngClass",s.getPlayerClass(r)),V("x",s.SPACE_SIZE/2)("y",s.SPACE_SIZE/2),M(1),jn(e+" x ")}}function Jlt(n,t){if(1&n&&(B(),X(0,"g",34)),2&n){const e=E(3).$implicit,r=E();Q2(r.style),w("pieceClasses",N6(3,YS,r.getPlayerClass(e)))}}function e6t(n,t){if(1&n&&(B(),X(0,"g",35)),2&n){const e=E(3).$implicit,r=E();Q2(r.style),w("pieceClasses",N6(3,YS,r.getPlayerClass(e)))}}function t6t(n,t){if(1&n&&(B(),X(0,"g",36)),2&n){const e=E(3).$implicit,r=E();Q2(r.style),w("pieceClasses",N6(3,YS,r.getPlayerClass(e)))}}function n6t(n,t){if(1&n&&(B(),N(0,"g"),k(1,Qlt,2,4,"text",29),N(2,"g",28),k(3,Jlt,1,5,"g",30),k(4,e6t,1,5,"g",31),k(5,t6t,1,5,"g",32),A()()),2&n){const e=E(),r=e.index,s=e.$implicit,i=E().$implicit,o=E();V("transform","translate(0, "+2*r*o.SPACE_SIZE+")"),M(1),w("ngIf",s>1),M(1),je("id","piece_",r,"_player_",i.value,""),V("transform","translate("+o.SPACE_SIZE+", 0)"),M(1),w("ngIf",0===r),M(1),w("ngIf",1===r),M(1),w("ngIf",2===r)}}function r6t(n,t){if(1&n&&(B(),N(0,"g"),k(1,n6t,6,8,"g",13),A()),2&n){const e=t.$implicit;M(1),w("ngIf",e>0)}}function s6t(n,t){if(1&n&&(B(),N(0,"g")(1,"g",28),k(2,r6t,2,1,"g",1),A()()),2&n){const e=t.$implicit,r=E();M(1),L1("id","capture_of_player_",e.value,""),V("transform",r.getCapturesTransformation(e)),M(1),w("ngForOf",r.state.getCapturesOf(e))}}let fo=(()=>{class n extends Bo{constructor(e){super(e),this.INDICATOR_SIZE=20,this.HORIZONTAL_CENTER=2*n.SPACE_SIZE,this.VERTICAL_CENTER=4*n.SPACE_SIZE+n.STROKE_WIDTH,this.LEFT=n.SPACE_SIZE/-4+n.STROKE_WIDTH/-2,this.UP=-n.STROKE_WIDTH/2,this.WIDTH=6.5*n.SPACE_SIZE+n.STROKE_WIDTH,this.HEIGHT=8*n.SPACE_SIZE+3*n.STROKE_WIDTH,this.MartianChessComponent=n,this.style={shape:"Circle",points:"Horizontal Points"},this.pieces=kt,this.selectedPieceInfo=S.empty(),this.countDown=S.empty(),this.callTheClock=!1,this.displayModePanel=!1,this.listOfStyles=[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}],this.hasAsymetricBoard=!0,this.rules=new Uf(Ps),this.availableMinimaxes=[new Hlt(this.rules,"Martian Chess Dummy Minimax")],this.SPACE_SIZE=n.SPACE_SIZE,this.configCogTransformation=this.getConfigCogTransformation(),this.configViewTranslation=this.getConfigViewTranslation(),this.clockNeedlesPoints=this.getClockNeedlesPoints(),this.encoder=ls.encoder,this.tutorial=(new cce).tutorial,this.scores=S.of([0,0]),this.updateBoard()}static getRegularPolygon(e,r=0){const s=n.getRegularPolygonCoords(e,r);return n.mapCoordsToString(s)}static getNPointedStar(e,r){const s=this.getNPointedStarCoords(e,r);return n.mapCoordsToString(s)}static getNPointedStarCoords(e,r){const s=[],i=.5*n.SPACE_SIZE,o=.5*n.SPACE_SIZE;e*=2;for(let c=0;c<e;c++){const h=(c*(360/e)+r)/180*Math.PI,g=c%2==0?n.SPACE_SIZE/2:n.SPACE_SIZE/6,m=i+.8*g*Math.cos(h),v=o+.8*g*Math.sin(h);s.push(new P(m,v))}return s}static getRegularPolygonCoords(e,r=0){const s=[],i=.5*n.SPACE_SIZE,o=.5*n.SPACE_SIZE;for(let c=0;c<e;c++){const h=(c*(360/e)-90)/180*Math.PI,g=.5*n.SPACE_SIZE,m=i+.8*g*Math.cos(h),v=o+.8*g*Math.sin(h)+r;s.push(new P(m,v))}return s}static mapCoordsToString(e){let r="";for(const s of e)r+=s.x+", "+s.y+" ";return r}static getRadius(e){return this.SPACE_SIZE*e/10}getConfigViewTranslation(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}getConfigCogTransformation(){const e=this.STROKE_WIDTH,s=(this.SPACE_SIZE-e)/40;return"translate("+1*e+", "+1*e+") scale("+s+" "+s+")"}getClockNeedlesPoints(){const e=.5*this.SPACE_SIZE;return e+" "+.1*this.SPACE_SIZE+", "+e+" "+e+", "+.75*this.SPACE_SIZE+" "+e}updateBoard(){this.state=this.getState(),this.board=this.state.board;const e=this.state.getScoreOf(F.ZERO),r=this.state.getScoreOf(F.ONE);this.countDown=this.state.countDown,this.scores=S.of([e,r])}getPieceLocation(e,r){return"translate("+this.SPACE_SIZE*e+", "+this.SPACE_SIZE*r+")"}getPieceClasses(e,r){const s=new P(e,r),i=[];return i.push(r>3?"player0-fill":"player1-fill"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(s)&&i.push("selected-stroke"),this.rules.node.move.isPresent()&&this.rules.node.move.get().end.equals(s)&&this.rules.node.mother.get().gameState.getPieceAt(s)!==kt.EMPTY&&this.getState().isInOpponentTerritory(new P(0,r))&&i.push("last-move-stroke"),i}onClick(e,r){var s=this;return O(function*(){s.displayModePanel=!1;const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new P(e,r);return s.selectedPieceInfo.isPresent()?s.secondClick(o):s.firstClick(o)})()}firstClick(e){var r=this;return O(function*(){return r.isOneOfUsersPieces(e)?r.selectAsFirstPiece(e):(r.cancelMoveAttempt(),G.SUCCESS)})()}selectAsFirstPiece(e){var r=this;return O(function*(){const s=r.getLegalLandings(e);return r.selectedPieceInfo=S.of({selectedPiece:e,legalLandings:s}),G.SUCCESS})()}getLegalLandings(e){const r=this.state.getPieceAt(e);let s;return s=r===kt.PAWN?Pe.DIAGONALS.map(i=>e.getNext(i)):this.getValidLinearLandingSquareUntil(e,r===kt.DRONE?2:8),s.filter(i=>{const o=ls.from(e,i);return!!o.isSuccess()&&this.rules.isLegal(o.get(),this.getState()).isSuccess()})}getValidLinearLandingSquareUntil(e,r){return Pe.DIRECTIONS.flatMap(s=>{const i=[];let o=e.getNext(s),c=1;for(;o.isInRange(4,8)&&c<=r&&(i.push(o),this.getState().getPieceAt(o)===kt.EMPTY);)o=o.getNext(s),c++;return i})}secondClick(e){var r=this;return O(function*(){const s=r.selectedPieceInfo.get();if(s.selectedPiece.equals(e))return r.cancelMoveAttempt(),G.SUCCESS;if(s.legalLandings.some(i=>i.equals(e))){const i=ls.from(s.selectedPiece,e,r.callTheClock);Se(i.isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!");const o=r.getState();return r.chooseMove(i.get(),o)}if(r.isOneOfUsersPieces(e))return r.selectAsFirstPiece(e);{const i=ls.from(s.selectedPiece,e,r.callTheClock);return i.isSuccess()?r.chooseMove(i.get(),r.getState()):r.cancelMove(i.getReason())}})()}isOneOfUsersPieces(e){return this.state.getPieceAt(e)!==kt.EMPTY&&this.state.isInPlayerTerritory(e)}cancelMoveAttempt(){this.selectedPieceInfo=S.empty(),this.callTheClock=!1}onClockClick(){var e=this;return O(function*(){const r=e.canUserPlay("#clockOrCountDownView");return r.isFailure()?e.cancelMove(r.getReason()):(e.getState().countDown.isAbsent()&&(e.callTheClock=!e.callTheClock),G.SUCCESS)})()}getClockCircleClasses(){const e=["base"];return this.callTheClock&&e.push("selected-stroke"),this.getCurrentPlayer()===F.ZERO?e.push("player0-stroke"):e.push("player1-stroke"),e}getSquareClasses(e,r){const s=new P(e,r),i=["base"];if(this.rules.node.move.isPresent()){const o=this.rules.node,c=o.move.get();c.coord.equals(s)?i.push("moved-fill"):c.end.equals(s)&&(o.mother.get().gameState.getPieceAt(s)===kt.EMPTY||o.gameState.isInOpponentTerritory(new P(0,r))?i.push("moved-fill"):i.push("captured-fill"))}return i}onModeCogClick(){this.displayModePanel=!this.displayModePanel}chooseStyle(e){this.style=this.listOfStyles[e].style,this.displayModePanel=!1}getPieceTranslation(e){return"translate(0,  "+(e<=3?0:2*this.STROKE_WIDTH)+")"}getBoardTransformation(){return"translate("+this.SPACE_SIZE+", 0) rotate("+180*this.role.value+" "+this.HORIZONTAL_CENTER+" "+this.VERTICAL_CENTER+")"}getCapturesTransformation(e){let i=this.SPACE_SIZE/2;return e===this.role&&(i+=10*this.SPACE_SIZE+4*this.STROKE_WIDTH),"scale(0.5, 0.5) translate("+-this.SPACE_SIZE/2+", "+i+")"}}return n.SPACE_SIZE=100,n.STROKE_WIDTH=8,n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-martian-chess"]],features:[l],decls:15,vars:19,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(e,r){1&e&&(B(),N(0,"svg",0)(1,"g"),k(2,jlt,3,2,"g",1),A(),N(3,"g",2),se("click",function(){return r.onClockClick()}),X(4,"rect",3)(5,"circle",4),k(6,Zlt,2,5,"text",5),k(7,Ylt,1,2,"polyline",6),A(),N(8,"g",7)(9,"g",8),se("click",function(){return r.onModeCogClick()}),X(10,"rect",3)(11,"path",9),A(),k(12,Xlt,3,5,"g",10),A(),N(13,"g",11),k(14,s6t,3,3,"g",1),A()()),2&e&&(V("viewBox",r.LEFT+" "+r.UP+" "+r.WIDTH+" "+r.HEIGHT),M(1),V("transform",r.getBoardTransformation()),M(1),w("ngForOf",r.board),M(1),V("transform","translate("+5.25*r.SPACE_SIZE+", 0)"),M(1),V("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),M(1),w("ngClass",r.getClockCircleClasses()),V("cx",.5*r.SPACE_SIZE)("cy",.5*r.SPACE_SIZE)("r",.4*r.SPACE_SIZE),M(1),w("ngIf",r.countDown.isPresent()),M(1),w("ngIf",r.countDown.isAbsent()),M(1),V("transform",r.configViewTranslation),M(2),V("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),M(1),w("ngClass",r.getPlayerClass(r.getCurrentPlayer())),V("transform",r.configCogTransformation),M(1),w("ngIf",r.displayModePanel),M(2),w("ngForOf",r.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Nl extends Vs{static getInitialState(){const t=ht.createTable(7,6,fe.NONE);return new Nl(t,0)}}class b1 extends so{constructor(t){super(),this.x=t}static of(t){switch(t){case 0:return b1.ZERO;case 1:return b1.ONE;case 2:return b1.TWO;case 3:return b1.THREE;case 4:return b1.FOUR;case 5:return b1.FIVE;case 6:return b1.SIX;default:throw new Error("Invalid P4Move")}}equals(t){return this===t}toString(){return"P4Move("+this.x+")"}}b1.ZERO=new b1(0),b1.ONE=new b1(1),b1.TWO=new b1(2),b1.THREE=new b1(3),b1.FOUR=new b1(4),b1.FIVE=new b1(5),b1.SIX=new b1(6),b1.encoder=new class extends on{maxValue(){return 6}encodeNumber(n){return n.x}decodeNumber(n){return b1.of(n)}};let i6t=(()=>{class n{}return n.COLUMN_IS_FULL=()=>$localize`Please put your piece in an incomplete column.`,n})(),F8=(()=>{class n extends hr{static getVictoriousCoords(e){const r=[];for(let s=0;s<7;s++)for(let i=5;-1!==i&&e.board[i][s].isPlayer();i--){const o=n.getSquareScore(e.board,new P(s,i));(o===F.ZERO.getVictoryValue()||o===F.ONE.getVictoryValue())&&r.push(new P(s,i))}return r}static getBoardValueFromScratch(e){Y(n.VERBOSE,{P4Rules_getBoardValueFromScratch:{state:e}});let r=0;for(let s=0;s<7;s++)for(let i=5;-1!==i&&e.board[i][s].isPlayer();i--){const o=n.getSquareScore(e.board,new P(s,i));if(fr.getScoreStatus(o)!==Mn.DEFAULT)return Y(n.VERBOSE,{preVictoryOrVictory:{state:e,tmpScore:o,coord:{x:s,y:i}}}),new dt(o);r+=o}return new dt(r)}static getLowestUnoccupiedSpace(e,r){let s=0;for(;s<6&&e[s][r]===fe.NONE;)s++;return s-1}static getNumberOfFreeSpacesAndAllies(e,r,s,i,o){let c=0,u=0,h=!0,g=new P(r.x+s.x,r.y+s.y);for(;g.isInRange(7,6)&&3!==c;){const m=e[g.y][g.x];if(m===i)return[c,u];m===o&&h?u++:h=!1,m!==i&&m!==o&&c++,g=g.getNext(s)}return[c,u]}static getOpponent(e,r){const s=e[r.y][r.x];return Se(s.isPlayer(),"getOpponent should not be called with PlayerOrNone.NONE"),s===F.ONE?F.ZERO:F.ONE}static getSquareScore(e,r){Y(n.VERBOSE,"getSquareScore(board, "+r.x+", "+r.y+") called"),Y(n.VERBOSE,e);let s=0;const i=n.getOpponent(e,r),o=i.getOpponent(),c=new Qn,u=new Qn;for(const h of Pe.DIRECTIONS){const g=n.getNumberOfFreeSpacesAndAllies(e,r,h,i,o);c.set(h,g[0]),u.set(h,g[1])}for(const h of[Pe.UP,Pe.UP_RIGHT,Pe.RIGHT,Pe.DOWN_RIGHT]){const g=u.get(h).get()+u.get(h.getOpposite()).get();if(g>2)return Y(n.VERBOSE,{text:"there is some kind of victory here ("+r.x+", "+r.y+")\nline allies : "+g+"\n",board:e}),o.getVictoryValue();const m=c.get(h).get()+c.get(h.getOpposite()).get();3===m?s+=2:m>3&&(s+=m-2)}return s*o.getScoreModifier()}static getListMoves(e){Y(n.VERBOSE,{context:"P4Rules.getListMoves",node:e});const r=e.gameState,s=[];for(let i=0;i<7;i++)if(r.getPieceAtXY(i,0)===fe.NONE){const o=b1.of(i);s.push(o)}return s}static getBoardValue(e){return Y(n.VERBOSE,{text:"P4Rules.getBoardValue called",board:e.getCopiedBoard()}),n.getBoardValueFromScratch(e)}applyLegalMove(e,r,s){const i=e.x,o=r.getCopiedBoard(),c=n.getLowestUnoccupiedSpace(o,i),u=r.turn;return o[c][i]=r.getCurrentPlayer(),new Nl(o,u+1)}isLegal(e,r){return Y(n.VERBOSE,{context:"P4Rules.isLegal",move:e.toString(),state:r}),r.getPieceAtXY(e.x,0).isPlayer()?K.failure(i6t.COLUMN_IS_FULL()):K.success(void 0)}getGameStatus(e){const r=e.gameState;for(let s=0;s<7;s++)for(let i=5;i>=0&&r.board[i][s].isPlayer();i--){const o=n.getSquareScore(r.board,new P(s,i));if(fr.getScoreStatus(o)===Mn.VICTORY)return ze.getVictory(r.getCurrentOpponent())}return 42===r.turn?ze.DRAW:ze.ONGOING}}return n.VERBOSE=!1,n})();class o6t extends rr{getListMoves(t){return F8.getListMoves(t)}getBoardValue(t){const e=t.gameState;return Y(F8.VERBOSE,{text:"P4Rules instance methods getBoardValue called",board:e.getCopiedBoard()}),F8.getBoardValue(e)}}const mt=fe.NONE,Al=fe.ZERO,Gf=fe.ONE;class lce extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Goal of the game`,$localize`The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.
        The first player plays Dark, the second plays Light.
        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally).`,Nl.getInitialState()),pe.anyMove($localize`Dropping a piece`,$localize`Click on any space in any column.`,Nl.getInitialState(),b1.THREE,$localize`As you can see, the piece falls at the bottom of the column.`),pe.fromMove($localize`Victory`,$localize`You're playing Dark.
        Place your piece so that you create a horizontal alignment of 4 of your pieces.`,new Nl([[mt,mt,mt,mt,mt,mt,mt],[mt,mt,mt,mt,mt,mt,mt],[mt,mt,mt,mt,mt,mt,mt],[mt,mt,mt,Gf,mt,mt,mt],[mt,mt,mt,Gf,mt,mt,mt],[mt,mt,Al,Al,Al,Gf,mt]],0),[b1.of(1)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`),pe.fromMove($localize`Other victory`,$localize`You can also align 4 pieces diagonally or vertically.`,new Nl([[mt,mt,mt,mt,mt,mt,mt],[mt,mt,mt,mt,mt,mt,mt],[mt,mt,mt,mt,mt,mt,mt],[mt,mt,mt,Al,Gf,mt,mt],[mt,mt,Al,Al,Gf,mt,mt],[mt,Al,Gf,Al,Al,mt,mt]],0),[b1.of(3),b1.of(4)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`)]}}function a6t(n,t){if(1&n&&(B(),X(0,"circle",8)),2&n){const e=E().index,r=E().index,s=E();w("ngClass",s.getSquareFillClass(e,r)),V("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function c6t(n,t){if(1&n){const e=we();B(),N(0,"g",5),se("click",function(){const i=he(e).index;return ce(E(2).onClick(i))}),X(1,"rect",6),k(2,a6t,1,4,"circle",7),A()}if(2&n){const e=t.$implicit,r=t.index,s=E().index,i=E();L1("id","click_",r,""),M(1),V("x",i.SPACE_SIZE*r)("y",i.SPACE_SIZE*s)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),M(1),w("ngIf",e!==i.EMPTY)}}function l6t(n,t){if(1&n&&(B(),N(0,"g"),k(1,c6t,3,6,"g",4),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}function u6t(n,t){if(1&n&&(B(),X(0,"rect",9)),2&n){const e=E();V("x",e.SPACE_SIZE*e.last.get().x)("y",e.SPACE_SIZE*e.last.get().y)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function f6t(n,t){if(1&n&&(B(),X(0,"rect",10)),2&n){const e=t.$implicit,r=E();je("id","victory_coord_",e.x,"_",e.y,""),V("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let h6t=(()=>{class n extends Bo{constructor(e){super(e),this.EMPTY=fe.NONE,this.victoryCoords=[],this.rules=new F8(Nl),this.availableMinimaxes=[new o6t(this.rules,"P4Minimax")],this.encoder=b1.encoder,this.tutorial=(new lce).tutorial,this.updateBoard()}onClick(e){var r=this;return O(function*(){const s=r.canUserPlay("#click_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=b1.of(e);return yield r.chooseMove(i,r.getState())})()}updateBoard(){const e=this.getState(),r=this.rules.node.move;this.victoryCoords=F8.getVictoriousCoords(e),this.board=e.board,r.isPresent()?this.showLastMove():this.hideLastMove()}showLastMove(){const e=this.getState(),r=this.rules.node.move,s=F8.getLowestUnoccupiedSpace(e.board,r.get().x)+1;this.last=S.of(new P(r.get().x,s))}hideLastMove(){this.last=S.empty()}getSquareFillClass(e,r){return[this.getPlayerClass(this.board[r][e])]}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-p4"]],features:[l],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move-stroke","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,r){1&e&&(B(),N(0,"svg",0),k(1,l6t,2,1,"g",1),k(2,u6t,1,4,"rect",2),k(3,f6t,1,6,"rect",3),A()),2&e&&(M(1),w("ngForOf",r.board),M(1),w("ngIf",r.last.isPresent()),M(1),w("ngForOf",r.victoryCoords))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Ts extends Yc{constructor(t,e,r,s=!1){if(super(t,e),this.blockTurned=r,this.turnedClockwise=s,this.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+this.coord.toString())}static withRotation(t,e,r,s){if(r<0||3<r)throw new Error("This block do not exist: "+r);return new Ts(t,e,S.of(r),s)}static rotationless(t,e){return new Ts(t,e,S.empty())}toString(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}equals(t){return!1!==this.coord.equals(t.coord)&&!1!==this.blockTurned.equals(t.blockTurned)&&this.turnedClockwise===t.turnedClockwise}}Ts.encoder=new class extends e4{encodeMove(n){const t={coord:P.encoder.encode(n.coord)};return n.blockTurned.isPresent()&&(t.blockTurned=n.blockTurned.get(),t.turnedClockwise=n.turnedClockwise),t}decodeMove(n){const t=n,e=P.encoder.decode(t.coord),r=S.ofNullable(t.blockTurned);if(r.isPresent()){const s=t.turnedClockwise;return Ts.withRotation(e.x,e.y,r.get(),s)}return Ts.rotationless(e.x,e.y)}};let uce=(()=>{class n{}return n.CANNOT_ROTATE_NEUTRAL_BLOCK=()=>$localize`If the quadrant to turn is neutral, please just use move without rotation.`,n.MUST_CHOOSE_BLOCK_TO_ROTATE=()=>$localize`No quadrant is neutral, you must pick a quadrant to rotate.`,n})();class O2 extends Vs{constructor(t,e){super(t,e),this.neutralBlocks=this.getBlocksNeutralities()}static getInitialState(){const t=ht.createTable(6,6,fe.NONE);return new O2(t,0)}getBlocksNeutralities(){const t=[];for(let e=0;e<4;e++)this.getBlockNeutrality(e)&&t.push(e);return t}getBlockNeutrality(t){const e=O2.getBlockCenter(t),r=this.getPieceAt(e.getNext(Pe.UP,1)),s=this.getPieceAt(e.getNext(Pe.UP_LEFT,1));return this.getPieceAt(e.getNext(Pe.RIGHT,1))===r&&this.getPieceAt(e.getNext(Pe.DOWN,1))===r&&this.getPieceAt(e.getNext(Pe.LEFT,1))===r&&this.getPieceAt(e.getNext(Pe.UP_RIGHT,1))===s&&this.getPieceAt(e.getNext(Pe.DOWN_RIGHT,1))===s&&this.getPieceAt(e.getNext(Pe.DOWN_LEFT,1))===s}static getBlockCenter(t){return new P(1+(t%2==0?0:3),1+(t<2?0:3))}applyLegalDrop(t){const e=this.getCopiedBoard();return e[t.coord.y][t.coord.x]=this.getCurrentPlayer(),new O2(e,this.turn)}applyLegalMove(t){const e=this.applyLegalDrop(t),r=e.getCopiedBoard();if(t.blockTurned.isPresent()){const s=O2.getBlockCenter(t.blockTurned.get());if(t.turnedClockwise)for(const i of O2.ROTATION_MAP){const o=i[0].getNext(s),c=i[1].getNext(s),u=e.getPieceAt(o);r[c.y][c.x]=u}else for(const i of O2.ROTATION_MAP){const o=i[1].getNext(s),c=i[0].getNext(s),u=e.getPieceAt(o);r[c.y][c.x]=u}}return new O2(r,this.turn+1)}blockIsNeutral(t){return this.neutralBlocks.includes(t)}}O2.ROTATION_MAP=[[new P(-1,-1),new P(1,-1)],[new P(0,-1),new P(1,0)],[new P(1,-1),new P(1,1)],[new P(1,0),new P(0,1)],[new P(1,1),new P(-1,1)],[new P(0,1),new P(-1,0)],[new P(-1,1),new P(-1,-1)],[new P(-1,0),new P(0,-1)]];class o3 extends hr{static get(){return o3.singleton.isAbsent()&&(o3.singleton=S.of(new o3(O2))),o3.singleton.get()}applyLegalMove(t,e,r){return e.applyLegalMove(t)}isLegal(t,e){if(e.getPieceAt(t.coord).isPlayer())return K.failure(Mt.MUST_LAND_ON_EMPTY_SPACE());const r=e.applyLegalDrop(t);if(0===r.neutralBlocks.length){if(t.blockTurned.isAbsent())return K.failure(uce.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(t.blockTurned.isPresent()){const s=t.blockTurned.get();if(r.neutralBlocks.includes(s))return K.failure(uce.CANNOT_ROTATE_NEUTRAL_BLOCK())}return K.success(void 0)}getVictoryCoords(t){let e=[];for(const r of o3.VICTORY_SOURCE){const s=t.getPieceAt(r[0]),i=[r[0]];if(s.isPlayer()){let o=r[0].getNext(r[1]),c=!0;for(let u=0;u<3&&c;u++)t.getPieceAt(o)!==s?c=!1:(i.push(o),o=o.getNext(r[1]));if(c&&(t.getPieceAt(o)===s&&(i.push(o),e=e.concat(i)),r[2])){const u=r[0].getPrevious(r[1],1);t.getPieceAt(u)===s&&(i.push(u),e=e.concat(i))}}}return e}getGameStatus(t){const e=t.gameState,r=this.getVictoryCoords(e),s=[!1,!1];for(let i=0;i<r.length;i+=5)s[e.getPieceAt(r[i]).value]=!0;return!0===s[0]?!0===s[1]?ze.DRAW:ze.ZERO_WON:!0===s[1]?ze.ONE_WON:36===e.turn?ze.DRAW:ze.ONGOING}}o3.singleton=S.empty(),o3.VICTORY_SOURCE=[[new P(1,0),new Un(1,1),!1],[new P(0,1),new Un(1,1),!1],[new P(4,0),new Un(-1,1),!1],[new P(5,1),new Un(-1,1),!1],[new P(1,1),new Un(1,1),!0],[new P(4,1),new Un(-1,1),!0],[new P(0,1),new Un(0,1),!0],[new P(1,1),new Un(0,1),!0],[new P(2,1),new Un(0,1),!0],[new P(3,1),new Un(0,1),!0],[new P(4,1),new Un(0,1),!0],[new P(5,1),new Un(0,1),!0],[new P(1,0),new Un(1,0),!0],[new P(1,1),new Un(1,0),!0],[new P(1,2),new Un(1,0),!0],[new P(1,3),new Un(1,0),!0],[new P(1,4),new Un(1,0),!0],[new P(1,5),new Un(1,0),!0]];class KS extends rr{getListMoves(t){const e=[],r=t.gameState.neutralBlocks;if(0===t.gameState.turn)return KS.FIRST_TURN_MOVES;const s=this.getLegalDrops(t.gameState);for(const i of s){const o=Ts.rotationless(i.x,i.y),c=t.gameState.applyLegalDrop(o),u=this.getLegalRotations(c,r);for(const g of u)e.push(Ts.withRotation(i.x,i.y,g[0],g[1]));0===c.neutralBlocks.length==0&&e.push(o)}return e}getLegalDrops(t){const e=[];for(let r=0;r<6;r++)for(let s=0;s<6;s++){const i=new P(s,r);t.getPieceAt(i)===fe.NONE&&e.push(i)}return e}getLegalRotations(t,e){const r=0===t.neutralBlocks.length,s=[];for(let i=0;i<4;i++)!1===t.blockIsNeutral(i)&&(e.includes(i)?r&&s.push([i,!0]):s.push([i,!0],[i,!1]));return s}getBoardValue(t){return new dt(o3.get().getGameStatus(t).toBoardValue())}}KS.FIRST_TURN_MOVES=[Ts.rotationless(0,0),Ts.rotationless(1,0),Ts.rotationless(2,0),Ts.rotationless(0,1),Ts.rotationless(1,1),Ts.rotationless(0,2)];const We=fe.NONE,o4=fe.ZERO,Ol=fe.ONE;class fce{constructor(){this.tutorial=[pe.informational($localize`Initial board`,$localize`The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate.`,O2.getInitialState()),pe.informational($localize`Goal of the game`,$localize`The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins.`,new O2([[o4,We,We,o4,Ol,We],[o4,Ol,We,We,We,We],[o4,We,Ol,We,We,We],[o4,We,We,We,We,Ol],[o4,We,We,We,Ol,We],[We,We,We,We,We,We]],10)).withPreviousMove(Ts.withRotation(0,0,0,!1)),pe.fromPredicate($localize`Simple move`,$localize`At their turn, players put a piece on the board and possibly rotate one quadrant.
        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.
        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>
        Do it.`,new O2([[We,We,We,We,We,We],[We,o4,We,We,Ol,We],[We,We,We,We,We,We],[We,We,We,We,We,We],[We,Ol,We,We,o4,We],[We,We,We,We,We,We]],10),Ts.rotationless(2,2),(t,e,r)=>t.blockTurned.isPresent()?G.failure($localize`You have made a move with a rotation. This tutorial step is about moves without rotations!`):G.SUCCESS,$localize`Congratulations!`),pe.fromPredicate($localize`Move with rotation`,$localize`After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>
        Click on one of them and see the rotation!`,new O2([[We,We,We,We,We,We],[We,o4,We,We,Ol,We],[We,We,We,We,We,We],[We,We,We,We,We,We],[We,Ol,We,We,o4,We],[We,We,We,We,We,We]],10),Ts.withRotation(0,0,0,!0),(t,e,r)=>t.blockTurned.isPresent()?G.SUCCESS:G.failure($localize`You made a move without rotation, try again!`),$localize`Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation.`)]}}function d6t(n,t){if(1&n){const e=we();B(),nn(0),N(1,"circle",9),se("click",function(){const i=he(e).$implicit,o=E().$implicit,c=E().index,u=E().index;return ce(E().onClick(3*c+i,3*u+o))}),A(),rn()}if(2&n){const e=t.$implicit,r=E().$implicit,s=E(),i=s.index,o=s.$implicit,c=E(),u=c.index,h=c.$implicit,g=E();M(1),je("id","click_",3*i+e,"_",3*u+r,""),w("ngClass",g.getSquareClasses(3*i+e,3*u+r)),V("cx",o+2*g.STROKE_WIDTH+(e+.5)*g.SPACE_SIZE)("cy",h+2*g.STROKE_WIDTH+(r+.5)*g.SPACE_SIZE)("r",(g.SPACE_SIZE-g.STROKE_WIDTH)/2)}}const hce=function(){return[0,1,2]};function p6t(n,t){1&n&&(B(),nn(0),k(1,d6t,2,6,"ng-container",3),rn()),2&n&&(M(1),w("ngForOf",ar(1,hce)))}function g6t(n,t){if(1&n&&(B(),nn(0),X(1,"rect",8),k(2,p6t,2,2,"ng-container",3),rn()),2&n){const e=t.$implicit,r=t.index,s=E(),i=s.index,o=s.$implicit,c=E();M(1),w("ngClass",c.getBlockClasses(r,i)),V("x",c.STROKE_WIDTH+e)("y",c.STROKE_WIDTH+o)("rx",3*c.STROKE_WIDTH)("ry",3*c.STROKE_WIDTH)("width",c.BLOCK_WIDTH)("height",c.BLOCK_WIDTH),M(1),w("ngForOf",ar(8,hce))}}const dce=function(n){return[0,n]};function m6t(n,t){if(1&n&&(B(),nn(0),k(1,g6t,3,9,"ng-container",3),rn()),2&n){const e=E();M(1),w("ngForOf",N6(1,dce,e.BLOCK_SEPARATION))}}function _6t(n,t){if(1&n&&(B(),X(0,"circle",10)),2&n){const e=E();je("id","currentDrop_",e.currentDrop.get().x,"_",e.currentDrop.get().y,""),w("ngClass",e.getPlayerClass(e.getCurrentPlayer())),V("cx",e.getCenter(e.currentDrop.get().x))("cy",e.getCenter(e.currentDrop.get().y))("r",(e.SPACE_SIZE-e.STROKE_WIDTH)/2)}}function v6t(n,t){if(1&n){const e=we();B(),N(0,"path",11),se("click",function(){const i=he(e).$implicit;return ce(E().rotate(i))}),A()}if(2&n){const e=t.$implicit,r=E();je("id","rotate_",e[1],"_",e[2]?"clockwise":"counterclockwise",""),V("d",e[0])("stroke-width",2*r.STROKE_WIDTH)}}function C6t(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=t.$implicit,r=E();je("id","victoryCoord_",e.x,"_",e.y,""),w("ngClass",r.getSquareClasses(e.x,e.y)),V("cx",r.getCenter(e.x))("cy",r.getCenter(e.y))("r",(r.SPACE_SIZE-r.STROKE_WIDTH)/2)("stroke-width",r.STROKE_WIDTH)}}function y6t(n,t){if(1&n){const e=we();B(),N(0,"g",13),se("click",function(){return he(e),ce(E().skipRotation())}),X(1,"circle",14)(2,"line",15),A()}if(2&n){const e=E();M(1),V("cx",e.BLOCK_SEPARATION)("cy",e.BLOCK_SEPARATION)("r",.75*e.SPACE_SIZE)("stroke-width",2*e.STROKE_WIDTH),M(1),V("x1",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("y1",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("x2",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("y2",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("stroke-width",2*e.STROKE_WIDTH)}}let E6t=(()=>{class n extends Bo{constructor(e){super(e),this.arrows=[],this.victoryCoords=[],this.rules=new o3(O2),this.availableMinimaxes=[new KS(this.rules,"PentagoMinimax")],this.encoder=Ts.encoder,this.tutorial=(new fce).tutorial,this.BLOCK_WIDTH=3*this.SPACE_SIZE+2*this.STROKE_WIDTH,this.BLOCK_SEPARATION=this.BLOCK_WIDTH+2*this.STROKE_WIDTH,this.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*this.SPACE_SIZE,this.ARROWS=this.generateArrowsCoord(),this.updateBoard()}updateBoard(){this.board=this.getState().getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.getState()),this.showLastMove()}showLastMove(){const e=this.rules.node.move;if(this.cancelMoveAttempt(),e.isAbsent())this.hidePreviousMove();else{const r=e.get();this.movedBlock=r.blockTurned;const s=new P(r.coord.x%3-1,r.coord.y%3-1);if(r.blockTurned.isPresent()&&!1===s.equals(new P(0,0))&&this.coordBelongToBlock(r)){let i;i=r.turnedClockwise?Ae.getNonNullable(O2.ROTATION_MAP.find(h=>h[0].equals(s)))[1]:Ae.getNonNullable(O2.ROTATION_MAP.find(h=>h[1].equals(s)))[0];const o=r.blockTurned.get();i=i.getNext(new Un(o%2==0?1:4,o<2?1:4),1),this.lastDrop=S.of(i)}else this.lastDrop=S.of(r.coord)}}coordBelongToBlock(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}hidePreviousMove(){this.lastDrop=S.empty(),this.movedBlock=S.empty(),this.victoryCoords=[]}generateArrowsCoord(){const e=2*this.BLOCK_SEPARATION,r=this.SPACE_SIZE,s=.5*this.SPACE_SIZE;return[["M "+s+" 0 q "+r+" -"+r+" "+2*r+" 0",0,!0],["M 0 "+s+" q -"+r+" "+r+" 0 "+2*r,0,!1],["M "+e+" "+s+" q "+r+" "+r+" 0 "+2*r,1,!0],["M "+(e-s)+" 0 q -"+r+" -"+r+" -"+2*r+" 0",1,!1],["M 0 "+(e-s)+" q -"+r+" -"+r+" 0 -"+2*r,2,!0],["M "+s+" "+e+" q "+r+" "+r+" "+2*r+" 0",2,!1],["M "+(e-s)+" "+e+" q -"+r+" "+r+" -"+2*r+" 0",3,!0],["M "+e+" "+(e-s)+"  q "+r+" -"+r+" 0 -"+2*r,3,!1]]}cancelMoveAttempt(){this.arrows=[],this.currentDrop=S.empty(),this.canSkipRotation=!1}onClick(e,r){var s=this;return O(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(s.board[r][e].isPlayer())return s.cancelMove(Mt.MUST_LAND_ON_EMPTY_SPACE());const o=Ts.rotationless(e,r),c=s.getState(),u=c.applyLegalDrop(o);if(4===u.neutralBlocks.length)return s.chooseMove(o,c);const h=s.rules.getGameStatus(s.rules.node);return s.canSkipRotation=u.neutralBlocks.length>0&&!1===h.isEndGame,s.currentDrop=S.of(new P(e,r)),s.displayArrows(u.neutralBlocks),G.SUCCESS})()}getCenter(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}displayArrows(e){this.arrows=[];for(let r=0;r<4;r++)if(!1===e.includes(r)){const s=this.ARROWS.filter(i=>i[1]===r);this.arrows=this.arrows.concat(s)}}getBlockClasses(e,r){return this.movedBlock.equalsValue(e+2*r)?["moved-fill"]:[]}getSquareClasses(e,r){const s=[],i=this.getPlayerClass(this.board[r][e]);return s.push(i),this.lastDrop.equalsValue(new P(e,r))&&s.push("last-move-stroke"),s}rotate(e){var r=this;return O(function*(){const i=r.canUserPlay("#rotate_"+e[1]+"_"+(e[2]?"clockwise":"counterclockwise"));if(i.isFailure())return r.cancelMove(i.getReason());const o=r.currentDrop.get(),c=Ts.withRotation(o.x,o.y,e[1],e[2]);return r.chooseMove(c,r.getState())})()}skipRotation(){var e=this;return O(function*(){const r=e.canUserPlay("#skipRotation");if(r.isFailure())return e.cancelMove(r.getReason());const s=e.currentDrop.get(),i=Ts.rotationless(s.x,s.y);return e.chooseMove(i,e.getState())})()}}return n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-pentago"]],features:[l],decls:9,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-60 -60 780 780"],["id","arrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#arrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#arrowhead)",1,"no-fill",3,"id","click"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,r){1&e&&(B(),N(0,"svg",0)(1,"defs")(2,"marker",1),X(3,"polygon",2),A()(),k(4,m6t,2,3,"ng-container",3),k(5,_6t,1,6,"circle",4),k(6,v6t,1,4,"path",5),k(7,C6t,1,7,"circle",6),k(8,y6t,3,9,"g",7),A()),2&e&&(M(4),w("ngForOf",N6(5,dce,r.BLOCK_SEPARATION)),M(1),w("ngIf",r.currentDrop.isPresent()),M(1),w("ngForOf",r.arrows),M(1),w("ngForOf",r.victoryCoords),M(1),w("ngIf",r.canSkipRotation))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Sn extends P{constructor(t,e,r){if(super(t,e),this.z=r,t<0||t>3)throw new Error(`PylosCoord: Invalid X: ${t}.`);if(e<0||e>3)throw new Error(`PylosCoord: Invalid Y: ${e}.`);if(r<0||r>3)throw new Error(`PylosCoord: Invalid Z: ${r}.`);const s=4-r;if(this.isNotInRange(s,s))throw new Error(this.toString()+" is not in range.")}static encodeOptional(t){let e;return e=t.isPresent()?Sn.encode(t.get())+1:0,e}static encode(t){return 16*t.x+4*t.y+t.z}static decodeToOptional(t){return 0===t?S.empty():S.of(Sn.decode(t-1))}static decode(t){const e=t%4;t-=e;const r=(t/=4)%4;return t-=r,new Sn(t/=4,r,e)}toString(){return"PylosCoord"+this.toShortString()}toShortString(){return"("+this.x+", "+this.y+", "+this.z+")"}equals(t){return this===t||t.x===this.x&&t.y===this.y&&t.z===this.z}isUpperThan(t){return this.z>t.z}getLowerPieces(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");const t=this.z-1;return[new Sn(this.x,this.y,t),new Sn(this.x+1,this.y,t),new Sn(this.x,this.y+1,t),new Sn(this.x+1,this.y+1,t)]}getHigherCoords(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");const t=this.z+1,e=new P(this.x-1,this.y-1),r=new P(this.x,this.y-1),s=new P(this.x-1,this.y),i=new P(this.x,this.y),o=4-t;return[e,r,s,i].filter(c=>c.isInRange(o,o)).map(c=>new Sn(c.x,c.y,t))}getNextValid(t){const e=new P(this.x,this.y).getNext(t),r=4-this.z;return e.isNotInRange(r,r)?S.empty():S.of(new Sn(e.x,e.y,this.z))}}let T0=(()=>{class n{}return n.MUST_MOVE_UPWARD=()=>$localize`You must move your pieces upward.`,n.SHOULD_HAVE_SUPPORTING_PIECES=()=>$localize`Your piece must land on the board or on 4 other pieces.`,n.CANNOT_MOVE_SUPPORTING_PIECE=()=>$localize`You cannot move a supporting piece.`,n.CANNOT_CAPTURE=()=>$localize`You cannot capture.`,n.INVALID_FIRST_CAPTURE=()=>$localize`Your first capture is invalid.`,n.INVALID_SECOND_CAPTURE=()=>$localize`Your second capture is invalid.`,n})(),pce=(()=>{class n{}return n.MUST_CAPTURE_MAXIMUM_TWO_PIECES=()=>$localize`You must capture one or two pieces, not more.`,n})();class us extends so{constructor(t,e,r,s){super(),this.startingCoord=t,this.landingCoord=e,this.firstCapture=r,this.secondCapture=s}static fromClimb(t,e,r){const s=S.of(t),i=us.checkCaptures(r),o=new us(s,e,i.firstCapture,i.secondCapture);if(!1===e.isUpperThan(t))throw new Error(T0.MUST_MOVE_UPWARD());return o}static checkCaptures(t){let e=S.empty(),r=S.empty();if(t.length>0&&(e=S.of(t[0]),t.length>1)){if(t[1].equals(t[0]))throw new Error("PylosMove: should not capture twice same piece.");if(r=S.of(t[1]),t[1].isUpperThan(t[0])&&(e=S.of(t[1]),r=S.of(t[0])),t.length>2)throw new Error(pce.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:e,secondCapture:r}}static fromDrop(t,e){const r=S.empty(),s=us.checkCaptures(e);return new us(r,t,s.firstCapture,s.secondCapture)}static changeCapture(t,e){const r=us.checkCaptures(e);return new us(t.startingCoord,t.landingCoord,r.firstCapture,r.secondCapture)}isClimb(){return this.startingCoord.isPresent()}toString(){const t=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),e=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),r=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+t+", "+this.landingCoord.toShortString()+", "+e+", "+r+")"}equals(t){return t===this||!!(this.startingCoord.equals(t.startingCoord)&&this.landingCoord.equals(t.landingCoord)&&this.firstCapture.equals(t.firstCapture)&&this.secondCapture.equals(t.secondCapture))}}us.encoder=new class extends on{maxValue(){return 17575999}encodeNumber(n){const t=Sn.encode(n.landingCoord),e=Sn.encodeOptional(n.startingCoord),r=Sn.encodeOptional(n.firstCapture);return 270400*Sn.encodeOptional(n.secondCapture)+4160*r+64*e+t}decodeNumber(n){const t=Sn.decode(n%64);n-=n%64;const e=Sn.decodeToOptional((n/=64)%65);n-=n%65;const r=Sn.decodeToOptional((n/=65)%65);n-=n%65;const s=Sn.decodeToOptional(n/=65);return new us(e,t,r,s)}};class lc extends MS{constructor(t,e){super(e),this.boards=t}static getInitialState(){const t=ht.createTable(4,4,fe.NONE),e=ht.createTable(3,3,fe.NONE),r=ht.createTable(2,2,fe.NONE);return new lc([t,e,r,[[fe.NONE]]],0)}static getLevelRange(t){switch(t){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return Ae.expectToBe(t,2),[0,1]}}getPieceAt(t){return this.boards[t.z][t.y][t.x]}applyLegalMove(t,e=!0){const r=[];let s;return r.push({coord:t.landingCoord,value:this.getCurrentPlayer()}),t.startingCoord.isPresent()&&r.push({coord:t.startingCoord.get(),value:fe.NONE}),t.firstCapture.isPresent()&&r.push({coord:t.firstCapture.get(),value:fe.NONE}),t.secondCapture.isPresent()&&r.push({coord:t.secondCapture.get(),value:fe.NONE}),s=e?this.turn+1:this.turn,this.setBoardAtCoords(r,s)}setBoardAtCoords(t,e){const r=[ht.copyBiArray(this.boards[0]),ht.copyBiArray(this.boards[1]),ht.copyBiArray(this.boards[2]),ht.copyBiArray(this.boards[3])];for(const s of t){const i=s.coord;r[i.z][i.y][i.x]=s.value}return new lc(r,e)}isLandable(t){if(this.getPieceAt(t).isPlayer())return!1;if(0===t.z)return!0;const e=t.getLowerPieces();for(const r of e)if(this.getPieceAt(r)===fe.NONE)return!1;return!0}isSupporting(t){if(3===t.z)return!1;const e=t.getHigherCoords();for(const r of e)if(this.getPieceAt(r).isPlayer())return!0;return!1}getPiecesRepartition(){const t={};t[fe.NONE.value]=0,t[F.ZERO.value]=0,t[F.ONE.value]=0;for(let e=0;e<3;e++)for(let r=0;r<4-e;r++)for(let s=0;s<4-e;s++){const i=new Sn(s,r,e),o=this.getPieceAt(i);t[o.value]=1+t[o.value]}return t}removePieceAt(t){return this.setBoardAtCoords([{coord:t,value:fe.NONE}],this.turn)}dropCurrentPlayersPieceAt(t){const e={coord:t,value:this.getCurrentPlayer()};return this.setBoardAtCoords([e],this.turn)}getFreeToMoves(){const t=[],e=this.getCurrentPlayer();for(let r=0;r<=2;r++){const s=lc.getLevelRange(r);for(const i of s)for(const o of s){const c=new Sn(o,i,r);this.getPieceAt(c).equals(e)&&!1===this.isSupporting(c)&&t.push(c)}}return t}}class ho extends hr{static getStateInfo(t){const e=[],r=[];for(let s=0;s<3;s++)for(let i=0;i<4-s;i++)for(let o=0;o<4-s;o++){const c=new Sn(o,i,s);t.getPieceAt(c)===t.getCurrentPlayer()&&!1===t.isSupporting(c)&&e.push(c),t.isLandable(c)&&r.push(c)}return{freeToMove:e,landable:r}}static getClimbingMoves(t){const e=[];for(const r of t.freeToMove)for(const s of t.landable)if(s.isUpperThan(r)&&!1===s.getLowerPieces().some(i=>r.equals(i))){const i=us.fromClimb(r,s,[]);e.push(i)}return e}static getDropMoves(t){const e=[];for(const r of t.landable){const s=us.fromDrop(r,[]);e.push(s)}return e}static canCapture(t,e){const r=t.getCurrentPlayer();for(const s of[De.UP,De.DOWN]){const i=e.getNextValid(s);if(i.isPresent()&&t.getPieceAt(i.get())===r)for(const o of[De.LEFT,De.RIGHT]){const c=i.get().getNextValid(o);if(c.isPresent()&&t.getPieceAt(c.get())===r){const u=s.getOpposite(),h=c.get().getNextValid(u).get();if(t.getPieceAt(h)===r)return!0}}}return!1}static getPossibleCaptures(t){const e=new Z1,r=t.getFreeToMoves();for(const s of r){e.add(new Z1([s]));const o=t.removePieceAt(s).getFreeToMoves();for(const c of o){const u=new Z1([s,c]);e.add(u)}}return e}static applyLegalMove(t,e,r){return e.applyLegalMove(t)}static isValidCapture(t,e,r){const s=t.getCurrentPlayer();return!(!r.equals(e.landingCoord)&&t.getPieceAt(r)!==s)&&0===r.getHigherCoords().filter(o=>t.getPieceAt(o).isPlayer()&&!1===o.equals(e.firstCapture.get())).length}static getGameStatus(t){const r=t.gameState.getPiecesRepartition();return 15===r[F.ZERO.value]?ze.ONE_WON:15===r[F.ONE.value]?ze.ZERO_WON:ze.ONGOING}applyLegalMove(t,e,r){return ho.applyLegalMove(t,e,r)}isLegal(t,e){const r=this.isLegalStartingCoord(t,e);if(r.isFailure())return K.failure(r.getReason());const s=r.get(),i=this.isLegalLandingCoord(t,s);if(i.isFailure())return K.failure(i.getReason());const o=i.get(),c=this.isLegalCaptures(t,o);return c.isFailure()?c:K.success(void 0)}isLegalStartingCoord(t,e){const r=e.getCurrentOpponent();if(t.startingCoord.isPresent()){const s=t.startingCoord.get(),i=e.getPieceAt(s);if(i===r)return K.failure(Mt.CANNOT_CHOOSE_OPPONENT_PIECE());if(i===fe.NONE)return K.failure(Mt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===s.getHigherCoords().filter(c=>e.getPieceAt(c).isPlayer()).length){const c=e.removePieceAt(t.startingCoord.get());return K.success(c)}return K.failure(T0.CANNOT_MOVE_SUPPORTING_PIECE())}return K.success(e)}isLegalLandingCoord(t,e){return e.getPieceAt(t.landingCoord).isPlayer()?K.failure(Mt.MUST_LAND_ON_EMPTY_SPACE()):e.isLandable(t.landingCoord)?K.success(e.dropCurrentPlayersPieceAt(t.landingCoord)):K.failure(T0.SHOULD_HAVE_SUPPORTING_PIECES())}isLegalCaptures(t,e){if(t.firstCapture.isAbsent())return K.success(void 0);if(!1===ho.canCapture(e,t.landingCoord))return K.failure(T0.CANNOT_CAPTURE());if(ho.isValidCapture(e,t,t.firstCapture.get())){const r=e.removePieceAt(t.firstCapture.get());return t.secondCapture.isAbsent()||ho.isValidCapture(r,t,t.secondCapture.get())?K.success(void 0):K.failure(T0.INVALID_SECOND_CAPTURE())}return K.failure(T0.INVALID_FIRST_CAPTURE())}getGameStatus(t){return ho.getGameStatus(t)}}class am extends rr{static getListMoves(t){const e=t.gameState,r=[],s=ho.getStateInfo(e),i=ho.getClimbingMoves(s),o=ho.getDropMoves(s),c=i.concat(o);for(const u of c){const h=e.applyLegalMove(u,!1);let g=new Z1;ho.canCapture(h,u.landingCoord)?g=ho.getPossibleCaptures(h):r.push(u);for(const m of g){const v=us.changeCapture(u,m.toList());r.push(v)}}return r}getListMoves(t){return am.getListMoves(t)}getBoardValue(t){const e=ho.getGameStatus(t);if(e.isEndGame)return new dt(e.toBoardValue());{const r=t.gameState.getPiecesRepartition();return new dt(r[F.ZERO.value]-r[F.ONE.value])}}}class Wf extends am{static countStoneUsed(t){let e=t.isClimb()?0:1;return t.firstCapture.isPresent()&&(e-=1,t.secondCapture.isPresent()&&(e-=1)),e}static sumMoveEmplacementByValue(t){let e=t.landingCoord.z;return t.startingCoord.isPresent()&&(e+=3-t.startingCoord.get().z),t.firstCapture.isPresent()&&(e+=3-t.firstCapture.get().z,t.secondCapture.isPresent()&&(e+=3-t.secondCapture.get().z)),e}getListMoves(t){const e=am.getListMoves(t);return this.orderMoves(e)}orderMoves(t){return t.sort((e,r)=>{const s=12*Wf.countStoneUsed(e),i=12*Wf.countStoneUsed(r);return s+Wf.sumMoveEmplacementByValue(e)-(i+Wf.sumMoveEmplacementByValue(r))})}}const et=fe.NONE,Il=fe.ZERO,gce=fe.ONE;class mce extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Goal of the game`,$localize`At Pylos, the goal is to be the last to play.
        To do this, you have to save up your pieces.
        As soon as a player puts its last piece, that player loses the game immediately.
        Here is what the initial board looks like, it is a board of 4 x 4 squares.
        This board will become a pyramid, little by little.
        It will be filled by the pieces of your stock. Each player has 15 pieces.`,lc.getInitialState()),pe.anyMove($localize`Dropping a piece`,$localize`When it is your turn, you can always drop one of your piece on an empty square.
        The gray squares are where you can drop your pieces.<br/><br/>
        Click on one of the squares to drop a piece there.`,lc.getInitialState(),us.fromDrop(new Sn(1,1,0),[]),$localize`There you go, as simple as that.`),pe.fromMove($localize`Climbing`,$localize`When 4 pieces form a square, it is possible to put a fifth piece on top.
        However, when that happens, you can save a piece by climbing instead of dropping a piece.
        To climb:
        <ol>
            <li>Click on one of your free pieces, which should be lower than the landing square.</li>
            <li>Click on an empty landing square, higher than your selected piece.</li>
        </ol><br/>
        Go ahead, climb!`,new lc([[[Il,gce,et,et],[gce,Il,et,et],[et,et,et,et],[et,et,et,Il]],[[et,et,et],[et,et,et],[et,et,et]],[[et,et],[et,et]],[[et]]],0),[us.fromClimb(new Sn(3,3,0),new Sn(0,0,1),[])],$localize`Congratulations!<br/>
        Some important notes:
        <ol>
            <li>You cannot move a piece that is directly below another one.</li>
            <li>Of course, you cannot move the opponent's pieces.</li>
            <li>You can only climb when the landing square is higher than the starting square.</li>
        </ol>`,$localize`Failed!`),pe.fromMove($localize`Square (1/2)`,$localize`When the piece you just moved or dropped is the fourth one of a square of your color,
        you can choose anywhere on the board one or two of your pieces.
        These pieces will be removed from the board, allowing you to save up one or two pieces.
        A chosen piece must not be directly below another piece.
        A chosen piece can be the piece you just placed.
        You're playing Dark.<br/><br/>
        Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move.`,new lc([[[Il,Il,et,et],[et,Il,et,et],[et,et,et,et],[et,et,et,et]],[[et,et,et],[et,et,et],[et,et,et]],[[et,et],[et,et]],[[et]]],0),[us.fromDrop(new Sn(0,1,0),[new Sn(0,0,0)]),us.fromDrop(new Sn(0,1,0),[new Sn(0,1,0)]),us.fromDrop(new Sn(0,1,0),[new Sn(1,0,0)]),us.fromDrop(new Sn(0,1,0),[new Sn(1,1,0)])],$localize`Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece.`,$localize`Failed!`),pe.fromPredicate($localize`Square (2/2)`,$localize`You're playing Dark.<br/><br/>
        Do like in the previous step, but this time click on two different pieces before validating.`,new lc([[[Il,Il,et,et],[et,Il,et,et],[et,et,et,et],[et,et,et,et]],[[et,et,et],[et,et,et],[et,et,et]],[[et,et],[et,et]],[[et]]],0),us.fromDrop(new Sn(0,1,0),[new Sn(0,0,0),new Sn(1,0,0)]),(t,e,r)=>t.secondCapture.isPresent()?G.SUCCESS:t.firstCapture.isPresent()?G.failure($localize`Failed, you only captured one piece.`):G.failure(oce.YOU_DID_NOT_CAPTURE_ANY_PIECE()),$localize`Congratulations, you have saved up two pieces.`)]}}function M6t(n,t){if(1&n&&(B(),X(0,"circle",8)),2&n){const e=t.$implicit,r=E().$implicit,s=E();je("id","piece_",r.value,"_",e,""),w("ngClass",s.getPlayerClass(r)),V("cx",s.SPACE_SIZE/4+e/15*(s.BOARD_WIDTH-s.SPACE_SIZE/4))("cy",s.getPiecesCyForPlayer(r))("r",s.SPACE_SIZE/4-s.STROKE_WIDTH)}}function S6t(n,t){if(1&n&&(B(),N(0,"g"),k(1,M6t,1,6,"circle",7),A()),2&n){const e=t.$implicit,r=E();M(1),w("ngForOf",r.getPlayerSidePieces(e))}}function P6t(n,t){if(1&n){const e=we();B(),N(0,"circle",12),se("click",function(){he(e);const s=E(2).$implicit,i=E().$implicit,o=E().$implicit;return ce(E().onPieceClick(s,i,o))}),A()}if(2&n){const e=E(2).$implicit,r=E().$implicit,s=E().$implicit,i=E();D3("id","piece_",e,"_",r,"_",s,""),w("ngClass",i.getPieceClasses(e,r,s)),V("r",i.getPieceRadius(s)-i.STROKE_WIDTH)("cx",i.getPieceCx(e,r,s))("cy",i.getPieceCy(e,r,s))}}function T6t(n,t){if(1&n){const e=we();B(),N(0,"rect",12),se("click",function(){he(e);const s=E(3).$implicit,i=E().$implicit,o=E().$implicit;return ce(E().onDrop(s,i,o))}),A()}if(2&n){const e=E(3).$implicit,r=E().$implicit,s=E().$implicit,i=E();D3("id","drop_",e,"_",r,"_",s,""),w("ngClass",i.getSquareClasses(e,r,s)),V("width",2*i.getPieceRadius(s))("height",2*i.getPieceRadius(s))("x",i.getPieceCx(e,r,s)-i.getPieceRadius(s))("y",i.getPieceCy(e,r,s)-i.getPieceRadius(s))}}function w6t(n,t){if(1&n&&(B(),k(0,T6t,1,8,"rect",13)),2&n){const e=E(2).$implicit,r=E().$implicit,s=E().$implicit;w("ngIf",E().mustDisplayLandingCoord(e,r,s))}}function b6t(n,t){if(1&n&&(B(),nn(0),k(1,P6t,1,7,"circle",10),k(2,w6t,1,1,"ng-template",null,11,l1),rn()),2&n){const e=s1(3),r=E().$implicit,s=E().$implicit,i=E().$implicit,o=E();M(1),w("ngIf",o.isOccupied(r,s,i))("ngIfElse",e)}}function N6t(n,t){if(1&n&&(B(),N(0,"g"),k(1,b6t,4,2,"ng-container",9),A()),2&n){const e=t.$implicit,r=E().$implicit,s=E().$implicit,i=E();M(1),w("ngIf",i.mustDraw(e,r,s))}}function A6t(n,t){if(1&n&&(B(),N(0,"g"),k(1,N6t,2,1,"g",1),A()),2&n){const e=E().$implicit,r=E();M(1),w("ngForOf",r.getLevelRange(e))}}function O6t(n,t){if(1&n&&(B(),N(0,"g"),k(1,A6t,2,1,"g",1),A()),2&n){const e=t.$implicit,r=E();M(1),w("ngForOf",r.getLevelRange(e))}}function I6t(n,t){if(1&n&&(B(),X(0,"rect",14)),2&n){const e=E();D3("id","highCapture_",e.highCapture.get().x,"_",e.highCapture.get().y,"_",e.highCapture.get().z,""),V("width",2*e.getPieceRadius(e.highCapture.get().z))("height",2*e.getPieceRadius(e.highCapture.get().z))("x",e.getPieceCxByCoord(e.highCapture.get())-e.getPieceRadius(e.highCapture.get().z))("y",e.getPieceCyByCoord(e.highCapture.get())-e.getPieceRadius(e.highCapture.get().z))}}function x6t(n,t){if(1&n){const e=we();B(),N(0,"g",15),se("click",function(){return he(e),ce(E().validateCapture())}),X(1,"circle",16)(2,"polygon",17),A()}if(2&n){const e=E();V("transform","translate("+4*e.SPACE_SIZE+" "+4*e.SPACE_SIZE+")"),M(1),w("ngClass",e.getCaptureValidationButtonClasses()),V("cx",e.STROKE_WIDTH/2)("cy",e.STROKE_WIDTH/2)("r",e.SPACE_SIZE/2)}}function L6t(n,t){if(1&n){const e=we();B(),N(0,"g",18),se("click",function(){const i=he(e).$implicit;return ce(E().onPieceClick(i.x,i.y,i.z))}),X(1,"line",19)(2,"line",19),A()}if(2&n){const e=t.$implicit,r=E();D3("id","capturable_",e.x,"_",e.y,"_",e.z,""),V("transform","translate("+r.getPieceCxByCoord(e)+" "+r.getPieceCyByCoord(e)+")"),M(1),V("x1",-.25*r.getPieceRadius(e.z))("y1",-.25*r.getPieceRadius(e.z))("x2",.25*r.getPieceRadius(e.z))("y2",.25*r.getPieceRadius(e.z)),M(1),V("x1",.25*r.getPieceRadius(e.z))("y1",-.25*r.getPieceRadius(e.z))("x2",-.25*r.getPieceRadius(e.z))("y2",.25*r.getPieceRadius(e.z))}}const k6t=function(){return[0,1,2]};let R6t=(()=>{class n extends m0{constructor(e){super(e),this.BOARD_WIDTH=4*this.SPACE_SIZE+this.STROKE_WIDTH,this.PIECE_ROW_HEIGHT=this.SPACE_SIZE/2,this.BOARD_HEIGHT=this.BOARD_WIDTH+2*this.PIECE_ROW_HEIGHT,this.lastLandingCoord=S.empty(),this.lastStartingCoord=S.empty(),this.lastFirstCapture=S.empty(),this.lastSecondCapture=S.empty(),this.highCapture=S.empty(),this.capturables=[],this.chosenStartingCoord=S.empty(),this.chosenLandingCoord=S.empty(),this.chosenFirstCapture=S.empty(),this.chosenSecondCapture=S.empty(),this.lastMove=S.empty(),this.remainingPieces={0:15,1:15},this.hasAsymetricBoard=!0,this.rules=new ho(lc),this.availableMinimaxes=[new am(this.rules,"PylosMinimax"),new Wf(this.rules,"PylosOrderedMinimax")],this.encoder=us.encoder,this.tutorial=(new mce).tutorial,this.updateBoard()}getPiecesCyForPlayer(e){return e===F.ONE?this.PIECE_ROW_HEIGHT/2:this.BOARD_WIDTH+1.5*this.PIECE_ROW_HEIGHT}getLevelRange(e){return lc.getLevelRange(e)}mustDraw(e,r,s){const i=new Sn(e,r,s);return!!(this.constructedState.getPieceAt(i).isPlayer()||this.justClimbed(i)||this.isCaptured(i))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(i)}isCaptured(e){return this.chosenFirstCapture.equalsValue(e)||this.chosenSecondCapture.equalsValue(e)}onPieceClick(e,r,s){var i=this;return O(function*(){const o=i.canUserPlay("#piece_"+e+"_"+r+"_"+s);if(o.isFailure())return i.cancelMove(o.getReason());const c=new Sn(e,r,s);return i.state.getPieceAt(c)===i.state.getCurrentOpponent()?i.cancelMove(Mt.CANNOT_CHOOSE_OPPONENT_PIECE()):i.chosenStartingCoord.equalsValue(c)?(i.cancelMoveAttempt(),G.SUCCESS):i.chosenLandingCoord.isPresent()?i.isSupporting(c,i.constructedState)?i.cancelMove(T0.CANNOT_MOVE_SUPPORTING_PIECE()):i.onCaptureClick(c):i.isSupporting(c,i.getState())?i.cancelMove(T0.CANNOT_MOVE_SUPPORTING_PIECE()):i.onClimbClick(c)})()}isSupporting(e,r){return r.isSupporting(e)}onClimbClick(e){var r=this;return O(function*(){return r.chosenStartingCoord=S.of(e),r.constructedState=r.constructedState.removePieceAt(e),G.SUCCESS})()}onCaptureClick(e){var r=this;return O(function*(){return r.chosenFirstCapture.equalsValue(e)?(r.chosenFirstCapture=S.empty(),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(e),r.updateCapturableList(),G.SUCCESS):r.chosenSecondCapture.equalsValue(e)?(r.chosenSecondCapture=S.empty(),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(e),r.updateCapturableList(),G.SUCCESS):r.chosenFirstCapture.isAbsent()?(r.chosenFirstCapture=S.of(e),r.constructedState=r.constructedState.removePieceAt(e),r.updateCapturableList(),G.SUCCESS):r.chosenSecondCapture.isAbsent()?(r.chosenSecondCapture=S.of(e),r.constructedState=r.constructedState.removePieceAt(e),r.updateCapturableList(),G.SUCCESS):r.cancelMove(pce.MUST_CAPTURE_MAXIMUM_TWO_PIECES())})()}updateCapturableList(){this.capturables=this.constructedState.getFreeToMoves()}getCaptureValidationButtonClasses(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}validateCapture(){var e=this;return O(function*(){const r=e.canUserPlay("#capture_validation");return r.isFailure()?e.cancelMove(r.getReason()):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isAbsent()?G.SUCCESS:e.chosenFirstCapture.isPresent()&&e.chosenSecondCapture.isAbsent()?e.concludeMoveWithCapture([e.chosenFirstCapture.get()]):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isPresent()?e.concludeMoveWithCapture([e.chosenSecondCapture.get()]):e.concludeMoveWithCapture([e.chosenFirstCapture.get(),e.chosenSecondCapture.get()])})()}concludeMoveWithCapture(e){var r=this;return O(function*(){let s;return s=r.chosenStartingCoord.isAbsent()?us.fromDrop(r.chosenLandingCoord.get(),e):us.fromClimb(r.chosenStartingCoord.get(),r.chosenLandingCoord.get(),e),r.tryMove(s,r.state)})()}tryMove(e,r){var s=this;return O(function*(){return s.cancelMove(),s.chooseMove(e,r)})()}cancelMoveAttempt(){this.constructedState=this.state,this.chosenStartingCoord=S.empty(),this.chosenLandingCoord=S.empty(),this.chosenFirstCapture=S.empty(),this.chosenSecondCapture=S.empty(),this.capturables=[]}onDrop(e,r,s){var i=this;return O(function*(){const o=i.canUserPlay("#drop_"+e+"_"+r+"_"+s);if(o.isFailure())return i.cancelMove(o.getReason());const c=new Sn(e,r,s);return ho.canCapture(i.constructedState,c)?(i.chosenLandingCoord=S.of(c),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(c),i.updateCapturableList(),G.SUCCESS):(i.chosenLandingCoord=S.of(c),i.concludeMoveWithCapture([]))})()}getSquareClasses(e,r,s){const i=new Sn(e,r,s);if(this.lastMove.isPresent()){const o=this.lastMove.get();if(o.firstCapture.equalsValue(i)||o.secondCapture.equalsValue(i))return["captured-fill"];if(i.equals(o.landingCoord)||o.startingCoord.equalsValue(i))return["moved-fill"]}else if(this.justClimbed(i))return["moved-fill"];return[]}justClimbed(e){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(e)}getPieceRadius(e){return this.SPACE_SIZE*(.45+.025*e)}getPieceCx(e,r,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+e*this.SPACE_SIZE}getPieceCy(e,r,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+r*this.SPACE_SIZE}getPieceCxByCoord(e){return this.getPieceCx(e.x,e.y,e.z)}getPieceCyByCoord(e){return this.getPieceCy(e.x,e.y,e.z)}isOccupied(e,r,s){const i=new Sn(e,r,s);if(this.justClimbed(i))return!1;const o=this.getState().getPieceAt(i).isPlayer(),c=this.chosenLandingCoord.equalsValue(i);return o||c}getPieceClasses(e,r,s){const i=new Sn(e,r,s),o=[this.getPieceFillClass(i)];return(this.lastLandingCoord.equalsValue(i)||this.lastStartingCoord.equalsValue(i))&&o.push("last-move-stroke"),(this.chosenStartingCoord.equalsValue(i)||this.chosenLandingCoord.equalsValue(i))&&o.push("selected-stroke"),this.isCaptured(i)&&o.push("pre-captured-fill"),o}getPieceFillClass(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(e))}getPlayerSidePieces(e){const r=this.remainingPieces[e.value],s=[];for(let i=0;i<r;i++)s.push(i);return s}updateBoard(){this.state=this.getState(),this.constructedState=this.state,this.lastMove=this.rules.node.move;const e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=S.empty(),this.cancelMoveAttempt(),this.lastMove.isPresent()?this.showLastMove():this.hideLastMove()}showLastMove(){const e=this.lastMove.get();this.lastLandingCoord=S.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.mustDrawCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}hideLastMove(){this.lastStartingCoord=S.empty(),this.lastLandingCoord=S.empty(),this.lastFirstCapture=S.empty(),this.lastSecondCapture=S.empty()}mustDrawCoord(e){return this.mustDraw(e.x,e.y,e.z)}mustDisplayLandingCoord(e,r,s){return!this.chosenStartingCoord.isPresent()||!!this.chosenStartingCoord.get().equals(new Sn(e,r,s))||this.chosenStartingCoord.get().z<s}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-pylos"]],features:[l],decls:10,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured-fill small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","captured-fill","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id","click"],["stroke-width","8","stroke","red"]],template:function(e,r){1&e&&(B(),N(0,"svg",0)(1,"g"),k(2,S6t,2,1,"g",1),A(),N(3,"g",null,2),X(5,"rect",3),k(6,O6t,2,1,"g",1),k(7,I6t,1,7,"rect",4),k(8,x6t,3,5,"g",5),k(9,L6t,3,12,"g",6),A()()),2&e&&(V("viewBox","0 0 "+r.BOARD_WIDTH+" "+r.BOARD_HEIGHT),M(1),V("transform","rotate("+180*r.role.value+" "+r.BOARD_WIDTH/2+" "+r.BOARD_HEIGHT/2+")"),M(1),w("ngForOf",r.Player.PLAYERS),M(1),V("transform","translate("+r.STROKE_WIDTH/2+" "+(r.STROKE_WIDTH/2+r.PIECE_ROW_HEIGHT)+")"),M(2),V("width",4*r.SPACE_SIZE)("height",4*r.SPACE_SIZE),M(1),w("ngForOf",ar(10,k6t)),M(1),w("ngIf",r.highCapture.isPresent()),M(1),w("ngIf",r.chosenLandingCoord.isPresent()),M(1),w("ngForOf",r.capturables))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Ge{constructor(t){this.value=t}static fromInt(t){if(0<=t&&t<=15)return Ge.pieces[t];if(16===t)return Ge.EMPTY;throw new Error("Invalid piece ("+t+")")}equals(t){return this===t}toString(){return"QuartoPiece("+this.value+")"}isRectangle(){return this.value%4<2}}Ge.AAAA=new Ge(0),Ge.AAAB=new Ge(1),Ge.AABA=new Ge(2),Ge.AABB=new Ge(3),Ge.ABAA=new Ge(4),Ge.ABAB=new Ge(5),Ge.ABBA=new Ge(6),Ge.ABBB=new Ge(7),Ge.BAAA=new Ge(8),Ge.BAAB=new Ge(9),Ge.BABA=new Ge(10),Ge.BABB=new Ge(11),Ge.BBAA=new Ge(12),Ge.BBAB=new Ge(13),Ge.BBBA=new Ge(14),Ge.BBBB=new Ge(15),Ge.EMPTY=new Ge(16),Ge.pieces=[Ge.AAAA,Ge.AAAB,Ge.AABA,Ge.AABB,Ge.ABAA,Ge.ABAB,Ge.ABBA,Ge.ABBB,Ge.BAAA,Ge.BAAB,Ge.BABA,Ge.BABB,Ge.BBAA,Ge.BBAB,Ge.BBBA,Ge.BBBB];class a4 extends Yc{constructor(t,e,r){super(t,e),this.piece=r}toString(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}equals(t){return this===t||!!t.coord.equals(this.coord)&&this.piece===t.piece}}a4.encoder=new class extends on{maxValue(){return 496}encodeNumber(n){return 128*n.coord.x+32*n.coord.y+n.piece.value}decodeNumber(n){const t=n%32;n-=t;const e=(n/=32)%4;return n-=e,new a4(n/=4,e,Ge.fromInt(t))}};class uc extends Vs{constructor(t,e,r){super(t,e),this.pieceInHand=r}static getInitialState(){const t=ht.createTable(4,4,Ge.EMPTY);return new uc(t,0,Ge.AAAA)}static isGivable(t,e,r){return t!==r&&!1===uc.isAlreadyOnBoard(t,e)}static isAlreadyOnBoard(t,e){for(let r=0;r<4;r++)for(let s=0;s<4;s++)if(e[r][s]===t)return!0;return!1}getRemainingPieces(){const t=Ge.pieces,e=[];for(const r of t)uc.isGivable(r,this.board,this.pieceInHand)&&e.push(r);return e}}let LV=(()=>{class n{}return n.MUST_GIVE_A_PIECE=()=>$localize`You must give a piece.`,n.PIECE_ALREADY_ON_BOARD=()=>$localize`That piece is already on the board.`,n.CANNOT_GIVE_PIECE_IN_HAND=()=>$localize`You cannot give the piece that was in your hands.`,n})();class cm{constructor(t){this.subCriterion=[S.empty(),S.empty(),S.empty(),S.empty()],this.subCriterion[0]=S.of(8==(8&t.value)),this.subCriterion[1]=S.of(4==(4&t.value)),this.subCriterion[2]=S.of(2==(2&t.value)),this.subCriterion[3]=S.of(1==(1&t.value))}mergeWith(t){let e=4;for(let r=0;r<4;r++)!1===this.subCriterion[r].equals(t.subCriterion[r])&&(this.subCriterion[r]=S.empty()),this.subCriterion[r].isAbsent()&&e--;return e>0}mergeWithQuartoPiece(t){const e=new cm(t);return this.mergeWith(e)}areAllAbsent(){for(let t=0;t<4;t++)if(this.subCriterion[t].isPresent())return!1;return!0}match(t){for(let e=0;e<4;e++)if(this.subCriterion[e].equals(t.subCriterion[e]))return!0;return!1}matchPiece(t){return this.match(new cm(t))}toString(){return"Criterion{"+this.subCriterion.map(t=>t.isPresent()?t.get()?"1":"0":"x").join(" ")+"}"}}class c4{constructor(t,e){this.initialCoord=t,this.direction=e}allCoords(){const t=[];for(let e=0;e<4;e++)t.push(this.initialCoord.getNext(this.direction,e));return t}}class Bs extends hr{static isOccupied(t){return t!==Ge.EMPTY}static isLegal(t,e){const r=t.coord.x,s=t.coord.y,i=t.piece,o=e.getCopiedBoard(),c=e.pieceInHand;return Bs.isOccupied(o[s][r])?G.failure(Mt.MUST_LAND_ON_EMPTY_SPACE()):i===Ge.EMPTY?15===e.turn?G.SUCCESS:G.failure(LV.MUST_GIVE_A_PIECE()):uc.isAlreadyOnBoard(i,o)?G.failure(LV.PIECE_ALREADY_ON_BOARD()):c===i?G.failure(LV.CANNOT_GIVE_PIECE_IN_HAND()):G.SUCCESS}isLegal(t,e){return Bs.isLegal(t,e).toFallible(void 0)}applyLegalMove(t,e){const r=e.getCopiedBoard();return r[t.coord.y][t.coord.x]=e.pieceInHand,new uc(r,e.turn+1,t.piece)}static updateBoardStatus(t,e,r){return r.score===Mn.PRE_VICTORY?this.isThereAVictoriousLine(t,e)?{score:Mn.VICTORY,sensitiveSquares:new dr}:r:this.searchForVictoryOrPreVictoryInLine(t,e,r)}static isThereAVictoriousLine(t,e){let r=t.initialCoord,s=e.getPieceAt(r);const i=new cm(s);for(let o=0;o<3&&!1!==Bs.isOccupied(s)&&!i.areAllAbsent();o++)r=r.getNext(t.direction,1),s=e.getPieceAt(r),i.mergeWithQuartoPiece(s);return!(!Bs.isOccupied(s)||i.areAllAbsent())}static searchForVictoryOrPreVictoryInLine(t,e,r){const s=Bs.getLineInfos(t,e,r);if(s.boardStatus.isPresent())return s.boardStatus.get();const i=s.commonCriterion,o=s.sensitiveCoord;if(i.isPresent()&&!1===i.get().areAllAbsent()){if(o.isAbsent())return{score:Mn.VICTORY,sensitiveSquares:new dr};{i.get().matchPiece(e.pieceInHand)&&(r.score=Mn.PRE_VICTORY);const c=o.get();r.sensitiveSquares.add(c)}}return r}static getLineInfos(t,e,r){let s=S.empty(),i=S.empty(),o=t.initialCoord;for(let c=0;c<4;c++){const u=e.getPieceAt(o);if(u===Ge.EMPTY){if(!s.isAbsent())return{sensitiveCoord:S.of(o),commonCriterion:i,boardStatus:S.of(r)};s=S.of(o)}else i.isAbsent()?(i=S.of(new cm(u)),Y(Bs.VERBOSE,"set commonCrit to "+i.toString())):(i.get().mergeWithQuartoPiece(u),Y(Bs.VERBOSE,"update commonCrit: "+i.toString()));o=o.getNext(t.direction,1)}return{commonCriterion:i,sensitiveCoord:s,boardStatus:S.empty()}}static scoreToGameStatus(t,e){const r=F.of(e%2);return t===Mn.VICTORY?ze.getDefeat(r):16===e?ze.DRAW:ze.ONGOING}getGameStatus(t){const e=t.gameState;let r={score:Mn.DEFAULT,sensitiveSquares:new dr};for(const s of Bs.lines)if(r=Bs.updateBoardStatus(s,e,r),r.score===Mn.VICTORY)return Bs.scoreToGameStatus(r.score,e.turn);return Bs.scoreToGameStatus(r.score,e.turn)}getVictoriousCoords(t){for(const e of Bs.lines)if(Bs.isThereAVictoriousLine(e,t))return e.allCoords();return[]}}Bs.VERBOSE=!1,Bs.lines=[new c4(new P(0,0),Pe.DOWN),new c4(new P(1,0),Pe.DOWN),new c4(new P(2,0),Pe.DOWN),new c4(new P(3,0),Pe.DOWN),new c4(new P(0,0),Pe.RIGHT),new c4(new P(0,1),Pe.RIGHT),new c4(new P(0,2),Pe.RIGHT),new c4(new P(0,3),Pe.RIGHT),new c4(new P(0,0),Pe.DOWN_RIGHT),new c4(new P(0,3),Pe.UP_RIGHT)];class kV extends rr{static scoreToBoardValue(t,e){if(t===Mn.DEFAULT)return new dt(0);{const r=F.of(e%2);return new dt(t===Mn.PRE_VICTORY?r.getPreVictory():r.getDefeatValue())}}getListMoves(t){const e=[],r=t.gameState,s=r.getCopiedBoard(),i=r.getRemainingPieces(),o=r.pieceInHand;let c;for(let u=0;u<4;u++)for(let h=0;h<4;h++)if(s[u][h]===Ge.EMPTY){if(c=r.getCopiedBoard(),c[u][h]=o,15===r.turn){const g=new a4(h,u,Ge.EMPTY);return e.push(g),e}for(const g of i){const m=new a4(h,u,g);e.push(m)}}return e}getBoardValue(t){const e=t.gameState;let r={score:Mn.DEFAULT,sensitiveSquares:new dr};for(const s of Bs.lines)if(r=Bs.updateBoardStatus(s,e,r),r.score===Mn.VICTORY)break;return kV.scoreToBoardValue(r.score,e.turn)}}const D6t=Ge.AABA,z6t=Ge.AABB,_ce=Ge.ABAA,V6t=Ge.ABAB,H6t=Ge.ABBA,vce=Ge.BAAA,F6t=Ge.BAAB,B6t=Ge.BABB,Cce=Ge.BBAA,$6t=Ge.BBAB,RV=Ge.BBBA,U6t=Ge.BBBB,N1=Ge.EMPTY;class yce extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Goal of the game`,$localize`Quarto is an alignment game.
        The goal is to align four pieces that have at least one common aspect:
        <ul>
          <li>their color (light or dark),</li>
          <li>their size (big or small),</li>
          <li>their pattern (empty or dotted),</li>
          <li>their shape (round or square).</li>
        </ul>
        Here, we have a board with a victory by an alignment of dark pieces.`,new uc([[RV,Cce,_ce,D6t],[N1,N1,N1,N1],[N1,N1,N1,N1],[N1,N1,N1,N1]],7,Ge.ABAB)),pe.anyMove($localize`Placement`,$localize`Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,
        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.
        If you prefer, the order of these two steps can be reversed.
        Keep in mind that the second click confirms the move.<br/><br/>
        Make a move.`,new uc([[RV,z6t,H6t,N1],[N1,N1,N1,N1],[N1,vce,N1,N1],[N1,N1,N1,N1]],7,Ge.ABAA),new a4(2,2,Ge.BAAB),$localize`Perfect!`),pe.fromMove($localize`Situation`,$localize`We have here a tricky situation.<br/><br/>
        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move.`,new uc([[U6t,RV,$6t,N1],[_ce,B6t,Cce,N1],[V6t,vce,F6t,N1],[N1,N1,N1,N1]],7,Ge.AABA),[new a4(3,3,Ge.AABB)],$localize`Well done!`,$localize`Failed!`)]}}function G6t(n,t){if(1&n&&(B(),X(0,"rect",12)),2&n){const e=E(2),r=e.$implicit,s=e.index,i=E().index,o=E();w("ngClass",o.getPieceClasses(r.value)),V("x",o.SPACE_SIZE*s+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("y",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("width",2*o.getPieceSize(r.value))("height",2*o.getPieceSize(r.value))}}function W6t(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=E(2),r=e.$implicit,s=e.index,i=E().index,o=E();w("ngClass",o.getPieceClasses(r.value)),V("cx",o.SPACE_SIZE*s+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("r",o.getPieceSize(r.value))}}function q6t(n,t){if(1&n&&(B(),X(0,"circle")),2&n){const e=E(2).index,r=E().index,s=E();V("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",10)}}function j6t(n,t){if(1&n&&(B(),N(0,"g"),k(1,G6t,1,5,"rect",10),k(2,W6t,1,4,"ng-template",null,11,l1),k(4,q6t,1,3,"circle",7),A()),2&n){const e=s1(3),r=E().$implicit,s=E(2);M(1),w("ngIf",r.isRectangle())("ngIfElse",e),M(3),w("ngIf",s.pieceHasDot(r.value))}}function Z6t(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"rect",9),se("click",function(){const i=he(e).index,o=E().index;return ce(E().chooseCoord(i,o))}),A(),k(2,j6t,5,3,"g",7),A()}if(2&n){const e=t.$implicit,r=t.index,s=E().index,i=E();M(1),je("id","chooseCoord_",r,"_",s,""),w("ngClass",i.getSquareClasses(r,s)),V("x",i.SPACE_SIZE*r)("y",i.SPACE_SIZE*s)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),M(1),w("ngIf",e!==i.EMPTY)}}function Y6t(n,t){if(1&n&&(B(),N(0,"g",null,8),k(2,Z6t,3,8,"g",2),A()),2&n){const e=t.$implicit;M(2),w("ngForOf",e)}}function K6t(n,t){if(1&n&&(B(),X(0,"rect",17)),2&n){const e=E(2);w("ngClass",e.getPieceClasses(e.pieceInHand.value)),V("x",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("y",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function X6t(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=E(2);w("ngClass",e.getPieceClasses(e.pieceInHand.value)),V("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",e.getPieceSize(e.pieceInHand.value))}}function Q6t(n,t){if(1&n&&(B(),X(0,"circle")),2&n){const e=E(2);V("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",10)}}function J6t(n,t){if(1&n){const e=we();B(),N(0,"g",13,14),se("click",function(){return he(e),ce(E().deselectDroppedPiece())}),X(2,"rect",15),k(3,K6t,1,5,"rect",16),k(4,X6t,1,4,"ng-template",null,11,l1),k(6,Q6t,1,3,"circle",7),A()}if(2&n){const e=s1(5),r=E();je("id","droppedPiece_",r.chosen.get().x,"_",r.chosen.get().y,""),V("transform","translate("+r.chosen.get().x*r.SPACE_SIZE+" "+r.chosen.get().y*r.SPACE_SIZE+")"),M(2),V("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),M(1),w("ngIf",r.pieceInHand.isRectangle())("ngIfElse",e),M(3),w("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function e0t(n,t){if(1&n&&(B(),N(0,"g",null,18),X(2,"rect",19),A()),2&n){const e=t.$implicit,r=E();M(2),V("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)("transform","translate("+e.x*r.SPACE_SIZE+" "+e.y*r.SPACE_SIZE+")")}}function t0t(n,t){if(1&n&&(B(),X(0,"rect",12)),2&n){const e=E(2);w("ngClass",e.getPieceClasses(e.pieceInHand.value)),V("x",0)("y",.75*e.SPACE_SIZE)("transform","translate("+-e.getPieceSize(e.pieceInHand.value)+", "+-e.getPieceSize(e.pieceInHand.value)+")")("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function n0t(n,t){if(1&n&&(B(),X(0,"circle",21)),2&n){const e=E(2);w("ngClass",e.getPieceClasses(e.pieceInHand.value)),V("cy",.75*e.SPACE_SIZE)("r",e.getPieceSize(e.pieceInHand.value))}}function r0t(n,t){1&n&&(B(),X(0,"circle",22)),2&n&&V("cy",.75*E(2).SPACE_SIZE)("r",10)}function s0t(n,t){if(1&n&&(B(),N(0,"g"),k(1,t0t,1,6,"rect",10),k(2,n0t,1,3,"ng-template",null,11,l1),k(4,r0t,1,2,"circle",20),A()),2&n){const e=s1(3),r=E();M(1),w("ngIf",r.pieceInHand.isRectangle())("ngIfElse",e),M(3),w("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function i0t(n,t){if(1&n&&(B(),X(0,"rect",27)),2&n){const e=E(2).index,r=E().index,s=E();L1("id","chosenPiece_",4*r+e,""),V("x",s.SPACE_SIZE*e)("y",s.SPACE_SIZE*r)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE)}}function o0t(n,t){if(1&n&&(B(),X(0,"rect",12)),2&n){const e=E(2).index,r=E().index,s=E();w("ngClass",s.getPieceClasses(4*r+e)),V("x",s.SPACE_SIZE*e+s.SPACE_SIZE/2-s.getPieceSize(4*r+e))("y",s.SPACE_SIZE*r+s.SPACE_SIZE/2-s.getPieceSize(4*r+e))("width",2*s.getPieceSize(4*r+e))("height",2*s.getPieceSize(4*r+e))}}function a0t(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=E(2).index,r=E().index,s=E();w("ngClass",s.getPieceClasses(4*r+e)),V("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",s.getPieceSize(4*r+e))}}function c0t(n,t){if(1&n&&(B(),X(0,"circle")),2&n){const e=E(2).index,r=E().index,s=E();V("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",10)}}function l0t(n,t){if(1&n){const e=we();B(),N(0,"g",13),se("click",function(){he(e);const s=E().index,i=E().index;return ce(E().choosePiece(4*i+s))}),k(1,i0t,1,5,"rect",26),k(2,o0t,1,5,"rect",10),k(3,a0t,1,4,"ng-template",null,11,l1),k(5,c0t,1,3,"circle",7),A()}if(2&n){const e=s1(4),r=E().index,s=E().index,i=E();L1("id","choosePiece_",4*s+r,""),M(1),w("ngIf",i.pieceToGive.equalsValue(i.QuartoPiece.fromInt(4*s+r))),M(1),w("ngIf",(4*s+r)%4<2)("ngIfElse",e),M(3),w("ngIf",i.pieceHasDot(4*s+r))}}function u0t(n,t){if(1&n&&(B(),N(0,"g"),k(1,l0t,6,5,"g",3),A()),2&n){const e=t.index,r=E().index,s=E();M(1),w("ngIf",s.isRemaining(4*r+e))}}function f0t(n,t){if(1&n&&(B(),N(0,"g",null,23),X(2,"rect",24,25),k(4,u0t,2,1,"g",2),A()),2&n){const e=t.$implicit,r=E();V("transform","translate(0 "+6.5*r.SPACE_SIZE+")"),M(2),V("x",-.125*r.SPACE_SIZE)("y",-.125*r.SPACE_SIZE)("width",4.25*r.SPACE_SIZE)("height",4.25*r.SPACE_SIZE),M(2),w("ngForOf",e)}}let h0t=(()=>{class n extends Bo{constructor(e){super(e),this.EMPTY=Ge.EMPTY,this.QuartoPiece=Ge,this.chosen=S.empty(),this.lastMove=S.empty(),this.pieceInHand=Ge.EMPTY,this.pieceToGive=S.empty(),this.victoriousCoords=[],this.rules=new Bs(uc),this.availableMinimaxes=[new kV(this.rules,"QuartoMinimax")],this.encoder=a4.encoder,this.tutorial=(new yce).tutorial,this.pieceInHand=this.getState().pieceInHand,this.updateBoard()}updateBoard(){const e=this.getState(),r=this.rules.node.move;this.board=e.getCopiedBoard(),this.chosen=S.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=r.map(s=>s.coord)}chooseCoord(e,r){var s=this;return O(function*(){const i=s.canUserPlay("#chooseCoord_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(s.hideLastMove(),s.board[r][e]===Ge.EMPTY){if(s.showPieceInHandOnBoard(e,r),15===s.getState().turn){const o=new a4(e,r,Ge.EMPTY);return s.chooseMove(o,s.getState())}if(s.pieceToGive.isAbsent())return G.SUCCESS;{const o=new a4(e,r,s.pieceToGive.get());return s.chooseMove(o,s.getState())}}return s.cancelMove(Mt.MUST_CLICK_ON_EMPTY_SPACE())})()}choosePiece(e){var r=this;return O(function*(){const s=r.canUserPlay("#choosePiece_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(r.hideLastMove(),r.pieceToGive.equalsValue(Ge.fromInt(e)))return r.cancelMoveAttempt(),G.SUCCESS;if(r.pieceToGive=S.of(Ge.fromInt(e)),r.chosen.isAbsent())return G.SUCCESS;{const i=r.chosen.get(),o=new a4(i.x,i.y,r.pieceToGive.get());return r.chooseMove(o,r.rules.node.gameState)}})()}hideLastMove(){this.lastMove=S.empty()}cancelMoveAttempt(){this.hideLastMove(),this.pieceToGive=S.empty(),this.chosen=S.empty()}deselectDroppedPiece(){const e=this.chosen.getOrElse(new P(404,404)),s=this.canUserPlay("#droppedPiece_"+e.x+"_"+e.y);return s.isFailure()?this.cancelMove(s.getReason()):(this.cancelMoveAttempt(),G.SUCCESS)}showPieceInHandOnBoard(e,r){this.chosen=S.of(new P(e,r))}isRemaining(e){return uc.isGivable(Ge.fromInt(e),this.board,this.pieceInHand)}getSquareClasses(e,r){const s=new P(e,r);return this.lastMove.equalsValue(s)?["moved-fill"]:[]}getPieceClasses(e){const r=[];return r.push(e%2==0?"player0-fill":"player1-fill"),r}getPieceSize(e){return e<8?40:25}pieceHasDot(e){return e!==Ge.EMPTY.value&&e%8<4}}return n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-quarto"]],features:[l],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],[4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","selected","x","0","y","0",1,"base","selected","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected-stroke",3,"id",4,"ngIf"],[1,"base","selected-stroke",3,"id"]],template:function(e,r){1&e&&(B(),N(0,"svg",0)(1,"g",1),k(2,Y6t,3,1,"g",2),k(3,J6t,7,8,"g",3),k(4,e0t,3,3,"g",2),N(5,"g",null,4),X(7,"rect",5,6),k(9,s0t,5,3,"g",7),A(),k(10,f0t,5,6,"g",2),A()()),2&e&&(V("viewBox","0 0 "+4.25*r.SPACE_SIZE+" "+10.75*r.SPACE_SIZE),M(2),w("ngForOf",r.board),M(1),w("ngIf",r.chosen.isPresent()),M(1),w("ngForOf",r.victoriousCoords),M(1),V("transform","translate("+2*r.SPACE_SIZE+", "+4.5*r.SPACE_SIZE+")"),M(2),V("width",1.5*r.SPACE_SIZE)("height",1.5*r.SPACE_SIZE)("transform","translate("+-.75*r.SPACE_SIZE+", 0)"),M(2),w("ngIf",r.chosen.isAbsent()),M(1),w("ngForOf",r.board))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),d0t=(()=>{class n{}return n.NO_INSIDE_CLICK=()=>$localize`You must pick a space from the edge of the board.`,n})();class l4 extends Yc{constructor(t,e,r){super(t,e),this.direction=r;const s=l4.isValidCoord(this.coord);if(s.isFailure())throw new Error(s.getReason());if(0===t&&r===De.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===t&&r===De.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===e&&r===De.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===e&&r===De.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.")}static isValidCoord(t){return t.isNotInRange(5,5)?G.failure("Invalid coord for QuixoMove: "+t.toString()+" is outside the board."):0!==t.x&&4!==t.x&&0!==t.y&&4!==t.y?G.failure(d0t.NO_INSIDE_CLICK()):G.SUCCESS}toString(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}equals(t){return t===this||!!t.coord.equals(this.coord)&&t.direction===this.direction}}l4.encoder=new class extends on{maxValue(){return 128}encodeNumber(n){const t=n.direction.toInt();return 20*n.coord.x+4*n.coord.y+t}decodeNumber(n){const t=De.factory.fromInt(n%4).get();n-=n%4;const e=(n/=4)%5;return n-=n%5,new l4(n/=5,e,t)}};class w0 extends Vs{static getInitialState(){const t=ht.createTable(5,5,fe.NONE);return new w0(t,0)}applyLegalMove(t){const e=this.getCopiedBoard(),r=this.turn+1;let s=t.coord,i=t.coord.getNext(t.direction);for(;i.isInRange(5,5);)e[s.y][s.x]=e[i.y][i.x],s=s.getNext(t.direction),i=i.getNext(t.direction);return e[s.y][s.x]=this.getCurrentPlayer(),new w0(e,r)}}class po extends hr{static getVerticalCoords(t){const e=t.gameState.getCurrentOpponent(),r=[];for(let s=0;s<5;s++)t.gameState.getPieceAtXY(0,s)!==e&&r.push(new P(0,s)),t.gameState.getPieceAtXY(4,s)!==e&&r.push(new P(4,s));return r}static getHorizontalCenterCoords(t){const e=t.gameState.getCurrentOpponent(),r=[];for(let s=1;s<4;s++)t.gameState.getPieceAtXY(s,0)!==e&&r.push(new P(s,0)),t.gameState.getPieceAtXY(s,4)!==e&&r.push(new P(s,4));return r}static getPossibleDirections(t){const e=[];return 0!==t.x&&e.push(De.LEFT),0!==t.y&&e.push(De.UP),4!==t.x&&e.push(De.RIGHT),4!==t.y&&e.push(De.DOWN),e}static getLinesSums(t){const e={};e[F.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},e[F.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(let r=0;r<5;r++)for(let s=0;s<5;s++){const i=t.getPieceAtXY(s,r);if(i.isPlayer()){const o=i.value;e[o].columns[s]=e[o].columns[s]+1,e[o].rows[r]=e[o].rows[r]+1,s===r&&(e[o].diagonals[0]=e[o].diagonals[0]+1),s+r===4&&(e[o].diagonals[1]=e[o].diagonals[1]+1)}}return e}static getVictoriousCoords(t){const e=po.getLinesSums(t),r=[];for(let s=0;s<2;s++){for(let i=0;i<5;i++){if(5===e[s].columns[i])for(let o=0;o<5;o++)r.push(new P(i,o));if(5===e[s].rows[i])for(let o=0;o<5;o++)r.push(new P(o,i))}if(5===e[s].diagonals[0])for(let i=0;i<5;i++)r.push(new P(i,i));if(5===e[s].diagonals[1])for(let i=0;i<5;i++)r.push(new P(i,4-i))}return r}static getFullestLine(t){const e=t.columns.concat(t.rows.concat(t.diagonals));return Math.max(...e)}applyLegalMove(t,e,r){return po.applyLegalMove(t,e,r)}static applyLegalMove(t,e,r){return e.applyLegalMove(t)}isLegal(t,e){return e.getPieceAt(t.coord)===e.getCurrentOpponent()?K.failure(Mt.CANNOT_CHOOSE_OPPONENT_PIECE()):K.success(void 0)}getGameStatus(t){const e=t.gameState,r=po.getLinesSums(e),s=po.getFullestLine(r[F.ZERO.value]),i=po.getFullestLine(r[F.ONE.value]),o=e.getCurrentPlayer();return 5===s&&(o===F.ZERO||i<5)?ze.ZERO_WON:5===i?ze.ONE_WON:ze.ONGOING}}class p0t extends rr{getListMoves(t){const e=[],r=po.getVerticalCoords(t),i=po.getHorizontalCenterCoords(t).concat(r);for(const o of i){const c=po.getPossibleDirections(o);for(const u of c){const h=new l4(o.x,o.y,u);e.push(h)}}return e}getBoardValue(t){const e=t.gameState,r=po.getLinesSums(e),s=po.getFullestLine(r[F.ZERO.value]),i=po.getFullestLine(r[F.ONE.value]),o=e.getCurrentPlayer();return new dt(5===s&&(o===F.ZERO||i<5)?F.ZERO.getVictoryValue():5===i?F.ONE.getVictoryValue():i-s)}}const ir=fe.NONE,fc=fe.ZERO,a3=fe.ONE;class Ece extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Goal of the game.`,$localize`At Quixo, the goal is to align 5 of your pieces.
        The first player plays with dark pieces, the second with light pieces.
        The board is made of 25 spaces spread over a 5x5 square.
        Every piece has a neutral side, a light side, and a dark side.`,w0.getInitialState()),pe.fromMove($localize`What a move looks like (without animation)`,$localize`When it is your turn:
        <ol>
            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.
                You can only choose a piece from the edge of the board.</li>
            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>
        </ol>
        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.
        Once on the other side, all pieces will move by one space in the opposing direction.
        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>
        For example, take the bottom right neutral piece, and move it to the left (you're playing Light).`,new w0([[ir,ir,ir,ir,ir],[ir,ir,ir,ir,ir],[ir,ir,ir,ir,ir],[ir,ir,ir,ir,ir],[fc,fc,fc,fc,ir]],1),[new l4(4,4,De.LEFT)],$localize`See how the four dark pieces have been moved one space to the right.
        The neutral piece has been move 4 pieces to the left and has become light.`,$localize`Failed!`),pe.fromMove($localize`Victory`,$localize`You already know everything you need in order to play, but there is one last particularity.
        If you create a line of 5 of your pieces, you win.
        If you create a line of 5 of your opponent's pieces, you lose.
        If you create both, you lose too!<br/><br/>
        You can win with this board, try it.
        You're playing Light.`,new w0([[ir,a3,ir,a3,a3],[ir,fc,fc,ir,fc],[a3,a3,a3,fc,a3],[fc,ir,fc,a3,a3],[a3,fc,ir,a3,fc]],31),[new l4(3,0,De.DOWN)],$localize`Congratulations, you won!`,$localize`Failed!`)]}}function m0t(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"circle",4),se("click",function(){const i=he(e).index,o=E().index;return ce(E().onBoardClick(i,o))}),A()()}if(2&n){const e=t.index,r=E().index,s=E();M(1),je("id","click_",e,"_",r,""),w("ngClass",s.getPieceClasses(e,r)),V("r",.45*s.SPACE_SIZE)("cx",(e+.5)*s.SPACE_SIZE)("cy",(r+.5)*s.SPACE_SIZE)}}function _0t(n,t){if(1&n&&(B(),N(0,"g"),k(1,m0t,2,6,"g",2),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}function v0t(n,t){if(1&n){const e=we();B(),N(0,"use",6),se("click",function(){const i=he(e).$implicit;return ce(E(2).chooseDirection(i))}),A()}if(2&n){const e=t.$implicit,r=E(2);L1("id","chooseDirection_",e,""),V("transform",r.getArrowTransform(e))}}function C0t(n,t){if(1&n&&(B(),N(0,"g"),k(1,v0t,1,2,"use",5),A()),2&n){const e=E();M(1),w("ngForOf",e.getPossiblesDirections())}}let y0t=(()=>{class n extends Bo{constructor(e){super(e),this.lastMoveCoord=S.empty(),this.chosenCoord=S.empty(),this.victoriousCoords=[],this.rules=new po(w0),this.availableMinimaxes=[new p0t(this.rules,"QuixoMinimax")],this.encoder=l4.encoder,this.tutorial=(new Ece).tutorial,this.updateBoard()}updateBoard(){this.state=this.getState(),this.board=this.state.board,this.lastMoveCoord=this.rules.node.move.map(e=>e.coord),this.victoriousCoords=po.getVictoriousCoords(this.state)}cancelMoveAttempt(){this.chosenCoord=S.empty()}getPieceClasses(e,r){const s=new P(e,r),o=[];return o.push(this.getPlayerClass(this.board[r][e])),this.chosenCoord.equalsValue(s)?o.push("selected-stroke"):this.lastMoveCoord.equalsValue(s)&&o.push("last-move-stroke"),this.victoriousCoords.some(c=>c.equals(s))&&o.push("victory-stroke"),o}onBoardClick(e,r){const s=this.canUserPlay("#click_"+e+"_"+r);if(s.isFailure())return this.cancelMove(s.getReason());const i=new P(e,r),o=l4.isValidCoord(i);return o.isFailure()?this.cancelMove(o.getReason()):this.board[r][e]===this.state.getCurrentOpponent()?this.cancelMove(Mt.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord.equalsValue(i)?this.cancelMoveAttempt():this.chosenCoord=S.of(i),G.SUCCESS)}getPossiblesDirections(){const e=[],r=this.chosenCoord.get();return 4!==r.x&&e.push(De.RIGHT),0!==r.x&&e.push(De.LEFT),4!==r.y&&e.push(De.DOWN),0!==r.y&&e.push(De.UP),e}chooseDirection(e){var r=this;return O(function*(){const s=r.canUserPlay("#chooseDirection_"+e.toString());return s.isFailure()?r.cancelMove(s.getReason()):(r.chosenDirection=e,yield r.tryMove())})()}tryMove(){var e=this;return O(function*(){const r=e.chosenCoord.get(),s=new l4(r.x,r.y,e.chosenDirection);return e.cancelMove(),e.chooseMove(s,e.getState())})()}getArrowTransform(e){return class g0t{static getArrowTransform(t,e,r){let s,i,o;switch(r){case De.UP:s=1,i=0,o=-90;break;case De.DOWN:s=1,i=2,o=90;break;case De.LEFT:s=0,i=1,o=180;break;default:Ae.expectToBe(r,De.RIGHT),s=2,i=1,o=0}return["scale("+t/300+")",`translate(${100*s} ${100*i})`,"rotate("+o+" 50 50)"].join(" ")}}.getArrowTransform(5*this.SPACE_SIZE,new P(0,0),e)}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-quixo"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(e,r){1&e&&(B(),N(0,"svg",0)(1,"defs"),X(2,"polygon",1),A(),k(3,_0t,2,1,"g",2),k(4,C0t,2,1,"g",3),A()),2&e&&(V("viewBox","0 0 "+5*r.SPACE_SIZE+" "+5*r.SPACE_SIZE),M(3),w("ngForOf",r.board),M(1),w("ngIf",r.chosenCoord.isPresent()))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),V1=(()=>{class n extends Vs{static getInitialState(){const e=ht.createTable(n.BOARD_WIDTH,n.BOARD_HEIGHT,fe.NONE);return e[3][3]=F.ZERO,e[4][4]=F.ZERO,e[3][4]=F.ONE,e[4][3]=F.ONE,new n(e,0)}static getNeighboringPawnLike(e,r,s,i){let o;const c=[];for(let u=-1;u<2;u++)for(let h=-1;h<2;h++)o=new P(s+h,i+u),o.isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[o.y][o.x]===r&&c.push(o);return c}countScore(){const e=[0,0];for(let r=0;r<n.BOARD_HEIGHT;r++)for(let s=0;s<n.BOARD_WIDTH;s++){const i=this.board[r][s];i.isPlayer()&&(e[i.value]+=1)}return e}}return n.BOARD_WIDTH=8,n.BOARD_HEIGHT=8,n})();class I2 extends Yc{equals(t){return t===this||t.coord.equals(this.coord)}toString(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}I2.encoder=new class extends on{maxValue(){return(V1.BOARD_HEIGHT-1)*V1.BOARD_WIDTH+(V1.BOARD_WIDTH-1)}encodeNumber(n){return n.coord.y*V1.BOARD_WIDTH+n.coord.x}decodeNumber(n){const t=n%V1.BOARD_WIDTH;return new I2(t,(n-t)/V1.BOARD_WIDTH)}},I2.PASS=new I2(-1,-1),I2.PASS_NUMBER=I2.encoder.encodeNumber(I2.PASS);let E0t=(()=>{class n{}return n.NO_ELEMENT_SWITCHED=()=>$localize`Your move should switch at least one piece.`,n})();class Mce{constructor(t,e){this.move=t,this.switched=e}}let lm=(()=>{class n extends hr{static getGameStatus(e){const r=e.gameState;if(!1===n.isGameEnded(r))return ze.ONGOING;const i=r.countScore(),o=i[1]-i[0];return o<0?ze.ZERO_WON:o>0?ze.ONE_WON:ze.DRAW}applyLegalMove(e,r,s){const i=r.turn,o=r.getCurrentPlayer(),c=r.getCopiedBoard();if(e.equals(I2.PASS))return new V1(c,i+1);for(const h of s)c[h.y][h.x]=o;return c[e.coord.y][e.coord.x]=o,new V1(c,i+1)}static getAllSwitcheds(e,r,s){const i=[],o=r.getOpponent();for(const c of Pe.DIRECTIONS){const u=e.coord.getNext(c);if(u.isInRange(V1.BOARD_WIDTH,V1.BOARD_HEIGHT)&&s[u.y][u.x]===o){const h=n.getSandwicheds(r,c,u,s);for(const g of h)i.push(g)}}return i}static getSandwicheds(e,r,s,i){const o=[s];let c=s.getNext(r);for(;c.isInRange(V1.BOARD_WIDTH,V1.BOARD_HEIGHT);){const u=i[c.y][c.x];if(u===e)return o;if(u===fe.NONE)return[];o.push(c),c=c.getNext(r)}return[]}static isGameEnded(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}getGameStatus(e){return n.getGameStatus(e)}static playerCanOnlyPass(e){const r=this.getListMoves(e);return 1===r.length&&r[0].move.equals(I2.PASS)}static nextPlayerCantOnlyPass(e){const r=e.getCopiedBoard(),i=new V1(r,e.turn+1);return this.playerCanOnlyPass(i)}static getListMoves(e){const r=[];let s;const i=e.getCurrentPlayer(),o=e.getCurrentOpponent();for(let c=0;c<8;c++)for(let u=0;u<8;u++)if(e.getPieceAtXY(u,c)===fe.NONE&&(s=e.getCopiedBoard(),V1.getNeighboringPawnLike(s,o,u,c).length>0)){const g=new I2(u,c),m=n.getAllSwitcheds(g,i,s);if(m.length>0){for(const v of m)Se(i!==e.getPieceAt(v),v+"was already switched!"),s[v.y][v.x]=i;s[c][u]=i,r.push(new Mce(g,m.length))}}return 0===r.length&&r.push(new Mce(I2.PASS,0)),r}isLegal(e,r){if(e.equals(I2.PASS))return n.playerCanOnlyPass(r)?K.success([]):K.failure(Mt.MUST_PASS());if(r.getPieceAt(e.coord).isPlayer())return Y(n.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),K.failure(Mt.MUST_CLICK_ON_EMPTY_SPACE());const s=r.getCopiedBoard(),i=n.getAllSwitcheds(e,r.getCurrentPlayer(),s);return Y(n.VERBOSE,"ReversiRules.isLegal: "+i.length+" element(s) switched"),0===i.length?K.failure(E0t.NO_ELEMENT_SWITCHED()):K.success(i)}}return n.VERBOSE=!1,n})();class XS extends rr{getBoardValue(t){const e=lm.getGameStatus(t);if(e.isEndGame)return dt.fromWinner(e.winner);const s=t.gameState.getCopiedBoard();let i=0,o=0;for(let c=0;c<V1.BOARD_HEIGHT;c++)for(let u=0;u<V1.BOARD_WIDTH;u++){const m=(0===u||u===V1.BOARD_WIDTH-1?4:1)*(0===c||c===V1.BOARD_HEIGHT-1?4:1);s[c][u]===F.ZERO&&(i+=m),s[c][u]===F.ONE&&(o+=m)}return i*=F.ZERO.getScoreModifier(),o*=F.ONE.getScoreModifier(),new dt(o+i)}getListMoves(t){const e=lm.getListMoves(t.gameState);return ht.sortByDescending(e,r=>XS.bestCoords.some(s=>r.move.coord.equals(s))?100:r.switched),e.map(r=>r.move)}}XS.bestCoords=[new P(0,0),new P(0,V1.BOARD_HEIGHT-1),new P(V1.BOARD_WIDTH-1,0),new P(V1.BOARD_WIDTH-1,V1.BOARD_HEIGHT-1)];const Rt=fe.NONE,zt=fe.ZERO,it=fe.ONE;class Sce extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Goal of the game`,$localize`At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.
        When one piece is flipped, its owner changes.
        The player owning the most pieces at the end of the game wins.
        Here, Dark has 28 points and Light has 36, hence Light wins.`,new V1([[zt,zt,zt,zt,zt,zt,zt,zt],[zt,it,it,it,it,it,it,zt],[zt,it,it,it,it,it,it,zt],[zt,it,it,it,it,it,it,zt],[zt,it,it,it,it,it,it,zt],[zt,it,it,it,it,it,it,zt],[zt,it,it,it,it,it,it,zt],[zt,zt,zt,zt,zt,zt,zt,zt]],60)),pe.anyMove($localize`Capture (1/2)`,$localize`At the beginning of the game, pieces are placed as shown here.
        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>
        Do any move by clicking to put your piece
        Dark plays first.`,V1.getInitialState(),new I2(2,4),$localize`Congratulations!`),pe.fromMove($localize`Capture (2/2)`,$localize`A move can also capture a bigger line, and more than one lines at a time
        You're playing light here.<br/><br/>
        Play on the bottom left to see an example.`,new V1([[Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt],[Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt],[Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt],[Rt,Rt,Rt,Rt,it,Rt,Rt,Rt],[Rt,Rt,Rt,zt,Rt,Rt,Rt,Rt],[Rt,Rt,zt,Rt,Rt,Rt,Rt,Rt],[zt,zt,Rt,Rt,Rt,Rt,Rt,Rt],[Rt,zt,it,zt,it,zt,Rt,Rt]],1),[new I2(0,7)],$localize`Congratulations!`,$localize`Lower and more to the left, please.`),pe.informational($localize`Passing a turn`,$localize`If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass
        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way.`,new V1([[it,zt,zt,zt,zt,zt,it,zt],[zt,it,it,it,it,it,it,zt],[zt,it,it,it,it,it,it,zt],[zt,it,it,it,it,it,it,zt],[zt,it,it,it,it,it,it,zt],[zt,it,it,it,it,it,it,zt],[it,it,it,it,it,it,Rt,Rt],[zt,zt,zt,zt,zt,zt,Rt,Rt]],60))]}}function M0t(n,t){if(1&n&&(B(),X(0,"circle",4)),2&n){const e=E().index,r=E().index,s=E();w("ngClass",s.getPieceClass(e,r)),V("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)}}function S0t(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"rect",2),se("click",function(){const i=he(e).index,o=E().index;return ce(E().onClick(i,o))}),A(),k(2,M0t,1,4,"circle",3),A()}if(2&n){const e=t.index,r=E().index,s=E();M(1),je("id","click_",e,"_",r,""),w("ngClass",s.getRectClasses(e,r)),V("x",s.SPACE_SIZE*e)("y",s.SPACE_SIZE*r)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),M(1),w("ngIf",s.board[r][e]!==s.EMPTY)}}function P0t(n,t){if(1&n&&(B(),N(0,"g"),k(1,S0t,3,8,"g",1),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}let T0t=(()=>{class n extends Bo{constructor(e){super(e),this.EMPTY=fe.NONE,this.lastMove=new P(-2,-2),this.captureds=[],this.scores=S.of([2,2]),this.rules=new lm(V1),this.availableMinimaxes=[new XS(this.rules,"ReversiMinimax")],this.encoder=I2.encoder,this.tutorial=(new Sce).tutorial,this.canPass=!1,this.updateBoard()}onClick(e,r){var s=this;return O(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new I2(e,r);return yield s.chooseMove(o,s.getState(),s.scores.get())})()}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard(),this.captureds=[],this.rules.node.move.isPresent()?this.showPreviousMove():this.lastMove=new P(-2,-2),this.scores=S.of(e.countScore()),this.canPass=lm.playerCanOnlyPass(e)}showPreviousMove(){this.lastMove=this.rules.node.move.get().coord;const e=this.getState().getCurrentPlayer(),r=this.getState().getCurrentOpponent();for(const s of Pe.DIRECTIONS){let i=this.lastMove.getNext(s,1);for(;i.isInRange(V1.BOARD_WIDTH,V1.BOARD_HEIGHT)&&this.getState().getPieceAt(i)===r&&this.rules.node.mother.get().gameState.getPieceAt(i)===e;)this.captureds.push(i),i=i.getNext(s,1)}}getRectClasses(e,r){const s=new P(e,r);return this.captureds.some(i=>i.equals(s))?["captured-fill"]:s.equals(this.lastMove)?["moved-fill"]:[]}getPieceClass(e,r){return this.getPlayerClass(this.board[r][e])}pass(){var e=this;return O(function*(){return Se(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(I2.PASS.coord.x,I2.PASS.coord.y)})()}}return n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-reversi"]],features:[l],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,r){1&e&&(B(),N(0,"svg",0),k(1,P0t,2,1,"g",1),A()),2&e&&(V("viewBox","0 -4 "+8*r.SPACE_SIZE+" "+(10+8*r.SPACE_SIZE)),M(1),w("ngForOf",r.board))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),f2=(()=>{class n extends D8{static getInitialState(){const e=be.UNREACHABLE,r=be.ZERO,s=be.ONE,i=be.EMPTY;return new n([[e,e,r,s,i,i,i,r,s,e,e],[e,i,i,i,i,i,i,i,i,i,e],[s,i,i,i,i,i,i,i,i,i,r],[r,i,i,i,i,i,i,i,i,i,s],[e,i,i,i,i,i,i,i,i,i,e],[e,e,s,r,i,i,i,s,r,e,e]],0)}}return n.HEIGHT=6,n.WIDTH=11,n})(),qf=(()=>{class n{}return n.CAN_ONLY_REBOUND_ON_BLACK=()=>$localize`You can only rebound on dark spaces.`,n.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=()=>$localize`You can only rebound on empty spaces.`,n.MUST_CHOOSE_PYRAMID_FIRST=()=>$localize`You must pick one of your pyramids first.`,n.MUST_CHOOSE_OWN_PYRAMID=()=>$localize`You must pick one of your pyramids.`,n.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=()=>$localize`Those two spaces are not neighbors.`,n.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=()=>$localize`Those two spaces have no intermediary neighbor.`,n})();class c3 extends tc{constructor(t,e){super(t,e)}static checkDistanceAndLocation(t,e){const i=Math.abs(t.x-e.x)+Math.abs(t.y-e.y);if(0===i)return G.failure(Mt.MOVE_CANNOT_BE_STATIC());if(1===i){const o=nc.getFakeNeighbors(t);if(e.equals(o))return G.failure(qf.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==i)return G.failure($localize`You can move one or two spaces, not ${i}.`);if(nc.isSpaceDark(t))return G.failure(qf.CAN_ONLY_REBOUND_ON_BLACK());if(t.x===e.x)return G.failure(qf.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return G.SUCCESS}static from(t,e){if(!t.isInRange(f2.WIDTH,f2.HEIGHT))throw new Error("Move must start inside the board not at "+t.toString()+".");if(!e.isInRange(f2.WIDTH,f2.HEIGHT))throw new Error("Move must end inside the board not at "+e.toString()+".");const r=c3.checkDistanceAndLocation(t,e);return r.isFailure()?r.toFailedFallible():K.success(new c3(t,e))}isSimpleStep(){return Math.abs(this.coord.x-this.end.x)+Math.abs(this.coord.y-this.end.y)===1}equals(t){return t===this||!!t.coord.equals(this.coord)&&t.end.equals(this.end)}toString(){return"SaharaMove("+this.coord+"->"+this.end+")"}}c3.encoder=new class extends on{maxValue(){return 396*f2.WIDTH+66*f2.HEIGHT+6*f2.WIDTH+f2.HEIGHT}encodeNumber(n){return 396*n.coord.x+66*n.coord.y+6*n.end.x+n.end.y}decodeNumber(n){const t=n%6;n-=t;const e=(n/=6)%11;n-=e;const r=(n/=11)%6;return n-=r,c3.from(new P(n/=6,r),new P(e,t)).get()}};let jf=(()=>{class n extends hr{static getStartingCoords(e,r){const s=[];for(let i=0;i<f2.HEIGHT;i++)for(let o=0;o<f2.WIDTH;o++)e[i][o].is(r)&&s.push(new P(o,i));return s}static getBoardValuesFor(e,r){const s=n.getStartingCoords(e,r),i=[];for(const o of s){const c=D8.getEmptyNeighbors(e,o,be.EMPTY).length;if(0===c)return[0];i.push(c)}return i.sort((o,c)=>o-c)}applyLegalMove(e,r,s){Y(n.VERBOSE,"Legal move "+e.toString()+" applied");const i=r.getCopiedBoard();return i[e.end.y][e.end.x]=i[e.coord.y][e.coord.x],i[e.coord.y][e.coord.x]=be.EMPTY,new f2(i,r.turn+1)}isLegal(e,r){if(r.getPieceAt(e.coord).value!==r.getCurrentPlayer().value)return K.failure(Mt.CANNOT_CHOOSE_OPPONENT_PIECE());if(r.getPieceAt(e.end)!==be.EMPTY)return K.failure(Mt.MUST_LAND_ON_EMPTY_SPACE());const o=nc.getCommonNeighbor(e.coord,e.end);return o.isPresent()?r.getPieceAt(o.get())===be.EMPTY?K.success(void 0):K.failure(qf.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):K.success(void 0)}getGameStatus(e){const r=e.gameState.getCopiedBoard(),s=n.getBoardValuesFor(r,F.ZERO),i=n.getBoardValuesFor(r,F.ONE);return n.getGameStatusFromFreedoms(s,i)}getLandingCoords(e,r){const s=o=>o.isInRange(f2.WIDTH,f2.HEIGHT)&&e[o.y][o.x]===be.EMPTY,i=new Z1(nc.getNeighbors(r).filter(s));if(!0===nc.isSpaceDark(r))return i.toList();{const o=new Z1(i.toList());for(const c of i){const u=nc.getNeighbors(c).filter(s);for(const h of u)o.add(h)}return o.toList()}}static getGameStatusFromFreedoms(e,r){return 0===e[0]?ze.ONE_WON:0===r[0]?ze.ZERO_WON:ze.ONGOING}}return n.VERBOSE=!1,n})();class w0t extends rr{getListMoves(t){const e=[],r=t.gameState.getCopiedBoard(),s=t.gameState.getCurrentPlayer(),i=jf.getStartingCoords(r,s);for(const o of i){const c=D8.getEmptyNeighbors(r,o,be.EMPTY);for(const u of c){const h=c3.from(o,u).get();if(r[u.y][u.x]=r[o.y][o.x],r[o.y][o.x]=be.EMPTY,e.push(h),(u.y+u.x)%2==0){const m=D8.getEmptyNeighbors(r,u,be.EMPTY);for(const v of m)if(!v.equals(o)){const T=c3.from(o,v).get();r[v.y][v.x]=r[u.y][u.x],r[u.y][u.x]=be.EMPTY,e.push(T),r[u.y][u.x]=r[v.y][v.x],r[v.y][v.x]=be.EMPTY}}r[o.y][o.x]=r[u.y][u.x],r[u.y][u.x]=be.EMPTY}}return e}getBoardValue(t){const r=t.gameState.getCopiedBoard(),s=jf.getBoardValuesFor(r,F.ZERO),i=jf.getBoardValuesFor(r,F.ONE),o=jf.getGameStatusFromFreedoms(s,i);if(o.isEndGame)return dt.fromWinner(o.winner);let c=0;for(;c<6&&s[c]===i[c];)c++;return new dt(i[c%6]-s[c%6])}}const hc=be.UNREACHABLE,Zf=be.ZERO,Yf=be.ONE,Pn=be.EMPTY;class Pce extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Initial board`,$localize`Shr is played on a board where each space is a triangle.
        Each player has six pyramids.`,f2.getInitialState()),pe.informational($localize`Goal of the game`,$localize`At Shr, the goal of the game is to immobilize one of the opponent's pyramids.
        To do so, you have to occupy all neighboring space of that pyramid.
        Here, Light has lost because its leftmost pyramid is immobilized.`,new f2([[hc,hc,Pn,Pn,Yf,Pn,Pn,Zf,Yf,hc,hc],[hc,Pn,Pn,Pn,Pn,Pn,Pn,Pn,Pn,Pn,hc],[Yf,Zf,Pn,Pn,Pn,Pn,Pn,Pn,Pn,Pn,Zf],[Zf,Pn,Pn,Pn,Pn,Pn,Pn,Pn,Pn,Pn,Yf],[hc,Pn,Pn,Pn,Pn,Pn,Pn,Pn,Pn,Pn,hc],[hc,hc,Yf,Zf,Pn,Pn,Pn,Yf,Zf,hc,hc]],3)),pe.fromPredicate($localize`Simple step`,$localize`To immobilize your opponent, you have to move your pyramids.
        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).
        You're the first player, playing with the dark pyramids.
        <ol>
            <li>Click on one of your pyramids.</li>
            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>
        </ol><br/>
        Do any simple step.`,f2.getInitialState(),c3.from(new P(2,0),new P(2,1)).get(),(t,e,r)=>t.isSimpleStep()?G.SUCCESS:G.failure($localize`You have made a double step, which is good but it is the next exercise!`),$localize`Congratulations!`),pe.fromPredicate($localize`Double step`,$localize`When a pyramid shares its vertices with dark spaces, it can move one or two steps.
        To do so:
        <ol>
            <li>Click on the pyramid to move.</li>
            <li>Click on one of the 6 destinations that you can reach in two steps:
                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.
        </ol>`,f2.getInitialState(),c3.from(new P(7,0),new P(5,0)).get(),(t,e,r)=>t.isSimpleStep()?G.failure($localize`Failed! You have made a single step.`):G.SUCCESS,$localize`Congratulations!`)]}}function b0t(n,t){if(1&n&&(B(),N(0,"g"),X(1,"polygon",7),A()),2&n){const e=E().index,r=E().index,s=E();M(1),w("ngClass",s.getPlayerClassFor(e,r)),V("points",s.getPyramidCoordinate(e,r))}}function N0t(n,t){if(1&n&&(B(),X(0,"polygon",10)),2&n){const e=E(2).index,r=E().index;V("points",E().getTriangleCoordinate(e,r))}}function A0t(n,t){if(1&n&&(B(),X(0,"polygon",11)),2&n){const e=E(2).index,r=E().index;V("points",E().getTriangleCoordinate(e,r))}}function O0t(n,t){if(1&n&&(B(),N(0,"g"),k(1,N0t,1,1,"polygon",8),k(2,A0t,1,1,"polygon",9),A()),2&n){const e=E().index,r=E().index;M(1),w("ngIf",(e+r)%2==1),M(1),w("ngIf",(e+r)%2==0)}}function I0t(n,t){if(1&n){const e=we();B(),N(0,"g",5),se("click",function(){const i=he(e).index,o=E().index;return ce(E().onClick(i,o))}),k(1,b0t,2,2,"g",6),k(2,O0t,3,2,"g",6),A()}if(2&n){const e=t.$implicit;je("id","click_",t.index,"_",E().index,""),M(1),w("ngIf",e.isPlayer()),M(1),w("ngIf",2===e.value)}}function x0t(n,t){if(1&n&&(B(),N(0,"g"),k(1,I0t,3,4,"g",4),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}function L0t(n,t){if(1&n&&(B(),X(0,"polygon",14)),2&n){const e=t.$implicit,r=E(2);je("id","possible_landing_",e.x,"_",e.y,""),V("points",r.getTriangleCoordinate(e.x,e.y))}}function k0t(n,t){if(1&n&&(B(),X(0,"polygon",14)),2&n){const e=E(2);je("id","chosen_coord_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),V("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y))}}function R0t(n,t){if(1&n&&(B(),nn(0),k(1,L0t,1,3,"polygon",12),k(2,k0t,1,3,"polygon",13),rn()),2&n){const e=E();M(1),w("ngForOf",e.possibleLandings),M(1),w("ngIf",e.chosenCoord.isPresent())}}function D0t(n,t){if(1&n&&(B(),nn(0),X(1,"polygon",15)(2,"polygon",15),rn()),2&n){const e=E(2);M(1),V("points",e.getTriangleCoordinate(e.lastCoord.get().x,e.lastCoord.get().y)),M(1),V("points",e.getTriangleCoordinate(e.lastMoved.get().x,e.lastMoved.get().y))}}function z0t(n,t){1&n&&(B(),k(0,D0t,3,2,"ng-container",6)),2&n&&w("ngIf",E().lastMoved.isPresent())}let V0t=(()=>{class n extends Dae{constructor(e){super(e),this.lastCoord=S.empty(),this.lastMoved=S.empty(),this.chosenCoord=S.empty(),this.possibleLandings=[],this.rules=new jf(f2),this.availableMinimaxes=[new w0t(this.rules,"SaharaMinimax")],this.encoder=c3.encoder,this.tutorial=(new Pce).tutorial,this.updateBoard()}cancelMoveAttempt(){this.possibleLandings=[],this.chosenCoord=S.empty()}onClick(e,r){var s=this;return O(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState().getCurrentPlayer(),c=be.ofPlayer(o);return s.chosenCoord.equalsValue(new P(e,r))?(s.cancelMoveAttempt(),G.SUCCESS):s.chosenCoord.isAbsent()||s.board[r][e]===c?s.choosePiece(e,r):s.chooseLandingCoord(e,r)})()}choosePiece(e,r){if(this.board[r][e]===be.EMPTY)return this.cancelMove(qf.MUST_CHOOSE_PYRAMID_FIRST());if(this.board[r][e].is(F.fromTurn(this.getTurn()))){const s=new P(e,r);return this.selectPiece(s),G.SUCCESS}return this.cancelMove(qf.MUST_CHOOSE_OWN_PYRAMID())}selectPiece(e){this.chosenCoord=S.of(e),this.possibleLandings=this.rules.getLandingCoords(this.board,e)}chooseLandingCoord(e,r){var s=this;return O(function*(){const i=new P(e,r),o=c3.from(s.chosenCoord.get(),i);return o.isFailure()?s.cancelMove(o.getReason()):yield s.chooseMove(o.get(),s.getState())})()}updateBoard(){const e=this.rules.node.move;this.lastCoord=e.map(r=>r.coord),this.lastMoved=e.map(r=>r.end),this.board=this.getState().board}getPlayerClassFor(e,r){return this.getPlayerClass(F.of(this.board[r][e].value))}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-sahara"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","small-stroke","selected-stroke",3,"id"],[1,"base","no-fill","small-stroke","moved-stroke"]],template:function(e,r){if(1&e&&(B(),N(0,"svg",0),k(1,x0t,2,1,"g",1),k(2,R0t,3,2,"ng-container",2),k(3,z0t,1,1,"ng-template",null,3,l1),A()),2&e){const s=s1(4);M(1),w("ngForOf",r.board),M(1),w("ngIf",r.chosenCoord.isPresent())("ngIfElse",s)}},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Go extends Yc{constructor(t,e,r,s){super(t,e),this.x=t,this.y=e,this.direction=r,this.landingOrientation=s}static of(t,e,r,s){const i=new Go(t,e,r,s),o=i.coord.isNotInRange(5,5);if(i.isRotation()){if(o)return K.failure("Cannot rotate piece outside the board: "+i.toString())}else if(i.coord.getNext(i.direction.get()).isNotInRange(5,5)){if(o)return K.failure("SiamMove should end or start on the board: "+i.toString());if(i.direction.get()!==i.landingOrientation)return K.failure("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+i.toString())}return K.success(i)}isRotation(){return this.direction.isAbsent()}equals(t){return this===t||!(!this.coord.equals(t.coord)||!1===this.direction.equals(t.direction))&&this.landingOrientation===t.landingOrientation}toString(){const t=this.direction.isAbsent()?"-":this.direction.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+t+", "+this.landingOrientation+")"}isInsertion(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}Go.encoder=on.tuple([on.numberEncoder(6),on.numberEncoder(6),function w4t(n){return new class extends on{maxValue(){return n.maxValue()+1}encodeNumber(t){return t.isPresent()?n.encodeNumber(t.get()):n.maxValue()+1}decodeNumber(t){return t===this.maxValue()?S.empty():S.of(n.decodeNumber(t))}}}(new Aae),new Aae],n=>[n.x+1,n.y+1,n.direction,n.landingOrientation],n=>Go.of(n[0]-1,n[1]-1,n[2],n[3]).get());class ut{constructor(t){this.value=t}static decode(t){switch(t){case 0:return ut.EMPTY;case 1:return ut.LIGHT_UP;case 2:return ut.LIGHT_RIGHT;case 3:return ut.LIGHT_DOWN;case 4:return ut.LIGHT_LEFT;case 5:return ut.DARK_UP;case 6:return ut.DARK_RIGHT;case 7:return ut.DARK_DOWN;case 8:return ut.DARK_LEFT;case 9:return ut.MOUNTAIN}}belongTo(t){return t===F.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}isEmptyOrMountain(){return 0===this.value||9===this.value}isPiece(){return!this.isEmptyOrMountain()}getOwner(){return 1<=this.value&&this.value<=4?F.ZERO:5<=this.value&&this.value<=8?F.ONE:fe.NONE}getOptionalDirection(){switch(this.value){case 0:return S.empty();case 1:case 5:return S.of(De.UP);case 2:case 6:return S.of(De.RIGHT);case 3:case 7:return S.of(De.DOWN);case 4:case 8:return S.of(De.LEFT);default:return Ae.expectToBe(this.value,9),S.empty()}}static of(t,e){return e===F.ZERO?t===De.UP?ut.LIGHT_UP:t===De.RIGHT?ut.LIGHT_RIGHT:t===De.DOWN?ut.LIGHT_DOWN:ut.LIGHT_LEFT:t===De.UP?ut.DARK_UP:t===De.RIGHT?ut.DARK_RIGHT:t===De.DOWN?ut.DARK_DOWN:ut.DARK_LEFT}getDirection(){return this.getOptionalDirection().get()}toString(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return Ae.expectToBe(this.value,9),"MOUNTAIN"}}}ut.EMPTY=new ut(0),ut.LIGHT_UP=new ut(1),ut.LIGHT_RIGHT=new ut(2),ut.LIGHT_DOWN=new ut(3),ut.LIGHT_LEFT=new ut(4),ut.DARK_UP=new ut(5),ut.DARK_RIGHT=new ut(6),ut.DARK_DOWN=new ut(7),ut.DARK_LEFT=new ut(8),ut.MOUNTAIN=new ut(9);class l3 extends Vs{static getInitialState(){const t=ht.createTable(5,5,ut.EMPTY);return t[2][1]=ut.MOUNTAIN,t[2][2]=ut.MOUNTAIN,t[2][3]=ut.MOUNTAIN,new l3(t,0)}countCurrentPlayerPawn(){return this.countPlayersPawn()[this.getCurrentPlayer().value]}countPlayersPawn(){const t=[0,0];for(let e=0;e<5;e++)for(let r=0;r<5;r++)this.board[e][r]!==ut.EMPTY&&t[this.getPieceAtXY(r,e).getOwner().value]++;return t}}let Kf=(()=>{class n{}return n.NO_REMAINING_PIECE_TO_INSERT=()=>$localize`You cannot insert a piece, all your pieces are already on the board.`,n.NOT_ENOUGH_FORCE_TO_PUSH=()=>$localize`You do not have enough strength to push.`,n.MUST_MOVE_OR_ROTATE=()=>$localize`You must move or rotate your piece.`,n.ILLEGAL_PUSH=()=>$localize`Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board.`,n.MUST_SELECT_VALID_DESTINATION=()=>$localize`You must select a valid destination (highlighted on the board) for your piece`,n.MUST_SELECT_ORIENTATION=()=>$localize`You should select the orientation of your piece by clicking on one of the arrows.`,n})();class Tce{constructor(t,e){this.resultingBoard=t,this.moved=e}}class E1 extends hr{constructor(){super(l3)}static get(){return E1.singleton.isAbsent()&&(E1.singleton=S.of(new E1)),E1.singleton.get()}isLegal(t,e){if(Y(E1.VERBOSE,{SiamRules_isLegal:{move:t,state:e}}),!t.isInsertion()&&!e.getPieceAt(t.coord).belongTo(e.getCurrentPlayer()))return K.failure(Mt.MUST_CHOOSE_PLAYER_PIECE());if(t.isRotation())return Y(E1.VERBOSE,"Move is rotation"),this.isLegalRotation(t,e);{let r;if(t.isInsertion()){Y(E1.VERBOSE,"Move is insertion");const s=this.isLegalInsertion(t.coord,e);if(s.legal.isFailure())return K.failure(s.legal.getReason());r=s.insertedPiece}else Y(E1.VERBOSE,"Move is forward"),r=e.getPieceAt(t.coord);return this.isLegalForwarding(t,e,r)}}isLegalInsertion(t,e){const r=e.countCurrentPlayerPawn(),s=e.getCurrentPlayer(),i=r<5?G.SUCCESS:G.failure(Kf.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:this.getInsertedPiece(t,s),legal:i}}getInsertedPiece(t,e){return ut.of(-1===t.x?De.RIGHT:-1===t.y?De.DOWN:5===t.x?De.LEFT:De.UP,e)}isLegalForwarding(t,e,r){Y(E1.VERBOSE,{isLegalForwarding:{move:t.toString(),state:e,firstPiece:r}}),Se(r!==ut.MOUNTAIN&&r!==ut.EMPTY,"forwarding must be done with player piece");const s=[];let i=ut.of(t.landingOrientation,e.getCurrentPlayer());const o=t.direction.get();let c=t.coord.getNext(o);if(c.isInRange(5,5)&&e.getPieceAt(c)!==ut.EMPTY&&!1===this.isStraight(r,t))return Y(E1.VERBOSE,"Illegal push because not straight or not pushing anything or leaving the board"),K.failure(Kf.ILLEGAL_PUSH());let u=S.of(o);const h=o.getOpposite();let g=0;const m=e.getCopiedBoard();t.coord.isInRange(5,5)&&(m[t.coord.y][t.coord.x]=ut.EMPTY,s.push(t.coord));let v=c.isInRange(5,5)&&i!==ut.EMPTY;for(;v;){u.equalsValue(o)?g++:u.equalsValue(h)&&g--,Y(E1.VERBOSE,{totalForce:g,movingPiece:i,landingCoord:c});const T=m[c.y][c.x];T===ut.MOUNTAIN&&(g-=.9),m[c.y][c.x]=i,s.push(c),i=T,c=c.getNext(o),u=i.getOptionalDirection(),v=c.isInRange(5,5)&&i!==ut.EMPTY&&g>0}return c.isNotInRange(5,5)&&(Y(E1.VERBOSE,"This movement would push "+i+" outside the board"),u.equalsValue(o)?g++:u.equalsValue(h)&&g--),g<=0?(Y(E1.VERBOSE,"This move is an illegal push: "+m),K.failure(Kf.NOT_ENOUGH_FORCE_TO_PUSH())):(Y(E1.VERBOSE,"This move is a legal push: "+m),K.success(new Tce(m,s)))}isStraight(t,e){const r=t.getDirection();return e.direction.equalsValue(r)&&r===e.landingOrientation}isLegalRotation(t,e){Y(E1.VERBOSE,{isLegalRotation:{rotation:t,state:e}});const r=t.coord,s=e.getPieceAt(r),i=e.getCurrentPlayer();if(s.getDirection()===t.landingOrientation)return K.failure(Kf.MUST_MOVE_OR_ROTATE());const o=e.getCopiedBoard();return o[r.y][r.x]=ut.of(t.landingOrientation,i),K.success(new Tce(o,[r]))}applyLegalMove(t,e,r){const s=ht.copyBiArray(r.resultingBoard);return new l3(s,e.turn+1)}getBoardValueInfo(t,e){const r=this.getMountainsRowsAndColumns(e),s=r.rows,i=r.columns,o=this.getWinner(e,t,r.nbMountain);if(o.isPlayer())return o===F.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};{const c=this.getPushers(e,i,s);let u=Number.MAX_SAFE_INTEGER,h=Number.MAX_SAFE_INTEGER;const g=e.getCurrentPlayer();for(const v of c)v.coord.isInRange(5,5)?e.getPieceAt(v.coord).belongTo(F.ZERO)?u=Math.min(u,v.distance):h=Math.min(h,v.distance):g===F.ZERO?u=Math.min(u,v.distance):h=Math.min(h,v.distance);return{shortestZero:u,shortestOne:h,boardValue:this.getScoreFromShortestDistances(u,h,g)}}}getScoreFromShortestDistances(t,e,r){t===Number.MAX_SAFE_INTEGER&&(t=6),e===Number.MAX_SAFE_INTEGER&&(e=6);const s=6-t,i=6-e;return s===i?r.getScoreModifier():s>i?-10*(s+1)+(i+1):10*(i+1)-(s+1)}getMountainsRowsAndColumns(t){const e=[],r=[];let s=0;for(let i=0;i<5;i++)for(let o=0;o<5;o++)t.getPieceAtXY(o,i)===ut.MOUNTAIN&&(e.includes(i)||e.push(i),r.includes(o)||r.push(o),s++);return{rows:e,columns:r,nbMountain:s}}getWinner(t,e,r){return 2===r?this.getPusher(t,e.get()):fe.NONE}getPusher(t,e){const r=e.coord;let s;s=r.isInRange(5,5)?t.getPieceAt(r.getNext(e.landingOrientation)):this.getInsertedPiece(r,t.getCurrentOpponent());const i=s.getDirection(),o=this.getPusherCoord(t,i,r),c=t.getPieceAt(o).getOwner();return Y(E1.VERBOSE,r.toString()+" belong to "+t.getCurrentOpponent().value+", "+o.toString()+" belong to "+c.value+", "+c.value+" win"),c}getPusherCoord(t,e,r){let s=r.getNext(e),i=r;for(;s.isInRange(5,5);){r=s,s=s.getNext(e);const o=t.getPieceAt(r);o!==ut.MOUNTAIN&&o.getDirection()===e&&(i=r)}return i}getPushers(t,e,r){Y(E1.VERBOSE,{getPushers:{state:t,mountainsColumn:e,mountainsRow:r}});let s=[];const i=[];for(const o of e){let c=De.DOWN,u=new P(o,4);i.push({direction:c,fallingCoord:u}),c=De.UP,u=new P(o,0),i.push({direction:c,fallingCoord:u})}for(const o of r){let c=De.LEFT,u=new P(0,o);i.push({direction:c,fallingCoord:u}),c=De.RIGHT,u=new P(4,o),i.push({direction:c,fallingCoord:u})}for(const o of i)s=this.addPotentialDirectionPusher(t,o.fallingCoord,o.direction,s);return s}addPotentialDirectionPusher(t,e,r,s){const i=this.getLineClosestPusher(t,e,r);if(i.isAbsent())return s;const o=i.get(),c=o.distance;return Y(E1.VERBOSE,"new closest challenger"),s.push({coord:o.coord,distance:c}),s}getLineClosestPusher(t,e,r){Y(E1.VERBOSE,{getDirectionClosestPusher:{state:t,fallingCoord:e,direction:r.toString()}});const s=r.getOpposite();let i=1,o=t.getPieceAt(e),c=e,u=S.empty(),h=!1,g=!1,m=0;for(;c.isInRange(5,5)&&!1===h;){const v=t.getPieceAt(c);if(v.isEmptyOrMountain())v===ut.MOUNTAIN?(m+=.9,g=!0):i++;else{const T=v.getDirection();T===r?g&&(m-=1,m<=0&&(h=!0,c=c.getNext(r))):T===s?(m+=1,g||i++):g?(u=S.of(c),o!==ut.EMPTY&&i++):i++}o=v,c=c.getPrevious(r)}if(!1===h&&u.isPresent())for(i++,m-=1;!1===c.equals(u.get());)c=c.getNext(r),i--;return c.isNotInRange(5,5)&&(m-=1,5===t.countCurrentPlayerPawn())||m>0?S.empty():S.of({distance:i,coord:c})}getInsertions(t){let e=[];for(let r=1;r<4;r++)e=e.concat(this.getInsertionsAt(t,0,r)),e=e.concat(this.getInsertionsAt(t,4,r)),e=e.concat(this.getInsertionsAt(t,r,0)),e=e.concat(this.getInsertionsAt(t,r,4));return e=e.concat(this.getInsertionsAt(t,0,0)),e=e.concat(this.getInsertionsAt(t,0,4)),e=e.concat(this.getInsertionsAt(t,4,0)),e=e.concat(this.getInsertionsAt(t,4,4)),e}getInsertionsAt(t,e,r){const s=[];for(const i of De.ORTHOGONALS){const o=new P(e,r).getPrevious(i);if(o.isNotInRange(5,5))for(const c of De.ORTHOGONALS){const u=Go.of(o.x,o.y,S.of(i),c);Se(u.isSuccess(),"SiamRules.getInsertionsAt should only construct valid insertions"),this.isLegal(u.get(),t).isSuccess()&&s.push(u.get())}}return s}getMovesFrom(t,e,r,s){const i=new P(r,s);let o=this.getRotationMovesAt(i,e);for(const c of De.ORTHOGONALS){const u=i.getNext(c);o=o.concat(this.getForwardMovesBetween(t,i,u))}return o}getMovesBetween(t,e,r,s){return r.equals(s)?this.getRotationMovesAt(r,e):De.factory.fromMove(r,s).isSuccess()&&1===r.getDistance(s)?this.getForwardMovesBetween(t,r,s):[]}getRotationMovesAt(t,e){const r=[],s=e.getDirection();for(const i of De.ORTHOGONALS)if(i!==s){const o=Go.of(t.x,t.y,S.empty(),i).get();r.push(o)}return r}getForwardMovesBetween(t,e,r){const s=[];let i;const o=De.factory.fromMove(e,r).get(),c=t.getPieceAt(e);i=r.isInRange(5,5)?De.ORTHOGONALS:[o];for(const u of i){const h=Go.of(e.x,e.y,S.of(o),u).get();this.isLegalForwarding(h,t,c).isSuccess()&&s.push(h)}return s}getGameStatus(t){const e=this.getMountainsRowsAndColumns(t.gameState),r=this.getWinner(t.gameState,t.move,e.nbMountain);return r.isPlayer()?ze.getVictory(r):ze.ONGOING}}E1.singleton=S.empty(),E1.VERBOSE=!1;class H0t extends rr{getBoardValue(t){return new dt(E1.get().getBoardValueInfo(t.move,t.gameState).boardValue)}getListMoves(t){let e=[];const r=t.gameState.getCurrentPlayer();for(let s=0;s<5;s++)for(let i=0;i<5;i++){const o=t.gameState.getPieceAtXY(i,s);o.belongTo(r)&&(e=e.concat(E1.get().getMovesFrom(t.gameState,o,i,s)))}if(t.gameState.countCurrentPlayerPawn()<5)for(const s of E1.get().getInsertions(t.gameState))if(s.direction.get().getOpposite()!==s.landingOrientation){if(this.isOnBorder(s)&&s.direction.get()!==s.landingOrientation)continue;e.push(s)}return Y(E1.VERBOSE,{getListMovesResult:e}),e}isOnBorder(t){return 0===t.coord.x||4===t.coord.x||0===t.coord.y||4===t.coord.y}}const Ue=ut.EMPTY,Pa=ut.MOUNTAIN,DV=ut.LIGHT_UP,zV=ut.LIGHT_LEFT,Xf=ut.LIGHT_RIGHT,F0t=ut.LIGHT_DOWN,B0t=ut.DARK_UP,wce=ut.DARK_LEFT,bce=ut.DARK_RIGHT,$0t=ut.DARK_DOWN;class Nce extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Goal of the game`,$localize`The goal at Siam is to be the first to push a mountain out of the board.
        The initial board contains three mountains, and no pieces are initially on the board.
        During its turn, a player can do one of the following actions:
        <ol>
            <li>Put a new piece on the board.</li>
            <li>Change the orientation of one of its piece</li>
            <li>Move one of its piece and optionally reorient it.</li>
            <li>Take one of its pieces out of the board.</li>
        </ol>`,l3.getInitialState()),pe.anyMove($localize`Inserting a piece`,$localize`Each player has 5 pieces in total.
        As long as you have remaining pieces next to the board, you can insert new pieces. To do so:
        <ol>
            <li>Click on one of your pieces from your reserve, next to board.</li>
            <li>Click on one of the highlighted squares to select a landing for your piece.</li>
            <li>Select an orientation for your piece by clicking on one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Light, insert a piece on the board.`,l3.getInitialState(),Go.of(2,-1,S.of(De.DOWN),De.DOWN).get(),$localize`Congratulations!`),pe.fromMove($localize`Moving a piece`,$localize`We will distinguish here "moving" and "pushing".
        A move is made from a piece's square to an empty neighboring square, horizontally or vertically.
        You can also move a piece out of the board.
        To move a piece:
        <ol>
            <li>Click on it.</li>
            <li>Click on the square on which you want the piece to move.
                You can also click a second time on your piece to change its orientation without moving it.</li>
            <li>Select the orientation of your piece by clicking one one of the arrows that appear on top of the board.</li>
        </ol><br/>
        Try to move your piece that is already on the board one square upwards and to orient it to the left.`,new l3([[Ue,Ue,Ue,Ue,Ue],[Ue,Ue,Ue,Ue,Ue],[Ue,Pa,Pa,Pa,Ue],[Ue,Ue,Ue,Ue,Ue],[Ue,Ue,DV,Ue,Ue]],0),[Go.of(2,4,S.of(De.UP),De.LEFT).get()],$localize`Congratulations, you made a side-slip!`,$localize`Failed!`),pe.fromMove($localize`Moving a piece out of the board`,$localize`To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>
        Get that piece out of the board!`,new l3([[Ue,Ue,Ue,Ue,Ue],[Ue,Ue,Ue,Ue,Ue],[Ue,Pa,Pa,Pa,Ue],[Ue,Ue,Ue,Ue,Ue],[Ue,Ue,DV,Ue,Ue]],0),[Go.of(2,4,S.of(De.DOWN),De.DOWN).get()],$localize`Congratulations, even if in this context it was not a useful move.`,$localize`Failed, the piece is still on the board.`),pe.fromMove($localize`Pushing (1/2)`,$localize`When the landing square of your move is occupied, we use the term "push".
        In order to push player pieces, the following conditions must hold:
        <ol>
            <li>Your piece must already be oriented in the direction of the push.</li>
            <li>Along the line that you are pushing, the number of pieces (yours or your opponent's) that are oriented in the same way as the push should be strictly greater than the number of pieces oriented in the opposite way.</li>
        </ol>
        Look closely at the board. On the first row, you cannot push as there is exactly one piece in the opposite direction.
        On the second row, you can push because there are two pieces against one.<br/><br/>
        Vertically, you can push using your piece in the center, as there is no resistance on that axis. Do it.`,new l3([[Ue,Xf,wce,Ue,Ue],[Xf,bce,zV,Ue,Ue],[Ue,Ue,DV,Ue,Ue],[Ue,Ue,Ue,Ue,Ue],[Ue,Ue,Ue,Ue,Ue]],0),[Go.of(2,2,S.of(De.UP),De.UP).get()],$localize`Congratulations!`,$localize`Failed!`),pe.fromMove($localize`Pushing (2/2)`,$localize`To be able to push a mountain, you need at least one pusher per mountain. Each resistant (pieces in the opposite way) cancel the force of one pusher.
        In short, if there is no mountain, you need strictly more pushers than resistants. If there is a mountain, you need at least as much pushers than there are resistants and mountains.
        On the following board, you can push the mountain on the first row.
        On the second and third row, because of the resisting forces, you cannot push.<br/><br/>
        On the fourth row, you can push as there is one more pusher than resistant pieces. Do it.`,new l3([[Ue,Ue,Xf,Pa,Ue],[Ue,Ue,Xf,Pa,zV],[Ue,Xf,Pa,Pa,Ue],[Ue,Xf,bce,wce,Pa],[Ue,Ue,Ue,Ue,Ue]],0),[Go.of(1,3,S.of(De.RIGHT),De.RIGHT).get()],$localize`Congratulations! Note that this move made you lose the game, you will see why in the next step.`,$localize`Failed!`),pe.fromMove($localize`Victory`,$localize`The game ends when a mountain is pushed out of the board.
        If you pushed it and nobody is in front of you, you're the winner.
        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.
        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>
        Here, you can push a mountain off the board and either win, or lose. Choose correctly!`,new l3([[Ue,Ue,Ue,Ue,Ue],[Ue,Ue,Ue,Ue,Ue],[Pa,B0t,zV,Ue,F0t],[Ue,Ue,Ue,Ue,$0t],[Ue,Ue,Ue,Ue,Pa]],0),[Go.of(2,2,S.of(De.LEFT),De.LEFT).get()],$localize`Congratulations, you won!`,$localize`Failed, you lost.`)]}}function U0t(n,t){if(1&n){const e=we();B(),N(0,"use",11),se("click",function(){he(e);const s=E().index,i=E().index;return ce(E().clickSquare(s,i))}),A()}if(2&n){const e=E(),r=e.index,s=e.$implicit,i=E().index,o=E();je("id","piece_",r,"_",i,""),w("ngClass",o.getPieceClasses(r,i,s)),V("transform",o.getPieceTransform(r,i))}}function G0t(n,t){if(1&n){const e=we();B(),N(0,"use",12),se("click",function(){he(e);const s=E().index,i=E().index;return ce(E().clickSquare(s,i))}),A()}if(2&n){const e=E().index,r=E().index,s=E();V("transform","translate("+(e+1)*s.SPACE_SIZE+" "+(r+1)*s.SPACE_SIZE+")")}}function W0t(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"rect",8),se("click",function(){const i=he(e).index,o=E().index;return ce(E().clickSquare(i,o))}),A(),k(2,U0t,1,4,"use",9),k(3,G0t,1,1,"use",10),A()}if(2&n){const e=t.$implicit,r=t.index,s=E().index,i=E();M(1),je("id","square_",r,"_",s,""),w("ngClass",i.getSquareClasses(r,s)),V("x",i.SPACE_SIZE*(r+1))("y",i.SPACE_SIZE*(s+1))("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),M(1),w("ngIf",e.isPiece()),M(1),w("ngIf",i.isMountain(e))}}function q0t(n,t){if(1&n&&(B(),N(0,"g"),k(1,W0t,4,9,"g",4),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}function j0t(n,t){if(1&n){const e=we();B(),N(0,"rect",15),se("click",function(){he(e);const s=E().$implicit;return ce(E().clickSquare(s.x,s.y))}),A()}if(2&n){const e=E().$implicit,r=E();je("id","square_",e.x,"_",e.y,""),w("ngClass",r.getSquareClasses(e.x,e.y)),V("x",r.SPACE_SIZE*(e.x+1))("y",r.SPACE_SIZE*(e.y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function Z0t(n,t){if(1&n){const e=we();B(),N(0,"g"),k(1,j0t,1,7,"rect",13),N(2,"rect",14),se("click",function(){const i=he(e).$implicit;return ce(E().clickSquare(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=E();M(1),w("ngIf",!1===e.isInRange(5,5)),M(1),V("x",r.SPACE_SIZE*(e.x+1))("y",r.SPACE_SIZE*(e.y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function Y0t(n,t){if(1&n){const e=we();B(),N(0,"rect",16),se("click",function(){he(e);const s=E();return ce(s.clickSquare(s.selectedLanding.get().x,s.selectedLanding.get().y))}),A()}if(2&n){const e=E();V("x",e.SPACE_SIZE*(e.selectedLanding.get().x+1))("y",e.SPACE_SIZE*(e.selectedLanding.get().y+1))("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function K0t(n,t){if(1&n){const e=we();B(),N(0,"rect",16),se("click",function(){he(e);const s=E();return ce(s.clickSquare(s.selectedPiece.get().x,s.selectedPiece.get().y))}),A()}if(2&n){const e=E();V("x",e.SPACE_SIZE*(e.selectedPiece.get().x+1))("y",e.SPACE_SIZE*(e.selectedPiece.get().y+1))("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function X0t(n,t){if(1&n&&(B(),X(0,"use",19)),2&n){const e=t.$implicit,r=E().$implicit,s=E();je("id","remainingPieces_",r.value,"_",e,""),w("ngClass",s.getRemainingPieceClasses(r,e)),V("transform",s.getRemainingPieceTransform(e,r))}}function Q0t(n,t){if(1&n){const e=we();B(),N(0,"g",17),se("click",function(){const i=he(e).$implicit;return ce(E().selectPieceForInsertion(i))}),k(1,X0t,1,4,"use",18),A()}if(2&n){const e=t.$implicit,r=E();L1("id","remainingPieces_",e.value,""),M(1),w("ngForOf",r.range(r.playerPieces(e)))}}function J0t(n,t){if(1&n){const e=we();B(),N(0,"use",22),se("click",function(){he(e);const s=E().$implicit;return ce(E().clickSquare(s.source.get().coord.x,s.source.get().coord.y))}),A()}if(2&n){const e=E().$implicit,r=E();w("ngClass",r.getPieceClasses(e.source.get().coord.x,e.source.get().coord.y,e.source.get().piece)),V("transform",r.getPieceTransform(e.source.get().coord.x,e.source.get().coord.y))}}function eut(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"use",20),se("click",function(){const i=he(e).$implicit;return ce(E().clickArrow(i))}),A(),k(2,J0t,1,2,"use",21),A()}if(2&n){const e=t.$implicit,r=E();M(1),D3("id","indicator_",e.target.x,"_",e.target.y,"_",e.direction.toString(),""),V("transform",r.getIndicatorTransform(e)),M(1),w("ngIf",e.source.isPresent())}}function tut(n,t){if(1&n){const e=we();B(),N(0,"use",23),se("click",function(){const i=he(e).$implicit;return ce(E().selectOrientation(i))}),A()}if(2&n){const e=t.$implicit,r=E();L1("id","orientation_",e.landingOrientation,""),w("ngClass",r.getCurrentPlayerClass()),V("transform",r.getOrientationTransform(e.landingOrientation))}}let nut=(()=>{class n extends Bo{constructor(e){super(e),this.lastMove=S.empty(),this.movedPieces=[],this.selectedPiece=S.empty(),this.selectedLanding=S.empty(),this.orientations=[],this.clickableCoords=new Z1,this.indicatorArrows=[],this.insertingPiece=!1,this.rules=E1.get(),this.availableMinimaxes=[new H0t(this.rules,"SiamMinimax")],this.encoder=Go.encoder,this.tutorial=(new Nce).tutorial,this.updateBoard()}updateBoard(){Y(n.VERBOSE,"updateBoard");const e=this.getState();if(this.board=e.board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){const r=this.rules.node.mother.get().gameState;this.movedPieces=this.rules.isLegal(this.lastMove.get(),r).get().moved}else this.movedPieces=[]}cancelMoveAttempt(){this.insertingPiece=!1,this.selectedPiece=S.empty(),this.selectedLanding=S.empty(),this.orientations=[],this.clickableCoords=new Z1,this.indicatorArrows=[]}selectPieceForInsertion(e){var r=this;return O(function*(){const s=r.canUserPlay("#remainingPieces_"+e.value);if(s.isFailure())return r.cancelMove(s.getReason());if(e!==r.getCurrentPlayer())return r.cancelMove(Mt.MUST_CHOOSE_PLAYER_PIECE());if(r.insertingPiece)return r.cancelMoveAttempt(),G.SUCCESS;r.cancelMoveAttempt();for(const i of E1.get().getInsertions(r.getState())){const o=i.coord.getNext(i.direction.get());if(r.board[o.y][o.x]!==ut.EMPTY){const c={source:S.empty(),target:o,direction:i.direction.get(),move:i};r.indicatorArrows.push(c)}r.clickableCoords.add(o)}return r.insertingPiece=!0,G.SUCCESS})()}selectOrientation(e){var r=this;return O(function*(){const s=r.canUserPlay("#orientation_"+e.landingOrientation.toString());return s.isFailure()?r.cancelMove(s.getReason()):r.chooseMove(e,r.getState())})()}clickSquare(e,r,s=!1){var i=this;return O(function*(){if(Y(n.VERBOSE,"SiamComponent.clickSquare("+e+", "+r+")"),!1===s){const c=i.canUserPlay("#square_"+e+"_"+r);if(c.isFailure())return i.cancelMove(c.getReason())}const o=new P(e,r);if(i.insertingPiece)return i.insertPiece(o);if(i.selectedLanding.isPresent())return i.cancelMoveAttempt(),G.SUCCESS;if(i.selectedPiece.isPresent()){i.selectedLanding=S.of(o);const c=E1.get().getMovesBetween(i.getState(),i.getState().getPieceAt(i.selectedPiece.get()),i.selectedPiece.get(),o);return 0===c.length?i.changeMoveDestinationClick(o):i.performMoveOrShowOrientationArrows(c)}{Se(i.getState().isOnBoard(o),"SiamComponent: user clicked outside of board when it should not be possible");const c=i.board[r][e];return c.getOwner()!==i.getCurrentPlayer()?i.cancelMove(Mt.MUST_CHOOSE_PLAYER_PIECE()):i.selectPiece(o,c)}})()}insertPiece(e){var r=this;return O(function*(){if(r.selectedLanding.isPresent())return r.cancelMove(Kf.MUST_SELECT_ORIENTATION()),G.SUCCESS;r.selectedLanding=S.of(e);const s=E1.get().getInsertionsAt(r.getState(),e.x,e.y);return 0===s.length?r.changeMoveDestinationClick(e):r.performMoveOrShowOrientationArrows(s)})()}changeMoveDestinationClick(e){var r=this;return O(function*(){return r.cancelMoveAttempt(),r.getState().getPieceAt(e).getOwner()===r.getCurrentPlayer()?r.clickSquare(e.x,e.y,!0):r.cancelMove(Kf.MUST_SELECT_VALID_DESTINATION())})()}performMoveOrShowOrientationArrows(e){var r=this;return O(function*(){return Se(e.length>0,"SiamComponent.performMoveOrShowOrientationArrows expects at least one move"),1===e.length?(r.cancelMove(),r.chooseMove(e[0],r.getState())):(r.clickableCoords=new Z1,r.indicatorArrows=[],r.orientations=e,G.SUCCESS)})()}selectPiece(e,r){this.cancelMoveAttempt();const s=this.getState();this.selectedPiece=S.of(e);const i=E1.get().getMovesFrom(s,r,e.x,e.y);for(const o of i)if(o.direction.isPresent()){const c=o.coord.getNext(o.direction.get());if(this.clickableCoords.add(c),s.isOnBoard(c)&&s.getPieceAt(c)!==ut.EMPTY){const u={source:S.of({coord:e,piece:r}),target:c,direction:o.direction.get(),move:o};this.indicatorArrows.push(u)}}else this.clickableCoords.add(o.coord);return G.SUCCESS}clickArrow(e){var r=this;return O(function*(){const s=r.canUserPlay("#indicator_"+e.target.x+"_"+e.target.y+"_"+e.move.landingOrientation);return s.isFailure()?r.cancelMove(s.getReason()):r.chooseMove(e.move,r.getState())})()}isMountain(e){return e===ut.MOUNTAIN}getArrowTransform(e,r,s){const o=`rotate(${90*(s.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return["translate("+e*this.SPACE_SIZE+", "+r*this.SPACE_SIZE+")",o].join(" ")}getPieceTransform(e,r){return this.getArrowTransform(e+1,r+1,this.board[r][e].getDirection())}getIndicatorTransform(e){const r=e.target.getPrevious(e.direction,.5);return this.getArrowTransform(r.x+1,r.y+1,e.direction)}getRemainingPieceTransform(e,r){const s=this.playerPieces(r);let u,h,c=2;return r===F.ONE?(c+=(s-e+(5-s)/2)/3,u=-1,h=De.RIGHT):(c+=(e+1+(5-s)/2)/3,u=7,h=De.LEFT),this.getArrowTransform(c,u,h)}getOrientationTransform(e){const r=`translate(0, ${this.SPACE_SIZE/1.6})`,i=`rotate(${90*(e.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return[`translate(${2.27*this.SPACE_SIZE}, ${2.27*this.SPACE_SIZE})`,"scale(2.43)",i,r].join(" ")}getPieceClasses(e,r,s){const i=new P(e,r),o=[this.getPlayerClass(s.getOwner())];return this.selectedPiece.equalsValue(i)&&o.push("selected-stroke"),o}getSquareClasses(e,r){const s=new P(e,r);return this.movedPieces.some(i=>i.equals(s))?["moved-fill"]:[]}getRemainingPieceClasses(e,r){const s=[this.getPlayerClass(e)];return this.insertingPiece&&this.getCurrentPlayer()===e&&r===this.playerPieces(e)-1&&s.push("selected-stroke"),s}getCurrentPlayerClass(){return this.getPlayerClass(this.getCurrentPlayer())}playerPieces(e){return 5-this.getState().countPlayersPawn()[e.value]}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-siam"]],features:[l],decls:12,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -100 700 900","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 90, 90 50, 70 50, 70 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base mid-stroke semi-transparent",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngIf"],[0,"xlink","href","#mountain","class","nonplayer-fill",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],[0,"xlink","href","#mountain",1,"nonplayer-fill",3,"click"],["class","base semi-transparent",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke","clickable-stroke",3,"click"],[1,"base","semi-transparent",3,"id","ngClass","click"],[1,"base","no-fill","small-stroke","selected-stroke",3,"click"],[3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass"],[0,"xlink","href","#arrow",1,"base","mid-stroke","indicator-fill",3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"ngClass","click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"ngClass","click"],[0,"xlink","href","#arrow",1,"base","mid-stroke","semi-transparent",3,"id","ngClass","click"]],template:function(e,r){1&e&&(B(),N(0,"svg",0)(1,"defs"),X(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),A(),k(5,q0t,2,1,"g",4),k(6,Z0t,3,5,"g",4),k(7,Y0t,1,4,"rect",5),k(8,K0t,1,4,"rect",5),k(9,Q0t,2,2,"g",6),k(10,eut,3,5,"g",4),k(11,tut,1,3,"use",7),A()),2&e&&(M(5),w("ngForOf",r.board),M(1),w("ngForOf",r.clickableCoords),M(1),w("ngIf",r.selectedLanding.isPresent()),M(1),w("ngIf",r.selectedPiece.isPresent()),M(1),w("ngForOf",r.Player.PLAYERS),M(1),w("ngForOf",r.indicatorArrows),M(1),w("ngForOf",r.orientations))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),u3=(()=>{class n{}return n.NO_MOVEMENT_BEFORE_TURN_40=()=>$localize`You cannot move yet. Pick a space where you will put a new piece.`,n.MUST_CUT=()=>$localize`Several groups are of the same size, you must pick the one to keep.`,n.CANNOT_CHOOSE_TO_KEEP=()=>$localize`You cannot choose which part to keep when one is smaller than the other.`,n.CAN_NO_LONGER_DROP=()=>$localize`You cannot put new pieces anymore. Pick a piece to move.`,n.MUST_CAPTURE_BIGGEST_GROUPS=()=>$localize`You must choose one of the biggest groups to keep it.`,n.CANNOT_KEEP_EMPTY_COORD=()=>$localize`You cannot pick an empty space. Pick one of the biggest groups.`,n.MUST_DROP_NEXT_TO_OTHER_PIECE=()=>$localize`You must put this piece next to another piece.`,n})();class Nr extends MS{constructor(t,e,r){super(e),this.pieces=t;const s=this.getCalculatedScale();this.pieces=s.pieces,this.width=s.width,this.height=s.height,this.offset=r??s.offset,this.pieces.makeImmutable()}static getInitialState(){return Nr.fromRepresentation([[F.ZERO.value],[F.ONE.value]],0)}static fromRepresentation(t,e,r){const s=new k8;for(let i=0;i<t.length;i++)for(let o=0;o<t[0].length;o++)t[i][o]!==fe.NONE.value&&s.set(new P(o,i),F.of(t[i][o]));return new Nr(s,e,r)}static deplacePiece(t,e){const r=t.pieces.getCopy();return r.delete(e.start.get()),r.set(e.landing,t.getCurrentPlayer()),r}static getGroups(t,e){let r=new k8,s=0;for(const c of Ie.factory.all){const u=e.getNext(c,1);r=Nr.putCoordInGroup(t,u,r,""+s),s++}const i=r.reverse(),o=new Z1;for(let c=0;c<i.size();c++)o.add(i.getByIndex(c).value);return o}static putCoordInGroup(t,e,r,s){if(t.get(e).isPresent()&&r.get(e).isAbsent()){r.set(e,s);for(const i of Ie.factory.all){const o=e.getNext(i,1);r=Nr.putCoordInGroup(t,o,r,s)}}return r}getCalculatedScale(){let t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;for(const c of this.pieces.listKeys())t=Math.min(c.x,t),e=Math.max(c.x,e),r=Math.min(c.y,r),s=Math.max(c.y,s);let i=new k8;const o=new Un(-t,-r);if(0!==t||0!==r)for(const c of this.pieces.listKeys()){const u=this.pieces.delete(c),h=c.getNext(o);i.set(h,u)}else i=this.pieces;return{width:e+1-t,height:s+1-r,pieces:i,offset:o}}toRepresentation(){const t=ht.createTable(this.width,this.height,fe.NONE.value);for(const e of this.pieces.listKeys()){const r=this.getPieceAt(e).value;t[e.y][e.x]=r}return t}isIllegalLandingZone(t,e){return this.pieces.containsKey(t)?G.failure(Mt.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(t,e)?G.SUCCESS:G.failure(u3.MUST_DROP_NEXT_TO_OTHER_PIECE())}isCoordConnected(t,e){for(const r of Ie.factory.all){const s=t.getNext(r,1);if(this.pieces.containsKey(s)&&!1===e.equalsValue(s))return!0}return!1}isOnBoard(t){return this.pieces.containsKey(t)}getPieceAt(t){return this.isOnBoard(t)?this.pieces.get(t).get():fe.NONE}applyLegalDrop(t){const e=this.pieces.getCopy();return e.put(t,this.getCurrentPlayer()),new Nr(e,this.turn+1)}applyLegalDeplacement(t,e){const r=Nr.deplacePiece(this,t);let s=new k8;if(e.size()>0){s=new k8;for(const i of e)s.set(i,r.get(i).get())}else s=r.getCopy();return new Nr(s,this.turn+1)}countPieces(){const t=this.pieces.reverse(),e=t.get(F.ZERO).getOrElse(new dr),r=t.get(F.ONE).getOrElse(new dr);return[e.size(),r.size()]}switchPiece(t){const e=this.pieces.getCopy(),r=this.getPieceAt(t);if(r.isPlayer())return e.replace(t,r.getOpponent()),new Nr(e,this.turn,this.offset);ys.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:t.toString()})}equals(t){return this.turn===t.turn&&this.pieces.equals(t.pieces)}}class Vr extends so{constructor(t,e,r){if(super(),this.start=t,this.landing=e,this.keep=r,t.equalsValue(e))throw new Error("Deplacement cannot be static!");if(t.isPresent()&&t.equals(r))throw new Error("Cannot keep starting coord, since it will always be empty after move!")}static fromDrop(t){return new Vr(S.empty(),t,S.empty())}static fromMovement(t,e){return new Vr(S.of(t),e,S.empty())}static fromCut(t,e,r){return new Vr(S.of(t),e,S.of(r))}isDrop(){return this.start.isAbsent()}isCut(){return this.keep.isPresent()}toString(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}equals(t){return!1!==this.landing.equals(t.landing)&&!1!==this.start.equals(t.start)&&this.keep.equals(t.keep)}}Vr.encoder=new class extends e4{encodeMove(n){return{start:n.start.isPresent()?P.encoder.encode(n.start.get()):null,landing:P.encoder.encode(n.landing),keep:n.keep.isPresent()?P.encoder.encode(n.keep.get()):null}}decodeMove(n){const t=n;if("object"!=typeof n)throw new Error("Invalid encodedMove of type "+typeof n+"!");const e=P.encoder.decode(t.landing);if(null==t.start)return Vr.fromDrop(e);const r=P.encoder.decode(t.start);if(null==t.keep)return Vr.fromMovement(r,e);{const s=P.encoder.decode(t.keep);return Vr.fromCut(r,e,s)}}};class f3 extends hr{constructor(){super(...arguments),this.VERBOSE=!1}applyLegalMove(t,e,r){return e.turn<40?e.applyLegalDrop(t.landing):e.applyLegalDeplacement(t,r)}isLegal(t,e){Y(this.VERBOSE,{called:"SixRules.isLegal",move:t,state:e});const r=e.isIllegalLandingZone(t.landing,t.start);return r.isFailure()?r.toFailedFallible():e.turn<40?this.isLegalDrop(t,e):f3.isLegalPhaseTwoMove(t,e)}static getLegalLandings(t){const e=new dr;for(const r of t.pieces.listKeys())for(const s of Ie.factory.all){const i=r.getNext(s,1);t.getPieceAt(i)===fe.NONE&&e.add(i)}return e.toList()}isLegalDrop(t,e){return!1===t.isDrop()?K.failure(u3.NO_MOVEMENT_BEFORE_TURN_40()):K.success(e.pieces.getKeySet())}static isLegalPhaseTwoMove(t,e){if(t.isDrop())return K.failure(u3.CAN_NO_LONGER_DROP());switch(e.getPieceAt(t.start.get())){case fe.NONE:return K.failure(Mt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());case e.getCurrentOpponent():return K.failure(Mt.CANNOT_CHOOSE_OPPONENT_PIECE())}const r=Nr.deplacePiece(e,t),s=Nr.getGroups(r,t.start.get());if(f3.isSplit(s)){const i=this.getBiggerGroups(s);return 1===i.size()?t.keep.isPresent()?K.failure(u3.CANNOT_CHOOSE_TO_KEEP()):K.success(i.getAnyElement().get()):this.moveKeepBiggerGroup(t.keep,i,r)}return K.success(new dr)}static isSplit(t){return t.size()>1}static getBiggerGroups(t){let e=0,r=new Z1;for(const s of t){const i=s.size();i>e?(e=i,r=new Z1([s])):i===e&&r.add(s)}return r}static moveKeepBiggerGroup(t,e,r){if(t.isAbsent())return K.failure(u3.MUST_CUT());if(r.get(t.get()).isAbsent())return K.failure(u3.CANNOT_KEEP_EMPTY_COORD());const s=t.get();for(const i of e)if(i.contains(s))return K.success(i);return K.failure(u3.MUST_CAPTURE_BIGGEST_GROUPS())}getGameStatus(t){const e=t.gameState,r=e.getCurrentOpponent();let s=[];if(t.move.isPresent()&&(s=this.getShapeVictory(t.move.get(),e)),6===s.length)return ze.getVictory(r);if(e.turn>39){const i=e.countPieces(),o=i[0],c=i[1];return o<6&&c<6?o<c?ze.ONE_WON:c<o?ze.ZERO_WON:ze.DRAW:o<6?ze.getDefeat(F.ZERO):c<6?ze.getDefeat(F.ONE):ze.ONGOING}return ze.ONGOING}startSearchingVictorySources(){Y(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}getShapeVictory(t,e){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();const r=this.searchVictoryOnly(this.currentVictorySource,t,e);if(6===r.length)return r}return[]}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(t,e,r){const s=e.landing.getNext(r.offset,1);switch(Y(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:t,move:e,state:r}),t.typeSource){case"LINE":return this.searchVictoryOnlyForLine(t.index,s,r);case"CIRCLE":return this.searchVictoryOnlyForCircle(t.index,s,r);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(t.index,s,r);default:return this.searchVictoryOnlyForTriangleEdge(t.index,s,r)}}searchVictoryOnlyForCircle(t,e,r){Y(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent(),o=[e];let c=e.getNext(Ie.factory.all[t],1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];const h=(t+o.length)%6;o.push(c),c=c.getNext(Ie.factory.all[h],1)}return o}searchVictoryOnlyForLine(t,e,r){const s=r.getCurrentOpponent();let i=Ie.factory.all[t],o=e.getNext(i,1);const c=[e];let u=!1;for(;c.length<6;){if(r.getPieceAt(o)===s)c.push(o);else{if(u)return[];u=!0,i=i.getOpposite(),o=o.getNext(i,c.length)}o=o.getNext(i,1)}return c}searchVictoryOnlyForTriangleCorner(t,e,r){Y(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=Ie.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];o.length%2==0&&(i=Ie.factory.all[(t+o.length)%6]),o.push(c),c=c.getNext(i,1)}return o}searchVictoryOnlyForTriangleEdge(t,e,r){Y(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=Ie.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];o.push(c),o.length%2==0&&(i=Ie.factory.all[(t+o.length)%6]),c=c.getNext(i,1)}return o}}class rut extends rr{calculateBoardValue(t,e){this.startSearchingVictorySources();let r={status:Mn.DEFAULT,victory:S.empty(),preVictory:S.empty(),sum:0};for(;this.hasNextVictorySource();){const s=this.getNextVictorySource();let i;if(i=r.status===Mn.PRE_VICTORY?this.searchVictoryOnly(s,t,e):this.getBoardInfo(s,t,e,r),i.status===Mn.VICTORY)return i;r={status:i.status,victory:S.empty(),preVictory:i.preVictory,sum:r.sum+i.sum}}return r}}class xl extends dt{constructor(t,e){super(t),this.value=t,this.preVictory=e}}class b0 extends rut{constructor(){super(...arguments),this.VERBOSE=!1}static get(){if(b0.singleton.isAbsent()){const t=new f3(Nr);b0.singleton=S.of(new b0(t,"SixMinimax"))}return b0.singleton.get()}getListMoves(t){const e=b0.get(),r=t.getOwnValue(e);if(r.preVictory.isPresent())return t.gameState.turn<40?this.createForcedDrop(r):this.createForcedDeplacement(t,r);const s=f3.getLegalLandings(t.gameState);return t.gameState.turn<40?this.getListDrop(s):this.getListDeplacement(t.gameState,s)}createForcedDrop(t){Y(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:t});const e=[],r=Vr.fromDrop(t.preVictory.get());return e.push(r),e}createForcedDeplacement(t,e){Y(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:t});const r=this.getSafelyMovablePieceOrFirstOne(t),s=[e.preVictory.get()];return this.getDeplacementFrom(t.gameState,r,s)}getDeplacementFrom(t,e,r){const s=[];for(const i of e)for(const o of r){const c=Vr.fromMovement(i,o);if(t.isCoordConnected(o,S.of(i))){const u=Nr.deplacePiece(t,c),h=Nr.getGroups(u,c.start.get());if(f3.isSplit(h))for(const g of h){const m=g.getAnyElement().get(),v=Vr.fromCut(i,o,m);s.push(v)}else s.push(c)}}return s}getSafelyMovablePieceOrFirstOne(t){const e=t.gameState,r=e.pieces.reverse(),s=e.getCurrentPlayer(),i=r.get(s).get(),o=i.getAnyElement().get(),c=[];for(const u of i)!1===this.isPieceBlockingAVictory(e,u)&&c.push(u);return new dr(0===c.length?[o]:c)}isPieceBlockingAVictory(t,e){const r=t.switchPiece(e),s=Vr.fromDrop(e);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,s,r).status===Mn.VICTORY)return!0;return!1}getListDrop(t){const e=[];for(const r of t){const s=Vr.fromDrop(r);e.push(s)}return e}getListDeplacement(t,e){const r=t.getCurrentPlayer(),s=t.pieces.reverse().get(r).get();return this.getDeplacementFrom(t,s,e)}getBoardValue(t){const e=t.move,r=t.gameState,s=r.getCurrentOpponent(),i=s.getVictoryValue();let o={status:Mn.DEFAULT,victory:S.empty(),preVictory:S.empty(),sum:0};e.isPresent()&&(o=this.calculateBoardValue(e.get(),r));let c=S.empty();if(o.status===Mn.DEFAULT&&o.preVictory.isPresent()&&(c=S.of(o.preVictory.get())),o.status===Mn.VICTORY)return new xl(i,S.empty());if(r.turn>39){const u=r.countPieces(),h=u[0],g=u[1];return h<6&&g<6?new xl(h<g?F.ONE.getVictoryValue():g<h?F.ZERO.getVictoryValue():0,S.empty()):h<6?new xl(F.ZERO.getDefeatValue(),S.empty()):g<6?new xl(F.ONE.getDefeatValue(),S.empty()):new xl(h-g,c)}return new xl(o.status===Mn.PRE_VICTORY?s.getPreVictory():o.sum*s.getScoreModifier(),c)}startSearchingVictorySources(){Y(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(t,e,r){const s=e.landing.getNext(r.offset,1);switch(Y(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:t,move:e,state:r}),t.typeSource){case"LINE":return this.searchVictoryOnlyForLine(t.index,s,r);case"CIRCLE":return this.searchVictoryOnlyForCircle(t.index,s,r);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(t.index,s,r);default:return this.searchVictoryOnlyForTriangleEdge(t.index,s,r)}}searchVictoryOnlyForCircle(t,e,r){Y(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent(),o=[e];let c=e.getNext(Ie.factory.all[t],1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:Mn.PRE_VICTORY,victory:S.empty(),preVictory:S.empty(),sum:0};const h=(t+o.length)%6;o.push(c),c=c.getNext(Ie.factory.all[h],1)}return{status:Mn.VICTORY,victory:S.of(o),preVictory:S.empty(),sum:0}}searchVictoryOnlyForLine(t,e,r){const s=r.getCurrentOpponent();let i=Ie.factory.all[t],o=e.getNext(i,1);const c=[e];let u=!1;for(;c.length<6;){if(r.getPieceAt(o)===s)c.push(o);else{if(u)return{status:Mn.PRE_VICTORY,victory:S.empty(),preVictory:S.empty(),sum:0};u=!0,i=i.getOpposite(),o=o.getNext(i,c.length-1)}o=o.getNext(i,1)}return{status:Mn.VICTORY,victory:S.of(c),preVictory:S.empty(),sum:0}}searchVictoryOnlyForTriangleCorner(t,e,r){Y(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=Ie.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:Mn.PRE_VICTORY,victory:S.empty(),preVictory:S.empty(),sum:0};o.length%2==0&&(i=Ie.factory.all[(t+o.length)%6]),o.push(c),c=c.getNext(i,1)}return{status:Mn.VICTORY,victory:S.of(o),preVictory:S.empty(),sum:0}}searchVictoryOnlyForTriangleEdge(t,e,r){Y(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=Ie.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:Mn.PRE_VICTORY,victory:S.empty(),preVictory:S.empty(),sum:0};o.push(c),o.length%2==0&&(i=Ie.factory.all[(t+o.length)%6]),c=c.getNext(i,1)}return{status:Mn.VICTORY,victory:S.of(o),preVictory:S.empty(),sum:0}}getBoardInfo(t,e,r,s){Y(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:t,move:e,state:r,boardInfo:s});const i=e.landing.getNext(r.offset,1);switch(t.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(t.index,i,r,s);case"LINE":return this.getBoardInfoForLine(t.index,i,r,s);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(t.index,i,r,s);default:return this.getBoardInfoForTriangleEdge(t.index,i,r,s)}}getBoardInfoForCircle(t,e,r,s){Y(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer(),c=[e];let u=e.getNext(Ie.factory.all[t],1),h=0,g=S.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;const v=(t+c.length)%6;c.push(u);const T=Ie.factory.all[v];m===fe.NONE?(h+=.16,g=S.of(u)):h++,u=u.getNext(T,1)}return this.getBoardInfoResult(h,g,c,s)}getBoardInfoResult(t,e,r,s){let i=s.preVictory;if(4.16===t){if(Y(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(e))return{status:Mn.PRE_VICTORY,victory:S.empty(),preVictory:S.empty(),sum:0};i=e}else if(5===t)return{status:Mn.VICTORY,victory:S.of(r),preVictory:S.empty(),sum:0};return{status:s.status,victory:S.empty(),preVictory:i,sum:s.sum+t}}getBoardInfoForLine(t,e,r,s){Y(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:t,lastDrop:e,state:r,boardInfo:s});const i=Ie.factory.all[t];let o=e.getPrevious(i,5),c=[],u=[],h=S.empty();for(let z=0;z<6;z++){const Z=this.updateEncounterAndReturnLastEmpty(r,o,u);Z.isPresent()&&(h=Z),c.push(o),o=o.getNext(i,1)}let g=s.status,m=s.preVictory,v=0,T=0;for(;v<6;){const z=u.reduce((te,me)=>te+me);if(6===z)return{status:Mn.VICTORY,victory:S.of(c),preVictory:S.empty(),sum:0};5.16===z&&g===Mn.DEFAULT&&(m.isPresent()?(Se(!1===m.equals(h),"Impossible to have point aligned with differents line to a same point"),g=Mn.PRE_VICTORY):m=h),T=Math.max(T,z),c=c.slice(1,6),c.push(o),u=u.slice(1,6);const Z=this.updateEncounterAndReturnLastEmpty(r,o,u);Z.isPresent()&&(h=Z),v++,o=o.getNext(i,1)}const I={status:g,victory:S.of(c),preVictory:m,sum:T};return this.getBoardInfoResult(T,h,c,I)}updateEncounterAndReturnLastEmpty(t,e,r){const s=t.getCurrentPlayer();switch(t.getPieceAt(e)){case s:return r.push(-7),S.empty();case fe.NONE:return r.push(.16),S.of(e);default:return r.push(1),S.empty()}}getBoardInfoForTriangleCorner(t,e,r,s){Y(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer();let o=Ie.factory.all[t];const c=[e];let u=e.getNext(o,1),h=0,g=S.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;m===fe.NONE?(h+=.16,g=S.of(u)):h++,c.length%2==0&&(o=Ie.factory.all[(t+c.length)%6]),c.push(u),u=u.getNext(o,1)}return this.getBoardInfoResult(h,g,c,s)}getBoardInfoForTriangleEdge(t,e,r,s){Y(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer();let o=Ie.factory.all[t];const c=[e];let u=e.getNext(o,1),h=0,g=S.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;m===fe.NONE?(h+=.16,g=S.of(u)):h++,c.push(u),c.length%2==0&&(o=Ie.factory.all[(t+c.length)%6]),u=u.getNext(o,1)}return this.getBoardInfoResult(h,g,c,s)}}b0.singleton=S.empty();const Ce=fe.NONE.value,Vt=F.ZERO.value,Wt=F.ONE.value;let VV=(()=>{class n{}return n.MOVEMENT_NOT_DISCONNECTING=()=>$localize`This move does not disconnect your opponent's pieces. Try again with another piece.`,n.MOVEMENT_SELF_DISCONNECTING=()=>$localize`You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!`,n})();class Ace extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Six`,$localize`Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.
        Each player has 21 pieces, with one for each player already on the board.
        The goal of the game is to form one of the three winning shapes with your pieces.`,Nr.getInitialState()),pe.fromMove($localize`Victory (line)`,$localize`On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>
        Find the victory. You're playing Dark.`,Nr.fromRepresentation([[Vt,Wt,Wt,Wt,Wt,Vt],[Ce,Vt,Wt,Ce,Vt,Ce],[Wt,Wt,Vt,Ce,Ce,Ce],[Ce,Ce,Vt,Ce,Ce,Ce],[Ce,Vt,Ce,Ce,Ce,Ce],[Vt,Ce,Ce,Ce,Ce,Ce]],0),[Vr.fromDrop(new P(3,2))],$localize`Congratulations!`,$localize`Failed!`),pe.fromMove($localize`Victory (circle)`,$localize`On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,Nr.fromRepresentation([[Ce,Ce,Ce,Wt,Ce,Ce],[Ce,Ce,Wt,Wt,Vt,Vt],[Ce,Wt,Ce,Vt,Wt,Ce],[Wt,Vt,Vt,Vt,Vt,Wt]],0),[Vr.fromDrop(new P(5,2))],$localize`Congratulations! Note that if a piece is inside the circle, it does not change anything.`,$localize`Failed!`),pe.fromMove($localize`Victory (triangle)`,$localize`On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,Nr.fromRepresentation([[Ce,Ce,Ce,Wt,Ce,Ce],[Ce,Vt,Wt,Vt,Vt,Vt],[Ce,Vt,Ce,Vt,Vt,Ce],[Wt,Wt,Wt,Ce,Wt,Ce]],0),[Vr.fromDrop(new P(3,3))],$localize`Congratulations!`,$localize`Failed!`),pe.fromPredicate($localize`Second phase`,$localize`After 40 turns, your pieces have all been placed and we move on to the second phase of the game.
        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.
        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>
        You're playing Dark. Make a move that disconnects one of your opponent's pieces.`,Nr.fromRepresentation([[Ce,Ce,Ce,Ce,Ce,Ce,Ce,Wt,Ce],[Ce,Ce,Ce,Ce,Ce,Ce,Vt,Ce,Ce],[Ce,Ce,Ce,Ce,Vt,Vt,Vt,Ce,Ce],[Ce,Ce,Ce,Ce,Wt,Wt,Ce,Wt,Vt],[Ce,Vt,Wt,Wt,Vt,Vt,Wt,Ce,Ce],[Vt,Vt,Vt,Vt,Wt,Wt,Wt,Vt,Ce],[Wt,Wt,Vt,Ce,Wt,Wt,Vt,Ce,Ce],[Ce,Vt,Ce,Vt,Vt,Ce,Ce,Ce,Ce],[Wt,Wt,Wt,Wt,Ce,Ce,Ce,Ce,Ce],[Ce,Vt,Ce,Wt,Ce,Ce,Ce,Ce,Ce]],40),Vr.fromMovement(new P(6,1),new P(5,1)),(t,e,r)=>{const s=r.countPieces();return 19===s[0]?18===s[1]?G.SUCCESS:G.failure(VV.MOVEMENT_NOT_DISCONNECTING()):G.failure(VV.MOVEMENT_SELF_DISCONNECTING())},$localize`Congratulations, your opponent now has one piece less and you're closer to victory!`),pe.fromPredicate($localize`Victory by disconnection`,$localize`During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.
        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.
        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>
        Here, you're playing Dark and you can win. Do it!`,Nr.fromRepresentation([[Ce,Ce,Ce,Ce,Ce,Wt],[Ce,Ce,Ce,Ce,Vt,Wt],[Ce,Ce,Ce,Wt,Vt,Vt],[Ce,Ce,Vt,Ce,Wt,Vt],[Wt,Wt,Ce,Ce,Ce,Vt],[Vt,Wt,Ce,Ce,Ce,Ce],[Vt,Ce,Ce,Ce,Ce,Ce]],40),Vr.fromMovement(new P(2,3),new P(3,3)),(t,e,r)=>t.start.equalsValue(new P(2,3))?G.SUCCESS:G.failure(VV.MOVEMENT_NOT_DISCONNECTING()),$localize`Congratulations, you won!`),pe.fromPredicate($localize`Special disconnection`,$localize`During a disconnection, two or more groups could have the same size,
        in which case you will have to click on the group you wish to keep.<br/><br/>
        You're playing Dark, play such a move!`,Nr.fromRepresentation([[Ce,Ce,Ce,Ce,Ce,Wt],[Ce,Ce,Ce,Ce,Vt,Wt],[Ce,Ce,Ce,Wt,Vt,Vt],[Vt,Ce,Vt,Ce,Ce,Wt],[Wt,Wt,Ce,Ce,Ce,Ce],[Vt,Vt,Ce,Ce,Ce,Ce],[Vt,Ce,Ce,Ce,Ce,Ce]],40),Vr.fromCut(new P(2,3),new P(2,5),new P(2,5)),(t,e,r)=>t.keep.isAbsent()?G.failure($localize`This move has not cut the board in two equal halves.`):r.getPieceAt(t.landing.getNext(r.offset))===fe.NONE?G.failure($localize`Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again.`):G.SUCCESS,$localize`Congratulations, you won!`)]}}function sut(n,t){if(1&n){const e=we();B(),N(0,"polygon",10),se("click",function(){const i=he(e).$implicit;return ce(E().onPieceClick(i))}),A()}if(2&n){const e=t.$implicit,r=E();je("id","piece_",e.x,"_",e.y,""),w("ngClass",r.getPieceClass(e)),V("points",r.getHexaCoordsAt(e))}}function iut(n,t){if(1&n){const e=we();B(),N(0,"polygon",11),se("click",function(){const i=he(e).$implicit;return ce(E().onNeighborClick(i))}),A()}if(2&n){const e=t.$implicit,r=E();je("id","neighbor_",e.x,"_",e.y,""),V("points",r.getHexaCoordsAt(e))}}function out(n,t){if(1&n){const e=we();B(),N(0,"polygon",10),se("click",function(){he(e);const s=E();return ce(s.onPieceClick(s.chosenLanding.get()))}),A()}if(2&n){const e=E();je("id","chosenLanding_",e.chosenLanding.get().x,"_",e.chosenLanding.get().y,""),w("ngClass",e.getPlayerClass(e.state.getCurrentPlayer())),V("points",e.getHexaCoordsAt(e.chosenLanding.get()))}}function aut(n,t){if(1&n&&(B(),X(0,"polygon",12)),2&n){const e=t.$implicit,r=E();je("id","disconnected_",e.x,"_",e.y,""),V("points",r.getHexaCoordsAt(e))}}function cut(n,t){if(1&n){const e=we();B(),N(0,"polygon",13),se("click",function(){he(e);const s=E();return ce(s.onNeighborClick(s.leftCoord.get()))}),A()}if(2&n){const e=E();je("id","leftCoord_",e.leftCoord.get().x,"_",e.leftCoord.get().y,""),V("points",e.getHexaCoordsAt(e.leftCoord.get()))}}function lut(n,t){if(1&n){const e=we();B(),N(0,"polygon",14),se("click",function(){he(e);const s=E();return ce(s.onPieceClick(s.lastDrop.get()))}),A()}if(2&n){const e=E();je("id","lastDrop_",e.lastDrop.get().x,"_",e.lastDrop.get().y,""),V("points",e.getHexaCoordsAt(e.lastDrop.get()))}}function uut(n,t){if(1&n){const e=we();B(),N(0,"polygon",15),se("click",function(){he(e);const s=E();return ce(s.onPieceClick(s.selectedPiece.get()))}),A()}if(2&n){const e=E();je("id","selectedPiece_",e.selectedPiece.get().x,"_",e.selectedPiece.get().y,""),w("ngClass",e.getSelectedPieceClass()),V("points",e.getHexaCoordsAt(e.selectedPiece.get()))}}function fut(n,t){if(1&n&&(B(),X(0,"polygon",16)),2&n){const e=t.$implicit,r=E();je("id","victoryCoord_",e.x,"_",e.y,""),V("points",r.getHexaCoordsAt(e))}}function hut(n,t){if(1&n){const e=we();B(),N(0,"polygon",19),se("click",function(){const i=he(e).$implicit;return ce(E(2).onPieceClick(i))}),A()}if(2&n){const e=t.$implicit,r=E(2);je("id","cuttable_",e.x,"_",e.y,""),V("points",r.getHexaCoordsAt(e))}}function dut(n,t){if(1&n&&(B(),N(0,"g",17),k(1,hut,1,3,"polygon",18),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}let put=(()=>{class n extends Zg{constructor(e){super(e),this.disconnecteds=[],this.cuttableGroups=[],this.leftCoord=S.empty(),this.lastDrop=S.empty(),this.selectedPiece=S.empty(),this.chosenLanding=S.empty(),this.nextClickShouldSelectGroup=!1,this.rules=new f3(Nr),this.availableMinimaxes=[new b0(this.rules,"SixMinimax")],this.encoder=Vr.encoder,this.tutorial=(new Ace).tutorial,this.SPACE_SIZE=30,this.hexaLayout=new Yg(1.5*this.SPACE_SIZE,new P(2*this.SPACE_SIZE,0),o2.INSTANCE),this.updateBoard()}cancelMoveAttempt(){this.selectedPiece=S.empty(),this.chosenLanding=S.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}updateBoard(){this.state=this.rules.node.gameState,this.rules.node.move.isPresent()?this.showLastMove():(this.leftCoord=S.empty(),this.lastDrop=S.empty(),this.victoryCoords=[],this.disconnecteds=[]),this.pieces=this.state.pieces.listKeys(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}getViewBox(){const e=this.mapAbstractCoordToCornerCoords(),r=this.getLimits(e);return r.minX-this.STROKE_WIDTH/2+" "+(r.minY-this.STROKE_WIDTH/2)+" "+(this.STROKE_WIDTH+r.maxX-r.minX)+" "+(this.STROKE_WIDTH+r.maxY-r.minY)}mapAbstractCoordToCornerCoords(){const r=this.pieces.concat(this.disconnecteds).concat(this.neighbors).map(i=>this.hexaLayout.getHexaCoordsAt(i));let s=[];for(const i of r)s=s.concat(i);return s}getLimits(e){let r=Number.MIN_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER;for(const c of e)c.x<i&&(i=c.x),c.y<o&&(o=c.y),r=Math.max(r,c.x),s=Math.max(s,c.y);return{minX:i,minY:o,maxX:r,maxY:s}}showLastMove(){const e=this.rules.node.move.get();this.lastDrop=S.of(e.landing.getNext(this.state.offset,1)),this.leftCoord=!1===e.isDrop()?S.of(e.start.get().getNext(this.state.offset,1)):S.empty();const r=this.getState();this.rules.getGameStatus(this.rules.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,r)),this.disconnecteds=this.getDisconnected()}getDisconnected(){const e=this.rules.node.mother.get().gameState.pieces.listKeys(),r=this.getState().pieces.listKeys(),s=[];for(const o of e)!1===this.rules.node.move.get().start.equalsValue(o)&&!1===r.some(u=>u.equals(o.getNext(this.state.offset,1)))&&s.push(o.getNext(this.state.offset,1));const i=this.lastDrop.get();return!1===this.pieces.some(o=>o.equals(i))&&!1===r.some(o=>o.equals(i))&&s.push(i),s}getEmptyNeighbors(){let e=f3.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){const r=this.chosenLanding.get();e=e.filter(s=>!1===s.equals(r))}return e}getPieceClass(e){const r=this.getState().getPieceAt(e);return this.getPlayerClass(r)}onPieceClick(e){var r=this;return O(function*(){const s=r.canUserPlay("#piece_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());if(r.state.turn<40)return r.cancelMove(u3.NO_MOVEMENT_BEFORE_TURN_40());if(r.chosenLanding.isAbsent())return r.state.getPieceAt(e)===r.state.getCurrentOpponent()?r.cancelMove(Mt.CANNOT_CHOOSE_OPPONENT_PIECE()):(r.selectedPiece=r.selectedPiece.equalsValue(e)?S.empty():S.of(e),G.SUCCESS);{const i=Vr.fromCut(r.selectedPiece.get(),r.chosenLanding.get(),e);return r.chooseMove(i,r.state)}})()}onNeighborClick(e){var r=this;return O(function*(){const s=r.canUserPlay("#neighbor_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());if(r.nextClickShouldSelectGroup)return r.cancelMove(u3.MUST_CUT());if(r.state.turn<40)return r.chooseMove(Vr.fromDrop(e),r.state);if(r.selectedPiece.isAbsent())return r.cancelMove(u3.CAN_NO_LONGER_DROP());{const i=Vr.fromMovement(r.selectedPiece.get(),e),o=f3.isLegalPhaseTwoMove(i,r.state);return r.neededCutting(o)?(r.chosenLanding=S.of(e),r.moveVirtuallyPiece(),r.showCuttable(),r.nextClickShouldSelectGroup=!0,G.SUCCESS):r.chooseMove(i,r.state)}})()}neededCutting(e){return e.isFailure()&&e.getReason()===u3.MUST_CUT()}moveVirtuallyPiece(){const e=this.selectedPiece.get();this.pieces=this.pieces.filter(r=>!1===r.equals(e)),this.neighbors=this.getEmptyNeighbors()}showCuttable(){const e=Vr.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),r=Nr.deplacePiece(this.state,e),s=Nr.getGroups(r,e.start.get()),i=f3.getBiggerGroups(s);this.cuttableGroups=[];for(const o of i)this.cuttableGroups.push(o.toList())}getSelectedPieceClass(){return this.chosenLanding.isPresent()?"moved-fill":"selected-stroke"}}return n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-six"]],features:[l],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured-fill",3,"id",4,"ngFor","ngForOf"],["class","base round moved-fill mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move-stroke mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round victory-fill mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured-fill",3,"id"],[1,"base","round","moved-fill","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move-stroke","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","victory-fill","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(e,r){1&e&&(B(),N(0,"svg",0),k(1,sut,1,4,"polygon",1),k(2,iut,1,3,"polygon",2),k(3,out,1,4,"polygon",3),k(4,aut,1,3,"polygon",4),k(5,cut,1,3,"polygon",5),k(6,lut,1,3,"polygon",6),k(7,uut,1,4,"polygon",7),k(8,fut,1,3,"polygon",8),k(9,dut,2,1,"g",9),A()),2&e&&(V("viewBox",r.viewBox),M(1),w("ngForOf",r.pieces),M(1),w("ngForOf",r.neighbors),M(1),w("ngIf",r.chosenLanding.isPresent()),M(1),w("ngForOf",r.disconnecteds),M(1),w("ngIf",r.leftCoord.isPresent()),M(1),w("ngIf",r.lastDrop.isPresent()),M(1),w("ngIf",r.selectedPiece.isPresent()),M(1),w("ngForOf",r.victoryCoords),M(1),w("ngForOf",r.cuttableGroups))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Wo extends EV{static of(t,e){return new Wo(t,e)}static from(t,e){try{const r=new Wo(t,e);return K.success(r)}catch(r){return K.failure(r.message)}}getMaximalDistance(){return 9}}Wo.encoder=tc.getEncoder(9,9,Wo.of);const gut={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:F.ZERO};class u4 extends MV{static getInitialState(){const t=cn.UNOCCUPIED,e=cn.INVADERS,r=cn.DEFENDERS;return new u4([[t,t,t,e,e,e,t,t,t],[t,t,t,t,e,t,t,t,t],[t,t,t,t,r,t,t,t,t],[e,t,t,t,r,t,t,t,e],[e,e,r,r,cn.PLAYER_ONE_KING,r,r,e,e],[e,t,t,t,r,t,t,t,e],[t,t,t,t,r,t,t,t,t],[t,t,t,t,e,t,t,t,t],[t,t,t,e,e,e,t,t,t]],0)}from(t,e){return new u4(t,e)}}class B8 extends SV{constructor(){super(u4,gut,Wo.of)}static get(){return null==B8.singleton&&(B8.singleton=new B8),fr.ruler=this.singleton,B8.singleton}}const W=cn.UNOCCUPIED,e1=cn.INVADERS,Li=cn.DEFENDERS,QS=cn.PLAYER_ONE_KING;class Oce extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Goal of the game`,$localize`Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,u4.getInitialState()),pe.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,u4.getInitialState(),Wo.of(new P(4,1),new P(1,1)),$localize`Congratulations!`),pe.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it.`,new u4([[W,W,W,e1,e1,e1,W,W,W],[W,W,W,W,e1,W,W,W,W],[W,W,W,W,Li,W,W,W,W],[W,W,W,e1,Li,W,W,W,e1],[e1,e1,Li,Li,QS,Li,Li,e1,e1],[W,W,W,W,Li,W,W,W,e1],[W,W,W,W,Li,W,W,W,W],[W,W,W,W,e1,W,W,W,W],[W,W,W,e1,e1,e1,W,W,W]],1),[Wo.of(new P(2,4),new P(2,3)),Wo.of(new P(4,2),new P(3,2))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),pe.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it.`,new u4([[W,W,W,e1,e1,e1,W,W,W],[W,W,W,W,e1,W,W,W,W],[W,W,W,W,Li,W,W,W,W],[W,W,Li,W,QS,W,Li,W,e1],[e1,e1,W,Li,W,Li,Li,e1,e1],[W,W,W,W,Li,W,W,W,e1],[W,W,W,W,Li,W,W,W,W],[W,W,W,W,e1,W,W,W,W],[W,W,W,e1,e1,e1,W,W,W]],12),[Wo.of(new P(1,4),new P(2,4))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),pe.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>Capture the king.`,new u4([[W,W,W,W,W,W,W,W,W],[W,W,W,W,W,W,W,W,W],[W,W,W,W,W,W,W,W,W],[W,e1,W,W,W,W,W,W,W],[e1,QS,W,e1,W,W,W,W,W],[W,e1,W,W,W,W,W,W,W],[W,W,W,W,W,W,W,W,W],[W,W,W,W,W,W,W,W,W],[W,W,W,W,W,W,W,W,W]],72),[Wo.of(new P(3,4),new P(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),pe.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>Capture the king.`,new u4([[W,W,e1,QS,e1,W,W,W,W],[W,W,W,W,W,W,W,W,W],[W,W,W,W,W,W,W,W,W],[W,W,W,e1,W,W,W,W,W],[W,W,W,W,W,W,W,W,W],[W,W,W,W,W,W,W,W,W],[W,W,W,W,W,W,W,W,W],[W,W,W,W,W,W,W,W,W],[W,W,W,W,W,W,W,W,W]],72),[Wo.of(new P(3,3),new P(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed!`)]}}function mut(n,t){1&n&&(B(),X(0,"polygon",8))}function _ut(n,t){1&n&&(B(),X(0,"rect",9))}function vut(n,t){if(1&n&&(B(),N(0,"g"),k(1,mut,1,0,"polygon",6),k(2,_ut,1,0,"ng-template",null,7,l1),A()),2&n){const e=s1(3),r=E().index,s=E().index,i=E();M(1),w("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function Cut(n,t){if(1&n&&(B(),N(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),A()),2&n){const e=E(2).index,r=E().index,s=E();M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function yut(n,t){if(1&n&&(B(),X(0,"polyline",16)),2&n){const e=E(3).index,r=E().index;w("ngClass",E().viewInfo.pieceClasses[r][e])}}function Eut(n,t){if(1&n&&(B(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=E(3).index,r=E().index,s=E();w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),M(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),V("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function Mut(n,t){if(1&n&&(B(),k(0,yut,1,1,"polyline",14),k(1,Eut,4,20,"ng-template",null,15,l1)),2&n){const e=s1(2),r=E(2).index,s=E().index;w("ngIf",E().isKing(r,s))("ngIfElse",e)}}function Sut(n,t){if(1&n&&(B(),N(0,"g"),X(1,"circle",10),k(2,Cut,6,25,"g",11),k(3,Mut,3,2,"ng-template",null,12,l1),A()),2&n){const e=s1(4),r=E().index,s=E().index,i=E();M(1),je("id","piece_",r,"_",s,""),w("ngClass",i.viewInfo.pieceClasses[s][r]),V("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),M(1),w("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function Put(n,t){if(1&n){const e=we();B(),N(0,"g",3),se("click",function(){const i=he(e).index,o=E().index;return ce(E().onClick(i,o))}),X(1,"rect",4),k(2,vut,4,2,"g",5),k(3,Sut,5,8,"g",5),A()}if(2&n){const e=t.index,r=E().index,s=E();je("id","click_",e,"_",r,""),V("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),M(1),w("ngClass",s.getRectClasses(e,r)),V("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),M(1),w("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),M(1),w("ngIf",s.board[r][e]!==s.EMPTY)}}function Tut(n,t){if(1&n&&(B(),N(0,"g"),k(1,Put,4,8,"g",2),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}function wut(n,t){if(1&n){const e=we();B(),N(0,"g")(1,"rect",17),se("click",function(){const i=he(e).$implicit;return ce(E().onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=E();M(1),je("id","click_",e.x,"_",e.y,""),V("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let but=(()=>{class n extends PV{constructor(e){super(e,!1,Wo.from),this.rules=B8.get(),this.availableMinimaxes=[new wS(this.rules,"DummyBot"),new NS(this.rules,"Piece > Influence"),new Qc(this.rules,"Piece > Control"),new kf(this.rules,"Escape > Piece > Control")],this.encoder=Wo.encoder,this.tutorial=(new Oce).tutorial,this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-tablut"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(B(),N(0,"svg",0),k(1,Tut,2,1,"g",1),k(2,wut,2,6,"g",1),A()),2&e&&(V("viewBox",r.getViewBox()),M(1),w("ngForOf",r.board),M(1),w("ngForOf",r.getClickables()))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Ar{}Ar.PLACEMENT_AFTER_INITIAL_PHASE=()=>$localize`You cannot put a new ring after the tenth turn.`,Ar.NO_MARKERS_IN_INITIAL_PHASE=()=>$localize`You cannot put a marker in a ring before placing all of your rings.`,Ar.MISSING_CAPTURES=oc.MISSING_CAPTURES,Ar.MOVE_DIRECTION_INVALID=()=>$localize`The direction of your move is invalid: a move is made along a straight line.`,Ar.CAN_ONLY_CAPTURE_YOUR_MARKERS=()=>$localize`You can only capture your own markers.`,Ar.SHOULD_SELECT_PLAYER_RING=()=>$localize`You must pick one of your own rings to move.`,Ar.SHOULD_END_MOVE_ON_EMPTY_SPACE=()=>$localize`Your ring must land on an empty space.`,Ar.MOVE_SHOULD_NOT_PASS_ABOVE_RING=()=>$localize`A ring can only jump over markers or empty spaces, not over another ring.`,Ar.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=()=>$localize`Your ring must land on the first empty space after a group of markers.`,Ar.AMBIGUOUS_CAPTURE_COORD=oc.AMBIGUOUS_CAPTURE_COORD,Ar.CAPTURE_SHOULD_TAKE_RING=()=>$localize`When you capture markers, you must take one of your ring as well by clicking on it.`;class Pt{constructor(t,e){this.player=t,this.isRing=e}static of(t,e){return t===fe.NONE?Pt.EMPTY:e?Pt.RINGS[t.value]:Pt.MARKERS[t.value]}equals(t){return this===t}flip(){return Se(!1===this.isRing,"cannot flip a ring (it should never happen)"),Se(this.player.isPlayer(),"cannot flip a non-player piece"),Pt.of(this.player.getOpponent(),this.isRing)}toString(){switch(this){case Pt.UNREACHABLE:return"NONE";case Pt.EMPTY:return"EMPTY";case Pt.MARKER_ZERO:return"MARKER_ZERO";case Pt.MARKER_ONE:return"MARKER_ONE";case Pt.RING_ZERO:return"RING_ZERO";default:return Ae.expectToBe(this,Pt.RING_ONE),"RING_ONE"}}}Pt.encoder=on.tuple([F.numberEncoder,on.booleanEncoder],n=>[n.player,n.isRing],n=>Pt.of(n[0],n[1])),Pt.UNREACHABLE=new Pt(fe.NONE,!1),Pt.EMPTY=new Pt(fe.NONE,!1),Pt.MARKER_ZERO=new Pt(F.ZERO,!1),Pt.MARKER_ONE=new Pt(F.ONE,!1),Pt.MARKERS=[Pt.MARKER_ZERO,Pt.MARKER_ONE],Pt.RING_ZERO=new Pt(F.ZERO,!0),Pt.RING_ONE=new Pt(F.ONE,!0),Pt.RINGS=[Pt.RING_ZERO,Pt.RING_ONE];let Ta=(()=>{class n extends z8{constructor(e,r,s){super(s,e,n.SIZE,n.SIZE,[6,4,3,2,1],Pt.EMPTY),this.sideRings=r}static getInitialState(){const e=Pt.EMPTY,r=Pt.UNREACHABLE;return new n([[r,r,r,r,r,r,e,e,e,e,r],[r,r,r,r,e,e,e,e,e,e,e],[r,r,r,e,e,e,e,e,e,e,e],[r,r,e,e,e,e,e,e,e,e,e],[r,e,e,e,e,e,e,e,e,e,e],[r,e,e,e,e,e,e,e,e,e,r],[e,e,e,e,e,e,e,e,e,e,r],[e,e,e,e,e,e,e,e,e,r,r],[e,e,e,e,e,e,e,e,r,r,r],[e,e,e,e,e,e,e,r,r,r,r],[r,e,e,e,e,r,r,r,r,r,r]],[5,5],0)}isInitialPlacementPhase(){return this.turn<10}countScores(){return this.turn<10?[0,0]:this.sideRings}equals(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&ht.compareTable(this.board,e.board)}getRingCoords(e){const r=[];return this.forEachCoord((s,i)=>{i.isRing&&i.player===e&&r.push(s)}),r}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Pt.UNREACHABLE}setAtUnsafe(e,r){const s=ht.copyBiArray(this.board);return s[e.y][e.x]=r,new n(s,this.sideRings,this.turn)}}return n.SIZE=11,n})();class qo extends l2{constructor(t,e){if(super(t),5!==t.length)throw new Error("YinshCapture must capture exactly 5 pieces");this.ringTaken=S.ofNullable(e)}static of(t,e,r){const s=[],i=Ie.factory.fromMove(t,e).get();for(let o=t;!1===o.equals(e);o=o.getNext(i))s.push(o);return s.push(e),new qo(s,r)}setRingTaken(t){return new qo(this.capturedSpaces,t)}equals(t){return!(!1===super.equals(t)||!1===this.ringTaken.equals(t.ringTaken))}}qo.encoder=new class extends u0{encode(n){return{captured:n.capturedSpaces.map(t=>P.encoder.encode(t)),ringTaken:P.encoder.encode(n.ringTaken.get())}}decode(n){const t=n;return Se(null!=t.captured&&null!=t.ringTaken,"Invalid encoded YinshCapture"),new qo(t.captured.map(e=>P.encoder.decode(e)),P.encoder.decode(t.ringTaken))}};class wa extends so{constructor(t,e,r,s){super(),this.initialCaptures=t,this.start=e,this.end=r,this.finalCaptures=s}isInitialPlacement(){return this.end.isAbsent()}equals(t){return this===t||!(!1===this.start.equals(t.start)||!1===this.end.equals(t.end)||!1===ht.compareArray(this.initialCaptures,t.initialCaptures)||!1===ht.compareArray(this.finalCaptures,t.finalCaptures))}toString(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(t){let e="";for(const r of t)""!==e&&(e+=","),e+="["+r.toString()+"]";return e}}wa.coordOptionalEncoder=Yae(P.encoder),wa.encoder=new class extends e4{encodeMove(n){const t={moveStart:P.encoder.encode(n.start),moveEnd:wa.coordOptionalEncoder.encode(n.end)};return n.initialCaptures.map((e,r)=>{t["initialCapture"+r]=qo.encoder.encode(e)}),n.finalCaptures.map((e,r)=>{t["finalCapture"+r]=qo.encoder.encode(e)}),t}decodeMove(n){const t=n;return Se(null!=t.moveStart,"Invalid encoded YinshMove"),new wa(this.decodeArray(t,"initialCapture",qo.encoder.decode),P.encoder.decode(t.moveStart),wa.coordOptionalEncoder.decode(t.moveEnd),this.decodeArray(t,"finalCapture",qo.encoder.decode))}decodeArray(n,t,e){const r=[];for(let s=0;null!=n[t+s];s++)r.push(e(n[t+s]));return r}};class Aut extends rr{getBoardValue(t){const e=this.ruler.getGameStatus(t);return e.isEndGame?dt.fromWinner(e.winner):new dt(t.gameState.sideRings[0]*F.ZERO.getScoreModifier()+t.gameState.sideRings[1]*F.ONE.getScoreModifier())}getListMoves(t){const e=[],r=t.gameState;if(r.isInitialPlacementPhase())for(const[s,i]of r.getCoordsAndContents())i===Pt.EMPTY&&e.push(new wa([],s,S.empty(),[]));else{const s=this.ruler;this.getPossibleCaptureCombinations(r).forEach(i=>{const o=s.applyCaptures(i,r);this.getRingMoves(o).forEach(c=>{const u=s.applyRingMoveAndFlip(c.start,c.end,o);this.getPossibleCaptureCombinations(u).forEach(h=>{const g=new wa(i,c.start,S.of(c.end),h);e.push(g)})})})}return e}getPossibleCaptureCombinations(t){const r=this.ruler.getPossibleCaptures(t),s=this.getRingCoords(t);return tm.getPossibleCaptureCombinationsFromPossibleCaptures(r).map(i=>class Nut{static getCombinations(t,e){return Se(t.length>=e,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(t,e).map(r=>this.getPermutations(r)).reduce((r,s)=>r.concat(s))}static getPermutations(t){const e=t.length,r=[t.slice()],s=new Array(e).fill(0);let i=1;for(;i<e;)if(s[i]<i){const o=i%2&&s[i],c=t[i];t[i]=t[o],t[o]=c,++s[i],i=1,r.push(t.slice())}else s[i]=0,++i;return r}static getSubsetsOfSize(t,e){return function r(s,i){if(i>=t.length||s<1)return[[]];{const o=[];for(;i<=t.length-s;){const c=t[i];for(const u of r(s-1,i+1))u.push(c),o.push(u);++i}return o}}(e,0)}}.getCombinations(s,i.length).map(o=>i.map((c,u)=>new qo(c.capturedSpaces,o[u])))).reduce((i,o)=>i.concat(o),[])}getRingMoves(t){const e=this.ruler,r=[];for(const s of this.getRingCoords(t))for(const i of e.getRingTargets(t,s))r.push({start:s,end:i});return r}getRingCoords(t){const e=t.getCurrentPlayer().value,r=[];return t.forEachCoord((s,i)=>{i===Pt.RINGS[e]&&r.push(s)}),r}}class Ice extends hr{applyLegalMove(t,e,r){return new Ta(r.board,r.sideRings,r.turn+1)}applyCaptures(t,e){let r=e;return t.forEach(s=>{r=this.applyCapture(s,r)}),r}applyCapture(t,e){const r=this.applyCaptureWithoutTakingRing(e,t);return this.takeRing(new Ta(r,e.sideRings,e.turn),t.ringTaken.get())}takeRing(t,e){const r=t.getCurrentPlayer().value,s=t.setAt(e,Pt.EMPTY).board,i=[t.sideRings[0],t.sideRings[1]];return i[r]+=1,new Ta(s,i,t.turn)}applyCaptureWithoutTakingRing(t,e){return e.forEach(r=>{t=t.setAt(r,Pt.EMPTY)}),t.board}ringSelectionValidity(t,e){const r=t.getCurrentPlayer().value;return t.getPieceAt(e)===Pt.RINGS[r]?G.SUCCESS:G.failure(Ar.CAPTURE_SHOULD_TAKE_RING())}applyRingMoveAndFlip(t,e,r){const s=r.getCurrentPlayer().value;let i=r.setAt(t,Pt.MARKERS[s]);i=i.setAt(e,Pt.RINGS[s]);const o=Ie.factory.fromMove(t,e).get();for(let c=t.getNext(o);!1===c.equals(e);c=c.getNext(o)){const u=i.getPieceAt(c);u!==Pt.EMPTY&&(i=i.setAt(c,u.flip()))}return i}isLegal(t,e){if(t.isInitialPlacement())return this.initialPlacementValidity(e,t.start);if(e.isInitialPlacementPhase())return K.failure(Ar.NO_MARKERS_IN_INITIAL_PHASE());const r=this.capturesValidity(e,t.initialCaptures);if(r.isFailure())return r.toFailedFallible();const s=this.applyCaptures(t.initialCaptures,e),i=this.moveValidity(s,t.start,t.end.get());if(i.isFailure())return i.toFailedFallible();const o=this.applyRingMoveAndFlip(t.start,t.end.get(),s),c=this.capturesValidity(o,t.finalCaptures);if(c.isFailure())return c.toFailedFallible();const u=this.applyCaptures(t.finalCaptures,o),h=this.noMoreCapturesValidity(u);return h.isFailure()?h.toFailedFallible():K.success(u)}initialPlacementValidity(t,e){if(!0!==t.isInitialPlacementPhase())return K.failure(Ar.PLACEMENT_AFTER_INITIAL_PHASE());if(t.getPieceAt(e)!==Pt.EMPTY)return K.failure(Mt.MUST_CLICK_ON_EMPTY_SPACE());const r=t.getCurrentPlayer(),s=[t.sideRings[0],t.sideRings[1]];s[r.value]-=1;const i=t.setAt(e,Pt.of(r,!0)).board,o=new Ta(i,s,t.turn);return K.success(o)}moveStartValidity(t,e){const r=t.getCurrentPlayer().value;return t.getPieceAt(e)!==Pt.RINGS[r]?G.failure(Ar.SHOULD_SELECT_PLAYER_RING()):G.SUCCESS}moveValidity(t,e,r){const s=this.moveStartValidity(t,e);if(s.isFailure())return s;if(t.getPieceAt(r)!==Pt.EMPTY)return G.failure(Ar.SHOULD_END_MOVE_ON_EMPTY_SPACE());const i=Ie.factory.fromMove(e,r);if(i.isFailure())return G.failure(Ar.MOVE_DIRECTION_INVALID());const o=i.get();let c=!1;for(let u=e.getNext(o);!1===u.equals(r);u=u.getNext(o)){const h=t.getPieceAt(u);if(h===Pt.EMPTY){if(c)return G.failure(Ar.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(h.isRing)return G.failure(Ar.MOVE_SHOULD_NOT_PASS_ABOVE_RING());c=!0}}return G.SUCCESS}capturesValidity(t,e){let r=t;for(const s of e){const i=this.captureValidity(r,s);if(i.isFailure())return i;r=this.applyCapture(s,r)}return G.SUCCESS}captureValidity(t,e){const r=t.getCurrentPlayer().value;for(const s of e.capturedSpaces)if(t.getPieceAt(s)!==Pt.MARKERS[r])return G.failure(Ar.CAN_ONLY_CAPTURE_YOUR_MARKERS());return t.getPieceAt(e.ringTaken.get())!==Pt.RINGS[r]?G.failure(Ar.CAPTURE_SHOULD_TAKE_RING()):G.SUCCESS}noMoreCapturesValidity(t){const e=t.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e).length?G.SUCCESS:G.failure(Ar.MISSING_CAPTURES())}getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e){const r=[];return t.allLines().forEach(s=>{const i=this.getLinePortionWithAtLeastFivePiecesOfPlayer(t,e,s);i.isPresent()&&r.push(i.get())}),r}getLinePortionWithAtLeastFivePiecesOfPlayer(t,e,r){let s=0;const i=t.getEntranceOnLine(r),o=r.getDirection();let u,c=i;for(u=i;t.isOnBoard(u);u=u.getNext(o)){const h=t.getPieceAt(u);if(h.player===e&&!1===h.isRing)0===s&&(c=u),s+=1;else{if(s>=5)break;s=0}}return s>=5?S.of({start:c,end:u,dir:o}):S.empty()}getPossibleCaptures(t){const e=t.getCurrentPlayer(),r=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e).forEach(s=>{for(let i=s.start;i.getDistance(s.end)>=5;i=i.getNext(s.dir))r.push(qo.of(i,i.getNext(s.dir,4)))}),r}getRingTargets(t,e){const r=[];for(const s of Ie.factory.all){let i=!1;for(let o=e.getNext(s);t.isOnBoard(o);o=o.getNext(s)){const c=t.getPieceAt(o);if(c===Pt.EMPTY){if(r.push(o),i)break}else{if(c.isRing)break;i=!0}}}return r}getGameStatus(t){return t.gameState.isInitialPlacementPhase()?ze.ONGOING:t.gameState.sideRings[0]>=3?ze.ZERO_WON:t.gameState.sideRings[1]>=3?ze.ONE_WON:ze.ONGOING}}const U=Pt.EMPTY,ye=Pt.UNREACHABLE,x2=Pt.MARKER_ZERO,ki=Pt.RING_ZERO,f4=Pt.MARKER_ONE,h2=Pt.RING_ONE;let xce=(()=>{class n{}return n.MUST_ALIGN_FIVE=()=>$localize`Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time.`,n.MUST_CAPTURE_TWO=()=>$localize`Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again.`,n})();class Lce extends Pr{constructor(){super(...arguments),this.tutorial=[pe.informational($localize`Goal of the game`,$localize`The goal at Yinsh is to capture three rings in total.
        The rings taken are shown on the top left for the dark player,
        and on the bottom right for the light player. Here, Dark won the game.
        Note that on the board you have two types of pieces for each player:
        rings (empty circles) and markers (full circles).`,new Ta([[ye,ye,ye,ye,ye,ye,U,U,U,U,ye],[ye,ye,ye,ye,U,U,U,U,U,U,U],[ye,ye,ye,x2,h2,U,U,U,U,U,U],[ye,ye,U,x2,U,h2,U,f4,U,U,U],[ye,U,ki,f4,U,U,h2,x2,U,U,U],[ye,U,U,x2,f4,U,U,U,U,U,ye],[U,U,U,x2,U,U,U,h2,U,U,ye],[U,U,U,f4,x2,ki,U,U,U,ye,ye],[U,U,U,U,U,U,U,U,ye,ye,ye],[U,U,U,U,U,U,U,ye,ye,ye,ye],[ye,U,U,U,U,ye,ye,ye,ye,ye,ye]],[3,1],20)),pe.anyMove($localize`Initial board and placement phase`,$localize`The initial board is empty.
        At the beginning of the game, each player puts one of its ring on the board at their turn.
        This phase stops when all rings have been placed on the board.
        Put one of your ring on the board by clicking the space where you want to place it.`,new Ta(Ta.getInitialState().board,[5,5],0),new wa([],new P(5,5),S.empty(),[]),$localize`Congratulations!`),pe.anyMove($localize`Putting a marker`,$localize`Once the initial phase is done and all rings are on the board, you need to place markers on the board.
        To do so, put a marker in a ring by clicking on that ring.
        Then, the ring must be moved in a straight line, in any direction.
        A ring cannot pass through other rings during its move.
        If it goes over a group of markers, your move must stop at the first empty space after that group.
        All markers in the group are then flipped and their color change.<br/><br/>
        You're playing Dark, do a move.`,new Ta([[ye,ye,ye,ye,ye,ye,U,U,U,U,ye],[ye,ye,ye,ye,U,U,U,U,U,U,U],[ye,ye,ye,h2,U,U,U,U,U,U,U],[ye,ye,h2,U,U,h2,U,U,U,U,U],[ye,U,ki,f4,U,U,h2,U,U,U,U],[ye,U,U,f4,U,U,U,U,U,U,ye],[U,U,U,U,ki,U,U,h2,U,U,ye],[U,U,U,U,U,ki,U,U,U,ye,ye],[U,U,U,ki,U,U,U,ye,ye,ye,ye],[U,U,U,U,U,U,U,ye,ye,ye,ye],[ye,U,U,U,U,ye,ye,ye,ye,ye,ye]],[0,0],20),new wa([],new P(2,4),S.of(new P(4,4)),[]),$localize`Congratulations!`),pe.fromPredicate($localize`Getting a ring by aligning 5 markers`,$localize`Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.
        To do so, you need to align 5 markers of your color.
        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.
        You will then have one more point.
        You must capture when you can.<br/><br/>
        You're playing Dark, perform a capture!`,new Ta([[ye,ye,ye,ye,ye,ye,U,U,U,U,ye],[ye,ye,ye,ye,U,U,U,U,U,U,U],[ye,ye,ye,h2,U,U,U,U,U,U,U],[ye,ye,h2,U,U,h2,U,U,U,U,U],[ye,U,x2,x2,ki,f4,f4,U,U,U,U],[ye,U,U,h2,U,U,U,U,U,U,ye],[U,U,U,U,ki,U,U,h2,U,U,ye],[U,U,U,U,U,ki,U,U,U,ye,ye],[U,U,U,ki,U,U,U,ki,ye,ye,ye],[U,U,U,U,U,U,U,ye,ye,ye,ye],[ye,U,U,U,U,ye,ye,ye,ye,ye,ye]],[0,0],20),new wa([],new P(4,4),S.of(new P(7,4)),[qo.of(new P(2,4),new P(6,4),new P(7,4))]),(t,e,r)=>1===r.sideRings[F.ZERO.value]?G.SUCCESS:G.failure(xce.MUST_ALIGN_FIVE()),$localize`Congratulations!`),pe.fromPredicate($localize`Compound captures`,$localize`During a turn, you could have to choose between multiple captures,
        or you could even capture multiple times!
        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>
        Here, you can capture two rings, do it!`,new Ta([[ye,ye,ye,ye,ye,ye,U,U,U,U,ye],[ye,ye,ye,ye,ki,U,U,h2,h2,ki,U],[ye,ye,ye,ki,U,U,f4,h2,U,ki,U],[ye,ye,U,ki,U,U,U,U,U,h2,U],[ye,U,U,U,U,x2,U,U,h2,U,U],[ye,U,U,U,x2,x2,U,f4,U,U,ye],[U,U,U,x2,U,x2,U,U,U,U,ye],[U,U,x2,U,U,x2,U,U,U,ye,ye],[U,x2,U,U,U,x2,U,U,ye,ye,ye],[U,U,U,U,U,x2,U,ye,ye,ye,ye],[ye,U,U,U,U,ye,ye,ye,ye,ye,ye]],[0,0],10),new wa([qo.of(new P(5,4),new P(1,8),new P(3,2)),qo.of(new P(5,9),new P(5,5),new P(3,3))],new P(4,1),S.of(new P(4,2)),[]),(t,e,r)=>2===r.sideRings[F.ZERO.value]?G.SUCCESS:G.failure(xce.MUST_CAPTURE_TWO()),$localize`Congratulations!`)]}}function Out(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=E(2).$implicit,r=E(2);V("cx",e.center.x)("cy",e.center.y)("r",r.viewInfo.ringOuterSize)}}function Iut(n,t){if(1&n&&(B(),X(0,"circle",13)),2&n){const e=E(2),r=e.index,s=e.$implicit,i=E().index,o=E();je("id","ring_",r,"_",i,""),w("ngClass",s.ringClasses),V("cx",s.center.x)("cy",s.center.y)("r",o.viewInfo.ringMidSize)}}function xut(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=E(2).$implicit,r=E(2);V("cx",e.center.x)("cy",e.center.y)("r",r.viewInfo.ringInnerSize)}}function Lut(n,t){if(1&n&&(B(),X(0,"circle",14)),2&n){const e=E(2),r=e.index,s=e.$implicit,i=E().index,o=E();je("id","marker_",r,"_",i,""),w("ngClass",s.markerClasses),V("cx",s.center.x)("cy",s.center.y)("r",o.viewInfo.markerSize)}}function kut(n,t){if(1&n){const e=we();B(),N(0,"g",6),se("click",function(){he(e);const s=E().$implicit;return ce(E(2).onClick(s.coord))}),X(1,"polygon",7),N(2,"g",8),k(3,Out,1,3,"circle",9),k(4,Iut,1,6,"circle",10),k(5,xut,1,3,"circle",9),k(6,Lut,1,6,"circle",11),A()()}if(2&n){const e=E(),r=e.index,s=e.$implicit,i=E().index;je("id","click_",r,"_",i,""),M(1),je("id","space_",r,"_",i,""),w("ngClass",s.spaceClasses),V("points",s.coordinates),M(1),je("id","pieceGroup_",r,"_",i,""),w("ngClass",s.removedClass),M(1),w("ngIf",s.isRing),M(1),w("ngIf",s.isRing),M(1),w("ngIf",s.isRing),M(1),w("ngIf",s.isMarker)}}function Rut(n,t){if(1&n&&(B(),N(0,"g"),k(1,kut,7,13,"g",5),A()),2&n){const e=t.$implicit;M(1),w("ngIf",null!=e)}}function Dut(n,t){if(1&n&&(B(),N(0,"g"),k(1,Rut,2,1,"g",1),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}function zut(n,t){if(1&n){const e=we();B(),N(0,"polygon",15),se("click",function(){const i=he(e).$implicit;return ce(E().onClick(i))}),A()}if(2&n){const e=t.$implicit,r=E();je("id","selected_",e.x,"_",e.y,""),V("points",r.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function Vut(n,t){if(1&n){const e=we();B(),N(0,"polygon",17),se("click",function(){const i=he(e).$implicit;return ce(E(2).onClick(i))}),A()}if(2&n){const e=t.$implicit,r=E(2);je("id","selectable_",e.x,"_",e.y,""),V("points",r.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function Hut(n,t){if(1&n&&(B(),N(0,"g"),k(1,Vut,1,3,"polygon",16),A()),2&n){const e=E();M(1),w("ngForOf",e.viewInfo.selectableCoords)}}function Fut(n,t){if(1&n){const e=we();B(),N(0,"rect",18),se("click",function(){const i=he(e).$implicit;return ce(E().onClick(i))}),A()}if(2&n){const e=t.$implicit,r=E();je("id","indicator_",e.x,"_",e.y,""),V("x",r.viewInfo.spaceInfo[e.y][e.x].center.x-r.viewInfo.indicatorSize/2)("y",r.viewInfo.spaceInfo[e.y][e.x].center.y-r.viewInfo.indicatorSize/2)("width",r.viewInfo.indicatorSize)("height",r.viewInfo.indicatorSize)}}function But(n,t){if(1&n&&(B(),N(0,"g"),X(1,"circle",19)(2,"circle",12)(3,"circle",20),A()),2&n){const e=t.index,r=E().$implicit,s=E();M(1),je("id","player_",r.value,"_sideRing_",e+1,""),V("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringOuterSize),M(1),V("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringInnerSize),M(1),w("ngClass",s.viewInfo.sideRingClass[r.value]),V("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringMidSize)}}const $ut=function(){return[]};function Uut(n,t){if(1&n&&(B(),N(0,"g"),k(1,But,4,12,"g",1),A()),2&n){const e=t.$implicit,r=E();V("transform","rotate("+180*(r.role.value+1)+" 532.5 780)"),M(1),w("ngForOf",ar(2,$ut).constructor(r.viewInfo.sideRings[e.value]))}}class d2 extends Zg{constructor(t){super(t),this.movePhase="MOVE_START",this.moveStart=S.empty(),this.moveEnd=S.empty(),this.currentlyMoved=[],this.currentCapture=S.empty(),this.initialCaptures=[],this.finalCaptures=[],this.possibleCaptures=[],this.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:d2.MARKER_SIZE,ringOuterSize:d2.RING_OUTER_SIZE,ringMidSize:d2.RING_MID_SIZE,ringInnerSize:d2.RING_INNER_SIZE,indicatorSize:d2.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},this.scores=S.of([0,0]),this.rules=new Ice(Ta),this.availableMinimaxes=[new Aut(this.rules,"YinshMinimax")],this.encoder=wa.encoder,this.tutorial=(new Lce).tutorial,this.hexaLayout=new Yg(1.5*d2.RING_OUTER_SIZE,new P(2*d2.RING_OUTER_SIZE,0),o2.INSTANCE),this.constructedState=this.getState(),this.constructedState.allCoords().forEach(e=>{null==this.viewInfo.spaceInfo[e.y]&&(this.viewInfo.spaceInfo[e.y]=[]),this.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:this.getHexaCoordsAt(e),center:this.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}})}updateBoard(){this.cancelMoveAttempt();const t=this.getState();this.scores=S.of(t.countScores())}updateViewInfo(){this.constructedState.allCoords().forEach(t=>{this.viewInfo.spaceInfo[t.y][t.x].spaceClasses=this.getSpaceClasses(t);const e=this.constructedState.getPieceAt(t);this.viewInfo.spaceInfo[t.y][t.x].removedClass="",this.setRingInfo(t,e),this.setMarkerInfo(t,e)});for(const t of F.PLAYERS)this.viewInfo.sideRings[t.value]=this.constructedState.sideRings[t.value];switch(this.showCurrentMoveCaptures(),this.showLastMove(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];for(const t of this.possibleCaptures)for(const e of t.capturedSpaces)this.viewInfo.selectableCoords.push(e);break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.getState().isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}showCurrentMoveCaptures(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());for(const t of this.initialCaptures)this.markCurrentCapture(t);for(const t of this.finalCaptures)this.markCurrentCapture(t)}getSpaceClasses(t){return this.currentlyMoved.some(e=>e.equals(t))?["moved-fill"]:[]}setRingInfo(t,e){e.isRing?(this.viewInfo.spaceInfo[t.y][t.x].isRing=!0,this.viewInfo.spaceInfo[t.y][t.x].ringClasses=["player"+e.player.value+"-stroke"]):(this.viewInfo.spaceInfo[t.y][t.x].isRing=!1,this.viewInfo.spaceInfo[t.y][t.x].ringClasses=[])}setMarkerInfo(t,e){if(this.viewInfo.spaceInfo[t.y][t.x].isMarker=!1,this.viewInfo.spaceInfo[t.y][t.x].markerClasses=[],e!==Pt.EMPTY&&(!e.isRing||this.moveStart.equalsValue(t))){const s=this.getPlayerClass(e.player);this.viewInfo.spaceInfo[t.y][t.x].isMarker=!0,this.viewInfo.spaceInfo[t.y][t.x].markerClasses=[s]}}cancelMoveAttempt(){this.constructedState=this.getState(),this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=S.empty(),this.moveStart=S.empty(),this.moveEnd=S.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}showLastMove(){const t=this.rules.node.move;if(t.isPresent()){const e=t.get();if(e.isInitialPlacement())this.viewInfo.spaceInfo[e.start.y][e.start.x].spaceClasses=["moved-fill"];else{for(const s of this.coordsBetween(e.start,e.end.get()))this.viewInfo.spaceInfo[s.y][s.x].spaceClasses=["moved-fill"];const r=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();e.initialCaptures.forEach(s=>this.showLastMoveCapture(s,r)),e.finalCaptures.forEach(s=>this.showLastMoveCapture(s,r))}}}coordsBetween(t,e){const r=[],s=Ie.factory.fromMove(t,e).get();for(let i=t;!i.equals(e);i=i.getNext(s))this.constructedState.getPieceAt(i)!==Pt.EMPTY&&r.push(i),r.push(e);return r}showLastMoveCapture(t,e){for(const r of t.capturedSpaces)this.viewInfo.spaceInfo[r.y][r.x].spaceClasses=["captured-fill"],e&&this.markRemovedMarker(r,this.getState().getCurrentPlayer().getOpponent());this.viewInfo.spaceInfo[t.ringTaken.get().y][t.ringTaken.get().x].spaceClasses=["captured-fill"],e&&this.markRemovedRing(t.ringTaken.get(),this.getState().getCurrentPlayer().getOpponent())}moveToInitialCaptureOrMovePhase(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),G.SUCCESS}onClick(t){var e=this;return O(function*(){const r=e.canUserPlay("#click_"+t.x+"_"+t.y);if(r.isFailure())return e.cancelMove(r.getReason());switch(e.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_FIRST":return e.selectCaptureFirstCoord(t);case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_LAST":return e.selectCaptureLastCoord(t);case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":return e.selectRing(t);case"MOVE_START":return e.selectMoveStart(t);case"MOVE_END":return e.selectMoveEnd(t)}})()}selectCaptureFirstCoord(t){var e=this;return O(function*(){const r=[];if(e.possibleCaptures.forEach(s=>{s.contains(t)&&r.push(s)}),r.length>1)e.viewInfo.selectedCoords.push(t),e.moveToCaptureSelectLast(r);else{if(0===r.length)return e.cancelMove(Ar.MISSING_CAPTURES());e.selectCapture(r[0])}return G.SUCCESS})()}moveToCaptureSelectLast(t){this.viewInfo.selectableCoords=[],this.possibleCaptures=t;for(const e of t)for(const r of e.capturedSpaces)this.viewInfo.selectableCoords.push(r);"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(Ae.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}selectCaptureLastCoord(t){var e=this;return O(function*(){const r=[];return e.possibleCaptures.forEach(s=>{s.contains(t)&&r.push(s)}),r.length>1?e.cancelMove(Ar.AMBIGUOUS_CAPTURE_COORD()):0===r.length?e.cancelMove(Ar.MISSING_CAPTURES()):e.selectCapture(r[0])})()}selectCapture(t){return this.currentCapture=S.of(t),this.constructedState=new Ta(this.rules.applyCaptureWithoutTakingRing(this.constructedState,t),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(Se("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),G.SUCCESS}markCurrentCapture(t){for(const e of t.capturedSpaces)this.viewInfo.selectedCoords.push(e),this.markRemovedMarker(e,this.getState().getCurrentPlayer());t.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(t.ringTaken.get()),this.markRemovedRing(t.ringTaken.get(),this.getState().getCurrentPlayer()))}markRemovedMarker(t,e){this.viewInfo.spaceInfo[t.y][t.x].removedClass="semi-transparent",this.setMarkerInfo(t,Pt.MARKERS[e.value])}markRemovedRing(t,e){this.viewInfo.spaceInfo[t.y][t.x].removedClass="semi-transparent",this.setRingInfo(t,Pt.RINGS[e.value])}selectRing(t){var e=this;return O(function*(){const r=e.rules.ringSelectionValidity(e.constructedState,t);if(r.isFailure())return e.cancelMove(r.getReason());e.constructedState=e.rules.takeRing(e.constructedState,t);const s=e.currentCapture.get().setRingTaken(t);return"INITIAL_CAPTURE_SELECT_RING"===(e.currentCapture=S.empty(),e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),e.movePhase)?(e.initialCaptures.push(s),0===e.possibleCaptures.length?e.moveToMovePhase():(e.movePhase="INITIAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),G.SUCCESS)):(Ae.expectToBe(e.movePhase,"FINAL_CAPTURE_SELECT_RING"),e.finalCaptures.push(s),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),G.SUCCESS))})()}moveToMovePhase(){return this.movePhase="MOVE_START",this.updateViewInfo(),G.SUCCESS}tryMove(){var t=this;return O(function*(){const e=new wa(t.initialCaptures,t.moveStart.get(),t.moveEnd,t.finalCaptures);return yield t.chooseMove(e,t.getState(),t.scores.get())})()}selectMoveStart(t){var e=this;return O(function*(){if(e.constructedState.isInitialPlacementPhase()){const r=e.rules.initialPlacementValidity(e.constructedState,t);return r.isFailure()?e.cancelMove(r.getReason()):(e.moveStart=S.of(t),e.tryMove())}{const r=e.rules.moveStartValidity(e.constructedState,t);if(r.isFailure())return e.cancelMove(r.getReason());e.moveStart=S.of(t),e.movePhase="MOVE_END",e.updateViewInfo()}return G.SUCCESS})()}selectMoveEnd(t){var e=this;return O(function*(){if(e.moveStart.equalsValue(t))return e.cancelMoveAttempt(),G.SUCCESS;const r=Pt.RINGS[e.getState().getCurrentPlayer().value];if(e.constructedState.getPieceAt(t)===r)return e.cancelMoveAttempt(),e.selectMoveStart(t);const s=e.rules.moveValidity(e.constructedState,e.moveStart.get(),t);return s.isFailure()?e.cancelMove(s.getReason()):(e.moveEnd=S.of(t),e.currentlyMoved=e.coordsBetween(e.moveStart.get(),t),e.constructedState=e.rules.applyRingMoveAndFlip(e.moveStart.get(),t,e.constructedState),e.updateViewInfo(),e.moveToFinalCapturePhaseOrTryMove())})()}moveToFinalCapturePhaseOrTryMove(){var t=this;return O(function*(){return t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),G.SUCCESS)})()}}function Gut(n,t){if(1&n&&(N(0,"option",5),Et(1),A()),2&n){const e=t.$implicit;w("value",e.urlName),M(1),jn(e.name)}}d2.RING_OUTER_SIZE=40,d2.RING_MID_SIZE=34,d2.RING_INNER_SIZE=28,d2.MARKER_SIZE=d2.RING_INNER_SIZE,d2.INDICATOR_SIZE=10,d2.\u0275fac=function(t){return new(t||d2)(Q(In))},d2.\u0275cmp=vt({type:d2,selectors:[["app-yinsh"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected-stroke",3,"id","click"],["class","base no-fill capturable-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable-stroke",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(t,e){1&t&&(B(),N(0,"svg",0),k(1,Dut,2,1,"g",1),k(2,zut,1,3,"polygon",2),k(3,Hut,2,1,"g",3),k(4,Fut,1,6,"rect",4),k(5,Uut,2,3,"g",1),A()),2&t&&(M(1),w("ngForOf",e.viewInfo.spaceInfo),M(1),w("ngForOf",e.viewInfo.selectedCoords),M(1),w("ngIf",e.isPlayerTurn()),M(1),w("ngForOf",e.viewInfo.targets),M(1),w("ngForOf",e.Player.PLAYERS))},dependencies:[On,Fn,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let J1=(()=>{class n{}return n.ABALONE=()=>$localize`Use simple mechanics to push 6 of the opponent's pieces out of the board!`,n.APAGOS=()=>$localize`Very simple game, but, will you be able to win everytime?`,n.AWALE=()=>$localize`The international version of the famous African strategy game!`,n.BRANDHUB=()=>$localize`The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!`,n.COERCEO=()=>$localize`Get rid of all of your opponent's pieces on a board that shrinks little by little!`,n.CONSPIRATEURS=()=>$localize`Hide all of your pieces before your opponent does, or risk to be discovered!`,n.DIAM=()=>$localize`Drop your pieces and move them around to align two pieces of the same color across the board to win!`,n.DVONN=()=>$localize`Stack your pieces and control as many stacks as you can to win!`,n.ENCAPSULE=()=>$localize`An enhanced tic-tac-toe where piece can encapsule other and prevent them to win.`,n.EPAMINONDAS=()=>$localize`An antiquity-war inspired game. Be the first to pierce your opponent's lines!`,n.GIPF=()=>$localize`A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!`,n.GO=()=>$localize`The oldest strategy game still practiced widely. A territory control game.`,n.HNEFATAFL=()=>$localize`The Viking board game! Invaders must capture the king, defender must make him escape!`,n.KAMISADO=()=>$localize`Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!`,n.LINES_OF_ACTION=()=>$localize`Regroup your pieces to win. But your possible moves will often change!`,n.LODESTONE=()=>$localize`Push and crush your opponent's pieces using magnetic forces!`,n.MARTIAN_CHESS=()=>$localize`Win points by capturing pieces, but you only control pieces on your side of the board!`,n.P4=()=>$localize`The classical 4 in a row game!`,n.PENTAGO=()=>$localize`Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!`,n.PYLOS=()=>$localize`Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!`,n.QUARTO=()=>$localize`Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!`,n.QUIXO=()=>$localize`Align 5 of your pieces on a board where pieces slide!`,n.REVERSI=()=>$localize`Sandwich your opponent's pieces to dominate the board!`,n.SAHARA=()=>$localize`Immobilize one of your opponent's pyramids before your opponent does!`,n.SIAM=()=>$localize`Be the first to push a mountain out of the board!`,n.SIX=()=>$localize`Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!`,n.TABLUT=()=>$localize`Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!`,n.YINSH=()=>$localize`Align your pieces to score points, but beware, pieces can flip!`,n})(),Qf=(()=>{class n{constructor(e,r,s,i,o,c,u,h=!0){this.name=e,this.urlName=r,this.component=s,this.tutorial=i,this.rules=o,this.creationDate=c,this.description=u,this.display=h}}return n.ALL_GAMES=()=>[new n($localize`Four in a Row`,"P4",h6t,new lce,new F8(Nl),new Date("2018-08-28"),J1.P4()),new n($localize`Awal`,"Awale",Xct,new Lae,new r4(Ni),new Date("2018-11-29"),J1.AWALE()),new n($localize`Quarto`,"Quarto",h0t,new yce,new Bs(uc),new Date("2018-12-09"),J1.QUARTO()),new n($localize`Tablut`,"Tablut",but,new Oce,B8.get(),new Date("2018-12-27"),J1.TABLUT()),new n($localize`Reversi`,"Reversi",T0t,new Sce,new lm(V1),new Date("2019-01-16"),J1.REVERSI()),new n($localize`Go`,"Go",Y4t,new ece,new r3(Ss),new Date("2019-12-21"),J1.GO()),new n($localize`Encapsule`,"Encapsule",v4t,new jae,new rc(wl),new Date("2019-12-30"),J1.ENCAPSULE()),new n($localize`Siam`,"Siam",nut,new Nce,E1.get(),new Date("2020-01-11"),J1.SIAM()),new n($localize`Sahara`,"Sahara",V0t,new Pce,new jf(f2),new Date("2020-02-29"),J1.SAHARA()),new n($localize`Pylos`,"Pylos",R6t,new mce,new ho(lc),new Date("2020-10-02"),J1.PYLOS()),new n($localize`Kamisado`,"Kamisado",mlt,new nce,new lo(i3),new Date("2020-10-03"),J1.KAMISADO()),new n($localize`Quixo`,"Quixo",y0t,new Ece,new po(w0),new Date("2020-10-15"),J1.QUIXO()),new n($localize`Dvonn`,"Dvonn",o4t,new Gae,new c2(Ea),new Date("2020-10-21"),J1.DVONN()),new n($localize`Epaminondas`,"Epaminondas",T4t,new Zae,new M0(n3),new Date("2021-01-16"),J1.EPAMINONDAS()),new n($localize`Gipf`,"Gipf",R4t,new Xae,new Dn(Sa),new Date("2021-02-22"),J1.GIPF()),new n($localize`Coerceo`,"Coerceo",w3t,new Vae,new AS(y1),new Date("2021-03-21"),J1.COERCEO()),new n($localize`Six`,"Six",put,new Ace,new f3(Nr),new Date("2021-04-08"),J1.SIX()),new n($localize`Lines of Action`,"LinesOfAction",Mlt,new rce,new Oi(as),new Date("2021-04-28"),J1.LINES_OF_ACTION()),new n($localize`Pentago`,"Pentago",E6t,new fce,new o3(O2),new Date("2021-05-23"),J1.PENTAGO()),new n($localize`Abalone`,"Abalone",Vct,new Iae,new Kc(Pl),new Date("2021-07-13"),J1.ABALONE()),new n($localize`Yinsh`,"Yinsh",d2,new Lce,new Ice(Ta),new Date("2021-07-31"),J1.YINSH()),new n($localize`Apagos`,"Apagos",qct,new xae,n4.get(),new Date("2021-11-04"),J1.APAGOS()),new n($localize`Diam`,"Diam",t3,new Bae,e3.get(),new Date("2021-11-30"),J1.DIAM()),new n($localize`Brandhub`,"Brandhub",f3t,new Rae,R8.get(),new Date("2021-12-07"),J1.BRANDHUB()),new n($localize`Conspirateurs`,"Conspirateurs",z3t,new Hae,Ca.get(),new Date("2021-12-30"),J1.CONSPIRATEURS()),new n($localize`Lodestone`,"Lodestone",fi,new sce,ui.get(),new Date("2022-06-24"),J1.LODESTONE()),new n($localize`Martian Chess`,"MartianChess",fo,new cce,new Uf(Ps),new Date("2022-07-01"),J1.MARTIAN_CHESS()),new n($localize`Hnefatafl`,"Hnefatafl",clt,new tce,V8.get(),new Date("2022-09-21"),J1.HNEFATAFL())].sort((t,e)=>t.name.localeCompare(e.name)),n})(),HV=(()=>{class n{constructor(){this.games=Qf.ALL_GAMES(),this.pickGame=new cr}onChange(e){this.pickGame.emit(e.target.value)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=vt({type:n,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){let t;return t=$localize`Pick a game`,[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],t,[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,r){1&e&&(N(0,"div",0)(1,"select",1),se("change",function(i){return r.onChange(i)}),N(2,"option",2),de(3,3),A(),k(4,Gut,2,2,"option",4),A()()),2&e&&(M(4),w("ngForOf",r.games))},dependencies:[Fn,D9,z9],encapsulation:2}),n})();function Wut(n,t){if(1&n){const e=we();N(0,"div",26)(1,"div",27),se("click",function(){return he(e),ce(E().closeInfo())}),A(),N(2,"div",28)(3,"header",29)(4,"p",30),Et(5),A(),N(6,"button",31),se("click",function(){return he(e),ce(E().closeInfo())}),A()(),N(7,"section",32)(8,"div",6)(9,"div",33)(10,"p",34),X(11,"img",35),A()(),N(12,"div",7)(13,"div",13),Et(14),A()()(),N(15,"div",6)(16,"div",33)(17,"a",36),se("click",function(){he(e);const s=E();return ce(s.createGame(s.gameInfoDetails.get().urlName))}),X(18,"fa-icon",37),Et(19,"\xa0"),N(20,"span"),de(21,38),A()()(),N(22,"div",33)(23,"a",36),se("click",function(){he(e);const s=E();return ce(s.createLocalGame(s.gameInfoDetails.get().urlName))}),X(24,"fa-icon",37),Et(25,"\xa0"),N(26,"span"),de(27,39),A()()(),N(28,"div",33)(29,"a",36),se("click",function(){he(e);const s=E();return ce(s.createTutorial(s.gameInfoDetails.get().urlName))}),X(30,"fa-icon",37),Et(31,"\xa0"),N(32,"span"),de(33,40),A()()()()()()()}if(2&n){const e=E();M(5),jn(e.gameInfoDetails.get().name),M(6),je("src","assets/images/",e.theme,"/",e.gameInfoDetails.get().urlName,".png",Ic),M(3),Ei(" ",e.gameInfoDetails.get().description," "),M(4),w("icon",e.iconOnlineGame),M(6),w("icon",e.iconLocalGame),M(6),w("icon",e.iconTutorial)}}function qut(n,t){if(1&n){const e=we();N(0,"div",8)(1,"div",9)(2,"p",10),Et(3),A()(),N(4,"div",42)(5,"figure",34)(6,"img",43),se("click",function(){const i=he(e).$implicit;return ce(E(2).openInfo(i))}),A(),N(7,"figcaption",44),se("click",function(){const i=he(e).$implicit;return ce(E(2).openInfo(i))}),N(8,"div",45),Et(9,"?"),A()(),N(10,"figcaption",46)(11,"a",47),se("click",function(){const i=he(e).$implicit;return ce(E(2).createGame(i.urlName))}),X(12,"fa-icon",37),A(),N(13,"a",48),se("click",function(){const i=he(e).$implicit;return ce(E(2).createLocalGame(i.urlName))}),X(14,"fa-icon",37),A(),N(15,"a",49),se("click",function(){const i=he(e).$implicit;return ce(E(2).createTutorial(i.urlName))}),X(16,"fa-icon",37),A()()()(),N(17,"div",50),Et(18),A()()}if(2&n){const e=t.$implicit,r=E(2);M(3),jn(e.name),M(3),L1("id","image_",e.urlName,""),je("src","assets/images/",r.theme,"/",e.urlName,".png",Ic),M(5),L1("id","playOnline_",e.urlName,""),M(1),w("icon",r.iconOnlineGame),M(1),L1("id","playLocally_",e.urlName,""),M(1),w("icon",r.iconLocalGame),M(1),L1("id","startTutorial_",e.urlName,""),M(1),w("icon",r.iconTutorial),M(2),Ei(" ",e.description," ")}}function jut(n,t){if(1&n&&(N(0,"div",7),k(1,qut,19,11,"div",41),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}let Zut=(()=>{class n{constructor(e,r,s,i){this.router=e,this.messageDisplayer=r,this.observedPartService=s,this.numberOfColumns=5,this.games=[],this.iconOnlineGame=X2e,this.iconLocalGame=uV,this.iconTutorial=Joe,this.gameInfoDetails=S.empty(),this.theme=i.getTheme();const o=Qf.ALL_GAMES();let c=0;for(let u=0;u<o.length;u++)u<this.numberOfColumns&&this.games.push([]),this.games[c].push(o[u]),c=(c+1)%this.numberOfColumns}createGame(e){var r=this;return O(function*(){const s=r.observedPartService.canUserCreate();return s.isSuccess()?r.router.navigate(null==e?["/play"]:["/play",e]):(r.messageDisplayer.criticalMessage(s.getReason()),!1)})()}createLocalGame(e){var r=this;return O(function*(){return r.router.navigate(["/local",e])})()}createTutorial(e){return this.router.navigate(["/tutorial",e])}openInfo(e){this.gameInfoDetails=S.of(e)}closeInfo(){this.gameInfoDetails=S.empty()}}return n.\u0275fac=function(e){return new(e||n)(Q($n),Q(In),Q(li),Q(HM))},n.\u0275cmp=vt({type:n,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,v,T,I;return t=$localize`EveryBoard`,e=$localize`EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn.`,r=$localize`Play online`,s=$localize`Create an online game`,i=$localize`See the game list`,o=$localize`Play offline`,c=$localize`Play`,u=$localize`Learn`,h=$localize`Play online`,g=$localize`Play offline`,m=$localize`Learn the rules`,v=$localize`Play online`,T=$localize`Play offline`,I=$localize`Learn the rules`,[[1,"hero"],[1,"hero-body"],[1,"title"],t,[1,"subtitle"],e,[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],r,[1,"card-content"],[1,"content"],["id","createOnlineGame",1,"button","is-medium","is-fullwidth","is-primary","mb-1",3,"click"],s,["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],i,o,[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],c,["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],u,["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],h,g,m,["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",v,1,"button",3,"id","click"],["data-tooltip",T,1,"button",3,"id","click"],["data-tooltip",I,1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,r){1&e&&(N(0,"section",0)(1,"div",1)(2,"p",2),de(3,3),A(),N(4,"p",4),$a(5,5),X(6,"br"),Ua(),A()(),N(7,"div",6)(8,"div",7)(9,"div",8)(10,"header",9)(11,"p",10),de(12,11),A()(),N(13,"div",12)(14,"div",13)(15,"button",14),se("click",function(){return r.createGame()}),de(16,15),A(),N(17,"button",16),de(18,17),A()()()()(),N(19,"div",7)(20,"div",8)(21,"header",9)(22,"p",10),de(23,18),A()(),N(24,"div",12)(25,"div",19)(26,"button",20),de(27,21),A(),N(28,"button",22),de(29,23),A()()()()()(),k(30,Wut,34,7,"div",24),N(31,"div",6),k(32,jut,2,1,"div",25),A()()),2&e&&(M(30),w("ngIf",r.gameInfoDetails.isPresent()),M(2),w("ngForOf",r.games))},dependencies:[Fn,hn,ep,If],encapsulation:2}),n})();const Yut=["board"];let Jf=(()=>{class n{static NO_MATCHING_GAME(e){return $localize`This game (${e}) does not exist.`}}return n.NOT_YOUR_TURN=()=>$localize`It is not your turn!`,n.NO_CLONING_FEATURE=()=>$localize`You cannot clone a game. This feature might be implemented later.`,n})(),JS=(()=>{class n{constructor(e,r,s,i,o){this.componentFactoryResolver=e,this.actRoute=r,this.connectedUserService=s,this.router=i,this.messageDisplayer=o,this.boardRef=null,this.players=[S.empty(),S.empty()],this.role=fe.NONE,this.endGame=!1,this.Player=F,Y(n.VERBOSE,"GameWrapper.constructed: "+(null!=this.boardRef))}getMatchingComponent(e){return Y(n.VERBOSE,"GameWrapper.getMatchingComponent"),S.ofNullable(Qf.ALL_GAMES().find(s=>s.urlName===e)).map(s=>s.component)}afterViewInit(){var e=this;return O(function*(){Y(n.VERBOSE,"GameWrapper.afterViewInit");const r=yield e.createGameComponent();return r&&(e.gameComponent.rules.setInitialBoard(),e.gameComponent.updateBoard()),r})()}getGameName(){return Ae.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}createGameComponent(){var e=this;return O(function*(){Y(n.VERBOSE,{m:"GameWrapper.createGameComponent",that:e});const r=e.getGameName(),s=e.getMatchingComponent(r);if(s.isAbsent())return yield e.router.navigate(["/notFound",Jf.NO_MATCHING_GAME(r)],{skipLocationChange:!0}),!1;Se(null!=e.boardRef,"Board element should be present");const i=e.componentFactoryResolver.resolveComponentFactory(s.get()),o=Ae.getNonNullable(e.boardRef).createComponent(i);return e.gameComponent=o.instance,e.gameComponent.chooseMove=(c,u,h)=>e.receiveValidMove(c,u,h),e.gameComponent.canUserPlay=c=>e.onUserClick(c),e.gameComponent.isPlayerTurn=()=>e.isPlayerTurn(),e.gameComponent.cancelMoveOnWrapper=c=>{e.onCancelMove(c)},e.setRole(e.role),e.canPass=e.gameComponent.canPass,!0})()}setRole(e){this.role=e,this.gameComponent.role=this.role,this.gameComponent.hasAsymetricBoard&&(this.gameComponent.rotation="rotate("+180*this.role.value+")")}receiveValidMove(e,r,s){var i=this;return O(function*(){if(Y(n.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:e,state:r,scores:s}}),!i.isPlayerTurn())return G.failure(Jf.NOT_YOUR_TURN());if(i.endGame)return G.failure($localize`The game has ended.`);const c=i.gameComponent.rules.isLegal(e,r);return c.isFailure()?(i.gameComponent.cancelMove(c.getReason()),G.ofFallible(c)):(i.gameComponent.cancelMoveAttempt(),yield i.onLegalUserMove(e,s),Y(n.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),G.SUCCESS)})()}onUserClick(e){if(this.role===fe.NONE){const r=Jf.NO_CLONING_FEATURE();return G.failure(r)}return this.isPlayerTurn()?G.SUCCESS:G.failure(Jf.NOT_YOUR_TURN())}onCancelMove(e){}isPlayerTurn(){if(this.role===fe.NONE||null==this.gameComponent)return!1;const e=this.gameComponent.getTurn(),r=e%2,s=this.getPlayer();return Y(n.VERBOSE,{isPlayerTurn:{turn:e,players:this.players,player:s,observer:this.role,areYouPlayer:this.players[r].isPresent()&&jc(this.players[r].get(),s),isThereAPlayer:this.players[r]}}),!this.players[r].isPresent()||this.players[r].equalsValue(s)}getBoardHighlight(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.getTurn()%2+"-bg"]:[]}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(ra),Q(Qi),Q(Es),Q($n),Q(In))},n.\u0275cmp=vt({type:n,selectors:[["ng-component"]],viewQuery:function(e,r){if(1&e&&V3(Yut,5,la),2&e){let s;Wa(s=qa())&&(r.boardRef=s.first)}},decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();const Kut=["board"];let Xut=(()=>{class n extends JS{constructor(e,r,s,i,o,c){super(e,r,s,i,o),this.cdr=c,this.boardRef=null}getGameName(){return this.demoNodeInfo.name}ngAfterViewInit(){var e=this;return O(function*(){setTimeout(O(function*(){yield e.afterViewInit(),e.gameComponent.rules.node=e.demoNodeInfo.node,e.setRole(e.gameComponent.getCurrentPlayer()),e.gameComponent.updateBoard(),e.cdr.detectChanges(),e.demoNodeInfo.click.isPresent()&&(Ae.getNonNullable(document.querySelector(e.demoNodeInfo.click.get())).dispatchEvent(new Event("click")),e.cdr.detectChanges())}),1)})()}onLegalUserMove(e,r){return O(function*(){})()}getPlayer(){return"no-player"}}return n.\u0275fac=function(e){return new(e||n)(Q(ra),Q(Qi),Q(Es),Q($n),Q(In),Q(Au))},n.\u0275cmp=vt({type:n,selectors:[["app-demo-card"]],viewQuery:function(e,r){if(1&e&&V3(Kut,5,la),2&e){let s;Wa(s=qa())&&(r.boardRef=s.first)}},inputs:{demoNodeInfo:"demoNodeInfo"},features:[l],decls:2,vars:0,consts:[["board",""]],template:function(e,r){1&e&&X(0,"div",null,0)},encapsulation:2}),n})();function Qut(n,t){if(1&n&&(N(0,"div",17)(1,"figure",18),X(2,"app-demo-card",19),A()()),2&n){const e=E().$implicit;M(2),w("demoNodeInfo",e)}}function Jut(n,t){if(1&n&&(N(0,"div",20)(1,"figure",21),X(2,"app-demo-card",19),A()()),2&n){const e=E().$implicit;M(2),w("demoNodeInfo",e)}}function e8t(n,t){if(1&n&&(N(0,"div",12)(1,"div",13)(2,"p",14),Et(3),A()(),k(4,Qut,3,1,"div",15),k(5,Jut,3,1,"ng-template",null,16,l1),A()),2&n){const e=t.$implicit,r=s1(6),s=E(2);M(3),jn(e.name),M(1),w("ngIf",s.squared.value)("ngIfElse",r)}}function t8t(n,t){if(1&n&&(N(0,"div",10),k(1,e8t,7,3,"div",11),A()),2&n){const e=t.$implicit;M(1),w("ngForOf",e)}}let n8t=(()=>{class n{constructor(){this.numberOfColumns=new ua(5),this.squared=new ua(!0),this.columns=[],this.fillColumns(this.numberOfColumns.value),this.numberOfColumns.valueChanges.subscribe(e=>{this.fillColumns(e)})}fillColumns(e){const r=Qf.ALL_GAMES();let s=0,i=0;this.columns=[];for(const o of r){const c=[],u=o.rules,h=o.tutorial.tutorial;for(const g of h)if(g.hasSolution()){const m=g.getSolution();if("string"==typeof m)c.push({node:new fr(g.state),click:S.of(m)});else{const v=m,T=new fr(u.applyLegalMove(v,g.state,u.isLegal(v,g.state).get()),S.of(new fr(g.state)),S.of(v));c.push({node:T,click:S.empty()})}}for(const g of c)i<e&&this.columns.push([]),this.columns[s].push({name:o.urlName,node:g.node,click:g.click}),i++,s=(s+1)%e}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=vt({type:n,selectors:[["app-demo-page"]],decls:17,vars:4,consts:function(){let t,e;return t=$localize`Number of columns: `,e=$localize`Squared`,[[1,"field"],["for","numberOfColumns",1,"label"],t,[1,"control"],["step","1","min","1","max","10","name","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary",3,"formControl"],[1,"checkbox"],["type","checkbox",3,"formControl"],e,[1,"columns"],["class","column",4,"ngFor","ngForOf"],[1,"column"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"card-header"],[1,"card-header-title"],["class","card-image game-card","style","height: 200px;",4,"ngIf","ngIfElse"],["nonSquared",""],[1,"card-image","game-card",2,"height","200px"],[1,"image",2,"height","100%"],[3,"demoNodeInfo"],[1,"card-image","game-card"],[1,"image"]]},template:function(e,r){1&e&&(N(0,"form")(1,"div",0)(2,"label",1),nn(3),de(4,2),rn(),N(5,"output"),Et(6),A()(),N(7,"div",3),X(8,"input",4),A()(),N(9,"div",0)(10,"label",5),X(11,"input",6),Et(12," \xa0"),nn(13),de(14,7),rn(),A()()(),N(15,"div",8),k(16,t8t,2,1,"div",9),A()),2&e&&(M(6),jn(r.numberOfColumns.value),M(2),w("formControl",r.numberOfColumns),M(3),w("formControl",r.squared),M(5),w("ngForOf",r.columns))},dependencies:[Fn,hn,ku,$3,ZC,oN,Y4,Lu,CN,k9,Xut],encapsulation:2}),n})(),FV=(()=>{class n{constructor(e){this.element=e}ngAfterViewInit(){this.element.nativeElement.focus()}}return n.\u0275fac=function(e){return new(e||n)(Q(j2))},n.\u0275dir=Ht({type:n,selectors:[["","autofocus",""]]}),n})(),kce=(()=>{class n{constructor(e){this.shown=!1,this.input=e.nativeElement.parentNode.previousSibling,e.nativeElement.addEventListener("click",r=>{this.toggle()})}toggle(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}return n.\u0275fac=function(e){return new(e||n)(Q(j2))},n.\u0275dir=Ht({type:n,selectors:[["","toggleVisibility",""]]}),n})();function r8t(n,t){if(1&n&&(N(0,"div",29)(1,"div",30),de(2,31),A(),N(3,"div",32),Et(4),A()()),2&n){const e=E();M(4),jn(e.errorMessage)}}const s8t=function(){return["/register"]},i8t=function(){return["/reset-password"]};let o8t=(()=>{class n{constructor(e,r){this.router=e,this.connectedUserService=r,this.faEye=Bz,this.loginForm=new k6({email:new ua,password:new ua})}ngOnInit(){var e=this;this.userSubscription=this.connectedUserService.subscribeToUser(function(){var r=O(function*(s){s!==A8.NOT_CONNECTED&&(yield e.redirect())});return function(s){return r.apply(this,arguments)}}())}loginWithEmail(e){var r=this;return O(function*(){const s=yield r.connectedUserService.doEmailLogin(e.email,e.password);s.isFailure()&&(r.errorMessage=s.getReason())})()}loginWithGoogle(){var e=this;return O(function*(){const r=yield e.connectedUserService.doGoogleLogin();r.isFailure()&&(e.errorMessage=r.getReason())})()}redirect(){var e=this;return O(function*(){return e.router.navigate(["/lobby"])})()}canLogin(){return!(""===(this.loginForm.value.email??"")||""===(this.loginForm.value.password??""))}ngOnDestroy(){this.userSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(Q($n),Q(Es))},n.\u0275cmp=vt({type:n,selectors:[["app-login"]],decls:49,vars:8,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,v;return t=$localize`Log in`,e=$localize`Email`,r=$localize`Email`,s=$localize`Password`,i=$localize`Password`,o=$localize`Log in`,c=$localize`Log in with Google`,u=$localize`No account?`,h=$localize`Register`,g=$localize`Forgot your password?`,m=$localize`Reset your password`,v=$localize`Connection error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],e,[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",r,"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],s,[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",i,"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],o,["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],c,["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],u,[3,"routerLink"],h,g,m,["role","alert",1,"message","is-danger"],[1,"message-header"],v,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(N(0,"div",0)(1,"p",1),de(2,2),A(),N(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),de(7,7),A()(),N(8,"div",8)(9,"div",9)(10,"div",10),X(11,"input",11),A()()()(),N(12,"div",4)(13,"div",5)(14,"label",12),de(15,13),A()(),N(16,"div",8)(17,"div",9)(18,"div",14),X(19,"input",15),N(20,"span",16),X(21,"fa-icon",17),A()()()()(),N(22,"div",4),X(23,"div",5),N(24,"div",8)(25,"div",9)(26,"div",10)(27,"button",18),se("click",function(){return r.loginWithEmail(r.loginForm.value)}),de(28,19),A()()()()(),N(29,"div",4),X(30,"div",5),N(31,"div",8)(32,"div",9)(33,"div",10)(34,"button",20),se("click",function(){return r.loginWithGoogle()}),de(35,21),A()()()()(),k(36,r8t,5,1,"div",22),N(37,"p",23),nn(38),de(39,24),rn(),Et(40,"\xa0 "),N(41,"a",25),de(42,26),A()(),N(43,"p",23),nn(44),de(45,27),rn(),Et(46,"\xa0 "),N(47,"a",25),de(48,28),A()()()()),2&e&&(M(3),w("formGroup",r.loginForm),M(18),w("icon",r.faEye),M(6),w("disabled",!r.canLogin()),M(9),w("ngIf",r.errorMessage),M(5),w("routerLink",ar(6,s8t)),M(6),w("routerLink",ar(7,i8t)))},dependencies:[hn,Bu,ku,$3,Y4,Lu,zu,Ru,S7,If,FV,kce],encapsulation:2}),n})(),a8t=(()=>{class n{constructor(e){this.partDAO=e}subscribeToActiveParts(e){let r=[];const c=new zM(u=>{r=r.concat(...u),e(r)},u=>{const h=r;for(const g of u)h.forEach(m=>{m.id===g.id&&(m.data=g.data)});r=h,e(r)},u=>{const h=[];for(const g of r)u.some(m=>m.id===g.id)||h.push(g);r=h,e(r)});return this.partDAO.observingWhere([["result","==",Nn.UNACHIEVED.value]],c)}}return n.\u0275fac=function(e){return new(e||n)(xe(vee))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),c8t=(()=>{class n{constructor(e){this.userDAO=e}subscribeToActiveUsers(e){Y(n.VERBOSE,"ActiveUsersService.subscribeToActiveUsers");let r=[];const c=new zM(u=>{Y(n.VERBOSE,"our DAO gave us "+u.length+" new user(s)"),r=this.sort(r.concat(...u)),e(r)},u=>{let h=r;Y(n.VERBOSE,"our DAO updated "+u.length+" user(s)");for(const g of u)h.forEach(m=>{m.id===g.id&&(m.data=g.data)}),h=this.sort(h);r=h,e(r)},u=>{r=r.filter(h=>!u.some(g=>g.id===h.id)),e(r)});return this.userDAO.observingWhere([["state","==","online"],["verified","==",!0]],c)}sort(e){return e.sort((r,s)=>{const i=Ae.getNonNullable(r.data).lastUpdateTime,o=Ae.getNonNullable(i).seconds,c=Ae.getNonNullable(s.data).lastUpdateTime;return o-Ae.getNonNullable(c).seconds})}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(xe(RM))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Rce=(()=>{class n{transform(e){return eU(1e3*e.seconds,"HH:mm:ss","en-US")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=js({name:"firebaseDate",type:n,pure:!0}),n})();const l8t=["chatDiv"];function u8t(n,t){1&n&&(nn(0),de(1,5),rn())}function f8t(n,t){1&n&&de(0,6),2&n&&(w1(E().unreadMessagesText),k1(0))}function h8t(n,t){if(1&n){const e=we();N(0,"button",11),se("click",function(){return he(e),ce(E(2).scrollToBottom())}),Et(1),A()}if(2&n){const e=E(2);M(1),Ei("",e.unreadMessagesText," \u2193")}}function d8t(n,t){if(1&n&&(N(0,"p"),Et(1),Ga(2,"firebaseDate"),N(3,"b",12),Et(4),A(),N(5,"span",13),Et(6),A()()),2&n){const e=t.$implicit;M(1),Ei(" [",Bc(2,3,e.postedTime),"] "),M(3),Ei("",e.sender.name," : "),M(2),jn(e.content)}}function p8t(n,t){if(1&n){const e=we();N(0,"div"),k(1,h8t,2,1,"button",7),N(2,"div",8,9),se("scroll",function(){return he(e),ce(E().updateCurrentScrollPosition())}),k(4,d8t,7,5,"p",10),A()()}if(2&n){const e=E();M(1),w("ngIf",e.showUnreadMessagesButton),M(3),w("ngForOf",e.chat)}}const g8t=function(){return{standalone:!0}};function m8t(n,t){if(1&n){const e=we();N(0,"form",14),se("onSubmit",function(){return he(e),ce(E().sendMessage())}),N(1,"div",15)(2,"div",16)(3,"input",17,18),se("ngModelChange",function(s){return he(e),ce(E().userMessage=s)}),A(),N(5,"p",19),Et(6),A()(),N(7,"div",20)(8,"button",21),se("click",function(){return he(e),ce(E().sendMessage())}),X(9,"fa-icon",22),A()()(),N(10,"div",23)(11,"p")(12,"strong"),de(13,24),A()()()()}if(2&n){const e=s1(4),r=E();M(3),w("ngModel",r.userMessage)("ngModelOptions",ar(4,g8t)),M(3),Ei("",e.value.length,"/128"),M(3),w("icon",r.faReply)}}let Dce=(()=>{class n{constructor(e,r){this.chatService=e,this.connectedUserService=r,this.userMessage="",this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=wz,this.isNearBottom=!0,this.notYetScrolled=!0,Y(n.VERBOSE,"ChatComponent constructor")}ngOnInit(){Y(n.VERBOSE,`ChatComponent.ngOnInit for chat ${this.chatId}`),Se(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}ngAfterViewChecked(){this.scrollToBottomIfNeeded()}loadChatContent(){const e=s=>{this.updateMessages(s.flatMap(i=>null==i.data.postedTime?[]:[i.data]))},r=new zM(e,e,()=>{});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,r)}updateMessages(e){this.chat=this.chat.concat(e);const r=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=r,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(r-this.readMessages)}updateUnreadMessagesText(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize`no new message`,this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize`1 new message`:$localize`${e} new messages`}scrollToBottomIfNeeded(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}updateCurrentScrollPosition(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}scrollToBottom(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}scrollTo(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}sendMessage(){var e=this;return O(function*(){const r=e.userMessage;e.userMessage="";const s=e.connectedUserService.user.get().toMinimalUser();yield e.chatService.sendMessage(e.chatId,s,r,e.turn)})()}ngOnDestroy(){this.chatSubscription.unsubscribe()}switchChatVisibility(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(kM),Q(Es))},n.\u0275cmp=vt({type:n,selectors:[["app-chat"]],viewQuery:function(e,r){if(1&e&&V3(l8t,5),2&e){let s;Wa(s=qa())&&(r.chatDiv=s.first)}},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){let t,e,r,s;return t=$localize`Hide chat`,e=$localize`Show chat (${"\ufffd0\ufffd"}:INTERPOLATION:)`,r=$localize`Type your message here`,s=$localize`Be polite`,[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],t,e,["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",r,"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],s]},template:function(e,r){if(1&e&&(N(0,"div")(1,"button",0),se("click",function(){return r.switchChatVisibility()}),k(2,u8t,2,0,"ng-container",1),k(3,f8t,1,1,"ng-template",null,2,l1),A(),k(5,p8t,5,2,"div",3),k(6,m8t,14,5,"form",4),A()),2&e){const s=s1(4);M(2),w("ngIf",r.visible)("ngIfElse",s),M(3),w("ngIf",r.visible),M(1),w("ngIf",r.visible)}},dependencies:[Fn,hn,ku,$3,Y4,Lu,SN,R9,k9,If,Rce],encapsulation:2}),n})(),zce=(()=>{class n{constructor(e,r,s){this.router=e,this.observedPartService=r,this.messageDisplayer=s}pickGame(e){this.selectedGame=e}navigateToOnlineGameCreation(){var e=this;return O(function*(){const r=e.observedPartService.canUserCreate();r.isSuccess()?yield e.router.navigate(["/play",e.selectedGame]):e.messageDisplayer.criticalMessage(r.getReason())})()}}return n.\u0275fac=function(e){return new(e||n)(Q($n),Q(li),Q(In))},n.\u0275cmp=vt({type:n,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Create an online game`,[[3,"pickGame"],["id","playOnline",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(N(0,"app-pick-game",0),se("pickGame",function(i){return r.pickGame(i)}),A(),N(1,"button",1),se("click",function(){return r.navigateToOnlineGameCreation()}),de(2,2),A()),2&e&&(M(1),w("disabled",!r.selectedGame))},dependencies:[HV],encapsulation:2}),n})();function _8t(n,t){if(1&n&&(nn(0),Et(1),rn()),2&n){const e=E().$implicit;M(1),jn(e.data.playerOne.name)}}function v8t(n,t){1&n&&(nn(0),de(1,26),rn())}function C8t(n,t){if(1&n){const e=we();N(0,"tr",22),se("click",function(){const i=he(e).$implicit;return ce(E(2).joinGame(i))}),N(1,"td",23),Et(2),A(),N(3,"td",23),Et(4),A(),N(5,"td",23),k(6,_8t,2,1,"ng-container",24),k(7,v8t,2,0,"ng-template",null,25,l1),A(),N(9,"td",23),Et(10),A()()}if(2&n){const e=t.$implicit,r=t.index,s=s1(8);L1("id","part_",r,""),M(2),jn(e.data.typeGame),M(2),jn(e.data.playerZero.name),M(2),w("ngIf",e.data.playerOne)("ngIfElse",s),M(4),jn(e.data.turn)}}function y8t(n,t){if(1&n&&(N(0,"div",13)(1,"div",14)(2,"table",15)(3,"thead")(4,"tr")(5,"th",16),de(6,17),A(),N(7,"th",16),de(8,18),A(),N(9,"th",16),de(10,19),A(),N(11,"th",16),de(12,20),A()()(),N(13,"tbody"),k(14,C8t,11,6,"tr",21),A()()()()),2&n){const e=E();M(14),w("ngForOf",e.activeParts)}}function E8t(n,t){1&n&&(N(0,"div",27),X(1,"app-online-game-selection",28),A())}function M8t(n,t){if(1&n&&(N(0,"li",39),Et(1),Ga(2,"firebaseDate"),A()),2&n){const e=E().$implicit;Xw("id",e.data.username),M(1),oC("",e.data.username,": ",Bc(2,3,e.data.lastUpdateTime),"")}}function S8t(n,t){if(1&n&&(nn(0),k(1,M8t,3,5,"li",38),rn()),2&n){const e=t.$implicit;M(1),w("ngIf",e.data.lastUpdateTime)}}function P8t(n,t){if(1&n&&(N(0,"div",29)(1,"div",30)(2,"div",31),X(3,"app-chat",32),A()(),N(4,"div",33)(5,"div",34)(6,"p"),de(7,35),A(),N(8,"ul",36),k(9,S8t,2,1,"ng-container",37),A()()()()),2&n){const e=E();M(3),w("turn",-1),M(6),w("ngForOf",e.activeUsers)}}let T8t=(()=>{class n{constructor(e,r,s,i,o){this.router=e,this.messageDisplayer=r,this.activePartsService=s,this.activeUsersService=i,this.observedPartService=o,this.activeUsers=[],this.activeParts=[],this.currentTab="games",this.createTabClasses=[]}ngOnInit(){Y(n.VERBOSE,"lobbyComponent.ngOnInit"),this.activeUsersSubscription=this.activeUsersService.subscribeToActiveUsers(e=>{this.activeUsers=e}),this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(e=>{this.activeParts=e}),this.observedPartService.subscribeToObservedPart(e=>{this.createTabClasses=[],e.isPresent()&&(this.createTabClasses=["disabled-tab"])})}ngOnDestroy(){Y(n.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activeUsersSubscription.unsubscribe(),this.activePartsSubscription.unsubscribe()}joinGame(e){var r=this;return O(function*(){const s=e.id,i=e.data.typeGame,c=r.observedPartService.canUserJoin(s,null!=e.data.beginning);c.isSuccess()?yield r.router.navigate(["/play",i,s]):r.messageDisplayer.criticalMessage(c.getReason())})()}selectTab(e){if("create"===e){const r=this.observedPartService.canUserCreate();r.isSuccess()?this.currentTab=e:this.messageDisplayer.criticalMessage(r.getReason())}else this.currentTab=e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q($n),Q(In),Q(a8t),Q(c8t),Q(li))},n.\u0275cmp=vt({type:n,selectors:[["app-lobby"]],decls:14,vars:4,consts:function(){let t,e,r,s,i,o,c,u,h;return t=$localize`Games`,e=$localize`Create`,r=$localize`Chat`,s=$localize`Game`,i=$localize`First player`,o=$localize`Second player`,c=$localize`Turn`,u=$localize`Waiting for opponent`,h=$localize`Connected users:`,[[1,"tabs","is-toggle","is-fullwidth"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],t,["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"ngClass","click"],e,["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],r,["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],s,i,o,c,[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],u,["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],["id","chatContainerDiv",1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"],[1,"column","is-3","is-hidden"],["id","onlineUsers",1,"box"],h,["id","activeUsersList"],[4,"ngFor","ngForOf"],[3,"id",4,"ngIf"],[3,"id"]]},template:function(e,r){1&e&&(N(0,"div",0)(1,"ul")(2,"li",1)(3,"a",2),se("click",function(){return r.selectTab("games")}),de(4,3),A()(),N(5,"li",4)(6,"a",5),se("click",function(){return r.selectTab("create")}),de(7,6),A()(),N(8,"li",7)(9,"a",8),se("click",function(){return r.selectTab("chat")}),de(10,9),A()()()(),k(11,y8t,15,1,"div",10),k(12,E8t,2,0,"div",11),k(13,P8t,10,2,"div",12)),2&e&&(M(6),w("ngClass",r.createTabClasses),M(5),w("ngIf","games"===r.currentTab),M(1),w("ngIf","create"===r.currentTab),M(1),w("ngIf","chat"===r.currentTab))},dependencies:[On,Fn,hn,Dce,zce,Rce],encapsulation:2}),n})(),Vce=(()=>{class n{constructor(e){this.route=e,this.message=e.snapshot.paramMap.get("message")??$localize`This page does not exist.`}}return n.\u0275fac=function(e){return new(e||n)(Q(Qi))},n.\u0275cmp=vt({type:n,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){let t;return t=$localize`Not found`,[[1,"message","is-danger"],[1,"message-header"],t,[1,"message-body"]]},template:function(e,r){1&e&&(N(0,"div",0)(1,"div",1),de(2,2),A(),N(3,"div",3),Et(4),A()()),2&e&&(M(4),jn(r.message))},encapsulation:2}),n})();class eh{constructor(t,e,r){this.added=t,this.modified=e,this.removed=r}static from(t,e){const r=new eh({},{},{});if(null==t)return r.added={...e},r;if(null==e)return r.removed={...t},r;const s=Object.keys(t),i=Object.keys(e),o=s.filter(h=>!1===i.includes(h)),c=s.filter(h=>i.includes(h)),u=i.filter(h=>!1===s.includes(h));return r.addNewKeys(u,e),r.addCommonKeys(c,e,t),r.addRemovedKeys(o,t),r}static differs(t,e){return eh.from(t,e).countChanges()>0}addNewKeys(t,e){for(const r of t)null!=e[r]&&(this.added[r]=e[r])}addCommonKeys(t,e,r){for(const s of t)this.addCommonKey(s,r[s],e[s])}addCommonKey(t,e,r){if(null==r)null!=e&&(this.removed[t]=e);else if(null==e)this.added[t]=r;else if(["string","boolean","number"].includes(typeof e))e!==r&&(this.modified[t]=r);else if(Array.isArray(e)){if(!Array.isArray(r))throw new Error("Thing should not change type");e.length===r.length?this.addCommonKeyList(t,e,r):this.modified[t]=r}else{Se("object"==typeof e,`ObjectDifference: expected JSON, but got a ${typeof e} in ${t}`),Se("object"==typeof r,`ObjectDifference: expected JSON, but got a ${typeof r} in ${t}`);const o=eh.from(e,r);o.countChanges()>0&&(this.modified[t]=o)}}addCommonKeyList(t,e,r){let s=!0;for(let i=0;s&&i<e.length;i++)typeof e[i]==typeof r[i]&&"object"==typeof e[i]?eh.differs(e[i],r[i])&&(s=!1,this.modified[t]=r):e[i]!==r[i]&&(s=!1,this.modified[t]=r)}addRemovedKeys(t,e){for(const r of t)this.removed[r]=e[r]}countChanges(){const t=Object.keys(this.removed).length,e=Object.keys(this.modified).length;return Object.keys(this.added).length+e+t}isPresent(t){return null!=this.added[t]?{state:"added",present:!0}:null!=this.modified[t]?{state:"modified",present:!0}:null!=this.removed[t]?{state:"removed",present:!0}:{state:null,present:!1}}isFullyCreated(){return 0===Object.keys(this.modified).length&&0===Object.keys(this.removed).length}addedOrModified(t){const e=this.isPresent(t);return!0===e.present&&"removed"!==e.state}}function Hce(n){return 1e3*n.seconds+n.nanoseconds/1e6}function Fce(n,t){return Hce(t)-Hce(n)}function um(n){return or((t,e)=>{mo(n).subscribe(Qr(e,()=>e.complete(),Di)),!e.closed&&t.subscribe(e)})}let w8t=(()=>{class n{transform(e){const r=e%60,s=(e-r)%3600/60,i=(e-60*s-r)/3600,o=[];if(i>1?o.push($localize`${i} hours`):1===i&&o.push($localize`1 hour`),s>1?o.push($localize`${s} minutes`):1===s&&o.push($localize`1 minute`),r>1?o.push($localize`${r} seconds`):1===r&&o.push($localize`1 second`),0===o.length)return $localize`0 seconds`;if(1===o.length)return o[0];{const c=o.slice(0,-1).join(", "),u=o.slice(-1)[0];return $localize`${c} and ${u}`}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=js({name:"humanDuration",type:n,pure:!0}),n})();function b8t(n,t){if(1&n&&(nn(0),Et(1),rn()),2&n){const e=E(3);M(1),jn(e.viewInfo.chosenOpponent)}}function N8t(n,t){1&n&&de(0,44)}function A8t(n,t){if(1&n&&(N(0,"div",45)(1,"div",8)(2,"label",46),nn(3),de(4,47),rn(),N(5,"output"),Et(6),Ga(7,"humanDuration"),A()(),N(8,"div",37),X(9,"input",48),A()(),N(10,"div",8)(11,"label",49),$a(12,50),X(13,"output"),Ga(14,"humanDuration"),Ua(),A(),N(15,"div",37),X(16,"input",51),A()()()),2&n){const e=E(3);M(6),jn(Bc(7,2,e.viewInfo.maximalMoveDuration||0)),M(8),w1(Bc(14,4,e.viewInfo.totalPartDuration||0)),k1(12)}}function O8t(n,t){1&n&&(N(0,"div"),$a(1,52),X(2,"br"),Ua(),A())}function I8t(n,t){1&n&&(N(0,"button",64),de(1,65),A())}function x8t(n,t){if(1&n){const e=we();N(0,"tr",60),se("click",function(){const i=he(e).$implicit;return ce(E(4).selectOpponent(i))}),N(1,"td",61),Et(2),A(),N(3,"td",62),k(4,I8t,2,0,"button",63),A()()}if(2&n){const e=t.$implicit,r=E(4);L1("id","presenceOf_",e,""),w("ngClass",r.viewInfo.candidateClasses[e]),M(1),w("id",r.viewInfo.chosenOpponent===e?"selected_"+e:"candidate_"+e),M(1),jn(e),M(2),w("ngIf",r.viewInfo.chosenOpponent!==e)}}function L8t(n,t){if(1&n&&(nn(0),de(1,53),rn(),N(2,"div",54)(3,"table",55)(4,"thead")(5,"tr")(6,"th",56),de(7,57),A(),N(8,"th",56),de(9,58),A()()(),N(10,"tbody"),k(11,x8t,5,5,"tr",59),A()()()),2&n){const e=E(3);M(11),w("ngForOf",e.viewInfo.candidates)}}function k8t(n,t){if(1&n){const e=we();N(0,"button",66),se("click",function(){return he(e),ce(E(3).changeConfig())}),de(1,67),A()}}function R8t(n,t){if(1&n){const e=we();N(0,"div")(1,"h1",4),de(2,5),A(),N(3,"form",6)(4,"fieldset",7)(5,"div",8)(6,"label",9),de(7,10),A(),N(8,"div",11)(9,"button",12),se("click",function(){return he(e),ce(E(2).selectFirstPlayer("RANDOM"))}),de(10,13),A(),N(11,"button",14),se("click",function(){return he(e),ce(E(2).selectFirstPlayer("CREATOR"))}),de(12,15),A(),N(13,"button",16),se("click",function(){return he(e),ce(E(2).selectFirstPlayer("CHOSEN_PLAYER"))}),k(14,b8t,2,1,"ng-container",17),k(15,N8t,1,0,"ng-template",null,18,l1),A()()(),N(17,"div",8)(18,"label",9),de(19,19),A(),N(20,"div",11)(21,"div",20),se("click",function(){return he(e),ce(E(2).selectPartType("STANDARD"))}),N(22,"div",21)(23,"span"),de(24,22),A()(),N(25,"div",23)(26,"div",24)(27,"div",25)(28,"p"),nn(29),de(30,26),rn(),N(31,"strong"),Et(32),Ga(33,"humanDuration"),A(),X(34,"br"),nn(35),$a(36,27),X(37,"strong"),Ga(38,"humanDuration"),Ua(),rn(),A()()()()(),N(39,"div",28),se("click",function(){return he(e),ce(E(2).selectPartType("BLITZ"))}),N(40,"div",21)(41,"span"),de(42,29),A()(),N(43,"div",23)(44,"div",24)(45,"div",25)(46,"p"),nn(47),de(48,30),rn(),N(49,"strong"),Et(50),Ga(51,"humanDuration"),A(),X(52,"br"),nn(53),$a(54,31),X(55,"strong"),Ga(56,"humanDuration"),Ua(),rn(),A()()()()(),N(57,"button",32),se("click",function(){return he(e),ce(E(2).selectPartType("CUSTOM"))}),de(58,33),A()()(),k(59,A8t,17,6,"div",34),N(60,"div",8)(61,"label",35),de(62,36),A(),N(63,"div",37),k(64,O8t,3,0,"div",17),k(65,L8t,12,1,"ng-template",null,38,l1),A()()(),N(67,"div",8)(68,"div",11)(69,"button",39),se("click",function(){return he(e),ce(E(2).proposeConfig())}),de(70,40),A(),k(71,k8t,2,0,"button",41),N(72,"button",42),se("click",function(){return he(e),ce(E(2).cancelGameCreation())}),de(73,43),A()()()()()}if(2&n){const e=s1(16),r=s1(66),s=E(2);M(3),w("formGroup",s.configFormGroup),M(1),w("disabled",!s.viewInfo.canEditConfig),M(5),w("ngClass",s.viewInfo.firstPlayerClasses.RANDOM),M(2),w("ngClass",s.viewInfo.firstPlayerClasses.CREATOR),M(2),w("ngClass",s.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),M(1),w("ngIf",s.viewInfo.chosenOpponent)("ngIfElse",e),M(7),w("ngClass",s.viewInfo.partTypeClasses.STANDARD),M(11),jn(Bc(33,19,s.partType.NORMAL_MOVE_DURATION)),M(6),w1(Bc(38,21,s.partType.NORMAL_PART_DURATION)),k1(36),M(1),w("ngClass",s.viewInfo.partTypeClasses.BLITZ),M(11),jn(Bc(51,23,s.partType.BLITZ_MOVE_DURATION)),M(6),w1(Bc(56,25,s.partType.BLITZ_PART_DURATION)),k1(54),M(1),w("ngClass",s.viewInfo.partTypeClasses.CUSTOM),M(2),w("ngIf",s.viewInfo.showCustomTime),M(5),w("ngIf",0===s.viewInfo.candidates.length)("ngIfElse",r),M(5),w("disabled",!s.viewInfo.canProposeConfig),M(2),w("ngIf",s.viewInfo.canReviewConfig)}}function D8t(n,t){if(1&n&&(N(0,"div",74)(1,"p"),$a(2,75),X(3,"br"),Ua(),A()()),2&n){const e=E(3);M(3),w1(e.viewInfo.creator),k1(2)}}function z8t(n,t){if(1&n&&(N(0,"span"),de(1,81),A()),2&n){const e=E(4);M(1),w1(e.viewInfo.creator),k1(1)}}function V8t(n,t){1&n&&(N(0,"span"),de(1,82),A())}function H8t(n,t){1&n&&(N(0,"span"),de(1,83),A())}function F8t(n,t){if(1&n){const e=we();N(0,"div",74)(1,"p"),de(2,76),A(),N(3,"ul")(4,"li"),k(5,z8t,2,1,"span",2),k(6,V8t,2,0,"span",2),k(7,H8t,2,0,"span",2),A(),N(8,"li"),$a(9,77),X(10,"strong"),Ga(11,"humanDuration"),Ua(),A(),N(12,"li"),$a(13,78),X(14,"strong"),Ga(15,"humanDuration"),Ua(),A()(),N(16,"button",79),se("click",function(){return he(e),ce(E(3).acceptConfig())}),de(17,80),A()()}if(2&n){const e=E(3);M(2),w1(e.viewInfo.creator)(e.viewInfo.partTypeName),k1(2),M(3),w("ngIf","CREATOR"===e.viewInfo.firstPlayer),M(1),w("ngIf","CHOSEN_PLAYER"===e.viewInfo.firstPlayer),M(1),w("ngIf","RANDOM"===e.viewInfo.firstPlayer),M(4),w1(Bc(11,7,e.viewInfo.maximalMoveDuration||0)),k1(9),M(4),w1(Bc(15,9,e.viewInfo.totalPartDuration||0)),k1(13)}}function B8t(n,t){if(1&n&&(N(0,"div")(1,"div",68)(2,"div",69)(3,"p"),de(4,70),A()(),N(5,"div",71),k(6,D8t,4,1,"div",72),k(7,F8t,18,11,"ng-template",null,73,l1),A()()()),2&n){const e=s1(8),r=E(2);M(6),w("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function $8t(n,t){if(1&n&&(nn(0),de(1,86),rn()),2&n){const e=E(3);M(1),w1(e.viewInfo.creator),k1(1)}}function U8t(n,t){if(1&n&&de(0,87),2&n){const e=E(3);w1(e.viewInfo.creator)(e.viewInfo.chosenOpponent),k1(0)}}function G8t(n,t){if(1&n&&(N(0,"div",68)(1,"div",69)(2,"p"),de(3,84),A()(),N(4,"div",71)(5,"p"),k(6,$8t,2,1,"ng-container",17),k(7,U8t,1,2,"ng-template",null,85,l1),A()()()),2&n){const e=s1(8),r=E(2);M(6),w("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function W8t(n,t){if(1&n&&(N(0,"div",1),k(1,R8t,74,27,"div",2),k(2,B8t,9,2,"div",2),k(3,G8t,9,2,"div",3),A()),2&n){const e=E();M(1),w("ngIf",e.viewInfo.userIsCreator),M(1),w("ngIf",e.viewInfo.userIsChosenOpponent),M(1),w("ngIf",e.viewInfo.userIsObserver)}}class o1{constructor(t,e,r,s,i,o,c,u,h,g){this.router=t,this.actRoute=e,this.connectedUserService=r,this.observedPartService=s,this.gameService=i,this.configRoomService=o,this.chatService=c,this.userService=u,this.formBuilder=h,this.messageDisplayer=g,this.partType=Er,this.gameStartNotification=new cr,this.gameStarted=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentConfigRoom=null,this.candidates=[],this.ngUnsubscribe=new pi,this.allUserInterval=S.empty(),this.ownTokenInterval=S.empty(),this.selfSubscription=new H1,this.configRoomSubscription=new H1,this.candidatesSubscription=new H1,this.allDocDeleted=!1,Y(o1.VERBOSE,"PartCreationComponent constructed")}ngOnInit(){var t=this;return O(function*(){Y(o1.VERBOSE,"PartCreationComponent.ngOnInit"),t.checkInputs(),t.createForms();const e=yield t.configRoomService.joinGame(t.partId);if(e.isFailure()){const r=e.getReason();t.messageDisplayer.criticalMessage(r)}else yield t.startSendingPresenceTokens(),t.subscribeToConfigRoomDoc(),t.subscribeToFormElements(),Y(o1.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds")})()}checkInputs(){const t=this.connectedUserService.user;Se(t.isPresent(),"PartCreationComponent should not be called without connected user"),Se(t.get()!==A8.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),Se(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}createForms(){this.configFormGroup=this.formBuilder.group({firstPlayer:[Ds.RANDOM.value,A9.required],maximalMoveDuration:[Er.NORMAL_MOVE_DURATION,A9.required],partType:["STANDARD",A9.required],totalPartDuration:[Er.NORMAL_PART_DURATION,A9.required],chosenOpponent:["",A9.required]})}updateUserDocWithObservedPart(t){Y(o1.VERBOSE,"updateUserDocWithObservedPart of '"+this.partId+"'");const e=this.getUserRoleInPart(t),r={id:this.partId,opponent:this.getOpponent(),typeGame:Ae.getNonNullable(this.actRoute.snapshot.paramMap.get("compo")),role:e};return this.observedPartService.updateObservedPart(r)}getUserRoleInPart(t){const e=this.connectedUserService.user.get().id;return e===t.creator.id?"Creator":e===t.chosenOpponent?.id?"ChosenOpponent":"Candidate"}getOpponent(){let t=null;return t=this.connectedUserService.user.get().id===this.currentConfigRoom?.creator.id?this.currentConfigRoom.chosenOpponent:Ae.getNonNullable(this.currentConfigRoom?.creator),t}subscribeToConfigRoomDoc(){var t=this;const e=function(){var s=O(function*(i){yield t.onCurrentConfigRoomUpdate(i)});return function(o){return s.apply(this,arguments)}}(),r=function(){var s=O(function*(i){yield t.onCandidatesUpdate(i)});return function(o){return s.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,e),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,r)}getForm(t){return Ae.getNonNullable(this.configFormGroup.get(t))}subscribeToFormElements(){this.getForm("chosenOpponent").valueChanges.pipe(um(this.ngUnsubscribe)).subscribe(t=>{void 0!==this.viewInfo.chosenOpponent&&(this.viewInfo.candidateClasses[this.viewInfo.chosenOpponent]=[]),this.viewInfo.candidateClasses[t]=["is-selected"],this.viewInfo.chosenOpponent=t;const e=Ae.getNonNullable(this.currentConfigRoom).partStatus;this.viewInfo.canProposeConfig=e!==zs.CONFIG_PROPOSED.value&&""!==t}),this.getForm("partType").valueChanges.pipe(um(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.partTypeClasses[this.viewInfo.partType]=[],this.viewInfo.partTypeClasses[t]=["is-primary","is-selected"],this.viewInfo.partType=t,this.viewInfo.showCustomTime="CUSTOM"===t}),this.getForm("maximalMoveDuration").valueChanges.pipe(um(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.maximalMoveDuration=t}),this.getForm("totalPartDuration").valueChanges.pipe(um(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.totalPartDuration=t}),this.getForm("firstPlayer").valueChanges.pipe(um(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.firstPlayerClasses[this.viewInfo.firstPlayer]=[],this.viewInfo.firstPlayerClasses[t]=["is-primary","is-selected"],this.viewInfo.firstPlayer=t})}updateViewInfo(){const t=Ae.getNonNullable(this.currentConfigRoom),e=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=t.partStatus===zs.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=t.partStatus!==zs.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userIsCreator(t),this.viewInfo.userIsChosenOpponent=e.id===t.chosenOpponent?.id,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=t.partStatus!==zs.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=t.creator.name,this.viewInfo.candidates=this.candidates.map(r=>r.name),this.userIsCreator(t)?this.setDataForCreator(t):(this.viewInfo.maximalMoveDuration=t.maximalMoveDuration,this.viewInfo.totalPartDuration=t.totalPartDuration,this.viewInfo.partType=t.partType,this.viewInfo.chosenOpponent=t.chosenOpponent?.name,this.viewInfo.firstPlayer=t.firstPlayer),t.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize`custom`;break;case"BLITZ":this.viewInfo.partTypeName=$localize`blitz`;break;case"STANDARD":this.viewInfo.partTypeName=$localize`standard`}}setDataForCreator(t){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration??t.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration??t.totalPartDuration;let e=this.viewInfo.chosenOpponent;null==e||""===e?e=t.chosenOpponent?.name??"":!1===this.candidates.some(s=>s.name===e)&&(e=""),this.getForm("chosenOpponent").setValue(e)}selectFirstPlayer(t){this.getForm("firstPlayer").setValue(t)}selectPartType(t){"STANDARD"===t?(this.getForm("maximalMoveDuration").setValue(Er.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Er.NORMAL_PART_DURATION)):"BLITZ"===t&&(this.getForm("maximalMoveDuration").setValue(Er.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Er.BLITZ_PART_DURATION)),this.getForm("partType").setValue(t)}selectOpponent(t){var e=this;return O(function*(){Y(o1.VERBOSE,"PartCreationComponent.setChosenOpponent("+t+")");const r=e.getUserFromName(t);yield Promise.all([e.observedPartService.updateObservedPart({opponent:r}),e.configRoomService.setChosenOpponent(e.partId,r)])})()}getUserFromName(t){const e=this.candidates.find(r=>r.name===t);return Ae.getNonNullable(e)}changeConfig(){var t=this;return O(function*(){return t.configRoomService.reviewConfig(t.partId)})()}proposeConfig(){var t=this;return O(function*(){const e=t.getForm("chosenOpponent").value,r=t.getForm("partType").value,s=t.getForm("maximalMoveDuration").value,i=t.getForm("firstPlayer").value,o=t.getForm("totalPartDuration").value,c=t.getUserFromName(e);return t.configRoomService.proposeConfig(t.partId,c,Er.of(r),s,Ds.of(i),o)})()}cancelGameCreation(){var t=this;return O(function*(){t.allDocDeleted=!0,yield t.observedPartService.removeObservedPart(),Y(o1.VERBOSE,"PartCreationComponent.cancelGameCreation"),yield t.chatService.deleteChat(t.partId),Y(o1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat deleted"),yield t.gameService.deletePart(t.partId),Y(o1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat and part deleted"),yield t.configRoomService.deleteConfigRoom(t.partId,t.candidates),Y(o1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat, part, and configRoom deleted")})()}onCurrentConfigRoomUpdate(t){var e=this;return O(function*(){if(Y(o1.VERBOSE,{PartCreationComponent_onCurrentConfigRoomUpdate:{before:JSON.stringify(e.currentConfigRoom),then:JSON.stringify(t)}}),t.isAbsent())return Y(o1.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: LAST UPDATE : the game is cancelled"),e.onGameCancelled();{const r=t.get();if(e.chosenOpponentJustLeft(r)&&e.userIsCreator(r)){const i=Ae.getNonNullable(e.currentConfigRoom),o=Ae.getNonNullable(i.chosenOpponent).name;e.messageDisplayer.infoMessage($localize`${o} left the game, please pick another opponent.`),yield e.observedPartService.updateObservedPart({opponent:null})}let s=!1;e.userJustChosenAsOpponent(r)&&(yield e.updateUserDocWithObservedPart(r),s=!0),e.currentConfigRoom=r,e.allUserInterval.isAbsent()&&(Se(!1===s,"Expected observedPartUpdate to be false at first call of onCurrentConfigRoomUpdate"),yield e.updateUserDocWithObservedPart(e.currentConfigRoom),yield e.observeNeededPlayers()),e.updateViewInfo(),e.isGameStarted(e.currentConfigRoom)&&(Y(o1.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: the game has started"),e.onGameStarted())}})()}onCandidatesUpdate(t){var e=this;return O(function*(){e.candidates=t,e.updateViewInfo()})()}userJustChosenAsOpponent(t){if(this.isGameStarted(t))return!1;const e=this.connectedUserService.user.get().id;return this.currentConfigRoom?.chosenOpponent?.id!==e&&t.chosenOpponent?.id===e}chosenOpponentJustLeft(t){return null!=this.currentConfigRoom&&(null!=this.currentConfigRoom.chosenOpponent&&null==t.chosenOpponent)}onGameCancelled(){var t=this;return O(function*(){Y(o1.VERBOSE,"PartCreationComponent.onGameCancelled"),t.messageDisplayer.infoMessage($localize`The game has been canceled!`),yield t.router.navigate(["/lobby"])})()}isGameStarted(t){return Se(null!=t,"configRoom should not be null (isGameStarted)"),Ae.getNonNullable(t).partStatus===zs.PART_STARTED.value}onGameStarted(){const t=Ae.getNonNullable(this.currentConfigRoom);Y(o1.VERBOSE,{partCreationComponent_onGameStarted:{configRoom:t}}),this.gameStartNotification.emit(t),this.gameStarted=!0,Y(o1.VERBOSE,"PartCreationComponent.onGameStarted finished")}observeNeededPlayers(){var t=this;return O(function*(){const e=Ae.getNonNullable(t.currentConfigRoom);Y(o1.VERBOSE,{PartCreationComponent_observeNeededPlayers:{configRoom:e}}),Se(t.allUserInterval.isAbsent(),"Cannot observe players multiple times"),t.allUserInterval=S.of(window.setInterval(O(function*(){const r=t.lastToken;t.userIsCreator(e)?yield t.checkCandidatesTokensFreshness(r):yield t.checkCreatorTokenFreshness(r)}),o1.TOKEN_INTERVAL))})()}userIsCreator(t){return this.connectedUserService.user.get().id===t.creator.id}checkCreatorTokenFreshness(t){var e=this;return O(function*(){const r=Ae.getNonNullable(e.currentConfigRoom);(yield e.didUserTimeout(r.creator.id,t))&&(yield e.destroyDocIfPartDidNotStart())})()}destroyDocIfPartDidNotStart(){var t=this;return O(function*(){Se(!1===t.isGameStarted(t.currentConfigRoom),"Should not try to cancelGameCreation when part started!"),Se(!1===t.allDocDeleted,"Should not delete doc twice"),yield t.cancelGameCreation()})()}checkCandidatesTokensFreshness(t){var e=this;return O(function*(){for(const r of e.candidates)(yield e.didUserTimeout(r.id,t))&&(yield e.removeCandidateFromLobby(r))})()}didUserTimeout(t,e){var r=this;return O(function*(){const s=yield r.userService.getUserLastUpdateTime(t);return s.isAbsent()?(ys.logError("PartCreationComponent","found no user while observing "+t+" !"),!0):Fce(s.get(),e)>o1.TOKEN_TIMEOUT})()}removeCandidateFromLobby(t){var e=this;return O(function*(){const r=Ae.getNonNullable(e.currentConfigRoom);return t.id===r.chosenOpponent?.id&&(yield e.configRoomService.reviewConfigAndRemoveChosenOpponent(e.partId)),e.configRoomService.removeCandidate(e.partId,t)})()}startSendingPresenceTokens(){var t=this;return O(function*(){yield t.connectedUserService.sendPresenceToken(),Se(t.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),t.ownTokenInterval=S.of(window.setInterval(()=>{t.connectedUserService.sendPresenceToken()},o1.TOKEN_INTERVAL));const e=t.connectedUserService.user.get().id;t.selfSubscription=t.userService.observeUser(e,r=>{Se(r.isPresent(),"connected user should exist");const s=r.get();null!=s.lastUpdateTime&&(t.lastToken=s.lastUpdateTime)})})()}stopSendingPresenceTokensAndObservingUsersIfNeeded(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=S.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}acceptConfig(){return Y(o1.VERBOSE,"PartCreationComponent.acceptConfig"),this.gameService.acceptConfig(this.partId,Ae.getNonNullable(this.currentConfigRoom))}ngOnDestroy(){var t=this;return O(function*(){Y(o1.VERBOSE,"PartCreationComponent.ngOnDestroy"),t.ngUnsubscribe.next(),t.ngUnsubscribe.complete(),t.configRoomSubscription.unsubscribe(),t.candidatesSubscription.unsubscribe(),t.stopSendingPresenceTokensAndObservingUsersIfNeeded();const e=t.connectedUserService.user.get();!0!==t.gameStarted&&(null===t.currentConfigRoom?Y(o1.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"):!0===t.allDocDeleted?Y(o1.VERBOSE,"PartCreationComponent.ngOnDestroy: part has already been deleted"):e.id===t.currentConfigRoom.creator.id?(Y(o1.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),yield t.cancelGameCreation()):(Y(o1.VERBOSE,"PartCreationComponent.ngOnDestroy: you are about to cancel game joining"),yield t.observedPartService.removeObservedPart(),yield t.configRoomService.cancelJoining(t.partId)))})()}}function q8t(n,t){if(1&n){const e=we();N(0,"button",3),se("click",function(){return he(e),ce(E().addTime())}),de(1,4),A()}if(2&n){const e=E();M(1),w1(e.timeToAdd),k1(1)}}o1.VERBOSE=!1,o1.TOKEN_INTERVAL=5e3,o1.TOKEN_TIMEOUT=2*o1.TOKEN_INTERVAL,o1.\u0275fac=function(t){return new(t||o1)(Q($n),Q(Qi),Q(Es),Q(li),Q(VM),Q(jD),Q(kM),Q(Ng),Q(Z8e),Q(In))},o1.\u0275cmp=vt({type:o1,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){let n,t,e,r,s,i,o,c,u,h,g,m,v,T,I,z,Z,te,me,J,Ne,He,qe,Dt,A1,M1,Yr,dc,go,di,Gn,Rl,_t,Ft,qt,t1;return n=$localize`Game creation`,t=$localize`First player`,e=$localize`Random`,r=$localize`You`,s=$localize`Game type`,i=$localize`Standard`,o=$localize`Maximal turn duration: `,c=$localize`Maximal game duration: ${"\ufffd#37\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#37\ufffd"}:CLOSE_TAG_STRONG:`,u=$localize`Blitz`,h=$localize`Maximal turn duration: `,g=$localize`Maximal game duration: ${"\ufffd#55\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#55\ufffd"}:CLOSE_TAG_STRONG:`,m=$localize`Custom`,v=$localize`Opponents`,T=$localize`Propose configuration`,I=$localize`Cancel game`,z=$localize`The opponent`,Z=$localize`Maximal turn duration: `,te=$localize`Maximal game duration: ${"\ufffd#13\ufffd"}:START_TAG_OUTPUT:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#13\ufffd"}:CLOSE_TAG_OUTPUT:`,me=$localize`Potential opponents that join the game will appear here.${"\ufffd#2\ufffd\ufffd/#2\ufffd"}:LINE_BREAK:Wait for an opponent to join, so that you can pick one.`,J=$localize`Click on the opponent against which you would like to play.`,Ne=$localize`Name`,He=$localize`Actions`,qe=$localize`Pick`,Dt=$localize`Change configuration`,A1=$localize`Configuration proposal`,M1=$localize`You have been selected as the opponent.${"\ufffd#3\ufffd\ufffd/#3\ufffd"}:LINE_BREAK: ${"\ufffd0\ufffd"}:INTERPOLATION: is modifying the configuration.`,Yr=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: proposes to play a ${"\ufffd1\ufffd"}:INTERPOLATION_1: game`,dc=$localize`a turn lasts at most ${"\ufffd#10\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#10\ufffd"}:CLOSE_TAG_STRONG:`,go=$localize`the game lasts at most ${"\ufffd#14\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#14\ufffd"}:CLOSE_TAG_STRONG:`,di=$localize`Accept and start`,Gn=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: plays first`,Rl=$localize`you play first`,_t=$localize`the first player is selected randomly`,Ft=$localize`One moment...`,qt=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: is configuring the game.`,t1=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has proposed a configuration to ${"\ufffd1\ufffd"}:INTERPOLATION_1:.`,[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],n,[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],t,[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],e,["id","firstPlayerCreator",1,"button",3,"ngClass","click"],r,["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],s,["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],i,["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],o,c,["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],u,h,g,["id","partTypeCustom",1,"button",3,"ngClass","click"],m,["id","customTime",4,"ngIf"],[1,"label"],v,[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],T,["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],I,z,["id","customTime"],["for","maximalMoveDuration",1,"label"],Z,["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],te,["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],me,J,["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],Ne,He,[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],qe,["id","reviewConfig",1,"button",3,"click"],Dt,[1,"message","is-primary"],[1,"message-header"],A1,[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],M1,Yr,dc,go,["id","acceptConfig",1,"button","is-primary",3,"click"],di,Gn,Rl,_t,Ft,["proposalSent",""],qt,t1]},template:function(t,e){1&t&&k(0,W8t,4,3,"div",0),2&t&&w("ngIf",e.viewInfo)},dependencies:[On,Fn,hn,ku,$3,ZC,Y4,Lu,Ru,S7,w8t],encapsulation:2});let j8t=(()=>{class n{constructor(){this.timeoutHandleGlobal=null,this.timeoutHandleSec=null,this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new cr,this.addTimeToOpponent=new cr,this.cssClasses=n.SAFE_TIME}ngOnInit(){Y(n.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}setDuration(e){Y(n.VERBOSE,this.debugName+".set("+e+"ms)"),Ae.assert(!1===this.started,"Should not set a chrono that has already been started ("+this.debugName+")!"),this.isSet=!0,this.changeDuration(e)}changeDuration(e){let r=!1;!1===this.isPaused&&(this.pause(),r=!0),this.remainingMs=e,this.displayDuration(),r&&this.resume()}displayDuration(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}start(){Y(n.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),Ae.assert(this.isSet,"Should not start a chrono that has not been set!"),Ae.assert(!1===this.started,"Should not start chrono that has already been started ("+this.debugName+")"),this.started=!0,this.resume()}resume(){Y(n.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),Ae.assert(this.isPaused&&this.started,"Should only resume chrono that are started and paused!"),this.startTime=Date.now();const e=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(()=>{this.onEndReached()},e),this.countSeconds()}onEndReached(){Y(n.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}countSeconds(){this.timeoutHandleSec=window.setTimeout(()=>{this.updateShownTime()},1e3)}isIdle(){return!1===this.started||this.isPaused}pause(){Y(n.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),Ae.assert(this.started,"Should not pause not started chrono ("+this.debugName+")"),Ae.assert(!1===this.isPaused,"Should not pause already paused chrono ("+this.debugName+")"),this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}stop(){Y(n.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),Ae.assert(this.started,"Should only stop chrono that are started!"),this.pause(),this.started=!1,this.isSet=!1}isStarted(){return this.started}getTimeClass(){return!1===this.active?n.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?n.DANGER_TIME_ODD:n.DANGER_TIME_EVEN:n.SAFE_TIME}updateShownTime(){const e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}clearTimeouts(){Y(n.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}addTime(){this.addTimeToOpponent.emit()}ngOnDestroy(){this.clearTimeouts()}}return n.VERBOSE=!1,n.DANGER_TIME_EVEN="has-background-danger has-text-white",n.DANGER_TIME_ODD="has-background-warning has-text-white",n.PASSIVE_STYLE="has-text-passive is-italic",n.SAFE_TIME="",n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=vt({type:n,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){let t;return t=$localize`Add ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],t]},template:function(e,r){1&e&&(N(0,"div",0)(1,"p",1),Et(2),Ga(3,"number"),A(),k(4,q8t,2,1,"button",2),A()),2&e&&(w("ngClass",r.getTimeClass()),M(2),oC("",r.displayedMinute,":",$B(3,4,r.displayedSec,"2.0-0"),""),M(2),w("ngIf",r.canAddTime))},dependencies:[On,hn,pU],encapsulation:2}),n})();const Z8t=["partCreation"],Y8t=["chatComponent"],K8t=["chronoZeroGlobal"],X8t=["chronoOneGlobal"],Q8t=["chronoZeroTurn"],J8t=["chronoOneTurn"];function e5t(n,t){if(1&n){const e=we();N(0,"app-part-creation",5,6),se("gameStartNotification",function(s){return he(e),ce(E().startGame(s))}),A()}2&n&&w("partId",E().currentPartId)}function t5t(n,t){1&n&&(nn(0),de(1,41),rn())}function n5t(n,t){if(1&n&&(nn(0),de(1,42),rn()),2&n){const e=E(4);M(1),w1(null==e.currentPlayer?null:e.currentPlayer.name),k1(1)}}function r5t(n,t){if(1&n&&(N(0,"p",38),k(1,t5t,2,0,"ng-container",39),k(2,n5t,2,1,"ng-template",null,40,l1),A()),2&n){const e=s1(3),r=E(3);M(1),w("ngIf",(null==r.currentPlayer?null:r.currentPlayer.name)===r.getPlayer().name)("ngIfElse",e)}}function s5t(n,t){if(1&n&&(N(0,"div",34)(1,"p",35),de(2,36),A(),k(3,r5t,4,2,"p",37),A()),2&n){const e=E(2);M(2),w1(e.currentPart.getTurn()+1),k1(2),M(1),w("ngIf",!1===e.endGame)}}function i5t(n,t){if(1&n&&(N(0,"p",43),Et(1),A()),2&n){const e=E(2);w("ngClass",e.getPlayerNameClass(e.Player.ZERO)),M(1),jn(e.players[0].get().name)}}function o5t(n,t){if(1&n&&(N(0,"p",44),de(1,45),A()),2&n){const e=E(2);M(1),w1(e.gameComponent.scores.get()[0]),k1(1)}}function a5t(n,t){if(1&n&&(N(0,"p",46),Et(1),A()),2&n){const e=E(2);w("ngClass",e.getPlayerNameClass(e.Player.ONE)),M(1),jn(e.players[1].get().name)}}function c5t(n,t){if(1&n&&(N(0,"p",47),de(1,48),A()),2&n){const e=E(2);M(1),w1(e.gameComponent.scores.get()[1]),k1(1)}}function l5t(n,t){if(1&n){const e=we();N(0,"button",57),se("click",function(){return he(e),ce(E(3).resign())}),de(1,58),A()}}function u5t(n,t){if(1&n){const e=we();N(0,"button",59),se("click",function(){return he(e),ce(E(3).proposeDraw())}),de(1,60),A()}}function f5t(n,t){if(1&n){const e=we();N(0,"button",61),se("click",function(){return he(e),ce(E(3).acceptDraw())}),de(1,62),A()}}function h5t(n,t){if(1&n){const e=we();N(0,"button",63),se("click",function(){return he(e),ce(E(3).refuseDraw())}),de(1,64),A()}}function d5t(n,t){if(1&n){const e=we();N(0,"button",65),se("click",function(){return he(e),ce(E(3).gameComponent.pass())}),de(1,66),A()}}function p5t(n,t){if(1&n){const e=we();N(0,"button",67),se("click",function(){return he(e),ce(E(3).acceptTakeBack())}),de(1,68),A()}}function g5t(n,t){if(1&n){const e=we();N(0,"button",69),se("click",function(){return he(e),ce(E(3).refuseTakeBack())}),de(1,70),A()}}function m5t(n,t){if(1&n){const e=we();N(0,"button",71),se("click",function(){return he(e),ce(E(3).askTakeBack())}),de(1,72),A()}}function _5t(n,t){if(1&n&&(nn(0),k(1,l5t,2,0,"button",49),k(2,u5t,2,0,"button",50),k(3,f5t,2,0,"button",51),k(4,h5t,2,0,"button",52),k(5,d5t,2,0,"button",53),k(6,p5t,2,0,"button",54),k(7,g5t,2,0,"button",55),k(8,m5t,2,0,"button",56),rn()),2&n){const e=E(2);M(1),w("ngIf",e.canResign()),M(1),w("ngIf",e.canProposeDraw()),M(1),w("ngIf",!1===e.endGame&&e.isOpponentWaitingForDrawResponse()),M(1),w("ngIf",!1===e.endGame&&e.isOpponentWaitingForDrawResponse()),M(1),w("ngIf",!1===e.endGame&&e.isPlaying()&&e.gameComponent.canPass&&(null==e.currentPlayer?null:e.currentPlayer.name)===e.getPlayer().name),M(1),w("ngIf",!1===e.endGame&&e.isOpponentWaitingForTakeBackResponse()),M(1),w("ngIf",!1===e.endGame&&e.isOpponentWaitingForTakeBackResponse()),M(1),w("ngIf",!1===e.endGame&&!1===e.isOpponentWaitingForTakeBackResponse()&&e.canAskTakeBack())}}function v5t(n,t){1&n&&(N(0,"div")(1,"p",74),de(2,75),A()())}function C5t(n,t){1&n&&(N(0,"p",79),de(1,80),A())}function y5t(n,t){1&n&&(N(0,"p",81),de(1,82),A())}function E5t(n,t){1&n&&(N(0,"p",83),de(1,84),A())}function M5t(n,t){if(1&n&&(N(0,"div"),k(1,C5t,2,0,"p",76),k(2,y5t,2,0,"p",77),k(3,E5t,2,0,"p",78),A()),2&n){const e=E(3);M(1),w("ngIf",e.currentPart.getDrawAccepter().name===e.getPlayer().name),M(1),w("ngIf",e.currentPart.getDrawAccepter().name!==e.getPlayer().name&&e.isPlaying()),M(1),w("ngIf",!1===e.isPlaying())}}function S5t(n,t){1&n&&(N(0,"p",88),de(1,89),A())}function P5t(n,t){1&n&&(N(0,"p",90),de(1,91),A())}function T5t(n,t){if(1&n&&(N(0,"p",92),de(1,93),A()),2&n){const e=E(4);M(1),w1(e.currentPart.getWinner().get().name),k1(1)}}function w5t(n,t){if(1&n&&(N(0,"div"),k(1,S5t,2,0,"p",85),k(2,P5t,2,0,"p",86),k(3,T5t,2,1,"p",87),A()),2&n){const e=E(3);M(1),w("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),M(1),w("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),M(1),w("ngIf",!1===e.isPlaying())}}function b5t(n,t){if(1&n&&(N(0,"p",88),de(1,94),A()),2&n){const e=E(4);M(1),w1(e.currentPart.getLoser().get().name),k1(1)}}function N5t(n,t){1&n&&(N(0,"p",92),de(1,95),A())}function A5t(n,t){if(1&n&&(N(0,"p",92),de(1,96),A()),2&n){const e=E(4);M(1),w1(e.currentPart.getLoser().get().name),k1(1)}}function O5t(n,t){if(1&n&&(N(0,"div"),k(1,b5t,2,1,"p",85),k(2,N5t,2,0,"p",87),k(3,A5t,2,1,"p",87),A()),2&n){const e=E(3);M(1),w("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),M(1),w("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),M(1),w("ngIf",!1===e.isPlaying())}}function I5t(n,t){1&n&&(N(0,"p",98),de(1,99),A())}function x5t(n,t){if(1&n&&(N(0,"p",98),de(1,100),A()),2&n){const e=E(4);M(1),w1(e.currentPart.getLoser().get().name),k1(1)}}function L5t(n,t){if(1&n&&(N(0,"div"),k(1,I5t,2,0,"p",97),k(2,x5t,2,1,"p",97),A()),2&n){const e=E(3);M(1),w("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),M(1),w("ngIf",!1===e.isPlaying()||e.currentPart.getWinner().get().name===e.getPlayer().name)}}function k5t(n,t){if(1&n&&(N(0,"div",73),X(1,"hr"),k(2,v5t,3,0,"div",26),k(3,M5t,4,3,"div",26),k(4,w5t,4,3,"div",26),k(5,O5t,4,3,"div",26),k(6,L5t,3,2,"div",26),A()),2&n){const e=E(2);M(2),w("ngIf",e.currentPart.isHardDraw()),M(1),w("ngIf",e.currentPart.isAgreedDraw()),M(1),w("ngIf",e.currentPart.isWin()),M(1),w("ngIf",e.currentPart.isTimeout()),M(1),w("ngIf",e.currentPart.isResign())}}function R5t(n,t){1&n&&(N(0,"button",101),de(1,102),A())}function D5t(n,t){if(1&n){const e=we();N(0,"button",103),se("click",function(){return he(e),ce(E(2).proposeRematch())}),de(1,104),A()}}function z5t(n,t){if(1&n){const e=we();N(0,"button",105),se("click",function(){return he(e),ce(E(2).acceptRematch())}),de(1,106),A()}}function V5t(n,t){if(1&n){const e=we();N(0,"div",7)(1,"div",8)(2,"div",9),k(3,s5t,4,2,"div",10),N(4,"div",11),k(5,i5t,2,2,"p",12),k(6,o5t,2,1,"p",13),N(7,"app-count-down",14,15),se("outOfTimeAction",function(){he(e);const s=E();return ce(s.reachedOutOfTime(s.Player.ZERO))})("addTimeToOpponent",function(){return he(e),ce(E().addGlobalTime())}),A(),N(9,"app-count-down",16,17),se("outOfTimeAction",function(){he(e);const s=E();return ce(s.reachedOutOfTime(s.Player.ZERO))})("addTimeToOpponent",function(){return he(e),ce(E().addTurnTime())}),A()(),N(11,"p",18),de(12,19),A(),N(13,"div",11),k(14,a5t,2,2,"p",20),k(15,c5t,2,1,"p",21),N(16,"app-count-down",22,23),se("outOfTimeAction",function(){he(e);const s=E();return ce(s.reachedOutOfTime(s.Player.ONE))})("addTimeToOpponent",function(){return he(e),ce(E().addGlobalTime())}),A(),N(18,"app-count-down",24,25),se("outOfTimeAction",function(){he(e);const s=E();return ce(s.reachedOutOfTime(s.Player.ONE))})("addTimeToOpponent",function(){return he(e),ce(E().addTurnTime())}),A()(),X(20,"hr"),k(21,_5t,9,8,"ng-container",26),k(22,k5t,7,5,"div",27),k(23,R5t,2,0,"button",28),k(24,D5t,2,0,"button",29),k(25,z5t,2,0,"button",30),A()(),N(26,"div",31)(27,"div",32),X(28,"div",null,33),A()()()}if(2&n){const e=E();M(3),w("ngIf",null!==e.currentPart),M(2),w("ngIf",e.players[0].isPresent()),M(1),w("ngIf",null!==e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),M(1),w("dangerTimeLimit",6e4)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.role===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),M(2),w("dangerTimeLimit",15e3)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.role===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),M(5),w("ngIf",e.players[1].isPresent()),M(1),w("ngIf",null!==e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),M(1),w("dangerTimeLimit",6e4)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.role===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),M(2),w("dangerTimeLimit",15e3)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.role===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),M(3),w("ngIf",e.isPlaying()),M(1),w("ngIf",e.endGame&&null!==e.currentPart),M(1),w("ngIf",e.endGame),M(1),w("ngIf",e.endGame&&e.isPlaying()&&!1===e.rematchProposed),M(1),w("ngIf",e.endGame&&e.isPlaying()&&e.rematchProposed&&e.opponentProposedRematch),M(1),w("ngClass",e.getBoardHighlight())}}let H5t=(()=>{class n{}return n.NO_MATCHING_PART=()=>$localize`The game you tried to join does not exist.`,n})();class zn{constructor(t){this.value=t}}zn.PRE_START_DOC=new zn("PRE_START_DOC"),zn.STARTING_DOC=new zn("STARTING_DOC"),zn.DUPLICATE=new zn("DUPLICATE"),zn.MOVE_WITHOUT_TIME=new zn("MOVE_WITHOUT_TIME"),zn.MOVE=new zn("MOVE"),zn.REQUEST=new zn("REQUEST"),zn.END_GAME=new zn("END_GAME"),zn.END_GAME_WITHOUT_TIME=new zn("END_GAME_WITHOUT_TIME"),zn.ACCEPT_TAKE_BACK_WITHOUT_TIME=new zn("ACCEPT_TAKE_BACK_WITHOUT_TIME");let F5t=(()=>{class n extends JS{constructor(e,r,s,i,o,c,u,h){super(e,r,s,i,o),this.observedPartService=c,this.userService=u,this.gameService=h,this.currentPart=null,this.gameStarted=!1,this.opponent=null,this.currentPlayer=null,this.rematchProposed=!1,this.opponentProposedRematch=!1,this.userLinkedToThisPart=!0,this.observedPart=S.empty(),this.hasUserPlayed=[!1,!1],this.msToSubstract=[0,0],this.opponentSubscription=new H1,this.partSubscription=new H1,this.observedPartSubscription=new H1,this.OFFLINE_FONT_COLOR={color:"lightgrey"},this.globalTimeMessage=$localize`5 minutes`,this.turnTimeMessage=$localize`30 seconds`,this.onCurrentUpdateOngoing=!1,Y(n.VERBOSE,"OnlineGameWrapperComponent constructed")}extractPartIdFromURL(){return Ae.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}extractGameNameFromURL(){return Ae.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}isPlaying(){return this.role.isPlayer()}getPlayer(){return this.authUser.toMinimalUser()}isPlayer(e){return this.role===e}redirectIfPartOrGameIsInvalid(){var e=this;return O(function*(){const r=e.extractGameNameFromURL();if(Qf.ALL_GAMES().some(i=>i.urlName===r)){if((yield e.gameService.getPartValidity(e.currentPartId,r)).isFailure()){e.routerEventsSubscription.unsubscribe();const o=H5t.NO_MATCHING_PART();yield e.router.navigate(["/notFound",o],{skipLocationChange:!0})}}else{e.routerEventsSubscription.unsubscribe();const i=Jf.NO_MATCHING_GAME(r);yield e.router.navigate(["/notFound",i],{skipLocationChange:!0})}})()}setCurrentPartIdOrRedirect(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}ngOnInit(){var e=this;return O(function*(){Y(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),e.routerEventsSubscription=e.router.events.subscribe(function(){var r=O(function*(s){s instanceof F6&&(yield e.setCurrentPartIdOrRedirect())});return function(s){return r.apply(this,arguments)}}()),e.userSubscription=e.connectedUserService.subscribeToUser(r=>{e.authUser=r}),yield e.setCurrentPartIdOrRedirect(),e.observedPartSubscription=e.observedPartService.subscribeToObservedPart(function(){var r=O(function*(s){yield e.onObservedPartUpdate(s)});return function(s){return r.apply(this,arguments)}}()),Y(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit done")})()}onObservedPartUpdate(e){var r=this;return O(function*(){if(Y(n.VERBOSE,"OnlineGameWrapperComponent.onObservedPartUpdate called"),e.isPresent()){const s=e.get();"Observer"===s.role||s.id===r.currentPartId?r.observedPart=e:(r.userLinkedToThisPart=!1,yield r.router.navigate(["/lobby"]))}else r.observedPart=S.empty()})()}getObservedPart(){return this.observedPart}startGame(e){var r=this;return O(function*(){Y(n.VERBOSE,"OnlineGameWrapperComponent.startGame"),Se(!1===r.gameStarted,"Should not start already started game"),r.configRoom=e,r.gameStarted=!0,window.setTimeout(O(function*(){Se(yield r.afterViewInit(),"Game should be created successfully, otherwise part-creation would have redirected"),r.startPart()}),2)})()}startPart(){var e=this;Y(n.VERBOSE,"OnlineGameWrapperComponent.startPart"),this.partSubscription=this.gameService.subscribeToChanges(this.currentPartId,function(){var r=O(function*(s){Se(s.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),yield e.onCurrentPartUpdate(s.get())});return function(s){return r.apply(this,arguments)}}())}onCurrentPartUpdate(e,r=5){var s=this;return O(function*(){const i=new DM(s.currentPartId,e);if(Y(n.VERBOSE,{OnlineGameWrapperComponent_onCurrentPartUpdate:{before:s.currentPart,then:e,before_part_turn:i.data.turn,before_state_turn:s.gameComponent.rules.node.gameState.turn,nbPlayedMoves:i.data.listMoves.length}}),s.onCurrentUpdateOngoing)return Se((r-=1)>0,"Update took more than 5sec to be handled by the component!"),void window.setTimeout(O(function*(){yield s.onCurrentPartUpdate(e,r)}),1e3);s.onCurrentUpdateOngoing=!0;const o=s.getUpdateTypes(i),c=e.turn;o.includes(zn.REQUEST)?Y(n.VERBOSE,"UpdateType: Request("+Ae.getNonNullable(i.data.request).code+") ("+c+")"):Y(n.VERBOSE,"UpdateType: "+o.map(h=>h.value)+"("+c+")");const u=s.currentPart;s.currentPart=i;for(const h of o)yield s.applyUpdate(h,i,u);s.onCurrentUpdateOngoing=!1})()}applyUpdate(e,r,s){var i=this;return O(function*(){switch(e){case zn.REQUEST:return yield i.onRequest(Ae.getNonNullable(r.data.request),s);case zn.ACCEPT_TAKE_BACK_WITHOUT_TIME:return void(i.currentPart=s);case zn.DUPLICATE:return;case zn.END_GAME_WITHOUT_TIME:return void(i.currentPart=s);case zn.END_GAME:return i.applyEndGame();case zn.MOVE_WITHOUT_TIME:const o=Ae.getNonNullable(i.currentPart),c=Ae.getNonNullable(s);return void(o.data={...o.data,turn:o.data.turn-1,lastUpdate:c.data.lastUpdate,lastUpdateTime:c.data.lastUpdateTime,listMoves:o.data.listMoves.slice(0,o.data.listMoves.length-1)});case zn.MOVE:return i.msToSubstract=i.getLastUpdateTime(s,r),i.doNewMoves(r);case zn.PRE_START_DOC:return;default:return Se(e===zn.STARTING_DOC,"Unexpected update type "+e),i.startCountDown(r)}})()}startCountDown(e){var r=this;return O(function*(){r.setChronos(),yield r.setPlayersDatas(e),r.startCountDownFor(0===e.data.listMoves.length?F.ZERO:F.fromTurn(e.data.turn-1))})()}getUpdateTypes(e){const r=null!=this.currentPart?this.currentPart.data:null,s=eh.from(r,e.data),i=[];if(Y(n.VERBOSE,{currentPartDoc:r,update:e,diff:s}),0===s.countChanges()&&i.push(zn.DUPLICATE),s.isFullyCreated()&&s.isPresent("beginning").present&&i.push(zn.STARTING_DOC),e.data.request){const c=null!=s.removed.lastUpdateTime;i.push("TakeBackAccepted"===e.data.request.code&&c?zn.ACCEPT_TAKE_BACK_WITHOUT_TIME:zn.REQUEST)}if(null==r?"added"===s.isPresent("listMoves").state&&e.data.turn>0&&i.push(this.getMoveUpdateType(e,s)):this.turnHasIncreased(r.turn,e.data.turn,e.data.listMoves)&&i.push(this.getMoveUpdateType(e,s)),null==e.data.beginning&&i.push(zn.PRE_START_DOC),s.isPresent("result").present&&e.data.result!==Nn.UNACHIEVED.value){const c=null!=s.modified.turn,u=!1===s.addedOrModified("lastUpdateTime");i.push(c&&u?zn.END_GAME_WITHOUT_TIME:zn.END_GAME)}return i}getMoveUpdateType(e,r){return 1===e.data.turn?null==e.data.lastUpdateTime?zn.MOVE_WITHOUT_TIME:zn.MOVE:null==r.modified.lastUpdateTime&&null==r.added.lastUpdateTime?zn.MOVE_WITHOUT_TIME:zn.MOVE}turnHasIncreased(e,r,s){return Se(s.length===r,"ListMoves size and newTurn do not match, it is impossible!"),e<r}getLastUpdateTime(e,r){if(null==e)return[0,0];const s=this.getMoreRecentTime(e),i=this.getMoreRecentTime(r);Se(null!=s,"oldTime should not be null"),Se(null!=i,"updateTime should not be null");const o=F.fromTurn(e.data.turn);return this.getTimeUsedForLastTurn(Ae.getNonNullable(s),Ae.getNonNullable(i),o)}getMoreRecentTime(e){return e.data.lastUpdateTime??e.data.beginning}getTimeUsedForLastTurn(e,r,s){const i=Fce(e,r),o=[0,0];return o[s.value]=i,o}setChronos(){Y(n.VERBOSE,"onlineGameWrapperComponent.setChronos()"),this.chronoZeroGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoOneGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoZeroTurn.setDuration(1e3*this.configRoom.maximalMoveDuration),this.chronoOneTurn.setDuration(1e3*this.configRoom.maximalMoveDuration)}didUserPlay(e){return this.hasUserPlayed[e.value]}doNewMoves(e){Y(n.VERBOSE,"OnlineGameWrapperComponent.doNewMoves"+JSON.stringify(e)),this.switchPlayer();const r=ht.copyImmutableArray(e.data.listMoves),s=this.gameComponent.rules;for(;this.gameComponent.getTurn()<r.length;){const i=this.gameComponent.getTurn(),o=this.gameComponent.encoder.decode(r[i]),c=s.isLegal(o,this.gameComponent.getState()),u="We received an incorrect db move: "+o.toString()+" in "+r+" at turn "+i+'because "'+c.getReasonOr("")+'"';Se(c.isSuccess(),u),s.choose(o)}this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get(),this.gameComponent.updateBoard()}switchPlayer(){Y(n.VERBOSE,"OnlineGameWrapperComponent.switchPlayer");const e=Ae.getNonNullable(this.currentPart),r=F.fromTurn(e.data.turn);this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get();const s=r.getOpponent();this.pauseCountDownsFor(s),this.didUserPlay(r)?(Y(n.VERBOSE,"OnlineGameWrapperComponent.onCurrentPartUpdate: changing current player"),this.resumeCountDownFor(r)):this.startCountDownFor(r)}resetChronoFor(e){this.pauseCountDownsFor(e),this.resumeCountDownFor(e)}applyEndGame(){var e=this;return O(function*(){yield e.observedPartService.removeObservedPart();const r=Ae.getNonNullable(e.currentPart),s=F.fromTurn(r.data.turn);if(e.endGame=!0,!1===[Nn.VICTORY,Nn.HARD_DRAW].some(c=>c.value===r.data.result)){Se(!0===[Nn.RESIGN,Nn.TIMEOUT,Nn.HARD_DRAW,Nn.AGREED_DRAW_BY_ZERO,Nn.AGREED_DRAW_BY_ONE].some(g=>g.value===r.data.result),"Unknown type of end game ("+r.data.result+")");const h="endGame is true and winner is "+r.getWinner().getOrElse({id:"fake",name:"no one"}).name;Y(n.VERBOSE,h)}e.stopCountdownsFor(s)})()}notifyDraw(e,r){return this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,e,[0,0],r,!0)}notifyTimeoutVictory(e,r,s,i){var o=this;return O(function*(){o.endGame=!0;const c=Ae.getNonNullable(o.currentPart).setWinnerAndLoser(e,i);o.currentPart=c,yield o.gameService.notifyTimeout(o.currentPartId,r,s,e,i)})()}notifyVictory(e,r){Y(n.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");const s=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node),i=Ae.getNonNullable(this.currentPart),o=this.players[0].get(),c=this.players[1].get();return s===ze.ONE_WON?this.currentPart=i.setWinnerAndLoser(c,o):(Se(s===ze.ZERO_WON,"impossible to get a victory without winner!"),this.currentPart=i.setWinnerAndLoser(o,c)),this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,e,[0,0],r,!1,this.currentPart.getWinner().get(),this.currentPart.getLoser().get())}canAskTakeBack(){Se(this.isPlaying(),"Non playing should not call canAskTakeBack"),Se(null!=this.currentPart,"should not call canAskTakeBack when currentPart is not defined yet");const e=Ae.getNonNullable(this.currentPart);return!(e.data.turn<=this.role.value||e.data.request&&"TakeBackRefused"===e.data.request.code&&this.role.isPlayer()&&e.data.request.data.player===this.role.getOpponent().value)&&this.getTakeBackRequester()===fe.NONE}isOpponentWaitingForTakeBackResponse(){const e=this.getTakeBackRequester();return!!e.isPlayer()&&e!==this.role}getTakeBackRequester(){const r=Ae.getNonNullable(this.currentPart).data.request;return r&&"TakeBackAsked"===r.code?Rr.getPlayer(r):fe.NONE}canProposeDraw(){Se(this.isPlaying(),"Non playing should not call canProposeDraw");const e=Ae.getNonNullable(this.currentPart);return!(this.endGame||e.data.request&&"DrawRefused"===e.data.request.code&&this.role.isPlayer()&&Rr.getPlayer(e.data.request)===this.role.getOpponent()||this.isOpponentWaitingForDrawResponse())&&this.getDrawRequester()===fe.NONE}isOpponentWaitingForDrawResponse(){const e=this.getDrawRequester();return e!==fe.NONE&&e!==this.role}getDrawRequester(){const r=Ae.getNonNullable(this.currentPart).data.request;return r&&"DrawProposed"===r.code?Rr.getPlayer(r):fe.NONE}onRequest(e,r){var s=this;return O(function*(){switch(Y(n.VERBOSE,{called:"OnlineGameWrapper.onRequest(",request:e,oldPart:r}),e.code){case"TakeBackAsked":case"TakeBackRefused":case"DrawProposed":case"DrawRefused":break;case"TakeBackAccepted":s.takeBackTo(Ae.getNonNullable(s.currentPart).data.turn);break;case"RematchProposed":s.rematchProposed=!0;const i=Rr.getPlayer(e).getOpponent();s.isPlayer(i)&&(Y(n.VERBOSE,"ton adversaire te propose une revanche"),s.opponentProposedRematch=!0);break;case"RematchAccepted":yield s.router.navigate(["/nextGameLoading"]),yield s.router.navigate(["/play",Rr.getTypeGame(e),Rr.getPartId(e)]);break;case"AddTurnTime":const o=3e4,c=F.of(e.data.player);s.addTurnTimeTo(c,o);break;default:Ae.expectToBe(e.code,"AddGlobalTime","Unknown RequestType : "+e.code+" for "+JSON.stringify(e));const u=3e5,h=F.of(e.data.player);s.addGlobalTimeTo(h,u)}})()}takeBackTo(e){if(Y(n.VERBOSE,"OnlineGameWrapperComponent.takeBackTo"),this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.gameComponent.getTurn()===e)this.switchPlayer();else{this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get();const r=F.fromTurn(e);this.resetChronoFor(r)}this.gameComponent.updateBoard()}setPlayersDatas(e){var r=this;return O(function*(){Y(n.VERBOSE,{OnlineGameWrapper_setPlayersDatas:e}),r.players=[S.of(e.data.playerZero),S.ofNullable(e.data.playerOne)],Se(null!=e.data.playerOne,"should not setPlayersDatas when players data is not received"),r.currentPlayer=r.players[e.data.turn%2].get();const s=yield r.setRealObserverRole();if(s.isPresent()){const i=o=>{Se(o.isPresent(),"opponent was deleted, what sorcery is this"),r.opponent=s.get()};r.opponentSubscription=r.userService.observeUser(s.get().id,i)}})()}setRealObserverRole(){var e=this;return O(function*(){let r=S.empty();return e.players[0].equalsValue(e.getPlayer())?(e.setRole(F.ZERO),r=e.players[1]):e.players[1].equalsValue(e.getPlayer())?(e.setRole(F.ONE),r=e.players[0]):e.setRole(fe.NONE),yield e.observedPartService.updateObservedPart({...e.observedPart.get(),role:e.role===fe.NONE?"Observer":"Player"}),r})()}onLegalUserMove(e,r){var s=this;return O(function*(){if(Y(n.VERBOSE,"dans OnlineGameWrapperComponent.onLegalUserMove"),!s.isOpponentWaitingForTakeBackResponse())return s.updateDBBoard(e,s.msToSubstract,r);s.gameComponent.message("You must answer to take back request")})()}updateDBBoard(e,r,s){var i=this;return O(function*(){const o=i.gameComponent.encoder.encodeMove(e);Y(n.VERBOSE,"OnlineGameWrapperComponent.updateDBBoard("+e.toString()+", "+s+")"),i.gameComponent.rules.choose(e);const c=i.gameComponent.rules.getGameStatus(i.gameComponent.rules.node);return c.isEndGame?c===ze.DRAW?i.notifyDraw(o,s):i.notifyVictory(o,s):i.gameService.updateDBBoard(i.currentPartId,i.role,o,r,s)})()}resign(){var e=this;return O(function*(){Y(n.VERBOSE,"OnlineGameWrapperComponent.resign");const r=e.getLastIndex(),s=e.role,i=e.getPlayer(),o=e.players[(e.role.value+1)%2].get();yield e.gameService.resign(e.currentPartId,r,s,o,i)})()}getLastIndex(){return Ae.getNonNullable(this.currentPart).data.lastUpdate.index}reachedOutOfTime(e){var r=this;return O(function*(){Y(n.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+e+")");const s=r.getLastIndex(),i=r.role;if(r.stopCountdownsFor(e),!1===r.isPlaying())return;const o=Ae.getNonNullable(r.opponent);e===r.role?yield r.notifyTimeoutVictory(o,i,s,r.authUser.toMinimalUser()):(Se(!1===r.endGame,"time might be better handled in the future"),r.opponentIsOffline()&&(yield r.notifyTimeoutVictory(r.authUser.toMinimalUser(),i,e.value,o),r.endGame=!0))})()}acceptRematch(){var e=this;return O(function*(){Se(e.isPlaying(),"Non playing should not call acceptRematch");const r=new DM(e.currentPartId,Ae.getNonNullable(e.currentPart).data);return yield e.gameService.acceptRematch(r,e.getLastIndex(),e.role),!0})()}proposeRematch(){var e=this;return O(function*(){return Se(e.isPlaying(),"Non playing should not call proposeRematch"),yield e.gameService.proposeRematch(e.currentPartId,e.getLastIndex(),e.role),!0})()}proposeDraw(){return Se(this.isPlaying(),"Non playing should not call proposeDraw"),this.gameService.proposeDraw(this.currentPartId,this.getLastIndex(),this.role)}acceptDraw(){return Se(this.isPlaying(),"Non playing should not call acceptDraw"),this.gameService.acceptDraw(this.currentPartId,this.getLastIndex(),this.role)}refuseDraw(){return Se(this.isPlaying(),"Non playing should not call refuseDraw"),this.gameService.refuseDraw(this.currentPartId,this.getLastIndex(),this.role)}askTakeBack(){return Se(this.isPlaying(),"Non playing should not call askTakeBack"),this.gameService.askTakeBack(this.currentPartId,this.getLastIndex(),this.role)}acceptTakeBack(){var e=this;return O(function*(){Se(e.isPlaying(),"Non playing should not call acceptTakeBack");const r=e.role;yield e.gameService.acceptTakeBack(e.currentPartId,Ae.getNonNullable(e.currentPart),r,e.msToSubstract),e.msToSubstract=[0,0]})()}refuseTakeBack(){return Se(this.isPlaying(),"Non playing should not call refuseTakeBack"),this.gameService.refuseTakeBack(this.currentPartId,this.getLastIndex(),this.role)}startCountDownFor(e){Y(n.VERBOSE,"dans OnlineGameWrapperComponent.startCountDownFor("+e.toString()+") (turn "+Ae.getNonNullable(this.currentPart).data.turn+")"),this.hasUserPlayed[e.value]=!0,e===F.ZERO?(this.chronoZeroGlobal.start(),this.chronoZeroTurn.start()):(this.chronoOneGlobal.start(),this.chronoOneTurn.start())}resumeCountDownFor(e,r=!0){let s;Y(n.VERBOSE,"dans OnlineGameWrapperComponent.resumeCountDownFor("+e.toString()+") (turn "+Ae.getNonNullable(this.currentPart).data.turn+")"),e===F.ZERO?(this.chronoZeroGlobal.changeDuration(Ae.getNonNullable(this.currentPart?.data.remainingMsForZero)),this.chronoZeroGlobal.resume(),s=this.chronoZeroTurn):(this.chronoOneGlobal.changeDuration(Ae.getNonNullable(this.currentPart?.data.remainingMsForOne)),this.chronoOneGlobal.resume(),s=this.chronoOneTurn),r?(s.setDuration(1e3*this.configRoom.maximalMoveDuration),s.start()):s.resume()}pauseCountDownsFor(e,r=!0){let s;Y(n.VERBOSE,"dans OnlineGameWrapperComponent.pauseCountDownFor("+e.value+") (turn "+this.currentPart?.data.turn+")"),e===F.ZERO?(this.chronoZeroGlobal.pause(),s=this.chronoZeroTurn):(this.chronoOneGlobal.pause(),s=this.chronoOneTurn),r?s.stop():s.pause()}stopCountdownsFor(e){Y(n.VERBOSE,"cdc::stopCountDownsFor("+e.toString()+") (turn "+this.currentPart?.data.turn+")"),e===F.ZERO?(this.chronoZeroGlobal.isStarted()&&this.chronoZeroGlobal.stop(),this.chronoZeroTurn.isStarted()&&this.chronoZeroTurn.stop()):(this.chronoOneGlobal.isStarted()&&this.chronoOneGlobal.stop(),this.chronoOneTurn.isStarted()&&this.chronoOneTurn.stop())}getPlayerNameClass(e){return this.opponentIsOffline()?"has-text-grey-light":e===F.ZERO?"has-text-white":"has-text-black"}opponentIsOffline(){return!1}canResign(){return Se(this.isPlaying(),"Non playing should not call canResign"),!0!==this.endGame&&null!=this.opponent}addGlobalTime(){const e=this.role,r=this.getLastIndex();return this.gameService.addGlobalTime(this.currentPartId,r,Ae.getNonNullable(this.currentPart).data,e)}addTurnTime(){return this.gameService.addTurnTime(this.role,this.getLastIndex(),this.currentPartId)}addTurnTimeTo(e,r){const s=F.fromTurn(Ae.getNonNullable(this.currentPart).getTurn());this.pauseCountDownsFor(s,!1),e===F.ZERO?this.chronoZeroTurn.changeDuration(this.chronoZeroTurn.remainingMs+r):this.chronoOneTurn.changeDuration(this.chronoOneTurn.remainingMs+r),this.resumeCountDownFor(s,!1)}addGlobalTimeTo(e,r){e===F.ZERO?this.chronoZeroGlobal.changeDuration(this.chronoZeroGlobal.remainingMs+r):this.chronoOneGlobal.changeDuration(this.chronoOneGlobal.remainingMs+r)}ngOnDestroy(){var e=this;return O(function*(){Y(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy"),e.routerEventsSubscription.unsubscribe(),e.userSubscription.unsubscribe(),e.observedPartSubscription.unsubscribe(),!1===e.isPlaying()&&e.userLinkedToThisPart&&(yield e.observedPartService.removeObservedPart()),!0===e.gameStarted&&(e.opponentSubscription.unsubscribe(),e.partSubscription.unsubscribe()),Y(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy finished")})()}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(ra),Q(Qi),Q(Es),Q($n),Q(In),Q(li),Q(Ng),Q(VM))},n.\u0275cmp=vt({type:n,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,r){if(1&e&&(V3(Z8t,5),V3(Y8t,5),V3(K8t,5),V3(X8t,5),V3(Q8t,5),V3(J8t,5)),2&e){let s;Wa(s=qa())&&(r.partCreation=s.first),Wa(s=qa())&&(r.chatComponent=s.first),Wa(s=qa())&&(r.chronoZeroGlobal=s.first),Wa(s=qa())&&(r.chronoOneGlobal=s.first),Wa(s=qa())&&(r.chronoZeroTurn=s.first),Wa(s=qa())&&(r.chronoOneTurn=s.first)}},features:[l],decls:5,vars:4,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,v,T,I,z,Z,te,me,J,Ne,He,qe,Dt,A1,M1,Yr,dc,go,di;return t=$localize`vs.`,e=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,r=$localize`It is your turn.`,s=$localize`It is ${"\ufffd0\ufffd"}:INTERPOLATION:'s turn.`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,c=$localize`Resign`,u=$localize`Propose a draw`,h=$localize`Accept draw`,g=$localize`Reject draw`,m=$localize`Pass a turn`,v=$localize`Accept take back`,T=$localize`Reject take back`,I=$localize`Ask to take back one move`,z=$localize`Draw`,Z=$localize`You agreed to draw.`,te=$localize`Your draw proposal has been accepted.`,me=$localize`Players agreed to draw.`,J=$localize`You won.`,Ne=$localize`You lost.`,He=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won.`,qe=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit. You won.`,Dt=$localize`You reached your time limit.`,A1=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit.`,M1=$localize`You resigned.`,Yr=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has resigned.`,dc=$localize`Go back to the game list`,go=$localize`Propose to play again`,di=$localize`Accept to play again`,[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],t,["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],[4,"ngIf"],["class","block","id","winnerIndicator",4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","proposeRematchButton","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["class","button is-fullwidth is-warning","id","acceptRematchButton",3,"click",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","turnIndicator",1,"block"],[1,"subtitle"],e,["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],r,s,["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],i,["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],o,["class","button is-fullwidth mb-1","id","resignButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","proposeDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","refuseDrawButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","passButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptTakeBackButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","color","warn","id","refuseTakeBackButton",3,"click",4,"ngIf"],["class","button is-fullwidth","id","askTakeBackButton",3,"click",4,"ngIf"],["id","resignButton",1,"button","is-fullwidth","mb-1",3,"click"],c,["id","proposeDrawButton",1,"button","is-fullwidth","mb-1",3,"click"],u,["id","acceptDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],h,["id","refuseDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],g,["id","passButton",1,"button","is-fullwidth","mb-1",3,"click"],m,["id","acceptTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],v,["color","warn","id","refuseTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],T,["id","askTakeBackButton",1,"button","is-fullwidth",3,"click"],I,["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],z,["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],Z,["id","yourOpponentAgreedToDrawIndicator",1,"title"],te,["id","playersAgreedToDraw",1,"title"],me,["class","title","id","youWonIndicator",4,"ngIf"],["class","title","id","youLostIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],J,["id","youLostIndicator",1,"title"],Ne,[1,"title"],He,qe,Dt,A1,["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],M1,Yr,["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],dc,["id","proposeRematchButton",1,"button","is-fullwidth","mb-1",3,"click"],go,["id","acceptRematchButton",1,"button","is-fullwidth","is-warning",3,"click"],di]},template:function(e,r){1&e&&(k(0,e5t,2,1,"app-part-creation",0),k(1,V5t,30,27,"div",1),N(2,"div",2)(3,"div",3),X(4,"app-chat",4),A()()),2&e&&(w("ngIf",!1===r.gameStarted),M(1),w("ngIf",r.gameStarted),M(3),w("chatId",r.currentPartId)("turn",null==r.currentPart?null:r.currentPart.getTurn()))},dependencies:[On,hn,ep,Dce,o1,j8t],encapsulation:2}),n})();function B5t(n,t){if(1&n&&(N(0,"option",26),Et(1),A()),2&n){const e=t.$implicit;w("value",e.name),M(1),jn(e.name)}}function $5t(n,t){if(1&n&&(N(0,"option",26),de(1,30),A()),2&n){const e=t.$implicit;w("value",e),M(1),w1(e),k1(1)}}const U5t=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function G5t(n,t){if(1&n){const e=we();N(0,"select",27),se("ngModelChange",function(s){return he(e),ce(E(2).aiDepths[0]=s)})("change",function(){he(e);const s=E(2);return ce(s.updatePlayer(s.Player.ZERO))}),N(1,"option",28),de(2,29),A(),k(3,$5t,2,2,"option",17),A()}2&n&&(w("ngModel",E(2).aiDepths[0]),M(3),w("ngForOf",ar(2,U5t)))}function W5t(n,t){if(1&n&&(N(0,"p",31),de(1,32),A()),2&n){const e=E(2);M(1),w1(e.gameComponent.scores.get()[0]),k1(1)}}function q5t(n,t){if(1&n&&(N(0,"option",26),Et(1),A()),2&n){const e=t.$implicit;w("value",e.name),M(1),jn(e.name)}}function j5t(n,t){if(1&n&&(N(0,"option",26),de(1,35),A()),2&n){const e=t.$implicit;w("value",e),M(1),w1(e),k1(1)}}const Z5t=function(){return[1,2,3,4,5,6,7,8,9,10]};function Y5t(n,t){if(1&n){const e=we();N(0,"select",33),se("ngModelChange",function(s){return he(e),ce(E(2).aiDepths[1]=s)})("change",function(){he(e);const s=E(2);return ce(s.updatePlayer(s.Player.ONE))}),N(1,"option",28),de(2,34),A(),k(3,j5t,2,2,"option",17),A()}2&n&&(w("ngModel",E(2).aiDepths[1]),M(3),w("ngForOf",ar(2,Z5t)))}function K5t(n,t){if(1&n&&(N(0,"p",36),de(1,37),A()),2&n){const e=E(2);M(1),w1(e.gameComponent.scores.get()[1]),k1(1)}}function X5t(n,t){if(1&n&&(N(0,"h4",41),Et(1),A()),2&n){const e=E(3);M(1),jn(e.winnerMessage.get())}}function Q5t(n,t){1&n&&(N(0,"h4",42),de(1,43),A())}function J5t(n,t){if(1&n&&(N(0,"div",38),k(1,X5t,2,1,"h4",39),k(2,Q5t,2,0,"h4",40),A()),2&n){const e=E(2);M(1),w("ngIf",e.winnerMessage.isPresent()),M(1),w("ngIf",e.winnerMessage.isAbsent())}}function e7t(n,t){if(1&n){const e=we();N(0,"div",7)(1,"div",8)(2,"p",9),de(3,10),A()(),N(4,"div",11)(5,"div",12)(6,"div",13)(7,"select",14),se("change",function(){he(e);const s=E();return ce(s.updatePlayer(s.Player.ZERO))})("ngModelChange",function(s){return he(e),ce(E().playerSelection[0]=s)}),N(8,"option",15),de(9,16),A(),k(10,B5t,2,2,"option",17),A()(),N(11,"div",13),k(12,G5t,4,3,"select",18),A(),k(13,W5t,2,1,"p",19),A(),N(14,"div",20)(15,"div",13)(16,"select",21),se("change",function(){he(e);const s=E();return ce(s.updatePlayer(s.Player.ONE))})("ngModelChange",function(s){return he(e),ce(E().playerSelection[1]=s)}),N(17,"option",15),de(18,22),A(),k(19,q5t,2,2,"option",17),A()(),N(20,"div",13),k(21,Y5t,4,3,"select",23),A(),k(22,K5t,2,1,"p",24),A()(),k(23,J5t,3,2,"div",25),A()}if(2&n){const e=E();M(3),w1(e.gameComponent.getTurn()+1),k1(3),M(4),w("ngModel",e.playerSelection[0]),M(3),w("ngForOf",e.gameComponent.availableMinimaxes),M(2),w("ngIf",!1===e.players[0].equalsValue("human")),M(1),w("ngIf",e.gameComponent.scores.isPresent()),M(3),w("ngModel",e.playerSelection[1]),M(3),w("ngForOf",e.gameComponent.availableMinimaxes),M(2),w("ngIf",!1===e.players[1].equalsValue("human")),M(1),w("ngIf",e.gameComponent.scores.isPresent()),M(1),w("ngIf",e.endGame)}}function t7t(n,t){if(1&n&&(nn(0),Et(1),X(2,"br"),rn()),2&n){const e=t.$implicit,r=E(3);M(1),Ei(" ",e.name+": "+e.getBoardValue(r.gameComponent.rules.node)," ")}}function n7t(n,t){if(1&n&&(nn(0),k(1,t7t,3,1,"ng-container",50),Et(2),X(3,"br"),Et(4),X(5,"br"),rn()),2&n){const e=E(2);M(1),w("ngForOf",e.gameComponent.availableMinimaxes),M(1),Ei(" Created ",e.getCreatedNodes()," nodes."),M(2),Ei(" Minimax time: ",e.getMinimaxTime(),"ms.")}}function r7t(n,t){if(1&n){const e=we();N(0,"button",51),se("click",function(){return he(e),ce(E(2).gameComponent.pass())}),de(1,52),A()}}function s7t(n,t){if(1&n){const e=we();N(0,"button",53),se("click",function(){return he(e),ce(E(2).takeBack())}),de(1,54),A()}}function i7t(n,t){if(1&n){const e=we();N(0,"div",44),k(1,n7t,6,3,"ng-container",45),k(2,r7t,2,0,"button",46),k(3,s7t,2,0,"button",47),N(4,"button",48),se("click",function(){return he(e),ce(E().restartGame())}),de(5,49),A()()}if(2&n){const e=E();M(1),w("ngIf",e.gameComponent.rules.node.move),M(1),w("ngIf",!1===e.endGame&&e.gameComponent.canPass),M(1),w("ngIf",e.canTakeBack())}}let o7t=(()=>{class n extends JS{constructor(e,r,s,i,o,c){super(e,r,s,i,o),this.cdr=c,this.aiDepths=["0","0"],this.playerSelection=["human","human"],this.winnerMessage=S.empty(),this.botTimeOut=1e3,this.players=[S.of(this.playerSelection[0]),S.of(this.playerSelection[1])],this.role=F.ZERO,Y(n.VERBOSE,"LocalGameWrapper.constructor")}getCreatedNodes(){return SS.createdNodes}getMinimaxTime(){return SS.minimaxTime}ngAfterViewInit(){var e=this;setTimeout(O(function*(){(yield e.afterViewInit())&&(e.restartGame(),e.cdr.detectChanges())}),1)}updatePlayer(e){this.players[e.value]=S.of(this.playerSelection[e.value]),this.setRole("human"===this.playerSelection[1]&&"human"!==this.playerSelection[0]?F.ONE:F.ZERO),this.proposeAIToPlay()}onLegalUserMove(e){var r=this;return O(function*(){Y(n.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),r.gameComponent.rules.choose(e),r.updateBoard(),r.proposeAIToPlay()})()}updateBoard(){this.gameComponent.updateBoard();const e=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);if(!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer())){const r=$localize`Player ${e.winner.value+1}`,i=e.winner.getOpponent().value;this.winnerMessage=this.players[e.winner.value].equalsValue("human")?this.players[i].equalsValue("human")?S.of($localize`${r} won`):S.of($localize`You won`):this.players[i].equalsValue("human")?S.of($localize`You lost`):S.of($localize`${this.players[e.winner.value].get()} (${r}) won`)}}proposeAIToPlay(){var e=this;const r=this.getPlayingAI();r.isPresent()&&window.setTimeout(O(function*(){yield e.doAIMove(r.get())}),this.botTimeOut)}getPlayingAI(){if(this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node).isEndGame)return S.empty();const e=this.gameComponent.getTurn()%2;return"0"===this.aiDepths[e]?S.empty():S.ofNullable(this.gameComponent.availableMinimaxes.find(r=>this.players[e].equalsValue(r.name)))}doAIMove(e){var r=this;return O(function*(){const s=r.gameComponent.rules;Se(s.getGameStatus(s.node)===ze.ONGOING,"AI should not try to play when game is over!");const c=Number.parseInt(r.aiDepths[s.node.gameState.turn%2%2]),u=s.node.findBestMove(c,e,!0);return s.choose(u)?(r.updateBoard(),r.cdr.detectChanges(),r.proposeAIToPlay(),G.SUCCESS):(r.messageDisplayer.criticalMessage($localize`The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!`),ys.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:u.toString()}))})()}canTakeBack(){return this.gameComponent.getTurn()>0}takeBack(){this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.isAITurn()&&(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get()),this.gameComponent.updateBoard()}isAITurn(){return this.getPlayingAI().isPresent()}restartGame(){this.gameComponent.rules.setInitialBoard(),this.gameComponent.updateBoard(),this.endGame=!1,this.winnerMessage=S.empty(),this.proposeAIToPlay()}getPlayer(){return"human"}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(ra),Q(Qi),Q(Es),Q($n),Q(In),Q(Au))},n.\u0275cmp=vt({type:n,selectors:[["app-local-game-wrapper"]],features:[l],decls:8,vars:3,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,v,T;return t=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,e=$localize`Human`,r=$localize`Human`,s=$localize`Pick the level`,i=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,c=$localize`Pick the level`,u=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,h=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,g=$localize`Draw`,m=$localize`Start a new game`,v=$localize`Pass a turn`,T=$localize`Take back move`,[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],t,["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],e,[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],r,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["id","gameResult","class","block",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],s,i,["id","scoreOne",1,"block"],o,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],c,u,["id","scoreZero",1,"block"],h,["id","gameResult",1,"block"],["id","winner",4,"ngIf"],["id","draw",4,"ngIf"],["id","winner"],["id","draw"],g,[1,"tile","is-child","box","is-vcentered"],[4,"ngIf"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],m,[4,"ngFor","ngForOf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],v,["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],T]},template:function(e,r){1&e&&(N(0,"div",0)(1,"div",1),k(2,e7t,24,10,"div",2),k(3,i7t,6,3,"div",3),A(),N(4,"div",4)(5,"div",5),X(6,"div",null,6),A()()()),2&e&&(M(2),w("ngIf",r.gameComponent),M(1),w("ngIf",r.gameComponent),M(1),w("ngClass",r.getBoardHighlight()))},dependencies:[On,Fn,hn,D9,z9,YC,Y4,R9],encapsulation:2,changeDetection:0}),n})(),Bce=(()=>{class n{}return n.STEP_FINISHED=()=>$localize`Step finished!`,n.INFORMATIONAL_STEP=()=>$localize`This step is not expecting any move from your part.`,n})();function a7t(n,t){if(1&n&&(N(0,"div",21)(1,"div",22),de(2,23),A(),N(3,"div",24),Et(4),A()()),2&n){const e=E();M(4),jn(e.currentReason.get())}}function c7t(n,t){if(1&n){const e=we();N(0,"button",25),se("click",function(){return he(e),ce(E().retry())}),de(1,26),A()}}function l7t(n,t){1&n&&(nn(0),de(1,31),rn())}function u7t(n,t){1&n&&(nn(0),de(1,32),rn())}function f7t(n,t){if(1&n&&k(0,u7t,2,0,"ng-container",28),2&n){E();const e=s1(5),r=E();w("ngIf",r.stepFinished&&r.stepFinished[r.stepIndex])("ngIfElse",e)}}function h7t(n,t){1&n&&(nn(0),de(1,33),rn())}function d7t(n,t){if(1&n){const e=we();N(0,"button",27),se("click",function(){return he(e),ce(E().next())}),k(1,l7t,2,0,"ng-container",28),k(2,f7t,1,2,"ng-template",null,29,l1),k(4,h7t,2,0,"ng-template",null,30,l1),A()}if(2&n){const e=s1(3),r=E();M(1),w("ngIf",r.steps[r.stepIndex]&&r.steps[r.stepIndex].isInformation())("ngIfElse",e)}}function p7t(n,t){if(1&n){const e=we();N(0,"button",34),se("click",function(){return he(e),ce(E().start())}),de(1,35),A()}}function g7t(n,t){if(1&n){const e=we();N(0,"button",36),se("click",function(){return he(e),ce(E().playLocally())}),de(1,37),A()}}function m7t(n,t){if(1&n){const e=we();N(0,"button",38),se("click",function(){return he(e),ce(E().createGame())}),de(1,39),A()}}function _7t(n,t){if(1&n){const e=we();N(0,"button",40),se("click",function(){return he(e),ce(E().showSolution())}),de(1,41),A()}}function v7t(n,t){if(1&n&&(nn(0),N(1,"option",43),Et(2),A(),rn()),2&n){const e=E(),r=e.index,s=e.$implicit;M(1),L1("id","step_",r,""),w("value",r),M(1),jn(s.title)}}function C7t(n,t){1&n&&(nn(0),Et(1,"v "),rn())}function y7t(n,t){1&n&&Et(0,"x ")}function E7t(n,t){if(1&n&&(N(0,"option",44),k(1,C7t,2,0,"ng-container",28),k(2,y7t,1,0,"ng-template",null,45,l1),N(4,"span",46),Et(5),A()()),2&n){const e=s1(3),r=E(),s=r.index,i=r.$implicit,o=E();w("value",s),M(1),w("ngIf",o.stepFinished[s])("ngIfElse",e),M(3),L1("id","step_",s,""),M(1),jn(i.title)}}function M7t(n,t){if(1&n&&(nn(0),k(1,v7t,3,3,"ng-container",28),k(2,E7t,6,5,"ng-template",null,42,l1),rn()),2&n){const e=t.index,r=s1(3),s=E();M(1),w("ngIf",e===s.stepIndex)("ngIfElse",r)}}let S7t=(()=>{class n extends JS{constructor(e,r,s,i,o,c){super(e,r,c,s,i),this.cdr=o,this.connectedUserService=c,this.COMPLETED_TUTORIAL_MESSAGE=$localize`Congratulations, you completed the tutorial.`,this.steps=[],this.successfulSteps=0,this.stepIndex=-1,this.currentMessage="",this.currentReason=S.empty(),this.moveAttemptMade=!1,this.stepFinished=[],this.tutorialOver=!1,Y(n.VERBOSE,"TutorialGameWrapperComponent.constructor"),this.role=F.ZERO}getNumberOfSteps(){return this.steps.length}getCurrentStepTitle(){return this.steps.length>0?this.steps[this.stepIndex].title:""}ngAfterViewInit(){var e=this;return O(function*(){Y(n.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),(yield e.afterViewInit())&&e.start()})()}start(){this.startTutorial(this.gameComponent.tutorial)}startTutorial(e){Y(n.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:e}}),this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}getCompletionArray(){return this.steps.map(()=>!1)}changeStep(e){this.showStep(Number.parseInt(e.target.value,10))}showStep(e){Y(n.VERBOSE,"tutorialGameWrapperComponent.showStep("+e+")"),this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;const r=this.steps[this.stepIndex];let s;if(this.currentMessage=r.instruction,this.currentReason=S.empty(),r.previousState.isPresent()){const i=new fr(r.previousState.get());s=S.of(i)}else s=S.empty();this.gameComponent.rules.node=new fr(r.state,s,r.previousMove),this.gameComponent.updateBoard(),this.cdr.detectChanges()}onLegalUserMove(e){var r=this;return O(function*(){Y(n.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:e}});const s=r.steps[r.stepIndex];if(Se(r.gameComponent.rules.choose(e),"It should be impossible to call onLegalUserMove with an illegal move"),Y(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),r.gameComponent.updateBoard(),r.moveAttemptMade=!0,s.isPredicate()){const o=r.gameComponent.getPreviousState(),c=r.gameComponent.getState(),u=Ae.getNonNullable(s.predicate)(e,o,c);u.isSuccess()?r.showStepSuccess(s.getSuccessMessage()):r.currentReason=S.of(u.getReason())}else if(s.isAnyMove())Y(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),r.showStepSuccess(s.getSuccessMessage());else{Se(s.isMove(),"cannot reach here with a click step");const o=s;o.acceptedMoves.some(c=>c.equals(e))?(Y(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),r.showStepSuccess(o.getSuccessMessage())):(Y(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),r.currentReason=S.of(o.getFailureMessage()))}r.cdr.detectChanges()})()}retry(){Y(n.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}onUserClick(e){if(Y(n.VERBOSE,"tutorialGameWrapper.onUserClick("+e+")"),this.currentReason=S.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return G.failure(Bce.STEP_FINISHED());const r=this.steps[this.stepIndex];return r.isClick()?(this.gameComponent.updateBoard(),this.moveAttemptMade=!0,Ae.getNonNullable(r.acceptedClicks).some(s=>s===e)?this.showStepSuccess(r.getSuccessMessage()):this.currentMessage=r.getFailureMessage(),G.SUCCESS):r.isMove()||r.isPredicate()||r.isAnyMove()?(window.setTimeout(()=>{this.cdr.detectChanges()},10),G.SUCCESS):G.failure(Bce.INFORMATIONAL_STEP())}onCancelMove(e){Y(n.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+e+")"),void 0!==e&&(this.currentReason=S.of(e)),this.cdr.detectChanges()}showStepSuccess(e){Y(n.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}updateSuccessCount(){let e=0;for(const r of this.stepFinished)r&&e++;this.successfulSteps=e}next(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{let e=(this.stepIndex+1)%this.steps.length;for(;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}showSolution(){var e=this;return O(function*(){Y(n.VERBOSE,"tutorialGameWrapper.showSolution()");const r=e.steps[e.stepIndex];Se(r.hasSolution(),"step must have solution");const s=r,i=s.getSolution();i instanceof so?(e.showStep(e.stepIndex),e.gameComponent.rules.choose(i),e.gameComponent.updateBoard()):(e.showStep(e.stepIndex),window.document.querySelector(i).dispatchEvent(new Event("click"))),e.currentMessage=s.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges()})()}playLocally(){var e=this;return O(function*(){const r=Ae.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/local",r])})()}createGame(){var e=this;return O(function*(){const r=Ae.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/play",r])})()}getPlayer(){return"tutorial-player"}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(ra),Q(Qi),Q($n),Q(In),Q(Au),Q(Es))},n.\u0275cmp=vt({type:n,selectors:[["app-tutorial-game-wrapper"]],features:[l],decls:23,vars:15,consts:function(){let t,e,r,s,i,o,c,u,h;return t=$localize`Failure`,e=$localize`Try again`,r=$localize`Ok`,s=$localize`Continue`,i=$localize`Skip`,o=$localize`Try again`,c=$localize`Play locally`,u=$localize`Create an online game`,h=$localize`See solution`,[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["role","alert",1,"message","is-danger"],[1,"message-header"],t,["id","currentReason",1,"message-body"],["id","retryButton",1,"button","mr-3",3,"click"],e,["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],r,s,i,["id","restartButton",1,"button",3,"click"],o,["id","playLocallyButton",1,"button",3,"click"],c,["id","playOnlineButton",1,"button",3,"click"],u,["id","showSolutionButton",1,"button",3,"click"],h,["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,r){1&e&&(N(0,"div",0)(1,"div",1)(2,"div",2),X(3,"progress",3),N(4,"div",4)(5,"p",5),Et(6),A(),X(7,"p",6),A(),k(8,a7t,5,1,"div",7),N(9,"div",8),k(10,c7t,2,0,"button",9),k(11,d7t,6,2,"button",10),k(12,p7t,2,0,"button",11),k(13,g7t,2,0,"button",12),k(14,m7t,2,0,"button",13),k(15,_7t,2,0,"button",14),N(16,"div",15)(17,"select",16),se("change",function(i){return r.changeStep(i)}),k(18,M7t,4,2,"ng-container",17),A()()()()(),N(19,"div",18)(20,"div",19),X(21,"div",null,20),A()()()),2&e&&(M(3),V("value",r.successfulSteps)("max",r.getNumberOfSteps()),M(3),Jw("",r.getCurrentStepTitle()," [",r.stepIndex+1,"/",r.getNumberOfSteps(),"]"),M(1),w("innerHTML",r.currentMessage,ud),M(1),w("ngIf",r.currentReason.isPresent()),M(2),w("ngIf",!1===r.tutorialOver&&(r.stepFinished&&!0===r.stepFinished[r.stepIndex]||r.moveAttemptMade)),M(1),w("ngIf",!1===r.tutorialOver),M(1),w("ngIf",r.tutorialOver),M(1),w("ngIf",r.tutorialOver),M(1),w("ngIf",r.tutorialOver),M(1),w("ngIf",r.moveAttemptMade&&!1===r.stepFinished[r.stepIndex]),M(3),w("ngForOf",r.steps),M(1),w("ngClass",r.getBoardHighlight()))},dependencies:[On,Fn,hn,D9,z9],encapsulation:2,changeDetection:0}),n})();function P7t(n,t){if(1&n&&(N(0,"div",35)(1,"div",36),de(2,37),A(),N(3,"div",38),Et(4),A()()),2&n){const e=E();M(4),jn(e.errorMessage)}}const T7t=function(){return["/login"]};let w7t=(()=>{class n{constructor(e,r){this.connectedUserService=e,this.router=r,this.faEye=Bz,this.registrationForm=new k6({email:new ua,username:new ua,password:new ua})}registerWithEmail(){var e=this;return O(function*(){const r=e.registrationForm.value.username,s=e.registrationForm.value.email,i=e.registrationForm.value.password;if(null==r||null==s||null==i)e.errorMessage=$localize`There are missing fields in the registration form, please check that you filled in all fields.`;else{const o=yield e.connectedUserService.doRegister(r,s,i);if(o.isSuccess()){const c=yield e.connectedUserService.sendEmailVerification();c.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=c.getReason()}else e.errorMessage=o.getReason()}})()}registerWithGoogle(){var e=this;return O(function*(){const r=yield e.connectedUserService.doGoogleLogin();r.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=r.getReason()})()}getPasswordHelpClass(){const e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}canRegister(){const e=this.registrationForm.value.password??"";return!(""===(this.registrationForm.value.email??"")||""===(this.registrationForm.value.username??"")||""===e||e.length<6)}}return n.\u0275fac=function(e){return new(e||n)(Q(Es),Q($n))},n.\u0275cmp=vt({type:n,selectors:[["app-register"]],decls:56,vars:7,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,v,T,I;return t=$localize`Registering`,e=$localize`Email`,r=$localize`Email`,s=$localize`A confirmation email will be sent to validate your account.`,i=$localize`Username`,o=$localize`Username`,c=$localize`Password`,u=$localize`Password`,h=$localize`The password should be at least 6 characters long`,g=$localize`Register`,m=$localize`Register with Google`,v=$localize`Have an account?`,T=$localize`Log in`,I=$localize`Registration error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],e,[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",r,"type","email","autofocus","","required","",1,"input"],[1,"help"],s,["for","username",1,"label"],i,["id","username","formControlName","username","name","username","placeholder",o,"type","text","required","",1,"input"],["for","password",1,"label"],c,[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",u,"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],h,["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],g,[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],m,[1,"help","level-right"],v,[3,"routerLink"],T,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],I,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(N(0,"div",0)(1,"p",1),de(2,2),A(),N(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),de(7,7),A()(),N(8,"div",8)(9,"div",9)(10,"div",10),X(11,"input",11),N(12,"p",12),de(13,13),A()()()()(),N(14,"div",4)(15,"div",5)(16,"label",14),de(17,15),A()(),N(18,"div",8)(19,"div",9)(20,"div",10),X(21,"input",16),A()()()(),N(22,"div",4)(23,"div",5)(24,"label",17),de(25,18),A()(),N(26,"div",8)(27,"div",9)(28,"div",19),X(29,"input",20),N(30,"span",21),X(31,"fa-icon",22),A(),N(32,"p",23),de(33,24),A()()()()(),N(34,"div",4),X(35,"div",5),N(36,"div",8)(37,"div",9)(38,"div",10)(39,"button",25),se("click",function(){return r.registerWithEmail()}),de(40,26),A()()()()(),N(41,"div",4),X(42,"div",5),N(43,"div",27),k(44,P7t,5,1,"div",28),A()(),N(45,"div",4),X(46,"div",5),N(47,"div",8)(48,"button",29),se("click",function(){return r.registerWithGoogle()}),de(49,30),A()()(),N(50,"p",31),nn(51),de(52,32),rn(),Et(53,"\xa0 "),N(54,"a",33),de(55,34),A()()()()),2&e&&(M(3),w("formGroup",r.registrationForm),M(28),w("icon",r.faEye),M(1),w("ngClass",r.getPasswordHelpClass()),M(7),w("disabled",!r.canRegister()),M(5),w("ngIf",r.errorMessage),M(10),w("routerLink",ar(6,T7t)))},dependencies:[On,hn,Bu,ku,$3,Y4,Lu,zu,Ru,S7,If,FV,kce],encapsulation:2}),n})(),b7t=(()=>{class n{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}playLocally(){var e=this;return O(function*(){yield e.router.navigate(["local/"+e.selectedGame])})()}}return n.\u0275fac=function(e){return new(e||n)(Q($n))},n.\u0275cmp=vt({type:n,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Play offline`,[[3,"pickGame"],["id","playLocally",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(N(0,"app-pick-game",0),se("pickGame",function(i){return r.pickGame(i)}),A(),N(1,"button",1),se("click",function(){return r.playLocally()}),de(2,2),A()),2&e&&(M(1),w("disabled",!r.selectedGame))},dependencies:[HV],encapsulation:2}),n})(),N7t=(()=>{class n{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}launchTutorial(){var e=this;return O(function*(){yield e.router.navigate(["/tutorial/",e.selectedGame])})()}}return n.\u0275fac=function(e){return new(e||n)(Q($n))},n.\u0275cmp=vt({type:n,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Learn the rules`,[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(N(0,"app-pick-game",0),se("pickGame",function(i){return r.pickGame(i)}),A(),N(1,"button",1),se("click",function(){return r.launchTutorial()}),de(2,2),A()),2&e&&(M(1),w("disabled",!r.selectedGame))},dependencies:[HV],encapsulation:2}),n})(),A7t=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=vt({type:n,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){let t;return t=$localize`The replay game is loading, please wait, it should not take long.`,[t]},template:function(e,r){1&e&&(N(0,"p"),de(1,0),A())},encapsulation:2}),n})();function I7t(n,t){if(1&n&&(B(),X(0,"polygon",4)),2&n){const e=E();w("id",e.mainShapeId)("ngClass",e.pieceClasses),V("points",e.MartianChessQueenComponent.HEPTAGON)}}function x7t(n,t){if(1&n&&(B(),X(0,"polygon",4)),2&n){const e=E();w("id",e.mainShapeId)("ngClass",e.pieceClasses),V("points",e.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function L7t(n,t){if(1&n&&(B(),X(0,"circle",5)),2&n){const e=E();w("id",e.mainShapeId)("ngClass",e.pieceClasses),V("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function k7t(n,t){if(1&n&&(nn(0),B(),X(1,"circle",6)(2,"circle",6)(3,"circle",6),rn()),2&n){const e=E();M(1),V("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(3)),M(1),V("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),M(1),V("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function R7t(n,t){if(1&n&&(B(),N(0,"g"),X(1,"circle",7)(2,"circle",7)(3,"circle",7),A()),2&n){const e=E();M(1),V("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.45*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),M(1),V("cx",.45*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),M(1),V("cx",.55*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function D7t(n,t){if(1&n&&(B(),N(0,"g",8),X(1,"circle",9)(2,"circle",9)(3,"circle",9),A()),2&n){const e=E();w("ngClass",e.pieceClasses),M(1),V("cx",.5*e.MartianChessComponent.SPACE_SIZE-3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),M(1),V("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),M(1),V("cx",.5*e.MartianChessComponent.SPACE_SIZE+3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}class Ll{constructor(){this.MartianChessQueenComponent=Ll,this.MartianChessComponent=fo,this.horizontalDotsRadius=fo.SPACE_SIZE/15}}function V7t(n,t){if(1&n&&(B(),X(0,"polygon",4)),2&n){const e=E();w("id",e.mainShapeId)("ngClass",e.pieceClasses),V("points",e.MartianChessDroneComponent.PENTAGON)}}function H7t(n,t){if(1&n&&(B(),X(0,"polygon",4)),2&n){const e=E();w("id",e.mainShapeId)("ngClass",e.pieceClasses),V("points",e.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function F7t(n,t){if(1&n&&(B(),X(0,"circle",5)),2&n){const e=E();w("id",e.mainShapeId)("ngClass",e.pieceClasses),V("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function B7t(n,t){if(1&n&&(nn(0),B(),X(1,"circle",6)(2,"circle",6),rn()),2&n){const e=E();M(1),V("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),M(1),V("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function $7t(n,t){if(1&n&&(B(),N(0,"g",7),X(1,"circle",8)(2,"circle",8),A()),2&n){const e=E();w("ngClass",e.pieceClasses),M(1),V("cx",.4*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),M(1),V("cx",.6*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function U7t(n,t){if(1&n&&(B(),N(0,"g",7),X(1,"circle",9)(2,"circle",9),A()),2&n){const e=E();w("ngClass",e.pieceClasses),M(1),V("cx",.5*e.MartianChessComponent.SPACE_SIZE-2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),M(1),V("cx",.5*e.MartianChessComponent.SPACE_SIZE+2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}Ll.HEPTAGON=fo.getRegularPolygon(7),Ll.EIGHT_POINTED_STAR=fo.getNPointedStar(8,0),Ll.\u0275fac=function(t){return new(t||Ll)},Ll.\u0275cmp=vt({type:Ll,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(k(0,I7t,1,3,"polygon",0),k(1,x7t,1,3,"polygon",0),k(2,L7t,1,5,"circle",1),k(3,k7t,4,9,"ng-container",2),k(4,R7t,4,9,"g",2),k(5,D7t,4,10,"g",3)),2&t&&(w("ngIf","Polygon"===e.style.shape),M(1),w("ngIf","Star"===e.style.shape),M(1),w("ngIf","Circle"===e.style.shape),M(1),w("ngIf","Concentric Circles"===e.style.points),M(1),w("ngIf","Dots"===e.style.points),M(1),w("ngIf","Horizontal Points"===e.style.points))},dependencies:[On,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class kl{constructor(){this.MartianChessComponent=fo,this.MartianChessDroneComponent=kl,this.horizontalDotsRadius=fo.SPACE_SIZE/15}}function W7t(n,t){if(1&n&&(B(),X(0,"polygon",5)),2&n){const e=E();w("id",e.mainShapeId)("ngClass",e.pieceClasses),V("points",e.MartianChessPawnComponent.TRIANGLE)}}function q7t(n,t){if(1&n&&(B(),X(0,"polygon",5)),2&n){const e=E();w("id",e.mainShapeId)("ngClass",e.pieceClasses),V("points",e.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function j7t(n,t){if(1&n&&(B(),X(0,"circle",6)),2&n){const e=E();w("id",e.mainShapeId)("ngClass",e.pieceClasses),V("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function Z7t(n,t){if(1&n&&(B(),X(0,"circle",7)),2&n){const e=E();V("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE+e.getConcreteTriangleYOffset())("r",e.MartianChessComponent.getRadius(1))}}function Y7t(n,t){if(1&n&&(B(),X(0,"circle",8)),2&n){const e=E();V("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function K7t(n,t){if(1&n&&(B(),N(0,"g",9),X(1,"circle",10),A()),2&n){const e=E();w("ngClass",e.pieceClasses),M(1),V("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}kl.FOUR_POINTED_STAR_VERTICAL=fo.getNPointedStar(4,0),kl.PENTAGON=fo.getRegularPolygon(5),kl.\u0275fac=function(t){return new(t||kl)},kl.\u0275cmp=vt({type:kl,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(k(0,V7t,1,3,"polygon",0),k(1,H7t,1,3,"polygon",0),k(2,F7t,1,5,"circle",1),k(3,B7t,3,6,"ng-container",2),k(4,$7t,3,7,"g",3),k(5,U7t,3,7,"g",3)),2&t&&(w("ngIf","Polygon"===e.style.shape),M(1),w("ngIf","Star"===e.style.shape),M(1),w("ngIf","Circle"===e.style.shape),M(1),w("ngIf","Concentric Circles"===e.style.points),M(1),w("ngIf","Dots"===e.style.points),M(1),w("ngIf","Horizontal Points"===e.style.points))},dependencies:[On,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class jo{constructor(){this.MartianChessComponent=fo,this.MartianChessPawnComponent=jo,this.horizontalDotsRadius=fo.SPACE_SIZE/15}static getTriangle(){return fo.getRegularPolygon(3,jo.TRIANGLE_Y_OFFSET)}static yOffsetForVerticalCentering(){const e=fo.getRegularPolygonCoords(3).map(u=>u.y);return(e.reduce((u,h)=>Math.min(u,h))+(100-e.reduce((u,h)=>Math.max(u,h))))/4}getConcreteTriangleYOffset(){return"Polygon"===this.style.shape?jo.TRIANGLE_Y_OFFSET:0}}jo.FOUR_POINTED_STAR_DIAGONAL=fo.getNPointedStar(4,45),jo.TRIANGLE_Y_OFFSET=jo.yOffsetForVerticalCentering(),jo.TRIANGLE=jo.getTriangle(),jo.\u0275fac=function(t){return new(t||jo)},jo.\u0275cmp=vt({type:jo,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(k(0,W7t,1,3,"polygon",0),k(1,q7t,1,3,"polygon",0),k(2,j7t,1,5,"circle",1),k(3,Z7t,1,3,"circle",2),k(4,Y7t,1,3,"circle",3),k(5,K7t,2,4,"g",4)),2&t&&(w("ngIf","Polygon"===e.style.shape),M(1),w("ngIf","Star"===e.style.shape),M(1),w("ngIf","Circle"===e.style.shape),M(1),w("ngIf","Concentric Circles"===e.style.points),M(1),w("ngIf","Dots"===e.style.points),M(1),w("ngIf","Horizontal Points"===e.style.points))},dependencies:[On,hn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});const fm_firebaseConfig={apiKey:"AIzaSyAt5QHXLnm2Uf9X7VN6XPPiSaipoh3oRHo",authDomain:"firestore-c9d47.firebaseapp.com",databaseURL:"https://firestore-c9d47.firebaseio.com",projectId:"firestore-c9d47",storageBucket:"firestore-c9d47.appspot.com",messagingSenderId:"936588361631",appId:"1:936588361631:web:2c059886d8d427edbac7aa"};let BV=(()=>{class n{constructor(e){this.connectedUserService=e}canActivate(){var e=this;return O(function*(){const r=yield new Promise(s=>{e.userSubscription=e.connectedUserService.subscribeToUser(function(){var i=O(function*(o){return s(yield e.evaluateUserPermission(o))});return function(o){return i.apply(this,arguments)}}())});return e.userSubscription.unsubscribe(),r})()}}return n.\u0275fac=function(e){return new(e||n)(xe(Es))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),hm=(()=>{class n extends BV{constructor(e,r){super(e),this.router=r}static evaluateUserPermission(e,r){return O(function*(){return!1===r.isConnected()?e.parseUrl("/login"):!1!==r.verified||e.parseUrl("/verify-account")})()}evaluateUserPermission(e){var r=this;return O(function*(){return n.evaluateUserPermission(r.router,e)})()}}return n.\u0275fac=function(e){return new(e||n)(xe(Es),xe($n))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),$V=(()=>{class n{constructor(e,r){this.observedPartService=e,this.router=r,this.observedPartSubscription=S.empty()}canActivate(e){var r=this;return O(function*(){const s=yield new Promise(i=>{const o=r.observedPartService.subscribeToObservedPart(c=>{if(c.isAbsent())return i(!0);const u=c.get();return i(e.params.id===u.id||r.router.parseUrl("/play/"+u.typeGame+"/"+u.id))});r.observedPartSubscription=S.of(o)});return r.observedPartSubscription.get().unsubscribe(),r.observedPartSubscription=S.empty(),s})()}}return n.\u0275fac=function(e){return new(e||n)(xe(li),xe($n))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),X7t=(()=>{class n extends BV{constructor(e,r){super(e),this.router=r}evaluateUserPermission(e){var r=this;return O(function*(){return!1===e.isConnected()?r.router.parseUrl("/login"):!e.verified||r.router.parseUrl("/")})()}}return n.\u0275fac=function(e){return new(e||n)(xe(Es),xe($n))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),$ce=(()=>{class n extends BV{constructor(e,r){super(e),this.router=r}evaluateUserPermission(e){var r=this;return O(function*(){return!1===e.isConnected()||r.router.parseUrl("/")})()}}return n.\u0275fac=function(e){return new(e||n)(xe(Es),xe($n))},n.\u0275prov=Xe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Q7t(n,t){1&n&&(N(0,"p",20),de(1,21),A())}function J7t(n,t){if(1&n){const e=we();N(0,"div",7)(1,"p",8),de(2,9),A(),N(3,"div",10)(4,"p",11),de(5,12),A(),N(6,"button",13),se("click",function(){return he(e),ce(E().finalizeEmailVerification())}),de(7,14),A()(),N(8,"div",15)(9,"p",11),de(10,16),A(),N(11,"button",17),se("click",function(){return he(e),ce(E().sendEmailVerification())}),de(12,18),A()(),k(13,Q7t,2,0,"p",19),A()}if(2&n){const e=E();M(2),w1(e.emailAddress),k1(2),M(11),w("ngIf",e.success)}}function eft(n,t){if(1&n){const e=we();N(0,"div",24)(1,"div",8),de(2,25),A(),N(3,"form",26)(4,"div",27)(5,"div",28),X(6,"input",29),A(),N(7,"div",28)(8,"button",30),se("click",function(){he(e);const s=E(2);return ce(s.pickUsername(s.usernameForm.value))}),de(9,31),A()()()()()}if(2&n){const e=E(2);M(3),w("formGroup",e.usernameForm)}}const tft=function(){return["/lobby"]};function nft(n,t){1&n&&(N(0,"div",32),$a(1,33),X(2,"a",34),Ua(),A()),2&n&&(M(2),w("routerLink",ar(1,tft)))}function rft(n,t){if(1&n&&(nn(0),k(1,eft,10,1,"div",22),k(2,nft,3,2,"div",23),rn()),2&n){const e=E();M(1),w("ngIf",!e.success),M(1),w("ngIf",e.success)}}function sft(n,t){if(1&n&&(N(0,"div",35)(1,"div",36),Et(2),A()()),2&n){const e=E();M(2),jn(e.errorMessage)}}let ift=(()=>{class n{constructor(e,r){this.connectedUserService=e,this.router=r,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new k6({username:new ua})}ngOnInit(){var e=this;return O(function*(){e.userSubscription=e.connectedUserService.subscribeToUser(function(){var r=O(function*(s){e.emailAddress=s.email.get(),s.username.isAbsent()?e.verificationType="enter-username":(e.verificationType="send-email",!0===e.triedToFinalize&&!1===s.verified&&(e.errorMessage=$localize`You have not verified your email! Click on the link in the verification email.`),!0===s.verified&&(yield e.router.navigate(["/lobby"])))});return function(s){return r.apply(this,arguments)}}())})()}pickUsername(e){var r=this;return O(function*(){const s=yield r.connectedUserService.setUsername(e.username);s.isSuccess()?r.success=!0:r.errorMessage=s.getReason()})()}sendEmailVerification(){var e=this;return O(function*(){const r=yield e.connectedUserService.sendEmailVerification();r.isSuccess()?e.success=!0:e.errorMessage=r.getReason()})()}finalizeEmailVerification(){var e=this;return O(function*(){e.triedToFinalize=!0,yield e.connectedUserService.reloadUser(),window.open(window.location.href,"_self")})()}ngOnDestroy(){null!=this.userSubscription&&null!=this.userSubscription.unsubscribe&&this.userSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(Q(Es),Q($n))},n.\u0275cmp=vt({type:n,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){let t,e,r,s,i,o,c,u,h,g,m;return t=$localize`Account verification`,e=$localize`In order to finalize your account, you must click on the link that you should have received on your email address (${"\ufffd0\ufffd"}:INTERPOLATION:). The email could be in your spam folder.`,r=$localize`Once you have verified your email, click on the following button:`,s=$localize`Finalize email verification`,i=$localize`If you have not received the verification email, click on the following button:`,o=$localize`Send verification email again`,c=$localize`The email has been sent`,u=$localize`In order to finalize your account, you must choose a username.`,h=$localize`Username`,g=$localize`Pick username`,m=$localize`Your account has now been finalized, you can go back to the ${"\ufffd#2\ufffd"}:START_LINK:list of games${"\ufffd/#2\ufffd"}:CLOSE_LINK:.`,[[1,"box"],[1,"message","is-info"],[1,"message-header"],t,["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],e,[1,"block","level-left"],[1,"level-item"],r,["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],s,[1,"level-left"],i,["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],o,["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],c,["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],u,[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",h,"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],g,["id","success",1,"message-body"],m,[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(N(0,"div",0)(1,"div",1)(2,"div",2),de(3,3),A(),k(4,J7t,14,2,"div",4),k(5,rft,3,2,"ng-container",5),A(),k(6,sft,3,1,"div",6),A()),2&e&&(M(4),w("ngIf","send-email"===r.verificationType),M(1),w("ngIf","enter-username"===r.verificationType),M(1),w("ngIf",r.errorMessage))},dependencies:[hn,Bu,ku,$3,Y4,Lu,zu,Ru,S7],encapsulation:2}),n})();function oft(n,t){1&n&&(N(0,"p",12),de(1,13),A())}function aft(n,t){if(1&n&&(N(0,"div",14)(1,"div",15),de(2,16),A(),N(3,"div",17),Et(4),A()()),2&n){const e=E();M(4),jn(e.errorMessage.get())}}const cft=function(){return{standalone:!0}};let lft=(()=>{class n{constructor(e){this.connectedUserService=e,this.success=!1,this.errorMessage=S.empty(),this.email=""}resetPassword(){var e=this;return O(function*(){Se(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=S.empty(),e.success=!1;const r=yield e.connectedUserService.sendPasswordResetEmail(e.email);r.isSuccess()?e.success=!0:e.errorMessage=S.of(r.getReason())})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Es))},n.\u0275cmp=vt({type:n,selectors:[["app-reset-password"]],decls:12,vars:6,consts:function(){let t,e,r,s,i,o;return t=$localize`Password reset`,e=$localize`Email`,r=$localize`An email will be sent with instruction to reset your password.`,s=$localize`Reset password`,i=$localize`The email has been sent, please follow the instructions from that email.`,o=$localize`Error`,[[1,"box"],[1,"title"],t,[1,"field"],[1,"control"],["id","email","name","email","placeholder",e,"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],r,["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],s,["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],i,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],o,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(N(0,"div",0)(1,"p",1),de(2,2),A(),N(3,"div",3)(4,"div",4)(5,"input",5),se("ngModelChange",function(i){return r.email=i}),A(),N(6,"p",6),de(7,7),A(),k(8,oft,2,0,"p",8),A()(),N(9,"button",9),se("click",function(){return r.resetPassword()}),de(10,10),A(),k(11,aft,5,1,"div",11),A()),2&e&&(M(5),w("ngModel",r.email)("ngModelOptions",ar(5,cft)),M(3),w("ngIf",r.success),M(1),w("disabled",""===r.email),M(2),w("ngIf",r.errorMessage.isPresent()))},dependencies:[hn,$3,Y4,zu,R9,FV],encapsulation:2}),n})();function uft(n,t){if(1&n&&(N(0,"option",13),Et(1),A()),2&n){const e=t.$implicit,r=E();w("value",e.value)("selected",e.value===r.currentTheme),M(1),Ei(" ",e.name," ")}}function fft(n,t){if(1&n&&(N(0,"option",13),Et(1),A()),2&n){const e=t.$implicit,r=E();w("value",e.value)("selected",e.value===r.currentLanguage),M(1),Ei(" ",e.name," ")}}let hft=(()=>{class n{constructor(e,r){this.userSettingsService=e,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize`Light`},{value:"dark",name:$localize`Dark`}],this.currentTheme=r.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}changeLanguage(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}changeTheme(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}reload(){window.open(window.location.href,"_self")}}return n.\u0275fac=function(e){return new(e||n)(Q(ete),Q(HM))},n.\u0275cmp=vt({type:n,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){let t,e,r;return t=$localize`User settings`,e=$localize`Theme`,r=$localize`Language`,[[1,"box"],[1,"title"],t,[1,"field"],["for","theme",1,"label"],e,[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],r,["id","language",3,"change"],[3,"value","selected"]]},template:function(e,r){1&e&&(N(0,"div",0)(1,"p",1),de(2,2),A(),N(3,"div",3)(4,"label",4),de(5,5),A(),N(6,"div",6)(7,"div",7)(8,"select",8),se("change",function(i){return r.changeTheme(i)}),k(9,uft,2,3,"option",9),A()()()(),N(10,"div",3)(11,"label",10),de(12,11),A(),N(13,"div",6)(14,"div",7)(15,"select",12),se("change",function(i){return r.changeLanguage(i)}),k(16,fft,2,3,"option",9),A()()()()()),2&e&&(M(9),w("ngForOf",r.availableThemes),M(7),w("ngForOf",r.availableLanguages))},dependencies:[Fn,D9,z9],encapsulation:2}),n})(),dft=(()=>{class n{constructor(e,r,s,i,o,c){this.route=e,this.router=r,this.connectedUserService=s,this.observedPartService=i,this.messageDisplayer=o,this.gameService=c}ngOnInit(){var e=this;return O(function*(){yield e.createGameAndRedirectOrShowError(e.extractGameFromURL())})()}extractGameFromURL(){return Ae.getNonNullable(this.route.snapshot.paramMap.get("compo"))}createGameAndRedirectOrShowError(e){var r=this;return O(function*(){if(Se(r.connectedUserService.user.get().isConnected(),"User must be connected and have a username to reach this page"),!1===r.gameExists(e))return yield r.router.navigate(["/notFound",Jf.NO_MATCHING_GAME(e)],{skipLocationChange:!0}),!1;const i=r.observedPartService.canUserCreate();if(i.isSuccess()){const o=yield r.gameService.createPartConfigRoomAndChat(e);return yield r.router.navigate(["/play",e,o]),!0}return r.messageDisplayer.infoMessage(i.getReason()),yield r.router.navigate(["/lobby"]),!1})()}gameExists(e){return S.ofNullable(Qf.ALL_GAMES().find(s=>s.urlName===e)).isPresent()}}return n.\u0275fac=function(e){return new(e||n)(Q(Qi),Q($n),Q(Es),Q(li),Q(In),Q(VM))},n.\u0275cmp=vt({type:n,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){let t;return t=$localize`Creating online game, please wait, it should not take long.`,[t]},template:function(e,r){1&e&&(N(0,"p"),de(1,0),A())},encapsulation:2}),n})();!function m0e(n,t,e){(function G3e(n,t,e){"string"!=typeof t&&(e=t,t=n[ft.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),v7[t]=n,e&&(v7[t][ft.ExtraData]=e)})(n,t,e)}(Rde);const pft=[{path:"login",component:o8t},{path:"lobby",component:T8t,canActivate:[hm]},{path:"settings",component:hft},{path:"register",component:w7t,canActivate:[$ce]},{path:"reset-password",component:lft,canActivate:[$ce]},{path:"notFound/:message",component:Vce},{path:"nextGameLoading",component:A7t,canActivate:[hm]},{path:"verify-account",component:ift,canActivate:[X7t]},{path:"play",component:zce,canActivate:[hm,$V]},{path:"play/:compo",component:dft,canActivate:[hm,$V]},{path:"play/:compo/:id",component:F5t,canActivate:[hm,$V]},{path:"local",component:b7t},{path:"local/:compo",component:o7t},{path:"tutorial",component:N7t},{path:"tutorial/:compo",component:S7t},{path:"",component:Zut},{path:"demo",component:n8t},{path:"**",component:Vce}];class UV{static app(){return function ZEe(n,...t){return{ngModule:jEe,providers:[{provide:Ak,useFactory:qEe(n),multi:!0,deps:[vr,Xs,bk,...t]}]}}(()=>YEe(fm_firebaseConfig))}static firestore(){return function jTe(n,...t){return{ngModule:qTe,providers:[{provide:WD,useFactory:UTe(n),multi:!0,deps:[vr,Xs,bk,Nk,[new Ks,hee],[new Ks,jk],...t]}]}}(()=>{const t=ewe();t.toJSON();return t})}static auth(){return function ITe(n,...t){return{ngModule:OTe,providers:[{provide:GD,useFactory:bTe(n),multi:!0,deps:[vr,Xs,bk,Nk,[new Ks,jk],...t]}]}}(()=>{const t=kTe();return t})}}let gft=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=qs({type:n,bootstrap:[Cct]}),n.\u0275inj=Fr({providers:[Es,VM,jD,Ng,kM,HM,{provide:H3,useValue:Og.getLocale()}],imports:[UV.app(),UV.firestore(),UV.auth(),DU,l5e,bfe.forRoot(pft,{useHash:!1}),WG,j8e,Lde,LDe]}),n})();!function r5(n,t,e){const r=n.\u0275cmp;r.directiveDefs=()=>("function"==typeof t?t():t).map(Eh),r.pipeDefs=()=>("function"==typeof e?e():e).map(D2)}(fo,function(){return[On,Fn,hn,Ll,kl,jo]},[]);var mft=Na(7742);function Uce(){(function l6e(){R$=!1})(),zue().bootstrapModule(gft).catch(n=>console.error(n))}const Gce=Og.getLocale();"en"!==Gce?fetch("/assets/"+Gce+".json").then(n=>n.ok?n.json():{locale:"en",translations:{}}).then(n=>{(0,mft.XJ)(n.translations),$localize.locale=n.locale,Uce()}).catch(function(n){console.log(n)}):Uce()},2486:function(th,U8){!function(Na){"use strict";function en(ct,rt){var Yt=Object.keys(ct);if(Object.getOwnPropertySymbols){var n1=Object.getOwnPropertySymbols(ct);rt&&(n1=n1.filter(function(ws){return Object.getOwnPropertyDescriptor(ct,ws).enumerable})),Yt.push.apply(Yt,n1)}return Yt}function Xr(ct){for(var rt,Yt=1;Yt<arguments.length;Yt++)rt=arguments[Yt]??{},Yt%2?en(Object(rt),!0).forEach(function(n1){A0(ct,n1,rt[n1])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ct,Object.getOwnPropertyDescriptors(rt)):en(Object(rt)).forEach(function(n1){Object.defineProperty(ct,n1,Object.getOwnPropertyDescriptor(rt,n1))});return ct}function h3(ct,rt){if(!(ct instanceof rt))throw new TypeError("Cannot call a class as a function")}function gc(ct,rt){for(var Yt,n1=0;n1<rt.length;n1++)(Yt=rt[n1]).enumerable=Yt.enumerable||!1,Yt.configurable=!0,"value"in Yt&&(Yt.writable=!0),Object.defineProperty(ct,Yt.key,Yt)}function H1(ct,rt,Yt){return rt&&gc(ct.prototype,rt),Yt&&gc(ct,Yt),ct}function A0(ct,rt,Yt){return rt in ct?Object.defineProperty(ct,rt,{value:Yt,enumerable:!0,configurable:!0,writable:!0}):ct[rt]=Yt,ct}function mc(){var ct;return null!==(ct=d4)&&void 0!==ct?ct:document}var d3={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},Di=Xr({},d3),$s={},d4=null,nh=function(ct,rt,Yt,n1,ws){return"top-left"===ct?"left:".concat(n1,";top:").concat(rt,";text-align:left;align-items:flex-start;"):"top-right"===ct?"right:".concat(ws,";top:").concat(rt,";text-align:right;align-items:flex-end;"):"top-center"===ct?"top:".concat(rt,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===ct?"left:".concat(n1,";bottom:").concat(Yt,";text-align:left;align-items:flex-start;"):"bottom-right"===ct?"right:".concat(ws,";bottom:").concat(Yt,";text-align:right;align-items:flex-end;"):"bottom-center"===ct?"bottom:".concat(Yt,";left:0;right:0;text-align:center;align-items:center;"):"center"===ct?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0},O0=function(){function ct(rt){var Yt=this;h3(this,ct),this.element=mc().createElement("div"),this.opacity=rt.opacity,this.type=rt.type,this.animate=rt.animate,this.dismissible=rt.dismissible,this.closeOnClick=rt.closeOnClick,this.message=rt.message,this.duration=rt.duration,this.pauseOnHover=rt.pauseOnHover,this.offsetTop=rt.offsetTop,this.offsetBottom=rt.offsetBottom,this.offsetLeft=rt.offsetLeft,this.offsetRight=rt.offsetRight,this.extraClasses=rt.extraClasses;var n1="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),ws=["notification",this.extraClasses];if(this.type&&ws.push(this.type),this.animate&&this.animate.in){var yn="animate__".concat(this.animate.in),er=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";ws.push("animate__animated ".concat(yn," ").concat(er)),this.onAnimationEnd(function(){return Yt.element.classList.remove(yn)})}if(this.element.className=ws.join(" "),this.dismissible){var p3=mc().createElement("button");p3.className="delete",p3.addEventListener("click",function(){Yt.destroy()}),this.element.insertAdjacentElement("afterbegin",p3)}else n1+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){Yt.destroy()}),this.element.setAttribute("style",n1),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var G8=new vc(function(){Yt.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){G8.pause()}),this.element.addEventListener("mouseout",function(){G8.resume()}))}return H1(ct,[{key:"destroy",value:function(){var rt=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){rt.removeParent(rt.element.parentNode),rt.element.remove(),delete $s.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete $s.position)}},{key:"removeParent",value:function(rt){rt&&1>=rt.children.length&&rt.remove()}},{key:"onAnimationEnd",value:function(){var rt=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},Yt={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var n1 in Yt)if(void 0!==this.element.style[n1]){this.element.addEventListener(Yt[n1],function(){return rt()});break}}}]),ct}(),vc=function(){function ct(rt,Yt){h3(this,ct),this.remaining=Yt,this.callback=rt,this.resume()}return H1(ct,[{key:"pause",value:function(){typeof document>"u"||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){typeof document>"u"||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),ct}();Na.resetDefaults=function(){Di=Xr({},d3)},Na.setDefaults=function(ct){Di=Xr(Xr({},d3),ct)},Na.setDoc=function Aa(ct){for(var rt in $s)$s[rt].remove();$s={},d4=ct},Na.toast=function _c(ct){if(!ct.message)throw new Error("message is required");var rt=Xr(Xr({},Di),ct),Yt=new O0(rt),n1=function ln(ct,rt,Yt,n1,ws,yn){if($s.position)return $s.position;var er=mc().createElement("div");return er.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+nh(rt,Yt,n1,ws,yn)),ct.appendChild(er),$s.position=er,er}(rt.appendTo||mc().body,rt.position||Di.position,rt.offsetTop||Di.offsetTop,rt.offsetBottom||Di.offsetBottom,rt.offsetLeft||Di.offsetLeft,rt.offsetRight||Di.offsetRight);if(rt.single)for(var ws=n1.lastElementChild;ws;)n1.removeChild(ws),ws=n1.lastElementChild;n1.appendChild(Yt.element)},Object.defineProperty(Na,"__esModule",{value:!0})}(U8)},7742:(th,U8,Na)=>{"use strict";Na.d(U8,{XJ:()=>Tu,pQ:()=>nC,Q:()=>jw});class un{constructor(a){this.digits=a}static zero(){return new un([0])}static one(){return new un([1])}clone(){return new un(this.digits.slice())}add(a){const l=this.clone();return l.addToSelf(a),l}addToSelf(a){const l=Math.max(this.digits.length,a.digits.length);let f=0;for(let p=0;p<l;p++){let _=f;p<this.digits.length&&(_+=this.digits[p]),p<a.digits.length&&(_+=a.digits[p]),_>=10?(this.digits[p]=_-10,f=1):(this.digits[p]=_,f=0)}f>0&&(this.digits[l]=1)}toString(){let a="";for(let l=this.digits.length-1;l>=0;l--)a+=this.digits[l];return a}}class j8{constructor(a){this.powerOfTwos=[a]}getValue(){return this.powerOfTwos[0]}multiplyBy(a){const l=un.zero();return this.multiplyByAndAddTo(a,l),l}multiplyByAndAddTo(a,l){for(let f=0;0!==a;a>>>=1,f++)if(1&a){const p=this.getMultipliedByPowerOfTwo(f);l.addToSelf(p)}}getMultipliedByPowerOfTwo(a){for(let l=this.powerOfTwos.length;l<=a;l++){const f=this.powerOfTwos[l-1];this.powerOfTwos[l]=f.add(f)}return this.powerOfTwos[a]}}class qV{constructor(a){this.base=a,this.exponents=[new j8(un.one())]}toThePowerOf(a){for(let l=this.exponents.length;l<=a;l++){const f=this.exponents[l-1].multiplyBy(this.base);this.exponents[l]=new j8(f)}return this.exponents[a]}}function Cm(d){const a=function pi(d){let a=[];for(let l=0;l<d.length;l++){let f=d.charCodeAt(l);if(f>=55296&&f<=56319&&d.length>l+1){const p=d.charCodeAt(l+1);p>=56320&&p<=57343&&(l++,f=(f-55296<<10)+p-56320+65536)}f<=127?a.push(f):f<=2047?a.push(f>>6&31|192,63&f|128):f<=65535?a.push(f>>12|224,f>>6&63|128,63&f|128):f<=2097151&&a.push(f>>18&7|240,f>>12&63|128,f>>6&63|128,63&f|128)}return a}(d);let l=aP(a,0),f=aP(a,102072);return 0==l&&(0==f||1==f)&&(l^=319790063,f^=-1801410264),[l,f]}function aP(d,a){let p,l=2654435769,f=2654435769;const _=d.length;for(p=0;p+12<=_;p+=12){l=L2(l,Dl(d,p,Hr.Little)),f=L2(f,Dl(d,p+4,Hr.Little));const C=cP(l,f,a=L2(a,Dl(d,p+8,Hr.Little)));l=C[0],f=C[1],a=C[2]}return l=L2(l,Dl(d,p,Hr.Little)),f=L2(f,Dl(d,p+4,Hr.Little)),a=L2(a,_),cP(l,f,a=L2(a,Dl(d,p+8,Hr.Little)<<8))[2]}function cP(d,a,l){return d=Us(d,a),d=Us(d,l),d^=l>>>13,a=Us(a,l),a=Us(a,d),a^=d<<8,l=Us(l,d),l=Us(l,a),l^=a>>>13,d=Us(d,a),d=Us(d,l),d^=l>>>12,a=Us(a,l),a=Us(a,d),a^=d<<16,l=Us(l,d),l=Us(l,a),l^=a>>>5,d=Us(d,a),d=Us(d,l),d^=l>>>3,a=Us(a,l),a=Us(a,d),a^=d<<10,l=Us(l,d),l=Us(l,a),[d,a,l^=a>>>15]}var Hr=(()=>((Hr=Hr||{})[Hr.Little=0]="Little",Hr[Hr.Big=1]="Big",Hr))();function L2(d,a){return lP(d,a)[1]}function lP(d,a){const l=(65535&d)+(65535&a),f=(d>>>16)+(a>>>16)+(l>>>16);return[f>>>16,f<<16|65535&l]}function Us(d,a){const l=(65535&d)-(65535&a);return(d>>16)-(a>>16)+(l>>16)<<16|65535&l}function Em(d,a){return a>=d.length?0:d[a]}function Dl(d,a,l){let f=0;if(l===Hr.Big)for(let p=0;p<4;p++)f+=Em(d,a+p)<<24-8*p;else for(let p=0;p<4;p++)f+=Em(d,a+p)<<8*p;return f}const ch=new qV(256);function Xv(d,a,l,f,p=[]){const _={},C={},b={},L=function Qv(d,a){const{text:l,block:f}=p7(d,a);if(void 0===f)return{text:l};{const[p,..._]=f.split("\u241f"),[C,b]=p.split("@@",2);let[L,D]=C.split("|",2);return void 0===D&&(D=L,L=void 0),""===D&&(D=void 0),{text:l,meaning:L,description:D,customId:b,legacyIds:_}}}(d[0],d.raw[0]),D=[L.text],$=[];let ne=L.text;for(let ke=1;ke<d.length;ke++){const{messagePart:gt,placeholderName:Je=Vc(ke),associatedMessageId:pt}=Jv(d[ke],d.raw[ke]);ne+=`{$${Je}}${gt}`,void 0!==a&&(_[Je]=a[ke-1],C[Je]=p[ke-1]),$.push(Je),void 0!==pt&&(b[Je]=pt),D.push(gt)}const Ee=L.customId||function ym(d,a=""){let l=Cm(d);if(a){const _=Cm(a);l=function uP(d,a){const l=d[0],p=a[0],C=lP(d[1],a[1]),b=C[0],L=C[1];return[L2(L2(l,p),b),L]}(function YV(d,a){const l=d[0],f=d[1];return[l<<a|f>>>32-a,f<<a|l>>>32-a]}(l,1),_)}return function Pm(d,a){const l=ch.toThePowerOf(0).multiplyBy(a);return ch.toThePowerOf(4).multiplyByAndAddTo(d,l),l.toString()}(2147483647&l[0],l[1])}(ne,L.meaning||""),Re=L.legacyIds?L.legacyIds.filter(ke=>ke!==Ee):[];return{id:Ee,legacyIds:Re,substitutions:_,substitutionLocations:C,text:ne,customId:L.customId,meaning:L.meaning||"",description:L.description||"",messageParts:D,messagePartLocations:f,placeholderNames:$,associatedMessageIds:b,location:l}}function Jv(d,a){const{text:l,block:f}=p7(d,a);if(void 0===f)return{messagePart:l};{const[p,_]=f.split("@@");return{messagePart:l,placeholderName:p,associatedMessageId:_}}}function p7(d,a){if(":"!==a.charAt(0))return{text:d};{const l=Pu(d,a);return{block:d.substring(1,l),text:d.substring(l+1)}}}function Vc(d){return 1===d?"PH":"PH_"+(d-1)}function Pu(d,a){for(let l=1,f=1;l<d.length;l++,f++)if("\\"===a[f])f++;else if(":"===d[l])return l;throw new Error(`Unterminated $localize metadata block in "${a}".`)}class g7 extends Error{constructor(a){super(`No translation found for ${tC(a)}.`),this.parsedMessage=a,this.type="MissingTranslationError"}}function eC(d,a){return Object.defineProperty(d,"raw",{value:a}),d}function tC(d){const a=d.meaning&&` - "${d.meaning}"`,l=d.legacyIds&&d.legacyIds.length>0?` [${d.legacyIds.map(f=>`"${f}"`).join(", ")}]`:"";return`"${d.id}"${l} ("${d.text}"${a})`}function Tu(d){$localize.translate||($localize.translate=sF),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(d).forEach(a=>{$localize.TRANSLATIONS[a]=function l9(d){const a=d.split(/{\$([^}]*)}/),l=[a[0]],f=[];for(let _=1;_<a.length-1;_+=2)f.push(a[_]),l.push(`${a[_+1]}`);const p=l.map(_=>":"===_.charAt(0)?"\\"+_:_);return{text:d,messageParts:eC(l,p),placeholderNames:f}}(d[a])})}function sF(d,a){try{return function Ww(d,a,l){const f=Xv(a,l);let p=d[f.id];if(void 0!==f.legacyIds)for(let _=0;_<f.legacyIds.length&&void 0===p;_++)p=d[f.legacyIds[_]];if(void 0===p)throw new g7(f);return[p.messageParts,p.placeholderNames.map(_=>{if(f.substitutions.hasOwnProperty(_))return f.substitutions[_];throw new Error(`There is a placeholder name mismatch with the translation provided for the message ${tC(f)}.\nThe translation contains a placeholder with name ${_}, which does not exist in the message.`)})]}($localize.TRANSLATIONS,d,a)}catch(l){return console.warn(l.message),[d,a]}}const jw=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),nC=function(d,...a){if(nC.translate){const f=nC.translate(d,a);d=f[0],a=f[1]}let l=rC(d[0],d.raw[0]);for(let f=1;f<d.length;f++)l+=a[f-1]+rC(d[f],d.raw[f]);return l};function rC(d,a){return":"===a.charAt(0)?d.substring(Pu(d,a)+1):d}}},th=>{th(th.s=8740)}]);