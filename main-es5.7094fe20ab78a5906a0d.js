!function(){var e,t,n,r,i,a,o,s,u,c,l,h,f,d,v,p,g,y,m,k,_,w,C,b,E,S,P,O,T,I,x,A,R,N,M,D,L,F,B,V,U,z,H,G,q,$,W,j,Z,Y,K,J,Q,X,ee,te,ne,re,ie,ae,oe,se,ue,ce,le,he,fe,de,ve,pe,ge,ye,me,ke,_e,we,Ce,be,Ee,Se,Pe,Oe,Te,Ie,xe,Ae,Re,Ne,Me,De,Le,Fe,Be,Ve,Ue,ze,He,Ge,qe,$e,We,je,Ze,Ye,Ke,Je,Qe,Xe,et,tt,nt,rt,it,at,ot,st,ut,ct,lt,ht,ft,dt,vt,pt,gt,yt,mt,kt,_t,wt,Ct,bt,Et,St,Pt,Ot,Tt,It,xt,At,Rt,Nt,Mt,Dt,Lt,Ft,Bt,Vt,Ut,zt,Ht,Gt,qt,$t,Wt,jt,Zt,Yt,Kt,Jt,Qt,Xt,en,tn,nn,rn,an,on,sn,un,cn,ln,hn,fn,dn,vn,pn,gn,yn,mn,kn,_n,wn,Cn,bn,En,Sn,Pn,On,Tn,In,xn,An,Rn,Nn,Mn,Dn,Ln,Fn,Bn,Vn,Un,zn,Hn,Gn,qn,$n,Wn,jn,Zn,Yn,Kn,Jn,Qn,Xn,er,tr,nr,rr,ir,ar,or,sr,ur,cr,lr,hr,fr,dr,vr,pr,gr,yr,mr,kr,_r,wr,Cr,br,Er,Sr,Pr,Or,Tr,Ir,xr,Ar,Rr,Nr,Mr,Dr,Lr,Fr,Br,Vr,Ur,zr,Hr,Gr,qr,$r,Wr,jr,Zr,Yr,Kr,Jr,Qr,Xr,ei,ti,ni,ri,ii,ai,oi,si,ui,ci,li,hi,fi,di,vi,pi,gi,yi,mi,ki,_i,wi,Ci,bi,Ei,Si,Pi,Oi,Ti,Ii,xi,Ai,Ri,Ni,Mi,Di,Li,Fi,Bi,Vi,Ui,zi,Hi,Gi,qi,$i,Wi,ji,Zi,Yi,Ki,Ji,Qi,Xi,ea,ta,na,ra,ia,aa,oa,sa,ua,ca,la,ha,fa,da,va,pa,ga,ya,ma,ka,_a,wa,Ca,ba,Ea,Sa,Pa,Oa,Ta,Ia,xa,Aa,Ra,Na,Ma,Da,La,Fa,Ba,Va,Ua,za,Ha,Ga,qa,$a,Wa,ja,Za,Ya,Ka,Ja,Qa,Xa,eo,to,no,ro,io,ao,oo,so,uo,co,lo,ho,fo,vo,po,go,yo,mo,ko,_o,wo,Co,bo,Eo,So,Po,Oo,To,Io,xo,Ao,Ro,No,Mo,Do,Lo,Fo,Bo,Vo,Uo,zo,Ho,Go,qo,$o,Wo,jo,Zo,Yo,Ko,Jo,Qo,Xo,es,ts,ns,rs,is,as,os,ss,us,cs,ls,hs,fs,ds,vs,ps,gs,ys,ms,ks,_s,ws,Cs,bs,Es,Ss,Ps,Os,Ts,Is,xs,As,Rs,Ns,Ms,Ds,Ls,Fs,Bs,Vs,Us,zs,Hs,Gs,qs,$s,Ws,js,Zs,Ys,Ks,Js,Qs,Xs,eu,tu,nu,ru,iu,au,ou,su,uu,cu,lu,hu,fu,du,vu,pu,gu,yu,mu,ku,_u,wu,Cu,bu,Eu,Su,Pu,Ou,Tu,Iu,xu,Au,Ru,Nu,Mu,Du,Lu,Fu,Bu,Vu,Uu,zu,Hu,Gu,qu,$u,Wu,ju,Zu,Yu,Ku,Ju,Qu,Xu,ec,tc,nc,rc,ic,ac,oc,sc,uc,cc,lc,hc,fc,dc,vc,pc,gc,yc,mc,kc,_c,wc,Cc,bc,Ec,Sc,Pc,Oc,Tc,Ic,xc,Ac,Rc,Nc,Mc,Dc,Lc,Fc,Bc,Vc,Uc,zc,Hc,Gc,qc,$c,Wc,jc,Zc,Yc,Kc,Jc,Qc,Xc,el,tl,nl,rl,il,al,ol,sl,ul,cl,ll,hl,fl,dl,vl,pl,gl,yl,ml,kl,_l,wl,Cl,bl,El,Sl,Pl,Ol,Tl,Il,xl,Al,Rl,Nl,Ml,Dl,Ll,Fl,Bl,Vl,Ul,zl,Hl,Gl,ql,$l,Wl,jl,Zl,Yl,Kl,Jl,Ql,Xl,eh,th,nh,rh,ih,ah,oh,sh,uh,ch,lh,hh,fh,dh,vh,ph,gh,yh,mh,kh,_h,wh,Ch,bh,Eh,Sh,Ph,Oh,Th,Ih,xh,Ah,Rh,Nh,Mh,Dh,Lh,Fh,Bh,Vh,Uh,zh,Hh,Gh,qh,$h,Wh,jh,Zh,Yh,Kh,Jh,Qh,Xh,ef,tf,nf,rf,af,of,sf,uf,cf,lf,hf,ff,df,vf,pf,gf,yf,mf,kf,_f,wf,Cf,bf,Ef,Sf,Pf,Of,Tf,If,xf,Af,Rf,Nf,Mf,Df,Lf,Ff,Bf,Vf,Uf,zf,Hf,Gf,qf,$f,Wf,jf,Zf,Yf,Kf,Jf,Qf,Xf,ed,td,nd,rd,id,ad,od,sd,ud,cd,ld,hd,fd,dd,vd,pd,gd,yd,md,kd,_d,wd,Cd,bd,Ed,Sd,Pd,Od,Td,Id,xd,Ad,Rd,Nd,Md,Dd,Ld,Fd,Bd,Vd,Ud,zd,Hd,Gd,qd,$d,Wd,jd,Zd,Yd,Kd,Jd,Qd,Xd,ev,tv,nv,rv,iv,av,ov,sv,uv,cv,lv,hv,fv,dv,vv,pv,gv,yv,mv,kv,_v,wv,Cv,bv,Ev,Sv,Pv,Ov,Tv,Iv,xv,Av;function Rv(e){return Vv(e)||Qv(e)||ep(e)||Bv()}function Nv(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Mv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Dv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mv(Object(n),!0).forEach(function(t){Lv(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mv(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Lv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fv(e,t){return Vv(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(u){s=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}(e,t)||ep(e,t)||Bv()}function Bv(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Vv(e){if(Array.isArray(e))return e}function Uv(e){var t="function"==typeof Map?new Map:void 0;return(Uv=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return zv(e,arguments,Kv(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),$v(r,e)})(e)}function zv(e,t,n){return(zv=Yv()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&$v(i,n.prototype),i}).apply(null,arguments)}function Hv(){return(Hv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Gv(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function Gv(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Kv(e)););return e}function qv(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$v(e,t)}function $v(e,t){return($v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wv(e){var t=Yv();return function(){var n,r=Kv(e);if(t){var i=Kv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return jv(this,n)}}function jv(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Zv(e)}function Zv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Kv(e){return(Kv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jv(e){return function(e){if(Array.isArray(e))return tp(e)}(e)||Qv(e)||ep(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qv(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Xv(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ep(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ep(e,t){if(e){if("string"==typeof e)return tp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tp(e,t):void 0}}function tp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function np(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ip(e,t,n){return t&&rp(e.prototype,t),n&&rp(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunkEveryBoard=self.webpackChunkEveryBoard||[]).push([[179],{8255:function(e){function t(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=8255,e.exports=t},9575:function(e,t,n){var r,i,a;!function(o){if("object"==typeof e.exports){var s=o(0,t);void 0!==s&&(e.exports=s)}else i=[n,t],void 0!==(a="function"==typeof(r=o)?r.apply(t,i):r)&&(e.exports=a)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0;t.default=["fr",[["AM","PM"],n,n],n,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],n,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],n,[["av. J.-C.","ap. J.-C."],n,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1} '\xe0' {0}",n,n],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[n,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[n,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[n,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[n,"\xa5"],KMF:[n,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[n,"$C"],NZD:["$NZ","$"],RHD:["$RH"],RON:[n,"L"],RWF:[n,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[n,"$T"],TTD:["$TT","$"],TWD:[n,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[n,"$"],XPF:["FCFP"],ZMW:[n,"Kw"]},"ltr",function(e){var t=Math.floor(Math.abs(e));return 0===t||1===t?1:5}]})},5378:function(e,t){!function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(e){for(var n,r=1;r<arguments.length;r++){var i;n=null!==(i=arguments[r])&&void 0!==i?i:{},r%2?t(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){var e;return null!==(e=h)&&void 0!==e?e:document}var u={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},c=n({},u),l={},h=null,f=function(){function e(t){var n=this;r(this,e),this.element=s().createElement("div"),this.opacity=t.opacity,this.type=t.type,this.animate=t.animate,this.dismissible=t.dismissible,this.closeOnClick=t.closeOnClick,this.message=t.message,this.duration=t.duration,this.pauseOnHover=t.pauseOnHover,this.offsetTop=t.offsetTop,this.offsetBottom=t.offsetBottom,this.offsetLeft=t.offsetLeft,this.offsetRight=t.offsetRight,this.extraClasses=t.extraClasses;var i="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),a=["notification",this.extraClasses];if(this.type&&a.push(this.type),this.animate&&this.animate.in){var o="animate__".concat(this.animate.in),u=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";a.push("animate__animated ".concat(o," ").concat(u)),this.onAnimationEnd(function(){return n.element.classList.remove(o)})}if(this.element.className=a.join(" "),this.dismissible){var c=s().createElement("button");c.className="delete",c.addEventListener("click",function(){n.destroy()}),this.element.insertAdjacentElement("afterbegin",c)}else i+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){n.destroy()}),this.element.setAttribute("style",i),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var l=new d(function(){n.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){l.pause()}),this.element.addEventListener("mouseout",function(){l.resume()}))}return a(e,[{key:"destroy",value:function(){var e=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){e.removeParent(e.element.parentNode),e.element.remove(),delete l.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete l.position)}},{key:"removeParent",value:function(e){e&&1>=e.children.length&&e.remove()}},{key:"onAnimationEnd",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var n in t)if(void 0!==this.element.style[n]){this.element.addEventListener(t[n],function(){return e()});break}}}]),e}(),d=function(){function e(t,n){r(this,e),this.remaining=n,this.callback=t,this.resume()}return a(e,[{key:"pause",value:function(){"undefined"==typeof document||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){"undefined"==typeof document||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),e}();e.resetDefaults=function(){c=n({},u)},e.setDefaults=function(e){c=n(n({},u),e)},e.setDoc=function(e){for(var t in l)l[t].remove();l={},h=e},e.toast=function(e){if(!e.message)throw new Error("message is required");var t=n(n({},c),e),r=new f(t),i=function(e,t,n,r,i,a){if(l.position)return l.position;var o=s().createElement("div");return o.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+function(e,t,n,r,i){return"top-left"===e?"left:".concat(r,";top:").concat(t,";text-align:left;align-items:flex-start;"):"top-right"===e?"right:".concat(i,";top:").concat(t,";text-align:right;align-items:flex-end;"):"top-center"===e?"top:".concat(t,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===e?"left:".concat(r,";bottom:").concat(n,";text-align:left;align-items:flex-start;"):"bottom-right"===e?"right:".concat(i,";bottom:").concat(n,";text-align:right;align-items:flex-end;"):"bottom-center"===e?"bottom:".concat(n,";left:0;right:0;text-align:center;align-items:center;"):"center"===e?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0}(t,n,r,i,a)),e.appendChild(o),l.position=o,o}(t.appendTo||s().body,t.position||c.position,t.offsetTop||c.offsetTop,t.offsetBottom||c.offsetBottom,t.offsetLeft||c.offsetLeft,t.offsetRight||c.offsetRight);if(t.single)for(var a=i.lastElementChild;a;)i.removeChild(a),a=i.lastElementChild;i.appendChild(r.element)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},6676:function(e,t){!function(e){"use strict";function t(e){return Array.prototype.slice.call(e)}function n(e){return new Promise(function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function r(e,t,r){var i,a=new Promise(function(a,o){n(i=e[t].apply(e,r)).then(a,o)});return a.request=i,a}function i(e,t,n){var i=r(e,t,n);return i.then(function(e){if(e)return new l(e,i.request)})}function a(e,t,n){n.forEach(function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})})}function o(e,t,n,i){i.forEach(function(i){i in n.prototype&&(e.prototype[i]=function(){return r(this[t],i,arguments)})})}function s(e,t,n,r){r.forEach(function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})})}function u(e,t,n,r){r.forEach(function(r){r in n.prototype&&(e.prototype[r]=function(){return i(this[t],r,arguments)})})}function c(e){this._index=e}function l(e,t){this._cursor=e,this._request=t}function h(e){this._store=e}function f(e){this._tx=e,this.complete=new Promise(function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}})}function d(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new f(n)}function v(e){this._db=e}a(c,"_index",["name","keyPath","multiEntry","unique"]),o(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),a(l,"_cursor",["direction","key","primaryKey","value"]),o(l,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(e){e in IDBCursor.prototype&&(l.prototype[e]=function(){var t=this,r=arguments;return Promise.resolve().then(function(){return t._cursor[e].apply(t._cursor,r),n(t._request).then(function(e){if(e)return new l(e,t._request)})})})}),h.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},h.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},a(h,"_store",["name","keyPath","indexNames","autoIncrement"]),o(h,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(h,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(h,"_store",IDBObjectStore,["deleteIndex"]),f.prototype.objectStore=function(){return new h(this._tx.objectStore.apply(this._tx,arguments))},a(f,"_tx",["objectStoreNames","mode"]),s(f,"_tx",IDBTransaction,["abort"]),d.prototype.createObjectStore=function(){return new h(this._db.createObjectStore.apply(this._db,arguments))},a(d,"_db",["name","version","objectStoreNames"]),s(d,"_db",IDBDatabase,["deleteObjectStore","close"]),v.prototype.transaction=function(){return new f(this._db.transaction.apply(this._db,arguments))},a(v,"_db",["name","version","objectStoreNames"]),s(v,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(e){[h,c].forEach(function(n){e in n.prototype&&(n.prototype[e.replace("open","iterate")]=function(){var n=t(arguments),r=n[n.length-1],i=this._store||this._index,a=i[e].apply(i,n.slice(0,-1));a.onsuccess=function(){r(a.result)}})})}),[c,h].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise(function(i){n.iterateCursor(e,function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():i(r)):i(r)})})})}),e.openDb=function(e,t,n){var i=r(indexedDB,"open",[e,t]),a=i.request;return a&&(a.onupgradeneeded=function(e){n&&n(new d(a.result,e.oldVersion,a.transaction))}),i.then(function(e){return new v(e)})},e.deleteDb=function(e){return r(indexedDB,"deleteDatabase",[e])},Object.defineProperty(e,"__esModule",{value:!0})}(t)},2912:function(Mv,Bv,Vv){"use strict";var Gv,$v;function Yv(e){return"function"==typeof e}function Qv(e){var t=e(function(e){Error.call(e),e.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var ep=Qv(function(e){return function(t){e(this),this.message=t?"".concat(t.length," errors occurred during unsubscription:\n").concat(t.map(function(e,t){return"".concat(t+1,") ").concat(e.toString())}).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=t}});function tp(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var rp,ap=function(){function e(t){np(this,e),this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}return ip(e,[{key:"unsubscribe",value:function(){var e;if(!this.closed){this.closed=!0;var t=this._parentage;if(t)if(this._parentage=null,Array.isArray(t)){var n,r=Xv(t);try{for(r.s();!(n=r.n()).done;){var i;n.value.remove(this)}}catch(h){r.e(h)}finally{r.f()}}else t.remove(this);var a=this.initialTeardown;if(Yv(a))try{a()}catch(i){e=i instanceof ep?i.errors:[i]}var o=this._teardowns;if(o){this._teardowns=null;var s,u=Xv(o);try{for(u.s();!(s=u.n()).done;){var c=s.value;try{up(c)}catch(f){var l;e=null!==(l=e)&&void 0!==l?l:[],f instanceof ep?e=[].concat(Jv(e),Jv(f.errors)):e.push(f)}}}catch(h){u.e(h)}finally{u.f()}}if(e)throw new ep(e)}}},{key:"add",value:function(t){var n;if(t&&t!==this)if(this.closed)up(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(t)}}},{key:"_hasParent",value:function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)}},{key:"_addParent",value:function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}},{key:"_removeParent",value:function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&tp(t,e)}},{key:"remove",value:function(t){var n=this._teardowns;n&&tp(n,t),t instanceof e&&t._removeParent(this)}}]),e}();ap.EMPTY=((rp=new ap).closed=!0,rp);var op=ap.EMPTY;function sp(e){return e instanceof ap||e&&"closed"in e&&Yv(e.remove)&&Yv(e.add)&&Yv(e.unsubscribe)}function up(e){Yv(e)?e():e.unsubscribe()}var cp=null,lp=null,hp=void 0,fp=!1,dp=!1,vp={setTimeout:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=vp.delegate;return((null==e?void 0:e.setTimeout)||setTimeout).apply(void 0,arguments)}),clearTimeout:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=vp.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)}),delegate:void 0};function pp(e){vp.setTimeout(function(){if(!cp)throw e;cp(e)})}function gp(){}var yp=mp("C",void 0,void 0);function mp(e,t,n){return{kind:e,value:t,error:n}}var kp=null;function _p(e){if(fp){var t=!kp;if(t&&(kp={errorThrown:!1,error:null}),e(),t){var n=kp,r=n.errorThrown,i=n.error;if(kp=null,r)throw i}}else e()}var wp=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this)).isStopped=!1,e?(r.destination=e,sp(e)&&e.add(Zv(r))):r.destination=Pp,r}return ip(n,[{key:"next",value:function(e){this.isStopped?Sp(mp("N",e,void 0),this):this._next(e)}},{key:"error",value:function(e){this.isStopped?Sp(mp("E",void 0,e),this):(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped?Sp(yp,this):(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,Hv(Kv(n.prototype),"unsubscribe",this).call(this),this.destination=null)}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){try{this.destination.error(e)}finally{this.unsubscribe()}}},{key:"_complete",value:function(){try{this.destination.complete()}finally{this.unsubscribe()}}}],[{key:"create",value:function(e,t,n){return new Cp(e,t,n)}}]),n}(ap),Cp=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a,o,s;if(np(this,n),o=t.call(this),Yv(e))s=e;else if(e){var u,c;s=(u=e).next,r=u.error,i=u.complete,Zv(o)&&dp?(c=Object.create(e)).unsubscribe=function(){return o.unsubscribe()}:c=e,s=null==s?void 0:s.bind(c),r=null==r?void 0:r.bind(c),i=null==i?void 0:i.bind(c)}return o.destination={next:s?bp(s):gp,error:bp(null!==(a=r)&&void 0!==a?a:Ep),complete:i?bp(i):gp},jv(o)}return ip(n)}(wp);function bp(e,t){return function(){try{e.apply(void 0,arguments)}catch(t){fp?function(e){fp&&kp&&(kp.errorThrown=!0,kp.error=e)}(t):pp(t)}}}function Ep(e){throw e}function Sp(e,t){var n=lp;n&&vp.setTimeout(function(){return n(e,t)})}var Pp={closed:!0,next:gp,error:Ep,complete:gp},Op="function"==typeof Symbol&&Symbol.observable||"@@observable";function Tp(e){return e}var Ip=function(){var e=function(){function e(t){np(this,e),t&&(this._subscribe=t)}return ip(e,[{key:"lift",value:function(t){var n=new e;return n.source=this,n.operator=t,n}},{key:"subscribe",value:function(e,t,n){var r=this,i=function(e){return e&&e instanceof wp||function(e){return e&&Yv(e.next)&&Yv(e.error)&&Yv(e.complete)}(e)&&sp(e)}(e)?e:new Cp(e,t,n);return _p(function(){var e=r.operator,t=r.source;i.add(e?e.call(i,t):t?r._subscribe(i):r._trySubscribe(i))}),i}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){e.error(t)}}},{key:"forEach",value:function(e,t){var n=this;return new(t=xp(t))(function(t,r){var i=new Cp({next:function(t){try{e(t)}catch(n){r(n),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)})}},{key:"_subscribe",value:function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)}},{key:Op,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return 0===e.length?Tp:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}}(t)(this)}},{key:"toPromise",value:function(e){var t=this;return new(e=xp(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})}}]),e}();return e.create=function(t){return new e(t)},e}();function xp(e){var t;return null!==(t=null!=e?e:hp)&&void 0!==t?t:Promise}var Ap=Qv(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Rp=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.call(this)).closed=!1,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return ip(n,[{key:"lift",value:function(e){var t=new Np(this,this);return t.operator=e,t}},{key:"_throwIfClosed",value:function(){if(this.closed)throw new Ap}},{key:"next",value:function(e){var t=this;_p(function(){if(t._throwIfClosed(),!t.isStopped){var n,r=Xv(t.observers.slice());try{for(r.s();!(n=r.n()).done;){n.value.next(e)}}catch(i){r.e(i)}finally{r.f()}}})}},{key:"error",value:function(e){var t=this;_p(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}})}},{key:"complete",value:function(){var e=this;_p(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})}},{key:"unsubscribe",value:function(){this.isStopped=this.closed=!0,this.observers=null}},{key:"observed",get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}},{key:"_trySubscribe",value:function(e){return this._throwIfClosed(),Hv(Kv(n.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}},{key:"_innerSubscribe",value:function(e){var t=this.hasError,n=this.isStopped,r=this.observers;return t||n?op:(r.push(e),new ap(function(){return tp(r,e)}))}},{key:"_checkFinalizedStatuses",value:function(e){var t=this.hasError,n=this.thrownError,r=this.isStopped;t?e.error(n):r&&e.complete()}},{key:"asObservable",value:function(){var e=new Ip;return e.source=this,e}}]),n}(Ip);return e.create=function(e,t){return new Np(e,t)},e}(),Np=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this)).destination=e,i.source=r,i}return ip(n,[{key:"next",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}},{key:"error",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}},{key:"complete",value:function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}},{key:"_subscribe",value:function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:op}}]),n}(Rp);function Mp(e){return Yv(null==e?void 0:e.lift)}function Dp(e){return function(t){if(Mp(t))return t.lift(function(t){try{return e(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}var Lp=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o){var s,u,c,l;return np(this,n),(l=t.call(this,e)).onFinalize=o,l._next=r?function(t){try{r(t)}catch(n){e.error(n)}}:Hv((s=Zv(l),Kv(n.prototype)),"_next",s),l._error=a?function(t){try{a(t)}catch(n){e.error(n)}finally{this.unsubscribe()}}:Hv((u=Zv(l),Kv(n.prototype)),"_error",u),l._complete=i?function(){try{i()}catch(t){e.error(t)}finally{this.unsubscribe()}}:Hv((c=Zv(l),Kv(n.prototype)),"_complete",c),l}return ip(n,[{key:"unsubscribe",value:function(){var e,t=this.closed;Hv(Kv(n.prototype),"unsubscribe",this).call(this),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}]),n}(wp);function Fp(e,t){return Dp(function(n,r){var i=0;n.subscribe(new Lp(r,function(n){r.next(e.call(t,n,i++))}))})}function Bp(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function Vp(e){return this instanceof Vp?(this.v=e,this):new Vp(e)}function Up(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){a.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{!function(e){e.value instanceof Vp?Promise.resolve(e.value.v).then(u,c):l(a[0][2],e)}(i[e](t))}catch(n){l(a[0][3],n)}}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function zp(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){!function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}(r,i,(t=e[n](t)).done,t.value)})}}}var Hp=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function Gp(e){return Yv(null==e?void 0:e.then)}function qp(e){return Yv(e[Op])}function $p(e){return Symbol.asyncIterator&&Yv(null==e?void 0:e[Symbol.asyncIterator])}function Wp(e){return new TypeError("You provided ".concat(null!==e&&"object"==typeof e?"an invalid object":"'".concat(e,"'")," where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable."))}var jp="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Zp(e){return Yv(null==e?void 0:e[jp])}function Yp(e){return Up(this,arguments,regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.getReader(),t.prev=1;case 2:return t.next=4,Vp(n.read());case 4:if(r=t.sent,i=r.value,!r.done){t.next=11;break}return t.next=10,Vp(void 0);case 10:return t.abrupt("return",t.sent);case 11:return t.next=13,Vp(i);case 13:return t.next=15,t.sent;case 15:t.next=2;break;case 17:return t.prev=17,n.releaseLock(),t.finish(17);case 20:case"end":return t.stop()}},t,null,[[1,,17,20]])}))}function Kp(e){return Yv(null==e?void 0:e.getReader)}function Jp(e){if(e instanceof Ip)return e;if(null!=e){if(qp(e))return function(e){return new Ip(function(t){var n=e[Op]();if(Yv(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(Hp(e))return function(e){return new Ip(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(Gp(e))return function(e){return new Ip(function(t){e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,pp)})}(e);if($p(e))return Qp(e);if(Zp(e))return function(e){return new Ip(function(t){var n,r=Xv(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.next(i),t.closed)return}}catch(a){r.e(a)}finally{r.f()}t.complete()})}(e);if(Kp(e))return function(e){return Qp(Yp(e))}(e)}throw Wp(e)}function Qp(e){return new Ip(function(t){(function(e,t){var n,r,i,a;return function(e,t,n,r){return new(n||(n=Promise))(function(t,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function o(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?t(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,o)}s((r=r.apply(e,[])).next())})}(this,0,void 0,regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:o.prev=0,n=zp(e);case 2:return o.next=4,n.next();case 4:if((r=o.sent).done){o.next=9;break}if(t.next(r.value),!t.closed){o.next=7;break}return o.abrupt("return");case 7:o.next=2;break;case 9:o.next=14;break;case 11:o.prev=11,o.t0=o.catch(0),i={error:o.t0};case 14:if(o.prev=14,o.prev=15,o.t1=r&&!r.done&&(a=n.return),!o.t1){o.next=20;break}return o.next=20,a.call(n);case 20:if(o.prev=20,!i){o.next=23;break}throw i.error;case 23:return o.finish(20);case 24:return o.finish(14);case 25:t.complete();case 26:case"end":return o.stop()}},o,null,[[0,11,14,25],[15,,20,24]])}))})(e,t).catch(function(e){return t.error(e)})})}function Xp(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!i)return a}function eg(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return Yv(t)?eg(function(n,r){return Fp(function(e,i){return t(n,e,r,i)})(Jp(e(n,r)))},n):("number"==typeof t&&(n=t),Dp(function(t,r){return function(e,t,n,r,i,a,o,s){var u=[],c=0,l=0,h=!1,f=function(){h&&!u.length&&!c&&t.complete()},d=function e(i){c++;var a=!1;Jp(n(i,l++)).subscribe(new Lp(t,function(e){t.next(e)},function(){a=!0},void 0,function(){if(a)try{for(c--;u.length&&c<r;){var n=u.shift();e(n)}f()}catch(n){t.error(n)}}))};return e.subscribe(new Lp(t,function(e){return c<r?d(e):u.push(e)},function(){h=!0,f()})),function(){}}(t,r,e,n)}))}function tg(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0;return eg(Tp,e)}var ng=new Ip(function(e){return e.complete()});function rg(e){return e[e.length-1]}function ig(e){return Yv(rg(e))?e.pop():void 0}function ag(e){return function(e){return e&&Yv(e.schedule)}(rg(e))?e.pop():void 0}function og(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Dp(function(n,r){n.subscribe(new Lp(r,function(n){return Xp(r,e,function(){return r.next(n)},t)},function(){return Xp(r,e,function(){return r.complete()},t)},function(n){return Xp(r,e,function(){return r.error(n)},t)}))})}function sg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Dp(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function ug(e,t){if(!e)throw new Error("Iterable cannot be null");return new Ip(function(n){Xp(n,t,function(){var r=e[Symbol.asyncIterator]();Xp(n,t,function(){r.next().then(function(e){e.done?n.complete():n.next(e.value)})},0,!0)})})}function cg(e,t){return t?function(e,t){if(null!=e){if(qp(e))return function(e,t){return Jp(e).pipe(sg(t),og(t))}(e,t);if(Hp(e))return function(e,t){return new Ip(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(Gp(e))return function(e,t){return Jp(e).pipe(sg(t),og(t))}(e,t);if($p(e))return ug(e,t);if(Zp(e))return function(e,t){return new Ip(function(n){var r;return Xp(n,t,function(){r=e[jp](),Xp(n,t,function(){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(a){return void n.error(a)}t?n.complete():n.next(e)},0,!0)}),function(){return Yv(null==r?void 0:r.return)&&r.return()}})}(e,t);if(Kp(e))return function(e,t){return ug(Yp(e),t)}(e,t)}throw Wp(e)}(e,t):Jp(e)}function lg(e){return e<=0?function(){return ng}:Dp(function(t,n){var r=0;t.subscribe(new Lp(n,function(t){++r<=e&&(n.next(t),e<=r&&n.complete())}))})}function hg(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return!0===t?(e(),null):!1===t?null:t.apply(void 0,r).pipe(lg(1)).subscribe(function(){return e()})}function fg(e){for(var t in e)if(e[t]===fg)return t;throw Error("Could not find renamed property on target object.")}function dg(e,t){for(var n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function vg(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(vg).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return"".concat(e.overriddenName);if(e.name)return"".concat(e.name);var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function pg(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}var gg=fg({__forward_ref__:fg});function yg(e){return e.__forward_ref__=yg,e.toString=function(){return vg(this())},e}function mg(e){return kg(e)?e():e}function kg(e){return"function"==typeof e&&e.hasOwnProperty(gg)&&e.__forward_ref__===yg}var _g=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this,function(e,t){return"".concat(e?"NG0".concat(e,": "):"").concat(t)}(e,r))).code=e,i}return ip(n)}(Uv(Error));function wg(e){return"string"==typeof e?e:null==e?"":String(e)}function Cg(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():wg(e)}function bg(e,t){var n=t?" in ".concat(t):"";throw new _g("201","No provider for ".concat(Cg(e)," found").concat(n))}function Eg(e,t,n,r){throw new Error("ASSERTION ERROR: ".concat(e)+(null==r?"":" [Expected=> ".concat(n," ").concat(r," ").concat(t," <=Actual]")))}function Sg(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Pg(e){return{providers:e.providers||[],imports:e.imports||[]}}function Og(e){return Tg(e,Ag)||Tg(e,Ng)}function Tg(e,t){return e.hasOwnProperty(t)?e[t]:null}function Ig(e){return e&&(e.hasOwnProperty(Rg)||e.hasOwnProperty(Mg))?e[Rg]:null}var xg,Ag=fg({"\u0275prov":fg}),Rg=fg({"\u0275inj":fg}),Ng=fg({ngInjectableDef:fg}),Mg=fg({ngInjectorDef:fg}),Dg=((Dg=Dg||{})[Dg.Default=0]="Default",Dg[Dg.Host=1]="Host",Dg[Dg.Self=2]="Self",Dg[Dg.SkipSelf=4]="SkipSelf",Dg[Dg.Optional=8]="Optional",Dg);function Lg(e){var t=xg;return xg=e,t}function Fg(e,t,n){var r=Og(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&Dg.Optional?null:void 0!==t?t:void bg(vg(e),"Injector")}function Bg(e){return{toString:e}.toString()}var Vg=((Vg=Vg||{})[Vg.OnPush=0]="OnPush",Vg[Vg.Default=1]="Default",Vg),Ug=((Ug=Ug||{})[Ug.Emulated=0]="Emulated",Ug[Ug.None=2]="None",Ug[Ug.ShadowDom=3]="ShadowDom",Ug),zg="undefined"!=typeof globalThis&&globalThis,Hg="undefined"!=typeof window&&window,Gg="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,qg=zg||"undefined"!=typeof global&&global||Hg||Gg,$g={},Wg=[],jg=fg({"\u0275cmp":fg}),Zg=fg({"\u0275dir":fg}),Yg=fg({"\u0275pipe":fg}),Kg=fg({"\u0275mod":fg}),Jg=fg({"\u0275loc":fg}),Qg=fg({"\u0275fac":fg}),Xg=fg({__NG_ELEMENT_ID__:fg}),ey=0;function ty(e){return Bg(function(){var t={},n={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===Vg.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||Wg,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||Ug.Emulated,id:"c",styles:e.styles||Wg,_:null,setInput:null,schemas:e.schemas||null,tView:null},r=e.directives,i=e.features,a=e.pipes;return n.id+=ey++,n.inputs=oy(e.inputs,t),n.outputs=oy(e.outputs),i&&i.forEach(function(e){return e(n)}),n.directiveDefs=r?function(){return("function"==typeof r?r():r).map(ny)}:null,n.pipeDefs=a?function(){return("function"==typeof a?a():a).map(ry)}:null,n})}function ny(e){return cy(e)||function(e){return e[Zg]||null}(e)}function ry(e){return function(e){return e[Yg]||null}(e)}var iy={};function ay(e){return Bg(function(){var t={type:e.type,bootstrap:e.bootstrap||Wg,declarations:e.declarations||Wg,imports:e.imports||Wg,exports:e.exports||Wg,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(iy[e.id]=e.type),t})}function oy(e,t){if(null==e)return $g;var n={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],a=i;Array.isArray(i)&&(a=i[1],i=i[0]),n[i]=r,t&&(t[i]=a)}return n}var sy=ty;function uy(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function cy(e){return e[jg]||null}function ly(e,t){var n=e[Kg]||null;if(!n&&!0===t)throw new Error("Type ".concat(vg(e)," does not have '\u0275mod' property."));return n}function hy(e){return Array.isArray(e)&&"object"==typeof e[1]}function fy(e){return Array.isArray(e)&&!0===e[1]}function dy(e){return 0!=(8&e.flags)}function vy(e){return 2==(2&e.flags)}function py(e){return 1==(1&e.flags)}function gy(e){return null!==e.template}function yy(e){return 0!=(512&e[2])}function my(e,t){return e.hasOwnProperty(Qg)?e[Qg]:null}var ky=function(){function e(t,n,r){np(this,e),this.previousValue=t,this.currentValue=n,this.firstChange=r}return ip(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}();function _y(){return wy}function wy(e){return e.type.prototype.ngOnChanges&&(e.setInput=by),Cy}function Cy(){var e=Sy(this),t=null==e?void 0:e.current;if(t){var n=e.previous;if(n===$g)e.previous=t;else for(var r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function by(e,t,n,r){var i=Sy(e)||function(e,t){return e[Ey]=t}(e,{previous:$g,current:null}),a=i.current||(i.current={}),o=i.previous,s=this.declaredInputs[n],u=o[s];a[s]=new ky(u&&u.currentValue,t,o===$g),e[r]=t}_y.ngInherit=!0;var Ey="__ngSimpleChanges__";function Sy(e){return e[Ey]||null}var Py,Oy="http://www.w3.org/2000/svg";function Ty(){return void 0!==Py?Py:"undefined"!=typeof document?document:void 0}function Iy(e){return!!e.listen}var xy={createRenderer:function(e,t){return Ty()}};function Ay(e){for(;Array.isArray(e);)e=e[0];return e}function Ry(e,t){return Ay(t[e])}function Ny(e,t){return Ay(t[e.index])}function My(e,t){return e.data[t]}function Dy(e,t){return e[t]}function Ly(e,t){var n=t[e];return hy(n)?n:n[0]}function Fy(e){return 4==(4&e[2])}function By(e){return 128==(128&e[2])}function Vy(e,t){return null==t?null:e[t]}function Uy(e){e[18]=0}function zy(e,t){e[5]+=t;for(var n=e,r=e[3];null!==r&&(1===t&&1===n[5]||-1===t&&0===n[5]);)r[5]+=t,n=r,r=r[3]}var Hy={lFrame:vm(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Gy(){return Hy.bindingsEnabled}function qy(){return Hy.lFrame.lView}function $y(){return Hy.lFrame.tView}function Wy(e){return Hy.lFrame.contextLView=e,e[8]}function jy(){for(var e=Zy();null!==e&&64===e.type;)e=e.parent;return e}function Zy(){return Hy.lFrame.currentTNode}function Yy(){var e=Hy.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}function Ky(e,t){var n=Hy.lFrame;n.currentTNode=e,n.isParent=t}function Jy(){return Hy.lFrame.isParent}function Qy(){Hy.lFrame.isParent=!1}function Xy(){return Hy.isInCheckNoChangesMode}function em(e){Hy.isInCheckNoChangesMode=e}function tm(){var e=Hy.lFrame,t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function nm(){return Hy.lFrame.bindingIndex}function rm(){return Hy.lFrame.bindingIndex++}function im(e){var t=Hy.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function am(e){Hy.lFrame.inI18n=e}function om(e,t){var n=Hy.lFrame;n.bindingIndex=n.bindingRootIndex=e,sm(t)}function sm(e){Hy.lFrame.currentDirectiveIndex=e}function um(){return Hy.lFrame.currentQueryIndex}function cm(e){Hy.lFrame.currentQueryIndex=e}function lm(e){var t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function hm(e,t,n){if(n&Dg.SkipSelf){for(var r=t,i=e;!(null!==(r=r.parent)||n&Dg.Host||(r=lm(i),null===r||(i=i[15],10&r.type))););if(null===r)return!1;t=r,e=i}var a=Hy.lFrame=dm();return a.currentTNode=t,a.lView=e,!0}function fm(e){var t=dm(),n=e[1];Hy.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function dm(){var e=Hy.lFrame,t=null===e?null:e.child;return null===t?vm(e):t}function vm(e){var t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function pm(){var e=Hy.lFrame;return Hy.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}var gm=pm;function ym(){var e=pm();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function mm(){return Hy.lFrame.selectedIndex}function km(e){Hy.lFrame.selectedIndex=e}function _m(){var e=Hy.lFrame;return My(e.tView,e.selectedIndex)}function wm(){Hy.lFrame.currentNamespace=Oy}function Cm(e,t){for(var n=t.directiveStart,r=t.directiveEnd;n<r;n++){var i=e.data[n].type.prototype,a=i.ngAfterContentInit,o=i.ngAfterContentChecked,s=i.ngAfterViewInit,u=i.ngAfterViewChecked,c=i.ngOnDestroy;a&&(e.contentHooks||(e.contentHooks=[])).push(-n,a),o&&((e.contentHooks||(e.contentHooks=[])).push(n,o),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,o)),s&&(e.viewHooks||(e.viewHooks=[])).push(-n,s),u&&((e.viewHooks||(e.viewHooks=[])).push(n,u),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,u)),null!=c&&(e.destroyHooks||(e.destroyHooks=[])).push(n,c)}}function bm(e,t,n){Pm(e,t,3,n)}function Em(e,t,n,r){(3&e[2])===n&&Pm(e,t,n,r)}function Sm(e,t){var n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function Pm(e,t,n,r){for(var i=null!=r?r:-1,a=t.length-1,o=0,s=void 0!==r?65535&e[18]:0;s<a;s++)if("number"==typeof t[s+1]){if(o=t[s],null!=r&&o>=r)break}else t[s]<0&&(e[18]+=65536),(o<i||-1==i)&&(Om(e,n,t,s),e[18]=(4294901760&e[18])+s+2),s++}function Om(e,t,n,r){var i=n[r]<0,a=n[r+1],o=e[i?-n[r]:n[r]];if(i){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{a.call(o)}finally{}}}else try{a.call(o)}finally{}}var Tm=ip(function e(t,n,r){np(this,e),this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r});function Im(e,t,n){for(var r=Iy(e),i=0;i<n.length;){var a=n[i];if("number"==typeof a){if(0!==a)break;i++;var o=n[i++],s=n[i++],u=n[i++];r?e.setAttribute(t,s,u,o):t.setAttributeNS(o,s,u)}else{var c=a,l=n[++i];Am(c)?r&&e.setProperty(t,c,l):r?e.setAttribute(t,c,l):t.setAttribute(c,l),i++}}return i}function xm(e){return 3===e||4===e||6===e}function Am(e){return 64===e.charCodeAt(0)}function Rm(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else for(var n=-1,r=0;r<t.length;r++){var i=t[r];"number"==typeof i?n=i:0===n||Nm(e,n,i,null,-1===n||2===n?t[++r]:null)}return e}function Nm(e,t,n,r,i){var a=0,o=e.length;if(-1===t)o=-1;else for(;a<e.length;){var s=e[a++];if("number"==typeof s){if(s===t){o=-1;break}if(s>t){o=a-1;break}}}for(;a<e.length;){var u=e[a];if("number"==typeof u)break;if(u===n){if(null===r)return void(null!==i&&(e[a+1]=i));if(r===e[a+1])return void(e[a+2]=i)}a++,null!==r&&a++,null!==i&&a++}-1!==o&&(e.splice(o,0,t),a=o+1),e.splice(a++,0,n),null!==r&&e.splice(a++,0,r),null!==i&&e.splice(a++,0,i)}function Mm(e){return-1!==e}function Dm(e){return 32767&e}function Lm(e,t){for(var n=function(e){return e>>16}(e),r=t;n>0;)r=r[15],n--;return r}var Fm=!0;function Bm(e){var t=Fm;return Fm=e,t}var Vm=0;function Um(e,t){var n=Hm(e,t);if(-1!==n)return n;var r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,zm(r.data,e),zm(t,null),zm(r.blueprint,null));var i=Gm(e,t),a=e.injectorIndex;if(Mm(i))for(var o=Dm(i),s=Lm(i,t),u=s[1].data,c=0;c<8;c++)t[a+c]=s[o+c]|u[o+c];return t[a+8]=i,a}function zm(e,t){e.push(0,0,0,0,0,0,0,0,t)}function Hm(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function Gm(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;for(var n=0,r=null,i=t;null!==i;){var a=i[1],o=a.type;if(null===(r=2===o?a.declTNode:1===o?i[6]:null))return-1;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function qm(e,t,n){!function(e,t,n){var r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(Xg)&&(r=n[Xg]),null==r&&(r=n[Xg]=Vm++);var i=255&r;t.data[e+(i>>5)]|=1<<i}(e,t,n)}function $m(e,t,n){if(n&Dg.Optional)return e;bg(t,"NodeInjector")}function Wm(e,t,n,r){if(n&Dg.Optional&&void 0===r&&(r=null),0==(n&(Dg.Self|Dg.Host))){var i=e[9],a=Lg(void 0);try{return i?i.get(t,r,n&Dg.Optional):Fg(t,r,n&Dg.Optional)}finally{Lg(a)}}return $m(r,t,n)}function jm(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Dg.Default,i=arguments.length>4?arguments[4]:void 0;if(null!==e){var a=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;var t=e.hasOwnProperty(Xg)?e[Xg]:void 0;return"number"==typeof t?t>=0?255&t:Ym:t}(n);if("function"==typeof a){if(!hm(t,e,r))return r&Dg.Host?$m(i,n,r):Wm(t,n,r,i);try{var o=a(r);if(null!=o||r&Dg.Optional)return o;bg(n)}finally{gm()}}else if("number"==typeof a){var s=null,u=Hm(e,t),c=-1,l=r&Dg.Host?t[16][6]:null;for((-1===u||r&Dg.SkipSelf)&&(-1!==(c=-1===u?Gm(e,t):t[u+8])&&ek(r,!1)?(s=t[1],u=Dm(c),t=Lm(c,t)):u=-1);-1!==u;){var h=t[1];if(Xm(a,u,h.data)){var f=Km(u,t,n,s,r,l);if(f!==Zm)return f}-1!==(c=t[u+8])&&ek(r,t[1].data[u+8]===l)&&Xm(a,u,t)?(s=h,u=Dm(c),t=Lm(c,t)):u=-1}}}return Wm(t,n,r,i)}var Zm={};function Ym(){return new tk(jy(),qy())}function Km(e,t,n,r,i,a){var o=t[1],s=o.data[e+8],u=Jm(s,o,n,null==r?vy(s)&&Fm:r!=o&&0!=(3&s.type),i&Dg.Host&&a===s);return null!==u?Qm(t,o,u,s):Zm}function Jm(e,t,n,r,i){for(var a=e.providerIndexes,o=t.data,s=1048575&a,u=e.directiveStart,c=a>>20,l=i?s+c:e.directiveEnd,h=r?s:s+c;h<l;h++){var f=o[h];if(h<u&&n===f||h>=u&&f.type===n)return h}if(i){var d=o[u];if(d&&gy(d)&&d.type===n)return u}return null}function Qm(e,t,n,r){var i=e[n],a=t.data;if(function(e){return e instanceof Tm}(i)){var o=i;o.resolving&&function(e,t){throw new _g("200","Circular dependency in DI detected for ".concat(e))}(Cg(a[n]));var s=Bm(o.canSeeViewProviders);o.resolving=!0;var u=o.injectImpl?Lg(o.injectImpl):null;hm(e,r,Dg.Default);try{i=e[n]=o.factory(void 0,a,e,r),t.firstCreatePass&&n>=r.directiveStart&&function(e,t,n){var r=t.type.prototype,i=r.ngOnChanges,a=r.ngOnInit,o=r.ngDoCheck;if(i){var s=wy(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s)}a&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,a),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,o))}(n,a[n],t)}finally{null!==u&&Lg(u),Bm(s),o.resolving=!1,gm()}}return i}function Xm(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function ek(e,t){return!(e&Dg.Self||e&Dg.Host&&t)}var tk=function(){function e(t,n){np(this,e),this._tNode=t,this._lView=n}return ip(e,[{key:"get",value:function(e,t,n){return jm(this._tNode,this._lView,e,n,t)}}]),e}();function nk(e){return Bg(function(){for(var t=e.prototype.constructor,n=t[Qg]||rk(t),r=Object.prototype,i=Object.getPrototypeOf(e.prototype).constructor;i&&i!==r;){var a=i[Qg]||rk(i);if(a&&a!==n)return a;i=Object.getPrototypeOf(i)}return function(e){return new e}})}function rk(e){return kg(e)?function(){var t=rk(mg(e));return t&&t()}:my(e)}function ik(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;var n=e.attrs;if(n)for(var r=n.length,i=0;i<r;){var a=n[i];if(xm(a))break;if(0===a)i+=2;else if("number"==typeof a)for(i++;i<r&&"string"==typeof n[i];)i++;else{if(a===t)return n[i+1];i+=2}}return null}(jy(),e)}var ak="__parameters__";function ok(e,t,n){return Bg(function(){var r=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var n in t)this[n]=t[n]}}}(t);function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this instanceof i)return r.apply(this,t),this;var a=zv(i,t);return o.annotation=a,o;function o(e,t,n){for(var r=e.hasOwnProperty(ak)?e[ak]:Object.defineProperty(e,ak,{value:[]})[ak];r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(a),e}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i})}var sk=function(){function e(t,n){np(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Sg({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return ip(e,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),e}(),uk=new sk("AnalyzeForEntryComponents"),ck=Function;function lk(e,t){void 0===t&&(t=e);for(var n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?(t===e&&(t=e.slice(0,n)),lk(r,t)):t!==e&&t.push(r)}return t}function hk(e,t){e.forEach(function(e){return Array.isArray(e)?hk(e,t):t(e)})}function fk(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function dk(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function vk(e,t){for(var n=[],r=0;r<e;r++)n.push(t);return n}function pk(e,t,n){var r=yk(e,t);return r>=0?e[1|r]=n:function(e,t,n,r){var i=e.length;if(i==t)e.push(n,r);else if(1===i)e.push(r,e[0]),e[0]=n;else{for(i--,e.push(e[i-1],e[i]);i>t;)e[i]=e[i-2],i--;e[t]=n,e[t+1]=r}}(e,r=~r,t,n),r}function gk(e,t){var n=yk(e,t);if(n>=0)return e[1|n]}function yk(e,t){return function(e,t,n){for(var r=0,i=e.length>>1;i!==r;){var a=r+(i-r>>1),o=e[a<<1];if(t===o)return a<<1;o>t?i=a:r=a+1}return~(i<<1)}(e,t)}var mk,kk={},_k="__NG_DI_FLAG__",wk="ngTempTokenPath",Ck=/\n/gm,bk="__source",Ek=fg({provide:String,useValue:fg});function Sk(e){var t=mk;return mk=e,t}function Pk(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dg.Default;if(void 0===mk)throw new Error("inject() must be called from an injection context");return null===mk?Fg(e,void 0,t):mk.get(e,t&Dg.Optional?null:void 0,t)}function Ok(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dg.Default;return(xg||Pk)(mg(e),t)}function Tk(e){for(var t=[],n=0;n<e.length;n++){var r=mg(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");for(var i=void 0,a=Dg.Default,o=0;o<r.length;o++){var s=r[o],u=xk(s);"number"==typeof u?-1===u?i=s.token:a|=u:i=s}t.push(Ok(i,a))}else t.push(Ok(r))}return t}function Ik(e,t){return e[_k]=t,e.prototype[_k]=t,e}function xk(e){return e[_k]}function Ak(e,t,n,r){var i=e[wk];throw t[bk]&&i.unshift(t[bk]),e.message=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;var i=vg(t);if(Array.isArray(t))i=t.map(vg).join(" -> ");else if("object"==typeof t){var a=[];for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];a.push(o+":"+("string"==typeof s?JSON.stringify(s):vg(s)))}i="{".concat(a.join(", "),"}")}return"".concat(n).concat(r?"("+r+")":"","[").concat(i,"]: ").concat(e.replace(Ck,"\n  "))}("\n"+e.message,i,n,r),e.ngTokenPath=i,e[wk]=null,e}var Rk,Nk,Mk=Ik(ok("Inject",function(e){return{token:e}}),-1),Dk=Ik(ok("Optional"),8),Lk=Ik(ok("SkipSelf"),4);function Fk(e){var t;return(null===(t=function(){if(void 0===Rk&&(Rk=null,qg.trustedTypes))try{Rk=qg.trustedTypes.createPolicy("angular",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return Rk}())||void 0===t?void 0:t.createHTML(e))||e}function Bk(e){var t;return(null===(t=function(){if(void 0===Nk&&(Nk=null,qg.trustedTypes))try{Nk=qg.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return Nk}())||void 0===t?void 0:t.createHTML(e))||e}var Vk=function(){function e(t){np(this,e),this.changingThisBreaksApplicationSecurity=t}return ip(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity," (see https://g.co/ng/security#xss)")}}]),e}(),Uk=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getTypeName",value:function(){return"HTML"}}]),n}(Vk),zk=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getTypeName",value:function(){return"Style"}}]),n}(Vk),Hk=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getTypeName",value:function(){return"Script"}}]),n}(Vk),Gk=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getTypeName",value:function(){return"URL"}}]),n}(Vk),qk=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getTypeName",value:function(){return"ResourceURL"}}]),n}(Vk);function $k(e){return e instanceof Vk?e.changingThisBreaksApplicationSecurity:e}function Wk(e,t){var n=jk(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error("Required a safe ".concat(t,", got a ").concat(n," (see https://g.co/ng/security#xss)"))}return n===t}function jk(e){return e instanceof Vk&&e.getTypeName()||null}function Zk(e){var t=new Kk(e);return function(){try{return!!(new window.DOMParser).parseFromString(Fk(""),"text/html")}catch(e){return!1}}()?new Yk(t):t}var Yk=function(){function e(t){np(this,e),this.inertDocumentHelper=t}return ip(e,[{key:"getInertBodyElement",value:function(e){e="<body><remove></remove>"+e;try{var t=(new window.DOMParser).parseFromString(Fk(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(n){return null}}}]),e}(),Kk=function(){function e(t){if(np(this,e),this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){var n=this.inertDocument.createElement("html");this.inertDocument.appendChild(n);var r=this.inertDocument.createElement("body");n.appendChild(r)}}return ip(e,[{key:"getInertBodyElement",value:function(e){var t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=Fk(e),t;var n=this.inertDocument.createElement("body");return n.innerHTML=Fk(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}},{key:"stripCustomNsAttrs",value:function(e){for(var t=e.attributes,n=t.length-1;0<n;n--){var r=t.item(n).name;("xmlns:ns1"===r||0===r.indexOf("ns1:"))&&e.removeAttribute(r)}for(var i=e.firstChild;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}]),e}(),Jk=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Qk=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Xk(e){return(e=String(e)).match(Jk)||e.match(Qk)?e:"unsafe:"+e}function e_(e){return(e=String(e)).split(",").map(function(e){return Xk(e.trim())}).join(", ")}function t_(e){var t,n={},r=Xv(e.split(","));try{for(r.s();!(t=r.n()).done;){n[t.value]=!0}}catch(i){r.e(i)}finally{r.f()}return n}function n_(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];for(var s in o)o.hasOwnProperty(s)&&(e[s]=!0)}return e}var r_,i_=t_("area,br,col,hr,img,wbr"),a_=t_("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),o_=t_("rp,rt"),s_=n_(i_,n_(a_,t_("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),n_(o_,t_("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),n_(o_,a_)),u_=t_("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),c_=t_("srcset"),l_=n_(u_,c_,t_("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),t_("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),h_=t_("script,style,template"),f_=function(){function e(){np(this,e),this.sanitizedSomething=!1,this.buf=[]}return ip(e,[{key:"sanitizeChildren",value:function(e){for(var t=e.firstChild,n=!0;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);var r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(e){var t=e.nodeName.toLowerCase();if(!s_.hasOwnProperty(t))return this.sanitizedSomething=!0,!h_.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);for(var n=e.attributes,r=0;r<n.length;r++){var i=n.item(r),a=i.name,o=a.toLowerCase();if(l_.hasOwnProperty(o)){var s=i.value;u_[o]&&(s=Xk(s)),c_[o]&&(s=e_(s)),this.buf.push(" ",a,'="',p_(s),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(e){var t=e.nodeName.toLowerCase();s_.hasOwnProperty(t)&&!i_.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}},{key:"chars",value:function(e){this.buf.push(p_(e))}},{key:"checkClobberedElement",value:function(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: ".concat(e.outerHTML));return t}}]),e}(),d_=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,v_=/([^\#-~ |!])/g;function p_(e){return e.replace(/&/g,"&amp;").replace(d_,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(v_,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function g_(e,t){var n=null;try{r_=r_||Zk(e);var r=t?String(t):"";n=r_.getInertBodyElement(r);var i=5,a=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=a,a=n.innerHTML,n=r_.getInertBodyElement(r)}while(r!==a);return Fk((new f_).sanitizeChildren(y_(n)||n))}finally{if(n)for(var o=y_(n)||n;o.firstChild;)o.removeChild(o.firstChild)}}function y_(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var m_=((m_=m_||{})[m_.NONE=0]="NONE",m_[m_.HTML=1]="HTML",m_[m_.STYLE=2]="STYLE",m_[m_.SCRIPT=3]="SCRIPT",m_[m_.URL=4]="URL",m_[m_.RESOURCE_URL=5]="RESOURCE_URL",m_);function k_(e){var t=w_();return t?Bk(t.sanitize(m_.HTML,e)||""):Wk(e,"HTML")?Bk($k(e)):g_(Ty(),wg(e))}function __(e){var t=w_();return t?t.sanitize(m_.URL,e)||"":Wk(e,"URL")?$k(e):Xk(wg(e))}function w_(){var e=qy();return e&&e[12]}var C_="__ngContext__";function b_(e,t){e[C_]=t}function E_(e){var t=function(e){return e[C_]||null}(e);return t?Array.isArray(t)?t:t.lView:null}function S_(e){return e.ngOriginalError}function P_(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.error.apply(e,n)}var O_=function(){function e(){np(this,e),this._console=console}return ip(e,[{key:"handleError",value:function(e){var t,n=this._findOriginalError(e),r=this._findContext(e),i=(t=e)&&t.ngErrorLogger||P_;i(this._console,"ERROR",e),n&&i(this._console,"ORIGINAL ERROR",n),r&&i(this._console,"ERROR CONTEXT",r)}},{key:"_findContext",value:function(e){return e?function(e){return e.ngDebugContext}(e)||this._findContext(S_(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=e&&S_(e);t&&S_(t);)t=S_(t);return t||null}}]),e}(),T_=/^>|^->|<!--|-->|--!>|<!-$/g,I_=/(<|>)/,x_=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(qg);function A_(e){return e instanceof Function?e():e}var R_,N_=((N_=N_||{})[N_.Important=1]="Important",N_[N_.DashCase=2]="DashCase",N_);function M_(e,t){return R_(e,t)}function D_(e){var t=e[3];return fy(t)?t[3]:t}function L_(e){return B_(e[13])}function F_(e){return B_(e[4])}function B_(e){for(;null!==e&&!fy(e);)e=e[4];return e}function V_(e,t,n,r,i){if(null!=r){var a,o=!1;fy(r)?a=r:hy(r)&&(o=!0,r=r[0]);var s=Ay(r);0===e&&null!==n?null==i?J_(t,n,s):K_(t,n,s,i||null,!0):1===e&&null!==n?K_(t,n,s,i||null,!0):2===e?cw(t,s,o):3===e&&t.destroyNode(s),null!=a&&function(e,t,n,r,i){var a=n[7];a!==Ay(n)&&V_(t,e,r,a,i);for(var o=10;o<n.length;o++){var s=n[o];hw(s[1],s,e,t,r,a)}}(t,e,a,n,i)}}function U_(e,t){return Iy(e)?e.createText(t):e.createTextNode(t)}function z_(e,t,n){Iy(e)?e.setValue(t,n):t.textContent=n}function H_(e,t){return e.createComment(function(e){return e.replace(T_,function(e){return e.replace(I_,"\u200b$1\u200b")})}(t))}function G_(e,t,n){return Iy(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function q_(e,t){var n=e[9],r=n.indexOf(t),i=t[3];1024&t[2]&&(t[2]&=-1025,zy(i,-1)),n.splice(r,1)}function $_(e,t){if(!(e.length<=10)){var n=10+t,r=e[n];if(r){var i=r[17];null!==i&&i!==e&&q_(i,r),t>0&&(e[n-1][4]=r[4]);var a=dk(e,10+t);!function(e,t){hw(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);var o=a[19];null!==o&&o.detachView(a[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}}function W_(e,t){if(!(256&t[2])){var n=t[11];Iy(n)&&n.destroyNode&&hw(e,t,n,3,null,null),function(e){var t=e[13];if(!t)return j_(e[1],e);for(;t;){var n=null;if(hy(t))n=t[13];else{var r=t[10];r&&(n=r)}if(!n){for(;t&&!t[4]&&t!==e;)hy(t)&&j_(t[1],t),t=t[3];null===t&&(t=e),hy(t)&&j_(t[1],t),n=t&&t[4]}t=n}}(t)}}function j_(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){var n;if(null!=e&&null!=(n=e.destroyHooks))for(var r=0;r<n.length;r+=2){var i=t[n[r]];if(!(i instanceof Tm)){var a=n[r+1];if(Array.isArray(a))for(var o=0;o<a.length;o+=2){var s=i[a[o]],u=a[o+1];try{u.call(s)}finally{}}else try{a.call(i)}finally{}}}}(e,t),function(e,t){var n=e.cleanup,r=t[7],i=-1;if(null!==n)for(var a=0;a<n.length-1;a+=2)if("string"==typeof n[a]){var o=n[a+1],s="function"==typeof o?o(t):Ay(t[o]),u=r[i=n[a+2]],c=n[a+3];"boolean"==typeof c?s.removeEventListener(n[a],u,c):c>=0?r[i=c]():r[i=-c].unsubscribe(),a+=2}else{var l=r[i=n[a+1]];n[a].call(l)}if(null!==r){for(var h=i+1;h<r.length;h++)r[h]();t[7]=null}}(e,t),1===t[1].type&&Iy(t[11])&&t[11].destroy();var n=t[17];if(null!==n&&fy(t[3])){n!==t[3]&&q_(n,t);var r=t[19];null!==r&&r.detachView(e)}}}function Z_(e,t,n){return Y_(e,t.parent,n)}function Y_(e,t,n){for(var r=t;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[0];if(2&r.flags){var i=e.data[r.directiveStart].encapsulation;if(i===Ug.None||i===Ug.Emulated)return null}return Ny(r,n)}function K_(e,t,n,r,i){Iy(e)?e.insertBefore(t,n,r,i):t.insertBefore(n,r,i)}function J_(e,t,n){Iy(e)?e.appendChild(t,n):t.appendChild(n)}function Q_(e,t,n,r,i){null!==r?K_(e,t,n,r,i):J_(e,t,n)}function X_(e,t){return Iy(e)?e.parentNode(t):t.parentNode}function ew(e,t,n){return rw(e,t,n)}function tw(e,t,n){return 40&e.type?Ny(e,n):null}var nw,rw=tw;function iw(e,t){rw=e,nw=t}function aw(e,t,n,r){var i=Z_(e,r,t),a=t[11],o=ew(r.parent||t[6],r,t);if(null!=i)if(Array.isArray(n))for(var s=0;s<n.length;s++)Q_(a,i,n[s],o,!1);else Q_(a,i,n,o,!1);void 0!==nw&&nw(a,r,t,n,i)}function ow(e,t){if(null!==t){var n=t.type;if(3&n)return Ny(t,e);if(4&n)return uw(-1,e[t.index]);if(8&n){var r=t.child;if(null!==r)return ow(e,r);var i=e[t.index];return fy(i)?uw(-1,i):Ay(i)}if(32&n)return M_(t,e)()||Ay(e[t.index]);var a=sw(e,t);return null!==a?Array.isArray(a)?a[0]:ow(D_(e[16]),a):ow(e,t.next)}return null}function sw(e,t){return null!==t?e[16][6].projection[t.projection]:null}function uw(e,t){var n=10+e+1;if(n<t.length){var r=t[n],i=r[1].firstChild;if(null!==i)return ow(r,i)}return t[7]}function cw(e,t,n){var r=X_(e,t);r&&function(e,t,n,r){Iy(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}function lw(e,t,n,r,i,a,o){for(;null!=n;){var s=r[n.index],u=n.type;if(o&&0===t&&(s&&b_(Ay(s),r),n.flags|=4),64!=(64&n.flags))if(8&u)lw(e,t,n.child,r,i,a,!1),V_(t,e,i,s,a);else if(32&u){for(var c=M_(n,r),l=void 0;l=c();)V_(t,e,i,l,a);V_(t,e,i,s,a)}else 16&u?fw(e,t,r,n,i,a):V_(t,e,i,s,a);n=o?n.projectionNext:n.next}}function hw(e,t,n,r,i,a){lw(n,r,e.firstChild,t,i,a,!1)}function fw(e,t,n,r,i,a){var o=n[16],s=o[6].projection[r.projection];if(Array.isArray(s))for(var u=0;u<s.length;u++)V_(t,e,i,s[u],a);else lw(e,t,s,o[3],i,a,!0)}function dw(e,t,n){Iy(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function vw(e,t,n){Iy(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function pw(e,t,n){for(var r=e.length;;){var i=e.indexOf(t,n);if(-1===i)return i;if(0===i||e.charCodeAt(i-1)<=32){var a=t.length;if(i+a===r||e.charCodeAt(i+a)<=32)return i}n=i+1}}var gw="ng-template";function yw(e,t,n){for(var r=0;r<e.length;){var i=e[r++];if(n&&"class"===i){if(-1!==pw((i=e[r]).toLowerCase(),t,0))return!0}else if(1===i){for(;r<e.length&&"string"==typeof(i=e[r++]);)if(i.toLowerCase()===t)return!0;return!1}}return!1}function mw(e){return 4===e.type&&e.value!==gw}function kw(e,t,n){return t===(4!==e.type||n?e.value:gw)}function _w(e,t,n){for(var r=4,i=e.attrs||[],a=function(e){for(var t=0;t<e.length;t++)if(xm(e[t]))return t;return e.length}(i),o=!1,s=0;s<t.length;s++){var u=t[s];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!kw(e,u,n)||""===u&&1===t.length){if(ww(r))return!1;o=!0}}else{var c=8&r?u:t[++s];if(8&r&&null!==e.attrs){if(!yw(e.attrs,c,n)){if(ww(r))return!1;o=!0}continue}var l=Cw(8&r?"class":u,i,mw(e),n);if(-1===l){if(ww(r))return!1;o=!0;continue}if(""!==c){var h;h=l>a?"":i[l+1].toLowerCase();var f=8&r?h:null;if(f&&-1!==pw(f,c,0)||2&r&&c!==h){if(ww(r))return!1;o=!0}}}}else{if(!o&&!ww(r)&&!ww(u))return!1;if(o&&ww(u))continue;o=!1,r=u|1&r}}return ww(r)||o}function ww(e){return 0==(1&e)}function Cw(e,t,n,r){if(null===t)return-1;var i=0;if(r||!n){for(var a=!1;i<t.length;){var o=t[i];if(o===e)return i;if(3===o||6===o)a=!0;else{if(1===o||2===o){for(var s=t[++i];"string"==typeof s;)s=t[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=a?1:2}return-1}return function(e,t){var n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){var r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function bw(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0;r<t.length;r++)if(_w(e,t[r],n))return!0;return!1}function Ew(e,t){return e?":not("+t.trim()+")":t}function Sw(e){for(var t=e[0],n=1,r=2,i="",a=!1;n<e.length;){var o=e[n];if("string"==typeof o)if(2&r){var s=e[++n];i+="["+o+(s.length>0?'="'+s+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!ww(o)&&(t+=Ew(a,i),i=""),r=o,a=a||!ww(r);n++}return""!==i&&(t+=Ew(a,i)),t}var Pw={};function Ow(e){Tw($y(),qy(),mm()+e,Xy())}function Tw(e,t,n,r){if(!r)if(3==(3&t[2])){var i=e.preOrderCheckHooks;null!==i&&bm(t,i,n)}else{var a=e.preOrderHooks;null!==a&&Em(t,a,0,n)}km(n)}function Iw(e,t){return e<<17|t<<2}function xw(e){return e>>17&32767}function Aw(e){return 2|e}function Rw(e){return(131068&e)>>2}function Nw(e,t){return-131069&e|t<<2}function Mw(e){return 1|e}function Dw(e,t){var n=e.contentQueries;if(null!==n)for(var r=0;r<n.length;r+=2){var i=n[r],a=n[r+1];if(-1!==a){var o=e.data[a];cm(i),o.contentQueries(2,t[a],a)}}}function Lw(e,t,n,r,i,a,o,s,u,c){var l=t.blueprint.slice();return l[0]=i,l[2]=140|r,Uy(l),l[3]=l[15]=e,l[8]=n,l[10]=o||e&&e[10],l[11]=s||e&&e[11],l[12]=u||e&&e[12]||null,l[9]=c||e&&e[9]||null,l[6]=a,l[16]=2==t.type?e[16]:l,l}function Fw(e,t,n,r,i){var a=e.data[t];if(null===a)a=Bw(e,t,n,r,i),Hy.lFrame.inI18n&&(a.flags|=64);else if(64&a.type){a.type=n,a.value=r,a.attrs=i;var o=Yy();a.injectorIndex=null===o?-1:o.injectorIndex}return Ky(a,!0),a}function Bw(e,t,n,r,i){var a=Zy(),o=Jy(),s=e.data[t]=function(e,t,n,r,i,a){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:a,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?a:a&&a.parent,n,t,r,i);return null===e.firstChild&&(e.firstChild=s),null!==a&&(o?null==a.child&&null!==s.parent&&(a.child=s):null===a.next&&(a.next=s)),s}function Vw(e,t,n,r){if(0===n)return-1;for(var i=t.length,a=0;a<n;a++)t.push(r),e.blueprint.push(r),e.data.push(null);return i}function Uw(e,t,n){fm(t);try{var r=e.viewQuery;null!==r&&yC(1,r,n);var i=e.template;null!==i&&Gw(e,t,i,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&Dw(e,t),e.staticViewQueries&&yC(2,e.viewQuery,n);var a=e.components;null!==a&&function(e,t){for(var n=0;n<t.length;n++)fC(e,t[n])}(t,a)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[2]&=-5,ym()}}function zw(e,t,n,r){var i=t[2];if(256!=(256&i)){fm(t);var a=Xy();try{Uy(t),function(e){Hy.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&Gw(e,t,n,2,r);var o=3==(3&i);if(!a)if(o){var s=e.preOrderCheckHooks;null!==s&&bm(t,s,null)}else{var u=e.preOrderHooks;null!==u&&Em(t,u,0,null),Sm(t,0)}if(function(e){for(var t=L_(e);null!==t;t=F_(t))if(t[2])for(var n=t[9],r=0;r<n.length;r++){var i=n[r],a=i[3];0==(1024&i[2])&&zy(a,1),i[2]|=1024}}(t),function(e){for(var t=L_(e);null!==t;t=F_(t))for(var n=10;n<t.length;n++){var r=t[n],i=r[1];By(r)&&zw(i,r,i.template,r[8])}}(t),null!==e.contentQueries&&Dw(e,t),!a)if(o){var c=e.contentCheckHooks;null!==c&&bm(t,c)}else{var l=e.contentHooks;null!==l&&Em(t,l,1),Sm(t,1)}!function(e,t){var n=e.hostBindingOpCodes;if(null!==n)try{for(var r=0;r<n.length;r++){var i=n[r];if(i<0)km(~i);else{var a=i,o=n[++r],s=n[++r];om(o,a),s(2,t[a])}}}finally{km(-1)}}(e,t);var h=e.components;null!==h&&function(e,t){for(var n=0;n<t.length;n++)lC(e,t[n])}(t,h);var f=e.viewQuery;if(null!==f&&yC(2,f,r),!a)if(o){var d=e.viewCheckHooks;null!==d&&bm(t,d)}else{var v=e.viewHooks;null!==v&&Em(t,v,2),Sm(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),a||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,zy(t[3],-1))}finally{ym()}}}function Hw(e,t,n,r){var i=t[10],a=!Xy(),o=Fy(t);try{a&&!o&&i.begin&&i.begin(),o&&Uw(e,t,r),zw(e,t,n,r)}finally{a&&!o&&i.end&&i.end()}}function Gw(e,t,n,r,i){var a=mm(),o=2&r;try{km(-1),o&&t.length>20&&Tw(e,t,20,Xy()),n(r,i)}finally{km(a)}}function qw(e,t,n){if(dy(t))for(var r=t.directiveEnd,i=t.directiveStart;i<r;i++){var a=e.data[i];a.contentQueries&&a.contentQueries(1,n[i],i)}}function $w(e,t,n){!Gy()||(function(e,t,n,r){var i=n.directiveStart,a=n.directiveEnd;e.firstCreatePass||Um(n,t),b_(r,t);for(var o=n.initialInputs,s=i;s<a;s++){var u=e.data[s],c=gy(u);c&&aC(t,n,u);var l=Qm(t,e,s,n);b_(l,t),null!==o&&sC(0,s-i,l,u,0,o),c&&(Ly(n.index,t)[8]=l)}}(e,t,n,Ny(n,t)),128==(128&n.flags)&&function(e,t,n){var r=n.directiveStart,i=n.directiveEnd,a=n.index,o=Hy.lFrame.currentDirectiveIndex;try{km(a);for(var s=r;s<i;s++){var u=e.data[s],c=t[s];sm(s),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&eC(u,c)}}finally{km(-1),sm(o)}}(e,t,n))}function Ww(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ny,r=t.localNames;if(null!==r)for(var i=t.index+1,a=0;a<r.length;a+=2){var o=r[a+1],s=-1===o?n(t,e):e[o];e[i++]=s}}function jw(e){var t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Zw(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function Zw(e,t,n,r,i,a,o,s,u,c){var l=20+r,h=l+i,f=function(e,t){for(var n=[],r=0;r<t;r++)n.push(r<e?null:Pw);return n}(l,h),d="function"==typeof c?c():c;return f[1]={type:e,blueprint:f,template:n,queries:null,viewQuery:s,declTNode:t,data:f.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof a?a():a,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:d,incompleteFirstPass:!1}}function Yw(e,t,n,r){var i=kC(t);null===n?i.push(r):(i.push(n),e.firstCreatePass&&_C(e).push(r,i.length-1))}function Kw(e,t,n){for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,i):n[r]=[t,i]}return n}function Jw(e,t,n,r,i,a,o,s){var u,c=Ny(t,n),l=t.inputs;!s&&null!=l&&(u=l[r])?(CC(e,n,u,r,i),vy(t)&&function(e,t){var n=Ly(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(r=function(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(r),i=null!=o?o(i,t.value||"",r):i,Iy(a)?a.setProperty(c,r,i):Am(r)||(c.setProperty?c.setProperty(r,i):c[r]=i))}function Qw(e,t,n,r){var i=!1;if(Gy()){var a=function(e,t,n){var r=e.directiveRegistry,i=null;if(r)for(var a=0;a<r.length;a++){var o=r[a];bw(n,o.selectors,!1)&&(i||(i=[]),qm(Um(n,t),e,o.type),gy(o)?(tC(e,n),i.unshift(o)):i.push(o))}return i}(e,t,n),o=null===r?null:{"":-1};if(null!==a){i=!0,rC(n,e.data.length,a.length);for(var s=0;s<a.length;s++){var u=a[s];u.providersResolver&&u.providersResolver(u)}for(var c=!1,l=!1,h=Vw(e,t,a.length,null),f=0;f<a.length;f++){var d=a[f];n.mergedAttrs=Rm(n.mergedAttrs,d.hostAttrs),iC(e,n,t,h,d),nC(h,d,o),null!==d.contentQueries&&(n.flags|=8),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(n.flags|=128);var v=d.type.prototype;!c&&(v.ngOnChanges||v.ngOnInit||v.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),c=!0),!l&&(v.ngOnChanges||v.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),l=!0),h++}!function(e,t){for(var n=t.directiveEnd,r=e.data,i=t.attrs,a=[],o=null,s=null,u=t.directiveStart;u<n;u++){var c=r[u],l=c.inputs,h=null===i||mw(t)?null:uC(l,i);a.push(h),o=Kw(l,u,o),s=Kw(c.outputs,u,s)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=a,t.inputs=o,t.outputs=s}(e,n)}o&&function(e,t,n){if(t)for(var r=e.localNames=[],i=0;i<t.length;i+=2){var a=n[t[i+1]];if(null==a)throw new _g("301","Export of name '".concat(t[i+1],"' not found!"));r.push(t[i],a)}}(n,r,o)}return n.mergedAttrs=Rm(n.mergedAttrs,n.attrs),i}function Xw(e,t,n,r,i,a){var o=a.hostBindings;if(o){var s=e.hostBindingOpCodes;null===s&&(s=e.hostBindingOpCodes=[]);var u=~t.index;(function(e){for(var t=e.length;t>0;){var n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(s)!=u&&s.push(u),s.push(r,i,o)}}function eC(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function tC(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function nC(e,t,n){if(n){if(t.exportAs)for(var r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;gy(t)&&(n[""]=e)}}function rC(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function iC(e,t,n,r,i){e.data[r]=i;var a=i.factory||(i.factory=my(i.type)),o=new Tm(a,gy(i),null);e.blueprint[r]=o,n[r]=o,Xw(e,t,0,r,Vw(e,n,i.hostVars,Pw),i)}function aC(e,t,n){var r=Ny(t,e),i=jw(n),a=e[10],o=dC(e,Lw(e,i,null,n.onPush?64:16,r,t,a,a.createRenderer(r,n),null,null));e[t.index]=o}function oC(e,t,n,r,i,a,o){if(null==a)Iy(e)?e.removeAttribute(t,i,n):t.removeAttribute(i);else{var s=null==o?wg(a):o(a,r||"",i);Iy(e)?e.setAttribute(t,i,s,n):n?t.setAttributeNS(n,i,s):t.setAttribute(i,s)}}function sC(e,t,n,r,i,a){var o=a[t];if(null!==o)for(var s=r.setInput,u=0;u<o.length;){var c=o[u++],l=o[u++],h=o[u++];null!==s?r.setInput(n,h,c,l):n[l]=h}}function uC(e,t){for(var n=null,r=0;r<t.length;){var i=t[r];if(0!==i)if(5!==i){if("number"==typeof i)break;e.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,e[i],t[r+1])),r+=2}else r+=2;else r+=4}return n}function cC(e,t,n,r){return new Array(e,!0,!1,t,null,0,r,n,null,null)}function lC(e,t){var n=Ly(t,e);if(By(n)){var r=n[1];80&n[2]?zw(r,n,r.template,n[8]):n[5]>0&&hC(n)}}function hC(e){for(var t=L_(e);null!==t;t=F_(t))for(var n=10;n<t.length;n++){var r=t[n];if(1024&r[2]){var i=r[1];zw(i,r,i.template,r[8])}else r[5]>0&&hC(r)}var a=e[1].components;if(null!==a)for(var o=0;o<a.length;o++){var s=Ly(a[o],e);By(s)&&s[5]>0&&hC(s)}}function fC(e,t){var n=Ly(t,e),r=n[1];(function(e,t){for(var n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])})(r,n),Uw(r,n,n[8])}function dC(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function vC(e){for(;e;){e[2]|=64;var t=D_(e);if(yy(e)&&!t)return e;e=t}return null}function pC(e,t,n){var r=t[10];r.begin&&r.begin();try{zw(e,t,e.template,n)}catch(i){throw wC(t,i),i}finally{r.end&&r.end()}}function gC(e){!function(e){for(var t=0;t<e.components.length;t++){var n=e.components[t],r=E_(n),i=r[1];Hw(i,r,i.template,n)}}(e[8])}function yC(e,t,n){cm(0),t(e,n)}var mC=Promise.resolve(null);function kC(e){return e[7]||(e[7]=[])}function _C(e){return e.cleanup||(e.cleanup=[])}function wC(e,t){var n=e[9],r=n?n.get(O_,null):null;r&&r.handleError(t)}function CC(e,t,n,r,i){for(var a=0;a<n.length;){var o=n[a++],s=n[a++],u=t[o],c=e.data[o];null!==c.setInput?c.setInput(u,i,r,s):u[s]=i}}function bC(e,t,n){var r=Ry(t,e);z_(e[11],r,n)}function EC(e,t,n){var r=n?e.styles:null,i=n?e.classes:null,a=0;if(null!==t)for(var o=0;o<t.length;o++){var s=t[o];"number"==typeof s?a=s:1==a?i=pg(i,s):2==a&&(r=pg(r,s+": "+t[++o]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=i:e.classesWithoutHost=i}var SC,PC=new sk("INJECTOR",-1),OC=function(){function e(){np(this,e)}return ip(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kk;if(t===kk){var n=new Error("NullInjectorError: No provider for ".concat(vg(e),"!"));throw n.name="NullInjectorError",n}return t}}]),e}(),TC=new sk("Set Injector scope."),IC={},xC={};function AC(){return void 0===SC&&(SC=new OC),SC}function RC(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return new NC(e,n,t||AC(),r)}var NC=function(){function e(t,n,r){var i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;np(this,e),this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var o=[];n&&hk(n,function(e){return i.processProvider(e,t,n)}),hk([t],function(e){return i.processInjectorType(e,[],o)}),this.records.set(PC,LC(void 0,this));var s=this.records.get(TC);this.scope=null!=s?s.value:null,this.source=a||("object"==typeof t?null:vg(t))}return ip(e,[{key:"destroyed",get:function(){return this._destroyed}},{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(function(e){return e.ngOnDestroy()})}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kk,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Dg.Default;this.assertNotDestroyed();var r,i=Sk(this),a=Lg(void 0);try{if(!(n&Dg.SkipSelf)){var o=this.records.get(e);if(void 0===o){var s=("function"==typeof(r=e)||"object"==typeof r&&r instanceof sk)&&Og(e);o=s&&this.injectableDefInScope(s)?LC(MC(e),IC):null,this.records.set(e,o)}if(null!=o)return this.hydrate(e,o)}return(n&Dg.Self?AC():this.parent).get(e,t=n&Dg.Optional&&t===kk?null:t)}catch(u){if("NullInjectorError"===u.name){if((u[wk]=u[wk]||[]).unshift(vg(e)),i)throw u;return Ak(u,e,"R3InjectorError",this.source)}throw u}finally{Lg(a),Sk(i)}}},{key:"_resolveInjectorDefTypes",value:function(){var e=this;this.injectorDefTypes.forEach(function(t){return e.get(t)})}},{key:"toString",value:function(){var e=[];return this.records.forEach(function(t,n){return e.push(vg(n))}),"R3Injector[".concat(e.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(e,t,n){var r=this;if(!(e=mg(e)))return!1;var i=Ig(e),a=null==i&&e.ngModule||void 0,o=void 0===a?e:a,s=-1!==n.indexOf(o);if(void 0!==a&&(i=Ig(a)),null==i)return!1;if(null!=i.imports&&!s){var u;n.push(o);try{hk(i.imports,function(e){r.processInjectorType(e,t,n)&&(void 0===u&&(u=[]),u.push(e))})}finally{}if(void 0!==u)for(var c=function(e){var t=u[e],n=t.ngModule,i=t.providers;hk(i,function(e){return r.processProvider(e,n,i||Wg)})},l=0;l<u.length;l++)c(l)}this.injectorDefTypes.add(o);var h=my(o)||function(){return new o};this.records.set(o,LC(h,IC));var f=i.providers;if(null!=f&&!s){var d=e;hk(f,function(e){return r.processProvider(e,d,f)})}return void 0!==a&&void 0!==e.providers}},{key:"processProvider",value:function(e,t,n){var r=BC(e=mg(e))?e:mg(e&&e.provide),i=function(e,t,n){return FC(e)?LC(void 0,e.useValue):LC(DC(e),IC)}(e);if(BC(e)||!0!==e.multi)this.records.get(r);else{var a=this.records.get(r);a||((a=LC(void 0,IC,!0)).factory=function(){return Tk(a.multi)},this.records.set(r,a)),r=e,a.multi.push(e)}this.records.set(r,i)}},{key:"hydrate",value:function(e,t){return t.value===IC&&(t.value=xC,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value;var n}},{key:"injectableDefInScope",value:function(e){if(!e.providedIn)return!1;var t=mg(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}]),e}();function MC(e){var t=Og(e),n=null!==t?t.factory:my(e);if(null!==n)return n;if(e instanceof sk)throw new Error("Token ".concat(vg(e)," is missing a \u0275prov definition."));if(e instanceof Function)return function(e){var t=e.length;if(t>0){var n=vk(t,"?");throw new Error("Can't resolve all parameters for ".concat(vg(e),": (").concat(n.join(", "),")."))}var r=function(e){var t=e&&(e[Ag]||e[Ng]);if(t){var n=function(e){if(e.hasOwnProperty("name"))return e.name;var t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(n,'" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "').concat(n,'" class.')),t}return null}(e);return null!==r?function(){return r.factory(e)}:function(){return new e}}(e);throw new Error("unreachable")}function DC(e,t,n){var r;if(BC(e)){var i=mg(e);return my(i)||MC(i)}if(FC(e))r=function(){return mg(e.useValue)};else if(function(e){return!(!e||!e.useFactory)}(e))r=function(){return e.useFactory.apply(e,Jv(Tk(e.deps||[])))};else if(function(e){return!(!e||!e.useExisting)}(e))r=function(){return Ok(mg(e.useExisting))};else{var a=mg(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return my(a)||MC(a);r=function(){return zv(a,Jv(Tk(e.deps)))}}return r}function LC(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:e,value:t,multi:n?[]:void 0}}function FC(e){return null!==e&&"object"==typeof e&&Ek in e}function BC(e){return"function"==typeof e}var VC=function(e,t,n){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0,i=RC(e,t,n,r);return i._resolveInjectorDefTypes(),i}({name:n},t,e,n)},UC=function(){var e=function(){function e(){np(this,e)}return ip(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?VC(e,t,""):VC(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=kk,e.NULL=new OC,e.\u0275prov=Sg({token:e,providedIn:"any",factory:function(){return Ok(PC)}}),e.__NG_ELEMENT_ID__=-1,e}();function zC(e,t){Cm(E_(e)[1],jy())}function HC(e){for(var t=function(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0,r=[e];t;){var i=void 0;if(gy(e))i=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");i=t.\u0275dir}if(i){if(n){r.push(i);var a=e;a.inputs=GC(e.inputs),a.declaredInputs=GC(e.declaredInputs),a.outputs=GC(e.outputs);var o=i.hostBindings;o&&WC(e,o);var s=i.viewQuery,u=i.contentQueries;if(s&&qC(e,s),u&&$C(e,u),dg(e.inputs,i.inputs),dg(e.declaredInputs,i.declaredInputs),dg(e.outputs,i.outputs),gy(i)&&i.data.animation){var c=e.data;c.animation=(c.animation||[]).concat(i.data.animation)}}var l=i.features;if(l)for(var h=0;h<l.length;h++){var f=l[h];f&&f.ngInherit&&f(e),f===HC&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){for(var t=0,n=null,r=e.length-1;r>=0;r--){var i=e[r];i.hostVars=t+=i.hostVars,i.hostAttrs=Rm(i.hostAttrs,n=Rm(n,i.hostAttrs))}}(r)}function GC(e){return e===$g?{}:e===Wg?[]:e}function qC(e,t){var n=e.viewQuery;e.viewQuery=n?function(e,r){t(e,r),n(e,r)}:t}function $C(e,t){var n=e.contentQueries;e.contentQueries=n?function(e,r,i){t(e,r,i),n(e,r,i)}:t}function WC(e,t){var n=e.hostBindings;e.hostBindings=n?function(e,r){t(e,r),n(e,r)}:t}var jC=null;function ZC(){if(!jC){var e=qg.Symbol;if(e&&e.iterator)jC=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(jC=r)}}return jC}var YC=function(){function e(t){np(this,e),this.wrapped=t}return ip(e,null,[{key:"wrap",value:function(t){return new e(t)}},{key:"unwrap",value:function(t){return e.isWrapped(t)?t.wrapped:t}},{key:"isWrapped",value:function(t){return t instanceof e}}]),e}();function KC(e){return!!JC(e)&&(Array.isArray(e)||!(e instanceof Map)&&ZC()in e)}function JC(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function QC(e,t,n){return e[t]=n}function XC(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function eb(e,t,n,r){var i=XC(e,t,n);return XC(e,t+1,r)||i}function tb(e,t,n,r,i){var a=eb(e,t,n,r);return XC(e,t+2,i)||a}function nb(e,t,n,r){var i=qy();return XC(i,rm(),t)&&($y(),function(e,t,n,r,i,a){var o=Ny(e,t);oC(t[11],o,a,e.value,n,r,i)}(_m(),i,e,t,n,r)),nb}function rb(e,t,n,r){return XC(e,rm(),n)?t+wg(n)+r:Pw}function ib(e,t,n,r,i,a){var o=eb(e,nm(),n,i);return im(2),o?t+wg(n)+r+wg(i)+a:Pw}function ab(e,t,n,r,i,a,o,s){var u=tb(e,nm(),n,i,o);return im(3),u?t+wg(n)+r+wg(i)+a+wg(o)+s:Pw}function ob(e,t,n,r,i,a,o,s){var u=qy(),c=$y(),l=e+20,h=c.firstCreatePass?function(e,t,n,r,i,a,o,s,u){var c=t.consts,l=Fw(t,e,4,o||null,Vy(c,s));Qw(t,n,l,Vy(c,u)),Cm(t,l);var h=l.tViews=Zw(2,l,r,i,a,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c);return null!==t.queries&&(t.queries.template(t,l),h.queries=t.queries.embeddedTView(l)),l}(l,c,u,t,n,r,i,a,o):c.data[l];Ky(h,!1);var f=u[11].createComment("");aw(c,u,f,h),b_(f,u),dC(u,u[l]=cC(f,u,f,h)),py(h)&&$w(c,u,h),null!=o&&Ww(u,h,s)}function sb(e){return Dy(Hy.lFrame.contextLView,20+e)}function ub(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dg.Default,n=qy();return null===n?Ok(e,t):jm(jy(),n,mg(e),t)}function cb(e,t,n){var r=qy();return XC(r,rm(),t)&&Jw($y(),_m(),r,e,t,r[11],n,!1),cb}function lb(e,t,n,r,i){var a=i?"class":"style";CC(e,n,t.inputs[a],a,r)}function hb(e,t,n,r){var i=qy(),a=$y(),o=20+e,s=i[11],u=i[o]=G_(s,t,Hy.lFrame.currentNamespace),c=a.firstCreatePass?function(e,t,n,r,i,a,o){var s=t.consts,u=Fw(t,e,2,i,Vy(s,a));return Qw(t,n,u,Vy(s,o)),null!==u.attrs&&EC(u,u.attrs,!1),null!==u.mergedAttrs&&EC(u,u.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,u),u}(o,a,i,0,t,n,r):a.data[o];Ky(c,!0);var l=c.mergedAttrs;null!==l&&Im(s,u,l);var h=c.classes;null!==h&&vw(s,u,h);var f=c.styles;null!==f&&dw(s,u,f),64!=(64&c.flags)&&aw(a,i,u,c),0===Hy.lFrame.elementDepthCount&&b_(u,i),Hy.lFrame.elementDepthCount++,py(c)&&($w(a,i,c),qw(a,c,i)),null!==r&&Ww(i,c)}function fb(){var e=jy();Jy()?Qy():Ky(e=e.parent,!1);var t=e;Hy.lFrame.elementDepthCount--;var n=$y();n.firstCreatePass&&(Cm(n,e),dy(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&lb(n,t,qy(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&lb(n,t,qy(),t.stylesWithoutHost,!1)}function db(e,t,n,r){hb(e,t,n,r),fb()}function vb(e,t,n){var r=qy(),i=$y(),a=e+20,o=i.firstCreatePass?function(e,t,n,r,i){var a=t.consts,o=Vy(a,r),s=Fw(t,e,8,"ng-container",o);return null!==o&&EC(s,o,!0),Qw(t,n,s,Vy(a,i)),null!==t.queries&&t.queries.elementStart(t,s),s}(a,i,r,t,n):i.data[a];Ky(o,!0);var s=r[a]=r[11].createComment("");aw(i,r,s,o),b_(s,r),py(o)&&($w(i,r,o),qw(i,o,r)),null!=n&&Ww(r,o)}function pb(){var e=jy(),t=$y();Jy()?Qy():Ky(e=e.parent,!1),t.firstCreatePass&&(Cm(t,e),dy(e)&&t.queries.elementEnd(e))}function gb(){return qy()}function yb(e){return!!e&&"function"==typeof e.then}var mb=function(e){return!!e&&"function"==typeof e.subscribe};function kb(e,t,n,r){var i=qy(),a=$y(),o=jy();return function(e,t,n,r,i,a,o,s){var u=py(r),c=e.firstCreatePass&&_C(e),l=t[8],h=kC(t),f=!0;if(3&r.type||s){var d=Ny(r,t),v=s?s(d):d,p=h.length,g=s?function(e){return s(Ay(e[r.index]))}:r.index;if(Iy(n)){var y=null;if(!s&&u&&(y=function(e,t,n,r){var i=e.cleanup;if(null!=i)for(var a=0;a<i.length-1;a+=2){var o=i[a];if(o===n&&i[a+1]===r){var s=t[7],u=i[a+2];return s.length>u?s[u]:null}"string"==typeof o&&(a+=2)}return null}(e,t,i,r.index)),null!==y)(y.__ngLastListenerFn__||y).__ngNextListenerFn__=a,y.__ngLastListenerFn__=a,f=!1;else{a=wb(r,t,l,a,!1);var m=n.listen(v,i,a);h.push(a,m),c&&c.push(i,g,p,p+1)}}else a=wb(r,t,l,a,!0),v.addEventListener(i,a,o),h.push(a),c&&c.push(i,g,p,o)}else a=wb(r,t,l,a,!1);var k,_=r.outputs;if(f&&null!==_&&(k=_[i])){var w=k.length;if(w)for(var C=0;C<w;C+=2){var b=t[k[C]][k[C+1]].subscribe(a),E=h.length;h.push(a,b),c&&c.push(i,r.index,E,-(E+1))}}}(a,i,i[11],o,e,t,!!n,r),kb}function _b(e,t,n,r){try{return!1!==n(r)}catch(i){return wC(e,i),!1}}function wb(e,t,n,r,i){return function n(a){if(a===Function)return r;var o=2&e.flags?Ly(e.index,t):t;0==(32&t[2])&&vC(o);for(var s=_b(t,0,r,a),u=n.__ngNextListenerFn__;u;)s=_b(t,0,u,a)&&s,u=u.__ngNextListenerFn__;return i&&!1===s&&(a.preventDefault(),a.returnValue=!1),s}}function Cb(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(e){return(Hy.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,Hy.lFrame.contextLView))[8]}(e)}function bb(e,t,n,r,i){var a=qy(),o=rb(a,t,n,r);return o!==Pw&&Jw($y(),_m(),a,e,o,a[11],i,!1),bb}function Eb(e,t,n,r,i,a,o){var s=qy(),u=ib(s,t,n,r,i,a);return u!==Pw&&Jw($y(),_m(),s,e,u,s[11],o,!1),Eb}function Sb(e,t,n,r,i,a,o,s,u){var c=qy(),l=ab(c,t,n,r,i,a,o,s);return l!==Pw&&Jw($y(),_m(),c,e,l,c[11],u,!1),Sb}function Pb(e,t,n,r,i){for(var a=e[n+1],o=null===t,s=r?xw(a):Rw(a),u=!1;0!==s&&(!1===u||o);){var c=e[s+1];Ob(e[s],t)&&(u=!0,e[s+1]=r?Mw(c):Aw(c)),s=r?xw(c):Rw(c)}u&&(e[n+1]=r?Aw(a):Mw(a))}function Ob(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&yk(e,t)>=0}function Tb(e,t){return function(e,t,n,r){var i=qy(),a=$y(),o=im(2);a.firstUpdatePass&&function(e,t,n,r){var i=e.data;if(null===i[n+1]){var a=i[mm()],o=function(e,t){return t>=e.expandoStartIndex}(e,n);(function(e,t){return 0!=(16&e.flags)})(a)&&null===t&&!o&&(t=!1),function(e,t,n,r,i,a){var o=t.classBindings,s=xw(o),u=Rw(o);e[r]=n;var c,l=!1;if(Array.isArray(n)){var h=n;(null===(c=h[1])||yk(h,c)>0)&&(l=!0)}else c=n;if(i)if(0!==u){var f=xw(e[s+1]);e[r+1]=Iw(f,s),0!==f&&(e[f+1]=Nw(e[f+1],r)),e[s+1]=function(e,t){return 131071&e|t<<17}(e[s+1],r)}else e[r+1]=Iw(s,0),0!==s&&(e[s+1]=Nw(e[s+1],r)),s=r;else e[r+1]=Iw(u,0),0===s?s=r:e[u+1]=Nw(e[u+1],r),u=r;l&&(e[r+1]=Aw(e[r+1])),Pb(e,c,r,!0),Pb(e,c,r,!1),function(e,t,n,r,i){var a=e.residualClasses;null!=a&&"string"==typeof t&&yk(a,t)>=0&&(n[r+1]=Mw(n[r+1]))}(t,c,e,r),o=Iw(s,u),t.classBindings=o}(i,a,t=function(e,t,n,r){var i=function(e){var t=Hy.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e),a=t.residualClasses;if(null===i)0===t.classBindings&&(n=xb(n=Ib(null,e,t,n,r),t.attrs,r),a=null);else{var o=t.directiveStylingLast;if(-1===o||e[o]!==i)if(n=Ib(i,e,t,n,r),null===a){var s=function(e,t,n){var r=t.classBindings;if(0!==Rw(r))return e[xw(r)]}(e,t);void 0!==s&&Array.isArray(s)&&function(e,t,n,r){e[xw(t.classBindings)]=r}(e,t,0,s=xb(s=Ib(null,e,t,s[1],r),t.attrs,r))}else a=function(e,t,n){for(var r,i=t.directiveEnd,a=1+t.directiveStylingLast;a<i;a++)r=xb(r,e[a].hostAttrs,true);return xb(r,t.attrs,true)}(e,t)}return void 0!==a&&(t.residualClasses=a),n}(i,a,t,r),n,o)}}(a,e,o,true),t!==Pw&&XC(i,o,t)&&function(e,t,n,r,i,a,o,s){if(3&t.type){var u=e.data,c=u[s+1];Rb(function(e){return 1==(1&e)}(c)?Ab(u,t,n,i,Rw(c),o):void 0)||(Rb(a)||function(e){return 2==(2&e)}(c)&&(a=Ab(u,null,n,i,s,o)),function(e,t,n,r,i){var a=Iy(e);i?a?e.addClass(n,r):n.classList.add(r):a?e.removeClass(n,r):n.classList.remove(r)}(r,0,Ry(mm(),n),i,a))}}(a,a.data[mm()],i,i[11],e,i[o+1]=function(e,t){return null==e||"object"==typeof e&&(e=vg($k(e))),e}(t),true,o)}(e,t),Tb}function Ib(e,t,n,r,i){var a=null,o=n.directiveEnd,s=n.directiveStylingLast;for(-1===s?s=n.directiveStart:s++;s<o&&(r=xb(r,(a=t[s]).hostAttrs,i),a!==e);)s++;return null!==e&&(n.directiveStylingLast=s),r}function xb(e,t,n){var r=n?1:2,i=-1;if(null!==t)for(var a=0;a<t.length;a++){var o=t[a];"number"==typeof o?i=o:i===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),pk(e,o,!!n||t[++a]))}return void 0===e?null:e}function Ab(e,t,n,r,i,a){for(var o,s=null===t;i>0;){var u=e[i],c=Array.isArray(u),l=c?u[1]:u,h=null===l,f=n[i+1];f===Pw&&(f=h?Wg:void 0);var d=h?gk(f,r):l===r?f:void 0;if(c&&!Rb(d)&&(d=gk(u,r)),Rb(d)&&(o=d,s))return o;var v=e[i+1];i=s?xw(v):Rw(v)}if(null!==t){var p=a?t.residualClasses:t.residualStyles;null!=p&&(o=gk(p,r))}return o}function Rb(e){return void 0!==e}function Nb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=qy(),r=$y(),i=e+20,a=r.firstCreatePass?Fw(r,i,1,t,null):r.data[i],o=n[i]=U_(n[11],t);aw(r,n,o,a),Ky(a,!1)}function Mb(e){return Db("",e,""),Mb}function Db(e,t,n){var r=qy(),i=rb(r,e,t,n);return i!==Pw&&bC(r,mm(),i),Db}function Lb(e,t,n,r,i){var a=qy(),o=ib(a,e,t,n,r,i);return o!==Pw&&bC(a,mm(),o),Lb}function Fb(e,t,n,r,i,a,o){var s=qy(),u=ab(s,e,t,n,r,i,a,o);return u!==Pw&&bC(s,mm(),u),Fb}function Bb(e,t,n){var r=qy();return XC(r,rm(),t)&&Jw($y(),_m(),r,e,t,r[11],n,!0),Bb}var Vb=void 0,Ub=["en",[["a","p"],["AM","PM"],Vb],[["AM","PM"],Vb,Vb],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Vb,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Vb,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Vb,"{1} 'at' {0}",Vb],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],zb={};function Hb(e){var t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e),n=qb(t);if(n)return n;var r=t.split("-")[0];if(n=qb(r))return n;if("en"===r)return Ub;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}function Gb(e){return Hb(e)[$b.PluralCase]}function qb(e){return e in zb||(zb[e]=qg.ng&&qg.ng.common&&qg.ng.common.locales&&qg.ng.common.locales[e]),zb[e]}var $b=(($b=$b||{})[$b.LocaleId=0]="LocaleId",$b[$b.DayPeriodsFormat=1]="DayPeriodsFormat",$b[$b.DayPeriodsStandalone=2]="DayPeriodsStandalone",$b[$b.DaysFormat=3]="DaysFormat",$b[$b.DaysStandalone=4]="DaysStandalone",$b[$b.MonthsFormat=5]="MonthsFormat",$b[$b.MonthsStandalone=6]="MonthsStandalone",$b[$b.Eras=7]="Eras",$b[$b.FirstDayOfWeek=8]="FirstDayOfWeek",$b[$b.WeekendRange=9]="WeekendRange",$b[$b.DateFormat=10]="DateFormat",$b[$b.TimeFormat=11]="TimeFormat",$b[$b.DateTimeFormat=12]="DateTimeFormat",$b[$b.NumberSymbols=13]="NumberSymbols",$b[$b.NumberFormats=14]="NumberFormats",$b[$b.CurrencyCode=15]="CurrencyCode",$b[$b.CurrencySymbol=16]="CurrencySymbol",$b[$b.CurrencyName=17]="CurrencyName",$b[$b.Currencies=18]="Currencies",$b[$b.Directionality=19]="Directionality",$b[$b.PluralCase=20]="PluralCase",$b[$b.ExtraData=21]="ExtraData",$b),Wb=["zero","one","two","few","many"],jb="en-US",Zb={marker:"element"},Yb={marker:"ICU"},Kb=((Kb=Kb||{})[Kb.SHIFT=2]="SHIFT",Kb[Kb.APPEND_EAGERLY=1]="APPEND_EAGERLY",Kb[Kb.COMMENT=2]="COMMENT",Kb),Jb=jb;function Qb(e){(function(e,t){null==e&&Eg("Expected localeId to be defined",e,null,"!=")})(e),"string"==typeof e&&(Jb=e.toLowerCase().replace(/_/g,"-"))}function Xb(e,t,n){var r=t.insertBeforeIndex,i=Array.isArray(r)?r[0]:r;return null===i?tw(e,0,n):Ay(n[i])}function eE(e,t,n,r,i){var a=t.insertBeforeIndex;if(Array.isArray(a)){var o=r,s=null;if(3&t.type||(s=o,o=i),null!==o&&0==(2&t.flags))for(var u=1;u<a.length;u++)K_(e,o,n[a[u]],s,!1)}}function tE(e,t){if(e.push(t),e.length>1)for(var n=e.length-2;n>=0;n--){var r=e[n];nE(r)||rE(r,t)&&null===iE(r)&&aE(r,t.index)}}function nE(e){return!(64&e.type)}function rE(e,t){return nE(t)||e.index>t.index}function iE(e){var t=e.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function aE(e,t){var n=e.insertBeforeIndex;Array.isArray(n)?n[0]=t:(iw(Xb,eE),e.insertBeforeIndex=t)}function oE(e,t){var n=e.data[t];return null===n||"string"==typeof n?null:n.hasOwnProperty("currentCaseLViewIndex")?n:n.value}function sE(e,t,n){var r=Bw(e,n,64,null,null);return tE(t,r),r}function uE(e,t){var n=t[e.currentCaseLViewIndex];return null===n?n:n<0?~n:n}function cE(e){return e>>>17}function lE(e){return(131070&e)>>>1}var hE=0,fE=0;function dE(e,t,n,r){for(var i,a=n[11],o=null,s=0;s<t.length;s++){var u=t[s];if("string"==typeof u){var c=t[++s];null===n[c]&&(n[c]=U_(a,u))}else if("number"==typeof u)switch(1&u){case 0:var l=cE(u),h=void 0,f=void 0;if(null===o&&(o=l,i=X_(a,r)),l===o?(h=r,f=i):(h=null,f=Ay(n[l])),null!==f){var d=lE(u);K_(a,f,n[d],h,!1);var v=oE(e,d);if(null!==v&&"object"==typeof v){var p=uE(v,n);null!==p&&dE(e,v.create[p],n,n[v.anchorIdx])}}break;case 1:var g=t[++s],y=t[++s];oC(a,Ry(u>>>1,n),null,null,g,y,null);break;default:throw new Error('Unable to determine the type of mutate operation for "'.concat(u,'"'))}else switch(u){case Yb:var m=t[++s],k=t[++s];null===n[k]&&b_(n[k]=H_(a,m),n);break;case Zb:var _=t[++s],w=t[++s];null===n[w]&&b_(n[w]=G_(a,_,null),n)}}}function vE(e,t,n,r,i){for(var a=0;a<n.length;a++){var o=n[a],s=n[++a];if(o&i)for(var u="",c=a+1;c<=a+s;c++){var l=n[c];if("string"==typeof l)u+=l;else if("number"==typeof l)if(l<0)u+=wg(t[r-l]);else{var h=l>>>2;switch(3&l){case 1:var f=n[++c],d=n[++c],v=e.data[h];"string"==typeof v?oC(t[11],t[h],null,v,f,u,d):Jw(e,v,t,f,u,t[11],d,!1);break;case 0:var p=t[h];null!==p&&z_(t[11],p,u);break;case 2:gE(e,oE(e,h),t,u);break;case 3:pE(e,oE(e,h),r,t)}}}else{var g=n[a+1];if(g>0&&3==(3&g)){var y=oE(e,g>>>2);t[y.currentCaseLViewIndex]<0&&pE(e,y,r,t)}}a+=s}}function pE(e,t,n,r){var i=r[t.currentCaseLViewIndex];if(null!==i){var a=hE;i<0&&(i=r[t.currentCaseLViewIndex]=~i,a=-1),vE(e,r,t.update[i],n,a)}}function gE(e,t,n,r){var i=function(e,t){var n=e.cases.indexOf(t);if(-1===n)switch(e.type){case 1:var r=function(e,t){var n=Gb(t)(parseInt(e,10)),r=Wb[n];return void 0!==r?r:"other"}(t,Jb);-1===(n=e.cases.indexOf(r))&&"other"!==r&&(n=e.cases.indexOf("other"));break;case 0:n=e.cases.indexOf("other")}return-1===n?null:n}(t,r);if(uE(t,n)!==i&&(yE(e,t,n),n[t.currentCaseLViewIndex]=null===i?null:~i,null!==i)){var a=n[t.anchorIdx];a&&dE(e,t.create[i],n,a)}}function yE(e,t,n){var r=uE(t,n);if(null!==r)for(var i=t.remove[r],a=0;a<i.length;a++){var o=i[a];if(o>0){var s=Ry(o,n);null!==s&&cw(n[11],s)}else yE(e,oE(e,~o),n)}}function mE(){var e,t,n=[],r=-1;function i(e,n){r=0;var i=uE(e,n);t=null!==i?e.remove[i]:Wg}function a(){if(r<t.length){var o=t[r++];return o>0?e[o]:(n.push(r,t),i(e[1].data[~o],e),a())}return 0===n.length?null:(t=n.pop(),r=n.pop(),a())}return function(t,r){for(e=r;n.length;)n.pop();return i(t.value,r),a}}var kE=/\ufffd(\d+):?\d*\ufffd/gi,_E=/\ufffd(\d+)\ufffd/,wE=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,CE=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,bE=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,EE=/\uE500/g;function SE(e,t,n,r,i,a,o){var s=Vw(e,r,1,null),u=s<<Kb.SHIFT,c=Yy();t===c&&(c=null),null===c&&(u|=Kb.APPEND_EAGERLY),o&&(u|=Kb.COMMENT,function(e){void 0===R_&&(R_=e())}(mE)),i.push(u,null===a?"":a);var l=Bw(e,s,o?32:1,null===a?"":a,null);tE(n,l);var h=l.index;return Ky(l,!1),null!==c&&t!==c&&function(e,t){var n=e.insertBeforeIndex;null===n?(iw(Xb,eE),n=e.insertBeforeIndex=[null,t]):(function(e,t,n){true!=e&&Eg("Expecting array here",e,true,"==")}(Array.isArray(n)),n.push(t))}(c,h),l}function PE(e,t,n,r,i,a,o){var s=o.match(kE),u=SE(e,t,n,a,r,s?null:o,!1);s&&OE(i,o,u.index,null,0,null)}function OE(e,t,n,r,i,a){var o=e.length,s=o+1;e.push(null,null);for(var u=o+2,c=t.split(kE),l=0,h=0;h<c.length;h++){var f=c[h];if(1&h){var d=i+parseInt(f,10);e.push(-1-d),l|=TE(d)}else""!==f&&e.push(f)}return e.push(n<<2|(r?1:0)),r&&e.push(r,a),e[o]=l,e[s]=e.length-u,l}function TE(e){return 1<<Math.min(e,31)}function IE(e){for(var t,n,r="",i=0,a=!1;null!==(t=CE.exec(e));)a?t[0]==="\ufffd/*".concat(n,"\ufffd")&&(i=t.index,a=!1):(r+=e.substring(i,t.index+t[0].length),n=t[1],a=!0);return r+=e.substr(i)}function xE(e,t,n,r,i,a){var o=0,s={type:i.type,currentCaseLViewIndex:Vw(e,t,1,null),anchorIdx:a,cases:[],create:[],remove:[],update:[]};(function(e,t,n){e.push(TE(t.mainBinding),2,-1-t.mainBinding,n<<2|2)})(n,i,a),function(e,t,n){var r=e.data[t];null===r?e.data[t]=n:r.value=n}(e,a,s);for(var u=i.values,c=0;c<u.length;c++){for(var l=u[c],h=[],f=0;f<l.length;f++){var d=l[f];if("string"!=typeof d){var v=h.push(d)-1;l[f]="\x3c!--\ufffd".concat(v,"\ufffd--\x3e")}}o=NE(e,s,t,n,r,i.cases[c],l.join(""),h)|o}o&&function(e,t,n){e.push(t,1,n<<2|3)}(n,o,a)}function AE(e){for(var t=[],n=[],r=1,i=0,a=RE(e=e.replace(wE,function(e,t,n){return r="select"===n?0:1,i=parseInt(t.substr(1),10),""})),o=0;o<a.length;){var s=a[o++].trim();1===r&&(s=s.replace(/\s*(?:=)?(\w+)\s*/,"$1")),s.length&&t.push(s);var u=RE(a[o++]);t.length>n.length&&n.push(u)}return{type:r,mainBinding:i,cases:t,values:n}}function RE(e){if(!e)return[];var t,n=0,r=[],i=[],a=/[{}]/g;for(a.lastIndex=0;t=a.exec(e);){var o=t.index;if("}"==t[0]){if(r.pop(),0==r.length){var s=e.substring(n,o);wE.test(s)?i.push(AE(s)):i.push(s),n=o+1}}else{if(0==r.length){var u=e.substring(n,o);i.push(u),n=o+1}r.push("{")}}var c=e.substring(n);return i.push(c),i}function NE(e,t,n,r,i,a,o,s){var u=[],c=[],l=[];t.cases.push(a),t.create.push(u),t.remove.push(c),t.update.push(l);var h=Zk(Ty()).getInertBodyElement(o),f=y_(h)||h;return f?ME(e,t,n,r,u,c,l,f,i,s,0):0}function ME(e,t,n,r,i,a,o,s,u,c,l){for(var h=0,f=s.firstChild;f;){var d=Vw(e,n,1,null);switch(f.nodeType){case Node.ELEMENT_NODE:var v=f,p=v.tagName.toLowerCase();if(s_.hasOwnProperty(p)){FE(i,Zb,p,u,d),e.data[d]=p;for(var g=v.attributes,y=0;y<g.length;y++){var m=g.item(y),k=m.name.toLowerCase();m.value.match(kE)?l_.hasOwnProperty(k)&&OE(o,m.value,d,m.name,0,u_[k]?Xk:c_[k]?e_:null):BE(i,d,m)}h=ME(e,t,n,r,i,a,o,f,d,c,l+1)|h,DE(a,d,l)}break;case Node.TEXT_NODE:var _=f.textContent||"",w=_.match(kE);FE(i,null,w?"":_,u,d),DE(a,d,l),w&&(h=OE(o,_,d,null,0,null)|h);break;case Node.COMMENT_NODE:var C=_E.exec(f.textContent||"");if(C){var b=c[parseInt(C[1],10)];FE(i,Yb,"",u,d),xE(e,n,r,u,b,d),LE(a,d,l)}}f=f.nextSibling}return h}function DE(e,t,n){0===n&&e.push(t)}function LE(e,t,n){0===n&&(e.push(~t),e.push(t))}function FE(e,t,n,r,i){null!==t&&e.push(t),e.push(n,i,function(e,t,n){return 0|t<<17|n<<1}(0,r,i))}function BE(e,t,n){e.push(t<<1|1,n.name,n.value)}function VE(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=$y(),i=qy(),a=20+e,o=Vy(r.consts,t),s=Yy();r.firstCreatePass&&function(e,t,n,r,i,a){for(var o=Yy(),s=[],u=[],c=[[]],l=function(e){return e.replace(EE," ")}(i=function(e,t){if(function(e){return-1===e}(t))return IE(e);var n=e.indexOf(":".concat(t,"\ufffd"))+2+t.toString().length,r=e.search(new RegExp("\ufffd\\/\\*\\d+:".concat(t,"\ufffd")));return IE(e.substring(n,r))}(i,a)).split(bE),h=0;h<l.length;h++){var f=l[h];if(0==(1&h))for(var d=RE(f),v=0;v<d.length;v++){var p=d[v];if(0==(1&v)){var g=p;""!==g&&PE(e,o,c[0],s,u,n,g)}else{var y=p;if("object"!=typeof y)throw new Error('Unable to parse ICU expression in "'.concat(i,'" message.'));xE(e,n,u,t,y,SE(e,o,c[0],n,s,"",!0).index)}}else{var m=47===f.charCodeAt(0),k=(f.charCodeAt(m?1:0),20+Number.parseInt(f.substring(m?2:1)));if(m)c.shift(),Ky(Yy(),!1);else{var _=sE(e,c[0],k);c.unshift([]),Ky(_,!0)}}}e.data[r]={create:s,update:u}}(r,null===s?0:s.index,i,a,o,n);var u=r.data[a],c=Y_(r,s===i[6]?null:s,i);(function(e,t,n,r){for(var i=e[11],a=0;a<t.length;a++){var o=t[a++],s=t[a],u=(o&Kb.COMMENT)===Kb.COMMENT,c=(o&Kb.APPEND_EAGERLY)===Kb.APPEND_EAGERLY,l=o>>>Kb.SHIFT,h=e[l];null===h&&(h=e[l]=u?i.createComment(s):U_(i,s)),c&&null!==n&&K_(i,n,h,r,!1)}})(i,u.create,c,s&&8&s.type?i[s.index]:null),am(!0)}function UE(){am(!1)}function zE(e,t,n){VE(e,t,n),UE()}function HE(e){return function(e){e&&(hE|=1<<Math.min(fE,31)),fE++}(XC(qy(),rm(),e)),HE}function GE(e){!function(e,t,n){if(fE>0){var r=e.data[n];vE(e,t,Array.isArray(r)?r:r.update,nm()-fE-1,hE)}hE=0,fE=0}($y(),qy(),e+20)}function qE(e,t,n,r,i){if(e=mg(e),Array.isArray(e))for(var a=0;a<e.length;a++)qE(e[a],t,n,r,i);else{var o=$y(),s=qy(),u=BC(e)?e:mg(e.provide),c=DC(e),l=jy(),h=1048575&l.providerIndexes,f=l.directiveStart,d=l.providerIndexes>>20;if(BC(e)||!e.multi){var v=new Tm(c,i,ub),p=jE(u,t,i?h:h+d,f);-1===p?(qm(Um(l,s),o,u),$E(o,e,t.length),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(v),s.push(v)):(n[p]=v,s[p]=v)}else{var g=jE(u,t,h+d,f),y=jE(u,t,h,h+d),m=g>=0&&n[g],k=y>=0&&n[y];if(i&&!k||!i&&!m){qm(Um(l,s),o,u);var _=function(e,t,n,r,i){var a=new Tm(e,n,ub);return a.multi=[],a.index=t,a.componentProviders=0,WE(a,i,r&&!n),a}(i?YE:ZE,n.length,i,r,c);!i&&k&&(n[y].providerFactory=_),$E(o,e,t.length,0),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(_),s.push(_)}else $E(o,e,g>-1?g:y,WE(n[i?y:g],c,!i&&r));!i&&r&&k&&n[y].componentProviders++}}}function $E(e,t,n,r){var i=BC(t);if(i||function(e){return!!e.useClass}(t)){var a=(t.useClass||t).prototype.ngOnDestroy;if(a){var o=e.destroyHooks||(e.destroyHooks=[]);if(!i&&t.multi){var s=o.indexOf(n);-1===s?o.push(n,[r,a]):o[s+1].push(r,a)}else o.push(n,a)}}}function WE(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function jE(e,t,n,r){for(var i=n;i<r;i++)if(t[i]===e)return i;return-1}function ZE(e,t,n,r){return KE(this.multi,[])}function YE(e,t,n,r){var i,a=this.multi;if(this.providerFactory){var o=this.providerFactory.componentProviders,s=Qm(n,n[1],this.providerFactory.index,r);KE(a,i=s.slice(0,o));for(var u=o;u<s.length;u++)i.push(s[u])}else KE(a,i=[]);return i}function KE(e,t){for(var n=0;n<e.length;n++)t.push((0,e[n])());return t}function JE(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n){n.providersResolver=function(n,r){return function(e,t,n){var r=$y();if(r.firstCreatePass){var i=gy(e);qE(n,r.data,r.blueprint,i,!0),qE(t,r.data,r.blueprint,i,!1)}}(n,r?r(e):e,t)}}}var QE=ip(function e(){np(this,e)}),XE=function(){function e(){np(this,e)}return ip(e,[{key:"resolveComponentFactory",value:function(e){throw function(e){var t=Error("No component factory found for ".concat(vg(e),". Did you add it to @NgModule.entryComponents?"));return t.ngComponent=e,t}(e)}}]),e}(),eS=function(){var e=ip(function e(){np(this,e)});return e.NULL=new XE,e}();function tS(){}function nS(e,t){return new iS(Ny(e,t))}var rS=function(){return nS(jy(),qy())},iS=function(){var e=ip(function e(t){np(this,e),this.nativeElement=t});return e.__NG_ELEMENT_ID__=rS,e}();function aS(e){return e instanceof iS?e.nativeElement:e}var oS=ip(function e(){np(this,e)}),sS=function(){var e=ip(function e(){np(this,e)});return e.__NG_ELEMENT_ID__=function(){return uS()},e}(),uS=function(){var e=qy(),t=Ly(jy().index,e);return function(e){return e[11]}(hy(t)?t:e)},cS=function(){var e=ip(function e(){np(this,e)});return e.\u0275prov=Sg({token:e,providedIn:"root",factory:function(){return null}}),e}(),lS=ip(function e(t){np(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}),hS=new lS("12.2.16"),fS=function(){function e(){np(this,e)}return ip(e,[{key:"supports",value:function(e){return KC(e)}},{key:"create",value:function(e){return new vS(e)}}]),e}(),dS=function(e,t){return t},vS=function(){function e(t){np(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||dS}return ip(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,n=this._removalsHead,r=0,i=null;t||n;){var a=!n||t&&t.currentIndex<mS(n,r,i)?t:n,o=mS(a,r,i),s=a.currentIndex;if(a===n)r--,n=n._nextRemoved;else if(t=t._next,null==a.previousIndex)r++;else{i||(i=[]);var u=o-r,c=s-r;if(u!=c){for(var l=0;l<u;l++){var h=l<i.length?i[l]:i[l]=0,f=h+l;c<=f&&f<u&&(i[l]=h+1)}i[a.previousIndex]=c-u}}o!==s&&e(a,o,s)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!KC(e))throw new Error("Error trying to diff '".concat(vg(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n,r,i,a=this._itHead,o=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)r=e[s],i=this._trackByFn(s,r),null!==a&&Object.is(a.trackById,i)?(o&&(a=this._verifyReinsertion(a,r,i,s)),Object.is(a.item,r)||this._addIdentityChange(a,r)):(a=this._mismatch(a,r,i,s),o=!0),a=a._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var r,i=e[ZC()]();!(r=i.next()).done;)t(r.value)}(e,function(e){i=t._trackByFn(n,e),null!==a&&Object.is(a.trackById,i)?(o&&(a=t._verifyReinsertion(a,e,i,n)),Object.is(a.item,e)||t._addIdentityChange(a,e)):(a=t._mismatch(a,e,i,n),o=!0),a=a._next,n++}),this.length=n;return this._truncate(a),this.collection=e,this.isDirty}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}},{key:"_reset",value:function(){if(this.isDirty){var e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,n,r){var i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,r)):e=this._addAfter(new pS(t,n),i,r),e}},{key:"_verifyReinsertion",value:function(e,t,n,r){var i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?e=this._reinsertAfter(i,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var r=e._prevRemoved,i=e._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_moveAfter",value:function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_addAfter",value:function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,n){var r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new yS),this._linkedRecords.put(e),e.currentIndex=n,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new yS),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}]),e}(),pS=ip(function e(t,n){np(this,e),this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}),gS=function(){function e(){np(this,e),this._head=null,this._tail=null}return ip(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}},{key:"remove",value:function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}]),e}(),yS=function(){function e(){np(this,e),this.map=new Map}return ip(e,[{key:"put",value:function(e){var t=e.trackById,n=this.map.get(t);n||(n=new gS,this.map.set(t,n)),n.add(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?n.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"isEmpty",get:function(){return 0===this.map.size}},{key:"clear",value:function(){this.map.clear()}}]),e}();function mS(e,t,n){var r=e.previousIndex;if(null===r)return r;var i=0;return n&&r<n.length&&(i=n[r]),r+t+i}var kS=function(){function e(){np(this,e)}return ip(e,[{key:"supports",value:function(e){return e instanceof Map||JC(e)}},{key:"create",value:function(){return new _S}}]),e}(),_S=function(){function e(){np(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return ip(e,[{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}},{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||JC(e)))throw new Error("Error trying to diff '".concat(vg(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,function(e,r){if(n&&n.key===r)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var i=t._getOrCreateRecordForKey(r,e);n=t._insertBeforeOrAppend(n,i)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}var a=new wS(e);return this._records.set(e,a),a.currentValue=t,this._addToAdditions(a),a}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(function(n){return t(e[n],n)})}}]),e}(),wS=ip(function e(t){np(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null});function CS(){return new bS([new fS])}var bS=function(){var e=function(){function e(t){np(this,e),this.factories=t}return ip(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(null!=t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'"))}}],[{key:"create",value:function(t,n){if(null!=n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||CS())},deps:[[e,new Lk,new Dk]]}}}]),e}();return e.\u0275prov=Sg({token:e,providedIn:"root",factory:CS}),e}();function ES(){return new SS([new kS])}var SS=function(){var e=function(){function e(t){np(this,e),this.factories=t}return ip(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,n){if(n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||ES())},deps:[[e,new Lk,new Dk]]}}}]),e}();return e.\u0275prov=Sg({token:e,providedIn:"root",factory:ES}),e}();function PS(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==n;){var a=t[n.index];if(null!==a&&r.push(Ay(a)),fy(a))for(var o=10;o<a.length;o++){var s=a[o],u=s[1].firstChild;null!==u&&PS(s[1],s,u,r)}var c=n.type;if(8&c)PS(e,t,n.child,r);else if(32&c)for(var l=M_(n,t),h=void 0;h=l();)r.push(h);else if(16&c){var f=sw(t,n);if(Array.isArray(f))r.push.apply(r,Jv(f));else{var d=D_(t[16]);PS(d[1],d,f,r,!0)}}n=i?n.projectionNext:n.next}return r}var OS=function(){function e(t,n){np(this,e),this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}return ip(e,[{key:"rootNodes",get:function(){var e=this._lView,t=e[1];return PS(t,e,t.firstChild,[])}},{key:"context",get:function(){return this._lView[8]},set:function(e){this._lView[8]=e}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}},{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){var e=this._lView[3];if(fy(e)){var t=e[8],n=t?t.indexOf(this):-1;n>-1&&($_(e,n),dk(t,n))}this._attachedToViewContainer=!1}W_(this._lView[1],this._lView)}},{key:"onDestroy",value:function(e){Yw(this._lView[1],this._lView,null,e)}},{key:"markForCheck",value:function(){vC(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){pC(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(e,t,n){em(!0);try{pC(e,t,n)}finally{em(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}},{key:"detachFromAppRef",value:function(){var e;this._appRef=null,hw(this._lView[1],e=this._lView,e[11],2,null,null)}},{key:"attachToAppRef",value:function(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}]),e}(),TS=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e))._view=e,r}return ip(n,[{key:"detectChanges",value:function(){gC(this._view)}},{key:"checkNoChanges",value:function(){!function(e){em(!0);try{gC(e)}finally{em(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),n}(OS),IS=function(e){return function(e,t,n){if(vy(e)&&!n){var r=Ly(e.index,t);return new OS(r,r)}return 47&e.type?new OS(t[16],t):null}(jy(),qy(),16==(16&e))},xS=function(){var e=ip(function e(){np(this,e)});return e.__NG_ELEMENT_ID__=IS,e}(),AS=[new kS],RS=new bS([new fS]),NS=new SS(AS),MS=function(){return FS(jy(),qy())},DS=function(){var e=ip(function e(){np(this,e)});return e.__NG_ELEMENT_ID__=MS,e}(),LS=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this))._declarationLView=e,a._declarationTContainer=r,a.elementRef=i,a}return ip(n,[{key:"createEmbeddedView",value:function(e){var t=this._declarationTContainer.tViews,n=Lw(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];var r=this._declarationLView[19];return null!==r&&(n[19]=r.createEmbeddedView(t)),Uw(t,n,e),new OS(n)}}]),n}(DS);function FS(e,t){return 4&e.type?new LS(t,e,nS(e,t)):null}var BS=ip(function e(){np(this,e)}),VS=ip(function e(){np(this,e)}),US=function(){return $S(jy(),qy())},zS=function(){var e=ip(function e(){np(this,e)});return e.__NG_ELEMENT_ID__=US,e}(),HS=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this))._lContainer=e,a._hostTNode=r,a._hostLView=i,a}return ip(n,[{key:"element",get:function(){return nS(this._hostTNode,this._hostLView)}},{key:"injector",get:function(){return new tk(this._hostTNode,this._hostLView)}},{key:"parentInjector",get:function(){var e=Gm(this._hostTNode,this._hostLView);if(Mm(e)){var t=Lm(e,this._hostLView),n=Dm(e);return new tk(t[1].data[n+8],t)}return new tk(null,this._hostLView)}},{key:"clear",value:function(){for(;this.length>0;)this.remove(this.length-1)}},{key:"get",value:function(e){var t=GS(this._lContainer);return null!==t&&t[e]||null}},{key:"length",get:function(){return this._lContainer.length-10}},{key:"createEmbeddedView",value:function(e,t,n){var r=e.createEmbeddedView(t||{});return this.insert(r,n),r}},{key:"createComponent",value:function(e,t,n,r,i){var a=n||this.parentInjector;if(!i&&null==e.ngModule&&a){var o=a.get(BS,null);o&&(i=o)}var s=e.create(a,r,void 0,i);return this.insert(s.hostView,t),s}},{key:"insert",value:function(e,t){var r=e._lView,i=r[1];if(fy(r[3])){var a=this.indexOf(e);if(-1!==a)this.detach(a);else{var o=r[3],s=new n(o,o[6],o[3]);s.detach(s.indexOf(e))}}var u=this._adjustIndex(t),c=this._lContainer;!function(e,t,n,r){var i=10+r,a=n.length;r>0&&(n[i-1][4]=t),r<a-10?(t[4]=n[i],fk(n,10+r,t)):(n.push(t),t[4]=null),t[3]=n;var o=t[17];null!==o&&n!==o&&function(e,t){var n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(o,t);var s=t[19];null!==s&&s.insertView(e),t[2]|=128}(i,r,c,u);var l=uw(u,c),h=r[11],f=X_(h,c[7]);return null!==f&&function(e,t,n,r,i,a){r[0]=i,r[6]=t,hw(e,r,n,1,i,a)}(i,c[6],h,r,f,l),e.attachToViewContainerRef(),fk(qS(c),u,e),e}},{key:"move",value:function(e,t){return this.insert(e,t)}},{key:"indexOf",value:function(e){var t=GS(this._lContainer);return null!==t?t.indexOf(e):-1}},{key:"remove",value:function(e){var t=this._adjustIndex(e,-1),n=$_(this._lContainer,t);n&&(dk(qS(this._lContainer),t),W_(n[1],n))}},{key:"detach",value:function(e){var t=this._adjustIndex(e,-1),n=$_(this._lContainer,t);return n&&null!=dk(qS(this._lContainer),t)?new OS(n):null}},{key:"_adjustIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null!=e?e:this.length+t}}]),n}(zS);function GS(e){return e[8]}function qS(e){return e[8]||(e[8]=[])}function $S(e,t){var n,r=t[e.index];if(fy(r))n=r;else{var i;if(8&e.type)i=Ay(r);else{var a=t[11];i=a.createComment("");var o=Ny(e,t);K_(a,X_(a,o),i,function(e,t){return Iy(e)?e.nextSibling(t):t.nextSibling}(a,o),!1)}t[e.index]=n=cC(r,t,i,e),dC(t,n)}return new HS(n,e,t)}var WS={},jS=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this)).ngModule=e,r}return ip(n,[{key:"resolveComponentFactory",value:function(e){var t=cy(e);return new KS(t,this.ngModule)}}]),n}(eS);function ZS(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}var YS=new sk("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return x_}}),KS=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this)).componentDef=e,i.ngModule=r,i.componentType=e.type,i.selector=e.selectors.map(Sw).join(","),i.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],i.isBoundToModule=!!r,i}return ip(n,[{key:"inputs",get:function(){return ZS(this.componentDef.inputs)}},{key:"outputs",get:function(){return ZS(this.componentDef.outputs)}},{key:"create",value:function(e,t,n,r){var i,a,o=(r=r||this.ngModule)?function(e,t){return{get:function(n,r,i){var a=e.get(n,WS,i);return a!==WS||r===WS?a:t.get(n,r,i)}}}(e,r.injector):e,s=o.get(oS,xy),u=o.get(cS,null),c=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",h=n?function(e,t,n){if(Iy(e))return e.selectRootElement(t,n===Ug.ShadowDom);var r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(c,n,this.componentDef.encapsulation):G_(s.createRenderer(null,this.componentDef),l,function(e){var t=e.toLowerCase();return"svg"===t?Oy:"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),f=this.componentDef.onPush?576:528,d={components:[],scheduler:x_,clean:mC,playerHandler:null,flags:0},v=Zw(0,null,null,1,0,null,null,null,null,null),p=Lw(null,v,d,f,null,null,s,c,u,o);fm(p);try{var g=function(e,t,n,r,i,a){var o=n[1];n[20]=e;var s=Fw(o,20,2,"#host",null),u=s.mergedAttrs=t.hostAttrs;null!==u&&(EC(s,u,!0),null!==e&&(Im(i,e,u),null!==s.classes&&vw(i,e,s.classes),null!==s.styles&&dw(i,e,s.styles)));var c=r.createRenderer(e,t),l=Lw(n,jw(t),null,t.onPush?64:16,n[20],s,r,c,null,null);return o.firstCreatePass&&(qm(Um(s,n),o,t.type),tC(o,s),rC(s,n.length,1)),dC(n,l),n[20]=l}(h,this.componentDef,p,s,c);if(h)if(n)Im(c,h,["ng-version",hS.full]);else{var y=function(e){for(var t=[],n=[],r=1,i=2;r<e.length;){var a=e[r];if("string"==typeof a)2===i?""!==a&&t.push(a,e[++r]):8===i&&n.push(a);else{if(!ww(i))break;i=a}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]),m=y.attrs,k=y.classes;m&&Im(c,h,m),k&&k.length>0&&vw(c,h,k.join(" "))}if(a=My(v,20),void 0!==t)for(var _=a.projection=[],w=0;w<this.ngContentSelectors.length;w++){var C=t[w];_.push(null!=C?Array.from(C):null)}i=function(e,t,n,r,i){var a=n[1],o=function(e,t,n){var r=jy();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),iC(e,r,t,Vw(e,t,1,null),n));var i=Qm(t,e,r.directiveStart,r);b_(i,t);var a=Ny(r,t);return a&&b_(a,t),i}(a,n,t);if(r.components.push(o),e[8]=o,i&&i.forEach(function(e){return e(o,t)}),t.contentQueries){var s=jy();t.contentQueries(1,o,s.directiveStart)}var u=jy();return!a.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(km(u.index),Xw(n[1],u,0,u.directiveStart,u.directiveEnd,t),eC(t,o)),o}(g,this.componentDef,p,d,[zC]),Uw(v,p,null)}finally{ym()}return new JS(this.componentType,i,nS(a,p),p,a)}}]),n}(QE),JS=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o){var s;return np(this,n),(s=t.call(this)).location=i,s._rootLView=a,s._tNode=o,s.instance=r,s.hostView=s.changeDetectorRef=new TS(a),s.componentType=e,s}return ip(n,[{key:"injector",get:function(){return new tk(this._tNode,this._rootLView)}},{key:"destroy",value:function(){this.hostView.destroy()}},{key:"onDestroy",value:function(e){this.hostView.onDestroy(e)}}]),n}(function(){return ip(function e(){np(this,e)})}()),QS=new Map,XS=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;np(this,n),(i=t.call(this))._parent=r,i._bootstrapComponents=[],i.injector=Zv(i),i.destroyCbs=[],i.componentFactoryResolver=new jS(Zv(i));var a=ly(e),o=e[Jg]||null;return o&&Qb(o),i._bootstrapComponents=A_(a.bootstrap),i._r3Injector=RC(e,r,[{provide:BS,useValue:Zv(i)},{provide:eS,useValue:i.componentFactoryResolver}],vg(e)),i._r3Injector._resolveInjectorDefTypes(),i.instance=i.get(e),i}return ip(n,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:UC.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Dg.Default;return e===UC||e===BS||e===PC?this:this._r3Injector.get(e,t,n)}},{key:"destroy",value:function(){var e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(function(e){return e()}),this.destroyCbs=null}},{key:"onDestroy",value:function(e){this.destroyCbs.push(e)}}]),n}(BS),eP=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this)).moduleType=e,null!==ly(e)&&function(e){var t=new Set;!function e(n){var r=ly(n,!0),i=r.id;null!==i&&(function(e,t,n){if(t&&t!==n)throw new Error("Duplicate module registered for ".concat(e," - ").concat(vg(t)," vs ").concat(vg(t.name)))}(i,QS.get(i),n),QS.set(i,n));var a,o=Xv(A_(r.imports));try{for(o.s();!(a=o.n()).done;){var s=a.value;t.has(s)||(t.add(s),e(s))}}catch(u){o.e(u)}finally{o.f()}}(e)}(e),r}return ip(n,[{key:"create",value:function(e){return new XS(this.moduleType,e)}}]),n}(VS);function tP(e,t,n){var r=tm()+e,i=qy();return i[r]===Pw?QC(i,r,n?t.call(n):t()):function(e,t){return e[t]}(i,r)}function nP(e,t,n,r){return aP(qy(),tm(),e,t,n,r)}function rP(e,t,n,r,i){return oP(qy(),tm(),e,t,n,r,i)}function iP(e,t){var n=e[t];return n===Pw?void 0:n}function aP(e,t,n,r,i,a){var o=t+n;return XC(e,o,i)?QC(e,o+1,a?r.call(a,i):r(i)):iP(e,o+1)}function oP(e,t,n,r,i,a,o){var s=t+n;return eb(e,s,i,a)?QC(e,s+2,o?r.call(o,i,a):r(i,a)):iP(e,s+2)}function sP(e,t){var n,r=$y(),i=e+20;r.firstCreatePass?(n=function(e,t){if(t)for(var n=t.length-1;n>=0;n--){var r=t[n];if(e===r.name)return r}throw new _g("302","The pipe '".concat(e,"' could not be found!"))}(t,r.pipeRegistry),r.data[i]=n,n.onDestroy&&(r.destroyHooks||(r.destroyHooks=[])).push(i,n.onDestroy)):n=r.data[i];var a=n.factory||(n.factory=my(n.type)),o=Lg(ub);try{var s=Bm(!1),u=a();return Bm(s),function(e,t,n,r){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=r}(r,qy(),i,u),u}finally{Lg(o)}}function uP(e,t,n){var r=e+20,i=qy(),a=Dy(i,r);return hP(i,lP(i,r)?aP(i,tm(),t,a.transform,n,a):a.transform(n))}function cP(e,t,n,r,i){var a=e+20,o=qy(),s=Dy(o,a);return hP(o,lP(o,a)?function(e,t,n,r,i,a,o,s){var u=t+n;return tb(e,u,i,a,o)?QC(e,u+3,s?r.call(s,i,a,o):r(i,a,o)):iP(e,u+3)}(o,tm(),t,s.transform,n,r,i,s):s.transform(n,r,i))}function lP(e,t){return e[1].data[t].pure}function hP(e,t){return YC.isWrapped(t)&&(t=YC.unwrap(t),e[nm()]=Pw),t}function fP(e){return function(t){setTimeout(e,void 0,t)}}var dP=function(e){qv(n,e);var t=Wv(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return np(this,n),(e=t.call(this)).__isAsync=r,e}return ip(n,[{key:"emit",value:function(e){Hv(Kv(n.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,t,r){var i,a,o,s=e,u=t||function(){return null},c=r;if(e&&"object"==typeof e){var l=e;s=null===(i=l.next)||void 0===i?void 0:i.bind(l),u=null===(a=l.error)||void 0===a?void 0:a.bind(l),c=null===(o=l.complete)||void 0===o?void 0:o.bind(l)}this.__isAsync&&(u=fP(u),s&&(s=fP(s)),c&&(c=fP(c)));var h=Hv(Kv(n.prototype),"subscribe",this).call(this,{next:s,error:u,complete:c});return e instanceof ap&&e.add(h),h}}]),n}(Rp);function vP(){return this._results[ZC()]()}var pP=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];np(this,e),this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;var n=ZC(),r=e.prototype;r[n]||(r[n]=vP)}return ip(e,[{key:"changes",get:function(){return this._changes||(this._changes=new dP)}},{key:"get",value:function(e){return this._results[e]}},{key:"map",value:function(e){return this._results.map(e)}},{key:"filter",value:function(e){return this._results.filter(e)}},{key:"find",value:function(e){return this._results.find(e)}},{key:"reduce",value:function(e,t){return this._results.reduce(e,t)}},{key:"forEach",value:function(e){this._results.forEach(e)}},{key:"some",value:function(e){return this._results.some(e)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(e,t){var n=this;n.dirty=!1;var r=lk(e);(this._changesDetected=!function(e,t,n){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++){var i=e[r],a=t[r];if(n&&(i=n(i),a=n(a)),a!==i)return!1}return!0}(n._results,r,t))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}},{key:"notifyOnChanges",value:function(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),e}();Symbol;var gP=function(){function e(t){np(this,e),this.queryList=t,this.matches=null}return ip(e,[{key:"clone",value:function(){return new e(this.queryList)}},{key:"setDirty",value:function(){this.queryList.setDirty()}}]),e}(),yP=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];np(this,e),this.queries=t}return ip(e,[{key:"createEmbeddedView",value:function(t){var n=t.queries;if(null!==n){for(var r=null!==t.contentQueries?t.contentQueries[0]:n.length,i=[],a=0;a<r;a++){var o=n.getByIndex(a);i.push(this.queries[o.indexInDeclarationView].clone())}return new e(i)}return null}},{key:"insertView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"detachView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"dirtyQueriesWithMatches",value:function(e){for(var t=0;t<this.queries.length;t++)null!==TP(e,t).matches&&this.queries[t].setDirty()}}]),e}(),mP=ip(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;np(this,e),this.predicate=t,this.flags=n,this.read=r}),kP=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];np(this,e),this.queries=t}return ip(e,[{key:"elementStart",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}},{key:"elementEnd",value:function(e){for(var t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}},{key:"embeddedTView",value:function(t){for(var n=null,r=0;r<this.length;r++){var i=null!==n?n.length:0,a=this.getByIndex(r).embeddedTView(t,i);a&&(a.indexInDeclarationView=r,null!==n?n.push(a):n=[a])}return null!==n?new e(n):null}},{key:"template",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}},{key:"getByIndex",value:function(e){return this.queries[e]}},{key:"length",get:function(){return this.queries.length}},{key:"track",value:function(e){this.queries.push(e)}}]),e}(),_P=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;np(this,e),this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}return ip(e,[{key:"elementStart",value:function(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}},{key:"elementEnd",value:function(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}},{key:"template",value:function(e,t){this.elementStart(e,t)}},{key:"embeddedTView",value:function(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new e(this.metadata)):null}},{key:"isApplyingToNode",value:function(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){for(var t=this._declarationNodeIndex,n=e.parent;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}},{key:"matchTNode",value:function(e,t){var n=this.metadata.predicate;if(Array.isArray(n))for(var r=0;r<n.length;r++){var i=n[r];this.matchTNodeWithReadOption(e,t,wP(t,i)),this.matchTNodeWithReadOption(e,t,Jm(t,e,i,!1,!1))}else n===DS?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Jm(t,e,n,!1,!1))}},{key:"matchTNodeWithReadOption",value:function(e,t,n){if(null!==n){var r=this.metadata.read;if(null!==r)if(r===iS||r===zS||r===DS&&4&t.type)this.addMatch(t.index,-2);else{var i=Jm(t,e,r,!1,!1);null!==i&&this.addMatch(t.index,i)}else this.addMatch(t.index,n)}}},{key:"addMatch",value:function(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}]),e}();function wP(e,t){var n=e.localNames;if(null!==n)for(var r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function CP(e,t,n,r){return-1===n?function(e,t){return 11&e.type?nS(e,t):4&e.type?FS(e,t):null}(t,e):-2===n?function(e,t,n){return n===iS?nS(t,e):n===DS?FS(t,e):n===zS?$S(t,e):void 0}(e,t,r):Qm(e,e[1],n,t)}function bP(e,t,n,r){var i=t[19].queries[r];if(null===i.matches){for(var a=e.data,o=n.matches,s=[],u=0;u<o.length;u+=2){var c=o[u];s.push(c<0?null:CP(t,a[c],o[u+1],n.metadata.read))}i.matches=s}return i.matches}function EP(e,t,n,r){var i=e.queries.getByIndex(n),a=i.matches;if(null!==a)for(var o=bP(e,t,i,n),s=0;s<a.length;s+=2){var u=a[s];if(u>0)r.push(o[s/2]);else{for(var c=a[s+1],l=t[-u],h=10;h<l.length;h++){var f=l[h];f[17]===f[3]&&EP(f[1],f,c,r)}if(null!==l[9])for(var d=l[9],v=0;v<d.length;v++){var p=d[v];EP(p[1],p,c,r)}}}return r}function SP(e){var t=qy(),n=$y(),r=um();cm(r+1);var i=TP(n,r);if(e.dirty&&Fy(t)===(2==(2&i.metadata.flags))){if(null===i.matches)e.reset([]);else{var a=i.crossesNgTemplate?EP(n,t,r,[]):bP(n,t,i,r);e.reset(a,aS),e.notifyOnChanges()}return!0}return!1}function PP(e,t,n){var r=$y();r.firstCreatePass&&(function(e,t,n){null===e.queries&&(e.queries=new kP),e.queries.track(new _P(t,-1))}(r,new mP(e,t,n)),2==(2&t)&&(r.staticViewQueries=!0)),function(e,t,n){var r=new pP(4==(4&n));Yw(e,t,r,r.destroy),null===t[19]&&(t[19]=new yP),t[19].queries.push(new gP(r))}(r,qy(),t)}function OP(){return e=qy(),t=um(),e[19].queries[t].queryList;var e,t}function TP(e,t){return e.queries.getByIndex(t)}function IP(e,t){return FS(e,t)}var xP=new sk("Application Initializer"),AP=function(){var e=function(){function e(t){var n=this;np(this,e),this.appInits=t,this.resolve=tS,this.reject=tS,this.initialized=!1,this.done=!1,this.donePromise=new Promise(function(e,t){n.resolve=e,n.reject=t})}return ip(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var r=function(n){var r=e.appInits[n]();if(yb(r))t.push(r);else if(mb(r)){var i=new Promise(function(e,t){r.subscribe({complete:e,error:t})});t.push(i)}},i=0;i<this.appInits.length;i++)r(i);Promise.all(t).then(function(){n()}).catch(function(t){e.reject(t)}),0===t.length&&n(),this.initialized=!0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(xP,8))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),RP=new sk("AppId"),NP={provide:RP,useFactory:function(){return"".concat(MP()).concat(MP()).concat(MP())},deps:[]};function MP(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var DP=new sk("Platform Initializer"),LP=new sk("Platform ID"),FP=new sk("appBootstrapListener"),BP=function(){var e=function(){function e(){np(this,e)}return ip(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),VP=new sk("LocaleId"),UP=new sk("DefaultCurrencyCode"),zP=ip(function e(t,n){np(this,e),this.ngModuleFactory=t,this.componentFactories=n}),HP=function(e){return new eP(e)},GP=HP,qP=function(e){return Promise.resolve(HP(e))},$P=function(e){var t=HP(e),n=A_(ly(e).declarations).reduce(function(e,t){var n=cy(t);return n&&e.push(new KS(n)),e},[]);return new zP(t,n)},WP=$P,jP=function(e){return Promise.resolve($P(e))},ZP=function(){var e=function(){function e(){np(this,e),this.compileModuleSync=GP,this.compileModuleAsync=qP,this.compileModuleAndAllComponentsSync=WP,this.compileModuleAndAllComponentsAsync=jP}return ip(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),YP=Promise.resolve(0);function KP(e){"undefined"==typeof Zone?YP.then(function(){e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var JP=function(){function e(t){var n=t.enableLongStackTrace,r=void 0!==n&&n,i=t.shouldCoalesceEventChangeDetection,a=void 0!==i&&i,o=t.shouldCoalesceRunChangeDetection,s=void 0!==o&&o;if(np(this,e),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new dP(!1),this.onMicrotaskEmpty=new dP(!1),this.onStable=new dP(!1),this.onError=new dP(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();var u=this;u._nesting=0,u._outer=u._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(u._inner=u._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(u._inner=u._inner.fork(Zone.longStackTraceZoneSpec)),u.shouldCoalesceEventChangeDetection=!s&&a,u.shouldCoalesceRunChangeDetection=s,u.lastRequestAnimationFrameId=-1,u.nativeRequestAnimationFrame=function(){var e=qg.requestAnimationFrame,t=qg.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){var n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);var r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){var t=function(){!function(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(qg,function(){e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",function(){e.lastRequestAnimationFrameId=-1,eO(e),e.isCheckStableRunning=!0,XP(e),e.isCheckStableRunning=!1},void 0,function(){},function(){})),e.fakeTopEventTask.invoke()}),eO(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(n,r,i,a,o,s){try{return tO(e),n.invokeTask(i,a,o,s)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===a.type||e.shouldCoalesceRunChangeDetection)&&t(),nO(e)}},onInvoke:function(n,r,i,a,o,s,u){try{return tO(e),n.invoke(i,a,o,s,u)}finally{e.shouldCoalesceRunChangeDetection&&t(),nO(e)}},onHasTask:function(t,n,r,i){t.hasTask(r,i),n===r&&("microTask"==i.change?(e._hasPendingMicrotasks=i.microTask,eO(e),XP(e)):"macroTask"==i.change&&(e.hasPendingMacrotasks=i.macroTask))},onHandleError:function(t,n,r,i){return t.handleError(r,i),e.runOutsideAngular(function(){return e.onError.emit(i)}),!1}})}(u)}return ip(e,[{key:"run",value:function(e,t,n){return this._inner.run(e,t,n)}},{key:"runTask",value:function(e,t,n,r){var i=this._inner,a=i.scheduleEventTask("NgZoneEvent: "+r,e,QP,tS,tS);try{return i.runTask(a,t,n)}finally{i.cancelTask(a)}}},{key:"runGuarded",value:function(e,t,n){return this._inner.runGuarded(e,t,n)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}(),QP={};function XP(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(function(){return e.onStable.emit(null)})}finally{e.isStable=!0}}}function eO(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function tO(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function nO(e){e._nesting--,XP(e)}var rO,iO=function(){function e(){np(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new dP,this.onMicrotaskEmpty=new dP,this.onStable=new dP,this.onError=new dP}return ip(e,[{key:"run",value:function(e,t,n){return e.apply(t,n)}},{key:"runGuarded",value:function(e,t,n){return e.apply(t,n)}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e,t,n,r){return e.apply(t,n)}}]),e}(),aO=function(){var e=function(){function e(t){var n=this;np(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}return ip(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular(function(){e._ngZone.onStable.subscribe({next:function(){JP.assertNotInAngularZone(),KP(function(){e._isZoneStable=!0,e._runCallbacksIfReady()})}})})}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())KP(function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1});else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter(function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)}),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}}):[]}},{key:"addCallback",value:function(e,t,n){var r=this,i=-1;t&&t>0&&(i=setTimeout(function(){r._callbacks=r._callbacks.filter(function(e){return e.timeoutId!==i}),e(r._didWork,r.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:n})}},{key:"whenStable",value:function(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,n){return[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(JP))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),oO=function(){var e=function(){function e(){np(this,e),this._applications=new Map,sO.addToWindow(this)}return ip(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return sO.findTestabilityInTree(this,e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),sO=new(function(){function e(){np(this,e)}return ip(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,n){return null}}]),e}()),uO=!0,cO=!1,lO=new sk("AllowMultipleToken"),hO=ip(function e(t,n){np(this,e),this.name=t,this.token=n});function fO(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="Platform: ".concat(t),i=new sk(r);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=dO();if(!a||a.injector.get(lO,!1))if(e)e(n.concat(t).concat({provide:i,useValue:!0}));else{var o=n.concat(t).concat({provide:i,useValue:!0},{provide:TC,useValue:"platform"});!function(e){if(rO&&!rO.destroyed&&!rO.injector.get(lO,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");rO=e.get(vO);var t=e.get(DP,null);t&&t.forEach(function(e){return e()})}(UC.create({providers:o,name:r}))}return function(e){var t=dO();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(i)}}function dO(){return rO&&!rO.destroyed?rO:null}var vO=function(){var e=function(){function e(t){np(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return ip(e,[{key:"bootstrapModuleFactory",value:function(e,t){var n=this,r=function(e,t){return"noop"===e?new iO:("zone.js"===e?void 0:e)||new JP({enableLongStackTrace:(cO=!0,uO),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)})}(t?t.ngZone:void 0,{ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1}),i=[{provide:JP,useValue:r}];return r.run(function(){var a=UC.create({providers:i,parent:n.injector,name:e.moduleType.name}),o=e.create(a),s=o.injector.get(O_,null);if(!s)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return r.runOutsideAngular(function(){var e=r.onError.subscribe({next:function(e){s.handleError(e)}});o.onDestroy(function(){yO(n._modules,o),e.unsubscribe()})}),function(e,r,i){try{var a=((s=o.injector.get(AP)).runInitializers(),s.donePromise.then(function(){return Qb(o.injector.get(VP,jb)||jb),n._moduleDoBootstrap(o),o}));return yb(a)?a.catch(function(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}):a}catch(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}var s}(s,r)})}},{key:"bootstrapModule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=pO({},n);return function(e,t,n){var r=new eP(n);return Promise.resolve(r)}(0,0,e).then(function(e){return t.bootstrapModuleFactory(e,r)})}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(gO);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(function(e){return t.bootstrap(e)});else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(vg(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.'));e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"injector",get:function(){return this._injector}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(function(e){return e.destroy()}),this._destroyListeners.forEach(function(e){return e()}),this._destroyed=!0}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(UC))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}();function pO(e,t){return Array.isArray(t)?t.reduce(pO,e):Object.assign(Object.assign({},e),t)}var gO=function(){var e=function(){function e(t,n,r,i,a){var o=this;np(this,e),this._zone=t,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:function(){o._zone.run(function(){o.tick()})}});var s=new Ip(function(e){o._stable=o._zone.isStable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks,o._zone.runOutsideAngular(function(){e.next(o._stable),e.complete()})}),u=new Ip(function(e){var t;o._zone.runOutsideAngular(function(){t=o._zone.onStable.subscribe(function(){JP.assertNotInAngularZone(),KP(function(){!o._stable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks&&(o._stable=!0,e.next(!0))})})});var n=o._zone.onUnstable.subscribe(function(){JP.assertInAngularZone(),o._stable&&(o._stable=!1,o._zone.runOutsideAngular(function(){e.next(!1)}))});return function(){t.unsubscribe(),n.unsubscribe()}});this.isStable=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=ag(t),i=function(e,t){return"number"==typeof rg(e)?e.pop():1/0}(t),a=t;return a.length?1===a.length?Jp(a[0]):tg(i)(cg(a,r)):ng}(s,u.pipe(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.connector,n=void 0===t?function(){return new Rp}:t,r=e.resetOnError,i=void 0===r||r,a=e.resetOnComplete,o=void 0===a||a,s=e.resetOnRefCountZero,u=void 0===s||s;return function(e){var t=null,r=null,a=null,s=0,c=!1,l=!1,h=function(){null==r||r.unsubscribe(),r=null},f=function(){h(),t=a=null,c=l=!1},d=function(){var e=t;f(),null==e||e.unsubscribe()};return Dp(function(e,v){var p;s++,!l&&!c&&h();var g=a=null!==(p=a)&&void 0!==p?p:n();v.add(function(){0===--s&&!l&&!c&&(r=hg(d,u))}),g.subscribe(v),t||(t=new Cp({next:function(e){return g.next(e)},error:function(e){l=!0,h(),r=hg(f,i,e),g.error(e)},complete:function(){c=!0,h(),r=hg(f,o),g.complete()}}),cg(e).subscribe(t))})(e)}}()))}return ip(e,[{key:"bootstrap",value:function(e,t){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof QE?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var i=function(e){return e.isBoundToModule}(n)?void 0:this._injector.get(BS),a=n.create(UC.NULL,[],t||n.selector,i),o=a.location.nativeElement,s=a.injector.get(aO,null),u=s&&a.injector.get(oO);return s&&u&&u.registerApplication(o,s),a.onDestroy(function(){r.detachView(a.hostView),yO(r.components,a),u&&u.unregisterApplication(o)}),this._loadComponent(a),a}},{key:"tick",value:function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;var t,n=Xv(this._views);try{for(n.s();!(t=n.n()).done;){var r;t.value.detectChanges()}}catch(i){n.e(i)}finally{n.f()}}catch(r){this._zone.runOutsideAngular(function(){return e._exceptionHandler.handleError(r)})}finally{this._runningTick=!1}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;yO(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(FP,[]).concat(this._bootstrapListeners).forEach(function(t){return t(e)})}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach(function(e){return e.destroy()}),this._onMicrotaskEmptySubscription.unsubscribe()}},{key:"viewCount",get:function(){return this._views.length}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(JP),Ok(UC),Ok(O_),Ok(eS),Ok(AP))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}();function yO(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var mO=ip(function e(){np(this,e)}),kO=ip(function e(){np(this,e)}),_O={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},wO=function(){var e=function(){function e(t,n){np(this,e),this._compiler=t,this._config=n||_O}return ip(e,[{key:"load",value:function(e){return this.loadAndCompile(e)}},{key:"loadAndCompile",value:function(e){var t=this,n=Fv(e.split("#"),2),r=n[0],i=n[1];return void 0===i&&(i="default"),Vv(8255)(r).then(function(e){return e[i]}).then(function(e){return CO(e,r,i)}).then(function(e){return t._compiler.compileModuleAsync(e)})}},{key:"loadFactory",value:function(e){var t=Fv(e.split("#"),2),n=t[0],r=t[1],i="NgFactory";return void 0===r&&(r="default",i=""),Vv(8255)(this._config.factoryPathPrefix+n+this._config.factoryPathSuffix).then(function(e){return e[r+i]}).then(function(e){return CO(e,n,r)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(ZP),Ok(kO,8))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}();function CO(e,t,n){if(!e)throw new Error("Cannot find '".concat(n,"' in '").concat(t,"'"));return e}var bO=fO(null,"core",[{provide:LP,useValue:"unknown"},{provide:vO,deps:[UC]},{provide:oO,deps:[]},{provide:BP,deps:[]}]),EO=[{provide:gO,useClass:gO,deps:[JP,UC,O_,eS,AP]},{provide:YS,deps:[JP],useFactory:function(e){var t=[];return e.onStable.subscribe(function(){for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:AP,useClass:AP,deps:[[new Dk,xP]]},{provide:ZP,useClass:ZP,deps:[]},NP,{provide:bS,useFactory:function(){return RS},deps:[]},{provide:SS,useFactory:function(){return NS},deps:[]},{provide:VP,useFactory:function(e){return Qb(e=e||"undefined"!=typeof $localize&&$localize.locale||jb),e},deps:[[new Mk(VP),new Dk,new Lk]]},{provide:UP,useValue:"USD"}],SO=function(){var e=ip(function e(t){np(this,e)});return e.\u0275fac=function(t){return new(t||e)(Ok(gO))},e.\u0275mod=ay({type:e}),e.\u0275inj=Pg({providers:EO}),e}(),PO=null;function OO(){return PO}var TO=new sk("DocumentToken"),IO=function(){var e=function(){function e(){np(this,e)}return ip(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Sg({factory:xO,token:e,providedIn:"platform"}),e}();function xO(){return Ok(RO)}var AO=new sk("Location Initialized"),RO=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this))._doc=e,r._init(),r}return ip(n,[{key:"_init",value:function(){this.location=window.location,this._history=window.history}},{key:"getBaseHrefFromDOM",value:function(){return OO().getBaseHref(this._doc)}},{key:"onPopState",value:function(e){var t=OO().getGlobalEventTarget(this._doc,"window");return t.addEventListener("popstate",e,!1),function(){return t.removeEventListener("popstate",e)}}},{key:"onHashChange",value:function(e){var t=OO().getGlobalEventTarget(this._doc,"window");return t.addEventListener("hashchange",e,!1),function(){return t.removeEventListener("hashchange",e)}}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(e){this.location.pathname=e}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}},{key:"pushState",value:function(e,t,n){NO()?this._history.pushState(e,t,n):this.location.hash=n}},{key:"replaceState",value:function(e,t,n){NO()?this._history.replaceState(e,t,n):this.location.hash=n}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"historyGo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._history.go(e)}},{key:"getState",value:function(){return this._history.state}}]),n}(IO);return e.\u0275fac=function(t){return new(t||e)(Ok(TO))},e.\u0275prov=Sg({factory:MO,token:e,providedIn:"platform"}),e}();function NO(){return!!window.history.pushState}function MO(){return new RO(Ok(TO))}function DO(e,t){if(0==e.length)return t;if(0==t.length)return e;var n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function LO(e){var t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function FO(e){return e&&"?"!==e[0]?"?"+e:e}var BO=function(){var e=function(){function e(){np(this,e)}return ip(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Sg({factory:VO,token:e,providedIn:"root"}),e}();function VO(e){var t=Ok(TO).location;return new zO(Ok(IO),t&&t.origin||"")}var UO=new sk("appBaseHref"),zO=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;if(np(this,n),(i=t.call(this))._platformLocation=e,i._removeListenerFns=[],null==r&&(r=i._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return i._baseHref=r,jv(i)}return ip(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(e){return DO(this._baseHref,e)}},{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._platformLocation.pathname+FO(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?"".concat(t).concat(n):t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+FO(r));this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+FO(r));this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(BO);return e.\u0275fac=function(t){return new(t||e)(Ok(IO),Ok(UO,8))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),HO=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this))._platformLocation=e,i._baseHref="",i._removeListenerFns=[],null!=r&&(i._baseHref=r),i}return ip(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){var e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}},{key:"prepareExternalUrl",value:function(e){var t=DO(this._baseHref,e);return t.length>0?"#"+t:t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+FO(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+FO(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(BO);return e.\u0275fac=function(t){return new(t||e)(Ok(IO),Ok(UO,8))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),GO=function(){var e=function(){function e(t,n){var r=this;np(this,e),this._subject=new dP,this._urlChangeListeners=[],this._platformStrategy=t;var i=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=LO($O(i)),this._platformStrategy.onPopState(function(e){r._subject.emit({url:r.path(!0),pop:!0,state:e.state,type:e.type})})}return ip(e,[{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(e))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(e+FO(t))}},{key:"normalize",value:function(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,$O(t)))}},{key:"prepareExternalUrl",value:function(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}},{key:"go",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+FO(t)),n)}},{key:"replaceState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+FO(t)),n)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformStrategy).historyGo)||void 0===t||t.call(e,n)}},{key:"onUrlChange",value:function(e){var t=this;this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(function(e){t._notifyUrlChangeListeners(e.url,e.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach(function(n){return n(e,t)})}},{key:"subscribe",value:function(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(BO),Ok(IO))},e.normalizeQueryParams=FO,e.joinWithSlash=DO,e.stripTrailingSlash=LO,e.\u0275prov=Sg({factory:qO,token:e,providedIn:"root"}),e}();function qO(){return new GO(Ok(BO),Ok(IO))}function $O(e){return e.replace(/\/index.html$/,"")}var WO=((WO=WO||{})[WO.Decimal=0]="Decimal",WO[WO.Percent=1]="Percent",WO[WO.Currency=2]="Currency",WO[WO.Scientific=3]="Scientific",WO),jO=((jO=jO||{})[jO.Zero=0]="Zero",jO[jO.One=1]="One",jO[jO.Two=2]="Two",jO[jO.Few=3]="Few",jO[jO.Many=4]="Many",jO[jO.Other=5]="Other",jO),ZO=((ZO=ZO||{})[ZO.Format=0]="Format",ZO[ZO.Standalone=1]="Standalone",ZO),YO=((YO=YO||{})[YO.Narrow=0]="Narrow",YO[YO.Abbreviated=1]="Abbreviated",YO[YO.Wide=2]="Wide",YO[YO.Short=3]="Short",YO),KO=((KO=KO||{})[KO.Short=0]="Short",KO[KO.Medium=1]="Medium",KO[KO.Long=2]="Long",KO[KO.Full=3]="Full",KO),JO=((JO=JO||{})[JO.Decimal=0]="Decimal",JO[JO.Group=1]="Group",JO[JO.List=2]="List",JO[JO.PercentSign=3]="PercentSign",JO[JO.PlusSign=4]="PlusSign",JO[JO.MinusSign=5]="MinusSign",JO[JO.Exponential=6]="Exponential",JO[JO.SuperscriptingExponent=7]="SuperscriptingExponent",JO[JO.PerMille=8]="PerMille",JO[JO.Infinity=9]="Infinity",JO[JO.NaN=10]="NaN",JO[JO.TimeSeparator=11]="TimeSeparator",JO[JO.CurrencyDecimal=12]="CurrencyDecimal",JO[JO.CurrencyGroup=13]="CurrencyGroup",JO);function QO(e,t){return iT(Hb(e)[$b.DateFormat],t)}function XO(e,t){return iT(Hb(e)[$b.TimeFormat],t)}function eT(e,t){return iT(Hb(e)[$b.DateTimeFormat],t)}function tT(e,t){var n=Hb(e),r=n[$b.NumberSymbols][t];if(void 0===r){if(t===JO.CurrencyDecimal)return n[$b.NumberSymbols][JO.Decimal];if(t===JO.CurrencyGroup)return n[$b.NumberSymbols][JO.Group]}return r}var nT=Gb;function rT(e){if(!e[$b.ExtraData])throw new Error('Missing extra locale data for the locale "'.concat(e[$b.LocaleId],'". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.'))}function iT(e,t){for(var n=t;n>-1;n--)if(void 0!==e[n])return e[n];throw new Error("Locale data API: locale data undefined")}function aT(e){var t=Fv(e.split(":"),2);return{hours:+t[0],minutes:+t[1]}}var oT=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,sT={},uT=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,cT=((cT=cT||{})[cT.Short=0]="Short",cT[cT.ShortGMT=1]="ShortGMT",cT[cT.Long=2]="Long",cT[cT.Extended=3]="Extended",cT),lT=((lT=lT||{})[lT.FullYear=0]="FullYear",lT[lT.Month=1]="Month",lT[lT.Date=2]="Date",lT[lT.Hours=3]="Hours",lT[lT.Minutes=4]="Minutes",lT[lT.Seconds=5]="Seconds",lT[lT.FractionalSeconds=6]="FractionalSeconds",lT[lT.Day=7]="Day",lT),hT=((hT=hT||{})[hT.DayPeriods=0]="DayPeriods",hT[hT.Days=1]="Days",hT[hT.Months=2]="Months",hT[hT.Eras=3]="Eras",hT);function fT(e,t,n,r){var i=function(e){if(ST(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){var t=Fv(e.split("-").map(function(e){return+e}),3),n=t[0],r=t[1],i=void 0===r?1:r,a=t[2];return dT(n,i-1,void 0===a?1:a)}var o,s=parseFloat(e);if(!isNaN(e-s))return new Date(s);if(o=e.match(oT))return function(e){var t=new Date(0),n=0,r=0,i=e[8]?t.setUTCFullYear:t.setFullYear,a=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),r=Number(e[9]+e[11])),i.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));var o=Number(e[4]||0)-n,s=Number(e[5]||0)-r,u=Number(e[6]||0),c=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return a.call(t,o,s,u,c),t}(o)}var u=new Date(e);if(!ST(u))throw new Error('Unable to convert "'.concat(e,'" into a date'));return u}(e);t=vT(n,t)||t;for(var a,o=[];t;){if(!(a=uT.exec(t))){o.push(t);break}var s=(o=o.concat(a.slice(1))).pop();if(!s)break;t=s}var u=i.getTimezoneOffset();r&&(u=ET(r,u),i=function(e,t,n){var r=e.getTimezoneOffset();return function(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,-1*(ET(t,r)-r))}(i,r));var c="";return o.forEach(function(e){var t=function(e){if(bT[e])return bT[e];var t;switch(e){case"G":case"GG":case"GGG":t=mT(hT.Eras,YO.Abbreviated);break;case"GGGG":t=mT(hT.Eras,YO.Wide);break;case"GGGGG":t=mT(hT.Eras,YO.Narrow);break;case"y":t=yT(lT.FullYear,1,0,!1,!0);break;case"yy":t=yT(lT.FullYear,2,0,!0,!0);break;case"yyy":t=yT(lT.FullYear,3,0,!1,!0);break;case"yyyy":t=yT(lT.FullYear,4,0,!1,!0);break;case"Y":t=CT(1);break;case"YY":t=CT(2,!0);break;case"YYY":t=CT(3);break;case"YYYY":t=CT(4);break;case"M":case"L":t=yT(lT.Month,1,1);break;case"MM":case"LL":t=yT(lT.Month,2,1);break;case"MMM":t=mT(hT.Months,YO.Abbreviated);break;case"MMMM":t=mT(hT.Months,YO.Wide);break;case"MMMMM":t=mT(hT.Months,YO.Narrow);break;case"LLL":t=mT(hT.Months,YO.Abbreviated,ZO.Standalone);break;case"LLLL":t=mT(hT.Months,YO.Wide,ZO.Standalone);break;case"LLLLL":t=mT(hT.Months,YO.Narrow,ZO.Standalone);break;case"w":t=wT(1);break;case"ww":t=wT(2);break;case"W":t=wT(1,!0);break;case"d":t=yT(lT.Date,1);break;case"dd":t=yT(lT.Date,2);break;case"c":case"cc":t=yT(lT.Day,1);break;case"ccc":t=mT(hT.Days,YO.Abbreviated,ZO.Standalone);break;case"cccc":t=mT(hT.Days,YO.Wide,ZO.Standalone);break;case"ccccc":t=mT(hT.Days,YO.Narrow,ZO.Standalone);break;case"cccccc":t=mT(hT.Days,YO.Short,ZO.Standalone);break;case"E":case"EE":case"EEE":t=mT(hT.Days,YO.Abbreviated);break;case"EEEE":t=mT(hT.Days,YO.Wide);break;case"EEEEE":t=mT(hT.Days,YO.Narrow);break;case"EEEEEE":t=mT(hT.Days,YO.Short);break;case"a":case"aa":case"aaa":t=mT(hT.DayPeriods,YO.Abbreviated);break;case"aaaa":t=mT(hT.DayPeriods,YO.Wide);break;case"aaaaa":t=mT(hT.DayPeriods,YO.Narrow);break;case"b":case"bb":case"bbb":t=mT(hT.DayPeriods,YO.Abbreviated,ZO.Standalone,!0);break;case"bbbb":t=mT(hT.DayPeriods,YO.Wide,ZO.Standalone,!0);break;case"bbbbb":t=mT(hT.DayPeriods,YO.Narrow,ZO.Standalone,!0);break;case"B":case"BB":case"BBB":t=mT(hT.DayPeriods,YO.Abbreviated,ZO.Format,!0);break;case"BBBB":t=mT(hT.DayPeriods,YO.Wide,ZO.Format,!0);break;case"BBBBB":t=mT(hT.DayPeriods,YO.Narrow,ZO.Format,!0);break;case"h":t=yT(lT.Hours,1,-12);break;case"hh":t=yT(lT.Hours,2,-12);break;case"H":t=yT(lT.Hours,1);break;case"HH":t=yT(lT.Hours,2);break;case"m":t=yT(lT.Minutes,1);break;case"mm":t=yT(lT.Minutes,2);break;case"s":t=yT(lT.Seconds,1);break;case"ss":t=yT(lT.Seconds,2);break;case"S":t=yT(lT.FractionalSeconds,1);break;case"SS":t=yT(lT.FractionalSeconds,2);break;case"SSS":t=yT(lT.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=kT(cT.Short);break;case"ZZZZZ":t=kT(cT.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=kT(cT.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=kT(cT.Long);break;default:return null}return bT[e]=t,t}(e);c+=t?t(i,n,u):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function dT(e,t,n){var r=new Date(0);return r.setFullYear(e,t,n),r.setHours(0,0,0),r}function vT(e,t){var n=function(e){return Hb(e)[$b.LocaleId]}(e);if(sT[n]=sT[n]||{},sT[n][t])return sT[n][t];var r="";switch(t){case"shortDate":r=QO(e,KO.Short);break;case"mediumDate":r=QO(e,KO.Medium);break;case"longDate":r=QO(e,KO.Long);break;case"fullDate":r=QO(e,KO.Full);break;case"shortTime":r=XO(e,KO.Short);break;case"mediumTime":r=XO(e,KO.Medium);break;case"longTime":r=XO(e,KO.Long);break;case"fullTime":r=XO(e,KO.Full);break;case"short":var i=vT(e,"shortTime"),a=vT(e,"shortDate");r=pT(eT(e,KO.Short),[i,a]);break;case"medium":var o=vT(e,"mediumTime"),s=vT(e,"mediumDate");r=pT(eT(e,KO.Medium),[o,s]);break;case"long":var u=vT(e,"longTime"),c=vT(e,"longDate");r=pT(eT(e,KO.Long),[u,c]);break;case"full":var l=vT(e,"fullTime"),h=vT(e,"fullDate");r=pT(eT(e,KO.Full),[l,h])}return r&&(sT[n][t]=r),r}function pT(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),e}function gT(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-",r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a="";(e<0||i&&e<=0)&&(i?e=1-e:(e=-e,a=n));for(var o=String(e);o.length<t;)o="0"+o;return r&&(o=o.substr(o.length-t)),a+o}function yT(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function(a,o){var s=function(e,t){switch(e){case lT.FullYear:return t.getFullYear();case lT.Month:return t.getMonth();case lT.Date:return t.getDate();case lT.Hours:return t.getHours();case lT.Minutes:return t.getMinutes();case lT.Seconds:return t.getSeconds();case lT.FractionalSeconds:return t.getMilliseconds();case lT.Day:return t.getDay();default:throw new Error('Unknown DateType value "'.concat(e,'".'))}}(e,a);if((n>0||s>-n)&&(s+=n),e===lT.Hours)0===s&&-12===n&&(s=12);else if(e===lT.FractionalSeconds)return function(e,t){return gT(e,3).substr(0,t)}(s,t);var u=tT(o,JO.MinusSign);return gT(s,t,u,r,i)}}function mT(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ZO.Format,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(i,a){return function(e,t,n,r,i,a){switch(n){case hT.Months:return function(e,t,n){var r=Hb(e),i=iT([r[$b.MonthsFormat],r[$b.MonthsStandalone]],t);return iT(i,n)}(t,i,r)[e.getMonth()];case hT.Days:return function(e,t,n){var r=Hb(e),i=iT([r[$b.DaysFormat],r[$b.DaysStandalone]],t);return iT(i,n)}(t,i,r)[e.getDay()];case hT.DayPeriods:var o=e.getHours(),s=e.getMinutes();if(a){var u=function(e){var t=Hb(e);return rT(t),(t[$b.ExtraData][2]||[]).map(function(e){return"string"==typeof e?aT(e):[aT(e[0]),aT(e[1])]})}(t),c=function(e,t,n){var r=Hb(e);rT(r);var i=iT([r[$b.ExtraData][0],r[$b.ExtraData][1]],t)||[];return iT(i,n)||[]}(t,i,r),l=u.findIndex(function(e){if(Array.isArray(e)){var t=Fv(e,2),n=t[0],r=t[1],i=o>=n.hours&&s>=n.minutes,a=o<r.hours||o===r.hours&&s<r.minutes;if(n.hours<r.hours){if(i&&a)return!0}else if(i||a)return!0}else if(e.hours===o&&e.minutes===s)return!0;return!1});if(-1!==l)return c[l]}return function(e,t,n){var r=Hb(e),i=iT([r[$b.DayPeriodsFormat],r[$b.DayPeriodsStandalone]],t);return iT(i,n)}(t,i,r)[o<12?0:1];case hT.Eras:return function(e,t){return iT(Hb(e)[$b.Eras],t)}(t,r)[e.getFullYear()<=0?0:1];default:throw new Error("unexpected translation type ".concat(n))}}(i,a,e,t,n,r)}}function kT(e){return function(t,n,r){var i=-1*r,a=tT(n,JO.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(e){case cT.Short:return(i>=0?"+":"")+gT(o,2,a)+gT(Math.abs(i%60),2,a);case cT.ShortGMT:return"GMT"+(i>=0?"+":"")+gT(o,1,a);case cT.Long:return"GMT"+(i>=0?"+":"")+gT(o,2,a)+":"+gT(Math.abs(i%60),2,a);case cT.Extended:return 0===r?"Z":(i>=0?"+":"")+gT(o,2,a)+":"+gT(Math.abs(i%60),2,a);default:throw new Error('Unknown zone width "'.concat(e,'"'))}}}function _T(e){return dT(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))}function wT(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){var i;if(t){var a=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,o=n.getDate();i=1+Math.floor((o+a)/7)}else{var s=_T(n),u=function(e){var t=dT(e,0,1).getDay();return dT(e,0,1+(t<=4?4:11)-t)}(s.getFullYear()),c=s.getTime()-u.getTime();i=1+Math.round(c/6048e5)}return gT(i,e,tT(r,JO.MinusSign))}}function CT(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){return gT(_T(n).getFullYear(),e,tT(r,JO.MinusSign),t)}}var bT={};function ET(e,t){e=e.replace(/:/g,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function ST(e){return e instanceof Date&&!isNaN(e.valueOf())}var PT=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function OT(e){var t=parseInt(e);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+e);return t}var TT=ip(function e(){np(this,e)}),IT=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this)).locale=e,r}return ip(n,[{key:"getPluralCategory",value:function(e,t){switch(nT(t||this.locale)(e)){case jO.Zero:return"zero";case jO.One:return"one";case jO.Two:return"two";case jO.Few:return"few";case jO.Many:return"many";default:return"other"}}}]),n}(TT);return e.\u0275fac=function(t){return new(t||e)(Ok(VP))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}();function xT(e,t){t=encodeURIComponent(t);var n,r=Xv(e.split(";"));try{for(r.s();!(n=r.n()).done;){var i=n.value,a=i.indexOf("="),o=Fv(-1==a?[i,""]:[i.slice(0,a),i.slice(a+1)],2),s=o[0],u=o[1];if(s.trim()===t)return decodeURIComponent(u)}}catch(c){r.e(c)}finally{r.f()}return null}var AT=function(){var e=function(){function e(t,n,r,i){np(this,e),this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=r,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}return ip(e,[{key:"klass",set:function(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}},{key:"ngClass",set:function(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(KC(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}},{key:"ngDoCheck",value:function(){if(this._iterableDiffer){var e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){var t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}},{key:"_applyKeyValueChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachChangedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachRemovedItem(function(e){e.previousValue&&t._toggleClass(e.key,!1)})}},{key:"_applyIterableChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){if("string"!=typeof e.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got ".concat(vg(e.item)));t._toggleClass(e.item,!0)}),e.forEachRemovedItem(function(e){return t._toggleClass(e.item,!1)})}},{key:"_applyClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!0)}):Object.keys(e).forEach(function(n){return t._toggleClass(n,!!e[n])}))}},{key:"_removeClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!1)}):Object.keys(e).forEach(function(e){return t._toggleClass(e,!1)}))}},{key:"_toggleClass",value:function(e,t){var n=this;(e=e.trim())&&e.split(/\s+/g).forEach(function(e){t?n._renderer.addClass(n._ngEl.nativeElement,e):n._renderer.removeClass(n._ngEl.nativeElement,e)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(bS),ub(SS),ub(iS),ub(sS))},e.\u0275dir=sy({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e}(),RT=function(){function e(t,n,r,i){np(this,e),this.$implicit=t,this.ngForOf=n,this.index=r,this.count=i}return ip(e,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),e}(),NT=function(){var e=function(){function e(t,n,r){np(this,e),this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}return ip(e,[{key:"ngForOf",set:function(e){this._ngForOf=e,this._ngForOfDirty=!0}},{key:"ngForTrackBy",get:function(){return this._trackByFn},set:function(e){this._trackByFn=e}},{key:"ngForTemplate",set:function(e){e&&(this._template=e)}},{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(n){throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'. NgFor only supports binding to Iterables such as Arrays."))}}if(this._differ){var t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}},{key:"_applyChanges",value:function(e){var t=this,n=[];e.forEachOperation(function(e,r,i){if(null==e.previousIndex){var a=t._viewContainer.createEmbeddedView(t._template,new RT(null,t._ngForOf,-1,-1),null===i?void 0:i),o=new MT(e,a);n.push(o)}else if(null==i)t._viewContainer.remove(null===r?void 0:r);else if(null!==r){var s=t._viewContainer.get(r);t._viewContainer.move(s,i);var u=new MT(e,s);n.push(u)}});for(var r=0;r<n.length;r++)this._perViewChange(n[r].view,n[r].record);for(var i=0,a=this._viewContainer.length;i<a;i++){var o=this._viewContainer.get(i);o.context.index=i,o.context.count=a,o.context.ngForOf=this._ngForOf}e.forEachIdentityChange(function(e){t._viewContainer.get(e.currentIndex).context.$implicit=e.item})}},{key:"_perViewChange",value:function(e,t){e.context.$implicit=t.item}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(zS),ub(DS),ub(bS))},e.\u0275dir=sy({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e}(),MT=ip(function e(t,n){np(this,e),this.record=t,this.view=n}),DT=function(){var e=function(){function e(t,n){np(this,e),this._viewContainer=t,this._context=new LT,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}return ip(e,[{key:"ngIf",set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}},{key:"ngIfThen",set:function(e){FT("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(e){FT("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}},{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(zS),ub(DS))},e.\u0275dir=sy({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e}(),LT=ip(function e(){np(this,e),this.$implicit=null,this.ngIf=null});function FT(e,t){if(t&&!t.createEmbeddedView)throw new Error("".concat(e," must be a TemplateRef, but received '").concat(vg(t),"'."))}function BT(e,t){return Error("InvalidPipeArgument: '".concat(t,"' for pipe '").concat(vg(e),"'"))}var VT=function(){var e=function(){function e(t){np(this,e),this.locale=t}return ip(e,[{key:"transform",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mediumDate",r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(null==t||""===t||t!=t)return null;try{return fT(t,n,i||this.locale,r)}catch(a){throw BT(e,a.message)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(VP,16))},e.\u0275pipe=uy({name:"date",type:e,pure:!0}),e}(),UT=function(){var e=function(){function e(t){np(this,e),this._locale=t}return ip(e,[{key:"transform",value:function(t,n,r){if(!function(e){return!(null==e||""===e||e!=e)}(t))return null;r=r||this._locale;try{return function(e,t,n){return function(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s="",u=!1;if(isFinite(e)){var c=function(e){var t,n,r,i,a,o=Math.abs(e)+"",s=0;for((n=o.indexOf("."))>-1&&(o=o.replace(".","")),(r=o.search(/e/i))>0?(n<0&&(n=r),n+=+o.slice(r+1),o=o.substring(0,r)):n<0&&(n=o.length),r=0;"0"===o.charAt(r);r++);if(r===(a=o.length))t=[0],n=1;else{for(a--;"0"===o.charAt(a);)a--;for(n-=r,t=[],i=0;r<=a;r++,i++)t[i]=Number(o.charAt(r))}return n>22&&(t=t.splice(0,21),s=n-1,n=1),{digits:t,exponent:s,integerLen:n}}(e);o&&(c=function(e){if(0===e.digits[0])return e;var t=e.digits.length-e.integerLen;return e.exponent?e.exponent+=2:(0===t?e.digits.push(0,0):1===t&&e.digits.push(0),e.integerLen+=2),e}(c));var l=t.minInt,h=t.minFrac,f=t.maxFrac;if(a){var d=a.match(PT);if(null===d)throw new Error("".concat(a," is not a valid digit info"));var v=d[1],p=d[3],g=d[5];null!=v&&(l=OT(v)),null!=p&&(h=OT(p)),null!=g?f=OT(g):null!=p&&h>f&&(f=h)}!function(e,t,n){if(t>n)throw new Error("The minimum number of digits after fraction (".concat(t,") is higher than the maximum (").concat(n,")."));var r=e.digits,i=r.length-e.integerLen,a=Math.min(Math.max(t,i),n),o=a+e.integerLen,s=r[o];if(o>0){r.splice(Math.max(e.integerLen,o));for(var u=o;u<r.length;u++)r[u]=0}else{i=Math.max(0,i),e.integerLen=1,r.length=Math.max(1,o=a+1),r[0]=0;for(var c=1;c<o;c++)r[c]=0}if(s>=5)if(o-1<0){for(var l=0;l>o;l--)r.unshift(0),e.integerLen++;r.unshift(1),e.integerLen++}else r[o-1]++;for(;i<Math.max(0,a);i++)r.push(0);var h=0!==a,f=t+e.integerLen,d=r.reduceRight(function(e,t,n,r){return r[n]=(t+=e)<10?t:t-10,h&&(0===r[n]&&n>=f?r.pop():h=!1),t>=10?1:0},0);d&&(r.unshift(d),e.integerLen++)}(c,h,f);var y=c.digits,m=c.integerLen,k=c.exponent,_=[];for(u=y.every(function(e){return!e});m<l;m++)y.unshift(0);for(;m<0;m++)y.unshift(0);m>0?_=y.splice(m,y.length):(_=y,y=[0]);var w=[];for(y.length>=t.lgSize&&w.unshift(y.splice(-t.lgSize,y.length).join(""));y.length>t.gSize;)w.unshift(y.splice(-t.gSize,y.length).join(""));y.length&&w.unshift(y.join("")),s=w.join(tT(n,r)),_.length&&(s+=tT(n,i)+_.join("")),k&&(s+=tT(n,JO.Exponential)+"+"+k)}else s=tT(n,JO.Infinity);return s=e<0&&!u?t.negPre+s+t.negSuf:t.posPre+s+t.posSuf}(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=e.split(";"),i=r[0],a=r[1],o=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],s=o[0],u=o[1]||"";n.posPre=s.substr(0,s.indexOf("#"));for(var c=0;c<u.length;c++){var l=u.charAt(c);"0"===l?n.minFrac=n.maxFrac=c+1:"#"===l?n.maxFrac=c+1:n.posSuf+=l}var h=s.split(",");if(n.gSize=h[1]?h[1].length:0,n.lgSize=h[2]||h[1]?(h[2]||h[1]).length:0,a){var f=i.length-n.posPre.length-n.posSuf.length,d=a.indexOf("#");n.negPre=a.substr(0,d).replace(/'/g,""),n.negSuf=a.substr(d+f).replace(/'/g,"")}else n.negPre=t+n.posPre,n.negSuf=n.posSuf;return n}(function(e,t){return Hb(e)[$b.NumberFormats][t]}(t,WO.Decimal),tT(t,JO.MinusSign)),t,JO.Group,JO.Decimal,n)}(function(e){if("string"==typeof e&&!isNaN(Number(e)-parseFloat(e)))return Number(e);if("number"!=typeof e)throw new Error("".concat(e," is not a number"));return e}(t),r,n)}catch(i){throw BT(e,i.message)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(VP,16))},e.\u0275pipe=uy({name:"number",type:e,pure:!0}),e}(),zT=function(){var e=ip(function e(){np(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ay({type:e}),e.\u0275inj=Pg({providers:[{provide:TT,useClass:IT}]}),e}(),HT=function(){var e=ip(function e(){np(this,e)});return e.\u0275prov=Sg({token:e,providedIn:"root",factory:function(){return new GT(Ok(TO),window)}}),e}(),GT=function(){function e(t,n){np(this,e),this.document=t,this.window=n,this.offset=function(){return[0,0]}}return ip(e,[{key:"setOffset",value:function(e){this.offset=Array.isArray(e)?function(){return e}:e}},{key:"getScrollPosition",value:function(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}},{key:"scrollToPosition",value:function(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}},{key:"scrollToAnchor",value:function(e){if(this.supportsScrolling()){var t=function(e,t){var n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow))for(var r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;i;){var a=i.shadowRoot;if(a){var o=a.getElementById(t)||a.querySelector('[name="'.concat(t,'"]'));if(o)return o}i=r.nextNode()}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}}},{key:"setHistoryScrollRestoration",value:function(e){if(this.supportScrollRestoration()){var t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}},{key:"scrollToElement",value:function(e){var t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}},{key:"attemptFocus",value:function(e){return e.focus(),this.document.activeElement===e}},{key:"supportScrollRestoration",value:function(){try{if(!this.supportsScrolling())return!1;var e=qT(this.window.history)||qT(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(t){return!1}}},{key:"supportsScrolling",value:function(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}]),e}();function qT(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}var $T,WT=ip(function e(){np(this,e)}),jT=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"onAndCancel",value:function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"remove",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getBaseHref",value:function(e){var t=(ZT=ZT||document.querySelector("base"))?ZT.getAttribute("href"):null;return null==t?null:function(e){($T=$T||document.createElement("a")).setAttribute("href",e);var t=$T.pathname;return"/"===t.charAt(0)?t:"/".concat(t)}(t)}},{key:"resetBaseElement",value:function(){ZT=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"getCookie",value:function(e){return xT(document.cookie,e)}}],[{key:"makeCurrent",value:function(){var e;e=new n,PO||(PO=e)}}]),n}(function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.apply(this,arguments)).supportsDOMEvents=!0,e}return ip(n)}(function(){return ip(function e(){np(this,e)})}())),ZT=null,YT=new sk("TRANSITION_ID"),KT=[{provide:xP,useFactory:function(e,t,n){return function(){n.get(AP).donePromise.then(function(){for(var n=OO(),r=t.querySelectorAll('style[ng-transition="'.concat(e,'"]')),i=0;i<r.length;i++)n.remove(r[i])})}},deps:[YT,TO,UC],multi:!0}],JT=function(){function e(){np(this,e)}return ip(e,[{key:"addToWindow",value:function(e){qg.getAngularTestability=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},qg.getAllAngularTestabilities=function(){return e.getAllTestabilities()},qg.getAllAngularRootElements=function(){return e.getAllRootElements()},qg.frameworkStabilizers||(qg.frameworkStabilizers=[]),qg.frameworkStabilizers.push(function(e){var t=qg.getAllAngularTestabilities(),n=t.length,r=!1,i=function(t){r=r||t,0==--n&&e(r)};t.forEach(function(e){e.whenStable(i)})})}},{key:"findTestabilityInTree",value:function(e,t,n){var r;return null==t?null:null!==(r=e.getTestability(t))&&void 0!==r?r:n?OO().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}],[{key:"init",value:function(){var t;t=new e,sO=t}}]),e}(),QT=function(){var e=function(){function e(){np(this,e)}return ip(e,[{key:"build",value:function(){return new XMLHttpRequest}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),XT=new sk("EventManagerPlugins"),eI=function(){var e=function(){function e(t,n){var r=this;np(this,e),this._zone=n,this._eventNameToPlugin=new Map,t.forEach(function(e){return e.manager=r}),this._plugins=t.slice().reverse()}return ip(e,[{key:"addEventListener",value:function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}},{key:"addGlobalEventListener",value:function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,r=0;r<n.length;r++){var i=n[r];if(i.supports(e))return this._eventNameToPlugin.set(e,i),i}throw new Error("No event manager plugin found for event ".concat(e))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(XT),Ok(JP))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),tI=function(){function e(t){np(this,e),this._doc=t}return ip(e,[{key:"addGlobalEventListener",value:function(e,t,n){var r=OO().getGlobalEventTarget(this._doc,e);if(!r)throw new Error("Unsupported event target ".concat(r," for event ").concat(t));return this.addEventListener(r,t,n)}}]),e}(),nI=function(){var e=function(){function e(){np(this,e),this._stylesSet=new Set}return ip(e,[{key:"addStyles",value:function(e){var t=this,n=new Set;e.forEach(function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))}),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),rI=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this))._doc=e,r._hostNodes=new Map,r._hostNodes.set(e.head,[]),r}return ip(n,[{key:"_addStylesToHost",value:function(e,t,n){var r=this;e.forEach(function(e){var i=r._doc.createElement("style");i.textContent=e,n.push(t.appendChild(i))})}},{key:"addHost",value:function(e){var t=[];this._addStylesToHost(this._stylesSet,e,t),this._hostNodes.set(e,t)}},{key:"removeHost",value:function(e){var t=this._hostNodes.get(e);t&&t.forEach(iI),this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach(function(n,r){t._addStylesToHost(e,r,n)})}},{key:"ngOnDestroy",value:function(){this._hostNodes.forEach(function(e){return e.forEach(iI)})}}]),n}(nI);return e.\u0275fac=function(t){return new(t||e)(Ok(TO))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}();function iI(e){OO().remove(e)}var aI={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},oI=/%COMP%/g;function sI(e,t,n){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?sI(e,i,n):(i=i.replace(oI,e),n.push(i))}return n}function uI(e){return function(t){if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var cI=function(){var e=function(){function e(t,n,r){np(this,e),this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new lI(t)}return ip(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case Ug.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new hI(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case 1:case Ug.ShadowDom:return new fI(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var r=sI(t.id,t.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(eI),Ok(rI),Ok(RP))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),lI=function(){function e(t){np(this,e),this.eventManager=t,this.data=Object.create(null)}return ip(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(aI[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,n){e&&e.insertBefore(t,n)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(n.textContent=""),n}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,n,r){if(r){t=r+":"+t;var i=aI[r];i?e.setAttributeNS(i,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}},{key:"removeAttribute",value:function(e,t,n){if(n){var r=aI[n];r?e.removeAttributeNS(r,t):e.removeAttribute("".concat(n,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,n,r){r&(N_.DashCase|N_.Important)?e.style.setProperty(t,n,r&N_.Important?"important":""):e.style[t]=n}},{key:"removeStyle",value:function(e,t,n){n&N_.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,n){e[t]=n}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,uI(n)):this.eventManager.addEventListener(e,t,uI(n))}}]),e}(),hI=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a){var o;np(this,n),(o=t.call(this,e)).component=i;var s=sI(a+"-"+i.id,i.styles,[]);return r.addStyles(s),o.contentAttr="_ngcontent-%COMP%".replace(oI,a+"-"+i.id),o.hostAttr=function(e){return"_nghost-%COMP%".replace(oI,e)}(a+"-"+i.id),o}return ip(n,[{key:"applyToHost",value:function(e){Hv(Kv(n.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,t){var r=Hv(Kv(n.prototype),"createElement",this).call(this,e,t);return Hv(Kv(n.prototype),"setAttribute",this).call(this,r,this.contentAttr,""),r}}]),n}(lI),fI=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a){var o;np(this,n),(o=t.call(this,e)).sharedStylesHost=r,o.hostEl=i,o.shadowRoot=i.attachShadow({mode:"open"}),o.sharedStylesHost.addHost(o.shadowRoot);for(var s=sI(a.id,a.styles,[]),u=0;u<s.length;u++){var c=document.createElement("style");c.textContent=s[u],o.shadowRoot.appendChild(c)}return o}return ip(n,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,t){return Hv(Kv(n.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"insertBefore",value:function(e,t,r){return Hv(Kv(n.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),t,r)}},{key:"removeChild",value:function(e,t){return Hv(Kv(n.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(Hv(Kv(n.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),n}(lI),dI=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){return np(this,n),t.call(this,e)}return ip(n,[{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,n){var r=this;return e.addEventListener(t,n,!1),function(){return r.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){return e.removeEventListener(t,n)}}]),n}(tI);return e.\u0275fac=function(t){return new(t||e)(Ok(TO))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),vI=["alt","control","meta","shift"],pI={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},gI={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},yI={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},mI=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){return np(this,n),t.call(this,e)}return ip(n,[{key:"supports",value:function(e){return null!=n.parseEventName(e)}},{key:"addEventListener",value:function(e,t,r){var i=n.parseEventName(t),a=n.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(function(){return OO().onAndCancel(e,i.domEventName,a)})}}],[{key:"parseEventName",value:function(e){var t=e.toLowerCase().split("."),r=t.shift();if(0===t.length||"keydown"!==r&&"keyup"!==r)return null;var i=n._normalizeKey(t.pop()),a="";if(vI.forEach(function(e){var n=t.indexOf(e);n>-1&&(t.splice(n,1),a+=e+".")}),a+=i,0!=t.length||0===i.length)return null;var o={};return o.domEventName=r,o.fullKey=a,o}},{key:"getEventFullKey",value:function(e){var t="",n=function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&gI.hasOwnProperty(t)&&(t=gI[t]))}return pI[t]||t}(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),vI.forEach(function(r){r!=n&&yI[r](e)&&(t+=r+".")}),t+=n}},{key:"eventCallback",value:function(e,t,r){return function(i){n.getEventFullKey(i)===e&&r.runGuarded(function(){return t(i)})}}},{key:"_normalizeKey",value:function(e){switch(e){case"esc":return"escape";default:return e}}}]),n}(tI);return e.\u0275fac=function(t){return new(t||e)(Ok(TO))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),kI=function(){var e=ip(function e(){np(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Sg({factory:function(){return Ok(_I)},token:e,providedIn:"root"}),e}(),_I=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this))._doc=e,r}return ip(n,[{key:"sanitize",value:function(e,t){if(null==t)return null;switch(e){case m_.NONE:return t;case m_.HTML:return Wk(t,"HTML")?$k(t):g_(this._doc,String(t)).toString();case m_.STYLE:return Wk(t,"Style")?$k(t):t;case m_.SCRIPT:if(Wk(t,"Script"))return $k(t);throw new Error("unsafe value used in a script context");case m_.URL:return jk(t),Wk(t,"URL")?$k(t):Xk(String(t));case m_.RESOURCE_URL:if(Wk(t,"ResourceURL"))return $k(t);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext ".concat(e," (see https://g.co/ng/security#xss)"))}}},{key:"bypassSecurityTrustHtml",value:function(e){return function(e){return new Uk(e)}(e)}},{key:"bypassSecurityTrustStyle",value:function(e){return function(e){return new zk(e)}(e)}},{key:"bypassSecurityTrustScript",value:function(e){return function(e){return new Hk(e)}(e)}},{key:"bypassSecurityTrustUrl",value:function(e){return function(e){return new Gk(e)}(e)}},{key:"bypassSecurityTrustResourceUrl",value:function(e){return function(e){return new qk(e)}(e)}}]),n}(kI);return e.\u0275fac=function(t){return new(t||e)(Ok(TO))},e.\u0275prov=Sg({factory:function(){return function(e){return new _I(e.get(TO))}(Ok(PC))},token:e,providedIn:"root"}),e}(),wI=fO(bO,"browser",[{provide:LP,useValue:"browser"},{provide:DP,useValue:function(){jT.makeCurrent(),JT.init()},multi:!0},{provide:TO,useFactory:function(){return e=document,Py=e,document;var e},deps:[]}]),CI=[[],{provide:TC,useValue:"root"},{provide:O_,useFactory:function(){return new O_},deps:[]},{provide:XT,useClass:dI,multi:!0,deps:[TO,JP,LP]},{provide:XT,useClass:mI,multi:!0,deps:[TO]},[],{provide:cI,useClass:cI,deps:[eI,rI,RP]},{provide:oS,useExisting:cI},{provide:nI,useExisting:rI},{provide:rI,useClass:rI,deps:[TO]},{provide:aO,useClass:aO,deps:[JP]},{provide:eI,useClass:eI,deps:[XT,JP]},{provide:WT,useClass:QT,deps:[]},[]],bI=function(){var e=function(){function e(t){if(np(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return ip(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:RP,useValue:t.appId},{provide:YT,useExisting:RP},KT]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(e,12))},e.\u0275mod=ay({type:e}),e.\u0275inj=Pg({providers:CI,imports:[zT,SO]}),e}();"undefined"!=typeof window&&window;var EI=Array.isArray,SI=Object.getPrototypeOf,PI=Object.prototype,OI=Object.keys;function TI(e){if(1===e.length){var t=e[0];if(EI(t))return{args:t,keys:null};if(function(e){return e&&"object"==typeof e&&SI(e)===PI}(t)){var n=OI(t);return{args:n.map(function(e){return t[e]}),keys:n}}}return{args:e,keys:null}}var II=Array.isArray;function xI(e){return Fp(function(t){return function(e,t){return II(t)?e.apply(void 0,Jv(t)):e(t)}(e,t)})}function AI(e,t){return e.reduce(function(e,n,r){return e[n]=t[r],e},{})}var RI=function(){var e=function(){function e(t,n){np(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return ip(e,[{key:"setProperty",value:function(e,t){this._renderer.setProperty(this._elementRef.nativeElement,e,t)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"setDisabledState",value:function(e){this.setProperty("disabled",e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(sS),ub(iS))},e.\u0275dir=sy({type:e}),e}(),NI=function(){var e,t=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n)}(RI);return t.\u0275fac=function(n){return(e||(e=nk(t)))(n||t)},t.\u0275dir=sy({type:t,features:[HC]}),t}(),MI=new sk("NgValueAccessor"),DI={provide:MI,useExisting:yg(function(){return FI}),multi:!0},LI=new sk("CompositionEventMode"),FI=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,e,r))._compositionMode=i,a._composing=!1,null==a._compositionMode&&(a._compositionMode=!function(){var e=OO()?OO().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}()),a}return ip(n,[{key:"writeValue",value:function(e){this.setProperty("value",null!=e?e:"")}},{key:"_handleInput",value:function(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}]),n}(RI);return e.\u0275fac=function(t){return new(t||e)(ub(sS),ub(iS),ub(LI,8))},e.\u0275dir=sy({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&kb("input",function(e){return t._handleInput(e.target.value)})("blur",function(){return t.onTouched()})("compositionstart",function(){return t._compositionStart()})("compositionend",function(e){return t._compositionEnd(e.target.value)})},features:[JE([DI]),HC]}),e}();function BI(e){return null==e||0===e.length}function VI(e){return null!=e&&"number"==typeof e.length}var UI=new sk("NgValidators"),zI=new sk("NgAsyncValidators"),HI=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,GI=function(){function e(){np(this,e)}return ip(e,null,[{key:"min",value:function(e){return function(e){return function(t){if(BI(t.value)||BI(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n<e?{min:{min:e,actual:t.value}}:null}}(e)}},{key:"max",value:function(e){return function(e){return function(t){if(BI(t.value)||BI(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n>e?{max:{max:e,actual:t.value}}:null}}(e)}},{key:"required",value:function(e){return qI(e)}},{key:"requiredTrue",value:function(e){return function(e){return!0===e.value?null:{required:!0}}(e)}},{key:"email",value:function(e){return function(e){return BI(e.value)||HI.test(e.value)?null:{email:!0}}(e)}},{key:"minLength",value:function(e){return function(e){return function(t){return BI(t.value)||!VI(t.value)?null:t.value.length<e?{minlength:{requiredLength:e,actualLength:t.value.length}}:null}}(e)}},{key:"maxLength",value:function(e){return $I(e)}},{key:"pattern",value:function(e){return function(e){return e?("string"==typeof e?(n="","^"!==e.charAt(0)&&(n+="^"),n+=e,"$"!==e.charAt(e.length-1)&&(n+="$"),t=new RegExp(n)):(n=e.toString(),t=e),function(e){if(BI(e.value))return null;var r=e.value;return t.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}):WI;var t,n}(e)}},{key:"nullValidator",value:function(e){return null}},{key:"compose",value:function(e){return QI(e)}},{key:"composeAsync",value:function(e){return ex(e)}}]),e}();function qI(e){return BI(e.value)?{required:!0}:null}function $I(e){return function(t){return VI(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null}}function WI(e){return null}function jI(e){return null!=e}function ZI(e){var t=yb(e)?cg(e):e;return mb(t),t}function YI(e){var t={};return e.forEach(function(e){t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function KI(e,t){return t.map(function(t){return t(e)})}function JI(e){return e.map(function(e){return function(e){return!e.validate}(e)?e:function(t){return e.validate(t)}})}function QI(e){if(!e)return null;var t=e.filter(jI);return 0==t.length?null:function(e){return YI(KI(e,t))}}function XI(e){return null!=e?QI(JI(e)):null}function ex(e){if(!e)return null;var t=e.filter(jI);return 0==t.length?null:function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=ig(t),i=TI(t),a=i.args,o=i.keys,s=new Ip(function(e){var t=a.length;if(t)for(var n=new Array(t),r=t,i=t,s=function(t){var s=!1;Jp(a[t]).subscribe(new Lp(e,function(e){s||(s=!0,i--),n[t]=e},function(){return r--},void 0,function(){(!r||!s)&&(i||e.next(o?AI(o,n):n),e.complete())}))},u=0;u<t;u++)s(u);else e.complete()});return r?s.pipe(xI(r)):s}(KI(e,t).map(ZI)).pipe(Fp(YI))}}function tx(e){return null!=e?ex(JI(e)):null}function nx(e,t){return null===e?[t]:Array.isArray(e)?[].concat(Jv(e),[t]):[e,t]}function rx(e){return e._rawValidators}function ix(e){return e._rawAsyncValidators}function ax(e){return e?Array.isArray(e)?e:[e]:[]}function ox(e,t){return Array.isArray(e)?e.includes(t):e===t}function sx(e,t){var n=ax(t);return ax(e).forEach(function(e){ox(n,e)||n.push(e)}),n}function ux(e,t){return ax(t).filter(function(t){return!ox(e,t)})}var cx=function(){var e=function(){function e(){np(this,e),this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}return ip(e,[{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}},{key:"_setValidators",value:function(e){this._rawValidators=e||[],this._composedValidatorFn=XI(this._rawValidators)}},{key:"_setAsyncValidators",value:function(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=tx(this._rawAsyncValidators)}},{key:"validator",get:function(){return this._composedValidatorFn||null}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn||null}},{key:"_registerOnDestroy",value:function(e){this._onDestroyCallbacks.push(e)}},{key:"_invokeOnDestroyCallbacks",value:function(){this._onDestroyCallbacks.forEach(function(e){return e()}),this._onDestroyCallbacks=[]}},{key:"reset",value:function(e){this.control&&this.control.reset(e)}},{key:"hasError",value:function(e,t){return!!this.control&&this.control.hasError(e,t)}},{key:"getError",value:function(e,t){return this.control?this.control.getError(e,t):null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=sy({type:e}),e}(),lx=function(){var e,t=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),n}(cx);return t.\u0275fac=function(n){return(e||(e=nk(t)))(n||t)},t.\u0275dir=sy({type:t,features:[HC]}),t}(),hx=function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.apply(this,arguments))._parent=null,e.name=null,e.valueAccessor=null,e}return ip(n)}(cx),fx=function(){function e(t){np(this,e),this._cd=t}return ip(e,[{key:"is",value:function(e){var t,n,r;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(r=null===(n=this._cd)||void 0===n?void 0:n.control)||void 0===r?void 0:r[e])}}]),e}(),dx=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){return np(this,n),t.call(this,e)}return ip(n)}(fx);return e.\u0275fac=function(t){return new(t||e)(ub(hx,2))},e.\u0275dir=sy({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&Tb("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[HC]}),e}(),vx=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){return np(this,n),t.call(this,e)}return ip(n)}(fx);return e.\u0275fac=function(t){return new(t||e)(ub(lx,10))},e.\u0275dir=sy({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,t){2&e&&Tb("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))("ng-submitted",t.is("submitted"))},features:[HC]}),e}();function px(e,t){return[].concat(Jv(t.path),[e])}function gx(e,t){kx(e,t),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(function(n){e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&wx(e,t)})}(e,t),function(e,t){var n=function(e,n){t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)};e.registerOnChange(n),t._registerOnDestroy(function(){e._unregisterOnChange(n)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(function(){e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&wx(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function(e,t){if(t.valueAccessor.setDisabledState){var n=function(e){t.valueAccessor.setDisabledState(e)};e.registerOnDisabledChange(n),t._registerOnDestroy(function(){e._unregisterOnDisabledChange(n)})}}(e,t)}function yx(e,t){var n=function(){};t.valueAccessor&&(t.valueAccessor.registerOnChange(n),t.valueAccessor.registerOnTouched(n)),_x(e,t),e&&(t._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(function(){}))}function mx(e,t){e.forEach(function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function kx(e,t){var n=rx(e);null!==t.validator?e.setValidators(nx(n,t.validator)):"function"==typeof n&&e.setValidators([n]);var r=ix(e);null!==t.asyncValidator?e.setAsyncValidators(nx(r,t.asyncValidator)):"function"==typeof r&&e.setAsyncValidators([r]);var i=function(){return e.updateValueAndValidity()};mx(t._rawValidators,i),mx(t._rawAsyncValidators,i)}function _x(e,t){var n=!1;if(null!==e){if(null!==t.validator){var r=rx(e);if(Array.isArray(r)&&r.length>0){var i=r.filter(function(e){return e!==t.validator});i.length!==r.length&&(n=!0,e.setValidators(i))}}if(null!==t.asyncValidator){var a=ix(e);if(Array.isArray(a)&&a.length>0){var o=a.filter(function(e){return e!==t.asyncValidator});o.length!==a.length&&(n=!0,e.setAsyncValidators(o))}}}var s=function(){};return mx(t._rawValidators,s),mx(t._rawAsyncValidators,s),n}function wx(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function Cx(e,t){kx(e,t)}function bx(e,t){if(!e.hasOwnProperty("model"))return!1;var n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}function Ex(e,t){e._syncPendingControls(),t.forEach(function(e){var t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)})}function Sx(e,t){return t?(Array.isArray(t),t.forEach(function(e){e.constructor===FI?n=e:function(e){return Object.getPrototypeOf(e.constructor)===NI}(e)?r=e:i=e}),i||r||n||null):null;var n,r,i}function Px(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var Ox="VALID",Tx="INVALID",Ix="PENDING",xx="DISABLED";function Ax(e){return(Dx(e)?e.validators:e)||null}function Rx(e){return Array.isArray(e)?XI(e):e||null}function Nx(e,t){return(Dx(t)?t.asyncValidators:e)||null}function Mx(e){return Array.isArray(e)?tx(e):e||null}function Dx(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var Lx=function(){function e(t,n){np(this,e),this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=function(){},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=n,this._composedValidatorFn=Rx(this._rawValidators),this._composedAsyncValidatorFn=Mx(this._rawAsyncValidators)}return ip(e,[{key:"validator",get:function(){return this._composedValidatorFn},set:function(e){this._rawValidators=this._composedValidatorFn=e}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn},set:function(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return this.status===Ox}},{key:"invalid",get:function(){return this.status===Tx}},{key:"pending",get:function(){return this.status==Ix}},{key:"disabled",get:function(){return this.status===xx}},{key:"enabled",get:function(){return this.status!==xx}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"setValidators",value:function(e){this._rawValidators=e,this._composedValidatorFn=Rx(e)}},{key:"setAsyncValidators",value:function(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=Mx(e)}},{key:"addValidators",value:function(e){this.setValidators(sx(e,this._rawValidators))}},{key:"addAsyncValidators",value:function(e){this.setAsyncValidators(sx(e,this._rawAsyncValidators))}},{key:"removeValidators",value:function(e){this.setValidators(ux(e,this._rawValidators))}},{key:"removeAsyncValidators",value:function(e){this.setAsyncValidators(ux(e,this._rawAsyncValidators))}},{key:"hasValidator",value:function(e){return ox(this._rawValidators,e)}},{key:"hasAsyncValidator",value:function(e){return ox(this._rawAsyncValidators,e)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild(function(e){return e.markAllAsTouched()})}},{key:"markAsUntouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild(function(e){e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"markAsDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}},{key:"markAsPristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild(function(e){e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"markAsPending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status=Ix,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}},{key:"disable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=xx,this.errors=null,this._forEachChild(function(t){t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!0)})}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=Ox,this._forEachChild(function(t){t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!1)})}},{key:"_updateAncestors",value:function(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(e){this._parent=e}},{key:"updateValueAndValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ox||this.status===Ix)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}},{key:"_updateTreeValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild(function(t){return t._updateTreeValidity(e)}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?xx:Ox}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(e){var t=this;if(this.asyncValidator){this.status=Ix,this._hasOwnPendingAsyncValidator=!0;var n=ZI(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(function(n){t._hasOwnPendingAsyncValidator=!1,t.setErrors(n,{emitEvent:e})})}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}},{key:"setErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}},{key:"get",value:function(e){return function(e,t,n){if(null==t||(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length))return null;var r=e;return t.forEach(function(e){r=r instanceof Bx?r.controls.hasOwnProperty(e)?r.controls[e]:null:r instanceof Vx&&r.at(e)||null}),r}(this,e)}},{key:"getError",value:function(e,t){var n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}},{key:"hasError",value:function(e,t){return!!this.getError(e,t)}},{key:"root",get:function(){for(var e=this;e._parent;)e=e._parent;return e}},{key:"_updateControlsErrors",value:function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}},{key:"_initObservables",value:function(){this.valueChanges=new dP,this.statusChanges=new dP}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?xx:this.errors?Tx:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ix)?Ix:this._anyControlsHaveStatus(Tx)?Tx:Ox}},{key:"_anyControlsHaveStatus",value:function(e){return this._anyControls(function(t){return t.status===e})}},{key:"_anyControlsDirty",value:function(){return this._anyControls(function(e){return e.dirty})}},{key:"_anyControlsTouched",value:function(){return this._anyControls(function(e){return e.touched})}},{key:"_updatePristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"_updateTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"_isBoxedValue",value:function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}},{key:"_registerOnCollectionChange",value:function(e){this._onCollectionChange=e}},{key:"_setUpdateStrategy",value:function(e){Dx(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}},{key:"_parentMarkedDirty",value:function(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}]),e}(),Fx=function(e){qv(n,e);var t=Wv(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return np(this,n),(e=t.call(this,Ax(i),Nx(a,i)))._onChange=[],e._applyFormState(r),e._setUpdateStrategy(i),e._initObservables(),e.updateValueAndValidity({onlySelf:!0,emitEvent:!!e.asyncValidator}),e}return ip(n,[{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(function(e){return e(t.value,!1!==n.emitViewToModelChange)}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(e,t)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(e){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(e){this._onChange.push(e)}},{key:"_unregisterOnChange",value:function(e){Px(this._onChange,e)}},{key:"registerOnDisabledChange",value:function(e){this._onDisabledChange.push(e)}},{key:"_unregisterOnDisabledChange",value:function(e){Px(this._onDisabledChange,e)}},{key:"_forEachChild",value:function(e){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}]),n}(Lx),Bx=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,Ax(r),Nx(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return ip(n,[{key:"registerControl",value:function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}},{key:"addControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"removeControl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"contains",value:function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),Object.keys(e).forEach(function(r){t._throwIfControlMissing(r),t.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(Object.keys(e).forEach(function(r){t.controls[r]&&t.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this._reduceChildren({},function(e,t,n){return e[n]=t instanceof Fx?t.value:t.getRawValue(),e})}},{key:"_syncPendingControls",value:function(){var e=this._reduceChildren(!1,function(e,t){return!!t._syncPendingControls()||e});return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: ".concat(e,"."))}},{key:"_forEachChild",value:function(e){var t=this;Object.keys(this.controls).forEach(function(n){var r=t.controls[n];r&&e(r,n)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)})}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(e){for(var t=0,n=Object.keys(this.controls);t<n.length;t++){var r=n[t],i=this.controls[r];if(this.contains(r)&&e(i))return!0}return!1}},{key:"_reduceValue",value:function(){var e=this;return this._reduceChildren({},function(t,n,r){return(n.enabled||e.disabled)&&(t[r]=n.value),t})}},{key:"_reduceChildren",value:function(e,t){var n=e;return this._forEachChild(function(e,r){n=t(n,e,r)}),n}},{key:"_allControlsDisabled",value:function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++){var n=t[e];if(this.controls[n].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control with name: '".concat(n,"'."))})}}]),n}(Lx),Vx=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,Ax(r),Nx(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return ip(n,[{key:"at",value:function(e){return this.controls[e]}},{key:"push",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"insert",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}},{key:"removeAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"length",get:function(){return this.controls.length}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),e.forEach(function(e,r){t._throwIfControlMissing(r),t.at(r).setValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(e.forEach(function(e,r){t.at(r)&&t.at(r).patchValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this.controls.map(function(e){return e instanceof Fx?e.value:e.getRawValue()})}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.controls.length<1||(this._forEachChild(function(e){return e._registerOnCollectionChange(function(){})}),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}},{key:"_syncPendingControls",value:function(){var e=this.controls.reduce(function(e,t){return!!t._syncPendingControls()||e},!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index ".concat(e))}},{key:"_forEachChild",value:function(e){this.controls.forEach(function(t,n){e(t,n)})}},{key:"_updateValue",value:function(){var e=this;this.value=this.controls.filter(function(t){return t.enabled||e.disabled}).map(function(e){return e.value})}},{key:"_anyControls",value:function(e){return this.controls.some(function(t){return t.enabled&&e(t)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){return e._registerControl(t)})}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control at index: ".concat(n,"."))})}},{key:"_allControlsDisabled",value:function(){var e,t=Xv(this.controls);try{for(t.s();!(e=t.n()).done;){if(e.value.enabled)return!1}}catch(n){t.e(n)}finally{t.f()}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}]),n}(Lx),Ux={provide:lx,useExisting:yg(function(){return Hx})},zx=Promise.resolve(null),Hx=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this)).submitted=!1,i._directives=[],i.ngSubmit=new dP,i.form=new Bx({},XI(e),tx(r)),i}return ip(n,[{key:"ngAfterViewInit",value:function(){this._setUpdateStrategy()}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"controls",get:function(){return this.form.controls}},{key:"addControl",value:function(e){var t=this;zx.then(function(){var n=t._findContainer(e.path);e.control=n.registerControl(e.name,e.control),gx(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),t._directives.push(e)})}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){var t=this;zx.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name),Px(t._directives,e)})}},{key:"addFormGroup",value:function(e){var t=this;zx.then(function(){var n=t._findContainer(e.path),r=new Bx({});Cx(r,e),n.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}},{key:"removeFormGroup",value:function(e){var t=this;zx.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name)})}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){var n=this;zx.then(function(){n.form.get(e.path).setValue(t)})}},{key:"setValue",value:function(e){this.control.setValue(e)}},{key:"onSubmit",value:function(e){return this.submitted=!0,Ex(this.form,this._directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}},{key:"_findContainer",value:function(e){return e.pop(),e.length?this.form.get(e):this.form}}]),n}(lx);return e.\u0275fac=function(t){return new(t||e)(ub(UI,10),ub(zI,10))},e.\u0275dir=sy({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&kb("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[JE([Ux]),HC]}),e}(),Gx={provide:hx,useExisting:yg(function(){return $x})},qx=Promise.resolve(null),$x=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a){var o;return np(this,n),(o=t.call(this)).control=new Fx,o._registered=!1,o.update=new dP,o._parent=e,o._setValidators(r),o._setAsyncValidators(i),o.valueAccessor=Sx(0,a),o}return ip(n,[{key:"ngOnChanges",value:function(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),bx(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"path",get:function(){return this._parent?px(this.name,this._parent):[this.name]}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"_setUpControl",value:function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}},{key:"_isStandalone",value:function(){return!this._parent||!(!this.options||!this.options.standalone)}},{key:"_setUpStandalone",value:function(){gx(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}},{key:"_checkForErrors",value:function(){this._isStandalone()||this._checkParentType(),this._checkName()}},{key:"_checkParentType",value:function(){}},{key:"_checkName",value:function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}},{key:"_updateValue",value:function(e){var t=this;qx.then(function(){t.control.setValue(e,{emitViewToModelChange:!1})})}},{key:"_updateDisabled",value:function(e){var t=this,n=e.isDisabled.currentValue,r=""===n||n&&"false"!==n;qx.then(function(){r&&!t.control.disabled?t.control.disable():!r&&t.control.disabled&&t.control.enable()})}}]),n}(hx);return e.\u0275fac=function(t){return new(t||e)(ub(lx,9),ub(UI,10),ub(zI,10),ub(MI,10))},e.\u0275dir=sy({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[JE([Gx]),HC,_y]}),e}(),Wx=function(){var e=ip(function e(){np(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=sy({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e}(),jx=function(){var e=ip(function e(){np(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ay({type:e}),e.\u0275inj=Pg({}),e}(),Zx={provide:MI,useExisting:yg(function(){return Yx}),multi:!0},Yx=function(){var e,t=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"writeValue",value:function(e){this.setProperty("value",parseFloat(e))}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}}]),n}(NI);return t.\u0275fac=function(n){return(e||(e=nk(t)))(n||t)},t.\u0275dir=sy({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&kb("change",function(e){return t.onChange(e.target.value)})("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[JE([Zx]),HC]}),t}(),Kx=new sk("NgModelWithFormControlWarning"),Jx={provide:lx,useExisting:yg(function(){return Qx})},Qx=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this)).validators=e,i.asyncValidators=r,i.submitted=!1,i._onCollectionChange=function(){return i._updateDomValue()},i.directives=[],i.form=null,i.ngSubmit=new dP,i._setValidators(e),i._setAsyncValidators(r),i}return ip(n,[{key:"ngOnChanges",value:function(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}},{key:"ngOnDestroy",value:function(){this.form&&(_x(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(function(){}))}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"addControl",value:function(e){var t=this.form.get(e.path);return gx(t,e),t.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),t}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){yx(e.control||null,e,!1),Px(this.directives,e)}},{key:"addFormGroup",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormGroup",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"addFormArray",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormArray",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormArray",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){this.form.get(e.path).setValue(t)}},{key:"onSubmit",value:function(e){return this.submitted=!0,Ex(this.form,this.directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_updateDomValue",value:function(){var e=this;this.directives.forEach(function(t){var n=t.control,r=e.form.get(t.path);n!==r&&(yx(n||null,t),r instanceof Fx&&(gx(r,t),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}},{key:"_setUpFormContainer",value:function(e){var t=this.form.get(e.path);Cx(t,e),t.updateValueAndValidity({emitEvent:!1})}},{key:"_cleanUpFormContainer",value:function(e){if(this.form){var t=this.form.get(e.path);t&&function(e,t){return _x(e,t)}(t,e)&&t.updateValueAndValidity({emitEvent:!1})}}},{key:"_updateRegistrations",value:function(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(function(){})}},{key:"_updateValidators",value:function(){kx(this.form,this),this._oldForm&&_x(this._oldForm,this)}},{key:"_checkFormPresent",value:function(){}}]),n}(lx);return e.\u0275fac=function(t){return new(t||e)(ub(UI,10),ub(zI,10))},e.\u0275dir=sy({type:e,selectors:[["","formGroup",""]],hostBindings:function(e,t){1&e&&kb("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[JE([Jx]),HC,_y]}),e}(),Xx={provide:hx,useExisting:yg(function(){return eA})},eA=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o){var s;return np(this,n),(s=t.call(this))._ngModelWarningConfig=o,s._added=!1,s.update=new dP,s._ngModelWarningSent=!1,s._parent=e,s._setValidators(r),s._setAsyncValidators(i),s.valueAccessor=Sx(0,a),s}return ip(n,[{key:"isDisabled",set:function(e){}},{key:"ngOnChanges",value:function(e){this._added||this._setUpControl(),bx(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"path",get:function(){return px(null==this.name?this.name:this.name.toString(),this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"_checkParentType",value:function(){}},{key:"_setUpControl",value:function(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}]),n}(hx);return e.\u0275fac=function(t){return new(t||e)(ub(lx,13),ub(UI,10),ub(zI,10),ub(MI,10),ub(Kx,8))},e.\u0275dir=sy({type:e,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[JE([Xx]),HC,_y]}),e._ngModelWarningSentOnce=!1,e}(),tA={provide:MI,useExisting:yg(function(){return rA}),multi:!0};function nA(e,t){return null==e?"".concat(t):(t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var rA=function(){var e,t=function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return ip(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){this.value=e;var t=this._getOptionId(e);null==t&&this.setProperty("selectedIndex",-1);var n=nA(t,e);this.setProperty("value",n)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){t.value=t._getOptionValue(n),e(t.value)}}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r),e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}]),n}(NI);return t.\u0275fac=function(n){return(e||(e=nk(t)))(n||t)},t.\u0275dir=sy({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&kb("change",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[JE([tA]),HC]}),t}(),iA=function(){var e=function(){function e(t,n,r){np(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}return ip(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(nA(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(iS),ub(sS),ub(rA,9))},e.\u0275dir=sy({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),aA={provide:MI,useExisting:yg(function(){return sA}),multi:!0};function oA(e,t){return null==e?"".concat(t):("string"==typeof t&&(t="'".concat(t,"'")),t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var sA=function(){var e,t=function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return ip(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){var t,n=this;if(this.value=e,Array.isArray(e)){var r=e.map(function(e){return n._getOptionId(e)});t=function(e,t){e._setSelected(r.indexOf(t.toString())>-1)}}else t=function(e,t){e._setSelected(!1)};this._optionMap.forEach(t)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){var r=[];if(void 0!==n.selectedOptions)for(var i=n.selectedOptions,a=0;a<i.length;a++){var o=i.item(a),s=t._getOptionValue(o.value);r.push(s)}else for(var u=n.options,c=0;c<u.length;c++){var l=u.item(c);if(l.selected){var h=t._getOptionValue(l.value);r.push(h)}}t.value=r,e(r)}}},{key:"_registerOption",value:function(e){var t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r)._value,e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}]),n}(NI);return t.\u0275fac=function(n){return(e||(e=nk(t)))(n||t)},t.\u0275dir=sy({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&kb("change",function(e){return t.onChange(e.target)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[JE([aA]),HC]}),t}(),uA=function(){var e=function(){function e(t,n,r){np(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}return ip(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._value=e,this._setElementValue(oA(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._select?(this._value=e,this._setElementValue(oA(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"_setSelected",value:function(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(iS),ub(sS),ub(sA,9))},e.\u0275dir=sy({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),cA={provide:UI,useExisting:yg(function(){return lA}),multi:!0},lA=function(){var e=function(){function e(){np(this,e),this._required=!1}return ip(e,[{key:"required",get:function(){return this._required},set:function(e){this._required=null!=e&&!1!==e&&"false"!="".concat(e),this._onChange&&this._onChange()}},{key:"validate",value:function(e){return this.required?qI(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=sy({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,t){2&e&&nb("required",t.required?"":null)},inputs:{required:"required"},features:[JE([cA])]}),e}(),hA={provide:UI,useExisting:yg(function(){return fA}),multi:!0},fA=function(){var e=function(){function e(){np(this,e),this._validator=WI}return ip(e,[{key:"ngOnChanges",value:function(e){"maxlength"in e&&(this._createValidator(),this._onChange&&this._onChange())}},{key:"validate",value:function(e){return this.enabled()?this._validator(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}},{key:"_createValidator",value:function(){this._validator=this.enabled()?$I(function(e){return"number"==typeof e?e:parseInt(e,10)}(this.maxlength)):WI}},{key:"enabled",value:function(){return null!=this.maxlength}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=sy({type:e,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,t){2&e&&nb("maxlength",t.enabled()?t.maxlength:null)},inputs:{maxlength:"maxlength"},features:[JE([hA]),_y]}),e}(),dA=function(){var e=ip(function e(){np(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ay({type:e}),e.\u0275inj=Pg({imports:[[jx]]}),e}(),vA=function(){var e=ip(function e(){np(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ay({type:e}),e.\u0275inj=Pg({imports:[dA]}),e}(),pA=function(){var e=function(){function e(){np(this,e)}return ip(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:[{provide:Kx,useValue:t.warnOnNgModelWithFormControl}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ay({type:e}),e.\u0275inj=Pg({imports:[dA]}),e}(),gA=function(){var e=function(){function e(){np(this,e)}return ip(e,[{key:"group",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this._reduceControls(e),i=null,a=null;return null!=n&&(function(e){return void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn}(n)?(i=null!=n.validators?n.validators:null,a=null!=n.asyncValidators?n.asyncValidators:null,t=null!=n.updateOn?n.updateOn:void 0):(i=null!=n.validator?n.validator:null,a=null!=n.asyncValidator?n.asyncValidator:null)),new Bx(r,{asyncValidators:a,updateOn:t,validators:i})}},{key:"control",value:function(e,t,n){return new Fx(e,t,n)}},{key:"array",value:function(e,t,n){var r=this,i=e.map(function(e){return r._createControl(e)});return new Vx(i,t,n)}},{key:"_reduceControls",value:function(e){var t=this,n={};return Object.keys(e).forEach(function(r){n[r]=t._createControl(e[r])}),n}},{key:"_createControl",value:function(e){return e instanceof Fx||e instanceof Bx||e instanceof Vx?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Sg({factory:function(){return new e},token:e,providedIn:pA}),e}();function yA(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return cg(t,ag(t))}function mA(e,t){return Yv(t)?eg(e,t,1):eg(e,1)}function kA(e,t){return Dp(function(n,r){var i=0;n.subscribe(new Lp(r,function(n){return e.call(t,n,i++)&&r.next(n)}))})}var _A=ip(function e(){np(this,e)}),wA=ip(function e(){np(this,e)}),CA=function(){function e(t){var n=this;np(this,e),this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?function(){n.headers=new Map,t.split("\n").forEach(function(e){var t=e.indexOf(":");if(t>0){var r=e.slice(0,t),i=r.toLowerCase(),a=e.slice(t+1).trim();n.maybeSetNormalizedName(r,i),n.headers.has(i)?n.headers.get(i).push(a):n.headers.set(i,[a])}})}:function(){n.headers=new Map,Object.keys(t).forEach(function(e){var r=t[e],i=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(n.headers.set(i,r),n.maybeSetNormalizedName(e,i))})}:this.headers=new Map}return ip(e,[{key:"has",value:function(e){return this.init(),this.headers.has(e.toLowerCase())}},{key:"get",value:function(e){this.init();var t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(e){return this.init(),this.headers.get(e.toLowerCase())||null}},{key:"append",value:function(e,t){return this.clone({name:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({name:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({name:e,value:t,op:"d"})}},{key:"maybeSetNormalizedName",value:function(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}},{key:"init",value:function(){var t=this;this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(function(e){return t.applyUpdate(e)}),this.lazyUpdate=null))}},{key:"copyFrom",value:function(e){var t=this;e.init(),Array.from(e.headers.keys()).forEach(function(n){t.headers.set(n,e.headers.get(n)),t.normalizedNames.set(n,e.normalizedNames.get(n))})}},{key:"clone",value:function(t){var n=new e;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}},{key:"applyUpdate",value:function(e){var t=e.name.toLowerCase();switch(e.op){case"a":case"s":var n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);var r=("a"===e.op?this.headers.get(t):void 0)||[];r.push.apply(r,Jv(n)),this.headers.set(t,r);break;case"d":var i=e.value;if(i){var a=this.headers.get(t);if(!a)return;0===(a=a.filter(function(e){return-1===i.indexOf(e)})).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}else this.headers.delete(t),this.normalizedNames.delete(t)}}},{key:"forEach",value:function(e){var t=this;this.init(),Array.from(this.normalizedNames.keys()).forEach(function(n){return e(t.normalizedNames.get(n),t.headers.get(n))})}}]),e}(),bA=function(){function e(){np(this,e)}return ip(e,[{key:"encodeKey",value:function(e){return PA(e)}},{key:"encodeValue",value:function(e){return PA(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}(),EA=/%(\d[a-f0-9])/gi,SA={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function PA(e){return encodeURIComponent(e).replace(EA,function(e,t){var n;return null!==(n=SA[t])&&void 0!==n?n:e})}function OA(e){return"".concat(e)}var TA=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(np(this,e),this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new bA,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){var n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(function(e){var r=e.indexOf("="),i=Fv(-1==r?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,r)),t.decodeValue(e.slice(r+1))],2),a=i[0],o=i[1],s=n.get(a)||[];s.push(o),n.set(a,s)}),n}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(function(e){var r=n.fromObject[e];t.map.set(e,Array.isArray(r)?r:[r])})):this.map=null}return ip(e,[{key:"has",value:function(e){return this.init(),this.map.has(e)}},{key:"get",value:function(e){this.init();var t=this.map.get(e);return t?t[0]:null}},{key:"getAll",value:function(e){return this.init(),this.map.get(e)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(e,t){return this.clone({param:e,value:t,op:"a"})}},{key:"appendAll",value:function(e){var t=[];return Object.keys(e).forEach(function(n){var r=e[n];Array.isArray(r)?r.forEach(function(e){t.push({param:n,value:e,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}},{key:"set",value:function(e,t){return this.clone({param:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({param:e,value:t,op:"d"})}},{key:"toString",value:function(){var e=this;return this.init(),this.keys().map(function(t){var n=e.encoder.encodeKey(t);return e.map.get(t).map(function(t){return n+"="+e.encoder.encodeValue(t)}).join("&")}).filter(function(e){return""!==e}).join("&")}},{key:"clone",value:function(t){var n=new e({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(t),n}},{key:"init",value:function(){var e=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(function(t){return e.map.set(t,e.cloneFrom.map.get(t))}),this.updates.forEach(function(t){switch(t.op){case"a":case"s":var n=("a"===t.op?e.map.get(t.param):void 0)||[];n.push(OA(t.value)),e.map.set(t.param,n);break;case"d":if(void 0===t.value){e.map.delete(t.param);break}var r=e.map.get(t.param)||[],i=r.indexOf(OA(t.value));-1!==i&&r.splice(i,1),r.length>0?e.map.set(t.param,r):e.map.delete(t.param)}}),this.cloneFrom=this.updates=null)}}]),e}(),IA=function(){function e(){np(this,e),this.map=new Map}return ip(e,[{key:"set",value:function(e,t){return this.map.set(e,t),this}},{key:"get",value:function(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}},{key:"delete",value:function(e){return this.map.delete(e),this}},{key:"keys",value:function(){return this.map.keys()}}]),e}();function xA(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function AA(e){return"undefined"!=typeof Blob&&e instanceof Blob}function RA(e){return"undefined"!=typeof FormData&&e instanceof FormData}var NA=function(){function e(t,n,r,i){var a;if(np(this,e),this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,a=i):a=r,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params)),this.headers||(this.headers=new CA),this.context||(this.context=new IA),this.params){var o=this.params.toString();if(0===o.length)this.urlWithParams=n;else{var s=n.indexOf("?");this.urlWithParams=n+(-1===s?"?":s<n.length-1?"&":"")+o}}else this.params=new TA,this.urlWithParams=n}return ip(e,[{key:"serializeBody",value:function(){return null===this.body?null:xA(this.body)||AA(this.body)||RA(this.body)||"undefined"!=typeof URLSearchParams&&this.body instanceof URLSearchParams||"string"==typeof this.body?this.body:this.body instanceof TA?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body||RA(this.body)?null:AA(this.body)?this.body.type||null:xA(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof TA?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}},{key:"clone",value:function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.method||this.method,i=n.url||this.url,a=n.responseType||this.responseType,o=void 0!==n.body?n.body:this.body,s=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,u=void 0!==n.reportProgress?n.reportProgress:this.reportProgress,c=n.headers||this.headers,l=n.params||this.params,h=null!==(t=n.context)&&void 0!==t?t:this.context;return void 0!==n.setHeaders&&(c=Object.keys(n.setHeaders).reduce(function(e,t){return e.set(t,n.setHeaders[t])},c)),n.setParams&&(l=Object.keys(n.setParams).reduce(function(e,t){return e.set(t,n.setParams[t])},l)),new e(r,i,o,{params:l,headers:c,context:h,reportProgress:u,responseType:a,withCredentials:s})}}]),e}(),MA=((MA=MA||{})[MA.Sent=0]="Sent",MA[MA.UploadProgress=1]="UploadProgress",MA[MA.ResponseHeader=2]="ResponseHeader",MA[MA.DownloadProgress=3]="DownloadProgress",MA[MA.Response=4]="Response",MA[MA.User=5]="User",MA),DA=ip(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";np(this,e),this.headers=t.headers||new CA,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}),LA=function(e){qv(n,e);var t=Wv(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return np(this,n),(e=t.call(this,r)).type=MA.ResponseHeader,e}return ip(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(DA),FA=function(e){qv(n,e);var t=Wv(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return np(this,n),(e=t.call(this,r)).type=MA.Response,e.body=void 0!==r.body?r.body:null,e}return ip(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(DA),BA=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e,0,"Unknown Error")).name="HttpErrorResponse",r.ok=!1,r.message=r.status>=200&&r.status<300?"Http failure during parsing for ".concat(e.url||"(unknown url)"):"Http failure response for ".concat(e.url||"(unknown url)",": ").concat(e.status," ").concat(e.statusText),r.error=e.error||null,r}return ip(n)}(DA);function VA(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}var UA=function(){var e=function(){function e(t){np(this,e),this.handler=t}return ip(e,[{key:"request",value:function(e,t){var n,r,i,a=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e instanceof NA?n=e:(r=o.headers instanceof CA?o.headers:new CA(o.headers),o.params&&(i=o.params instanceof TA?o.params:new TA({fromObject:o.params})),n=new NA(e,t,void 0!==o.body?o.body:null,{headers:r,context:o.context,params:i,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials}));var s=yA(n).pipe(mA(function(e){return a.handler.handle(e)}));if(e instanceof NA||"events"===o.observe)return s;var u=s.pipe(kA(function(e){return e instanceof FA}));switch(o.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return u.pipe(Fp(function(e){if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return u.pipe(Fp(function(e){if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return u.pipe(Fp(function(e){if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));case"json":default:return u.pipe(Fp(function(e){return e.body}))}case"response":return u;default:throw new Error("Unreachable: unhandled observe type ".concat(o.observe,"}"))}}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,t)}},{key:"head",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",e,t)}},{key:"jsonp",value:function(e,t){return this.request("JSONP",e,{params:(new TA).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",e,t)}},{key:"patch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",e,VA(n,t))}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,VA(n,t))}},{key:"put",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",e,VA(n,t))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(_A))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),zA=function(){function e(t,n){np(this,e),this.next=t,this.interceptor=n}return ip(e,[{key:"handle",value:function(e){return this.interceptor.intercept(e,this.next)}}]),e}(),HA=new sk("HTTP_INTERCEPTORS"),GA=function(){var e=function(){function e(){np(this,e)}return ip(e,[{key:"intercept",value:function(e,t){return t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),qA=/^\)\]\}',?\n/,$A=function(){var e=function(){function e(t){np(this,e),this.xhrFactory=t}return ip(e,[{key:"handle",value:function(e){var t=this;if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Ip(function(n){var r=t.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach(function(e,t){return r.setRequestHeader(e,t.join(","))}),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){var i=e.detectContentTypeHeader();null!==i&&r.setRequestHeader("Content-Type",i)}if(e.responseType){var a=e.responseType.toLowerCase();r.responseType="json"!==a?a:"text"}var o=e.serializeBody(),s=null,u=function(){if(null!==s)return s;var t=1223===r.status?204:r.status,n=r.statusText||"OK",i=new CA(r.getAllResponseHeaders()),a=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(r)||e.url;return s=new LA({headers:i,status:t,statusText:n,url:a})},c=function(){var t=u(),i=t.headers,a=t.status,o=t.statusText,s=t.url,c=null;204!==a&&(c=void 0===r.response?r.responseText:r.response),0===a&&(a=c?200:0);var l=a>=200&&a<300;if("json"===e.responseType&&"string"==typeof c){var h=c;c=c.replace(qA,"");try{c=""!==c?JSON.parse(c):null}catch(f){c=h,l&&(l=!1,c={error:f,text:c})}}l?(n.next(new FA({body:c,headers:i,status:a,statusText:o,url:s||void 0})),n.complete()):n.error(new BA({error:c,headers:i,status:a,statusText:o,url:s||void 0}))},l=function(e){var t=u().url,i=new BA({error:e,status:r.status||0,statusText:r.statusText||"Unknown Error",url:t||void 0});n.error(i)},h=!1,f=function(t){h||(n.next(u()),h=!0);var i={type:MA.DownloadProgress,loaded:t.loaded};t.lengthComputable&&(i.total=t.total),"text"===e.responseType&&!!r.responseText&&(i.partialText=r.responseText),n.next(i)},d=function(e){var t={type:MA.UploadProgress,loaded:e.loaded};e.lengthComputable&&(t.total=e.total),n.next(t)};return r.addEventListener("load",c),r.addEventListener("error",l),r.addEventListener("timeout",l),r.addEventListener("abort",l),e.reportProgress&&(r.addEventListener("progress",f),null!==o&&r.upload&&r.upload.addEventListener("progress",d)),r.send(o),n.next({type:MA.Sent}),function(){r.removeEventListener("error",l),r.removeEventListener("abort",l),r.removeEventListener("load",c),r.removeEventListener("timeout",l),e.reportProgress&&(r.removeEventListener("progress",f),null!==o&&r.upload&&r.upload.removeEventListener("progress",d)),r.readyState!==r.DONE&&r.abort()}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(WT))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),WA=new sk("XSRF_COOKIE_NAME"),jA=new sk("XSRF_HEADER_NAME"),ZA=ip(function e(){np(this,e)}),YA=function(){var e=function(){function e(t,n,r){np(this,e),this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return ip(e,[{key:"getToken",value:function(){if("server"===this.platform)return null;var e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=xT(e,this.cookieName),this.lastCookieString=e),this.lastToken}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(TO),Ok(LP),Ok(WA))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),KA=function(){var e=function(){function e(t,n){np(this,e),this.tokenService=t,this.headerName=n}return ip(e,[{key:"intercept",value:function(e,t){var n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);var r=this.tokenService.getToken();return null!==r&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(ZA),Ok(jA))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),JA=function(){var e=function(){function e(t,n){np(this,e),this.backend=t,this.injector=n,this.chain=null}return ip(e,[{key:"handle",value:function(e){if(null===this.chain){var t=this.injector.get(HA,[]);this.chain=t.reduceRight(function(e,t){return new zA(e,t)},this.backend)}return this.chain.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(wA),Ok(UC))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),QA=function(){var e=function(){function e(){np(this,e)}return ip(e,null,[{key:"disable",value:function(){return{ngModule:e,providers:[{provide:KA,useClass:GA}]}}},{key:"withOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[t.cookieName?{provide:WA,useValue:t.cookieName}:[],t.headerName?{provide:jA,useValue:t.headerName}:[]]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ay({type:e}),e.\u0275inj=Pg({providers:[KA,{provide:HA,useExisting:KA,multi:!0},{provide:ZA,useClass:YA},{provide:WA,useValue:"XSRF-TOKEN"},{provide:jA,useValue:"X-XSRF-TOKEN"}]}),e}(),XA=function(){var e=ip(function e(){np(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ay({type:e}),e.\u0275inj=Pg({providers:[UA,{provide:_A,useClass:JA},$A,{provide:wA,useExisting:$A}],imports:[[QA.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e}(),eR=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this))._value=e,r}return ip(n,[{key:"value",get:function(){return this.getValue()}},{key:"_subscribe",value:function(e){var t=Hv(Kv(n.prototype),"_subscribe",this).call(this,e);return!t.closed&&e.next(this._value),t}},{key:"getValue",value:function(){var e=this.hasError,t=this.thrownError,n=this._value;if(e)throw t;return this._throwIfClosed(),n}},{key:"next",value:function(e){Hv(Kv(n.prototype),"next",this).call(this,this._value=e)}}]),n}(Rp);function tR(e,t,n){e?Xp(n,e,t):t()}var nR=Qv(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function rR(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return tg(1)(cg(t,ag(t)))}function iR(e){return new Ip(function(t){Jp(e()).subscribe(t)})}function aR(){return Dp(function(e,t){var n=null;e._refCount++;var r=new Lp(t,void 0,void 0,void 0,function(){if(!e||e._refCount<=0||0<--e._refCount)n=null;else{var r=e._connection,i=n;n=null,r&&(!i||r===i)&&r.unsubscribe(),t.unsubscribe()}});e.subscribe(r),r.closed||(n=e.connect())})}var oR=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this)).source=e,i.subjectFactory=r,i._subject=null,i._refCount=0,i._connection=null,Mp(e)&&(i.lift=e.lift),i}return ip(n,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}},{key:"_teardown",value:function(){this._refCount=0;var e=this._connection;this._subject=this._connection=null,null==e||e.unsubscribe()}},{key:"connect",value:function(){var e=this,t=this._connection;if(!t){t=this._connection=new ap;var n=this.getSubject();t.add(this.source.subscribe(new Lp(n,void 0,function(){e._teardown(),n.complete()},function(t){e._teardown(),n.error(t)},function(){return e._teardown()}))),t.closed&&(this._connection=null,t=ap.EMPTY)}return t}},{key:"refCount",value:function(){return aR()(this)}}]),n}(Ip);function sR(e,t){return Dp(function(n,r){var i=null,a=0,o=!1,s=function(){return o&&!i&&r.complete()};n.subscribe(new Lp(r,function(n){null==i||i.unsubscribe();var o=0,u=a++;Jp(e(n,u)).subscribe(i=new Lp(r,function(e){return r.next(t?t(n,e,u,o++):e)},function(){i=null,s()}))},function(){o=!0,s()}))})}function uR(e,t,n,r,i){return function(a,o){var s=n,u=t,c=0;a.subscribe(new Lp(o,function(t){var n=c++;u=s?e(u,t,n):(s=!0,t),r&&o.next(u)},i&&function(){s&&o.next(u),o.complete()}))}}function cR(e,t){return Dp(uR(e,t,arguments.length>=2,!0))}function lR(e){return Dp(function(t,n){var r,i=null,a=!1;i=t.subscribe(new Lp(n,void 0,void 0,function(o){r=Jp(e(o,lR(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):a=!0})),a&&(i.unsubscribe(),i=null,r.subscribe(n))})}function hR(e){return e<=0?function(){return ng}:Dp(function(t,n){var r=[];t.subscribe(new Lp(n,function(t){r.push(t),e<r.length&&r.shift()},function(){var e,t=Xv(r);try{for(t.s();!(e=t.n()).done;){var i=e.value;n.next(i)}}catch(a){t.e(a)}finally{t.f()}n.complete()},void 0,function(){r=null}))})}function fR(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dR;return Dp(function(t,n){var r=!1;t.subscribe(new Lp(n,function(e){r=!0,n.next(e)},function(){return r?n.complete():n.error(e())}))})}function dR(){return new nR}function vR(e){return Dp(function(t,n){var r=!1;t.subscribe(new Lp(n,function(e){r=!0,n.next(e)},function(){r||n.next(e),n.complete()}))})}function pR(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?kA(function(t,n){return e(t,n,r)}):Tp,lg(1),n?vR(t):fR(function(){return new nR}))}}function gR(e,t,n){var r=Yv(e)||t||n?{next:e,error:t,complete:n}:e;return r?Dp(function(e,t){var n;null===(n=r.subscribe)||void 0===n||n.call(r);var i=!0;e.subscribe(new Lp(t,function(e){var n;null===(n=r.next)||void 0===n||n.call(r,e),t.next(e)},function(){var e;i=!1,null===(e=r.complete)||void 0===e||e.call(r),t.complete()},function(e){var n;i=!1,null===(n=r.error)||void 0===n||n.call(r,e),t.error(e)},function(){var e,t;i&&(null===(e=r.unsubscribe)||void 0===e||e.call(r)),null===(t=r.finalize)||void 0===t||t.call(r)}))}):Tp}var yR=ip(function e(t,n){np(this,e),this.id=t,this.url=n}),mR=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return np(this,n),(i=t.call(this,e,r)).navigationTrigger=a,i.restoredState=o,i}return ip(n,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(yR),kR=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,e,r)).urlAfterRedirects=i,a}return ip(n,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),n}(yR),_R=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,e,r)).reason=i,a}return ip(n,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(yR),wR=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,e,r)).error=i,a}return ip(n,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),n}(yR),CR=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a){var o;return np(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return ip(n,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(yR),bR=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a){var o;return np(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return ip(n,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(yR),ER=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o){var s;return np(this,n),(s=t.call(this,e,r)).urlAfterRedirects=i,s.state=a,s.shouldActivate=o,s}return ip(n,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),n}(yR),SR=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a){var o;return np(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return ip(n,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(yR),PR=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a){var o;return np(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return ip(n,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(yR),OR=function(){function e(t){np(this,e),this.route=t}return ip(e,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),e}(),TR=function(){function e(t){np(this,e),this.route=t}return ip(e,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),e}(),IR=function(){function e(t){np(this,e),this.snapshot=t}return ip(e,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),xR=function(){function e(t){np(this,e),this.snapshot=t}return ip(e,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),AR=function(){function e(t){np(this,e),this.snapshot=t}return ip(e,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),RR=function(){function e(t){np(this,e),this.snapshot=t}return ip(e,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),NR=function(){function e(t,n,r){np(this,e),this.routerEvent=t,this.position=n,this.anchor=r}return ip(e,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),e}(),MR="primary",DR=function(){function e(t){np(this,e),this.params=t||{}}return ip(e,[{key:"has",value:function(e){return Object.prototype.hasOwnProperty.call(this.params,e)}},{key:"get",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t[0]:t}return null}},{key:"getAll",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t:[t]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),e}();function LR(e){return new DR(e)}var FR="ngNavigationCancelingError";function BR(e){var t=Error("NavigationCancelingError: "+e);return t[FR]=!0,t}function VR(e,t,n){var r=n.path.split("/");if(r.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;for(var i={},a=0;a<r.length;a++){var o=r[a],s=e[a];if(o.startsWith(":"))i[o.substring(1)]=s;else if(o!==s.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}function UR(e,t){var n,r=e?Object.keys(e):void 0,i=t?Object.keys(t):void 0;if(!r||!i||r.length!=i.length)return!1;for(var a=0;a<r.length;a++)if(!zR(e[n=r[a]],t[n]))return!1;return!0}function zR(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;var n=Jv(e).sort(),r=Jv(t).sort();return n.every(function(e,t){return r[t]===e})}return e===t}function HR(e){return Array.prototype.concat.apply([],e)}function GR(e){return e.length>0?e[e.length-1]:null}function qR(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}function $R(e){return mb(e)?e:yb(e)?cg(Promise.resolve(e)):yA(e)}var WR={exact:function e(t,n,r){if(!tN(t.segments,n.segments)||!JR(t.segments,n.segments,r)||t.numberOfChildren!==n.numberOfChildren)return!1;for(var i in n.children)if(!t.children[i]||!e(t.children[i],n.children[i],r))return!1;return!0},subset:YR},jR={exact:function(e,t){return UR(e,t)},subset:function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(function(n){return zR(e[n],t[n])})},ignored:function(){return!0}};function ZR(e,t,n){return WR[n.paths](e.root,t.root,n.matrixParams)&&jR[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function YR(e,t,n){return KR(e,t,t.segments,n)}function KR(e,t,n,r){if(e.segments.length>n.length){var i=e.segments.slice(0,n.length);return!(!tN(i,n)||t.hasChildren()||!JR(i,n,r))}if(e.segments.length===n.length){if(!tN(e.segments,n)||!JR(e.segments,n,r))return!1;for(var a in t.children)if(!e.children[a]||!YR(e.children[a],t.children[a],r))return!1;return!0}var o=n.slice(0,e.segments.length),s=n.slice(e.segments.length);return!!(tN(e.segments,o)&&JR(e.segments,o,r)&&e.children[MR])&&KR(e.children[MR],t,s,r)}function JR(e,t,n){return t.every(function(t,r){return jR[n](e[r].parameters,t.parameters)})}var QR=function(){function e(t,n,r){np(this,e),this.root=t,this.queryParams=n,this.fragment=r}return ip(e,[{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=LR(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return iN.serialize(this)}}]),e}(),XR=function(){function e(t,n){var r=this;np(this,e),this.segments=t,this.children=n,this.parent=null,qR(n,function(e,t){return e.parent=r})}return ip(e,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}},{key:"toString",value:function(){return aN(this)}}]),e}(),eN=function(){function e(t,n){np(this,e),this.path=t,this.parameters=n}return ip(e,[{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=LR(this.parameters)),this._parameterMap}},{key:"toString",value:function(){return fN(this)}}]),e}();function tN(e,t){return e.length===t.length&&e.every(function(e,n){return e.path===t[n].path})}var nN=ip(function e(){np(this,e)}),rN=function(){function e(){np(this,e)}return ip(e,[{key:"parse",value:function(e){var t=new yN(e);return new QR(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}},{key:"serialize",value:function(e){var t;return"".concat("/".concat(oN(e.root,!0)),function(e){var t=Object.keys(e).map(function(t){var n=e[t];return Array.isArray(n)?n.map(function(e){return"".concat(uN(t),"=").concat(uN(e))}).join("&"):"".concat(uN(t),"=").concat(uN(n))}).filter(function(e){return!!e});return t.length?"?".concat(t.join("&")):""}(e.queryParams)).concat("string"==typeof e.fragment?"#".concat((t=e.fragment,encodeURI(t))):"")}}]),e}(),iN=new rN;function aN(e){return e.segments.map(function(e){return fN(e)}).join("/")}function oN(e,t){if(!e.hasChildren())return aN(e);if(t){var n=e.children[MR]?oN(e.children[MR],!1):"",r=[];return qR(e.children,function(e,t){t!==MR&&r.push("".concat(t,":").concat(oN(e,!1)))}),r.length>0?"".concat(n,"(").concat(r.join("//"),")"):n}var i=function(e,t){var n=[];return qR(e.children,function(e,r){r===MR&&(n=n.concat(t(e,r)))}),qR(e.children,function(e,r){r!==MR&&(n=n.concat(t(e,r)))}),n}(e,function(t,n){return n===MR?[oN(e.children[MR],!1)]:["".concat(n,":").concat(oN(t,!1))]});return 1===Object.keys(e.children).length&&null!=e.children[MR]?"".concat(aN(e),"/").concat(i[0]):"".concat(aN(e),"/(").concat(i.join("//"),")")}function sN(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function uN(e){return sN(e).replace(/%3B/gi,";")}function cN(e){return sN(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function lN(e){return decodeURIComponent(e)}function hN(e){return lN(e.replace(/\+/g,"%20"))}function fN(e){return"".concat(cN(e.path)).concat(function(e){return Object.keys(e).map(function(t){return";".concat(cN(t),"=").concat(cN(e[t]))}).join("")}(e.parameters))}var dN=/^[^\/()?;=#]+/;function vN(e){var t=e.match(dN);return t?t[0]:""}var pN=/^[^=?&#]+/,gN=/^[^?&#]+/,yN=function(){function e(t){np(this,e),this.url=t,this.remaining=t}return ip(e,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new XR([],{}):new XR([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());var t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));var n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[MR]=new XR(e,t)),n}},{key:"parseSegment",value:function(){var e=vN(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(e),new eN(lN(e),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var e={};this.consumeOptional(";");)this.parseParam(e);return e}},{key:"parseParam",value:function(e){var t=vN(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=vN(this.remaining);r&&(n=r,this.capture(n))}e[lN(t)]=lN(n)}}},{key:"parseQueryParam",value:function(e){var t=function(e){var t=e.match(pN);return t?t[0]:""}(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=function(e){var t=e.match(gN);return t?t[0]:""}(this.remaining);r&&(n=r,this.capture(n))}var i=hN(t),a=hN(n);if(e.hasOwnProperty(i)){var o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(a)}else e[i]=a}}},{key:"parseParens",value:function(e){var t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var n=vN(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error("Cannot parse url '".concat(this.url,"'"));var i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):e&&(i=MR);var a=this.parseChildren();t[i]=1===Object.keys(a).length?a[MR]:new XR([],a),this.consumeOptional("//")}return t}},{key:"peekStartsWith",value:function(e){return this.remaining.startsWith(e)}},{key:"consumeOptional",value:function(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}},{key:"capture",value:function(e){if(!this.consumeOptional(e))throw new Error('Expected "'.concat(e,'".'))}}]),e}(),mN=function(){function e(t){np(this,e),this._root=t}return ip(e,[{key:"root",get:function(){return this._root.value}},{key:"parent",value:function(e){var t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}},{key:"children",value:function(e){var t=kN(e,this._root);return t?t.children.map(function(e){return e.value}):[]}},{key:"firstChild",value:function(e){var t=kN(e,this._root);return t&&t.children.length>0?t.children[0].value:null}},{key:"siblings",value:function(e){var t=_N(e,this._root);return t.length<2?[]:t[t.length-2].children.map(function(e){return e.value}).filter(function(t){return t!==e})}},{key:"pathFromRoot",value:function(e){return _N(e,this._root).map(function(e){return e.value})}}]),e}();function kN(e,t){if(e===t.value)return t;var n,r=Xv(t.children);try{for(r.s();!(n=r.n()).done;){var i=kN(e,n.value);if(i)return i}}catch(a){r.e(a)}finally{r.f()}return null}function _N(e,t){if(e===t.value)return[t];var n,r=Xv(t.children);try{for(r.s();!(n=r.n()).done;){var i=_N(e,n.value);if(i.length)return i.unshift(t),i}}catch(a){r.e(a)}finally{r.f()}return[]}var wN=function(){function e(t,n){np(this,e),this.value=t,this.children=n}return ip(e,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),e}();function CN(e){var t={};return e&&e.children.forEach(function(e){return t[e.value.outlet]=e}),t}var bN=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this,e)).snapshot=r,IN(Zv(i),e),i}return ip(n,[{key:"toString",value:function(){return this.snapshot.toString()}}]),n}(mN);function EN(e,t){var n=function(e,t){var n=new ON([],{},{},"",{},MR,t,null,e.root,-1,{});return new TN("",new wN(n,[]))}(e,t),r=new eR([new eN("",{})]),i=new eR({}),a=new eR({}),o=new eR({}),s=new eR(""),u=new SN(r,i,o,s,a,MR,t,n.root);return u.snapshot=n.root,new bN(new wN(u,[]),n)}var SN=function(){function e(t,n,r,i,a,o,s,u){np(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this._futureSnapshot=u}return ip(e,[{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(Fp(function(e){return LR(e)}))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Fp(function(e){return LR(e)}))),this._queryParamMap}},{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}}]),e}();function PN(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",n=e.pathFromRoot,r=0;if("always"!==t)for(r=n.length-1;r>=1;){var i=n[r],a=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function(e){return e.reduce(function(e,t){return{params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}},{params:{},data:{},resolve:{}})}(n.slice(r))}var ON=function(){function e(t,n,r,i,a,o,s,u,c,l,h){np(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this.routeConfig=u,this._urlSegment=c,this._lastPathIndex=l,this._resolve=h}return ip(e,[{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=LR(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=LR(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return"Route(url:'".concat(this.url.map(function(e){return e.toString()}).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}}]),e}(),TN=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this,r)).url=e,IN(Zv(i),r),i}return ip(n,[{key:"toString",value:function(){return xN(this._root)}}]),n}(mN);function IN(e,t){t.value._routerState=e,t.children.forEach(function(t){return IN(e,t)})}function xN(e){var t=e.children.length>0?" { ".concat(e.children.map(xN).join(", ")," } "):"";return"".concat(e.value).concat(t)}function AN(e){if(e.snapshot){var t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,UR(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),UR(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!UR(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),UR(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function RN(e,t){return UR(e.params,t.params)&&function(e,t){return tN(e,t)&&e.every(function(e,n){return UR(e.parameters,t[n].parameters)})}(e.url,t.url)&&!(!e.parent!=!t.parent)&&(!e.parent||RN(e.parent,t.parent))}function NN(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){var r=n.value;r._futureSnapshot=t.value;var i=function(e,t,n){return t.children.map(function(t){var r,i=Xv(n.children);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(e.shouldReuseRoute(t.value,a.value.snapshot))return NN(e,t,a)}}catch(o){i.e(o)}finally{i.f()}return NN(e,t)})}(e,t,n);return new wN(r,i)}if(e.shouldAttach(t.value)){var a=e.retrieve(t.value);if(null!==a){var o=a.route;return MN(t,o),o}}var s=function(e){return new SN(new eR(e.url),new eR(e.params),new eR(e.queryParams),new eR(e.fragment),new eR(e.data),e.outlet,e.component,e)}(t.value),u=t.children.map(function(t){return NN(e,t)});return new wN(s,u)}function MN(e,t){if(e.value.routeConfig!==t.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==t.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");t.value._futureSnapshot=e.value;for(var n=0;n<e.children.length;++n)MN(e.children[n],t.children[n])}function DN(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function LN(e){return"object"==typeof e&&null!=e&&e.outlets}function FN(e,t,n,r,i){var a={};return r&&qR(r,function(e,t){a[t]=Array.isArray(e)?e.map(function(e){return"".concat(e)}):"".concat(e)}),new QR(n.root===e?t:BN(n.root,e,t),a,i)}function BN(e,t,n){var r={};return qR(e.children,function(e,i){r[i]=e===t?n:BN(e,t,n)}),new XR(e.segments,r)}var VN=function(){function e(t,n,r){if(np(this,e),this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&DN(r[0]))throw new Error("Root segment cannot have matrix parameters");var i=r.find(LN);if(i&&i!==GR(r))throw new Error("{outlets:{}} has to be the last command")}return ip(e,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),e}(),UN=ip(function e(t,n,r){np(this,e),this.segmentGroup=t,this.processChildren=n,this.index=r});function zN(e,t,n){if(e||(e=new XR([],{})),0===e.segments.length&&e.hasChildren())return HN(e,t,n);var r=function(e,t,n){for(var r=0,i=t,a={match:!1,pathIndex:0,commandIndex:0};i<e.segments.length;){if(r>=n.length)return a;var o=e.segments[i],s=n[r];if(LN(s))break;var u="".concat(s),c=r<n.length-1?n[r+1]:null;if(i>0&&void 0===u)break;if(u&&c&&"object"==typeof c&&void 0===c.outlets){if(!WN(u,c,o))return a;r+=2}else{if(!WN(u,{},o))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(e,t,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){var a=new XR(e.segments.slice(0,r.pathIndex),{});return a.children[MR]=new XR(e.segments.slice(r.pathIndex),e.children),HN(a,0,i)}return r.match&&0===i.length?new XR(e.segments,{}):r.match&&!e.hasChildren()?GN(e,t,n):r.match?HN(e,0,i):GN(e,t,n)}function HN(e,t,n){if(0===n.length)return new XR(e.segments,{});var r=function(e){return LN(e[0])?e[0].outlets:Lv({},MR,e)}(n),i={};return qR(r,function(n,r){"string"==typeof n&&(n=[n]),null!==n&&(i[r]=zN(e.children[r],t,n))}),qR(e.children,function(e,t){void 0===r[t]&&(i[t]=e)}),new XR(e.segments,i)}function GN(e,t,n){for(var r=e.segments.slice(0,t),i=0;i<n.length;){var a=n[i];if(LN(a)){var o=qN(a.outlets);return new XR(r,o)}if(0===i&&DN(n[0]))r.push(new eN(e.segments[t].path,$N(n[0]))),i++;else{var s=LN(a)?a.outlets[MR]:"".concat(a),u=i<n.length-1?n[i+1]:null;s&&u&&DN(u)?(r.push(new eN(s,$N(u))),i+=2):(r.push(new eN(s,{})),i++)}}return new XR(r,{})}function qN(e){var t={};return qR(e,function(e,n){"string"==typeof e&&(e=[e]),null!==e&&(t[n]=GN(new XR([],{}),0,e))}),t}function $N(e){var t={};return qR(e,function(e,n){return t[n]="".concat(e)}),t}function WN(e,t,n){return e==n.path&&UR(t,n.parameters)}var jN=function(){function e(t,n,r,i){np(this,e),this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=i}return ip(e,[{key:"activate",value:function(e){var t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),AN(this.futureState.root),this.activateChildRoutes(t,n,e)}},{key:"deactivateChildRoutes",value:function(e,t,n){var r=this,i=CN(t);e.children.forEach(function(e){var t=e.value.outlet;r.deactivateRoutes(e,i[t],n),delete i[t]}),qR(i,function(e,t){r.deactivateRouteAndItsChildren(e,n)})}},{key:"deactivateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(r===i)if(r.component){var a=n.getContext(r.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,n);else i&&this.deactivateRouteAndItsChildren(t,n)}},{key:"deactivateRouteAndItsChildren",value:function(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}},{key:"detachAndStoreRouteSubtree",value:function(e,t){var n=t.getContext(e.value.outlet);if(n&&n.outlet){var r=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:r,route:e,contexts:i})}}},{key:"deactivateRouteAndOutlet",value:function(e,t){for(var n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,i=CN(e),a=0,o=Object.keys(i);a<o.length;a++){var s=o[a];this.deactivateRouteAndItsChildren(i[s],r)}n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}},{key:"activateChildRoutes",value:function(e,t,n){var r=this,i=CN(t);e.children.forEach(function(e){r.activateRoutes(e,i[e.value.outlet],n),r.forwardEvent(new RR(e.value.snapshot))}),e.children.length&&this.forwardEvent(new xR(e.value.snapshot))}},{key:"activateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(AN(r),r===i)if(r.component){var a=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,n);else if(r.component){var o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){var s=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(s.contexts),o.attachRef=s.componentRef,o.route=s.route.value,o.outlet&&o.outlet.attach(s.componentRef,s.route.value),ZN(s.route)}else{var u=function(e){for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),c=u?u.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=c,o.outlet&&o.outlet.activateWith(r,c),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}]),e}();function ZN(e){AN(e.value),e.children.forEach(ZN)}var YN=ip(function e(t,n){np(this,e),this.routes=t,this.module=n});function KN(e){return"function"==typeof e}function JN(e){return e instanceof QR}var QN=Symbol("INITIAL_VALUE");function XN(){return sR(function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=ag(t),i=ig(t),a=TI(t),o=a.args,s=a.keys;if(0===o.length)return cg([],r);var u=new Ip(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Tp;return function(r){tR(t,function(){for(var i=e.length,a=new Array(i),o=i,s=i,u=function(i){tR(t,function(){var u=cg(e[i],t),c=!1;u.subscribe(new Lp(r,function(e){a[i]=e,c||(c=!0,s--),s||r.next(n(a.slice()))},function(){--o||r.complete()}))},r)},c=0;c<i;c++)u(c)},r)}}(o,r,s?function(e){return AI(s,e)}:Tp));return i?u.pipe(xI(i)):u}(e.map(function(e){return e.pipe(lg(1),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=ag(t);return Dp(function(e,n){(r?rR(t,e,r):rR(t,e)).subscribe(n)})}(QN))})).pipe(cR(function(e,t){var n=!1;return t.reduce(function(e,r,i){return e!==QN?e:(r===QN&&(n=!0),n||!1!==r&&i!==t.length-1&&!JN(r)?e:r)},e)},QN),kA(function(e){return e!==QN}),Fp(function(e){return JN(e)?e:!0===e}),lg(1))})}var eM=function(){var e=ip(function e(){np(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ty({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&db(0,"router-outlet")},directives:function(){return[JM]},encapsulation:2}),e}();function tM(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<e.length;n++){var r=e[n];nM(r,rM(t,r))}}function nM(e,t){e.children&&tM(e.children,t)}function rM(e,t){return t?e||t.path?e&&!t.path?"".concat(e,"/"):!e&&t.path?t.path:"".concat(e,"/").concat(t.path):"":e}function iM(e){var t=e.children&&e.children.map(iM),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==MR&&(n.component=eM),n}function aM(e){return e.outlet||MR}function oM(e,t){var n=e.filter(function(e){return aM(e)===t});return n.push.apply(n,Jv(e.filter(function(e){return aM(e)!==t}))),n}var sM={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function uM(e,t,n){var r;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?Object.assign({},sM):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};var i=(t.matcher||VR)(n,e,t);if(!i)return Object.assign({},sM);var a={};qR(i.posParams,function(e,t){a[t]=e.path});var o=i.consumed.length>0?Object.assign(Object.assign({},a),i.consumed[i.consumed.length-1].parameters):a;return{matched:!0,consumedSegments:i.consumed,lastChild:i.consumed.length,parameters:o,positionalParamSegments:null!==(r=i.posParams)&&void 0!==r?r:{}}}function cM(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"corrected";if(n.length>0&&function(e,t,n){return n.some(function(n){return lM(e,t,n)&&aM(n)!==MR})}(e,n,r)){var a=new XR(t,function(e,t,n,r){var i={};i[MR]=r,r._sourceSegment=e,r._segmentIndexShift=t.length;var a,o=Xv(n);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(""===s.path&&aM(s)!==MR){var u=new XR([],{});u._sourceSegment=e,u._segmentIndexShift=t.length,i[aM(s)]=u}}}catch(c){o.e(c)}finally{o.f()}return i}(e,t,r,new XR(n,e.children)));return a._sourceSegment=e,a._segmentIndexShift=t.length,{segmentGroup:a,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return n.some(function(n){return lM(e,t,n)})}(e,n,r)){var o=new XR(e.segments,function(e,t,n,r,i,a){var o,s={},u=Xv(r);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(lM(e,n,c)&&!i[aM(c)]){var l=new XR([],{});l._sourceSegment=e,l._segmentIndexShift="legacy"===a?e.segments.length:t.length,s[aM(c)]=l}}}catch(h){u.e(h)}finally{u.f()}return Object.assign(Object.assign({},i),s)}(e,t,n,r,e.children,i));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:n}}var s=new XR(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function lM(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function hM(e,t,n,r){return!!(aM(e)===r||r!==MR&&lM(t,n,e))&&("**"===e.path||uM(t,e,n).matched)}function fM(e,t,n){return 0===t.length&&!e.children[n]}var dM=ip(function e(t){np(this,e),this.segmentGroup=t||null}),vM=ip(function e(t){np(this,e),this.urlTree=t});function pM(e){return new Ip(function(t){return t.error(new dM(e))})}function gM(e){return new Ip(function(t){return t.error(new vM(e))})}function yM(e){return new Ip(function(t){return t.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(e,"'")))})}var mM=function(){function e(t,n,r,i,a){np(this,e),this.configLoader=n,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0,this.ngModule=t.get(BS)}return ip(e,[{key:"apply",value:function(){var e=this,t=cM(this.urlTree.root,[],[],this.config).segmentGroup,n=new XR(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,n,MR).pipe(Fp(function(t){return e.createUrlTree(kM(t),e.urlTree.queryParams,e.urlTree.fragment)})).pipe(lR(function(t){if(t instanceof vM)return e.allowRedirects=!1,e.match(t.urlTree);throw t instanceof dM?e.noMatchError(t):t}))}},{key:"match",value:function(e){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,e.root,MR).pipe(Fp(function(n){return t.createUrlTree(kM(n),e.queryParams,e.fragment)})).pipe(lR(function(e){throw e instanceof dM?t.noMatchError(e):e}))}},{key:"noMatchError",value:function(e){return new Error("Cannot match any routes. URL Segment: '".concat(e.segmentGroup,"'"))}},{key:"createUrlTree",value:function(e,t,n){var r=e.segments.length>0?new XR([],Lv({},MR,e)):e;return new QR(r,t,n)}},{key:"expandSegmentGroup",value:function(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(Fp(function(e){return new XR([],e)})):this.expandSegment(e,n,t,n.segments,r,!0)}},{key:"expandChildren",value:function(e,t,n){for(var r=this,i=[],a=0,o=Object.keys(n.children);a<o.length;a++){var s=o[a];"primary"===s?i.unshift(s):i.push(s)}return cg(i).pipe(mA(function(i){var a=n.children[i],o=oM(t,i);return r.expandSegmentGroup(e,o,a,i).pipe(Fp(function(e){return{segment:e,outlet:i}}))}),cR(function(e,t){return e[t.outlet]=t.segment,e},{}),function(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?kA(function(t,n){return e(t,n,r)}):Tp,hR(1),n?vR(t):fR(function(){return new nR}))}}())}},{key:"expandSegment",value:function(e,t,n,r,i,a){var o=this;return cg(n).pipe(mA(function(s){return o.expandSegmentAgainstRoute(e,t,n,s,r,i,a).pipe(lR(function(e){if(e instanceof dM)return yA(null);throw e}))}),pR(function(e){return!!e}),lR(function(e,n){if(e instanceof nR||"EmptyError"===e.name){if(fM(t,r,i))return yA(new XR([],{}));throw new dM(t)}throw e}))}},{key:"expandSegmentAgainstRoute",value:function(e,t,n,r,i,a,o){return hM(r,t,i,a)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,i,a):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a):pM(t):pM(t)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,a):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(e,t,n,r){var i=this,a=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?gM(a):this.lineralizeSegments(n,a).pipe(eg(function(n){var a=new XR(n,{});return i.expandSegment(e,a,t,n,r,!1)}))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){var o=this,s=uM(t,r,i),u=s.matched,c=s.consumedSegments,l=s.lastChild,h=s.positionalParamSegments;if(!u)return pM(t);var f=this.applyRedirectCommands(c,r.redirectTo,h);return r.redirectTo.startsWith("/")?gM(f):this.lineralizeSegments(r,f).pipe(eg(function(r){return o.expandSegment(e,t,n,r.concat(i.slice(l)),a,!1)}))}},{key:"matchSegmentAgainstRoute",value:function(e,t,n,r,i){var a=this;if("**"===n.path)return n.loadChildren?(n._loadedConfig?yA(n._loadedConfig):this.configLoader.load(e.injector,n)).pipe(Fp(function(e){return n._loadedConfig=e,new XR(r,{})})):yA(new XR(r,{}));var o=uM(t,n,r),s=o.matched,u=o.consumedSegments,c=o.lastChild;if(!s)return pM(t);var l=r.slice(c);return this.getChildConfig(e,n,r).pipe(eg(function(e){var r=e.module,o=e.routes,s=cM(t,u,l,o),c=s.segmentGroup,h=s.slicedSegments,f=new XR(c.segments,c.children);if(0===h.length&&f.hasChildren())return a.expandChildren(r,o,f).pipe(Fp(function(e){return new XR(u,e)}));if(0===o.length&&0===h.length)return yA(new XR(u,{}));var d=aM(n)===i;return a.expandSegment(r,f,o,h,d?MR:i,!0).pipe(Fp(function(e){return new XR(u.concat(e.segments),e.children)}))}))}},{key:"getChildConfig",value:function(e,t,n){var r=this;return t.children?yA(new YN(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?yA(t._loadedConfig):this.runCanLoadGuards(e.injector,t,n).pipe(eg(function(n){return n?r.configLoader.load(e.injector,t).pipe(Fp(function(e){return t._loadedConfig=e,e})):(i=t,new Ip(function(e){return e.error(BR("Cannot load children because the guard of the route \"path: '".concat(i.path,"'\" returned false")))}));var i})):yA(new YN([],e))}},{key:"runCanLoadGuards",value:function(e,t,n){var r=this,i=t.canLoad;return i&&0!==i.length?yA(i.map(function(r){var i,a,o=e.get(r);if((a=o)&&KN(a.canLoad))i=o.canLoad(t,n);else{if(!KN(o))throw new Error("Invalid CanLoad guard");i=o(t,n)}return $R(i)})).pipe(XN(),gR(function(e){if(JN(e)){var t=BR('Redirecting to "'.concat(r.urlSerializer.serialize(e),'"'));throw t.url=e,t}}),Fp(function(e){return!0===e})):yA(!0)}},{key:"lineralizeSegments",value:function(e,t){for(var n=[],r=t.root;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return yA(n);if(r.numberOfChildren>1||!r.children[MR])return yM(e.redirectTo);r=r.children[MR]}}},{key:"applyRedirectCommands",value:function(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}},{key:"applyRedirectCreatreUrlTree",value:function(e,t,n,r){var i=this.createSegmentGroup(e,t.root,n,r);return new QR(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}},{key:"createQueryParams",value:function(e,t){var n={};return qR(e,function(e,r){if("string"==typeof e&&e.startsWith(":")){var i=e.substring(1);n[r]=t[i]}else n[r]=e}),n}},{key:"createSegmentGroup",value:function(e,t,n,r){var i=this,a=this.createSegments(e,t.segments,n,r),o={};return qR(t.children,function(t,a){o[a]=i.createSegmentGroup(e,t,n,r)}),new XR(a,o)}},{key:"createSegments",value:function(e,t,n,r){var i=this;return t.map(function(t){return t.path.startsWith(":")?i.findPosParam(e,t,r):i.findOrReturn(t,n)})}},{key:"findPosParam",value:function(e,t,n){var r=n[t.path.substring(1)];if(!r)throw new Error("Cannot redirect to '".concat(e,"'. Cannot find '").concat(t.path,"'."));return r}},{key:"findOrReturn",value:function(e,t){var n,r=0,i=Xv(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.path===e.path)return t.splice(r),a;r++}}catch(o){i.e(o)}finally{i.f()}return e}}]),e}();function kM(e){for(var t={},n=0,r=Object.keys(e.children);n<r.length;n++){var i=r[n],a=kM(e.children[i]);(a.segments.length>0||a.hasChildren())&&(t[i]=a)}return function(e){if(1===e.numberOfChildren&&e.children[MR]){var t=e.children[MR];return new XR(e.segments.concat(t.segments),t.children)}return e}(new XR(e.segments,t))}var _M=ip(function e(t){np(this,e),this.path=t,this.route=this.path[this.path.length-1]}),wM=ip(function e(t,n){np(this,e),this.component=t,this.route=n});function CM(e,t,n){var r=e._root;return EM(r,t?t._root:null,n,[r.value])}function bM(e,t,n){var r=function(e){if(!e)return null;for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function EM(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=CN(t);return e.children.forEach(function(e){(function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=e.value,o=t?t.value:null,s=n?n.getContext(e.value.outlet):null;if(o&&a.routeConfig===o.routeConfig){var u=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!tN(e.url,t.url);case"pathParamsOrQueryParamsChange":return!tN(e.url,t.url)||!UR(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!RN(e,t)||!UR(e.queryParams,t.queryParams);case"paramsChange":default:return!RN(e,t)}}(o,a,a.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new _M(r)):(a.data=o.data,a._resolvedData=o._resolvedData),EM(e,t,a.component?s?s.children:null:n,r,i),u&&s&&s.outlet&&s.outlet.isActivated&&i.canDeactivateChecks.push(new wM(s.outlet.component,o))}else o&&SM(t,s,i),i.canActivateChecks.push(new _M(r)),EM(e,null,a.component?s?s.children:null:n,r,i)})(e,a[e.value.outlet],n,r.concat([e.value]),i),delete a[e.value.outlet]}),qR(a,function(e,t){return SM(e,n.getContext(t),i)}),i}function SM(e,t,n){var r=CN(e),i=e.value;qR(r,function(e,r){SM(e,i.component?t?t.children.getContext(r):null:t,n)}),n.canDeactivateChecks.push(new wM(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}var PM=ip(function e(){np(this,e)});function OM(e){return new Ip(function(t){return t.error(e)})}var TM=function(){function e(t,n,r,i,a,o){np(this,e),this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=a,this.relativeLinkResolution=o}return ip(e,[{key:"recognize",value:function(){var e=cM(this.urlTree.root,[],[],this.config.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,MR);if(null===t)return null;var n=new ON([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},MR,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new wN(n,t),i=new TN(this.url,r);return this.inheritParamsAndData(i._root),i}},{key:"inheritParamsAndData",value:function(e){var t=this,n=e.value,r=PN(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(function(e){return t.inheritParamsAndData(e)})}},{key:"processSegmentGroup",value:function(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}},{key:"processChildren",value:function(e,t){for(var n=[],r=0,i=Object.keys(t.children);r<i.length;r++){var a=i[r],o=t.children[a],s=oM(e,a),u=this.processSegmentGroup(s,o,a);if(null===u)return null;n.push.apply(n,Jv(u))}var c=IM(n);return c.sort(function(e,t){return e.value.outlet===MR?-1:t.value.outlet===MR?1:e.value.outlet.localeCompare(t.value.outlet)}),c}},{key:"processSegment",value:function(e,t,n,r){var i,a=Xv(e);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=this.processSegmentAgainstRoute(o,t,n,r);if(null!==s)return s}}catch(u){a.e(u)}finally{a.f()}return fM(t,n,r)?[]:null}},{key:"processSegmentAgainstRoute",value:function(e,t,n,r){if(e.redirectTo||!hM(e,t,n,r))return null;var i,a=[],o=[];if("**"===e.path){var s=n.length>0?GR(n).parameters:{};i=new ON(n,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,RM(e),aM(e),e.component,e,xM(t),AM(t)+n.length,NM(e))}else{var u=uM(t,e,n);if(!u.matched)return null;a=u.consumedSegments,o=n.slice(u.lastChild),i=new ON(a,u.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,RM(e),aM(e),e.component,e,xM(t),AM(t)+a.length,NM(e))}var c,l=(c=e).children?c.children:c.loadChildren?c._loadedConfig.routes:[],h=cM(t,a,o,l.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution),f=h.segmentGroup,d=h.slicedSegments;if(0===d.length&&f.hasChildren()){var v=this.processChildren(l,f);return null===v?null:[new wN(i,v)]}if(0===l.length&&0===d.length)return[new wN(i,[])];var p=aM(e)===r,g=this.processSegment(l,f,d,p?MR:r);return null===g?null:[new wN(i,g)]}}]),e}();function IM(e){var t,n=[],r=new Set,i=Xv(e);try{var a=function(){var e,i=t.value;if(!function(e){var t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}(i))return n.push(i),"continue";var a=n.find(function(e){return i.value.routeConfig===e.value.routeConfig});void 0!==a?((e=a.children).push.apply(e,Jv(i.children)),r.add(a)):n.push(i)};for(i.s();!(t=i.n()).done;)a()}catch(l){i.e(l)}finally{i.f()}var o,s=Xv(r);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=IM(u.children);n.push(new wN(u.value,c))}}catch(l){s.e(l)}finally{s.f()}return n.filter(function(e){return!r.has(e)})}function xM(e){for(var t=e;t._sourceSegment;)t=t._sourceSegment;return t}function AM(e){for(var t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;t._sourceSegment;)n+=(t=t._sourceSegment)._segmentIndexShift?t._segmentIndexShift:0;return n-1}function RM(e){return e.data||{}}function NM(e){return e.resolve||{}}function MM(e){return sR(function(t){var n=e(t);return n?cg(n).pipe(Fp(function(){return t})):yA(t)})}var DM=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n)}(function(){function e(){np(this,e)}return ip(e,[{key:"shouldDetach",value:function(e){return!1}},{key:"store",value:function(e,t){}},{key:"shouldAttach",value:function(e){return!1}},{key:"retrieve",value:function(e){return null}},{key:"shouldReuseRoute",value:function(e,t){return e.routeConfig===t.routeConfig}}]),e}()),LM=new sk("ROUTES"),FM=function(){function e(t,n,r,i){np(this,e),this.loader=t,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=i}return ip(e,[{key:"load",value:function(e,t){var n=this;if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);var r=this.loadModuleFactory(t.loadChildren).pipe(Fp(function(r){n.onLoadEndListener&&n.onLoadEndListener(t);var i=r.create(e);return new YN(HR(i.injector.get(LM,void 0,Dg.Self|Dg.Optional)).map(iM),i)}),lR(function(e){throw t._loader$=void 0,e}));return t._loader$=new oR(r,function(){return new Rp}).pipe(aR()),t._loader$}},{key:"loadModuleFactory",value:function(e){var t=this;return"string"==typeof e?cg(this.loader.load(e)):$R(e()).pipe(eg(function(e){return e instanceof VS?yA(e):cg(t.compiler.compileModuleAsync(e))}))}}]),e}(),BM=ip(function e(){np(this,e),this.outlet=null,this.route=null,this.resolver=null,this.children=new VM,this.attachRef=null}),VM=function(){function e(){np(this,e),this.contexts=new Map}return ip(e,[{key:"onChildOutletCreated",value:function(e,t){var n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}},{key:"onChildOutletDestroyed",value:function(e){var t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}},{key:"onOutletDeactivated",value:function(){var e=this.contexts;return this.contexts=new Map,e}},{key:"onOutletReAttached",value:function(e){this.contexts=e}},{key:"getOrCreateContext",value:function(e){var t=this.getContext(e);return t||(t=new BM,this.contexts.set(e,t)),t}},{key:"getContext",value:function(e){return this.contexts.get(e)||null}}]),e}(),UM=function(){function e(){np(this,e)}return ip(e,[{key:"shouldProcessUrl",value:function(e){return!0}},{key:"extract",value:function(e){return e}},{key:"merge",value:function(e,t){return e}}]),e}();function zM(e){throw e}function HM(e,t,n){return t.parse("/")}function GM(e,t){return yA(null)}var qM={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},$M={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},WM=function(){var e=function(){function e(t,n,r,i,a,o,s,u){var c=this;np(this,e),this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Rp,this.errorHandler=zM,this.malformedUriErrorHandler=HM,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:GM,afterPreactivation:GM},this.urlHandlingStrategy=new UM,this.routeReuseStrategy=new DM,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=a.get(BS),this.console=a.get(BP);var l=a.get(JP);this.isNgZoneEnabled=l instanceof JP&&JP.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=new QR(new XR([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new FM(o,s,function(e){return c.triggerEvent(new OR(e))},function(e){return c.triggerEvent(new TR(e))}),this.routerState=EN(this.currentUrlTree,this.rootComponentType),this.transitions=new eR({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return ip(e,[{key:"browserPageId",get:function(){var e;return null===(e=this.location.getState())||void 0===e?void 0:e.\u0275routerPageId}},{key:"setupNavigations",value:function(e){var t=this,n=this.events;return e.pipe(kA(function(e){return 0!==e.id}),Fp(function(e){return Object.assign(Object.assign({},e),{extractedUrl:t.urlHandlingStrategy.extract(e.rawUrl)})}),sR(function(e){var r=!1,i=!1;return yA(e).pipe(gR(function(e){t.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:t.lastSuccessfulNavigation?Object.assign(Object.assign({},t.lastSuccessfulNavigation),{previousNavigation:null}):null}}),sR(function(e){var r=t.browserUrlTree.toString(),a=!t.navigated||e.extractedUrl.toString()!==r||r!==t.currentUrlTree.toString();if(("reload"===t.onSameUrlNavigation||a)&&t.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return jM(e.source)&&(t.browserUrlTree=e.extractedUrl),yA(e).pipe(sR(function(e){var r=t.transitions.getValue();return n.next(new mR(e.id,t.serializeUrl(e.extractedUrl),e.source,e.restoredState)),r!==t.transitions.getValue()?ng:Promise.resolve(e)}),function(e,t,n,r){return sR(function(i){return function(e,t,n,r,i){return new mM(e,t,n,r,i).apply()}(e,t,n,i.extractedUrl,r).pipe(Fp(function(e){return Object.assign(Object.assign({},i),{urlAfterRedirects:e})}))})}(t.ngModule.injector,t.configLoader,t.urlSerializer,t.config),gR(function(e){t.currentNavigation=Object.assign(Object.assign({},t.currentNavigation),{finalUrl:e.urlAfterRedirects})}),function(e,n,r,a,o){return eg(function(r){return function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";try{var s=new TM(e,t,n,r,a,o).recognize();return null===s?OM(new PM):yA(s)}catch(i){return OM(i)}}(e,n,r.urlAfterRedirects,(s=r.urlAfterRedirects,t.serializeUrl(s)),a,o).pipe(Fp(function(e){return Object.assign(Object.assign({},r),{targetSnapshot:e})}));var s})}(t.rootComponentType,t.config,0,t.paramsInheritanceStrategy,t.relativeLinkResolution),gR(function(e){"eager"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(e.urlAfterRedirects,e),t.browserUrlTree=e.urlAfterRedirects);var r=new CR(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);n.next(r)}));if(a&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){var o=e.id,s=e.extractedUrl,u=e.source,c=e.restoredState,l=e.extras,h=new mR(o,t.serializeUrl(s),u,c);n.next(h);var f=EN(s,t.rootComponentType).snapshot;return yA(Object.assign(Object.assign({},e),{targetSnapshot:f,urlAfterRedirects:s,extras:Object.assign(Object.assign({},l),{skipLocationChange:!1,replaceUrl:!1})}))}return t.rawUrlTree=e.rawUrl,t.browserUrlTree=e.urlAfterRedirects,e.resolve(null),ng}),MM(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.beforePreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),gR(function(e){var n=new bR(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),Fp(function(e){return Object.assign(Object.assign({},e),{guards:CM(e.targetSnapshot,e.currentSnapshot,t.rootContexts)})}),function(e,t){return eg(function(n){var r=n.targetSnapshot,i=n.currentSnapshot,a=n.guards,o=a.canActivateChecks,s=a.canDeactivateChecks;return 0===s.length&&0===o.length?yA(Object.assign(Object.assign({},n),{guardsResult:!0})):function(e,t,n,r){return cg(e).pipe(eg(function(e){return function(e,t,n,r,i){var a=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return a&&0!==a.length?yA(a.map(function(a){var o,s=bM(a,t,i);if(function(e){return e&&KN(e.canDeactivate)}(s))o=$R(s.canDeactivate(e,t,n,r));else{if(!KN(s))throw new Error("Invalid CanDeactivate guard");o=$R(s(e,t,n,r))}return o.pipe(pR())})).pipe(XN()):yA(!0)}(e.component,e.route,n,t,r)}),pR(function(e){return!0!==e},!0))}(s,r,i,e).pipe(eg(function(n){return n&&function(e){return"boolean"==typeof e}(n)?function(e,t,n,r){return cg(t).pipe(mA(function(t){return rR(function(e,t){return null!==e&&t&&t(new IR(e)),yA(!0)}(t.route.parent,r),function(e,t){return null!==e&&t&&t(new AR(e)),yA(!0)}(t.route,r),function(e,t,n){var r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(function(e){return function(e){var t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)}).filter(function(e){return null!==e}).map(function(t){return iR(function(){return yA(t.guards.map(function(i){var a,o=bM(i,t.node,n);if(function(e){return e&&KN(e.canActivateChild)}(o))a=$R(o.canActivateChild(r,e));else{if(!KN(o))throw new Error("Invalid CanActivateChild guard");a=$R(o(r,e))}return a.pipe(pR())})).pipe(XN())})});return yA(i).pipe(XN())}(e,t.path,n),function(e,t,n){var r=t.routeConfig?t.routeConfig.canActivate:null;return r&&0!==r.length?yA(r.map(function(r){return iR(function(){var i,a=bM(r,t,n);if(function(e){return e&&KN(e.canActivate)}(a))i=$R(a.canActivate(t,e));else{if(!KN(a))throw new Error("Invalid CanActivate guard");i=$R(a(t,e))}return i.pipe(pR())})})).pipe(XN()):yA(!0)}(e,t.route,n))}),pR(function(e){return!0!==e},!0))}(r,o,e,t):yA(n)}),Fp(function(e){return Object.assign(Object.assign({},n),{guardsResult:e})}))})}(t.ngModule.injector,function(e){return t.triggerEvent(e)}),gR(function(e){if(JN(e.guardsResult)){var n=BR('Redirecting to "'.concat(t.serializeUrl(e.guardsResult),'"'));throw n.url=e.guardsResult,n}var r=new ER(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);t.triggerEvent(r)}),kA(function(e){return!!e.guardsResult||(t.restoreHistory(e),t.cancelNavigationTransition(e,""),!1)}),MM(function(e){if(e.guards.canActivateChecks.length)return yA(e).pipe(gR(function(e){var n=new SR(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),sR(function(e){var n=!1;return yA(e).pipe(function(e,t){return eg(function(n){var r=n.targetSnapshot,i=n.guards.canActivateChecks;if(!i.length)return yA(n);var a=0;return cg(i).pipe(mA(function(n){return function(e,t,n,r){return function(e,t,n,r){var i=Object.keys(e);if(0===i.length)return yA({});var a={};return cg(i).pipe(eg(function(i){return function(e,t,n,r){var i=bM(e,t,r);return $R(i.resolve?i.resolve(t,n):i(t,n))}(e[i],t,n,r).pipe(gR(function(e){a[i]=e}))}),hR(1),eg(function(){return Object.keys(a).length===i.length?yA(a):ng}))}(e._resolve,e,t,r).pipe(Fp(function(t){return e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),PN(e,n).resolve),null}))}(n.route,r,e,t)}),gR(function(){return a++}),hR(1),eg(function(e){return a===i.length?yA(n):ng}))})}(t.paramsInheritanceStrategy,t.ngModule.injector),gR({next:function(){return n=!0},complete:function(){n||(t.restoreHistory(e),t.cancelNavigationTransition(e,"At least one route resolver didn't emit any value."))}}))}),gR(function(e){var n=new PR(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}))}),MM(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.afterPreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),Fp(function(e){var n=function(e,t,n){var r=NN(e,t._root,n?n._root:void 0);return new bN(r,t)}(t.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:n})}),gR(function(e){t.currentUrlTree=e.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(e.urlAfterRedirects,e.rawUrl),t.routerState=e.targetRouterState,"deferred"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,e),t.browserUrlTree=e.urlAfterRedirects)}),function(e,t,n){return Fp(function(r){return new jN(t,r.targetRouterState,r.currentRouterState,n).activate(e),r})}(t.rootContexts,t.routeReuseStrategy,function(e){return t.triggerEvent(e)}),gR({next:function(){r=!0},complete:function(){r=!0}}),function(e){return Dp(function(t,n){try{t.subscribe(n)}finally{n.add(e)}})}(function(){var n;if(!r&&!i){var a="Navigation ID ".concat(e.id," is not equal to the current navigation id ").concat(t.navigationId);"replace"===t.canceledNavigationResolution?(t.restoreHistory(e),t.cancelNavigationTransition(e,a)):t.cancelNavigationTransition(e,a)}(null===(n=t.currentNavigation)||void 0===n?void 0:n.id)===e.id&&(t.currentNavigation=null)}),lR(function(r){if(i=!0,function(e){return e&&e[FR]}(r)){var a=JN(r.url);a||(t.navigated=!0,t.restoreHistory(e,!0));var o=new _R(e.id,t.serializeUrl(e.extractedUrl),r.message);n.next(o),a?setTimeout(function(){var n=t.urlHandlingStrategy.merge(r.url,t.rawUrlTree),i={skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||jM(e.source)};t.scheduleNavigation(n,"imperative",null,i,{resolve:e.resolve,reject:e.reject,promise:e.promise})},0):e.resolve(!1)}else{t.restoreHistory(e,!0);var s=new wR(e.id,t.serializeUrl(e.extractedUrl),r);n.next(s);try{e.resolve(t.errorHandler(r))}catch(o){e.reject(o)}}return ng}))}))}},{key:"resetRootComponentType",value:function(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}},{key:"setTransition",value:function(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var e=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe(function(t){var n=e.extractLocationChangeInfoFromEvent(t);e.shouldScheduleNavigation(e.lastLocationChangeInfo,n)&&setTimeout(function(){var t=n.source,r=n.state,i=n.urlTree,a={replaceUrl:!0};if(r){var o=Object.assign({},r);delete o.navigationId,delete o.\u0275routerPageId,0!==Object.keys(o).length&&(a.state=o)}e.scheduleNavigation(i,t,r,a)},0),e.lastLocationChangeInfo=n}))}},{key:"extractLocationChangeInfoFromEvent",value:function(e){var t;return{source:"popstate"===e.type?"popstate":"hashchange",urlTree:this.parseUrl(e.url),state:(null===(t=e.state)||void 0===t?void 0:t.navigationId)?e.state:null,transitionId:this.getTransition().id}}},{key:"shouldScheduleNavigation",value:function(e,t){if(!e)return!0;var n=t.urlTree.toString()===e.urlTree.toString();return t.transitionId!==e.transitionId||!n||!("hashchange"===t.source&&"popstate"===e.source||"popstate"===t.source&&"hashchange"===e.source)}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(e){this.events.next(e)}},{key:"resetConfig",value:function(e){tM(e),this.config=e.map(iM),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}},{key:"createUrlTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.relativeTo,r=t.queryParams,i=t.fragment,a=t.queryParamsHandling,o=t.preserveFragment,s=n||this.routerState.root,u=o?this.currentUrlTree.fragment:i,c=null;switch(a){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}return null!==c&&(c=this.removeEmptyProps(c)),function(e,t,n,r,i){if(0===n.length)return FN(t.root,t.root,t,r,i);var a=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new VN(!0,0,e);var t=0,n=!1,r=e.reduce(function(e,r,i){if("object"==typeof r&&null!=r){if(r.outlets){var a={};return qR(r.outlets,function(e,t){a[t]="string"==typeof e?e.split("/"):e}),[].concat(Jv(e),[{outlets:a}])}if(r.segmentPath)return[].concat(Jv(e),[r.segmentPath])}return"string"!=typeof r?[].concat(Jv(e),[r]):0===i?(r.split("/").forEach(function(r,i){0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?t++:""!=r&&e.push(r))}),e):[].concat(Jv(e),[r])},[]);return new VN(n,t,r)}(n);if(a.toRoot())return FN(t.root,new XR([],{}),t,r,i);var o=function(e,t,n){if(e.isAbsolute)return new UN(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){var r=n.snapshot._urlSegment;return new UN(r,r===t.root,0)}var i=DN(e.commands[0])?0:1;return function(e,t,n){for(var r=e,i=t,a=n;a>i;){if(a-=i,!(r=r.parent))throw new Error("Invalid number of '../'");i=r.segments.length}return new UN(r,!1,i-a)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,e.numberOfDoubleDots)}(a,t,e),s=o.processChildren?HN(o.segmentGroup,o.index,a.commands):zN(o.segmentGroup,o.index,a.commands);return FN(o.segmentGroup,s,t,r,i)}(s,this.currentUrlTree,e,c,null!=u?u:null)}},{key:"navigateByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1},n=JN(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,t)}},{key:"navigate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(e){for(var t=0;t<e.length;t++){var n=e[t];if(null==n)throw new Error("The requested path contains ".concat(n," segment at index ").concat(t))}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}},{key:"serializeUrl",value:function(e){return this.urlSerializer.serialize(e)}},{key:"parseUrl",value:function(e){var t;try{t=this.urlSerializer.parse(e)}catch(n){t=this.malformedUriErrorHandler(n,this.urlSerializer,e)}return t}},{key:"isActive",value:function(e,t){var n;if(n=!0===t?Object.assign({},qM):!1===t?Object.assign({},$M):t,JN(e))return ZR(this.currentUrlTree,e,n);var r=this.parseUrl(e);return ZR(this.currentUrlTree,r,n)}},{key:"removeEmptyProps",value:function(e){return Object.keys(e).reduce(function(t,n){var r=e[n];return null!=r&&(t[n]=r),t},{})}},{key:"processNavigations",value:function(){var e=this;this.navigations.subscribe(function(t){e.navigated=!0,e.lastSuccessfulId=t.id,e.currentPageId=t.targetPageId,e.events.next(new kR(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(e.currentUrlTree))),e.lastSuccessfulNavigation=e.currentNavigation,t.resolve(!0)},function(t){e.console.warn("Unhandled Navigation Error: ".concat(t))})}},{key:"scheduleNavigation",value:function(e,t,n,r,i){var a,o;if(this.disposed)return Promise.resolve(!1);var s,u,c,l=this.getTransition(),h=jM(t)&&l&&!jM(l.source),f=(this.lastSuccessfulId===l.id||this.currentNavigation?l.rawUrl:l.urlAfterRedirects).toString()===e.toString();if(h&&f)return Promise.resolve(!0);i?(s=i.resolve,u=i.reject,c=i.promise):c=new Promise(function(e,t){s=e,u=t});var d,v=++this.navigationId;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(n=this.location.getState()),d=n&&n.\u0275routerPageId?n.\u0275routerPageId:r.replaceUrl||r.skipLocationChange?null!==(a=this.browserPageId)&&void 0!==a?a:0:(null!==(o=this.browserPageId)&&void 0!==o?o:0)+1):d=0,this.setTransition({id:v,targetPageId:d,source:t,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:r,resolve:s,reject:u,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(function(e){return Promise.reject(e)})}},{key:"setBrowserUrl",value:function(e,t){var n=this.urlSerializer.serialize(e),r=Object.assign(Object.assign({},t.extras.state),this.generateNgRouterState(t.id,t.targetPageId));this.location.isCurrentPathEqualTo(n)||t.extras.replaceUrl?this.location.replaceState(n,"",r):this.location.go(n,"",r)}},{key:"restoreHistory",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("computed"===this.canceledNavigationResolution){var i=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(t=this.currentNavigation)||void 0===t?void 0:t.finalUrl)||0===i?this.currentUrlTree===(null===(n=this.currentNavigation)||void 0===n?void 0:n.finalUrl)&&0===i&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(i)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}},{key:"resetState",value:function(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}},{key:"cancelNavigationTransition",value:function(e,t){var n=new _R(e.id,this.serializeUrl(e.extractedUrl),t);this.triggerEvent(n),e.resolve(!1)}},{key:"generateNgRouterState",value:function(e,t){return"computed"===this.canceledNavigationResolution?{navigationId:e,"\u0275routerPageId":t}:{navigationId:e}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(ck),Ok(nN),Ok(VM),Ok(GO),Ok(UC),Ok(mO),Ok(ZP),Ok(void 0))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}();function jM(e){return"imperative"!==e}var ZM=function(){var e=function(){function e(t,n,r,i,a){np(this,e),this.router=t,this.route=n,this.commands=[],this.onChanges=new Rp,null==r&&i.setAttribute(a.nativeElement,"tabindex","0")}return ip(e,[{key:"ngOnChanges",value:function(e){this.onChanges.next(this)}},{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"onClick",value:function(){var e={skipLocationChange:KM(this.skipLocationChange),replaceUrl:KM(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:KM(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(WM),ub(SN),ik("tabindex"),ub(sS),ub(iS))},e.\u0275dir=sy({type:e,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,t){1&e&&kb("click",function(){return t.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[_y]}),e}(),YM=function(){var e=function(){function e(t,n,r){var i=this;np(this,e),this.router=t,this.route=n,this.locationStrategy=r,this.commands=[],this.onChanges=new Rp,this.subscription=t.events.subscribe(function(e){e instanceof kR&&i.updateTargetUrlAndHref()})}return ip(e,[{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"ngOnChanges",value:function(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onClick",value:function(e,t,n,r,i){if(0!==e||t||n||r||i||"string"==typeof this.target&&"_self"!=this.target)return!0;var a={skipLocationChange:KM(this.skipLocationChange),replaceUrl:KM(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,a),!1}},{key:"updateTargetUrlAndHref",value:function(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:KM(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(WM),ub(SN),ub(BO))},e.\u0275dir=sy({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,t){1&e&&kb("click",function(e){return t.onClick(e.button,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey)}),2&e&&(Bb("href",t.href,__),nb("target",t.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[_y]}),e}();function KM(e){return""===e||!!e}var JM=function(){var e=function(){function e(t,n,r,i,a){np(this,e),this.parentContexts=t,this.location=n,this.resolver=r,this.changeDetector=a,this.activated=null,this._activatedRoute=null,this.activateEvents=new dP,this.deactivateEvents=new dP,this.name=i||MR,t.onChildOutletCreated(this.name,this)}return ip(e,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var e=this.activated;return this.activated=null,this._activatedRoute=null,e}},{key:"attach",value:function(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}},{key:"deactivate",value:function(){if(this.activated){var e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}},{key:"activateWith",value:function(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;var n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new QM(e,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(VM),ub(zS),ub(eS),ik("name"),ub(xS))},e.\u0275dir=sy({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),e}(),QM=function(){function e(t,n,r){np(this,e),this.route=t,this.childContexts=n,this.parent=r}return ip(e,[{key:"get",value:function(e,t){return e===SN?this.route:e===VM?this.childContexts:this.parent.get(e,t)}}]),e}(),XM=ip(function e(){np(this,e)}),eD=function(){function e(){np(this,e)}return ip(e,[{key:"preload",value:function(e,t){return yA(null)}}]),e}(),tD=function(){var e=function(){function e(t,n,r,i,a){np(this,e),this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=new FM(n,r,function(e){return t.triggerEvent(new OR(e))},function(e){return t.triggerEvent(new TR(e))})}return ip(e,[{key:"setUpPreloading",value:function(){var e=this;this.subscription=this.router.events.pipe(kA(function(e){return e instanceof kR}),mA(function(){return e.preload()})).subscribe(function(){})}},{key:"preload",value:function(){var e=this.injector.get(BS);return this.processRoutes(e,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"processRoutes",value:function(e,t){var n,r=[],i=Xv(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.loadChildren&&!a.canLoad&&a._loadedConfig){var o=a._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else a.loadChildren&&!a.canLoad?r.push(this.preloadConfig(e,a)):a.children&&r.push(this.processRoutes(e,a.children))}}catch(s){i.e(s)}finally{i.f()}return cg(r).pipe(tg(),Fp(function(e){}))}},{key:"preloadConfig",value:function(e,t){var n=this;return this.preloadingStrategy.preload(t,function(){return(t._loadedConfig?yA(t._loadedConfig):n.loader.load(e.injector,t)).pipe(eg(function(e){return t._loadedConfig=e,n.processRoutes(e.module,e.routes)}))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(WM),Ok(mO),Ok(ZP),Ok(UC),Ok(XM))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),nD=function(){var e=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};np(this,e),this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}return ip(e,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof mR?(e.store[e.lastId]=e.viewportScroller.getScrollPosition(),e.lastSource=t.navigationTrigger,e.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof kR&&(e.lastId=t.id,e.scheduleScrollEvent(t,e.router.parseUrl(t.urlAfterRedirects).fragment))})}},{key:"consumeScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof NR&&(t.position?"top"===e.options.scrollPositionRestoration?e.viewportScroller.scrollToPosition([0,0]):"enabled"===e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===e.options.anchorScrolling?e.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition([0,0]))})}},{key:"scheduleScrollEvent",value:function(e,t){this.router.triggerEvent(new NR(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(WM),Ok(HT),Ok(void 0))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),rD=new sk("ROUTER_CONFIGURATION"),iD=new sk("ROUTER_FORROOT_GUARD"),aD=[GO,{provide:nN,useClass:rN},{provide:WM,useFactory:function(e,t,n,r,i,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,l=new WM(null,e,t,n,r,i,a,HR(o));return u&&(l.urlHandlingStrategy=u),c&&(l.routeReuseStrategy=c),function(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy)}(s,l),s.enableTracing&&l.events.subscribe(function(e){var t,n;null===(t=console.group)||void 0===t||t.call(console,"Router Event: ".concat(e.constructor.name)),console.log(e.toString()),console.log(e),null===(n=console.groupEnd)||void 0===n||n.call(console)}),l},deps:[nN,VM,GO,UC,mO,ZP,LM,rD,[function(){return ip(function e(){np(this,e)})}(),new Dk],[function(){return ip(function e(){np(this,e)})}(),new Dk]]},VM,{provide:SN,useFactory:function(e){return e.routerState.root},deps:[WM]},{provide:mO,useClass:wO},tD,eD,function(){function e(){np(this,e)}return ip(e,[{key:"preload",value:function(e,t){return t().pipe(lR(function(){return yA(null)}))}}]),e}(),{provide:rD,useValue:{enableTracing:!1}}];function oD(){return new hO("Router",WM)}var sD=function(){var e=function(){function e(t,n){np(this,e)}return ip(e,null,[{key:"forRoot",value:function(t,n){return{ngModule:e,providers:[aD,hD(t),{provide:iD,useFactory:lD,deps:[[WM,new Dk,new Lk]]},{provide:rD,useValue:n||{}},{provide:BO,useFactory:cD,deps:[IO,[new Mk(UO),new Dk],rD]},{provide:nD,useFactory:uD,deps:[WM,HT,rD]},{provide:XM,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:eD},{provide:hO,multi:!0,useFactory:oD},[fD,{provide:xP,multi:!0,useFactory:dD,deps:[fD]},{provide:pD,useFactory:vD,deps:[fD]},{provide:FP,multi:!0,useExisting:pD}]]}}},{key:"forChild",value:function(t){return{ngModule:e,providers:[hD(t)]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(iD,8),Ok(WM,8))},e.\u0275mod=ay({type:e}),e.\u0275inj=Pg({}),e}();function uD(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new nD(e,t,n)}function cD(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.useHash?new HO(e,t):new zO(e,t)}function lD(e){return"guarded"}function hD(e){return[{provide:uk,multi:!0,useValue:e},{provide:LM,multi:!0,useValue:e}]}var fD=function(){var e=function(){function e(t){np(this,e),this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Rp}return ip(e,[{key:"appInitializer",value:function(){var e=this;return this.injector.get(AO,Promise.resolve(null)).then(function(){if(e.destroyed)return Promise.resolve(!0);var t=null,n=new Promise(function(e){return t=e}),r=e.injector.get(WM),i=e.injector.get(rD);return"disabled"===i.initialNavigation?(r.setUpLocationChangeListener(),t(!0)):"enabled"===i.initialNavigation||"enabledBlocking"===i.initialNavigation?(r.hooks.afterPreactivation=function(){return e.initNavigation?yA(null):(e.initNavigation=!0,t(!0),e.resultOfPreactivationDone)},r.initialNavigation()):t(!0),n})}},{key:"bootstrapListener",value:function(e){var t=this.injector.get(rD),n=this.injector.get(tD),r=this.injector.get(nD),i=this.injector.get(WM),a=this.injector.get(gO);e===a.components[0]&&(("enabledNonBlocking"===t.initialNavigation||void 0===t.initialNavigation)&&i.initialNavigation(),n.setUpPreloading(),r.init(),i.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"ngOnDestroy",value:function(){this.destroyed=!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(UC))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}();function dD(e){return e.appInitializer.bind(e)}function vD(e){return e.bootstrapListener.bind(e)}var pD=new sk("Router Initializer"),gD=ip(function e(){np(this,e)}),yD="*";function mD(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:2,steps:e,options:t}}function kD(e){return{type:6,styles:e,offset:null}}function _D(e){Promise.resolve(null).then(e)}var wD=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;np(this,e),this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+n}return ip(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"init",value:function(){}},{key:"play",value:function(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}},{key:"triggerMicrotask",value:function(){var e=this;_D(function(){return e._onFinish()})}},{key:"_onStart",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"pause",value:function(){}},{key:"restart",value:function(){}},{key:"finish",value:function(){this._onFinish()}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this._started=!1}},{key:"setPosition",value:function(e){this._position=this.totalTime?e*this.totalTime:1}},{key:"getPosition",value:function(){return this.totalTime?this._position/this.totalTime:1}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),CD=function(){function e(t){var n=this;np(this,e),this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;var r=0,i=0,a=0,o=this.players.length;0==o?_D(function(){return n._onFinish()}):this.players.forEach(function(e){e.onDone(function(){++r==o&&n._onFinish()}),e.onDestroy(function(){++i==o&&n._onDestroy()}),e.onStart(function(){++a==o&&n._onStart()})}),this.totalTime=this.players.reduce(function(e,t){return Math.max(e,t.totalTime)},0)}return ip(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this.players.forEach(function(e){return e.init()})}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"_onStart",value:function(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[])}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(function(e){return e.play()})}},{key:"pause",value:function(){this.players.forEach(function(e){return e.pause()})}},{key:"restart",value:function(){this.players.forEach(function(e){return e.restart()})}},{key:"finish",value:function(){this._onFinish(),this.players.forEach(function(e){return e.finish()})}},{key:"destroy",value:function(){this._onDestroy()}},{key:"_onDestroy",value:function(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(function(e){return e.destroy()}),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this.players.forEach(function(e){return e.reset()}),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"setPosition",value:function(e){var t=e*this.totalTime;this.players.forEach(function(e){var n=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(n)})}},{key:"getPosition",value:function(){var e=this.players.reduce(function(e,t){return null===e||t.totalTime>e.totalTime?t:e},null);return null!=e?e.getPosition():0}},{key:"beforeDestroy",value:function(){this.players.forEach(function(e){e.beforeDestroy&&e.beforeDestroy()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}();function bD(){return"undefined"!=typeof window&&void 0!==window.document}function ED(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function SD(e){switch(e.length){case 0:return new wD;case 1:return e[0];default:return new CD(e)}}function PD(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=[],s=[],u=-1,c=null;if(r.forEach(function(e){var n=e.offset,r=n==u,l=r&&c||{};Object.keys(e).forEach(function(n){var r=n,s=e[n];if("offset"!==n)switch(r=t.normalizePropertyName(r,o),s){case"!":s=i[n];break;case yD:s=a[n];break;default:s=t.normalizeStyleValue(n,r,s,o)}l[r]=s}),r||s.push(l),c=l,u=n}),o.length){var l="\n - ";throw new Error("Unable to animate due to the following errors:".concat(l).concat(o.join(l)))}return s}function OD(e,t,n,r){switch(t){case"start":e.onStart(function(){return r(n&&TD(n,"start",e))});break;case"done":e.onDone(function(){return r(n&&TD(n,"done",e))});break;case"destroy":e.onDestroy(function(){return r(n&&TD(n,"destroy",e))})}}function TD(e,t,n){var r,i=ID(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null!==(r=n.totalTime)&&void 0!==r?r:e.totalTime,!!n.disabled),a=e._data;return null!=a&&(i._data=a),i}function ID(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6?arguments[6]:void 0;return{element:e,triggerName:t,fromState:n,toState:r,phaseName:i,totalTime:a,disabled:!!o}}function xD(e,t,n){var r;return e instanceof Map?(r=e.get(t))||e.set(t,r=n):(r=e[t])||(r=e[t]=n),r}function AD(e){var t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}var RD=function(e,t){return!1},ND=function(e,t){return!1},MD=function(e,t,n){return[]},DD=ED();(DD||"undefined"!=typeof Element)&&(RD=bD()?function(e,t){for(;t&&t!==document.documentElement;){if(t===e)return!0;t=t.parentNode||t.host}return!1}:function(e,t){return e.contains(t)},ND=function(){if(DD||Element.prototype.matches)return function(e,t){return e.matches(t)};var e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?function(e,n){return t.apply(e,[n])}:ND}(),MD=function(e,t,n){var r=[];if(n)for(var i=e.querySelectorAll(t),a=0;a<i.length;a++)r.push(i[a]);else{var o=e.querySelector(t);o&&r.push(o)}return r});var LD=null,FD=!1;function BD(e){LD||(LD=("undefined"!=typeof document?document.body:null)||{},FD=!!LD.style&&"WebkitAppearance"in LD.style);var t=!0;return LD.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(!(t=e in LD.style)&&FD&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in LD.style)),t}var VD=ND,UD=RD,zD=MD;function HD(e){var t={};return Object.keys(e).forEach(function(n){var r=n.replace(/([a-z])([A-Z])/g,"$1-$2");t[r]=e[n]}),t}var GD=function(){var e=function(){function e(){np(this,e)}return ip(e,[{key:"validateStyleProperty",value:function(e){return BD(e)}},{key:"matchesElement",value:function(e,t){return VD(e,t)}},{key:"containsElement",value:function(e,t){return UD(e,t)}},{key:"query",value:function(e,t,n){return zD(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return n||""}},{key:"animate",value:function(e,t,n,r,i){return new wD(n,r)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),qD=function(){var e=ip(function e(){np(this,e)});return e.NOOP=new GD,e}(),$D="ng-enter",WD="ng-leave",jD="ng-trigger",ZD=".ng-trigger",YD="ng-animating",KD=".ng-animating";function JD(e){if("number"==typeof e)return e;var t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:QD(parseFloat(t[1]),t[2])}function QD(e,t){switch(t){case"s":return 1e3*e;default:return e}}function XD(e,t,n){return e.hasOwnProperty("duration")?e:function(e,t,n){var r,i=0,a="";if("string"==typeof e){var o=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===o)return t.push('The provided timing value "'.concat(e,'" is invalid.')),{duration:0,delay:0,easing:""};r=QD(parseFloat(o[1]),o[2]);var s=o[3];null!=s&&(i=QD(parseFloat(s),o[4]));var u=o[5];u&&(a=u)}else r=e;if(!n){var c=!1,l=t.length;r<0&&(t.push("Duration values below 0 are not allowed for this animation step."),c=!0),i<0&&(t.push("Delay values below 0 are not allowed for this animation step."),c=!0),c&&t.splice(l,0,'The provided timing value "'.concat(e,'" is invalid.'))}return{duration:r,delay:i,easing:a}}(e,t,n)}function eL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).forEach(function(n){t[n]=e[n]}),t}function tL(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t)for(var r in e)n[r]=e[r];else eL(e,n);return n}function nL(e,t,n){return n?t+":"+n+";":""}function rL(e){for(var t="",n=0;n<e.style.length;n++){var r=e.style.item(n);t+=nL(0,r,e.style.getPropertyValue(r))}for(var i in e.style)e.style.hasOwnProperty(i)&&!i.startsWith("_")&&(t+=nL(0,dL(i),e.style[i]));e.setAttribute("style",t)}function iL(e,t,n){e.style&&(Object.keys(t).forEach(function(r){var i=fL(r);n&&!n.hasOwnProperty(r)&&(n[r]=e.style[i]),e.style[i]=t[r]}),ED()&&rL(e))}function aL(e,t){e.style&&(Object.keys(t).forEach(function(t){var n=fL(t);e.style[n]=""}),ED()&&rL(e))}function oL(e){return Array.isArray(e)?1==e.length?e[0]:mD(e):e}var sL=new RegExp("{{\\s*(.+?)\\s*}}","g");function uL(e){var t=[];if("string"==typeof e){for(var n;n=sL.exec(e);)t.push(n[1]);sL.lastIndex=0}return t}function cL(e,t,n){var r=e.toString(),i=r.replace(sL,function(e,r){var i=t[r];return t.hasOwnProperty(r)||(n.push("Please provide a value for the animation param ".concat(r)),i=""),i.toString()});return i==r?e:i}function lL(e){for(var t=[],n=e.next();!n.done;)t.push(n.value),n=e.next();return t}var hL=/-+([a-z0-9])/g;function fL(e){return e.replace(hL,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[1].toUpperCase()})}function dL(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function vL(e,t){return 0===e||0===t}function pL(e,t,n){var r=Object.keys(n);if(r.length&&t.length){var i=t[0],a=[];if(r.forEach(function(e){i.hasOwnProperty(e)||a.push(e),i[e]=n[e]}),a.length)for(var o=function(){var n=t[s];a.forEach(function(t){n[t]=yL(e,t)})},s=1;s<t.length;s++)o()}return t}function gL(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw new Error("Unable to resolve animation metadata node #".concat(t.type))}}function yL(e,t){return window.getComputedStyle(e)[t]}function mL(e,t){var n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(function(e){return function(e,t,n){if(":"==e[0]){var r=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return function(e,t){return parseFloat(t)>parseFloat(e)};case":decrement":return function(e,t){return parseFloat(t)<parseFloat(e)};default:return t.push('The transition alias value "'.concat(e,'" is not supported')),"* => *"}}(e,n);if("function"==typeof r)return void t.push(r);e=r}var i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push('The provided transition expression "'.concat(e,'" is not supported')),t;var a=i[1],o=i[2],s=i[3];t.push(wL(a,s)),"<"==o[0]&&("*"!=a||"*"!=s)&&t.push(wL(s,a))}(e,n,t)}):n.push(e),n}var kL=new Set(["true","1"]),_L=new Set(["false","0"]);function wL(e,t){var n=kL.has(e)||_L.has(e),r=kL.has(t)||_L.has(t);return function(i,a){var o="*"==e||e==i,s="*"==t||t==a;return!o&&n&&"boolean"==typeof i&&(o=i?kL.has(e):_L.has(e)),!s&&r&&"boolean"==typeof a&&(s=a?kL.has(t):_L.has(t)),o&&s}}var CL=new RegExp("s*:selfs*,?","g");function bL(e,t,n){return new EL(e).build(t,n)}var EL=function(){function e(t){np(this,e),this._driver=t}return ip(e,[{key:"build",value:function(e,t){var n=new SL(t);return this._resetContextStyleTimingState(n),gL(this,oL(e),n)}},{key:"_resetContextStyleTimingState",value:function(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}},{key:"visitTrigger",value:function(e,t){var n=this,r=t.queryCount=0,i=t.depCount=0,a=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(function(e){if(n._resetContextStyleTimingState(t),0==e.type){var s=e,u=s.name;u.toString().split(/\s*,\s*/).forEach(function(e){s.name=e,a.push(n.visitState(s,t))}),s.name=u}else if(1==e.type){var c=n.visitTransition(e,t);r+=c.queryCount,i+=c.depCount,o.push(c)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:a,transitions:o,queryCount:r,depCount:i,options:null}}},{key:"visitState",value:function(e,t){var n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){var i=new Set,a=r||{};if(n.styles.forEach(function(e){if(PL(e)){var t=e;Object.keys(t).forEach(function(e){uL(t[e]).forEach(function(e){a.hasOwnProperty(e)||i.add(e)})})}}),i.size){var o=lL(i.values());t.errors.push('state("'.concat(e.name,'", ...) must define default values for all the following style substitutions: ').concat(o.join(", ")))}}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}},{key:"visitTransition",value:function(e,t){t.queryCount=0,t.depCount=0;var n=gL(this,oL(e.animation),t);return{type:1,matchers:mL(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:OL(e.options)}}},{key:"visitSequence",value:function(e,t){var n=this;return{type:2,steps:e.steps.map(function(e){return gL(n,e,t)}),options:OL(e.options)}}},{key:"visitGroup",value:function(e,t){var n=this,r=t.currentTime,i=0,a=e.steps.map(function(e){t.currentTime=r;var a=gL(n,e,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:3,steps:a,options:OL(e.options)}}},{key:"visitAnimate",value:function(e,t){var n=function(e,t){var n=null;if(e.hasOwnProperty("duration"))n=e;else if("number"==typeof e)return TL(XD(e,t).duration,0,"");var r=e;if(r.split(/\s+/).some(function(e){return"{"==e.charAt(0)&&"{"==e.charAt(1)})){var i=TL(0,0,"");return i.dynamic=!0,i.strValue=r,i}return TL((n=n||XD(r,t)).duration,n.delay,n.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;var r,i=e.styles?e.styles:kD({});if(5==i.type)r=this.visitKeyframes(i,t);else{var a=e.styles,o=!1;if(!a){o=!0;var s={};n.easing&&(s.easing=n.easing),a=kD(s)}t.currentTime+=n.duration+n.delay;var u=this.visitStyle(a,t);u.isEmptyStep=o,r=u}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}},{key:"visitStyle",value:function(e,t){var n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}},{key:"_makeStyleAst",value:function(e,t){var n=[];Array.isArray(e.styles)?e.styles.forEach(function(e){"string"==typeof e?e==yD?n.push(e):t.errors.push("The provided style string value ".concat(e," is not allowed.")):n.push(e)}):n.push(e.styles);var r=!1,i=null;return n.forEach(function(e){if(PL(e)){var t=e,n=t.easing;if(n&&(i=n,delete t.easing),!r)for(var a in t)if(t[a].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:e.offset,containsDynamicStyles:r,options:null}}},{key:"_validateStyleAst",value:function(e,t){var n=this,r=t.currentAnimateTimings,i=t.currentTime,a=t.currentTime;r&&a>0&&(a-=r.duration+r.delay),e.styles.forEach(function(e){"string"!=typeof e&&Object.keys(e).forEach(function(r){if(n._driver.validateStyleProperty(r)){var o=t.collectedStyles[t.currentQuerySelector],s=o[r],u=!0;s&&(a!=i&&a>=s.startTime&&i<=s.endTime&&(t.errors.push('The CSS property "'.concat(r,'" that exists between the times of "').concat(s.startTime,'ms" and "').concat(s.endTime,'ms" is also being animated in a parallel animation between the times of "').concat(a,'ms" and "').concat(i,'ms"')),u=!1),a=s.startTime),u&&(o[r]={startTime:a,endTime:i}),t.options&&function(e,t,n){var r=t.params||{},i=uL(e);i.length&&i.forEach(function(e){r.hasOwnProperty(e)||n.push("Unable to resolve the local animation param ".concat(e," in the given list of values"))})}(e[r],t.options,t.errors)}else t.errors.push('The provided animation property "'.concat(r,'" is not a supported CSS property for animations'))})})}},{key:"visitKeyframes",value:function(e,t){var n=this,r={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),r;var i=0,a=[],o=!1,s=!1,u=0,c=e.steps.map(function(e){var r=n._makeStyleAst(e,t),c=null!=r.offset?r.offset:function(e){if("string"==typeof e)return null;var t=null;if(Array.isArray(e))e.forEach(function(e){if(PL(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}});else if(PL(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}return t}(r.styles),l=0;return null!=c&&(i++,l=r.offset=c),s=s||l<0||l>1,o=o||l<u,u=l,a.push(l),r});s&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),o&&t.errors.push("Please ensure that all keyframe offsets are in order");var l=e.steps.length,h=0;i>0&&i<l?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==i&&(h=1/(l-1));var f=l-1,d=t.currentTime,v=t.currentAnimateTimings,p=v.duration;return c.forEach(function(e,i){var o=h>0?i==f?1:h*i:a[i],s=o*p;t.currentTime=d+v.delay+s,v.duration=s,n._validateStyleAst(e,t),e.offset=o,r.styles.push(e)}),r}},{key:"visitReference",value:function(e,t){return{type:8,animation:gL(this,oL(e.animation),t),options:OL(e.options)}}},{key:"visitAnimateChild",value:function(e,t){return t.depCount++,{type:9,options:OL(e.options)}}},{key:"visitAnimateRef",value:function(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:OL(e.options)}}},{key:"visitQuery",value:function(e,t){var n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;var i=Fv(function(e){var t=!!e.split(/\s*,\s*/).find(function(e){return":self"==e});return t&&(e=e.replace(CL,"")),[e=e.replace(/@\*/g,ZD).replace(/@\w+/g,function(e){return ZD+"-"+e.substr(1)}).replace(/:animating/g,KD),t]}(e.selector),2),a=i[0],o=i[1];t.currentQuerySelector=n.length?n+" "+a:a,xD(t.collectedStyles,t.currentQuerySelector,{});var s=gL(this,oL(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:a,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:s,originalSelector:e.selector,options:OL(e.options)}}},{key:"visitStagger",value:function(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");var n="full"===e.timings?{duration:0,delay:0,easing:"full"}:XD(e.timings,t.errors,!0);return{type:12,animation:gL(this,oL(e.animation),t),timings:n,options:null}}}]),e}(),SL=ip(function e(t){np(this,e),this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null});function PL(e){return!Array.isArray(e)&&"object"==typeof e}function OL(e){return e?(e=eL(e)).params&&(e.params=function(e){return e?eL(e):null}(e.params)):e={},e}function TL(e,t,n){return{duration:e,delay:t,easing:n}}function IL(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:r,duration:i,delay:a,totalTime:i+a,easing:o,subTimeline:s}}var xL=function(){function e(){np(this,e),this._map=new Map}return ip(e,[{key:"consume",value:function(e){var t=this._map.get(e);return t?this._map.delete(e):t=[],t}},{key:"append",value:function(e,t){var n,r=this._map.get(e);r||this._map.set(e,r=[]),(n=r).push.apply(n,Jv(t))}},{key:"has",value:function(e){return this._map.has(e)}},{key:"clear",value:function(){this._map.clear()}}]),e}(),AL=new RegExp(":enter","g"),RL=new RegExp(":leave","g");function NL(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s=arguments.length>7?arguments[7]:void 0,u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];return(new ML).buildKeyframes(e,t,n,r,i,a,o,s,u,c)}var ML=function(){function e(){np(this,e)}return ip(e,[{key:"buildKeyframes",value:function(e,t,n,r,i,a,o,s,u){var c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];u=u||new xL;var l=new LL(e,t,u,r,i,c,[]);l.options=s,l.currentTimeline.setStyles([a],null,l.errors,s),gL(this,n,l);var h=l.timelines.filter(function(e){return e.containsAnimation()});if(h.length&&Object.keys(o).length){var f=h[h.length-1];f.allowOnlyTimelineStyles()||f.setStyles([o],null,l.errors,s)}return h.length?h.map(function(e){return e.buildKeyframes()}):[IL(t,[],[],[],0,0,"",!1)]}},{key:"visitTrigger",value:function(e,t){}},{key:"visitState",value:function(e,t){}},{key:"visitTransition",value:function(e,t){}},{key:"visitAnimateChild",value:function(e,t){var n=t.subInstructions.consume(t.element);if(n){var r=t.createSubContext(e.options),i=t.currentTimeline.currentTime,a=this._visitSubInstructions(n,r,r.options);i!=a&&t.transformIntoNewTimeline(a)}t.previousNode=e}},{key:"visitAnimateRef",value:function(e,t){var n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}},{key:"_visitSubInstructions",value:function(e,t,n){var r=t.currentTimeline.currentTime,i=null!=n.duration?JD(n.duration):null,a=null!=n.delay?JD(n.delay):null;return 0!==i&&e.forEach(function(e){var n=t.appendInstructionToTimeline(e,i,a);r=Math.max(r,n.duration+n.delay)}),r}},{key:"visitReference",value:function(e,t){t.updateOptions(e.options,!0),gL(this,e.animation,t),t.previousNode=e}},{key:"visitSequence",value:function(e,t){var n=this,r=t.subContextCount,i=t,a=e.options;if(a&&(a.params||a.delay)&&((i=t.createSubContext(a)).transformIntoNewTimeline(),null!=a.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=DL);var o=JD(a.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(function(e){return gL(n,e,i)}),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),t.previousNode=e}},{key:"visitGroup",value:function(e,t){var n=this,r=[],i=t.currentTimeline.currentTime,a=e.options&&e.options.delay?JD(e.options.delay):0;e.steps.forEach(function(o){var s=t.createSubContext(e.options);a&&s.delayNextStep(a),gL(n,o,s),i=Math.max(i,s.currentTimeline.currentTime),r.push(s.currentTimeline)}),r.forEach(function(e){return t.currentTimeline.mergeTimelineCollectedStyles(e)}),t.transformIntoNewTimeline(i),t.previousNode=e}},{key:"_visitTiming",value:function(e,t){if(e.dynamic){var n=e.strValue;return XD(t.params?cL(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}},{key:"visitAnimate",value:function(e,t){var n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());var i=e.style;5==i.type?this.visitKeyframes(i,t):(t.incrementTime(n.duration),this.visitStyle(i,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}},{key:"visitStyle",value:function(e,t){var n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();var i=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(i):n.setStyles(e.styles,i,t.errors,t.options),t.previousNode=e}},{key:"visitKeyframes",value:function(e,t){var n=t.currentAnimateTimings,r=t.currentTimeline.duration,i=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(function(e){a.forwardTime((e.offset||0)*i),a.setStyles(e.styles,e.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+i),t.previousNode=e}},{key:"visitQuery",value:function(e,t){var n=this,r=t.currentTimeline.currentTime,i=e.options||{},a=i.delay?JD(i.delay):0;a&&(6===t.previousNode.type||0==r&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=DL);var o=r,s=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=s.length;var u=null;s.forEach(function(r,i){t.currentQueryIndex=i;var s=t.createSubContext(e.options,r);a&&s.delayNextStep(a),r===t.element&&(u=s.currentTimeline),gL(n,e.animation,s),s.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,s.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),u&&(t.currentTimeline.mergeTimelineCollectedStyles(u),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}},{key:"visitStagger",value:function(e,t){var n=t.parentContext,r=t.currentTimeline,i=e.timings,a=Math.abs(i.duration),o=a*(t.currentQueryTotal-1),s=a*t.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":s=o-s;break;case"full":s=n.currentStaggerTime}var u=t.currentTimeline;s&&u.delayNextStep(s);var c=u.currentTime;gL(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-c+(r.startTime-n.currentTimeline.startTime)}}]),e}(),DL={},LL=function(){function e(t,n,r,i,a,o,s,u){np(this,e),this._driver=t,this.element=n,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=a,this.errors=o,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=DL,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new FL(this._driver,n,0),s.push(this.currentTimeline)}return ip(e,[{key:"params",get:function(){return this.options.params}},{key:"updateOptions",value:function(e,t){var n=this;if(e){var r=e,i=this.options;null!=r.duration&&(i.duration=JD(r.duration)),null!=r.delay&&(i.delay=JD(r.delay));var a=r.params;if(a){var o=i.params;o||(o=this.options.params={}),Object.keys(a).forEach(function(e){(!t||!o.hasOwnProperty(e))&&(o[e]=cL(a[e],o,n.errors))})}}}},{key:"_copyOptions",value:function(){var e={};if(this.options){var t=this.options.params;if(t){var n=e.params={};Object.keys(t).forEach(function(e){n[e]=t[e]})}}return e}},{key:"createSubContext",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=n||this.element,a=new e(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return a.previousNode=this.previousNode,a.currentAnimateTimings=this.currentAnimateTimings,a.options=this._copyOptions(),a.updateOptions(t),a.currentQueryIndex=this.currentQueryIndex,a.currentQueryTotal=this.currentQueryTotal,a.parentContext=this,this.subContextCount++,a}},{key:"transformIntoNewTimeline",value:function(e){return this.previousNode=DL,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}},{key:"appendInstructionToTimeline",value:function(e,t,n){var r={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},i=new BL(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(i),r}},{key:"incrementTime",value:function(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}},{key:"delayNextStep",value:function(e){e>0&&this.currentTimeline.delayNextStep(e)}},{key:"invokeQuery",value:function(e,t,n,r,i,a){var o=[];if(r&&o.push(this.element),e.length>0){e=(e=e.replace(AL,"."+this._enterClassName)).replace(RL,"."+this._leaveClassName);var s=this._driver.query(this.element,e,1!=n);0!==n&&(s=n<0?s.slice(s.length+n,s.length):s.slice(0,n)),o.push.apply(o,Jv(s))}return!i&&0==o.length&&a.push('`query("'.concat(t,'")` returned zero elements. (Use `query("').concat(t,'", { optional: true })` if you wish to allow this.)')),o}}]),e}(),FL=function(){function e(t,n,r,i){np(this,e),this._driver=t,this.element=n,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}return ip(e,[{key:"containsAnimation",value:function(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}},{key:"getCurrentStyleProperties",value:function(){return Object.keys(this._currentKeyframe)}},{key:"currentTime",get:function(){return this.startTime+this.duration}},{key:"delayNextStep",value:function(e){var t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}},{key:"fork",value:function(t,n){return this.applyStylesToKeyframe(),new e(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}},{key:"_loadKeyframe",value:function(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}},{key:"forwardFrame",value:function(){this.duration+=1,this._loadKeyframe()}},{key:"forwardTime",value:function(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}},{key:"_updateStyle",value:function(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}},{key:"allowOnlyTimelineStyles",value:function(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}},{key:"applyEmptyStep",value:function(e){var t=this;e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(function(e){t._backFill[e]=t._globalTimelineStyles[e]||yD,t._currentKeyframe[e]=yD}),this._currentEmptyStepKeyframe=this._currentKeyframe}},{key:"setStyles",value:function(e,t,n,r){var i=this;t&&(this._previousKeyframe.easing=t);var a=r&&r.params||{},o=function(e,t){var n,r={};return e.forEach(function(e){"*"===e?(n=n||Object.keys(t)).forEach(function(e){r[e]=yD}):tL(e,!1,r)}),r}(e,this._globalTimelineStyles);Object.keys(o).forEach(function(e){var t=cL(o[e],a,n);i._pendingStyles[e]=t,i._localTimelineStyles.hasOwnProperty(e)||(i._backFill[e]=i._globalTimelineStyles.hasOwnProperty(e)?i._globalTimelineStyles[e]:yD),i._updateStyle(e,t)})}},{key:"applyStylesToKeyframe",value:function(){var e=this,t=this._pendingStyles,n=Object.keys(t);0!=n.length&&(this._pendingStyles={},n.forEach(function(n){e._currentKeyframe[n]=t[n]}),Object.keys(this._localTimelineStyles).forEach(function(t){e._currentKeyframe.hasOwnProperty(t)||(e._currentKeyframe[t]=e._localTimelineStyles[t])}))}},{key:"snapshotCurrentStyles",value:function(){var e=this;Object.keys(this._localTimelineStyles).forEach(function(t){var n=e._localTimelineStyles[t];e._pendingStyles[t]=n,e._updateStyle(t,n)})}},{key:"getFinalKeyframe",value:function(){return this._keyframes.get(this.duration)}},{key:"properties",get:function(){var e=[];for(var t in this._currentKeyframe)e.push(t);return e}},{key:"mergeTimelineCollectedStyles",value:function(e){var t=this;Object.keys(e._styleSummary).forEach(function(n){var r=t._styleSummary[n],i=e._styleSummary[n];(!r||i.time>r.time)&&t._updateStyle(n,i.value)})}},{key:"buildKeyframes",value:function(){var e=this;this.applyStylesToKeyframe();var t=new Set,n=new Set,r=1===this._keyframes.size&&0===this.duration,i=[];this._keyframes.forEach(function(a,o){var s=tL(a,!0);Object.keys(s).forEach(function(e){var r=s[e];"!"==r?t.add(e):r==yD&&n.add(e)}),r||(s.offset=o/e.duration),i.push(s)});var a=t.size?lL(t.values()):[],o=n.size?lL(n.values()):[];if(r){var s=i[0],u=eL(s);s.offset=0,u.offset=1,i=[s,u]}return IL(this.element,i,a,o,this.duration,this.startTime,this.easing,!1)}}]),e}(),BL=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o,s){var u,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return np(this,n),(u=t.call(this,e,r,s.delay)).keyframes=i,u.preStyleProps=a,u.postStyleProps=o,u._stretchStartingKeyframe=c,u.timings={duration:s.duration,delay:s.delay,easing:s.easing},u}return ip(n,[{key:"containsAnimation",value:function(){return this.keyframes.length>1}},{key:"buildKeyframes",value:function(){var e=this.keyframes,t=this.timings,n=t.delay,r=t.duration,i=t.easing;if(this._stretchStartingKeyframe&&n){var a=[],o=r+n,s=n/o,u=tL(e[0],!1);u.offset=0,a.push(u);var c=tL(e[0],!1);c.offset=VL(s),a.push(c);for(var l=e.length-1,h=1;h<=l;h++){var f=tL(e[h],!1);f.offset=VL((n+f.offset*r)/o),a.push(f)}r=o,n=0,i="",e=a}return IL(this.element,e,this.preStyleProps,this.postStyleProps,r,n,i,!0)}}]),n}(FL);function VL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=Math.pow(10,t-1);return Math.round(e*n)/n}var UL=ip(function e(){np(this,e)}),zL=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"normalizePropertyName",value:function(e,t){return fL(e)}},{key:"normalizeStyleValue",value:function(e,t,n,r){var i="",a=n.toString().trim();if(HL[t]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{var o=n.match(/^[+-]?[\d\.]+([a-z]*)$/);o&&0==o[1].length&&r.push("Please provide a CSS unit value for ".concat(e,":").concat(n))}return a+i}}]),n}(UL),HL=function(e){var t={};return e.forEach(function(e){return t[e]=!0}),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(","));function GL(e,t,n,r,i,a,o,s,u,c,l,h,f){return{type:0,element:e,triggerName:t,isRemovalTransition:i,fromState:n,fromStyles:a,toState:r,toStyles:o,timelines:s,queriedElements:u,preStyleProps:c,postStyleProps:l,totalTime:h,errors:f}}var qL={},$L=function(){function e(t,n,r){np(this,e),this._triggerName=t,this.ast=n,this._stateStyles=r}return ip(e,[{key:"match",value:function(e,t,n,r){return function(e,t,n,r,i){return e.some(function(e){return e(t,n,r,i)})}(this.ast.matchers,e,t,n,r)}},{key:"buildStyles",value:function(e,t,n){var r=this._stateStyles["*"],i=this._stateStyles[e],a=r?r.buildStyles(t,n):{};return i?i.buildStyles(t,n):a}},{key:"build",value:function(e,t,n,r,i,a,o,s,u,c){var l=[],h=this.ast.options&&this.ast.options.params||qL,f=this.buildStyles(n,o&&o.params||qL,l),d=s&&s.params||qL,v=this.buildStyles(r,d,l),p=new Set,g=new Map,y=new Map,m="void"===r,k={params:Object.assign(Object.assign({},h),d)},_=c?[]:NL(e,t,this.ast.animation,i,a,f,v,k,u,l),w=0;if(_.forEach(function(e){w=Math.max(e.duration+e.delay,w)}),l.length)return GL(t,this._triggerName,n,r,m,f,v,[],[],g,y,w,l);_.forEach(function(e){var n=e.element,r=xD(g,n,{});e.preStyleProps.forEach(function(e){return r[e]=!0});var i=xD(y,n,{});e.postStyleProps.forEach(function(e){return i[e]=!0}),n!==t&&p.add(n)});var C=lL(p.values());return GL(t,this._triggerName,n,r,m,f,v,_,C,g,y,w)}}]),e}(),WL=function(){function e(t,n,r){np(this,e),this.styles=t,this.defaultParams=n,this.normalizer=r}return ip(e,[{key:"buildStyles",value:function(e,t){var n=this,r={},i=eL(this.defaultParams);return Object.keys(e).forEach(function(t){var n=e[t];null!=n&&(i[t]=n)}),this.styles.styles.forEach(function(e){if("string"!=typeof e){var a=e;Object.keys(a).forEach(function(e){var o=a[e];o.length>1&&(o=cL(o,i,t));var s=n.normalizer.normalizePropertyName(e,t);o=n.normalizer.normalizeStyleValue(e,s,o,t),r[s]=o})}}),r}}]),e}(),jL=function(){function e(t,n,r){var i=this;np(this,e),this.name=t,this.ast=n,this._normalizer=r,this.transitionFactories=[],this.states={},n.states.forEach(function(e){i.states[e.name]=new WL(e.style,e.options&&e.options.params||{},r)}),ZL(this.states,"true","1"),ZL(this.states,"false","0"),n.transitions.forEach(function(e){i.transitionFactories.push(new $L(t,e,i.states))}),this.fallbackTransition=function(e,t,n){return new $L(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[function(e,t){return!0}],options:null,queryCount:0,depCount:0},t)}(t,this.states)}return ip(e,[{key:"containsQueries",get:function(){return this.ast.queryCount>0}},{key:"matchTransition",value:function(e,t,n,r){return this.transitionFactories.find(function(i){return i.match(e,t,n,r)})||null}},{key:"matchStyles",value:function(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}]),e}();function ZL(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}var YL=new xL,KL=function(){function e(t,n,r){np(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._animations={},this._playersById={},this.players=[]}return ip(e,[{key:"register",value:function(e,t){var n=[],r=bL(this._driver,t,n);if(n.length)throw new Error("Unable to build the animation due to the following errors: ".concat(n.join("\n")));this._animations[e]=r}},{key:"_buildPlayer",value:function(e,t,n){var r=e.element,i=PD(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,i,e.duration,e.delay,e.easing,[],!0)}},{key:"create",value:function(e,t){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],o=this._animations[e],s=new Map;if(o?(n=NL(this._driver,t,o,$D,WD,{},{},i,YL,a)).forEach(function(e){var t=xD(s,e.element,{});e.postStyleProps.forEach(function(e){return t[e]=null})}):(a.push("The requested animation doesn't exist or has already been destroyed"),n=[]),a.length)throw new Error("Unable to create the animation due to the following errors: ".concat(a.join("\n")));s.forEach(function(e,t){Object.keys(e).forEach(function(n){e[n]=r._driver.computeStyle(t,n,yD)})});var u=SD(n.map(function(e){var t=s.get(e.element);return r._buildPlayer(e,{},t)}));return this._playersById[e]=u,u.onDestroy(function(){return r.destroy(e)}),this.players.push(u),u}},{key:"destroy",value:function(e){var t=this._getPlayer(e);t.destroy(),delete this._playersById[e];var n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}},{key:"_getPlayer",value:function(e){var t=this._playersById[e];if(!t)throw new Error("Unable to find the timeline player referenced by ".concat(e));return t}},{key:"listen",value:function(e,t,n,r){var i=ID(t,"","","");return OD(this._getPlayer(e),n,i,r),function(){}}},{key:"command",value:function(e,t,n,r){if("register"!=n)if("create"!=n){var i=this._getPlayer(e);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}else this.create(e,t,r[0]||{});else this.register(e,r[0])}}]),e}(),JL="ng-animate-queued",QL="ng-animate-disabled",XL=".ng-animate-disabled",eF=[],tF={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},nF={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},rF="__ng_removed",iF=function(){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";np(this,e),this.namespaceId=r;var i=t&&t.hasOwnProperty("value");if(this.value=null!==(n=i?t.value:t)&&void 0!==n?n:null,i){var a=eL(t);delete a.value,this.options=a}else this.options={};this.options.params||(this.options.params={})}return ip(e,[{key:"params",get:function(){return this.options.params}},{key:"absorbOptions",value:function(e){var t=e.params;if(t){var n=this.options.params;Object.keys(t).forEach(function(e){null==n[e]&&(n[e]=t[e])})}}}]),e}(),aF="void",oF=new iF(aF),sF=function(){function e(t,n,r){np(this,e),this.id=t,this.hostElement=n,this._engine=r,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,pF(n,this._hostClassName)}return ip(e,[{key:"listen",value:function(e,t,n,r){var i,a=this;if(!this._triggers.hasOwnProperty(t))throw new Error('Unable to listen on the animation trigger event "'.concat(n,'" because the animation trigger "').concat(t,"\" doesn't exist!"));if(null==n||0==n.length)throw new Error('Unable to listen on the animation trigger "'.concat(t,'" because the provided event is undefined!'));if("start"!=(i=n)&&"done"!=i)throw new Error('The provided animation trigger event "'.concat(n,'" for the animation trigger "').concat(t,'" is not supported!'));var o=xD(this._elementListeners,e,[]),s={name:t,phase:n,callback:r};o.push(s);var u=xD(this._engine.statesByElement,e,{});return u.hasOwnProperty(t)||(pF(e,jD),pF(e,jD+"-"+t),u[t]=oF),function(){a._engine.afterFlush(function(){var e=o.indexOf(s);e>=0&&o.splice(e,1),a._triggers[t]||delete u[t]})}}},{key:"register",value:function(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}},{key:"_getTrigger",value:function(e){var t=this._triggers[e];if(!t)throw new Error('The provided animation trigger "'.concat(e,'" has not been registered!'));return t}},{key:"trigger",value:function(e,t,n){var r=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this._getTrigger(t),o=new cF(this.id,t,e),s=this._engine.statesByElement.get(e);s||(pF(e,jD),pF(e,jD+"-"+t),this._engine.statesByElement.set(e,s={}));var u=s[t],c=new iF(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&u&&c.absorbOptions(u.options),s[t]=c,u||(u=oF),c.value===aF||u.value!==c.value){var l=xD(this._engine.playersByElement,e,[]);l.forEach(function(e){e.namespaceId==r.id&&e.triggerName==t&&e.queued&&e.destroy()});var h=a.matchTransition(u.value,c.value,e,c.params),f=!1;if(!h){if(!i)return;h=a.fallbackTransition,f=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:h,fromState:u,toState:c,player:o,isFallbackTransition:f}),f||(pF(e,JL),o.onStart(function(){gF(e,JL)})),o.onDone(function(){var t=r.players.indexOf(o);t>=0&&r.players.splice(t,1);var n=r._engine.playersByElement.get(e);if(n){var i=n.indexOf(o);i>=0&&n.splice(i,1)}}),this.players.push(o),l.push(o),o}if(!function(e,t){var n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(var i=0;i<n.length;i++){var a=n[i];if(!t.hasOwnProperty(a)||e[a]!==t[a])return!1}return!0}(u.params,c.params)){var d=[],v=a.matchStyles(u.value,u.params,d),p=a.matchStyles(c.value,c.params,d);d.length?this._engine.reportError(d):this._engine.afterFlush(function(){aL(e,v),iL(e,p)})}}},{key:"deregister",value:function(e){var t=this;delete this._triggers[e],this._engine.statesByElement.forEach(function(t,n){delete t[e]}),this._elementListeners.forEach(function(n,r){t._elementListeners.set(r,n.filter(function(t){return t.name!=e}))})}},{key:"clearElementCache",value:function(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);var t=this._engine.playersByElement.get(e);t&&(t.forEach(function(e){return e.destroy()}),this._engine.playersByElement.delete(e))}},{key:"_signalRemovalForInnerTriggers",value:function(e,t){var n=this,r=this._engine.driver.query(e,ZD,!0);r.forEach(function(e){if(!e[rF]){var r=n._engine.fetchNamespacesByElement(e);r.size?r.forEach(function(n){return n.triggerLeaveAnimation(e,t,!1,!0)}):n.clearElementCache(e)}}),this._engine.afterFlushAnimationsDone(function(){return r.forEach(function(e){return n.clearElementCache(e)})})}},{key:"triggerLeaveAnimation",value:function(e,t,n,r){var i=this,a=this._engine.statesByElement.get(e);if(a){var o=[];if(Object.keys(a).forEach(function(t){if(i._triggers[t]){var n=i.trigger(e,t,aF,r);n&&o.push(n)}}),o.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),n&&SD(o).onDone(function(){return i._engine.processLeaveNode(e)}),!0}return!1}},{key:"prepareLeaveAnimationListeners",value:function(e){var t=this,n=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(n&&r){var i=new Set;n.forEach(function(n){var a=n.name;if(!i.has(a)){i.add(a);var o=t._triggers[a].fallbackTransition,s=r[a]||oF,u=new iF(aF),c=new cF(t.id,a,e);t._engine.totalQueuedPlayers++,t._queue.push({element:e,triggerName:a,transition:o,fromState:s,toState:u,player:c,isFallbackTransition:!0})}})}}},{key:"removeNode",value:function(e,t){var n=this,r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),!this.triggerLeaveAnimation(e,t,!0)){var i=!1;if(r.totalAnimations){var a=r.players.length?r.playersByQueriedElement.get(e):[];if(a&&a.length)i=!0;else for(var o=e;o=o.parentNode;)if(r.statesByElement.get(o)){i=!0;break}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,t);else{var s=e[rF];(!s||s===tF)&&(r.afterFlush(function(){return n.clearElementCache(e)}),r.destroyInnerAnimations(e),r._onRemovalComplete(e,t))}}}},{key:"insertNode",value:function(e,t){pF(e,this._hostClassName)}},{key:"drainQueuedTransitions",value:function(e){var t=this,n=[];return this._queue.forEach(function(r){var i=r.player;if(!i.destroyed){var a=r.element,o=t._elementListeners.get(a);o&&o.forEach(function(t){if(t.name==r.triggerName){var n=ID(a,r.triggerName,r.fromState.value,r.toState.value);n._data=e,OD(r.player,t.phase,n,t.callback)}}),i.markedForDestroy?t._engine.afterFlush(function(){i.destroy()}):n.push(r)}}),this._queue=[],n.sort(function(e,n){var r=e.transition.ast.depCount,i=n.transition.ast.depCount;return 0==r||0==i?r-i:t._engine.driver.containsElement(e.element,n.element)?1:-1})}},{key:"destroy",value:function(e){this.players.forEach(function(e){return e.destroy()}),this._signalRemovalForInnerTriggers(this.hostElement,e)}},{key:"elementContainsData",value:function(e){var t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(function(t){return t.element===e})||t}}]),e}(),uF=function(){function e(t,n,r){np(this,e),this.bodyNode=t,this.driver=n,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=function(e,t){}}return ip(e,[{key:"_onRemovalComplete",value:function(e,t){this.onRemovalComplete(e,t)}},{key:"queuedPlayers",get:function(){var e=[];return this._namespaceList.forEach(function(t){t.players.forEach(function(t){t.queued&&e.push(t)})}),e}},{key:"createNamespace",value:function(e,t){var n=new sF(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}},{key:"_balanceNamespaceList",value:function(e,t){var n=this._namespaceList.length-1;if(n>=0){for(var r=!1,i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,t)){this._namespaceList.splice(i+1,0,e),r=!0;break}r||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}},{key:"register",value:function(e,t){var n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}},{key:"registerTrigger",value:function(e,t,n){var r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}},{key:"destroy",value:function(e,t){var n=this;if(e){var r=this._fetchNamespace(e);this.afterFlush(function(){n.namespacesByHostElement.delete(r.hostElement),delete n._namespaceLookup[e];var t=n._namespaceList.indexOf(r);t>=0&&n._namespaceList.splice(t,1)}),this.afterFlushAnimationsDone(function(){return r.destroy(t)})}}},{key:"_fetchNamespace",value:function(e){return this._namespaceLookup[e]}},{key:"fetchNamespacesByElement",value:function(e){var t=new Set,n=this.statesByElement.get(e);if(n)for(var r=Object.keys(n),i=0;i<r.length;i++){var a=n[r[i]].namespaceId;if(a){var o=this._fetchNamespace(a);o&&t.add(o)}}return t}},{key:"trigger",value:function(e,t,n,r){if(lF(t)){var i=this._fetchNamespace(e);if(i)return i.trigger(t,n,r),!0}return!1}},{key:"insertNode",value:function(e,t,n,r){if(lF(t)){var i=t[rF];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;var a=this.collectedLeaveElements.indexOf(t);a>=0&&this.collectedLeaveElements.splice(a,1)}if(e){var o=this._fetchNamespace(e);o&&o.insertNode(t,n)}r&&this.collectEnterElement(t)}}},{key:"collectEnterElement",value:function(e){this.collectedEnterElements.push(e)}},{key:"markElementAsDisabled",value:function(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),pF(e,QL)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),gF(e,QL))}},{key:"removeNode",value:function(e,t,n,r){if(lF(t)){var i=e?this._fetchNamespace(e):null;if(i?i.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){var a=this.namespacesByHostElement.get(t);a&&a.id!==e&&a.removeNode(t,r)}}else this._onRemovalComplete(t,r)}},{key:"markElementAsRemoved",value:function(e,t,n,r){this.collectedLeaveElements.push(t),t[rF]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}},{key:"listen",value:function(e,t,n,r,i){return lF(t)?this._fetchNamespace(e).listen(t,n,r,i):function(){}}},{key:"_buildInstruction",value:function(e,t,n,r,i){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,i)}},{key:"destroyInnerAnimations",value:function(e){var t=this,n=this.driver.query(e,ZD,!0);n.forEach(function(e){return t.destroyActiveAnimationsForElement(e)}),0!=this.playersByQueriedElement.size&&(n=this.driver.query(e,KD,!0)).forEach(function(e){return t.finishActiveQueriedAnimationOnElement(e)})}},{key:"destroyActiveAnimationsForElement",value:function(e){var t=this.playersByElement.get(e);t&&t.forEach(function(e){e.queued?e.markedForDestroy=!0:e.destroy()})}},{key:"finishActiveQueriedAnimationOnElement",value:function(e){var t=this.playersByQueriedElement.get(e);t&&t.forEach(function(e){return e.finish()})}},{key:"whenRenderingDone",value:function(){var e=this;return new Promise(function(t){if(e.players.length)return SD(e.players).onDone(function(){return t()});t()})}},{key:"processLeaveNode",value:function(e){var t=this,n=e[rF];if(n&&n.setForRemoval){if(e[rF]=tF,n.namespaceId){this.destroyInnerAnimations(e);var r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}this.driver.matchesElement(e,XL)&&this.markElementAsDisabled(e,!1),this.driver.query(e,XL,!0).forEach(function(e){t.markElementAsDisabled(e,!1)})}},{key:"flush",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=[];if(this.newHostElements.size&&(this.newHostElements.forEach(function(t,n){return e._balanceNamespaceList(t,n)}),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(var r=0;r<this.collectedEnterElements.length;r++)pF(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){var i=[];try{n=this._flushAnimations(i,t)}finally{for(var a=0;a<i.length;a++)i[a]()}}else for(var o=0;o<this.collectedLeaveElements.length;o++)this.processLeaveNode(this.collectedLeaveElements[o]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(function(e){return e()}),this._flushFns=[],this._whenQuietFns.length){var s=this._whenQuietFns;this._whenQuietFns=[],n.length?SD(n).onDone(function(){s.forEach(function(e){return e()})}):s.forEach(function(e){return e()})}}},{key:"reportError",value:function(e){throw new Error("Unable to process animations due to the following failed trigger transitions\n ".concat(e.join("\n")))}},{key:"_flushAnimations",value:function(e,t){var n=this,r=new xL,i=[],a=new Map,o=[],s=new Map,u=new Map,c=new Map,l=new Set;this.disabledNodes.forEach(function(e){l.add(e);for(var t=n.driver.query(e,".ng-animate-queued",!0),r=0;r<t.length;r++)l.add(t[r])});var h=this.bodyNode,f=Array.from(this.statesByElement.keys()),d=dF(f,this.collectedEnterElements),v=new Map,p=0;d.forEach(function(e,t){var n=$D+p++;v.set(t,n),e.forEach(function(e){return pF(e,n)})});for(var g=[],y=new Set,m=new Set,k=0;k<this.collectedLeaveElements.length;k++){var _=this.collectedLeaveElements[k],w=_[rF];w&&w.setForRemoval&&(g.push(_),y.add(_),w.hasAnimation?this.driver.query(_,".ng-star-inserted",!0).forEach(function(e){return y.add(e)}):m.add(_))}var C=new Map,b=dF(f,Array.from(y));b.forEach(function(e,t){var n=WD+p++;C.set(t,n),e.forEach(function(e){return pF(e,n)})}),e.push(function(){d.forEach(function(e,t){var n=v.get(t);e.forEach(function(e){return gF(e,n)})}),b.forEach(function(e,t){var n=C.get(t);e.forEach(function(e){return gF(e,n)})}),g.forEach(function(e){n.processLeaveNode(e)})});for(var E=[],S=[],P=this._namespaceList.length-1;P>=0;P--)this._namespaceList[P].drainQueuedTransitions(t).forEach(function(e){var t=e.player,a=e.element;if(E.push(t),n.collectedEnterElements.length){var l=a[rF];if(l&&l.setForMove)return void t.destroy()}var f=!h||!n.driver.containsElement(h,a),d=C.get(a),p=v.get(a),g=n._buildInstruction(e,r,p,d,f);if(g.errors&&g.errors.length)S.push(g);else{if(f)return t.onStart(function(){return aL(a,g.fromStyles)}),t.onDestroy(function(){return iL(a,g.toStyles)}),void i.push(t);if(e.isFallbackTransition)return t.onStart(function(){return aL(a,g.fromStyles)}),t.onDestroy(function(){return iL(a,g.toStyles)}),void i.push(t);g.timelines.forEach(function(e){return e.stretchStartingKeyframe=!0}),r.append(a,g.timelines),o.push({instruction:g,player:t,element:a}),g.queriedElements.forEach(function(e){return xD(s,e,[]).push(t)}),g.preStyleProps.forEach(function(e,t){var n=Object.keys(e);if(n.length){var r=u.get(t);r||u.set(t,r=new Set),n.forEach(function(e){return r.add(e)})}}),g.postStyleProps.forEach(function(e,t){var n=Object.keys(e),r=c.get(t);r||c.set(t,r=new Set),n.forEach(function(e){return r.add(e)})})}});if(S.length){var O=[];S.forEach(function(e){O.push("@".concat(e.triggerName," has failed due to:\n")),e.errors.forEach(function(e){return O.push("- ".concat(e,"\n"))})}),E.forEach(function(e){return e.destroy()}),this.reportError(O)}var T=new Map,I=new Map;o.forEach(function(e){var t=e.element;r.has(t)&&(I.set(t,t),n._beforeAnimationBuild(e.player.namespaceId,e.instruction,T))}),i.forEach(function(e){var t=e.element;n._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach(function(e){xD(T,t,[]).push(e),e.destroy()})});var x=g.filter(function(e){return kF(e,u,c)}),A=new Map;fF(A,this.driver,m,c,yD).forEach(function(e){kF(e,u,c)&&x.push(e)});var R=new Map;d.forEach(function(e,t){fF(R,n.driver,new Set(e),u,"!")}),x.forEach(function(e){var t=A.get(e),n=R.get(e);A.set(e,Object.assign(Object.assign({},t),n))});var N=[],M=[],D={};o.forEach(function(e){var t=e.element,o=e.player,s=e.instruction;if(r.has(t)){if(l.has(t))return o.onDestroy(function(){return iL(t,s.toStyles)}),o.disabled=!0,o.overrideTotalTime(s.totalTime),void i.push(o);var u=D;if(I.size>1){for(var c=t,h=[];c=c.parentNode;){var f=I.get(c);if(f){u=f;break}h.push(c)}h.forEach(function(e){return I.set(e,u)})}var d=n._buildAnimation(o.namespaceId,s,T,a,R,A);if(o.setRealPlayer(d),u===D)N.push(o);else{var v=n.playersByElement.get(u);v&&v.length&&(o.parentPlayer=SD(v)),i.push(o)}}else aL(t,s.fromStyles),o.onDestroy(function(){return iL(t,s.toStyles)}),M.push(o),l.has(t)&&i.push(o)}),M.forEach(function(e){var t=a.get(e.element);if(t&&t.length){var n=SD(t);e.setRealPlayer(n)}}),i.forEach(function(e){e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()});for(var L=0;L<g.length;L++){var F=g[L],B=F[rF];if(gF(F,WD),!B||!B.hasAnimation){var V=[];if(s.size){var U=s.get(F);U&&U.length&&V.push.apply(V,Jv(U));for(var z=this.driver.query(F,KD,!0),H=0;H<z.length;H++){var G=s.get(z[H]);G&&G.length&&V.push.apply(V,Jv(G))}}var q=V.filter(function(e){return!e.destroyed});q.length?yF(this,F,q):this.processLeaveNode(F)}}return g.length=0,N.forEach(function(e){n.players.push(e),e.onDone(function(){e.destroy();var t=n.players.indexOf(e);n.players.splice(t,1)}),e.play()}),N}},{key:"elementContainsData",value:function(e,t){var n=!1,r=t[rF];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}},{key:"afterFlush",value:function(e){this._flushFns.push(e)}},{key:"afterFlushAnimationsDone",value:function(e){this._whenQuietFns.push(e)}},{key:"_getPreviousPlayers",value:function(e,t,n,r,i){var a=[];if(t){var o=this.playersByQueriedElement.get(e);o&&(a=o)}else{var s=this.playersByElement.get(e);if(s){var u=!i||i==aF;s.forEach(function(e){e.queued||!u&&e.triggerName!=r||a.push(e)})}}return(n||r)&&(a=a.filter(function(e){return!(n&&n!=e.namespaceId||r&&r!=e.triggerName)})),a}},{key:"_beforeAnimationBuild",value:function(e,t,n){var r,i=this,a=t.element,o=t.isRemovalTransition?void 0:e,s=t.isRemovalTransition?void 0:t.triggerName,u=Xv(t.timelines);try{var c=function(){var e=r.value.element,u=e!==a,c=xD(n,e,[]);i._getPreviousPlayers(e,u,o,s,t.toState).forEach(function(e){var t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),c.push(e)})};for(u.s();!(r=u.n()).done;)c()}catch(l){u.e(l)}finally{u.f()}aL(a,t.fromStyles)}},{key:"_buildAnimation",value:function(e,t,n,r,i,a){var o=this,s=t.triggerName,u=t.element,c=[],l=new Set,h=new Set,f=t.timelines.map(function(t){var f=t.element;l.add(f);var d=f[rF];if(d&&d.removedBeforeQueried)return new wD(t.duration,t.delay);var v=f!==u,p=function(e){var t=[];return mF(e,t),t}((n.get(f)||eF).map(function(e){return e.getRealPlayer()})).filter(function(e){return!!e.element&&e.element===f}),g=i.get(f),y=a.get(f),m=PD(0,o._normalizer,0,t.keyframes,g,y),k=o._buildPlayer(t,m,p);if(t.subTimeline&&r&&h.add(f),v){var _=new cF(e,s,f);_.setRealPlayer(k),c.push(_)}return k});c.forEach(function(e){xD(o.playersByQueriedElement,e.element,[]).push(e),e.onDone(function(){return function(e,t,n){var r;if(e instanceof Map){if(r=e.get(t)){if(r.length){var i=r.indexOf(n);r.splice(i,1)}0==r.length&&e.delete(t)}}else if(r=e[t]){if(r.length){var a=r.indexOf(n);r.splice(a,1)}0==r.length&&delete e[t]}return r}(o.playersByQueriedElement,e.element,e)})}),l.forEach(function(e){return pF(e,YD)});var d=SD(f);return d.onDestroy(function(){l.forEach(function(e){return gF(e,YD)}),iL(u,t.toStyles)}),h.forEach(function(e){xD(r,e,[]).push(d)}),d}},{key:"_buildPlayer",value:function(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new wD(e.duration,e.delay)}}]),e}(),cF=function(){function e(t,n,r){np(this,e),this.namespaceId=t,this.triggerName=n,this.element=r,this._player=new wD,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}return ip(e,[{key:"setRealPlayer",value:function(e){var t=this;this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(function(n){t._queuedCallbacks[n].forEach(function(t){return OD(e,n,void 0,t)})}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}},{key:"getRealPlayer",value:function(){return this._player}},{key:"overrideTotalTime",value:function(e){this.totalTime=e}},{key:"syncPlayerEvents",value:function(e){var t=this,n=this._player;n.triggerCallback&&e.onStart(function(){return n.triggerCallback("start")}),e.onDone(function(){return t.finish()}),e.onDestroy(function(){return t.destroy()})}},{key:"_queueEvent",value:function(e,t){xD(this._queuedCallbacks,e,[]).push(t)}},{key:"onDone",value:function(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}},{key:"onStart",value:function(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}},{key:"onDestroy",value:function(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}},{key:"init",value:function(){this._player.init()}},{key:"hasStarted",value:function(){return!this.queued&&this._player.hasStarted()}},{key:"play",value:function(){!this.queued&&this._player.play()}},{key:"pause",value:function(){!this.queued&&this._player.pause()}},{key:"restart",value:function(){!this.queued&&this._player.restart()}},{key:"finish",value:function(){this._player.finish()}},{key:"destroy",value:function(){this.destroyed=!0,this._player.destroy()}},{key:"reset",value:function(){!this.queued&&this._player.reset()}},{key:"setPosition",value:function(e){this.queued||this._player.setPosition(e)}},{key:"getPosition",value:function(){return this.queued?0:this._player.getPosition()}},{key:"triggerCallback",value:function(e){var t=this._player;t.triggerCallback&&t.triggerCallback(e)}}]),e}();function lF(e){return e&&1===e.nodeType}function hF(e,t){var n=e.style.display;return e.style.display=null!=t?t:"none",n}function fF(e,t,n,r,i){var a=[];n.forEach(function(e){return a.push(hF(e))});var o=[];r.forEach(function(n,r){var a={};n.forEach(function(e){var n=a[e]=t.computeStyle(r,e,i);(!n||0==n.length)&&(r[rF]=nF,o.push(r))}),e.set(r,a)});var s=0;return n.forEach(function(e){return hF(e,a[s++])}),o}function dF(e,t){var n=new Map;if(e.forEach(function(e){return n.set(e,[])}),0==t.length)return n;var r=new Set(t),i=new Map;function a(e){if(!e)return 1;var t=i.get(e);if(t)return t;var o=e.parentNode;return t=n.has(o)?o:r.has(o)?1:a(o),i.set(e,t),t}return t.forEach(function(e){var t=a(e);1!==t&&n.get(t).push(e)}),n}var vF="$$classes";function pF(e,t){if(e.classList)e.classList.add(t);else{var n=e[vF];n||(n=e[vF]={}),n[t]=!0}}function gF(e,t){if(e.classList)e.classList.remove(t);else{var n=e[vF];n&&delete n[t]}}function yF(e,t,n){SD(n).onDone(function(){return e.processLeaveNode(t)})}function mF(e,t){for(var n=0;n<e.length;n++){var r=e[n];r instanceof CD?mF(r.players,t):t.push(r)}}function kF(e,t,n){var r=n.get(e);if(!r)return!1;var i=t.get(e);return i?r.forEach(function(e){return i.add(e)}):t.set(e,r),n.delete(e),!0}var _F=function(){function e(t,n,r){var i=this;np(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=function(e,t){},this._transitionEngine=new uF(t,n,r),this._timelineEngine=new KL(t,n,r),this._transitionEngine.onRemovalComplete=function(e,t){return i.onRemovalComplete(e,t)}}return ip(e,[{key:"registerTrigger",value:function(e,t,n,r,i){var a=e+"-"+r,o=this._triggerCache[a];if(!o){var s=[],u=bL(this._driver,i,s);if(s.length)throw new Error('The animation trigger "'.concat(r,'" has failed to build due to the following errors:\n - ').concat(s.join("\n - ")));o=function(e,t,n){return new jL(e,t,n)}(r,u,this._normalizer),this._triggerCache[a]=o}this._transitionEngine.registerTrigger(t,r,o)}},{key:"register",value:function(e,t){this._transitionEngine.register(e,t)}},{key:"destroy",value:function(e,t){this._transitionEngine.destroy(e,t)}},{key:"onInsert",value:function(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}},{key:"onRemove",value:function(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}},{key:"disableAnimations",value:function(e,t){this._transitionEngine.markElementAsDisabled(e,t)}},{key:"process",value:function(e,t,n,r){if("@"==n.charAt(0)){var i=Fv(AD(n),2),a=i[0],o=i[1];this._timelineEngine.command(a,t,o,r)}else this._transitionEngine.trigger(e,t,n,r)}},{key:"listen",value:function(e,t,n,r,i){if("@"==n.charAt(0)){var a=Fv(AD(n),2),o=a[0],s=a[1];return this._timelineEngine.listen(o,t,s,i)}return this._transitionEngine.listen(e,t,n,r,i)}},{key:"flush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._transitionEngine.flush(e)}},{key:"players",get:function(){return this._transitionEngine.players.concat(this._timelineEngine.players)}},{key:"whenRenderingDone",value:function(){return this._transitionEngine.whenRenderingDone()}}]),e}();function wF(e,t){var n=null,r=null;return Array.isArray(t)&&t.length?(n=bF(t[0]),t.length>1&&(r=bF(t[t.length-1]))):t&&(n=bF(t)),n||r?new CF(e,n,r):null}var CF=function(){var e=function(){function e(t,n,r){np(this,e),this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;var i=e.initialStylesByElement.get(t);i||e.initialStylesByElement.set(t,i={}),this._initialStyles=i}return ip(e,[{key:"start",value:function(){this._state<1&&(this._startStyles&&iL(this._element,this._startStyles,this._initialStyles),this._state=1)}},{key:"finish",value:function(){this.start(),this._state<2&&(iL(this._element,this._initialStyles),this._endStyles&&(iL(this._element,this._endStyles),this._endStyles=null),this._state=1)}},{key:"destroy",value:function(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(aL(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(aL(this._element,this._endStyles),this._endStyles=null),iL(this._element,this._initialStyles),this._state=3)}}]),e}();return e.initialStylesByElement=new WeakMap,e}();function bF(e){for(var t=null,n=Object.keys(e),r=0;r<n.length;r++){var i=n[r];EF(i)&&((t=t||{})[i]=e[i])}return t}function EF(e){return"display"===e||"position"===e}var SF="animation",PF="animationend",OF=function(){function e(t,n,r,i,a,o,s){var u=this;np(this,e),this._element=t,this._name=n,this._duration=r,this._delay=i,this._easing=a,this._fillMode=o,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=function(e){return u._handleCallback(e)}}return ip(e,[{key:"apply",value:function(){(function(e,t){var n=NF(e,"").trim();n.length&&(function(e,t){for(var n=0,r=0;r<e.length;r++)","===e.charAt(r)&&n++}(n),t="".concat(n,", ").concat(t)),RF(e,"",t)})(this._element,"".concat(this._duration,"ms ").concat(this._easing," ").concat(this._delay,"ms 1 normal ").concat(this._fillMode," ").concat(this._name)),AF(this._element,this._eventFn,!1),this._startTime=Date.now()}},{key:"pause",value:function(){TF(this._element,this._name,"paused")}},{key:"resume",value:function(){TF(this._element,this._name,"running")}},{key:"setPosition",value:function(e){var t=IF(this._element,this._name);this._position=e*this._duration,RF(this._element,"Delay","-".concat(this._position,"ms"),t)}},{key:"getPosition",value:function(){return this._position}},{key:"_handleCallback",value:function(e){var t=e._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}},{key:"finish",value:function(){this._finished||(this._finished=!0,this._onDoneFn(),AF(this._element,this._eventFn,!0))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.finish(),function(e,t){var n=NF(e,"").split(","),r=xF(n,t);r>=0&&(n.splice(r,1),RF(e,"",n.join(",")))}(this._element,this._name))}}]),e}();function TF(e,t,n){RF(e,"PlayState",n,IF(e,t))}function IF(e,t){var n=NF(e,"");return n.indexOf(",")>0?xF(n.split(","),t):xF([n],t)}function xF(e,t){for(var n=0;n<e.length;n++)if(e[n].indexOf(t)>=0)return n;return-1}function AF(e,t,n){n?e.removeEventListener(PF,t):e.addEventListener(PF,t)}function RF(e,t,n,r){var i=SF+t;if(null!=r){var a=e.style[i];if(a.length){var o=a.split(",");o[r]=n,n=o.join(",")}}e.style[i]=n}function NF(e,t){return e.style[SF+t]||""}var MF=function(){function e(t,n,r,i,a,o,s,u){np(this,e),this.element=t,this.keyframes=n,this.animationName=r,this._duration=i,this._delay=a,this._finalStyles=s,this._specialStyles=u,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this.currentSnapshot={},this._state=0,this.easing=o||"linear",this.totalTime=i+a,this._buildStyler()}return ip(e,[{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"destroy",value:function(){this.init(),!(this._state>=4)&&(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"_flushDoneFns",value:function(){this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[]}},{key:"_flushStartFns",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"finish",value:function(){this.init(),!(this._state>=3)&&(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}},{key:"setPosition",value:function(e){this._styler.setPosition(e)}},{key:"getPosition",value:function(){return this._styler.getPosition()}},{key:"hasStarted",value:function(){return this._state>=2}},{key:"init",value:function(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}},{key:"play",value:function(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}},{key:"pause",value:function(){this.init(),this._styler.pause()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"reset",value:function(){this._state=0,this._styler.destroy(),this._buildStyler(),this._styler.apply()}},{key:"_buildStyler",value:function(){var e=this;this._styler=new OF(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",function(){return e.finish()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}},{key:"beforeDestroy",value:function(){var e=this;this.init();var t={};if(this.hasStarted()){var n=this._state>=3;Object.keys(this._finalStyles).forEach(function(r){"offset"!=r&&(t[r]=n?e._finalStyles[r]:yL(e.element,r))})}this.currentSnapshot=t}}]),e}(),DF=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this)).element=e,i._startingStyles={},i.__initialized=!1,i._styles=HD(r),i}return ip(n,[{key:"init",value:function(){var e=this;this.__initialized||!this._startingStyles||(this.__initialized=!0,Object.keys(this._styles).forEach(function(t){e._startingStyles[t]=e.element.style[t]}),Hv(Kv(n.prototype),"init",this).call(this))}},{key:"play",value:function(){var e=this;!this._startingStyles||(this.init(),Object.keys(this._styles).forEach(function(t){return e.element.style.setProperty(t,e._styles[t])}),Hv(Kv(n.prototype),"play",this).call(this))}},{key:"destroy",value:function(){var e=this;!this._startingStyles||(Object.keys(this._startingStyles).forEach(function(t){var n=e._startingStyles[t];n?e.element.style.setProperty(t,n):e.element.style.removeProperty(t)}),this._startingStyles=null,Hv(Kv(n.prototype),"destroy",this).call(this))}}]),n}(wD),LF=function(){function e(){np(this,e),this._count=0}return ip(e,[{key:"validateStyleProperty",value:function(e){return BD(e)}},{key:"matchesElement",value:function(e,t){return VD(e,t)}},{key:"containsElement",value:function(e,t){return UD(e,t)}},{key:"query",value:function(e,t,n){return zD(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"buildKeyframeElement",value:function(e,t,n){n=n.map(function(e){return HD(e)});var r="@keyframes ".concat(t," {\n"),i="";n.forEach(function(e){i=" ";var t=parseFloat(e.offset);r+="".concat(i).concat(100*t,"% {\n"),i+=" ",Object.keys(e).forEach(function(t){var n=e[t];switch(t){case"offset":return;case"easing":return void(n&&(r+="".concat(i,"animation-timing-function: ").concat(n,";\n")));default:return void(r+="".concat(i).concat(t,": ").concat(n,";\n"))}}),r+="".concat(i,"}\n")}),r+="}\n";var a=document.createElement("style");return a.textContent=r,a}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=a.filter(function(e){return e instanceof MF}),s={};vL(n,r)&&o.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return s[e]=t[e]})});var u=function(e){var t={};return e&&(Array.isArray(e)?e:[e]).forEach(function(e){Object.keys(e).forEach(function(n){"offset"==n||"easing"==n||(t[n]=e[n])})}),t}(t=pL(e,t,s));if(0==n)return new DF(e,u);var c="gen_css_kf_"+this._count++,l=this.buildKeyframeElement(e,c,t);(function(e){var t,n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e);return"undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot?n:document.head})(e).appendChild(l);var h=wF(e,t),f=new MF(e,t,c,n,r,i,u,h);return f.onDestroy(function(){var e;(e=l).parentNode.removeChild(e)}),f}}]),e}(),FF=function(){function e(t,n,r,i){np(this,e),this.element=t,this.keyframes=n,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}return ip(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this._buildPlayer(),this._preparePlayerBeforeStart()}},{key:"_buildPlayer",value:function(){var e=this;if(!this._initialized){this._initialized=!0;var t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",function(){return e._onFinish()})}}},{key:"_preparePlayerBeforeStart",value:function(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}},{key:"_triggerWebAnimation",value:function(e,t,n){return e.animate(t,n)}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"play",value:function(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}},{key:"pause",value:function(){this.init(),this.domPlayer.pause()}},{key:"finish",value:function(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}},{key:"reset",value:function(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"_resetDomPlayerState",value:function(){this.domPlayer&&this.domPlayer.cancel()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"hasStarted",value:function(){return this._started}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"setPosition",value:function(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}},{key:"getPosition",value:function(){return this.domPlayer.currentTime/this.time}},{key:"totalTime",get:function(){return this._delay+this._duration}},{key:"beforeDestroy",value:function(){var e=this,t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(function(n){"offset"!=n&&(t[n]=e._finished?e._finalKeyframe[n]:yL(e.element,n))}),this.currentSnapshot=t}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),BF=function(){function e(){np(this,e),this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(VF().toString()),this._cssKeyframesDriver=new LF}return ip(e,[{key:"validateStyleProperty",value:function(e){return BD(e)}},{key:"matchesElement",value:function(e,t){return VD(e,t)}},{key:"containsElement",value:function(e,t){return UD(e,t)}},{key:"query",value:function(e,t,n){return zD(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"overrideWebAnimationsSupport",value:function(e){this._isNativeImpl=e}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=arguments.length>6?arguments[6]:void 0;if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,n,r,i,a);var s={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(s.easing=i);var u={},c=a.filter(function(e){return e instanceof FF});vL(n,r)&&c.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return u[e]=t[e]})});var l=wF(e,t=pL(e,t=t.map(function(e){return tL(e,!1)}),u));return new FF(e,t,s,l)}}]),e}();function VF(){return bD()&&Element.prototype.animate||{}}var UF=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this))._nextAnimationId=0,i._renderer=e.createRenderer(r.body,{id:"0",encapsulation:Ug.None,styles:[],data:{animation:[]}}),i}return ip(n,[{key:"build",value:function(e){var t=this._nextAnimationId.toString();this._nextAnimationId++;var n=Array.isArray(e)?mD(e):e;return GF(this._renderer,null,t,"register",[n]),new zF(t,this._renderer)}}]),n}(gD);return e.\u0275fac=function(t){return new(t||e)(Ok(oS),Ok(TO))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),zF=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this))._id=e,i._renderer=r,i}return ip(n,[{key:"create",value:function(e,t){return new HF(this._id,e,t||{},this._renderer)}}]),n}(function(){return ip(function e(){np(this,e)})}()),HF=function(){function e(t,n,r,i){np(this,e),this.id=t,this.element=n,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}return ip(e,[{key:"_listen",value:function(e,t){return this._renderer.listen(this.element,"@@".concat(this.id,":").concat(e),t)}},{key:"_command",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return GF(this._renderer,this.element,this.id,e,n)}},{key:"onDone",value:function(e){this._listen("done",e)}},{key:"onStart",value:function(e){this._listen("start",e)}},{key:"onDestroy",value:function(e){this._listen("destroy",e)}},{key:"init",value:function(){this._command("init")}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this._command("play"),this._started=!0}},{key:"pause",value:function(){this._command("pause")}},{key:"restart",value:function(){this._command("restart")}},{key:"finish",value:function(){this._command("finish")}},{key:"destroy",value:function(){this._command("destroy")}},{key:"reset",value:function(){this._command("reset"),this._started=!1}},{key:"setPosition",value:function(e){this._command("setPosition",e)}},{key:"getPosition",value:function(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}]),e}();function GF(e,t,n,r,i){return e.setProperty(t,"@@".concat(n,":").concat(r),i)}var qF="@.disabled",$F=function(){var e=function(){function e(t,n,r){np(this,e),this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=function(e,t){t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}return ip(e,[{key:"createRenderer",value:function(e,t){var n=this,r=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){var i=this._rendererCache.get(r);return i||(i=new WF("",r,this.engine),this._rendererCache.set(r,i)),i}var a=t.id,o=t.id+"-"+this._currentId;this._currentId++,this.engine.register(o,e);return t.data.animation.forEach(function t(r){Array.isArray(r)?r.forEach(t):n.engine.registerTrigger(a,o,e,r.name,r)}),new jF(this,o,r,this.engine)}},{key:"begin",value:function(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}},{key:"_scheduleCountTask",value:function(){var e=this;this.promise.then(function(){e._microtaskId++})}},{key:"scheduleListenerCallback",value:function(e,t,n){var r=this;e>=0&&e<this._microtaskId?this._zone.run(function(){return t(n)}):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(function(){r._zone.run(function(){r._animationCallbacksBuffer.forEach(function(e){var t=Fv(e,2);(0,t[0])(t[1])}),r._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([t,n]))}},{key:"end",value:function(){var e=this;this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(function(){e._scheduleCountTask(),e.engine.flush(e._microtaskId)}),this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.engine.whenRenderingDone()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(oS),Ok(_F),Ok(JP))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),WF=function(){function e(t,n,r){np(this,e),this.namespaceId=t,this.delegate=n,this.engine=r,this.destroyNode=this.delegate.destroyNode?function(e){return n.destroyNode(e)}:null}return ip(e,[{key:"data",get:function(){return this.delegate.data}},{key:"destroy",value:function(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}},{key:"createElement",value:function(e,t){return this.delegate.createElement(e,t)}},{key:"createComment",value:function(e){return this.delegate.createComment(e)}},{key:"createText",value:function(e){return this.delegate.createText(e)}},{key:"appendChild",value:function(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}},{key:"insertBefore",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}},{key:"removeChild",value:function(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}},{key:"selectRootElement",value:function(e,t){return this.delegate.selectRootElement(e,t)}},{key:"parentNode",value:function(e){return this.delegate.parentNode(e)}},{key:"nextSibling",value:function(e){return this.delegate.nextSibling(e)}},{key:"setAttribute",value:function(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}},{key:"removeAttribute",value:function(e,t,n){this.delegate.removeAttribute(e,t,n)}},{key:"addClass",value:function(e,t){this.delegate.addClass(e,t)}},{key:"removeClass",value:function(e,t){this.delegate.removeClass(e,t)}},{key:"setStyle",value:function(e,t,n,r){this.delegate.setStyle(e,t,n,r)}},{key:"removeStyle",value:function(e,t,n){this.delegate.removeStyle(e,t,n)}},{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)&&t==qF?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}},{key:"setValue",value:function(e,t){this.delegate.setValue(e,t)}},{key:"listen",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"disableAnimations",value:function(e,t){this.engine.disableAnimations(e,t)}}]),e}(),jF=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a){var o;return np(this,n),(o=t.call(this,r,i,a)).factory=e,o.namespaceId=r,o}return ip(n,[{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==qF?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}},{key:"listen",value:function(e,t,n){var r=this;if("@"==t.charAt(0)){var i,a=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e),o=t.substr(1),s="";return"@"!=o.charAt(0)&&(o=(i=Fv(function(e){var t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(o),2))[0],s=i[1]),this.engine.listen(this.namespaceId,a,o,s,function(e){r.factory.scheduleListenerCallback(e._data||-1,n,e)})}return this.delegate.listen(e,t,n)}}]),n}(WF),ZF=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){return np(this,n),t.call(this,e.body,r,i)}return ip(n,[{key:"ngOnDestroy",value:function(){this.flush()}}]),n}(_F);return e.\u0275fac=function(t){return new(t||e)(Ok(TO),Ok(qD),Ok(UL))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac}),e}(),YF=new sk("AnimationModuleType"),KF=[{provide:gD,useClass:UF},{provide:UL,useFactory:function(){return new zL}},{provide:_F,useClass:ZF},{provide:oS,useFactory:function(e,t,n){return new $F(e,t,n)},deps:[cI,_F,JP]}],JF=[{provide:qD,useFactory:function(){return"function"==typeof VF()?new BF:new LF}},{provide:YF,useValue:"BrowserAnimations"}].concat(KF),QF=[{provide:qD,useClass:GD},{provide:YF,useValue:"NoopAnimations"}].concat(KF),XF=function(){var e=function(){function e(){np(this,e)}return ip(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:t.disableAnimations?QF:JF}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ay({type:e}),e.\u0275inj=Pg({providers:JF,imports:[bI]}),e}(),eB=Vv(9575),tB=Vv.n(eB);function nB(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function rB(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){nB(a,r,i,o,s,"next",e)}function s(e){nB(a,r,i,o,s,"throw",e)}o(void 0)})}}var iB=function(){function e(){np(this,e)}return ip(e,null,[{key:"expectToBe",value:function(e,t,n){if(e!==t)throw void 0!==n?new Error(n):new Error("A default switch case did not observe the correct value, expected ".concat(t,", but got ").concat(e," instead."))}},{key:"expectToBeMultiple",value:function(e,t){var n,r=!1,i=Xv(t);try{for(i.s();!(n=i.n()).done;){if(e===n.value){r=!0;break}}}catch(a){i.e(a)}finally{i.f()}if(!1===r)throw new Error("A default switch case did not observe the correct value, expected a value among ".concat(t,", but got ").concat(e," instead."))}},{key:"getNonNullable",value:function(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}}]),e}();function aB(e,t){e&&console.log(t)}function oB(e,t){if(null!=e&&null!=t&&"object"==typeof e){if(null!=e.equals)return e.equals(t);for(var n=e,r=t,i=0,a=Object.keys(n);i<a.length;i++){var o=a[i];if(!(o in r))return!1;if(!1===oB(n[o],r[o]))return!1}return!0}return e===t}function sB(e){return null==e||function(e){return"object"==typeof e&&null!=e&&null!=e.equals}(e)||function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e}(e)||function(e){if("object"==typeof e){for(var t in e)if(null!=e[t]&&!1===sB(e[t]))return!1;return null!=e&&e.constructor.prototype===Object.prototype}return!1}(e)}function uB(e,t){if(sB(e)&&sB(t))return oB(e,t);throw new Error("Comparing non comparable objects: ".concat(e.constructor.name," and ").concat(t.constructor.name))}var cB=function(){function e(t){np(this,e),this.value=t}return ip(e,[{key:"isPresent",value:function(){return null!=this.value}},{key:"isAbsent",value:function(){return null==this.value}},{key:"get",value:function(){if(this.isPresent())return this.value;throw new Error("Value is absent")}},{key:"getOrElse",value:function(e){return this.isPresent()?this.value:e}},{key:"equals",value:function(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&uB(this.value,e.value)}},{key:"equalsValue",value:function(t){return this.equals(e.of(t))}},{key:"toString",value:function(){return this.isAbsent()?"MGPOptional.empty()":"MGPOptional.of(".concat(this.value,")")}},{key:"map",value:function(t){return this.isPresent()?e.of(t(this.get())):e.empty()}}],[{key:"of",value:function(t){return new e(t)}},{key:"ofNullable",value:function(t){return null==t?e.empty():e.of(t)}},{key:"empty",value:function(){return new e(null)}}]),e}(),lB=function(e,t){if(!e)throw hB(t)},hB=function(e){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+e)},fB=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},dB={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,s=o?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=(15&s)<<2|c>>6,h=63&c;u||(h=64,o||(l=64)),r.push(n[a>>2],n[(3&a)<<4|s>>4],n[l],n[h])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(fB(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==s||null==u)throw Error();r.push(a<<2|o>>4),64!==s&&(r.push(o<<4&240|s>>2),64!==u&&r.push(s<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},vB=function(e){var t=fB(e);return dB.encodeByteArray(t,!0)},pB=function(e){return vB(e).replace(/\./g,"")},gB=function(e){try{return dB.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function yB(e){return mB(void 0,e)}function mB(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)!t.hasOwnProperty(n)||!kB(n)||(e[n]=mB(e[n],t[n]));return e}function kB(e){return"__proto__"!==e}var _B=function(){function e(){var t=this;np(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return ip(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch(function(){}),1===e.length?e(n):e(n,r))}}}]),e}();function wB(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[pB(JSON.stringify({alg:"none",type:"JWT"})),pB(JSON.stringify(a)),""].join(".")}function CB(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function bB(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(CB())}function EB(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function SB(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function PB(){var e=CB();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function OB(){return"object"==typeof indexedDB}function TB(){return new Promise(function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}function IB(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}var xB=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,r)).code=e,a.customData=i,a.name="FirebaseError",Object.setPrototypeOf(Zv(a),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(Zv(a),AB.prototype.create),a}return ip(n)}(Uv(Error)),AB=function(){function e(t,n,r){np(this,e),this.service=t,this.serviceName=n,this.errors=r}return ip(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(RB,function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error";return new xB(n,"".concat(this.serviceName,": ").concat(i," (").concat(n,")."),t)}}]),e}(),RB=/\{\$([^}]+)}/g;function NB(e){return JSON.parse(e)}function MB(e){return JSON.stringify(e)}var DB=function(e){var t={},n={},r={},i="";try{var a=e.split(".");t=NB(gB(a[0])||""),n=NB(gB(a[1])||""),i=a[2],r=n.d||{},delete n.d}catch(o){}return{header:t,claims:n,data:r,signature:i}};function LB(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function FB(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}function BB(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function VB(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function UB(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),i=0,a=n;i<a.length;i++){var o=a[i];if(!r.includes(o))return!1;var s=e[o],u=t[o];if(zB(s)&&zB(u)){if(!UB(s,u))return!1}else if(s!==u)return!1}for(var c=0,l=r;c<l.length;c++){var h=l[c];if(!n.includes(h))return!1}return!0}function zB(e){return null!==e&&"object"==typeof e}function HB(e){for(var t=[],n=function(){var e=Fv(i[r],2),n=e[0],a=e[1];Array.isArray(a)?a.forEach(function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))},r=0,i=Object.entries(e);r<i.length;r++)n();return t.length?"&"+t.join("&"):""}function GB(e){var t={};return e.replace(/^\?/,"").split("&").forEach(function(e){if(e){var n=Fv(e.split("="),2),r=n[0],i=n[1];t[decodeURIComponent(r)]=decodeURIComponent(i)}}),t}function qB(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}var $B=function(){function e(){np(this,e),this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return ip(e,[{key:"reset",value:function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}},{key:"compress_",value:function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(var i=0;i<16;i++)n[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(var a=16;a<80;a++){var o=n[a-3]^n[a-8]^n[a-14]^n[a-16];n[a]=4294967295&(o<<1|o>>>31)}for(var s,u,c=this.chain_[0],l=this.chain_[1],h=this.chain_[2],f=this.chain_[3],d=this.chain_[4],v=0;v<80;v++){v<40?v<20?(s=f^l&(h^f),u=1518500249):(s=l^h^f,u=1859775393):v<60?(s=l&h|f&(l|h),u=2400959708):(s=l^h^f,u=3395469782);var p=(c<<5|c>>>27)+s+d+u+n[v]&4294967295;d=f,f=h,h=4294967295&(l<<30|l>>>2),l=c,c=p}this.chain_[0]=this.chain_[0]+c&4294967295,this.chain_[1]=this.chain_[1]+l&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+f&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295}},{key:"update",value:function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,a=this.inbuf_;r<t;){if(0===a)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[a]=e.charCodeAt(r),++r,++a===this.blockSize){this.compress_(i),a=0;break}}else for(;r<t;)if(i[a]=e[r],++r,++a===this.blockSize){this.compress_(i),a=0;break}}this.inbuf_=a,this.total_+=t}}},{key:"digest",value:function(){var e=[],t=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);for(var r=0,i=0;i<5;i++)for(var a=24;a>=0;a-=8)e[r]=this.chain_[i]>>a&255,++r;return e}}]),e}(),WB=function(){function e(t,n){var r=this;np(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(function(){t(r)}).catch(function(e){r.error(e)})}return ip(e,[{key:"next",value:function(e){this.forEachObserver(function(t){t.next(e)})}},{key:"error",value:function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)}},{key:"complete",value:function(){this.forEachObserver(function(e){e.complete()}),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e)?e:{next:e,error:t,complete:n}).next&&(r.next=jB),void 0===r.error&&(r.error=jB),void 0===r.complete&&(r.complete=jB);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))}}]),e}();function jB(){}function ZB(e,t){return"".concat(e," failed: ").concat(t," argument ")}var YB=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function KB(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}function JB(e){return e&&e._delegate?e._delegate:e}var QB=function(){function e(t,n,r){np(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return ip(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),XB="[DEFAULT]",eV=function(){function e(t,n){np(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return ip(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new _B;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:XB})}catch(u){}var t,n=Xv(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=Fv(t.value,2),i=r[0],a=r[1],o=this.normalizeInstanceIdentifier(i);try{var s=this.getOrInitializeService({instanceIdentifier:o});a.resolve(s)}catch(c){}}}catch(l){n.e(l)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:XB;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Array.from(e.instances.values()),t.next=3,Promise.all([].concat(Jv(n.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()})),Jv(n.filter(function(e){return"_delete"in e}).map(function(e){return e._delete()}))));case 3:case"end":return t.stop()}},t)}))()}},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:XB;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:XB;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i,a=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=Xv(this.instancesDeferred.entries());try{for(o.s();!(i=o.n()).done;){var s=Fv(i.value,2),u=s[0],c=s[1];r===this.normalizeInstanceIdentifier(u)&&c.resolve(a)}}catch(l){o.e(l)}finally{o.f()}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,i=Xv(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;try{a(e,t)}catch(o){}}}catch(s){i.e(s)}finally{i.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===XB?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(o){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:XB;return this.component?this.component.multipleInstances?e:XB:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}(),tV=function(){function e(t){np(this,e),this.name=t,this.providers=new Map}return ip(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new eV(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),nV=[],rV=function(){return(e=rV||(rV={}))[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",rV;var e}(),iV={debug:rV.DEBUG,verbose:rV.VERBOSE,info:rV.INFO,warn:rV.WARN,error:rV.ERROR,silent:rV.SILENT},aV=rV.INFO,oV=(Lv(Gv={},rV.DEBUG,"log"),Lv(Gv,rV.VERBOSE,"log"),Lv(Gv,rV.INFO,"info"),Lv(Gv,rV.WARN,"warn"),Lv(Gv,rV.ERROR,"error"),Gv),sV=function(e,t){var n;if(!(t<e.logLevel)){var r=(new Date).toISOString(),i=oV[t];if(!i)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a=arguments.length,o=new Array(a>2?a-2:0),s=2;s<a;s++)o[s-2]=arguments[s];(n=console)[i].apply(n,["[".concat(r,"]  ").concat(e.name,":")].concat(o))}},uV=function(){function e(t){np(this,e),this.name=t,this._logLevel=aV,this._logHandler=sV,this._userLogHandler=null,nV.push(this)}return ip(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in rV))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"==typeof e?iV[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,rV.DEBUG].concat(t)),this._logHandler.apply(this,[this,rV.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,rV.VERBOSE].concat(t)),this._logHandler.apply(this,[this,rV.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,rV.INFO].concat(t)),this._logHandler.apply(this,[this,rV.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,rV.WARN].concat(t)),this._logHandler.apply(this,[this,rV.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,rV.ERROR].concat(t)),this._logHandler.apply(this,[this,rV.ERROR].concat(t))}}]),e}(),cV=function(){function e(t){np(this,e),this.container=t}return ip(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map(function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(function(e){return e}).join(" ")}}]),e}(),lV="@firebase/app",hV=new uV("@firebase/app"),fV="[DEFAULT]",dV=(Lv($v={},lV,"fire-core"),Lv($v,"@firebase/app-compat","fire-core-compat"),Lv($v,"@firebase/analytics","fire-analytics"),Lv($v,"@firebase/analytics-compat","fire-analytics-compat"),Lv($v,"@firebase/app-check","fire-app-check"),Lv($v,"@firebase/app-check-compat","fire-app-check-compat"),Lv($v,"@firebase/auth","fire-auth"),Lv($v,"@firebase/auth-compat","fire-auth-compat"),Lv($v,"@firebase/database","fire-rtdb"),Lv($v,"@firebase/database-compat","fire-rtdb-compat"),Lv($v,"@firebase/functions","fire-fn"),Lv($v,"@firebase/functions-compat","fire-fn-compat"),Lv($v,"@firebase/installations","fire-iid"),Lv($v,"@firebase/installations-compat","fire-iid-compat"),Lv($v,"@firebase/messaging","fire-fcm"),Lv($v,"@firebase/messaging-compat","fire-fcm-compat"),Lv($v,"@firebase/performance","fire-perf"),Lv($v,"@firebase/performance-compat","fire-perf-compat"),Lv($v,"@firebase/remote-config","fire-rc"),Lv($v,"@firebase/remote-config-compat","fire-rc-compat"),Lv($v,"@firebase/storage","fire-gcs"),Lv($v,"@firebase/storage-compat","fire-gcs-compat"),Lv($v,"@firebase/firestore","fire-fst"),Lv($v,"@firebase/firestore-compat","fire-fst-compat"),Lv($v,"fire-js","fire-js"),Lv($v,"firebase","fire-js-all"),$v),vV=new Map,pV=new Map;function gV(e,t){try{e.container.addComponent(t)}catch(n){hV.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function yV(e){var t=e.name;if(pV.has(t))return hV.debug("There were multiple attempts to register component ".concat(t,".")),!1;pV.set(t,e);var n,r=Xv(vV.values());try{for(r.s();!(n=r.n()).done;){gV(n.value,e)}}catch(i){r.e(i)}finally{r.f()}return!0}function mV(e,t){return e.container.getProvider(t)}var kV=new AB("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."}),_V=function(){function e(t,n,r){var i=this;np(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new QB("app",function(){return i},"PUBLIC"))}return ip(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw kV.create("app-deleted",{appName:this._name})}}]),e}(),wV="9.6.6";function CV(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fV,t=vV.get(e);if(!t)throw kV.create("no-app",{appName:e});return t}function bV(){return Array.from(vV.values())}function EV(e,t,n){var r,i=null!==(r=dV[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var s=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&s.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&s.push("and"),o&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void hV.warn(s.join(" "))}yV(new QB("".concat(i,"-version"),function(){return{library:i,version:t}},"VERSION"))}yV(new QB("platform-logger",function(e){return new cV(e)},"PRIVATE")),EV(lV,"0.7.16",""),EV(lV,"0.7.16","esm2017"),EV("fire-js",""),EV("firebase","9.6.6","app");var SV=Vv(6676),PV="@firebase/installations",OV="w:0.5.5",TV="FIS_v2",IV=new AB("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function xV(e){return e instanceof xB&&e.code.includes("request-failed")}function AV(e){var t=e.projectId;return"https://firebaseinstallations.googleapis.com/v1/projects/".concat(t,"/installations")}function RV(e){return{token:e.token,requestStatus:2,expiresIn:VV(e.expiresIn),creationTime:Date.now()}}function NV(e,t){return MV.apply(this,arguments)}function MV(){return(MV=rB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:return r=e.sent.error,e.abrupt("return",IV.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status}));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function DV(e){var t=e.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function LV(e,t){var n=t.refreshToken,r=DV(e);return r.append("Authorization",function(e){return"".concat(TV," ").concat(e)}(n)),r}function FV(e){return BV.apply(this,arguments)}function BV(){return(BV=rB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return n=e.sent,e.abrupt("return",n.status>=500&&n.status<600?t():n);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function VV(e){return Number(e.replace("s","000"))}function UV(e,t){return zV.apply(this,arguments)}function zV(){return(zV=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.fid,i=AV(t),a={method:"POST",headers:DV(t),body:JSON.stringify({fid:r,authVersion:TV,appId:t.appId,sdkVersion:OV})},e.next=5,FV(function(){return fetch(i,a)});case 5:if(!(o=e.sent).ok){e.next=11;break}return e.next=9,o.json();case 9:return s=e.sent,e.abrupt("return",{fid:s.fid||r,registrationStatus:2,refreshToken:s.refreshToken,authToken:RV(s.authToken)});case 11:return e.next=13,NV("Create Installation",o);case 13:throw e.sent;case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function HV(e){return new Promise(function(t){setTimeout(t,e)})}var GV=/^[cdef][\w-]{21}$/;function qV(){try{var e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;var t=function(e){return function(e){return btoa(String.fromCharCode.apply(String,Jv(e))).replace(/\+/g,"-").replace(/\//g,"_")}(e).substr(0,22)}(e);return GV.test(t)?t:""}catch(n){return""}}function $V(e){return"".concat(e.appName,"!").concat(e.appId)}var WV=new Map;function jV(e,t){var n=$V(e);ZV(n,t),function(e,t){var n=(!YV&&"BroadcastChannel"in self&&((YV=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(e){ZV(e.data.key,e.data.fid)}),YV);n&&n.postMessage({key:e,fid:t}),0===WV.size&&YV&&(YV.close(),YV=null)}(n,t)}function ZV(e,t){var n=WV.get(e);if(n){var r,i=Xv(n);try{for(i.s();!(r=i.n()).done;){(0,r.value)(t)}}catch(a){i.e(a)}finally{i.f()}}}var YV=null,KV="firebase-installations-store",JV=null;function QV(){return JV||(JV=(0,SV.openDb)("firebase-installations-database",1,function(e){switch(e.oldVersion){case 0:e.createObjectStore(KV)}})),JV}function XV(e,t){return eU.apply(this,arguments)}function eU(){return(eU=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=$V(t),e.next=3,QV();case 3:return i=e.sent.transaction(KV,"readwrite"),a=i.objectStore(KV),e.next=7,a.get(r);case 7:return o=e.sent,e.next=10,a.put(n,r);case 10:return e.next=12,i.complete;case 12:return(!o||o.fid!==n.fid)&&jV(t,n.fid),e.abrupt("return",n);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function tU(e){return nU.apply(this,arguments)}function nU(){return(nU=rB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=$V(t),e.next=3,QV();case 3:return r=e.sent.transaction(KV,"readwrite"),e.next=6,r.objectStore(KV).delete(n);case 6:return e.next=8,r.complete;case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function rU(e,t){return iU.apply(this,arguments)}function iU(){return(iU=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=$V(t),e.next=3,QV();case 3:return i=e.sent.transaction(KV,"readwrite"),a=i.objectStore(KV),e.next=7,a.get(r);case 7:if(o=e.sent,void 0!==(s=n(o))){e.next=14;break}return e.next=12,a.delete(r);case 12:e.next=16;break;case 14:return e.next=16,a.put(s,r);case 16:return e.next=18,i.complete;case 18:return s&&(!o||o.fid!==s.fid)&&jV(t,s.fid),e.abrupt("return",s);case 20:case"end":return e.stop()}},e)}))).apply(this,arguments)}function aU(e){return oU.apply(this,arguments)}function oU(){return(oU=rB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rU(t,function(e){var r=sU(e),i=uU(t,r);return n=i.registrationPromise,i.installationEntry});case 2:if(""!==(r=e.sent).fid){e.next=10;break}return e.next=6,n;case 6:e.t1=e.sent,e.t0={installationEntry:e.t1},e.next=11;break;case 10:e.t0={installationEntry:r,registrationPromise:n};case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function sU(e){return dU(e||{fid:qV(),registrationStatus:0})}function uU(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(IV.create("app-offline"))};var n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:function(e,t){return cU.apply(this,arguments)}(e,n)}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:lU(e)}:{installationEntry:t}}function cU(){return(cU=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=XV,e.t1=t,e.next=5,UV(t,n);case 5:return e.t2=e.sent,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 9:if(e.prev=9,e.t3=e.catch(0),!xV(e.t3)||409!==e.t3.customData.serverCode){e.next=16;break}return e.next=14,tU(t);case 14:e.next=18;break;case 16:return e.next=18,XV(t,{fid:n.fid,registrationStatus:0});case 18:throw e.t3;case 19:case"end":return e.stop()}},e,null,[[0,9]])}))).apply(this,arguments)}function lU(e){return hU.apply(this,arguments)}function hU(){return(hU=rB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fU(t);case 2:n=e.sent;case 3:if(1!==n.registrationStatus){e.next=11;break}return e.next=6,HV(100);case 6:return e.next=8,fU(t);case 8:n=e.sent;case 9:e.next=3;break;case 11:if(0!==n.registrationStatus){e.next=18;break}return e.next=14,aU(t);case 14:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",a||i);case 18:return e.abrupt("return",n);case 19:case"end":return e.stop()}},e)}))).apply(this,arguments)}function fU(e){return rU(e,function(e){if(!e)throw IV.create("installation-not-found");return dU(e)})}function dU(e){return function(e){return 1===e.registrationStatus&&e.registrationTime+1e4<Date.now()}(e)?{fid:e.fid,registrationStatus:0}:e}function vU(e,t){return pU.apply(this,arguments)}function pU(){return(pU=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.appConfig,i=t.platformLoggerProvider,a=gU(r,n),o=LV(r,n),(s=i.getImmediate({optional:!0}))&&o.append("x-firebase-client",s.getPlatformInfoString()),u={method:"POST",headers:o,body:JSON.stringify({installation:{sdkVersion:OV}})},e.next=6,FV(function(){return fetch(a,u)});case 6:if(!(c=e.sent).ok){e.next=13;break}return e.t0=RV,e.next=11,c.json();case 11:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 13:return e.next=15,NV("Generate Auth Token",c);case 15:throw e.sent;case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function gU(e,t){var n=t.fid;return"".concat(AV(e),"/").concat(n,"/authTokens:generate")}function yU(e){return mU.apply(this,arguments)}function mU(){return(mU=rB(regeneratorRuntime.mark(function e(t){var n,r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]&&a[1],e.next=3,rU(t.appConfig,function(e){if(!EU(e))throw IV.create("not-registered");var i=e.authToken;if(!n&&SU(i))return e;if(1===i.requestStatus)return r=kU(t,n),e;if(!navigator.onLine)throw IV.create("app-offline");var a=PU(e);return r=CU(t,a),a});case 3:if(i=e.sent,!r){e.next=10;break}return e.next=7,r;case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=i.authToken;case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function kU(e,t){return _U.apply(this,arguments)}function _U(){return(_U=rB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,wU(t.appConfig);case 2:r=e.sent;case 3:if(1!==r.authToken.requestStatus){e.next=11;break}return e.next=6,HV(100);case 6:return e.next=8,wU(t.appConfig);case 8:r=e.sent;case 9:e.next=3;break;case 11:return i=r.authToken,e.abrupt("return",0===i.requestStatus?yU(t,n):i);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function wU(e){return rU(e,function(e){if(!EU(e))throw IV.create("not-registered");return function(e){return 1===e.requestStatus&&e.requestTime+1e4<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function CU(e,t){return bU.apply(this,arguments)}function bU(){return(bU=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,vU(t,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{authToken:r}),e.next=7,XV(t.appConfig,i);case 7:return e.abrupt("return",r);case 10:if(e.prev=10,e.t0=e.catch(0),xV(e.t0)&&(401===e.t0.customData.serverCode||404===e.t0.customData.serverCode)){e.next=18;break}return a=Object.assign(Object.assign({},n),{authToken:{requestStatus:0}}),e.next=16,XV(t.appConfig,a);case 16:e.next=20;break;case 18:return e.next=20,tU(t.appConfig);case 20:throw e.t0;case 21:case"end":return e.stop()}},e,null,[[0,10]])}))).apply(this,arguments)}function EU(e){return void 0!==e&&2===e.registrationStatus}function SU(e){return 2===e.requestStatus&&!function(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(e)}function PU(e){var t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}function OU(){return(OU=rB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,e.next=3,aU(n.appConfig);case 3:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",(a?a.catch(console.error):yU(n).catch(console.error),i.fid));case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function TU(){return(TU=rB(regeneratorRuntime.mark(function e(t){var n,r,i=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]&&i[1],r=t,e.next=4,IU(r.appConfig);case 4:return e.next=6,yU(r,n);case 6:return e.abrupt("return",e.sent.token);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function IU(e){return xU.apply(this,arguments)}function xU(){return(xU=rB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,aU(t);case 2:if(n=e.sent,r=n.registrationPromise,e.t0=r,!e.t0){e.next=8;break}return e.next=8,r;case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function AU(e){return IV.create("missing-app-config-values",{valueName:e})}var RU="installations";yV(new QB(RU,function(e){var t=e.getProvider("app").getImmediate();return{app:t,appConfig:function(e){if(!e||!e.options)throw AU("App Configuration");if(!e.name)throw AU("App Name");for(var t=0,n=["projectId","apiKey","appId"];t<n.length;t++){var r=n[t];if(!e.options[r])throw AU(r)}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t),platformLoggerProvider:mV(t,"platform-logger"),_delete:function(){return Promise.resolve()}}},"PUBLIC")),yV(new QB("installations-internal",function(e){var t=mV(e.getProvider("app").getImmediate(),RU).getImmediate();return{getId:function(){return function(e){return OU.apply(this,arguments)}(t)},getToken:function(e){return function(e){return TU.apply(this,arguments)}(t,e)}}},"PRIVATE")),EV(PV,"0.5.5"),EV(PV,"0.5.5","esm2017");var NU="@firebase/remote-config",MU=new AB("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"}),DU=function(){function e(t,n,r,i){np(this,e),this.client=t,this.storage=n,this.storageCache=r,this.logger=i}return ip(e,[{key:"isCachedDataFresh",value:function(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-t,r=n<=e;return this.logger.debug("Config fetch cache check. Cache age millis: ".concat(n,". Cache max age millis (minimumFetchIntervalMillis setting): ").concat(e,". Is cache hit: ").concat(r,".")),r}},{key:"fetch",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);case 2:if(r=n.sent,i=Fv(r,2),a=i[0],!(o=i[1])||!t.isCachedDataFresh(e.cacheMaxAgeMillis,a)){n.next=8;break}return n.abrupt("return",o);case 8:return e.eTag=o&&o.eTag,n.next=11,t.client.fetch(e);case 11:return s=n.sent,u=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===s.status&&u.push(t.storage.setLastSuccessfulFetchResponse(s)),n.next=16,Promise.all(u);case 16:return n.abrupt("return",s);case 17:case"end":return n.stop()}},n)}))()}}]),e}();function LU(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e.languages&&e.languages[0]||e.language}var FU=function(){function e(t,n,r,i,a,o){np(this,e),this.firebaseInstallations=t,this.sdkVersion=n,this.namespace=r,this.projectId=i,this.apiKey=a,this.appId=o}return ip(e,[{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l,h,f,d,v,p,g,y,m,k;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]);case 2:return r=n.sent,i=Fv(r,2),a=i[0],o=i[1],s="".concat(window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com","/v1/projects/").concat(t.projectId,"/namespaces/").concat(t.namespace,":fetch?key=").concat(t.apiKey),u={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},c={sdk_version:t.sdkVersion,app_instance_id:a,app_instance_id_token:o,app_id:t.appId,language_code:LU()},l={method:"POST",headers:u,body:JSON.stringify(c)},h=fetch(s,l),f=new Promise(function(t,n){e.signal.addEventListener(function(){var e=new Error("The operation was aborted.");e.name="AbortError",n(e)})}),n.prev=12,n.next=15,Promise.race([h,f]);case 15:return n.next=17,h;case 17:d=n.sent,n.next=24;break;case 20:throw n.prev=20,n.t0=n.catch(12),v="fetch-client-network","AbortError"===n.t0.name&&(v="fetch-timeout"),MU.create(v,{originalErrorMessage:n.t0.message});case 24:if(p=d.status,g=d.headers.get("ETag")||void 0,200!==d.status){n.next=37;break}return n.prev=27,n.next=30,d.json();case 30:k=n.sent,n.next=36;break;case 33:throw n.prev=33,n.t1=n.catch(27),MU.create("fetch-client-parse",{originalErrorMessage:n.t1.message});case 36:y=k.entries,m=k.state;case 37:if("INSTANCE_STATE_UNSPECIFIED"===m?p=500:"NO_CHANGE"===m?p=304:("NO_TEMPLATE"===m||"EMPTY_CONFIG"===m)&&(y={}),304===p||200===p){n.next=39;break}throw MU.create("fetch-status",{httpStatus:p});case 39:return n.abrupt("return",{status:p,eTag:g,config:y});case 40:case"end":return n.stop()}},n,null,[[12,20],[27,33]])}))()})}]),e}(),BU=function(){function e(t,n){np(this,e),this.client=t,this.storage=n}return ip(e,[{key:"fetch",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.storage.getThrottleMetadata();case 2:if(n.t0=n.sent,n.t0){n.next=5;break}n.t0={backoffCount:0,throttleEndTimeMillis:Date.now()};case 5:return r=n.t0,n.abrupt("return",t.attemptFetch(e,r));case 7:case"end":return n.stop()}},n)}))()}},{key:"attemptFetch",value:function(e,t){var n=t.throttleEndTimeMillis,r=t.backoffCount,i=this;return rB(regeneratorRuntime.mark(function t(){var a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r(MU.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(e.signal,n);case 2:return t.prev=2,t.next=5,i.client.fetch(e);case 5:return a=t.sent,t.next=8,i.storage.deleteThrottleMetadata();case 8:return t.abrupt("return",a);case 11:if(t.prev=11,t.t0=t.catch(2),function(e){if(!(e instanceof xB&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t.t0)){t.next=15;break}throw t.t0;case 15:return o={throttleEndTimeMillis:Date.now()+KB(r),backoffCount:r+1},t.next=18,i.storage.setThrottleMetadata(o);case 18:return t.abrupt("return",i.attemptFetch(e,o));case 19:case"end":return t.stop()}},t,null,[[2,11]])}))()}}]),e}(),VU=function(){function e(t,n,r,i,a){np(this,e),this.app=t,this._client=n,this._storageCache=r,this._storage=i,this._logger=a,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return ip(e,[{key:"fetchTimeMillis",get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}},{key:"lastFetchStatus",get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}]),e}();function UU(e,t){var n=e.target.error||void 0;return MU.create(t,{originalErrorMessage:n&&n.message})}var zU="app_namespace_store",HU=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Promise(function(e,t){try{var r=indexedDB.open("firebase_remote_config",1);r.onerror=function(e){t(UU(e,"storage-open"))},r.onsuccess=function(t){e(t.target.result)},r.onupgradeneeded=function(e){var t=e.target.result;switch(e.oldVersion){case 0:t.createObjectStore(zU,{keyPath:"compositeKey"})}}}catch(n){t(MU.create("storage-open",{originalErrorMessage:n}))}});np(this,e),this.appId=t,this.appName=n,this.namespace=r,this.openDbPromise=i}return ip(e,[{key:"getLastFetchStatus",value:function(){return this.get("last_fetch_status")}},{key:"setLastFetchStatus",value:function(e){return this.set("last_fetch_status",e)}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.get("last_successful_fetch_timestamp_millis")}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.set("last_successful_fetch_timestamp_millis",e)}},{key:"getLastSuccessfulFetchResponse",value:function(){return this.get("last_successful_fetch_response")}},{key:"setLastSuccessfulFetchResponse",value:function(e){return this.set("last_successful_fetch_response",e)}},{key:"getActiveConfig",value:function(){return this.get("active_config")}},{key:"setActiveConfig",value:function(e){return this.set("active_config",e)}},{key:"getActiveConfigEtag",value:function(){return this.get("active_config_etag")}},{key:"setActiveConfigEtag",value:function(e){return this.set("active_config_etag",e)}},{key:"getThrottleMetadata",value:function(){return this.get("throttle_metadata")}},{key:"setThrottleMetadata",value:function(e){return this.set("throttle_metadata",e)}},{key:"deleteThrottleMetadata",value:function(){return this.delete("throttle_metadata")}},{key:"get",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a=r.transaction([zU],"readonly").objectStore(zU),o=t.createCompositeKey(e);try{var s=a.get(o);s.onerror=function(e){i(UU(e,"storage-get"))},s.onsuccess=function(e){var t=e.target.result;n(t?t.value:void 0)}}catch(s){i(MU.create("storage-get",{originalErrorMessage:s&&s.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"set",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.openDbPromise;case 2:return i=r.sent,r.abrupt("return",new Promise(function(r,a){var o=i.transaction([zU],"readwrite").objectStore(zU),s=n.createCompositeKey(e);try{var u=o.put({compositeKey:s,value:t});u.onerror=function(e){a(UU(e,"storage-set"))},u.onsuccess=function(){r()}}catch(u){a(MU.create("storage-set",{originalErrorMessage:u&&u.message}))}}));case 4:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a=r.transaction([zU],"readwrite").objectStore(zU),o=t.createCompositeKey(e);try{var s=a.delete(o);s.onerror=function(e){i(UU(e,"storage-delete"))},s.onsuccess=function(){n()}}catch(s){i(MU.create("storage-delete",{originalErrorMessage:s&&s.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"createCompositeKey",value:function(e){return[this.appId,this.appName,this.namespace,e].join()}}]),e}(),GU=function(){function e(t){np(this,e),this.storage=t}return ip(e,[{key:"getLastFetchStatus",value:function(){return this.lastFetchStatus}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.lastSuccessfulFetchTimestampMillis}},{key:"getActiveConfig",value:function(){return this.activeConfig}},{key:"loadFromStorage",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.storage.getLastFetchStatus(),r=e.storage.getLastSuccessfulFetchTimestampMillis(),i=e.storage.getActiveConfig(),t.next=5,n;case 5:return(a=t.sent)&&(e.lastFetchStatus=a),t.next=9,r;case 9:return(o=t.sent)&&(e.lastSuccessfulFetchTimestampMillis=o),t.next=13,i;case 13:(s=t.sent)&&(e.activeConfig=s);case 15:case"end":return t.stop()}},t)}))()}},{key:"setLastFetchStatus",value:function(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}},{key:"setActiveConfig",value:function(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}]),e}();function qU(){return(qU=rB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(OB()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,TB();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}yV(new QB("remote-config",function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw MU.create("registration-window");if(!OB())throw MU.create("indexed-db-unavailable");var a=r.options,o=a.projectId,s=a.apiKey,u=a.appId;if(!o)throw MU.create("registration-project-id");if(!s)throw MU.create("registration-api-key");if(!u)throw MU.create("registration-app-id");var c=new HU(u,r.name,n=n||"firebase"),l=new GU(c),h=new uV(NU);h.logLevel=rV.ERROR;var f=new FU(i,wV,n,o,s,u),d=new BU(f,c),v=new DU(d,c,l,h),p=new VU(r,v,l,c,h);return function(e){var t=JB(e);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(function(){t._isInitializationComplete=!0}))}(p),p},"PUBLIC").setMultipleInstances(!0)),EV(NU,"0.3.4"),EV(NU,"0.3.4","esm2017");var $U="/firebase-messaging-sw.js",WU="/firebase-cloud-messaging-push-scope",jU="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",ZU="google.c.a.c_id",YU="google.c.a.c_l",KU="google.c.a.ts",JU="google.c.a.e",QU=(function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(QU||(QU={})),QU);function XU(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(String,Jv(t))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function ez(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}var tz="fcm_token_details_db",nz="fcm_token_object_Store";function rz(e){return iz.apply(this,arguments)}function iz(){return(iz=rB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0="databases"in indexedDB,!e.t0){e.next=5;break}return e.next=4,indexedDB.databases();case 4:e.t0=!e.sent.map(function(e){return e.name}).includes(tz);case 5:if(!e.t0){e.next=7;break}return e.abrupt("return",null);case 7:return n=null,e.next=10,(0,SV.openDb)(tz,5,function(){var e=rB(regeneratorRuntime.mark(function e(r){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.oldVersion<2)&&r.objectStoreNames.contains(nz)){e.next=2;break}return e.abrupt("return");case 2:return a=r.transaction.objectStore(nz),e.next=5,a.index("fcmSenderId").get(t);case 5:return o=e.sent,e.next=8,a.clear();case 8:if(!o){e.next=17;break}if(2!==r.oldVersion){e.next=16;break}if((s=o).auth&&s.p256dh&&s.endpoint){e.next=13;break}return e.abrupt("return");case 13:n={token:s.fcmToken,createTime:null!==(i=s.createTime)&&void 0!==i?i:Date.now(),subscriptionOptions:{auth:s.auth,p256dh:s.p256dh,endpoint:s.endpoint,swScope:s.swScope,vapidKey:"string"==typeof s.vapidKey?s.vapidKey:XU(s.vapidKey)}},e.next=17;break;case 16:3===r.oldVersion?n={token:(u=o).fcmToken,createTime:u.createTime,subscriptionOptions:{auth:XU(u.auth),p256dh:XU(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:XU(u.vapidKey)}}:4===r.oldVersion&&(n={token:(c=o).fcmToken,createTime:c.createTime,subscriptionOptions:{auth:XU(c.auth),p256dh:XU(c.p256dh),endpoint:c.endpoint,swScope:c.swScope,vapidKey:XU(c.vapidKey)}});case 17:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 10:return e.sent.close(),e.next=13,(0,SV.deleteDb)(tz);case 13:return e.next=15,(0,SV.deleteDb)("fcm_vapid_details_db");case 15:return e.next=17,(0,SV.deleteDb)("undefined");case 17:return e.abrupt("return",az(n)?n:null);case 18:case"end":return e.stop()}},e)}))).apply(this,arguments)}function az(e){if(!e||!e.subscriptionOptions)return!1;var t=e.subscriptionOptions;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}var oz="firebase-messaging-store",sz=null;function uz(){return sz||(sz=(0,SV.openDb)("firebase-messaging-database",1,function(e){switch(e.oldVersion){case 0:e.createObjectStore(oz)}})),sz}function cz(e){return lz.apply(this,arguments)}function lz(){return(lz=rB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=pz(t),e.next=3,uz();case 3:return e.next=5,e.sent.transaction(oz).objectStore(oz).get(n);case 5:if(!(r=e.sent)){e.next=8;break}return e.abrupt("return",r);case 8:return e.next=10,rz(t.appConfig.senderId);case 10:if(!(i=e.sent)){e.next=15;break}return e.next=14,hz(t,i);case 14:return e.abrupt("return",i);case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}function hz(e,t){return fz.apply(this,arguments)}function fz(){return(fz=rB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=pz(t),e.next=3,uz();case 3:return i=e.sent.transaction(oz,"readwrite"),e.next=6,i.objectStore(oz).put(n,r);case 6:return e.next=8,i.complete;case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function dz(e){return vz.apply(this,arguments)}function vz(){return(vz=rB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=pz(t),e.next=3,uz();case 3:return r=e.sent.transaction(oz,"readwrite"),e.next=6,r.objectStore(oz).delete(n);case 6:return e.next=8,r.complete;case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function pz(e){return e.appConfig.appId}var gz=new AB("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function yz(e,t){return mz.apply(this,arguments)}function mz(){return(mz=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ez(t);case 2:return r=e.sent,i=Pz(n),a={method:"POST",headers:r,body:JSON.stringify(i)},e.prev=5,e.next=8,fetch(bz(t.appConfig),a);case 8:return e.next=10,e.sent.json();case 10:o=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),gz.create("token-subscribe-failed",{errorInfo:e.t0});case 16:if(!o.error){e.next=18;break}throw gz.create("token-subscribe-failed",{errorInfo:o.error.message});case 18:if(o.token){e.next=20;break}throw gz.create("token-subscribe-no-token");case 20:return e.abrupt("return",o.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])}))).apply(this,arguments)}function kz(e,t){return _z.apply(this,arguments)}function _z(){return(_z=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ez(t);case 2:return r=e.sent,i=Pz(n.subscriptionOptions),a={method:"PATCH",headers:r,body:JSON.stringify(i)},e.prev=5,e.next=8,fetch("".concat(bz(t.appConfig),"/").concat(n.token),a);case 8:return e.next=10,e.sent.json();case 10:o=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),gz.create("token-update-failed",{errorInfo:e.t0});case 16:if(!o.error){e.next=18;break}throw gz.create("token-update-failed",{errorInfo:o.error.message});case 18:if(o.token){e.next=20;break}throw gz.create("token-update-no-token");case 20:return e.abrupt("return",o.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])}))).apply(this,arguments)}function wz(e,t){return Cz.apply(this,arguments)}function Cz(){return(Cz=rB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ez(t);case 2:return e.t0=e.sent,r={method:"DELETE",headers:e.t0},e.prev=4,e.next=7,fetch("".concat(bz(t.appConfig),"/").concat(n),r);case 7:return e.next=9,e.sent.json();case 9:if(!(i=e.sent).error){e.next=12;break}throw gz.create("token-unsubscribe-failed",{errorInfo:i.error.message});case 12:e.next=17;break;case 14:throw e.prev=14,e.t1=e.catch(4),gz.create("token-unsubscribe-failed",{errorInfo:e.t1});case 17:case"end":return e.stop()}},e,null,[[4,14]])}))).apply(this,arguments)}function bz(e){var t=e.projectId;return"https://fcmregistrations.googleapis.com/v1/projects/".concat(t,"/registrations")}function Ez(e){return Sz.apply(this,arguments)}function Sz(){return(Sz=rB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.appConfig,r=t.installations,e.next=3,r.getToken();case 3:return i=e.sent,e.abrupt("return",new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":"FIS ".concat(i)}));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Pz(e){var t=e.p256dh,n=e.auth,r=e.endpoint,i=e.vapidKey,a={web:{endpoint:r,auth:n,p256dh:t}};return i!==jU&&(a.web.applicationPubKey=i),a}function Oz(e){return Tz.apply(this,arguments)}function Tz(){return(Tz=rB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Dz(t.swRegistration,t.vapidKey);case 2:return n=e.sent,r={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:n.endpoint,auth:XU(n.getKey("auth")),p256dh:XU(n.getKey("p256dh"))},e.next=6,cz(t.firebaseDependencies);case 6:if(!(i=e.sent)){e.next=19;break}if(!Fz(i.subscriptionOptions,r)){e.next=10;break}return e.abrupt("return",Date.now()>=i.createTime+6048e5?Az(t,{token:i.token,createTime:Date.now(),subscriptionOptions:r}):i.token);case 10:return e.prev=10,e.next=13,wz(t.firebaseDependencies,i.token);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(10),console.warn(e.t0);case 18:case 19:return e.abrupt("return",Nz(t.firebaseDependencies,r));case 20:case"end":return e.stop()}},e,null,[[10,15]])}))).apply(this,arguments)}function Iz(e){return xz.apply(this,arguments)}function xz(){return(xz=rB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cz(t.firebaseDependencies);case 2:if(n=e.sent,e.t0=n,!e.t0){e.next=9;break}return e.next=7,wz(t.firebaseDependencies,n.token);case 7:return e.next=9,dz(t.firebaseDependencies);case 9:return e.next=11,t.swRegistration.pushManager.getSubscription();case 11:return r=e.sent,e.abrupt("return",!r||r.unsubscribe());case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Az(e,t){return Rz.apply(this,arguments)}function Rz(){return(Rz=rB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,kz(t.firebaseDependencies,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{token:r,createTime:Date.now()}),e.next=7,hz(t.firebaseDependencies,i);case 7:return e.abrupt("return",r);case 10:return e.prev=10,e.t0=e.catch(0),e.next=14,Iz(t);case 14:throw e.t0;case 15:case"end":return e.stop()}},e,null,[[0,10]])}))).apply(this,arguments)}function Nz(e,t){return Mz.apply(this,arguments)}function Mz(){return(Mz=rB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yz(t,n);case 2:return e.t0=e.sent,e.t1=Date.now(),e.t2=n,r={token:e.t0,createTime:e.t1,subscriptionOptions:e.t2},e.next=8,hz(t,r);case 8:return e.abrupt("return",r.token);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Dz(e,t){return Lz.apply(this,arguments)}function Lz(){return(Lz=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.pushManager.getSubscription();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:ez(n)});case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Fz(e,t){return t.vapidKey===e.vapidKey&&t.endpoint===e.endpoint&&t.auth===e.auth&&t.p256dh===e.p256dh}function Bz(e){var t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(t.notification){e.notification={};var n=t.notification.title;n&&(e.notification.title=n);var r=t.notification.body;r&&(e.notification.body=r);var i=t.notification.image;i&&(e.notification.image=i)}}(t,e),function(e,t){!t.data||(e.data=t.data)}(t,e),function(e,t){if(t.fcmOptions){e.fcmOptions={};var n=t.fcmOptions.link;n&&(e.fcmOptions.link=n);var r=t.fcmOptions.analytics_label;r&&(e.fcmOptions.analyticsLabel=r)}}(t,e),t}function Vz(e){return"object"==typeof e&&!!e&&ZU in e}function Uz(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function zz(e){return gz.create("missing-app-config-values",{valueName:e})}Uz("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Uz("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");var Hz=function(){function e(t,n,r){np(this,e),this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;var i=function(e){if(!e||!e.options)throw zz("App Configuration Object");if(!e.name)throw zz("App Name");for(var t=e.options,n=0,r=["projectId","apiKey","appId","messagingSenderId"];n<r.length;n++){var i=r[n];if(!t[i])throw zz(i)}return{appName:e.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(t);this.firebaseDependencies={app:t,appConfig:i,installations:n,analyticsProvider:r}}return ip(e,[{key:"_delete",value:function(){return Promise.resolve()}}]),e}();function Gz(e){return qz.apply(this,arguments)}function qz(){return(qz=rB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.serviceWorker.register($U,{scope:WU});case 3:t.swRegistration=e.sent,t.swRegistration.update().catch(function(){}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),gz.create("failed-service-worker-registration",{browserErrorMessage:e.t0.message});case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}function $z(e,t){return Wz.apply(this,arguments)}function Wz(){return(Wz=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!n&&!t.swRegistration,!e.t0){e.next=4;break}return e.next=4,Gz(t);case 4:if(!n&&t.swRegistration){e.next=8;break}if(n instanceof ServiceWorkerRegistration){e.next=7;break}throw gz.create("invalid-sw-registration");case 7:t.swRegistration=n;case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function jz(e,t){return Zz.apply(this,arguments)}function Zz(){return(Zz=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n?t.vapidKey=n:t.vapidKey||(t.vapidKey=jU);case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Yz(){return(Yz=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator){e.next=2;break}throw gz.create("only-available-in-window");case 2:if(e.t0="default"===Notification.permission,!e.t0){e.next=6;break}return e.next=6,Notification.requestPermission();case 6:if("granted"===Notification.permission){e.next=8;break}throw gz.create("permission-blocked");case 8:return e.next=10,jz(t,null==n?void 0:n.vapidKey);case 10:return e.next=12,$z(t,null==n?void 0:n.serviceWorkerRegistration);case 12:return e.abrupt("return",Oz(t));case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Kz(e,t,n){return Jz.apply(this,arguments)}function Jz(){return(Jz=rB(regeneratorRuntime.mark(function e(t,n,r){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=Qz(n),e.next=3,t.firebaseDependencies.analyticsProvider.get();case 3:e.sent.logEvent(i,{message_id:r[ZU],message_name:r[YU],message_time:r[KU],message_device_time:Math.floor(Date.now()/1e3)});case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Qz(e){switch(e){case QU.NOTIFICATION_CLICKED:return"notification_open";case QU.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function Xz(){return(Xz=rB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=n.data).isFirebaseMessaging){e.next=3;break}return e.abrupt("return");case 3:if(t.onMessageHandler&&r.messageType===QU.PUSH_RECEIVED&&("function"==typeof t.onMessageHandler?t.onMessageHandler(Bz(r)):t.onMessageHandler.next(Bz(r))),i=r.data,e.t0=Vz(i)&&"1"===i[JU],!e.t0){e.next=9;break}return e.next=9,Kz(t,r.messageType,i);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var eH="@firebase/messaging";function tH(){return(tH=rB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,TB();case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",!1);case 8:return e.abrupt("return","undefined"!=typeof window&&OB()&&IB()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"));case 9:case"end":return e.stop()}},e,null,[[0,5]])}))).apply(this,arguments)}yV(new QB("messaging",function(e){var t=new Hz(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",function(e){return function(e,t){return Xz.apply(this,arguments)}(t,e)}),t},"PUBLIC")),yV(new QB("messaging-internal",function(e){var t=e.getProvider("messaging").getImmediate();return{getToken:function(e){return function(e,t){return Yz.apply(this,arguments)}(t,e)}}},"PRIVATE")),EV(eH,"0.9.8"),EV(eH,"0.9.8","esm2017");var nH="analytics",rH="firebase_id",iH="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",aH="https://www.googletagmanager.com/gtag/js",oH=new uV("@firebase/analytics");function sH(e){return Promise.all(e.map(function(e){return e.catch(function(e){return e})}))}function uH(e,t){var n=document.createElement("script");n.src="".concat(aH,"?l=").concat(e,"&id=").concat(t),n.async=!0,document.head.appendChild(n)}function cH(e,t,n,r,i,a){return lH.apply(this,arguments)}function lH(){return(lH=rB(regeneratorRuntime.mark(function e(t,n,r,i,a,o){var s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=i[a],e.prev=1,!s){e.next=7;break}return e.next=5,n[s];case 5:e.next=14;break;case 7:return e.next=9,sH(r);case 9:if(u=e.sent.find(function(e){return e.measurementId===a}),e.t0=u,!e.t0){e.next=14;break}return e.next=14,n[u.appId];case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(1),oH.error(e.t1);case 19:t("config",a,o);case 20:case"end":return e.stop()}},e,null,[[1,16]])}))).apply(this,arguments)}function hH(e,t,n,r,i){return fH.apply(this,arguments)}function fH(){return(fH=rB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o,s,u,c,l,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=[],!a||!a.send_to){e.next=26;break}return s=a.send_to,Array.isArray(s)||(s=[s]),e.next=7,sH(r);case 7:u=e.sent,c=Xv(s),e.prev=9,h=function(){var e=l.value,t=u.find(function(t){return t.measurementId===e}),r=t&&n[t.appId];if(!r)return o=[],"break";o.push(r)},c.s();case 12:if((l=c.n()).done){e.next=18;break}if("break"!==h()){e.next=16;break}return e.abrupt("break",18);case 16:e.next=12;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(9),c.e(e.t0);case 23:return e.prev=23,c.f(),e.finish(23);case 26:return 0===o.length&&(o=Object.values(n)),e.next=29,Promise.all(o);case 29:t("event",i,a||{}),e.next=35;break;case 32:e.prev=32,e.t1=e.catch(0),oH.error(e.t1);case 35:case"end":return e.stop()}},e,null,[[0,32],[9,20,23,26]])}))).apply(this,arguments)}function dH(){for(var e=window.document.getElementsByTagName("script"),t=0,n=Object.values(e);t<n.length;t++){var r=n[t];if(r.src&&r.src.includes(aH))return r}return null}var vH=new AB("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),pH=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;np(this,e),this.throttleMetadata=t,this.intervalMillis=n}return ip(e,[{key:"getThrottleMetadata",value:function(e){return this.throttleMetadata[e]}},{key:"setThrottleMetadata",value:function(e,t){this.throttleMetadata[e]=t}},{key:"deleteThrottleMetadata",value:function(e){delete this.throttleMetadata[e]}}]),e}());function gH(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}function yH(e){return mH.apply(this,arguments)}function mH(){return(mH=rB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.appId,i=t.apiKey,a={method:"GET",headers:gH(i)},o=iH.replace("{app-id}",r),e.next=6,fetch(o,a);case 6:if(200===(s=e.sent).status||304===s.status){e.next=19;break}return u="",e.prev=9,e.next=12,s.json();case 12:c=e.sent,(null===(n=c.error)||void 0===n?void 0:n.message)&&(u=c.error.message),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(9);case 18:throw vH.create("config-fetch-failed",{httpStatus:s.status,responseMessage:u});case 19:return e.abrupt("return",s.json());case 20:case"end":return e.stop()}},e,null,[[9,16]])}))).apply(this,arguments)}function kH(e){return _H.apply(this,arguments)}function _H(){return(_H=rB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:pH,r=l.length>2?l[2]:void 0,i=t.options,a=i.appId,o=i.apiKey,s=i.measurementId,a){e.next=5;break}throw vH.create("no-app-id");case 5:if(o){e.next=9;break}if(!s){e.next=8;break}return e.abrupt("return",{measurementId:s,appId:a});case 8:throw vH.create("no-api-key");case 9:return u=n.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new SH,e.abrupt("return",(setTimeout(rB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c.abort();case 1:case"end":return e.stop()}},e)})),void 0!==r?r:6e4),wH({appId:a,apiKey:o,measurementId:s},u,c,n)));case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function wH(e,t,n){return CH.apply(this,arguments)}function CH(){return(CH=rB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,h,f=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.throttleEndTimeMillis,a=n.backoffCount,o=f.length>3&&void 0!==f[3]?f[3]:pH,s=t.appId,u=t.measurementId,e.prev=3,e.next=6,bH(r,i);case 6:e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(3),!u){e.next=12;break}return e.abrupt("return",(oH.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(u,' provided in the "measurementId" field in the local Firebase config. [').concat(e.t0.message,"]")),{appId:s,measurementId:u}));case 12:throw e.t0;case 13:return e.prev=13,e.next=16,yH(t);case 16:return c=e.sent,e.abrupt("return",(o.deleteThrottleMetadata(s),c));case 20:if(e.prev=20,e.t1=e.catch(13),EH(e.t1)){e.next=26;break}if(o.deleteThrottleMetadata(s),!u){e.next=25;break}return e.abrupt("return",(oH.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(u,' provided in the "measurementId" field in the local Firebase config. [').concat(e.t1.message,"]")),{appId:s,measurementId:u}));case 25:throw e.t1;case 26:return l=503===Number(e.t1.customData.httpStatus)?KB(a,o.intervalMillis,30):KB(a,o.intervalMillis),h={throttleEndTimeMillis:Date.now()+l,backoffCount:a+1},e.abrupt("return",(o.setThrottleMetadata(s,h),oH.debug("Calling attemptFetch again in ".concat(l," millis")),wH(t,h,r,o)));case 28:case"end":return e.stop()}},e,null,[[3,8],[13,20]])}))).apply(this,arguments)}function bH(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r(vH.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function EH(e){if(!(e instanceof xB&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}var SH=function(){function e(){np(this,e),this.listeners=[]}return ip(e,[{key:"addEventListener",value:function(e){this.listeners.push(e)}},{key:"abort",value:function(){this.listeners.forEach(function(e){return e()})}}]),e}();function PH(){return OH.apply(this,arguments)}function OH(){return(OH=rB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(OB()){e.next=2;break}return e.abrupt("return",(oH.warn(vH.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1));case 2:return e.prev=2,e.next=5,TB();case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(2),e.abrupt("return",(oH.warn(vH.create("indexeddb-unavailable",{errorInfo:e.t0}).message),!1));case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}},e,null,[[2,7]])}))).apply(this,arguments)}function TH(){return(TH=rB(regeneratorRuntime.mark(function e(t,n,r,i,a,o,s){var u,c,l,h,f,d,v,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(c=kH(t)).then(function(e){r[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&oH.warn("The measurement ID in the local Firebase config (".concat(t.options.measurementId,") does not match the measurement ID fetched from the server (").concat(e.measurementId,"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config."))}).catch(function(e){return oH.error(e)}),n.push(c),l=PH().then(function(e){if(e)return i.getId()}),e.next=5,Promise.all([c,l]);case 5:return h=e.sent,f=Fv(h,2),d=f[0],v=f[1],dH()||uH(o,d.measurementId),a("js",new Date),p=null!==(u=null==s?void 0:s.config)&&void 0!==u?u:{},e.abrupt("return",(p.origin="firebase",p.update=!0,null!=v&&(p[rH]=v),a("config",d.measurementId,p),d.measurementId));case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}var IH,xH,AH=function(){function e(t){np(this,e),this.app=t}return ip(e,[{key:"_delete",value:function(){return delete RH[this.app.options.appId],Promise.resolve()}}]),e}(),RH={},NH=[],MH={},DH="dataLayer",LH=!1;function FH(){return(FH=rB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a||!a.global){e.next=4;break}t("event",r,i),e.next=8;break;case 4:return e.next=6,n;case 6:o=e.sent,t("event",r,Object.assign(Object.assign({},i),{send_to:o}));case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function BH(){return(BH=rB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!EB()&&IB()&&OB()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,TB();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var VH="@firebase/analytics";yV(new QB(nH,function(e,t){var n=t.options;return function(e,t,n){!function(){var e=[];if(EB()&&e.push("This is a browser extension environment."),IB()||e.push("Cookies are not available."),e.length>0){var t=e.map(function(e,t){return"(".concat(t+1,") ").concat(e)}).join(" "),n=vH.create("invalid-analytics-context",{errorInfo:t});oH.warn(n.message)}}();var r=e.options.appId;if(!r)throw vH.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw vH.create("no-api-key");oH.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '.concat(e.options.measurementId,' provided in the "measurementId" field in the local Firebase config.'))}if(null!=RH[r])throw vH.create("already-exists",{id:r});if(!LH){!function(e){var t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(DH);var i=function(e,t,n,r,i){var a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(a=window[i]),window[i]=function(e,t,n,r){function i(){return(i=rB(regeneratorRuntime.mark(function i(a,o,s){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,"event"!==a){i.next=6;break}return i.next=4,hH(e,t,n,o,s);case 4:i.next=12;break;case 6:if("config"!==a){i.next=11;break}return i.next=9,cH(e,t,n,r,o,s);case 9:i.next=12;break;case 11:e("set",o);case 12:i.next=17;break;case 14:i.prev=14,i.t0=i.catch(0),oH.error(i.t0);case 17:case"end":return i.stop()}},i,null,[[0,14]])}))).apply(this,arguments)}return function(e,t,n){return i.apply(this,arguments)}}(a,e,t,n),{gtagCore:a,wrappedGtag:window[i]}}(RH,NH,MH,DH,"gtag"),a=i.wrappedGtag,o=i.gtagCore;xH=a,IH=o,LH=!0}return RH[r]=function(e,t,n,r,i,a,o){return TH.apply(this,arguments)}(e,NH,MH,t,IH,DH,n),new AH(e)}(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)},"PUBLIC")),yV(new QB("analytics-internal",function(e){try{var t=e.getProvider(nH).getImmediate();return{logEvent:function(e,n,r){return function(e,t,n,r){e=JB(e),function(e,t,n,r,i){return FH.apply(this,arguments)}(xH,RH[e.app.options.appId],t,n,r).catch(function(e){return oH.error(e)})}(t,e,n,r)}}}catch(t){throw vH.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),EV(VH,"0.7.5"),EV(VH,"0.7.5","esm2017");var UH=function(e){qv(n,e);var t=Wv(n);function n(e,r){return np(this,n),t.call(this)}return ip(n,[{key:"schedule",value:function(e){return this}}]),n}(ap),zH={setInterval:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=zH.delegate;return((null==e?void 0:e.setInterval)||setInterval).apply(void 0,arguments)}),clearInterval:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=zH.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)}),delegate:void 0},HH=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i.pending=!1,i}return ip(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return zH.setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!=n&&this.delay===n&&!1===this.pending)return t;zH.clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n,r=!1;try{this.work(e)}catch(i){r=!0,n=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n}},{key:"unsubscribe",value:function(){if(!this.closed){var e=this.id,t=this.scheduler,r=t.actions;this.work=this.state=this.scheduler=null,this.pending=!1,tp(r,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,Hv(Kv(n.prototype),"unsubscribe",this).call(this)}}}]),n}(UH),GH={now:function(){return(GH.delegate||Date).now()},delegate:void 0},qH=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;np(this,e),this.schedulerActionCtor=t,this.now=n}return ip(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.schedulerActionCtor(this,e).schedule(n,t)}}]),e}();qH.now=GH.now;var $H=function(e){qv(n,e);var t=Wv(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qH.now;return np(this,n),(r=t.call(this,e,i)).actions=[],r._active=!1,r._scheduled=void 0,r}return ip(n,[{key:"flush",value:function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),n}(qH),WH=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n)}($H))(function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i}return ip(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t>0?Hv(Kv(n.prototype),"schedule",this).call(this,e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}},{key:"execute",value:function(e,t){return t>0||this.closed?Hv(Kv(n.prototype),"execute",this).call(this,e,t):this._execute(e,t)}},{key:"requestAsyncId",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!=r&&r>0||null==r&&this.delay>0?Hv(Kv(n.prototype),"requestAsyncId",this).call(this,e,t,r):e.flush(this)}}]),n}(HH)),jH=new $H(HH),ZH=new lS("7.2.0"),YH="__angularfire_symbol__analyticsIsSupported",KH="__angularfire_symbol__remoteConfigIsSupported",JH="__angularfire_symbol__messagingIsSupported";function QH(e,t,n){if(t){if(1===t.length)return t[0];var r=t.filter(function(e){return e.app===n});if(1===r.length)return r[0]}return n.container.getProvider(e).getImmediate({optional:!0})}globalThis[YH]||(globalThis[YH]=function(){return BH.apply(this,arguments)}().then(function(e){return globalThis.__angularfire_symbol__analyticsIsSupportedValue=e})),globalThis[JH]||(globalThis[JH]=function(){return tH.apply(this,arguments)}().then(function(e){return globalThis.__angularfire_symbol__messagingIsSupportedValue=e})),globalThis[KH]||(globalThis[KH]=function(){return qU.apply(this,arguments)}().then(function(e){return globalThis.__angularfire_symbol__remoteConfigIsSupportedValue=e}));var XH=function(e,t){var n=t?[t]:bV(),r=[];return n.forEach(function(t){t.container.getProvider(e).instances.forEach(function(e){r.includes(e)||r.push(e)})}),r};function eG(){}var tG=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:WH;np(this,e),this.zone=t,this.delegate=n}return ip(e,[{key:"now",value:function(){return this.delegate.now()}},{key:"schedule",value:function(e,t,n){var r=this.zone;return this.delegate.schedule(function(t){var n=this;r.runGuarded(function(){e.apply(n,[t])})},t,n)}}]),e}(),nG=function(){function e(t){np(this,e),this.zone=t,this.task=null}return ip(e,[{key:"call",value:function(e,t){var n=this.unscheduleTask.bind(this);return this.task=this.zone.run(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",eG,{},eG,eG)}),t.pipe(gR({next:n,complete:n,error:n})).subscribe(e).add(n)}},{key:"unscheduleTask",value:function(){var e=this;setTimeout(function(){null!=e.task&&"scheduled"===e.task.state&&(e.task.invoke(),e.task=null)},10)}}]),e}(),rG=function(){var e=ip(function e(t){np(this,e),this.ngZone=t,this.outsideAngular=t.runOutsideAngular(function(){return new tG(Zone.current)}),this.insideAngular=t.run(function(){return new tG(Zone.current,jH)}),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)});return e.\u0275fac=function(t){return new(t||e)(Ok(JP))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function iG(){var e=globalThis.\u0275AngularFireScheduler;if(!e)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return e}function aG(e){return iG().ngZone.runOutsideAngular(function(){return e()})}function oG(e){return iG().ngZone.run(function(){return e()})}function sG(e){return iG(),function(e){return function(t){return(t=t.lift(new nG(e.ngZone))).pipe(sg(e.outsideAngular),og(e.insideAngular))}}(iG())(e)}var uG=function(e,t){var n=void 0;return function(){var r=arguments;return t&&setTimeout(function(){"scheduled"===t.state&&t.invoke()},10),oG(function(){return e.apply(n,r)})}},cG=function(e,t){return function(){for(var n,r=arguments,i=this,a=0;a<arguments.length;a++)"function"==typeof arguments[a]&&(t&&(n||(n=oG(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",eG,{},eG,eG)}))),arguments[a]=uG(arguments[a],n));var o=aG(function(){return e.apply(i,r)});if(!t){if(o instanceof Ip){var s=iG();return o.pipe(sg(s.outsideAngular),og(s.insideAngular))}return oG(function(){return o})}return o instanceof Ip?o.pipe(sG):o instanceof Promise?oG(function(){return new Promise(function(e,t){return o.then(function(t){return oG(function(){return e(t)})},function(e){return oG(function(){return t(e)})})})}):"function"==typeof o&&n?function(){return setTimeout(function(){n&&"scheduled"===n.state&&n.invoke()},10),o.apply(this,arguments)}:oG(function(){return o})}},lG=ip(function e(t){return np(this,e),t}),hG=ip(function e(){return np(this,e),bV()}),fG=new sk("angularfire2._apps"),dG={provide:lG,useFactory:function(e){return e&&1===e.length?e[0]:new lG(CV())},deps:[[new Dk,fG]]},vG={provide:hG,deps:[[new Dk,fG]]};function pG(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new lG(r)}}var gG=function(){var e=ip(function e(t){np(this,e),EV("angularfire",ZH.full,"core"),EV("angularfire",ZH.full,"app"),EV("angular",hS.full,t.toString())});return e.\u0275fac=function(t){return new(t||e)(Ok(LP))},e.\u0275mod=ay({type:e}),e.\u0275inj=Pg({providers:[dG,vG]}),e}(),yG=cG(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"object"!=typeof t&&(t={name:t});var n=Object.assign({name:fV,automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw kV.create("bad-app-name",{appName:String(r)});var i=vV.get(r);if(i){if(UB(e,i.options)&&UB(n,i.config))return i;throw kV.create("duplicate-app",{appName:r})}var a,o=new tV(r),s=Xv(pV.values());try{for(s.s();!(a=s.n()).done;){var u=a.value;o.addComponent(u)}}catch(l){s.e(l)}finally{s.f()}var c=new _V(e,n,o);return vV.set(r,c),c},!0),mG=new Map,kG={activated:!1,tokenObservers:[]},_G={initialized:!1,enabled:!1};function wG(e){return mG.get(e)||kG}function CG(e,t){mG.set(e,t)}function bG(){return _G}var EG=function(){function e(t,n,r,i,a){if(np(this,e),this.operation=t,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}return ip(e,[{key:"start",value:function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(function(){})}},{key:"stop",value:function(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}},{key:"isRunning",value:function(){return!!this.pending}},{key:"process",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.stop(),n.prev=1,t.pending=new _B,n.next=5,function(e){return new Promise(function(t){setTimeout(t,e)})}(t.getNextRun(e));case 5:return t.pending.resolve(),n.next=8,t.pending.promise;case 8:return t.pending=new _B,n.next=11,t.operation();case 11:return t.pending.resolve(),n.next=14,t.pending.promise;case 14:t.process(!0).catch(function(){}),n.next=20;break;case 17:n.prev=17,n.t0=n.catch(1),t.retryPolicy(n.t0)?t.process(!1).catch(function(){}):t.stop();case 20:case"end":return n.stop()}},n,null,[[1,17]])}))()}},{key:"getNextRun",value:function(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}]),e}(),SG=new AB("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function PG(e){if(!wG(e).activated)throw SG.create("use-before-activation",{appName:e.name})}function OG(e,t){return TG.apply(this,arguments)}function TG(){return(TG=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l,h,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.url,i=t.body,a={"Content-Type":"application/json"},(o=n.getImmediate({optional:!0}))&&(a["X-Firebase-Client"]=o.getPlatformInfoString()),s={method:"POST",body:JSON.stringify(i),headers:a},e.prev=4,e.next=7,fetch(r,s);case 7:u=e.sent,e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(4),SG.create("fetch-network-error",{originalErrorMessage:e.t0.message});case 13:if(200===u.status){e.next=15;break}throw SG.create("fetch-status-error",{httpStatus:u.status});case 15:return e.prev=15,e.next=18,u.json();case 18:c=e.sent,e.next=24;break;case 21:throw e.prev=21,e.t1=e.catch(15),SG.create("fetch-parse-error",{originalErrorMessage:e.t1.message});case 24:if((l=c.ttl.match(/^([\d.]+)(s)$/))&&l[2]&&!isNaN(Number(l[1]))){e.next=27;break}throw SG.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration format: ".concat(c.ttl)});case 27:return h=1e3*Number(l[1]),f=Date.now(),e.abrupt("return",{token:c.attestationToken,expireTimeMillis:f+h,issuedAtTimeMillis:f});case 29:case"end":return e.stop()}},e,null,[[4,10],[15,21]])}))).apply(this,arguments)}function IG(e,t){var n=e.options,r=n.projectId,i=n.appId,a=n.apiKey;return{url:"https://content-firebaseappcheck.googleapis.com/v1beta/projects/".concat(r,"/apps/").concat(i,":exchangeDebugToken?key=").concat(a),body:{debug_token:t}}}var xG="firebase-app-check-store",AG=null;function RG(){return AG||(AG=new Promise(function(e,t){try{var n=indexedDB.open("firebase-app-check-database",1);n.onsuccess=function(t){e(t.target.result)},n.onerror=function(e){var n;t(SG.create("storage-open",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))},n.onupgradeneeded=function(e){var t=e.target.result;switch(e.oldVersion){case 0:t.createObjectStore(xG,{keyPath:"compositeKey"})}}}catch(n){t(SG.create("storage-open",{originalErrorMessage:n.message}))}}))}function NG(){return(NG=rB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,RG();case 2:return r=e.sent.transaction(xG,"readwrite"),i=r.objectStore(xG).put({compositeKey:t,value:n}),e.abrupt("return",new Promise(function(e,t){i.onsuccess=function(t){e()},r.onerror=function(e){var n;t(SG.create("storage-set",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))}}));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var MG=new uV("@firebase/app-check");function DG(e,t){return OB()?function(e,t){return function(e,t){return NG.apply(this,arguments)}(function(e){return"".concat(e.options.appId,"-").concat(e.name)}(e),t)}(e,t).catch(function(e){MG.warn("Failed to write token to IndexedDB. Error: ".concat(e))}):Promise.resolve()}function LG(){return bG().enabled}function FG(){return BG.apply(this,arguments)}function BG(){return(BG=rB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=bG()).enabled||!t.token){e.next=3;break}return e.abrupt("return",t.token.promise);case 3:throw Error("\n            Can't get debug token in production mode.\n        ");case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var VG={error:"UNKNOWN_ERROR"};function UG(e){return dB.encodeString(JSON.stringify(e),!1)}function zG(e){return HG.apply(this,arguments)}function HG(){return(HG=rB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l,h=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=h.length>1&&void 0!==h[1]&&h[1],PG(r=t.app),i=wG(r),o=i.token){e.next=10;break}return e.next=8,i.cachedTokenPromise;case 8:(s=e.sent)&&WG(s)&&(o=s);case 10:if(n||!o||!WG(o)){e.next=12;break}return e.abrupt("return",{token:o.token});case 12:if(c=!1,!LG()){e.next=33;break}if(e.t0=i.exchangeTokenPromise,e.t0){e.next=26;break}return e.t1=OG,e.t2=IG,e.t3=r,e.next=21,FG();case 21:e.t4=e.sent,e.t5=(0,e.t2)(e.t3,e.t4),e.t6=t.platformLoggerProvider,i.exchangeTokenPromise=(0,e.t1)(e.t5,e.t6).then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0;case 26:return e.next=28,i.exchangeTokenPromise;case 28:return l=e.sent,e.next=31,DG(r,l);case 31:return CG(r,Object.assign(Object.assign({},i),{token:l})),e.abrupt("return",{token:l.token});case 33:return e.prev=33,i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0),e.next=37,i.exchangeTokenPromise;case 37:o=e.sent,e.next=43;break;case 40:e.prev=40,e.t7=e.catch(33),"appCheck/throttled"===e.t7.code?MG.warn(e.t7.message):MG.error(e.t7),a=e.t7;case 43:if(!o){e.next=50;break}return u={token:o.token},CG(r,Object.assign(Object.assign({},i),{token:o})),e.next=48,DG(r,o);case 48:e.next=51;break;case 50:u=jG(a);case 51:return c&&$G(r,u),e.abrupt("return",u);case 53:case"end":return e.stop()}},e,null,[[33,40]])}))).apply(this,arguments)}function GG(e,t){var n=wG(e),r=n.tokenObservers.filter(function(e){return e.next!==t});0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),CG(e,Object.assign(Object.assign({},n),{tokenObservers:r}))}function qG(e){var t=e.app,n=wG(t),r=n.tokenRefresher;r||(r=function(e){var t=e.app;return new EG(rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!wG(t).token){n.next=6;break}return n.next=3,zG(e,!0);case 3:n.t0=n.sent,n.next=9;break;case 6:return n.next=8,zG(e);case 8:n.t0=n.sent;case 9:if(!(r=n.t0).error){n.next=12;break}throw r.error;case 12:case"end":return n.stop()}},n)})),function(){return!0},function(){var e=wG(t);if(e.token){var n=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,e.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0},3e4,96e4)}(e),CG(t,Object.assign(Object.assign({},n),{tokenRefresher:r}))),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function $G(e,t){var n,r=Xv(wG(e).tokenObservers);try{for(r.s();!(n=r.n()).done;){var i=n.value;try{"EXTERNAL"===i.type&&null!=t.error?i.error(t.error):i.next(t)}catch(a){}}}catch(o){r.e(o)}finally{r.f()}}function WG(e){return e.expireTimeMillis-Date.now()>0}function jG(e){return{token:UG(VG),error:e}}var ZG=function(){function e(t,n){np(this,e),this.app=t,this.platformLoggerProvider=n}return ip(e,[{key:"_delete",value:function(){var e,t=Xv(wG(this.app).tokenObservers);try{for(t.s();!(e=t.n()).done;){var n=e.value;GG(this.app,n.next)}}catch(r){t.e(r)}finally{t.f()}return Promise.resolve()}}]),e}(),YG="app-check-internal";yV(new QB("app-check",function(e){return function(e,t){return new ZG(e,t)}(e.getProvider("app").getImmediate(),e.getProvider("platform-logger"))},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider(YG).initialize()})),yV(new QB(YG,function(e){return function(e){return{getToken:function(t){return zG(e,t)},addTokenListener:function(t){return function(e,t,n,r){var i=e.app,a=wG(i),o={next:n,error:void 0,type:"INTERNAL"};if(CG(i,Object.assign(Object.assign({},a),{tokenObservers:[].concat(Jv(a.tokenObservers),[o])})),a.token&&WG(a.token)){var s=a.token;Promise.resolve().then(function(){n({token:s.token}),qG(e)}).catch(function(){})}a.cachedTokenPromise.then(function(){return qG(e)})}(e,0,t)},removeTokenListener:function(t){return GG(e.app,t)}}}(e.getProvider("app-check").getImmediate())},"PUBLIC").setInstantiationMode("EXPLICIT")),EV("@firebase/app-check","0.5.3");var KG=ip(function e(){return np(this,e),XH("app-check")});"undefined"!=typeof window&&window;var JG=new AB("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),QG=new uV("@firebase/auth");function XG(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];QG.logLevel<=rV.ERROR&&QG.error.apply(QG,["Auth (9.6.6): ".concat(e)].concat(n))}function eq(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw iq.apply(void 0,[e].concat(n))}function tq(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return iq.apply(void 0,[e].concat(n))}function nq(e,t,n){var r=Object.assign(Object.assign({},{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Lv({},t,n));return new AB("auth","Firebase",r).create(t,{appName:e.name})}function rq(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&eq(e,"argument-error"),nq(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.Did you pass a reference from a different Auth SDK?"))}function iq(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!=typeof e){var i,a=n[0],o=Jv(n.slice(1));return o[0]&&(o[0].appName=e.name),(i=e._errorFactory).create.apply(i,[a].concat(Jv(o)))}return JG.create.apply(JG,[e].concat(n))}function aq(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(!e)throw iq.apply(void 0,[t].concat(r))}function oq(e){var t="INTERNAL ASSERTION FAILED: "+e;throw XG(t),new Error(t)}function sq(e,t){e||oq(t)}var uq=new Map;function cq(e){sq(e instanceof Function,"Expected a class definition");var t=uq.get(e);return t?(sq(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,uq.set(e,t),t)}function lq(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function hq(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}var fq=function(){function e(t,n){np(this,e),this.shortDelay=t,this.longDelay=n,sq(n>t,"Short delay should be less than long delay!"),this.isMobile=bB()||SB()}return ip(e,[{key:"get",value:function(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===hq()||"https:"===hq()||EB()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),e}();function dq(e,t){sq(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var vq=function(){function e(){np(this,e)}return ip(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void oq("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void oq("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void oq("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),pq={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},gq=new fq(3e4,6e4);function yq(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function mq(e,t,n,r){return kq.apply(this,arguments)}function kq(){return(kq=rB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>4&&void 0!==o[4]?o[4]:{},e.abrupt("return",_q(t,a,rB(regeneratorRuntime.mark(function e(){var a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={},o={},i&&("GET"===n?o=i:a={body:JSON.stringify(i)}),s=HB(Object.assign({key:t.config.apiKey},o)).slice(1),e.next=5,t._getAdditionalHeaders();case 5:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode),vq.fetch()(Eq(t,t.config.apiHost,r,s),Object.assign({method:n,headers:u,referrerPolicy:"no-referrer"},a))));case 7:case"end":return e.stop()}},e)}))));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function _q(e,t,n){return wq.apply(this,arguments)}function wq(){return(wq=rB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,h,f,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,i=Object.assign(Object.assign({},pq),n),e.prev=2,a=new Sq(t),e.next=6,Promise.race([r(),a.promise]);case 6:return o=e.sent,a.clearNetworkTimeout(),e.next=10,o.json();case 10:if(!("needConfirmation"in(s=e.sent))){e.next=13;break}throw Pq(t,"account-exists-with-different-credential",s);case 13:if(!o.ok||"errorMessage"in s){e.next=15;break}return e.abrupt("return",s);case 15:if(u=o.ok?s.errorMessage:s.error.message,c=u.split(" : "),l=Fv(c,2),h=l[0],f=l[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==h){e.next=18;break}throw Pq(t,"credential-already-in-use",s);case 18:if("EMAIL_EXISTS"!==h){e.next=20;break}throw Pq(t,"email-already-in-use",s);case 20:if(d=i[h]||h.toLowerCase().replace(/[_\s]+/g,"-"),!f){e.next=23;break}throw nq(t,d,f);case 23:eq(t,d),e.next=31;break;case 26:if(e.prev=26,e.t0=e.catch(2),!(e.t0 instanceof xB)){e.next=30;break}throw e.t0;case 30:eq(t,"network-request-failed");case 31:case"end":return e.stop()}},e,null,[[2,26]])}))).apply(this,arguments)}function Cq(e,t,n,r){return bq.apply(this,arguments)}function bq(){return(bq=rB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>4&&void 0!==s[4]?s[4]:{},e.next=3,mq(t,n,r,i,a);case 3:return o=e.sent,e.abrupt("return",("mfaPendingCredential"in o&&eq(t,"multi-factor-auth-required",{_serverResponse:o}),o));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Eq(e,t,n,r){var i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?dq(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}var Sq=function(){function e(t){var n=this;np(this,e),this.auth=t,this.timer=null,this.promise=new Promise(function(e,t){n.timer=setTimeout(function(){return t(tq(n.auth,"network-request-failed"))},gq.get())})}return ip(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function Pq(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=tq(e,t,r);return i.customData._tokenResponse=n,i}function Oq(){return(Oq=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",mq(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Tq(e,t){return Iq.apply(this,arguments)}function Iq(){return(Iq=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",mq(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function xq(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(n){}}function Aq(){return(Aq=rB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],r=JB(t),e.next=4,r.getIdToken(n);case 4:return i=e.sent,aq((a=Nq(i))&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error"),o="object"==typeof a.firebase?a.firebase:void 0,s=null==o?void 0:o.sign_in_provider,e.abrupt("return",{claims:a,token:i,authTime:xq(Rq(a.auth_time)),issuedAtTime:xq(Rq(a.iat)),expirationTime:xq(Rq(a.exp)),signInProvider:s||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null});case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Rq(e){return 1e3*Number(e)}function Nq(e){var t=Fv(e.split("."),3),n=t[0],r=t[1],i=t[2];if(void 0===n||void 0===r||void 0===i)return XG("JWT malformed, contained fewer than 3 sections"),null;try{var a=gB(r);return a?JSON.parse(a):(XG("Failed to decode base64 JWT payload"),null)}catch(a){return XG("Caught error parsing JWT payload as JSON",a),null}}function Mq(e,t){return Dq.apply(this,arguments)}function Dq(){return(Dq=rB(regeneratorRuntime.mark(function e(t,n){var r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),e.t1=e.t0 instanceof xB&&Lq(e.t0)&&t.auth.currentUser===t,!e.t1){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}},e,null,[[3,9]])}))).apply(this,arguments)}function Lq(e){var t=e.code;return"auth/user-disabled"===t||"auth/user-token-expired"===t}var Fq=function(){function e(t){np(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return ip(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;if(this.isRunning){var n=this.getInterval(e);this.timerId=setTimeout(rB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.iteration();case 2:case"end":return e.stop()}},e)})),n)}}},{key:"iteration",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.user.getIdToken(!0);case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",void("auth/network-request-failed"===t.t0.code&&e.schedule(!0)));case 8:e.schedule();case 9:case"end":return t.stop()}},t,null,[[0,5]])}))()}}]),e}(),Bq=function(){function e(t,n){np(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return ip(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=xq(this.lastLoginAt),this.creationTime=xq(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function Vq(e){return Uq.apply(this,arguments)}function Uq(){return(Uq=rB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return i=e.sent,e.next=6,Mq(t,Tq(r,{idToken:i}));case 6:aq(null==(a=e.sent)?void 0:a.users.length,r,"internal-error"),o=a.users[0],t._notifyReloadListener(o),s=(null===(n=o.providerUserInfo)||void 0===n?void 0:n.length)?Gq(o.providerUserInfo):[],u=Hq(t.providerData,s),c=!!t.isAnonymous&&!(t.email&&o.passwordHash||(null==u?void 0:u.length)),l={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Bq(o.createdAt,o.lastLoginAt),isAnonymous:c},Object.assign(t,l);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function zq(){return(zq=rB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=JB(t),e.next=3,Vq(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Hq(e,t){return[].concat(Jv(e.filter(function(e){return!t.some(function(t){return t.providerId===e.providerId})})),Jv(t))}function Gq(e){return e.map(function(e){var t=e.providerId,n=Bp(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}function qq(){return(qq=rB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_q(t,{},rB(regeneratorRuntime.mark(function e(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=HB({grant_type:"refresh_token",refresh_token:n}).slice(1),i=t.config,a=i.tokenApiHost,o=i.apiKey,s=Eq(t,a,"/v1/token","key=".concat(o)),e.next=7,t._getAdditionalHeaders();case 7:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/x-www-form-urlencoded",vq.fetch()(s,{method:"POST",headers:u,body:r})));case 9:case"end":return e.stop()}},e)})));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var $q=function(){function e(){np(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return ip(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){aq(e.idToken,"internal-error"),aq(void 0!==e.idToken,"internal-error"),aq(void 0!==e.refreshToken,"internal-error");var t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){var t=Nq(e);return aq(t,"internal-error"),aq(void 0!==t.exp,"internal-error"),aq(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"getToken",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(aq(!n.accessToken||n.refreshToken,e,"user-token-expired"),!t&&n.accessToken&&!n.isExpired){r.next=12;break}if(!n.refreshToken){r.next=8;break}return r.next=5,n.refresh(e,n.refreshToken);case 5:r.t1=n.accessToken,r.next=9;break;case 8:r.t1=null;case 9:r.t0=r.t1,r.next=13;break;case 12:r.t0=n.accessToken;case 13:return r.abrupt("return",r.t0);case 14:case"end":return r.stop()}},r)}))()}},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,function(e,t){return qq.apply(this,arguments)}(e,t);case 2:i=r.sent,a=i.accessToken,o=i.refreshToken,s=i.expiresIn,n.updateTokensAndExpiration(a,o,Number(s));case 7:case"end":return r.stop()}},r)}))()}},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return oq("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,i=n.accessToken,a=n.expirationTime,o=new e;return r&&(aq("string"==typeof r,"internal-error",{appName:t}),o.refreshToken=r),i&&(aq("string"==typeof i,"internal-error",{appName:t}),o.accessToken=i),a&&(aq("number"==typeof a,"internal-error",{appName:t}),o.expirationTime=a),o}}]),e}();function Wq(e,t){aq("string"==typeof e||void 0===e,"internal-error",{appName:t})}var jq=function(){function e(t){np(this,e);var n=t.uid,r=t.auth,i=t.stsTokenManager,a=Bp(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Fq(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?Jv(a.providerData):[],this.metadata=new Bq(a.createdAt||void 0,a.lastLoginAt||void 0)}return ip(e,[{key:"getIdToken",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Mq(t,t.stsTokenManager.getToken(t.auth,e));case 2:if(aq(r=n.sent,t.auth,"internal-error"),n.t0=t.accessToken!==r,!n.t0){n.next=10;break}return t.accessToken=r,n.next=9,t.auth._persistUserIfCurrent(t);case 9:t.auth._notifyListenersIfCurrent(t);case 10:return n.abrupt("return",r);case 11:case"end":return n.stop()}},n)}))()}},{key:"getIdTokenResult",value:function(e){return function(e){return Aq.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return zq.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(aq(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(function(e){return Object.assign({},e)}),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){return new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(e){aq(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return rB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=!1,e.idToken&&e.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(e),i=!0),r.t0=t,!r.t0){r.next=6;break}return r.next=6,Vq(n);case 6:return r.next=8,n.auth._persistUserIfCurrent(n);case 8:i&&n.auth._notifyListenersIfCurrent(n);case 9:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getIdToken();case 2:return n=t.sent,t.next=5,Mq(e,function(e,t){return Oq.apply(this,arguments)}(e.auth,{idToken:n}));case 5:return e.stsTokenManager.clearRefreshToken(),t.abrupt("return",e.auth.signOut());case 7:case"end":return t.stop()}},t)}))()}},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(function(e){return Object.assign({},e)}),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,i,a,o,s,u,c,l,h=null!==(r=n.displayName)&&void 0!==r?r:void 0,f=null!==(i=n.email)&&void 0!==i?i:void 0,d=null!==(a=n.phoneNumber)&&void 0!==a?a:void 0,v=null!==(o=n.photoURL)&&void 0!==o?o:void 0,p=null!==(s=n.tenantId)&&void 0!==s?s:void 0,g=null!==(u=n._redirectEventId)&&void 0!==u?u:void 0,y=null!==(c=n.createdAt)&&void 0!==c?c:void 0,m=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,k=n.uid,_=n.emailVerified,w=n.isAnonymous,C=n.providerData,b=n.stsTokenManager;aq(k&&b,t,"internal-error");var E=$q.fromJSON(this.name,b);aq("string"==typeof k,t,"internal-error"),Wq(h,t.name),Wq(f,t.name),aq("boolean"==typeof _,t,"internal-error"),aq("boolean"==typeof w,t,"internal-error"),Wq(d,t.name),Wq(v,t.name),Wq(p,t.name),Wq(g,t.name),Wq(y,t.name),Wq(m,t.name);var S=new e({uid:k,auth:t,email:f,emailVerified:_,displayName:h,isAnonymous:w,photoURL:v,phoneNumber:d,tenantId:p,stsTokenManager:E,createdAt:y,lastLoginAt:m});return C&&Array.isArray(C)&&(S.providerData=C.map(function(e){return Object.assign({},e)})),g&&(S._redirectEventId=g),S}},{key:"_fromIdTokenResponse",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return rB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return(a=new $q).updateFromServerResponse(n),o=new e({uid:n.localId,auth:t,stsTokenManager:a,isAnonymous:r}),i.next=5,Vq(o);case 5:return i.abrupt("return",o);case 6:case"end":return i.stop()}},i)}))()}}]),e}(),Zq=function(){var e=function(){function e(){np(this,e),this.type="NONE",this.storage={}}return ip(e,[{key:"_isAvailable",value:function(){return rB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}},e)}))()}},{key:"_set",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n.storage[e]=t;case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.storage[e],n.abrupt("return",void 0===r?null:r);case 2:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:delete t.storage[e];case 1:case"end":return n.stop()}},n)}))()}},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();return e.type="NONE",e}();function Yq(e,t,n){return"firebase:".concat(e,":").concat(t,":").concat(n)}var Kq=function(){function e(t,n,r){np(this,e),this.persistence=t,this.auth=n,this.userKey=r;var i=this.auth,a=i.config,o=i.name;this.fullUserKey=Yq(this.userKey,a.apiKey,o),this.fullPersistenceKey=Yq("persistence",a.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return ip(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.persistence._get(e.fullUserKey);case 2:return n=t.sent,t.abrupt("return",n?jq._fromJSON(e.auth,n):null);case 4:case"end":return t.stop()}},t)}))()}},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.persistence!==e){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.getCurrentUser();case 4:return r=n.sent,n.next=7,t.removeCurrentUser();case 7:return t.persistence=e,n.abrupt("return",r?t.setCurrentUser(r):void 0);case 9:case"end":return n.stop()}},n)}))()}},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";return rB(regeneratorRuntime.mark(function i(){var a,o,s,u,c,l,h,f,d,v;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(n.length){i.next=2;break}return i.abrupt("return",new e(cq(Zq),t,r));case 2:return i.next=4,Promise.all(n.map(function(){var e=rB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 4:a=i.sent.filter(function(e){return e}),o=a[0]||cq(Zq),s=Yq(r,t.config.apiKey,t.name),u=null,c=Xv(n),i.prev=9,c.s();case 11:if((l=c.n()).done){i.next=27;break}return h=l.value,i.prev=13,i.next=16,h._get(s);case 16:if(!(f=i.sent)){i.next=21;break}return d=jq._fromJSON(t,f),h!==o&&(u=d),o=h,i.abrupt("break",27);case 21:i.next=25;break;case 23:i.prev=23,i.t0=i.catch(13);case 25:i.next=11;break;case 27:i.next=32;break;case 29:i.prev=29,i.t1=i.catch(9),c.e(i.t1);case 32:return i.prev=32,c.f(),i.finish(32);case 35:if(v=a.filter(function(e){return e._shouldAllowMigration}),!o._shouldAllowMigration||!v.length){i.next=47;break}if(o=v[0],i.t3=u,!i.t3){i.next=42;break}return i.next=42,o._set(s,u.toJSON());case 42:return i.next=44,Promise.all(n.map(function(){var e=rB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t===o){e.next=8;break}return e.prev=1,e.next=4,t._remove(s);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}()));case 44:i.t2=new e(o,t,r),i.next=48;break;case 47:i.t2=new e(o,t,r);case 48:return i.abrupt("return",i.t2);case 49:case"end":return i.stop()}},i,null,[[9,29,32,35],[13,23]])}))()}}]),e}();function Jq(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(t$(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Qq(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(r$(t))return"Blackberry";if(i$(t))return"Webos";if(Xq(t))return"Safari";if((t.includes("chrome/")||e$(t))&&!t.includes("edge/"))return"Chrome";if(n$(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null==n?void 0:n.length)?n[1]:"Other"}function Qq(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB();return/firefox\//i.test(e)}function Xq(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB(),t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function e$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB();return/crios\//i.test(e)}function t$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB();return/iemobile/i.test(e)}function n$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB();return/android/i.test(e)}function r$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB();return/blackberry/i.test(e)}function i$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB();return/webos/i.test(e)}function a$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB();return/iphone|ipad|ipod/i.test(e)}function o$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB();return a$(e)||n$(e)||i$(e)||r$(e)||/windows phone/i.test(e)||t$(e)}function s$(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Jq(CB());break;case"Worker":t="".concat(Jq(CB()),"-").concat(e);break;default:t=e}return"".concat(t,"/JsCore/9.6.6/").concat(n.length?n.join(","):"FirebaseCore-web")}var u$=function(){function e(t,n){np(this,e),this.app=t,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new l$(this),this.idTokenSubscription=new l$(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=JG,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=n.sdkClientVersion}return ip(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=cq(t)),this._initializationPromise=this.queue(rB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=!n._deleted,!r.t0){r.next=6;break}return r.next=4,Kq.create(n,e);case 4:n.persistenceManager=r.sent,r.t0=!n._deleted;case 6:if(!r.t0){r.next=19;break}if(!(null===(i=n._popupRedirectResolver)||void 0===i?void 0:i._shouldInitProactively)){r.next=15;break}return r.prev=8,r.next=11,n._popupRedirectResolver._initialize(n);case 11:r.next=15;break;case 13:r.prev=13,r.t1=r.catch(8);case 15:return r.next=17,n.initializeCurrentUser(t);case 17:n.lastNotifiedUid=(null===(a=n.currentUser)||void 0===a?void 0:a.uid)||null,!n._deleted&&(n._isInitialized=!0);case 19:case"end":return r.stop()}},r,null,[[8,13]])}))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._deleted){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.assertedPersistence.getCurrentUser();case 4:if(n=t.sent,!e.currentUser&&!n){t.next=13;break}if(!e.currentUser||!n||e.currentUser.uid!==n.uid){t.next=11;break}return e._currentUser._assign(n),t.next=10,e.currentUser.getIdToken();case 10:return t.abrupt("return",void t.sent);case 11:return t.next=13,e._updateCurrentUser(n);case 13:case"end":return t.stop()}},t)}))()}},{key:"initializeCurrentUser",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i,a,o,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.getCurrentUser();case 2:if(i=n.sent,!e||!t.config.authDomain){n.next=12;break}return n.next=6,t.getOrInitRedirectPersistenceManager();case 6:return a=null===(r=t.redirectUser)||void 0===r?void 0:r._redirectEventId,o=null==i?void 0:i._redirectEventId,n.next=10,t.tryRedirectSignIn(e);case 10:s=n.sent,(!a||a===o)&&(null==s?void 0:s.user)&&(i=s.user);case 12:if(!i){n.next=24;break}if(!i._redirectEventId){n.next=20;break}return aq(t._popupRedirectResolver,t,"argument-error"),n.next=17,t.getOrInitRedirectPersistenceManager();case 17:n.t1=t.redirectUser&&t.redirectUser._redirectEventId===i._redirectEventId?t.directlySetCurrentUser(i):t.reloadAndSetCurrentUserOrClear(i),n.next=21;break;case 20:n.t1=t.reloadAndSetCurrentUserOrClear(i);case 21:n.t0=n.t1,n.next=25;break;case 24:n.t0=t.directlySetCurrentUser(null);case 25:return n.abrupt("return",n.t0);case 26:case"end":return n.stop()}},n)}))()}},{key:"tryRedirectSignIn",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=null,n.prev=1,n.next=4,t._popupRedirectResolver._completeRedirectFn(t,e,!0);case 4:r=n.sent,n.next=11;break;case 7:return n.prev=7,n.t0=n.catch(1),n.next=11,t._setRedirectUser(null);case 11:return n.abrupt("return",r);case 12:case"end":return n.stop()}},n,null,[[1,7]])}))()}},{key:"reloadAndSetCurrentUserOrClear",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Vq(e);case 3:n.next=9;break;case 5:if(n.prev=5,n.t0=n.catch(0),"auth/network-request-failed"===n.t0.code){n.next=9;break}return n.abrupt("return",t.directlySetCurrentUser(null));case 9:return n.abrupt("return",t.directlySetCurrentUser(e));case 10:case"end":return n.stop()}},n,null,[[0,5]])}))()}},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"==typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e._deleted=!0;case 1:case"end":return t.stop()}},t)}))()}},{key:"updateCurrentUser",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e?JB(e):null,n.abrupt("return",(r&&aq(r.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(r&&r._clone(t))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_updateCurrentUser",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t._deleted){n.next=2;break}return n.abrupt("return",(e&&aq(t.tenantId===e.tenantId,t,"tenant-id-mismatch"),t.queue(rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.directlySetCurrentUser(e);case 2:t.notifyAuthListeners();case 3:case"end":return n.stop()}},n)})))));case 2:case"end":return n.stop()}},n)}))()}},{key:"signOut",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.redirectPersistenceManager||e._popupRedirectResolver,!t.t0){t.next=4;break}return t.next=4,e._setRedirectUser(null);case 4:return t.abrupt("return",e._updateCurrentUser(null));case 5:case"end":return t.stop()}},t)}))()}},{key:"setPersistence",value:function(e){var t=this;return this.queue(rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(cq(e));case 2:case"end":return n.stop()}},n)})))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new AB("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getOrInitRedirectPersistenceManager(t);case 2:return i=r.sent,r.abrupt("return",null===e?i.removeCurrentUser():i.setCurrentUser(e));case 4:case"end":return r.stop()}},r)}))()}},{key:"getOrInitRedirectPersistenceManager",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.redirectPersistenceManager){n.next=9;break}return aq(r=e&&cq(e)||t._popupRedirectResolver,t,"argument-error"),n.next=5,Kq.create(t,[cq(r._redirectPersistence)],"redirectUser");case 5:return t.redirectPersistenceManager=n.sent,n.next=8,t.redirectPersistenceManager.getCurrentUser();case 8:t.redirectUser=n.sent;case 9:return n.abrupt("return",t.redirectPersistenceManager);case 10:case"end":return n.stop()}},n)}))()}},{key:"_redirectUserForId",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=t._isInitialized,!n.t0){n.next=4;break}return n.next=4,t.queue(rB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})));case 4:return n.abrupt("return",(null===(r=t._currentUser)||void 0===r?void 0:r._redirectEventId)===e?t._currentUser:(null===(i=t.redirectUser)||void 0===i?void 0:i._redirectEventId)===e?t.redirectUser:null);case 5:case"end":return n.stop()}},n)}))()}},{key:"_persistUserIfCurrent",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e!==t.currentUser){n.next=2;break}return n.abrupt("return",t.queue(rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.directlySetCurrentUser(e));case 1:case"end":return n.stop()}},n)}))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var i=this;if(this._deleted)return function(){};var a="function"==typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return aq(o,this,"internal-error"),o.then(function(){return a(i.currentUser)}),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.currentUser&&t.currentUser!==e&&(t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh()),t.currentUser=e,!e){n.next=7;break}return n.next=5,t.assertedPersistence.setCurrentUser(e);case 5:n.next=9;break;case 7:return n.next=9,t.assertedPersistence.removeCurrentUser();case 9:case"end":return n.stop()}},n)}))()}},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return aq(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=s$(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={"X-Client-Version":e.clientVersion},t.abrupt("return",(e.app.options.appId&&(n["X-Firebase-gmpid"]=e.app.options.appId),n));case 2:case"end":return t.stop()}},t)}))()}}]),e}();function c$(e){return JB(e)}var l$=function(){function e(t){var n,r=this;np(this,e),this.auth=t,this.observer=null,this.addObserver=(n=new WB(function(e){return r.observer=e},void 0)).subscribe.bind(n)}return ip(e,[{key:"next",get:function(){return aq(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}();function h$(e){var t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function f$(e){if(!e)return null;var t=Number(e);return isNaN(t)?null:t}var d$=function(){function e(t,n){np(this,e),this.providerId=t,this.signInMethod=n}return ip(e,[{key:"toJSON",value:function(){return oq("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return oq("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return oq("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return oq("not implemented")}}]),e}();function v$(){return(v$=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",mq(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function p$(){return(p$=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Cq(t,"POST","/v1/accounts:signInWithPassword",yq(t,n)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function g$(e,t){return y$.apply(this,arguments)}function y$(){return(y$=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",mq(t,"POST","/v1/accounts:sendOobCode",yq(t,n)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function m$(e,t){return k$.apply(this,arguments)}function k$(){return(k$=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",g$(t,n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function _$(e,t){return w$.apply(this,arguments)}function w$(){return(w$=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",g$(t,n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function C$(){return(C$=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Cq(t,"POST","/v1/accounts:signInWithEmailLink",yq(t,n)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function b$(){return(b$=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Cq(t,"POST","/v1/accounts:signInWithEmailLink",yq(t,n)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var E$=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return np(this,n),(a=t.call(this,"password",i))._email=e,a._password=r,a._tenantId=o,a}return ip(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=t.signInMethod,n.next="password"===n.t0?3:"emailLink"===n.t0?4:5;break;case 3:return n.abrupt("return",function(e,t){return p$.apply(this,arguments)}(e,{returnSecureToken:!0,email:t._email,password:t._password}));case 4:return n.abrupt("return",function(e,t){return C$.apply(this,arguments)}(e,{email:t._email,oobCode:t._password}));case 5:eq(e,"internal-error");case 6:case"end":return n.stop()}},n)}))()}},{key:"_linkToIdToken",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:r.t0=n.signInMethod,r.next="password"===r.t0?3:"emailLink"===r.t0?4:5;break;case 3:return r.abrupt("return",function(e,t){return v$.apply(this,arguments)}(e,{idToken:t,returnSecureToken:!0,email:n._email,password:n._password}));case 4:return r.abrupt("return",function(e,t){return b$.apply(this,arguments)}(e,{idToken:t,email:n._email,oobCode:n._password}));case 5:eq(e,"internal-error");case 6:case"end":return r.stop()}},r)}))()}},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new n(e,t,"emailLink",r)}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(d$);function S$(e,t){return P$.apply(this,arguments)}function P$(){return(P$=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Cq(t,"POST","/v1/accounts:signInWithIdp",yq(t,n)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var O$=function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return ip(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return S$(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,S$(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,S$(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=HB(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):eq("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e,r=t.providerId,i=t.signInMethod,a=Bp(t,["providerId","signInMethod"]);if(!r||!i)return null;var o=new n(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}}]),n}(d$),T$=function(){function e(t){var n,r,i,a,o,s;np(this,e);var u=GB(qB(t)),c=null!==(n=u.apiKey)&&void 0!==n?n:null,l=null!==(r=u.oobCode)&&void 0!==r?r:null,h=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=u.mode)&&void 0!==i?i:null);aq(c&&l&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=l,this.continueUrl=null!==(a=u.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=u.tenantId)&&void 0!==s?s:null}return ip(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=GB(qB(e)).link,n=t?GB(qB(t)).deep_link_id:null,r=GB(qB(e)).deep_link_id;return(r?GB(qB(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(r){return null}}}]),e}(),I$=function(){var e=function(){function e(){np(this,e),this.providerId=e.PROVIDER_ID}return ip(e,null,[{key:"credential",value:function(e,t){return E$._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=T$.parseLink(t);return aq(n,"argument-error"),E$._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();return e.PROVIDER_ID="password",e.EMAIL_PASSWORD_SIGN_IN_METHOD="password",e.EMAIL_LINK_SIGN_IN_METHOD="emailLink",e}(),x$=function(){function e(t){np(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return ip(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),A$=function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.apply(this,arguments)).scopes=[],e}return ip(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return Jv(this.scopes)}}]),n}(x$),R$=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return ip(n,null,[{key:"credential",value:function(e,t){return O$._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,i=t.oauthAccessToken;if(!r&&!i)return null;try{return n.credential(r,i)}catch(a){return null}}}]),n}(A$);return e.GOOGLE_SIGN_IN_METHOD="google.com",e.PROVIDER_ID="google.com",e}();function N$(e,t){return M$.apply(this,arguments)}function M$(){return(M$=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Cq(t,"POST","/v1/accounts:signUp",yq(t,n)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var D$=function(){function e(t){np(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return ip(e,null,[{key:"_fromIdTokenResponse",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return rB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,jq._fromIdTokenResponse(t,r,i);case 2:return o=a.sent,s=L$(r),a.abrupt("return",new e({user:o,providerId:s,_tokenResponse:r,operationType:n}));case 5:case"end":return a.stop()}},a)}))()}},{key:"_forOperation",value:function(t,n,r){return rB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t._updateTokensIfNecessary(r,!0);case 2:return a=L$(r),i.abrupt("return",new e({user:t,providerId:a,_tokenResponse:r,operationType:n}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function L$(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}var F$=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a){var o,s;return np(this,n),(o=t.call(this,r.code,r.message)).operationType=i,o.user=a,Object.setPrototypeOf(Zv(o),n.prototype),o.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:r.customData._serverResponse,operationType:i},o}return ip(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,i){return new n(e,t,r,i)}}]),n}(xB);function B$(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(function(n){throw"auth/multi-factor-auth-required"===n.code?F$._fromErrorAndOperation(e,n,t,r):n})}function V$(e,t){return U$.apply(this,arguments)}function U$(){return(U$=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]&&a[2],e.t0=Mq,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return i=e.sent,e.abrupt("return",D$._forOperation(t,"link",i));case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function z$(){return(z$=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>2&&void 0!==c[2]&&c[2],i=t.auth,a="reauthenticate",e.prev=2,e.next=5,Mq(t,B$(i,a,n,t),r);case 5:return aq((o=e.sent).idToken,i,"internal-error"),aq(s=Nq(o.idToken),i,"internal-error"),u=s.sub,e.abrupt("return",(aq(t.uid===u,i,"user-mismatch"),D$._forOperation(t,a,o)));case 13:throw e.prev=13,e.t0=e.catch(2),"auth/user-not-found"===(null==e.t0?void 0:e.t0.code)&&eq(i,"user-mismatch"),e.t0;case 16:case"end":return e.stop()}},e,null,[[2,13]])}))).apply(this,arguments)}function H$(e,t){return G$.apply(this,arguments)}function G$(){return(G$=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i="signIn",e.next=4,B$(t,i,n);case 4:return a=e.sent,e.next=7,D$._fromIdTokenResponse(t,i,a);case 7:if(o=e.sent,e.t0=r,e.t0){e.next=12;break}return e.next=12,t._updateCurrentUser(o.user);case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function q$(){return(q$=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",H$(c$(t),n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function $$(e,t,n){var r;aq((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),aq(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(aq(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(aq(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function W$(){return(W$=rB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=JB(t),a={requestType:"PASSWORD_RESET",email:n},r&&$$(i,a,r),e.next=4,_$(i,a);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function j$(){return(j$=rB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=c$(t),e.next=3,N$(i,{returnSecureToken:!0,email:n,password:r});case 3:return a=e.sent,e.next=6,D$._fromIdTokenResponse(i,"signIn",a);case 6:return o=e.sent,e.next=9,i._updateCurrentUser(o.user);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Z$(){return(Z$=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=JB(t),e.next=3,t.getIdToken();case 3:return e.t0=e.sent,i={requestType:"VERIFY_EMAIL",idToken:e.t0},n&&$$(r.auth,i,n),e.next=8,m$(r.auth,i);case 8:if(a=e.sent,o=a.email,e.t1=o!==t.email,!e.t1){e.next=14;break}return e.next=14,t.reload();case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Y$(e,t){return K$.apply(this,arguments)}function K$(){return(K$=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",mq(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function J$(){return(J$=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.displayName,i=n.photoURL,void 0!==r||void 0!==i){e.next=3;break}return e.abrupt("return");case 3:return a=JB(t),e.next=6,a.getIdToken();case 6:return e.t0=e.sent,e.t1=r,e.t2=i,e.t3=!0,o={idToken:e.t0,displayName:e.t1,photoUrl:e.t2,returnSecureToken:e.t3},e.next=13,Mq(a,Y$(a.auth,o));case 13:return s=e.sent,a.displayName=s.displayName||null,a.photoURL=s.photoUrl||null,(u=a.providerData.find(function(e){return"password"===e.providerId}))&&(u.displayName=a.displayName,u.photoURL=a.photoURL),e.next=19,a._updateTokensIfNecessary(s);case 19:case"end":return e.stop()}},e)}))).apply(this,arguments)}new WeakMap;var Q$="__sak",X$=function(){function e(t,n){np(this,e),this.storageRetriever=t,this.type=n}return ip(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(Q$,"1"),this.storage.removeItem(Q$),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}(),eW=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.call(this,function(){return window.localStorage},"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.safariLocalStorageNotSynced=function(){var e=CB();return Xq(e)||a$(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),e.fallbackToPolling=o$(),e._shouldAllowMigration=!0,e}return ip(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],i=this.storage.getItem(r),a=this.localCache[r];i!==a&&e(r,a,i)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}var a=function(){var e=t.storage.getItem(r);!n&&t.localCache[r]===e||t.notifyListeners(r,e)},o=this.storage.getItem(r);PB()&&10===document.documentMode&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,10):a()}else this.forAllChangedKeys(function(e,n,r){t.notifyListeners(e,r)})}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t&&JSON.parse(t))}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(function(){e.forAllChangedKeys(function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)})},1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(e,t){var r=this,i=this;return rB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Hv(Kv(n.prototype),"_set",r).call(i,e,t);case 2:i.localCache[e]=JSON.stringify(t);case 3:case"end":return a.stop()}},a)}))()}},{key:"_get",value:function(e){var t=this,r=this;return rB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Hv(Kv(n.prototype),"_get",t).call(r,e);case 2:return a=i.sent,i.abrupt("return",(r.localCache[e]=JSON.stringify(a),a));case 4:case"end":return i.stop()}},i)}))()}},{key:"_remove",value:function(e){var t=this,r=this;return rB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Hv(Kv(n.prototype),"_remove",t).call(r,e);case 2:delete r.localCache[e];case 3:case"end":return i.stop()}},i)}))()}}]),n}(X$);return e.type="LOCAL",e}(),tW=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.call(this,function(){return window.sessionStorage},"SESSION")}return ip(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(X$);return e.type="SESSION",e}(),nW=function(){var e=function(){function e(t){np(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return ip(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=(r=e).data,a=i.eventId,o=i.eventType,s=i.data,null==(u=t.handlersMap[o])?void 0:u.size){n.next=3;break}return n.abrupt("return");case 3:return r.ports[0].postMessage({status:"ack",eventId:a,eventType:o}),c=Array.from(u).map(function(){var e=rB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(r.origin,s));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.next=7,function(e){return Promise.all(e.map((t=rB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=!0,e.next=4,t;case 4:return e.t1=e.sent,e.abrupt("return",{fulfilled:e.t0,value:e.t1});case 8:return e.prev=8,e.t2=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t2});case 11:case"end":return e.stop()}},e,null,[[0,8]])})),function(e){return t.apply(this,arguments)})));var t}(c);case 7:l=n.sent,r.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:l});case 9:case"end":return n.stop()}},n)}))()}},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find(function(e){return e.isListeningto(t)});if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();return e.receivers=[],e}();function rW(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}var iW=function(){function e(t){np(this,e),this.target=t,this.handlers=new Set}return ip(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=this;return rB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a="undefined"!=typeof MessageChannel?new MessageChannel:null){i.next=3;break}throw new Error("connection_unavailable");case 3:return i.abrupt("return",new Promise(function(i,u){var c=rW("",20);a.port1.start();var l=setTimeout(function(){u(new Error("unsupported_event"))},n);s={messageChannel:a,onMessage:function(e){var t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),o=setTimeout(function(){u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),i(t.data.response);break;default:clearTimeout(l),clearTimeout(o),u(new Error("invalid_response"))}}},r.handlers.add(s),a.port1.addEventListener("message",s.onMessage),r.target.postMessage({eventType:e,eventId:c,data:t},[a.port2])}).finally(function(){s&&r.removeMessageHandler(s)}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function aW(){return window}function oW(){return void 0!==aW().WorkerGlobalScope&&"function"==typeof aW().importScripts}function sW(){return(sW=rB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return e.abrupt("return",e.sent.active);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",null);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var uW="firebaseLocalStorageDb",cW="firebaseLocalStorage",lW="fbase_key",hW=function(){function e(t){np(this,e),this.request=t}return ip(e,[{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.request.addEventListener("success",function(){t(e.request.result)}),e.request.addEventListener("error",function(){n(e.request.error)})})}}]),e}();function fW(e,t){return e.transaction([cW],t?"readwrite":"readonly").objectStore(cW)}function dW(){var e=indexedDB.open(uW,1);return new Promise(function(t,n){e.addEventListener("error",function(){n(e.error)}),e.addEventListener("upgradeneeded",function(){var t=e.result;try{t.createObjectStore(cW,{keyPath:lW})}catch(r){n(r)}}),e.addEventListener("success",rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=e.result).objectStoreNames.contains(cW)){n.next=5;break}t(r),n.next=13;break;case 5:return r.close(),n.next=8,function(){var e=indexedDB.deleteDatabase(uW);return new hW(e).toPromise()}();case 8:return n.t0=t,n.next=11,dW();case 11:n.t1=n.sent,(0,n.t0)(n.t1);case 13:case"end":return n.stop()}},n)})))})}function vW(e,t,n){return pW.apply(this,arguments)}function pW(){return(pW=rB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=fW(t,!0).put((Lv(i={},lW,n),Lv(i,"value",r),i)),e.abrupt("return",new hW(a).toPromise());case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function gW(){return(gW=rB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=fW(t,!1).get(n),e.next=3,new hW(r).toPromise();case 3:return i=e.sent,e.abrupt("return",void 0===i?null:i.value);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function yW(e,t){var n=fW(e,!0).delete(t);return new hW(n).toPromise()}var mW=function(){var e=function(){function e(){np(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(function(){},function(){})}return ip(e,[{key:"_openDb",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.db,t.t0){t.next=5;break}return t.next=4,dW();case 4:e.db=t.sent;case 5:return t.abrupt("return",e.db);case 6:case"end":return t.stop()}},t)}))()}},{key:"_withRetries",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=0;case 1:return n.prev=1,n.next=4,t._openDb();case 4:return i=n.sent,n.next=7,e(i);case 7:return n.abrupt("return",n.sent);case 10:if(n.prev=10,n.t0=n.catch(1),!(r++>3)){n.next=14;break}throw n.t0;case 14:t.db&&(t.db.close(),t.db=void 0);case 15:n.next=1;break;case 17:case"end":return n.stop()}},n,null,[[1,10]])}))()}},{key:"initializeServiceWorkerMessaging",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",oW()?e.initializeReceiver():e.initializeSender());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeReceiver",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.receiver=nW._getInstance(oW()?self:null),e.receiver._subscribe("keyChanged",function(){var t=rB(regeneratorRuntime.mark(function t(n,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._poll();case 2:return t.t0=t.sent.includes(r.key),t.abrupt("return",{keyProcessed:t.t0});case 4:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var e=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeSender",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(){return sW.apply(this,arguments)}();case 2:if(e.activeServiceWorker=t.sent,e.activeServiceWorker){t.next=5;break}return t.abrupt("return");case 5:return e.sender=new iW(e.activeServiceWorker),t.next=8,e.sender._send("ping",{},800);case 8:!(i=t.sent)||(null===(n=i[0])||void 0===n?void 0:n.fulfilled)&&(null===(r=i[0])||void 0===r?void 0:r.value.includes("keyChanged"))&&(e.serviceWorkerReceiverAvailable=!0);case 10:case"end":return t.stop()}},t)}))()}},{key:"notifyServiceWorker",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.sender||!t.activeServiceWorker||function(){var e;return(null===(e=null==navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()!==t.activeServiceWorker){n.next=8;break}return n.prev=1,n.next=4,t.sender._send("keyChanged",{key:e},t.serviceWorkerReceiverAvailable?800:50);case 4:n.next=8;break;case 6:n.prev=6,n.t0=n.catch(1);case 8:case"end":return n.stop()}},n,null,[[1,6]])}))()}},{key:"_isAvailable",value:function(){return rB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,dW();case 5:return t=e.sent,e.next=8,vW(t,Q$,"1");case 8:return e.next=10,yW(t,Q$);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}},e,null,[[0,13]])}))()}},{key:"_withPendingWrite",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.pendingWrites++,n.prev=1,n.next=4,e();case 4:return n.prev=4,t.pendingWrites--,n.finish(4);case 7:case"end":return n.stop()}},n,null,[[1,,4,7]])}))()}},{key:"_set",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n._withPendingWrite(rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n._withRetries(function(n){return vW(n,e,t)});case 2:return n.localCache[e]=t,r.abrupt("return",n.notifyServiceWorker(e));case 4:case"end":return r.stop()}},r)}))));case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return function(e,t){return gW.apply(this,arguments)}(t,e)});case 2:return r=n.sent,n.abrupt("return",(t.localCache[e]=r,r));case 4:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t._withPendingWrite(rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return yW(t,e)});case 2:return delete t.localCache[e],n.abrupt("return",t.notifyServiceWorker(e));case 4:case"end":return n.stop()}},n)}))));case 1:case"end":return n.stop()}},n)}))()}},{key:"_poll",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s,u,c,l,h,f;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._withRetries(function(e){var t=fW(e,!1).getAll();return new hW(t).toPromise()});case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return",[]);case 5:if(0===e.pendingWrites){t.next=7;break}return t.abrupt("return",[]);case 7:r=[],i=new Set,a=Xv(n);try{for(a.s();!(o=a.n()).done;)s=o.value,u=s.fbase_key,c=s.value,i.add(u),JSON.stringify(e.localCache[u])!==JSON.stringify(c)&&(e.notifyListeners(u,c),r.push(u))}catch(d){a.e(d)}finally{a.f()}for(l=0,h=Object.keys(e.localCache);l<h.length;l++)f=h[l],e.localCache[f]&&!i.has(f)&&(e.notifyListeners(f,null),r.push(f));return t.abrupt("return",r);case 12:case"end":return t.stop()}},t)}))()}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}},t)})),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();return e.type="LOCAL",e}();function kW(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}function _W(e,t){return t?cq(t):(aq(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}kW("rcb"),new fq(3e4,6e4);var wW=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,"custom","custom")).params=e,r}return ip(n,[{key:"_getIdTokenResponse",value:function(e){return S$(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return S$(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return S$(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(d$);function CW(e){return H$(e.auth,new wW(e),e.bypassAuthState)}function bW(e){var t=e.auth,n=e.user;return aq(n,t,"internal-error"),function(e,t){return z$.apply(this,arguments)}(n,new wW(e),e.bypassAuthState)}function EW(e){return SW.apply(this,arguments)}function SW(){return(SW=rB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,r=t.user,e.abrupt("return",(aq(r,n,"internal-error"),V$(r,new wW(t),t.bypassAuthState)));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}var PW=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];np(this,e),this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return ip(e,[{key:"execute",value:function(){var e,t=this;return new Promise((e=rB(regeneratorRuntime.mark(function e(n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.pendingPromise={resolve:n,reject:r},e.prev=1,e.next=4,t.resolver._initialize(t.auth);case 4:return t.eventManager=e.sent,e.next=7,t.onExecution();case 7:t.eventManager.registerConsumer(t),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),t.reject(e.t0);case 13:case"end":return e.stop()}},e,null,[[1,10]])})),function(t,n){return e.apply(this,arguments)}))}},{key:"onAuthEvent",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.urlResponse,i=e.sessionId,a=e.postBody,o=e.tenantId,s=e.error,u=e.type,!s){n.next=3;break}return n.abrupt("return",void t.reject(s));case 3:return c={auth:t.auth,requestUri:r,sessionId:i,tenantId:o||void 0,postBody:a||void 0,user:t.user,bypassAuthState:t.bypassAuthState},n.prev=4,n.t0=t,n.next=8,t.getIdpTask(u)(c);case 8:n.t1=n.sent,n.t0.resolve.call(n.t0,n.t1),n.next=15;break;case 12:n.prev=12,n.t2=n.catch(4),t.reject(n.t2);case 15:case"end":return n.stop()}},n,null,[[4,12]])}))()}},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return CW;case"linkViaPopup":case"linkViaRedirect":return EW;case"reauthViaPopup":case"reauthViaRedirect":return bW;default:eq(this.auth,"internal-error")}}},{key:"resolve",value:function(e){sq(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){sq(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),OW=new fq(2e3,1e4);function TW(){return(TW=rB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=c$(t),rq(t,n,x$),a=_W(i,r),e.abrupt("return",new IW(i,"signInViaPopup",n,a).executeNotNull());case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var IW=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o){var s;return np(this,n),(s=t.call(this,e,r,a,o)).provider=i,s.authWindow=null,s.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=Zv(s),s}return ip(n,[{key:"executeNotNull",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.execute();case 2:return n=t.sent,t.abrupt("return",(aq(n,e.auth,"internal-error"),n));case 4:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return sq(1===e.filter.length,"Popup operations only handle one event"),n=rW(),t.next=4,e.resolver._openPopup(e.auth,e.provider,e.filter[0],n);case 4:e.authWindow=t.sent,e.authWindow.associatedEvent=n,e.resolver._originValidation(e.auth).catch(function(t){e.reject(t)}),e.resolver._isIframeWebStorageSupported(e.auth,function(t){t||e.reject(tq(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation();case 9:case"end":return t.stop()}},t)}))()}},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(tq(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;e.pollId=(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?window.setTimeout(function(){e.pollId=null,e.reject(tq(e.auth,"popup-closed-by-user"))},2e3):window.setTimeout(t,OW.get())}()}}]),n}(PW);return e.currentPopupAction=null,e}(),xW=new Map,AW=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return np(this,n),(i=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,a)).eventId=null,i}return ip(n,[{key:"execute",value:function(){var e=this,t=this;return rB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=xW.get(t.auth._key())){r.next=20;break}return r.prev=2,r.next=5,function(e,t){return RW.apply(this,arguments)}(t.resolver,t.auth);case 5:if(!r.sent){r.next=11;break}return r.next=8,Hv(Kv(n.prototype),"execute",e).call(t);case 8:r.t0=r.sent,r.next=12;break;case 11:r.t0=null;case 12:a=r.t0,i=function(){return Promise.resolve(a)},r.next=19;break;case 16:r.prev=16,r.t1=r.catch(2),i=function(){return Promise.reject(r.t1)};case 19:xW.set(t.auth._key(),i);case 20:return r.abrupt("return",(t.bypassAuthState||xW.set(t.auth._key(),function(){return Promise.resolve(null)}),i()));case 21:case"end":return r.stop()}},r,null,[[2,16]])}))()}},{key:"onAuthEvent",value:function(e){var t=this,r=function(){return Hv(Kv(n.prototype),"onAuthEvent",t)},i=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("signInViaRedirect"!==e.type){t.next=2;break}return t.abrupt("return",r().call(i,e));case 2:if("unknown"===e.type){t.next=12;break}if(!e.eventId){t.next=10;break}return t.next=6,i.auth._redirectUserForId(e.eventId);case 6:if(!(n=t.sent)){t.next=9;break}return t.abrupt("return",(i.user=n,r().call(i,e)));case 9:i.resolve(null);case 10:t.next=13;break;case 12:i.resolve(null);case 13:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){return rB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))()}},{key:"cleanUp",value:function(){}}]),n}(PW);function RW(){return(RW=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=MW(n),i=NW(t),e.next=3,i._isAvailable();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,i._get(r);case 7:return e.t0=e.sent,a="true"===e.t0,e.next=11,i._remove(r);case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function NW(e){return cq(e._redirectPersistence)}function MW(e){return Yq("pendingRedirect",e.config.apiKey,e.name)}function DW(e,t){return LW.apply(this,arguments)}function LW(){return(LW=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i=c$(t),a=_W(i,n),e.next=5,new AW(i,a,r).execute();case 5:if(o=e.sent,e.t0=o&&!r,!e.t0){e.next=13;break}return delete o.user._redirectEventId,e.next=11,i._persistUserIfCurrent(o.user);case 11:return e.next=13,i._setRedirectUser(null,n);case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}var FW=function(){function e(t){np(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return ip(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach(function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return VW(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!VW(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(tq(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(BW(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(BW(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function BW(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(function(e){return e}).join("-")}function VW(e){var t=e.type,n=e.error;return"unknown"===t&&"auth/no-auth-event"===(null==n?void 0:n.code)}function UW(e){return zW.apply(this,arguments)}function zW(){return(zW=rB(regeneratorRuntime.mark(function e(t){var n,r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",mq(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}var HW=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,GW=/^https?/;function qW(){return(qW=rB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,UW(t);case 4:n=e.sent,r=n.authorizedDomains,i=Xv(r),e.prev=7,i.s();case 9:if((a=i.n()).done){e.next=20;break}if(o=a.value,e.prev=11,!$W(o)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),i.e(e.t1);case 25:return e.prev=25,i.f(),e.finish(25);case 28:eq(t,"unauthorized-domain");case 29:case"end":return e.stop()}},e,null,[[7,22,25,28],[11,16]])}))).apply(this,arguments)}function $W(e){var t=lq(),n=new URL(t),r=n.protocol,i=n.hostname;if(e.startsWith("chrome-extension://")){var a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===i}if(!GW.test(r))return!1;if(HW.test(e))return i===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}var WW=new fq(3e4,6e4);function jW(){var e=aW().___jsl;if(null==e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=Jv(e.H[r].L),e.CP)for(var i=0;i<e.CP.length;i++)e.CP[i]=null}}var ZW=null;function YW(e){return ZW=ZW||function(e){return new Promise(function(t,n){var r,i,a;function o(){jW(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){jW(),n(tq(e,"network-request-failed"))},timeout:WW.get()})}if(null===(i=null===(r=aW().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=aW().gapi)||void 0===a?void 0:a.load)){var s=kW("iframefcb");return aW()[s]=function(){gapi.load?o():n(tq(e,"network-request-failed"))},function(e){return new Promise(function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=tq("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})}("https://apis.google.com/js/api.js?onload=".concat(s)).catch(function(e){return n(e)})}o()}}).catch(function(e){throw ZW=null,e})}(e)}var KW=new fq(5e3,15e3),JW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},QW=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function XW(e){var t=e.config;aq(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?dq(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:wV},i=QW.get(e.config.apiHost);i&&(r.eid=i);var a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(HB(r).slice(1))}function ej(){return(ej=rB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,YW(t);case 2:return n=e.sent,r=aW().gapi,e.abrupt("return",(aq(r,t,"internal-error"),n.open({where:document.body,url:XW(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:JW,dontclear:!0},function(e){return new Promise((n=rB(regeneratorRuntime.mark(function n(r,i){var a,o,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=function(){aW().clearTimeout(o),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:a=tq(t,"network-request-failed"),o=aW().setTimeout(function(){i(a)},KW.get()),e.ping(s).then(s,function(){i(a)});case 5:case"end":return n.stop()}},n)})),function(e,t){return n.apply(this,arguments)}));var n})));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var tj={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},nj=function(){function e(t){np(this,e),this.window=t,this.associatedEvent=null}return ip(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),e}();function rj(e,t,n,r,i,a){aq(e.config.authDomain,e,"auth-domain-config-required"),aq(e.config.apiKey,e,"invalid-api-key");var o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:wV,eventId:i};if(t instanceof x$){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",BB(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(var s=0,u=Object.entries(a||{});s<u.length;s++){var c=Fv(u[s],2),l=c[0],h=c[1];o[l]=h}}if(t instanceof A$){var f=t.getScopes().filter(function(e){return""!==e});f.length>0&&(o.scopes=f.join(","))}e.tenantId&&(o.tid=e.tenantId);for(var d=o,v=0,p=Object.keys(d);v<p.length;v++){var g=p[v];void 0===d[g]&&delete d[g]}return"".concat(function(e){var t=e.config;return t.emulator?dq(t,"emulator/auth/handler"):"https://".concat(t.authDomain,"/__/auth/handler")}(e),"?").concat(HB(d).slice(1))}var ij="webStorageSupport",aj=function(){function e(){np(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=tW,this._completeRedirectFn=DW}return ip(e,[{key:"_openPopup",value:function(e,t,n,r){var i=this;return rB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return sq(null===(o=i.eventManagers[e._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()"),s=rj(e,t,n,lq(),r),a.abrupt("return",function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),s="",u=Object.assign(Object.assign({},tj),{width:r.toString(),height:i.toString(),top:a,left:o}),c=CB().toLowerCase();n&&(s=e$(c)?"_blank":n),Qq(c)&&(t=t||"http://localhost",u.scrollbars="yes");var l=Object.entries(u).reduce(function(e,t){var n=Fv(t,2),r=n[0],i=n[1];return"".concat(e).concat(r,"=").concat(i,",")},"");if(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB();return a$(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==s)return function(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",s),new nj(null);var h=window.open(t||"",s,l);aq(h,e,"popup-blocked");try{h.focus()}catch(f){}return new nj(h)}(e,s,rW()));case 3:case"end":return a.stop()}},a)}))()}},{key:"_openRedirect",value:function(e,t,n,r){var i=this;return rB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i._originValidation(e);case 2:return function(e){aW().location.href=e}(rj(e,t,n,lq(),r)),a.abrupt("return",new Promise(function(){}));case 4:case"end":return a.stop()}},a)}))()}},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],i=r.manager,a=r.promise;return i?Promise.resolve(i):(sq(a,"If manager is not set, promise should be"),a)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch(function(){delete t.eventManagers[n]}),o}},{key:"initAndGetManager",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,function(e){return ej.apply(this,arguments)}(e);case 2:return r=n.sent,i=new FW(e),n.abrupt("return",(r.register("authEvent",function(t){return aq(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:i.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:i},t.iframes[e._key()]=r,i));case 5:case"end":return n.stop()}},n)}))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(ij,{type:ij},function(n){var r,i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[ij];void 0!==i&&t(!!i),eq(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return qW.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return o$()||Xq()||a$()}}]),e}(),oj="@firebase/auth",sj=function(){function e(t){np(this,e),this.auth=t,this.internalListeners=new Map}return ip(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.assertAuthConfigured(),n.next=3,t.auth._initializationPromise;case 3:if(!t.auth.currentUser){n.next=10;break}return n.next=6,t.auth.currentUser.getIdToken(e);case 6:n.t1=n.sent,n.t0={accessToken:n.t1},n.next=11;break;case 10:n.t0=null;case 11:return n.abrupt("return",n.t0);case 12:case"end":return n.stop()}},n)}))()}},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged(function(t){var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);!t||(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){aq(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();!function(e){yV(new QB("auth",function(t,n){var r=n.options,i=t.getProvider("app").getImmediate(),a=i.options,o=a.apiKey,s=a.authDomain;return function(t){aq(o&&!o.includes(":"),"invalid-api-key",{appName:t.name}),aq(!(null==s?void 0:s.includes(":")),"argument-error",{appName:t.name});var n={apiKey:o,authDomain:s,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:s$(e)},i=new u$(t,n);return function(e,t){var n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(cq);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(i,r),i}(i)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider("auth-internal").initialize()})),yV(new QB("auth-internal",function(e){var t=c$(e.getProvider("auth").getImmediate());return new sj(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),EV(oj,"0.19.8",void 0),EV(oj,"0.19.8","esm2017")}("Browser");var uj=ip(function e(t){return np(this,e),t}),cj=ip(function e(){return np(this,e),XH("auth")}),lj=new sk("angularfire2.auth-instances");function hj(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new uj(r)}}var fj,dj={provide:cj,deps:[[new Dk,lj]]},vj={provide:uj,useFactory:function(e,t){var n=QH("auth",e,t);return n&&new uj(n)},deps:[[new Dk,lj],lG]},pj=function(){var e=ip(function e(){np(this,e),EV("angularfire",ZH.full,"auth")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ay({type:e}),e.\u0275inj=Pg({providers:[vj,dj]}),e}(),gj=cG(function(e,t,n){var r=c$(e);aq(r._canInitEmulator,r,"emulator-config-failed"),aq(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");var i=!!(null==n?void 0:n.disableWarnings),a=h$(t),o=function(e){var t=h$(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};var r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){var a=i[1];return{host:a,port:f$(r.substr(a.length+1))}}var o=Fv(r.split(":"),2);return{host:o[0],port:f$(o[1])}}(t),s=o.host,u=o.port;r.config.emulator={url:"".concat(a,"//").concat(s).concat(null===u?"":":".concat(u),"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:s,port:u,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){var e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()},!0),yj=cG(function(e,t,n){return j$.apply(this,arguments)},!0),mj=cG(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CV(),t=mV(e,"auth");return t.isInitialized()?t.getImmediate():function(e,t){var n=mV(e,"auth");if(n.isInitialized()){var r=n.getImmediate();if(UB(n.getOptions(),null!=t?t:{}))return r;eq(r,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:aj,persistence:[mW,eW,tW]})},!0),kj=cG(function(e,t,n,r){return JB(e).onAuthStateChanged(t,n,r)},!0),_j=cG(function(e,t){return Z$.apply(this,arguments)},!0),wj=cG(function(e,t,n){return W$.apply(this,arguments)},!0),Cj=cG(function(e,t,n){return function(e,t){return q$.apply(this,arguments)}(JB(e),I$.credential(t,n))},!0),bj=cG(function(e,t,n){return TW.apply(this,arguments)},!0),Ej=cG(function(e,t){return J$.apply(this,arguments)},!0),Sj="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Pj={},Oj=Oj||{},Tj=Sj||self;function Ij(){}function xj(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function Aj(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var Rj="closure_uid_"+(1e9*Math.random()>>>0),Nj=0;function Mj(e,t,n){return e.call.apply(e.bind,arguments)}function Dj(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Lj(e,t,n){return(Lj=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Mj:Dj).apply(null,arguments)}function Fj(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function Bj(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function Vj(){this.s=this.s,this.o=this.o}var Uj={};Vj.prototype.s=!1,Vj.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,Rj)&&e[Rj]||(e[Rj]=++Nj)}(this);delete Uj[e]}},Vj.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var zj=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},Hj=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,a=0;a<r;a++)a in i&&t.call(n,i[a],a,e)};function Gj(e){return Array.prototype.concat.apply([],arguments)}function qj(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function $j(e){return/^[\s\xa0]*$/.test(e)}var Wj,jj=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function Zj(e,t){return-1!=e.indexOf(t)}function Yj(e,t){return e<t?-1:e>t?1:0}e:{var Kj=Tj.navigator;if(Kj){var Jj=Kj.userAgent;if(Jj){Wj=Jj;break e}}Wj=""}function Qj(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function Xj(e){var t={};for(var n in e)t[n]=e[n];return t}var eZ="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tZ(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<eZ.length;a++)n=eZ[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function nZ(e){return nZ[" "](e),e}nZ[" "]=Ij;var rZ,iZ=Zj(Wj,"Opera"),aZ=Zj(Wj,"Trident")||Zj(Wj,"MSIE"),oZ=Zj(Wj,"Edge"),sZ=oZ||aZ,uZ=Zj(Wj,"Gecko")&&!(Zj(Wj.toLowerCase(),"webkit")&&!Zj(Wj,"Edge"))&&!(Zj(Wj,"Trident")||Zj(Wj,"MSIE"))&&!Zj(Wj,"Edge"),cZ=Zj(Wj.toLowerCase(),"webkit")&&!Zj(Wj,"Edge");function lZ(){var e=Tj.document;return e?e.documentMode:void 0}e:{var hZ="",fZ=function(){var e=Wj;return uZ?/rv:([^\);]+)(\)|;)/.exec(e):oZ?/Edge\/([\d\.]+)/.exec(e):aZ?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):cZ?/WebKit\/(\S+)/.exec(e):iZ?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(fZ&&(hZ=fZ?fZ[1]:""),aZ){var dZ=lZ();if(null!=dZ&&dZ>parseFloat(hZ)){rZ=String(dZ);break e}}rZ=hZ}var vZ={};var pZ=Tj.document&&aZ&&(lZ()||parseInt(rZ,10))||void 0,gZ=function(){if(!Tj.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Tj.addEventListener("test",Ij,t),Tj.removeEventListener("test",Ij,t)}catch(n){}return e}();function yZ(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function mZ(e,t){if(yZ.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(uZ){e:{try{nZ(t.nodeName);var i=!0;break e}catch(a){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:kZ[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&mZ.Z.h.call(this)}}yZ.prototype.h=function(){this.defaultPrevented=!0},Bj(mZ,yZ);var kZ={2:"touch",3:"pen",4:"mouse"};mZ.prototype.h=function(){mZ.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var _Z="closure_listenable_"+(1e6*Math.random()|0),wZ=0;function CZ(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++wZ,this.ca=this.fa=!1}function bZ(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function EZ(e){this.src=e,this.g={},this.h=0}function SZ(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=zj(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(bZ(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function PZ(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.ca&&a.listener==t&&a.capture==!!n&&a.ia==r)return i}return-1}EZ.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=PZ(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new CZ(t,this.src,a,!!r,i)).fa=n,e.push(t)),t};var OZ="closure_lm_"+(1e6*Math.random()|0),TZ={};function IZ(e,t,n,r,i){if(r&&r.once)return AZ(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)IZ(e,t[a],n,r,i);return null}return n=BZ(n),e&&e[_Z]?e.N(t,n,Aj(r)?!!r.capture:!!r,i):xZ(e,t,n,!1,r,i)}function xZ(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=Aj(i)?!!i.capture:!!i,s=LZ(e);if(s||(e[OZ]=s=new EZ(e)),(n=s.add(t,n,r,o,a)).proxy)return n;if(r=function(){var e=DZ;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)gZ||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(MZ(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function AZ(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)AZ(e,t[a],n,r,i);return null}return n=BZ(n),e&&e[_Z]?e.O(t,n,Aj(r)?!!r.capture:!!r,i):xZ(e,t,n,!0,r,i)}function RZ(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)RZ(e,t[a],n,r,i);else r=Aj(r)?!!r.capture:!!r,n=BZ(n),e&&e[_Z]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=PZ(a=e.g[t],n,r,i))&&(bZ(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--))):e&&(e=LZ(e))&&(t=e.g[t.toString()],e=-1,t&&(e=PZ(t,n,r,i)),(n=-1<e?t[e]:null)&&NZ(n))}function NZ(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[_Z])SZ(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(MZ(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=LZ(t))?(SZ(n,e),0==n.h&&(n.src=null,t[OZ]=null)):bZ(e)}}}function MZ(e){return e in TZ?TZ[e]:TZ[e]="on"+e}function DZ(e,t){if(e.ca)e=!0;else{t=new mZ(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&NZ(e),e=n.call(r,t)}return e}function LZ(e){return(e=e[OZ])instanceof EZ?e:null}var FZ="__closure_events_fn_"+(1e9*Math.random()>>>0);function BZ(e){return"function"==typeof e?e:(e[FZ]||(e[FZ]=function(t){return e.handleEvent(t)}),e[FZ])}function VZ(){Vj.call(this),this.i=new EZ(this),this.P=this,this.I=null}function UZ(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new yZ(t,e);else if(t instanceof yZ)t.target=t.target||e;else{var i=t;tZ(t=new yZ(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=zZ(o,r,!0,t)&&i}if(i=zZ(o=t.g=e,r,!0,t)&&i,i=zZ(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=zZ(o=t.g=n[a],r,!1,t)&&i}function zZ(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.ca&&o.capture==n){var s=o.listener,u=o.ia||o.src;o.fa&&SZ(e.i,o),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}Bj(VZ,Vj),VZ.prototype[_Z]=!0,VZ.prototype.removeEventListener=function(e,t,n,r){RZ(this,e,t,n,r)},VZ.prototype.M=function(){if(VZ.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)bZ(n[r]);delete t.g[e],t.h--}}this.I=null},VZ.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},VZ.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var HZ=Tj.JSON.stringify;function GZ(){var e=KZ,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var qZ,$Z=new(function(){function e(t,n){np(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return ip(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}())(function(){return new WZ},function(e){return e.reset()}),WZ=function(){function e(){np(this,e),this.next=this.g=this.h=null}return ip(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function jZ(e){Tj.setTimeout(function(){throw e},0)}function ZZ(e,t){qZ||function(){var e=Tj.Promise.resolve(void 0);qZ=function(){e.then(JZ)}}(),YZ||(qZ(),YZ=!0),KZ.add(e,t)}var YZ=!1,KZ=new(function(){function e(){np(this,e),this.h=this.g=null}return ip(e,[{key:"add",value:function(e,t){var n=$Z.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}());function JZ(){for(var e;e=GZ();){try{e.h.call(e.g)}catch(n){jZ(n)}var t=$Z;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}YZ=!1}function QZ(e,t){VZ.call(this),this.h=e||1,this.g=t||Tj,this.j=Lj(this.kb,this),this.l=Date.now()}function XZ(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function eY(e,t,n){if("function"==typeof e)n&&(e=Lj(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Lj(e.handleEvent,e)}return 2147483647<Number(t)?-1:Tj.setTimeout(e,t||0)}function tY(e){e.g=eY(function(){e.g=null,e.i&&(e.i=!1,tY(e))},e.j);var t=e.h;e.h=null,e.m.apply(null,t)}Bj(QZ,VZ),(fj=QZ.prototype).da=!1,fj.S=null,fj.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),UZ(this,"tick"),this.da&&(XZ(this),this.start()))}},fj.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},fj.M=function(){QZ.Z.M.call(this),XZ(this),delete this.g};var nY=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this)).m=e,i.j=r,i.h=null,i.i=!1,i.g=null,i}return ip(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:tY(this)}},{key:"M",value:function(){Hv(Kv(n.prototype),"M",this).call(this),this.g&&(Tj.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(Vj);function rY(e){Vj.call(this),this.h=e,this.g={}}Bj(rY,Vj);var iY=[];function aY(e,t,n,r){Array.isArray(n)||(n&&(iY[0]=n.toString()),n=iY);for(var i=0;i<n.length;i++){var a=IZ(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function oY(e){Qj(e.g,function(e,t){this.g.hasOwnProperty(t)&&NZ(e)},e),e.g={}}function sY(){this.g=!0}function uY(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return HZ(n)}catch(s){return t}}(e,n)+(r?" "+r:"")})}rY.prototype.M=function(){rY.Z.M.call(this),oY(this)},rY.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},sY.prototype.Aa=function(){this.g=!1},sY.prototype.info=function(){};var cY={},lY=null;function hY(){return lY=lY||new VZ}function fY(e){yZ.call(this,cY.Ma,e)}function dY(e){var t=hY();UZ(t,new fY(t,e))}function vY(e,t){yZ.call(this,cY.STAT_EVENT,e),this.stat=t}function pY(e){var t=hY();UZ(t,new vY(t,e))}function gY(e,t){yZ.call(this,cY.Na,e),this.size=t}function yY(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return Tj.setTimeout(function(){e()},t)}cY.Ma="serverreachability",Bj(fY,yZ),cY.STAT_EVENT="statevent",Bj(vY,yZ),cY.Na="timingevent",Bj(gY,yZ);var mY={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},kY={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function _Y(){}function wY(){}_Y.prototype.h=null;var CY,bY={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function EY(){yZ.call(this,"d")}function SY(){yZ.call(this,"c")}function PY(){}function OY(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new rY(this),this.P=IY,this.W=new QZ(e=sZ?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new TY}function TY(){this.i=null,this.g="",this.h=!1}Bj(EY,yZ),Bj(SY,yZ),Bj(PY,_Y),PY.prototype.g=function(){return new XMLHttpRequest},PY.prototype.i=function(){return{}},CY=new PY;var IY=45e3,xY={},AY={};function RY(e,t,n){e.K=1,e.v=tK(YY(t)),e.s=n,e.U=!0,NY(e,null)}function NY(e,t){e.F=Date.now(),FY(e),e.A=YY(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),vK(n.h,"t",r),e.C=0,n=e.l.H,e.h=new TY,e.g=vJ(e.l,n?t:null,!e.s),0<e.O&&(e.L=new nY(Lj(e.Ia,e,e.g),e.O)),aY(e.V,e.g,"readystatechange",e.gb),t=e.H?Xj(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),dY(1),function(e,t,n,r,i,a){e.info(function(){if(e.g)if(a)for(var o="",s=a.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.j,e.u,e.A,e.m,e.X,e.s)}function MY(e){return!!e.g&&"GET"==e.u&&2!=e.K&&e.l.Ba}function DY(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=LY(e,n))==AY){4==t&&(e.o=4,pY(14),i=!1),uY(e.j,e.m,null,"[Incomplete Response]");break}if(r==xY){e.o=4,pY(15),uY(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}uY(e.j,e.m,r,null),HY(e,r)}MY(e)&&r!=AY&&r!=xY&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,pY(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),oJ(t),t.L=!0,pY(11))):(uY(e.j,e.m,n,"[Invalid Chunked Response]"),zY(e),UY(e))}function LY(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?AY:(n=Number(t.substring(n,r)),isNaN(n)?xY:(r+=1)+n>t.length?AY:(t=t.substr(r,n),e.C=r+n,t))}function FY(e){e.Y=Date.now()+e.P,BY(e,e.P)}function BY(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=yY(Lj(e.eb,e),t)}function VY(e){e.B&&(Tj.clearTimeout(e.B),e.B=null)}function UY(e){0==e.l.G||e.I||cJ(e.l,e)}function zY(e){VY(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,XZ(e.W),oY(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function HY(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||_K(n.i,e)))if(n.I=e.N,!e.J&&_K(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(g){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0])e:if(n.u)n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=yY(Lj(n.ab,n),6e3));else{if(n.g){if(!(n.g.F+3e3<e.F))break e;uJ(n),JK(n)}aJ(n),pY(18)}if(1>=kK(n.i)&&n.ka){try{n.ka()}catch(y){}n.ka=void 0}}else hJ(n,11)}else if((e.J||n.g==e)&&uJ(n),!$j(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.U=a[0],a=a[1],2==n.G)if("c"==a[0]){n.J=a[1],n.la=a[2];var o=a[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var s=a[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));var u=a[5];null!=u&&"number"==typeof u&&0<u&&(n.K=r=1.5*u,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;!h.g&&(Zj(l,"spdy")||Zj(l,"quic")||Zj(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(wK(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,eK(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=e;if((r=n).oa=dJ(r,r.H?r.la:null,r.W),d.J){CK(r.i,d);var v=d,p=r.K;p&&v.setTimeout(p),v.B&&(VY(v),FY(v)),r.g=d}else iJ(r);0<n.l.length&&eJ(n)}else"stop"!=a[0]&&"close"!=a[0]||hJ(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?hJ(n,7):KK(n):"noop"!=a[0]&&n.j&&n.j.wa(a),n.A=0)}dY(4)}catch(m){}}function GY(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(xj(e)||"string"==typeof e)Hj(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(xj(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;i=(r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(xj(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e)).length;for(var a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}}function qY(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof qY)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function $Y(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];WY(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)WY(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function WY(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(fj=OY.prototype).setTimeout=function(e){this.P=e},fj.gb=function(e){e=e.target;var t=this.L;t&&3==$K(e)?t.l():this.Ia(e)},fj.Ia=function(e){try{if(e==this.g)e:{var t=$K(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(3!=t||sZ||this.g&&(this.h.h||this.g.ga()||WK(this.g)))){this.I||4!=t||7==n||dY(8==n||0>=r?3:2),VY(this);var i=this.g.ba();this.N=i;t:if(MY(this)){var a=WK(this.g);e="";var o=a.length,s=4==$K(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){zY(this),UY(this);var u="";break t}this.h.i=new Tj.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(a[n],{stream:s&&n==o-1});a.splice(0,o),this.h.g+=e,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(e,t,n,r,i,a,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o})}(this.j,this.u,this.A,this.m,this.X,t,i),this.i){if(this.$&&!this.J){t:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$j(c)){var h=c;break t}}h=null}if(!(i=h)){this.i=!1,this.o=3,pY(12),zY(this),UY(this);break e}uY(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,HY(this,i)}this.U?(DY(this,t,u),sZ&&this.i&&3==t&&(aY(this.V,this.W,"tick",this.fb),this.W.start())):(uY(this.j,this.m,u,null),HY(this,u)),4==t&&zY(this),this.i&&!this.I&&(4==t?cJ(this.l,this):(this.i=!1,FY(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,pY(12)):(this.o=0,pY(13)),zY(this),UY(this)}}}catch(f){}},fj.fb=function(){if(this.g){var e=$K(this.g),t=this.g.ga();this.C<t.length&&(VY(this),DY(this,e,t),this.i&&4!=e&&FY(this))}},fj.cancel=function(){this.I=!0,zY(this)},fj.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(dY(3),pY(17)),zY(this),this.o=2,UY(this)):BY(this,this.Y-e)},(fj=qY.prototype).R=function(){$Y(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},fj.T=function(){return $Y(this),this.g.concat()},fj.get=function(e,t){return WY(this.h,e)?this.h[e]:t},fj.set=function(e,t){WY(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},fj.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],a=this.get(i);e.call(t,a,i,this)}};var jY=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ZY(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof ZY){this.g=void 0!==t?t:e.g,KY(this,e.j),this.s=e.s,JY(this,e.i),QY(this,e.m),this.l=e.l,t=e.h;var n=new lK;n.i=t.i,t.g&&(n.g=new qY(t.g),n.h=t.h),XY(this,n),this.o=e.o}else e&&(n=String(e).match(jY))?(this.g=!!t,KY(this,n[1]||"",!0),this.s=nK(n[2]||""),JY(this,n[3]||"",!0),QY(this,n[4]),this.l=nK(n[5]||"",!0),XY(this,n[6]||"",!0),this.o=nK(n[7]||"")):(this.g=!!t,this.h=new lK(null,this.g))}function YY(e){return new ZY(e)}function KY(e,t,n){e.j=n?nK(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function JY(e,t,n){e.i=n?nK(t,!0):t}function QY(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function XY(e,t,n){t instanceof lK?(e.h=t,function(e,t){t&&!e.j&&(hK(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(fK(this,t),vK(this,n,e))},e)),e.j=t}(e.h,e.g)):(n||(t=rK(t,uK)),e.h=new lK(t,e.g))}function eK(e,t,n){e.h.set(t,n)}function tK(e){return eK(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function nK(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function rK(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,iK),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function iK(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}ZY.prototype.toString=function(){var e=[],t=this.j;t&&e.push(rK(t,aK,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(rK(t,aK,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(rK(n,"/"==n.charAt(0)?sK:oK,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",rK(n,cK)),e.join("")};var aK=/[#\/\?@]/g,oK=/[#\?:]/g,sK=/[#\?]/g,uK=/[#\?@]/g,cK=/#/g;function lK(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function hK(e){e.g||(e.g=new qY,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function fK(e,t){hK(e),t=pK(e,t),WY(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,WY((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&$Y(e)))}function dK(e,t){return hK(e),t=pK(e,t),WY(e.g.h,t)}function vK(e,t,n){fK(e,t),0<n.length&&(e.i=null,e.g.set(pK(e,t),qj(n)),e.h+=n.length)}function pK(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function gK(e){this.l=e||yK,e=Tj.PerformanceNavigationTiming?0<(e=Tj.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(Tj.g&&Tj.g.Ea&&Tj.g.Ea()&&Tj.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(fj=lK.prototype).add=function(e,t){hK(this),this.i=null,e=pK(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},fj.forEach=function(e,t){hK(this),this.g.forEach(function(n,r){Hj(n,function(n){e.call(t,n,r,this)},this)},this)},fj.T=function(){hK(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},fj.R=function(e){hK(this);var t=[];if("string"==typeof e)dK(this,e)&&(t=Gj(t,this.g.get(pK(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=Gj(t,e[n])}return t},fj.set=function(e,t){return hK(this),this.i=null,dK(this,e=pK(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},fj.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},fj.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var a=0;a<r.length;a++){var o=i;""!==r[a]&&(o+="="+encodeURIComponent(String(r[a]))),e.push(o)}}return this.i=e.join("&")};var yK=10;function mK(e){return!!e.h||!!e.g&&e.g.size>=e.j}function kK(e){return e.h?1:e.g?e.g.size:0}function _K(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function wK(e,t){e.g?e.g.add(t):e.h=t}function CK(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function bK(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=Xv(e.g.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;n=n.concat(i.D)}}catch(a){r.e(a)}finally{r.f()}return n}return qj(e.i)}function EK(){}function SK(){this.g=new EK}function PK(e,t,n){var r=n||"";try{GY(e,function(e,n){var i=e;Aj(e)&&(i=HZ(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function OK(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(a){}}function TK(e){this.l=e.$b||null,this.j=e.ib||!1}function IK(e,t){VZ.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=xK,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}gK.prototype.cancel=function(){if(this.i=bK(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=Xv(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}},EK.prototype.stringify=function(e){return Tj.JSON.stringify(e,void 0)},EK.prototype.parse=function(e){return Tj.JSON.parse(e,void 0)},Bj(TK,_Y),TK.prototype.g=function(){return new IK(this.l,this.j)},TK.prototype.i=function(e){return function(){return e}}({}),Bj(IK,VZ);var xK=0;function AK(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function RK(e){e.readyState=4,e.l=null,e.j=null,e.A=null,NK(e)}function NK(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(fj=IK.prototype).open=function(e,t){if(this.readyState!=xK)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,NK(this)},fj.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||Tj).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},fj.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,RK(this)),this.readyState=xK},fj.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,NK(this)),this.g&&(this.readyState=3,NK(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Tj.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;AK(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},fj.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?RK(this):NK(this),3==this.readyState&&AK(this)}},fj.Ua=function(e){this.g&&(this.response=this.responseText=e,RK(this))},fj.Ta=function(e){this.g&&(this.response=e,RK(this))},fj.ha=function(){this.g&&RK(this)},fj.setRequestHeader=function(e,t){this.v.append(e,t)},fj.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},fj.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(IK.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var MK=Tj.JSON.parse;function DK(e){VZ.call(this),this.headers=new qY,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=LK,this.K=this.L=!1}Bj(DK,VZ);var LK="",FK=/^https?$/i,BK=["POST","PUT"];function VK(e){return"content-type"==e.toLowerCase()}function UK(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,zK(e),GK(e)}function zK(e){e.D||(e.D=!0,UZ(e,"complete"),UZ(e,"error"))}function HK(e){if(e.h&&void 0!==Oj&&(!e.C[1]||4!=$K(e)||2!=e.ba()))if(e.v&&4==$K(e))eY(e.Fa,0,e);else if(UZ(e,"readystatechange"),4==$K(e)){e.h=!1;try{var t,n=e.ba();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.H).match(jY)[1]||null;if(!a&&Tj.self&&Tj.self.location){var o=Tj.self.location.protocol;a=o.substr(0,o.length-1)}i=!FK.test(a?a.toLowerCase():"")}t=i}if(t)UZ(e,"complete"),UZ(e,"success");else{e.m=6;try{var s=2<$K(e)?e.g.statusText:""}catch(u){s=""}e.j=s+" ["+e.ba()+"]",zK(e)}}finally{GK(e)}}}function GK(e,t){if(e.g){qK(e);var n=e.g,r=e.C[0]?Ij:null;e.g=null,e.C=null,t||UZ(e,"ready");try{n.onreadystatechange=r}catch(i){}}}function qK(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(Tj.clearTimeout(e.A),e.A=null)}function $K(e){return e.g?e.g.readyState:0}function WK(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case LK:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function jK(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return Qj(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):eK(e,t,n))}function ZK(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function YK(e){this.za=0,this.l=[],this.h=new sY,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=ZK("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=ZK("baseRetryDelayMs",5e3,e),this.$a=ZK("retryDelaySeedMs",1e4,e),this.Ya=ZK("forwardChannelMaxRetries",2,e),this.ra=ZK("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new gK(e&&e.concurrentRequestLimit),this.Ca=new SK,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function KK(e){if(QK(e),3==e.G){var t=e.V++,n=YY(e.F);eK(n,"SID",e.J),eK(n,"RID",t),eK(n,"TYPE","terminate"),nJ(e,n),(t=new OY(e,e.h,t,void 0)).K=2,t.v=tK(YY(n)),n=!1,Tj.navigator&&Tj.navigator.sendBeacon&&(n=Tj.navigator.sendBeacon(t.v.toString(),"")),!n&&Tj.Image&&((new Image).src=t.v,n=!0),n||(t.g=vJ(t.l,null),t.g.ea(t.v)),t.F=Date.now(),FY(t)}fJ(e)}function JK(e){e.g&&(oJ(e),e.g.cancel(),e.g=null)}function QK(e){JK(e),e.u&&(Tj.clearTimeout(e.u),e.u=null),uJ(e),e.i.cancel(),e.m&&("number"==typeof e.m&&Tj.clearTimeout(e.m),e.m=null)}function XK(e,t){e.l.push(new(function(){return ip(function e(t,n){np(this,e),this.h=t,this.g=n})}())(e.Za++,t)),3==e.G&&eJ(e)}function eJ(e){mK(e.i)||e.m||(e.m=!0,ZZ(e.Ha,e),e.C=0)}function tJ(e,t){var n;n=t?t.m:e.V++;var r=YY(e.F);eK(r,"SID",e.J),eK(r,"RID",n),eK(r,"AID",e.U),nJ(e,r),e.o&&e.s&&jK(r,e.o,e.s),n=new OY(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=rJ(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),wK(e.i,n),RY(n,r,t)}function nJ(e,t){e.j&&GY({},function(e,n){eK(t,n,e)})}function rJ(e,t,n){n=Math.min(e.l.length,n);var r=e.j?Lj(e.j.Oa,e.j,e):null;e:for(var i=e.l,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].h,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var s=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=a))a=Math.max(0,i[u].h-100),s=!1;else try{PK(l,o,"req"+c+"_")}catch(h){r&&r(l)}}if(s){r=o.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function iJ(e){e.g||e.u||(e.Y=1,ZZ(e.Ga,e),e.A=0)}function aJ(e){return!(e.g||e.u||3<=e.A||(e.Y++,e.u=yY(Lj(e.Ga,e),lJ(e,e.A)),e.A++,0))}function oJ(e){null!=e.B&&(Tj.clearTimeout(e.B),e.B=null)}function sJ(e){e.g=new OY(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=YY(e.oa);eK(t,"RID","rpc"),eK(t,"SID",e.J),eK(t,"CI",e.N?"0":"1"),eK(t,"AID",e.U),nJ(e,t),eK(t,"TYPE","xmlhttp"),e.o&&e.s&&jK(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=tK(YY(t)),n.s=null,n.U=!0,NY(n,e)}function uJ(e){null!=e.v&&(Tj.clearTimeout(e.v),e.v=null)}function cJ(e,t){var n=null;if(e.g==t){uJ(e),oJ(e),e.g=null;var r=2}else{if(!_K(e.i,t))return;n=t.D,CK(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;UZ(r=hY(),new gY(r,n,t,i)),eJ(e)}else iJ(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(kK(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=yY(Lj(e.Ha,e,t),lJ(e,e.C)),e.C++,0)))}(e,t)||2==r&&aJ(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:hJ(e,5);break;case 4:hJ(e,10);break;case 3:hJ(e,6);break;default:hJ(e,2)}}function lJ(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function hJ(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=Lj(e.jb,e);n||(n=new ZY("//www.google.com/images/cleardot.gif"),Tj.location&&"http"==Tj.location.protocol||KY(n,"https"),tK(n)),function(e,t){var n=new sY;if(Tj.Image){var r=new Image;r.onload=Fj(OK,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Fj(OK,n,r,"TestLoadImage: error",!1,t),r.onabort=Fj(OK,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Fj(OK,n,r,"TestLoadImage: timeout",!1,t),Tj.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else pY(2);e.G=0,e.j&&e.j.va(t),fJ(e),QK(e)}function fJ(e){e.G=0,e.I=-1,e.j&&((0!=bK(e.i).length||0!=e.l.length)&&(e.i.i.length=0,qj(e.l),e.l.length=0),e.j.ua())}function dJ(e,t,n){var r=function(e){return e instanceof ZY?YY(e):new ZY(e,void 0)}(n);if(""!=r.i)t&&JY(r,t+"."+r.i),QY(r,r.m);else{var i=Tj.location;r=function(e,t,n,r){var i=new ZY(null,void 0);return e&&KY(i,e),t&&JY(i,t),n&&QY(i,n),r&&(i.l=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.aa&&Qj(e.aa,function(e,t){eK(r,t,e)}),n=e.sa,(t=e.D)&&n&&eK(r,t,n),eK(r,"VER",e.ma),nJ(e,r),r}function vJ(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new DK(n&&e.Ba&&!e.qa?new TK({ib:!0}):e.qa)).L=e.H,t}function pJ(){}function gJ(){if(aZ&&!(10<=Number(pZ)))throw Error("Environmental error: no available transport.")}function yJ(e,t){VZ.call(this),this.g=new YK(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!$j(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!$j(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new _J(this)}function mJ(e){EY.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function kJ(){SY.call(this),this.status=1}function _J(e){this.g=e}(fj=DK.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():CY.g(),this.C=function(e){return e.h||(e.h=e.i())}(this.u?this.u:CY),this.g.onreadystatechange=Lj(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(a){return void UK(this,a)}e=n||"";var i=new qY(this.headers);r&&GY(r,function(e,t){i.set(t,e)}),r=function(e){e:{for(var t=VK,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=Tj.FormData&&e instanceof Tj.FormData,!(0<=zj(BK,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(e,t){this.g.setRequestHeader(t,e)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{qK(this),0<this.B&&((this.K=function(e){return aZ&&function(){return e=vZ,Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){for(var e=0,t=jj(String(rZ)).split("."),n=jj("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var a=t[i]||"",o=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;e=Yj(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||Yj(0==a[2].length,0==o[2].length)||Yj(a[2],o[2]),a=a[3],o=o[3]}while(0==e)}return 0<=e}();var e}()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Lj(this.pa,this)):this.A=eY(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(a){UK(this,a)}},fj.pa=function(){void 0!==Oj&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,UZ(this,"timeout"),this.abort(8))},fj.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,UZ(this,"complete"),UZ(this,"abort"),GK(this))},fj.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),GK(this,!0)),DK.Z.M.call(this)},fj.Fa=function(){this.s||(this.F||this.v||this.l?HK(this):this.cb())},fj.cb=function(){HK(this)},fj.ba=function(){try{return 2<$K(this)?this.g.status:-1}catch(e){return-1}},fj.ga=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},fj.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),MK(t)}},fj.Da=function(){return this.m},fj.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(fj=YK.prototype).ma=8,fj.G=1,fj.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(t){}},fj.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new OY(this,this.h,e,void 0),n=this.s;if(this.P&&(n?tZ(n=Xj(n),this.P):n=this.P),null===this.o&&(t.H=n),this.ja)e:{for(var r=0,i=0;i<this.l.length;i++){var a=this.l[i];if(void 0===(a="__data__"in a.g&&"string"==typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.l.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=rJ(this,t,r),eK(i=YY(this.F),"RID",e),eK(i,"CVER",22),this.D&&eK(i,"X-HTTP-Session-Id",this.D),nJ(this,i),this.o&&n&&jK(i,this.o,n),wK(this.i,t),this.Ra&&eK(i,"TYPE","init"),this.ja?(eK(i,"$req",r),eK(i,"SID","null"),t.$=!0,RY(t,i,null)):RY(t,i,r),this.G=2}}else 3==this.G&&(e?tJ(this,e):0==this.l.length||mK(this.i)||tJ(this))},fj.Ga=function(){if(this.u=null,sJ(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=yY(Lj(this.bb,this),e)}},fj.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,pY(10),JK(this),sJ(this))},fj.ab=function(){null!=this.v&&(this.v=null,JK(this),aJ(this),pY(19))},fj.jb=function(e){e?(this.h.info("Successfully pinged google.com"),pY(2)):(this.h.info("Failed to ping google.com"),pY(1))},(fj=pJ.prototype).xa=function(){},fj.wa=function(){},fj.va=function(){},fj.ua=function(){},fj.Oa=function(){},gJ.prototype.g=function(e,t){return new yJ(e,t)},Bj(yJ,VZ),yJ.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),ZZ(Lj(e.hb,e,t))),pY(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=dJ(e,null,e.W),eJ(e)},yJ.prototype.close=function(){KK(this.g)},yJ.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,XK(this.g,t)}else this.v?((t={}).__data__=HZ(e),XK(this.g,t)):XK(this.g,e)},yJ.prototype.M=function(){this.g.j=null,delete this.j,KK(this.g),delete this.g,yJ.Z.M.call(this)},Bj(mJ,EY),Bj(kJ,SY),Bj(_J,pJ),_J.prototype.xa=function(){UZ(this.g,"a")},_J.prototype.wa=function(e){UZ(this.g,new mJ(e))},_J.prototype.va=function(e){UZ(this.g,new kJ(e))},_J.prototype.ua=function(){UZ(this.g,"b")},gJ.prototype.createWebChannel=gJ.prototype.g,yJ.prototype.send=yJ.prototype.u,yJ.prototype.open=yJ.prototype.m,yJ.prototype.close=yJ.prototype.close,mY.NO_ERROR=0,mY.TIMEOUT=8,mY.HTTP_ERROR=6,kY.COMPLETE="complete",wY.EventType=bY,bY.OPEN="a",bY.CLOSE="b",bY.ERROR="c",bY.MESSAGE="d",VZ.prototype.listen=VZ.prototype.N,DK.prototype.listenOnce=DK.prototype.O,DK.prototype.getLastError=DK.prototype.La,DK.prototype.getLastErrorCode=DK.prototype.Da,DK.prototype.getStatus=DK.prototype.ba,DK.prototype.getResponseJson=DK.prototype.Qa,DK.prototype.getResponseText=DK.prototype.ga,DK.prototype.send=DK.prototype.ea;var wJ=Pj.createWebChannelTransport=function(){return new gJ},CJ=Pj.getStatEventTarget=function(){return hY()},bJ=Pj.ErrorCode=mY,EJ=Pj.EventType=kY,SJ=Pj.Event=cY,PJ=Pj.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},OJ=Pj.FetchXmlHttpFactory=TK,TJ=Pj.WebChannel=wY,IJ=Pj.XhrIo=DK,xJ="@firebase/firestore",AJ=function(){function e(t){np(this,e),this.uid=t}return ip(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();AJ.UNAUTHENTICATED=new AJ(null),AJ.GOOGLE_CREDENTIALS=new AJ("google-credentials-uid"),AJ.FIRST_PARTY=new AJ("first-party-uid"),AJ.MOCK_USER=new AJ("mock-user");var RJ="9.6.5",NJ=new uV("@firebase/firestore");function MJ(){return NJ.logLevel}function DJ(e){if(NJ.logLevel<=rV.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(BJ);NJ.debug.apply(NJ,["Firestore (".concat(RJ,"): ").concat(e)].concat(Jv(i)))}}function LJ(e){if(NJ.logLevel<=rV.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(BJ);NJ.error.apply(NJ,["Firestore (".concat(RJ,"): ").concat(e)].concat(Jv(i)))}}function FJ(e){if(NJ.logLevel<=rV.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(BJ);NJ.warn.apply(NJ,["Firestore (".concat(RJ,"): ").concat(e)].concat(Jv(i)))}}function BJ(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function VJ(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(RJ,") INTERNAL ASSERTION FAILED: ")+e;throw LJ(t),new Error(t)}function UJ(e,t){e||VJ()}function zJ(e,t){return e}var HJ={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},GJ=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this,e,r)).code=e,i.message=r,i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return ip(n)}(xB),qJ=ip(function e(){var t=this;np(this,e),this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}),$J=ip(function e(t,n){np(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))}),WJ=function(){function e(){np(this,e)}return ip(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(AJ.UNAUTHENTICATED)})}},{key:"shutdown",value:function(){}}]),e}(),jJ=function(){function e(t){np(this,e),this.token=t,this.changeListener=null}return ip(e,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable(function(){return t(n.token.user)})}},{key:"shutdown",value:function(){this.changeListener=null}}]),e}(),ZJ=function(){function e(t){np(this,e),this.t=t,this.currentUser=AJ.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return ip(e,[{key:"start",value:function(e,t){var n=this,r=this,i=this.i,a=function(e){return n.i!==i?(i=n.i,t(e)):Promise.resolve()},o=new qJ;this.o=function(){n.i++,n.currentUser=n.u(),o.resolve(),o=new qJ,e.enqueueRetryable(function(){return a(n.currentUser)})};var s=function(){var t=o;e.enqueueRetryable(rB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,a(r.currentUser);case 4:case"end":return e.stop()}},e)})))},u=function(e){DJ("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),s()};this.t.onInit(function(e){return u(e)}),setTimeout(function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?u(e):(DJ("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new qJ)}},0),s()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return e.i!==t?(DJ("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(UJ("string"==typeof n.accessToken),new $J(n.accessToken,e.currentUser)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return UJ(null===e||"string"==typeof e),new AJ(e)}}]),e}(),YJ=ip(function e(t,n,r){np(this,e),this.type="FirstParty",this.user=AJ.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);var i=t.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}),KJ=function(){function e(t,n,r){np(this,e),this.h=t,this.l=n,this.m=r}return ip(e,[{key:"getToken",value:function(){return Promise.resolve(new YJ(this.h,this.l,this.m))}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(AJ.FIRST_PARTY)})}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),JJ=ip(function e(t){np(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}),QJ=function(){function e(t){np(this,e),this.g=t,this.forceRefresh=!1,this.appCheck=null}return ip(e,[{key:"start",value:function(e,t){var n=this;this.o=function(n){e.enqueueRetryable(function(){return null!=(e=n).error&&DJ("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message)),t(e.token);var e})};var r=function(e){DJ("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.g.onInit(function(e){return r(e)}),setTimeout(function(){if(!n.appCheck){var e=n.g.getImmediate({optional:!0});e?r(e):DJ("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}},{key:"getToken",value:function(){var e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(function(e){return e?(UJ("string"==typeof e.token),new JJ(e.token)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}(),XJ=function(){function e(t,n){var r=this;np(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.p(e)},this.T=function(e){return n.writeSequenceNumber(e)})}return ip(e,[{key:"p",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.T&&this.T(e),e}}]),e}();function eQ(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}XJ.I=-1;var tQ=function(){function e(){np(this,e)}return ip(e,null,[{key:"A",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=eQ(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),e}();function nQ(e,t){return e<t?-1:e>t?1:0}function rQ(e,t,n){return e.length===t.length&&e.every(function(e,r){return n(e,t[r])})}var iQ=function(){function e(t,n){if(np(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new GJ(HJ.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new GJ(HJ.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new GJ(HJ.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new GJ(HJ.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return ip(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?nQ(this.nanoseconds,e.nanoseconds):nQ(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),aQ=function(){function e(t){np(this,e),this.timestamp=t}return ip(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new iQ(0,0))}}]),e}();function oQ(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function sQ(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function uQ(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var cQ=function(){function e(t,n,r){np(this,e),void 0===n?n=0:n>t.length&&VJ(),void 0===r?r=t.length-n:r>t.length-n&&VJ(),this.segments=t,this.offset=n,this.len=r}return ip(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(e){n.push(e)}):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),lQ=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var a=0,o=r;a<o.length;a++){var s=o[a];if(s.indexOf("//")>=0)throw new GJ(HJ.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));e.push.apply(e,Jv(s.split("/").filter(function(e){return e.length>0})))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(cQ),hQ=/^[_a-zA-Z][_a-zA-Z0-9]*$/,fQ=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map(function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return hQ.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",i=0,a=function(){if(0===r.length)throw new GJ(HJ.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new GJ(HJ.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new GJ(HJ.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===s?(o=!o,i++):"."!==s||o?(r+=s,i++):(a(),i++)}if(a(),o)throw new GJ(HJ.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(cQ),dQ=function(){function e(t){np(this,e),this.fields=t,t.sort(fQ.comparator)}return ip(e,[{key:"covers",value:function(e){var t,n=Xv(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return rQ(this.fields,e.fields,function(e,t){return e.isEqual(t)})}}]),e}(),vQ=function(e){function t(e){np(this,t),this.binaryString=e}return ip(t,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return btoa(this.binaryString)}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return nQ(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){return new t(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e))}}]),t}();vQ.EMPTY_BYTE_STRING=new vQ("");var pQ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function gQ(e){if(UJ(!!e),"string"==typeof e){var t=0,n=pQ.exec(e);if(UJ(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:yQ(e.seconds),nanos:yQ(e.nanos)}}function yQ(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function mQ(e){return"string"==typeof e?vQ.fromBase64String(e):vQ.fromUint8Array(e)}function kQ(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function _Q(e){var t=e.mapValue.fields.__previous_value__;return kQ(t)?_Q(t):t}function wQ(e){var t=gQ(e.mapValue.fields.__local_write_time__.timestampValue);return new iQ(t.seconds,t.nanos)}function CQ(e){return null==e}function bQ(e){return 0===e&&1/e==-1/0}var EQ=function(){function e(t){np(this,e),this.path=t}return ip(e,[{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"isEqual",value:function(e){return null!==e&&0===lQ.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(lQ.fromString(t))}},{key:"fromName",value:function(t){return new e(lQ.fromString(t).popFirst(5))}},{key:"comparator",value:function(e,t){return lQ.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new lQ(t.slice()))}}]),e}();function SQ(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?kQ(e)?4:10:VJ()}function PQ(e,t){if(e===t)return!0;var n,r=SQ(e);if(r!==SQ(t))return!1;switch(r){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return wQ(e).isEqual(wQ(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=gQ(e.timestampValue),r=gQ(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return n=t,mQ(e.bytesValue).isEqual(mQ(n.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return yQ(e.geoPointValue.latitude)===yQ(t.geoPointValue.latitude)&&yQ(e.geoPointValue.longitude)===yQ(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return yQ(e.integerValue)===yQ(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=yQ(e.doubleValue),r=yQ(t.doubleValue);return n===r?bQ(n)===bQ(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return rQ(e.arrayValue.values||[],t.arrayValue.values||[],PQ);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(oQ(n)!==oQ(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!PQ(n[i],r[i])))return!1;return!0}(e,t);default:return VJ()}}function OQ(e,t){return void 0!==(e.values||[]).find(function(e){return PQ(e,t)})}function TQ(e,t){if(e===t)return 0;var n,r,i,a,o=SQ(e),s=SQ(t);if(o!==s)return nQ(o,s);switch(o){case 0:return 0;case 1:return nQ(e.booleanValue,t.booleanValue);case 2:return r=t,i=yQ((n=e).integerValue||n.doubleValue),a=yQ(r.integerValue||r.doubleValue),i<a?-1:i>a?1:i===a?0:isNaN(i)?isNaN(a)?0:-1:1;case 3:return IQ(e.timestampValue,t.timestampValue);case 4:return IQ(wQ(e),wQ(t));case 5:return nQ(e.stringValue,t.stringValue);case 6:return function(e,t){var n=mQ(e),r=mQ(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=nQ(n[i],r[i]);if(0!==a)return a}return nQ(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=nQ(yQ(e.latitude),yQ(t.latitude));return 0!==n?n:nQ(yQ(e.longitude),yQ(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=TQ(n[i],r[i]);if(a)return a}return nQ(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var s=nQ(r[o],a[o]);if(0!==s)return s;var u=TQ(n[r[o]],i[a[o]]);if(0!==u)return u}return nQ(r.length,a.length)}(e.mapValue,t.mapValue);default:throw VJ()}}function IQ(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return nQ(e,t);var n=gQ(e),r=gQ(t),i=nQ(n.seconds,r.seconds);return 0!==i?i:nQ(n.nanos,r.nanos)}function xQ(e){return AQ(e)}function AQ(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(t=e.timestampValue,n=gQ(t),"time(".concat(n.seconds,",").concat(n.nanos,")")):"stringValue"in e?e.stringValue:"bytesValue"in e?mQ(e.bytesValue).toBase64():"referenceValue"in e?EQ.fromName(e.referenceValue).toString():"geoPointValue"in e?"geo(".concat((r=e.geoPointValue).latitude,",").concat(r.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,i=Xv(e.values||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+=AQ(a)}}catch(o){i.e(o)}finally{i.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,i=Xv(Object.keys(e.fields||{}).sort());try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+="".concat(a,":").concat(AQ(e.fields[a]))}}catch(o){i.e(o)}finally{i.f()}return n+"}"}(e.mapValue):VJ();var t,n,r}function RQ(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function NQ(e){return!!e&&"integerValue"in e}function MQ(e){return!!e&&"arrayValue"in e}function DQ(e){return!!e&&"nullValue"in e}function LQ(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function FQ(e){return!!e&&"mapValue"in e}function BQ(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return sQ(e.mapValue.fields,function(e,n){return t.mapValue.fields[e]=BQ(n)}),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=BQ(e.arrayValue.values[r]);return n}return Object.assign({},e)}var VQ=function(){function e(t){np(this,e),this.value=t}return ip(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!FQ(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=BQ(t)}},{key:"setAll",value:function(e){var t=this,n=fQ.emptyPath(),r={},i=[];e.forEach(function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=BQ(e):i.push(a.lastSegment())});var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());FQ(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return PQ(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];FQ(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){sQ(t,function(t,n){return e[t]=n});var r,i=Xv(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete e[a]}}catch(o){i.e(o)}finally{i.f()}}},{key:"clone",value:function(){return new e(BQ(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function UQ(e){var t=[];return sQ(e.fields,function(e,n){var r=new fQ([e]);if(FQ(n)){var i=UQ(n.mapValue).fields;if(0===i.length)t.push(r);else{var a,o=Xv(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;t.push(r.child(s))}}catch(u){o.e(u)}finally{o.f()}}}else t.push(r)}),new dQ(t)}var zQ=function(){function e(t,n,r,i,a){np(this,e),this.key=t,this.documentType=n,this.version=r,this.data=i,this.documentState=a}return ip(e,[{key:"convertToFoundDocument",value:function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=VQ.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=VQ.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,aQ.min(),VQ.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r){return new e(t,1,n,r,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,VQ.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,VQ.empty(),2)}}]),e}(),HQ=ip(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;np(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=s,this.R=null});function GQ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new HQ(e,t,n,r,i,a,o)}function qQ(e){var t=zJ(e);if(null===t.R){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(function(e){return function(e){return e.field.canonicalString()+e.op.toString()+xQ(e.value)}(e)}).join(","),n+="|ob:",n+=t.orderBy.map(function(e){return(t=e).field.canonicalString()+t.dir;var t}).join(","),CQ(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=rX(t.startAt)),t.endAt&&(n+="|ub:",n+=rX(t.endAt)),t.R=n}return t.R}function $Q(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!aX(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if((i=e.filters[r]).op!==(a=t.filters[r]).op||!i.field.isEqual(a.field)||!PQ(i.value,a.value))return!1;var i,a;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!sX(e.startAt,t.startAt)&&sX(e.endAt,t.endAt)}function WQ(e){return EQ.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var jQ=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this)).field=e,a.op=r,a.value=i,a}return ip(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.v(TQ(t,this.value)):null!==t&&SQ(this.value)===SQ(t)&&this.v(TQ(t,this.value))}},{key:"v",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return VJ()}}},{key:"V",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.P(e,t,r):new ZQ(e,t,r):"array-contains"===t?new QQ(e,r):"in"===t?new XQ(e,r):"not-in"===t?new eX(e,r):"array-contains-any"===t?new tX(e,r):new n(e,t,r)}},{key:"P",value:function(e,t,n){return"in"===t?new YQ(e,n):new KQ(e,n)}}]),n}(function(){return ip(function e(){np(this,e)})}()),ZQ=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,e,r,i)).key=EQ.fromName(i.referenceValue),a}return ip(n,[{key:"matches",value:function(e){var t=EQ.comparator(e.key,this.key);return this.v(t)}}]),n}(jQ),YQ=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this,e,"in",r)).keys=JQ(0,r),i}return ip(n,[{key:"matches",value:function(e){return this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(jQ),KQ=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this,e,"not-in",r)).keys=JQ(0,r),i}return ip(n,[{key:"matches",value:function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(jQ);function JQ(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(e){return EQ.fromName(e.referenceValue)})}var QQ=function(e){qv(n,e);var t=Wv(n);function n(e,r){return np(this,n),t.call(this,e,"array-contains",r)}return ip(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return MQ(t)&&OQ(t.arrayValue,this.value)}}]),n}(jQ),XQ=function(e){qv(n,e);var t=Wv(n);function n(e,r){return np(this,n),t.call(this,e,"in",r)}return ip(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&OQ(this.value.arrayValue,t)}}]),n}(jQ),eX=function(e){qv(n,e);var t=Wv(n);function n(e,r){return np(this,n),t.call(this,e,"not-in",r)}return ip(n,[{key:"matches",value:function(e){if(OQ(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!OQ(this.value.arrayValue,t)}}]),n}(jQ),tX=function(e){qv(n,e);var t=Wv(n);function n(e,r){return np(this,n),t.call(this,e,"array-contains-any",r)}return ip(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!MQ(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(e){return OQ(t.value.arrayValue,e)})}}]),n}(jQ),nX=ip(function e(t,n){np(this,e),this.position=t,this.before=n});function rX(e){return"".concat(e.before?"b":"a",":").concat(e.position.map(function(e){return xQ(e)}).join(","))}var iX=ip(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";np(this,e),this.field=t,this.dir=n});function aX(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function oX(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?EQ.comparator(EQ.fromName(o.referenceValue),n.key):TQ(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return e.before?r<=0:r<0}function sX(e,t){if(null===e)return null===t;if(null===t||e.before!==t.before||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!PQ(e.position[n],t.position[n]))return!1;return!0}var uX=ip(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;np(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=s,this.endAt=u,this.S=null,this.D=null});function cX(e){return new uX(e)}function lX(e){return!CQ(e.limit)&&"F"===e.limitType}function hX(e){return!CQ(e.limit)&&"L"===e.limitType}function fX(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function dX(e){var t,n=Xv(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.V())return r.field}}catch(i){n.e(i)}finally{n.f()}return null}function vX(e){return null!==e.collectionGroup}function pX(e){var t=zJ(e);if(null===t.S){t.S=[];var n=dX(t),r=fX(t);if(null!==n&&null===r)n.isKeyField()||t.S.push(new iX(n)),t.S.push(new iX(fQ.keyField(),"asc"));else{var i,a=!1,o=Xv(t.explicitOrderBy);try{for(o.s();!(i=o.n()).done;){var s=i.value;t.S.push(s),s.field.isKeyField()&&(a=!0)}}catch(c){o.e(c)}finally{o.f()}if(!a){var u=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.S.push(new iX(fQ.keyField(),u))}}}return t.S}function gX(e){var t=zJ(e);if(!t.D)if("F"===t.limitType)t.D=GQ(t.path,t.collectionGroup,pX(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],i=Xv(pX(t));try{for(i.s();!(n=i.n()).done;){var a=n.value;r.push(new iX(a.field,"desc"===a.dir?"asc":"desc"))}}catch(u){i.e(u)}finally{i.f()}var o=t.endAt?new nX(t.endAt.position,!t.endAt.before):null,s=t.startAt?new nX(t.startAt.position,!t.startAt.before):null;t.D=GQ(t.path,t.collectionGroup,r,t.filters,t.limit,o,s)}return t.D}function yX(e,t){return $Q(gX(e),gX(t))&&e.limitType===t.limitType}function mX(e){return"".concat(qQ(gX(e)),"|lt:").concat(e.limitType)}function kX(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(function(e){return"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(xQ(t.value));var t}).join(", "),"]")),CQ(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(function(e){return"".concat((t=e).field.canonicalString()," (").concat(t.dir,")");var t}).join(", "),"]")),e.startAt&&(t+=", startAt: "+rX(e.startAt)),e.endAt&&(t+=", endAt: "+rX(e.endAt)),"Target(".concat(t,")")}(gX(e)),"; limitType=").concat(e.limitType,")")}function _X(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):EQ.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=Xv(e.explicitOrderBy);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=Xv(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&(r=t,!((n=e).startAt&&!oX(n.startAt,pX(n),r)||n.endAt&&oX(n.endAt,pX(n),r)));var n,r}function wX(e){return function(t,n){var r,i=!1,a=Xv(pX(e));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=CX(o,t,n);if(0!==s)return s;i=i||o.field.isKeyField()}}catch(u){a.e(u)}finally{a.f()}return 0}}function CX(e,t,n){var r,i,a,o,s=e.field.isKeyField()?EQ.comparator(t.key,n.key):(r=e.field,i=n,a=t.data.field(r),o=i.data.field(r),null!==a&&null!==o?TQ(a,o):VJ());switch(e.dir){case"asc":return s;case"desc":return-1*s;default:return VJ()}}function bX(e,t){if(e.C){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bQ(t)?"-0":t}}function EX(e){return{integerValue:""+e}}var SX=ip(function e(){np(this,e),this._=void 0});function PX(e,t,n){return e instanceof IX?(i=t,a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&(a.fields.__previous_value__=i),{mapValue:a}):e instanceof xX?AX(e,t):e instanceof RX?NX(e,t):function(e,t){var n=TX(e,t),r=DX(n)+DX(e.N);return NQ(n)&&NQ(e.N)?EX(r):bX(e.k,r)}(e,t);var r,i,a}function OX(e,t,n){return e instanceof xX?AX(e,t):e instanceof RX?NX(e,t):n}function TX(e,t){return e instanceof MX?NQ(r=t)||(n=r)&&"doubleValue"in n?t:{integerValue:0}:null;var n,r}var IX=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n)}(SX),xX=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this)).elements=e,r}return ip(n)}(SX);function AX(e,t){var n,r=LX(t),i=Xv(e.elements);try{var a=function(){var e=n.value;r.some(function(t){return PQ(t,e)})||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var RX=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this)).elements=e,r}return ip(n)}(SX);function NX(e,t){var n,r=LX(t),i=Xv(e.elements);try{var a=function(){var e=n.value;r=r.filter(function(t){return!PQ(t,e)})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var MX=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this)).k=e,i.N=r,i}return ip(n)}(SX);function DX(e){return yQ(e.integerValue||e.doubleValue)}function LX(e){return MQ(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var FX=ip(function e(t,n){np(this,e),this.field=t,this.transform=n}),BX=ip(function e(t,n){np(this,e),this.version=t,this.transformResults=n}),VX=function(){function e(t,n){np(this,e),this.updateTime=t,this.exists=n}return ip(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function UX(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var zX=ip(function e(){np(this,e)});function HX(e,t,n){var r,i,a,o,s;e instanceof jX?(i=t,a=n,o=(r=e).value.clone(),s=KX(r.fieldTransforms,i,a.transformResults),o.setAll(s),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()):e instanceof ZX?function(e,t,n){if(UX(e.precondition,t)){var r=KX(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(YX(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):t.convertToNoDocument(n.version).setHasCommittedMutations()}function GX(e,t,n){var r;e instanceof jX?function(e,t,n){if(UX(e.precondition,t)){var r=e.value.clone(),i=JX(e.fieldTransforms,n,t);r.setAll(i),t.convertToFoundDocument(WX(t),r).setHasLocalMutations()}}(e,t,n):e instanceof ZX?function(e,t,n){if(UX(e.precondition,t)){var r=JX(e.fieldTransforms,n,t),i=t.data;i.setAll(YX(e)),i.setAll(r),t.convertToFoundDocument(WX(t),i).setHasLocalMutations()}}(e,t,n):UX(e.precondition,r=t)&&r.convertToNoDocument(aQ.min())}function qX(e,t){var n,r=null,i=Xv(e.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.field),s=TX(a.transform,o||null);null!=s&&(null==r&&(r=VQ.empty()),r.set(a.field,s))}}catch(u){i.e(u)}finally{i.f()}return r||null}function $X(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(n=e.fieldTransforms)&&void 0===r||n&&r&&rQ(n,r,function(e,t){return function(e,t){return e.field.isEqual(t.field)&&(r=t.transform,(n=e.transform)instanceof xX&&r instanceof xX||n instanceof RX&&r instanceof RX?rQ(n.elements,r.elements,PQ):n instanceof MX&&r instanceof MX?PQ(n.N,r.N):n instanceof IX&&r instanceof IX);var n,r}(e,t)})))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var n,r}function WX(e){return e.isFoundDocument()?e.version:aQ.min()}var jX=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return np(this,n),(a=t.call(this)).key=e,a.value=r,a.precondition=i,a.fieldTransforms=o,a.type=0,a}return ip(n)}(zX),ZX=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return np(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=i,o.precondition=a,o.fieldTransforms=s,o.type=1,o}return ip(n)}(zX);function YX(e){var t=new Map;return e.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}}),t}function KX(e,t,n){var r=new Map;UJ(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,s=t.data.field(a.field);r.set(a.field,OX(o,s,n[i]))}return r}function JX(e,t,n){var r,i=new Map,a=Xv(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.transform,u=n.data.field(o.field);i.set(o.field,PX(s,u,t))}}catch(c){a.e(c)}finally{a.f()}return i}var QX,XX,e1=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return ip(n)}(zX),t1=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return ip(n)}(zX),n1=ip(function e(t){np(this,e),this.count=t});function r1(e){switch(e){default:return VJ();case HJ.CANCELLED:case HJ.UNKNOWN:case HJ.DEADLINE_EXCEEDED:case HJ.RESOURCE_EXHAUSTED:case HJ.INTERNAL:case HJ.UNAVAILABLE:case HJ.UNAUTHENTICATED:return!1;case HJ.INVALID_ARGUMENT:case HJ.NOT_FOUND:case HJ.ALREADY_EXISTS:case HJ.PERMISSION_DENIED:case HJ.FAILED_PRECONDITION:case HJ.ABORTED:case HJ.OUT_OF_RANGE:case HJ.UNIMPLEMENTED:case HJ.DATA_LOSS:return!0}}function i1(e){if(void 0===e)return LJ("GRPC error has no .code"),HJ.UNKNOWN;switch(e){case QX.OK:return HJ.OK;case QX.CANCELLED:return HJ.CANCELLED;case QX.UNKNOWN:return HJ.UNKNOWN;case QX.DEADLINE_EXCEEDED:return HJ.DEADLINE_EXCEEDED;case QX.RESOURCE_EXHAUSTED:return HJ.RESOURCE_EXHAUSTED;case QX.INTERNAL:return HJ.INTERNAL;case QX.UNAVAILABLE:return HJ.UNAVAILABLE;case QX.UNAUTHENTICATED:return HJ.UNAUTHENTICATED;case QX.INVALID_ARGUMENT:return HJ.INVALID_ARGUMENT;case QX.NOT_FOUND:return HJ.NOT_FOUND;case QX.ALREADY_EXISTS:return HJ.ALREADY_EXISTS;case QX.PERMISSION_DENIED:return HJ.PERMISSION_DENIED;case QX.FAILED_PRECONDITION:return HJ.FAILED_PRECONDITION;case QX.ABORTED:return HJ.ABORTED;case QX.OUT_OF_RANGE:return HJ.OUT_OF_RANGE;case QX.UNIMPLEMENTED:return HJ.UNIMPLEMENTED;case QX.DATA_LOSS:return HJ.DATA_LOSS;default:return VJ()}}(XX=QX||(QX={}))[XX.OK=0]="OK",XX[XX.CANCELLED=1]="CANCELLED",XX[XX.UNKNOWN=2]="UNKNOWN",XX[XX.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",XX[XX.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",XX[XX.NOT_FOUND=5]="NOT_FOUND",XX[XX.ALREADY_EXISTS=6]="ALREADY_EXISTS",XX[XX.PERMISSION_DENIED=7]="PERMISSION_DENIED",XX[XX.UNAUTHENTICATED=16]="UNAUTHENTICATED",XX[XX.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",XX[XX.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",XX[XX.ABORTED=10]="ABORTED",XX[XX.OUT_OF_RANGE=11]="OUT_OF_RANGE",XX[XX.UNIMPLEMENTED=12]="UNIMPLEMENTED",XX[XX.INTERNAL=13]="INTERNAL",XX[XX.UNAVAILABLE=14]="UNAVAILABLE",XX[XX.DATA_LOSS=15]="DATA_LOSS";var a1=function(){function e(t,n){np(this,e),this.comparator=t,this.root=n||s1.EMPTY}return ip(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,s1.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,s1.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal(function(t,n){return e(t,n),!1})}},{key:"toString",value:function(){var e=[];return this.inorderTraversal(function(t,n){return e.push("".concat(t,":").concat(n)),!1}),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new o1(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new o1(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new o1(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new o1(this.root,e,this.comparator,!0)}}]),e}(),o1=function(){function e(t,n,r,i){np(this,e),this.isReverse=i,this.nodeStack=[];for(var a=1;!t.isEmpty();)if(a=n?r(t.key,n):1,i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return ip(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),s1=function(){function e(t,n,r,i,a){np(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=a?a:e.EMPTY,this.size=this.left.size+1+this.right.size}return ip(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw VJ();var e=this.left.check();if(e!==this.right.check())throw VJ();return e+(this.isRed()?0:1)}}]),e}();s1.EMPTY=null,s1.RED=!0,s1.BLACK=!1,s1.EMPTY=new(function(){function e(){np(this,e),this.size=0}return ip(e,[{key:"key",get:function(){throw VJ()}},{key:"value",get:function(){throw VJ()}},{key:"color",get:function(){throw VJ()}},{key:"left",get:function(){throw VJ()}},{key:"right",get:function(){throw VJ()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new s1(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var u1=function(){function e(t){np(this,e),this.comparator=t,this.data=new a1(this.comparator)}return ip(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal(function(t,n){return e(t),!1})}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new c1(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new c1(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach(function(e){t=t.add(e)}),t}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach(function(t){e.push(t)}),e}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),c1=function(){function e(t){np(this,e),this.iter=t}return ip(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}(),l1=new a1(EQ.comparator);function h1(){return l1}var f1=new a1(EQ.comparator);function d1(){return f1}var v1=new a1(EQ.comparator),p1=new u1(EQ.comparator);function g1(){for(var e=p1,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.add(o)}return e}var y1=new u1(nQ);function m1(){return y1}var k1=function(){function e(t,n,r,i,a){np(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return ip(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n){var r=new Map;return r.set(t,_1.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(aQ.min(),r,m1(),h1(),g1())}}]),e}(),_1=function(){function e(t,n,r,i,a){np(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return ip(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n){return new e(vQ.EMPTY_BYTE_STRING,n,g1(),g1(),g1())}}]),e}(),w1=ip(function e(t,n,r,i){np(this,e),this.$=t,this.removedTargetIds=n,this.key=r,this.O=i}),C1=ip(function e(t,n){np(this,e),this.targetId=t,this.M=n}),b1=ip(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vQ.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;np(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}),E1=function(){function e(){np(this,e),this.F=0,this.L=O1(),this.B=vQ.EMPTY_BYTE_STRING,this.U=!1,this.q=!0}return ip(e,[{key:"current",get:function(){return this.U}},{key:"resumeToken",get:function(){return this.B}},{key:"K",get:function(){return 0!==this.F}},{key:"j",get:function(){return this.q}},{key:"W",value:function(e){e.approximateByteSize()>0&&(this.q=!0,this.B=e)}},{key:"G",value:function(){var e=g1(),t=g1(),n=g1();return this.L.forEach(function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:VJ()}}),new _1(this.B,this.U,e,t,n)}},{key:"H",value:function(){this.q=!1,this.L=O1()}},{key:"J",value:function(e,t){this.q=!0,this.L=this.L.insert(e,t)}},{key:"Y",value:function(e){this.q=!0,this.L=this.L.remove(e)}},{key:"X",value:function(){this.F+=1}},{key:"Z",value:function(){this.F-=1}},{key:"tt",value:function(){this.q=!0,this.U=!0}}]),e}(),S1=function(){function e(t){np(this,e),this.et=t,this.nt=new Map,this.st=h1(),this.it=P1(),this.rt=new u1(nQ)}return ip(e,[{key:"ot",value:function(e){var t,n=Xv(e.$);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.O&&e.O.isFoundDocument()?this.ct(r,e.O):this.at(r,e.key,e.O)}}catch(s){n.e(s)}finally{n.f()}var i,a=Xv(e.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.at(o,e.key,e.O)}}catch(s){a.e(s)}finally{a.f()}}},{key:"ut",value:function(e){var t=this;this.forEachTarget(e,function(n){var r=t.ht(n);switch(e.state){case 0:t.lt(n)&&r.W(e.resumeToken);break;case 1:r.Z(),r.K||r.H(),r.W(e.resumeToken);break;case 2:r.Z(),r.K||t.removeTarget(n);break;case 3:t.lt(n)&&(r.tt(),r.W(e.resumeToken));break;case 4:t.lt(n)&&(t.ft(n),r.W(e.resumeToken));break;default:VJ()}})}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.nt.forEach(function(e,r){n.lt(r)&&t(r)})}},{key:"dt",value:function(e){var t=e.targetId,n=e.M.count,r=this.wt(t);if(r){var i=r.target;if(WQ(i))if(0===n){var a=new EQ(i.path);this.at(t,a,zQ.newNoDocument(a,aQ.min()))}else UJ(1===n);else this._t(t)!==n&&(this.ft(t),this.rt=this.rt.add(t))}}},{key:"gt",value:function(e){var t=this,n=new Map;this.nt.forEach(function(r,i){var a=t.wt(i);if(a){if(r.current&&WQ(a.target)){var o=new EQ(a.target.path);null!==t.st.get(o)||t.yt(i,o)||t.at(i,o,zQ.newNoDocument(o,e))}r.j&&(n.set(i,r.G()),r.H())}});var r=g1();this.it.forEach(function(e,n){var i=!0;n.forEachWhile(function(e){var n=t.wt(e);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(e))});var i=new k1(e,n,this.rt,this.st,r);return this.st=h1(),this.it=P1(),this.rt=new u1(nQ),i}},{key:"ct",value:function(e,t){if(this.lt(e)){var n=this.yt(e,t.key)?2:0;this.ht(e).J(t.key,n),this.st=this.st.insert(t.key,t),this.it=this.it.insert(t.key,this.Tt(t.key).add(e))}}},{key:"at",value:function(e,t,n){if(this.lt(e)){var r=this.ht(e);this.yt(e,t)?r.J(t,1):r.Y(t),this.it=this.it.insert(t,this.Tt(t).delete(e)),n&&(this.st=this.st.insert(t,n))}}},{key:"removeTarget",value:function(e){this.nt.delete(e)}},{key:"_t",value:function(e){var t=this.ht(e).G();return this.et.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"X",value:function(e){this.ht(e).X()}},{key:"ht",value:function(e){var t=this.nt.get(e);return t||(t=new E1,this.nt.set(e,t)),t}},{key:"Tt",value:function(e){var t=this.it.get(e);return t||(t=new u1(nQ),this.it=this.it.insert(e,t)),t}},{key:"lt",value:function(e){var t=null!==this.wt(e);return t||DJ("WatchChangeAggregator","Detected inactive target",e),t}},{key:"wt",value:function(e){var t=this.nt.get(e);return t&&t.K?null:this.et.Et(e)}},{key:"ft",value:function(e){var t=this;this.nt.set(e,new E1),this.et.getRemoteKeysForTarget(e).forEach(function(n){t.at(e,n,null)})}},{key:"yt",value:function(e,t){return this.et.getRemoteKeysForTarget(e).has(t)}}]),e}();function P1(){return new a1(EQ.comparator)}function O1(){return new a1(EQ.comparator)}var T1={asc:"ASCENDING",desc:"DESCENDING"},I1={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},x1=ip(function e(t,n){np(this,e),this.databaseId=t,this.C=n});function A1(e,t){return e.C?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function R1(e,t){return e.C?t.toBase64():t.toUint8Array()}function N1(e,t){return A1(e,t.toTimestamp())}function M1(e){return UJ(!!e),aQ.fromTimestamp((t=gQ(e),new iQ(t.seconds,t.nanos)));var t}function D1(e,t){return(n=e,new lQ(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function L1(e){var t=lQ.fromString(e);return UJ(n0(t)),t}function F1(e,t){return D1(e.databaseId,t.path)}function B1(e,t){var n=L1(t);if(n.get(1)!==e.databaseId.projectId)throw new GJ(HJ.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new GJ(HJ.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new EQ(z1(n))}function V1(e,t){return D1(e.databaseId,t)}function U1(e){return new lQ(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function z1(e){return UJ(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function H1(e,t,n){return{name:F1(e,t),fields:n.value.mapValue.fields}}function G1(e,t){return{documents:[V1(e,t.path)]}}function q1(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=V1(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=V1(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map(function(e){return function(e){if("=="===e.op){if(LQ(e.value))return{unaryFilter:{field:J1(e.field),op:"IS_NAN"}};if(DQ(e.value))return{unaryFilter:{field:J1(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(LQ(e.value))return{unaryFilter:{field:J1(e.field),op:"IS_NOT_NAN"}};if(DQ(e.value))return{unaryFilter:{field:J1(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:J1(e.field),op:K1(e.op),value:e.value}}}(e)});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map(function(e){return{field:J1((t=e).field),direction:Y1(t.dir)};var t})}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,s=(o=t.limit,e.C||CQ(o)?o:{value:o});return null!==s&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt=j1(t.startAt)),t.endAt&&(n.structuredQuery.endAt=j1(t.endAt)),n}function $1(e){var t=function(e){var t=L1(e);return 4===t.length?lQ.emptyPath():z1(t)}(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){UJ(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o=[];n.where&&(o=W1(n.where));var s=[];n.orderBy&&(s=n.orderBy.map(function(e){return new iX(Q1((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));var u=null;n.limit&&(u=function(e){var t;return CQ(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c=null;n.startAt&&(c=Z1(n.startAt));var l=null;return n.endAt&&(l=Z1(n.endAt)),function(e,t,n,r,i,a,o,s){return new uX(e,t,n,r,i,"F",o,s)}(t,i,s,o,u,0,c,l)}function W1(e){return e?void 0!==e.unaryFilter?[e0(e)]:void 0!==e.fieldFilter?[X1(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return W1(e)}).reduce(function(e,t){return e.concat(t)}):VJ():[]}function j1(e){return{before:e.before,values:e.position}}function Z1(e){return new nX(e.values||[],!!e.before)}function Y1(e){return T1[e]}function K1(e){return I1[e]}function J1(e){return{fieldPath:e.canonicalString()}}function Q1(e){return fQ.fromServerFormat(e.fieldPath)}function X1(e){return jQ.create(Q1(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return VJ()}}(e.fieldFilter.op),e.fieldFilter.value)}function e0(e){switch(e.unaryFilter.op){case"IS_NAN":var t=Q1(e.unaryFilter.field);return jQ.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=Q1(e.unaryFilter.field);return jQ.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Q1(e.unaryFilter.field);return jQ.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Q1(e.unaryFilter.field);return jQ.create(i,"!=",{nullValue:"NULL_VALUE"});default:return VJ()}}function t0(e){var t=[];return e.fields.forEach(function(e){return t.push(e.canonicalString())}),{fieldPaths:t}}function n0(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function r0(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=a0(t)),t=i0(e.get(n),t);return a0(t)}function i0(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var a=e.charAt(i);switch(a){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=a}}return n}function a0(e){return e+"\x01\x01"}var o0=ip(function e(t,n,r){np(this,e),this.ownerId=t,this.allowTabSynchronization=n,this.leaseTimestampMs=r});o0.store="owner",o0.key="owner";var s0=ip(function e(t,n,r){np(this,e),this.userId=t,this.lastAcknowledgedBatchId=n,this.lastStreamToken=r});s0.store="mutationQueues",s0.keyPath="userId";var u0=ip(function e(t,n,r,i,a){np(this,e),this.userId=t,this.batchId=n,this.localWriteTimeMs=r,this.baseMutations=i,this.mutations=a});u0.store="mutations",u0.keyPath="batchId",u0.userMutationsIndex="userMutationsIndex",u0.userMutationsKeyPath=["userId","batchId"];var c0=function(){function e(){np(this,e)}return ip(e,null,[{key:"prefixForUser",value:function(e){return[e]}},{key:"prefixForPath",value:function(e,t){return[e,r0(t)]}},{key:"key",value:function(e,t,n){return[e,r0(t),n]}}]),e}();c0.store="documentMutations",c0.PLACEHOLDER=new c0;var l0=ip(function e(t,n,r,i,a,o){np(this,e),this.unknownDocument=t,this.noDocument=n,this.document=r,this.hasCommittedMutations=i,this.readTime=a,this.parentPath=o});l0.store="remoteDocuments",l0.readTimeIndex="readTimeIndex",l0.readTimeIndexPath="readTime",l0.collectionReadTimeIndex="collectionReadTimeIndex",l0.collectionReadTimeIndexPath=["parentPath","readTime"];var h0=ip(function e(t){np(this,e),this.byteSize=t});h0.store="remoteDocumentGlobal",h0.key="remoteDocumentGlobalKey";var f0=ip(function e(t,n,r,i,a,o,s){np(this,e),this.targetId=t,this.canonicalId=n,this.readTime=r,this.resumeToken=i,this.lastListenSequenceNumber=a,this.lastLimboFreeSnapshotVersion=o,this.query=s});f0.store="targets",f0.keyPath="targetId",f0.queryTargetsIndexName="queryTargetsIndex",f0.queryTargetsKeyPath=["canonicalId","targetId"];var d0=ip(function e(t,n,r){np(this,e),this.targetId=t,this.path=n,this.sequenceNumber=r});d0.store="targetDocuments",d0.keyPath=["targetId","path"],d0.documentTargetsIndex="documentTargetsIndex",d0.documentTargetsKeyPath=["path","targetId"];var v0=ip(function e(t,n,r,i){np(this,e),this.highestTargetId=t,this.highestListenSequenceNumber=n,this.lastRemoteSnapshotVersion=r,this.targetCount=i});v0.key="targetGlobalKey",v0.store="targetGlobal";var p0=ip(function e(t,n){np(this,e),this.collectionId=t,this.parent=n});p0.store="collectionParents",p0.keyPath=["collectionId","parent"];var g0=ip(function e(t,n,r,i){np(this,e),this.clientId=t,this.updateTimeMs=n,this.networkEnabled=r,this.inForeground=i});g0.store="clientMetadata",g0.keyPath="clientId";var y0=ip(function e(t,n,r){np(this,e),this.bundleId=t,this.createTime=n,this.version=r});y0.store="bundles",y0.keyPath="bundleId";var m0=ip(function e(t,n,r){np(this,e),this.name=t,this.readTime=n,this.bundledQuery=r});m0.store="namedQueries",m0.keyPath="name";var k0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",_0=function(){function e(t){var n=this;np(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)},function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)})}return ip(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&VJ(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}})}},{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.next(t,n)})}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(n){return e.reject(n)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.reject(n)}}],[{key:"resolve",value:function(t){return new e(function(e,n){e(t)})}},{key:"reject",value:function(t){return new e(function(e,n){n(t)})}},{key:"waitFor",value:function(t){return new e(function(e,n){var r=0,i=0,a=!1;t.forEach(function(t){++r,t.next(function(){++i,a&&i===r&&e()},function(e){return n(e)})}),a=!0,i===r&&e()})}},{key:"or",value:function(t){var n,r=e.resolve(!1),i=Xv(t);try{var a=function(){var t=n.value;r=r.next(function(n){return n?e.resolve(n):t()})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach(function(e,i){r.push(t.call(n,e,i))}),this.waitFor(r)}}]),e}();function w0(e){return"IndexedDbTransactionError"===e.name}var C0=function(){function e(t,n,r,i){np(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return ip(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&HX(i,e,n[r])}}},{key:"applyToLocalView",value:function(e){var t,n=Xv(this.baseMutations);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.key.isEqual(e.key)&&GX(r,e,this.localWriteTime)}}catch(s){n.e(s)}finally{n.f()}var i,a=Xv(this.mutations);try{for(a.s();!(i=a.n()).done;){var o=i.value;o.key.isEqual(e.key)&&GX(o,e,this.localWriteTime)}}catch(s){a.e(s)}finally{a.f()}}},{key:"applyToLocalDocumentSet",value:function(e){var t=this;this.mutations.forEach(function(n){var r=e.get(n.key),i=r;t.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(aQ.min())})}},{key:"keys",value:function(){return this.mutations.reduce(function(e,t){return e.add(t.key)},g1())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&rQ(this.mutations,e.mutations,function(e,t){return $X(e,t)})&&rQ(this.baseMutations,e.baseMutations,function(e,t){return $X(e,t)})}}]),e}(),b0=function(){function e(t,n,r,i){np(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return ip(e,null,[{key:"from",value:function(t,n,r){UJ(t.mutations.length===r.length);for(var i=v1,a=t.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new e(t,n,r,i)}}]),e}(),E0=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:aQ.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:aQ.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:vQ.EMPTY_BYTE_STRING;np(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return ip(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}]),e}(),S0=ip(function e(t){np(this,e),this.Gt=t});function P0(e){var t=$1({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?function(e,t,n){return new uX(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,"L",e.startAt,e.endAt)}(t,t.limit):t}var O0=function(){function e(){np(this,e),this.zt=new T0}return ip(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.zt.add(t),_0.resolve()}},{key:"getCollectionParents",value:function(e,t){return _0.resolve(this.zt.getEntries(t))}}]),e}(),T0=function(){function e(){np(this,e),this.index={}}return ip(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new u1(lQ.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new u1(lQ.comparator)).toArray()}}]),e}(),I0=function(){function e(t,n,r){np(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return ip(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();I0.DEFAULT_COLLECTION_PERCENTILE=10,I0.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,I0.DEFAULT=new I0(41943040,I0.DEFAULT_COLLECTION_PERCENTILE,I0.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),I0.DISABLED=new I0(-1,0,0);var x0=function(){function e(t){np(this,e),this.se=t}return ip(e,[{key:"next",value:function(){return this.se+=2,this.se}}],[{key:"ie",value:function(){return new e(0)}},{key:"re",value:function(){return new e(-1)}}]),e}();function A0(e){return R0.apply(this,arguments)}function R0(){return(R0=rB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===HJ.FAILED_PRECONDITION&&t.message===k0){e.next=2;break}throw t;case 2:DJ("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}var N0=function(){function e(t,n){np(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={}}return ip(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,i=Xv(n);try{for(i.s();!(r=i.n()).done;){var a=Fv(r.value,2),o=a[0],s=a[1];if(this.equalsFn(o,e))return s}}catch(u){i.e(u)}finally{i.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1}},{key:"forEach",value:function(e){sQ(this.inner,function(t,n){var r,i=Xv(n);try{for(i.s();!(r=i.n()).done;){var a=Fv(r.value,2),o=a[0],s=a[1];e(o,s)}}catch(u){i.e(u)}finally{i.f()}})}},{key:"isEmpty",value:function(){return uQ(this.inner)}}]),e}(),M0=function(){function e(t,n,r){np(this,e),this.Je=t,this.An=n,this.Jt=r}return ip(e,[{key:"Rn",value:function(e,t){var n=this;return this.An.getAllMutationBatchesAffectingDocumentKey(e,t).next(function(r){return n.bn(e,t,r)})}},{key:"bn",value:function(e,t,n){return this.Je.getEntry(e,t).next(function(e){var t,r=Xv(n);try{for(r.s();!(t=r.n()).done;){t.value.applyToLocalView(e)}}catch(i){r.e(i)}finally{r.f()}return e})}},{key:"Pn",value:function(e,t){e.forEach(function(e,n){var r,i=Xv(t);try{for(i.s();!(r=i.n()).done;){r.value.applyToLocalView(n)}}catch(a){i.e(a)}finally{i.f()}})}},{key:"vn",value:function(e,t){var n=this;return this.Je.getEntries(e,t).next(function(t){return n.Vn(e,t).next(function(){return t})})}},{key:"Vn",value:function(e,t){var n=this;return this.An.getAllMutationBatchesAffectingDocumentKeys(e,t).next(function(e){return n.Pn(t,e)})}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return EQ.isDocumentKey((r=t).path)&&null===r.collectionGroup&&0===r.filters.length?this.Sn(e,t.path):vX(t)?this.Dn(e,t,n):this.Cn(e,t,n);var r}},{key:"Sn",value:function(e,t){return this.Rn(e,new EQ(t)).next(function(e){var t=d1();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}},{key:"Dn",value:function(e,t,n){var r=this,i=t.collectionGroup,a=d1();return this.Jt.getCollectionParents(e,i).next(function(o){return _0.forEach(o,function(o){var s,u,c=(s=t,u=o.child(i),new uX(u,null,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt));return r.Cn(e,c,n).next(function(e){e.forEach(function(e,t){a=a.insert(e,t)})})}).next(function(){return a})})}},{key:"Cn",value:function(e,t,n){var r,i,a=this;return this.Je.getDocumentsMatchingQuery(e,t,n).next(function(n){return r=n,a.An.getAllMutationBatchesAffectingQuery(e,t)}).next(function(t){return i=t,a.Nn(e,i,r).next(function(e){r=e;var t,n=Xv(i);try{for(n.s();!(t=n.n()).done;){var a,o=t.value,s=Xv(o.mutations);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=u.key,l=r.get(c);null==l&&(l=zQ.newInvalidDocument(c),r=r.insert(c,l)),GX(u,l,o.localWriteTime),l.isFoundDocument()||(r=r.remove(c))}}catch(h){s.e(h)}finally{s.f()}}}catch(h){n.e(h)}finally{n.f()}})}).next(function(){return r.forEach(function(e,n){_X(t,n)||(r=r.remove(e))}),r})}},{key:"Nn",value:function(e,t,n){var r,i=g1(),a=Xv(t);try{for(a.s();!(r=a.n()).done;){var o,s=Xv(r.value.mutations);try{for(s.s();!(o=s.n()).done;){var u=o.value;u instanceof ZX&&null===n.get(u.key)&&(i=i.add(u.key))}}catch(l){s.e(l)}finally{s.f()}}}catch(l){a.e(l)}finally{a.f()}var c=n;return this.Je.getEntries(e,i).next(function(e){return e.forEach(function(e,t){t.isFoundDocument()&&(c=c.insert(e,t))}),c})}}]),e}(),D0=function(){function e(t,n,r,i){np(this,e),this.targetId=t,this.fromCache=n,this.kn=r,this.xn=i}return ip(e,null,[{key:"$n",value:function(t,n){var r,i=g1(),a=g1(),o=Xv(n.docChanges);try{for(o.s();!(r=o.n()).done;){var s=r.value;switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}}}catch(u){o.e(u)}finally{o.f()}return new e(t,n.fromCache,i,a)}}]),e}(),L0=function(){function e(){np(this,e)}return ip(e,[{key:"On",value:function(e){this.Mn=e}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i,a=this;return 0===(i=t).filters.length&&null===i.limit&&null==i.startAt&&null==i.endAt&&(0===i.explicitOrderBy.length||1===i.explicitOrderBy.length&&i.explicitOrderBy[0].field.isKeyField())||n.isEqual(aQ.min())?this.Fn(e,t):this.Mn.vn(e,r).next(function(i){var o=a.Ln(t,i);return(lX(t)||hX(t))&&a.Bn(t.limitType,o,r,n)?a.Fn(e,t):(MJ()<=rV.DEBUG&&DJ("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),kX(t)),a.Mn.getDocumentsMatchingQuery(e,t,n).next(function(e){return o.forEach(function(t){e=e.insert(t.key,t)}),e}))})}},{key:"Ln",value:function(e,t){var n=new u1(wX(e));return t.forEach(function(t,r){_X(e,r)&&(n=n.add(r))}),n}},{key:"Bn",value:function(e,t,n,r){if(n.size!==t.size)return!0;var i="F"===e?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Fn",value:function(e,t){return MJ()<=rV.DEBUG&&DJ("QueryEngine","Using full collection scan to execute query:",kX(t)),this.Mn.getDocumentsMatchingQuery(e,t,aQ.min())}}]),e}(),F0=function(){function e(t,n,r,i){np(this,e),this.persistence=t,this.Un=n,this.k=i,this.qn=new a1(nQ),this.Kn=new N0(function(e){return qQ(e)},$Q),this.jn=aQ.min(),this.An=t.getMutationQueue(r),this.Qn=t.getRemoteDocumentCache(),this.He=t.getTargetCache(),this.Wn=new M0(this.Qn,this.An,this.persistence.getIndexManager()),this.Ye=t.getBundleCache(),this.Un.On(this.Wn)}return ip(e,[{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return e.collect(n,t.qn)})}}]),e}();function B0(e,t){return V0.apply(this,arguments)}function V0(){return(V0=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=zJ(t),i=r.An,a=r.Wn,e.next=4,r.persistence.runTransaction("Handle user change","readonly",function(e){var t;return r.An.getAllMutationBatches(e).next(function(o){return t=o,i=r.persistence.getMutationQueue(n),a=new M0(r.Qn,i,r.persistence.getIndexManager()),i.getAllMutationBatches(e)}).next(function(n){var r,i=[],o=[],s=g1(),u=Xv(t);try{for(u.s();!(r=u.n()).done;){var c=r.value;i.push(c.batchId);var l,h=Xv(c.mutations);try{for(h.s();!(l=h.n()).done;){var f=l.value;s=s.add(f.key)}}catch(k){h.e(k)}finally{h.f()}}}catch(k){u.e(k)}finally{u.f()}var d,v=Xv(n);try{for(v.s();!(d=v.n()).done;){var p=d.value;o.push(p.batchId);var g,y=Xv(p.mutations);try{for(y.s();!(g=y.n()).done;){var m=g.value;s=s.add(m.key)}}catch(k){y.e(k)}finally{y.f()}}}catch(k){v.e(k)}finally{v.f()}return a.vn(e,s).next(function(e){return{Gn:e,removedBatchIds:i,addedBatchIds:o}})})});case 4:return o=e.sent,e.abrupt("return",(r.An=i,r.Wn=a,r.Un.On(r.Wn),o));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function U0(e,t){var n=zJ(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(e){var r,i,a,o,s,u,c,l=t.batch.keys(),h=n.Qn.newChangeBuffer({trackRemovals:!0});return(r=n,i=e,a=t,o=h,s=a.batch,u=s.keys(),c=_0.resolve(),u.forEach(function(e){c=c.next(function(){return o.getEntry(i,e)}).next(function(t){var n=a.docVersions.get(e);UJ(null!==n),t.version.compareTo(n)<0&&(s.applyToRemoteDocument(t,a),t.isValidDocument()&&o.addEntry(t,a.commitVersion))})}),c.next(function(){return r.An.removeMutationBatch(i,s)})).next(function(){return h.apply(e)}).next(function(){return n.An.performConsistencyCheck(e)}).next(function(){return n.Wn.vn(e,l)})})}function z0(e){var t=zJ(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.He.getLastRemoteSnapshotVersion(e)})}function H0(e,t){var n=zJ(e),r=t.snapshotVersion,i=n.qn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(e){var a=n.Qn.newChangeBuffer({trackRemovals:!0});i=n.qn;var o=[];t.targetChanges.forEach(function(a,s){var u=i.get(s);if(u){o.push(n.He.removeMatchingKeys(e,a.removedDocuments,s).next(function(){return n.He.addMatchingKeys(e,a.addedDocuments,s)}));var c,l,h,f=u.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(s)?f=f.withResumeToken(vQ.EMPTY_BYTE_STRING,aQ.min()).withLastLimboFreeSnapshotVersion(aQ.min()):a.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(a.resumeToken,r)),i=i.insert(s,f),l=f,h=a,(0===(c=u).resumeToken.approximateByteSize()||l.snapshotVersion.toMicroseconds()-c.snapshotVersion.toMicroseconds()>=3e8||h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size>0)&&o.push(n.He.updateTargetData(e,f))}});var s=h1();if(t.documentUpdates.forEach(function(r,i){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(function(e,t,n,r,i){var a=g1();return n.forEach(function(e){return a=a.add(e)}),t.getEntries(e,a).next(function(e){var i=h1();return n.forEach(function(n,a){var o=e.get(n),s=r;a.isNoDocument()&&a.version.isEqual(aQ.min())?(t.removeEntry(n,s),i=i.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a,s),i=i.insert(n,a)):DJ("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)}),i})}(e,a,t.documentUpdates,r).next(function(e){s=e})),!r.isEqual(aQ.min())){var u=n.He.getLastRemoteSnapshotVersion(e).next(function(t){return n.He.setTargetsMetadata(e,e.currentSequenceNumber,r)});o.push(u)}return _0.waitFor(o).next(function(){return a.apply(e)}).next(function(){return n.Wn.Vn(e,s)}).next(function(){return s})}).then(function(e){return n.qn=i,e})}function G0(e,t){var n=zJ(e);return n.persistence.runTransaction("Get next mutation batch","readonly",function(e){return void 0===t&&(t=-1),n.An.getNextMutationBatchAfterBatchId(e,t)})}function q0(e,t){var n=zJ(e);return n.persistence.runTransaction("Allocate target","readwrite",function(e){var r;return n.He.getTargetData(e,t).next(function(i){return i?(r=i,_0.resolve(r)):n.He.allocateTargetId(e).next(function(i){return r=new E0(t,i,0,e.currentSequenceNumber),n.He.addTargetData(e,r).next(function(){return r})})})}).then(function(e){var r=n.qn.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.qn=n.qn.insert(e.targetId,e),n.Kn.set(t,e.targetId)),e})}function $0(e,t,n){return W0.apply(this,arguments)}function W0(){return(W0=rB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=zJ(t),a=i.qn.get(n),o=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,i.persistence.runTransaction("Release target",o,function(e){return i.persistence.referenceDelegate.removeTarget(e,a)});case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),w0(e.t1)){e.next=12;break}throw e.t1;case 12:DJ("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:i.qn=i.qn.remove(n),i.Kn.delete(a.target);case 14:case"end":return e.stop()}},e,null,[[1,8]])}))).apply(this,arguments)}function j0(e,t,n){var r=zJ(e),i=aQ.min(),a=g1();return r.persistence.runTransaction("Execute query","readonly",function(e){return(o=r,s=e,u=gX(t),c=zJ(o),l=c.Kn.get(u),void 0!==l?_0.resolve(c.qn.get(l)):c.He.getTargetData(s,u)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.He.getMatchingKeysForTargetId(e,t.targetId).next(function(e){a=e})}).next(function(){return r.Un.getDocumentsMatchingQuery(e,t,n?i:aQ.min(),n?a:g1())}).next(function(e){return{documents:e,zn:a}});var o,s,u,c,l})}var Z0=function(){function e(t){np(this,e),this.k=t,this.Xn=new Map,this.Zn=new Map}return ip(e,[{key:"getBundleMetadata",value:function(e,t){return _0.resolve(this.Xn.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.Xn.set(t.id,{id:(n=t).id,version:n.version,createTime:M1(n.createTime)}),_0.resolve()}},{key:"getNamedQuery",value:function(e,t){return _0.resolve(this.Zn.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.Zn.set(t.name,{name:(n=t).name,query:P0(n.bundledQuery),readTime:M1(n.readTime)}),_0.resolve();var n}}]),e}(),Y0=function(){function e(){np(this,e),this.ts=new u1(K0.es),this.ns=new u1(K0.ss)}return ip(e,[{key:"isEmpty",value:function(){return this.ts.isEmpty()}},{key:"addReference",value:function(e,t){var n=new K0(e,t);this.ts=this.ts.add(n),this.ns=this.ns.add(n)}},{key:"rs",value:function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})}},{key:"removeReference",value:function(e,t){this.os(new K0(e,t))}},{key:"cs",value:function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})}},{key:"us",value:function(e){var t=this,n=new EQ(new lQ([])),r=new K0(n,e),i=new K0(n,e+1),a=[];return this.ns.forEachInRange([r,i],function(e){t.os(e),a.push(e.key)}),a}},{key:"hs",value:function(){var e=this;this.ts.forEach(function(t){return e.os(t)})}},{key:"os",value:function(e){this.ts=this.ts.delete(e),this.ns=this.ns.delete(e)}},{key:"ls",value:function(e){var t=new EQ(new lQ([])),n=new K0(t,e),r=new K0(t,e+1),i=g1();return this.ns.forEachInRange([n,r],function(e){i=i.add(e.key)}),i}},{key:"containsKey",value:function(e){var t=new K0(e,0),n=this.ts.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),K0=function(){function e(t,n){np(this,e),this.key=t,this.fs=n}return ip(e,null,[{key:"es",value:function(e,t){return EQ.comparator(e.key,t.key)||nQ(e.fs,t.fs)}},{key:"ss",value:function(e,t){return nQ(e.fs,t.fs)||EQ.comparator(e.key,t.key)}}]),e}(),J0=function(){function e(t,n){np(this,e),this.Jt=t,this.referenceDelegate=n,this.An=[],this.ds=1,this.ws=new u1(K0.es)}return ip(e,[{key:"checkEmpty",value:function(e){return _0.resolve(0===this.An.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.ds;this.ds++;var a=new C0(i,t,n,r);this.An.push(a);var o,s=Xv(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.ws=this.ws.add(new K0(u.key,i)),this.Jt.addToCollectionParentIndex(e,u.key.path.popLast())}}catch(c){s.e(c)}finally{s.f()}return _0.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return _0.resolve(this._s(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this.gs(t+1),r=n<0?0:n;return _0.resolve(this.An.length>r?this.An[r]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return _0.resolve(0===this.An.length?-1:this.ds-1)}},{key:"getAllMutationBatches",value:function(e){return _0.resolve(this.An.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new K0(t,0),i=new K0(t,Number.POSITIVE_INFINITY),a=[];return this.ws.forEachInRange([r,i],function(e){var t=n._s(e.fs);a.push(t)}),_0.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new u1(nQ);return t.forEach(function(e){var t=new K0(e,0),i=new K0(e,Number.POSITIVE_INFINITY);n.ws.forEachInRange([t,i],function(e){r=r.add(e.fs)})}),_0.resolve(this.ys(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;EQ.isDocumentKey(i)||(i=i.child(""));var a=new K0(new EQ(i),0),o=new u1(nQ);return this.ws.forEachWhile(function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.fs)),!0)},a),_0.resolve(this.ys(o))}},{key:"ys",value:function(e){var t=this,n=[];return e.forEach(function(e){var r=t._s(e);null!==r&&n.push(r)}),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;UJ(0===this.ps(t.batchId,"removed")),this.An.shift();var r=this.ws;return _0.forEach(t.mutations,function(i){var a=new K0(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(function(){n.ws=r})}},{key:"ee",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new K0(t,0),r=this.ws.firstAfterOrEqual(n);return _0.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return _0.resolve()}},{key:"ps",value:function(e,t){return this.gs(e)}},{key:"gs",value:function(e){return 0===this.An.length?0:e-this.An[0].batchId}},{key:"_s",value:function(e){var t=this.gs(e);return t<0||t>=this.An.length?null:this.An[t]}}]),e}(),Q0=function(){function e(t,n){np(this,e),this.Jt=t,this.Ts=n,this.docs=new a1(EQ.comparator),this.size=0}return ip(e,[{key:"addEntry",value:function(e,t,n){var r=t.key,i=this.docs.get(r),a=i?i.size:0,o=this.Ts(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o,readTime:n}),this.size+=o-a,this.Jt.addToCollectionParentIndex(e,r.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return _0.resolve(n?n.document.mutableCopy():zQ.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=h1();return t.forEach(function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():zQ.newInvalidDocument(e))}),_0.resolve(r)}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){for(var r=h1(),i=new EQ(t.path.child("")),a=this.docs.getIteratorFrom(i);a.hasNext();){var o=a.getNext(),s=o.key,u=o.value,c=u.document,l=u.readTime;if(!t.path.isPrefixOf(s.path))break;l.compareTo(n)<=0||_X(t,c)&&(r=r.insert(c.key,c.mutableCopy()))}return _0.resolve(r)}},{key:"Es",value:function(e,t){return _0.forEach(this.docs,function(e){return t(e)})}},{key:"newChangeBuffer",value:function(e){return new X0(this)}},{key:"getSize",value:function(e){return _0.resolve(this.size)}}]),e}(),X0=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this)).De=e,r}return ip(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach(function(r,i){i.document.isValidDocument()?n.push(t.De.addEntry(e,i.document,t.getReadTime(r))):t.De.removeEntry(r)}),_0.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.De.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.De.getEntries(e,t)}}]),n}(function(){function e(){np(this,e),this.changes=new N0(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),this.changesApplied=!1}return ip(e,[{key:"getReadTime",value:function(e){var t=this.changes.get(e);return t?t.readTime:aQ.min()}},{key:"addEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:t})}},{key:"removeEntry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.assertNotApplied(),this.changes.set(e,{document:zQ.newInvalidDocument(e),readTime:t})}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?_0.resolve(n.document):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}()),e2=function(){function e(t){np(this,e),this.persistence=t,this.Is=new N0(function(e){return qQ(e)},$Q),this.lastRemoteSnapshotVersion=aQ.min(),this.highestTargetId=0,this.As=0,this.Rs=new Y0,this.targetCount=0,this.bs=x0.ie()}return ip(e,[{key:"forEachTarget",value:function(e,t){return this.Is.forEach(function(e,n){return t(n)}),_0.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return _0.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return _0.resolve(this.As)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.bs.next(),_0.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.As&&(this.As=t),_0.resolve()}},{key:"ae",value:function(e){this.Is.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.bs=new x0(t),this.highestTargetId=t),e.sequenceNumber>this.As&&(this.As=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.ae(t),this.targetCount+=1,_0.resolve()}},{key:"updateTargetData",value:function(e,t){return this.ae(t),_0.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Is.delete(t.target),this.Rs.us(t.targetId),this.targetCount-=1,_0.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Is.forEach(function(o,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.Is.delete(o),a.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)}),_0.waitFor(a).next(function(){return i})}},{key:"getTargetCount",value:function(e){return _0.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Is.get(t)||null;return _0.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.Rs.rs(t,n),_0.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.Rs.cs(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.markPotentiallyOrphaned(e,t))}),_0.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.Rs.us(t),_0.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.Rs.ls(t);return _0.resolve(n)}},{key:"containsKey",value:function(e,t){return _0.resolve(this.Rs.containsKey(t))}}]),e}(),t2=function(){function e(t,n){var r=this;np(this,e),this.Ps={},this.Be=new XJ(0),this.Ue=!1,this.Ue=!0,this.referenceDelegate=t(this),this.He=new e2(this),this.Jt=new O0,this.Je=new Q0(this.Jt,function(e){return r.referenceDelegate.vs(e)}),this.k=new S0(n),this.Ye=new Z0(this.k)}return ip(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.Ue=!1,Promise.resolve()}},{key:"started",get:function(){return this.Ue}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(){return this.Jt}},{key:"getMutationQueue",value:function(e){var t=this.Ps[e.toKey()];return t||(t=new J0(this.Jt,this.referenceDelegate),this.Ps[e.toKey()]=t),t}},{key:"getTargetCache",value:function(){return this.He}},{key:"getRemoteDocumentCache",value:function(){return this.Je}},{key:"getBundleCache",value:function(){return this.Ye}},{key:"runTransaction",value:function(e,t,n){var r=this;DJ("MemoryPersistence","Starting transaction:",e);var i=new n2(this.Be.next());return this.referenceDelegate.Vs(),n(i).next(function(e){return r.referenceDelegate.Ss(i).next(function(){return e})}).toPromise().then(function(e){return i.raiseOnCommittedEvent(),e})}},{key:"Ds",value:function(e,t){return _0.or(Object.values(this.Ps).map(function(n){return function(){return n.containsKey(e,t)}}))}}]),e}(),n2=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return ip(n)}(function(){function e(){np(this,e),this.onCommittedListeners=[]}return ip(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach(function(e){return e()})}}]),e}()),r2=function(){function e(t){np(this,e),this.persistence=t,this.Cs=new Y0,this.Ns=null}return ip(e,[{key:"xs",get:function(){if(this.Ns)return this.Ns;throw VJ()}},{key:"addReference",value:function(e,t,n){return this.Cs.addReference(n,t),this.xs.delete(n.toString()),_0.resolve()}},{key:"removeReference",value:function(e,t,n){return this.Cs.removeReference(n,t),this.xs.add(n.toString()),_0.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.xs.add(t.toString()),_0.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.Cs.us(t.targetId).forEach(function(e){return n.xs.add(e.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return n.xs.add(e.toString())})}).next(function(){return r.removeTargetData(e,t)})}},{key:"Vs",value:function(){this.Ns=new Set}},{key:"Ss",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _0.forEach(this.xs,function(r){var i=EQ.fromPath(r);return t.$s(e,i).next(function(e){e||n.removeEntry(i)})}).next(function(){return t.Ns=null,n.apply(e)})}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.$s(e,t).next(function(e){e?n.xs.delete(t.toString()):n.xs.add(t.toString())})}},{key:"vs",value:function(e){return 0}},{key:"$s",value:function(e,t){var n=this;return _0.or([function(){return _0.resolve(n.Cs.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Ds(e,t)}])}}],[{key:"ks",value:function(t){return new e(t)}}]),e}(),i2=function(){function e(){np(this,e),this.activeTargetIds=m1()}return ip(e,[{key:"Fs",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"Ls",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"Ms",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),a2=function(){function e(){np(this,e),this.pi=new i2,this.Ti={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return ip(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.pi.Fs(e),this.Ti[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.Ti[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.pi.Ls(e)}},{key:"isLocalQueryTarget",value:function(e){return this.pi.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.Ti[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.pi.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.pi.activeTargetIds.has(e)}},{key:"start",value:function(){return this.pi=new i2,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(){}}]),e}(),o2=function(){function e(){np(this,e)}return ip(e,[{key:"Ei",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),s2=function(){function e(){var t=this;np(this,e),this.Ii=function(){return t.Ai()},this.Ri=function(){return t.bi()},this.Pi=[],this.vi()}return ip(e,[{key:"Ei",value:function(e){this.Pi.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Ii),window.removeEventListener("offline",this.Ri)}},{key:"vi",value:function(){window.addEventListener("online",this.Ii),window.addEventListener("offline",this.Ri)}},{key:"Ai",value:function(){DJ("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=Xv(this.Pi);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"bi",value:function(){DJ("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=Xv(this.Pi);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"Pt",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),u2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},c2=function(){function e(t){np(this,e),this.Vi=t.Vi,this.Si=t.Si}return ip(e,[{key:"Di",value:function(e){this.Ci=e}},{key:"Ni",value:function(e){this.ki=e}},{key:"onMessage",value:function(e){this.xi=e}},{key:"close",value:function(){this.Si()}},{key:"send",value:function(e){this.Vi(e)}},{key:"$i",value:function(){this.Ci()}},{key:"Oi",value:function(e){this.ki(e)}},{key:"Mi",value:function(e){this.xi(e)}}]),e}(),l2=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r}return ip(n,[{key:"Ki",value:function(e,t,n,r){return new Promise(function(i,a){var o=new IJ;o.listenOnce(EJ.COMPLETE,function(){try{switch(o.getLastErrorCode()){case bJ.NO_ERROR:var t=o.getResponseJson();DJ("Connection","XHR received:",JSON.stringify(t)),i(t);break;case bJ.TIMEOUT:DJ("Connection",'RPC "'+e+'" timed out'),a(new GJ(HJ.DEADLINE_EXCEEDED,"Request time out"));break;case bJ.HTTP_ERROR:var n=o.getStatus();if(DJ("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson().error;if(r&&r.status&&r.message){var s=(u=r.status,c=u.toLowerCase().replace(/_/g,"-"),Object.values(HJ).indexOf(c)>=0?c:HJ.UNKNOWN);a(new GJ(s,r.message))}else a(new GJ(HJ.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new GJ(HJ.UNAVAILABLE,"Connection failed."));break;default:VJ()}}finally{DJ("Connection",'RPC "'+e+'" completed.')}var u,c});var s=JSON.stringify(r);o.send(t,"POST",s,n,15)})}},{key:"Qi",value:function(e,t,n){var r=[this.Fi,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=wJ(),a=CJ(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new OJ({})),this.qi(o.initMessageHeaders,t,n),bB()||SB()||CB().indexOf("Electron/")>=0||PB()||CB().indexOf("MSAppHost/")>=0||EB()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=r.join("");DJ("Connection","Creating WebChannel: "+s,o);var u=i.createWebChannel(s,o),c=!1,l=!1,h=new c2({Vi:function(e){l?DJ("Connection","Not sending because WebChannel is closed:",e):(c||(DJ("Connection","Opening WebChannel transport."),u.open(),c=!0),DJ("Connection","WebChannel sending:",e),u.send(e))},Si:function(){return u.close()}}),f=function(e,t,n){e.listen(t,function(e){try{n(e)}catch(t){setTimeout(function(){throw t},0)}})};return f(u,TJ.EventType.OPEN,function(){l||DJ("Connection","WebChannel transport opened.")}),f(u,TJ.EventType.CLOSE,function(){l||(l=!0,DJ("Connection","WebChannel transport closed"),h.Oi())}),f(u,TJ.EventType.ERROR,function(e){l||(l=!0,FJ("Connection","WebChannel transport errored:",e),h.Oi(new GJ(HJ.UNAVAILABLE,"The operation could not be completed")))}),f(u,TJ.EventType.MESSAGE,function(e){var t;if(!l){var n=e.data[0];UJ(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){DJ("Connection","WebChannel received error:",i);var a=i.status,o=function(e){var t=QX[e];if(void 0!==t)return i1(t)}(a),s=i.message;void 0===o&&(o=HJ.INTERNAL,s="Unknown error status: "+a+" with message "+i.message),l=!0,h.Oi(new GJ(o,s)),u.close()}else DJ("Connection","WebChannel received:",n),h.Mi(n)}}),f(a,SJ.STAT_EVENT,function(e){e.stat===PJ.PROXY?DJ("Connection","Detected buffering proxy"):e.stat===PJ.NOPROXY&&DJ("Connection","Detected no buffering proxy")}),setTimeout(function(){h.$i()},0),h}}]),n}(function(){function e(t){np(this,e),this.databaseInfo=t,this.databaseId=t.databaseId,this.Fi=(t.ssl?"https":"http")+"://"+t.host,this.Li="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return ip(e,[{key:"Bi",value:function(e,t,n,r,i){var a=this.Ui(e,t);DJ("RestConnection","Sending: ",a,n);var o={};return this.qi(o,r,i),this.Ki(e,a,o,n).then(function(e){return DJ("RestConnection","Received: ",e),e},function(t){throw FJ("RestConnection","".concat(e," failed with error: "),t,"url: ",a,"request:",n),t})}},{key:"ji",value:function(e,t,n,r,i){return this.Bi(e,t,n,r,i)}},{key:"qi",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+RJ,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(function(t,n){return e[n]=t}),n&&n.headers.forEach(function(t,n){return e[n]=t})}},{key:"Ui",value:function(e,t){return"".concat(this.Fi,"/v1/").concat(t,":").concat(u2[e])}}]),e}());function h2(){return"undefined"!=typeof document?document:null}function f2(e){return new x1(e,!0)}var d2=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;np(this,e),this.Me=t,this.timerId=n,this.Wi=r,this.Gi=i,this.zi=a,this.Hi=0,this.Ji=null,this.Yi=Date.now(),this.reset()}return ip(e,[{key:"reset",value:function(){this.Hi=0}},{key:"Xi",value:function(){this.Hi=this.zi}},{key:"Zi",value:function(e){var t=this;this.cancel();var n=Math.floor(this.Hi+this.tr()),r=Math.max(0,Date.now()-this.Yi),i=Math.max(0,n-r);i>0&&DJ("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.Hi," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.Ji=this.Me.enqueueAfterDelay(this.timerId,i,function(){return t.Yi=Date.now(),e()}),this.Hi*=this.Gi,this.Hi<this.Wi&&(this.Hi=this.Wi),this.Hi>this.zi&&(this.Hi=this.zi)}},{key:"er",value:function(){null!==this.Ji&&(this.Ji.skipDelay(),this.Ji=null)}},{key:"cancel",value:function(){null!==this.Ji&&(this.Ji.cancel(),this.Ji=null)}},{key:"tr",value:function(){return(Math.random()-.5)*this.Hi}}]),e}(),v2=function(){function e(t,n,r,i,a,o,s,u){np(this,e),this.Me=t,this.nr=r,this.sr=i,this.ir=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=u,this.state=0,this.rr=0,this.cr=null,this.ar=null,this.stream=null,this.ur=new d2(t,n)}return ip(e,[{key:"hr",value:function(){return 1===this.state||5===this.state||this.lr()}},{key:"lr",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.dr()}},{key:"stop",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.hr(),!t.t0){t.next=4;break}return t.next=4,e.close(0);case 4:case"end":return t.stop()}},t)}))()}},{key:"wr",value:function(){this.state=0,this.ur.reset()}},{key:"_r",value:function(){var e=this;this.lr()&&null===this.cr&&(this.cr=this.Me.enqueueAfterDelay(this.nr,6e4,function(){return e.mr()}))}},{key:"gr",value:function(e){this.yr(),this.stream.send(e)}},{key:"mr",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.lr()){t.next=2;break}return t.abrupt("return",e.close(0));case 2:case"end":return t.stop()}},t)}))()}},{key:"yr",value:function(){this.cr&&(this.cr.cancel(),this.cr=null)}},{key:"pr",value:function(){this.ar&&(this.ar.cancel(),this.ar=null)}},{key:"close",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n.yr(),n.pr(),n.ur.cancel(),n.rr++,4!==e?n.ur.reset():t&&t.code===HJ.RESOURCE_EXHAUSTED?(LJ(t.toString()),LJ("Using maximum backoff delay to prevent overloading the backend."),n.ur.Xi()):t&&t.code===HJ.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Tr(),n.stream.close(),n.stream=null),n.state=e,r.next=9,n.listener.Ni(t);case 9:case"end":return r.stop()}},r)}))()}},{key:"Tr",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Er(this.rr),n=this.rr;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(function(t){var r=Fv(t,2),i=r[0],a=r[1];e.rr===n&&e.Ir(i,a)},function(n){t(function(){var t=new GJ(HJ.UNKNOWN,"Fetching auth token failed: "+n.message);return e.Ar(t)})})}},{key:"Ir",value:function(e,t){var n=this,r=this.Er(this.rr);this.stream=this.Rr(e,t),this.stream.Di(function(){r(function(){return n.state=2,n.ar=n.Me.enqueueAfterDelay(n.sr,1e4,function(){return n.lr()&&(n.state=3),Promise.resolve()}),n.listener.Di()})}),this.stream.Ni(function(e){r(function(){return n.Ar(e)})}),this.stream.onMessage(function(e){r(function(){return n.onMessage(e)})})}},{key:"dr",value:function(){var e=this;this.state=5,this.ur.Zi(rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}},t)})))}},{key:"Ar",value:function(e){return DJ("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Er",value:function(e){var t=this;return function(n){t.Me.enqueueAndForget(function(){return t.rr===e?n():(DJ("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}}}]),e}(),p2=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o,s){var u;return np(this,n),(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,a,s)).k=o,u}return ip(n,[{key:"Rr",value:function(e,t){return this.ir.Qi("Listen",e,t)}},{key:"onMessage",value:function(e){this.ur.reset();var t=function(e,t){var n,r;if("targetChange"in t){var i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:VJ(),a=t.targetChange.targetIds||[],o=function(e,t){return e.C?(UJ(void 0===t||"string"==typeof t),vQ.fromBase64String(t||"")):(UJ(void 0===t||t instanceof Uint8Array),vQ.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,u=s&&function(e){var t=void 0===e.code?HJ.UNKNOWN:i1(e.code);return new GJ(t,e.message||"")}(s);n=new b1(i,a,o,u||null)}else if("documentChange"in t){var c=t.documentChange,l=B1(e,c.document.name),h=M1(c.document.updateTime),f=new VQ({mapValue:{fields:c.document.fields}}),d=zQ.newFoundDocument(l,h,f);n=new w1(c.targetIds||[],c.removedTargetIds||[],d.key,d)}else if("documentDelete"in t){var v=t.documentDelete,p=B1(e,v.document),g=v.readTime?M1(v.readTime):aQ.min(),y=zQ.newNoDocument(p,g);n=new w1([],v.removedTargetIds||[],y.key,y)}else if("documentRemove"in t){var m=t.documentRemove,k=B1(e,m.document);n=new w1([],m.removedTargetIds||[],k,null)}else{if(!("filter"in t))return VJ();var _=t.filter,w=new n1(_.count||0);n=new C1(_.targetId,w)}return n}(this.k,e),n=function(e){if(!("targetChange"in e))return aQ.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?aQ.min():t.readTime?M1(t.readTime):aQ.min()}(e);return this.listener.br(t,n)}},{key:"Pr",value:function(e){var t,n,r,i,a={};a.database=U1(this.k),a.addTarget=(t=this.k,i=(n=e).target,(r=WQ(i)?{documents:G1(t,i)}:{query:q1(t,i)}).targetId=n.targetId,n.resumeToken.approximateByteSize()>0?r.resumeToken=R1(t,n.resumeToken):n.snapshotVersion.compareTo(aQ.min())>0&&(r.readTime=A1(t,n.snapshotVersion.toTimestamp())),r);var o=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return VJ()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);o&&(a.labels=o),this.gr(a)}},{key:"vr",value:function(e){var t={};t.database=U1(this.k),t.removeTarget=e,this.gr(t)}}]),n}(v2),g2=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o,s){var u;return np(this,n),(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,a,s)).k=o,u.Vr=!1,u}return ip(n,[{key:"Sr",get:function(){return this.Vr}},{key:"start",value:function(){this.Vr=!1,this.lastStreamToken=void 0,Hv(Kv(n.prototype),"start",this).call(this)}},{key:"Tr",value:function(){this.Vr&&this.Dr([])}},{key:"Rr",value:function(e,t){return this.ir.Qi("Write",e,t)}},{key:"onMessage",value:function(e){if(UJ(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Vr){this.ur.reset();var t=function(e,t){return e&&e.length>0?(UJ(void 0!==t),e.map(function(e){return function(e,t){var n=M1(e.updateTime?e.updateTime:t);return n.isEqual(aQ.min())&&(n=M1(t)),new BX(n,e.transformResults||[])}(e,t)})):[]}(e.writeResults,e.commitTime),n=M1(e.commitTime);return this.listener.Cr(n,t)}return UJ(!e.writeResults||0===e.writeResults.length),this.Vr=!0,this.listener.Nr()}},{key:"kr",value:function(){var e={};e.database=U1(this.k),this.gr(e)}},{key:"Dr",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map(function(e){return function(e,t){var n,r;if(t instanceof jX)n={update:H1(e,t.key,t.value)};else if(t instanceof e1)n={delete:F1(e,t.key)};else if(t instanceof ZX)n={update:H1(e,t.key,t.data),updateMask:t0(t.fieldMask)};else{if(!(t instanceof t1))return VJ();n={verify:F1(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(function(e){return function(e,t){var n=t.transform;if(n instanceof IX)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof xX)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof RX)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof MX)return{fieldPath:t.field.canonicalString(),increment:n.N};throw VJ()}(0,e)})),t.precondition.isNone||(n.currentDocument=void 0!==(r=t.precondition).updateTime?{updateTime:N1(e,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:VJ()),n}(t.k,e)})};this.gr(n)}}]),n}(v2),y2=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a){var o;return np(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.ir=i,o.k=a,o.$r=!1,o}return ip(n,[{key:"Or",value:function(){if(this.$r)throw new GJ(HJ.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"Bi",value:function(e,t,n){var r=this;return this.Or(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(i){var a=Fv(i,2),o=a[0],s=a[1];return r.ir.Bi(e,t,n,o,s)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===HJ.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new GJ(HJ.UNKNOWN,e.toString())})}},{key:"ji",value:function(e,t,n){var r=this;return this.Or(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(i){var a=Fv(i,2),o=a[0],s=a[1];return r.ir.ji(e,t,n,o,s)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===HJ.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new GJ(HJ.UNKNOWN,e.toString())})}},{key:"terminate",value:function(){this.$r=!0}}]),n}(function(){return ip(function e(){np(this,e)})}()),m2=function(){function e(t,n){np(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.Mr=0,this.Fr=null,this.Lr=!0}return ip(e,[{key:"Br",value:function(){var e=this;0===this.Mr&&(this.Ur("Unknown"),this.Fr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return e.Fr=null,e.qr("Backend didn't respond within 10 seconds."),e.Ur("Offline"),Promise.resolve()}))}},{key:"Kr",value:function(e){"Online"===this.state?this.Ur("Unknown"):(this.Mr++,this.Mr>=1&&(this.jr(),this.qr("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.Ur("Offline")))}},{key:"set",value:function(e){this.jr(),this.Mr=0,"Online"===e&&(this.Lr=!1),this.Ur(e)}},{key:"Ur",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"qr",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.Lr?(LJ(t),this.Lr=!1):DJ("OnlineStateTracker",t)}},{key:"jr",value:function(){null!==this.Fr&&(this.Fr.cancel(),this.Fr=null)}}]),e}(),k2=ip(function e(t,n,r,i,a){np(this,e);var o=this;this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Qr=[],this.Wr=new Map,this.Gr=new Set,this.zr=[],this.Hr=a,this.Hr.Ei(function(e){r.enqueueAndForget(rB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=x2(o),!e.t0){e.next=5;break}return DJ("RemoteStore","Restarting streams for network reachability change."),e.next=5,(t=rB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=zJ(t)).Gr.add(4),e.next=4,C2(n);case 4:return n.Jr.set("Unknown"),n.Gr.delete(4),e.next=8,_2(n);case 8:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})(o);case 5:case"end":return e.stop()}},e)})))}),this.Jr=new m2(r,i)});function _2(e){return w2.apply(this,arguments)}function w2(){return(w2=rB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!x2(t)){e.next=18;break}n=Xv(t.zr),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}},e,null,[[2,12,15,18]])}))).apply(this,arguments)}function C2(e){return b2.apply(this,arguments)}function b2(){return(b2=rB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Xv(t.zr),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,i(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[1,11,14,17]])}))).apply(this,arguments)}function E2(e,t){var n=zJ(e);n.Wr.has(t.targetId)||(n.Wr.set(t.targetId,t),I2(n)?T2(n):i3(n).lr()&&P2(n,t))}function S2(e,t){var n=zJ(e),r=i3(n);n.Wr.delete(t),r.lr()&&O2(n,t),0===n.Wr.size&&(r.lr()?r._r():x2(n)&&n.Jr.set("Unknown"))}function P2(e,t){e.Yr.X(t.targetId),i3(e).Pr(t)}function O2(e,t){e.Yr.X(t),i3(e).vr(t)}function T2(e){e.Yr=new S1({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},Et:function(t){return e.Wr.get(t)||null}}),i3(e).start(),e.Jr.Br()}function I2(e){return x2(e)&&!i3(e).hr()&&e.Wr.size>0}function x2(e){return 0===zJ(e).Gr.size}function A2(e){e.Yr=void 0}function R2(e){return N2.apply(this,arguments)}function N2(){return(N2=rB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.Wr.forEach(function(e,n){P2(t,e)});case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function M2(e,t){return D2.apply(this,arguments)}function D2(){return(D2=rB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:A2(t),I2(t)?(t.Jr.Kr(n),T2(t)):t.Jr.set("Unknown");case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function L2(e,t,n){return F2.apply(this,arguments)}function F2(){return(F2=rB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.Jr.set("Online"),!(n instanceof b1&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,(a=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,i=Xv(n.targetIds),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=14;break}if(o=a.value,e.t0=t.Wr.has(o),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(o,r);case 10:t.Wr.delete(o),t.Yr.removeTarget(o);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:case"end":return e.stop()}},e,null,[[2,16,19,22]])})),function(e,t){return a.apply(this,arguments)})(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),DJ("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,B2(t,e.t0);case 11:e.next=29;break;case 13:if(n instanceof w1?t.Yr.ot(n):n instanceof C1?t.Yr.dt(n):t.Yr.ut(n),r.isEqual(aQ.min())){e.next=29;break}return e.prev=14,e.next=17,z0(t.localStore);case 17:if(i=e.sent,e.t1=r.compareTo(i)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.Yr.gt(t);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.Wr.get(r);i&&e.Wr.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(function(t){var n=e.Wr.get(t);if(n){e.Wr.set(t,n.withResumeToken(vQ.EMPTY_BYTE_STRING,n.snapshotVersion)),O2(e,t);var r=new E0(n.target,t,1,n.sequenceNumber);P2(e,r)}}),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 22:e.next=29;break;case 24:return e.prev=24,e.t2=e.catch(14),DJ("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,B2(t,e.t2);case 29:case"end":return e.stop()}},e,null,[[1,6],[14,24]])}))).apply(this,arguments)}function B2(e,t,n){return V2.apply(this,arguments)}function V2(){return(V2=rB(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(w0(n)){e.next=2;break}throw n;case 2:return t.Gr.add(1),e.next=5,C2(t);case 5:t.Jr.set("Offline"),r||(r=function(){return z0(t.localStore)}),t.asyncQueue.enqueueRetryable(rB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return DJ("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.Gr.delete(1),e.next=6,_2(t);case 6:case"end":return e.stop()}},e)})));case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function U2(e,t){return t().catch(function(n){return B2(e,n,t)})}function z2(e){return H2.apply(this,arguments)}function H2(){return(H2=rB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=zJ(t),r=a3(n),i=n.Qr.length>0?n.Qr[n.Qr.length-1].batchId:-1;case 2:if(!G2(n)){e.next=19;break}return e.prev=3,e.next=6,G0(n.localStore,i);case 6:if(null!==(a=e.sent)){e.next=10;break}return 0===n.Qr.length&&r._r(),e.abrupt("break",19);case 10:i=a.batchId,q2(n,a),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,B2(n,e.t0);case 17:e.next=2;break;case 19:$2(n)&&W2(n);case 20:case"end":return e.stop()}},e,null,[[3,13]])}))).apply(this,arguments)}function G2(e){return x2(e)&&e.Qr.length<10}function q2(e,t){e.Qr.push(t);var n=a3(e);n.lr()&&n.Sr&&n.Dr(t.mutations)}function $2(e){return x2(e)&&!a3(e).hr()&&e.Qr.length>0}function W2(e){a3(e).start()}function j2(e){return Z2.apply(this,arguments)}function Z2(){return(Z2=rB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a3(t).kr();case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Y2(e){return K2.apply(this,arguments)}function K2(){return(K2=rB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=a3(t),r=Xv(t.Qr);try{for(r.s();!(i=r.n()).done;)a=i.value,n.Dr(a.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function J2(e,t,n){return Q2.apply(this,arguments)}function Q2(){return(Q2=rB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.Qr.shift(),a=b0.from(i,n,r),e.next=3,U2(t,function(){return t.remoteSyncer.applySuccessfulWrite(a)});case 3:return e.next=5,z2(t);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function X2(e,t){return e3.apply(this,arguments)}function e3(){return(e3=rB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&a3(t).Sr,!e.t0){e.next=4;break}return e.next=4,(r=rB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r1(i=n.code)||i===HJ.ABORTED){e.next=7;break}return r=t.Qr.shift(),a3(t).wr(),e.next=5,U2(t,function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)});case 5:return e.next=7,z2(t);case 7:case"end":return e.stop()}},e)})),function(e,t){return r.apply(this,arguments)})(t,n);case 4:$2(t)&&W2(t);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function t3(e,t){return n3.apply(this,arguments)}function n3(){return(n3=rB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=zJ(t)).asyncQueue.verifyOperationInProgress(),DJ("RemoteStore","RemoteStore received new credentials"),i=x2(r),r.Gr.add(3),e.next=6,C2(r);case 6:return i&&r.Jr.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.Gr.delete(3),e.next=12,_2(r);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function r3(){return(r3=rB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=zJ(t),!n){e.next=7;break}return r.Gr.delete(2),e.next=5,_2(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.Gr.add(2),e.next=12,C2(r);case 12:r.Jr.set("Unknown");case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function i3(e){return e.Xr||(e.Xr=(t=e.datastore,n=e.asyncQueue,r={Di:R2.bind(null,e),Ni:M2.bind(null,e),br:L2.bind(null,e)},(i=zJ(t)).Or(),new p2(n,i.ir,i.authCredentials,i.appCheckCredentials,i.k,r)),e.zr.push(function(){var t=rB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.Xr.wr(),I2(e)?T2(e):e.Jr.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.Xr.stop();case 6:A2(e);case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.Xr;var t,n,r,i}function a3(e){return e.Zr||(e.Zr=(t=e.datastore,n=e.asyncQueue,r={Di:j2.bind(null,e),Ni:X2.bind(null,e),Nr:Y2.bind(null,e),Cr:J2.bind(null,e)},(i=zJ(t)).Or(),new g2(n,i.ir,i.authCredentials,i.appCheckCredentials,i.k,r)),e.zr.push(function(){var t=rB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.Zr.wr(),t.next=4,z2(e);case 4:t.next=9;break;case 6:return t.next=8,e.Zr.stop();case 8:e.Qr.length>0&&(DJ("RemoteStore","Stopping write stream with ".concat(e.Qr.length," pending writes")),e.Qr=[]);case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.Zr;var t,n,r,i}var o3=function(){function e(t,n,r,i,a){np(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new qJ,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}return ip(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new GJ(HJ.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)})}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}}]),e}();function s3(e,t){if(LJ("AsyncQueue","".concat(t,": ").concat(e)),w0(e))return new GJ(HJ.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var u3=function(){function e(t){np(this,e),this.comparator=t?function(e,n){return t(e,n)||EQ.comparator(e.key,n.key)}:function(e,t){return EQ.comparator(e.key,t.key)},this.keyedMap=d1(),this.sortedSet=new a1(this.comparator)}return ip(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal(function(t,n){return e(t),!1})}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),c3=function(){function e(){np(this,e),this.eo=new a1(EQ.comparator)}return ip(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.eo.get(t);n?0!==e.type&&3===n.type?this.eo=this.eo.insert(t,e):3===e.type&&1!==n.type?this.eo=this.eo.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.eo=this.eo.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.eo=this.eo.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.eo=this.eo.remove(t):1===e.type&&2===n.type?this.eo=this.eo.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.eo=this.eo.insert(t,{type:2,doc:e.doc}):VJ():this.eo=this.eo.insert(t,e)}},{key:"no",value:function(){var e=[];return this.eo.inorderTraversal(function(t,n){e.push(n)}),e}}]),e}(),l3=function(){function e(t,n,r,i,a,o,s,u){np(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=u}return ip(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&yX(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i){var a=[];return n.forEach(function(e){a.push({type:0,doc:e})}),new e(t,n,u3.emptySet(n),a,r,i,!0,!1)}}]),e}(),h3=ip(function e(){np(this,e),this.so=void 0,this.listeners=[]}),f3=ip(function e(){np(this,e),this.queries=new N0(function(e){return mX(e)},yX),this.onlineState="Unknown",this.io=new Set});function d3(e,t){return v3.apply(this,arguments)}function v3(){return(v3=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=zJ(t),i=n.query,a=!1,(o=r.queries.get(i))||(a=!0,o=new h3),!a){e.next=13;break}return e.prev=3,e.next=6,r.onListen(i);case 6:o.so=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),s=s3(e.t0,"Initialization of query '".concat(kX(n.query),"' failed")),e.abrupt("return",void n.onError(s));case 13:r.queries.set(i,o),o.listeners.push(n),n.ro(r.onlineState),o.so&&n.oo(o.so)&&k3(r);case 14:case"end":return e.stop()}},e,null,[[3,9]])}))).apply(this,arguments)}function p3(e,t){return g3.apply(this,arguments)}function g3(){return(g3=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=zJ(t),i=n.query,a=!1,(o=r.queries.get(i))&&(s=o.listeners.indexOf(n))>=0&&(o.listeners.splice(s,1),a=0===o.listeners.length),!a){e.next=6;break}return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function y3(e,t){var n,r=zJ(e),i=!1,a=Xv(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=r.queries.get(o.query);if(s){var u,c=Xv(s.listeners);try{for(c.s();!(u=c.n()).done;){u.value.oo(o)&&(i=!0)}}catch(l){c.e(l)}finally{c.f()}s.so=o}}}catch(l){a.e(l)}finally{a.f()}i&&k3(r)}function m3(e,t,n){var r=zJ(e),i=r.queries.get(t);if(i){var a,o=Xv(i.listeners);try{for(o.s();!(a=o.n()).done;){a.value.onError(n)}}catch(s){o.e(s)}finally{o.f()}}r.queries.delete(t)}function k3(e){e.io.forEach(function(e){e.next()})}var _3=function(){function e(t,n,r){np(this,e),this.query=t,this.co=n,this.ao=!1,this.uo=null,this.onlineState="Unknown",this.options=r||{}}return ip(e,[{key:"oo",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=Xv(e.docChanges);try{for(r.s();!(t=r.n()).done;){var i=t.value;3!==i.type&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}e=new l3(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var a=!1;return this.ao?this.ho(e)&&(this.co.next(e),a=!0):this.lo(e,this.onlineState)&&(this.fo(e),a=!0),this.uo=e,a}},{key:"onError",value:function(e){this.co.error(e)}},{key:"ro",value:function(e){this.onlineState=e;var t=!1;return this.uo&&!this.ao&&this.lo(this.uo,e)&&(this.fo(this.uo),t=!0),t}},{key:"lo",value:function(e,t){return!e.fromCache||!(this.options.wo&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}},{key:"ho",value:function(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.uo&&this.uo.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}},{key:"fo",value:function(e){e=l3.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.ao=!0,this.co.next(e)}}]),e}(),w3=ip(function e(t){np(this,e),this.key=t}),C3=ip(function e(t){np(this,e),this.key=t}),b3=function(){function e(t,n){np(this,e),this.query=t,this.To=n,this.Eo=null,this.current=!1,this.Io=g1(),this.mutatedKeys=g1(),this.Ao=wX(t),this.Ro=new u3(this.Ao)}return ip(e,[{key:"bo",get:function(){return this.To}},{key:"Po",value:function(e,t){var n=this,r=t?t.vo:new c3,i=t?t.Ro:this.Ro,a=t?t.mutatedKeys:this.mutatedKeys,o=i,s=!1,u=lX(this.query)&&i.size===this.query.limit?i.last():null,c=hX(this.query)&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(function(e,t){var l=i.get(e),h=_X(n.query,t)?t:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),v=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),v=!0):n.Vo(l,h)||(r.track({type:2,doc:h}),v=!0,(u&&n.Ao(h,u)>0||c&&n.Ao(h,c)<0)&&(s=!0)):!l&&h?(r.track({type:0,doc:h}),v=!0):l&&!h&&(r.track({type:1,doc:l}),v=!0,(u||c)&&(s=!0)),v&&(h?(o=o.add(h),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))}),lX(this.query)||hX(this.query))for(;o.size>this.query.limit;){var l=lX(this.query)?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Ro:o,vo:r,Bn:s,mutatedKeys:a}}},{key:"Vo",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.Ro;this.Ro=e.Ro,this.mutatedKeys=e.mutatedKeys;var a=e.vo.no();a.sort(function(e,t){return n=e.type,i=t.type,(a=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return VJ()}})(n)-a(i)||r.Ao(e.doc,t.doc);var n,i,a}),this.So(n);var o=t?this.Do():[],s=0===this.Io.size&&this.current?1:0,u=s!==this.Eo;return this.Eo=s,0!==a.length||u?{snapshot:new l3(this.query,e.Ro,i,a,e.mutatedKeys,0===s,u,!1),Co:o}:{Co:o}}},{key:"ro",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ro:this.Ro,vo:new c3,mutatedKeys:this.mutatedKeys,Bn:!1},!1)):{Co:[]}}},{key:"No",value:function(e){return!this.To.has(e)&&!!this.Ro.has(e)&&!this.Ro.get(e).hasLocalMutations}},{key:"So",value:function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t.To=t.To.add(e)}),e.modifiedDocuments.forEach(function(e){}),e.removedDocuments.forEach(function(e){return t.To=t.To.delete(e)}),this.current=e.current)}},{key:"Do",value:function(){var e=this;if(!this.current)return[];var t=this.Io;this.Io=g1(),this.Ro.forEach(function(t){e.No(t.key)&&(e.Io=e.Io.add(t.key))});var n=[];return t.forEach(function(t){e.Io.has(t)||n.push(new C3(t))}),this.Io.forEach(function(e){t.has(e)||n.push(new w3(e))}),n}},{key:"ko",value:function(e){this.To=e.zn,this.Io=g1();var t=this.Po(e.documents);return this.applyChanges(t,!0)}},{key:"xo",value:function(){return l3.fromInitialDocuments(this.query,this.Ro,this.mutatedKeys,0===this.Eo)}}]),e}(),E3=ip(function e(t,n,r){np(this,e),this.query=t,this.targetId=n,this.view=r}),S3=ip(function e(t){np(this,e),this.key=t,this.$o=!1}),P3=function(){function e(t,n,r,i,a,o){np(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Oo={},this.Mo=new N0(function(e){return mX(e)},yX),this.Fo=new Map,this.Lo=new Set,this.Bo=new a1(EQ.comparator),this.Uo=new Map,this.qo=new Y0,this.Ko={},this.jo=new Map,this.Qo=x0.re(),this.onlineState="Unknown",this.Wo=void 0}return ip(e,[{key:"isPrimaryClient",get:function(){return!0===this.Wo}}]),e}();function O3(e,t){return T3.apply(this,arguments)}function T3(){return(T3=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t4(t),!(o=r.Mo.get(n))){e.next=6;break}i=o.targetId,r.sharedClientState.addLocalQueryTarget(i),a=o.view.xo(),e.next=15;break;case 6:return e.next=8,q0(r.localStore,gX(n));case 8:return s=e.sent,u=r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.targetId,e.next=13,I3(r,n,i,"current"===u);case 13:a=e.sent,r.isPrimaryClient&&E2(r.remoteStore,s);case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function I3(e,t,n,r){return x3.apply(this,arguments)}function x3(){return(x3=rB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.Go=function(e,n,r){return(i=rB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.view.Po(r),e.t0=a.Bn,!e.t0){e.next=6;break}return e.next=5,j0(t.localStore,n.query,!1).then(function(e){var t=e.documents;return n.view.Po(t,a)});case 5:a=e.sent;case 6:return o=i&&i.targetChanges.get(n.targetId),s=n.view.applyChanges(a,t.isPrimaryClient,o),e.abrupt("return",(j3(t,n.targetId,s.Co),s.snapshot));case 8:case"end":return e.stop()}},e)})),function(e,t,n,r){return i.apply(this,arguments)})(t,e,n,r);var i},e.next=3,j0(t.localStore,n,!0);case 3:return a=e.sent,o=new b3(n,a.zn),s=o.Po(a.documents),u=_1.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==t.onlineState),c=o.applyChanges(s,t.isPrimaryClient,u),j3(t,r,c.Co),l=new E3(n,r,o),e.abrupt("return",(t.Mo.set(n,l),t.Fo.has(r)?t.Fo.get(r).push(n):t.Fo.set(r,[n]),c.snapshot));case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function A3(e,t){return R3.apply(this,arguments)}function R3(){return(R3=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=zJ(t),i=r.Mo.get(n),!((a=r.Fo.get(i.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r.Fo.set(i.targetId,a.filter(function(e){return!yX(e,n)})),void r.Mo.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),e.t0){e.next=9;break}return e.next=9,$0(r.localStore,i.targetId,!1).then(function(){r.sharedClientState.clearQueryState(i.targetId),S2(r.remoteStore,i.targetId),$3(r,i.targetId)}).catch(A0);case 9:e.next=14;break;case 11:return $3(r,i.targetId),e.next=14,$0(r.localStore,i.targetId,!0);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function N3(){return(N3=rB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n4(t),e.prev=1,e.next=4,function(e,t){var n,r=zJ(e),i=iQ.now(),a=t.reduce(function(e,t){return e.add(t.key)},g1());return r.persistence.runTransaction("Locally write mutations","readwrite",function(e){return r.Wn.vn(e,a).next(function(a){n=a;var o,s=[],u=Xv(t);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=qX(c,n.get(c.key));null!=l&&s.push(new ZX(c.key,l,UQ(l.value.mapValue),VX.exists(!0)))}}catch(h){u.e(h)}finally{u.f()}return r.An.addMutationBatch(e,i,s,t)})}).then(function(e){return e.applyToLocalDocumentSet(n),{batchId:e.batchId,changes:n}})}(i.localStore,n);case 4:return a=e.sent,i.sharedClientState.addPendingMutation(a.batchId),s=i,u=a.batchId,c=r,l=void 0,(l=s.Ko[s.currentUser.toKey()])||(l=new a1(nQ)),l=l.insert(u,c),s.Ko[s.currentUser.toKey()]=l,e.next=9,K3(i,a.changes);case 9:return e.next=11,z2(i.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),o=s3(e.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return e.stop()}var s,u,c,l},e,null,[[1,13]])}))).apply(this,arguments)}function M3(e,t){return D3.apply(this,arguments)}function D3(){return(D3=rB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=zJ(t),e.prev=1,e.next=4,H0(r.localStore,n);case 4:return i=e.sent,n.targetChanges.forEach(function(e,t){var n=r.Uo.get(t);n&&(UJ(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.$o=!0:e.modifiedDocuments.size>0?UJ(n.$o):e.removedDocuments.size>0&&(UJ(n.$o),n.$o=!1))}),e.next=8,K3(r,i,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,A0(e.t0);case 14:case"end":return e.stop()}},e,null,[[1,10]])}))).apply(this,arguments)}function L3(e,t,n){var r=zJ(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Mo.forEach(function(e,n){var r=n.view.ro(t);r.snapshot&&i.push(r.snapshot)}),function(e,t){var n=zJ(e);n.onlineState=t;var r=!1;n.queries.forEach(function(e,n){var i,a=Xv(n.listeners);try{for(a.s();!(i=a.n()).done;){i.value.ro(t)&&(r=!0)}}catch(o){a.e(o)}finally{a.f()}}),r&&k3(n)}(r.eventManager,t),i.length&&r.Oo.br(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function F3(e,t,n){return B3.apply(this,arguments)}function B3(){return(B3=rB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((i=zJ(t)).sharedClientState.updateQueryState(n,"rejected",r),a=i.Uo.get(n),!(o=a&&a.key)){e.next=14;break}return s=(s=new a1(EQ.comparator)).insert(o,zQ.newNoDocument(o,aQ.min())),u=g1().add(o),c=new k1(aQ.min(),new Map,new u1(nQ),s,u),e.next=9,M3(i,c);case 9:i.Bo=i.Bo.remove(o),i.Uo.delete(n),Y3(i),e.next=16;break;case 14:return e.next=16,$0(i.localStore,n,!1).then(function(){return $3(i,n,r)}).catch(A0);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function V3(e,t){return U3.apply(this,arguments)}function U3(){return(U3=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=zJ(t),i=n.batch.batchId,e.prev=1,e.next=4,U0(r.localStore,n);case 4:return a=e.sent,q3(r,i,null),G3(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),e.next=10,K3(r,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,A0(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])}))).apply(this,arguments)}function z3(e,t,n){return H3.apply(this,arguments)}function H3(){return(H3=rB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=zJ(t),e.prev=1,e.next=4,function(e,t){var n=zJ(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var r;return n.An.lookupMutationBatch(e,t).next(function(t){return UJ(null!==t),r=t.keys(),n.An.removeMutationBatch(e,t)}).next(function(){return n.An.performConsistencyCheck(e)}).next(function(){return n.Wn.vn(e,r)})})}(i.localStore,n);case 4:return a=e.sent,q3(i,n,r),G3(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,K3(i,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,A0(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])}))).apply(this,arguments)}function G3(e,t){(e.jo.get(t)||[]).forEach(function(e){e.resolve()}),e.jo.delete(t)}function q3(e,t,n){var r=zJ(e),i=r.Ko[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.Ko[r.currentUser.toKey()]=i}}function $3(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,i=Xv(e.Fo.get(t));try{for(i.s();!(r=i.n()).done;){var a=r.value;e.Mo.delete(a),n&&e.Oo.zo(a,n)}}catch(o){i.e(o)}finally{i.f()}e.Fo.delete(t),e.isPrimaryClient&&e.qo.us(t).forEach(function(t){e.qo.containsKey(t)||W3(e,t)})}function W3(e,t){e.Lo.delete(t.path.canonicalString());var n=e.Bo.get(t);null!==n&&(S2(e.remoteStore,n),e.Bo=e.Bo.remove(t),e.Uo.delete(n),Y3(e))}function j3(e,t,n){var r,i=Xv(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof w3?(e.qo.addReference(a.key,t),Z3(e,a)):a instanceof C3?(DJ("SyncEngine","Document no longer in limbo: "+a.key),e.qo.removeReference(a.key,t),e.qo.containsKey(a.key)||W3(e,a.key)):VJ()}}catch(o){i.e(o)}finally{i.f()}}function Z3(e,t){var n=t.key,r=n.path.canonicalString();e.Bo.get(n)||e.Lo.has(r)||(DJ("SyncEngine","New document in limbo: "+n),e.Lo.add(r),Y3(e))}function Y3(e){for(;e.Lo.size>0&&e.Bo.size<e.maxConcurrentLimboResolutions;){var t=e.Lo.values().next().value;e.Lo.delete(t);var n=new EQ(lQ.fromString(t)),r=e.Qo.next();e.Uo.set(r,new S3(n)),e.Bo=e.Bo.insert(n,r),E2(e.remoteStore,new E0(gX(cX(n.path)),r,2,XJ.I))}}function K3(e,t,n){return J3.apply(this,arguments)}function J3(){return(J3=rB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=zJ(t),a=[],o=[],s=[],e.t0=i.Mo.isEmpty(),e.t0){e.next=9;break}return i.Mo.forEach(function(e,t){s.push(i.Go(t,n,r).then(function(e){if(e){i.isPrimaryClient&&i.sharedClientState.updateQueryState(t.targetId,e.fromCache?"not-current":"current"),a.push(e);var n=D0.$n(t.targetId,e);o.push(n)}}))}),e.next=6,Promise.all(s);case 6:return i.Oo.br(a),e.next=9,(u=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=zJ(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return _0.forEach(n,function(t){return _0.forEach(t.kn,function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)}).next(function(){return _0.forEach(t.xn,function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)})})})});case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),w0(e.t0)){e.next=10;break}throw e.t0;case 10:DJ("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:i=Xv(n);try{for(i.s();!(a=i.n()).done;)o=a.value,s=o.targetId,o.fromCache||(u=r.qn.get(s),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),r.qn=r.qn.insert(s,c))}catch(l){i.e(l)}finally{i.f()}case 13:case"end":return e.stop()}},e,null,[[1,6]])})),function(e,t){return u.apply(this,arguments)})(i.localStore,o);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Q3(e,t){return X3.apply(this,arguments)}function X3(){return(X3=rB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=zJ(t)).currentUser.isEqual(n)){e.next=12;break}return DJ("SyncEngine","User change. New user:",n.toKey()),e.next=5,B0(r.localStore,n);case 5:return i=e.sent,r.currentUser=n,(a=r).jo.forEach(function(e){e.forEach(function(e){e.reject(new GJ(HJ.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),a.jo.clear(),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),e.next=12,K3(r,i.Gn);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function e4(e,t){var n=zJ(e),r=n.Uo.get(t);if(r&&r.$o)return g1().add(r.key);var i=g1(),a=n.Fo.get(t);if(!a)return i;var o,s=Xv(a);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=n.Mo.get(u);i=i.unionWith(c.view.bo)}}catch(l){s.e(l)}finally{s.f()}return i}function t4(e){var t=zJ(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=M3.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=e4.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=F3.bind(null,t),t.Oo.br=y3.bind(null,t.eventManager),t.Oo.zo=m3.bind(null,t.eventManager),t}function n4(e){var t=zJ(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=V3.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=z3.bind(null,t),t}var r4=function(){function e(){np(this,e),this.synchronizeTabs=!1}return ip(e,[{key:"initialize",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.k=f2(e.databaseInfo.databaseId),t.sharedClientState=t.Jo(e),t.persistence=t.Yo(e),n.next=5,t.persistence.start();case 5:t.gcScheduler=t.Xo(e),t.localStore=t.Zo(e);case 7:case"end":return n.stop()}},n)}))()}},{key:"Xo",value:function(e){return null}},{key:"Zo",value:function(e){return function(e,t,n,r){return new F0(e,t,n,r)}(this.persistence,new L0,e.initialUser,this.k)}},{key:"Yo",value:function(e){return new t2(r2.ks,this.k)}},{key:"Jo",value:function(e){return new a2}},{key:"terminate",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.gcScheduler&&e.gcScheduler.stop(),t.next=3,e.sharedClientState.shutdown();case 3:return t.next=5,e.persistence.shutdown();case 5:case"end":return t.stop()}},t)}))()}}]),e}(),i4=function(){function e(){np(this,e)}return ip(e,[{key:"initialize",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=n.localStore,r.t0){r.next=12;break}return n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=function(e){return L3(n.syncEngine,e,1)},n.remoteStore.remoteSyncer.handleCredentialChange=Q3.bind(null,n.syncEngine),r.next=12,function(e,t){return r3.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient);case 12:case"end":return r.stop()}},r)}))()}},{key:"createEventManager",value:function(e){return new f3}},{key:"createDatastore",value:function(e){var t=f2(e.databaseInfo.databaseId),n=new l2(e.databaseInfo);return new y2(e.authCredentials,e.appCheckCredentials,n,t)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return L3(o.syncEngine,e,0)},a=s2.Pt()?new s2:new o2,new k2(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return n=this.localStore,r=this.remoteStore,i=this.eventManager,a=this.sharedClientState,o=e.initialUser,s=e.maxConcurrentLimboResolutions,u=t,c=new P3(n,r,i,a,o,s),u&&(c.Wo=!0),c;var n,r,i,a,o,s,u,c}},{key:"terminate",value:function(){return(e=rB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=zJ(t),DJ("RemoteStore","RemoteStore shutting down."),n.Gr.add(5),e.next=5,C2(n);case 5:n.Hr.shutdown(),n.Jr.set("Unknown");case 7:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}]),e}(),a4=function(){function e(t){np(this,e),this.observer=t,this.muted=!1}return ip(e,[{key:"next",value:function(e){this.observer.next&&this.ec(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.ec(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}},{key:"nc",value:function(){this.muted=!0}},{key:"ec",value:function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)}}]),e}(),o4=function(){function e(t,n,r,i){var a=this;np(this,e);var o,s=this;this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=AJ.UNAUTHENTICATED,this.clientId=tQ.A(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,(o=rB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return DJ("FirestoreClient","Received user=",t.uid),e.next=3,s.authCredentialListener(t);case 3:s.user=t;case 4:case"end":return e.stop()}},e)})),function(e){return o.apply(this,arguments)})),this.appCheckCredentials.start(r,function(e){return DJ("FirestoreClient","Received new app check token=",e),a.appCheckCredentialListener(e,a.user)})}return ip(e,[{key:"getConfiguration",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100});case 1:case"end":return t.stop()}},t)}))()}},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new GJ(HJ.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new qJ;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e.onlineComponents,!n.t0){n.next=5;break}return n.next=5,e.onlineComponents.terminate();case 5:if(n.t1=e.offlineComponents,!n.t1){n.next=9;break}return n.next=9,e.offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=s3(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}},n,null,[[0,14]])}))),t.promise}}]),e}();function s4(e,t){return u4.apply(this,arguments)}function u4(){return(u4=rB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),DJ("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:i=r.initialUser,t.setCredentialChangeListener(function(){var e=rB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.isEqual(t),e.t0){e.next=5;break}return e.next=4,B0(n.localStore,t);case 4:i=t;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=n;case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function c4(e,t){return l4.apply(this,arguments)}function l4(){return(l4=rB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,h4(t);case 3:return r=e.sent,DJ("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return i=e.sent,e.next=10,n.initialize(r,i);case 10:t.setCredentialChangeListener(function(e){return t3(n.remoteStore,e)}),t.setAppCheckTokenChangeListener(function(e,t){return t3(n.remoteStore,t)}),t.onlineComponents=n;case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function h4(e){return f4.apply(this,arguments)}function f4(){return(f4=rB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.offlineComponents,e.t0){e.next=5;break}return DJ("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,s4(t,new r4);case 5:return e.abrupt("return",t.offlineComponents);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function d4(e){return v4.apply(this,arguments)}function v4(){return(v4=rB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.onlineComponents,e.t0){e.next=5;break}return DJ("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,c4(t,new i4);case 5:return e.abrupt("return",t.onlineComponents);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function p4(e){return g4.apply(this,arguments)}function g4(){return(g4=rB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d4(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=O3.bind(null,n.syncEngine),r.onUnlisten=A3.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var y4=ip(function e(t,n,r,i,a,o,s,u){np(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=u}),m4=function(){function e(t,n){np(this,e),this.projectId=t,this.database=n||"(default)"}return ip(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}]),e}(),k4=new Map;function _4(e,t,n){if(!n)throw new GJ(HJ.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function w4(e){if(!EQ.isDocumentKey(e))throw new GJ(HJ.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function C4(e){if(EQ.isDocumentKey(e))throw new GJ(HJ.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function b4(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=(n=e).constructor?n.constructor.name:null;return t?"a custom ".concat(t," object"):"an object"}var n;return"function"==typeof e?"a function":VJ()}function E4(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new GJ(HJ.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=b4(e);throw new GJ(HJ.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}var S4=function(){function e(t){var n;if(np(this,e),void 0===t.host){if(void 0!==t.ssl)throw new GJ(HJ.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new GJ(HJ.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new GJ(HJ.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}return ip(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),P4=function(){function e(t,n,r){np(this,e),this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new S4({}),this._settingsFrozen=!1,t instanceof m4?this._databaseId=t:(this._app=t,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new GJ(HJ.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new m4(e.options.projectId)}(t))}return ip(e,[{key:"app",get:function(){if(!this._app)throw new GJ(HJ.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new GJ(HJ.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new S4(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new WJ;switch(e.type){case"gapi":var t=e.client;return UJ(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new KJ(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new GJ(HJ.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return e=this,(t=k4.get(e))&&(DJ("ComponentProvider","Removing Datastore"),k4.delete(e),t.terminate()),Promise.resolve();var e,t}}]),e}();var O4=function(){function e(t,n,r){np(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return ip(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new I4(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),T4=function(){function e(t,n,r){np(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return ip(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),I4=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,e,r,cX(i)))._path=i,a.type="collection",a}return ip(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new O4(this.firestore,null,new EQ(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(T4);function x4(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=JB(e),1===arguments.length&&(t=tQ.A()),_4("doc","path",t),e instanceof P4){var a=lQ.fromString.apply(lQ,[t].concat(r));return w4(a),new O4(e,null,new EQ(a))}if(!(e instanceof O4||e instanceof I4))throw new GJ(HJ.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(lQ.fromString.apply(lQ,[t].concat(r)));return w4(o),new O4(e.firestore,e instanceof I4?e.converter:null,new EQ(o))}var A4=function(){function e(){var t=this;np(this,e),this.mc=Promise.resolve(),this.gc=[],this.yc=!1,this.Tc=[],this.Ec=null,this.Ic=!1,this.Ac=!1,this.Rc=[],this.ur=new d2(this,"async_queue_retry"),this.bc=function(){var e=h2();e&&DJ("AsyncQueue","Visibility state changed to "+e.visibilityState),t.ur.er()};var n=h2();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.bc)}return ip(e,[{key:"isShuttingDown",get:function(){return this.yc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.Pc(),this.vc(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.yc){this.yc=!0,this.Ac=e||!1;var t=h2();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.bc)}}},{key:"enqueue",value:function(e){var t=this;if(this.Pc(),this.yc)return new Promise(function(){});var n=new qJ;return this.vc(function(){return t.yc&&t.Ac?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)}).then(function(){return n.promise})}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget(function(){return t.gc.push(e),t.Vc()})}},{key:"Vc",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0===e.gc.length){t.next=14;break}return t.prev=1,t.next=4,e.gc[0]();case 4:e.gc.shift(),e.ur.reset(),t.next=13;break;case 8:if(t.prev=8,t.t0=t.catch(1),w0(t.t0)){t.next=12;break}throw t.t0;case 12:DJ("AsyncQueue","Operation failed with retryable error: "+t.t0);case 13:e.gc.length>0&&e.ur.Zi(function(){return e.Vc()});case 14:case"end":return t.stop()}},t,null,[[1,8]])}))()}},{key:"vc",value:function(e){var t=this,n=this.mc.then(function(){return t.Ic=!0,e().catch(function(e){throw t.Ec=e,t.Ic=!1,LJ("INTERNAL UNHANDLED ERROR: ",(r=(n=e).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),e;var n,r}).then(function(e){return t.Ic=!1,e})});return this.mc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.Pc(),this.Rc.indexOf(e)>-1&&(t=0);var i=o3.createAndSchedule(this,e,t,n,function(e){return r.Sc(e)});return this.Tc.push(i),i}},{key:"Pc",value:function(){this.Ec&&VJ()}},{key:"verifyOperationInProgress",value:function(){}},{key:"Dc",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.mc,t.next=3,n;case 3:if(n!==e.mc){t.next=0;break}case 4:case"end":return t.stop()}},t)}))()}},{key:"Cc",value:function(e){var t,n=Xv(this.Tc);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"Nc",value:function(e){var t=this;return this.Dc().then(function(){t.Tc.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});var n,r=Xv(t.Tc);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==e&&i.timerId===e)break}}catch(a){r.e(a)}finally{r.f()}return t.Dc()})}},{key:"kc",value:function(e){this.Rc.push(e)}},{key:"Sc",value:function(e){var t=this.Tc.indexOf(e);this.Tc.splice(t,1)}}]),e}();function R4(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,i=["next","error","complete"];r<i.length;r++){var a=i[r];if(a in n&&"function"==typeof n[a])return!0}return!1}(e)}var N4=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,e,r,i)).type="firestore",a._queue=new A4,a._persistenceKey="name"in e?e.name:"[DEFAULT]",a}return ip(n,[{key:"_terminate",value:function(){return this._firestoreClient||D4(this),this._firestoreClient.terminate()}}]),n}(P4);function M4(e){return e._firestoreClient||D4(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function D4(e){var t,n,r,i=e._freezeSettings(),a=(n=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",new y4(e._databaseId,n,e._persistenceKey,(r=i).host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams));e._firestoreClient=new o4(e._authCredentials,e._appCheckCredentials,e._queue,a)}var L4=function(){function e(){np(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new GJ(HJ.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new fQ(n)}return ip(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}(),F4=function(){function e(t){np(this,e),this._byteString=t}return ip(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(vQ.fromBase64String(t))}catch(n){throw new GJ(HJ.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}},{key:"fromUint8Array",value:function(t){return new e(vQ.fromUint8Array(t))}}]),e}(),B4=ip(function e(t){np(this,e),this._methodName=t}),V4=function(){function e(t,n){if(np(this,e),!isFinite(t)||t<-90||t>90)throw new GJ(HJ.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new GJ(HJ.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return ip(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return nQ(this._lat,e._lat)||nQ(this._long,e._long)}}]),e}(),U4=/^__.*__$/,z4=function(){function e(t,n,r){np(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return ip(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new ZX(e,this.data,this.fieldMask,t,this.fieldTransforms):new jX(e,this.data,t,this.fieldTransforms)}}]),e}(),H4=function(){function e(t,n,r){np(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return ip(e,[{key:"toMutation",value:function(e,t){return new ZX(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function G4(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw VJ()}}var q4=function(){function e(t,n,r,i,a,o){np(this,e),this.settings=t,this.databaseId=n,this.k=r,this.ignoreUndefinedProperties=i,void 0===a&&this.xc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}return ip(e,[{key:"path",get:function(){return this.settings.path}},{key:"$c",get:function(){return this.settings.$c}},{key:"Oc",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.k,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"Mc",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Oc({path:n,Fc:!1});return r.Lc(e),r}},{key:"Bc",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Oc({path:n,Fc:!1});return r.xc(),r}},{key:"Uc",value:function(e){return this.Oc({path:void 0,Fc:!0})}},{key:"qc",value:function(e){return r5(e,this.settings.methodName,this.settings.Kc||!1,this.path,this.settings.jc)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})}},{key:"xc",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.Lc(this.path.get(e))}},{key:"Lc",value:function(e){if(0===e.length)throw this.qc("Document fields must not be empty");if(G4(this.$c)&&U4.test(e))throw this.qc('Document fields cannot begin and end with "__"')}}]),e}(),$4=function(){function e(t,n,r){np(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.k=r||f2(t)}return ip(e,[{key:"Qc",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new q4({$c:e,methodName:t,jc:n,path:fQ.emptyPath(),Fc:!1,Kc:r},this.databaseId,this.k,this.ignoreUndefinedProperties)}}]),e}();function W4(e){var t=e._freezeSettings(),n=f2(e._databaseId);return new $4(e._databaseId,!!t.ignoreUndefinedProperties,n)}function j4(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.Qc(a.merge||a.mergeFields?2:0,t,n,i);X4("Data must be an object, but it was:",o,r);var s,u,c=J4(r,o);if(a.merge)s=new dQ(o.fieldMask),u=o.fieldTransforms;else if(a.mergeFields){var l,h=[],f=Xv(a.mergeFields);try{for(f.s();!(l=f.n()).done;){var d=l.value,v=e5(t,d,n);if(!o.contains(v))throw new GJ(HJ.INVALID_ARGUMENT,"Field '".concat(v,"' is specified in your field mask but missing from your input data."));i5(h,v)||h.push(v)}}catch(p){f.e(p)}finally{f.f()}s=new dQ(h),u=o.fieldTransforms.filter(function(e){return s.covers(e.field)})}else s=null,u=o.fieldTransforms;return new z4(new VQ(c),s,u)}var Z4=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.$c)throw e.qc(1===e.$c?"".concat(this._methodName,"() can only appear at the top level of your update data"):"".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(B4),Y4=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"_toFieldTransform",value:function(e){return new FX(e.path,new IX)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(B4);function K4(e,t){if(Q4(e=JB(e)))return X4("Unsupported field value:",t,e),J4(e,t);if(e instanceof B4)return function(e,t){if(!G4(t.$c))throw t.qc("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.qc("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Fc&&4!==t.$c)throw t.qc("Nested arrays are not supported");return function(e,t){var n,r=[],i=0,a=Xv(e);try{for(a.s();!(n=a.n()).done;){var o=K4(n.value,t.Uc(i));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),i++}}catch(s){a.e(s)}finally{a.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=JB(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return function(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!bQ(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?EX(t):bX(e,t)}(t.k,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=iQ.fromDate(e);return{timestampValue:A1(t.k,n)}}if(e instanceof iQ){var r=new iQ(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:A1(t.k,r)}}if(e instanceof V4)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof F4)return{bytesValue:R1(t.k,e._byteString)};if(e instanceof O4){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.qc("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:D1(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.qc("Unsupported field value: ".concat(b4(e)))}(e,t)}function J4(e,t){var n={};return uQ(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):sQ(e,function(e,r){var i=K4(r,t.Mc(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function Q4(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof iQ||e instanceof V4||e instanceof F4||e instanceof O4||e instanceof B4)}function X4(e,t,n){if(!Q4(n)||"object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){var r=b4(n);throw t.qc("an object"===r?e+" a custom object":e+" "+r)}var i}function e5(e,t,n){if((t=JB(t))instanceof L4)return t._internalPath;if("string"==typeof t)return n5(e,t);throw r5("Field path arguments must be of type string or ",e,!1,void 0,n)}var t5=new RegExp("[~\\*/\\[\\]]");function n5(e,t,n){if(t.search(t5)>=0)throw r5("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return zv(L4,Jv(t.split(".")))._internalPath}catch(r){throw r5("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function r5(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";var u="";return(a||o)&&(u+=" (found",a&&(u+=" in field ".concat(r)),o&&(u+=" in document ".concat(i)),u+=")"),new GJ(HJ.INVALID_ARGUMENT,s+e+u)}function i5(e,t){return e.some(function(e){return e.isEqual(t)})}var a5=function(){function e(t,n,r,i,a){np(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return ip(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new O4(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new o5(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(s5("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),o5=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"data",value:function(){return Hv(Kv(n.prototype),"data",this).call(this)}}]),n}(a5);function s5(e,t){return"string"==typeof t?n5(e,t):t instanceof L4?t._internalPath:t._delegate._internalPath}var u5=function(){function e(t,n){np(this,e),this.hasPendingWrites=t,this.fromCache=n}return ip(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),c5=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o,s){var u;return np(this,n),(u=t.call(this,e,r,i,a,s))._firestore=e,u._firestoreImpl=e,u.metadata=o,u}return ip(n,[{key:"exists",value:function(){return Hv(Kv(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new l5(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(s5("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(a5),l5=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Hv(Kv(n.prototype),"data",this).call(this,e)}}]),n}(c5),h5=function(){function e(t,n,r,i){np(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new u5(i.hasPendingWrites,i.fromCache),this.query=r}return ip(e,[{key:"docs",get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach(function(r){e.call(t,new l5(n._firestore,n._userDataWriter,r.key,r,new u5(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new GJ(HJ.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map(function(t){return{type:"added",doc:new l5(e._firestore,e._userDataWriter,t.doc.key,t.doc,new u5(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:n++}})}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(function(e){return t||3!==e.type}).map(function(t){var n=new l5(e._firestore,e._userDataWriter,t.doc.key,t.doc,new u5(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:f5(t.type),doc:n,oldIndex:i,newIndex:a}})}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),e}();function f5(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return VJ()}}function d5(e){if(hX(e)&&0===e.explicitOrderBy.length)throw new GJ(HJ.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var v5=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this)).zc=e,a.Hc=r,a.Jc=i,a.type="where",a}return ip(n,[{key:"_apply",value:function(e){var t,n,r,i=W4(e.firestore),a=function(e,t,n,r,i,a,o){var s;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new GJ(HJ.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){g5(o,a);var u,c=[],l=Xv(o);try{for(l.s();!(u=l.n()).done;){var h=u.value;c.push(p5(r,e,h))}}catch(d){l.e(d)}finally{l.f()}s={arrayValue:{values:c}}}else s=p5(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||g5(o,a),s=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return K4(n,e.Qc(r?4:3,t))}(n,"where",o,"in"===a||"not-in"===a);var f=jQ.create(i,a,s);return function(e,t){if(t.V()){var n=dX(e);if(null!==n&&!n.isEqual(t.field))throw new GJ(HJ.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(t.field.toString(),"'"));var r=fX(e);null!==r&&function(e,t,n){if(!n.isEqual(t))throw new GJ(HJ.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}(0,t.field,r)}var i=function(e,t){var n,r=Xv(e.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.indexOf(i.op)>=0)return i.op}}catch(d){r.e(d)}finally{r.f()}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw new GJ(HJ.INVALID_ARGUMENT,i===t.op?"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter."):"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(i.toString(),"' filters."))}(e,f),f}(e._query,0,i,e.firestore._databaseId,this.zc,this.Hc,this.Jc);return new T4(e.firestore,e.converter,(t=e._query,n=a,r=t.filters.concat([n]),new uX(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}(function(){return ip(function e(){np(this,e)})}());function p5(e,t,n){if("string"==typeof(n=JB(n))){if(""===n)throw new GJ(HJ.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!vX(t)&&-1!==n.indexOf("/"))throw new GJ(HJ.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(lQ.fromString(n));if(!EQ.isDocumentKey(r))throw new GJ(HJ.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return RQ(e,new EQ(r))}if(n instanceof O4)return RQ(e,n._key);throw new GJ(HJ.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(b4(n),"."))}function g5(e,t){if(!Array.isArray(e)||0===e.length)throw new GJ(HJ.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new GJ(HJ.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function y5(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var m5=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this)).firestore=e,r}return ip(n,[{key:"convertBytes",value:function(e){return new F4(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new O4(this.firestore,null,t)}}]),n}(function(){function e(){np(this,e)}return ip(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(SQ(e)){case 0:return null;case 1:return e.booleanValue;case 2:return yQ(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(mQ(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw VJ()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return sQ(e.fields,function(e,i){r[e]=n.convertValue(i,t)}),r}},{key:"convertGeoPoint",value:function(e){return new V4(yQ(e.latitude),yQ(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map(function(e){return n.convertValue(e,t)})}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=_Q(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(wQ(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=gQ(e);return new iQ(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=lQ.fromString(e);UJ(n0(n));var r=new m4(n.get(1),n.get(3)),i=new EQ(n.popFirst(5));return r.isEqual(t)||LJ("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),e}());function k5(e,t){return n=M4(e),r=t,i=new qJ,n.asyncQueue.enqueueAndForget(rB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t,n){return N3.apply(this,arguments)},e.next=3,function(e){return d4(e).then(function(e){return e.syncEngine})}(n);case 3:return e.t1=e.sent,e.t2=r,e.t3=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 7:case"end":return e.stop()}},e)}))),i.promise;var n,r,i}function _5(e,t,n){var r=n.docs.get(t._key),i=new m5(e);return new c5(e,i,t._key,r,new u5(n.hasPendingWrites,n.fromCache),t.converter)}function w5(){return new Y4("serverTimestamp")}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];RJ="9.6.6",yV(new QB("firestore",function(e,n){var r=n.options,i=e.getProvider("app").getImmediate(),a=new N4(i,new ZJ(e.getProvider("auth-internal")),new QJ(e.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:t},r),a._setSettings(r),a},"PUBLIC")),EV(xJ,"3.4.4",e),EV(xJ,"3.4.4","esm2017")}();var C5=ip(function e(t){return np(this,e),t}),b5=new sk("angularfire2.firestore-instances");function E5(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new C5(r)}}var S5={provide:ip(function e(){return np(this,e),XH("firestore")}),deps:[[new Dk,b5]]},P5={provide:C5,useFactory:function(e,t){var n=QH("firestore",e,t);return n&&new C5(n)},deps:[[new Dk,b5],lG]},O5=function(){var e=ip(function e(){np(this,e),EV("angularfire",ZH.full,"fst")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ay({type:e}),e.\u0275inj=Pg({providers:[P5,S5]}),e}(),T5=cG(function(e,t){var n=E4(e.firestore,N4),r=x4(e),i=y5(e.converter,t);return k5(n,[j4(W4(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,VX.exists(!1))]).then(function(){return r})},!0),I5=cG(function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=JB(e),_4("collection","path",t),e instanceof P4){var a=lQ.fromString.apply(lQ,[t].concat(r));return C4(a),new I4(e,null,a)}if(!(e instanceof O4||e instanceof I4))throw new GJ(HJ.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(lQ.fromString.apply(lQ,[t].concat(r)));return C4(o),new I4(e.firestore,null,o)},!0),x5=cG(function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=(e=E4(e,P4))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==t&&FJ("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},a),{host:"".concat(t,":").concat(n),ssl:!1})),i.mockUserToken){var o,s;if("string"==typeof i.mockUserToken)o=i.mockUserToken,s=AJ.MOCK_USER;else{o=wB(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var u=i.mockUserToken.sub||i.mockUserToken.user_id;if(!u)throw new GJ(HJ.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");s=new AJ(u)}e._authCredentials=new jJ(new $J(o,s))}},!0),A5=cG(function(e){return k5(E4(e.firestore,N4),[new e1(e._key,VX.none())])},!0),R5=cG(x4,!0),N5=cG(function(e){e=E4(e,O4);var t=E4(e.firestore,N4);return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new qJ;return e.asyncQueue.enqueueAndForget(rB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new a4({next:function(a){t.enqueueAndForget(function(){return p3(e,o)});var s=a.docs.has(n);!s&&a.fromCache?i.reject(new GJ(HJ.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&a.fromCache&&r&&"server"===r.source?i.reject(new GJ(HJ.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new _3(cX(n.path),a,{includeMetadataChanges:!0,wo:!0});return d3(e,o)},i.next=3,p4(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}(M4(t),e._key).then(function(n){return _5(t,e,n)})},!0),M5=cG(function(e){e=E4(e,T4);var t=E4(e.firestore,N4),n=M4(t),r=new m5(t);return d5(e._query),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new qJ;return e.asyncQueue.enqueueAndForget(rB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new a4({next:function(n){t.enqueueAndForget(function(){return p3(e,o)}),n.fromCache&&"server"===r.source?i.reject(new GJ(HJ.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new _3(n,a,{includeMetadataChanges:!0,wo:!0});return d3(e,o)},i.next=3,p4(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}(n,e._query).then(function(n){return new h5(t,r,e,n)})},!0),D5=cG(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CV();return mV(e,"firestore").getImmediate()},!0),L5=cG(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,a,o;e=JB(e);var s={includeMetadataChanges:!1},u=0;"object"!=typeof n[u]||R4(n[u])||(s=n[u],u++);var c,l,h,f={includeMetadataChanges:s.includeMetadataChanges};if(R4(n[u])){var d=n[u];n[u]=null===(i=d.next)||void 0===i?void 0:i.bind(d),n[u+1]=null===(a=d.error)||void 0===a?void 0:a.bind(d),n[u+2]=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}if(e instanceof O4)l=E4(e.firestore,N4),h=cX(e._key.path),c={next:function(t){n[u]&&n[u](_5(l,e,t))},error:n[u+1],complete:n[u+2]};else{var v=E4(e,T4);l=E4(v.firestore,N4),h=v._query;var p=new m5(l);c={next:function(e){n[u]&&n[u](new h5(l,p,v,e))},error:n[u+1],complete:n[u+2]},d5(e._query)}return function(e,t,n,r){var i=new a4(r),a=new _3(t,i,n);return e.asyncQueue.enqueueAndForget(rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=d3,t.next=3,p4(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)}))),function(){i.nc(),e.asyncQueue.enqueueAndForget(rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=p3,t.next=3,p4(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)})))}}(M4(l),h,f,c)},!0),F5=cG(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=o._apply(e)}return e},!0),B5=cG(function(e,t,n){e=E4(e,O4);var r=E4(e.firestore,N4),i=y5(e.converter,t,n);return k5(r,[j4(W4(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,VX.none())])},!0),V5=cG(function(e,t,n){e=E4(e,O4);for(var r,i=E4(e.firestore,N4),a=W4(i),o=arguments.length,s=new Array(o>3?o-3:0),u=3;u<o;u++)s[u-3]=arguments[u];return r="string"==typeof(t=JB(t))||t instanceof L4?function(e,t,n,r,i,a){var o=e.Qc(1,t,n),s=[e5(t,r,n)],u=[i];if(a.length%2!=0)throw new GJ(HJ.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)s.push(e5(t,a[c])),u.push(a[c+1]);for(var l=[],h=VQ.empty(),f=s.length-1;f>=0;--f)if(!i5(l,s[f])){var d=s[f],v=u[f];v=JB(v);var p=o.Bc(d);if(v instanceof Z4)l.push(d);else{var g=K4(v,p);null!=g&&(l.push(d),h.set(d,g))}}var y=new dQ(l);return new H4(h,y,o.fieldTransforms)}(a,"updateDoc",e._key,t,n,s):function(e,t,n,r){var i=e.Qc(1,t,n);X4("Data must be an object, but it was:",i,r);var a=[],o=VQ.empty();sQ(r,function(e,r){var s=n5(t,e,n);r=JB(r);var u=i.Bc(s);if(r instanceof Z4)a.push(s);else{var c=K4(r,u);null!=c&&(a.push(s),o.set(s,c))}});var s=new dQ(a);return new H4(o,s,i.fieldTransforms)}(a,"updateDoc",e._key,t),k5(i,[r.toMutation(e._key,VX.exists(!0))])},!0),U5=cG(function(e,t,n){var r=t,i=s5("where",e);return new v5(i,r,n)},!0),z5=function(){var e=function(){function e(t,n){np(this,e),this.collectionName=t,this.firestore=n,this.collection=I5(n,this.collectionName).withConverter({fromFirestore:function(e){return e.data()},toFirestore:function(e){return e}})}return ip(e,[{key:"create",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,T5(t.collection,Dv({},e));case 2:return n.abrupt("return",n.sent.id);case 3:case"end":return n.stop()}},n)}))()}},{key:"read",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,N5(R5(t.collection,e));case 2:return r=n.sent,n.abrupt("return",r.exists()?cB.of(iB.getNonNullable(r.data())):cB.empty());case 4:case"end":return n.stop()}},n)}))()}},{key:"exists",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.read(e);case 2:return n.abrupt("return",n.sent.isPresent());case 3:case"end":return n.stop()}},n)}))()}},{key:"update",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",V5(R5(n.collection,e),t));case 1:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(e){return A5(R5(this.collection,e))}},{key:"set",value:function(t,n){return aB(e.VERBOSE,{called:this.collectionName+".set",id:t,element:n}),B5(R5(this.collection,t),n)}},{key:"subscribeToChanges",value:function(e,t){return L5(R5(this.collection,e),function(e){t(cB.ofNullable(e.data()))})}},{key:"findWhere",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,M5(t.constructQuery(e));case 2:return n.abrupt("return",n.sent.docs.map(function(e){return{id:e.id,data:e.data()}}));case 3:case"end":return n.stop()}},n)}))()}},{key:"observingWhere",value:function(t,n){var r=this;return L5(this.constructQuery(t),function(t){var i=[],a=[],o=[];t.docChanges().forEach(function(e){var t={id:e.doc.id,data:e.doc.data()};switch(e.type){case"added":i.push(t);break;case"modified":a.push(t);break;case"removed":o.push(t)}}),i.length>0&&(aB(e.VERBOSE,"firebase gave us "+i.length+" NEW "+r.collectionName),n.onDocumentCreated(i)),a.length>0&&(aB(e.VERBOSE,"firebase gave us "+a.length+" MODIFIED "+r.collectionName),n.onDocumentModified(a)),o.length>0&&(aB(e.VERBOSE,"firebase gave us "+o.length+" DELETED "+r.collectionName),n.onDocumentDeleted(o))})}},{key:"constructQuery",value:function(e){var t,n=F5(this.collection),r=Xv(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n=F5(n,U5(i[0],i[1],i[2]))}}catch(a){r.e(a)}finally{r.f()}return iB.getNonNullable(n)}}]),e}();return e.VERBOSE=!1,e}(),H5=function(){function e(){np(this,e)}return ip(e,[{key:"equals",value:function(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&uB(this.get(),e.get())}}],[{key:"success",value:function(e){return new G5(e)}},{key:"failure",value:function(e){return new q5(e)}}]),e}(),G5=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this)).value=e,r}return ip(n,[{key:"isSuccess",value:function(){return!0}},{key:"isFailure",value:function(){return!1}},{key:"get",value:function(){return this.value}},{key:"getReason",value:function(){throw new Error("Cannot get failure reason from a success")}},{key:"getReasonOr",value:function(e){return e}},{key:"toOptional",value:function(){return cB.of(this.value)}},{key:"toString",value:function(){return"MGPFallible.success(".concat(this.value,")")}}]),n}(H5),q5=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this)).reason=e,r}return ip(n,[{key:"isSuccess",value:function(){return!1}},{key:"isFailure",value:function(){return!0}},{key:"get",value:function(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}},{key:"getReason",value:function(){return this.reason}},{key:"getReasonOr",value:function(e){return this.getReason()}},{key:"toOptional",value:function(){return cB.empty()}},{key:"toString",value:function(){return"MGPFallible.failure(".concat(this.reason,")")}}]),n}(H5),$5=function(){function e(t){np(this,e),this.reason=t}return ip(e,[{key:"isFailure",value:function(){return!1===this.isSuccess()}},{key:"isSuccess",value:function(){return null==this.reason}},{key:"getReason",value:function(){if(this.isSuccess())throw new Error("MGPValidation: Cannot extract failure reason from success.");return this.reason}},{key:"toFallible",value:function(e){return this.isSuccess()?H5.success(e):H5.failure(this.getReason())}},{key:"toFailedFallible",value:function(){if(this.isSuccess())throw new Error("MGPValidation: cannot convert into failed fallible.");return H5.failure(this.getReason())}}],[{key:"ofFallible",value:function(t){return t.isSuccess()?e.SUCCESS:e.failure(t.getReason())}},{key:"failure",value:function(t){return new e(t)}}]),e}();$5.SUCCESS=new $5(null);var W5=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){return np(this,n),t.call(this,"errors",e)}return ip(n,[{key:"findErrors",value:function(e,t,n,r){return this.findWhere(void 0===r?[["component","==",e],["route","==",t],["message","==",n]]:[["component","==",e],["route","==",t],["message","==",n],["data","==",r]])}}]),n}(z5);return e.\u0275fac=function(t){return new(t||e)(Ok(C5))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),j5=function(){var e=function(){function e(t,n){np(this,e),this.errorDAO=t,this.router=n,e.setSingletonInstance(this)}return ip(e,[{key:"logError",value:function(e,t,n){var r=this;return rB(regeneratorRuntime.mark(function i(){var a,o,s,u,c;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=r.router.url,i.next=3,r.errorDAO.findErrors(e,a,t,n);case 3:if(0!==(o=i.sent).length){i.next=11;break}return s={component:e,route:a,message:t,firstEncounter:w5(),lastEncounter:w5(),occurences:1},null!=n&&(s.data=n),i.next=9,r.errorDAO.create(s);case 9:i.next=14;break;case 11:return u=o[0].id,c=o[0].data,i.next=14,r.errorDAO.update(u,{lastEncounter:w5(),occurences:c.occurences+1});case 14:case"end":return i.stop()}},i)}))()}}],[{key:"setSingletonInstance",value:function(t){e.singleton=cB.of(t)}},{key:"logError",value:function(e,t,n){if(this.singleton.isAbsent())throw new Error("".concat(e,": ").concat(t," (extra data: ").concat(n,")"));return this.singleton.get().logError(e,t,n),$5.failure(e+": "+t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(W5),Ok(WM))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Z5(e,t){if(!1===e)throw j5.logError("Assertion failure",t),new Error("Assertion failure: ".concat(t))}var Y5=ip(function e(t){np(this,e),this.value=t});Y5.HARD_DRAW=new Y5(0),Y5.RESIGN=new Y5(1),Y5.ESCAPE=new Y5(2),Y5.VICTORY=new Y5(3),Y5.TIMEOUT=new Y5(4),Y5.UNACHIEVED=new Y5(5),Y5.AGREED_DRAW_BY_ZERO=new Y5(6),Y5.AGREED_DRAW_BY_ONE=new Y5(7);var K5=function(){function e(t,n){np(this,e),this.id=t,this.data=n}return ip(e,[{key:"getTurn",value:function(){return this.data.turn}},{key:"isHardDraw",value:function(){return this.data.result===Y5.HARD_DRAW.value}},{key:"isAgreedDraw",value:function(){return this.data.result===Y5.AGREED_DRAW_BY_ZERO.value||this.data.result===Y5.AGREED_DRAW_BY_ONE.value}},{key:"getDrawAccepter",value:function(){return this.data.result===Y5.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(Z5(this.data.result===Y5.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),iB.getNonNullable(this.data.playerOne))}},{key:"isWin",value:function(){return this.data.result===Y5.VICTORY.value}},{key:"isTimeout",value:function(){return this.data.result===Y5.TIMEOUT.value}},{key:"isResign",value:function(){return this.data.result===Y5.RESIGN.value}},{key:"getWinner",value:function(){return cB.ofNullable(this.data.winner)}},{key:"getLoser",value:function(){return cB.ofNullable(this.data.loser)}},{key:"setWinnerAndLoser",value:function(t,n){return new e(this.id,Dv(Dv({},this.data),{},{winner:t,loser:n}))}}]),e}(),J5=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),r=t.call(this,"parties",e),aB(n.VERBOSE,"PartDAO.constructor"),r}return ip(n,[{key:"updateAndBumpIndex",value:function(e,t,n,r){var i=this;return rB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(r=Dv(Dv({},r),{},{lastUpdate:{index:n+1,player:t.value}}),i.update(e,r)));case 1:case"end":return a.stop()}},a)}))()}},{key:"observeActiveParts",value:function(e){return this.observingWhere([["result","==",Y5.UNACHIEVED.value]],e)}},{key:"userHasActivePart",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.findWhere([["playerZero","==",e],["result","==",Y5.UNACHIEVED.value]]);case 2:return r=n.sent,n.next=5,t.findWhere([["playerOne","==",e],["result","==",Y5.UNACHIEVED.value]]);case 5:return i=n.sent,n.abrupt("return",r.length>0||i.length>0);case 7:case"end":return n.stop()}},n)}))()}}]),n}(z5);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Ok(C5))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Q5=function(){function e(){np(this,e)}return ip(e,null,[{key:"mapBiArray",value:function(e,t){for(var n=[],r=0;r<e.length;){n[r]=[];for(var i=0;i<e[r].length;)n[r][i]=t(e[r][i]),i++;r++}return n}},{key:"createTable",value:function(e,t,n){for(var r=[],i=t-1;i>=0;){r[i]=[];for(var a=e-1;a>=0;)r[i][a]=n,a--;i--}return r}},{key:"copyBiArray",value:function(t){for(var n=[],r=0;r<t.length;)n[r]=e.copyImmutableArray(t[r]),r++;return n}},{key:"copyImmutableArray",value:function(e){for(var t=[],n=0;n<e.length;)t[n]=e[n],n++;return t}},{key:"sortByDescending",value:function(e,t){e.sort(function(e,n){var r=t(e),i=t(n);return r<i?1:r>i?-1:0})}},{key:"compareArray",value:function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!1===uB(e[n],t[n]))return!1;return!0}},{key:"compareTable",value:function(t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!1===e.compareArray(t[r],n[r]))return!1;return!0}}]),e}(),X5=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),r=t.call(this,"chats",e),aB(n.VERBOSE,"ChatDAO.constructor"),r}return ip(n)}(z5);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Ok(C5))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),e6=function(){var n=ip(function e(){np(this,e)});return n.CANNOT_SEND_MESSAGE=function(){return $localize(e||(e=Nv(["You're not allowed to send a message here."])))},n.FORBIDDEN_MESSAGE=function(){return $localize(t||(t=Nv(["This message is forbidden."])))},n}(),t6=function(){var e=function(){function e(t){np(this,e),this.chatDAO=t,this.followedChatId=cB.empty(),aB(e.VERBOSE,"ChatService.constructor")}return ip(e,[{key:"startObserving",value:function(t,n){if(aB(e.VERBOSE,"ChatService.startObserving "+t),!this.followedChatId.isAbsent())throw this.followedChatId.equalsValue(t)?new Error("WTF :: Already observing chat '".concat(t,"'")):new Error("Cannot ask to watch '".concat(t,"' while watching '").concat(this.followedChatId.get(),"'"));aB(e.VERBOSE,"[start watching chat "+t),this.followedChatId=cB.of(t),this.followedChatUnsubscribe=this.chatDAO.subscribeToChanges(t,n)}},{key:"stopObserving",value:function(){if(!this.isObserving())throw new Error("ChatService.stopObserving should not be called if not observing");aB(e.VERBOSE,"stopped watching chat "+this.followedChatId+"]"),this.followedChatId=cB.empty(),this.followedChatUnsubscribe()}},{key:"isObserving",value:function(){return this.followedChatId.isPresent()}},{key:"deleteChat",value:function(t){var n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(aB(e.VERBOSE,"ChatService.deleteChat "+t),n.chatDAO.delete(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"createNewChat",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.chatDAO.set(e,{messages:[]}));case 1:case"end":return n.stop()}},n)}))()}},{key:"sendMessage",value:function(e,t,n){var r=this;return rB(regeneratorRuntime.mark(function i(){var a,o,s,u;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!r.followedChatId.isAbsent()){i.next=2;break}return i.abrupt("return",$5.failure("Cannot send message if not observing chat"));case 2:if(a=r.followedChatId.get(),!1!==r.userCanSendMessage(e,a)){i.next=5;break}return i.abrupt("return",$5.failure(e6.CANNOT_SEND_MESSAGE()));case 5:if(!r.isForbiddenMessage(t)){i.next=7;break}return i.abrupt("return",$5.failure(e6.FORBIDDEN_MESSAGE()));case 7:return i.next=9,r.chatDAO.read(a);case 9:return o=i.sent.get(),s=Q5.copyImmutableArray(o.messages),u={content:t,sender:e,postedTime:Date.now(),currentTurn:n},s.push(u),i.next=15,r.chatDAO.update(a,{messages:s});case 15:return i.abrupt("return",$5.SUCCESS);case 16:case"end":return i.stop()}},i)}))()}},{key:"userCanSendMessage",value:function(e,t){return""!==e}},{key:"isForbiddenMessage",value:function(e){return""===e}},{key:"ngOnDestroy",value:function(){this.isObserving()&&this.stopObserving()}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Ok(X5))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),n6=ip(function e(t,n,r){np(this,e),this.onDocumentCreated=t,this.onDocumentModified=n,this.onDocumentDeleted=r}),r6=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),r=t.call(this,n.COLLECTION_NAME,e),aB(n.VERBOSE,"JoueursDAO.constructor"),r}return ip(n,[{key:"usernameIsAvailable",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.findWhere([["username","==",e]]);case 2:return n.t0=n.sent.length,n.abrupt("return",0===n.t0);case 4:case"end":return n.stop()}},n)}))()}},{key:"setUsername",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.update(e,{username:t});case 2:case"end":return r.stop()}},r)}))()}},{key:"markVerified",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.update(e,{verified:!0});case 2:case"end":return n.stop()}},n)}))()}},{key:"observeUserByUsername",value:function(e,t){return this.observingWhere([["username","==",e],["verified","==",!0]],t)}},{key:"observeActiveUsers",value:function(e){return this.observingWhere([["state","==","online"],["verified","==",!0]],e)}}]),n}(z5);return e.VERBOSE=!1,e.COLLECTION_NAME="joueurs",e.\u0275fac=function(t){return new(t||e)(Ok(C5))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),i6=function(){var e=function(){function e(t){np(this,e),this.userDAO=t,this.activeUsersBS=new eR([]),this.activeUsersObs=this.activeUsersBS.asObservable()}return ip(e,[{key:"startObserving",value:function(){var t=this;aB(e.VERBOSE,"ActiveUsersService.startObservingActiveUsers");var n=new n6(function(n){var r;aB(e.VERBOSE,"our DAO gave us "+n.length+" new user(s)");var i=(r=t.activeUsersBS.value).concat.apply(r,Jv(n));t.activeUsersBS.next(t.sort(i))},function(n){var r=t.activeUsersBS.value;aB(e.VERBOSE,"our DAO updated "+n.length+" user(s)");var i,a=Xv(n);try{var o=function(){var e=i.value;r.forEach(function(t){t.id===e.id&&(t.data=e.data)}),r=t.sort(r)};for(a.s();!(i=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}t.activeUsersBS.next(r)},function(e){var n=t.activeUsersBS.value.filter(function(t){return!e.some(function(e){return e.id===t.id})});t.activeUsersBS.next(t.sort(n))});this.unsubscribe=this.userDAO.observeActiveUsers(n)}},{key:"stopObserving",value:function(){this.unsubscribe(),this.activeUsersBS.next([])}},{key:"sort",value:function(e){return e.sort(function(e,t){return iB.getNonNullable(iB.getNonNullable(e.data).last_changed).seconds-iB.getNonNullable(iB.getNonNullable(t.data).last_changed).seconds})}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Ok(r6))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),a6=function(){var e=function(){function e(t,n){np(this,e),this.activeUsersService=t,this.joueursDAO=n}return ip(e,[{key:"getActiveUsersObs",value:function(){return this.activeUsersService.startObserving(),this.activeUsersService.activeUsersObs}},{key:"unSubFromActiveUsersObs",value:function(){this.activeUsersService.stopObserving()}},{key:"observeUserByUsername",value:function(e,t){return this.joueursDAO.observeUserByUsername(e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(i6),Ok(r6))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),o6=function(e){qv(n,e);var t=Wv(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:GH;return np(this,n),(e=t.call(this))._bufferSize=r,e._windowTime=i,e._timestampProvider=a,e._buffer=[],e._infiniteTimeWindow=!0,e._infiniteTimeWindow=i===1/0,e._bufferSize=Math.max(1,r),e._windowTime=Math.max(1,i),e}return ip(n,[{key:"next",value:function(e){var t=this.isStopped,r=this._buffer,i=this._infiniteTimeWindow,a=this._timestampProvider,o=this._windowTime;t||(r.push(e),!i&&r.push(a.now()+o)),this._trimBuffer(),Hv(Kv(n.prototype),"next",this).call(this,e)}},{key:"_subscribe",value:function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t}},{key:"_trimBuffer",value:function(){var e=this._bufferSize,t=this._timestampProvider,n=this._buffer,r=this._infiniteTimeWindow,i=(r?1:2)*e;if(e<1/0&&i<n.length&&n.splice(0,n.length-i),!r){for(var a=t.now(),o=0,s=1;s<n.length&&n[s]<=a;s+=2)o=s;o&&n.splice(0,o+1)}}}]),n}(Rp),s6="@firebase/database",u6="",c6=function(){function e(t){np(this,e),this.domStorage_=t,this.prefix_="firebase:"}return ip(e,[{key:"set",value:function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),MB(t))}},{key:"get",value:function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:NB(t)}},{key:"remove",value:function(e){this.domStorage_.removeItem(this.prefixedName_(e))}},{key:"prefixedName_",value:function(e){return this.prefix_+e}},{key:"toString",value:function(){return this.domStorage_.toString()}}]),e}(),l6=function(){function e(){np(this,e),this.cache_={},this.isInMemoryStorage=!0}return ip(e,[{key:"set",value:function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}},{key:"get",value:function(e){return LB(this.cache_,e)?this.cache_[e]:null}},{key:"remove",value:function(e){delete this.cache_[e]}}]),e}(),h6=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new c6(t)}}catch(n){}return new l6},f6=h6("localStorage"),d6=h6("sessionStorage"),v6=new uV("@firebase/database"),p6=function(){var e=1;return function(){return e++}}(),g6=function(e){var t=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,lB(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new $B;n.update(t);var r=n.digest();return dB.encodeByteArray(r)},y6=function e(){for(var t="",n=0;n<arguments.length;n++){var r=n<0||arguments.length<=n?void 0:arguments[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=e.apply(null,r):t+="object"==typeof r?MB(r):r,t+=" "}return t},m6=null,k6=!0,_6=function(){if(!0===k6&&(k6=!1,null===m6&&!0===d6.get("logging_enabled")&&(lB(!0,"Can't turn on custom loggers persistently."),v6.logLevel=rV.VERBOSE,m6=v6.log.bind(v6))),m6){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=y6.apply(null,t);m6(r)}},w6=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];_6.apply(void 0,[e].concat(n))}},C6=function(){var e="FIREBASE INTERNAL ERROR: "+y6.apply(void 0,arguments);v6.error(e)},b6=function(){var e="FIREBASE FATAL ERROR: ".concat(y6.apply(void 0,arguments));throw v6.error(e),new Error(e)},E6=function(){var e="FIREBASE WARNING: "+y6.apply(void 0,arguments);v6.warn(e)},S6=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},P6="[MIN_NAME]",O6="[MAX_NAME]",T6=function(e,t){if(e===t)return 0;if(e===P6||t===O6)return-1;if(t===P6||e===O6)return 1;var n=L6(e),r=L6(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},I6=function(e,t){return e===t?0:e<t?-1:1},x6=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+MB(t))},A6=function e(t){if("object"!=typeof t||null===t)return MB(t);var n=[];for(var r in t)n.push(r);n.sort();for(var i="{",a=0;a<n.length;a++)0!==a&&(i+=","),i+=MB(n[a]),i+=":",i+=e(t[n[a]]);return i+="}"},R6=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)r.push(e.substring(i,i+t>n?n:i+t));return r};function N6(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var M6=function(e){lB(!S6(e),"Invalid JSON number");var t,n,r,i,a,o=1023;0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,1-o)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),o))+o,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));var s=[];for(a=52;a;a-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(t?1:0),s.reverse();var u=s.join(""),c="";for(a=0;a<64;a+=8){var l=parseInt(u.substr(a,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()},D6=new RegExp("^-?(0*)\\d{1,10}$"),L6=function(e){if(D6.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},F6=function(e){try{e()}catch(t){setTimeout(function(){throw E6("Exception was thrown by user callback.",t.stack||""),t},Math.floor(0))}},B6=function(e,t){var n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n},V6=function(){function e(t,n){var r=this;np(this,e),this.appName_=t,this.appCheckProvider=n,this.appCheck=null==n?void 0:n.getImmediate({optional:!0}),this.appCheck||null==n||n.get().then(function(e){return r.appCheck=e})}return ip(e,[{key:"getToken",value:function(e){var t=this;return this.appCheck?this.appCheck.getToken(e):new Promise(function(n,r){setTimeout(function(){t.appCheck?t.getToken(e).then(n,r):n(null)},0)})}},{key:"addTokenChangeListener",value:function(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(function(t){return t.addTokenListener(e)})}},{key:"notifyForInvalidToken",value:function(){E6('Provided AppCheck credentials for the app named "'.concat(this.appName_,'" are invalid. This usually indicates your app was not initialized correctly.'))}}]),e}(),U6=function(){function e(t,n,r){var i=this;np(this,e),this.appName_=t,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(function(e){return i.auth_=e})}return ip(e,[{key:"getToken",value:function(e){var t=this;return this.auth_?this.auth_.getToken(e).catch(function(e){return e&&"auth/token-not-initialized"===e.code?(_6("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)}):new Promise(function(n,r){setTimeout(function(){t.auth_?t.getToken(e).then(n,r):n(null)},0)})}},{key:"addTokenChangeListener",value:function(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(function(t){return t.addAuthTokenListener(e)})}},{key:"removeTokenChangeListener",value:function(e){this.authProvider_.get().then(function(t){return t.removeAuthTokenListener(e)})}},{key:"notifyForInvalidToken",value:function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',E6(e)}}]),e}(),z6=function(){var e=function(){function e(t){np(this,e),this.accessToken=t}return ip(e,[{key:"getToken",value:function(e){return Promise.resolve({accessToken:this.accessToken})}},{key:"addTokenChangeListener",value:function(e){e(this.accessToken)}},{key:"removeTokenChangeListener",value:function(e){}},{key:"notifyForInvalidToken",value:function(){}}]),e}();return e.OWNER="owner",e}(),H6=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,G6="long_polling",q6=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];np(this,e),this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=f6.get("host:"+t)||this._host}return ip(e,[{key:"isCacheableHost",value:function(){return"s-"===this.internalHost.substr(0,2)}},{key:"isCustomHost",value:function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}},{key:"host",get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&f6.set("host:"+this._host,this.internalHost))}},{key:"toString",value:function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}},{key:"toURLString",value:function(){return"".concat(this.secure?"https://":"http://").concat(this.host,"/").concat(this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"")}}]),e}();function $6(e,t,n){var r;if(lB("string"==typeof t,"typeof type must == string"),lB("object"==typeof n,"typeof params must == object"),"websocket"===t)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==G6)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);var i=[];return N6(n,function(e,t){i.push(e+"="+t)}),r+i.join("&")}var W6=function(){function e(){np(this,e),this.counters_={}}return ip(e,[{key:"incrementCounter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;LB(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}},{key:"get",value:function(){return yB(this.counters_)}}]),e}(),j6={},Z6={};function Y6(e){var t=e.toString();return j6[t]||(j6[t]=new W6),j6[t]}var K6=function(){function e(t){np(this,e),this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return ip(e,[{key:"closeAfter",value:function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}},{key:"handleResponse",value:function(e,t){var n=this,r=function(){var e=n.pendingResponses[n.currentResponseNum];delete n.pendingResponses[n.currentResponseNum];for(var t=function(t){e[t]&&F6(function(){n.onMessage_(e[t])})},r=0;r<e.length;++r)t(r);if(n.currentResponseNum===n.closeAfterResponse)return n.onClose&&(n.onClose(),n.onClose=null),"break";n.currentResponseNum++};for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){if("break"===r())break}}}]),e}(),J6=function(){function e(t,n,r,i,a,o,s){var u=this;np(this,e),this.connId=t,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.transportSessionId=o,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=w6(t),this.stats_=Y6(n),this.urlFn=function(e){return u.appCheckToken&&(e.ac=u.appCheckToken),$6(n,G6,e)}}return ip(e,[{key:"open",value:function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new K6(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null},Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{var t=!1,n=function n(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(function(){if(!n.isClosed_){n.scriptTagHolder=new Q6(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],a=t[1],o=t[2];t[3],t[4];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,"start"===i)n.id=a,n.password=o;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);a?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(a,function(){n.onClosed_()})):n.onClosed_()}},function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],a=t[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,a)},function(){n.onClosed_()},n.urlFn);var e={start:"t"};e.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=n.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",n.transportSessionId&&(e.s=n.transportSessionId),n.lastSessionId&&(e.ls=n.lastSessionId),n.applicationId&&(e.p=n.applicationId),n.appCheckToken&&(e.ac=n.appCheckToken),"undefined"!=typeof location&&location.hostname&&H6.test(location.hostname)&&(e.r="f");var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,function(){})}})}},{key:"start",value:function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}},{key:"markConnectionHealthy",value:function(){}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}},{key:"send",value:function(e){var t=MB(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=vB(t),r=R6(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}},{key:"addDisconnectPingFrame",value:function(e,t){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},{key:"incrementIncomingBytes_",value:function(e){var t=MB(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}],[{key:"forceAllow",value:function(){e.forceAllow_=!0}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){return!(!e.forceAllow_&&(e.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}}]),e}(),Q6=function(){function e(t,n,r,i){np(this,e),this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,this.uniqueCallbackIdentifier=p6(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(a='<script>document.domain="'+document.domain+'";<\/script>');var o="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(s){_6("frame writing exception"),s.stack&&_6(s.stack),_6(s)}}return ip(e,[{key:"close",value:function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)},Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())}},{key:"startLongPoll",value:function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}},{key:"newRequest_",value:function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}},{key:"enqueueSegment",value:function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}},{key:"addLongPollTag_",value:function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,function(){clearTimeout(i),r()})}},{key:"addTag",value:function(e,t){var n=this;setTimeout(function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;(!e||"loaded"===e||"complete"===e)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){_6("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}},Math.floor(1))}}],[{key:"createIFrame_",value:function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||_6("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}}]),e}(),X6=null;"undefined"!=typeof MozWebSocket?X6=MozWebSocket:"undefined"!=typeof WebSocket&&(X6=WebSocket);var e8=function(){var e=function(){function e(t,n,r,i,a,o,s){np(this,e),this.connId=t,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=w6(this.connId),this.stats_=Y6(n),this.connURL=e.connectionURL_(n,o,s,i),this.nodeAdmin=n.nodeAdmin}return ip(e,[{key:"open",value:function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,f6.set("previous_websocket_failure",!0);try{this.mySock=new X6(this.connURL,[],{headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}})}catch(i){this.log_("Error instantiating WebSocket.");var r=i.message||i.data;return r&&this.log_(r),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}}},{key:"start",value:function(){}},{key:"markConnectionHealthy",value:function(){f6.remove("previous_websocket_failure")}},{key:"appendFrame_",value:function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=NB(t);this.onMessage(n)}}},{key:"handleNewFrameCount_",value:function(e){this.totalFrames=e,this.frames=[]}},{key:"extractFrameCount_",value:function(e){if(lB(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}},{key:"handleIncomingFrame",value:function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}}},{key:"send",value:function(e){this.resetKeepAlive();var t=MB(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=R6(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}},{key:"resetKeepAlive",value:function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()},Math.floor(45e3))}},{key:"sendString_",value:function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}],[{key:"connectionURL_",value:function(e,t,n,r){var i={v:"5"};return"undefined"!=typeof location&&location.hostname&&H6.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i.ac=r),$6(e,"websocket",i)}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==X6&&!e.forceDisallow_}},{key:"previouslyFailed",value:function(){return f6.isInMemoryStorage||!0===f6.get("previous_websocket_failure")}}]),e}();return e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e}(),t8=function(){function e(t){np(this,e),this.initTransports_(t)}return ip(e,[{key:"initTransports_",value:function(t){var n=e8&&e8.isAvailable(),r=n&&!e8.previouslyFailed();if(t.webSocketOnly&&(n||E6("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[e8];else{var i,a=this.transports_=[],o=Xv(e.ALL_TRANSPORTS);try{for(o.s();!(i=o.n()).done;){var s=i.value;s&&s.isAvailable()&&a.push(s)}}catch(u){o.e(u)}finally{o.f()}}}},{key:"initialTransport",value:function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}},{key:"upgradeTransport",value:function(){return this.transports_.length>1?this.transports_[1]:null}}],[{key:"ALL_TRANSPORTS",get:function(){return[J6,e8]}}]),e}(),n8=function(){function e(t,n,r,i,a,o,s,u,c,l){np(this,e),this.id=t,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=o,this.onReady_=s,this.onDisconnect_=u,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=w6("c:"+this.id+":"),this.transportManager_=new t8(n),this.log_("Connection created"),this.start_()}return ip(e,[{key:"start_",value:function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){e.conn_&&e.conn_.open(n,r)},Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=B6(function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))},Math.floor(i)))}},{key:"nextTransportId_",value:function(){return"c:"+this.id+":"+this.connectionCount++}},{key:"disconnReceiver_",value:function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}}},{key:"connReceiver_",value:function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}}},{key:"sendRequest",value:function(e){this.sendData_({t:"d",d:e})}},{key:"tryCleanupConnection",value:function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}},{key:"onSecondaryControl_",value:function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}},{key:"onSecondaryMessageReceived_",value:function(e){var t=x6("t",e),n=x6("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}},{key:"upgradeIfSecondaryHealthy_",value:function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}},{key:"proceedWithUpgrade_",value:function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}},{key:"onPrimaryMessageReceived_",value:function(e){var t=x6("t",e),n=x6("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}},{key:"onDataMessage_",value:function(e){this.onPrimaryResponse_(),this.onMessage_(e)}},{key:"onPrimaryResponse_",value:function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}},{key:"onControl_",value:function(e){var t=x6("t",e);if("d"in e){var n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?C6("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):C6("Unknown control packet command: "+t)}}},{key:"onHandshake_",value:function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&E6("Protocol version mismatch detected"),this.tryStartUpgrade_())}},{key:"tryStartUpgrade_",value:function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}},{key:"startUpgrade_",value:function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),B6(function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())},Math.floor(6e4))}},{key:"onReset_",value:function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}},{key:"onConnectionEstablished_",value:function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):B6(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}},{key:"sendPingOnPrimaryIfNecessary_",value:function(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}},{key:"onSecondaryConnectionLost_",value:function(){var e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}},{key:"onConnectionLost_",value:function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(f6.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}},{key:"onConnectionShutdown_",value:function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}},{key:"sendData_",value:function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}},{key:"close",value:function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}},{key:"closeConnections_",value:function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}]),e}(),r8=function(){function e(){np(this,e)}return ip(e,[{key:"put",value:function(e,t,n,r){}},{key:"merge",value:function(e,t,n,r){}},{key:"refreshAuthToken",value:function(e){}},{key:"refreshAppCheckToken",value:function(e){}},{key:"onDisconnectPut",value:function(e,t,n){}},{key:"onDisconnectMerge",value:function(e,t,n){}},{key:"onDisconnectCancel",value:function(e,t){}},{key:"reportStats",value:function(e){}}]),e}(),i8=function(){function e(t){np(this,e),this.allowedEvents_=t,this.listeners_={},lB(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return ip(e,[{key:"trigger",value:function(e){if(Array.isArray(this.listeners_[e])){for(var t=Jv(this.listeners_[e]),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var a=0;a<t.length;a++)t[a].callback.apply(t[a].context,r)}}},{key:"on",value:function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)}},{key:"off",value:function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)}},{key:"validateEventType_",value:function(e){lB(this.allowedEvents_.find(function(t){return t===e}),"Unknown event: "+e)}}]),e}(),a8=function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.call(this,["online"])).online_=!0,"undefined"!=typeof window&&void 0!==window.addEventListener&&!bB()&&(window.addEventListener("online",function(){e.online_||(e.online_=!0,e.trigger("online",!0))},!1),window.addEventListener("offline",function(){e.online_&&(e.online_=!1,e.trigger("online",!1))},!1)),e}return ip(n,[{key:"getInitialEvent",value:function(e){return lB("online"===e,"Unknown event type: "+e),[this.online_]}},{key:"currentlyOnline",value:function(){return this.online_}}],[{key:"getInstance",value:function(){return new n}}]),n}(i8),o8=function(){function e(t,n){if(np(this,e),void 0===n){this.pieces_=t.split("/");for(var r=0,i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=n}return ip(e,[{key:"toString",value:function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}]),e}();function s8(){return new o8("")}function u8(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function c8(e){return e.pieces_.length-e.pieceNum_}function l8(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new o8(e.pieces_,t)}function h8(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function f8(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function d8(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new o8(t,0)}function v8(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof o8)for(var i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else for(var a=t.split("/"),o=0;o<a.length;o++)a[o].length>0&&n.push(a[o]);return new o8(n,0)}function p8(e){return e.pieceNum_>=e.pieces_.length}function g8(e,t){var n=u8(e),r=u8(t);if(null===n)return t;if(n===r)return g8(l8(e),l8(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function y8(e,t){for(var n=f8(e,0),r=f8(t,0),i=0;i<n.length&&i<r.length;i++){var a=T6(n[i],r[i]);if(0!==a)return a}return n.length===r.length?0:n.length<r.length?-1:1}function m8(e,t){if(c8(e)!==c8(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function k8(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(c8(e)>c8(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var _8=ip(function e(t,n){np(this,e),this.errorPrefix_=n,this.parts_=f8(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var r=0;r<this.parts_.length;r++)this.byteLength_+=YB(this.parts_[r]);w8(this)});function w8(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+C8(e))}function C8(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}var b8,E8,S8=function(e){qv(n,e);var t=Wv(n);function n(){var e,r,i;return np(this,n),e=t.call(this,["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(i="visibilitychange",r="hidden"):void 0!==document.mozHidden?(i="mozvisibilitychange",r="mozHidden"):void 0!==document.msHidden?(i="msvisibilitychange",r="msHidden"):void 0!==document.webkitHidden&&(i="webkitvisibilitychange",r="webkitHidden")),e.visible_=!0,i&&document.addEventListener(i,function(){var t=!document[r];t!==e.visible_&&(e.visible_=t,e.trigger("visible",t))},!1),e}return ip(n,[{key:"getInitialEvent",value:function(e){return lB("visible"===e,"Unknown event type: "+e),[this.visible_]}}],[{key:"getInstance",value:function(){return new n}}]),n}(i8),P8=1e3,O8=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o,s,u,c){var l;if(np(this,n),(l=t.call(this)).repoInfo_=e,l.applicationId_=r,l.onDataUpdate_=i,l.onConnectStatus_=a,l.onServerInfoUpdate_=o,l.authTokenProvider_=s,l.appCheckTokenProvider_=u,l.authOverride_=c,l.id=n.nextPersistentConnectionId_++,l.log_=w6("p:"+l.id+":"),l.interruptReasons_={},l.listens=new Map,l.outstandingPuts_=[],l.outstandingGets_=[],l.outstandingPutCount_=0,l.outstandingGetCount_=0,l.onDisconnectRequestQueue_=[],l.connected_=!1,l.reconnectDelay_=P8,l.maxReconnectDelay_=3e5,l.securityDebugCallback_=null,l.lastSessionId=null,l.establishConnectionTimer_=null,l.visible_=!1,l.requestCBHash_={},l.requestNumber_=0,l.realtime_=null,l.authToken_=null,l.appCheckToken_=null,l.forceTokenRefresh_=!1,l.invalidAuthTokenCount_=0,l.invalidAppCheckTokenCount_=0,l.firstConnection_=!0,l.lastConnectionAttemptTime_=null,l.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return S8.getInstance().on("visible",l.onVisible_,Zv(l)),-1===e.host.indexOf("fblocal")&&a8.getInstance().on("online",l.onOnline_,Zv(l)),jv(l)}return ip(n,[{key:"sendRequest",value:function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(MB(i)),lB(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}},{key:"get",value:function(e){var t=this;this.initConnection_();var n=new _B,r={p:e._path.toString(),q:e._queryObject},i={action:"g",request:r,onComplete:function(e){var i=e.d;"ok"===e.s?(t.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var a=this.outstandingGets_.length-1;return this.connected_||setTimeout(function(){var e=t.outstandingGets_[a];void 0===e||i!==e||(delete t.outstandingGets_[a],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),t.log_("get "+a+" timed out on connection"),n.reject(new Error("Client is offline.")))},3e3),this.connected_&&this.sendGet_(a),n.promise}},{key:"listen",value:function(e,t,n,r){this.initConnection_();var i=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),lB(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),lB(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(a).set(i,o),this.connected_&&this.sendListen_(o)}},{key:"sendGet_",value:function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}},{key:"sendListen_",value:function(e){var t=this,r=e.query,i=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+i+" for "+a);var o={p:i};e.tag&&(o.q=r._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest("q",o,function(o){var s=o.d,u=o.s;n.warnOnListenWarnings_(s,r),(t.listens.get(i)&&t.listens.get(i).get(a))===e&&(t.log_("listen response",o),"ok"!==u&&t.removeListen_(i,a),e.onComplete&&e.onComplete(u,s))})}},{key:"refreshAuthToken",value:function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(e)}},{key:"reduceReconnectDelayIfAdminCredential_",value:function(e){(e&&40===e.length||function(e){var t=DB(e).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}},{key:"refreshAppCheckToken",value:function(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},function(){})}},{key:"tryAuth",value:function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,n=function(e){var t=DB(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,function(n){var r=n.s,i=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))})}}},{key:"tryAppCheck",value:function(){var e=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},function(t){var n=t.s,r=t.d||"error";"ok"===n?e.invalidAppCheckTokenCount_=0:e.onAppCheckRevoked_(n,r)})}},{key:"unlisten",value:function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),lB(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}},{key:"sendUnlisten_",value:function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}},{key:"onDisconnectPut",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}},{key:"onDisconnectMerge",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}},{key:"onDisconnectCancel",value:function(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}},{key:"sendOnDisconnect_",value:function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,function(e){r&&setTimeout(function(){r(e.s,e.d)},Math.floor(0))})}},{key:"put",value:function(e,t,n,r){this.putInternal("p",e,t,n,r)}},{key:"merge",value:function(e,t,n,r){this.putInternal("m",e,t,n,r)}},{key:"putInternal",value:function(e,t,n,r,i){this.initConnection_();var a={p:t,d:n};void 0!==i&&(a.h=i),this.outstandingPuts_.push({action:e,request:a,onComplete:r}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+t)}},{key:"sendPut_",value:function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)})}},{key:"reportStats",value:function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,function(e){"ok"!==e.s&&t.log_("reportStats","Error sending stats: "+e.d)})}}},{key:"onDataMessage_",value:function(e){if("r"in e){this.log_("from server: "+MB(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}},{key:"onDataPush_",value:function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):C6("Unrecognized action received from server: "+MB(e)+"\nAre you using the latest client?")}},{key:"onReady_",value:function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}},{key:"scheduleConnect_",value:function(e){var t=this;lB(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){t.establishConnectionTimer_=null,t.establishConnection_()},Math.floor(e))}},{key:"initConnection_",value:function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}},{key:"onVisible_",value:function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=P8,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}},{key:"onOnline_",value:function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=P8,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}},{key:"onRealtimeDisconnect_",value:function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=P8),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}},{key:"establishConnection_",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var r,i,a,o,s,u,c,l,h,f,d,v,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.shouldReconnect_()){t.next=21;break}return e.log_("Making a connection attempt"),e.lastConnectionAttemptTime_=(new Date).getTime(),e.lastConnectionEstablishedTime_=null,r=e.onDataMessage_.bind(e),i=e.onReady_.bind(e),a=e.onRealtimeDisconnect_.bind(e),o=e.id+":"+n.nextConnectionId_++,s=e.lastSessionId,u=!1,c=null,l=function(){c?c.close():(u=!0,a())},e.realtime_={close:l,sendRequest:function(e){lB(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(e)}},h=e.forceTokenRefresh_,e.forceTokenRefresh_=!1,t.prev=8,t.next=11,Promise.all([e.authTokenProvider_.getToken(h),e.appCheckTokenProvider_.getToken(h)]);case 11:f=t.sent,d=Fv(f,2),v=d[0],p=d[1],u?_6("getToken() completed but was canceled"):(_6("getToken() completed. Creating connection."),e.authToken_=v&&v.accessToken,e.appCheckToken_=p&&p.token,c=new n8(o,e.repoInfo_,e.applicationId_,e.appCheckToken_,e.authToken_,r,i,a,function(t){E6(t+" ("+e.repoInfo_.toString()+")"),e.interrupt("server_kill")},s)),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(8),e.log_("Failed to get token: "+t.t0),u||(e.repoInfo_.nodeAdmin&&E6(t.t0),l());case 21:case"end":return t.stop()}},t,null,[[8,18]])}))()}},{key:"interrupt",value:function(e){_6("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}},{key:"resume",value:function(e){_6("Resuming connection for reason: "+e),delete this.interruptReasons_[e],BB(this.interruptReasons_)&&(this.reconnectDelay_=P8,this.realtime_||this.scheduleConnect_(0))}},{key:"handleTimestamp_",value:function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}},{key:"cancelSentTransactions_",value:function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}},{key:"onListenRevoked_",value:function(e,t){var n;n=t?t.map(function(e){return A6(e)}).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}},{key:"removeListen_",value:function(e,t){var n,r=new o8(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n}},{key:"onAuthRevoked_",value:function(e,t){_6("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===e||"permission_denied"===e)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}},{key:"onAppCheckRevoked_",value:function(e,t){_6("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===e||"permission_denied"===e)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}},{key:"onSecurityDebugPacket_",value:function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}},{key:"restoreState_",value:function(){this.tryAuth(),this.tryAppCheck();var e,t=Xv(this.listens.values());try{for(t.s();!(e=t.n()).done;){var n,r=Xv(e.value.values());try{for(r.s();!(n=r.n()).done;){var i=n.value;this.sendListen_(i)}}catch(u){r.e(u)}finally{r.f()}}}catch(u){t.e(u)}finally{t.f()}for(var a=0;a<this.outstandingPuts_.length;a++)this.outstandingPuts_[a]&&this.sendPut_(a);for(;this.onDisconnectRequestQueue_.length;){var o=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(o.action,o.pathString,o.data,o.onComplete)}for(var s=0;s<this.outstandingGets_.length;s++)this.outstandingGets_[s]&&this.sendGet_(s)}},{key:"sendConnectStats_",value:function(){var e={};e["sdk.js."+u6.replace(/\./g,"-")]=1,bB()?e["framework.cordova"]=1:SB()&&(e["framework.reactnative"]=1),this.reportStats(e)}},{key:"shouldReconnect_",value:function(){var e=a8.getInstance().currentlyOnline();return BB(this.interruptReasons_)&&e}}],[{key:"warnOnListenWarnings_",value:function(e,t){if(e&&"object"==typeof e&&LB(e,"w")){var n=FB(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();E6("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ".concat(r," at ").concat(i," to your security rules for better performance."))}}}}]),n}(r8);return e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(),T8=function(){function e(t,n){np(this,e),this.name=t,this.node=n}return ip(e,null,[{key:"Wrap",value:function(t,n){return new e(t,n)}}]),e}(),I8=function(){function e(){np(this,e)}return ip(e,[{key:"getCompare",value:function(){return this.compare.bind(this)}},{key:"indexedValueChanged",value:function(e,t){var n=new T8(P6,e),r=new T8(P6,t);return 0!==this.compare(n,r)}},{key:"minPost",value:function(){return T8.MIN}}]),e}(),x8=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"compare",value:function(e,t){return T6(e.name,t.name)}},{key:"isDefinedOn",value:function(e){throw hB("KeyIndex.isDefinedOn not expected to be called.")}},{key:"indexedValueChanged",value:function(e,t){return!1}},{key:"minPost",value:function(){return T8.MIN}},{key:"maxPost",value:function(){return new T8(O6,b8)}},{key:"makePost",value:function(e,t){return lB("string"==typeof e,"KeyIndex indexValue must always be a string."),new T8(e,b8)}},{key:"toString",value:function(){return".key"}}],[{key:"__EMPTY_NODE",get:function(){return b8},set:function(e){b8=e}}]),n}(I8),A8=new x8,R8=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;np(this,e),this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=n?r(t.key,n):1,i&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return ip(e,[{key:"getNext",value:function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}},{key:"hasNext",value:function(){return this.nodeStack_.length>0}},{key:"peek",value:function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}]),e}(),N8=function(){var e=function(){function e(t,n,r,i,a){np(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:M8.EMPTY_NODE,this.right=null!=a?a:M8.EMPTY_NODE}return ip(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"count",value:function(){return this.left.count()+1+this.right.count()}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min_",value:function(){return this.left.isEmpty()?this:this.left.min_()}},{key:"minKey",value:function(){return this.min_().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()}},{key:"removeMin_",value:function(){if(this.left.isEmpty())return M8.EMPTY_NODE;var e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()}},{key:"remove",value:function(e,t){var n,r;if(t(e,(n=this).key)<0)!n.left.isEmpty()&&!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),!n.right.isEmpty()&&!n.right.isRed_()&&!n.right.left.isRed_()&&(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return M8.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}},{key:"isRed_",value:function(){return this.color}},{key:"fixUp_",value:function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}},{key:"moveRedLeft_",value:function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e}},{key:"moveRedRight_",value:function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e}},{key:"rotateLeft_",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight_",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip_",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth_",value:function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1}},{key:"check_",value:function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}]),e}();return e.RED=!0,e.BLACK=!1,e}(),M8=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.EMPTY_NODE;np(this,e),this.comparator_=t,this.root_=n}return ip(e,[{key:"insert",value:function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,N8.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,N8.BLACK,null,null))}},{key:"get",value:function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}},{key:"getPredecessorKey",value:function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}},{key:"isEmpty",value:function(){return this.root_.isEmpty()}},{key:"count",value:function(){return this.root_.count()}},{key:"minKey",value:function(){return this.root_.minKey()}},{key:"maxKey",value:function(){return this.root_.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root_.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.root_.reverseTraversal(e)}},{key:"getIterator",value:function(e){return new R8(this.root_,null,this.comparator_,!1,e)}},{key:"getIteratorFrom",value:function(e,t){return new R8(this.root_,e,this.comparator_,!1,t)}},{key:"getReverseIteratorFrom",value:function(e,t){return new R8(this.root_,e,this.comparator_,!0,t)}},{key:"getReverseIterator",value:function(e){return new R8(this.root_,null,this.comparator_,!0,e)}}]),e}();function D8(e,t){return T6(e.name,t.name)}function L8(e,t){return T6(e,t)}M8.EMPTY_NODE=new(function(){function e(){np(this,e)}return ip(e,[{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new N8(e,t,null)}},{key:"remove",value:function(e,t){return this}},{key:"count",value:function(){return 0}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"check_",value:function(){return 0}},{key:"isRed_",value:function(){return!1}}]),e}());var F8,B8,V8,U8,z8,H8=function(e){return"number"==typeof e?"number:"+M6(e):"string:"+e},G8=function(e){if(e.isLeafNode()){var t=e.val();lB("string"==typeof t||"number"==typeof t||"object"==typeof t&&LB(t,".sv"),"Priority must be a string or number.")}else lB(e===E8||e.isEmpty(),"priority of unexpected type.");lB(e===E8||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},q8=function(){var e=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.__childrenNodeConstructor.EMPTY_NODE;np(this,e),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,lB(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),G8(this.priorityNode_)}return ip(e,[{key:"isLeafNode",value:function(){return!0}},{key:"getPriority",value:function(){return this.priorityNode_}},{key:"updatePriority",value:function(t){return new e(this.value_,t)}},{key:"getImmediateChild",value:function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"getChild",value:function(t){return p8(t)?this:".priority"===u8(t)?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"hasChild",value:function(){return!1}},{key:"getPredecessorChildName",value:function(e,t){return null}},{key:"updateImmediateChild",value:function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)}},{key:"updateChild",value:function(t,n){var r=u8(t);return null===r?n:n.isEmpty()&&".priority"!==r?this:(lB(".priority"!==r||1===c8(t),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(l8(t),n)))}},{key:"isEmpty",value:function(){return!1}},{key:"numChildren",value:function(){return 0}},{key:"forEachChild",value:function(e,t){return!1}},{key:"val",value:function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+H8(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?M6(this.value_):this.value_,this.lazyHash_=g6(e)}return this.lazyHash_}},{key:"getValue",value:function(){return this.value_}},{key:"compareTo",value:function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(lB(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}},{key:"compareToLeafNode_",value:function(t){var n=typeof t.value_,r=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(n),a=e.VALUE_TYPE_ORDER.indexOf(r);return lB(i>=0,"Unknown leaf type: "+n),lB(a>=0,"Unknown leaf type: "+r),i===a?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:a-i}},{key:"withIndex",value:function(){return this}},{key:"isIndexed",value:function(){return!0}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}],[{key:"__childrenNodeConstructor",get:function(){return F8},set:function(e){F8=e}}]),e}();return e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}(),$8=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"compare",value:function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?T6(e.name,t.name):i}},{key:"isDefinedOn",value:function(e){return!e.getPriority().isEmpty()}},{key:"indexedValueChanged",value:function(e,t){return!e.getPriority().equals(t.getPriority())}},{key:"minPost",value:function(){return T8.MIN}},{key:"maxPost",value:function(){return new T8(O6,new q8("[PRIORITY-POST]",V8))}},{key:"makePost",value:function(e,t){var n=B8(e);return new T8(t,new q8("[PRIORITY-POST]",n))}},{key:"toString",value:function(){return".priority"}}]),n}(I8)),W8=Math.log(2),j8=function(){function e(t){var n=this;np(this,e),this.count=parseInt(Math.log(t+1)/W8,10),this.current_=this.count-1;var r=parseInt(Array(n.count+1).join("1"),2);this.bits_=t+1&r}return ip(e,[{key:"nextBitIsOne",value:function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e}}]),e}(),Z8=function(e,t,n,r){e.sort(t);var i=function t(r,i){var a,o,s=i-r;if(0===s)return null;if(1===s)return a=e[r],o=n?n(a):a,new N8(o,a.node,N8.BLACK,null,null);var u=parseInt(s/2,10)+r,c=t(r,u),l=t(u+1,i);return a=e[u],o=n?n(a):a,new N8(o,a.node,N8.BLACK,c,l)},a=function(t){for(var r=null,a=null,o=e.length,s=function(t,r){var a=o-t,s=o;o-=t;var c=i(a+1,s),l=e[a],h=n?n(l):l;u(new N8(h,l.node,r,null,c))},u=function(e){r?(r.left=e,r=e):(a=e,r=e)},c=0;c<t.count;++c){var l=t.nextBitIsOne(),h=Math.pow(2,t.count-(c+1));l?s(h,N8.BLACK):(s(h,N8.BLACK),s(h,N8.RED))}return a}(new j8(e.length));return new M8(r||t,a)},Y8={},K8=function(){function e(t,n){np(this,e),this.indexes_=t,this.indexSet_=n}return ip(e,[{key:"get",value:function(e){var t=FB(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof M8?t:null}},{key:"hasIndex",value:function(e){return LB(this.indexSet_,e.toString())}},{key:"addIndex",value:function(t,n){lB(t!==A8,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],a=!1,o=n.getIterator(T8.Wrap),s=o.getNext();s;)a=a||t.isDefinedOn(s.node),i.push(s),s=o.getNext();r=a?Z8(i,t.getCompare()):Y8;var u=t.toString(),c=Object.assign({},this.indexSet_);c[u]=t;var l=Object.assign({},this.indexes_);return l[u]=r,new e(l,c)}},{key:"addToIndexes",value:function(t,n){var r=this;return new e(VB(this.indexes_,function(e,i){var a=FB(r.indexSet_,i);if(lB(a,"Missing index implementation for "+i),e===Y8){if(a.isDefinedOn(t.node)){for(var o=[],s=n.getIterator(T8.Wrap),u=s.getNext();u;)u.name!==t.name&&o.push(u),u=s.getNext();return o.push(t),Z8(o,a.getCompare())}return Y8}var c=n.get(t.name),l=e;return c&&(l=l.remove(new T8(t.name,c))),l.insert(t,t.node)}),this.indexSet_)}},{key:"removeFromIndexes",value:function(t,n){return new e(VB(this.indexes_,function(e){if(e===Y8)return e;var r=n.get(t.name);return r?e.remove(new T8(t.name,r)):e}),this.indexSet_)}}],[{key:"Default",get:function(){return lB(Y8&&$8,"ChildrenNode.ts has not been loaded"),U8=U8||new e({".priority":Y8},{".priority":$8})}}]),e}(),J8=function(){var e=function(){function e(t,n,r){np(this,e),this.children_=t,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&G8(this.priorityNode_),this.children_.isEmpty()&&lB(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return ip(e,[{key:"isLeafNode",value:function(){return!1}},{key:"getPriority",value:function(){return this.priorityNode_||z8}},{key:"updatePriority",value:function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)}},{key:"getImmediateChild",value:function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?z8:t}},{key:"getChild",value:function(e){var t=u8(e);return null===t?this:this.getImmediateChild(t).getChild(l8(e))}},{key:"hasChild",value:function(e){return null!==this.children_.get(e)}},{key:"updateImmediateChild",value:function(t,n){if(lB(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r,i,a=new T8(t,n);n.isEmpty()?(r=this.children_.remove(t),i=this.indexMap_.removeFromIndexes(a,this.children_)):(r=this.children_.insert(t,n),i=this.indexMap_.addToIndexes(a,this.children_));var o=r.isEmpty()?z8:this.priorityNode_;return new e(r,o,i)}},{key:"updateChild",value:function(e,t){var n=u8(e);if(null===n)return t;lB(".priority"!==u8(e)||1===c8(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(l8(e),t);return this.updateImmediateChild(n,r)}},{key:"isEmpty",value:function(){return this.children_.isEmpty()}},{key:"numChildren",value:function(){return this.children_.count()}},{key:"val",value:function(t){if(this.isEmpty())return null;var n={},r=0,i=0,a=!0;if(this.forEachChild($8,function(o,s){n[o]=s.val(t),r++,a&&e.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):a=!1}),!t&&a&&i<2*r){var o=[];for(var s in n)o[s]=n[s];return o}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+H8(this.getPriority().val())+":"),this.forEachChild($8,function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)}),this.lazyHash_=""===e?"":g6(e)}return this.lazyHash_}},{key:"getPredecessorChildName",value:function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new T8(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)}},{key:"getFirstChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()}},{key:"getFirstChild",value:function(e){var t=this.getFirstChildName(e);return t?new T8(t,this.children_.get(t)):null}},{key:"getLastChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()}},{key:"getLastChild",value:function(e){var t=this.getLastChildName(e);return t?new T8(t,this.children_.get(t)):null}},{key:"forEachChild",value:function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal(function(e){return t(e.name,e.node)}):this.children_.inorderTraversal(t)}},{key:"getIterator",value:function(e){return this.getIteratorFrom(e.minPost(),e)}},{key:"getIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,function(e){return e});for(var r=this.children_.getIteratorFrom(e.name,T8.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r}},{key:"getReverseIterator",value:function(e){return this.getReverseIteratorFrom(e.maxPost(),e)}},{key:"getReverseIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,function(e){return e});for(var r=this.children_.getReverseIteratorFrom(e.name,T8.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r}},{key:"compareTo",value:function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Q8?-1:0}},{key:"withIndex",value:function(t){if(t===A8||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)}},{key:"isIndexed",value:function(e){return e===A8||this.indexMap_.hasIndex(e)}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator($8),r=t.getIterator($8),i=n.getNext(),a=r.getNext();i&&a;){if(i.name!==a.name||!i.node.equals(a.node))return!1;i=n.getNext(),a=r.getNext()}return null===i&&null===a}return!1}return!1}},{key:"resolveIndex_",value:function(e){return e===A8?null:this.indexMap_.get(e.toString())}}],[{key:"EMPTY_NODE",get:function(){return z8||(z8=new e(new M8(L8),null,K8.Default))}}]),e}();return e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e}(),Q8=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.call(this,new M8(L8),J8.EMPTY_NODE,K8.Default)}return ip(n,[{key:"compareTo",value:function(e){return e===this?0:1}},{key:"equals",value:function(e){return e===this}},{key:"getPriority",value:function(){return this}},{key:"getImmediateChild",value:function(e){return J8.EMPTY_NODE}},{key:"isEmpty",value:function(){return!1}}]),n}(J8));function X8(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return J8.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),lB(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new q8(e,X8(t));if(e instanceof Array){var n=J8.EMPTY_NODE;return N6(e,function(t,r){if(LB(e,t)&&"."!==t.substring(0,1)){var i=X8(r);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(t,i))}}),n.updatePriority(X8(t))}var r=[],i=!1;if(N6(e,function(e,t){if("."!==e.substring(0,1)){var n=X8(t);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new T8(e,n)))}}),0===r.length)return J8.EMPTY_NODE;var a=Z8(r,D8,function(e){return e.name},L8);if(i){var o=Z8(r,$8.getCompare());return new J8(a,X8(t),new K8({".priority":o},{".priority":$8}))}return new J8(a,X8(t),K8.Default)}Object.defineProperties(T8,{MIN:{value:new T8(P6,J8.EMPTY_NODE)},MAX:{value:new T8(O6,Q8)}}),x8.__EMPTY_NODE=J8.EMPTY_NODE,q8.__childrenNodeConstructor=J8,function(e){E8=e}(Q8),function(e){V8=e}(Q8),function(e){B8=e}(X8);var e7=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this)).indexPath_=e,lB(!p8(e)&&".priority"!==u8(e),"Can't create PathIndex with empty path or .priority key"),r}return ip(n,[{key:"extractChild",value:function(e){return e.getChild(this.indexPath_)}},{key:"isDefinedOn",value:function(e){return!e.getChild(this.indexPath_).isEmpty()}},{key:"compare",value:function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?T6(e.name,t.name):i}},{key:"makePost",value:function(e,t){var n=X8(e),r=J8.EMPTY_NODE.updateChild(this.indexPath_,n);return new T8(t,r)}},{key:"maxPost",value:function(){var e=J8.EMPTY_NODE.updateChild(this.indexPath_,Q8);return new T8(O6,e)}},{key:"toString",value:function(){return f8(this.indexPath_,0).join("/")}}]),n}(I8),t7=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"compare",value:function(e,t){var n=e.node.compareTo(t.node);return 0===n?T6(e.name,t.name):n}},{key:"isDefinedOn",value:function(e){return!0}},{key:"indexedValueChanged",value:function(e,t){return!e.equals(t)}},{key:"minPost",value:function(){return T8.MIN}},{key:"maxPost",value:function(){return T8.MAX}},{key:"makePost",value:function(e,t){var n=X8(e);return new T8(t,n)}},{key:"toString",value:function(){return".value"}}]),n}(I8));function n7(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}var r7=function(){function e(){np(this,e),this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=$8}return ip(e,[{key:"hasStart",value:function(){return this.startSet_}},{key:"hasStartAfter",value:function(){return this.startAfterSet_}},{key:"hasEndBefore",value:function(){return this.endBeforeSet_}},{key:"isViewFromLeft",value:function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}},{key:"getIndexStartValue",value:function(){return lB(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}},{key:"getIndexStartName",value:function(){return lB(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:P6}},{key:"hasEnd",value:function(){return this.endSet_}},{key:"getIndexEndValue",value:function(){return lB(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}},{key:"getIndexEndName",value:function(){return lB(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:O6}},{key:"hasLimit",value:function(){return this.limitSet_}},{key:"hasAnchoredLimit",value:function(){return this.limitSet_&&""!==this.viewFrom_}},{key:"getLimit",value:function(){return lB(this.limitSet_,"Only valid if limit has been set"),this.limit_}},{key:"getIndex",value:function(){return this.index_}},{key:"loadsAllData",value:function(){return!(this.startSet_||this.endSet_||this.limitSet_)}},{key:"isDefault",value:function(){return this.loadsAllData()&&this.index_===$8}},{key:"copy",value:function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}]),e}();function i7(e){var t,n={};return e.isDefault()||(e.index_===$8?t="$priority":e.index_===t7?t="$value":e.index_===A8?t="$key":(lB(e.index_ instanceof e7,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=MB(t),e.startSet_&&(n.startAt=MB(e.indexStartValue_),e.startNameSet_&&(n.startAt+=","+MB(e.indexStartName_))),e.endSet_&&(n.endAt=MB(e.indexEndValue_),e.endNameSet_&&(n.endAt+=","+MB(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_)),n}function a7(e){var t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;var n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==$8&&(t.i=e.index_.toString()),t}var o7=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a){var o;return np(this,n),(o=t.call(this)).repoInfo_=e,o.onDataUpdate_=r,o.authTokenProvider_=i,o.appCheckTokenProvider_=a,o.log_=w6("p:rest:"),o.listens_={},o}return ip(n,[{key:"reportStats",value:function(e){throw new Error("Method not implemented.")}},{key:"listen",value:function(e,t,r,i){var a=this,o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);var s=n.getListenId_(e,r),u={};this.listens_[s]=u;var c=i7(e._queryParams);this.restRequest_(o+".json",c,function(e,t){var n=t;(404===e&&(n=null,e=null),null===e&&a.onDataUpdate_(o,n,!1,r),FB(a.listens_,s)===u)&&i(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)})}},{key:"unlisten",value:function(e,t){var r=n.getListenId_(e,t);delete this.listens_[r]}},{key:"get",value:function(e){var t=this,n=i7(e._queryParams),r=e._path.toString(),i=new _B;return this.restRequest_(r+".json",n,function(e,n){var a=n;404===e&&(a=null,e=null),null===e?(t.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}},{key:"refreshAuthToken",value:function(e){}},{key:"restRequest_",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(function(i){var a=Fv(i,2),o=a[0],s=a[1];o&&o.accessToken&&(n.auth=o.accessToken),s&&s.token&&(n.ac=s.token);var u=(t.repoInfo_.secure?"https://":"http://")+t.repoInfo_.host+e+"?ns="+t.repoInfo_.namespace+HB(n);t.log_("Sending REST request for "+u);var c=new XMLHttpRequest;c.onreadystatechange=function(){if(r&&4===c.readyState){t.log_("REST Response for "+u+" received. status:",c.status,"response:",c.responseText);var e=null;if(c.status>=200&&c.status<300){try{e=NB(c.responseText)}catch(n){E6("Failed to parse JSON response for "+u+": "+c.responseText)}r(null,e)}else 401!==c.status&&404!==c.status&&E6("Got unsuccessful REST response for "+u+" Status: "+c.status),r(c.status);r=null}},c.open("GET",u,!0),c.send()})}}],[{key:"getListenId_",value:function(e,t){return void 0!==t?"tag$"+t:(lB(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}}]),n}(r8),s7=function(){function e(){np(this,e),this.rootNode_=J8.EMPTY_NODE}return ip(e,[{key:"getNode",value:function(e){return this.rootNode_.getChild(e)}},{key:"updateSnapshot",value:function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}]),e}();function u7(){return{value:null,children:new Map}}function c7(e,t,n){if(p8(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{var r=u8(t);e.children.has(r)||e.children.set(r,u7()),c7(e.children.get(r),t=l8(t),n)}}function l7(e,t){if(p8(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;var n=e.value;return e.value=null,n.forEachChild($8,function(t,n){c7(e,new o8(t),n)}),l7(e,t)}if(e.children.size>0){var r=u8(t);return t=l8(t),e.children.has(r)&&l7(e.children.get(r),t)&&e.children.delete(r),0===e.children.size}return!0}function h7(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(function(e,n){t(n,e)})}(e,function(e,r){h7(r,new o8(t.toString()+"/"+e),n)})}var f7=function(){function e(t){np(this,e),this.collection_=t,this.last_=null}return ip(e,[{key:"get",value:function(){var e=this.collection_.get(),t=Object.assign({},e);return this.last_&&N6(this.last_,function(e,n){t[e]=t[e]-n}),this.last_=e,t}}]),e}(),d7=function(){function e(t,n){np(this,e),this.server_=n,this.statsToReport_={},this.statsListener_=new f7(t);var r=1e4+2e4*Math.random();B6(this.reportStats_.bind(this),Math.floor(r))}return ip(e,[{key:"reportStats_",value:function(){var e=this,t=this.statsListener_.get(),n={},r=!1;N6(t,function(t,i){i>0&&LB(e.statsToReport_,t)&&(n[t]=i,r=!0)}),r&&this.server_.reportStats(n),B6(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}]),e}(),v7=(function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(v7||(v7={})),v7);function p7(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}var g7,y7=function(){function e(t,n,r){np(this,e),this.path=t,this.affectedTree=n,this.revert=r,this.type=v7.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return ip(e,[{key:"operationForChild",value:function(t){if(p8(this.path)){if(null!=this.affectedTree.value)return lB(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new o8(t));return new e(s8(),n,this.revert)}return lB(u8(this.path)===t,"operationForChild called for unrelated child."),new e(l8(this.path),this.affectedTree,this.revert)}}]),e}(),m7=function(){function e(t,n,r){np(this,e),this.source=t,this.path=n,this.snap=r,this.type=v7.OVERWRITE}return ip(e,[{key:"operationForChild",value:function(t){return p8(this.path)?new e(this.source,s8(),this.snap.getImmediateChild(t)):new e(this.source,l8(this.path),this.snap)}}]),e}(),k7=function(){function e(t,n,r){np(this,e),this.source=t,this.path=n,this.children=r,this.type=v7.MERGE}return ip(e,[{key:"operationForChild",value:function(t){if(p8(this.path)){var n=this.children.subtree(new o8(t));return n.isEmpty()?null:n.value?new m7(this.source,s8(),n.value):new e(this.source,s8(),n)}return lB(u8(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,l8(this.path),this.children)}},{key:"toString",value:function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}]),e}(),_7=function(){function e(t,n,r){np(this,e),this.node_=t,this.fullyInitialized_=n,this.filtered_=r}return ip(e,[{key:"isFullyInitialized",value:function(){return this.fullyInitialized_}},{key:"isFiltered",value:function(){return this.filtered_}},{key:"isCompleteForPath",value:function(e){if(p8(e))return this.isFullyInitialized()&&!this.filtered_;var t=u8(e);return this.isCompleteForChild(t)}},{key:"isCompleteForChild",value:function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}},{key:"getNode",value:function(){return this.node_}}]),e}();function w7(e,t,n,r,i,a){var o=r.filter(function(e){return e.type===n});o.sort(function(t,n){return function(e,t,n){if(null==t.childName||null==n.childName)throw hB("Should only compare child_ events.");var r=new T8(t.childName,t.snapshotNode),i=new T8(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n)}),o.forEach(function(n){var r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,a);i.forEach(function(i){i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))})})}function C7(e,t){return{eventCache:e,serverCache:t}}function b7(e,t,n,r){return C7(new _7(t,n,r),e.serverCache)}function E7(e,t,n,r){return C7(e.eventCache,new _7(t,n,r))}function S7(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function P7(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}var O7=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(g7||(g7=new M8(I6)),g7);np(this,e),this.value=t,this.children=n}return ip(e,[{key:"isEmpty",value:function(){return null===this.value&&this.children.isEmpty()}},{key:"findRootMostMatchingPathAndValue",value:function(e,t){if(null!=this.value&&t(this.value))return{path:s8(),value:this.value};if(p8(e))return null;var n=u8(e),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(l8(e),t);return null!=i?{path:v8(new o8(n),i.path),value:i.value}:null}return null}},{key:"findRootMostValueAndPath",value:function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})}},{key:"subtree",value:function(t){if(p8(t))return this;var n=u8(t),r=this.children.get(n);return null!==r?r.subtree(l8(t)):new e(null)}},{key:"set",value:function(t,n){if(p8(t))return new e(n,this.children);var r=u8(t),i=(this.children.get(r)||new e(null)).set(l8(t),n),a=this.children.insert(r,i);return new e(this.value,a)}},{key:"remove",value:function(t){if(p8(t))return this.children.isEmpty()?new e(null):new e(null,this.children);var n=u8(t),r=this.children.get(n);if(r){var i,a=r.remove(l8(t));return i=a.isEmpty()?this.children.remove(n):this.children.insert(n,a),null===this.value&&i.isEmpty()?new e(null):new e(this.value,i)}return this}},{key:"get",value:function(e){if(p8(e))return this.value;var t=u8(e),n=this.children.get(t);return n?n.get(l8(e)):null}},{key:"setTree",value:function(t,n){if(p8(t))return n;var r,i=u8(t),a=(this.children.get(i)||new e(null)).setTree(l8(t),n);return r=a.isEmpty()?this.children.remove(i):this.children.insert(i,a),new e(this.value,r)}},{key:"fold",value:function(e){return this.fold_(s8(),e)}},{key:"fold_",value:function(e,t){var n={};return this.children.inorderTraversal(function(r,i){n[r]=i.fold_(v8(e,r),t)}),t(e,this.value,n)}},{key:"findOnPath",value:function(e,t){return this.findOnPath_(e,s8(),t)}},{key:"findOnPath_",value:function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(p8(e))return null;var i=u8(e),a=this.children.get(i);return a?a.findOnPath_(l8(e),v8(t,i),n):null}},{key:"foreachOnPath",value:function(e,t){return this.foreachOnPath_(e,s8(),t)}},{key:"foreachOnPath_",value:function(t,n,r){if(p8(t))return this;this.value&&r(n,this.value);var i=u8(t),a=this.children.get(i);return a?a.foreachOnPath_(l8(t),v8(n,i),r):new e(null)}},{key:"foreach",value:function(e){this.foreach_(s8(),e)}},{key:"foreach_",value:function(e,t){this.children.inorderTraversal(function(n,r){r.foreach_(v8(e,n),t)}),this.value&&t(e,this.value)}},{key:"foreachChild",value:function(e){this.children.inorderTraversal(function(t,n){n.value&&e(t,n.value)})}}],[{key:"fromObject",value:function(t){var n=new e(null);return N6(t,function(e,t){n=n.set(new o8(e),t)}),n}}]),e}(),T7=function(){function e(t){np(this,e),this.writeTree_=t}return ip(e,null,[{key:"empty",value:function(){return new e(new O7(null))}}]),e}();function I7(e,t,n){if(p8(t))return new T7(new O7(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,a=r.value,o=g8(i,t);return a=a.updateChild(o,n),new T7(e.writeTree_.set(i,a))}var s=new O7(n),u=e.writeTree_.setTree(t,s);return new T7(u)}function x7(e,t,n){var r=e;return N6(n,function(e,n){r=I7(r,v8(t,e),n)}),r}function A7(e,t){if(p8(t))return T7.empty();var n=e.writeTree_.setTree(t,new O7(null));return new T7(n)}function R7(e,t){return null!=N7(e,t)}function N7(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(g8(n.path,t)):null}function M7(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild($8,function(e,n){t.push(new T8(e,n))}):e.writeTree_.children.inorderTraversal(function(e,n){null!=n.value&&t.push(new T8(e,n.value))}),t}function D7(e,t){if(p8(t))return e;var n=N7(e,t);return new T7(null!=n?new O7(n):e.writeTree_.subtree(t))}function L7(e){return e.writeTree_.isEmpty()}function F7(e,t){return B7(s8(),e.writeTree_,t)}function B7(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);var r=null;return t.children.inorderTraversal(function(t,i){".priority"===t?(lB(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=B7(v8(e,t),i,n)}),!n.getChild(e).isEmpty()&&null!==r&&(n=n.updateChild(v8(e,".priority"),r)),n}function V7(e,t){return K7(t,e)}function U7(e,t){if(e.snap)return k8(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&k8(v8(e.path,n),t))return!0;return!1}function z7(e){return e.visible}function H7(e,t,n){for(var r=T7.empty(),i=0;i<e.length;++i){var a=e[i];if(t(a)){var o=a.path,s=void 0;if(a.snap)k8(n,o)?r=I7(r,s=g8(n,o),a.snap):k8(o,n)&&(s=g8(o,n),r=I7(r,s8(),a.snap.getChild(s)));else{if(!a.children)throw hB("WriteRecord should have .snap or .children");if(k8(n,o))r=x7(r,s=g8(n,o),a.children);else if(k8(o,n))if(p8(s=g8(o,n)))r=x7(r,s8(),a.children);else{var u=FB(a.children,u8(s));if(u){var c=u.getChild(l8(s));r=I7(r,s8(),c)}}}}}return r}function G7(e,t,n,r,i){if(r||i){var a=D7(e.visibleWrites,t);return!i&&L7(a)?n:i||null!=n||R7(a,s8())?F7(H7(e.allWrites,function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(k8(e.path,t)||k8(t,e.path))},t),n||J8.EMPTY_NODE):null}var o=N7(e.visibleWrites,t);if(null!=o)return o;var s=D7(e.visibleWrites,t);return L7(s)?n:null!=n||R7(s,s8())?F7(s,n||J8.EMPTY_NODE):null}function q7(e,t,n,r){return G7(e.writeTree,e.treePath,t,n,r)}function $7(e,t){return function(e,t,n){var r=J8.EMPTY_NODE,i=N7(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild($8,function(e,t){r=r.updateImmediateChild(e,t)}),r;if(n){var a=D7(e.visibleWrites,t);return n.forEachChild($8,function(e,t){var n=F7(D7(a,new o8(e)),t);r=r.updateImmediateChild(e,n)}),M7(a).forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}return M7(D7(e.visibleWrites,t)).forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}(e.writeTree,e.treePath,t)}function W7(e,t,n,r){return function(e,t,n,r,i){lB(r||i,"Either existingEventSnap or existingServerSnap must exist");var a=v8(t,n);if(R7(e.visibleWrites,a))return null;var o=D7(e.visibleWrites,a);return L7(o)?i.getChild(n):F7(o,i.getChild(n))}(e.writeTree,e.treePath,t,n,r)}function j7(e,t){return function(e,t){return N7(e.visibleWrites,t)}(e.writeTree,v8(e.treePath,t))}function Z7(e,t,n){return function(e,t,n,r){var i=v8(t,n),a=N7(e.visibleWrites,i);return null!=a?a:r.isCompleteForChild(n)?F7(D7(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function Y7(e,t){return K7(v8(e.treePath,t),e.writeTree)}function K7(e,t){return{treePath:e,writeTree:t}}var J7,Q7,X7=function(){function e(){np(this,e),this.changeMap=new Map}return ip(e,[{key:"trackChildChange",value:function(e){var t=e.type,n=e.childName;lB("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),lB(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,n7(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,function(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,function(e,t){return{type:"child_added",snapshotNode:t,childName:e}}(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw hB("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,n7(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}},{key:"getChanges",value:function(){return Array.from(this.changeMap.values())}}]),e}(),e9=new(function(){function e(){np(this,e)}return ip(e,[{key:"getCompleteChild",value:function(e){return null}},{key:"getChildAfterChild",value:function(e,t,n){return null}}]),e}()),t9=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;np(this,e),this.writes_=t,this.viewCache_=n,this.optCompleteServerCache_=r}return ip(e,[{key:"getCompleteChild",value:function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new _7(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Z7(this.writes_,e,n)}},{key:"getChildAfterChild",value:function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:P7(this.viewCache_),i=function(e,t,n,r,i,a){return function(e,t,n,r,i,a,o){var s,u=D7(e.visibleWrites,t),c=N7(u,s8());if(null!=c)s=c;else{if(null==n)return[];s=F7(u,n)}if((s=s.withIndex(o)).isEmpty()||s.isLeafNode())return[];for(var l=[],h=o.getCompare(),f=a?s.getReverseIteratorFrom(r,o):s.getIteratorFrom(r,o),d=f.getNext();d&&l.length<1;)0!==h(d,r)&&l.push(d),d=f.getNext();return l}(e.writeTree,e.treePath,t,n,0,i,a)}(this.writes_,r,t,0,n,e);return 0===i.length?null:i[0]}}]),e}();function n9(e,t,n,r,i,a){var o,s,u=t.eventCache;if(null!=j7(r,n))return t;if(p8(n))if(lB(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){var c=P7(t),l=$7(r,c instanceof J8?c:J8.EMPTY_NODE);o=e.filter.updateFullNode(t.eventCache.getNode(),l,a)}else{var h=q7(r,P7(t));o=e.filter.updateFullNode(t.eventCache.getNode(),h,a)}else{var f=u8(n);if(".priority"===f){lB(1===c8(n),"Can't have a priority with additional path components");var d=u.getNode(),v=W7(r,n,d,s=t.serverCache.getNode());o=null!=v?e.filter.updatePriority(d,v):u.getNode()}else{var p,g=l8(n);if(u.isCompleteForChild(f)){s=t.serverCache.getNode();var y=W7(r,n,u.getNode(),s);p=null!=y?u.getNode().getImmediateChild(f).updateChild(g,y):u.getNode().getImmediateChild(f)}else p=Z7(r,f,t.serverCache);o=null!=p?e.filter.updateChild(u.getNode(),f,p,g,i,a):u.getNode()}}return b7(t,o,u.isFullyInitialized()||p8(n),e.filter.filtersNodes())}function r9(e,t,n,r,i,a,o,s){var u,c=t.serverCache,l=o?e.filter:e.filter.getIndexedFilter();if(p8(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var h=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),h,null)}else{var f=u8(n);if(!c.isCompleteForPath(n)&&c8(n)>1)return t;var d=l8(n),v=c.getNode().getImmediateChild(f).updateChild(d,r);u=".priority"===f?l.updatePriority(c.getNode(),v):l.updateChild(c.getNode(),f,v,d,e9,null)}var p=E7(t,u,c.isFullyInitialized()||p8(n),l.filtersNodes());return n9(e,p,n,i,new t9(i,p,a),s)}function i9(e,t,n,r,i,a,o){var s,u,c=t.eventCache,l=new t9(i,t,a);if(p8(n))u=e.filter.updateFullNode(t.eventCache.getNode(),r,o),s=b7(t,u,!0,e.filter.filtersNodes());else{var h=u8(n);if(".priority"===h)u=e.filter.updatePriority(t.eventCache.getNode(),r),s=b7(t,u,c.isFullyInitialized(),c.isFiltered());else{var f,d=l8(n),v=c.getNode().getImmediateChild(h);if(p8(d))f=r;else{var p=l.getCompleteChild(h);f=null!=p?".priority"===h8(d)&&p.getChild(d8(d)).isEmpty()?p:p.updateChild(d,r):J8.EMPTY_NODE}s=v.equals(f)?t:b7(t,e.filter.updateChild(c.getNode(),h,f,d,l,o),c.isFullyInitialized(),e.filter.filtersNodes())}}return s}function a9(e,t){return e.eventCache.isCompleteForChild(t)}function o9(e,t,n){return n.foreach(function(e,n){t=t.updateChild(e,n)}),t}function s9(e,t,n,r,i,a,o,s){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var u,c=t;u=p8(n)?r:new O7(null).setTree(n,r);var l=t.serverCache.getNode();return u.children.inorderTraversal(function(n,r){if(l.hasChild(n)){var u=o9(0,t.serverCache.getNode().getImmediateChild(n),r);c=r9(e,c,new o8(n),u,i,a,o,s)}}),u.children.inorderTraversal(function(n,r){var u=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!l.hasChild(n)&&!u){var h=o9(0,t.serverCache.getNode().getImmediateChild(n),r);c=r9(e,c,new o8(n),h,i,a,o,s)}}),c}function u9(e,t){var n=P7(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!p8(t)&&!n.getImmediateChild(u8(t)).isEmpty())?n.getChild(t):null}function c9(e,t,n,r){t.type===v7.MERGE&&null!==t.source.queryId&&(lB(P7(e.viewCache_),"We should always have a full cache before handling merges"),lB(S7(e.viewCache_),"Missing event cache, even though we have a server cache"));var i=e.viewCache_,a=function(e,t,n,r,i){var a,o,s=new X7;if(n.type===v7.OVERWRITE){var u=n;u.source.fromUser?a=i9(e,t,u.path,u.snap,r,i,s):(lB(u.source.fromServer,"Unknown source."),o=u.source.tagged||t.serverCache.isFiltered()&&!p8(u.path),a=r9(e,t,u.path,u.snap,r,i,o,s))}else if(n.type===v7.MERGE){var c=n;c.source.fromUser?a=function(e,t,n,r,i,a,o){var s=t;return r.foreach(function(r,u){var c=v8(n,r);a9(t,u8(c))&&(s=i9(e,s,c,u,i,a,o))}),r.foreach(function(r,u){var c=v8(n,r);a9(t,u8(c))||(s=i9(e,s,c,u,i,a,o))}),s}(e,t,c.path,c.children,r,i,s):(lB(c.source.fromServer,"Unknown source."),o=c.source.tagged||t.serverCache.isFiltered(),a=s9(e,t,c.path,c.children,r,i,o,s))}else if(n.type===v7.ACK_USER_WRITE){var l=n;a=l.revert?function(e,t,n,r,i,a){var o;if(null!=j7(r,n))return t;var s,u=new t9(r,t,i),c=t.eventCache.getNode();if(p8(n)||".priority"===u8(n)){var l;if(t.serverCache.isFullyInitialized())l=q7(r,P7(t));else{var h=t.serverCache.getNode();lB(h instanceof J8,"serverChildren would be complete if leaf node"),l=$7(r,h)}l=l,s=e.filter.updateFullNode(c,l,a)}else{var f=u8(n),d=Z7(r,f,t.serverCache);null==d&&t.serverCache.isCompleteForChild(f)&&(d=c.getImmediateChild(f)),(s=null!=d?e.filter.updateChild(c,f,d,l8(n),u,a):t.eventCache.getNode().hasChild(f)?e.filter.updateChild(c,f,J8.EMPTY_NODE,l8(n),u,a):c).isEmpty()&&t.serverCache.isFullyInitialized()&&((o=q7(r,P7(t))).isLeafNode()&&(s=e.filter.updateFullNode(s,o,a)))}return o=t.serverCache.isFullyInitialized()||null!=j7(r,s8()),b7(t,s,o,e.filter.filtersNodes())}(e,t,l.path,r,i,s):function(e,t,n,r,i,a,o){if(null!=j7(i,n))return t;var s=t.serverCache.isFiltered(),u=t.serverCache;if(null!=r.value){if(p8(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return r9(e,t,n,u.getNode().getChild(n),i,a,s,o);if(p8(n)){var c=new O7(null);return u.getNode().forEachChild(A8,function(e,t){c=c.set(new o8(e),t)}),s9(e,t,n,c,i,a,s,o)}return t}var l=new O7(null);return r.foreach(function(e,t){var r=v8(n,e);u.isCompleteForPath(r)&&(l=l.set(e,u.getNode().getChild(r)))}),s9(e,t,n,l,i,a,s,o)}(e,t,l.path,l.affectedTree,r,i,s)}else{if(n.type!==v7.LISTEN_COMPLETE)throw hB("Unknown operation type: "+n.type);a=function(e,t,n,r,i){var a=t.serverCache;return n9(e,E7(t,a.getNode(),a.isFullyInitialized()||p8(n),a.isFiltered()),n,r,e9,i)}(e,t,n.path,r,s)}var h=s.getChanges();return function(e,t,n){var r=t.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=S7(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&n.push(function(e){return{type:"value",snapshotNode:e}}(S7(t)))}}(t,a,h),{viewCache:a,changes:h}}(e.processor_,i,t,n,r);return function(e,t){lB(t.eventCache.getNode().isIndexed(e.filter.getIndex()),"Event snap not indexed"),lB(t.serverCache.getNode().isIndexed(e.filter.getIndex()),"Server snap not indexed")}(e.processor_,a.viewCache),lB(a.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=a.viewCache,function(e,t,n,r){return function(e,t,n,r){var i=[],a=[];return t.forEach(function(t){"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&a.push(function(e,t){return{type:"child_moved",snapshotNode:t,childName:e}}(t.childName,t.snapshotNode))}),w7(e,i,"child_removed",t,r,n),w7(e,i,"child_added",t,r,n),w7(e,i,"child_moved",a,r,n),w7(e,i,"child_changed",t,r,n),w7(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,e.eventRegistrations_)}(e,a.changes,a.viewCache.eventCache.getNode())}function l9(e,t,n,r){var i=t.source.queryId;if(null!==i){var a=e.views.get(i);return lB(null!=a,"SyncTree gave us an op for an invalid query."),c9(a,t,n,r)}var o,s=[],u=Xv(e.views.values());try{for(u.s();!(o=u.n()).done;){var c=o.value;s=s.concat(c9(c,t,n,r))}}catch(l){u.e(l)}finally{u.f()}return s}function h9(e,t){var n,r=null,i=Xv(e.views.values());try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r||u9(a,t)}}catch(o){i.e(o)}finally{i.f()}return r}var f9=ip(function e(t){np(this,e),this.listenProvider_=t,this.syncPointTree_=new O7(null),this.pendingWriteTree_={visibleWrites:T7.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map});function d9(e,t,n,r,i){return function(e,t,n,r,i){lB(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=I7(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?y9(e,new m7({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function v9(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(function(e,t){var n=e.allWrites.findIndex(function(e){return e.writeId===t});lB(n>=0,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);for(var i=r.visible,a=!1,o=e.allWrites.length-1;i&&o>=0;){var s=e.allWrites[o];s.visible&&(o>=n&&U7(s,r.path)?i=!1:k8(r.path,s.path)&&(a=!0)),o--}return!!i&&(a?(function(e){e.visibleWrites=H7(e.allWrites,z7,s8()),e.lastWriteId=e.allWrites.length>0?e.allWrites[e.allWrites.length-1].writeId:-1}(e),!0):(r.snap?e.visibleWrites=A7(e.visibleWrites,r.path):N6(r.children,function(t){e.visibleWrites=A7(e.visibleWrites,v8(r.path,t))}),!0))}(e.pendingWriteTree_,t)){var i=new O7(null);return null!=r.snap?i=i.set(s8(),!0):N6(r.children,function(e){i=i.set(new o8(e),!0)}),y9(e,new y7(r.path,i,n))}return[]}function p9(e,t,n){return y9(e,new m7({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function g9(e,t,n){var r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,function(e,n){var r=h9(n,g8(e,t));if(r)return r});return G7(r,t,i,n,!0)}function y9(e,t){return m9(t,e.syncPointTree_,null,V7(e.pendingWriteTree_,s8()))}function m9(e,t,n,r){if(p8(e.path))return k9(e,t,n,r);var i=t.get(s8());null==n&&null!=i&&(n=h9(i,s8()));var a=[],o=u8(e.path),s=e.operationForChild(o),u=t.children.get(o);if(u&&s){var c=n?n.getImmediateChild(o):null,l=Y7(r,o);a=a.concat(m9(s,u,c,l))}return i&&(a=a.concat(l9(i,e,r,n))),a}function k9(e,t,n,r){var i=t.get(s8());null==n&&null!=i&&(n=h9(i,s8()));var a=[];return t.children.inorderTraversal(function(t,i){var o=n?n.getImmediateChild(t):null,s=Y7(r,t),u=e.operationForChild(t);u&&(a=a.concat(k9(u,i,o,s)))}),i&&(a=a.concat(l9(i,e,r,n))),a}function _9(e,t){return e.tagToQueryMap.get(t)}function w9(e){var t=e.indexOf("$");return lB(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new o8(e.substr(0,t))}}function C9(e,t,n){var r=e.syncPointTree_.get(t);return lB(r,"Missing sync point for query tag that we're tracking"),l9(r,n,V7(e.pendingWriteTree_,t),null)}var b9=function(){function e(t){np(this,e),this.node_=t}return ip(e,[{key:"getImmediateChild",value:function(t){return new e(this.node_.getImmediateChild(t))}},{key:"node",value:function(){return this.node_}}]),e}(),E9=function(){function e(t,n){np(this,e),this.syncTree_=t,this.path_=n}return ip(e,[{key:"getImmediateChild",value:function(t){var n=v8(this.path_,t);return new e(this.syncTree_,n)}},{key:"node",value:function(){return g9(this.syncTree_,this.path_)}}]),e}(),S9=function(e,t,n){return e&&"object"==typeof e?(lB(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?P9(e[".sv"],t,n):"object"==typeof e[".sv"]?O9(e[".sv"],t):void lB(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},P9=function(e,t,n){switch(e){case"timestamp":return n.timestamp;default:lB(!1,"Unexpected server value: "+e)}},O9=function(e,t,n){e.hasOwnProperty("increment")||lB(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e.increment;"number"!=typeof r&&lB(!1,"Unexpected increment value: "+r);var i=t.node();if(lB(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var a=i.getValue();return"number"!=typeof a?r:a+r},T9=function(e,t,n){return I9(e,new b9(t),n)};function I9(e,t,n){var r,i=e.getPriority().val(),a=S9(i,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var o=e,s=S9(o.getValue(),t,n);return s!==o.getValue()||a!==o.getPriority().val()?new q8(s,X8(a)):e}var u=e;return r=u,a!==u.getPriority().val()&&(r=r.updatePriority(new q8(a))),u.forEachChild($8,function(e,i){var a=I9(i,t.getImmediateChild(e),n);a!==i&&(r=r.updateImmediateChild(e,a))}),r}var x9=ip(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};np(this,e),this.name=t,this.parent=n,this.node=r});function A9(e,t){for(var n=t instanceof o8?t:new o8(t),r=e,i=u8(n);null!==i;){var a=FB(r.node.children,i)||{children:{},childCount:0};r=new x9(i,r,a),i=u8(n=l8(n))}return r}function R9(e){return e.node.value}function N9(e,t){e.node.value=t,B9(e)}function M9(e){return e.node.childCount>0}function D9(e,t){N6(e.node.children,function(n,r){t(new x9(n,e,r))})}function L9(e,t,n,r){n&&!r&&t(e),D9(e,function(e){L9(e,t,!0,r)}),n&&r&&t(e)}function F9(e){return new o8(null===e.parent?e.name:F9(e.parent)+"/"+e.name)}function B9(e){null!==e.parent&&function(e,t,n){var r=function(e){return void 0===R9(e)&&!M9(e)}(n),i=LB(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,B9(e)):!r&&!i&&(e.node.children[t]=n.node,e.node.childCount++,B9(e))}(e.parent,e.name,e)}var V9=/[\[\].#$\/\u0000-\u001F\u007F]/,U9=/[\[\].#$\u0000-\u001F\u007F]/,z9=10485760,H9=function(e){return"string"==typeof e&&0!==e.length&&!V9.test(e)},G9=function(e){return"string"==typeof e&&0!==e.length&&!U9.test(e)},q9=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!S6(e)||e&&"object"==typeof e&&LB(e,".sv")},$9=function(e,t,n,r){r&&void 0===t||W9(ZB(e,"value"),t,n)},W9=function e(t,n,r){var i=r instanceof o8?new _8(r,t):r;if(void 0===n)throw new Error(t+"contains undefined "+C8(i));if("function"==typeof n)throw new Error(t+"contains a function "+C8(i)+" with contents = "+n.toString());if(S6(n))throw new Error(t+"contains "+n.toString()+" "+C8(i));if("string"==typeof n&&n.length>z9/3&&YB(n)>z9)throw new Error(t+"contains a string greater than "+z9+" utf8 bytes "+C8(i)+" ('"+n.substring(0,50)+"...')");if(n&&"object"==typeof n){var a=!1,o=!1;if(N6(n,function(n,r){if(".value"===n)a=!0;else if(".priority"!==n&&".sv"!==n&&(o=!0,!H9(n)))throw new Error(t+" contains an invalid key ("+n+") "+C8(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=YB(t),w8(e)})(i,n),e(t,r,i),function(e){var t=e.parts_.pop();e.byteLength_-=YB(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)}),a&&o)throw new Error(t+' contains ".value" child '+C8(i)+" in addition to actual children.")}},j9=function(e,t,n,r){if(!(r&&void 0===n||G9(n)))throw new Error(ZB(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Z9=function(e,t){if(".info"===u8(t))throw new Error(e+" failed = Can't modify data under /.info/")},Y9=ip(function e(){np(this,e),this.eventLists_=[],this.recursionDepth_=0});function K9(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],a=i.getPath();null!==n&&!m8(a,n.path)&&(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:a}),n.events.push(i)}n&&e.eventLists_.push(n)}function J9(e,t,n){K9(e,n),function(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];i&&(t(i.path)?(Q9(e.eventLists_[r]),e.eventLists_[r]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}(e,function(e){return k8(e,t)||k8(t,e)})}function Q9(e){for(var t=0;t<e.events.length;t++){var n=e.events[t];if(null!==n){e.events[t]=null;var r=n.getEventRunner();m6&&_6("event: "+n.toString()),F6(r)}}}var X9=function(){function e(t,n,r,i){np(this,e),this.repoInfo_=t,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Y9,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=u7(),this.transactionQueueTree_=new x9,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return ip(e,[{key:"toString",value:function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}]),e}();function eee(e){var t=e.infoData_.getNode(new o8(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function tee(e){return function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e}({timestamp:eee(e)})}function nee(e,t,n,r,i){e.dataUpdateCount++;var a=new o8(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var o=[];if(i)if(r){var s=VB(n,function(e){return X8(e)});o=function(e,t,n,r){var i=_9(e,r);if(i){var a=w9(i),o=a.path,s=a.queryId,u=g8(o,t),c=O7.fromObject(n);return C9(e,o,new k7(p7(s),u,c))}return[]}(e.serverSyncTree_,a,s,i)}else{var u=X8(n);o=function(e,t,n,r){var i=_9(e,r);if(null!=i){var a=w9(i),o=a.path,s=a.queryId,u=g8(o,t);return C9(e,o,new m7(p7(s),u,n))}return[]}(e.serverSyncTree_,a,u,i)}else if(r){var c=VB(n,function(e){return X8(e)});o=function(e,t,n){var r=O7.fromObject(n);return y9(e,new k7({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,a,c)}else{var l=X8(n);o=p9(e.serverSyncTree_,a,l)}var h=a;o.length>0&&(h=fee(e,a)),J9(e.eventQueue_,h,o)}function ree(e,t){iee(e,"connected",t),!1===t&&function(e){uee(e,"onDisconnectEvents");var t=tee(e),n=u7();h7(e.onDisconnect_,s8(),function(r,i){var a=function(e,t,n,r){return I9(t,new E9(n,e),r)}(r,i,e.serverSyncTree_,t);c7(n,r,a)});var r=[];h7(n,s8(),function(t,n){r=r.concat(p9(e.serverSyncTree_,t,n));var i=yee(e,t);fee(e,i)}),e.onDisconnect_=u7(),J9(e.eventQueue_,s8(),r)}(e)}function iee(e,t,n){var r=new o8("/.info/"+t),i=X8(n);e.infoData_.updateSnapshot(r,i);var a=p9(e.infoSyncTree_,r,i);J9(e.eventQueue_,r,a)}function aee(e){return e.nextWriteId_++}function oee(e,t,n){e.server_.onDisconnectCancel(t.toString(),function(r,i){"ok"===r&&l7(e.onDisconnect_,t),cee(0,n,r,i)})}function see(e,t,n,r){var i=X8(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),function(n,a){"ok"===n&&c7(e.onDisconnect_,t,i),cee(0,r,n,a)})}function uee(e){for(var t="",n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.persistentConnection_&&(t=e.persistentConnection_.id+":"),_6.apply(void 0,[t].concat(r))}function cee(e,t,n,r){t&&F6(function(){if("ok"===n)t(null);else{var e=(n||"error").toUpperCase(),i=e;r&&(i+=": "+r);var a=new Error(i);a.code=e,t(a)}})}function lee(e,t,n){return g9(e.serverSyncTree_,t,n)||J8.EMPTY_NODE}function hee(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||gee(e,t),R9(t)){var n=vee(e,t);lB(n.length>0,"Sending zero length transaction queue"),n.every(function(e){return 0===e.status})&&function(e,t,n){for(var r=n.map(function(e){return e.currentWriteId}),i=lee(e,t,r),a=i,o=i.hash(),s=0;s<n.length;s++){var u=n[s];lB(0===u.status,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;var c=g8(t,u.path);a=a.updateChild(c,u.currentOutputSnapshotRaw)}var l=a.val(!0),h=t;e.server_.put(h.toString(),l,function(r){uee(e,"transaction put response",{path:h.toString(),status:r});var i=[];if("ok"===r){for(var a=[],o=function(t){n[t].status=2,i=i.concat(v9(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&a.push(function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)}),n[t].unwatcher()},s=0;s<n.length;s++)o(s);gee(e,A9(e.transactionQueueTree_,t)),hee(e,e.transactionQueueTree_),J9(e.eventQueue_,t,i);for(var u=0;u<a.length;u++)F6(a[u])}else{if("datastale"===r)for(var c=0;c<n.length;c++)n[c].status=3===n[c].status?4:0;else{E6("transaction at "+h.toString()+" failed: "+r);for(var l=0;l<n.length;l++)n[l].status=4,n[l].abortReason=r}fee(e,t)}},o)}(e,F9(t),n)}else M9(t)&&D9(t,function(t){hee(e,t)})}function fee(e,t){var n=dee(e,t),r=F9(n);return function(e,t,n){if(0!==t.length){for(var r=[],i=[],a=t.filter(function(e){return 0===e.status}).map(function(e){return e.currentWriteId}),o=function(o){var s=t[o],u=g8(n,s.path),c=void 0,l=!1;if(lB(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===s.status)l=!0,c=s.abortReason,i=i.concat(v9(e.serverSyncTree_,s.currentWriteId,!0));else if(0===s.status)if(s.retryCount>=25)l=!0,c="maxretry",i=i.concat(v9(e.serverSyncTree_,s.currentWriteId,!0));else{var h=lee(e,s.path,a);s.currentInputSnapshot=h;var f=t[o].update(h.val());if(void 0!==f){W9("transaction failed: Data returned ",f,s.path);var d=X8(f);"object"==typeof f&&null!=f&&LB(f,".priority")||(d=d.updatePriority(h.getPriority()));var v=s.currentWriteId,p=tee(e),g=T9(d,h,p);s.currentOutputSnapshotRaw=d,s.currentOutputSnapshotResolved=g,s.currentWriteId=aee(e),a.splice(a.indexOf(v),1),i=(i=i.concat(d9(e.serverSyncTree_,s.path,g,s.currentWriteId,s.applyLocally))).concat(v9(e.serverSyncTree_,v,!0))}else l=!0,c="nodata",i=i.concat(v9(e.serverSyncTree_,s.currentWriteId,!0))}J9(e.eventQueue_,n,i),i=[],l&&(t[o].status=2,setTimeout(t[o].unwatcher,Math.floor(0)),t[o].onComplete&&r.push("nodata"===c?function(){return t[o].onComplete(null,!1,t[o].currentInputSnapshot)}:function(){return t[o].onComplete(new Error(c),!1,null)}))},s=0;s<t.length;s++)o(s);gee(e,e.transactionQueueTree_);for(var u=0;u<r.length;u++)F6(r[u]);hee(e,e.transactionQueueTree_)}}(e,vee(e,n),r),r}function dee(e,t){var n,r=e.transactionQueueTree_;for(n=u8(t);null!==n&&void 0===R9(r);)r=A9(r,n),n=u8(t=l8(t));return r}function vee(e,t){var n=[];return pee(e,t,n),n.sort(function(e,t){return e.order-t.order}),n}function pee(e,t,n){var r=R9(t);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);D9(t,function(t){pee(e,t,n)})}function gee(e,t){var n=R9(t);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,N9(t,n.length>0?n:void 0)}D9(t,function(t){gee(e,t)})}function yee(e,t){var n=F9(dee(e,t)),r=A9(e.transactionQueueTree_,t);return function(e,t,n){for(var r=e.parent;null!==r;){if(t(r))return!0;r=r.parent}}(r,function(t){mee(e,t)}),mee(e,r),L9(r,function(t){mee(e,t)}),n}function mee(e,t){var n=R9(t);if(n){for(var r=[],i=[],a=-1,o=0;o<n.length;o++)3===n[o].status||(1===n[o].status?(lB(a===o-1,"All SENT items should be at beginning of queue."),a=o,n[o].status=3,n[o].abortReason="set"):(lB(0===n[o].status,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(v9(e.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));-1===a?N9(t,void 0):n.length=a+1,J9(e.eventQueue_,F9(t),i);for(var s=0;s<r.length;s++)F6(r[s])}}var kee=function(e,t){var n=_ee(e),r=n.namespace;return"firebase.com"===n.domain&&b6(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==n.domain&&b6("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&E6("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new q6(n.host,n.secure,r,t,"ws"===n.scheme||"wss"===n.scheme,"",r!==n.subdomain),path:new o8(n.pathString)}},_ee=function(e){var t="",n="",r="",i="",a="",o=!0,s="https",u=443;if("string"==typeof e){var c=e.indexOf("//");c>=0&&(s=e.substring(0,c-1),e=e.substring(c+2));var l=e.indexOf("/");-1===l&&(l=e.length);var h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(l,h)),l<h&&(i=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(a){}t+="/"+i}return t}(e.substring(l,h)));var f=function(e){var t={};"?"===e.charAt(0)&&(e=e.substring(1));var n,r=Xv(e.split("&"));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(0!==i.length){var a=i.split("=");2===a.length?t[decodeURIComponent(a[0])]=decodeURIComponent(a[1]):E6("Invalid query segment '".concat(i,"' in query '").concat(e,"'"))}}}catch(o){r.e(o)}finally{r.f()}return t}(e.substring(Math.min(e.length,h)));(c=t.indexOf(":"))>=0?(o="https"===s||"wss"===s,u=parseInt(t.substring(c+1),10)):c=t.length;var d=t.slice(0,c);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{var v=t.indexOf(".");r=t.substring(0,v).toLowerCase(),n=t.substring(v+1),a=r}"ns"in f&&(a=f.ns)}return{host:t,port:u,domain:n,subdomain:r,secure:o,scheme:s,pathString:i,namespace:a}},wee=function(){function e(t,n){np(this,e),this._repo=t,this._path=n}return ip(e,[{key:"cancel",value:function(){var e=new _B;return oee(this._repo,this._path,e.wrapCallback(function(){})),e.promise}},{key:"remove",value:function(){Z9("OnDisconnect.remove",this._path);var e=new _B;return see(this._repo,this._path,null,e.wrapCallback(function(){})),e.promise}},{key:"set",value:function(e){Z9("OnDisconnect.set",this._path),$9("OnDisconnect.set",e,this._path,!1);var t=new _B;return see(this._repo,this._path,e,t.wrapCallback(function(){})),t.promise}},{key:"setWithPriority",value:function(e,t){Z9("OnDisconnect.setWithPriority",this._path),$9("OnDisconnect.setWithPriority",e,this._path,!1),function(e,t,n){if(S6(t))throw new Error(ZB(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!q9(t))throw new Error(ZB(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}("OnDisconnect.setWithPriority",t);var n=new _B;return function(e,t,n,r,i){var a=X8(n,r);e.server_.onDisconnectPut(t.toString(),a.val(!0),function(n,r){"ok"===n&&c7(e.onDisconnect_,t,a),cee(0,i,n,r)})}(this._repo,this._path,e,t,n.wrapCallback(function(){})),n.promise}},{key:"update",value:function(e){Z9("OnDisconnect.update",this._path),function(e,t,n,r){var i=ZB("OnDisconnect.update","values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");var a=[];N6(t,function(e,t){var r=new o8(e);if(W9(i,t,v8(n,r)),".priority"===h8(r)&&!q9(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)}),function(e,t){var n,r;for(n=0;n<t.length;n++)for(var i=f8(r=t[n]),a=0;a<i.length;a++)if((".priority"!==i[a]||a!==i.length-1)&&!H9(i[a]))throw new Error(e+"contains an invalid key ("+i[a]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(y8);var o=null;for(n=0;n<t.length;n++){if(r=t[n],null!==o&&k8(o,r))throw new Error(e+"contains a path "+o.toString()+" that is ancestor of another path "+r.toString());o=r}}(i,a)}(0,e,this._path);var t=new _B;return function(e,t,n,r){if(BB(n))return _6("onDisconnect().update() called with empty data.  Don't do anything."),void cee(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,function(i,a){"ok"===i&&N6(n,function(n,r){var i=X8(r);c7(e.onDisconnect_,v8(t,n),i)}),cee(0,r,i,a)})}(this._repo,this._path,e,t.wrapCallback(function(){})),t.promise}}]),e}(),Cee=function(e){qv(n,e);var t=Wv(n);function n(e,r){return np(this,n),t.call(this,e,r,new r7,!1)}return ip(n,[{key:"parent",get:function(){var e=d8(this._path);return null===e?null:new n(this._repo,e)}},{key:"root",get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}}]),n}(function(){function e(t,n,r,i){np(this,e),this._repo=t,this._path=n,this._queryParams=r,this._orderByCalled=i}return ip(e,[{key:"key",get:function(){return p8(this._path)?null:h8(this._path)}},{key:"ref",get:function(){return new Cee(this._repo,this._path)}},{key:"_queryIdentifier",get:function(){var e=a7(this._queryParams),t=A6(e);return"{}"===t?"default":t}},{key:"_queryObject",get:function(){return a7(this._queryParams)}},{key:"isEqual",value:function(t){if(!((t=JB(t))instanceof e))return!1;var n=this._repo===t._repo,r=m8(this._path,t._path);return n&&r&&this._queryIdentifier===t._queryIdentifier}},{key:"toJSON",value:function(){return this.toString()}},{key:"toString",value:function(){return this._repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}]),e}());(function(e){lB(!J7,"__referenceConstructor has already been defined"),J7=e})(Cee),function(e){lB(!Q7,"__referenceConstructor has already been defined"),Q7=e}(Cee);var bee={};var Eee=function(){function e(t,n){np(this,e),this._repoInternal=t,this.app=n,this.type="database",this._instanceStarted=!1}return ip(e,[{key:"_repo",get:function(){return this._instanceStarted||(function(e,t,n){if(e.stats_=Y6(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new o7(e.repoInfo_,function(t,n,r,i){nee(e,t,n,r,i)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(function(){return ree(e,!0)},0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{MB(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new O8(e.repoInfo_,t,function(t,n,r,i){nee(e,t,n,r,i)},function(t){ree(e,t)},function(t){!function(e,t){N6(t,function(t,n){iee(e,t,n)})}(e,t)},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(function(t){e.server_.refreshAuthToken(t)}),e.appCheckProvider_.addTokenChangeListener(function(t){e.server_.refreshAppCheckToken(t.token)}),e.statsReporter_=function(e,t){var n=e.toString();return Z6[n]||(Z6[n]=t()),Z6[n]}(e.repoInfo_,function(){return new d7(e.stats_,e.server_)}),e.infoData_=new s7,e.infoSyncTree_=new f9({startListening:function(t,n,r,i){var a=[],o=e.infoData_.getNode(t._path);return o.isEmpty()||(a=p9(e.infoSyncTree_,t._path,o),setTimeout(function(){i("ok")},0)),a},stopListening:function(){}}),iee(e,"connected",!1),e.serverSyncTree_=new f9({startListening:function(t,n,r,i){return e.server_.listen(t,r,n,function(n,r){var a=i(n,r);J9(e.eventQueue_,t._path,a)}),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}},{key:"_root",get:function(){return this._rootInternal||(this._rootInternal=new Cee(this._repo,s8())),this._rootInternal}},{key:"_delete",value:function(){return null!==this._rootInternal&&(function(e,t){var n=bee[t];(!n||n[e.key]!==e)&&b6("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),function(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}},{key:"_checkNotDeleted",value:function(e){null===this._rootInternal&&b6("Cannot call "+e+" on a deleted database.")}}]),e}();var See={".sv":"timestamp"};function Pee(){return See}O8.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},O8.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},u6="9.6.6",yV(new QB("database",function(e,t){var n=t.instanceIdentifier;return function(e,t,n,r,i){var a=r||e.options.databaseURL;void 0===a&&(e.options.projectId||b6("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),_6("Using default host for project ",e.options.projectId),a="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));var o,s,u=kee(a,i),c=u.repoInfo;"undefined"!=typeof process&&(s=process.env.FIREBASE_DATABASE_EMULATOR_HOST),s?(o=!0,a="http://".concat(s,"?ns=").concat(c.namespace),c=(u=kee(a,i)).repoInfo):o=!u.repoInfo.secure;var l=i&&o?new z6(z6.OWNER):new U6(e.name,e.options,t);(function(e,t){var n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!H9(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),G9(e)}(n))throw new Error(ZB("Invalid Firebase Database URL","url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})(0,u),p8(u.path)||b6("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(e,t,n,r){var i=bee[t.name];i||(i={},bee[t.name]=i);var a=i[e.toURLString()];return a&&b6("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new X9(e,!1,n,r),i[e.toURLString()]=a,a}(c,e,l,new V6(e.name,n));return new Eee(h,e)}(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)},"PUBLIC").setMultipleInstances(!0)),EV(s6,"0.12.5",void 0),EV(s6,"0.12.5","esm2017");var Oee=ip(function e(t){return np(this,e),t}),Tee=new sk("angularfire2.database-instances");function Iee(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new Oee(r)}}var xee={provide:ip(function e(){return np(this,e),XH("database")}),deps:[[new Dk,Tee]]},Aee={provide:Oee,useFactory:function(e,t){var n=QH("database",e,t);return n&&new Oee(n)},deps:[[new Dk,Tee],lG]},Ree=function(){var e=ip(function e(){np(this,e),EV("angularfire",ZH.full,"rtdb")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ay({type:e}),e.\u0275inj=Pg({providers:[Aee,xee]}),e}(),Nee=cG(function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(e=JB(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&b6("Cannot call useEmulator() after instance has already been initialized.");var i,a=e._repoInternal;if(a.repoInfo_.nodeAdmin)r.mockUserToken&&b6('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new z6(z6.OWNER);else if(r.mockUserToken){var o="string"==typeof r.mockUserToken?r.mockUserToken:wB(r.mockUserToken,e.app.options.projectId);i=new z6(o)}!function(e,t,n,r){e.repoInfo_=new q6("".concat(t,":").concat(n),!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),r&&(e.authTokenProvider_=r)}(a,t,n,i)},!0),Mee=cG(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CV(),t=arguments.length>1?arguments[1]:void 0;return mV(e,"database").getImmediate({identifier:t})},!0),Dee=cG(function(e){return e=JB(e),new wee(e._repo,e._path)},!0),Lee=cG(function(e,t){return(e=JB(e))._checkNotDeleted("ref"),void 0!==t?function(e,t){return null===u8((e=JB(e))._path)?((n=t)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),j9("child","path",n,!1)):j9("child","path",t,!1),new Cee(e._repo,v8(e._path,t));var n}(e._root,t):e._root},!0),Fee=cG(function(e,t){e=JB(e),Z9("set",e._path),$9("set",t,e._path,!1);var n=new _B;return function(e,t,n,r,i){uee(e,"set",{path:t.toString(),value:n,priority:null});var a=tee(e),o=X8(n,null),s=g9(e.serverSyncTree_,t),u=T9(o,s,a),c=aee(e),l=d9(e.serverSyncTree_,t,u,c,!0);K9(e.eventQueue_,l),e.server_.put(t.toString(),o.val(!0),function(n,r){var a="ok"===n;a||E6("set at "+t+" failed: "+n);var o=v9(e.serverSyncTree_,c,!a);J9(e.eventQueue_,t,o),cee(0,i,n,r)});var h=yee(e,t);fee(e,h),J9(e.eventQueue_,h,[])}(e._repo,e._path,t,0,n.wrapCallback(function(){})),n.promise},!0),Bee=function(){function e(t){np(this,e),this.db=t}return ip(e,[{key:"setOffline",value:function(t){return Fee(Lee(this.db,"/status/"+t),e.OFFLINE)}},{key:"launchAutomaticPresenceUpdate",value:function(t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=Lee(n.db,"/status/"+t),r.next=3,Fee(i,e.ONLINE);case 3:return r.next=5,Dee(i).set(e.OFFLINE);case 5:case"end":return r.stop()}},r)}))()}}]),e}();Bee.OFFLINE={state:"offline",last_changed:Pee()},Bee.ONLINE={state:"online",last_changed:Pee()},Bee.\u0275fac=function(e){return new(e||Bee)(Ok(Oee))},Bee.\u0275prov=Sg({token:Bee,factory:Bee.\u0275fac,providedIn:"root"});var Vee=function(){function e(){np(this,e)}return ip(e,null,[{key:"createUserWithEmailAndPassword",value:function(e,t,n){return yj(e,t,n)}},{key:"sendEmailVerification",value:function(e){return _j(e)}},{key:"sendPasswordResetEmail",value:function(e,t){return wj(e,t)}},{key:"signInWithEmailAndPassword",value:function(e,t,n){return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Cj(e,t,n);case 2:return r.abrupt("return",r.sent.user);case 3:case"end":return r.stop()}},r)}))()}},{key:"signInWithPopup",value:function(e,t){return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,bj(e,t);case 2:return n.abrupt("return",n.sent.user);case 3:case"end":return n.stop()}},n)}))()}},{key:"updateProfile",value:function(e,t){return Ej(e,t)}}]),e}(),Uee=function(){function e(t,n,r){np(this,e),this.email=t,this.username=n,this.verified=r}return ip(e,[{key:"isConnected",value:function(){return this.email.isPresent()}}]),e}();Uee.NOT_CONNECTED=new Uee(cB.empty(),cB.empty(),!1);var zee=function(){var e=function(){function e(t,n,r){np(this,e);var i,a=this;this.userDAO=t,this.auth=n,this.connectivityDAO=r,this.user=cB.empty(),this.uid=cB.empty(),this.userUnsubscribe=cB.empty(),aB(e.VERBOSE,"AuthenticationService constructor"),this.userRS=new o6(1),this.userObs=this.userRS.asObservable(),this.unsubscribeFromAuth=kj(this.auth,(i=rB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=n){t.next=4;break}aB(e.VERBOSE,"User is not connected"),a.userUnsubscribe.isPresent()&&a.userUnsubscribe.get()(),a.userRS.next(Uee.NOT_CONNECTED),a.user=cB.empty(),a.uid=cB.empty(),t.next=9;break;case 4:return Z5(a.uid.isAbsent(),"AuthenticationService received a double update for an user, this is unexpected"),a.uid=cB.of(n.uid),t.next=8,a.connectivityDAO.launchAutomaticPresenceUpdate(n.uid);case 8:a.userUnsubscribe=cB.of(a.userDAO.subscribeToChanges(n.uid,function(t){if(t.isPresent()){var r=t.get().username;aB(e.VERBOSE,"User ".concat(r," is connected, and the verified status is ").concat(a.emailVerified(n)));var i=!0===a.emailVerified(n)&&null!=r;if(!0===i&&!1===t.get().verified)return a.userDAO.markVerified(n.uid);var o=new Uee(cB.ofNullable(n.email),cB.ofNullable(r),i);a.user=cB.of(o),a.userRS.next(o)}}));case 9:case"end":return t.stop()}},t)})),function(e){return i.apply(this,arguments)}))}return ip(e,[{key:"emailVerified",value:function(e){return e.emailVerified}},{key:"sendPasswordResetEmail",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Vee.sendPasswordResetEmail(t.auth,e);case 3:return n.abrupt("return",$5.SUCCESS);case 6:return n.prev=6,n.t0=n.catch(0),n.abrupt("return",$5.failure(t.mapFirebaseError(n.t0)));case 9:case"end":return n.stop()}},n,null,[[0,6]])}))()}},{key:"doRegister",value:function(t,r,i){var a=this;return rB(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return aB(e.VERBOSE,"AuthenticationService.doRegister("+r+")"),o.next=3,a.userDAO.usernameIsAvailable(t);case 3:if(!o.sent){o.next=7;break}o.t0=a.registerAfterUsernameCheck(t,r,i),o.next=8;break;case 7:o.t0=H5.failure($localize(n||(n=Nv(["This username is already in use."]))));case 8:return o.abrupt("return",o.t0);case 9:case"end":return o.stop()}},o)}))()}},{key:"registerAfterUsernameCheck",value:function(e,t,n){var r=this;return rB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,Vee.createUserWithEmailAndPassword(r.auth,t,n);case 3:return a=i.sent,o=iB.getNonNullable(a.user),i.next=7,r.createUser(o.uid,e);case 7:return i.abrupt("return",H5.success(o));case 10:return i.prev=10,i.t0=i.catch(0),i.abrupt("return",H5.failure(r.mapFirebaseError(i.t0)));case 13:case"end":return i.stop()}},i,null,[[0,10]])}))()}},{key:"mapFirebaseError",value:function(e){switch(e.code){case"auth/email-already-in-use":return $localize(r||(r=Nv(["This email address is already in use."])));case"auth/invalid-email":return $localize(i||(i=Nv(["This email address is invalid."])));case"auth/user-not-found":case"auth/wrong-password":return $localize(a||(a=Nv(["You have entered invalid credentials."])));case"auth/invalid-credential":return $localize(o||(o=Nv(["The credential is invalid or has expired, please try again."])));case"auth/weak-password":return $localize(s||(s=Nv(["Your password is too weak, please use a stronger password."])));case"auth/too-many-requests":return $localize(u||(u=Nv(["There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later."])));case"auth/popup-closed-by-user":return $localize(c||(c=Nv(["You closed the authentication popup without finalizing your log in."])));default:return j5.logError("AuthenticationService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}},{key:"sendEmailVerification",value:function(){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(aB(e.VERBOSE,"AuthenticationService.sendEmailVerification()"),(r=cB.ofNullable(t.auth.currentUser)).isPresent()){n.next=4;break}return n.abrupt("return",j5.logError("AuthenticationService","Unlogged users cannot request for email verification"));case 4:if(!t.emailVerified(r.get())){n.next=6;break}return n.abrupt("return",j5.logError("AuthenticationService","Verified users should not ask email verification after being verified"));case 6:return n.prev=6,n.next=9,Vee.sendEmailVerification(r.get());case 9:return n.abrupt("return",$5.SUCCESS);case 12:return n.prev=12,n.t0=n.catch(6),n.abrupt("return",$5.failure(t.mapFirebaseError(n.t0)));case 15:case"end":return n.stop()}},n,null,[[6,12]])}))()}},{key:"doEmailLogin",value:function(t,n){var r=this;return rB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return aB(e.VERBOSE,"AuthenticationService.doEmailLogin("+t+")"),i.prev=1,i.next=4,Vee.signInWithEmailAndPassword(r.auth,t,n);case 4:return i.abrupt("return",$5.SUCCESS);case 7:return i.prev=7,i.t0=i.catch(1),i.abrupt("return",$5.failure(r.mapFirebaseError(i.t0)));case 10:case"end":return i.stop()}},i,null,[[1,7]])}))()}},{key:"createUser",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null!=t){r.next=5;break}return r.next=3,n.userDAO.set(e,{verified:!1});case 3:r.next=7;break;case 5:return r.next=7,n.userDAO.set(e,{username:t,verified:!1});case 7:case"end":return r.stop()}},r)}))()}},{key:"doGoogleLogin",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=$5,t.next=3,e.registerOrLoginWithGoogle();case 3:return t.t1=t.sent,t.abrupt("return",t.t0.ofFallible.call(t.t0,t.t1));case 5:case"end":return t.stop()}},t)}))()}},{key:"registerOrLoginWithGoogle",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=new R$).addScope("profile"),n.addScope("email"),t.next=5,Vee.signInWithPopup(e.auth,n);case 5:return r=t.sent,t.t0=!1,t.next=9,e.userDAO.exists(r.uid);case 9:if(t.t1=t.sent,t.t2=t.t0===t.t1,!t.t2){t.next=14;break}return t.next=14,e.createUser(r.uid);case 14:return t.abrupt("return",H5.success(r));case 17:return t.prev=17,t.t3=t.catch(0),t.abrupt("return",H5.failure(e.mapFirebaseError(t.t3)));case 20:case"end":return t.stop()}},t,null,[[0,17]])}))()}},{key:"disconnect",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=cB.ofNullable(e.auth.currentUser)).isPresent()){t.next=8;break}return r=n.get().uid,t.next=5,e.connectivityDAO.setOffline(r);case 5:return t.next=7,e.auth.signOut();case 7:return t.abrupt("return",$5.SUCCESS);case 8:return t.abrupt("return",$5.failure("Cannot disconnect a non-connected user"));case 9:case"end":return t.stop()}},t)}))()}},{key:"getUserObs",value:function(){return this.userObs}},{key:"setUsername",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(""!==e){n.next=2;break}return n.abrupt("return",$5.failure($localize(l||(l=Nv(["Your username may not be empty."])))));case 2:return n.prev=2,n.t0=!1,n.next=6,t.userDAO.usernameIsAvailable(e);case 6:if(n.t1=n.sent,n.t0!==n.t1){n.next=9;break}return n.abrupt("return",$5.failure($localize(h||(h=Nv(["This username is already in use, please select a different one."])))));case 9:return r=iB.getNonNullable(t.auth.currentUser),n.next=12,Vee.updateProfile(r,{displayName:e});case 12:return n.next=14,t.userDAO.setUsername(r.uid,e);case 14:return n.next=16,t.userDAO.markVerified(r.uid);case 16:return n.next=18,t.reloadUser();case 18:return n.abrupt("return",$5.SUCCESS);case 21:return n.prev=21,n.t2=n.catch(2),n.abrupt("return",$5.failure(t.mapFirebaseError(n.t2)));case 24:case"end":return n.stop()}},n,null,[[2,21]])}))()}},{key:"setPicture",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r=iB.getNonNullable(t.auth.currentUser),n.next=4,Vee.updateProfile(r,{photoURL:e});case 4:return n.abrupt("return",$5.SUCCESS);case 7:return n.prev=7,n.t0=n.catch(0),n.abrupt("return",$5.failure(t.mapFirebaseError(n.t0)));case 10:case"end":return n.stop()}},n,null,[[0,7]])}))()}},{key:"reloadUser",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=iB.getNonNullable(e.auth.currentUser),t.next=3,n.getIdToken(!0);case 3:return t.next=5,n.reload();case 5:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userUnsubscribe.isPresent()&&this.userUnsubscribe.get()(),this.unsubscribeFromAuth()}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Ok(r6),Ok(uj),Ok(Bee))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Hee=function(){function e(t){np(this,e),this.value=t}return ip(e,null,[{key:"of",value:function(t){switch(t){case"CREATOR":return e.CREATOR;case"RANDOM":return e.RANDOM;default:return Z5("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),e.CHOSEN_PLAYER}}}]),e}();Hee.CREATOR=new Hee("CREATOR"),Hee.RANDOM=new Hee("RANDOM"),Hee.CHOSEN_PLAYER=new Hee("CHOSEN_PLAYER");var Gee=function(){function e(t){np(this,e),this.value=t}return ip(e,null,[{key:"of",value:function(t){switch(t){case"STANDARD":return e.STANDARD;case"BLITZ":return e.BLITZ;case"CUSTOM":return e.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}]),e}();Gee.STANDARD=new Gee("STANDARD"),Gee.BLITZ=new Gee("BLITZ"),Gee.CUSTOM=new Gee("CUSTOM"),Gee.NORMAL_MOVE_DURATION=120,Gee.NORMAL_PART_DURATION=1800,Gee.BLITZ_MOVE_DURATION=30,Gee.BLITZ_PART_DURATION=900;var qee=ip(function e(t){np(this,e),this.value=t});qee.PART_CREATED=new qee(0),qee.CONFIG_PROPOSED=new qee(2),qee.PART_STARTED=new qee(3),qee.PART_FINISHED=new qee(4);var $ee=ip(function e(){np(this,e)}),Wee=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"encode",value:function(e){return this.encodeMove(e)}},{key:"decode",value:function(e){return Z5(!1===Array.isArray(e),"MoveEncoder.decode called with an array"),this.decodeMove(e)}}],[{key:"disjunction3",value:function(e,t,r,i,a){return new(function(n){qv(s,n);var o=Wv(s);function s(){return np(this,s),o.apply(this,arguments)}return ip(s,[{key:"encodeMove",value:function(n){return i(n)?{type:"T1",encoded:e.encode(n)}:a(n)?{type:"T2",encoded:t.encode(n)}:{type:"T3",encoded:r.encode(n)}}},{key:"decodeMove",value:function(n){var i=iB.getNonNullable(n).type,a=iB.getNonNullable(n).encoded;return"T1"===i?e.decode(a):"T2"===i?t.decode(a):r.decode(a)}}]),s}(n))}}]),n}($ee),jee=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"shift",value:function(){return this.maxValue()+1}},{key:"encodeMove",value:function(e){return this.encodeNumber(e)}},{key:"decodeMove",value:function(e){return Z5("number"==typeof e,"Invalid encoded number"),this.decodeNumber(e)}}],[{key:"ofN",value:function(e,t,r){return new(function(n){qv(a,n);var i=Wv(a);function a(){return np(this,a),i.apply(this,arguments)}return ip(a,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(e){return t(e)}},{key:"decodeNumber",value:function(e){return r(e)}}]),a}(n))}},{key:"tuple",value:function(e,t,r){return new(function(n){qv(a,n);var i=Wv(a);function a(){return np(this,a),i.apply(this,arguments)}return ip(a,[{key:"maxValue",value:function(){var t=0;return Object.keys(e).forEach(function(n){t=t*e[n].shift()+e[n].maxValue()}),t}},{key:"encodeNumber",value:function(n){var r=t(n),i=0;return Object.keys(r).forEach(function(t){i=i*e[t].shift()+e[t].encode(r[t])}),i}},{key:"decodeNumber",value:function(t){var n={},i=t;return Object.keys(e).reverse().forEach(function(t){var r=i%e[t].shift();i=(i-r)/e[t].shift(),n[t]=e[t].decode(r)}),r(n)}}]),a}(n))}},{key:"disjunction",value:function(e,t,r){return new(function(n){qv(a,n);var i=Wv(a);function a(){return np(this,a),i.apply(this,arguments)}return ip(a,[{key:"maxValue",value:function(){return Math.max(2*e.maxValue(),2*t.maxValue()+1)}},{key:"encodeNumber",value:function(n){return r(n)?2*e.encodeNumber(n):2*t.encodeNumber(n)+1}},{key:"decodeNumber",value:function(n){return n%2==0?e.decodeNumber(n/2):t.decodeNumber((n-1)/2)}}]),a}(n))}},{key:"numberEncoder",value:function(e){return new(function(t){qv(r,t);var n=Wv(r);function r(){return np(this,r),n.apply(this,arguments)}return ip(r,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(t){if(t>e)throw new Error("Cannot encode number bigger than the max with numberEncoder");return t}},{key:"decodeNumber",value:function(t){if(t>e)throw new Error("Cannot decode number bigger than the max with numberEncoder");return t}}]),r}(n))}}]),n}(Wee);jee.booleanEncoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"maxValue",value:function(){return 1}},{key:"encodeNumber",value:function(e){return e?1:0}},{key:"decodeNumber",value:function(e){if(0===e)return!1;if(1===e)return!0;throw new Error("Invalid encoded boolean")}}]),n}(jee));var Zee=function(){function e(t){np(this,e),this.value=t}return ip(e,[{key:"toString",value:function(){return"Player "+this.value}},{key:"equals",value:function(e){return this===e}},{key:"getScoreModifier",value:function(){return 0===this.value?-1:1}},{key:"getPreVictory",value:function(){return this.getVictoryValue()-this.getScoreModifier()}},{key:"getDefeatValue",value:function(){return Z5(this!==e.NONE,"Should not call getDefeatValue on Player.NONE!"),this===e.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}},{key:"getVictoryValue",value:function(){return Z5(this!==e.NONE,"Should not call getVictoryValue on Player.NONE!"),this===e.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}},{key:"getOpponent",value:function(){switch(this){case e.ZERO:return e.ONE;case e.ONE:return e.ZERO;default:return iB.expectToBe(this,e.NONE),e.NONE}}}],[{key:"of",value:function(t){switch(t){case 0:return e.ZERO;case 1:return e.ONE;default:return iB.expectToBe(t,2),e.NONE}}},{key:"fromTurn",value:function(t){return t%2==0?e.ZERO:e.ONE}}]),e}();Zee.numberEncoder=jee.ofN(2,function(e){return e.value},function(e){return Zee.of(e)}),Zee.ZERO=new Zee(0),Zee.ONE=new Zee(1),Zee.NONE=new Zee(2);var Yee=function(){function e(){np(this,e)}return ip(e,null,[{key:"rematchAccepted",value:function(e,t){return Kee("RematchAccepted",{typeGame:e,partId:t})}},{key:"getPlayer",value:function(e){return Zee.of(iB.getNonNullable(e.data).player)}},{key:"getTypeGame",value:function(e){return iB.getNonNullable(e.data).typeGame}},{key:"getPartId",value:function(e){return iB.getNonNullable(e.data).partId}}]),e}();function Kee(e,t){return{code:e,data:t}}function Jee(e){return function(t){return Kee(e,{player:t.value})}}Yee.drawProposed=Jee("DrawProposed"),Yee.drawAccepted=Kee("DrawAccepted",{}),Yee.drawRefused=Jee("DrawRefused"),Yee.takeBackAsked=Jee("TakeBackAsked"),Yee.takeBackRefused=Jee("TakeBackRefused"),Yee.takeBackAccepted=Jee("TakeBackAccepted"),Yee.rematchProposed=Jee("RematchProposed"),Yee.addTurnTime=Jee("AddTurnTime"),Yee.addGlobalTime=Jee("AddGlobalTime");var Qee=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),r=t.call(this,"joiners",e),aB(n.VERBOSE,"JoinerDAO.constructor"),r}return ip(n)}(z5);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Ok(C5))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Xee=function(){var e=function(){function e(t){np(this,e),this.joinerDAO=t,this.joinerUnsubscribe=cB.empty(),aB(e.VERBOSE,"JoinerService.constructor")}return ip(e,[{key:"subscribeToChanges",value:function(e,t){this.observedJoinerId=e,this.joinerUnsubscribe=cB.of(this.joinerDAO.subscribeToChanges(e,t))}},{key:"unsubscribe",value:function(){Z5(this.joinerUnsubscribe.isPresent(),"JoinerService cannot unsubscribe if no joiner is observed"),this.joinerUnsubscribe.get()(),this.joinerUnsubscribe=cB.empty()}},{key:"createInitialJoiner",value:function(t,n){var r=this;return rB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(aB(e.VERBOSE,"JoinerService.createInitialJoiner("+t+", "+n+")"),r.set(n,{candidates:[],chosenPlayer:null,firstPlayer:Hee.RANDOM.value,partType:Gee.STANDARD.value,partStatus:qee.PART_CREATED.value,maximalMoveDuration:Gee.NORMAL_MOVE_DURATION,totalPartDuration:Gee.NORMAL_PART_DURATION,creator:t})));case 1:case"end":return i.stop()}},i)}))()}},{key:"joinGame",value:function(t,n){var r=this;return rB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return aB(e.VERBOSE,"JoinerService.joinGame("+t+", "+n+")"),i.next=3,r.joinerDAO.read(t);case 3:if(!(a=i.sent).isAbsent()){i.next=6;break}return i.abrupt("return",$5.failure("Game does not exist"));case 6:if(!(o=Q5.copyImmutableArray(a.get().candidates)).includes(n)){i.next=11;break}i.t0=$5.failure("User already in the game"),i.next=17;break;case 11:if(i.t1=n===a.get().creator,i.t1){i.next=16;break}return o[o.length]=n,i.next=16,r.joinerDAO.update(t,{candidates:o});case 16:i.t0=$5.SUCCESS;case 17:return i.abrupt("return",i.t0);case 18:case"end":return i.stop()}},i)}))()}},{key:"cancelJoining",value:function(t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(aB(e.VERBOSE,"JoinerService.cancelJoining("+t+"); this.observedJoinerId = "+n.observedJoinerId),null!=n.observedJoinerId){r.next=2;break}throw new Error("cannot cancel joining when not observing a joiner");case 2:return r.next=4,n.joinerDAO.read(n.observedJoinerId);case 4:if((i=r.sent).isAbsent()){r.next=15;break}if(a=i.get(),o=Q5.copyImmutableArray(a.candidates),s=o.indexOf(t),u=a.chosenPlayer,c=a.partStatus,o.splice(s,1),u!==t){r.next=12;break}u=null,c=qee.PART_CREATED.value,r.next=14;break;case 12:if(-1!==s){r.next=14;break}throw new Error("someone that was not candidate nor chosenPlayer just left the chat: "+t);case 14:return r.abrupt("return",n.joinerDAO.update(n.observedJoinerId,{chosenPlayer:u,partStatus:c,candidates:o}));case 15:case"end":return r.stop()}},r)}))()}},{key:"updateCandidates",value:function(t){var n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(aB(e.VERBOSE,"JoinerService.reviewConfig"),Z5(null!=n.observedJoinerId,"JoinerService is not observing a joiner"),n.joinerDAO.update(n.observedJoinerId,{candidates:t})));case 1:case"end":return r.stop()}},r)}))()}},{key:"deleteJoiner",value:function(){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(aB(e.VERBOSE,"JoinerService.deleteJoiner(); this.observedJoinerId = "+t.observedJoinerId),Z5(null!=t.observedJoinerId,"JoinerService is not observing a joiner"),t.joinerDAO.delete(t.observedJoinerId)));case 1:case"end":return n.stop()}},n)}))()}},{key:"proposeConfig",value:function(t,n,r,i,a){var o=this;return rB(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(aB(e.VERBOSE,{joinerService_proposeConfig:{maximalMoveDuration:r,firstPlayer:i,totalPartDuration:a}}),aB(e.VERBOSE,"this.followedJoinerId: "+o.observedJoinerId),Z5(null!=o.observedJoinerId,"JoinerService is not observing a joiner"),o.joinerDAO.update(o.observedJoinerId,{partStatus:qee.CONFIG_PROPOSED.value,chosenPlayer:t,partType:n.value,maximalMoveDuration:r,totalPartDuration:a,firstPlayer:i.value})));case 1:case"end":return s.stop()}},s)}))()}},{key:"setChosenPlayer",value:function(t){return aB(e.VERBOSE,"JoinerService.setChosenPlayer(".concat(t,")")),Z5(null!=this.observedJoinerId,"JoinerService is not observing a joiner"),this.joinerDAO.update(this.observedJoinerId,{chosenPlayer:t})}},{key:"reviewConfig",value:function(){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(aB(e.VERBOSE,"JoinerService.reviewConfig"),Z5(null!=t.observedJoinerId,"JoinerService is not observing a joiner"),t.joinerDAO.update(t.observedJoinerId,{partStatus:qee.PART_CREATED.value})));case 1:case"end":return n.stop()}},n)}))()}},{key:"reviewConfigRemoveChosenPlayerAndUpdateCandidates",value:function(t){var n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(aB(e.VERBOSE,"JoinerService.reviewConfig"),Z5(null!=n.observedJoinerId,"JoinerService is not observing a joiner"),n.joinerDAO.update(n.observedJoinerId,{partStatus:qee.PART_CREATED.value,chosenPlayer:null,candidates:t})));case 1:case"end":return r.stop()}},r)}))()}},{key:"acceptConfig",value:function(){return aB(e.VERBOSE,"JoinerService.acceptConfig"),Z5(null!=this.observedJoinerId,"JoinerService is not observing a joiner"),this.joinerDAO.update(this.observedJoinerId,{partStatus:qee.PART_STARTED.value})}},{key:"createJoiner",value:function(t){var n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(aB(e.VERBOSE,"JoinerService.create("+JSON.stringify(t)+")"),n.joinerDAO.create(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"readJoinerById",value:function(t){var n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return aB(e.VERBOSE,"JoinerService.readJoinerById("+t+")"),r.next=3,n.joinerDAO.read(t);case 3:return r.abrupt("return",r.sent.get());case 4:case"end":return r.stop()}},r)}))()}},{key:"set",value:function(t,n){var r=this;return rB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(aB(e.VERBOSE,"JoinerService.set("+t+", "+JSON.stringify(n)+")"),r.joinerDAO.set(t,n)));case 1:case"end":return i.stop()}},i)}))()}},{key:"updateJoinerById",value:function(t,n){var r=this;return rB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(aB(e.VERBOSE,{joinerService_updateJoinerById:{partId:t,update:n}}),r.joinerDAO.update(t,n)));case 1:case"end":return i.stop()}},i)}))()}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Ok(Qee))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ete=function(){var e=function(){function e(t,n,r){np(this,e),this.partDAO=t,this.joinerService=n,this.chatService=r,this.followedPartId=cB.empty(),aB(e.VERBOSE,"GameService.constructor")}return ip(e,[{key:"getPartValidity",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.partDAO.read(e);case 2:return i=r.sent,r.abrupt("return",i.isAbsent()?$5.failure("NONEXISTENT_PART"):i.get().typeGame===t?$5.SUCCESS:$5.failure("WRONG_GAME_TYPE"));case 4:case"end":return r.stop()}},r)}))()}},{key:"createUnstartedPart",value:function(t,n){return aB(e.VERBOSE,"GameService.createPart("+t+", "+n+")"),this.partDAO.create({lastUpdate:{index:0,player:0},typeGame:n,playerZero:t,turn:-1,result:Y5.UNACHIEVED.value,listMoves:[]})}},{key:"createChat",value:function(t){return aB(e.VERBOSE,"GameService.createChat("+t+")"),this.chatService.createNewChat(t)}},{key:"createPartJoinerAndChat",value:function(t,n){var r=this;return rB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return aB(e.VERBOSE,"GameService.createGame("+t+", "+n+")"),i.next=3,r.createUnstartedPart(t,n);case 3:return a=i.sent,i.next=6,r.joinerService.createInitialJoiner(t,a);case 6:return i.next=8,r.createChat(a);case 8:return i.abrupt("return",a);case 9:case"end":return i.stop()}},i)}))()}},{key:"startGameWithConfig",value:function(t,n,r,i){aB(e.VERBOSE,"GameService.startGameWithConfig("+t+", "+JSON.stringify(i));var a=this.getStartingConfig(i);return this.partDAO.updateAndBumpIndex(t,n,r,a)}},{key:"getStartingConfig",value:function(e){var t,n,r=Hee.of(e.firstPlayer);return r===Hee.RANDOM&&(r=Math.random()<.5?Hee.CREATOR:Hee.CHOSEN_PLAYER),r===Hee.CREATOR?(t=e.creator,n=iB.getNonNullable(e.chosenPlayer)):(t=iB.getNonNullable(e.chosenPlayer),n=e.creator),{playerZero:t,playerOne:n,turn:0,beginning:w5(),remainingMsForZero:1e3*e.totalPartDuration,remainingMsForOne:1e3*e.totalPartDuration}}},{key:"deletePart",value:function(t){var n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(aB(e.VERBOSE,"GameService.deletePart("+t+")"),n.partDAO.delete(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"acceptConfig",value:function(t,n){var r=this;return rB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return aB(e.VERBOSE,{gameService_acceptConfig:{partId:t,joiner:n}}),i.next=3,r.joinerService.acceptConfig();case 3:return i.abrupt("return",r.startGameWithConfig(t,Zee.ONE,0,n));case 4:case"end":return i.stop()}},i)}))()}},{key:"startObserving",value:function(t,n){if(!this.followedPartId.isAbsent())throw new Error("GameService.startObserving should not be called while already observing a game");aB(e.VERBOSE,"[start watching part "+t),this.followedPartId=cB.of(t),this.followedPartUnsubscribe=this.partDAO.subscribeToChanges(t,n)}},{key:"resign",value:function(e,t,n,r,i){return this.partDAO.updateAndBumpIndex(e,n,t,{winner:r,loser:i,result:Y5.RESIGN.value,request:null})}},{key:"notifyTimeout",value:function(e,t,n,r,i){return this.partDAO.updateAndBumpIndex(e,t,n,{winner:r,loser:i,result:Y5.TIMEOUT.value,request:null})}},{key:"sendRequest",value:function(e,t,n,r){return this.partDAO.updateAndBumpIndex(e,t,n,{request:r})}},{key:"proposeDraw",value:function(e,t,n){return this.sendRequest(e,n,t,Yee.drawProposed(n))}},{key:"acceptDraw",value:function(e,t,n){return this.partDAO.updateAndBumpIndex(e,n,t,{result:(n===Zee.ZERO?Y5.AGREED_DRAW_BY_ZERO:Y5.AGREED_DRAW_BY_ONE).value,request:null})}},{key:"refuseDraw",value:function(e,t,n){return this.sendRequest(e,n,t,Yee.drawRefused(n))}},{key:"proposeRematch",value:function(e,t,n){return this.sendRequest(e,n,t,Yee.rematchProposed(n))}},{key:"acceptRematch",value:function(t,n,r){var i=this;return rB(regeneratorRuntime.mark(function a(){var o,s,u,c,l,h,f;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return aB(e.VERBOSE,{called:"GameService.acceptRematch(",partDocument:t}),o=iB.getNonNullable(t.data),a.next=4,i.joinerService.readJoinerById(t.id);case 4:return s=a.sent,u=o.playerZero===s.creator?Hee.CHOSEN_PLAYER:Hee.CREATOR,c=Dv(Dv({},s),{},{candidates:[],firstPlayer:u.value,partStatus:qee.PART_STARTED.value}),a.next=9,i.joinerService.createJoiner(c);case 9:return l=a.sent,h=i.getStartingConfig(c),f=Dv({lastUpdate:{index:0,player:r.value},typeGame:o.typeGame,result:Y5.UNACHIEVED.value,listMoves:[]},h),a.next=14,i.partDAO.set(l,f);case 14:return a.next=16,i.createChat(l);case 16:return a.abrupt("return",i.sendRequest(t.id,r,n,Yee.rematchAccepted(o.typeGame,l)));case 17:case"end":return a.stop()}},a)}))()}},{key:"askTakeBack",value:function(e,t,n){return this.sendRequest(e,n,t,Yee.takeBackAsked(n))}},{key:"acceptTakeBack",value:function(e,t,n,r){var i=this;return rB(regeneratorRuntime.mark(function a(){var o,s,u,c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return Z5(n!==Zee.NONE,"Illegal for observer to make request"),Z5(Yee.getPlayer(iB.getNonNullable(t.data.request))!==n,"Illegal to accept your own request"),o=Yee.takeBackAccepted(n),(s=t.data.listMoves.slice(0,t.data.listMoves.length-1)).length%2===n.value&&(s=s.slice(0,s.length-1)),u={request:o,listMoves:s,turn:s.length,lastUpdateTime:w5(),remainingMsForZero:iB.getNonNullable(t.data.remainingMsForZero)-r[0],remainingMsForOne:iB.getNonNullable(t.data.remainingMsForOne)-r[1]},c=t.data.lastUpdate.index,a.next=7,i.partDAO.updateAndBumpIndex(e,n,c,u);case 7:return a.abrupt("return",a.sent);case 8:case"end":return a.stop()}},a)}))()}},{key:"refuseTakeBack",value:function(e,t,n){Z5(n!==Zee.NONE,"Illegal for observer to make request");var r=Yee.takeBackRefused(n);return this.partDAO.updateAndBumpIndex(e,n,t,{request:r})}},{key:"addGlobalTime",value:function(e,t,n,r){var i=this;return rB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return Z5(r!==Zee.NONE,"Illegal for observer to make request"),o={request:Yee.addGlobalTime(r.getOpponent())},o=r===Zee.ZERO?Dv(Dv({},o),{},{remainingMsForOne:iB.getNonNullable(n.remainingMsForOne)+3e5}):Dv(Dv({},o),{},{remainingMsForZero:iB.getNonNullable(n.remainingMsForZero)+3e5}),a.next=5,i.partDAO.updateAndBumpIndex(e,r,t,o);case 5:return a.abrupt("return",a.sent);case 6:case"end":return a.stop()}},a)}))()}},{key:"addTurnTime",value:function(e,t,n){var r=this;return rB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a={request:Yee.addTurnTime(e.getOpponent())},i.next=3,r.partDAO.updateAndBumpIndex(n,e,t,a);case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"stopObserving",value:function(){aB(e.VERBOSE,"GameService.stopObserving();"),Z5(this.followedPartId.isPresent(),"!!! GameService.stopObserving: we already stop watching doc"),aB(e.VERBOSE,"stopped watching joiner "+this.followedPartId+"]"),this.followedPartId=cB.empty(),this.followedPartUnsubscribe()}},{key:"updateDBBoard",value:function(t,n,r,i,a,o,s,u){var c=this;return rB(regeneratorRuntime.mark(function l(){var h,f,d,v,p;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return aB(e.VERBOSE,{gameService_updateDBBoard:{partId:t,encodedMove:r,scores:a,msToSubstract:i,notifyDraw:o,winner:s,loser:u}}),l.next=3,c.partDAO.read(t);case 3:return h=l.sent.get(),f=h.lastUpdate.index,d=h.turn+1,(v=Q5.copyImmutableArray(h.listMoves))[v.length]=r,p={listMoves:v,turn:d,request:null,lastUpdateTime:w5()},p=c.updateScore(p,a),p=c.substractMs(p,h,i),null!=s?p=Dv(Dv({},p),{},{winner:s,loser:u,result:Y5.VICTORY.value}):!0===o&&(p=Dv(Dv({},p),{},{result:Y5.HARD_DRAW.value})),l.next=14,c.partDAO.updateAndBumpIndex(t,n,f,p);case 14:return l.abrupt("return",l.sent);case 15:case"end":return l.stop()}},l)}))()}},{key:"updateScore",value:function(e,t){return void 0!==t?Dv(Dv({},e),{},{scorePlayerZero:t[0],scorePlayerOne:t[1]}):e}},{key:"substractMs",value:function(e,t,n){return n[0]>0?Dv(Dv({},e),{},{remainingMsForZero:iB.getNonNullable(t.remainingMsForZero)-n[0]}):n[1]>0?Dv(Dv({},e),{},{remainingMsForOne:iB.getNonNullable(t.remainingMsForOne)-n[1]}):e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Ok(J5),Ok(Xee),Ok(t6))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),tte=function(){function e(){np(this,e)}return ip(e,null,[{key:"getNavigatorLanguage",value:function(){return navigator.language}},{key:"getLocale",value:function(){var t=(localStorage.getItem("locale")||e.getNavigatorLanguage()||"fr").slice(0,2).toLowerCase();return["en","fr"].some(function(e){return e===t})?t:"fr"}}]),e}(),nte=function(){var e=function(){function e(){np(this,e)}return ip(e,[{key:"changeTheme",value:function(e){localStorage.setItem("theme",e)}},{key:"getTheme",value:function(){return cB.ofNullable(localStorage.getItem("theme"))}},{key:"changeLanguage",value:function(e){localStorage.setItem("locale",e.toLowerCase())}},{key:"getLanguage",value:function(){return tte.getLocale()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),rte=function(){var e=function(){function e(t,n){np(this,e),this.document=t,this.userSettingsService=n,this.availableThemes=["dark","light"];var r=this.getStoredTheme();r.isPresent()?this.loadTheme(r.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}return ip(e,[{key:"getStoredTheme",value:function(){var e=this.userSettingsService.getTheme();if(e.isPresent()){var t=e.get();if(this.availableThemes.some(function(e){return e===t}))return cB.of(t)}return cB.empty()}},{key:"loadTheme",value:function(e){this.loadStyle(e+".css"),this.theme=e}},{key:"loadStyle",value:function(e){var t=this.document.getElementsByTagName("head")[0],n=this.document.getElementById("theme");if(null!=n)n.href=e;else{var r=this.document.createElement("link");r.id="theme",r.rel="stylesheet",r.href="".concat(e),t.appendChild(r)}}},{key:"getTheme",value:function(){return this.theme}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(TO),Ok(nte))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ite={prefix:"fas",iconName:"book-open",icon:[576,512,[],"f518","M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"]},ate={prefix:"fas",iconName:"cog",icon:[512,512,[],"f013","M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"]},ote={prefix:"fas",iconName:"desktop",icon:[576,512,[],"f108","M528 0H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h192l-16 48h-72c-13.3 0-24 10.7-24 24s10.7 24 24 24h272c13.3 0 24-10.7 24-24s-10.7-24-24-24h-72l-16-48h192c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zm-16 352H64V64h448v288z"]},ste={prefix:"fas",iconName:"eye",icon:[576,512,[],"f06e","M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"]},ute={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M640 264v-16c0-8.84-7.16-16-16-16H344v-40h72c17.67 0 32-14.33 32-32V32c0-17.67-14.33-32-32-32H224c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h72v40H16c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h104v40H64c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h304v40h-56c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h104c8.84 0 16-7.16 16-16zM256 128V64h128v64H256zm-64 320H96v-64h96v64zm352 0h-96v-64h96v64z"]},cte={prefix:"fas",iconName:"reply",icon:[512,512,[],"f3e5","M8.309 189.836L184.313 37.851C199.719 24.546 224 35.347 224 56.015v80.053c160.629 1.839 288 34.032 288 186.258 0 61.441-39.581 122.309-83.333 154.132-13.653 9.931-33.111-2.533-28.077-18.631 45.344-145.012-21.507-183.51-176.59-185.742V360c0 20.7-24.3 31.453-39.687 18.164l-176.004-152c-11.071-9.562-11.086-26.753 0-36.328z"]};function lte(e){return(lte="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hte(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fte(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){hte(e,t,n[t])})}return e}function dte(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){i=!0,a=u}finally{try{!r&&null!=s.return&&s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var vte={},pte={};try{"undefined"!=typeof window&&(vte=window),"undefined"!=typeof document&&(pte=document),"undefined"!=typeof MutationObserver&&MutationObserver,"undefined"!=typeof performance&&performance}catch(yme){}var gte=(vte.navigator||{}).userAgent,yte=void 0===gte?"":gte,mte=vte,kte=pte,_te=!!kte.documentElement&&!!kte.head&&"function"==typeof kte.addEventListener&&"function"==typeof kte.createElement,wte=(~yte.indexOf("MSIE")||yte.indexOf("Trident/"),"___FONT_AWESOME___"),Cte="svg-inline--fa",bte=[1,2,3,4,5,6,7,8,9,10],Ete=bte.concat([11,12,13,14,15,16,17,18,19,20]),Ste={GROUP:"group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},Pte=(["xs","sm","lg","fw","ul","li","border","pull-left","pull-right","spin","pulse","rotate-90","rotate-180","rotate-270","flip-horizontal","flip-vertical","flip-both","stack","stack-1x","stack-2x","inverse","layers","layers-text","layers-counter",Ste.GROUP,Ste.SWAP_OPACITY,Ste.PRIMARY,Ste.SECONDARY].concat(bte.map(function(e){return"".concat(e,"x")})).concat(Ete.map(function(e){return"w-".concat(e)})),mte.FontAwesomeConfig||{});kte&&"function"==typeof kte.querySelector&&[["data-family-prefix","familyPrefix"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(e){var t=dte(e,2),n=t[1],r=function(e){return""===e||"false"!==e&&("true"===e||e)}(function(e){var t=kte.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}(t[0]));null!=r&&(Pte[n]=r)});var Ote=fte({},{familyPrefix:"fa",replacementClass:Cte,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},Pte);Ote.autoReplaceSvg||(Ote.observeMutations=!1);var Tte=fte({},Ote);mte.FontAwesomeConfig=Tte;var Ite=mte||{};Ite[wte]||(Ite[wte]={}),Ite[wte].styles||(Ite[wte].styles={}),Ite[wte].hooks||(Ite[wte].hooks={}),Ite[wte].shims||(Ite[wte].shims=[]);var xte=Ite[wte],Ate=[];_te&&((kte.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(kte.readyState)||kte.addEventListener("DOMContentLoaded",function e(){kte.removeEventListener("DOMContentLoaded",e),Ate.map(function(e){return e()})}));var Rte,Nte="pending",Mte="fulfilled",Dte="rejected",Lte=function(){},Fte="undefined"!=typeof global&&void 0!==global.process&&"function"==typeof global.process.emit,Bte="undefined"==typeof setImmediate?setTimeout:setImmediate,Vte=[];function Ute(){for(var e=0;e<Vte.length;e++)Vte[e][0](Vte[e][1]);Vte=[],Rte=!1}function zte(e,t){Vte.push([e,t]),Rte||(Rte=!0,Bte(Ute,0))}function Hte(e){var t=e.owner,n=t._state,r=t._data,i=e[n],a=e.then;if("function"==typeof i){n=Mte;try{r=i(r)}catch(o){Wte(a,o)}}Gte(a,r)||(n===Mte&&qte(a,r),n===Dte&&Wte(a,r))}function Gte(e,t){var n;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"===lte(t))){var r=t.then;if("function"==typeof r)return r.call(t,function(r){n||(n=!0,t===r?$te(e,r):qte(e,r))},function(t){n||(n=!0,Wte(e,t))}),!0}}catch(i){return n||Wte(e,i),!0}return!1}function qte(e,t){(e===t||!Gte(e,t))&&$te(e,t)}function $te(e,t){e._state===Nte&&(e._state="settled",e._data=t,zte(Zte,e))}function Wte(e,t){e._state===Nte&&(e._state="settled",e._data=t,zte(Yte,e))}function jte(e){e._then=e._then.forEach(Hte)}function Zte(e){e._state=Mte,jte(e)}function Yte(e){e._state=Dte,jte(e),!e._handled&&Fte&&global.process.emit("unhandledRejection",e._data,e)}function Kte(e){global.process.emit("rejectionHandled",e)}function Jte(e){if("function"!=typeof e)throw new TypeError("Promise resolver "+e+" is not a function");if(!(this instanceof Jte))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(e,t){function n(e){Wte(t,e)}try{e(function(e){qte(t,e)},n)}catch(r){n(r)}}(e,this)}Jte.prototype={constructor:Jte,_state:Nte,_then:null,_data:void 0,_handled:!1,then:function(e,t){var n={owner:this,then:new this.constructor(Lte),fulfilled:e,rejected:t};return(t||e)&&!this._handled&&(this._handled=!0,this._state===Dte&&Fte&&zte(Kte,this)),this._state===Mte||this._state===Dte?zte(Hte,n):this._then.push(n),n.then},catch:function(e){return this.then(null,e)}},Jte.all=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.all().");return new Jte(function(t,n){var r=[],i=0;function a(e){return i++,function(n){r[e]=n,--i||t(r)}}for(var o,s=0;s<e.length;s++)(o=e[s])&&"function"==typeof o.then?o.then(a(s),n):r[s]=o;i||t(r)})},Jte.race=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.race().");return new Jte(function(t,n){for(var r,i=0;i<e.length;i++)(r=e[i])&&"function"==typeof r.then?r.then(t,n):t(r)})},Jte.resolve=function(e){return e&&"object"===lte(e)&&e.constructor===Jte?e:new Jte(function(t){t(e)})},Jte.reject=function(e){return new Jte(function(t,n){n(e)})};var Qte={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function Xte(){for(var e=12,t="";e-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function ene(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function tne(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,": ").concat(e[n],";")},"")}function nne(e){return e.size!==Qte.size||e.x!==Qte.x||e.y!==Qte.y||e.rotate!==Qte.rotate||e.flipX||e.flipY}function rne(e){var t=e.transform,n=e.iconWidth,r={transform:"translate(".concat(e.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),a="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),o="rotate(".concat(t.rotate," 0 0)");return{outer:r,inner:{transform:"".concat(i," ").concat(a," ").concat(o)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}var ine={x:0,y:0,width:"100%",height:"100%"};function ane(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}function one(e){return"g"===e.tag?e.children:[e]}function sne(e){var t=e.icons,n=t.main,r=t.mask,i=e.prefix,a=e.iconName,o=e.transform,s=e.symbol,u=e.title,c=e.maskId,l=e.titleId,h=e.extra,f=e.watchable,d=void 0!==f&&f,v=r.found?r:n,p=v.width,g=v.height,y="fak"===i,m=y?"":"fa-w-".concat(Math.ceil(p/g*16)),k=[Tte.replacementClass,a?"".concat(Tte.familyPrefix,"-").concat(a):"",m].filter(function(e){return-1===h.classes.indexOf(e)}).filter(function(e){return""!==e||!!e}).concat(h.classes).join(" "),_={children:[],attributes:fte({},h.attributes,{"data-prefix":i,"data-icon":a,class:k,role:h.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(p," ").concat(g)})},w=y&&!~h.classes.indexOf("fa-fw")?{width:"".concat(p/g*16*.0625,"em")}:{};d&&(_.attributes["data-fa-i2svg"]=""),u&&_.children.push({tag:"title",attributes:{id:_.attributes["aria-labelledby"]||"title-".concat(l||Xte())},children:[u]});var C=fte({},_,{prefix:i,iconName:a,main:n,mask:r,maskId:c,transform:o,symbol:s,styles:fte({},w,h.styles)}),b=r.found&&n.found?function(e){var t=e.children,n=e.attributes,r=e.main,i=e.mask,a=e.maskId,o=r.icon,s=i.icon,u=rne({transform:e.transform,containerWidth:i.width,iconWidth:r.width}),c={tag:"rect",attributes:fte({},ine,{fill:"white"})},l=o.children?{children:o.children.map(ane)}:{},h={tag:"g",attributes:fte({},u.inner),children:[ane(fte({tag:o.tag,attributes:fte({},o.attributes,u.path)},l))]},f={tag:"g",attributes:fte({},u.outer),children:[h]},d="mask-".concat(a||Xte()),v="clip-".concat(a||Xte()),p={tag:"mask",attributes:fte({},ine,{id:d,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[c,f]},g={tag:"defs",children:[{tag:"clipPath",attributes:{id:v},children:one(s)},p]};return t.push(g,{tag:"rect",attributes:fte({fill:"currentColor","clip-path":"url(#".concat(v,")"),mask:"url(#".concat(d,")")},ine)}),{children:t,attributes:n}}(C):function(e){var t=e.children,n=e.attributes,r=e.main,i=e.transform,a=tne(e.styles);if(a.length>0&&(n.style=a),nne(i)){var o=rne({transform:i,containerWidth:r.width,iconWidth:r.width});t.push({tag:"g",attributes:fte({},o.outer),children:[{tag:"g",attributes:fte({},o.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:fte({},r.icon.attributes,o.path)}]}]})}else t.push(r.icon);return{children:t,attributes:n}}(C),E=b.attributes;return C.children=b.children,C.attributes=E,s?function(e){var t=e.iconName,n=e.children,r=e.symbol;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:fte({},e.attributes,{id:!0===r?"".concat(e.prefix,"-").concat(Tte.familyPrefix,"-").concat(t):r}),children:n}]}]}(C):function(e){var t=e.children,n=e.main,r=e.mask,i=e.attributes,a=e.styles,o=e.transform;if(nne(o)&&n.found&&!r.found){var s={x:n.width/n.height/2,y:.5};i.style=tne(fte({},a,{"transform-origin":"".concat(s.x+o.x/16,"em ").concat(s.y+o.y/16,"em")}))}return[{tag:"svg",attributes:i,children:t}]}(C)}var une=function(e,t,n,r){var i,a,o,s=Object.keys(e),u=s.length,c=void 0!==r?function(e,t){return function(n,r,i,a){return e.call(t,n,r,i,a)}}(t,r):t;for(void 0===n?(i=1,o=e[s[0]]):(i=0,o=n);i<u;i++)o=c(o,e[a=s[i]],a,e);return o};function cne(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.skipHooks,i=void 0!==r&&r,a=Object.keys(t).reduce(function(e,n){var r=t[n];return r.icon?e[r.iconName]=r.icon:e[n]=r,e},{});"function"!=typeof xte.hooks.addPack||i?xte.styles[e]=fte({},xte.styles[e]||{},a):xte.hooks.addPack(e,a),"fas"===e&&cne("fa",t)}var lne=xte.styles,hne=xte.shims,fne=function(){var e=function(e){return une(lne,function(t,n,r){return t[r]=une(n,e,{}),t},{})};e(function(e,t,n){return t[3]&&(e[t[3]]=n),e}),e(function(e,t,n){var r=t[2];return e[n]=n,r.forEach(function(t){e[t]=n}),e});var t="far"in lne;une(hne,function(e,n){var r=n[1];return"far"===r&&!t&&(r="fas"),e[n[0]]={prefix:r,iconName:n[2]},e},{})};function dne(e,t,n){if(e&&e[t]&&e[t][n])return{prefix:t,iconName:n,icon:e[t][n]}}function vne(e){var t=e.tag,n=e.attributes,r=void 0===n?{}:n,i=e.children,a=void 0===i?[]:i;return"string"==typeof e?ene(e):"<".concat(t," ").concat(function(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,'="').concat(ene(e[n]),'" ')},"").trim()}(r),">").concat(a.map(vne).join(""),"</").concat(t,">")}function pne(e){this.name="MissingIcon",this.message=e||"Icon unavailable",this.stack=(new Error).stack}fne(),(pne.prototype=Object.create(Error.prototype)).constructor=pne;var gne={fill:"currentColor"},yne={attributeType:"XML",repeatCount:"indefinite",dur:"2s"},mne=(fte({},gne,{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"}),fte({},yne,{attributeName:"opacity"}));function kne(e){var t=e[0],n=e[1],r=dte(e.slice(4),1)[0];return{found:!0,width:t,height:n,icon:Array.isArray(r)?{tag:"g",attributes:{class:"".concat(Tte.familyPrefix,"-").concat(Ste.GROUP)},children:[{tag:"path",attributes:{class:"".concat(Tte.familyPrefix,"-").concat(Ste.SECONDARY),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(Tte.familyPrefix,"-").concat(Ste.PRIMARY),fill:"currentColor",d:r[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:r}}}}function _ne(){Tte.autoAddCss&&!Ene&&(function(e){if(e&&_te){var t=kte.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;for(var n=kte.head.childNodes,r=null,i=n.length-1;i>-1;i--){var a=n[i],o=(a.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=a)}kte.head.insertBefore(t,r)}}(function(){var e="fa",t=Cte,n=Tte.familyPrefix,r=Tte.replacementClass,i='svg:not(:root).svg-inline--fa {\n  overflow: visible;\n}\n\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.225em;\n}\n.svg-inline--fa.fa-w-1 {\n  width: 0.0625em;\n}\n.svg-inline--fa.fa-w-2 {\n  width: 0.125em;\n}\n.svg-inline--fa.fa-w-3 {\n  width: 0.1875em;\n}\n.svg-inline--fa.fa-w-4 {\n  width: 0.25em;\n}\n.svg-inline--fa.fa-w-5 {\n  width: 0.3125em;\n}\n.svg-inline--fa.fa-w-6 {\n  width: 0.375em;\n}\n.svg-inline--fa.fa-w-7 {\n  width: 0.4375em;\n}\n.svg-inline--fa.fa-w-8 {\n  width: 0.5em;\n}\n.svg-inline--fa.fa-w-9 {\n  width: 0.5625em;\n}\n.svg-inline--fa.fa-w-10 {\n  width: 0.625em;\n}\n.svg-inline--fa.fa-w-11 {\n  width: 0.6875em;\n}\n.svg-inline--fa.fa-w-12 {\n  width: 0.75em;\n}\n.svg-inline--fa.fa-w-13 {\n  width: 0.8125em;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-15 {\n  width: 0.9375em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-w-17 {\n  width: 1.0625em;\n}\n.svg-inline--fa.fa-w-18 {\n  width: 1.125em;\n}\n.svg-inline--fa.fa-w-19 {\n  width: 1.1875em;\n}\n.svg-inline--fa.fa-w-20 {\n  width: 1.25em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-border {\n  height: 1.5em;\n}\n.svg-inline--fa.fa-li {\n  width: 2em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: #ff253a;\n  border-radius: 1em;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  color: #fff;\n  height: 1.5em;\n  line-height: 1;\n  max-width: 5em;\n  min-width: 1.5em;\n  overflow: hidden;\n  padding: 0.25em;\n  right: 0;\n  text-overflow: ellipsis;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: 0;\n  right: 0;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: 0;\n  left: 0;\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  right: 0;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: 0;\n  right: auto;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-lg {\n  font-size: 1.3333333333em;\n  line-height: 0.75em;\n  vertical-align: -0.0667em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: 2.5em;\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: -2em;\n  position: absolute;\n  text-align: center;\n  width: 2em;\n  line-height: inherit;\n}\n\n.fa-border {\n  border: solid 0.08em #eee;\n  border-radius: 0.1em;\n  padding: 0.2em 0.25em 0.15em;\n}\n\n.fa-pull-left {\n  float: left;\n}\n\n.fa-pull-right {\n  float: right;\n}\n\n.fa.fa-pull-left,\n.fas.fa-pull-left,\n.far.fa-pull-left,\n.fal.fa-pull-left,\n.fab.fa-pull-left {\n  margin-right: 0.3em;\n}\n.fa.fa-pull-right,\n.fas.fa-pull-right,\n.far.fa-pull-right,\n.fal.fa-pull-right,\n.fab.fa-pull-right {\n  margin-left: 0.3em;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n          animation: fa-spin 2s infinite linear;\n}\n\n.fa-pulse {\n  -webkit-animation: fa-spin 1s infinite steps(8);\n          animation: fa-spin 1s infinite steps(8);\n}\n\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n:root .fa-rotate-90,\n:root .fa-rotate-180,\n:root .fa-rotate-270,\n:root .fa-flip-horizontal,\n:root .fa-flip-vertical,\n:root .fa-flip-both {\n  -webkit-filter: none;\n          filter: none;\n}\n\n.fa-stack {\n  display: inline-block;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: #fff;\n}\n\n.sr-only {\n  border: 0;\n  clip: rect(0, 0, 0, 0);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n.sr-only-focusable:active, .sr-only-focusable:focus {\n  clip: auto;\n  height: auto;\n  margin: 0;\n  overflow: visible;\n  position: static;\n  width: auto;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse {\n  color: #fff;\n}';if(n!==e||r!==t){var a=new RegExp("\\.".concat(e,"\\-"),"g"),o=new RegExp("\\--".concat(e,"\\-"),"g"),s=new RegExp("\\.".concat(t),"g");i=i.replace(a,".".concat(n,"-")).replace(o,"--".concat(n,"-")).replace(s,".".concat(r))}return i}()),Ene=!0)}function wne(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map(function(e){return vne(e)})}}),Object.defineProperty(e,"node",{get:function(){if(_te){var t=kte.createElement("div");return t.innerHTML=e.html,t.children}}}),e}function Cne(e){var t=e.prefix,n=void 0===t?"fa":t,r=e.iconName;if(r)return dne(bne.definitions,n,r)||dne(xte.styles,n,r)}fte({},gne,{cx:"256",cy:"364",r:"28"}),fte({},yne,{attributeName:"r",values:"28;14;28;28;14;28;"}),fte({},mne,{values:"1;0;1;1;0;1;"}),fte({},gne,{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),fte({},mne,{values:"1;0;0;0;0;1;"}),fte({},gne,{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),fte({},mne,{values:"0;0;1;1;0;0;"});var bne=new(function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.definitions={}}return function(e,t,n){t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t)}(e,[{key:"add",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.reduce(this._pullDefinitions,{});Object.keys(i).forEach(function(t){e.definitions[t]=fte({},e.definitions[t]||{},i[t]),cne(t,i[t]),fne()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,t){var n=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(n).map(function(t){var r=n[t],i=r.prefix,a=r.iconName,o=r.icon;e[i]||(e[i]={}),e[i][a]=o}),e}}]),e}()),Ene=!1,Sne=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:Cne(t||{}),i=n.mask;return i&&(i=(i||{}).icon?i:Cne(i||{})),e(r,fte({},n,{mask:i}))}}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,r=void 0===n?Qte:n,i=t.symbol,a=void 0!==i&&i,o=t.mask,s=void 0===o?null:o,u=t.maskId,c=void 0===u?null:u,l=t.title,h=void 0===l?null:l,f=t.titleId,d=void 0===f?null:f,v=t.classes,p=void 0===v?[]:v,g=t.attributes,y=void 0===g?{}:g,m=t.styles,k=void 0===m?{}:m;if(e){var _=e.prefix,w=e.iconName,C=e.icon;return wne(fte({type:"icon"},e),function(){return _ne(),Tte.autoA11y&&(h?y["aria-labelledby"]="".concat(Tte.replacementClass,"-title-").concat(d||Xte()):(y["aria-hidden"]="true",y.focusable="false")),sne({icons:{main:kne(C),mask:s?kne(s.icon):{found:!1,width:null,height:null,icon:{}}},prefix:_,iconName:w,transform:fte({},Qte,r),symbol:a,title:h,maskId:c,titleId:d,extra:{attributes:y,styles:k,classes:p}})})}}),Pne=["*"],One=function(e){var t,n=(Lv(t={"fa-spin":e.spin,"fa-pulse":e.pulse,"fa-fw":e.fixedWidth,"fa-border":e.border,"fa-inverse":e.inverse,"fa-layers-counter":e.counter,"fa-flip-horizontal":"horizontal"===e.flip||"both"===e.flip,"fa-flip-vertical":"vertical"===e.flip||"both"===e.flip},"fa-".concat(e.size),null!==e.size),Lv(t,"fa-rotate-".concat(e.rotate),null!==e.rotate),Lv(t,"fa-pull-".concat(e.pull),null!==e.pull),Lv(t,"fa-stack-".concat(e.stackItemSize),null!=e.stackItemSize),t);return Object.keys(n).map(function(e){return n[e]?e:null}).filter(function(e){return e})},Tne=function(){var e=ip(function e(){np(this,e),this.defaultPrefix="fas",this.fallbackIcon=null});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Ine=function(){var e=function(){function e(){np(this,e),this.definitions={}}return ip(e,[{key:"addIcons",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var a=i[r];a.prefix in this.definitions||(this.definitions[a.prefix]={}),this.definitions[a.prefix][a.iconName]=a;var o,s=Xv(a.icon[2]);try{for(s.s();!(o=s.n()).done;){var u=o.value;"string"==typeof u&&(this.definitions[a.prefix][u]=a)}}catch(c){s.e(c)}finally{s.f()}}}},{key:"addIconPacks",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=function(){var t=o[a],n=Object.keys(t).map(function(e){return t[e]});e.addIcons.apply(e,Jv(n))},a=0,o=n;a<o.length;a++)i()}},{key:"getIconDefinition",value:function(e,t){return e in this.definitions&&t in this.definitions[e]?this.definitions[e][t]:null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),xne=function(){var e=function(){function e(){np(this,e),this.stackItemSize="1x"}return ip(e,[{key:"ngOnChanges",value:function(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=sy({type:e,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[_y]}),e}(),Ane=function(){var e=function(){function e(t,n){np(this,e),this.renderer=t,this.elementRef=n}return ip(e,[{key:"ngOnInit",value:function(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}},{key:"ngOnChanges",value:function(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,"fa-".concat(e.size.currentValue)),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,"fa-".concat(e.size.previousValue)))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(sS),ub(iS))},e.\u0275cmp=ty({type:e,selectors:[["fa-stack"]],inputs:{size:"size"},features:[_y],ngContentSelectors:Pne,decls:1,vars:0,template:function(e,t){1&e&&(function(e){var t=qy()[16][6];if(!t.projection)for(var n=t.projection=vk(1,null),r=n.slice(),i=t.child;null!==i;){r[0]?r[0].projectionNext=i:n[0]=i,r[0]=i,i=i.next}}(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=qy(),i=$y(),a=Fw(i,20+e,16,null,n||null);null===a.projection&&(a.projection=t),Qy(),64!=(64&a.flags)&&function(e,t,n){fw(t[11],0,t,n,Z_(e,n,t),ew(n.parent||t[6],n,t))}(i,r,a)}(0))},encapsulation:2}),e}(),Rne=function(){var e=function(){function e(t,n,r,i,a){np(this,e),this.sanitizer=t,this.config=n,this.iconLibrary=r,this.stackItem=i,this.classes=[],null!=a&&null==i&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}return ip(e,[{key:"ngOnChanges",value:function(e){var t;if(null==this.icon&&null==this.config.fallbackIcon)return function(){throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")}();var n;if(n=null!==(t=this.icon)&&void 0!==t?t:this.config.fallbackIcon,e){var r=this.findIconDefinition(n);if(null!=r){var i=this.buildParams();this.renderIcon(r,i)}}}},{key:"render",value:function(){this.ngOnChanges({})}},{key:"findIconDefinition",value:function(e){var t,n,r,i,a=(n=e,r=this.config.defaultPrefix,void 0!==(i=n).prefix&&void 0!==i.iconName?n:Array.isArray(n)&&2===n.length?{prefix:n[0],iconName:n[1]}:"string"==typeof n?{prefix:r,iconName:n}:void 0);return"icon"in a?a:null!==(t=this.iconLibrary.getIconDefinition(a.prefix,a.iconName))&&void 0!==t?t:(function(e){throw new Error("Could not find icon with iconName=".concat(e.iconName," and prefix=").concat(e.prefix," in the icon library."))}(a),null)}},{key:"buildParams",value:function(){var e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},t="string"==typeof this.transform?function(e){var t={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e?e.toLowerCase().split(" ").reduce(function(e,t){var n=t.toLowerCase().split("-"),r=n[0],i=n.slice(1).join("-");if(r&&"h"===i)return e.flipX=!0,e;if(r&&"v"===i)return e.flipY=!0,e;if(i=parseFloat(i),isNaN(i))return e;switch(r){case"grow":e.size=e.size+i;break;case"shrink":e.size=e.size-i;break;case"left":e.x=e.x-i;break;case"right":e.x=e.x+i;break;case"up":e.y=e.y-i;break;case"down":e.y=e.y+i;break;case"rotate":e.rotate=e.rotate+i}return e},t):t}(this.transform):this.transform;return{title:this.title,transform:t,classes:[].concat(Jv(One(e)),Jv(this.classes)),mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}},{key:"renderIcon",value:function(e,t){var n=Sne(e,t);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(n.html.join("\n"))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(kI),ub(Tne),ub(Ine),ub(xne,8),ub(Ane,8))},e.\u0275cmp=ty({type:e,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,t){2&e&&(Bb("innerHTML",t.renderedIconHTML,k_),nb("title",t.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[_y],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),Nne=function(){var e=ip(function e(){np(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ay({type:e}),e.\u0275inj=Pg({}),e}();function Mne(e,t){if(1&e){var n=gb();vb(0),hb(1,"div",9),hb(2,"a",10),Nb(3),fb(),hb(4,"div",12),hb(5,"a",24),kb("click",function(){return Wy(n),Cb().logout()}),zE(6,25),fb(),fb(),fb(),pb()}if(2&e){var r=Cb();Ow(3),Mb(r.username)}}var Dne=function(){return["/register"]},Lne=function(){return["/login"]};function Fne(e,t){1&e&&(hb(0,"div",26),hb(1,"a",27),hb(2,"strong"),zE(3,28),fb(),fb(),hb(4,"a",29),zE(5,30),fb(),fb()),2&e&&(Ow(1),cb("routerLink",tP(2,Dne)),Ow(3),cb("routerLink",tP(3,Lne)))}var Bne=function(){return["/"]},Vne=function(){return["/play"]},Une=function(){return["/lobby"]},zne=function(){return["/local"]},Hne=function(){return["/tutorial"]},Gne=function(){return["/settings"]},qne=function(){var e=function(){function e(t,n){np(this,e),this.router=t,this.authenticationService=n,this.username="connecting...",this.faCog=ate,this.showMenu=!1}return ip(e,[{key:"ngOnInit",value:function(){var e=this;this.userSub=this.authenticationService.getUserObs().subscribe(function(t){e.username=t.username.isPresent()?t.username.get():t.email.isPresent()?t.email.get():""})}},{key:"logout",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authenticationService.disconnect();case 2:return t.next=4,e.router.navigate(["/"]);case 4:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(WM),ub(zee))},e.\u0275cmp=ty({type:e,selectors:[["app-header"]],decls:35,vars:19,consts:function(){return[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],$localize(f||(f=Nv(["Home"]))),[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],$localize(d||(d=Nv(["Play online"]))),[1,"navbar-dropdown"],$localize(v||(v=Nv(["Create a game"]))),$localize(p||(p=Nv(["Join a game"]))),$localize(g||(g=Nv(["Play offline"]))),$localize(y||(y=Nv(["Create a game"]))),$localize(m||(m=Nv(["Learn the rules"]))),[1,"navbar-end"],["data-tooltip",$localize(k||(k=Nv(["Settings"]))),1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["connect",""],["id","logout",1,"navbar-item",3,"click"],$localize(_||(_=Nv(["Log out"]))),[1,"buttons"],[1,"button","is-primary",3,"routerLink"],$localize(w||(w=Nv(["Register"]))),[1,"button","is-light",3,"routerLink"],$localize(C||(C=Nv(["Log in"])))]},template:function(e,t){if(1&e&&(hb(0,"nav",0),hb(1,"div",1),hb(2,"a",2),db(3,"img",3),fb(),hb(4,"a",4),kb("click",function(){return t.showMenu=!t.showMenu}),db(5,"span",5),db(6,"span",5),db(7,"span",5),fb(),fb(),hb(8,"div",6),kb("click",function(){return t.showMenu=!t.showMenu}),hb(9,"div",7),hb(10,"a",2),zE(11,8),fb(),hb(12,"div",9),hb(13,"a",10),zE(14,11),fb(),hb(15,"div",12),hb(16,"a",2),zE(17,13),fb(),hb(18,"a",2),zE(19,14),fb(),fb(),fb(),hb(20,"div",9),hb(21,"a",10),zE(22,15),fb(),hb(23,"div",12),hb(24,"a",2),zE(25,16),fb(),hb(26,"a",2),zE(27,17),fb(),fb(),fb(),fb(),hb(28,"div",18),hb(29,"a",19),db(30,"fa-icon",20),fb(),hb(31,"div",21),ob(32,Mne,7,1,"ng-container",22),ob(33,Fne,6,4,"ng-template",null,23,IP),fb(),fb(),fb(),fb()),2&e){var n=sb(34);Ow(2),cb("routerLink",tP(12,Bne)),Ow(2),cb("ngClass",t.showMenu?"is-active":""),Ow(4),cb("ngClass",t.showMenu?"is-active":""),Ow(2),cb("routerLink",tP(13,Bne)),Ow(6),cb("routerLink",tP(14,Vne)),Ow(2),cb("routerLink",tP(15,Une)),Ow(6),cb("routerLink",tP(16,zne)),Ow(2),cb("routerLink",tP(17,Hne)),Ow(3),cb("routerLink",tP(18,Gne)),Ow(1),cb("icon",t.faCog),Ow(2),cb("ngIf",t.username)("ngIfElse",n)}},directives:[YM,AT,Rne,DT],encapsulation:2}),e}(),$ne=function(){var e=ip(function e(t,n){np(this,e),this._themeService=t,this._errorLoggerService=n});return e.\u0275fac=function(t){return new(t||e)(ub(rte),ub(j5))},e.\u0275cmp=ty({type:e,selectors:[["app-root"]],decls:3,vars:0,consts:[[1,"container","mt-2"]],template:function(e,t){1&e&&(db(0,"app-header"),hb(1,"main",0),db(2,"router-outlet"),fb())},directives:[qne,JM],encapsulation:2}),e}(),Wne=function(){function e(t,n){np(this,e),this.x=t,this.y=n}return ip(e,[{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}}]),e}(),jne=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"isDown",value:function(){return 1===this.y}},{key:"isUp",value:function(){return-1===this.y}},{key:"isLeft",value:function(){return-1===this.x}},{key:"isRight",value:function(){return 1===this.x}},{key:"toInt",value:function(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}},{key:"toString",value:function(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}]),n}(Wne),Zne=function(){function e(){np(this,e)}return ip(e,[{key:"of",value:function(e,t){var n,r=Xv(this.all);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.x===e&&i.y===t)return H5.success(i)}}catch(a){r.e(a)}finally{r.f()}return H5.failure("Invalid x and y in direction construction")}},{key:"fromDelta",value:function(e,t){return 0===e&&0===t?H5.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.of(Math.sign(e),Math.sign(t)):H5.failure("Invalid delta for direction: ".concat(e,", ").concat(t))}},{key:"fromMove",value:function(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}},{key:"fromString",value:function(e){switch(e){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return H5.failure("Invalid direction string ".concat(e))}}},{key:"fromInt",value:function(e){switch(e){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return H5.failure("Invalid int direction: ".concat(e))}}}]),e}(),Yne=function(e){qv(n,e);var t=Wv(n);function n(e,r){return np(this,n),t.call(this,e,r)}return ip(n,[{key:"isDiagonal",value:function(){return 0!==this.x&&0!==this.y}},{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}(jne);Yne.UP=new Yne(0,-1),Yne.UP_RIGHT=new Yne(1,-1),Yne.RIGHT=new Yne(1,0),Yne.DOWN_RIGHT=new Yne(1,1),Yne.DOWN=new Yne(0,1),Yne.DOWN_LEFT=new Yne(-1,1),Yne.LEFT=new Yne(-1,0),Yne.UP_LEFT=new Yne(-1,-1),Yne.factory=new(function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.apply(this,arguments)).all=[Yne.UP,Yne.UP_RIGHT,Yne.RIGHT,Yne.DOWN_RIGHT,Yne.DOWN,Yne.DOWN_LEFT,Yne.LEFT,Yne.UP_LEFT],e}return ip(n)}(Zne)),Yne.DIRECTIONS=Yne.factory.all,Yne.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return Z5("string"==typeof e,"Invalid encoded direction"),Yne.factory.fromString(e).get()}}]),n}($ee));var Kne=function(e){qv(n,e);var t=Wv(n);function n(e,r){return np(this,n),t.call(this,e,r)}return ip(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}(jne);Kne.UP=new Kne(0,-1),Kne.RIGHT=new Kne(1,0),Kne.DOWN=new Kne(0,1),Kne.LEFT=new Kne(-1,0),Kne.factory=new(function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.apply(this,arguments)).all=[Kne.UP,Kne.RIGHT,Kne.DOWN,Kne.LEFT],e}return ip(n,[{key:"of",value:function(e,t){return 0===e&&-1===t?H5.success(Kne.UP):1===e&&0===t?H5.success(Kne.RIGHT):0===e&&1===t?H5.success(Kne.DOWN):-1===e&&0===t?H5.success(Kne.LEFT):H5.failure("Invalid orthogonal from x and y")}}]),n}(Zne)),Kne.ORTHOGONALS=Kne.factory.all,Kne.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return Z5("string"==typeof e,"Invalid encoded orthogonal"),Kne.factory.fromString(e).get()}}]),n}($ee));var Jne=function(){function e(t,n){np(this,e),this.x=t,this.y=n}return ip(e,[{key:"getNext",value:function(t,n){var r;return new e(this.x+(n=null!==(r=n)&&void 0!==r?r:1)*t.x,this.y+n*t.y)}},{key:"getPrevious",value:function(e,t){var n;return this.getNext(e,-(t=null!==(n=t)&&void 0!==n?n:1))}},{key:"getLeft",value:function(t){return new e(this.x+t.y,this.y+-t.x)}},{key:"getRight",value:function(t){return new e(this.x+-t.y,this.y+t.x)}},{key:"getOpposite",value:function(){return new e(-this.x,-this.y)}},{key:"isInRange",value:function(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}},{key:"isNotInRange",value:function(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}},{key:"getDirectionToward",value:function(e){return Yne.factory.fromMove(this,e)}},{key:"getOrthogonalDistance",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"getDistance",value:function(e){if(!e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");var t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}},{key:"isHexagonallyAlignedWith",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}},{key:"isAlignedWith",value:function(e){var t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}},{key:"getVectorToward",value:function(t){return new e(t.x-this.x,t.y-this.y)}},{key:"getMinimalVectorToward",value:function(e){return this.getVectorToward(e).toVector()}},{key:"getCoordsToward",value:function(e){if(e.equals(this))return[];if(!e.isAlignedWith(this))return[];for(var t=this.getDirectionToward(e).get(),n=this.getNext(t,1),r=[];!1===n.equals(e);)r.push(n),n=n.getNext(t,1);return r}},{key:"toVector",value:function(){for(var t=Math.abs(this.x),n=Math.abs(this.y),r=Math.max(t,n),i=this.x,a=this.y,o=2;o<=r;)i%o==0&&a%o==0?(i/=o,a/=o):o++;return new e(i,a)}},{key:"isBetween",value:function(e,t){var n=e.getMinimalVectorToward(this),r=t.getMinimalVectorToward(this);return n.equals(r.getOpposite())}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y}},{key:"compareTo",value:function(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}}],[{key:"numberEncoder",value:function(t,n){return jee.tuple([jee.numberEncoder(t),jee.numberEncoder(n)],function(e){return[e.x,e.y]},function(t){return new e(t[0],t[1])})}}]),e}();Jne.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"encode",value:function(e){return{x:e.x,y:e.y}}},{key:"decode",value:function(e){var t=e;return Z5(null!=t.x&&"number"==typeof t.x&&null!=t.y&&"number"==typeof t.y,"Invalid encoded coord"),new Jne(t.x,t.y)}}]),n}($ee));var Qne=Vv(5378),Xne=function(){var e=function(){function e(){np(this,e)}return ip(e,[{key:"infoMessage",value:function(e){this.message(e,"is-info")}},{key:"gameMessage",value:function(e){this.message(e,"is-warning")}},{key:"criticalMessage",value:function(e){this.message(e,"is-danger")}},{key:"message",value:function(e,t){(0,Qne.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:t,dismissible:!0})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ere=function(){var e=function(){function e(t){np(this,e),this.messageDisplayer=t,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.scores=cB.empty(),this.imagesLocation="assets/images/"}return ip(e,[{key:"message",value:function(e){this.messageDisplayer.gameMessage(e)}},{key:"cancelMove",value:function(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?$5.SUCCESS:(this.messageDisplayer.gameMessage(e),$5.failure(e))}},{key:"cancelMoveAttempt",value:function(){}},{key:"getPlayerClass",value:function(e){switch(e){case Zee.ZERO:return"player0";case Zee.ONE:return"player1";default:return iB.expectToBe(e,Zee.NONE),""}}},{key:"pass",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",j5.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name}));case 1:case"end":return t.stop()}},t)}))()}},{key:"getTurn",value:function(){return this.rules.node.gameState.turn}},{key:"getCurrentPlayer",value:function(){return this.rules.node.gameState.getCurrentPlayer()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"range",value:function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,t){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),tre=function(){var e,t=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getHexaCoordsBy",value:function(e,t){var n=new Jne(e,t);return this.getHexaCoordsAt(n)}},{key:"getHexaCoordsAt",value:function(e){var t,n="",r=this.hexaLayout.getHexaCoordsAt(e),i=Xv(r);try{for(i.s();!(t=i.n()).done;){var a=t.value;n+=a.x+" "+a.y+" "}}catch(o){i.e(o)}finally{i.f()}return n+=r[0].x+" "+r[0].y}},{key:"getCenterBy",value:function(e,t){var n=new Jne(e,t);return this.getCenterAt(n)}},{key:"getCenterAt",value:function(e){return this.hexaLayout.getCenterAt(e)}}]),n}(ere);return t.\u0275fac=function(n){return(e||(e=nk(t)))(n||t)},t.\u0275cmp=ty({type:t,selectors:[["ng-component"]],features:[HC],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),nre=function(){function e(t){np(this,e),this.value=t}return ip(e,[{key:"equals",value:function(e){return this===e}},{key:"is",value:function(e){return this.value===e.value}},{key:"isPlayer",value:function(){return this===e.ZERO||this===e.ONE}}],[{key:"from",value:function(t){switch(t){case e.ZERO.value:return e.ZERO;case e.ONE.value:return e.ONE;case e.EMPTY.value:return e.EMPTY;case e.NONE.value:return e.NONE;default:throw new Error("FourStatePiece has no value matching "+t)}}},{key:"ofPlayer",value:function(t){switch(t){case Zee.ZERO:return e.ZERO;case Zee.ONE:return e.ONE;default:throw new Error("FourStatePiece.ofPlayer can only be called with Player.ZERO and Player.ONE.")}}}]),e}();nre.ZERO=new nre(Zee.ZERO.value),nre.ONE=new nre(Zee.ONE.value),nre.EMPTY=new nre(Zee.NONE.value),nre.NONE=new nre(3);var rre=function(e){qv(n,e);var t=Wv(n);function n(e,r){return np(this,n),t.call(this,e,r)}return ip(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}],[{key:"getAngle",value:function(e){switch(e){case n.UP:return 0;case n.UP_RIGHT:return 60;case n.RIGHT:return 120;case n.DOWN:return 180;case n.DOWN_LEFT:return 240;default:return iB.expectToBe(e,n.LEFT),300}}}]),n}(jne);rre.UP=new rre(0,-1),rre.LEFT=new rre(-1,0),rre.UP_RIGHT=new rre(1,-1),rre.DOWN_LEFT=new rre(-1,1),rre.RIGHT=new rre(1,0),rre.DOWN=new rre(0,1),rre.factory=new(function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.apply(this,arguments)).all=[rre.UP,rre.UP_RIGHT,rre.RIGHT,rre.DOWN,rre.DOWN_LEFT,rre.LEFT],e}return ip(n)}(Zne)),rre.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){switch(e){case rre.UP:return 0;case rre.UP_RIGHT:return 1;case rre.RIGHT:return 2;case rre.DOWN:return 3;case rre.DOWN_LEFT:return 4;default:return 5}}},{key:"decodeNumber",value:function(e){return Z5(0<=e&&e<=5,"Invalid encoded number for HexaDirection "+e),rre.factory.all[e]}}]),n}(jee));var ire=function(){function e(t,n,r){np(this,e),this.size=t,this.origin=n,this.orientation=r}return ip(e,[{key:"getCenterAt",value:function(e){var t=this.orientation.conversionMatrix;return new Jne(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}},{key:"getCornerOffset",value:function(e){var t=2*Math.PI*(this.orientation.startAngle+e)/6;return new Jne(this.size*Math.cos(t),this.size*Math.sin(t))}},{key:"getHexaCoordsAt",value:function(e){for(var t=this.getCenterAt(e),n=[],r=0;r<6;r+=1){var i=this.getCornerOffset(r);n.push(new Jne(t.x+i.x,t.y+i.y))}return n}}]),e}(),are=ip(function e(){np(this,e)}),ore=function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.call(this)).startAngle=.5,e.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],e.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3],e}return ip(n)}(are);ore.INSTANCE=new ore;var sre=function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.call(this)).startAngle=0,e.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],e.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3],e}return ip(n,[{key:"isOnBorder",value:function(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}},{key:"isOnTopRightBorder",value:function(e,t){return 0===t.y}},{key:"isOnRightBorder",value:function(e,t){return t.x===e.width-1}},{key:"isOnLeftBorder",value:function(e,t){return 0===t.x}},{key:"isOnBottomLeftBorder",value:function(e,t){return t.y===e.height-1}},{key:"isOnTopLeftBorder",value:function(e,t){return null!=e.excludedCases[t.y]?t.x===e.excludedCases[t.y]:t.y===e.excludedCases.length&&0===t.x}},{key:"isOnBottomRightBorder",value:function(e,t){return null!=e.excludedCases[e.height-1-t.y]?e.width-1-t.x===e.excludedCases[e.height-1-t.y]:e.height-1-t.y===e.excludedCases.length&&t.x===e.width-1}},{key:"getAllBorders",value:function(e){var t=this,n=[];return e.forEachCoord(function(r,i){t.isOnBorder(e,r)&&n.push(r)}),n}},{key:"isTopCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}},{key:"isTopLeftCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isTopRightCorner",value:function(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}},{key:"isBottomCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}},{key:"isBottomLeftCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isBottomRightCorner",value:function(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}]),n}(are);sre.INSTANCE=new sre;var ure=function(){var e=ip(function e(){np(this,e)});return e.CANNOT_CHOOSE_OPPONENT_PIECE=function(){return $localize(b||(b=Nv(["You cannot pick a piece of the opponent."])))},e.MUST_CLICK_ON_EMPTY_SPACE=function(){return $localize(E||(E=Nv(["You must click on an empty space."])))},e.CANNOT_SELF_CAPTURE=function(){return $localize(S||(S=Nv(["Your landing space should be empty or contain a piece of the opponent."])))},e.MUST_CHOOSE_PLAYER_PIECE=function(){return $localize(P||(P=Nv(["You must pick one of your pieces."])))},e.CANNOT_PASS=function(){return $localize(O||(O=Nv(["You cannot pass your turn."])))},e.MUST_LAND_ON_EMPTY_SPACE=function(){return $localize(T||(T=Nv(["You must drop your piece on an empty space."])))},e.MUST_PASS=function(){return $localize(I||(I=Nv(["You must pass your turn."])))},e.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=function(){return $localize(x||(x=Nv(["You have selected an empty space, you must select one of your own pieces."])))},e.MOVE_CANNOT_BE_STATIC=function(){return $localize(A||(A=Nv(["You must choose different starting and ending coordinates."])))},e}(),cre=function(){function e(t,n){np(this,e),this.ruler=t,this.name=n}return ip(e,[{key:"toString",value:function(){return this.name}}]),e}(),lre=function(){function e(t){np(this,e),this.value=t}return ip(e,[{key:"toString",value:function(){return""+this.value}}],[{key:"fromWinner",value:function(t){return new e(t===Zee.NONE?0:t.getVictoryValue())}}]),e}(),hre=function(){function e(){np(this,e)}return ip(e,null,[{key:"toComparableObjectSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return t.equals(e)})||t.push(e)}),t}},{key:"toComparableSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return uB(t,e)})||t.push(e)}),t}}]),e}(),fre=function(e){function t(e){np(this,t),this.values=void 0===e?[]:hre.toComparableSet(e)}return ip(t,[{key:"equals",value:function(e){if(e.size()!==this.size())return!1;var t,n=Xv(this);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===e.contains(r))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"toString",value:function(){var e,t="",n=Xv(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t+=null==r?"null, ":r.toString()+", "}}catch(i){n.e(i)}finally{n.f()}return"["+t.slice(0,-2)+"]"}},{key:"add",value:function(e){return!this.contains(e)&&(this.values.push(e),!0)}},{key:"union",value:function(e){var t,n=Xv(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"contains",value:function(e){var t,n=Xv(this.values);try{for(n.s();!(t=n.n()).done;){if(uB(t.value,e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"size",value:function(){return this.values.length}},{key:"toList",value:function(){var e,t=[],n=Xv(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"getAnyElement",value:function(){return this.size()>0?cB.of(this.values[0]):cB.empty()}},{key:Symbol.iterator,value:function(){return this.values.values()}}]),t}(),dre=function(){function e(t){np(this,e),this.turn=t}return ip(e,[{key:"getCurrentPlayer",value:function(){return Zee.fromTurn(this.turn)}},{key:"getCurrentOpponent",value:function(){return this.turn%2==1?Zee.ZERO:Zee.ONE}}]),e}(),vre=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this,r)).board=e,i}return ip(n,[{key:"getPieceAt",value:function(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}},{key:"isOnBoard",value:function(e){return e.isInRange(this.board[0].length,this.board.length)}},{key:"getPieceAtXY",value:function(e,t){return this.getPieceAt(new Jne(e,t))}},{key:"forEachCoord",value:function(e){var t,n=Xv(this.getCoordsAndContents());try{for(n.s();!(t=n.n()).done;){var r=Fv(t.value,2);e(r[0],r[1])}}catch(i){n.e(i)}finally{n.f()}}},{key:"getCoordsAndContents",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++){var r=new Jne(n,t);this.isOnBoard(r)&&e.push([r,this.getPieceAt(r)])}return e}},{key:"getCopiedBoard",value:function(){return Q5.copyBiArray(this.board)}}]),n}(dre),pre=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"isInBoard",value:function(e){return e.isInRange(9,9)&&this.getPieceAt(e)!==nre.NONE}},{key:"isPiece",value:function(e){return this.getPieceAt(e).isPlayer()}},{key:"getScores",value:function(){for(var e=[14,14],t=0;t<9;t++)for(var n=0;n<9;n++)this.getPieceAtXY(n,t)===nre.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===nre.ONE&&(e[0]=e[0]-1);return e}}],[{key:"getInitialState",value:function(){var e=nre.EMPTY,t=nre.NONE,r=nre.ZERO,i=nre.ONE;return new n([[t,t,t,t,i,i,i,i,i],[t,t,t,i,i,i,i,i,i],[t,t,e,e,i,i,i,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,r,r,r,e,e,t,t],[r,r,r,r,r,r,t,t,t],[r,r,r,r,r,t,t,t,t]],0)}}]),n}(vre),gre=ip(function e(){np(this,e)}),yre=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this)).coord=new Jne(e,r),i}return ip(n)}(gre),mre=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;if(np(this,n),(a=t.call(this,e.x,e.y)).dir=r,a.lastPiece=i,e.isNotInRange(9,9))throw new Error("Coord "+e.toString()+" out of range, invalid move!");return jv(a)}return ip(n,[{key:"toString",value:function(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}},{key:"isSingleCoord",value:function(){return this.lastPiece.isAbsent()}},{key:"equals",value:function(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}],[{key:"fromSingleCoord",value:function(e,t){try{return H5.success(new n(e,t,cB.empty()))}catch(r){return H5.failure(r.message)}}},{key:"fromDoubleCoord",value:function(e,t,r){var i=[e,t];Q5.sortByDescending(i,n.sortCoord);var a=i[1].getDirectionToward(i[0]).get(),o=rre.factory.fromDelta(a.x,a.y);if(o.isFailure())return H5.failure("Invalid direction");var s=o.get();return i[1].getDistance(i[0])>2?H5.failure("Distance between first coord and last coord is too great"):s.equals(r)?n.fromSingleCoord(i[1],r):s.getOpposite().equals(r)?n.fromSingleCoord(i[0],r):H5.success(new n(i[1],r,cB.of(i[0])))}},{key:"sortCoord",value:function(e){return 9*e.y+e.x}}]),n}(yre);mre.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"maxValue",value:function(){return 104831}},{key:"encodeNumber",value:function(e){var t=9*e.coord.x*8+8*e.coord.y+e.dir.toInt();if(e.isSingleCoord())return t;var n=e.lastPiece.get();return 9*n.x*2*9*9*8+2*n.y*9*9*8+648+t}},{key:"decodeNumber",value:function(e){var t=e%8;e=(e-t)/8;var n=rre.factory.fromInt(t).get(),r=e%9,i=(e=(e-r)/9)%9;e=(e-i)/9;var a=new Jne(i,r);if(0===e)return mre.fromSingleCoord(a,n).get();var o=(e=(e-1)/2)%9,s=(e=(e-o)/9)%9;e=(e-s)/9;var u=new Jne(s,o);return mre.fromDoubleCoord(a,u,n).get()}}]),n}(jee));var kre=(function(e){e.VICTORY="VICTORY",e.PRE_VICTORY="PRE_VICTORY",e.DEFAULT="DEFAULT"}(kre||(kre={})),kre),_re=function(){function e(){np(this,e),this.map=[],this.isImmutable=!1}return ip(e,[{key:"makeImmutable",value:function(){this.isImmutable=!0}},{key:"get",value:function(e){var t,n=Xv(this.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(uB(r.key,e))return cB.of(r.value)}}catch(i){n.e(i)}finally{n.f()}return cB.empty()}},{key:"forEach",value:function(e){for(var t=0;t<this.map.length;t++)e(this.getByIndex(t))}},{key:"getByIndex",value:function(e){return this.map[e]}},{key:"putAll",value:function(e){this.checkImmutability("putAll");var t,n=Xv(e.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.put(r.key,r.value)}}catch(i){n.e(i)}finally{n.f()}}},{key:"checkImmutability",value:function(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}},{key:"put",value:function(e,t){this.checkImmutability("put");var n,r=Xv(this.map);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(uB(i.key,e)){var a=i.value;return i.value=t,cB.of(a)}}}catch(o){r.e(o)}finally{r.f()}return this.map.push({key:e,value:t}),cB.empty()}},{key:"containsKey",value:function(e){return this.map.some(function(t){return uB(t.key,e)})}},{key:"size",value:function(){return this.map.length}},{key:"listKeys",value:function(){return this.map.map(function(e){return e.key})}},{key:"getKeySet",value:function(){return new fre(this.listKeys())}},{key:"filter",value:function(t){var n,r=new e,i=Xv(this.map);try{for(i.s();!(n=i.n()).done;){var a=n.value;t(a.key,a.value)&&r.set(a.key,a.value)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"replace",value:function(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}},{key:"set",value:function(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}},{key:"delete",value:function(e){this.checkImmutability("delete");for(var t=0;t<this.map.length;t++)if(uB(this.map[t].key,e)){var n=this.map[t].value,r=this.map.slice(0,t),i=this.map.slice(t+1);return this.map=r.concat(i),n}throw new Error('No Value to delete for key "'+e.toString()+'"!')}},{key:"getCopy",value:function(){var e,t=new this.constructor,n=Xv(this.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value;t.set(r,this.get(r).get())}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"equals",value:function(e){var t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;var r,i=Xv(t);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=this.get(a).get(),s=e.get(a);if(Z5(s.isPresent(),"value is absent in a map even though its key is present!"),!1===uB(o,s.get()))return!1}}catch(u){i.e(u)}finally{i.f()}return!0}}]),e}(),wre=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"reverse",value:function(){var e,t=new n,r=Xv(this.listKeys());try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.get(i).get();if(t.containsKey(a))t.get(a).get().add(i);else{var o=new fre;o.add(i),t.set(a,o)}}}catch(s){r.e(s)}finally{r.f()}return t}}]),n}(_re),Cre=function(){var e=ip(function e(){np(this,e)});return e.createdNodes=0,e.minimaxTime=0,e}(),bre=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cB.empty(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:cB.empty(),i=arguments.length>3?arguments[3]:void 0;if(np(this,e),this.gameState=t,this.mother=n,this.move=r,this.minimaxCreator=i,this.childs=cB.empty(),this.hopedValue=new _re,this.ownValue=new _re,this.possibleMoves=new _re,this.ownValue=new _re,null!=i){var a=i.getBoardValue(this);this.ownValue.set(i.name,a),this.hopedValue.set(i.name,a.value)}Cre.createdNodes++,aB(e.VERBOSE||!1,"creating "+this.myToString())}return ip(e,[{key:"findBestMove",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=(new Date).getTime(),a=this.alphaBeta(e,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,t,n,r);a.gameState.turn>this.gameState.turn+1;)a=a.mother.get(),e--;return Cre.minimaxTime+=(new Date).getTime()-i,a.move.get()}},{key:"alphaBeta",value:function(t,n,r,i,a,o){if(t<1)return aB(e.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+t),this;if(i.ruler.getGameStatus(this).isEndGame)return aB(e.VERBOSE||!1,"isLeaf-EndGame("+e.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+t),this;var s=this.getPossibleMoves(i);Z5(s.length>0,"Minimax "+i.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=cB.of([]));var u,c,l=[],h=this.gameState.getCurrentPlayer(),f=h===Zee.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,d=h===Zee.ZERO?function(e,t){return e<t}:function(e,t){return e>t},v=Xv(s);try{for(v.s();!(u=v.n()).done;){var p=u.value,g=this.getOrCreateChild(p,i).alphaBeta(t-1,n,r,i,a,o),y=g.getHopedValue(i);if(d(y,f)||0===l.length?(f=y,l=[g]):y===f&&l.push(g),o&&d(f,h===Zee.ZERO?n:r))break;h===Zee.ZERO?r=Math.min(f,r):n=Math.max(f,n)}}catch(k){v.e(k)}finally{v.f()}var m=(c=a?l[Math.floor(Math.random()*l.length)]:l[0]).hopedValue.get(i.toString()).get();return this.hopedValue.put(i.toString(),m),c}},{key:"getPossibleMoves",value:function(e){var t=this.possibleMoves.get(e.name);if(t.isAbsent()){var n=e.getListMoves(this);return this.possibleMoves.set(e.name,new fre(n)),n}return t.get().toList()}},{key:"getOrCreateChild",value:function(t,n){var r=this.getSonByMove(t);if(r.isAbsent()){var i=n.ruler.isLegal(t,this.gameState);Z5(i.isSuccess(),"The minimax has accepted an illegal move, this should not happen.");var a=n.ruler.applyLegalMove(t,this.gameState,i.get());r=cB.of(new e(a,cB.of(this),cB.of(t),n)),this.childs.get().push(r.get())}return r.get()}},{key:"getSonByMove",value:function(e){Z5(this.childs.isPresent(),"Cannot get son of uncalculated node");var t,n=Xv(this.childs.get());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.move.isPresent()&&r.move.equalsValue(e))return cB.of(r)}}catch(i){n.e(i)}finally{n.f()}return cB.empty()}},{key:"getInitialNode",value:function(){for(var e=this;e.mother.isPresent();)e=e.mother.get();return e}},{key:"getHopedValue",value:function(e){return this.hopedValue.get(e.name).get()}},{key:"getOwnValue",value:function(e){var t=this.ownValue.get(e.name);if(t.isAbsent()){var n=e.getBoardValue(this);return this.ownValue.set(e.name,n),n}return t.get()}},{key:"myToString",value:function(){var e="",t=this;if(t.mother.isAbsent())return"NodeInitial: "+t.gameState.turn;for(;t.mother.isPresent();)e=(t.move.isAbsent()?" ":" > "+t.move.get().toString()+"> ")+t.gameState.turn+" "+e,t=t.mother.get();return"Node: "+e}},{key:"hasMoves",value:function(){return this.childs.isPresent()}},{key:"countDescendants",value:function(){if(this.childs.isAbsent())return 0;var e,t=this.childs.get().length,n=Xv(this.childs.get());try{for(n.s();!(e=n.n()).done;){t+=e.value.countDescendants()}}catch(r){n.e(r)}finally{n.f()}return t}}],[{key:"getScoreStatus",value:function(t){var n=!1;return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER?(aB(e.VERBOSE||n,"VICTORY"),kre.VICTORY):t===Number.MIN_SAFE_INTEGER+1?(aB(e.VERBOSE||n,"PRE_VICTORY_MIN"),kre.PRE_VICTORY):t===Number.MAX_SAFE_INTEGER-1?(aB(e.VERBOSE||n,"PRE_VICTORY_MAX"),kre.PRE_VICTORY):(aB(e.VERBOSE||n,"DEFAULT"),kre.DEFAULT)}}]),e}();bre.VERBOSE=!1,bre.minimaxes=new _re;var Ere=function(){function e(t,n){np(this,e),this.isEndGame=t,this.winner=n}return ip(e,[{key:"toBoardValue",value:function(){return this.winner!==Zee.NONE?this.winner.getVictoryValue():0}}],[{key:"getVictory",value:function(t){return Z5(t!==Zee.NONE,"getVictory called with Player.NONE"),t===Zee.ZERO?e.ZERO_WON:e.ONE_WON}},{key:"getDefeat",value:function(t){return Z5(t!==Zee.NONE,"getVictory called with Player.NONE"),t===Zee.ZERO?e.ONE_WON:e.ZERO_WON}}]),e}();Ere.ZERO_WON=new Ere(!0,Zee.ZERO),Ere.ONE_WON=new Ere(!0,Zee.ONE),Ere.DRAW=new Ere(!0,Zee.NONE),Ere.ONGOING=new Ere(!1,Zee.NONE);var Sre=function(){function e(t){np(this,e),this.stateType=t,this.setInitialBoard()}return ip(e,[{key:"choose",value:function(e){var t=!1;aB(t,"Rules.choose: "+e.toString()+" was proposed");var n=this.isLegal(e,this.node.gameState);if(this.node.hasMoves()){aB(t,"Rules.choose: current node has moves");var r=this.node.getSonByMove(e);if(r.isPresent())return Z5(n.isSuccess(),"Rules.choose: Move is illegal: "+n.getReasonOr("")),aB(t,"Rules.choose: and this proposed move is found in the list, so it is legal"),this.node=r.get(),!0}if(aB(t,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),n.isFailure())return aB(t,"Rules.choose: Move is illegal: "+n.getReason()),!1;aB(t,"Rules.choose: Move is legal, let's apply it");var i=this.applyLegalMove(e,this.node.gameState,n.get()),a=new bre(i,cB.of(this.node),cB.of(e));return this.node=a,!0}},{key:"setInitialBoard",value:function(){if(null==this.node){var e=this.stateType.getInitialState();bre.ruler=this,this.node=new bre(e)}else this.node=this.node.getInitialNode()}},{key:"applyMoves",value:function(e,t,n){var r,i=0,a=Xv(e);try{for(a.s();!(r=a.n()).done;){var o=n(r.value),s=this.isLegal(o,t);Z5(s.isSuccess(),"Can't create state from invalid moves ("+i+"): "+s.toString()+"."),t=this.applyLegalMove(o,t,s.get()),i++}}catch(u){a.e(u)}finally{a.f()}return t}}]),e}(),Pre=function(){var e=ip(function e(){np(this,e)});return e.CANNOT_MOVE_MORE_THAN_THREE_PIECES=function(){return $localize(R||(R=Nv(["You cannot move more than 3 of your pieces!"])))},e.NOT_ENOUGH_PIECE_TO_PUSH=function(){return $localize(N||(N=Nv(["You don't have enough pieces to push that group!"])))},e.CANNOT_PUSH_YOUR_OWN_PIECES=function(){return $localize(M||(M=Nv(["You cannot push this piece because it is blocked by one of yours!"])))},e.MUST_ONLY_TRANSLATE_YOUR_PIECES=function(){return $localize(D||(D=Nv(["This line contains pieces of your opponent or empty spaces, which is forbidden."])))},e.TRANSLATION_IMPOSSIBLE=function(){return $localize(L||(L=Nv(["This move is impossible, some landing spaces are occupied."])))},e.LINE_AND_COORD_NOT_ALIGNED=function(){return $localize(F||(F=Nv(["This space is not aligned with the current line."])))},e}(),Ore=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"applyLegalMove",value:function(e,t,n){return new pre(n,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=this.getFirstPieceValidity(e,t);return r.isFailure()?r.toFailedFallible():e.isSingleCoord()?n.isLegalPush(e,t):n.isLegalSideStep(e,t)}},{key:"getFirstPieceValidity",value:function(e,t){var n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?$5.failure(ure.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===nre.ofPlayer(t.getCurrentOpponent())?$5.failure(ure.CANNOT_CHOOSE_OPPONENT_PIECE()):$5.SUCCESS}},{key:"isLegalPush",value:function(e,t){var r=1,i=e.coord.getNext(e.dir),a=nre.ofPlayer(t.getCurrentPlayer()),o=nre.EMPTY,s=t.getCopiedBoard();for(s[e.coord.y][e.coord.x]=o;r<=3&&t.isOnBoard(i)&&t.getPieceAt(i)===a;)r++,i=i.getNext(e.dir);return r>3?H5.failure(Pre.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===t.isInBoard(i)||(s[i.y][i.x]=a,t.getPieceAt(i)===o)?H5.success(s):n.isLegalRealPush(i,e,t,r,s)}},{key:"isLegalRealPush",value:function(e,t,n,r,i){for(var a=0,o=nre.ofPlayer(n.getCurrentOpponent()),s=nre.ofPlayer(n.getCurrentPlayer());a<r&&n.isOnBoard(e)&&n.getPieceAt(e)===o;)a++,e=e.getNext(t.dir);return a>=r?H5.failure(Pre.NOT_ENOUGH_PIECE_TO_PUSH()):e.isInRange(9,9)&&(n.getPieceAt(e)===nre.EMPTY&&(i[e.y][e.x]=o),n.getPieceAt(e)===s)?H5.failure(Pre.CANNOT_PUSH_YOUR_OWN_PIECES()):H5.success(i)}},{key:"isLegalSideStep",value:function(e,t){var n=e.lastPiece.get(),r=e.coord.getDirectionToward(n).get();n=n.getNext(r);for(var i=e.coord,a=nre.ofPlayer(t.getCurrentPlayer()),o=t.getCopiedBoard();!1===i.equals(n)&&i.isInRange(9,9);){if(t.getPieceAt(i)!==a)return H5.failure(Pre.MUST_ONLY_TRANSLATE_YOUR_PIECES());var s=i.getNext(e.dir);if(o[i.y][i.x]=nre.EMPTY,s.isInRange(9,9)){if(t.isPiece(s))return H5.failure(Pre.TRANSLATION_IMPOSSIBLE());t.getPieceAt(s)===nre.EMPTY&&(o[s.y][s.x]=a)}i=i.getNext(r)}return H5.success(o)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getScores();return t[0]>5?Ere.ZERO_WON:t[1]>5?Ere.ONE_WON:Ere.ONGOING}}]),n}(Sre),Tre=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<9;i++)for(var a=0;a<9;a++){var o=new Jne(a,i);if(!1!==n.getPieceAt(o).is(r)){var s,u=Xv(rre.factory.all);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=mre.fromSingleCoord(o,c).get();if(this.isAcceptablePush(l,n)){t.push(l);var h,f=Xv(rre.factory.all);try{for(f.s();!(h=f.n()).done;)for(var d=h.value,v=1;v<=2&&!d.equals(c);v++){var p=o.getNext(d,v);if(!p.isInRange(9,9))break;var g=mre.fromDoubleCoord(o,p,c).get();Ore.isLegal(g,n).isSuccess()&&t.push(g)}}catch(y){f.e(y)}finally{f.f()}}}}catch(y){u.e(y)}finally{u.f()}}}return new fre(t).toList()}},{key:"isAcceptablePush",value:function(e,t){var n=t.getScores(),r=Ore.isLegal(e,t);if(r.isSuccess()){var i=t.getCurrentOpponent().value;return!(new pre(r.get(),t.turn+1).getScores()[i]>n[i])}return!1}},{key:"getBoardValue",value:function(e){var t=Ore.getGameStatus(e);if(t.isEndGame)return new lre(t.toBoardValue());var n=e.gameState.getScores();return new lre(n[1]-n[0])}}]),n}(cre),Ire=function(){function e(t,n,r){np(this,e),this.title=t,this.instruction=n,this.state=r,this.previousMove=cB.empty()}return ip(e,[{key:"isMove",value:function(){return!1}},{key:"isAnyMove",value:function(){return!1}},{key:"isClick",value:function(){return!1}},{key:"isPredicate",value:function(){return!1}},{key:"isInformation",value:function(){return!1}},{key:"hasSolution",value:function(){return!1}},{key:"withPreviousMove",value:function(e){return this.previousMove=cB.of(e),this}}],[{key:"fromMove",value:function(e,t,n,r,i,a){return new Are(e,t,n,r,i,a)}},{key:"forClick",value:function(e,t,n,r,i,a){return new Nre(e,t,n,r,i,a)}},{key:"anyMove",value:function(e,t,n,r,i){return new Rre(e,t,n,r,i)}},{key:"fromPredicate",value:function(e,t,n,r,i,a){return new Mre(e,t,n,r,i,a)}},{key:"informational",value:function(e,t,n){return new Dre(e,t,n)}}]),e}(),xre=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o){var s;return np(this,n),(s=t.call(this,e,r,i)).solution=a,s.successMessage=o,s}return ip(n,[{key:"hasSolution",value:function(){return!0}},{key:"getSolution",value:function(){return this.solution}},{key:"getSuccessMessage",value:function(){return this.successMessage}}]),n}(Ire),Are=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o,s){var u;return np(this,n),(u=t.call(this,e,r,i,a[0],o)).acceptedMoves=a,u.failureMessage=s,Z5(a.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational"),u}return ip(n,[{key:"isMove",value:function(){return!0}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(xre),Rre=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o){return np(this,n),t.call(this,e,r,i,a,o)}return ip(n,[{key:"isAnyMove",value:function(){return!0}}]),n}(xre),Nre=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o,s){var u;return np(this,n),(u=t.call(this,e,r,i)).acceptedClicks=a,u.successMessage=o,u.failureMessage=s,u}return ip(n,[{key:"isClick",value:function(){return!0}},{key:"getSuccessMessage",value:function(){return this.successMessage}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(Ire),Mre=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o,s){var u;return np(this,n),(u=t.call(this,e,r,i,a,s)).predicate=o,u}return ip(n,[{key:"isPredicate",value:function(){return!0}}]),n}(xre),Dre=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"isInformation",value:function(){return!0}}]),n}(Ire),Lre=nre.EMPTY,Fre=nre.NONE,Bre=nre.ZERO,Vre=nre.ONE,Ure=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(B||(B=Nv(["Initial board and goal of the game"]))),$localize(V||(V=Nv(["At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!"]))),pre.getInitialState()),Ire.anyMove($localize(U||(U=Nv(["Moving a piece"]))),$localize(z||(z=Nv(["At each turn, move one, two, or three pieces either along their line, or on their side.\n        For your moves you can therefore choose between up to 6 directions.\n        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).\n        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>\n        You're playing Dark, make any move!"]))),pre.getInitialState(),mre.fromSingleCoord(new Jne(2,6),rre.UP).get(),$localize(H||(H=Nv(["Congratulations!"])))),Ire.fromMove($localize(G||(G=Nv(["Pushing"]))),$localize(q||(q=Nv(["To push one opponent piece, you must move at least two of your pieces.\n        To push two opponent pieces, you must move three of your pieces.\n        If one of your pieces is in the way, it will be impossible to push.\n        You cannot move more than three pieces.<br/><br/>\n        Only one push towards the right is possible here, find it. (You're playing Dark)."]))),new pre([[Fre,Fre,Fre,Fre,Lre,Bre,Bre,Vre,Vre],[Fre,Fre,Fre,Lre,Lre,Lre,Lre,Lre,Lre],[Fre,Fre,Lre,Bre,Bre,Bre,Vre,Bre,Lre],[Fre,Lre,Lre,Lre,Lre,Lre,Lre,Lre,Lre],[Lre,Lre,Lre,Lre,Bre,Bre,Bre,Vre,Vre],[Lre,Lre,Lre,Lre,Lre,Lre,Lre,Lre,Fre],[Lre,Lre,Lre,Lre,Bre,Vre,Lre,Fre,Fre],[Lre,Lre,Lre,Bre,Lre,Lre,Fre,Fre,Fre],[Lre,Lre,Bre,Lre,Lre,Fre,Fre,Fre,Fre]],0),[mre.fromSingleCoord(new Jne(4,4),rre.RIGHT).get()],$localize($||($=Nv(["Congratulations! You know everything you need to start a game!"]))),$localize(W||(W=Nv(["Failed!"]))))]});function zre(e,t){if(1&e){var n=gb();wm(),hb(0,"circle",6),kb("click",function(){Wy(n);var e=Cb(2).index,t=Cb().index;return Cb().onPieceClick(e,t)}),fb()}if(2&e){var r=Cb(2).index,i=Cb().index,a=Cb();Eb("id","piece_",r,"_",i,""),cb("ngClass",a.getPieceClasses(r,i)),nb("cx",a.getCenterBy(r,i).x)("cy",a.getCenterBy(r,i).y)("r",.5*a.SPACE_SIZE)}}function Hre(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"polyline",4),kb("click",function(){Wy(n);var e=Cb().index,t=Cb().index;return Cb().onCaseClick(e,t)}),fb(),ob(2,zre,1,6,"circle",5),fb()}if(2&e){var r=Cb(),i=r.index,a=r.$implicit,o=Cb().index,s=Cb();Ow(1),Eb("id","case_",i,"_",o,""),cb("ngClass",s.getSquareClasses(i,o)),nb("points",s.getHexaCoordsBy(i,o)),Ow(1),cb("ngIf",s.isPiece(a))}}function Gre(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,Hre,3,5,"g",3),fb()),2&e){var n=t.$implicit,r=Cb(2);Ow(1),cb("ngIf",r.isBoard(n))}}function qre(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,Gre,2,1,"g",1),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}function $re(e,t){1&e&&(wm(),hb(0,"marker",7),db(1,"polygon",8),fb()),2&e&&bb("id","arrowhead_",t.$implicit.dir.toString(),"")}function Wre(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),db(1,"line",9),hb(2,"line",10),kb("click",function(){var e=Wy(n).$implicit;return Cb().chooseDirection(e.dir)}),fb(),hb(3,"polygon",11),kb("click",function(){var e=Wy(n).$implicit;return Cb().chooseDirection(e.dir)}),fb(),fb()}if(2&e){var r=t.$implicit;Ow(1),bb("id","line_start_",r.dir.toString(),""),nb("x1",r.startCenter.x)("y1",r.startCenter.y)("x2",r.middle.x)("y2",r.middle.y),Ow(1),bb("id","line_end_",r.dir.toString(),""),nb("x1",r.middle.x)("y1",r.middle.y)("x2",r.landingCenter.x)("y2",r.landingCenter.y),Ow(1),bb("id","direction_",r.dir.toString(),""),nb("transform",r.transformation)}}var jre=ip(function e(t,n,r,i,a,o){np(this,e),this.startCenter=t,this.middle=n,this.landingCenter=r,this.landing=i,this.dir=a,this.transformation=o}),Zre=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).moveds=[],r.directions=[],r.selecteds=[],r.rules=new Ore(pre),r.availableMinimaxes=[new Tre(r.rules,"Dummy")],r.encoder=mre.encoder,r.tutorial=(new Ure).tutorial,r.scores=cB.of([0,0]),r.SPACE_SIZE=30,r.hexaLayout=new ire(r.SPACE_SIZE,new Jne(-8*r.SPACE_SIZE,2*r.SPACE_SIZE),ore.INSTANCE),r.updateBoard(),r}return ip(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.hexaBoard=this.rules.node.gameState.getCopiedBoard(),this.scores=cB.of(this.rules.node.gameState.getScores())}},{key:"hidePreviousMove",value:function(){this.moveds=[]}},{key:"cancelMoveAttempt",value:function(){this.directions=[],this.selecteds=[]}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get();e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}},{key:"showPushingMove",value:function(e){var t=this.rules.node.mother.get().gameState,n=e.coord;for(this.moveds=[n],n=n.getNext(e.dir);n.isInRange(9,9)&&t.isPiece(n);)this.moveds.push(n),n=n.getNext(e.dir);n.isInRange(9,9)&&this.moveds.push(n)}},{key:"showSideStepMove",value:function(e){var t=e.lastPiece.get(),n=e.coord.getDirectionToward(t).get();t=t.getNext(n);for(var r=e.coord;!1===r.equals(t);)this.moveds.push(r),this.moveds.push(r.getNext(e.dir)),r=r.getNext(n)}},{key:"onPieceClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#piece_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=n.rules.node.gameState.getCurrentOpponent(),r.abrupt("return",n.hexaBoard[t][e].is(a)?n.opponentClick(e,t):0===n.selecteds.length?n.firstClick(e,t):1===n.selecteds.length?n.secondClick(e,t):n.thirdClick(e,t));case 5:case"end":return r.stop()}},r)}))()}},{key:"opponentClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.tryChoosingDirection(e,t);case 2:if(!r.sent.isSuccess()){r.next=6;break}r.t0=$5.SUCCESS,r.next=7;break;case 6:r.t0=n.cancelMove(ure.CANNOT_CHOOSE_OPPONENT_PIECE());case 7:return r.abrupt("return",r.t0);case 8:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.selecteds=[new Jne(e,t)],n.showPossibleDirections(),$5.SUCCESS));case 1:case"end":return r.stop()}},r)}))()}},{key:"showPossibleDirections",value:function(){this.directions=[],this.showDirection(1===this.selecteds.length)}},{key:"showDirection",value:function(e){var t,n=this.rules.node.gameState,r=nre.ofPlayer(n.getCurrentPlayer()),i=this.selecteds[0],a=this.selecteds[this.selecteds.length-1],o=Xv(rre.factory.all);try{for(o.s();!(t=o.n()).done;){var s,u=t.value,c=i.getNext(u,1);if(n.isOnBoard(c)&&n.getPieceAt(c)===r){if(e)continue;if(c=a.getNext(u,1),n.isOnBoard(c)&&n.getPieceAt(c)===r)continue}if(s=e?mre.fromSingleCoord(i,u).get():mre.fromDoubleCoord(i,a,u).get(),this.rules.isLegal(s,n).isSuccess()){var l=this.getCenterAt(i),h=this.getCenterAt(c),f=this.getMiddleOfArrow(u,c,h),d=h.x+" "+h.y,v=rre.getAngle(u)+150,p=new jre(l,f,h,c,u,"rotate("+v+" "+d+") translate("+d+")");this.directions.push(p)}}}catch(g){o.e(g)}finally{o.f()}}},{key:"getMiddleOfArrow",value:function(e,t,n){var r=t.getPrevious(e),i=this.getCenterAt(r);return new Jne(i.x+(n.x-i.x)/2,i.y+(n.y-i.y)/2)}},{key:"isBoard",value:function(e){return e!==nre.NONE}},{key:"isPiece",value:function(e){return e!==nre.EMPTY}},{key:"secondClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.selecteds[0],!(a=new Jne(e,t)).equals(i)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),$5.SUCCESS));case 3:if(!1!==a.isHexagonallyAlignedWith(i)){r.next=5;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 5:if(!((o=a.getDistance(i))>2)){r.next=8;break}return r.abrupt("return",n.cancelMove(Pre.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 8:for(s=i.getDirectionToward(a).get(),n.selecteds=[i],u=0;u<o;u++)n.selecteds.push(i.getNext(s,u+1));if(3!==n.selecteds.length){r.next=15;break}if(c=n.selecteds[1],l=n.rules.node.gameState.getCurrentPlayer(),!1!==n.hexaBoard[c.y][c.x].is(l)){r.next=15;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 15:return r.abrupt("return",(n.showPossibleDirections(),$5.SUCCESS));case 16:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new Jne(e,t),a=n.selecteds[0],!i.equals(a)){r.next=3;break}return r.abrupt("return",n.deselectExtremity(!0));case 3:return o=n.selecteds[n.selecteds.length-1],r.abrupt("return",i.equals(o)?n.deselectExtremity(!1):3===n.selecteds.length&&i.equals(n.selecteds[1])?(n.cancelMoveAttempt(),$5.SUCCESS):n.tryExtension(i,a,o));case 5:case"end":return r.stop()}},r)}))()}},{key:"tryExtension",value:function(e,t,n){var r=this;return rB(regeneratorRuntime.mark(function i(){var a,o,s,u,c;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=Yne.factory.fromMove(t,e)).isSuccess()){i.next=6;break}if(o=Yne.factory.fromMove(n,e),!a.equals(o)){i.next=6;break}return s=t.getDistance(e),u=n.getDistance(e),i.abrupt("return",2===Math.max(s,u)?(r.selecteds.push(e),Q5.sortByDescending(r.selecteds,mre.sortCoord),r.showPossibleDirections(),$5.SUCCESS):r.cancelMove(Pre.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 6:return c=r.cancelMove(Pre.LINE_AND_COORD_NOT_ALIGNED()),i.next=9,r.firstClick(e.x,e.y);case 9:return i.abrupt("return",c);case 10:case"end":return i.stop()}},i)}))()}},{key:"deselectExtremity",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.selecteds=t.selecteds.slice(e?1:0,e?void 0:-1),t.showPossibleDirections(),$5.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"chooseDirection",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#direction_"+e.toString()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t._chooseDirection(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"_chooseDirection",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.rules.node.gameState,a=t.selecteds[0],n.abrupt("return",(i=1===t.selecteds.length?mre.fromSingleCoord(a,e).get():mre.fromDoubleCoord(a,t.selecteds[t.selecteds.length-1],e).get(),t.chooseMove(i,r,t.scores.get())));case 3:case"end":return n.stop()}},n)}))()}},{key:"onCaseClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#case_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.tryChoosingDirection(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"tryChoosingDirection",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new Jne(e,t),a=Xv(n.directions),r.prev=2,a.s();case 4:if((o=a.n()).done){r.next=10;break}if(!(s=o.value).landing.equals(i)){r.next=8;break}return r.abrupt("return",n._chooseDirection(s.dir));case 8:r.next=4;break;case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(2),a.e(r.t0);case 15:return r.prev=15,a.f(),r.finish(15);case 18:return r.abrupt("return",$5.failure("not a direction"));case 19:case"end":return r.stop()}},r,null,[[2,12,15,18]])}))()}},{key:"getSquareClasses",value:function(e,t){var n=new Jne(e,t),r=[];return this.moveds.some(function(e){return e.equals(n)})&&r.push("moved"),r}},{key:"getPieceClasses",value:function(e,t){var n=new Jne(e,t),r=Zee.of(this.hexaBoard[t][e].value),i=[this.getPlayerClass(r)];return this.selecteds.some(function(e){return e.equals(n)})&&i.push("highlighted"),i}}]),n}(tre);return e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-abalone"]],features:[HC],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),ob(1,qre,2,1,"g",1),hb(2,"defs"),ob(3,$re,2,1,"marker",2),fb(),ob(4,Wre,4,12,"g",1),fb()),2&e&&(Ow(1),cb("ngForOf",t.hexaBoard),Ow(2),cb("ngForOf",t.directions),Ow(1),cb("ngForOf",t.directions))},directives:[NT,DT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Yre=function(){function e(t){np(this,e),this.x=t}return ip(e,[{key:"equals",value:function(e){return this.x===e.x}}],[{key:"from",value:function(t){switch(t){case 0:return e.ZERO;case 1:return e.ONE;case 2:return e.TWO;default:return Z5(3===t,"Invalid Apagos Coord "+t),e.THREE}}}]),e}();Yre.ZERO=new Yre(0),Yre.ONE=new Yre(1),Yre.TWO=new Yre(2),Yre.THREE=new Yre(3);var Kre=function(){var e=ip(function e(){np(this,e)});return e.PIECE_SHOULD_MOVE_DOWNWARD=function(){return $localize(j||(j=Nv(["Pieces should only move downward!"])))},e.CANNOT_LAND_ON_A_FULL_SQUARE=function(){return $localize(Z||(Z=Nv(["That square is already full, you cannot put a piece in it!"])))},e.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=function(){return $localize(Y||(Y=Nv(["You have no pieces in that square, select one that contains at least one of your pieces!"])))},e.NO_PIECE_REMAINING_TO_DROP=function(){return $localize(K||(K=Nv(["There are no remaining pieces of that color to drop!"])))},e.NO_POSSIBLE_TRANSFER_REMAINS=function(){return $localize(J||(J=Nv(["There is no possible transfer from that square!"])))},e}(),Jre=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this)).landing=e,a.piece=r,a.starting=i,a}return ip(n,[{key:"isDrop",value:function(){return this.piece.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}},{key:"equals",value:function(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}],[{key:"drop",value:function(e,t){return iB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(e)&&n.piece.equalsValue(t)&&n.starting.equals(cB.empty())}))}},{key:"transfer",value:function(e,t){if(e.x<=t.x)return H5.failure(Kre.PIECE_SHOULD_MOVE_DOWNWARD());var r=iB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(t)&&n.piece.equals(cB.empty())&&n.starting.equals(cB.of(e))}));return H5.success(r)}}]),n}(gre);Jre.ALL_MOVES=[new Jre(Yre.ZERO,cB.of(Zee.ZERO),cB.empty()),new Jre(Yre.ONE,cB.of(Zee.ZERO),cB.empty()),new Jre(Yre.TWO,cB.of(Zee.ZERO),cB.empty()),new Jre(Yre.THREE,cB.of(Zee.ZERO),cB.empty()),new Jre(Yre.ZERO,cB.of(Zee.ONE),cB.empty()),new Jre(Yre.ONE,cB.of(Zee.ONE),cB.empty()),new Jre(Yre.TWO,cB.of(Zee.ONE),cB.empty()),new Jre(Yre.THREE,cB.of(Zee.ONE),cB.empty()),new Jre(Yre.TWO,cB.empty(),cB.of(Yre.THREE)),new Jre(Yre.ONE,cB.empty(),cB.of(Yre.THREE)),new Jre(Yre.ZERO,cB.empty(),cB.of(Yre.THREE)),new Jre(Yre.ONE,cB.empty(),cB.of(Yre.TWO)),new Jre(Yre.ZERO,cB.empty(),cB.of(Yre.TWO)),new Jre(Yre.ZERO,cB.empty(),cB.of(Yre.ONE))],Jre.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"maxValue",value:function(){return Jre.ALL_MOVES.length}},{key:"encodeNumber",value:function(e){var t=Jre.ALL_MOVES.findIndex(function(t){return t.equals(e)});return Z5(t>=0,e.toString()+" is not part of possibles moves of Apagos!"),t}},{key:"decodeNumber",value:function(e){return Z5(e<Jre.ALL_MOVES.length,e+" is not a valid encoded number for ApagosMove decoder"),Jre.ALL_MOVES[e]}}]),n}(jee));var Qre=function(){function e(t){np(this,e),this.containing=t}return ip(e,[{key:"isFull",value:function(){return this.count(Zee.ZERO)+this.count(Zee.ONE)>=this.count(Zee.NONE)}},{key:"count",value:function(e){return this.containing.get(e).get()}},{key:"addPiece",value:function(t){Z5(t!==Zee.NONE,"should not call ApagosSquare.addPiece with Player.NONE");var n=this.count(Zee.ZERO),r=this.count(Zee.ONE),i=this.count(Zee.NONE);return t===Zee.ZERO?n++:r++,e.from(n,r,i).get()}},{key:"substractPiece",value:function(t){Z5(t!==Zee.NONE,"should not call ApagosSquare.addPiece with Player.NONE");var n=this.count(Zee.ZERO),r=this.count(Zee.ONE),i=this.count(Zee.NONE);return t===Zee.ZERO?n--:r--,e.from(n,r,i).get()}},{key:"getDominatingPlayer",value:function(){var e=this.count(Zee.ZERO),t=this.count(Zee.ONE);return e>t?Zee.ZERO:t>e?Zee.ONE:Zee.NONE}},{key:"equals",value:function(e){return this.containing.equals(e.containing)}}],[{key:"from",value:function(t,n,r){if(t+n>r)return H5.failure("invalid starting space");var i=new _re;i.set(Zee.ZERO,t),i.set(Zee.ONE,n),i.set(Zee.NONE,r),i.makeImmutable();var a=new e(i);return H5.success(a)}}]),e}(),Xre=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,e)).board=r,a.remaining=i,a.remaining.makeImmutable(),a}return ip(n,[{key:"getPieceAt",value:function(e){return this.board[e.x]}},{key:"updateAt",value:function(e,t){for(var r=[],i=0;i<4;i++)r.push(e.x===i?t:this.board[i]);var a=this.getRemainingCopy();return new n(this.turn,r,a)}},{key:"getRemainingCopy",value:function(){return this.remaining.getCopy()}},{key:"getRemaining",value:function(e){return this.remaining.get(e).get()}},{key:"equals",value:function(e){return this.turn===e.turn&&Q5.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}},{key:"fromRepresentation",value:function(e,t,r,i){for(var a=[],o=0;o<4;o++){var s=Qre.from(t[0][o],t[1][o],t[2][o]).get();a.push(s)}var u=new _re;return u.set(Zee.ZERO,r),u.set(Zee.ONE,i),new n(e,a,u)}}]),n}(dre);return e.PIECES_PER_PLAYER=10,e}(),eie=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=t.getRemainingCopy(),r=n.get(e.piece.get()).get();n.put(e.piece.get(),r-1);var i=new Xre(t.turn+1,t.board,n),a=e.piece.get(),o=i.getPieceAt(e.landing).addPiece(a);if(e.landing===Yre.THREE)return i.updateAt(e.landing,o);var s=Yre.from(e.landing.x+1),u=i.getPieceAt(s);return i.updateAt(e.landing,u).updateAt(s,o)}},{key:"applyLegalTransfer",value:function(e,t){var n=t.getCurrentPlayer(),r=e.starting.get(),i=t.getPieceAt(r).substractPiece(n),a=t.getPieceAt(e.landing).addPiece(n),o=t.updateAt(r,i);return o=o.updateAt(e.landing,a),new Xre(o.turn+1,o.board,o.remaining)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.landing).isFull()?H5.failure(Kre.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}},{key:"isLegalDrop",value:function(e,t){return t.getRemaining(e.piece.get())<=0?H5.failure(Kre.NO_PIECE_REMAINING_TO_DROP()):H5.success(void 0)}},{key:"isLegalSlideDown",value:function(e,t){var n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?H5.failure(Kre.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):H5.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=0;n<4;n++)if(!1===t.getPieceAt(Yre.from(n)).isFull())return Ere.ONGOING;var r=t.getPieceAt(Yre.THREE).getDominatingPlayer();return Ere.getVictory(r)}}],[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n(Xre)),bre.ruler=this.singleton,this.singleton}}]),n}(Sre),tie=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){var t=e.gameState;return Jre.ALL_MOVES.filter(function(e){return eie.get().isLegal(e,t).isSuccess()})}},{key:"getBoardValue",value:function(e){var t=eie.get().getGameStatus(e);if(t.isEndGame)return lre.fromWinner(t.winner);var n=e.gameState.board[3].getDominatingPlayer();return new lre(n.getScoreModifier())}}]),n}(cre),nie=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(Q||(Q=Nv(["Initial board and goal of the game"]))),$localize(X||(X=Nv(["At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!"]))),Xre.getInitialState()),Ire.anyMove($localize(ee||(ee=Nv(["Drop"]))),$localize(te||(te=Nv(["There are two kind of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right. You play Light.<br/><br/>Drop a piece on one of those three squares."]))),Xre.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),Jre.drop(Yre.ZERO,Zee.ZERO),$localize(ne||(ne=Nv(["Congratulations!"])))),Ire.fromPredicate($localize(re||(re=Nv(["Transfer"]))),$localize(ie||(ie=Nv(["The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from an higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!"]))),Xre.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),Jre.transfer(Yre.TWO,Yre.ZERO).get(),function(e,t){return e.isDrop()?$5.failure($localize(ae||(ae=Nv(["This move is a drop, please do a transfer!"])))):$5.SUCCESS},$localize(oe||(oe=Nv(["Congratulations!"])))),Ire.fromPredicate($localize(se||(se=Nv(["Victory"]))),$localize(ue||(ue=Nv(["When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!"]))),Xre.fromRepresentation(2,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),Jre.drop(Yre.TWO,Zee.ONE),function(e,t){return e.isDrop()?e.piece.equalsValue(Zee.ONE)?$5.SUCCESS:$5.failure($localize(ce||(ce=Nv(["You actively made your opponent win!"])))):$5.failure($localize(le||(le=Nv(["Wrong choice, your opponent will win in the next turn no matter which piece is dropped!"]))))},$localize(he||(he=Nv(["Congratulations!"]))))]});function rie(e,t){if(1&e&&(wm(),db(0,"circle",5)),2&e){var n=t.$implicit,r=Cb();nb("cx",(n+1)*r.PIECE_RADIUS)("cy",r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function iie(e,t){if(1&e){var n=gb();wm(),hb(0,"polygon",7),kb("click",function(){Wy(n);var e=Cb().index,t=Cb();return t.onArrowClick(e,t.Player.ZERO)}),fb()}if(2&e){var r=Cb().index,i=Cb();bb("id","dropArrow_zero_",r,""),cb("ngClass",i.getArrowClasses(r,i.Player.ZERO)),nb("points",i.ARROW_COORD)("transform",i.getArrowTransform(r,i.Player.ZERO))}}function aie(e,t){if(1&e){var n=gb();wm(),hb(0,"polygon",7),kb("click",function(){Wy(n);var e=Cb().index,t=Cb();return t.onArrowClick(e,t.Player.ONE)}),fb()}if(2&e){var r=Cb().index,i=Cb();bb("id","dropArrow_one_",r,""),cb("ngClass",i.getArrowClasses(r,i.Player.ONE)),nb("points",i.ARROW_COORD)("transform",i.getArrowTransform(r,i.Player.ONE))}}function oie(e,t){if(1&e){var n=gb();wm(),vb(0),hb(1,"circle",8),kb("click",function(){Wy(n);var e=Cb().index;return Cb().onSquareClick(e)}),fb(),pb()}if(2&e){var r=t.$implicit,i=Cb(),a=i.index,o=i.$implicit,s=Cb();Ow(1),Sb("id","square_",a,"_piece_",r,"_out_of_",o.count(s.Player.NONE),""),cb("ngClass",s.getPieceClasses(a,r,o)),nb("cx",s.getCircleCenter(a,r,o).x)("cy",s.getCircleCenter(a,r,o).y)}}function sie(e,t){if(1&e){var n=gb();wm(),vb(0),ob(1,iie,1,4,"polygon",6),ob(2,aie,1,4,"polygon",6),hb(3,"rect",7),kb("click",function(){var e=Wy(n).index;return Cb().onSquareClick(e)}),fb(),ob(4,oie,2,6,"ng-container",3),pb()}if(2&e){var r=t.$implicit,i=t.index,a=Cb();Ow(1),cb("ngIf",a.canDisplayArrow(i,a.Player.ZERO)),Ow(1),cb("ngIf",a.canDisplayArrow(i,a.Player.ONE)),Ow(1),bb("id","square_",i,""),cb("ngClass",a.getSquareClasses(i)),nb("x",i*a.SPACE_SIZE)("y",(5-i)*a.SPACE_SIZE*.25)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Ow(1),cb("ngForOf",a.range(r.count(a.Player.NONE)))}}function uie(e,t){if(1&e&&(wm(),db(0,"circle",9)),2&e){var n=t.$implicit,r=Cb();nb("cx",4*r.SPACE_SIZE-(n+1)*r.PIECE_RADIUS)("cy",2.25*r.SPACE_SIZE+3*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}var cie=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).Player=Zee,r.ARROW_COORD=n.getArrowCoord(),r.PIECES_PER_PLAYER=Xre.PIECES_PER_PLAYER,r.selectedPiece=cB.empty(),r.leftPiece=cB.empty(),r.droppedPiece=cB.empty(),r.displayableArrow=[],r.rules=new eie(Xre),r.availableMinimaxes=[new tie(r.rules,"ApagosDummyMinimax")],r.encoder=Jre.encoder,r.tutorial=(new nie).tutorial,r.PIECE_RADIUS=200/(r.PIECES_PER_PLAYER+1),r.updateBoard(),r}return ip(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=cB.empty(),this.showPossibleDrops()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.board,this.remainingZero=e.remaining.get(Zee.ZERO).get(),this.remainingOne=e.remaining.get(Zee.ONE).get(),this.hideLastMove(),this.rules.node.move.isPresent()&&this.showLastMove(),this.showPossibleDrops()}},{key:"hideLastMove",value:function(){this.movedSquare=[],this.droppedPiece=cB.empty(),this.leftPiece=cB.empty(),this.selectedPiece=cB.empty()}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}},{key:"showLastDrop",value:function(e){var t=e.piece.get(),n=e.landing.x;this.movedSquare=[n],3!==e.landing.x&&(n+=1,this.movedSquare.push(n));var r=this.getLowestPlayerPiece(this.board[n],t);this.droppedPiece=cB.of({square:n,piece:r})}},{key:"getLowestPlayerPiece",value:function(e,t){var n=e.count(t);return t===Zee.ZERO?n-1:e.count(Zee.NONE)-n}},{key:"showLastTransfer",value:function(e){var t=this.rules.node.mother.get().gameState,n=t.getCurrentPlayer(),r=e.starting.get().x,i=this.getLowestPlayerPiece(t.board[r],n);this.leftPiece=cB.of({square:r,piece:i});var a=e.landing.x,o=this.getLowestPlayerPiece(this.board[a],n);this.droppedPiece=cB.of({square:a,piece:o})}},{key:"showPossibleDrops",value:function(){this.displayableArrow=[];for(var e=this.rules.node.gameState,t=0;t<4;t++)!1===e.board[t].isFull()&&(e.remaining.get(Zee.ZERO).get()>0&&this.displayableArrow.push({x:t,player:Zee.ZERO}),e.remaining.get(Zee.ONE).get()>0&&this.displayableArrow.push({x:t,player:Zee.ONE}))}},{key:"getCircleCenter",value:function(e,t,n){var r=e*this.SPACE_SIZE+.5*this.SPACE_SIZE,i=(5-e)*this.SPACE_SIZE*.25+.5*this.SPACE_SIZE;if(1===n.count(Zee.NONE))return new Jne(r,i);var a=n.count(Zee.NONE),o=2*t*Math.PI/a-Math.PI/2,s=.3*this.SPACE_SIZE,u=s*Math.cos(o),c=s*Math.sin(o);return new Jne(r+u,i+c)}},{key:"canDisplayArrow",value:function(e,t){return this.displayableArrow.some(function(n){return n.x===e&&n.player.equals(t)})}},{key:"getArrowClasses",value:function(e,t){return[this.getPlayerClass(t)]}},{key:"getArrowTransform",value:function(e,t){var n=t===Zee.ZERO?0:.5*this.SPACE_SIZE;return"translate("+(n+=e*this.SPACE_SIZE)+", "+(3-e)*this.SPACE_SIZE*.25+")"}},{key:"getSquareClasses",value:function(e){var t=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?t.push("selected"):this.movedSquare.includes(e)&&t.push("last-move"),t}},{key:"onArrowClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#dropArrow_"+(t===Zee.ZERO?"zero":"one")+"_"+e)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=Yre.from(e),n.selectedPiece.isPresent()?(s=n.selectedPiece.get().square,o=Jre.transfer(Yre.from(s),a).get()):o=Jre.drop(a,t),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 6:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e,t,n){var r={square:e,piece:t},i=[],a=n.count(Zee.ZERO),o=n.count(Zee.ONE);if(this.selectedPiece.equalsValue(r))i.push("selected");else if(this.droppedPiece.equalsValue(r))i.push("last-move");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===t)return i.push("captured-stroke"),i;this.rules.node.gameState.getCurrentOpponent()===Zee.ZERO?a++:o++}var s=n.count(Zee.NONE)-(o+a),u=this.getPieceColor(t,a,s);return""!==u&&i.push(u),i}},{key:"getPieceColor",value:function(e,t,n){return e<t?"player0":e>=t+n?"player1":""}},{key:"onSquareClick",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#square_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.selectedPiece.isPresent()||t.selectedPiece.get().square!==e){n.next=5;break}return n.abrupt("return",(t.cancelMoveAttempt(),$5.SUCCESS));case 5:return i=t.rules.node.gameState.getCurrentPlayer(),a=t.board[e],n.abrupt("return",a.count(i)<=0?t.cancelMove(Kre.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(t.selectedPiece=cB.of({square:e,piece:t.getLowestPlayerPiece(a,i)}),0===t.showAndGetPossibleTranfers().length?t.cancelMove(Kre.NO_POSSIBLE_TRANSFER_REMAINS()):$5.SUCCESS));case 7:case"end":return n.stop()}},n)}))()}},{key:"showAndGetPossibleTranfers",value:function(){this.displayableArrow=[];for(var e=this.selectedPiece.get().square-1,t=this.rules.node.gameState.getCurrentPlayer();0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:t}),e--;return this.displayableArrow}}],[{key:"getArrowCoord",value:function(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}}]),n}(ere);return e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-apagos"]],features:[HC],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-8 -8 416 350","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player0",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],["class","base mid-stroke player1",4,"ngFor","ngForOf"],[1,"base","mid-stroke","player0"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","player1"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),ob(1,rie,1,3,"circle",1),hb(2,"g",2),ob(3,sie,5,9,"ng-container",3),fb(),ob(4,uie,1,3,"circle",4),fb()),2&e&&(Ow(1),cb("ngForOf",t.range(t.remainingZero)),Ow(1),nb("transform","translate(0, "+2*t.PIECE_RADIUS+")"),Ow(1),cb("ngForOf",t.board),Ow(1),cb("ngForOf",t.range(t.remainingOne)))},directives:[NT,DT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),lie=function(){var e,t=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n)}(ere);return t.\u0275fac=function(n){return(e||(e=nk(t)))(n||t)},t.\u0275cmp=ty({type:t,selectors:[["ng-component"]],features:[HC],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),hie=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,e,r)).captured=i,a}return ip(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}}],[{key:"getInitialState",value:function(){return new n(Q5.createTable(6,2,4),0,[0,0])}}]),n}(vre),fie=function(){var e=ip(function e(){np(this,e)});return e.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=function(){return $localize(fe||(fe=Nv(["You cannot distribute from the opponent's home."])))},e.MUST_CHOOSE_NONEMPTY_HOUSE=function(){return $localize(de||(de=Nv(["You should choose a non-empty house to distribute."])))},e.SHOULD_DISTRIBUTE=function(){return $localize(ve||(ve=Nv(["You should distribute but you do not."])))},e}(),die=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"applyLegalMove",value:function(e,t,r){aB(n.VERBOSE,{called:"AwaleRules.applyLegalMove",move:e,state:t});var i=e.x,a=t.getCurrentPlayer().value,o=t.getCurrentPlayer().getOpponent().value,s=t.getCopiedBoard(),u=n.distribute(i,a,s);if(u.y===a)return new hie(s,t.turn+1,t.captured);var c=[0,0],l=Q5.copyBiArray(s);return c[a]=n.capture(u.x,o,a,s),c[a]>0&&n.isStarving(o,s)&&(s=l,c=[0,0]),n.isStarving(a,s)&&!1===n.canDistribute(o,s)&&(c[o]+=n.mansoon(o,s)),c[0]+=t.captured[0],c[1]+=t.captured[1],new hie(s,t.turn+1,c)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"mansoon",value:function(e,t){var n=0,r=0;do{n+=t[e][r],t[e][r]=0,r++}while(r<6);return n}},{key:"isLegal",value:function(e,t){var r=t.getCurrentPlayer().value,i=t.getCurrentPlayer().getOpponent().value,a=e.x;if(0===t.getPieceAtXY(a,r))return H5.failure(fie.MUST_CHOOSE_NONEMPTY_HOUSE());var o=n.isStarving(i,t.board),s=!1===n.doesDistribute(a,r,t.board);return o&&s?H5.failure(fie.SHOULD_DISTRIBUTE()):H5.success(void 0)}},{key:"doesDistribute",value:function(e,t,n){return 0===t?n[t][e]>5-e:n[t][e]>e}},{key:"canDistribute",value:function(e,t){for(var r=0;r<6;r++)if(n.doesDistribute(r++,e,t))return!0;return!1}},{key:"isStarving",value:function(e,t){var n=0;do{if(t[e][n++]>0)return!1}while(n<6);return!0}},{key:"distribute",value:function(e,t,n){var r=e,i=t,a=n[t][e];for(n[t][e]=0;a>0;)0===t?5===e?t=1:e++:0===e?t=0:e--,(e!==r||t!==i)&&(n[t][e]+=1,a--);return new Jne(e,t)}},{key:"capture",value:function(e,t,n,r){Z5(t!==n,"AwaleRules.capture called with wrong values of x and player");var i=r[t][e];if(i<2||i>3)return 0;var a=0,o=-1,s=-1;0===n&&(o=1,s=6);do{a+=i,r[t][e]=0,i=r[t][e+=o]}while(e!==s&&(2===i||3===i));return a}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captured[0]>24?Ere.ZERO_WON:t.captured[1]>24?Ere.ONE_WON:24===t.captured[0]&&24===t.captured[1]?Ere.DRAW:Ere.ONGOING}}]),n}(Sre);return e.VERBOSE=!1,e}(),vie=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this)).x=e,r}return ip(n,[{key:"equals",value:function(e){return e===this||e.x===this.x}},{key:"toString",value:function(){return"AwaleMove("+this.x+")"}}],[{key:"from",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;default:return Z5(5===e,"Invalid x for AwaleMove: "+e),n.FIVE}}}]),n}(gre);vie.ZERO=new vie(0),vie.ONE=new vie(1),vie.TWO=new vie(2),vie.THREE=new vie(3),vie.FOUR=new vie(4),vie.FIVE=new vie(5),vie.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return vie.from(e)}}]),n}(jee));var pie=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState,i=r.turn%2,a=0;do{0!==r.getPieceAtXY(a,i)&&(t=vie.from(a),die.isLegal(t,r).isSuccess()&&(t=vie.from(a),n.push(t))),a++}while(a<6);return this.orderMoves(e,n)}},{key:"orderMoves",value:function(e,t){var n=e.gameState.getCurrentPlayer().value,r=e.gameState.getCurrentPlayer().getOpponent().value;return Q5.sortByDescending(t,function(t){var i,a=e.gameState.getCopiedBoard(),o=a[n][t.x],s=die.distribute(t.x,n,a),u=0;return s.y===n?(i=0,o<=6&&(u=10)):i=die.capture(s.x,r,n,a),100*i+u-o}),t}},{key:"getBoardValue",value:function(e){var t=die.getGameStatus(e);if(t.isEndGame)return lre.fromWinner(t.winner);var n=e.gameState.getCapturedCopy();return new lre(n[1]-n[0])}}]),n}(cre),gie=ip(function e(){np(this,e),this.tutorial=[Ire.anyMove($localize(pe||(pe=Nv(["Sowing"]))),$localize(ge||(ge=Nv(["Awal\xe9 is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.\n         Let's see how seeds are sown.\n         As you're playing first, the 6 houses on the top are yours.<br/><br>\n         Click on any of them to sow the seeds it contains: they will be sown clockwise, one seed per house."]))),hie.getInitialState(),vie.ZERO,$localize(ye||(ye=Nv(["Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.\n        This is how seeds are sown:\n        one by one from the house next to the one they come from, clockwise."])))),Ire.anyMove($localize(me||(me=Nv(["Big sowing"]))),$localize(ke||(ke=Nv(["You are now the second player (on the bottom).\n        When there are enough seeds to make a full turn, something else happens.<br/><br/>\n        Sow the house that contains 12 seeds."]))),new hie([[0,0,0,0,0,0],[0,12,0,0,0,0]],1,[0,0]),vie.ONE,$localize(_e||(_e=Nv(["See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds)."])))),Ire.fromMove($localize(we||(we=Nv(["Simple capture"]))),$localize(Ce||(Ce=Nv(["After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.\n         Then, the player looks at the preceding house:\n         if it is still in the opponent's side and contains two or three seeds, they are also captured.\n         This continues until we reach either the player's side or a house containing neither two nor three seeds.<br/><br/>\n         You are the second player, try to capture some pieces!"]))),new hie([[1,0,0,0,1,0],[1,0,0,0,1,0]],1,[0,0]),[vie.ZERO],$localize(be||(be=Nv(["Well done! This was a simple capture, now let us see how to make multiple captures."]))),$localize(Ee||(Ee=Nv(["Failed. Try again and sow from the leftmost house."])))),Ire.fromMove($localize(Se||(Se=Nv(["Multiple captures"]))),$localize(Pe||(Pe=Nv(["By sowing from your leftmost house, you will change the number of seeds in a house from 2 to 3, and from the preceding house from 1 to 2.\n        As these are consecutive houses, all seeds in them will be captured.<br/><br/>\n        Capture them."]))),new hie([[2,1,0,0,1,0],[2,0,0,0,1,0]],1,[0,0]),[vie.ZERO],$localize(Oe||(Oe=Nv(["Nice, you win 3 points from the first house, and 2 from the second!"]))),$localize(Te||(Te=Nv(["Failed. Try again."])))),Ire.fromMove($localize(Ie||(Ie=Nv(["Interrupted capture"]))),$localize(xe||(xe=Nv(["By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>\n        Do it."]))),new hie([[1,0,1,0,0,1],[3,0,0,0,1,0]],1,[0,0]),[vie.ZERO],$localize(Ae||(Ae=Nv(["Notice that because the second house was not capturable, the captured was interrupted and you have not captured the first house."]))),$localize(Re||(Re=Nv(["Failed. Try again."])))),Ire.fromMove($localize(Ne||(Ne=Nv(["Capture on the other side only"]))),$localize(Me||(Me=Nv(["Try to capture the two leftmost houses of the opponent."]))),new hie([[2,2,0,0,1,0],[1,3,0,0,0,0]],1,[0,0]),[vie.ONE],$localize(De||(De=Nv(["Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!"]))),$localize(Le||(Le=Nv(["You have only captured one house, try again!"])))),Ire.fromMove($localize(Fe||(Fe=Nv(["Do not starve"]))),$localize(Be||(Be=Nv(["You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>\n        Try it."]))),new hie([[1,1,1,1,1,0],[5,0,0,1,0,0]],1,[0,0]),[vie.ZERO],$localize(Ve||(Ve=Nv(["Sadly, you cannot capture here, otherwise the opponent could not play after you.\n        When this happens, the move can be made, but no capture takes place!"]))),$localize(Ue||(Ue=Nv(["Failed. Try again."])))),Ire.anyMove($localize(ze||(ze=Nv(["Feeding is mandatory"]))),$localize(He||(He=Nv(["You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>\n        Go ahead!"]))),new hie([[0,0,0,0,0,0],[0,1,2,4,4,5]],1,[0,0]),vie.THREE,$localize(Ge||(Ge=Nv(["Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.\n        It is often a good way to have easy captures!"])))),Ire.anyMove($localize(qe||(qe=Nv(["End of the game"]))),$localize($e||($e=Nv(["A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>\n         Sow the house on the top right."]))),new hie([[0,0,0,0,0,1],[0,1,2,3,4,4]],0,[0,0]),vie.FIVE,$localize(We||(We=Nv(["Also, as soon as on player cannot play, the other player captures all the seeds in its own side.\n         Here, it was the first player's turn, and the second player has taken all the remaining seeds."]))))]});function yie(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"circle",4),kb("click",function(){var e=Wy(n).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),hb(2,"text",5),kb("click",function(){var e=Wy(n).index,t=Cb().index;return Cb().onClick(e,t)}),Nb(3),fb(),fb()}if(2&e){var r=t.$implicit,i=t.index,a=Cb().index,o=Cb();Ow(1),Eb("id","click_",i,"_",a,""),cb("ngClass",o.getSquareClasses(i,a)),nb("cx",50+100*i)("cy",50+120*a),Ow(1),nb("x",50+100*i)("y",66+120*a),Ow(1),Db(" ",r," ")}}function mie(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,yie,4,8,"g",2),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}var kie=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).last=cB.empty(),r.captured=[],r.moved=[],r.scores=cB.of([0,0]),r.rules=new die(hie),r.availableMinimaxes=[new pie(r.rules,"AwaleMinimax")],r.encoder=vie.encoder,r.tutorial=(new gie).tutorial,r.updateBoard(),r}return ip(n,[{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.scores=cB.of(e.getCapturedCopy()),this.hidePreviousMove();var t=this.rules.node.move;if(this.board=e.getCopiedBoard(),t.isPresent()){var n=e.getCurrentOpponent().value;this.last=cB.of(new Jne(t.get().x,n)),this.showPreviousMove()}else this.last=cB.empty()}},{key:"hidePreviousMove",value:function(){this.captured=[],this.moved=[]}},{key:"showPreviousMove",value:function(){for(var e=this.rules.node.mother.get().gameState,t=0;t<=1;t++)for(var n=0;n<=5;n++){var r=new Jne(n,t),i=this.board[t][n],a=e.getPieceAt(r);this.last.equalsValue(r)||(i<a?this.captured.push(r):i>a&&this.moved.push(r))}}},{key:"onClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(t===n.rules.node.gameState.getCurrentPlayer().value){r.next=5;break}return r.abrupt("return",n.cancelMove(fie.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME()));case 5:return n.last=cB.empty(),a=vie.from(e),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState,n.scores.get()));case 8:case"end":return r.stop()}},r)}))()}},{key:"getSquareClasses",value:function(e,t){var n=new Jne(e,t);return this.captured.some(function(e){return e.equals(n)})?["captured"]:this.last.equalsValue(n)?["moved","highlighted"]:this.moved.some(function(e){return e.equals(n)})?["moved"]:[]}}]),n}(lie);return e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-awale-component"]],features:[HC],decls:4,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"click"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),db(1,"rect",1),ob(2,mie,2,1,"g",2),db(3,"line",3),fb()),2&e&&(Ow(2),cb("ngForOf",t.board))},directives:[NT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),_ie=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;if(np(this,n),i=t.call(this,e.x,e.y),e.equals(r))throw new Error(ure.MOVE_CANNOT_BE_STATIC());return i.end=r,jv(i)}return ip(n,[{key:"length",value:function(){return this.coord.getDistance(this.end)}},{key:"getDirection",value:function(){return Yne.factory.fromMove(this.coord,this.end)}}],[{key:"getEncoder",value:function(e,t,n){return new(function(r){qv(a,r);var i=Wv(a);function a(){var n;return np(this,a),(n=i.apply(this,arguments)).shiftAX=t,n.shiftDY=n.shiftAX*e,n.shiftDX=n.shiftDY*t,n}return ip(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftDX+(t-1)*this.shiftDY+(e-1)*this.shiftAX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftDX+e.coord.y*this.shiftDY+e.end.x*this.shiftAX+e.end.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new Jne((r-=r%1)%e,i);r/=e;var o=(r-=r%1)%t;r/=t;var s=new Jne((r-=r%1)%e,o);return n(s,a)}}]),a}(jee))}}]),n}(yre),wie=function(){var e=ip(function e(){np(this,e)});return e.LANDING_ON_OCCUPIED_CASE=function(){return $localize(je||(je=Nv(["You cannot land on an occupied square."])))},e.THRONE_IS_LEFT_FOR_GOOD=function(){return $localize(Ze||(Ze=Nv(["Once you left the central throne, you cannot return to it."])))},e.SOLDIERS_CANNOT_SIT_ON_THRONE=function(){return $localize(Ye||(Ye=Nv(["Soldiers cannot sit on the throne."])))},e.SOMETHING_IN_THE_WAY=function(){return $localize(Ke||(Ke=Nv(["Something is in the way."])))},e.MOVE_MUST_BE_ORTHOGONAL=function(){return $localize(Je||(Je=Nv(["Tafl moves must be orthogonal."])))},e}(),Cie=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;if(np(this,n),i=t.call(this,e,r),e.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+e.toString()+".");if(r.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+r.toString()+".");var a=e.getDirectionToward(r);if(a.isFailure()||a.get().isDiagonal())throw new Error(wie.MOVE_MUST_BE_ORTHOGONAL());return jv(i)}return ip(n,[{key:"equals",value:function(e){return e===this||!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"TaflMove("+this.coord+"->"+this.end+")"}}]),n}(_ie),bie=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getMaximalDistance",value:function(){return 7}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return H5.success(r)}catch(r){return H5.failure(r.message)}}}]),n}(Cie);bie.encoder=_ie.getEncoder(7,7,bie.of);var Eie={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:Zee.ZERO},Sie=function(){function e(t,n){np(this,e),this.owner=t,this.king=n}return ip(e,[{key:"isKing",value:function(){return this.king}},{key:"getOwner",value:function(){return this.owner}}]),e}();Sie.UNOCCUPIED=new Sie(Zee.NONE,!1),Sie.PLAYER_ONE_KING=new Sie(Zee.ONE,!0),Sie.INVADERS=new Sie(Zee.ZERO,!1),Sie.DEFENDERS=new Sie(Zee.ONE,!1);var Pie=ip(function e(t){np(this,e),this.value=t});Pie.NONE=new Pie("NONE"),Pie.OPPONENT=new Pie("OPPONENT"),Pie.PLAYER=new Pie("PLAYER");var Oie=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"isCentralThrone",value:function(e){return e.equals(this.getCentralThrone())}},{key:"getCentralThrone",value:function(){var e=(this.board.length-1)/2;return new Jne(e,e)}},{key:"getRelativeOwner",value:function(e,t){var n=this.getAbsoluteOwner(t);return n===Zee.NONE?Pie.NONE:e===n?Pie.PLAYER:Pie.OPPONENT}},{key:"getAbsoluteOwner",value:function(e){return this.getPieceAt(e).getOwner()}}]),n}(vre),Tie=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=Sie.UNOCCUPIED,t=Sie.INVADERS,r=Sie.DEFENDERS;return new n([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,r,e,e,e],[t,t,r,Sie.PLAYER_ONE_KING,r,t,t],[e,e,e,r,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}}]),n}(Oie),Iie=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,e)).config=r,a.generateMove=i,a}return ip(n,[{key:"isLegal",value:function(e,t){aB(n.VERBOSE,{tablutRules_isLegal:{move:e,state:t}});var r=t.getCurrentPlayer(),i=this.getMoveValidity(r,e,t);return i.isFailure()?H5.failure(i.getReason()):H5.success(void 0)}},{key:"getMoveValidity",value:function(e,t,n){var r=n.getRelativeOwner(e,t.coord);if(r===Pie.NONE)return $5.failure(ure.MUST_CHOOSE_PLAYER_PIECE());if(r===Pie.OPPONENT)return $5.failure(ure.CANNOT_CHOOSE_OPPONENT_PIECE());if(n.getRelativeOwner(e,t.end)!==Pie.NONE)return $5.failure(wie.LANDING_ON_OCCUPIED_CASE());if(this.isThrone(n,t.end)){if(!n.getPieceAt(t.coord).isKing())return $5.failure(wie.SOLDIERS_CANNOT_SIT_ON_THRONE());if(n.isCentralThrone(t.end)&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return $5.failure(wie.THRONE_IS_LEFT_FOR_GOOD())}for(var i=t.coord.getDirectionToward(t.end).get(),a=t.coord.getOrthogonalDistance(t.end),o=t.coord.getNext(i),s=1;s<a;s++){if(n.getPieceAt(o)!==Sie.UNOCCUPIED)return $5.failure(wie.SOMETHING_IN_THE_WAY());o=o.getNext(i)}return $5.SUCCESS}},{key:"isThrone",value:function(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}},{key:"isExternalThrone",value:function(e){var t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}},{key:"tryCapture",value:function(e,t,n,r){var i=t.getNext(n);return i.isInRange(this.config.WIDTH,this.config.WIDTH)&&r.getRelativeOwner(e,i)===Pie.OPPONENT?r.getPieceAt(i).isKing()?this.captureKing(e,t,n,r):this.capturePawn(e,t,n,r):cB.empty()}},{key:"captureKing",value:function(e,t,n,r){var i=t.getNext(n),a=this.getSurroundings(i,n,e,r),o=a.backCoord,s=a.back,u=a.backInRange,c=a.left,l=a.leftCoord,h=a.right,f=a.rightCoord;return!1===u?this.captureKingAgainstTheWall(c,h,i):s===Pie.NONE&&this.isThrone(r,o)?this.captureKingAgainstThrone(o,i,c,h):s===Pie.PLAYER?this.captureKingWithAtLeastASandwich(r,i,c,l,h,f):cB.empty()}},{key:"getSurroundings",value:function(e,t,n,r){var i=e.getNext(t),a=i.isInRange(this.config.WIDTH,this.config.WIDTH),o=a?r.getRelativeOwner(n,i):Pie.NONE,s=e.getLeft(t),u=s.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,s):Pie.NONE,c=e.getRight(t),l=c.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,c):Pie.NONE;return{backCoord:i,back:o,backInRange:a,leftCoord:s,left:u,rightCoord:c,right:l}}},{key:"captureKingAgainstTheWall",value:function(e,t,r){var i=e===Pie.PLAYER?1:0;return 2===(i+=t===Pie.PLAYER?1:0)&&this.config.BORDER_CAN_SURROUND_KING?(aB(n.VERBOSE||!1,"king captured by 3 invaders against 1 border"),cB.of(r)):cB.empty()}},{key:"captureKingAgainstThrone",value:function(e,t,n,r){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return cB.of(t)}else{var i=r===Pie.PLAYER,a=n===Pie.PLAYER||i;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&a)return cB.of(t)}return cB.empty()}},{key:"capturePawn",value:function(e,t,r,i){var a=!1,o=t.getNext(r),s=o.getNext(r),u=Pie.NONE;return s.isInRange(this.config.WIDTH,this.config.WIDTH)&&(u=i.getRelativeOwner(e,s)),u===Pie.NONE?!1===this.isThrone(i,s)?(aB(n.VERBOSE||a,"cannot capture a pawn without an ally; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")cannot capture a pawn without an ally behind"),cB.empty()):(aB(n.VERBOSE||a,"pawn captured by 1 opponent and 1 throne; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),cB.of(o)):u===Pie.PLAYER?(aB(n.VERBOSE||a,"pawn captured by 2 opponents; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),cB.of(o)):(aB(n.VERBOSE||a,"no captures; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),cB.empty())}},{key:"captureKingWithAtLeastASandwich",value:function(e,t,r,i,a,o){if(!1===this.kingTouchCentralThrone(e,t)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return cB.of(t);var s=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,u=this.isThrone(e,i),c=r===Pie.PLAYER||u&&s,l=this.isThrone(e,o);return c&&(a===Pie.PLAYER||l&&s)?(aB(n.VERBOSE||!1,"king captured by 4 invaders"),cB.of(t)):cB.empty()}},{key:"kingTouchCentralThrone",value:function(e,t){var n=e.getCentralThrone();return t.getOrthogonalDistance(n)<=1}},{key:"applyLegalMove",value:function(e,t){aB(n.VERBOSE,{TablutRules_applyLegalMove:{move:e,state:t}});var r=t.turn,i=t.getCopiedBoard(),a=t.getCurrentPlayer(),o=e.coord,s=e.end;i[s.y][s.x]=i[o.y][o.x],i[o.y][o.x]=Sie.UNOCCUPIED;var u,c=Xv(Kne.ORTHOGONALS);try{for(c.s();!(u=c.n()).done;){var l=u.value,h=this.tryCapture(a,e.end,l,t);h.isPresent()&&(i[h.get().y][h.get().x]=Sie.UNOCCUPIED)}}catch(f){c.e(f)}finally{c.f()}return t.from(i,r+1)}},{key:"getGameStatus",value:function(e){var t=this.getWinner(e.gameState);return t.isPresent()?Ere.getVictory(t.get()):Ere.ONGOING}},{key:"getWinner",value:function(e){var t=!1,n=this.getKingCoord(e);if(n.isAbsent())return aB(t,"The king is dead, victory to invader"),cB.of(this.getInvader());var r=n.get();return this.isExternalThrone(r)?(aB(t,"The king escape, victory to defender"),cB.of(this.getDefender())):this.isPlayerImmobilized(Zee.ZERO,e)?(aB(t,"Zero has no move, victory to one"),cB.of(Zee.ONE)):this.isPlayerImmobilized(Zee.ONE,e)?(aB(t,"One has no move, victory to zero"),cB.of(Zee.ZERO)):(aB(t,"no victory"),cB.empty())}},{key:"getKingCoord",value:function(e){aB(n.VERBOSE,{TablutRules_getKingCoord:{state:e,con:this.config}});for(var t=0;t<this.config.WIDTH;t++)for(var r=0;r<this.config.WIDTH;r++)if(e.getPieceAtXY(r,t).isKing())return cB.of(new Jne(r,t));return cB.empty()}},{key:"getInvader",value:function(){return this.config.INVADER}},{key:"getDefender",value:function(){return this.config.INVADER.getOpponent()}},{key:"isPlayerImmobilized",value:function(e,t){return 0===this.getPlayerListMoves(e,t).length}},{key:"getPlayerListMoves",value:function(e,t){var r=[],i=this.getPlayerListPawns(e,t);aB(n.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:e,state:t}});var a,o=Xv(i);try{for(o.s();!(a=o.n()).done;){var s,u=a.value,c=Xv(this.getPossibleDestinations(u,t));try{for(c.s();!(s=c.n()).done;){var l=s.value,h=this.generateMove(u,l);r.push(h)}}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}return r}},{key:"getPlayerListPawns",value:function(e,t){for(var n=[],r=0;r<this.config.WIDTH;r++)for(var i=0;i<this.config.WIDTH;i++){var a=new Jne(i,r);t.getAbsoluteOwner(a)===e&&n.push(a)}return n}},{key:"getPossibleDestinations",value:function(e,t){var n,r,i=[],a=Xv(Kne.ORTHOGONALS);try{for(a.s();!(r=a.n()).done;){var o=r.value;n=e.getNext(o,1);for(var s=!1;n.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===s;)t.getAbsoluteOwner(n)===Zee.NONE?this.isExternalThrone(n)?t.getPieceAt(e).isKing()&&i.push(n):t.isCentralThrone(n)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&i.push(n):i.push(n):s=!0,n=n.getNext(o,1)}}catch(u){a.e(u)}finally{a.f()}return i}}]),n}(Sre);return e.VERBOSE=!1,e}(),xie=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.call(this,Tie,Eie,bie.of)}return ip(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),bre.ruler=this.singleton,n.singleton}}]),n}(Iie),Aie=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,e)).VERBOSE=r,a.generateMove=i,a.NONE=Sie.UNOCCUPIED,a.captureds=[],a.chosen=new Jne(-1,-1),a.lastMove=cB.empty(),a}return ip(n,[{key:"getViewBox",value:function(){var e=-this.STROKE_WIDTH,t=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return e+" "+e+" "+t+" "+t}},{key:"updateBoard",value:function(){aB(this.VERBOSE,"taflComponent.updateBoard"),this.lastMove=this.rules.node.move,this.board=this.rules.node.gameState.getCopiedBoard(),this.captureds=[],this.lastMove.isPresent()&&this.showPreviousMove()}},{key:"showPreviousMove",value:function(){var e,t=this.rules.node.mother.get().gameState,n=this.rules.node.gameState.getCurrentOpponent(),r=Xv(Kne.ORTHOGONALS);try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.lastMove.get().end.getNext(i,1);if(a.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){var o=t.getRelativeOwner(n,a)===Pie.OPPONENT,s=this.rules.node.gameState.getPieceAt(a)===Sie.UNOCCUPIED;o&&s&&this.captureds.push(a)}}}catch(u){r.e(u)}finally{r.f()}}},{key:"onClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return aB(n.VERBOSE,"TaflComponent.onClick("+e+", "+t+")"),i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):-1===n.chosen.x?n.choosePiece(e,t):n.chooseDestination(e,t));case 3:case"end":return r.stop()}},r)}))()}},{key:"chooseDestination",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(aB(n.VERBOSE,"TaflComponent.chooseDestination"),i=n.chosen,a=new Jne(e,t),!(o=n.generateMove(i,a)).isSuccess()){r.next=9;break}return n.cancelMove(),r.next=6,n.chooseMove(o.get(),n.rules.node.gameState);case 6:r.t0=r.sent,r.next=10;break;case 9:r.t0=n.cancelMove(o.getReason());case 10:return r.abrupt("return",r.t0);case 11:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){return aB(this.VERBOSE,"TaflComponent.choosePiece"),this.board[t][e]===Sie.UNOCCUPIED?this.cancelMove(ure.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(e,t)?(this.chosen=new Jne(e,t),aB(this.VERBOSE,"selected piece = ("+e+", "+t+")"),$5.SUCCESS):this.cancelMove(ure.CANNOT_CHOOSE_OPPONENT_PIECE())}},{key:"pieceBelongToCurrentPlayer",value:function(e,t){var n=this.rules.node.gameState,r=n.getCurrentPlayer(),i=new Jne(e,t);return n.getRelativeOwner(r,i)===Pie.PLAYER}},{key:"cancelMoveAttempt",value:function(){this.chosen=new Jne(-1,-1)}},{key:"isThrone",value:function(e,t){return this.rules.isThrone(this.rules.node.gameState,new Jne(e,t))}},{key:"isCentralThrone",value:function(e,t){return!1===this.rules.node.gameState.isCentralThrone(new Jne(e,t))}},{key:"getPieceClasses",value:function(e,t){var n=[],r=new Jne(e,t),i=this.rules.node.gameState.getAbsoluteOwner(r);return n.push(this.getPlayerClass(i)),this.chosen.equals(r)&&n.push("selected"),n}},{key:"getRectClasses",value:function(e,t){var n=[],r=new Jne(e,t);if(this.captureds.some(function(e){return e.equals(r)}))n.push("captured");else if(this.lastMove.isPresent()){var i=this.lastMove.get().coord,a=this.lastMove.get().end;(r.equals(i)||r.equals(a))&&n.push("moved")}return n}},{key:"getClickables",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++)this.isClickable(n,t)&&e.push(new Jne(n,t));return e}},{key:"isClickable",value:function(e,t){return this.pieceBelongToCurrentPlayer(e,t)}},{key:"isInvader",value:function(e,t){return this.board[t][e]===Sie.INVADERS}},{key:"isKing",value:function(e,t){return this.board[t][e].isKing()}},{key:"getKingPolyline",value:function(e,t){return 85+100*e+" "+(85+100*t)+" "+(30+100*e)+" "+(30+100*t)+" "+(50+100*e)+" "+(10+100*t)+" "+(70+100*e)+" "+(30+100*t)+" "+(15+100*e)+" "+(85+100*t)}}]),n}(lie),Rie=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){aB(!1,{TaflMinimax_getListMoves:{node:e}});var t=e.gameState,n=t.getCurrentPlayer(),r=this.ruler.getPlayerListMoves(n,t);return this.orderMoves(t,r)}},{key:"orderMoves",value:function(e,t){var n=this,r=this.ruler.getKingCoord(e).get();return e.getCurrentPlayer()===this.ruler.config.INVADER?Q5.sortByDescending(t,function(e){return-e.end.getOrthogonalDistance(r)}):Q5.sortByDescending(t,function(e){return e.coord.equals(r)?n.ruler.isExternalThrone(e.end)?2:1:0}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getWinner(t);if(n.isPresent())return new lre(n.get().getVictoryValue());var r=this.ruler.getPlayerListPawns(Zee.ZERO,t).length,i=this.ruler.getPlayerListPawns(Zee.ONE,t).length,a=[1,2][this.ruler.config.INVADER.value];a*=Zee.ZERO.getScoreModifier();var o=[2,1][this.ruler.config.INVADER.value];return o*=Zee.ONE.getScoreModifier(),new lre(r*a+i*o)}}]),n}(cre),Nie=function(){function e(t,n){np(this,e),this.directThreats=t,this.mover=n}return ip(e,[{key:"equals",value:function(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}]),e}(),Mie=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this,new fre([e]),r)).directThreat=e,i.mover=r,i}return ip(n)}(Nie),Die=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"toFields",value:function(e){return[[e.y],e.x]}}]),n}(function(e,t){qv(r,e);var n=Wv(r);function r(e){var t;if(np(this,r),(t=n.call(this)).map=[],t.values=[],void 0!==e){var i,a=Xv(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;t.add(o)}}catch(s){a.e(s)}finally{a.f()}}return jv(t)}return ip(r,[{key:"add",value:function(e){var t,n=this.toFields(e),r=this.map,i=Xv(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;void 0===r[a]&&(r[a]=[]),r=r[a]}}catch(s){i.e(s)}finally{i.f()}var o=n[1];return void 0===r[o]&&(r[o]=!0,this.values.push(e),!0)}},{key:"contains",value:function(e){var t,n=this.toFields(e),r=this.map,i=Xv(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(void 0===r[a])return!1;r=r[a]}}catch(o){i.e(o)}finally{i.f()}return void 0!==r[n[1]]}},{key:t,value:function(){return this.values.values()}}]),r}(fre,Symbol.iterator)),Lie=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this,e,r)).width=i.ruler.config.WIDTH,i.maxInfluence=16*(2*i.width-2),i.scoreByThreatenedPiece=16*i.maxInfluence+1,i.scoreBySafePiece=16*i.scoreByThreatenedPiece+1,i}return ip(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new lre(t.toBoardValue());for(var n=e.gameState,r=Sie.UNOCCUPIED,i=0,a=this.getPiecesMap(n),o=this.getThreatMap(n,a),s=this.filterThreatMap(o,n),u=0,c=[Zee.ZERO,Zee.ONE];u<c.length;u++){var l,h=c[u],f=Xv(a.get(h).get());try{for(f.s();!(l=f.n()).done;){var d=l.value;if(s.get(d).isPresent())i+=h.getScoreModifier()*this.scoreByThreatenedPiece;else{i+=h.getScoreModifier()*this.scoreBySafePiece;var v,p=0,g=Xv(Kne.ORTHOGONALS);try{for(g.s();!(v=g.n()).done;)for(var y=v.value,m=d.getNext(y,1);m.isInRange(this.width,this.width)&&n.getPieceAt(m)===r;)p++,m=m.getNext(y,1)}catch(k){g.e(k)}finally{g.f()}i+=p*h.getScoreModifier()}}}catch(k){f.e(k)}finally{f.f()}}return new lre(i)}},{key:"getPiecesMap",value:function(e){for(var t=Sie.UNOCCUPIED,n=new _re,r=[],i=[],a=0;a<this.width;a++)for(var o=0;o<this.width;o++){var s=new Jne(o,a);e.getPieceAt(s)!==t&&(e.getAbsoluteOwner(s)===Zee.ZERO?r.push(s):i.push(s))}return n.set(Zee.ZERO,new Die(r)),n.set(Zee.ONE,new Die(i)),n}},{key:"getThreatMap",value:function(e,t){for(var n=new _re,r=0,i=[Zee.ZERO,Zee.ONE];r<i.length;r++){var a,o=i[r],s=Xv(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreats(u,e);this.isThreatReal(u,e,c)&&n.set(u,new fre(c))}}catch(l){s.e(l)}finally{s.f()}}return n}},{key:"getThreats",value:function(e,t){var n,r=t.getAbsoluteOwner(e).getOpponent(),i=[],a=Xv(Kne.ORTHOGONALS);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=e.getPrevious(o,1);if(this.isAThreat(s,t,r)){var u,c=[],l=Xv(Kne.ORTHOGONALS);try{for(l.s();!(u=l.n()).done;){var h=u.value;if(h!==o.getOpposite()){for(var f=e.getNext(o,1);f.isInRange(this.width,this.width)&&t.getPieceAt(f)===Sie.UNOCCUPIED;)f=f.getNext(h);f.isInRange(this.width,this.width)&&t.getAbsoluteOwner(f)===r&&!1===e.getNext(o,1).equals(f)&&c.push(f)}}}catch(d){l.e(d)}finally{l.f()}i.push(new Mie(s,new Die(c)))}}}catch(d){a.e(d)}finally{a.f()}return i}},{key:"isAThreat",value:function(e,t,n){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==n&&(!this.ruler.isThrone(t,e)||n!==Zee.ONE&&t.getPieceAt(e)!==Sie.UNOCCUPIED))}},{key:"isThreatReal",value:function(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;var r,i=Xv(n);try{for(i.s();!(r=i.n()).done;){if(r.value.mover.size()>0)return!0}}catch(a){i.e(a)}finally{i.f()}return!1}},{key:"filterThreatMap",value:function(e,t){var n,r=new _re,i=e.listKeys(),a=i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentPlayer()}),o=new Die(i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentOpponent()})),s=Xv(a);try{for(s.s();!(n=s.n()).done;){var u,c=n.value,l=e.get(c).get(),h=[],f=Xv(l);try{for(f.s();!(u=f.n()).done;){var d=u.value;if(!1===o.contains(d.directThreat)){var v,p=[],g=Xv(d.mover);try{for(g.s();!(v=g.n()).done;){var y=v.value;!1===o.contains(y)&&p.push(y)}}catch(C){g.e(C)}finally{g.f()}p.length>0&&h.push(new Mie(d.directThreat,new Die(p)))}}}catch(C){f.e(C)}finally{f.f()}h.length>0&&r.set(c,new fre(h))}}catch(C){s.e(C)}finally{s.f()}var m,k=Xv(o);try{for(k.s();!(m=k.n()).done;){var _=m.value,w=e.get(_).get();r.set(_,w)}}catch(C){k.e(C)}finally{k.f()}return r}}]),n}(Rie),Fie=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new lre(t.toBoardValue());for(var r=e.gameState,i=this.ruler.config.WIDTH,a=Sie.UNOCCUPIED,o=0,s=this.getPiecesMap(r),u=this.getThreatMap(r,s),c=this.filterThreatMap(u,r),l=0,h=[Zee.ZERO,Zee.ONE];l<h.length;l++){var f,d=h[l],v=new Die,p=Xv(s.get(d).get());try{for(p.s();!(f=p.n()).done;){var g=f.value;if(c.get(g).isPresent())o+=d.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE;else{o+=d.getScoreModifier()*n.SCORE_BY_SAFE_PIECE;var y,m=Xv(Kne.ORTHOGONALS);try{for(m.s();!(y=m.n()).done;)for(var k=y.value,_=g.getNext(k,1);_.isInRange(i,i)&&r.getPieceAt(_)===a;)v.add(_),_=_.getNext(k,1)}catch(S){m.e(S)}finally{m.f()}}}}catch(S){p.e(S)}finally{p.f()}var w,C=Xv(v);try{for(C.s();!(w=C.n()).done;){var b=w.value,E=n.CONTROL_VALUE[b.y][b.x];o+=d.getScoreModifier()*E}}catch(S){C.e(S)}finally{C.f()}}return new lre(o)}}]),n}(Lie);Fie.SCORE_BY_THREATENED_PIECE=530,Fie.SCORE_BY_SAFE_PIECE=16*Fie.SCORE_BY_THREATENED_PIECE+1,Fie.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];var Bie=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new lre(t.toBoardValue());for(var n=e.gameState,r=this.ruler.config.WIDTH,i=Sie.UNOCCUPIED,a=0,o=0,s=0,u=this.getPiecesMap(n),c=this.getThreatMap(n,u),l=this.filterThreatMap(c,n),h=0,f=[Zee.ZERO,Zee.ONE];h<f.length;h++){var d,v=f[h],p=new Die,g=Xv(u.get(v).get());try{for(g.s();!(d=g.n()).done;){var y=d.value;if(l.get(y).isPresent())o+=v.getScoreModifier();else{a+=v.getScoreModifier();var m,k=Xv(Kne.ORTHOGONALS);try{for(k.s();!(m=k.n()).done;)for(var _=m.value,w=y.getNext(_,1);w.isInRange(r,r)&&n.getPieceAt(w)===i;)p.add(w),w=w.getNext(_,1)}catch(O){k.e(O)}finally{k.f()}}}}catch(O){g.e(O)}finally{g.f()}var C,b=Xv(p);try{for(b.s();!(C=b.n()).done;){var E=C.value,S=Fie.CONTROL_VALUE[E.y][E.x];s+=v.getScoreModifier()*S}}catch(O){b.e(O)}finally{b.f()}}var P=this.getStepForEscape(n);return new lre(531*P*17*17+531*a*17+531*o+s)}},{key:"getStepForEscape",value:function(e){var t=this.ruler.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(Number.MAX_SAFE_INTEGER)}},{key:"_getStepForEscape",value:function(e,t,n,r){var i=this,a=this.getNextGen(e,n,r);return 0===a.length?cB.empty():a.some(function(e){return i.ruler.isExternalThrone(e)})?cB.of(t):(t++,r.push.apply(r,Jv(a)),this._getStepForEscape(e,t,a,r))}},{key:"getNextGen",value:function(e,t,n){var r,i=this,a=[],o=Xv(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=Xv(Kne.ORTHOGONALS);try{var l=function(){for(var t=s.value,r=u.getNext(t,1);r.isInRange(i.ruler.config.WIDTH,i.ruler.config.WIDTH)&&e.getPieceAt(r)===Sie.UNOCCUPIED;)n.every(function(e){return!1===e.equals(r)})&&a.push(r),r=r.getNext(t,1)};for(c.s();!(s=c.n()).done;)l()}catch(h){c.e(h)}finally{c.f()}}}catch(h){o.e(h)}finally{o.f()}return a}}]),n}(Fie);Bie.SCORE_BY_THREATENED_PIECE=530,Bie.SCORE_BY_SAFE_PIECE=16*Fie.SCORE_BY_THREATENED_PIECE+1,Bie.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];var Vie=Sie.UNOCCUPIED,Uie=Sie.INVADERS,zie=Sie.DEFENDERS,Hie=Sie.PLAYER_ONE_KING,Gie=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(Qe||(Qe=Nv(["Goal of the game"]))),$localize(Xe||(Xe=Nv(["Brandhub is the Irish version of the family of viking strategy game called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne."]))),Tie.getInitialState()),Ire.anyMove($localize(et||(et=Nv(["Moving"]))),$localize(tt||(tt=Nv(["All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, he can't go back on it, nor can the other pieces.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move."]))),Tie.getInitialState(),bie.of(new Jne(3,1),new Jne(1,1)),$localize(nt||(nt=Nv(["Congratulations!"])))),Ire.fromMove($localize(rt||(rt=Nv(["Capturing a soldier (1/2)"]))),$localize(it||(it=Nv(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new Tie([[Vie,Vie,Vie,Uie,Vie,Vie,Vie],[Vie,Vie,Vie,Uie,Vie,Vie,Vie],[Uie,Vie,Vie,zie,Vie,Vie,Vie],[Vie,Vie,zie,Hie,zie,Uie,Uie],[Vie,Vie,Uie,Vie,Vie,Vie,Vie],[Vie,Vie,Vie,zie,Vie,Uie,Vie],[Vie,Vie,Vie,Uie,Vie,Vie,Vie]],1),[bie.of(new Jne(3,5),new Jne(2,5))],$localize(at||(at=Nv(["Congratulations, that will teach him a lesson!"]))),$localize(ot||(ot=Nv(["Failed, you missed an opportunity to capture a piece of the opponent."])))),Ire.fromMove($localize(st||(st=Nv(["Capturing a soldier (2/2)"]))),$localize(ut||(ut=Nv(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new Tie([[Vie,Vie,Vie,Uie,Vie,Vie,Vie],[Vie,Vie,Uie,Vie,Vie,Vie,Vie],[Vie,Vie,Vie,zie,Vie,Vie,Vie],[Uie,zie,Vie,Vie,zie,Uie,Uie],[Vie,zie,Vie,Vie,Vie,Vie,Vie],[Vie,Uie,Vie,Hie,Vie,Uie,Vie],[Vie,Vie,Vie,Uie,Vie,Vie,Vie]],12),[bie.of(new Jne(2,1),new Jne(3,1)),bie.of(new Jne(3,0),new Jne(3,1))],$localize(ct||(ct=Nv(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(lt||(lt=Nv(["Failed, you did not do the expected move."])))),Ire.fromMove($localize(ht||(ht=Nv(["Capturing the king on his throne"]))),$localize(ft||(ft=Nv(["To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>Capture the king."]))),new Tie([[Vie,Vie,Vie,Vie,Vie,Vie,Vie],[Vie,Vie,Vie,zie,Vie,Vie,Vie],[Vie,Vie,Vie,Uie,Vie,Vie,Vie],[Vie,Uie,Vie,Hie,Uie,Vie,Vie],[Vie,Vie,Vie,Uie,Vie,Vie,Vie],[Vie,zie,Vie,Vie,Vie,Vie,Vie],[Vie,Vie,Vie,Vie,Vie,Vie,Vie]],72),[bie.of(new Jne(1,3),new Jne(2,3))],$localize(dt||(dt=Nv(["Congratulations, you won!"]))),$localize(vt||(vt=Nv(["Failed, you let the king run away."])))),Ire.fromMove($localize(pt||(pt=Nv(["Capturing the king next to his throne"]))),$localize(gt||(gt=Nv(["Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>Capture the king."]))),new Tie([[Vie,Vie,Uie,Vie,Vie,Vie,Vie],[Vie,Vie,Vie,Uie,Vie,Vie,Vie],[Vie,Vie,Vie,Hie,Uie,Vie,Vie],[Vie,Uie,zie,Vie,zie,Vie,Vie],[Vie,Vie,Vie,Uie,Vie,Vie,Vie],[Vie,Vie,Vie,Vie,Vie,Vie,Vie],[Vie,Vie,Vie,Vie,Vie,Vie,Vie]],72),[bie.of(new Jne(2,0),new Jne(2,2))],$localize(yt||(yt=Nv(["The king is dead, long live the king. Congratulations, you won."]))),$localize(mt||(mt=Nv(["Failed!"])))),Ire.fromMove($localize(kt||(kt=Nv(["Capturing the king far from his throne"]))),$localize(_t||(_t=Nv(["When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>Capture the king."]))),new Tie([[Vie,Vie,Vie,Vie,Vie,Vie,Vie],[Vie,Vie,Vie,Vie,Vie,Vie,Vie],[Vie,Uie,Vie,Uie,Vie,Vie,Vie],[Uie,Vie,Vie,Vie,zie,Vie,Vie],[Vie,Vie,Vie,zie,Vie,Vie,Vie],[Vie,Vie,Vie,Vie,Vie,Vie,Vie],[Vie,Hie,Vie,Uie,Vie,Vie,Vie]],72),[bie.of(new Jne(3,6),new Jne(2,6))],$localize(wt||(wt=Nv(["The king is dead, long live the king. Congratulations, you won."]))),$localize(Ct||(Ct=Nv(["Failed!"]))))]});function qie(e,t){if(1&e){var n=gb();wm(),hb(0,"polyline",6),kb("click",function(){Wy(n);var e=Cb(2).index,t=Cb().index;return Cb().onClick(e,t)}),fb()}if(2&e){var r=Cb(2).index,i=Cb().index,a=Cb();nb("transform","translate("+r*a.SPACE_SIZE+" "+i*a.SPACE_SIZE+")")}}function $ie(e,t){if(1&e){var n=gb();wm(),hb(0,"polyline",7),kb("click",function(){Wy(n);var e=Cb(2).index,t=Cb().index;return Cb().onClick(e,t)}),fb()}if(2&e){var r=Cb(2).index,i=Cb().index,a=Cb();nb("transform","translate("+r*a.SPACE_SIZE+" "+i*a.SPACE_SIZE+")")}}function Wie(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,qie,1,1,"polyline",4),ob(2,$ie,1,1,"ng-template",null,5,IP),fb()),2&e){var n=sb(3),r=Cb().index,i=Cb().index,a=Cb();Ow(1),cb("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function jie(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"line",11),kb("click",function(){Wy(n);var e=Cb(2).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),hb(2,"line",11),kb("click",function(){Wy(n);var e=Cb(2).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),hb(3,"line",11),kb("click",function(){Wy(n);var e=Cb(2).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),hb(4,"line",11),kb("click",function(){Wy(n);var e=Cb(2).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),hb(5,"line",11),kb("click",function(){Wy(n);var e=Cb(2).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),fb()}if(2&e){var r=Cb(2).index,i=Cb().index,a=Cb();Ow(1),nb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.04*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.96*a.SPACE_SIZE),Ow(1),nb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.2*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.05*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.65*a.SPACE_SIZE),Ow(1),nb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.2*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.95*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.65*a.SPACE_SIZE),Ow(1),nb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.4*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.15*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.75*a.SPACE_SIZE),Ow(1),nb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.4*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.85*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.75*a.SPACE_SIZE)}}function Zie(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"polyline",13),kb("click",function(){Wy(n);var e=Cb(3).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),fb()}if(2&e){var r=Cb(3).index,i=Cb().index,a=Cb();Ow(1),nb("points",a.getKingPolyline(r,i))}}function Yie(e,t){if(1&e){var n=gb();wm(),hb(0,"line",11),kb("click",function(){Wy(n);var e=Cb(3).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),hb(1,"line",11),kb("click",function(){Wy(n);var e=Cb(3).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),hb(2,"line",11),kb("click",function(){Wy(n);var e=Cb(3).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),hb(3,"line",11),kb("click",function(){Wy(n);var e=Cb(3).index,t=Cb().index;return Cb().onClick(e,t)}),fb()}if(2&e){var r=Cb(3).index,i=Cb().index,a=Cb();nb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.04*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.96*a.SPACE_SIZE),Ow(1),nb("x1",a.SPACE_SIZE*r+.04*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.5*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.96*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.5*a.SPACE_SIZE),Ow(1),nb("x1",a.SPACE_SIZE*r+.15*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.15*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.85*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.85*a.SPACE_SIZE),Ow(1),nb("x1",a.SPACE_SIZE*r+.85*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.15*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.15*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.85*a.SPACE_SIZE)}}function Kie(e,t){if(1&e&&(wm(),ob(0,Zie,2,1,"g",9),ob(1,Yie,4,16,"ng-template",null,12,IP)),2&e){var n=sb(2),r=Cb(2).index,i=Cb().index;cb("ngIf",Cb().isKing(r,i))("ngIfElse",n)}}function Jie(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"circle",8),kb("click",function(){Wy(n);var e=Cb().index,t=Cb().index;return Cb().onClick(e,t)}),fb(),ob(2,jie,6,20,"g",9),ob(3,Kie,3,2,"ng-template",null,10,IP),fb()}if(2&e){var r=sb(4),i=Cb().index,a=Cb().index,o=Cb();Ow(1),cb("ngClass",o.getPieceClasses(i,a)),nb("r",(o.SPACE_SIZE-o.STROKE_WIDTH)/2)("cx",o.SPACE_SIZE*i+.5*o.SPACE_SIZE)("cy",o.SPACE_SIZE*a+.5*o.SPACE_SIZE),Ow(1),cb("ngIf",o.isInvader(i,a))("ngIfElse",r)}}function Qie(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"rect",2),kb("click",function(){var e=Wy(n).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),ob(2,Wie,4,2,"g",3),ob(3,Jie,5,6,"g",3),fb()}if(2&e){var r=t.index,i=Cb().index,a=Cb();Ow(1),Eb("id","click_",r,"_",i,""),cb("ngClass",a.getRectClasses(r,i)),nb("x",a.SPACE_SIZE*r)("y",a.SPACE_SIZE*i)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Ow(1),cb("ngIf",a.board[i][r]===a.NONE&&a.isThrone(r,i)),Ow(1),cb("ngIf",a.board[i][r]!==a.NONE)}}function Xie(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,Qie,4,9,"g",1),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}function eae(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"rect",14),kb("click",function(){var e=Wy(n).$implicit;return Cb().onClick(e.x,e.y)}),fb(),fb()}if(2&e){var r=t.$implicit,i=Cb();Ow(1),Eb("id","click_",r.x,"_",r.y,""),nb("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var tae=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e,!1,bie.from)).rules=xie.get(),r.availableMinimaxes=[new Rie(r.rules,"DummyBot"),new Lie(r.rules,"Piece > Influence"),new Fie(r.rules,"Piece > Control"),new Bie(r.rules,"Escape > Piece > Control")],r.encoder=bie.encoder,r.tutorial=(new Gie).tutorial,r}return ip(n,[{key:"ngOnInit",value:function(){this.updateBoard()}}]),n}(Aie);return e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-brandhub"]],features:[HC],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],[4,"ngIf"],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15","class","base",3,"click",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15",1,"base",3,"click"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60, 10 20",1,"base",3,"click"],[1,"base",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"click"],["soldierDefender",""],[1,"base","no-fill",3,"click"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),ob(1,Xie,2,1,"g",1),ob(2,eae,2,6,"g",1),fb()),2&e&&(nb("viewBox",t.getViewBox()),Ow(1),cb("ngForOf",t.board),Ow(1),cb("ngForOf",t.getClickables()))},directives:[NT,AT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),nae=function(){var e,t=function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.apply(this,arguments)).SPACE_SIZE=50,e}return ip(n,[{key:"getTriangleCornerCoords",value:function(e,t){return(e+t)%2==1?this.getDownwardCoordinate(e,t):this.getUpwardCoordinate(e,t)}},{key:"getTriangleCoordinate",value:function(e,t){return this.getTriangleCornerCoords(e,t).map(function(e){return e.x+","+e.y}).reduce(function(e,t){return e+","+t})}},{key:"getDownwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new Jne(.5*this.SPACE_SIZE*e,i);return[o,new Jne(n,a),new Jne(r,i),o]}},{key:"getUpwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new Jne(.5*this.SPACE_SIZE*e,a);return[o,new Jne(n,i),new Jne(r,a),o]}},{key:"getPyramidCoordinate",value:function(e,t){return(e+t)%2==1?this.getDownwardPyramidCoordinate(e,t):this.getUpwardPyramidCoordinate(e,t)}},{key:"getDownwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=this.SPACE_SIZE*t,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}},{key:"getUpwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=(t+1)*this.SPACE_SIZE,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}}]),n}(ere);return t.\u0275fac=function(n){return(e||(e=nk(t)))(n||t)},t.\u0275cmp=ty({type:t,selectors:[["ng-component"]],features:[HC],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),rae=function(){var e=ip(function e(){np(this,e)});return e.INVALID_DISTANCE=function(){return $localize(bt||(bt=Nv(["Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is."])))},e.NOT_ENOUGH_TILES_TO_EXCHANGE=function(){return $localize(Et||(Et=Nv(["You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it."])))},e.FIRST_CLICK_SHOULD_NOT_BE_NULL=function(){return $localize(St||(St=Nv(["Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles."])))},e.CANNOT_CAPTURE_FROM_EMPTY=function(){return $localize(Pt||(Pt=Nv(["You cannot capture from an empty space."])))},e.CANNOT_CAPTURE_OWN_PIECES=function(){return $localize(Ot||(Ot=Nv(["You cannot capture your own pieces."])))},e}(),iae=function(){function e(t,n){np(this,e),this.direction=t,this.str=n}return ip(e,[{key:"toInt",value:function(){var t=this;return e.STEPS.findIndex(function(e){return e.direction.equals(t.direction)})}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return this.str}}],[{key:"fromCoords",value:function(t,n){var r=t.getVectorToward(n),i=e.STEPS.findIndex(function(e){return e.direction.equals(r)});if(-1===i)throw new Error(rae.INVALID_DISTANCE());return e.STEPS[i]}}]),e}();iae.LEFT=new iae(new Wne(-2,0),"LEFT"),iae.UP_LEFT=new iae(Yne.UP_LEFT,"UP_LEFT"),iae.UP_RIGHT=new iae(Yne.UP_RIGHT,"UP_RIGHT"),iae.RIGHT=new iae(new Wne(2,0),"RIGHT"),iae.DOWN_LEFT=new iae(Yne.DOWN_LEFT,"DOWN_LEFT"),iae.DOWN_RIGHT=new iae(Yne.DOWN_RIGHT,"DOWN_RIGHT"),iae.STEPS=[iae.LEFT,iae.UP_LEFT,iae.UP_RIGHT,iae.RIGHT,iae.DOWN_LEFT,iae.DOWN_RIGHT];var aae=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a){var o;return np(this,n),(o=t.call(this)).start=e,o.step=r,o.landingCoord=i,o.capture=a,o}return ip(n,[{key:"isTileExchange",value:function(){return this.capture.isPresent()}},{key:"toString",value:function(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}},{key:"equals",value:function(e){return!(!this.capture.equals(e.capture)||!this.start.equals(e.start)||!this.step.equals(e.step))}}],[{key:"fromMovement",value:function(e,t){if(e.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");var r=new Jne(e.x+t.direction.x,e.y+t.direction.y);if(r.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new n(cB.of(e),cB.of(t),cB.of(r),cB.empty())}},{key:"fromTilesExchange",value:function(e){if(e.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new n(cB.empty(),cB.empty(),cB.empty(),cB.of(e))}},{key:"fromCoordToCoord",value:function(e,t){var r=iae.fromCoords(e,t);return n.fromMovement(e,r)}}]),n}(gre);aae.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"maxValue",value:function(){return 1035}},{key:"encodeNumber",value:function(e){if(e.isTileExchange()){var t=e.capture.get().y;return 10*e.capture.get().x+t}var n=e.start.get().y,r=e.start.get().x;return 150*(e.step.get().toInt()+1)+10*r+n}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%10,n=(e=(e-t)/10)%15;return 0==(e=(e-n)/15)?aae.fromTilesExchange(new Jne(n,t)):aae.fromMovement(new Jne(n,t),iae.STEPS[e-1])}}]),n}(jee));var oae=function(){function e(){np(this,e)}return ip(e,null,[{key:"getNeighbors",value:function(e){var t=new Jne(e.x-1,e.y),n=new Jne(e.x+1,e.y);return(e.x+e.y)%2==1?[t,n,new Jne(e.x,e.y-1)]:[t,n,new Jne(e.x,e.y+1)]}},{key:"getFakeNeighbors",value:function(e){return new Jne(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}},{key:"getCommonNeighbor",value:function(t,n){for(var r=e.getNeighbors(t),i=e.getNeighbors(n),a=0;a<r.length;){for(var o=r[a],s=0;s<i.length;){if(o.equals(i[s]))return cB.of(o);s++}a++}return cB.empty()}}]),e}(),sae=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getEmptyNeighboors",value:function(e,t){return n.getEmptyNeighbors(this.board,e,t)}}],[{key:"getEmptyNeighbors",value:function(e,t,n){var r,i=[],a=Xv(oae.getNeighbors(t));try{for(a.s();!(r=a.n()).done;){var o=r.value;o.isInRange(e[0].length,e.length)&&e[o.y][o.x]===n&&i.push(o)}}catch(s){a.e(s)}finally{a.f()}return i}}]),n}(vre),uae=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a){var o;return np(this,n),(o=t.call(this,e,r)).tiles=i,o.captures=a,o}return ip(n,[{key:"applyLegalMovement",value:function(e){aB(n.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:e}});var t=e.start.get(),r=e.landingCoord.get(),i=this.getCopiedBoard();return i[r.y][r.x]=nre.ofPlayer(this.getCurrentPlayer()),i[t.y][t.x]=nre.EMPTY,new n(i,this.turn,this.tiles,this.captures)}},{key:"doMovementCaptures",value:function(e){aB(n.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:e}});var t,r=this,i=Xv(this.getCapturedNeighbors(e.landingCoord.get()));try{for(i.s();!(t=i.n()).done;){var a=t.value;r=r.capture(a)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"getCapturedNeighbors",value:function(e){var t=this,n=this.getCurrentOpponent();return oae.getNeighbors(e).filter(function(e){return!e.isNotInRange(15,10)&&!!t.getPieceAt(e).is(n)&&t.isSurrounded(e)})}},{key:"isSurrounded",value:function(e){return 0===this.getEmptyNeighboors(e,nre.EMPTY).length}},{key:"capture",value:function(e){aB(n.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:e}});var t=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return aB(n.VERBOSE,e.toString()+" has been captured"),t[e.y][e.x]=nre.EMPTY,r[this.getCurrentPlayer().value]+=1,new n(t,this.turn,this.tiles,r)}},{key:"removeTilesIfNeeded",value:function(e,t){aB(n.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,tile:e,countTiles:t}});var r=this,i=n.getTilesUpperLeftCoord(e);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){r=this.deconnectTile(i,t);var a,o=Xv(n.getPresentNeighboorEntrances(i));try{for(o.s();!(a=o.n()).done;){var s=a.value,u=r.getPieceAt(s);u===nre.EMPTY?r=r.removeTilesIfNeeded(s,t):u.is(this.getCurrentOpponent())&&r.isSurrounded(s)&&(r=r.capture(s))}}catch(c){o.e(c)}finally{o.f()}}return r}},{key:"isTileEmpty",value:function(e){Z5(this.getPieceAt(e)!==nre.NONE,"Should not call isTileEmpty on removed tile");for(var t=0;t<2;t++)for(var n=0;n<3;n++){var r=e.getNext(new Wne(n,t),1);if(this.getPieceAt(r)!==nre.EMPTY)return!1}return!0}},{key:"isDeconnectable",value:function(e){var t=this.getPresentNeighboorTilesRelativeIndexes(e);if(t.length>3)return!1;for(var n=0,r=1;r<t.length;r++)!1===this.areNeighboor(t[r-1],t[r])&&(n+=1);return!1===this.areNeighboor(t[0],t[t.length-1])&&(n+=1),n<=1}},{key:"areNeighboor",value:function(e,t){return e+1===t||0===e&&5===t}},{key:"getPresentNeighboorTilesRelativeIndexes",value:function(e){for(var t=[],r=cB.empty(),i=0;i<6;i++){var a=e.getNext(n.NEIGHBOORS_TILES_DIRECTIONS[i],1);a.isInRange(15,10)&&this.getPieceAt(a)!==nre.NONE&&(r.isAbsent()&&(r=cB.of(i)),t.push(i-r.get()))}return t}},{key:"deconnectTile",value:function(e,t){aB(n.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:e,countTiles:t}});for(var r=this.getCopiedBoard(),i=e.x,a=e.y,o=0;o<2;o++)for(var s=0;s<3;s++)r[a+o][i+s]=nre.NONE;var u=[this.tiles[0],this.tiles[1]];return t&&(u[this.getCurrentPlayer().value]+=1),new n(r,this.turn,u,this.captures)}},{key:"getLegalLandings",value:function(e){var t,n=[],r=Xv(iae.STEPS);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=e.getNext(i.direction,1);this.isOnBoard(a)&&this.getPieceAt(a)===nre.EMPTY&&n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPiecesByFreedom",value:function(){for(var e=[[0,0,0,0],[0,0,0,0]],t=0;t<10;t++)for(var n=0;n<15;n++){var r=this.board[t][n];if(r.isPlayer()){var i=this.getEmptyNeighboors(new Jne(n,t),nre.EMPTY).length;e[r.value][i]=e[r.value][i]+1}}return e}}],[{key:"getTilesUpperLeftCoord",value:function(e){var t=e.x-e.x%3,n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new Jne(t,n)}},{key:"getPresentNeighboorEntrances",value:function(e){return[new Jne(e.x+1,e.y-1),new Jne(e.x+3,e.y+0),new Jne(e.x+3,e.y+1),new Jne(e.x+1,e.y+2),new Jne(e.x-1,e.y+1),new Jne(e.x-1,e.y+0)].filter(n.isInRange)}},{key:"getInitialState",value:function(){var e=nre.EMPTY,t=nre.NONE,r=nre.ZERO,i=nre.ONE;return new n([[t,t,t,t,t,t,r,e,r,t,t,t,t,t,t],[t,t,t,e,e,r,e,e,e,r,e,e,t,t,t],[e,i,e,i,e,e,r,e,r,e,e,i,e,i,e],[i,e,e,e,i,e,e,e,e,e,i,e,e,e,i],[e,i,e,i,e,e,e,e,e,e,e,i,e,i,e],[e,r,e,r,e,e,e,e,e,e,e,r,e,r,e],[r,e,e,e,r,e,e,e,e,e,r,e,e,e,r],[e,r,e,r,e,e,i,e,i,e,e,r,e,r,e],[t,t,t,e,e,i,e,e,e,i,e,e,t,t,t],[t,t,t,t,t,t,i,e,i,t,t,t,t,t,t]],0,[0,0],[0,0])}}]),n}(sae);uae.VERBOSE=!1,uae.NEIGHBOORS_TILES_DIRECTIONS=[new Wne(0,-2),new Wne(3,-1),new Wne(3,1),new Wne(0,2),new Wne(-3,1),new Wne(-3,-1)],uae.isInRange=function(e){return e.isInRange(15,10)};var cae=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isTileExchange()?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}},{key:"applyLegalTileExchange",value:function(e,t){var r=t.getCopiedBoard(),i=e.capture.get();r[i.y][i.x]=nre.EMPTY;var a=[t.captures[0],t.captures[1]];a[t.getCurrentPlayer().value]+=1;var o=[t.tiles[0],t.tiles[1]];o[t.getCurrentPlayer().value]-=2;var s=new uae(r,t.turn,o,a),u=s.removeTilesIfNeeded(i,!1),c=new uae(u.getCopiedBoard(),u.turn+1,u.tiles,u.captures);return aB(n.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:t,afterCapture:s,afterTileRemoval:u,resultingState:c}}),c}},{key:"applyLegalMovement",value:function(e,t){var r=t.applyLegalMovement(e),i=r.removeTilesIfNeeded(e.start.get(),!0),a=i.doMovementCaptures(e),o=new uae(a.board,t.turn+1,a.tiles,a.captures);return aB(n.VERBOSE,{ab_state:t,afterMovement:r,afterTilesRemoved:i,afterCaptures:a,resultingState:o}),o}},{key:"isLegal",value:function(e,t){return e.isTileExchange()?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}},{key:"isLegalTileExchange",value:function(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return H5.failure(rae.NOT_ENOUGH_TILES_TO_EXCHANGE());var n=t.getPieceAt(e.capture.get());return n===nre.NONE||n===nre.EMPTY?H5.failure(rae.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?H5.failure(rae.CANNOT_CAPTURE_OWN_PIECES()):H5.success(void 0)}},{key:"isLegalMovement",value:function(e,t){if(t.getPieceAt(e.start.get())===nre.NONE){var n="Cannot start with a coord outside the board "+e.start.get().toString()+".";return H5.failure(n)}if(t.getPieceAt(e.landingCoord.get())===nre.NONE){var r="Cannot end with a coord outside the board "+e.landingCoord.get().toString()+".";return H5.failure(r)}var i=t.getPieceAt(e.start.get());return i===nre.EMPTY?H5.failure(ure.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):i.is(t.getCurrentOpponent())?H5.failure(ure.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(e.landingCoord.get()).is(t.getCurrentPlayer())?H5.failure(ure.MUST_LAND_ON_EMPTY_SPACE()):H5.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captures[0]>=18?Ere.ZERO_WON:t.captures[1]>=18?Ere.ONE_WON:Ere.ONGOING}}]),n}(Sre);return e.VERBOSE=!1,e}(),lae=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){var t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),this.putCaptureFirst(e,t)}},{key:"getListExchanges",value:function(e){var t=[],n=e.gameState,r=n.getCurrentPlayer().value,i=nre.ofPlayer(n.getCurrentOpponent());if(n.tiles[r]<2)return t;for(var a=0;a<10;a++)for(var o=0;o<15;o++){var s=new Jne(o,a);if(n.getPieceAt(s)===i){var u=aae.fromTilesExchange(s);t.push(u)}}return t}},{key:"getListMovement",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<10;i++)for(var a=0;a<15;a++){var o=new Jne(a,i);if(n.getPieceAt(o).is(r)){var s,u=Xv(n.getLegalLandings(o));try{for(u.s();!(s=u.n()).done;){var c=s.value,l=aae.fromCoordToCoord(o,c);t.push(l)}}catch(h){u.e(h)}finally{u.f()}}}return t}},{key:"getBoardValue",value:function(e){var t=cae.getGameStatus(e);if(t.isEndGame)return lre.fromWinner(t.winner);var n=e.gameState,r=n.getPiecesByFreedom(),i=this.getPiecesScore(r);return new lre(2*n.captures[1]+i[1]-(2*n.captures[0]+i[0]))}},{key:"getPiecesScore",value:function(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}},{key:"getPlayerPiecesScore",value:function(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}},{key:"putCaptureFirst",value:function(e,t){var n=this;return Q5.sortByDescending(t,function(t){return n.moveCapturesList(e,t).length}),t}},{key:"moveCapturesList",value:function(e,t){return t.isTileExchange()?[t.capture.get()]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.start.get(),!0).getCapturedNeighbors(t.landingCoord.get())}}]),n}(cre),hae=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getBoardValue",value:function(e){var t=cae.getGameStatus(e);if(t.isEndGame)return lre.fromWinner(t.winner);for(var r=e.gameState,i=this.getPiecesMap(r),a=this.getThreatMap(r,i),o=this.filterThreatMap(a,r),s=0,u=0,c=[Zee.ZERO,Zee.ONE];u<c.length;u++){var l,h=c[u],f=Xv(i.get(h).get());try{for(f.s();!(l=f.n()).done;){var d=l.value;o.get(d).isPresent()?s+=h.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE:s+=h.getScoreModifier()*n.SCORE_BY_SAFE_PIECE}}catch(v){f.e(v)}finally{f.f()}}return s+=r.tiles[1]-r.tiles[0],new lre(s)}},{key:"getPiecesMap",value:function(e){for(var t=new _re,n=[],r=[],i=0;i<10;i++)for(var a=0;a<15;a++){var o=new Jne(a,i),s=e.getPieceAt(o);s===nre.ZERO?n.push(o):s===nre.ONE&&r.push(o)}return t.set(Zee.ZERO,new Die(n)),t.set(Zee.ONE,new Die(r)),t}},{key:"getThreatMap",value:function(e,t){for(var n=new _re,r=0,i=[Zee.ZERO,Zee.ONE];r<i.length;r++){var a,o=i[r],s=Xv(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreat(u,e);c.isPresent()&&n.set(u,c.get())}}catch(l){s.e(l)}finally{s.f()}}return n}},{key:"getThreat",value:function(e,t){var n,r=Zee.of(t.getPieceAt(e).value).getOpponent(),i=cB.empty(),a=[],o=Xv(oae.getNeighbors(e).filter(function(e){return e.isInRange(15,10)}));try{for(o.s();!(n=o.n()).done;){var s=n.value,u=t.getPieceAt(s);if(u.is(r))a.push(s);else if(u===nre.EMPTY){if(i.isPresent())return cB.empty();i=cB.of(s)}}}catch(d){o.e(d)}finally{o.f()}if(i.isPresent()){var c,l=[],h=Xv(iae.STEPS);try{var f=function(){var e=c.value,n=i.get().getNext(e.direction,1);n.isInRange(15,10)&&t.getPieceAt(n).is(r)&&a.every(function(e){return!1===e.equals(n)})&&l.push(n)};for(h.s();!(c=h.n()).done;)f()}catch(d){h.e(d)}finally{h.f()}if(l.length>0)return cB.of(new Nie(new Die(a),new Die(l)))}return cB.empty()}},{key:"filterThreatMap",value:function(e,t){var n,r=new _re,i=e.listKeys(),a=i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentPlayer())}),o=new Die(i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentOpponent())})),s=Xv(a);try{for(s.s();!(n=s.n()).done;){var u=n.value,c=e.get(u).get();Z5(1===c.directThreats.size(),"oldThreat must contain exactly one direct threat");var l=c.directThreats.getAnyElement().get(),h=cB.empty();if(!1===o.contains(l)){var f,d=[],v=Xv(c.mover);try{for(v.s();!(f=v.n()).done;){var p=f.value;!1===o.contains(p)&&d.push(p)}}catch(_){v.e(_)}finally{v.f()}d.length>0&&(h=cB.of(new Nie(c.directThreats,new Die(d))))}h.isPresent()&&r.set(u,h.get())}}catch(_){s.e(_)}finally{s.f()}var g,y=Xv(o);try{for(y.s();!(g=y.n()).done;){var m=g.value,k=e.get(m).get();r.set(m,k)}}catch(_){y.e(_)}finally{y.f()}return r}}]),n}(lae);return e.SCORE_BY_THREATENED_PIECE=1e3,e.SCORE_BY_SAFE_PIECE=1e6,e}(),fae=nre.EMPTY,dae=nre.NONE,vae=nre.ZERO,pae=nre.ONE,gae=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(Tt||(Tt=Nv(["Board and goal of the game"]))),$localize(It||(It=Nv(["Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.\n         The triangles are the spaces on which pieces move during the game.\n         The tiles can be removed from the board (you will see how later).\n         The dark pieces belong to the first player and can only move on the dark spaces,\n         while the light pieces belong to the second player and can only move on the light spaces.\n         The goal of the game is to capture all of the opponent's pieces."]))),uae.getInitialState()),Ire.anyMove($localize(xt||(xt=Nv(["Move"]))),$localize(At||(At=Nv(["To move a piece, you need to:\n        <ol>\n          <li>Click on one of your pieces.</li>\n          <li>Click on one of the triangular space highlighted in yellow.</li>\n        </ol>\n        You can pass through the opponent's pieces.\n        You're playing first, hence you're playing Dark.<br/><br/>\n        Perform any move."]))),uae.getInitialState(),aae.fromCoordToCoord(new Jne(3,5),new Jne(5,5)),$localize(Rt||(Rt=Nv(["Congratulations! Let's see captures now."])))),Ire.fromMove($localize(Nt||(Nt=Nv(["Capture"]))),$localize(Mt||(Mt=Nv(["Every piece has three neighboring triangular spaces (2 on the sides).\n        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!\n        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>\n        You're playing Light, make a capture."]))),new uae([[dae,dae,dae,dae,dae,dae,vae,fae,vae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,vae,fae,fae,fae,fae,fae,vae,fae,fae,dae,dae,dae],[fae,pae,fae,pae,vae,pae,fae,fae,vae,fae,fae,pae,fae,pae,fae],[pae,fae,fae,fae,fae,fae,fae,fae,fae,fae,pae,fae,fae,fae,pae],[fae,pae,fae,pae,fae,fae,fae,fae,fae,fae,fae,pae,fae,pae,fae],[fae,vae,fae,vae,fae,fae,fae,fae,fae,fae,fae,vae,fae,vae,fae],[vae,fae,fae,fae,vae,fae,fae,fae,fae,fae,vae,fae,fae,fae,vae],[fae,vae,fae,vae,fae,fae,pae,fae,pae,fae,fae,vae,fae,vae,fae],[dae,dae,dae,fae,fae,pae,fae,fae,fae,pae,fae,fae,dae,dae,dae],[dae,dae,dae,dae,dae,dae,pae,fae,pae,dae,dae,dae,dae,dae,dae]],3,[0,0],[0,0]),[aae.fromCoordToCoord(new Jne(5,2),new Jne(4,1)),aae.fromCoordToCoord(new Jne(3,4),new Jne(4,3))],$localize(Dt||(Dt=Nv(["Congratulations!"]))),$localize(Lt||(Lt=Nv(["Failed, you have not captured any piece."])))),Ire.fromMove($localize(Ft||(Ft=Nv(["Gain a tile"]))),$localize(Bt||(Bt=Nv(["When a tile is empty, it can become removable from the board.\n        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.\n        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.\n        For example, here, the topmost dark piece will not disconnect its tile when leaving it.\n        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>\n        Perform a move that lets you gain two tiles."]))),new uae([[dae,dae,dae,dae,dae,dae,fae,fae,fae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,dae,dae,dae,pae,fae,fae,dae,dae,dae,dae,dae,dae],[fae,fae,fae,dae,dae,dae,fae,fae,fae,dae,dae,dae,dae,dae,dae],[fae,fae,pae,fae,fae,fae,fae,vae,fae,dae,dae,dae,dae,dae,dae],[fae,fae,fae,pae,fae,fae,fae,fae,fae,dae,dae,dae,dae,dae,dae],[fae,fae,fae,fae,fae,fae,fae,fae,fae,fae,fae,vae,dae,dae,dae],[fae,fae,vae,fae,fae,pae,fae,fae,fae,fae,vae,fae,fae,fae,vae],[fae,fae,fae,fae,fae,fae,pae,fae,pae,fae,fae,vae,fae,vae,fae],[dae,dae,dae,fae,fae,pae,fae,fae,fae,pae,fae,fae,dae,dae,dae],[dae,dae,dae,dae,dae,dae,pae,fae,pae,dae,dae,dae,dae,dae,dae]],2,[0,0],[0,0]),[aae.fromCoordToCoord(new Jne(2,6),new Jne(4,6)),aae.fromCoordToCoord(new Jne(2,6),new Jne(3,5)),aae.fromCoordToCoord(new Jne(2,6),new Jne(3,7))],$localize(Vt||(Vt=Nv(["Congratulations!"]))),$localize(Ut||(Ut=Nv(["Failed, you have not gained the two tiles that you could, try again!"])))),Ire.fromMove($localize(zt||(zt=Nv(["Exchanging a tile"]))),$localize(Ht||(Ht=Nv(["When you have a tile, you can see it on the left of the board.\n        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.\n        This will cost you two tiles.\n        If any tiles are removed during that turn, nobody will get them.<br/><br/>\n        Gain some time and capture the last piece!"]))),new uae([[dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,fae,fae,vae,dae,dae,dae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,fae,fae,fae,fae,fae,fae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,fae,fae,fae,pae,fae,pae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,fae,fae,pae,fae,fae,fae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,dae,dae,dae,pae,fae,pae,dae,dae,dae,dae,dae,dae]],1,[0,2],[0,0]),[aae.fromTilesExchange(new Jne(5,5))],$localize(Gt||(Gt=Nv(["Congratulations!"]))),$localize(qt||(qt=Nv(["It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!"])))),Ire.fromMove($localize($t||($t=Nv(["Special capture"]))),$localize(Wt||(Wt=Nv(["When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!\n        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>\n        A move that demonstrate both of these things can be done on this board by Light. Try it!"]))),new uae([[dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,dae,dae,dae,fae,fae,vae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,fae,fae,vae,fae,fae,fae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,fae,vae,pae,fae,pae,fae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,fae,pae,vae,fae,fae,fae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,fae,fae,pae,dae,dae,dae,dae,dae,dae,dae,dae,dae],[dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae,dae]],1,[0,0],[0,0]),[aae.fromCoordToCoord(new Jne(7,6),new Jne(6,5)),aae.fromCoordToCoord(new Jne(7,6),new Jne(8,5))],$localize(jt||(jt=Nv(["Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.\n        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space."]))),$localize(Zt||(Zt=Nv(["Failed!"]))))]});function yae(e,t){if(1&e&&(wm(),db(0,"polygon",13)),2&e){var n=Cb().index,r=Cb().index,i=Cb();cb("ngClass",i.getPyramidClass(n,r)),nb("points",i.getPyramidCoordinate(n,r))}}function mae(e,t){if(1&e&&(wm(),db(0,"polygon",15)),2&e){var n=Cb(2).index,r=Cb().index,i=Cb();cb("ngClass",i.getEmptyClass(n,r)),nb("points",i.getTriangleCoordinate(n,r))}}function kae(e,t){if(1&e&&(wm(),ob(0,mae,1,2,"polygon",14)),2&e){var n=Cb().index,r=Cb().index;cb("ngIf",Cb().isEmptyCase(n,r))}}function _ae(e,t){if(1&e&&(wm(),db(0,"polygon",16)),2&e){var n=Cb().index,r=Cb().index,i=Cb();Eb("id","dark_line_",n,"_",r,""),nb("points",i.getLineCoordinate(n,r))}}function wae(e,t){if(1&e&&(wm(),db(0,"polygon",17)),2&e){var n=Cb().index,r=Cb().index,i=Cb();Eb("id","dark_line_",n,"_",r,""),nb("points",i.getLineCoordinate(n,r))}}function Cae(e,t){if(1&e){var n=gb();wm(),hb(0,"g",8),kb("click",function(){var e=Wy(n).index,t=Cb().index;return Cb().onClick(e,t)}),ob(1,yae,1,2,"polygon",9),ob(2,kae,1,1,"ng-template",null,10,IP),ob(4,_ae,1,3,"polygon",11),ob(5,wae,1,3,"polygon",12),fb()}if(2&e){var r=t.$implicit,i=t.index,a=sb(3),o=Cb().index,s=Cb();Eb("id","click_",i,"_",o,""),Ow(1),cb("ngIf",s.isPyramid(i,o))("ngIfElse",a),Ow(3),cb("ngIf",r!==s.NONE),Ow(1),cb("ngIf",r!==s.NONE)}}function bae(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,Cae,6,6,"g",7),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}function Eae(e,t){if(1&e&&(wm(),db(0,"polygon",18)),2&e){var n=t.$implicit;nb("points",Cb().getTriangleCoordinate(n.x,n.y))}}function Sae(e,t){if(1&e&&(wm(),db(0,"polygon",19)),2&e){var n=Cb();nb("points",n.getTriangleCoordinate(n.lastStart.get().x,n.lastStart.get().y))}}function Pae(e,t){if(1&e&&(wm(),db(0,"polygon",19)),2&e){var n=Cb();nb("points",n.getTriangleCoordinate(n.lastEnd.get().x,n.lastEnd.get().y))}}function Oae(e,t){if(1&e&&(wm(),db(0,"polygon",20)),2&e){var n=Cb();nb("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}function Tae(e,t){if(1&e&&(wm(),hb(0,"g",21),db(1,"polygon",22),hb(2,"text",23),Nb(3),fb(),fb()),2&e){var n=Cb();Ow(1),nb("points",n.getTilesCountCoordinate(0,0))("stroke",n.lastTurnWasTilesExchange(0)?"yellow":"black"),Ow(1),nb("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+0*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),Ow(1),Mb(n.tiles[0])}}function Iae(e,t){if(1&e&&(wm(),hb(0,"g",24),db(1,"polygon",25),hb(2,"text",26),Nb(3),fb(),fb()),2&e){var n=Cb();Ow(1),nb("points",n.getTilesCountCoordinate(0,9))("stroke",n.lastTurnWasTilesExchange(1)?"yellow":"black"),Ow(1),nb("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+9*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),Ow(1),Mb(n.tiles[1])}}var xae=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).tiles=[0,0],r.NONE=nre.NONE,r.chosenCoord=cB.empty(),r.lastStart=cB.empty(),r.lastEnd=cB.empty(),r.highlights=[],r.scores=cB.of([0,0]),r.rules=new cae(uae),r.availableMinimaxes=[new lae(r.rules,"Normal"),new hae(r.rules,"Piece > Threat > Tiles")],r.encoder=aae.encoder,r.tutorial=(new gae).tutorial,r.SPACE_SIZE=70,r.updateBoard(),r}return ip(n,[{key:"updateBoard",value:function(){this.chosenCoord=cB.empty(),this.state=this.rules.node.gameState,this.scores=cB.of(this.state.captures),this.tiles=this.state.tiles;var e=this.rules.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=cB.empty(),this.lastEnd=cB.empty()),this.board=this.rules.node.gameState.board}},{key:"showHighlight",value:function(){this.highlights=this.state.getLegalLandings(this.chosenCoord.get())}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=cB.empty(),this.highlights=[]}},{key:"onClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new Jne(e,t),r.abrupt("return",n.chosenCoord.isAbsent()?n.firstClick(a):n.secondClick(a));case 5:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.state.getPieceAt(e)).is(t.state.getCurrentOpponent())){n.next=4;break}return i=aae.fromTilesExchange(e),n.abrupt("return",t.chooseMove(i,t.state,t.state.captures));case 4:return n.abrupt("return",r.is(t.state.getCurrentPlayer())?(t.chosenCoord=cB.of(e),t.showHighlight(),$5.SUCCESS):t.cancelMove(rae.FIRST_CLICK_SHOULD_NOT_BE_NULL()));case 5:case"end":return n.stop()}},n)}))()}},{key:"secondClick",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.equals(t.chosenCoord.get())){n.next=2;break}return n.abrupt("return",(t.cancelMoveAttempt(),$5.SUCCESS));case 2:if(!t.highlights.some(function(t){return t.equals(e)})){n.next=5;break}return r=aae.fromCoordToCoord(t.chosenCoord.get(),e),n.abrupt("return",t.chooseMove(r,t.state,t.state.captures));case 5:return n.abrupt("return",t.cancelMove(rae.INVALID_DISTANCE()));case 6:case"end":return n.stop()}},n)}))()}},{key:"isPyramid",value:function(e,t){return this.board[t][e].isPlayer()||this.wasOpponent(e,t)}},{key:"wasOpponent",value:function(e,t){var n=this.rules.node.mother;return n.isPresent()&&n.get().gameState.getPieceAtXY(e,t).is(n.get().gameState.getCurrentOpponent())}},{key:"getPyramidClass",value:function(e,t){var n=this.board[t][e];return n===nre.ZERO?this.getPlayerClass(Zee.ZERO):n===nre.ONE?this.getPlayerClass(Zee.ONE):"captured"}},{key:"isEmptyCase",value:function(e,t){return this.board[t][e]===nre.EMPTY||this.wasRemoved(e,t)}},{key:"wasRemoved",value:function(e,t){var n=this.rules.node.mother;if(this.board[t][e]===nre.NONE&&n.isPresent()){var r=n.get().gameState.getPieceAtXY(e,t);return r===nre.EMPTY||r.is(n.get().gameState.getCurrentPlayer())}return!1}},{key:"getEmptyClass",value:function(e,t){return this.board[t][e]===nre.EMPTY?(e+t)%2==1?"background":"background2":"captured2"}},{key:"getTilesCountCoordinate",value:function(e,t){var n=100*e,r=100*t,i=n+25;return i+", "+r+", "+(n+75)+", "+r+", "+(n+100)+", "+(r+50)+", "+(n+75)+", "+(r+100)+", "+(n+25)+", "+(r+100)+", "+(n+0)+", "+(r+50)+", "+i+", "+r}},{key:"getLineCoordinate",value:function(e,t){var n=this.getTriangleCornerCoords(e,t);return e%3==0?n[0].x+","+n[0].y+","+n[1].x+","+n[1].y:e%3==1?n[0].x+","+n[0].y+","+n[2].x+","+n[2].y:n[1].x+","+n[1].y+","+n[2].x+","+n[2].y}},{key:"mustShowTilesOf",value:function(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}},{key:"lastTurnWasTilesExchange",value:function(e){return!this.rules.node.mother.isAbsent()&&this.rules.node.mother.get().gameState.tiles[e]>this.tiles[e]}}]),n}(nae);return e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-coerceo"]],features:[HC],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill highlighted",4,"ngFor","ngForOf"],["class","base no-fill last-move",4,"ngIf"],["class","base no-fill selected",4,"ngIf"],["id","tilesCountZero",4,"ngIf"],["id","tilesCountOne",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptyCase",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","last-move"],[1,"base","no-fill","selected"],["id","tilesCountZero"],["stroke-linecap","round",1,"base","player0"],["id","playerZeroTilesCount","text-anchor","middle",1,"text"],["id","tilesCountOne"],["stroke-linecap","round",1,"base","player1"],["id","playerOneTilesCount","text-anchor","middle",1,"text"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),ob(1,bae,2,1,"g",1),ob(2,Eae,1,1,"polygon",2),ob(3,Sae,1,1,"polygon",3),ob(4,Pae,1,1,"polygon",3),ob(5,Oae,1,1,"polygon",4),ob(6,Tae,4,6,"g",5),ob(7,Iae,4,6,"g",6),fb()),2&e&&(nb("viewBox","-5 -5 "+(10+8*t.SPACE_SIZE)+" "+(10+10*t.SPACE_SIZE)),Ow(1),cb("ngForOf",t.board),Ow(1),cb("ngForOf",t.highlights),Ow(1),cb("ngIf",t.lastStart.isPresent()),Ow(1),cb("ngIf",t.lastEnd.isPresent()),Ow(1),cb("ngIf",t.chosenCoord.isPresent()),Ow(1),cb("ngIf",t.mustShowTilesOf(0)),Ow(1),cb("ngIf",t.mustShowTilesOf(1)))},directives:[NT,DT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Aae=function(){var e=ip(function e(){np(this,e)});return e.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=function(){return $localize(Yt||(Yt=Nv(["Your piece should land on a neighboring square."])))},e.CANNOT_DROP_AFTER_TURN_40=function(){return $localize(Kt||(Kt=Nv(["You cannot drop a piece during the moving phase."])))},e.CANNOT_MOVE_BEFORE_TURN_40=function(){return $localize(Jt||(Jt=Nv(["You cannot move a piece before both players have dropped all of their pieces."])))},e.MUST_JUMP_OVER_PIECES=function(){return $localize(Qt||(Qt=Nv(["A jump must be made over a piece, not over an empty square."])))},e.MUST_DROP_IN_CENTRAL_ZONE=function(){return $localize(Xt||(Xt=Nv(["A drop must occur in the central zone of the board."])))},e.INVALID_JUMP=function(){return $localize(en||(en=Nv(["A jump must land two squares from its original position, and be done in a straight line in any direction."])))},e.SAME_LOCATION_VISITED_IN_JUMP=function(){return $localize(tn||(tn=Nv(["You are visiting the same location twice in a move, you are not allowed to do so."])))},e}(),Rae=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"isShelter",value:function(e){return 0===e.x||e.x===n.WIDTH-1?n.SHELTERS_INDICES.some(function(t){return e.y===t}):(0===e.y||e.y===n.HEIGHT-1)&&n.SHELTERS_INDICES.some(function(t){return e.x===t})}},{key:"isCentralZone",value:function(e){return e.x>=n.CENTRAL_ZONE_TOP_LEFT.x&&e.x<=n.CENTRAL_ZONE_BOTTOM_RIGHT.x&&e.y>=n.CENTRAL_ZONE_TOP_LEFT.y&&e.y<=n.CENTRAL_ZONE_BOTTOM_RIGHT.y}},{key:"isDropPhase",value:function(){return this.turn<40}},{key:"getSidePieces",value:function(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}],[{key:"getInitialState",value:function(){return new n(Q5.createTable(n.WIDTH,n.HEIGHT,Zee.NONE),0)}}]),n}(vre);Rae.WIDTH=17,Rae.HEIGHT=17,Rae.CENTRAL_ZONE_TOP_LEFT=new Jne(4,6),Rae.CENTRAL_ZONE_BOTTOM_RIGHT=new Jne(12,10),Rae.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],Rae.ALL_SHELTERS=new fre(Rae.SHELTERS_INDICES.flatMap(function(e){return[new Jne(e,0),new Jne(e,Rae.HEIGHT-1),new Jne(0,e),new Jne(Rae.WIDTH-1,e)]})).toList();var Nae=function(e){qv(n,e);var t=Wv(n);function n(e){return np(this,n),t.call(this,e.x,e.y)}return ip(n,[{key:"toString",value:function(){return"ConspirateursMoveDrop(".concat(this.coord.toString(),")")}},{key:"equals",value:function(e){return!!e.isDrop()&&this.coord.equals(e.coord)}},{key:"isDrop",value:function(){return!0}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e){return e.isInRange(Rae.WIDTH,Rae.HEIGHT)?H5.success(new n(e)):H5.failure("Move out of board")}}]),n}(yre);Nae.encoder=function(){function e(){np(this,e)}return ip(e,null,[{key:"getEncoder",value:function(e,t,n){return new(function(r){qv(a,r);var i=Wv(a);function a(){var e;return np(this,a),(e=i.apply(this,arguments)).shiftX=t,e}return ip(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftX+e.coord.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new Jne((r-=r%1)%e,i);return n(a)}}]),a}(jee))}}]),e}().getEncoder(Rae.WIDTH,Rae.HEIGHT,function(e){return Nae.of(e).get()});var Mae=function(e){qv(n,e);var t=Wv(n);function n(e,r){return np(this,n),t.call(this,e,r)}return ip(n,[{key:"toString",value:function(){return"ConspirateursMoveSimple(".concat(this.coord.toString()," -> ").concat(this.end.toString(),")")}},{key:"equals",value:function(e){return!(!e.isSimple()||e!==this&&(!1===e.coord.equals(this.coord)||!1===e.end.equals(this.end)))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!0}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e,t){return e.isInRange(Rae.WIDTH,Rae.HEIGHT)&&t.isInRange(Rae.WIDTH,Rae.HEIGHT)?e.isAlignedWith(t)&&1===e.getDistance(t)?H5.success(new n(e,t)):H5.failure(Aae.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):H5.failure("Move out of board")}}]),n}(_ie);Mae.encoder=_ie.getEncoder(Rae.WIDTH,Rae.HEIGHT,function(e,t){return Mae.of(e,t).get()});var Dae=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this)).coords=e,r}return ip(n,[{key:"addJump",value:function(e){var t=Q5.copyImmutableArray(this.coords);return t.push(e),n.of(t)}},{key:"getStartingCoord",value:function(){return this.coords[0]}},{key:"getEndingCoord",value:function(){return this.coords[this.coords.length-1]}},{key:"getLandingCoords",value:function(){return this.coords.slice(1)}},{key:"getJumpedOverCoords",value:function(){for(var e=[],t=1;t<this.coords.length;t++){var n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}},{key:"toString",value:function(){return"ConspirateursMoveJump(".concat(this.coords.map(function(e){return e.toString()}).reduce(function(e,t){return e+" -> "+t}),")")}},{key:"equals",value:function(e){return!(e.isSimple()||e.isDrop()||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!0}}],[{key:"of",value:function(e){if(e.length<2)return H5.failure("ConspirateursMoveJump requires at least one jump, so two coords");var t,r=Xv(e);try{for(r.s();!(t=r.n()).done;){if(t.value.isNotInRange(Rae.WIDTH,Rae.HEIGHT))return H5.failure("Move out of board")}}catch(a){r.e(a)}finally{r.f()}for(var i=1;i<e.length;i++)if(e[i-1].getDirectionToward(e[i]).isFailure()||2!==e[i-1].getDistance(e[i]))return H5.failure(Aae.INVALID_JUMP());return new Die(e).size()===e.length?H5.success(new n(e)):H5.failure(Aae.SAME_LOCATION_VISITED_IN_JUMP())}}]),n}(gre);Dae.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.apply(this,arguments)).coordEncoder=Jne.numberEncoder(Rae.WIDTH,Rae.HEIGHT),e}return ip(n,[{key:"encodeMove",value:function(e){return{coords:e.coords.map(this.coordEncoder.encodeNumber)}}},{key:"decodeMove",value:function(e){Z5(null!=iB.getNonNullable(e).coords,"Encoded ConspirateursMoveJump should contain coords");var t=iB.getNonNullable(e).coords.map(this.coordEncoder.decodeNumber);return Dae.of(t).get()}}]),n}(Wee));var Lae=Wee.disjunction3(Nae.encoder,Mae.encoder,Dae.encoder,function(e){return e.isDrop()},function(e){return e.isSimple()}),Fae=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.call(this,Rae)}return ip(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();if(e.isDrop())r[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(e.isSimple())r[e.coord.y][e.coord.x]=Zee.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer();else{var i=e.getStartingCoord(),a=e.getEndingCoord();r[i.y][i.x]=Zee.NONE,r[a.y][a.x]=t.getCurrentPlayer()}return new Rae(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.dropLegality(e,t):e.isSimple()?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}},{key:"dropLegality",value:function(e,t){return t.turn>=40?H5.failure(Aae.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord)!==Zee.NONE?H5.failure(ure.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?H5.failure(Aae.MUST_DROP_IN_CENTRAL_ZONE()):H5.success(void 0)}},{key:"simpleMoveLegality",value:function(e,t){return t.turn<40?H5.failure(Aae.CANNOT_MOVE_BEFORE_TURN_40()):t.getPieceAt(e.coord)!==t.getCurrentPlayer()?H5.failure(ure.MUST_CHOOSE_PLAYER_PIECE()):t.getPieceAt(e.end)!==Zee.NONE?H5.failure(ure.MUST_LAND_ON_EMPTY_SPACE()):H5.success(void 0)}},{key:"jumpLegality",value:function(e,t){if(t.turn<40)return H5.failure(Aae.CANNOT_MOVE_BEFORE_TURN_40());if(t.getPieceAt(e.getStartingCoord())!==t.getCurrentPlayer())return H5.failure(ure.MUST_CHOOSE_PLAYER_PIECE());var n,r=Xv(e.getJumpedOverCoords());try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.getPieceAt(i)===Zee.NONE)return H5.failure(Aae.MUST_JUMP_OVER_PIECES())}}catch(u){r.e(u)}finally{r.f()}var a,o=Xv(e.getLandingCoords());try{for(o.s();!(a=o.n()).done;){var s=a.value;if(t.getPieceAt(s)!==Zee.NONE)return H5.failure(ure.MUST_LAND_ON_EMPTY_SPACE())}}catch(u){o.e(u)}finally{o.f()}return H5.success(void 0)}},{key:"jumpTargetsFrom",value:function(e){for(var t=[],n=0,r=[new Jne(e.x+2,e.y),new Jne(e.x-2,e.y),new Jne(e.x,e.y+2),new Jne(e.x,e.y-2),new Jne(e.x+2,e.y+2),new Jne(e.x+2,e.y-2),new Jne(e.x-2,e.y+2),new Jne(e.x-2,e.y-2)];n<r.length;n++){var i=r[n];Dae.of([e,i]).isSuccess()&&t.push(i)}return t}},{key:"nextJumps",value:function(e,t){var n,r=e.getEndingCoord(),i=[],a=Xv(this.jumpTargetsFrom(r));try{for(a.s();!(n=a.n()).done;){var o=n.value,s=e.addJump(o);s.isSuccess()&&this.jumpLegality(s.get(),t).isSuccess()&&i.push(s.get())}}catch(u){a.e(u)}finally{a.f()}return i}},{key:"jumpHasPossibleNextTargets",value:function(e,t){return this.nextJumps(e,t).length>0}},{key:"getGameStatus",value:function(e){var t,n=e.gameState,r=[0,0],i=Xv(Rae.ALL_SHELTERS);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=n.getPieceAt(a);if(o!==Zee.NONE&&(r[o.value]+=1,20===r[o.value]))return Ere.getVictory(o)}}catch(s){i.e(s)}finally{i.f()}return Ere.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=cB.of(new n)),n.singleton.get()}}]),n}(Sre);Fae.singleton=cB.empty();var Bae=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){return e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState)}},{key:"getListMovesDrop",value:function(e){for(var t=[],n=Rae.CENTRAL_ZONE_TOP_LEFT,r=Rae.CENTRAL_ZONE_BOTTOM_RIGHT,i=n.y;i<=r.y;i++)for(var a=n.x;a<=r.x;a++)e.getPieceAtXY(a,i)===Zee.NONE&&t.push(Nae.of(new Jne(a,i)).get());return t}},{key:"getListMovesAfterDrop",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<Rae.HEIGHT;r++)for(var i=0;i<Rae.WIDTH;i++){var a=new Jne(i,r);e.getPieceAt(a)===n&&(t=(t=t.concat(this.getListSimpleMoves(e,a))).concat(this.getListJumps(e,a)))}return t}},{key:"getListSimpleMoves",value:function(e,t){for(var n=[],r=0,i=[new Jne(t.x+1,t.y),new Jne(t.x-1,t.y),new Jne(t.x,t.y+1),new Jne(t.x,t.y-1),new Jne(t.x+1,t.y+1),new Jne(t.x+1,t.y-1),new Jne(t.x-1,t.y+1),new Jne(t.x-1,t.y-1)];r<i.length;r++){var a=i[r],o=Mae.of(t,a);o.isSuccess()&&Fae.get().simpleMoveLegality(o.get(),e).isSuccess()&&n.push(o.get())}return n}},{key:"getListJumps",value:function(e,t){var n,r=new fre,i=Xv(Fae.get().jumpTargetsFrom(t));try{for(i.s();!(n=i.n()).done;){var a=n.value,o=Dae.of([t,a]).get();Fae.get().jumpLegality(o,e).isSuccess()&&(r.add(o),r.union(this.getListJumpStartingFrom(e,o)))}}catch(s){i.e(s)}finally{i.f()}return r.toList()}},{key:"getListJumpStartingFrom",value:function(e,t){var n,r=Fae.get().nextJumps(t,e),i=new fre(r),a=Xv(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;i.union(this.getListJumpStartingFrom(e,o))}}catch(s){a.e(s)}finally{a.f()}return i}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=0,r=new _re;r.set(Zee.ZERO,0),r.set(Zee.ONE,0);for(var i=0;i<Rae.HEIGHT;i++)for(var a=0;a<Rae.WIDTH;a++){var o=new Jne(a,i),s=t.getPieceAt(o);if(s!==Zee.NONE)if(t.isShelter(o)){if(n+=20*s.getScoreModifier(),r.replace(s,r.get(s).get()+1),20===r.get(s).get())return new lre(s.getVictoryValue())}else{var u,c=100,l=Xv(Rae.ALL_SHELTERS);try{for(l.s();!(u=l.n()).done;){var h=u.value;if(t.getPieceAt(h)===Zee.NONE){var f=o.getOrthogonalDistance(h);c=Math.min(c,f)}}}catch(d){l.e(d)}finally{l.f()}n-=s.getScoreModifier()*c}}return new lre(n)}}]),n}(cre),Vae=Zee.NONE,Uae=Zee.ZERO,zae=Zee.ONE,Hae=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(nn||(nn=Nv(["Board and aim of the game"]))),$localize(rn||(rn=Nv(["Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially."]))),Rae.getInitialState()),Ire.anyMove($localize(an||(an=Nv(["Initial phase"]))),$localize(on||(on=Nv(["In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>Drop one of your piece in the central zone."]))),Rae.getInitialState(),Nae.of(new Jne(7,7)).get(),$localize(sn||(sn=Nv(["Congratulations!"])))),Ire.fromPredicate($localize(un||(un=Nv(["Simple move"]))),$localize(cn||(cn=Nv(["Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move."]))),new Rae([[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Uae,Uae,zae,zae,Uae,Uae,zae,Uae,zae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Uae,zae,Uae,zae,Uae,Uae,Uae,Uae,zae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Uae,zae,Vae,Vae,Vae,Vae,Vae,zae,Uae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,zae,Uae,Uae,zae,zae,zae,Uae,Uae,Uae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,zae,Uae,zae,zae,zae,zae,zae,zae,Uae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae]],40),Mae.of(new Jne(4,6),new Jne(3,5)).get(),function(e,t){return e.isSimple()?$5.SUCCESS:$5.failure($localize(ln||(ln=Nv(["You have made a jump, not a simple move. Try again!"]))))},$localize(hn||(hn=Nv(["Congratulations!"])))),Ire.fromPredicate($localize(fn||(fn=Nv(["Jumps"]))),$localize(dn||(dn=Nv(["The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful)."]))),new Rae([[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Uae,Uae,zae,zae,Uae,Uae,zae,Uae,zae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Uae,zae,Uae,zae,Uae,Uae,Uae,Uae,zae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Uae,zae,Vae,Vae,Vae,Vae,Vae,zae,Uae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,zae,Uae,Uae,zae,zae,zae,Uae,Uae,Uae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,zae,Uae,zae,zae,zae,zae,zae,zae,Uae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae]],40),Dae.of([new Jne(6,7),new Jne(6,5)]).get(),function(e,t){return e.isJump()?$5.SUCCESS:$5.failure($localize(vn||(vn=Nv(["You have not performed a jump. Try again!"]))))},$localize(pn||(pn=Nv(["Congratulations!"])))),Ire.fromMove($localize(gn||(gn=Nv(["Chaining jumps in a single move"]))),$localize(yn||(yn=Nv(["Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it."]))),new Rae([[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,zae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,zae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,zae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Uae,Uae,Vae,zae,Uae,Uae,zae,Uae,zae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Uae,Vae,Uae,zae,Uae,Uae,Uae,Uae,zae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Uae,zae,Vae,Vae,Vae,Vae,Vae,zae,Uae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,zae,Uae,Uae,zae,zae,zae,Uae,Uae,Uae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,zae,Uae,zae,zae,zae,zae,zae,zae,Uae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae]],40),[Dae.of([new Jne(8,6),new Jne(6,4),new Jne(6,2),new Jne(6,0)]).get()],$localize(mn||(mn=Nv(["Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does."]))),$localize(kn||(kn=Nv(["You have not performed a triple jump. Try again!"]))))]});function Gae(e,t){if(1&e){var n=gb();wm(),hb(0,"rect",9),kb("click",function(){Wy(n);var e=Cb().$implicit;return Cb(2).onClick(e.coord)}),fb()}if(2&e){var r=Cb().$implicit,i=Cb(2);nb("x",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.x+i.STROKE_WIDTH)("y",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE-3*i.STROKE_WIDTH)("height",i.SPACE_SIZE-3*i.STROKE_WIDTH)}}function qae(e,t){if(1&e){var n=gb();wm(),hb(0,"circle",6),kb("click",function(){Wy(n);var e=Cb().$implicit;return Cb(2).onClick(e.coord)}),fb()}if(2&e){var r=Cb(),i=r.index,a=r.$implicit,o=Cb().index,s=Cb();Eb("id","piece_",i,"_",o,""),cb("ngClass",a.pieceClasses),nb("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE*i+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*o+s.STROKE_WIDTH+s.SPACE_SIZE/2)}}function $ae(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"rect",6),kb("click",function(){var e=Wy(n).$implicit;return Cb(2).onClick(e.coord)}),fb(),ob(2,Gae,1,4,"rect",7),ob(3,qae,1,6,"circle",8),fb()}if(2&e){var r=t.$implicit,i=t.index,a=Cb().index,o=Cb();Ow(1),Eb("id","click_",i,"_",a,""),cb("ngClass",r.squareClasses),nb("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Ow(1),cb("ngIf",r.isShelter),Ow(1),cb("ngIf",r.hasPiece)}}function Wae(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,$ae,4,9,"g",1),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}function jae(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"rect",10),kb("click",function(){var e=Wy(n).$implicit;return Cb().onClick(e)}),fb(),fb()}if(2&e){var r=t.$implicit,i=Cb();Ow(1),cb("ngClass",i.viewInfo.boardInfo[r.y][r.x].shelterClasses),nb("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function Zae(e,t){if(1&e&&(wm(),db(0,"circle",11)),2&e){var n=t.$implicit,r=Cb();bb("id","sidePiece_0_",n,""),nb("cx",-r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function Yae(e,t){if(1&e&&(wm(),db(0,"circle",12)),2&e){var n=t.$implicit,r=Cb();bb("id","sidePiece_1_",n,""),nb("cx",1715+r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function Kae(e,t){if(1&e&&(wm(),db(0,"rect",13)),2&e){var n=Cb();nb("x",n.SPACE_SIZE*n.CENTRAL_ZONE_START.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*n.CENTRAL_ZONE_START.y+n.STROKE_WIDTH)("width",n.CENTRAL_ZONE_SIZE.x*n.SPACE_SIZE)("height",n.CENTRAL_ZONE_SIZE.y*n.SPACE_SIZE)}}var Jae=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).ALL_SHELTERS=Rae.ALL_SHELTERS,r.CENTRAL_ZONE_START=Rae.CENTRAL_ZONE_TOP_LEFT,r.CENTRAL_ZONE_SIZE=new Wne(Rae.CENTRAL_ZONE_BOTTOM_RIGHT.x-Rae.CENTRAL_ZONE_TOP_LEFT.x+1,Rae.CENTRAL_ZONE_BOTTOM_RIGHT.y-Rae.CENTRAL_ZONE_TOP_LEFT.y+1),r.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},r.selected=cB.empty(),r.jumpInConstruction=cB.empty(),r.PIECE_RADIUS=.5*(r.SPACE_SIZE-2*r.STROKE_WIDTH),r.rules=Fae.get(),r.availableMinimaxes=[new Bae(r.rules,"ConspirateursMinimax")],r.encoder=Lae,r.tutorial=(new Hae).tutorial,r}return ip(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"updateViewInfo",value:function(){var e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(var t=0;t<Rae.HEIGHT;t++){this.viewInfo.boardInfo.push([]);for(var n=0;n<Rae.WIDTH;n++){var r=new Jne(n,t),i=e.getPieceAt(r),a={coord:r,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(i)],hasPiece:i!==Zee.NONE,isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[t].push(a)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}},{key:"updateOccupiedShelters",value:function(){var e,t=Xv(Rae.ALL_SHELTERS);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=this.viewInfo.boardInfo[n.y][n.x];r.isShelter=!0,r.hasPiece&&r.shelterClasses.push("highlighted")}}catch(i){t.e(i)}finally{t.f()}}},{key:"updateSelected",value:function(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){var e=this.jumpInConstruction.get(),t=e.getStartingCoord(),n=e.getEndingCoord();this.viewInfo.boardInfo[t.y][t.x].hasPiece=!1,this.viewInfo.boardInfo[n.y][n.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected"],this.viewInfo.boardInfo[n.y][n.x].hasPiece=!0;var r,i=Xv(e.coords);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.boardInfo[a.y][a.x].squareClasses.push("moved")}}catch(s){i.e(s)}finally{i.f()}}else{var o=this.selected.get();this.viewInfo.boardInfo[o.y][o.x].pieceClasses.push("selected")}}},{key:"updateVictory",value:function(){var e=this.getState(),t=Fae.get().getGameStatus(this.rules.node);if(!0===t.isEndGame){var n,r=Xv(Rae.ALL_SHELTERS);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.getPieceAt(i)===t.winner&&this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("victory")}}catch(a){r.e(a)}finally{r.f()}}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved");else if(e.isSimple())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved"),this.viewInfo.boardInfo[e.end.y][e.end.x].squareClasses.push("moved");else{this.viewInfo.lastMoveArrow="";var t,n=Xv(e.coords);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved"),this.viewInfo.lastMoveArrow+=r.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=r.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}catch(i){n.e(i)}finally{n.f()}}}},{key:"cancelMoveAttempt",value:function(){this.jumpInConstruction=cB.empty(),this.selected=cB.empty(),this.updateBoard()}},{key:"onClick",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if((i=t.getState()).getPieceAt(e)!==t.getCurrentPlayer()){n.next=6;break}return n.abrupt("return",(t.selected=cB.of(e),t.jumpInConstruction=cB.empty(),t.updateViewInfo(),$5.SUCCESS));case 6:if(!t.jumpInConstruction.isPresent()){n.next=8;break}return n.abrupt("return",t.constructJump(e));case 8:if(!t.selected.isPresent()){n.next=10;break}return n.abrupt("return",t.selectNextCoord(e));case 10:if(!i.isDropPhase()){n.next=13;break}return a=Nae.of(e),n.abrupt("return",(Z5(a.isSuccess(),"ConspirateursMove should be valid by construction"),t.chooseMove(a.get(),i)));case 13:return n.abrupt("return",t.cancelMove(ure.MUST_CHOOSE_PLAYER_PIECE()));case 14:case"end":return n.stop()}},n)}))()}},{key:"constructJump",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.jumpInConstruction.get(),i=t.getState(),!e.equals(r.getEndingCoord())){n.next=3;break}return n.abrupt("return",t.chooseMove(r,i));case 3:if(!(a=r.addJump(e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(a.getReason()));case 6:return o=t.rules.jumpLegality(a.get(),i),n.abrupt("return",o.isFailure()?t.cancelMove(o.getReason()):t.updateJump(a.get()));case 8:case"end":return n.stop()}},n)}))()}},{key:"updateJump",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getState(),n.abrupt("return",t.rules.jumpHasPossibleNextTargets(e,r)?(t.jumpInConstruction=cB.of(e),t.updateViewInfo(),$5.SUCCESS):t.chooseMove(e,r));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectNextCoord",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.selected.get(),!(i=Mae.of(r,e)).isSuccess()){n.next=3;break}return n.abrupt("return",t.chooseMove(i.get(),t.getState()));case 3:return a=Dae.of([r,e]),n.abrupt("return",a.isFailure()?t.cancelMove(a.getReason()):t.updateJump(a.get()));case 5:case"end":return n.stop()}},n)}))()}}]),n}(ere);return e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-conspirateurs"]],features:[HC],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1",3,"id",4,"ngFor","ngForOf"],["class","base no-fill highlighted mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0",3,"id"],[1,"base","mid-stroke","player1",3,"id"],[1,"base","no-fill","highlighted","mid-stroke"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),ob(1,Wae,2,1,"g",1),ob(2,jae,2,5,"g",1),ob(3,Zae,1,4,"circle",2),ob(4,Yae,1,4,"circle",3),ob(5,Kae,1,4,"rect",4),db(6,"polyline",5),fb()),2&e&&(Ow(1),cb("ngForOf",t.viewInfo.boardInfo),Ow(1),cb("ngForOf",t.ALL_SHELTERS),Ow(1),cb("ngForOf",t.range(t.viewInfo.sidePieces[0])),Ow(1),cb("ngForOf",t.range(t.viewInfo.sidePieces[1])),Ow(1),cb("ngIf",t.viewInfo.dropPhase),Ow(1),nb("points",t.viewInfo.lastMoveArrow))},directives:[NT,DT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Qae=function(){function e(t,n){np(this,e),this.owner=t,this.otherPieceType=n}return ip(e,[{key:"toString",value:function(){return"DiamPiece(".concat(this.owner,", ").concat(this.otherPieceType,")")}}],[{key:"of",value:function(t,n){return t===Zee.ZERO?n?e.ZERO_SECOND:e.ZERO_FIRST:t===Zee.ONE?n?e.ONE_SECOND:e.ONE_FIRST:e.EMPTY}}]),e}();Qae.encoder=jee.tuple([Zee.numberEncoder,jee.booleanEncoder],function(e){return[e.owner,e.otherPieceType]},function(e){return Qae.of(e[0],e[1])}),Qae.EMPTY=new Qae(Zee.NONE,!1),Qae.ZERO_FIRST=new Qae(Zee.ZERO,!1),Qae.ZERO_SECOND=new Qae(Zee.ZERO,!0),Qae.ONE_FIRST=new Qae(Zee.ONE,!1),Qae.ONE_SECOND=new Qae(Zee.ONE,!0),Qae.PLAYER_PIECES=[Qae.ZERO_FIRST,Qae.ZERO_SECOND,Qae.ONE_FIRST,Qae.ONE_SECOND];var Xae=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;if(np(this,n),(i=t.call(this)).target=e,i.piece=r,r===Qae.EMPTY)throw new Error("Cannot drop an empty piece");return jv(i)}return ip(n,[{key:"isDrop",value:function(){return!0}},{key:"getTarget",value:function(){return this.target}},{key:"equals",value:function(e){return!(this.target!==e.target||this.piece!==e.piece)}},{key:"toString",value:function(){return"DiamMoveDrop(".concat(this.target,", ").concat(this.piece,")")}}]),n}(gre);Xae.encoder=jee.tuple([jee.numberEncoder(7),Qae.encoder],function(e){return[e.target,e.piece]},function(e){return new Xae(e[0],e[1])});var eoe=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this)).start=e,i.moveDirection=r,i}return ip(n,[{key:"isDrop",value:function(){return!1}},{key:"getTarget",value:function(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}},{key:"equals",value:function(e){return!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}},{key:"toString",value:function(){return"DiamMoveShift(".concat(this.start,", ").concat(this.moveDirection,")")}}],[{key:"fromRepresentation",value:function(e,t){return new n(new Jne(e.x,3-e.y),t)}}]),n}(gre);eoe.encoder=jee.tuple([Jne.numberEncoder(8,4),jee.booleanEncoder],function(e){return[e.start,"clockwise"===e.moveDirection]},function(e){return new eoe(e[0],e[1]?"clockwise":"counterclockwise")});var toe=jee.disjunction(Xae.encoder,eoe.encoder,function(e){return e.isDrop()}),noe=function(){var e=ip(function e(){np(this,e)});return e.NO_MORE_PIECES_OF_THIS_TYPE=function(){return $localize(_n||(_n=Nv(["You do not have any pieces of this type anymore."])))},e.SPACE_IS_FULL=function(){return $localize(wn||(wn=Nv(["You cannot play here: this space is already full."])))},e.TARGET_STACK_TOO_HIGH=function(){return $localize(Cn||(Cn=Nv(["You cannot add more pieces to the target stack, as it will contain more than 4 pieces."])))},e.MUST_SHIFT_TO_NEIGHBOR=function(){return $localize(bn||(bn=Nv(["To perform a shift, you must move the pieces to a neighboring space."])))},e.MUST_SELECT_PIECE_FIRST=function(){return $localize(En||(En=Nv(["You must first select either a piece from the side, or a stack of pieces to shift on the board."])))},e}(),roe=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,e,i)).remainingPieces=r,a}return ip(n,[{key:"getRemainingPiecesOf",value:function(e){return this.remainingPieces[n.pieceIndex(e)]}},{key:"getStackHeight",value:function(e){for(var t=0,r=0;r<n.HEIGHT&&this.getPieceAtXY(e,r)!==Qae.EMPTY;r++)t++;return t}}],[{key:"getInitialState",value:function(){var e=Qae.EMPTY;return new n([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}},{key:"fromRepresentation",value:function(e,t){for(var r=e.reverse(),i=[4,4,4,4],a=0;a<n.HEIGHT;a++)for(var o=0;o<n.WIDTH;o++){var s=r[a][o];r[a][o]!==Qae.EMPTY&&i[n.pieceIndex(s)]--}return Z5(i.every(function(e){return e>=0}),"Invalid DiamState representation uses too many pieces"),new n(r,i,t)}},{key:"pieceIndex",value:function(e){switch(e){case Qae.ZERO_FIRST:return 0;case Qae.ZERO_SECOND:return 1;case Qae.ONE_FIRST:return 2;default:return iB.expectToBe(e,Qae.ONE_SECOND),3}}}]),n}(vre);return e.WIDTH=8,e.HEIGHT=4,e}(),ioe=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.call(this,roe)}return ip(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=Q5.copyBiArray(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;var r=Q5.copyImmutableArray(t.remainingPieces);return r[roe.pieceIndex(e.piece)]-=1,new roe(n,r,t.turn+1)}},{key:"applyLegalShift",value:function(e,t){for(var n=Q5.copyBiArray(t.board),r=e.getTarget(),i=t.getStackHeight(r),a=e.start.y;a<roe.HEIGHT&&t.getPieceAtXY(e.start.x,a)!==Qae.EMPTY;)n[i][r]=t.getPieceAtXY(e.start.x,a),n[a][e.start.x]=Qae.EMPTY,i++,a++;return new roe(n,t.remainingPieces,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}},{key:"isDropLegal",value:function(e,t){return e.piece.owner!==t.getCurrentPlayer()?H5.failure(ure.MUST_CHOOSE_PLAYER_PIECE()):0===t.getRemainingPiecesOf(e.piece)?H5.failure(noe.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}},{key:"dropHeightValidity",value:function(e,t){return t.getStackHeight(e.target)===roe.HEIGHT?H5.failure(noe.SPACE_IS_FULL()):H5.success(void 0)}},{key:"isShiftLegal",value:function(e,t){return t.getPieceAt(e.start).owner!==t.getCurrentPlayer()?H5.failure(ure.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(e,t)}},{key:"shiftHeightValidity",value:function(e,t){var n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>roe.HEIGHT?H5.failure(noe.TARGET_STACK_TOO_HIGH()):H5.success(void 0)}},{key:"getGameStatus",value:function(e){var t=this.findHighestAlignment(e.gameState);if(t.isPresent()){var n=e.gameState.getPieceAt(t.get());return Ere.getVictory(n.owner)}return Ere.ONGOING}},{key:"findHighestAlignment",value:function(e){for(var t=0;t<roe.WIDTH/2;t++)for(var n=roe.HEIGHT-1;n>0;n--){var r=e.getPieceAtXY(t,n),i=e.getPieceAtXY(t+roe.WIDTH/2,n);if(r!==Qae.EMPTY&&r===i)return cB.of(new Jne(t,n))}return cB.empty()}},{key:"pieceCanMove",value:function(e,t){return!!this.isShiftLegal(new eoe(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new eoe(t,"counterclockwise"),e).isSuccess()}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=cB.of(new n)),n.singleton.get()}}]),n}(Sre);ioe.singleton=cB.empty();var aoe=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){var t=e.gameState,n=this.getListDrops(t),r=this.getListShifts(t);return n.concat(r)}},{key:"getListShifts",value:function(e){var t,n=[],r=Xv(this.getShiftSources(e));try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=0,o=[new eoe(i,"clockwise"),new eoe(i,"counterclockwise")];a<o.length;a++){var s=o[a];ioe.get().shiftHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){r.e(u)}finally{r.f()}return n}},{key:"getListDrops",value:function(e){for(var t=this.getRemainingPiecesForCurrentPlayer(e),n=[],r=0;r<roe.WIDTH;r++){var i,a=Xv(t);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=new Xae(r,o);ioe.get().dropHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){a.e(u)}finally{a.f()}}return n}},{key:"getRemainingPiecesForCurrentPlayer",value:function(e){var t,n=[],r=Xv(Qae.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.currentPlayerCanDropPiece(e,i)&&n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"currentPlayerCanDropPiece",value:function(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}},{key:"getShiftSources",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<roe.HEIGHT;r++)for(var i=0;i<roe.WIDTH;i++)e.getPieceAtXY(i,r).owner===n&&t.push(new Jne(i,r));return t}},{key:"getBoardValue",value:function(e){var t=ioe.get().getGameStatus(e);return new lre(t.isEndGame?t.toBoardValue():0)}}]),n}(cre),ooe=Qae.EMPTY,soe=Qae.ZERO_FIRST,uoe=Qae.ZERO_SECOND,coe=Qae.ONE_FIRST,loe=Qae.ONE_SECOND,hoe=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(Sn||(Sn=Nv(["Initial board and player pieces"]))),$localize(Pn||(Pn=Nv(["Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right."]))),roe.getInitialState()),Ire.fromMove($localize(On||(On=Nv(["Goal of the game"]))),$localize(Tn||(Tn=Nv(["At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>Do it!"]))),roe.fromRepresentation([[ooe,ooe,ooe,ooe,ooe,ooe,ooe,ooe],[ooe,ooe,ooe,ooe,ooe,ooe,ooe,ooe],[ooe,ooe,ooe,ooe,coe,ooe,ooe,ooe],[soe,ooe,ooe,ooe,soe,ooe,ooe,ooe]],3),[new Xae(0,Qae.ONE_FIRST)],$localize(In||(In=Nv(["Congratulations, you won!"]))),$localize(xn||(xn=Nv(["Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board."])))),Ire.fromMove($localize(An||(An=Nv(["Types of move"]))),$localize(Rn||(Rn=Nv(["You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more  than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board."]))),roe.fromRepresentation([[ooe,ooe,ooe,ooe,ooe,ooe,ooe,ooe],[ooe,ooe,ooe,ooe,loe,ooe,ooe,ooe],[ooe,ooe,ooe,ooe,soe,ooe,ooe,ooe],[coe,ooe,ooe,ooe,uoe,ooe,ooe,ooe]],4),[eoe.fromRepresentation(new Jne(4,3),"counterclockwise"),eoe.fromRepresentation(new Jne(4,3),"clockwise"),eoe.fromRepresentation(new Jne(4,2),"counterclockwise"),eoe.fromRepresentation(new Jne(4,2),"clockwise")],$localize(Nn||(Nn=Nv(["Congratulations!"]))),$localize(Mn||(Mn=Nv(["Failed, try to move one of your piece that is already on the board."])))),Ire.fromMove($localize(Dn||(Dn=Nv(["Special case"]))),$localize(Ln||(Ln=Nv(["It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!"]))),roe.fromRepresentation([[ooe,ooe,ooe,ooe,soe,ooe,ooe,ooe],[ooe,ooe,ooe,ooe,loe,ooe,ooe,soe],[ooe,ooe,ooe,ooe,soe,ooe,ooe,loe],[ooe,coe,ooe,ooe,uoe,ooe,ooe,coe]],8),[eoe.fromRepresentation(new Jne(4,2),"counterclockwise")],$localize(Fn||(Fn=Nv(["Congratulations!"]))),$localize(Bn||(Bn=Nv(["Failed, try to shift a stack of pieces to the left."]))))]});function foe(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"path",6),kb("click",function(){var e=Wy(n).$implicit;return Cb().onSpaceClick(e)}),fb(),hb(2,"path",7),kb("click",function(){var e=Wy(n).$implicit;return Cb().onSpaceClick(e)}),fb(),fb()}if(2&e){var r=t.$implicit,i=Cb();Ow(1),bb("id","click_",r,""),cb("ngClass",i.viewInfo.boardInfo[r].spaceClasses),nb("d",i.BOARD_PATHS[r]),Ow(1),cb("ngClass",i.viewInfo.boardInfo[r].spaceClasses),nb("d",i.DECORATION_PATHS[r])}}function doe(e,t){if(1&e){var n=gb();wm(),hb(0,"g",9),kb("click",function(){var e=Wy(n).$implicit,t=Cb().$implicit;return Cb().onPieceInGameClick(t,e.y)}),db(1,"use",10),db(2,"use",11),fb()}if(2&e){var r=t.$implicit;Eb("id","click_",Cb().$implicit,"_",r.y,""),cb("ngClass",r.foregroundClasses),Ow(1),cb("ngClass",r.backgroundClasses),nb("x",r.drawPosition.x)("y",r.drawPosition.y),Ow(1),nb("x",r.drawPosition.x)("y",r.drawPosition.y)}}function voe(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,doe,3,8,"g",8),fb()),2&e){var n=t.$implicit,r=Cb();Ow(1),cb("ngForOf",r.viewInfo.boardInfo[n].pieces)}}function poe(e,t){if(1&e){var n=gb();wm(),hb(0,"g",12),kb("click",function(){var e=Wy(n).$implicit;return Cb().onRemainingPieceClick(e.actualPiece)}),db(1,"use",10),db(2,"use",11),fb()}if(2&e){var r=t.$implicit;Eb("id","piece_",r.actualPiece.owner.value,"_",r.actualPiece.otherPieceType?1:0,""),cb("ngClass",r.foregroundClasses),Ow(1),cb("ngClass",r.backgroundClasses),nb("x",r.drawPosition.x)("y",r.drawPosition.y),Ow(1),nb("x",r.drawPosition.x)("y",r.drawPosition.y)}}var goe=function(){return[0,1,2,3,4,5,6,7]},yoe=function(){return[2,1,3,0,4,7,5,6]},moe=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],r.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],r.selected=cB.empty(),r.viewInfo={boardInfo:[],remainingPieces:[]},r.rules=ioe.get(),r.availableMinimaxes=[new aoe(r.rules,"DiamDummyMinimax")],r.encoder=toe,r.tutorial=(new hoe).tutorial,r}return ip(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"onSpaceClick",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#click_"+e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t.onSpaceClickAfterCheck(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"onSpaceClickAfterCheck",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.selected.isPresent()){n.next=14;break}if("pieceFromReserve"!==(r=t.selected.get()).type){n.next=6;break}i=new Xae(e,r.piece),n.next=13;break;case 6:if((r.position.x+1)%roe.WIDTH!==e){n.next=10;break}i=new eoe(r.position,"clockwise"),n.next=13;break;case 10:if((r.position.x+(roe.WIDTH-1))%roe.WIDTH===e){n.next=12;break}return n.abrupt("return",t.cancelMove(noe.MUST_SHIFT_TO_NEIGHBOR()));case 12:i=new eoe(r.position,"counterclockwise");case 13:return n.abrupt("return",t.chooseMove(i,t.getState()));case 14:return n.abrupt("return",t.cancelMove(noe.MUST_SELECT_PIECE_FIRST()));case 15:case"end":return n.stop()}},n)}))()}},{key:"onPieceInGameClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.getState().getPieceAtXY(e,t).owner===n.getCurrentPlayer()?(n.selected=cB.of({type:"pieceFromBoard",position:new Jne(e,t)}),n.updateViewInfo(),$5.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(ure.MUST_CHOOSE_PLAYER_PIECE()));case 2:case"end":return r.stop()}},r)}))()}},{key:"onRemainingPieceClick",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay(t.getPieceId(e)),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):e.owner===t.getCurrentPlayer()?(t.selected=cB.of({type:"pieceFromReserve",piece:e}),t.updateViewInfo(),$5.SUCCESS):t.cancelMove(ure.MUST_CHOOSE_PLAYER_PIECE()));case 2:case"end":return n.stop()}},n)}))()}},{key:"getPieceId",value:function(e){return"#piece_"+e.owner.value+"_"+(e.otherPieceType?1:0)}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"getLastMovedFromDrop",value:function(e,t){var n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),r=e.getTarget(),i=t.getStackHeight(e.getTarget()),a=this.getDrawPositionOnBoard(r,i),o=new Jne(r,i);return[{start:cB.empty(),end:o,startDrawPosition:n,endDrawPosition:a}]}},{key:"getLastMovedFromShift",value:function(e,t){for(var n=e.start.x,r=e.getTarget(),i=t.getStackHeight(r),a=[],o=e.start.y;o<roe.HEIGHT&&t.getPieceAtXY(n,o)!==Qae.EMPTY;o++,i++)a.push({start:cB.of(new Jne(n,o)),end:new Jne(r,i),startDrawPosition:this.getDrawPositionOnBoard(n,o),endDrawPosition:this.getDrawPositionOnBoard(r,i)});return a}},{key:"updateViewInfo",value:function(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}},{key:"updateBoardInfo",value:function(){for(var e=0;e<roe.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}},{key:"showLastMove",value:function(){this.showLastMoveOnSpaces(),this.showLastMoveOnPieces()}},{key:"showLastMoveOnSpaces",value:function(){var e=this.rules.node.move;Z5(e.isPresent(),"showLastMoveOnSpaces called without a last move");for(var t=e.get(),n=0;n<roe.WIDTH;n++){var r=[];t.isDrop()?t.getTarget()===n&&r.push("moved"):(t.getTarget()===n||t.start.x===n)&&r.push("moved"),this.viewInfo.boardInfo[n].spaceClasses=r}}},{key:"showLastMoveOnPieces",value:function(){var e=this.rules.node.move;Z5(e.isPresent(),"showLastMoveOnPieces called without a last move");var t,n=e.get(),r=this.getPreviousState(),i=Xv(n.isDrop()?this.getLastMovedFromDrop(n,r):this.getLastMovedFromShift(n,r));try{for(i.s();!(t=i.n()).done;){var a=t.value;this.viewInfo.boardInfo[a.end.x].pieces[a.end.y].foregroundClasses.push("last-move")}}catch(o){i.e(o)}finally{i.f()}}},{key:"updateRemainingPiecesInfo",value:function(){var e=this.getCurrentPlayer();this.viewInfo.remainingPieces=[];var t,n=this.isPlayerTurn(),r=Xv(Qae.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.getState().getRemainingPiecesOf(i),o=0;o<a;o++){var s=[];this.isTopPieceOfReserveAndSelected(o,a,i)&&s.push("selected"),n&&o===a-1&&i.owner===e&&s.push("clickable-hover"),this.viewInfo.remainingPieces.push({backgroundClasses:["player"+i.owner.value+(i.otherPieceType?"-alternate":"")],foregroundClasses:s,y:o,drawPosition:this.getDrawPositionRemainingPiece(i,o),actualPiece:i})}}catch(u){r.e(u)}finally{r.f()}}},{key:"isTopPieceOfReserveAndSelected",value:function(e,t,n){if(this.selected.isPresent()){var r=this.selected.get();return"pieceFromReserve"===r.type&&r.piece===n&&e===t-1}return!1}},{key:"getDrawPositionRemainingPiece",value:function(e,t){var r,i;return r=e.owner===Zee.ZERO?-100:600,i=e.otherPieceType?100:450,new Jne(r,i).getNext(new Wne(0,-t*n.PIECE_HEIGHT))}},{key:"getPieces",value:function(e){for(var t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),r=[],i=0;i<roe.HEIGHT;i++){var a=this.getState().getPieceAtXY(e,i),o=new Jne(e,i);if(a!==Qae.EMPTY){var s=[];this.pieceFromBoardIsSelected(e,i)&&s.push("selected"),this.isVictory(e,i,t)&&s.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),o)&&s.push("clickable-hover"),r.push({backgroundClasses:["player"+a.owner.value+(a.otherPieceType?"-alternate":"")],foregroundClasses:s,y:i,drawPosition:this.getDrawPositionOnBoard(e,i),actualPiece:a})}}return r}},{key:"pieceFromBoardIsSelected",value:function(e,t){if(this.selected.isPresent()){var n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}},{key:"isVictory",value:function(e,t,n){if(n.isPresent()){var r=n.get();return r.x%4==e%4&&r.y===t}return!1}},{key:"getDrawPositionOnBoard",value:function(e,t){return n.CENTER[e].getNext(new Wne(0,-t*n.PIECE_HEIGHT))}},{key:"cancelMoveAttempt",value:function(){this.selected=cB.empty(),this.updateBoard()}}]),n}(ere);moe.CENTER=[new Jne(40,160),new Jne(100,50),new Jne(255,2),new Jne(400,50),new Jne(460,160),new Jne(400,270),new Jne(255,320),new Jne(100,270)],moe.PIECE_HEIGHT=36,moe.\u0275fac=function(e){return new(e||moe)(ub(Xne))},moe.\u0275cmp=ty({type:moe,selectors:[["app-diam"]],features:[HC],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 1.4319358,16.913484 V 49.329973 H 1.482219 A 39.498175,14.141265 0 0 0 40.938372,63.011675 39.498175,14.141265 0 0 0 80.394523,49.329973 h 0.06885 V 16.913484 h -0.02864 A 39.769348,14.114049 0 0 1 40.941466,29.431707 39.769348,14.114049 0 0 1 1.4481812,16.913484 Z"],["cx","40.952408","cy","15.225397","rx","39.769348","ry","14.11405"],[4,"ngFor","ngForOf"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),hb(1,"defs"),hb(2,"g",1),db(3,"path",2),db(4,"ellipse",3),fb(),fb(),ob(5,foe,3,5,"g",4),ob(6,voe,2,1,"g",4),ob(7,poe,3,8,"g",5),fb()),2&e&&(Ow(5),cb("ngForOf",tP(3,goe)),Ow(1),cb("ngForOf",tP(4,yoe)),Ow(1),cb("ngForOf",t.viewInfo.remainingPieces))},directives:[NT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var koe=function(){function e(t,n){np(this,e),this.offset=t,this.constant=n}return ip(e,[{key:"toString",value:function(){return"Line(".concat(this.constant,", ").concat(this.offset,")")}},{key:"equals",value:function(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}},{key:"contains",value:function(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}},{key:"getDirection",value:function(){switch(this.constant){case"q":return rre.DOWN;case"r":return rre.RIGHT;case"s":return rre.DOWN_LEFT}}}],[{key:"fromTwoCoords",value:function(t,n){var r=t.x,i=n.x,a=t.y,o=n.y,s=r+a,u=i+o;return r===i&&a!==o&&s!==u?cB.of(e.constantQ(r)):r!==i&&a===o&&s!==u?cB.of(e.constantR(a)):r!==i&&a!==o&&s===u?cB.of(e.constantS(s)):cB.empty()}},{key:"constantQ",value:function(t){return new e(t,"q")}},{key:"constantR",value:function(t){return new e(t,"r")}},{key:"constantS",value:function(t){return new e(t,"s")}},{key:"areOnSameLine",value:function(t){if(t.length<2)return!0;var n=e.fromTwoCoords(t[0],t[1]);if(n.isAbsent())return!1;var r,i=n.get(),a=Xv(t.slice(2));try{for(a.s();!(r=a.n()).done;){var o=r.value;if(!1===i.contains(o))return!1}}catch(s){a.e(s)}finally{a.f()}return!0}}]),e}(),_oe=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o,s){var u;return np(this,n),(u=t.call(this,r,e)).board=r,u.width=i,u.height=a,u.excludedCases=o,u.empty=s,Z5(u.excludedCases.length<u.height/2+1,"Invalid excluded cases specification for HexagonalGameState."),u}return ip(n,[{key:"setAt",value:function(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}},{key:"equalsT",value:function(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedCases.length!==e.excludedCases.length)return!1;for(var n=0;n<this.excludedCases.length;n++)if(this.excludedCases[n]!==e.excludedCases[n])return!1;var r,i=Xv(this.allCoords());try{for(i.s();!(r=i.n()).done;){var a=r.value;if(!1===t(this.getPieceAt(a),e.getPieceAt(a)))return!1}}catch(o){i.e(o)}finally{i.f()}return!0}},{key:"allCoords",value:function(){var e=[];return this.forEachCoord(function(t){e.push(t)}),e}},{key:"allLines",value:function(){for(var e=[],t=0;t<this.width;t++)e.push(koe.constantQ(t));for(var n=0;n<this.height;n++)e.push(koe.constantR(n));for(var r=this.excludedCases.length;r<this.height+this.excludedCases.length;r++)e.push(koe.constantS(r));return e}},{key:"getEntranceOnLine",value:function(e){var t,n;switch(e.constant){case"q":return n=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new Jne(e.offset,n));case"r":return t=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new Jne(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new Jne(e.offset,0):new Jne(this.width-1,e.offset-this.width+1))}}},{key:"findEntranceFrom",value:function(e,t){for(var n=e.getDirection(),r=t,i=0;i<Math.max(this.width,this.height);i++){if(this.isOnBoard(r))return r;r=r.getNext(n)}var a=j5.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(a.getReason())}}],[{key:"neighbors",value:function(e,t){return[new Jne(e.x+t,e.y-t),new Jne(e.x+t,e.y),new Jne(e.x-t,e.y+t),new Jne(e.x-t,e.y),new Jne(e.x,e.y+t),new Jne(e.x,e.y-t)]}}]),n}(vre),woe=function(){function e(t,n,r){np(this,e),this.owner=t,this.size=n,this.source=r}return ip(e,[{key:"getValue",value:function(){return e.encoder.encodeNumber(this)}},{key:"getOwner",value:function(){return this.owner}},{key:"belongsTo",value:function(e){return this.owner===e}},{key:"containsSource",value:function(){return this.source}},{key:"isEmpty",value:function(){return 0===this.size}},{key:"getSize",value:function(){return this.size}},{key:"toString",value:function(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}}],[{key:"append",value:function(t,n){return new e(t.owner,t.size+n.size,t.source||n.source)}}]),e}();woe.sizeEncoder=jee.numberEncoder(49),woe.encoder=jee.tuple([jee.booleanEncoder,Zee.numberEncoder,woe.sizeEncoder],function(e){return[e.source,e.owner,e.size]},function(e){return new woe(e[1],e[2],e[0])}),woe.MAX_SIZE=49,woe.EMPTY=new woe(Zee.NONE,0,!1),woe.NONE=new woe(Zee.NONE,-1,!1),woe.PLAYER_ZERO=new woe(Zee.ZERO,1,!1),woe.PLAYER_ONE=new woe(Zee.ONE,1,!1),woe.SOURCE=new woe(Zee.NONE,1,!0);var Coe=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,r,e,n.WIDTH,n.HEIGHT,n.EXCLUDED_CASES,woe.EMPTY)).alreadyPassed=i,a}return ip(n,[{key:"getAllPieces",value:function(){for(var e=[],t=0;t<n.HEIGHT;t++)for(var r=0;r<n.WIDTH;r++){var i=new Jne(r,t);this.isOnBoard(i)&&!1===this.getPieceAt(i).isEmpty()&&e.push(i)}return e}},{key:"numberOfNeighbors",value:function(e){var t=this;return _oe.neighbors(e,1).filter(function(e){return t.isOnBoard(e)&&!1===t.getPieceAt(e).isEmpty()}).length}},{key:"setAtUnsafe",value:function(e,t){var r=Q5.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.alreadyPassed)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==woe.NONE}}],[{key:"balancedBoard",value:function(){var e=woe.NONE,t=woe.PLAYER_ZERO,n=woe.PLAYER_ONE,r=woe.SOURCE;return[[e,e,t,n,n,n,t,t,n,r,n],[e,n,n,t,t,t,n,n,t,n,n],[n,n,n,n,t,r,n,t,t,t,t],[t,t,n,t,t,n,n,n,t,t,e],[t,r,t,n,n,t,t,t,n,e,e]]}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(n.WIDTH,n.HEIGHT)&&n.balancedBoard()[e.y][e.x]!==woe.NONE}},{key:"getInitialState",value:function(){return new n(n.balancedBoard(),0,!1)}}]),n}(_oe);return e.WIDTH=11,e.HEIGHT=5,e.EXCLUDED_CASES=[2,1],e}(),boe=function(e){qv(n,e);var t=Wv(n);function n(e,r){return np(this,n),t.call(this,e,r)}return ip(n,[{key:"toString",value:function(){return this===n.PASS?"DvonnMove.PASS":"DvonnMove("+this.coord+"->"+this.end+")"}},{key:"length",value:function(){return this.coord.y===this.end.y?Math.abs(this.coord.x-this.end.x):Math.abs(this.coord.y-this.end.y)}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}}],[{key:"of",value:function(e,t){if(-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y)return n.PASS;if(!Coe.isOnBoard(e))throw new Error("Starting coord of DvonnMove must be on the board, not at "+e.toString());if(!Coe.isOnBoard(t))throw new Error("End coord of DvonnMove must be on the board, not at "+e.toString());if(e.y===t.y)return new n(e,t);if(e.x===t.x)return new n(e,t);if(e.x+e.y===t.x+t.y)return new n(e,t);throw new Error("Invalid move")}}]),n}(_ie);boe.PASS=new boe(new Jne(-1,-1),new Jne(-2,-2)),boe.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"maxValue",value:function(){return 42148}},{key:"encodeNumber",value:function(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){if(e<0)return boe.PASS;var t=e%16,n=(e=e/16|0)%16,r=(e=e/16|0)%16;return new boe(new Jne((e=e/16|0)%16,r),new Jne(n,t))}}]),n}(jee));var Eoe=function(){var e=ip(function e(){np(this,e)});return e.NOT_PLAYER_PIECE=function(){return $localize(Vn||(Vn=Nv(["You must select a piece or a stack of your color."])))},e.EMPTY_STACK=function(){return $localize(Un||(Un=Nv(["You must select a stack."])))},e.TOO_MANY_NEIGHBORS=function(){return $localize(zn||(zn=Nv(["This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors."])))},e.CANT_REACH_TARGET=function(){return $localize(Hn||(Hn=Nv(["This stack cannot move because it could never land on another piece."])))},e.INVALID_MOVE_LENGTH=function(){return $localize(Gn||(Gn=Nv(["A stack must always be moved by as many spaces as there are pieces in the stack."])))},e.EMPTY_TARGET_STACK=function(){return $localize(qn||(qn=Nv(["The stack must land on an occupied space."])))},e}(),Soe=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"isMovablePiece",value:function(e,t){Z5(e.isOnBoard(t),"piece is not on the board");var r=e.getPieceAt(t);return r.getSize()<1?$5.failure(Eoe.EMPTY_STACK()):r.belongsTo(e.getCurrentPlayer())?e.numberOfNeighbors(t)>=6?$5.failure(Eoe.TOO_MANY_NEIGHBORS()):n.pieceHasTarget(e,t)?$5.SUCCESS:$5.failure(Eoe.CANT_REACH_TARGET()):$5.failure(Eoe.NOT_PLAYER_PIECE())}},{key:"canOnlyPass",value:function(e){return 0===n.getMovablePieces(e).length}},{key:"sourceCoords",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).containsSource()})}},{key:"markPiecesConnectedTo",value:function(e,t,n){var r=this;_oe.neighbors(t,1).forEach(function(t){e.isOnBoard(t)&&!n[t.y][t.x]&&!e.getPieceAt(t).isEmpty()&&(n[t.y][t.x]=!0,r.markPiecesConnectedTo(e,t,n))})}},{key:"removeDisconnectedPieces",value:function(e){var t=this,n=Q5.createTable(Coe.WIDTH,Coe.HEIGHT,!1);this.sourceCoords(e).forEach(function(r){n[r.y][r.x]=!0,t.markPiecesConnectedTo(e,r,n)});var r=e;return r.getAllPieces().forEach(function(e){n[e.y][e.x]||(r=r.setAt(e,woe.EMPTY))}),r}},{key:"applyLegalMove",value:function(e,t,n){if(e===boe.PASS)return new Coe(t.board,t.turn+1,!0);var r=t.getPieceAt(e.coord),i=t.getPieceAt(e.end),a=t.setAt(e.coord,woe.EMPTY).setAt(e.end,woe.append(r,i));return this.removeDisconnectedPieces(new Coe(a.board,t.turn+1,!1))}},{key:"isLegal",value:function(e,t){if(0===n.getMovablePieces(t).length)return e!==boe.PASS||t.alreadyPassed?H5.failure(ure.MUST_PASS()):H5.success(void 0);if(e===boe.PASS)return H5.failure(ure.CANNOT_PASS());var r=this.isMovablePiece(t,e.coord);if(r.isFailure())return r.toFailedFallible();var i=t.getPieceAt(e.coord);return e.length()!==i.getSize()?H5.failure(Eoe.INVALID_MOVE_LENGTH()):t.getPieceAt(e.end).isEmpty()?H5.failure(Eoe.EMPTY_TARGET_STACK()):H5.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getScores(t);return 0===n.getMovablePieces(t).length?r[0]>r[1]?Ere.ZERO_WON:r[0]<r[1]?Ere.ONE_WON:Ere.DRAW:Ere.ONGOING}},{key:"getMovablePieces",value:function(e){return n.getFreePieces(e).filter(function(t){return n.pieceHasTarget(e,t)})}},{key:"getFreePieces",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6})}},{key:"pieceHasTarget",value:function(e,t){var n=e.getPieceAt(t).getSize();return void 0!==_oe.neighbors(t,n).find(function(t){return e.isOnBoard(t)&&!e.getPieceAt(t).isEmpty()})}},{key:"pieceTargets",value:function(e,t){var n=e.getPieceAt(t).getSize();return _oe.neighbors(t,n).filter(function(t){return e.isOnBoard(t)&&!1===e.getPieceAt(t).isEmpty()})}},{key:"getScores",value:function(e){var t=0,n=0;return e.getAllPieces().map(function(r){var i=e.getPieceAt(r);i.belongsTo(Zee.ZERO)?t+=i.getSize():i.belongsTo(Zee.ONE)&&(n+=i.getSize())}),[t,n]}}]),n}(Sre),Poe=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){var t=e.move,n=e.gameState,r=[];return Soe.getMovablePieces(n).forEach(function(e){return Soe.pieceTargets(n,e).forEach(function(t){var n=boe.of(e,t);r.push(n)})}),0===r.length&&!1===t.equalsValue(boe.PASS)&&r.push(boe.PASS),r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Soe.getScores(t);return 0===Soe.getMovablePieces(t).length?new lre(n[0]>n[1]?Number.MIN_SAFE_INTEGER:n[0]<n[1]?Number.MAX_SAFE_INTEGER:0):new lre(n[0]-n[1])}}]),n}(cre),Ooe=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){var t=e.gameState,r=Hv(Kv(n.prototype),"getListMoves",this).call(this,e),i=t.getCurrentPlayer().getOpponent();return Q5.sortByDescending(r,function(e){Z5(e!==boe.PASS,"Cannot sort with DvonnMove.PASS");var n=t.getPieceAt(e.end);return n.belongsTo(i)?n.getSize():0}),r}},{key:"getBoardValue",value:function(e){var t=Soe.getGameStatus(e);if(t.isEndGame)return new lre(t.toBoardValue());var n=e.gameState,r=Soe.getScores(n),i=n.getAllPieces(),a=i.length,o=i.filter(function(e){return n.getPieceAt(e).belongsTo(Zee.ZERO)}).length,s=i.filter(function(e){return n.getPieceAt(e).belongsTo(Zee.ONE)}).length;return new lre((s*r[1]-o*r[0])/a)}}]),n}(Poe),Toe=woe.EMPTY,Ioe=woe.NONE,xoe=woe.SOURCE,Aoe=woe.PLAYER_ZERO,Roe=woe.PLAYER_ONE,Noe=new woe(Zee.ZERO,2,!1),Moe=new woe(Zee.ONE,2,!1),Doe=new woe(Zee.ZERO,4,!1),Loe=new woe(Zee.ONE,4,!1),Foe=ip(function e(){np(this,e),this.tutorial=[Ire.anyMove($localize($n||($n=Nv(["Moving"]))),$localize(Wn||(Wn=Nv(["At Dvonn, each hexagonal space contains a stack of pieces.\n        If no number is indicated on a stack, it means that it only contains one piece.\n        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.\n        The owner of a stack is the one that has a piece at the top of the stack.\n        Only the owner of a stack can move it.\n        A stack cannot be moved if it is surrounded by 6 other stacks.\n        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.\n        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.\n        Therefore, there are six possible directions.\n        The player with dark pieces starts.<br/><br/>\n        You're playing Dark, click on a stack and move it by one space."]))),Coe.getInitialState(),boe.of(new Jne(2,0),new Jne(3,0)),$localize(jn||(jn=Nv(["Congratulations!"])))),Ire.fromPredicate($localize(Zn||(Zn=Nv(["Disconnection"]))),$localize(Yn||(Yn=Nv(['Pieces with a lightning strike are called "sources".\n        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>\n        You\'re playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!']))),new Coe([[Ioe,Ioe,Roe,xoe,Toe,Toe,Toe,Toe,Toe,Toe,Toe],[Ioe,Toe,Aoe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe],[Toe,Toe,Loe,Toe,Toe,Toe,Toe,Roe,xoe,Toe,Toe],[Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Ioe],[Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Ioe,Ioe]],0,!1),boe.of(new Jne(2,1),new Jne(2,0)),function(e,t){return e.end.equals(new Jne(3,0))?$5.failure($localize(Kn||(Kn=Nv(["You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it."])))):(Z5(e.end.equals(new Jne(2,0)),"player made an impossible move"),$5.SUCCESS)},$localize(Jn||(Jn=Nv(["Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!\n        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.\n        Disconnected stacks will not be visible at the next turn."])))),Ire.fromPredicate($localize(Qn||(Qn=Nv(["Moving on a source"]))),$localize(Xn||(Xn=Nv(["You are allowed to move your stacks on any other stack.\n        This means that you can take control of a source by moving one of your stack on top of it.\n        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>\n        You're playing Dark and you can take control of a source, do it!"]))),new Coe([[Ioe,Ioe,xoe,Roe,Toe,Toe,Toe,Toe,Toe,Toe,Toe],[Ioe,Aoe,Aoe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe],[Toe,Roe,Aoe,Roe,Toe,Toe,Aoe,Moe,xoe,Toe,Toe],[Toe,Toe,Roe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Ioe],[Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Ioe,Ioe]],0,!1),boe.of(new Jne(2,1),new Jne(2,0)),function(e,t){return e.end.equals(new Jne(2,0))?$5.SUCCESS:$5.failure($localize(er||(er=Nv(["You have not taken possession of a source, try again."]))))},$localize(tr||(tr=Nv(["Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!"])))),Ire.informational($localize(nr||(nr=Nv(["Passing"]))),$localize(rr||(rr=Nv(["It can happen that you have no possible move to make.\n        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>\n        This is a situation that occurs here for Dark."]))),new Coe([[Ioe,Ioe,xoe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe],[Ioe,Toe,Noe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe],[Toe,Toe,Moe,Toe,Toe,Toe,Toe,Moe,xoe,Doe,Toe],[Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Ioe],[Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Ioe,Ioe]],0,!1)),Ire.fromMove($localize(ir||(ir=Nv(["End of the game"]))),$localize(ar||(ar=Nv(["When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>\n        Make your last move."]))),new Coe([[Ioe,Ioe,xoe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe],[Ioe,Toe,Aoe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe],[Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,xoe,Doe,Toe],[Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Ioe],[Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Toe,Ioe,Ioe]],0,!1),[boe.of(new Jne(2,1),new Jne(2,0))],$localize(or||(or=Nv(["Congratulations, you won 6 - 0!"]))),$localize(sr||(sr=Nv(["Bad idea, by moving on the source you would have won a point."]))))]});function Boe(e,t){if(1&e&&(wm(),db(0,"circle",10)),2&e){var n=Cb().$implicit,r=Cb().$implicit,i=Cb();cb("ngClass",i.getPieceClasses(n)),nb("cx",i.getCenterAt(r).x)("cy",i.getCenterAt(r).y)("r",i.SPACE_SIZE)}}function Voe(e,t){if(1&e&&(wm(),db(0,"polygon",11)),2&e){var n=Cb().$implicit,r=Cb().$implicit,i=Cb();nb("transform",1===n.getSize()?"translate("+(i.getCenterAt(r).x-18)+" "+(i.getCenterAt(r).y-16)+") scale(0.10)":"translate("+(i.getCenterAt(r).x-3)+" "+(i.getCenterAt(r).y-12)+") scale(0.07)")}}function Uoe(e,t){if(1&e){var n=gb();wm(),hb(0,"text",12),kb("click",function(){Wy(n);var e=Cb(2).$implicit;return Cb().onClick(e.x,e.y)}),Nb(1),fb()}if(2&e){var r=Cb().$implicit,i=Cb().$implicit,a=Cb();nb("x",r.containsSource()?a.getCenterAt(i).x-7:a.getCenterAt(i).x)("y",a.getCenterAt(i).y),Ow(1),Mb(r.getSize())}}function zoe(e,t){if(1&e){var n=gb();wm(),hb(0,"g",5),kb("click",function(){Wy(n);var e=Cb().$implicit;return Cb().onClick(e.x,e.y)}),db(1,"polyline",6),ob(2,Boe,1,4,"circle",7),ob(3,Voe,1,1,"polygon",8),ob(4,Uoe,2,3,"text",9),fb()}if(2&e){var r=t.$implicit,i=Cb().$implicit,a=Cb();Eb("id","click_",i.x,"_",i.y,""),Ow(1),nb("points",a.getHexaCoordsAt(i)),Ow(1),cb("ngIf",r.getSize()>0),Ow(1),cb("ngIf",r.containsSource()),Ow(1),cb("ngIf",r.getSize()>1)}}var Hoe=function(e){return[e]};function Goe(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,zoe,5,6,"g",4),fb()),2&e){var n=t.$implicit,r=Cb();Ow(1),cb("ngForOf",nP(1,Hoe,r.state.getPieceAt(n)))}}function qoe(e,t){if(1&e&&(wm(),hb(0,"text",16),Nb(1),fb()),2&e){var n=Cb().$implicit,r=Cb();nb("x",r.getCenterAt(n.coord).x)("y",r.getCenterAt(n.coord).y),Ow(1),Mb(n.caseContent.getSize())}}function $oe(e,t){if(1&e&&(wm(),hb(0,"g"),db(1,"polyline",13),db(2,"circle",14),ob(3,qoe,2,3,"text",15),fb()),2&e){var n=t.$implicit,r=Cb();Ow(1),nb("points",r.getHexaCoordsAt(n.coord)),Ow(1),Eb("id","captured_",n.coord.x,"_",n.coord.y,""),cb("ngClass",r.getPieceClasses(n.caseContent)),nb("cx",r.getCenterAt(n.coord).x)("cy",r.getCenterAt(n.coord).y)("r",r.SPACE_SIZE),Ow(1),cb("ngIf",n.caseContent.getSize()>1)}}function Woe(e,t){if(1&e&&(wm(),vb(0),db(1,"polyline",17),db(2,"polyline",17),pb()),2&e){var n=Cb();Ow(1),nb("points",n.getHexaCoordsAt(n.lastMove.get().coord)),Ow(1),nb("points",n.getHexaCoordsAt(n.lastMove.get().end))}}function joe(e,t){if(1&e&&(wm(),db(0,"polyline",18)),2&e){var n=Cb();nb("points",n.getHexaCoordsAt(n.chosen.get()))}}var Zoe=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).lastMove=cB.empty(),r.chosen=cB.empty(),r.disconnecteds=[],r.rules=new Soe(Coe),r.availableMinimaxes=[new Poe(r.rules,"DvonnMinimax"),new Ooe(r.rules,"DvonnMinimaxMaximizeStacks")],r.encoder=boe.encoder,r.tutorial=(new Foe).tutorial,r.SPACE_SIZE=30,r.canPass=!1,r.scores=cB.of(Soe.getScores(r.rules.node.gameState)),r.hexaLayout=new ire(1.5*r.SPACE_SIZE,new Jne(-r.SPACE_SIZE,2*r.SPACE_SIZE),ore.INSTANCE),r.state=r.rules.node.gameState,r.hexaBoard=r.rules.node.gameState.board,r}return ip(n,[{key:"hideLastMove",value:function(){this.lastMove=cB.empty()}},{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.state=this.rules.node.gameState,this.lastMove=this.rules.node.move,this.disconnecteds=[],this.lastMove.isPresent()?this.calculateDisconnecteds():this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=cB.of(Soe.getScores(this.state))}},{key:"calculateDisconnecteds",value:function(){for(var e=this.rules.node.mother.get().gameState,t=this.rules.node.gameState,n=0;n<t.board.length;n++)for(var r=0;r<t.board[n].length;r++){var i=new Jne(r,n);if(!0===t.isOnBoard(i)&&!1===i.equals(this.lastMove.get().coord)){var a=t.getPieceAt(i),o=e.getPieceAt(i);if(a.isEmpty()&&!o.isEmpty()){var s={coord:new Jne(r,n),caseContent:o};this.disconnecteds.push(s)}}}}},{key:"cancelMoveAttempt",value:function(){this.chosen=cB.empty()}},{key:"pass",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Z5(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),t.next=3,e.chooseMove(boe.PASS,e.rules.node.gameState);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=5;break}r.t0=n.cancelMove(i.getReason()),r.next=18;break;case 5:if(!n.chosen.isAbsent()){r.next=9;break}r.t1=n.choosePiece(e,t),r.next=17;break;case 9:if(!n.chosen.equalsValue(new Jne(e,t))){r.next=13;break}r.t2=(n.cancelMoveAttempt(),$5.SUCCESS),r.next=16;break;case 13:return r.next=15,n.chooseDestination(e,t);case 15:r.t2=r.sent;case 16:r.t1=r.t2;case 17:r.t0=r.t1;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=new Jne(e,t),r=this.rules.isMovablePiece(this.rules.node.gameState,n);return r.isSuccess()?(this.chosen=cB.of(n),$5.SUCCESS):this.cancelMove(r.getReason())}},{key:"chooseDestination",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new Jne(e,t),o=boe.of(i,a),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 2:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e){if(e.containsSource()&&1===e.getSize())return["other-piece","dashed-stroke"];var t=this.getPlayerClass(e.getOwner());return e.containsSource()?[t,"other-piece-stroke","dashed-stroke"]:[t]}}]),n}(tre);return e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-dvonn"]],features:[HC],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"ngClass",4,"ngIf"],["class","other-piece-light","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"other-piece-light"],["dy","13",1,"text-center","text-medium",3,"click"],[1,"base","mid-stroke","captured"],[1,"base","mid-stroke","transparent",3,"id","ngClass"],["class","text-center text-big","dy","17",4,"ngIf"],["dy","17",1,"text-center","text-big"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","selected"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),ob(1,Goe,2,3,"g",1),ob(2,$oe,4,8,"g",1),ob(3,Woe,3,2,"ng-container",2),ob(4,joe,1,1,"polyline",3),fb()),2&e&&(Ow(1),cb("ngForOf",t.state.allCoords()),Ow(1),cb("ngForOf",t.disconnecteds),Ow(1),cb("ngIf",t.lastMove.isPresent()),Ow(1),cb("ngIf",t.chosen.isPresent()))},directives:[NT,DT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Yoe=(function(e){e[e.NONE=0]="NONE",e[e.SMALL=1]="SMALL",e[e.MEDIUM=2]="MEDIUM",e[e.BIG=3]="BIG"}(Yoe||(Yoe={})),Yoe),Koe=function(){function e(t){np(this,e),this.value=t}return ip(e,[{key:"getPlayer",value:function(){switch(this){case e.SMALL_BLACK:case e.MEDIUM_BLACK:case e.BIG_BLACK:return Zee.ZERO;case e.SMALL_WHITE:case e.MEDIUM_WHITE:case e.BIG_WHITE:return Zee.ONE;default:return Zee.NONE}}},{key:"getSize",value:function(){switch(this){case e.BIG_BLACK:case e.BIG_WHITE:return Yoe.BIG;case e.MEDIUM_BLACK:case e.MEDIUM_WHITE:return Yoe.MEDIUM;case e.SMALL_BLACK:case e.SMALL_WHITE:return Yoe.SMALL;default:return iB.expectToBe(this,e.NONE),Yoe.NONE}}},{key:"belongsTo",value:function(e){return this.getPlayer()===e}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){switch(this){case e.BIG_BLACK:return"BIG_BLACK";case e.BIG_WHITE:return"BIG_WHITE";case e.MEDIUM_BLACK:return"MEDIUM_BLACK";case e.MEDIUM_WHITE:return"MEDIUM_WHITE";case e.SMALL_BLACK:return"SMALL_BLACK";case e.SMALL_WHITE:return"SMALL_WHITE";default:return iB.expectToBe(this,e.NONE),"NONE"}}}],[{key:"of",value:function(e){switch(e){case 0:return this.SMALL_BLACK;case 1:return this.SMALL_WHITE;case 2:return this.MEDIUM_BLACK;case 3:return this.MEDIUM_WHITE;case 4:return this.BIG_BLACK;case 5:return this.BIG_WHITE;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}},{key:"ofSizeAndPlayer",value:function(t,n){return n===Zee.ZERO&&t===Yoe.BIG?e.BIG_BLACK:n===Zee.ZERO&&t===Yoe.MEDIUM?e.MEDIUM_BLACK:n===Zee.ZERO&&t===Yoe.SMALL?e.SMALL_BLACK:n===Zee.ONE&&t===Yoe.BIG?e.BIG_WHITE:n===Zee.ONE&&t===Yoe.MEDIUM?e.MEDIUM_WHITE:n===Zee.ONE&&t===Yoe.SMALL?e.SMALL_WHITE:e.NONE}}]),e}();Koe.SMALL_BLACK=new Koe(0),Koe.SMALL_WHITE=new Koe(1),Koe.MEDIUM_BLACK=new Koe(2),Koe.MEDIUM_WHITE=new Koe(3),Koe.BIG_BLACK=new Koe(4),Koe.BIG_WHITE=new Koe(5),Koe.NONE=new Koe(6);var Joe=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,e,r)).remainingPieces=i,a}return ip(n,[{key:"getRemainingPieces",value:function(){return Q5.copyImmutableArray(this.remainingPieces)}},{key:"getRemainingPiecesOfPlayer",value:function(e){return this.getRemainingPieces().filter(function(t){return t.getPlayer()===e})}},{key:"pieceBelongsToCurrentPlayer",value:function(e){return e.belongsTo(this.getCurrentPlayer())}},{key:"isDroppable",value:function(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}},{key:"isInRemainingPieces",value:function(e){return this.remainingPieces.some(function(t){return t===e})}},{key:"getPlayerRemainingPieces",value:function(){var e=this;return this.remainingPieces.filter(function(t){return e.pieceBelongsToCurrentPlayer(t)})}}],[{key:"getInitialState",value:function(){var e=new Qoe(Zee.NONE,Zee.NONE,Zee.NONE).encode(),t=Q5.createTable(3,3,e);return new n(Q5.mapBiArray(t,function(e){return Qoe.decode(e)}),0,[Koe.BIG_BLACK,Koe.BIG_BLACK,Koe.BIG_WHITE,Koe.BIG_WHITE,Koe.MEDIUM_BLACK,Koe.MEDIUM_BLACK,Koe.MEDIUM_WHITE,Koe.MEDIUM_WHITE,Koe.SMALL_BLACK,Koe.SMALL_BLACK,Koe.SMALL_WHITE,Koe.SMALL_WHITE])}}]),n}(vre),Qoe=function(){function e(t,n,r){np(this,e),this.small=t,this.medium=n,this.big=r}return ip(e,[{key:"isEmpty",value:function(){return this.small===Zee.NONE&&this.medium===Zee.NONE&&this.big===Zee.NONE}},{key:"toList",value:function(){var e=[];return this.small!==Zee.NONE&&e.push(Koe.ofSizeAndPlayer(Yoe.SMALL,this.small)),this.medium!==Zee.NONE&&e.push(Koe.ofSizeAndPlayer(Yoe.MEDIUM,this.medium)),this.big!==Zee.NONE&&e.push(Koe.ofSizeAndPlayer(Yoe.BIG,this.big)),e}},{key:"toOrderedPieceNames",value:function(){var e=Koe.ofSizeAndPlayer(Yoe.SMALL,this.small),t=Koe.ofSizeAndPlayer(Yoe.MEDIUM,this.medium),n=Koe.ofSizeAndPlayer(Yoe.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}},{key:"getBiggest",value:function(){return this.big===Zee.ZERO?Koe.BIG_BLACK:this.big===Zee.ONE?Koe.BIG_WHITE:this.medium===Zee.ZERO?Koe.MEDIUM_BLACK:this.medium===Zee.ONE?Koe.MEDIUM_WHITE:this.small===Zee.ZERO?Koe.SMALL_BLACK:this.small===Zee.ONE?Koe.SMALL_WHITE:Koe.NONE}},{key:"tryToSuperposePiece",value:function(e){var t=this.getBiggest().getSize();if(e===Koe.NONE)throw new Error("Cannot move NONE on a space");return e.getSize()>t?cB.of(this.put(e)):cB.empty()}},{key:"removeBiggest",value:function(){var t,n=this.getBiggest();if(n===Koe.NONE)throw new Error("Cannot removed piece from empty space");var r=n.getSize();switch(r){case Yoe.BIG:t=new e(this.small,this.medium,Zee.NONE);break;case Yoe.MEDIUM:t=new e(this.small,Zee.NONE,Zee.NONE);break;default:iB.expectToBe(r,Yoe.SMALL),t=new e(Zee.NONE,Zee.NONE,Zee.NONE)}return{removedCase:t,removedPiece:n}}},{key:"put",value:function(t){if(t===Koe.NONE)throw new Error("Cannot put NONE on space");var n=t.getPlayer(),r=t.getSize();switch(r){case Yoe.BIG:return new e(this.small,this.medium,n);case Yoe.MEDIUM:return Z5(this.big===Zee.NONE,"Cannot put a piece on top of a bigger one"),new e(this.small,n,this.big);default:return iB.expectToBe(r,Yoe.SMALL),Z5(this.big===Zee.NONE,"Cannot put a piece on top of a bigger one"),Z5(this.medium===Zee.NONE,"Cannot put a piece on top of a bigger one"),new e(n,this.medium,this.big)}}},{key:"encode",value:function(){return this.small.value+3*this.medium.value+9*this.big.value}},{key:"belongsTo",value:function(e){return this.getBiggest().getPlayer()===e}},{key:"toString",value:function(){var e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}],[{key:"decode",value:function(t){Z5(t%1==0,"EncapsuleCase must be encoded as integer: "+t),Z5(t>=0,"To small representation for EncapsuleCase: "+t),Z5(t<=26,"To big representation for EncapsuleCase: "+t);var n=Zee.of(t%3);t-=n.value;var r=Zee.of((t/=3)%3);return t-=r.value,new e(n,r,Zee.of(t/=3))}}]),e}();Qoe.EMPTY=new Qoe(Zee.NONE,Zee.NONE,Zee.NONE);var Xoe=function(){var e=ip(function e(){np(this,e)});return e.PIECE_OUT_OF_STOCK=function(){return $localize(ur||(ur=Nv(["You do not have pieces of this type anymore."])))},e.INVALID_PLACEMENT=function(){return $localize(cr||(cr=Nv(["You must put your piece on an empty square or on a smaller piece."])))},e.NOT_DROPPABLE=function(){return $localize(lr||(lr=Nv(["You must pick your piece among the remaining ones."])))},e.INVALID_PIECE_SELECTED=function(){return $localize(hr||(hr=Nv(["You must pick one of your remaining pieces or one piece on the board that is the biggest of its square."])))},e.SAME_DEST_AS_ORIGIN=function(){return $localize(fr||(fr=Nv(["You must select a different landing square than the square where the move originates from."])))},e.END_YOUR_MOVE=function(){return $localize(dr||(dr=Nv(["You are performing a move, you must select a landing square."])))},e}(),ese=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){var r,i=t.getCopiedBoard(),a=t.getRemainingPieces(),o=t.turn+1;if(i[e.landingCoord.y][e.landingCoord.x]=Qoe.decode(n.encode()),e.isDropping()){r=e.piece.get();var s=a.indexOf(r);a=a.slice(0,s).concat(a.slice(s+1))}else{var u=e.startingCoord.get(),c=i[u.y][u.x].encode(),l=Qoe.decode(c).removeBiggest();i[u.y][u.x]=Qoe.decode(l.removedCase.encode()),r=l.removedPiece}return new Joe(i,o,a)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isVictory",value:function(e){for(var t,r=e.getCopiedBoard(),i=cB.empty(),a=0;i.isAbsent()&&a<8;)t=n.LINES[a++],i=n.isVictoriousLine([r[t[0].y][t[0].x],r[t[1].y][t[1].x],r[t[2].y][t[2].x]]);return i}},{key:"isVictoriousLine",value:function(e){var t=e.map(function(e){return e.getBiggest()}).map(function(e){return e.getPlayer()});return t[0]===Zee.NONE?cB.empty():t[0]===t[1]&&t[1]===t[2]?cB.of(t[0]):cB.empty()}},{key:"isLegal",value:function(e,t){var n;if(aB(!1,e.toString()),e.isDropping()){if(n=e.piece.get(),!1===t.pieceBelongsToCurrentPlayer(n))return H5.failure(ure.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.isInRemainingPieces(n))return H5.failure(Xoe.PIECE_OUT_OF_STOCK())}else{var r=e.startingCoord.get();if(n=t.getPieceAt(r).getBiggest(),!1===t.pieceBelongsToCurrentPlayer(n))return H5.failure(ure.MUST_CHOOSE_PLAYER_PIECE())}var i=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return i.isPresent()?H5.success(i.get()):H5.failure(Xoe.INVALID_PLACEMENT())}},{key:"getGameStatus",value:function(e){var t=n.isVictory(e.gameState);return t.isPresent()?Ere.getVictory(t.get()):Ere.ONGOING}}]),n}(Sre);ese.LINES=[[new Jne(0,0),new Jne(0,1),new Jne(0,2)],[new Jne(1,0),new Jne(1,1),new Jne(1,2)],[new Jne(2,0),new Jne(2,1),new Jne(2,2)],[new Jne(0,0),new Jne(1,0),new Jne(2,0)],[new Jne(0,1),new Jne(1,1),new Jne(2,1)],[new Jne(0,2),new Jne(1,2),new Jne(2,2)],[new Jne(0,0),new Jne(1,1),new Jne(2,2)],[new Jne(0,2),new Jne(1,1),new Jne(2,0)]];var tse=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this)).startingCoord=e,a.landingCoord=r,a.piece=i,a}return ip(n,[{key:"isDropping",value:function(){return this.startingCoord.isAbsent()}},{key:"equals",value:function(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}},{key:"toString",value:function(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}],[{key:"fromMove",value:function(e,t){if(e.equals(t))throw new Error("Starting coord and landing coord must be separate coords");return new n(cB.of(e),t,cB.empty())}},{key:"fromDrop",value:function(e,t){return new n(cB.empty(),t,cB.of(e))}}]),n}(gre);tse.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"maxValue",value:function(){return 161}},{key:"encodeNumber",value:function(e){var t=e.landingCoord.x,n=e.landingCoord.y;if(e.isDropping()){return 18*e.piece.get().value+6*t+2*n+0}var r=e.startingCoord.get().y;return 54*e.startingCoord.get().x+18*r+6*t+2*n+1}},{key:"decodeNumber",value:function(e){var t=e%2;e-=t;var n=(e/=2)%3;e-=n;var r=(e/=3)%3;e-=r,e/=3;var i=new Jne(r,n);if(0===t){var a=Koe.of(e);return tse.fromDrop(a,i)}var o=e%3;e-=o;var s=new Jne((e/=3)%3,o);return tse.fromMove(s,i)}}]),n}(jee));var nse=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getBoardValue",value:function(e){var t=ese.getGameStatus(e);return new lre(t.toBoardValue())}},{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getCurrentPlayer(),a=hre.toComparableObjectSet(n.getPlayerRemainingPieces()),o=0;o<3;o++)for(var s=0;s<3;s++){var u,c=new Jne(s,o),l=Xv(a);try{for(l.s();!(u=l.n()).done;){var h=u.value,f=tse.fromDrop(h,c);ese.isLegal(f,n).isSuccess()&&t.push(f)}}catch(y){l.e(y)}finally{l.f()}if(r[o][s].belongsTo(i))for(var d=0;d<3;d++)for(var v=0;v<3;v++){var p=new Jne(v,d);if(!p.equals(c)){var g=tse.fromMove(c,p);ese.isLegal(g,n).isSuccess()&&t.push(g)}}}return t}}]),n}(cre),rse=new Qoe(Zee.NONE,Zee.NONE,Zee.NONE),ise=new Qoe(Zee.ZERO,Zee.NONE,Zee.NONE),ase=new Qoe(Zee.NONE,Zee.ZERO,Zee.NONE),ose=new Qoe(Zee.NONE,Zee.NONE,Zee.ZERO),sse=new Qoe(Zee.ONE,Zee.NONE,Zee.NONE),use=new Qoe(Zee.NONE,Zee.NONE,Zee.ONE),cse=new Qoe(Zee.ONE,Zee.ZERO,Zee.NONE),lse=new Qoe(Zee.ZERO,Zee.ZERO,Zee.NONE),hse=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(vr||(vr=Nv(["Goal of the game"]))),$localize(pr||(pr=Nv(["The goal of Encapsule is to align three of your pieces.\n        Here, we have a victory of the dark player."]))),new Joe([[ise,sse,use],[rse,ase,rse],[rse,rse,ose]],0,[Koe.SMALL_BLACK,Koe.MEDIUM_BLACK,Koe.BIG_BLACK,Koe.SMALL_WHITE,Koe.MEDIUM_WHITE,Koe.MEDIUM_WHITE,Koe.BIG_WHITE])),Ire.anyMove($localize(gr||(gr=Nv(["Putting a piece"]))),$localize(yr||(yr=Nv(["This is the initial board. You're playing Dark.<br/><br/>\n        Pick one of your piece on the side of the board and put it on the board."]))),Joe.getInitialState(),tse.fromDrop(Koe.SMALL_BLACK,new Jne(1,1)),$localize(mr||(mr=Nv(["Congratulations!"])))),Ire.fromMove($localize(kr||(kr=Nv(["Moving"]))),$localize(_r||(_r=Nv(["Another possible action is to move one of your pieces that is already on the board.<br/><br/>\n        Click on your dark piece and then on any empty square of the board."]))),new Joe([[ise,use,rse],[rse,rse,rse],[rse,rse,rse]],0,[]),[tse.fromMove(new Jne(0,0),new Jne(2,0)),tse.fromMove(new Jne(0,0),new Jne(0,1)),tse.fromMove(new Jne(0,0),new Jne(1,1)),tse.fromMove(new Jne(0,0),new Jne(2,1)),tse.fromMove(new Jne(0,0),new Jne(0,2)),tse.fromMove(new Jne(0,0),new Jne(1,2)),tse.fromMove(new Jne(0,0),new Jne(2,2))],$localize(wr||(wr=Nv(["Congratulations!"]))),$localize(Cr||(Cr=Nv(["Failed. Try again."])))),Ire.fromPredicate($localize(br||(br=Nv(["Particularity"]))),$localize(Er||(Er=Nv(['At Encapsule, pieces encapsulate each other.\n        It is therefore possible to have up to three pieces per square!\n        However, only the biggest piece of each square counts:\n        you cannot win with a piece that is "hidden" by a bigger piece.\n        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.\n        Finally, you cannot encapsulate a piece with a smaller piece.\n        You\'re playing Dark and you can win now in various ways.<br/><br/>\n        Try to win by making a move, and not by putting a new piece on the board.']))),new Joe([[cse,rse,sse],[lse,use,use],[rse,rse,rse]],0,[Koe.MEDIUM_BLACK,Koe.BIG_BLACK,Koe.MEDIUM_WHITE,Koe.MEDIUM_WHITE]),tse.fromMove(new Jne(0,1),new Jne(0,2)),function(e,t){if(e.landingCoord.equals(new Jne(0,2))){if(e.isDropping())return $5.failure($localize(Sr||(Sr=Nv(["You won, but the exercise is to win while moving a piece!"]))));if(e.startingCoord.equalsValue(new Jne(0,1)))return $5.SUCCESS}return $5.failure($localize(Pr||(Pr=Nv(["Failed. Try again."]))))},$localize(Or||(Or=Nv(["Congratulations!"]))))]});function fse(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"circle",5),kb("click",function(){var e=Wy(n),t=e.$implicit,r=e.index;return Cb().onPieceClick(0,t,r)}),fb(),fb()}if(2&e){var r=t.$implicit,i=t.index,a=Cb();Ow(1),bb("id","piece_0_",r.toString(),""),cb("ngClass",a.getSidePieceClasses(r,i)),nb("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(0,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}function dse(e,t){if(1&e){var n=gb();wm(),hb(0,"circle",8),kb("click",function(){Wy(n);var e=Cb().index,t=Cb().index;return Cb().onBoardClick(e,t)}),fb()}if(2&e){var r=t.$implicit,i=Cb().index,a=Cb().index,o=Cb();cb("ngClass",o.getPieceClasses(r)),nb("r",o.getPieceRadius(r))("cx",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function vse(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"rect",6),kb("click",function(){var e=Wy(n).index,t=Cb().index;return Cb().onBoardClick(e,t)}),fb(),ob(2,dse,1,4,"circle",7),fb()}if(2&e){var r=t.$implicit,i=t.index,a=Cb().index,o=Cb();Ow(1),Eb("id","click_",i,"_",a,""),cb("ngClass",o.getRectClasses(i,a)),nb("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Ow(1),cb("ngForOf",o.getListPieces(r))}}function pse(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,vse,3,8,"g",2),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}function gse(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"rect",9),kb("click",function(){var e=Wy(n).$implicit;return Cb().onBoardClick(e.x,e.y)}),fb(),fb()}if(2&e){var r=t.$implicit,i=Cb();Ow(1),nb("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function yse(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"circle",5),kb("click",function(){var e=Wy(n),t=e.$implicit,r=e.index;return Cb().onPieceClick(1,t,r)}),fb(),fb()}if(2&e){var r=t.$implicit,i=t.index,a=Cb();Ow(1),bb("id","piece_1_",r.toString(),""),cb("ngClass",a.getSidePieceClasses(r,i)),nb("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(1,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}var mse=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).INTER_PIECE_SPACE=20,r.lastLandingCoord=cB.empty(),r.lastStartingCoord=cB.empty(),r.chosenCoord=cB.empty(),r.chosenPiece=cB.empty(),r.remainingPieceLeftX=[],r.rules=new ese(Joe),r.availableMinimaxes=[new nse(r.rules,"EncapsuleMinimax")],r.encoder=tse.encoder,r.tutorial=(new hse).tutorial,r.updateBoard(),r}return ip(n,[{key:"updateBoard",value:function(){this.board=this.rules.node.gameState.getCopiedBoard();var e=this.rules.node.move;this.calculateLeftX(),e.isPresent()?(this.lastLandingCoord=cB.of(e.get().landingCoord),this.lastStartingCoord=e.get().startingCoord):(this.lastLandingCoord=cB.empty(),this.lastStartingCoord=cB.empty())}},{key:"getListPieces",value:function(e){return e.toList()}},{key:"getRemainingPieces",value:function(e){return this.rules.node.gameState.getRemainingPiecesOfPlayer(Zee.of(e))}},{key:"onBoardClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new Jne(e,t),o=n.rules.node.gameState,!n.chosenCoord.isAbsent()){r.next=9;break}if(n.chosenCoord=cB.of(a),!n.chosenPiece.isPresent()){r.next=8;break}return s=tse.fromDrop(n.chosenPiece.get(),a),r.abrupt("return",n.chooseMove(s,n.rules.node.gameState));case 8:return r.abrupt("return",!1===o.getPieceAt(a).belongsTo(o.getCurrentPlayer())?n.cancelMove(Xoe.INVALID_PIECE_SELECTED()):$5.SUCCESS);case 9:if(!n.chosenCoord.equalsValue(a)){r.next=11;break}return r.abrupt("return",n.cancelMove(Xoe.SAME_DEST_AS_ORIGIN()));case 11:return u=tse.fromMove(n.chosenCoord.get(),a),r.abrupt("return",n.chooseMove(u,n.rules.node.gameState));case 13:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=cB.empty(),this.chosenPiece=cB.empty(),this.chosenPieceIndex=-1}},{key:"onPieceClick",value:function(e,t,n){var r=this;return rB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=r.canUserPlay("#piece_"+e+"_"+t.toString()),i.abrupt("return",a.isFailure()?r.cancelMove(a.getReason()):!1===r.rules.node.gameState.isDroppable(t)?r.cancelMove(Xoe.NOT_DROPPABLE()):r.chosenCoord.isAbsent()?(r.chosenPiece=cB.of(t),r.chosenPieceIndex=n,$5.SUCCESS):r.cancelMove(Xoe.END_YOUR_MOVE()));case 2:case"end":return i.stop()}},i)}))()}},{key:"getRectClasses",value:function(e,t){return this.isSelected(e,t)?"moved":""}},{key:"isSelected",value:function(e,t){var n=new Jne(e,t);return!(!this.lastStartingCoord.equalsValue(n)&&!this.lastLandingCoord.equalsValue(n))}},{key:"getPieceClasses",value:function(e){return[this.getPieceStrokeClass(e)]}},{key:"getPieceStrokeClass",value:function(e){return"player"+e.getPlayer().value+"-stroke"}},{key:"getPieceRadius",value:function(e){switch(e.getSize()){case Yoe.BIG:return 40;case Yoe.MEDIUM:return 30;default:return iB.expectToBe(e.getSize(),Yoe.SMALL),20}}},{key:"getHighlightedCases",value:function(){var e=[];return this.chosenCoord.isPresent()&&e.push(this.chosenCoord.get()),e}},{key:"getSidePieceClasses",value:function(e,t){var n=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex===t&&n.push("clickable "),n}},{key:"isSelectedPiece",value:function(e){return this.chosenPiece.equalsValue(e)}},{key:"calculateLeftX",value:function(){this.remainingPieceLeftX=[];for(var e=0;e<=1;e++){this.remainingPieceLeftX.push([]);for(var t=this.getRemainingPieces(e),n=0;n<t.length;n++)if(0===n)this.remainingPieceLeftX[e].push(0);else{var r=this.remainingPieceLeftX[e][n-1],i=2*this.getPieceRadius(t[n-1]);this.remainingPieceLeftX[e].push(r+i+this.INTER_PIECE_SPACE)}}}},{key:"getPieceLeftX",value:function(e,t){return this.remainingPieceLeftX[e][t]}}]),n}(lie);return e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-encapsule"]],features:[HC],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 520 520","preserveAspectRatio","xMidYMid meet"],["remainingCasePlayerZero",""],[4,"ngFor","ngForOf"],["boardDiv",""],["remainingCasePlayerOne",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","highlighted",3,"click"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),hb(1,"g",null,1),ob(3,fse,2,5,"g",2),fb(),hb(4,"g",null,3),ob(6,pse,2,1,"g",2),ob(7,gse,2,4,"g",2),fb(),hb(8,"g",null,4),ob(10,yse,2,5,"g",2),fb(),fb()),2&e&&(Ow(1),nb("transform","translate("+t.STROKE_WIDTH+", 0)"),Ow(2),cb("ngForOf",t.getRemainingPieces(0)),Ow(1),nb("transform","translate("+(260-1.5*t.SPACE_SIZE-t.STROKE_WIDTH)+", "+t.SPACE_SIZE+")"),Ow(2),cb("ngForOf",t.board),Ow(1),cb("ngForOf",t.getHighlightedCases()),Ow(1),nb("transform","translate("+t.STROKE_WIDTH+", "+(2*t.STROKE_WIDTH+4*t.SPACE_SIZE)+")"),Ow(2),cb("ngForOf",t.getRemainingPieces(1)))},directives:[NT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),kse=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o){var s;if(np(this,n),(s=t.call(this,e,r)).movedPieces=i,s.stepSize=a,s.direction=o,s.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+s.coord.toString()+".");if(i<1)throw new Error("Must select minimum one piece (got "+i+").");if(a<1)throw new Error("Step size must be minimum one (got "+a+").");if(a>i)throw new Error("Cannot move a phalanx further than its size (got step size "+a+" for "+i+" pieces).");return jv(s)}return ip(n,[{key:"toString",value:function(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||this.movedPieces!==e.movedPieces||this.stepSize!==e.stepSize)&&this.direction.equals(e.direction)}}]),n}(yre);kse.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"maxValue",value:function(){return 122303}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 8*e.coord.x*7*13*12+8*e.coord.y*7*13+8*(e.movedPieces-1)*7+8*(e.stepSize-1)+t}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%8;e-=t;var n=(e/=8)%7;e-=n;var r=(e/=7)%13;e-=r;var i=(e/=13)%12;e-=i;var a=e/=12,o=Yne.factory.fromInt(t);return new kse(a,i,r+1,n+1,o.get())}}]),n}(jee));var _se=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"count",value:function(e,t){for(var n=0,r=0;r<14;r++)this.board[t][r]===e&&n++;return n}},{key:"doesOwnPiece",value:function(e){for(var t=0;t<12;t++)for(var n=0;n<14;n++)if(this.board[t][n]===e)return!0;return!1}}],[{key:"getInitialState",value:function(){var e=Zee.NONE,t=Zee.ONE,r=Zee.ZERO;return new n([[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r]],0)}}]),n}(vre),wse=function(){var e=ip(function e(){np(this,e)});return e.PHALANX_IS_LEAVING_BOARD=function(){return $localize(Tr||(Tr=Nv(["The move distance of your phalanx puts it out of the board."])))},e.SOMETHING_IN_PHALANX_WAY=function(){return $localize(Ir||(Ir=Nv(["There is something in the way of your phalanx."])))},e.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=function(){return $localize(xr||(xr=Nv(["Your phalanx must be bigger than the one you are capturing."])))},e.CASE_NOT_ALIGNED_WITH_SELECTED=function(){return $localize(Ar||(Ar=Nv(["This square is not aligned with the selected piece."])))},e.SINGLE_PIECE_MUST_MOVE_BY_ONE=function(){return $localize(Rr||(Rr=Nv(["A single piece can only move by one square."])))},e.SINGLE_PIECE_CANNOT_CAPTURE=function(){return $localize(Nr||(Nr=Nv(["A single piece cannot make a capture."])))},e.CASE_NOT_ALIGNED_WITH_PHALANX=function(){return $localize(Mr||(Mr=Nv(["This square is not aligned with the direction of the phalanx."])))},e.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=function(){return $localize(Dr||(Dr=Nv(["A phalanx can't contain pieces outside of the board."])))},e.PHALANX_CANNOT_CONTAIN_EMPTY_CASE=function(){return $localize(Lr||(Lr=Nv(["A phalanx cannot contain an empty square."])))},e.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=function(){return $localize(Fr||(Fr=Nv(["A phalanx cannot contain a piece of the opponent."])))},e}(),Cse=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){return new _se(n,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.count(Zee.ZERO,0),r=t.count(Zee.ONE,11);if(t.turn%2==0){if(n>r)return Ere.ZERO_WON}else if(r>n)return Ere.ONE_WON;return!1===t.doesOwnPiece(Zee.ZERO)?Ere.ONE_WON:!1===t.doesOwnPiece(Zee.ONE)?Ere.ZERO_WON:Ere.ONGOING}}],[{key:"isLegal",value:function(e,t){var r=this.getPhalanxValidity(t,e);if(r.isFailure())return H5.failure(r.getReason());var i=this.getLandingStatus(t,e);if(i.isFailure())return i;var a=Q5.copyBiArray(i.get()),o=t.getCurrentOpponent(),s=n.getCaptureValidity(t,a,e,o);return s.isFailure()?s:H5.success(s.get())}},{key:"getPhalanxValidity",value:function(e,t){for(var n,r=t.coord,i=0,a=e.getCurrentOpponent();i<t.movedPieces;){if(r.isNotInRange(14,12))return $5.failure(wse.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());if((n=e.getPieceAt(r))===Zee.NONE)return $5.failure(wse.PHALANX_CANNOT_CONTAIN_EMPTY_CASE());if(n===a)return $5.failure(wse.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());r=r.getNext(t.direction,1),i++}return $5.SUCCESS}},{key:"getLandingStatus",value:function(e,t){for(var n=e.getCopiedBoard(),r=e.getCurrentPlayer(),i=t.coord,a=t.coord.getNext(t.direction,t.movedPieces),o=0;o+1<t.stepSize;){if(n[i.y][i.x]=Zee.NONE,n[a.y][a.x]=r,a.isNotInRange(14,12))return H5.failure(wse.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(a)!==Zee.NONE)return H5.failure(wse.SOMETHING_IN_PHALANX_WAY());o++,a=a.getNext(t.direction,1),i=i.getNext(t.direction,1)}return a.isNotInRange(14,12)?H5.failure(wse.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(a)===r?H5.failure(ure.CANNOT_SELF_CAPTURE()):(n[i.y][i.x]=Zee.NONE,n[a.y][a.x]=r,H5.success(n))}},{key:"getCaptureValidity",value:function(e,t,n,r){for(var i=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),a=Zee.NONE,o=0;i.isInRange(14,12)&&e.getPieceAt(i)===r;){if(o>0&&(t[i.y][i.x]=a),++o>=n.movedPieces)return H5.failure(wse.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(n.direction,1)}return H5.success(t)}}]),n}(Sre),bse=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){var t=n.getListMoves(e);return Q5.sortByDescending(t,function(e){return e.stepSize}),t}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new lre(t.isEndGame?t.toBoardValue():this.getPieceCountPlusRowDomination(e.gameState))}},{key:"getPieceCountPlusRowDomination",value:function(e){for(var t=0,n=0;n<12;n++){for(var r=0,i=[0,0],a=0;a<14;a++){var o=new Jne(a,n),s=e.getPieceAt(o);if(s!==Zee.NONE){var u=s.getScoreModifier();t+=2002*u,i[s.value]=u,r+=u;for(var c=0,l=[Yne.UP_LEFT,Yne.UP,Yne.UP_RIGHT];c<l.length;c++)for(var h=l[c],f=o.getNext(h,1);f.isInRange(14,12)&&e.getPieceAt(f)===s;)t+=1*u,f=f.getNext(h,1)}}0!==r&&(t+=Math.abs(r)/r*2),t+=1*i.reduce(function(e,t){return e+t})}return t}}],[{key:"getListMoves",value:function(e){for(var t,n=e.gameState.getCurrentPlayer(),r=e.gameState.getCurrentOpponent(),i=Zee.NONE,a=[],o=e.gameState,s=0;s<12;s++)for(var u=0;u<14;u++){var c=new Jne(u,s);if(o.getPieceAt(c)===n){var l,h=Xv(Yne.DIRECTIONS);try{for(h.s();!(l=h.n()).done;){for(var f=l.value,d=1,v=c.getNext(f,1);v.isInRange(14,12)&&o.getPieceAt(v)===n;)d+=1,v=v.getNext(f,1);for(var p=1;v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===i;)t=new kse(u,s,d,p,f),a=this.addMove(a,t,o),p++,v=v.getNext(f,1);v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===r&&(t=new kse(u,s,d,p,f),a=this.addMove(a,t,o))}}catch(g){h.e(g)}finally{h.f()}}}return a}},{key:"addMove",value:function(e,t,n){return Cse.isLegal(t,n).isSuccess()&&e.push(t),e}}]),n}(cre),Ese=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){var t=bse.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}},{key:"orderMovesByPhalanxSizeAndFilter",value:function(e,t){var n=this;return Q5.sortByDescending(e,function(e){return e.movedPieces}),e.length>40?e.filter(function(e){return!!n.moveIsCapture(e,t)||e.movedPieces*Math.random()>1}):e}},{key:"moveIsCapture",value:function(e,t){var n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new lre(t.isEndGame?t.toBoardValue():this.getPieceCountThenSupportThenAdvancement(e.gameState))}},{key:"getPieceCountThenSupportThenAdvancement",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=new Jne(r,n),a=e.getPieceAt(i);if(a!==Zee.NONE){var o=void 0,s=void 0;a===Zee.ZERO?(o=12-n,s=[Yne.UP_LEFT,Yne.UP,Yne.UP_RIGHT]):(o=n+1,s=[Yne.DOWN_LEFT,Yne.DOWN,Yne.DOWN_RIGHT]);var u=a.getScoreModifier();t+=o*u,t+=149629*u;var c,l=Xv(s);try{for(l.s();!(c=l.n()).done;)for(var h=c.value,f=i.getNext(h,1);f.isInRange(14,12)&&e.getPieceAt(f)===a;)t+=337*u,f=f.getNext(h,1)}catch(d){l.e(d)}finally{l.f()}}}return t}}]),n}(cre),Sse=function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.apply(this,arguments)).DOMINANCE_FACTOR=20,e.DEFENSE_FACTOR=5,e.TERRITORY_FACTOR=2,e.OFFENSE_FACTOR=10,e.CENTER_FACTOR=5,e.MOBILITY_FACTOR=.12,e}return ip(n,[{key:"getDominance",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new Jne(r,n));i!==Zee.NONE&&(t+=i.getScoreModifier())}return t*this.DOMINANCE_FACTOR}},{key:"getDefense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new Jne(n,11))===Zee.ZERO&&(t+=Zee.ZERO.getScoreModifier()),e.getPieceAt(new Jne(n,0))===Zee.ONE&&(t+=Zee.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}},{key:"getTerritory",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new Jne(r,n));if(i!==Zee.NONE){for(var a=-1;a<=1;a++)for(var o=-1;o<=1;o++){var s=new Jne(r+a,n+o);if(s.isInRange(14,12)){var u=e.getPieceAt(s);(u===i||u===Zee.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}},{key:"getOffense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new Jne(n,0))===Zee.ZERO&&(t+=Zee.ZERO.getScoreModifier()),e.getPieceAt(new Jne(n,11))===Zee.ONE&&(t+=Zee.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}},{key:"getCenter",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new Jne(r,n));i!==Zee.NONE&&(t+=i.getScoreModifier()*Math.sqrt((r-6.5)*(r-6.5)))}return t*this.CENTER_FACTOR}},{key:"getMobility",value:function(e){for(var t=0,n=0,r=0,i=0;i<12;i++)for(var a=0;a<14;a++){var o=new Jne(a,i),s=e.getPieceAt(o);if(s!==Zee.NONE){var u,c=Xv(Yne.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){for(var l=u.value,h=1,f=o.getNext(l,1);f.isInRange(14,12)&&e.getPieceAt(f)===s;)h+=1,f=f.getNext(l,1);for(var d=1;f.isInRange(14,12)&&d<=h&&e.getPieceAt(f)===Zee.NONE;)d++,f=f.getNext(l,1);t+=d*d*s.getScoreModifier(),s===Zee.ZERO?n=Math.max(n,d):s===Zee.ONE&&(r=Math.max(r,d))}}catch(v){c.e(v)}finally{c.f()}}}return(t+n*Zee.ZERO.getScoreModifier()+r*Zee.ONE.getScoreModifier())*this.MOBILITY_FACTOR}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getGameStatus(e);if(n.isEndGame)return new lre(n.toBoardValue());var r=this.getDominance(t),i=this.getDefense(t),a=this.getTerritory(t),o=this.getCenter(t),s=this.getOffense(t),u=this.getMobility(t);return new lre(r+i+a+o+s+u)}}]),n}(bse),Pse=Zee.NONE,Ose=Zee.ZERO,Tse=Zee.ONE,Ise=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(Br||(Br=Nv(["Initial board"]))),$localize(Vr||(Vr=Nv(["This is the initial board of Epaminondas.\n        The top line is the starting line of Light.\n        The bottom line is the starting line of Dark."]))),_se.getInitialState()),Ire.informational($localize(Ur||(Ur=Nv(["Goal of the game (1/2)"]))),$localize(zr||(zr=Nv(["After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line\n        than the number of pieces the opponent has on the player's starting line, the player wins.\n        Here, it's Dark's turn to play: Dark has therefore won."]))),new _se([[Pse,Pse,Pse,Pse,Pse,Ose,Pse,Pse,Tse,Tse,Tse,Tse,Tse,Tse],[Pse,Pse,Pse,Pse,Pse,Ose,Pse,Pse,Pse,Pse,Pse,Pse,Tse,Tse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Tse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Ose,Ose,Ose,Ose,Pse,Pse,Pse]],0)),Ire.informational($localize(Hr||(Hr=Nv(["Goal of the game (2/2)"]))),$localize(Gr||(Gr=Nv(["Here, it is Light's turn.\n        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line."]))),new _se([[Pse,Pse,Pse,Pse,Pse,Ose,Pse,Pse,Pse,Pse,Tse,Tse,Tse,Tse],[Pse,Pse,Pse,Pse,Pse,Ose,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Tse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Tse,Tse,Pse,Pse,Pse,Ose,Ose,Pse,Ose,Ose,Ose,Ose]],1)),Ire.fromPredicate($localize(qr||(qr=Nv(["Moving a piece"]))),$localize($r||($r=Nv(["Here is the starting board. Dark plays first.\n        Let's start with moving a single piece:\n        <ol>\n            <li>Click on a piece.</li>\n            <li>Click on a empty neighboring square.</li>\n        </ol>"]))),_se.getInitialState(),new kse(0,10,1,1,Yne.UP),function(e,t){return 1===e.movedPieces?$5.SUCCESS:$5.failure($localize(Wr||(Wr=Nv(["Congratulations, you are in advance. But this is not the exercise here, try again."]))))},$localize(jr||(jr=Nv(["This is how you move a single piece."])))),Ire.fromPredicate($localize(Zr||(Zr=Nv(["Moving a phalanx"]))),$localize(Yr||(Yr=Nv(["Let us now see how to move multiple pieces along a line, which is called a phalanx:\n        <ol>\n            <li>Click on the first piece of the phalanx.</li>\n            <li>Click on the last piece of the phalanx.</li>\n            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>\n        </ol><br/>\n        Move a phalanx!"]))),_se.getInitialState(),new kse(0,11,2,1,Yne.UP),function(e,t){return e.movedPieces>1?$5.SUCCESS:$5.failure($localize(Kr||(Kr=Nv(["Failed! You moved only one piece."]))))},$localize(Jr||(Jr=Nv(["Congratulations!\n        The moved pieces can be horizontally, vertically, or diagonally aligned.\n        The move should be made along this axis, forward or backwards.\n        There can be no opponent nor holes in the phalanx."])))),Ire.fromMove($localize(Qr||(Qr=Nv(["Capture"]))),$localize(Xr||(Xr=Nv(["In order to capture pieces of the opponent:\n        <ol>\n            <li>It must be aligned with the phalanx you are moving.</li>\n            <li>It must be strictly shorter than your phalanx.</li>\n            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>\n        </ol><br/>\n        Capture a phalanx."]))),new _se([[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Tse,Tse,Tse,Tse,Tse,Tse],[Pse,Pse,Pse,Pse,Pse,Pse,Tse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Tse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Tse,Pse,Tse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Tse,Tse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Tse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Ose,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Ose,Pse,Pse,Pse,Pse,Tse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Ose,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Ose,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse,Pse],[Pse,Pse,Pse,Pse,Pse,Pse,Pse,Ose,Ose,Ose,Ose,Ose,Ose,Ose]],0),[new kse(2,10,4,2,Yne.UP)],$localize(ei||(ei=Nv(["Congratulations, you made it!\n        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment."]))),$localize(ti||(ti=Nv(["Failed, you have not captured the phalanx."]))))]});function xse(e,t){if(1&e){var n=gb();wm(),hb(0,"circle",4),kb("click",function(){Wy(n);var e=Cb().index,t=Cb().index;return Cb().onClick(e,t)}),fb()}if(2&e){var r=Cb().index,i=Cb().index,a=Cb();cb("ngClass",a.getPieceClasses(r,i)),nb("r",.5*(a.SPACE_SIZE-2*a.STROKE_WIDTH))("cx",a.SPACE_SIZE*r+a.STROKE_WIDTH+a.SPACE_SIZE/2)("cy",a.SPACE_SIZE*i+a.STROKE_WIDTH+a.SPACE_SIZE/2)}}function Ase(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"rect",2),kb("click",function(){var e=Wy(n).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),ob(2,xse,1,4,"circle",3),fb()}if(2&e){var r=t.index,i=Cb().index,a=Cb();Ow(1),Eb("id","click_",r,"_",i,""),cb("ngClass",a.getRectClasses(r,i)),nb("x",a.SPACE_SIZE*r+a.STROKE_WIDTH)("y",a.SPACE_SIZE*i+a.STROKE_WIDTH)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Ow(1),cb("ngIf",a.board[i][r]!==a.NONE)}}function Rse(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,Ase,3,8,"g",1),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}function Nse(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"rect",5),kb("click",function(){var e=Wy(n).$implicit;return Cb().onClick(e.x,e.y)}),fb(),fb()}if(2&e){var r=t.$implicit,i=Cb();Ow(1),nb("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var Mse=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).NONE=Zee.NONE,r.firstPiece=cB.empty(),r.validExtensions=[],r.phalanxValidLandings=[],r.lastPiece=cB.empty(),r.phalanxDirection=cB.empty(),r.phalanxMiddles=[],r.moveds=[],r.captureds=[],r.rules=new Cse(_se),r.availableMinimaxes=[new bse(r.rules,"Normal"),new Ese(r.rules,"Positional"),new Sse(r.rules,"Attack")],r.encoder=kse.encoder,r.tutorial=(new Ise).tutorial,r.updateBoard(),r}return ip(n,[{key:"updateBoard",value:function(){this.firstPiece=cB.empty(),this.lastPiece=cB.empty(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.board=this.rules.node.gameState.getCopiedBoard()}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get(),t=e.coord;this.moveds=[t];for(var n=1;n<e.stepSize+e.movedPieces;n++)t=t.getNext(e.direction,1),this.moveds.push(t);for(var r=this.rules.node.mother.get(),i=r.gameState.getCurrentOpponent();t.isInRange(14,12)&&r.gameState.getPieceAt(t)===i;)this.captureds.push(t),t=t.getNext(e.direction,1)}},{key:"onClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.firstPiece.isAbsent()?n.firstClick(e,t):n.lastPiece.isAbsent()?n.secondClick(e,t):n.thirdClick(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=n.rules.node.gameState.getCurrentOpponent(),a=n.rules.node.gameState.getCurrentPlayer(),r.t0=n.board[t][e],r.next=r.t0===a?4:r.t0===i?5:6;break;case 4:return r.abrupt("return",(n.firstPiece=cB.of(new Jne(e,t)),n.validExtensions=n.getValidExtensions(a),n.phalanxValidLandings=n.getPhalanxValidLandings(),$5.SUCCESS));case 5:return r.abrupt("return",n.cancelMove(ure.CANNOT_CHOOSE_OPPONENT_PIECE()));case 6:return r.abrupt("return",(iB.expectToBe(n.board[t][e],Zee.NONE),n.cancelMove(ure.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())));case 7:case"end":return r.stop()}},r)}))()}},{key:"hidePreviousMove",value:function(){this.captureds=[],this.moveds=[]}},{key:"getValidExtensions",value:function(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}},{key:"getFirstPieceExtensions",value:function(e){var t,n=[],r=Xv(Yne.DIRECTIONS);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.firstPiece.get().getNext(i,1);a.isInRange(14,12)&&this.board[a.y][a.x]===e;)n.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPhalanxValidExtensions",value:function(e){var t=Yne.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get(),n=this.lastPiece.get().getNext(t,1),r=this.getExtensionsToward(n,t,e);t=t.getOpposite();var i=this.firstPiece.get().getNext(t,1),a=this.getExtensionsToward(i,t,e);return r.concat(a)}},{key:"getExtensionsToward",value:function(e,t,n){for(var r=[];e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r.push(e),e=e.getNext(t,1);return r}},{key:"getPhalanxValidLandings",value:function(){if(this.lastPiece.isPresent()){var e=this.firstPiece.get(),t=this.lastPiece.get(),n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y),i=Math.max(n,r)+1,a=Yne.factory.fromMove(e,t).get(),o=t.getNext(a,1),s=this.getLandingsToward(o,a,i);a=a.getOpposite();var u=e.getNext(a,1);return this.getLandingsToward(u,a,i).concat(s)}return this.getNeighbooringEmptyCases()}},{key:"getNeighbooringEmptyCases",value:function(){var e,t=[],n=Xv(Yne.DIRECTIONS);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.firstPiece.get().getNext(r,1);i.isInRange(14,12)&&this.board[i.y][i.x]===Zee.NONE&&t.push(i)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"getLandingsToward",value:function(e,t,n){for(var r=this.rules.node.gameState.getCurrentPlayer(),i=this.rules.node.gameState.getCurrentOpponent(),a=[];e.isInRange(14,12)&&a.length<n&&this.board[e.y][e.x]!==r;){if(this.board[e.y][e.x]===i)return this.getPhalanxLength(e,t,i)<n&&a.push(e),a;a.push(e),e=e.getNext(t,1)}return a}},{key:"getPhalanxLength",value:function(e,t,n){for(var r=0;e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r++,e=e.getNext(t,1);return r}},{key:"cancelMoveAttempt",value:function(){this.firstPiece=cB.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=cB.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}},{key:"secondClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,h;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new Jne(e,t),a=n.firstPiece.get(),!i.equals(a)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),$5.SUCCESS));case 3:if(o=n.rules.node.gameState.getCurrentOpponent(),s=n.rules.node.gameState.getCurrentPlayer(),i.isAlignedWith(a)){r.next=6;break}return r.abrupt("return",n.cancelMove(wse.CASE_NOT_ALIGNED_WITH_SELECTED()));case 6:u=i.getDistance(a),c=a.getDirectionToward(i).get(),r.t0=n.board[t][e],r.next=r.t0===Zee.NONE?10:r.t0===o?11:12;break;case 10:return r.abrupt("return",1===u?n.tryMove(new kse(a.x,a.y,1,1,c)):n.cancelMove(wse.SINGLE_PIECE_MUST_MOVE_BY_ONE()));case 11:return r.abrupt("return",n.cancelMove(wse.SINGLE_PIECE_CANNOT_CAPTURE()));case 12:return iB.expectToBe(n.board[t][e],s),l=new kse(a.x,a.y,u,1,c),h=Cse.getPhalanxValidity(n.rules.node.gameState,l),r.abrupt("return",h.isFailure()?n.cancelMove(h.getReason()):(n.lastPiece=cB.of(i),n.validExtensions=n.getValidExtensions(s),n.phalanxValidLandings=n.getPhalanxValidLandings(),n.phalanxMiddles=a.getCoordsToward(i),n.phalanxDirection=cB.of(c),$5.SUCCESS));case 15:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,h,f,d,v,p;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.rules.node.gameState.getCurrentPlayer(),a=new Jne(e,t),!n.firstPiece.equalsValue(a)){r.next=3;break}return r.abrupt("return",n.moveFirstPiece(i));case 3:if(!n.lastPiece.equalsValue(a)){r.next=5;break}return r.abrupt("return",n.moveLastPiece(i));case 5:if(o=n.firstPiece.get(),s=n.lastPiece.get(),a.isAlignedWith(o)){r.next=8;break}return r.abrupt("return",n.cancelMove(wse.CASE_NOT_ALIGNED_WITH_PHALANX()));case 8:if(u=Yne.factory.fromMove(o,s).get(),c=Yne.factory.fromMove(o,a).get(),u===c.getOpposite()&&(n.firstPiece=cB.of(s),n.lastPiece=cB.of(o),u=c),u===c){r.next=12;break}return r.abrupt("return",n.cancelMove(wse.CASE_NOT_ALIGNED_WITH_PHALANX()));case 12:if(n.board[t][e]!==i){r.next=16;break}return n.lastPiece=cB.of(a),l=n.firstPiece.get().getDistance(a)+1,h=new kse(n.firstPiece.get().x,n.firstPiece.get().y,l,1,u),f=Cse.getPhalanxValidity(n.rules.node.gameState,h),r.abrupt("return",f.isFailure()?n.cancelMove(f.getReason()):(n.phalanxMiddles=n.firstPiece.get().getCoordsToward(n.lastPiece.get()),n.validExtensions=n.getValidExtensions(i),n.phalanxValidLandings=n.getPhalanxValidLandings(),$5.SUCCESS));case 16:return d=n.firstPiece.get().getDistance(n.lastPiece.get())+1,v=n.lastPiece.get().getDistance(a),p=new kse(n.firstPiece.get().x,n.firstPiece.get().y,d,v,u),r.abrupt("return",n.tryMove(p));case 18:case"end":return r.stop()}},r)}))()}},{key:"moveFirstPiece",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.firstPiece=cB.of(t.firstPiece.get().getNext(t.phalanxDirection.get(),1)),!t.firstPiece.equals(t.lastPiece)){n.next=6;break}return n.next=4,t.moveOnlyPiece(e);case 4:n.next=7;break;case 6:t.phalanxMiddles=t.phalanxMiddles.slice(1),t.validExtensions=t.getPhalanxValidExtensions(e);case 7:return t.phalanxValidLandings=t.getPhalanxValidLandings(),n.abrupt("return",$5.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveLastPiece",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=cB.of(t.lastPiece.get().getPrevious(t.phalanxDirection.get(),1)),t.firstPiece.equals(t.lastPiece)?t.moveOnlyPiece(e):(t.phalanxMiddles=t.firstPiece.get().getCoordsToward(t.lastPiece.get()),t.validExtensions=t.getPhalanxValidExtensions(e),t.phalanxValidLandings=t.getPhalanxValidLandings(),$5.SUCCESS)));case 1:case"end":return n.stop()}},n)}))()}},{key:"moveOnlyPiece",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=cB.empty(),t.validExtensions=t.getFirstPieceExtensions(e),t.phalanxDirection=cB.empty(),t.phalanxMiddles=[],t.phalanxValidLandings=t.getPhalanxValidLandings(),$5.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e){var t=this.rules.node.gameState;return this.cancelMove(),this.chooseMove(e,t)}},{key:"getPieceClasses",value:function(e,t){var n=this.getPlayerClass(this.board[t][e]);return this.getPieceStrokeClasses(e,t).concat([n])}},{key:"getPieceStrokeClasses",value:function(e,t){var n=new Jne(e,t);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(n)||this.lastPiece.equalsValue(n)||this.phalanxMiddles.some(function(e){return e.equals(n)})?["highlighted"]:[]}},{key:"getRectClasses",value:function(e,t){var n=new Jne(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured"]:this.moveds.some(function(e){return e.equals(n)})?["moved"]:[]}},{key:"getHighlightedCoords",value:function(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}},{key:"getCurrentPlayerPieces",value:function(){for(var e=[],t=this.rules.node.gameState.getCurrentPlayer(),n=0;n<this.board.length;n++)for(var r=0;r<this.board[n].length;r++)this.board[n][r]===t&&e.push(new Jne(r,n));return e}}]),n}(lie);return e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-epaminondas"]],features:[HC],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable",3,"click"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),ob(1,Rse,2,1,"g",1),ob(2,Nse,2,4,"g",1),fb()),2&e&&(Ow(1),cb("ngForOf",t.board),Ow(1),cb("ngForOf",t.getHighlightedCoords()))},directives:[NT,AT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}();function Dse(e){return new(function(t){qv(r,t);var n=Wv(r);function r(){return np(this,r),n.apply(this,arguments)}return ip(r,[{key:"encode",value:function(t){return t.isPresent()?e.encode(t.get()):null}},{key:"decode",value:function(t){return null===t?cB.empty():cB.of(e.decode(t))}}]),r}($ee))}var Lse=function(){function e(t){if(np(this,e),t.length<4)throw new Error("Cannot create a GipfCapture with less than 4 captured pieces");if(!1===koe.areOnSameLine(t))throw new Error("Cannot create a GipfCapture with pieces that are not on the same line");this.capturedSpaces=Q5.copyImmutableArray(t).sort(function(e,t){if(e.x===t.x){if(e.y===t.y)throw new Error("Cannot create a GipfCapture with duplicate cases");return e.y>t.y?1:-1}return e.x>t.x?1:-1});var n,r=cB.empty(),i=Xv(this.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(r.isPresent()&&1!==r.get().getDistance(a))throw new Error("Cannot create a GipfCapture with non-consecutive cases");r=cB.of(a)}}catch(o){i.e(o)}finally{i.f()}}return ip(e,[{key:"toString",value:function(){var e,t="",n=Xv(this.capturedSpaces);try{for(n.s();!(e=n.n()).done;){var r=e.value;""!==t&&(t+=","),t+=r.toString()}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"size",value:function(){return this.capturedSpaces.length}},{key:"forEach",value:function(e){this.capturedSpaces.forEach(e)}},{key:"contains",value:function(e){for(var t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}},{key:"intersectsWith",value:function(e){return this.capturedSpaces.some(function(t){return e.contains(t)})}},{key:"getLine",value:function(){return koe.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}},{key:"equals",value:function(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(var t=0;t<this.capturedSpaces.length;t++)if(!this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}]),e}();Lse.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"encode",value:function(e){return e.capturedSpaces.map(function(e){return Jne.encoder.encode(e)})}},{key:"decode",value:function(e){return new Lse(e.map(function(e){return Jne.encoder.decode(e)}))}}]),n}($ee));var Fse=function(){function e(t,n){np(this,e),this.coord=t,this.direction=n}return ip(e,[{key:"toString",value:function(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}},{key:"equals",value:function(e){return!!this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}]),e}();Fse.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.apply(this,arguments)).optionalDirectionEncoder=Dse(rre.encoder),e}return ip(n,[{key:"encode",value:function(e){return{coord:Jne.encoder.encode(e.coord),direction:this.optionalDirectionEncoder.encode(e.direction)}}},{key:"decode",value:function(e){var t=e;return Z5(null!=t.coord,"Invalid encoded GipfPlacement"),new Fse(Jne.encoder.decode(t.coord),this.optionalDirectionEncoder.decode(t.direction))}}]),n}($ee));var Bse=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this)).placement=e,a.initialCaptures=r,a.finalCaptures=i,a}return ip(n,[{key:"toString",value:function(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=Xv(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"equals",value:function(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===Q5.compareArray(this.initialCaptures,e.initialCaptures)||!1===Q5.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}]),n}(gre);Bse.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"encodeMove",value:function(e){var t={placement:Fse.encoder.encode(e.placement)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=Lse.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=Lse.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return Z5(null!=t.placement,"Invalid encoded GipfMove"),new Bse(Fse.encoder.decode(t.placement),this.decodeArray(t,"initialCapture",Lse.encoder.decode),this.decodeArray(t,"finalCapture",Lse.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(Wee));var Vse=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a){var o;return np(this,n),(o=t.call(this,r,e,7,7,[3,2,1],nre.EMPTY)).sidePieces=i,o.capturedPieces=a,o}return ip(n,[{key:"equals",value:function(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&Q5.compareTable(this.board,e.board)}},{key:"getNumberOfPiecesToPlace",value:function(e){return this.sidePieces[e.value]}},{key:"getNumberOfPiecesCaptured",value:function(e){return this.capturedPieces[e.value]}},{key:"setAtUnsafe",value:function(e,t){var r=Q5.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.sidePieces,this.capturedPieces)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==nre.NONE}}],[{key:"getInitialState",value:function(){var e=nre.EMPTY,t=nre.NONE,r=nre.ZERO,i=nre.ONE;return new n([[t,t,t,i,e,e,r],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[r,e,e,e,e,e,i],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[i,e,e,r,t,t,t]],0,[12,12],[0,0])}}]),n}(_oe),Use=function(){var e=ip(function e(){np(this,e)});return e.CAPTURE_MUST_BE_ALIGNED=function(){return $localize(ni||(ni=Nv(["You can only capture when 4 or more of your pieces are aligned, and it is not the case."])))},e.INVALID_CAPTURED_PIECES=function(){return $localize(ri||(ri=Nv(["You must select a valid capture that contains 4 pieces or more."])))},e.MISSING_CAPTURES=function(){return $localize(ii||(ii=Nv(["There are still possible captures to be done."])))},e.PLACEMENT_NOT_ON_BORDER=function(){return $localize(ai||(ai=Nv(["Pieces must be inserted in spaces on the edge of the board."])))},e.INVALID_PLACEMENT_DIRECTION=function(){return $localize(oi||(oi=Nv(["You must select a valid placement direction."])))},e.PLACEMENT_WITHOUT_DIRECTION=function(){return $localize(si||(si=Nv(["You must select a placement with a direction alongside the insertion space."])))},e.PLACEMENT_ON_COMPLETE_LINE=function(){return $localize(ui||(ui=Nv(["You cannot place a piece on a complete line."])))},e.AMBIGUOUS_CAPTURE_COORD=function(){return $localize(ci||(ci=Nv(["This piece belongs to two captures. Please select another piece in the capture you'd like to make."])))},e.CLICK_FURTHER_THAN_ONE_COORD=function(){return $localize(li||(li=Nv(["You must click on an arrow to select your destination."])))},e.NO_DIRECTIONS_AVAILABLE=function(){return $localize(hi||(hi=Nv(["You cannot insert a piece here, as all lines are full. Select another space."])))},e}(),zse=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"applyLegalMove",value:function(e,t,n){return new Vse(n.board,n.turn+1,n.sidePieces,n.capturedPieces)}},{key:"getPiecesMoved",value:function(e,t,r){var i=n.applyCaptures(e,t);if(r.direction.isAbsent())return[r.coord];var a=r.direction.get(),o=[];o.push(r.coord);for(var s=r.coord.getNext(a);i.isOnBoard(s)&&i.getPieceAt(s)!==nre.EMPTY;)o.push(s),s=s.getNext(a);return Z5(i.isOnBoard(s)&&i.getPieceAt(s)===nre.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(s),o}},{key:"isLegal",value:function(e,t){var r=this.capturesValidity(t,e.initialCaptures);if(r.isFailure())return r.toFailedFallible();var i=n.applyCaptures(t,e.initialCaptures),a=this.noMoreCapturesValidity(i);if(a.isFailure())return a.toFailedFallible();var o=this.placementValidity(i,e.placement);if(o.isFailure())return o.toFailedFallible();var s=n.applyPlacement(i,e.placement),u=this.capturesValidity(s,e.finalCaptures);if(u.isFailure())return u.toFailedFallible();var c=n.applyCaptures(s,e.finalCaptures),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toFailedFallible():H5.success(c)}},{key:"capturesValidity",value:function(e,t){var r,i=e,a=Xv(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=this.captureValidity(i,o);if(s.isFailure())return s;i=n.applyCapture(i,o)}}catch(u){a.e(u)}finally{a.f()}return $5.SUCCESS}},{key:"captureValidity",value:function(e,t){var r=e.getCurrentPlayer(),i=n.getLinePortionWithFourPiecesOfPlayer(e,r,t.getLine());if(i.isAbsent())return $5.failure(Use.CAPTURE_MUST_BE_ALIGNED());var a=i.get();return n.getCapturable(e,a).equals(t)?$5.SUCCESS:$5.failure(Use.INVALID_CAPTURED_PIECES())}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===n.getLinePortionsWithFourPiecesOfPlayer(e,t).length?$5.SUCCESS:$5.failure(Use.MISSING_CAPTURES())}},{key:"placementValidity",value:function(e,t){var r=this.placementCoordValidity(e,t.coord);if(r.isFailure())return r;if(e.getPieceAt(t.coord)!==nre.EMPTY){if(t.direction.isAbsent())return $5.failure(Use.PLACEMENT_WITHOUT_DIRECTION());if(n.isLineComplete(e,t.coord,t.direction.get()))return $5.failure(Use.PLACEMENT_ON_COMPLETE_LINE());var i,a=Xv(n.getAllDirectionsForEntrance(e,t.coord));try{for(a.s();!(i=a.n()).done;){if(i.value===t.direction.get())return $5.SUCCESS}}catch(o){a.e(o)}finally{a.f()}return $5.failure(Use.INVALID_PLACEMENT_DIRECTION())}return $5.SUCCESS}},{key:"placementCoordValidity",value:function(e,t){return sre.INSTANCE.isOnBorder(e,t)?$5.SUCCESS:$5.failure(Use.PLACEMENT_NOT_ON_BORDER())}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getPlayerScore(t,Zee.ZERO),i=n.getPlayerScore(t,Zee.ONE);return r.isAbsent()?Ere.ONE_WON:i.isAbsent()?Ere.ZERO_WON:Ere.ONGOING}}],[{key:"applyCaptures",value:function(e,t){var r=e;return t.forEach(function(e){r=n.applyCapture(r,e)}),r}},{key:"applyCapture",value:function(e,t){var n=e.getCurrentPlayer(),r=e,i=[e.sidePieces[0],e.sidePieces[1]],a=[e.capturedPieces[0],e.capturedPieces[1]];return t.forEach(function(t){var o=e.getPieceAt(t);r=r.setAt(t,nre.EMPTY),o.is(n)?i[n.value]+=1:a[n.value]+=1}),new Vse(r.board,e.turn,i,a)}},{key:"getPlacements",value:function(e){var t=[];return sre.INSTANCE.getAllBorders(e).forEach(function(r){e.getPieceAt(r)===nre.EMPTY?t.push(new Fse(r,cB.empty())):n.getAllDirectionsForEntrance(e,r).forEach(function(i){!1===n.isLineComplete(e,r,i)&&t.push(new Fse(r,cB.of(i)))})}),t}},{key:"isLineComplete",value:function(e,t,r){return n.nextGapInLine(e,t,r).isAbsent()}},{key:"nextGapInLine",value:function(e,t,n){for(var r=t;e.isOnBoard(r);r=r.getNext(n))if(e.getPieceAt(r)===nre.EMPTY)return cB.of(r);return cB.empty()}},{key:"applyPlacement",value:function(e,t){var n=e.getCurrentPlayer(),r=e,i=nre.ofPlayer(e.getCurrentPlayer());if(t.direction.isAbsent()){var a=t.coord;if(e.getPieceAt(a)!==nre.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");r=r.setAt(a,i)}else for(var o=t.coord;r.isOnBoard(o)&&i!==nre.EMPTY;o=o.getNext(t.direction.get())){var s=e.getPieceAt(o);r=r.setAt(o,i),i=s}var u=[e.sidePieces[0],e.sidePieces[1]];return u[n.value]-=1,new Vse(r.board,e.turn,u,e.capturedPieces)}},{key:"getAllDirectionsForEntrance",value:function(e,t){if(sre.INSTANCE.isTopLeftCorner(e,t))return[rre.RIGHT,rre.DOWN,rre.UP_RIGHT];if(sre.INSTANCE.isTopCorner(e,t))return[rre.DOWN,rre.DOWN_LEFT,rre.RIGHT];if(sre.INSTANCE.isTopRightCorner(e,t))return[rre.DOWN_LEFT,rre.DOWN,rre.LEFT];if(sre.INSTANCE.isBottomLeftCorner(e,t))return[rre.UP_RIGHT,rre.UP,rre.RIGHT];if(sre.INSTANCE.isBottomCorner(e,t))return[rre.UP,rre.LEFT,rre.UP_RIGHT];if(sre.INSTANCE.isBottomRightCorner(e,t))return[rre.LEFT,rre.UP,rre.DOWN_LEFT];if(sre.INSTANCE.isOnTopLeftBorder(e,t))return[rre.RIGHT,rre.DOWN];if(sre.INSTANCE.isOnLeftBorder(e,t))return[rre.UP_RIGHT,rre.RIGHT];if(sre.INSTANCE.isOnBottomLeftBorder(e,t))return[rre.UP,rre.UP_RIGHT];if(sre.INSTANCE.isOnBottomRightBorder(e,t))return[rre.LEFT,rre.UP];if(sre.INSTANCE.isOnRightBorder(e,t))return[rre.LEFT,rre.DOWN_LEFT];if(sre.INSTANCE.isOnTopRightBorder(e,t))return[rre.DOWN_LEFT,rre.DOWN];throw new Error("not a border")}},{key:"getLinePortionsWithFourPiecesOfPlayer",value:function(e,t){var r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithFourPiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithFourPiecesOfPlayer",value:function(e,t,n){for(var r=0,i=e.getEntranceOnLine(n),a=n.getDirection(),o=i,s=i;e.isOnBoard(s);s=s.getNext(a))if(e.getPieceAt(s).is(t)?(0===r&&(o=s),r+=1):r=0,4===r)return cB.of({0:o,1:s,2:a});return cB.empty()}},{key:"getCapturable",value:function(e,t){for(var n=[],r=t[0],i=t[1],a=t[2],o=a.getOpposite(),s=r.getNext(o);e.isOnBoard(s)&&e.getPieceAt(s)!==nre.EMPTY;)n.push(s),s=s.getNext(o);for(var u=r;!u.equals(i);u=u.getNext(a))n.push(u);for(var c=i;e.isOnBoard(c)&&e.getPieceAt(c)!==nre.EMPTY;c=c.getNext(a))n.push(c);return new Lse(n)}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),r=[];return n.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(function(t){r.push(n.getCapturable(e,t))}),r}},{key:"getPlayerScore",value:function(e,t){var r=e.getNumberOfPiecesToPlace(t);if(0===r&&0===n.getPossibleCaptures(e).length)return cB.empty();var i=e.getNumberOfPiecesCaptured(t);return cB.of(r+3*i)}},{key:"isGameOver",value:function(e){var t=n.getPlayerScore(e,Zee.ZERO),r=n.getPlayerScore(e,Zee.ONE);return t.isAbsent()||r.isAbsent()}}]),n}(Sre),Hse=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getBoardValue",value:function(e){var t=e.gameState,n=zse.getPlayerScore(t,Zee.ZERO),r=zse.getPlayerScore(t,Zee.ONE);return n.isAbsent()?new lre(Zee.ONE.getVictoryValue()):r.isAbsent()?new lre(Zee.ZERO.getVictoryValue()):new lre(n.get()-r.get())}},{key:"getListMoves",value:function(e){return this.getListMoveFromState(e.gameState)}},{key:"getListMoveFromState",value:function(e){var t=this,n=[];return zse.isGameOver(e)||this.getPossibleCaptureCombinations(e).forEach(function(r){var i=zse.applyCaptures(e,r);zse.getPlacements(i).forEach(function(e){var a=zse.applyPlacement(i,e);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new Bse(e,r,t);n.push(i)})})}),n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=zse.getPossibleCaptures(e);return n.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}],[{key:"getPossibleCaptureCombinationsFromPossibleCaptures",value:function(e){var t=n.computeIntersections(e),r=[[]];return e.forEach(function(e,n){if(0===t[n].length)r.forEach(function(e){e.push(n)});else{var i,a=[],o=t[n].some(function(e){return e>n}),s=Xv(r);try{for(s.s();!(i=s.n()).done;){var u=i.value;!0===u.some(function(e){return t[n].some(function(t){return e===t})})?a.push(Q5.copyImmutableArray(u)):o?(a.push(Q5.copyImmutableArray(u)),u.push(n),a.push(Q5.copyImmutableArray(u))):(u.push(n),a.push(Q5.copyImmutableArray(u)))}}catch(c){s.e(c)}finally{s.f()}r=a}}),r.map(function(t){return t.map(function(t){return e[t]})})}},{key:"computeIntersections",value:function(e){var t=[];return e.forEach(function(n,r){t.push([]),e.forEach(function(e,i){r!==i&&n.intersectsWith(e)&&t[r].push(i)})}),t}}]),n}(cre),Gse=ip(function e(t,n,r,i,a,o){np(this,e),this.source=t,this.destination=n,this.x1=r,this.y1=i,this.x2=a,this.y2=o}),qse=nre.NONE,$se=nre.EMPTY,Wse=nre.ZERO,jse=nre.ONE,Zse=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(fi||(fi=Nv(["Goal of the game"]))),$localize(di||(di=Nv(["The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.\n        This is the initial board.\n        Each player has 12 pieces on the side and 3 pieces on the board.\n        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.\n        The first player plays with the dark pieces, the second player plays with the light pieces."]))),Vse.getInitialState()),Ire.anyMove($localize(vi||(vi=Nv(["Pushing"]))),$localize(pi||(pi=Nv(["Pieces can only enter the board through the edges. To insert a new piece:\n        <ol>\n            <li>Click on a space on the edge of the board.</li>\n            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>\n        </ol>\n        You cannot push when a line is full.<br/><br/>\n        You're playing Dark, insert a piece."]))),Vse.getInitialState(),new Bse(new Fse(new Jne(3,0),cB.of(rre.DOWN)),[],[]),$localize(gi||(gi=Nv(["Congratulations!"])))),Ire.fromMove($localize(yi||(yi=Nv(["Capture (1/3)"]))),$localize(mi||(mi=Nv(["To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.\n        There are multiple important aspects of a capture:\n        <ol>\n            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>\n            <li>As soon as there is an empty space on the line, the capture stops.</li>\n            <li>Your own pieces that are captured go back to your stock.\n                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>\n            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.\n                This means that a turn happens in three phases:\n                <ol type=\"A\">\n                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>\n                    <li>Make your insertion.</li>\n                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>\n                </ol>\n            </li>\n        </ol><br/>\n        You're playing Dark, you can make a capture, do it."]))),new Vse([[qse,qse,qse,Wse,jse,$se,$se],[qse,qse,$se,$se,$se,$se,$se],[qse,$se,$se,$se,$se,$se,$se],[Wse,Wse,Wse,$se,$se,$se,$se],[jse,$se,$se,$se,$se,$se,qse],[$se,$se,$se,jse,$se,qse,qse],[$se,$se,$se,jse,qse,qse,qse]],42,[8,8],[0,0]),[new Bse(new Fse(new Jne(0,3),cB.of(rre.RIGHT)),[],[new Lse([new Jne(0,3),new Jne(1,3),new Jne(2,3),new Jne(3,3)])])],$localize(ki||(ki=Nv(["Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.\n        Let's now see how captures can really be useful."]))),$localize(_i||(_i=Nv(["Failed!"])))),Ire.fromMove($localize(wi||(wi=Nv(["Capture (2/3)"]))),$localize(Ci||(Ci=Nv(["Here, there are three different ways of capturing.\n        <ol>\n          <li>One way does not capture any of your opponent's pieces.</li>\n          <li>Another way captures one of your opponent's pieces.</li>\n          <li>The last way captures two of your opponent's pieces.</li>\n        </ol>\n        <br/><br/>\n        Pick the last one."]))),new Vse([[qse,qse,qse,$se,$se,$se,$se],[qse,qse,$se,jse,$se,$se,$se],[qse,$se,$se,Wse,$se,$se,$se],[Wse,Wse,Wse,jse,$se,$se,$se],[$se,$se,$se,Wse,$se,$se,qse],[$se,$se,$se,Wse,$se,qse,qse],[$se,$se,$se,jse,qse,qse,qse]],42,[8,4],[2,3]),[new Bse(new Fse(new Jne(0,3),cB.of(rre.RIGHT)),[],[new Lse([new Jne(3,1),new Jne(3,2),new Jne(3,3),new Jne(3,4),new Jne(3,5),new Jne(3,6)])])],$localize(bi||(bi=Nv(["Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.\n        The most you can get is 3 per capture."]))),$localize(Ei||(Ei=Nv(["Failed, the best capture was taking 2 of your opponent's pieces"])))),Ire.fromMove($localize(Si||(Si=Nv(["Capture (3/3)"]))),$localize(Pi||(Pi=Nv(["Here, you must capture at the beginning of your turn.\n        This is due to a move of your opponent at the previous turn\n        (even though this is a fictitious board for pedagogical purpose).\n        After your capture, by performing the right move you can even capture two more of your opponent's pieces!\n        Keep it mind that the most useful in a capture is to take your opponent's pieces."]))),new Vse([[qse,qse,qse,Wse,$se,$se,Wse],[qse,qse,$se,Wse,$se,$se,Wse],[qse,Wse,Wse,$se,Wse,jse,Wse],[$se,$se,$se,Wse,$se,$se,Wse],[$se,$se,$se,Wse,$se,$se,qse],[Wse,Wse,Wse,jse,jse,qse,qse],[$se,$se,$se,Wse,qse,qse,qse]],42,[8,4],[2,3]),[new Bse(new Fse(new Jne(3,6),cB.of(rre.UP)),[new Lse([new Jne(6,0),new Jne(6,1),new Jne(6,2),new Jne(6,3)])],[new Lse([new Jne(0,5),new Jne(1,5),new Jne(2,5),new Jne(3,5),new Jne(4,5)]),new Lse([new Jne(1,2),new Jne(2,2),new Jne(3,2),new Jne(4,2),new Jne(5,2)])]),new Bse(new Fse(new Jne(4,6),cB.of(rre.UP)),[new Lse([new Jne(6,0),new Jne(6,1),new Jne(6,2),new Jne(6,3)])],[new Lse([new Jne(0,5),new Jne(1,5),new Jne(2,5),new Jne(3,5),new Jne(4,5)]),new Lse([new Jne(3,0),new Jne(3,1),new Jne(3,2),new Jne(3,3),new Jne(3,4)])]),new Bse(new Fse(new Jne(3,6),cB.of(rre.UP)),[new Lse([new Jne(6,0),new Jne(6,1),new Jne(6,2),new Jne(6,3)])],[new Lse([new Jne(1,2),new Jne(2,2),new Jne(3,2),new Jne(4,2),new Jne(5,2)]),new Lse([new Jne(0,5),new Jne(1,5),new Jne(2,5),new Jne(3,5),new Jne(4,5)])])],$localize(Oi||(Oi=Nv(["Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces."]))),$localize(Ti||(Ti=Nv(["Failed, the best capture takes 2 of your opponent's pieces."]))))]});function Yse(e,t){if(1&e&&(wm(),db(0,"circle",11)),2&e){var n=Cb().$implicit,r=Cb();cb("ngClass",r.getPieceClass(n)),nb("cx",r.getCenterAt(n).x)("cy",r.getCenterAt(n).y)("r",r.SPACE_SIZE)}}function Kse(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"g",8),kb("click",function(){var e=Wy(n).$implicit;return Cb().onClick(e)}),db(2,"polyline",9),ob(3,Yse,1,4,"circle",10),fb(),fb()}if(2&e){var r=t.$implicit,i=Cb();Ow(1),Eb("id","click_",r.x,"_",r.y,""),Ow(1),Eb("id","case_",r.x,"_",r.y,""),cb("ngClass",i.getSpaceClass(r)),nb("points",i.getHexaCoordsAt(r)),Ow(1),cb("ngIf",i.isPiece(r))}}function Jse(e,t){if(1&e){var n=gb();wm(),hb(0,"polyline",14),kb("click",function(){var e=Wy(n).$implicit;return Cb(2).onClick(e)}),fb()}if(2&e){var r=t.$implicit;nb("points",Cb(2).getHexaCoordsAt(r))}}function Qse(e,t){if(1&e&&(wm(),hb(0,"g",12),ob(1,Jse,1,1,"polyline",13),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n.capturedSpaces)}}function Xse(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"line",15),kb("click",function(){var e=Wy(n).$implicit;return Cb().onClick(e.destination)}),fb(),fb()}if(2&e){var r=t.$implicit;Ow(1),nb("x1",r.x1)("y1",r.y1)("x2",r.x2)("y2",r.y2)}}function eue(e,t){if(1&e&&(wm(),hb(0,"g"),db(1,"circle",16),fb()),2&e){var n=t.$implicit,r=Cb().$implicit,i=Cb();Ow(1),Eb("id","piece_",r,"_",n,""),cb("ngClass",i.getSidePieceClass(r)),nb("cx",10+n*i.SPACE_SIZE*.5)("cy",10+(i.SPACE_SIZE+10)*r)("r",.5*i.SPACE_SIZE)}}function tue(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,eue,2,6,"g",5),fb()),2&e){var n=t.$implicit,r=Cb();Ow(1),cb("ngForOf",r.getPlayerSidePieces(n))}}function nue(e,t){if(1&e&&(wm(),db(0,"line",17)),2&e){var n=Cb();nb("x1",n.inserted.get().x1)("y1",n.inserted.get().y1)("x2",n.inserted.get().x2)("y2",n.inserted.get().y2)}}var rue=function(){return[0,1]},iue=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).inserted=cB.empty(),r.arrows=[],r.captured=[],r.moved=[],r.movePhase=n.PHASE_PLACEMENT_COORD,r.possibleCaptures=[],r.initialCaptures=[],r.placement=cB.empty(),r.placementEntrance=cB.empty(),r.finalCaptures=[],r.scores=cB.of([0,0]),r.rules=new zse(Vse),r.availableMinimaxes=[new Hse(r.rules,"GipfMinimax")],r.encoder=Bse.encoder,r.tutorial=(new Zse).tutorial,r.SPACE_SIZE=40,r.constructedState=r.rules.node.gameState,r.hexaLayout=new ire(1.5*r.SPACE_SIZE,new Jne(2*r.SPACE_SIZE,0),sre.INSTANCE),r}return ip(n,[{key:"updateBoard",value:function(){this.showLastMove(),this.cancelMoveAttempt(),this.moveToInitialCaptureOrPlacementPhase()}},{key:"showLastMove",value:function(){this.inserted=cB.empty();var e=this.rules.node.move;if(e.isPresent()&&e.get().placement.direction.isPresent()){var t=e.get().placement;this.inserted=cB.of(this.arrowTowards(t.coord,t.direction.get()))}this.cancelMoveAttempt()}},{key:"arrowTowards",value:function(e,t){var n=e.getNext(t.getOpposite()),r=this.getCenterAt(e),i=this.getCenterAt(n);return new Gse(n,e,i.x,i.y,r.x,r.y)}},{key:"markCapture",value:function(e){var t=this;e.forEach(function(e){t.captured.push(e)})}},{key:"getAllCoords",value:function(){return this.constructedState.allCoords()}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.constructedState.getNumberOfPiecesToPlace(Zee.of(e)),n=[],r=0;r<t;r+=1)n.push(r);return n}},{key:"isPiece",value:function(e){return this.getPiece(e)!==nre.EMPTY}},{key:"getPiece",value:function(e){return this.constructedState.getPieceAt(e)}},{key:"onClick",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){r.next=3;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 3:r.t0=t.movePhase,r.next=r.t0===n.PHASE_INITIAL_CAPTURE||r.t0===n.PHASE_FINAL_CAPTURE?6:r.t0===n.PHASE_PLACEMENT_COORD?7:8;break;case 6:return r.abrupt("return",t.selectCapture(e));case 7:return r.abrupt("return",t.selectPlacementCoord(e));case 8:if(iB.expectToBe(t.movePhase,n.PHASE_PLACEMENT_DIRECTION),!1!==(a=t.placementEntrance.get()).isAlignedWith(e)){r.next=12;break}return r.abrupt("return",t.cancelMove(Use.INVALID_PLACEMENT_DIRECTION()));case 12:if(1===a.getDistance(e)){r.next=14;break}return r.abrupt("return",t.cancelMove(Use.CLICK_FURTHER_THAN_ONE_COORD()));case 14:return o=rre.factory.fromMove(a,e),r.abrupt("return",t.selectPlacementDirection(o.toOptional()));case 16:case"end":return r.stop()}},r)}))()}},{key:"selectCapture",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&i.push(t)}),!(i.length>1)){r.next=3;break}return r.abrupt("return",t.cancelMove(Use.AMBIGUOUS_CAPTURE_COORD()));case 3:if(0!==i.length){r.next=5;break}return r.abrupt("return",t.cancelMove(Use.MISSING_CAPTURES()));case 5:a=i[0],r.t0=(t.constructedState=zse.applyCapture(t.constructedState,a),t.markCapture(a),t.possibleCaptures=zse.getPossibleCaptures(t.constructedState),t.movePhase),r.next=r.t0===n.PHASE_INITIAL_CAPTURE?9:10;break;case 9:return r.abrupt("return",(t.initialCaptures.push(a),0===t.possibleCaptures.length?t.moveToPlacementPhase():$5.SUCCESS));case 10:return r.abrupt("return",(iB.expectToBe(t.movePhase,n.PHASE_FINAL_CAPTURE),t.finalCaptures.push(a),0===t.possibleCaptures.length?t.tryMove(t.initialCaptures,t.placement.get(),t.finalCaptures):$5.SUCCESS));case 11:case"end":return r.stop()}},r)}))()}},{key:"moveToPlacementPhase",value:function(){return this.movePhase=n.PHASE_PLACEMENT_COORD,$5.SUCCESS}},{key:"moveToInitialCaptureOrPlacementPhase",value:function(){return this.possibleCaptures=zse.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?n.PHASE_PLACEMENT_COORD:n.PHASE_INITIAL_CAPTURE,$5.SUCCESS}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=zse.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove(e.initialCaptures,e.placement.get(),e.finalCaptures):(e.movePhase=n.PHASE_FINAL_CAPTURE,$5.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}},{key:"computeArrows",value:function(e){this.arrows=[];var t,n=Xv(zse.getAllDirectionsForEntrance(this.constructedState,e));try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===zse.isLineComplete(this.constructedState,e,r)){var i=e.getNext(r),a=this.getCenterAt(e),o=this.getCenterAt(i);this.arrows.push(new Gse(e,i,a.x,a.y,o.x,o.y))}}}catch(s){n.e(s)}finally{n.f()}}},{key:"selectPlacementCoord",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=t.rules.placementCoordValidity(t.constructedState,e),r.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):(t.placementEntrance=cB.of(e),t.constructedState.getPieceAt(e)===nre.EMPTY?t.selectPlacementDirection(cB.empty()):(t.movePhase=n.PHASE_PLACEMENT_DIRECTION,t.computeArrows(e),0===t.arrows.length&&t.cancelMove(Use.NO_DIRECTIONS_AVAILABLE()),$5.SUCCESS)));case 2:case"end":return r.stop()}},r)}))()}},{key:"selectPlacementDirection",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.placement=cB.of(new Fse(t.placementEntrance.get(),e)),r=t.rules.placementValidity(t.constructedState,t.placement.get()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.arrows=[],t.constructedState=zse.applyPlacement(t.constructedState,t.placement.get()),t.moveToFinalCapturePhaseOrTryMove()));case 3:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t,n){var r=this;return rB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=new Bse(t,e,n),i.next=3,r.chooseMove(a,r.rules.node.gameState,r.scores.get());case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"cancelMoveAttempt",value:function(){var e=this;this.constructedState=this.rules.node.gameState,this.captured=[],this.moved=[];var t=this.rules.node.move;if(t.isPresent()){var n=t.get(),r=this.rules.node.mother.get().gameState;n.initialCaptures.forEach(function(t){return e.markCapture(t)}),n.finalCaptures.forEach(function(t){return e.markCapture(t)}),this.moved=this.rules.getPiecesMoved(r,n.initialCaptures,n.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=cB.empty(),this.placement=cB.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}},{key:"getSpaceClass",value:function(e){return this.captured.some(function(t){return t.equals(e)})?"captured":this.moved.some(function(t){return t.equals(e)})?"moved":""}},{key:"getPieceClass",value:function(e){var t=this.getPiece(e);return this.getPlayerClass(Zee.of(t.value))}},{key:"getSidePieceClass",value:function(e){return this.getPlayerClass(Zee.of(e))}}]),n}(tre);return e.PHASE_INITIAL_CAPTURE=0,e.PHASE_PLACEMENT_COORD=1,e.PHASE_PLACEMENT_DIRECTION=2,e.PHASE_FINAL_CAPTURE=3,e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-gipf"]],features:[HC],decls:11,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -12 708 854","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved","moved-stroke"],[4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),hb(1,"defs"),hb(2,"marker",1),db(3,"polygon",2),fb(),hb(4,"marker",3),db(5,"polygon",4),fb(),fb(),ob(6,Kse,4,7,"g",5),ob(7,Qse,2,1,"g",6),ob(8,Xse,2,4,"g",5),ob(9,tue,2,1,"g",5),ob(10,nue,1,4,"line",7),fb()),2&e&&(Ow(6),cb("ngForOf",t.getAllCoords()),Ow(1),cb("ngForOf",t.possibleCaptures),Ow(1),cb("ngForOf",t.arrows),Ow(1),cb("ngForOf",tP(5,rue)),Ow(1),cb("ngIf",t.inserted.isPresent()))},directives:[NT,DT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),aue=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"equals",value:function(e){return this===e||this.coord.equals(e.coord)}},{key:"toString",value:function(){return this===n.PASS?"GoMove.PASS":this===n.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(yre);aue.PASS=new aue(-1,0),aue.ACCEPT=new aue(-2,0),aue.PASS_NUMBER=-1,aue.ACCEPT_NUMBER=-2,aue.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"maxValue",value:function(){return 360}},{key:"encodeNumber",value:function(e){return 19*e.coord.y+e.coord.x}},{key:"decodeNumber",value:function(e){if(e===aue.PASS_NUMBER)return aue.PASS;var t=e%19;return new aue(t,(e-t)/19)}}]),n}(jee));var oue=function(){function e(t,n){np(this,e),this.player=t,this.type=n}return ip(e,[{key:"equals",value:function(e){return e===this}},{key:"toString",value:function(){switch(this){case e.BLACK:return"GoPiece.BLACK";case e.WHITE:return"GoPiece.WHITE";case e.EMPTY:return"GoPiece.EMPTY";case e.DEAD_BLACK:return"GoPiece.DEAD_BLACK";case e.DEAD_WHITE:return"GoPiece.DEAD_WHITE";case e.BLACK_TERRITORY:return"GoPiece.BLACK_TERRITORY";default:return Z5(this===e.WHITE_TERRITORY,"Unexisting GoPiece"),"GoPiece.WHITE_TERRITORY"}}},{key:"isOccupied",value:function(){return[e.BLACK,e.WHITE,e.DEAD_BLACK,e.DEAD_WHITE].includes(this)}},{key:"isEmpty",value:function(){return[e.BLACK_TERRITORY,e.WHITE_TERRITORY,e.EMPTY].includes(this)}},{key:"isDead",value:function(){return[e.DEAD_BLACK,e.DEAD_WHITE].includes(this)}},{key:"isTerritory",value:function(){return[e.BLACK_TERRITORY,e.WHITE_TERRITORY].includes(this)}},{key:"getOwner",value:function(){return this.player}},{key:"nonTerritory",value:function(){return Z5(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),e.EMPTY}}],[{key:"pieceBelongTo",value:function(e,t){return Z5(t!==Zee.NONE,"Owner must be Player.ZERO or Player.ONE, got Player.NONE."),t===e.player&&"territory"!==e.type}},{key:"ofPlayer",value:function(t){if(t===Zee.ZERO)return e.BLACK;if(t===Zee.ONE)return e.WHITE;throw new Error("GoPiece.ofPlayer should only be called with Player.ZERO and Player.ONE.")}}]),e}();oue.BLACK=new oue(Zee.ZERO,"alive"),oue.WHITE=new oue(Zee.ONE,"alive"),oue.EMPTY=new oue(Zee.NONE,"empty"),oue.DEAD_BLACK=new oue(Zee.ZERO,"dead"),oue.DEAD_WHITE=new oue(Zee.ONE,"dead"),oue.BLACK_TERRITORY=new oue(Zee.NONE,"territory"),oue.WHITE_TERRITORY=new oue(Zee.NONE,"territory");var sue=(function(e){e.PLAYING="PLAYING",e.PASSED="PASSED",e.COUNTING="COUNTING",e.ACCEPT="ACCEPT",e.FINISHED="FINISHED"}(sue||(sue={})),sue),uue=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o){var s;return np(this,n),(s=t.call(this,e,i)).captured=r,s.koCoord=a,s.phase=o,s}return ip(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}},{key:"copy",value:function(){return new n(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}},{key:"isDead",value:function(e){return this.getPieceAt(e).isDead()}},{key:"isTerritory",value:function(e){return this.getPieceAt(e).isTerritory()}}],[{key:"getInitialState",value:function(){var e=n.getStartingBoard();return new n(e,[0,0],0,cB.empty(),sue.PLAYING)}},{key:"getStartingBoard",value:function(){return Q5.createTable(n.WIDTH,n.HEIGHT,oue.EMPTY)}}]),n}(vre);return e.WIDTH=13,e.HEIGHT=13,e}(),cue=function(){var e=function(){function e(t){np(this,e),this.color=t}return ip(e,[{key:"selfContains",value:function(e){return this.getCoords().some(function(t){return t.equals(e)})}}],[{key:"insertAsEntryPoint",value:function(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}]),e}();return e.VERBOSE=!1,e}(),lue=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o,s){var u;return np(this,n),(u=t.call(this,e)).emptyCoords=r,u.blackCoords=i,u.whiteCoords=a,u.deadBlackCoords=o,u.deadWhiteCoords=s,u}return ip(n,[{key:"getCoords",value:function(){return this.color===oue.BLACK?this.blackCoords:this.color===oue.WHITE?this.whiteCoords:this.color===oue.DEAD_BLACK?this.deadBlackCoords:this.color===oue.DEAD_WHITE?this.deadWhiteCoords:this.emptyCoords}},{key:"contains",value:function(e){return this.blackCoords.concat(this.whiteCoords.concat(this.emptyCoords.concat(this.deadBlackCoords.concat(this.deadWhiteCoords)))).some(function(t){return t.equals(e)})}},{key:"addPawn",value:function(e,t){if(this.contains(e))throw new Error("This group already contains "+e);switch(t){case oue.BLACK:this.blackCoords=cue.insertAsEntryPoint(this.blackCoords,e);break;case oue.WHITE:this.whiteCoords=cue.insertAsEntryPoint(this.whiteCoords,e);break;case oue.DEAD_BLACK:this.deadBlackCoords=cue.insertAsEntryPoint(this.deadBlackCoords,e);break;case oue.DEAD_WHITE:this.deadWhiteCoords=cue.insertAsEntryPoint(this.deadWhiteCoords,e);break;default:iB.expectToBeMultiple(t,[oue.EMPTY,oue.BLACK_TERRITORY,oue.WHITE_TERRITORY]),this.emptyCoords=cue.insertAsEntryPoint(this.emptyCoords,e)}}},{key:"isMonoWrapped",value:function(){return(0===this.emptyCoords.length?1:2)*(this.blackCoords.length+this.deadWhiteCoords.length===0?1:2)*(this.whiteCoords.length+this.deadBlackCoords.length===0?1:2)==4}},{key:"getWrapper",value:function(){var e=new _re;e.set(oue.EMPTY,this.emptyCoords.length),e.set(oue.BLACK,this.blackCoords.length+this.deadWhiteCoords.length),e.set(oue.WHITE,this.whiteCoords.length+this.deadBlackCoords.length),e.put(this.color.nonTerritory(),0);var t=e.filter(function(e,t){return t>0});if(1===t.size())return t.getByIndex(0).key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}},{key:"getNeighboorsEntryPoint",value:function(){var e=[];return this.color!==oue.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==oue.BLACK&&this.blackCoords.length>0&&e.push(this.blackCoords[0]),this.color!==oue.WHITE&&this.whiteCoords.length>0&&e.push(this.whiteCoords[0]),this.color!==oue.DEAD_BLACK&&this.deadBlackCoords.length>0&&e.push(this.deadBlackCoords[0]),this.color!==oue.DEAD_WHITE&&this.deadWhiteCoords.length>0&&e.push(this.deadWhiteCoords[0]),e}}]),n}(cue),hue=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getNewInstance",value:function(e){return new lue(e,[],[],[],[],[])}},{key:"getDirections",value:function(){return Kne.ORTHOGONALS}}]),n}(function(){function e(){np(this,e)}return ip(e,[{key:"getGroupDatas",value:function(e,t){aB(cue.VERBOSE,"GroupDatas.getGroupDatas("+e+", "+t+")");var n=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,n)}},{key:"_getGroupDatas",value:function(e,t,n){aB(cue.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:n,coord:e}});var r=t[e.y][e.x];if(n.addPawn(e,r),r===n.color){var i,a=Xv(this.getDirections());try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e.getNext(o);s.isInRange(t[0].length,t.length)&&(n.contains(s)||(n=this._getGroupDatas(s,t,n)))}}catch(u){a.e(u)}finally{a.f()}}return n}}]),e}()),fue=function(){var e=ip(function e(){np(this,e)});return e.ILLEGAL_KO=function(){return $localize(Ii||(Ii=Nv(["This move is a ko, you must play somewhere else before you can play in this intersection again."])))},e.CANNOT_PASS_AFTER_PASSED_PHASE=function(){return $localize(xi||(xi=Nv(["We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn."])))},e.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=function(){return $localize(Ai||(Ai=Nv(["You cannot accept before the counting phase."])))},e.OCCUPIED_INTERSECTION=function(){return $localize(Ri||(Ri=Nv(["This intersection is already occupied."])))},e.CANNOT_COMMIT_SUICIDE=function(){return $localize(Ni||(Ni=Nv(["You cannot commit suicide."])))},e}(),due=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,r){return aB(n.VERBOSE,{applyLegalMove:{legalMove:e,state:t,status:r}}),n.isPass(e)?(aB(n.VERBOSE,"GoRules.applyLegalMove: isPass"),n.applyPass(t)):n.isAccept(e)?(aB(n.VERBOSE,"GoRules.applyLegalMove: isAccept"),n.applyLegalAccept(t)):n.isLegalDeadMarking(e,t)?(aB(n.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),n.applyDeadMarkingMove(e,t)):(aB(n.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),n.applyNormalLegalMove(t,e,r))}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=!1;if(aB(n.VERBOSE||r,{isLegal:{move:e,state:t}}),n.isPass(e)){var i=t.phase===sue.PLAYING,a=t.phase===sue.PASSED;return aB(n.VERBOSE||r,"GoRules.isLegal at "+t.phase+(i||a?" forbid":" allowed")+" passing on "+t.getCopiedBoard()),i||a?H5.success([]):H5.failure(fue.CANNOT_PASS_AFTER_PASSED_PHASE())}if(n.isAccept(e)){var o=t.phase===sue.ACCEPT;return t.phase===sue.COUNTING||o?H5.success([]):H5.failure(fue.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return n.isOccupied(e.coord,t.getCopiedBoard())?(aB(n.VERBOSE||r,"GoRules.isLegal: move is marking"),n.isLegalDeadMarking(e,t)?H5.success([]):H5.failure(fue.OCCUPIED_INTERSECTION())):(aB(n.VERBOSE||r,"GoRules.isLegal: move is normal stuff: "+e.toString()),n.isLegalNormalMove(e,t))}},{key:"getNewKo",value:function(e,t,n){if(1===n.length){var r=n[0],i=e.coord,a=t[i.y][i.x],o=(new hue).getGroupDatas(i,t),s=o.emptyCoords,u=oue.pieceBelongTo(a,Zee.ZERO)?o.blackCoords:o.whiteCoords;if(1===s.length&&s[0].equals(r)&&1===u.length)return cB.of(r)}return cB.empty()}},{key:"markTerritoryAndCount",value:function(e){aB(n.VERBOSE,{markTerritoryAndCount:{state:e}});var t,r=e.getCopiedBoard(),i=n.getTerritoryLikeGroup(e),a=e.getCapturedCopy(),o=Xv(i);try{for(o.s();!(t=o.n()).done;){var s=t.value,u=s.getWrapper();if(u===oue.WHITE){a[1]+=s.emptyCoords.length;var c,l=Xv(s.getCoords());try{for(l.s();!(c=l.n()).done;){var h=c.value;r[h.y][h.x]=oue.WHITE_TERRITORY}}catch(p){l.e(p)}finally{l.f()}}else{Z5(u===oue.BLACK,"territory should be wrapped by black or white, not by "+u.toString()),a[0]+=s.emptyCoords.length;var f,d=Xv(s.getCoords());try{for(d.s();!(f=d.n()).done;){var v=f.value;r[v.y][v.x]=oue.BLACK_TERRITORY}}catch(p){d.e(p)}finally{d.f()}}}}catch(p){o.e(p)}finally{o.f()}return new uue(r,a,e.turn,e.koCoord,e.phase)}},{key:"removeAndSubstractTerritory",value:function(e){for(var t,n=e.getCopiedBoard(),r=e.getCapturedCopy(),i=0;i<e.board.length;i++)for(var a=0;a<e.board[0].length;a++)(t=n[i][a])===oue.BLACK_TERRITORY?(n[i][a]=oue.EMPTY,r[0]=r[0]-1):t===oue.WHITE_TERRITORY&&(n[i][a]=oue.EMPTY,r[1]=r[1]-1);return new uue(n,r,e.turn,e.koCoord,e.phase)}},{key:"getEmptyZones",value:function(e){return n.getGroupsDatasWhere(e.getCopiedBoard(),function(e){return e.isEmpty()})}},{key:"getGroupsDatasWhere",value:function(e,t){for(var n,r,i=[],a=new hue,o=0;o<e.length;o++)for(var s=0;s<e[0].length;s++)n=new Jne(s,o),t(e[o][s])&&(i.some(function(e){return e.selfContains(n)})||(r=a.getGroupDatas(n,e),i.push(r)));return i}},{key:"addDeadToScore",value:function(e){for(var t,n=e.getCapturedCopy(),r=n[1],i=n[0],a=0;a<e.board.length;a++)for(var o=0;o<e.board[0].length;o++)(t=e.getPieceAtXY(o,a))===oue.DEAD_BLACK?r++:t===oue.DEAD_WHITE&&i++;return[i,r]}},{key:"switchAliveness",value:function(e,t){var n=t.getCopiedBoard();Z5(!1===n[e.y][e.x].isEmpty(),"Can't switch emptyness aliveness");var r=(new hue).getGroupDatas(e,n),i=t.getCapturedCopy();switch(r.color){case oue.DEAD_BLACK:i[1]-=2*r.deadBlackCoords.length;var a,o=Xv(r.deadBlackCoords);try{for(o.s();!(a=o.n()).done;){var s=a.value;n[s.y][s.x]=oue.BLACK}}catch(y){o.e(y)}finally{o.f()}break;case oue.DEAD_WHITE:i[0]-=2*r.deadWhiteCoords.length;var u,c=Xv(r.deadWhiteCoords);try{for(c.s();!(u=c.n()).done;){var l=u.value;n[l.y][l.x]=oue.WHITE}}catch(y){c.e(y)}finally{c.f()}break;case oue.WHITE:i[0]+=2*r.whiteCoords.length;var h,f=Xv(r.whiteCoords);try{for(f.s();!(h=f.n()).done;){var d=h.value;n[d.y][d.x]=oue.DEAD_WHITE}}catch(y){f.e(y)}finally{f.f()}break;default:iB.expectToBe(r.color,oue.BLACK),i[1]+=2*r.blackCoords.length;var v,p=Xv(r.blackCoords);try{for(p.s();!(v=p.n()).done;){var g=v.value;n[g.y][g.x]=oue.DEAD_BLACK}}catch(y){p.e(y)}finally{p.f()}}return new uue(n,i,t.turn,t.koCoord,t.phase)}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.phase===sue.FINISHED?t.captured[0]>t.captured[1]?Ere.ZERO_WON:t.captured[1]>t.captured[0]?Ere.ONE_WON:Ere.DRAW:Ere.ONGOING}},{key:"isPass",value:function(e){return e.equals(aue.PASS)}},{key:"isAccept",value:function(e){return e.equals(aue.ACCEPT)}},{key:"isLegalDeadMarking",value:function(e,t){return n.isOccupied(e.coord,t.getCopiedBoard())&&(t.phase===sue.COUNTING||t.phase===sue.ACCEPT)}},{key:"isLegalNormalMove",value:function(e,t){var r=t.getCopiedBoard();if(n.isKo(e,t))return H5.failure(fue.ILLEGAL_KO());[sue.COUNTING,sue.ACCEPT].includes(t.phase)&&(t=n.resurrectStones(t));var i=n.getCaptureState(e,t);if(vue.isCapturing(i))return H5.success(i.capturedCoords);r[e.coord.y][e.coord.x]=t.turn%2==0?oue.BLACK:oue.WHITE;var a=0===(new hue).getGroupDatas(e.coord,r).emptyCoords.length;return r[e.coord.y][e.coord.x]=oue.EMPTY,a?H5.failure(fue.CANNOT_COMMIT_SUICIDE()):H5.success([])}},{key:"isOccupied",value:function(e,t){return t[e.y][e.x].isOccupied()}},{key:"isKo",value:function(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}},{key:"getCaptureState",value:function(e,t){aB(n.VERBOSE||!1,{getCaptureState:{move:e,state:t}});var r,i,a=new vue,o=Xv(Kne.ORTHOGONALS);try{for(o.s();!(i=o.n()).done;){var s=i.value;(r=n.getCapturedInDirection(e.coord,s,t)).length>0&&a.capturedCoords.every(function(e){return!r[0].equals(e)})&&(a.capturedCoords=a.capturedCoords.concat(r))}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getCapturedInDirection",value:function(e,t,r){var i=r.getCopiedBoard(),a=e.getNext(t);if(a.isInRange(r.board[0].length,r.board.length)&&i[a.y][a.x]===(r.turn%2==0?oue.WHITE:oue.BLACK)){aB(n.VERBOSE||!1,"a group could be captured");var o=(new hue).getGroupDatas(a,i);if(n.isCapturableGroup(o,r.koCoord))return aB(n.VERBOSE||!1,{neightbooringGroupCoord:o.getCoords(),message:"is capturable"}),o.getCoords()}return[]}},{key:"isCapturableGroup",value:function(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}},{key:"getTerritoryLikeGroup",value:function(e){return n.getEmptyZones(e).filter(function(e){return e.isMonoWrapped()})}},{key:"applyPass",value:function(e){var t,r,i=e.getCopiedBoard(),a=e.getCapturedCopy(),o=e.turn;return e.phase===sue.PASSED?(t=sue.COUNTING,r=new uue(i,a,o+1,cB.empty(),t),r=n.markTerritoryAndCount(r)):(Z5(e.phase===sue.PLAYING,"Cannot pass in counting phase!"),t=sue.PASSED,r=new uue(i,a,o+1,cB.empty(),t)),r}},{key:"applyLegalAccept",value:function(e){var t,n=e.getCopiedBoard();return t=e.phase===sue.COUNTING?sue.ACCEPT:sue.FINISHED,new uue(n,e.getCapturedCopy(),e.turn+1,cB.empty(),t)}},{key:"applyNormalLegalMove",value:function(e,t,r){var i;aB(n.VERBOSE,{applyNormalLegal:{currentState:e,legalMove:t,status:status}}),i=[sue.COUNTING,sue.ACCEPT].includes(e.phase)?n.resurrectStones(e):e.copy();var a=t.coord.x,o=t.coord.y,s=i.getCopiedBoard(),u=i.turn,c=oue.ofPlayer(i.getCurrentPlayer()),l=u+1;s[o][a]=c;var h,f=Xv(r);try{for(f.s();!(h=f.n()).done;){var d=h.value;s[d.y][d.x]=oue.EMPTY}}catch(g){f.e(g)}finally{f.f()}var v=n.getNewKo(t,s,r),p=i.getCapturedCopy();return p[c.player.value]+=r.length,new uue(s,p,l,v,sue.PLAYING)}},{key:"resurrectStones",value:function(e){for(var t=0;t<e.board.length;t++)for(var r=0;r<e.board[0].length;r++)e.getPieceAtXY(r,t).isDead()&&(e=n.switchAliveness(new Jne(r,t),e));return n.removeAndSubstractTerritory(e)}},{key:"applyDeadMarkingMove",value:function(e,t){aB(n.VERBOSE,{applyDeadMarkingMove:{legalMove:e,state:t}});var r=n.removeAndSubstractTerritory(t),i=n.switchAliveness(e.coord,r),a=new uue(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,cB.empty(),sue.COUNTING);return n.markTerritoryAndCount(a)}}]),n}(Sre);return e.VERBOSE=!1,e}(),vue=function(){function e(){np(this,e),this.capturedCoords=[]}return ip(e,null,[{key:"isCapturing",value:function(e){return e.capturedCoords.length>0}}]),e}(),pue=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){aB(due.VERBOSE||!1,"GoRules.getListMoves");var t=e.gameState,n=this.getPlayingMovesList(t);if(t.phase===sue.PLAYING||t.phase===sue.PASSED)return n.push(aue.PASS),n;aB(due.VERBOSE||!1,"GoRules.getListMoves in counting phase");var r=this.getCountingMovesList(t);return 0===r.length?[aue.ACCEPT]:r}},{key:"getPlayingMovesList",value:function(e){for(var t,n=[],r=0;r<e.board.length;r++)for(var i=0;i<e.board[0].length;i++)t=new aue(i,r),e.getPieceAt(t.coord)===oue.EMPTY&&due.isLegal(t,e).isSuccess()&&n.push(t);return n}},{key:"getCountingMovesList",value:function(e){var t,n=[],r=this.getCorrectBoard(e).getCopiedBoard(),i=Xv(due.getGroupsDatasWhere(r,function(e){return e!==oue.EMPTY}));try{for(i.s();!(t=i.n()).done;){var a=t.value.getCoords()[0],o=r[a.y][a.x];if(e.getPieceAt(a)!==o){var s=new aue(a.x,a.y);return n.push(s),n}}}catch(u){i.e(u)}finally{i.f()}return n}},{key:"getCorrectBoard",value:function(e){var t=this.mapBoard(e.getCopiedBoard(),function(e){return e===oue.BLACK?oue.DEAD_BLACK:e===oue.WHITE?oue.DEAD_WHITE:e.isTerritory()?oue.EMPTY:e}),n=new uue(t,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),r=due.getTerritoryLikeGroup(n);return this.setAliveUniqueWrapper(n,r)}},{key:"mapBoard",value:function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[0].length;r++)e[n][r]=t(e[n][r]);return e}},{key:"setAliveUniqueWrapper",value:function(e,t){var n,r=e.copy(),i=Xv(t);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=Xv(o.deadBlackCoords.concat(o.deadWhiteCoords));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.isDead(u)&&(r=due.switchAliveness(u,r))}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=due.getGameStatus(e);if(n.isEndGame)return new lre(n.toBoardValue());aB(due.VERBOSE||!1,"GoRules.getBoardValue");var r=due.markTerritoryAndCount(t),i=r.getCapturedCopy(),a=this.getDeadStones(r);return new lre(i[1]+2*a[0]-(i[0]+2*a[1]))}},{key:"getDeadStones",value:function(e){for(var t=[0,0],n=0;n<e.board.length;n++)for(var r=0;r<e.board[0].length;r++){var i=e.getPieceAtXY(r,n);"dead"===i.type&&(t[i.player.value]=t[i.player.value]+1)}return t}}]),n}(cre),gue=oue.WHITE,yue=oue.BLACK,mue=oue.DEAD_WHITE,kue=oue.WHITE_TERRITORY,_ue=oue.BLACK_TERRITORY,wue=oue.EMPTY,Cue=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(Mi||(Mi=Nv(["Preliminary information"]))),$localize(Di||(Di=Nv(["The game of Go is played on a board called a Goban, and the stones are placed on the intersections.\n        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.\n        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).\n        For this tutorial, we will use a smaller board for pedagogical purposes."]))),uue.getInitialState()),Ire.informational($localize(Li||(Li=Nv(["Goal of the game"]))),$localize(Fi||(Fi=Nv(["The goal of the game is to have the most points at the end of the game.\n        We call \"territories\" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.\n        Here, Dark has 9 territories on the left, and Light has 8 on the right.\n        The top part belongs to no one.\n        Each player's score at the end of the game is the sum of that player's territories and captures."]))),new uue([[wue,yue,wue,wue,gue,gue],[wue,yue,wue,wue,gue,wue],[wue,yue,yue,gue,gue,wue],[wue,wue,yue,gue,wue,wue],[wue,wue,yue,gue,wue,wue],[wue,wue,yue,gue,wue,wue]],[0,0],0,cB.empty(),sue.PLAYING)),Ire.fromMove($localize(Bi||(Bi=Nv(["Simple capture"]))),$localize(Vi||(Vi=Nv(["An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).\n        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.\n        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>\n        The light piece only has one liberty left, play there."]))),new uue([[wue,wue,wue,wue,wue],[wue,wue,yue,wue,wue],[wue,yue,gue,wue,wue],[wue,wue,yue,wue,wue],[wue,wue,wue,wue,wue]],[0,0],0,cB.empty(),sue.PLAYING),[new aue(3,2)],$localize(Ui||(Ui=Nv(["Congratulations, you have earned one point."]))),$localize(zi||(zi=Nv(["Failed, try again by playing on one of the intersections directly next to the light stone."])))),Ire.fromMove($localize(Hi||(Hi=Nv(["Capturing multiple stones"]))),$localize(Gi||(Gi=Nv(["Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>\n        The light group here only has one liberty left, capture it."]))),new uue([[wue,yue,wue,wue,wue],[yue,gue,wue,wue,wue],[yue,gue,gue,yue,wue],[wue,yue,yue,wue,wue],[wue,wue,wue,wue,wue]],[0,0],0,cB.empty(),sue.PLAYING),[new aue(2,1)],$localize(qi||(qi=Nv(["Congratulations, you have earned three points and formed a territory."]))),$localize($i||($i=Nv(["Failed, you have not captured the group. Play on the last liberty of that group."])))),Ire.informational($localize(Wi||(Wi=Nv(["Suicide"]))),$localize(ji||(ji=Nv(["In Go, suicide is forbidden.\n        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.\n        Here, the top left intersection is a suicide for Light.\n        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player."]))),new uue([[wue,yue,wue,wue,wue],[yue,wue,wue,wue,wue],[yue,wue,wue,wue,gue],[gue,yue,wue,gue,wue],[wue,gue,wue,gue,yue]],[0,0],0,cB.empty(),sue.PLAYING)),Ire.informational($localize(Zi||(Zi=Nv(["Life and death (death)"]))),$localize(Yi||(Yi=Nv(["From the capture rule follows the life and death notion:\n        dead stones are stones that are definitely capturable (without losing anything else).\n        Alive stones are stones that can never be captured.\n        From the capture rule, Dark can play inside Light's territory and make a capture.\n        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).\n        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories."]))),new uue([[wue,wue,wue,wue,wue],[yue,yue,yue,wue,wue],[gue,gue,yue,wue,wue],[wue,gue,yue,wue,wue],[gue,gue,yue,wue,wue]],[0,0],0,cB.empty(),sue.PLAYING)),Ire.informational($localize(Ki||(Ki=Nv(["Life and death (eyes)"]))),$localize(Ji||(Ji=Nv(["Here, Light cannot play on the top left, nor on the bottom left.\n        Light will never be able to capture Dark.\n        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive."]))),new uue([[wue,yue,gue,wue,wue],[gue,yue,gue,wue,wue],[yue,yue,gue,wue,wue],[gue,yue,gue,wue,wue],[wue,yue,gue,wue,wue]],[0,0],0,cB.empty(),sue.PLAYING)),Ire.informational($localize(Qi||(Qi=Nv(["Seki"]))),$localize(Xi||(Xi=Nv(["If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.\n        Similarly, if Light plays on the middle line, Dark will capture Light.\n        In other words, there is no point in playing on the middle line.\n        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral."]))),new uue([[wue,gue,yue,wue,gue,yue,wue],[wue,gue,yue,yue,gue,yue,wue],[wue,gue,yue,yue,gue,yue,wue],[wue,gue,yue,yue,gue,yue,wue],[wue,gue,yue,gue,gue,yue,wue],[wue,gue,yue,gue,gue,yue,wue],[wue,gue,yue,wue,gue,yue,wue]],[0,0],0,cB.empty(),sue.PLAYING)),Ire.fromMove($localize(ea||(ea=Nv(["Ko"]))),$localize(ta||(ta=Nv(["A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>\n        Capture the light stone."]))),new uue([[wue,wue,wue,wue,wue,wue,wue],[wue,wue,wue,wue,wue,wue,wue],[wue,wue,wue,yue,gue,wue,wue],[wue,wue,yue,gue,wue,gue,wue],[wue,wue,wue,yue,gue,wue,wue],[wue,wue,wue,wue,wue,wue,wue],[wue,wue,wue,wue,wue,wue,wue]],[0,0],0,cB.empty(),sue.PLAYING),[new aue(4,3)],$localize(na||(na=Nv(["Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.\n        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.\n        This rule is called the Ko.\n        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after."]))),$localize(ra||(ra=Nv(["Failed!"])))),Ire.fromMove($localize(ia||(ia=Nv(["End of the game"]))),$localize(aa||(aa=Nv(["When a player feels that there is no advantage to putting a new stone, that player can pass a turn.\n        The game phase stops when both players pass consecutively, and we move on to the counting phase.\n        The dead groups are then marked by clicking on them.\n        Every intersection in a player's territory earns that player a point.\n        The winner is the one with most points.<br/><br/>\n        A last stone is dead, mark it."]))),new uue([[gue,yue,yue,yue,yue,yue,_ue,_ue,_ue],[gue,gue,gue,gue,yue,yue,yue,_ue,_ue],[gue,kue,gue,gue,yue,mue,mue,yue,_ue],[yue,gue,gue,gue,gue,yue,_ue,_ue,_ue],[wue,gue,kue,gue,yue,yue,mue,yue,_ue],[gue,kue,gue,gue,yue,yue,yue,yue,yue],[gue,gue,yue,yue,yue,gue,gue,yue,gue],[yue,yue,yue,gue,gue,gue,kue,gue,gue],[_ue,_ue,yue,yue,yue,gue,gue,kue,kue]],[0,0],0,cB.empty(),sue.COUNTING),[new aue(0,3)],$localize(oa||(oa=Nv(["Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.\n        The intersections where the prisoners are count as Dark's territory\n        Light has 8 territories and 1 prisoner.\n        The end result is therefore 18 - 9 for Dark."]))),$localize(sa||(sa=Nv(["Failed, try again."]))))]});function bue(e,t){if(1&e&&(wm(),db(0,"circle",10)),2&e){var n=Cb(2).index,r=Cb().index;nb("cx",25+50*n)("cy",25+50*r)("r",22)}}function Eue(e,t){if(1&e){var n=gb();wm(),hb(0,"line",11),kb("click",function(){Wy(n);var e=Cb(2).index,t=Cb().index;return Cb().onClick(e,t)}),fb()}if(2&e){var r=Cb(2).index,i=Cb().index;nb("x1",50*r)("y1",50*i)("x2",50+50*r)("y2",50+50*i)}}function Sue(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"circle",7),kb("click",function(){Wy(n);var e=Cb().index,t=Cb().index;return Cb().onClick(e,t)}),fb(),ob(2,bue,1,3,"circle",8),ob(3,Eue,1,4,"line",9),fb()}if(2&e){var r=Cb().index,i=Cb().index,a=Cb();Ow(1),cb("ngClass",a.getSpaceClass(r,i)),nb("cx",25+50*r)("cy",25+50*i)("r",22),Ow(1),cb("ngIf",a.isLastCase(r,i)),Ow(1),cb("ngIf",a.isDead(r,i))}}function Pue(e,t){if(1&e){var n=gb();wm(),hb(0,"circle",15),kb("click",function(){Wy(n);var e=Cb(2).index,t=Cb().index;return Cb().onClick(e,t)}),fb()}if(2&e){var r=Cb(2),i=r.index,a=r.$implicit,o=Cb().index,s=Cb();nb("cx",25+50*i)("cy",25+50*o)("r",10)("class",a===s.GoPiece.WHITE_TERRITORY?"player1":"player0")}}function Oue(e,t){if(1&e){var n=gb();wm(),hb(0,"rect",12),kb("click",function(){Wy(n);var e=Cb().index,t=Cb().index;return Cb().onClick(e,t)}),fb(),hb(1,"line",13),kb("click",function(){Wy(n);var e=Cb().index,t=Cb().index;return Cb().onClick(e,t)}),fb(),hb(2,"line",13),kb("click",function(){Wy(n);var e=Cb().index,t=Cb().index;return Cb().onClick(e,t)}),fb(),ob(3,Pue,1,4,"circle",14)}if(2&e){var r=Cb().index,i=Cb().index,a=Cb();Eb("id","click_",r,"_",i,""),nb("x",50*r)("y",50*i),Ow(1),nb("x1",50*r)("y1",25+50*i)("x2",50+50*r)("y2",25+50*i),Ow(1),nb("x1",25+50*r)("y1",50*i)("x2",25+50*r)("y2",50+50*i),Ow(1),cb("ngIf",a.isTerritory(r,i))}}function Tue(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,Sue,4,6,"g",5),ob(2,Oue,4,13,"ng-template",null,6,IP),fb()),2&e){var n=t.index,r=sb(3),i=Cb().index,a=Cb();Ow(1),cb("ngIf",a.caseIsFull(n,i))("ngIfElse",r)}}function Iue(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,Tue,4,2,"g",2),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}function xue(e,t){if(1&e&&(wm(),db(0,"rect",16)),2&e){var n=Cb();nb("x",12.5+50*n.ko.get().x)("y",12.5+50*n.ko.get().y)}}function Aue(e,t){if(1&e){var n=gb();wm(),hb(0,"circle",17),kb("click",function(){var e=Wy(n).$implicit;return Cb().onClick(e.x,e.y)}),fb()}if(2&e){var r=t.$implicit;nb("cx",25+50*r.x)("cy",25+50*r.y)("r",7)}}var Rue=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).ko=cB.empty(),r.last=cB.empty(),r.captures=[],r.GoPiece=oue,r.scores=cB.of([0,0]),r.rules=new due(uue),r.availableMinimaxes=[new pue(r.rules,"GoMinimax")],r.encoder=aue.encoder,r.tutorial=(new Cue).tutorial,r.canPass=!0,r.updateBoard(),r}return ip(n,[{key:"onClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return n.last=cB.empty(),a=new aue(e,t),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState,n.scores.get()));case 6:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){aB(n.VERBOSE,"updateBoard");var e=this.rules.node.gameState,t=this.rules.node.move,r=e.phase;this.board=e.getCopiedBoard(),this.scores=cB.of(e.getCapturedCopy()),this.ko=e.koCoord,t.isPresent()?this.showCaptures():this.captures=[],this.last=t.map(function(e){return e.coord}),this.canPass=r!==sue.FINISHED}},{key:"showCaptures",value:function(){var e=this.rules.node.mother.get().gameState;this.captures=[];for(var t=0;t<this.board.length;t++)for(var n=0;n<this.board[0].length;n++){var r=new Jne(n,t),i=!1===e.getPieceAt(r).isEmpty(),a=this.board[t][n]===oue.EMPTY,o=!1===this.ko.equalsValue(r);i&&a&&o&&this.captures.push(r)}}},{key:"pass",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.rules.node.gameState.phase,t.abrupt("return",n===sue.PLAYING||n===sue.PASSED?e.onClick(aue.PASS.coord.x,aue.PASS.coord.y):(Z5(n===sue.COUNTING||n===sue.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(aue.ACCEPT.coord.x,aue.ACCEPT.coord.y)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getSpaceClass",value:function(e,t){var n=this.rules.node.gameState.getPieceAtXY(e,t);return this.getPlayerClass(n.getOwner())}},{key:"caseIsFull",value:function(e,t){return this.rules.node.gameState.getPieceAtXY(e,t)!==oue.EMPTY&&!this.isTerritory(e,t)}},{key:"isLastCase",value:function(e,t){if(this.last.isPresent()){var n=this.last.get();return e===n.x&&t===n.y}return!1}},{key:"isDead",value:function(e,t){return this.rules.node.gameState.isDead(new Jne(e,t))}},{key:"isTerritory",value:function(e,t){return this.rules.node.gameState.isTerritory(new Jne(e,t))}}]),n}(lie);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-go"]],features:[HC],decls:5,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["width","25","height","25","class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke highlighted",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","highlighted"],[1,"base","no-fill","captured-stroke",3,"click"],["width","50","height","50","fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],["width","25","height","25",1,"captured-stroke","mid-stroke","no-fill"],[1,"captured",3,"click"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),db(1,"rect",1),ob(2,Iue,2,1,"g",2),ob(3,xue,1,2,"rect",3),ob(4,Aue,1,3,"circle",4),fb()),2&e&&(nb("viewBox","0 -3 "+50*t.board.length+" "+(6+50*t.board.length)),Ow(1),nb("width",50*t.board.length)("height",50*t.board.length),Ow(1),cb("ngForOf",t.board),Ow(1),cb("ngIf",t.ko.isPresent()),Ow(1),cb("ngForOf",t.captures))},directives:[NT,DT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Nue=function(){function e(t,n,r){np(this,e),this.value=t,this.name=n,this.rgb=r}return ip(e,null,[{key:"of",value:function(t){switch(t){case 0:return e.ANY;case 1:return e.ORANGE;case 2:return e.BLUE;case 3:return e.PURPLE;case 4:return e.PINK;case 5:return e.YELLOW;case 6:return e.RED;case 7:return e.GREEN;default:return iB.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),e.BROWN}}}]),e}();Nue.ANY=new Nue(0,"any","#000"),Nue.ORANGE=new Nue(1,"orange","#d67421"),Nue.BLUE=new Nue(2,"blue","#006bac"),Nue.PURPLE=new Nue(3,"purple","#6f3787"),Nue.PINK=new Nue(4,"pink","#d2719e"),Nue.YELLOW=new Nue(5,"yellow","#e2c200"),Nue.RED=new Nue(6,"red","#d23339"),Nue.GREEN=new Nue(7,"green","#009157"),Nue.BROWN=new Nue(8,"brown","#562500");var Mue=function(){function e(t,n){np(this,e),this.player=t,this.color=n}return ip(e,[{key:"equals",value:function(e){return e.player===this.player&&e.color===this.color}},{key:"isEmpty",value:function(){return this.player.equals(Zee.NONE)}},{key:"belongsTo",value:function(e){return this.player===e}}],[{key:"of",value:function(t,n){return new e(t,Nue.of(n))}},{key:"createPlayerColors",value:function(t){return{ORANGE:new e(t,Nue.ORANGE),BLUE:new e(t,Nue.BLUE),PURPLE:new e(t,Nue.PURPLE),PINK:new e(t,Nue.PINK),YELLOW:new e(t,Nue.YELLOW),RED:new e(t,Nue.RED),GREEN:new e(t,Nue.GREEN),BROWN:new e(t,Nue.BROWN)}}}]),e}();Mue.NONE=new Mue(Zee.NONE,Nue.ANY),Mue.ZERO=Mue.createPlayerColors(Zee.ZERO),Mue.ONE=Mue.createPlayerColors(Zee.ONE);var Due=function(){function e(){np(this,e)}return ip(e,null,[{key:"getColorAt",value:function(t,n){return e.COLORS[n][t]}},{key:"getInitialBoard",value:function(){var e=Mue.NONE;return[[1,2,3,4,5,6,7,8].map(function(e){return Mue.of(Zee.ONE,e)}),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(function(e){return Mue.of(Zee.ZERO,e)})]}},{key:"isEmptyAt",value:function(e,t){return e[t.y][t.x].equals(Mue.NONE)}},{key:"allPieceCoords",value:function(t){for(var n=[],r=0;r<t.length;r++)for(var i=0;i<t[r].length;i++){var a=new Jne(i,r);e.isEmptyAt(t,a)||n.push(a)}return n}}]),e}();Due.INITIAL=Due.getInitialBoard(),Due.SIZE=8,Due.COLORS=Q5.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],Nue.of);var Lue=function(e){qv(n,e);var t=Wv(n);function n(e,r){return np(this,n),t.call(this,e,r)}return ip(n,[{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return this===n.PASS?"KamisadoMove(PASS)":"KamisadoMove("+this.coord+"->"+this.end+")"}}],[{key:"of",value:function(e,t){if(e.isNotInRange(Due.SIZE,Due.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+e.toString());if(t.isNotInRange(Due.SIZE,Due.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+t.toString());return new n(e,t)}}]),n}(_ie);Lue.PASS=new Lue(new Jne(-2,-2),new Jne(-3,-3)),Lue.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"maxValue",value:function(){return 34952}},{key:"encodeNumber",value:function(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){if(e<0)return Lue.PASS;var t=e%16,n=(e=e/16|0)%16,r=(e=e/16|0)%16;return new Lue(new Jne((e=e/16|0)%16,r),new Jne(n,t))}}]),n}(jee));var Fue=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o){var s;return np(this,n),(s=t.call(this,Q5.copyBiArray(o),e)).colorToPlay=r,s.coordToPlay=i,s.alreadyPassed=a,s}return ip(n,null,[{key:"getInitialState",value:function(){return new n(0,Nue.ANY,cB.empty(),!1,Due.INITIAL)}}]),n}(vre),Bue=function(){var e=ip(function e(){np(this,e)});return e.NOT_RIGHT_COLOR=function(){return $localize(ua||(ua=Nv(["This piece is not of the color you have to play."])))},e.DIRECTION_NOT_ALLOWED=function(){return $localize(ca||(ca=Nv(["You can only move forward, orthogonally or diagonally."])))},e.MOVE_BLOCKED=function(){return $localize(la||(la=Nv(["This move is blocked by another piece."])))},e.PLAY_WITH_SELECTED_PIECE=function(){return $localize(ha||(ha=Nv(["You must play with the selected piece."])))},e}(),Vue=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"nextCoordToPlay",value:function(e,t){return cB.ofNullable(Due.allPieceCoords(e.board).find(function(n){var r=e.getPieceAt(n);return r.player===e.getCurrentOpponent()&&r.color===t}))}},{key:"applyLegalMove",value:function(e,t,n){if(e===Lue.PASS){var r=this.nextCoordToPlay(t,t.colorToPlay);return new Fue(t.turn+1,t.colorToPlay,r,!0,t.board)}var i=e.coord,a=e.end,o=t.getCopiedBoard();o[a.y][a.x]=o[i.y][i.x],o[i.y][i.x]=Mue.NONE;var s=Due.getColorAt(a.x,a.y),u=this.nextCoordToPlay(t,s);return new Fue(t.turn+1,s,u,!1,o)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=t.getCurrentPlayer();if(n.mustPass(t)&&t.alreadyPassed)return Ere.getDefeat(r);var i=Fv(n.getFurthestPiecePositions(t),2),a=i[0];return 7===i[1]?Ere.ONE_WON:0===a?Ere.ZERO_WON:Ere.ONGOING}}],[{key:"getColorMatchingPiece",value:function(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new Jne(0,7),new Jne(1,7),new Jne(2,7),new Jne(3,7),new Jne(4,7),new Jne(5,7),new Jne(6,7),new Jne(7,7)]}},{key:"getMovablePieces",value:function(e){var t=this;return n.getColorMatchingPiece(e).filter(function(n){var r,i=Xv(t.playerDirections(e.getCurrentPlayer()));try{for(i.s();!(r=i.n()).done;){var a=r.value,o=n.getNext(a);if(e.isOnBoard(o)&&Due.isEmptyAt(e.board,o))return!0}}catch(s){i.e(s)}finally{i.f()}return!1})}},{key:"playerDirections",value:function(e){if(e===Zee.ONE)return[Yne.DOWN,Yne.DOWN_LEFT,Yne.DOWN_RIGHT];if(e===Zee.ZERO)return[Yne.UP,Yne.UP_LEFT,Yne.UP_RIGHT];throw new Error("Invalid player")}},{key:"directionAllowedForPlayer",value:function(e,t){if(t===Zee.ZERO)return e.y<0;if(t===Zee.ONE)return e.y>0;throw new Error("Invalid player")}},{key:"getListMovesFromState",value:function(e){var t=n.getMovablePieces(e);return 0===t.length?(Z5(!1===e.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[Lue.PASS]):n.getListMovesFromNonBlockedState(e,t)}},{key:"getListMovesFromNonBlockedState",value:function(e,t){var r,i=[],a=e.getCurrentPlayer(),o=Xv(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=Xv(n.playerDirections(a));try{for(c.s();!(s=c.n()).done;)for(var l=s.value,h=1;h<Due.SIZE;h++){var f=u.getNext(l,h);if(!e.isOnBoard(f)||!Due.isEmptyAt(e.board,f))break;var d=Lue.of(u,f);i.push(d)}}catch(v){c.e(v)}finally{c.f()}}}catch(v){o.e(v)}finally{o.f()}return i}},{key:"mustPass",value:function(e){return 0===this.getMovablePieces(e).length}},{key:"getFurthestPiecePositions",value:function(e){var t=7,n=0;return Due.allPieceCoords(e.board).forEach(function(r){var i=e.getPieceAt(r);Z5(i!==Mue.NONE,"allPieceCoords failed to filter KamisadoPiece.NONE"),i.player===Zee.ONE?n=Math.max(n,r.y):t=Math.min(t,r.y)}),[t,n]}},{key:"isLegal",value:function(e,t){var r=e.coord,i=e.end,a=t.colorToPlay;if(e===Lue.PASS)return this.isLegalPass(t);if(n.isVictory(t))return H5.failure("You should never see this message");var o=t.getPieceAt(r);if(!o.belongsTo(t.getCurrentPlayer()))return H5.failure(ure.MUST_CHOOSE_PLAYER_PIECE());if(a!==Nue.ANY&&o.color!==a)return H5.failure(Bue.NOT_RIGHT_COLOR());if(!t.getPieceAt(i).isEmpty())return H5.failure(ure.MUST_CLICK_ON_EMPTY_SPACE());var s=Yne.factory.fromMove(r,i);if(s.isFailure())return H5.failure(Bue.DIRECTION_NOT_ALLOWED());var u=s.get();if(!n.directionAllowedForPlayer(u,t.getCurrentPlayer()))return H5.failure(Bue.DIRECTION_NOT_ALLOWED());for(var c=r;!c.equals(i);)if(c=c.getNext(u),!t.getPieceAt(c).isEmpty())return H5.failure(Bue.MOVE_BLOCKED());return H5.success(void 0)}},{key:"isLegalPass",value:function(e){return this.mustPass(e)&&!e.alreadyPassed?H5.success(void 0):H5.failure(ure.CANNOT_PASS())}},{key:"isVictory",value:function(e){var t=Fv(this.getFurthestPiecePositions(e),2),n=t[0],r=t[1];return 0===n||7===r}}]),n}(Sre),Uue=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){var t=Vue.getListMovesFromState(e.gameState);return Q5.sortByDescending(t,function(e){return e.length()}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=t.getCurrentPlayer();if(Vue.mustPass(t)&&t.alreadyPassed)return new lre(n.getDefeatValue());var r=Fv(Vue.getFurthestPiecePositions(t),2),i=r[0],a=r[1];return new lre(7===a?Zee.ONE.getVictoryValue():0===i?Zee.ZERO.getVictoryValue():a-(7-i))}}]),n}(cre),zue=Mue.NONE,Hue=Mue.ZERO.ORANGE,Gue=Mue.ONE.ORANGE,que=Mue.ZERO.BLUE,$ue=Mue.ONE.BLUE,Wue=Mue.ZERO.PURPLE,jue=Mue.ONE.PURPLE,Zue=Mue.ZERO.PINK,Yue=Mue.ONE.PINK,Kue=Mue.ZERO.YELLOW,Jue=Mue.ONE.YELLOW,Que=Mue.ZERO.RED,Xue=Mue.ONE.RED,ece=Mue.ZERO.GREEN,tce=Mue.ONE.GREEN,nce=Mue.ZERO.BROWN,rce=Mue.ONE.BROWN,ice=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(fa||(fa=Nv(["Goal of the game"]))),$localize(da||(da=Nv(["At Kamisado, there are two ways to win the game:\n        either by moving one of your pieces on the opponent's starting line,\n        or by forcing the opponent to make a move that blocks the entire game.\n        Here, Dark wins because its brown piece is on Light's starting line, on the top left."]))),new Fue(5,Nue.ORANGE,cB.empty(),!1,[[nce,$ue,jue,Yue,Jue,Xue,tce,rce],[zue,zue,zue,zue,zue,zue,zue,zue],[zue,zue,zue,zue,zue,zue,zue,zue],[zue,zue,zue,zue,zue,zue,zue,zue],[zue,zue,zue,Gue,zue,zue,zue,zue],[zue,zue,zue,zue,zue,zue,zue,zue],[zue,zue,zue,zue,zue,zue,zue,zue],[zue,ece,Que,Kue,Zue,Wue,que,Hue]])).withPreviousMove(Lue.of(new Jne(0,7),new Jne(0,0))),Ire.anyMove($localize(va||(va=Nv(["Initial board and initial move"]))),$localize(pa||(pa=Nv(["Here is the initial board.\n        At Kamisado, pieces can only move forward, vertically or diagonally.\n        You're playing first, with dark pieces, you can make your first move.<br/><br/>\n        Click on the piece of your choice and click on the landing square."]))),Fue.getInitialState(),Lue.of(new Jne(7,7),new Jne(3,3)),$localize(ga||(ga=Nv(["Perfect! Note that each of your piece has a different color."])))),Ire.fromMove($localize(ya||(ya=Nv(["Moving"]))),$localize(ma||(ma=Nv(["Let us now consider the move of Light, after the blue piece has been moved by Dark.\n        All moves after the initial move must be made from the piece that corresponds to the color\n        of the square upon which the last move ended.\n        Here, the last move ended on the pink square, hence the pink piece must move.\n        It is already selected, you do not have to click on it.<br/><br/>\n        Move it on a blue square."]))),new Fue(1,Nue.PINK,cB.of(new Jne(3,0)),!1,[[Gue,$ue,jue,Yue,Jue,Xue,tce,rce],[zue,zue,zue,zue,zue,zue,zue,zue],[zue,zue,zue,zue,zue,zue,zue,zue],[zue,zue,zue,zue,zue,zue,zue,zue],[zue,zue,zue,zue,zue,zue,zue,zue],[zue,zue,zue,zue,zue,zue,que,zue],[zue,zue,zue,zue,zue,zue,zue,zue],[nce,ece,Que,Kue,Zue,Wue,zue,Hue]]),[Lue.of(new Jne(3,0),new Jne(3,6)),Lue.of(new Jne(3,0),new Jne(4,1))],$localize(ka||(ka=Nv(["Congratulations!"]))),$localize(_a||(_a=Nv(["You have not moved your pink piece on a blue square!"])))).withPreviousMove(Lue.of(new Jne(6,7),new Jne(6,5))),Ire.informational($localize(wa||(wa=Nv(["Stuck situation"]))),$localize(Ca||(Ca=Nv(["Dark moved to another pink square, hence you have to move your pink piece again.\n        However, your pink piece is stuck! In this case, you must pass your turn.\n        Dark will now have to play by moving its pink piece."]))),new Fue(1,Nue.PINK,cB.of(new Jne(3,6)),!1,[[Gue,$ue,jue,zue,Jue,Xue,tce,rce],[zue,zue,zue,zue,zue,zue,zue,zue],[zue,zue,zue,zue,zue,zue,zue,zue],[zue,zue,zue,zue,zue,zue,zue,zue],[zue,zue,zue,zue,zue,zue,zue,que],[zue,zue,zue,zue,zue,zue,zue,zue],[zue,zue,zue,Yue,zue,zue,zue,zue],[nce,ece,Que,Kue,Zue,Wue,zue,Hue]])).withPreviousMove(Lue.of(new Jne(6,5),new Jne(7,4))),Ire.fromMove($localize(ba||(ba=Nv(["Victory by blocking"]))),$localize(Ea||(Ea=Nv(["At any time, if a player blocks the entire game, that player loses.\n        In other words, if a player forces its opponent to move a piece that the opponent cannot move,\n        and the player cannot move its own piece of the same color, then that player loses.\n        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>\n        Try to make this move."]))),new Fue(2,Nue.RED,cB.of(new Jne(2,4)),!1,[[zue,$ue,jue,zue,zue,Xue,zue,zue],[zue,zue,zue,Jue,zue,zue,zue,zue],[zue,zue,zue,Yue,zue,jue,zue,zue],[zue,zue,zue,Kue,zue,zue,zue,zue],[zue,zue,Que,zue,zue,zue,zue,zue],[zue,zue,zue,zue,zue,zue,tce,zue],[Gue,zue,zue,zue,zue,Zue,zue,rce],[nce,ece,zue,zue,zue,zue,que,Hue]]),[Lue.of(new Jne(2,4),new Jne(0,2))],$localize(Sa||(Sa=Nv(["Perfect!\n         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.\n         Your orange piece will be stuck and you will have to pass your turn.\n         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.\n         In this case, the last player to have moved a piece loses.\n         Here, your opponent will have moved its green piece last, you therefore win!"]))),$localize(Pa||(Pa=Nv(["Failed!"])))).withPreviousMove(Lue.of(new Jne(4,0),new Jne(3,1)))]});function ace(e,t){if(1&e&&(wm(),db(0,"circle",8)),2&e){var n=Cb(),r=n.index,i=n.$implicit,a=Cb().index,o=Cb();nb("cx",o.SPACE_SIZE/2+r*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+a*o.SPACE_SIZE)("fill",o.pieceColor(i))("r",o.SPACE_SIZE/3)}}function oce(e,t){if(1&e&&(wm(),db(0,"rect",9)),2&e){var n=Cb(),r=n.$implicit,i=n.index,a=Cb().index,o=Cb();cb("ngClass",o.piecePlayerClass(r)),nb("x",o.SPACE_SIZE/2+i*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+a*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(r)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(r)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)}}function sce(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"g",4),kb("click",function(){var e=Wy(n).index,t=Cb().index;return Cb().onClick(e,t)}),db(2,"rect",5),ob(3,ace,1,4,"circle",6),ob(4,oce,1,7,"rect",7),fb(),fb()}if(2&e){var r=t.$implicit,i=t.index,a=Cb().index,o=Cb();Ow(1),Eb("id","click_",i,"_",a,""),Ow(1),nb("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE)("fill",o.backgroundColor(i,a)),Ow(1),cb("ngIf",r!==o.UNOCCUPIED),Ow(1),cb("ngIf",r!==o.UNOCCUPIED)}}function uce(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,sce,5,9,"g",1),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}function cce(e,t){if(1&e&&(wm(),hb(0,"g"),db(1,"rect",10),db(2,"rect",10),fb()),2&e){var n=Cb();Ow(1),nb("x",n.lastMove.get().coord.x*n.SPACE_SIZE)("y",n.lastMove.get().coord.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE),Ow(1),nb("x",n.lastMove.get().end.x*n.SPACE_SIZE)("y",n.lastMove.get().end.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function lce(e,t){if(1&e&&(wm(),db(0,"circle",11)),2&e){var n=Cb();nb("cx",n.SPACE_SIZE/2+n.chosen.get().x*n.SPACE_SIZE)("cy",n.SPACE_SIZE/2+n.chosen.get().y*n.SPACE_SIZE)}}var hce=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).UNOCCUPIED=Mue.NONE,r.lastMove=cB.empty(),r.chosen=cB.empty(),r.chosenAutomatically=!1,r.rules=new Vue(Fue),r.availableMinimaxes=[new Uue(r.rules,"KamisadoMinimax")],r.encoder=Lue.encoder,r.tutorial=(new ice).tutorial,r.canPass=!1,r.updateBoard(),r}return ip(n,[{key:"backgroundColor",value:function(e,t){return Due.getColorAt(e,t).rgb}},{key:"isPlayerZero",value:function(e){return e.player===Zee.ZERO}},{key:"pieceColor",value:function(e){return e.color.rgb}},{key:"piecePlayerClass",value:function(e){return this.getPlayerClass(e.player)}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.lastMove=this.rules.node.move,this.canPass=Vue.mustPass(e),this.canPass||e.coordToPlay.isAbsent()?(this.chosenAutomatically=!1,this.chosen=cB.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}},{key:"pass",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(Z5(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(Lue.PASS,e.rules.node.gameState)));case 1:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new Jne(e,t),!n.canPass){r.next=6;break}return r.abrupt("return",n.cancelMove(ure.MUST_PASS()));case 6:if(!n.chosen.isAbsent()){r.next=8;break}return r.abrupt("return",n.choosePiece(e,t));case 8:if(!1!==n.chosenAutomatically||!n.chosen.equalsValue(a)){r.next=10;break}return r.abrupt("return",(n.cancelMoveAttempt(),$5.SUCCESS));case 10:if(o=n.rules.node.gameState.getPieceAtXY(e,t),s=n.rules.node.gameState.getCurrentPlayer(),!o.belongsTo(s)){r.next=15;break}r.t0=n.chosenAutomatically?n.cancelMove(Bue.PLAY_WITH_SELECTED_PIECE()):(n.chosen=cB.of(a),$5.SUCCESS),r.next=18;break;case 15:return r.next=17,n.chooseDestination(e,t);case 17:r.t0=r.sent;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=this.rules.node.gameState.getPieceAtXY(e,t),r=this.rules.node.gameState.getCurrentOpponent();return n.belongsTo(r)?this.cancelMove(ure.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=cB.of(new Jne(e,t)),$5.SUCCESS)}},{key:"chooseDestination",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new Jne(e,t),o=Lue.of(i,a),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 2:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenAutomatically||(this.chosen=cB.empty())}}]),n}(lie);return e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-kamisado"]],features:[HC],decls:4,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["r","30","class","base mid-stroke no-fill highlighted",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",4,"ngIf"],["class","no-stroke",3,"ngClass",4,"ngIf"],[1,"base-no-fill"],[1,"no-stroke",3,"ngClass"],[1,"base","no-fill","mid-stroke","highlighted"],["r","30",1,"base","mid-stroke","no-fill","highlighted"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),ob(1,uce,2,1,"g",1),ob(2,cce,3,8,"g",2),ob(3,lce,1,2,"circle",3),fb()),2&e&&(nb("viewBox","-4 -4 "+8*t.SPACE_SIZE+" "+(8+8*t.SPACE_SIZE)),Ow(1),cb("ngForOf",t.board),Ow(1),cb("ngIf",t.lastMove.isPresent()),Ow(1),cb("ngIf",t.chosen.isPresent()))},directives:[NT,DT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),fce=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,null,[{key:"getInitialState",value:function(){var e=Zee.NONE,t=Zee.ZERO,r=Zee.ONE;return new n([[e,t,t,t,t,t,t,e],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[e,t,t,t,t,t,t,e]],0)}},{key:"isOnBoard",value:function(e){return e.isInRange(n.SIZE,n.SIZE)}}]),n}(vre);return e.SIZE=8,e}(),dce=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,e,r)).direction=i,a.direction=Yne.factory.fromMove(e,r).get(),a}return ip(n,[{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"LinesOfActionMove("+this.coord+"->"+this.end+")"}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}],[{key:"of",value:function(e,t){var r=Yne.factory.fromMove(e,t);return r.isFailure()?H5.failure(r.getReason()):e.isNotInRange(fce.SIZE,fce.SIZE)?H5.failure("start coord is not in range"):t.isNotInRange(fce.SIZE,fce.SIZE)?H5.failure("end coord is not in range"):H5.success(new n(e,t,r.get()))}}]),n}(_ie);dce.encoder=_ie.getEncoder(fce.SIZE,fce.SIZE,function(e,t){return dce.of(e,t).get()});var vce=function(){var e=ip(function e(){np(this,e)});return e.INVALID_MOVE_LENGTH=function(){return $localize(Oa||(Oa=Nv(["Your move should have a length equal to the number of pieces that exist on the same line."])))},e.CANNOT_JUMP_OVER_OPPONENT=function(){return $localize(Ta||(Ta=Nv(["You cannot jump over the opponent's pieces."])))},e.PIECE_CANNOT_MOVE=function(){return $localize(Ia||(Ia=Nv(["This piece has no possible move, select another one."])))},e.INVALID_DIRECTION=function(){return $localize(xa||(xa=Nv(["A move must be orthogonal or diagonal"])))},e}(),pce=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();return r[e.coord.y][e.coord.x]=Zee.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer(),new fce(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=Fv(n.getNumberOfGroups(t),2),i=r[0],a=r[1];return 1===i&&a>1?Ere.ZERO_WON:i>1&&1===a?Ere.ONE_WON:Ere.ONGOING}}],[{key:"getListMovesFromState",value:function(e){var t=[];if(n.getVictory(e).isPresent())return t;for(var r=0;r<fce.SIZE;r++)for(var i=0;i<fce.SIZE;i++){var a=new Jne(i,r);if(e.getPieceAt(a)!==Zee.NONE){var o,s=Xv(n.possibleTargets(e,a));try{for(s.s();!(o=s.n()).done;){var u=o.value,c=dce.of(a,u).get();t.push(c)}}catch(l){s.e(l)}finally{s.f()}}}return t}},{key:"getNumberOfGroups",value:function(e){for(var t=Q5.createTable(fce.SIZE,fce.SIZE,-1),r=[0,0],i=0,a=0;a<fce.SIZE;a++)for(var o=0;o<fce.SIZE;o++)if(-1===t[a][o]){var s=e.getPieceAt(new Jne(o,a));s!==Zee.NONE&&(i+=1,n.markGroupStartingAt(e,t,new Jne(o,a),i),r[s.value]+=1)}return r}},{key:"markGroupStartingAt",value:function(e,t,n,r){for(var i=[n],a=e.getPieceAt(n);i.length>0;){var o=iB.getNonNullable(i.pop());if(-1===t[o.y][o.x]){var s=e.getPieceAt(o);if(s===a){t[o.y][o.x]=r;var u,c=Xv(Yne.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){var l=u.value,h=o.getNext(l);e.isOnBoard(h)&&i.push(h)}}catch(f){c.e(f)}finally{c.f()}}else s===Zee.NONE&&(t[o.y][o.x]=0)}}}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)!==t.getCurrentPlayer()?H5.failure(ure.MUST_CHOOSE_PLAYER_PIECE()):e.length()!==this.numberOfPiecesOnLine(t,e.coord,e.direction)?H5.failure(vce.INVALID_MOVE_LENGTH()):e.coord.getCoordsToward(e.end).some(function(e){return t.getPieceAt(e)===t.getCurrentOpponent()})?H5.failure(vce.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.end)===t.getCurrentPlayer()?H5.failure(ure.CANNOT_SELF_CAPTURE()):H5.success(void 0)}},{key:"numberOfPiecesOnLine",value:function(e,t,r){var i,a=0,o=Xv(n.getLineCoords(t,r));try{for(o.s();!(i=o.n()).done;){var s=i.value;e.getPieceAt(s)!==Zee.NONE&&(a+=1)}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getLineCoords",value:function(e,t){for(var r=n.getEntranceAndForwardDirection(e,t),i=r[0],a=r[1],o=[];fce.isOnBoard(i);)o.push(i),i=i.getNext(a);return o}},{key:"getEntranceAndForwardDirection",value:function(e,t){switch(t){case Yne.UP:case Yne.DOWN:return[new Jne(e.x,0),Yne.DOWN];case Yne.LEFT:case Yne.RIGHT:return[new Jne(0,e.y),Yne.RIGHT];case Yne.UP_RIGHT:case Yne.DOWN_LEFT:return[new Jne(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),Yne.UP_RIGHT];default:return iB.expectToBeMultiple(t,[Yne.UP_LEFT,Yne.DOWN_RIGHT]),[new Jne(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),Yne.DOWN_RIGHT]}}},{key:"getVictory",value:function(e){var t=Fv(n.getNumberOfGroups(e),2),r=t[0],i=t[1];return 1===r&&1===i?cB.of(Zee.NONE):1===r?cB.of(Zee.ZERO):1===i?cB.of(Zee.ONE):cB.empty()}},{key:"possibleTargets",value:function(e,t){var r,i=[],a=Xv(Yne.DIRECTIONS);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.numberOfPiecesOnLine(e,t,o),u=t.getNext(o,s);if(e.isOnBoard(u)){var c=dce.of(t,u).get();n.isLegal(c,e).isSuccess()&&i.push(u)}}}catch(l){a.e(l)}finally{a.f()}return i}}]),n}(Sre),gce=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){return pce.getListMovesFromState(e.gameState)}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Fv(pce.getNumberOfGroups(t),2),r=n[0],i=n[1];return new lre(1===r&&i>1?Zee.ZERO.getVictoryValue():r>1&&1===i?Zee.ONE.getVictoryValue():100/r*Zee.ZERO.getScoreModifier()+100/i*Zee.ONE.getScoreModifier())}}]),n}(cre),yce=Zee.ZERO,mce=Zee.ONE,kce=Zee.NONE,_ce=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(Aa||(Aa=Nv(["Goal of the game"]))),$localize(Ra||(Ra=Nv(["At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.\n        Here, Dark wins the game:\n        Dark's pieces are forming a single group, while Light's pieces form three groups."]))),new fce([[kce,kce,kce,kce,kce,kce,kce,kce],[mce,kce,kce,kce,yce,kce,kce,mce],[kce,kce,yce,yce,mce,kce,kce,kce],[kce,kce,kce,yce,kce,kce,kce,kce],[kce,kce,kce,kce,kce,kce,kce,kce],[kce,kce,kce,kce,kce,kce,kce,kce],[kce,kce,kce,kce,kce,kce,kce,kce],[kce,kce,kce,kce,kce,kce,kce,kce]],0)),Ire.anyMove($localize(Na||(Na=Nv(["Initial board and initial move"]))),$localize(Ma||(Ma=Nv(["Here is the initial board.\n         Moves can be made orthogonally or diagonally.\n         The length of a move is equal to the number of pieces that are on the line of the move.\n         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>\n         You're playing Dark, make the first move!"]))),fce.getInitialState(),dce.of(new Jne(1,7),new Jne(1,5)).get(),$localize(Da||(Da=Nv(["Congratulations!"])))),Ire.fromMove($localize(La||(La=Nv(["Jumping"]))),$localize(Fa||(Fa=Nv(["During a move, it is possible to jump above your own pieces.\n        But it is forbidden to jump over the opponent's pieces.<br/><br/>\n        You're playing Dark, make a jump over one of your pieces on the following board."]))),new fce([[kce,kce,kce,kce,kce,kce,kce,kce],[kce,kce,mce,yce,yce,kce,kce,kce],[kce,kce,kce,kce,kce,kce,kce,kce],[kce,kce,kce,kce,kce,kce,kce,kce],[kce,kce,kce,kce,kce,kce,kce,kce],[kce,kce,kce,kce,kce,kce,kce,kce],[kce,kce,kce,kce,kce,kce,kce,mce],[kce,kce,kce,kce,kce,kce,kce,yce]],0),[dce.of(new Jne(3,1),new Jne(6,1)).get()],$localize(Ba||(Ba=Nv(["Congratulations!"]))),$localize(Va||(Va=Nv(["Failed. You did not jump over one of your pieces."])))),Ire.fromMove($localize(Ua||(Ua=Nv(["Moving"]))),$localize(za||(za=Nv(["Here is a different board. Pick the dark piece in the middle (line 4, column 4)\n        and observe its possible moves.\n        Horizontally, this piece can move only of one square because it is the only piece on this line.\n        Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.\n        But it can only go up, as below it the landing square is occupied by one of your pieces.\n        Diagonally, only one move is possible: on the diagonal that contains three pieces,\n        only in the direction where it does not jump over one of the opponent's pieces.\n        On the other diagonal, there are too many pieces to end the move on the board.<br/><br/>\n        Make one of these moves."]))),new fce([[kce,kce,kce,kce,kce,kce,mce,kce],[kce,kce,kce,kce,kce,yce,kce,kce],[kce,kce,kce,kce,mce,kce,kce,kce],[kce,kce,kce,yce,kce,kce,kce,kce],[kce,kce,kce,kce,kce,kce,kce,mce],[kce,kce,kce,kce,kce,mce,kce,mce],[kce,kce,kce,yce,kce,kce,mce,mce],[kce,kce,kce,yce,kce,kce,kce,kce]],0),[dce.of(new Jne(3,3),new Jne(3,0)).get(),dce.of(new Jne(3,3),new Jne(0,0)).get(),dce.of(new Jne(3,3),new Jne(2,3)).get(),dce.of(new Jne(3,3),new Jne(4,3)).get()],$localize(Ha||(Ha=Nv(["Congratulations!"]))),$localize(Ga||(Ga=Nv(["Failed. This was not one of the expected moves."])))),Ire.fromMove($localize(qa||(qa=Nv(["Capturing"]))),$localize($a||($a=Nv(["If a move ends on an opponent's pieces, this one is captured and removed from the board.\n        However, a move cannot end on one of the player's pieces.\n        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!\n        If a player has only one piece, that player wins the game.<br/><br/>\n        On the following board, try to capture one piece with Dark."]))),new fce([[kce,yce,kce,yce,yce,yce,yce,kce],[mce,kce,kce,kce,kce,kce,kce,mce],[kce,kce,yce,kce,mce,kce,kce,kce],[mce,kce,kce,kce,kce,kce,kce,mce],[mce,kce,kce,kce,kce,kce,kce,mce],[mce,kce,kce,kce,kce,kce,kce,mce],[mce,kce,kce,kce,kce,kce,kce,mce],[kce,yce,yce,yce,yce,yce,yce,kce]],0),[dce.of(new Jne(2,2),new Jne(4,2)).get()],$localize(Wa||(Wa=Nv(["Congratulations!"]))),$localize(ja||(ja=Nv(["Failed!"])))),Ire.fromMove($localize(Za||(Za=Nv(["Tie"]))),$localize(Ya||(Ya=Nv(["In the special case where a move ends up connecting all pieces of both player, simultaneously,\n        then the game ends up with a tie.<br/><br/>\n        You're playing Dark, force the tie in one move."]))),new fce([[kce,kce,kce,kce,kce,kce,kce,kce],[kce,kce,kce,kce,kce,kce,kce,kce],[yce,kce,kce,yce,mce,yce,kce,kce],[kce,kce,kce,yce,kce,kce,kce,mce],[kce,kce,kce,kce,kce,kce,kce,mce],[kce,kce,kce,kce,kce,kce,kce,mce],[kce,kce,kce,kce,kce,kce,kce,mce],[kce,kce,kce,kce,kce,kce,kce,kce]],0),[dce.of(new Jne(0,2),new Jne(4,2)).get()],$localize(Ka||(Ka=Nv(["Congratulations!"]))),$localize(Ja||(Ja=Nv(["Failed!"]))))]});function wce(e,t){if(1&e&&(wm(),db(0,"circle",5)),2&e){var n=Cb().index,r=Cb().index,i=Cb();cb("ngClass",i.getPieceClasses(n,r)),nb("cx",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+r*i.SPACE_SIZE)}}function Cce(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"g",2),kb("click",function(){var e=Wy(n).index,t=Cb().index;return Cb().onClick(e,t)}),db(2,"rect",3),ob(3,wce,1,3,"circle",4),fb(),fb()}if(2&e){var r=t.$implicit,i=t.index,a=Cb().index,o=Cb();Ow(1),Eb("id","click_",i,"_",a,""),Ow(1),cb("ngClass",o.getSquareClasses(i,a)),nb("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Ow(1),cb("ngIf",r!==o.EMPTY)}}function bce(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,Cce,4,8,"g",1),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}function Ece(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"rect",6),kb("click",function(){var e=Wy(n).$implicit;return Cb().onClick(e.x,e.y)}),fb(),fb()}if(2&e){var r=t.$implicit,i=Cb();Ow(1),nb("x",r.x*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("y",r.y*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("width",i.INDICATOR_SIZE)("height",i.INDICATOR_SIZE)}}var Sce=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).INDICATOR_SIZE=20,r.EMPTY=Zee.NONE,r.targets=[],r.selected=cB.empty(),r.lastMove=cB.empty(),r.captured=cB.empty(),r.rules=new pce(fce),r.availableMinimaxes=[new gce(r.rules,"LinesOfActionMinimax")],r.encoder=dce.encoder,r.tutorial=(new _ce).tutorial,r.updateBoard(),r}return ip(n,[{key:"onClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new Jne(e,t),!n.selected.isPresent()){r.next=9;break}if(n.getState().getPieceAt(a)!==n.getState().getCurrentPlayer()){r.next=7;break}return r.abrupt("return",n.select(a));case 7:return o=dce.of(n.selected.get(),new Jne(e,t)),r.abrupt("return",o.isSuccess()?n.chooseMove(o.get(),n.rules.node.gameState):n.cancelMove(vce.INVALID_DIRECTION()));case 9:return r.abrupt("return",n.select(a));case 10:case"end":return r.stop()}},r)}))()}},{key:"select",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.getState().getPieceAt(e)!==t.getState().getCurrentPlayer()?t.cancelMove(ure.MUST_CHOOSE_PLAYER_PIECE()):(t.selected=cB.of(e),t.targets=pce.possibleTargets(t.rules.node.gameState,t.selected.get()),0===t.targets.length?t.cancelMove(vce.PIECE_CANNOT_MOVE()):$5.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"updateBoard",value:function(){if(this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.lastMove.get();this.captured=this.getPreviousState().getPieceAt(e.end)!==Zee.NONE?cB.of(e.end):cB.empty()}}},{key:"cancelMoveAttempt",value:function(){this.selected=cB.empty(),this.targets=[]}},{key:"getSquareClasses",value:function(e,t){var n=new Jne(e,t);if(this.lastMove.isPresent()){var r=this.lastMove.get().coord,i=this.lastMove.get().end;if(this.captured.isPresent()&&n.equals(this.captured.get()))return["captured"];if(n.equals(r)||n.equals(i))return["moved"]}return[]}},{key:"getPieceClasses",value:function(e,t){var n=this.board[t][e],r=new Jne(e,t),i=[this.getPlayerClass(n)];return this.selected.isPresent()&&this.selected.get().equals(r)&&i.push("selected"),i}}]),n}(lie);return e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-linesofaction"]],features:[HC],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"ngClass"],["r","40","class","base",3,"ngClass",4,"ngIf"],["r","40",1,"base",3,"ngClass"],[1,"indicator",3,"click"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),ob(1,bce,2,1,"g",1),ob(2,Ece,2,4,"g",1),fb()),2&e&&(Ow(1),cb("ngForOf",t.board),Ow(1),cb("ngForOf",t.targets))},directives:[NT,AT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Pce=Number.MAX_SAFE_INTEGER,Oce=Number.MIN_SAFE_INTEGER,Tce=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this,Q5.copyBiArray(n.initialBoard),e)).turn=e,i.location=r,i}return ip(n,null,[{key:"getInitialState",value:function(){return new n(0,new Jne(0,0))}}]),n}(vre);Tce.BOARD_0=[[6,4,3,1],[4,4,3,1],[3,3,2,0],[1,1,0,0]],Tce.BOARD_1=[[0,+Pce,-1,-1],[1,2,+Pce,-1],[+Oce,3,4,-1],[-1,+Oce,+Oce,-1]],Tce.BOARD_2=[[0,+Pce,-1,-1],[+Pce,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],Tce.BOARD_3=[[0,1,+Oce,-1],[1,+Oce,-1,-1],[+Oce,-1,-1,-1],[-1,-1,-1,-1]],Tce.BOARD_4=[[0,1,+Oce,-1],[1,+Oce,-1,-1],[+Oce,-1,-1,-1],[-1,-1,-1,1]],Tce.initialBoard=Tce.BOARD_0;var Ice=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"applyLegalMove",value:function(e,t,n){var r=new Jne(t.location.x+(!0===e.right?1:0),t.location.y+(!1===e.right?1:0));return new Tce(t.turn+1,r)}},{key:"isLegal",value:function(e,t){var n=t.location,r=t.getCopiedBoard();return n.x+1===r[0].length&&!0===e.right||n.y+1===r.length&&!1===e.right?H5.failure("incorrect move"):H5.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getPieceAt(t.location);return n===Zee.ZERO.getVictoryValue()?Ere.ZERO_WON:n===Zee.ONE.getVictoryValue()?Ere.ONE_WON:t.location.equals(new Jne(3,3))?0===n?Ere.DRAW:n>0?Ere.ONE_WON:Ere.ZERO_WON:Ere.ONGOING}}]),n}(Sre),xce=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this)).right=e,r}return ip(n,[{key:"equals",value:function(e){return this===e||this.right===e.right}},{key:"toString",value:function(){return this.right?"Move RIGHT":"Move DOWN"}}]),n}(gre);xce.RIGHT=new xce(!0),xce.DOWN=new xce(!1),xce.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"maxValue",value:function(){return 1}},{key:"decodeNumber",value:function(e){return 0===e?xce.RIGHT:xce.DOWN}},{key:"encodeNumber",value:function(e){return e.right?0:1}}]),n}(jee));var Ace=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getBoardValue",value:function(e){var t=Ice.getGameStatus(e);if(t.isEndGame)return new lre(t.toBoardValue());var n=e.gameState;return new lre(n.getPieceAt(n.location))}},{key:"getListMoves",value:function(e){var t=[],n=e.gameState;return n.location.x<3&&t.push(xce.RIGHT),n.location.y<3&&t.push(xce.DOWN),t}}]),n}(cre);function Rce(e,t){1&e&&(vb(0),Nb(1,"("),pb())}function Nce(e,t){1&e&&(vb(0),Nb(1,")"),pb())}function Mce(e,t){if(1&e&&(hb(0,"td"),ob(1,Rce,2,0,"ng-container",3),Nb(2),ob(3,Nce,2,0,"ng-container",3),fb()),2&e){var n=t.$implicit,r=t.index,i=Cb().index,a=Cb();Ow(1),cb("ngIf",a.coord.x===r&&a.coord.y===i),Ow(1),Db(" ",n," "),Ow(1),cb("ngIf",a.coord.x===r&&a.coord.y===i)}}function Dce(e,t){if(1&e&&(hb(0,"tr"),ob(1,Mce,4,3,"td",0),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}var Lce=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).coord=new Jne(-1,-1),r.rules=new Ice(Tce),r.availableMinimaxes=[new Ace(r.rules,"MinimaxTestingMinimax")],r.encoder=xce.encoder,r}return ip(n,[{key:"chooseRight",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_right"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(xce.RIGHT,e.rules.node.gameState));case 2:case"end":return t.stop()}},t)}))()}},{key:"chooseDown",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_down"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(xce.DOWN,e.rules.node.gameState));case 2:case"end":return t.stop()}},t)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.coord=e.location}}]),n}(lie);return e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-minimax-testing"]],features:[HC],decls:8,vars:2,consts:[[4,"ngFor","ngForOf"],["id","click_right",3,"click"],["id","click_down",3,"click"],[4,"ngIf"]],template:function(e,t){1&e&&(hb(0,"table"),ob(1,Dce,2,1,"tr",0),hb(2,"div",1),kb("click",function(){return t.chooseRight()}),Nb(3," goRight "),fb(),hb(4,"div",2),kb("click",function(){return t.chooseDown()}),Nb(5," goDown "),fb(),hb(6,"div"),Nb(7),fb(),fb()),2&e&&(Ow(1),cb("ngForOf",t.board),Ow(6),Db(" ",t.coord," "))},directives:[NT,DT],encapsulation:2}),e}(),Fce=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,null,[{key:"getInitialState",value:function(){return new n(Q5.createTable(7,6,Zee.NONE),0)}}]),n}(vre),Bce=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this)).x=e,r}return ip(n,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"P4Move("+this.x+")"}}],[{key:"of",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;case 5:return n.FIVE;case 6:return n.SIX;default:throw new Error("Invalid P4Move")}}}]),n}(gre);Bce.ZERO=new Bce(0),Bce.ONE=new Bce(1),Bce.TWO=new Bce(2),Bce.THREE=new Bce(3),Bce.FOUR=new Bce(4),Bce.FIVE=new Bce(5),Bce.SIX=new Bce(6),Bce.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"maxValue",value:function(){return 6}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return Bce.of(e)}}]),n}(jee));var Vce=function(){var e=ip(function e(){np(this,e)});return e.COLUMN_IS_FULL=function(){return $localize(Qa||(Qa=Nv(["Please put your piece in an incomplete column."])))},e}(),Uce=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"applyLegalMove",value:function(e,t,r){var i=e.x,a=t.getCopiedBoard(),o=n.getLowestUnoccupiedCase(a,i),s=t.turn;return a[o][i]=t.getCurrentPlayer(),new Fce(a,s+1)}},{key:"isLegal",value:function(e,t){return aB(n.VERBOSE,{context:"P4Rules.isLegal",move:e.toString(),state:t}),t.getPieceAtXY(e.x,0)!==Zee.NONE?H5.failure(Vce.COLUMN_IS_FULL()):H5.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,r=0;r<7;r++)for(var i=5;-1!==i&&t.board[i][r]!==Zee.NONE;i--){var a=n.getSquareScore(t.board,new Jne(r,i));if(bre.getScoreStatus(a)===kre.VICTORY)return Ere.getVictory(t.getCurrentOpponent())}return 42===t.turn?Ere.DRAW:Ere.ONGOING}}],[{key:"getVictoriousCoords",value:function(e){for(var t=[],r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r]!==Zee.NONE;i--){var a=n.getSquareScore(e.board,new Jne(r,i));(a===Zee.ZERO.getVictoryValue()||a===Zee.ONE.getVictoryValue())&&t.push(new Jne(r,i))}return t}},{key:"getBoardValueFromScratch",value:function(e){aB(n.VERBOSE,{P4Rules_getBoardValueFromScratch:{state:e}});for(var t=0,r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r]!==Zee.NONE;i--){var a=n.getSquareScore(e.board,new Jne(r,i));if(bre.getScoreStatus(a)!==kre.DEFAULT)return aB(n.VERBOSE,{preVictoryOrVictory:{state:e,tmpScore:a,coord:{x:r,y:i}}}),new lre(a);t+=a}return new lre(t)}},{key:"getLowestUnoccupiedCase",value:function(e,t){for(var n=0;n<6&&e[n][t]===Zee.NONE;)n++;return n-1}},{key:"getNumberOfFreeSpacesAndAllies",value:function(e,t,n,r,i){for(var a=0,o=0,s=!0,u=new Jne(t.x+n.x,t.y+n.y);u.isInRange(7,6)&&3!==a;){var c=e[u.y][u.x];if(c===r)return[a,o];c===i&&s?o++:s=!1,c!==r&&c!==i&&a++,u=u.getNext(n)}return[a,o]}},{key:"getOpponent",value:function(e,t){var n=e[t.y][t.x];return Z5(n!==Zee.NONE,"getOpponent should not be called with Player.NONE"),n===Zee.ONE?Zee.ZERO:Zee.ONE}},{key:"getSquareScore",value:function(e,t){aB(n.VERBOSE,"getSquareScore(board, "+t.x+", "+t.y+") called"),aB(n.VERBOSE,e),Z5(e[t.y][t.x]!==Zee.NONE,"getSquareScore should not be called on an empty space");var r,i=0,a=n.getOpponent(e,t),o=e[t.y][t.x],s=new _re,u=new _re,c=Xv(Yne.DIRECTIONS);try{for(c.s();!(r=c.n()).done;){var l=r.value,h=n.getNumberOfFreeSpacesAndAllies(e,t,l,a,o);s.set(l,h[0]),u.set(l,h[1])}}catch(y){c.e(y)}finally{c.f()}for(var f=0,d=[Yne.UP,Yne.UP_RIGHT,Yne.RIGHT,Yne.DOWN_RIGHT];f<d.length;f++){var v=d[f],p=u.get(v).get()+u.get(v.getOpposite()).get();if(p>2)return aB(n.VERBOSE,{text:"there is some kind of victory here ("+t.x+", "+t.y+")\nline allies : "+p+"\n",board:e}),o.getVictoryValue();var g=s.get(v).get()+s.get(v.getOpposite()).get();3===g?i+=2:g>3&&(i+=g-2)}return i*o.getScoreModifier()}},{key:"getListMoves",value:function(e){aB(n.VERBOSE,{context:"P4Rules.getListMoves",node:e});for(var t=e.gameState,r=[],i=0;i<7;i++)if(t.getPieceAtXY(i,0)===Zee.NONE){var a=Bce.of(i);r.push(a)}return r}},{key:"getBoardValue",value:function(e){return aB(n.VERBOSE,{text:"P4Rules.getBoardValue called",board:e.getCopiedBoard()}),n.getBoardValueFromScratch(e)}}]),n}(Sre);return e.VERBOSE=!1,e}(),zce=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){return Uce.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=e.gameState;return aB(Uce.VERBOSE,{text:"P4Rules instance methods getBoardValue called",board:t.getCopiedBoard()}),Uce.getBoardValue(t)}}]),n}(cre),Hce=Zee.ZERO,Gce=Zee.ONE,qce=Zee.NONE,$ce=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(Xa||(Xa=Nv(["Goal of the game"]))),$localize(eo||(eo=Nv(["The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.\n        The first player plays Dark, the second plays Light.\n        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally)."]))),Fce.getInitialState()),Ire.anyMove($localize(to||(to=Nv(["Dropping a piece"]))),$localize(no||(no=Nv(["Click on any space in any column."]))),Fce.getInitialState(),Bce.THREE,$localize(ro||(ro=Nv(["As you can see, the piece falls at the bottom of the column."])))),Ire.fromMove($localize(io||(io=Nv(["Victory"]))),$localize(ao||(ao=Nv(["You're playing Dark.\n        Place your piece so that you create a horizontal alignment of 4 of your pieces."]))),new Fce([[qce,qce,qce,qce,qce,qce,qce],[qce,qce,qce,qce,qce,qce,qce],[qce,qce,qce,qce,qce,qce,qce],[qce,qce,qce,Gce,qce,qce,qce],[qce,qce,qce,Gce,qce,qce,qce],[qce,qce,Hce,Hce,Hce,Gce,qce]],0),[Bce.of(1)],$localize(oo||(oo=Nv(["You won!"]))),$localize(so||(so=Nv(["Failed, you have not aligned 4 pieces and missed an opportunity to win."])))),Ire.fromMove($localize(uo||(uo=Nv(["Other victory"]))),$localize(co||(co=Nv(["You can also align 4 pieces diagonally or vertically."]))),new Fce([[qce,qce,qce,qce,qce,qce,qce],[qce,qce,qce,qce,qce,qce,qce],[qce,qce,qce,qce,qce,qce,qce],[qce,qce,qce,Hce,Gce,qce,qce],[qce,qce,Hce,Hce,Gce,qce,qce],[qce,Hce,Gce,Hce,Hce,qce,qce]],0),[Bce.of(3),Bce.of(4)],$localize(lo||(lo=Nv(["You won!"]))),$localize(ho||(ho=Nv(["Failed, you have not aligned 4 pieces and missed an opportunity to win."]))))]});function Wce(e,t){if(1&e&&(wm(),db(0,"circle",6)),2&e){var n=Cb().index,r=Cb().index,i=Cb();cb("ngClass",i.getSquareFillClass(n,r)),nb("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function jce(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"rect",4),kb("click",function(){var e=Wy(n).index;return Cb(2).onClick(e)}),fb(),ob(2,Wce,1,4,"circle",5),fb()}if(2&e){var r=t.$implicit,i=t.index,a=Cb().index,o=Cb();Ow(1),bb("id","click_",i,""),nb("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Ow(1),cb("ngIf",r!=o.EMPTY_CASE)}}function Zce(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,jce,3,6,"g",1),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}function Yce(e,t){if(1&e&&(wm(),db(0,"rect",7)),2&e){var n=Cb();nb("x",n.SPACE_SIZE*n.last.get().x)("y",n.SPACE_SIZE*n.last.get().y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function Kce(e,t){if(1&e&&(wm(),db(0,"rect",8)),2&e){var n=t.$implicit,r=Cb();Eb("id","victory_coord_",n.x,"_",n.y,""),nb("x",r.SPACE_SIZE*n.x)("y",r.SPACE_SIZE*n.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}var Jce=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).EMPTY_CASE=Zee.NONE,r.victoryCoords=[],r.rules=new Uce(Fce),r.availableMinimaxes=[new zce(r.rules,"P4Minimax")],r.encoder=Bce.encoder,r.tutorial=(new $ce).tutorial,r.updateBoard(),r}return ip(n,[{key:"onClick",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=Bce.of(e),n.next=6,t.chooseMove(i,t.rules.node.gameState);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState,t=this.rules.node.move;this.victoryCoords=Uce.getVictoriousCoords(e),this.board=e.board,t.isPresent()?this.showLastMove():this.hideLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move,t=Uce.getLowestUnoccupiedCase(this.rules.node.gameState.board,e.get().x)+1;this.last=cB.of(new Jne(e.get().x,t))}},{key:"hideLastMove",value:function(){this.last=cB.empty()}},{key:"getSquareFillClass",value:function(e,t){return[this.getPlayerClass(this.board[t][e])]}}]),n}(lie);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-p4"]],features:[HC],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[1,"base",3,"id","click"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),ob(1,Zce,2,1,"g",1),ob(2,Yce,1,4,"rect",2),ob(3,Kce,1,6,"rect",3),fb()),2&e&&(Ow(1),cb("ngForOf",t.board),Ow(1),cb("ngIf",t.last.isPresent()),Ow(1),cb("ngForOf",t.victoryCoords))},directives:[NT,DT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Qce=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(np(this,n),(a=t.call(this,e,r)).blockTurned=i,a.turnedClockwise=o,a.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+a.coord.toString());return jv(a)}return ip(n,[{key:"toString",value:function(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}},{key:"equals",value:function(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}],[{key:"withRotation",value:function(e,t,r,i){if(r<0||3<r)throw new Error("This block do not exist: "+r);return new n(e,t,cB.of(r),i)}},{key:"rotationless",value:function(e,t){return new n(e,t,cB.empty())}}]),n}(yre);Qce.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"encodeMove",value:function(e){var t={coord:Jne.encoder.encode(e.coord)};return e.blockTurned.isPresent()&&(t.blockTurned=e.blockTurned.get(),t.turnedClockwise=e.turnedClockwise),t}},{key:"decodeMove",value:function(e){var t=e,n=Jne.encoder.decode(t.coord),r=cB.ofNullable(t.blockTurned);if(r.isPresent()){var i=t.turnedClockwise;return Qce.withRotation(n.x,n.y,r.get(),i)}return Qce.rotationless(n.x,n.y)}}]),n}(Wee));var Xce=function(){var e=ip(function e(){np(this,e)});return e.CANNOT_ROTATE_NEUTRAL_BLOCK=function(){return $localize(fo||(fo=Nv(["If the quadrant to turn is neutral, please just use move without rotation."])))},e.MUST_CHOOSE_BLOCK_TO_ROTATE=function(){return $localize(vo||(vo=Nv(["No quadrant is neutral, you must pick a quadrant to rotate."])))},e}(),ele=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this,e,r)).neutralBlocks=i.getBlocksNeutralities(),i}return ip(n,[{key:"getBlocksNeutralities",value:function(){for(var e=[],t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}},{key:"getBlockNeutrality",value:function(e){var t=n.getBlockCenter(e),r=this.getPieceAt(t.getNext(Yne.UP,1)),i=this.getPieceAt(t.getNext(Yne.UP_LEFT,1));return this.getPieceAt(t.getNext(Yne.RIGHT,1))===r&&this.getPieceAt(t.getNext(Yne.DOWN,1))===r&&this.getPieceAt(t.getNext(Yne.LEFT,1))===r&&this.getPieceAt(t.getNext(Yne.UP_RIGHT,1))===i&&this.getPieceAt(t.getNext(Yne.DOWN_RIGHT,1))===i&&this.getPieceAt(t.getNext(Yne.DOWN_LEFT,1))===i}},{key:"applyLegalDrop",value:function(e){var t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new n(t,this.turn)}},{key:"applyLegalMove",value:function(e){var t=this.applyLegalDrop(e),r=t.getCopiedBoard();if(e.blockTurned.isPresent()){var i=n.getBlockCenter(e.blockTurned.get());if(e.turnedClockwise){var a,o=Xv(n.ROTATION_MAP);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=s[0].getNext(i),c=s[1].getNext(i),l=t.getPieceAt(u);r[c.y][c.x]=l}}catch(y){o.e(y)}finally{o.f()}}else{var h,f=Xv(n.ROTATION_MAP);try{for(f.s();!(h=f.n()).done;){var d=h.value,v=d[1].getNext(i),p=d[0].getNext(i),g=t.getPieceAt(v);r[p.y][p.x]=g}}catch(y){f.e(y)}finally{f.f()}}}return new n(r,this.turn+1)}},{key:"blockIsNeutral",value:function(e){return this.neutralBlocks.includes(e)}}],[{key:"getInitialState",value:function(){return new n(Q5.createTable(6,6,Zee.NONE),0)}},{key:"getBlockCenter",value:function(e){return new Jne(1+(e%2==0?0:3),1+(e<2?0:3))}}]),n}(vre);ele.ROTATION_MAP=[[new Jne(-1,-1),new Jne(1,-1)],[new Jne(0,-1),new Jne(1,0)],[new Jne(1,-1),new Jne(1,1)],[new Jne(1,0),new Jne(0,1)],[new Jne(1,1),new Jne(-1,1)],[new Jne(0,1),new Jne(-1,0)],[new Jne(-1,1),new Jne(-1,-1)],[new Jne(-1,0),new Jne(0,-1)]];var tle=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord)!==Zee.NONE)return H5.failure(ure.MUST_LAND_ON_EMPTY_SPACE());var n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return H5.failure(Xce.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){var r=e.blockTurned.get();if(n.neutralBlocks.includes(r))return H5.failure(Xce.CANNOT_ROTATE_NEUTRAL_BLOCK())}return H5.success(void 0)}},{key:"getVictoryCoords",value:function(e){var t,r=[],i=Xv(n.VICTORY_SOURCE);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=e.getPieceAt(a[0]),s=[a[0]];if(o!==Zee.NONE){for(var u=a[0].getNext(a[1]),c=!0,l=0;l<3&&c;l++)e.getPieceAt(u)!==o?c=!1:(s.push(u),u=u.getNext(a[1]));if(c&&(e.getPieceAt(u)===o&&(s.push(u),r=r.concat(s)),a[2])){var h=a[0].getPrevious(a[1],1);e.getPieceAt(h)===o&&(s.push(h),r=r.concat(s))}}}}catch(f){i.e(f)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=this.getVictoryCoords(t),r=[!1,!1],i=0;i<n.length;i+=5)r[t.getPieceAt(n[i]).value]=!0;return!0===r[0]?!0===r[1]?Ere.DRAW:Ere.ZERO_WON:!0===r[1]?Ere.ONE_WON:36===t.turn?Ere.DRAW:Ere.ONGOING}}],[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n(ele)),bre.ruler=this.singleton,this.singleton}}]),n}(Sre);tle.VICTORY_SOURCE=[[new Jne(1,0),new Wne(1,1),!1],[new Jne(0,1),new Wne(1,1),!1],[new Jne(4,0),new Wne(-1,1),!1],[new Jne(5,1),new Wne(-1,1),!1],[new Jne(1,1),new Wne(1,1),!0],[new Jne(4,1),new Wne(-1,1),!0],[new Jne(0,1),new Wne(0,1),!0],[new Jne(1,1),new Wne(0,1),!0],[new Jne(2,1),new Wne(0,1),!0],[new Jne(3,1),new Wne(0,1),!0],[new Jne(4,1),new Wne(0,1),!0],[new Jne(5,1),new Wne(0,1),!0],[new Jne(1,0),new Wne(1,0),!0],[new Jne(1,1),new Wne(1,0),!0],[new Jne(1,2),new Wne(1,0),!0],[new Jne(1,3),new Wne(1,0),!0],[new Jne(1,4),new Wne(1,0),!0],[new Jne(1,5),new Wne(1,0),!0]];var nle=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){var t=[],r=e.gameState.neutralBlocks;if(0===e.gameState.turn)return n.FIRST_TURN_MOVES;var i,a=Xv(this.getLegalDrops(e.gameState));try{for(a.s();!(i=a.n()).done;){var o,s=i.value,u=Qce.rotationless(s.x,s.y),c=e.gameState.applyLegalDrop(u),l=Xv(this.getLegalRotations(c,r));try{for(l.s();!(o=l.n()).done;){var h=o.value;t.push(Qce.withRotation(s.x,s.y,h[0],h[1]))}}catch(f){l.e(f)}finally{l.f()}0===c.neutralBlocks.length==0&&t.push(u)}}catch(f){a.e(f)}finally{a.f()}return t}},{key:"getLegalDrops",value:function(e){for(var t=[],n=0;n<6;n++)for(var r=0;r<6;r++){var i=new Jne(r,n);e.getPieceAt(i)===Zee.NONE&&t.push(i)}return t}},{key:"getLegalRotations",value:function(e,t){for(var n=0===e.neutralBlocks.length,r=[],i=0;i<4;i++)!1===e.blockIsNeutral(i)&&(t.includes(i)?n&&r.push([i,!0]):r.push([i,!0],[i,!1]));return r}},{key:"getBoardValue",value:function(e){return new lre(tle.get().getGameStatus(e).toBoardValue())}}]),n}(cre);nle.FIRST_TURN_MOVES=[Qce.rotationless(0,0),Qce.rotationless(1,0),Qce.rotationless(2,0),Qce.rotationless(0,1),Qce.rotationless(1,1),Qce.rotationless(0,2)];var rle=Zee.NONE,ile=Zee.ONE,ale=Zee.ZERO,ole=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(po||(po=Nv(["Initial board"]))),$localize(go||(go=Nv(["The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate."]))),ele.getInitialState()),Ire.informational($localize(yo||(yo=Nv(["Goal of the game"]))),$localize(mo||(mo=Nv(["The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins."]))),new ele([[ale,rle,rle,ale,ile,rle],[ale,ile,rle,rle,rle,rle],[ale,rle,ile,rle,rle,rle],[ale,rle,rle,rle,rle,ile],[ale,rle,rle,rle,ile,rle],[rle,rle,rle,rle,rle,rle]],10)).withPreviousMove(Qce.withRotation(0,0,0,!1)),Ire.fromPredicate($localize(ko||(ko=Nv(["Simple move"]))),$localize(_o||(_o=Nv(["At their turn, players put a piece on the board and possibly rotate one quadrant.\n        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.\n        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>\n        Do it."]))),new ele([[rle,rle,rle,rle,rle,rle],[rle,ale,rle,rle,ile,rle],[rle,rle,rle,rle,rle,rle],[rle,rle,rle,rle,rle,rle],[rle,ile,rle,rle,ale,rle],[rle,rle,rle,rle,rle,rle]],10),Qce.rotationless(2,2),function(e,t){return e.blockTurned.isPresent()?$5.failure($localize(wo||(wo=Nv(["You have made a move with a rotation. This tutorial step is about moves without rotations!"])))):$5.SUCCESS},$localize(Co||(Co=Nv(["Congratulations!"])))),Ire.fromPredicate($localize(bo||(bo=Nv(["Move with rotation"]))),$localize(Eo||(Eo=Nv(["After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>\n        Click on one of them and see the rotation!"]))),new ele([[rle,rle,rle,rle,rle,rle],[rle,ale,rle,rle,ile,rle],[rle,rle,rle,rle,rle,rle],[rle,rle,rle,rle,rle,rle],[rle,ile,rle,rle,ale,rle],[rle,rle,rle,rle,rle,rle]],10),Qce.withRotation(0,0,0,!0),function(e,t){return e.blockTurned.isPresent()?$5.SUCCESS:$5.failure($localize(So||(So=Nv(["You made a move without rotation, try again!"]))))},$localize(Po||(Po=Nv(["Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation."]))))]});function sle(e,t){if(1&e){var n=gb();wm(),vb(0),hb(1,"circle",9),kb("click",function(){var e=Wy(n).$implicit,t=Cb().$implicit,r=Cb().index,i=Cb().index;return Cb().onClick(3*r+e,3*i+t)}),fb(),pb()}if(2&e){var r=t.$implicit,i=Cb().$implicit,a=Cb(),o=a.index,s=a.$implicit,u=Cb(),c=u.index,l=u.$implicit,h=Cb();Ow(1),Eb("id","click_",3*o+r,"_",3*c+i,""),cb("ngClass",h.getSquareClasses(3*o+r,3*c+i)),nb("cx",s+2*h.STROKE_WIDTH+(r+.5)*h.SPACE_SIZE)("cy",l+2*h.STROKE_WIDTH+(i+.5)*h.SPACE_SIZE)("r",(h.SPACE_SIZE-h.STROKE_WIDTH)/2)}}var ule=function(){return[0,1,2]};function cle(e,t){1&e&&(wm(),vb(0),ob(1,sle,2,6,"ng-container",3),pb()),2&e&&(Ow(1),cb("ngForOf",tP(1,ule)))}function lle(e,t){if(1&e&&(wm(),vb(0),db(1,"rect",8),ob(2,cle,2,2,"ng-container",3),pb()),2&e){var n=t.$implicit,r=t.index,i=Cb(),a=i.index,o=i.$implicit,s=Cb();Ow(1),cb("ngClass",s.getBlockClasses(r,a)),nb("x",s.STROKE_WIDTH+n)("y",s.STROKE_WIDTH+o)("rx",3*s.STROKE_WIDTH)("ry",3*s.STROKE_WIDTH)("width",s.BLOCK_WIDTH)("height",s.BLOCK_WIDTH),Ow(1),cb("ngForOf",tP(8,ule))}}var hle=function(e){return[0,e]};function fle(e,t){if(1&e&&(wm(),vb(0),ob(1,lle,3,9,"ng-container",3),pb()),2&e){var n=Cb();Ow(1),cb("ngForOf",nP(1,hle,n.BLOCK_SEPARATION))}}function dle(e,t){if(1&e&&(wm(),db(0,"circle",10)),2&e){var n=Cb();Eb("id","currentDrop_",n.currentDrop.get().x,"_",n.currentDrop.get().y,""),cb("ngClass",n.getPlayerClass(n.rules.node.gameState.getCurrentPlayer())),nb("cx",n.getCenter(n.currentDrop.get().x))("cy",n.getCenter(n.currentDrop.get().y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)}}function vle(e,t){if(1&e){var n=gb();wm(),hb(0,"path",11),kb("click",function(){var e=Wy(n).$implicit;return Cb().rotate(e)}),fb()}if(2&e){var r=t.$implicit,i=Cb();Eb("id","rotate_",r[1],"_",r[2]?"clockwise":"counterclockwise",""),nb("d",r[0])("stroke-width",2*i.STROKE_WIDTH)}}function ple(e,t){if(1&e&&(wm(),db(0,"circle",12)),2&e){var n=t.$implicit,r=Cb();Eb("id","victoryCoord_",n.x,"_",n.y,""),cb("ngClass",r.getSquareClasses(n.x,n.y)),nb("cx",r.getCenter(n.x))("cy",r.getCenter(n.y))("r",(r.SPACE_SIZE-r.STROKE_WIDTH)/2)("stroke-width",r.STROKE_WIDTH)}}function gle(e,t){if(1&e){var n=gb();wm(),hb(0,"g",13),kb("click",function(){return Wy(n),Cb().skipRotation()}),db(1,"circle",14),db(2,"line",15),fb()}if(2&e){var r=Cb();Ow(1),nb("cx",r.BLOCK_SEPARATION)("cy",r.BLOCK_SEPARATION)("r",.75*r.SPACE_SIZE)("stroke-width",2*r.STROKE_WIDTH),Ow(1),nb("x1",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("y1",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("x2",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("y2",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("stroke-width",2*r.STROKE_WIDTH)}}var yle=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).arrows=[],r.victoryCoords=[],r.rules=new tle(ele),r.availableMinimaxes=[new nle(r.rules,"PentagoMinimax")],r.encoder=Qce.encoder,r.tutorial=(new ole).tutorial,r.BLOCK_WIDTH=3*r.SPACE_SIZE+2*r.STROKE_WIDTH,r.BLOCK_SEPARATION=r.BLOCK_WIDTH+2*r.STROKE_WIDTH,r.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*r.SPACE_SIZE,r.ARROWS=r.generateArrowsCoord(),r.updateBoard(),r}return ip(n,[{key:"updateBoard",value:function(){this.board=this.rules.node.gameState.getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.rules.node.gameState),this.showLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move;if(this.cancelMoveAttempt(),e.isAbsent())this.hidePreviousMove();else{var t=e.get();this.movedBlock=t.blockTurned;var n=new Jne(t.coord.x%3-1,t.coord.y%3-1);if(t.blockTurned.isPresent()&&!1===n.equals(new Jne(0,0))&&this.coordBelongToBlock(t)){var r;r=t.turnedClockwise?iB.getNonNullable(ele.ROTATION_MAP.find(function(e){return e[0].equals(n)}))[1]:iB.getNonNullable(ele.ROTATION_MAP.find(function(e){return e[1].equals(n)}))[0];var i=t.blockTurned.get();r=r.getNext(new Wne(i%2==0?1:4,i<2?1:4),1),this.lastDrop=cB.of(r)}else this.lastDrop=cB.of(t.coord)}}},{key:"coordBelongToBlock",value:function(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}},{key:"hidePreviousMove",value:function(){this.lastDrop=cB.empty(),this.movedBlock=cB.empty(),this.victoryCoords=[]}},{key:"generateArrowsCoord",value:function(){var e=2*this.BLOCK_SEPARATION,t=this.SPACE_SIZE,n=.5*this.SPACE_SIZE;return[["M "+n+" 0 q "+t+" -"+t+" "+2*t+" 0",0,!0],["M 0 "+n+" q -"+t+" "+t+" 0 "+2*t,0,!1],["M "+e+" "+n+" q "+t+" "+t+" 0 "+2*t,1,!0],["M "+(e-n)+" 0 q -"+t+" -"+t+" -"+2*t+" 0",1,!1],["M 0 "+(e-n)+" q -"+t+" -"+t+" 0 -"+2*t,2,!0],["M "+n+" "+e+" q "+t+" "+t+" "+2*t+" 0",2,!1],["M "+(e-n)+" "+e+" q -"+t+" "+t+" -"+2*t+" 0",3,!0],["M "+e+" "+(e-n)+"  q "+t+" -"+t+" 0 -"+2*t,3,!1]]}},{key:"cancelMoveAttempt",value:function(){this.arrows=[],this.currentDrop=cB.empty(),this.canSkipRotation=!1}},{key:"onClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(n.board[t][e]===Zee.NONE){r.next=5;break}return r.abrupt("return",n.cancelMove(ure.MUST_LAND_ON_EMPTY_SPACE()));case 5:if(a=Qce.rotationless(e,t),o=n.rules.node.gameState,4!==(s=o.applyLegalDrop(a)).neutralBlocks.length){r.next=8;break}return r.abrupt("return",n.chooseMove(a,o));case 8:return u=n.rules.getGameStatus(n.rules.node),r.abrupt("return",(n.canSkipRotation=s.neutralBlocks.length>0&&!1===u.isEndGame,n.currentDrop=cB.of(new Jne(e,t)),n.displayArrows(s.neutralBlocks),$5.SUCCESS));case 10:case"end":return r.stop()}},r)}))()}},{key:"getCenter",value:function(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}},{key:"displayArrows",value:function(e){var t=this;this.arrows=[];for(var n=function(n){if(!1===e.includes(n)){var r=t.ARROWS.filter(function(e){return e[1]===n});t.arrows=t.arrows.concat(r)}},r=0;r<4;r++)n(r)}},{key:"getBlockClasses",value:function(e,t){return this.movedBlock.equalsValue(e+2*t)?["moved"]:[]}},{key:"getSquareClasses",value:function(e,t){var n=[],r=this.getPlayerClass(this.board[t][e]);return n.push(r),this.lastDrop.equalsValue(new Jne(e,t))&&n.push("last-move"),n}},{key:"rotate",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#rotate_"+e[1]+"_"+(e[2]?"clockwise":"counterclockwise"))).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=t.currentDrop.get(),a=Qce.withRotation(i.x,i.y,e[1],e[2]),n.abrupt("return",t.chooseMove(a,t.rules.node.gameState));case 5:case"end":return n.stop()}},n)}))()}},{key:"skipRotation",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.canUserPlay("#skipRotation")).isFailure()){t.next=3;break}return t.abrupt("return",e.cancelMove(n.getReason()));case 3:return r=e.currentDrop.get(),i=Qce.rotationless(r.x,r.y),t.abrupt("return",e.chooseMove(i,e.rules.node.gameState));case 5:case"end":return t.stop()}},t)}))()}}]),n}(lie);return e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-pentago"]],features:[HC],decls:9,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-60 -60 780 780"],["id","arrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#arrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#arrowhead)",1,"no-fill",3,"id","click"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),hb(1,"defs"),hb(2,"marker",1),db(3,"polygon",2),fb(),fb(),ob(4,fle,2,3,"ng-container",3),ob(5,dle,1,6,"circle",4),ob(6,vle,1,4,"path",5),ob(7,ple,1,7,"circle",6),ob(8,gle,3,9,"g",7),fb()),2&e&&(Ow(4),cb("ngForOf",nP(5,hle,t.BLOCK_SEPARATION)),Ow(1),cb("ngIf",t.currentDrop.isPresent()),Ow(1),cb("ngForOf",t.arrows),Ow(1),cb("ngForOf",t.victoryCoords),Ow(1),cb("ngIf",t.canSkipRotation))},directives:[NT,DT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),mle=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;if(np(this,n),(a=t.call(this,e,r)).z=i,e<0||e>3)throw new Error("PylosCoord: Invalid X: ".concat(e,"."));if(r<0||r>3)throw new Error("PylosCoord: Invalid Y: ".concat(r,"."));if(i<0||i>3)throw new Error("PylosCoord: Invalid Z: ".concat(i,"."));var o=4-i;if(a.isNotInRange(o,o))throw new Error(a.toString()+" is not in range.");return jv(a)}return ip(n,[{key:"toString",value:function(){return"PylosCoord"+this.toShortString()}},{key:"toShortString",value:function(){return"("+this.x+", "+this.y+", "+this.z+")"}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"isUpperThan",value:function(e){return this.z>e.z}},{key:"getLowerPieces",value:function(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");var e=this.z-1;return[new n(this.x,this.y,e),new n(this.x+1,this.y,e),new n(this.x,this.y+1,e),new n(this.x+1,this.y+1,e)]}},{key:"getHigherPieces",value:function(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");var e=this.z+1,t=new Jne(this.x-1,this.y-1),r=new Jne(this.x,this.y-1),i=new Jne(this.x-1,this.y),a=new Jne(this.x,this.y),o=4-e;return[t,r,i,a].filter(function(e){return e.isInRange(o,o)}).map(function(t){return new n(t.x,t.y,e)})}},{key:"getNextValid",value:function(e){var t=new Jne(this.x,this.y).getNext(e),r=4-this.z;return t.isNotInRange(r,r)?cB.empty():cB.of(new n(t.x,t.y,this.z))}}],[{key:"encodeOptional",value:function(e){return e.isPresent()?n.encode(e.get())+1:0}},{key:"encode",value:function(e){return 16*e.x+4*e.y+e.z}},{key:"decodeToOptional",value:function(e){return 0===e?cB.empty():cB.of(n.decode(e-1))}},{key:"decode",value:function(e){var t=e%4;e-=t;var r=(e/=4)%4;return e-=r,new n(e/=4,r,t)}}]),n}(Jne),kle=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a){var o;return np(this,n),(o=t.call(this)).startingCoord=e,o.landingCoord=r,o.firstCapture=i,o.secondCapture=a,o}return ip(n,[{key:"isClimb",value:function(){return this.startingCoord.isPresent()}},{key:"toString",value:function(){var e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}},{key:"equals",value:function(e){return e===this||!!(this.startingCoord.equals(e.startingCoord)&&this.landingCoord.equals(e.landingCoord)&&this.firstCapture.equals(e.firstCapture)&&this.secondCapture.equals(e.secondCapture))}}],[{key:"fromClimb",value:function(e,t,r){var i=cB.of(e),a=n.checkCaptures(r),o=new n(i,t,a.firstCapture,a.secondCapture);if(!t.isUpperThan(e))throw new Error("PylosMove: When piece move it must move upward.");return o}},{key:"checkCaptures",value:function(e){var t=cB.empty(),n=cB.empty();if(e.length>0&&(t=cB.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=cB.of(e[1]),e[1].isUpperThan(e[0])&&(t=cB.of(e[1]),n=cB.of(e[0])),e.length>2)throw new Error("PylosMove: can't capture that much piece.")}return{firstCapture:t,secondCapture:n}}},{key:"fromDrop",value:function(e,t){var r=cB.empty(),i=n.checkCaptures(t);return new n(r,e,i.firstCapture,i.secondCapture)}},{key:"changeCapture",value:function(e,t){var r=n.checkCaptures(t);return new n(e.startingCoord,e.landingCoord,r.firstCapture,r.secondCapture)}}]),n}(gre);kle.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"maxValue",value:function(){return 17575999}},{key:"encodeNumber",value:function(e){var t=mle.encode(e.landingCoord),n=mle.encodeOptional(e.startingCoord),r=mle.encodeOptional(e.firstCapture);return 270400*mle.encodeOptional(e.secondCapture)+4160*r+64*n+t}},{key:"decodeNumber",value:function(e){var t=mle.decode(e%64);e-=e%64;var n=mle.decodeToOptional((e/=64)%65);e-=e%65;var r=mle.decodeToOptional((e/=65)%65);e-=e%65;var i=mle.decodeToOptional(e/=65);return new kle(n,t,r,i)}}]),n}(jee));var _le=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this,r)).boards=e,i}return ip(n,[{key:"getPieceAt",value:function(e){return this.boards[e.z][e.y][e.x]}},{key:"applyLegalMove",value:function(e){var t=[];return t.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&t.push({coord:e.startingCoord.get(),value:Zee.NONE}),e.firstCapture.isPresent()&&t.push({coord:e.firstCapture.get(),value:Zee.NONE}),e.secondCapture.isPresent()&&t.push({coord:e.secondCapture.get(),value:Zee.NONE}),this.setBoardAts(t,this.turn+1)}},{key:"setBoardAts",value:function(e,t){var r,i=[Q5.copyBiArray(this.boards[0]),Q5.copyBiArray(this.boards[1]),Q5.copyBiArray(this.boards[2]),Q5.copyBiArray(this.boards[3])],a=Xv(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.coord;i[s.z][s.y][s.x]=o.value}}catch(u){a.e(u)}finally{a.f()}return new n(i,t)}},{key:"isLandable",value:function(e){if(this.getPieceAt(e)!==Zee.NONE)return!1;if(0===e.z)return!0;var t,n=Xv(e.getLowerPieces());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r)===Zee.NONE)return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"isSupporting",value:function(e){if(3===e.z)return!1;var t,n=Xv(e.getHigherPieces());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r)!==Zee.NONE)return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"getPiecesRepartition",value:function(){var e={};e[Zee.NONE.value]=0,e[Zee.ZERO.value]=0,e[Zee.ONE.value]=0;for(var t=0;t<3;t++)for(var n=0;n<4-t;n++)for(var r=0;r<4-t;r++){var i=new mle(r,n,t),a=this.getPieceAt(i);e[a.value]=1+e[a.value]}return e}}],[{key:"getInitialState",value:function(){return new n([Q5.createTable(4,4,Zee.NONE),Q5.createTable(3,3,Zee.NONE),Q5.createTable(2,2,Zee.NONE),[[Zee.NONE]]],0)}}]),n}(dre),wle=function(){var e=ip(function e(){np(this,e)});return e.MUST_MOVE_UPWARD=function(){return $localize(Oo||(Oo=Nv(["You must move your pieces upward."])))},e.SHOULD_HAVE_SUPPORTING_PIECES=function(){return $localize(To||(To=Nv(["Your piece must land on the board or on 4 other pieces."])))},e.CANNOT_LAND=function(){return $localize(Io||(Io=Nv(["You cannot land on this space."])))},e.CANNOT_CAPTURE=function(){return $localize(xo||(xo=Nv(["You cannot capture."])))},e.INVALID_FIRST_CAPTURE=function(){return $localize(Ao||(Ao=Nv(["Your first capture is invalid."])))},e.INVALID_SECOND_CAPTURE=function(){return $localize(Ro||(Ro=Nv(["Your second capture is invalid."])))},e}(),Cle=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.landingCoord)!==Zee.NONE)return H5.failure(ure.MUST_LAND_ON_EMPTY_SPACE());var r=t.getCurrentOpponent();if(e.startingCoord.isPresent()){var i=e.startingCoord.get(),a=t.getPieceAt(i);if(a===r)return H5.failure(ure.CANNOT_CHOOSE_OPPONENT_PIECE());if(a===Zee.NONE)return H5.failure(ure.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i.getHigherPieces().filter(function(n){return t.getPieceAt(n)!==Zee.NONE||n.equals(e.landingCoord)}).length>0)return H5.failure(wle.SHOULD_HAVE_SUPPORTING_PIECES())}if(!t.isLandable(e.landingCoord))return H5.failure(wle.CANNOT_LAND());if(e.firstCapture.isPresent()){if(!1===n.canCapture(t,e.landingCoord))return H5.failure(wle.CANNOT_CAPTURE());if(!n.isValidCapture(t,e,e.firstCapture.get()))return H5.failure(wle.INVALID_FIRST_CAPTURE());if(e.secondCapture.isPresent()&&!n.isValidCapture(t,e,e.secondCapture.get()))return H5.failure(wle.INVALID_SECOND_CAPTURE())}return H5.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getStateInfo",value:function(e){for(var t=[],n=[],r=0;r<3;r++)for(var i=0;i<4-r;i++)for(var a=0;a<4-r;a++){var o=new mle(a,i,r);e.getPieceAt(o)===e.getCurrentPlayer()&&!1===e.isSupporting(o)&&t.push(o),e.isLandable(o)&&n.push(o)}return{freeToMove:t,landable:n}}},{key:"getClimbingMoves",value:function(e){var t,n=[],r=Xv(e.freeToMove);try{var i=function(){var r,i=t.value,a=Xv(e.landable);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.isUpperThan(i)&&!1===o.getLowerPieces().some(function(e){return i.equals(e)})){var s=kle.fromClimb(i,o,[]);n.push(s)}}}catch(u){a.e(u)}finally{a.f()}};for(r.s();!(t=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getDropMoves",value:function(e){var t,n=[],r=Xv(e.landable);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=kle.fromDrop(i,[]);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"canCapture",value:function(e,t){for(var n=e.getCurrentPlayer(),r=0,i=[Kne.UP,Kne.DOWN];r<i.length;r++){var a=i[r],o=t.getNextValid(a);if(o.isPresent()&&e.getPieceAt(o.get())===n)for(var s=0,u=[Kne.LEFT,Kne.RIGHT];s<u.length;s++){var c=u[s],l=o.get().getNextValid(c);if(l.isPresent()&&e.getPieceAt(l.get())===n){var h=a.getOpposite(),f=l.get().getNextValid(h).get();if(e.getPieceAt(f)===n)return!0}}}return!1}},{key:"getPossibleCaptures",value:function(e,t,n){for(var r=[],i=(e=e.filter(function(e){return!1===t.equalsValue(e)})).concat(n),a=0;a<i.length;a++){var o=i[a];r.push([o]);for(var s=a+1;s<i.length;s++)r.push([i[s],o])}return r}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isValidCapture",value:function(e,t,n){var r=e.getCurrentPlayer();return!(!n.equals(t.landingCoord)&&e.getPieceAt(n)!==r||n.getHigherPieces().filter(function(n){return e.getPieceAt(n)!==Zee.NONE&&!1===n.equals(t.firstCapture.get())}).length>0)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getPiecesRepartition();return 15===t[Zee.ZERO.value]?Ere.ONE_WON:15===t[Zee.ONE.value]?Ere.ZERO_WON:Ere.ONGOING}}]),n}(Sre),ble=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){return n.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=Cle.getGameStatus(e);if(t.isEndGame)return new lre(t.toBoardValue());var n=e.gameState.getPiecesRepartition();return new lre(n[Zee.ZERO.value]-n[Zee.ONE.value])}}],[{key:"getListMoves",value:function(e){var t,n=e.gameState,r=[],i=Cle.getStateInfo(n),a=Cle.getClimbingMoves(i),o=Cle.getDropMoves(i),s=Xv(a.concat(o));try{for(s.s();!(t=s.n()).done;){var u=t.value,c=[[]];Cle.canCapture(n,u.landingCoord)&&(c=Cle.getPossibleCaptures(i.freeToMove,u.startingCoord,u.landingCoord));var l,h=Xv(c);try{for(h.s();!(l=h.n()).done;){var f=l.value,d=kle.changeCapture(u,f);r.push(d)}}catch(v){h.e(v)}finally{h.f()}}}catch(v){s.e(v)}finally{s.f()}return r}}]),n}(cre),Ele=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){var t=ble.getListMoves(e);return this.orderMoves(t)}},{key:"orderMoves",value:function(e){return e.sort(function(e,t){var r=12*n.countStoneUsed(e),i=12*n.countStoneUsed(t);return r+n.sumMoveEmplacementByValue(e)-(i+n.sumMoveEmplacementByValue(t))})}}],[{key:"countStoneUsed",value:function(e){var t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}},{key:"sumMoveEmplacementByValue",value:function(e){var t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}}]),n}(ble),Sle=Zee.NONE,Ple=Zee.ZERO,Ole=Zee.ONE,Tle=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(No||(No=Nv(["Goal of the game"]))),$localize(Mo||(Mo=Nv(["At Pylos, the goal is to be the last to play.\n        To do this, you have to save up your pieces.\n        As soon as a player puts its last piece, that player loses the game immediately.\n        Here is what the initial board looks like, it is a board of 4 x 4 squares.\n        This board will become a pyramid, little by little.\n        It will be filled by the pieces of your stock. Each player has 15 pieces."]))),_le.getInitialState()),Ire.anyMove($localize(Do||(Do=Nv(["Dropping a piece"]))),$localize(Lo||(Lo=Nv(["When it is your turn, you can always drop one of your piece on an empty square.\n        The gray squares are where you can drop your pieces.<br/><br/>\n        Click on one of the squares to drop a piece there."]))),_le.getInitialState(),kle.fromDrop(new mle(1,1,0),[]),$localize(Fo||(Fo=Nv(["There you go, as simple as that."])))),Ire.fromMove($localize(Bo||(Bo=Nv(["Climbing"]))),$localize(Vo||(Vo=Nv(["When 4 pieces form a square, it is possible to put a fifth piece on top.\n        However, when that happens, you can save a piece by climbing instead of dropping a piece.\n        To climb:\n        <ol>\n            <li>Click on one of your free pieces, which should be lower than the landing square.</li>\n            <li>Click on an empty landing square, higher than your selected piece.</li>\n        </ol><br/>\n        Go ahead, climb!"]))),new _le([[[Ple,Ole,Sle,Sle],[Ole,Ple,Sle,Sle],[Sle,Sle,Sle,Sle],[Sle,Sle,Sle,Ple]],[[Sle,Sle,Sle],[Sle,Sle,Sle],[Sle,Sle,Sle]],[[Sle,Sle],[Sle,Sle]],[[Sle]]],0),[kle.fromClimb(new mle(3,3,0),new mle(0,0,1),[])],$localize(Uo||(Uo=Nv(["Congratulations!<br/>\n        Some important notes:\n        <ol>\n            <li>You cannot move a piece that is directly below another one.</li>\n            <li>Of course, you cannot move the opponent's pieces.</li>\n            <li>You can only climb when the landing square is higher than the starting square.</li>\n        </ol>"]))),$localize(zo||(zo=Nv(["Failed!"])))),Ire.fromMove($localize(Ho||(Ho=Nv(["Square (1/2)"]))),$localize(Go||(Go=Nv(["When the piece you just moved or dropped is the fourth one of a square of your color,\n        you can choose anywhere on the board one or two of your pieces.\n        These pieces will be removed from the board, allowing you to save up one or two pieces.\n        A chosen piece must not be directly below another piece.\n        A chosen piece can be the piece you just placed.\n        You're playing Dark.<br/><br/>\n        Form a square, then click twice on one of the four pieces to remove only that one."]))),new _le([[[Ple,Ple,Sle,Sle],[Sle,Ple,Sle,Sle],[Sle,Sle,Sle,Sle],[Sle,Sle,Sle,Sle]],[[Sle,Sle,Sle],[Sle,Sle,Sle],[Sle,Sle,Sle]],[[Sle,Sle],[Sle,Sle]],[[Sle]]],0),[kle.fromDrop(new mle(0,1,0),[new mle(0,0,0)]),kle.fromDrop(new mle(0,1,0),[new mle(0,1,0)]),kle.fromDrop(new mle(0,1,0),[new mle(1,0,0)]),kle.fromDrop(new mle(0,1,0),[new mle(1,1,0)])],$localize(qo||(qo=Nv(["Congratulations, you have saved up one piece."]))),$localize($o||($o=Nv(["Failed!"])))),Ire.fromPredicate($localize(Wo||(Wo=Nv(["Square (2/2)"]))),$localize(jo||(jo=Nv(["You're playing Dark.<br/><br/>\n        Do like in the previous step, but this time click on two different pieces."]))),new _le([[[Ple,Ple,Sle,Sle],[Sle,Ple,Sle,Sle],[Sle,Sle,Sle,Sle],[Sle,Sle,Sle,Sle]],[[Sle,Sle,Sle],[Sle,Sle,Sle],[Sle,Sle,Sle]],[[Sle,Sle],[Sle,Sle]],[[Sle]]],0),kle.fromDrop(new mle(0,1,0),[new mle(0,0,0),new mle(1,0,0)]),function(e,t){return e.secondCapture.isPresent()?$5.SUCCESS:e.firstCapture.isPresent()?$5.failure($localize(Zo||(Zo=Nv(["Failed, you only captured one piece."])))):$5.failure($localize(Yo||(Yo=Nv(["Failed, you did not capture any piece."]))))},$localize(Ko||(Ko=Nv(["Congratulations, you have saved up two pieces."]))))]});function Ile(e,t){if(1&e&&(wm(),hb(0,"g"),db(1,"circle",4),fb()),2&e){var n=t.$implicit,r=Cb().$implicit,i=Cb();Ow(1),Eb("id","piece_",r,"_",n,""),cb("ngClass",i.getPlayerPieceClass(r)),nb("cx",.5*i.SPACE_SIZE+(800-i.SPACE_SIZE)/14*n)("cy",860+(i.SPACE_SIZE+10)*r)("r",.5*i.SPACE_SIZE)}}function xle(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,Ile,2,6,"g",1),fb()),2&e){var n=t.$implicit,r=Cb();Ow(1),cb("ngForOf",r.getPlayerSidePieces(n))}}function Ale(e,t){if(1&e){var n=gb();wm(),hb(0,"circle",8),kb("click",function(){Wy(n);var e=Cb(2).$implicit,t=Cb().$implicit,r=Cb().$implicit;return Cb().onPieceClick(e,t,r)}),fb()}if(2&e){var r=Cb(2).$implicit,i=Cb().$implicit,a=Cb().$implicit,o=Cb();Sb("id","piece_",r,"_",i,"_",a,""),cb("ngClass",o.getPieceClasses(r,i,a)),nb("r",o.getPieceRadius(a)-o.STROKE_WIDTH)("cx",o.getPieceCx(r,i,a))("cy",o.getPieceCy(r,i,a))}}function Rle(e,t){if(1&e){var n=gb();wm(),hb(0,"rect",8),kb("click",function(){Wy(n);var e=Cb(2).$implicit,t=Cb().$implicit,r=Cb().$implicit;return Cb().onDrop(e,t,r)}),fb()}if(2&e){var r=Cb(2).$implicit,i=Cb().$implicit,a=Cb().$implicit,o=Cb();Sb("id","drop_",r,"_",i,"_",a,""),cb("ngClass",o.getSquareClasses(r,i,a)),nb("width",2*o.getPieceRadius(a))("height",2*o.getPieceRadius(a))("x",o.getPieceCx(r,i,a)-o.getPieceRadius(a))("y",o.getPieceCy(r,i,a)-o.getPieceRadius(a))}}function Nle(e,t){if(1&e&&(wm(),vb(0),ob(1,Ale,1,7,"circle",6),ob(2,Rle,1,8,"ng-template",null,7,IP),pb()),2&e){var n=sb(3),r=Cb().$implicit,i=Cb().$implicit,a=Cb().$implicit,o=Cb();Ow(1),cb("ngIf",o.isOccupied(r,i,a))("ngIfElse",n)}}function Mle(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,Nle,4,2,"ng-container",5),fb()),2&e){var n=t.$implicit,r=Cb().$implicit,i=Cb().$implicit,a=Cb();Ow(1),cb("ngIf",a.isDrawable(n,r,i))}}function Dle(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,Mle,2,1,"g",1),fb()),2&e){var n=Cb().$implicit,r=Cb();Ow(1),cb("ngForOf",r.getLevelRange(n))}}function Lle(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,Dle,2,1,"g",1),fb()),2&e){var n=t.$implicit,r=Cb();Ow(1),cb("ngForOf",r.getLevelRange(n))}}function Fle(e,t){if(1&e&&(wm(),db(0,"rect",9)),2&e){var n=Cb();Sb("id","highCapture_",n.highCapture.get().x,"_",n.highCapture.get().y,"_",n.highCapture.get().z,""),nb("width",2*n.getPieceRadius(n.highCapture.get().z))("height",2*n.getPieceRadius(n.highCapture.get().z))("x",n.getPieceCx(n.highCapture.get().x,n.highCapture.get().y,n.highCapture.get().z)-n.getPieceRadius(n.highCapture.get().z))("y",n.getPieceCy(n.highCapture.get().x,n.highCapture.get().y,n.highCapture.get().z)-n.getPieceRadius(n.highCapture.get().z))}}var Ble=function(){return[0,1]},Vle=function(){return[0,1,2]},Ule=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).lastLandingCoord=cB.empty(),r.lastStartingCoord=cB.empty(),r.lastFirstCapture=cB.empty(),r.lastSecondCapture=cB.empty(),r.highCapture=cB.empty(),r.chosenStartingCoord=cB.empty(),r.chosenLandingCoord=cB.empty(),r.chosenFirstCapture=cB.empty(),r.lastMove=cB.empty(),r.remainingPieces={0:15,1:15},r.rules=new Cle(_le),r.availableMinimaxes=[new ble(r.rules,"PylosMinimax"),new Ele(r.rules,"PylosOrderedMinimax")],r.encoder=kle.encoder,r.tutorial=(new Tle).tutorial,r.SPACE_SIZE=r.getPieceRadius(0),r.updateBoard(),r}return ip(n,[{key:"getLevelRange",value:function(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return iB.expectToBe(e,2),[0,1]}}},{key:"isDrawable",value:function(e,t,n){var r=new mle(e,t,n);return this.state.getPieceAt(r)!==Zee.NONE||this.state.isLandable(r)}},{key:"onPieceClick",value:function(e,t,n){var r=this;return rB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#piece_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new mle(e,t,n),i.abrupt("return",r.state.getPieceAt(o)===r.state.getCurrentOpponent()?r.cancelMove(ure.CANNOT_CHOOSE_OPPONENT_PIECE()):r.chosenLandingCoord.isAbsent()?(r.chosenStartingCoord=cB.of(o),$5.SUCCESS):r.chosenFirstCapture.isAbsent()?(r.chosenFirstCapture=cB.of(o),$5.SUCCESS):r.chosenFirstCapture.equalsValue(o)?r.concludeMoveWithCapture([r.chosenFirstCapture.get()]):r.concludeMoveWithCapture([r.chosenFirstCapture.get(),o]));case 5:case"end":return i.stop()}},i)}))()}},{key:"concludeMoveWithCapture",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(r=t.chosenStartingCoord.isAbsent()?kle.fromDrop(t.chosenLandingCoord.get(),e):kle.fromClimb(t.chosenStartingCoord.get(),t.chosenLandingCoord.get(),e),t.tryMove(r,t.state)));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.cancelMove(),n.chooseMove(e,t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenStartingCoord=cB.empty(),this.chosenLandingCoord=cB.empty(),this.chosenFirstCapture=cB.empty()}},{key:"onDrop",value:function(e,t,n){var r=this;return rB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#drop_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new mle(e,t,n),i.abrupt("return",Cle.canCapture(r.state,o)?(r.chosenLandingCoord=cB.of(o),$5.SUCCESS):r.isCapturelessMoveFinished(o)?(r.chosenLandingCoord=cB.of(o),r.concludeMoveWithCapture([])):r.cancelMove(wle.MUST_MOVE_UPWARD()));case 5:case"end":return i.stop()}},i)}))()}},{key:"isCapturelessMoveFinished",value:function(e){return!!this.chosenStartingCoord.isAbsent()||e.isUpperThan(this.chosenStartingCoord.get())}},{key:"getSquareClasses",value:function(e,t,n){var r=new mle(e,t,n);if(this.lastMove.isPresent()){var i=this.lastMove.get();if(i.firstCapture.equalsValue(r)||i.secondCapture.equalsValue(r))return["captured"];if(r.equals(i.landingCoord)||i.startingCoord.equalsValue(r))return["moved"]}return[]}},{key:"getPieceRadius",value:function(e){return 90+5*e}},{key:"getPieceCx",value:function(e,t,n){return 100+100*n+200*e}},{key:"getPieceCy",value:function(e,t,n){return 100+100*n+200*t}},{key:"isOccupied",value:function(e,t,n){var r=new mle(e,t,n),i=this.rules.node.gameState.getPieceAt(r)!==Zee.NONE,a=this.chosenLandingCoord.equalsValue(r);return i||a}},{key:"getPieceClasses",value:function(e,t,n){var r=new mle(e,t,n),i=[this.getPieceFillClass(r)];return(this.lastLandingCoord.equalsValue(r)||this.lastStartingCoord.equalsValue(r))&&i.push("highlighted"),(this.chosenStartingCoord.equalsValue(r)||this.chosenLandingCoord.equalsValue(r))&&i.push("selected"),this.chosenFirstCapture.equalsValue(r)&&i.push("pre-captured"),i}},{key:"getPieceFillClass",value:function(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerPieceClass(this.state.getPieceAt(e).value)}},{key:"getPlayerPieceClass",value:function(e){return this.getPlayerClass(Zee.of(e))}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.remainingPieces[e],n=[],r=0;r<t;r++)n.push(r);return n}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.lastMove=this.rules.node.move;var e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=cB.empty(),this.lastMove.isPresent()?this.showLastMove():(this.lastLandingCoord=cB.empty(),this.lastStartingCoord=cB.empty(),this.lastFirstCapture=cB.empty(),this.lastSecondCapture=cB.empty(),this.chosenFirstCapture=cB.empty(),this.chosenStartingCoord=cB.empty(),this.chosenLandingCoord=cB.empty())}},{key:"showLastMove",value:function(){var e=this.lastMove.get();this.lastLandingCoord=cB.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.isDrawableCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}},{key:"isDrawableCoord",value:function(e){return this.isDrawable(e.x,e.y,e.z)}}]),n}(ere);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-pylos"]],features:[HC],decls:5,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 1021","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["x","0","y","0","width","800","height","800",1,"base"],["class","base captured",3,"id",4,"ngIf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base",3,"id","ngClass","click"],[1,"base","captured",3,"id"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),ob(1,xle,2,1,"g",1),db(2,"rect",2),ob(3,Lle,2,1,"g",1),ob(4,Fle,1,7,"rect",3),fb()),2&e&&(Ow(1),cb("ngForOf",tP(3,Ble)),Ow(2),cb("ngForOf",tP(4,Vle)),Ow(1),cb("ngIf",t.highCapture.isPresent()))},directives:[NT,DT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),zle=function(){function e(t){np(this,e),this.value=t}return ip(e,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"QuartoPiece("+this.value+")"}},{key:"isRectangle",value:function(){return this.value%4<2}}],[{key:"fromInt",value:function(t){if(0<=t&&t<=15)return e.pieces[t];if(16===t)return e.NONE;throw new Error("Invalid piece ("+t+")")}}]),e}();zle.AAAA=new zle(0),zle.AAAB=new zle(1),zle.AABA=new zle(2),zle.AABB=new zle(3),zle.ABAA=new zle(4),zle.ABAB=new zle(5),zle.ABBA=new zle(6),zle.ABBB=new zle(7),zle.BAAA=new zle(8),zle.BAAB=new zle(9),zle.BABA=new zle(10),zle.BABB=new zle(11),zle.BBAA=new zle(12),zle.BBAB=new zle(13),zle.BBBA=new zle(14),zle.BBBB=new zle(15),zle.NONE=new zle(16),zle.pieces=[zle.AAAA,zle.AAAB,zle.AABA,zle.AABB,zle.ABAA,zle.ABAB,zle.ABBA,zle.ABBB,zle.BAAA,zle.BAAB,zle.BABA,zle.BABB,zle.BBAA,zle.BBAB,zle.BBBA,zle.BBBB];var Hle=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,e,r)).piece=i,a}return ip(n,[{key:"toString",value:function(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}},{key:"equals",value:function(e){return this===e||!!e.coord.equals(this.coord)&&this.piece===e.piece}}]),n}(yre);Hle.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"maxValue",value:function(){return 496}},{key:"encodeNumber",value:function(e){return 128*e.coord.x+32*e.coord.y+e.piece.value}},{key:"decodeNumber",value:function(e){var t=e%32;e-=t;var n=(e/=32)%4;return e-=n,new Hle(e/=4,n,zle.fromInt(t))}}]),n}(jee));var Gle=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,e,r)).pieceInHand=i,a}return ip(n,[{key:"getRemainingPieces",value:function(){var e,t=[],r=Xv(zle.pieces);try{for(r.s();!(e=r.n()).done;){var i=e.value;n.isGivable(i,this.board,this.pieceInHand)&&t.push(i)}}catch(a){r.e(a)}finally{r.f()}return t}}],[{key:"getInitialState",value:function(){return new n(Q5.createTable(4,4,zle.NONE),0,zle.AAAA)}},{key:"isGivable",value:function(e,t,r){return e!==r&&!1===n.isAlreadyOnBoard(e,t)}},{key:"isAlreadyOnBoard",value:function(e,t){for(var n=0;n<4;n++)for(var r=0;r<4;r++)if(t[n][r]===e)return!0;return!1}}]),n}(vre),qle=function(){var e=ip(function e(){np(this,e)});return e.MUST_GIVE_A_PIECE=function(){return $localize(Jo||(Jo=Nv(["You must give a piece."])))},e.PIECE_ALREADY_ON_BOARD=function(){return $localize(Qo||(Qo=Nv(["That piece is already on the board."])))},e.CANNOT_GIVE_PIECE_IN_HAND=function(){return $localize(Xo||(Xo=Nv(["You cannot give the piece that was in your hands."])))},e}(),$le=function(){function e(t){np(this,e),this.subCriterion=[cB.empty(),cB.empty(),cB.empty(),cB.empty()],this.subCriterion[0]=cB.of(8==(8&t.value)),this.subCriterion[1]=cB.of(4==(4&t.value)),this.subCriterion[2]=cB.of(2==(2&t.value)),this.subCriterion[3]=cB.of(1==(1&t.value))}return ip(e,[{key:"mergeWith",value:function(e){for(var t=4,n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=cB.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}},{key:"mergeWithQuartoPiece",value:function(t){var n=new e(t);return this.mergeWith(n)}},{key:"areAllAbsent",value:function(){for(var e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}},{key:"match",value:function(e){for(var t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}},{key:"matchPiece",value:function(t){return this.match(new e(t))}},{key:"toString",value:function(){return"Criterion{"+this.subCriterion.map(function(e){return e.isPresent()?e.get()?"1":"0":"x"}).join(" ")+"}"}}]),e}(),Wle=function(){function e(t,n){np(this,e),this.initialCoord=t,this.direction=n}return ip(e,[{key:"allCoords",value:function(){for(var e=[],t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}]),e}(),jle=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t).toFallible(void 0)}},{key:"applyLegalMove",value:function(e,t){var n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.pieceInHand,new Gle(n,t.turn+1,e.piece)}},{key:"getGameStatus",value:function(e){var t,r=e.gameState,i={score:kre.DEFAULT,sensitiveSquares:new Die},a=Xv(n.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=n.updateBoardStatus(o,r,i)).score===kre.VICTORY)return n.scoreToGameStatus(i.score,r.turn)}}catch(s){a.e(s)}finally{a.f()}return n.scoreToGameStatus(i.score,r.turn)}},{key:"getVictoriousCoords",value:function(e){var t,r=Xv(n.lines);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(n.isThereAVictoriousLine(i,e))return i.allCoords()}}catch(a){r.e(a)}finally{r.f()}return[]}}],[{key:"isOccupied",value:function(e){return e!==zle.NONE}},{key:"isLegal",value:function(e,t){var r=e.coord.x,i=e.coord.y,a=e.piece,o=t.getCopiedBoard(),s=t.pieceInHand;return n.isOccupied(o[i][r])?$5.failure(ure.MUST_LAND_ON_EMPTY_SPACE()):a===zle.NONE?15===t.turn?$5.SUCCESS:$5.failure(qle.MUST_GIVE_A_PIECE()):Gle.isAlreadyOnBoard(a,o)?$5.failure(qle.PIECE_ALREADY_ON_BOARD()):s===a?$5.failure(qle.CANNOT_GIVE_PIECE_IN_HAND()):$5.SUCCESS}},{key:"updateBoardStatus",value:function(e,t,n){return n.score===kre.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:kre.VICTORY,sensitiveSquares:new Die}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}},{key:"isThereAVictoriousLine",value:function(e,t){for(var r=e.initialCoord,i=t.getPieceAt(r),a=new $le(i),o=0;o<3&&!1!==n.isOccupied(i)&&!a.areAllAbsent();o++)r=r.getNext(e.direction,1),i=t.getPieceAt(r),a.mergeWithQuartoPiece(i);return!(!n.isOccupied(i)||a.areAllAbsent())}},{key:"searchForVictoryOrPreVictoryInLine",value:function(e,t,r){var i=n.getLineInfos(e,t,r);if(i.boardStatus.isPresent())return i.boardStatus.get();var a=i.commonCriterion,o=i.sensitiveCoord;if(a.isPresent()&&!1===a.get().areAllAbsent()){if(o.isAbsent())return{score:kre.VICTORY,sensitiveSquares:new Die};a.get().matchPiece(t.pieceInHand)&&(r.score=kre.PRE_VICTORY);var s=o.get();r.sensitiveSquares.add(s)}return r}},{key:"getLineInfos",value:function(e,t,r){for(var i=cB.empty(),a=cB.empty(),o=e.initialCoord,s=0;s<4;s++){var u=t.getPieceAt(o);if(u===zle.NONE){if(!i.isAbsent())return{sensitiveCoord:cB.of(o),commonCriterion:a,boardStatus:cB.of(r)};i=cB.of(o)}else a.isAbsent()?(a=cB.of(new $le(u)),aB(n.VERBOSE,"set commonCrit to "+a.toString())):(a.get().mergeWithQuartoPiece(u),aB(n.VERBOSE,"update commonCrit: "+a.toString()));o=o.getNext(e.direction,1)}return{commonCriterion:a,sensitiveCoord:i,boardStatus:cB.empty()}}},{key:"scoreToGameStatus",value:function(e,t){var n=Zee.of(t%2);return e===kre.VICTORY?Ere.getDefeat(n):16===t?Ere.DRAW:Ere.ONGOING}}]),n}(Sre);jle.VERBOSE=!1,jle.lines=[new Wle(new Jne(0,0),Yne.DOWN),new Wle(new Jne(1,0),Yne.DOWN),new Wle(new Jne(2,0),Yne.DOWN),new Wle(new Jne(3,0),Yne.DOWN),new Wle(new Jne(0,0),Yne.RIGHT),new Wle(new Jne(0,1),Yne.RIGHT),new Wle(new Jne(0,2),Yne.RIGHT),new Wle(new Jne(0,3),Yne.RIGHT),new Wle(new Jne(0,0),Yne.DOWN_RIGHT),new Wle(new Jne(0,3),Yne.UP_RIGHT)];var Zle=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getRemainingPieces(),a=n.pieceInHand,o=0;o<4;o++)for(var s=0;s<4;s++)if(r[o][s]===zle.NONE){if(n.getCopiedBoard()[o][s]=a,15===n.turn){var u=new Hle(s,o,zle.NONE);return t.push(u),t}var c,l=Xv(i);try{for(l.s();!(c=l.n()).done;){var h=c.value,f=new Hle(s,o,h);t.push(f)}}catch(d){l.e(d)}finally{l.f()}}return t}},{key:"getBoardValue",value:function(e){var t,r=e.gameState,i={score:kre.DEFAULT,sensitiveSquares:new Die},a=Xv(jle.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=jle.updateBoardStatus(o,r,i)).score===kre.VICTORY)break}}catch(s){a.e(s)}finally{a.f()}return n.scoreToBoardValue(i.score,r.turn)}}],[{key:"scoreToBoardValue",value:function(e,t){if(e===kre.DEFAULT)return new lre(0);var n=Zee.of(t%2);return new lre(e===kre.PRE_VICTORY?n.getPreVictory():n.getDefeatValue())}}]),n}(cre),Yle=zle.AABA,Kle=zle.AABB,Jle=zle.ABAA,Qle=zle.ABAB,Xle=zle.ABBA,ehe=zle.BAAA,the=zle.BAAB,nhe=zle.BABB,rhe=zle.BBAA,ihe=zle.BBAB,ahe=zle.BBBA,ohe=zle.BBBB,she=zle.NONE,uhe=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(es||(es=Nv(["Goal of the game"]))),$localize(ts||(ts=Nv(["Quarto is an alignment game.\n        The goal is to align four pieces that have at least one common aspect:\n        <ul>\n          <li>their color (light or dark),</li>\n          <li>their size (big or small),</li>\n          <li>their pattern (empty or dotted),</li>\n          <li>their shape (round or square).</li>\n        </ul>\n        Here, we have a board with a victory by an alignment of dark pieces."]))),new Gle([[ahe,rhe,Jle,Yle],[she,she,she,she],[she,she,she,she],[she,she,she,she]],7,zle.ABAB)),Ire.anyMove($localize(ns||(ns=Nv(["Placement"]))),$localize(rs||(rs=Nv(["Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,\n        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.\n        If you prefer, the order of these two steps can be reversed.\n        Keep in mind that the second click confirms the move.<br/><br/>\n        Make a move."]))),new Gle([[ahe,Kle,Xle,she],[she,she,she,she],[she,ehe,she,she],[she,she,she,she]],7,zle.ABAA),new Hle(2,2,zle.BAAB),$localize(is||(is=Nv(["Perfect!"])))),Ire.fromMove($localize(as||(as=Nv(["Situation"]))),$localize(os||(os=Nv(["We have here a tricky situation.<br/><br/>\n        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move."]))),new Gle([[ohe,ahe,ihe,she],[Jle,nhe,rhe,she],[Qle,ehe,the,she],[she,she,she,she]],7,zle.AABA),[new Hle(3,3,zle.AABB)],$localize(ss||(ss=Nv(["Well done!"]))),$localize(us||(us=Nv(["Failed!"]))))]});function che(e,t){if(1&e&&(wm(),db(0,"rect",11)),2&e){var n=Cb(2),r=n.$implicit,i=n.index,a=Cb().index,o=Cb();cb("ngClass",o.getPieceClasses(r.value)),nb("x",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("y",o.SPACE_SIZE*a+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("width",2*o.getPieceSize(r.value))("height",2*o.getPieceSize(r.value))}}function lhe(e,t){if(1&e&&(wm(),db(0,"circle",11)),2&e){var n=Cb(2),r=n.$implicit,i=n.index,a=Cb().index,o=Cb();cb("ngClass",o.getPieceClasses(r.value)),nb("cx",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.SPACE_SIZE/2)("r",o.getPieceSize(r.value))}}function hhe(e,t){if(1&e&&(wm(),db(0,"circle")),2&e){var n=Cb(2).index,r=Cb().index,i=Cb();nb("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function fhe(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,che,1,5,"rect",9),ob(2,lhe,1,4,"ng-template",null,10,IP),ob(4,hhe,1,3,"circle",3),fb()),2&e){var n=sb(3),r=Cb().$implicit,i=Cb(2);Ow(1),cb("ngIf",r.isRectangle())("ngIfElse",n),Ow(3),cb("ngIf",i.pieceHasDot(r.value))}}function dhe(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"rect",8),kb("click",function(){var e=Wy(n).index,t=Cb().index;return Cb().chooseCoord(e,t)}),fb(),ob(2,fhe,5,3,"g",3),fb()}if(2&e){var r=t.$implicit,i=t.index,a=Cb().index,o=Cb();Ow(1),Eb("id","chooseCoord_",i,"_",a,""),cb("ngClass",o.getSquareClasses(i,a)),nb("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Ow(1),cb("ngIf",r!==o.EMPTY)}}function vhe(e,t){if(1&e&&(wm(),hb(0,"g",null,7),ob(2,dhe,3,8,"g",2),fb()),2&e){var n=t.$implicit;Ow(2),cb("ngForOf",n)}}function phe(e,t){if(1&e&&(wm(),db(0,"rect",15)),2&e){var n=Cb(2);cb("ngClass",n.getPieceClasses(n.pieceInHand.value)),nb("x",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("y",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function ghe(e,t){if(1&e&&(wm(),db(0,"circle",11)),2&e){var n=Cb(2);cb("ngClass",n.getPieceClasses(n.pieceInHand.value)),nb("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",n.getPieceSize(n.pieceInHand.value))}}function yhe(e,t){if(1&e&&(wm(),db(0,"circle")),2&e){var n=Cb(2);nb("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",10)}}function mhe(e,t){if(1&e&&(wm(),hb(0,"g",null,12),db(2,"rect",13),ob(3,phe,1,5,"rect",14),ob(4,ghe,1,4,"ng-template",null,10,IP),ob(6,yhe,1,3,"circle",3),fb()),2&e){var n=sb(5),r=Cb();nb("transform","translate("+r.chosen.get().x*r.SPACE_SIZE+" "+r.chosen.get().y*r.SPACE_SIZE+")"),Ow(2),nb("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),Ow(1),cb("ngIf",r.pieceInHand.isRectangle())("ngIfElse",n),Ow(3),cb("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function khe(e,t){if(1&e&&(wm(),hb(0,"g",null,16),db(2,"rect",17),fb()),2&e){var n=t.$implicit,r=Cb();Ow(2),nb("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)("transform","translate("+n.x*r.SPACE_SIZE+" "+n.y*r.SPACE_SIZE+")")}}function _he(e,t){if(1&e&&(wm(),db(0,"rect",11)),2&e){var n=Cb(2);cb("ngClass",n.getPieceClasses(n.pieceInHand.value)),nb("x",0)("y",.75*n.SPACE_SIZE)("transform","translate("+-n.getPieceSize(n.pieceInHand.value)+", "+-n.getPieceSize(n.pieceInHand.value)+")")("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function whe(e,t){if(1&e&&(wm(),db(0,"circle",19)),2&e){var n=Cb(2);cb("ngClass",n.getPieceClasses(n.pieceInHand.value)),nb("cy",.75*n.SPACE_SIZE)("r",n.getPieceSize(n.pieceInHand.value))}}function Che(e,t){1&e&&(wm(),db(0,"circle",20)),2&e&&nb("cy",.75*Cb(2).SPACE_SIZE)("r",10)}function bhe(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,_he,1,6,"rect",9),ob(2,whe,1,3,"ng-template",null,10,IP),ob(4,Che,1,2,"circle",18),fb()),2&e){var n=sb(3),r=Cb();Ow(1),cb("ngIf",r.pieceInHand.isRectangle())("ngIfElse",n),Ow(3),cb("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function Ehe(e,t){if(1&e&&(wm(),db(0,"rect",27)),2&e){var n=Cb(2).index,r=Cb().index,i=Cb();nb("x",i.SPACE_SIZE*n)("y",i.SPACE_SIZE*r)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function She(e,t){if(1&e&&(wm(),db(0,"rect",11)),2&e){var n=Cb(2).index,r=Cb().index,i=Cb();cb("ngClass",i.getPieceClasses(4*r+n)),nb("x",i.SPACE_SIZE*n+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("y",i.SPACE_SIZE*r+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("width",2*i.getPieceSize(4*r+n))("height",2*i.getPieceSize(4*r+n))}}function Phe(e,t){if(1&e&&(wm(),db(0,"circle",11)),2&e){var n=Cb(2).index,r=Cb().index,i=Cb();cb("ngClass",i.getPieceClasses(4*r+n)),nb("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.getPieceSize(4*r+n))}}function Ohe(e,t){if(1&e&&(wm(),db(0,"circle")),2&e){var n=Cb(2).index,r=Cb().index,i=Cb();nb("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function The(e,t){if(1&e){var n=gb();wm(),hb(0,"g",25),kb("click",function(){Wy(n);var e=Cb().index,t=Cb().index;return Cb().choosePiece(4*t+e)}),ob(1,Ehe,1,4,"rect",26),ob(2,She,1,5,"rect",9),ob(3,Phe,1,4,"ng-template",null,10,IP),ob(5,Ohe,1,3,"circle",3),fb()}if(2&e){var r=sb(4),i=Cb().index,a=Cb().index,o=Cb();bb("id","choosePiece_",4*a+i,""),Ow(1),cb("ngIf",o.pieceToGive.value===4*a+i),Ow(1),cb("ngIf",(4*a+i)%4<2)("ngIfElse",r),Ow(3),cb("ngIf",o.pieceHasDot(4*a+i))}}function Ihe(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,The,6,5,"g",24),fb()),2&e){var n=t.index,r=Cb().index,i=Cb();Ow(1),cb("ngIf",i.isRemaining(4*r+n))}}function xhe(e,t){if(1&e&&(wm(),hb(0,"g",null,21),db(2,"rect",22,23),ob(4,Ihe,2,1,"g",2),fb()),2&e){var n=t.$implicit,r=Cb();nb("transform","translate(0 "+6.5*r.SPACE_SIZE+")"),Ow(2),nb("x",-.125*r.SPACE_SIZE)("y",-.125*r.SPACE_SIZE)("width",4.25*r.SPACE_SIZE)("height",4.25*r.SPACE_SIZE),Ow(2),cb("ngForOf",n)}}var Ahe=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).EMPTY=zle.NONE,r.chosen=cB.empty(),r.lastMove=cB.empty(),r.pieceInHand=zle.NONE,r.pieceToGive=zle.NONE,r.victoriousCoords=[],r.rules=new jle(Gle),r.availableMinimaxes=[new Zle(r.rules,"QuartoMinimax")],r.encoder=Hle.encoder,r.tutorial=(new uhe).tutorial,r.pieceInHand=r.rules.node.gameState.pieceInHand,r.updateBoard(),r}return ip(n,[{key:"updateBoard",value:function(){var e=this.rules.node.gameState,t=this.rules.node.move;this.board=e.getCopiedBoard(),this.chosen=cB.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=t.map(function(e){return e.coord})}},{key:"chooseCoord",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#chooseCoord_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(n.hideLastMove(),n.board[t][e]!==zle.NONE){r.next=11;break}if(n.showPieceInHandOnBoard(e,t),15!==n.rules.node.gameState.turn){r.next=7;break}return a=new Hle(e,t,zle.NONE),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState));case 7:if(n.pieceToGive!==zle.NONE){r.next=9;break}return r.abrupt("return",$5.SUCCESS);case 9:return o=new Hle(e,t,n.pieceToGive),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 11:return r.abrupt("return",n.cancelMove(ure.MUST_CLICK_ON_EMPTY_SPACE()));case 12:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#choosePiece_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(t.hideLastMove(),t.pieceToGive=zle.fromInt(e),!t.chosen.isAbsent()){n.next=5;break}return n.abrupt("return",$5.SUCCESS);case 5:return i=t.chosen.get(),a=new Hle(i.x,i.y,t.pieceToGive),n.abrupt("return",t.chooseMove(a,t.rules.node.gameState));case 7:case"end":return n.stop()}},n)}))()}},{key:"hideLastMove",value:function(){this.lastMove=cB.empty()}},{key:"cancelMoveAttempt",value:function(){this.hideLastMove(),this.pieceToGive=zle.NONE}},{key:"showPieceInHandOnBoard",value:function(e,t){this.chosen=cB.of(new Jne(e,t))}},{key:"isRemaining",value:function(e){return Gle.isGivable(zle.fromInt(e),this.board,this.pieceInHand)}},{key:"getSquareClasses",value:function(e,t){var n=new Jne(e,t);return this.lastMove.equalsValue(n)?["moved"]:[]}},{key:"getPieceClasses",value:function(e){var t=[];return t.push(e%2==0?"player0":"player1"),t}},{key:"getPieceSize",value:function(e){return e<8?40:25}},{key:"pieceHasDot",value:function(e){return e!==zle.NONE.value&&e%8<4}}]),n}(lie);return e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-quarto"]],features:[HC],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],["chosenPiece",""],["id","highlight","x","0","y","0",1,"base","highlighted","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],[3,"id","click",4,"ngIf"],[3,"id","click"],["class","base highlighted",4,"ngIf"],[1,"base","highlighted"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),hb(1,"g",1),ob(2,vhe,3,1,"g",2),ob(3,mhe,7,6,"g",3),ob(4,khe,3,3,"g",2),hb(5,"g",null,4),db(7,"rect",5,6),ob(9,bhe,5,3,"g",3),fb(),ob(10,xhe,5,6,"g",2),fb(),fb()),2&e&&(nb("viewBox","0 0 "+4.25*t.SPACE_SIZE+" "+10.75*t.SPACE_SIZE),Ow(2),cb("ngForOf",t.board),Ow(1),cb("ngIf",t.chosen.isPresent()),Ow(1),cb("ngForOf",t.victoriousCoords),Ow(1),nb("transform","translate("+2*t.SPACE_SIZE+", "+4.5*t.SPACE_SIZE+")"),Ow(2),nb("width",1.5*t.SPACE_SIZE)("height",1.5*t.SPACE_SIZE)("transform","translate("+-.75*t.SPACE_SIZE+", 0)"),Ow(2),cb("ngIf",t.chosen.isAbsent()),Ow(1),cb("ngForOf",t.board))},directives:[NT,DT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Rhe=function(){var e=ip(function e(){np(this,e)});return e.NO_INSIDE_CLICK=function(){return $localize(cs||(cs=Nv(["You must pick a space from the edge of the board."])))},e}(),Nhe=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;np(this,n),(a=t.call(this,e,r)).direction=i;var o=n.isValidCoord(a.coord);if(o.isFailure())throw new Error(o.getReason());if(0===e&&i===Kne.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===e&&i===Kne.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===r&&i===Kne.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===r&&i===Kne.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.");return a}return ip(n,[{key:"toString",value:function(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.direction===this.direction}}],[{key:"isValidCoord",value:function(e){return e.isNotInRange(5,5)?$5.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&4!==e.x&&0!==e.y&&4!==e.y?$5.failure(Rhe.NO_INSIDE_CLICK()):$5.SUCCESS}}]),n}(yre);Nhe.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"maxValue",value:function(){return 128}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 20*e.coord.x+4*e.coord.y+t}},{key:"decodeNumber",value:function(e){var t=Kne.factory.fromInt(e%4).get();e-=e%4;var n=(e/=4)%5;return e-=e%5,new Nhe(e/=5,n,t)}}]),n}(jee));var Mhe=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"applyLegalMove",value:function(e){for(var t=this.getCopiedBoard(),r=this.turn+1,i=e.coord,a=e.coord.getNext(e.direction);a.isInRange(5,5);)t[i.y][i.x]=t[a.y][a.x],i=i.getNext(e.direction),a=a.getNext(e.direction);return t[i.y][i.x]=this.getCurrentPlayer(),new n(t,r)}}],[{key:"getInitialState",value:function(){return new n(Q5.createTable(5,5,Zee.NONE),0)}}]),n}(vre),Dhe=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?H5.failure(ure.CANNOT_CHOOSE_OPPONENT_PIECE()):H5.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getLinesSums(t),i=n.getFullestLine(r[Zee.ZERO.value]),a=n.getFullestLine(r[Zee.ONE.value]),o=t.getCurrentPlayer();return 5===i&&(o===Zee.ZERO||a<5)?Ere.ZERO_WON:5===a?Ere.ONE_WON:Ere.ONGOING}}],[{key:"getVerticalCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=0;r<5;r++)e.gameState.getPieceAtXY(0,r)!==t&&n.push(new Jne(0,r)),e.gameState.getPieceAtXY(4,r)!==t&&n.push(new Jne(4,r));return n}},{key:"getHorizontalCenterCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=1;r<4;r++)e.gameState.getPieceAtXY(r,0)!==t&&n.push(new Jne(r,0)),e.gameState.getPieceAtXY(r,4)!==t&&n.push(new Jne(r,4));return n}},{key:"getPossibleDirections",value:function(e){var t=[];return 0!==e.x&&t.push(Kne.LEFT),0!==e.y&&t.push(Kne.UP),4!==e.x&&t.push(Kne.RIGHT),4!==e.y&&t.push(Kne.DOWN),t}},{key:"getLinesSums",value:function(e){var t={};t[Zee.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[Zee.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(var n=0;n<5;n++)for(var r=0;r<5;r++){var i=e.getPieceAtXY(r,n).value;i!==Zee.NONE.value&&(t[i].columns[r]=t[i].columns[r]+1,t[i].rows[n]=t[i].rows[n]+1,r===n&&(t[i].diagonals[0]=t[i].diagonals[0]+1),r+n===4&&(t[i].diagonals[1]=t[i].diagonals[1]+1))}return t}},{key:"getVictoriousCoords",value:function(e){for(var t=n.getLinesSums(e),r=[],i=0;i<2;i++){for(var a=0;a<5;a++){if(5===t[i].columns[a])for(var o=0;o<5;o++)r.push(new Jne(a,o));if(5===t[i].rows[a])for(var s=0;s<5;s++)r.push(new Jne(s,a))}if(5===t[i].diagonals[0])for(var u=0;u<5;u++)r.push(new Jne(u,u));if(5===t[i].diagonals[1])for(var c=0;c<5;c++)r.push(new Jne(c,4-c))}return r}},{key:"getFullestLine",value:function(e){var t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max.apply(Math,Jv(t))}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}}]),n}(Sre),Lhe=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){var t,n=[],r=Dhe.getVerticalCoords(e),i=Xv(Dhe.getHorizontalCenterCoords(e).concat(r));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=Xv(Dhe.getPossibleDirections(o));try{for(s.s();!(a=s.n()).done;){var u=a.value,c=new Nhe(o.x,o.y,u);n.push(c)}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Dhe.getLinesSums(t),r=Dhe.getFullestLine(n[Zee.ZERO.value]),i=Dhe.getFullestLine(n[Zee.ONE.value]),a=t.getCurrentPlayer();return new lre(5===r&&(a===Zee.ZERO||i<5)?Zee.ZERO.getVictoryValue():5===i?Zee.ONE.getVictoryValue():i-r)}}]),n}(cre),Fhe=function(){function e(){np(this,e)}return ip(e,null,[{key:"getArrowTransform",value:function(e,t,n){var r,i,a;switch(n){case Kne.UP:r=0,i=-1,a=-90;break;case Kne.DOWN:r=0,i=1,a=90;break;case Kne.LEFT:r=-1,i=0,a=180;break;default:iB.expectToBe(n,Kne.RIGHT),r=1,i=0,a=0}return["translate(".concat(t.x*e+e/2+r*e/4," ").concat(t.y*e+e/2+i*e/4,")"),"scale(2.5)","rotate(".concat(a,")")].join(" ")}}]),e}(),Bhe=Zee.NONE,Vhe=Zee.ZERO,Uhe=Zee.ONE,zhe=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(ls||(ls=Nv(["Goal of the game."]))),$localize(hs||(hs=Nv(["At Quixo, the goal is to align 5 of your pieces.\n        The first player plays with dark pieces, the second with light pieces.\n        The board is made of 25 spaces spread over a 5x5 square.\n        Every piece has a neutral side, a light side, and a dark side."]))),Mhe.getInitialState()),Ire.fromMove($localize(fs||(fs=Nv(["What a move looks like (without animation)"]))),$localize(ds||(ds=Nv(["When it is your turn:\n        <ol>\n            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.\n                You can only choose a piece from the edge of the board.</li>\n            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>\n        </ol>\n        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.\n        Once on the other side, all pieces will move by one space in the opposing direction.\n        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>\n        For example, take the bottom right neutral piece, and move it to the left (you're playing Light)."]))),new Mhe([[Bhe,Bhe,Bhe,Bhe,Bhe],[Bhe,Bhe,Bhe,Bhe,Bhe],[Bhe,Bhe,Bhe,Bhe,Bhe],[Bhe,Bhe,Bhe,Bhe,Bhe],[Vhe,Vhe,Vhe,Vhe,Bhe]],1),[new Nhe(4,4,Kne.LEFT)],$localize(vs||(vs=Nv(["See how the four dark pieces have been moved one space to the right.\n        The neutral piece has been move 4 pieces to the left and has become light."]))),$localize(ps||(ps=Nv(["Failed!"])))),Ire.fromMove($localize(gs||(gs=Nv(["Victory"]))),$localize(ys||(ys=Nv(["You already know everything you need in order to play, but there is one last particularity.\n        If you create a line of 5 of your pieces, you win.\n        If you create a line of 5 of your opponent's pieces, you lose.\n        If you create both, you lose too!<br/><br/>\n        You can win with this board, try it.\n        You're playing Light."]))),new Mhe([[Bhe,Uhe,Bhe,Uhe,Uhe],[Bhe,Vhe,Vhe,Bhe,Vhe],[Uhe,Uhe,Uhe,Vhe,Uhe],[Vhe,Bhe,Vhe,Uhe,Uhe],[Uhe,Vhe,Bhe,Uhe,Vhe]],31),[new Nhe(3,0,Kne.DOWN)],$localize(ms||(ms=Nv(["Congratulations, you won!"]))),$localize(ks||(ks=Nv(["Failed!"]))))]});function Hhe(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"circle",4),kb("click",function(){var e=Wy(n).index,t=Cb().index;return Cb().onBoardClick(e,t)}),fb(),fb()}if(2&e){var r=t.index,i=Cb().index,a=Cb();Ow(1),Eb("id","click_",r,"_",i,""),cb("ngClass",a.getPieceClasses(r,i)),nb("cx",50+100*r)("cy",50+100*i)}}function Ghe(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,Hhe,2,5,"g",2),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}function qhe(e,t){if(1&e){var n=gb();wm(),hb(0,"use",6),kb("click",function(){var e=Wy(n).$implicit;return Cb(2).chooseDirection(e)}),fb()}if(2&e){var r=t.$implicit,i=Cb(2);bb("id","chooseDirection_",r,""),nb("transform",i.getArrowTransform(i.chosenCoord.get(),r))}}function $he(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,qhe,1,2,"use",5),fb()),2&e){var n=Cb();Ow(1),cb("ngForOf",n.getPossiblesDirections())}}var Whe=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).lastMoveCoord=cB.empty(),r.chosenCoord=cB.empty(),r.victoriousCoords=[],r.rules=new Dhe(Mhe),r.availableMinimaxes=[new Lhe(r.rules,"QuixoMinimax")],r.encoder=Nhe.encoder,r.tutorial=(new zhe).tutorial,r.updateBoard(),r}return ip(n,[{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.board=this.state.board,this.lastMoveCoord=this.rules.node.move.map(function(e){return e.coord}),this.victoriousCoords=Dhe.getVictoriousCoords(this.state)}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=cB.empty()}},{key:"getPieceClasses",value:function(e,t){var n=new Jne(e,t),r=[];return r.push(this.getPlayerClass(this.board[t][e])),this.chosenCoord.equalsValue(n)?r.push("selected"):this.lastMoveCoord.equalsValue(n)&&r.push("last-move"),this.victoriousCoords.some(function(e){return e.equals(n)})&&r.push("victory-stroke"),r}},{key:"onBoardClick",value:function(e,t){var n=this.canUserPlay("#click_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());var r=new Jne(e,t),i=Nhe.isValidCoord(r);return i.isFailure()?this.cancelMove(i.getReason()):this.board[t][e]===this.state.getCurrentOpponent()?this.cancelMove(ure.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord=cB.of(r),$5.SUCCESS)}},{key:"getPossiblesDirections",value:function(){var e=[],t=this.chosenCoord.get();return 4!==t.x&&e.push("RIGHT"),0!==t.x&&e.push("LEFT"),4!==t.y&&e.push("DOWN"),0!==t.y&&e.push("UP"),e}},{key:"chooseDirection",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#chooseDirection_"+e)).isFailure()){n.next=5;break}n.t0=t.cancelMove(r.getReason()),n.next=9;break;case 5:return t.chosenDirection=Kne.factory.fromString(e).get(),n.next=8,t.tryMove();case 8:n.t0=n.sent;case 9:return n.abrupt("return",n.t0);case 10:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new Nhe(n.x,n.y,e.chosenDirection),t.abrupt("return",(e.cancelMove(),e.chooseMove(r,e.rules.node.gameState)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getArrowTransform",value:function(e,t){return Fhe.getArrowTransform(this.SPACE_SIZE,e,Kne.factory.fromString(t).get())}}]),n}(lie);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-quixo"]],features:[HC],decls:5,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 500 500","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -3.5, 10 0, 0 3.5"],[4,"ngFor","ngForOf"],[4,"ngIf"],["r","45",1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",3,"id","click"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),hb(1,"defs"),db(2,"polygon",1),fb(),ob(3,Ghe,2,1,"g",2),ob(4,$he,2,1,"g",3),fb()),2&e&&(Ow(3),cb("ngForOf",t.board),Ow(1),cb("ngIf",t.chosenCoord.isPresent()))},directives:[NT,DT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),jhe=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"countScore",value:function(){for(var e=[0,0],t=0;t<n.BOARD_HEIGHT;t++)for(var r=0;r<n.BOARD_WIDTH;r++){var i=this.board[t][r];i!==Zee.NONE&&(e[i.value]+=1)}return e}}],[{key:"getInitialState",value:function(){var e=Q5.createTable(n.BOARD_WIDTH,n.BOARD_HEIGHT,Zee.NONE);return e[3][3]=Zee.ZERO,e[4][4]=Zee.ZERO,e[3][4]=Zee.ONE,e[4][3]=Zee.ONE,new n(e,0)}},{key:"getNeighbooringPawnLike",value:function(e,t,n,r){for(var i,a=[],o=-1;o<2;o++)for(var s=-1;s<2;s++)(i=new Jne(n+s,r+o)).isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[i.y][i.x]===t&&a.push(i);return a}}]),n}(vre);return e.BOARD_WIDTH=8,e.BOARD_HEIGHT=8,e}(),Zhe=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"equals",value:function(e){return e===this||e.coord.equals(this.coord)}},{key:"toString",value:function(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(yre);Zhe.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"maxValue",value:function(){return(jhe.BOARD_HEIGHT-1)*jhe.BOARD_WIDTH+(jhe.BOARD_WIDTH-1)}},{key:"encodeNumber",value:function(e){return e.coord.y*jhe.BOARD_WIDTH+e.coord.x}},{key:"decodeNumber",value:function(e){var t=e%jhe.BOARD_WIDTH;return new Zhe(t,(e-t)/jhe.BOARD_WIDTH)}}]),n}(jee)),Zhe.PASS=new Zhe(-1,-1),Zhe.PASS_NUMBER=Zhe.encoder.encodeNumber(Zhe.PASS);var Yhe=function(){var e=ip(function e(){np(this,e)});return e.NO_ELEMENT_SWITCHED=function(){return $localize(_s||(_s=Nv(["Your move should switch at least one piece."])))},e}(),Khe=ip(function e(t,n){np(this,e),this.move=t,this.switched=n}),Jhe=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.turn,i=t.getCurrentPlayer(),a=t.getCopiedBoard();if(e.equals(Zhe.PASS))return new jhe(a,r+1);var o,s=Xv(n);try{for(s.s();!(o=s.n()).done;){var u=o.value;a[u.y][u.x]=i}}catch(c){s.e(c)}finally{s.f()}return a[e.coord.y][e.coord.x]=i,new jhe(a,r+1)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}},{key:"isLegal",value:function(e,t){var r=t.getCopiedBoard();if(e.equals(Zhe.PASS))return n.playerCanOnlyPass(t)?H5.success([]):H5.failure(ure.MUST_PASS());if(r[e.coord.y][e.coord.x]!==Zee.NONE)return aB(n.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),H5.failure(ure.MUST_CLICK_ON_EMPTY_SPACE());var i=n.getAllSwitcheds(e,t.getCurrentPlayer(),r);return aB(n.VERBOSE,"ReversiRules.isLegal: "+i.length+" element(s) switched"),0===i.length?H5.failure(Yhe.NO_ELEMENT_SWITCHED()):H5.success(i)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;if(!1===n.isGameEnded(t))return Ere.ONGOING;var r=t.countScore(),i=r[1]-r[0];return i<0?Ere.ZERO_WON:i>0?Ere.ONE_WON:Ere.DRAW}},{key:"getAllSwitcheds",value:function(e,t,r){var i,a=[],o=t.getOpponent(),s=Xv(Yne.DIRECTIONS);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=e.coord.getNext(u);if(c.isInRange(jhe.BOARD_WIDTH,jhe.BOARD_HEIGHT)&&r[c.y][c.x]===o){var l,h=Xv(n.getSandwicheds(t,u,c,r));try{for(h.s();!(l=h.n()).done;){var f=l.value;a.push(f)}}catch(d){h.e(d)}finally{h.f()}}}}catch(d){s.e(d)}finally{s.f()}return a}},{key:"getSandwicheds",value:function(e,t,n,r){for(var i=[n],a=n.getNext(t);a.isInRange(jhe.BOARD_WIDTH,jhe.BOARD_HEIGHT);){var o=r[a.y][a.x];if(o===e)return i;if(o===Zee.NONE)return[];i.push(a),a=a.getNext(t)}return[]}},{key:"isGameEnded",value:function(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}},{key:"playerCanOnlyPass",value:function(e){var t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(Zhe.PASS)}},{key:"nextPlayerCantOnlyPass",value:function(e){var t=e.getCopiedBoard(),n=new jhe(t,e.turn+1);return this.playerCanOnlyPass(n)}},{key:"getListMoves",value:function(e){for(var t,r=[],i=e.getCurrentPlayer(),a=e.getCurrentOpponent(),o=0;o<8;o++)for(var s=0;s<8;s++)if(e.getPieceAtXY(s,o)===Zee.NONE&&(t=e.getCopiedBoard(),jhe.getNeighbooringPawnLike(t,a,s,o).length>0)){var u=new Zhe(s,o),c=n.getAllSwitcheds(u,i,t);if(c.length>0){var l,h=Xv(c);try{for(h.s();!(l=h.n()).done;){var f=l.value;Z5(i!==e.getPieceAt(f),f+"was already switched!"),t[f.y][f.x]=i}}catch(d){h.e(d)}finally{h.f()}t[o][s]=i,r.push(new Khe(u,c.length))}}return 0===r.length&&r.push(new Khe(Zhe.PASS,0)),r}}]),n}(Sre);return e.VERBOSE=!1,e}(),Qhe=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getBoardValue",value:function(e){var t=Jhe.getGameStatus(e);if(t.isEndGame)return lre.fromWinner(t.winner);for(var n=e.gameState.getCopiedBoard(),r=0,i=0,a=0;a<jhe.BOARD_HEIGHT;a++)for(var o=0;o<jhe.BOARD_WIDTH;o++){var s=(0===o||o===jhe.BOARD_WIDTH-1?4:1)*(0===a||a===jhe.BOARD_HEIGHT-1?4:1);n[a][o]===Zee.ZERO&&(r+=s),n[a][o]===Zee.ONE&&(i+=s)}return r*=Zee.ZERO.getScoreModifier(),i*=Zee.ONE.getScoreModifier(),new lre(i+r)}},{key:"getListMoves",value:function(e){var t=Jhe.getListMoves(e.gameState);return Q5.sortByDescending(t,function(e){return n.bestCoords.some(function(t){return e.move.coord.equals(t)})?100:e.switched}),t.map(function(e){return e.move})}}]),n}(cre);Qhe.bestCoords=[new Jne(0,0),new Jne(0,jhe.BOARD_HEIGHT-1),new Jne(jhe.BOARD_WIDTH-1,0),new Jne(jhe.BOARD_WIDTH-1,jhe.BOARD_HEIGHT-1)];var Xhe=Zee.NONE,efe=Zee.ZERO,tfe=Zee.ONE,nfe=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(ws||(ws=Nv(["Goal of the game"]))),$localize(Cs||(Cs=Nv(["At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.\n        When one piece is flipped, its owner changes.\n        The player owning the most pieces at the end of the game wins.\n        Here, Dark has 28 points and Light has 36, hence Light wins."]))),new jhe([[efe,efe,efe,efe,efe,efe,efe,efe],[efe,tfe,tfe,tfe,tfe,tfe,tfe,efe],[efe,tfe,tfe,tfe,tfe,tfe,tfe,efe],[efe,tfe,tfe,tfe,tfe,tfe,tfe,efe],[efe,tfe,tfe,tfe,tfe,tfe,tfe,efe],[efe,tfe,tfe,tfe,tfe,tfe,tfe,efe],[efe,tfe,tfe,tfe,tfe,tfe,tfe,efe],[efe,efe,efe,efe,efe,efe,efe,efe]],60)),Ire.anyMove($localize(bs||(bs=Nv(["Capture (1/2)"]))),$localize(Es||(Es=Nv(["At the beginning of the game, pieces are placed as shown here.\n        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>\n        Do any move by clicking to put your piece\n        Dark plays first."]))),jhe.getInitialState(),new Zhe(2,4),$localize(Ss||(Ss=Nv(["Congratulations!"])))),Ire.fromMove($localize(Ps||(Ps=Nv(["Capture (2/2)"]))),$localize(Os||(Os=Nv(["A move can also capture a bigger line, and more than one lines at a time\n        You're playing light here.<br/><br/>\n        Play on the bottom left to see an example."]))),new jhe([[Xhe,Xhe,Xhe,Xhe,Xhe,Xhe,Xhe,Xhe],[Xhe,Xhe,Xhe,Xhe,Xhe,Xhe,Xhe,Xhe],[Xhe,Xhe,Xhe,Xhe,Xhe,Xhe,Xhe,Xhe],[Xhe,Xhe,Xhe,Xhe,tfe,Xhe,Xhe,Xhe],[Xhe,Xhe,Xhe,efe,Xhe,Xhe,Xhe,Xhe],[Xhe,Xhe,efe,Xhe,Xhe,Xhe,Xhe,Xhe],[efe,efe,Xhe,Xhe,Xhe,Xhe,Xhe,Xhe],[Xhe,efe,tfe,efe,tfe,efe,Xhe,Xhe]],1),[new Zhe(0,7)],$localize(Ts||(Ts=Nv(["Congratulations!"]))),$localize(Is||(Is=Nv(["Lower and more to the left, please."])))),Ire.informational($localize(xs||(xs=Nv(["Passing a turn"]))),$localize(As||(As=Nv(["If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass\n        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way."]))),new jhe([[tfe,efe,efe,efe,efe,efe,tfe,efe],[efe,tfe,tfe,tfe,tfe,tfe,tfe,efe],[efe,tfe,tfe,tfe,tfe,tfe,tfe,efe],[efe,tfe,tfe,tfe,tfe,tfe,tfe,efe],[efe,tfe,tfe,tfe,tfe,tfe,tfe,efe],[efe,tfe,tfe,tfe,tfe,tfe,tfe,efe],[tfe,tfe,tfe,tfe,tfe,tfe,Xhe,Xhe],[efe,efe,efe,efe,efe,efe,Xhe,Xhe]],60))]});function rfe(e,t){if(1&e&&(wm(),db(0,"circle",4)),2&e){var n=Cb().index,r=Cb().index,i=Cb();cb("ngClass",i.getPieceClass(n,r)),nb("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)}}function ife(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"rect",2),kb("click",function(){var e=Wy(n).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),ob(2,rfe,1,4,"circle",3),fb()}if(2&e){var r=t.index,i=Cb().index,a=Cb();Ow(1),Eb("id","click_",r,"_",i,""),cb("ngClass",a.getRectClasses(r,i)),nb("x",a.SPACE_SIZE*r)("y",a.SPACE_SIZE*i)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Ow(1),cb("ngIf",a.board[i][r]!==a.NONE)}}function afe(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,ife,3,8,"g",1),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}var ofe=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).NONE=Zee.NONE,r.lastMove=new Jne(-2,-2),r.captureds=[],r.scores=cB.of([2,2]),r.rules=new Jhe(jhe),r.availableMinimaxes=[new Qhe(r.rules,"ReversiMinimax")],r.encoder=Zhe.encoder,r.tutorial=(new nfe).tutorial,r.canPass=!1,r.updateBoard(),r}return ip(n,[{key:"onClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new Zhe(e,t),r.next=6,n.chooseMove(a,n.rules.node.gameState,n.scores.get());case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.captureds=[],this.rules.node.move.isPresent()?this.showPreviousMove():this.lastMove=new Jne(-2,-2),this.scores=cB.of(e.countScore()),this.canPass=Jhe.playerCanOnlyPass(e)}},{key:"showPreviousMove",value:function(){this.lastMove=this.rules.node.move.get().coord;var e,t=this.rules.node.gameState.getCurrentPlayer(),n=this.rules.node.gameState.getCurrentOpponent(),r=Xv(Yne.DIRECTIONS);try{for(r.s();!(e=r.n()).done;)for(var i=e.value,a=this.lastMove.getNext(i,1);a.isInRange(jhe.BOARD_WIDTH,jhe.BOARD_HEIGHT)&&this.rules.node.gameState.getPieceAt(a)===n&&this.rules.node.mother.get().gameState.getPieceAt(a)===t;)this.captureds.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}}},{key:"getRectClasses",value:function(e,t){var n=new Jne(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured"]:n.equals(this.lastMove)?["moved"]:[]}},{key:"getPieceClass",value:function(e,t){return this.getPlayerClass(this.board[t][e])}},{key:"pass",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(Z5(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(Zhe.PASS.coord.x,Zhe.PASS.coord.y)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(lie);return e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-reversi"]],features:[HC],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),ob(1,afe,2,1,"g",1),fb()),2&e&&(nb("viewBox","0 -4 "+8*t.SPACE_SIZE+" "+(10+8*t.SPACE_SIZE)),Ow(1),cb("ngForOf",t.board))},directives:[NT,AT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),sfe=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,null,[{key:"getInitialState",value:function(){var e=nre.NONE,t=nre.ZERO,r=nre.ONE,i=nre.EMPTY;return new n([[e,e,t,r,i,i,i,t,r,e,e],[e,i,i,i,i,i,i,i,i,i,e],[r,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,r],[e,i,i,i,i,i,i,i,i,i,e],[e,e,r,t,i,i,i,r,t,e,e]],0)}}]),n}(sae);return e.HEIGHT=6,e.WIDTH=11,e}(),ufe=function(){var e=ip(function e(){np(this,e)});return e.CAN_ONLY_REBOUND_ON_BLACK=function(){return $localize(Rs||(Rs=Nv(["You can only rebound on dark spaces."])))},e.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=function(){return $localize(Ns||(Ns=Nv(["You can only rebound on empty spaces."])))},e.MUST_CHOOSE_PYRAMID_FIRST=function(){return $localize(Ms||(Ms=Nv(["You must pick one of your pyramids first."])))},e.MUST_CHOOSE_OWN_PYRAMID=function(){return $localize(Ds||(Ds=Nv(["You must pick one of your pyramids."])))},e.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=function(){return $localize(Ls||(Ls=Nv(["Those two spaces are not neighbors."])))},e.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=function(){return $localize(Fs||(Fs=Nv(["Those two spaces have no intermediary neighbor."])))},e}(),cfe=function(e){qv(n,e);var t=Wv(n);function n(e,r){return np(this,n),t.call(this,e,r)}return ip(n,[{key:"isSimpleStep",value:function(){return Math.abs(this.coord.x-this.end.x)+Math.abs(this.coord.y-this.end.y)===1}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"SaharaMove("+this.coord+"->"+this.end+")"}}],[{key:"checkDistanceAndLocation",value:function(e,t){var n=Math.abs(e.x-t.x)+Math.abs(e.y-t.y);if(0===n)return $5.failure(ure.MOVE_CANNOT_BE_STATIC());if(1===n){var r=oae.getFakeNeighbors(e);if(t.equals(r))return $5.failure(ufe.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return $5.failure($localize(Bs||(Bs=Nv(["You can move one or two spaces, not ","."])),n));if((e.x+e.y)%2==0)return $5.failure(ufe.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return $5.failure(ufe.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return $5.SUCCESS}},{key:"from",value:function(e,t){if(!e.isInRange(sfe.WIDTH,sfe.HEIGHT))throw new Error("Move must start inside the board not at "+e.toString()+".");if(!t.isInRange(sfe.WIDTH,sfe.HEIGHT))throw new Error("Move must end inside the board not at "+t.toString()+".");var r=n.checkDistanceAndLocation(e,t);return r.isFailure()?r.toFailedFallible():H5.success(new n(e,t))}}]),n}(_ie);cfe.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"maxValue",value:function(){return 396*sfe.WIDTH+66*sfe.HEIGHT+6*sfe.WIDTH+sfe.HEIGHT}},{key:"encodeNumber",value:function(e){return 396*e.coord.x+66*e.coord.y+6*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){var t=e%6;e-=t;var n=(e/=6)%11;e-=n;var r=(e/=11)%6;return e-=r,cfe.from(new Jne(e/=6,r),new Jne(n,t)).get()}}]),n}(jee));var lfe=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"applyLegalMove",value:function(e,t,r){aB(n.VERBOSE,"Legal move "+e.toString()+" applied");var i=t.getCopiedBoard();return i[e.end.y][e.end.x]=i[e.coord.y][e.coord.x],i[e.coord.y][e.coord.x]=nre.EMPTY,new sfe(i,t.turn+1)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).value!==t.getCurrentPlayer().value)return H5.failure(ure.CANNOT_CHOOSE_OPPONENT_PIECE());if(t.getPieceAt(e.end)!==nre.EMPTY)return H5.failure(ure.MUST_LAND_ON_EMPTY_SPACE());var n=oae.getCommonNeighbor(e.coord,e.end);return n.isPresent()?t.getPieceAt(n.get())===nre.EMPTY?H5.success(void 0):H5.failure(ufe.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):H5.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getCopiedBoard(),r=n.getBoardValuesFor(t,Zee.ZERO),i=n.getBoardValuesFor(t,Zee.ONE);return n.getGameStatusFromFreedoms(r,i)}}],[{key:"getStartingCoords",value:function(e,t){for(var n=[],r=0;r<sfe.HEIGHT;r++)for(var i=0;i<sfe.WIDTH;i++)e[r][i].is(t)&&n.push(new Jne(i,r));return n}},{key:"getBoardValuesFor",value:function(e,t){var r,i=[],a=Xv(n.getStartingCoords(e,t));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=sae.getEmptyNeighbors(e,o,nre.EMPTY).length;if(0===s)return[0];i.push(s)}}catch(u){a.e(u)}finally{a.f()}return i.sort(function(e,t){return e-t})}},{key:"getGameStatusFromFreedoms",value:function(e,t){return 0===e[0]?Ere.ONE_WON:0===t[0]?Ere.ZERO_WON:Ere.ONGOING}}]),n}(Sre);return e.VERBOSE=!1,e}(),hfe=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState.getCopiedBoard(),i=e.gameState.getCurrentPlayer(),a=Xv(lfe.getStartingCoords(r,i));try{for(a.s();!(t=a.n()).done;){var o,s=t.value,u=Xv(sae.getEmptyNeighbors(r,s,nre.EMPTY));try{for(u.s();!(o=u.n()).done;){var c=o.value,l=cfe.from(s,c).get();if(r[c.y][c.x]=r[s.y][s.x],r[s.y][s.x]=nre.EMPTY,n.push(l),(c.y+c.x)%2==0){var h,f=Xv(sae.getEmptyNeighbors(r,c,nre.EMPTY));try{for(f.s();!(h=f.n()).done;){var d=h.value;if(!d.equals(s)){var v=cfe.from(s,d).get();r[d.y][d.x]=r[c.y][c.x],r[c.y][c.x]=nre.EMPTY,n.push(v),r[c.y][c.x]=r[d.y][d.x],r[d.y][d.x]=nre.EMPTY}}}catch(p){f.e(p)}finally{f.f()}}r[s.y][s.x]=r[c.y][c.x],r[c.y][c.x]=nre.EMPTY}}catch(p){u.e(p)}finally{u.f()}}}catch(p){a.e(p)}finally{a.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState.getCopiedBoard(),n=lfe.getBoardValuesFor(t,Zee.ZERO),r=lfe.getBoardValuesFor(t,Zee.ONE),i=lfe.getGameStatusFromFreedoms(n,r);if(i.isEndGame)return lre.fromWinner(i.winner);for(var a=0;a<6&&n[a]===r[a];)a++;return new lre(r[a%6]-n[a%6])}}]),n}(cre),ffe=nre.NONE,dfe=nre.ZERO,vfe=nre.ONE,pfe=nre.EMPTY,gfe=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(Vs||(Vs=Nv(["Initial board"]))),$localize(Us||(Us=Nv(["S\xe2h\xe2r\xe2 is played on a board where each space is a triangle.\n        Each player has six pyramids."]))),sfe.getInitialState()),Ire.informational($localize(zs||(zs=Nv(["Goal of the game"]))),$localize(Hs||(Hs=Nv(["At S\xe2h\xe2r\xe2, the goal of the game is to immobilize one of the opponent's pyramids.\n        To do so, you have to occupy all neighboring space of that pyramid.\n        Here, Light has lost because its leftmost pyramid is immobilized."]))),new sfe([[ffe,ffe,pfe,pfe,vfe,pfe,pfe,dfe,vfe,ffe,ffe],[ffe,pfe,pfe,pfe,pfe,pfe,pfe,pfe,pfe,pfe,ffe],[vfe,dfe,pfe,pfe,pfe,pfe,pfe,pfe,pfe,pfe,dfe],[dfe,pfe,pfe,pfe,pfe,pfe,pfe,pfe,pfe,pfe,vfe],[ffe,pfe,pfe,pfe,pfe,pfe,pfe,pfe,pfe,pfe,ffe],[ffe,ffe,vfe,dfe,pfe,pfe,pfe,vfe,dfe,ffe,ffe]],3)),Ire.fromPredicate($localize(Gs||(Gs=Nv(["Simple step"]))),$localize(qs||(qs=Nv(["To immobilize your opponent, you have to move your pyramids.\n        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).\n        You're the first player, playing with the dark pyramids.\n        <ol>\n            <li>Click on one of your pyramids.</li>\n            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>\n        </ol><br/>\n        Do any simple step."]))),sfe.getInitialState(),cfe.from(new Jne(2,0),new Jne(2,1)).get(),function(e,t){return e.isSimpleStep()?$5.SUCCESS:$5.failure($localize($s||($s=Nv(["You have made a double step, which is good but it is the next exercise!"]))))},$localize(Ws||(Ws=Nv(["Congratulations!"])))),Ire.fromPredicate($localize(js||(js=Nv(["Double step"]))),$localize(Zs||(Zs=Nv(["When a pyramid shares its vertices with dark spaces, it can move one or two steps.\n        To do so:\n        <ol>\n            <li>Click on the pyramid to move.</li>\n            <li>Click on one of the 6 destinations that you can reach in two steps:\n                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.\n        </ol>"]))),sfe.getInitialState(),cfe.from(new Jne(7,0),new Jne(5,0)).get(),function(e,t){return e.isSimpleStep()?$5.failure($localize(Ys||(Ys=Nv(["Failed! You have made a single step."])))):$5.SUCCESS},$localize(Ks||(Ks=Nv(["Congratulations!"]))))]});function yfe(e,t){if(1&e&&(wm(),hb(0,"g"),db(1,"polyline",6),fb()),2&e){var n=Cb().index,r=Cb().index,i=Cb();Ow(1),cb("ngClass",i.getPlayerClassFor(n,r)),nb("points",i.getPyramidCoordinate(n,r))}}function mfe(e,t){if(1&e&&(wm(),db(0,"polyline",9)),2&e){var n=Cb(2).index,r=Cb().index;nb("points",Cb().getTriangleCoordinate(n,r))}}function kfe(e,t){if(1&e&&(wm(),db(0,"polyline",10)),2&e){var n=Cb(2).index,r=Cb().index;nb("points",Cb().getTriangleCoordinate(n,r))}}function _fe(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,mfe,1,1,"polyline",7),ob(2,kfe,1,1,"polyline",8),fb()),2&e){var n=Cb().index,r=Cb().index;Ow(1),cb("ngIf",(n+r)%2==1),Ow(1),cb("ngIf",(n+r)%2==0)}}function wfe(e,t){if(1&e){var n=gb();wm(),hb(0,"g",5),kb("click",function(){var e=Wy(n).index,t=Cb().index;return Cb().onClick(e,t)}),ob(1,yfe,2,2,"g",2),ob(2,_fe,3,2,"g",2),fb()}if(2&e){var r=t.$implicit;Eb("id","click_",t.index,"_",Cb().index,""),Ow(1),cb("ngIf",r.isPlayer()),Ow(1),cb("ngIf",2===r.value)}}function Cfe(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,wfe,3,4,"g",4),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}function bfe(e,t){if(1&e&&(wm(),vb(0),db(1,"polyline",11),db(2,"polyline",11),pb()),2&e){var n=Cb();Ow(1),nb("points",n.getTriangleCoordinate(n.lastCoord.get().x,n.lastCoord.get().y)),Ow(1),nb("points",n.getTriangleCoordinate(n.lastMoved.get().x,n.lastMoved.get().y))}}function Efe(e,t){if(1&e&&(wm(),db(0,"polyline",12)),2&e){var n=Cb();nb("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}var Sfe=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).lastCoord=cB.empty(),r.lastMoved=cB.empty(),r.chosenCoord=cB.empty(),r.rules=new lfe(sfe),r.availableMinimaxes=[new hfe(r.rules,"SaharaMinimax")],r.encoder=cfe.encoder,r.tutorial=(new gfe).tutorial,r.updateBoard(),r}return ip(n,[{key:"cancelMoveAttempt",value:function(){this.chosenCoord=cB.empty()}},{key:"onClick",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.chosenCoord.isAbsent()?n.choosePiece(e,t):n.chooseLandingCoord(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){return this.board[t][e]===nre.EMPTY?this.cancelMove(ufe.MUST_CHOOSE_PYRAMID_FIRST()):this.board[t][e].value===this.getTurn()%2?(this.chosenCoord=cB.of(new Jne(e,t)),$5.SUCCESS):this.cancelMove(ufe.MUST_CHOOSE_OWN_PYRAMID())}},{key:"chooseLandingCoord",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new Jne(e,t),a=n.rules.node.gameState.getCurrentPlayer(),o=nre.ofPlayer(a),n.board[t][e]!==o){r.next=3;break}return r.abrupt("return",(n.chosenCoord=cB.of(new Jne(e,t)),$5.SUCCESS));case 3:if(!(s=cfe.from(n.chosenCoord.get(),i)).isFailure()){r.next=8;break}r.t0=n.cancelMove(s.getReason()),r.next=11;break;case 8:return r.next=10,n.chooseMove(s.get(),n.rules.node.gameState);case 10:r.t0=r.sent;case 11:return r.abrupt("return",r.t0);case 12:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.chosenCoord=cB.empty();var e=this.rules.node.move;this.lastCoord=e.map(function(e){return e.coord}),this.lastMoved=e.map(function(e){return e.end}),this.board=this.rules.node.gameState.board}},{key:"getPlayerClassFor",value:function(e,t){return this.getPlayerClass(Zee.of(this.board[t][e].value))}}]),n}(nae);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-sahara"]],features:[HC],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill small-stroke selected",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],[1,"base","no-fill","small-stroke","highlighted"],[1,"base","no-fill","small-stroke","selected"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),ob(1,Cfe,2,1,"g",1),ob(2,bfe,3,2,"ng-container",2),ob(3,Efe,1,1,"polyline",3),fb()),2&e&&(Ow(1),cb("ngForOf",t.board),Ow(1),cb("ngIf",t.lastMoved.isPresent()),Ow(1),cb("ngIf",t.chosenCoord.isPresent()))},directives:[NT,DT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Pfe=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a){var o;return np(this,n),(o=t.call(this,e,r)).x=e,o.y=r,o.moveDirection=i,o.landingOrientation=a,o.checkValidity(),o}return ip(n,[{key:"checkValidity",value:function(){var e=this.coord.isInRange(5,5);if(this.isRotation()){if(!e)throw new Error("Cannot rotate piece outside the board: "+this.toString()+".")}else if(this.coord.getNext(this.moveDirection.get()).isNotInRange(5,5)){if(!e)throw new Error("SiamMove should end or start on the board: "+this.toString()+".");if(this.moveDirection.get()!==this.landingOrientation)throw new Error("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+this.toString()+".")}}},{key:"isRotation",value:function(){return this.moveDirection.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||!1===this.moveDirection.equals(e.moveDirection))&&this.landingOrientation===e.landingOrientation}},{key:"toString",value:function(){var e=this.moveDirection.isAbsent()?"-":this.moveDirection.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}},{key:"isInsertion",value:function(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}]),n}(yre);Pfe.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"maxValue",value:function(){return 2408}},{key:"encodeNumber",value:function(e){var t=e.coord.y+1,n=e.coord.x+1,r=e.moveDirection.isAbsent()?4:e.moveDirection.get().toInt();return 245*e.landingOrientation.toInt()+49*r+7*n+t}},{key:"decodeNumber",value:function(e){var t=e%7;e-=t;var n=(e/=7)%7;e-=n;var r=(e/=7)%5,i=4===r?cB.empty():Kne.factory.fromInt(r).toOptional();e-=r;var a=Kne.factory.fromInt(e/=5).get();return new Pfe(n-1,t-1,i,a)}}]),n}(jee));var Ofe=function(){function e(t){np(this,e),this.value=t}return ip(e,[{key:"belongTo",value:function(e){return e===Zee.ZERO?1<=this.value&&this.value<=4:e===Zee.ONE&&5<=this.value&&this.value<=8}},{key:"isEmptyOrMountain",value:function(){return 0===this.value||9===this.value}},{key:"isPiece",value:function(){return!this.isEmptyOrMountain()}},{key:"getOwner",value:function(){return 1<=this.value&&this.value<=4?Zee.ZERO:5<=this.value&&this.value<=8?Zee.ONE:Zee.NONE}},{key:"getOptionalDirection",value:function(){switch(this.value){case 0:return cB.empty();case 1:case 5:return cB.of(Kne.UP);case 2:case 6:return cB.of(Kne.RIGHT);case 3:case 7:return cB.of(Kne.DOWN);case 4:case 8:return cB.of(Kne.LEFT);default:return iB.expectToBe(this.value,9),cB.empty()}}},{key:"getDirection",value:function(){return this.getOptionalDirection().get()}},{key:"toString",value:function(){switch(this.value){case 0:return"EMPTY";case 1:return"WHITE_UP";case 2:return"WHITE_RIGHT";case 3:return"WHITE_DOWN";case 4:return"WHITE_LEFT";case 5:return"BLACK_UP";case 6:return"BLACK_RIGHT";case 7:return"BLACK_DOWN";case 8:return"BLACK_LEFT";default:return iB.expectToBe(this.value,9),"MOUNTAIN"}}}],[{key:"decode",value:function(t){switch(t){case 0:return e.EMPTY;case 1:return e.WHITE_UP;case 2:return e.WHITE_RIGHT;case 3:return e.WHITE_DOWN;case 4:return e.WHITE_LEFT;case 5:return e.BLACK_UP;case 6:return e.BLACK_RIGHT;case 7:return e.BLACK_DOWN;case 8:return e.BLACK_LEFT;case 9:return e.MOUNTAIN}}},{key:"of",value:function(t,n){if(n===Zee.NONE)throw new Error("Player None does not have any pieces.");return n===Zee.ZERO?t===Kne.UP?e.WHITE_UP:t===Kne.RIGHT?e.WHITE_RIGHT:t===Kne.DOWN?e.WHITE_DOWN:e.WHITE_LEFT:t===Kne.UP?e.BLACK_UP:t===Kne.RIGHT?e.BLACK_RIGHT:t===Kne.DOWN?e.BLACK_DOWN:e.BLACK_LEFT}}]),e}();Ofe.EMPTY=new Ofe(0),Ofe.WHITE_UP=new Ofe(1),Ofe.WHITE_RIGHT=new Ofe(2),Ofe.WHITE_DOWN=new Ofe(3),Ofe.WHITE_LEFT=new Ofe(4),Ofe.BLACK_UP=new Ofe(5),Ofe.BLACK_RIGHT=new Ofe(6),Ofe.BLACK_DOWN=new Ofe(7),Ofe.BLACK_LEFT=new Ofe(8),Ofe.MOUNTAIN=new Ofe(9);var Tfe=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"countPlayerPawn",value:function(){for(var e=0,t=0;t<5;t++)for(var n=0;n<5;n++)this.board[t][n].belongTo(this.getCurrentPlayer())&&e++;return e}}],[{key:"getInitialState",value:function(){var e=Q5.createTable(5,5,Ofe.EMPTY);return e[2][1]=Ofe.MOUNTAIN,e[2][2]=Ofe.MOUNTAIN,e[2][3]=Ofe.MOUNTAIN,new n(e,0)}}]),n}(vre),Ife=function(){var e=ip(function e(){np(this,e)});return e.CANNOT_INSERT_WHEN_SELECTED=function(){return $localize(Js||(Js=Nv(["You cannot insert a piece when you have already selected a piece."])))},e.NO_REMAINING_PIECE_TO_INSERT=function(){return $localize(Qs||(Qs=Nv(["You cannot insert a piece, all your pieces are already on the board."])))},e.NOT_ENOUGH_FORCE_TO_PUSH=function(){return $localize(Xs||(Xs=Nv(["You do not have enough strength to push."])))},e.ILLEGAL_ROTATION=function(){return $localize(eu||(eu=Nv(["You cannot push and turn at the same time."])))},e.ILLEGAL_PUSH=function(){return $localize(tu||(tu=Nv(["Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board."])))},e}(),xfe=ip(function e(t,n){np(this,e),this.resultingBoard=t,this.moved=n}),Afe=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"isLegal",value:function(e,t){if(aB(n.VERBOSE,{SiamRules_isLegal:{move:e,state:t}}),!e.isInsertion()&&!t.getPieceAt(e.coord).belongTo(t.getCurrentPlayer()))return H5.failure(ure.MUST_CHOOSE_PLAYER_PIECE());if(e.isRotation())return aB(n.VERBOSE,"Move is rotation"),this.isLegalRotation(e,t);var r;if(e.isInsertion()){aB(n.VERBOSE,"Move is insertion");var i=this.isLegalInsertion(e.coord,t);if(i.legal.isFailure())return H5.failure(i.legal.getReason());r=i.insertedPiece}else aB(n.VERBOSE,"Move is forward"),r=t.getPieceAt(e.coord);return n.isLegalForwarding(e,t,r)}},{key:"isLegalInsertion",value:function(e,t){var r=t.countPlayerPawn(),i=t.getCurrentPlayer(),a=r<5?$5.SUCCESS:$5.failure(Ife.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:n.getInsertedPiece(e,i),legal:a}}},{key:"isLegalRotation",value:function(e,t){aB(n.VERBOSE,{isLegalRotation:{rotation:e,state:t}});var r=e.coord,i=t.getPieceAt(r),a=t.getCurrentPlayer();if(i.getDirection()===e.landingOrientation)return H5.failure(Ife.ILLEGAL_ROTATION());var o=t.getCopiedBoard();return o[r.y][r.x]=Ofe.of(e.landingOrientation,a),H5.success(new xfe(o,[r]))}},{key:"applyLegalMove",value:function(e,t,n){var r=Q5.copyBiArray(n.resultingBoard);return new Tfe(r,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=n.getMountainsRowsAndColumns(e.gameState),r=n.getWinner(e.gameState,e.move,t.nbMountain);return r===Zee.NONE?Ere.ONGOING:Ere.getVictory(r)}}],[{key:"getInsertedPiece",value:function(e,t){return Ofe.of(-1===e.x?Kne.RIGHT:-1===e.y?Kne.DOWN:5===e.x?Kne.LEFT:Kne.UP,t)}},{key:"isLegalForwarding",value:function(e,t,r){aB(n.VERBOSE,{isLegalForwarding:{move:e.toString(),state:t,firstPiece:r}});var i=[],a=Ofe.of(e.landingOrientation,t.getCurrentPlayer()),o=e.moveDirection.get(),s=e.coord.getNext(o);if(s.isInRange(5,5)&&t.getPieceAt(s)!==Ofe.EMPTY&&!1===n.isStraight(r,e))return aB(n.VERBOSE,"Illegal push because not straight or not pushing anything or leaving the board"),H5.failure(Ife.ILLEGAL_PUSH());var u=cB.of(o),c=o.getOpposite(),l=0,h=t.getCopiedBoard();e.coord.isInRange(5,5)&&(h[e.coord.y][e.coord.x]=Ofe.EMPTY,i.push(e.coord));for(var f=s.isInRange(5,5)&&a!==Ofe.EMPTY;f;){u.equalsValue(o)?l++:u.equalsValue(c)&&l--,aB(n.VERBOSE,{totalForce:l,movingPiece:a,landingCoord:s});var d=h[s.y][s.x];d===Ofe.MOUNTAIN&&(l-=.9),h[s.y][s.x]=a,i.push(s),a=d,s=s.getNext(o),u=a.getOptionalDirection(),f=s.isInRange(5,5)&&a!==Ofe.EMPTY&&l>0}return s.isNotInRange(5,5)&&(aB(n.VERBOSE,"This movement would push "+a+" outside the board"),u.equalsValue(o)?l++:u.equalsValue(c)&&l--),l<=0?(aB(n.VERBOSE,"This move is an illegal push: "+h),H5.failure(Ife.NOT_ENOUGH_FORCE_TO_PUSH())):(aB(n.VERBOSE,"This move is a legal push: "+h),H5.success(new xfe(h,i)))}},{key:"isStraight",value:function(e,t){var n=e.getDirection();return t.moveDirection.equalsValue(n)&&n===t.landingOrientation}},{key:"getBoardValueInfo",value:function(e,t){var r=n.getMountainsRowsAndColumns(t),i=r.rows,a=r.columns,o=n.getWinner(t,e,r.nbMountain);if(o===Zee.NONE){var s,u=n.getPushers(t,a,i),c=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER,h=t.getCurrentPlayer(),f=Xv(u);try{for(f.s();!(s=f.n()).done;){var d=s.value;d.coord.isInRange(5,5)?t.getPieceAt(d.coord).belongTo(Zee.ZERO)?c=Math.min(c,d.distance):l=Math.min(l,d.distance):h===Zee.ZERO?c=Math.min(c,d.distance):l=Math.min(l,d.distance)}}catch(v){f.e(v)}finally{f.f()}return{shortestZero:c,shortestOne:l,boardValue:n.getScoreFromShortestDistances(c,l,h)}}return o===Zee.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER}}},{key:"getScoreFromShortestDistances",value:function(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);var r=6-e,i=6-t;return r===i?n.getScoreModifier():r>i?-10*(r+1)+(i+1):10*(i+1)-(r+1)}},{key:"getMountainsRowsAndColumns",value:function(e){for(var t=[],n=[],r=0,i=0;i<5;i++)for(var a=0;a<5;a++)e.getPieceAtXY(a,i)===Ofe.MOUNTAIN&&(t.includes(i)||t.push(i),n.includes(a)||n.push(a),r++);return{rows:t,columns:n,nbMountain:r}}},{key:"getWinner",value:function(e,t,r){return 2===r?n.getPusher(e,t.get()):Zee.NONE}},{key:"getPusher",value:function(e,t){var r=t.coord,i=(r.isInRange(5,5)?e.getPieceAt(r.getNext(t.landingOrientation)):n.getInsertedPiece(r,e.getCurrentOpponent())).getDirection(),a=n.getPusherCoord(e,i,r),o=e.getPieceAt(a).getOwner();return aB(n.VERBOSE,r.toString()+" belong to "+e.getCurrentOpponent().value+", "+a.toString()+" belong to "+o.value+", "+o.value+" win"),o}},{key:"getPusherCoord",value:function(e,t,n){for(var r=n.getNext(t),i=n;r.isInRange(5,5);){n=r,r=r.getNext(t);var a=e.getPieceAt(n);a!==Ofe.MOUNTAIN&&a.getDirection()===t&&(i=n)}return i}},{key:"getPushers",value:function(e,t,r){aB(n.VERBOSE,{getPushers:{state:e,mountainsColumn:t,mountainsRow:r}});var i,a=[],o=[],s=Xv(t);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=Kne.DOWN,l=new Jne(u,4);o.push({direction:c,fallingCoord:l}),c=Kne.UP,l=new Jne(u,0),o.push({direction:c,fallingCoord:l})}}catch(k){s.e(k)}finally{s.f()}var h,f=Xv(r);try{for(f.s();!(h=f.n()).done;){var d=h.value,v=Kne.LEFT,p=new Jne(0,d);o.push({direction:v,fallingCoord:p}),v=Kne.RIGHT,p=new Jne(4,d),o.push({direction:v,fallingCoord:p})}}catch(k){f.e(k)}finally{f.f()}for(var g=0,y=o;g<y.length;g++){var m=y[g];a=n.addPotentialDirectionPusher(e,m.fallingCoord,m.direction,a)}return a}},{key:"addPotentialDirectionPusher",value:function(e,t,r,i){var a=n.getLineClosestPusher(e,t,r);if(a.isAbsent())return i;var o=a.get(),s=o.distance;return aB(n.VERBOSE,"new closest challenger"),i.push({coord:o.coord,distance:s}),i}},{key:"getLineClosestPusher",value:function(e,t,r){aB(n.VERBOSE,{getDirectionClosestPusher:{state:e,fallingCoord:t,direction:r.toString()}});for(var i=r.getOpposite(),a=1,o=e.getPieceAt(t),s=t,u=cB.empty(),c=!1,l=!1,h=0;s.isInRange(5,5)&&!1===c;){var f=e.getPieceAt(s);if(f.isEmptyOrMountain())f===Ofe.MOUNTAIN?(h+=.9,l=!0):a++;else{var d=f.getDirection();d===r?l&&((h-=1)<=0&&(c=!0,s=s.getNext(r))):d===i?(h+=1,l||a++):l?(u=cB.of(s),o!==Ofe.EMPTY&&a++):a++}o=f,s=s.getPrevious(r)}if(!1===c&&u.isPresent())for(a++,h-=1;!1===s.equals(u.get());)s=s.getNext(r),a--;return s.isNotInRange(5,5)&&(h-=1,5===e.countPlayerPawn())||h>0?cB.empty():cB.of({distance:a,coord:s})}},{key:"getPushingInsertions",value:function(e){for(var t=[],n=e.gameState.getCurrentPlayer(),r=[],i=[],a=0;a<5;a++)r.push(new Pfe(-1,a,cB.of(Kne.RIGHT),Kne.RIGHT)),i.push(Ofe.of(Kne.RIGHT,n)),r.push(new Pfe(5,a,cB.of(Kne.LEFT),Kne.LEFT)),i.push(Ofe.of(Kne.LEFT,n)),r.push(new Pfe(a,-1,cB.of(Kne.DOWN),Kne.DOWN)),i.push(Ofe.of(Kne.DOWN,n)),r.push(new Pfe(a,5,cB.of(Kne.UP),Kne.UP)),i.push(Ofe.of(Kne.UP,n));for(var o=0;o<r.length;o++)this.isLegalForwarding(r[o],e.gameState,i[o]).isSuccess()&&t.push(r[o]);return t}},{key:"getDerapingInsertions",value:function(e){for(var t,n,r=[],i=e.gameState.getCurrentPlayer(),a=1;a<=3;a++)t=new Pfe(-1,a,cB.of(Kne.RIGHT),Kne.UP),n=Ofe.of(Kne.UP,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Pfe(-1,a,cB.of(Kne.RIGHT),Kne.DOWN),n=Ofe.of(Kne.DOWN,i),this.isLegalForwarding(t,e.gameState,n),r.push(t)),t=new Pfe(5,a,cB.of(Kne.LEFT),Kne.UP),n=Ofe.of(Kne.UP,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Pfe(5,a,cB.of(Kne.LEFT),Kne.DOWN),n=Ofe.of(Kne.DOWN,i),this.isLegalForwarding(t,e.gameState,n),r.push(t));for(var o=1;o<=3;o++)t=new Pfe(o,-1,cB.of(Kne.DOWN),Kne.LEFT),n=Ofe.of(Kne.LEFT,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Pfe(o,-1,cB.of(Kne.DOWN),Kne.RIGHT),n=Ofe.of(Kne.RIGHT,i),this.isLegalForwarding(t,e.gameState,n),r.push(t)),t=new Pfe(o,5,cB.of(Kne.UP),Kne.LEFT),n=Ofe.of(Kne.LEFT,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Pfe(o,5,cB.of(Kne.UP),Kne.RIGHT),n=Ofe.of(Kne.RIGHT,i),this.isLegalForwarding(t,e.gameState,n),r.push(t));return r}},{key:"getCoordDirection",value:function(e,t,n){var r=new Jne(e,t);return this.getInsertedPiece(r,n.getCurrentPlayer()).getDirection()}}]),n}(Sre);return e.VERBOSE=!1,e}(),Rfe=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getBoardValue",value:function(e){return new lre(Afe.getBoardValueInfo(e.move,e.gameState).boardValue)}},{key:"getListMoves",value:function(e){for(var t,n=[],r=e.gameState.getCurrentPlayer(),i=0;i<5;i++)for(var a=0;a<5;a++)if((t=e.gameState.getPieceAtXY(a,i)).belongTo(r)){var o,s=t.getDirection(),u=Xv(Kne.ORTHOGONALS);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(c!==s){var l=e.gameState.getCopiedBoard(),h=new Pfe(a,i,cB.empty(),c);l[i][a]=Ofe.of(c,r),n.push(h)}var f,d=Xv(new Jne(a+c.x,i+c.y).isInRange(5,5)?Kne.ORTHOGONALS:[c]);try{for(d.s();!(f=d.n()).done;){var v=f.value,p=new Pfe(a,i,cB.of(c),v);Afe.isLegalForwarding(p,e.gameState,t).isSuccess()&&n.push(p)}}catch(g){d.e(g)}finally{d.f()}}}catch(g){u.e(g)}finally{u.f()}}return e.gameState.countPlayerPawn()<5&&(n=(n=n.concat(Afe.getPushingInsertions(e))).concat(Afe.getDerapingInsertions(e))),aB(Afe.VERBOSE,{getListMovesResult:n}),n}}]),n}(cre),Nfe=Ofe.EMPTY,Mfe=Ofe.MOUNTAIN,Dfe=Ofe.WHITE_UP,Lfe=Ofe.WHITE_LEFT,Ffe=Ofe.WHITE_RIGHT,Bfe=Ofe.WHITE_DOWN,Vfe=Ofe.BLACK_UP,Ufe=Ofe.BLACK_LEFT,zfe=Ofe.BLACK_RIGHT,Hfe=Ofe.BLACK_DOWN,Gfe=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(nu||(nu=Nv(["Goal of the game"]))),$localize(ru||(ru=Nv(["The goal at Siam is to be the first to push a mountain out of the board.\n        The initial board contains three mountains, and no pieces are initially on the board.\n        During its turn, a player can do one of the following three actions:\n        <ol>\n            <li>Put a new piece on the board.</li>\n            <li>Change the orientation of one of its piece, and optionally move it.</li>\n            <li>Take one of its pieces out of the board.</li>\n        </ol>"]))),Tfe.getInitialState()),Ire.anyMove($localize(iu||(iu=Nv(["Inserting a piece"]))),$localize(au||(au=Nv(["Each player has 5 pieces in total.\n        As long as you do not have 5 pieces on the board, you can insert new pieces. To do so:\n        <ol>\n            <li>Click on one of the big arrows alongside the board.</li>\n            <li>Click on one of the small arrows that appeared on the landing square of your piece.\n                This is the direction in which your piece will be oriented.</li>\n        </ol><br/>\n        Insert a piece on the board."]))),Tfe.getInitialState(),new Pfe(2,-1,cB.of(Kne.DOWN),Kne.DOWN),$localize(ou||(ou=Nv(["Congratulations!"])))),Ire.fromMove($localize(su||(su=Nv(["Moving a piece"]))),$localize(uu||(uu=Nv(['We will distinguish here "moving" and "pushing".\n        A move is made from a piece\'s square to an empty neighboring square, horizontally or vertically.\n        During that move, you can also move the piece out of the board.\n        To move a piece:\n        <ol>\n            <li>Click on it.</li>\n            <li>Click on one of the 4 arrows to pick the direction in which it will move.\n                You can also click on the middle dot to change the piece\'s orientation without moving it.</li>\n            <li>Click on one of the 4 arrows on the landing square to pick its orientation.</li>\n        </ol><br/>\n        Try to move the piece that is on the board one square upwards and to orient it downwards.']))),new Tfe([[Nfe,Nfe,Nfe,Nfe,Nfe],[Nfe,Nfe,Nfe,Nfe,Nfe],[Nfe,Mfe,Mfe,Mfe,Nfe],[Nfe,Nfe,Nfe,Nfe,Nfe],[Nfe,Nfe,Dfe,Nfe,Nfe]],0),[new Pfe(2,4,cB.of(Kne.UP),Kne.DOWN)],$localize(cu||(cu=Nv(["Congratulations, you made a side-slip!"]))),$localize(lu||(lu=Nv(["Failed!"])))),Ire.fromMove($localize(hu||(hu=Nv(["Moving a piece out of the board"]))),$localize(fu||(fu=Nv(["To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>\n        Get that piece out of the board!"]))),new Tfe([[Nfe,Nfe,Nfe,Nfe,Nfe],[Nfe,Nfe,Nfe,Nfe,Nfe],[Nfe,Mfe,Mfe,Mfe,Nfe],[Nfe,Nfe,Nfe,Nfe,Nfe],[Nfe,Nfe,Dfe,Nfe,Nfe]],0),[new Pfe(2,4,cB.of(Kne.DOWN),Kne.DOWN)],$localize(du||(du=Nv(["Congratulations, even if in this context it was not a useful move."]))),$localize(vu||(vu=Nv(["Failed, the piece is still on the board."])))),Ire.fromMove($localize(pu||(pu=Nv(["Pushing"]))),$localize(gu||(gu=Nv(['When the landing square of your move is occupied, we use the term "push".\n        In order to push, multiple conditions must hold:\n        <ol>\n            <li>Your piece must already be oriented in the direction of the push.</li>\n            <li>The number of the pieces (opponent\'s or not) that are facing yours (called the resistants)\n                must be smaller than the number of pieces that are oriented in the same direction as the push, yourself included (the pushers).</li>\n            <li>The number of mountains on that line must be smaller or equal to the difference between the pushers and the resistants.</li>\n        </ol>\n        Your piece on the top right cannot push because there is one mountain too much.\n        Your piece on the bottom right can push.<br/><br/>\n        Do it.']))),new Tfe([[Ffe,Mfe,Mfe,Ufe,Lfe],[Nfe,Nfe,Nfe,Nfe,Nfe],[Nfe,Nfe,Nfe,Mfe,Nfe],[Nfe,Nfe,Nfe,Nfe,Nfe],[Nfe,Nfe,zfe,Ufe,Lfe]],0),[new Pfe(4,4,cB.of(Kne.LEFT),Kne.LEFT)],$localize(yu||(yu=Nv(["Congratulations!"]))),$localize(mu||(mu=Nv(["Failed!"])))),Ire.fromMove($localize(ku||(ku=Nv(["Victory"]))),$localize(_u||(_u=Nv(["The game ends when a mountain is pushed out of the board.\n        If you pushed it and nobody is in front of you, you're the winner.\n        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.\n        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>\n        You have two ways of ending the game here: you can either win, or lose. Choose correctly!"]))),new Tfe([[Nfe,Nfe,Nfe,Nfe,Nfe],[Nfe,Nfe,Nfe,Nfe,Nfe],[Mfe,Vfe,Lfe,Nfe,Bfe],[Nfe,Nfe,Nfe,Nfe,Hfe],[Nfe,Nfe,Nfe,Nfe,Mfe]],0),[new Pfe(2,2,cB.of(Kne.LEFT),Kne.LEFT)],$localize(wu||(wu=Nv(["Congratulations, you won!"]))),$localize(Cu||(Cu=Nv(["Failed, you lost."]))))]});function qfe(e,t){if(1&e){var n=gb();wm(),hb(0,"use",7),kb("click",function(){var e=Wy(n).$implicit;return Cb(3).insertAt(e.x,e.y)}),fb()}if(2&e){var r=t.$implicit,i=Cb(3);Eb("id","insertAt_",r.x,"_",r.y,""),nb("transform",i.getInsertionArrowTransform(r.x+1,r.y+1,r.dir))}}var $fe=function(e,t){return{dir:"DOWN",x:e,y:t}},Wfe=function(e){return{dir:"UP",x:e,y:5}},jfe=function(e,t){return{dir:"RIGHT",x:e,y:t}},Zfe=function(e){return{dir:"LEFT",x:5,y:e}},Yfe=function(e,t,n,r){return[e,t,n,r]};function Kfe(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,qfe,1,3,"use",6),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",function(e,t,n,r,i,a,o){return function(e,t,n,r,i,a,o,s,u){var c=t+n;return function(e,t,n,r,i,a){var o=eb(e,t,n,r);return eb(e,t+2,i,a)||o}(e,c,i,a,o,s)?QC(e,c+4,u?r.call(u,i,a,o,s):r(i,a,o,s)):iP(e,c+4)}(qy(),tm(),e,t,n,r,i,a,o)}(11,Yfe,rP(1,$fe,n,-1),nP(4,Wfe,n),rP(6,jfe,-1,n),nP(9,Zfe,n)))}}var Jfe=function(){return[0,1,2,3,4]};function Qfe(e,t){1&e&&(wm(),vb(0),ob(1,Kfe,2,16,"g",5),pb()),2&e&&(Ow(1),cb("ngForOf",tP(1,Jfe)))}function Xfe(e,t){if(1&e){var n=gb();wm(),hb(0,"use",13),kb("click",function(){var e=Wy(n).$implicit;return Cb(5).chooseDirection(e)}),fb()}if(2&e){var r=t.$implicit,i=Cb(3).index,a=Cb().index,o=Cb();bb("id","chooseDirection_",r,""),nb("transform",o.getArrowTransform(i+1,a+1,r))}}var ede=function(){return["RIGHT","DOWN","LEFT","UP"]};function tde(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"circle",11),kb("click",function(){return Wy(n),Cb(4).chooseDirection("")}),fb(),ob(2,Xfe,1,2,"use",12),fb()}if(2&e){var r=Cb(2).index,i=Cb().index,a=Cb();Ow(1),nb("cx",(r+1)*a.SPACE_SIZE+a.SPACE_SIZE/2)("cy",(i+1)*a.SPACE_SIZE+a.SPACE_SIZE/2),Ow(1),cb("ngForOf",tP(3,ede))}}function nde(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"use",10),kb("click",function(){Wy(n);var e=Cb().index,t=Cb().index;return Cb().clickPiece(e,t)}),fb(),ob(2,tde,3,4,"g",4),fb()}if(2&e){var r=Cb(),i=r.index,a=r.$implicit,o=Cb().index,s=Cb();Ow(1),Eb("id","clickPiece_",i,"_",o,""),cb("ngClass",s.getPieceClasses(a)),nb("transform",s.getPieceTransform(i,o)),Ow(1),cb("ngIf",s.choosingDirection(i,o))}}function rde(e,t){if(1&e&&(wm(),db(0,"use",14)),2&e){var n=Cb().index,r=Cb().index,i=Cb();nb("transform","translate("+(n+1)*i.SPACE_SIZE+" "+(r+1)*i.SPACE_SIZE+")")}}function ide(e,t){if(1&e){var n=gb();wm(),hb(0,"use",13),kb("click",function(){var e=Wy(n).$implicit;return Cb(4).chooseOrientation(e)}),fb()}if(2&e){var r=t.$implicit,i=Cb(2).index,a=Cb().index,o=Cb();bb("id","chooseOrientation_",r,""),nb("transform",o.getArrowTransform(i+1,a+1,r))}}function ade(e,t){1&e&&(wm(),hb(0,"g"),ob(1,ide,1,2,"use",12),fb()),2&e&&(Ow(1),cb("ngForOf",tP(1,ede)))}function ode(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"rect",8),kb("click",function(){var e=Wy(n).index,t=Cb().index;return Cb().insertAt(e,t)}),fb(),ob(2,nde,3,5,"g",4),ob(3,rde,1,1,"use",9),ob(4,ade,2,2,"g",4),fb()}if(2&e){var r=t.$implicit,i=t.index,a=Cb().index,o=Cb();Ow(1),Eb("id","insertAt_",i,"_",a,""),cb("ngClass",o.getSquareClasses(i,a)),nb("x",o.SPACE_SIZE*(i+1))("y",o.SPACE_SIZE*(a+1))("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Ow(1),cb("ngIf",r.isPiece()),Ow(1),cb("ngIf",o.isMountain(r)),Ow(1),cb("ngIf",o.choosingOrientation(i,a))}}function sde(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,ode,5,10,"g",5),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}var ude=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).lastMove=cB.empty(),r.chosenCoord=cB.empty(),r.landingCoord=cB.empty(),r.chosenDirection=cB.empty(),r.chosenOrientation=cB.empty(),r.movedPieces=[],r.rules=new Afe(Tfe),r.availableMinimaxes=[new Rfe(r.rules,"SiamMinimax")],r.encoder=Pfe.encoder,r.tutorial=(new Gfe).tutorial,r.updateBoard(),r}return ip(n,[{key:"updateBoard",value:function(){if(aB(n.VERBOSE,"updateBoard"),this.board=this.rules.node.gameState.board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.rules.node.mother.get().gameState;this.movedPieces=this.rules.isLegal(this.lastMove.get(),e).get().moved}else this.movedPieces=[]}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=cB.empty(),this.chosenDirection=cB.empty(),this.landingCoord=cB.empty(),this.chosenOrientation=cB.empty()}},{key:"clickPiece",value:function(e,t){var n=this.canUserPlay("#clickPiece_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());var r=this.board[t][e],i=this.rules.node.gameState.getCurrentOpponent();return r.getOwner()===i?this.cancelMove(ure.MUST_CHOOSE_PLAYER_PIECE()):(this.chosenCoord=cB.of(new Jne(e,t)),$5.SUCCESS)}},{key:"chooseDirection",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(aB(n.VERBOSE,"SiamComponent.chooseDirection("+e+")"),!(i=t.canUserPlay("#chooseDirection_"+e)).isFailure()){r.next=4;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 4:if(""!==e){r.next=8;break}t.chosenDirection=cB.empty(),t.landingCoord=t.chosenCoord,r.next=15;break;case 8:if(a=Kne.factory.fromString(e).get(),t.chosenDirection=cB.of(a),t.landingCoord=cB.of(t.chosenCoord.get().getNext(a)),!t.landingCoord.get().isNotInRange(5,5)){r.next=15;break}return aB(n.VERBOSE,"orientation and direction should be the same: "+a),t.chosenOrientation=cB.of(a),r.next=14,t.tryMove();case 14:return r.abrupt("return",r.sent);case 15:return r.abrupt("return",$5.SUCCESS);case 16:case"end":return r.stop()}},r)}))()}},{key:"chooseOrientation",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(aB(n.VERBOSE,"SiamComponent.chooseOrientation("+e+")"),!(i=t.canUserPlay("#chooseOrientation_"+e)).isFailure()){r.next=6;break}r.t0=t.cancelMove(i.getReason()),r.next=10;break;case 6:return t.chosenOrientation=cB.of(Kne.factory.fromString(e).get()),r.next=9,t.tryMove();case 9:r.t0=r.sent;case 10:return r.abrupt("return",r.t0);case 11:case"end":return r.stop()}},r)}))()}},{key:"insertAt",value:function(e,t){var r=this;return rB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(aB(n.VERBOSE,"SiamComponent.insertAt("+e+", "+t+")"),!(a=r.canUserPlay("#insertAt_"+e+"_"+t)).isFailure()){i.next=4;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 4:if(!r.chosenCoord.isPresent()){i.next=6;break}return i.abrupt("return",r.cancelMove(Ife.CANNOT_INSERT_WHEN_SELECTED()));case 6:return r.chosenCoord=cB.of(new Jne(e,t)),o=Afe.getCoordDirection(e,t,r.rules.node.gameState),i.abrupt("return",(r.chosenDirection=cB.of(o),r.landingCoord=cB.of(r.chosenCoord.get().getNext(o)),$5.SUCCESS));case 9:case"end":return i.stop()}},i)}))()}},{key:"tryMove",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new Pfe(n.x,n.y,e.chosenDirection,e.chosenOrientation.get()),e.cancelMove(),t.next=4,e.chooseMove(r,e.rules.node.gameState);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t)}))()}},{key:"isMountain",value:function(e){return e===Ofe.MOUNTAIN}},{key:"choosingOrientation",value:function(e,t){var r=new Jne(e,t);return!!(this.chosenCoord.isPresent()&&this.landingCoord.equalsValue(r)&&this.chosenOrientation.isAbsent())&&(aB(n.VERBOSE,"choosing orientation now"),!0)}},{key:"choosingDirection",value:function(e,t){var r=new Jne(e,t);return!!(this.chosenCoord.equalsValue(r)&&this.chosenDirection.isAbsent()&&this.landingCoord.isAbsent()&&this.chosenOrientation.isAbsent())&&(aB(n.VERBOSE,"choosing direction now"),!0)}},{key:"getInsertionArrowTransform",value:function(e,t,n){var r="rotate(".concat(90*(Kne.factory.fromString(n).get().toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",r].join(" ")}},{key:"getPieceTransform",value:function(e,t){var n="rotate(".concat(90*(this.board[t][e].getDirection().toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate("+(e+1)*this.SPACE_SIZE+", "+(t+1)*this.SPACE_SIZE+")",n].join(" ")}},{key:"getArrowTransform",value:function(e,t,n){return Fhe.getArrowTransform(this.SPACE_SIZE,new Jne(e,t),Kne.factory.fromString(n).get())}},{key:"getPieceClasses",value:function(e){return[this.getPlayerClass(e.getOwner())]}},{key:"getSquareClasses",value:function(e,t){var n=new Jne(e,t);return this.movedPieces.some(function(e){return e.equals(n)})?["moved"]:[]}}]),n}(lie);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-siam"]],features:[HC],decls:7,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 700 700","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 93, 90 50, 70 50, 70 7, 27.5 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngIf"],[4,"ngFor","ngForOf"],[0,"xlink","href","#arrow","class","base mid-stroke",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","click"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#mountain","fill","brown",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],["id","chooseDirection_","r","8",1,"arrow","selected-fill","no-stroke",3,"click"],[0,"xlink","href","#triangle","class","arrow selected-fill no-stroke",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"arrow","selected-fill","no-stroke",3,"id","click"],[0,"xlink","href","#mountain","fill","brown"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),hb(1,"defs"),db(2,"polygon",1),db(3,"polygon",2),db(4,"polygon",3),fb(),ob(5,Qfe,2,2,"ng-container",4),ob(6,sde,2,1,"g",5),fb()),2&e&&(Ow(5),cb("ngIf",t.isPlayerTurn()),Ow(1),cb("ngForOf",t.board))},directives:[DT,NT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),cde=function(){var e=ip(function e(){np(this,e)});return e.NO_MOVEMENT_BEFORE_TURN_40=function(){return $localize(bu||(bu=Nv(["You cannot move yet. Pick a space where you will put a new piece."])))},e.MUST_CUT=function(){return $localize(Eu||(Eu=Nv(["Several groups are of the same size, you must pick the one to keep."])))},e.CANNOT_CHOOSE_TO_KEEP=function(){return $localize(Su||(Su=Nv(["You cannot choose which part to keep when one is smaller than the other."])))},e.CAN_NO_LONGER_DROP=function(){return $localize(Pu||(Pu=Nv(["You cannot put new pieces anymore. Pick a piece to move."])))},e.MUST_CAPTURE_BIGGEST_GROUPS=function(){return $localize(Ou||(Ou=Nv(["You must choose one of the biggest groups to keep it."])))},e.CANNOT_KEEP_EMPTY_COORD=function(){return $localize(Tu||(Tu=Nv(["You cannot pick an empty space. Pick one of the biggest groups."])))},e.MUST_DROP_NEXT_TO_OTHER_PIECE=function(){return $localize(Iu||(Iu=Nv(["You must put this piece next to another piece."])))},e}(),lde=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;np(this,n),(a=t.call(this,r)).pieces=e;var o=a.getCalculatedScale();return a.pieces=o.pieces,a.width=o.width,a.height=o.height,a.offset=i||o.offset,a.pieces.makeImmutable(),a}return ip(n,[{key:"getCalculatedScale",value:function(){var e,t=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,a=Xv(this.pieces.listKeys());try{for(a.s();!(e=a.n()).done;){var o=e.value;t=Math.min(o.x,t),n=Math.max(o.x,n),r=Math.min(o.y,r),i=Math.max(o.y,i)}}catch(v){a.e(v)}finally{a.f()}var s=new wre,u=new Wne(-t,-r);if(0!==t||0!==r){var c,l=Xv(this.pieces.listKeys());try{for(l.s();!(c=l.n()).done;){var h=c.value,f=this.pieces.delete(h),d=h.getNext(u);s.set(d,f)}}catch(v){l.e(v)}finally{l.f()}}else s=this.pieces;return{width:n+1-t,height:i+1-r,pieces:s,offset:u}}},{key:"toRepresentation",value:function(){var e,t=Q5.createTable(this.width,this.height,Zee.NONE.value),n=Xv(this.pieces.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.getPieceAt(r).value;t[r.y][r.x]=i}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"isIllegalLandingZone",value:function(e,t){return this.pieces.containsKey(e)?$5.failure(ure.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?$5.SUCCESS:$5.failure(cde.MUST_DROP_NEXT_TO_OTHER_PIECE())}},{key:"isCoordConnected",value:function(e,t){var n,r=Xv(rre.factory.all);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=e.getNext(i,1);if(this.pieces.containsKey(a)&&!1===t.equalsValue(a))return!0}}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"isOnBoard",value:function(e){return this.pieces.containsKey(e)}},{key:"getPieceAt",value:function(e){return this.isOnBoard(e)?this.pieces.get(e).get():Zee.NONE}},{key:"applyLegalDrop",value:function(e){var t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new n(t,this.turn+1)}},{key:"applyLegalDeplacement",value:function(e,t){var r=n.deplacePiece(this,e),i=new wre;if(t.size()>0){i=new wre;var a,o=Xv(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.set(s,r.get(s).get())}}catch(u){o.e(u)}finally{o.f()}}else i=r.getCopy();return new n(i,this.turn+1)}},{key:"countPieces",value:function(){var e=this.pieces.reverse(),t=e.get(Zee.ZERO).getOrElse(new Die),n=e.get(Zee.ONE).getOrElse(new Die);return[t.size(),n.size()]}},{key:"switchPiece",value:function(e){var t=this.pieces.getCopy(),r=this.getPieceAt(e);return t.replace(e,r.getOpponent()),new n(t,this.turn,this.offset)}},{key:"equals",value:function(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation([[Zee.ZERO.value],[Zee.ONE.value]],0)}},{key:"fromRepresentation",value:function(e,t,r){for(var i=new wre,a=0;a<e.length;a++)for(var o=0;o<e[0].length;o++)e[a][o]!==Zee.NONE.value&&i.set(new Jne(o,a),Zee.of(e[a][o]));return new n(i,t,r)}},{key:"deplacePiece",value:function(e,t){var n=e.pieces.getCopy();return n.delete(t.start.get()),n.set(t.landing,e.getCurrentPlayer()),n}},{key:"getGroups",value:function(e,t){var r,i=new wre,a=0,o=Xv(rre.factory.all);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=t.getNext(s,1);i=n.putCoordInGroup(e,u,i,""+a),a++}}catch(f){o.e(f)}finally{o.f()}for(var c=i.reverse(),l=new fre,h=0;h<c.size();h++)l.add(c.getByIndex(h).value);return l}},{key:"putCoordInGroup",value:function(e,t,r,i){if(e.get(t).isPresent()&&r.get(t).isAbsent()){r.set(t,i);var a,o=Xv(rre.factory.all);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=t.getNext(s,1);r=n.putCoordInGroup(e,u,r,i)}}catch(c){o.e(c)}finally{o.f()}}return r}}]),n}(dre),hde=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;if(np(this,n),(a=t.call(this)).start=e,a.landing=r,a.keep=i,e.equalsValue(r))throw new Error("Deplacement cannot be static!");if(e.isPresent()&&e.equals(i))throw new Error("Cannot keep starting coord, since it will always be empty after move!");return jv(a)}return ip(n,[{key:"isDrop",value:function(){return this.start.isAbsent()}},{key:"isCut",value:function(){return this.keep.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}},{key:"equals",value:function(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}],[{key:"fromDrop",value:function(e){return new n(cB.empty(),e,cB.empty())}},{key:"fromMovement",value:function(e,t){return new n(cB.of(e),t,cB.empty())}},{key:"fromCut",value:function(e,t,r){return new n(cB.of(e),t,cB.of(r))}}]),n}(gre);hde.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"encodeMove",value:function(e){return{start:e.start.isPresent()?Jne.encoder.encode(e.start.get()):null,landing:Jne.encoder.encode(e.landing),keep:e.keep.isPresent()?Jne.encoder.encode(e.keep.get()):null}}},{key:"decodeMove",value:function(e){var t=e;if("object"!=typeof e)throw new Error("Invalid encodedMove of type "+typeof e+"!");var n=Jne.encoder.decode(t.landing);if(null==t.start)return hde.fromDrop(n);var r=Jne.encoder.decode(t.start);if(null==t.keep)return hde.fromMovement(r,n);var i=Jne.encoder.decode(t.keep);return hde.fromCut(r,n,i)}}]),n}(Wee));var fde=function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return ip(n,[{key:"applyLegalMove",value:function(e,t,n){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,n)}},{key:"isLegal",value:function(e,t){aB(this.VERBOSE,{called:"SixRules.isLegal",move:e,state:t});var r=t.isIllegalLandingZone(e.landing,e.start);return r.isFailure()?r.toFailedFallible():t.turn<40?this.isLegalDrop(e,t):n.isLegalPhaseTwoMove(e,t)}},{key:"isLegalDrop",value:function(e,t){return!1===e.isDrop()?H5.failure(cde.NO_MOVEMENT_BEFORE_TURN_40()):H5.success(t.pieces.getKeySet())}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getCurrentOpponent(),r=[];if(e.move.isPresent()&&(r=this.getShapeVictory(e.move.get(),t)),6===r.length)return Ere.getVictory(n);if(t.turn>39){var i=t.countPieces(),a=i[0],o=i[1];return a<6&&o<6?a<o?Ere.ONE_WON:o<a?Ere.ZERO_WON:Ere.DRAW:a<6?Ere.getDefeat(Zee.ZERO):o<6?Ere.getDefeat(Zee.ONE):Ere.ONGOING}return Ere.ONGOING}},{key:"startSearchingVictorySources",value:function(){aB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"getShapeVictory",value:function(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();var n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(aB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){aB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(rre.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return[];var o=(e+i.length)%6;i.push(a),a=a.getNext(rre.factory.all[o],1)}return i}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=rre.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return[];s=!0,i=i.getOpposite(),a=a.getNext(i,o.length)}a=a.getNext(i,1)}return o}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){aB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=rre.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.length%2==0&&(i=rre.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return a}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){aB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=rre.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.push(o),a.length%2==0&&(i=rre.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return a}}],[{key:"getLegalLandings",value:function(e){var t,n=new Die,r=Xv(e.pieces.listKeys());try{for(r.s();!(t=r.n()).done;){var i,a=t.value,o=Xv(rre.factory.all);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=a.getNext(s,1);e.getPieceAt(u)===Zee.NONE&&n.add(u)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){r.e(c)}finally{r.f()}return n.toList()}},{key:"isLegalPhaseTwoMove",value:function(e,t){if(e.isDrop())return H5.failure(cde.CAN_NO_LONGER_DROP());switch(t.getPieceAt(e.start.get())){case Zee.NONE:return H5.failure(ure.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());case t.getCurrentOpponent():return H5.failure(ure.CANNOT_CHOOSE_OPPONENT_PIECE())}var r=lde.deplacePiece(t,e),i=lde.getGroups(r,e.start.get());if(n.isSplit(i)){var a=this.getBiggerGroups(i);return 1===a.size()?e.keep.isPresent()?H5.failure(cde.CANNOT_CHOOSE_TO_KEEP()):H5.success(a.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,a,r)}return H5.success(new Die)}},{key:"isSplit",value:function(e){return e.size()>1}},{key:"getBiggerGroups",value:function(e){var t,n=0,r=new fre,i=Xv(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=a.size();o>n?(n=o,r=new fre([a])):o===n&&r.add(a)}}catch(s){i.e(s)}finally{i.f()}return r}},{key:"moveKeepBiggerGroup",value:function(e,t,n){if(e.isAbsent())return H5.failure(cde.MUST_CUT());if(n.get(e.get()).isAbsent())return H5.failure(cde.CANNOT_KEEP_EMPTY_COORD());var r,i=e.get(),a=Xv(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.contains(i))return H5.success(o)}}catch(s){a.e(s)}finally{a.f()}return H5.failure(cde.MUST_CAPTURE_BIGGEST_GROUPS())}}]),n}(Sre),dde=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"calculateBoardValue",value:function(e,t){this.startSearchingVictorySources();for(var n={status:kre.DEFAULT,victory:cB.empty(),preVictory:cB.empty(),sum:0};this.hasNextVictorySource();){var r,i=this.getNextVictorySource();if((r=n.status===kre.PRE_VICTORY?this.searchVictoryOnly(i,e,t):this.getBoardInfo(i,e,t,n)).status===kre.VICTORY)return r;n={status:r.status,victory:cB.empty(),preVictory:r.preVictory,sum:n.sum+r.sum}}return n}}]),n}(cre),vde=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this,e)).value=e,i.preVictory=r,i}return ip(n)}(lre),pde=function(e){qv(n,e);var t=Wv(n);function n(){var e;return np(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return ip(n,[{key:"getListMoves",value:function(e){var t=n.get(),r=e.getOwnValue(t);if(r.preVictory.isPresent())return e.gameState.turn<40?this.createForcedDrop(r):this.createForcedDeplacement(e,r);var i=fde.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrop(i):this.getListDeplacement(e.gameState,i)}},{key:"createForcedDrop",value:function(e){aB(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:e});var t=[],n=hde.fromDrop(e.preVictory.get());return t.push(n),t}},{key:"createForcedDeplacement",value:function(e,t){aB(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:e});var n=this.getSafelyMovablePieceOrFirstOne(e),r=[t.preVictory.get()];return this.getDeplacementFrom(e.gameState,n,r)}},{key:"getDeplacementFrom",value:function(e,t,n){var r,i=[],a=Xv(t);try{for(a.s();!(r=a.n()).done;){var o,s=r.value,u=Xv(n);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=hde.fromMovement(s,c);if(e.isCoordConnected(c,cB.of(s))){var h=lde.deplacePiece(e,l),f=lde.getGroups(h,l.start.get());if(fde.isSplit(f)){var d,v=Xv(f);try{for(v.s();!(d=v.n()).done;){var p=d.value.getAnyElement().get(),g=hde.fromCut(s,c,p);i.push(g)}}catch(y){v.e(y)}finally{v.f()}}else i.push(l)}}}catch(y){u.e(y)}finally{u.f()}}}catch(y){a.e(y)}finally{a.f()}return i}},{key:"getSafelyMovablePieceOrFirstOne",value:function(e){var t,n=e.gameState,r=n.pieces.reverse(),i=n.getCurrentPlayer(),a=r.get(i).get(),o=a.getAnyElement().get(),s=[],u=Xv(a);try{for(u.s();!(t=u.n()).done;){var c=t.value;!1===this.isPieceBlockingAVictory(n,c)&&s.push(c)}}catch(l){u.e(l)}finally{u.f()}return new Die(0===s.length?[o]:s)}},{key:"isPieceBlockingAVictory",value:function(e,t){var n=e.switchPiece(t),r=hde.fromDrop(t);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,r,n).status===kre.VICTORY)return!0;return!1}},{key:"getListDrop",value:function(e){var t,n=[],r=Xv(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=hde.fromDrop(i);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getListDeplacement",value:function(e,t){var n=e.getCurrentPlayer(),r=e.pieces.reverse().get(n).get();return this.getDeplacementFrom(e,r,t)}},{key:"getBoardValue",value:function(e){var t=e.move,n=e.gameState,r=n.getCurrentOpponent(),i=r.getVictoryValue(),a={status:kre.DEFAULT,victory:cB.empty(),preVictory:cB.empty(),sum:0};t.isPresent()&&(a=this.calculateBoardValue(t.get(),n));var o=cB.empty();if(a.status===kre.DEFAULT&&a.preVictory.isPresent()&&(o=cB.of(a.preVictory.get())),a.status===kre.VICTORY)return new vde(i,cB.empty());if(n.turn>39){var s=n.countPieces(),u=s[0],c=s[1];return u<6&&c<6?new vde(u<c?Zee.ONE.getVictoryValue():c<u?Zee.ZERO.getVictoryValue():0,cB.empty()):u<6?new vde(Zee.ZERO.getDefeatValue(),cB.empty()):c<6?new vde(Zee.ONE.getDefeatValue(),cB.empty()):new vde(u-c,o)}return new vde(a.status===kre.PRE_VICTORY?r.getPreVictory():a.sum*r.getScoreModifier(),o)}},{key:"startSearchingVictorySources",value:function(){aB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(aB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){aB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(rre.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return{status:kre.PRE_VICTORY,victory:cB.empty(),preVictory:cB.empty(),sum:0};var o=(e+i.length)%6;i.push(a),a=a.getNext(rre.factory.all[o],1)}return{status:kre.VICTORY,victory:cB.of(i),preVictory:cB.empty(),sum:0}}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=rre.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return{status:kre.PRE_VICTORY,victory:cB.empty(),preVictory:cB.empty(),sum:0};s=!0,i=i.getOpposite(),a=a.getNext(i,o.length-1)}a=a.getNext(i,1)}return{status:kre.VICTORY,victory:cB.of(o),preVictory:cB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){aB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=rre.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:kre.PRE_VICTORY,victory:cB.empty(),preVictory:cB.empty(),sum:0};a.length%2==0&&(i=rre.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return{status:kre.VICTORY,victory:cB.of(a),preVictory:cB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){aB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=rre.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:kre.PRE_VICTORY,victory:cB.empty(),preVictory:cB.empty(),sum:0};a.push(o),a.length%2==0&&(i=rre.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return{status:kre.VICTORY,victory:cB.of(a),preVictory:cB.empty(),sum:0}}},{key:"getBoardInfo",value:function(e,t,n,r){aB(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:e,move:t,state:n,boardInfo:r});var i=t.landing.getNext(n.offset,1);switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,i,n,r);case"LINE":return this.getBoardInfoForLine(e.index,i,n,r);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,i,n,r);default:return this.getBoardInfoForTriangleEdge(e.index,i,n,r)}}},{key:"getBoardInfoForCircle",value:function(e,t,n,r){aB(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=[t],o=t.getNext(rre.factory.all[e],1),s=0,u=cB.empty();a.length<6;){var c=n.getPieceAt(o);if(c===i)return r;var l=(e+a.length)%6;a.push(o);var h=rre.factory.all[l];c===Zee.NONE?(s+=.16,u=cB.of(o)):s++,o=o.getNext(h,1)}return this.getBoardInfoResult(s,u,a,r)}},{key:"getBoardInfoResult",value:function(e,t,n,r){var i=r.preVictory;if(4.16===e){if(aB(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(t))return{status:kre.PRE_VICTORY,victory:cB.empty(),preVictory:cB.empty(),sum:0};i=t}else if(5===e)return{status:kre.VICTORY,victory:cB.of(n),preVictory:cB.empty(),sum:0};return{status:r.status,victory:cB.empty(),preVictory:i,sum:r.sum+e}}},{key:"getBoardInfoForLine",value:function(e,t,n,r){aB(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=rre.factory.all[e],a=t.getPrevious(i,5),o=[],s=[],u=cB.empty(),c=0;c<6;c++){var l=this.updateEncounterAndReturnLastEmpty(n,a,s);l.isPresent()&&(u=l),o.push(a),a=a.getNext(i,1)}for(var h=r.status,f=r.preVictory,d=0,v=0;d<6;){var p=s.reduce(function(e,t){return e+t});if(6===p)return{status:kre.VICTORY,victory:cB.of(o),preVictory:cB.empty(),sum:0};5.16===p&&h===kre.DEFAULT&&(f.isPresent()?(Z5(!1===f.equals(u),"Impossible to have point aligned with differents line to a same point"),h=kre.PRE_VICTORY):f=u),v=Math.max(v,p),(o=o.slice(1,6)).push(a),s=s.slice(1,6);var g=this.updateEncounterAndReturnLastEmpty(n,a,s);g.isPresent()&&(u=g),d++,a=a.getNext(i,1)}var y={status:h,victory:cB.of(o),preVictory:f,sum:v};return this.getBoardInfoResult(v,u,o,y)}},{key:"updateEncounterAndReturnLastEmpty",value:function(e,t,n){var r=e.getCurrentPlayer();switch(e.getPieceAt(t)){case r:return n.push(-7),cB.empty();case Zee.NONE:return n.push(.16),cB.of(t);default:return n.push(1),cB.empty()}}},{key:"getBoardInfoForTriangleCorner",value:function(e,t,n,r){aB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=rre.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=cB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===Zee.NONE?(u+=.16,c=cB.of(s)):u++,o.length%2==0&&(a=rre.factory.all[(e+o.length)%6]),o.push(s),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}},{key:"getBoardInfoForTriangleEdge",value:function(e,t,n,r){aB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=rre.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=cB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===Zee.NONE?(u+=.16,c=cB.of(s)):u++,o.push(s),o.length%2==0&&(a=rre.factory.all[(e+o.length)%6]),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}}],[{key:"get",value:function(){if(null==n.INSTANCE){var e=new fde(lde);n.INSTANCE=new n(e,"SixMinimax")}return n.INSTANCE}}]),n}(dde),gde=Zee.NONE.value,yde=Zee.ZERO.value,mde=Zee.ONE.value,kde=function(){var e=ip(function e(){np(this,e)});return e.MOVEMENT_NOT_DISCONNECTING=function(){return $localize(xu||(xu=Nv(["This move does not disconnect your opponent's pieces. Try again with another piece."])))},e.MOVEMENT_SELF_DISCONNECTING=function(){return $localize(Au||(Au=Nv(["You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!"])))},e}(),_de=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(Ru||(Ru=Nv(["Six"]))),$localize(Nu||(Nu=Nv(["Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.\n        Each player has 21 pieces, with one for each player already on the board.\n        The goal of the game is to form one of the three winning shapes with your pieces."]))),lde.getInitialState()),Ire.fromMove($localize(Mu||(Mu=Nv(["Victory (line)"]))),$localize(Du||(Du=Nv(["On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>\n        Find the victory. You're playing Dark."]))),lde.fromRepresentation([[yde,mde,mde,mde,mde,yde],[gde,yde,mde,gde,yde,gde],[mde,mde,yde,gde,gde,gde],[gde,gde,yde,gde,gde,gde],[gde,yde,gde,gde,gde,gde],[yde,gde,gde,gde,gde,gde]],0),[hde.fromDrop(new Jne(3,2))],$localize(Lu||(Lu=Nv(["Congratulations!"]))),$localize(Fu||(Fu=Nv(["Failed!"])))),Ire.fromMove($localize(Bu||(Bu=Nv(["Victory (circle)"]))),$localize(Vu||(Vu=Nv(["On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),lde.fromRepresentation([[gde,gde,gde,mde,gde,gde],[gde,gde,mde,mde,yde,yde],[gde,mde,gde,yde,mde,gde],[mde,yde,yde,yde,yde,mde]],0),[hde.fromDrop(new Jne(5,2))],$localize(Uu||(Uu=Nv(["Congratulations! Note that if a piece is inside the circle, it does not change anything."]))),$localize(zu||(zu=Nv(["Failed!"])))),Ire.fromMove($localize(Hu||(Hu=Nv(["Victory (triangle)"]))),$localize(Gu||(Gu=Nv(["On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),lde.fromRepresentation([[gde,gde,gde,mde,gde,gde],[gde,yde,mde,yde,yde,yde],[gde,yde,gde,yde,yde,gde],[mde,mde,mde,gde,mde,gde]],0),[hde.fromDrop(new Jne(3,3))],$localize(qu||(qu=Nv(["Congratulations!"]))),$localize($u||($u=Nv(["Failed!"])))),Ire.fromPredicate($localize(Wu||(Wu=Nv(["Second phase"]))),$localize(ju||(ju=Nv(["After 40 turns, your pieces have all been placed and we move on to the second phase of the game.\n        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.\n        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>\n        You're playing Dark. Make a move that disconnects one of your opponent's pieces."]))),lde.fromRepresentation([[gde,gde,gde,gde,gde,gde,gde,mde,gde],[gde,gde,gde,gde,gde,gde,yde,gde,gde],[gde,gde,gde,gde,yde,yde,yde,gde,gde],[gde,gde,gde,gde,mde,mde,gde,mde,yde],[gde,yde,mde,mde,yde,yde,mde,gde,gde],[yde,yde,yde,yde,mde,mde,mde,yde,gde],[mde,mde,yde,gde,mde,mde,yde,gde,gde],[gde,yde,gde,yde,yde,gde,gde,gde,gde],[mde,mde,mde,mde,gde,gde,gde,gde,gde],[gde,yde,gde,mde,gde,gde,gde,gde,gde]],40),hde.fromMovement(new Jne(6,1),new Jne(5,1)),function(e,t){var n=t.countPieces();return 19===n[0]?18===n[1]?$5.SUCCESS:$5.failure(kde.MOVEMENT_NOT_DISCONNECTING()):$5.failure(kde.MOVEMENT_SELF_DISCONNECTING())},$localize(Zu||(Zu=Nv(["Congratulations, your opponent now has one piece less and you're closer to victory!"])))),Ire.fromPredicate($localize(Yu||(Yu=Nv(["Victory by disconnection"]))),$localize(Ku||(Ku=Nv(["During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.\n        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.\n        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>\n        Here, you're playing Dark and you can win. Do it!"]))),lde.fromRepresentation([[gde,gde,gde,gde,gde,mde],[gde,gde,gde,gde,yde,mde],[gde,gde,gde,mde,yde,yde],[gde,gde,yde,gde,mde,yde],[mde,mde,gde,gde,gde,yde],[yde,mde,gde,gde,gde,gde],[yde,gde,gde,gde,gde,gde]],40),hde.fromMovement(new Jne(2,3),new Jne(3,3)),function(e,t){return e.start.equalsValue(new Jne(2,3))?$5.SUCCESS:$5.failure(kde.MOVEMENT_NOT_DISCONNECTING())},$localize(Ju||(Ju=Nv(["Congratulations, you won!"])))),Ire.fromPredicate($localize(Qu||(Qu=Nv(["Special disconnection"]))),$localize(Xu||(Xu=Nv(["During a disconnection, two or more groups could have the same size,\n        in which case you will have to click on the group you wish to keep.<br/><br/>\n        You're playing Dark, play such a move!"]))),lde.fromRepresentation([[gde,gde,gde,gde,gde,mde],[gde,gde,gde,gde,yde,mde],[gde,gde,gde,mde,yde,yde],[yde,gde,yde,gde,gde,mde],[mde,mde,gde,gde,gde,gde],[yde,yde,gde,gde,gde,gde],[yde,gde,gde,gde,gde,gde]],40),hde.fromCut(new Jne(2,3),new Jne(2,5),new Jne(2,5)),function(e,t){return e.keep.isAbsent()?$5.failure($localize(ec||(ec=Nv(["This move has not cut the board in two equal halves."])))):t.getPieceAt(e.landing.getNext(t.offset))===Zee.NONE?$5.failure($localize(tc||(tc=Nv(["Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again."])))):$5.SUCCESS},$localize(nc||(nc=Nv(["Congratulations, you won!"]))))]});function wde(e,t){if(1&e){var n=gb();wm(),hb(0,"polyline",10),kb("click",function(){var e=Wy(n).$implicit;return Cb().onPieceClick(e)}),fb()}if(2&e){var r=t.$implicit,i=Cb();Eb("id","piece_",r.x,"_",r.y,""),cb("ngClass",i.getPieceClass(r)),nb("points",i.getHexaCoordsAt(r))}}function Cde(e,t){if(1&e){var n=gb();wm(),hb(0,"polyline",11),kb("click",function(){var e=Wy(n).$implicit;return Cb().onNeighborClick(e)}),fb()}if(2&e){var r=t.$implicit,i=Cb();Eb("id","neighbor_",r.x,"_",r.y,""),nb("points",i.getHexaCoordsAt(r))}}function bde(e,t){if(1&e){var n=gb();wm(),hb(0,"polyline",10),kb("click",function(){Wy(n);var e=Cb();return e.onPieceClick(e.chosenLanding.get())}),fb()}if(2&e){var r=Cb();Eb("id","chosenLanding_",r.chosenLanding.get().x,"_",r.chosenLanding.get().y,""),cb("ngClass",r.getPlayerClass(r.state.getCurrentPlayer())),nb("points",r.getHexaCoordsAt(r.chosenLanding.get()))}}function Ede(e,t){if(1&e&&(wm(),db(0,"polyline",12)),2&e){var n=t.$implicit,r=Cb();Eb("id","disconnected_",n.x,"_",n.y,""),nb("points",r.getHexaCoordsAt(n))}}function Sde(e,t){if(1&e){var n=gb();wm(),hb(0,"polyline",13),kb("click",function(){Wy(n);var e=Cb();return e.onNeighborClick(e.leftCoord.get())}),fb()}if(2&e){var r=Cb();Eb("id","leftCoord_",r.leftCoord.get().x,"_",r.leftCoord.get().y,""),nb("points",r.getHexaCoordsAt(r.leftCoord.get()))}}function Pde(e,t){if(1&e){var n=gb();wm(),hb(0,"polyline",14),kb("click",function(){Wy(n);var e=Cb();return e.onPieceClick(e.lastDrop.get())}),fb()}if(2&e){var r=Cb();Eb("id","lastDrop_",r.lastDrop.get().x,"_",r.lastDrop.get().y,""),nb("points",r.getHexaCoordsAt(r.lastDrop.get()))}}function Ode(e,t){if(1&e){var n=gb();wm(),hb(0,"polyline",15),kb("click",function(){Wy(n);var e=Cb();return e.onPieceClick(e.selectedPiece.get())}),fb()}if(2&e){var r=Cb();Eb("id","selectedPiece_",r.selectedPiece.get().x,"_",r.selectedPiece.get().y,""),cb("ngClass",r.getSelectedPieceClass()),nb("points",r.getHexaCoordsAt(r.selectedPiece.get()))}}function Tde(e,t){if(1&e&&(wm(),db(0,"polyline",16)),2&e){var n=t.$implicit,r=Cb();Eb("id","victoryCoord_",n.x,"_",n.y,""),nb("points",r.getHexaCoordsAt(n))}}function Ide(e,t){if(1&e){var n=gb();wm(),hb(0,"g",19),kb("click",function(){var e=Wy(n).$implicit;return Cb(2).onPieceClick(e)}),db(1,"polyline",20),fb()}if(2&e){var r=t.$implicit,i=Cb(2);Ow(1),Eb("id","cuttable_",r.x,"_",r.y,""),nb("points",i.getHexaCoordsAt(r))}}function xde(e,t){if(1&e&&(wm(),hb(0,"g",17),ob(1,Ide,2,3,"g",18),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}var Ade=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).disconnecteds=[],r.cuttableGroups=[],r.leftCoord=cB.empty(),r.lastDrop=cB.empty(),r.selectedPiece=cB.empty(),r.chosenLanding=cB.empty(),r.nextClickShouldSelectGroup=!1,r.rules=new fde(lde),r.availableMinimaxes=[new pde(r.rules,"SixMinimax")],r.encoder=hde.encoder,r.tutorial=(new _de).tutorial,r.SPACE_SIZE=30,r.hexaLayout=new ire(1.5*r.SPACE_SIZE,new Jne(2*r.SPACE_SIZE,0),sre.INSTANCE),r.updateBoard(),r}return ip(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=cB.empty(),this.chosenLanding=cB.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.rules.node.move.isPresent()?this.showLastMove():(this.leftCoord=cB.empty(),this.lastDrop=cB.empty(),this.victoryCoords=[],this.disconnecteds=[]),this.pieces=this.state.pieces.listKeys(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}},{key:"getViewBox",value:function(){var e=this.mapAbstractCoordToCornerCoords(),t=this.getLimits(e);return t.minX-this.STROKE_WIDTH/2+" "+(t.minY-this.STROKE_WIDTH/2)+" "+(this.STROKE_WIDTH+t.maxX-t.minX)+" "+(this.STROKE_WIDTH+t.maxY-t.minY)}},{key:"mapAbstractCoordToCornerCoords",value:function(){var e,t=this,n=[],r=Xv(this.pieces.concat(this.disconnecteds).concat(this.neighbors).map(function(e){return t.hexaLayout.getHexaCoordsAt(e)}));try{for(r.s();!(e=r.n()).done;){var i=e.value;n=n.concat(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getLimits",value:function(e){var t,n=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,o=Xv(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;s.x<i&&(i=s.x),s.y<a&&(a=s.y),n=Math.max(n,s.x),r=Math.max(r,s.y)}}catch(u){o.e(u)}finally{o.f()}return{minX:i,minY:a,maxX:n,maxY:r}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();this.lastDrop=cB.of(e.landing.getNext(this.state.offset,1)),this.leftCoord=!1===e.isDrop()?cB.of(e.start.get().getNext(this.state.offset,1)):cB.empty();var t=this.rules.node.gameState;this.rules.getGameStatus(this.rules.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,t)),this.disconnecteds=this.getDisconnected()}},{key:"getDisconnected",value:function(){var e,t=this,n=this.rules.node.mother.get().gameState.pieces.listKeys(),r=this.rules.node.gameState.pieces.listKeys(),i=[],a=Xv(n);try{var o=function(){var n=e.value;!1===t.rules.node.move.get().start.equalsValue(n)&&!1===r.some(function(e){return e.equals(n.getNext(t.state.offset,1))})&&i.push(n.getNext(t.state.offset,1))};for(a.s();!(e=a.n()).done;)o()}catch(u){a.e(u)}finally{a.f()}var s=this.lastDrop.get();return!1===this.pieces.some(function(e){return e.equals(s)})&&!1===r.some(function(e){return e.equals(s)})&&i.push(s),i}},{key:"getEmptyNeighbors",value:function(){var e=fde.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){var t=this.chosenLanding.get();e=e.filter(function(e){return!1===e.equals(t)})}return e}},{key:"getPieceClass",value:function(e){var t=this.rules.node.gameState.getPieceAt(e);return this.getPlayerClass(t)}},{key:"onPieceClick",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#piece_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!(t.state.turn<40)){n.next=5;break}return n.abrupt("return",t.cancelMove(cde.NO_MOVEMENT_BEFORE_TURN_40()));case 5:if(!t.chosenLanding.isAbsent()){n.next=7;break}return n.abrupt("return",t.state.getPieceAt(e)===t.state.getCurrentOpponent()?t.cancelMove(ure.CANNOT_CHOOSE_OPPONENT_PIECE()):(t.selectedPiece=cB.of(e),$5.SUCCESS));case 7:return i=hde.fromCut(t.selectedPiece.get(),t.chosenLanding.get(),e),n.abrupt("return",t.chooseMove(i,t.state));case 9:case"end":return n.stop()}},n)}))()}},{key:"onNeighborClick",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#neighbor_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.nextClickShouldSelectGroup){n.next=5;break}return n.abrupt("return",t.cancelMove(cde.MUST_CUT()));case 5:if(!(t.state.turn<40)){n.next=7;break}return n.abrupt("return",t.chooseMove(hde.fromDrop(e),t.state));case 7:if(!t.selectedPiece.isAbsent()){n.next=9;break}return n.abrupt("return",t.cancelMove(cde.CAN_NO_LONGER_DROP()));case 9:return i=hde.fromMovement(t.selectedPiece.get(),e),a=fde.isLegalPhaseTwoMove(i,t.state),n.abrupt("return",t.neededCutting(a)?(t.chosenLanding=cB.of(e),t.moveVirtuallyPiece(),t.showCuttable(),t.nextClickShouldSelectGroup=!0,$5.SUCCESS):t.chooseMove(i,t.state));case 11:case"end":return n.stop()}},n)}))()}},{key:"neededCutting",value:function(e){return e.isFailure()&&e.getReason()===cde.MUST_CUT()}},{key:"moveVirtuallyPiece",value:function(){var e=this.selectedPiece.get();this.pieces=this.pieces.filter(function(t){return!1===t.equals(e)}),this.neighbors=this.getEmptyNeighbors()}},{key:"showCuttable",value:function(){var e=hde.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),t=lde.deplacePiece(this.state,e),n=lde.getGroups(t,e.start.get()),r=fde.getBiggerGroups(n);this.cuttableGroups=[];var i,a=Xv(r);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.cuttableGroups.push(o.toList())}}catch(s){a.e(s)}finally{a.f()}}},{key:"getSelectedPieceClass",value:function(){return this.chosenLanding.isPresent()?"moved":"selected"}}]),n}(tre);return e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-six"]],features:[HC],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured",3,"id",4,"ngFor","ngForOf"],["class","base round moved mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round highlighted mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured",3,"id"],[1,"base","round","moved","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","highlighted","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["stroke-linecap","round",1,"no-fill",3,"id"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),ob(1,wde,1,4,"polyline",1),ob(2,Cde,1,3,"polyline",2),ob(3,bde,1,4,"polyline",3),ob(4,Ede,1,3,"polyline",4),ob(5,Sde,1,3,"polyline",5),ob(6,Pde,1,3,"polyline",6),ob(7,Ode,1,4,"polyline",7),ob(8,Tde,1,3,"polyline",8),ob(9,xde,2,1,"g",9),fb()),2&e&&(nb("viewBox",t.viewBox),Ow(1),cb("ngForOf",t.pieces),Ow(1),cb("ngForOf",t.neighbors),Ow(1),cb("ngIf",t.chosenLanding.isPresent()),Ow(1),cb("ngForOf",t.disconnecteds),Ow(1),cb("ngIf",t.leftCoord.isPresent()),Ow(1),cb("ngIf",t.lastDrop.isPresent()),Ow(1),cb("ngIf",t.selectedPiece.isPresent()),Ow(1),cb("ngForOf",t.victoryCoords),Ow(1),cb("ngForOf",t.cuttableGroups))},directives:[NT,DT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Rde=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getMaximalDistance",value:function(){return 9}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return H5.success(r)}catch(r){return H5.failure(r.message)}}}]),n}(Cie);Rde.encoder=_ie.getEncoder(9,9,Rde.of);var Nde={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:Zee.ZERO},Mde=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=Sie.UNOCCUPIED,t=Sie.INVADERS,r=Sie.DEFENDERS;return new n([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,r,e,e,e,e],[t,e,e,e,r,e,e,e,t],[t,t,r,r,Sie.PLAYER_ONE_KING,r,r,t,t],[t,e,e,e,r,e,e,e,t],[e,e,e,e,r,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}}]),n}(Oie),Dde=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.call(this,Mde,Nde,Rde.of)}return ip(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),bre.ruler=this.singleton,n.singleton}}]),n}(Iie),Lde=Sie.UNOCCUPIED,Fde=Sie.INVADERS,Bde=Sie.DEFENDERS,Vde=Sie.PLAYER_ONE_KING,Ude=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(rc||(rc=Nv(["Goal of the game"]))),$localize(ic||(ic=Nv(["Tablut is a strategy game that was played by the Vikings.\n        The goal of the game is different for each player.\n        The attacker plays first. Its pieces (dark) are close to the edges.\n        Its goal is to capture the king, which is in the center of the board.\n        The defender plays second. Its pieces (light) are in the middle.\n        Its goal is to move the king on one of the 4 thrones in the corners.\n        Note that the square in which the king starts, in the center of the board, is also a throne."]))),Mde.getInitialState()),Ire.anyMove($localize(ac||(ac=Nv(["Moving"]))),$localize(oc||(oc=Nv(["All pieces move the same way.\n        Similarly to a rook in chess, a piece can move:\n        <ol>\n            <li>By as many squares as you want.</li>\n            <li>Without going over another piece or stopping on another piece.</li>\n            <li>Horizontally or vertically.</li>\n            <li>Only the king can land on a throne.</li>\n        </ol>\n        To move a piece, click on it and then on its landing square.<br/><br/>\n        You're playing Dark, do the first move."]))),Mde.getInitialState(),Rde.of(new Jne(4,1),new Jne(1,1)),$localize(sc||(sc=Nv(["Congratulations!"])))),Ire.fromMove($localize(uc||(uc=Nv(["Capturing a soldier (1/2)"]))),$localize(cc||(cc=Nv(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new Mde([[Lde,Lde,Lde,Fde,Fde,Fde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Fde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Bde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Fde,Bde,Lde,Lde,Lde,Fde],[Fde,Fde,Bde,Bde,Vde,Bde,Bde,Fde,Fde],[Lde,Lde,Lde,Lde,Bde,Lde,Lde,Lde,Fde],[Lde,Lde,Lde,Lde,Bde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Fde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Fde,Fde,Fde,Lde,Lde,Lde]],1),[Rde.of(new Jne(2,4),new Jne(2,3)),Rde.of(new Jne(4,2),new Jne(3,2))],$localize(lc||(lc=Nv(["Congratulations, that will teach him a lesson!"]))),$localize(hc||(hc=Nv(["Failed, you missed an opportunity to capture a piece of the opponent."])))),Ire.fromMove($localize(fc||(fc=Nv(["Capturing a soldier (2/2)"]))),$localize(dc||(dc=Nv(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new Mde([[Lde,Lde,Lde,Fde,Fde,Fde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Fde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Bde,Lde,Lde,Lde,Lde],[Lde,Lde,Bde,Lde,Vde,Lde,Bde,Lde,Fde],[Fde,Fde,Lde,Bde,Lde,Bde,Bde,Fde,Fde],[Lde,Lde,Lde,Lde,Bde,Lde,Lde,Lde,Fde],[Lde,Lde,Lde,Lde,Bde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Fde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Fde,Fde,Fde,Lde,Lde,Lde]],12),[Rde.of(new Jne(1,4),new Jne(2,4))],$localize(vc||(vc=Nv(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(pc||(pc=Nv(["Failed, you did not do the expected move."])))),Ire.fromMove($localize(gc||(gc=Nv(["Capturing the king (1/2)"]))),$localize(yc||(yc=Nv(["To capture the king, two soldiers are not enough.\n        For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.\n        This also works if the king is on the throne.<br/><br/>\n        Capture the king."]))),new Mde([[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Fde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Fde,Vde,Lde,Fde,Lde,Lde,Lde,Lde,Lde],[Lde,Fde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde]],72),[Rde.of(new Jne(3,4),new Jne(2,4))],$localize(mc||(mc=Nv(["Congratulations, you won!"]))),$localize(kc||(kc=Nv(["Failed, you let the king run away."])))),Ire.fromMove($localize(_c||(_c=Nv(["Capturing the king (2/2)"]))),$localize(wc||(wc=Nv(["Another way to capture the king is to immobilize it against an edge of the board.\n        Note that the king cannot be captured next to a throne.<br/><br/>\n        Capture the king."]))),new Mde([[Lde,Lde,Fde,Vde,Fde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Fde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde],[Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde,Lde]],72),[Rde.of(new Jne(3,3),new Jne(3,1))],$localize(Cc||(Cc=Nv(["The king is dead, long live the king. Congratulations, you won."]))),$localize(bc||(bc=Nv(["Failed!"]))))]});function zde(e,t){if(1&e){var n=gb();wm(),hb(0,"polyline",6),kb("click",function(){Wy(n);var e=Cb(2).index,t=Cb().index;return Cb().onClick(e,t)}),fb()}if(2&e){var r=Cb(2).index,i=Cb().index,a=Cb();nb("transform","translate("+r*a.SPACE_SIZE+" "+i*a.SPACE_SIZE+")")}}function Hde(e,t){if(1&e){var n=gb();wm(),hb(0,"polyline",7),kb("click",function(){Wy(n);var e=Cb(2).index,t=Cb().index;return Cb().onClick(e,t)}),fb()}if(2&e){var r=Cb(2).index,i=Cb().index,a=Cb();nb("transform","translate("+r*a.SPACE_SIZE+" "+i*a.SPACE_SIZE+")")}}function Gde(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,zde,1,1,"polyline",4),ob(2,Hde,1,1,"ng-template",null,5,IP),fb()),2&e){var n=sb(3),r=Cb().index,i=Cb().index,a=Cb();Ow(1),cb("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function qde(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"line",11),kb("click",function(){Wy(n);var e=Cb(2).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),hb(2,"line",11),kb("click",function(){Wy(n);var e=Cb(2).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),hb(3,"line",11),kb("click",function(){Wy(n);var e=Cb(2).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),hb(4,"line",11),kb("click",function(){Wy(n);var e=Cb(2).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),hb(5,"line",11),kb("click",function(){Wy(n);var e=Cb(2).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),fb()}if(2&e){var r=Cb(2).index,i=Cb().index,a=Cb();Ow(1),nb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.04*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.96*a.SPACE_SIZE),Ow(1),nb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.2*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.05*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.65*a.SPACE_SIZE),Ow(1),nb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.2*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.95*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.65*a.SPACE_SIZE),Ow(1),nb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.4*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.15*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.75*a.SPACE_SIZE),Ow(1),nb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.4*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.85*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.75*a.SPACE_SIZE)}}function $de(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"polyline",13),kb("click",function(){Wy(n);var e=Cb(3).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),fb()}if(2&e){var r=Cb(3).index,i=Cb().index,a=Cb();Ow(1),nb("points",a.getKingPolyline(r,i))}}function Wde(e,t){if(1&e){var n=gb();wm(),hb(0,"line",11),kb("click",function(){Wy(n);var e=Cb(3).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),hb(1,"line",11),kb("click",function(){Wy(n);var e=Cb(3).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),hb(2,"line",11),kb("click",function(){Wy(n);var e=Cb(3).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),hb(3,"line",11),kb("click",function(){Wy(n);var e=Cb(3).index,t=Cb().index;return Cb().onClick(e,t)}),fb()}if(2&e){var r=Cb(3).index,i=Cb().index,a=Cb();nb("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.04*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.96*a.SPACE_SIZE),Ow(1),nb("x1",a.SPACE_SIZE*r+.04*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.5*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.96*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.5*a.SPACE_SIZE),Ow(1),nb("x1",a.SPACE_SIZE*r+.15*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.15*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.85*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.85*a.SPACE_SIZE),Ow(1),nb("x1",a.SPACE_SIZE*r+.85*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.15*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.15*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.85*a.SPACE_SIZE)}}function jde(e,t){if(1&e&&(wm(),ob(0,$de,2,1,"g",9),ob(1,Wde,4,16,"ng-template",null,12,IP)),2&e){var n=sb(2),r=Cb(2).index,i=Cb().index;cb("ngIf",Cb().isKing(r,i))("ngIfElse",n)}}function Zde(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"circle",8),kb("click",function(){Wy(n);var e=Cb().index,t=Cb().index;return Cb().onClick(e,t)}),fb(),ob(2,qde,6,20,"g",9),ob(3,jde,3,2,"ng-template",null,10,IP),fb()}if(2&e){var r=sb(4),i=Cb().index,a=Cb().index,o=Cb();Ow(1),cb("ngClass",o.getPieceClasses(i,a)),nb("r",(o.SPACE_SIZE-o.STROKE_WIDTH)/2)("cx",o.SPACE_SIZE*i+.5*o.SPACE_SIZE)("cy",o.SPACE_SIZE*a+.5*o.SPACE_SIZE),Ow(1),cb("ngIf",o.isInvader(i,a))("ngIfElse",r)}}function Yde(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"rect",2),kb("click",function(){var e=Wy(n).index,t=Cb().index;return Cb().onClick(e,t)}),fb(),ob(2,Gde,4,2,"g",3),ob(3,Zde,5,6,"g",3),fb()}if(2&e){var r=t.index,i=Cb().index,a=Cb();Ow(1),Eb("id","click_",r,"_",i,""),cb("ngClass",a.getRectClasses(r,i)),nb("x",a.SPACE_SIZE*r)("y",a.SPACE_SIZE*i)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Ow(1),cb("ngIf",a.board[i][r]===a.NONE&&a.isThrone(r,i)),Ow(1),cb("ngIf",a.board[i][r]!==a.NONE)}}function Kde(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,Yde,4,9,"g",1),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}function Jde(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"rect",14),kb("click",function(){var e=Wy(n).$implicit;return Cb().onClick(e.x,e.y)}),fb(),fb()}if(2&e){var r=t.$implicit,i=Cb();Ow(1),Eb("id","click_",r.x,"_",r.y,""),nb("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var Qde=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e,!1,Rde.from)).rules=Dde.get(),r.availableMinimaxes=[new Rie(r.rules,"DummyBot"),new Lie(r.rules,"Piece > Influence"),new Fie(r.rules,"Piece > Control"),new Bie(r.rules,"Escape > Piece > Control")],r.encoder=Rde.encoder,r.tutorial=(new Ude).tutorial,r.updateBoard(),r}return ip(n)}(Aie);return e.\u0275fac=function(t){return new(t||e)(ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-tablut"]],features:[HC],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],[4,"ngIf"],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15","class","base",3,"click",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15",1,"base",3,"click"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60, 10 20",1,"base",3,"click"],[1,"base",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"click"],["soldierDefender",""],[1,"base","no-fill",3,"click"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),ob(1,Kde,2,1,"g",1),ob(2,Jde,2,6,"g",1),fb()),2&e&&(nb("viewBox",t.getViewBox()),Ow(1),cb("ngForOf",t.board),Ow(1),cb("ngForOf",t.getClickables()))},directives:[NT,AT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Xde=ip(function e(){np(this,e)});Xde.PLACEMENT_AFTER_INITIAL_PHASE=function(){return $localize(Ec||(Ec=Nv(["You cannot put a new ring after the tenth turn."])))},Xde.NO_MARKERS_IN_INITIAL_PHASE=function(){return $localize(Sc||(Sc=Nv(["You cannot put a marker in a ring before placing all of your rings."])))},Xde.MISSING_CAPTURES=Use.MISSING_CAPTURES,Xde.MOVE_DIRECTION_INVALID=function(){return $localize(Pc||(Pc=Nv(["The direction of your move is invalid: a move is made along a straight line."])))},Xde.CAN_ONLY_CAPTURE_YOUR_MARKERS=function(){return $localize(Oc||(Oc=Nv(["You can only capture your own markers."])))},Xde.SHOULD_SELECT_PLAYER_RING=function(){return $localize(Tc||(Tc=Nv(["You must pick one of your own rings to move."])))},Xde.SHOULD_END_MOVE_ON_EMPTY_SPACE=function(){return $localize(Ic||(Ic=Nv(["Your ring must land on an empty space."])))},Xde.MOVE_SHOULD_NOT_PASS_ABOVE_RING=function(){return $localize(xc||(xc=Nv(["A ring can only jump over markers or empty spaces, not over another ring."])))},Xde.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=function(){return $localize(Ac||(Ac=Nv(["Your ring must land on the first empty space after a group of markers."])))},Xde.AMBIGUOUS_CAPTURE_COORD=Use.AMBIGUOUS_CAPTURE_COORD,Xde.CAPTURE_SHOULD_TAKE_RING=function(){return $localize(Rc||(Rc=Nv(["When you capture markers, you must take one of your ring as well by clicking on it."])))};var eve=function(){function e(t,n){np(this,e),this.player=t,this.isRing=n}return ip(e,[{key:"equals",value:function(e){return this===e}},{key:"flip",value:function(){return Z5(!1===this.isRing,"cannot flip a ring (it should never happen)"),Z5(this.player!==Zee.NONE,"cannot flip a non-piece (it should never happen)"),e.of(this.player.getOpponent(),this.isRing)}},{key:"toString",value:function(){switch(this){case e.NONE:return"NONE";case e.EMPTY:return"EMPTY";case e.MARKER_ZERO:return"MARKER_ZERO";case e.MARKER_ONE:return"MARKER_ONE";case e.RING_ZERO:return"RING_ZERO";default:return iB.expectToBe(this,e.RING_ONE),"RING_ONE"}}}],[{key:"of",value:function(t,n){return t===Zee.NONE?e.EMPTY:n?e.RINGS[t.value]:e.MARKERS[t.value]}}]),e}();eve.encoder=jee.tuple([Zee.numberEncoder,jee.booleanEncoder],function(e){return[e.player,e.isRing]},function(e){return eve.of(e[0],e[1])}),eve.NONE=new eve(Zee.NONE,!1),eve.EMPTY=new eve(Zee.NONE,!1),eve.MARKER_ZERO=new eve(Zee.ZERO,!1),eve.MARKER_ONE=new eve(Zee.ONE,!1),eve.MARKERS=[eve.MARKER_ZERO,eve.MARKER_ONE],eve.RING_ZERO=new eve(Zee.ZERO,!0),eve.RING_ONE=new eve(Zee.ONE,!0),eve.RINGS=[eve.RING_ZERO,eve.RING_ONE];var tve=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r,i){var a;return np(this,n),(a=t.call(this,i,e,n.SIZE,n.SIZE,[6,4,3,2,1],eve.EMPTY)).sideRings=r,a}return ip(n,[{key:"isInitialPlacementPhase",value:function(){return this.turn<10}},{key:"countScores",value:function(){return this.turn<10?[0,0]:this.sideRings}},{key:"equals",value:function(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&Q5.compareTable(this.board,e.board)}},{key:"getRingCoords",value:function(e){var t=[];return this.forEachCoord(function(n,r){r.isRing&&r.player===e&&t.push(n)}),t}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==eve.NONE}},{key:"setAtUnsafe",value:function(e,t){var r=Q5.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.sideRings,this.turn)}}],[{key:"getInitialState",value:function(){var e=eve.EMPTY,t=eve.NONE;return new n([[t,t,t,t,t,t,e,e,e,e,t],[t,t,t,t,e,e,e,e,e,e,e],[t,t,t,e,e,e,e,e,e,e,e],[t,t,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,t,t],[e,e,e,e,e,e,e,e,t,t,t],[e,e,e,e,e,e,e,t,t,t,t],[t,e,e,e,e,t,t,t,t,t,t]],[5,5],0)}}]),n}(_oe);return e.SIZE=11,e}(),nve=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;if(np(this,n),i=t.call(this,e),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");return i.ringTaken=cB.ofNullable(r),jv(i)}return ip(n,[{key:"setRingTaken",value:function(e){return new n(this.capturedSpaces,e)}},{key:"equals",value:function(e){return!(!1===Hv(Kv(n.prototype),"equals",this).call(this,e)||!1===this.ringTaken.equals(e.ringTaken))}}],[{key:"of",value:function(e,t,r){for(var i=[],a=rre.factory.fromMove(e,t).get(),o=e;!1===o.equals(t);o=o.getNext(a))i.push(o);return i.push(t),new n(i,r)}}]),n}(Lse);nve.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"encode",value:function(e){return{captured:e.capturedSpaces.map(function(e){return Jne.encoder.encode(e)}),ringTaken:Jne.encoder.encode(e.ringTaken.get())}}},{key:"decode",value:function(e){var t=e;return Z5(null!=t.captured&&null!=t.ringTaken,"Invalid encoded YinshCapture"),new nve(t.captured.map(function(e){return Jne.encoder.decode(e)}),Jne.encoder.decode(t.ringTaken))}}]),n}($ee));var rve=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a){var o;return np(this,n),(o=t.call(this)).initialCaptures=e,o.start=r,o.end=i,o.finalCaptures=a,o}return ip(n,[{key:"isInitialPlacement",value:function(){return this.end.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===Q5.compareArray(this.initialCaptures,e.initialCaptures)||!1===Q5.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"toString",value:function(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=Xv(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}}]),n}(gre);rve.coordOptionalEncoder=Dse(Jne.encoder),rve.encoder=new(function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"encodeMove",value:function(e){var t={moveStart:Jne.encoder.encode(e.start),moveEnd:rve.coordOptionalEncoder.encode(e.end)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=nve.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=nve.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return Z5(null!=t.moveStart,"Invalid encoded YinshMove"),new rve(this.decodeArray(t,"initialCapture",nve.encoder.decode),Jne.encoder.decode(t.moveStart),rve.coordOptionalEncoder.decode(t.moveEnd),this.decodeArray(t,"finalCapture",nve.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(Wee));var ive=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return t.isEndGame?lre.fromWinner(t.winner):new lre(e.gameState.sideRings[0]*Zee.ZERO.getScoreModifier()+e.gameState.sideRings[1]*Zee.ONE.getScoreModifier())}},{key:"getListMoves",value:function(e){var t=this,n=[],r=e.gameState;if(r.isInitialPlacementPhase()){var i,a=Xv(r.getCoordsAndContents());try{for(a.s();!(i=a.n()).done;){var o=Fv(i.value,2),s=o[0];o[1]===eve.EMPTY&&n.push(new rve([],s,cB.empty(),[]))}}catch(c){a.e(c)}finally{a.f()}}else{var u=this.ruler;this.getPossibleCaptureCombinations(r).forEach(function(e){var i=u.applyCaptures(r,e);t.getRingMoves(i).forEach(function(r){var a=u.applyRingMoveAndFlip(i,r.start,r.end);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new rve(e,r.start,cB.of(r.end),t);n.push(i)})})})}return n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=this.ruler.getPossibleCaptures(e),n=this.getRingCoords(e);return Hse.getPossibleCaptureCombinationsFromPossibleCaptures(t).map(function(e){return function(){function e(){np(this,e)}return ip(e,null,[{key:"getCombinations",value:function(e,t){var n=this;return Z5(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(function(e){return n.getPermutations(e)}).reduce(function(e,t){return e.concat(t)})}},{key:"getPermutations",value:function(e){for(var t=e.length,n=[e.slice()],r=new Array(t).fill(0),i=1;i<t;)if(r[i]<i){var a=i%2&&r[i],o=e[i];e[i]=e[a],e[a]=o,++r[i],i=1,n.push(e.slice())}else r[i]=0,++i;return n}},{key:"getSubsetsOfSize",value:function(e,t){return function t(n,r){if(r>=e.length||n<1)return[[]];for(var i=[];r<=e.length-n;){var a,o=e[r],s=Xv(t(n-1,r+1));try{for(s.s();!(a=s.n()).done;){var u=a.value;u.push(o),i.push(u)}}catch(c){s.e(c)}finally{s.f()}++r}return i}(t,0)}}]),e}().getCombinations(n,e.length).map(function(t){return e.map(function(e,n){return new nve(e.capturedSpaces,t[n])})})}).reduce(function(e,t){return e.concat(t)},[])}},{key:"getRingMoves",value:function(e){var t,n=this.ruler,r=[],i=Xv(this.getRingCoords(e));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=Xv(n.getRingTargets(e,o));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.push({start:o,end:u})}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getRingCoords",value:function(e){var t=e.getCurrentPlayer().value,n=[];return e.forEachCoord(function(e,r){r===eve.RINGS[t]&&n.push(e)}),n}}]),n}(cre),ave=function(e){qv(n,e);var t=Wv(n);function n(){return np(this,n),t.apply(this,arguments)}return ip(n,[{key:"applyLegalMove",value:function(e,t,n){return new tve(n.board,n.sideRings,n.turn+1)}},{key:"applyCaptures",value:function(e,t){var n=this,r=e;return t.forEach(function(e){r=n.applyCapture(r,e)}),r}},{key:"applyCapture",value:function(e,t){var n=this.applyCaptureWithoutTakingRing(e,t);return this.takeRing(new tve(n,e.sideRings,e.turn),t.ringTaken.get())}},{key:"takeRing",value:function(e,t){var n=e.getCurrentPlayer().value,r=e.setAt(t,eve.EMPTY).board,i=[e.sideRings[0],e.sideRings[1]];return i[n]+=1,new tve(r,i,e.turn)}},{key:"applyCaptureWithoutTakingRing",value:function(e,t){return t.forEach(function(t){e=e.setAt(t,eve.EMPTY)}),e.board}},{key:"ringSelectionValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)===eve.RINGS[n]?$5.SUCCESS:$5.failure(Xde.CAPTURE_SHOULD_TAKE_RING())}},{key:"applyRingMoveAndFlip",value:function(e,t,n){var r=e.getCurrentPlayer().value,i=e.setAt(t,eve.MARKERS[r]);i=i.setAt(n,eve.RINGS[r]);for(var a=rre.factory.fromMove(t,n).get(),o=t.getNext(a);!1===o.equals(n);o=o.getNext(a)){var s=i.getPieceAt(o);s!==eve.EMPTY&&(i=i.setAt(o,s.flip()))}return i}},{key:"isLegal",value:function(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return H5.failure(Xde.NO_MARKERS_IN_INITIAL_PHASE());var n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toFailedFallible();var r=this.applyCaptures(t,e.initialCaptures),i=this.moveValidity(r,e.start,e.end.get());if(i.isFailure())return i.toFailedFallible();var a=this.applyRingMoveAndFlip(r,e.start,e.end.get()),o=this.capturesValidity(a,e.finalCaptures);if(o.isFailure())return o.toFailedFallible();var s=this.applyCaptures(a,e.finalCaptures),u=this.noMoreCapturesValidity(s);return u.isFailure()?u.toFailedFallible():H5.success(s)}},{key:"initialPlacementValidity",value:function(e,t){if(!0!==e.isInitialPlacementPhase())return H5.failure(Xde.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==eve.EMPTY)return H5.failure(ure.MUST_CLICK_ON_EMPTY_SPACE());var n=e.getCurrentPlayer(),r=[e.sideRings[0],e.sideRings[1]];r[n.value]-=1;var i=e.setAt(t,eve.of(n,!0)).board,a=new tve(i,r,e.turn);return H5.success(a)}},{key:"moveStartValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==eve.RINGS[n]?$5.failure(Xde.SHOULD_SELECT_PLAYER_RING()):$5.SUCCESS}},{key:"moveValidity",value:function(e,t,n){var r=this.moveStartValidity(e,t);if(r.isFailure())return r;if(e.getPieceAt(n)!==eve.EMPTY)return $5.failure(Xde.SHOULD_END_MOVE_ON_EMPTY_SPACE());var i=rre.factory.fromMove(t,n);if(i.isFailure())return $5.failure(Xde.MOVE_DIRECTION_INVALID());for(var a=i.get(),o=!1,s=t.getNext(a);!1===s.equals(n);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===eve.EMPTY){if(o)return $5.failure(Xde.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(u.isRing)return $5.failure(Xde.MOVE_SHOULD_NOT_PASS_ABOVE_RING());o=!0}}return $5.SUCCESS}},{key:"capturesValidity",value:function(e,t){var n,r=e,i=Xv(t);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=this.captureValidity(r,a);if(o.isFailure())return o;r=this.applyCapture(r,a)}}catch(s){i.e(s)}finally{i.f()}return $5.SUCCESS}},{key:"captureValidity",value:function(e,t){var n,r=e.getCurrentPlayer().value,i=Xv(t.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(e.getPieceAt(a)!==eve.MARKERS[r])return $5.failure(Xde.CAN_ONLY_CAPTURE_YOUR_MARKERS())}}catch(o){i.e(o)}finally{i.f()}return e.getPieceAt(t.ringTaken.get())!==eve.RINGS[r]?$5.failure(Xde.CAPTURE_SHOULD_TAKE_RING()):$5.SUCCESS}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?$5.SUCCESS:$5.failure(Xde.MISSING_CAPTURES())}},{key:"getLinePortionsWithAtLeastFivePiecesOfPlayer",value:function(e,t){var n=this,r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithAtLeastFivePiecesOfPlayer",value:function(e,t,n){var r,i=0,a=e.getEntranceOnLine(n),o=n.getDirection(),s=a;for(r=a;e.isOnBoard(r);r=r.getNext(o)){var u=e.getPieceAt(r);if(u.player===t&&!1===u.isRing)0===i&&(s=r),i+=1;else{if(i>=5)break;i=0}}return i>=5?cB.of({start:s,end:r,dir:o}):cB.empty()}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(function(e){for(var t=e.start;t.getDistance(e.end)>=5;t=t.getNext(e.dir))n.push(nve.of(t,t.getNext(e.dir,4)))}),n}},{key:"getRingTargets",value:function(e,t){var n,r=[],i=Xv(rre.factory.all);try{for(i.s();!(n=i.n()).done;)for(var a=n.value,o=!1,s=t.getNext(a);e.isOnBoard(s);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===eve.EMPTY){if(r.push(s),o)break}else{if(u.isRing)break;o=!0}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){return e.gameState.isInitialPlacementPhase()?Ere.ONGOING:e.gameState.sideRings[0]>=3?Ere.ZERO_WON:e.gameState.sideRings[1]>=3?Ere.ONE_WON:Ere.ONGOING}}]),n}(Sre),ove=eve.EMPTY,sve=eve.NONE,uve=eve.MARKER_ZERO,cve=eve.RING_ZERO,lve=eve.MARKER_ONE,hve=eve.RING_ONE,fve=function(){var e=ip(function e(){np(this,e)});return e.MUST_ALIGN_FIVE=function(){return $localize(Nc||(Nc=Nv(["Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time."])))},e.MUST_CAPTURE_TWO=function(){return $localize(Mc||(Mc=Nv(["Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again."])))},e}(),dve=ip(function e(){np(this,e),this.tutorial=[Ire.informational($localize(Dc||(Dc=Nv(["Goal of the game"]))),$localize(Lc||(Lc=Nv(["The goal at Yinsh is to capture three rings in total.\n        The rings taken are shown on the top left for the dark player,\n        and on the bottom right for the light player. Here, Dark won the game.\n        Note that on the board you have two types of pieces for each player:\n        rings (empty circles) and markers (full circles)."]))),new tve([[sve,sve,sve,sve,sve,sve,ove,ove,ove,ove,sve],[sve,sve,sve,sve,ove,ove,ove,ove,ove,ove,ove],[sve,sve,sve,uve,hve,ove,ove,ove,ove,ove,ove],[sve,sve,ove,uve,ove,hve,ove,lve,ove,ove,ove],[sve,ove,cve,lve,ove,ove,hve,uve,ove,ove,ove],[sve,ove,ove,uve,lve,ove,ove,ove,ove,ove,sve],[ove,ove,ove,uve,ove,ove,ove,hve,ove,ove,sve],[ove,ove,ove,lve,uve,cve,ove,ove,ove,sve,sve],[ove,ove,ove,ove,ove,ove,ove,ove,sve,sve,sve],[ove,ove,ove,ove,ove,ove,ove,sve,sve,sve,sve],[sve,ove,ove,ove,ove,sve,sve,sve,sve,sve,sve]],[3,1],20)),Ire.anyMove($localize(Fc||(Fc=Nv(["Initial board and placement phase"]))),$localize(Bc||(Bc=Nv(["The initial board is empty.\n        At the beginning of the game, each player puts one of its ring on the board at their turn.\n        This phase stops when all rings have been placed on the board.\n        Put one of your ring on the board by clicking the space where you want to place it."]))),new tve(tve.getInitialState().board,[5,5],0),new rve([],new Jne(5,5),cB.empty(),[]),$localize(Vc||(Vc=Nv(["Congratulations!"])))),Ire.anyMove($localize(Uc||(Uc=Nv(["Putting a marker"]))),$localize(zc||(zc=Nv(["Once the initial phase is done and all rings are on the board, you need to place markers on the board.\n        To do so, put a marker in a ring by clicking on that ring.\n        Then, the ring must be moved in a straight line, in any direction.\n        A ring cannot pass through other rings during its move.\n        If it goes over a group of markers, your move must stop at the first empty space after that group.\n        All markers in the group are then flipped and their color change.<br/><br/>\n        You're playing Dark, do a move."]))),new tve([[sve,sve,sve,sve,sve,sve,ove,ove,ove,ove,sve],[sve,sve,sve,sve,ove,ove,ove,ove,ove,ove,ove],[sve,sve,sve,hve,ove,ove,ove,ove,ove,ove,ove],[sve,sve,hve,ove,ove,hve,ove,ove,ove,ove,ove],[sve,ove,cve,lve,ove,ove,hve,ove,ove,ove,ove],[sve,ove,ove,lve,ove,ove,ove,ove,ove,ove,sve],[ove,ove,ove,ove,cve,ove,ove,hve,ove,ove,sve],[ove,ove,ove,ove,ove,cve,ove,ove,ove,sve,sve],[ove,ove,ove,cve,ove,ove,ove,sve,sve,sve,sve],[ove,ove,ove,ove,ove,ove,ove,sve,sve,sve,sve],[sve,ove,ove,ove,ove,sve,sve,sve,sve,sve,sve]],[0,0],20),new rve([],new Jne(2,4),cB.of(new Jne(4,4)),[]),$localize(Hc||(Hc=Nv(["Congratulations!"])))),Ire.fromPredicate($localize(Gc||(Gc=Nv(["Getting a ring by aligning 5 markers"]))),$localize(qc||(qc=Nv(["Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.\n        To do so, you need to align 5 markers of your color.\n        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.\n        You will then have one more point.\n        You must capture when you can.<br/><br/>\n        You're playing Dark, perform a capture!"]))),new tve([[sve,sve,sve,sve,sve,sve,ove,ove,ove,ove,sve],[sve,sve,sve,sve,ove,ove,ove,ove,ove,ove,ove],[sve,sve,sve,hve,ove,ove,ove,ove,ove,ove,ove],[sve,sve,hve,ove,ove,hve,ove,ove,ove,ove,ove],[sve,ove,uve,uve,cve,lve,lve,ove,ove,ove,ove],[sve,ove,ove,hve,ove,ove,ove,ove,ove,ove,sve],[ove,ove,ove,ove,cve,ove,ove,hve,ove,ove,sve],[ove,ove,ove,ove,ove,cve,ove,ove,ove,sve,sve],[ove,ove,ove,cve,ove,ove,ove,cve,sve,sve,sve],[ove,ove,ove,ove,ove,ove,ove,sve,sve,sve,sve],[sve,ove,ove,ove,ove,sve,sve,sve,sve,sve,sve]],[0,0],20),new rve([],new Jne(4,4),cB.of(new Jne(7,4)),[nve.of(new Jne(2,4),new Jne(6,4),new Jne(7,4))]),function(e,t){return 1===t.sideRings[Zee.ZERO.value]?$5.SUCCESS:$5.failure(fve.MUST_ALIGN_FIVE())},$localize($c||($c=Nv(["Congratulations!"])))),Ire.fromPredicate($localize(Wc||(Wc=Nv(["Compound captures"]))),$localize(jc||(jc=Nv(["During a turn, you could have to choose between multiple captures,\n        or you could even capture multiple times!\n        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>\n        Here, you can capture two rings, do it!"]))),new tve([[sve,sve,sve,sve,sve,sve,ove,ove,ove,ove,sve],[sve,sve,sve,sve,cve,ove,ove,hve,hve,cve,ove],[sve,sve,sve,cve,ove,ove,lve,hve,ove,cve,ove],[sve,sve,ove,cve,ove,ove,ove,ove,ove,hve,ove],[sve,ove,ove,ove,ove,uve,ove,ove,hve,ove,ove],[sve,ove,ove,ove,uve,uve,ove,lve,ove,ove,sve],[ove,ove,ove,uve,ove,uve,ove,ove,ove,ove,sve],[ove,ove,uve,ove,ove,uve,ove,ove,ove,sve,sve],[ove,uve,ove,ove,ove,uve,ove,ove,sve,sve,sve],[ove,ove,ove,ove,ove,uve,ove,sve,sve,sve,sve],[sve,ove,ove,ove,ove,sve,sve,sve,sve,sve,sve]],[0,0],10),new rve([nve.of(new Jne(5,4),new Jne(1,8),new Jne(3,2)),nve.of(new Jne(5,9),new Jne(5,5),new Jne(3,3))],new Jne(4,1),cB.of(new Jne(4,2)),[]),function(e,t){return 2===t.sideRings[Zee.ZERO.value]?$5.SUCCESS:$5.failure(fve.MUST_CAPTURE_TWO())},$localize(Zc||(Zc=Nv(["Congratulations!"]))))]});function vve(e,t){if(1&e&&(wm(),db(0,"circle",9)),2&e){var n=Cb(2).$implicit,r=Cb(2);nb("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringOuterSize)}}function pve(e,t){if(1&e&&(wm(),db(0,"circle",10)),2&e){var n=Cb(2),r=n.index,i=n.$implicit,a=Cb().index,o=Cb();Eb("id","ring_",r,"_",a,""),cb("ngClass",i.ringClasses),nb("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.ringMidSize)}}function gve(e,t){if(1&e&&(wm(),db(0,"circle",9)),2&e){var n=Cb(2).$implicit,r=Cb(2);nb("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringInnerSize)}}function yve(e,t){if(1&e&&(wm(),db(0,"circle",11)),2&e){var n=Cb(2),r=n.index,i=n.$implicit,a=Cb().index,o=Cb();Eb("id","marker_",r,"_",a,""),cb("ngClass",i.markerClasses),nb("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.markerSize)}}function mve(e,t){if(1&e){var n=gb();wm(),hb(0,"g",3),kb("click",function(){Wy(n);var e=Cb().$implicit;return Cb(2).onClick(e.coord)}),db(1,"polyline",4),hb(2,"g",5),ob(3,vve,1,3,"circle",6),ob(4,pve,1,6,"circle",7),ob(5,gve,1,3,"circle",6),ob(6,yve,1,6,"circle",8),fb(),fb()}if(2&e){var r=Cb(),i=r.index,a=r.$implicit,o=Cb().index;Eb("id","click_",i,"_",o,""),Ow(1),Eb("id","space_",i,"_",o,""),cb("ngClass",a.spaceClasses),nb("points",a.coordinates),Ow(1),Eb("id","pieceGroup_",i,"_",o,""),cb("ngClass",a.removedClass),Ow(1),cb("ngIf",a.isRing),Ow(1),cb("ngIf",a.isRing),Ow(1),cb("ngIf",a.isRing),Ow(1),cb("ngIf",a.isMarker)}}function kve(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,mve,7,13,"g",2),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngIf",null!=n)}}function _ve(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,kve,2,1,"g",1),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}function wve(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"polyline",12),kb("click",function(){var e=Wy(n).$implicit;return Cb().onClick(e)}),fb(),fb()}if(2&e){var r=t.$implicit,i=Cb();Ow(1),Eb("id","selected_",r.x,"_",r.y,""),nb("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function Cve(e,t){if(1&e){var n=gb();wm(),hb(0,"polyline",14),kb("click",function(){Wy(n);var e=Cb().$implicit;return Cb().onClick(e)}),fb()}if(2&e){var r=Cb().$implicit,i=Cb();Eb("id","selectable_",r.x,"_",r.y,""),nb("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function bve(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,Cve,1,3,"polyline",13),fb()),2&e){var n=Cb();Ow(1),cb("ngIf",n.isPlayerTurn())}}function Eve(e,t){if(1&e){var n=gb();wm(),hb(0,"g"),hb(1,"rect",15),kb("click",function(){var e=Wy(n).$implicit;return Cb().onClick(e)}),fb(),fb()}if(2&e){var r=t.$implicit,i=Cb();Ow(1),nb("x",i.viewInfo.spaceInfo[r.y][r.x].center.x-i.viewInfo.indicatorSize/2)("y",i.viewInfo.spaceInfo[r.y][r.x].center.y-i.viewInfo.indicatorSize/2)("width",i.viewInfo.indicatorSize)("height",i.viewInfo.indicatorSize)}}function Sve(e,t){if(1&e&&(wm(),hb(0,"g"),db(1,"circle",16),db(2,"circle",9),db(3,"circle",17),fb()),2&e){var n=t.index,r=Cb().$implicit,i=Cb();Ow(1),Eb("id","player_",r,"_sideRing_",n+1,""),nb("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringOuterSize),Ow(1),nb("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringInnerSize),Ow(1),cb("ngClass",i.viewInfo.sideRingClass[r]),nb("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringMidSize)}}var Pve=function(){return[]};function Ove(e,t){if(1&e&&(wm(),hb(0,"g"),ob(1,Sve,4,12,"g",1),fb()),2&e){var n=t.$implicit,r=Cb();Ow(1),cb("ngForOf",tP(1,Pve).constructor(r.viewInfo.sideRings[n]))}}var Tve=function(){return[0,1]},Ive=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,e)).movePhase="MOVE_START",r.moveStart=cB.empty(),r.moveEnd=cB.empty(),r.currentlyMoved=[],r.currentCapture=cB.empty(),r.initialCaptures=[],r.finalCaptures=[],r.possibleCaptures=[],r.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:n.MARKER_SIZE,ringOuterSize:n.RING_OUTER_SIZE,ringMidSize:n.RING_MID_SIZE,ringInnerSize:n.RING_INNER_SIZE,indicatorSize:n.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},r.scores=cB.of([0,0]),r.rules=new ave(tve),r.availableMinimaxes=[new ive(r.rules,"YinshMinimax")],r.encoder=rve.encoder,r.tutorial=(new dve).tutorial,r.hexaLayout=new ire(1.5*n.RING_OUTER_SIZE,new Jne(2*n.RING_OUTER_SIZE,0),sre.INSTANCE),r.constructedState=r.rules.node.gameState,r.constructedState.allCoords().forEach(function(e){null==r.viewInfo.spaceInfo[e.y]&&(r.viewInfo.spaceInfo[e.y]=[]),r.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:r.getHexaCoordsAt(e),center:r.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}}),r}return ip(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.scores=cB.of(this.rules.node.gameState.countScores())}},{key:"updateViewInfo",value:function(){var e=this;this.constructedState.allCoords().forEach(function(t){e.viewInfo.spaceInfo[t.y][t.x].spaceClasses=e.getSpaceClasses(t);var n=e.constructedState.getPieceAt(t);e.viewInfo.spaceInfo[t.y][t.x].removedClass="",e.setRingInfo(t,n),e.setMarkerInfo(t,n)});for(var t=0,n=[Zee.ZERO,Zee.ONE];t<n.length;t++){var r=n[t];this.viewInfo.sideRings[r.value]=this.constructedState.sideRings[r.value]}switch(this.showCurrentMoveCaptures(),this.showLastMove(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];var i,a=Xv(this.possibleCaptures);try{for(a.s();!(i=a.n()).done;){var o,s=Xv(i.value.capturedSpaces);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.viewInfo.selectableCoords.push(u)}}catch(c){s.e(c)}finally{s.f()}}}catch(c){a.e(c)}finally{a.f()}break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.rules.node.gameState.isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}},{key:"showCurrentMoveCaptures",value:function(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());var e,t=Xv(this.initialCaptures);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.markCurrentCapture(n)}}catch(o){t.e(o)}finally{t.f()}var r,i=Xv(this.finalCaptures);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.markCurrentCapture(a)}}catch(o){i.e(o)}finally{i.f()}}},{key:"getSpaceClasses",value:function(e){return this.currentlyMoved.some(function(t){return t.equals(e)})?["moved"]:[]}},{key:"setRingInfo",value:function(e,t){if(t.isRing){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[n+"-stroke"]}else this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[]}},{key:"setMarkerInfo",value:function(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==eve.EMPTY&&(!t.isRing||t.isRing&&this.moveStart.equalsValue(e))){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[n]}}},{key:"cancelMoveAttempt",value:function(){this.constructedState=this.rules.node.gameState,this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=cB.empty(),this.moveStart=cB.empty(),this.moveEnd=cB.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}},{key:"showLastMove",value:function(){var e=this,t=this.rules.node.move;if(t.isPresent()){var n=t.get();if(n.isInitialPlacement())this.viewInfo.spaceInfo[n.start.y][n.start.x].spaceClasses=["moved"];else{var r,i=Xv(this.coordsBetween(n.start,n.end.get()));try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.spaceInfo[a.y][a.x].spaceClasses=["moved"]}}catch(s){i.e(s)}finally{i.f()}var o=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();n.initialCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)}),n.finalCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)})}}}},{key:"coordsBetween",value:function(e,t){for(var n=[],r=rre.factory.fromMove(e,t).get(),i=e;!i.equals(t);i=i.getNext(r))this.constructedState.getPieceAt(i)!==eve.EMPTY&&n.push(i),n.push(t);return n}},{key:"showLastMoveCapture",value:function(e,t){var n,r=Xv(e.capturedSpaces);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.viewInfo.spaceInfo[i.y][i.x].spaceClasses=["captured"],t&&this.markRemovedMarker(i,this.rules.node.gameState.getCurrentPlayer().getOpponent())}}catch(a){r.e(a)}finally{r.f()}this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured"],t&&this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer().getOpponent())}},{key:"moveToInitialCaptureOrMovePhase",value:function(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),$5.SUCCESS}},{key:"onClick",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:n.t0=t.movePhase,n.next="INITIAL_CAPTURE_SELECT_FIRST"===n.t0||"FINAL_CAPTURE_SELECT_FIRST"===n.t0?6:"INITIAL_CAPTURE_SELECT_LAST"===n.t0||"FINAL_CAPTURE_SELECT_LAST"===n.t0?7:"INITIAL_CAPTURE_SELECT_RING"===n.t0||"FINAL_CAPTURE_SELECT_RING"===n.t0?8:"MOVE_START"===n.t0?9:"MOVE_END"===n.t0?10:11;break;case 6:return n.abrupt("return",t.selectCaptureFirstCoord(e));case 7:return n.abrupt("return",t.selectCaptureLastCoord(e));case 8:return n.abrupt("return",t.selectRing(e));case 9:return n.abrupt("return",t.selectMoveStart(e));case 10:return n.abrupt("return",t.selectMoveEnd(e));case 11:case"end":return n.stop()}},n)}))()}},{key:"selectCaptureFirstCoord",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),!(r.length>1)){n.next=5;break}t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(r),n.next=8;break;case 5:if(0!==r.length){n.next=7;break}return n.abrupt("return",t.cancelMove(Xde.MISSING_CAPTURES()));case 7:t.selectCapture(r[0]);case 8:return n.abrupt("return",$5.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveToCaptureSelectLast",value:function(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;var t,n=Xv(e);try{for(n.s();!(t=n.n()).done;){var r,i=Xv(t.value.capturedSpaces);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.selectableCoords.push(a)}}catch(o){i.e(o)}finally{i.f()}}}catch(o){n.e(o)}finally{n.f()}switch(this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":this.movePhase="INITIAL_CAPTURE_SELECT_LAST";break;case"FINAL_CAPTURE_SELECT_FIRST":this.movePhase="FINAL_CAPTURE_SELECT_LAST"}}},{key:"selectCaptureLastCoord",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=[],n.abrupt("return",(t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),r.length>1?t.cancelMove(Xde.AMBIGUOUS_CAPTURE_COORD()):0===r.length?t.cancelMove(Xde.MISSING_CAPTURES()):t.selectCapture(r[0])));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectCapture",value:function(e){switch(this.currentCapture=cB.of(e),this.constructedState=new tve(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":this.movePhase="INITIAL_CAPTURE_SELECT_RING";break;case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.movePhase="FINAL_CAPTURE_SELECT_RING"}return this.updateViewInfo(),$5.SUCCESS}},{key:"markCurrentCapture",value:function(e){var t,n=Xv(e.capturedSpaces);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.selectedCoords.push(r),this.markRemovedMarker(r,this.rules.node.gameState.getCurrentPlayer())}}catch(i){n.e(i)}finally{n.f()}e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer()))}},{key:"markRemovedMarker",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="transparent",this.setMarkerInfo(e,eve.MARKERS[t.value])}},{key:"markRemovedRing",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="transparent",this.setRingInfo(e,eve.RINGS[t.value])}},{key:"selectRing",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.rules.ringSelectionValidity(t.constructedState,e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:t.constructedState=t.rules.takeRing(t.constructedState,e),i=t.currentCapture.get().setRingTaken(e),n.t0=(t.currentCapture=cB.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase),n.next="INITIAL_CAPTURE_SELECT_RING"===n.t0?8:9;break;case 8:return n.abrupt("return",(t.initialCaptures.push(i),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),$5.SUCCESS)));case 9:return n.abrupt("return",(iB.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(i),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),$5.SUCCESS)));case 10:case"end":return n.stop()}},n)}))()}},{key:"moveToMovePhase",value:function(){return this.movePhase="MOVE_START",this.updateViewInfo(),$5.SUCCESS}},{key:"tryMove",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new rve(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures),t.next=3,e.chooseMove(n,e.rules.node.gameState,e.scores.get());case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"selectMoveStart",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.constructedState.isInitialPlacementPhase()){n.next=3;break}return r=t.rules.initialPlacementValidity(t.constructedState,e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.moveStart=cB.of(e),t.tryMove()));case 3:if(!(i=t.rules.moveStartValidity(t.constructedState,e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(i.getReason()));case 6:return t.moveStart=cB.of(e),t.movePhase="MOVE_END",t.updateViewInfo(),n.abrupt("return",$5.SUCCESS);case 8:case"end":return n.stop()}},n)}))()}},{key:"selectMoveEnd",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.moveEnd=cB.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.constructedState,t.moveStart.get(),e),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove()));case 2:case"end":return n.stop()}},n)}))()}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),$5.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(tre);function xve(e,t){if(1&e&&(hb(0,"option",5),Nb(1),fb()),2&e){var n=t.$implicit;cb("value",n),Ow(1),Mb(n)}}Ive.RING_OUTER_SIZE=40,Ive.RING_MID_SIZE=34,Ive.RING_INNER_SIZE=28,Ive.MARKER_SIZE=Ive.RING_INNER_SIZE,Ive.INDICATOR_SIZE=10,Ive.\u0275fac=function(e){return new(e||Ive)(ub(Xne))},Ive.\u0275cmp=ty({type:Ive,selectors:[["app-yinsh"]],features:[HC],decls:6,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected",3,"id","click"],["pointer-events","fill","class","base no-fill capturable","stroke-linecap","round",3,"id","click",4,"ngIf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable",3,"id","click"],[1,"indicator",3,"click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(wm(),hb(0,"svg",0),ob(1,_ve,2,1,"g",1),ob(2,wve,2,3,"g",1),ob(3,bve,2,1,"g",1),ob(4,Eve,2,4,"g",1),ob(5,Ove,2,2,"g",1),fb()),2&e&&(Ow(1),cb("ngForOf",t.viewInfo.spaceInfo),Ow(1),cb("ngForOf",t.viewInfo.selectedCoords),Ow(1),cb("ngForOf",t.viewInfo.selectableCoords),Ow(1),cb("ngForOf",t.viewInfo.targets),Ow(1),cb("ngForOf",tP(5,Tve)))},directives:[NT,DT,AT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Ave=function(){var e=ip(function e(){np(this,e)});return e.ABALONE=function(){return $localize(Yc||(Yc=Nv(["Use simple mechanics to push 6 of the opponent's pieces out of the board!"])))},e.APAGOS=function(){return $localize(Kc||(Kc=Nv(["Very simple game, but, will you be able to win everytime?"])))},e.AWALE=function(){return $localize(Jc||(Jc=Nv(["The international version of the famous African strategy game!"])))},e.BRANDHUB=function(){return $localize(Qc||(Qc=Nv(["The Irish version of the Tafl game family!"])))},e.COERCEO=function(){return $localize(Xc||(Xc=Nv(["Get rid of all of your opponent's pieces on a board that shrinks little by little!"])))},e.CONSPIRATEURS=function(){return $localize(el||(el=Nv(["Hide all of your pieces before your opponent does, or risk to be discovered!"])))},e.DIAM=function(){return $localize(tl||(tl=Nv(["Drop your pieces and move them around to align two pieces of the same color across the board to win!"])))},e.DVONN=function(){return $localize(nl||(nl=Nv(["Stack your pieces and control as many stacks as you can to win!"])))},e.ENCAPSULE=function(){return $localize(rl||(rl=Nv(["An enhanced tic-tac-toe where piece can encapsule other and prevent them to win."])))},e.EPAMINONDAS=function(){return $localize(il||(il=Nv(["An antiquity-war inspired game. Be the first to pierce your opponent's lines!"])))},e.GIPF=function(){return $localize(al||(al=Nv(["A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!"])))},e.GO=function(){return $localize(ol||(ol=Nv(["The oldest strategy game still practiced widely. A territory control game."])))},e.KAMISADO=function(){return $localize(sl||(sl=Nv(["Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!"])))},e.LINES_OF_ACTION=function(){return $localize(ul||(ul=Nv(["Regroup your pieces to win. But your possible moves will often change!"])))},e.P4=function(){return $localize(cl||(cl=Nv(["The classical 4 in a row game!"])))},e.PENTAGO=function(){return $localize(ll||(ll=Nv(["Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!"])))},e.PYLOS=function(){return $localize(hl||(hl=Nv(["Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!"])))},e.QUARTO=function(){return $localize(fl||(fl=Nv(["Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!"])))},e.QUIXO=function(){return $localize(dl||(dl=Nv(["Align 5 of your pieces on a board where pieces slide!"])))},e.REVERSI=function(){return $localize(vl||(vl=Nv(["Sandwich your opponent's pieces to dominate the board!"])))},e.SAHARA=function(){return $localize(pl||(pl=Nv(["Immobilize one of your opponent's pyramids before your opponent does!"])))},e.SIAM=function(){return $localize(gl||(gl=Nv(["Be the first to push a mountain out of the board!"])))},e.SIX=function(){return $localize(yl||(yl=Nv(["Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!"])))},e.TABLUT=function(){return $localize(ml||(ml=Nv(["The Viking board game! Invaders must capture the king, defender must make him escape!"])))},e.YINSH=function(){return $localize(kl||(kl=Nv(["Align your pieces to score points, but beware, pieces can flip!"])))},e}(),Rve=function(){var e=ip(function e(t,n,r,i,a){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];np(this,e),this.name=t,this.urlName=n,this.component=r,this.creationDate=i,this.description=a,this.display=o});return e.ALL_GAMES=function(){return[new e("MinimaxTesting","MinimaxTesting",Lce,new Date("1970-01-01"),"",!1),new e($localize(_l||(_l=Nv(["Four in a Row"]))),"P4",Jce,new Date("2018-08-28"),Ave.P4()),new e($localize(wl||(wl=Nv(["Awal\xe9"]))),"Awale",kie,new Date("2018-11-29"),Ave.AWALE()),new e($localize(Cl||(Cl=Nv(["Quarto"]))),"Quarto",Ahe,new Date("2018-12-09"),Ave.QUARTO()),new e($localize(bl||(bl=Nv(["Tablut"]))),"Tablut",Qde,new Date("2018-12-27"),Ave.TABLUT()),new e($localize(El||(El=Nv(["Reversi"]))),"Reversi",ofe,new Date("2019-01-16"),Ave.REVERSI()),new e($localize(Sl||(Sl=Nv(["Go"]))),"Go",Rue,new Date("2019-12-21"),Ave.GO()),new e($localize(Pl||(Pl=Nv(["Encapsule"]))),"Encapsule",mse,new Date("2019-12-30"),Ave.ENCAPSULE()),new e($localize(Ol||(Ol=Nv(["Siam"]))),"Siam",ude,new Date("2020-01-11"),Ave.SIAM()),new e($localize(Tl||(Tl=Nv(["Sahara"]))),"Sahara",Sfe,new Date("2020-02-29"),Ave.SAHARA()),new e($localize(Il||(Il=Nv(["Pylos"]))),"Pylos",Ule,new Date("2020-10-02"),Ave.PYLOS()),new e($localize(xl||(xl=Nv(["Kamisado"]))),"Kamisado",hce,new Date("2020-10-03"),Ave.KAMISADO()),new e($localize(Al||(Al=Nv(["Quixo"]))),"Quixo",Whe,new Date("2020-10-15"),Ave.QUIXO()),new e($localize(Rl||(Rl=Nv(["Dvonn"]))),"Dvonn",Zoe,new Date("2020-10-21"),Ave.DVONN()),new e($localize(Nl||(Nl=Nv(["Epaminondas"]))),"Epaminondas",Mse,new Date("2021-01-16"),Ave.EPAMINONDAS()),new e($localize(Ml||(Ml=Nv(["Gipf"]))),"Gipf",iue,new Date("2021-02-22"),Ave.GIPF()),new e($localize(Dl||(Dl=Nv(["Coerceo"]))),"Coerceo",xae,new Date("2021-03-21"),Ave.COERCEO()),new e($localize(Ll||(Ll=Nv(["Six"]))),"Six",Ade,new Date("2021-04-08"),Ave.SIX()),new e($localize(Fl||(Fl=Nv(["Lines of Action"]))),"LinesOfAction",Sce,new Date("2021-04-28"),Ave.LINES_OF_ACTION()),new e($localize(Bl||(Bl=Nv(["Pentago"]))),"Pentago",yle,new Date("2021-05-23"),Ave.PENTAGO()),new e($localize(Vl||(Vl=Nv(["Abalone"]))),"Abalone",Zre,new Date("2021-07-13"),Ave.ABALONE()),new e($localize(Ul||(Ul=Nv(["Yinsh"]))),"Yinsh",Ive,new Date("2021-07-31"),Ave.YINSH()),new e($localize(zl||(zl=Nv(["Apagos"]))),"Apagos",cie,new Date("2021-11-04"),Ave.APAGOS()),new e($localize(Hl||(Hl=Nv(["Diam"]))),"Diam",moe,new Date("2021-11-30"),Ave.DIAM()),new e($localize(Gl||(Gl=Nv(["Brandhub"]))),"Brandhub",tae,new Date("2021-12-07"),Ave.BRANDHUB()),new e($localize(ql||(ql=Nv(["Conspirateurs"]))),"Conspirateurs",Jae,new Date("2021-12-30"),Ave.CONSPIRATEURS())].sort(function(e,t){return e.name.localeCompare(t.name)})},e}(),Nve=function(){var e=function(){function e(){np(this,e),this.gameNameList=Rve.ALL_GAMES().filter(function(e){return!0===e.display}).map(function(e){return e.urlName}),this.pickGame=new dP}return ip(e,[{key:"onChange",value:function(e){this.pickGame.emit(e.target.value)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ty({type:e,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){return[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],$localize($l||($l=Nv(["Pick a game"]))),[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,t){1&e&&(hb(0,"div",0),hb(1,"select",1),kb("change",function(e){return t.onChange(e)}),hb(2,"option",2),zE(3,3),fb(),ob(4,xve,2,2,"option",4),fb(),fb()),2&e&&(Ow(4),cb("ngForOf",t.gameNameList))},directives:[iA,uA,NT],encapsulation:2}),e}();function Mve(e,t){if(1&e){var n=gb();hb(0,"div",26),hb(1,"div",27),kb("click",function(){return Wy(n),Cb().closeInfo()}),fb(),hb(2,"div",28),hb(3,"header",29),hb(4,"p",30),Nb(5),fb(),hb(6,"button",31),kb("click",function(){return Wy(n),Cb().closeInfo()}),fb(),fb(),hb(7,"section",32),hb(8,"div",6),hb(9,"div",33),hb(10,"p",34),db(11,"img",35),fb(),fb(),hb(12,"div",7),hb(13,"div",13),Nb(14),fb(),fb(),fb(),hb(15,"div",6),hb(16,"div",33),hb(17,"a",36),kb("click",function(){Wy(n);var e=Cb();return e.createGame(e.gameInfoDetails.get().urlName)}),db(18,"fa-icon",37),Nb(19,"\xa0"),hb(20,"span"),zE(21,38),fb(),fb(),fb(),hb(22,"div",33),hb(23,"a",36),kb("click",function(){Wy(n);var e=Cb();return e.createLocalGame(e.gameInfoDetails.get().urlName)}),db(24,"fa-icon",37),Nb(25,"\xa0"),hb(26,"span"),zE(27,39),fb(),fb(),fb(),hb(28,"div",33),hb(29,"a",36),kb("click",function(){Wy(n);var e=Cb();return e.createTutorial(e.gameInfoDetails.get().urlName)}),db(30,"fa-icon",37),Nb(31,"\xa0"),hb(32,"span"),zE(33,40),fb(),fb(),fb(),fb(),fb(),fb(),fb()}if(2&e){var r=Cb();Ow(5),Mb(r.gameInfoDetails.get().name),Ow(6),Eb("src","assets/images/",r.theme,"/",r.gameInfoDetails.get().urlName,".png",__),Ow(3),Db(" ",r.gameInfoDetails.get().description," "),Ow(4),cb("icon",r.iconOnlineGame),Ow(6),cb("icon",r.iconLocalGame),Ow(6),cb("icon",r.iconTutorial)}}function Dve(e,t){if(1&e){var n=gb();hb(0,"div",8),hb(1,"div",9),hb(2,"p",10),Nb(3),fb(),fb(),hb(4,"div",42),hb(5,"figure",34),hb(6,"img",43),kb("click",function(){var e=Wy(n).$implicit;return Cb(2).openInfo(e)}),fb(),hb(7,"figcaption",44),kb("click",function(){var e=Wy(n).$implicit;return Cb(2).openInfo(e)}),hb(8,"div",45),Nb(9,"?"),fb(),fb(),hb(10,"figcaption",46),hb(11,"a",47),kb("click",function(){var e=Wy(n).$implicit;return Cb(2).createGame(e.urlName)}),db(12,"fa-icon",37),fb(),hb(13,"a",48),kb("click",function(){var e=Wy(n).$implicit;return Cb(2).createLocalGame(e.urlName)}),db(14,"fa-icon",37),fb(),hb(15,"a",49),kb("click",function(){var e=Wy(n).$implicit;return Cb(2).createTutorial(e.urlName)}),db(16,"fa-icon",37),fb(),fb(),fb(),fb(),hb(17,"div",50),Nb(18),fb(),fb()}if(2&e){var r=t.$implicit,i=Cb(2);Ow(3),Mb(r.name),Ow(3),bb("id","image_",r.urlName,""),Eb("src","assets/images/",i.theme,"/",r.urlName,".png",__),Ow(5),bb("id","playOnline_",r.urlName,""),Ow(1),cb("icon",i.iconOnlineGame),Ow(1),bb("id","playLocally_",r.urlName,""),Ow(1),cb("icon",i.iconLocalGame),Ow(1),bb("id","startTutorial_",r.urlName,""),Ow(1),cb("icon",i.iconTutorial),Ow(2),Db(" ",r.description," ")}}function Lve(e,t){if(1&e&&(hb(0,"div",7),ob(1,Dve,19,11,"div",41),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngForOf",n)}}var Fve=function(){var e=function(){function e(t,n){np(this,e),this.router=t,this.numberOfColumns=4,this.games=[],this.iconOnlineGame=ute,this.iconLocalGame=ote,this.iconTutorial=ite,this.gameInfoDetails=cB.empty(),this.theme=n.getTheme();for(var r=Rve.ALL_GAMES().filter(function(e){return!0===e.display}),i=0,a=0;a<r.length;a++)a<this.numberOfColumns&&this.games.push([]),this.games[i].push(r[a]),i=(i+1)%this.numberOfColumns}return ip(e,[{key:"createGame",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/play",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createLocalGame",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/local",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createTutorial",value:function(e){return this.router.navigate(["/tutorial",e])}},{key:"openInfo",value:function(e){this.gameInfoDetails=cB.of(e)}},{key:"closeInfo",value:function(){this.gameInfoDetails=cB.empty()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(WM),ub(rte))},e.\u0275cmp=ty({type:e,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){return[[1,"hero"],[1,"hero-body"],[1,"title"],$localize(Wl||(Wl=Nv(["EveryBoard"]))),[1,"subtitle"],$localize(jl||(jl=Nv(["EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.",":LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn."])),"\ufffd#6\ufffd\ufffd/#6\ufffd"),[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],$localize(Zl||(Zl=Nv(["Play online"]))),[1,"card-content"],[1,"content"],["id","createOnlineGame","routerLink","/play",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(Yl||(Yl=Nv(["Create an online game"]))),["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],$localize(Kl||(Kl=Nv(["See the game list"]))),$localize(Jl||(Jl=Nv(["Play offline"]))),[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(Ql||(Ql=Nv(["Play"]))),["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],$localize(Xl||(Xl=Nv(["Learn"]))),["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],$localize(eh||(eh=Nv(["Play online"]))),$localize(th||(th=Nv(["Play offline"]))),$localize(nh||(nh=Nv(["Learn the rules"]))),["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",$localize(rh||(rh=Nv(["Play online"]))),1,"button",3,"id","click"],["data-tooltip",$localize(ih||(ih=Nv(["Play offline"]))),1,"button",3,"id","click"],["data-tooltip",$localize(ah||(ah=Nv(["Learn the rules"]))),1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,t){1&e&&(hb(0,"section",0),hb(1,"div",1),hb(2,"p",2),zE(3,3),fb(),hb(4,"p",4),VE(5,5),db(6,"br"),UE(),fb(),fb(),hb(7,"div",6),hb(8,"div",7),hb(9,"div",8),hb(10,"header",9),hb(11,"p",10),zE(12,11),fb(),fb(),hb(13,"div",12),hb(14,"div",13),hb(15,"button",14),zE(16,15),fb(),hb(17,"button",16),zE(18,17),fb(),fb(),fb(),fb(),fb(),hb(19,"div",7),hb(20,"div",8),hb(21,"header",9),hb(22,"p",10),zE(23,18),fb(),fb(),hb(24,"div",12),hb(25,"div",19),hb(26,"button",20),zE(27,21),fb(),hb(28,"button",22),zE(29,23),fb(),fb(),fb(),fb(),fb(),fb(),ob(30,Mve,34,7,"div",24),hb(31,"div",6),ob(32,Lve,2,1,"div",25),fb(),fb()),2&e&&(Ow(30),cb("ngIf",t.gameInfoDetails.isPresent()),Ow(2),cb("ngForOf",t.games))},directives:[ZM,DT,NT,Rne],encapsulation:2}),e}(),Bve=function(){var e=function(){function e(t){np(this,e),this.element=t}return ip(e,[{key:"ngAfterViewInit",value:function(){this.element.nativeElement.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(iS))},e.\u0275dir=sy({type:e,selectors:[["","autofocus",""]]}),e}(),Vve=function(){var e=function(){function e(t){var n=this;np(this,e),this.shown=!1,this.input=t.nativeElement.parentNode.previousSibling,t.nativeElement.addEventListener("click",function(e){n.toggle()})}return ip(e,[{key:"toggle",value:function(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(iS))},e.\u0275dir=sy({type:e,selectors:[["","toggleVisibility",""]]}),e}();function Uve(e,t){if(1&e&&(hb(0,"div",29),hb(1,"div",30),zE(2,31),fb(),hb(3,"div",32),Nb(4),fb(),fb()),2&e){var n=Cb();Ow(4),Mb(n.errorMessage)}}var zve=function(){return["/register"]},Hve=function(){return["/reset-password"]},Gve=function(){var e=function(){function e(t,n){np(this,e),this.router=t,this.authenticationService=n,this.faEye=ste,this.loginForm=new Bx({email:new Fx,password:new Fx})}return ip(e,[{key:"ngOnInit",value:function(){var e,t=this;this.authenticationService.getUserObs().subscribe((e=rB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n!==Uee.NOT_CONNECTED,!e.t0){e.next=4;break}return e.next=4,t.redirect();case 4:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"loginWithEmail",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.authenticationService.doEmailLogin(e.email,e.password);case 2:(r=n.sent).isFailure()&&(t.errorMessage=r.getReason());case 4:case"end":return n.stop()}},n)}))()}},{key:"loginWithGoogle",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authenticationService.doGoogleLogin();case 2:(n=t.sent).isFailure()&&(e.errorMessage=n.getReason());case 4:case"end":return t.stop()}},t)}))()}},{key:"redirect",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.router.navigate(["/lobby"]));case 1:case"end":return t.stop()}},t)}))()}},{key:"canLogin",value:function(){return!(""===(this.loginForm.value.email||"")||""===(this.loginForm.value.password||""))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(WM),ub(zee))},e.\u0275cmp=ty({type:e,selectors:[["app-login"]],decls:49,vars:8,consts:function(){return[[1,"box"],[1,"title"],$localize(oh||(oh=Nv(["Log in"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(sh||(sh=Nv(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",$localize(uh||(uh=Nv(["Email"]))),"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],$localize(ch||(ch=Nv(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",$localize(lh||(lh=Nv(["Password"]))),"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(hh||(hh=Nv(["Log in"]))),["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(fh||(fh=Nv(["Log in with Google"]))),["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],$localize(dh||(dh=Nv(["No account?"]))),[3,"routerLink"],$localize(vh||(vh=Nv(["Register"]))),$localize(ph||(ph=Nv(["Forgot your password?"]))),$localize(gh||(gh=Nv(["Reset your password"]))),["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(yh||(yh=Nv(["Connection error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(hb(0,"div",0),hb(1,"p",1),zE(2,2),fb(),hb(3,"form",3),hb(4,"div",4),hb(5,"div",5),hb(6,"label",6),zE(7,7),fb(),fb(),hb(8,"div",8),hb(9,"div",9),hb(10,"div",10),db(11,"input",11),fb(),fb(),fb(),fb(),hb(12,"div",4),hb(13,"div",5),hb(14,"label",12),zE(15,13),fb(),fb(),hb(16,"div",8),hb(17,"div",9),hb(18,"div",14),db(19,"input",15),hb(20,"span",16),db(21,"fa-icon",17),fb(),fb(),fb(),fb(),fb(),hb(22,"div",4),db(23,"div",5),hb(24,"div",8),hb(25,"div",9),hb(26,"div",10),hb(27,"button",18),kb("click",function(){return t.loginWithEmail(t.loginForm.value)}),zE(28,19),fb(),fb(),fb(),fb(),fb(),hb(29,"div",4),db(30,"div",5),hb(31,"div",8),hb(32,"div",9),hb(33,"div",10),hb(34,"button",20),kb("click",function(){return t.loginWithGoogle()}),zE(35,21),fb(),fb(),fb(),fb(),fb(),ob(36,Uve,5,1,"div",22),hb(37,"p",23),vb(38),zE(39,24),pb(),Nb(40,"\xa0 "),hb(41,"a",25),zE(42,26),fb(),fb(),hb(43,"p",23),vb(44),zE(45,27),pb(),Nb(46,"\xa0 "),hb(47,"a",25),zE(48,28),fb(),fb(),fb(),fb()),2&e&&(Ow(3),cb("formGroup",t.loginForm),Ow(18),cb("icon",t.faEye),Ow(6),cb("disabled",!t.canLogin()),Ow(9),cb("ngIf",t.errorMessage),Ow(5),cb("routerLink",tP(6,zve)),Ow(6),cb("routerLink",tP(7,Hve)))},directives:[Wx,vx,Qx,FI,dx,eA,Bve,lA,Rne,Vve,DT,YM],encapsulation:2}),e}(),qve=function(){var e=function(){function e(t){np(this,e),this.partDAO=t,this.unsubscribe=cB.empty(),this.activePartsBS=new eR([]),this.activePartsObs=this.activePartsBS.asObservable()}return ip(e,[{key:"getActivePartsObs",value:function(){return this.activePartsObs}},{key:"startObserving",value:function(){var e=this;Z5(this.unsubscribe.isAbsent(),"ActivePartsService: already observing");var t=new n6(function(t){var n,r=(n=e.activePartsBS.value).concat.apply(n,Jv(t));e.activePartsBS.next(r)},function(t){var n,r=e.activePartsBS.value,i=Xv(t);try{var a=function(){var e=n.value;r.forEach(function(t){t.id===e.id&&(t.data=e.data)})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}e.activePartsBS.next(r)},function(t){var n,r=[],i=Xv(e.activePartsBS.value);try{var a=function(){var e=n.value;t.some(function(t){return t.id===e.id})||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}e.activePartsBS.next(r)});this.unsubscribe=cB.of(this.partDAO.observeActiveParts(t))}},{key:"stopObserving",value:function(){Z5(this.unsubscribe.isPresent(),"Cannot stop observing active parts when you have not started observing"),this.activePartsBS.next([]),this.unsubscribe.get()(),this.unsubscribe=cB.empty()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(J5))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"any"}),e}(),$ve=function(){var e=function(){function e(t){np(this,e),this.router=t}return ip(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"navigateToOnlineGameCreation",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/play",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(WM))},e.\u0275cmp=ty({type:e,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playOnline",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(mh||(mh=Nv(["Create an online game"])))]},template:function(e,t){1&e&&(hb(0,"app-pick-game",0),kb("pickGame",function(e){return t.pickGame(e)}),fb(),hb(1,"button",1),kb("click",function(){return t.navigateToOnlineGameCreation()}),zE(2,2),fb()),2&e&&(Ow(1),cb("disabled",!t.selectedGame))},directives:[Nve],encapsulation:2}),e}(),Wve=["chatDiv"];function jve(e,t){1&e&&(vb(0),zE(1,8),pb())}function Zve(e,t){1&e&&zE(0,9),2&e&&(HE(Cb(2).unreadMessagesText),GE(0))}function Yve(e,t){if(1&e){var n=gb();hb(0,"button",14),kb("click",function(){return Wy(n),Cb(3).scrollToBottom()}),Nb(1),fb()}if(2&e){var r=Cb(3);Ow(1),Db("",r.unreadMessagesText," \u2193")}}function Kve(e,t){if(1&e&&(hb(0,"p"),Nb(1),sP(2,"date"),hb(3,"b"),Nb(4),fb(),Nb(5),fb()),2&e){var n=t.$implicit;Ow(1),Db(" [",cP(2,3,n.postedTime,"HH:mm:ss","+0100"),"] "),Ow(3),Db("",n.sender," :"),Ow(1),Db(" ",n.content," ")}}function Jve(e,t){if(1&e){var n=gb();hb(0,"div"),ob(1,Yve,2,1,"button",10),hb(2,"div",11,12),kb("scroll",function(){return Wy(n),Cb(2).updateCurrentScrollPosition()}),ob(4,Kve,6,7,"p",13),fb(),fb()}if(2&e){var r=Cb(2);Ow(1),cb("ngIf",r.showUnreadMessagesButton),Ow(3),cb("ngForOf",r.chat)}}var Qve=function(){return{standalone:!0}};function Xve(e,t){if(1&e){var n=gb();hb(0,"form",15),kb("onSubmit",function(){return Wy(n),Cb(2).sendMessage()}),hb(1,"div",16),hb(2,"div",17),hb(3,"input",18,19),kb("ngModelChange",function(e){return Wy(n),Cb(2).userMessage=e}),fb(),hb(5,"p",20),Nb(6),fb(),fb(),hb(7,"div",21),hb(8,"button",22),kb("click",function(){return Wy(n),Cb(2).sendMessage()}),db(9,"fa-icon",23),fb(),fb(),fb(),hb(10,"div",24),hb(11,"p"),hb(12,"strong"),zE(13,25),fb(),fb(),fb(),fb()}if(2&e){var r=sb(4),i=Cb(2);Ow(3),cb("ngModel",i.userMessage)("ngModelOptions",tP(4,Qve)),Ow(3),Db("",r.value.length,"/128"),Ow(3),cb("icon",i.faReply)}}function epe(e,t){if(1&e){var n=gb();hb(0,"div",2),hb(1,"button",3),kb("click",function(){return Wy(n),Cb().switchChatVisibility()}),ob(2,jve,2,0,"ng-container",4),ob(3,Zve,1,1,"ng-template",null,5,IP),fb(),ob(5,Jve,5,2,"div",6),ob(6,Xve,14,5,"form",7),fb()}if(2&e){var r=sb(4),i=Cb();Ow(2),cb("ngIf",i.visible)("ngIfElse",r),Ow(3),cb("ngIf",i.visible),Ow(1),cb("ngIf",i.visible)}}function tpe(e,t){1&e&&(hb(0,"div",26),hb(1,"div",27),hb(2,"p"),zE(3,28),fb(),fb(),fb())}var npe=function(){var e=function(){function e(t,n){np(this,e),this.chatService=t,this.authenticationService=n,this.userMessage="",this.username=cB.empty(),this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=cte,this.isNearBottom=!0,this.notYetScrolled=!0,aB(e.VERBOSE,"ChatComponent constructor")}return ip(e,[{key:"ngOnInit",value:function(){var t=this;aB(e.VERBOSE,"ChatComponent.ngOnInit for chat ".concat(this.chatId)),Z5(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.authSubscription=this.authenticationService.getUserObs().subscribe(function(n){t.isConnectedUser(n)?(aB(e.VERBOSE,JSON.stringify(n)+" just connected"),t.username=n.username,t.connected=!0,t.loadChatContent()):(aB(e.VERBOSE,"No User Logged"),t.username=cB.empty(),t.connected=!1)})}},{key:"ngAfterViewChecked",value:function(){this.scrollToBottomIfNeeded()}},{key:"isConnectedUser",value:function(e){return e.username.isPresent()&&""!==e.username.get()}},{key:"loadChatContent",value:function(){var t=this;aB(e.VERBOSE,"User '".concat(this.username,"' logged, loading chat content")),this.chatService.startObserving(this.chatId,function(e){Z5(e.isPresent(),"ChatComponent observed a chat being deleted, this should not happen"),t.updateMessages(e.get())})}},{key:"updateMessages",value:function(e){this.chat=e.messages;var t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}},{key:"updateUnreadMessagesText",value:function(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize(kh||(kh=Nv(["no new message"]))),this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize(_h||(_h=Nv(["1 new message"]))):$localize(wh||(wh=Nv([""," new messages"])),e)}},{key:"scrollToBottomIfNeeded",value:function(){this.connected&&this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}},{key:"updateCurrentScrollPosition",value:function(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}},{key:"scrollToBottom",value:function(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}},{key:"scrollTo",value:function(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}},{key:"sendMessage",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Z5(e.username.isPresent(),"disconnected user is not able to send a message"),n=e.userMessage,e.userMessage="",t.next=5,e.chatService.sendMessage(e.username.get(),n,e.turn);case 5:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.authSubscription.unsubscribe(),this.chatService.isObserving()&&this.chatService.stopObserving()}},{key:"switchChatVisibility",value:function(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ub(t6),ub(zee))},e.\u0275cmp=ty({type:e,selectors:[["app-chat"]],viewQuery:function(e,t){var n;(1&e&&PP(Wve,5),2&e)&&(SP(n=OP())&&(t.chatDiv=n.first))},inputs:{chatId:"chatId",turn:"turn"},decls:3,vars:2,consts:function(){return[["class","block",4,"ngIf"],["id","disconnected-chat","class","message is-primary is-light",4,"ngIf"],[1,"block"],["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],$localize(Ch||(Ch=Nv(["Hide chat"]))),$localize(bh||(bh=Nv(["Show chat (",":INTERPOLATION:)"])),"\ufffd0\ufffd"),["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",$localize(Eh||(Eh=Nv(["Type your message here"]))),"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],["toggleVisibility","",1,"clickable-icon",3,"icon"],[1,"content","is-small"],$localize(Sh||(Sh=Nv(["Be polite"]))),["id","disconnected-chat",1,"message","is-primary","is-light"],[1,"message-body"],$localize(Ph||(Ph=Nv(["Only connected users can see the chat."])))]},template:function(e,t){1&e&&(hb(0,"div"),ob(1,epe,7,4,"div",0),ob(2,tpe,4,0,"div",1),fb()),2&e&&(Ow(1),cb("ngIf",t.connected),Ow(1),cb("ngIf",!1===t.connected))},directives:[DT,NT,Wx,vx,Hx,FI,fA,dx,$x,Rne,Vve],pipes:[VT],encapsulation:2}),e}();function rpe(e,t){if(1&e&&(vb(0),Nb(1),pb()),2&e){var n=Cb().$implicit;Ow(1),Mb(n.data.playerOne)}}function ipe(e,t){1&e&&zE(0,26)}function ape(e,t){if(1&e){var n=gb();hb(0,"tr",22),kb("click",function(){var e=Wy(n).$implicit;return Cb(2).joinGame(e.id,e.data.typeGame)}),hb(1,"td",23),Nb(2),fb(),hb(3,"td",23),Nb(4),fb(),hb(5,"td",23),ob(6,rpe,2,1,"ng-container",24),ob(7,ipe,1,0,"ng-template",null,25,IP),fb(),hb(9,"td",23),Nb(10),fb(),fb()}if(2&e){var r=t.$implicit,i=t.index,a=sb(8);bb("id","part_",i,""),Ow(2),Mb(r.data.typeGame),Ow(2),Mb(r.data.playerZero),Ow(2),cb("ngIf",r.data.playerOne)("ngIfElse",a),Ow(4),Mb(r.data.turn)}}function ope(e,t){if(1&e&&(hb(0,"div",13),hb(1,"div",14),hb(2,"table",15),hb(3,"thead"),hb(4,"tr"),hb(5,"th",16),zE(6,17),fb(),hb(7,"th",16),zE(8,18),fb(),hb(9,"th",16),zE(10,19),fb(),hb(11,"th",16),zE(12,20),fb(),fb(),fb(),hb(13,"tbody"),ob(14,ape,11,6,"tr",21),fb(),fb(),fb(),fb()),2&e){var n=Cb();Ow(14),cb("ngForOf",n.activeParts)}}function spe(e,t){1&e&&(hb(0,"div",27),db(1,"app-online-game-selection",28),fb())}function upe(e,t){if(1&e&&(vb(0),Nb(1),sP(2,"date"),pb()),2&e){var n=Cb().$implicit;Ow(1),Lb(" ",n.data.username,": ",cP(2,2,1e3*n.data.last_changed.seconds,"HH:mm:ss","+0100")," ")}}function cpe(e,t){if(1&e&&(hb(0,"li"),ob(1,upe,3,6,"ng-container",37),fb()),2&e){var n=t.$implicit;Ow(1),cb("ngIf",n.data.last_changed)}}function lpe(e,t){if(1&e&&(hb(0,"div",29),hb(1,"div",30),hb(2,"div",31),db(3,"app-chat",32),fb(),fb(),hb(4,"div",33),hb(5,"div",34),hb(6,"p"),zE(7,35),fb(),hb(8,"ul"),ob(9,cpe,2,1,"li",36),fb(),fb(),fb(),fb()),2&e){var n=Cb();Ow(3),cb("turn",-1),Ow(6),cb("ngForOf",n.activeUsers)}}var hpe=function(){var e=function(){function e(t,n,r){np(this,e),this.router=t,this.userService=n,this.activePartsService=r,this.activeUsers=[],this.activeParts=[],this.currentTab="games"}return ip(e,[{key:"ngOnInit",value:function(){var t=this;aB(e.VERBOSE,"lobbyComponent.ngOnInit"),this.activeUsersSub=this.userService.getActiveUsersObs().subscribe(function(e){t.activeUsers=e}),this.activePartsService.startObserving(),this.activePartsSub=this.activePartsService.getActivePartsObs().subscribe(function(e){t.activeParts=e})}},{key:"ngOnDestroy",value:function(){aB(e.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activeUsersSub.unsubscribe(),this.activePartsService.stopObserving(),this.activePartsSub.unsubscribe(),this.userService.unSubFromActiveUsersObs()}},{key:"joinGame",value:function(e,t){var n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.router.navigate(["/play",t,e]);case 2:case"end":return r.stop()}},r)}))()}},{key:"selectTab",value:function(e){this.currentTab=e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ub(WM),ub(a6),ub(qve))},e.\u0275cmp=ty({type:e,selectors:[["app-lobby"]],decls:14,vars:3,consts:function(){return[[1,"tabs","is-centered"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],$localize(Oh||(Oh=Nv(["Games"]))),["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"click"],$localize(Th||(Th=Nv(["Create"]))),["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],$localize(Ih||(Ih=Nv(["Chat"]))),["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(xh||(xh=Nv(["Game"]))),$localize(Ah||(Ah=Nv(["First player"]))),$localize(Rh||(Rh=Nv(["Second player"]))),$localize(Nh||(Nh=Nv(["Turn"]))),[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],$localize(Mh||(Mh=Nv(["Waiting for opponent"]))),["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],["id","chatContainerDiv",1,"column","is-9"],["id","chat",1,"box"],["chatId","server",3,"turn"],[1,"column","is-3"],["id","onlineUser",1,"box"],$localize(Dh||(Dh=Nv(["Connected users:"]))),[4,"ngFor","ngForOf"],[4,"ngIf"]]},template:function(e,t){1&e&&(hb(0,"div",0),hb(1,"ul"),hb(2,"li",1),hb(3,"a",2),kb("click",function(){return t.selectTab("games")}),zE(4,3),fb(),fb(),hb(5,"li",4),hb(6,"a",5),kb("click",function(){return t.selectTab("create")}),zE(7,6),fb(),fb(),hb(8,"li",7),hb(9,"a",8),kb("click",function(){return t.selectTab("chat")}),zE(10,9),fb(),fb(),fb(),fb(),ob(11,ope,15,1,"div",10),ob(12,spe,2,0,"div",11),ob(13,lpe,10,2,"div",12)),2&e&&(Ow(11),cb("ngIf","games"===t.currentTab),Ow(1),cb("ngIf","create"===t.currentTab),Ow(1),cb("ngIf","chat"===t.currentTab))},directives:[AT,DT,NT,$ve,npe],pipes:[VT],encapsulation:2}),e}(),fpe=function(){var e=ip(function e(){np(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ty({type:e,selectors:[["app-not-found"]],decls:5,vars:0,consts:function(){return[[1,"message","is-danger"],[1,"message-header"],$localize(Lh||(Lh=Nv(["Game does not exist"]))),[1,"message-body"],$localize(Fh||(Fh=Nv(["The game you tried to join does not exist anymore."])))]},template:function(e,t){1&e&&(hb(0,"div",0),hb(1,"div",1),zE(2,2),fb(),hb(3,"div",3),zE(4,4),fb(),fb())},encapsulation:2}),e}();function dpe(e,t){}var vpe=function(){var e=ip(function e(t){np(this,e),this.viewContainerRef=t,aB(e.VERBOSE,"GameIncluderComponent constructor")});return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ub(zS))},e.\u0275cmp=ty({type:e,selectors:[["app-game-includer"]],decls:1,vars:0,template:function(e,t){1&e&&ob(0,dpe,0,0,"ng-template")},encapsulation:2}),e}(),ppe=function(){var e=ip(function e(){np(this,e)});return e.NOT_YOUR_TURN=function(){return $localize(Bh||(Bh=Nv(["It is not your turn!"])))},e.NO_CLONING_FEATURE=function(){return $localize(Vh||(Vh=Nv(["You cannot clone a game. This feature might be implemented later."])))},e}(),gpe=function(){var e=function(){function e(t,n,r){np(this,e),this.componentFactoryResolver=t,this.actRoute=n,this.authenticationService=r,this.players=[cB.empty(),cB.empty()],this.endGame=!1,aB(e.VERBOSE,"GameWrapper.constructed: "+(null!=this.gameIncluder))}return ip(e,[{key:"getMatchingComponent",value:function(t){aB(e.VERBOSE,"GameWrapper.getMatchingComponent");var n=cB.ofNullable(Rve.ALL_GAMES().find(function(e){return e.urlName===t}));return Z5(n.isPresent(),"Unknown Games are unwrappable"),n.get().component}},{key:"afterGameIncluderViewInit",value:function(){aB(e.VERBOSE,"GameWrapper.afterGameIncluderViewInit"),this.createGameComponent(),this.gameComponent.rules.setInitialBoard()}},{key:"createGameComponent",value:function(){var t=this;aB(e.VERBOSE,"GameWrapper.createGameComponent"),Z5(null!=this.gameIncluder,"GameIncluder should be present");var n=iB.getNonNullable(this.actRoute.snapshot.paramMap.get("compo")),r=this.getMatchingComponent(n),i=this.componentFactoryResolver.resolveComponentFactory(r),a=this.gameIncluder.viewContainerRef.createComponent(i);this.gameComponent=a.instance,this.gameComponent.chooseMove=function(e,n,r){return t.receiveValidMove(e,n,r)},this.gameComponent.canUserPlay=function(e){return t.onUserClick(e)},this.gameComponent.isPlayerTurn=function(){return t.isPlayerTurn()},this.gameComponent.cancelMoveOnWrapper=function(e){t.onCancelMove(e)},this.gameComponent.observerRole=this.observerRole,this.canPass=this.gameComponent.canPass}},{key:"receiveValidMove",value:function(t,n,r){var i=this;return rB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(aB(e.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:t,state:n,scores:r}}),i.isPlayerTurn()){a.next=2;break}return a.abrupt("return",$5.failure(ppe.NOT_YOUR_TURN()));case 2:if(!i.endGame){a.next=4;break}return a.abrupt("return",$5.failure($localize(Uh||(Uh=Nv(["The game has ended."])))));case 4:if(!(o=i.gameComponent.rules.isLegal(t,n)).isFailure()){a.next=9;break}a.t0=(i.gameComponent.cancelMove(o.getReason()),$5.ofFallible(o)),a.next=14;break;case 9:return i.gameComponent.cancelMoveAttempt(),a.next=12,i.onLegalUserMove(t,r);case 12:aB(e.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),a.t0=$5.SUCCESS;case 14:return a.abrupt("return",a.t0);case 15:case"end":return a.stop()}},a)}))()}},{key:"onUserClick",value:function(e){if(this.observerRole===Zee.NONE.value){var t=ppe.NO_CLONING_FEATURE();return $5.failure(t)}return this.isPlayerTurn()?$5.SUCCESS:$5.failure(ppe.NOT_YOUR_TURN())}},{key:"onCancelMove",value:function(e){}},{key:"isPlayerTurn",value:function(){if(this.observerRole===Zee.NONE.value||null==this.gameComponent)return!1;var t=this.gameComponent.rules.node.gameState.turn,n=t%2,r=this.getPlayerName();return aB(e.VERBOSE,{isPlayerTurn:{turn:t,players:this.players,username:r,observer:this.observerRole,areYouPlayer:this.players[n].equalsValue(r),isThereAPlayer:this.players[n]}}),!this.players[n].isPresent()||this.players[n].equalsValue(r)}},{key:"getBoardHighlight",value:function(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.rules.node.gameState.turn%2+"-bg"]:[]}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ub(eS),ub(SN),ub(zee))},e.\u0275cmp=ty({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var n;(1&e&&PP(vpe,5),2&e)&&(SP(n=OP())&&(t.gameIncluder=n.first))},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),ype=function(){function e(t,n,r){np(this,e),this.added=t,this.modified=n,this.removed=r}return ip(e,[{key:"addNewKeys",value:function(e,t){var n,r=Xv(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;null!=t[i]&&(this.added[i]=t[i])}}catch(a){r.e(a)}finally{r.f()}}},{key:"addCommonKey",value:function(t,n,r){var i,a=Xv(t);try{for(a.s();!(i=a.n()).done;){var o=i.value;if(null==n[o])null!=r[o]&&(this.removed[o]=r[o]);else if(null==r[o])null!=n[o]&&(this.added[o]=n[o]);else{if(["function","symbol","bigint"].includes(typeof r[o]))throw new Error("Not implemented yet");if(void 0===r[o])throw new Error("YOU RE NOT A REAL VALUE "+o);if(["string","boolean","number"].includes(typeof r[o]))r[o]!==n[o]&&(this.modified[o]=n[o]);else if("number"==typeof r[o].length){if("number"!=typeof n[o].length)throw new Error("Thing should not change type");if(r[o].length===n[o].length)for(var s=!0,u=0;s&&u<r[o].length;u++)e.from(r[o][u],n[o][u]).countChanges()>0&&(s=!1,this.modified[o]=n[o]);else this.modified[o]=n[o]}else{var c=e.from(r[o],n[o]);c.countChanges()>0&&(this.modified[o]=c)}}}}catch(l){a.e(l)}finally{a.f()}}},{key:"countChanges",value:function(){var e=Object.keys(this.removed).length,t=Object.keys(this.modified).length;return Object.keys(this.added).length+t+e}},{key:"addRemovedKeys",value:function(e,t){var n,r=Xv(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.removed[i]=t[i]}}catch(a){r.e(a)}finally{r.f()}}},{key:"isPresent",value:function(e){return null!=this.added[e]?{state:"added",present:!0}:null!=this.modified[e]?{state:"modified",present:!0}:null!=this.removed[e]?{state:"removed",present:!0}:{state:null,present:!1}}}],[{key:"from",value:function(t,n){var r=new e({},{},{});if(null==t)return r.added=Dv({},n),r;if(null==n)return r.removed=Dv({},t),r;var i=Object.keys(t),a=Object.keys(n),o=i.filter(function(e){return!1===a.includes(e)}),s=i.filter(function(e){return a.includes(e)}),u=a.filter(function(e){return!1===i.includes(e)});return r.addNewKeys(u,n),r.addCommonKey(s,n,t),r.addRemovedKeys(o,t),r}}]),e}(),mpe=function(){var e=function(){function e(){np(this,e)}return ip(e,[{key:"transform",value:function(e){var t=e%60,n=(e-t)%3600/60,r=(e-60*n-t)/3600,i=[];if(r>1?i.push($localize(zh||(zh=Nv([""," hours"])),r)):1===r&&i.push($localize(Hh||(Hh=Nv(["1 hour"])))),n>1?i.push($localize(Gh||(Gh=Nv([""," minutes"])),n)):1===n&&i.push($localize(qh||(qh=Nv(["1 minute"])))),t>1?i.push($localize($h||($h=Nv([""," seconds"])),t)):1===t&&i.push($localize(Wh||(Wh=Nv(["1 second"])))),0===i.length)return $localize(jh||(jh=Nv(["0 seconds"])));if(1===i.length)return i[0];var a=i.slice(0,-1).join(", "),o=i.slice(-1)[0];return $localize(Zh||(Zh=Nv([""," and ",""])),a,o)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=uy({name:"humanDuration",type:e,pure:!0}),e}();function kpe(e){return 1e3*e.seconds+e.nanoseconds/1e6}function _pe(e){return Dp(function(t,n){Jp(e).subscribe(new Lp(n,function(){return n.complete()},gp)),!n.closed&&t.subscribe(n)})}function wpe(e,t){if(1&e&&(vb(0),Nb(1),pb()),2&e){var n=Cb(3);Ow(1),Mb(n.viewInfo.chosenOpponent)}}function Cpe(e,t){1&e&&zE(0,44)}function bpe(e,t){if(1&e&&(hb(0,"div",45),hb(1,"div",8),hb(2,"label",46),vb(3),zE(4,47),pb(),hb(5,"output"),Nb(6),sP(7,"humanDuration"),fb(),fb(),hb(8,"div",37),db(9,"input",48),fb(),fb(),hb(10,"div",8),hb(11,"label",49),VE(12,50),db(13,"output"),sP(14,"humanDuration"),UE(),fb(),hb(15,"div",37),db(16,"input",51),fb(),fb(),fb()),2&e){var n=Cb(3);Ow(6),Mb(uP(7,2,n.viewInfo.maximalMoveDuration||0)),Ow(8),HE(uP(14,4,n.viewInfo.totalPartDuration||0)),GE(12)}}function Epe(e,t){1&e&&(hb(0,"div"),VE(1,52),db(2,"br"),UE(),fb())}function Spe(e,t){1&e&&(hb(0,"button",64),zE(1,65),fb())}function Ppe(e,t){if(1&e){var n=gb();hb(0,"tr",60),kb("click",function(){var e=Wy(n).$implicit;return Cb(4).selectOpponent(e)}),hb(1,"td",61),Nb(2),fb(),hb(3,"td",62),ob(4,Spe,2,0,"button",63),fb(),fb()}if(2&e){var r=t.$implicit,i=Cb(4);bb("id","presenceOf_",r,""),cb("ngClass",i.viewInfo.candidateClasses[r]),Ow(1),cb("id",i.viewInfo.chosenOpponent===r&&"selected_"+r||"candidate_"+r),Ow(1),Mb(r),Ow(2),cb("ngIf",i.viewInfo.chosenOpponent!==r)}}function Ope(e,t){if(1&e&&(vb(0),zE(1,53),pb(),hb(2,"div",54),hb(3,"table",55),hb(4,"thead"),hb(5,"tr"),hb(6,"th",56),zE(7,57),fb(),hb(8,"th",56),zE(9,58),fb(),fb(),fb(),hb(10,"tbody"),ob(11,Ppe,5,5,"tr",59),fb(),fb(),fb()),2&e){var n=Cb(3);Ow(11),cb("ngForOf",n.viewInfo.candidates)}}function Tpe(e,t){if(1&e){var n=gb();hb(0,"button",66),kb("click",function(){return Wy(n),Cb(3).changeConfig()}),zE(1,67),fb()}}function Ipe(e,t){if(1&e){var n=gb();hb(0,"div"),hb(1,"h1",4),zE(2,5),fb(),hb(3,"form",6),hb(4,"fieldset",7),hb(5,"div",8),hb(6,"label",9),zE(7,10),fb(),hb(8,"div",11),hb(9,"button",12),kb("click",function(){return Wy(n),Cb(2).selectFirstPlayer("RANDOM")}),zE(10,13),fb(),hb(11,"button",14),kb("click",function(){return Wy(n),Cb(2).selectFirstPlayer("CREATOR")}),zE(12,15),fb(),hb(13,"button",16),kb("click",function(){return Wy(n),Cb(2).selectFirstPlayer("CHOSEN_PLAYER")}),ob(14,wpe,2,1,"ng-container",17),ob(15,Cpe,1,0,"ng-template",null,18,IP),fb(),fb(),fb(),hb(17,"div",8),hb(18,"label",9),zE(19,19),fb(),hb(20,"div",11),hb(21,"div",20),kb("click",function(){return Wy(n),Cb(2).selectPartType("STANDARD")}),hb(22,"div",21),hb(23,"span"),zE(24,22),fb(),fb(),hb(25,"div",23),hb(26,"div",24),hb(27,"div",25),hb(28,"p"),vb(29),zE(30,26),pb(),hb(31,"strong"),Nb(32),sP(33,"humanDuration"),fb(),db(34,"br"),vb(35),VE(36,27),db(37,"strong"),sP(38,"humanDuration"),UE(),pb(),fb(),fb(),fb(),fb(),fb(),hb(39,"div",28),kb("click",function(){return Wy(n),Cb(2).selectPartType("BLITZ")}),hb(40,"div",21),hb(41,"span"),zE(42,29),fb(),fb(),hb(43,"div",23),hb(44,"div",24),hb(45,"div",25),hb(46,"p"),vb(47),zE(48,30),pb(),hb(49,"strong"),Nb(50),sP(51,"humanDuration"),fb(),db(52,"br"),vb(53),VE(54,31),db(55,"strong"),sP(56,"humanDuration"),UE(),pb(),fb(),fb(),fb(),fb(),fb(),hb(57,"button",32),kb("click",function(){return Wy(n),Cb(2).selectPartType("CUSTOM")}),zE(58,33),fb(),fb(),fb(),ob(59,bpe,17,6,"div",34),hb(60,"div",8),hb(61,"label",35),zE(62,36),fb(),hb(63,"div",37),ob(64,Epe,3,0,"div",17),ob(65,Ope,12,1,"ng-template",null,38,IP),fb(),fb(),fb(),hb(67,"div",8),hb(68,"div",11),hb(69,"button",39),kb("click",function(){return Wy(n),Cb(2).proposeConfig()}),zE(70,40),fb(),ob(71,Tpe,2,0,"button",41),hb(72,"button",42),kb("click",function(){return Wy(n),Cb(2).cancelGameCreation()}),zE(73,43),fb(),fb(),fb(),fb(),fb()}if(2&e){var r=sb(16),i=sb(66),a=Cb(2);Ow(3),cb("formGroup",a.configFormGroup),Ow(1),cb("disabled",!a.viewInfo.canEditConfig),Ow(5),cb("ngClass",a.viewInfo.firstPlayerClasses.RANDOM),Ow(2),cb("ngClass",a.viewInfo.firstPlayerClasses.CREATOR),Ow(2),cb("ngClass",a.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),Ow(1),cb("ngIf",a.viewInfo.chosenOpponent)("ngIfElse",r),Ow(7),cb("ngClass",a.viewInfo.partTypeClasses.STANDARD),Ow(11),Mb(uP(33,19,a.partType.NORMAL_MOVE_DURATION)),Ow(6),HE(uP(38,21,a.partType.NORMAL_PART_DURATION)),GE(36),Ow(1),cb("ngClass",a.viewInfo.partTypeClasses.BLITZ),Ow(11),Mb(uP(51,23,a.partType.BLITZ_MOVE_DURATION)),Ow(6),HE(uP(56,25,a.partType.BLITZ_PART_DURATION)),GE(54),Ow(1),cb("ngClass",a.viewInfo.partTypeClasses.CUSTOM),Ow(2),cb("ngIf",a.viewInfo.showCustomTime),Ow(5),cb("ngIf",0===a.viewInfo.candidates.length)("ngIfElse",i),Ow(5),cb("disabled",!a.viewInfo.canProposeConfig),Ow(2),cb("ngIf",a.viewInfo.canReviewConfig)}}function xpe(e,t){if(1&e&&(hb(0,"div",74),hb(1,"p"),VE(2,75),db(3,"br"),UE(),fb(),fb()),2&e){var n=Cb(3);Ow(3),HE(n.viewInfo.creator),GE(2)}}function Ape(e,t){if(1&e&&(hb(0,"span"),zE(1,81),fb()),2&e){var n=Cb(4);Ow(1),HE(n.viewInfo.creator),GE(1)}}function Rpe(e,t){1&e&&(hb(0,"span"),zE(1,82),fb())}function Npe(e,t){1&e&&(hb(0,"span"),zE(1,83),fb())}function Mpe(e,t){if(1&e){var n=gb();hb(0,"div",74),hb(1,"p"),zE(2,76),fb(),hb(3,"ul"),hb(4,"li"),ob(5,Ape,2,1,"span",2),ob(6,Rpe,2,0,"span",2),ob(7,Npe,2,0,"span",2),fb(),hb(8,"li"),VE(9,77),db(10,"strong"),sP(11,"humanDuration"),UE(),fb(),hb(12,"li"),VE(13,78),db(14,"strong"),sP(15,"humanDuration"),UE(),fb(),fb(),hb(16,"button",79),kb("click",function(){return Wy(n),Cb(3).acceptConfig()}),zE(17,80),fb(),fb()}if(2&e){var r=Cb(3);Ow(2),HE(r.viewInfo.creator)(r.viewInfo.partTypeName),GE(2),Ow(3),cb("ngIf","CREATOR"===r.viewInfo.firstPlayer),Ow(1),cb("ngIf","CHOSEN_PLAYER"===r.viewInfo.firstPlayer),Ow(1),cb("ngIf","RANDOM"===r.viewInfo.firstPlayer),Ow(4),HE(uP(11,7,r.viewInfo.maximalMoveDuration||0)),GE(9),Ow(4),HE(uP(15,9,r.viewInfo.totalPartDuration||0)),GE(13)}}function Dpe(e,t){if(1&e&&(hb(0,"div"),hb(1,"div",68),hb(2,"div",69),hb(3,"p"),zE(4,70),fb(),fb(),hb(5,"div",71),ob(6,xpe,4,1,"div",72),ob(7,Mpe,18,11,"ng-template",null,73,IP),fb(),fb(),fb()),2&e){var n=sb(8),r=Cb(2);Ow(6),cb("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function Lpe(e,t){if(1&e&&(vb(0),zE(1,86),pb()),2&e){var n=Cb(3);Ow(1),HE(n.viewInfo.creator),GE(1)}}function Fpe(e,t){if(1&e&&zE(0,87),2&e){var n=Cb(3);HE(n.viewInfo.creator)(n.viewInfo.chosenOpponent),GE(0)}}function Bpe(e,t){if(1&e&&(hb(0,"div",68),hb(1,"div",69),hb(2,"p"),zE(3,84),fb(),fb(),hb(4,"div",71),hb(5,"p"),ob(6,Lpe,2,1,"ng-container",17),ob(7,Fpe,1,2,"ng-template",null,85,IP),fb(),fb(),fb()),2&e){var n=sb(8),r=Cb(2);Ow(6),cb("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function Vpe(e,t){if(1&e&&(hb(0,"div",1),ob(1,Ipe,74,27,"div",2),ob(2,Dpe,9,2,"div",2),ob(3,Bpe,9,2,"div",3),fb()),2&e){var n=Cb();Ow(1),cb("ngIf",n.viewInfo.userIsCreator),Ow(1),cb("ngIf",n.viewInfo.userIsChosenOpponent),Ow(1),cb("ngIf",n.viewInfo.userIsObserver)}}var Upe=function(){var e=function(){function e(t,n,r,i,a,o,s){np(this,e),this.router=t,this.gameService=n,this.joinerService=r,this.chatService=i,this.userService=a,this.formBuilder=o,this.messageDisplayer=s,this.partType=Gee,this.gameStartNotification=new dP,this.gameStarted=!1,this.gameExists=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentJoiner=null,this.candidateSubscription=new _re,this.creatorSubscription=null,this.ngUnsubscribe=new Rp,this.allDocDeleted=!1,aB(e.VERBOSE,"PartCreationComponent constructed for "+this.userName)}return ip(e,[{key:"ngOnInit",value:function(){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return aB(e.VERBOSE,"PartCreationComponent.ngOnInit for "+t.userName),t.checkInputs(),t.createForms(),n.next=5,t.joinerService.joinGame(t.partId,t.userName);case 5:if(n.t0=!n.sent.isFailure(),!n.t0){n.next=8;break}t.gameExists=!0,t.subscribeToJoinerDoc(),t.subscribeToFormElements(),aB(e.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds");case 8:case"end":return n.stop()}},n)}))()}},{key:"checkInputs",value:function(){Z5(null!=this.userName&&""!==this.userName,"PartCreationComponent should not be created with an empty userName"),Z5(null!=this.partId&&""!==this.partId,"PartCreationComponent should not be created with an empty partId")}},{key:"createForms",value:function(){this.configFormGroup=this.formBuilder.group({firstPlayer:[Hee.RANDOM.value,GI.required],maximalMoveDuration:[Gee.NORMAL_MOVE_DURATION,GI.required],partType:["STANDARD",GI.required],totalPartDuration:[Gee.NORMAL_PART_DURATION,GI.required],chosenOpponent:["",GI.required]})}},{key:"subscribeToJoinerDoc",value:function(){var e,t=this;this.joinerService.subscribeToChanges(this.partId,(e=rB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onCurrentJoinerUpdate(n);case 2:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"getForm",value:function(e){return iB.getNonNullable(this.configFormGroup.get(e))}},{key:"subscribeToFormElements",value:function(){var e=this;this.getForm("chosenOpponent").valueChanges.pipe(_pe(this.ngUnsubscribe)).subscribe(function(t){void 0!==e.viewInfo.chosenOpponent&&(e.viewInfo.candidateClasses[e.viewInfo.chosenOpponent]=[]),e.viewInfo.candidateClasses[t]=["is-selected"],e.viewInfo.chosenOpponent=t,e.viewInfo.canProposeConfig=iB.getNonNullable(e.currentJoiner).partStatus!==qee.CONFIG_PROPOSED.value&&""!==t}),this.getForm("partType").valueChanges.pipe(_pe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.partTypeClasses[e.viewInfo.partType]=[],e.viewInfo.partTypeClasses[t]=["is-primary","is-selected"],e.viewInfo.partType=t,e.viewInfo.showCustomTime="CUSTOM"===t}),this.getForm("maximalMoveDuration").valueChanges.pipe(_pe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.maximalMoveDuration=t}),this.getForm("totalPartDuration").valueChanges.pipe(_pe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.totalPartDuration=t}),this.getForm("firstPlayer").valueChanges.pipe(_pe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.firstPlayerClasses[e.viewInfo.firstPlayer]=[],e.viewInfo.firstPlayerClasses[t]=["is-primary","is-selected"],e.viewInfo.firstPlayer=t})}},{key:"updateViewInfo",value:function(){var e=iB.getNonNullable(this.currentJoiner);switch(this.viewInfo.canReviewConfig=e.partStatus===qee.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=e.partStatus!==qee.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userName===e.creator,this.viewInfo.userIsChosenOpponent=this.userName===e.chosenPlayer,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=e.partStatus!==qee.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=e.creator,this.viewInfo.candidates=e.candidates,this.userName===e.creator?this.setDataForCreator(e):(this.viewInfo.maximalMoveDuration=e.maximalMoveDuration,this.viewInfo.totalPartDuration=e.totalPartDuration,this.viewInfo.partType=e.partType,this.viewInfo.chosenOpponent=e.chosenPlayer||void 0,this.viewInfo.firstPlayer=e.firstPlayer),e.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize(Yh||(Yh=Nv(["custom"])));break;case"BLITZ":this.viewInfo.partTypeName=$localize(Kh||(Kh=Nv(["blitz"])));break;case"STANDARD":this.viewInfo.partTypeName=$localize(Jh||(Jh=Nv(["standard"])))}}},{key:"setDataForCreator",value:function(e){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration||e.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration||e.totalPartDuration;var t=this.viewInfo.chosenOpponent;t?-1===e.candidates.indexOf(t)&&(t=""):t=e.chosenPlayer||"",this.getForm("chosenOpponent").setValue(t)}},{key:"selectFirstPlayer",value:function(e){this.getForm("firstPlayer").setValue(e)}},{key:"selectPartType",value:function(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(Gee.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Gee.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(Gee.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Gee.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}},{key:"selectOpponent",value:function(t){var n=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(aB(e.VERBOSE,"PartCreationComponent.setChosenPlayer("+t+")"),n.joinerService.setChosenPlayer(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"changeConfig",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.joinerService.reviewConfig());case 1:case"end":return t.stop()}},t)}))()}},{key:"proposeConfig",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n,r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getForm("chosenOpponent").value,r=e.getForm("partType").value,i=e.getForm("maximalMoveDuration").value,a=e.getForm("firstPlayer").value,o=e.getForm("totalPartDuration").value,t.abrupt("return",e.joinerService.proposeConfig(n,Gee.of(r),i,Hee.of(a),o));case 2:case"end":return t.stop()}},t)}))()}},{key:"cancelGameCreation",value:function(){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.allDocDeleted=!0,aB(e.VERBOSE,"PartCreationComponent.cancelGameCreation"),n.next=4,t.gameService.deletePart(t.partId);case 4:return aB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: game deleted"),n.next=7,t.joinerService.deleteJoiner();case 7:return aB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: game and joiner deleted"),n.next=10,t.chatService.deleteChat(t.partId);case 10:aB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: game and joiner and chat deleted");case 11:case"end":return n.stop()}},n)}))()}},{key:"onCurrentJoinerUpdate",value:function(t){if(aB(e.VERBOSE,{PartCreationComponent_onCurrentJoinerUpdate:{before:JSON.stringify(this.currentJoiner),then:JSON.stringify(t)}}),t.isAbsent())return aB(e.VERBOSE,"PartCreationComponent.onCurrentJoinerUpdate: LAST UPDATE : the game is cancelled"),this.onGameCancelled();this.currentJoiner=t.get(),this.observeNeededPlayers(),this.updateViewInfo(),this.isGameStarted()&&(aB(e.VERBOSE,"PartCreationComponent.onCurrentJoinerUpdate: the game has started"),this.onGameStarted())}},{key:"onGameCancelled",value:function(){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return aB(e.VERBOSE,"PartCreationComponent.onGameCancelled"),t.messageDisplayer.infoMessage($localize(Qh||(Qh=Nv(["The game has been canceled!"])))),n.next=4,t.router.navigate(["/lobby"]);case 4:case"end":return n.stop()}},n)}))()}},{key:"isGameStarted",value:function(){var e=iB.getNonNullable(this.currentJoiner);return null!=e&&e.partStatus===qee.PART_STARTED.value}},{key:"onGameStarted",value:function(){var t=iB.getNonNullable(this.currentJoiner);aB(e.VERBOSE,{partCreationComponent_onGameStarted:{joiner:t}}),this.gameStartNotification.emit(t),this.gameStarted=!0,aB(e.VERBOSE,"PartCreationComponent.onGameStarted finished")}},{key:"observeNeededPlayers",value:function(){var t=iB.getNonNullable(this.currentJoiner);aB(e.VERBOSE,{PartCreationComponent_updateJoiner:{joiner:t}}),this.userName===t.creator?this.observeCandidates():this.observeCreator()}},{key:"observeCreator",value:function(){var e=this,t=iB.getNonNullable(this.currentJoiner);if(null==this.creatorSubscription){var n,r=(n=rB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.destroyDocIfCreatorOffline(n);case 2:case"end":return t.stop()}},t)})),function(e){return n.apply(this,arguments)}),i=new n6(r,r,r);this.creatorSubscription=this.userService.observeUserByUsername(t.creator,i)}}},{key:"destroyDocIfCreatorOffline",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=iB.getNonNullable(t.currentJoiner),i=Xv(e),n.prev=2,i.s();case 4:if((a=i.n()).done){n.next=13;break}if(Z5((o=a.value).data.username===r.creator,"found non creator while observing creator!"),n.t0="offline"===o.data.state&&!1===t.allDocDeleted&&r.partStatus!==qee.PART_STARTED.value,!n.t0){n.next=11;break}return n.next=11,t.cancelGameCreation();case 11:n.next=4;break;case 13:n.next=18;break;case 15:n.prev=15,n.t1=n.catch(2),i.e(n.t1);case 18:return n.prev=18,i.f(),n.finish(18);case 21:case"end":return n.stop()}},n,null,[[2,15,18,21]])}))()}},{key:"observeCandidates",value:function(){var t=this,n=iB.getNonNullable(this.currentJoiner);aB(e.VERBOSE,{PartCreation_observeCandidates:n});var r,i,a=new n6((r=rB(regeneratorRuntime.mark(function e(n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=Xv(n),e.prev=1,r.s();case 3:if((i=r.n()).done){e.next=13;break}if(a=i.value,e.t0="offline"===a.data.state,!e.t0){e.next=11;break}return e.next=9,t.removeUserFromLobby(iB.getNonNullable(a.data.username));case 9:return e.next=11,j5.logError("PartCreationComponent","user is already offline",{username:a.data.username,userId:a.id});case 11:e.next=3;break;case 13:e.next=18;break;case 15:e.prev=15,e.t1=e.catch(1),r.e(e.t1);case 18:return e.prev=18,r.f(),e.finish(18);case 21:case"end":return e.stop()}},e,null,[[1,15,18,21]])})),function(e){return r.apply(this,arguments)}),function(){var e=rB(regeneratorRuntime.mark(function e(n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=Xv(n),e.prev=1,r.s();case 3:if((i=r.n()).done){e.next=11;break}if(a=i.value,e.t0="offline"===a.data.state,!e.t0){e.next=9;break}return e.next=9,t.removeUserFromLobby(iB.getNonNullable(a.data.username));case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t1=e.catch(1),r.e(e.t1);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}},e,null,[[1,13,16,19]])}));return function(t){return e.apply(this,arguments)}}(),function(){var e=rB(regeneratorRuntime.mark(function e(n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=Xv(n),e.prev=1,r.s();case 3:if((i=r.n()).done){e.next=11;break}return a=i.value,e.next=7,t.removeUserFromLobby(iB.getNonNullable(a.data.username));case 7:return e.next=9,j5.logError("PartCreationComponent","user was deleted",{username:a.data.username,userId:a.id});case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}},e,null,[[1,13,16,19]])}));return function(t){return e.apply(this,arguments)}}()),o=Xv(n.candidates);try{for(o.s();!(i=o.n()).done;){var s=i.value;if(this.candidateSubscription.get(s).isAbsent()){var u=this.userService.observeUserByUsername(s,a);this.candidateSubscription.set(s,u)}}}catch(f){o.e(f)}finally{o.f()}var c,l=Xv(this.candidateSubscription.listKeys());try{for(l.s();!(c=l.n()).done;){var h=c.value;h!==n.chosenPlayer&&!1===n.candidates.includes(h)&&this.unsubscribeFrom(h)}}catch(f){l.e(f)}finally{l.f()}}},{key:"removeUserFromLobby",value:function(e){var t=iB.getNonNullable(this.currentJoiner),n=t.candidates.indexOf(e);Z5(-1!==n,"PartCreationComponent: attempting to remove a user not in the lobby");var r=t.candidates.slice(0,n),i=t.candidates.slice(n+1),a=r.concat(i);return e===t.chosenPlayer?(this.messageDisplayer.infoMessage($localize(Xh||(Xh=Nv([""," left the game, please pick another opponent."])),e)),this.joinerService.reviewConfigRemoveChosenPlayerAndUpdateCandidates(a)):this.joinerService.updateCandidates(a)}},{key:"unsubscribeFrom",value:function(e){this.candidateSubscription.delete(e)()}},{key:"acceptConfig",value:function(){return aB(e.VERBOSE,"PartCreationComponent.acceptConfig"),this.gameService.acceptConfig(this.partId,iB.getNonNullable(this.currentJoiner))}},{key:"ngOnDestroy",value:function(){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:aB(e.VERBOSE,"PartCreationComponent.ngOnDestroy"),t.ngUnsubscribe.next(),t.ngUnsubscribe.complete(),t.gameExists&&t.joinerService.unsubscribe(),r=Xv(t.candidateSubscription.listKeys());try{for(r.s();!(i=r.n()).done;)a=i.value,t.unsubscribeFrom(a)}catch(o){r.e(o)}finally{r.f()}if(!1!==t.gameStarted){n.next=17;break}if(null!==t.currentJoiner){n.next=6;break}return n.abrupt("return",void aB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"));case 6:if(t.userName!==t.currentJoiner.creator){n.next=12;break}return aB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),n.next=10,t.cancelGameCreation();case 10:n.next=17;break;case 12:if(n.t0=!1===t.allDocDeleted,!n.t0){n.next=17;break}return aB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you(joiner) about to cancel game joining"),n.next=17,t.joinerService.cancelJoining(t.userName);case 17:case"end":return n.stop()}},n)}))()}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ub(WM),ub(ete),ub(Xee),ub(t6),ub(a6),ub(gA),ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-part-creation"]],inputs:{partId:"partId",userName:"userName"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){return[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],$localize(ef||(ef=Nv(["Game creation"]))),[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],$localize(tf||(tf=Nv(["First player"]))),[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],$localize(nf||(nf=Nv(["Random"]))),["id","firstPlayerCreator",1,"button",3,"ngClass","click"],$localize(rf||(rf=Nv(["You"]))),["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],$localize(af||(af=Nv(["Game type"]))),["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],$localize(of||(of=Nv(["Standard"]))),["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],$localize(sf||(sf=Nv(["Maximal turn duration: "]))),$localize(uf||(uf=Nv(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#37\ufffd","\ufffd0\ufffd","\ufffd/#37\ufffd"),["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],$localize(cf||(cf=Nv(["Blitz"]))),$localize(lf||(lf=Nv(["Maximal turn duration: "]))),$localize(hf||(hf=Nv(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#55\ufffd","\ufffd0\ufffd","\ufffd/#55\ufffd"),["id","partTypeCustom",1,"button",3,"ngClass","click"],$localize(ff||(ff=Nv(["Custom"]))),["id","customTime",4,"ngIf"],[1,"label"],$localize(df||(df=Nv(["Opponents"]))),[1,"control"],["chooseCandidate",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],$localize(vf||(vf=Nv(["Propose configuration"]))),["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],$localize(pf||(pf=Nv(["Cancel game"]))),$localize(gf||(gf=Nv(["The opponent"]))),["id","customTime"],["for","maximalMoveDuration",1,"label"],$localize(yf||(yf=Nv(["Maximal turn duration: "]))),["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],$localize(mf||(mf=Nv(["Maximal game duration: ",":START_TAG_OUTPUT:",":INTERPOLATION: per player",":CLOSE_TAG_OUTPUT:"])),"\ufffd#13\ufffd","\ufffd0\ufffd","\ufffd/#13\ufffd"),["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],$localize(kf||(kf=Nv(["Potential opponents that join the game will appear here.",":LINE_BREAK:Wait for an opponent to join, so that you can pick one."])),"\ufffd#2\ufffd\ufffd/#2\ufffd"),$localize(_f||(_f=Nv(["Click on the opponent against which you would like to play."]))),["id","chooseCandidate",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(wf||(wf=Nv(["Name"]))),$localize(Cf||(Cf=Nv(["Actions"]))),[3,"ngClass","id","click",4,"ngFor","ngForOf"],[3,"ngClass","id","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],$localize(bf||(bf=Nv(["Pick"]))),["id","reviewConfig",1,"button",3,"click"],$localize(Ef||(Ef=Nv(["Change configuration"]))),[1,"message","is-primary"],[1,"message-header"],$localize(Sf||(Sf=Nv(["Configuration proposal"]))),[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],$localize(Pf||(Pf=Nv(["You have been selected as the opponent.",":LINE_BREAK: ",":INTERPOLATION: is modifying the configuration."])),"\ufffd#3\ufffd\ufffd/#3\ufffd","\ufffd0\ufffd"),$localize(Of||(Of=Nv(["",":INTERPOLATION: proposes to play a ",":INTERPOLATION_1: game"])),"\ufffd0\ufffd","\ufffd1\ufffd"),$localize(Tf||(Tf=Nv(["a turn lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: ",":CLOSE_TAG_STRONG:"])),"\ufffd#10\ufffd","\ufffd0\ufffd","\ufffd/#10\ufffd"),$localize(If||(If=Nv(["the game lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#14\ufffd","\ufffd0\ufffd","\ufffd/#14\ufffd"),["id","acceptConfig",1,"button","is-primary",3,"click"],$localize(xf||(xf=Nv(["Accept and start"]))),$localize(Af||(Af=Nv(["",":INTERPOLATION: plays first"])),"\ufffd0\ufffd"),$localize(Rf||(Rf=Nv(["you play first"]))),$localize(Nf||(Nf=Nv(["the first player is selected randomly"]))),$localize(Mf||(Mf=Nv(["One moment..."]))),["proposalSent",""],$localize(Df||(Df=Nv(["",":INTERPOLATION: is configuring the game."])),"\ufffd0\ufffd"),$localize(Lf||(Lf=Nv(["",":INTERPOLATION: has proposed a configuration to ",":INTERPOLATION_1:."])),"\ufffd0\ufffd","\ufffd1\ufffd")]},template:function(e,t){1&e&&ob(0,Vpe,4,3,"div",0),2&e&&cb("ngIf",t.viewInfo)},directives:[DT,Wx,vx,Qx,AT,FI,Yx,dx,eA,NT],pipes:[mpe],encapsulation:2}),e}();function zpe(e,t){if(1&e){var n=gb();hb(0,"button",3),kb("click",function(){return Wy(n),Cb().addTime()}),zE(1,4),fb()}if(2&e){var r=Cb();Ow(1),HE(r.timeToAdd),GE(1)}}var Hpe=function(){var e=function(){function e(){np(this,e),this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new dP,this.addTimeToOpponent=new dP,this.cssClasses=e.SAFE_TIME}return ip(e,[{key:"ngOnInit",value:function(){aB(e.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}},{key:"setDuration",value:function(t){if(aB(e.VERBOSE,this.debugName+".set("+t+"ms)"),this.started)throw new Error("Should not set a chrono that has already been started ("+this.debugName+")!");this.isSet=!0,this.changeDuration(t)}},{key:"changeDuration",value:function(e){var t=!1;!1===this.isPaused&&(this.pause(),t=!0),this.remainingMs=e,this.displayDuration(),t&&this.resume()}},{key:"displayDuration",value:function(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}},{key:"start",value:function(){if(aB(e.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),!1===this.isSet)throw new Error("Should not start a chrono that has not been set!");if(this.started)throw new Error("Should not start chrono that has already been started ("+this.debugName+")");this.started=!0,this.resume()}},{key:"resume",value:function(){var t=this;if(aB(e.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),!1===this.isPaused||!1===this.started)throw new Error("Should only resume chrono that are started and paused!");this.startTime=Date.now();var n=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(function(){t.onEndReached()},n),this.countSeconds()}},{key:"onEndReached",value:function(){aB(e.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}},{key:"countSeconds",value:function(){var e=this;this.timeoutHandleSec=window.setTimeout(function(){e.updateShownTime()},1e3)}},{key:"isIdle",value:function(){return!1===this.started||this.isPaused}},{key:"pause",value:function(){if(aB(e.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),!this.started)throw new Error("Should not pause not started chrono ("+this.debugName+")");if(this.isPaused)throw new Error("Should not pause already paused chrono ("+this.debugName+")");this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}},{key:"stop",value:function(){if(aB(e.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),!1===this.started)throw new Error("Should only stop chrono that are started!");this.pause(),this.started=!1,this.isSet=!1}},{key:"isStarted",value:function(){return this.started}},{key:"getTimeClass",value:function(){return!1===this.active?e.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?e.DANGER_TIME_ODD:e.DANGER_TIME_EVEN:e.SAFE_TIME}},{key:"updateShownTime",value:function(){var e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}},{key:"clearTimeouts",value:function(){aB(e.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}},{key:"addTime",value:function(){this.addTimeToOpponent.emit()}},{key:"ngOnDestroy",value:function(){this.clearTimeouts()}}]),e}();return e.VERBOSE=!1,e.DANGER_TIME_EVEN="has-background-danger has-text-white",e.DANGER_TIME_ODD="has-background-warning has-text-white",e.PASSIVE_STYLE="has-text-passive is-italic",e.SAFE_TIME="",e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ty({type:e,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){return[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],$localize(Ff||(Ff=Nv(["Add ",":INTERPOLATION:"])),"\ufffd0\ufffd")]},template:function(e,t){1&e&&(hb(0,"div",0),hb(1,"p",1),Nb(2),sP(3,"number"),fb(),ob(4,zpe,2,1,"button",2),fb()),2&e&&(cb("ngClass",t.getTimeClass()),Ow(2),Lb("",t.displayedMinute,":",function(e,t,n,r){var i=qy(),a=Dy(i,23);return hP(i,lP(i,23)?oP(i,tm(),4,a.transform,n,r,a):a.transform(n,r))}(0,0,t.displayedSec,"2.0-0"),""),Ow(2),cb("ngIf",t.canAddTime))},directives:[AT,DT],pipes:[UT],encapsulation:2}),e}(),Gpe=["partCreation"],qpe=["chatComponent"],$pe=["chronoZeroGlobal"],Wpe=["chronoOneGlobal"],jpe=["chronoZeroTurn"],Zpe=["chronoOneTurn"];function Ype(e,t){if(1&e){var n=gb();hb(0,"app-part-creation",5,6),kb("gameStartNotification",function(e){return Wy(n),Cb().startGame(e)}),fb()}if(2&e){var r=Cb();cb("partId",r.currentPartId)("userName",r.getPlayerName())}}function Kpe(e,t){1&e&&(vb(0),zE(1,40),pb())}function Jpe(e,t){1&e&&zE(0,41),2&e&&(HE(Cb(4).currentPlayer),GE(0))}function Qpe(e,t){if(1&e&&(hb(0,"p",37),ob(1,Kpe,2,0,"ng-container",38),ob(2,Jpe,1,1,"ng-template",null,39,IP),fb()),2&e){var n=sb(3),r=Cb(3);Ow(1),cb("ngIf",r.currentPlayer===r.getPlayerName())("ngIfElse",n)}}function Xpe(e,t){if(1&e&&(hb(0,"div",33),hb(1,"p",34),zE(2,35),fb(),ob(3,Qpe,4,2,"p",36),fb()),2&e){var n=Cb(2);Ow(2),HE(n.currentPart.getTurn()+1),GE(2),Ow(1),cb("ngIf",!1===n.endGame)}}function ege(e,t){if(1&e&&(hb(0,"p",42),Nb(1),fb()),2&e){var n=Cb(2);cb("ngClass",n.getPlayerNameClass(0)),Ow(1),Mb(n.players[0].get())}}function tge(e,t){if(1&e&&(hb(0,"p",43),zE(1,44),fb()),2&e){var n=Cb(2);Ow(1),HE(n.gameComponent.scores.get()[0]),GE(1)}}function nge(e,t){if(1&e&&(hb(0,"p",45),Nb(1),fb()),2&e){var n=Cb(2);cb("ngClass",n.getPlayerNameClass(1)),Ow(1),Mb(n.players[1].get())}}function rge(e,t){if(1&e&&(hb(0,"p",46),zE(1,47),fb()),2&e){var n=Cb(2);Ow(1),HE(n.gameComponent.scores.get()[1]),GE(1)}}function ige(e,t){if(1&e){var n=gb();hb(0,"button",56),kb("click",function(){return Wy(n),Cb(3).resign()}),zE(1,57),fb()}}function age(e,t){if(1&e){var n=gb();hb(0,"button",58),kb("click",function(){return Wy(n),Cb(3).proposeDraw()}),zE(1,59),fb()}}function oge(e,t){if(1&e){var n=gb();hb(0,"button",60),kb("click",function(){return Wy(n),Cb(3).acceptDraw()}),zE(1,61),fb()}}function sge(e,t){if(1&e){var n=gb();hb(0,"button",62),kb("click",function(){return Wy(n),Cb(3).refuseDraw()}),zE(1,63),fb()}}function uge(e,t){if(1&e){var n=gb();hb(0,"button",64),kb("click",function(){return Wy(n),Cb(3).gameComponent.pass()}),zE(1,65),fb()}}function cge(e,t){if(1&e){var n=gb();hb(0,"button",66),kb("click",function(){return Wy(n),Cb(3).acceptTakeBack()}),zE(1,67),fb()}}function lge(e,t){if(1&e){var n=gb();hb(0,"button",68),kb("click",function(){return Wy(n),Cb(3).refuseTakeBack()}),zE(1,69),fb()}}function hge(e,t){if(1&e){var n=gb();hb(0,"button",70),kb("click",function(){return Wy(n),Cb(3).askTakeBack()}),zE(1,71),fb()}}function fge(e,t){if(1&e&&(vb(0),ob(1,ige,2,0,"button",48),ob(2,age,2,0,"button",49),ob(3,oge,2,0,"button",50),ob(4,sge,2,0,"button",51),ob(5,uge,2,0,"button",52),ob(6,cge,2,0,"button",53),ob(7,lge,2,0,"button",54),ob(8,hge,2,0,"button",55),pb()),2&e){var n=Cb(2);Ow(1),cb("ngIf",n.canResign()),Ow(1),cb("ngIf",n.canProposeDraw()),Ow(1),cb("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),Ow(1),cb("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),Ow(1),cb("ngIf",!1===n.endGame&&n.isPlaying()&&n.gameComponent.canPass&&n.currentPlayer===n.getPlayerName()),Ow(1),cb("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),Ow(1),cb("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),Ow(1),cb("ngIf",!1===n.endGame&&!1===n.isOpponentWaitingForTakeBackResponse()&&n.canAskTakeBack())}}function dge(e,t){1&e&&(hb(0,"div"),hb(1,"p",73),zE(2,74),fb(),fb())}function vge(e,t){1&e&&(hb(0,"p",78),zE(1,79),fb())}function pge(e,t){1&e&&(hb(0,"p",80),zE(1,81),fb())}function gge(e,t){1&e&&(hb(0,"p",82),zE(1,83),fb())}function yge(e,t){if(1&e&&(hb(0,"div"),ob(1,vge,2,0,"p",75),ob(2,pge,2,0,"p",76),ob(3,gge,2,0,"p",77),fb()),2&e){var n=Cb(3);Ow(1),cb("ngIf",n.currentPart.getDrawAccepter()===n.getPlayerName()),Ow(1),cb("ngIf",n.currentPart.getDrawAccepter()!==n.getPlayerName()&&n.isPlaying()),Ow(1),cb("ngIf",!1===n.isPlaying())}}function mge(e,t){1&e&&(hb(0,"p",86),zE(1,87),fb())}function kge(e,t){1&e&&(hb(0,"p",88),zE(1,89),fb())}function _ge(e,t){if(1&e&&(hb(0,"p",88),zE(1,90),fb()),2&e){var n=Cb(4);Ow(1),HE(n.currentPart.getWinner().get()),GE(1)}}function wge(e,t){if(1&e&&(hb(0,"div"),ob(1,mge,2,0,"p",84),ob(2,kge,2,0,"p",85),ob(3,_ge,2,1,"p",85),fb()),2&e){var n=Cb(3);Ow(1),cb("ngIf",n.currentPart.getWinner().get()===n.getPlayerName()),Ow(1),cb("ngIf",n.currentPart.getWinner().get()!==n.getPlayerName()&&n.isPlaying()),Ow(1),cb("ngIf",!1===n.isPlaying())}}function Cge(e,t){if(1&e&&(hb(0,"p",86),zE(1,91),fb()),2&e){var n=Cb(4);Ow(1),HE(n.currentPart.getLoser().get()),GE(1)}}function bge(e,t){1&e&&(hb(0,"p",88),zE(1,92),fb())}function Ege(e,t){if(1&e&&(hb(0,"p",88),zE(1,93),fb()),2&e){var n=Cb(4);Ow(1),HE(n.currentPart.getLoser().get()),GE(1)}}function Sge(e,t){if(1&e&&(hb(0,"div"),ob(1,Cge,2,1,"p",84),ob(2,bge,2,0,"p",85),ob(3,Ege,2,1,"p",85),fb()),2&e){var n=Cb(3);Ow(1),cb("ngIf",n.currentPart.getWinner().get()===n.getPlayerName()),Ow(1),cb("ngIf",n.currentPart.getWinner().get()!==n.getPlayerName()&&n.isPlaying()),Ow(1),cb("ngIf",!1===n.isPlaying())}}function Pge(e,t){1&e&&(hb(0,"p",95),zE(1,96),fb())}function Oge(e,t){if(1&e&&(hb(0,"p",95),zE(1,97),fb()),2&e){var n=Cb(4);Ow(1),HE(n.currentPart.getLoser().get()),GE(1)}}function Tge(e,t){if(1&e&&(hb(0,"div"),ob(1,Pge,2,0,"p",94),ob(2,Oge,2,1,"p",94),fb()),2&e){var n=Cb(3);Ow(1),cb("ngIf",n.currentPart.getWinner().get()!==n.getPlayerName()&&n.isPlaying()),Ow(1),cb("ngIf",!1===n.isPlaying()||n.currentPart.getWinner().get()===n.getPlayerName())}}function Ige(e,t){if(1&e&&(hb(0,"div",72),db(1,"hr"),ob(2,dge,3,0,"div",26),ob(3,yge,4,3,"div",26),ob(4,wge,4,3,"div",26),ob(5,Sge,4,3,"div",26),ob(6,Tge,3,2,"div",26),fb()),2&e){var n=Cb(2);Ow(2),cb("ngIf",n.currentPart.isHardDraw()),Ow(1),cb("ngIf",n.currentPart.isAgreedDraw()),Ow(1),cb("ngIf",n.currentPart.isWin()),Ow(1),cb("ngIf",n.currentPart.isTimeout()),Ow(1),cb("ngIf",n.currentPart.isResign())}}function xge(e,t){1&e&&(hb(0,"button",98),zE(1,99),fb())}function Age(e,t){if(1&e){var n=gb();hb(0,"button",100),kb("click",function(){return Wy(n),Cb(2).proposeRematch()}),zE(1,101),fb()}}function Rge(e,t){if(1&e){var n=gb();hb(0,"button",102),kb("click",function(){return Wy(n),Cb(2).acceptRematch()}),zE(1,103),fb()}}function Nge(e,t){if(1&e){var n=gb();hb(0,"div",7),hb(1,"div",8),hb(2,"div",9),ob(3,Xpe,4,2,"div",10),hb(4,"div",11),ob(5,ege,2,2,"p",12),ob(6,tge,2,1,"p",13),hb(7,"app-count-down",14,15),kb("outOfTimeAction",function(){return Wy(n),Cb().reachedOutOfTime(0)})("addTimeToOpponent",function(){return Wy(n),Cb().addGlobalTime()}),fb(),hb(9,"app-count-down",16,17),kb("outOfTimeAction",function(){return Wy(n),Cb().reachedOutOfTime(0)})("addTimeToOpponent",function(){return Wy(n),Cb().addTurnTime()}),fb(),fb(),hb(11,"p",18),zE(12,19),fb(),hb(13,"div",11),ob(14,nge,2,2,"p",20),ob(15,rge,2,1,"p",21),hb(16,"app-count-down",22,23),kb("outOfTimeAction",function(){return Wy(n),Cb().reachedOutOfTime(1)})("addTimeToOpponent",function(){return Wy(n),Cb().addGlobalTime()}),fb(),hb(18,"app-count-down",24,25),kb("outOfTimeAction",function(){return Wy(n),Cb().reachedOutOfTime(1)})("addTimeToOpponent",function(){return Wy(n),Cb().addTurnTime()}),fb(),fb(),db(20,"hr"),ob(21,fge,9,8,"ng-container",26),ob(22,Ige,7,5,"div",27),ob(23,xge,2,0,"button",28),ob(24,Age,2,0,"button",29),ob(25,Rge,2,0,"button",30),fb(),fb(),hb(26,"div",31),hb(27,"div",32),db(28,"app-game-includer"),fb(),fb(),fb()}if(2&e){var r=Cb();Ow(3),cb("ngIf",r.currentPart),Ow(2),cb("ngIf",r.players[0].isPresent()),Ow(1),cb("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),Ow(1),cb("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",1===r.observerRole&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),Ow(2),cb("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",1===r.observerRole&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),Ow(5),cb("ngIf",r.players[1].isPresent()),Ow(1),cb("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),Ow(1),cb("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",0===r.observerRole&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),Ow(2),cb("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",0===r.observerRole&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),Ow(3),cb("ngIf",r.isPlaying()),Ow(1),cb("ngIf",r.endGame),Ow(1),cb("ngIf",r.endGame),Ow(1),cb("ngIf",r.endGame&&r.isPlaying()&&!1===r.rematchProposed),Ow(1),cb("ngIf",r.endGame&&r.isPlaying()&&r.rematchProposed&&r.opponentProposedRematch),Ow(1),cb("ngClass",r.getBoardHighlight())}}var Mge=ip(function e(t){np(this,e),this.value=t});Mge.PRE_START_DOC=new Mge("PRE_START_DOC"),Mge.STARTING_DOC=new Mge("STARTING_DOC"),Mge.DUPLICATE=new Mge("DUPLICATE"),Mge.MOVE_WITHOUT_TIME=new Mge("MOVE_WITHOUT_TIME"),Mge.MOVE=new Mge("MOVE"),Mge.REQUEST=new Mge("REQUEST"),Mge.END_GAME=new Mge("END_GAME"),Mge.END_GAME_WITHOUT_TIME=new Mge("END_GAME_WITHOUT_TIME"),Mge.ACCEPT_TAKE_BACK_WITHOUT_TIME=new Mge("ACCEPT_TAKE_BACK_WITHOUT_TIME");var Dge=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o,s){var u;return np(this,n),(u=t.call(this,e,r,o)).router=i,u.userService=a,u.gameService=s,u.gameStarted=!1,u.opponent=null,u.playerName=null,u.rematchProposed=!1,u.opponentProposedRematch=!1,u.hasUserPlayed=[!1,!1],u.msToSubstract=[0,0],u.opponentSubscription=cB.empty(),u.OFFLINE_FONT_COLOR={color:"lightgrey"},u.globalTimeMessage=$localize(Bf||(Bf=Nv(["5 minutes"]))),u.turnTimeMessage=$localize(Vf||(Vf=Nv(["30 seconds"]))),aB(n.VERBOSE,"OnlineGameWrapperComponent constructed"),u}return ip(n,[{key:"extractPartIdFromURL",value:function(){return iB.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}},{key:"extractGameTypeFromURL",value:function(){return iB.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}},{key:"isPlaying",value:function(){return this.observerRole===Zee.ZERO.value||this.observerRole===Zee.ONE.value}},{key:"getPlayer",value:function(){return Zee.of(this.observerRole)}},{key:"getPlayerName",value:function(){return iB.getNonNullable(this.playerName)}},{key:"isPlayer",value:function(e){return this.observerRole===e.value}},{key:"isOpponent",value:function(e){return this.observerRole!==e.value}},{key:"redirectIfPartIsInvalid",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.extractGameTypeFromURL(),t.next=3,e.gameService.getPartValidity(e.currentPartId,n);case 3:if(!t.sent.isFailure()){t.next=8;break}return"/notFound",e.routerEventsSub.unsubscribe(),t.next=8,e.router.navigate(["/notFound"]);case 8:case"end":return t.stop()}},t)}))()}},{key:"setCurrentPartIdOrRedirect",value:function(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartIsInvalid()}},{key:"ngOnInit",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return aB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),e.routerEventsSub=e.router.events.subscribe(function(){var t=rB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=n instanceof kR,!t.t0){t.next=4;break}return t.next=4,e.setCurrentPartIdOrRedirect();case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),e.userSub=e.authenticationService.getUserObs().subscribe(function(t){e.playerName=t.username.get()}),t.next=5,e.setCurrentPartIdOrRedirect();case 5:case"end":return t.stop()}},t)}))()}},{key:"startGame",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:aB(n.VERBOSE,"OnlineGameWrapperComponent.startGame"),Z5(!1===t.gameStarted,"Should not start already started game"),t.joiner=e,t.gameStarted=!0,setTimeout(function(){t.afterGameIncluderViewInit(),t.startPart()},1);case 1:case"end":return r.stop()}},r)}))()}},{key:"startPart",value:function(){var e,t=this;aB(n.VERBOSE,"OnlineGameWrapperComponent.startPart"),this.gameService.startObserving(this.currentPartId,(e=rB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Z5(n.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.next=3,t.onCurrentPartUpdate(n.get());case 3:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"onCurrentPartUpdate",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new K5(t.currentPartId,e),aB(n.VERBOSE,{OnlineGameWrapperComponent_onCurrentPartUpdate:{before:t.currentPart,then:e.data,before_part_turn:i.data.turn,before_state_turn:t.gameComponent.rules.node.gameState.turn,nbPlayedMoves:i.data.listMoves.length}}),a=t.getUpdateType(i),o=e.turn,aB(n.VERBOSE,a===Mge.REQUEST?"UpdateType: Request("+iB.getNonNullable(i.data.request).code+") ("+o+")":"UpdateType: "+a.value+"("+o+")"),s=t.currentPart,r.t0=(t.currentPart=i,a),r.next=r.t0===Mge.REQUEST?8:r.t0===Mge.ACCEPT_TAKE_BACK_WITHOUT_TIME?11:r.t0===Mge.DUPLICATE?12:r.t0===Mge.END_GAME_WITHOUT_TIME?13:r.t0===Mge.END_GAME?14:r.t0===Mge.MOVE_WITHOUT_TIME?15:r.t0===Mge.MOVE?16:r.t0===Mge.PRE_START_DOC?17:19;break;case 8:return r.next=10,t.onRequest(iB.getNonNullable(i.data.request),s);case 10:return r.abrupt("return",r.sent);case 11:return r.abrupt("return",void(t.currentPart=s));case 12:return r.abrupt("return");case 13:return r.abrupt("return",void(t.currentPart=s));case 14:return r.abrupt("return",t.applyEndGame());case 15:return r.abrupt("return",void(t.currentPart=s));case 16:return r.abrupt("return",(t.msToSubstract=t.getLastUpdateTime(s,i,a),t.doNewMoves(i)));case 17:return u=null==t.currentPart||null!=t.currentPart.data.beginning,r.abrupt("return",void Z5(null==s||null==s.data.beginning||u,"old part had no beginning time or new part has, we did not expect this!"));case 19:return r.abrupt("return",(Z5(a===Mge.STARTING_DOC,"Unexpected update type "+a),t.setChronos(),t.setPlayersDatas(i),t.startCountDownFor(Zee.ZERO)));case 20:case"end":return r.stop()}},r)}))()}},{key:"getUpdateType",value:function(e){var t=ype.from(null!=this.currentPart?this.currentPart.data:null,e.data);aB(n.VERBOSE,{diff:t});var r=t.countChanges();if(0===r)return Mge.DUPLICATE;if(e.data.request){var i=null!=t.removed.lastUpdateTime;return"TakeBackAccepted"===e.data.request.code&&i?Mge.ACCEPT_TAKE_BACK_WITHOUT_TIME:Mge.REQUEST}if(this.isMove(t,r))return 1===e.data.turn?null==e.data.lastUpdateTime?Mge.MOVE_WITHOUT_TIME:Mge.MOVE:null==t.modified.lastUpdateTime?Mge.MOVE_WITHOUT_TIME:Mge.MOVE;if(null==e.data.beginning)return Mge.PRE_START_DOC;if(e.data.result!==Y5.UNACHIEVED.value){var a=null==t.modified.lastUpdateTime;return null!=t.modified.turn&&a?Mge.END_GAME_WITHOUT_TIME:Mge.END_GAME}return Z5(null!=e.data.beginning&&0===e.data.listMoves.length,"Unexpected update: "+JSON.stringify(t)),Mge.STARTING_DOC}},{key:"isMove",value:function(e,t){if(null!=e.modified.listMoves&&null!=e.modified.turn){return t===(e.isPresent("lastUpdateTime").present?1:0)+(e.isPresent("scorePlayerZero").present?1:0)+(e.isPresent("scorePlayerOne").present?1:0)+(e.isPresent("remainingMsForZero").present?1:0)+(e.isPresent("remainingMsForOne").present?1:0)+(null==e.removed.request?0:1)+3}return!1}},{key:"getLastUpdateTime",value:function(e,t,n){var r=this.getMoreRecentTime(e),i=this.getMoreRecentTime(t);Z5(null!=r,"TODO: OLD_TIME WAS NULL, UNDO COMMENT AND TEST!"),Z5(null!=i,"TODO UPDATE_TIME WAS NULL, UNDO COMMENT AND TEST!");var a=Zee.fromTurn(e.data.turn);return this.getTimeUsedForLastTurn(iB.getNonNullable(r),iB.getNonNullable(i),n,a)}},{key:"getMoreRecentTime",value:function(e){var t;return null!==(t=e.data.lastUpdateTime)&&void 0!==t?t:e.data.beginning}},{key:"getTimeUsedForLastTurn",value:function(e,t,n,r){var i=function(e,t){return kpe(t)-kpe(e)}(e,t),a=[0,0];return a[r.value]=i,a}},{key:"setChronos",value:function(){aB(n.VERBOSE,"onlineGameWrapperComponent.setChronos()"),this.chronoZeroGlobal.setDuration(1e3*this.joiner.totalPartDuration),this.chronoOneGlobal.setDuration(1e3*this.joiner.totalPartDuration),this.chronoZeroTurn.setDuration(1e3*this.joiner.maximalMoveDuration),this.chronoOneTurn.setDuration(1e3*this.joiner.maximalMoveDuration)}},{key:"didUserPlay",value:function(e){return this.hasUserPlayed[e.value]}},{key:"doNewMoves",value:function(e){this.switchPlayer();for(var t=Q5.copyImmutableArray(e.data.listMoves),n=this.gameComponent.rules;n.node.gameState.turn<t.length;){var r=n.node.gameState.turn,i=this.gameComponent.encoder.decode(t[r]),a=n.isLegal(i,n.node.gameState),o="We received an incorrect db move: "+i.toString()+" in "+t+" at turn "+r+'because "'+a.getReasonOr("")+'"';Z5(a.isSuccess(),o),n.choose(i)}this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get(),this.gameComponent.updateBoard()}},{key:"switchPlayer",value:function(){aB(n.VERBOSE,"OnlineGameWrapperComponent.switchPlayer");var e=Zee.fromTurn(this.currentPart.data.turn);this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get();var t=e.getOpponent();this.didUserPlay(t)&&this.pauseCountDownsFor(t),this.didUserPlay(e)?(aB(n.VERBOSE,"OnlineGameWrapperComponent.onCurrentPartUpdate: changing current player"),this.resumeCountDownFor(e)):this.startCountDownFor(e)}},{key:"resetChronoFor",value:function(e){this.pauseCountDownsFor(e),this.resumeCountDownFor(e)}},{key:"applyEndGame",value:function(){var e=this.currentPart,t=Zee.fromTurn(e.data.turn);this.endGame=!0,[Y5.VICTORY,Y5.HARD_DRAW].some(function(t){return t.value===e.data.result})?this.doNewMoves(this.currentPart):(Z5(!0===[Y5.RESIGN,Y5.TIMEOUT,Y5.HARD_DRAW,Y5.AGREED_DRAW_BY_ZERO,Y5.AGREED_DRAW_BY_ONE].some(function(t){return t.value===e.data.result}),"Unknown type of end game ("+e.data.result+")"),aB(n.VERBOSE,"endGame est true et winner est "+e.getWinner())),this.stopCountdownsFor(t)}},{key:"notifyDraw",value:function(e,t){this.endGame=!0;var n=this.getPlayer();return this.gameService.updateDBBoard(this.currentPartId,n,e,[0,0],t,!0)}},{key:"notifyTimeoutVictory",value:function(e,t,n,r){var i=this;return rB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i.endGame=!0,o=i.currentPart.setWinnerAndLoser(e,r),i.currentPart=o,a.next=5,i.gameService.notifyTimeout(i.currentPartId,t,n,e,r);case 5:case"end":return a.stop()}},a)}))()}},{key:"notifyVictory",value:function(e,t){aB(n.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");var r=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);r===Ere.ONE_WON?this.currentPart=this.currentPart.setWinnerAndLoser(this.players[1].get(),this.players[0].get()):(Z5(r===Ere.ZERO_WON,"impossible to get a victory without winner!"),this.currentPart=this.currentPart.setWinnerAndLoser(this.players[0].get(),this.players[1].get())),this.endGame=!0;var i=this.getPlayer();return this.gameService.updateDBBoard(this.currentPartId,i,e,[0,0],t,!1,this.currentPart.getWinner().get(),this.currentPart.getLoser().get())}},{key:"canAskTakeBack",value:function(){return Z5(this.isPlaying(),"Non playing should not call canAskTakeBack"),!(null==this.currentPart||this.currentPart.data.turn<=this.observerRole||this.currentPart.data.request&&"TakeBackRefused"===this.currentPart.data.request.code&&this.currentPart.data.request.data.player===this.getPlayer().getOpponent().value)&&this.getTakeBackRequester()===Zee.NONE}},{key:"isOpponentWaitingForTakeBackResponse",value:function(){var e=this.getTakeBackRequester();return e!==Zee.NONE&&this.isOpponent(e)}},{key:"getTakeBackRequester",value:function(){if(null==this.currentPart)return Zee.NONE;var e=this.currentPart.data.request;return e&&"TakeBackAsked"===e.code?Yee.getPlayer(e):Zee.NONE}},{key:"canProposeDraw",value:function(){return Z5(this.isPlaying(),"Non playing should not call canProposeDraw"),!(this.endGame||null==this.currentPart||this.currentPart.data.request&&"DrawRefused"===this.currentPart.data.request.code&&Yee.getPlayer(this.currentPart.data.request)===this.getPlayer().getOpponent()||this.isOpponentWaitingForDrawResponse())&&this.getDrawRequester()===Zee.NONE}},{key:"isOpponentWaitingForDrawResponse",value:function(){var e=this.getDrawRequester();return e!==Zee.NONE&&this.isOpponent(e)}},{key:"getDrawRequester",value:function(){if(null==this.currentPart)return Zee.NONE;var e=this.currentPart.data.request;return e&&"DrawProposed"===e.code?Yee.getPlayer(e):Zee.NONE}},{key:"onRequest",value:function(e,t){var r=this;return rB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=(aB(n.VERBOSE,{called:"OnlineGameWrapper.onRequest(",request:e,oldPart:t}),e.code),i.next="TakeBackAsked"===i.t0||"TakeBackRefused"===i.t0?3:"TakeBackAccepted"===i.t0?4:"RematchProposed"===i.t0?6:"RematchAccepted"===i.t0?10:"DrawProposed"===i.t0||"DrawRefused"===i.t0?15:"AddTurnTime"===i.t0?16:"AddGlobalTime"===i.t0?19:22;break;case 3:return i.abrupt("break",25);case 4:return r.takeBackTo(r.currentPart.data.turn),i.abrupt("break",25);case 6:return r.rematchProposed=!0,a=Yee.getPlayer(e).getOpponent(),r.isPlayer(a)&&(aB(n.VERBOSE,"ton adversaire te propose une revanche"),r.opponentProposedRematch=!0),i.abrupt("break",25);case 10:return i.next=12,r.router.navigate(["/nextGameLoading"]);case 12:return i.next=14,r.router.navigate(["/play",Yee.getTypeGame(e),Yee.getPartId(e)]);case 14:case 15:return i.abrupt("break",25);case 16:return 3e4,o=Zee.of(e.data.player),r.addTurnTimeTo(o,3e4),i.abrupt("break",25);case 19:return 3e5,s=Zee.of(e.data.player),r.addGlobalTimeTo(s,3e5),i.abrupt("break",25);case 22:return iB.expectToBe(e.code,"DrawAccepted","Unknown RequestType : "+e.code+" for "+JSON.stringify(e)),i.next=25,r.acceptDraw();case 25:case"end":return i.stop()}},i)}))()}},{key:"takeBackTo",value:function(e){if(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.gameComponent.rules.node.gameState.turn===e)this.switchPlayer();else{this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get();var t=Zee.fromTurn(e);this.resetChronoFor(t)}this.gameComponent.updateBoard()}},{key:"setPlayersDatas",value:function(e){var t=this;aB(n.VERBOSE,{OnlineGameWrapper_setPlayersDatas:e}),this.players=[cB.of(e.data.playerZero),cB.ofNullable(e.data.playerOne)],Z5(null!=e.data.playerOne,"should not setPlayersDatas when players data is not received"),this.currentPlayer=this.players[e.data.turn%2].get();var r=cB.empty();if(this.players[0].equalsValue(this.getPlayerName())?(this.observerRole=Zee.ZERO.value,r=this.players[1]):this.players[1].equalsValue(this.getPlayerName())?(this.observerRole=Zee.ONE.value,r=this.players[0]):this.observerRole=Zee.NONE.value,r.isPresent()){var i=new n6(function(e){t.opponent=e[0].data},function(e){t.opponent=e[0].data},function(e){throw new Error("OnlineGameWrapper: Opponent was deleted, what sorcery is this: "+JSON.stringify(e))});this.opponentSubscription=cB.of(this.userService.observeUserByUsername(r.get(),i))}}},{key:"onLegalUserMove",value:function(e,t){var r=this;return rB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(aB(n.VERBOSE,"dans OnlineGameWrapperComponent.onLegalUserMove"),r.isOpponentWaitingForTakeBackResponse()){i.next=2;break}return i.abrupt("return",r.updateDBBoard(e,r.msToSubstract,t));case 2:r.gameComponent.message("You must answer to take back request");case 3:case"end":return i.stop()}},i)}))()}},{key:"updateDBBoard",value:function(e,t,r){var i=this;return rB(regeneratorRuntime.mark(function a(){var o,s,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(o=i.gameComponent.encoder.encodeMove(e),aB(n.VERBOSE,"OnlineGameWrapperComponent.updateDBBoard("+e.toString()+", "+r+")"),i.gameComponent.rules.choose(e),!(s=i.gameComponent.rules.getGameStatus(i.gameComponent.rules.node)).isEndGame){a.next=5;break}return a.abrupt("return",s===Ere.DRAW?i.notifyDraw(o,r):i.notifyVictory(o,r));case 5:return u=i.getPlayer(),a.abrupt("return",i.gameService.updateDBBoard(i.currentPartId,u,o,t,r));case 7:case"end":return a.stop()}},a)}))()}},{key:"resign",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n,r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getLastIndex(),r=e.getPlayer(),i=e.players[e.observerRole%2].get(),a=e.players[(e.observerRole+1)%2].get(),t.next=3,e.gameService.resign(e.currentPartId,n,r,a,i);case 3:case"end":return t.stop()}},t)}))()}},{key:"getLastIndex",value:function(){return this.currentPart.data.lastUpdate.index}},{key:"reachedOutOfTime",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(aB(n.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+e+")"),i=t.getLastIndex(),a=t.getPlayer(),t.stopCountdownsFor(Zee.of(e)),o=iB.getNonNullable(t.opponent),e!==t.observerRole){r.next=10;break}return s=iB.getNonNullable(o.username),r.next=8,t.notifyTimeoutVictory(s,a,i,t.getPlayerName());case 8:r.next=19;break;case 10:if(!t.endGame){r.next=14;break}aB(!0,"time might be better handled in the future"),r.next=19;break;case 14:if(!t.opponentIsOffline()){r.next=19;break}return u=iB.getNonNullable(o.username),r.next=18,t.notifyTimeoutVictory(t.getPlayerName(),a,e,u);case 18:t.endGame=!0;case 19:case"end":return r.stop()}},r)}))()}},{key:"acceptRematch",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Z5(e.isPlaying(),"Non playing should not call acceptRematch"),n=new K5(e.currentPartId,e.currentPart.data),t.next=4,e.gameService.acceptRematch(n,e.getLastIndex(),e.getPlayer());case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}},t)}))()}},{key:"proposeRematch",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Z5(e.isPlaying(),"Non playing should not call proposeRematch"),t.next=3,e.gameService.proposeRematch(e.currentPartId,e.getLastIndex(),e.getPlayer());case 3:return t.abrupt("return",!0);case 4:case"end":return t.stop()}},t)}))()}},{key:"proposeDraw",value:function(){return this.gameService.proposeDraw(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"acceptDraw",value:function(){return this.gameService.acceptDraw(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"refuseDraw",value:function(){return this.gameService.refuseDraw(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"askTakeBack",value:function(){return this.gameService.askTakeBack(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"acceptTakeBack",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getPlayer(),t.next=3,e.gameService.acceptTakeBack(e.currentPartId,e.currentPart,n,e.msToSubstract);case 3:e.msToSubstract=[0,0];case 4:case"end":return t.stop()}},t)}))()}},{key:"refuseTakeBack",value:function(){return this.gameService.refuseTakeBack(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"startCountDownFor",value:function(e){aB(n.VERBOSE,"dans OnlineGameWrapperComponent.startCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),this.hasUserPlayed[e.value]=!0,e===Zee.ZERO?(this.chronoZeroGlobal.start(),this.chronoZeroTurn.start()):(this.chronoOneGlobal.start(),this.chronoOneTurn.start())}},{key:"resumeCountDownFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];aB(n.VERBOSE,"dans OnlineGameWrapperComponent.resumeCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===Zee.ZERO?(this.chronoZeroGlobal.changeDuration(iB.getNonNullable(this.currentPart.data.remainingMsForZero)),this.chronoZeroGlobal.resume(),t=this.chronoZeroTurn):(this.chronoOneGlobal.changeDuration(iB.getNonNullable(this.currentPart.data.remainingMsForOne)),this.chronoOneGlobal.resume(),t=this.chronoOneTurn),r?(t.setDuration(1e3*this.joiner.maximalMoveDuration),t.start()):t.resume()}},{key:"pauseCountDownsFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];aB(n.VERBOSE,"dans OnlineGameWrapperComponent.pauseCountDownFor("+e.value+") (turn "+this.currentPart.data.turn+")"),e===Zee.ZERO?(this.chronoZeroGlobal.pause(),t=this.chronoZeroTurn):(this.chronoOneGlobal.pause(),t=this.chronoOneTurn),r?t.stop():t.pause()}},{key:"stopCountdownsFor",value:function(e){aB(n.VERBOSE,"cdc::stopCountDownsFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===Zee.ZERO?(this.chronoZeroGlobal.isStarted()&&this.chronoZeroGlobal.stop(),this.chronoZeroTurn.isStarted()&&this.chronoZeroTurn.stop()):(this.chronoOneGlobal.isStarted()&&this.chronoOneGlobal.stop(),this.chronoOneTurn.isStarted()&&this.chronoOneTurn.stop())}},{key:"getPlayerNameClass",value:function(e){return this.opponentIsOffline()?"has-text-grey-light":0===e?"has-text-white":"has-text-black"}},{key:"opponentIsOffline",value:function(){return null!=this.opponent&&"offline"===this.opponent.state}},{key:"canResign",value:function(){return Z5(this.isPlaying(),"Non playing should not call canResign"),!(!0===this.endGame||null==this.opponent)}},{key:"addGlobalTime",value:function(){var e=this.getPlayer(),t=this.getLastIndex();return this.gameService.addGlobalTime(this.currentPartId,t,this.currentPart.data,e)}},{key:"addTurnTime",value:function(){var e=this.getPlayer();return this.gameService.addTurnTime(e,this.getLastIndex(),this.currentPartId)}},{key:"addTurnTimeTo",value:function(e,t){var n=Zee.fromTurn(this.currentPart.getTurn());this.pauseCountDownsFor(n,!1),e===Zee.ZERO?this.chronoZeroTurn.changeDuration(this.chronoZeroTurn.remainingMs+t):this.chronoOneTurn.changeDuration(this.chronoOneTurn.remainingMs+t),this.resumeCountDownFor(n,!1)}},{key:"addGlobalTimeTo",value:function(e,t){e===Zee.ZERO?this.chronoZeroGlobal.changeDuration(this.chronoZeroGlobal.remainingMs+t):this.chronoOneGlobal.changeDuration(this.chronoOneGlobal.remainingMs+t)}},{key:"ngOnDestroy",value:function(){null!=this.routerEventsSub&&null!=this.routerEventsSub.unsubscribe&&this.routerEventsSub.unsubscribe(),null!=this.userSub&&null!=this.userSub.unsubscribe&&this.userSub.unsubscribe(),!0===this.gameStarted&&(this.opponentSubscription.isPresent()&&this.opponentSubscription.get()(),this.gameService.stopObserving())}}]),n}(gpe);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ub(eS),ub(SN),ub(WM),ub(a6),ub(zee),ub(ete))},e.\u0275cmp=ty({type:e,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){var n;(1&e&&(PP(Gpe,5),PP(qpe,5),PP($pe,5),PP(Wpe,5),PP(jpe,5),PP(Zpe,5)),2&e)&&(SP(n=OP())&&(t.partCreation=n.first),SP(n=OP())&&(t.chatComponent=n.first),SP(n=OP())&&(t.chronoZeroGlobal=n.first),SP(n=OP())&&(t.chronoOneGlobal=n.first),SP(n=OP())&&(t.chronoZeroTurn=n.first),SP(n=OP())&&(t.chronoOneTurn=n.first))},features:[HC],decls:5,vars:4,consts:function(){return[["id","partCreation",3,"partId","userName","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","userName","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],$localize(Uf||(Uf=Nv(["vs."]))),["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],[4,"ngIf"],["class","block","id","winnerIndicator",4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","proposeRematchButton","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["class","button is-fullwidth is-warning","id","acceptRematchButton",3,"click",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(zf||(zf=Nv(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],$localize(Hf||(Hf=Nv(["It is your turn."]))),$localize(Gf||(Gf=Nv(["It is ",":INTERPOLATION:'s turn."])),"\ufffd0\ufffd"),["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],$localize(qf||(qf=Nv(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],$localize($f||($f=Nv(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["class","button is-fullwidth mb-1","id","resignButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","proposeDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","refuseDrawButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","passButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptTakeBackButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","color","warn","id","refuseTakeBackButton",3,"click",4,"ngIf"],["class","button is-fullwidth","id","askTakeBackButton",3,"click",4,"ngIf"],["id","resignButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Wf||(Wf=Nv(["Resign"]))),["id","proposeDrawButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(jf||(jf=Nv(["Propose a draw"]))),["id","acceptDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Zf||(Zf=Nv(["Accept draw"]))),["id","refuseDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Yf||(Yf=Nv(["Reject draw"]))),["id","passButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Kf||(Kf=Nv(["Pass a turn"]))),["id","acceptTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Jf||(Jf=Nv(["Accept take back"]))),["color","warn","id","refuseTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Qf||(Qf=Nv(["Reject take back"]))),["id","askTakeBackButton",1,"button","is-fullwidth",3,"click"],$localize(Xf||(Xf=Nv(["Ask to take back one move"]))),["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],$localize(ed||(ed=Nv(["Draw"]))),["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],$localize(td||(td=Nv(["You agreed to draw."]))),["id","yourOpponentAgreedToDrawIndicator",1,"title"],$localize(nd||(nd=Nv(["Your draw proposal has been accepted."]))),["id","playersAgreedToDraw",1,"title"],$localize(rd||(rd=Nv(["Players agreed to draw."]))),["class","title","id","youWonIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],$localize(id||(id=Nv(["You won."]))),[1,"title"],$localize(ad||(ad=Nv(["You lost."]))),$localize(od||(od=Nv(["",":INTERPOLATION: won."])),"\ufffd0\ufffd"),$localize(sd||(sd=Nv(["",":INTERPOLATION: has reached their time limit. You won."])),"\ufffd0\ufffd"),$localize(ud||(ud=Nv(["You reached your time limit."]))),$localize(cd||(cd=Nv(["",":INTERPOLATION: has reached their time limit."])),"\ufffd0\ufffd"),["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],$localize(ld||(ld=Nv(["You resigned."]))),$localize(hd||(hd=Nv(["",":INTERPOLATION: has resigned."])),"\ufffd0\ufffd"),["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],$localize(fd||(fd=Nv(["Go back to the game list"]))),["id","proposeRematchButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(dd||(dd=Nv(["Propose to play again"]))),["id","acceptRematchButton",1,"button","is-fullwidth","is-warning",3,"click"],$localize(vd||(vd=Nv(["Accept to play again"])))]},template:function(e,t){1&e&&(ob(0,Ype,2,2,"app-part-creation",0),ob(1,Nge,29,27,"div",1),hb(2,"div",2),hb(3,"div",3),db(4,"app-chat",4),fb(),fb()),2&e&&(cb("ngIf",!1===t.gameStarted),Ow(1),cb("ngIf",t.gameStarted),Ow(3),cb("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},directives:[DT,npe,Upe,Hpe,AT,vpe,ZM],encapsulation:2}),e}();function Lge(e,t){if(1&e&&(hb(0,"option",25),Nb(1),fb()),2&e){var n=t.$implicit;cb("value",n.name),Ow(1),Mb(n.name)}}function Fge(e,t){if(1&e&&(hb(0,"option",25),zE(1,29),fb()),2&e){var n=t.$implicit;cb("value",n),Ow(1),HE(n),GE(1)}}var Bge=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function Vge(e,t){if(1&e){var n=gb();hb(0,"select",26),kb("ngModelChange",function(e){return Wy(n),Cb(2).aiDepths[0]=e})("change",function(){return Wy(n),Cb(2).updatePlayer(0)}),hb(1,"option",27),zE(2,28),fb(),ob(3,Fge,2,2,"option",16),fb()}2&e&&(cb("ngModel",Cb(2).aiDepths[0]),Ow(3),cb("ngForOf",tP(2,Bge)))}function Uge(e,t){if(1&e&&(hb(0,"p",30),zE(1,31),fb()),2&e){var n=Cb(2);Ow(1),HE(n.gameComponent.scores.get()[0]),GE(1)}}function zge(e,t){if(1&e&&(hb(0,"option",25),Nb(1),fb()),2&e){var n=t.$implicit;cb("value",n.name),Ow(1),Mb(n.name)}}function Hge(e,t){if(1&e&&(hb(0,"option",25),zE(1,34),fb()),2&e){var n=t.$implicit;cb("value",n),Ow(1),HE(n),GE(1)}}function Gge(e,t){if(1&e){var n=gb();hb(0,"select",32),kb("ngModelChange",function(e){return Wy(n),Cb(2).aiDepths[1]=e})("change",function(){return Wy(n),Cb(2).updatePlayer(1)}),hb(1,"option",27),zE(2,33),fb(),ob(3,Hge,2,2,"option",16),fb()}2&e&&(cb("ngModel",Cb(2).aiDepths[1]),Ow(3),cb("ngForOf",tP(2,Bge)))}function qge(e,t){if(1&e&&(hb(0,"p",35),zE(1,36),fb()),2&e){var n=Cb(2);Ow(1),HE(n.gameComponent.scores.get()[1]),GE(1)}}function $ge(e,t){if(1&e&&(hb(0,"h4"),zE(1,40),fb()),2&e){var n=Cb(3);Ow(1),HE(n.winner.get()),GE(1)}}function Wge(e,t){1&e&&(hb(0,"h4",41),zE(1,42),fb())}function jge(e,t){if(1&e&&(hb(0,"div",37),ob(1,$ge,2,1,"h4",38),ob(2,Wge,2,0,"h4",39),fb()),2&e){var n=Cb(2);Ow(1),cb("ngIf",n.winner.isPresent()),Ow(1),cb("ngIf",n.winner.isAbsent())}}function Zge(e,t){if(1&e){var n=gb();hb(0,"div",6),hb(1,"div",7),hb(2,"p",8),zE(3,9),fb(),fb(),hb(4,"div",10),hb(5,"div",11),hb(6,"div",12),hb(7,"select",13),kb("change",function(){return Wy(n),Cb().updatePlayer(0)})("ngModelChange",function(e){return Wy(n),Cb().playerSelection[0]=e}),hb(8,"option",14),zE(9,15),fb(),ob(10,Lge,2,2,"option",16),fb(),fb(),hb(11,"div",12),ob(12,Vge,4,3,"select",17),fb(),ob(13,Uge,2,1,"p",18),fb(),hb(14,"div",19),hb(15,"div",12),hb(16,"select",20),kb("change",function(){return Wy(n),Cb().updatePlayer(1)})("ngModelChange",function(e){return Wy(n),Cb().playerSelection[1]=e}),hb(17,"option",14),zE(18,21),fb(),ob(19,zge,2,2,"option",16),fb(),fb(),hb(20,"div",12),ob(21,Gge,4,3,"select",22),fb(),ob(22,qge,2,1,"p",23),fb(),fb(),ob(23,jge,3,2,"div",24),fb()}if(2&e){var r=Cb();Ow(3),HE(r.gameComponent.rules.node.gameState.turn+1),GE(3),Ow(4),cb("ngModel",r.playerSelection[0]),Ow(3),cb("ngForOf",r.gameComponent.availableMinimaxes),Ow(2),cb("ngIf",!1===r.players[0].equalsValue("human")),Ow(1),cb("ngIf",r.gameComponent.scores.isPresent()),Ow(3),cb("ngModel",r.playerSelection[1]),Ow(3),cb("ngForOf",r.gameComponent.availableMinimaxes),Ow(2),cb("ngIf",!1===r.players[1].equalsValue("human")),Ow(1),cb("ngIf",r.gameComponent.scores.isPresent()),Ow(1),cb("ngIf",r.endGame)}}function Yge(e,t){if(1&e&&(vb(0),Nb(1),db(2,"br"),pb()),2&e){var n=t.$implicit,r=Cb(3);Ow(1),Db(" ",n.name+": "+n.getBoardValue(r.gameComponent.rules.node)," ")}}function Kge(e,t){if(1&e&&(vb(0),ob(1,Yge,3,1,"ng-container",48),Nb(2),db(3,"br"),Nb(4),db(5,"br"),pb()),2&e){var n=Cb(2);Ow(1),cb("ngForOf",n.gameComponent.availableMinimaxes),Ow(1),Db(" Created ",n.getCreatedNodes()," nodes."),Ow(2),Db(" Minimax time: ",n.getMinimaxTime(),"ms.")}}function Jge(e,t){if(1&e){var n=gb();hb(0,"button",49),kb("click",function(){return Wy(n),Cb(2).gameComponent.pass()}),zE(1,50),fb()}}function Qge(e,t){if(1&e){var n=gb();hb(0,"button",51),kb("click",function(){return Wy(n),Cb(2).takeBack()}),zE(1,52),fb()}}function Xge(e,t){if(1&e){var n=gb();hb(0,"div",43),ob(1,Kge,6,3,"ng-container",38),ob(2,Jge,2,0,"button",44),ob(3,Qge,2,0,"button",45),hb(4,"button",46),kb("click",function(){return Wy(n),Cb().restartGame()}),zE(5,47),fb(),fb()}if(2&e){var r=Cb();Ow(1),cb("ngIf",r.gameComponent.rules.node.move),Ow(1),cb("ngIf",!1===r.endGame&&r.gameComponent.canPass),Ow(1),cb("ngIf",r.canTakeBack())}}var eye=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o){var s;return np(this,n),(s=t.call(this,e,r,i)).cdr=a,s.messageDisplayer=o,s.aiDepths=["0","0"],s.playerSelection=["human","human"],s.winner=cB.empty(),s.botTimeOut=1e3,s.players=[cB.of(s.playerSelection[0]),cB.of(s.playerSelection[1])],aB(n.VERBOSE,"LocalGameWrapper.constructor"),s}return ip(n,[{key:"getCreatedNodes",value:function(){return Cre.createdNodes}},{key:"getMinimaxTime",value:function(){return Cre.minimaxTime}},{key:"ngAfterViewInit",value:function(){var e=this;setTimeout(function(){e.afterGameIncluderViewInit(),e.restartGame(),e.cdr.detectChanges()},1)}},{key:"updatePlayer",value:function(e){this.players[e]=cB.of(this.playerSelection[e]),this.proposeAIToPlay()}},{key:"onLegalUserMove",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:aB(n.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),t.gameComponent.rules.choose(e),t.updateBoard(),t.proposeAIToPlay();case 1:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.gameComponent.updateBoard();var e=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);!0===e.isEndGame&&(this.endGame=!0,e.winner!==Zee.NONE&&(this.winner=cB.of($localize(pd||(pd=Nv(["Player ",""])),e.winner.value+1))))}},{key:"proposeAIToPlay",value:function(){var e=this,t=this.getPlayingAI();t.isPresent()&&setTimeout(rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.doAIMove(t.get());case 2:case"end":return n.stop()}},n)})),this.botTimeOut)}},{key:"getPlayingAI",value:function(){var e=this;if(this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node).isEndGame)return cB.empty();var t=this.gameComponent.rules.node.gameState.turn%2;return"0"===this.aiDepths[t]?cB.empty():cB.ofNullable(this.gameComponent.availableMinimaxes.find(function(n){return e.players[t].equalsValue(n.name)}))}},{key:"doAIMove",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return Z5((r=t.gameComponent.rules).getGameStatus(r.node)===Ere.ONGOING,"IA should not try to play when game is over!"),i=Number.parseInt(t.aiDepths[r.node.gameState.turn%2%2]),a=r.node.findBestMove(i,e,!0),n.abrupt("return",r.choose(a)?(t.updateBoard(),t.cdr.detectChanges(),t.proposeAIToPlay(),$5.SUCCESS):(t.messageDisplayer.criticalMessage($localize(gd||(gd=Nv(["The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!"])))),j5.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:a.toString()})));case 4:case"end":return n.stop()}},n)}))()}},{key:"canTakeBack",value:function(){return this.gameComponent.rules.node.gameState.turn>0}},{key:"takeBack",value:function(){this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.isAITurn()&&(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get()),this.gameComponent.updateBoard()}},{key:"isAITurn",value:function(){return this.getPlayingAI().isPresent()}},{key:"restartGame",value:function(){var e=this.gameComponent.rules.stateType.getInitialState();this.gameComponent.rules.node=new bre(e),this.gameComponent.updateBoard(),this.endGame=!1,this.winner=cB.empty(),this.proposeAIToPlay()}},{key:"getPlayerName",value:function(){return"human"}}]),n}(gpe);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ub(eS),ub(SN),ub(zee),ub(xS),ub(Xne))},e.\u0275cmp=ty({type:e,selectors:[["app-local-game-wrapper"]],features:[HC],decls:7,vars:3,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(yd||(yd=Nv(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],$localize(md||(md=Nv(["Human"]))),[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],$localize(kd||(kd=Nv(["Human"]))),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["class","block","id","gameResult",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],$localize(_d||(_d=Nv(["Pick the level"]))),$localize(wd||(wd=Nv(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreOne",1,"block"],$localize(Cd||(Cd=Nv(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],$localize(bd||(bd=Nv(["Pick the level"]))),$localize(Ed||(Ed=Nv(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreZero",1,"block"],$localize(Sd||(Sd=Nv(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","gameResult",1,"block"],[4,"ngIf"],["id","draw",4,"ngIf"],$localize(Pd||(Pd=Nv(["",":INTERPOLATION: won"])),"\ufffd0\ufffd"),["id","draw"],$localize(Od||(Od=Nv(["Draw"]))),[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],$localize(Td||(Td=Nv(["Start a new game"]))),[4,"ngFor","ngForOf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],$localize(Id||(Id=Nv(["Pass a turn"]))),["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],$localize(xd||(xd=Nv(["Take back move"])))]},template:function(e,t){1&e&&(hb(0,"div",0),hb(1,"div",1),ob(2,Zge,24,10,"div",2),ob(3,Xge,6,3,"div",3),fb(),hb(4,"div",4),hb(5,"div",5),db(6,"app-game-includer"),fb(),fb(),fb()),2&e&&(Ow(2),cb("ngIf",t.gameComponent),Ow(1),cb("ngIf",t.gameComponent),Ow(1),cb("ngClass",t.getBoardHighlight()))},directives:[DT,AT,vpe,rA,dx,$x,iA,uA,NT],encapsulation:2,changeDetection:0}),e}(),tye=function(){var e=ip(function e(){np(this,e)});return e.STEP_FINISHED=function(){return $localize(Ad||(Ad=Nv(["Step finished!"])))},e.INFORMATIONAL_STEP=function(){return $localize(Rd||(Rd=Nv(["This step is not expecting any move from your part."])))},e}();function nye(e,t){if(1&e&&(hb(0,"div",20),hb(1,"div",21),zE(2,22),fb(),hb(3,"div",23),Nb(4),fb(),fb()),2&e){var n=Cb();Ow(4),Mb(n.currentReason.get())}}function rye(e,t){if(1&e){var n=gb();hb(0,"button",24),kb("click",function(){return Wy(n),Cb().retry()}),zE(1,25),fb()}}function iye(e,t){1&e&&(vb(0),zE(1,30),pb())}function aye(e,t){1&e&&(vb(0),zE(1,31),pb())}function oye(e,t){if(1&e&&ob(0,aye,2,0,"ng-container",27),2&e){Cb();var n=sb(5),r=Cb();cb("ngIf",r.stepFinished&&r.stepFinished[r.stepIndex])("ngIfElse",n)}}function sye(e,t){1&e&&(vb(0),zE(1,32),pb())}function uye(e,t){if(1&e){var n=gb();hb(0,"button",26),kb("click",function(){return Wy(n),Cb().next()}),ob(1,iye,2,0,"ng-container",27),ob(2,oye,1,2,"ng-template",null,28,IP),ob(4,sye,2,0,"ng-template",null,29,IP),fb()}if(2&e){var r=sb(3),i=Cb();Ow(1),cb("ngIf",i.steps[i.stepIndex]&&i.steps[i.stepIndex].isInformation())("ngIfElse",r)}}function cye(e,t){if(1&e){var n=gb();hb(0,"button",33),kb("click",function(){return Wy(n),Cb().start()}),zE(1,34),fb()}}function lye(e,t){if(1&e){var n=gb();hb(0,"button",35),kb("click",function(){return Wy(n),Cb().playLocally()}),zE(1,36),fb()}}function hye(e,t){if(1&e){var n=gb();hb(0,"button",37),kb("click",function(){return Wy(n),Cb().createGame()}),zE(1,38),fb()}}function fye(e,t){if(1&e){var n=gb();hb(0,"button",39),kb("click",function(){return Wy(n),Cb().showSolution()}),zE(1,40),fb()}}function dye(e,t){if(1&e&&(vb(0),hb(1,"option",42),Nb(2),fb(),pb()),2&e){var n=Cb(),r=n.index,i=n.$implicit;Ow(1),bb("id","step_",r,""),cb("value",r),Ow(1),Mb(i.title)}}function vye(e,t){1&e&&(vb(0),Nb(1,"v "),pb())}function pye(e,t){1&e&&Nb(0,"x ")}function gye(e,t){if(1&e&&(hb(0,"option",43),ob(1,vye,2,0,"ng-container",27),ob(2,pye,1,0,"ng-template",null,44,IP),hb(4,"span",45),Nb(5),fb(),fb()),2&e){var n=sb(3),r=Cb(),i=r.index,a=r.$implicit,o=Cb();cb("value",i),Ow(1),cb("ngIf",o.stepFinished[i])("ngIfElse",n),Ow(3),bb("id","step_",i,""),Ow(1),Mb(a.title)}}function yye(e,t){if(1&e&&(vb(0),ob(1,dye,3,3,"ng-container",27),ob(2,gye,6,5,"ng-template",null,41,IP),pb()),2&e){var n=t.index,r=sb(3),i=Cb();Ow(1),cb("ngIf",n===i.stepIndex)("ngIfElse",r)}}var mye=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r,i,a,o){var s;return np(this,n),(s=t.call(this,e,r,a)).router=i,s.cdr=o,s.COMPLETED_TUTORIAL_MESSAGE=$localize(Nd||(Nd=Nv(["Congratulations, you completed the tutorial."]))),s.steps=[],s.successfulSteps=0,s.stepIndex=-1,s.currentMessage="",s.currentReason=cB.empty(),s.moveAttemptMade=!1,s.stepFinished=[],s.tutorialOver=!1,aB(n.VERBOSE,"TutorialGameWrapperComponent.constructor"),s}return ip(n,[{key:"getNumberOfSteps",value:function(){return this.steps.length}},{key:"getCurrentStepTitle",value:function(){return this.steps.length>0?this.steps[this.stepIndex].title:""}},{key:"ngAfterViewInit",value:function(){aB(n.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),this.afterGameIncluderViewInit(),this.start()}},{key:"start",value:function(){this.startTutorial(this.gameComponent.tutorial)}},{key:"startTutorial",value:function(e){aB(n.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:e}}),this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}},{key:"getCompletionArray",value:function(){return this.steps.map(function(){return!1})}},{key:"changeStep",value:function(e){this.showStep(Number.parseInt(e.target.value,10))}},{key:"showStep",value:function(e){aB(n.VERBOSE,"tutorialGameWrapperComponent.showStep("+e+")"),this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;var t=this.steps[this.stepIndex];this.currentMessage=t.instruction,this.currentReason=cB.empty(),this.gameComponent.rules.node=new bre(t.state,cB.empty(),t.previousMove),this.gameComponent.updateBoard(),this.cdr.detectChanges()}},{key:"onLegalUserMove",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:aB(n.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:e}}),i=t.steps[t.stepIndex],Z5(t.gameComponent.rules.choose(e),"It should be impossible to call onLegalUserMove with an illegal move"),aB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),t.gameComponent.updateBoard(),t.moveAttemptMade=!0,i.isPredicate()?(a=t.gameComponent.rules.node.gameState,(o=iB.getNonNullable(i.predicate)(e,a)).isSuccess()?t.showStepSuccess(i.getSuccessMessage()):t.currentReason=cB.of(o.getReason())):i.isAnyMove()?(aB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(i.getSuccessMessage())):(Z5(i.isMove(),"cannot reach here with a click step"),(s=i).acceptedMoves.some(function(t){return t.equals(e)})?(aB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(s.getSuccessMessage())):(aB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),t.currentReason=cB.of(s.getFailureMessage()))),t.cdr.detectChanges();case 4:case"end":return r.stop()}},r)}))()}},{key:"retry",value:function(){aB(n.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}},{key:"onUserClick",value:function(e){var t=this;if(aB(n.VERBOSE,"tutorialGameWrapper.onUserClick("+e+")"),this.currentReason=cB.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return $5.failure(tye.STEP_FINISHED());var r=this.steps[this.stepIndex];return r.isClick()?(this.gameComponent.updateBoard(),iB.getNonNullable(r.acceptedClicks).some(function(t){return t===e})?this.showStepSuccess(r.getSuccessMessage()):this.currentMessage=r.getFailureMessage(),$5.SUCCESS):r.isMove()||r.isPredicate()||r.isAnyMove()?(setTimeout(function(){t.cdr.detectChanges()},10),$5.SUCCESS):$5.failure(tye.INFORMATIONAL_STEP())}},{key:"onCancelMove",value:function(e){aB(n.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+e+")"),void 0!==e&&(this.currentReason=cB.of(e)),this.cdr.detectChanges()}},{key:"showStepSuccess",value:function(e){aB(n.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}},{key:"updateSuccessCount",value:function(){var e,t=0,n=Xv(this.stepFinished);try{for(n.s();!(e=n.n()).done;){e.value&&t++}}catch(r){n.e(r)}finally{n.f()}this.successfulSteps=t}},{key:"next",value:function(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{for(var e=(this.stepIndex+1)%this.steps.length;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}},{key:"showSolution",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:aB(n.VERBOSE,"tutorialGameWrapper.showSolution()"),Z5((r=e.steps[e.stepIndex]).hasSolution(),"showSolution called on a step with no solution, this should not be reachable"),a=(i=r).getSolution(),e.showStep(e.stepIndex),e.gameComponent.rules.choose(a),e.gameComponent.updateBoard(),e.moveAttemptMade=!0,e.currentMessage=i.getSuccessMessage(),e.cdr.detectChanges();case 5:case"end":return t.stop()}},t)}))()}},{key:"playLocally",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=iB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/local",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"createGame",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=iB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/play",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"getPlayerName",value:function(){return""}}]),n}(gpe);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ub(eS),ub(SN),ub(WM),ub(zee),ub(xS))},e.\u0275cmp=ty({type:e,selectors:[["app-tutorial-game-wrapper"]],features:[HC],decls:22,vars:15,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(Md||(Md=Nv(["Failure"]))),["id","currentReason",1,"message-body"],["id","retryButton",1,"button","mr-3",3,"click"],$localize(Dd||(Dd=Nv(["Try again"]))),["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],$localize(Ld||(Ld=Nv(["Ok"]))),$localize(Fd||(Fd=Nv(["Continue"]))),$localize(Bd||(Bd=Nv(["Skip"]))),["id","restartButton",1,"button",3,"click"],$localize(Vd||(Vd=Nv(["Try again"]))),["id","playLocallyButton",1,"button",3,"click"],$localize(Ud||(Ud=Nv(["Play locally"]))),["id","playOnlineButton",1,"button",3,"click"],$localize(zd||(zd=Nv(["Create an online game"]))),["id","showSolutionButton",1,"button",3,"click"],$localize(Hd||(Hd=Nv(["See solution"]))),["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(hb(0,"div",0),hb(1,"div",1),hb(2,"div",2),db(3,"progress",3),hb(4,"div",4),hb(5,"p",5),Nb(6),fb(),db(7,"p",6),fb(),ob(8,nye,5,1,"div",7),hb(9,"div",8),ob(10,rye,2,0,"button",9),ob(11,uye,6,2,"button",10),ob(12,cye,2,0,"button",11),ob(13,lye,2,0,"button",12),ob(14,hye,2,0,"button",13),ob(15,fye,2,0,"button",14),hb(16,"div",15),hb(17,"select",16),kb("change",function(e){return t.changeStep(e)}),ob(18,yye,4,2,"ng-container",17),fb(),fb(),fb(),fb(),fb(),hb(19,"div",18),hb(20,"div",19),db(21,"app-game-includer"),fb(),fb(),fb()),2&e&&(Ow(3),nb("value",t.successfulSteps)("max",t.getNumberOfSteps()),Ow(3),Fb("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),Ow(1),cb("innerHTML",t.currentMessage,k_),Ow(1),cb("ngIf",t.currentReason.isPresent()),Ow(2),cb("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),Ow(1),cb("ngIf",!1===t.tutorialOver),Ow(1),cb("ngIf",t.tutorialOver),Ow(1),cb("ngIf",t.tutorialOver),Ow(1),cb("ngIf",t.tutorialOver),Ow(1),cb("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),Ow(3),cb("ngForOf",t.steps),Ow(1),cb("ngClass",t.getBoardHighlight()))},directives:[DT,NT,AT,vpe,iA,uA],encapsulation:2,changeDetection:0}),e}();function kye(e,t){if(1&e&&(hb(0,"div",35),hb(1,"div",36),zE(2,37),fb(),hb(3,"div",38),Nb(4),fb(),fb()),2&e){var n=Cb();Ow(4),Mb(n.errorMessage)}}var _ye=function(){return["/login"]},wye=function(){var e=function(){function e(t,n){np(this,e),this.authService=t,this.router=n,this.faEye=ste,this.registrationForm=new Bx({email:new Fx,username:new Fx,password:new Fx})}return ip(e,[{key:"registerWithEmail",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n,r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.registrationForm.value.username,r=e.registrationForm.value.email,i=e.registrationForm.value.password,null!=n&&null!=r&&null!=i){t.next=5;break}e.errorMessage=$localize(Gd||(Gd=Nv(["There are missing fields in the registration form, please check that you filled in all fields."]))),t.next=21;break;case 5:return t.next=7,e.authService.doRegister(n,r,i);case 7:if(!(a=t.sent).isSuccess()){t.next=20;break}return t.next=11,e.authService.sendEmailVerification();case 11:if(!(o=t.sent).isSuccess()){t.next=17;break}return t.next=15,e.router.navigate(["/verify-account"]);case 15:t.next=18;break;case 17:e.errorMessage=o.getReason();case 18:t.next=21;break;case 20:e.errorMessage=a.getReason();case 21:case"end":return t.stop()}},t)}))()}},{key:"registerWithGoogle",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.doGoogleLogin();case 2:if(!(n=t.sent).isSuccess()){t.next=8;break}return t.next=6,e.router.navigate(["/verify-account"]);case 6:t.next=9;break;case 8:e.errorMessage=n.getReason();case 9:case"end":return t.stop()}},t)}))()}},{key:"getPasswordHelpClass",value:function(){var e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}},{key:"canRegister",value:function(){var e=this.registrationForm.value.password||"";return!(""===(this.registrationForm.value.email||"")||""===(this.registrationForm.value.username||"")||""===e||e.length<6)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(zee),ub(WM))},e.\u0275cmp=ty({type:e,selectors:[["app-register"]],decls:56,vars:7,consts:function(){return[[1,"box"],[1,"title"],$localize(qd||(qd=Nv(["Registering"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize($d||($d=Nv(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",$localize(Wd||(Wd=Nv(["Email"]))),"type","email","autofocus","","required","",1,"input"],[1,"help"],$localize(jd||(jd=Nv(["A confirmation email will be sent to validate your account."]))),["for","username",1,"label"],$localize(Zd||(Zd=Nv(["Username"]))),["id","username","formControlName","username","name","username","placeholder",$localize(Yd||(Yd=Nv(["Username"]))),"type","text","required","",1,"input"],["for","password",1,"label"],$localize(Kd||(Kd=Nv(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",$localize(Jd||(Jd=Nv(["Password"]))),"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],$localize(Qd||(Qd=Nv(["The password should be at least 6 characters long"]))),["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(Xd||(Xd=Nv(["Register"]))),[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(ev||(ev=Nv(["Register with Google"]))),[1,"help","level-right"],$localize(tv||(tv=Nv(["Have an account?"]))),[3,"routerLink"],$localize(nv||(nv=Nv(["Log in"]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(rv||(rv=Nv(["Registration error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(hb(0,"div",0),hb(1,"p",1),zE(2,2),fb(),hb(3,"form",3),hb(4,"div",4),hb(5,"div",5),hb(6,"label",6),zE(7,7),fb(),fb(),hb(8,"div",8),hb(9,"div",9),hb(10,"div",10),db(11,"input",11),hb(12,"p",12),zE(13,13),fb(),fb(),fb(),fb(),fb(),hb(14,"div",4),hb(15,"div",5),hb(16,"label",14),zE(17,15),fb(),fb(),hb(18,"div",8),hb(19,"div",9),hb(20,"div",10),db(21,"input",16),fb(),fb(),fb(),fb(),hb(22,"div",4),hb(23,"div",5),hb(24,"label",17),zE(25,18),fb(),fb(),hb(26,"div",8),hb(27,"div",9),hb(28,"div",19),db(29,"input",20),hb(30,"span",21),db(31,"fa-icon",22),fb(),hb(32,"p",23),zE(33,24),fb(),fb(),fb(),fb(),fb(),hb(34,"div",4),db(35,"div",5),hb(36,"div",8),hb(37,"div",9),hb(38,"div",10),hb(39,"button",25),kb("click",function(){return t.registerWithEmail()}),zE(40,26),fb(),fb(),fb(),fb(),fb(),hb(41,"div",4),db(42,"div",5),hb(43,"div",27),ob(44,kye,5,1,"div",28),fb(),fb(),hb(45,"div",4),db(46,"div",5),hb(47,"div",8),hb(48,"button",29),kb("click",function(){return t.registerWithGoogle()}),zE(49,30),fb(),fb(),fb(),hb(50,"p",31),vb(51),zE(52,32),pb(),Nb(53,"\xa0 "),hb(54,"a",33),zE(55,34),fb(),fb(),fb(),fb()),2&e&&(Ow(3),cb("formGroup",t.registrationForm),Ow(28),cb("icon",t.faEye),Ow(1),cb("ngClass",t.getPasswordHelpClass()),Ow(7),cb("disabled",!t.canRegister()),Ow(5),cb("ngIf",t.errorMessage),Ow(10),cb("routerLink",tP(6,_ye)))},directives:[Wx,vx,Qx,FI,dx,eA,Bve,lA,Rne,Vve,AT,DT,YM],encapsulation:2}),e}(),Cye=function(){var e=function(){function e(t){np(this,e),this.router=t}return ip(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"playLocally",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["local/"+e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(WM))},e.\u0275cmp=ty({type:e,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playLocally",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(iv||(iv=Nv(["Play offline"])))]},template:function(e,t){1&e&&(hb(0,"app-pick-game",0),kb("pickGame",function(e){return t.pickGame(e)}),fb(),hb(1,"button",1),kb("click",function(){return t.playLocally()}),zE(2,2),fb()),2&e&&(Ow(1),cb("disabled",!t.selectedGame))},directives:[Nve],encapsulation:2}),e}(),bye=function(){var e=function(){function e(t){np(this,e),this.router=t}return ip(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"launchTutorial",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/tutorial/",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(WM))},e.\u0275cmp=ty({type:e,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(av||(av=Nv(["Learn the rules"])))]},template:function(e,t){1&e&&(hb(0,"app-pick-game",0),kb("pickGame",function(e){return t.pickGame(e)}),fb(),hb(1,"button",1),kb("click",function(){return t.launchTutorial()}),zE(2,2),fb()),2&e&&(Ow(1),cb("disabled",!t.selectedGame))},directives:[Nve],encapsulation:2}),e}(),Eye=function(){var e=ip(function e(){np(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ty({type:e,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){return[$localize(ov||(ov=Nv(["The replay game is loading, please wait, it should not take long."])))]},template:function(e,t){1&e&&(hb(0,"p"),zE(1,0),fb())},encapsulation:2}),e}(),Sye={production:!0,test:!1,root:"/",firebaseConfig:{apiKey:"AIzaSyAt5QHXLnm2Uf9X7VN6XPPiSaipoh3oRHo",authDomain:"firestore-c9d47.firebaseapp.com",databaseURL:"https://firestore-c9d47.firebaseio.com",projectId:"firestore-c9d47",storageBucket:"firestore-c9d47.appspot.com",messagingSenderId:"936588361631"},useEmulators:!1},Pye=function(){var e=function(){function e(t){np(this,e),this.authService=t}return ip(e,[{key:"canActivate",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t){var n;e.userSub=e.authService.getUserObs().subscribe((n=rB(regeneratorRuntime.mark(function n(r){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.evaluateUserPermission(r).then(t);case 2:case"end":return n.stop()}},n)})),function(e){return n.apply(this,arguments)}))}));case 1:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ok(zee))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Oye=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this,e)).router=r,i}return ip(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!1!==e.verified||t.router.parseUrl("/verify-account"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(Pye);return e.\u0275fac=function(t){return new(t||e)(Ok(zee),Ok(WM))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Tye(e,t){1&e&&(hb(0,"p",20),zE(1,21),fb())}function Iye(e,t){if(1&e){var n=gb();hb(0,"div",7),hb(1,"p",8),zE(2,9),fb(),hb(3,"div",10),hb(4,"p",11),zE(5,12),fb(),hb(6,"button",13),kb("click",function(){return Wy(n),Cb().finalizeEmailVerification()}),zE(7,14),fb(),fb(),hb(8,"div",15),hb(9,"p",11),zE(10,16),fb(),hb(11,"button",17),kb("click",function(){return Wy(n),Cb().sendEmailVerification()}),zE(12,18),fb(),fb(),ob(13,Tye,2,0,"p",19),fb()}if(2&e){var r=Cb();Ow(2),HE(r.emailAddress),GE(2),Ow(11),cb("ngIf",r.success)}}function xye(e,t){if(1&e){var n=gb();hb(0,"div",24),hb(1,"div",8),zE(2,25),fb(),hb(3,"form",26),hb(4,"div",27),hb(5,"div",28),db(6,"input",29),fb(),hb(7,"div",28),hb(8,"button",30),kb("click",function(){Wy(n);var e=Cb(2);return e.pickUsername(e.usernameForm.value)}),zE(9,31),fb(),fb(),fb(),fb(),fb()}if(2&e){var r=Cb(2);Ow(3),cb("formGroup",r.usernameForm)}}var Aye=function(){return["/lobby"]};function Rye(e,t){1&e&&(hb(0,"div",32),VE(1,33),db(2,"a",34),UE(),fb()),2&e&&(Ow(2),cb("routerLink",tP(1,Aye)))}function Nye(e,t){if(1&e&&(vb(0),ob(1,xye,10,1,"div",22),ob(2,Rye,3,2,"div",23),pb()),2&e){var n=Cb();Ow(1),cb("ngIf",!n.success),Ow(1),cb("ngIf",n.success)}}function Mye(e,t){if(1&e&&(hb(0,"div",35),hb(1,"div",36),Nb(2),fb(),fb()),2&e){var n=Cb();Ow(2),Mb(n.errorMessage)}}var Dye=function(){var e=function(){function e(t,n){np(this,e),this.authService=t,this.router=n,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new Bx({username:new Fx})}return ip(e,[{key:"ngOnInit",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.userSub=e.authService.getUserObs().subscribe(function(){var t=rB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.emailAddress=n.email.get(),!n.username.isAbsent()){t.next=5;break}e.verificationType="enter-username",t.next=11;break;case 5:if(e.verificationType="send-email",!0===e.triedToFinalize&&!1===n.verified&&(e.errorMessage=$localize(sv||(sv=Nv(["You have not verified your email! Click on the link in the verification email."])))),t.t0=!0===n.verified,!t.t0){t.next=11;break}return t.next=11,e.router.navigate(["/lobby"]);case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"pickUsername",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.authService.setUsername(e.username);case 2:(r=n.sent).isSuccess()?t.success=!0:t.errorMessage=r.getReason();case 4:case"end":return n.stop()}},n)}))()}},{key:"sendEmailVerification",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.sendEmailVerification();case 2:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=n.getReason();case 4:case"end":return t.stop()}},t)}))()}},{key:"finalizeEmailVerification",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.triedToFinalize=!0,t.next=3,e.authService.reloadUser();case 3:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){null!=this.userSub&&null!=this.userSub.unsubscribe&&this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(zee),ub(WM))},e.\u0275cmp=ty({type:e,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){return[[1,"box"],[1,"message","is-info"],[1,"message-header"],$localize(uv||(uv=Nv(["Account verification"]))),["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],$localize(cv||(cv=Nv(["In order to finalize your account, you must click on the link that you should have received on your email address (",":INTERPOLATION:). The email could be in your spam folder."])),"\ufffd0\ufffd"),[1,"block","level-left"],[1,"level-item"],$localize(lv||(lv=Nv(["Once you have verified your email, click on the following button:"]))),["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],$localize(hv||(hv=Nv(["Finalize email verification"]))),[1,"level-left"],$localize(fv||(fv=Nv(["If you have not received the verification email, click on the following button:"]))),["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],$localize(dv||(dv=Nv(["Send verification email again"]))),["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],$localize(vv||(vv=Nv(["The email has been sent"]))),["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],$localize(pv||(pv=Nv(["In order to finalize your account, you must choose a username."]))),[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",$localize(gv||(gv=Nv(["Username"]))),"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],$localize(yv||(yv=Nv(["Pick username"]))),["id","success",1,"message-body"],$localize(mv||(mv=Nv(["Your account has now been finalized, you can go back to the ",":START_LINK:list of games",":CLOSE_LINK:."])),"\ufffd#2\ufffd","\ufffd/#2\ufffd"),[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(hb(0,"div",0),hb(1,"div",1),hb(2,"div",2),zE(3,3),fb(),ob(4,Iye,14,2,"div",4),ob(5,Nye,3,2,"ng-container",5),fb(),ob(6,Mye,3,1,"div",6),fb()),2&e&&(Ow(4),cb("ngIf","send-email"===t.verificationType),Ow(1),cb("ngIf","enter-username"===t.verificationType),Ow(1),cb("ngIf",t.errorMessage))},directives:[DT,Wx,vx,Qx,FI,lA,dx,eA,YM],encapsulation:2}),e}(),Lye=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this,e)).router=r,i}return ip(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!e.verified||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(Pye);return e.\u0275fac=function(t){return new(t||e)(Ok(zee),Ok(WM))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Fye=function(){var e=function(e){qv(n,e);var t=Wv(n);function n(e,r){var i;return np(this,n),(i=t.call(this,e)).router=r,i}return ip(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(Pye);return e.\u0275fac=function(t){return new(t||e)(Ok(zee),Ok(WM))},e.\u0275prov=Sg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Bye(e,t){1&e&&(hb(0,"p",12),zE(1,13),fb())}function Vye(e,t){if(1&e&&(hb(0,"div",14),hb(1,"div",15),zE(2,16),fb(),hb(3,"div",17),Nb(4),fb(),fb()),2&e){var n=Cb();Ow(4),Mb(n.errorMessage.get())}}var Uye=function(){return{standalone:!0}},zye=function(){var e=function(){function e(t){np(this,e),this.authService=t,this.success=!1,this.errorMessage=cB.empty(),this.email=""}return ip(e,[{key:"resetPassword",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Z5(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=cB.empty(),e.success=!1,t.next=3,e.authService.sendPasswordResetEmail(e.email);case 3:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=cB.of(n.getReason());case 5:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(zee))},e.\u0275cmp=ty({type:e,selectors:[["app-reset-password"]],decls:12,vars:6,consts:function(){return[[1,"box"],[1,"title"],$localize(kv||(kv=Nv(["Password reset"]))),[1,"field"],[1,"control"],["id","email","name","email","placeholder",$localize(_v||(_v=Nv(["Email"]))),"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],$localize(wv||(wv=Nv(["An email will be sent with instruction to reset your password."]))),["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],$localize(Cv||(Cv=Nv(["Reset password"]))),["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],$localize(bv||(bv=Nv(["The email has been sent, please follow the instructions from that email."]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(Ev||(Ev=Nv(["Error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(hb(0,"div",0),hb(1,"p",1),zE(2,2),fb(),hb(3,"div",3),hb(4,"div",4),hb(5,"input",5),kb("ngModelChange",function(e){return t.email=e}),fb(),hb(6,"p",6),zE(7,7),fb(),ob(8,Bye,2,0,"p",8),fb(),fb(),hb(9,"button",9),kb("click",function(){return t.resetPassword()}),zE(10,10),fb(),ob(11,Vye,5,1,"div",11),fb()),2&e&&(Ow(5),cb("ngModel",t.email)("ngModelOptions",tP(5,Uye)),Ow(3),cb("ngIf",t.success),Ow(1),cb("disabled",""===t.email),Ow(2),cb("ngIf",t.errorMessage.isPresent()))},directives:[FI,Bve,lA,dx,$x,DT],encapsulation:2}),e}();function Hye(e,t){if(1&e&&(hb(0,"option",13),Nb(1),fb()),2&e){var n=t.$implicit,r=Cb();cb("value",n.value)("selected",n.value===r.currentTheme),Ow(1),Db(" ",n.name," ")}}function Gye(e,t){if(1&e&&(hb(0,"option",13),Nb(1),fb()),2&e){var n=t.$implicit,r=Cb();cb("value",n.value)("selected",n.value===r.currentLanguage),Ow(1),Db(" ",n.name," ")}}var qye=function(){var e=function(){function e(t,n){np(this,e),this.userSettingsService=t,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize(Sv||(Sv=Nv(["Light"])))},{value:"dark",name:$localize(Pv||(Pv=Nv(["Dark"])))}],this.currentTheme=n.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}return ip(e,[{key:"changeLanguage",value:function(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}},{key:"changeTheme",value:function(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}},{key:"reload",value:function(){window.open(window.location.href,"_self")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(nte),ub(rte))},e.\u0275cmp=ty({type:e,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){return[[1,"box"],[1,"title"],$localize(Ov||(Ov=Nv(["User settings"]))),[1,"field"],["for","theme",1,"label"],$localize(Tv||(Tv=Nv(["Theme"]))),[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],$localize(Iv||(Iv=Nv(["Language"]))),["id","language",3,"change"],[3,"value","selected"]]},template:function(e,t){1&e&&(hb(0,"div",0),hb(1,"p",1),zE(2,2),fb(),hb(3,"div",3),hb(4,"label",4),zE(5,5),fb(),hb(6,"div",6),hb(7,"div",7),hb(8,"select",8),kb("change",function(e){return t.changeTheme(e)}),ob(9,Hye,2,3,"option",9),fb(),fb(),fb(),fb(),hb(10,"div",3),hb(11,"label",10),zE(12,11),fb(),hb(13,"div",6),hb(14,"div",7),hb(15,"select",12),kb("change",function(e){return t.changeLanguage(e)}),ob(16,Gye,2,3,"option",9),fb(),fb(),fb(),fb(),fb()),2&e&&(Ow(9),cb("ngForOf",t.availableThemes),Ow(7),cb("ngForOf",t.availableLanguages))},directives:[NT,iA,uA],encapsulation:2}),e}(),$ye=function(){var e=ip(function e(){np(this,e)});return e.ALREADY_INGAME=function(){return $localize(xv||(xv=Nv(["You are already in a game. Finish it or cancel it first."])))},e}(),Wye=function(){var e=function(){function e(t,n,r,i,a,o){np(this,e),this.route=t,this.router=n,this.authenticationService=r,this.messageDisplayer=i,this.partDAO=a,this.gameService=o}return ip(e,[{key:"ngOnInit",value:function(){var e=this;return rB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createGameAndRedirectOrShowError(e.extractGameFromURL());case 2:case"end":return t.stop()}},t)}))()}},{key:"extractGameFromURL",value:function(){return iB.getNonNullable(this.route.snapshot.paramMap.get("compo"))}},{key:"createGameAndRedirectOrShowError",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return Z5((r=t.authenticationService.user.get()).isConnected(),"User must be connected and have a username to reach this page"),i=r.username.get(),n.next=5,t.canCreateOnlineGame(i);case 5:if(!n.sent){n.next=12;break}return n.next=8,t.gameService.createPartJoinerAndChat(i,e);case 8:return a=n.sent,n.next=11,t.router.navigate(["/play",e,a]);case 11:return n.abrupt("return",!0);case 12:return t.messageDisplayer.infoMessage($ye.ALREADY_INGAME()),n.next=15,t.router.navigate(["/lobby"]);case 15:return n.abrupt("return",!1);case 16:case"end":return n.stop()}},n)}))()}},{key:"canCreateOnlineGame",value:function(e){var t=this;return rB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=!1,n.next=3,t.partDAO.userHasActivePart(e);case 3:return n.t1=n.sent,n.abrupt("return",n.t0===n.t1);case 5:case"end":return n.stop()}},n)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(ub(SN),ub(WM),ub(zee),ub(Xne),ub(J5),ub(ete))},e.\u0275cmp=ty({type:e,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){return[$localize(Av||(Av=Nv(["Creating online game, please wait, it should not take long."])))]},template:function(e,t){1&e&&(hb(0,"p"),zE(1,0),fb())},encapsulation:2}),e}();!function(e,t,n){!function(e,t,n){"string"!=typeof t&&(n=t,t=e[$b.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),zb[t]=e,n&&(zb[t][$b.ExtraData]=n)}(e,void 0,void 0)}(tB());var jye=[{path:"login",component:Gve},{path:"lobby",component:hpe,canActivate:[Oye]},{path:"settings",component:qye},{path:"register",component:wye,canActivate:[Fye]},{path:"reset-password",component:zye,canActivate:[Fye]},{path:"notFound",component:fpe},{path:"nextGameLoading",component:Eye,canActivate:[Oye]},{path:"verify-account",component:Dye,canActivate:[Lye]},{path:"play",component:$ve,canActivate:[Oye]},{path:"play/:compo",component:Wye,canActivate:[Oye]},{path:"play/:compo/:id",component:Dge,canActivate:[Oye]},{path:"local",component:Cye},{path:"local/:compo",component:eye},{path:"tutorial",component:bye},{path:"tutorial/:compo",component:mye},{path:"",component:Fve},{path:"**",component:Fve}],Zye=function(){function e(){np(this,e)}return ip(e,null,[{key:"app",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:gG,providers:[{provide:fG,useFactory:pG(e),multi:!0,deps:[JP,UC,rG].concat(n)}]}}(function(){return Sye.useEmulators&&(Sye.firebaseConfig.databaseURL="http://localhost:9000?ns=default"),yG(Sye.firebaseConfig)})}},{key:"firestore",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:O5,providers:[{provide:b5,useFactory:E5(e),multi:!0,deps:[JP,UC,rG,hG,[new Dk,cj],[new Dk,KG]].concat(n)}]}}(function(){var e=D5(),t=e.toJSON().settings.host;return Sye.useEmulators&&"localhost:8080"!==t&&x5(e,"localhost",8080),e})}},{key:"database",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:Ree,providers:[{provide:Tee,useFactory:Iee(e),multi:!0,deps:[JP,UC,rG,hG,[new Dk,cj],[new Dk,KG]].concat(n)}]}}(function(){var e=Mee();return Sye.useEmulators&&!1===e._instanceStarted&&Nee(e,"localhost",9e3),e})}},{key:"auth",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:pj,providers:[{provide:lj,useFactory:hj(e),multi:!0,deps:[JP,UC,rG,hG,[new Dk,KG]].concat(n)}]}}(function(){var e=mj();return Sye.useEmulators&&null==e.config.emulator&&gj(e,"http://localhost:9099",{disableWarnings:!0}),e})}}]),e}(),Yye=function(){var e=ip(function e(){np(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ay({type:e,bootstrap:[$ne]}),e.\u0275inj=Pg({providers:[zee,ete,Xee,a6,t6,J5,rte,{provide:VP,useValue:tte.getLocale()}],imports:[[Zye.app(),Zye.firestore(),Zye.auth(),Zye.database(),bI,XA,sD.forRoot(jye,{useHash:!1}),pA,vA,XF,Nne]]}),e}();"undefined"!=typeof window&&window,"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,"undefined"!=typeof global&&global;var Kye=function(){function e(t){np(this,e),this.digits=t}return ip(e,[{key:"clone",value:function(){return new e(this.digits.slice())}},{key:"add",value:function(e){var t=this.clone();return t.addToSelf(e),t}},{key:"addToSelf",value:function(e){for(var t=Math.max(this.digits.length,e.digits.length),n=0,r=0;r<t;r++){var i=n;r<this.digits.length&&(i+=this.digits[r]),r<e.digits.length&&(i+=e.digits[r]),i>=10?(this.digits[r]=i-10,n=1):(this.digits[r]=i,n=0)}n>0&&(this.digits[t]=1)}},{key:"toString",value:function(){for(var e="",t=this.digits.length-1;t>=0;t--)e+=this.digits[t];return e}}],[{key:"zero",value:function(){return new e([0])}},{key:"one",value:function(){return new e([1])}}]),e}(),Jye=function(){function e(t){np(this,e),this.powerOfTwos=[t]}return ip(e,[{key:"getValue",value:function(){return this.powerOfTwos[0]}},{key:"multiplyBy",value:function(e){var t=Kye.zero();return this.multiplyByAndAddTo(e,t),t}},{key:"multiplyByAndAddTo",value:function(e,t){for(var n=0;0!==e;e>>>=1,n++)if(1&e){var r=this.getMultipliedByPowerOfTwo(n);t.addToSelf(r)}}},{key:"getMultipliedByPowerOfTwo",value:function(e){for(var t=this.powerOfTwos.length;t<=e;t++){var n=this.powerOfTwos[t-1];this.powerOfTwos[t]=n.add(n)}return this.powerOfTwos[e]}}]),e}(),Qye=function(){function e(t){np(this,e),this.base=t,this.exponents=[new Jye(Kye.one())]}return ip(e,[{key:"toThePowerOf",value:function(e){for(var t=this.exponents.length;t<=e;t++){var n=this.exponents[t-1].multiplyBy(this.base);this.exponents[t]=new Jye(n)}return this.exponents[e]}}]),e}();function Xye(e){var t=function(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r>=55296&&r<=56319&&e.length>n+1){var i=e.charCodeAt(n+1);i>=56320&&i<=57343&&(n++,r=(r-55296<<10)+i-56320+65536)}r<=127?t.push(r):r<=2047?t.push(r>>6&31|192,63&r|128):r<=65535?t.push(r>>12|224,r>>6&63|128,63&r|128):r<=2097151&&t.push(r>>18&7|240,r>>12&63|128,r>>6&63|128,63&r|128)}return t}(e),n=eme(t,0),r=eme(t,102072);return 0==n&&(0==r||1==r)&&(n^=319790063,r^=-1801410264),[n,r]}function eme(e,t){var n,r=2654435769,i=2654435769,a=e.length;for(n=0;n+12<=a;n+=12){var o=tme(r=rme(r,sme(e,n,nme.Little)),i=rme(i,sme(e,n+4,nme.Little)),t=rme(t,sme(e,n+8,nme.Little)));r=o[0],i=o[1],t=o[2]}return r=rme(r,sme(e,n,nme.Little)),i=rme(i,sme(e,n+4,nme.Little)),t=rme(t,a),tme(r,i,t=rme(t,sme(e,n+8,nme.Little)<<8))[2]}function tme(e,t,n){return e=ame(e,t),e=ame(e,n),e^=n>>>13,t=ame(t,n),t=ame(t,e),t^=e<<8,n=ame(n,e),n=ame(n,t),n^=t>>>13,e=ame(e,t),e=ame(e,n),e^=n>>>12,t=ame(t,n),t=ame(t,e),t^=e<<16,n=ame(n,e),n=ame(n,t),n^=t>>>5,e=ame(e,t),e=ame(e,n),e^=n>>>3,t=ame(t,n),t=ame(t,e),t^=e<<10,n=ame(n,e),n=ame(n,t),[e,t,n^=t>>>15]}var nme=((nme=nme||{})[nme.Little=0]="Little",nme[nme.Big=1]="Big",nme);function rme(e,t){return ime(e,t)[1]}function ime(e,t){var n=(65535&e)+(65535&t),r=(e>>>16)+(t>>>16)+(n>>>16);return[r>>>16,r<<16|65535&n]}function ame(e,t){var n=(65535&e)-(65535&t);return(e>>16)-(t>>16)+(n>>16)<<16|65535&n}function ome(e,t){return t>=e.length?0:e[t]}function sme(e,t,n){var r=0;if(n===nme.Big)for(var i=0;i<4;i++)r+=ome(e,t+i)<<24-8*i;else for(var a=0;a<4;a++)r+=ome(e,t+a)<<8*a;return r}var ume=new Qye(256);function cme(e,t){if(":"!==t.charAt(0))return{text:e};var n=function(e,t){for(var n=1,r=1;n<e.length;n++,r++)if("\\"===t[r])r++;else if(":"===e[n])return n;throw new Error('Unterminated $localize metadata block in "'.concat(t,'".'))}(e,t);return{block:e.substring(1,n),text:e.substring(n+1)}}function lme(e){return 1===e?"PH":"PH_"+(e-1)}Object.keys({useClass:null}),Object.keys({useFactory:null}),Object.keys({useValue:null}),Object.keys({useExisting:null});var hme=function(e){qv(n,e);var t=Wv(n);function n(e){var r;return np(this,n),(r=t.call(this,"No translation found for ".concat(dme(e),"."))).parsedMessage=e,r.type="MissingTranslationError",r}return ip(n)}(Uv(Error));function fme(e,t){return Object.defineProperty(e,"raw",{value:t}),e}function dme(e){var t=e.meaning&&' - "'.concat(e.meaning,'"'),n=e.legacyIds&&e.legacyIds.length>0?" [".concat(e.legacyIds.map(function(e){return'"'.concat(e,'"')}).join(", "),"]"):"";return'"'.concat(e.id,'"').concat(n,' ("').concat(e.text,'"').concat(t,")")}function vme(e,t){try{return function(e,t,n){var r=function(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a={},o={},s=function(e,t){var n=cme(e,t),r=n.text,i=n.block;if(void 0===i)return{text:r};var a=Rv(i.split("\u241f")),o=a[0],s=a.slice(1),u=Fv(o.split("@@",2),2),c=u[0],l=u[1],h=Fv(c.split("|",2),2),f=h[0],d=h[1];return void 0===d&&(d=f,f=void 0),""===d&&(d=void 0),{text:r,meaning:f,description:d,customId:l,legacyIds:s}}(e[0],e.raw[0]),u=[s.text],c=[],l=s.text,h=1;h<e.length;h++){var f=cme(e[h],e.raw[h]),d=f.text,v=f.block,p=void 0===v?lme(h):v;l+="{$".concat(p,"}").concat(d),void 0!==t&&(a[p]=t[h-1],o[p]=i[h-1]),c.push(p),u.push(d)}var g=s.customId||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Xye(e);if(t){var r=Xye(t);n=function(e,t){var n=e[0],r=t[0],i=ime(e[1],t[1]),a=i[0],o=i[1];return[rme(rme(n,r),a),o]}(function(e,t){var n=e[0],r=e[1];return[n<<1|r>>>31,r<<1|n>>>31]}(n),r)}return function(e,t){var n=ume.toThePowerOf(0).multiplyBy(t);return ume.toThePowerOf(4).multiplyByAndAddTo(e,n),n.toString()}(2147483647&n[0],n[1])}(l,s.meaning||""),y=s.legacyIds?s.legacyIds.filter(function(e){return e!==g}):[];return{id:g,legacyIds:y,substitutions:a,substitutionLocations:o,text:l,customId:s.customId,meaning:s.meaning||"",description:s.description||"",messageParts:u,messagePartLocations:r,placeholderNames:c,location:n}}(t,n),i=e[r.id];if(void 0!==r.legacyIds)for(var a=0;a<r.legacyIds.length&&void 0===i;a++)i=e[r.legacyIds[a]];if(void 0===i)throw new hme(r);return[i.messageParts,i.placeholderNames.map(function(e){if(r.substitutions.hasOwnProperty(e))return r.substitutions[e];throw new Error("There is a placeholder name mismatch with the translation provided for the message ".concat(dme(r),".\nThe translation contains a placeholder with name ").concat(e,", which does not exist in the message."))})]}($localize.TRANSLATIONS,e,t)}catch(n){return console.warn(n.message),[e,t]}}function pme(){Sye.production&&function(){if(cO)throw new Error("Cannot enable prod mode after platform setup.");uO=!1}(),wI().bootstrapModule(Yye).catch(function(e){return console.error(e)})}var gme=tte.getLocale();"en"!==gme?fetch(Sye.root+"assets/"+gme+".json").then(function(e){return e.ok?e.json():{locale:"en",translations:{}}}).then(function(e){(function(e){$localize.translate||($localize.translate=vme),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(e).forEach(function(t){$localize.TRANSLATIONS[t]=function(e){for(var t=e.split(/{\$([^}]*)}/),n=[t[0]],r=[],i=1;i<t.length-1;i+=2)r.push(t[i]),n.push("".concat(t[i+1]));var a=n.map(function(e){return":"===e.charAt(0)?"\\"+e:e});return{text:e,messageParts:fme(n,a),placeholderNames:r}}(e[t])})})(e.translations),$localize.locale=e.locale,pme()}).catch(function(e){console.log(e)}):pme()}},function(e){e(e.s=2912)}])}();