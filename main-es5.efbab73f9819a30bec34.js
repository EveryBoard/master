!function(){var e,t,n,r,i,a,o,s,u,c,l,f,h,d,v,p,g,y,m,k,C,w,_,E,b,P,S,O,T,I,A,R,M,x,N,D,L,F,U,V,B,z,H,G,$,Z,q,W,j,Y,K,Q,X,J,ee,te,ne,re,ie,ae,oe,se,ue,ce,le,fe,he,de,ve,pe,ge,ye,me,ke,Ce,we,_e,Ee,be,Pe,Se,Oe,Te,Ie,Ae,Re,Me,xe,Ne,De,Le,Fe,Ue,Ve,Be,ze,He,Ge,$e,Ze,qe,We,je,Ye,Ke,Qe,Xe,Je,et,tt,nt,rt,it,at,ot,st,ut,ct,lt,ft,ht,dt,vt,pt,gt,yt,mt,kt,Ct,wt,_t,Et,bt,Pt,St,Ot,Tt,It,At,Rt,Mt,xt,Nt,Dt,Lt,Ft,Ut,Vt,Bt,zt,Ht,Gt,$t,Zt,qt,Wt,jt,Yt,Kt,Qt,Xt,Jt,en,tn,nn,rn,an,on,sn,un,cn,ln,fn,hn,dn,vn,pn,gn,yn,mn,kn,Cn,wn,_n,En,bn,Pn,Sn,On,Tn,In,An,Rn,Mn,xn,Nn,Dn,Ln,Fn,Un,Vn,Bn,zn,Hn,Gn,$n,Zn,qn,Wn,jn,Yn,Kn,Qn,Xn,Jn,er,tr,nr,rr,ir,ar,or,sr,ur,cr,lr,fr,hr,dr,vr,pr,gr,yr,mr,kr,Cr,wr,_r,Er,br,Pr,Sr,Or,Tr,Ir,Ar,Rr,Mr,xr,Nr,Dr,Lr,Fr,Ur,Vr,Br,zr,Hr,Gr,$r,Zr,qr,Wr,jr,Yr,Kr,Qr,Xr,Jr,ei,ti,ni,ri,ii,ai,oi,si,ui,ci,li,fi,hi,di,vi,pi,gi,yi,mi,ki,Ci,wi,_i,Ei,bi,Pi,Si,Oi,Ti,Ii,Ai,Ri,Mi,xi,Ni,Di,Li,Fi,Ui,Vi,Bi,zi,Hi,Gi,$i,Zi,qi,Wi,ji,Yi,Ki,Qi,Xi,Ji,ea,ta,na,ra,ia,aa,oa,sa,ua,ca,la,fa,ha,da,va,pa,ga,ya,ma,ka,Ca,wa,_a,Ea,ba,Pa,Sa,Oa,Ta,Ia,Aa,Ra,Ma,xa,Na,Da,La,Fa,Ua,Va,Ba,za,Ha,Ga,$a,Za,qa,Wa,ja,Ya,Ka,Qa,Xa,Ja,eo,to,no,ro,io,ao,oo,so,uo,co,lo,fo,ho,vo,po,go,yo,mo,ko,Co,wo,_o,Eo,bo,Po,So,Oo,To,Io,Ao,Ro,Mo,xo,No,Do,Lo,Fo,Uo,Vo,Bo,zo,Ho,Go,$o,Zo,qo,Wo,jo,Yo,Ko,Qo,Xo,Jo,es,ts,ns,rs,is,as,os,ss,us,cs,ls,fs,hs,ds,vs,ps,gs,ys,ms,ks,Cs,ws,_s,Es,bs,Ps,Ss,Os,Ts,Is,As,Rs,Ms,xs,Ns,Ds,Ls,Fs,Us,Vs,Bs,zs,Hs,Gs,$s,Zs,qs,Ws,js,Ys,Ks,Qs,Xs,Js,eu,tu,nu,ru,iu,au,ou,su,uu,cu,lu,fu,hu,du,vu,pu,gu,yu,mu,ku,Cu,wu,_u,Eu,bu,Pu,Su,Ou,Tu,Iu,Au,Ru,Mu,xu,Nu,Du,Lu,Fu,Uu,Vu,Bu,zu,Hu,Gu,$u,Zu,qu,Wu,ju,Yu,Ku,Qu,Xu,Ju,ec,tc,nc,rc,ic,ac,oc,sc,uc,cc,lc,fc,hc,dc,vc,pc,gc,yc,mc,kc,Cc,wc,_c,Ec,bc,Pc,Sc,Oc,Tc,Ic,Ac,Rc,Mc,xc,Nc,Dc,Lc,Fc,Uc,Vc,Bc,zc,Hc,Gc,$c,Zc,qc,Wc,jc,Yc,Kc,Qc,Xc,Jc,el,tl,nl,rl,il,al,ol,sl,ul,cl,ll,fl,hl,dl,vl,pl,gl,yl,ml,kl,Cl,wl,_l,El,bl,Pl,Sl,Ol,Tl,Il,Al,Rl,Ml,xl,Nl,Dl,Ll,Fl,Ul,Vl,Bl,zl,Hl,Gl,$l,Zl,ql,Wl,jl,Yl,Kl,Ql,Xl,Jl,ef,tf,nf,rf,af,of,sf,uf,cf,lf,ff,hf,df,vf,pf,gf,yf,mf,kf,Cf,wf,_f,Ef,bf,Pf,Sf,Of,Tf,If,Af,Rf,Mf,xf,Nf,Df,Lf,Ff,Uf,Vf,Bf,zf,Hf,Gf,$f,Zf,qf,Wf,jf,Yf,Kf,Qf,Xf,Jf,eh,th,nh,rh,ih,ah,oh,sh,uh,ch,lh,fh,hh,dh,vh,ph,gh,yh,mh,kh,Ch,wh,_h,Eh,bh,Ph,Sh,Oh,Th,Ih,Ah,Rh,Mh,xh,Nh,Dh,Lh,Fh,Uh,Vh,Bh,zh,Hh,Gh,$h,Zh,qh,Wh,jh,Yh,Kh,Qh,Xh,Jh,ed,td,nd,rd,id,ad,od,sd,ud,cd,ld,fd,hd,dd,vd,pd,gd,yd,md,kd,Cd,wd,_d,Ed,bd,Pd,Sd,Od,Td,Id,Ad,Rd,Md,xd,Nd,Dd,Ld,Fd,Ud,Vd,Bd,zd,Hd,Gd,$d,Zd,qd,Wd,jd,Yd,Kd,Qd,Xd,Jd,ev,tv,nv,rv,iv,av,ov,sv,uv,cv,lv,fv,hv,dv,vv,pv,gv,yv,mv,kv,Cv,wv,_v,Ev,bv,Pv,Sv,Ov,Tv,Iv,Av,Rv,Mv,xv,Nv,Dv,Lv,Fv,Uv,Vv,Bv,zv,Hv,Gv,$v,Zv,qv,Wv,jv,Yv,Kv,Qv,Xv,Jv,ep,tp,np,rp,ip,ap,op,sp,up,cp,lp,fp,hp,dp,vp,pp,gp,yp,mp,kp,Cp,wp,_p,Ep,bp,Pp,Sp,Op,Tp,Ip,Ap,Rp,Mp,xp,Np,Dp,Lp,Fp,Up,Vp,Bp,zp,Hp,Gp,$p,Zp,qp,Wp,jp,Yp,Kp,Qp,Xp,Jp,eg,tg,ng,rg,ig,ag,og,sg,ug,cg,lg,fg,hg,dg,vg,pg,gg,yg,mg,kg,Cg;function wg(e){return Tg(e)||zg(e)||Gg(e)||Og()}function _g(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Eg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function bg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Eg(Object(n),!0).forEach(function(t){Pg(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Eg(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Pg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sg(e,t){return Tg(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(u){s=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}(e,t)||Gg(e,t)||Og()}function Og(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Tg(e){if(Array.isArray(e))return e}function Ig(e){var t="function"==typeof Map?new Map:void 0;return Ig=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Ag(e,arguments,Vg(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Ng(r,e)},Ig(e)}function Ag(e,t,n){return Ag=Ug()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&Ng(i,n.prototype),i},Ag.apply(null,arguments)}function Rg(){return Rg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Mg(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Rg.apply(this,arguments)}function Mg(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Vg(e)););return e}function xg(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ng(e,t)}function Ng(e,t){return Ng=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ng(e,t)}function Dg(e){var t=Ug();return function(){var n,r=Vg(e);if(t){var i=Vg(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Lg(this,n)}}function Lg(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Fg(e)}function Fg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ug(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Vg(e){return Vg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Vg(e)}function Bg(e){return function(e){if(Array.isArray(e))return $g(e)}(e)||zg(e)||Gg(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zg(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Hg(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Gg(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Gg(e,t){if(e){if("string"==typeof e)return $g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$g(e,t):void 0}}function $g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Zg(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wg(e,t,n){return t&&qg(e.prototype,t),n&&qg(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunkEveryBoard=self.webpackChunkEveryBoard||[]).push([[179],{8255:function(e){function t(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=8255,e.exports=t},9575:function(e,t,n){var r,i,a;!function(o){if("object"==typeof e.exports){var s=o(0,t);void 0!==s&&(e.exports=s)}else i=[n,t],void 0!==(a="function"==typeof(r=o)?r.apply(t,i):r)&&(e.exports=a)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0;t.default=["fr",[["AM","PM"],n,n],n,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],n,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],n,[["av. J.-C.","ap. J.-C."],n,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1} '\xe0' {0}",n,n],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[n,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[n,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[n,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[n,"\xa5"],KMF:[n,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[n,"$C"],NZD:["$NZ","$"],RHD:["$RH"],RON:[n,"L"],RWF:[n,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[n,"$T"],TTD:["$TT","$"],TWD:[n,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[n,"$"],XPF:["FCFP"],ZMW:[n,"Kw"]},"ltr",function(e){var t=Math.floor(Math.abs(e));return 0===t||1===t?1:5}]})},5378:function(e,t){!function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(e){for(var n,r=1;r<arguments.length;r++){var i;n=null!==(i=arguments[r])&&void 0!==i?i:{},r%2?t(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){var e;return null!==(e=f)&&void 0!==e?e:document}var u={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},c=n({},u),l={},f=null,h=function(){function e(t){var n=this;r(this,e),this.element=s().createElement("div"),this.opacity=t.opacity,this.type=t.type,this.animate=t.animate,this.dismissible=t.dismissible,this.closeOnClick=t.closeOnClick,this.message=t.message,this.duration=t.duration,this.pauseOnHover=t.pauseOnHover,this.offsetTop=t.offsetTop,this.offsetBottom=t.offsetBottom,this.offsetLeft=t.offsetLeft,this.offsetRight=t.offsetRight,this.extraClasses=t.extraClasses;var i="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),a=["notification",this.extraClasses];if(this.type&&a.push(this.type),this.animate&&this.animate.in){var o="animate__".concat(this.animate.in),u=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";a.push("animate__animated ".concat(o," ").concat(u)),this.onAnimationEnd(function(){return n.element.classList.remove(o)})}if(this.element.className=a.join(" "),this.dismissible){var c=s().createElement("button");c.className="delete",c.addEventListener("click",function(){n.destroy()}),this.element.insertAdjacentElement("afterbegin",c)}else i+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){n.destroy()}),this.element.setAttribute("style",i),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var l=new d(function(){n.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){l.pause()}),this.element.addEventListener("mouseout",function(){l.resume()}))}return a(e,[{key:"destroy",value:function(){var e=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){e.removeParent(e.element.parentNode),e.element.remove(),delete l.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete l.position)}},{key:"removeParent",value:function(e){e&&1>=e.children.length&&e.remove()}},{key:"onAnimationEnd",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var n in t)if(void 0!==this.element.style[n]){this.element.addEventListener(t[n],function(){return e()});break}}}]),e}(),d=function(){function e(t,n){r(this,e),this.remaining=n,this.callback=t,this.resume()}return a(e,[{key:"pause",value:function(){"undefined"==typeof document||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){"undefined"==typeof document||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),e}();e.resetDefaults=function(){c=n({},u)},e.setDefaults=function(e){c=n(n({},u),e)},e.setDoc=function(e){for(var t in l)l[t].remove();l={},f=e},e.toast=function(e){if(!e.message)throw new Error("message is required");var t=n(n({},c),e),r=new h(t),i=function(e,t,n,r,i,a){if(l.position)return l.position;var o=s().createElement("div");return o.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+function(e,t,n,r,i){return"top-left"===e?"left:".concat(r,";top:").concat(t,";text-align:left;align-items:flex-start;"):"top-right"===e?"right:".concat(i,";top:").concat(t,";text-align:right;align-items:flex-end;"):"top-center"===e?"top:".concat(t,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===e?"left:".concat(r,";bottom:").concat(n,";text-align:left;align-items:flex-start;"):"bottom-right"===e?"right:".concat(i,";bottom:").concat(n,";text-align:right;align-items:flex-end;"):"bottom-center"===e?"bottom:".concat(n,";left:0;right:0;text-align:center;align-items:center;"):"center"===e?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0}(t,n,r,i,a)),e.appendChild(o),l.position=o,o}(t.appendTo||s().body,t.position||c.position,t.offsetTop||c.offsetTop,t.offsetBottom||c.offsetBottom,t.offsetLeft||c.offsetLeft,t.offsetRight||c.offsetRight);if(t.single)for(var a=i.lastElementChild;a;)i.removeChild(a),a=i.lastElementChild;i.appendChild(r.element)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},6607:function(Eg,Og,Tg){"use strict";var Mg,Ng;function Ug(e){return"function"==typeof e}function zg(e){var t=e(function(e){Error.call(e),e.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Gg=zg(function(e){return function(t){e(this),this.message=t?"".concat(t.length," errors occurred during unsubscription:\n").concat(t.map(function(e,t){return"".concat(t+1,") ").concat(e.toString())}).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=t}});function $g(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var qg=function(){function e(t){Zg(this,e),this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}return Wg(e,[{key:"unsubscribe",value:function(){var e;if(!this.closed){this.closed=!0;var t=this._parentage;if(t)if(this._parentage=null,Array.isArray(t)){var n,r=Hg(t);try{for(r.s();!(n=r.n()).done;){var i;n.value.remove(this)}}catch(f){r.e(f)}finally{r.f()}}else t.remove(this);var a=this.initialTeardown;if(Ug(a))try{a()}catch(i){e=i instanceof Gg?i.errors:[i]}var o=this._teardowns;if(o){this._teardowns=null;var s,u=Hg(o);try{for(u.s();!(s=u.n()).done;){var c=s.value;try{Kg(c)}catch(h){var l;e=null!==(l=e)&&void 0!==l?l:[],h instanceof Gg?e=[].concat(Bg(e),Bg(h.errors)):e.push(h)}}}catch(f){u.e(f)}finally{u.f()}}if(e)throw new Gg(e)}}},{key:"add",value:function(t){var n;if(t&&t!==this)if(this.closed)Kg(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(t)}}},{key:"_hasParent",value:function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)}},{key:"_addParent",value:function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}},{key:"_removeParent",value:function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&$g(t,e)}},{key:"remove",value:function(t){var n=this._teardowns;n&&$g(n,t),t instanceof e&&t._removeParent(this)}}]),e}();qg.EMPTY=function(){var e=new qg;return e.closed=!0,e}();var jg=qg.EMPTY;function Yg(e){return e instanceof qg||e&&"closed"in e&&Ug(e.remove)&&Ug(e.add)&&Ug(e.unsubscribe)}function Kg(e){Ug(e)?e():e.unsubscribe()}var Qg=null,Xg=null,Jg=void 0,ey=!1,ty=!1,ny={setTimeout:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=ny.delegate;return((null==e?void 0:e.setTimeout)||setTimeout).apply(void 0,arguments)}),clearTimeout:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=ny.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)}),delegate:void 0};function ry(e){ny.setTimeout(function(){if(!Qg)throw e;Qg(e)})}function iy(){}var ay=oy("C",void 0,void 0);function oy(e,t,n){return{kind:e,value:t,error:n}}var sy=null;function uy(e){if(ey){var t=!sy;if(t&&(sy={errorThrown:!1,error:null}),e(),t){var n=sy,r=n.errorThrown,i=n.error;if(sy=null,r)throw i}}else e()}var cy=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).isStopped=!1,e?(r.destination=e,Yg(e)&&e.add(Fg(r))):r.destination=vy,r}return Wg(n,[{key:"next",value:function(e){this.isStopped?dy(oy("N",e,void 0),this):this._next(e)}},{key:"error",value:function(e){this.isStopped?dy(oy("E",void 0,e),this):(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped?dy(ay,this):(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,Rg(Vg(n.prototype),"unsubscribe",this).call(this),this.destination=null)}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){try{this.destination.error(e)}finally{this.unsubscribe()}}},{key:"_complete",value:function(){try{this.destination.complete()}finally{this.unsubscribe()}}}],[{key:"create",value:function(e,t,n){return new ly(e,t,n)}}]),n}(qg),ly=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a,o,s;if(Zg(this,n),o=t.call(this),Ug(e))s=e;else if(e){var u,c;s=(u=e).next,r=u.error,i=u.complete,Fg(o)&&ty?(c=Object.create(e)).unsubscribe=function(){return o.unsubscribe()}:c=e,s=null==s?void 0:s.bind(c),r=null==r?void 0:r.bind(c),i=null==i?void 0:i.bind(c)}return o.destination={next:s?fy(s):iy,error:fy(null!==(a=r)&&void 0!==a?a:hy),complete:i?fy(i):iy},Lg(o)}return Wg(n)}(cy);function fy(e,t){return function(){try{e.apply(void 0,arguments)}catch(t){ey?function(e){ey&&sy&&(sy.errorThrown=!0,sy.error=e)}(t):ry(t)}}}function hy(e){throw e}function dy(e,t){var n=Xg;n&&ny.setTimeout(function(){return n(e,t)})}var vy={closed:!0,next:iy,error:hy,complete:iy},py="function"==typeof Symbol&&Symbol.observable||"@@observable";function gy(e){return e}var yy=function(){var e=function(){function e(t){Zg(this,e),t&&(this._subscribe=t)}return Wg(e,[{key:"lift",value:function(t){var n=new e;return n.source=this,n.operator=t,n}},{key:"subscribe",value:function(e,t,n){var r=this,i=function(e){return e&&e instanceof cy||function(e){return e&&Ug(e.next)&&Ug(e.error)&&Ug(e.complete)}(e)&&Yg(e)}(e)?e:new ly(e,t,n);return uy(function(){var e=r.operator,t=r.source;i.add(e?e.call(i,t):t?r._subscribe(i):r._trySubscribe(i))}),i}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){e.error(t)}}},{key:"forEach",value:function(e,t){var n=this;return new(t=my(t))(function(t,r){var i=new ly({next:function(t){try{e(t)}catch(n){r(n),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)})}},{key:"_subscribe",value:function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)}},{key:py,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return 0===e.length?gy:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}}(t)(this)}},{key:"toPromise",value:function(e){var t=this;return new(e=my(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})}}]),e}();return e.create=function(t){return new e(t)},e}();function my(e){var t;return null!==(t=null!=e?e:Jg)&&void 0!==t?t:Promise}var ky=zg(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Cy=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.call(this)).closed=!1,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return Wg(n,[{key:"lift",value:function(e){var t=new wy(this,this);return t.operator=e,t}},{key:"_throwIfClosed",value:function(){if(this.closed)throw new ky}},{key:"next",value:function(e){var t=this;uy(function(){if(t._throwIfClosed(),!t.isStopped){var n,r=Hg(t.observers.slice());try{for(r.s();!(n=r.n()).done;){n.value.next(e)}}catch(i){r.e(i)}finally{r.f()}}})}},{key:"error",value:function(e){var t=this;uy(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}})}},{key:"complete",value:function(){var e=this;uy(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})}},{key:"unsubscribe",value:function(){this.isStopped=this.closed=!0,this.observers=null}},{key:"observed",get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}},{key:"_trySubscribe",value:function(e){return this._throwIfClosed(),Rg(Vg(n.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}},{key:"_innerSubscribe",value:function(e){var t=this.hasError,n=this.isStopped,r=this.observers;return t||n?jg:(r.push(e),new qg(function(){return $g(r,e)}))}},{key:"_checkFinalizedStatuses",value:function(e){var t=this.hasError,n=this.thrownError,r=this.isStopped;t?e.error(n):r&&e.complete()}},{key:"asObservable",value:function(){var e=new yy;return e.source=this,e}}]),n}(yy);return e.create=function(e,t){return new wy(e,t)},e}(),wy=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).destination=e,i.source=r,i}return Wg(n,[{key:"next",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}},{key:"error",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}},{key:"complete",value:function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}},{key:"_subscribe",value:function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:jg}}]),n}(Cy);function _y(e){return Ug(null==e?void 0:e.lift)}function Ey(e){return function(t){if(_y(t))return t.lift(function(t){try{return e(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}var by=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o){var s,u,c,l;return Zg(this,n),(l=t.call(this,e)).onFinalize=o,l._next=r?function(t){try{r(t)}catch(n){e.error(n)}}:Rg((s=Fg(l),Vg(n.prototype)),"_next",s),l._error=a?function(t){try{a(t)}catch(n){e.error(n)}finally{this.unsubscribe()}}:Rg((u=Fg(l),Vg(n.prototype)),"_error",u),l._complete=i?function(){try{i()}catch(t){e.error(t)}finally{this.unsubscribe()}}:Rg((c=Fg(l),Vg(n.prototype)),"_complete",c),l}return Wg(n,[{key:"unsubscribe",value:function(){var e,t=this.closed;Rg(Vg(n.prototype),"unsubscribe",this).call(this),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}]),n}(cy);function Py(e,t){return Ey(function(n,r){var i=0;n.subscribe(new by(r,function(n){r.next(e.call(t,n,i++))}))})}function Sy(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function Oy(e){return this instanceof Oy?(this.v=e,this):new Oy(e)}function Ty(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){a.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{!function(e){e.value instanceof Oy?Promise.resolve(e.value.v).then(u,c):l(a[0][2],e)}(i[e](t))}catch(n){l(a[0][3],n)}}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function Iy(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){!function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}(r,i,(t=e[n](t)).done,t.value)})}}}var Ay=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function Ry(e){return Ug(null==e?void 0:e.then)}function My(e){return Ug(e[py])}function xy(e){return Symbol.asyncIterator&&Ug(null==e?void 0:e[Symbol.asyncIterator])}function Ny(e){return new TypeError("You provided ".concat(null!==e&&"object"==typeof e?"an invalid object":"'".concat(e,"'")," where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable."))}var Dy="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Ly(e){return Ug(null==e?void 0:e[Dy])}function Fy(e){return Ty(this,arguments,regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.getReader(),t.prev=1;case 2:return t.next=4,Oy(n.read());case 4:if(r=t.sent,i=r.value,!r.done){t.next=11;break}return t.next=10,Oy(void 0);case 10:return t.abrupt("return",t.sent);case 11:return t.next=13,Oy(i);case 13:return t.next=15,t.sent;case 15:t.next=2;break;case 17:return t.prev=17,n.releaseLock(),t.finish(17);case 20:case"end":return t.stop()}},t,null,[[1,,17,20]])}))}function Uy(e){return Ug(null==e?void 0:e.getReader)}function Vy(e){if(e instanceof yy)return e;if(null!=e){if(My(e))return function(e){return new yy(function(t){var n=e[py]();if(Ug(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(Ay(e))return function(e){return new yy(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(Ry(e))return function(e){return new yy(function(t){e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,ry)})}(e);if(xy(e))return By(e);if(Ly(e))return function(e){return new yy(function(t){var n,r=Hg(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.next(i),t.closed)return}}catch(a){r.e(a)}finally{r.f()}t.complete()})}(e);if(Uy(e))return function(e){return By(Fy(e))}(e)}throw Ny(e)}function By(e){return new yy(function(t){(function(e,t){var n,r,i,a;return function(e,t,n,r){return new(n||(n=Promise))(function(t,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function o(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?t(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,o)}s((r=r.apply(e,[])).next())})}(this,0,void 0,regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:o.prev=0,n=Iy(e);case 2:return o.next=4,n.next();case 4:if((r=o.sent).done){o.next=9;break}if(t.next(r.value),!t.closed){o.next=7;break}return o.abrupt("return");case 7:o.next=2;break;case 9:o.next=14;break;case 11:o.prev=11,o.t0=o.catch(0),i={error:o.t0};case 14:if(o.prev=14,o.prev=15,o.t1=r&&!r.done&&(a=n.return),!o.t1){o.next=20;break}return o.next=20,a.call(n);case 20:if(o.prev=20,!i){o.next=23;break}throw i.error;case 23:return o.finish(20);case 24:return o.finish(14);case 25:t.complete();case 26:case"end":return o.stop()}},o,null,[[0,11,14,25],[15,,20,24]])}))})(e,t).catch(function(e){return t.error(e)})})}function zy(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!i)return a}function Hy(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return Ug(t)?Hy(function(n,r){return Py(function(e,i){return t(n,e,r,i)})(Vy(e(n,r)))},n):("number"==typeof t&&(n=t),Ey(function(t,r){return function(e,t,n,r,i,a,o,s){var u=[],c=0,l=0,f=!1,h=function(){f&&!u.length&&!c&&t.complete()},d=function e(i){c++;var a=!1;Vy(n(i,l++)).subscribe(new by(t,function(e){t.next(e)},function(){a=!0},void 0,function(){if(a)try{for(c--;u.length&&c<r;){var n=u.shift();e(n)}h()}catch(n){t.error(n)}}))};return e.subscribe(new by(t,function(e){return c<r?d(e):u.push(e)},function(){f=!0,h()})),function(){}}(t,r,e,n)}))}function Gy(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0;return Hy(gy,e)}var $y=new yy(function(e){return e.complete()});function Zy(e){return e[e.length-1]}function qy(e){return Ug(Zy(e))?e.pop():void 0}function Wy(e){return function(e){return e&&Ug(e.schedule)}(Zy(e))?e.pop():void 0}function jy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Ey(function(n,r){n.subscribe(new by(r,function(n){return zy(r,e,function(){return r.next(n)},t)},function(){return zy(r,e,function(){return r.complete()},t)},function(n){return zy(r,e,function(){return r.error(n)},t)}))})}function Yy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Ey(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function Ky(e,t){if(!e)throw new Error("Iterable cannot be null");return new yy(function(n){zy(n,t,function(){var r=e[Symbol.asyncIterator]();zy(n,t,function(){r.next().then(function(e){e.done?n.complete():n.next(e.value)})},0,!0)})})}function Qy(e,t){return t?function(e,t){if(null!=e){if(My(e))return function(e,t){return Vy(e).pipe(Yy(t),jy(t))}(e,t);if(Ay(e))return function(e,t){return new yy(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(Ry(e))return function(e,t){return Vy(e).pipe(Yy(t),jy(t))}(e,t);if(xy(e))return Ky(e,t);if(Ly(e))return function(e,t){return new yy(function(n){var r;return zy(n,t,function(){r=e[Dy](),zy(n,t,function(){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(a){return void n.error(a)}t?n.complete():n.next(e)},0,!0)}),function(){return Ug(null==r?void 0:r.return)&&r.return()}})}(e,t);if(Uy(e))return function(e,t){return Ky(Fy(e),t)}(e,t)}throw Ny(e)}(e,t):Vy(e)}function Xy(e){return e<=0?function(){return $y}:Ey(function(t,n){var r=0;t.subscribe(new by(n,function(t){++r<=e&&(n.next(t),e<=r&&n.complete())}))})}function Jy(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return!0===t?(e(),null):!1===t?null:t.apply(void 0,r).pipe(Xy(1)).subscribe(function(){return e()})}function em(e){for(var t in e)if(e[t]===em)return t;throw Error("Could not find renamed property on target object.")}function tm(e,t){for(var n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function nm(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(nm).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return"".concat(e.overriddenName);if(e.name)return"".concat(e.name);var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function rm(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}var im=em({__forward_ref__:em});function am(e){return e.__forward_ref__=am,e.toString=function(){return nm(this())},e}function om(e){return sm(e)?e():e}function sm(e){return"function"==typeof e&&e.hasOwnProperty(im)&&e.__forward_ref__===am}var um=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),i=t.call(this,function(e,t){return"".concat(e?"NG0".concat(e,": "):"").concat(t)}(e,r)),i.code=e,i}return Wg(n)}(Ig(Error));function cm(e){return"string"==typeof e?e:null==e?"":String(e)}function lm(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():cm(e)}function fm(e,t){var n=t?" in ".concat(t):"";throw new um("201","No provider for ".concat(lm(e)," found").concat(n))}function hm(e,t,n,r){throw new Error("ASSERTION ERROR: ".concat(e)+(null==r?"":" [Expected=> ".concat(n," ").concat(r," ").concat(t," <=Actual]")))}function dm(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function vm(e){return{providers:e.providers||[],imports:e.imports||[]}}function pm(e){return gm(e,km)||gm(e,wm)}function gm(e,t){return e.hasOwnProperty(t)?e[t]:null}function ym(e){return e&&(e.hasOwnProperty(Cm)||e.hasOwnProperty(_m))?e[Cm]:null}var mm,km=em({"\u0275prov":em}),Cm=em({"\u0275inj":em}),wm=em({ngInjectableDef:em}),_m=em({ngInjectorDef:em}),Em=((Em=Em||{})[Em.Default=0]="Default",Em[Em.Host=1]="Host",Em[Em.Self=2]="Self",Em[Em.SkipSelf=4]="SkipSelf",Em[Em.Optional=8]="Optional",Em);function bm(e){var t=mm;return mm=e,t}function Pm(e,t,n){var r=pm(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&Em.Optional?null:void 0!==t?t:void fm(nm(e),"Injector")}function Sm(e){return{toString:e}.toString()}var Om=((Om=Om||{})[Om.OnPush=0]="OnPush",Om[Om.Default=1]="Default",Om),Tm=((Tm=Tm||{})[Tm.Emulated=0]="Emulated",Tm[Tm.None=2]="None",Tm[Tm.ShadowDom=3]="ShadowDom",Tm),Im="undefined"!=typeof globalThis&&globalThis,Am="undefined"!=typeof window&&window,Rm="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Mm=Im||"undefined"!=typeof global&&global||Am||Rm,xm={},Nm=[],Dm=em({"\u0275cmp":em}),Lm=em({"\u0275dir":em}),Fm=em({"\u0275pipe":em}),Um=em({"\u0275mod":em}),Vm=em({"\u0275loc":em}),Bm=em({"\u0275fac":em}),zm=em({__NG_ELEMENT_ID__:em}),Hm=0;function Gm(e){return Sm(function(){var t={},n={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===Om.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||Nm,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||Tm.Emulated,id:"c",styles:e.styles||Nm,_:null,setInput:null,schemas:e.schemas||null,tView:null},r=e.directives,i=e.features,a=e.pipes;return n.id+=Hm++,n.inputs=jm(e.inputs,t),n.outputs=jm(e.outputs),i&&i.forEach(function(e){return e(n)}),n.directiveDefs=r?function(){return("function"==typeof r?r():r).map($m)}:null,n.pipeDefs=a?function(){return("function"==typeof a?a():a).map(Zm)}:null,n})}function $m(e){return Qm(e)||function(e){return e[Lm]||null}(e)}function Zm(e){return function(e){return e[Fm]||null}(e)}var qm={};function Wm(e){return Sm(function(){var t={type:e.type,bootstrap:e.bootstrap||Nm,declarations:e.declarations||Nm,imports:e.imports||Nm,exports:e.exports||Nm,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(qm[e.id]=e.type),t})}function jm(e,t){if(null==e)return xm;var n={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],a=i;Array.isArray(i)&&(a=i[1],i=i[0]),n[i]=r,t&&(t[i]=a)}return n}var Ym=Gm;function Km(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function Qm(e){return e[Dm]||null}function Xm(e,t){var n=e[Um]||null;if(!n&&!0===t)throw new Error("Type ".concat(nm(e)," does not have '\u0275mod' property."));return n}function Jm(e){return Array.isArray(e)&&"object"==typeof e[1]}function ek(e){return Array.isArray(e)&&!0===e[1]}function tk(e){return 0!=(8&e.flags)}function nk(e){return 2==(2&e.flags)}function rk(e){return 1==(1&e.flags)}function ik(e){return null!==e.template}function ak(e){return 0!=(512&e[2])}function ok(e,t){return e.hasOwnProperty(Bm)?e[Bm]:null}var sk=function(){function e(t,n,r){Zg(this,e),this.previousValue=t,this.currentValue=n,this.firstChange=r}return Wg(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}();function uk(){return ck}function ck(e){return e.type.prototype.ngOnChanges&&(e.setInput=fk),lk}function lk(){var e=dk(this),t=null==e?void 0:e.current;if(t){var n=e.previous;if(n===xm)e.previous=t;else for(var r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function fk(e,t,n,r){var i=dk(e)||function(e,t){return e[hk]=t}(e,{previous:xm,current:null}),a=i.current||(i.current={}),o=i.previous,s=this.declaredInputs[n],u=o[s];a[s]=new sk(u&&u.currentValue,t,o===xm),e[r]=t}uk.ngInherit=!0;var hk="__ngSimpleChanges__";function dk(e){return e[hk]||null}var vk,pk="http://www.w3.org/2000/svg";function gk(){return void 0!==vk?vk:"undefined"!=typeof document?document:void 0}function yk(e){return!!e.listen}var mk={createRenderer:function(e,t){return gk()}};function kk(e){for(;Array.isArray(e);)e=e[0];return e}function Ck(e,t){return kk(t[e])}function wk(e,t){return kk(t[e.index])}function _k(e,t){return e.data[t]}function Ek(e,t){return e[t]}function bk(e,t){var n=t[e];return Jm(n)?n:n[0]}function Pk(e){return 4==(4&e[2])}function Sk(e){return 128==(128&e[2])}function Ok(e,t){return null==t?null:e[t]}function Tk(e){e[18]=0}function Ik(e,t){e[5]+=t;for(var n=e,r=e[3];null!==r&&(1===t&&1===n[5]||-1===t&&0===n[5]);)r[5]+=t,n=r,r=r[3]}var Ak={lFrame:nC(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Rk(){return Ak.bindingsEnabled}function Mk(){return Ak.lFrame.lView}function xk(){return Ak.lFrame.tView}function Nk(e){return Ak.lFrame.contextLView=e,e[8]}function Dk(){for(var e=Lk();null!==e&&64===e.type;)e=e.parent;return e}function Lk(){return Ak.lFrame.currentTNode}function Fk(){var e=Ak.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}function Uk(e,t){var n=Ak.lFrame;n.currentTNode=e,n.isParent=t}function Vk(){return Ak.lFrame.isParent}function Bk(){Ak.lFrame.isParent=!1}function zk(){return Ak.isInCheckNoChangesMode}function Hk(e){Ak.isInCheckNoChangesMode=e}function Gk(){var e=Ak.lFrame,t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function $k(){return Ak.lFrame.bindingIndex}function Zk(){return Ak.lFrame.bindingIndex++}function qk(e){var t=Ak.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function Wk(e){Ak.lFrame.inI18n=e}function jk(e,t){var n=Ak.lFrame;n.bindingIndex=n.bindingRootIndex=e,Yk(t)}function Yk(e){Ak.lFrame.currentDirectiveIndex=e}function Kk(){return Ak.lFrame.currentQueryIndex}function Qk(e){Ak.lFrame.currentQueryIndex=e}function Xk(e){var t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function Jk(e,t,n){if(n&Em.SkipSelf){for(var r=t,i=e;!(null!==(r=r.parent)||n&Em.Host||(r=Xk(i),null===r||(i=i[15],10&r.type))););if(null===r)return!1;t=r,e=i}var a=Ak.lFrame=tC();return a.currentTNode=t,a.lView=e,!0}function eC(e){var t=tC(),n=e[1];Ak.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function tC(){var e=Ak.lFrame,t=null===e?null:e.child;return null===t?nC(e):t}function nC(e){var t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function rC(){var e=Ak.lFrame;return Ak.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}var iC=rC;function aC(){var e=rC();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function oC(){return Ak.lFrame.selectedIndex}function sC(e){Ak.lFrame.selectedIndex=e}function uC(){var e=Ak.lFrame;return _k(e.tView,e.selectedIndex)}function cC(){Ak.lFrame.currentNamespace=pk}function lC(e,t){for(var n=t.directiveStart,r=t.directiveEnd;n<r;n++){var i=e.data[n].type.prototype,a=i.ngAfterContentInit,o=i.ngAfterContentChecked,s=i.ngAfterViewInit,u=i.ngAfterViewChecked,c=i.ngOnDestroy;a&&(e.contentHooks||(e.contentHooks=[])).push(-n,a),o&&((e.contentHooks||(e.contentHooks=[])).push(n,o),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,o)),s&&(e.viewHooks||(e.viewHooks=[])).push(-n,s),u&&((e.viewHooks||(e.viewHooks=[])).push(n,u),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,u)),null!=c&&(e.destroyHooks||(e.destroyHooks=[])).push(n,c)}}function fC(e,t,n){vC(e,t,3,n)}function hC(e,t,n,r){(3&e[2])===n&&vC(e,t,n,r)}function dC(e,t){var n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function vC(e,t,n,r){for(var i=null!=r?r:-1,a=t.length-1,o=0,s=void 0!==r?65535&e[18]:0;s<a;s++)if("number"==typeof t[s+1]){if(o=t[s],null!=r&&o>=r)break}else t[s]<0&&(e[18]+=65536),(o<i||-1==i)&&(pC(e,n,t,s),e[18]=(4294901760&e[18])+s+2),s++}function pC(e,t,n,r){var i=n[r]<0,a=n[r+1],o=e[i?-n[r]:n[r]];if(i){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{a.call(o)}finally{}}}else try{a.call(o)}finally{}}var gC=Wg(function e(t,n,r){Zg(this,e),this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r});function yC(e,t,n){for(var r=yk(e),i=0;i<n.length;){var a=n[i];if("number"==typeof a){if(0!==a)break;i++;var o=n[i++],s=n[i++],u=n[i++];r?e.setAttribute(t,s,u,o):t.setAttributeNS(o,s,u)}else{var c=a,l=n[++i];kC(c)?r&&e.setProperty(t,c,l):r?e.setAttribute(t,c,l):t.setAttribute(c,l),i++}}return i}function mC(e){return 3===e||4===e||6===e}function kC(e){return 64===e.charCodeAt(0)}function CC(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else for(var n=-1,r=0;r<t.length;r++){var i=t[r];"number"==typeof i?n=i:0===n||wC(e,n,i,null,-1===n||2===n?t[++r]:null)}return e}function wC(e,t,n,r,i){var a=0,o=e.length;if(-1===t)o=-1;else for(;a<e.length;){var s=e[a++];if("number"==typeof s){if(s===t){o=-1;break}if(s>t){o=a-1;break}}}for(;a<e.length;){var u=e[a];if("number"==typeof u)break;if(u===n){if(null===r)return void(null!==i&&(e[a+1]=i));if(r===e[a+1])return void(e[a+2]=i)}a++,null!==r&&a++,null!==i&&a++}-1!==o&&(e.splice(o,0,t),a=o+1),e.splice(a++,0,n),null!==r&&e.splice(a++,0,r),null!==i&&e.splice(a++,0,i)}function _C(e){return-1!==e}function EC(e){return 32767&e}function bC(e,t){for(var n=function(e){return e>>16}(e),r=t;n>0;)r=r[15],n--;return r}var PC=!0;function SC(e){var t=PC;return PC=e,t}var OC=0;function TC(e,t){var n=AC(e,t);if(-1!==n)return n;var r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,IC(r.data,e),IC(t,null),IC(r.blueprint,null));var i=RC(e,t),a=e.injectorIndex;if(_C(i))for(var o=EC(i),s=bC(i,t),u=s[1].data,c=0;c<8;c++)t[a+c]=s[o+c]|u[o+c];return t[a+8]=i,a}function IC(e,t){e.push(0,0,0,0,0,0,0,0,t)}function AC(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function RC(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;for(var n=0,r=null,i=t;null!==i;){var a=i[1],o=a.type;if(null===(r=2===o?a.declTNode:1===o?i[6]:null))return-1;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function MC(e,t,n){!function(e,t,n){var r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(zm)&&(r=n[zm]),null==r&&(r=n[zm]=OC++);var i=255&r;t.data[e+(i>>5)]|=1<<i}(e,t,n)}function xC(e,t,n){if(n&Em.Optional)return e;fm(t,"NodeInjector")}function NC(e,t,n,r){if(n&Em.Optional&&void 0===r&&(r=null),0==(n&(Em.Self|Em.Host))){var i=e[9],a=bm(void 0);try{return i?i.get(t,r,n&Em.Optional):Pm(t,r,n&Em.Optional)}finally{bm(a)}}return xC(r,t,n)}function DC(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Em.Default,i=arguments.length>4?arguments[4]:void 0;if(null!==e){var a=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;var t=e.hasOwnProperty(zm)?e[zm]:void 0;return"number"==typeof t?t>=0?255&t:FC:t}(n);if("function"==typeof a){if(!Jk(t,e,r))return r&Em.Host?xC(i,n,r):NC(t,n,r,i);try{var o=a(r);if(null!=o||r&Em.Optional)return o;fm(n)}finally{iC()}}else if("number"==typeof a){var s=null,u=AC(e,t),c=-1,l=r&Em.Host?t[16][6]:null;for((-1===u||r&Em.SkipSelf)&&(-1!==(c=-1===u?RC(e,t):t[u+8])&&HC(r,!1)?(s=t[1],u=EC(c),t=bC(c,t)):u=-1);-1!==u;){var f=t[1];if(zC(a,u,f.data)){var h=UC(u,t,n,s,r,l);if(h!==LC)return h}-1!==(c=t[u+8])&&HC(r,t[1].data[u+8]===l)&&zC(a,u,t)?(s=f,u=EC(c),t=bC(c,t)):u=-1}}}return NC(t,n,r,i)}var LC={};function FC(){return new GC(Dk(),Mk())}function UC(e,t,n,r,i,a){var o=t[1],s=o.data[e+8],u=VC(s,o,n,null==r?nk(s)&&PC:r!=o&&0!=(3&s.type),i&Em.Host&&a===s);return null!==u?BC(t,o,u,s):LC}function VC(e,t,n,r,i){for(var a=e.providerIndexes,o=t.data,s=1048575&a,u=e.directiveStart,c=a>>20,l=i?s+c:e.directiveEnd,f=r?s:s+c;f<l;f++){var h=o[f];if(f<u&&n===h||f>=u&&h.type===n)return f}if(i){var d=o[u];if(d&&ik(d)&&d.type===n)return u}return null}function BC(e,t,n,r){var i=e[n],a=t.data;if(function(e){return e instanceof gC}(i)){var o=i;o.resolving&&function(e,t){throw new um("200","Circular dependency in DI detected for ".concat(e))}(lm(a[n]));var s=SC(o.canSeeViewProviders);o.resolving=!0;var u=o.injectImpl?bm(o.injectImpl):null;Jk(e,r,Em.Default);try{i=e[n]=o.factory(void 0,a,e,r),t.firstCreatePass&&n>=r.directiveStart&&function(e,t,n){var r=t.type.prototype,i=r.ngOnChanges,a=r.ngOnInit,o=r.ngDoCheck;if(i){var s=ck(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s)}a&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,a),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,o))}(n,a[n],t)}finally{null!==u&&bm(u),SC(s),o.resolving=!1,iC()}}return i}function zC(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function HC(e,t){return!(e&Em.Self||e&Em.Host&&t)}var GC=function(){function e(t,n){Zg(this,e),this._tNode=t,this._lView=n}return Wg(e,[{key:"get",value:function(e,t,n){return DC(this._tNode,this._lView,e,n,t)}}]),e}();function $C(e){return Sm(function(){for(var t=e.prototype.constructor,n=t[Bm]||ZC(t),r=Object.prototype,i=Object.getPrototypeOf(e.prototype).constructor;i&&i!==r;){var a=i[Bm]||ZC(i);if(a&&a!==n)return a;i=Object.getPrototypeOf(i)}return function(e){return new e}})}function ZC(e){return sm(e)?function(){var t=ZC(om(e));return t&&t()}:ok(e)}function qC(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;var n=e.attrs;if(n)for(var r=n.length,i=0;i<r;){var a=n[i];if(mC(a))break;if(0===a)i+=2;else if("number"==typeof a)for(i++;i<r&&"string"==typeof n[i];)i++;else{if(a===t)return n[i+1];i+=2}}return null}(Dk(),e)}var WC="__parameters__";function jC(e,t,n){return Sm(function(){var r=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var n in t)this[n]=t[n]}}}(t);function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this instanceof i)return r.apply(this,t),this;var a=Ag(i,t);return o.annotation=a,o;function o(e,t,n){for(var r=e.hasOwnProperty(WC)?e[WC]:Object.defineProperty(e,WC,{value:[]})[WC];r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(a),e}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i})}var YC=function(){function e(t,n){Zg(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=dm({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return Wg(e,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),e}(),KC=new YC("AnalyzeForEntryComponents"),QC=Function;function XC(e,t){void 0===t&&(t=e);for(var n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?(t===e&&(t=e.slice(0,n)),XC(r,t)):t!==e&&t.push(r)}return t}function JC(e,t){e.forEach(function(e){return Array.isArray(e)?JC(e,t):t(e)})}function ew(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function tw(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function nw(e,t){for(var n=[],r=0;r<e;r++)n.push(t);return n}function rw(e,t,n){var r=aw(e,t);return r>=0?e[1|r]=n:function(e,t,n,r){var i=e.length;if(i==t)e.push(n,r);else if(1===i)e.push(r,e[0]),e[0]=n;else{for(i--,e.push(e[i-1],e[i]);i>t;)e[i]=e[i-2],i--;e[t]=n,e[t+1]=r}}(e,r=~r,t,n),r}function iw(e,t){var n=aw(e,t);if(n>=0)return e[1|n]}function aw(e,t){return function(e,t,n){for(var r=0,i=e.length>>1;i!==r;){var a=r+(i-r>>1),o=e[a<<1];if(t===o)return a<<1;o>t?i=a:r=a+1}return~(i<<1)}(e,t)}var ow,sw={},uw="__NG_DI_FLAG__",cw="ngTempTokenPath",lw=/\n/gm,fw="__source",hw=em({provide:String,useValue:em});function dw(e){var t=ow;return ow=e,t}function vw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Em.Default;if(void 0===ow)throw new Error("inject() must be called from an injection context");return null===ow?Pm(e,void 0,t):ow.get(e,t&Em.Optional?null:void 0,t)}function pw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Em.Default;return(mm||vw)(om(e),t)}function gw(e){for(var t=[],n=0;n<e.length;n++){var r=om(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");for(var i=void 0,a=Em.Default,o=0;o<r.length;o++){var s=r[o],u=mw(s);"number"==typeof u?-1===u?i=s.token:a|=u:i=s}t.push(pw(i,a))}else t.push(pw(r))}return t}function yw(e,t){return e[uw]=t,e.prototype[uw]=t,e}function mw(e){return e[uw]}function kw(e,t,n,r){var i=e[cw];throw t[fw]&&i.unshift(t[fw]),e.message=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;var i=nm(t);if(Array.isArray(t))i=t.map(nm).join(" -> ");else if("object"==typeof t){var a=[];for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];a.push(o+":"+("string"==typeof s?JSON.stringify(s):nm(s)))}i="{".concat(a.join(", "),"}")}return"".concat(n).concat(r?"("+r+")":"","[").concat(i,"]: ").concat(e.replace(lw,"\n  "))}("\n"+e.message,i,n,r),e.ngTokenPath=i,e[cw]=null,e}var Cw,ww,_w=yw(jC("Inject",function(e){return{token:e}}),-1),Ew=yw(jC("Optional"),8),bw=yw(jC("SkipSelf"),4);function Pw(e){var t;return(null===(t=function(){if(void 0===Cw&&(Cw=null,Mm.trustedTypes))try{Cw=Mm.trustedTypes.createPolicy("angular",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return Cw}())||void 0===t?void 0:t.createHTML(e))||e}function Sw(e){var t;return(null===(t=function(){if(void 0===ww&&(ww=null,Mm.trustedTypes))try{ww=Mm.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return ww}())||void 0===t?void 0:t.createHTML(e))||e}var Ow=function(){function e(t){Zg(this,e),this.changingThisBreaksApplicationSecurity=t}return Wg(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity," (see https://g.co/ng/security#xss)")}}]),e}(),Tw=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getTypeName",value:function(){return"HTML"}}]),n}(Ow),Iw=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getTypeName",value:function(){return"Style"}}]),n}(Ow),Aw=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getTypeName",value:function(){return"Script"}}]),n}(Ow),Rw=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getTypeName",value:function(){return"URL"}}]),n}(Ow),Mw=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getTypeName",value:function(){return"ResourceURL"}}]),n}(Ow);function xw(e){return e instanceof Ow?e.changingThisBreaksApplicationSecurity:e}function Nw(e,t){var n=Dw(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error("Required a safe ".concat(t,", got a ").concat(n," (see https://g.co/ng/security#xss)"))}return n===t}function Dw(e){return e instanceof Ow&&e.getTypeName()||null}function Lw(e){var t=new Uw(e);return function(){try{return!!(new window.DOMParser).parseFromString(Pw(""),"text/html")}catch(e){return!1}}()?new Fw(t):t}var Fw=function(){function e(t){Zg(this,e),this.inertDocumentHelper=t}return Wg(e,[{key:"getInertBodyElement",value:function(e){e="<body><remove></remove>"+e;try{var t=(new window.DOMParser).parseFromString(Pw(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(n){return null}}}]),e}(),Uw=function(){function e(t){if(Zg(this,e),this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){var n=this.inertDocument.createElement("html");this.inertDocument.appendChild(n);var r=this.inertDocument.createElement("body");n.appendChild(r)}}return Wg(e,[{key:"getInertBodyElement",value:function(e){var t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=Pw(e),t;var n=this.inertDocument.createElement("body");return n.innerHTML=Pw(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}},{key:"stripCustomNsAttrs",value:function(e){for(var t=e.attributes,n=t.length-1;0<n;n--){var r=t.item(n).name;("xmlns:ns1"===r||0===r.indexOf("ns1:"))&&e.removeAttribute(r)}for(var i=e.firstChild;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}]),e}(),Vw=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Bw=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function zw(e){return(e=String(e)).match(Vw)||e.match(Bw)?e:"unsafe:"+e}function Hw(e){return(e=String(e)).split(",").map(function(e){return zw(e.trim())}).join(", ")}function Gw(e){var t,n={},r=Hg(e.split(","));try{for(r.s();!(t=r.n()).done;){n[t.value]=!0}}catch(i){r.e(i)}finally{r.f()}return n}function $w(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];for(var s in o)o.hasOwnProperty(s)&&(e[s]=!0)}return e}var Zw,qw=Gw("area,br,col,hr,img,wbr"),Ww=Gw("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),jw=Gw("rp,rt"),Yw=$w(qw,$w(Ww,Gw("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),$w(jw,Gw("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),$w(jw,Ww)),Kw=Gw("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Qw=Gw("srcset"),Xw=$w(Kw,Qw,Gw("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Gw("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Jw=Gw("script,style,template"),e_=function(){function e(){Zg(this,e),this.sanitizedSomething=!1,this.buf=[]}return Wg(e,[{key:"sanitizeChildren",value:function(e){for(var t=e.firstChild,n=!0;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);var r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(e){var t=e.nodeName.toLowerCase();if(!Yw.hasOwnProperty(t))return this.sanitizedSomething=!0,!Jw.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);for(var n=e.attributes,r=0;r<n.length;r++){var i=n.item(r),a=i.name,o=a.toLowerCase();if(Xw.hasOwnProperty(o)){var s=i.value;Kw[o]&&(s=zw(s)),Qw[o]&&(s=Hw(s)),this.buf.push(" ",a,'="',r_(s),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(e){var t=e.nodeName.toLowerCase();Yw.hasOwnProperty(t)&&!qw.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}},{key:"chars",value:function(e){this.buf.push(r_(e))}},{key:"checkClobberedElement",value:function(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: ".concat(e.outerHTML));return t}}]),e}(),t_=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,n_=/([^\#-~ |!])/g;function r_(e){return e.replace(/&/g,"&amp;").replace(t_,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(n_,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function i_(e,t){var n=null;try{Zw=Zw||Lw(e);var r=t?String(t):"";n=Zw.getInertBodyElement(r);var i=5,a=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=a,a=n.innerHTML,n=Zw.getInertBodyElement(r)}while(r!==a);return Pw((new e_).sanitizeChildren(a_(n)||n))}finally{if(n)for(var o=a_(n)||n;o.firstChild;)o.removeChild(o.firstChild)}}function a_(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var o_=((o_=o_||{})[o_.NONE=0]="NONE",o_[o_.HTML=1]="HTML",o_[o_.STYLE=2]="STYLE",o_[o_.SCRIPT=3]="SCRIPT",o_[o_.URL=4]="URL",o_[o_.RESOURCE_URL=5]="RESOURCE_URL",o_);function s_(e){var t=c_();return t?Sw(t.sanitize(o_.HTML,e)||""):Nw(e,"HTML")?Sw(xw(e)):i_(gk(),cm(e))}function u_(e){var t=c_();return t?t.sanitize(o_.URL,e)||"":Nw(e,"URL")?xw(e):zw(cm(e))}function c_(){var e=Mk();return e&&e[12]}var l_="__ngContext__";function f_(e,t){e[l_]=t}function h_(e){var t=function(e){return e[l_]||null}(e);return t?Array.isArray(t)?t:t.lView:null}function d_(e){return e.ngOriginalError}function v_(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.error.apply(e,n)}var p_=function(){function e(){Zg(this,e),this._console=console}return Wg(e,[{key:"handleError",value:function(e){var t,n=this._findOriginalError(e),r=this._findContext(e),i=(t=e)&&t.ngErrorLogger||v_;i(this._console,"ERROR",e),n&&i(this._console,"ORIGINAL ERROR",n),r&&i(this._console,"ERROR CONTEXT",r)}},{key:"_findContext",value:function(e){return e?e.ngDebugContext||this._findContext(d_(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=e&&d_(e);t&&d_(t);)t=d_(t);return t||null}}]),e}(),g_=/^>|^->|<!--|-->|--!>|<!-$/g,y_=/(<|>)/,m_=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Mm);function k_(e){return e instanceof Function?e():e}var C_,w_=((w_=w_||{})[w_.Important=1]="Important",w_[w_.DashCase=2]="DashCase",w_);function __(e,t){return C_(e,t)}function E_(e){var t=e[3];return ek(t)?t[3]:t}function b_(e){return S_(e[13])}function P_(e){return S_(e[4])}function S_(e){for(;null!==e&&!ek(e);)e=e[4];return e}function O_(e,t,n,r,i){if(null!=r){var a,o=!1;ek(r)?a=r:Jm(r)&&(o=!0,r=r[0]);var s=kk(r);0===e&&null!==n?null==i?V_(t,n,s):U_(t,n,s,i||null,!0):1===e&&null!==n?U_(t,n,s,i||null,!0):2===e?Q_(t,s,o):3===e&&t.destroyNode(s),null!=a&&function(e,t,n,r,i){var a=n[7];a!==kk(n)&&O_(t,e,r,a,i);for(var o=10;o<n.length;o++){var s=n[o];J_(s[1],s,e,t,r,a)}}(t,e,a,n,i)}}function T_(e,t){return yk(e)?e.createText(t):e.createTextNode(t)}function I_(e,t,n){yk(e)?e.setValue(t,n):t.textContent=n}function A_(e,t){return e.createComment(function(e){return e.replace(g_,function(e){return e.replace(y_,"\u200b$1\u200b")})}(t))}function R_(e,t,n){return yk(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function M_(e,t){var n=e[9],r=n.indexOf(t),i=t[3];1024&t[2]&&(t[2]&=-1025,Ik(i,-1)),n.splice(r,1)}function x_(e,t){if(!(e.length<=10)){var n=10+t,r=e[n];if(r){var i=r[17];null!==i&&i!==e&&M_(i,r),t>0&&(e[n-1][4]=r[4]);var a=tw(e,10+t);!function(e,t){J_(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);var o=a[19];null!==o&&o.detachView(a[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}}function N_(e,t){if(!(256&t[2])){var n=t[11];yk(n)&&n.destroyNode&&J_(e,t,n,3,null,null),function(e){var t=e[13];if(!t)return D_(e[1],e);for(;t;){var n=null;if(Jm(t))n=t[13];else{var r=t[10];r&&(n=r)}if(!n){for(;t&&!t[4]&&t!==e;)Jm(t)&&D_(t[1],t),t=t[3];null===t&&(t=e),Jm(t)&&D_(t[1],t),n=t&&t[4]}t=n}}(t)}}function D_(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){var n;if(null!=e&&null!=(n=e.destroyHooks))for(var r=0;r<n.length;r+=2){var i=t[n[r]];if(!(i instanceof gC)){var a=n[r+1];if(Array.isArray(a))for(var o=0;o<a.length;o+=2){var s=i[a[o]],u=a[o+1];try{u.call(s)}finally{}}else try{a.call(i)}finally{}}}}(e,t),function(e,t){var n=e.cleanup,r=t[7],i=-1;if(null!==n)for(var a=0;a<n.length-1;a+=2)if("string"==typeof n[a]){var o=n[a+1],s="function"==typeof o?o(t):kk(t[o]),u=r[i=n[a+2]],c=n[a+3];"boolean"==typeof c?s.removeEventListener(n[a],u,c):c>=0?r[i=c]():r[i=-c].unsubscribe(),a+=2}else{var l=r[i=n[a+1]];n[a].call(l)}if(null!==r){for(var f=i+1;f<r.length;f++)r[f]();t[7]=null}}(e,t),1===t[1].type&&yk(t[11])&&t[11].destroy();var n=t[17];if(null!==n&&ek(t[3])){n!==t[3]&&M_(n,t);var r=t[19];null!==r&&r.detachView(e)}}}function L_(e,t,n){return F_(e,t.parent,n)}function F_(e,t,n){for(var r=t;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[0];if(2&r.flags){var i=e.data[r.directiveStart].encapsulation;if(i===Tm.None||i===Tm.Emulated)return null}return wk(r,n)}function U_(e,t,n,r,i){yk(e)?e.insertBefore(t,n,r,i):t.insertBefore(n,r,i)}function V_(e,t,n){yk(e)?e.appendChild(t,n):t.appendChild(n)}function B_(e,t,n,r,i){null!==r?U_(e,t,n,r,i):V_(e,t,n)}function z_(e,t){return yk(e)?e.parentNode(t):t.parentNode}function H_(e,t,n){return Z_(e,t,n)}function G_(e,t,n){return 40&e.type?wk(e,n):null}var $_,Z_=G_;function q_(e,t){Z_=e,$_=t}function W_(e,t,n,r){var i=L_(e,r,t),a=t[11],o=H_(r.parent||t[6],r,t);if(null!=i)if(Array.isArray(n))for(var s=0;s<n.length;s++)B_(a,i,n[s],o,!1);else B_(a,i,n,o,!1);void 0!==$_&&$_(a,r,t,n,i)}function j_(e,t){if(null!==t){var n=t.type;if(3&n)return wk(t,e);if(4&n)return K_(-1,e[t.index]);if(8&n){var r=t.child;if(null!==r)return j_(e,r);var i=e[t.index];return ek(i)?K_(-1,i):kk(i)}if(32&n)return __(t,e)()||kk(e[t.index]);var a=Y_(e,t);return null!==a?Array.isArray(a)?a[0]:j_(E_(e[16]),a):j_(e,t.next)}return null}function Y_(e,t){return null!==t?e[16][6].projection[t.projection]:null}function K_(e,t){var n=10+e+1;if(n<t.length){var r=t[n],i=r[1].firstChild;if(null!==i)return j_(r,i)}return t[7]}function Q_(e,t,n){var r=z_(e,t);r&&function(e,t,n,r){yk(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}function X_(e,t,n,r,i,a,o){for(;null!=n;){var s=r[n.index],u=n.type;if(o&&0===t&&(s&&f_(kk(s),r),n.flags|=4),64!=(64&n.flags))if(8&u)X_(e,t,n.child,r,i,a,!1),O_(t,e,i,s,a);else if(32&u){for(var c=__(n,r),l=void 0;l=c();)O_(t,e,i,l,a);O_(t,e,i,s,a)}else 16&u?eE(e,t,r,n,i,a):O_(t,e,i,s,a);n=o?n.projectionNext:n.next}}function J_(e,t,n,r,i,a){X_(n,r,e.firstChild,t,i,a,!1)}function eE(e,t,n,r,i,a){var o=n[16],s=o[6].projection[r.projection];if(Array.isArray(s))for(var u=0;u<s.length;u++)O_(t,e,i,s[u],a);else X_(e,t,s,o[3],i,a,!0)}function tE(e,t,n){yk(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function nE(e,t,n){yk(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function rE(e,t,n){for(var r=e.length;;){var i=e.indexOf(t,n);if(-1===i)return i;if(0===i||e.charCodeAt(i-1)<=32){var a=t.length;if(i+a===r||e.charCodeAt(i+a)<=32)return i}n=i+1}}var iE="ng-template";function aE(e,t,n){for(var r=0;r<e.length;){var i=e[r++];if(n&&"class"===i){if(-1!==rE((i=e[r]).toLowerCase(),t,0))return!0}else if(1===i){for(;r<e.length&&"string"==typeof(i=e[r++]);)if(i.toLowerCase()===t)return!0;return!1}}return!1}function oE(e){return 4===e.type&&e.value!==iE}function sE(e,t,n){return t===(4!==e.type||n?e.value:iE)}function uE(e,t,n){for(var r=4,i=e.attrs||[],a=function(e){for(var t=0;t<e.length;t++)if(mC(e[t]))return t;return e.length}(i),o=!1,s=0;s<t.length;s++){var u=t[s];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!sE(e,u,n)||""===u&&1===t.length){if(cE(r))return!1;o=!0}}else{var c=8&r?u:t[++s];if(8&r&&null!==e.attrs){if(!aE(e.attrs,c,n)){if(cE(r))return!1;o=!0}continue}var l=lE(8&r?"class":u,i,oE(e),n);if(-1===l){if(cE(r))return!1;o=!0;continue}if(""!==c){var f;f=l>a?"":i[l+1].toLowerCase();var h=8&r?f:null;if(h&&-1!==rE(h,c,0)||2&r&&c!==f){if(cE(r))return!1;o=!0}}}}else{if(!o&&!cE(r)&&!cE(u))return!1;if(o&&cE(u))continue;o=!1,r=u|1&r}}return cE(r)||o}function cE(e){return 0==(1&e)}function lE(e,t,n,r){if(null===t)return-1;var i=0;if(r||!n){for(var a=!1;i<t.length;){var o=t[i];if(o===e)return i;if(3===o||6===o)a=!0;else{if(1===o||2===o){for(var s=t[++i];"string"==typeof s;)s=t[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=a?1:2}return-1}return function(e,t){var n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){var r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function fE(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0;r<t.length;r++)if(uE(e,t[r],n))return!0;return!1}function hE(e,t){return e?":not("+t.trim()+")":t}function dE(e){for(var t=e[0],n=1,r=2,i="",a=!1;n<e.length;){var o=e[n];if("string"==typeof o)if(2&r){var s=e[++n];i+="["+o+(s.length>0?'="'+s+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!cE(o)&&(t+=hE(a,i),i=""),r=o,a=a||!cE(r);n++}return""!==i&&(t+=hE(a,i)),t}var vE={};function pE(e){gE(xk(),Mk(),oC()+e,zk())}function gE(e,t,n,r){if(!r)if(3==(3&t[2])){var i=e.preOrderCheckHooks;null!==i&&fC(t,i,n)}else{var a=e.preOrderHooks;null!==a&&hC(t,a,0,n)}sC(n)}function yE(e,t){return e<<17|t<<2}function mE(e){return e>>17&32767}function kE(e){return 2|e}function CE(e){return(131068&e)>>2}function wE(e,t){return-131069&e|t<<2}function _E(e){return 1|e}function EE(e,t){var n=e.contentQueries;if(null!==n)for(var r=0;r<n.length;r+=2){var i=n[r],a=n[r+1];if(-1!==a){var o=e.data[a];Qk(i),o.contentQueries(2,t[a],a)}}}function bE(e,t,n,r,i,a,o,s,u,c){var l=t.blueprint.slice();return l[0]=i,l[2]=140|r,Tk(l),l[3]=l[15]=e,l[8]=n,l[10]=o||e&&e[10],l[11]=s||e&&e[11],l[12]=u||e&&e[12]||null,l[9]=c||e&&e[9]||null,l[6]=a,l[16]=2==t.type?e[16]:l,l}function PE(e,t,n,r,i){var a=e.data[t];if(null===a)a=SE(e,t,n,r,i),Ak.lFrame.inI18n&&(a.flags|=64);else if(64&a.type){a.type=n,a.value=r,a.attrs=i;var o=Fk();a.injectorIndex=null===o?-1:o.injectorIndex}return Uk(a,!0),a}function SE(e,t,n,r,i){var a=Lk(),o=Vk(),s=e.data[t]=function(e,t,n,r,i,a){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:a,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?a:a&&a.parent,n,t,r,i);return null===e.firstChild&&(e.firstChild=s),null!==a&&(o?null==a.child&&null!==s.parent&&(a.child=s):null===a.next&&(a.next=s)),s}function OE(e,t,n,r){if(0===n)return-1;for(var i=t.length,a=0;a<n;a++)t.push(r),e.blueprint.push(r),e.data.push(null);return i}function TE(e,t,n){eC(t);try{var r=e.viewQuery;null!==r&&ob(1,r,n);var i=e.template;null!==i&&RE(e,t,i,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&EE(e,t),e.staticViewQueries&&ob(2,e.viewQuery,n);var a=e.components;null!==a&&function(e,t){for(var n=0;n<t.length;n++)tb(e,t[n])}(t,a)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[2]&=-5,aC()}}function IE(e,t,n,r){var i=t[2];if(256!=(256&i)){eC(t);var a=zk();try{Tk(t),function(e){Ak.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&RE(e,t,n,2,r);var o=3==(3&i);if(!a)if(o){var s=e.preOrderCheckHooks;null!==s&&fC(t,s,null)}else{var u=e.preOrderHooks;null!==u&&hC(t,u,0,null),dC(t,0)}if(function(e){for(var t=b_(e);null!==t;t=P_(t))if(t[2])for(var n=t[9],r=0;r<n.length;r++){var i=n[r],a=i[3];0==(1024&i[2])&&Ik(a,1),i[2]|=1024}}(t),function(e){for(var t=b_(e);null!==t;t=P_(t))for(var n=10;n<t.length;n++){var r=t[n],i=r[1];Sk(r)&&IE(i,r,i.template,r[8])}}(t),null!==e.contentQueries&&EE(e,t),!a)if(o){var c=e.contentCheckHooks;null!==c&&fC(t,c)}else{var l=e.contentHooks;null!==l&&hC(t,l,1),dC(t,1)}!function(e,t){var n=e.hostBindingOpCodes;if(null!==n)try{for(var r=0;r<n.length;r++){var i=n[r];if(i<0)sC(~i);else{var a=i,o=n[++r],s=n[++r];jk(o,a),s(2,t[a])}}}finally{sC(-1)}}(e,t);var f=e.components;null!==f&&function(e,t){for(var n=0;n<t.length;n++)JE(e,t[n])}(t,f);var h=e.viewQuery;if(null!==h&&ob(2,h,r),!a)if(o){var d=e.viewCheckHooks;null!==d&&fC(t,d)}else{var v=e.viewHooks;null!==v&&hC(t,v,2),dC(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),a||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,Ik(t[3],-1))}finally{aC()}}}function AE(e,t,n,r){var i=t[10],a=!zk(),o=Pk(t);try{a&&!o&&i.begin&&i.begin(),o&&TE(e,t,r),IE(e,t,n,r)}finally{a&&!o&&i.end&&i.end()}}function RE(e,t,n,r,i){var a=oC(),o=2&r;try{sC(-1),o&&t.length>20&&gE(e,t,20,zk()),n(r,i)}finally{sC(a)}}function ME(e,t,n){if(tk(t))for(var r=t.directiveEnd,i=t.directiveStart;i<r;i++){var a=e.data[i];a.contentQueries&&a.contentQueries(1,n[i],i)}}function xE(e,t,n){!Rk()||(function(e,t,n,r){var i=n.directiveStart,a=n.directiveEnd;e.firstCreatePass||TC(n,t),f_(r,t);for(var o=n.initialInputs,s=i;s<a;s++){var u=e.data[s],c=ik(u);c&&WE(t,n,u);var l=BC(t,e,s,n);f_(l,t),null!==o&&KE(0,s-i,l,u,0,o),c&&(bk(n.index,t)[8]=l)}}(e,t,n,wk(n,t)),128==(128&n.flags)&&function(e,t,n){var r=n.directiveStart,i=n.directiveEnd,a=n.index,o=Ak.lFrame.currentDirectiveIndex;try{sC(a);for(var s=r;s<i;s++){var u=e.data[s],c=t[s];Yk(s),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&HE(u,c)}}finally{sC(-1),Yk(o)}}(e,t,n))}function NE(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wk,r=t.localNames;if(null!==r)for(var i=t.index+1,a=0;a<r.length;a+=2){var o=r[a+1],s=-1===o?n(t,e):e[o];e[i++]=s}}function DE(e){var t=e.tView;return null===t||t.incompleteFirstPass?e.tView=LE(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function LE(e,t,n,r,i,a,o,s,u,c){var l=20+r,f=l+i,h=function(e,t){for(var n=[],r=0;r<t;r++)n.push(r<e?null:vE);return n}(l,f),d="function"==typeof c?c():c;return h[1]={type:e,blueprint:h,template:n,queries:null,viewQuery:s,declTNode:t,data:h.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof a?a():a,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:d,incompleteFirstPass:!1}}function FE(e,t,n,r){var i=ub(t);null===n?i.push(r):(i.push(n),e.firstCreatePass&&cb(e).push(r,i.length-1))}function UE(e,t,n){for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,i):n[r]=[t,i]}return n}function VE(e,t,n,r,i,a,o,s){var u,c=wk(t,n),l=t.inputs;!s&&null!=l&&(u=l[r])?(fb(e,n,u,r,i),nk(t)&&function(e,t){var n=bk(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(r=function(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(r),i=null!=o?o(i,t.value||"",r):i,yk(a)?a.setProperty(c,r,i):kC(r)||(c.setProperty?c.setProperty(r,i):c[r]=i))}function BE(e,t,n,r){var i=!1;if(Rk()){var a=function(e,t,n){var r=e.directiveRegistry,i=null;if(r)for(var a=0;a<r.length;a++){var o=r[a];fE(n,o.selectors,!1)&&(i||(i=[]),MC(TC(n,t),e,o.type),ik(o)?(GE(e,n),i.unshift(o)):i.push(o))}return i}(e,t,n),o=null===r?null:{"":-1};if(null!==a){i=!0,ZE(n,e.data.length,a.length);for(var s=0;s<a.length;s++){var u=a[s];u.providersResolver&&u.providersResolver(u)}for(var c=!1,l=!1,f=OE(e,t,a.length,null),h=0;h<a.length;h++){var d=a[h];n.mergedAttrs=CC(n.mergedAttrs,d.hostAttrs),qE(e,n,t,f,d),$E(f,d,o),null!==d.contentQueries&&(n.flags|=8),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(n.flags|=128);var v=d.type.prototype;!c&&(v.ngOnChanges||v.ngOnInit||v.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),c=!0),!l&&(v.ngOnChanges||v.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),l=!0),f++}!function(e,t){for(var n=t.directiveEnd,r=e.data,i=t.attrs,a=[],o=null,s=null,u=t.directiveStart;u<n;u++){var c=r[u],l=c.inputs,f=null===i||oE(t)?null:QE(l,i);a.push(f),o=UE(l,u,o),s=UE(c.outputs,u,s)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=a,t.inputs=o,t.outputs=s}(e,n)}o&&function(e,t,n){if(t)for(var r=e.localNames=[],i=0;i<t.length;i+=2){var a=n[t[i+1]];if(null==a)throw new um("301","Export of name '".concat(t[i+1],"' not found!"));r.push(t[i],a)}}(n,r,o)}return n.mergedAttrs=CC(n.mergedAttrs,n.attrs),i}function zE(e,t,n,r,i,a){var o=a.hostBindings;if(o){var s=e.hostBindingOpCodes;null===s&&(s=e.hostBindingOpCodes=[]);var u=~t.index;(function(e){for(var t=e.length;t>0;){var n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(s)!=u&&s.push(u),s.push(r,i,o)}}function HE(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function GE(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function $E(e,t,n){if(n){if(t.exportAs)for(var r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;ik(t)&&(n[""]=e)}}function ZE(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function qE(e,t,n,r,i){e.data[r]=i;var a=i.factory||(i.factory=ok(i.type)),o=new gC(a,ik(i),null);e.blueprint[r]=o,n[r]=o,zE(e,t,0,r,OE(e,n,i.hostVars,vE),i)}function WE(e,t,n){var r=wk(t,e),i=DE(n),a=e[10],o=nb(e,bE(e,i,null,n.onPush?64:16,r,t,a,a.createRenderer(r,n),null,null));e[t.index]=o}function jE(e,t,n,r,i,a){var o=wk(e,t);YE(t[11],o,a,e.value,n,r,i)}function YE(e,t,n,r,i,a,o){if(null==a)yk(e)?e.removeAttribute(t,i,n):t.removeAttribute(i);else{var s=null==o?cm(a):o(a,r||"",i);yk(e)?e.setAttribute(t,i,s,n):n?t.setAttributeNS(n,i,s):t.setAttribute(i,s)}}function KE(e,t,n,r,i,a){var o=a[t];if(null!==o)for(var s=r.setInput,u=0;u<o.length;){var c=o[u++],l=o[u++],f=o[u++];null!==s?r.setInput(n,f,c,l):n[l]=f}}function QE(e,t){for(var n=null,r=0;r<t.length;){var i=t[r];if(0!==i)if(5!==i){if("number"==typeof i)break;e.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,e[i],t[r+1])),r+=2}else r+=2;else r+=4}return n}function XE(e,t,n,r){return new Array(e,!0,!1,t,null,0,r,n,null,null)}function JE(e,t){var n=bk(t,e);if(Sk(n)){var r=n[1];80&n[2]?IE(r,n,r.template,n[8]):n[5]>0&&eb(n)}}function eb(e){for(var t=b_(e);null!==t;t=P_(t))for(var n=10;n<t.length;n++){var r=t[n];if(1024&r[2]){var i=r[1];IE(i,r,i.template,r[8])}else r[5]>0&&eb(r)}var a=e[1].components;if(null!==a)for(var o=0;o<a.length;o++){var s=bk(a[o],e);Sk(s)&&s[5]>0&&eb(s)}}function tb(e,t){var n=bk(t,e),r=n[1];(function(e,t){for(var n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])})(r,n),TE(r,n,n[8])}function nb(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function rb(e){for(;e;){e[2]|=64;var t=E_(e);if(ak(e)&&!t)return e;e=t}return null}function ib(e,t,n){var r=t[10];r.begin&&r.begin();try{IE(e,t,e.template,n)}catch(i){throw lb(t,i),i}finally{r.end&&r.end()}}function ab(e){!function(e){for(var t=0;t<e.components.length;t++){var n=e.components[t],r=h_(n),i=r[1];AE(i,r,i.template,n)}}(e[8])}function ob(e,t,n){Qk(0),t(e,n)}var sb=Promise.resolve(null);function ub(e){return e[7]||(e[7]=[])}function cb(e){return e.cleanup||(e.cleanup=[])}function lb(e,t){var n=e[9],r=n?n.get(p_,null):null;r&&r.handleError(t)}function fb(e,t,n,r,i){for(var a=0;a<n.length;){var o=n[a++],s=n[a++],u=t[o],c=e.data[o];null!==c.setInput?c.setInput(u,i,r,s):u[s]=i}}function hb(e,t,n){var r=Ck(t,e);I_(e[11],r,n)}function db(e,t,n){var r=n?e.styles:null,i=n?e.classes:null,a=0;if(null!==t)for(var o=0;o<t.length;o++){var s=t[o];"number"==typeof s?a=s:1==a?i=rm(i,s):2==a&&(r=rm(r,s+": "+t[++o]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=i:e.classesWithoutHost=i}var vb,pb=new YC("INJECTOR",-1),gb=function(){function e(){Zg(this,e)}return Wg(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sw;if(t===sw){var n=new Error("NullInjectorError: No provider for ".concat(nm(e),"!"));throw n.name="NullInjectorError",n}return t}}]),e}(),yb=new YC("Set Injector scope."),mb={},kb={};function Cb(){return void 0===vb&&(vb=new gb),vb}function wb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return new _b(e,n,t||Cb(),r)}var _b=function(){function e(t,n,r){var i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Zg(this,e),this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var o=[];n&&JC(n,function(e){return i.processProvider(e,t,n)}),JC([t],function(e){return i.processInjectorType(e,[],o)}),this.records.set(pb,Pb(void 0,this));var s=this.records.get(yb);this.scope=null!=s?s.value:null,this.source=a||("object"==typeof t?null:nm(t))}return Wg(e,[{key:"destroyed",get:function(){return this._destroyed}},{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(function(e){return e.ngOnDestroy()})}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sw,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Em.Default;this.assertNotDestroyed();var r,i=dw(this),a=bm(void 0);try{if(!(n&Em.SkipSelf)){var o=this.records.get(e);if(void 0===o){var s=("function"==typeof(r=e)||"object"==typeof r&&r instanceof YC)&&pm(e);o=s&&this.injectableDefInScope(s)?Pb(Eb(e),mb):null,this.records.set(e,o)}if(null!=o)return this.hydrate(e,o)}return(n&Em.Self?Cb():this.parent).get(e,t=n&Em.Optional&&t===sw?null:t)}catch(u){if("NullInjectorError"===u.name){if((u[cw]=u[cw]||[]).unshift(nm(e)),i)throw u;return kw(u,e,"R3InjectorError",this.source)}throw u}finally{bm(a),dw(i)}}},{key:"_resolveInjectorDefTypes",value:function(){var e=this;this.injectorDefTypes.forEach(function(t){return e.get(t)})}},{key:"toString",value:function(){var e=[];return this.records.forEach(function(t,n){return e.push(nm(n))}),"R3Injector[".concat(e.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(e,t,n){var r=this;if(!(e=om(e)))return!1;var i=ym(e),a=null==i&&e.ngModule||void 0,o=void 0===a?e:a,s=-1!==n.indexOf(o);if(void 0!==a&&(i=ym(a)),null==i)return!1;if(null!=i.imports&&!s){var u;n.push(o);try{JC(i.imports,function(e){r.processInjectorType(e,t,n)&&(void 0===u&&(u=[]),u.push(e))})}finally{}if(void 0!==u)for(var c=function(e){var t=u[e],n=t.ngModule,i=t.providers;JC(i,function(e){return r.processProvider(e,n,i||Nm)})},l=0;l<u.length;l++)c(l)}this.injectorDefTypes.add(o);var f=ok(o)||function(){return new o};this.records.set(o,Pb(f,mb));var h=i.providers;if(null!=h&&!s){var d=e;JC(h,function(e){return r.processProvider(e,d,h)})}return void 0!==a&&void 0!==e.providers}},{key:"processProvider",value:function(e,t,n){var r,i=Ob(e=om(e))?e:om(e&&e.provide),a=Sb(r=e)?Pb(void 0,r.useValue):Pb(bb(r),mb);if(Ob(e)||!0!==e.multi)this.records.get(i);else{var o=this.records.get(i);o||((o=Pb(void 0,mb,!0)).factory=function(){return gw(o.multi)},this.records.set(i,o)),i=e,o.multi.push(e)}this.records.set(i,a)}},{key:"hydrate",value:function(e,t){return t.value===mb&&(t.value=kb,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value;var n}},{key:"injectableDefInScope",value:function(e){if(!e.providedIn)return!1;var t=om(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}]),e}();function Eb(e){var t=pm(e),n=null!==t?t.factory:ok(e);if(null!==n)return n;if(e instanceof YC)throw new Error("Token ".concat(nm(e)," is missing a \u0275prov definition."));if(e instanceof Function)return function(e){var t=e.length;if(t>0){var n=nw(t,"?");throw new Error("Can't resolve all parameters for ".concat(nm(e),": (").concat(n.join(", "),")."))}var r=function(e){var t=e&&(e[km]||e[wm]);if(t){var n=function(e){if(e.hasOwnProperty("name"))return e.name;var t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(n,'" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "').concat(n,'" class.')),t}return null}(e);return null!==r?function(){return r.factory(e)}:function(){return new e}}(e);throw new Error("unreachable")}function bb(e,t,n){var r;if(Ob(e)){var i=om(e);return ok(i)||Eb(i)}if(Sb(e))r=function(){return om(e.useValue)};else if(function(e){return!(!e||!e.useFactory)}(e))r=function(){return e.useFactory.apply(e,Bg(gw(e.deps||[])))};else if(function(e){return!(!e||!e.useExisting)}(e))r=function(){return pw(om(e.useExisting))};else{var a=om(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return ok(a)||Eb(a);r=function(){return Ag(a,Bg(gw(e.deps)))}}return r}function Pb(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:e,value:t,multi:n?[]:void 0}}function Sb(e){return null!==e&&"object"==typeof e&&hw in e}function Ob(e){return"function"==typeof e}var Tb=function(e,t,n){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0,i=wb(e,t,n,r);return i._resolveInjectorDefTypes(),i}({name:n},t,e,n)},Ib=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?Tb(e,t,""):Tb(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=sw,e.NULL=new gb,e.\u0275prov=dm({token:e,providedIn:"any",factory:function(){return pw(pb)}}),e.__NG_ELEMENT_ID__=-1,e}();function Ab(e,t){lC(h_(e)[1],Dk())}function Rb(e){for(var t=function(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0,r=[e];t;){var i=void 0;if(ik(e))i=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");i=t.\u0275dir}if(i){if(n){r.push(i);var a=e;a.inputs=Mb(e.inputs),a.declaredInputs=Mb(e.declaredInputs),a.outputs=Mb(e.outputs);var o=i.hostBindings;o&&Db(e,o);var s=i.viewQuery,u=i.contentQueries;if(s&&xb(e,s),u&&Nb(e,u),tm(e.inputs,i.inputs),tm(e.declaredInputs,i.declaredInputs),tm(e.outputs,i.outputs),ik(i)&&i.data.animation){var c=e.data;c.animation=(c.animation||[]).concat(i.data.animation)}}var l=i.features;if(l)for(var f=0;f<l.length;f++){var h=l[f];h&&h.ngInherit&&h(e),h===Rb&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){for(var t=0,n=null,r=e.length-1;r>=0;r--){var i=e[r];i.hostVars=t+=i.hostVars,i.hostAttrs=CC(i.hostAttrs,n=CC(n,i.hostAttrs))}}(r)}function Mb(e){return e===xm?{}:e===Nm?[]:e}function xb(e,t){var n=e.viewQuery;e.viewQuery=n?function(e,r){t(e,r),n(e,r)}:t}function Nb(e,t){var n=e.contentQueries;e.contentQueries=n?function(e,r,i){t(e,r,i),n(e,r,i)}:t}function Db(e,t){var n=e.hostBindings;e.hostBindings=n?function(e,r){t(e,r),n(e,r)}:t}var Lb=null;function Fb(){if(!Lb){var e=Mm.Symbol;if(e&&e.iterator)Lb=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(Lb=r)}}return Lb}var Ub=function(){function e(t){Zg(this,e),this.wrapped=t}return Wg(e,null,[{key:"wrap",value:function(t){return new e(t)}},{key:"unwrap",value:function(t){return e.isWrapped(t)?t.wrapped:t}},{key:"isWrapped",value:function(t){return t instanceof e}}]),e}();function Vb(e){return!!Bb(e)&&(Array.isArray(e)||!(e instanceof Map)&&Fb()in e)}function Bb(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function zb(e,t,n){return e[t]=n}function Hb(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function Gb(e,t,n,r){var i=Hb(e,t,n);return Hb(e,t+1,r)||i}function $b(e,t,n,r){var i=Mk();return Hb(i,Zk(),t)&&(xk(),jE(uC(),i,e,t,n,r)),$b}function Zb(e,t,n,r){return Hb(e,Zk(),n)?t+cm(n)+r:vE}function qb(e,t,n,r,i,a){var o=Gb(e,$k(),n,i);return qk(2),o?t+cm(n)+r+cm(i)+a:vE}function Wb(e,t,n,r,i,a,o,s){var u=function(e,t,n,r,i){var a=Gb(e,t,n,r);return Hb(e,t+2,i)||a}(e,$k(),n,i,o);return qk(3),u?t+cm(n)+r+cm(i)+a+cm(o)+s:vE}function jb(e,t,n,r,i,a){var o=Mk(),s=Zb(o,t,n,r);return s!==vE&&jE(uC(),o,e,s,i,a),jb}function Yb(e,t,n,r,i,a,o,s){var u=Mk(),c=xk(),l=e+20,f=c.firstCreatePass?function(e,t,n,r,i,a,o,s,u){var c=t.consts,l=PE(t,e,4,o||null,Ok(c,s));BE(t,n,l,Ok(c,u)),lC(t,l);var f=l.tViews=LE(2,l,r,i,a,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c);return null!==t.queries&&(t.queries.template(t,l),f.queries=t.queries.embeddedTView(l)),l}(l,c,u,t,n,r,i,a,o):c.data[l];Uk(f,!1);var h=u[11].createComment("");W_(c,u,h,f),f_(h,u),nb(u,u[l]=XE(h,u,h,f)),rk(f)&&xE(c,u,f),null!=o&&NE(u,f,s)}function Kb(e){return Ek(Ak.lFrame.contextLView,20+e)}function Qb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Em.Default,n=Mk();return null===n?pw(e,t):DC(Dk(),n,om(e),t)}function Xb(e,t,n){var r=Mk();return Hb(r,Zk(),t)&&VE(xk(),uC(),r,e,t,r[11],n,!1),Xb}function Jb(e,t,n,r,i){var a=i?"class":"style";fb(e,n,t.inputs[a],a,r)}function eP(e,t,n,r){var i=Mk(),a=xk(),o=20+e,s=i[11],u=i[o]=R_(s,t,Ak.lFrame.currentNamespace),c=a.firstCreatePass?function(e,t,n,r,i,a,o){var s=t.consts,u=PE(t,e,2,i,Ok(s,a));return BE(t,n,u,Ok(s,o)),null!==u.attrs&&db(u,u.attrs,!1),null!==u.mergedAttrs&&db(u,u.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,u),u}(o,a,i,0,t,n,r):a.data[o];Uk(c,!0);var l=c.mergedAttrs;null!==l&&yC(s,u,l);var f=c.classes;null!==f&&nE(s,u,f);var h=c.styles;null!==h&&tE(s,u,h),64!=(64&c.flags)&&W_(a,i,u,c),0===Ak.lFrame.elementDepthCount&&f_(u,i),Ak.lFrame.elementDepthCount++,rk(c)&&(xE(a,i,c),ME(a,c,i)),null!==r&&NE(i,c)}function tP(){var e=Dk();Vk()?Bk():Uk(e=e.parent,!1);var t=e;Ak.lFrame.elementDepthCount--;var n=xk();n.firstCreatePass&&(lC(n,e),tk(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&Jb(n,t,Mk(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&Jb(n,t,Mk(),t.stylesWithoutHost,!1)}function nP(e,t,n,r){eP(e,t,n,r),tP()}function rP(e,t,n){var r=Mk(),i=xk(),a=e+20,o=i.firstCreatePass?function(e,t,n,r,i){var a=t.consts,o=Ok(a,r),s=PE(t,e,8,"ng-container",o);return null!==o&&db(s,o,!0),BE(t,n,s,Ok(a,i)),null!==t.queries&&t.queries.elementStart(t,s),s}(a,i,r,t,n):i.data[a];Uk(o,!0);var s=r[a]=r[11].createComment("");W_(i,r,s,o),f_(s,r),rk(o)&&(xE(i,r,o),ME(i,o,r)),null!=n&&NE(r,o)}function iP(){var e=Dk(),t=xk();Vk()?Bk():Uk(e=e.parent,!1),t.firstCreatePass&&(lC(t,e),tk(e)&&t.queries.elementEnd(e))}function aP(){return Mk()}function oP(e){return!!e&&"function"==typeof e.then}var sP=function(e){return!!e&&"function"==typeof e.subscribe};function uP(e,t,n,r){var i=Mk(),a=xk(),o=Dk();return function(e,t,n,r,i,a,o,s){var u=rk(r),c=e.firstCreatePass&&cb(e),l=t[8],f=ub(t),h=!0;if(3&r.type||s){var d=wk(r,t),v=s?s(d):d,p=f.length,g=s?function(e){return s(kk(e[r.index]))}:r.index;if(yk(n)){var y=null;if(!s&&u&&(y=function(e,t,n,r){var i=e.cleanup;if(null!=i)for(var a=0;a<i.length-1;a+=2){var o=i[a];if(o===n&&i[a+1]===r){var s=t[7],u=i[a+2];return s.length>u?s[u]:null}"string"==typeof o&&(a+=2)}return null}(e,t,i,r.index)),null!==y)(y.__ngLastListenerFn__||y).__ngNextListenerFn__=a,y.__ngLastListenerFn__=a,h=!1;else{a=lP(r,t,l,a,!1);var m=n.listen(v,i,a);f.push(a,m),c&&c.push(i,g,p,p+1)}}else a=lP(r,t,l,a,!0),v.addEventListener(i,a,o),f.push(a),c&&c.push(i,g,p,o)}else a=lP(r,t,l,a,!1);var k,C=r.outputs;if(h&&null!==C&&(k=C[i])){var w=k.length;if(w)for(var _=0;_<w;_+=2){var E=t[k[_]][k[_+1]].subscribe(a),b=f.length;f.push(a,E),c&&c.push(i,r.index,b,-(b+1))}}}(a,i,i[11],o,e,t,!!n,r),uP}function cP(e,t,n,r){try{return!1!==n(r)}catch(i){return lb(e,i),!1}}function lP(e,t,n,r,i){return function n(a){if(a===Function)return r;var o=2&e.flags?bk(e.index,t):t;0==(32&t[2])&&rb(o);for(var s=cP(t,0,r,a),u=n.__ngNextListenerFn__;u;)s=cP(t,0,u,a)&&s,u=u.__ngNextListenerFn__;return i&&!1===s&&(a.preventDefault(),a.returnValue=!1),s}}function fP(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(e){return(Ak.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,Ak.lFrame.contextLView))[8]}(e)}function hP(e,t,n){return dP(e,"",t,"",n),hP}function dP(e,t,n,r,i){var a=Mk(),o=Zb(a,t,n,r);return o!==vE&&VE(xk(),uC(),a,e,o,a[11],i,!1),dP}function vP(e,t,n,r,i,a,o){var s=Mk(),u=qb(s,t,n,r,i,a);return u!==vE&&VE(xk(),uC(),s,e,u,s[11],o,!1),vP}function pP(e,t,n,r,i,a,o,s,u){var c=Mk(),l=Wb(c,t,n,r,i,a,o,s);return l!==vE&&VE(xk(),uC(),c,e,l,c[11],u,!1),pP}function gP(e,t,n,r,i){for(var a=e[n+1],o=null===t,s=r?mE(a):CE(a),u=!1;0!==s&&(!1===u||o);){var c=e[s+1];yP(e[s],t)&&(u=!0,e[s+1]=r?_E(c):kE(c)),s=r?mE(c):CE(c)}u&&(e[n+1]=r?kE(a):_E(a))}function yP(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&aw(e,t)>=0}var mP={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function kP(e){return e.substring(mP.key,mP.keyEnd)}function CP(e){return e.substring(mP.value,mP.valueEnd)}function wP(e,t){var n=mP.textEnd,r=mP.key=_P(e,t,n);return n===r?-1:(r=mP.keyEnd=function(e,t,n){for(var r;t<n&&(45===(r=e.charCodeAt(t))||95===r||(-33&r)>=65&&(-33&r)<=90||r>=48&&r<=57);)t++;return t}(e,r,n),r=EP(e,r,n),r=mP.value=_P(e,r,n),r=mP.valueEnd=function(e,t,n){for(var r=-1,i=-1,a=-1,o=t,s=o;o<n;){var u=e.charCodeAt(o++);if(59===u)return s;34===u||39===u?s=o=bP(e,u,o,n):t===o-4&&85===a&&82===i&&76===r&&40===u?s=o=bP(e,41,o,n):u>32&&(s=o),a=i,i=r,r=-33&u}return s}(e,r,n),EP(e,r,n))}function _P(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function EP(e,t,n,r){return(t=_P(e,t,n))<n&&t++,t}function bP(e,t,n,r){for(var i=-1,a=n;a<r;){var o=e.charCodeAt(a++);if(o==t&&92!==i)return a;i=92==o&&92===i?0:o}throw new Error}function PP(e,t){return function(e,t,n,r){var i=Mk(),a=xk(),o=qk(2);a.firstUpdatePass&&IP(a,e,o,true),t!==vE&&Hb(i,o,t)&&xP(a,a.data[oC()],i,i[11],e,i[o+1]=function(e,t){return null==e||"object"==typeof e&&(e=nm(xw(e))),e}(t),true,o)}(e,t),PP}function SP(e){!function(e,t,n,r){var i=xk(),a=qk(2);i.firstUpdatePass&&IP(i,null,a,r);var o=Mk();if(n!==vE&&Hb(o,a,n)){var s=i.data[oC()];if(LP(s,r)&&!TP(i,a)){var u=s.stylesWithoutHost;null!==u&&(n=rm(u,n||"")),Jb(i,s,o,n,r)}else!function(e,t,n,r,i,a,o,s){i===vE&&(i=Nm);for(var u=0,c=0,l=0<i.length?i[0]:null,f=0<a.length?a[0]:null;null!==l||null!==f;){var h=u<i.length?i[u+1]:void 0,d=c<a.length?a[c+1]:void 0,v=void 0,p=null;l===f?(u+=2,c+=2,h!==d&&(p=f,v=d)):null===f||null!==l&&l<f?(u+=2,p=l):(c+=2,p=f,v=d),null!==p&&xP(e,t,n,r,p,v,false,s),l=u<i.length?i[u]:null,f=c<a.length?a[c]:null}}(i,s,o,o[11],o[a+1],o[a+1]=function(e,t,n){if(null==n||""===n)return Nm;var r=[],i=xw(n);if(Array.isArray(i))for(var a=0;a<i.length;a++)e(r,i[a],!0);else if("object"==typeof i)for(var o in i)i.hasOwnProperty(o)&&e(r,o,i[o]);else"string"==typeof i&&t(r,i);return r}(e,t,n),0,a)}}(MP,OP,e,!1)}function OP(e,t){for(var n=function(e){return function(e){mP.key=0,mP.keyEnd=0,mP.value=0,mP.valueEnd=0,mP.textEnd=e.length}(e),wP(e,_P(e,0,mP.textEnd))}(t);n>=0;n=wP(t,n))MP(e,kP(t),CP(t))}function TP(e,t){return t>=e.expandoStartIndex}function IP(e,t,n,r){var i=e.data;if(null===i[n+1]){var a=i[oC()],o=TP(e,n);LP(a,r)&&null===t&&!o&&(t=!1),t=function(e,t,n,r){var i=function(e){var t=Ak.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e),a=r?t.residualClasses:t.residualStyles;if(null===i)0===(r?t.classBindings:t.styleBindings)&&(n=RP(n=AP(null,e,t,n,r),t.attrs,r),a=null);else{var o=t.directiveStylingLast;if(-1===o||e[o]!==i)if(n=AP(i,e,t,n,r),null===a){var s=function(e,t,n){var r=n?t.classBindings:t.styleBindings;if(0!==CE(r))return e[mE(r)]}(e,t,r);void 0!==s&&Array.isArray(s)&&function(e,t,n,r){e[mE(n?t.classBindings:t.styleBindings)]=r}(e,t,r,s=RP(s=AP(null,e,t,s[1],r),t.attrs,r))}else a=function(e,t,n){for(var r,i=t.directiveEnd,a=1+t.directiveStylingLast;a<i;a++)r=RP(r,e[a].hostAttrs,n);return RP(r,t.attrs,n)}(e,t,r)}return void 0!==a&&(r?t.residualClasses=a:t.residualStyles=a),n}(i,a,t,r),function(e,t,n,r,i,a){var o=a?t.classBindings:t.styleBindings,s=mE(o),u=CE(o);e[r]=n;var c,l=!1;if(Array.isArray(n)){var f=n;(null===(c=f[1])||aw(f,c)>0)&&(l=!0)}else c=n;if(i)if(0!==u){var h=mE(e[s+1]);e[r+1]=yE(h,s),0!==h&&(e[h+1]=wE(e[h+1],r)),e[s+1]=function(e,t){return 131071&e|t<<17}(e[s+1],r)}else e[r+1]=yE(s,0),0!==s&&(e[s+1]=wE(e[s+1],r)),s=r;else e[r+1]=yE(u,0),0===s?s=r:e[u+1]=wE(e[u+1],r),u=r;l&&(e[r+1]=kE(e[r+1])),gP(e,c,r,!0),gP(e,c,r,!1),function(e,t,n,r,i){var a=i?e.residualClasses:e.residualStyles;null!=a&&"string"==typeof t&&aw(a,t)>=0&&(n[r+1]=_E(n[r+1]))}(t,c,e,r,a),o=yE(s,u),a?t.classBindings=o:t.styleBindings=o}(i,a,t,n,o,r)}}function AP(e,t,n,r,i){var a=null,o=n.directiveEnd,s=n.directiveStylingLast;for(-1===s?s=n.directiveStart:s++;s<o&&(r=RP(r,(a=t[s]).hostAttrs,i),a!==e);)s++;return null!==e&&(n.directiveStylingLast=s),r}function RP(e,t,n){var r=n?1:2,i=-1;if(null!==t)for(var a=0;a<t.length;a++){var o=t[a];"number"==typeof o?i=o:i===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),rw(e,o,!!n||t[++a]))}return void 0===e?null:e}function MP(e,t,n){rw(e,t,xw(n))}function xP(e,t,n,r,i,a,o,s){if(3&t.type){var u=e.data,c=u[s+1];DP(function(e){return 1==(1&e)}(c)?NP(u,t,n,i,CE(c),o):void 0)||(DP(a)||function(e){return 2==(2&e)}(c)&&(a=NP(u,null,n,i,s,o)),function(e,t,n,r,i){var a=yk(e);if(t)i?a?e.addClass(n,r):n.classList.add(r):a?e.removeClass(n,r):n.classList.remove(r);else{var o=-1===r.indexOf("-")?void 0:w_.DashCase;if(null==i)a?e.removeStyle(n,r,o):n.style.removeProperty(r);else{var s="string"==typeof i&&i.endsWith("!important");s&&(i=i.slice(0,-10),o|=w_.Important),a?e.setStyle(n,r,i,o):n.style.setProperty(r,i,s?"important":"")}}}(r,o,Ck(oC(),n),i,a))}}function NP(e,t,n,r,i,a){for(var o,s=null===t;i>0;){var u=e[i],c=Array.isArray(u),l=c?u[1]:u,f=null===l,h=n[i+1];h===vE&&(h=f?Nm:void 0);var d=f?iw(h,r):l===r?h:void 0;if(c&&!DP(d)&&(d=iw(u,r)),DP(d)&&(o=d,s))return o;var v=e[i+1];i=s?mE(v):CE(v)}if(null!==t){var p=a?t.residualClasses:t.residualStyles;null!=p&&(o=iw(p,r))}return o}function DP(e){return void 0!==e}function LP(e,t){return 0!=(e.flags&(t?16:32))}function FP(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Mk(),r=xk(),i=e+20,a=r.firstCreatePass?PE(r,i,1,t,null):r.data[i],o=n[i]=T_(n[11],t);W_(r,n,o,a),Uk(a,!1)}function UP(e){return VP("",e,""),UP}function VP(e,t,n){var r=Mk(),i=Zb(r,e,t,n);return i!==vE&&hb(r,oC(),i),VP}function BP(e,t,n,r,i){var a=Mk(),o=qb(a,e,t,n,r,i);return o!==vE&&hb(a,oC(),o),BP}function zP(e,t,n,r,i,a,o){var s=Mk(),u=Wb(s,e,t,n,r,i,a,o);return u!==vE&&hb(s,oC(),u),zP}function HP(e,t,n){var r=Mk();return Hb(r,Zk(),t)&&VE(xk(),uC(),r,e,t,r[11],n,!0),HP}var GP=void 0,$P=["en",[["a","p"],["AM","PM"],GP],[["AM","PM"],GP,GP],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],GP,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],GP,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",GP,"{1} 'at' {0}",GP],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],ZP={};function qP(e){var t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e),n=jP(t);if(n)return n;var r=t.split("-")[0];if(n=jP(r))return n;if("en"===r)return $P;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}function WP(e){return qP(e)[YP.PluralCase]}function jP(e){return e in ZP||(ZP[e]=Mm.ng&&Mm.ng.common&&Mm.ng.common.locales&&Mm.ng.common.locales[e]),ZP[e]}var YP=((YP=YP||{})[YP.LocaleId=0]="LocaleId",YP[YP.DayPeriodsFormat=1]="DayPeriodsFormat",YP[YP.DayPeriodsStandalone=2]="DayPeriodsStandalone",YP[YP.DaysFormat=3]="DaysFormat",YP[YP.DaysStandalone=4]="DaysStandalone",YP[YP.MonthsFormat=5]="MonthsFormat",YP[YP.MonthsStandalone=6]="MonthsStandalone",YP[YP.Eras=7]="Eras",YP[YP.FirstDayOfWeek=8]="FirstDayOfWeek",YP[YP.WeekendRange=9]="WeekendRange",YP[YP.DateFormat=10]="DateFormat",YP[YP.TimeFormat=11]="TimeFormat",YP[YP.DateTimeFormat=12]="DateTimeFormat",YP[YP.NumberSymbols=13]="NumberSymbols",YP[YP.NumberFormats=14]="NumberFormats",YP[YP.CurrencyCode=15]="CurrencyCode",YP[YP.CurrencySymbol=16]="CurrencySymbol",YP[YP.CurrencyName=17]="CurrencyName",YP[YP.Currencies=18]="Currencies",YP[YP.Directionality=19]="Directionality",YP[YP.PluralCase=20]="PluralCase",YP[YP.ExtraData=21]="ExtraData",YP),KP=["zero","one","two","few","many"],QP="en-US",XP={marker:"element"},JP={marker:"ICU"},eS=((eS=eS||{})[eS.SHIFT=2]="SHIFT",eS[eS.APPEND_EAGERLY=1]="APPEND_EAGERLY",eS[eS.COMMENT=2]="COMMENT",eS),tS=QP;function nS(e){(function(e,t){null==e&&hm("Expected localeId to be defined",e,null,"!=")})(e),"string"==typeof e&&(tS=e.toLowerCase().replace(/_/g,"-"))}function rS(e,t,n){var r=t.insertBeforeIndex,i=Array.isArray(r)?r[0]:r;return null===i?G_(e,0,n):kk(n[i])}function iS(e,t,n,r,i){var a=t.insertBeforeIndex;if(Array.isArray(a)){var o=r,s=null;if(3&t.type||(s=o,o=i),null!==o&&0==(2&t.flags))for(var u=1;u<a.length;u++)U_(e,o,n[a[u]],s,!1)}}function aS(e,t){if(e.push(t),e.length>1)for(var n=e.length-2;n>=0;n--){var r=e[n];oS(r)||sS(r,t)&&null===uS(r)&&cS(r,t.index)}}function oS(e){return!(64&e.type)}function sS(e,t){return oS(t)||e.index>t.index}function uS(e){var t=e.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function cS(e,t){var n=e.insertBeforeIndex;Array.isArray(n)?n[0]=t:(q_(rS,iS),e.insertBeforeIndex=t)}function lS(e,t){var n=e.data[t];return null===n||"string"==typeof n?null:n.hasOwnProperty("currentCaseLViewIndex")?n:n.value}function fS(e,t,n){var r=SE(e,n,64,null,null);return aS(t,r),r}function hS(e,t){var n=t[e.currentCaseLViewIndex];return null===n?n:n<0?~n:n}function dS(e){return e>>>17}function vS(e){return(131070&e)>>>1}var pS=0,gS=0;function yS(e,t,n,r){for(var i,a=n[11],o=null,s=0;s<t.length;s++){var u=t[s];if("string"==typeof u){var c=t[++s];null===n[c]&&(n[c]=T_(a,u))}else if("number"==typeof u)switch(1&u){case 0:var l=dS(u),f=void 0,h=void 0;if(null===o&&(o=l,i=z_(a,r)),l===o?(f=r,h=i):(f=null,h=kk(n[l])),null!==h){var d=vS(u);U_(a,h,n[d],f,!1);var v=lS(e,d);if(null!==v&&"object"==typeof v){var p=hS(v,n);null!==p&&yS(e,v.create[p],n,n[v.anchorIdx])}}break;case 1:var g=t[++s],y=t[++s];YE(a,Ck(u>>>1,n),null,null,g,y,null);break;default:throw new Error('Unable to determine the type of mutate operation for "'.concat(u,'"'))}else switch(u){case JP:var m=t[++s],k=t[++s];null===n[k]&&f_(n[k]=A_(a,m),n);break;case XP:var C=t[++s],w=t[++s];null===n[w]&&f_(n[w]=R_(a,C,null),n)}}}function mS(e,t,n,r,i){for(var a=0;a<n.length;a++){var o=n[a],s=n[++a];if(o&i)for(var u="",c=a+1;c<=a+s;c++){var l=n[c];if("string"==typeof l)u+=l;else if("number"==typeof l)if(l<0)u+=cm(t[r-l]);else{var f=l>>>2;switch(3&l){case 1:var h=n[++c],d=n[++c],v=e.data[f];"string"==typeof v?YE(t[11],t[f],null,v,h,u,d):VE(e,v,t,h,u,t[11],d,!1);break;case 0:var p=t[f];null!==p&&I_(t[11],p,u);break;case 2:CS(e,lS(e,f),t,u);break;case 3:kS(e,lS(e,f),r,t)}}}else{var g=n[a+1];if(g>0&&3==(3&g)){var y=lS(e,g>>>2);t[y.currentCaseLViewIndex]<0&&kS(e,y,r,t)}}a+=s}}function kS(e,t,n,r){var i=r[t.currentCaseLViewIndex];if(null!==i){var a=pS;i<0&&(i=r[t.currentCaseLViewIndex]=~i,a=-1),mS(e,r,t.update[i],n,a)}}function CS(e,t,n,r){var i=function(e,t){var n=e.cases.indexOf(t);if(-1===n)switch(e.type){case 1:var r=function(e,t){var n=WP(t)(parseInt(e,10)),r=KP[n];return void 0!==r?r:"other"}(t,tS);-1===(n=e.cases.indexOf(r))&&"other"!==r&&(n=e.cases.indexOf("other"));break;case 0:n=e.cases.indexOf("other")}return-1===n?null:n}(t,r);if(hS(t,n)!==i&&(wS(e,t,n),n[t.currentCaseLViewIndex]=null===i?null:~i,null!==i)){var a=n[t.anchorIdx];a&&yS(e,t.create[i],n,a)}}function wS(e,t,n){var r=hS(t,n);if(null!==r)for(var i=t.remove[r],a=0;a<i.length;a++){var o=i[a];if(o>0){var s=Ck(o,n);null!==s&&Q_(n[11],s)}else wS(e,lS(e,~o),n)}}function _S(){var e,t,n=[],r=-1;function i(e,n){r=0;var i=hS(e,n);t=null!==i?e.remove[i]:Nm}function a(){if(r<t.length){var o=t[r++];return o>0?e[o]:(n.push(r,t),i(e[1].data[~o],e),a())}return 0===n.length?null:(t=n.pop(),r=n.pop(),a())}return function(t,r){for(e=r;n.length;)n.pop();return i(t.value,r),a}}var ES=/\ufffd(\d+):?\d*\ufffd/gi,bS=/\ufffd(\d+)\ufffd/,PS=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,SS=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,OS=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,TS=/\uE500/g;function IS(e,t,n,r,i,a,o){var s=OE(e,r,1,null),u=s<<eS.SHIFT,c=Fk();t===c&&(c=null),null===c&&(u|=eS.APPEND_EAGERLY),o&&(u|=eS.COMMENT,function(e){void 0===C_&&(C_=e())}(_S)),i.push(u,null===a?"":a);var l=SE(e,s,o?32:1,null===a?"":a,null);aS(n,l);var f=l.index;return Uk(l,!1),null!==c&&t!==c&&function(e,t){var n=e.insertBeforeIndex;null===n?(q_(rS,iS),n=e.insertBeforeIndex=[null,t]):(function(e,t,n){true!=e&&hm("Expecting array here",e,true,"==")}(Array.isArray(n)),n.push(t))}(c,f),l}function AS(e,t,n,r,i,a,o){var s=o.match(ES),u=IS(e,t,n,a,r,s?null:o,!1);s&&RS(i,o,u.index,null,0,null)}function RS(e,t,n,r,i,a){var o=e.length,s=o+1;e.push(null,null);for(var u=o+2,c=t.split(ES),l=0,f=0;f<c.length;f++){var h=c[f];if(1&f){var d=i+parseInt(h,10);e.push(-1-d),l|=MS(d)}else""!==h&&e.push(h)}return e.push(n<<2|(r?1:0)),r&&e.push(r,a),e[o]=l,e[s]=e.length-u,l}function MS(e){return 1<<Math.min(e,31)}function xS(e){for(var t,n,r="",i=0,a=!1;null!==(t=SS.exec(e));)a?t[0]==="\ufffd/*".concat(n,"\ufffd")&&(i=t.index,a=!1):(r+=e.substring(i,t.index+t[0].length),n=t[1],a=!0);return r+=e.substr(i)}function NS(e,t,n,r,i,a){var o=0,s={type:i.type,currentCaseLViewIndex:OE(e,t,1,null),anchorIdx:a,cases:[],create:[],remove:[],update:[]};(function(e,t,n){e.push(MS(t.mainBinding),2,-1-t.mainBinding,n<<2|2)})(n,i,a),function(e,t,n){var r=e.data[t];null===r?e.data[t]=n:r.value=n}(e,a,s);for(var u=i.values,c=0;c<u.length;c++){for(var l=u[c],f=[],h=0;h<l.length;h++){var d=l[h];if("string"!=typeof d){var v=f.push(d)-1;l[h]="\x3c!--\ufffd".concat(v,"\ufffd--\x3e")}}o=FS(e,s,t,n,r,i.cases[c],l.join(""),f)|o}o&&function(e,t,n){e.push(t,1,n<<2|3)}(n,o,a)}function DS(e){for(var t=[],n=[],r=1,i=0,a=LS(e=e.replace(PS,function(e,t,n){return r="select"===n?0:1,i=parseInt(t.substr(1),10),""})),o=0;o<a.length;){var s=a[o++].trim();1===r&&(s=s.replace(/\s*(?:=)?(\w+)\s*/,"$1")),s.length&&t.push(s);var u=LS(a[o++]);t.length>n.length&&n.push(u)}return{type:r,mainBinding:i,cases:t,values:n}}function LS(e){if(!e)return[];var t,n=0,r=[],i=[],a=/[{}]/g;for(a.lastIndex=0;t=a.exec(e);){var o=t.index;if("}"==t[0]){if(r.pop(),0==r.length){var s=e.substring(n,o);PS.test(s)?i.push(DS(s)):i.push(s),n=o+1}}else{if(0==r.length){var u=e.substring(n,o);i.push(u),n=o+1}r.push("{")}}var c=e.substring(n);return i.push(c),i}function FS(e,t,n,r,i,a,o,s){var u=[],c=[],l=[];t.cases.push(a),t.create.push(u),t.remove.push(c),t.update.push(l);var f=Lw(gk()).getInertBodyElement(o),h=a_(f)||f;return h?US(e,t,n,r,u,c,l,h,i,s,0):0}function US(e,t,n,r,i,a,o,s,u,c,l){for(var f=0,h=s.firstChild;h;){var d=OE(e,n,1,null);switch(h.nodeType){case Node.ELEMENT_NODE:var v=h,p=v.tagName.toLowerCase();if(Yw.hasOwnProperty(p)){zS(i,XP,p,u,d),e.data[d]=p;for(var g=v.attributes,y=0;y<g.length;y++){var m=g.item(y),k=m.name.toLowerCase();m.value.match(ES)?Xw.hasOwnProperty(k)&&RS(o,m.value,d,m.name,0,Kw[k]?zw:Qw[k]?Hw:null):HS(i,d,m)}f=US(e,t,n,r,i,a,o,h,d,c,l+1)|f,VS(a,d,l)}break;case Node.TEXT_NODE:var C=h.textContent||"",w=C.match(ES);zS(i,null,w?"":C,u,d),VS(a,d,l),w&&(f=RS(o,C,d,null,0,null)|f);break;case Node.COMMENT_NODE:var _=bS.exec(h.textContent||"");if(_){var E=c[parseInt(_[1],10)];zS(i,JP,"",u,d),NS(e,n,r,u,E,d),BS(a,d,l)}}h=h.nextSibling}return f}function VS(e,t,n){0===n&&e.push(t)}function BS(e,t,n){0===n&&(e.push(~t),e.push(t))}function zS(e,t,n,r,i){null!==t&&e.push(t),e.push(n,i,function(e,t,n){return 0|t<<17|n<<1}(0,r,i))}function HS(e,t,n){e.push(t<<1|1,n.name,n.value)}function GS(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=xk(),i=Mk(),a=20+e,o=Ok(r.consts,t),s=Fk();r.firstCreatePass&&function(e,t,n,r,i,a){var o=Fk(),s=[],u=[],c=[[]];i=function(e,t){if(function(e){return-1===e}(t))return xS(e);var n=e.indexOf(":".concat(t,"\ufffd"))+2+t.toString().length,r=e.search(new RegExp("\ufffd\\/\\*\\d+:".concat(t,"\ufffd")));return xS(e.substring(n,r))}(i,a);for(var l=function(e){return e.replace(TS," ")}(i).split(OS),f=0;f<l.length;f++){var h=l[f];if(0==(1&f))for(var d=LS(h),v=0;v<d.length;v++){var p=d[v];if(0==(1&v)){var g=p;""!==g&&AS(e,o,c[0],s,u,n,g)}else{var y=p;if("object"!=typeof y)throw new Error('Unable to parse ICU expression in "'.concat(i,'" message.'));NS(e,n,u,t,y,IS(e,o,c[0],n,s,"",!0).index)}}else{var m=47===h.charCodeAt(0),k=(h.charCodeAt(m?1:0),20+Number.parseInt(h.substring(m?2:1)));if(m)c.shift(),Uk(Fk(),!1);else{var C=fS(e,c[0],k);c.unshift([]),Uk(C,!0)}}}e.data[r]={create:s,update:u}}(r,null===s?0:s.index,i,a,o,n);var u=r.data[a],c=F_(r,s===i[6]?null:s,i);(function(e,t,n,r){for(var i=e[11],a=0;a<t.length;a++){var o=t[a++],s=t[a],u=(o&eS.COMMENT)===eS.COMMENT,c=(o&eS.APPEND_EAGERLY)===eS.APPEND_EAGERLY,l=o>>>eS.SHIFT,f=e[l];null===f&&(f=e[l]=u?i.createComment(s):T_(i,s)),c&&null!==n&&U_(i,n,f,r,!1)}})(i,u.create,c,s&&8&s.type?i[s.index]:null),Wk(!0)}function $S(){Wk(!1)}function ZS(e,t,n){GS(e,t,n),$S()}function qS(e){return function(e){e&&(pS|=1<<Math.min(gS,31)),gS++}(Hb(Mk(),Zk(),e)),qS}function WS(e){!function(e,t,n){if(gS>0){var r=e.data[n];mS(e,t,Array.isArray(r)?r:r.update,$k()-gS-1,pS)}pS=0,gS=0}(xk(),Mk(),e+20)}function jS(e,t,n,r,i){if(e=om(e),Array.isArray(e))for(var a=0;a<e.length;a++)jS(e[a],t,n,r,i);else{var o=xk(),s=Mk(),u=Ob(e)?e:om(e.provide),c=bb(e),l=Dk(),f=1048575&l.providerIndexes,h=l.directiveStart,d=l.providerIndexes>>20;if(Ob(e)||!e.multi){var v=new gC(c,i,Qb),p=QS(u,t,i?f:f+d,h);-1===p?(MC(TC(l,s),o,u),YS(o,e,t.length),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(v),s.push(v)):(n[p]=v,s[p]=v)}else{var g=QS(u,t,f+d,h),y=QS(u,t,f,f+d),m=g>=0&&n[g],k=y>=0&&n[y];if(i&&!k||!i&&!m){MC(TC(l,s),o,u);var C=function(e,t,n,r,i){var a=new gC(e,n,Qb);return a.multi=[],a.index=t,a.componentProviders=0,KS(a,i,r&&!n),a}(i?JS:XS,n.length,i,r,c);!i&&k&&(n[y].providerFactory=C),YS(o,e,t.length,0),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(C),s.push(C)}else YS(o,e,g>-1?g:y,KS(n[i?y:g],c,!i&&r));!i&&r&&k&&n[y].componentProviders++}}}function YS(e,t,n,r){var i=Ob(t);if(i||function(e){return!!e.useClass}(t)){var a=(t.useClass||t).prototype.ngOnDestroy;if(a){var o=e.destroyHooks||(e.destroyHooks=[]);if(!i&&t.multi){var s=o.indexOf(n);-1===s?o.push(n,[r,a]):o[s+1].push(r,a)}else o.push(n,a)}}}function KS(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function QS(e,t,n,r){for(var i=n;i<r;i++)if(t[i]===e)return i;return-1}function XS(e,t,n,r){return eO(this.multi,[])}function JS(e,t,n,r){var i,a=this.multi;if(this.providerFactory){var o=this.providerFactory.componentProviders,s=BC(n,n[1],this.providerFactory.index,r);eO(a,i=s.slice(0,o));for(var u=o;u<s.length;u++)i.push(s[u])}else eO(a,i=[]);return i}function eO(e,t){for(var n=0;n<e.length;n++)t.push((0,e[n])());return t}function tO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n){n.providersResolver=function(n,r){return function(e,t,n){var r=xk();if(r.firstCreatePass){var i=ik(e);jS(n,r.data,r.blueprint,i,!0),jS(t,r.data,r.blueprint,i,!1)}}(n,r?r(e):e,t)}}}var nO=Wg(function e(){Zg(this,e)}),rO=function(){function e(){Zg(this,e)}return Wg(e,[{key:"resolveComponentFactory",value:function(e){throw function(e){var t=Error("No component factory found for ".concat(nm(e),". Did you add it to @NgModule.entryComponents?"));return t.ngComponent=e,t}(e)}}]),e}(),iO=function(){var e=Wg(function e(){Zg(this,e)});return e.NULL=new rO,e}();function aO(){}function oO(e,t){return new uO(wk(e,t))}var sO=function(){return oO(Dk(),Mk())},uO=function(){var e=Wg(function e(t){Zg(this,e),this.nativeElement=t});return e.__NG_ELEMENT_ID__=sO,e}();function cO(e){return e instanceof uO?e.nativeElement:e}var lO=Wg(function e(){Zg(this,e)}),fO=function(){var e=Wg(function e(){Zg(this,e)});return e.__NG_ELEMENT_ID__=function(){return hO()},e}(),hO=function(){var e=Mk(),t=bk(Dk().index,e);return function(e){return e[11]}(Jm(t)?t:e)},dO=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275prov=dm({token:e,providedIn:"root",factory:function(){return null}}),e}(),vO=Wg(function e(t){Zg(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}),pO=new vO("12.2.16"),gO=function(){function e(){Zg(this,e)}return Wg(e,[{key:"supports",value:function(e){return Vb(e)}},{key:"create",value:function(e){return new mO(e)}}]),e}(),yO=function(e,t){return t},mO=function(){function e(t){Zg(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||yO}return Wg(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,n=this._removalsHead,r=0,i=null;t||n;){var a=!n||t&&t.currentIndex<_O(n,r,i)?t:n,o=_O(a,r,i),s=a.currentIndex;if(a===n)r--,n=n._nextRemoved;else if(t=t._next,null==a.previousIndex)r++;else{i||(i=[]);var u=o-r,c=s-r;if(u!=c){for(var l=0;l<u;l++){var f=l<i.length?i[l]:i[l]=0,h=f+l;c<=h&&h<u&&(i[l]=f+1)}i[a.previousIndex]=c-u}}o!==s&&e(a,o,s)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!Vb(e))throw new Error("Error trying to diff '".concat(nm(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n,r,i,a=this._itHead,o=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)r=e[s],i=this._trackByFn(s,r),null!==a&&Object.is(a.trackById,i)?(o&&(a=this._verifyReinsertion(a,r,i,s)),Object.is(a.item,r)||this._addIdentityChange(a,r)):(a=this._mismatch(a,r,i,s),o=!0),a=a._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var r,i=e[Fb()]();!(r=i.next()).done;)t(r.value)}(e,function(e){i=t._trackByFn(n,e),null!==a&&Object.is(a.trackById,i)?(o&&(a=t._verifyReinsertion(a,e,i,n)),Object.is(a.item,e)||t._addIdentityChange(a,e)):(a=t._mismatch(a,e,i,n),o=!0),a=a._next,n++}),this.length=n;return this._truncate(a),this.collection=e,this.isDirty}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}},{key:"_reset",value:function(){if(this.isDirty){var e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,n,r){var i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,r)):e=this._addAfter(new kO(t,n),i,r),e}},{key:"_verifyReinsertion",value:function(e,t,n,r){var i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?e=this._reinsertAfter(i,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var r=e._prevRemoved,i=e._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_moveAfter",value:function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_addAfter",value:function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,n){var r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new wO),this._linkedRecords.put(e),e.currentIndex=n,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new wO),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}]),e}(),kO=Wg(function e(t,n){Zg(this,e),this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}),CO=function(){function e(){Zg(this,e),this._head=null,this._tail=null}return Wg(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}},{key:"remove",value:function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}]),e}(),wO=function(){function e(){Zg(this,e),this.map=new Map}return Wg(e,[{key:"put",value:function(e){var t=e.trackById,n=this.map.get(t);n||(n=new CO,this.map.set(t,n)),n.add(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?n.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"isEmpty",get:function(){return 0===this.map.size}},{key:"clear",value:function(){this.map.clear()}}]),e}();function _O(e,t,n){var r=e.previousIndex;if(null===r)return r;var i=0;return n&&r<n.length&&(i=n[r]),r+t+i}var EO=function(){function e(){Zg(this,e)}return Wg(e,[{key:"supports",value:function(e){return e instanceof Map||Bb(e)}},{key:"create",value:function(){return new bO}}]),e}(),bO=function(){function e(){Zg(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return Wg(e,[{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}},{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||Bb(e)))throw new Error("Error trying to diff '".concat(nm(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,function(e,r){if(n&&n.key===r)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var i=t._getOrCreateRecordForKey(r,e);n=t._insertBeforeOrAppend(n,i)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}var a=new PO(e);return this._records.set(e,a),a.currentValue=t,this._addToAdditions(a),a}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(function(n){return t(e[n],n)})}}]),e}(),PO=Wg(function e(t){Zg(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null});function SO(){return new OO([new gO])}var OO=function(){var e=function(){function e(t){Zg(this,e),this.factories=t}return Wg(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(null!=t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'"))}}],[{key:"create",value:function(t,n){if(null!=n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||SO())},deps:[[e,new bw,new Ew]]}}}]),e}();return e.\u0275prov=dm({token:e,providedIn:"root",factory:SO}),e}();function TO(){return new IO([new EO])}var IO=function(){var e=function(){function e(t){Zg(this,e),this.factories=t}return Wg(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,n){if(n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||TO())},deps:[[e,new bw,new Ew]]}}}]),e}();return e.\u0275prov=dm({token:e,providedIn:"root",factory:TO}),e}();function AO(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==n;){var a=t[n.index];if(null!==a&&r.push(kk(a)),ek(a))for(var o=10;o<a.length;o++){var s=a[o],u=s[1].firstChild;null!==u&&AO(s[1],s,u,r)}var c=n.type;if(8&c)AO(e,t,n.child,r);else if(32&c)for(var l=__(n,t),f=void 0;f=l();)r.push(f);else if(16&c){var h=Y_(t,n);if(Array.isArray(h))r.push.apply(r,Bg(h));else{var d=E_(t[16]);AO(d[1],d,h,r,!0)}}n=i?n.projectionNext:n.next}return r}var RO=function(){function e(t,n){Zg(this,e),this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}return Wg(e,[{key:"rootNodes",get:function(){var e=this._lView,t=e[1];return AO(t,e,t.firstChild,[])}},{key:"context",get:function(){return this._lView[8]},set:function(e){this._lView[8]=e}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}},{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){var e=this._lView[3];if(ek(e)){var t=e[8],n=t?t.indexOf(this):-1;n>-1&&(x_(e,n),tw(t,n))}this._attachedToViewContainer=!1}N_(this._lView[1],this._lView)}},{key:"onDestroy",value:function(e){FE(this._lView[1],this._lView,null,e)}},{key:"markForCheck",value:function(){rb(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){ib(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(e,t,n){Hk(!0);try{ib(e,t,n)}finally{Hk(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}},{key:"detachFromAppRef",value:function(){var e;this._appRef=null,J_(this._lView[1],e=this._lView,e[11],2,null,null)}},{key:"attachToAppRef",value:function(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}]),e}(),MO=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e))._view=e,r}return Wg(n,[{key:"detectChanges",value:function(){ab(this._view)}},{key:"checkNoChanges",value:function(){!function(e){Hk(!0);try{ab(e)}finally{Hk(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),n}(RO),xO=function(e){return function(e,t,n){if(nk(e)&&!n){var r=bk(e.index,t);return new RO(r,r)}return 47&e.type?new RO(t[16],t):null}(Dk(),Mk(),16==(16&e))},NO=function(){var e=Wg(function e(){Zg(this,e)});return e.__NG_ELEMENT_ID__=xO,e}(),DO=[new EO],LO=new OO([new gO]),FO=new IO(DO),UO=function(){return zO(Dk(),Mk())},VO=function(){var e=Wg(function e(){Zg(this,e)});return e.__NG_ELEMENT_ID__=UO,e}(),BO=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this))._declarationLView=e,a._declarationTContainer=r,a.elementRef=i,a}return Wg(n,[{key:"createEmbeddedView",value:function(e){var t=this._declarationTContainer.tViews,n=bE(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];var r=this._declarationLView[19];return null!==r&&(n[19]=r.createEmbeddedView(t)),TE(t,n,e),new RO(n)}}]),n}(VO);function zO(e,t){return 4&e.type?new BO(t,e,oO(e,t)):null}var HO=Wg(function e(){Zg(this,e)}),GO=Wg(function e(){Zg(this,e)}),$O=function(){return YO(Dk(),Mk())},ZO=function(){var e=Wg(function e(){Zg(this,e)});return e.__NG_ELEMENT_ID__=$O,e}(),qO=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this))._lContainer=e,a._hostTNode=r,a._hostLView=i,a}return Wg(n,[{key:"element",get:function(){return oO(this._hostTNode,this._hostLView)}},{key:"injector",get:function(){return new GC(this._hostTNode,this._hostLView)}},{key:"parentInjector",get:function(){var e=RC(this._hostTNode,this._hostLView);if(_C(e)){var t=bC(e,this._hostLView),n=EC(e);return new GC(t[1].data[n+8],t)}return new GC(null,this._hostLView)}},{key:"clear",value:function(){for(;this.length>0;)this.remove(this.length-1)}},{key:"get",value:function(e){var t=WO(this._lContainer);return null!==t&&t[e]||null}},{key:"length",get:function(){return this._lContainer.length-10}},{key:"createEmbeddedView",value:function(e,t,n){var r=e.createEmbeddedView(t||{});return this.insert(r,n),r}},{key:"createComponent",value:function(e,t,n,r,i){var a=n||this.parentInjector;if(!i&&null==e.ngModule&&a){var o=a.get(HO,null);o&&(i=o)}var s=e.create(a,r,void 0,i);return this.insert(s.hostView,t),s}},{key:"insert",value:function(e,t){var r=e._lView,i=r[1];if(ek(r[3])){var a=this.indexOf(e);if(-1!==a)this.detach(a);else{var o=r[3],s=new n(o,o[6],o[3]);s.detach(s.indexOf(e))}}var u=this._adjustIndex(t),c=this._lContainer;!function(e,t,n,r){var i=10+r,a=n.length;r>0&&(n[i-1][4]=t),r<a-10?(t[4]=n[i],ew(n,10+r,t)):(n.push(t),t[4]=null),t[3]=n;var o=t[17];null!==o&&n!==o&&function(e,t){var n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(o,t);var s=t[19];null!==s&&s.insertView(e),t[2]|=128}(i,r,c,u);var l=K_(u,c),f=r[11],h=z_(f,c[7]);return null!==h&&function(e,t,n,r,i,a){r[0]=i,r[6]=t,J_(e,r,n,1,i,a)}(i,c[6],f,r,h,l),e.attachToViewContainerRef(),ew(jO(c),u,e),e}},{key:"move",value:function(e,t){return this.insert(e,t)}},{key:"indexOf",value:function(e){var t=WO(this._lContainer);return null!==t?t.indexOf(e):-1}},{key:"remove",value:function(e){var t=this._adjustIndex(e,-1),n=x_(this._lContainer,t);n&&(tw(jO(this._lContainer),t),N_(n[1],n))}},{key:"detach",value:function(e){var t=this._adjustIndex(e,-1),n=x_(this._lContainer,t);return n&&null!=tw(jO(this._lContainer),t)?new RO(n):null}},{key:"_adjustIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null!=e?e:this.length+t}}]),n}(ZO);function WO(e){return e[8]}function jO(e){return e[8]||(e[8]=[])}function YO(e,t){var n,r=t[e.index];if(ek(r))n=r;else{var i;if(8&e.type)i=kk(r);else{var a=t[11];i=a.createComment("");var o=wk(e,t);U_(a,z_(a,o),i,function(e,t){return yk(e)?e.nextSibling(t):t.nextSibling}(a,o),!1)}t[e.index]=n=XE(r,t,i,e),nb(t,n)}return new qO(n,e,t)}var KO={},QO=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).ngModule=e,r}return Wg(n,[{key:"resolveComponentFactory",value:function(e){var t=Qm(e);return new eT(t,this.ngModule)}}]),n}(iO);function XO(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}var JO=new YC("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return m_}}),eT=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).componentDef=e,i.ngModule=r,i.componentType=e.type,i.selector=e.selectors.map(dE).join(","),i.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],i.isBoundToModule=!!r,i}return Wg(n,[{key:"inputs",get:function(){return XO(this.componentDef.inputs)}},{key:"outputs",get:function(){return XO(this.componentDef.outputs)}},{key:"create",value:function(e,t,n,r){var i,a,o=(r=r||this.ngModule)?function(e,t){return{get:function(n,r,i){var a=e.get(n,KO,i);return a!==KO||r===KO?a:t.get(n,r,i)}}}(e,r.injector):e,s=o.get(lO,mk),u=o.get(dO,null),c=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",f=n?function(e,t,n){if(yk(e))return e.selectRootElement(t,n===Tm.ShadowDom);var r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(c,n,this.componentDef.encapsulation):R_(s.createRenderer(null,this.componentDef),l,function(e){var t=e.toLowerCase();return"svg"===t?pk:"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),h=this.componentDef.onPush?576:528,d={components:[],scheduler:m_,clean:sb,playerHandler:null,flags:0},v=LE(0,null,null,1,0,null,null,null,null,null),p=bE(null,v,d,h,null,null,s,c,u,o);eC(p);try{var g=function(e,t,n,r,i,a){var o=n[1];n[20]=e;var s=PE(o,20,2,"#host",null),u=s.mergedAttrs=t.hostAttrs;null!==u&&(db(s,u,!0),null!==e&&(yC(i,e,u),null!==s.classes&&nE(i,e,s.classes),null!==s.styles&&tE(i,e,s.styles)));var c=r.createRenderer(e,t),l=bE(n,DE(t),null,t.onPush?64:16,n[20],s,r,c,null,null);return o.firstCreatePass&&(MC(TC(s,n),o,t.type),GE(o,s),ZE(s,n.length,1)),nb(n,l),n[20]=l}(f,this.componentDef,p,s,c);if(f)if(n)yC(c,f,["ng-version",pO.full]);else{var y=function(e){for(var t=[],n=[],r=1,i=2;r<e.length;){var a=e[r];if("string"==typeof a)2===i?""!==a&&t.push(a,e[++r]):8===i&&n.push(a);else{if(!cE(i))break;i=a}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]),m=y.attrs,k=y.classes;m&&yC(c,f,m),k&&k.length>0&&nE(c,f,k.join(" "))}if(a=_k(v,20),void 0!==t)for(var C=a.projection=[],w=0;w<this.ngContentSelectors.length;w++){var _=t[w];C.push(null!=_?Array.from(_):null)}i=function(e,t,n,r,i){var a=n[1],o=function(e,t,n){var r=Dk();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),qE(e,r,t,OE(e,t,1,null),n));var i=BC(t,e,r.directiveStart,r);f_(i,t);var a=wk(r,t);return a&&f_(a,t),i}(a,n,t);if(r.components.push(o),e[8]=o,i&&i.forEach(function(e){return e(o,t)}),t.contentQueries){var s=Dk();t.contentQueries(1,o,s.directiveStart)}var u=Dk();return!a.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(sC(u.index),zE(n[1],u,0,u.directiveStart,u.directiveEnd,t),HE(t,o)),o}(g,this.componentDef,p,d,[Ab]),TE(v,p,null)}finally{aC()}return new tT(this.componentType,i,oO(a,p),p,a)}}]),n}(nO),tT=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o){var s;return Zg(this,n),(s=t.call(this)).location=i,s._rootLView=a,s._tNode=o,s.instance=r,s.hostView=s.changeDetectorRef=new MO(a),s.componentType=e,s}return Wg(n,[{key:"injector",get:function(){return new GC(this._tNode,this._rootLView)}},{key:"destroy",value:function(){this.hostView.destroy()}},{key:"onDestroy",value:function(e){this.hostView.onDestroy(e)}}]),n}(function(){return Wg(function e(){Zg(this,e)})}()),nT=new Map,rT=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;Zg(this,n),(i=t.call(this))._parent=r,i._bootstrapComponents=[],i.injector=Fg(i),i.destroyCbs=[],i.componentFactoryResolver=new QO(Fg(i));var a=Xm(e),o=e[Vm]||null;return o&&nS(o),i._bootstrapComponents=k_(a.bootstrap),i._r3Injector=wb(e,r,[{provide:HO,useValue:Fg(i)},{provide:iO,useValue:i.componentFactoryResolver}],nm(e)),i._r3Injector._resolveInjectorDefTypes(),i.instance=i.get(e),i}return Wg(n,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ib.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Em.Default;return e===Ib||e===HO||e===pb?this:this._r3Injector.get(e,t,n)}},{key:"destroy",value:function(){var e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(function(e){return e()}),this.destroyCbs=null}},{key:"onDestroy",value:function(e){this.destroyCbs.push(e)}}]),n}(HO),iT=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).moduleType=e,null!==Xm(e)&&function(e){var t=new Set;!function e(n){var r=Xm(n,!0),i=r.id;null!==i&&(function(e,t,n){if(t&&t!==n)throw new Error("Duplicate module registered for ".concat(e," - ").concat(nm(t)," vs ").concat(nm(t.name)))}(i,nT.get(i),n),nT.set(i,n));var a,o=Hg(k_(r.imports));try{for(o.s();!(a=o.n()).done;){var s=a.value;t.has(s)||(t.add(s),e(s))}}catch(u){o.e(u)}finally{o.f()}}(e)}(e),r}return Wg(n,[{key:"create",value:function(e){return new rT(this.moduleType,e)}}]),n}(GO);function aT(e,t,n){var r=Gk()+e,i=Mk();return i[r]===vE?zb(i,r,n?t.call(n):t()):function(e,t){return e[t]}(i,r)}function oT(e,t,n,r){return cT(Mk(),Gk(),e,t,n,r)}function sT(e,t,n,r,i){return lT(Mk(),Gk(),e,t,n,r,i)}function uT(e,t){var n=e[t];return n===vE?void 0:n}function cT(e,t,n,r,i,a){var o=t+n;return Hb(e,o,i)?zb(e,o+1,a?r.call(a,i):r(i)):uT(e,o+1)}function lT(e,t,n,r,i,a,o){var s=t+n;return Gb(e,s,i,a)?zb(e,s+2,o?r.call(o,i,a):r(i,a)):uT(e,s+2)}function fT(e,t){var n,r=xk(),i=e+20;r.firstCreatePass?(n=function(e,t){if(t)for(var n=t.length-1;n>=0;n--){var r=t[n];if(e===r.name)return r}throw new um("302","The pipe '".concat(e,"' could not be found!"))}(t,r.pipeRegistry),r.data[i]=n,n.onDestroy&&(r.destroyHooks||(r.destroyHooks=[])).push(i,n.onDestroy)):n=r.data[i];var a=n.factory||(n.factory=ok(n.type)),o=bm(Qb);try{var s=SC(!1),u=a();return SC(s),function(e,t,n,r){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=r}(r,Mk(),i,u),u}finally{bm(o)}}function hT(e,t,n){var r=e+20,i=Mk(),a=Ek(i,r);return vT(i,dT(i,r)?cT(i,Gk(),t,a.transform,n,a):a.transform(n))}function dT(e,t){return e[1].data[t].pure}function vT(e,t){return Ub.isWrapped(t)&&(t=Ub.unwrap(t),e[$k()]=vE),t}function pT(e){return function(t){setTimeout(e,void 0,t)}}var gT=function(e){xg(n,e);var t=Dg(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Zg(this,n),(e=t.call(this)).__isAsync=r,e}return Wg(n,[{key:"emit",value:function(e){Rg(Vg(n.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,t,r){var i,a,o,s=e,u=t||function(){return null},c=r;if(e&&"object"==typeof e){var l=e;s=null===(i=l.next)||void 0===i?void 0:i.bind(l),u=null===(a=l.error)||void 0===a?void 0:a.bind(l),c=null===(o=l.complete)||void 0===o?void 0:o.bind(l)}this.__isAsync&&(u=pT(u),s&&(s=pT(s)),c&&(c=pT(c)));var f=Rg(Vg(n.prototype),"subscribe",this).call(this,{next:s,error:u,complete:c});return e instanceof qg&&e.add(f),f}}]),n}(Cy);function yT(){return this._results[Fb()]()}var mT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Zg(this,e),this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;var n=Fb(),r=e.prototype;r[n]||(r[n]=yT)}return Wg(e,[{key:"changes",get:function(){return this._changes||(this._changes=new gT)}},{key:"get",value:function(e){return this._results[e]}},{key:"map",value:function(e){return this._results.map(e)}},{key:"filter",value:function(e){return this._results.filter(e)}},{key:"find",value:function(e){return this._results.find(e)}},{key:"reduce",value:function(e,t){return this._results.reduce(e,t)}},{key:"forEach",value:function(e){this._results.forEach(e)}},{key:"some",value:function(e){return this._results.some(e)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(e,t){var n=this;n.dirty=!1;var r=XC(e);(this._changesDetected=!function(e,t,n){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++){var i=e[r],a=t[r];if(n&&(i=n(i),a=n(a)),a!==i)return!1}return!0}(n._results,r,t))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}},{key:"notifyOnChanges",value:function(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),e}();Symbol;var kT=function(){function e(t){Zg(this,e),this.queryList=t,this.matches=null}return Wg(e,[{key:"clone",value:function(){return new e(this.queryList)}},{key:"setDirty",value:function(){this.queryList.setDirty()}}]),e}(),CT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Zg(this,e),this.queries=t}return Wg(e,[{key:"createEmbeddedView",value:function(t){var n=t.queries;if(null!==n){for(var r=null!==t.contentQueries?t.contentQueries[0]:n.length,i=[],a=0;a<r;a++){var o=n.getByIndex(a);i.push(this.queries[o.indexInDeclarationView].clone())}return new e(i)}return null}},{key:"insertView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"detachView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"dirtyQueriesWithMatches",value:function(e){for(var t=0;t<this.queries.length;t++)null!==RT(e,t).matches&&this.queries[t].setDirty()}}]),e}(),wT=Wg(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Zg(this,e),this.predicate=t,this.flags=n,this.read=r}),_T=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Zg(this,e),this.queries=t}return Wg(e,[{key:"elementStart",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}},{key:"elementEnd",value:function(e){for(var t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}},{key:"embeddedTView",value:function(t){for(var n=null,r=0;r<this.length;r++){var i=null!==n?n.length:0,a=this.getByIndex(r).embeddedTView(t,i);a&&(a.indexInDeclarationView=r,null!==n?n.push(a):n=[a])}return null!==n?new e(n):null}},{key:"template",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}},{key:"getByIndex",value:function(e){return this.queries[e]}},{key:"length",get:function(){return this.queries.length}},{key:"track",value:function(e){this.queries.push(e)}}]),e}(),ET=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;Zg(this,e),this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}return Wg(e,[{key:"elementStart",value:function(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}},{key:"elementEnd",value:function(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}},{key:"template",value:function(e,t){this.elementStart(e,t)}},{key:"embeddedTView",value:function(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new e(this.metadata)):null}},{key:"isApplyingToNode",value:function(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){for(var t=this._declarationNodeIndex,n=e.parent;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}},{key:"matchTNode",value:function(e,t){var n=this.metadata.predicate;if(Array.isArray(n))for(var r=0;r<n.length;r++){var i=n[r];this.matchTNodeWithReadOption(e,t,bT(t,i)),this.matchTNodeWithReadOption(e,t,VC(t,e,i,!1,!1))}else n===VO?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,VC(t,e,n,!1,!1))}},{key:"matchTNodeWithReadOption",value:function(e,t,n){if(null!==n){var r=this.metadata.read;if(null!==r)if(r===uO||r===ZO||r===VO&&4&t.type)this.addMatch(t.index,-2);else{var i=VC(t,e,r,!1,!1);null!==i&&this.addMatch(t.index,i)}else this.addMatch(t.index,n)}}},{key:"addMatch",value:function(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}]),e}();function bT(e,t){var n=e.localNames;if(null!==n)for(var r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function PT(e,t,n,r){return-1===n?function(e,t){return 11&e.type?oO(e,t):4&e.type?zO(e,t):null}(t,e):-2===n?function(e,t,n){return n===uO?oO(t,e):n===VO?zO(t,e):n===ZO?YO(t,e):void 0}(e,t,r):BC(e,e[1],n,t)}function ST(e,t,n,r){var i=t[19].queries[r];if(null===i.matches){for(var a=e.data,o=n.matches,s=[],u=0;u<o.length;u+=2){var c=o[u];s.push(c<0?null:PT(t,a[c],o[u+1],n.metadata.read))}i.matches=s}return i.matches}function OT(e,t,n,r){var i=e.queries.getByIndex(n),a=i.matches;if(null!==a)for(var o=ST(e,t,i,n),s=0;s<a.length;s+=2){var u=a[s];if(u>0)r.push(o[s/2]);else{for(var c=a[s+1],l=t[-u],f=10;f<l.length;f++){var h=l[f];h[17]===h[3]&&OT(h[1],h,c,r)}if(null!==l[9])for(var d=l[9],v=0;v<d.length;v++){var p=d[v];OT(p[1],p,c,r)}}}return r}function TT(e){var t=Mk(),n=xk(),r=Kk();Qk(r+1);var i=RT(n,r);if(e.dirty&&Pk(t)===(2==(2&i.metadata.flags))){if(null===i.matches)e.reset([]);else{var a=i.crossesNgTemplate?OT(n,t,r,[]):ST(n,t,i,r);e.reset(a,cO),e.notifyOnChanges()}return!0}return!1}function IT(e,t,n){var r=xk();r.firstCreatePass&&(function(e,t,n){null===e.queries&&(e.queries=new _T),e.queries.track(new ET(t,-1))}(r,new wT(e,t,n)),2==(2&t)&&(r.staticViewQueries=!0)),function(e,t,n){var r=new mT(4==(4&n));FE(e,t,r,r.destroy),null===t[19]&&(t[19]=new CT),t[19].queries.push(new kT(r))}(r,Mk(),t)}function AT(){return e=Mk(),t=Kk(),e[19].queries[t].queryList;var e,t}function RT(e,t){return e.queries.getByIndex(t)}function MT(e,t){return zO(e,t)}var xT=new YC("Application Initializer"),NT=function(){var e=function(){function e(t){var n=this;Zg(this,e),this.appInits=t,this.resolve=aO,this.reject=aO,this.initialized=!1,this.done=!1,this.donePromise=new Promise(function(e,t){n.resolve=e,n.reject=t})}return Wg(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var r=function(n){var r=e.appInits[n]();if(oP(r))t.push(r);else if(sP(r)){var i=new Promise(function(e,t){r.subscribe({complete:e,error:t})});t.push(i)}},i=0;i<this.appInits.length;i++)r(i);Promise.all(t).then(function(){n()}).catch(function(t){e.reject(t)}),0===t.length&&n(),this.initialized=!0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(xT,8))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),DT=new YC("AppId"),LT={provide:DT,useFactory:function(){return"".concat(FT()).concat(FT()).concat(FT())},deps:[]};function FT(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var UT=new YC("Platform Initializer"),VT=new YC("Platform ID"),BT=new YC("appBootstrapListener"),zT=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),HT=new YC("LocaleId"),GT=new YC("DefaultCurrencyCode"),$T=Wg(function e(t,n){Zg(this,e),this.ngModuleFactory=t,this.componentFactories=n}),ZT=function(e){return new iT(e)},qT=ZT,WT=function(e){return Promise.resolve(ZT(e))},jT=function(e){var t=ZT(e),n=k_(Xm(e).declarations).reduce(function(e,t){var n=Qm(t);return n&&e.push(new eT(n)),e},[]);return new $T(t,n)},YT=jT,KT=function(e){return Promise.resolve(jT(e))},QT=function(){var e=function(){function e(){Zg(this,e),this.compileModuleSync=qT,this.compileModuleAsync=WT,this.compileModuleAndAllComponentsSync=YT,this.compileModuleAndAllComponentsAsync=KT}return Wg(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),XT=Promise.resolve(0);function JT(e){"undefined"==typeof Zone?XT.then(function(){e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var eI=function(){function e(t){var n=t.enableLongStackTrace,r=void 0!==n&&n,i=t.shouldCoalesceEventChangeDetection,a=void 0!==i&&i,o=t.shouldCoalesceRunChangeDetection,s=void 0!==o&&o;if(Zg(this,e),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new gT(!1),this.onMicrotaskEmpty=new gT(!1),this.onStable=new gT(!1),this.onError=new gT(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();var u=this;u._nesting=0,u._outer=u._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(u._inner=u._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(u._inner=u._inner.fork(Zone.longStackTraceZoneSpec)),u.shouldCoalesceEventChangeDetection=!s&&a,u.shouldCoalesceRunChangeDetection=s,u.lastRequestAnimationFrameId=-1,u.nativeRequestAnimationFrame=function(){var e=Mm.requestAnimationFrame,t=Mm.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){var n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);var r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){var t=function(){!function(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Mm,function(){e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",function(){e.lastRequestAnimationFrameId=-1,rI(e),e.isCheckStableRunning=!0,nI(e),e.isCheckStableRunning=!1},void 0,function(){},function(){})),e.fakeTopEventTask.invoke()}),rI(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(n,r,i,a,o,s){try{return iI(e),n.invokeTask(i,a,o,s)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===a.type||e.shouldCoalesceRunChangeDetection)&&t(),aI(e)}},onInvoke:function(n,r,i,a,o,s,u){try{return iI(e),n.invoke(i,a,o,s,u)}finally{e.shouldCoalesceRunChangeDetection&&t(),aI(e)}},onHasTask:function(t,n,r,i){t.hasTask(r,i),n===r&&("microTask"==i.change?(e._hasPendingMicrotasks=i.microTask,rI(e),nI(e)):"macroTask"==i.change&&(e.hasPendingMacrotasks=i.macroTask))},onHandleError:function(t,n,r,i){return t.handleError(r,i),e.runOutsideAngular(function(){return e.onError.emit(i)}),!1}})}(u)}return Wg(e,[{key:"run",value:function(e,t,n){return this._inner.run(e,t,n)}},{key:"runTask",value:function(e,t,n,r){var i=this._inner,a=i.scheduleEventTask("NgZoneEvent: "+r,e,tI,aO,aO);try{return i.runTask(a,t,n)}finally{i.cancelTask(a)}}},{key:"runGuarded",value:function(e,t,n){return this._inner.runGuarded(e,t,n)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}(),tI={};function nI(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(function(){return e.onStable.emit(null)})}finally{e.isStable=!0}}}function rI(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function iI(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function aI(e){e._nesting--,nI(e)}var oI,sI=function(){function e(){Zg(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new gT,this.onMicrotaskEmpty=new gT,this.onStable=new gT,this.onError=new gT}return Wg(e,[{key:"run",value:function(e,t,n){return e.apply(t,n)}},{key:"runGuarded",value:function(e,t,n){return e.apply(t,n)}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e,t,n,r){return e.apply(t,n)}}]),e}(),uI=function(){var e=function(){function e(t){var n=this;Zg(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}return Wg(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular(function(){e._ngZone.onStable.subscribe({next:function(){eI.assertNotInAngularZone(),JT(function(){e._isZoneStable=!0,e._runCallbacksIfReady()})}})})}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())JT(function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1});else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter(function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)}),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}}):[]}},{key:"addCallback",value:function(e,t,n){var r=this,i=-1;t&&t>0&&(i=setTimeout(function(){r._callbacks=r._callbacks.filter(function(e){return e.timeoutId!==i}),e(r._didWork,r.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:n})}},{key:"whenStable",value:function(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,n){return[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(eI))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),cI=function(){var e=function(){function e(){Zg(this,e),this._applications=new Map,lI.addToWindow(this)}return Wg(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return lI.findTestabilityInTree(this,e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),lI=new(function(){function e(){Zg(this,e)}return Wg(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,n){return null}}]),e}()),fI=!0,hI=!1,dI=new YC("AllowMultipleToken"),vI=Wg(function e(t,n){Zg(this,e),this.name=t,this.token=n});function pI(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="Platform: ".concat(t),i=new YC(r);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=gI();if(!a||a.injector.get(dI,!1))if(e)e(n.concat(t).concat({provide:i,useValue:!0}));else{var o=n.concat(t).concat({provide:i,useValue:!0},{provide:yb,useValue:"platform"});!function(e){if(oI&&!oI.destroyed&&!oI.injector.get(dI,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");oI=e.get(yI);var t=e.get(UT,null);t&&t.forEach(function(e){return e()})}(Ib.create({providers:o,name:r}))}return function(e){var t=gI();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(i)}}function gI(){return oI&&!oI.destroyed?oI:null}var yI=function(){var e=function(){function e(t){Zg(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return Wg(e,[{key:"bootstrapModuleFactory",value:function(e,t){var n=this,r=function(e,t){return"noop"===e?new sI:("zone.js"===e?void 0:e)||new eI({enableLongStackTrace:(hI=!0,fI),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)})}(t?t.ngZone:void 0,{ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1}),i=[{provide:eI,useValue:r}];return r.run(function(){var a=Ib.create({providers:i,parent:n.injector,name:e.moduleType.name}),o=e.create(a),s=o.injector.get(p_,null);if(!s)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return r.runOutsideAngular(function(){var e=r.onError.subscribe({next:function(e){s.handleError(e)}});o.onDestroy(function(){CI(n._modules,o),e.unsubscribe()})}),function(e,r,i){try{var a=((s=o.injector.get(NT)).runInitializers(),s.donePromise.then(function(){return nS(o.injector.get(HT,QP)||QP),n._moduleDoBootstrap(o),o}));return oP(a)?a.catch(function(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}):a}catch(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}var s}(s,r)})}},{key:"bootstrapModule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=mI({},n);return function(e,t,n){var r=new iT(n);return Promise.resolve(r)}(0,0,e).then(function(e){return t.bootstrapModuleFactory(e,r)})}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(kI);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(function(e){return t.bootstrap(e)});else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(nm(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.'));e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"injector",get:function(){return this._injector}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(function(e){return e.destroy()}),this._destroyListeners.forEach(function(e){return e()}),this._destroyed=!0}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(Ib))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}();function mI(e,t){return Array.isArray(t)?t.reduce(mI,e):Object.assign(Object.assign({},e),t)}var kI=function(){var e=function(){function e(t,n,r,i,a){var o=this;Zg(this,e),this._zone=t,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:function(){o._zone.run(function(){o.tick()})}});var s=new yy(function(e){o._stable=o._zone.isStable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks,o._zone.runOutsideAngular(function(){e.next(o._stable),e.complete()})}),u=new yy(function(e){var t;o._zone.runOutsideAngular(function(){t=o._zone.onStable.subscribe(function(){eI.assertNotInAngularZone(),JT(function(){!o._stable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks&&(o._stable=!0,e.next(!0))})})});var n=o._zone.onUnstable.subscribe(function(){eI.assertInAngularZone(),o._stable&&(o._stable=!1,o._zone.runOutsideAngular(function(){e.next(!1)}))});return function(){t.unsubscribe(),n.unsubscribe()}});this.isStable=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Wy(t),i=function(e,t){return"number"==typeof Zy(e)?e.pop():1/0}(t),a=t;return a.length?1===a.length?Vy(a[0]):Gy(i)(Qy(a,r)):$y}(s,u.pipe(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.connector,n=void 0===t?function(){return new Cy}:t,r=e.resetOnError,i=void 0===r||r,a=e.resetOnComplete,o=void 0===a||a,s=e.resetOnRefCountZero,u=void 0===s||s;return function(e){var t=null,r=null,a=null,s=0,c=!1,l=!1,f=function(){null==r||r.unsubscribe(),r=null},h=function(){f(),t=a=null,c=l=!1},d=function(){var e=t;h(),null==e||e.unsubscribe()};return Ey(function(e,v){var p;s++,!l&&!c&&f();var g=a=null!==(p=a)&&void 0!==p?p:n();v.add(function(){0===--s&&!l&&!c&&(r=Jy(d,u))}),g.subscribe(v),t||(t=new ly({next:function(e){return g.next(e)},error:function(e){l=!0,f(),r=Jy(h,i,e),g.error(e)},complete:function(){c=!0,f(),r=Jy(h,o),g.complete()}}),Qy(e).subscribe(t))})(e)}}()))}return Wg(e,[{key:"bootstrap",value:function(e,t){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof nO?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var i=function(e){return e.isBoundToModule}(n)?void 0:this._injector.get(HO),a=n.create(Ib.NULL,[],t||n.selector,i),o=a.location.nativeElement,s=a.injector.get(uI,null),u=s&&a.injector.get(cI);return s&&u&&u.registerApplication(o,s),a.onDestroy(function(){r.detachView(a.hostView),CI(r.components,a),u&&u.unregisterApplication(o)}),this._loadComponent(a),a}},{key:"tick",value:function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;var t,n=Hg(this._views);try{for(n.s();!(t=n.n()).done;){var r;t.value.detectChanges()}}catch(i){n.e(i)}finally{n.f()}}catch(r){this._zone.runOutsideAngular(function(){return e._exceptionHandler.handleError(r)})}finally{this._runningTick=!1}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;CI(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(BT,[]).concat(this._bootstrapListeners).forEach(function(t){return t(e)})}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach(function(e){return e.destroy()}),this._onMicrotaskEmptySubscription.unsubscribe()}},{key:"viewCount",get:function(){return this._views.length}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(eI),pw(Ib),pw(p_),pw(iO),pw(NT))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}();function CI(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var wI=Wg(function e(){Zg(this,e)}),_I=Wg(function e(){Zg(this,e)}),EI={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},bI=function(){var e=function(){function e(t,n){Zg(this,e),this._compiler=t,this._config=n||EI}return Wg(e,[{key:"load",value:function(e){return this.loadAndCompile(e)}},{key:"loadAndCompile",value:function(e){var t=this,n=Sg(e.split("#"),2),r=n[0],i=n[1];return void 0===i&&(i="default"),Tg(8255)(r).then(function(e){return e[i]}).then(function(e){return PI(e,r,i)}).then(function(e){return t._compiler.compileModuleAsync(e)})}},{key:"loadFactory",value:function(e){var t=Sg(e.split("#"),2),n=t[0],r=t[1],i="NgFactory";return void 0===r&&(r="default",i=""),Tg(8255)(this._config.factoryPathPrefix+n+this._config.factoryPathSuffix).then(function(e){return e[r+i]}).then(function(e){return PI(e,n,r)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(QT),pw(_I,8))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}();function PI(e,t,n){if(!e)throw new Error("Cannot find '".concat(n,"' in '").concat(t,"'"));return e}var SI=pI(null,"core",[{provide:VT,useValue:"unknown"},{provide:yI,deps:[Ib]},{provide:cI,deps:[]},{provide:zT,deps:[]}]),OI=[{provide:kI,useClass:kI,deps:[eI,Ib,p_,iO,NT]},{provide:JO,deps:[eI],useFactory:function(e){var t=[];return e.onStable.subscribe(function(){for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:NT,useClass:NT,deps:[[new Ew,xT]]},{provide:QT,useClass:QT,deps:[]},LT,{provide:OO,useFactory:function(){return LO},deps:[]},{provide:IO,useFactory:function(){return FO},deps:[]},{provide:HT,useFactory:function(e){return nS(e=e||"undefined"!=typeof $localize&&$localize.locale||QP),e},deps:[[new _w(HT),new Ew,new bw]]},{provide:GT,useValue:"USD"}],TI=function(){var e=Wg(function e(t){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)(pw(kI))},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({providers:OI}),e}(),II=null;function AI(){return II}var RI=new YC("DocumentToken"),MI=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({factory:xI,token:e,providedIn:"platform"}),e}();function xI(){return pw(DI)}var NI=new YC("Location Initialized"),DI=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this))._doc=e,r._init(),r}return Wg(n,[{key:"_init",value:function(){this.location=window.location,this._history=window.history}},{key:"getBaseHrefFromDOM",value:function(){return AI().getBaseHref(this._doc)}},{key:"onPopState",value:function(e){var t=AI().getGlobalEventTarget(this._doc,"window");return t.addEventListener("popstate",e,!1),function(){return t.removeEventListener("popstate",e)}}},{key:"onHashChange",value:function(e){var t=AI().getGlobalEventTarget(this._doc,"window");return t.addEventListener("hashchange",e,!1),function(){return t.removeEventListener("hashchange",e)}}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(e){this.location.pathname=e}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}},{key:"pushState",value:function(e,t,n){LI()?this._history.pushState(e,t,n):this.location.hash=n}},{key:"replaceState",value:function(e,t,n){LI()?this._history.replaceState(e,t,n):this.location.hash=n}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"historyGo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._history.go(e)}},{key:"getState",value:function(){return this._history.state}}]),n}(MI);return e.\u0275fac=function(t){return new(t||e)(pw(RI))},e.\u0275prov=dm({factory:FI,token:e,providedIn:"platform"}),e}();function LI(){return!!window.history.pushState}function FI(){return new DI(pw(RI))}function UI(e,t){if(0==e.length)return t;if(0==t.length)return e;var n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function VI(e){var t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function BI(e){return e&&"?"!==e[0]?"?"+e:e}var zI=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({factory:HI,token:e,providedIn:"root"}),e}();function HI(e){var t=pw(RI).location;return new $I(pw(MI),t&&t.origin||"")}var GI=new YC("appBaseHref"),$I=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;if(Zg(this,n),(i=t.call(this))._platformLocation=e,i._removeListenerFns=[],null==r&&(r=i._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return i._baseHref=r,Lg(i)}return Wg(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(e){return UI(this._baseHref,e)}},{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._platformLocation.pathname+BI(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?"".concat(t).concat(n):t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+BI(r));this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+BI(r));this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(zI);return e.\u0275fac=function(t){return new(t||e)(pw(MI),pw(GI,8))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),ZI=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this))._platformLocation=e,i._baseHref="",i._removeListenerFns=[],null!=r&&(i._baseHref=r),i}return Wg(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){var e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}},{key:"prepareExternalUrl",value:function(e){var t=UI(this._baseHref,e);return t.length>0?"#"+t:t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+BI(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+BI(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(zI);return e.\u0275fac=function(t){return new(t||e)(pw(MI),pw(GI,8))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),qI=function(){var e=function(){function e(t,n){var r=this;Zg(this,e),this._subject=new gT,this._urlChangeListeners=[],this._platformStrategy=t;var i=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=VI(jI(i)),this._platformStrategy.onPopState(function(e){r._subject.emit({url:r.path(!0),pop:!0,state:e.state,type:e.type})})}return Wg(e,[{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(e))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(e+BI(t))}},{key:"normalize",value:function(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,jI(t)))}},{key:"prepareExternalUrl",value:function(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}},{key:"go",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+BI(t)),n)}},{key:"replaceState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+BI(t)),n)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformStrategy).historyGo)||void 0===t||t.call(e,n)}},{key:"onUrlChange",value:function(e){var t=this;this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(function(e){t._notifyUrlChangeListeners(e.url,e.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach(function(n){return n(e,t)})}},{key:"subscribe",value:function(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(zI),pw(MI))},e.normalizeQueryParams=BI,e.joinWithSlash=UI,e.stripTrailingSlash=VI,e.\u0275prov=dm({factory:WI,token:e,providedIn:"root"}),e}();function WI(){return new qI(pw(zI),pw(MI))}function jI(e){return e.replace(/\/index.html$/,"")}var YI=((YI=YI||{})[YI.Decimal=0]="Decimal",YI[YI.Percent=1]="Percent",YI[YI.Currency=2]="Currency",YI[YI.Scientific=3]="Scientific",YI),KI=((KI=KI||{})[KI.Zero=0]="Zero",KI[KI.One=1]="One",KI[KI.Two=2]="Two",KI[KI.Few=3]="Few",KI[KI.Many=4]="Many",KI[KI.Other=5]="Other",KI),QI=((QI=QI||{})[QI.Format=0]="Format",QI[QI.Standalone=1]="Standalone",QI),XI=((XI=XI||{})[XI.Narrow=0]="Narrow",XI[XI.Abbreviated=1]="Abbreviated",XI[XI.Wide=2]="Wide",XI[XI.Short=3]="Short",XI),JI=((JI=JI||{})[JI.Short=0]="Short",JI[JI.Medium=1]="Medium",JI[JI.Long=2]="Long",JI[JI.Full=3]="Full",JI),eA=((eA=eA||{})[eA.Decimal=0]="Decimal",eA[eA.Group=1]="Group",eA[eA.List=2]="List",eA[eA.PercentSign=3]="PercentSign",eA[eA.PlusSign=4]="PlusSign",eA[eA.MinusSign=5]="MinusSign",eA[eA.Exponential=6]="Exponential",eA[eA.SuperscriptingExponent=7]="SuperscriptingExponent",eA[eA.PerMille=8]="PerMille",eA[eA.Infinity=9]="Infinity",eA[eA.NaN=10]="NaN",eA[eA.TimeSeparator=11]="TimeSeparator",eA[eA.CurrencyDecimal=12]="CurrencyDecimal",eA[eA.CurrencyGroup=13]="CurrencyGroup",eA);function tA(e,t){return sA(qP(e)[YP.DateFormat],t)}function nA(e,t){return sA(qP(e)[YP.TimeFormat],t)}function rA(e,t){return sA(qP(e)[YP.DateTimeFormat],t)}function iA(e,t){var n=qP(e),r=n[YP.NumberSymbols][t];if(void 0===r){if(t===eA.CurrencyDecimal)return n[YP.NumberSymbols][eA.Decimal];if(t===eA.CurrencyGroup)return n[YP.NumberSymbols][eA.Group]}return r}var aA=WP;function oA(e){if(!e[YP.ExtraData])throw new Error('Missing extra locale data for the locale "'.concat(e[YP.LocaleId],'". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.'))}function sA(e,t){for(var n=t;n>-1;n--)if(void 0!==e[n])return e[n];throw new Error("Locale data API: locale data undefined")}function uA(e){var t=Sg(e.split(":"),2);return{hours:+t[0],minutes:+t[1]}}var cA=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,lA={},fA=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,hA=((hA=hA||{})[hA.Short=0]="Short",hA[hA.ShortGMT=1]="ShortGMT",hA[hA.Long=2]="Long",hA[hA.Extended=3]="Extended",hA),dA=((dA=dA||{})[dA.FullYear=0]="FullYear",dA[dA.Month=1]="Month",dA[dA.Date=2]="Date",dA[dA.Hours=3]="Hours",dA[dA.Minutes=4]="Minutes",dA[dA.Seconds=5]="Seconds",dA[dA.FractionalSeconds=6]="FractionalSeconds",dA[dA.Day=7]="Day",dA),vA=((vA=vA||{})[vA.DayPeriods=0]="DayPeriods",vA[vA.Days=1]="Days",vA[vA.Months=2]="Months",vA[vA.Eras=3]="Eras",vA);function pA(e,t,n,r){var i=function(e){if(TA(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){var t=e.split("-").map(function(e){return+e}),n=Sg(t,3),r=n[0],i=n[1],a=void 0===i?1:i,o=n[2];return gA(r,a-1,void 0===o?1:o)}var s,u=parseFloat(e);if(!isNaN(e-u))return new Date(u);if(s=e.match(cA))return function(e){var t=new Date(0),n=0,r=0,i=e[8]?t.setUTCFullYear:t.setFullYear,a=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),r=Number(e[9]+e[11])),i.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));var o=Number(e[4]||0)-n,s=Number(e[5]||0)-r,u=Number(e[6]||0),c=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return a.call(t,o,s,u,c),t}(s)}var c=new Date(e);if(!TA(c))throw new Error('Unable to convert "'.concat(e,'" into a date'));return c}(e);t=yA(n,t)||t;for(var a,o=[];t;){if(!(a=fA.exec(t))){o.push(t);break}var s=(o=o.concat(a.slice(1))).pop();if(!s)break;t=s}var u=i.getTimezoneOffset();r&&(u=OA(r,u),i=function(e,t,n){var r=e.getTimezoneOffset();return function(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,-1*(OA(t,r)-r))}(i,r));var c="";return o.forEach(function(e){var t=function(e){if(SA[e])return SA[e];var t;switch(e){case"G":case"GG":case"GGG":t=wA(vA.Eras,XI.Abbreviated);break;case"GGGG":t=wA(vA.Eras,XI.Wide);break;case"GGGGG":t=wA(vA.Eras,XI.Narrow);break;case"y":t=CA(dA.FullYear,1,0,!1,!0);break;case"yy":t=CA(dA.FullYear,2,0,!0,!0);break;case"yyy":t=CA(dA.FullYear,3,0,!1,!0);break;case"yyyy":t=CA(dA.FullYear,4,0,!1,!0);break;case"Y":t=PA(1);break;case"YY":t=PA(2,!0);break;case"YYY":t=PA(3);break;case"YYYY":t=PA(4);break;case"M":case"L":t=CA(dA.Month,1,1);break;case"MM":case"LL":t=CA(dA.Month,2,1);break;case"MMM":t=wA(vA.Months,XI.Abbreviated);break;case"MMMM":t=wA(vA.Months,XI.Wide);break;case"MMMMM":t=wA(vA.Months,XI.Narrow);break;case"LLL":t=wA(vA.Months,XI.Abbreviated,QI.Standalone);break;case"LLLL":t=wA(vA.Months,XI.Wide,QI.Standalone);break;case"LLLLL":t=wA(vA.Months,XI.Narrow,QI.Standalone);break;case"w":t=bA(1);break;case"ww":t=bA(2);break;case"W":t=bA(1,!0);break;case"d":t=CA(dA.Date,1);break;case"dd":t=CA(dA.Date,2);break;case"c":case"cc":t=CA(dA.Day,1);break;case"ccc":t=wA(vA.Days,XI.Abbreviated,QI.Standalone);break;case"cccc":t=wA(vA.Days,XI.Wide,QI.Standalone);break;case"ccccc":t=wA(vA.Days,XI.Narrow,QI.Standalone);break;case"cccccc":t=wA(vA.Days,XI.Short,QI.Standalone);break;case"E":case"EE":case"EEE":t=wA(vA.Days,XI.Abbreviated);break;case"EEEE":t=wA(vA.Days,XI.Wide);break;case"EEEEE":t=wA(vA.Days,XI.Narrow);break;case"EEEEEE":t=wA(vA.Days,XI.Short);break;case"a":case"aa":case"aaa":t=wA(vA.DayPeriods,XI.Abbreviated);break;case"aaaa":t=wA(vA.DayPeriods,XI.Wide);break;case"aaaaa":t=wA(vA.DayPeriods,XI.Narrow);break;case"b":case"bb":case"bbb":t=wA(vA.DayPeriods,XI.Abbreviated,QI.Standalone,!0);break;case"bbbb":t=wA(vA.DayPeriods,XI.Wide,QI.Standalone,!0);break;case"bbbbb":t=wA(vA.DayPeriods,XI.Narrow,QI.Standalone,!0);break;case"B":case"BB":case"BBB":t=wA(vA.DayPeriods,XI.Abbreviated,QI.Format,!0);break;case"BBBB":t=wA(vA.DayPeriods,XI.Wide,QI.Format,!0);break;case"BBBBB":t=wA(vA.DayPeriods,XI.Narrow,QI.Format,!0);break;case"h":t=CA(dA.Hours,1,-12);break;case"hh":t=CA(dA.Hours,2,-12);break;case"H":t=CA(dA.Hours,1);break;case"HH":t=CA(dA.Hours,2);break;case"m":t=CA(dA.Minutes,1);break;case"mm":t=CA(dA.Minutes,2);break;case"s":t=CA(dA.Seconds,1);break;case"ss":t=CA(dA.Seconds,2);break;case"S":t=CA(dA.FractionalSeconds,1);break;case"SS":t=CA(dA.FractionalSeconds,2);break;case"SSS":t=CA(dA.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=_A(hA.Short);break;case"ZZZZZ":t=_A(hA.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=_A(hA.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=_A(hA.Long);break;default:return null}return SA[e]=t,t}(e);c+=t?t(i,n,u):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function gA(e,t,n){var r=new Date(0);return r.setFullYear(e,t,n),r.setHours(0,0,0),r}function yA(e,t){var n=function(e){return qP(e)[YP.LocaleId]}(e);if(lA[n]=lA[n]||{},lA[n][t])return lA[n][t];var r="";switch(t){case"shortDate":r=tA(e,JI.Short);break;case"mediumDate":r=tA(e,JI.Medium);break;case"longDate":r=tA(e,JI.Long);break;case"fullDate":r=tA(e,JI.Full);break;case"shortTime":r=nA(e,JI.Short);break;case"mediumTime":r=nA(e,JI.Medium);break;case"longTime":r=nA(e,JI.Long);break;case"fullTime":r=nA(e,JI.Full);break;case"short":var i=yA(e,"shortTime"),a=yA(e,"shortDate");r=mA(rA(e,JI.Short),[i,a]);break;case"medium":var o=yA(e,"mediumTime"),s=yA(e,"mediumDate");r=mA(rA(e,JI.Medium),[o,s]);break;case"long":var u=yA(e,"longTime"),c=yA(e,"longDate");r=mA(rA(e,JI.Long),[u,c]);break;case"full":var l=yA(e,"fullTime"),f=yA(e,"fullDate");r=mA(rA(e,JI.Full),[l,f])}return r&&(lA[n][t]=r),r}function mA(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),e}function kA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-",r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a="";(e<0||i&&e<=0)&&(i?e=1-e:(e=-e,a=n));for(var o=String(e);o.length<t;)o="0"+o;return r&&(o=o.substr(o.length-t)),a+o}function CA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function(a,o){var s=function(e,t){switch(e){case dA.FullYear:return t.getFullYear();case dA.Month:return t.getMonth();case dA.Date:return t.getDate();case dA.Hours:return t.getHours();case dA.Minutes:return t.getMinutes();case dA.Seconds:return t.getSeconds();case dA.FractionalSeconds:return t.getMilliseconds();case dA.Day:return t.getDay();default:throw new Error('Unknown DateType value "'.concat(e,'".'))}}(e,a);if((n>0||s>-n)&&(s+=n),e===dA.Hours)0===s&&-12===n&&(s=12);else if(e===dA.FractionalSeconds)return function(e,t){return kA(e,3).substr(0,t)}(s,t);var u=iA(o,eA.MinusSign);return kA(s,t,u,r,i)}}function wA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:QI.Format,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(i,a){return function(e,t,n,r,i,a){switch(n){case vA.Months:return function(e,t,n){var r=qP(e),i=sA([r[YP.MonthsFormat],r[YP.MonthsStandalone]],t);return sA(i,n)}(t,i,r)[e.getMonth()];case vA.Days:return function(e,t,n){var r=qP(e),i=sA([r[YP.DaysFormat],r[YP.DaysStandalone]],t);return sA(i,n)}(t,i,r)[e.getDay()];case vA.DayPeriods:var o=e.getHours(),s=e.getMinutes();if(a){var u=function(e){var t=qP(e);return oA(t),(t[YP.ExtraData][2]||[]).map(function(e){return"string"==typeof e?uA(e):[uA(e[0]),uA(e[1])]})}(t),c=function(e,t,n){var r=qP(e);oA(r);var i=sA([r[YP.ExtraData][0],r[YP.ExtraData][1]],t)||[];return sA(i,n)||[]}(t,i,r),l=u.findIndex(function(e){if(Array.isArray(e)){var t=Sg(e,2),n=t[0],r=t[1],i=o>=n.hours&&s>=n.minutes,a=o<r.hours||o===r.hours&&s<r.minutes;if(n.hours<r.hours){if(i&&a)return!0}else if(i||a)return!0}else if(e.hours===o&&e.minutes===s)return!0;return!1});if(-1!==l)return c[l]}return function(e,t,n){var r=qP(e),i=sA([r[YP.DayPeriodsFormat],r[YP.DayPeriodsStandalone]],t);return sA(i,n)}(t,i,r)[o<12?0:1];case vA.Eras:return function(e,t){return sA(qP(e)[YP.Eras],t)}(t,r)[e.getFullYear()<=0?0:1];default:throw new Error("unexpected translation type ".concat(n))}}(i,a,e,t,n,r)}}function _A(e){return function(t,n,r){var i=-1*r,a=iA(n,eA.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(e){case hA.Short:return(i>=0?"+":"")+kA(o,2,a)+kA(Math.abs(i%60),2,a);case hA.ShortGMT:return"GMT"+(i>=0?"+":"")+kA(o,1,a);case hA.Long:return"GMT"+(i>=0?"+":"")+kA(o,2,a)+":"+kA(Math.abs(i%60),2,a);case hA.Extended:return 0===r?"Z":(i>=0?"+":"")+kA(o,2,a)+":"+kA(Math.abs(i%60),2,a);default:throw new Error('Unknown zone width "'.concat(e,'"'))}}}function EA(e){return gA(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))}function bA(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){var i;if(t){var a=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,o=n.getDate();i=1+Math.floor((o+a)/7)}else{var s=EA(n),u=function(e){var t=gA(e,0,1).getDay();return gA(e,0,1+(t<=4?4:11)-t)}(s.getFullYear()),c=s.getTime()-u.getTime();i=1+Math.round(c/6048e5)}return kA(i,e,iA(r,eA.MinusSign))}}function PA(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){return kA(EA(n).getFullYear(),e,iA(r,eA.MinusSign),t)}}var SA={};function OA(e,t){e=e.replace(/:/g,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function TA(e){return e instanceof Date&&!isNaN(e.valueOf())}var IA=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function AA(e){var t=parseInt(e);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+e);return t}var RA=Wg(function e(){Zg(this,e)}),MA=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).locale=e,r}return Wg(n,[{key:"getPluralCategory",value:function(e,t){switch(aA(t||this.locale)(e)){case KI.Zero:return"zero";case KI.One:return"one";case KI.Two:return"two";case KI.Few:return"few";case KI.Many:return"many";default:return"other"}}}]),n}(RA);return e.\u0275fac=function(t){return new(t||e)(pw(HT))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}();function xA(e,t){t=encodeURIComponent(t);var n,r=Hg(e.split(";"));try{for(r.s();!(n=r.n()).done;){var i=n.value,a=i.indexOf("="),o=Sg(-1==a?[i,""]:[i.slice(0,a),i.slice(a+1)],2),s=o[0],u=o[1];if(s.trim()===t)return decodeURIComponent(u)}}catch(c){r.e(c)}finally{r.f()}return null}var NA=function(){var e=function(){function e(t,n,r,i){Zg(this,e),this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=r,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}return Wg(e,[{key:"klass",set:function(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}},{key:"ngClass",set:function(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(Vb(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}},{key:"ngDoCheck",value:function(){if(this._iterableDiffer){var e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){var t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}},{key:"_applyKeyValueChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachChangedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachRemovedItem(function(e){e.previousValue&&t._toggleClass(e.key,!1)})}},{key:"_applyIterableChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){if("string"!=typeof e.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got ".concat(nm(e.item)));t._toggleClass(e.item,!0)}),e.forEachRemovedItem(function(e){return t._toggleClass(e.item,!1)})}},{key:"_applyClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!0)}):Object.keys(e).forEach(function(n){return t._toggleClass(n,!!e[n])}))}},{key:"_removeClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!1)}):Object.keys(e).forEach(function(e){return t._toggleClass(e,!1)}))}},{key:"_toggleClass",value:function(e,t){var n=this;(e=e.trim())&&e.split(/\s+/g).forEach(function(e){t?n._renderer.addClass(n._ngEl.nativeElement,e):n._renderer.removeClass(n._ngEl.nativeElement,e)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(OO),Qb(IO),Qb(uO),Qb(fO))},e.\u0275dir=Ym({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e}(),DA=function(){function e(t,n,r,i){Zg(this,e),this.$implicit=t,this.ngForOf=n,this.index=r,this.count=i}return Wg(e,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),e}(),LA=function(){var e=function(){function e(t,n,r){Zg(this,e),this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}return Wg(e,[{key:"ngForOf",set:function(e){this._ngForOf=e,this._ngForOfDirty=!0}},{key:"ngForTrackBy",get:function(){return this._trackByFn},set:function(e){this._trackByFn=e}},{key:"ngForTemplate",set:function(e){e&&(this._template=e)}},{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(n){throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'. NgFor only supports binding to Iterables such as Arrays."))}}if(this._differ){var t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}},{key:"_applyChanges",value:function(e){var t=this,n=[];e.forEachOperation(function(e,r,i){if(null==e.previousIndex){var a=t._viewContainer.createEmbeddedView(t._template,new DA(null,t._ngForOf,-1,-1),null===i?void 0:i),o=new FA(e,a);n.push(o)}else if(null==i)t._viewContainer.remove(null===r?void 0:r);else if(null!==r){var s=t._viewContainer.get(r);t._viewContainer.move(s,i);var u=new FA(e,s);n.push(u)}});for(var r=0;r<n.length;r++)this._perViewChange(n[r].view,n[r].record);for(var i=0,a=this._viewContainer.length;i<a;i++){var o=this._viewContainer.get(i);o.context.index=i,o.context.count=a,o.context.ngForOf=this._ngForOf}e.forEachIdentityChange(function(e){t._viewContainer.get(e.currentIndex).context.$implicit=e.item})}},{key:"_perViewChange",value:function(e,t){e.context.$implicit=t.item}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(ZO),Qb(VO),Qb(OO))},e.\u0275dir=Ym({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e}(),FA=Wg(function e(t,n){Zg(this,e),this.record=t,this.view=n}),UA=function(){var e=function(){function e(t,n){Zg(this,e),this._viewContainer=t,this._context=new VA,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}return Wg(e,[{key:"ngIf",set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}},{key:"ngIfThen",set:function(e){BA("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(e){BA("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}},{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(ZO),Qb(VO))},e.\u0275dir=Ym({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e}(),VA=Wg(function e(){Zg(this,e),this.$implicit=null,this.ngIf=null});function BA(e,t){if(t&&!t.createEmbeddedView)throw new Error("".concat(e," must be a TemplateRef, but received '").concat(nm(t),"'."))}var zA=function(){var e=function(){function e(t){Zg(this,e),this._locale=t}return Wg(e,[{key:"transform",value:function(t,n,r){if(!function(e){return!(null==e||""===e||e!=e)}(t))return null;r=r||this._locale;try{return function(e,t,n){return function(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s="",u=!1;if(isFinite(e)){var c=function(e){var t,n,r,i,a,o=Math.abs(e)+"",s=0;for((n=o.indexOf("."))>-1&&(o=o.replace(".","")),(r=o.search(/e/i))>0?(n<0&&(n=r),n+=+o.slice(r+1),o=o.substring(0,r)):n<0&&(n=o.length),r=0;"0"===o.charAt(r);r++);if(r===(a=o.length))t=[0],n=1;else{for(a--;"0"===o.charAt(a);)a--;for(n-=r,t=[],i=0;r<=a;r++,i++)t[i]=Number(o.charAt(r))}return n>22&&(t=t.splice(0,21),s=n-1,n=1),{digits:t,exponent:s,integerLen:n}}(e);o&&(c=function(e){if(0===e.digits[0])return e;var t=e.digits.length-e.integerLen;return e.exponent?e.exponent+=2:(0===t?e.digits.push(0,0):1===t&&e.digits.push(0),e.integerLen+=2),e}(c));var l=t.minInt,f=t.minFrac,h=t.maxFrac;if(a){var d=a.match(IA);if(null===d)throw new Error("".concat(a," is not a valid digit info"));var v=d[1],p=d[3],g=d[5];null!=v&&(l=AA(v)),null!=p&&(f=AA(p)),null!=g?h=AA(g):null!=p&&f>h&&(h=f)}!function(e,t,n){if(t>n)throw new Error("The minimum number of digits after fraction (".concat(t,") is higher than the maximum (").concat(n,")."));var r=e.digits,i=r.length-e.integerLen,a=Math.min(Math.max(t,i),n),o=a+e.integerLen,s=r[o];if(o>0){r.splice(Math.max(e.integerLen,o));for(var u=o;u<r.length;u++)r[u]=0}else{i=Math.max(0,i),e.integerLen=1,r.length=Math.max(1,o=a+1),r[0]=0;for(var c=1;c<o;c++)r[c]=0}if(s>=5)if(o-1<0){for(var l=0;l>o;l--)r.unshift(0),e.integerLen++;r.unshift(1),e.integerLen++}else r[o-1]++;for(;i<Math.max(0,a);i++)r.push(0);var f=0!==a,h=t+e.integerLen,d=r.reduceRight(function(e,t,n,r){return r[n]=(t+=e)<10?t:t-10,f&&(0===r[n]&&n>=h?r.pop():f=!1),t>=10?1:0},0);d&&(r.unshift(d),e.integerLen++)}(c,f,h);var y=c.digits,m=c.integerLen,k=c.exponent,C=[];for(u=y.every(function(e){return!e});m<l;m++)y.unshift(0);for(;m<0;m++)y.unshift(0);m>0?C=y.splice(m,y.length):(C=y,y=[0]);var w=[];for(y.length>=t.lgSize&&w.unshift(y.splice(-t.lgSize,y.length).join(""));y.length>t.gSize;)w.unshift(y.splice(-t.gSize,y.length).join(""));y.length&&w.unshift(y.join("")),s=w.join(iA(n,r)),C.length&&(s+=iA(n,i)+C.join("")),k&&(s+=iA(n,eA.Exponential)+"+"+k)}else s=iA(n,eA.Infinity);return s=e<0&&!u?t.negPre+s+t.negSuf:t.posPre+s+t.posSuf}(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=e.split(";"),i=r[0],a=r[1],o=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],s=o[0],u=o[1]||"";n.posPre=s.substr(0,s.indexOf("#"));for(var c=0;c<u.length;c++){var l=u.charAt(c);"0"===l?n.minFrac=n.maxFrac=c+1:"#"===l?n.maxFrac=c+1:n.posSuf+=l}var f=s.split(",");if(n.gSize=f[1]?f[1].length:0,n.lgSize=f[2]||f[1]?(f[2]||f[1]).length:0,a){var h=i.length-n.posPre.length-n.posSuf.length,d=a.indexOf("#");n.negPre=a.substr(0,d).replace(/'/g,""),n.negSuf=a.substr(d+h).replace(/'/g,"")}else n.negPre=t+n.posPre,n.negSuf=n.posSuf;return n}(function(e,t){return qP(e)[YP.NumberFormats][t]}(t,YI.Decimal),iA(t,eA.MinusSign)),t,eA.Group,eA.Decimal,n)}(function(e){if("string"==typeof e&&!isNaN(Number(e)-parseFloat(e)))return Number(e);if("number"!=typeof e)throw new Error("".concat(e," is not a number"));return e}(t),r,n)}catch(i){throw function(e,t){return Error("InvalidPipeArgument: '".concat(t,"' for pipe '").concat(nm(e),"'"))}(e,i.message)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(HT,16))},e.\u0275pipe=Km({name:"number",type:e,pure:!0}),e}(),HA=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({providers:[{provide:RA,useClass:MA}]}),e}(),GA=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275prov=dm({token:e,providedIn:"root",factory:function(){return new $A(pw(RI),window)}}),e}(),$A=function(){function e(t,n){Zg(this,e),this.document=t,this.window=n,this.offset=function(){return[0,0]}}return Wg(e,[{key:"setOffset",value:function(e){this.offset=Array.isArray(e)?function(){return e}:e}},{key:"getScrollPosition",value:function(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}},{key:"scrollToPosition",value:function(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}},{key:"scrollToAnchor",value:function(e){if(this.supportsScrolling()){var t=function(e,t){var n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow))for(var r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;i;){var a=i.shadowRoot;if(a){var o=a.getElementById(t)||a.querySelector('[name="'.concat(t,'"]'));if(o)return o}i=r.nextNode()}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}}},{key:"setHistoryScrollRestoration",value:function(e){if(this.supportScrollRestoration()){var t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}},{key:"scrollToElement",value:function(e){var t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}},{key:"attemptFocus",value:function(e){return e.focus(),this.document.activeElement===e}},{key:"supportScrollRestoration",value:function(){try{if(!this.supportsScrolling())return!1;var e=ZA(this.window.history)||ZA(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(t){return!1}}},{key:"supportsScrolling",value:function(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}]),e}();function ZA(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}var qA,WA=Wg(function e(){Zg(this,e)}),jA=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"onAndCancel",value:function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"remove",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getBaseHref",value:function(e){var t=(YA=YA||document.querySelector("base"))?YA.getAttribute("href"):null;return null==t?null:function(e){(qA=qA||document.createElement("a")).setAttribute("href",e);var t=qA.pathname;return"/"===t.charAt(0)?t:"/".concat(t)}(t)}},{key:"resetBaseElement",value:function(){YA=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"getCookie",value:function(e){return xA(document.cookie,e)}}],[{key:"makeCurrent",value:function(){var e;e=new n,II||(II=e)}}]),n}(function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).supportsDOMEvents=!0,e}return Wg(n)}(function(){return Wg(function e(){Zg(this,e)})}())),YA=null,KA=new YC("TRANSITION_ID"),QA=[{provide:xT,useFactory:function(e,t,n){return function(){n.get(NT).donePromise.then(function(){for(var n=AI(),r=t.querySelectorAll('style[ng-transition="'.concat(e,'"]')),i=0;i<r.length;i++)n.remove(r[i])})}},deps:[KA,RI,Ib],multi:!0}],XA=function(){function e(){Zg(this,e)}return Wg(e,[{key:"addToWindow",value:function(e){Mm.getAngularTestability=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},Mm.getAllAngularTestabilities=function(){return e.getAllTestabilities()},Mm.getAllAngularRootElements=function(){return e.getAllRootElements()},Mm.frameworkStabilizers||(Mm.frameworkStabilizers=[]),Mm.frameworkStabilizers.push(function(e){var t=Mm.getAllAngularTestabilities(),n=t.length,r=!1,i=function(t){r=r||t,0==--n&&e(r)};t.forEach(function(e){e.whenStable(i)})})}},{key:"findTestabilityInTree",value:function(e,t,n){var r;return null==t?null:null!==(r=e.getTestability(t))&&void 0!==r?r:n?AI().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}],[{key:"init",value:function(){var t;t=new e,lI=t}}]),e}(),JA=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"build",value:function(){return new XMLHttpRequest}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),eR=new YC("EventManagerPlugins"),tR=function(){var e=function(){function e(t,n){var r=this;Zg(this,e),this._zone=n,this._eventNameToPlugin=new Map,t.forEach(function(e){return e.manager=r}),this._plugins=t.slice().reverse()}return Wg(e,[{key:"addEventListener",value:function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}},{key:"addGlobalEventListener",value:function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,r=0;r<n.length;r++){var i=n[r];if(i.supports(e))return this._eventNameToPlugin.set(e,i),i}throw new Error("No event manager plugin found for event ".concat(e))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(eR),pw(eI))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),nR=function(){function e(t){Zg(this,e),this._doc=t}return Wg(e,[{key:"addGlobalEventListener",value:function(e,t,n){var r=AI().getGlobalEventTarget(this._doc,e);if(!r)throw new Error("Unsupported event target ".concat(r," for event ").concat(t));return this.addEventListener(r,t,n)}}]),e}(),rR=function(){var e=function(){function e(){Zg(this,e),this._stylesSet=new Set}return Wg(e,[{key:"addStyles",value:function(e){var t=this,n=new Set;e.forEach(function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))}),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),iR=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this))._doc=e,r._hostNodes=new Map,r._hostNodes.set(e.head,[]),r}return Wg(n,[{key:"_addStylesToHost",value:function(e,t,n){var r=this;e.forEach(function(e){var i=r._doc.createElement("style");i.textContent=e,n.push(t.appendChild(i))})}},{key:"addHost",value:function(e){var t=[];this._addStylesToHost(this._stylesSet,e,t),this._hostNodes.set(e,t)}},{key:"removeHost",value:function(e){var t=this._hostNodes.get(e);t&&t.forEach(aR),this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach(function(n,r){t._addStylesToHost(e,r,n)})}},{key:"ngOnDestroy",value:function(){this._hostNodes.forEach(function(e){return e.forEach(aR)})}}]),n}(rR);return e.\u0275fac=function(t){return new(t||e)(pw(RI))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}();function aR(e){AI().remove(e)}var oR={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},sR=/%COMP%/g;function uR(e,t,n){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?uR(e,i,n):(i=i.replace(sR,e),n.push(i))}return n}function cR(e){return function(t){if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var lR=function(){var e=function(){function e(t,n,r){Zg(this,e),this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new fR(t)}return Wg(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case Tm.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new hR(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case 1:case Tm.ShadowDom:return new dR(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var r=uR(t.id,t.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(tR),pw(iR),pw(DT))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),fR=function(){function e(t){Zg(this,e),this.eventManager=t,this.data=Object.create(null)}return Wg(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(oR[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,n){e&&e.insertBefore(t,n)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(n.textContent=""),n}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,n,r){if(r){t=r+":"+t;var i=oR[r];i?e.setAttributeNS(i,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}},{key:"removeAttribute",value:function(e,t,n){if(n){var r=oR[n];r?e.removeAttributeNS(r,t):e.removeAttribute("".concat(n,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,n,r){r&(w_.DashCase|w_.Important)?e.style.setProperty(t,n,r&w_.Important?"important":""):e.style[t]=n}},{key:"removeStyle",value:function(e,t,n){n&w_.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,n){e[t]=n}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,cR(n)):this.eventManager.addEventListener(e,t,cR(n))}}]),e}(),hR=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a){var o;Zg(this,n),(o=t.call(this,e)).component=i;var s=uR(a+"-"+i.id,i.styles,[]);return r.addStyles(s),o.contentAttr="_ngcontent-%COMP%".replace(sR,a+"-"+i.id),o.hostAttr="_nghost-%COMP%".replace(sR,a+"-"+i.id),o}return Wg(n,[{key:"applyToHost",value:function(e){Rg(Vg(n.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,t){var r=Rg(Vg(n.prototype),"createElement",this).call(this,e,t);return Rg(Vg(n.prototype),"setAttribute",this).call(this,r,this.contentAttr,""),r}}]),n}(fR),dR=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a){var o;Zg(this,n),(o=t.call(this,e)).sharedStylesHost=r,o.hostEl=i,o.shadowRoot=i.attachShadow({mode:"open"}),o.sharedStylesHost.addHost(o.shadowRoot);for(var s=uR(a.id,a.styles,[]),u=0;u<s.length;u++){var c=document.createElement("style");c.textContent=s[u],o.shadowRoot.appendChild(c)}return o}return Wg(n,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,t){return Rg(Vg(n.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"insertBefore",value:function(e,t,r){return Rg(Vg(n.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),t,r)}},{key:"removeChild",value:function(e,t){return Rg(Vg(n.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(Rg(Vg(n.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),n}(fR),vR=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){return Zg(this,n),t.call(this,e)}return Wg(n,[{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,n){var r=this;return e.addEventListener(t,n,!1),function(){return r.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){return e.removeEventListener(t,n)}}]),n}(nR);return e.\u0275fac=function(t){return new(t||e)(pw(RI))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),pR=["alt","control","meta","shift"],gR={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},yR={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},mR={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},kR=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){return Zg(this,n),t.call(this,e)}return Wg(n,[{key:"supports",value:function(e){return null!=n.parseEventName(e)}},{key:"addEventListener",value:function(e,t,r){var i=n.parseEventName(t),a=n.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(function(){return AI().onAndCancel(e,i.domEventName,a)})}}],[{key:"parseEventName",value:function(e){var t=e.toLowerCase().split("."),r=t.shift();if(0===t.length||"keydown"!==r&&"keyup"!==r)return null;var i=n._normalizeKey(t.pop()),a="";if(pR.forEach(function(e){var n=t.indexOf(e);n>-1&&(t.splice(n,1),a+=e+".")}),a+=i,0!=t.length||0===i.length)return null;var o={};return o.domEventName=r,o.fullKey=a,o}},{key:"getEventFullKey",value:function(e){var t="",n=function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&yR.hasOwnProperty(t)&&(t=yR[t]))}return gR[t]||t}(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),pR.forEach(function(r){r!=n&&mR[r](e)&&(t+=r+".")}),t+=n}},{key:"eventCallback",value:function(e,t,r){return function(i){n.getEventFullKey(i)===e&&r.runGuarded(function(){return t(i)})}}},{key:"_normalizeKey",value:function(e){return"esc"===e?"escape":e}}]),n}(nR);return e.\u0275fac=function(t){return new(t||e)(pw(RI))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),CR=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({factory:function(){return pw(wR)},token:e,providedIn:"root"}),e}(),wR=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this))._doc=e,r}return Wg(n,[{key:"sanitize",value:function(e,t){if(null==t)return null;switch(e){case o_.NONE:return t;case o_.HTML:return Nw(t,"HTML")?xw(t):i_(this._doc,String(t)).toString();case o_.STYLE:return Nw(t,"Style")?xw(t):t;case o_.SCRIPT:if(Nw(t,"Script"))return xw(t);throw new Error("unsafe value used in a script context");case o_.URL:return Dw(t),Nw(t,"URL")?xw(t):zw(String(t));case o_.RESOURCE_URL:if(Nw(t,"ResourceURL"))return xw(t);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext ".concat(e," (see https://g.co/ng/security#xss)"))}}},{key:"bypassSecurityTrustHtml",value:function(e){return function(e){return new Tw(e)}(e)}},{key:"bypassSecurityTrustStyle",value:function(e){return function(e){return new Iw(e)}(e)}},{key:"bypassSecurityTrustScript",value:function(e){return function(e){return new Aw(e)}(e)}},{key:"bypassSecurityTrustUrl",value:function(e){return function(e){return new Rw(e)}(e)}},{key:"bypassSecurityTrustResourceUrl",value:function(e){return function(e){return new Mw(e)}(e)}}]),n}(CR);return e.\u0275fac=function(t){return new(t||e)(pw(RI))},e.\u0275prov=dm({factory:function(){return function(e){return new wR(e.get(RI))}(pw(pb))},token:e,providedIn:"root"}),e}(),_R=[{provide:VT,useValue:"browser"},{provide:UT,useValue:function(){jA.makeCurrent(),XA.init()},multi:!0},{provide:RI,useFactory:function(){return e=document,vk=e,document;var e},deps:[]}],ER=pI(SI,"browser",_R),bR=[[],{provide:yb,useValue:"root"},{provide:p_,useFactory:function(){return new p_},deps:[]},{provide:eR,useClass:vR,multi:!0,deps:[RI,eI,VT]},{provide:eR,useClass:kR,multi:!0,deps:[RI]},[],{provide:lR,useClass:lR,deps:[tR,iR,DT]},{provide:lO,useExisting:lR},{provide:rR,useExisting:iR},{provide:iR,useClass:iR,deps:[RI]},{provide:uI,useClass:uI,deps:[eI]},{provide:tR,useClass:tR,deps:[eR,eI]},{provide:WA,useClass:JA,deps:[]},[]],PR=function(){var e=function(){function e(t){if(Zg(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return Wg(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:DT,useValue:t.appId},{provide:KA,useExisting:DT},QA]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(e,12))},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({providers:bR,imports:[HA,TI]}),e}();"undefined"!=typeof window&&window;var SR=Array.isArray,OR=Object.getPrototypeOf,TR=Object.prototype,IR=Object.keys;function AR(e){if(1===e.length){var t=e[0];if(SR(t))return{args:t,keys:null};if(function(e){return e&&"object"==typeof e&&OR(e)===TR}(t)){var n=IR(t);return{args:n.map(function(e){return t[e]}),keys:n}}}return{args:e,keys:null}}var RR=Array.isArray;function MR(e){return Py(function(t){return function(e,t){return RR(t)?e.apply(void 0,Bg(t)):e(t)}(e,t)})}function xR(e,t){return e.reduce(function(e,n,r){return e[n]=t[r],e},{})}var NR=function(){var e=function(){function e(t,n){Zg(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return Wg(e,[{key:"setProperty",value:function(e,t){this._renderer.setProperty(this._elementRef.nativeElement,e,t)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"setDisabledState",value:function(e){this.setProperty("disabled",e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(fO),Qb(uO))},e.\u0275dir=Ym({type:e}),e}(),DR=function(){var e,t=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n)}(NR);return t.\u0275fac=function(n){return(e||(e=$C(t)))(n||t)},t.\u0275dir=Ym({type:t,features:[Rb]}),t}(),LR=new YC("NgValueAccessor"),FR={provide:LR,useExisting:am(function(){return VR}),multi:!0},UR=new YC("CompositionEventMode"),VR=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r))._compositionMode=i,a._composing=!1,null==a._compositionMode&&(a._compositionMode=!function(){var e=AI()?AI().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}()),a}return Wg(n,[{key:"writeValue",value:function(e){this.setProperty("value",null!=e?e:"")}},{key:"_handleInput",value:function(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}]),n}(NR);return e.\u0275fac=function(t){return new(t||e)(Qb(fO),Qb(uO),Qb(UR,8))},e.\u0275dir=Ym({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&uP("input",function(e){return t._handleInput(e.target.value)})("blur",function(){return t.onTouched()})("compositionstart",function(){return t._compositionStart()})("compositionend",function(e){return t._compositionEnd(e.target.value)})},features:[tO([FR]),Rb]}),e}();function BR(e){return null==e||0===e.length}function zR(e){return null!=e&&"number"==typeof e.length}var HR=new YC("NgValidators"),GR=new YC("NgAsyncValidators"),$R=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,ZR=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"min",value:function(e){return t=e,function(e){if(BR(e.value)||BR(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null};var t}},{key:"max",value:function(e){return t=e,function(e){if(BR(e.value)||BR(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null};var t}},{key:"required",value:function(e){return qR(e)}},{key:"requiredTrue",value:function(e){return!0===e.value?null:{required:!0}}},{key:"email",value:function(e){return BR((t=e).value)||$R.test(t.value)?null:{email:!0};var t}},{key:"minLength",value:function(e){return t=e,function(e){return BR(e.value)||!zR(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null};var t}},{key:"maxLength",value:function(e){return WR(e)}},{key:"pattern",value:function(e){return function(e){return e?("string"==typeof e?(n="","^"!==e.charAt(0)&&(n+="^"),n+=e,"$"!==e.charAt(e.length-1)&&(n+="$"),t=new RegExp(n)):(n=e.toString(),t=e),function(e){if(BR(e.value))return null;var r=e.value;return t.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}):jR;var t,n}(e)}},{key:"nullValidator",value:function(e){return null}},{key:"compose",value:function(e){return eM(e)}},{key:"composeAsync",value:function(e){return nM(e)}}]),e}();function qR(e){return BR(e.value)?{required:!0}:null}function WR(e){return function(t){return zR(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null}}function jR(e){return null}function YR(e){return null!=e}function KR(e){var t=oP(e)?Qy(e):e;return sP(t),t}function QR(e){var t={};return e.forEach(function(e){t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function XR(e,t){return t.map(function(t){return t(e)})}function JR(e){return e.map(function(e){return function(e){return!e.validate}(e)?e:function(t){return e.validate(t)}})}function eM(e){if(!e)return null;var t=e.filter(YR);return 0==t.length?null:function(e){return QR(XR(e,t))}}function tM(e){return null!=e?eM(JR(e)):null}function nM(e){if(!e)return null;var t=e.filter(YR);return 0==t.length?null:function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=qy(t),i=AR(t),a=i.args,o=i.keys,s=new yy(function(e){var t=a.length;if(t)for(var n=new Array(t),r=t,i=t,s=function(t){var s=!1;Vy(a[t]).subscribe(new by(e,function(e){s||(s=!0,i--),n[t]=e},function(){return r--},void 0,function(){(!r||!s)&&(i||e.next(o?xR(o,n):n),e.complete())}))},u=0;u<t;u++)s(u);else e.complete()});return r?s.pipe(MR(r)):s}(XR(e,t).map(KR)).pipe(Py(QR))}}function rM(e){return null!=e?nM(JR(e)):null}function iM(e,t){return null===e?[t]:Array.isArray(e)?[].concat(Bg(e),[t]):[e,t]}function aM(e){return e._rawValidators}function oM(e){return e._rawAsyncValidators}function sM(e){return e?Array.isArray(e)?e:[e]:[]}function uM(e,t){return Array.isArray(e)?e.includes(t):e===t}function cM(e,t){var n=sM(t);return sM(e).forEach(function(e){uM(n,e)||n.push(e)}),n}function lM(e,t){return sM(t).filter(function(t){return!uM(e,t)})}var fM=function(){var e=function(){function e(){Zg(this,e),this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}return Wg(e,[{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}},{key:"_setValidators",value:function(e){this._rawValidators=e||[],this._composedValidatorFn=tM(this._rawValidators)}},{key:"_setAsyncValidators",value:function(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=rM(this._rawAsyncValidators)}},{key:"validator",get:function(){return this._composedValidatorFn||null}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn||null}},{key:"_registerOnDestroy",value:function(e){this._onDestroyCallbacks.push(e)}},{key:"_invokeOnDestroyCallbacks",value:function(){this._onDestroyCallbacks.forEach(function(e){return e()}),this._onDestroyCallbacks=[]}},{key:"reset",value:function(e){this.control&&this.control.reset(e)}},{key:"hasError",value:function(e,t){return!!this.control&&this.control.hasError(e,t)}},{key:"getError",value:function(e,t){return this.control?this.control.getError(e,t):null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ym({type:e}),e}(),hM=function(){var e,t=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),n}(fM);return t.\u0275fac=function(n){return(e||(e=$C(t)))(n||t)},t.\u0275dir=Ym({type:t,features:[Rb]}),t}(),dM=function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments))._parent=null,e.name=null,e.valueAccessor=null,e}return Wg(n)}(fM),vM=function(){function e(t){Zg(this,e),this._cd=t}return Wg(e,[{key:"is",value:function(e){var t,n,r;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(r=null===(n=this._cd)||void 0===n?void 0:n.control)||void 0===r?void 0:r[e])}}]),e}(),pM=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){return Zg(this,n),t.call(this,e)}return Wg(n)}(vM);return e.\u0275fac=function(t){return new(t||e)(Qb(dM,2))},e.\u0275dir=Ym({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&PP("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[Rb]}),e}(),gM=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){return Zg(this,n),t.call(this,e)}return Wg(n)}(vM);return e.\u0275fac=function(t){return new(t||e)(Qb(hM,10))},e.\u0275dir=Ym({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,t){2&e&&PP("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))("ng-submitted",t.is("submitted"))},features:[Rb]}),e}();function yM(e,t){return[].concat(Bg(t.path),[e])}function mM(e,t){wM(e,t),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(function(n){e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&EM(e,t)})}(e,t),function(e,t){var n=function(e,n){t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)};e.registerOnChange(n),t._registerOnDestroy(function(){e._unregisterOnChange(n)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(function(){e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&EM(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function(e,t){if(t.valueAccessor.setDisabledState){var n=function(e){t.valueAccessor.setDisabledState(e)};e.registerOnDisabledChange(n),t._registerOnDestroy(function(){e._unregisterOnDisabledChange(n)})}}(e,t)}function kM(e,t){var n=function(){};t.valueAccessor&&(t.valueAccessor.registerOnChange(n),t.valueAccessor.registerOnTouched(n)),_M(e,t),e&&(t._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(function(){}))}function CM(e,t){e.forEach(function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function wM(e,t){var n=aM(e);null!==t.validator?e.setValidators(iM(n,t.validator)):"function"==typeof n&&e.setValidators([n]);var r=oM(e);null!==t.asyncValidator?e.setAsyncValidators(iM(r,t.asyncValidator)):"function"==typeof r&&e.setAsyncValidators([r]);var i=function(){return e.updateValueAndValidity()};CM(t._rawValidators,i),CM(t._rawAsyncValidators,i)}function _M(e,t){var n=!1;if(null!==e){if(null!==t.validator){var r=aM(e);if(Array.isArray(r)&&r.length>0){var i=r.filter(function(e){return e!==t.validator});i.length!==r.length&&(n=!0,e.setValidators(i))}}if(null!==t.asyncValidator){var a=oM(e);if(Array.isArray(a)&&a.length>0){var o=a.filter(function(e){return e!==t.asyncValidator});o.length!==a.length&&(n=!0,e.setAsyncValidators(o))}}}var s=function(){};return CM(t._rawValidators,s),CM(t._rawAsyncValidators,s),n}function EM(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function bM(e,t){wM(e,t)}function PM(e,t){if(!e.hasOwnProperty("model"))return!1;var n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}function SM(e,t){e._syncPendingControls(),t.forEach(function(e){var t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)})}function OM(e,t){return t?(Array.isArray(t),t.forEach(function(e){e.constructor===VR?n=e:function(e){return Object.getPrototypeOf(e.constructor)===DR}(e)?r=e:i=e}),i||r||n||null):null;var n,r,i}function TM(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var IM="VALID",AM="INVALID",RM="PENDING",MM="DISABLED";function xM(e){return(FM(e)?e.validators:e)||null}function NM(e){return Array.isArray(e)?tM(e):e||null}function DM(e,t){return(FM(t)?t.asyncValidators:e)||null}function LM(e){return Array.isArray(e)?rM(e):e||null}function FM(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var UM=function(){function e(t,n){Zg(this,e),this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=function(){},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=n,this._composedValidatorFn=NM(this._rawValidators),this._composedAsyncValidatorFn=LM(this._rawAsyncValidators)}return Wg(e,[{key:"validator",get:function(){return this._composedValidatorFn},set:function(e){this._rawValidators=this._composedValidatorFn=e}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn},set:function(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return this.status===IM}},{key:"invalid",get:function(){return this.status===AM}},{key:"pending",get:function(){return this.status==RM}},{key:"disabled",get:function(){return this.status===MM}},{key:"enabled",get:function(){return this.status!==MM}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"setValidators",value:function(e){this._rawValidators=e,this._composedValidatorFn=NM(e)}},{key:"setAsyncValidators",value:function(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=LM(e)}},{key:"addValidators",value:function(e){this.setValidators(cM(e,this._rawValidators))}},{key:"addAsyncValidators",value:function(e){this.setAsyncValidators(cM(e,this._rawAsyncValidators))}},{key:"removeValidators",value:function(e){this.setValidators(lM(e,this._rawValidators))}},{key:"removeAsyncValidators",value:function(e){this.setAsyncValidators(lM(e,this._rawAsyncValidators))}},{key:"hasValidator",value:function(e){return uM(this._rawValidators,e)}},{key:"hasAsyncValidator",value:function(e){return uM(this._rawAsyncValidators,e)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild(function(e){return e.markAllAsTouched()})}},{key:"markAsUntouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild(function(e){e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"markAsDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}},{key:"markAsPristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild(function(e){e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"markAsPending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status=RM,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}},{key:"disable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=MM,this.errors=null,this._forEachChild(function(t){t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!0)})}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=IM,this._forEachChild(function(t){t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!1)})}},{key:"_updateAncestors",value:function(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(e){this._parent=e}},{key:"updateValueAndValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===IM||this.status===RM)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}},{key:"_updateTreeValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild(function(t){return t._updateTreeValidity(e)}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?MM:IM}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(e){var t=this;if(this.asyncValidator){this.status=RM,this._hasOwnPendingAsyncValidator=!0;var n=KR(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(function(n){t._hasOwnPendingAsyncValidator=!1,t.setErrors(n,{emitEvent:e})})}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}},{key:"setErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}},{key:"get",value:function(e){return function(e,t,n){if(null==t||(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length))return null;var r=e;return t.forEach(function(e){r=r instanceof BM?r.controls.hasOwnProperty(e)?r.controls[e]:null:r instanceof zM&&r.at(e)||null}),r}(this,e)}},{key:"getError",value:function(e,t){var n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}},{key:"hasError",value:function(e,t){return!!this.getError(e,t)}},{key:"root",get:function(){for(var e=this;e._parent;)e=e._parent;return e}},{key:"_updateControlsErrors",value:function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}},{key:"_initObservables",value:function(){this.valueChanges=new gT,this.statusChanges=new gT}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?MM:this.errors?AM:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(RM)?RM:this._anyControlsHaveStatus(AM)?AM:IM}},{key:"_anyControlsHaveStatus",value:function(e){return this._anyControls(function(t){return t.status===e})}},{key:"_anyControlsDirty",value:function(){return this._anyControls(function(e){return e.dirty})}},{key:"_anyControlsTouched",value:function(){return this._anyControls(function(e){return e.touched})}},{key:"_updatePristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"_updateTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"_isBoxedValue",value:function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}},{key:"_registerOnCollectionChange",value:function(e){this._onCollectionChange=e}},{key:"_setUpdateStrategy",value:function(e){FM(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}},{key:"_parentMarkedDirty",value:function(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}]),e}(),VM=function(e){xg(n,e);var t=Dg(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return Zg(this,n),(e=t.call(this,xM(i),DM(a,i)))._onChange=[],e._applyFormState(r),e._setUpdateStrategy(i),e._initObservables(),e.updateValueAndValidity({onlySelf:!0,emitEvent:!!e.asyncValidator}),e}return Wg(n,[{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(function(e){return e(t.value,!1!==n.emitViewToModelChange)}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(e,t)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(e){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(e){this._onChange.push(e)}},{key:"_unregisterOnChange",value:function(e){TM(this._onChange,e)}},{key:"registerOnDisabledChange",value:function(e){this._onDisabledChange.push(e)}},{key:"_unregisterOnDisabledChange",value:function(e){TM(this._onDisabledChange,e)}},{key:"_forEachChild",value:function(e){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}]),n}(UM),BM=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,xM(r),DM(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return Wg(n,[{key:"registerControl",value:function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}},{key:"addControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"removeControl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"contains",value:function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),Object.keys(e).forEach(function(r){t._throwIfControlMissing(r),t.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(Object.keys(e).forEach(function(r){t.controls[r]&&t.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this._reduceChildren({},function(e,t,n){return e[n]=t instanceof VM?t.value:t.getRawValue(),e})}},{key:"_syncPendingControls",value:function(){var e=this._reduceChildren(!1,function(e,t){return!!t._syncPendingControls()||e});return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: ".concat(e,"."))}},{key:"_forEachChild",value:function(e){var t=this;Object.keys(this.controls).forEach(function(n){var r=t.controls[n];r&&e(r,n)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)})}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(e){for(var t=0,n=Object.keys(this.controls);t<n.length;t++){var r=n[t],i=this.controls[r];if(this.contains(r)&&e(i))return!0}return!1}},{key:"_reduceValue",value:function(){var e=this;return this._reduceChildren({},function(t,n,r){return(n.enabled||e.disabled)&&(t[r]=n.value),t})}},{key:"_reduceChildren",value:function(e,t){var n=e;return this._forEachChild(function(e,r){n=t(n,e,r)}),n}},{key:"_allControlsDisabled",value:function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++){var n=t[e];if(this.controls[n].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control with name: '".concat(n,"'."))})}}]),n}(UM),zM=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,xM(r),DM(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return Wg(n,[{key:"at",value:function(e){return this.controls[e]}},{key:"push",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"insert",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}},{key:"removeAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"length",get:function(){return this.controls.length}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),e.forEach(function(e,r){t._throwIfControlMissing(r),t.at(r).setValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(e.forEach(function(e,r){t.at(r)&&t.at(r).patchValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this.controls.map(function(e){return e instanceof VM?e.value:e.getRawValue()})}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.controls.length<1||(this._forEachChild(function(e){return e._registerOnCollectionChange(function(){})}),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}},{key:"_syncPendingControls",value:function(){var e=this.controls.reduce(function(e,t){return!!t._syncPendingControls()||e},!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index ".concat(e))}},{key:"_forEachChild",value:function(e){this.controls.forEach(function(t,n){e(t,n)})}},{key:"_updateValue",value:function(){var e=this;this.value=this.controls.filter(function(t){return t.enabled||e.disabled}).map(function(e){return e.value})}},{key:"_anyControls",value:function(e){return this.controls.some(function(t){return t.enabled&&e(t)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){return e._registerControl(t)})}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control at index: ".concat(n,"."))})}},{key:"_allControlsDisabled",value:function(){var e,t=Hg(this.controls);try{for(t.s();!(e=t.n()).done;){if(e.value.enabled)return!1}}catch(n){t.e(n)}finally{t.f()}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}]),n}(UM),HM={provide:hM,useExisting:am(function(){return $M})},GM=Promise.resolve(null),$M=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).submitted=!1,i._directives=[],i.ngSubmit=new gT,i.form=new BM({},tM(e),rM(r)),i}return Wg(n,[{key:"ngAfterViewInit",value:function(){this._setUpdateStrategy()}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"controls",get:function(){return this.form.controls}},{key:"addControl",value:function(e){var t=this;GM.then(function(){var n=t._findContainer(e.path);e.control=n.registerControl(e.name,e.control),mM(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),t._directives.push(e)})}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){var t=this;GM.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name),TM(t._directives,e)})}},{key:"addFormGroup",value:function(e){var t=this;GM.then(function(){var n=t._findContainer(e.path),r=new BM({});bM(r,e),n.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}},{key:"removeFormGroup",value:function(e){var t=this;GM.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name)})}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){var n=this;GM.then(function(){n.form.get(e.path).setValue(t)})}},{key:"setValue",value:function(e){this.control.setValue(e)}},{key:"onSubmit",value:function(e){return this.submitted=!0,SM(this.form,this._directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}},{key:"_findContainer",value:function(e){return e.pop(),e.length?this.form.get(e):this.form}}]),n}(hM);return e.\u0275fac=function(t){return new(t||e)(Qb(HR,10),Qb(GR,10))},e.\u0275dir=Ym({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&uP("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[tO([HM]),Rb]}),e}(),ZM={provide:dM,useExisting:am(function(){return WM})},qM=Promise.resolve(null),WM=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this)).control=new VM,o._registered=!1,o.update=new gT,o._parent=e,o._setValidators(r),o._setAsyncValidators(i),o.valueAccessor=OM(0,a),o}return Wg(n,[{key:"ngOnChanges",value:function(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),PM(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"path",get:function(){return this._parent?yM(this.name,this._parent):[this.name]}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"_setUpControl",value:function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}},{key:"_isStandalone",value:function(){return!this._parent||!(!this.options||!this.options.standalone)}},{key:"_setUpStandalone",value:function(){mM(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}},{key:"_checkForErrors",value:function(){this._isStandalone()||this._checkParentType(),this._checkName()}},{key:"_checkParentType",value:function(){}},{key:"_checkName",value:function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}},{key:"_updateValue",value:function(e){var t=this;qM.then(function(){t.control.setValue(e,{emitViewToModelChange:!1})})}},{key:"_updateDisabled",value:function(e){var t=this,n=e.isDisabled.currentValue,r=""===n||n&&"false"!==n;qM.then(function(){r&&!t.control.disabled?t.control.disable():!r&&t.control.disabled&&t.control.enable()})}}]),n}(dM);return e.\u0275fac=function(t){return new(t||e)(Qb(hM,9),Qb(HR,10),Qb(GR,10),Qb(LR,10))},e.\u0275dir=Ym({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[tO([ZM]),Rb,uk]}),e}(),jM=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ym({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e}(),YM=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({}),e}(),KM={provide:LR,useExisting:am(function(){return QM}),multi:!0},QM=function(){var e,t=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"writeValue",value:function(e){this.setProperty("value",parseFloat(e))}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}}]),n}(DR);return t.\u0275fac=function(n){return(e||(e=$C(t)))(n||t)},t.\u0275dir=Ym({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&uP("change",function(e){return t.onChange(e.target.value)})("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[tO([KM]),Rb]}),t}(),XM=new YC("NgModelWithFormControlWarning"),JM={provide:hM,useExisting:am(function(){return ex})},ex=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).validators=e,i.asyncValidators=r,i.submitted=!1,i._onCollectionChange=function(){return i._updateDomValue()},i.directives=[],i.form=null,i.ngSubmit=new gT,i._setValidators(e),i._setAsyncValidators(r),i}return Wg(n,[{key:"ngOnChanges",value:function(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}},{key:"ngOnDestroy",value:function(){this.form&&(_M(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(function(){}))}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"addControl",value:function(e){var t=this.form.get(e.path);return mM(t,e),t.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),t}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){kM(e.control||null,e,!1),TM(this.directives,e)}},{key:"addFormGroup",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormGroup",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"addFormArray",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormArray",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormArray",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){this.form.get(e.path).setValue(t)}},{key:"onSubmit",value:function(e){return this.submitted=!0,SM(this.form,this.directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_updateDomValue",value:function(){var e=this;this.directives.forEach(function(t){var n=t.control,r=e.form.get(t.path);n!==r&&(kM(n||null,t),r instanceof VM&&(mM(r,t),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}},{key:"_setUpFormContainer",value:function(e){var t=this.form.get(e.path);bM(t,e),t.updateValueAndValidity({emitEvent:!1})}},{key:"_cleanUpFormContainer",value:function(e){if(this.form){var t=this.form.get(e.path);t&&function(e,t){return _M(e,t)}(t,e)&&t.updateValueAndValidity({emitEvent:!1})}}},{key:"_updateRegistrations",value:function(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(function(){})}},{key:"_updateValidators",value:function(){wM(this.form,this),this._oldForm&&_M(this._oldForm,this)}},{key:"_checkFormPresent",value:function(){}}]),n}(hM);return e.\u0275fac=function(t){return new(t||e)(Qb(HR,10),Qb(GR,10))},e.\u0275dir=Ym({type:e,selectors:[["","formGroup",""]],hostBindings:function(e,t){1&e&&uP("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[tO([JM]),Rb,uk]}),e}(),tx={provide:dM,useExisting:am(function(){return nx})},nx=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o){var s;return Zg(this,n),(s=t.call(this))._ngModelWarningConfig=o,s._added=!1,s.update=new gT,s._ngModelWarningSent=!1,s._parent=e,s._setValidators(r),s._setAsyncValidators(i),s.valueAccessor=OM(0,a),s}return Wg(n,[{key:"isDisabled",set:function(e){}},{key:"ngOnChanges",value:function(e){this._added||this._setUpControl(),PM(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"path",get:function(){return yM(null==this.name?this.name:this.name.toString(),this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"_checkParentType",value:function(){}},{key:"_setUpControl",value:function(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}]),n}(dM);return e.\u0275fac=function(t){return new(t||e)(Qb(hM,13),Qb(HR,10),Qb(GR,10),Qb(LR,10),Qb(XM,8))},e.\u0275dir=Ym({type:e,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[tO([tx]),Rb,uk]}),e._ngModelWarningSentOnce=!1,e}(),rx={provide:LR,useExisting:am(function(){return ax}),multi:!0};function ix(e,t){return null==e?"".concat(t):(t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var ax=function(){var e,t=function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return Wg(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){this.value=e;var t=this._getOptionId(e);null==t&&this.setProperty("selectedIndex",-1);var n=ix(t,e);this.setProperty("value",n)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){t.value=t._getOptionValue(n),e(t.value)}}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r),e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}]),n}(DR);return t.\u0275fac=function(n){return(e||(e=$C(t)))(n||t)},t.\u0275dir=Ym({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&uP("change",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[tO([rx]),Rb]}),t}(),ox=function(){var e=function(){function e(t,n,r){Zg(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}return Wg(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(ix(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(uO),Qb(fO),Qb(ax,9))},e.\u0275dir=Ym({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),sx={provide:LR,useExisting:am(function(){return cx}),multi:!0};function ux(e,t){return null==e?"".concat(t):("string"==typeof t&&(t="'".concat(t,"'")),t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var cx=function(){var e,t=function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return Wg(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){var t,n=this;if(this.value=e,Array.isArray(e)){var r=e.map(function(e){return n._getOptionId(e)});t=function(e,t){e._setSelected(r.indexOf(t.toString())>-1)}}else t=function(e,t){e._setSelected(!1)};this._optionMap.forEach(t)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){var r=[];if(void 0!==n.selectedOptions)for(var i=n.selectedOptions,a=0;a<i.length;a++){var o=i.item(a),s=t._getOptionValue(o.value);r.push(s)}else for(var u=n.options,c=0;c<u.length;c++){var l=u.item(c);if(l.selected){var f=t._getOptionValue(l.value);r.push(f)}}t.value=r,e(r)}}},{key:"_registerOption",value:function(e){var t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r)._value,e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}]),n}(DR);return t.\u0275fac=function(n){return(e||(e=$C(t)))(n||t)},t.\u0275dir=Ym({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&uP("change",function(e){return t.onChange(e.target)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[tO([sx]),Rb]}),t}(),lx=function(){var e=function(){function e(t,n,r){Zg(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}return Wg(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._value=e,this._setElementValue(ux(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._select?(this._value=e,this._setElementValue(ux(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"_setSelected",value:function(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(uO),Qb(fO),Qb(cx,9))},e.\u0275dir=Ym({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),fx={provide:HR,useExisting:am(function(){return hx}),multi:!0},hx=function(){var e=function(){function e(){Zg(this,e),this._required=!1}return Wg(e,[{key:"required",get:function(){return this._required},set:function(e){this._required=null!=e&&!1!==e&&"false"!="".concat(e),this._onChange&&this._onChange()}},{key:"validate",value:function(e){return this.required?qR(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ym({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,t){2&e&&$b("required",t.required?"":null)},inputs:{required:"required"},features:[tO([fx])]}),e}(),dx={provide:HR,useExisting:am(function(){return vx}),multi:!0},vx=function(){var e=function(){function e(){Zg(this,e),this._validator=jR}return Wg(e,[{key:"ngOnChanges",value:function(e){"maxlength"in e&&(this._createValidator(),this._onChange&&this._onChange())}},{key:"validate",value:function(e){return this.enabled()?this._validator(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}},{key:"_createValidator",value:function(){this._validator=this.enabled()?WR(function(e){return"number"==typeof e?e:parseInt(e,10)}(this.maxlength)):jR}},{key:"enabled",value:function(){return null!=this.maxlength}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ym({type:e,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,t){2&e&&$b("maxlength",t.enabled()?t.maxlength:null)},inputs:{maxlength:"maxlength"},features:[tO([dx]),uk]}),e}(),px=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({imports:[[YM]]}),e}(),gx=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({imports:[px]}),e}(),yx=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:[{provide:XM,useValue:t.warnOnNgModelWithFormControl}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({imports:[px]}),e}(),mx=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"group",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this._reduceControls(e),i=null,a=null;return null!=n&&(function(e){return void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn}(n)?(i=null!=n.validators?n.validators:null,a=null!=n.asyncValidators?n.asyncValidators:null,t=null!=n.updateOn?n.updateOn:void 0):(i=null!=n.validator?n.validator:null,a=null!=n.asyncValidator?n.asyncValidator:null)),new BM(r,{asyncValidators:a,updateOn:t,validators:i})}},{key:"control",value:function(e,t,n){return new VM(e,t,n)}},{key:"array",value:function(e,t,n){var r=this,i=e.map(function(e){return r._createControl(e)});return new zM(i,t,n)}},{key:"_reduceControls",value:function(e){var t=this,n={};return Object.keys(e).forEach(function(r){n[r]=t._createControl(e[r])}),n}},{key:"_createControl",value:function(e){return e instanceof VM||e instanceof BM||e instanceof zM?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({factory:function(){return new e},token:e,providedIn:yx}),e}();function kx(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Qy(t,Wy(t))}function Cx(e,t){return Ug(t)?Hy(e,t,1):Hy(e,1)}function wx(e,t){return Ey(function(n,r){var i=0;n.subscribe(new by(r,function(n){return e.call(t,n,i++)&&r.next(n)}))})}var _x=Wg(function e(){Zg(this,e)}),Ex=Wg(function e(){Zg(this,e)}),bx=function(){function e(t){var n=this;Zg(this,e),this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?function(){n.headers=new Map,t.split("\n").forEach(function(e){var t=e.indexOf(":");if(t>0){var r=e.slice(0,t),i=r.toLowerCase(),a=e.slice(t+1).trim();n.maybeSetNormalizedName(r,i),n.headers.has(i)?n.headers.get(i).push(a):n.headers.set(i,[a])}})}:function(){n.headers=new Map,Object.keys(t).forEach(function(e){var r=t[e],i=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(n.headers.set(i,r),n.maybeSetNormalizedName(e,i))})}:this.headers=new Map}return Wg(e,[{key:"has",value:function(e){return this.init(),this.headers.has(e.toLowerCase())}},{key:"get",value:function(e){this.init();var t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(e){return this.init(),this.headers.get(e.toLowerCase())||null}},{key:"append",value:function(e,t){return this.clone({name:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({name:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({name:e,value:t,op:"d"})}},{key:"maybeSetNormalizedName",value:function(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}},{key:"init",value:function(){var t=this;this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(function(e){return t.applyUpdate(e)}),this.lazyUpdate=null))}},{key:"copyFrom",value:function(e){var t=this;e.init(),Array.from(e.headers.keys()).forEach(function(n){t.headers.set(n,e.headers.get(n)),t.normalizedNames.set(n,e.normalizedNames.get(n))})}},{key:"clone",value:function(t){var n=new e;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}},{key:"applyUpdate",value:function(e){var t=e.name.toLowerCase();switch(e.op){case"a":case"s":var n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);var r=("a"===e.op?this.headers.get(t):void 0)||[];r.push.apply(r,Bg(n)),this.headers.set(t,r);break;case"d":var i=e.value;if(i){var a=this.headers.get(t);if(!a)return;0===(a=a.filter(function(e){return-1===i.indexOf(e)})).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}else this.headers.delete(t),this.normalizedNames.delete(t)}}},{key:"forEach",value:function(e){var t=this;this.init(),Array.from(this.normalizedNames.keys()).forEach(function(n){return e(t.normalizedNames.get(n),t.headers.get(n))})}}]),e}(),Px=function(){function e(){Zg(this,e)}return Wg(e,[{key:"encodeKey",value:function(e){return Tx(e)}},{key:"encodeValue",value:function(e){return Tx(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}(),Sx=/%(\d[a-f0-9])/gi,Ox={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function Tx(e){return encodeURIComponent(e).replace(Sx,function(e,t){var n;return null!==(n=Ox[t])&&void 0!==n?n:e})}function Ix(e){return"".concat(e)}var Ax=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Zg(this,e),this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new Px,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){var n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(function(e){var r=e.indexOf("="),i=Sg(-1==r?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,r)),t.decodeValue(e.slice(r+1))],2),a=i[0],o=i[1],s=n.get(a)||[];s.push(o),n.set(a,s)}),n}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(function(e){var r=n.fromObject[e];t.map.set(e,Array.isArray(r)?r:[r])})):this.map=null}return Wg(e,[{key:"has",value:function(e){return this.init(),this.map.has(e)}},{key:"get",value:function(e){this.init();var t=this.map.get(e);return t?t[0]:null}},{key:"getAll",value:function(e){return this.init(),this.map.get(e)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(e,t){return this.clone({param:e,value:t,op:"a"})}},{key:"appendAll",value:function(e){var t=[];return Object.keys(e).forEach(function(n){var r=e[n];Array.isArray(r)?r.forEach(function(e){t.push({param:n,value:e,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}},{key:"set",value:function(e,t){return this.clone({param:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({param:e,value:t,op:"d"})}},{key:"toString",value:function(){var e=this;return this.init(),this.keys().map(function(t){var n=e.encoder.encodeKey(t);return e.map.get(t).map(function(t){return n+"="+e.encoder.encodeValue(t)}).join("&")}).filter(function(e){return""!==e}).join("&")}},{key:"clone",value:function(t){var n=new e({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(t),n}},{key:"init",value:function(){var e=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(function(t){return e.map.set(t,e.cloneFrom.map.get(t))}),this.updates.forEach(function(t){switch(t.op){case"a":case"s":var n=("a"===t.op?e.map.get(t.param):void 0)||[];n.push(Ix(t.value)),e.map.set(t.param,n);break;case"d":if(void 0===t.value){e.map.delete(t.param);break}var r=e.map.get(t.param)||[],i=r.indexOf(Ix(t.value));-1!==i&&r.splice(i,1),r.length>0?e.map.set(t.param,r):e.map.delete(t.param)}}),this.cloneFrom=this.updates=null)}}]),e}(),Rx=function(){function e(){Zg(this,e),this.map=new Map}return Wg(e,[{key:"set",value:function(e,t){return this.map.set(e,t),this}},{key:"get",value:function(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}},{key:"delete",value:function(e){return this.map.delete(e),this}},{key:"keys",value:function(){return this.map.keys()}}]),e}();function Mx(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function xx(e){return"undefined"!=typeof Blob&&e instanceof Blob}function Nx(e){return"undefined"!=typeof FormData&&e instanceof FormData}var Dx=function(){function e(t,n,r,i){var a;if(Zg(this,e),this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,a=i):a=r,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params)),this.headers||(this.headers=new bx),this.context||(this.context=new Rx),this.params){var o=this.params.toString();if(0===o.length)this.urlWithParams=n;else{var s=n.indexOf("?");this.urlWithParams=n+(-1===s?"?":s<n.length-1?"&":"")+o}}else this.params=new Ax,this.urlWithParams=n}return Wg(e,[{key:"serializeBody",value:function(){return null===this.body?null:Mx(this.body)||xx(this.body)||Nx(this.body)||"undefined"!=typeof URLSearchParams&&this.body instanceof URLSearchParams||"string"==typeof this.body?this.body:this.body instanceof Ax?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body||Nx(this.body)?null:xx(this.body)?this.body.type||null:Mx(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Ax?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}},{key:"clone",value:function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.method||this.method,i=n.url||this.url,a=n.responseType||this.responseType,o=void 0!==n.body?n.body:this.body,s=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,u=void 0!==n.reportProgress?n.reportProgress:this.reportProgress,c=n.headers||this.headers,l=n.params||this.params,f=null!==(t=n.context)&&void 0!==t?t:this.context;return void 0!==n.setHeaders&&(c=Object.keys(n.setHeaders).reduce(function(e,t){return e.set(t,n.setHeaders[t])},c)),n.setParams&&(l=Object.keys(n.setParams).reduce(function(e,t){return e.set(t,n.setParams[t])},l)),new e(r,i,o,{params:l,headers:c,context:f,reportProgress:u,responseType:a,withCredentials:s})}}]),e}(),Lx=((Lx=Lx||{})[Lx.Sent=0]="Sent",Lx[Lx.UploadProgress=1]="UploadProgress",Lx[Lx.ResponseHeader=2]="ResponseHeader",Lx[Lx.DownloadProgress=3]="DownloadProgress",Lx[Lx.Response=4]="Response",Lx[Lx.User=5]="User",Lx),Fx=Wg(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";Zg(this,e),this.headers=t.headers||new bx,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}),Ux=function(e){xg(n,e);var t=Dg(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Zg(this,n),(e=t.call(this,r)).type=Lx.ResponseHeader,e}return Wg(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(Fx),Vx=function(e){xg(n,e);var t=Dg(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Zg(this,n),(e=t.call(this,r)).type=Lx.Response,e.body=void 0!==r.body?r.body:null,e}return Wg(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(Fx),Bx=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e,0,"Unknown Error")).name="HttpErrorResponse",r.ok=!1,r.message=r.status>=200&&r.status<300?"Http failure during parsing for ".concat(e.url||"(unknown url)"):"Http failure response for ".concat(e.url||"(unknown url)",": ").concat(e.status," ").concat(e.statusText),r.error=e.error||null,r}return Wg(n)}(Fx);function zx(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}var Hx=function(){var e=function(){function e(t){Zg(this,e),this.handler=t}return Wg(e,[{key:"request",value:function(e,t){var n,r,i,a=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e instanceof Dx?n=e:(r=o.headers instanceof bx?o.headers:new bx(o.headers),o.params&&(i=o.params instanceof Ax?o.params:new Ax({fromObject:o.params})),n=new Dx(e,t,void 0!==o.body?o.body:null,{headers:r,context:o.context,params:i,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials}));var s=kx(n).pipe(Cx(function(e){return a.handler.handle(e)}));if(e instanceof Dx||"events"===o.observe)return s;var u=s.pipe(wx(function(e){return e instanceof Vx}));switch(o.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return u.pipe(Py(function(e){if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return u.pipe(Py(function(e){if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return u.pipe(Py(function(e){if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));default:return u.pipe(Py(function(e){return e.body}))}case"response":return u;default:throw new Error("Unreachable: unhandled observe type ".concat(o.observe,"}"))}}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,t)}},{key:"head",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",e,t)}},{key:"jsonp",value:function(e,t){return this.request("JSONP",e,{params:(new Ax).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",e,t)}},{key:"patch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",e,zx(n,t))}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,zx(n,t))}},{key:"put",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",e,zx(n,t))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(_x))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),Gx=function(){function e(t,n){Zg(this,e),this.next=t,this.interceptor=n}return Wg(e,[{key:"handle",value:function(e){return this.interceptor.intercept(e,this.next)}}]),e}(),$x=new YC("HTTP_INTERCEPTORS"),Zx=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"intercept",value:function(e,t){return t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),qx=/^\)\]\}',?\n/,Wx=function(){var e=function(){function e(t){Zg(this,e),this.xhrFactory=t}return Wg(e,[{key:"handle",value:function(e){var t=this;if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new yy(function(n){var r=t.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach(function(e,t){return r.setRequestHeader(e,t.join(","))}),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){var i=e.detectContentTypeHeader();null!==i&&r.setRequestHeader("Content-Type",i)}if(e.responseType){var a=e.responseType.toLowerCase();r.responseType="json"!==a?a:"text"}var o=e.serializeBody(),s=null,u=function(){if(null!==s)return s;var t=1223===r.status?204:r.status,n=r.statusText||"OK",i=new bx(r.getAllResponseHeaders()),a=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(r)||e.url;return s=new Ux({headers:i,status:t,statusText:n,url:a})},c=function(){var t=u(),i=t.headers,a=t.status,o=t.statusText,s=t.url,c=null;204!==a&&(c=void 0===r.response?r.responseText:r.response),0===a&&(a=c?200:0);var l=a>=200&&a<300;if("json"===e.responseType&&"string"==typeof c){var f=c;c=c.replace(qx,"");try{c=""!==c?JSON.parse(c):null}catch(h){c=f,l&&(l=!1,c={error:h,text:c})}}l?(n.next(new Vx({body:c,headers:i,status:a,statusText:o,url:s||void 0})),n.complete()):n.error(new Bx({error:c,headers:i,status:a,statusText:o,url:s||void 0}))},l=function(e){var t=u().url,i=new Bx({error:e,status:r.status||0,statusText:r.statusText||"Unknown Error",url:t||void 0});n.error(i)},f=!1,h=function(t){f||(n.next(u()),f=!0);var i={type:Lx.DownloadProgress,loaded:t.loaded};t.lengthComputable&&(i.total=t.total),"text"===e.responseType&&!!r.responseText&&(i.partialText=r.responseText),n.next(i)},d=function(e){var t={type:Lx.UploadProgress,loaded:e.loaded};e.lengthComputable&&(t.total=e.total),n.next(t)};return r.addEventListener("load",c),r.addEventListener("error",l),r.addEventListener("timeout",l),r.addEventListener("abort",l),e.reportProgress&&(r.addEventListener("progress",h),null!==o&&r.upload&&r.upload.addEventListener("progress",d)),r.send(o),n.next({type:Lx.Sent}),function(){r.removeEventListener("error",l),r.removeEventListener("abort",l),r.removeEventListener("load",c),r.removeEventListener("timeout",l),e.reportProgress&&(r.removeEventListener("progress",h),null!==o&&r.upload&&r.upload.removeEventListener("progress",d)),r.readyState!==r.DONE&&r.abort()}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(WA))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),jx=new YC("XSRF_COOKIE_NAME"),Yx=new YC("XSRF_HEADER_NAME"),Kx=Wg(function e(){Zg(this,e)}),Qx=function(){var e=function(){function e(t,n,r){Zg(this,e),this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return Wg(e,[{key:"getToken",value:function(){if("server"===this.platform)return null;var e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=xA(e,this.cookieName),this.lastCookieString=e),this.lastToken}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(RI),pw(VT),pw(jx))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),Xx=function(){var e=function(){function e(t,n){Zg(this,e),this.tokenService=t,this.headerName=n}return Wg(e,[{key:"intercept",value:function(e,t){var n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);var r=this.tokenService.getToken();return null!==r&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(Kx),pw(Yx))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),Jx=function(){var e=function(){function e(t,n){Zg(this,e),this.backend=t,this.injector=n,this.chain=null}return Wg(e,[{key:"handle",value:function(e){if(null===this.chain){var t=this.injector.get($x,[]);this.chain=t.reduceRight(function(e,t){return new Gx(e,t)},this.backend)}return this.chain.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(Ex),pw(Ib))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),eN=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"disable",value:function(){return{ngModule:e,providers:[{provide:Xx,useClass:Zx}]}}},{key:"withOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[t.cookieName?{provide:jx,useValue:t.cookieName}:[],t.headerName?{provide:Yx,useValue:t.headerName}:[]]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({providers:[Xx,{provide:$x,useExisting:Xx,multi:!0},{provide:Kx,useClass:Qx},{provide:jx,useValue:"XSRF-TOKEN"},{provide:Yx,useValue:"X-XSRF-TOKEN"}]}),e}(),tN=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({providers:[Hx,{provide:_x,useClass:Jx},Wx,{provide:Ex,useExisting:Wx}],imports:[[eN.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e}(),nN=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this))._value=e,r}return Wg(n,[{key:"value",get:function(){return this.getValue()}},{key:"_subscribe",value:function(e){var t=Rg(Vg(n.prototype),"_subscribe",this).call(this,e);return!t.closed&&e.next(this._value),t}},{key:"getValue",value:function(){var e=this.hasError,t=this.thrownError,n=this._value;if(e)throw t;return this._throwIfClosed(),n}},{key:"next",value:function(e){Rg(Vg(n.prototype),"next",this).call(this,this._value=e)}}]),n}(Cy);function rN(e,t,n){e?zy(n,e,t):t()}var iN=zg(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function aN(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Gy(1)(Qy(t,Wy(t)))}function oN(e){return new yy(function(t){Vy(e()).subscribe(t)})}function sN(){return Ey(function(e,t){var n=null;e._refCount++;var r=new by(t,void 0,void 0,void 0,function(){if(!e||e._refCount<=0||0<--e._refCount)n=null;else{var r=e._connection,i=n;n=null,r&&(!i||r===i)&&r.unsubscribe(),t.unsubscribe()}});e.subscribe(r),r.closed||(n=e.connect())})}var uN=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).source=e,i.subjectFactory=r,i._subject=null,i._refCount=0,i._connection=null,_y(e)&&(i.lift=e.lift),i}return Wg(n,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}},{key:"_teardown",value:function(){this._refCount=0;var e=this._connection;this._subject=this._connection=null,null==e||e.unsubscribe()}},{key:"connect",value:function(){var e=this,t=this._connection;if(!t){t=this._connection=new qg;var n=this.getSubject();t.add(this.source.subscribe(new by(n,void 0,function(){e._teardown(),n.complete()},function(t){e._teardown(),n.error(t)},function(){return e._teardown()}))),t.closed&&(this._connection=null,t=qg.EMPTY)}return t}},{key:"refCount",value:function(){return sN()(this)}}]),n}(yy);function cN(e,t){return Ey(function(n,r){var i=null,a=0,o=!1,s=function(){return o&&!i&&r.complete()};n.subscribe(new by(r,function(n){null==i||i.unsubscribe();var o=0,u=a++;Vy(e(n,u)).subscribe(i=new by(r,function(e){return r.next(t?t(n,e,u,o++):e)},function(){i=null,s()}))},function(){o=!0,s()}))})}function lN(e,t,n,r,i){return function(a,o){var s=n,u=t,c=0;a.subscribe(new by(o,function(t){var n=c++;u=s?e(u,t,n):(s=!0,t),r&&o.next(u)},i&&function(){s&&o.next(u),o.complete()}))}}function fN(e,t){return Ey(lN(e,t,arguments.length>=2,!0))}function hN(e){return Ey(function(t,n){var r,i=null,a=!1;i=t.subscribe(new by(n,void 0,void 0,function(o){r=Vy(e(o,hN(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):a=!0})),a&&(i.unsubscribe(),i=null,r.subscribe(n))})}function dN(e){return e<=0?function(){return $y}:Ey(function(t,n){var r=[];t.subscribe(new by(n,function(t){r.push(t),e<r.length&&r.shift()},function(){var e,t=Hg(r);try{for(t.s();!(e=t.n()).done;){var i=e.value;n.next(i)}}catch(a){t.e(a)}finally{t.f()}n.complete()},void 0,function(){r=null}))})}function vN(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pN;return Ey(function(t,n){var r=!1;t.subscribe(new by(n,function(e){r=!0,n.next(e)},function(){return r?n.complete():n.error(e())}))})}function pN(){return new iN}function gN(e){return Ey(function(t,n){var r=!1;t.subscribe(new by(n,function(e){r=!0,n.next(e)},function(){r||n.next(e),n.complete()}))})}function yN(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?wx(function(t,n){return e(t,n,r)}):gy,Xy(1),n?gN(t):vN(function(){return new iN}))}}function mN(e,t,n){var r=Ug(e)||t||n?{next:e,error:t,complete:n}:e;return r?Ey(function(e,t){var n;null===(n=r.subscribe)||void 0===n||n.call(r);var i=!0;e.subscribe(new by(t,function(e){var n;null===(n=r.next)||void 0===n||n.call(r,e),t.next(e)},function(){var e;i=!1,null===(e=r.complete)||void 0===e||e.call(r),t.complete()},function(e){var n;i=!1,null===(n=r.error)||void 0===n||n.call(r,e),t.error(e)},function(){var e,t;i&&(null===(e=r.unsubscribe)||void 0===e||e.call(r)),null===(t=r.finalize)||void 0===t||t.call(r)}))}):gy}var kN=Wg(function e(t,n){Zg(this,e),this.id=t,this.url=n}),CN=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return Zg(this,n),(i=t.call(this,e,r)).navigationTrigger=a,i.restoredState=o,i}return Wg(n,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(kN),wN=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r)).urlAfterRedirects=i,a}return Wg(n,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),n}(kN),_N=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r)).reason=i,a}return Wg(n,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(kN),EN=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r)).error=i,a}return Wg(n,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),n}(kN),bN=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return Wg(n,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(kN),PN=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return Wg(n,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(kN),SN=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o){var s;return Zg(this,n),(s=t.call(this,e,r)).urlAfterRedirects=i,s.state=a,s.shouldActivate=o,s}return Wg(n,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),n}(kN),ON=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return Wg(n,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(kN),TN=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return Wg(n,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(kN),IN=function(){function e(t){Zg(this,e),this.route=t}return Wg(e,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),e}(),AN=function(){function e(t){Zg(this,e),this.route=t}return Wg(e,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),e}(),RN=function(){function e(t){Zg(this,e),this.snapshot=t}return Wg(e,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),MN=function(){function e(t){Zg(this,e),this.snapshot=t}return Wg(e,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),xN=function(){function e(t){Zg(this,e),this.snapshot=t}return Wg(e,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),NN=function(){function e(t){Zg(this,e),this.snapshot=t}return Wg(e,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),DN=function(){function e(t,n,r){Zg(this,e),this.routerEvent=t,this.position=n,this.anchor=r}return Wg(e,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),e}(),LN="primary",FN=function(){function e(t){Zg(this,e),this.params=t||{}}return Wg(e,[{key:"has",value:function(e){return Object.prototype.hasOwnProperty.call(this.params,e)}},{key:"get",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t[0]:t}return null}},{key:"getAll",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t:[t]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),e}();function UN(e){return new FN(e)}var VN="ngNavigationCancelingError";function BN(e){var t=Error("NavigationCancelingError: "+e);return t[VN]=!0,t}function zN(e,t,n){var r=n.path.split("/");if(r.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;for(var i={},a=0;a<r.length;a++){var o=r[a],s=e[a];if(o.startsWith(":"))i[o.substring(1)]=s;else if(o!==s.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}function HN(e,t){var n,r=e?Object.keys(e):void 0,i=t?Object.keys(t):void 0;if(!r||!i||r.length!=i.length)return!1;for(var a=0;a<r.length;a++)if(!GN(e[n=r[a]],t[n]))return!1;return!0}function GN(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;var n=Bg(e).sort(),r=Bg(t).sort();return n.every(function(e,t){return r[t]===e})}return e===t}function $N(e){return Array.prototype.concat.apply([],e)}function ZN(e){return e.length>0?e[e.length-1]:null}function qN(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}function WN(e){return sP(e)?e:oP(e)?Qy(Promise.resolve(e)):kx(e)}var jN={exact:function e(t,n,r){if(!rD(t.segments,n.segments)||!JN(t.segments,n.segments,r)||t.numberOfChildren!==n.numberOfChildren)return!1;for(var i in n.children)if(!t.children[i]||!e(t.children[i],n.children[i],r))return!1;return!0},subset:QN},YN={exact:function(e,t){return HN(e,t)},subset:function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(function(n){return GN(e[n],t[n])})},ignored:function(){return!0}};function KN(e,t,n){return jN[n.paths](e.root,t.root,n.matrixParams)&&YN[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function QN(e,t,n){return XN(e,t,t.segments,n)}function XN(e,t,n,r){if(e.segments.length>n.length){var i=e.segments.slice(0,n.length);return!(!rD(i,n)||t.hasChildren()||!JN(i,n,r))}if(e.segments.length===n.length){if(!rD(e.segments,n)||!JN(e.segments,n,r))return!1;for(var a in t.children)if(!e.children[a]||!QN(e.children[a],t.children[a],r))return!1;return!0}var o=n.slice(0,e.segments.length),s=n.slice(e.segments.length);return!!(rD(e.segments,o)&&JN(e.segments,o,r)&&e.children[LN])&&XN(e.children[LN],t,s,r)}function JN(e,t,n){return t.every(function(t,r){return YN[n](e[r].parameters,t.parameters)})}var eD=function(){function e(t,n,r){Zg(this,e),this.root=t,this.queryParams=n,this.fragment=r}return Wg(e,[{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=UN(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return oD.serialize(this)}}]),e}(),tD=function(){function e(t,n){var r=this;Zg(this,e),this.segments=t,this.children=n,this.parent=null,qN(n,function(e,t){return e.parent=r})}return Wg(e,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}},{key:"toString",value:function(){return sD(this)}}]),e}(),nD=function(){function e(t,n){Zg(this,e),this.path=t,this.parameters=n}return Wg(e,[{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=UN(this.parameters)),this._parameterMap}},{key:"toString",value:function(){return vD(this)}}]),e}();function rD(e,t){return e.length===t.length&&e.every(function(e,n){return e.path===t[n].path})}var iD=Wg(function e(){Zg(this,e)}),aD=function(){function e(){Zg(this,e)}return Wg(e,[{key:"parse",value:function(e){var t=new kD(e);return new eD(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}},{key:"serialize",value:function(e){var t,n="/".concat(uD(e.root,!0)),r=function(e){var t=Object.keys(e).map(function(t){var n=e[t];return Array.isArray(n)?n.map(function(e){return"".concat(lD(t),"=").concat(lD(e))}).join("&"):"".concat(lD(t),"=").concat(lD(n))}).filter(function(e){return!!e});return t.length?"?".concat(t.join("&")):""}(e.queryParams);return"".concat(n).concat(r).concat("string"==typeof e.fragment?"#".concat((t=e.fragment,encodeURI(t))):"")}}]),e}(),oD=new aD;function sD(e){return e.segments.map(function(e){return vD(e)}).join("/")}function uD(e,t){if(!e.hasChildren())return sD(e);if(t){var n=e.children[LN]?uD(e.children[LN],!1):"",r=[];return qN(e.children,function(e,t){t!==LN&&r.push("".concat(t,":").concat(uD(e,!1)))}),r.length>0?"".concat(n,"(").concat(r.join("//"),")"):n}var i=function(e,t){var n=[];return qN(e.children,function(e,r){r===LN&&(n=n.concat(t(e,r)))}),qN(e.children,function(e,r){r!==LN&&(n=n.concat(t(e,r)))}),n}(e,function(t,n){return n===LN?[uD(e.children[LN],!1)]:["".concat(n,":").concat(uD(t,!1))]});return 1===Object.keys(e.children).length&&null!=e.children[LN]?"".concat(sD(e),"/").concat(i[0]):"".concat(sD(e),"/(").concat(i.join("//"),")")}function cD(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function lD(e){return cD(e).replace(/%3B/gi,";")}function fD(e){return cD(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function hD(e){return decodeURIComponent(e)}function dD(e){return hD(e.replace(/\+/g,"%20"))}function vD(e){return"".concat(fD(e.path)).concat(function(e){return Object.keys(e).map(function(t){return";".concat(fD(t),"=").concat(fD(e[t]))}).join("")}(e.parameters))}var pD=/^[^\/()?;=#]+/;function gD(e){var t=e.match(pD);return t?t[0]:""}var yD=/^[^=?&#]+/,mD=/^[^?&#]+/,kD=function(){function e(t){Zg(this,e),this.url=t,this.remaining=t}return Wg(e,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new tD([],{}):new tD([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());var t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));var n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[LN]=new tD(e,t)),n}},{key:"parseSegment",value:function(){var e=gD(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(e),new nD(hD(e),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var e={};this.consumeOptional(";");)this.parseParam(e);return e}},{key:"parseParam",value:function(e){var t=gD(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=gD(this.remaining);r&&(n=r,this.capture(n))}e[hD(t)]=hD(n)}}},{key:"parseQueryParam",value:function(e){var t=function(e){var t=e.match(yD);return t?t[0]:""}(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=function(e){var t=e.match(mD);return t?t[0]:""}(this.remaining);r&&(n=r,this.capture(n))}var i=dD(t),a=dD(n);if(e.hasOwnProperty(i)){var o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(a)}else e[i]=a}}},{key:"parseParens",value:function(e){var t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var n=gD(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error("Cannot parse url '".concat(this.url,"'"));var i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):e&&(i=LN);var a=this.parseChildren();t[i]=1===Object.keys(a).length?a[LN]:new tD([],a),this.consumeOptional("//")}return t}},{key:"peekStartsWith",value:function(e){return this.remaining.startsWith(e)}},{key:"consumeOptional",value:function(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}},{key:"capture",value:function(e){if(!this.consumeOptional(e))throw new Error('Expected "'.concat(e,'".'))}}]),e}(),CD=function(){function e(t){Zg(this,e),this._root=t}return Wg(e,[{key:"root",get:function(){return this._root.value}},{key:"parent",value:function(e){var t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}},{key:"children",value:function(e){var t=wD(e,this._root);return t?t.children.map(function(e){return e.value}):[]}},{key:"firstChild",value:function(e){var t=wD(e,this._root);return t&&t.children.length>0?t.children[0].value:null}},{key:"siblings",value:function(e){var t=_D(e,this._root);return t.length<2?[]:t[t.length-2].children.map(function(e){return e.value}).filter(function(t){return t!==e})}},{key:"pathFromRoot",value:function(e){return _D(e,this._root).map(function(e){return e.value})}}]),e}();function wD(e,t){if(e===t.value)return t;var n,r=Hg(t.children);try{for(r.s();!(n=r.n()).done;){var i=wD(e,n.value);if(i)return i}}catch(a){r.e(a)}finally{r.f()}return null}function _D(e,t){if(e===t.value)return[t];var n,r=Hg(t.children);try{for(r.s();!(n=r.n()).done;){var i=_D(e,n.value);if(i.length)return i.unshift(t),i}}catch(a){r.e(a)}finally{r.f()}return[]}var ED=function(){function e(t,n){Zg(this,e),this.value=t,this.children=n}return Wg(e,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),e}();function bD(e){var t={};return e&&e.children.forEach(function(e){return t[e.value.outlet]=e}),t}var PD=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e)).snapshot=r,RD(Fg(i),e),i}return Wg(n,[{key:"toString",value:function(){return this.snapshot.toString()}}]),n}(CD);function SD(e,t){var n=function(e,t){var n=new ID([],{},{},"",{},LN,t,null,e.root,-1,{});return new AD("",new ED(n,[]))}(e,t),r=new nN([new nD("",{})]),i=new nN({}),a=new nN({}),o=new nN({}),s=new nN(""),u=new OD(r,i,o,s,a,LN,t,n.root);return u.snapshot=n.root,new PD(new ED(u,[]),n)}var OD=function(){function e(t,n,r,i,a,o,s,u){Zg(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this._futureSnapshot=u}return Wg(e,[{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(Py(function(e){return UN(e)}))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Py(function(e){return UN(e)}))),this._queryParamMap}},{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}}]),e}();function TD(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",n=e.pathFromRoot,r=0;if("always"!==t)for(r=n.length-1;r>=1;){var i=n[r],a=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function(e){return e.reduce(function(e,t){return{params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}},{params:{},data:{},resolve:{}})}(n.slice(r))}var ID=function(){function e(t,n,r,i,a,o,s,u,c,l,f){Zg(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this.routeConfig=u,this._urlSegment=c,this._lastPathIndex=l,this._resolve=f}return Wg(e,[{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=UN(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=UN(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return"Route(url:'".concat(this.url.map(function(e){return e.toString()}).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}}]),e}(),AD=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,r)).url=e,RD(Fg(i),r),i}return Wg(n,[{key:"toString",value:function(){return MD(this._root)}}]),n}(CD);function RD(e,t){t.value._routerState=e,t.children.forEach(function(t){return RD(e,t)})}function MD(e){var t=e.children.length>0?" { ".concat(e.children.map(MD).join(", ")," } "):"";return"".concat(e.value).concat(t)}function xD(e){if(e.snapshot){var t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,HN(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),HN(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!HN(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),HN(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function ND(e,t){var n=HN(e.params,t.params)&&function(e,t){return rD(e,t)&&e.every(function(e,n){return HN(e.parameters,t[n].parameters)})}(e.url,t.url);return n&&!(!e.parent!=!t.parent)&&(!e.parent||ND(e.parent,t.parent))}function DD(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){var r=n.value;r._futureSnapshot=t.value;var i=function(e,t,n){return t.children.map(function(t){var r,i=Hg(n.children);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(e.shouldReuseRoute(t.value,a.value.snapshot))return DD(e,t,a)}}catch(o){i.e(o)}finally{i.f()}return DD(e,t)})}(e,t,n);return new ED(r,i)}if(e.shouldAttach(t.value)){var a=e.retrieve(t.value);if(null!==a){var o=a.route;return LD(t,o),o}}var s=function(e){return new OD(new nN(e.url),new nN(e.params),new nN(e.queryParams),new nN(e.fragment),new nN(e.data),e.outlet,e.component,e)}(t.value),u=t.children.map(function(t){return DD(e,t)});return new ED(s,u)}function LD(e,t){if(e.value.routeConfig!==t.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==t.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");t.value._futureSnapshot=e.value;for(var n=0;n<e.children.length;++n)LD(e.children[n],t.children[n])}function FD(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function UD(e){return"object"==typeof e&&null!=e&&e.outlets}function VD(e,t,n,r,i){var a={};return r&&qN(r,function(e,t){a[t]=Array.isArray(e)?e.map(function(e){return"".concat(e)}):"".concat(e)}),new eD(n.root===e?t:BD(n.root,e,t),a,i)}function BD(e,t,n){var r={};return qN(e.children,function(e,i){r[i]=e===t?n:BD(e,t,n)}),new tD(e.segments,r)}var zD=function(){function e(t,n,r){if(Zg(this,e),this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&FD(r[0]))throw new Error("Root segment cannot have matrix parameters");var i=r.find(UD);if(i&&i!==ZN(r))throw new Error("{outlets:{}} has to be the last command")}return Wg(e,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),e}(),HD=Wg(function e(t,n,r){Zg(this,e),this.segmentGroup=t,this.processChildren=n,this.index=r});function GD(e,t,n){if(e||(e=new tD([],{})),0===e.segments.length&&e.hasChildren())return $D(e,t,n);var r=function(e,t,n){for(var r=0,i=t,a={match:!1,pathIndex:0,commandIndex:0};i<e.segments.length;){if(r>=n.length)return a;var o=e.segments[i],s=n[r];if(UD(s))break;var u="".concat(s),c=r<n.length-1?n[r+1]:null;if(i>0&&void 0===u)break;if(u&&c&&"object"==typeof c&&void 0===c.outlets){if(!jD(u,c,o))return a;r+=2}else{if(!jD(u,{},o))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(e,t,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){var a=new tD(e.segments.slice(0,r.pathIndex),{});return a.children[LN]=new tD(e.segments.slice(r.pathIndex),e.children),$D(a,0,i)}return r.match&&0===i.length?new tD(e.segments,{}):r.match&&!e.hasChildren()?ZD(e,t,n):r.match?$D(e,0,i):ZD(e,t,n)}function $D(e,t,n){if(0===n.length)return new tD(e.segments,{});var r=function(e){return UD(e[0])?e[0].outlets:Pg({},LN,e)}(n),i={};return qN(r,function(n,r){"string"==typeof n&&(n=[n]),null!==n&&(i[r]=GD(e.children[r],t,n))}),qN(e.children,function(e,t){void 0===r[t]&&(i[t]=e)}),new tD(e.segments,i)}function ZD(e,t,n){for(var r=e.segments.slice(0,t),i=0;i<n.length;){var a=n[i];if(UD(a)){var o=qD(a.outlets);return new tD(r,o)}if(0===i&&FD(n[0]))r.push(new nD(e.segments[t].path,WD(n[0]))),i++;else{var s=UD(a)?a.outlets[LN]:"".concat(a),u=i<n.length-1?n[i+1]:null;s&&u&&FD(u)?(r.push(new nD(s,WD(u))),i+=2):(r.push(new nD(s,{})),i++)}}return new tD(r,{})}function qD(e){var t={};return qN(e,function(e,n){"string"==typeof e&&(e=[e]),null!==e&&(t[n]=ZD(new tD([],{}),0,e))}),t}function WD(e){var t={};return qN(e,function(e,n){return t[n]="".concat(e)}),t}function jD(e,t,n){return e==n.path&&HN(t,n.parameters)}var YD=function(){function e(t,n,r,i){Zg(this,e),this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=i}return Wg(e,[{key:"activate",value:function(e){var t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),xD(this.futureState.root),this.activateChildRoutes(t,n,e)}},{key:"deactivateChildRoutes",value:function(e,t,n){var r=this,i=bD(t);e.children.forEach(function(e){var t=e.value.outlet;r.deactivateRoutes(e,i[t],n),delete i[t]}),qN(i,function(e,t){r.deactivateRouteAndItsChildren(e,n)})}},{key:"deactivateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(r===i)if(r.component){var a=n.getContext(r.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,n);else i&&this.deactivateRouteAndItsChildren(t,n)}},{key:"deactivateRouteAndItsChildren",value:function(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}},{key:"detachAndStoreRouteSubtree",value:function(e,t){var n=t.getContext(e.value.outlet);if(n&&n.outlet){var r=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:r,route:e,contexts:i})}}},{key:"deactivateRouteAndOutlet",value:function(e,t){for(var n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,i=bD(e),a=0,o=Object.keys(i);a<o.length;a++){var s=o[a];this.deactivateRouteAndItsChildren(i[s],r)}n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}},{key:"activateChildRoutes",value:function(e,t,n){var r=this,i=bD(t);e.children.forEach(function(e){r.activateRoutes(e,i[e.value.outlet],n),r.forwardEvent(new NN(e.value.snapshot))}),e.children.length&&this.forwardEvent(new MN(e.value.snapshot))}},{key:"activateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(xD(r),r===i)if(r.component){var a=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,n);else if(r.component){var o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){var s=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(s.contexts),o.attachRef=s.componentRef,o.route=s.route.value,o.outlet&&o.outlet.attach(s.componentRef,s.route.value),KD(s.route)}else{var u=function(e){for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),c=u?u.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=c,o.outlet&&o.outlet.activateWith(r,c),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}]),e}();function KD(e){xD(e.value),e.children.forEach(KD)}var QD=Wg(function e(t,n){Zg(this,e),this.routes=t,this.module=n});function XD(e){return"function"==typeof e}function JD(e){return e instanceof eD}var eL=Symbol("INITIAL_VALUE");function tL(){return cN(function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Wy(t),i=qy(t),a=AR(t),o=a.args,s=a.keys;if(0===o.length)return Qy([],r);var u=new yy(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gy;return function(r){rN(t,function(){for(var i=e.length,a=new Array(i),o=i,s=i,u=function(i){rN(t,function(){var u=Qy(e[i],t),c=!1;u.subscribe(new by(r,function(e){a[i]=e,c||(c=!0,s--),s||r.next(n(a.slice()))},function(){--o||r.complete()}))},r)},c=0;c<i;c++)u(c)},r)}}(o,r,s?function(e){return xR(s,e)}:gy));return i?u.pipe(MR(i)):u}(e.map(function(e){return e.pipe(Xy(1),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Wy(t);return Ey(function(e,n){(r?aN(t,e,r):aN(t,e)).subscribe(n)})}(eL))})).pipe(fN(function(e,t){var n=!1;return t.reduce(function(e,r,i){return e!==eL?e:(r===eL&&(n=!0),n||!1!==r&&i!==t.length-1&&!JD(r)?e:r)},e)},eL),wx(function(e){return e!==eL}),Py(function(e){return JD(e)?e:!0===e}),Xy(1))})}var nL=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Gm({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&nP(0,"router-outlet")},directives:function(){return[JL]},encapsulation:2}),e}();function rL(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<e.length;n++){var r=e[n];iL(r,aL(t,r))}}function iL(e,t){e.children&&rL(e.children,t)}function aL(e,t){return t?e||t.path?e&&!t.path?"".concat(e,"/"):!e&&t.path?t.path:"".concat(e,"/").concat(t.path):"":e}function oL(e){var t=e.children&&e.children.map(oL),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==LN&&(n.component=nL),n}function sL(e){return e.outlet||LN}function uL(e,t){var n=e.filter(function(e){return sL(e)===t});return n.push.apply(n,Bg(e.filter(function(e){return sL(e)!==t}))),n}var cL={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function lL(e,t,n){var r;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?Object.assign({},cL):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};var i=(t.matcher||zN)(n,e,t);if(!i)return Object.assign({},cL);var a={};qN(i.posParams,function(e,t){a[t]=e.path});var o=i.consumed.length>0?Object.assign(Object.assign({},a),i.consumed[i.consumed.length-1].parameters):a;return{matched:!0,consumedSegments:i.consumed,lastChild:i.consumed.length,parameters:o,positionalParamSegments:null!==(r=i.posParams)&&void 0!==r?r:{}}}function fL(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"corrected";if(n.length>0&&function(e,t,n){return n.some(function(n){return hL(e,t,n)&&sL(n)!==LN})}(e,n,r)){var a=new tD(t,function(e,t,n,r){var i={};i[LN]=r,r._sourceSegment=e,r._segmentIndexShift=t.length;var a,o=Hg(n);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(""===s.path&&sL(s)!==LN){var u=new tD([],{});u._sourceSegment=e,u._segmentIndexShift=t.length,i[sL(s)]=u}}}catch(c){o.e(c)}finally{o.f()}return i}(e,t,r,new tD(n,e.children)));return a._sourceSegment=e,a._segmentIndexShift=t.length,{segmentGroup:a,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return n.some(function(n){return hL(e,t,n)})}(e,n,r)){var o=new tD(e.segments,function(e,t,n,r,i,a){var o,s={},u=Hg(r);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(hL(e,n,c)&&!i[sL(c)]){var l=new tD([],{});l._sourceSegment=e,l._segmentIndexShift="legacy"===a?e.segments.length:t.length,s[sL(c)]=l}}}catch(f){u.e(f)}finally{u.f()}return Object.assign(Object.assign({},i),s)}(e,t,n,r,e.children,i));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:n}}var s=new tD(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function hL(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function dL(e,t,n,r){return!!(sL(e)===r||r!==LN&&hL(t,n,e))&&("**"===e.path||lL(t,e,n).matched)}function vL(e,t,n){return 0===t.length&&!e.children[n]}var pL=Wg(function e(t){Zg(this,e),this.segmentGroup=t||null}),gL=Wg(function e(t){Zg(this,e),this.urlTree=t});function yL(e){return new yy(function(t){return t.error(new pL(e))})}function mL(e){return new yy(function(t){return t.error(new gL(e))})}function kL(e){return new yy(function(t){return t.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(e,"'")))})}var CL=function(){function e(t,n,r,i,a){Zg(this,e),this.configLoader=n,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0,this.ngModule=t.get(HO)}return Wg(e,[{key:"apply",value:function(){var e=this,t=fL(this.urlTree.root,[],[],this.config).segmentGroup,n=new tD(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,n,LN).pipe(Py(function(t){return e.createUrlTree(wL(t),e.urlTree.queryParams,e.urlTree.fragment)})).pipe(hN(function(t){if(t instanceof gL)return e.allowRedirects=!1,e.match(t.urlTree);throw t instanceof pL?e.noMatchError(t):t}))}},{key:"match",value:function(e){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,e.root,LN).pipe(Py(function(n){return t.createUrlTree(wL(n),e.queryParams,e.fragment)})).pipe(hN(function(e){throw e instanceof pL?t.noMatchError(e):e}))}},{key:"noMatchError",value:function(e){return new Error("Cannot match any routes. URL Segment: '".concat(e.segmentGroup,"'"))}},{key:"createUrlTree",value:function(e,t,n){var r=e.segments.length>0?new tD([],Pg({},LN,e)):e;return new eD(r,t,n)}},{key:"expandSegmentGroup",value:function(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(Py(function(e){return new tD([],e)})):this.expandSegment(e,n,t,n.segments,r,!0)}},{key:"expandChildren",value:function(e,t,n){for(var r=this,i=[],a=0,o=Object.keys(n.children);a<o.length;a++){var s=o[a];"primary"===s?i.unshift(s):i.push(s)}return Qy(i).pipe(Cx(function(i){var a=n.children[i],o=uL(t,i);return r.expandSegmentGroup(e,o,a,i).pipe(Py(function(e){return{segment:e,outlet:i}}))}),fN(function(e,t){return e[t.outlet]=t.segment,e},{}),function(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?wx(function(t,n){return e(t,n,r)}):gy,dN(1),n?gN(t):vN(function(){return new iN}))}}())}},{key:"expandSegment",value:function(e,t,n,r,i,a){var o=this;return Qy(n).pipe(Cx(function(s){return o.expandSegmentAgainstRoute(e,t,n,s,r,i,a).pipe(hN(function(e){if(e instanceof pL)return kx(null);throw e}))}),yN(function(e){return!!e}),hN(function(e,n){if(e instanceof iN||"EmptyError"===e.name){if(vL(t,r,i))return kx(new tD([],{}));throw new pL(t)}throw e}))}},{key:"expandSegmentAgainstRoute",value:function(e,t,n,r,i,a,o){return dL(r,t,i,a)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,i,a):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a):yL(t):yL(t)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,a):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(e,t,n,r){var i=this,a=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?mL(a):this.lineralizeSegments(n,a).pipe(Hy(function(n){var a=new tD(n,{});return i.expandSegment(e,a,t,n,r,!1)}))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){var o=this,s=lL(t,r,i),u=s.matched,c=s.consumedSegments,l=s.lastChild,f=s.positionalParamSegments;if(!u)return yL(t);var h=this.applyRedirectCommands(c,r.redirectTo,f);return r.redirectTo.startsWith("/")?mL(h):this.lineralizeSegments(r,h).pipe(Hy(function(r){return o.expandSegment(e,t,n,r.concat(i.slice(l)),a,!1)}))}},{key:"matchSegmentAgainstRoute",value:function(e,t,n,r,i){var a=this;if("**"===n.path)return n.loadChildren?(n._loadedConfig?kx(n._loadedConfig):this.configLoader.load(e.injector,n)).pipe(Py(function(e){return n._loadedConfig=e,new tD(r,{})})):kx(new tD(r,{}));var o=lL(t,n,r),s=o.matched,u=o.consumedSegments,c=o.lastChild;if(!s)return yL(t);var l=r.slice(c);return this.getChildConfig(e,n,r).pipe(Hy(function(e){var r=e.module,o=e.routes,s=fL(t,u,l,o),c=s.segmentGroup,f=s.slicedSegments,h=new tD(c.segments,c.children);if(0===f.length&&h.hasChildren())return a.expandChildren(r,o,h).pipe(Py(function(e){return new tD(u,e)}));if(0===o.length&&0===f.length)return kx(new tD(u,{}));var d=sL(n)===i;return a.expandSegment(r,h,o,f,d?LN:i,!0).pipe(Py(function(e){return new tD(u.concat(e.segments),e.children)}))}))}},{key:"getChildConfig",value:function(e,t,n){var r=this;return t.children?kx(new QD(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?kx(t._loadedConfig):this.runCanLoadGuards(e.injector,t,n).pipe(Hy(function(n){return n?r.configLoader.load(e.injector,t).pipe(Py(function(e){return t._loadedConfig=e,e})):(i=t,new yy(function(e){return e.error(BN("Cannot load children because the guard of the route \"path: '".concat(i.path,"'\" returned false")))}));var i})):kx(new QD([],e))}},{key:"runCanLoadGuards",value:function(e,t,n){var r=this,i=t.canLoad;return i&&0!==i.length?kx(i.map(function(r){var i,a,o=e.get(r);if((a=o)&&XD(a.canLoad))i=o.canLoad(t,n);else{if(!XD(o))throw new Error("Invalid CanLoad guard");i=o(t,n)}return WN(i)})).pipe(tL(),mN(function(e){if(JD(e)){var t=BN('Redirecting to "'.concat(r.urlSerializer.serialize(e),'"'));throw t.url=e,t}}),Py(function(e){return!0===e})):kx(!0)}},{key:"lineralizeSegments",value:function(e,t){for(var n=[],r=t.root;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return kx(n);if(r.numberOfChildren>1||!r.children[LN])return kL(e.redirectTo);r=r.children[LN]}}},{key:"applyRedirectCommands",value:function(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}},{key:"applyRedirectCreatreUrlTree",value:function(e,t,n,r){var i=this.createSegmentGroup(e,t.root,n,r);return new eD(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}},{key:"createQueryParams",value:function(e,t){var n={};return qN(e,function(e,r){if("string"==typeof e&&e.startsWith(":")){var i=e.substring(1);n[r]=t[i]}else n[r]=e}),n}},{key:"createSegmentGroup",value:function(e,t,n,r){var i=this,a=this.createSegments(e,t.segments,n,r),o={};return qN(t.children,function(t,a){o[a]=i.createSegmentGroup(e,t,n,r)}),new tD(a,o)}},{key:"createSegments",value:function(e,t,n,r){var i=this;return t.map(function(t){return t.path.startsWith(":")?i.findPosParam(e,t,r):i.findOrReturn(t,n)})}},{key:"findPosParam",value:function(e,t,n){var r=n[t.path.substring(1)];if(!r)throw new Error("Cannot redirect to '".concat(e,"'. Cannot find '").concat(t.path,"'."));return r}},{key:"findOrReturn",value:function(e,t){var n,r=0,i=Hg(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.path===e.path)return t.splice(r),a;r++}}catch(o){i.e(o)}finally{i.f()}return e}}]),e}();function wL(e){for(var t={},n=0,r=Object.keys(e.children);n<r.length;n++){var i=r[n],a=wL(e.children[i]);(a.segments.length>0||a.hasChildren())&&(t[i]=a)}return function(e){if(1===e.numberOfChildren&&e.children[LN]){var t=e.children[LN];return new tD(e.segments.concat(t.segments),t.children)}return e}(new tD(e.segments,t))}var _L=Wg(function e(t){Zg(this,e),this.path=t,this.route=this.path[this.path.length-1]}),EL=Wg(function e(t,n){Zg(this,e),this.component=t,this.route=n});function bL(e,t,n){var r=e._root;return SL(r,t?t._root:null,n,[r.value])}function PL(e,t,n){var r=function(e){if(!e)return null;for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function SL(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=bD(t);return e.children.forEach(function(e){(function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=e.value,o=t?t.value:null,s=n?n.getContext(e.value.outlet):null;if(o&&a.routeConfig===o.routeConfig){var u=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!rD(e.url,t.url);case"pathParamsOrQueryParamsChange":return!rD(e.url,t.url)||!HN(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ND(e,t)||!HN(e.queryParams,t.queryParams);default:return!ND(e,t)}}(o,a,a.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new _L(r)):(a.data=o.data,a._resolvedData=o._resolvedData),SL(e,t,a.component?s?s.children:null:n,r,i),u&&s&&s.outlet&&s.outlet.isActivated&&i.canDeactivateChecks.push(new EL(s.outlet.component,o))}else o&&OL(t,s,i),i.canActivateChecks.push(new _L(r)),SL(e,null,a.component?s?s.children:null:n,r,i)})(e,a[e.value.outlet],n,r.concat([e.value]),i),delete a[e.value.outlet]}),qN(a,function(e,t){return OL(e,n.getContext(t),i)}),i}function OL(e,t,n){var r=bD(e),i=e.value;qN(r,function(e,r){OL(e,i.component?t?t.children.getContext(r):null:t,n)}),n.canDeactivateChecks.push(new EL(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}var TL=Wg(function e(){Zg(this,e)});function IL(e){return new yy(function(t){return t.error(e)})}var AL=function(){function e(t,n,r,i,a,o){Zg(this,e),this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=a,this.relativeLinkResolution=o}return Wg(e,[{key:"recognize",value:function(){var e=fL(this.urlTree.root,[],[],this.config.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,LN);if(null===t)return null;var n=new ID([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},LN,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new ED(n,t),i=new AD(this.url,r);return this.inheritParamsAndData(i._root),i}},{key:"inheritParamsAndData",value:function(e){var t=this,n=e.value,r=TD(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(function(e){return t.inheritParamsAndData(e)})}},{key:"processSegmentGroup",value:function(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}},{key:"processChildren",value:function(e,t){for(var n=[],r=0,i=Object.keys(t.children);r<i.length;r++){var a=i[r],o=t.children[a],s=uL(e,a),u=this.processSegmentGroup(s,o,a);if(null===u)return null;n.push.apply(n,Bg(u))}var c=RL(n);return c.sort(function(e,t){return e.value.outlet===LN?-1:t.value.outlet===LN?1:e.value.outlet.localeCompare(t.value.outlet)}),c}},{key:"processSegment",value:function(e,t,n,r){var i,a=Hg(e);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=this.processSegmentAgainstRoute(o,t,n,r);if(null!==s)return s}}catch(u){a.e(u)}finally{a.f()}return vL(t,n,r)?[]:null}},{key:"processSegmentAgainstRoute",value:function(e,t,n,r){if(e.redirectTo||!dL(e,t,n,r))return null;var i,a=[],o=[];if("**"===e.path){var s=n.length>0?ZN(n).parameters:{};i=new ID(n,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,NL(e),sL(e),e.component,e,ML(t),xL(t)+n.length,DL(e))}else{var u=lL(t,e,n);if(!u.matched)return null;a=u.consumedSegments,o=n.slice(u.lastChild),i=new ID(a,u.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,NL(e),sL(e),e.component,e,ML(t),xL(t)+a.length,DL(e))}var c,l=(c=e).children?c.children:c.loadChildren?c._loadedConfig.routes:[],f=fL(t,a,o,l.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution),h=f.segmentGroup,d=f.slicedSegments;if(0===d.length&&h.hasChildren()){var v=this.processChildren(l,h);return null===v?null:[new ED(i,v)]}if(0===l.length&&0===d.length)return[new ED(i,[])];var p=sL(e)===r,g=this.processSegment(l,h,d,p?LN:r);return null===g?null:[new ED(i,g)]}}]),e}();function RL(e){var t,n=[],r=new Set,i=Hg(e);try{var a=function(){var e,i=t.value;if(!function(e){var t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}(i))return n.push(i),"continue";var a=n.find(function(e){return i.value.routeConfig===e.value.routeConfig});void 0!==a?((e=a.children).push.apply(e,Bg(i.children)),r.add(a)):n.push(i)};for(i.s();!(t=i.n()).done;)a()}catch(l){i.e(l)}finally{i.f()}var o,s=Hg(r);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=RL(u.children);n.push(new ED(u.value,c))}}catch(l){s.e(l)}finally{s.f()}return n.filter(function(e){return!r.has(e)})}function ML(e){for(var t=e;t._sourceSegment;)t=t._sourceSegment;return t}function xL(e){for(var t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;t._sourceSegment;)n+=(t=t._sourceSegment)._segmentIndexShift?t._segmentIndexShift:0;return n-1}function NL(e){return e.data||{}}function DL(e){return e.resolve||{}}function LL(e){return cN(function(t){var n=e(t);return n?Qy(n).pipe(Py(function(){return t})):kx(t)})}var FL=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n)}(function(){function e(){Zg(this,e)}return Wg(e,[{key:"shouldDetach",value:function(e){return!1}},{key:"store",value:function(e,t){}},{key:"shouldAttach",value:function(e){return!1}},{key:"retrieve",value:function(e){return null}},{key:"shouldReuseRoute",value:function(e,t){return e.routeConfig===t.routeConfig}}]),e}()),UL=new YC("ROUTES"),VL=function(){function e(t,n,r,i){Zg(this,e),this.loader=t,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=i}return Wg(e,[{key:"load",value:function(e,t){var n=this;if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);var r=this.loadModuleFactory(t.loadChildren).pipe(Py(function(r){n.onLoadEndListener&&n.onLoadEndListener(t);var i=r.create(e);return new QD($N(i.injector.get(UL,void 0,Em.Self|Em.Optional)).map(oL),i)}),hN(function(e){throw t._loader$=void 0,e}));return t._loader$=new uN(r,function(){return new Cy}).pipe(sN()),t._loader$}},{key:"loadModuleFactory",value:function(e){var t=this;return"string"==typeof e?Qy(this.loader.load(e)):WN(e()).pipe(Hy(function(e){return e instanceof GO?kx(e):Qy(t.compiler.compileModuleAsync(e))}))}}]),e}(),BL=Wg(function e(){Zg(this,e),this.outlet=null,this.route=null,this.resolver=null,this.children=new zL,this.attachRef=null}),zL=function(){function e(){Zg(this,e),this.contexts=new Map}return Wg(e,[{key:"onChildOutletCreated",value:function(e,t){var n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}},{key:"onChildOutletDestroyed",value:function(e){var t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}},{key:"onOutletDeactivated",value:function(){var e=this.contexts;return this.contexts=new Map,e}},{key:"onOutletReAttached",value:function(e){this.contexts=e}},{key:"getOrCreateContext",value:function(e){var t=this.getContext(e);return t||(t=new BL,this.contexts.set(e,t)),t}},{key:"getContext",value:function(e){return this.contexts.get(e)||null}}]),e}(),HL=function(){function e(){Zg(this,e)}return Wg(e,[{key:"shouldProcessUrl",value:function(e){return!0}},{key:"extract",value:function(e){return e}},{key:"merge",value:function(e,t){return e}}]),e}();function GL(e){throw e}function $L(e,t,n){return t.parse("/")}function ZL(e,t){return kx(null)}var qL={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},WL={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},jL=function(){var e=function(){function e(t,n,r,i,a,o,s,u){var c=this;Zg(this,e),this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Cy,this.errorHandler=GL,this.malformedUriErrorHandler=$L,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:ZL,afterPreactivation:ZL},this.urlHandlingStrategy=new HL,this.routeReuseStrategy=new FL,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=a.get(HO),this.console=a.get(zT);var l=a.get(eI);this.isNgZoneEnabled=l instanceof eI&&eI.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=new eD(new tD([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new VL(o,s,function(e){return c.triggerEvent(new IN(e))},function(e){return c.triggerEvent(new AN(e))}),this.routerState=SD(this.currentUrlTree,this.rootComponentType),this.transitions=new nN({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return Wg(e,[{key:"browserPageId",get:function(){var e;return null===(e=this.location.getState())||void 0===e?void 0:e.\u0275routerPageId}},{key:"setupNavigations",value:function(e){var t=this,n=this.events;return e.pipe(wx(function(e){return 0!==e.id}),Py(function(e){return Object.assign(Object.assign({},e),{extractedUrl:t.urlHandlingStrategy.extract(e.rawUrl)})}),cN(function(e){var r=!1,i=!1;return kx(e).pipe(mN(function(e){t.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:t.lastSuccessfulNavigation?Object.assign(Object.assign({},t.lastSuccessfulNavigation),{previousNavigation:null}):null}}),cN(function(e){var r=t.browserUrlTree.toString(),a=!t.navigated||e.extractedUrl.toString()!==r||r!==t.currentUrlTree.toString();if(("reload"===t.onSameUrlNavigation||a)&&t.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return YL(e.source)&&(t.browserUrlTree=e.extractedUrl),kx(e).pipe(cN(function(e){var r=t.transitions.getValue();return n.next(new CN(e.id,t.serializeUrl(e.extractedUrl),e.source,e.restoredState)),r!==t.transitions.getValue()?$y:Promise.resolve(e)}),function(e,t,n,r){return cN(function(i){return function(e,t,n,r,i){return new CL(e,t,n,r,i).apply()}(e,t,n,i.extractedUrl,r).pipe(Py(function(e){return Object.assign(Object.assign({},i),{urlAfterRedirects:e})}))})}(t.ngModule.injector,t.configLoader,t.urlSerializer,t.config),mN(function(e){t.currentNavigation=Object.assign(Object.assign({},t.currentNavigation),{finalUrl:e.urlAfterRedirects})}),function(e,n,r,a,o){return Hy(function(r){return function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";try{var s=new AL(e,t,n,r,a,o).recognize();return null===s?IL(new TL):kx(s)}catch(i){return IL(i)}}(e,n,r.urlAfterRedirects,(s=r.urlAfterRedirects,t.serializeUrl(s)),a,o).pipe(Py(function(e){return Object.assign(Object.assign({},r),{targetSnapshot:e})}));var s})}(t.rootComponentType,t.config,0,t.paramsInheritanceStrategy,t.relativeLinkResolution),mN(function(e){"eager"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(e.urlAfterRedirects,e),t.browserUrlTree=e.urlAfterRedirects);var r=new bN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);n.next(r)}));if(a&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){var o=e.id,s=e.extractedUrl,u=e.source,c=e.restoredState,l=e.extras,f=new CN(o,t.serializeUrl(s),u,c);n.next(f);var h=SD(s,t.rootComponentType).snapshot;return kx(Object.assign(Object.assign({},e),{targetSnapshot:h,urlAfterRedirects:s,extras:Object.assign(Object.assign({},l),{skipLocationChange:!1,replaceUrl:!1})}))}return t.rawUrlTree=e.rawUrl,t.browserUrlTree=e.urlAfterRedirects,e.resolve(null),$y}),LL(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.beforePreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),mN(function(e){var n=new PN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),Py(function(e){return Object.assign(Object.assign({},e),{guards:bL(e.targetSnapshot,e.currentSnapshot,t.rootContexts)})}),function(e,t){return Hy(function(n){var r=n.targetSnapshot,i=n.currentSnapshot,a=n.guards,o=a.canActivateChecks,s=a.canDeactivateChecks;return 0===s.length&&0===o.length?kx(Object.assign(Object.assign({},n),{guardsResult:!0})):function(e,t,n,r){return Qy(e).pipe(Hy(function(e){return function(e,t,n,r,i){var a=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return a&&0!==a.length?kx(a.map(function(a){var o,s=PL(a,t,i);if(function(e){return e&&XD(e.canDeactivate)}(s))o=WN(s.canDeactivate(e,t,n,r));else{if(!XD(s))throw new Error("Invalid CanDeactivate guard");o=WN(s(e,t,n,r))}return o.pipe(yN())})).pipe(tL()):kx(!0)}(e.component,e.route,n,t,r)}),yN(function(e){return!0!==e},!0))}(s,r,i,e).pipe(Hy(function(n){return n&&function(e){return"boolean"==typeof e}(n)?function(e,t,n,r){return Qy(t).pipe(Cx(function(t){return aN(function(e,t){return null!==e&&t&&t(new RN(e)),kx(!0)}(t.route.parent,r),function(e,t){return null!==e&&t&&t(new xN(e)),kx(!0)}(t.route,r),function(e,t,n){var r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(function(e){return function(e){var t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)}).filter(function(e){return null!==e}).map(function(t){return oN(function(){return kx(t.guards.map(function(i){var a,o=PL(i,t.node,n);if(function(e){return e&&XD(e.canActivateChild)}(o))a=WN(o.canActivateChild(r,e));else{if(!XD(o))throw new Error("Invalid CanActivateChild guard");a=WN(o(r,e))}return a.pipe(yN())})).pipe(tL())})});return kx(i).pipe(tL())}(e,t.path,n),function(e,t,n){var r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return kx(!0);var i=r.map(function(r){return oN(function(){var i,a=PL(r,t,n);if(function(e){return e&&XD(e.canActivate)}(a))i=WN(a.canActivate(t,e));else{if(!XD(a))throw new Error("Invalid CanActivate guard");i=WN(a(t,e))}return i.pipe(yN())})});return kx(i).pipe(tL())}(e,t.route,n))}),yN(function(e){return!0!==e},!0))}(r,o,e,t):kx(n)}),Py(function(e){return Object.assign(Object.assign({},n),{guardsResult:e})}))})}(t.ngModule.injector,function(e){return t.triggerEvent(e)}),mN(function(e){if(JD(e.guardsResult)){var n=BN('Redirecting to "'.concat(t.serializeUrl(e.guardsResult),'"'));throw n.url=e.guardsResult,n}var r=new SN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);t.triggerEvent(r)}),wx(function(e){return!!e.guardsResult||(t.restoreHistory(e),t.cancelNavigationTransition(e,""),!1)}),LL(function(e){if(e.guards.canActivateChecks.length)return kx(e).pipe(mN(function(e){var n=new ON(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),cN(function(e){var n=!1;return kx(e).pipe(function(e,t){return Hy(function(n){var r=n.targetSnapshot,i=n.guards.canActivateChecks;if(!i.length)return kx(n);var a=0;return Qy(i).pipe(Cx(function(n){return function(e,t,n,r){return function(e,t,n,r){var i=Object.keys(e);if(0===i.length)return kx({});var a={};return Qy(i).pipe(Hy(function(i){return function(e,t,n,r){var i=PL(e,t,r);return WN(i.resolve?i.resolve(t,n):i(t,n))}(e[i],t,n,r).pipe(mN(function(e){a[i]=e}))}),dN(1),Hy(function(){return Object.keys(a).length===i.length?kx(a):$y}))}(e._resolve,e,t,r).pipe(Py(function(t){return e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),TD(e,n).resolve),null}))}(n.route,r,e,t)}),mN(function(){return a++}),dN(1),Hy(function(e){return a===i.length?kx(n):$y}))})}(t.paramsInheritanceStrategy,t.ngModule.injector),mN({next:function(){return n=!0},complete:function(){n||(t.restoreHistory(e),t.cancelNavigationTransition(e,"At least one route resolver didn't emit any value."))}}))}),mN(function(e){var n=new TN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}))}),LL(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.afterPreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),Py(function(e){var n=function(e,t,n){var r=DD(e,t._root,n?n._root:void 0);return new PD(r,t)}(t.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:n})}),mN(function(e){t.currentUrlTree=e.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(e.urlAfterRedirects,e.rawUrl),t.routerState=e.targetRouterState,"deferred"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,e),t.browserUrlTree=e.urlAfterRedirects)}),function(e,t,n){return Py(function(r){return new YD(t,r.targetRouterState,r.currentRouterState,n).activate(e),r})}(t.rootContexts,t.routeReuseStrategy,function(e){return t.triggerEvent(e)}),mN({next:function(){r=!0},complete:function(){r=!0}}),function(e){return Ey(function(t,n){try{t.subscribe(n)}finally{n.add(e)}})}(function(){var n;if(!r&&!i){var a="Navigation ID ".concat(e.id," is not equal to the current navigation id ").concat(t.navigationId);"replace"===t.canceledNavigationResolution?(t.restoreHistory(e),t.cancelNavigationTransition(e,a)):t.cancelNavigationTransition(e,a)}(null===(n=t.currentNavigation)||void 0===n?void 0:n.id)===e.id&&(t.currentNavigation=null)}),hN(function(r){if(i=!0,function(e){return e&&e[VN]}(r)){var a=JD(r.url);a||(t.navigated=!0,t.restoreHistory(e,!0));var o=new _N(e.id,t.serializeUrl(e.extractedUrl),r.message);n.next(o),a?setTimeout(function(){var n=t.urlHandlingStrategy.merge(r.url,t.rawUrlTree),i={skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||YL(e.source)};t.scheduleNavigation(n,"imperative",null,i,{resolve:e.resolve,reject:e.reject,promise:e.promise})},0):e.resolve(!1)}else{t.restoreHistory(e,!0);var s=new EN(e.id,t.serializeUrl(e.extractedUrl),r);n.next(s);try{e.resolve(t.errorHandler(r))}catch(o){e.reject(o)}}return $y}))}))}},{key:"resetRootComponentType",value:function(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}},{key:"setTransition",value:function(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var e=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe(function(t){var n=e.extractLocationChangeInfoFromEvent(t);e.shouldScheduleNavigation(e.lastLocationChangeInfo,n)&&setTimeout(function(){var t=n.source,r=n.state,i=n.urlTree,a={replaceUrl:!0};if(r){var o=Object.assign({},r);delete o.navigationId,delete o.\u0275routerPageId,0!==Object.keys(o).length&&(a.state=o)}e.scheduleNavigation(i,t,r,a)},0),e.lastLocationChangeInfo=n}))}},{key:"extractLocationChangeInfoFromEvent",value:function(e){var t;return{source:"popstate"===e.type?"popstate":"hashchange",urlTree:this.parseUrl(e.url),state:(null===(t=e.state)||void 0===t?void 0:t.navigationId)?e.state:null,transitionId:this.getTransition().id}}},{key:"shouldScheduleNavigation",value:function(e,t){if(!e)return!0;var n=t.urlTree.toString()===e.urlTree.toString();return t.transitionId!==e.transitionId||!n||!("hashchange"===t.source&&"popstate"===e.source||"popstate"===t.source&&"hashchange"===e.source)}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(e){this.events.next(e)}},{key:"resetConfig",value:function(e){rL(e),this.config=e.map(oL),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}},{key:"createUrlTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.relativeTo,r=t.queryParams,i=t.fragment,a=t.queryParamsHandling,o=t.preserveFragment,s=n||this.routerState.root,u=o?this.currentUrlTree.fragment:i,c=null;switch(a){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}return null!==c&&(c=this.removeEmptyProps(c)),function(e,t,n,r,i){if(0===n.length)return VD(t.root,t.root,t,r,i);var a=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new zD(!0,0,e);var t=0,n=!1,r=e.reduce(function(e,r,i){if("object"==typeof r&&null!=r){if(r.outlets){var a={};return qN(r.outlets,function(e,t){a[t]="string"==typeof e?e.split("/"):e}),[].concat(Bg(e),[{outlets:a}])}if(r.segmentPath)return[].concat(Bg(e),[r.segmentPath])}return"string"!=typeof r?[].concat(Bg(e),[r]):0===i?(r.split("/").forEach(function(r,i){0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?t++:""!=r&&e.push(r))}),e):[].concat(Bg(e),[r])},[]);return new zD(n,t,r)}(n);if(a.toRoot())return VD(t.root,new tD([],{}),t,r,i);var o=function(e,t,n){if(e.isAbsolute)return new HD(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){var r=n.snapshot._urlSegment;return new HD(r,r===t.root,0)}var i=FD(e.commands[0])?0:1;return function(e,t,n){for(var r=e,i=t,a=n;a>i;){if(a-=i,!(r=r.parent))throw new Error("Invalid number of '../'");i=r.segments.length}return new HD(r,!1,i-a)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,e.numberOfDoubleDots)}(a,t,e),s=o.processChildren?$D(o.segmentGroup,o.index,a.commands):GD(o.segmentGroup,o.index,a.commands);return VD(o.segmentGroup,s,t,r,i)}(s,this.currentUrlTree,e,c,null!=u?u:null)}},{key:"navigateByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1},n=JD(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,t)}},{key:"navigate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(e){for(var t=0;t<e.length;t++){var n=e[t];if(null==n)throw new Error("The requested path contains ".concat(n," segment at index ").concat(t))}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}},{key:"serializeUrl",value:function(e){return this.urlSerializer.serialize(e)}},{key:"parseUrl",value:function(e){var t;try{t=this.urlSerializer.parse(e)}catch(n){t=this.malformedUriErrorHandler(n,this.urlSerializer,e)}return t}},{key:"isActive",value:function(e,t){var n;if(n=!0===t?Object.assign({},qL):!1===t?Object.assign({},WL):t,JD(e))return KN(this.currentUrlTree,e,n);var r=this.parseUrl(e);return KN(this.currentUrlTree,r,n)}},{key:"removeEmptyProps",value:function(e){return Object.keys(e).reduce(function(t,n){var r=e[n];return null!=r&&(t[n]=r),t},{})}},{key:"processNavigations",value:function(){var e=this;this.navigations.subscribe(function(t){e.navigated=!0,e.lastSuccessfulId=t.id,e.currentPageId=t.targetPageId,e.events.next(new wN(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(e.currentUrlTree))),e.lastSuccessfulNavigation=e.currentNavigation,t.resolve(!0)},function(t){e.console.warn("Unhandled Navigation Error: ".concat(t))})}},{key:"scheduleNavigation",value:function(e,t,n,r,i){var a,o;if(this.disposed)return Promise.resolve(!1);var s,u,c,l=this.getTransition(),f=YL(t)&&l&&!YL(l.source),h=(this.lastSuccessfulId===l.id||this.currentNavigation?l.rawUrl:l.urlAfterRedirects).toString()===e.toString();if(f&&h)return Promise.resolve(!0);i?(s=i.resolve,u=i.reject,c=i.promise):c=new Promise(function(e,t){s=e,u=t});var d,v=++this.navigationId;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(n=this.location.getState()),d=n&&n.\u0275routerPageId?n.\u0275routerPageId:r.replaceUrl||r.skipLocationChange?null!==(a=this.browserPageId)&&void 0!==a?a:0:(null!==(o=this.browserPageId)&&void 0!==o?o:0)+1):d=0,this.setTransition({id:v,targetPageId:d,source:t,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:r,resolve:s,reject:u,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(function(e){return Promise.reject(e)})}},{key:"setBrowserUrl",value:function(e,t){var n=this.urlSerializer.serialize(e),r=Object.assign(Object.assign({},t.extras.state),this.generateNgRouterState(t.id,t.targetPageId));this.location.isCurrentPathEqualTo(n)||t.extras.replaceUrl?this.location.replaceState(n,"",r):this.location.go(n,"",r)}},{key:"restoreHistory",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("computed"===this.canceledNavigationResolution){var i=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(t=this.currentNavigation)||void 0===t?void 0:t.finalUrl)||0===i?this.currentUrlTree===(null===(n=this.currentNavigation)||void 0===n?void 0:n.finalUrl)&&0===i&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(i)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}},{key:"resetState",value:function(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}},{key:"cancelNavigationTransition",value:function(e,t){var n=new _N(e.id,this.serializeUrl(e.extractedUrl),t);this.triggerEvent(n),e.resolve(!1)}},{key:"generateNgRouterState",value:function(e,t){return"computed"===this.canceledNavigationResolution?{navigationId:e,"\u0275routerPageId":t}:{navigationId:e}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(QC),pw(iD),pw(zL),pw(qI),pw(Ib),pw(wI),pw(QT),pw(void 0))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}();function YL(e){return"imperative"!==e}var KL=function(){var e=function(){function e(t,n,r,i,a){Zg(this,e),this.router=t,this.route=n,this.commands=[],this.onChanges=new Cy,null==r&&i.setAttribute(a.nativeElement,"tabindex","0")}return Wg(e,[{key:"ngOnChanges",value:function(e){this.onChanges.next(this)}},{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"onClick",value:function(){var e={skipLocationChange:XL(this.skipLocationChange),replaceUrl:XL(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:XL(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(jL),Qb(OD),qC("tabindex"),Qb(fO),Qb(uO))},e.\u0275dir=Ym({type:e,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,t){1&e&&uP("click",function(){return t.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[uk]}),e}(),QL=function(){var e=function(){function e(t,n,r){var i=this;Zg(this,e),this.router=t,this.route=n,this.locationStrategy=r,this.commands=[],this.onChanges=new Cy,this.subscription=t.events.subscribe(function(e){e instanceof wN&&i.updateTargetUrlAndHref()})}return Wg(e,[{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"ngOnChanges",value:function(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onClick",value:function(e,t,n,r,i){if(0!==e||t||n||r||i||"string"==typeof this.target&&"_self"!=this.target)return!0;var a={skipLocationChange:XL(this.skipLocationChange),replaceUrl:XL(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,a),!1}},{key:"updateTargetUrlAndHref",value:function(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:XL(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(jL),Qb(OD),Qb(zI))},e.\u0275dir=Ym({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,t){1&e&&uP("click",function(e){return t.onClick(e.button,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey)}),2&e&&(HP("href",t.href,u_),$b("target",t.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[uk]}),e}();function XL(e){return""===e||!!e}var JL=function(){var e=function(){function e(t,n,r,i,a){Zg(this,e),this.parentContexts=t,this.location=n,this.resolver=r,this.changeDetector=a,this.activated=null,this._activatedRoute=null,this.activateEvents=new gT,this.deactivateEvents=new gT,this.name=i||LN,t.onChildOutletCreated(this.name,this)}return Wg(e,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var e=this.activated;return this.activated=null,this._activatedRoute=null,e}},{key:"attach",value:function(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}},{key:"deactivate",value:function(){if(this.activated){var e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}},{key:"activateWith",value:function(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;var n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new eF(e,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(zL),Qb(ZO),Qb(iO),qC("name"),Qb(NO))},e.\u0275dir=Ym({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),e}(),eF=function(){function e(t,n,r){Zg(this,e),this.route=t,this.childContexts=n,this.parent=r}return Wg(e,[{key:"get",value:function(e,t){return e===OD?this.route:e===zL?this.childContexts:this.parent.get(e,t)}}]),e}(),tF=Wg(function e(){Zg(this,e)}),nF=function(){function e(){Zg(this,e)}return Wg(e,[{key:"preload",value:function(e,t){return kx(null)}}]),e}(),rF=function(){var e=function(){function e(t,n,r,i,a){Zg(this,e),this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=new VL(n,r,function(e){return t.triggerEvent(new IN(e))},function(e){return t.triggerEvent(new AN(e))})}return Wg(e,[{key:"setUpPreloading",value:function(){var e=this;this.subscription=this.router.events.pipe(wx(function(e){return e instanceof wN}),Cx(function(){return e.preload()})).subscribe(function(){})}},{key:"preload",value:function(){var e=this.injector.get(HO);return this.processRoutes(e,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"processRoutes",value:function(e,t){var n,r=[],i=Hg(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.loadChildren&&!a.canLoad&&a._loadedConfig){var o=a._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else a.loadChildren&&!a.canLoad?r.push(this.preloadConfig(e,a)):a.children&&r.push(this.processRoutes(e,a.children))}}catch(s){i.e(s)}finally{i.f()}return Qy(r).pipe(Gy(),Py(function(e){}))}},{key:"preloadConfig",value:function(e,t){var n=this;return this.preloadingStrategy.preload(t,function(){return(t._loadedConfig?kx(t._loadedConfig):n.loader.load(e.injector,t)).pipe(Hy(function(e){return t._loadedConfig=e,n.processRoutes(e.module,e.routes)}))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(jL),pw(wI),pw(QT),pw(Ib),pw(tF))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),iF=function(){var e=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Zg(this,e),this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}return Wg(e,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof CN?(e.store[e.lastId]=e.viewportScroller.getScrollPosition(),e.lastSource=t.navigationTrigger,e.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof wN&&(e.lastId=t.id,e.scheduleScrollEvent(t,e.router.parseUrl(t.urlAfterRedirects).fragment))})}},{key:"consumeScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof DN&&(t.position?"top"===e.options.scrollPositionRestoration?e.viewportScroller.scrollToPosition([0,0]):"enabled"===e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===e.options.anchorScrolling?e.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition([0,0]))})}},{key:"scheduleScrollEvent",value:function(e,t){this.router.triggerEvent(new DN(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(jL),pw(GA),pw(void 0))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),aF=new YC("ROUTER_CONFIGURATION"),oF=new YC("ROUTER_FORROOT_GUARD"),sF=[qI,{provide:iD,useClass:aD},{provide:jL,useFactory:function(e,t,n,r,i,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,l=new jL(null,e,t,n,r,i,a,$N(o));return u&&(l.urlHandlingStrategy=u),c&&(l.routeReuseStrategy=c),function(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy)}(s,l),s.enableTracing&&l.events.subscribe(function(e){var t,n;null===(t=console.group)||void 0===t||t.call(console,"Router Event: ".concat(e.constructor.name)),console.log(e.toString()),console.log(e),null===(n=console.groupEnd)||void 0===n||n.call(console)}),l},deps:[iD,zL,qI,Ib,wI,QT,UL,aF,[function(){return Wg(function e(){Zg(this,e)})}(),new Ew],[function(){return Wg(function e(){Zg(this,e)})}(),new Ew]]},zL,{provide:OD,useFactory:function(e){return e.routerState.root},deps:[jL]},{provide:wI,useClass:bI},rF,nF,function(){function e(){Zg(this,e)}return Wg(e,[{key:"preload",value:function(e,t){return t().pipe(hN(function(){return kx(null)}))}}]),e}(),{provide:aF,useValue:{enableTracing:!1}}];function uF(){return new vI("Router",jL)}var cF=function(){var e=function(){function e(t,n){Zg(this,e)}return Wg(e,null,[{key:"forRoot",value:function(t,n){return{ngModule:e,providers:[sF,dF(t),{provide:oF,useFactory:hF,deps:[[jL,new Ew,new bw]]},{provide:aF,useValue:n||{}},{provide:zI,useFactory:fF,deps:[MI,[new _w(GI),new Ew],aF]},{provide:iF,useFactory:lF,deps:[jL,GA,aF]},{provide:tF,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:nF},{provide:vI,multi:!0,useFactory:uF},[vF,{provide:xT,multi:!0,useFactory:pF,deps:[vF]},{provide:yF,useFactory:gF,deps:[vF]},{provide:BT,multi:!0,useExisting:yF}]]}}},{key:"forChild",value:function(t){return{ngModule:e,providers:[dF(t)]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(oF,8),pw(jL,8))},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({}),e}();function lF(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new iF(e,t,n)}function fF(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.useHash?new ZI(e,t):new $I(e,t)}function hF(e){return"guarded"}function dF(e){return[{provide:KC,multi:!0,useValue:e},{provide:UL,multi:!0,useValue:e}]}var vF=function(){var e=function(){function e(t){Zg(this,e),this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Cy}return Wg(e,[{key:"appInitializer",value:function(){var e=this;return this.injector.get(NI,Promise.resolve(null)).then(function(){if(e.destroyed)return Promise.resolve(!0);var t=null,n=new Promise(function(e){return t=e}),r=e.injector.get(jL),i=e.injector.get(aF);return"disabled"===i.initialNavigation?(r.setUpLocationChangeListener(),t(!0)):"enabled"===i.initialNavigation||"enabledBlocking"===i.initialNavigation?(r.hooks.afterPreactivation=function(){return e.initNavigation?kx(null):(e.initNavigation=!0,t(!0),e.resultOfPreactivationDone)},r.initialNavigation()):t(!0),n})}},{key:"bootstrapListener",value:function(e){var t=this.injector.get(aF),n=this.injector.get(rF),r=this.injector.get(iF),i=this.injector.get(jL),a=this.injector.get(kI);e===a.components[0]&&(("enabledNonBlocking"===t.initialNavigation||void 0===t.initialNavigation)&&i.initialNavigation(),n.setUpPreloading(),r.init(),i.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"ngOnDestroy",value:function(){this.destroyed=!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(Ib))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}();function pF(e){return e.appInitializer.bind(e)}function gF(e){return e.bootstrapListener.bind(e)}var yF=new YC("Router Initializer"),mF=Wg(function e(){Zg(this,e)}),kF="*";function CF(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:2,steps:e,options:t}}function wF(e){return{type:6,styles:e,offset:null}}function _F(e){Promise.resolve(null).then(e)}var EF=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Zg(this,e),this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+n}return Wg(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"init",value:function(){}},{key:"play",value:function(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}},{key:"triggerMicrotask",value:function(){var e=this;_F(function(){return e._onFinish()})}},{key:"_onStart",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"pause",value:function(){}},{key:"restart",value:function(){}},{key:"finish",value:function(){this._onFinish()}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this._started=!1}},{key:"setPosition",value:function(e){this._position=this.totalTime?e*this.totalTime:1}},{key:"getPosition",value:function(){return this.totalTime?this._position/this.totalTime:1}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),bF=function(){function e(t){var n=this;Zg(this,e),this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;var r=0,i=0,a=0,o=this.players.length;0==o?_F(function(){return n._onFinish()}):this.players.forEach(function(e){e.onDone(function(){++r==o&&n._onFinish()}),e.onDestroy(function(){++i==o&&n._onDestroy()}),e.onStart(function(){++a==o&&n._onStart()})}),this.totalTime=this.players.reduce(function(e,t){return Math.max(e,t.totalTime)},0)}return Wg(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this.players.forEach(function(e){return e.init()})}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"_onStart",value:function(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[])}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(function(e){return e.play()})}},{key:"pause",value:function(){this.players.forEach(function(e){return e.pause()})}},{key:"restart",value:function(){this.players.forEach(function(e){return e.restart()})}},{key:"finish",value:function(){this._onFinish(),this.players.forEach(function(e){return e.finish()})}},{key:"destroy",value:function(){this._onDestroy()}},{key:"_onDestroy",value:function(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(function(e){return e.destroy()}),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this.players.forEach(function(e){return e.reset()}),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"setPosition",value:function(e){var t=e*this.totalTime;this.players.forEach(function(e){var n=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(n)})}},{key:"getPosition",value:function(){var e=this.players.reduce(function(e,t){return null===e||t.totalTime>e.totalTime?t:e},null);return null!=e?e.getPosition():0}},{key:"beforeDestroy",value:function(){this.players.forEach(function(e){e.beforeDestroy&&e.beforeDestroy()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}();function PF(){return"undefined"!=typeof window&&void 0!==window.document}function SF(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function OF(e){switch(e.length){case 0:return new EF;case 1:return e[0];default:return new bF(e)}}function TF(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=[],s=[],u=-1,c=null;if(r.forEach(function(e){var n=e.offset,r=n==u,l=r&&c||{};Object.keys(e).forEach(function(n){var r=n,s=e[n];if("offset"!==n)switch(r=t.normalizePropertyName(r,o),s){case"!":s=i[n];break;case kF:s=a[n];break;default:s=t.normalizeStyleValue(n,r,s,o)}l[r]=s}),r||s.push(l),c=l,u=n}),o.length){var l="\n - ";throw new Error("Unable to animate due to the following errors:".concat(l).concat(o.join(l)))}return s}function IF(e,t,n,r){switch(t){case"start":e.onStart(function(){return r(n&&AF(n,"start",e))});break;case"done":e.onDone(function(){return r(n&&AF(n,"done",e))});break;case"destroy":e.onDestroy(function(){return r(n&&AF(n,"destroy",e))})}}function AF(e,t,n){var r,i=RF(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null!==(r=n.totalTime)&&void 0!==r?r:e.totalTime,!!n.disabled),a=e._data;return null!=a&&(i._data=a),i}function RF(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6?arguments[6]:void 0;return{element:e,triggerName:t,fromState:n,toState:r,phaseName:i,totalTime:a,disabled:!!o}}function MF(e,t,n){var r;return e instanceof Map?(r=e.get(t))||e.set(t,r=n):(r=e[t])||(r=e[t]=n),r}function xF(e){var t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}var NF=function(e,t){return!1},DF=function(e,t){return!1},LF=function(e,t,n){return[]},FF=SF();(FF||"undefined"!=typeof Element)&&(NF=PF()?function(e,t){for(;t&&t!==document.documentElement;){if(t===e)return!0;t=t.parentNode||t.host}return!1}:function(e,t){return e.contains(t)},DF=function(){if(FF||Element.prototype.matches)return function(e,t){return e.matches(t)};var e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?function(e,n){return t.apply(e,[n])}:DF}(),LF=function(e,t,n){var r=[];if(n)for(var i=e.querySelectorAll(t),a=0;a<i.length;a++)r.push(i[a]);else{var o=e.querySelector(t);o&&r.push(o)}return r});var UF=null,VF=!1;function BF(e){UF||(UF=("undefined"!=typeof document?document.body:null)||{},VF=!!UF.style&&"WebkitAppearance"in UF.style);var t=!0;return UF.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(!(t=e in UF.style)&&VF&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in UF.style)),t}var zF=DF,HF=NF,GF=LF;function $F(e){var t={};return Object.keys(e).forEach(function(n){var r=n.replace(/([a-z])([A-Z])/g,"$1-$2");t[r]=e[n]}),t}var ZF=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"validateStyleProperty",value:function(e){return BF(e)}},{key:"matchesElement",value:function(e,t){return zF(e,t)}},{key:"containsElement",value:function(e,t){return HF(e,t)}},{key:"query",value:function(e,t,n){return GF(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return n||""}},{key:"animate",value:function(e,t,n,r,i){return new EF(n,r)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),qF=function(){var e=Wg(function e(){Zg(this,e)});return e.NOOP=new ZF,e}(),WF="ng-enter",jF="ng-leave",YF="ng-trigger",KF=".ng-trigger",QF="ng-animating",XF=".ng-animating";function JF(e){if("number"==typeof e)return e;var t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:eU(parseFloat(t[1]),t[2])}function eU(e,t){return"s"===t?1e3*e:e}function tU(e,t,n){return e.hasOwnProperty("duration")?e:function(e,t,n){var r,i=0,a="";if("string"==typeof e){var o=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===o)return t.push('The provided timing value "'.concat(e,'" is invalid.')),{duration:0,delay:0,easing:""};r=eU(parseFloat(o[1]),o[2]);var s=o[3];null!=s&&(i=eU(parseFloat(s),o[4]));var u=o[5];u&&(a=u)}else r=e;if(!n){var c=!1,l=t.length;r<0&&(t.push("Duration values below 0 are not allowed for this animation step."),c=!0),i<0&&(t.push("Delay values below 0 are not allowed for this animation step."),c=!0),c&&t.splice(l,0,'The provided timing value "'.concat(e,'" is invalid.'))}return{duration:r,delay:i,easing:a}}(e,t,n)}function nU(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).forEach(function(n){t[n]=e[n]}),t}function rU(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t)for(var r in e)n[r]=e[r];else nU(e,n);return n}function iU(e,t,n){return n?t+":"+n+";":""}function aU(e){for(var t="",n=0;n<e.style.length;n++){var r=e.style.item(n);t+=iU(0,r,e.style.getPropertyValue(r))}for(var i in e.style)e.style.hasOwnProperty(i)&&!i.startsWith("_")&&(t+=iU(0,pU(i),e.style[i]));e.setAttribute("style",t)}function oU(e,t,n){e.style&&(Object.keys(t).forEach(function(r){var i=vU(r);n&&!n.hasOwnProperty(r)&&(n[r]=e.style[i]),e.style[i]=t[r]}),SF()&&aU(e))}function sU(e,t){e.style&&(Object.keys(t).forEach(function(t){var n=vU(t);e.style[n]=""}),SF()&&aU(e))}function uU(e){return Array.isArray(e)?1==e.length?e[0]:CF(e):e}var cU=new RegExp("{{\\s*(.+?)\\s*}}","g");function lU(e){var t=[];if("string"==typeof e){for(var n;n=cU.exec(e);)t.push(n[1]);cU.lastIndex=0}return t}function fU(e,t,n){var r=e.toString(),i=r.replace(cU,function(e,r){var i=t[r];return t.hasOwnProperty(r)||(n.push("Please provide a value for the animation param ".concat(r)),i=""),i.toString()});return i==r?e:i}function hU(e){for(var t=[],n=e.next();!n.done;)t.push(n.value),n=e.next();return t}var dU=/-+([a-z0-9])/g;function vU(e){return e.replace(dU,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[1].toUpperCase()})}function pU(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function gU(e,t){return 0===e||0===t}function yU(e,t,n){var r=Object.keys(n);if(r.length&&t.length){var i=t[0],a=[];if(r.forEach(function(e){i.hasOwnProperty(e)||a.push(e),i[e]=n[e]}),a.length)for(var o=function(){var n=t[s];a.forEach(function(t){n[t]=kU(e,t)})},s=1;s<t.length;s++)o()}return t}function mU(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw new Error("Unable to resolve animation metadata node #".concat(t.type))}}function kU(e,t){return window.getComputedStyle(e)[t]}function CU(e,t){var n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(function(e){return function(e,t,n){if(":"==e[0]){var r=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return function(e,t){return parseFloat(t)>parseFloat(e)};case":decrement":return function(e,t){return parseFloat(t)<parseFloat(e)};default:return t.push('The transition alias value "'.concat(e,'" is not supported')),"* => *"}}(e,n);if("function"==typeof r)return void t.push(r);e=r}var i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push('The provided transition expression "'.concat(e,'" is not supported')),t;var a=i[1],o=i[2],s=i[3];t.push(EU(a,s)),"<"==o[0]&&("*"!=a||"*"!=s)&&t.push(EU(s,a))}(e,n,t)}):n.push(e),n}var wU=new Set(["true","1"]),_U=new Set(["false","0"]);function EU(e,t){var n=wU.has(e)||_U.has(e),r=wU.has(t)||_U.has(t);return function(i,a){var o="*"==e||e==i,s="*"==t||t==a;return!o&&n&&"boolean"==typeof i&&(o=i?wU.has(e):_U.has(e)),!s&&r&&"boolean"==typeof a&&(s=a?wU.has(t):_U.has(t)),o&&s}}var bU=new RegExp("s*:selfs*,?","g");function PU(e,t,n){return new SU(e).build(t,n)}var SU=function(){function e(t){Zg(this,e),this._driver=t}return Wg(e,[{key:"build",value:function(e,t){var n=new OU(t);return this._resetContextStyleTimingState(n),mU(this,uU(e),n)}},{key:"_resetContextStyleTimingState",value:function(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}},{key:"visitTrigger",value:function(e,t){var n=this,r=t.queryCount=0,i=t.depCount=0,a=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(function(e){if(n._resetContextStyleTimingState(t),0==e.type){var s=e,u=s.name;u.toString().split(/\s*,\s*/).forEach(function(e){s.name=e,a.push(n.visitState(s,t))}),s.name=u}else if(1==e.type){var c=n.visitTransition(e,t);r+=c.queryCount,i+=c.depCount,o.push(c)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:a,transitions:o,queryCount:r,depCount:i,options:null}}},{key:"visitState",value:function(e,t){var n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){var i=new Set,a=r||{};if(n.styles.forEach(function(e){if(TU(e)){var t=e;Object.keys(t).forEach(function(e){lU(t[e]).forEach(function(e){a.hasOwnProperty(e)||i.add(e)})})}}),i.size){var o=hU(i.values());t.errors.push('state("'.concat(e.name,'", ...) must define default values for all the following style substitutions: ').concat(o.join(", ")))}}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}},{key:"visitTransition",value:function(e,t){t.queryCount=0,t.depCount=0;var n=mU(this,uU(e.animation),t);return{type:1,matchers:CU(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:IU(e.options)}}},{key:"visitSequence",value:function(e,t){var n=this;return{type:2,steps:e.steps.map(function(e){return mU(n,e,t)}),options:IU(e.options)}}},{key:"visitGroup",value:function(e,t){var n=this,r=t.currentTime,i=0,a=e.steps.map(function(e){t.currentTime=r;var a=mU(n,e,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:3,steps:a,options:IU(e.options)}}},{key:"visitAnimate",value:function(e,t){var n=function(e,t){var n=null;if(e.hasOwnProperty("duration"))n=e;else if("number"==typeof e)return AU(tU(e,t).duration,0,"");var r=e;if(r.split(/\s+/).some(function(e){return"{"==e.charAt(0)&&"{"==e.charAt(1)})){var i=AU(0,0,"");return i.dynamic=!0,i.strValue=r,i}return AU((n=n||tU(r,t)).duration,n.delay,n.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;var r,i=e.styles?e.styles:wF({});if(5==i.type)r=this.visitKeyframes(i,t);else{var a=e.styles,o=!1;if(!a){o=!0;var s={};n.easing&&(s.easing=n.easing),a=wF(s)}t.currentTime+=n.duration+n.delay;var u=this.visitStyle(a,t);u.isEmptyStep=o,r=u}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}},{key:"visitStyle",value:function(e,t){var n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}},{key:"_makeStyleAst",value:function(e,t){var n=[];Array.isArray(e.styles)?e.styles.forEach(function(e){"string"==typeof e?e==kF?n.push(e):t.errors.push("The provided style string value ".concat(e," is not allowed.")):n.push(e)}):n.push(e.styles);var r=!1,i=null;return n.forEach(function(e){if(TU(e)){var t=e,n=t.easing;if(n&&(i=n,delete t.easing),!r)for(var a in t)if(t[a].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:e.offset,containsDynamicStyles:r,options:null}}},{key:"_validateStyleAst",value:function(e,t){var n=this,r=t.currentAnimateTimings,i=t.currentTime,a=t.currentTime;r&&a>0&&(a-=r.duration+r.delay),e.styles.forEach(function(e){"string"!=typeof e&&Object.keys(e).forEach(function(r){if(n._driver.validateStyleProperty(r)){var o=t.collectedStyles[t.currentQuerySelector],s=o[r],u=!0;s&&(a!=i&&a>=s.startTime&&i<=s.endTime&&(t.errors.push('The CSS property "'.concat(r,'" that exists between the times of "').concat(s.startTime,'ms" and "').concat(s.endTime,'ms" is also being animated in a parallel animation between the times of "').concat(a,'ms" and "').concat(i,'ms"')),u=!1),a=s.startTime),u&&(o[r]={startTime:a,endTime:i}),t.options&&function(e,t,n){var r=t.params||{},i=lU(e);i.length&&i.forEach(function(e){r.hasOwnProperty(e)||n.push("Unable to resolve the local animation param ".concat(e," in the given list of values"))})}(e[r],t.options,t.errors)}else t.errors.push('The provided animation property "'.concat(r,'" is not a supported CSS property for animations'))})})}},{key:"visitKeyframes",value:function(e,t){var n=this,r={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),r;var i=0,a=[],o=!1,s=!1,u=0,c=e.steps.map(function(e){var r=n._makeStyleAst(e,t),c=null!=r.offset?r.offset:function(e){if("string"==typeof e)return null;var t=null;if(Array.isArray(e))e.forEach(function(e){if(TU(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}});else if(TU(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}return t}(r.styles),l=0;return null!=c&&(i++,l=r.offset=c),s=s||l<0||l>1,o=o||l<u,u=l,a.push(l),r});s&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),o&&t.errors.push("Please ensure that all keyframe offsets are in order");var l=e.steps.length,f=0;i>0&&i<l?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==i&&(f=1/(l-1));var h=l-1,d=t.currentTime,v=t.currentAnimateTimings,p=v.duration;return c.forEach(function(e,i){var o=f>0?i==h?1:f*i:a[i],s=o*p;t.currentTime=d+v.delay+s,v.duration=s,n._validateStyleAst(e,t),e.offset=o,r.styles.push(e)}),r}},{key:"visitReference",value:function(e,t){return{type:8,animation:mU(this,uU(e.animation),t),options:IU(e.options)}}},{key:"visitAnimateChild",value:function(e,t){return t.depCount++,{type:9,options:IU(e.options)}}},{key:"visitAnimateRef",value:function(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:IU(e.options)}}},{key:"visitQuery",value:function(e,t){var n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;var i=function(e){var t=!!e.split(/\s*,\s*/).find(function(e){return":self"==e});return t&&(e=e.replace(bU,"")),e=e.replace(/@\*/g,KF).replace(/@\w+/g,function(e){return KF+"-"+e.substr(1)}).replace(/:animating/g,XF),[e,t]}(e.selector),a=Sg(i,2),o=a[0],s=a[1];t.currentQuerySelector=n.length?n+" "+o:o,MF(t.collectedStyles,t.currentQuerySelector,{});var u=mU(this,uU(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:u,originalSelector:e.selector,options:IU(e.options)}}},{key:"visitStagger",value:function(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");var n="full"===e.timings?{duration:0,delay:0,easing:"full"}:tU(e.timings,t.errors,!0);return{type:12,animation:mU(this,uU(e.animation),t),timings:n,options:null}}}]),e}(),OU=Wg(function e(t){Zg(this,e),this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null});function TU(e){return!Array.isArray(e)&&"object"==typeof e}function IU(e){return e?(e=nU(e)).params&&(e.params=function(e){return e?nU(e):null}(e.params)):e={},e}function AU(e,t,n){return{duration:e,delay:t,easing:n}}function RU(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:r,duration:i,delay:a,totalTime:i+a,easing:o,subTimeline:s}}var MU=function(){function e(){Zg(this,e),this._map=new Map}return Wg(e,[{key:"consume",value:function(e){var t=this._map.get(e);return t?this._map.delete(e):t=[],t}},{key:"append",value:function(e,t){var n,r=this._map.get(e);r||this._map.set(e,r=[]),(n=r).push.apply(n,Bg(t))}},{key:"has",value:function(e){return this._map.has(e)}},{key:"clear",value:function(){this._map.clear()}}]),e}(),xU=new RegExp(":enter","g"),NU=new RegExp(":leave","g");function DU(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s=arguments.length>7?arguments[7]:void 0,u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];return(new LU).buildKeyframes(e,t,n,r,i,a,o,s,u,c)}var LU=function(){function e(){Zg(this,e)}return Wg(e,[{key:"buildKeyframes",value:function(e,t,n,r,i,a,o,s,u){var c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];u=u||new MU;var l=new UU(e,t,u,r,i,c,[]);l.options=s,l.currentTimeline.setStyles([a],null,l.errors,s),mU(this,n,l);var f=l.timelines.filter(function(e){return e.containsAnimation()});if(f.length&&Object.keys(o).length){var h=f[f.length-1];h.allowOnlyTimelineStyles()||h.setStyles([o],null,l.errors,s)}return f.length?f.map(function(e){return e.buildKeyframes()}):[RU(t,[],[],[],0,0,"",!1)]}},{key:"visitTrigger",value:function(e,t){}},{key:"visitState",value:function(e,t){}},{key:"visitTransition",value:function(e,t){}},{key:"visitAnimateChild",value:function(e,t){var n=t.subInstructions.consume(t.element);if(n){var r=t.createSubContext(e.options),i=t.currentTimeline.currentTime,a=this._visitSubInstructions(n,r,r.options);i!=a&&t.transformIntoNewTimeline(a)}t.previousNode=e}},{key:"visitAnimateRef",value:function(e,t){var n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}},{key:"_visitSubInstructions",value:function(e,t,n){var r=t.currentTimeline.currentTime,i=null!=n.duration?JF(n.duration):null,a=null!=n.delay?JF(n.delay):null;return 0!==i&&e.forEach(function(e){var n=t.appendInstructionToTimeline(e,i,a);r=Math.max(r,n.duration+n.delay)}),r}},{key:"visitReference",value:function(e,t){t.updateOptions(e.options,!0),mU(this,e.animation,t),t.previousNode=e}},{key:"visitSequence",value:function(e,t){var n=this,r=t.subContextCount,i=t,a=e.options;if(a&&(a.params||a.delay)&&((i=t.createSubContext(a)).transformIntoNewTimeline(),null!=a.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=FU);var o=JF(a.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(function(e){return mU(n,e,i)}),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),t.previousNode=e}},{key:"visitGroup",value:function(e,t){var n=this,r=[],i=t.currentTimeline.currentTime,a=e.options&&e.options.delay?JF(e.options.delay):0;e.steps.forEach(function(o){var s=t.createSubContext(e.options);a&&s.delayNextStep(a),mU(n,o,s),i=Math.max(i,s.currentTimeline.currentTime),r.push(s.currentTimeline)}),r.forEach(function(e){return t.currentTimeline.mergeTimelineCollectedStyles(e)}),t.transformIntoNewTimeline(i),t.previousNode=e}},{key:"_visitTiming",value:function(e,t){if(e.dynamic){var n=e.strValue;return tU(t.params?fU(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}},{key:"visitAnimate",value:function(e,t){var n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());var i=e.style;5==i.type?this.visitKeyframes(i,t):(t.incrementTime(n.duration),this.visitStyle(i,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}},{key:"visitStyle",value:function(e,t){var n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();var i=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(i):n.setStyles(e.styles,i,t.errors,t.options),t.previousNode=e}},{key:"visitKeyframes",value:function(e,t){var n=t.currentAnimateTimings,r=t.currentTimeline.duration,i=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(function(e){a.forwardTime((e.offset||0)*i),a.setStyles(e.styles,e.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+i),t.previousNode=e}},{key:"visitQuery",value:function(e,t){var n=this,r=t.currentTimeline.currentTime,i=e.options||{},a=i.delay?JF(i.delay):0;a&&(6===t.previousNode.type||0==r&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=FU);var o=r,s=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=s.length;var u=null;s.forEach(function(r,i){t.currentQueryIndex=i;var s=t.createSubContext(e.options,r);a&&s.delayNextStep(a),r===t.element&&(u=s.currentTimeline),mU(n,e.animation,s),s.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,s.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),u&&(t.currentTimeline.mergeTimelineCollectedStyles(u),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}},{key:"visitStagger",value:function(e,t){var n=t.parentContext,r=t.currentTimeline,i=e.timings,a=Math.abs(i.duration),o=a*(t.currentQueryTotal-1),s=a*t.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":s=o-s;break;case"full":s=n.currentStaggerTime}var u=t.currentTimeline;s&&u.delayNextStep(s);var c=u.currentTime;mU(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-c+(r.startTime-n.currentTimeline.startTime)}}]),e}(),FU={},UU=function(){function e(t,n,r,i,a,o,s,u){Zg(this,e),this._driver=t,this.element=n,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=a,this.errors=o,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=FU,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new VU(this._driver,n,0),s.push(this.currentTimeline)}return Wg(e,[{key:"params",get:function(){return this.options.params}},{key:"updateOptions",value:function(e,t){var n=this;if(e){var r=e,i=this.options;null!=r.duration&&(i.duration=JF(r.duration)),null!=r.delay&&(i.delay=JF(r.delay));var a=r.params;if(a){var o=i.params;o||(o=this.options.params={}),Object.keys(a).forEach(function(e){(!t||!o.hasOwnProperty(e))&&(o[e]=fU(a[e],o,n.errors))})}}}},{key:"_copyOptions",value:function(){var e={};if(this.options){var t=this.options.params;if(t){var n=e.params={};Object.keys(t).forEach(function(e){n[e]=t[e]})}}return e}},{key:"createSubContext",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=n||this.element,a=new e(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return a.previousNode=this.previousNode,a.currentAnimateTimings=this.currentAnimateTimings,a.options=this._copyOptions(),a.updateOptions(t),a.currentQueryIndex=this.currentQueryIndex,a.currentQueryTotal=this.currentQueryTotal,a.parentContext=this,this.subContextCount++,a}},{key:"transformIntoNewTimeline",value:function(e){return this.previousNode=FU,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}},{key:"appendInstructionToTimeline",value:function(e,t,n){var r={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},i=new BU(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(i),r}},{key:"incrementTime",value:function(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}},{key:"delayNextStep",value:function(e){e>0&&this.currentTimeline.delayNextStep(e)}},{key:"invokeQuery",value:function(e,t,n,r,i,a){var o=[];if(r&&o.push(this.element),e.length>0){e=(e=e.replace(xU,"."+this._enterClassName)).replace(NU,"."+this._leaveClassName);var s=this._driver.query(this.element,e,1!=n);0!==n&&(s=n<0?s.slice(s.length+n,s.length):s.slice(0,n)),o.push.apply(o,Bg(s))}return!i&&0==o.length&&a.push('`query("'.concat(t,'")` returned zero elements. (Use `query("').concat(t,'", { optional: true })` if you wish to allow this.)')),o}}]),e}(),VU=function(){function e(t,n,r,i){Zg(this,e),this._driver=t,this.element=n,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}return Wg(e,[{key:"containsAnimation",value:function(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}},{key:"getCurrentStyleProperties",value:function(){return Object.keys(this._currentKeyframe)}},{key:"currentTime",get:function(){return this.startTime+this.duration}},{key:"delayNextStep",value:function(e){var t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}},{key:"fork",value:function(t,n){return this.applyStylesToKeyframe(),new e(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}},{key:"_loadKeyframe",value:function(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}},{key:"forwardFrame",value:function(){this.duration+=1,this._loadKeyframe()}},{key:"forwardTime",value:function(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}},{key:"_updateStyle",value:function(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}},{key:"allowOnlyTimelineStyles",value:function(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}},{key:"applyEmptyStep",value:function(e){var t=this;e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(function(e){t._backFill[e]=t._globalTimelineStyles[e]||kF,t._currentKeyframe[e]=kF}),this._currentEmptyStepKeyframe=this._currentKeyframe}},{key:"setStyles",value:function(e,t,n,r){var i=this;t&&(this._previousKeyframe.easing=t);var a=r&&r.params||{},o=function(e,t){var n,r={};return e.forEach(function(e){"*"===e?(n=n||Object.keys(t)).forEach(function(e){r[e]=kF}):rU(e,!1,r)}),r}(e,this._globalTimelineStyles);Object.keys(o).forEach(function(e){var t=fU(o[e],a,n);i._pendingStyles[e]=t,i._localTimelineStyles.hasOwnProperty(e)||(i._backFill[e]=i._globalTimelineStyles.hasOwnProperty(e)?i._globalTimelineStyles[e]:kF),i._updateStyle(e,t)})}},{key:"applyStylesToKeyframe",value:function(){var e=this,t=this._pendingStyles,n=Object.keys(t);0!=n.length&&(this._pendingStyles={},n.forEach(function(n){e._currentKeyframe[n]=t[n]}),Object.keys(this._localTimelineStyles).forEach(function(t){e._currentKeyframe.hasOwnProperty(t)||(e._currentKeyframe[t]=e._localTimelineStyles[t])}))}},{key:"snapshotCurrentStyles",value:function(){var e=this;Object.keys(this._localTimelineStyles).forEach(function(t){var n=e._localTimelineStyles[t];e._pendingStyles[t]=n,e._updateStyle(t,n)})}},{key:"getFinalKeyframe",value:function(){return this._keyframes.get(this.duration)}},{key:"properties",get:function(){var e=[];for(var t in this._currentKeyframe)e.push(t);return e}},{key:"mergeTimelineCollectedStyles",value:function(e){var t=this;Object.keys(e._styleSummary).forEach(function(n){var r=t._styleSummary[n],i=e._styleSummary[n];(!r||i.time>r.time)&&t._updateStyle(n,i.value)})}},{key:"buildKeyframes",value:function(){var e=this;this.applyStylesToKeyframe();var t=new Set,n=new Set,r=1===this._keyframes.size&&0===this.duration,i=[];this._keyframes.forEach(function(a,o){var s=rU(a,!0);Object.keys(s).forEach(function(e){var r=s[e];"!"==r?t.add(e):r==kF&&n.add(e)}),r||(s.offset=o/e.duration),i.push(s)});var a=t.size?hU(t.values()):[],o=n.size?hU(n.values()):[];if(r){var s=i[0],u=nU(s);s.offset=0,u.offset=1,i=[s,u]}return RU(this.element,i,a,o,this.duration,this.startTime,this.easing,!1)}}]),e}(),BU=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return Zg(this,n),(u=t.call(this,e,r,s.delay)).keyframes=i,u.preStyleProps=a,u.postStyleProps=o,u._stretchStartingKeyframe=c,u.timings={duration:s.duration,delay:s.delay,easing:s.easing},u}return Wg(n,[{key:"containsAnimation",value:function(){return this.keyframes.length>1}},{key:"buildKeyframes",value:function(){var e=this.keyframes,t=this.timings,n=t.delay,r=t.duration,i=t.easing;if(this._stretchStartingKeyframe&&n){var a=[],o=r+n,s=n/o,u=rU(e[0],!1);u.offset=0,a.push(u);var c=rU(e[0],!1);c.offset=zU(s),a.push(c);for(var l=e.length-1,f=1;f<=l;f++){var h=rU(e[f],!1);h.offset=zU((n+h.offset*r)/o),a.push(h)}r=o,n=0,i="",e=a}return RU(this.element,e,this.preStyleProps,this.postStyleProps,r,n,i,!0)}}]),n}(VU);function zU(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=Math.pow(10,t-1);return Math.round(e*n)/n}var HU=Wg(function e(){Zg(this,e)}),GU=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"normalizePropertyName",value:function(e,t){return vU(e)}},{key:"normalizeStyleValue",value:function(e,t,n,r){var i="",a=n.toString().trim();if($U[t]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{var o=n.match(/^[+-]?[\d\.]+([a-z]*)$/);o&&0==o[1].length&&r.push("Please provide a CSS unit value for ".concat(e,":").concat(n))}return a+i}}]),n}(HU),$U=function(e){var t={};return e.forEach(function(e){return t[e]=!0}),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(","));function ZU(e,t,n,r,i,a,o,s,u,c,l,f,h){return{type:0,element:e,triggerName:t,isRemovalTransition:i,fromState:n,fromStyles:a,toState:r,toStyles:o,timelines:s,queriedElements:u,preStyleProps:c,postStyleProps:l,totalTime:f,errors:h}}var qU={},WU=function(){function e(t,n,r){Zg(this,e),this._triggerName=t,this.ast=n,this._stateStyles=r}return Wg(e,[{key:"match",value:function(e,t,n,r){return function(e,t,n,r,i){return e.some(function(e){return e(t,n,r,i)})}(this.ast.matchers,e,t,n,r)}},{key:"buildStyles",value:function(e,t,n){var r=this._stateStyles["*"],i=this._stateStyles[e],a=r?r.buildStyles(t,n):{};return i?i.buildStyles(t,n):a}},{key:"build",value:function(e,t,n,r,i,a,o,s,u,c){var l=[],f=this.ast.options&&this.ast.options.params||qU,h=this.buildStyles(n,o&&o.params||qU,l),d=s&&s.params||qU,v=this.buildStyles(r,d,l),p=new Set,g=new Map,y=new Map,m="void"===r,k={params:Object.assign(Object.assign({},f),d)},C=c?[]:DU(e,t,this.ast.animation,i,a,h,v,k,u,l),w=0;if(C.forEach(function(e){w=Math.max(e.duration+e.delay,w)}),l.length)return ZU(t,this._triggerName,n,r,m,h,v,[],[],g,y,w,l);C.forEach(function(e){var n=e.element,r=MF(g,n,{});e.preStyleProps.forEach(function(e){return r[e]=!0});var i=MF(y,n,{});e.postStyleProps.forEach(function(e){return i[e]=!0}),n!==t&&p.add(n)});var _=hU(p.values());return ZU(t,this._triggerName,n,r,m,h,v,C,_,g,y,w)}}]),e}(),jU=function(){function e(t,n,r){Zg(this,e),this.styles=t,this.defaultParams=n,this.normalizer=r}return Wg(e,[{key:"buildStyles",value:function(e,t){var n=this,r={},i=nU(this.defaultParams);return Object.keys(e).forEach(function(t){var n=e[t];null!=n&&(i[t]=n)}),this.styles.styles.forEach(function(e){if("string"!=typeof e){var a=e;Object.keys(a).forEach(function(e){var o=a[e];o.length>1&&(o=fU(o,i,t));var s=n.normalizer.normalizePropertyName(e,t);o=n.normalizer.normalizeStyleValue(e,s,o,t),r[s]=o})}}),r}}]),e}(),YU=function(){function e(t,n,r){var i=this;Zg(this,e),this.name=t,this.ast=n,this._normalizer=r,this.transitionFactories=[],this.states={},n.states.forEach(function(e){i.states[e.name]=new jU(e.style,e.options&&e.options.params||{},r)}),KU(this.states,"true","1"),KU(this.states,"false","0"),n.transitions.forEach(function(e){i.transitionFactories.push(new WU(t,e,i.states))}),this.fallbackTransition=function(e,t,n){return new WU(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[function(e,t){return!0}],options:null,queryCount:0,depCount:0},t)}(t,this.states)}return Wg(e,[{key:"containsQueries",get:function(){return this.ast.queryCount>0}},{key:"matchTransition",value:function(e,t,n,r){return this.transitionFactories.find(function(i){return i.match(e,t,n,r)})||null}},{key:"matchStyles",value:function(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}]),e}();function KU(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}var QU=new MU,XU=function(){function e(t,n,r){Zg(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._animations={},this._playersById={},this.players=[]}return Wg(e,[{key:"register",value:function(e,t){var n=[],r=PU(this._driver,t,n);if(n.length)throw new Error("Unable to build the animation due to the following errors: ".concat(n.join("\n")));this._animations[e]=r}},{key:"_buildPlayer",value:function(e,t,n){var r=e.element,i=TF(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,i,e.duration,e.delay,e.easing,[],!0)}},{key:"create",value:function(e,t){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],o=this._animations[e],s=new Map;if(o?(n=DU(this._driver,t,o,WF,jF,{},{},i,QU,a)).forEach(function(e){var t=MF(s,e.element,{});e.postStyleProps.forEach(function(e){return t[e]=null})}):(a.push("The requested animation doesn't exist or has already been destroyed"),n=[]),a.length)throw new Error("Unable to create the animation due to the following errors: ".concat(a.join("\n")));s.forEach(function(e,t){Object.keys(e).forEach(function(n){e[n]=r._driver.computeStyle(t,n,kF)})});var u=OF(n.map(function(e){var t=s.get(e.element);return r._buildPlayer(e,{},t)}));return this._playersById[e]=u,u.onDestroy(function(){return r.destroy(e)}),this.players.push(u),u}},{key:"destroy",value:function(e){var t=this._getPlayer(e);t.destroy(),delete this._playersById[e];var n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}},{key:"_getPlayer",value:function(e){var t=this._playersById[e];if(!t)throw new Error("Unable to find the timeline player referenced by ".concat(e));return t}},{key:"listen",value:function(e,t,n,r){var i=RF(t,"","","");return IF(this._getPlayer(e),n,i,r),function(){}}},{key:"command",value:function(e,t,n,r){if("register"!=n)if("create"!=n){var i=this._getPlayer(e);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}else this.create(e,t,r[0]||{});else this.register(e,r[0])}}]),e}(),JU="ng-animate-queued",eV="ng-animate-disabled",tV=".ng-animate-disabled",nV=[],rV={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},iV={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},aV="__ng_removed",oV=function(){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Zg(this,e),this.namespaceId=r;var i=t&&t.hasOwnProperty("value");if(this.value=null!==(n=i?t.value:t)&&void 0!==n?n:null,i){var a=nU(t);delete a.value,this.options=a}else this.options={};this.options.params||(this.options.params={})}return Wg(e,[{key:"params",get:function(){return this.options.params}},{key:"absorbOptions",value:function(e){var t=e.params;if(t){var n=this.options.params;Object.keys(t).forEach(function(e){null==n[e]&&(n[e]=t[e])})}}}]),e}(),sV="void",uV=new oV(sV),cV=function(){function e(t,n,r){Zg(this,e),this.id=t,this.hostElement=n,this._engine=r,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,yV(n,this._hostClassName)}return Wg(e,[{key:"listen",value:function(e,t,n,r){var i,a=this;if(!this._triggers.hasOwnProperty(t))throw new Error('Unable to listen on the animation trigger event "'.concat(n,'" because the animation trigger "').concat(t,"\" doesn't exist!"));if(null==n||0==n.length)throw new Error('Unable to listen on the animation trigger "'.concat(t,'" because the provided event is undefined!'));if("start"!=(i=n)&&"done"!=i)throw new Error('The provided animation trigger event "'.concat(n,'" for the animation trigger "').concat(t,'" is not supported!'));var o=MF(this._elementListeners,e,[]),s={name:t,phase:n,callback:r};o.push(s);var u=MF(this._engine.statesByElement,e,{});return u.hasOwnProperty(t)||(yV(e,YF),yV(e,YF+"-"+t),u[t]=uV),function(){a._engine.afterFlush(function(){var e=o.indexOf(s);e>=0&&o.splice(e,1),a._triggers[t]||delete u[t]})}}},{key:"register",value:function(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}},{key:"_getTrigger",value:function(e){var t=this._triggers[e];if(!t)throw new Error('The provided animation trigger "'.concat(e,'" has not been registered!'));return t}},{key:"trigger",value:function(e,t,n){var r=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this._getTrigger(t),o=new fV(this.id,t,e),s=this._engine.statesByElement.get(e);s||(yV(e,YF),yV(e,YF+"-"+t),this._engine.statesByElement.set(e,s={}));var u=s[t],c=new oV(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&u&&c.absorbOptions(u.options),s[t]=c,u||(u=uV),c.value===sV||u.value!==c.value){var l=MF(this._engine.playersByElement,e,[]);l.forEach(function(e){e.namespaceId==r.id&&e.triggerName==t&&e.queued&&e.destroy()});var f=a.matchTransition(u.value,c.value,e,c.params),h=!1;if(!f){if(!i)return;f=a.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:f,fromState:u,toState:c,player:o,isFallbackTransition:h}),h||(yV(e,JU),o.onStart(function(){mV(e,JU)})),o.onDone(function(){var t=r.players.indexOf(o);t>=0&&r.players.splice(t,1);var n=r._engine.playersByElement.get(e);if(n){var i=n.indexOf(o);i>=0&&n.splice(i,1)}}),this.players.push(o),l.push(o),o}if(!function(e,t){var n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(var i=0;i<n.length;i++){var a=n[i];if(!t.hasOwnProperty(a)||e[a]!==t[a])return!1}return!0}(u.params,c.params)){var d=[],v=a.matchStyles(u.value,u.params,d),p=a.matchStyles(c.value,c.params,d);d.length?this._engine.reportError(d):this._engine.afterFlush(function(){sU(e,v),oU(e,p)})}}},{key:"deregister",value:function(e){var t=this;delete this._triggers[e],this._engine.statesByElement.forEach(function(t,n){delete t[e]}),this._elementListeners.forEach(function(n,r){t._elementListeners.set(r,n.filter(function(t){return t.name!=e}))})}},{key:"clearElementCache",value:function(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);var t=this._engine.playersByElement.get(e);t&&(t.forEach(function(e){return e.destroy()}),this._engine.playersByElement.delete(e))}},{key:"_signalRemovalForInnerTriggers",value:function(e,t){var n=this,r=this._engine.driver.query(e,KF,!0);r.forEach(function(e){if(!e[aV]){var r=n._engine.fetchNamespacesByElement(e);r.size?r.forEach(function(n){return n.triggerLeaveAnimation(e,t,!1,!0)}):n.clearElementCache(e)}}),this._engine.afterFlushAnimationsDone(function(){return r.forEach(function(e){return n.clearElementCache(e)})})}},{key:"triggerLeaveAnimation",value:function(e,t,n,r){var i=this,a=this._engine.statesByElement.get(e);if(a){var o=[];if(Object.keys(a).forEach(function(t){if(i._triggers[t]){var n=i.trigger(e,t,sV,r);n&&o.push(n)}}),o.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),n&&OF(o).onDone(function(){return i._engine.processLeaveNode(e)}),!0}return!1}},{key:"prepareLeaveAnimationListeners",value:function(e){var t=this,n=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(n&&r){var i=new Set;n.forEach(function(n){var a=n.name;if(!i.has(a)){i.add(a);var o=t._triggers[a].fallbackTransition,s=r[a]||uV,u=new oV(sV),c=new fV(t.id,a,e);t._engine.totalQueuedPlayers++,t._queue.push({element:e,triggerName:a,transition:o,fromState:s,toState:u,player:c,isFallbackTransition:!0})}})}}},{key:"removeNode",value:function(e,t){var n=this,r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),!this.triggerLeaveAnimation(e,t,!0)){var i=!1;if(r.totalAnimations){var a=r.players.length?r.playersByQueriedElement.get(e):[];if(a&&a.length)i=!0;else for(var o=e;o=o.parentNode;)if(r.statesByElement.get(o)){i=!0;break}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,t);else{var s=e[aV];(!s||s===rV)&&(r.afterFlush(function(){return n.clearElementCache(e)}),r.destroyInnerAnimations(e),r._onRemovalComplete(e,t))}}}},{key:"insertNode",value:function(e,t){yV(e,this._hostClassName)}},{key:"drainQueuedTransitions",value:function(e){var t=this,n=[];return this._queue.forEach(function(r){var i=r.player;if(!i.destroyed){var a=r.element,o=t._elementListeners.get(a);o&&o.forEach(function(t){if(t.name==r.triggerName){var n=RF(a,r.triggerName,r.fromState.value,r.toState.value);n._data=e,IF(r.player,t.phase,n,t.callback)}}),i.markedForDestroy?t._engine.afterFlush(function(){i.destroy()}):n.push(r)}}),this._queue=[],n.sort(function(e,n){var r=e.transition.ast.depCount,i=n.transition.ast.depCount;return 0==r||0==i?r-i:t._engine.driver.containsElement(e.element,n.element)?1:-1})}},{key:"destroy",value:function(e){this.players.forEach(function(e){return e.destroy()}),this._signalRemovalForInnerTriggers(this.hostElement,e)}},{key:"elementContainsData",value:function(e){var t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(function(t){return t.element===e})||t}}]),e}(),lV=function(){function e(t,n,r){Zg(this,e),this.bodyNode=t,this.driver=n,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=function(e,t){}}return Wg(e,[{key:"_onRemovalComplete",value:function(e,t){this.onRemovalComplete(e,t)}},{key:"queuedPlayers",get:function(){var e=[];return this._namespaceList.forEach(function(t){t.players.forEach(function(t){t.queued&&e.push(t)})}),e}},{key:"createNamespace",value:function(e,t){var n=new cV(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}},{key:"_balanceNamespaceList",value:function(e,t){var n=this._namespaceList.length-1;if(n>=0){for(var r=!1,i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,t)){this._namespaceList.splice(i+1,0,e),r=!0;break}r||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}},{key:"register",value:function(e,t){var n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}},{key:"registerTrigger",value:function(e,t,n){var r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}},{key:"destroy",value:function(e,t){var n=this;if(e){var r=this._fetchNamespace(e);this.afterFlush(function(){n.namespacesByHostElement.delete(r.hostElement),delete n._namespaceLookup[e];var t=n._namespaceList.indexOf(r);t>=0&&n._namespaceList.splice(t,1)}),this.afterFlushAnimationsDone(function(){return r.destroy(t)})}}},{key:"_fetchNamespace",value:function(e){return this._namespaceLookup[e]}},{key:"fetchNamespacesByElement",value:function(e){var t=new Set,n=this.statesByElement.get(e);if(n)for(var r=Object.keys(n),i=0;i<r.length;i++){var a=n[r[i]].namespaceId;if(a){var o=this._fetchNamespace(a);o&&t.add(o)}}return t}},{key:"trigger",value:function(e,t,n,r){if(hV(t)){var i=this._fetchNamespace(e);if(i)return i.trigger(t,n,r),!0}return!1}},{key:"insertNode",value:function(e,t,n,r){if(hV(t)){var i=t[aV];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;var a=this.collectedLeaveElements.indexOf(t);a>=0&&this.collectedLeaveElements.splice(a,1)}if(e){var o=this._fetchNamespace(e);o&&o.insertNode(t,n)}r&&this.collectEnterElement(t)}}},{key:"collectEnterElement",value:function(e){this.collectedEnterElements.push(e)}},{key:"markElementAsDisabled",value:function(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),yV(e,eV)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),mV(e,eV))}},{key:"removeNode",value:function(e,t,n,r){if(hV(t)){var i=e?this._fetchNamespace(e):null;if(i?i.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){var a=this.namespacesByHostElement.get(t);a&&a.id!==e&&a.removeNode(t,r)}}else this._onRemovalComplete(t,r)}},{key:"markElementAsRemoved",value:function(e,t,n,r){this.collectedLeaveElements.push(t),t[aV]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}},{key:"listen",value:function(e,t,n,r,i){return hV(t)?this._fetchNamespace(e).listen(t,n,r,i):function(){}}},{key:"_buildInstruction",value:function(e,t,n,r,i){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,i)}},{key:"destroyInnerAnimations",value:function(e){var t=this,n=this.driver.query(e,KF,!0);n.forEach(function(e){return t.destroyActiveAnimationsForElement(e)}),0!=this.playersByQueriedElement.size&&(n=this.driver.query(e,XF,!0)).forEach(function(e){return t.finishActiveQueriedAnimationOnElement(e)})}},{key:"destroyActiveAnimationsForElement",value:function(e){var t=this.playersByElement.get(e);t&&t.forEach(function(e){e.queued?e.markedForDestroy=!0:e.destroy()})}},{key:"finishActiveQueriedAnimationOnElement",value:function(e){var t=this.playersByQueriedElement.get(e);t&&t.forEach(function(e){return e.finish()})}},{key:"whenRenderingDone",value:function(){var e=this;return new Promise(function(t){if(e.players.length)return OF(e.players).onDone(function(){return t()});t()})}},{key:"processLeaveNode",value:function(e){var t=this,n=e[aV];if(n&&n.setForRemoval){if(e[aV]=rV,n.namespaceId){this.destroyInnerAnimations(e);var r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}this.driver.matchesElement(e,tV)&&this.markElementAsDisabled(e,!1),this.driver.query(e,tV,!0).forEach(function(e){t.markElementAsDisabled(e,!1)})}},{key:"flush",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=[];if(this.newHostElements.size&&(this.newHostElements.forEach(function(t,n){return e._balanceNamespaceList(t,n)}),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(var r=0;r<this.collectedEnterElements.length;r++)yV(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){var i=[];try{n=this._flushAnimations(i,t)}finally{for(var a=0;a<i.length;a++)i[a]()}}else for(var o=0;o<this.collectedLeaveElements.length;o++)this.processLeaveNode(this.collectedLeaveElements[o]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(function(e){return e()}),this._flushFns=[],this._whenQuietFns.length){var s=this._whenQuietFns;this._whenQuietFns=[],n.length?OF(n).onDone(function(){s.forEach(function(e){return e()})}):s.forEach(function(e){return e()})}}},{key:"reportError",value:function(e){throw new Error("Unable to process animations due to the following failed trigger transitions\n ".concat(e.join("\n")))}},{key:"_flushAnimations",value:function(e,t){var n=this,r=new MU,i=[],a=new Map,o=[],s=new Map,u=new Map,c=new Map,l=new Set;this.disabledNodes.forEach(function(e){l.add(e);for(var t=n.driver.query(e,".ng-animate-queued",!0),r=0;r<t.length;r++)l.add(t[r])});var f=this.bodyNode,h=Array.from(this.statesByElement.keys()),d=pV(h,this.collectedEnterElements),v=new Map,p=0;d.forEach(function(e,t){var n=WF+p++;v.set(t,n),e.forEach(function(e){return yV(e,n)})});for(var g=[],y=new Set,m=new Set,k=0;k<this.collectedLeaveElements.length;k++){var C=this.collectedLeaveElements[k],w=C[aV];w&&w.setForRemoval&&(g.push(C),y.add(C),w.hasAnimation?this.driver.query(C,".ng-star-inserted",!0).forEach(function(e){return y.add(e)}):m.add(C))}var _=new Map,E=pV(h,Array.from(y));E.forEach(function(e,t){var n=jF+p++;_.set(t,n),e.forEach(function(e){return yV(e,n)})}),e.push(function(){d.forEach(function(e,t){var n=v.get(t);e.forEach(function(e){return mV(e,n)})}),E.forEach(function(e,t){var n=_.get(t);e.forEach(function(e){return mV(e,n)})}),g.forEach(function(e){n.processLeaveNode(e)})});for(var b=[],P=[],S=this._namespaceList.length-1;S>=0;S--)this._namespaceList[S].drainQueuedTransitions(t).forEach(function(e){var t=e.player,a=e.element;if(b.push(t),n.collectedEnterElements.length){var l=a[aV];if(l&&l.setForMove)return void t.destroy()}var h=!f||!n.driver.containsElement(f,a),d=_.get(a),p=v.get(a),g=n._buildInstruction(e,r,p,d,h);if(g.errors&&g.errors.length)P.push(g);else{if(h)return t.onStart(function(){return sU(a,g.fromStyles)}),t.onDestroy(function(){return oU(a,g.toStyles)}),void i.push(t);if(e.isFallbackTransition)return t.onStart(function(){return sU(a,g.fromStyles)}),t.onDestroy(function(){return oU(a,g.toStyles)}),void i.push(t);g.timelines.forEach(function(e){return e.stretchStartingKeyframe=!0}),r.append(a,g.timelines),o.push({instruction:g,player:t,element:a}),g.queriedElements.forEach(function(e){return MF(s,e,[]).push(t)}),g.preStyleProps.forEach(function(e,t){var n=Object.keys(e);if(n.length){var r=u.get(t);r||u.set(t,r=new Set),n.forEach(function(e){return r.add(e)})}}),g.postStyleProps.forEach(function(e,t){var n=Object.keys(e),r=c.get(t);r||c.set(t,r=new Set),n.forEach(function(e){return r.add(e)})})}});if(P.length){var O=[];P.forEach(function(e){O.push("@".concat(e.triggerName," has failed due to:\n")),e.errors.forEach(function(e){return O.push("- ".concat(e,"\n"))})}),b.forEach(function(e){return e.destroy()}),this.reportError(O)}var T=new Map,I=new Map;o.forEach(function(e){var t=e.element;r.has(t)&&(I.set(t,t),n._beforeAnimationBuild(e.player.namespaceId,e.instruction,T))}),i.forEach(function(e){var t=e.element;n._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach(function(e){MF(T,t,[]).push(e),e.destroy()})});var A=g.filter(function(e){return wV(e,u,c)}),R=new Map;vV(R,this.driver,m,c,kF).forEach(function(e){wV(e,u,c)&&A.push(e)});var M=new Map;d.forEach(function(e,t){vV(M,n.driver,new Set(e),u,"!")}),A.forEach(function(e){var t=R.get(e),n=M.get(e);R.set(e,Object.assign(Object.assign({},t),n))});var x=[],N=[],D={};o.forEach(function(e){var t=e.element,o=e.player,s=e.instruction;if(r.has(t)){if(l.has(t))return o.onDestroy(function(){return oU(t,s.toStyles)}),o.disabled=!0,o.overrideTotalTime(s.totalTime),void i.push(o);var u=D;if(I.size>1){for(var c=t,f=[];c=c.parentNode;){var h=I.get(c);if(h){u=h;break}f.push(c)}f.forEach(function(e){return I.set(e,u)})}var d=n._buildAnimation(o.namespaceId,s,T,a,M,R);if(o.setRealPlayer(d),u===D)x.push(o);else{var v=n.playersByElement.get(u);v&&v.length&&(o.parentPlayer=OF(v)),i.push(o)}}else sU(t,s.fromStyles),o.onDestroy(function(){return oU(t,s.toStyles)}),N.push(o),l.has(t)&&i.push(o)}),N.forEach(function(e){var t=a.get(e.element);if(t&&t.length){var n=OF(t);e.setRealPlayer(n)}}),i.forEach(function(e){e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()});for(var L=0;L<g.length;L++){var F=g[L],U=F[aV];if(mV(F,jF),!U||!U.hasAnimation){var V=[];if(s.size){var B=s.get(F);B&&B.length&&V.push.apply(V,Bg(B));for(var z=this.driver.query(F,XF,!0),H=0;H<z.length;H++){var G=s.get(z[H]);G&&G.length&&V.push.apply(V,Bg(G))}}var $=V.filter(function(e){return!e.destroyed});$.length?kV(this,F,$):this.processLeaveNode(F)}}return g.length=0,x.forEach(function(e){n.players.push(e),e.onDone(function(){e.destroy();var t=n.players.indexOf(e);n.players.splice(t,1)}),e.play()}),x}},{key:"elementContainsData",value:function(e,t){var n=!1,r=t[aV];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}},{key:"afterFlush",value:function(e){this._flushFns.push(e)}},{key:"afterFlushAnimationsDone",value:function(e){this._whenQuietFns.push(e)}},{key:"_getPreviousPlayers",value:function(e,t,n,r,i){var a=[];if(t){var o=this.playersByQueriedElement.get(e);o&&(a=o)}else{var s=this.playersByElement.get(e);if(s){var u=!i||i==sV;s.forEach(function(e){e.queued||!u&&e.triggerName!=r||a.push(e)})}}return(n||r)&&(a=a.filter(function(e){return!(n&&n!=e.namespaceId||r&&r!=e.triggerName)})),a}},{key:"_beforeAnimationBuild",value:function(e,t,n){var r,i=this,a=t.element,o=t.isRemovalTransition?void 0:e,s=t.isRemovalTransition?void 0:t.triggerName,u=Hg(t.timelines);try{var c=function(){var e=r.value.element,u=e!==a,c=MF(n,e,[]);i._getPreviousPlayers(e,u,o,s,t.toState).forEach(function(e){var t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),c.push(e)})};for(u.s();!(r=u.n()).done;)c()}catch(l){u.e(l)}finally{u.f()}sU(a,t.fromStyles)}},{key:"_buildAnimation",value:function(e,t,n,r,i,a){var o=this,s=t.triggerName,u=t.element,c=[],l=new Set,f=new Set,h=t.timelines.map(function(t){var h=t.element;l.add(h);var d=h[aV];if(d&&d.removedBeforeQueried)return new EF(t.duration,t.delay);var v=h!==u,p=function(e){var t=[];return CV(e,t),t}((n.get(h)||nV).map(function(e){return e.getRealPlayer()})).filter(function(e){return!!e.element&&e.element===h}),g=i.get(h),y=a.get(h),m=TF(0,o._normalizer,0,t.keyframes,g,y),k=o._buildPlayer(t,m,p);if(t.subTimeline&&r&&f.add(h),v){var C=new fV(e,s,h);C.setRealPlayer(k),c.push(C)}return k});c.forEach(function(e){MF(o.playersByQueriedElement,e.element,[]).push(e),e.onDone(function(){return function(e,t,n){var r;if(e instanceof Map){if(r=e.get(t)){if(r.length){var i=r.indexOf(n);r.splice(i,1)}0==r.length&&e.delete(t)}}else if(r=e[t]){if(r.length){var a=r.indexOf(n);r.splice(a,1)}0==r.length&&delete e[t]}return r}(o.playersByQueriedElement,e.element,e)})}),l.forEach(function(e){return yV(e,QF)});var d=OF(h);return d.onDestroy(function(){l.forEach(function(e){return mV(e,QF)}),oU(u,t.toStyles)}),f.forEach(function(e){MF(r,e,[]).push(d)}),d}},{key:"_buildPlayer",value:function(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new EF(e.duration,e.delay)}}]),e}(),fV=function(){function e(t,n,r){Zg(this,e),this.namespaceId=t,this.triggerName=n,this.element=r,this._player=new EF,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}return Wg(e,[{key:"setRealPlayer",value:function(e){var t=this;this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(function(n){t._queuedCallbacks[n].forEach(function(t){return IF(e,n,void 0,t)})}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}},{key:"getRealPlayer",value:function(){return this._player}},{key:"overrideTotalTime",value:function(e){this.totalTime=e}},{key:"syncPlayerEvents",value:function(e){var t=this,n=this._player;n.triggerCallback&&e.onStart(function(){return n.triggerCallback("start")}),e.onDone(function(){return t.finish()}),e.onDestroy(function(){return t.destroy()})}},{key:"_queueEvent",value:function(e,t){MF(this._queuedCallbacks,e,[]).push(t)}},{key:"onDone",value:function(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}},{key:"onStart",value:function(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}},{key:"onDestroy",value:function(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}},{key:"init",value:function(){this._player.init()}},{key:"hasStarted",value:function(){return!this.queued&&this._player.hasStarted()}},{key:"play",value:function(){!this.queued&&this._player.play()}},{key:"pause",value:function(){!this.queued&&this._player.pause()}},{key:"restart",value:function(){!this.queued&&this._player.restart()}},{key:"finish",value:function(){this._player.finish()}},{key:"destroy",value:function(){this.destroyed=!0,this._player.destroy()}},{key:"reset",value:function(){!this.queued&&this._player.reset()}},{key:"setPosition",value:function(e){this.queued||this._player.setPosition(e)}},{key:"getPosition",value:function(){return this.queued?0:this._player.getPosition()}},{key:"triggerCallback",value:function(e){var t=this._player;t.triggerCallback&&t.triggerCallback(e)}}]),e}();function hV(e){return e&&1===e.nodeType}function dV(e,t){var n=e.style.display;return e.style.display=null!=t?t:"none",n}function vV(e,t,n,r,i){var a=[];n.forEach(function(e){return a.push(dV(e))});var o=[];r.forEach(function(n,r){var a={};n.forEach(function(e){var n=a[e]=t.computeStyle(r,e,i);(!n||0==n.length)&&(r[aV]=iV,o.push(r))}),e.set(r,a)});var s=0;return n.forEach(function(e){return dV(e,a[s++])}),o}function pV(e,t){var n=new Map;if(e.forEach(function(e){return n.set(e,[])}),0==t.length)return n;var r=new Set(t),i=new Map;function a(e){if(!e)return 1;var t=i.get(e);if(t)return t;var o=e.parentNode;return t=n.has(o)?o:r.has(o)?1:a(o),i.set(e,t),t}return t.forEach(function(e){var t=a(e);1!==t&&n.get(t).push(e)}),n}var gV="$$classes";function yV(e,t){if(e.classList)e.classList.add(t);else{var n=e[gV];n||(n=e[gV]={}),n[t]=!0}}function mV(e,t){if(e.classList)e.classList.remove(t);else{var n=e[gV];n&&delete n[t]}}function kV(e,t,n){OF(n).onDone(function(){return e.processLeaveNode(t)})}function CV(e,t){for(var n=0;n<e.length;n++){var r=e[n];r instanceof bF?CV(r.players,t):t.push(r)}}function wV(e,t,n){var r=n.get(e);if(!r)return!1;var i=t.get(e);return i?r.forEach(function(e){return i.add(e)}):t.set(e,r),n.delete(e),!0}var _V=function(){function e(t,n,r){var i=this;Zg(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=function(e,t){},this._transitionEngine=new lV(t,n,r),this._timelineEngine=new XU(t,n,r),this._transitionEngine.onRemovalComplete=function(e,t){return i.onRemovalComplete(e,t)}}return Wg(e,[{key:"registerTrigger",value:function(e,t,n,r,i){var a=e+"-"+r,o=this._triggerCache[a];if(!o){var s=[],u=PU(this._driver,i,s);if(s.length)throw new Error('The animation trigger "'.concat(r,'" has failed to build due to the following errors:\n - ').concat(s.join("\n - ")));o=function(e,t,n){return new YU(e,t,n)}(r,u,this._normalizer),this._triggerCache[a]=o}this._transitionEngine.registerTrigger(t,r,o)}},{key:"register",value:function(e,t){this._transitionEngine.register(e,t)}},{key:"destroy",value:function(e,t){this._transitionEngine.destroy(e,t)}},{key:"onInsert",value:function(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}},{key:"onRemove",value:function(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}},{key:"disableAnimations",value:function(e,t){this._transitionEngine.markElementAsDisabled(e,t)}},{key:"process",value:function(e,t,n,r){if("@"==n.charAt(0)){var i=Sg(xF(n),2),a=i[0],o=i[1];this._timelineEngine.command(a,t,o,r)}else this._transitionEngine.trigger(e,t,n,r)}},{key:"listen",value:function(e,t,n,r,i){if("@"==n.charAt(0)){var a=Sg(xF(n),2),o=a[0],s=a[1];return this._timelineEngine.listen(o,t,s,i)}return this._transitionEngine.listen(e,t,n,r,i)}},{key:"flush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._transitionEngine.flush(e)}},{key:"players",get:function(){return this._transitionEngine.players.concat(this._timelineEngine.players)}},{key:"whenRenderingDone",value:function(){return this._transitionEngine.whenRenderingDone()}}]),e}();function EV(e,t){var n=null,r=null;return Array.isArray(t)&&t.length?(n=PV(t[0]),t.length>1&&(r=PV(t[t.length-1]))):t&&(n=PV(t)),n||r?new bV(e,n,r):null}var bV=function(){var e=function(){function e(t,n,r){Zg(this,e),this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;var i=e.initialStylesByElement.get(t);i||e.initialStylesByElement.set(t,i={}),this._initialStyles=i}return Wg(e,[{key:"start",value:function(){this._state<1&&(this._startStyles&&oU(this._element,this._startStyles,this._initialStyles),this._state=1)}},{key:"finish",value:function(){this.start(),this._state<2&&(oU(this._element,this._initialStyles),this._endStyles&&(oU(this._element,this._endStyles),this._endStyles=null),this._state=1)}},{key:"destroy",value:function(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(sU(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(sU(this._element,this._endStyles),this._endStyles=null),oU(this._element,this._initialStyles),this._state=3)}}]),e}();return e.initialStylesByElement=new WeakMap,e}();function PV(e){for(var t=null,n=Object.keys(e),r=0;r<n.length;r++){var i=n[r];SV(i)&&((t=t||{})[i]=e[i])}return t}function SV(e){return"display"===e||"position"===e}var OV="animation",TV="animationend",IV=function(){function e(t,n,r,i,a,o,s){var u=this;Zg(this,e),this._element=t,this._name=n,this._duration=r,this._delay=i,this._easing=a,this._fillMode=o,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=function(e){return u._handleCallback(e)}}return Wg(e,[{key:"apply",value:function(){(function(e,t){var n=DV(e,"").trim();n.length&&(function(e,t){for(var n=0,r=0;r<e.length;r++)","===e.charAt(r)&&n++}(n),t="".concat(n,", ").concat(t)),NV(e,"",t)})(this._element,"".concat(this._duration,"ms ").concat(this._easing," ").concat(this._delay,"ms 1 normal ").concat(this._fillMode," ").concat(this._name)),xV(this._element,this._eventFn,!1),this._startTime=Date.now()}},{key:"pause",value:function(){AV(this._element,this._name,"paused")}},{key:"resume",value:function(){AV(this._element,this._name,"running")}},{key:"setPosition",value:function(e){var t=RV(this._element,this._name);this._position=e*this._duration,NV(this._element,"Delay","-".concat(this._position,"ms"),t)}},{key:"getPosition",value:function(){return this._position}},{key:"_handleCallback",value:function(e){var t=e._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}},{key:"finish",value:function(){this._finished||(this._finished=!0,this._onDoneFn(),xV(this._element,this._eventFn,!0))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.finish(),function(e,t){var n=DV(e,"").split(","),r=MV(n,t);r>=0&&(n.splice(r,1),NV(e,"",n.join(",")))}(this._element,this._name))}}]),e}();function AV(e,t,n){NV(e,"PlayState",n,RV(e,t))}function RV(e,t){var n=DV(e,"");return n.indexOf(",")>0?MV(n.split(","),t):MV([n],t)}function MV(e,t){for(var n=0;n<e.length;n++)if(e[n].indexOf(t)>=0)return n;return-1}function xV(e,t,n){n?e.removeEventListener(TV,t):e.addEventListener(TV,t)}function NV(e,t,n,r){var i=OV+t;if(null!=r){var a=e.style[i];if(a.length){var o=a.split(",");o[r]=n,n=o.join(",")}}e.style[i]=n}function DV(e,t){return e.style[OV+t]||""}var LV=function(){function e(t,n,r,i,a,o,s,u){Zg(this,e),this.element=t,this.keyframes=n,this.animationName=r,this._duration=i,this._delay=a,this._finalStyles=s,this._specialStyles=u,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this.currentSnapshot={},this._state=0,this.easing=o||"linear",this.totalTime=i+a,this._buildStyler()}return Wg(e,[{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"destroy",value:function(){this.init(),!(this._state>=4)&&(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"_flushDoneFns",value:function(){this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[]}},{key:"_flushStartFns",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"finish",value:function(){this.init(),!(this._state>=3)&&(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}},{key:"setPosition",value:function(e){this._styler.setPosition(e)}},{key:"getPosition",value:function(){return this._styler.getPosition()}},{key:"hasStarted",value:function(){return this._state>=2}},{key:"init",value:function(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}},{key:"play",value:function(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}},{key:"pause",value:function(){this.init(),this._styler.pause()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"reset",value:function(){this._state=0,this._styler.destroy(),this._buildStyler(),this._styler.apply()}},{key:"_buildStyler",value:function(){var e=this;this._styler=new IV(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",function(){return e.finish()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}},{key:"beforeDestroy",value:function(){var e=this;this.init();var t={};if(this.hasStarted()){var n=this._state>=3;Object.keys(this._finalStyles).forEach(function(r){"offset"!=r&&(t[r]=n?e._finalStyles[r]:kU(e.element,r))})}this.currentSnapshot=t}}]),e}(),FV=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).element=e,i._startingStyles={},i.__initialized=!1,i._styles=$F(r),i}return Wg(n,[{key:"init",value:function(){var e=this;this.__initialized||!this._startingStyles||(this.__initialized=!0,Object.keys(this._styles).forEach(function(t){e._startingStyles[t]=e.element.style[t]}),Rg(Vg(n.prototype),"init",this).call(this))}},{key:"play",value:function(){var e=this;!this._startingStyles||(this.init(),Object.keys(this._styles).forEach(function(t){return e.element.style.setProperty(t,e._styles[t])}),Rg(Vg(n.prototype),"play",this).call(this))}},{key:"destroy",value:function(){var e=this;!this._startingStyles||(Object.keys(this._startingStyles).forEach(function(t){var n=e._startingStyles[t];n?e.element.style.setProperty(t,n):e.element.style.removeProperty(t)}),this._startingStyles=null,Rg(Vg(n.prototype),"destroy",this).call(this))}}]),n}(EF),UV=function(){function e(){Zg(this,e),this._count=0}return Wg(e,[{key:"validateStyleProperty",value:function(e){return BF(e)}},{key:"matchesElement",value:function(e,t){return zF(e,t)}},{key:"containsElement",value:function(e,t){return HF(e,t)}},{key:"query",value:function(e,t,n){return GF(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"buildKeyframeElement",value:function(e,t,n){n=n.map(function(e){return $F(e)});var r="@keyframes ".concat(t," {\n"),i="";n.forEach(function(e){i=" ";var t=parseFloat(e.offset);r+="".concat(i).concat(100*t,"% {\n"),i+=" ",Object.keys(e).forEach(function(t){var n=e[t];switch(t){case"offset":return;case"easing":return void(n&&(r+="".concat(i,"animation-timing-function: ").concat(n,";\n")));default:return void(r+="".concat(i).concat(t,": ").concat(n,";\n"))}}),r+="".concat(i,"}\n")}),r+="}\n";var a=document.createElement("style");return a.textContent=r,a}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=a.filter(function(e){return e instanceof LV}),s={};gU(n,r)&&o.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return s[e]=t[e]})});var u=function(e){var t={};return e&&(Array.isArray(e)?e:[e]).forEach(function(e){Object.keys(e).forEach(function(n){"offset"==n||"easing"==n||(t[n]=e[n])})}),t}(t=yU(e,t,s));if(0==n)return new FV(e,u);var c="gen_css_kf_"+this._count++,l=this.buildKeyframeElement(e,c,t);(function(e){var t,n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e);return"undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot?n:document.head})(e).appendChild(l);var f=EV(e,t),h=new LV(e,t,c,n,r,i,u,f);return h.onDestroy(function(){var e;(e=l).parentNode.removeChild(e)}),h}}]),e}(),VV=function(){function e(t,n,r,i){Zg(this,e),this.element=t,this.keyframes=n,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}return Wg(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this._buildPlayer(),this._preparePlayerBeforeStart()}},{key:"_buildPlayer",value:function(){var e=this;if(!this._initialized){this._initialized=!0;var t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",function(){return e._onFinish()})}}},{key:"_preparePlayerBeforeStart",value:function(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}},{key:"_triggerWebAnimation",value:function(e,t,n){return e.animate(t,n)}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"play",value:function(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}},{key:"pause",value:function(){this.init(),this.domPlayer.pause()}},{key:"finish",value:function(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}},{key:"reset",value:function(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"_resetDomPlayerState",value:function(){this.domPlayer&&this.domPlayer.cancel()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"hasStarted",value:function(){return this._started}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"setPosition",value:function(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}},{key:"getPosition",value:function(){return this.domPlayer.currentTime/this.time}},{key:"totalTime",get:function(){return this._delay+this._duration}},{key:"beforeDestroy",value:function(){var e=this,t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(function(n){"offset"!=n&&(t[n]=e._finished?e._finalKeyframe[n]:kU(e.element,n))}),this.currentSnapshot=t}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),BV=function(){function e(){Zg(this,e),this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(zV().toString()),this._cssKeyframesDriver=new UV}return Wg(e,[{key:"validateStyleProperty",value:function(e){return BF(e)}},{key:"matchesElement",value:function(e,t){return zF(e,t)}},{key:"containsElement",value:function(e,t){return HF(e,t)}},{key:"query",value:function(e,t,n){return GF(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"overrideWebAnimationsSupport",value:function(e){this._isNativeImpl=e}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=arguments.length>6?arguments[6]:void 0;if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,n,r,i,a);var s={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(s.easing=i);var u={},c=a.filter(function(e){return e instanceof VV});gU(n,r)&&c.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return u[e]=t[e]})});var l=EV(e,t=yU(e,t=t.map(function(e){return rU(e,!1)}),u));return new VV(e,t,s,l)}}]),e}();function zV(){return PF()&&Element.prototype.animate||{}}var HV=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this))._nextAnimationId=0,i._renderer=e.createRenderer(r.body,{id:"0",encapsulation:Tm.None,styles:[],data:{animation:[]}}),i}return Wg(n,[{key:"build",value:function(e){var t=this._nextAnimationId.toString();this._nextAnimationId++;var n=Array.isArray(e)?CF(e):e;return ZV(this._renderer,null,t,"register",[n]),new GV(t,this._renderer)}}]),n}(mF);return e.\u0275fac=function(t){return new(t||e)(pw(lO),pw(RI))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),GV=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this))._id=e,i._renderer=r,i}return Wg(n,[{key:"create",value:function(e,t){return new $V(this._id,e,t||{},this._renderer)}}]),n}(function(){return Wg(function e(){Zg(this,e)})}()),$V=function(){function e(t,n,r,i){Zg(this,e),this.id=t,this.element=n,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}return Wg(e,[{key:"_listen",value:function(e,t){return this._renderer.listen(this.element,"@@".concat(this.id,":").concat(e),t)}},{key:"_command",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return ZV(this._renderer,this.element,this.id,e,n)}},{key:"onDone",value:function(e){this._listen("done",e)}},{key:"onStart",value:function(e){this._listen("start",e)}},{key:"onDestroy",value:function(e){this._listen("destroy",e)}},{key:"init",value:function(){this._command("init")}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this._command("play"),this._started=!0}},{key:"pause",value:function(){this._command("pause")}},{key:"restart",value:function(){this._command("restart")}},{key:"finish",value:function(){this._command("finish")}},{key:"destroy",value:function(){this._command("destroy")}},{key:"reset",value:function(){this._command("reset"),this._started=!1}},{key:"setPosition",value:function(e){this._command("setPosition",e)}},{key:"getPosition",value:function(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}]),e}();function ZV(e,t,n,r,i){return e.setProperty(t,"@@".concat(n,":").concat(r),i)}var qV="@.disabled",WV=function(){var e=function(){function e(t,n,r){Zg(this,e),this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=function(e,t){t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}return Wg(e,[{key:"createRenderer",value:function(e,t){var n=this,r=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){var i=this._rendererCache.get(r);return i||(i=new jV("",r,this.engine),this._rendererCache.set(r,i)),i}var a=t.id,o=t.id+"-"+this._currentId;this._currentId++,this.engine.register(o,e);return t.data.animation.forEach(function t(r){Array.isArray(r)?r.forEach(t):n.engine.registerTrigger(a,o,e,r.name,r)}),new YV(this,o,r,this.engine)}},{key:"begin",value:function(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}},{key:"_scheduleCountTask",value:function(){var e=this;this.promise.then(function(){e._microtaskId++})}},{key:"scheduleListenerCallback",value:function(e,t,n){var r=this;e>=0&&e<this._microtaskId?this._zone.run(function(){return t(n)}):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(function(){r._zone.run(function(){r._animationCallbacksBuffer.forEach(function(e){var t=Sg(e,2);(0,t[0])(t[1])}),r._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([t,n]))}},{key:"end",value:function(){var e=this;this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(function(){e._scheduleCountTask(),e.engine.flush(e._microtaskId)}),this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.engine.whenRenderingDone()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(lO),pw(_V),pw(eI))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),jV=function(){function e(t,n,r){Zg(this,e),this.namespaceId=t,this.delegate=n,this.engine=r,this.destroyNode=this.delegate.destroyNode?function(e){return n.destroyNode(e)}:null}return Wg(e,[{key:"data",get:function(){return this.delegate.data}},{key:"destroy",value:function(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}},{key:"createElement",value:function(e,t){return this.delegate.createElement(e,t)}},{key:"createComment",value:function(e){return this.delegate.createComment(e)}},{key:"createText",value:function(e){return this.delegate.createText(e)}},{key:"appendChild",value:function(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}},{key:"insertBefore",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}},{key:"removeChild",value:function(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}},{key:"selectRootElement",value:function(e,t){return this.delegate.selectRootElement(e,t)}},{key:"parentNode",value:function(e){return this.delegate.parentNode(e)}},{key:"nextSibling",value:function(e){return this.delegate.nextSibling(e)}},{key:"setAttribute",value:function(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}},{key:"removeAttribute",value:function(e,t,n){this.delegate.removeAttribute(e,t,n)}},{key:"addClass",value:function(e,t){this.delegate.addClass(e,t)}},{key:"removeClass",value:function(e,t){this.delegate.removeClass(e,t)}},{key:"setStyle",value:function(e,t,n,r){this.delegate.setStyle(e,t,n,r)}},{key:"removeStyle",value:function(e,t,n){this.delegate.removeStyle(e,t,n)}},{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)&&t==qV?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}},{key:"setValue",value:function(e,t){this.delegate.setValue(e,t)}},{key:"listen",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"disableAnimations",value:function(e,t){this.engine.disableAnimations(e,t)}}]),e}(),YV=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,r,i,a)).factory=e,o.namespaceId=r,o}return Wg(n,[{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==qV?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}},{key:"listen",value:function(e,t,n){var r=this;if("@"==t.charAt(0)){var i,a,o=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e),s=t.substr(1),u="";return"@"!=s.charAt(0)&&(i=function(e){var t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(s),s=(a=Sg(i,2))[0],u=a[1]),this.engine.listen(this.namespaceId,o,s,u,function(e){r.factory.scheduleListenerCallback(e._data||-1,n,e)})}return this.delegate.listen(e,t,n)}}]),n}(jV),KV=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){return Zg(this,n),t.call(this,e.body,r,i)}return Wg(n,[{key:"ngOnDestroy",value:function(){this.flush()}}]),n}(_V);return e.\u0275fac=function(t){return new(t||e)(pw(RI),pw(qF),pw(HU))},e.\u0275prov=dm({token:e,factory:e.\u0275fac}),e}(),QV=new YC("AnimationModuleType"),XV=[{provide:mF,useClass:HV},{provide:HU,useFactory:function(){return new GU}},{provide:_V,useClass:KV},{provide:lO,useFactory:function(e,t,n){return new WV(e,t,n)},deps:[lR,_V,eI]}],JV=[{provide:qF,useFactory:function(){return"function"==typeof zV()?new BV:new UV}},{provide:QV,useValue:"BrowserAnimations"}].concat(XV),eB=[{provide:qF,useClass:ZF},{provide:QV,useValue:"NoopAnimations"}].concat(XV),tB=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:t.disableAnimations?eB:JV}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({providers:JV,imports:[PR]}),e}(),nB=Tg(9575),rB=Tg.n(nB);function iB(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function aB(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){iB(a,r,i,o,s,"next",e)}function s(e){iB(a,r,i,o,s,"throw",e)}o(void 0)})}}var oB=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"expectToBe",value:function(e,t,n){if(e!==t)throw void 0!==n?new Error(n):new Error("A default switch case did not observe the correct value, expected ".concat(t,", but got ").concat(e," instead."))}},{key:"expectToBeMultiple",value:function(e,t){var n,r=!1,i=Hg(t);try{for(i.s();!(n=i.n()).done;){if(e===n.value){r=!0;break}}}catch(a){i.e(a)}finally{i.f()}if(!1===r)throw new Error("A default switch case did not observe the correct value, expected a value among ".concat(t,", but got ").concat(e," instead."))}},{key:"getNonNullable",value:function(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}}]),e}();function sB(e,t){e&&console.log(t)}function uB(e,t){if(null!=e&&null!=t&&"object"==typeof e){if(null!=e.equals)return e.equals(t);for(var n=e,r=t,i=0,a=Object.keys(n);i<a.length;i++){var o=a[i];if(!(o in r))return!1;if(!1===uB(n[o],r[o]))return!1}return!0}return e===t}function cB(e){return null==e||function(e){return"object"==typeof e&&null!=e&&null!=e.equals}(e)||function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e}(e)||function(e){if("object"==typeof e){for(var t in e)if(null!=e[t]&&!1===cB(e[t]))return!1;return null!=e&&e.constructor.prototype===Object.prototype}return!1}(e)}function lB(e,t){if(cB(e)&&cB(t))return uB(e,t);throw new Error("Comparing non comparable objects: ".concat(e.constructor.name," and ").concat(t.constructor.name))}var fB=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,[{key:"isPresent",value:function(){return null!=this.value}},{key:"isAbsent",value:function(){return null==this.value}},{key:"get",value:function(){if(this.isPresent())return this.value;throw new Error("Value is absent")}},{key:"getOrElse",value:function(e){return this.isPresent()?this.value:e}},{key:"equals",value:function(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&lB(this.value,e.value)}},{key:"equalsValue",value:function(t){return this.equals(e.of(t))}},{key:"toString",value:function(){return this.isAbsent()?"MGPOptional.empty()":"MGPOptional.of(".concat(this.value,")")}},{key:"map",value:function(t){return this.isPresent()?e.of(t(this.get())):e.empty()}}],[{key:"of",value:function(t){return new e(t)}},{key:"ofNullable",value:function(t){return null==t?e.empty():e.of(t)}},{key:"empty",value:function(){return new e(null)}}]),e}(),hB=function(){function e(){Zg(this,e)}return Wg(e,[{key:"equals",value:function(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&lB(this.get(),e.get())}}],[{key:"success",value:function(e){return new dB(e)}},{key:"failure",value:function(e){return new vB(e)}}]),e}(),dB=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).value=e,r}return Wg(n,[{key:"isSuccess",value:function(){return!0}},{key:"isFailure",value:function(){return!1}},{key:"get",value:function(){return this.value}},{key:"getReason",value:function(){throw new Error("Cannot get failure reason from a success")}},{key:"getReasonOr",value:function(e){return e}},{key:"toOptional",value:function(){return fB.of(this.value)}},{key:"toString",value:function(){return"MGPFallible.success(".concat(this.value,")")}}]),n}(hB),vB=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).reason=e,r}return Wg(n,[{key:"isSuccess",value:function(){return!1}},{key:"isFailure",value:function(){return!0}},{key:"get",value:function(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}},{key:"getReason",value:function(){return this.reason}},{key:"getReasonOr",value:function(e){return this.getReason()}},{key:"toOptional",value:function(){return fB.empty()}},{key:"toString",value:function(){return"MGPFallible.failure(".concat(this.reason,")")}}]),n}(hB),pB=function(){function e(t){Zg(this,e),this.reason=t}return Wg(e,[{key:"isFailure",value:function(){return!1===this.isSuccess()}},{key:"isSuccess",value:function(){return null==this.reason}},{key:"getReason",value:function(){if(this.isSuccess())throw new Error("MGPValidation: Cannot extract failure reason from success.");return this.reason}},{key:"toFallible",value:function(e){return this.isSuccess()?hB.success(e):hB.failure(this.getReason())}},{key:"toFailedFallible",value:function(){if(this.isSuccess())throw new Error("MGPValidation: cannot convert into failed fallible.");return hB.failure(this.getReason())}}],[{key:"ofFallible",value:function(t){return t.isSuccess()?e.SUCCESS:e.failure(t.getReason())}},{key:"failure",value:function(t){return new e(t)}}]),e}();pB.SUCCESS=new pB(null);var gB=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},yB={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,s=o?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=(15&s)<<2|c>>6,f=63&c;u||(f=64,o||(l=64)),r.push(n[a>>2],n[(3&a)<<4|s>>4],n[l],n[f])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(gB(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==s||null==u)throw Error();r.push(a<<2|o>>4),64!==s&&(r.push(o<<4&240|s>>2),64!==u&&r.push(s<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},mB=function(e){return function(e){var t=gB(e);return yB.encodeByteArray(t,!0)}(e).replace(/\./g,"")},kB=function(){function e(){var t=this;Zg(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return Wg(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch(function(){}),1===e.length?e(n):e(n,r))}}}]),e}();function CB(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function wB(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(CB())}function _B(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function EB(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function bB(){var e=CB();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function PB(){return"object"==typeof indexedDB}function SB(){return new Promise(function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}function OB(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}var TB=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,r)).code=e,a.customData=i,a.name="FirebaseError",Object.setPrototypeOf(Fg(a),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(Fg(a),IB.prototype.create),a}return Wg(n)}(Ig(Error)),IB=function(){function e(t,n,r){Zg(this,e),this.service=t,this.serviceName=n,this.errors=r}return Wg(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(AB,function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error";return new TB(n,"".concat(this.serviceName,": ").concat(i," (").concat(n,")."),t)}}]),e}(),AB=/\{\$([^}]+)}/g;function RB(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),i=0,a=n;i<a.length;i++){var o=a[i];if(!r.includes(o))return!1;var s=e[o],u=t[o];if(MB(s)&&MB(u)){if(!RB(s,u))return!1}else if(s!==u)return!1}for(var c=0,l=r;c<l.length;c++){var f=l[c];if(!n.includes(f))return!1}return!0}function MB(e){return null!==e&&"object"==typeof e}function xB(e){for(var t=[],n=function(){var e=Sg(i[r],2),n=e[0],a=e[1];Array.isArray(a)?a.forEach(function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))},r=0,i=Object.entries(e);r<i.length;r++)n();return t.length?"&"+t.join("&"):""}function NB(e){var t={};return e.replace(/^\?/,"").split("&").forEach(function(e){if(e){var n=Sg(e.split("="),2),r=n[0],i=n[1];t[decodeURIComponent(r)]=decodeURIComponent(i)}}),t}function DB(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}var LB=function(){function e(t,n){var r=this;Zg(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(function(){t(r)}).catch(function(e){r.error(e)})}return Wg(e,[{key:"next",value:function(e){this.forEachObserver(function(t){t.next(e)})}},{key:"error",value:function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)}},{key:"complete",value:function(){this.forEachObserver(function(e){e.complete()}),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=FB),void 0===r.error&&(r.error=FB),void 0===r.complete&&(r.complete=FB);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))}}]),e}();function FB(){}function UB(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}function VB(e){return e&&e._delegate?e._delegate:e}var BB,zB,HB=function(){function e(t,n,r){Zg(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return Wg(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),GB="[DEFAULT]",$B=function(){function e(t,n){Zg(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return Wg(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new kB;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:GB})}catch(u){}var t,n=Hg(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=Sg(t.value,2),i=r[0],a=r[1],o=this.normalizeInstanceIdentifier(i);try{var s=this.getOrInitializeService({instanceIdentifier:o});a.resolve(s)}catch(c){}}}catch(l){n.e(l)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:GB;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Array.from(e.instances.values()),t.next=3,Promise.all([].concat(Bg(n.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()})),Bg(n.filter(function(e){return"_delete"in e}).map(function(e){return e._delete()}))));case 3:case"end":return t.stop()}},t)}))()}},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:GB;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:GB;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i,a=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=Hg(this.instancesDeferred.entries());try{for(o.s();!(i=o.n()).done;){var s=Sg(i.value,2),u=s[0],c=s[1];r===this.normalizeInstanceIdentifier(u)&&c.resolve(a)}}catch(l){o.e(l)}finally{o.f()}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,i=Hg(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;try{a(e,t)}catch(o){}}}catch(s){i.e(s)}finally{i.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===GB?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(o){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:GB;return this.component?this.component.multipleInstances?e:GB:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}(),ZB=function(){function e(t){Zg(this,e),this.name=t,this.providers=new Map}return Wg(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new $B(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),qB=[],WB=function(){return(e=WB||(WB={}))[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",WB;var e}(),jB={debug:WB.DEBUG,verbose:WB.VERBOSE,info:WB.INFO,warn:WB.WARN,error:WB.ERROR,silent:WB.SILENT},YB=WB.INFO,KB=(Pg(Mg={},WB.DEBUG,"log"),Pg(Mg,WB.VERBOSE,"log"),Pg(Mg,WB.INFO,"info"),Pg(Mg,WB.WARN,"warn"),Pg(Mg,WB.ERROR,"error"),Mg),QB=function(e,t){var n;if(!(t<e.logLevel)){var r=(new Date).toISOString(),i=KB[t];if(!i)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a=arguments.length,o=new Array(a>2?a-2:0),s=2;s<a;s++)o[s-2]=arguments[s];(n=console)[i].apply(n,["[".concat(r,"]  ").concat(e.name,":")].concat(o))}},XB=function(){function e(t){Zg(this,e),this.name=t,this._logLevel=YB,this._logHandler=QB,this._userLogHandler=null,qB.push(this)}return Wg(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in WB))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"==typeof e?jB[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,WB.DEBUG].concat(t)),this._logHandler.apply(this,[this,WB.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,WB.VERBOSE].concat(t)),this._logHandler.apply(this,[this,WB.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,WB.INFO].concat(t)),this._logHandler.apply(this,[this,WB.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,WB.WARN].concat(t)),this._logHandler.apply(this,[this,WB.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,WB.ERROR].concat(t)),this._logHandler.apply(this,[this,WB.ERROR].concat(t))}}]),e}(),JB=new WeakMap,ez=new WeakMap,tz=new WeakMap,nz=new WeakMap,rz=new WeakMap,iz={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return ez.get(e);if("objectStoreNames"===t)return e.objectStoreNames||tz.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return az(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function az(e){if(e instanceof IDBRequest)return function(e){var t=new Promise(function(t,n){var r=function(){e.removeEventListener("success",i),e.removeEventListener("error",a)},i=function(){t(az(e.result)),r()},a=function(){n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",a)});return t.then(function(t){t instanceof IDBCursor&&JB.set(t,e)}).catch(function(){}),rz.set(t,e),t}(e);if(nz.has(e))return nz.get(e);var t=function(e){return"function"==typeof e?function(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(zB||(zB=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(oz(this),n),az(JB.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return az(e.apply(oz(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=e.call.apply(e,[oz(this),t].concat(r));return tz.set(a,t.sort?t.sort():[t]),az(a)}}(e):(e instanceof IDBTransaction&&function(e){if(!ez.has(e)){var t=new Promise(function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=function(){t(),r()},a=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)});ez.set(e,t)}}(e),function(e,t){return t.some(function(t){return e instanceof t})}(e,BB||(BB=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,iz):e)}(e);return t!==e&&(nz.set(e,t),rz.set(t,e)),t}var oz=function(e){return rz.get(e)};function sz(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,a=n.blocking,o=n.terminated,s=indexedDB.open(e,t),u=az(s);return i&&s.addEventListener("upgradeneeded",function(e){i(az(s.result),e.oldVersion,e.newVersion,az(s.transaction))}),r&&s.addEventListener("blocked",function(){return r()}),u.then(function(e){o&&e.addEventListener("close",function(){return o()}),a&&e.addEventListener("versionchange",function(){return a()})}).catch(function(){}),u}function uz(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.blocked,r=indexedDB.deleteDatabase(e);return n&&r.addEventListener("blocked",function(){return n()}),az(r).then(function(){})}var cz,lz=["get","getKey","getAll","getAllKeys","count"],fz=["put","add","delete","clear"],hz=new Map;function dz(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t){if(hz.get(t))return hz.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,i=fz.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(i||lz.includes(n))){var a,o=(a=aB(regeneratorRuntime.mark(function e(t){var a,o,s,u,c,l,f=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o=this.transaction(t,i?"readwrite":"readonly"),s=o.store,u=f.length,c=new Array(u>1?u-1:0),l=1;l<u;l++)c[l-1]=f[l];return r&&(s=s.index(c.shift())),e.next=6,Promise.all([(a=s)[n].apply(a,c),i&&o.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)});return hz.set(t,o),o}}}iz=bg(bg({},cz=iz),{},{get:function(e,t,n){return dz(e,t)||cz.get(e,t,n)},has:function(e,t){return!!dz(e,t)||cz.has(e,t)}});var vz=function(){function e(t){Zg(this,e),this.container=t}return Wg(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map(function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(function(e){return e}).join(" ")}}]),e}(),pz="@firebase/app",gz=new XB("@firebase/app"),yz="[DEFAULT]",mz=(Pg(Ng={},pz,"fire-core"),Pg(Ng,"@firebase/app-compat","fire-core-compat"),Pg(Ng,"@firebase/analytics","fire-analytics"),Pg(Ng,"@firebase/analytics-compat","fire-analytics-compat"),Pg(Ng,"@firebase/app-check","fire-app-check"),Pg(Ng,"@firebase/app-check-compat","fire-app-check-compat"),Pg(Ng,"@firebase/auth","fire-auth"),Pg(Ng,"@firebase/auth-compat","fire-auth-compat"),Pg(Ng,"@firebase/database","fire-rtdb"),Pg(Ng,"@firebase/database-compat","fire-rtdb-compat"),Pg(Ng,"@firebase/functions","fire-fn"),Pg(Ng,"@firebase/functions-compat","fire-fn-compat"),Pg(Ng,"@firebase/installations","fire-iid"),Pg(Ng,"@firebase/installations-compat","fire-iid-compat"),Pg(Ng,"@firebase/messaging","fire-fcm"),Pg(Ng,"@firebase/messaging-compat","fire-fcm-compat"),Pg(Ng,"@firebase/performance","fire-perf"),Pg(Ng,"@firebase/performance-compat","fire-perf-compat"),Pg(Ng,"@firebase/remote-config","fire-rc"),Pg(Ng,"@firebase/remote-config-compat","fire-rc-compat"),Pg(Ng,"@firebase/storage","fire-gcs"),Pg(Ng,"@firebase/storage-compat","fire-gcs-compat"),Pg(Ng,"@firebase/firestore","fire-fst"),Pg(Ng,"@firebase/firestore-compat","fire-fst-compat"),Pg(Ng,"fire-js","fire-js"),Pg(Ng,"firebase","fire-js-all"),Ng),kz=new Map,Cz=new Map;function wz(e,t){try{e.container.addComponent(t)}catch(n){gz.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function _z(e){var t=e.name;if(Cz.has(t))return gz.debug("There were multiple attempts to register component ".concat(t,".")),!1;Cz.set(t,e);var n,r=Hg(kz.values());try{for(r.s();!(n=r.n()).done;){wz(n.value,e)}}catch(i){r.e(i)}finally{r.f()}return!0}function Ez(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}var bz=new IB("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."}),Pz=function(){function e(t,n,r){var i=this;Zg(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new HB("app",function(){return i},"PUBLIC"))}return Wg(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw bz.create("app-deleted",{appName:this._name})}}]),e}(),Sz="9.9.0";function Oz(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yz,t=kz.get(e);if(!t)throw bz.create("no-app",{appName:e});return t}function Tz(){return Array.from(kz.values())}function Iz(e,t,n){var r,i=null!==(r=mz[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var s=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&s.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&s.push("and"),o&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void gz.warn(s.join(" "))}_z(new HB("".concat(i,"-version"),function(){return{library:i,version:t}},"VERSION"))}var Az="firebase-heartbeat-store",Rz=null;function Mz(){return Rz||(Rz=sz("firebase-heartbeat-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(Az)}}).catch(function(e){throw bz.create("storage-open",{originalErrorMessage:e.message})})),Rz}function xz(){return xz=aB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Mz();case 3:return e.abrupt("return",e.sent.transaction(Az).objectStore(Az).get(Lz(t)));case 6:throw e.prev=6,e.t0=e.catch(0),bz.create("storage-get",{originalErrorMessage:null===(n=e.t0)||void 0===n?void 0:n.message});case 9:case"end":return e.stop()}},e,null,[[0,6]])})),xz.apply(this,arguments)}function Nz(e,t){return Dz.apply(this,arguments)}function Dz(){return Dz=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Mz();case 3:return i=e.sent.transaction(Az,"readwrite"),e.next=6,i.objectStore(Az).put(n,Lz(t));case 6:return e.abrupt("return",i.done);case 9:throw e.prev=9,e.t0=e.catch(0),bz.create("storage-set",{originalErrorMessage:null===(r=e.t0)||void 0===r?void 0:r.message});case 12:case"end":return e.stop()}},e,null,[[0,9]])})),Dz.apply(this,arguments)}function Lz(e){return"".concat(e.name,"!").concat(e.options.appId)}var Fz=function(){function e(t){var n=this;Zg(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new Vz(r),this._heartbeatsCachePromise=this._storage.read().then(function(e){return n._heartbeatsCache=e,e})}return Wg(e,[{key:"triggerHeartbeat",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Uz(),t.t0=null===e._heartbeatsCache,!t.t0){t.next=6;break}return t.next=5,e._heartbeatsCachePromise;case 5:e._heartbeatsCache=t.sent;case 6:if(e._heartbeatsCache.lastSentHeartbeatDate===r||e._heartbeatsCache.heartbeats.some(function(e){return e.date===r})){t.next=8;break}return t.abrupt("return",(e._heartbeatsCache.heartbeats.push({date:r,agent:n}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),e._storage.overwrite(e._heartbeatsCache)));case 8:case"end":return t.stop()}},t)}))()}},{key:"getHeartbeatsHeader",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null===e._heartbeatsCache,!t.t0){t.next=4;break}return t.next=4,e._heartbeatsCachePromise;case 4:if(null!==e._heartbeatsCache&&0!==e._heartbeatsCache.heartbeats.length){t.next=6;break}return t.abrupt("return","");case 6:if(n=Uz(),r=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=[],i=e.slice(),a=Hg(e);try{var o=function(){var e=t.value,a=r.find(function(t){return t.agent===e.agent});if(a){if(a.dates.push(e.date),Bz(r)>n)return a.dates.pop(),"break"}else if(r.push({agent:e.agent,dates:[e.date]}),Bz(r)>n)return r.pop(),"break";i=i.slice(1)};for(a.s();!(t=a.n()).done;){var s=o();if("break"===s)break}}catch(u){a.e(u)}finally{a.f()}return{heartbeatsToSend:r,unsentEntries:i}}(e._heartbeatsCache.heartbeats),i=r.heartbeatsToSend,a=r.unsentEntries,o=mB(JSON.stringify({version:2,heartbeats:i})),e._heartbeatsCache.lastSentHeartbeatDate=n,!(a.length>0)){t.next=14;break}return e._heartbeatsCache.heartbeats=a,t.next=12,e._storage.overwrite(e._heartbeatsCache);case 12:t.next=15;break;case 14:e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache);case 15:return t.abrupt("return",o);case 16:case"end":return t.stop()}},t)}))()}}]),e}();function Uz(){return(new Date).toISOString().substring(0,10)}var Vz=function(){function e(t){Zg(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return Wg(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){return aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!!PB()&&SB().then(function(){return!0}).catch(function(){return!1}));case 1:case"end":return e.stop()}},e)}))()}},{key:"read",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._canUseIndexedDBPromise;case 2:if(t.t1=t.sent,!t.t1){t.next=7;break}return t.next=6,function(e){return xz.apply(this,arguments)}(e.app);case 6:t.t1=t.sent;case 7:if(t.t0=t.t1,t.t0){t.next=10;break}t.t0={heartbeats:[]};case 10:return t.abrupt("return",t.t0);case 11:case"end":return t.stop()}},t)}))()}},{key:"overwrite",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._canUseIndexedDBPromise;case 2:if(!n.sent){n.next=7;break}return n.next=5,t.read();case 5:return i=n.sent,n.abrupt("return",Nz(t.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats}));case 7:case"end":return n.stop()}},n)}))()}},{key:"add",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._canUseIndexedDBPromise;case 2:if(!n.sent){n.next=7;break}return n.next=5,t.read();case 5:return i=n.sent,n.abrupt("return",Nz(t.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:[].concat(Bg(i.heartbeats),Bg(e.heartbeats))}));case 7:case"end":return n.stop()}},n)}))()}}]),e}();function Bz(e){return mB(JSON.stringify({version:2,heartbeats:e})).length}_z(new HB("platform-logger",function(e){return new vz(e)},"PRIVATE")),_z(new HB("heartbeat",function(e){return new Fz(e)},"PRIVATE")),Iz(pz,"0.7.28",""),Iz(pz,"0.7.28","esm2017"),Iz("fire-js","");var zz,Hz="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Gz={},$z=$z||{},Zz=Hz||self;function qz(){}function Wz(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function jz(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var Yz="closure_uid_"+(1e9*Math.random()>>>0),Kz=0;function Qz(e,t,n){return e.call.apply(e.bind,arguments)}function Xz(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Jz(e,t,n){return(Jz=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Qz:Xz).apply(null,arguments)}function eH(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function tH(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function nH(){this.s=this.s,this.o=this.o}var rH={};nH.prototype.s=!1,nH.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,Yz)&&e[Yz]||(e[Yz]=++Kz)}(this);delete rH[e]}},nH.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var iH=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},aH=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,a=0;a<r;a++)a in i&&t.call(n,i[a],a,e)};function oH(e){return Array.prototype.concat.apply([],arguments)}function sH(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function uH(e){return/^[\s\xa0]*$/.test(e)}var cH,lH=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function fH(e,t){return-1!=e.indexOf(t)}function hH(e,t){return e<t?-1:e>t?1:0}e:{var dH=Zz.navigator;if(dH){var vH=dH.userAgent;if(vH){cH=vH;break e}}cH=""}function pH(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function gH(e){var t={};for(var n in e)t[n]=e[n];return t}var yH="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function mH(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<yH.length;a++)n=yH[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function kH(e){return kH[" "](e),e}kH[" "]=qz;var CH,wH=fH(cH,"Opera"),_H=fH(cH,"Trident")||fH(cH,"MSIE"),EH=fH(cH,"Edge"),bH=EH||_H,PH=fH(cH,"Gecko")&&!(fH(cH.toLowerCase(),"webkit")&&!fH(cH,"Edge"))&&!(fH(cH,"Trident")||fH(cH,"MSIE"))&&!fH(cH,"Edge"),SH=fH(cH.toLowerCase(),"webkit")&&!fH(cH,"Edge");function OH(){var e=Zz.document;return e?e.documentMode:void 0}e:{var TH="",IH=function(){var e=cH;return PH?/rv:([^\);]+)(\)|;)/.exec(e):EH?/Edge\/([\d\.]+)/.exec(e):_H?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):SH?/WebKit\/(\S+)/.exec(e):wH?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(IH&&(TH=IH?IH[1]:""),_H){var AH=OH();if(null!=AH&&AH>parseFloat(TH)){CH=String(AH);break e}}CH=TH}var RH={};var MH=Zz.document&&_H&&(OH()||parseInt(CH,10))||void 0,xH=function(){if(!Zz.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Zz.addEventListener("test",qz,t),Zz.removeEventListener("test",qz,t)}catch(n){}return e}();function NH(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function DH(e,t){if(NH.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(PH){e:{try{kH(t.nodeName);var i=!0;break e}catch(a){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:LH[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&DH.Z.h.call(this)}}NH.prototype.h=function(){this.defaultPrevented=!0},tH(DH,NH);var LH={2:"touch",3:"pen",4:"mouse"};DH.prototype.h=function(){DH.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var FH="closure_listenable_"+(1e6*Math.random()|0),UH=0;function VH(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++UH,this.ca=this.fa=!1}function BH(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function zH(e){this.src=e,this.g={},this.h=0}function HH(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=iH(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(BH(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function GH(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.ca&&a.listener==t&&a.capture==!!n&&a.ia==r)return i}return-1}zH.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=GH(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new VH(t,this.src,a,!!r,i)).fa=n,e.push(t)),t};var $H="closure_lm_"+(1e6*Math.random()|0),ZH={};function qH(e,t,n,r,i){if(r&&r.once)return jH(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)qH(e,t[a],n,r,i);return null}return n=tG(n),e&&e[FH]?e.N(t,n,jz(r)?!!r.capture:!!r,i):WH(e,t,n,!1,r,i)}function WH(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=jz(i)?!!i.capture:!!i,s=JH(e);if(s||(e[$H]=s=new zH(e)),(n=s.add(t,n,r,o,a)).proxy)return n;if(r=function(){var e=XH;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)xH||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(QH(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function jH(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)jH(e,t[a],n,r,i);return null}return n=tG(n),e&&e[FH]?e.O(t,n,jz(r)?!!r.capture:!!r,i):WH(e,t,n,!0,r,i)}function YH(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)YH(e,t[a],n,r,i);else r=jz(r)?!!r.capture:!!r,n=tG(n),e&&e[FH]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=GH(a=e.g[t],n,r,i))&&(BH(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--))):e&&(e=JH(e))&&(t=e.g[t.toString()],e=-1,t&&(e=GH(t,n,r,i)),(n=-1<e?t[e]:null)&&KH(n))}function KH(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[FH])HH(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(QH(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=JH(t))?(HH(n,e),0==n.h&&(n.src=null,t[$H]=null)):BH(e)}}}function QH(e){return e in ZH?ZH[e]:ZH[e]="on"+e}function XH(e,t){if(e.ca)e=!0;else{t=new DH(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&KH(e),e=n.call(r,t)}return e}function JH(e){return(e=e[$H])instanceof zH?e:null}var eG="__closure_events_fn_"+(1e9*Math.random()>>>0);function tG(e){return"function"==typeof e?e:(e[eG]||(e[eG]=function(t){return e.handleEvent(t)}),e[eG])}function nG(){nH.call(this),this.i=new zH(this),this.P=this,this.I=null}function rG(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new NH(t,e);else if(t instanceof NH)t.target=t.target||e;else{var i=t;mH(t=new NH(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=iG(o,r,!0,t)&&i}if(i=iG(o=t.g=e,r,!0,t)&&i,i=iG(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=iG(o=t.g=n[a],r,!1,t)&&i}function iG(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.ca&&o.capture==n){var s=o.listener,u=o.ia||o.src;o.fa&&HH(e.i,o),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}tH(nG,nH),nG.prototype[FH]=!0,nG.prototype.removeEventListener=function(e,t,n,r){YH(this,e,t,n,r)},nG.prototype.M=function(){if(nG.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)BH(n[r]);delete t.g[e],t.h--}}this.I=null},nG.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},nG.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var aG=Zz.JSON.stringify;function oG(){var e=dG,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var sG,uG=new(function(){function e(t,n){Zg(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return Wg(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}())(function(){return new cG},function(e){return e.reset()}),cG=function(){function e(){Zg(this,e),this.next=this.g=this.h=null}return Wg(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function lG(e){Zz.setTimeout(function(){throw e},0)}function fG(e,t){sG||function(){var e=Zz.Promise.resolve(void 0);sG=function(){e.then(vG)}}(),hG||(sG(),hG=!0),dG.add(e,t)}var hG=!1,dG=new(function(){function e(){Zg(this,e),this.h=this.g=null}return Wg(e,[{key:"add",value:function(e,t){var n=uG.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}());function vG(){for(var e;e=oG();){try{e.h.call(e.g)}catch(n){lG(n)}var t=uG;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}hG=!1}function pG(e,t){nG.call(this),this.h=e||1,this.g=t||Zz,this.j=Jz(this.kb,this),this.l=Date.now()}function gG(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function yG(e,t,n){if("function"==typeof e)n&&(e=Jz(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Jz(e.handleEvent,e)}return 2147483647<Number(t)?-1:Zz.setTimeout(e,t||0)}function mG(e){e.g=yG(function(){e.g=null,e.i&&(e.i=!1,mG(e))},e.j);var t=e.h;e.h=null,e.m.apply(null,t)}tH(pG,nG),(zz=pG.prototype).da=!1,zz.S=null,zz.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),rG(this,"tick"),this.da&&(gG(this),this.start()))}},zz.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},zz.M=function(){pG.Z.M.call(this),gG(this),delete this.g};var kG=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).m=e,i.j=r,i.h=null,i.i=!1,i.g=null,i}return Wg(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:mG(this)}},{key:"M",value:function(){Rg(Vg(n.prototype),"M",this).call(this),this.g&&(Zz.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(nH);function CG(e){nH.call(this),this.h=e,this.g={}}tH(CG,nH);var wG=[];function _G(e,t,n,r){Array.isArray(n)||(n&&(wG[0]=n.toString()),n=wG);for(var i=0;i<n.length;i++){var a=qH(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function EG(e){pH(e.g,function(e,t){this.g.hasOwnProperty(t)&&KH(e)},e),e.g={}}function bG(){this.g=!0}function PG(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return aG(n)}catch(s){return t}}(e,n)+(r?" "+r:"")})}CG.prototype.M=function(){CG.Z.M.call(this),EG(this)},CG.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},bG.prototype.Aa=function(){this.g=!1},bG.prototype.info=function(){};var SG={},OG=null;function TG(){return OG=OG||new nG}function IG(e){NH.call(this,SG.Ma,e)}function AG(e){var t=TG();rG(t,new IG(t,e))}function RG(e,t){NH.call(this,SG.STAT_EVENT,e),this.stat=t}function MG(e){var t=TG();rG(t,new RG(t,e))}function xG(e,t){NH.call(this,SG.Na,e),this.size=t}function NG(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return Zz.setTimeout(function(){e()},t)}SG.Ma="serverreachability",tH(IG,NH),SG.STAT_EVENT="statevent",tH(RG,NH),SG.Na="timingevent",tH(xG,NH);var DG={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},LG={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function FG(){}function UG(){}FG.prototype.h=null;var VG,BG={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function zG(){NH.call(this,"d")}function HG(){NH.call(this,"c")}function GG(){}function $G(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new CG(this),this.P=qG,this.W=new pG(e=bH?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new ZG}function ZG(){this.i=null,this.g="",this.h=!1}tH(zG,NH),tH(HG,NH),tH(GG,FG),GG.prototype.g=function(){return new XMLHttpRequest},GG.prototype.i=function(){return{}},VG=new GG;var qG=45e3,WG={},jG={};function YG(e,t,n){e.K=1,e.v=m$(h$(t)),e.s=n,e.U=!0,KG(e,null)}function KG(e,t){e.F=Date.now(),e$(e),e.A=h$(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),R$(n.h,"t",r),e.C=0,n=e.l.H,e.h=new ZG,e.g=RZ(e.l,n?t:null,!e.s),0<e.O&&(e.L=new kG(Jz(e.Ia,e,e.g),e.O)),_G(e.V,e.g,"readystatechange",e.gb),t=e.H?gH(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),AG(1),function(e,t,n,r,i,a){e.info(function(){if(e.g)if(a)for(var o="",s=a.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var f=l.split("_");o=2<=f.length&&"type"==f[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.j,e.u,e.A,e.m,e.X,e.s)}function QG(e){return!!e.g&&"GET"==e.u&&2!=e.K&&e.l.Ba}function XG(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=JG(e,n))==jG){4==t&&(e.o=4,MG(14),i=!1),PG(e.j,e.m,null,"[Incomplete Response]");break}if(r==WG){e.o=4,MG(15),PG(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}PG(e.j,e.m,r,null),a$(e,r)}QG(e)&&r!=jG&&r!=WG&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,MG(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),EZ(t),t.L=!0,MG(11))):(PG(e.j,e.m,n,"[Invalid Chunked Response]"),i$(e),r$(e))}function JG(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?jG:(n=Number(t.substring(n,r)),isNaN(n)?WG:(r+=1)+n>t.length?jG:(t=t.substr(r,n),e.C=r+n,t))}function e$(e){e.Y=Date.now()+e.P,t$(e,e.P)}function t$(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=NG(Jz(e.eb,e),t)}function n$(e){e.B&&(Zz.clearTimeout(e.B),e.B=null)}function r$(e){0==e.l.G||e.I||SZ(e.l,e)}function i$(e){n$(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,gG(e.W),EG(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function a$(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||F$(n.i,e)))if(n.I=e.N,!e.J&&F$(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(g){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0])e:if(n.u)n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=NG(Jz(n.ab,n),6e3));else{if(n.g){if(!(n.g.F+3e3<e.F))break e;PZ(n),vZ(n)}_Z(n),MG(18)}if(1>=L$(n.i)&&n.ka){try{n.ka()}catch(y){}n.ka=void 0}}else TZ(n,11)}else if((e.J||n.g==e)&&PZ(n),!uH(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.U=a[0],a=a[1],2==n.G)if("c"==a[0]){n.J=a[1],n.la=a[2];var o=a[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var s=a[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));var u=a[5];null!=u&&"number"==typeof u&&0<u&&(n.K=r=1.5*u,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var f=r.i;!f.g&&(fH(l,"spdy")||fH(l,"quic")||fH(l,"h2"))&&(f.j=f.l,f.g=new Set,f.h&&(U$(f,f.h),f.h=null))}if(r.D){var h=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;h&&(r.sa=h,y$(r.F,r.D,h))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=e;if((r=n).oa=AZ(r,r.H?r.la:null,r.W),d.J){V$(r.i,d);var v=d,p=r.K;p&&v.setTimeout(p),v.B&&(n$(v),e$(v)),r.g=d}else wZ(r);0<n.l.length&&yZ(n)}else"stop"!=a[0]&&"close"!=a[0]||TZ(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?TZ(n,7):dZ(n):"noop"!=a[0]&&n.j&&n.j.wa(a),n.A=0)}AG(4)}catch(m){}}function o$(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Wz(e)||"string"==typeof e)aH(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(Wz(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(Wz(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length;for(var a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}}function s$(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof s$)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function u$(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];c$(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)c$(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function c$(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(zz=$G.prototype).setTimeout=function(e){this.P=e},zz.gb=function(e){e=e.target;var t=this.L;t&&3==uZ(e)?t.l():this.Ia(e)},zz.Ia=function(e){try{if(e==this.g)e:{var t=uZ(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(3!=t||bH||this.g&&(this.h.h||this.g.ga()||cZ(this.g)))){this.I||4!=t||7==n||AG(8==n||0>=r?3:2),n$(this);var i=this.g.ba();this.N=i;t:if(QG(this)){var a=cZ(this.g);e="";var o=a.length,s=4==uZ(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){i$(this),r$(this);var u="";break t}this.h.i=new Zz.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(a[n],{stream:s&&n==o-1});a.splice(0,o),this.h.g+=e,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(e,t,n,r,i,a,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o})}(this.j,this.u,this.A,this.m,this.X,t,i),this.i){if(this.$&&!this.J){t:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!uH(c)){var f=c;break t}}f=null}if(!(i=f)){this.i=!1,this.o=3,MG(12),i$(this),r$(this);break e}PG(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,a$(this,i)}this.U?(XG(this,t,u),bH&&this.i&&3==t&&(_G(this.V,this.W,"tick",this.fb),this.W.start())):(PG(this.j,this.m,u,null),a$(this,u)),4==t&&i$(this),this.i&&!this.I&&(4==t?SZ(this.l,this):(this.i=!1,e$(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,MG(12)):(this.o=0,MG(13)),i$(this),r$(this)}}}catch(h){}},zz.fb=function(){if(this.g){var e=uZ(this.g),t=this.g.ga();this.C<t.length&&(n$(this),XG(this,e,t),this.i&&4!=e&&e$(this))}},zz.cancel=function(){this.I=!0,i$(this)},zz.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(AG(3),MG(17)),i$(this),this.o=2,r$(this)):t$(this,this.Y-e)},(zz=s$.prototype).R=function(){u$(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},zz.T=function(){return u$(this),this.g.concat()},zz.get=function(e,t){return c$(this.h,e)?this.h[e]:t},zz.set=function(e,t){c$(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},zz.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],a=this.get(i);e.call(t,a,i,this)}};var l$=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function f$(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof f$){this.g=void 0!==t?t:e.g,d$(this,e.j),this.s=e.s,v$(this,e.i),p$(this,e.m),this.l=e.l,t=e.h;var n=new O$;n.i=t.i,t.g&&(n.g=new s$(t.g),n.h=t.h),g$(this,n),this.o=e.o}else e&&(n=String(e).match(l$))?(this.g=!!t,d$(this,n[1]||"",!0),this.s=k$(n[2]||""),v$(this,n[3]||"",!0),p$(this,n[4]),this.l=k$(n[5]||"",!0),g$(this,n[6]||"",!0),this.o=k$(n[7]||"")):(this.g=!!t,this.h=new O$(null,this.g))}function h$(e){return new f$(e)}function d$(e,t,n){e.j=n?k$(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function v$(e,t,n){e.i=n?k$(t,!0):t}function p$(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function g$(e,t,n){t instanceof O$?(e.h=t,function(e,t){t&&!e.j&&(T$(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(I$(this,t),R$(this,n,e))},e)),e.j=t}(e.h,e.g)):(n||(t=C$(t,P$)),e.h=new O$(t,e.g))}function y$(e,t,n){e.h.set(t,n)}function m$(e){return y$(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function k$(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function C$(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,w$),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function w$(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}f$.prototype.toString=function(){var e=[],t=this.j;t&&e.push(C$(t,_$,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(C$(t,_$,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(C$(n,"/"==n.charAt(0)?b$:E$,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",C$(n,S$)),e.join("")};var _$=/[#\/\?@]/g,E$=/[#\?:]/g,b$=/[#\?]/g,P$=/[#\?@]/g,S$=/#/g;function O$(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function T$(e){e.g||(e.g=new s$,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function I$(e,t){T$(e),t=M$(e,t),c$(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,c$((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&u$(e)))}function A$(e,t){return T$(e),t=M$(e,t),c$(e.g.h,t)}function R$(e,t,n){I$(e,t),0<n.length&&(e.i=null,e.g.set(M$(e,t),sH(n)),e.h+=n.length)}function M$(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function x$(e){this.l=e||N$,e=Zz.PerformanceNavigationTiming?0<(e=Zz.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(Zz.g&&Zz.g.Ea&&Zz.g.Ea()&&Zz.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(zz=O$.prototype).add=function(e,t){T$(this),this.i=null,e=M$(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},zz.forEach=function(e,t){T$(this),this.g.forEach(function(n,r){aH(n,function(n){e.call(t,n,r,this)},this)},this)},zz.T=function(){T$(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},zz.R=function(e){T$(this);var t=[];if("string"==typeof e)A$(this,e)&&(t=oH(t,this.g.get(M$(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=oH(t,e[n])}return t},zz.set=function(e,t){return T$(this),this.i=null,A$(this,e=M$(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},zz.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},zz.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var a=0;a<r.length;a++){var o=i;""!==r[a]&&(o+="="+encodeURIComponent(String(r[a]))),e.push(o)}}return this.i=e.join("&")};var N$=10;function D$(e){return!!e.h||!!e.g&&e.g.size>=e.j}function L$(e){return e.h?1:e.g?e.g.size:0}function F$(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function U$(e,t){e.g?e.g.add(t):e.h=t}function V$(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function B$(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=Hg(e.g.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;n=n.concat(i.D)}}catch(a){r.e(a)}finally{r.f()}return n}return sH(e.i)}function z$(){}function H$(){this.g=new z$}function G$(e,t,n){var r=n||"";try{o$(e,function(e,n){var i=e;jz(e)&&(i=aG(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function $$(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(a){}}function Z$(e){this.l=e.$b||null,this.j=e.ib||!1}function q$(e,t){nG.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=W$,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}x$.prototype.cancel=function(){if(this.i=B$(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=Hg(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}},z$.prototype.stringify=function(e){return Zz.JSON.stringify(e,void 0)},z$.prototype.parse=function(e){return Zz.JSON.parse(e,void 0)},tH(Z$,FG),Z$.prototype.g=function(){return new q$(this.l,this.j)},Z$.prototype.i=function(e){return function(){return e}}({}),tH(q$,nG);var W$=0;function j$(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function Y$(e){e.readyState=4,e.l=null,e.j=null,e.A=null,K$(e)}function K$(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(zz=q$.prototype).open=function(e,t){if(this.readyState!=W$)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,K$(this)},zz.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||Zz).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},zz.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Y$(this)),this.readyState=W$},zz.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,K$(this)),this.g&&(this.readyState=3,K$(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Zz.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;j$(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},zz.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Y$(this):K$(this),3==this.readyState&&j$(this)}},zz.Ua=function(e){this.g&&(this.response=this.responseText=e,Y$(this))},zz.Ta=function(e){this.g&&(this.response=e,Y$(this))},zz.ha=function(){this.g&&Y$(this)},zz.setRequestHeader=function(e,t){this.v.append(e,t)},zz.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},zz.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(q$.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Q$=Zz.JSON.parse;function X$(e){nG.call(this),this.headers=new s$,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=J$,this.K=this.L=!1}tH(X$,nG);var J$="",eZ=/^https?$/i,tZ=["POST","PUT"];function nZ(e){return"content-type"==e.toLowerCase()}function rZ(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,iZ(e),oZ(e)}function iZ(e){e.D||(e.D=!0,rG(e,"complete"),rG(e,"error"))}function aZ(e){if(e.h&&void 0!==$z&&(!e.C[1]||4!=uZ(e)||2!=e.ba()))if(e.v&&4==uZ(e))yG(e.Fa,0,e);else if(rG(e,"readystatechange"),4==uZ(e)){e.h=!1;try{var t,n=e.ba();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.H).match(l$)[1]||null;if(!a&&Zz.self&&Zz.self.location){var o=Zz.self.location.protocol;a=o.substr(0,o.length-1)}i=!eZ.test(a?a.toLowerCase():"")}t=i}if(t)rG(e,"complete"),rG(e,"success");else{e.m=6;try{var s=2<uZ(e)?e.g.statusText:""}catch(u){s=""}e.j=s+" ["+e.ba()+"]",iZ(e)}}finally{oZ(e)}}}function oZ(e,t){if(e.g){sZ(e);var n=e.g,r=e.C[0]?qz:null;e.g=null,e.C=null,t||rG(e,"ready");try{n.onreadystatechange=r}catch(i){}}}function sZ(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(Zz.clearTimeout(e.A),e.A=null)}function uZ(e){return e.g?e.g.readyState:0}function cZ(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case J$:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function lZ(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return pH(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):y$(e,t,n))}function fZ(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function hZ(e){this.za=0,this.l=[],this.h=new bG,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=fZ("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=fZ("baseRetryDelayMs",5e3,e),this.$a=fZ("retryDelaySeedMs",1e4,e),this.Ya=fZ("forwardChannelMaxRetries",2,e),this.ra=fZ("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new x$(e&&e.concurrentRequestLimit),this.Ca=new H$,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function dZ(e){if(pZ(e),3==e.G){var t=e.V++,n=h$(e.F);y$(n,"SID",e.J),y$(n,"RID",t),y$(n,"TYPE","terminate"),kZ(e,n),(t=new $G(e,e.h,t,void 0)).K=2,t.v=m$(h$(n)),n=!1,Zz.navigator&&Zz.navigator.sendBeacon&&(n=Zz.navigator.sendBeacon(t.v.toString(),"")),!n&&Zz.Image&&((new Image).src=t.v,n=!0),n||(t.g=RZ(t.l,null),t.g.ea(t.v)),t.F=Date.now(),e$(t)}IZ(e)}function vZ(e){e.g&&(EZ(e),e.g.cancel(),e.g=null)}function pZ(e){vZ(e),e.u&&(Zz.clearTimeout(e.u),e.u=null),PZ(e),e.i.cancel(),e.m&&("number"==typeof e.m&&Zz.clearTimeout(e.m),e.m=null)}function gZ(e,t){e.l.push(new(function(){return Wg(function e(t,n){Zg(this,e),this.h=t,this.g=n})}())(e.Za++,t)),3==e.G&&yZ(e)}function yZ(e){D$(e.i)||e.m||(e.m=!0,fG(e.Ha,e),e.C=0)}function mZ(e,t){var n;n=t?t.m:e.V++;var r=h$(e.F);y$(r,"SID",e.J),y$(r,"RID",n),y$(r,"AID",e.U),kZ(e,r),e.o&&e.s&&lZ(r,e.o,e.s),n=new $G(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=CZ(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),U$(e.i,n),YG(n,r,t)}function kZ(e,t){e.j&&o$({},function(e,n){y$(t,n,e)})}function CZ(e,t,n){n=Math.min(e.l.length,n);var r=e.j?Jz(e.j.Oa,e.j,e):null;e:for(var i=e.l,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].h,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var s=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=a))a=Math.max(0,i[u].h-100),s=!1;else try{G$(l,o,"req"+c+"_")}catch(f){r&&r(l)}}if(s){r=o.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function wZ(e){e.g||e.u||(e.Y=1,fG(e.Ga,e),e.A=0)}function _Z(e){return!(e.g||e.u||3<=e.A||(e.Y++,e.u=NG(Jz(e.Ga,e),OZ(e,e.A)),e.A++,0))}function EZ(e){null!=e.B&&(Zz.clearTimeout(e.B),e.B=null)}function bZ(e){e.g=new $G(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=h$(e.oa);y$(t,"RID","rpc"),y$(t,"SID",e.J),y$(t,"CI",e.N?"0":"1"),y$(t,"AID",e.U),kZ(e,t),y$(t,"TYPE","xmlhttp"),e.o&&e.s&&lZ(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=m$(h$(t)),n.s=null,n.U=!0,KG(n,e)}function PZ(e){null!=e.v&&(Zz.clearTimeout(e.v),e.v=null)}function SZ(e,t){var n=null;if(e.g==t){PZ(e),EZ(e),e.g=null;var r=2}else{if(!F$(e.i,t))return;n=t.D,V$(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;rG(r=TG(),new xG(r,n,t,i)),yZ(e)}else wZ(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(L$(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=NG(Jz(e.Ha,e,t),OZ(e,e.C)),e.C++,0)))}(e,t)||2==r&&_Z(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:TZ(e,5);break;case 4:TZ(e,10);break;case 3:TZ(e,6);break;default:TZ(e,2)}}function OZ(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function TZ(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=Jz(e.jb,e);n||(n=new f$("//www.google.com/images/cleardot.gif"),Zz.location&&"http"==Zz.location.protocol||d$(n,"https"),m$(n)),function(e,t){var n=new bG;if(Zz.Image){var r=new Image;r.onload=eH($$,n,r,"TestLoadImage: loaded",!0,t),r.onerror=eH($$,n,r,"TestLoadImage: error",!1,t),r.onabort=eH($$,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=eH($$,n,r,"TestLoadImage: timeout",!1,t),Zz.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else MG(2);e.G=0,e.j&&e.j.va(t),IZ(e),pZ(e)}function IZ(e){e.G=0,e.I=-1,e.j&&((0!=B$(e.i).length||0!=e.l.length)&&(e.i.i.length=0,sH(e.l),e.l.length=0),e.j.ua())}function AZ(e,t,n){var r=function(e){return e instanceof f$?h$(e):new f$(e,void 0)}(n);if(""!=r.i)t&&v$(r,t+"."+r.i),p$(r,r.m);else{var i=Zz.location;r=function(e,t,n,r){var i=new f$(null,void 0);return e&&d$(i,e),t&&v$(i,t),n&&p$(i,n),r&&(i.l=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.aa&&pH(e.aa,function(e,t){y$(r,t,e)}),n=e.sa,(t=e.D)&&n&&y$(r,t,n),y$(r,"VER",e.ma),kZ(e,r),r}function RZ(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new X$(n&&e.Ba&&!e.qa?new Z$({ib:!0}):e.qa)).L=e.H,t}function MZ(){}function xZ(){if(_H&&!(10<=Number(MH)))throw Error("Environmental error: no available transport.")}function NZ(e,t){nG.call(this),this.g=new hZ(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!uH(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!uH(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new FZ(this)}function DZ(e){zG.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function LZ(){HG.call(this),this.status=1}function FZ(e){this.g=e}(zz=X$.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():VG.g(),this.C=function(e){return e.h||(e.h=e.i())}(this.u?this.u:VG),this.g.onreadystatechange=Jz(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(a){return void rZ(this,a)}e=n||"";var i=new s$(this.headers);r&&o$(r,function(e,t){i.set(t,e)}),r=function(e){e:{for(var t=nZ,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=Zz.FormData&&e instanceof Zz.FormData,!(0<=iH(tZ,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(e,t){this.g.setRequestHeader(t,e)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{sZ(this),0<this.B&&((this.K=function(e){return _H&&function(){return e=RH,Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){for(var e=0,t=lH(String(CH)).split("."),n=lH("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var a=t[i]||"",o=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;e=hH(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||hH(0==a[2].length,0==o[2].length)||hH(a[2],o[2]),a=a[3],o=o[3]}while(0==e)}return 0<=e}();var e}()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Jz(this.pa,this)):this.A=yG(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(a){rZ(this,a)}},zz.pa=function(){void 0!==$z&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,rG(this,"timeout"),this.abort(8))},zz.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,rG(this,"complete"),rG(this,"abort"),oZ(this))},zz.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),oZ(this,!0)),X$.Z.M.call(this)},zz.Fa=function(){this.s||(this.F||this.v||this.l?aZ(this):this.cb())},zz.cb=function(){aZ(this)},zz.ba=function(){try{return 2<uZ(this)?this.g.status:-1}catch(e){return-1}},zz.ga=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},zz.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Q$(t)}},zz.Da=function(){return this.m},zz.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(zz=hZ.prototype).ma=8,zz.G=1,zz.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(t){}},zz.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new $G(this,this.h,e,void 0),n=this.s;if(this.P&&(n?mH(n=gH(n),this.P):n=this.P),null===this.o&&(t.H=n),this.ja)e:{for(var r=0,i=0;i<this.l.length;i++){var a=this.l[i];if(void 0===(a="__data__"in a.g&&"string"==typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.l.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=CZ(this,t,r),y$(i=h$(this.F),"RID",e),y$(i,"CVER",22),this.D&&y$(i,"X-HTTP-Session-Id",this.D),kZ(this,i),this.o&&n&&lZ(i,this.o,n),U$(this.i,t),this.Ra&&y$(i,"TYPE","init"),this.ja?(y$(i,"$req",r),y$(i,"SID","null"),t.$=!0,YG(t,i,null)):YG(t,i,r),this.G=2}}else 3==this.G&&(e?mZ(this,e):0==this.l.length||D$(this.i)||mZ(this))},zz.Ga=function(){if(this.u=null,bZ(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=NG(Jz(this.bb,this),e)}},zz.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,MG(10),vZ(this),bZ(this))},zz.ab=function(){null!=this.v&&(this.v=null,vZ(this),_Z(this),MG(19))},zz.jb=function(e){e?(this.h.info("Successfully pinged google.com"),MG(2)):(this.h.info("Failed to ping google.com"),MG(1))},(zz=MZ.prototype).xa=function(){},zz.wa=function(){},zz.va=function(){},zz.ua=function(){},zz.Oa=function(){},xZ.prototype.g=function(e,t){return new NZ(e,t)},tH(NZ,nG),NZ.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),fG(Jz(e.hb,e,t))),MG(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=AZ(e,null,e.W),yZ(e)},NZ.prototype.close=function(){dZ(this.g)},NZ.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,gZ(this.g,t)}else this.v?((t={}).__data__=aG(e),gZ(this.g,t)):gZ(this.g,e)},NZ.prototype.M=function(){this.g.j=null,delete this.j,dZ(this.g),delete this.g,NZ.Z.M.call(this)},tH(DZ,zG),tH(LZ,HG),tH(FZ,MZ),FZ.prototype.xa=function(){rG(this.g,"a")},FZ.prototype.wa=function(e){rG(this.g,new DZ(e))},FZ.prototype.va=function(e){rG(this.g,new LZ(e))},FZ.prototype.ua=function(){rG(this.g,"b")},xZ.prototype.createWebChannel=xZ.prototype.g,NZ.prototype.send=NZ.prototype.u,NZ.prototype.open=NZ.prototype.m,NZ.prototype.close=NZ.prototype.close,DG.NO_ERROR=0,DG.TIMEOUT=8,DG.HTTP_ERROR=6,LG.COMPLETE="complete",UG.EventType=BG,BG.OPEN="a",BG.CLOSE="b",BG.ERROR="c",BG.MESSAGE="d",nG.prototype.listen=nG.prototype.N,X$.prototype.listenOnce=X$.prototype.O,X$.prototype.getLastError=X$.prototype.La,X$.prototype.getLastErrorCode=X$.prototype.Da,X$.prototype.getStatus=X$.prototype.ba,X$.prototype.getResponseJson=X$.prototype.Qa,X$.prototype.getResponseText=X$.prototype.ga,X$.prototype.send=X$.prototype.ea;var UZ=Gz.createWebChannelTransport=function(){return new xZ},VZ=Gz.getStatEventTarget=function(){return TG()},BZ=Gz.ErrorCode=DG,zZ=Gz.EventType=LG,HZ=Gz.Event=SG,GZ=Gz.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},$Z=Gz.FetchXmlHttpFactory=Z$,ZZ=Gz.WebChannel=UG,qZ=Gz.XhrIo=X$,WZ="@firebase/firestore",jZ=function(){function e(t){Zg(this,e),this.uid=t}return Wg(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();jZ.UNAUTHENTICATED=new jZ(null),jZ.GOOGLE_CREDENTIALS=new jZ("google-credentials-uid"),jZ.FIRST_PARTY=new jZ("first-party-uid"),jZ.MOCK_USER=new jZ("mock-user");var YZ="9.9.0",KZ=new XB("@firebase/firestore");function QZ(){return KZ.logLevel}function XZ(e){if(KZ.logLevel<=WB.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(tq);KZ.debug.apply(KZ,["Firestore (".concat(YZ,"): ").concat(e)].concat(Bg(i)))}}function JZ(e){if(KZ.logLevel<=WB.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(tq);KZ.error.apply(KZ,["Firestore (".concat(YZ,"): ").concat(e)].concat(Bg(i)))}}function eq(e){if(KZ.logLevel<=WB.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(tq);KZ.warn.apply(KZ,["Firestore (".concat(YZ,"): ").concat(e)].concat(Bg(i)))}}function tq(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function nq(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(YZ,") INTERNAL ASSERTION FAILED: ")+e;throw JZ(t),new Error(t)}function rq(e,t){e||nq()}function iq(e,t){return e}var aq={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},oq=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e,r)).code=e,i.message=r,i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return Wg(n)}(TB),sq=Wg(function e(){var t=this;Zg(this,e),this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}),uq=Wg(function e(t,n){Zg(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))}),cq=function(){function e(){Zg(this,e)}return Wg(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(jZ.UNAUTHENTICATED)})}},{key:"shutdown",value:function(){}}]),e}(),lq=function(){function e(t){Zg(this,e),this.t=t,this.currentUser=jZ.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return Wg(e,[{key:"start",value:function(e,t){var n=this,r=this,i=this.i,a=function(e){return n.i!==i?(i=n.i,t(e)):Promise.resolve()},o=new sq;this.o=function(){n.i++,n.currentUser=n.u(),o.resolve(),o=new sq,e.enqueueRetryable(function(){return a(n.currentUser)})};var s=function(){var t=o;e.enqueueRetryable(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,a(r.currentUser);case 4:case"end":return e.stop()}},e)})))},u=function(e){XZ("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),s()};this.t.onInit(function(e){return u(e)}),setTimeout(function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?u(e):(XZ("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new sq)}},0),s()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return e.i!==t?(XZ("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(rq("string"==typeof n.accessToken),new uq(n.accessToken,e.currentUser)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return rq(null===e||"string"==typeof e),new jZ(e)}}]),e}(),fq=Wg(function e(t,n,r){Zg(this,e),this.type="FirstParty",this.user=jZ.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);var i=t.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}),hq=function(){function e(t,n,r){Zg(this,e),this.h=t,this.l=n,this.m=r}return Wg(e,[{key:"getToken",value:function(){return Promise.resolve(new fq(this.h,this.l,this.m))}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(jZ.FIRST_PARTY)})}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),dq=Wg(function e(t){Zg(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}),vq=function(){function e(t){Zg(this,e),this.g=t,this.forceRefresh=!1,this.appCheck=null,this.p=null}return Wg(e,[{key:"start",value:function(e,t){var n=this;this.o=function(r){e.enqueueRetryable(function(){return function(e){null!=e.error&&XZ("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.p;return n.p=e.token,XZ("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()}(r)})};var r=function(e){XZ("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.g.onInit(function(e){return r(e)}),setTimeout(function(){if(!n.appCheck){var e=n.g.getImmediate({optional:!0});e?r(e):XZ("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(function(t){return t?(rq("string"==typeof t.token),e.p=t.token,new dq(t.token)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}();function pq(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var gq=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"I",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=pq(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),e}();function yq(e,t){return e<t?-1:e>t?1:0}function mq(e,t,n){return e.length===t.length&&e.every(function(e,r){return n(e,t[r])})}var kq=function(){function e(t,n){if(Zg(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new oq(aq.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new oq(aq.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new oq(aq.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new oq(aq.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return Wg(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?yq(this.nanoseconds,e.nanoseconds):yq(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),Cq=function(){function e(t){Zg(this,e),this.timestamp=t}return Wg(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new kq(0,0))}},{key:"max",value:function(){return new e(new kq(253402300799,999999999))}}]),e}(),wq=function(){function e(t,n,r){Zg(this,e),void 0===n?n=0:n>t.length&&nq(),void 0===r?r=t.length-n:r>t.length-n&&nq(),this.segments=t,this.offset=n,this.len=r}return Wg(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(e){n.push(e)}):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),_q=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var a=0,o=r;a<o.length;a++){var s=o[a];if(s.indexOf("//")>=0)throw new oq(aq.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));e.push.apply(e,Bg(s.split("/").filter(function(e){return e.length>0})))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(wq),Eq=/^[_a-zA-Z][_a-zA-Z0-9]*$/,bq=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map(function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return Eq.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",i=0,a=function(){if(0===r.length)throw new oq(aq.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new oq(aq.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new oq(aq.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===s?(o=!o,i++):"."!==s||o?(r+=s,i++):(a(),i++)}if(a(),o)throw new oq(aq.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(wq),Pq=function(){function e(t){Zg(this,e),this.path=t}return Wg(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===_q.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(_q.fromString(t))}},{key:"fromName",value:function(t){return new e(_q.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(_q.emptyPath())}},{key:"comparator",value:function(e,t){return _q.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new _q(t.slice()))}}]),e}();function Sq(e){return new Oq(e.readTime,e.key,-1)}var Oq=function(){function e(t,n,r){Zg(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return Wg(e,null,[{key:"min",value:function(){return new e(Cq.min(),Pq.empty(),-1)}},{key:"max",value:function(){return new e(Cq.max(),Pq.empty(),-1)}}]),e}();function Tq(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=Pq.comparator(e.documentKey,t.documentKey))?n:yq(e.largestBatchId,t.largestBatchId)}var Iq="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";function Aq(e){return Rq.apply(this,arguments)}function Rq(){return Rq=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===aq.FAILED_PRECONDITION&&t.message===Iq){e.next=2;break}throw t;case 2:XZ("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}},e)})),Rq.apply(this,arguments)}var Mq=function(){function e(t){var n=this;Zg(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)},function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)})}return Wg(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&nq(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}})}},{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.next(t,n)})}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(n){return e.reject(n)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.reject(n)}}],[{key:"resolve",value:function(t){return new e(function(e,n){e(t)})}},{key:"reject",value:function(t){return new e(function(e,n){n(t)})}},{key:"waitFor",value:function(t){return new e(function(e,n){var r=0,i=0,a=!1;t.forEach(function(t){++r,t.next(function(){++i,a&&i===r&&e()},function(e){return n(e)})}),a=!0,i===r&&e()})}},{key:"or",value:function(t){var n,r=e.resolve(!1),i=Hg(t);try{var a=function(){var t=n.value;r=r.next(function(n){return n?e.resolve(n):t()})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach(function(e,i){r.push(t.call(n,e,i))}),this.waitFor(r)}},{key:"mapArray",value:function(t,n){return new e(function(e,r){for(var i=t.length,a=new Array(i),o=0,s=function(s){var u=s;n(t[u]).next(function(t){a[u]=t,++o===i&&e(a)},function(e){return r(e)})},u=0;u<i;u++)s(u)})}},{key:"doWhile",value:function(t,n){return new e(function(e,r){!function i(){!0===t()?n().next(function(){i()},r):e()}()})}}]),e}();function xq(e){return"IndexedDbTransactionError"===e.name}var Nq=function(){function e(t,n){var r=this;Zg(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.it(e)},this.rt=function(e){return n.writeSequenceNumber(e)})}return Wg(e,[{key:"it",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.rt&&this.rt(e),e}}]),e}();function Dq(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Lq(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Fq(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}Nq.ot=-1;var Uq=function(){function e(t,n){Zg(this,e),this.comparator=t,this.root=n||Bq.EMPTY}return Wg(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Bq.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Bq.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal(function(t,n){return e(t,n),!1})}},{key:"toString",value:function(){var e=[];return this.inorderTraversal(function(t,n){return e.push("".concat(t,":").concat(n)),!1}),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new Vq(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new Vq(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new Vq(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new Vq(this.root,e,this.comparator,!0)}}]),e}(),Vq=function(){function e(t,n,r,i){Zg(this,e),this.isReverse=i,this.nodeStack=[];for(var a=1;!t.isEmpty();)if(a=n?r(t.key,n):1,n&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return Wg(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),Bq=function(){function e(t,n,r,i,a){Zg(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=a?a:e.EMPTY,this.size=this.left.size+1+this.right.size}return Wg(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw nq();var e=this.left.check();if(e!==this.right.check())throw nq();return e+(this.isRed()?0:1)}}]),e}();Bq.EMPTY=null,Bq.RED=!0,Bq.BLACK=!1,Bq.EMPTY=new(function(){function e(){Zg(this,e),this.size=0}return Wg(e,[{key:"key",get:function(){throw nq()}},{key:"value",get:function(){throw nq()}},{key:"color",get:function(){throw nq()}},{key:"left",get:function(){throw nq()}},{key:"right",get:function(){throw nq()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new Bq(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var zq=function(){function e(t){Zg(this,e),this.comparator=t,this.data=new Uq(this.comparator)}return Wg(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal(function(t,n){return e(t),!1})}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new Hq(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new Hq(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach(function(e){t=t.add(e)}),t}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach(function(t){e.push(t)}),e}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),Hq=function(){function e(t){Zg(this,e),this.iter=t}return Wg(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}(),Gq=function(){function e(t){Zg(this,e),this.fields=t,t.sort(bq.comparator)}return Wg(e,[{key:"unionWith",value:function(t){var n,r=new zq(bq.comparator),i=Hg(this.fields);try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r.add(a)}}catch(c){i.e(c)}finally{i.f()}var o,s=Hg(t);try{for(s.s();!(o=s.n()).done;){var u=o.value;r=r.add(u)}}catch(c){s.e(c)}finally{s.f()}return new e(r.toArray())}},{key:"covers",value:function(e){var t,n=Hg(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return mq(this.fields,e.fields,function(e,t){return e.isEqual(t)})}}],[{key:"empty",value:function(){return new e([])}}]),e}(),$q=function(e){function t(e){Zg(this,t),this.binaryString=e}return Wg(t,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return btoa(this.binaryString)}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return yq(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){return new t(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e))}}]),t}();$q.EMPTY_BYTE_STRING=new $q("");var Zq=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function qq(e){if(rq(!!e),"string"==typeof e){var t=0,n=Zq.exec(e);if(rq(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Wq(e.seconds),nanos:Wq(e.nanos)}}function Wq(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function jq(e){return"string"==typeof e?$q.fromBase64String(e):$q.fromUint8Array(e)}function Yq(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Kq(e){var t=e.mapValue.fields.__previous_value__;return Yq(t)?Kq(t):t}function Qq(e){var t=qq(e.mapValue.fields.__local_write_time__.timestampValue);return new kq(t.seconds,t.nanos)}var Xq=Wg(function e(t,n,r,i,a,o,s,u){Zg(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=u}),Jq=function(){function e(t,n){Zg(this,e),this.projectId=t,this.database=n||"(default)"}return Wg(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}();function eW(e){return null==e}function tW(e){return 0===e&&1/e==-1/0}var nW={fields:{__type__:{stringValue:"__max__"}}};function rW(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Yq(e)?4:yW(e)?9007199254740991:10:nq()}function iW(e,t){if(e===t)return!0;var n,r=rW(e);if(r!==rW(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Qq(e).isEqual(Qq(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=qq(e.timestampValue),r=qq(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return n=t,jq(e.bytesValue).isEqual(jq(n.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Wq(e.geoPointValue.latitude)===Wq(t.geoPointValue.latitude)&&Wq(e.geoPointValue.longitude)===Wq(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Wq(e.integerValue)===Wq(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=Wq(e.doubleValue),r=Wq(t.doubleValue);return n===r?tW(n)===tW(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return mq(e.arrayValue.values||[],t.arrayValue.values||[],iW);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Dq(n)!==Dq(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!iW(n[i],r[i])))return!1;return!0}(e,t);default:return nq()}}function aW(e,t){return void 0!==(e.values||[]).find(function(e){return iW(e,t)})}function oW(e,t){if(e===t)return 0;var n,r,i,a,o=rW(e),s=rW(t);if(o!==s)return yq(o,s);switch(o){case 0:case 9007199254740991:return 0;case 1:return yq(e.booleanValue,t.booleanValue);case 2:return r=t,i=Wq((n=e).integerValue||n.doubleValue),a=Wq(r.integerValue||r.doubleValue),i<a?-1:i>a?1:i===a?0:isNaN(i)?isNaN(a)?0:-1:1;case 3:return sW(e.timestampValue,t.timestampValue);case 4:return sW(Qq(e),Qq(t));case 5:return yq(e.stringValue,t.stringValue);case 6:return function(e,t){var n=jq(e),r=jq(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=yq(n[i],r[i]);if(0!==a)return a}return yq(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=yq(Wq(e.latitude),Wq(t.latitude));return 0!==n?n:yq(Wq(e.longitude),Wq(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=oW(n[i],r[i]);if(a)return a}return yq(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===nW&&t===nW)return 0;if(e===nW)return 1;if(t===nW)return-1;var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var s=yq(r[o],a[o]);if(0!==s)return s;var u=oW(n[r[o]],i[a[o]]);if(0!==u)return u}return yq(r.length,a.length)}(e.mapValue,t.mapValue);default:throw nq()}}function sW(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return yq(e,t);var n=qq(e),r=qq(t),i=yq(n.seconds,r.seconds);return 0!==i?i:yq(n.nanos,r.nanos)}function uW(e){return cW(e)}function cW(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(t=e.timestampValue,n=qq(t),"time(".concat(n.seconds,",").concat(n.nanos,")")):"stringValue"in e?e.stringValue:"bytesValue"in e?jq(e.bytesValue).toBase64():"referenceValue"in e?Pq.fromName(e.referenceValue).toString():"geoPointValue"in e?"geo(".concat((r=e.geoPointValue).latitude,",").concat(r.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,i=Hg(e.values||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+=cW(a)}}catch(o){i.e(o)}finally{i.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,i=Hg(Object.keys(e.fields||{}).sort());try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+="".concat(a,":").concat(cW(e.fields[a]))}}catch(o){i.e(o)}finally{i.f()}return n+"}"}(e.mapValue):nq();var t,n,r}function lW(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function fW(e){return!!e&&"integerValue"in e}function hW(e){return!!e&&"arrayValue"in e}function dW(e){return!!e&&"nullValue"in e}function vW(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function pW(e){return!!e&&"mapValue"in e}function gW(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return Lq(e.mapValue.fields,function(e,n){return t.mapValue.fields[e]=gW(n)}),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=gW(e.arrayValue.values[r]);return n}return Object.assign({},e)}function yW(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}var mW=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!pW(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=gW(t)}},{key:"setAll",value:function(e){var t=this,n=bq.emptyPath(),r={},i=[];e.forEach(function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=gW(e):i.push(a.lastSegment())});var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());pW(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return iW(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];pW(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){Lq(t,function(t,n){return e[t]=n});var r,i=Hg(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete e[a]}}catch(o){i.e(o)}finally{i.f()}}},{key:"clone",value:function(){return new e(gW(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function kW(e){var t=[];return Lq(e.fields,function(e,n){var r=new bq([e]);if(pW(n)){var i=kW(n.mapValue).fields;if(0===i.length)t.push(r);else{var a,o=Hg(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;t.push(r.child(s))}}catch(u){o.e(u)}finally{o.f()}}}else t.push(r)}),new Gq(t)}var CW=function(){function e(t,n,r,i,a,o){Zg(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.data=a,this.documentState=o}return Wg(e,[{key:"convertToFoundDocument",value:function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=mW.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=mW.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=Cq.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,Cq.min(),Cq.min(),mW.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r){return new e(t,1,n,Cq.min(),r,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,Cq.min(),mW.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,Cq.min(),mW.empty(),2)}}]),e}(),wW=Wg(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;Zg(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=s,this.ut=null});function _W(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new wW(e,t,n,r,i,a,o)}function EW(e){var t=iq(e);if(null===t.ut){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(function(e){return(t=e).field.canonicalString()+t.op.toString()+uW(t.value);var t}).join(","),n+="|ob:",n+=t.orderBy.map(function(e){return(t=e).field.canonicalString()+t.dir;var t}).join(","),eW(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(function(e){return uW(e)}).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(function(e){return uW(e)}).join(",")),t.ut=n}return t.ut}function bW(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!FW(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if((i=e.filters[r]).op!==(a=t.filters[r]).op||!i.field.isEqual(a.field)||!iW(i.value,a.value))return!1;var i,a;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!VW(e.startAt,t.startAt)&&VW(e.endAt,t.endAt)}function PW(e){return Pq.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var SW=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this)).field=e,a.op=r,a.value=i,a}return Wg(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(oW(t,this.value)):null!==t&&rW(this.value)===rW(t)&&this.at(oW(t,this.value))}},{key:"at",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return nq()}}},{key:"ht",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,r):new OW(e,t,r):"array-contains"===t?new RW(e,r):"in"===t?new MW(e,r):"not-in"===t?new xW(e,r):"array-contains-any"===t?new NW(e,r):new n(e,t,r)}},{key:"ct",value:function(e,t,n){return"in"===t?new TW(e,n):new IW(e,n)}}]),n}(function(){return Wg(function e(){Zg(this,e)})}()),OW=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r,i)).key=Pq.fromName(i.referenceValue),a}return Wg(n,[{key:"matches",value:function(e){var t=Pq.comparator(e.key,this.key);return this.at(t)}}]),n}(SW),TW=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e,"in",r)).keys=AW(0,r),i}return Wg(n,[{key:"matches",value:function(e){return this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(SW),IW=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e,"not-in",r)).keys=AW(0,r),i}return Wg(n,[{key:"matches",value:function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(SW);function AW(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(e){return Pq.fromName(e.referenceValue)})}var RW=function(e){xg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,"array-contains",r)}return Wg(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return hW(t)&&aW(t.arrayValue,this.value)}}]),n}(SW),MW=function(e){xg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,"in",r)}return Wg(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&aW(this.value.arrayValue,t)}}]),n}(SW),xW=function(e){xg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,"not-in",r)}return Wg(n,[{key:"matches",value:function(e){if(aW(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!aW(this.value.arrayValue,t)}}]),n}(SW),NW=function(e){xg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,"array-contains-any",r)}return Wg(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!hW(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(e){return aW(t.value.arrayValue,e)})}}]),n}(SW),DW=Wg(function e(t,n){Zg(this,e),this.position=t,this.inclusive=n}),LW=Wg(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";Zg(this,e),this.field=t,this.dir=n});function FW(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function UW(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?Pq.comparator(Pq.fromName(o.referenceValue),n.key):oW(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function VW(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!iW(e.position[n],t.position[n]))return!1;return!0}var BW=Wg(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;Zg(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=s,this.endAt=u,this.lt=null,this.ft=null});function zW(e){return new BW(e)}function HW(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function GW(e){var t,n=Hg(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.ht())return r.field}}catch(i){n.e(i)}finally{n.f()}return null}function $W(e){return null!==e.collectionGroup}function ZW(e){var t=iq(e);if(null===t.lt){t.lt=[];var n=GW(t),r=HW(t);if(null!==n&&null===r)n.isKeyField()||t.lt.push(new LW(n)),t.lt.push(new LW(bq.keyField(),"asc"));else{var i,a=!1,o=Hg(t.explicitOrderBy);try{for(o.s();!(i=o.n()).done;){var s=i.value;t.lt.push(s),s.field.isKeyField()&&(a=!0)}}catch(c){o.e(c)}finally{o.f()}if(!a){var u=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.lt.push(new LW(bq.keyField(),u))}}}return t.lt}function qW(e){var t=iq(e);if(!t.ft)if("F"===t.limitType)t.ft=_W(t.path,t.collectionGroup,ZW(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],i=Hg(ZW(t));try{for(i.s();!(n=i.n()).done;){var a=n.value;r.push(new LW(a.field,"desc"===a.dir?"asc":"desc"))}}catch(u){i.e(u)}finally{i.f()}var o=t.endAt?new DW(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new DW(t.startAt.position,t.startAt.inclusive):null;t.ft=_W(t.path,t.collectionGroup,r,t.filters,t.limit,o,s)}return t.ft}function WW(e,t,n){return new BW(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function jW(e,t){return bW(qW(e),qW(t))&&e.limitType===t.limitType}function YW(e){return"".concat(EW(qW(e)),"|lt:").concat(e.limitType)}function KW(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(function(e){return"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(uW(t.value));var t}).join(", "),"]")),eW(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(function(e){return"".concat((t=e).field.canonicalString()," (").concat(t.dir,")");var t}).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(function(e){return uW(e)}).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(function(e){return uW(e)}).join(",")),"Target(".concat(t,")")}(qW(e)),"; limitType=").concat(e.limitType,")")}function QW(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Pq.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=Hg(e.explicitOrderBy);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=Hg(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&(s=t,!((o=e).startAt&&(n=o.startAt,r=ZW(o),i=s,a=UW(n,r,i),!(n.inclusive?a<=0:a<0))||o.endAt&&!function(e,t,n){var r=UW(e,t,n);return e.inclusive?r>=0:r>0}(o.endAt,ZW(o),s)));var n,r,i,a,o,s}function XW(e){return function(t,n){var r,i=!1,a=Hg(ZW(e));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=JW(o,t,n);if(0!==s)return s;i=i||o.field.isKeyField()}}catch(u){a.e(u)}finally{a.f()}return 0}}function JW(e,t,n){var r,i,a,o,s=e.field.isKeyField()?Pq.comparator(t.key,n.key):(r=e.field,i=n,a=t.data.field(r),o=i.data.field(r),null!==a&&null!==o?oW(a,o):nq());switch(e.dir){case"asc":return s;case"desc":return-1*s;default:return nq()}}function ej(e,t){if(e.dt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:tW(t)?"-0":t}}function tj(e){return{integerValue:""+e}}var nj=Wg(function e(){Zg(this,e),this._=void 0});function rj(e,t,n){return e instanceof oj?(i=t,a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&(a.fields.__previous_value__=i),{mapValue:a}):e instanceof sj?uj(e,t):e instanceof cj?lj(e,t):function(e,t){var n=aj(e,t),r=hj(n)+hj(e._t);return fW(n)&&fW(e._t)?tj(r):ej(e.wt,r)}(e,t);var r,i,a}function ij(e,t,n){return e instanceof sj?uj(e,t):e instanceof cj?lj(e,t):n}function aj(e,t){return e instanceof fj?fW(r=t)||(n=r)&&"doubleValue"in n?t:{integerValue:0}:null;var n,r}var oj=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n)}(nj),sj=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).elements=e,r}return Wg(n)}(nj);function uj(e,t){var n,r=dj(t),i=Hg(e.elements);try{var a=function(){var e=n.value;r.some(function(t){return iW(t,e)})||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var cj=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).elements=e,r}return Wg(n)}(nj);function lj(e,t){var n,r=dj(t),i=Hg(e.elements);try{var a=function(){var e=n.value;r=r.filter(function(t){return!iW(t,e)})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var fj=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).wt=e,i._t=r,i}return Wg(n)}(nj);function hj(e){return Wq(e.integerValue||e.doubleValue)}function dj(e){return hW(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var vj=Wg(function e(t,n){Zg(this,e),this.field=t,this.transform=n}),pj=Wg(function e(t,n){Zg(this,e),this.version=t,this.transformResults=n}),gj=function(){function e(t,n){Zg(this,e),this.updateTime=t,this.exists=n}return Wg(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function yj(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var mj=Wg(function e(){Zg(this,e)});function kj(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Rj(e.key,gj.none()):new bj(e.key,e.data,gj.none());var n,r=e.data,i=mW.empty(),a=new zq(bq.comparator),o=Hg(t.fields);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(!a.has(s)){var u=r.field(s);null===u&&s.length>1&&(s=s.popLast(),u=r.field(s)),null===u?i.delete(s):i.set(s,u),a=a.add(s)}}}catch(c){o.e(c)}finally{o.f()}return new Pj(e.key,i,new Gq(a.toArray()),gj.none())}function Cj(e,t,n){var r,i,a,o,s;e instanceof bj?(i=t,a=n,o=(r=e).value.clone(),s=Oj(r.fieldTransforms,i,a.transformResults),o.setAll(s),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()):e instanceof Pj?function(e,t,n){if(yj(e.precondition,t)){var r=Oj(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Sj(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):t.convertToNoDocument(n.version).setHasCommittedMutations()}function wj(e,t,n,r){return e instanceof bj?function(e,t,n,r){if(!yj(e.precondition,t))return n;var i=e.value.clone(),a=Tj(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Pj?function(e,t,n,r){if(!yj(e.precondition,t))return n;var i=Tj(e.fieldTransforms,r,t),a=t.data;return a.setAll(Sj(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(function(e){return e.field}))}(e,t,n,r):(a=n,yj(e.precondition,i=t)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):a);var i,a}function _j(e,t){var n,r=null,i=Hg(e.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.field),s=aj(a.transform,o||null);null!=s&&(null===r&&(r=mW.empty()),r.set(a.field,s))}}catch(u){i.e(u)}finally{i.f()}return r||null}function Ej(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(n=e.fieldTransforms)&&void 0===r||n&&r&&mq(n,r,function(e,t){return function(e,t){return e.field.isEqual(t.field)&&(r=t.transform,(n=e.transform)instanceof sj&&r instanceof sj||n instanceof cj&&r instanceof cj?mq(n.elements,r.elements,iW):n instanceof fj&&r instanceof fj?iW(n._t,r._t):n instanceof oj&&r instanceof oj);var n,r}(e,t)})))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var n,r}var bj=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return Zg(this,n),(a=t.call(this)).key=e,a.value=r,a.precondition=i,a.fieldTransforms=o,a.type=0,a}return Wg(n,[{key:"getFieldMask",value:function(){return null}}]),n}(mj),Pj=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return Zg(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=i,o.precondition=a,o.fieldTransforms=s,o.type=1,o}return Wg(n,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),n}(mj);function Sj(e){var t=new Map;return e.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}}),t}function Oj(e,t,n){var r=new Map;rq(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,s=t.data.field(a.field);r.set(a.field,ij(o,s,n[i]))}return r}function Tj(e,t,n){var r,i=new Map,a=Hg(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.transform,u=n.data.field(o.field);i.set(o.field,rj(s,u,t))}}catch(c){a.e(c)}finally{a.f()}return i}var Ij,Aj,Rj=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return Wg(n,[{key:"getFieldMask",value:function(){return null}}]),n}(mj),Mj=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return Wg(n,[{key:"getFieldMask",value:function(){return null}}]),n}(mj),xj=Wg(function e(t){Zg(this,e),this.count=t});function Nj(e){switch(e){default:return nq();case aq.CANCELLED:case aq.UNKNOWN:case aq.DEADLINE_EXCEEDED:case aq.RESOURCE_EXHAUSTED:case aq.INTERNAL:case aq.UNAVAILABLE:case aq.UNAUTHENTICATED:return!1;case aq.INVALID_ARGUMENT:case aq.NOT_FOUND:case aq.ALREADY_EXISTS:case aq.PERMISSION_DENIED:case aq.FAILED_PRECONDITION:case aq.ABORTED:case aq.OUT_OF_RANGE:case aq.UNIMPLEMENTED:case aq.DATA_LOSS:return!0}}function Dj(e){if(void 0===e)return JZ("GRPC error has no .code"),aq.UNKNOWN;switch(e){case Ij.OK:return aq.OK;case Ij.CANCELLED:return aq.CANCELLED;case Ij.UNKNOWN:return aq.UNKNOWN;case Ij.DEADLINE_EXCEEDED:return aq.DEADLINE_EXCEEDED;case Ij.RESOURCE_EXHAUSTED:return aq.RESOURCE_EXHAUSTED;case Ij.INTERNAL:return aq.INTERNAL;case Ij.UNAVAILABLE:return aq.UNAVAILABLE;case Ij.UNAUTHENTICATED:return aq.UNAUTHENTICATED;case Ij.INVALID_ARGUMENT:return aq.INVALID_ARGUMENT;case Ij.NOT_FOUND:return aq.NOT_FOUND;case Ij.ALREADY_EXISTS:return aq.ALREADY_EXISTS;case Ij.PERMISSION_DENIED:return aq.PERMISSION_DENIED;case Ij.FAILED_PRECONDITION:return aq.FAILED_PRECONDITION;case Ij.ABORTED:return aq.ABORTED;case Ij.OUT_OF_RANGE:return aq.OUT_OF_RANGE;case Ij.UNIMPLEMENTED:return aq.UNIMPLEMENTED;case Ij.DATA_LOSS:return aq.DATA_LOSS;default:return nq()}}(Aj=Ij||(Ij={}))[Aj.OK=0]="OK",Aj[Aj.CANCELLED=1]="CANCELLED",Aj[Aj.UNKNOWN=2]="UNKNOWN",Aj[Aj.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Aj[Aj.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Aj[Aj.NOT_FOUND=5]="NOT_FOUND",Aj[Aj.ALREADY_EXISTS=6]="ALREADY_EXISTS",Aj[Aj.PERMISSION_DENIED=7]="PERMISSION_DENIED",Aj[Aj.UNAUTHENTICATED=16]="UNAUTHENTICATED",Aj[Aj.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Aj[Aj.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Aj[Aj.ABORTED=10]="ABORTED",Aj[Aj.OUT_OF_RANGE=11]="OUT_OF_RANGE",Aj[Aj.UNIMPLEMENTED=12]="UNIMPLEMENTED",Aj[Aj.INTERNAL=13]="INTERNAL",Aj[Aj.UNAVAILABLE=14]="UNAVAILABLE",Aj[Aj.DATA_LOSS=15]="DATA_LOSS";var Lj=function(){function e(t,n){Zg(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}return Wg(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,i=Hg(n);try{for(i.s();!(r=i.n()).done;){var a=Sg(r.value,2),o=a[0],s=a[1];if(this.equalsFn(o,e))return s}}catch(u){i.e(u)}finally{i.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){Lq(this.inner,function(t,n){var r,i=Hg(n);try{for(i.s();!(r=i.n()).done;){var a=Sg(r.value,2),o=a[0],s=a[1];e(o,s)}}catch(u){i.e(u)}finally{i.f()}})}},{key:"isEmpty",value:function(){return Fq(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),Fj=new Uq(Pq.comparator);function Uj(){return Fj}var Vj=new Uq(Pq.comparator);function Bj(){for(var e=Vj,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.insert(o.key,o)}return e}function zj(e){var t=Vj;return e.forEach(function(e,n){return t=t.insert(e,n.overlayedDocument)}),t}function Hj(){return $j()}function Gj(){return $j()}function $j(){return new Lj(function(e){return e.toString()},function(e,t){return e.isEqual(t)})}var Zj=new Uq(Pq.comparator),qj=new zq(Pq.comparator);function Wj(){for(var e=qj,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.add(o)}return e}var jj=new zq(yq);function Yj(){return jj}var Kj=function(){function e(t,n,r,i,a){Zg(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return Wg(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n){var r=new Map;return r.set(t,Qj.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(Cq.min(),r,Yj(),Uj(),Wj())}}]),e}(),Qj=function(){function e(t,n,r,i,a){Zg(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return Wg(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n){return new e($q.EMPTY_BYTE_STRING,n,Wj(),Wj(),Wj())}}]),e}(),Xj=Wg(function e(t,n,r,i){Zg(this,e),this.gt=t,this.removedTargetIds=n,this.key=r,this.yt=i}),Jj=Wg(function e(t,n){Zg(this,e),this.targetId=t,this.It=n}),eY=Wg(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$q.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Zg(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}),tY=function(){function e(){Zg(this,e),this.Tt=0,this.Et=iY(),this.At=$q.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}return Wg(e,[{key:"current",get:function(){return this.Rt}},{key:"resumeToken",get:function(){return this.At}},{key:"Pt",get:function(){return 0!==this.Tt}},{key:"vt",get:function(){return this.bt}},{key:"Vt",value:function(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}},{key:"St",value:function(){var e=Wj(),t=Wj(),n=Wj();return this.Et.forEach(function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:nq()}}),new Qj(this.At,this.Rt,e,t,n)}},{key:"Dt",value:function(){this.bt=!1,this.Et=iY()}},{key:"Ct",value:function(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}},{key:"xt",value:function(e){this.bt=!0,this.Et=this.Et.remove(e)}},{key:"Nt",value:function(){this.Tt+=1}},{key:"kt",value:function(){this.Tt-=1}},{key:"Ot",value:function(){this.bt=!0,this.Rt=!0}}]),e}(),nY=function(){function e(t){Zg(this,e),this.Mt=t,this.Ft=new Map,this.$t=Uj(),this.Bt=rY(),this.Lt=new zq(yq)}return Wg(e,[{key:"Ut",value:function(e){var t,n=Hg(e.gt);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.yt&&e.yt.isFoundDocument()?this.qt(r,e.yt):this.Kt(r,e.key,e.yt)}}catch(s){n.e(s)}finally{n.f()}var i,a=Hg(e.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.Kt(o,e.key,e.yt)}}catch(s){a.e(s)}finally{a.f()}}},{key:"Gt",value:function(e){var t=this;this.forEachTarget(e,function(n){var r=t.Qt(n);switch(e.state){case 0:t.jt(n)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||t.removeTarget(n);break;case 3:t.jt(n)&&(r.Ot(),r.Vt(e.resumeToken));break;case 4:t.jt(n)&&(t.Wt(n),r.Vt(e.resumeToken));break;default:nq()}})}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach(function(e,r){n.jt(r)&&t(r)})}},{key:"zt",value:function(e){var t=e.targetId,n=e.It.count,r=this.Ht(t);if(r){var i=r.target;if(PW(i))if(0===n){var a=new Pq(i.path);this.Kt(t,a,CW.newNoDocument(a,Cq.min()))}else rq(1===n);else this.Jt(t)!==n&&(this.Wt(t),this.Lt=this.Lt.add(t))}}},{key:"Yt",value:function(e){var t=this,n=new Map;this.Ft.forEach(function(r,i){var a=t.Ht(i);if(a){if(r.current&&PW(a.target)){var o=new Pq(a.target.path);null!==t.$t.get(o)||t.Xt(i,o)||t.Kt(i,o,CW.newNoDocument(o,e))}r.vt&&(n.set(i,r.St()),r.Dt())}});var r=Wj();this.Bt.forEach(function(e,n){var i=!0;n.forEachWhile(function(e){var n=t.Ht(e);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(e))}),this.$t.forEach(function(t,n){return n.setReadTime(e)});var i=new Kj(e,n,this.Lt,this.$t,r);return this.$t=Uj(),this.Bt=rY(),this.Lt=new zq(yq),i}},{key:"qt",value:function(e,t){if(this.jt(e)){var n=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,n),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}}},{key:"Kt",value:function(e,t,n){if(this.jt(e)){var r=this.Qt(e);this.Xt(e,t)?r.Ct(t,1):r.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),n&&(this.$t=this.$t.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Ft.delete(e)}},{key:"Jt",value:function(e){var t=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Nt",value:function(e){this.Qt(e).Nt()}},{key:"Qt",value:function(e){var t=this.Ft.get(e);return t||(t=new tY,this.Ft.set(e,t)),t}},{key:"Zt",value:function(e){var t=this.Bt.get(e);return t||(t=new zq(yq),this.Bt=this.Bt.insert(e,t)),t}},{key:"jt",value:function(e){var t=null!==this.Ht(e);return t||XZ("WatchChangeAggregator","Detected inactive target",e),t}},{key:"Ht",value:function(e){var t=this.Ft.get(e);return t&&t.Pt?null:this.Mt.te(e)}},{key:"Wt",value:function(e){var t=this;this.Ft.set(e,new tY),this.Mt.getRemoteKeysForTarget(e).forEach(function(n){t.Kt(e,n,null)})}},{key:"Xt",value:function(e,t){return this.Mt.getRemoteKeysForTarget(e).has(t)}}]),e}();function rY(){return new Uq(Pq.comparator)}function iY(){return new Uq(Pq.comparator)}var aY={asc:"ASCENDING",desc:"DESCENDING"},oY={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},sY=Wg(function e(t,n){Zg(this,e),this.databaseId=t,this.dt=n});function uY(e,t){return e.dt?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function cY(e,t){return e.dt?t.toBase64():t.toUint8Array()}function lY(e,t){return uY(e,t.toTimestamp())}function fY(e){return rq(!!e),Cq.fromTimestamp((t=qq(e),new kq(t.seconds,t.nanos)));var t}function hY(e,t){return(n=e,new _q(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function dY(e){var t=_q.fromString(e);return rq(RY(t)),t}function vY(e,t){return hY(e.databaseId,t.path)}function pY(e,t){var n=dY(t);if(n.get(1)!==e.databaseId.projectId)throw new oq(aq.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new oq(aq.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Pq(mY(n))}function gY(e,t){return hY(e.databaseId,t)}function yY(e){return new _q(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function mY(e){return rq(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function kY(e,t,n){return{name:vY(e,t),fields:n.value.mapValue.fields}}function CY(e,t){return{documents:[gY(e,t.path)]}}function wY(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=gY(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=gY(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map(function(e){return function(e){if("=="===e.op){if(vW(e.value))return{unaryFilter:{field:SY(e.field),op:"IS_NAN"}};if(dW(e.value))return{unaryFilter:{field:SY(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(vW(e.value))return{unaryFilter:{field:SY(e.field),op:"IS_NOT_NAN"}};if(dW(e.value))return{unaryFilter:{field:SY(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:SY(e.field),op:PY(e.op),value:e.value}}}(e)});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map(function(e){return{field:SY((t=e).field),direction:bY(t.dir)};var t})}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,s,u,c=(o=t.limit,e.dt||eW(o)?o:{value:o});return null!==c&&(n.structuredQuery.limit=c),t.startAt&&(n.structuredQuery.startAt={before:(s=t.startAt).inclusive,values:s.position}),t.endAt&&(n.structuredQuery.endAt={before:!(u=t.endAt).inclusive,values:u.position}),n}function _Y(e){var t=function(e){var t=dY(e);return 4===t.length?_q.emptyPath():mY(t)}(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){rq(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o=[];n.where&&(o=EY(n.where));var s=[];n.orderBy&&(s=n.orderBy.map(function(e){return new LW(OY((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));var u=null;n.limit&&(u=function(e){var t;return eW(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c,l=null;n.startAt&&(l=new DW((c=n.startAt).values||[],!!c.before));var f=null;return n.endAt&&(f=function(e){return new DW(e.values||[],!e.before)}(n.endAt)),function(e,t,n,r,i,a,o,s){return new BW(e,t,n,r,i,"F",o,s)}(t,i,s,o,u,0,l,f)}function EY(e){return e?void 0!==e.unaryFilter?[IY(e)]:void 0!==e.fieldFilter?[TY(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return EY(e)}).reduce(function(e,t){return e.concat(t)}):nq():[]}function bY(e){return aY[e]}function PY(e){return oY[e]}function SY(e){return{fieldPath:e.canonicalString()}}function OY(e){return bq.fromServerFormat(e.fieldPath)}function TY(e){return SW.create(OY(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return nq()}}(e.fieldFilter.op),e.fieldFilter.value)}function IY(e){switch(e.unaryFilter.op){case"IS_NAN":var t=OY(e.unaryFilter.field);return SW.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=OY(e.unaryFilter.field);return SW.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=OY(e.unaryFilter.field);return SW.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=OY(e.unaryFilter.field);return SW.create(i,"!=",{nullValue:"NULL_VALUE"});default:return nq()}}function AY(e){var t=[];return e.fields.forEach(function(e){return t.push(e.canonicalString())}),{fieldPaths:t}}function RY(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}var MY=function(){function e(t,n,r,i){Zg(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return Wg(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&Cj(i,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n,r=Hg(this.baseMutations);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.key.isEqual(e.key)&&(t=wj(i,e,t,this.localWriteTime))}}catch(u){r.e(u)}finally{r.f()}var a,o=Hg(this.mutations);try{for(o.s();!(a=o.n()).done;){var s=a.value;s.key.isEqual(e.key)&&(t=wj(s,e,t,this.localWriteTime))}}catch(u){o.e(u)}finally{o.f()}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=Gj();return this.mutations.forEach(function(i){var a=e.get(i.key),o=a.overlayedDocument,s=n.applyToLocalView(o,a.mutatedFields),u=kj(o,s=t.has(i.key)?null:s);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Cq.min())}),r}},{key:"keys",value:function(){return this.mutations.reduce(function(e,t){return e.add(t.key)},Wj())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&mq(this.mutations,e.mutations,function(e,t){return Ej(e,t)})&&mq(this.baseMutations,e.baseMutations,function(e,t){return Ej(e,t)})}}]),e}(),xY=function(){function e(t,n,r,i){Zg(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return Wg(e,null,[{key:"from",value:function(t,n,r){rq(t.mutations.length===r.length);for(var i=Zj,a=t.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new e(t,n,r,i)}}]),e}(),NY=function(){function e(t,n){Zg(this,e),this.largestBatchId=t,this.mutation=n}return Wg(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),DY=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Cq.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Cq.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:$q.EMPTY_BYTE_STRING;Zg(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return Wg(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}]),e}(),LY=Wg(function e(t){Zg(this,e),this.ne=t});function FY(e){var t=_Y({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?WW(t,t.limit,"L"):t}var UY=function(){function e(){Zg(this,e)}return Wg(e,[{key:"re",value:function(e,t){this.oe(e,t),t.ue()}},{key:"oe",value:function(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(Wq(e.integerValue));else if("doubleValue"in e){var n=Wq(e.doubleValue);isNaN(n)?this.ce(t,13):(this.ce(t,15),tW(n)?t.ae(0):t.ae(n))}else if("timestampValue"in e){var r=e.timestampValue;this.ce(t,20),"string"==typeof r?t.he(r):(t.he("".concat(r.seconds||"")),t.ae(r.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(jq(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.ce(t,45),t.ae(i.latitude||0),t.ae(i.longitude||0)}else"mapValue"in e?yW(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):nq()}},{key:"le",value:function(e,t){this.ce(t,25),this.ge(e,t)}},{key:"ge",value:function(e,t){t.he(e)}},{key:"we",value:function(e,t){var n=e.fields||{};this.ce(t,55);for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r];this.le(a,t),this.oe(n[a],t)}}},{key:"me",value:function(e,t){var n=e.values||[];this.ce(t,50);var r,i=Hg(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.oe(a,t)}}catch(o){i.e(o)}finally{i.f()}}},{key:"_e",value:function(e,t){var n=this;this.ce(t,37),Pq.fromName(e).path.forEach(function(e){n.ce(t,60),n.ge(e,t)})}},{key:"ce",value:function(e,t){e.ae(t)}},{key:"fe",value:function(e){e.ae(2)}}]),e}();UY.ye=new UY;var VY=function(){function e(){Zg(this,e),this.ze=new BY}return Wg(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.ze.add(t),Mq.resolve()}},{key:"getCollectionParents",value:function(e,t){return Mq.resolve(this.ze.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return Mq.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return Mq.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return Mq.resolve(null)}},{key:"getIndexType",value:function(e,t){return Mq.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return Mq.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return Mq.resolve(null)}},{key:"getMinOffset",value:function(e,t){return Mq.resolve(Oq.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return Mq.resolve(Oq.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return Mq.resolve()}},{key:"updateIndexEntries",value:function(e,t){return Mq.resolve()}}]),e}(),BY=function(){function e(){Zg(this,e),this.index={}}return Wg(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new zq(_q.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new zq(_q.comparator)).toArray()}}]),e}();new Uint8Array(0);var zY=function(){function e(t,n,r){Zg(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return Wg(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();zY.DEFAULT_COLLECTION_PERCENTILE=10,zY.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zY.DEFAULT=new zY(41943040,zY.DEFAULT_COLLECTION_PERCENTILE,zY.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zY.DISABLED=new zY(-1,0,0);var HY=function(){function e(t){Zg(this,e),this.En=t}return Wg(e,[{key:"next",value:function(){return this.En+=2,this.En}}],[{key:"An",value:function(){return new e(0)}},{key:"Rn",value:function(){return new e(-1)}}]),e}(),GY=Wg(function e(t,n){Zg(this,e),this.overlayedDocument=t,this.mutatedFields=n}),$Y=function(){function e(t,n,r,i){Zg(this,e),this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}return Wg(e,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next(function(i){return r=i,n.getBaseDocument(e,t,r)}).next(function(e){return null!==r&&wj(r.mutation,e,Gq.empty(),kq.now()),e})}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return n.getLocalViewOfDocuments(e,t,Wj()).next(function(){return t})})}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Wj(),i=Hj();return this.populateOverlays(e,i,t).next(function(){return n.computeViews(e,t,i,r).next(function(e){var t=Bj();return e.forEach(function(e,n){t=t.insert(e,n.overlayedDocument)}),t})})}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=Hj();return this.populateOverlays(e,r,t).next(function(){return n.computeViews(e,t,r,Wj())})}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach(function(e){t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(function(e){e.forEach(function(e,n){t.set(e,n)})})}},{key:"computeViews",value:function(e,t,n,r){var i=Uj(),a=$j(),o=$j();return t.forEach(function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Pj)?i=i.insert(t.key,t):void 0!==o&&(a.set(t.key,o.mutation.getFieldMask()),wj(o.mutation,t,o.mutation.getFieldMask(),kq.now()))}),this.recalculateAndSaveOverlays(e,i).next(function(e){return e.forEach(function(e,t){return a.set(e,t)}),t.forEach(function(e,t){var n;return o.set(e,new GY(t,null!==(n=a.get(e))&&void 0!==n?n:null))}),o})}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=$j(),i=new Uq(function(e,t){return e-t}),a=Wj();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(function(e){var n,a=Hg(e);try{var o=function(){var e=n.value;e.keys().forEach(function(n){var a=t.get(n);if(null!==a){var o=r.get(n)||Gq.empty();o=e.applyToLocalView(a,o),r.set(n,o);var s=(i.get(e.batchId)||Wj()).add(n);i=i.insert(e.batchId,s)}})};for(a.s();!(n=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}}).next(function(){for(var o=[],s=i.getReverseIterator(),u=function(){var i=s.getNext(),u=i.key,c=i.value,l=Gj();c.forEach(function(e){if(!a.has(e)){var n=kj(t.get(e),r.get(e));null!==n&&l.set(e,n),a=a.add(e)}}),o.push(n.documentOverlayCache.saveOverlays(e,u,l))};s.hasNext();)u();return Mq.waitFor(o)}).next(function(){return r})}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return n.recalculateAndSaveOverlays(e,t)})}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return Pq.isDocumentKey((r=t).path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):$W(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var r}},{key:"getNextDocuments",value:function(e,t,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(function(a){var o=r-a.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):Mq.resolve(Hj()),s=-1,u=a;return o.next(function(t){return Mq.forEach(t,function(t,n){return s<n.largestBatchId&&(s=n.largestBatchId),a.get(t)?Mq.resolve():i.getBaseDocument(e,t,n).next(function(e){u=u.insert(t,e)})}).next(function(){return i.populateOverlays(e,t,a)}).next(function(){return i.computeViews(e,u,t,Wj())}).next(function(e){return{batchId:s,changes:zj(e)}})})})}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new Pq(t)).next(function(e){var t=Bj();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,i=t.collectionGroup,a=Bj();return this.indexManager.getCollectionParents(e,i).next(function(o){return Mq.forEach(o,function(o){var s,u,c=(s=t,u=o.child(i),new BW(u,null,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt));return r.getDocumentsMatchingCollectionQuery(e,c,n).next(function(e){e.forEach(function(e,t){a=a.insert(e,t)})})}).next(function(){return a})})}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,i=this;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next(function(a){return r=a,i.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId)}).next(function(e){e.forEach(function(e,t){var n=t.getKey();null===r.get(n)&&(r=r.insert(n,CW.newInvalidDocument(n)))});var n=Bj();return r.forEach(function(r,i){var a=e.get(r);void 0!==a&&wj(a.mutation,i,Gq.empty(),kq.now()),QW(t,i)&&(n=n.insert(r,i))}),n})}},{key:"getBaseDocument",value:function(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):Mq.resolve(CW.newInvalidDocument(t))}}]),e}(),ZY=function(){function e(t){Zg(this,e),this.wt=t,this.Jn=new Map,this.Yn=new Map}return Wg(e,[{key:"getBundleMetadata",value:function(e,t){return Mq.resolve(this.Jn.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.Jn.set(t.id,{id:(n=t).id,version:n.version,createTime:fY(n.createTime)}),Mq.resolve()}},{key:"getNamedQuery",value:function(e,t){return Mq.resolve(this.Yn.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.Yn.set(t.name,{name:(n=t).name,query:FY(n.bundledQuery),readTime:fY(n.readTime)}),Mq.resolve();var n}}]),e}(),qY=function(){function e(){Zg(this,e),this.overlays=new Uq(Pq.comparator),this.Xn=new Map}return Wg(e,[{key:"getOverlay",value:function(e,t){return Mq.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=Hj();return Mq.forEach(t,function(t){return n.getOverlay(e,t).next(function(e){null!==e&&r.set(t,e)})}).next(function(){return r})}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach(function(n,i){r.ie(e,t,i)}),Mq.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.Xn.get(n);return void 0!==i&&(i.forEach(function(e){return r.overlays=r.overlays.remove(e)}),this.Xn.delete(n)),Mq.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=Hj(),i=t.length+1,a=new Pq(t.child("")),o=this.overlays.getIteratorFrom(a);o.hasNext();){var s=o.getNext().value,u=s.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&s.largestBatchId>n&&r.set(s.getKey(),s)}return Mq.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new Uq(function(e,t){return e-t}),a=this.overlays.getIterator();a.hasNext();){var o=a.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var s=i.get(o.largestBatchId);null===s&&(s=Hj(),i=i.insert(o.largestBatchId,s)),s.set(o.getKey(),o)}}for(var u=Hj(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach(function(e,t){return u.set(e,t)}),!(u.size()>=r)););return Mq.resolve(u)}},{key:"ie",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.Xn.get(r.largestBatchId).delete(n.key);this.Xn.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new NY(t,n));var a=this.Xn.get(t);void 0===a&&(a=Wj(),this.Xn.set(t,a)),this.Xn.set(t,a.add(n.key))}}]),e}(),WY=function(){function e(){Zg(this,e),this.Zn=new zq(jY.ts),this.es=new zq(jY.ns)}return Wg(e,[{key:"isEmpty",value:function(){return this.Zn.isEmpty()}},{key:"addReference",value:function(e,t){var n=new jY(e,t);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}},{key:"ss",value:function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})}},{key:"removeReference",value:function(e,t){this.rs(new jY(e,t))}},{key:"os",value:function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})}},{key:"us",value:function(e){var t=this,n=new Pq(new _q([])),r=new jY(n,e),i=new jY(n,e+1),a=[];return this.es.forEachInRange([r,i],function(e){t.rs(e),a.push(e.key)}),a}},{key:"cs",value:function(){var e=this;this.Zn.forEach(function(t){return e.rs(t)})}},{key:"rs",value:function(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}},{key:"hs",value:function(e){var t=new Pq(new _q([])),n=new jY(t,e),r=new jY(t,e+1),i=Wj();return this.es.forEachInRange([n,r],function(e){i=i.add(e.key)}),i}},{key:"containsKey",value:function(e){var t=new jY(e,0),n=this.Zn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),jY=function(){function e(t,n){Zg(this,e),this.key=t,this.ls=n}return Wg(e,null,[{key:"ts",value:function(e,t){return Pq.comparator(e.key,t.key)||yq(e.ls,t.ls)}},{key:"ns",value:function(e,t){return yq(e.ls,t.ls)||Pq.comparator(e.key,t.key)}}]),e}(),YY=function(){function e(t,n){Zg(this,e),this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new zq(jY.ts)}return Wg(e,[{key:"checkEmpty",value:function(e){return Mq.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.fs;this.fs++;var a=new MY(i,t,n,r);this.mutationQueue.push(a);var o,s=Hg(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.ds=this.ds.add(new jY(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast())}}catch(c){s.e(c)}finally{s.f()}return Mq.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return Mq.resolve(this._s(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this.ws(t+1),r=n<0?0:n;return Mq.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return Mq.resolve(0===this.mutationQueue.length?-1:this.fs-1)}},{key:"getAllMutationBatches",value:function(e){return Mq.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new jY(t,0),i=new jY(t,Number.POSITIVE_INFINITY),a=[];return this.ds.forEachInRange([r,i],function(e){var t=n._s(e.ls);a.push(t)}),Mq.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new zq(yq);return t.forEach(function(e){var t=new jY(e,0),i=new jY(e,Number.POSITIVE_INFINITY);n.ds.forEachInRange([t,i],function(e){r=r.add(e.ls)})}),Mq.resolve(this.gs(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;Pq.isDocumentKey(i)||(i=i.child(""));var a=new jY(new Pq(i),0),o=new zq(yq);return this.ds.forEachWhile(function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.ls)),!0)},a),Mq.resolve(this.gs(o))}},{key:"gs",value:function(e){var t=this,n=[];return e.forEach(function(e){var r=t._s(e);null!==r&&n.push(r)}),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;rq(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();var r=this.ds;return Mq.forEach(t.mutations,function(i){var a=new jY(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(function(){n.ds=r})}},{key:"In",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new jY(t,0),r=this.ds.firstAfterOrEqual(n);return Mq.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return Mq.resolve()}},{key:"ys",value:function(e,t){return this.ws(e)}},{key:"ws",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"_s",value:function(e){var t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),e}(),KY=function(){function e(t){Zg(this,e),this.ps=t,this.docs=new Uq(Pq.comparator),this.size=0}return Wg(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.ps(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return Mq.resolve(n?n.document.mutableCopy():CW.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=Uj();return t.forEach(function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():CW.newInvalidDocument(e))}),Mq.resolve(r)}},{key:"getAllFromCollection",value:function(e,t,n){for(var r=Uj(),i=new Pq(t.child("")),a=this.docs.getIteratorFrom(i);a.hasNext();){var o=a.getNext(),s=o.key,u=o.value.document;if(!t.isPrefixOf(s.path))break;s.path.length>t.length+1||Tq(Sq(u),n)<=0||(r=r.insert(u.key,u.mutableCopy()))}return Mq.resolve(r)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){nq()}},{key:"Is",value:function(e,t){return Mq.forEach(this.docs,function(e){return t(e)})}},{key:"newChangeBuffer",value:function(e){return new QY(this)}},{key:"getSize",value:function(e){return Mq.resolve(this.size)}}]),e}(),QY=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).zn=e,r}return Wg(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach(function(r,i){i.isValidDocument()?n.push(t.zn.addEntry(e,i)):t.zn.removeEntry(r)}),Mq.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.zn.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.zn.getEntries(e,t)}}]),n}(function(){function e(){Zg(this,e),this.changes=new Lj(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),this.changesApplied=!1}return Wg(e,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,CW.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?Mq.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}()),XY=function(){function e(t){Zg(this,e),this.persistence=t,this.Ts=new Lj(function(e){return EW(e)},bW),this.lastRemoteSnapshotVersion=Cq.min(),this.highestTargetId=0,this.Es=0,this.As=new WY,this.targetCount=0,this.Rs=HY.An()}return Wg(e,[{key:"forEachTarget",value:function(e,t){return this.Ts.forEach(function(e,n){return t(n)}),Mq.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return Mq.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return Mq.resolve(this.Es)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.Rs.next(),Mq.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Es&&(this.Es=t),Mq.resolve()}},{key:"vn",value:function(e){this.Ts.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Rs=new HY(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.vn(t),this.targetCount+=1,Mq.resolve()}},{key:"updateTargetData",value:function(e,t){return this.vn(t),Mq.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,Mq.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Ts.forEach(function(o,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.Ts.delete(o),a.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)}),Mq.waitFor(a).next(function(){return i})}},{key:"getTargetCount",value:function(e){return Mq.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Ts.get(t)||null;return Mq.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.As.ss(t,n),Mq.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.As.os(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.markPotentiallyOrphaned(e,t))}),Mq.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.As.us(t),Mq.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.As.hs(t);return Mq.resolve(n)}},{key:"containsKey",value:function(e,t){return Mq.resolve(this.As.containsKey(t))}}]),e}(),JY=function(){function e(t,n){var r=this;Zg(this,e),this.bs={},this.overlays={},this.Ps=new Nq(0),this.vs=!1,this.vs=!0,this.referenceDelegate=t(this),this.Vs=new XY(this),this.indexManager=new VY,this.remoteDocumentCache=new KY(function(e){return r.referenceDelegate.Ss(e)}),this.wt=new LY(n),this.Ds=new ZY(this.wt)}return Wg(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.vs=!1,Promise.resolve()}},{key:"started",get:function(){return this.vs}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new qY,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.bs[e.toKey()];return n||(n=new YY(t,this.referenceDelegate),this.bs[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Vs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.Ds}},{key:"runTransaction",value:function(e,t,n){var r=this;XZ("MemoryPersistence","Starting transaction:",e);var i=new eK(this.Ps.next());return this.referenceDelegate.Cs(),n(i).next(function(e){return r.referenceDelegate.xs(i).next(function(){return e})}).toPromise().then(function(e){return i.raiseOnCommittedEvent(),e})}},{key:"Ns",value:function(e,t){return Mq.or(Object.values(this.bs).map(function(n){return function(){return n.containsKey(e,t)}}))}}]),e}(),eK=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return Wg(n)}(function(){function e(){Zg(this,e),this.onCommittedListeners=[]}return Wg(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach(function(e){return e()})}}]),e}()),tK=function(){function e(t){Zg(this,e),this.persistence=t,this.ks=new WY,this.Os=null}return Wg(e,[{key:"Fs",get:function(){if(this.Os)return this.Os;throw nq()}},{key:"addReference",value:function(e,t,n){return this.ks.addReference(n,t),this.Fs.delete(n.toString()),Mq.resolve()}},{key:"removeReference",value:function(e,t,n){return this.ks.removeReference(n,t),this.Fs.add(n.toString()),Mq.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Fs.add(t.toString()),Mq.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.ks.us(t.targetId).forEach(function(e){return n.Fs.add(e.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return n.Fs.add(e.toString())})}).next(function(){return r.removeTargetData(e,t)})}},{key:"Cs",value:function(){this.Os=new Set}},{key:"xs",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Mq.forEach(this.Fs,function(r){var i=Pq.fromPath(r);return t.$s(e,i).next(function(e){e||n.removeEntry(i,Cq.min())})}).next(function(){return t.Os=null,n.apply(e)})}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.$s(e,t).next(function(e){e?n.Fs.delete(t.toString()):n.Fs.add(t.toString())})}},{key:"Ss",value:function(e){return 0}},{key:"$s",value:function(e,t){var n=this;return Mq.or([function(){return Mq.resolve(n.ks.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Ns(e,t)}])}}],[{key:"Ms",value:function(t){return new e(t)}}]),e}(),nK=function(){function e(t,n,r,i){Zg(this,e),this.targetId=t,this.fromCache=n,this.Pi=r,this.vi=i}return Wg(e,null,[{key:"Vi",value:function(t,n){var r,i=Wj(),a=Wj(),o=Hg(n.docChanges);try{for(o.s();!(r=o.n()).done;){var s=r.value;switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}}}catch(u){o.e(u)}finally{o.f()}return new e(t,n.fromCache,i,a)}}]),e}(),rK=function(){function e(){Zg(this,e),this.Si=!1}return Wg(e,[{key:"initialize",value:function(e,t){this.Di=e,this.indexManager=t,this.Si=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this;return this.Ci(e,t).next(function(a){return a||i.xi(e,t,r,n)}).next(function(n){return n||i.Ni(e,t)})}},{key:"Ci",value:function(e,t){return Mq.resolve(null)}},{key:"xi",value:function(e,t,n,r){var i=this;return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||r.isEqual(Cq.min())?this.Ni(e,t):this.Di.getDocuments(e,n).next(function(a){var o=i.ki(t,a);return i.Oi(t,o,n,r)?i.Ni(e,t):(QZ()<=WB.DEBUG&&XZ("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),KW(t)),i.Mi(e,o,t,function(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Cq.fromTimestamp(1e9===r?new kq(n+1,0):new kq(n,r));return new Oq(i,Pq.empty(),-1)}(r)))})}},{key:"ki",value:function(e,t){var n=new zq(XW(e));return t.forEach(function(t,r){QW(e,r)&&(n=n.add(r))}),n}},{key:"Oi",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Ni",value:function(e,t){return QZ()<=WB.DEBUG&&XZ("QueryEngine","Using full collection scan to execute query:",KW(t)),this.Di.getDocumentsMatchingQuery(e,t,Oq.min())}},{key:"Mi",value:function(e,t,n,r){return this.Di.getDocumentsMatchingQuery(e,n,r).next(function(e){return t.forEach(function(t){e=e.insert(t.key,t)}),e})}}]),e}(),iK=function(){function e(t,n,r,i){Zg(this,e),this.persistence=t,this.Fi=n,this.wt=i,this.$i=new Uq(yq),this.Bi=new Lj(function(e){return EW(e)},bW),this.Li=new Map,this.Ui=t.getRemoteDocumentCache(),this.Vs=t.getTargetCache(),this.Ds=t.getBundleCache(),this.qi(r)}return Wg(e,[{key:"qi",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new $Y(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return e.collect(n,t.$i)})}}]),e}();function aK(e,t){return oK.apply(this,arguments)}function oK(){return oK=aB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=iq(t),e.next=3,r.persistence.runTransaction("Handle user change","readonly",function(e){var t;return r.mutationQueue.getAllMutationBatches(e).next(function(i){return t=i,r.qi(n),r.mutationQueue.getAllMutationBatches(e)}).next(function(n){var i,a=[],o=[],s=Wj(),u=Hg(t);try{for(u.s();!(i=u.n()).done;){var c=i.value;a.push(c.batchId);var l,f=Hg(c.mutations);try{for(f.s();!(l=f.n()).done;){var h=l.value;s=s.add(h.key)}}catch(k){f.e(k)}finally{f.f()}}}catch(k){u.e(k)}finally{u.f()}var d,v=Hg(n);try{for(v.s();!(d=v.n()).done;){var p=d.value;o.push(p.batchId);var g,y=Hg(p.mutations);try{for(y.s();!(g=y.n()).done;){var m=g.value;s=s.add(m.key)}}catch(k){y.e(k)}finally{y.f()}}}catch(k){v.e(k)}finally{v.f()}return r.localDocuments.getDocuments(e,s).next(function(e){return{Ki:e,removedBatchIds:a,addedBatchIds:o}})})});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)})),oK.apply(this,arguments)}function sK(e,t){var n=iq(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(e){var r,i,a,o,s,u,c,l=t.batch.keys(),f=n.Ui.newChangeBuffer({trackRemovals:!0});return(r=n,i=e,a=t,o=f,s=a.batch,u=s.keys(),c=Mq.resolve(),u.forEach(function(e){c=c.next(function(){return o.getEntry(i,e)}).next(function(t){var n=a.docVersions.get(e);rq(null!==n),t.version.compareTo(n)<0&&(s.applyToRemoteDocument(t,a),t.isValidDocument()&&(t.setReadTime(a.commitVersion),o.addEntry(t)))})}),c.next(function(){return r.mutationQueue.removeMutationBatch(i,s)})).next(function(){return f.apply(e)}).next(function(){return n.mutationQueue.performConsistencyCheck(e)}).next(function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,l,t.batch.batchId)}).next(function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=Wj(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))}).next(function(){return n.localDocuments.getDocuments(e,l)})})}function uK(e){var t=iq(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.Vs.getLastRemoteSnapshotVersion(e)})}function cK(e,t){var n=iq(e),r=t.snapshotVersion,i=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(e){var a=n.Ui.newChangeBuffer({trackRemovals:!0});i=n.$i;var o=[];t.targetChanges.forEach(function(a,s){var u=i.get(s);if(u){o.push(n.Vs.removeMatchingKeys(e,a.removedDocuments,s).next(function(){return n.Vs.addMatchingKeys(e,a.addedDocuments,s)}));var c,l,f,h=u.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(s)?h=h.withResumeToken($q.EMPTY_BYTE_STRING,Cq.min()).withLastLimboFreeSnapshotVersion(Cq.min()):a.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(a.resumeToken,r)),i=i.insert(s,h),l=h,f=a,(0===(c=u).resumeToken.approximateByteSize()||l.snapshotVersion.toMicroseconds()-c.snapshotVersion.toMicroseconds()>=3e8||f.addedDocuments.size+f.modifiedDocuments.size+f.removedDocuments.size>0)&&o.push(n.Vs.updateTargetData(e,h))}});var s=Uj(),u=Wj();if(t.documentUpdates.forEach(function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(function(e,t,n){var r=Wj(),i=Wj();return n.forEach(function(e){return r=r.add(e)}),t.getEntries(e,r).next(function(e){var r=Uj();return n.forEach(function(n,a){var o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(Cq.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):XZ("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)}),{Gi:r,Qi:i}})}(e,a,t.documentUpdates).next(function(e){s=e.Gi,u=e.Qi})),!r.isEqual(Cq.min())){var c=n.Vs.getLastRemoteSnapshotVersion(e).next(function(t){return n.Vs.setTargetsMetadata(e,e.currentSequenceNumber,r)});o.push(c)}return Mq.waitFor(o).next(function(){return a.apply(e)}).next(function(){return n.localDocuments.getLocalViewOfDocuments(e,s,u)}).next(function(){return s})}).then(function(e){return n.$i=i,e})}function lK(e,t){var n=iq(e);return n.persistence.runTransaction("Get next mutation batch","readonly",function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)})}function fK(e,t){var n=iq(e);return n.persistence.runTransaction("Allocate target","readwrite",function(e){var r;return n.Vs.getTargetData(e,t).next(function(i){return i?(r=i,Mq.resolve(r)):n.Vs.allocateTargetId(e).next(function(i){return r=new DY(t,i,0,e.currentSequenceNumber),n.Vs.addTargetData(e,r).next(function(){return r})})})}).then(function(e){var r=n.$i.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.$i=n.$i.insert(e.targetId,e),n.Bi.set(t,e.targetId)),e})}function hK(e,t,n){return dK.apply(this,arguments)}function dK(){return dK=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=iq(t),a=i.$i.get(n),o=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,i.persistence.runTransaction("Release target",o,function(e){return i.persistence.referenceDelegate.removeTarget(e,a)});case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),xq(e.t1)){e.next=12;break}throw e.t1;case 12:XZ("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:i.$i=i.$i.remove(n),i.Bi.delete(a.target);case 14:case"end":return e.stop()}},e,null,[[1,8]])})),dK.apply(this,arguments)}function vK(e,t,n){var r=iq(e),i=Cq.min(),a=Wj();return r.persistence.runTransaction("Execute query","readonly",function(e){return(o=r,s=e,u=qW(t),c=iq(o),l=c.Bi.get(u),void 0!==l?Mq.resolve(c.$i.get(l)):c.Vs.getTargetData(s,u)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(e,t.targetId).next(function(e){a=e})}).next(function(){return r.Fi.getDocumentsMatchingQuery(e,t,n?i:Cq.min(),n?a:Wj())}).next(function(e){return function(e,t,n){var r=Cq.min();n.forEach(function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Li.set(t,r)}(r,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,ji:a}});var o,s,u,c,l})}var pK=function(){function e(){Zg(this,e),this.activeTargetIds=Yj()}return Wg(e,[{key:"Xi",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"Zi",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"Yi",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),gK=function(){function e(){Zg(this,e),this.Fr=new pK,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return Wg(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.$r[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Fr.Zi(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.$r[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Fr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Fr=new pK,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),e}(),yK=function(){function e(){Zg(this,e)}return Wg(e,[{key:"Br",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),mK=function(){function e(){var t=this;Zg(this,e),this.Lr=function(){return t.Ur()},this.qr=function(){return t.Kr()},this.Gr=[],this.Qr()}return Wg(e,[{key:"Br",value:function(e){this.Gr.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}},{key:"Qr",value:function(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}},{key:"Ur",value:function(){XZ("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=Hg(this.Gr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"Kr",value:function(){XZ("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=Hg(this.Gr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"V",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),kK={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},CK=function(){function e(t){Zg(this,e),this.jr=t.jr,this.Wr=t.Wr}return Wg(e,[{key:"zr",value:function(e){this.Hr=e}},{key:"Jr",value:function(e){this.Yr=e}},{key:"onMessage",value:function(e){this.Xr=e}},{key:"close",value:function(){this.Wr()}},{key:"send",value:function(e){this.jr(e)}},{key:"Zr",value:function(){this.Hr()}},{key:"eo",value:function(e){this.Yr(e)}},{key:"no",value:function(e){this.Xr(e)}}]),e}(),wK=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r}return Wg(n,[{key:"co",value:function(e,t,n,r){return new Promise(function(i,a){var o=new qZ;o.listenOnce(zZ.COMPLETE,function(){try{switch(o.getLastErrorCode()){case BZ.NO_ERROR:var t=o.getResponseJson();XZ("Connection","XHR received:",JSON.stringify(t)),i(t);break;case BZ.TIMEOUT:XZ("Connection",'RPC "'+e+'" timed out'),a(new oq(aq.DEADLINE_EXCEEDED,"Request time out"));break;case BZ.HTTP_ERROR:var n=o.getStatus();if(XZ("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson().error;if(r&&r.status&&r.message){var s=(u=r.status,c=u.toLowerCase().replace(/_/g,"-"),Object.values(aq).indexOf(c)>=0?c:aq.UNKNOWN);a(new oq(s,r.message))}else a(new oq(aq.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new oq(aq.UNAVAILABLE,"Connection failed."));break;default:nq()}}finally{XZ("Connection",'RPC "'+e+'" completed.')}var u,c});var s=JSON.stringify(r);o.send(t,"POST",s,n,15)})}},{key:"ho",value:function(e,t,n){var r=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=UZ(),a=VZ(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new $Z({})),this.uo(o.initMessageHeaders,t,n),wB()||EB()||CB().indexOf("Electron/")>=0||bB()||CB().indexOf("MSAppHost/")>=0||_B()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=r.join("");XZ("Connection","Creating WebChannel: "+s,o);var u=i.createWebChannel(s,o),c=!1,l=!1,f=new CK({jr:function(e){l?XZ("Connection","Not sending because WebChannel is closed:",e):(c||(XZ("Connection","Opening WebChannel transport."),u.open(),c=!0),XZ("Connection","WebChannel sending:",e),u.send(e))},Wr:function(){return u.close()}}),h=function(e,t,n){e.listen(t,function(e){try{n(e)}catch(t){setTimeout(function(){throw t},0)}})};return h(u,ZZ.EventType.OPEN,function(){l||XZ("Connection","WebChannel transport opened.")}),h(u,ZZ.EventType.CLOSE,function(){l||(l=!0,XZ("Connection","WebChannel transport closed"),f.eo())}),h(u,ZZ.EventType.ERROR,function(e){l||(l=!0,eq("Connection","WebChannel transport errored:",e),f.eo(new oq(aq.UNAVAILABLE,"The operation could not be completed")))}),h(u,ZZ.EventType.MESSAGE,function(e){var t;if(!l){var n=e.data[0];rq(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){XZ("Connection","WebChannel received error:",i);var a=i.status,o=function(e){var t=Ij[e];if(void 0!==t)return Dj(t)}(a),s=i.message;void 0===o&&(o=aq.INTERNAL,s="Unknown error status: "+a+" with message "+i.message),l=!0,f.eo(new oq(o,s)),u.close()}else XZ("Connection","WebChannel received:",n),f.no(n)}}),h(a,HZ.STAT_EVENT,function(e){e.stat===GZ.PROXY?XZ("Connection","Detected buffering proxy"):e.stat===GZ.NOPROXY&&XZ("Connection","Detected no buffering proxy")}),setTimeout(function(){f.Zr()},0),f}}]),n}(function(){function e(t){Zg(this,e),this.databaseInfo=t,this.databaseId=t.databaseId,this.so=(t.ssl?"https":"http")+"://"+t.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return Wg(e,[{key:"ro",value:function(e,t,n,r,i){var a=this.oo(e,t);XZ("RestConnection","Sending: ",a,n);var o={};return this.uo(o,r,i),this.co(e,a,o,n).then(function(e){return XZ("RestConnection","Received: ",e),e},function(t){throw eq("RestConnection","".concat(e," failed with error: "),t,"url: ",a,"request:",n),t})}},{key:"ao",value:function(e,t,n,r,i,a){return this.ro(e,t,n,r,i)}},{key:"uo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+YZ,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(function(t,n){return e[n]=t}),n&&n.headers.forEach(function(t,n){return e[n]=t})}},{key:"oo",value:function(e,t){return"".concat(this.so,"/v1/").concat(t,":").concat(kK[e])}}]),e}());function _K(){return"undefined"!=typeof document?document:null}function EK(e){return new sY(e,!0)}var bK=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;Zg(this,e),this.js=t,this.timerId=n,this.lo=r,this.fo=i,this._o=a,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}return Wg(e,[{key:"reset",value:function(){this.wo=0}},{key:"po",value:function(){this.wo=this._o}},{key:"Io",value:function(e){var t=this;this.cancel();var n=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),i=Math.max(0,n-r);i>0&&XZ("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.wo," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.mo=this.js.enqueueAfterDelay(this.timerId,i,function(){return t.yo=Date.now(),e()}),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}},{key:"Eo",value:function(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}},{key:"cancel",value:function(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}},{key:"To",value:function(){return(Math.random()-.5)*this.wo}}]),e}(),PK=function(){function e(t,n,r,i,a,o,s,u){Zg(this,e),this.js=t,this.Ao=r,this.Ro=i,this.bo=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=u,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new bK(t,n)}return Wg(e,[{key:"Do",value:function(){return 1===this.state||5===this.state||this.Co()}},{key:"Co",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.xo()}},{key:"stop",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.Do(),!t.t0){t.next=4;break}return t.next=4,e.close(0);case 4:case"end":return t.stop()}},t)}))()}},{key:"No",value:function(){this.state=0,this.So.reset()}},{key:"ko",value:function(){var e=this;this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,function(){return e.Oo()}))}},{key:"Mo",value:function(e){this.Fo(),this.stream.send(e)}},{key:"Oo",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.Co()){t.next=2;break}return t.abrupt("return",e.close(0));case 2:case"end":return t.stop()}},t)}))()}},{key:"Fo",value:function(){this.vo&&(this.vo.cancel(),this.vo=null)}},{key:"$o",value:function(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}},{key:"close",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n.Fo(),n.$o(),n.So.cancel(),n.Po++,4!==e?n.So.reset():t&&t.code===aq.RESOURCE_EXHAUSTED?(JZ(t.toString()),JZ("Using maximum backoff delay to prevent overloading the backend."),n.So.po()):t&&t.code===aq.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Bo(),n.stream.close(),n.stream=null),n.state=e,r.next=9,n.listener.Jr(t);case 9:case"end":return r.stop()}},r)}))()}},{key:"Bo",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(function(t){var r=Sg(t,2),i=r[0],a=r[1];e.Po===n&&e.Uo(i,a)},function(n){t(function(){var t=new oq(aq.UNKNOWN,"Fetching auth token failed: "+n.message);return e.qo(t)})})}},{key:"Uo",value:function(e,t){var n=this,r=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr(function(){r(function(){return n.state=2,n.Vo=n.js.enqueueAfterDelay(n.Ro,1e4,function(){return n.Co()&&(n.state=3),Promise.resolve()}),n.listener.zr()})}),this.stream.Jr(function(e){r(function(){return n.qo(e)})}),this.stream.onMessage(function(e){r(function(){return n.onMessage(e)})})}},{key:"xo",value:function(){var e=this;this.state=5,this.So.Io(aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}},t)})))}},{key:"qo",value:function(e){return XZ("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Lo",value:function(e){var t=this;return function(n){t.js.enqueueAndForget(function(){return t.Po===e?n():(XZ("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}}}]),e}(),SK=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,a,s)).wt=o,u}return Wg(n,[{key:"Ko",value:function(e,t){return this.bo.ho("Listen",e,t)}},{key:"onMessage",value:function(e){this.So.reset();var t=function(e,t){var n,r;if("targetChange"in t){var i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:nq(),a=t.targetChange.targetIds||[],o=function(e,t){return e.dt?(rq(void 0===t||"string"==typeof t),$q.fromBase64String(t||"")):(rq(void 0===t||t instanceof Uint8Array),$q.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,u=s&&function(e){var t=void 0===e.code?aq.UNKNOWN:Dj(e.code);return new oq(t,e.message||"")}(s);n=new eY(i,a,o,u||null)}else if("documentChange"in t){var c=t.documentChange,l=pY(e,c.document.name),f=fY(c.document.updateTime),h=new mW({mapValue:{fields:c.document.fields}}),d=CW.newFoundDocument(l,f,h);n=new Xj(c.targetIds||[],c.removedTargetIds||[],d.key,d)}else if("documentDelete"in t){var v=t.documentDelete,p=pY(e,v.document),g=v.readTime?fY(v.readTime):Cq.min(),y=CW.newNoDocument(p,g);n=new Xj([],v.removedTargetIds||[],y.key,y)}else if("documentRemove"in t){var m=t.documentRemove,k=pY(e,m.document);n=new Xj([],m.removedTargetIds||[],k,null)}else{if(!("filter"in t))return nq();var C=t.filter,w=new xj(C.count||0);n=new Jj(C.targetId,w)}return n}(this.wt,e),n=function(e){if(!("targetChange"in e))return Cq.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?Cq.min():t.readTime?fY(t.readTime):Cq.min()}(e);return this.listener.Go(t,n)}},{key:"Qo",value:function(e){var t,n,r,i,a={};a.database=yY(this.wt),a.addTarget=(t=this.wt,i=(n=e).target,(r=PW(i)?{documents:CY(t,i)}:{query:wY(t,i)}).targetId=n.targetId,n.resumeToken.approximateByteSize()>0?r.resumeToken=cY(t,n.resumeToken):n.snapshotVersion.compareTo(Cq.min())>0&&(r.readTime=uY(t,n.snapshotVersion.toTimestamp())),r);var o=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return nq()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);o&&(a.labels=o),this.Mo(a)}},{key:"jo",value:function(e){var t={};t.database=yY(this.wt),t.removeTarget=e,this.Mo(t)}}]),n}(PK),OK=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,a,s)).wt=o,u.Wo=!1,u}return Wg(n,[{key:"zo",get:function(){return this.Wo}},{key:"start",value:function(){this.Wo=!1,this.lastStreamToken=void 0,Rg(Vg(n.prototype),"start",this).call(this)}},{key:"Bo",value:function(){this.Wo&&this.Ho([])}},{key:"Ko",value:function(e,t){return this.bo.ho("Write",e,t)}},{key:"onMessage",value:function(e){if(rq(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();var t=function(e,t){return e&&e.length>0?(rq(void 0!==t),e.map(function(e){return function(e,t){var n=fY(e.updateTime?e.updateTime:t);return n.isEqual(Cq.min())&&(n=fY(t)),new pj(n,e.transformResults||[])}(e,t)})):[]}(e.writeResults,e.commitTime),n=fY(e.commitTime);return this.listener.Jo(n,t)}return rq(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}},{key:"Xo",value:function(){var e={};e.database=yY(this.wt),this.Mo(e)}},{key:"Ho",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map(function(e){return function(e,t){var n,r;if(t instanceof bj)n={update:kY(e,t.key,t.value)};else if(t instanceof Rj)n={delete:vY(e,t.key)};else if(t instanceof Pj)n={update:kY(e,t.key,t.data),updateMask:AY(t.fieldMask)};else{if(!(t instanceof Mj))return nq();n={verify:vY(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(function(e){return function(e,t){var n=t.transform;if(n instanceof oj)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof sj)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof cj)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof fj)return{fieldPath:t.field.canonicalString(),increment:n._t};throw nq()}(0,e)})),t.precondition.isNone||(n.currentDocument=void 0!==(r=t.precondition).updateTime?{updateTime:lY(e,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:nq()),n}(t.wt,e)})};this.Mo(n)}}]),n}(PK),TK=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.bo=i,o.wt=a,o.Zo=!1,o}return Wg(n,[{key:"tu",value:function(){if(this.Zo)throw new oq(aq.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"ro",value:function(e,t,n){var r=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(i){var a=Sg(i,2),o=a[0],s=a[1];return r.bo.ro(e,t,n,o,s)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===aq.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new oq(aq.UNKNOWN,e.toString())})}},{key:"ao",value:function(e,t,n,r){var i=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(a){var o=Sg(a,2),s=o[0],u=o[1];return i.bo.ao(e,t,n,s,u,r)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===aq.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),e):new oq(aq.UNKNOWN,e.toString())})}},{key:"terminate",value:function(){this.Zo=!0}}]),n}(function(){return Wg(function e(){Zg(this,e)})}()),IK=function(){function e(t,n){Zg(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}return Wg(e,[{key:"iu",value:function(){var e=this;0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return e.nu=null,e.ou("Backend didn't respond within 10 seconds."),e.ru("Offline"),Promise.resolve()}))}},{key:"uu",value:function(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ru("Offline")))}},{key:"set",value:function(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}},{key:"ru",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"ou",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.su?(JZ(t),this.su=!1):XZ("OnlineStateTracker",t)}},{key:"cu",value:function(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}]),e}(),AK=Wg(function e(t,n,r,i,a){Zg(this,e);var o=this;this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=a,this.du.Br(function(e){r.enqueueAndForget(aB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=zK(o),!e.t0){e.next=5;break}return XZ("RemoteStore","Restarting streams for network reachability change."),e.next=5,(t=aB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=iq(t)).lu.add(4),e.next=4,xK(n);case 4:return n._u.set("Unknown"),n.lu.delete(4),e.next=8,RK(n);case 8:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})(o);case 5:case"end":return e.stop()}},e)})))}),this._u=new IK(r,i)});function RK(e){return MK.apply(this,arguments)}function MK(){return MK=aB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!zK(t)){e.next=18;break}n=Hg(t.fu),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}},e,null,[[2,12,15,18]])})),MK.apply(this,arguments)}function xK(e){return NK.apply(this,arguments)}function NK(){return NK=aB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Hg(t.fu),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,i(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[1,11,14,17]])})),NK.apply(this,arguments)}function DK(e,t){var n=iq(e);n.hu.has(t.targetId)||(n.hu.set(t.targetId,t),BK(n)?VK(n):pQ(n).Co()&&FK(n,t))}function LK(e,t){var n=iq(e),r=pQ(n);n.hu.delete(t),r.Co()&&UK(n,t),0===n.hu.size&&(r.Co()?r.ko():zK(n)&&n._u.set("Unknown"))}function FK(e,t){e.wu.Nt(t.targetId),pQ(e).Qo(t)}function UK(e,t){e.wu.Nt(t),pQ(e).jo(t)}function VK(e){e.wu=new nY({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},te:function(t){return e.hu.get(t)||null}}),pQ(e).start(),e._u.iu()}function BK(e){return zK(e)&&!pQ(e).Do()&&e.hu.size>0}function zK(e){return 0===iq(e).lu.size}function HK(e){e.wu=void 0}function GK(e){return $K.apply(this,arguments)}function $K(){return $K=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.hu.forEach(function(e,n){FK(t,e)});case 1:case"end":return e.stop()}},e)})),$K.apply(this,arguments)}function ZK(e,t){return qK.apply(this,arguments)}function qK(){return qK=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:HK(t),BK(t)?(t._u.uu(n),VK(t)):t._u.set("Unknown");case 1:case"end":return e.stop()}},e)})),qK.apply(this,arguments)}function WK(e,t,n){return jK.apply(this,arguments)}function jK(){return jK=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t._u.set("Online"),!(n instanceof eY&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,(a=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,i=Hg(n.targetIds),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=14;break}if(o=a.value,e.t0=t.hu.has(o),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(o,r);case 10:t.hu.delete(o),t.wu.removeTarget(o);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:case"end":return e.stop()}},e,null,[[2,16,19,22]])})),function(e,t){return a.apply(this,arguments)})(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),XZ("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,YK(t,e.t0);case 11:case 22:e.next=29;break;case 13:if(n instanceof Xj?t.wu.Ut(n):n instanceof Jj?t.wu.zt(n):t.wu.Gt(n),r.isEqual(Cq.min())){e.next=29;break}return e.prev=14,e.next=17,uK(t.localStore);case 17:if(i=e.sent,e.t1=r.compareTo(i)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.wu.Yt(t);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.hu.get(r);i&&e.hu.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(function(t){var n=e.hu.get(t);if(n){e.hu.set(t,n.withResumeToken($q.EMPTY_BYTE_STRING,n.snapshotVersion)),UK(e,t);var r=new DY(n.target,t,1,n.sequenceNumber);FK(e,r)}}),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 24:return e.prev=24,e.t2=e.catch(14),XZ("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,YK(t,e.t2);case 29:case"end":return e.stop()}},e,null,[[1,6],[14,24]])})),jK.apply(this,arguments)}function YK(e,t,n){return KK.apply(this,arguments)}function KK(){return KK=aB(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(xq(n)){e.next=2;break}throw n;case 2:return t.lu.add(1),e.next=5,xK(t);case 5:t._u.set("Offline"),r||(r=function(){return uK(t.localStore)}),t.asyncQueue.enqueueRetryable(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return XZ("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.lu.delete(1),e.next=6,RK(t);case 6:case"end":return e.stop()}},e)})));case 8:case"end":return e.stop()}},e)})),KK.apply(this,arguments)}function QK(e,t){return t().catch(function(n){return YK(e,n,t)})}function XK(e){return JK.apply(this,arguments)}function JK(){return JK=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=iq(t),r=gQ(n),i=n.au.length>0?n.au[n.au.length-1].batchId:-1;case 2:if(!eQ(n)){e.next=19;break}return e.prev=3,e.next=6,lK(n.localStore,i);case 6:if(null!==(a=e.sent)){e.next=10;break}return 0===n.au.length&&r.ko(),e.abrupt("break",19);case 10:i=a.batchId,tQ(n,a),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,YK(n,e.t0);case 17:e.next=2;break;case 19:nQ(n)&&rQ(n);case 20:case"end":return e.stop()}},e,null,[[3,13]])})),JK.apply(this,arguments)}function eQ(e){return zK(e)&&e.au.length<10}function tQ(e,t){e.au.push(t);var n=gQ(e);n.Co()&&n.zo&&n.Ho(t.mutations)}function nQ(e){return zK(e)&&!gQ(e).Do()&&e.au.length>0}function rQ(e){gQ(e).start()}function iQ(e){return aQ.apply(this,arguments)}function aQ(){return aQ=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:gQ(t).Xo();case 1:case"end":return e.stop()}},e)})),aQ.apply(this,arguments)}function oQ(e){return sQ.apply(this,arguments)}function sQ(){return sQ=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=gQ(t),r=Hg(t.au);try{for(r.s();!(i=r.n()).done;)a=i.value,n.Ho(a.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}},e)})),sQ.apply(this,arguments)}function uQ(e,t,n){return cQ.apply(this,arguments)}function cQ(){return cQ=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.au.shift(),a=xY.from(i,n,r),e.next=3,QK(t,function(){return t.remoteSyncer.applySuccessfulWrite(a)});case 3:return e.next=5,XK(t);case 5:case"end":return e.stop()}},e)})),cQ.apply(this,arguments)}function lQ(e,t){return fQ.apply(this,arguments)}function fQ(){return fQ=aB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&gQ(t).zo,!e.t0){e.next=4;break}return e.next=4,(r=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!Nj(i=n.code)||i===aq.ABORTED){e.next=7;break}return r=t.au.shift(),gQ(t).No(),e.next=5,QK(t,function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)});case 5:return e.next=7,XK(t);case 7:case"end":return e.stop()}},e)})),function(e,t){return r.apply(this,arguments)})(t,n);case 4:nQ(t)&&rQ(t);case 5:case"end":return e.stop()}},e)})),fQ.apply(this,arguments)}function hQ(e,t){return dQ.apply(this,arguments)}function dQ(){return dQ=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=iq(t)).asyncQueue.verifyOperationInProgress(),XZ("RemoteStore","RemoteStore received new credentials"),i=zK(r),r.lu.add(3),e.next=6,xK(r);case 6:return i&&r._u.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.lu.delete(3),e.next=12,RK(r);case 12:case"end":return e.stop()}},e)})),dQ.apply(this,arguments)}function vQ(){return vQ=aB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=iq(t),!n){e.next=7;break}return r.lu.delete(2),e.next=5,RK(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.lu.add(2),e.next=12,xK(r);case 12:r._u.set("Unknown");case 13:case"end":return e.stop()}},e)})),vQ.apply(this,arguments)}function pQ(e){return e.mu||(e.mu=(t=e.datastore,n=e.asyncQueue,r={zr:GK.bind(null,e),Jr:ZK.bind(null,e),Go:WK.bind(null,e)},(i=iq(t)).tu(),new SK(n,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)),e.fu.push(function(){var t=aB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.mu.No(),BK(e)?VK(e):e._u.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.mu.stop();case 6:HK(e);case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.mu;var t,n,r,i}function gQ(e){return e.gu||(e.gu=(t=e.datastore,n=e.asyncQueue,r={zr:iQ.bind(null,e),Jr:lQ.bind(null,e),Yo:oQ.bind(null,e),Jo:uQ.bind(null,e)},(i=iq(t)).tu(),new OK(n,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)),e.fu.push(function(){var t=aB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.gu.No(),t.next=4,XK(e);case 4:t.next=9;break;case 6:return t.next=8,e.gu.stop();case 8:e.au.length>0&&(XZ("RemoteStore","Stopping write stream with ".concat(e.au.length," pending writes")),e.au=[]);case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.gu;var t,n,r,i}var yQ=function(){function e(t,n,r,i,a){Zg(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new sq,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}return Wg(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new oq(aq.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)})}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}}]),e}();function mQ(e,t){if(JZ("AsyncQueue","".concat(t,": ").concat(e)),xq(e))return new oq(aq.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var kQ=function(){function e(t){Zg(this,e),this.comparator=t?function(e,n){return t(e,n)||Pq.comparator(e.key,n.key)}:function(e,t){return Pq.comparator(e.key,t.key)},this.keyedMap=Bj(),this.sortedSet=new Uq(this.comparator)}return Wg(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal(function(t,n){return e(t),!1})}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),CQ=function(){function e(){Zg(this,e),this.yu=new Uq(Pq.comparator)}return Wg(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.yu.get(t);n?0!==e.type&&3===n.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==n.type?this.yu=this.yu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.yu=this.yu.remove(t):1===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):nq():this.yu=this.yu.insert(t,e)}},{key:"pu",value:function(){var e=[];return this.yu.inorderTraversal(function(t,n){e.push(n)}),e}}]),e}(),wQ=function(){function e(t,n,r,i,a,o,s,u){Zg(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=u}return Wg(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&jW(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i){var a=[];return n.forEach(function(e){a.push({type:0,doc:e})}),new e(t,n,kQ.emptySet(n),a,r,i,!0,!1)}}]),e}(),_Q=Wg(function e(){Zg(this,e),this.Iu=void 0,this.listeners=[]}),EQ=Wg(function e(){Zg(this,e),this.queries=new Lj(function(e){return YW(e)},jW),this.onlineState="Unknown",this.Tu=new Set});function bQ(e,t){return PQ.apply(this,arguments)}function PQ(){return PQ=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=iq(t),i=n.query,a=!1,(o=r.queries.get(i))||(a=!0,o=new _Q),!a){e.next=13;break}return e.prev=3,e.next=6,r.onListen(i);case 6:o.Iu=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),s=mQ(e.t0,"Initialization of query '".concat(KW(n.query),"' failed")),e.abrupt("return",void n.onError(s));case 13:r.queries.set(i,o),o.listeners.push(n),n.Eu(r.onlineState),o.Iu&&n.Au(o.Iu)&&AQ(r);case 14:case"end":return e.stop()}},e,null,[[3,9]])})),PQ.apply(this,arguments)}function SQ(e,t){return OQ.apply(this,arguments)}function OQ(){return OQ=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=iq(t),i=n.query,a=!1,(o=r.queries.get(i))&&(s=o.listeners.indexOf(n))>=0&&(o.listeners.splice(s,1),a=0===o.listeners.length),!a){e.next=6;break}return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return e.stop()}},e)})),OQ.apply(this,arguments)}function TQ(e,t){var n,r=iq(e),i=!1,a=Hg(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=r.queries.get(o.query);if(s){var u,c=Hg(s.listeners);try{for(c.s();!(u=c.n()).done;){u.value.Au(o)&&(i=!0)}}catch(l){c.e(l)}finally{c.f()}s.Iu=o}}}catch(l){a.e(l)}finally{a.f()}i&&AQ(r)}function IQ(e,t,n){var r=iq(e),i=r.queries.get(t);if(i){var a,o=Hg(i.listeners);try{for(o.s();!(a=o.n()).done;){a.value.onError(n)}}catch(s){o.e(s)}finally{o.f()}}r.queries.delete(t)}function AQ(e){e.Tu.forEach(function(e){e.next()})}var RQ=function(){function e(t,n,r){Zg(this,e),this.query=t,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}return Wg(e,[{key:"Au",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=Hg(e.docChanges);try{for(r.s();!(t=r.n()).done;){var i=t.value;3!==i.type&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}e=new wQ(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var a=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),a=!0):this.Vu(e,this.onlineState)&&(this.Su(e),a=!0),this.Pu=e,a}},{key:"onError",value:function(e){this.Ru.error(e)}},{key:"Eu",value:function(e){this.onlineState=e;var t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}},{key:"Vu",value:function(e,t){return!e.fromCache||!(this.options.Du&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}},{key:"vu",value:function(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}},{key:"Su",value:function(e){e=wQ.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}]),e}(),MQ=Wg(function e(t){Zg(this,e),this.key=t}),xQ=Wg(function e(t){Zg(this,e),this.key=t}),NQ=function(){function e(t,n){Zg(this,e),this.query=t,this.Fu=n,this.$u=null,this.current=!1,this.Bu=Wj(),this.mutatedKeys=Wj(),this.Lu=XW(t),this.Uu=new kQ(this.Lu)}return Wg(e,[{key:"qu",get:function(){return this.Fu}},{key:"Ku",value:function(e,t){var n=this,r=t?t.Gu:new CQ,i=t?t.Uu:this.Uu,a=t?t.mutatedKeys:this.mutatedKeys,o=i,s=!1,u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(function(e,t){var l=i.get(e),f=QW(n.query,t)?t:null,h=!!l&&n.mutatedKeys.has(l.key),d=!!f&&(f.hasLocalMutations||n.mutatedKeys.has(f.key)&&f.hasCommittedMutations),v=!1;l&&f?l.data.isEqual(f.data)?h!==d&&(r.track({type:3,doc:f}),v=!0):n.Qu(l,f)||(r.track({type:2,doc:f}),v=!0,(u&&n.Lu(f,u)>0||c&&n.Lu(f,c)<0)&&(s=!0)):!l&&f?(r.track({type:0,doc:f}),v=!0):l&&!f&&(r.track({type:1,doc:l}),v=!0,(u||c)&&(s=!0)),v&&(f?(o=o.add(f),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))}),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Uu:o,Gu:r,Oi:s,mutatedKeys:a}}},{key:"Qu",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;var a=e.Gu.pu();a.sort(function(e,t){return n=e.type,i=t.type,(a=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return nq()}})(n)-a(i)||r.Lu(e.doc,t.doc);var n,i,a}),this.ju(n);var o=t?this.Wu():[],s=0===this.Bu.size&&this.current?1:0,u=s!==this.$u;return this.$u=s,0!==a.length||u?{snapshot:new wQ(this.query,e.Uu,i,a,e.mutatedKeys,0===s,u,!1),zu:o}:{zu:o}}},{key:"Eu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new CQ,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}},{key:"Hu",value:function(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}},{key:"ju",value:function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t.Fu=t.Fu.add(e)}),e.modifiedDocuments.forEach(function(e){}),e.removedDocuments.forEach(function(e){return t.Fu=t.Fu.delete(e)}),this.current=e.current)}},{key:"Wu",value:function(){var e=this;if(!this.current)return[];var t=this.Bu;this.Bu=Wj(),this.Uu.forEach(function(t){e.Hu(t.key)&&(e.Bu=e.Bu.add(t.key))});var n=[];return t.forEach(function(t){e.Bu.has(t)||n.push(new xQ(t))}),this.Bu.forEach(function(e){t.has(e)||n.push(new MQ(e))}),n}},{key:"Ju",value:function(e){this.Fu=e.ji,this.Bu=Wj();var t=this.Ku(e.documents);return this.applyChanges(t,!0)}},{key:"Yu",value:function(){return wQ.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}]),e}(),DQ=Wg(function e(t,n,r){Zg(this,e),this.query=t,this.targetId=n,this.view=r}),LQ=Wg(function e(t){Zg(this,e),this.key=t,this.Xu=!1}),FQ=function(){function e(t,n,r,i,a,o){Zg(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new Lj(function(e){return YW(e)},jW),this.ec=new Map,this.nc=new Set,this.sc=new Uq(Pq.comparator),this.ic=new Map,this.rc=new WY,this.oc={},this.uc=new Map,this.cc=HY.Rn(),this.onlineState="Unknown",this.ac=void 0}return Wg(e,[{key:"isPrimaryClient",get:function(){return!0===this.ac}}]),e}();function UQ(e,t){return VQ.apply(this,arguments)}function VQ(){return VQ=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=hX(t),!(o=r.tc.get(n))){e.next=6;break}i=o.targetId,r.sharedClientState.addLocalQueryTarget(i),a=o.view.Yu(),e.next=15;break;case 6:return e.next=8,fK(r.localStore,qW(n));case 8:return s=e.sent,r.isPrimaryClient&&DK(r.remoteStore,s),u=r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.targetId,e.next=14,BQ(r,n,i,"current"===u);case 14:a=e.sent;case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}},e)})),VQ.apply(this,arguments)}function BQ(e,t,n,r){return zQ.apply(this,arguments)}function zQ(){return zQ=aB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.hc=function(e,n,r){return(i=aB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.view.Ku(r),e.t0=a.Oi,!e.t0){e.next=6;break}return e.next=5,vK(t.localStore,n.query,!1).then(function(e){var t=e.documents;return n.view.Ku(t,a)});case 5:a=e.sent;case 6:return o=i&&i.targetChanges.get(n.targetId),s=n.view.applyChanges(a,t.isPrimaryClient,o),e.abrupt("return",(iX(t,n.targetId,s.zu),s.snapshot));case 8:case"end":return e.stop()}},e)})),function(e,t,n,r){return i.apply(this,arguments)})(t,e,n,r);var i},e.next=3,vK(t.localStore,n,!0);case 3:return a=e.sent,o=new NQ(n,a.ji),s=o.Ku(a.documents),u=Qj.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==t.onlineState),c=o.applyChanges(s,t.isPrimaryClient,u),iX(t,r,c.zu),l=new DQ(n,r,o),e.abrupt("return",(t.tc.set(n,l),t.ec.has(r)?t.ec.get(r).push(n):t.ec.set(r,[n]),c.snapshot));case 11:case"end":return e.stop()}},e)})),zQ.apply(this,arguments)}function HQ(e,t){return GQ.apply(this,arguments)}function GQ(){return GQ=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=iq(t),i=r.tc.get(n),!((a=r.ec.get(i.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r.ec.set(i.targetId,a.filter(function(e){return!jW(e,n)})),void r.tc.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),e.t0){e.next=9;break}return e.next=9,hK(r.localStore,i.targetId,!1).then(function(){r.sharedClientState.clearQueryState(i.targetId),LK(r.remoteStore,i.targetId),nX(r,i.targetId)}).catch(Aq);case 9:e.next=14;break;case 11:return nX(r,i.targetId),e.next=14,hK(r.localStore,i.targetId,!0);case 14:case"end":return e.stop()}},e)})),GQ.apply(this,arguments)}function $Q(){return $Q=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=dX(t),e.prev=1,e.next=4,function(e,t){var n,r,i=iq(e),a=kq.now(),o=t.reduce(function(e,t){return e.add(t.key)},Wj());return i.persistence.runTransaction("Locally write mutations","readwrite",function(e){var s=Uj(),u=Wj();return i.Ui.getEntries(e,o).next(function(e){(s=e).forEach(function(e,t){t.isValidDocument()||(u=u.add(e))})}).next(function(){return i.localDocuments.getOverlayedDocuments(e,s)}).next(function(r){n=r;var o,s=[],u=Hg(t);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=_j(c,n.get(c.key).overlayedDocument);null!=l&&s.push(new Pj(c.key,l,kW(l.value.mapValue),gj.exists(!0)))}}catch(f){u.e(f)}finally{u.f()}return i.mutationQueue.addMutationBatch(e,a,s,t)}).next(function(t){r=t;var a=t.applyToLocalDocumentSet(n,u);return i.documentOverlayCache.saveOverlays(e,t.batchId,a)})}).then(function(){return{batchId:r.batchId,changes:zj(n)}})}(i.localStore,n);case 4:return a=e.sent,i.sharedClientState.addPendingMutation(a.batchId),function(e,t,n){var r=e.oc[e.currentUser.toKey()];r||(r=new Uq(yq)),r=r.insert(t,n),e.oc[e.currentUser.toKey()]=r}(i,a.batchId,r),e.next=9,sX(i,a.changes);case 9:return e.next=11,XK(i.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),o=mQ(e.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return e.stop()}},e,null,[[1,13]])})),$Q.apply(this,arguments)}function ZQ(e,t){return qQ.apply(this,arguments)}function qQ(){return qQ=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=iq(t),e.prev=1,e.next=4,cK(r.localStore,n);case 4:return i=e.sent,n.targetChanges.forEach(function(e,t){var n=r.ic.get(t);n&&(rq(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.Xu=!0:e.modifiedDocuments.size>0?rq(n.Xu):e.removedDocuments.size>0&&(rq(n.Xu),n.Xu=!1))}),e.next=8,sX(r,i,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,Aq(e.t0);case 14:case"end":return e.stop()}},e,null,[[1,10]])})),qQ.apply(this,arguments)}function WQ(e,t,n){var r=iq(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.tc.forEach(function(e,n){var r=n.view.Eu(t);r.snapshot&&i.push(r.snapshot)}),function(e,t){var n=iq(e);n.onlineState=t;var r=!1;n.queries.forEach(function(e,n){var i,a=Hg(n.listeners);try{for(a.s();!(i=a.n()).done;){i.value.Eu(t)&&(r=!0)}}catch(o){a.e(o)}finally{a.f()}}),r&&AQ(n)}(r.eventManager,t),i.length&&r.Zu.Go(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function jQ(e,t,n){return YQ.apply(this,arguments)}function YQ(){return YQ=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((i=iq(t)).sharedClientState.updateQueryState(n,"rejected",r),a=i.ic.get(n),!(o=a&&a.key)){e.next=14;break}return s=(s=new Uq(Pq.comparator)).insert(o,CW.newNoDocument(o,Cq.min())),u=Wj().add(o),c=new Kj(Cq.min(),new Map,new zq(yq),s,u),e.next=9,ZQ(i,c);case 9:i.sc=i.sc.remove(o),i.ic.delete(n),oX(i),e.next=16;break;case 14:return e.next=16,hK(i.localStore,n,!1).then(function(){return nX(i,n,r)}).catch(Aq);case 16:case"end":return e.stop()}},e)})),YQ.apply(this,arguments)}function KQ(e,t){return QQ.apply(this,arguments)}function QQ(){return QQ=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=iq(t),i=n.batch.batchId,e.prev=1,e.next=4,sK(r.localStore,n);case 4:return a=e.sent,tX(r,i,null),eX(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),e.next=10,sX(r,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Aq(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])})),QQ.apply(this,arguments)}function XQ(e,t,n){return JQ.apply(this,arguments)}function JQ(){return JQ=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=iq(t),e.prev=1,e.next=4,function(e,t){var n=iq(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next(function(t){return rq(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)}).next(function(){return n.mutationQueue.performConsistencyCheck(e)}).next(function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)}).next(function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)}).next(function(){return n.localDocuments.getDocuments(e,r)})})}(i.localStore,n);case 4:return a=e.sent,tX(i,n,r),eX(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,sX(i,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Aq(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])})),JQ.apply(this,arguments)}function eX(e,t){(e.uc.get(t)||[]).forEach(function(e){e.resolve()}),e.uc.delete(t)}function tX(e,t,n){var r=iq(e),i=r.oc[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.oc[r.currentUser.toKey()]=i}}function nX(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,i=Hg(e.ec.get(t));try{for(i.s();!(r=i.n()).done;){var a=r.value;e.tc.delete(a),n&&e.Zu.lc(a,n)}}catch(o){i.e(o)}finally{i.f()}e.ec.delete(t),e.isPrimaryClient&&e.rc.us(t).forEach(function(t){e.rc.containsKey(t)||rX(e,t)})}function rX(e,t){e.nc.delete(t.path.canonicalString());var n=e.sc.get(t);null!==n&&(LK(e.remoteStore,n),e.sc=e.sc.remove(t),e.ic.delete(n),oX(e))}function iX(e,t,n){var r,i=Hg(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof MQ?(e.rc.addReference(a.key,t),aX(e,a)):a instanceof xQ?(XZ("SyncEngine","Document no longer in limbo: "+a.key),e.rc.removeReference(a.key,t),e.rc.containsKey(a.key)||rX(e,a.key)):nq()}}catch(o){i.e(o)}finally{i.f()}}function aX(e,t){var n=t.key,r=n.path.canonicalString();e.sc.get(n)||e.nc.has(r)||(XZ("SyncEngine","New document in limbo: "+n),e.nc.add(r),oX(e))}function oX(e){for(;e.nc.size>0&&e.sc.size<e.maxConcurrentLimboResolutions;){var t=e.nc.values().next().value;e.nc.delete(t);var n=new Pq(_q.fromString(t)),r=e.cc.next();e.ic.set(r,new LQ(n)),e.sc=e.sc.insert(n,r),DK(e.remoteStore,new DY(qW(zW(n.path)),r,2,Nq.ot))}}function sX(e,t,n){return uX.apply(this,arguments)}function uX(){return uX=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=iq(t),a=[],o=[],s=[],e.t0=i.tc.isEmpty(),e.t0){e.next=9;break}return i.tc.forEach(function(e,t){s.push(i.hc(t,n,r).then(function(e){if(e){i.isPrimaryClient&&i.sharedClientState.updateQueryState(t.targetId,e.fromCache?"not-current":"current"),a.push(e);var n=nK.Vi(t.targetId,e);o.push(n)}}))}),e.next=6,Promise.all(s);case 6:return i.Zu.Go(a),e.next=9,(u=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=iq(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return Mq.forEach(n,function(t){return Mq.forEach(t.Pi,function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)}).next(function(){return Mq.forEach(t.vi,function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)})})})});case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),xq(e.t0)){e.next=10;break}throw e.t0;case 10:XZ("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:i=Hg(n);try{for(i.s();!(a=i.n()).done;)o=a.value,s=o.targetId,o.fromCache||(u=r.$i.get(s),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),r.$i=r.$i.insert(s,c))}catch(l){i.e(l)}finally{i.f()}case 13:case"end":return e.stop()}},e,null,[[1,6]])})),function(e,t){return u.apply(this,arguments)})(i.localStore,o);case 9:case"end":return e.stop()}},e)})),uX.apply(this,arguments)}function cX(e,t){return lX.apply(this,arguments)}function lX(){return lX=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=iq(t)).currentUser.isEqual(n)){e.next=12;break}return XZ("SyncEngine","User change. New user:",n.toKey()),e.next=5,aK(r.localStore,n);case 5:return i=e.sent,r.currentUser=n,(a=r).uc.forEach(function(e){e.forEach(function(e){e.reject(new oq(aq.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),a.uc.clear(),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),e.next=12,sX(r,i.Ki);case 12:case"end":return e.stop()}},e)})),lX.apply(this,arguments)}function fX(e,t){var n=iq(e),r=n.ic.get(t);if(r&&r.Xu)return Wj().add(r.key);var i=Wj(),a=n.ec.get(t);if(!a)return i;var o,s=Hg(a);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=n.tc.get(u);i=i.unionWith(c.view.qu)}}catch(l){s.e(l)}finally{s.f()}return i}function hX(e){var t=iq(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=ZQ.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=fX.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=jQ.bind(null,t),t.Zu.Go=TQ.bind(null,t.eventManager),t.Zu.lc=IQ.bind(null,t.eventManager),t}function dX(e){var t=iq(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=KQ.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=XQ.bind(null,t),t}var vX=function(){function e(){Zg(this,e),this.synchronizeTabs=!1}return Wg(e,[{key:"initialize",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.wt=EK(e.databaseInfo.databaseId),t.sharedClientState=t.dc(e),t.persistence=t._c(e),n.next=5,t.persistence.start();case 5:t.localStore=t.wc(e),t.gcScheduler=t.mc(e,t.localStore),t.indexBackfillerScheduler=t.gc(e,t.localStore);case 8:case"end":return n.stop()}},n)}))()}},{key:"mc",value:function(e,t){return null}},{key:"gc",value:function(e,t){return null}},{key:"wc",value:function(e){return function(e,t,n,r){return new iK(e,t,n,r)}(this.persistence,new rK,e.initialUser,this.wt)}},{key:"_c",value:function(e){return new JY(tK.Ms,this.wt)}},{key:"dc",value:function(e){return new gK}},{key:"terminate",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.gcScheduler&&e.gcScheduler.stop(),t.next=3,e.sharedClientState.shutdown();case 3:return t.next=5,e.persistence.shutdown();case 5:case"end":return t.stop()}},t)}))()}}]),e}(),pX=function(){function e(){Zg(this,e)}return Wg(e,[{key:"initialize",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=n.localStore,r.t0){r.next=12;break}return n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=function(e){return WQ(n.syncEngine,e,1)},n.remoteStore.remoteSyncer.handleCredentialChange=cX.bind(null,n.syncEngine),r.next=12,function(e,t){return vQ.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient);case 12:case"end":return r.stop()}},r)}))()}},{key:"createEventManager",value:function(e){return new EQ}},{key:"createDatastore",value:function(e){var t=EK(e.databaseInfo.databaseId),n=new wK(e.databaseInfo);return new TK(e.authCredentials,e.appCheckCredentials,n,t)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return WQ(o.syncEngine,e,0)},a=mK.V()?new mK:new yK,new AK(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return n=this.localStore,r=this.remoteStore,i=this.eventManager,a=this.sharedClientState,o=e.initialUser,s=e.maxConcurrentLimboResolutions,u=t,c=new FQ(n,r,i,a,o,s),u&&(c.ac=!0),c;var n,r,i,a,o,s,u,c}},{key:"terminate",value:function(){return(e=aB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=iq(t),XZ("RemoteStore","RemoteStore shutting down."),n.lu.add(5),e.next=5,xK(n);case 5:n.du.shutdown(),n._u.set("Unknown");case 7:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}]),e}(),gX=function(){function e(t){Zg(this,e),this.observer=t,this.muted=!1}return Wg(e,[{key:"next",value:function(e){this.observer.next&&this.Ic(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}},{key:"Tc",value:function(){this.muted=!0}},{key:"Ic",value:function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)}}]),e}(),yX=function(){function e(t,n,r,i){var a=this;Zg(this,e);var o,s=this;this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=jZ.UNAUTHENTICATED,this.clientId=gq.I(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,(o=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return XZ("FirestoreClient","Received user=",t.uid),e.next=3,s.authCredentialListener(t);case 3:s.user=t;case 4:case"end":return e.stop()}},e)})),function(e){return o.apply(this,arguments)})),this.appCheckCredentials.start(r,function(e){return XZ("FirestoreClient","Received new app check token=",e),a.appCheckCredentialListener(e,a.user)})}return Wg(e,[{key:"getConfiguration",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100});case 1:case"end":return t.stop()}},t)}))()}},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new oq(aq.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new sq;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e.onlineComponents,!n.t0){n.next=5;break}return n.next=5,e.onlineComponents.terminate();case 5:if(n.t1=e.offlineComponents,!n.t1){n.next=9;break}return n.next=9,e.offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=mQ(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}},n,null,[[0,14]])}))),t.promise}}]),e}();function mX(e,t){return kX.apply(this,arguments)}function kX(){return kX=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),XZ("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:i=r.initialUser,t.setCredentialChangeListener(function(){var e=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.isEqual(t),e.t0){e.next=5;break}return e.next=4,aK(n.localStore,t);case 4:i=t;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=n;case 8:case"end":return e.stop()}},e)})),kX.apply(this,arguments)}function CX(e,t){return wX.apply(this,arguments)}function wX(){return wX=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,_X(t);case 3:return r=e.sent,XZ("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return i=e.sent,e.next=10,n.initialize(r,i);case 10:t.setCredentialChangeListener(function(e){return hQ(n.remoteStore,e)}),t.setAppCheckTokenChangeListener(function(e,t){return hQ(n.remoteStore,t)}),t.onlineComponents=n;case 13:case"end":return e.stop()}},e)})),wX.apply(this,arguments)}function _X(e){return EX.apply(this,arguments)}function EX(){return EX=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.offlineComponents,e.t0){e.next=5;break}return XZ("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,mX(t,new vX);case 5:return e.abrupt("return",t.offlineComponents);case 6:case"end":return e.stop()}},e)})),EX.apply(this,arguments)}function bX(e){return PX.apply(this,arguments)}function PX(){return PX=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.onlineComponents,e.t0){e.next=5;break}return XZ("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,CX(t,new pX);case 5:return e.abrupt("return",t.onlineComponents);case 6:case"end":return e.stop()}},e)})),PX.apply(this,arguments)}function SX(e){return OX.apply(this,arguments)}function OX(){return OX=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,bX(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=UQ.bind(null,n.syncEngine),r.onUnlisten=HQ.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}},e)})),OX.apply(this,arguments)}var TX=new Map;function IX(e,t,n){if(!n)throw new oq(aq.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function AX(e){if(!Pq.isDocumentKey(e))throw new oq(aq.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function RX(e){if(Pq.isDocumentKey(e))throw new oq(aq.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function MX(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=(n=e).constructor?n.constructor.name:null;return t?"a custom ".concat(t," object"):"an object"}var n;return"function"==typeof e?"a function":nq()}function xX(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new oq(aq.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=MX(e);throw new oq(aq.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}var NX=function(){function e(t){var n;if(Zg(this,e),void 0===t.host){if(void 0!==t.ssl)throw new oq(aq.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new oq(aq.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new oq(aq.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}return Wg(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),DX=function(){function e(t,n,r){Zg(this,e),this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new NX({}),this._settingsFrozen=!1,t instanceof Jq?this._databaseId=t:(this._app=t,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new oq(aq.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jq(e.options.projectId)}(t))}return Wg(e,[{key:"app",get:function(){if(!this._app)throw new oq(aq.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new oq(aq.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new NX(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new cq;switch(e.type){case"gapi":var t=e.client;return rq(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new hq(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new oq(aq.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return e=this,(t=TX.get(e))&&(XZ("ComponentProvider","Removing Datastore"),TX.delete(e),t.terminate()),Promise.resolve();var e,t}}]),e}(),LX=function(){function e(t,n,r){Zg(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return Wg(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new UX(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),FX=function(){function e(t,n,r){Zg(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return Wg(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),UX=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r,zW(i)))._path=i,a.type="collection",a}return Wg(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new LX(this.firestore,null,new Pq(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(FX);function VX(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=VB(e),1===arguments.length&&(t=gq.I()),IX("doc","path",t),e instanceof DX){var a=_q.fromString.apply(_q,[t].concat(r));return AX(a),new LX(e,null,new Pq(a))}if(!(e instanceof LX||e instanceof UX))throw new oq(aq.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(_q.fromString.apply(_q,[t].concat(r)));return AX(o),new LX(e.firestore,e instanceof UX?e.converter:null,new Pq(o))}var BX=function(){function e(){var t=this;Zg(this,e),this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new bK(this,"async_queue_retry"),this.Kc=function(){var e=_K();e&&XZ("AsyncQueue","Visibility state changed to "+e.visibilityState),t.So.Eo()};var n=_K();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Kc)}return Wg(e,[{key:"isShuttingDown",get:function(){return this.Fc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.Gc(),this.Qc(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;var t=_K();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}},{key:"enqueue",value:function(e){var t=this;if(this.Gc(),this.Fc)return new Promise(function(){});var n=new sq;return this.Qc(function(){return t.Fc&&t.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)}).then(function(){return n.promise})}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget(function(){return t.Mc.push(e),t.jc()})}},{key:"jc",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0===e.Mc.length){t.next=14;break}return t.prev=1,t.next=4,e.Mc[0]();case 4:e.Mc.shift(),e.So.reset(),t.next=13;break;case 8:if(t.prev=8,t.t0=t.catch(1),xq(t.t0)){t.next=12;break}throw t.t0;case 12:XZ("AsyncQueue","Operation failed with retryable error: "+t.t0);case 13:e.Mc.length>0&&e.So.Io(function(){return e.jc()});case 14:case"end":return t.stop()}},t,null,[[1,8]])}))()}},{key:"Qc",value:function(e){var t=this,n=this.Oc.then(function(){return t.Lc=!0,e().catch(function(e){throw t.Bc=e,t.Lc=!1,JZ("INTERNAL UNHANDLED ERROR: ",(r=(n=e).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),e;var n,r}).then(function(e){return t.Lc=!1,e})});return this.Oc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.Gc(),this.qc.indexOf(e)>-1&&(t=0);var i=yQ.createAndSchedule(this,e,t,n,function(e){return r.Wc(e)});return this.$c.push(i),i}},{key:"Gc",value:function(){this.Bc&&nq()}},{key:"verifyOperationInProgress",value:function(){}},{key:"zc",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.Oc,t.next=3,n;case 3:if(n!==e.Oc){t.next=0;break}case 4:case"end":return t.stop()}},t)}))()}},{key:"Hc",value:function(e){var t,n=Hg(this.$c);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"Jc",value:function(e){var t=this;return this.zc().then(function(){t.$c.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});var n,r=Hg(t.$c);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==e&&i.timerId===e)break}}catch(a){r.e(a)}finally{r.f()}return t.zc()})}},{key:"Yc",value:function(e){this.qc.push(e)}},{key:"Wc",value:function(e){var t=this.$c.indexOf(e);this.$c.splice(t,1)}}]),e}();function zX(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,i=["next","error","complete"];r<i.length;r++){var a=i[r];if(a in n&&"function"==typeof n[a])return!0}return!1}(e)}var HX=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r,i)).type="firestore",a._queue=new BX,a._persistenceKey="name"in e?e.name:"[DEFAULT]",a}return Wg(n,[{key:"_terminate",value:function(){return this._firestoreClient||$X(this),this._firestoreClient.terminate()}}]),n}(DX);function GX(e){return e._firestoreClient||$X(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function $X(e){var t,n,r,i=e._freezeSettings(),a=(n=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",new Xq(e._databaseId,n,e._persistenceKey,(r=i).host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams));e._firestoreClient=new yX(e._authCredentials,e._appCheckCredentials,e._queue,a)}var ZX=function(){function e(){Zg(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new oq(aq.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bq(n)}return Wg(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}(),qX=function(){function e(t){Zg(this,e),this._byteString=t}return Wg(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e($q.fromBase64String(t))}catch(n){throw new oq(aq.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}},{key:"fromUint8Array",value:function(t){return new e($q.fromUint8Array(t))}}]),e}(),WX=Wg(function e(t){Zg(this,e),this._methodName=t}),jX=function(){function e(t,n){if(Zg(this,e),!isFinite(t)||t<-90||t>90)throw new oq(aq.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new oq(aq.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return Wg(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return yq(this._lat,e._lat)||yq(this._long,e._long)}}]),e}(),YX=/^__.*__$/,KX=function(){function e(t,n,r){Zg(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return Wg(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new Pj(e,this.data,this.fieldMask,t,this.fieldTransforms):new bj(e,this.data,t,this.fieldTransforms)}}]),e}(),QX=function(){function e(t,n,r){Zg(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return Wg(e,[{key:"toMutation",value:function(e,t){return new Pj(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function XX(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw nq()}}var JX=function(){function e(t,n,r,i,a,o){Zg(this,e),this.settings=t,this.databaseId=n,this.wt=r,this.ignoreUndefinedProperties=i,void 0===a&&this.Xc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}return Wg(e,[{key:"path",get:function(){return this.settings.path}},{key:"Zc",get:function(){return this.settings.Zc}},{key:"ta",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ea",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.sa(e),r}},{key:"ia",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.Xc(),r}},{key:"ra",value:function(e){return this.ta({path:void 0,na:!0})}},{key:"oa",value:function(e){return hJ(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})}},{key:"Xc",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.sa(this.path.get(e))}},{key:"sa",value:function(e){if(0===e.length)throw this.oa("Document fields must not be empty");if(XX(this.Zc)&&YX.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}]),e}(),eJ=function(){function e(t,n,r){Zg(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.wt=r||EK(t)}return Wg(e,[{key:"aa",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new JX({Zc:e,methodName:t,ca:n,path:bq.emptyPath(),na:!1,ua:r},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}]),e}();function tJ(e){var t=e._freezeSettings(),n=EK(e._databaseId);return new eJ(e._databaseId,!!t.ignoreUndefinedProperties,n)}function nJ(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.aa(a.merge||a.mergeFields?2:0,t,n,i);uJ("Data must be an object, but it was:",o,r);var s,u,c=oJ(r,o);if(a.merge)s=new Gq(o.fieldMask),u=o.fieldTransforms;else if(a.mergeFields){var l,f=[],h=Hg(a.mergeFields);try{for(h.s();!(l=h.n()).done;){var d=l.value,v=cJ(t,d,n);if(!o.contains(v))throw new oq(aq.INVALID_ARGUMENT,"Field '".concat(v,"' is specified in your field mask but missing from your input data."));dJ(f,v)||f.push(v)}}catch(p){h.e(p)}finally{h.f()}s=new Gq(f),u=o.fieldTransforms.filter(function(e){return s.covers(e.field)})}else s=null,u=o.fieldTransforms;return new KX(new mW(c),s,u)}var rJ=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.Zc)throw e.oa(1===e.Zc?"".concat(this._methodName,"() can only appear at the top level of your update data"):"".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(WX),iJ=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"_toFieldTransform",value:function(e){return new vj(e.path,new oj)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(WX);function aJ(e,t){if(sJ(e=VB(e)))return uJ("Unsupported field value:",t,e),oJ(e,t);if(e instanceof WX)return function(e,t){if(!XX(t.Zc))throw t.oa("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.oa("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.na&&4!==t.Zc)throw t.oa("Nested arrays are not supported");return function(e,t){var n,r=[],i=0,a=Hg(e);try{for(a.s();!(n=a.n()).done;){var o=aJ(n.value,t.ra(i));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),i++}}catch(s){a.e(s)}finally{a.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=VB(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return function(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!tW(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?tj(t):ej(e,t)}(t.wt,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=kq.fromDate(e);return{timestampValue:uY(t.wt,n)}}if(e instanceof kq){var r=new kq(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:uY(t.wt,r)}}if(e instanceof jX)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof qX)return{bytesValue:cY(t.wt,e._byteString)};if(e instanceof LX){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.oa("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:hY(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.oa("Unsupported field value: ".concat(MX(e)))}(e,t)}function oJ(e,t){var n={};return Fq(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Lq(e,function(e,r){var i=aJ(r,t.ea(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function sJ(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof kq||e instanceof jX||e instanceof qX||e instanceof LX||e instanceof WX)}function uJ(e,t,n){if(!sJ(n)||"object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){var r=MX(n);throw t.oa("an object"===r?e+" a custom object":e+" "+r)}var i}function cJ(e,t,n){if((t=VB(t))instanceof ZX)return t._internalPath;if("string"==typeof t)return fJ(e,t);throw hJ("Field path arguments must be of type string or ",e,!1,void 0,n)}var lJ=new RegExp("[~\\*/\\[\\]]");function fJ(e,t,n){if(t.search(lJ)>=0)throw hJ("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return Ag(ZX,Bg(t.split(".")))._internalPath}catch(r){throw hJ("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function hJ(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";var u="";return(a||o)&&(u+=" (found",a&&(u+=" in field ".concat(r)),o&&(u+=" in document ".concat(i)),u+=")"),new oq(aq.INVALID_ARGUMENT,s+e+u)}function dJ(e,t){return e.some(function(e){return e.isEqual(t)})}var vJ=function(){function e(t,n,r,i,a){Zg(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return Wg(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new LX(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new pJ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(gJ("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),pJ=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"data",value:function(){return Rg(Vg(n.prototype),"data",this).call(this)}}]),n}(vJ);function gJ(e,t){return"string"==typeof t?fJ(e,t):t instanceof ZX?t._internalPath:t._delegate._internalPath}var yJ=function(){function e(t,n){Zg(this,e),this.hasPendingWrites=t,this.fromCache=n}return Wg(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),mJ=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,e,r,i,a,s))._firestore=e,u._firestoreImpl=e,u.metadata=o,u}return Wg(n,[{key:"exists",value:function(){return Rg(Vg(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new kJ(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(gJ("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(vJ),kJ=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Rg(Vg(n.prototype),"data",this).call(this,e)}}]),n}(mJ),CJ=function(){function e(t,n,r,i){Zg(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new yJ(i.hasPendingWrites,i.fromCache),this.query=r}return Wg(e,[{key:"docs",get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach(function(r){e.call(t,new kJ(n._firestore,n._userDataWriter,r.key,r,new yJ(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new oq(aq.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map(function(t){return{type:"added",doc:new kJ(e._firestore,e._userDataWriter,t.doc.key,t.doc,new yJ(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:n++}})}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(function(e){return t||3!==e.type}).map(function(t){var n=new kJ(e._firestore,e._userDataWriter,t.doc.key,t.doc,new yJ(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:wJ(t.type),doc:n,oldIndex:i,newIndex:a}})}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),e}();function wJ(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return nq()}}function _J(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new oq(aq.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var EJ=Wg(function e(){Zg(this,e)});var bJ=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this)).fa=e,a.da=r,a._a=i,a.type="where",a}return Wg(n,[{key:"_apply",value:function(e){var t,n,r,i=tJ(e.firestore),a=function(e,t,n,r,i,a,o){var s;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new oq(aq.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){TJ(o,a);var u,c=[],l=Hg(o);try{for(l.s();!(u=l.n()).done;){var f=u.value;c.push(OJ(r,e,f))}}catch(d){l.e(d)}finally{l.f()}s={arrayValue:{values:c}}}else s=OJ(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||TJ(o,a),s=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return aJ(n,e.aa(r?4:3,t))}(n,"where",o,"in"===a||"not-in"===a);var h=SW.create(i,a,s);return function(e,t){if(t.ht()){var n=GW(e);if(null!==n&&!n.isEqual(t.field))throw new oq(aq.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(t.field.toString(),"'"));var r=HW(e);null!==r&&IJ(0,t.field,r)}var i=function(e,t){var n,r=Hg(e.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.indexOf(i.op)>=0)return i.op}}catch(d){r.e(d)}finally{r.f()}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw new oq(aq.INVALID_ARGUMENT,i===t.op?"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter."):"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(i.toString(),"' filters."))}(e,h),h}(e._query,0,i,e.firestore._databaseId,this.fa,this.da,this._a);return new FX(e.firestore,e.converter,(t=e._query,n=a,r=t.filters.concat([n]),new BW(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}(EJ);var PJ=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).fa=e,i.wa=r,i.type="orderBy",i}return Wg(n,[{key:"_apply",value:function(e){var t,n,r,i=function(e,t,n){if(null!==e.startAt)throw new oq(aq.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new oq(aq.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new LW(t,n);return function(e,t){if(null===HW(e)){var n=GW(e);null!==n&&IJ(0,n,t.field)}}(e,r),r}(e._query,this.fa,this.wa);return new FX(e.firestore,e.converter,(t=e._query,n=i,r=t.explicitOrderBy.concat([n]),new BW(t.path,t.collectionGroup,r,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}(EJ);var SJ=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this)).type=e,a.ma=r,a.ga=i,a}return Wg(n,[{key:"_apply",value:function(e){return new FX(e.firestore,e.converter,WW(e._query,this.ma,this.ga))}}]),n}(EJ);function OJ(e,t,n){if("string"==typeof(n=VB(n))){if(""===n)throw new oq(aq.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!$W(t)&&-1!==n.indexOf("/"))throw new oq(aq.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(_q.fromString(n));if(!Pq.isDocumentKey(r))throw new oq(aq.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return lW(e,new Pq(r))}if(n instanceof LX)return lW(e,n._key);throw new oq(aq.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(MX(n),"."))}function TJ(e,t){if(!Array.isArray(e)||0===e.length)throw new oq(aq.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new oq(aq.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function IJ(e,t,n){if(!n.isEqual(t))throw new oq(aq.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}function AJ(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var RJ=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).firestore=e,r}return Wg(n,[{key:"convertBytes",value:function(e){return new qX(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new LX(this.firestore,null,t)}}]),n}(function(){function e(){Zg(this,e)}return Wg(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(rW(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Wq(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(jq(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw nq()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return Lq(e.fields,function(e,i){r[e]=n.convertValue(i,t)}),r}},{key:"convertGeoPoint",value:function(e){return new jX(Wq(e.latitude),Wq(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map(function(e){return n.convertValue(e,t)})}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=Kq(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Qq(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=qq(e);return new kq(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=_q.fromString(e);rq(RY(n));var r=new Jq(n.get(1),n.get(3)),i=new Pq(n.popFirst(5));return r.isEqual(t)||JZ("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),e}());function MJ(e,t){return n=GX(e),r=t,i=new sq,n.asyncQueue.enqueueAndForget(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t,n){return $Q.apply(this,arguments)},e.next=3,function(e){return bX(e).then(function(e){return e.syncEngine})}(n);case 3:return e.t1=e.sent,e.t2=r,e.t3=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 7:case"end":return e.stop()}},e)}))),i.promise;var n,r,i}function xJ(e,t,n){var r=n.docs.get(t._key),i=new RJ(e);return new mJ(e,i,t._key,r,new yJ(n.hasPendingWrites,n.fromCache),t.converter)}function NJ(){return new iJ("serverTimestamp")}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];YZ="9.9.0",_z(new HB("firestore",function(e,n){var r=n.options,i=e.getProvider("app").getImmediate(),a=new HX(i,new lq(e.getProvider("auth-internal")),new vq(e.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:t},r),a._setSettings(r),a},"PUBLIC")),Iz(WZ,"3.4.12",e),Iz(WZ,"3.4.12","esm2017")}(),Iz("firebase","9.9.0","app");var DJ="@firebase/installations",LJ="0.5.12",FJ="w:".concat(LJ),UJ="FIS_v2",VJ=new IB("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function BJ(e){return e instanceof TB&&e.code.includes("request-failed")}function zJ(e){var t=e.projectId;return"https://firebaseinstallations.googleapis.com/v1/projects/".concat(t,"/installations")}function HJ(e){return{token:e.token,requestStatus:2,expiresIn:YJ(e.expiresIn),creationTime:Date.now()}}function GJ(e,t){return $J.apply(this,arguments)}function $J(){return $J=aB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:return r=e.sent.error,e.abrupt("return",VJ.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status}));case 4:case"end":return e.stop()}},e)})),$J.apply(this,arguments)}function ZJ(e){var t=e.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function qJ(e,t){var n=t.refreshToken,r=ZJ(e);return r.append("Authorization",function(e){return"".concat(UJ," ").concat(e)}(n)),r}function WJ(e){return jJ.apply(this,arguments)}function jJ(){return jJ=aB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return n=e.sent,e.abrupt("return",n.status>=500&&n.status<600?t():n);case 4:case"end":return e.stop()}},e)})),jJ.apply(this,arguments)}function YJ(e){return Number(e.replace("s","000"))}function KJ(e,t){return QJ.apply(this,arguments)}function QJ(){return QJ=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.appConfig,i=t.heartbeatServiceProvider,a=n.fid,o=zJ(r),s=ZJ(r),!(u=i.getImmediate({optional:!0}))){e.next=8;break}return e.next=6,u.getHeartbeatsHeader();case 6:(c=e.sent)&&s.append("x-firebase-client",c);case 8:return l={method:"POST",headers:s,body:JSON.stringify({fid:a,authVersion:UJ,appId:r.appId,sdkVersion:FJ})},e.next=11,WJ(function(){return fetch(o,l)});case 11:if(!(f=e.sent).ok){e.next=17;break}return e.next=15,f.json();case 15:return h=e.sent,e.abrupt("return",{fid:h.fid||a,registrationStatus:2,refreshToken:h.refreshToken,authToken:HJ(h.authToken)});case 17:return e.next=19,GJ("Create Installation",f);case 19:throw e.sent;case 20:case"end":return e.stop()}},e)})),QJ.apply(this,arguments)}function XJ(e){return new Promise(function(t){setTimeout(t,e)})}var JJ=/^[cdef][\w-]{21}$/;function e1(){try{var e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;var t=function(e){return function(e){return btoa(String.fromCharCode.apply(String,Bg(e))).replace(/\+/g,"-").replace(/\//g,"_")}(e).substr(0,22)}(e);return JJ.test(t)?t:""}catch(n){return""}}function t1(e){return"".concat(e.appName,"!").concat(e.appId)}var n1=new Map;function r1(e,t){var n=t1(e);i1(n,t),function(e,t){var n=(!a1&&"BroadcastChannel"in self&&((a1=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(e){i1(e.data.key,e.data.fid)}),a1);n&&n.postMessage({key:e,fid:t}),0===n1.size&&a1&&(a1.close(),a1=null)}(n,t)}function i1(e,t){var n=n1.get(e);if(n){var r,i=Hg(n);try{for(i.s();!(r=i.n()).done;){(0,r.value)(t)}}catch(a){i.e(a)}finally{i.f()}}}var a1=null,o1="firebase-installations-store",s1=null;function u1(){return s1||(s1=sz("firebase-installations-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(o1)}})),s1}function c1(e,t){return l1.apply(this,arguments)}function l1(){return l1=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t1(t),e.next=3,u1();case 3:return i=e.sent.transaction(o1,"readwrite"),a=i.objectStore(o1),e.next=7,a.get(r);case 7:return o=e.sent,e.next=10,a.put(n,r);case 10:return e.next=12,i.done;case 12:return(!o||o.fid!==n.fid)&&r1(t,n.fid),e.abrupt("return",n);case 14:case"end":return e.stop()}},e)})),l1.apply(this,arguments)}function f1(e){return h1.apply(this,arguments)}function h1(){return h1=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t1(t),e.next=3,u1();case 3:return r=e.sent.transaction(o1,"readwrite"),e.next=6,r.objectStore(o1).delete(n);case 6:return e.next=8,r.done;case 8:case"end":return e.stop()}},e)})),h1.apply(this,arguments)}function d1(e,t){return v1.apply(this,arguments)}function v1(){return v1=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t1(t),e.next=3,u1();case 3:return i=e.sent.transaction(o1,"readwrite"),a=i.objectStore(o1),e.next=7,a.get(r);case 7:if(o=e.sent,void 0!==(s=n(o))){e.next=14;break}return e.next=12,a.delete(r);case 12:e.next=16;break;case 14:return e.next=16,a.put(s,r);case 16:return e.next=18,i.done;case 18:return s&&(!o||o.fid!==s.fid)&&r1(t,s.fid),e.abrupt("return",s);case 20:case"end":return e.stop()}},e)})),v1.apply(this,arguments)}function p1(e){return g1.apply(this,arguments)}function g1(){return g1=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d1(t.appConfig,function(e){var r=y1(e),i=m1(t,r);return n=i.registrationPromise,i.installationEntry});case 2:if(""!==(r=e.sent).fid){e.next=10;break}return e.next=6,n;case 6:e.t1=e.sent,e.t0={installationEntry:e.t1},e.next=11;break;case 10:e.t0={installationEntry:r,registrationPromise:n};case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)})),g1.apply(this,arguments)}function y1(e){return E1(e||{fid:e1(),registrationStatus:0})}function m1(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(VJ.create("app-offline"))};var n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function(e,t){return k1.apply(this,arguments)}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:C1(e)}:{installationEntry:t}}function k1(){return k1=aB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,KJ(t,n);case 3:return r=e.sent,e.abrupt("return",c1(t.appConfig,r));case 7:if(e.prev=7,e.t0=e.catch(0),!BJ(e.t0)||409!==e.t0.customData.serverCode){e.next=14;break}return e.next=12,f1(t.appConfig);case 12:e.next=16;break;case 14:return e.next=16,c1(t.appConfig,{fid:n.fid,registrationStatus:0});case 16:throw e.t0;case 17:case"end":return e.stop()}},e,null,[[0,7]])})),k1.apply(this,arguments)}function C1(e){return w1.apply(this,arguments)}function w1(){return w1=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_1(t.appConfig);case 2:n=e.sent;case 3:if(1!==n.registrationStatus){e.next=11;break}return e.next=6,XJ(100);case 6:return e.next=8,_1(t.appConfig);case 8:n=e.sent;case 9:e.next=3;break;case 11:if(0!==n.registrationStatus){e.next=18;break}return e.next=14,p1(t);case 14:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",a||i);case 18:return e.abrupt("return",n);case 19:case"end":return e.stop()}},e)})),w1.apply(this,arguments)}function _1(e){return d1(e,function(e){if(!e)throw VJ.create("installation-not-found");return E1(e)})}function E1(e){return function(e){return 1===e.registrationStatus&&e.registrationTime+1e4<Date.now()}(e)?{fid:e.fid,registrationStatus:0}:e}function b1(e,t){return P1.apply(this,arguments)}function P1(){return P1=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.appConfig,i=t.heartbeatServiceProvider,a=S1(r,n),o=qJ(r,n),!(s=i.getImmediate({optional:!0}))){e.next=7;break}return e.next=5,s.getHeartbeatsHeader();case 5:(u=e.sent)&&o.append("x-firebase-client",u);case 7:return c={method:"POST",headers:o,body:JSON.stringify({installation:{sdkVersion:FJ,appId:r.appId}})},e.next=10,WJ(function(){return fetch(a,c)});case 10:if(!(l=e.sent).ok){e.next=17;break}return e.t0=HJ,e.next=15,l.json();case 15:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 17:return e.next=19,GJ("Generate Auth Token",l);case 19:throw e.sent;case 20:case"end":return e.stop()}},e)})),P1.apply(this,arguments)}function S1(e,t){var n=t.fid;return"".concat(zJ(e),"/").concat(n,"/authTokens:generate")}function O1(e){return T1.apply(this,arguments)}function T1(){return T1=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]&&a[1],e.next=3,d1(t.appConfig,function(e){if(!N1(e))throw VJ.create("not-registered");var i=e.authToken;if(!n&&D1(i))return e;if(1===i.requestStatus)return r=I1(t,n),e;if(!navigator.onLine)throw VJ.create("app-offline");var a=L1(e);return r=M1(t,a),a});case 3:if(i=e.sent,!r){e.next=10;break}return e.next=7,r;case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=i.authToken;case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)})),T1.apply(this,arguments)}function I1(e,t){return A1.apply(this,arguments)}function A1(){return A1=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R1(t.appConfig);case 2:r=e.sent;case 3:if(1!==r.authToken.requestStatus){e.next=11;break}return e.next=6,XJ(100);case 6:return e.next=8,R1(t.appConfig);case 8:r=e.sent;case 9:e.next=3;break;case 11:return i=r.authToken,e.abrupt("return",0===i.requestStatus?O1(t,n):i);case 13:case"end":return e.stop()}},e)})),A1.apply(this,arguments)}function R1(e){return d1(e,function(e){if(!N1(e))throw VJ.create("not-registered");return function(e){return 1===e.requestStatus&&e.requestTime+1e4<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function M1(e,t){return x1.apply(this,arguments)}function x1(){return x1=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b1(t,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{authToken:r}),e.next=7,c1(t.appConfig,i);case 7:return e.abrupt("return",r);case 10:if(e.prev=10,e.t0=e.catch(0),BJ(e.t0)&&(401===e.t0.customData.serverCode||404===e.t0.customData.serverCode)){e.next=18;break}return a=Object.assign(Object.assign({},n),{authToken:{requestStatus:0}}),e.next=16,c1(t.appConfig,a);case 16:e.next=20;break;case 18:return e.next=20,f1(t.appConfig);case 20:throw e.t0;case 21:case"end":return e.stop()}},e,null,[[0,10]])})),x1.apply(this,arguments)}function N1(e){return void 0!==e&&2===e.registrationStatus}function D1(e){return 2===e.requestStatus&&!function(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(e)}function L1(e){var t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}function F1(){return F1=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,e.next=3,p1(n);case 3:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",(a?a.catch(console.error):O1(n).catch(console.error),i.fid));case 7:case"end":return e.stop()}},e)})),F1.apply(this,arguments)}function U1(){return U1=aB(regeneratorRuntime.mark(function e(t){var n,r,i=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]&&i[1],r=t,e.next=4,V1(r);case 4:return e.next=6,O1(r,n);case 6:return e.abrupt("return",e.sent.token);case 7:case"end":return e.stop()}},e)})),U1.apply(this,arguments)}function V1(e){return B1.apply(this,arguments)}function B1(){return B1=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p1(t);case 2:if(n=e.sent,r=n.registrationPromise,e.t0=r,!e.t0){e.next=8;break}return e.next=8,r;case 8:case"end":return e.stop()}},e)})),B1.apply(this,arguments)}function z1(e){return VJ.create("missing-app-config-values",{valueName:e})}var H1="installations";_z(new HB(H1,function(e){var t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw z1("App Configuration");if(!e.name)throw z1("App Name");for(var t=0,n=["projectId","apiKey","appId"];t<n.length;t++){var r=n[t];if(!e.options[r])throw z1(r)}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:Ez(t,"heartbeat"),_delete:function(){return Promise.resolve()}}},"PUBLIC")),_z(new HB("installations-internal",function(e){var t=Ez(e.getProvider("app").getImmediate(),H1).getImmediate();return{getId:function(){return function(e){return F1.apply(this,arguments)}(t)},getToken:function(e){return function(e){return U1.apply(this,arguments)}(t,e)}}},"PRIVATE")),Iz(DJ,LJ),Iz(DJ,LJ,"esm2017");var G1="@firebase/remote-config",$1=new IB("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"}),Z1=function(){function e(t,n,r,i){Zg(this,e),this.client=t,this.storage=n,this.storageCache=r,this.logger=i}return Wg(e,[{key:"isCachedDataFresh",value:function(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-t,r=n<=e;return this.logger.debug("Config fetch cache check. Cache age millis: ".concat(n,". Cache max age millis (minimumFetchIntervalMillis setting): ").concat(e,". Is cache hit: ").concat(r,".")),r}},{key:"fetch",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);case 2:if(r=n.sent,i=Sg(r,2),a=i[0],!(o=i[1])||!t.isCachedDataFresh(e.cacheMaxAgeMillis,a)){n.next=8;break}return n.abrupt("return",o);case 8:return e.eTag=o&&o.eTag,n.next=11,t.client.fetch(e);case 11:return s=n.sent,u=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===s.status&&u.push(t.storage.setLastSuccessfulFetchResponse(s)),n.next=16,Promise.all(u);case 16:return n.abrupt("return",s);case 17:case"end":return n.stop()}},n)}))()}}]),e}();function q1(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e.languages&&e.languages[0]||e.language}var W1=function(){function e(t,n,r,i,a,o){Zg(this,e),this.firebaseInstallations=t,this.sdkVersion=n,this.namespace=r,this.projectId=i,this.apiKey=a,this.appId=o}return Wg(e,[{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l,f,h,d,v,p,g,y,m,k,C,w,_;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]);case 2:return o=n.sent,s=Sg(o,2),u=s[0],c=s[1],l="".concat(window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com","/v1/projects/").concat(t.projectId,"/namespaces/").concat(t.namespace,":fetch?key=").concat(t.apiKey),f={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},h={sdk_version:t.sdkVersion,app_instance_id:u,app_instance_id_token:c,app_id:t.appId,language_code:q1()},d={method:"POST",headers:f,body:JSON.stringify(h)},v=fetch(l,d),p=new Promise(function(t,n){e.signal.addEventListener(function(){var e=new Error("The operation was aborted.");e.name="AbortError",n(e)})}),n.prev=12,n.next=15,Promise.race([v,p]);case 15:return n.next=17,v;case 17:g=n.sent,n.next=24;break;case 20:throw n.prev=20,n.t0=n.catch(12),y="fetch-client-network","AbortError"===(null===(r=n.t0)||void 0===r?void 0:r.name)&&(y="fetch-timeout"),$1.create(y,{originalErrorMessage:null===(i=n.t0)||void 0===i?void 0:i.message});case 24:if(m=g.status,k=g.headers.get("ETag")||void 0,200!==g.status){n.next=37;break}return n.prev=27,n.next=30,g.json();case 30:_=n.sent,n.next=36;break;case 33:throw n.prev=33,n.t1=n.catch(27),$1.create("fetch-client-parse",{originalErrorMessage:null===(a=n.t1)||void 0===a?void 0:a.message});case 36:C=_.entries,w=_.state;case 37:if("INSTANCE_STATE_UNSPECIFIED"===w?m=500:"NO_CHANGE"===w?m=304:("NO_TEMPLATE"===w||"EMPTY_CONFIG"===w)&&(C={}),304===m||200===m){n.next=39;break}throw $1.create("fetch-status",{httpStatus:m});case 39:return n.abrupt("return",{status:m,eTag:k,config:C});case 40:case"end":return n.stop()}},n,null,[[12,20],[27,33]])}))()})}]),e}(),j1=function(){function e(t,n){Zg(this,e),this.client=t,this.storage=n}return Wg(e,[{key:"fetch",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.storage.getThrottleMetadata();case 2:if(n.t0=n.sent,n.t0){n.next=5;break}n.t0={backoffCount:0,throttleEndTimeMillis:Date.now()};case 5:return r=n.t0,n.abrupt("return",t.attemptFetch(e,r));case 7:case"end":return n.stop()}},n)}))()}},{key:"attemptFetch",value:function(e,t){var n=t.throttleEndTimeMillis,r=t.backoffCount,i=this;return aB(regeneratorRuntime.mark(function t(){var a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r($1.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(e.signal,n);case 2:return t.prev=2,t.next=5,i.client.fetch(e);case 5:return a=t.sent,t.next=8,i.storage.deleteThrottleMetadata();case 8:return t.abrupt("return",a);case 11:if(t.prev=11,t.t0=t.catch(2),function(e){if(!(e instanceof TB&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t.t0)){t.next=15;break}throw t.t0;case 15:return o={throttleEndTimeMillis:Date.now()+UB(r),backoffCount:r+1},t.next=18,i.storage.setThrottleMetadata(o);case 18:return t.abrupt("return",i.attemptFetch(e,o));case 19:case"end":return t.stop()}},t,null,[[2,11]])}))()}}]),e}(),Y1=function(){function e(t,n,r,i,a){Zg(this,e),this.app=t,this._client=n,this._storageCache=r,this._storage=i,this._logger=a,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return Wg(e,[{key:"fetchTimeMillis",get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}},{key:"lastFetchStatus",get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}]),e}();function K1(e,t){var n,r=e.target.error||void 0;return $1.create(t,{originalErrorMessage:r&&(null===(n=r)||void 0===n?void 0:n.message)})}var Q1="app_namespace_store",X1=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Promise(function(e,t){var n;try{var i=indexedDB.open("firebase_remote_config",1);i.onerror=function(e){t(K1(e,"storage-open"))},i.onsuccess=function(t){e(t.target.result)},i.onupgradeneeded=function(e){0===e.oldVersion&&e.target.result.createObjectStore(Q1,{keyPath:"compositeKey"})}}catch(r){t($1.create("storage-open",{originalErrorMessage:null===(n=r)||void 0===n?void 0:n.message}))}});Zg(this,e),this.appId=t,this.appName=n,this.namespace=r,this.openDbPromise=i}return Wg(e,[{key:"getLastFetchStatus",value:function(){return this.get("last_fetch_status")}},{key:"setLastFetchStatus",value:function(e){return this.set("last_fetch_status",e)}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.get("last_successful_fetch_timestamp_millis")}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.set("last_successful_fetch_timestamp_millis",e)}},{key:"getLastSuccessfulFetchResponse",value:function(){return this.get("last_successful_fetch_response")}},{key:"setLastSuccessfulFetchResponse",value:function(e){return this.set("last_successful_fetch_response",e)}},{key:"getActiveConfig",value:function(){return this.get("active_config")}},{key:"setActiveConfig",value:function(e){return this.set("active_config",e)}},{key:"getActiveConfigEtag",value:function(){return this.get("active_config_etag")}},{key:"setActiveConfigEtag",value:function(e){return this.set("active_config_etag",e)}},{key:"getThrottleMetadata",value:function(){return this.get("throttle_metadata")}},{key:"setThrottleMetadata",value:function(e){return this.set("throttle_metadata",e)}},{key:"deleteThrottleMetadata",value:function(){return this.delete("throttle_metadata")}},{key:"get",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a,o=r.transaction([Q1],"readonly").objectStore(Q1),s=t.createCompositeKey(e);try{var u=o.get(s);u.onerror=function(e){i(K1(e,"storage-get"))},u.onsuccess=function(e){var t=e.target.result;n(t?t.value:void 0)}}catch(u){i($1.create("storage-get",{originalErrorMessage:null===(a=u)||void 0===a?void 0:a.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"set",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.openDbPromise;case 2:return i=r.sent,r.abrupt("return",new Promise(function(r,a){var o,s=i.transaction([Q1],"readwrite").objectStore(Q1),u=n.createCompositeKey(e);try{var c=s.put({compositeKey:u,value:t});c.onerror=function(e){a(K1(e,"storage-set"))},c.onsuccess=function(){r()}}catch(c){a($1.create("storage-set",{originalErrorMessage:null===(o=c)||void 0===o?void 0:o.message}))}}));case 4:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a,o=r.transaction([Q1],"readwrite").objectStore(Q1),s=t.createCompositeKey(e);try{var u=o.delete(s);u.onerror=function(e){i(K1(e,"storage-delete"))},u.onsuccess=function(){n()}}catch(u){i($1.create("storage-delete",{originalErrorMessage:null===(a=u)||void 0===a?void 0:a.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"createCompositeKey",value:function(e){return[this.appId,this.appName,this.namespace,e].join()}}]),e}(),J1=function(){function e(t){Zg(this,e),this.storage=t}return Wg(e,[{key:"getLastFetchStatus",value:function(){return this.lastFetchStatus}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.lastSuccessfulFetchTimestampMillis}},{key:"getActiveConfig",value:function(){return this.activeConfig}},{key:"loadFromStorage",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.storage.getLastFetchStatus(),r=e.storage.getLastSuccessfulFetchTimestampMillis(),i=e.storage.getActiveConfig(),t.next=5,n;case 5:return(a=t.sent)&&(e.lastFetchStatus=a),t.next=9,r;case 9:return(o=t.sent)&&(e.lastSuccessfulFetchTimestampMillis=o),t.next=13,i;case 13:(s=t.sent)&&(e.activeConfig=s);case 15:case"end":return t.stop()}},t)}))()}},{key:"setLastFetchStatus",value:function(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}},{key:"setActiveConfig",value:function(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}]),e}();function e0(){return(e0=aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(PB()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,SB();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}_z(new HB("remote-config",function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw $1.create("registration-window");if(!PB())throw $1.create("indexed-db-unavailable");var a=r.options,o=a.projectId,s=a.apiKey,u=a.appId;if(!o)throw $1.create("registration-project-id");if(!s)throw $1.create("registration-api-key");if(!u)throw $1.create("registration-app-id");var c=new X1(u,r.name,n=n||"firebase"),l=new J1(c),f=new XB(G1);f.logLevel=WB.ERROR;var h=new W1(i,Sz,n,o,s,u),d=new j1(h,c),v=new Z1(d,c,l,f),p=new Y1(r,v,l,c,f);return function(e){var t=VB(e);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(function(){t._isInitializationComplete=!0}))}(p),p},"PUBLIC").setMultipleInstances(!0)),Iz(G1,"0.3.11"),Iz(G1,"0.3.11","esm2017");var t0="/firebase-messaging-sw.js",n0="/firebase-cloud-messaging-push-scope",r0="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",i0="google.c.a.c_id",a0="google.c.a.c_l",o0="google.c.a.ts",s0="google.c.a.e",u0=(function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(u0||(u0={})),u0);function c0(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(String,Bg(t))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function l0(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}var f0="fcm_token_details_db",h0="fcm_token_object_Store";function d0(e){return v0.apply(this,arguments)}function v0(){return v0=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0="databases"in indexedDB,!e.t0){e.next=5;break}return e.next=4,indexedDB.databases();case 4:e.t0=!e.sent.map(function(e){return e.name}).includes(f0);case 5:if(!e.t0){e.next=7;break}return e.abrupt("return",null);case 7:return n=null,e.next=10,sz(f0,5,{upgrade:(r=aB(regeneratorRuntime.mark(function e(r,i,a,o){var s,u,c,l,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i<2)&&r.objectStoreNames.contains(h0)){e.next=2;break}return e.abrupt("return");case 2:return u=o.objectStore(h0),e.next=5,u.index("fcmSenderId").get(t);case 5:return c=e.sent,e.next=8,u.clear();case 8:if(!c){e.next=17;break}if(2!==i){e.next=16;break}if((l=c).auth&&l.p256dh&&l.endpoint){e.next=13;break}return e.abrupt("return");case 13:n={token:l.fcmToken,createTime:null!==(s=l.createTime)&&void 0!==s?s:Date.now(),subscriptionOptions:{auth:l.auth,p256dh:l.p256dh,endpoint:l.endpoint,swScope:l.swScope,vapidKey:"string"==typeof l.vapidKey?l.vapidKey:c0(l.vapidKey)}},e.next=17;break;case 16:3===i?n={token:(f=c).fcmToken,createTime:f.createTime,subscriptionOptions:{auth:c0(f.auth),p256dh:c0(f.p256dh),endpoint:f.endpoint,swScope:f.swScope,vapidKey:c0(f.vapidKey)}}:4===i&&(n={token:(h=c).fcmToken,createTime:h.createTime,subscriptionOptions:{auth:c0(h.auth),p256dh:c0(h.p256dh),endpoint:h.endpoint,swScope:h.swScope,vapidKey:c0(h.vapidKey)}});case 17:case"end":return e.stop()}},e)})),function(e,t,n,i){return r.apply(this,arguments)})});case 10:return e.sent.close(),e.next=13,uz(f0);case 13:return e.next=15,uz("fcm_vapid_details_db");case 15:return e.next=17,uz("undefined");case 17:return e.abrupt("return",p0(n)?n:null);case 18:case"end":return e.stop()}},e)})),v0.apply(this,arguments)}function p0(e){if(!e||!e.subscriptionOptions)return!1;var t=e.subscriptionOptions;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}var g0="firebase-messaging-store",y0=null;function m0(){return y0||(y0=sz("firebase-messaging-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(g0)}})),y0}function k0(e){return C0.apply(this,arguments)}function C0(){return C0=aB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=P0(t),e.next=3,m0();case 3:return e.next=5,e.sent.transaction(g0).objectStore(g0).get(n);case 5:if(!(r=e.sent)){e.next=8;break}return e.abrupt("return",r);case 8:return e.next=10,d0(t.appConfig.senderId);case 10:if(!(i=e.sent)){e.next=15;break}return e.next=14,w0(t,i);case 14:return e.abrupt("return",i);case 15:case"end":return e.stop()}},e)})),C0.apply(this,arguments)}function w0(e,t){return _0.apply(this,arguments)}function _0(){return _0=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=P0(t),e.next=3,m0();case 3:return i=e.sent.transaction(g0,"readwrite"),e.next=6,i.objectStore(g0).put(n,r);case 6:return e.next=8,i.done;case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)})),_0.apply(this,arguments)}function E0(e){return b0.apply(this,arguments)}function b0(){return b0=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=P0(t),e.next=3,m0();case 3:return r=e.sent.transaction(g0,"readwrite"),e.next=6,r.objectStore(g0).delete(n);case 6:return e.next=8,r.done;case 8:case"end":return e.stop()}},e)})),b0.apply(this,arguments)}function P0(e){return e.appConfig.appId}var S0=new IB("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function O0(e,t){return T0.apply(this,arguments)}function T0(){return T0=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N0(t);case 2:return i=e.sent,a=L0(n),o={method:"POST",headers:i,body:JSON.stringify(a)},e.prev=5,e.next=8,fetch(x0(t.appConfig),o);case 8:return e.next=10,e.sent.json();case 10:s=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),S0.create("token-subscribe-failed",{errorInfo:null===(r=e.t0)||void 0===r?void 0:r.toString()});case 16:if(!s.error){e.next=18;break}throw S0.create("token-subscribe-failed",{errorInfo:s.error.message});case 18:if(s.token){e.next=20;break}throw S0.create("token-subscribe-no-token");case 20:return e.abrupt("return",s.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])})),T0.apply(this,arguments)}function I0(e,t){return A0.apply(this,arguments)}function A0(){return A0=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N0(t);case 2:return i=e.sent,a=L0(n.subscriptionOptions),o={method:"PATCH",headers:i,body:JSON.stringify(a)},e.prev=5,e.next=8,fetch("".concat(x0(t.appConfig),"/").concat(n.token),o);case 8:return e.next=10,e.sent.json();case 10:s=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),S0.create("token-update-failed",{errorInfo:null===(r=e.t0)||void 0===r?void 0:r.toString()});case 16:if(!s.error){e.next=18;break}throw S0.create("token-update-failed",{errorInfo:s.error.message});case 18:if(s.token){e.next=20;break}throw S0.create("token-update-no-token");case 20:return e.abrupt("return",s.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])})),A0.apply(this,arguments)}function R0(e,t){return M0.apply(this,arguments)}function M0(){return M0=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N0(t);case 2:return e.t0=e.sent,i={method:"DELETE",headers:e.t0},e.prev=4,e.next=7,fetch("".concat(x0(t.appConfig),"/").concat(n),i);case 7:return e.next=9,e.sent.json();case 9:if(!(a=e.sent).error){e.next=12;break}throw S0.create("token-unsubscribe-failed",{errorInfo:a.error.message});case 12:e.next=17;break;case 14:throw e.prev=14,e.t1=e.catch(4),S0.create("token-unsubscribe-failed",{errorInfo:null===(r=e.t1)||void 0===r?void 0:r.toString()});case 17:case"end":return e.stop()}},e,null,[[4,14]])})),M0.apply(this,arguments)}function x0(e){var t=e.projectId;return"https://fcmregistrations.googleapis.com/v1/projects/".concat(t,"/registrations")}function N0(e){return D0.apply(this,arguments)}function D0(){return D0=aB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.appConfig,r=t.installations,e.next=3,r.getToken();case 3:return i=e.sent,e.abrupt("return",new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":"FIS ".concat(i)}));case 5:case"end":return e.stop()}},e)})),D0.apply(this,arguments)}function L0(e){var t=e.p256dh,n=e.auth,r=e.endpoint,i=e.vapidKey,a={web:{endpoint:r,auth:n,p256dh:t}};return i!==r0&&(a.web.applicationPubKey=i),a}function F0(e){return U0.apply(this,arguments)}function U0(){return U0=aB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z0(t.swRegistration,t.vapidKey);case 2:return n=e.sent,r={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:n.endpoint,auth:c0(n.getKey("auth")),p256dh:c0(n.getKey("p256dh"))},e.next=6,k0(t.firebaseDependencies);case 6:if(!(i=e.sent)){e.next=19;break}if(!W0(i.subscriptionOptions,r)){e.next=10;break}return e.abrupt("return",Date.now()>=i.createTime+6048e5?z0(t,{token:i.token,createTime:Date.now(),subscriptionOptions:r}):i.token);case 10:return e.prev=10,e.next=13,R0(t.firebaseDependencies,i.token);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(10),console.warn(e.t0);case 18:case 19:return e.abrupt("return",G0(t.firebaseDependencies,r));case 20:case"end":return e.stop()}},e,null,[[10,15]])})),U0.apply(this,arguments)}function V0(e){return B0.apply(this,arguments)}function B0(){return B0=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k0(t.firebaseDependencies);case 2:if(n=e.sent,e.t0=n,!e.t0){e.next=9;break}return e.next=7,R0(t.firebaseDependencies,n.token);case 7:return e.next=9,E0(t.firebaseDependencies);case 9:return e.next=11,t.swRegistration.pushManager.getSubscription();case 11:return r=e.sent,e.abrupt("return",!r||r.unsubscribe());case 13:case"end":return e.stop()}},e)})),B0.apply(this,arguments)}function z0(e,t){return H0.apply(this,arguments)}function H0(){return H0=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I0(t.firebaseDependencies,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{token:r,createTime:Date.now()}),e.next=7,w0(t.firebaseDependencies,i);case 7:return e.abrupt("return",r);case 10:return e.prev=10,e.t0=e.catch(0),e.next=14,V0(t);case 14:throw e.t0;case 15:case"end":return e.stop()}},e,null,[[0,10]])})),H0.apply(this,arguments)}function G0(e,t){return $0.apply(this,arguments)}function $0(){return $0=aB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O0(t,n);case 2:return e.t0=e.sent,e.t1=Date.now(),e.t2=n,r={token:e.t0,createTime:e.t1,subscriptionOptions:e.t2},e.next=8,w0(t,r);case 8:return e.abrupt("return",r.token);case 9:case"end":return e.stop()}},e)})),$0.apply(this,arguments)}function Z0(e,t){return q0.apply(this,arguments)}function q0(){return q0=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.pushManager.getSubscription();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:l0(n)});case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e)})),q0.apply(this,arguments)}function W0(e,t){return t.vapidKey===e.vapidKey&&t.endpoint===e.endpoint&&t.auth===e.auth&&t.p256dh===e.p256dh}function j0(e){var t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(t.notification){e.notification={};var n=t.notification.title;n&&(e.notification.title=n);var r=t.notification.body;r&&(e.notification.body=r);var i=t.notification.image;i&&(e.notification.image=i)}}(t,e),function(e,t){!t.data||(e.data=t.data)}(t,e),function(e,t){var n,r,i,a,o;if(t.fcmOptions||(null===(n=t.notification)||void 0===n?void 0:n.click_action)){e.fcmOptions={};var s=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(a=t.notification)||void 0===a?void 0:a.click_action;s&&(e.fcmOptions.link=s);var u=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;u&&(e.fcmOptions.analyticsLabel=u)}}(t,e),t}function Y0(e){return"object"==typeof e&&!!e&&i0 in e}function K0(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function Q0(e){return S0.create("missing-app-config-values",{valueName:e})}K0("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),K0("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");var X0=function(){function e(t,n,r){Zg(this,e),this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;var i=function(e){if(!e||!e.options)throw Q0("App Configuration Object");if(!e.name)throw Q0("App Name");for(var t=e.options,n=0,r=["projectId","apiKey","appId","messagingSenderId"];n<r.length;n++){var i=r[n];if(!t[i])throw Q0(i)}return{appName:e.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(t);this.firebaseDependencies={app:t,appConfig:i,installations:n,analyticsProvider:r}}return Wg(e,[{key:"_delete",value:function(){return Promise.resolve()}}]),e}();function J0(e){return e2.apply(this,arguments)}function e2(){return e2=aB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.serviceWorker.register(t0,{scope:n0});case 3:t.swRegistration=e.sent,t.swRegistration.update().catch(function(){}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),S0.create("failed-service-worker-registration",{browserErrorMessage:null===(n=e.t0)||void 0===n?void 0:n.message});case 10:case"end":return e.stop()}},e,null,[[0,7]])})),e2.apply(this,arguments)}function t2(e,t){return n2.apply(this,arguments)}function n2(){return n2=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!n&&!t.swRegistration,!e.t0){e.next=4;break}return e.next=4,J0(t);case 4:if(!n&&t.swRegistration){e.next=8;break}if(n instanceof ServiceWorkerRegistration){e.next=7;break}throw S0.create("invalid-sw-registration");case 7:t.swRegistration=n;case 8:case"end":return e.stop()}},e)})),n2.apply(this,arguments)}function r2(e,t){return i2.apply(this,arguments)}function i2(){return i2=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n?t.vapidKey=n:t.vapidKey||(t.vapidKey=r0);case 1:case"end":return e.stop()}},e)})),i2.apply(this,arguments)}function a2(){return a2=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator){e.next=2;break}throw S0.create("only-available-in-window");case 2:if(e.t0="default"===Notification.permission,!e.t0){e.next=6;break}return e.next=6,Notification.requestPermission();case 6:if("granted"===Notification.permission){e.next=8;break}throw S0.create("permission-blocked");case 8:return e.next=10,r2(t,null==n?void 0:n.vapidKey);case 10:return e.next=12,t2(t,null==n?void 0:n.serviceWorkerRegistration);case 12:return e.abrupt("return",F0(t));case 13:case"end":return e.stop()}},e)})),a2.apply(this,arguments)}function o2(e,t,n){return s2.apply(this,arguments)}function s2(){return s2=aB(regeneratorRuntime.mark(function e(t,n,r){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=u2(n),e.next=3,t.firebaseDependencies.analyticsProvider.get();case 3:e.sent.logEvent(i,{message_id:r[i0],message_name:r[a0],message_time:r[o0],message_device_time:Math.floor(Date.now()/1e3)});case 4:case"end":return e.stop()}},e)})),s2.apply(this,arguments)}function u2(e){switch(e){case u0.NOTIFICATION_CLICKED:return"notification_open";case u0.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function c2(){return c2=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=n.data).isFirebaseMessaging){e.next=3;break}return e.abrupt("return");case 3:if(t.onMessageHandler&&r.messageType===u0.PUSH_RECEIVED&&("function"==typeof t.onMessageHandler?t.onMessageHandler(j0(r)):t.onMessageHandler.next(j0(r))),i=r.data,e.t0=Y0(i)&&"1"===i[s0],!e.t0){e.next=9;break}return e.next=9,o2(t,r.messageType,i);case 9:case"end":return e.stop()}},e)})),c2.apply(this,arguments)}var l2="@firebase/messaging";function f2(){return(f2=aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,SB();case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",!1);case 8:return e.abrupt("return","undefined"!=typeof window&&PB()&&OB()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"));case 9:case"end":return e.stop()}},e,null,[[0,5]])}))).apply(this,arguments)}_z(new HB("messaging",function(e){var t=new X0(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",function(e){return function(e,t){return c2.apply(this,arguments)}(t,e)}),t},"PUBLIC")),_z(new HB("messaging-internal",function(e){var t=e.getProvider("messaging").getImmediate();return{getToken:function(e){return function(e,t){return a2.apply(this,arguments)}(t,e)}}},"PRIVATE")),Iz(l2,"0.9.16"),Iz(l2,"0.9.16","esm2017");var h2="analytics",d2="firebase_id",v2="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",p2="https://www.googletagmanager.com/gtag/js",g2=new XB("@firebase/analytics");function y2(e){return Promise.all(e.map(function(e){return e.catch(function(e){return e})}))}function m2(e,t){var n=document.createElement("script");n.src="".concat(p2,"?l=").concat(e,"&id=").concat(t),n.async=!0,document.head.appendChild(n)}function k2(e,t,n,r,i,a){return C2.apply(this,arguments)}function C2(){return C2=aB(regeneratorRuntime.mark(function e(t,n,r,i,a,o){var s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=i[a],e.prev=1,!s){e.next=7;break}return e.next=5,n[s];case 5:e.next=14;break;case 7:return e.next=9,y2(r);case 9:if(u=e.sent.find(function(e){return e.measurementId===a}),e.t0=u,!e.t0){e.next=14;break}return e.next=14,n[u.appId];case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(1),g2.error(e.t1);case 19:t("config",a,o);case 20:case"end":return e.stop()}},e,null,[[1,16]])})),C2.apply(this,arguments)}function w2(e,t,n,r,i){return _2.apply(this,arguments)}function _2(){return _2=aB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o,s,u,c,l,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=[],!a||!a.send_to){e.next=26;break}return s=a.send_to,Array.isArray(s)||(s=[s]),e.next=7,y2(r);case 7:u=e.sent,c=Hg(s),e.prev=9,f=function(){var e=l.value,t=u.find(function(t){return t.measurementId===e}),r=t&&n[t.appId];if(!r)return o=[],"break";o.push(r)},c.s();case 12:if((l=c.n()).done){e.next=18;break}if("break"!==f()){e.next=16;break}return e.abrupt("break",18);case 16:e.next=12;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(9),c.e(e.t0);case 23:return e.prev=23,c.f(),e.finish(23);case 26:return 0===o.length&&(o=Object.values(n)),e.next=29,Promise.all(o);case 29:t("event",i,a||{}),e.next=35;break;case 32:e.prev=32,e.t1=e.catch(0),g2.error(e.t1);case 35:case"end":return e.stop()}},e,null,[[0,32],[9,20,23,26]])})),_2.apply(this,arguments)}function E2(){for(var e=window.document.getElementsByTagName("script"),t=0,n=Object.values(e);t<n.length;t++){var r=n[t];if(r.src&&r.src.includes(p2))return r}return null}var b2=new IB("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),P2=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;Zg(this,e),this.throttleMetadata=t,this.intervalMillis=n}return Wg(e,[{key:"getThrottleMetadata",value:function(e){return this.throttleMetadata[e]}},{key:"setThrottleMetadata",value:function(e,t){this.throttleMetadata[e]=t}},{key:"deleteThrottleMetadata",value:function(e){delete this.throttleMetadata[e]}}]),e}());function S2(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}function O2(e){return T2.apply(this,arguments)}function T2(){return T2=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.appId,i=t.apiKey,a={method:"GET",headers:S2(i)},o=v2.replace("{app-id}",r),e.next=6,fetch(o,a);case 6:if(200===(s=e.sent).status||304===s.status){e.next=19;break}return u="",e.prev=9,e.next=12,s.json();case 12:c=e.sent,(null===(n=c.error)||void 0===n?void 0:n.message)&&(u=c.error.message),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(9);case 18:throw b2.create("config-fetch-failed",{httpStatus:s.status,responseMessage:u});case 19:return e.abrupt("return",s.json());case 20:case"end":return e.stop()}},e,null,[[9,16]])})),T2.apply(this,arguments)}function I2(e){return A2.apply(this,arguments)}function A2(){return A2=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:P2,r=l.length>2?l[2]:void 0,i=t.options,a=i.appId,o=i.apiKey,s=i.measurementId,a){e.next=5;break}throw b2.create("no-app-id");case 5:if(o){e.next=9;break}if(!s){e.next=8;break}return e.abrupt("return",{measurementId:s,appId:a});case 8:throw b2.create("no-api-key");case 9:return u=n.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new F2,e.abrupt("return",(setTimeout(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c.abort();case 1:case"end":return e.stop()}},e)})),void 0!==r?r:6e4),R2({appId:a,apiKey:o,measurementId:s},u,c,n)));case 11:case"end":return e.stop()}},e)})),A2.apply(this,arguments)}function R2(e,t,n){return M2.apply(this,arguments)}function M2(){return M2=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,f,h,d,v,p=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.throttleEndTimeMillis,a=n.backoffCount,o=p.length>3&&void 0!==p[3]?p[3]:P2,c=t.appId,l=t.measurementId,e.prev=3,e.next=6,x2(r,i);case 6:e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(3),!l){e.next=12;break}return e.abrupt("return",(g2.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(l,' provided in the "measurementId" field in the local Firebase config. [').concat(null===(s=e.t0)||void 0===s?void 0:s.message,"]")),{appId:c,measurementId:l}));case 12:throw e.t0;case 13:return e.prev=13,e.next=16,O2(t);case 16:return f=e.sent,e.abrupt("return",(o.deleteThrottleMetadata(c),f));case 20:if(e.prev=20,e.t1=e.catch(13),N2(h=e.t1)){e.next=27;break}if(o.deleteThrottleMetadata(c),!l){e.next=26;break}return e.abrupt("return",(g2.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(l,' provided in the "measurementId" field in the local Firebase config. [').concat(null==h?void 0:h.message,"]")),{appId:c,measurementId:l}));case 26:throw e.t1;case 27:return d=503===Number(null===(u=null==h?void 0:h.customData)||void 0===u?void 0:u.httpStatus)?UB(a,o.intervalMillis,30):UB(a,o.intervalMillis),v={throttleEndTimeMillis:Date.now()+d,backoffCount:a+1},e.abrupt("return",(o.setThrottleMetadata(c,v),g2.debug("Calling attemptFetch again in ".concat(d," millis")),R2(t,v,r,o)));case 29:case"end":return e.stop()}},e,null,[[3,8],[13,20]])})),M2.apply(this,arguments)}function x2(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r(b2.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function N2(e){if(!(e instanceof TB&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}var D2,L2,F2=function(){function e(){Zg(this,e),this.listeners=[]}return Wg(e,[{key:"addEventListener",value:function(e){this.listeners.push(e)}},{key:"abort",value:function(){this.listeners.forEach(function(e){return e()})}}]),e}();function U2(){return U2=aB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a||!a.global){e.next=4;break}t("event",r,i),e.next=8;break;case 4:return e.next=6,n;case 6:o=e.sent,t("event",r,Object.assign(Object.assign({},i),{send_to:o}));case 8:case"end":return e.stop()}},e)})),U2.apply(this,arguments)}function V2(e){L2=e}function B2(e){D2=e}function z2(){return H2.apply(this,arguments)}function H2(){return H2=aB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(PB()){e.next=2;break}return e.abrupt("return",(g2.warn(b2.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1));case 2:return e.prev=2,e.next=5,SB();case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(2),e.abrupt("return",(g2.warn(b2.create("indexeddb-unavailable",{errorInfo:null===(t=e.t0)||void 0===t?void 0:t.toString()}).message),!1));case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}},e,null,[[2,7]])})),H2.apply(this,arguments)}function G2(){return G2=aB(regeneratorRuntime.mark(function e(t,n,r,i,a,o,s){var u,c,l,f,h,d,v,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(c=I2(t)).then(function(e){r[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&g2.warn("The measurement ID in the local Firebase config (".concat(t.options.measurementId,") does not match the measurement ID fetched from the server (").concat(e.measurementId,"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config."))}).catch(function(e){return g2.error(e)}),n.push(c),l=z2().then(function(e){if(e)return i.getId()}),e.next=5,Promise.all([c,l]);case 5:return f=e.sent,h=Sg(f,2),d=h[0],v=h[1],E2()||m2(o,d.measurementId),L2&&(a("consent","default",L2),V2(void 0)),a("js",new Date),p=null!==(u=null==s?void 0:s.config)&&void 0!==u?u:{},e.abrupt("return",(p.origin="firebase",p.update=!0,null!=v&&(p[d2]=v),a("config",d.measurementId,p),D2&&(a("set",D2),B2(void 0)),d.measurementId));case 12:case"end":return e.stop()}},e)})),G2.apply(this,arguments)}var $2,Z2,q2=function(){function e(t){Zg(this,e),this.app=t}return Wg(e,[{key:"_delete",value:function(){return delete W2[this.app.options.appId],Promise.resolve()}}]),e}(),W2={},j2=[],Y2={},K2="dataLayer",Q2=!1;function X2(){return(X2=aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!_B()&&OB()&&PB()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,SB();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var J2="@firebase/analytics";_z(new HB(h2,function(e,t){var n=t.options;return function(e,t,n){!function(){var e=[];if(_B()&&e.push("This is a browser extension environment."),OB()||e.push("Cookies are not available."),e.length>0){var t=e.map(function(e,t){return"(".concat(t+1,") ").concat(e)}).join(" "),n=b2.create("invalid-analytics-context",{errorInfo:t});g2.warn(n.message)}}();var r=e.options.appId;if(!r)throw b2.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw b2.create("no-api-key");g2.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '.concat(e.options.measurementId,' provided in the "measurementId" field in the local Firebase config.'))}if(null!=W2[r])throw b2.create("already-exists",{id:r});if(!Q2){!function(e){var t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(K2);var i=function(e,t,n,r,i){var a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(a=window[i]),window[i]=function(e,t,n,r){function i(){return(i=aB(regeneratorRuntime.mark(function i(a,o,s){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,"event"!==a){i.next=6;break}return i.next=4,w2(e,t,n,o,s);case 4:i.next=12;break;case 6:if("config"!==a){i.next=11;break}return i.next=9,k2(e,t,n,r,o,s);case 9:i.next=12;break;case 11:"consent"===a?e("consent","update",s):e("set",o);case 12:i.next=17;break;case 14:i.prev=14,i.t0=i.catch(0),g2.error(i.t0);case 17:case"end":return i.stop()}},i,null,[[0,14]])}))).apply(this,arguments)}return function(e,t,n){return i.apply(this,arguments)}}(a,e,t,n),{gtagCore:a,wrappedGtag:window[i]}}(W2,j2,Y2,K2,"gtag"),a=i.wrappedGtag,o=i.gtagCore;Z2=a,$2=o,Q2=!0}return W2[r]=function(e,t,n,r,i,a,o){return G2.apply(this,arguments)}(e,j2,Y2,t,$2,K2,n),new q2(e)}(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)},"PUBLIC")),_z(new HB("analytics-internal",function(e){try{var t=e.getProvider(h2).getImmediate();return{logEvent:function(e,n,r){return function(e,t,n,r){e=VB(e),function(e,t,n,r,i){return U2.apply(this,arguments)}(Z2,W2[e.app.options.appId],t,n,r).catch(function(e){return g2.error(e)})}(t,e,n,r)}}}catch(t){throw b2.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),Iz(J2,"0.8.0"),Iz(J2,"0.8.0","esm2017");var e3=function(e){xg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this)}return Wg(n,[{key:"schedule",value:function(e){return this}}]),n}(qg),t3={setInterval:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=t3.delegate;return((null==e?void 0:e.setInterval)||setInterval).apply(void 0,arguments)}),clearInterval:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=t3.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)}),delegate:void 0},n3=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i.pending=!1,i}return Wg(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t3.setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!=n&&this.delay===n&&!1===this.pending)return t;t3.clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n,r=!1;try{this.work(e)}catch(i){r=!0,n=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n}},{key:"unsubscribe",value:function(){if(!this.closed){var e=this.id,t=this.scheduler,r=t.actions;this.work=this.state=this.scheduler=null,this.pending=!1,$g(r,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,Rg(Vg(n.prototype),"unsubscribe",this).call(this)}}}]),n}(e3),r3={now:function(){return(r3.delegate||Date).now()},delegate:void 0},i3=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;Zg(this,e),this.schedulerActionCtor=t,this.now=n}return Wg(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.schedulerActionCtor(this,e).schedule(n,t)}}]),e}();i3.now=r3.now;var a3=function(e){xg(n,e);var t=Dg(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i3.now;return Zg(this,n),(r=t.call(this,e,i)).actions=[],r._active=!1,r._scheduled=void 0,r}return Wg(n,[{key:"flush",value:function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),n}(i3),o3=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n)}(a3))(function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i}return Wg(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t>0?Rg(Vg(n.prototype),"schedule",this).call(this,e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}},{key:"execute",value:function(e,t){return t>0||this.closed?Rg(Vg(n.prototype),"execute",this).call(this,e,t):this._execute(e,t)}},{key:"requestAsyncId",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!=r&&r>0||null==r&&this.delay>0?Rg(Vg(n.prototype),"requestAsyncId",this).call(this,e,t,r):e.flush(this)}}]),n}(n3)),s3=new a3(n3),u3=new vO("7.4.1"),c3="__angularfire_symbol__analyticsIsSupportedValue",l3="__angularfire_symbol__analyticsIsSupported",f3="__angularfire_symbol__remoteConfigIsSupportedValue",h3="__angularfire_symbol__remoteConfigIsSupported",d3="__angularfire_symbol__messagingIsSupportedValue",v3="__angularfire_symbol__messagingIsSupported";function p3(e,t,n){if(t){if(1===t.length)return t[0];var r=t.filter(function(e){return e.app===n});if(1===r.length)return r[0]}return n.container.getProvider(e).getImmediate({optional:!0})}globalThis[l3]||(globalThis[l3]=function(){return X2.apply(this,arguments)}().then(function(e){return globalThis[c3]=e}).catch(function(){return globalThis[c3]=!1})),globalThis[v3]||(globalThis[v3]=function(){return f2.apply(this,arguments)}().then(function(e){return globalThis[d3]=e}).catch(function(){return globalThis[d3]=!1})),globalThis[h3]||(globalThis[h3]=function(){return e0.apply(this,arguments)}().then(function(e){return globalThis[f3]=e}).catch(function(){return globalThis[f3]=!1}));var g3=function(e,t){var n=t?[t]:Tz(),r=[];return n.forEach(function(t){t.container.getProvider(e).instances.forEach(function(e){r.includes(e)||r.push(e)})}),r};function y3(){}var m3=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o3;Zg(this,e),this.zone=t,this.delegate=n}return Wg(e,[{key:"now",value:function(){return this.delegate.now()}},{key:"schedule",value:function(e,t,n){var r=this.zone;return this.delegate.schedule(function(t){var n=this;r.runGuarded(function(){e.apply(n,[t])})},t,n)}}]),e}(),k3=function(){function e(t){Zg(this,e),this.zone=t,this.task=null}return Wg(e,[{key:"call",value:function(e,t){var n=this.unscheduleTask.bind(this);return this.task=this.zone.run(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",y3,{},y3,y3)}),t.pipe(mN({next:n,complete:n,error:n})).subscribe(e).add(n)}},{key:"unscheduleTask",value:function(){var e=this;setTimeout(function(){null!=e.task&&"scheduled"===e.task.state&&(e.task.invoke(),e.task=null)},10)}}]),e}(),C3=function(){var e=Wg(function e(t){Zg(this,e),this.ngZone=t,this.outsideAngular=t.runOutsideAngular(function(){return new m3(Zone.current)}),this.insideAngular=t.run(function(){return new m3(Zone.current,s3)}),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)});return e.\u0275fac=function(t){return new(t||e)(pw(eI))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function w3(){var e=globalThis.\u0275AngularFireScheduler;if(!e)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return e}function _3(e){return w3().ngZone.runOutsideAngular(function(){return e()})}function E3(e){return w3().ngZone.run(function(){return e()})}function b3(e){return w3(),function(e){return function(t){return(t=t.lift(new k3(e.ngZone))).pipe(Yy(e.outsideAngular),jy(e.insideAngular))}}(w3())(e)}var P3=function(e,t){var n=void 0;return function(){var r=arguments;return t&&setTimeout(function(){"scheduled"===t.state&&t.invoke()},10),E3(function(){return e.apply(n,r)})}},S3=function(e,t){return function(){for(var n,r=this,i=arguments,a=0;a<arguments.length;a++)"function"==typeof i[a]&&(t&&(n||(n=E3(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",y3,{},y3,y3)}))),i[a]=P3(i[a],n));var o=_3(function(){return e.apply(r,i)});if(!t){if(o instanceof yy){var s=w3();return o.pipe(Yy(s.outsideAngular),jy(s.insideAngular))}return E3(function(){return o})}return o instanceof yy?o.pipe(b3):o instanceof Promise?E3(function(){return new Promise(function(e,t){return o.then(function(t){return E3(function(){return e(t)})},function(e){return E3(function(){return t(e)})})})}):"function"==typeof o&&n?function(){return setTimeout(function(){n&&"scheduled"===n.state&&n.invoke()},10),o.apply(this,arguments)}:E3(function(){return o})}},O3=Wg(function e(t){return Zg(this,e),t}),T3=Wg(function e(){return Zg(this,e),Tz()}),I3=new YC("angularfire2._apps"),A3={provide:O3,useFactory:function(e){return e&&1===e.length?e[0]:new O3(Oz())},deps:[[new Ew,I3]]},R3={provide:T3,deps:[[new Ew,I3]]};function M3(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new O3(r)}}var x3=function(){var e=Wg(function e(t){Zg(this,e),Iz("angularfire",u3.full,"core"),Iz("angularfire",u3.full,"app"),Iz("angular",pO.full,t.toString())});return e.\u0275fac=function(t){return new(t||e)(pw(VT))},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({providers:[A3,R3]}),e}(),N3=S3(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"object"!=typeof t&&(t={name:t});var n=Object.assign({name:yz,automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw bz.create("bad-app-name",{appName:String(r)});var i=kz.get(r);if(i){if(RB(e,i.options)&&RB(n,i.config))return i;throw bz.create("duplicate-app",{appName:r})}var a,o=new ZB(r),s=Hg(Cz.values());try{for(s.s();!(a=s.n()).done;){var u=a.value;o.addComponent(u)}}catch(l){s.e(l)}finally{s.f()}var c=new Pz(e,n,o);return kz.set(r,c),c},!0),D3=new Map,L3={activated:!1,tokenObservers:[]},F3={initialized:!1,enabled:!1};function U3(e){return D3.get(e)||L3}function V3(e,t){D3.set(e,t)}function B3(){return F3}var z3=function(){function e(t,n,r,i,a){if(Zg(this,e),this.operation=t,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}return Wg(e,[{key:"start",value:function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(function(){})}},{key:"stop",value:function(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}},{key:"isRunning",value:function(){return!!this.pending}},{key:"process",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.stop(),n.prev=1,t.pending=new kB,n.next=5,function(e){return new Promise(function(t){setTimeout(t,e)})}(t.getNextRun(e));case 5:return t.pending.resolve(),n.next=8,t.pending.promise;case 8:return t.pending=new kB,n.next=11,t.operation();case 11:return t.pending.resolve(),n.next=14,t.pending.promise;case 14:t.process(!0).catch(function(){}),n.next=20;break;case 17:n.prev=17,n.t0=n.catch(1),t.retryPolicy(n.t0)?t.process(!1).catch(function(){}):t.stop();case 20:case"end":return n.stop()}},n,null,[[1,17]])}))()}},{key:"getNextRun",value:function(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}]),e}(),H3=new IB("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function G3(e){if(!U3(e).activated)throw H3.create("use-before-activation",{appName:e.name})}function $3(e,t){return Z3.apply(this,arguments)}function Z3(){return Z3=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l,f,h,d,v,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.url,i=t.body,s={"Content-Type":"application/json"},!(u=n.getImmediate({optional:!0}))){e.next=7;break}return e.next=5,u.getHeartbeatsHeader();case 5:(c=e.sent)&&(s["X-Firebase-Client"]=c);case 7:return l={method:"POST",body:JSON.stringify(i),headers:s},e.prev=8,e.next=11,fetch(r,l);case 11:f=e.sent,e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(8),H3.create("fetch-network-error",{originalErrorMessage:null===(a=e.t0)||void 0===a?void 0:a.message});case 17:if(200===f.status){e.next=19;break}throw H3.create("fetch-status-error",{httpStatus:f.status});case 19:return e.prev=19,e.next=22,f.json();case 22:h=e.sent,e.next=28;break;case 25:throw e.prev=25,e.t1=e.catch(19),H3.create("fetch-parse-error",{originalErrorMessage:null===(o=e.t1)||void 0===o?void 0:o.message});case 28:if((d=h.ttl.match(/^([\d.]+)(s)$/))&&d[2]&&!isNaN(Number(d[1]))){e.next=31;break}throw H3.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration format: ".concat(h.ttl)});case 31:return v=1e3*Number(d[1]),p=Date.now(),e.abrupt("return",{token:h.token,expireTimeMillis:p+v,issuedAtTimeMillis:p});case 33:case"end":return e.stop()}},e,null,[[8,14],[19,25]])})),Z3.apply(this,arguments)}function q3(e,t){var n=e.options,r=n.projectId,i=n.appId,a=n.apiKey;return{url:"https://content-firebaseappcheck.googleapis.com/v1/projects/".concat(r,"/apps/").concat(i,":exchangeDebugToken?key=").concat(a),body:{debug_token:t}}}var W3="firebase-app-check-store",j3=null;function Y3(){return j3||(j3=new Promise(function(e,t){var n;try{var r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=function(t){e(t.target.result)},r.onerror=function(e){var n;t(H3.create("storage-open",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))},r.onupgradeneeded=function(e){0===e.oldVersion&&e.target.result.createObjectStore(W3,{keyPath:"compositeKey"})}}catch(r){t(H3.create("storage-open",{originalErrorMessage:null===(n=r)||void 0===n?void 0:n.message}))}}),j3)}function K3(){return K3=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y3();case 2:return r=e.sent.transaction(W3,"readwrite"),i=r.objectStore(W3).put({compositeKey:t,value:n}),e.abrupt("return",new Promise(function(e,t){i.onsuccess=function(t){e()},r.onerror=function(e){var n;t(H3.create("storage-set",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))}}));case 5:case"end":return e.stop()}},e)})),K3.apply(this,arguments)}var Q3=new XB("@firebase/app-check");function X3(e,t){return PB()?function(e,t){return function(e,t){return K3.apply(this,arguments)}(function(e){return"".concat(e.options.appId,"-").concat(e.name)}(e),t)}(e,t).catch(function(e){Q3.warn("Failed to write token to IndexedDB. Error: ".concat(e))}):Promise.resolve()}function J3(){return B3().enabled}function e4(){return t4.apply(this,arguments)}function t4(){return t4=aB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=B3()).enabled||!t.token){e.next=3;break}return e.abrupt("return",t.token.promise);case 3:throw Error("\n            Can't get debug token in production mode.\n        ");case 4:case"end":return e.stop()}},e)})),t4.apply(this,arguments)}var n4={error:"UNKNOWN_ERROR"};function r4(e){return yB.encodeString(JSON.stringify(e),!1)}function i4(e){return a4.apply(this,arguments)}function a4(){return a4=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l,f=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>1&&void 0!==f[1]&&f[1],G3(r=t.app),i=U3(r),o=i.token){e.next=10;break}return e.next=8,i.cachedTokenPromise;case 8:(s=e.sent)&&c4(s)&&(o=s);case 10:if(n||!o||!c4(o)){e.next=12;break}return e.abrupt("return",{token:o.token});case 12:if(c=!1,!J3()){e.next=33;break}if(e.t0=i.exchangeTokenPromise,e.t0){e.next=26;break}return e.t1=$3,e.t2=q3,e.t3=r,e.next=21,e4();case 21:e.t4=e.sent,e.t5=(0,e.t2)(e.t3,e.t4),e.t6=t.heartbeatServiceProvider,i.exchangeTokenPromise=(0,e.t1)(e.t5,e.t6).then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0;case 26:return e.next=28,i.exchangeTokenPromise;case 28:return l=e.sent,e.next=31,X3(r,l);case 31:return V3(r,Object.assign(Object.assign({},i),{token:l})),e.abrupt("return",{token:l.token});case 33:return e.prev=33,i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0),e.next=37,i.exchangeTokenPromise;case 37:o=e.sent,e.next=43;break;case 40:e.prev=40,e.t7=e.catch(33),"appCheck/throttled"===e.t7.code?Q3.warn(e.t7.message):Q3.error(e.t7),a=e.t7;case 43:if(!o){e.next=50;break}return u={token:o.token},V3(r,Object.assign(Object.assign({},i),{token:o})),e.next=48,X3(r,o);case 48:e.next=51;break;case 50:u=l4(a);case 51:return c&&u4(r,u),e.abrupt("return",u);case 53:case"end":return e.stop()}},e,null,[[33,40]])})),a4.apply(this,arguments)}function o4(e,t){var n=U3(e),r=n.tokenObservers.filter(function(e){return e.next!==t});0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),V3(e,Object.assign(Object.assign({},n),{tokenObservers:r}))}function s4(e){var t=e.app,n=U3(t),r=n.tokenRefresher;r||(r=function(e){var t=e.app;return new z3(aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!U3(t).token){n.next=6;break}return n.next=3,i4(e,!0);case 3:n.t0=n.sent,n.next=9;break;case 6:return n.next=8,i4(e);case 8:n.t0=n.sent;case 9:if(!(r=n.t0).error){n.next=12;break}throw r.error;case 12:case"end":return n.stop()}},n)})),function(){return!0},function(){var e=U3(t);if(e.token){var n=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,e.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0},3e4,96e4)}(e),V3(t,Object.assign(Object.assign({},n),{tokenRefresher:r}))),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function u4(e,t){var n,r=Hg(U3(e).tokenObservers);try{for(r.s();!(n=r.n()).done;){var i=n.value;try{"EXTERNAL"===i.type&&null!=t.error?i.error(t.error):i.next(t)}catch(a){}}}catch(o){r.e(o)}finally{r.f()}}function c4(e){return e.expireTimeMillis-Date.now()>0}function l4(e){return{token:r4(n4),error:e}}var f4=function(){function e(t,n){Zg(this,e),this.app=t,this.heartbeatServiceProvider=n}return Wg(e,[{key:"_delete",value:function(){var e,t=Hg(U3(this.app).tokenObservers);try{for(t.s();!(e=t.n()).done;){var n=e.value;o4(this.app,n.next)}}catch(r){t.e(r)}finally{t.f()}return Promise.resolve()}}]),e}(),h4="app-check-internal";_z(new HB("app-check",function(e){return function(e,t){return new f4(e,t)}(e.getProvider("app").getImmediate(),e.getProvider("heartbeat"))},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider(h4).initialize()})),_z(new HB(h4,function(e){return function(e){return{getToken:function(t){return i4(e,t)},addTokenListener:function(t){return function(e,t,n,r){var i=e.app,a=U3(i),o={next:n,error:void 0,type:"INTERNAL"};if(V3(i,Object.assign(Object.assign({},a),{tokenObservers:[].concat(Bg(a.tokenObservers),[o])})),a.token&&c4(a.token)){var s=a.token;Promise.resolve().then(function(){n({token:s.token}),s4(e)}).catch(function(){})}a.cachedTokenPromise.then(function(){return s4(e)})}(e,0,t)},removeTokenListener:function(t){return o4(e.app,t)}}}(e.getProvider("app-check").getImmediate())},"PUBLIC").setInstantiationMode("EXPLICIT")),Iz("@firebase/app-check","0.5.11");var d4=Wg(function e(){return Zg(this,e),g3("app-check")});"undefined"!=typeof window&&window;var v4=new IB("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),p4=new XB("@firebase/auth");function g4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];p4.logLevel<=WB.ERROR&&p4.error.apply(p4,["Auth (9.9.0): ".concat(e)].concat(n))}function y4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw w4.apply(void 0,[e].concat(n))}function m4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return w4.apply(void 0,[e].concat(n))}function k4(e,t,n){var r=Object.assign(Object.assign({},{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Pg({},t,n));return new IB("auth","Firebase",r).create(t,{appName:e.name})}function C4(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&y4(e,"argument-error"),k4(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.Did you pass a reference from a different Auth SDK?"))}function w4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!=typeof e){var i,a=n[0],o=Bg(n.slice(1));return o[0]&&(o[0].appName=e.name),(i=e._errorFactory).create.apply(i,[a].concat(Bg(o)))}return v4.create.apply(v4,[e].concat(n))}function _4(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(!e)throw w4.apply(void 0,[t].concat(r))}function E4(e){var t="INTERNAL ASSERTION FAILED: "+e;throw g4(t),new Error(t)}function b4(e,t){e||E4(t)}var P4=new Map;function S4(e){b4(e instanceof Function,"Expected a class definition");var t=P4.get(e);return t?(b4(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,P4.set(e,t),t)}function O4(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function T4(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}var I4=function(){function e(t,n){Zg(this,e),this.shortDelay=t,this.longDelay=n,b4(n>t,"Short delay should be less than long delay!"),this.isMobile=wB()||EB()}return Wg(e,[{key:"get",value:function(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===T4()||"https:"===T4()||_B()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),e}();function A4(e,t){b4(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var R4=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void E4("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void E4("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void E4("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),M4={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},x4=new I4(3e4,6e4);function N4(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function D4(e,t,n,r){return L4.apply(this,arguments)}function L4(){return L4=aB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>4&&void 0!==o[4]?o[4]:{},e.abrupt("return",F4(t,a,aB(regeneratorRuntime.mark(function e(){var a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={},o={},i&&("GET"===n?o=i:a={body:JSON.stringify(i)}),s=xB(Object.assign({key:t.config.apiKey},o)).slice(1),e.next=5,t._getAdditionalHeaders();case 5:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode),R4.fetch()(z4(t,t.config.apiHost,r,s),Object.assign({method:n,headers:u,referrerPolicy:"no-referrer"},a))));case 7:case"end":return e.stop()}},e)}))));case 2:case"end":return e.stop()}},e)})),L4.apply(this,arguments)}function F4(e,t,n){return U4.apply(this,arguments)}function U4(){return U4=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,f,h,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,i=Object.assign(Object.assign({},M4),n),e.prev=2,a=new H4(t),e.next=6,Promise.race([r(),a.promise]);case 6:return o=e.sent,a.clearNetworkTimeout(),e.next=10,o.json();case 10:if(!("needConfirmation"in(s=e.sent))){e.next=13;break}throw G4(t,"account-exists-with-different-credential",s);case 13:if(!o.ok||"errorMessage"in s){e.next=15;break}return e.abrupt("return",s);case 15:if(u=o.ok?s.errorMessage:s.error.message,c=u.split(" : "),l=Sg(c,2),f=l[0],h=l[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==f){e.next=18;break}throw G4(t,"credential-already-in-use",s);case 18:if("EMAIL_EXISTS"!==f){e.next=20;break}throw G4(t,"email-already-in-use",s);case 20:if("USER_DISABLED"!==f){e.next=22;break}throw G4(t,"user-disabled",s);case 22:if(d=i[f]||f.toLowerCase().replace(/[_\s]+/g,"-"),!h){e.next=25;break}throw k4(t,d,h);case 25:y4(t,d),e.next=33;break;case 28:if(e.prev=28,e.t0=e.catch(2),!(e.t0 instanceof TB)){e.next=32;break}throw e.t0;case 32:y4(t,"network-request-failed");case 33:case"end":return e.stop()}},e,null,[[2,28]])})),U4.apply(this,arguments)}function V4(e,t,n,r){return B4.apply(this,arguments)}function B4(){return B4=aB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>4&&void 0!==s[4]?s[4]:{},e.next=3,D4(t,n,r,i,a);case 3:return o=e.sent,e.abrupt("return",("mfaPendingCredential"in o&&y4(t,"multi-factor-auth-required",{_serverResponse:o}),o));case 5:case"end":return e.stop()}},e)})),B4.apply(this,arguments)}function z4(e,t,n,r){var i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?A4(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}var H4=function(){function e(t){var n=this;Zg(this,e),this.auth=t,this.timer=null,this.promise=new Promise(function(e,t){n.timer=setTimeout(function(){return t(m4(n.auth,"network-request-failed"))},x4.get())})}return Wg(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function G4(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=m4(e,t,r);return i.customData._tokenResponse=n,i}function $4(){return $4=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",D4(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}},e)})),$4.apply(this,arguments)}function Z4(e,t){return q4.apply(this,arguments)}function q4(){return q4=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",D4(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}},e)})),q4.apply(this,arguments)}function W4(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(n){}}function j4(){return j4=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],r=VB(t),e.next=4,r.getIdToken(n);case 4:return i=e.sent,_4((a=K4(i))&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error"),o="object"==typeof a.firebase?a.firebase:void 0,s=null==o?void 0:o.sign_in_provider,e.abrupt("return",{claims:a,token:i,authTime:W4(Y4(a.auth_time)),issuedAtTime:W4(Y4(a.iat)),expirationTime:W4(Y4(a.exp)),signInProvider:s||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null});case 9:case"end":return e.stop()}},e)})),j4.apply(this,arguments)}function Y4(e){return 1e3*Number(e)}function K4(e){var t,n=Sg(e.split("."),3),r=n[0],i=n[1],a=n[2];if(void 0===r||void 0===i||void 0===a)return g4("JWT malformed, contained fewer than 3 sections"),null;try{var o=function(e){try{return yB.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(i);return o?JSON.parse(o):(g4("Failed to decode base64 JWT payload"),null)}catch(s){return g4("Caught error parsing JWT payload as JSON",null===(t=s)||void 0===t?void 0:t.toString()),null}}function Q4(e,t){return X4.apply(this,arguments)}function X4(){return X4=aB(regeneratorRuntime.mark(function e(t,n){var r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),e.t1=e.t0 instanceof TB&&J4(e.t0)&&t.auth.currentUser===t,!e.t1){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}},e,null,[[3,9]])})),X4.apply(this,arguments)}function J4(e){var t=e.code;return"auth/user-disabled"===t||"auth/user-token-expired"===t}var e5=function(){function e(t){Zg(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return Wg(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;if(this.isRunning){var n=this.getInterval(e);this.timerId=setTimeout(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.iteration();case 2:case"end":return e.stop()}},e)})),n)}}},{key:"iteration",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.user.getIdToken(!0);case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",void("auth/network-request-failed"===(null===(n=t.t0)||void 0===n?void 0:n.code)&&e.schedule(!0)));case 8:e.schedule();case 9:case"end":return t.stop()}},t,null,[[0,5]])}))()}}]),e}(),t5=function(){function e(t,n){Zg(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return Wg(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=W4(this.lastLoginAt),this.creationTime=W4(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function n5(e){return r5.apply(this,arguments)}function r5(){return r5=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return i=e.sent,e.next=6,Q4(t,Z4(r,{idToken:i}));case 6:_4(null==(a=e.sent)?void 0:a.users.length,r,"internal-error"),o=a.users[0],t._notifyReloadListener(o),s=(null===(n=o.providerUserInfo)||void 0===n?void 0:n.length)?o5(o.providerUserInfo):[],u=a5(t.providerData,s),c=!!t.isAnonymous&&!(t.email&&o.passwordHash||(null==u?void 0:u.length)),l={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new t5(o.createdAt,o.lastLoginAt),isAnonymous:c},Object.assign(t,l);case 12:case"end":return e.stop()}},e)})),r5.apply(this,arguments)}function i5(){return i5=aB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=VB(t),e.next=3,n5(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}},e)})),i5.apply(this,arguments)}function a5(e,t){return[].concat(Bg(e.filter(function(e){return!t.some(function(t){return t.providerId===e.providerId})})),Bg(t))}function o5(e){return e.map(function(e){var t=e.providerId,n=Sy(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}function s5(){return s5=aB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F4(t,{},aB(regeneratorRuntime.mark(function e(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=xB({grant_type:"refresh_token",refresh_token:n}).slice(1),i=t.config,a=i.tokenApiHost,o=i.apiKey,s=z4(t,a,"/v1/token","key=".concat(o)),e.next=7,t._getAdditionalHeaders();case 7:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/x-www-form-urlencoded",R4.fetch()(s,{method:"POST",headers:u,body:r})));case 9:case"end":return e.stop()}},e)})));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}},e)})),s5.apply(this,arguments)}var u5=function(){function e(){Zg(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return Wg(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){_4(e.idToken,"internal-error"),_4(void 0!==e.idToken,"internal-error"),_4(void 0!==e.refreshToken,"internal-error");var t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){var t=K4(e);return _4(t,"internal-error"),_4(void 0!==t.exp,"internal-error"),_4(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"getToken",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(_4(!n.accessToken||n.refreshToken,e,"user-token-expired"),!t&&n.accessToken&&!n.isExpired){r.next=12;break}if(!n.refreshToken){r.next=8;break}return r.next=5,n.refresh(e,n.refreshToken);case 5:r.t1=n.accessToken,r.next=9;break;case 8:r.t1=null;case 9:r.t0=r.t1,r.next=13;break;case 12:r.t0=n.accessToken;case 13:return r.abrupt("return",r.t0);case 14:case"end":return r.stop()}},r)}))()}},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,function(e,t){return s5.apply(this,arguments)}(e,t);case 2:i=r.sent,a=i.accessToken,o=i.refreshToken,s=i.expiresIn,n.updateTokensAndExpiration(a,o,Number(s));case 7:case"end":return r.stop()}},r)}))()}},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return E4("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,i=n.accessToken,a=n.expirationTime,o=new e;return r&&(_4("string"==typeof r,"internal-error",{appName:t}),o.refreshToken=r),i&&(_4("string"==typeof i,"internal-error",{appName:t}),o.accessToken=i),a&&(_4("number"==typeof a,"internal-error",{appName:t}),o.expirationTime=a),o}}]),e}();function c5(e,t){_4("string"==typeof e||void 0===e,"internal-error",{appName:t})}var l5=function(){function e(t){Zg(this,e);var n=t.uid,r=t.auth,i=t.stsTokenManager,a=Sy(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new e5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?Bg(a.providerData):[],this.metadata=new t5(a.createdAt||void 0,a.lastLoginAt||void 0)}return Wg(e,[{key:"getIdToken",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Q4(t,t.stsTokenManager.getToken(t.auth,e));case 2:if(_4(r=n.sent,t.auth,"internal-error"),n.t0=t.accessToken!==r,!n.t0){n.next=10;break}return t.accessToken=r,n.next=9,t.auth._persistUserIfCurrent(t);case 9:t.auth._notifyListenersIfCurrent(t);case 10:return n.abrupt("return",r);case 11:case"end":return n.stop()}},n)}))()}},{key:"getIdTokenResult",value:function(e){return function(e){return j4.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return i5.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(_4(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(function(e){return Object.assign({},e)}),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){return new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(e){_4(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=!1,e.idToken&&e.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(e),i=!0),r.t0=t,!r.t0){r.next=6;break}return r.next=6,n5(n);case 6:return r.next=8,n.auth._persistUserIfCurrent(n);case 8:i&&n.auth._notifyListenersIfCurrent(n);case 9:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getIdToken();case 2:return n=t.sent,t.next=5,Q4(e,function(e,t){return $4.apply(this,arguments)}(e.auth,{idToken:n}));case 5:return e.stsTokenManager.clearRefreshToken(),t.abrupt("return",e.auth.signOut());case 7:case"end":return t.stop()}},t)}))()}},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(function(e){return Object.assign({},e)}),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,i,a,o,s,u,c,l,f=null!==(r=n.displayName)&&void 0!==r?r:void 0,h=null!==(i=n.email)&&void 0!==i?i:void 0,d=null!==(a=n.phoneNumber)&&void 0!==a?a:void 0,v=null!==(o=n.photoURL)&&void 0!==o?o:void 0,p=null!==(s=n.tenantId)&&void 0!==s?s:void 0,g=null!==(u=n._redirectEventId)&&void 0!==u?u:void 0,y=null!==(c=n.createdAt)&&void 0!==c?c:void 0,m=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,k=n.uid,C=n.emailVerified,w=n.isAnonymous,_=n.providerData,E=n.stsTokenManager;_4(k&&E,t,"internal-error");var b=u5.fromJSON(this.name,E);_4("string"==typeof k,t,"internal-error"),c5(f,t.name),c5(h,t.name),_4("boolean"==typeof C,t,"internal-error"),_4("boolean"==typeof w,t,"internal-error"),c5(d,t.name),c5(v,t.name),c5(p,t.name),c5(g,t.name),c5(y,t.name),c5(m,t.name);var P=new e({uid:k,auth:t,email:h,emailVerified:C,displayName:f,isAnonymous:w,photoURL:v,phoneNumber:d,tenantId:p,stsTokenManager:b,createdAt:y,lastLoginAt:m});return _&&Array.isArray(_)&&(P.providerData=_.map(function(e){return Object.assign({},e)})),g&&(P._redirectEventId=g),P}},{key:"_fromIdTokenResponse",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return aB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return(a=new u5).updateFromServerResponse(n),o=new e({uid:n.localId,auth:t,stsTokenManager:a,isAnonymous:r}),i.next=5,n5(o);case 5:return i.abrupt("return",o);case 6:case"end":return i.stop()}},i)}))()}}]),e}(),f5=function(){var e=function(){function e(){Zg(this,e),this.type="NONE",this.storage={}}return Wg(e,[{key:"_isAvailable",value:function(){return aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}},e)}))()}},{key:"_set",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n.storage[e]=t;case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.storage[e],n.abrupt("return",void 0===r?null:r);case 2:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:delete t.storage[e];case 1:case"end":return n.stop()}},n)}))()}},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();return e.type="NONE",e}();function h5(e,t,n){return"firebase:".concat(e,":").concat(t,":").concat(n)}var d5=function(){function e(t,n,r){Zg(this,e),this.persistence=t,this.auth=n,this.userKey=r;var i=this.auth,a=i.config,o=i.name;this.fullUserKey=h5(this.userKey,a.apiKey,o),this.fullPersistenceKey=h5("persistence",a.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return Wg(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.persistence._get(e.fullUserKey);case 2:return n=t.sent,t.abrupt("return",n?l5._fromJSON(e.auth,n):null);case 4:case"end":return t.stop()}},t)}))()}},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.persistence!==e){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.getCurrentUser();case 4:return r=n.sent,n.next=7,t.removeCurrentUser();case 7:return t.persistence=e,n.abrupt("return",r?t.setCurrentUser(r):void 0);case 9:case"end":return n.stop()}},n)}))()}},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";return aB(regeneratorRuntime.mark(function i(){var a,o,s,u,c,l,f,h,d,v;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(n.length){i.next=2;break}return i.abrupt("return",new e(S4(f5),t,r));case 2:return i.next=4,Promise.all(n.map(function(){var e=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 4:a=i.sent.filter(function(e){return e}),o=a[0]||S4(f5),s=h5(r,t.config.apiKey,t.name),u=null,c=Hg(n),i.prev=9,c.s();case 11:if((l=c.n()).done){i.next=27;break}return f=l.value,i.prev=13,i.next=16,f._get(s);case 16:if(!(h=i.sent)){i.next=21;break}return d=l5._fromJSON(t,h),f!==o&&(u=d),o=f,i.abrupt("break",27);case 21:i.next=25;break;case 23:i.prev=23,i.t0=i.catch(13);case 25:i.next=11;break;case 27:i.next=32;break;case 29:i.prev=29,i.t1=i.catch(9),c.e(i.t1);case 32:return i.prev=32,c.f(),i.finish(32);case 35:if(v=a.filter(function(e){return e._shouldAllowMigration}),!o._shouldAllowMigration||!v.length){i.next=47;break}if(o=v[0],i.t3=u,!i.t3){i.next=42;break}return i.next=42,o._set(s,u.toJSON());case 42:return i.next=44,Promise.all(n.map(function(){var e=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t===o){e.next=8;break}return e.prev=1,e.next=4,t._remove(s);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}()));case 44:i.t2=new e(o,t,r),i.next=48;break;case 47:i.t2=new e(o,t,r);case 48:return i.abrupt("return",i.t2);case 49:case"end":return i.stop()}},i,null,[[9,29,32,35],[13,23]])}))()}}]),e}();function v5(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(m5(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(p5(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(C5(t))return"Blackberry";if(w5(t))return"Webos";if(g5(t))return"Safari";if((t.includes("chrome/")||y5(t))&&!t.includes("edge/"))return"Chrome";if(k5(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null==n?void 0:n.length)?n[1]:"Other"}function p5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB();return/firefox\//i.test(e)}function g5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB(),t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function y5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB();return/crios\//i.test(e)}function m5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB();return/iemobile/i.test(e)}function k5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB();return/android/i.test(e)}function C5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB();return/blackberry/i.test(e)}function w5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB();return/webos/i.test(e)}function _5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function E5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB();return _5(e)||k5(e)||w5(e)||C5(e)||/windows phone/i.test(e)||m5(e)}function b5(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=v5(CB());break;case"Worker":t="".concat(v5(CB()),"-").concat(e);break;default:t=e}return"".concat(t,"/JsCore/9.9.0/").concat(n.length?n.join(","):"FirebaseCore-web")}var P5=function(){function e(t){Zg(this,e),this.auth=t,this.queue=[]}return Wg(e,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise(function(n,r){try{n(e(t))}catch(i){r(i)}})};r.onAbort=t,this.queue.push(r);var i=this.queue.length-1;return function(){n.queue[i]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.auth.currentUser!==e){n.next=2;break}return n.abrupt("return");case 2:i=[],n.prev=3,a=Hg(t.queue),n.prev=5,a.s();case 7:if((o=a.n()).done){n.next=14;break}return s=o.value,n.next=11,s(e);case 11:s.onAbort&&i.push(s.onAbort);case 12:n.next=7;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n.catch(5),a.e(n.t0);case 19:return n.prev=19,a.f(),n.finish(19);case 22:n.next=30;break;case 24:n.prev=24,n.t1=n.catch(3),i.reverse(),u=Hg(i);try{for(u.s();!(c=u.n()).done;){l=c.value;try{l()}catch(f){}}}catch(h){u.e(h)}finally{u.f()}throw t.auth._errorFactory.create("login-blocked",{originalMessage:null===(r=n.t1)||void 0===r?void 0:r.message});case 30:case"end":return n.stop()}},n,null,[[3,24],[5,16,19,22]])}))()}}]),e}(),S5=function(){function e(t,n,r){Zg(this,e),this.app=t,this.heartbeatServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new T5(this),this.idTokenSubscription=new T5(this),this.beforeStateQueue=new P5(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=v4,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}return Wg(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=S4(t)),this._initializationPromise=this.queue(aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=!n._deleted,!r.t0){r.next=6;break}return r.next=4,d5.create(n,e);case 4:n.persistenceManager=r.sent,r.t0=!n._deleted;case 6:if(!r.t0){r.next=19;break}if(!(null===(i=n._popupRedirectResolver)||void 0===i?void 0:i._shouldInitProactively)){r.next=15;break}return r.prev=8,r.next=11,n._popupRedirectResolver._initialize(n);case 11:r.next=15;break;case 13:r.prev=13,r.t1=r.catch(8);case 15:return r.next=17,n.initializeCurrentUser(t);case 17:n.lastNotifiedUid=(null===(a=n.currentUser)||void 0===a?void 0:a.uid)||null,!n._deleted&&(n._isInitialized=!0);case 19:case"end":return r.stop()}},r,null,[[8,13]])}))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._deleted){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.assertedPersistence.getCurrentUser();case 4:if(n=t.sent,!e.currentUser&&!n){t.next=13;break}if(!e.currentUser||!n||e.currentUser.uid!==n.uid){t.next=11;break}return e._currentUser._assign(n),t.next=10,e.currentUser.getIdToken();case 10:return t.abrupt("return",void t.sent);case 11:return t.next=13,e._updateCurrentUser(n,!0);case 13:case"end":return t.stop()}},t)}))()}},{key:"initializeCurrentUser",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.getCurrentUser();case 2:if(i=n.sent,a=i,o=!1,!e||!t.config.authDomain){n.next=13;break}return n.next=7,t.getOrInitRedirectPersistenceManager();case 7:return s=null===(r=t.redirectUser)||void 0===r?void 0:r._redirectEventId,u=null==a?void 0:a._redirectEventId,n.next=11,t.tryRedirectSignIn(e);case 11:c=n.sent,(!s||s===u)&&(null==c?void 0:c.user)&&(a=c.user,o=!0);case 13:if(a){n.next=15;break}return n.abrupt("return",t.directlySetCurrentUser(null));case 15:if(a._redirectEventId){n.next=26;break}if(!o){n.next=25;break}return n.prev=17,n.next=20,t.beforeStateQueue.runMiddleware(a);case 20:n.next=25;break;case 22:n.prev=22,n.t0=n.catch(17),a=i,t._popupRedirectResolver._overrideRedirectResult(t,function(){return Promise.reject(n.t0)});case 25:return n.abrupt("return",a?t.reloadAndSetCurrentUserOrClear(a):t.directlySetCurrentUser(null));case 26:return _4(t._popupRedirectResolver,t,"argument-error"),n.next=29,t.getOrInitRedirectPersistenceManager();case 29:return n.abrupt("return",t.redirectUser&&t.redirectUser._redirectEventId===a._redirectEventId?t.directlySetCurrentUser(a):t.reloadAndSetCurrentUserOrClear(a));case 30:case"end":return n.stop()}},n,null,[[17,22]])}))()}},{key:"tryRedirectSignIn",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=null,n.prev=1,n.next=4,t._popupRedirectResolver._completeRedirectFn(t,e,!0);case 4:r=n.sent,n.next=11;break;case 7:return n.prev=7,n.t0=n.catch(1),n.next=11,t._setRedirectUser(null);case 11:return n.abrupt("return",r);case 12:case"end":return n.stop()}},n,null,[[1,7]])}))()}},{key:"reloadAndSetCurrentUserOrClear",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,n5(e);case 3:n.next=9;break;case 5:if(n.prev=5,n.t0=n.catch(0),"auth/network-request-failed"===(null===(r=n.t0)||void 0===r?void 0:r.code)){n.next=9;break}return n.abrupt("return",t.directlySetCurrentUser(null));case 9:return n.abrupt("return",t.directlySetCurrentUser(e));case 10:case"end":return n.stop()}},n,null,[[0,5]])}))()}},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"==typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e._deleted=!0;case 1:case"end":return t.stop()}},t)}))()}},{key:"updateCurrentUser",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e?VB(e):null,n.abrupt("return",(r&&_4(r.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(r&&r._clone(t))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_updateCurrentUser",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n._deleted){r.next=7;break}if(e&&_4(n.tenantId===e.tenantId,n,"tenant-id-mismatch"),r.t0=t,r.t0){r.next=6;break}return r.next=6,n.beforeStateQueue.runMiddleware(e);case 6:return r.abrupt("return",n.queue(aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.directlySetCurrentUser(e);case 2:n.notifyAuthListeners();case 3:case"end":return t.stop()}},t)}))));case 7:case"end":return r.stop()}},r)}))()}},{key:"signOut",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.beforeStateQueue.runMiddleware(null);case 2:if(t.t0=e.redirectPersistenceManager||e._popupRedirectResolver,!t.t0){t.next=6;break}return t.next=6,e._setRedirectUser(null);case 6:return t.abrupt("return",e._updateCurrentUser(null,!0));case 7:case"end":return t.stop()}},t)}))()}},{key:"setPersistence",value:function(e){var t=this;return this.queue(aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(S4(e));case 2:case"end":return n.stop()}},n)})))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new IB("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getOrInitRedirectPersistenceManager(t);case 2:return i=r.sent,r.abrupt("return",null===e?i.removeCurrentUser():i.setCurrentUser(e));case 4:case"end":return r.stop()}},r)}))()}},{key:"getOrInitRedirectPersistenceManager",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.redirectPersistenceManager){n.next=9;break}return _4(r=e&&S4(e)||t._popupRedirectResolver,t,"argument-error"),n.next=5,d5.create(t,[S4(r._redirectPersistence)],"redirectUser");case 5:return t.redirectPersistenceManager=n.sent,n.next=8,t.redirectPersistenceManager.getCurrentUser();case 8:t.redirectUser=n.sent;case 9:return n.abrupt("return",t.redirectPersistenceManager);case 10:case"end":return n.stop()}},n)}))()}},{key:"_redirectUserForId",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=t._isInitialized,!n.t0){n.next=4;break}return n.next=4,t.queue(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})));case 4:return n.abrupt("return",(null===(r=t._currentUser)||void 0===r?void 0:r._redirectEventId)===e?t._currentUser:(null===(i=t.redirectUser)||void 0===i?void 0:i._redirectEventId)===e?t.redirectUser:null);case 5:case"end":return n.stop()}},n)}))()}},{key:"_persistUserIfCurrent",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e!==t.currentUser){n.next=2;break}return n.abrupt("return",t.queue(aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.directlySetCurrentUser(e));case 1:case"end":return n.stop()}},n)}))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var i=this;if(this._deleted)return function(){};var a="function"==typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return _4(o,this,"internal-error"),o.then(function(){return a(i.currentUser)}),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.currentUser&&t.currentUser!==e&&(t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh()),t.currentUser=e,!e){n.next=7;break}return n.next=5,t.assertedPersistence.setCurrentUser(e);case 5:n.next=9;break;case 7:return n.next=9,t.assertedPersistence.removeCurrentUser();case 9:case"end":return n.stop()}},n)}))()}},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return _4(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=b5(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={"X-Client-Version":e.clientVersion},e.app.options.appId&&(r["X-Firebase-gmpid"]=e.app.options.appId),t.next=4,null===(n=e.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===n?void 0:n.getHeartbeatsHeader();case 4:return i=t.sent,t.abrupt("return",(i&&(r["X-Firebase-Client"]=i),r));case 6:case"end":return t.stop()}},t)}))()}}]),e}();function O5(e){return VB(e)}var T5=function(){function e(t){var n,r=this;Zg(this,e),this.auth=t,this.observer=null,this.addObserver=(n=new LB(function(e){return r.observer=e},void 0)).subscribe.bind(n)}return Wg(e,[{key:"next",get:function(){return _4(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}(),I5=function(){function e(t,n){Zg(this,e),this.providerId=t,this.signInMethod=n}return Wg(e,[{key:"toJSON",value:function(){return E4("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return E4("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return E4("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return E4("not implemented")}}]),e}();function A5(){return A5=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",D4(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)})),A5.apply(this,arguments)}function R5(){return R5=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V4(t,"POST","/v1/accounts:signInWithPassword",N4(t,n)));case 1:case"end":return e.stop()}},e)})),R5.apply(this,arguments)}function M5(e,t){return x5.apply(this,arguments)}function x5(){return x5=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",D4(t,"POST","/v1/accounts:sendOobCode",N4(t,n)));case 1:case"end":return e.stop()}},e)})),x5.apply(this,arguments)}function N5(e,t){return D5.apply(this,arguments)}function D5(){return D5=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",M5(t,n));case 1:case"end":return e.stop()}},e)})),D5.apply(this,arguments)}function L5(e,t){return F5.apply(this,arguments)}function F5(){return F5=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",M5(t,n));case 1:case"end":return e.stop()}},e)})),F5.apply(this,arguments)}function U5(){return U5=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V4(t,"POST","/v1/accounts:signInWithEmailLink",N4(t,n)));case 1:case"end":return e.stop()}},e)})),U5.apply(this,arguments)}function V5(){return V5=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V4(t,"POST","/v1/accounts:signInWithEmailLink",N4(t,n)));case 1:case"end":return e.stop()}},e)})),V5.apply(this,arguments)}var B5=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return Zg(this,n),(a=t.call(this,"password",i))._email=e,a._password=r,a._tenantId=o,a}return Wg(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=t.signInMethod,n.next="password"===n.t0?3:"emailLink"===n.t0?4:5;break;case 3:return n.abrupt("return",function(e,t){return R5.apply(this,arguments)}(e,{returnSecureToken:!0,email:t._email,password:t._password}));case 4:return n.abrupt("return",function(e,t){return U5.apply(this,arguments)}(e,{email:t._email,oobCode:t._password}));case 5:y4(e,"internal-error");case 6:case"end":return n.stop()}},n)}))()}},{key:"_linkToIdToken",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:r.t0=n.signInMethod,r.next="password"===r.t0?3:"emailLink"===r.t0?4:5;break;case 3:return r.abrupt("return",function(e,t){return A5.apply(this,arguments)}(e,{idToken:t,returnSecureToken:!0,email:n._email,password:n._password}));case 4:return r.abrupt("return",function(e,t){return V5.apply(this,arguments)}(e,{idToken:t,email:n._email,oobCode:n._password}));case 5:y4(e,"internal-error");case 6:case"end":return r.stop()}},r)}))()}},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new n(e,t,"emailLink",r)}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(I5);function z5(e,t){return H5.apply(this,arguments)}function H5(){return H5=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V4(t,"POST","/v1/accounts:signInWithIdp",N4(t,n)));case 1:case"end":return e.stop()}},e)})),H5.apply(this,arguments)}var G5=function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return Wg(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return z5(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,z5(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,z5(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=xB(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):y4("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e,r=t.providerId,i=t.signInMethod,a=Sy(t,["providerId","signInMethod"]);if(!r||!i)return null;var o=new n(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}}]),n}(I5),$5=function(){function e(t){var n,r,i,a,o,s;Zg(this,e);var u=NB(DB(t)),c=null!==(n=u.apiKey)&&void 0!==n?n:null,l=null!==(r=u.oobCode)&&void 0!==r?r:null,f=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=u.mode)&&void 0!==i?i:null);_4(c&&l&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=l,this.continueUrl=null!==(a=u.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=u.tenantId)&&void 0!==s?s:null}return Wg(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=NB(DB(e)).link,n=t?NB(DB(t)).deep_link_id:null,r=NB(DB(e)).deep_link_id;return(r?NB(DB(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(r){return null}}}]),e}(),Z5=function(){var e=function(){function e(){Zg(this,e),this.providerId=e.PROVIDER_ID}return Wg(e,null,[{key:"credential",value:function(e,t){return B5._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=$5.parseLink(t);return _4(n,"argument-error"),B5._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();return e.PROVIDER_ID="password",e.EMAIL_PASSWORD_SIGN_IN_METHOD="password",e.EMAIL_LINK_SIGN_IN_METHOD="emailLink",e}(),q5=function(){function e(t){Zg(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return Wg(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),W5=function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).scopes=[],e}return Wg(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return Bg(this.scopes)}}]),n}(q5),j5=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return Wg(n,null,[{key:"credential",value:function(e,t){return G5._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,i=t.oauthAccessToken;if(!r&&!i)return null;try{return n.credential(r,i)}catch(a){return null}}}]),n}(W5);return e.GOOGLE_SIGN_IN_METHOD="google.com",e.PROVIDER_ID="google.com",e}();function Y5(e,t){return K5.apply(this,arguments)}function K5(){return K5=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V4(t,"POST","/v1/accounts:signUp",N4(t,n)));case 1:case"end":return e.stop()}},e)})),K5.apply(this,arguments)}var Q5=function(){function e(t){Zg(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return Wg(e,null,[{key:"_fromIdTokenResponse",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return aB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l5._fromIdTokenResponse(t,r,i);case 2:return o=a.sent,s=X5(r),a.abrupt("return",new e({user:o,providerId:s,_tokenResponse:r,operationType:n}));case 5:case"end":return a.stop()}},a)}))()}},{key:"_forOperation",value:function(t,n,r){return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t._updateTokensIfNecessary(r,!0);case 2:return a=X5(r),i.abrupt("return",new e({user:t,providerId:a,_tokenResponse:r,operationType:n}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function X5(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}var J5=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a){var o,s;return Zg(this,n),(o=t.call(this,r.code,r.message)).operationType=i,o.user=a,Object.setPrototypeOf(Fg(o),n.prototype),o.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:r.customData._serverResponse,operationType:i},o}return Wg(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,i){return new n(e,t,r,i)}}]),n}(TB);function e6(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(function(n){throw"auth/multi-factor-auth-required"===n.code?J5._fromErrorAndOperation(e,n,t,r):n})}function t6(e,t){return n6.apply(this,arguments)}function n6(){return n6=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]&&a[2],e.t0=Q4,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return i=e.sent,e.abrupt("return",Q5._forOperation(t,"link",i));case 14:case"end":return e.stop()}},e)})),n6.apply(this,arguments)}function r6(){return r6=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>2&&void 0!==l[2]&&l[2],a=t.auth,o="reauthenticate",e.prev=2,e.next=5,Q4(t,e6(a,o,n,t),r);case 5:return _4((s=e.sent).idToken,a,"internal-error"),_4(u=K4(s.idToken),a,"internal-error"),c=u.sub,e.abrupt("return",(_4(t.uid===c,a,"user-mismatch"),Q5._forOperation(t,o,s)));case 13:throw e.prev=13,e.t0=e.catch(2),"auth/user-not-found"===(null===(i=e.t0)||void 0===i?void 0:i.code)&&y4(a,"user-mismatch"),e.t0;case 16:case"end":return e.stop()}},e,null,[[2,13]])})),r6.apply(this,arguments)}function i6(e,t){return a6.apply(this,arguments)}function a6(){return a6=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i="signIn",e.next=4,e6(t,i,n);case 4:return a=e.sent,e.next=7,Q5._fromIdTokenResponse(t,i,a);case 7:if(o=e.sent,e.t0=r,e.t0){e.next=12;break}return e.next=12,t._updateCurrentUser(o.user);case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}},e)})),a6.apply(this,arguments)}function o6(){return o6=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i6(O5(t),n));case 1:case"end":return e.stop()}},e)})),o6.apply(this,arguments)}function s6(e,t,n){var r;_4((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),_4(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(_4(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(_4(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function u6(){return u6=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=VB(t),a={requestType:"PASSWORD_RESET",email:n},r&&s6(i,a,r),e.next=4,L5(i,a);case 4:case"end":return e.stop()}},e)})),u6.apply(this,arguments)}function c6(){return c6=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=O5(t),e.next=3,Y5(i,{returnSecureToken:!0,email:n,password:r});case 3:return a=e.sent,e.next=6,Q5._fromIdTokenResponse(i,"signIn",a);case 6:return o=e.sent,e.next=9,i._updateCurrentUser(o.user);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}},e)})),c6.apply(this,arguments)}function l6(){return l6=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=VB(t),e.next=3,t.getIdToken();case 3:return e.t0=e.sent,i={requestType:"VERIFY_EMAIL",idToken:e.t0},n&&s6(r.auth,i,n),e.next=8,N5(r.auth,i);case 8:if(a=e.sent,o=a.email,e.t1=o!==t.email,!e.t1){e.next=14;break}return e.next=14,t.reload();case 14:case"end":return e.stop()}},e)})),l6.apply(this,arguments)}function f6(e,t){return h6.apply(this,arguments)}function h6(){return h6=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",D4(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)})),h6.apply(this,arguments)}function d6(){return d6=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.displayName,i=n.photoURL,void 0!==r||void 0!==i){e.next=3;break}return e.abrupt("return");case 3:return a=VB(t),e.next=6,a.getIdToken();case 6:return e.t0=e.sent,e.t1=r,e.t2=i,e.t3=!0,o={idToken:e.t0,displayName:e.t1,photoUrl:e.t2,returnSecureToken:e.t3},e.next=13,Q4(a,f6(a.auth,o));case 13:return s=e.sent,a.displayName=s.displayName||null,a.photoURL=s.photoUrl||null,(u=a.providerData.find(function(e){return"password"===e.providerId}))&&(u.displayName=a.displayName,u.photoURL=a.photoURL),e.next=19,a._updateTokensIfNecessary(s);case 19:case"end":return e.stop()}},e)})),d6.apply(this,arguments)}new WeakMap;var v6="__sak",p6=function(){function e(t,n){Zg(this,e),this.storageRetriever=t,this.type=n}return Wg(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(v6,"1"),this.storage.removeItem(v6),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}(),g6=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.call(this,function(){return window.localStorage},"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.safariLocalStorageNotSynced=function(){var e=CB();return g5(e)||_5(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),e.fallbackToPolling=E5(),e._shouldAllowMigration=!0,e}return Wg(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],i=this.storage.getItem(r),a=this.localCache[r];i!==a&&e(r,a,i)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}var a=function(){var e=t.storage.getItem(r);!n&&t.localCache[r]===e||t.notifyListeners(r,e)},o=this.storage.getItem(r);bB()&&10===document.documentMode&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,10):a()}else this.forAllChangedKeys(function(e,n,r){t.notifyListeners(e,r)})}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t&&JSON.parse(t))}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(function(){e.forAllChangedKeys(function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)})},1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(e,t){var r=this,i=this;return aB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Rg(Vg(n.prototype),"_set",r).call(i,e,t);case 2:i.localCache[e]=JSON.stringify(t);case 3:case"end":return a.stop()}},a)}))()}},{key:"_get",value:function(e){var t=this,r=this;return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Rg(Vg(n.prototype),"_get",t).call(r,e);case 2:return a=i.sent,i.abrupt("return",(r.localCache[e]=JSON.stringify(a),a));case 4:case"end":return i.stop()}},i)}))()}},{key:"_remove",value:function(e){var t=this,r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Rg(Vg(n.prototype),"_remove",t).call(r,e);case 2:delete r.localCache[e];case 3:case"end":return i.stop()}},i)}))()}}]),n}(p6);return e.type="LOCAL",e}(),y6=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.call(this,function(){return window.sessionStorage},"SESSION")}return Wg(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(p6);return e.type="SESSION",e}(),m6=function(){var e=function(){function e(t){Zg(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return Wg(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=(r=e).data,a=i.eventId,o=i.eventType,s=i.data,null==(u=t.handlersMap[o])?void 0:u.size){n.next=3;break}return n.abrupt("return");case 3:return r.ports[0].postMessage({status:"ack",eventId:a,eventType:o}),c=Array.from(u).map(function(){var e=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(r.origin,s));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.next=7,function(e){return Promise.all(e.map((t=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=!0,e.next=4,t;case 4:return e.t1=e.sent,e.abrupt("return",{fulfilled:e.t0,value:e.t1});case 8:return e.prev=8,e.t2=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t2});case 11:case"end":return e.stop()}},e,null,[[0,8]])})),function(e){return t.apply(this,arguments)})));var t}(c);case 7:l=n.sent,r.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:l});case 9:case"end":return n.stop()}},n)}))()}},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find(function(e){return e.isListeningto(t)});if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();return e.receivers=[],e}();function k6(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}var C6=function(){function e(t){Zg(this,e),this.target=t,this.handlers=new Set}return Wg(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=this;return aB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a="undefined"!=typeof MessageChannel?new MessageChannel:null){i.next=3;break}throw new Error("connection_unavailable");case 3:return i.abrupt("return",new Promise(function(i,u){var c=k6("",20);a.port1.start();var l=setTimeout(function(){u(new Error("unsupported_event"))},n);s={messageChannel:a,onMessage:function(e){var t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),o=setTimeout(function(){u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),i(t.data.response);break;default:clearTimeout(l),clearTimeout(o),u(new Error("invalid_response"))}}},r.handlers.add(s),a.port1.addEventListener("message",s.onMessage),r.target.postMessage({eventType:e,eventId:c,data:t},[a.port2])}).finally(function(){s&&r.removeMessageHandler(s)}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function w6(){return window}function _6(){return void 0!==w6().WorkerGlobalScope&&"function"==typeof w6().importScripts}function E6(){return(E6=aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return e.abrupt("return",e.sent.active);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",null);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var b6="firebaseLocalStorageDb",P6="firebaseLocalStorage",S6="fbase_key",O6=function(){function e(t){Zg(this,e),this.request=t}return Wg(e,[{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.request.addEventListener("success",function(){t(e.request.result)}),e.request.addEventListener("error",function(){n(e.request.error)})})}}]),e}();function T6(e,t){return e.transaction([P6],t?"readwrite":"readonly").objectStore(P6)}function I6(){var e=indexedDB.open(b6,1);return new Promise(function(t,n){e.addEventListener("error",function(){n(e.error)}),e.addEventListener("upgradeneeded",function(){var t=e.result;try{t.createObjectStore(P6,{keyPath:S6})}catch(r){n(r)}}),e.addEventListener("success",aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=e.result).objectStoreNames.contains(P6)){n.next=5;break}t(r),n.next=13;break;case 5:return r.close(),n.next=8,function(){var e=indexedDB.deleteDatabase(b6);return new O6(e).toPromise()}();case 8:return n.t0=t,n.next=11,I6();case 11:n.t1=n.sent,(0,n.t0)(n.t1);case 13:case"end":return n.stop()}},n)})))})}function A6(e,t,n){return R6.apply(this,arguments)}function R6(){return R6=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=T6(t,!0).put((Pg(i={},S6,n),Pg(i,"value",r),i)),e.abrupt("return",new O6(a).toPromise());case 2:case"end":return e.stop()}},e)})),R6.apply(this,arguments)}function M6(){return M6=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=T6(t,!1).get(n),e.next=3,new O6(r).toPromise();case 3:return i=e.sent,e.abrupt("return",void 0===i?null:i.value);case 5:case"end":return e.stop()}},e)})),M6.apply(this,arguments)}function x6(e,t){var n=T6(e,!0).delete(t);return new O6(n).toPromise()}var N6=function(){var e=function(){function e(){Zg(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(function(){},function(){})}return Wg(e,[{key:"_openDb",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.db,t.t0){t.next=5;break}return t.next=4,I6();case 4:e.db=t.sent;case 5:return t.abrupt("return",e.db);case 6:case"end":return t.stop()}},t)}))()}},{key:"_withRetries",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=0;case 1:return n.prev=1,n.next=4,t._openDb();case 4:return i=n.sent,n.next=7,e(i);case 7:return n.abrupt("return",n.sent);case 10:if(n.prev=10,n.t0=n.catch(1),!(r++>3)){n.next=14;break}throw n.t0;case 14:t.db&&(t.db.close(),t.db=void 0);case 15:n.next=1;break;case 17:case"end":return n.stop()}},n,null,[[1,10]])}))()}},{key:"initializeServiceWorkerMessaging",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",_6()?e.initializeReceiver():e.initializeSender());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeReceiver",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.receiver=m6._getInstance(_6()?self:null),e.receiver._subscribe("keyChanged",function(){var t=aB(regeneratorRuntime.mark(function t(n,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._poll();case 2:return t.t0=t.sent.includes(r.key),t.abrupt("return",{keyProcessed:t.t0});case 4:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var e=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeSender",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(){return E6.apply(this,arguments)}();case 2:if(e.activeServiceWorker=t.sent,e.activeServiceWorker){t.next=5;break}return t.abrupt("return");case 5:return e.sender=new C6(e.activeServiceWorker),t.next=8,e.sender._send("ping",{},800);case 8:!(i=t.sent)||(null===(n=i[0])||void 0===n?void 0:n.fulfilled)&&(null===(r=i[0])||void 0===r?void 0:r.value.includes("keyChanged"))&&(e.serviceWorkerReceiverAvailable=!0);case 10:case"end":return t.stop()}},t)}))()}},{key:"notifyServiceWorker",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.sender||!t.activeServiceWorker||function(){var e;return(null===(e=null==navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()!==t.activeServiceWorker){n.next=8;break}return n.prev=1,n.next=4,t.sender._send("keyChanged",{key:e},t.serviceWorkerReceiverAvailable?800:50);case 4:n.next=8;break;case 6:n.prev=6,n.t0=n.catch(1);case 8:case"end":return n.stop()}},n,null,[[1,6]])}))()}},{key:"_isAvailable",value:function(){return aB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,I6();case 5:return t=e.sent,e.next=8,A6(t,v6,"1");case 8:return e.next=10,x6(t,v6);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}},e,null,[[0,13]])}))()}},{key:"_withPendingWrite",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.pendingWrites++,n.prev=1,n.next=4,e();case 4:return n.prev=4,t.pendingWrites--,n.finish(4);case 7:case"end":return n.stop()}},n,null,[[1,,4,7]])}))()}},{key:"_set",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n._withPendingWrite(aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n._withRetries(function(n){return A6(n,e,t)});case 2:return n.localCache[e]=t,r.abrupt("return",n.notifyServiceWorker(e));case 4:case"end":return r.stop()}},r)}))));case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return function(e,t){return M6.apply(this,arguments)}(t,e)});case 2:return r=n.sent,n.abrupt("return",(t.localCache[e]=r,r));case 4:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t._withPendingWrite(aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return x6(t,e)});case 2:return delete t.localCache[e],n.abrupt("return",t.notifyServiceWorker(e));case 4:case"end":return n.stop()}},n)}))));case 1:case"end":return n.stop()}},n)}))()}},{key:"_poll",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s,u,c,l,f,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._withRetries(function(e){var t=T6(e,!1).getAll();return new O6(t).toPromise()});case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return",[]);case 5:if(0===e.pendingWrites){t.next=7;break}return t.abrupt("return",[]);case 7:r=[],i=new Set,a=Hg(n);try{for(a.s();!(o=a.n()).done;)s=o.value,u=s.fbase_key,c=s.value,i.add(u),JSON.stringify(e.localCache[u])!==JSON.stringify(c)&&(e.notifyListeners(u,c),r.push(u))}catch(d){a.e(d)}finally{a.f()}for(l=0,f=Object.keys(e.localCache);l<f.length;l++)h=f[l],e.localCache[h]&&!i.has(h)&&(e.notifyListeners(h,null),r.push(h));return t.abrupt("return",r);case 12:case"end":return t.stop()}},t)}))()}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}},t)})),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();return e.type="LOCAL",e}();function D6(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}function L6(e,t){return t?S4(t):(_4(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}D6("rcb"),new I4(3e4,6e4);var F6=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,"custom","custom")).params=e,r}return Wg(n,[{key:"_getIdTokenResponse",value:function(e){return z5(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return z5(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return z5(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(I5);function U6(e){return i6(e.auth,new F6(e),e.bypassAuthState)}function V6(e){var t=e.auth,n=e.user;return _4(n,t,"internal-error"),function(e,t){return r6.apply(this,arguments)}(n,new F6(e),e.bypassAuthState)}function B6(e){return z6.apply(this,arguments)}function z6(){return z6=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,r=t.user,e.abrupt("return",(_4(r,n,"internal-error"),t6(r,new F6(t),t.bypassAuthState)));case 2:case"end":return e.stop()}},e)})),z6.apply(this,arguments)}var H6=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Zg(this,e),this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return Wg(e,[{key:"execute",value:function(){var e,t=this;return new Promise((e=aB(regeneratorRuntime.mark(function e(n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.pendingPromise={resolve:n,reject:r},e.prev=1,e.next=4,t.resolver._initialize(t.auth);case 4:return t.eventManager=e.sent,e.next=7,t.onExecution();case 7:t.eventManager.registerConsumer(t),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),t.reject(e.t0);case 13:case"end":return e.stop()}},e,null,[[1,10]])})),function(t,n){return e.apply(this,arguments)}))}},{key:"onAuthEvent",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.urlResponse,i=e.sessionId,a=e.postBody,o=e.tenantId,s=e.error,u=e.type,!s){n.next=3;break}return n.abrupt("return",void t.reject(s));case 3:return c={auth:t.auth,requestUri:r,sessionId:i,tenantId:o||void 0,postBody:a||void 0,user:t.user,bypassAuthState:t.bypassAuthState},n.prev=4,n.t0=t,n.next=8,t.getIdpTask(u)(c);case 8:n.t1=n.sent,n.t0.resolve.call(n.t0,n.t1),n.next=15;break;case 12:n.prev=12,n.t2=n.catch(4),t.reject(n.t2);case 15:case"end":return n.stop()}},n,null,[[4,12]])}))()}},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return U6;case"linkViaPopup":case"linkViaRedirect":return B6;case"reauthViaPopup":case"reauthViaRedirect":return V6;default:y4(this.auth,"internal-error")}}},{key:"resolve",value:function(e){b4(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){b4(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),G6=new I4(2e3,1e4);function $6(){return $6=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=O5(t),C4(t,n,q5),a=L6(i,r),e.abrupt("return",new Z6(i,"signInViaPopup",n,a).executeNotNull());case 4:case"end":return e.stop()}},e)})),$6.apply(this,arguments)}var Z6=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o){var s;return Zg(this,n),(s=t.call(this,e,r,a,o)).provider=i,s.authWindow=null,s.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=Fg(s),s}return Wg(n,[{key:"executeNotNull",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.execute();case 2:return n=t.sent,t.abrupt("return",(_4(n,e.auth,"internal-error"),n));case 4:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return b4(1===e.filter.length,"Popup operations only handle one event"),n=k6(),t.next=4,e.resolver._openPopup(e.auth,e.provider,e.filter[0],n);case 4:e.authWindow=t.sent,e.authWindow.associatedEvent=n,e.resolver._originValidation(e.auth).catch(function(t){e.reject(t)}),e.resolver._isIframeWebStorageSupported(e.auth,function(t){t||e.reject(m4(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation();case 9:case"end":return t.stop()}},t)}))()}},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(m4(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;e.pollId=(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?window.setTimeout(function(){e.pollId=null,e.reject(m4(e.auth,"popup-closed-by-user"))},2e3):window.setTimeout(t,G6.get())}()}}]),n}(H6);return e.currentPopupAction=null,e}(),q6=new Map,W6=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Zg(this,n),(i=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,a)).eventId=null,i}return Wg(n,[{key:"execute",value:function(){var e=this,t=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=q6.get(t.auth._key())){r.next=20;break}return r.prev=2,r.next=5,function(e,t){return j6.apply(this,arguments)}(t.resolver,t.auth);case 5:if(!r.sent){r.next=11;break}return r.next=8,Rg(Vg(n.prototype),"execute",e).call(t);case 8:r.t0=r.sent,r.next=12;break;case 11:r.t0=null;case 12:a=r.t0,i=function(){return Promise.resolve(a)},r.next=19;break;case 16:r.prev=16,r.t1=r.catch(2),i=function(){return Promise.reject(r.t1)};case 19:q6.set(t.auth._key(),i);case 20:return r.abrupt("return",(t.bypassAuthState||q6.set(t.auth._key(),function(){return Promise.resolve(null)}),i()));case 21:case"end":return r.stop()}},r,null,[[2,16]])}))()}},{key:"onAuthEvent",value:function(e){var t=this,r=function(){return Rg(Vg(n.prototype),"onAuthEvent",t)},i=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("signInViaRedirect"!==e.type){t.next=2;break}return t.abrupt("return",r().call(i,e));case 2:if("unknown"===e.type){t.next=12;break}if(!e.eventId){t.next=10;break}return t.next=6,i.auth._redirectUserForId(e.eventId);case 6:if(!(n=t.sent)){t.next=9;break}return t.abrupt("return",(i.user=n,r().call(i,e)));case 9:i.resolve(null);case 10:t.next=13;break;case 12:i.resolve(null);case 13:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){return aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))()}},{key:"cleanUp",value:function(){}}]),n}(H6);function j6(){return j6=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Q6(n),i=K6(t),e.next=3,i._isAvailable();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,i._get(r);case 7:return e.t0=e.sent,a="true"===e.t0,e.next=11,i._remove(r);case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}},e)})),j6.apply(this,arguments)}function Y6(e,t){q6.set(e._key(),t)}function K6(e){return S4(e._redirectPersistence)}function Q6(e){return h5("pendingRedirect",e.config.apiKey,e.name)}function X6(e,t){return J6.apply(this,arguments)}function J6(){return J6=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i=O5(t),a=L6(i,n),e.next=5,new W6(i,a,r).execute();case 5:if(o=e.sent,e.t0=o&&!r,!e.t0){e.next=13;break}return delete o.user._redirectEventId,e.next=11,i._persistUserIfCurrent(o.user);case 11:return e.next=13,i._setRedirectUser(null,n);case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}},e)})),J6.apply(this,arguments)}var e8=function(){function e(t){Zg(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return Wg(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach(function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return n8(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!n8(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(m4(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(t8(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(t8(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function t8(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(function(e){return e}).join("-")}function n8(e){var t=e.type,n=e.error;return"unknown"===t&&"auth/no-auth-event"===(null==n?void 0:n.code)}function r8(e){return i8.apply(this,arguments)}function i8(){return i8=aB(regeneratorRuntime.mark(function e(t){var n,r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",D4(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}},e)})),i8.apply(this,arguments)}var a8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,o8=/^https?/;function s8(){return s8=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,r8(t);case 4:n=e.sent,r=n.authorizedDomains,i=Hg(r),e.prev=7,i.s();case 9:if((a=i.n()).done){e.next=20;break}if(o=a.value,e.prev=11,!u8(o)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),i.e(e.t1);case 25:return e.prev=25,i.f(),e.finish(25);case 28:y4(t,"unauthorized-domain");case 29:case"end":return e.stop()}},e,null,[[7,22,25,28],[11,16]])})),s8.apply(this,arguments)}function u8(e){var t=O4(),n=new URL(t),r=n.protocol,i=n.hostname;if(e.startsWith("chrome-extension://")){var a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===i}if(!o8.test(r))return!1;if(a8.test(e))return i===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}var c8=new I4(3e4,6e4);function l8(){var e=w6().___jsl;if(null==e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=Bg(e.H[r].L),e.CP)for(var i=0;i<e.CP.length;i++)e.CP[i]=null}}var f8=null;function h8(e){return f8=f8||function(e){return new Promise(function(t,n){var r,i,a;function o(){l8(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){l8(),n(m4(e,"network-request-failed"))},timeout:c8.get()})}if(null===(i=null===(r=w6().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=w6().gapi)||void 0===a?void 0:a.load)){var s=D6("iframefcb");return w6()[s]=function(){gapi.load?o():n(m4(e,"network-request-failed"))},function(e){return new Promise(function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=m4("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})}("https://apis.google.com/js/api.js?onload=".concat(s)).catch(function(e){return n(e)})}o()}}).catch(function(e){throw f8=null,e})}(e),f8}var d8=new I4(5e3,15e3),v8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},p8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function g8(e){var t=e.config;_4(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?A4(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:Sz},i=p8.get(e.config.apiHost);i&&(r.eid=i);var a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(xB(r).slice(1))}function y8(){return y8=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h8(t);case 2:return n=e.sent,r=w6().gapi,e.abrupt("return",(_4(r,t,"internal-error"),n.open({where:document.body,url:g8(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:v8,dontclear:!0},function(e){return new Promise((n=aB(regeneratorRuntime.mark(function n(r,i){var a,o,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=function(){w6().clearTimeout(o),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:a=m4(t,"network-request-failed"),o=w6().setTimeout(function(){i(a)},d8.get()),e.ping(s).then(s,function(){i(a)});case 5:case"end":return n.stop()}},n)})),function(e,t){return n.apply(this,arguments)}));var n})));case 5:case"end":return e.stop()}},e)})),y8.apply(this,arguments)}var m8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},k8=function(){function e(t){Zg(this,e),this.window=t,this.associatedEvent=null}return Wg(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),e}();function C8(e,t,n,r,i,a){_4(e.config.authDomain,e,"auth-domain-config-required"),_4(e.config.apiKey,e,"invalid-api-key");var o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Sz,eventId:i};if(t instanceof q5){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(var s=0,u=Object.entries(a||{});s<u.length;s++){var c=Sg(u[s],2),l=c[0],f=c[1];o[l]=f}}if(t instanceof W5){var h=t.getScopes().filter(function(e){return""!==e});h.length>0&&(o.scopes=h.join(","))}e.tenantId&&(o.tid=e.tenantId);for(var d=o,v=0,p=Object.keys(d);v<p.length;v++){var g=p[v];void 0===d[g]&&delete d[g]}return"".concat(function(e){var t=e.config;return t.emulator?A4(t,"emulator/auth/handler"):"https://".concat(t.authDomain,"/__/auth/handler")}(e),"?").concat(xB(d).slice(1))}var w8="webStorageSupport",_8=function(){function e(){Zg(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=y6,this._completeRedirectFn=X6,this._overrideRedirectResult=Y6}return Wg(e,[{key:"_openPopup",value:function(e,t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return b4(null===(o=i.eventManagers[e._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()"),s=C8(e,t,n,O4(),r),a.abrupt("return",function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),s="",u=Object.assign(Object.assign({},m8),{width:r.toString(),height:i.toString(),top:a,left:o}),c=CB().toLowerCase();n&&(s=y5(c)?"_blank":n),p5(c)&&(t=t||"http://localhost",u.scrollbars="yes");var l=Object.entries(u).reduce(function(e,t){var n=Sg(t,2),r=n[0],i=n[1];return"".concat(e).concat(r,"=").concat(i,",")},"");if(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CB();return _5(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==s)return function(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",s),new k8(null);var f=window.open(t||"",s,l);_4(f,e,"popup-blocked");try{f.focus()}catch(h){}return new k8(f)}(e,s,k6()));case 3:case"end":return a.stop()}},a)}))()}},{key:"_openRedirect",value:function(e,t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i._originValidation(e);case 2:return function(e){w6().location.href=e}(C8(e,t,n,O4(),r)),a.abrupt("return",new Promise(function(){}));case 4:case"end":return a.stop()}},a)}))()}},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],i=r.manager,a=r.promise;return i?Promise.resolve(i):(b4(a,"If manager is not set, promise should be"),a)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch(function(){delete t.eventManagers[n]}),o}},{key:"initAndGetManager",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,function(e){return y8.apply(this,arguments)}(e);case 2:return r=n.sent,i=new e8(e),n.abrupt("return",(r.register("authEvent",function(t){return _4(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:i.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:i},t.iframes[e._key()]=r,i));case 5:case"end":return n.stop()}},n)}))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(w8,{type:w8},function(n){var r,i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[w8];void 0!==i&&t(!!i),y4(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return s8.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return E5()||g5()||_5()}}]),e}(),E8="@firebase/auth",b8=function(){function e(t){Zg(this,e),this.auth=t,this.internalListeners=new Map}return Wg(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.assertAuthConfigured(),n.next=3,t.auth._initializationPromise;case 3:if(!t.auth.currentUser){n.next=10;break}return n.next=6,t.auth.currentUser.getIdToken(e);case 6:n.t1=n.sent,n.t0={accessToken:n.t1},n.next=11;break;case 10:n.t0=null;case 11:return n.abrupt("return",n.t0);case 12:case"end":return n.stop()}},n)}))()}},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged(function(t){var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);!t||(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){_4(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();!function(e){_z(new HB("auth",function(t,n){var r=n.options,i=t.getProvider("app").getImmediate(),a=t.getProvider("heartbeat"),o=i.options,s=o.apiKey,u=o.authDomain;return function(t,n){_4(s&&!s.includes(":"),"invalid-api-key",{appName:t.name}),_4(!(null==u?void 0:u.includes(":")),"argument-error",{appName:t.name});var i={apiKey:s,authDomain:u,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:b5(e)},a=new S5(t,n,i);return function(e,t){var n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(S4);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(a,r),a}(i,a)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider("auth-internal").initialize()})),_z(new HB("auth-internal",function(e){var t=O5(e.getProvider("auth").getImmediate());return new b8(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Iz(E8,"0.20.5",void 0),Iz(E8,"0.20.5","esm2017")}("Browser");var P8=Wg(function e(t){return Zg(this,e),t}),S8=Wg(function e(){return Zg(this,e),g3("auth")}),O8=new YC("angularfire2.auth-instances");function T8(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new P8(r)}}var I8={provide:S8,deps:[[new Ew,O8]]},A8={provide:P8,useFactory:function(e,t){var n=p3("auth",e,t);return n&&new P8(n)},deps:[[new Ew,O8],O3]},R8=function(){var e=Wg(function e(){Zg(this,e),Iz("angularfire",u3.full,"auth")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({providers:[A8,I8]}),e}(),M8=S3(function(e,t,n){return c6.apply(this,arguments)},!0),x8=S3(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oz(),t=Ez(e,"auth");return t.isInitialized()?t.getImmediate():function(e,t){var n=Ez(e,"auth");if(n.isInitialized()){var r=n.getImmediate();if(RB(n.getOptions(),null!=t?t:{}))return r;y4(r,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:_8,persistence:[N6,g6,y6]})},!0),N8=S3(function(e,t,n,r){return VB(e).onAuthStateChanged(t,n,r)},!0),D8=S3(function(e,t){return l6.apply(this,arguments)},!0),L8=S3(function(e,t,n){return u6.apply(this,arguments)},!0),F8=S3(function(e,t,n){return function(e,t){return o6.apply(this,arguments)}(VB(e),Z5.credential(t,n))},!0),U8=S3(function(e,t,n){return $6.apply(this,arguments)},!0),V8=S3(function(e,t){return d6.apply(this,arguments)},!0),B8=Wg(function e(t){return Zg(this,e),t}),z8=new YC("angularfire2.firestore-instances");function H8(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new B8(r)}}var G8={provide:Wg(function e(){return Zg(this,e),g3("firestore")}),deps:[[new Ew,z8]]},$8={provide:B8,useFactory:function(e,t){var n=p3("firestore",e,t);return n&&new B8(n)},deps:[[new Ew,z8],O3]},Z8=function(){var e=Wg(function e(){Zg(this,e),Iz("angularfire",u3.full,"fst")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({providers:[$8,G8]}),e}(),q8=S3(function(e,t){var n=xX(e.firestore,HX),r=VX(e),i=AJ(e.converter,t);return MJ(n,[nJ(tJ(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,gj.exists(!1))]).then(function(){return r})},!0),W8=S3(function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=VB(e),IX("collection","path",t),e instanceof DX){var a=_q.fromString.apply(_q,[t].concat(r));return RX(a),new UX(e,null,a)}if(!(e instanceof LX||e instanceof UX))throw new oq(aq.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(_q.fromString.apply(_q,[t].concat(r)));return RX(o),new UX(e.firestore,null,o)},!0),j8=S3(function(e){return MJ(xX(e.firestore,HX),[new Rj(e._key,gj.none())])},!0),Y8=S3(VX,!0),K8=S3(function(e){e=xX(e,LX);var t=xX(e.firestore,HX);return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new sq;return e.asyncQueue.enqueueAndForget(aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new gX({next:function(a){t.enqueueAndForget(function(){return SQ(e,o)});var s=a.docs.has(n);!s&&a.fromCache?i.reject(new oq(aq.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&a.fromCache&&r&&"server"===r.source?i.reject(new oq(aq.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new RQ(zW(n.path),a,{includeMetadataChanges:!0,Du:!0});return bQ(e,o)},i.next=3,SX(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}(GX(t),e._key).then(function(n){return xJ(t,e,n)})},!0),Q8=S3(function(e){e=xX(e,FX);var t=xX(e.firestore,HX),n=GX(t),r=new RJ(t);return _J(e._query),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new sq;return e.asyncQueue.enqueueAndForget(aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new gX({next:function(n){t.enqueueAndForget(function(){return SQ(e,o)}),n.fromCache&&"server"===r.source?i.reject(new oq(aq.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new RQ(n,a,{includeMetadataChanges:!0,Du:!0});return bQ(e,o)},i.next=3,SX(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}(n,e._query).then(function(n){return new CJ(t,r,e,n)})},!0),X8=S3(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oz();return Ez(e,"firestore").getImmediate()},!0),J8=S3(function(e){return function(e,t){if(t<=0)throw new oq(aq.INVALID_ARGUMENT,"Function ".concat("limit","() requires a positive number, but it was: ").concat(t,"."))}(0,e),new SJ("limit",e,"F")},!0),e7=S3(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,a,o;e=VB(e);var s={includeMetadataChanges:!1},u=0;"object"!=typeof n[u]||zX(n[u])||(s=n[u],u++);var c,l,f,h={includeMetadataChanges:s.includeMetadataChanges};if(zX(n[u])){var d=n[u];n[u]=null===(i=d.next)||void 0===i?void 0:i.bind(d),n[u+1]=null===(a=d.error)||void 0===a?void 0:a.bind(d),n[u+2]=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}if(e instanceof LX)l=xX(e.firestore,HX),f=zW(e._key.path),c={next:function(t){n[u]&&n[u](xJ(l,e,t))},error:n[u+1],complete:n[u+2]};else{var v=xX(e,FX);l=xX(v.firestore,HX),f=v._query;var p=new RJ(l);c={next:function(e){n[u]&&n[u](new CJ(l,p,v,e))},error:n[u+1],complete:n[u+2]},_J(e._query)}return function(e,t,n,r){var i=new gX(r),a=new RQ(t,i,n);return e.asyncQueue.enqueueAndForget(aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=bQ,t.next=3,SX(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)}))),function(){i.Tc(),e.asyncQueue.enqueueAndForget(aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=SQ,t.next=3,SX(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)})))}}(GX(l),f,h,c)},!0),t7=S3(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=t,r=gJ("orderBy",e);return new PJ(r,n)},!0),n7=S3(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=o._apply(e)}return e},!0),r7=S3(function(e,t,n){e=xX(e,LX);var r=xX(e.firestore,HX),i=AJ(e.converter,t,n);return MJ(r,[nJ(tJ(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,gj.none())])},!0),i7=S3(function(e,t,n){e=xX(e,LX);for(var r,i=xX(e.firestore,HX),a=tJ(i),o=arguments.length,s=new Array(o>3?o-3:0),u=3;u<o;u++)s[u-3]=arguments[u];return r="string"==typeof(t=VB(t))||t instanceof ZX?function(e,t,n,r,i,a){var o=e.aa(1,t,n),s=[cJ(t,r,n)],u=[i];if(a.length%2!=0)throw new oq(aq.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)s.push(cJ(t,a[c])),u.push(a[c+1]);for(var l=[],f=mW.empty(),h=s.length-1;h>=0;--h)if(!dJ(l,s[h])){var d=s[h],v=u[h];v=VB(v);var p=o.ia(d);if(v instanceof rJ)l.push(d);else{var g=aJ(v,p);null!=g&&(l.push(d),f.set(d,g))}}var y=new Gq(l);return new QX(f,y,o.fieldTransforms)}(a,"updateDoc",e._key,t,n,s):function(e,t,n,r){var i=e.aa(1,t,n);uJ("Data must be an object, but it was:",i,r);var a=[],o=mW.empty();Lq(r,function(e,r){var s=fJ(t,e,n);r=VB(r);var u=i.ia(s);if(r instanceof rJ)a.push(s);else{var c=aJ(r,u);null!=c&&(a.push(s),o.set(s,c))}});var s=new Gq(a);return new QX(o,s,i.fieldTransforms)}(a,"updateDoc",e._key,t),MJ(i,[r.toMutation(e._key,gj.exists(!0))])},!0),a7=S3(function(e,t,n){var r=t,i=gJ("where",e);return new bJ(i,r,n)},!0),o7=function(){var e=function(){function e(t,n){Zg(this,e),this.collectionName=t,this.firestore=n,this.subDAOs={},this.collection=W8(n,this.collectionName).withConverter({fromFirestore:function(e){return e.data()},toFirestore:function(e){return e}})}return Wg(e,[{key:"create",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,{called:n.collectionName+".create",newElement:t}),r.next=3,q8(n.collection,t);case 3:return r.abrupt("return",r.sent.id);case 4:case"end":return r.stop()}},r)}))()}},{key:"read",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,{called:n.collectionName+".read",id:t}),r.next=3,K8(Y8(n.collection,t));case 3:return i=r.sent,r.abrupt("return",i.exists()?fB.of(oB.getNonNullable(i.data())):fB.empty());case 5:case"end":return r.stop()}},r)}))()}},{key:"exists",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,{called:n.collectionName+".exists",id:t}),r.next=3,n.read(t);case 3:return r.abrupt("return",r.sent.isPresent());case 4:case"end":return r.stop()}},r)}))()}},{key:"update",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(sB(e.VERBOSE,{called:r.collectionName+".update",id:t,update:n}),i7(Y8(r.collection,t),n)));case 1:case"end":return i.stop()}},i)}))()}},{key:"delete",value:function(t){return sB(e.VERBOSE,{called:this.collectionName+".delete",id:t}),j8(Y8(this.collection,t))}},{key:"set",value:function(t,n){return sB(e.VERBOSE,{called:this.collectionName+".set",id:t,element:n}),r7(Y8(this.collection,t),n)}},{key:"subscribeToChanges",value:function(e,t){return new qg(e7(Y8(this.collection,e),function(e){t(fB.ofNullable(e.data()))}))}},{key:"findWhere",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=r.constructQuery(e,t,n),i.next=3,Q8(a);case 3:return i.abrupt("return",i.sent.docs.map(function(e){return{id:e.id,data:e.data()}}));case 4:case"end":return i.stop()}},i)}))()}},{key:"observingWhere",value:function(t,n,r){var i=this;sB(e.VERBOSE,{called:this.collectionName+".observingWhere"});var a=this.constructQuery(t,r);return new qg(e7(a,function(t){var r=[],a=[],o=[];t.docChanges().forEach(function(e){var t={id:e.doc.id,data:e.doc.data()};switch(e.type){case"added":r.push(t);break;case"modified":a.push(t);break;case"removed":o.push(t)}}),r.length>0&&(sB(e.VERBOSE,"firebase gave us "+r.length+" NEW "+i.collectionName),n.onDocumentCreated(r)),a.length>0&&(sB(e.VERBOSE,"firebase gave us "+a.length+" MODIFIED "+i.collectionName),n.onDocumentModified(a)),o.length>0&&(sB(e.VERBOSE,"firebase gave us "+o.length+" DELETED "+i.collectionName),n.onDocumentDeleted(o))}))}},{key:"constructQuery",value:function(e,t,n){var r=n7(this.collection);null!=t&&(r=n7(r,t7(t))),null!=n&&(r=n7(r,J8(n)));var i,a=Hg(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;r=n7(r,a7(o[0],o[1],o[2]))}}catch(s){a.e(s)}finally{a.f()}return r}},{key:"subCollectionDAO",value:function(t,n){var r="".concat(this.collection.path,"/").concat(t,"/").concat(n);if(r in this.subDAOs)return this.subDAOs[r];var i=new(function(e){xg(n,e);var t=Dg(n);function n(e){return Zg(this,n),t.call(this,r,e)}return Wg(n)}(e))(this.firestore);return this.subDAOs[r]=i,i}}]),e}();return e.VERBOSE=!1,e}(),s7=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),r=t.call(this,"chats",e),sB(n.VERBOSE,"ChatDAO.constructor"),r}return Wg(n)}(o7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(pw(B8))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),u7=function(){var n=Wg(function e(){Zg(this,e)});return n.CANNOT_SEND_MESSAGE=function(){return $localize(e||(e=_g(["You're not allowed to send a message here."])))},n.FORBIDDEN_MESSAGE=function(){return $localize(t||(t=_g(["This message is forbidden."])))},n}(),c7=function(){var e=function(){function e(t){Zg(this,e),this.chatDAO=t,sB(e.VERBOSE,"ChatService.constructor")}return Wg(e,[{key:"addMessage",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.chatDAO.subCollectionDAO(e,"messages").create(t));case 1:case"end":return r.stop()}},r)}))()}},{key:"getLastMessages",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",t));case 1:case"end":return r.stop()}},r)}))()}},{key:"subscribeToMessages",value:function(e,t){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],t,"postedTime")}},{key:"deleteChat",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(sB(e.VERBOSE,"ChatService.deleteChat "+t),n.chatDAO.delete(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"createNewChat",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.chatDAO.set(e,{}));case 1:case"end":return n.stop()}},n)}))()}},{key:"sendMessage",value:function(e,t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!1!==i.userCanSendMessage(t.name,e)){a.next=2;break}return a.abrupt("return",pB.failure(u7.CANNOT_SEND_MESSAGE()));case 2:if(!i.isForbiddenMessage(n)){a.next=4;break}return a.abrupt("return",pB.failure(u7.FORBIDDEN_MESSAGE()));case 4:return o={content:n,sender:t,postedTime:NJ(),currentTurn:r},a.next=7,i.addMessage(e,o);case 7:return a.abrupt("return",pB.SUCCESS);case 8:case"end":return a.stop()}},a)}))()}},{key:"userCanSendMessage",value:function(e,t){return""!==e}},{key:"isForbiddenMessage",value:function(e){return""===e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(pw(s7))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),l7=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){return Zg(this,n),t.call(this,"errors",e)}return Wg(n)}(o7);return e.\u0275fac=function(t){return new(t||e)(pw(B8))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),f7=Tg(5378),h7=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"infoMessage",value:function(e){this.message(e,"is-info")}},{key:"gameMessage",value:function(e){this.message(e,"is-warning")}},{key:"criticalMessage",value:function(e){this.message(e,"is-danger")}},{key:"message",value:function(e,t){(0,f7.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:t,dismissible:!0})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),d7=function(){function e(t,n,r){Zg(this,e),this.errorDAO=t,this.router=n,this.messageDisplayer=r,e.setSingletonInstance(this)}return Wg(e,[{key:"findErrors",value:function(e,t,n,r){return this.errorDAO.findWhere(void 0===r?[["component","==",e],["route","==",t],["message","==",n]]:[["component","==",e],["route","==",t],["message","==",n],["data","==",r]])}},{key:"logError",value:function(e,t,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o,s,u,c,l;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i.messageDisplayer.criticalMessage($localize(n||(n=_g(["An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible."])))),o=i.router.url,a.next=4,i.findErrors(e,o,t,r);case 4:if(0!==(s=a.sent).length){a.next=12;break}return u={component:e,route:o,message:t,firstEncounter:NJ(),lastEncounter:NJ(),occurences:1},null!=r&&(u.data=r),a.next=10,i.errorDAO.create(u);case 10:a.next=15;break;case 12:return c=s[0].id,l=s[0].data,a.next=15,i.errorDAO.update(c,{lastEncounter:NJ(),occurences:l.occurences+1});case 15:case"end":return a.stop()}},a)}))()}}],[{key:"setSingletonInstance",value:function(t){e.singleton=fB.of(t)}},{key:"logErrorAndFail",value:function(t,n,r){throw e.logError(t,n,r),new Error("".concat(t,": ").concat(n," (extra data: ").concat(JSON.stringify(r),")"))}},{key:"logError",value:function(e,t,n){if(this.singleton.isAbsent())throw new Error("".concat(e,": ").concat(t," (extra data: ").concat(JSON.stringify(n),")"));return this.singleton.get().logError(e,t,n),pB.failure(e+": "+t)}}]),e}();function v7(e,t){if(!1===e)throw d7.logError("Assertion failure",t),new Error("Assertion failure: ".concat(t))}d7.singleton=fB.empty(),d7.\u0275fac=function(e){return new(e||d7)(pw(l7),pw(jL),pw(h7))},d7.\u0275prov=dm({token:d7,factory:d7.\u0275fac,providedIn:"root"});var p7=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),r=t.call(this,n.COLLECTION_NAME,e),sB(n.VERBOSE,"UserDAO.constructor"),r}return Wg(n)}(o7);return e.VERBOSE=!1,e.COLLECTION_NAME="users",e.\u0275fac=function(t){return new(t||e)(pw(B8))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),g7=function(){var e=function(){function e(t){Zg(this,e),this.userDAO=t}return Wg(e,[{key:"usernameIsAvailable",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.userDAO.findWhere([["username","==",e]]);case 2:return n.t0=n.sent.length,n.abrupt("return",0===n.t0);case 4:case"end":return n.stop()}},n)}))()}},{key:"setUsername",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.userDAO.update(e,{username:t});case 2:case"end":return r.stop()}},r)}))()}},{key:"markAsVerified",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.userDAO.update(e,{verified:!0});case 2:case"end":return n.stop()}},n)}))()}},{key:"observeUser",value:function(e,t){return this.userDAO.subscribeToChanges(e,t)}},{key:"getUserLastUpdateTime",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.userDAO.read(e);case 2:if(!(r=n.sent).isAbsent()){n.next=5;break}return n.abrupt("return",fB.empty());case 5:return i=r.get().lastUpdateTime,n.abrupt("return",(v7(null!=i,"should not receive a lastUpdateTime equal to null"),fB.of(i)));case 7:case"end":return n.stop()}},n)}))()}},{key:"updatePresenceToken",value:function(e){return this.userDAO.update(e,{lastUpdateTime:NJ()})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(p7))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),y7=function(e){xg(n,e);var t=Dg(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r3;return Zg(this,n),(e=t.call(this))._bufferSize=r,e._windowTime=i,e._timestampProvider=a,e._buffer=[],e._infiniteTimeWindow=!0,e._infiniteTimeWindow=i===1/0,e._bufferSize=Math.max(1,r),e._windowTime=Math.max(1,i),e}return Wg(n,[{key:"next",value:function(e){var t=this.isStopped,r=this._buffer,i=this._infiniteTimeWindow,a=this._timestampProvider,o=this._windowTime;t||(r.push(e),!i&&r.push(a.now()+o)),this._trimBuffer(),Rg(Vg(n.prototype),"next",this).call(this,e)}},{key:"_subscribe",value:function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t}},{key:"_trimBuffer",value:function(){var e=this._bufferSize,t=this._timestampProvider,n=this._buffer,r=this._infiniteTimeWindow,i=(r?1:2)*e;if(e<1/0&&i<n.length&&n.splice(0,n.length-i),!r){for(var a=t.now(),o=0,s=1;s<n.length&&n[s]<=a;s+=2)o=s;o&&n.splice(0,o+1)}}}]),n}(Cy),m7=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"createUserWithEmailAndPassword",value:function(e,t,n){return M8(e,t,n)}},{key:"sendEmailVerification",value:function(e){return D8(e)}},{key:"sendPasswordResetEmail",value:function(e,t){return L8(e,t)}},{key:"signInWithEmailAndPassword",value:function(e,t,n){return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,F8(e,t,n);case 2:return r.abrupt("return",r.sent.user);case 3:case"end":return r.stop()}},r)}))()}},{key:"signInWithPopup",value:function(e,t){return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,U8(e,t);case 2:return n.abrupt("return",n.sent.user);case 3:case"end":return n.stop()}},n)}))()}},{key:"updateProfile",value:function(e,t){return V8(e,t)}}]),e}(),k7=function(){function e(t,n,r,i){Zg(this,e),this.id=t,this.email=n,this.username=r,this.verified=i}return Wg(e,[{key:"isConnected",value:function(){return this.email.isPresent()}},{key:"toMinimalUser",value:function(){return{id:this.id,name:this.username.get()}}}]),e}();k7.NOT_CONNECTED=new k7("",fB.empty(),fB.empty(),!1);var C7=function(){var e=function(){function e(t,n,r){Zg(this,e);var i,a=this;this.userDAO=t,this.userService=n,this.auth=r,this.user=fB.empty(),this.userSubscription=new qg,sB(e.VERBOSE,"ConnectedUserService constructor"),this.userRS=new y7(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new qg(N8(this.auth,(i=aB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:null==n?(sB(e.VERBOSE,"User is not connected"),a.userSubscription.unsubscribe(),a.userRS.next(k7.NOT_CONNECTED),a.user=fB.empty()):(v7(a.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),a.userSubscription=a.userDAO.subscribeToChanges(n.uid,function(t){if(t.isPresent()){var r=t.get().username;sB(e.VERBOSE,"User ".concat(r," is connected, and the verified status is ").concat(a.emailVerified(n)));var i=!0===a.emailVerified(n)&&null!=r;if(!0===i&&!1===t.get().verified)return a.userService.markAsVerified(n.uid);var o=new k7(n.uid,fB.ofNullable(n.email),fB.ofNullable(r),i);a.user=fB.of(o),a.userRS.next(o)}}));case 1:case"end":return t.stop()}},t)})),function(e){return i.apply(this,arguments)})))}return Wg(e,[{key:"emailVerified",value:function(e){return e.emailVerified}},{key:"sendPasswordResetEmail",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,m7.sendPasswordResetEmail(t.auth,e);case 3:return n.abrupt("return",pB.SUCCESS);case 6:return n.prev=6,n.t0=n.catch(0),n.abrupt("return",pB.failure(t.mapFirebaseError(n.t0)));case 9:case"end":return n.stop()}},n,null,[[0,6]])}))()}},{key:"doRegister",value:function(t,n,i){var a=this;return aB(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return sB(e.VERBOSE,"ConnectedUserService.doRegister("+n+")"),o.next=3,a.userService.usernameIsAvailable(t);case 3:if(!o.sent){o.next=7;break}o.t0=a.registerAfterUsernameCheck(t,n,i),o.next=8;break;case 7:o.t0=hB.failure($localize(r||(r=_g(["This username is already in use."]))));case 8:return o.abrupt("return",o.t0);case 9:case"end":return o.stop()}},o)}))()}},{key:"registerAfterUsernameCheck",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,m7.createUserWithEmailAndPassword(r.auth,t,n);case 3:return a=i.sent,i.next=6,m7.signInWithEmailAndPassword(r.auth,t,n);case 6:return o=oB.getNonNullable(a.user),i.next=9,r.createUser(o.uid,e);case 9:return i.abrupt("return",hB.success(o));case 12:return i.prev=12,i.t0=i.catch(0),i.abrupt("return",hB.failure(r.mapFirebaseError(i.t0)));case 15:case"end":return i.stop()}},i,null,[[0,12]])}))()}},{key:"mapFirebaseError",value:function(e){switch(e.code){case"auth/email-already-in-use":return $localize(i||(i=_g(["This email address is already in use."])));case"auth/invalid-email":return $localize(a||(a=_g(["This email address is invalid."])));case"auth/user-not-found":case"auth/wrong-password":return $localize(o||(o=_g(["You have entered invalid credentials."])));case"auth/invalid-credential":return $localize(s||(s=_g(["The credential is invalid or has expired, please try again."])));case"auth/weak-password":return $localize(u||(u=_g(["Your password is too weak, please use a stronger password."])));case"auth/too-many-requests":return $localize(c||(c=_g(["There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later."])));case"auth/popup-closed-by-user":return $localize(l||(l=_g(["You closed the authentication popup without finalizing your log in."])));case"auth/popup-blocked":return $localize(f||(f=_g(["The authentication popup was blocked. Try again after disabling popup blocking."])));default:return d7.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}},{key:"sendEmailVerification",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(sB(e.VERBOSE,"ConnectedUserService.sendEmailVerification()"),(r=fB.ofNullable(t.auth.currentUser)).isPresent()){n.next=4;break}return n.abrupt("return",d7.logError("ConnectedUserService","Unlogged users cannot request for email verification"));case 4:if(!t.emailVerified(r.get())){n.next=6;break}return n.abrupt("return",d7.logError("ConnectedUserService","Verified users should not ask email verification after being verified"));case 6:return n.prev=6,n.next=9,m7.sendEmailVerification(r.get());case 9:return n.abrupt("return",pB.SUCCESS);case 12:return n.prev=12,n.t0=n.catch(6),n.abrupt("return",pB.failure(t.mapFirebaseError(n.t0)));case 15:case"end":return n.stop()}},n,null,[[6,12]])}))()}},{key:"doEmailLogin",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return sB(e.VERBOSE,"ConnectedUserService.doEmailLogin("+t+")"),i.prev=1,i.next=4,m7.signInWithEmailAndPassword(r.auth,t,n);case 4:return i.abrupt("return",pB.SUCCESS);case 7:return i.prev=7,i.t0=i.catch(1),i.abrupt("return",pB.failure(r.mapFirebaseError(i.t0)));case 10:case"end":return i.stop()}},i,null,[[1,7]])}))()}},{key:"createUser",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null!=t){r.next=5;break}return r.next=3,n.userDAO.set(e,{verified:!1});case 3:r.next=7;break;case 5:return r.next=7,n.userDAO.set(e,{username:t,verified:!1});case 7:case"end":return r.stop()}},r)}))()}},{key:"doGoogleLogin",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=pB,t.next=3,e.registerOrLoginWithGoogle();case 3:return t.t1=t.sent,t.abrupt("return",t.t0.ofFallible.call(t.t0,t.t1));case 5:case"end":return t.stop()}},t)}))()}},{key:"registerOrLoginWithGoogle",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=new j5).addScope("profile"),n.addScope("email"),t.next=5,m7.signInWithPopup(e.auth,n);case 5:return r=t.sent,t.t0=!1,t.next=9,e.userDAO.exists(r.uid);case 9:if(t.t1=t.sent,t.t2=t.t0===t.t1,!t.t2){t.next=14;break}return t.next=14,e.createUser(r.uid);case 14:return t.abrupt("return",hB.success(r));case 17:return t.prev=17,t.t3=t.catch(0),t.abrupt("return",hB.failure(e.mapFirebaseError(t.t3)));case 20:case"end":return t.stop()}},t,null,[[0,17]])}))()}},{key:"disconnect",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!fB.ofNullable(e.auth.currentUser).isPresent()){t.next=6;break}return t.next=3,e.auth.signOut();case 3:t.t0=pB.SUCCESS,t.next=7;break;case 6:t.t0=pB.failure("Cannot disconnect a non-connected user");case 7:return t.abrupt("return",t.t0);case 8:case"end":return t.stop()}},t)}))()}},{key:"subscribeToUser",value:function(e){return this.userObs.subscribe(e)}},{key:"setUsername",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(""!==e){n.next=2;break}return n.abrupt("return",pB.failure($localize(h||(h=_g(["Your username may not be empty."])))));case 2:return n.prev=2,n.t0=!1,n.next=6,t.userService.usernameIsAvailable(e);case 6:if(n.t1=n.sent,n.t0!==n.t1){n.next=9;break}return n.abrupt("return",pB.failure($localize(d||(d=_g(["This username is already in use, please select a different one."])))));case 9:return r=oB.getNonNullable(t.auth.currentUser),n.next=12,m7.updateProfile(r,{displayName:e});case 12:return n.next=14,t.userService.setUsername(r.uid,e);case 14:return n.next=16,t.userService.markAsVerified(r.uid);case 16:return n.next=18,t.reloadUser();case 18:return n.abrupt("return",pB.SUCCESS);case 21:return n.prev=21,n.t2=n.catch(2),n.abrupt("return",pB.failure(t.mapFirebaseError(n.t2)));case 24:case"end":return n.stop()}},n,null,[[2,21]])}))()}},{key:"setPicture",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r=oB.getNonNullable(t.auth.currentUser),n.next=4,m7.updateProfile(r,{photoURL:e});case 4:return n.abrupt("return",pB.SUCCESS);case 7:return n.prev=7,n.t0=n.catch(0),n.abrupt("return",pB.failure(t.mapFirebaseError(n.t0)));case 10:case"end":return n.stop()}},n,null,[[0,7]])}))()}},{key:"reloadUser",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=oB.getNonNullable(e.auth.currentUser),t.next=3,n.getIdToken(!0);case 3:return t.next=5,n.reload();case 5:case"end":return t.stop()}},t)}))()}},{key:"updateObservedPart",value:function(e){return v7(this.user.isPresent(),"Should not call updateObservedPart when not connected"),this.userDAO.update(this.user.get().id,{observedPart:e})}},{key:"removeObservedPart",value:function(){return v7(this.user.isPresent(),"Should not call removeObservedPart when not connected"),this.userDAO.update(this.user.get().id,{observedPart:null})}},{key:"sendPresenceToken",value:function(){return v7(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}},{key:"ngOnDestroy",value:function(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(pw(p7),pw(g7),pw(P8))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),w7=Wg(function e(t){Zg(this,e),this.value=t});w7.HARD_DRAW=new w7(0),w7.RESIGN=new w7(1),w7.ESCAPE=new w7(2),w7.VICTORY=new w7(3),w7.TIMEOUT=new w7(4),w7.UNACHIEVED=new w7(5),w7.AGREED_DRAW_BY_ZERO=new w7(6),w7.AGREED_DRAW_BY_ONE=new w7(7);var _7=function(){function e(t,n){Zg(this,e),this.id=t,this.data=n}return Wg(e,[{key:"getTurn",value:function(){return this.data.turn}},{key:"isHardDraw",value:function(){return this.data.result===w7.HARD_DRAW.value}},{key:"isAgreedDraw",value:function(){return this.data.result===w7.AGREED_DRAW_BY_ZERO.value||this.data.result===w7.AGREED_DRAW_BY_ONE.value}},{key:"getDrawAccepter",value:function(){return this.data.result===w7.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(v7(this.data.result===w7.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),oB.getNonNullable(this.data.playerOne))}},{key:"isWin",value:function(){return this.data.result===w7.VICTORY.value}},{key:"isTimeout",value:function(){return this.data.result===w7.TIMEOUT.value}},{key:"isResign",value:function(){return this.data.result===w7.RESIGN.value}},{key:"getWinner",value:function(){return fB.ofNullable(this.data.winner)}},{key:"getLoser",value:function(){return fB.ofNullable(this.data.loser)}},{key:"setWinnerAndLoser",value:function(t,n){return new e(this.id,bg(bg({},this.data),{},{winner:t,loser:n}))}}]),e}(),E7=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,null,[{key:"of",value:function(t){switch(t){case"CREATOR":return e.CREATOR;case"RANDOM":return e.RANDOM;default:return v7("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),e.CHOSEN_PLAYER}}}]),e}();E7.CREATOR=new E7("CREATOR"),E7.RANDOM=new E7("RANDOM"),E7.CHOSEN_PLAYER=new E7("CHOSEN_PLAYER");var b7=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,null,[{key:"of",value:function(t){switch(t){case"STANDARD":return e.STANDARD;case"BLITZ":return e.BLITZ;case"CUSTOM":return e.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}]),e}();b7.STANDARD=new b7("STANDARD"),b7.BLITZ=new b7("BLITZ"),b7.CUSTOM=new b7("CUSTOM"),b7.NORMAL_MOVE_DURATION=120,b7.NORMAL_PART_DURATION=1800,b7.BLITZ_MOVE_DURATION=30,b7.BLITZ_PART_DURATION=900;var P7=Wg(function e(t){Zg(this,e),this.value=t});P7.PART_CREATED=new P7(0),P7.CONFIG_PROPOSED=new P7(2),P7.PART_STARTED=new P7(3),P7.PART_FINISHED=new P7(4);var S7=Wg(function e(){Zg(this,e)}),O7=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encode",value:function(e){return this.encodeMove(e)}},{key:"decode",value:function(e){return v7(!1===Array.isArray(e),"MoveEncoder.decode called with an array"),this.decodeMove(e)}}],[{key:"disjunction3",value:function(e,t,r,i,a){return new(function(n){xg(s,n);var o=Dg(s);function s(){return Zg(this,s),o.apply(this,arguments)}return Wg(s,[{key:"encodeMove",value:function(n){return i(n)?{type:"T1",encoded:e.encode(n)}:a(n)?{type:"T2",encoded:t.encode(n)}:{type:"T3",encoded:r.encode(n)}}},{key:"decodeMove",value:function(n){var i=oB.getNonNullable(n).type,a=oB.getNonNullable(n).encoded;return"T1"===i?e.decode(a):"T2"===i?t.decode(a):r.decode(a)}}]),s}(n))}}]),n}(S7),T7=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"shift",value:function(){return this.maxValue()+1}},{key:"encodeMove",value:function(e){return this.encodeNumber(e)}},{key:"decodeMove",value:function(e){return v7("number"==typeof e,"Invalid encoded number"),this.decodeNumber(e)}}],[{key:"ofN",value:function(e,t,r){return new(function(n){xg(a,n);var i=Dg(a);function a(){return Zg(this,a),i.apply(this,arguments)}return Wg(a,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(e){return t(e)}},{key:"decodeNumber",value:function(e){return r(e)}}]),a}(n))}},{key:"tuple",value:function(e,t,r){return new(function(n){xg(a,n);var i=Dg(a);function a(){return Zg(this,a),i.apply(this,arguments)}return Wg(a,[{key:"maxValue",value:function(){var t=0;return Object.keys(e).forEach(function(n){t=t*e[n].shift()+e[n].maxValue()}),t}},{key:"encodeNumber",value:function(n){var r=t(n),i=0;return Object.keys(r).forEach(function(t){i=i*e[t].shift()+e[t].encode(r[t])}),i}},{key:"decodeNumber",value:function(t){var n={},i=t;return Object.keys(e).reverse().forEach(function(t){var r=i%e[t].shift();i=(i-r)/e[t].shift(),n[t]=e[t].decode(r)}),r(n)}}]),a}(n))}},{key:"disjunction",value:function(e,t,r){return new(function(n){xg(a,n);var i=Dg(a);function a(){return Zg(this,a),i.apply(this,arguments)}return Wg(a,[{key:"maxValue",value:function(){return Math.max(2*e.maxValue(),2*t.maxValue()+1)}},{key:"encodeNumber",value:function(n){return r(n)?2*e.encodeNumber(n):2*t.encodeNumber(n)+1}},{key:"decodeNumber",value:function(n){return n%2==0?e.decodeNumber(n/2):t.decodeNumber((n-1)/2)}}]),a}(n))}},{key:"numberEncoder",value:function(e){return new(function(t){xg(r,t);var n=Dg(r);function r(){return Zg(this,r),n.apply(this,arguments)}return Wg(r,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(t){if(t>e)throw new Error("Cannot encode number bigger than the max with numberEncoder");return t}},{key:"decodeNumber",value:function(t){if(t>e)throw new Error("Cannot decode number bigger than the max with numberEncoder");return t}}]),r}(n))}}]),n}(O7);T7.booleanEncoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 1}},{key:"encodeNumber",value:function(e){return e?1:0}},{key:"decodeNumber",value:function(e){if(0===e)return!1;if(1===e)return!0;throw new Error("Invalid encoded boolean")}}]),n}(T7));var I7=function(){function e(){Zg(this,e),this.value=2}return Wg(e,[{key:"isPlayer",value:function(){return!1}},{key:"toString",value:function(){return"PlayerNone"}},{key:"equals",value:function(e){return this===e}}]),e}();I7.NONE=new I7;var A7,R7=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,[{key:"isPlayer",value:function(){return!0}},{key:"toString",value:function(){return"Player "+this.value}},{key:"equals",value:function(e){return this===e}},{key:"getScoreModifier",value:function(){return 0===this.value?-1:1}},{key:"getPreVictory",value:function(){return this.getVictoryValue()-this.getScoreModifier()}},{key:"getDefeatValue",value:function(){return this===e.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}},{key:"getVictoryValue",value:function(){return this===e.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}},{key:"getOpponent",value:function(){return this===e.ZERO?e.ONE:(oB.expectToBe(this,e.ONE),e.ZERO)}}],[{key:"of",value:function(t){return 0===t?e.ZERO:(oB.expectToBe(t,1),e.ONE)}},{key:"fromTurn",value:function(t){return t%2==0?e.ZERO:e.ONE}}]),e}();R7.numberEncoder=T7.ofN(2,function(e){return e.value},function(e){return 2===e?A7.NONE:R7.of(e)}),R7.ZERO=new R7(0),R7.ONE=new R7(1),R7.PLAYERS=[R7.ZERO,R7.ONE],function(e){e.ZERO=R7.ZERO,e.ONE=R7.ONE,e.NONE=I7.NONE}(A7||(A7={}));var M7=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"rematchAccepted",value:function(e,t){return x7("RematchAccepted",{typeGame:e,partId:t})}},{key:"getPlayer",value:function(e){return R7.of(oB.getNonNullable(e.data).player)}},{key:"getTypeGame",value:function(e){return oB.getNonNullable(e.data).typeGame}},{key:"getPartId",value:function(e){return oB.getNonNullable(e.data).partId}}]),e}();function x7(e,t){return{code:e,data:t}}function N7(e){return function(t){return x7(e,{player:t.value})}}M7.drawProposed=N7("DrawProposed"),M7.drawAccepted=x7("DrawAccepted",{}),M7.drawRefused=N7("DrawRefused"),M7.takeBackAsked=N7("TakeBackAsked"),M7.takeBackRefused=N7("TakeBackRefused"),M7.takeBackAccepted=N7("TakeBackAccepted"),M7.rematchProposed=N7("RematchProposed"),M7.addTurnTime=N7("AddTurnTime"),M7.addGlobalTime=N7("AddGlobalTime");var D7=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"mapBiArray",value:function(e,t){for(var n=[],r=0;r<e.length;){n[r]=[];for(var i=0;i<e[r].length;)n[r][i]=t(e[r][i]),i++;r++}return n}},{key:"createTable",value:function(e,t,n){for(var r=[],i=t-1;i>=0;){r[i]=[];for(var a=e-1;a>=0;)r[i][a]=n,a--;i--}return r}},{key:"copyBiArray",value:function(t){for(var n=[],r=0;r<t.length;)n[r]=e.copyImmutableArray(t[r]),r++;return n}},{key:"copyImmutableArray",value:function(e){for(var t=[],n=0;n<e.length;)t[n]=e[n],n++;return t}},{key:"sortByDescending",value:function(e,t){e.sort(function(e,n){var r=t(e),i=t(n);return r<i?1:r>i?-1:0})}},{key:"compareArray",value:function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!1===lB(e[n],t[n]))return!1;return!0}},{key:"compareTable",value:function(t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!1===e.compareArray(t[r],n[r]))return!1;return!0}}]),e}(),L7=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),r=t.call(this,"parts",e),sB(n.VERBOSE,"PartDAO.constructor"),r}return Wg(n)}(o7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(pw(B8))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),F7=Wg(function e(t,n,r){Zg(this,e),this.onDocumentCreated=t,this.onDocumentModified=n,this.onDocumentDeleted=r}),U7=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),r=t.call(this,"config-room",e),sB(n.VERBOSE,"ConfigRoomDAO.constructor"),r}return Wg(n)}(o7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(pw(B8))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),V7=function(){var e=function(){function e(t,n){Zg(this,e),this.configRoomDAO=t,this.connectedUserService=n,sB(e.VERBOSE,"ConfigRoomService.constructor")}return Wg(e,[{key:"addCandidate",value:function(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(t.id,t)}},{key:"removeCandidate",value:function(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(t.id)}},{key:"subscribeToChanges",value:function(e,t){return this.configRoomDAO.subscribeToChanges(e,t)}},{key:"subscribeToCandidates",value:function(e,t){var n=[],r=new F7(function(e){var r,i=Hg(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;n.push(a.data)}}catch(o){i.e(o)}finally{i.f()}t(n)},function(e){var r,i=Hg(e);try{var a=function(){var e=r.value;n=n.map(function(t){return t.id===e.data.id?e.data:t})};for(i.s();!(r=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}t(n)},function(e){var r,i=Hg(e);try{var a=function(){var e=r.value;n=n.filter(function(t){return t.id!==e.data.id})};for(i.s();!(r=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}t(n)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],r)}},{key:"createInitialConfigRoom",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,"ConfigRoomService.createInitialConfigRoom("+t+")"),i=n.connectedUserService.user.get().toMinimalUser(),r.abrupt("return",n.configRoomDAO.set(t,{chosenOpponent:null,firstPlayer:E7.RANDOM.value,partType:b7.STANDARD.value,partStatus:P7.PART_CREATED.value,maximalMoveDuration:b7.NORMAL_MOVE_DURATION,totalPartDuration:b7.NORMAL_PART_DURATION,creator:i}));case 3:case"end":return r.stop()}},r)}))()}},{key:"joinGame",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,"ConfigRoomService.joinGame("+t+")"),i=n.connectedUserService.user.get().toMinimalUser(),r.next=4,n.configRoomDAO.read(t);case 4:if(!(a=r.sent).isAbsent()){r.next=9;break}r.t0=pB.failure(e.GAME_DOES_NOT_EXIST()),r.next=14;break;case 9:if(r.t1=a.get().creator.id!==i.id,!r.t1){r.next=13;break}return r.next=13,n.addCandidate(t,i);case 13:r.t0=pB.SUCCESS;case 14:return r.abrupt("return",r.t0);case 15:case"end":return r.stop()}},r)}))()}},{key:"cancelJoining",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,"ConfigRoomService.cancelJoining(".concat(t,")")),i=n.connectedUserService.user.get().toMinimalUser(),r.next=4,n.configRoomDAO.read(t);case 4:if((a=r.sent).isAbsent()){r.next=10;break}return s=a.get(),u=[n.removeCandidate(t,i)],(null===(o=s.chosenOpponent)||void 0===o?void 0:o.id)===i.id&&u.push(n.configRoomDAO.update(t,{chosenOpponent:null,partStatus:P7.PART_CREATED.value})),r.next=10,Promise.all(u);case 10:case"end":return r.stop()}},r)}))()}},{key:"deleteConfigRoom",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return sB(e.VERBOSE,"ConfigRoomService.deleteConfigRoom(".concat(t)),i.next=3,Promise.all(n.map(function(e){return r.removeCandidate(t,e)}));case 3:return i.next=5,r.configRoomDAO.delete(t);case 5:case"end":return i.stop()}},i)}))()}},{key:"proposeConfig",value:function(t,n,r,i,a,o){var s=this;return aB(regeneratorRuntime.mark(function u(){return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(sB(e.VERBOSE,{configRoomService_proposeConfig:{configRoomId:t,maximalMoveDuration:i,firstPlayer:a,totalPartDuration:o}}),s.configRoomDAO.update(t,{partStatus:P7.CONFIG_PROPOSED.value,chosenOpponent:n,partType:r.value,maximalMoveDuration:i,totalPartDuration:o,firstPlayer:a.value})));case 1:case"end":return u.stop()}},u)}))()}},{key:"setChosenOpponent",value:function(t,n){return sB(e.VERBOSE,"ConfigRoomService.setChosenOpponent(".concat(t,", ").concat(n.name,")")),this.configRoomDAO.update(t,{chosenOpponent:n})}},{key:"reviewConfig",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(sB(e.VERBOSE,"ConfigRoomService.reviewConfig(".concat(t,")")),n.configRoomDAO.update(t,{partStatus:P7.PART_CREATED.value})));case 1:case"end":return r.stop()}},r)}))()}},{key:"reviewConfigAndRemoveChosenOpponent",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(sB(e.VERBOSE,"ConfigRoomService.reviewConfigAndRemoveChosenOpponent(".concat(t,")")),n.configRoomDAO.update(t,{partStatus:P7.PART_CREATED.value,chosenOpponent:null})));case 1:case"end":return r.stop()}},r)}))()}},{key:"acceptConfig",value:function(t){return sB(e.VERBOSE,"ConfigRoomService.acceptConfig(".concat(t)),this.configRoomDAO.update(t,{partStatus:P7.PART_STARTED.value})}},{key:"createConfigRoom",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(sB(e.VERBOSE,"ConfigRoomService.create(".concat(t)+JSON.stringify(n)+")"),r.configRoomDAO.set(t,n)));case 1:case"end":return i.stop()}},i)}))()}},{key:"readConfigRoomById",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,"ConfigRoomService.readConfigRoomById(".concat(t,")")),r.next=3,n.configRoomDAO.read(t);case 3:return r.abrupt("return",r.sent.get());case 4:case"end":return r.stop()}},r)}))()}}]),e}();return e.VERBOSE=!1,e.GAME_DOES_NOT_EXIST=function(){return $localize(v||(v=_g(["Game does not exist"])))},e.\u0275fac=function(t){return new(t||e)(pw(U7),pw(C7))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),B7=function(){var e=function(){function e(t,n,r,i){Zg(this,e),this.partDAO=t,this.connectedUserService=n,this.configRoomService=r,this.chatService=i,sB(e.VERBOSE,"GameService.constructor")}return Wg(e,[{key:"updateAndBumpIndex",value:function(e,t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(r=bg(bg({},r),{},{lastUpdate:{index:n+1,player:t.value}}),i.partDAO.update(e,r)));case 1:case"end":return a.stop()}},a)}))()}},{key:"getPartValidity",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.partDAO.read(e);case 2:return i=r.sent,r.abrupt("return",i.isAbsent()?pB.failure("NONEXISTENT_PART"):i.get().typeGame===t?pB.SUCCESS:pB.failure("WRONG_GAME_TYPE"));case 4:case"end":return r.stop()}},r)}))()}},{key:"createUnstartedPart",value:function(t){sB(e.VERBOSE,"GameService.createPart("+t+")");var n=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({lastUpdate:{index:0,player:0},typeGame:t,playerZero:n,turn:-1,result:w7.UNACHIEVED.value,listMoves:[]})}},{key:"createChat",value:function(t){return sB(e.VERBOSE,"GameService.createChat("+t+")"),this.chatService.createNewChat(t)}},{key:"createPartConfigRoomAndChat",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,"GameService.createGame(".concat(t,")")),r.next=3,n.createUnstartedPart(t);case 3:return i=r.sent,r.next=6,n.configRoomService.createInitialConfigRoom(i);case 6:return r.next=8,n.createChat(i);case 8:return r.abrupt("return",i);case 9:case"end":return r.stop()}},r)}))()}},{key:"startGameWithConfig",value:function(t,n,r,i){sB(e.VERBOSE,"GameService.startGameWithConfig("+t+", "+JSON.stringify(i));var a=this.getStartingConfig(i);return this.updateAndBumpIndex(t,n,r,a)}},{key:"getStartingConfig",value:function(e){var t,n,r=E7.of(e.firstPlayer);return r===E7.RANDOM&&(r=Math.random()<.5?E7.CREATOR:E7.CHOSEN_PLAYER),r===E7.CREATOR?(t=e.creator,n=oB.getNonNullable(e.chosenOpponent)):(t=oB.getNonNullable(e.chosenOpponent),n=e.creator),{playerZero:t,playerOne:n,turn:0,beginning:NJ(),remainingMsForZero:1e3*e.totalPartDuration,remainingMsForOne:1e3*e.totalPartDuration}}},{key:"deletePart",value:function(t){return sB(e.VERBOSE,"GameService.deletePart("+t+")"),this.partDAO.delete(t)}},{key:"acceptConfig",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return sB(e.VERBOSE,{gameService_acceptConfig:{partId:t,configRoom:n}}),i.next=3,r.configRoomService.acceptConfig(t);case 3:return i.abrupt("return",r.startGameWithConfig(t,R7.ONE,0,n));case 4:case"end":return i.stop()}},i)}))()}},{key:"subscribeToChanges",value:function(e,t){return this.partDAO.subscribeToChanges(e,t)}},{key:"resign",value:function(e,t,n,r,i){return this.updateAndBumpIndex(e,n,t,{winner:r,loser:i,result:w7.RESIGN.value,request:null})}},{key:"notifyTimeout",value:function(e,t,n,r,i){return this.updateAndBumpIndex(e,t,n,{winner:r,loser:i,result:w7.TIMEOUT.value,request:null})}},{key:"sendRequest",value:function(e,t,n,r){return this.updateAndBumpIndex(e,t,n,{request:r})}},{key:"proposeDraw",value:function(e,t,n){return this.sendRequest(e,n,t,M7.drawProposed(n))}},{key:"acceptDraw",value:function(e,t,n){return this.updateAndBumpIndex(e,n,t,{result:(n===R7.ZERO?w7.AGREED_DRAW_BY_ZERO:w7.AGREED_DRAW_BY_ONE).value,request:null})}},{key:"refuseDraw",value:function(e,t,n){return this.sendRequest(e,n,t,M7.drawRefused(n))}},{key:"proposeRematch",value:function(e,t,n){return this.sendRequest(e,n,t,M7.rematchProposed(n))}},{key:"acceptRematch",value:function(t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o,s,u,c,l,f,h,d,v;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return sB(e.VERBOSE,{called:"GameService.acceptRematch(",partDocument:t}),o=oB.getNonNullable(t.data),a.next=4,i.configRoomService.readConfigRoomById(t.id);case 4:return s=a.sent,c=i.connectedUserService.user.get().toMinimalUser(),o.playerZero.id===c.id?(l=oB.getNonNullable(o.playerOne),u=E7.CHOSEN_PLAYER):(l=o.playerZero,u=E7.CREATOR),f=bg(bg({},s),{},{firstPlayer:u.value,creator:c,chosenOpponent:l,partStatus:P7.PART_STARTED.value}),h=i.getStartingConfig(f),d=bg({lastUpdate:{index:0,player:r.value},typeGame:o.typeGame,result:w7.UNACHIEVED.value,listMoves:[]},h),a.next=12,i.partDAO.create(d);case 12:return v=a.sent,a.next=15,i.configRoomService.createConfigRoom(v,f);case 15:return a.next=17,i.createChat(v);case 17:return a.abrupt("return",i.sendRequest(t.id,r,n,M7.rematchAccepted(o.typeGame,v)));case 18:case"end":return a.stop()}},a)}))()}},{key:"askTakeBack",value:function(e,t,n){return this.sendRequest(e,n,t,M7.takeBackAsked(n))}},{key:"acceptTakeBack",value:function(e,t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o,s,u,c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return v7(M7.getPlayer(oB.getNonNullable(t.data.request))!==n,"Illegal to accept your own request"),o=M7.takeBackAccepted(n),(s=t.data.listMoves.slice(0,t.data.listMoves.length-1)).length%2===n.value&&(s=s.slice(0,s.length-1)),u={request:o,listMoves:s,turn:s.length,lastUpdateTime:NJ(),remainingMsForZero:oB.getNonNullable(t.data.remainingMsForZero)-r[0],remainingMsForOne:oB.getNonNullable(t.data.remainingMsForOne)-r[1]},c=t.data.lastUpdate.index,a.next=7,i.updateAndBumpIndex(e,n,c,u);case 7:return a.abrupt("return",a.sent);case 8:case"end":return a.stop()}},a)}))()}},{key:"refuseTakeBack",value:function(e,t,n){var r=M7.takeBackRefused(n);return this.updateAndBumpIndex(e,n,t,{request:r})}},{key:"addGlobalTime",value:function(e,t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o={request:M7.addGlobalTime(r.getOpponent())},o=r===R7.ZERO?bg(bg({},o),{},{remainingMsForOne:oB.getNonNullable(n.remainingMsForOne)+3e5}):bg(bg({},o),{},{remainingMsForZero:oB.getNonNullable(n.remainingMsForZero)+3e5}),a.next=4,i.updateAndBumpIndex(e,r,t,o);case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}},a)}))()}},{key:"addTurnTime",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a={request:M7.addTurnTime(e.getOpponent())},i.next=3,r.updateAndBumpIndex(n,e,t,a);case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"updateDBBoard",value:function(t,n,r,i,a,o,s,u){var c=this;return aB(regeneratorRuntime.mark(function l(){var f,h,d,v,p;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return sB(e.VERBOSE,{gameService_updateDBBoard:{partId:t,encodedMove:r,scores:a,msToSubstract:i,notifyDraw:o,winner:s,loser:u}}),l.next=3,c.partDAO.read(t);case 3:return f=l.sent.get(),h=f.lastUpdate.index,d=f.turn+1,(v=D7.copyImmutableArray(f.listMoves))[v.length]=r,p={listMoves:v,turn:d,request:null,lastUpdateTime:NJ()},p=c.updateScore(p,a),p=c.substractMs(p,f,i),null!=s?p=bg(bg({},p),{},{winner:s,loser:u,result:w7.VICTORY.value}):!0===o&&(p=bg(bg({},p),{},{result:w7.HARD_DRAW.value})),l.next=14,c.updateAndBumpIndex(t,n,h,p);case 14:return l.abrupt("return",l.sent);case 15:case"end":return l.stop()}},l)}))()}},{key:"updateScore",value:function(e,t){return void 0!==t?bg(bg({},e),{},{scorePlayerZero:t[0],scorePlayerOne:t[1]}):e}},{key:"substractMs",value:function(e,t,n){return n[0]>0?bg(bg({},e),{},{remainingMsForZero:oB.getNonNullable(t.remainingMsForZero)-n[0]}):n[1]>0?bg(bg({},e),{},{remainingMsForOne:oB.getNonNullable(t.remainingMsForOne)-n[1]}):e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(pw(L7),pw(C7),pw(V7),pw(c7))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),z7={prefix:"fab",iconName:"facebook",icon:[512,512,[],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},H7={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},G7={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]},$7=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"getNavigatorLanguage",value:function(){return navigator.language}},{key:"getLocale",value:function(){var t,n,r=(null!==(t=null!==(n=localStorage.getItem("locale"))&&void 0!==n?n:e.getNavigatorLanguage())&&void 0!==t?t:"fr").slice(0,2).toLowerCase();return["en","fr"].some(function(e){return e===r})?r:"fr"}}]),e}(),Z7=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"changeTheme",value:function(e){localStorage.setItem("theme",e)}},{key:"getTheme",value:function(){return fB.ofNullable(localStorage.getItem("theme"))}},{key:"changeLanguage",value:function(e){localStorage.setItem("locale",e.toLowerCase())}},{key:"getLanguage",value:function(){return $7.getLocale()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),q7=function(){var e=function(){function e(t,n){Zg(this,e),this.document=t,this.userSettingsService=n,this.availableThemes=["dark","light"];var r=this.getStoredTheme();r.isPresent()?this.loadTheme(r.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}return Wg(e,[{key:"getStoredTheme",value:function(){var e=this.userSettingsService.getTheme();if(e.isPresent()){var t=e.get();if(this.availableThemes.some(function(e){return e===t}))return fB.of(t)}return fB.empty()}},{key:"loadTheme",value:function(e){this.loadStyle(e+".css"),this.theme=e}},{key:"loadStyle",value:function(e){var t=this.document.getElementsByTagName("head")[0],n=this.document.getElementById("theme");if(null!=n)n.href=e;else{var r=this.document.createElement("link");r.id="theme",r.rel="stylesheet",r.href="".concat(e),t.appendChild(r)}}},{key:"getTheme",value:function(){return this.theme}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(RI),pw(Z7))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),W7={prefix:"fas",iconName:"book-open",icon:[576,512,[],"f518","M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"]},j7={prefix:"fas",iconName:"cog",icon:[512,512,[],"f013","M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"]},Y7={prefix:"fas",iconName:"desktop",icon:[576,512,[],"f108","M528 0H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h192l-16 48h-72c-13.3 0-24 10.7-24 24s10.7 24 24 24h272c13.3 0 24-10.7 24-24s-10.7-24-24-24h-72l-16-48h192c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zm-16 352H64V64h448v288z"]},K7={prefix:"fas",iconName:"eye",icon:[576,512,[],"f06e","M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"]},Q7={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M640 264v-16c0-8.84-7.16-16-16-16H344v-40h72c17.67 0 32-14.33 32-32V32c0-17.67-14.33-32-32-32H224c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h72v40H16c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h104v40H64c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h304v40h-56c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h104c8.84 0 16-7.16 16-16zM256 128V64h128v64H256zm-64 320H96v-64h96v64zm352 0h-96v-64h96v64z"]},X7={prefix:"fas",iconName:"reply",icon:[512,512,[],"f3e5","M8.309 189.836L184.313 37.851C199.719 24.546 224 35.347 224 56.015v80.053c160.629 1.839 288 34.032 288 186.258 0 61.441-39.581 122.309-83.333 154.132-13.653 9.931-33.111-2.533-28.077-18.631 45.344-145.012-21.507-183.51-176.59-185.742V360c0 20.7-24.3 31.453-39.687 18.164l-176.004-152c-11.071-9.562-11.086-26.753 0-36.328z"]},J7={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"]};function e9(e){return(e9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function t9(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n9(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){t9(e,t,n[t])})}return e}function r9(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){i=!0,a=u}finally{try{!r&&null!=s.return&&s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i9={},a9={};try{"undefined"!=typeof window&&(i9=window),"undefined"!=typeof document&&(a9=document),"undefined"!=typeof MutationObserver&&MutationObserver,"undefined"!=typeof performance&&performance}catch(Jye){}var o9=(i9.navigator||{}).userAgent,s9=void 0===o9?"":o9,u9=i9,c9=a9,l9=!!c9.documentElement&&!!c9.head&&"function"==typeof c9.addEventListener&&"function"==typeof c9.createElement,f9=(~s9.indexOf("MSIE")||s9.indexOf("Trident/"),"___FONT_AWESOME___"),h9="svg-inline--fa",d9=[1,2,3,4,5,6,7,8,9,10],v9=d9.concat([11,12,13,14,15,16,17,18,19,20]),p9={GROUP:"group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},g9=(["xs","sm","lg","fw","ul","li","border","pull-left","pull-right","spin","pulse","rotate-90","rotate-180","rotate-270","flip-horizontal","flip-vertical","flip-both","stack","stack-1x","stack-2x","inverse","layers","layers-text","layers-counter",p9.GROUP,p9.SWAP_OPACITY,p9.PRIMARY,p9.SECONDARY].concat(d9.map(function(e){return"".concat(e,"x")})).concat(v9.map(function(e){return"w-".concat(e)})),u9.FontAwesomeConfig||{});c9&&"function"==typeof c9.querySelector&&[["data-family-prefix","familyPrefix"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(e){var t=r9(e,2),n=t[1],r=function(e){return""===e||"false"!==e&&("true"===e||e)}(function(e){var t=c9.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}(t[0]));null!=r&&(g9[n]=r)});var y9=n9({},{familyPrefix:"fa",replacementClass:h9,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},g9);y9.autoReplaceSvg||(y9.observeMutations=!1);var m9=n9({},y9);u9.FontAwesomeConfig=m9;var k9=u9||{};k9[f9]||(k9[f9]={}),k9[f9].styles||(k9[f9].styles={}),k9[f9].hooks||(k9[f9].hooks={}),k9[f9].shims||(k9[f9].shims=[]);var C9=k9[f9],w9=[];l9&&((c9.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(c9.readyState)||c9.addEventListener("DOMContentLoaded",function e(){c9.removeEventListener("DOMContentLoaded",e),w9.map(function(e){return e()})}));var _9,E9="pending",b9="fulfilled",P9="rejected",S9=function(){},O9="undefined"!=typeof global&&void 0!==global.process&&"function"==typeof global.process.emit,T9="undefined"==typeof setImmediate?setTimeout:setImmediate,I9=[];function A9(){for(var e=0;e<I9.length;e++)I9[e][0](I9[e][1]);I9=[],_9=!1}function R9(e,t){I9.push([e,t]),_9||(_9=!0,T9(A9,0))}function M9(e){var t=e.owner,n=t._state,r=t._data,i=e[n],a=e.then;if("function"==typeof i){n=b9;try{r=i(r)}catch(o){L9(a,o)}}x9(a,r)||(n===b9&&N9(a,r),n===P9&&L9(a,r))}function x9(e,t){var n;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"===e9(t))){var r=t.then;if("function"==typeof r)return r.call(t,function(r){n||(n=!0,t===r?D9(e,r):N9(e,r))},function(t){n||(n=!0,L9(e,t))}),!0}}catch(i){return n||L9(e,i),!0}return!1}function N9(e,t){(e===t||!x9(e,t))&&D9(e,t)}function D9(e,t){e._state===E9&&(e._state="settled",e._data=t,R9(U9,e))}function L9(e,t){e._state===E9&&(e._state="settled",e._data=t,R9(V9,e))}function F9(e){e._then=e._then.forEach(M9)}function U9(e){e._state=b9,F9(e)}function V9(e){e._state=P9,F9(e),!e._handled&&O9&&global.process.emit("unhandledRejection",e._data,e)}function B9(e){global.process.emit("rejectionHandled",e)}function z9(e){if("function"!=typeof e)throw new TypeError("Promise resolver "+e+" is not a function");if(!(this instanceof z9))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(e,t){function n(e){L9(t,e)}try{e(function(e){N9(t,e)},n)}catch(r){n(r)}}(e,this)}z9.prototype={constructor:z9,_state:E9,_then:null,_data:void 0,_handled:!1,then:function(e,t){var n={owner:this,then:new this.constructor(S9),fulfilled:e,rejected:t};return(t||e)&&!this._handled&&(this._handled=!0,this._state===P9&&O9&&R9(B9,this)),this._state===b9||this._state===P9?R9(M9,n):this._then.push(n),n.then},catch:function(e){return this.then(null,e)}},z9.all=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.all().");return new z9(function(t,n){var r=[],i=0;function a(e){return i++,function(n){r[e]=n,--i||t(r)}}for(var o,s=0;s<e.length;s++)(o=e[s])&&"function"==typeof o.then?o.then(a(s),n):r[s]=o;i||t(r)})},z9.race=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.race().");return new z9(function(t,n){for(var r,i=0;i<e.length;i++)(r=e[i])&&"function"==typeof r.then?r.then(t,n):t(r)})},z9.resolve=function(e){return e&&"object"===e9(e)&&e.constructor===z9?e:new z9(function(t){t(e)})},z9.reject=function(e){return new z9(function(t,n){n(e)})};var H9={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function G9(){for(var e=12,t="";e-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function $9(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Z9(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,": ").concat(e[n],";")},"")}function q9(e){return e.size!==H9.size||e.x!==H9.x||e.y!==H9.y||e.rotate!==H9.rotate||e.flipX||e.flipY}function W9(e){var t=e.transform,n=e.iconWidth,r={transform:"translate(".concat(e.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),a="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),o="rotate(".concat(t.rotate," 0 0)");return{outer:r,inner:{transform:"".concat(i," ").concat(a," ").concat(o)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}var j9={x:0,y:0,width:"100%",height:"100%"};function Y9(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}function K9(e){return"g"===e.tag?e.children:[e]}function Q9(e){var t=e.icons,n=t.main,r=t.mask,i=e.prefix,a=e.iconName,o=e.transform,s=e.symbol,u=e.title,c=e.maskId,l=e.titleId,f=e.extra,h=e.watchable,d=void 0!==h&&h,v=r.found?r:n,p=v.width,g=v.height,y="fak"===i,m=y?"":"fa-w-".concat(Math.ceil(p/g*16)),k=[m9.replacementClass,a?"".concat(m9.familyPrefix,"-").concat(a):"",m].filter(function(e){return-1===f.classes.indexOf(e)}).filter(function(e){return""!==e||!!e}).concat(f.classes).join(" "),C={children:[],attributes:n9({},f.attributes,{"data-prefix":i,"data-icon":a,class:k,role:f.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(p," ").concat(g)})},w=y&&!~f.classes.indexOf("fa-fw")?{width:"".concat(p/g*16*.0625,"em")}:{};d&&(C.attributes["data-fa-i2svg"]=""),u&&C.children.push({tag:"title",attributes:{id:C.attributes["aria-labelledby"]||"title-".concat(l||G9())},children:[u]});var _=n9({},C,{prefix:i,iconName:a,main:n,mask:r,maskId:c,transform:o,symbol:s,styles:n9({},w,f.styles)}),E=r.found&&n.found?function(e){var t=e.children,n=e.attributes,r=e.main,i=e.mask,a=e.maskId,o=r.icon,s=i.icon,u=W9({transform:e.transform,containerWidth:i.width,iconWidth:r.width}),c={tag:"rect",attributes:n9({},j9,{fill:"white"})},l=o.children?{children:o.children.map(Y9)}:{},f={tag:"g",attributes:n9({},u.inner),children:[Y9(n9({tag:o.tag,attributes:n9({},o.attributes,u.path)},l))]},h={tag:"g",attributes:n9({},u.outer),children:[f]},d="mask-".concat(a||G9()),v="clip-".concat(a||G9()),p={tag:"mask",attributes:n9({},j9,{id:d,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[c,h]},g={tag:"defs",children:[{tag:"clipPath",attributes:{id:v},children:K9(s)},p]};return t.push(g,{tag:"rect",attributes:n9({fill:"currentColor","clip-path":"url(#".concat(v,")"),mask:"url(#".concat(d,")")},j9)}),{children:t,attributes:n}}(_):function(e){var t=e.children,n=e.attributes,r=e.main,i=e.transform,a=Z9(e.styles);if(a.length>0&&(n.style=a),q9(i)){var o=W9({transform:i,containerWidth:r.width,iconWidth:r.width});t.push({tag:"g",attributes:n9({},o.outer),children:[{tag:"g",attributes:n9({},o.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:n9({},r.icon.attributes,o.path)}]}]})}else t.push(r.icon);return{children:t,attributes:n}}(_),b=E.attributes;return _.children=E.children,_.attributes=b,s?function(e){var t=e.iconName,n=e.children,r=e.symbol;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:n9({},e.attributes,{id:!0===r?"".concat(e.prefix,"-").concat(m9.familyPrefix,"-").concat(t):r}),children:n}]}]}(_):function(e){var t=e.children,n=e.main,r=e.mask,i=e.attributes,a=e.styles,o=e.transform;if(q9(o)&&n.found&&!r.found){var s={x:n.width/n.height/2,y:.5};i.style=Z9(n9({},a,{"transform-origin":"".concat(s.x+o.x/16,"em ").concat(s.y+o.y/16,"em")}))}return[{tag:"svg",attributes:i,children:t}]}(_)}var X9=function(e,t,n,r){var i,a,o,s=Object.keys(e),u=s.length,c=void 0!==r?function(e,t){return function(n,r,i,a){return e.call(t,n,r,i,a)}}(t,r):t;for(void 0===n?(i=1,o=e[s[0]]):(i=0,o=n);i<u;i++)o=c(o,e[a=s[i]],a,e);return o};function J9(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.skipHooks,i=void 0!==r&&r,a=Object.keys(t).reduce(function(e,n){var r=t[n];return r.icon?e[r.iconName]=r.icon:e[n]=r,e},{});"function"!=typeof C9.hooks.addPack||i?C9.styles[e]=n9({},C9.styles[e]||{},a):C9.hooks.addPack(e,a),"fas"===e&&J9("fa",t)}var eee=C9.styles,tee=C9.shims,nee=function(){var e=function(e){return X9(eee,function(t,n,r){return t[r]=X9(n,e,{}),t},{})};e(function(e,t,n){return t[3]&&(e[t[3]]=n),e}),e(function(e,t,n){var r=t[2];return e[n]=n,r.forEach(function(t){e[t]=n}),e});var t="far"in eee;X9(tee,function(e,n){var r=n[1];return"far"===r&&!t&&(r="fas"),e[n[0]]={prefix:r,iconName:n[2]},e},{})};function ree(e,t,n){if(e&&e[t]&&e[t][n])return{prefix:t,iconName:n,icon:e[t][n]}}function iee(e){var t=e.tag,n=e.attributes,r=void 0===n?{}:n,i=e.children,a=void 0===i?[]:i;return"string"==typeof e?$9(e):"<".concat(t," ").concat(function(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,'="').concat($9(e[n]),'" ')},"").trim()}(r),">").concat(a.map(iee).join(""),"</").concat(t,">")}function aee(e){this.name="MissingIcon",this.message=e||"Icon unavailable",this.stack=(new Error).stack}nee(),(aee.prototype=Object.create(Error.prototype)).constructor=aee;var oee={fill:"currentColor"},see={attributeType:"XML",repeatCount:"indefinite",dur:"2s"},uee=(n9({},oee,{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"}),n9({},see,{attributeName:"opacity"}));function cee(e){var t=e[0],n=e[1],r=r9(e.slice(4),1)[0];return{found:!0,width:t,height:n,icon:Array.isArray(r)?{tag:"g",attributes:{class:"".concat(m9.familyPrefix,"-").concat(p9.GROUP)},children:[{tag:"path",attributes:{class:"".concat(m9.familyPrefix,"-").concat(p9.SECONDARY),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(m9.familyPrefix,"-").concat(p9.PRIMARY),fill:"currentColor",d:r[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:r}}}}n9({},oee,{cx:"256",cy:"364",r:"28"}),n9({},see,{attributeName:"r",values:"28;14;28;28;14;28;"}),n9({},uee,{values:"1;0;1;1;0;1;"}),n9({},oee,{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),n9({},uee,{values:"1;0;0;0;0;1;"}),n9({},oee,{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),n9({},uee,{values:"0;0;1;1;0;0;"});var lee=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.definitions={}}return function(e,t,n){t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t)}(e,[{key:"add",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.reduce(this._pullDefinitions,{});Object.keys(i).forEach(function(t){e.definitions[t]=n9({},e.definitions[t]||{},i[t]),J9(t,i[t]),nee()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,t){var n=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(n).map(function(t){var r=n[t],i=r.prefix,a=r.iconName,o=r.icon;e[i]||(e[i]={}),e[i][a]=o}),e}}]),e}();function fee(){m9.autoAddCss&&!pee&&(function(e){if(e&&l9){var t=c9.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;for(var n=c9.head.childNodes,r=null,i=n.length-1;i>-1;i--){var a=n[i],o=(a.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=a)}c9.head.insertBefore(t,r)}}(function(){var e="fa",t=h9,n=m9.familyPrefix,r=m9.replacementClass,i='svg:not(:root).svg-inline--fa {\n  overflow: visible;\n}\n\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.225em;\n}\n.svg-inline--fa.fa-w-1 {\n  width: 0.0625em;\n}\n.svg-inline--fa.fa-w-2 {\n  width: 0.125em;\n}\n.svg-inline--fa.fa-w-3 {\n  width: 0.1875em;\n}\n.svg-inline--fa.fa-w-4 {\n  width: 0.25em;\n}\n.svg-inline--fa.fa-w-5 {\n  width: 0.3125em;\n}\n.svg-inline--fa.fa-w-6 {\n  width: 0.375em;\n}\n.svg-inline--fa.fa-w-7 {\n  width: 0.4375em;\n}\n.svg-inline--fa.fa-w-8 {\n  width: 0.5em;\n}\n.svg-inline--fa.fa-w-9 {\n  width: 0.5625em;\n}\n.svg-inline--fa.fa-w-10 {\n  width: 0.625em;\n}\n.svg-inline--fa.fa-w-11 {\n  width: 0.6875em;\n}\n.svg-inline--fa.fa-w-12 {\n  width: 0.75em;\n}\n.svg-inline--fa.fa-w-13 {\n  width: 0.8125em;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-15 {\n  width: 0.9375em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-w-17 {\n  width: 1.0625em;\n}\n.svg-inline--fa.fa-w-18 {\n  width: 1.125em;\n}\n.svg-inline--fa.fa-w-19 {\n  width: 1.1875em;\n}\n.svg-inline--fa.fa-w-20 {\n  width: 1.25em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-border {\n  height: 1.5em;\n}\n.svg-inline--fa.fa-li {\n  width: 2em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: #ff253a;\n  border-radius: 1em;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  color: #fff;\n  height: 1.5em;\n  line-height: 1;\n  max-width: 5em;\n  min-width: 1.5em;\n  overflow: hidden;\n  padding: 0.25em;\n  right: 0;\n  text-overflow: ellipsis;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: 0;\n  right: 0;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: 0;\n  left: 0;\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  right: 0;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: 0;\n  right: auto;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-lg {\n  font-size: 1.3333333333em;\n  line-height: 0.75em;\n  vertical-align: -0.0667em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: 2.5em;\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: -2em;\n  position: absolute;\n  text-align: center;\n  width: 2em;\n  line-height: inherit;\n}\n\n.fa-border {\n  border: solid 0.08em #eee;\n  border-radius: 0.1em;\n  padding: 0.2em 0.25em 0.15em;\n}\n\n.fa-pull-left {\n  float: left;\n}\n\n.fa-pull-right {\n  float: right;\n}\n\n.fa.fa-pull-left,\n.fas.fa-pull-left,\n.far.fa-pull-left,\n.fal.fa-pull-left,\n.fab.fa-pull-left {\n  margin-right: 0.3em;\n}\n.fa.fa-pull-right,\n.fas.fa-pull-right,\n.far.fa-pull-right,\n.fal.fa-pull-right,\n.fab.fa-pull-right {\n  margin-left: 0.3em;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n          animation: fa-spin 2s infinite linear;\n}\n\n.fa-pulse {\n  -webkit-animation: fa-spin 1s infinite steps(8);\n          animation: fa-spin 1s infinite steps(8);\n}\n\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n:root .fa-rotate-90,\n:root .fa-rotate-180,\n:root .fa-rotate-270,\n:root .fa-flip-horizontal,\n:root .fa-flip-vertical,\n:root .fa-flip-both {\n  -webkit-filter: none;\n          filter: none;\n}\n\n.fa-stack {\n  display: inline-block;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: #fff;\n}\n\n.sr-only {\n  border: 0;\n  clip: rect(0, 0, 0, 0);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n.sr-only-focusable:active, .sr-only-focusable:focus {\n  clip: auto;\n  height: auto;\n  margin: 0;\n  overflow: visible;\n  position: static;\n  width: auto;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse {\n  color: #fff;\n}';if(n!==e||r!==t){var a=new RegExp("\\.".concat(e,"\\-"),"g"),o=new RegExp("\\--".concat(e,"\\-"),"g"),s=new RegExp("\\.".concat(t),"g");i=i.replace(a,".".concat(n,"-")).replace(o,"--".concat(n,"-")).replace(s,".".concat(r))}return i}()),pee=!0)}function hee(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map(function(e){return iee(e)})}}),Object.defineProperty(e,"node",{get:function(){if(l9){var t=c9.createElement("div");return t.innerHTML=e.html,t.children}}}),e}function dee(e){var t=e.prefix,n=void 0===t?"fa":t,r=e.iconName;if(r)return ree(vee.definitions,n,r)||ree(C9.styles,n,r)}var vee=new lee,pee=!1,gee=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:dee(t||{}),i=n.mask;return i&&(i=(i||{}).icon?i:dee(i||{})),e(r,n9({},n,{mask:i}))}}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,r=void 0===n?H9:n,i=t.symbol,a=void 0!==i&&i,o=t.mask,s=void 0===o?null:o,u=t.maskId,c=void 0===u?null:u,l=t.title,f=void 0===l?null:l,h=t.titleId,d=void 0===h?null:h,v=t.classes,p=void 0===v?[]:v,g=t.attributes,y=void 0===g?{}:g,m=t.styles,k=void 0===m?{}:m;if(e){var C=e.prefix,w=e.iconName,_=e.icon;return hee(n9({type:"icon"},e),function(){return fee(),m9.autoA11y&&(f?y["aria-labelledby"]="".concat(m9.replacementClass,"-title-").concat(d||G9()):(y["aria-hidden"]="true",y.focusable="false")),Q9({icons:{main:cee(_),mask:s?cee(s.icon):{found:!1,width:null,height:null,icon:{}}},prefix:C,iconName:w,transform:n9({},H9,r),symbol:a,title:f,maskId:c,titleId:d,extra:{attributes:y,styles:k,classes:p}})})}}),yee=["*"],mee=function(e){var t,n=(Pg(t={"fa-spin":e.spin,"fa-pulse":e.pulse,"fa-fw":e.fixedWidth,"fa-border":e.border,"fa-inverse":e.inverse,"fa-layers-counter":e.counter,"fa-flip-horizontal":"horizontal"===e.flip||"both"===e.flip,"fa-flip-vertical":"vertical"===e.flip||"both"===e.flip},"fa-".concat(e.size),null!==e.size),Pg(t,"fa-rotate-".concat(e.rotate),null!==e.rotate),Pg(t,"fa-pull-".concat(e.pull),null!==e.pull),Pg(t,"fa-stack-".concat(e.stackItemSize),null!=e.stackItemSize),t);return Object.keys(n).map(function(e){return n[e]?e:null}).filter(function(e){return e})},kee=function(){var e=Wg(function e(){Zg(this,e),this.defaultPrefix="fas",this.fallbackIcon=null});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Cee=function(){var e=function(){function e(){Zg(this,e),this.definitions={}}return Wg(e,[{key:"addIcons",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var a=i[r];a.prefix in this.definitions||(this.definitions[a.prefix]={}),this.definitions[a.prefix][a.iconName]=a;var o,s=Hg(a.icon[2]);try{for(s.s();!(o=s.n()).done;){var u=o.value;"string"==typeof u&&(this.definitions[a.prefix][u]=a)}}catch(c){s.e(c)}finally{s.f()}}}},{key:"addIconPacks",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=function(){var t=o[a],n=Object.keys(t).map(function(e){return t[e]});e.addIcons.apply(e,Bg(n))},a=0,o=n;a<o.length;a++)i()}},{key:"getIconDefinition",value:function(e,t){return e in this.definitions&&t in this.definitions[e]?this.definitions[e][t]:null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),wee=function(){var e=function(){function e(){Zg(this,e),this.stackItemSize="1x"}return Wg(e,[{key:"ngOnChanges",value:function(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ym({type:e,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[uk]}),e}(),_ee=function(){var e=function(){function e(t,n){Zg(this,e),this.renderer=t,this.elementRef=n}return Wg(e,[{key:"ngOnInit",value:function(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}},{key:"ngOnChanges",value:function(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,"fa-".concat(e.size.currentValue)),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,"fa-".concat(e.size.previousValue)))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(fO),Qb(uO))},e.\u0275cmp=Gm({type:e,selectors:[["fa-stack"]],inputs:{size:"size"},features:[uk],ngContentSelectors:yee,decls:1,vars:0,template:function(e,t){1&e&&(function(e){var t=Mk()[16][6];if(!t.projection)for(var n=t.projection=nw(1,null),r=n.slice(),i=t.child;null!==i;){r[0]?r[0].projectionNext=i:n[0]=i,r[0]=i,i=i.next}}(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=Mk(),i=xk(),a=PE(i,20+e,16,null,n||null);null===a.projection&&(a.projection=t),Bk(),64!=(64&a.flags)&&function(e,t,n){eE(t[11],0,t,n,L_(e,n,t),H_(n.parent||t[6],n,t))}(i,r,a)}(0))},encapsulation:2}),e}(),Eee=function(){var e=function(){function e(t,n,r,i,a){Zg(this,e),this.sanitizer=t,this.config=n,this.iconLibrary=r,this.stackItem=i,this.classes=[],null!=a&&null==i&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}return Wg(e,[{key:"ngOnChanges",value:function(e){var t;if(null==this.icon&&null==this.config.fallbackIcon)return function(){throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")}();var n;if(n=null!==(t=this.icon)&&void 0!==t?t:this.config.fallbackIcon,e){var r=this.findIconDefinition(n);if(null!=r){var i=this.buildParams();this.renderIcon(r,i)}}}},{key:"render",value:function(){this.ngOnChanges({})}},{key:"findIconDefinition",value:function(e){var t,n,r,i,a=(n=e,r=this.config.defaultPrefix,void 0!==(i=n).prefix&&void 0!==i.iconName?n:Array.isArray(n)&&2===n.length?{prefix:n[0],iconName:n[1]}:"string"==typeof n?{prefix:r,iconName:n}:void 0);return"icon"in a?a:null!==(t=this.iconLibrary.getIconDefinition(a.prefix,a.iconName))&&void 0!==t?t:(function(e){throw new Error("Could not find icon with iconName=".concat(e.iconName," and prefix=").concat(e.prefix," in the icon library."))}(a),null)}},{key:"buildParams",value:function(){var e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},t="string"==typeof this.transform?function(e){var t={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e?e.toLowerCase().split(" ").reduce(function(e,t){var n=t.toLowerCase().split("-"),r=n[0],i=n.slice(1).join("-");if(r&&"h"===i)return e.flipX=!0,e;if(r&&"v"===i)return e.flipY=!0,e;if(i=parseFloat(i),isNaN(i))return e;switch(r){case"grow":e.size=e.size+i;break;case"shrink":e.size=e.size-i;break;case"left":e.x=e.x-i;break;case"right":e.x=e.x+i;break;case"up":e.y=e.y-i;break;case"down":e.y=e.y+i;break;case"rotate":e.rotate=e.rotate+i}return e},t):t}(this.transform):this.transform;return{title:this.title,transform:t,classes:[].concat(Bg(mee(e)),Bg(this.classes)),mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}},{key:"renderIcon",value:function(e,t){var n=gee(e,t);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(n.html.join("\n"))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(CR),Qb(kee),Qb(Cee),Qb(wee,8),Qb(_ee,8))},e.\u0275cmp=Gm({type:e,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,t){2&e&&(HP("innerHTML",t.renderedIconHTML,s_),$b("title",t.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[uk],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),bee=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e}),e.\u0275inj=vm({}),e}();function Pee(e,t){if(1&e&&(rP(0),nP(1,"fa-icon",24),iP()),2&e){var n=fP();pE(1),Xb("icon",n.faSpinner)}}function See(e,t){if(1&e){var n=aP();rP(0),eP(1,"div",9),eP(2,"a",10),FP(3),tP(),eP(4,"div",12),eP(5,"a",26),uP("click",function(){return Nk(n),fP(2).logout()}),ZS(6,27),tP(),tP(),tP(),iP()}if(2&e){var r=fP(2);pE(3),UP(r.username.get())}}var Oee=function(){return["/register"]},Tee=function(){return["/login"]};function Iee(e,t){1&e&&(eP(0,"div",28),eP(1,"a",29),eP(2,"strong"),ZS(3,30),tP(),tP(),eP(4,"a",31),ZS(5,32),tP(),tP()),2&e&&(pE(1),Xb("routerLink",aT(2,Oee)),pE(3),Xb("routerLink",aT(3,Tee)))}function Aee(e,t){if(1&e&&(Yb(0,See,7,1,"ng-container",22),Yb(1,Iee,6,4,"ng-template",null,25,MT)),2&e){var n=Kb(2);Xb("ngIf",fP().username.isPresent())("ngIfElse",n)}}var Ree=function(){return["/"]},Mee=function(){return["/play"]},xee=function(){return["/lobby"]},Nee=function(){return["/local"]},Dee=function(){return["/tutorial"]},Lee=function(){return["/settings"]},Fee=function(){var e=function(){function e(t,n,r){Zg(this,e),this.router=t,this.connectedUserService=n,this.userService=r,this.loading=!0,this.username=fB.empty(),this.faCog=j7,this.faSpinner=J7,this.showMenu=!1}return Wg(e,[{key:"ngOnInit",value:function(){var e=this;this.userSub=this.connectedUserService.subscribeToUser(function(t){e.loading=!1,e.username=t.username.isPresent()?t.username:t.email})}},{key:"logout",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connectedUserService.disconnect();case 2:return t.next=4,e.router.navigate(["/"]);case 4:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(jL),Qb(C7),Qb(g7))},e.\u0275cmp=Gm({type:e,selectors:[["app-header"]],decls:35,vars:19,consts:function(){return[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],$localize(p||(p=_g(["Home"]))),[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],$localize(g||(g=_g(["Play online"]))),[1,"navbar-dropdown"],$localize(y||(y=_g(["Create a game"]))),$localize(m||(m=_g(["Join a game"]))),$localize(k||(k=_g(["Play offline"]))),$localize(C||(C=_g(["Create a game"]))),$localize(w||(w=_g(["Learn the rules"]))),[1,"navbar-end"],["data-tooltip",$localize(_||(_=_g(["Settings"]))),1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","logout",1,"navbar-item",3,"click"],$localize(E||(E=_g(["Log out"]))),[1,"buttons"],[1,"button","is-primary",3,"routerLink"],$localize(b||(b=_g(["Register"]))),[1,"button","is-light",3,"routerLink"],$localize(P||(P=_g(["Log in"])))]},template:function(e,t){if(1&e&&(eP(0,"nav",0),eP(1,"div",1),eP(2,"a",2),nP(3,"img",3),tP(),eP(4,"a",4),uP("click",function(){return t.showMenu=!t.showMenu}),nP(5,"span",5),nP(6,"span",5),nP(7,"span",5),tP(),tP(),eP(8,"div",6),uP("click",function(){return t.showMenu=!t.showMenu}),eP(9,"div",7),eP(10,"a",2),ZS(11,8),tP(),eP(12,"div",9),eP(13,"a",10),ZS(14,11),tP(),eP(15,"div",12),eP(16,"a",2),ZS(17,13),tP(),eP(18,"a",2),ZS(19,14),tP(),tP(),tP(),eP(20,"div",9),eP(21,"a",10),ZS(22,15),tP(),eP(23,"div",12),eP(24,"a",2),ZS(25,16),tP(),eP(26,"a",2),ZS(27,17),tP(),tP(),tP(),tP(),eP(28,"div",18),eP(29,"a",19),nP(30,"fa-icon",20),tP(),eP(31,"div",21),Yb(32,Pee,2,1,"ng-container",22),Yb(33,Aee,3,2,"ng-template",null,23,MT),tP(),tP(),tP(),tP()),2&e){var n=Kb(34);pE(2),Xb("routerLink",aT(12,Ree)),pE(2),Xb("ngClass",t.showMenu?"is-active":""),pE(4),Xb("ngClass",t.showMenu?"is-active":""),pE(2),Xb("routerLink",aT(13,Ree)),pE(6),Xb("routerLink",aT(14,Mee)),pE(2),Xb("routerLink",aT(15,xee)),pE(6),Xb("routerLink",aT(16,Nee)),pE(2),Xb("routerLink",aT(17,Dee)),pE(3),Xb("routerLink",aT(18,Lee)),pE(1),Xb("icon",t.faCog),pE(2),Xb("ngIf",t.loading)("ngIfElse",n)}},directives:[QL,NA,Eee,UA],encapsulation:2}),e}(),Uee=function(){var e=Wg(function e(t,n){Zg(this,e),this._themeService=t,this._errorLoggerService=n,this.faTwitter=G7,this.faFacebook=z7,this.faGithub=H7});return e.\u0275fac=function(t){return new(t||e)(Qb(q7),Qb(d7))},e.\u0275cmp=Gm({type:e,selectors:[["app-root"]],decls:18,vars:3,consts:function(){return[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],$localize(S||(S=_g(["If you like ",":START_TAG_STRONG:EveryBoard",":CLOSE_TAG_STRONG:, follow us!"])),"\ufffd#8\ufffd","\ufffd/#8\ufffd"),["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoard"],["href","https://facebook.com/EveryBoard"]]},template:function(e,t){1&e&&(nP(0,"app-header"),eP(1,"main",0),nP(2,"router-outlet"),tP(),eP(3,"footer",1),eP(4,"div",2),eP(5,"p"),eP(6,"span"),GS(7,3),nP(8,"strong"),$S(),tP(),FP(9," \xa0 "),eP(10,"a",4),nP(11,"fa-icon",5),tP(),FP(12,"\xa0 "),eP(13,"a",6),nP(14,"fa-icon",5),tP(),FP(15,"\xa0 "),eP(16,"a",7),nP(17,"fa-icon",5),tP(),tP(),tP(),tP()),2&e&&(pE(11),Xb("icon",t.faGithub),pE(3),Xb("icon",t.faTwitter),pE(3),Xb("icon",t.faFacebook))},directives:[Fee,JL,Eee],encapsulation:2}),e}(),Vee=function(){function e(t,n){Zg(this,e),this.x=t,this.y=n}return Wg(e,[{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}}]),e}(),Bee=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isDown",value:function(){return 1===this.y}},{key:"isUp",value:function(){return-1===this.y}},{key:"isLeft",value:function(){return-1===this.x}},{key:"isRight",value:function(){return 1===this.x}},{key:"toInt",value:function(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}},{key:"toString",value:function(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}]),n}(Vee),zee=function(){function e(){Zg(this,e)}return Wg(e,[{key:"of",value:function(e,t){var n,r=Hg(this.all);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.x===e&&i.y===t)return hB.success(i)}}catch(a){r.e(a)}finally{r.f()}return hB.failure("Invalid x and y in direction construction")}},{key:"fromDelta",value:function(e,t){return 0===e&&0===t?hB.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.of(Math.sign(e),Math.sign(t)):hB.failure($ee.DIRECTION_MUST_BE_LINEAR())}},{key:"fromMove",value:function(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}},{key:"fromString",value:function(e){switch(e){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return hB.failure("Invalid direction string ".concat(e))}}},{key:"fromInt",value:function(e){switch(e){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return hB.failure("Invalid int direction: ".concat(e))}}}]),e}(),Hee=function(e){xg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,r)}return Wg(n,[{key:"isDiagonal",value:function(){return 0!==this.x&&0!==this.y}},{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}(Bee);Hee.UP=new Hee(0,-1),Hee.UP_RIGHT=new Hee(1,-1),Hee.RIGHT=new Hee(1,0),Hee.DOWN_RIGHT=new Hee(1,1),Hee.DOWN=new Hee(0,1),Hee.DOWN_LEFT=new Hee(-1,1),Hee.LEFT=new Hee(-1,0),Hee.UP_LEFT=new Hee(-1,-1),Hee.factory=new(function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).all=[Hee.UP,Hee.UP_RIGHT,Hee.RIGHT,Hee.DOWN_RIGHT,Hee.DOWN,Hee.DOWN_LEFT,Hee.LEFT,Hee.UP_LEFT],e}return Wg(n)}(zee)),Hee.DIRECTIONS=Hee.factory.all,Hee.DIAGONALS=[Hee.UP_RIGHT,Hee.DOWN_RIGHT,Hee.DOWN_LEFT,Hee.UP_LEFT],Hee.ORTHOGONALS=[Hee.UP,Hee.RIGHT,Hee.DOWN,Hee.LEFT],Hee.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return v7("string"==typeof e,"Invalid encoded direction"),Hee.factory.fromString(e).get()}}]),n}(S7));var Gee=function(e){xg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,r)}return Wg(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}(Bee);Gee.UP=new Gee(0,-1),Gee.RIGHT=new Gee(1,0),Gee.DOWN=new Gee(0,1),Gee.LEFT=new Gee(-1,0),Gee.factory=new(function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).all=[Gee.UP,Gee.RIGHT,Gee.DOWN,Gee.LEFT],e}return Wg(n,[{key:"of",value:function(e,t){return 0===e&&-1===t?hB.success(Gee.UP):1===e&&0===t?hB.success(Gee.RIGHT):0===e&&1===t?hB.success(Gee.DOWN):-1===e&&0===t?hB.success(Gee.LEFT):hB.failure("Invalid orthogonal from x and y")}}]),n}(zee)),Gee.ORTHOGONALS=Gee.factory.all,Gee.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return v7("string"==typeof e,"Invalid encoded orthogonal"),Gee.factory.fromString(e).get()}}]),n}(S7));var $ee=function(){var e=Wg(function e(){Zg(this,e)});return e.DIRECTION_MUST_BE_LINEAR=function(){return $localize(O||(O=_g(["You must move in a straight line! You can only move orthogonally or diagonally!"])))},e}(),Zee=function(){function e(t,n){Zg(this,e),this.x=t,this.y=n}return Wg(e,[{key:"getNext",value:function(t,n){var r;return new e(this.x+(n=null!==(r=n)&&void 0!==r?r:1)*t.x,this.y+n*t.y)}},{key:"getPrevious",value:function(e,t){var n;return this.getNext(e,-(t=null!==(n=t)&&void 0!==n?n:1))}},{key:"getLeft",value:function(t){return new e(this.x+t.y,this.y+-t.x)}},{key:"getRight",value:function(t){return new e(this.x+-t.y,this.y+t.x)}},{key:"getOpposite",value:function(){return new e(-this.x,-this.y)}},{key:"isInRange",value:function(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}},{key:"isNotInRange",value:function(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}},{key:"getDirectionToward",value:function(e){return Hee.factory.fromMove(this,e)}},{key:"getOrthogonalDistance",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"getDistance",value:function(e){if(!e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");var t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}},{key:"isHexagonallyAlignedWith",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}},{key:"isAlignedWith",value:function(e){var t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}},{key:"getVectorToward",value:function(t){return new e(t.x-this.x,t.y-this.y)}},{key:"getMinimalVectorToward",value:function(e){return this.getVectorToward(e).toVector()}},{key:"getCoordsToward",value:function(e){if(e.equals(this))return[];if(!e.isAlignedWith(this))return[];for(var t=this.getDirectionToward(e).get(),n=this.getNext(t,1),r=[];!1===n.equals(e);)r.push(n),n=n.getNext(t,1);return r}},{key:"toVector",value:function(){for(var t=Math.abs(this.x),n=Math.abs(this.y),r=Math.max(t,n),i=this.x,a=this.y,o=2;o<=r;)i%o==0&&a%o==0?(i/=o,a/=o):o++;return new e(i,a)}},{key:"isBetween",value:function(e,t){var n=e.getMinimalVectorToward(this),r=t.getMinimalVectorToward(this);return n.equals(r.getOpposite())}},{key:"getUntil",value:function(e){for(var t=[],n=this.getDirectionToward(e).get(),r=this.getNext(n);!1===r.equals(e);)t.push(r),r=r.getNext(n);return t}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y}},{key:"compareTo",value:function(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}}],[{key:"numberEncoder",value:function(t,n){return T7.tuple([T7.numberEncoder(t),T7.numberEncoder(n)],function(e){return[e.x,e.y]},function(t){return new e(t[0],t[1])})}}]),e}();Zee.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encode",value:function(e){return{x:e.x,y:e.y}}},{key:"decode",value:function(e){var t=e;return v7(null!=t.x&&"number"==typeof t.x&&null!=t.y&&"number"==typeof t.y,"Invalid encoded coord"),new Zee(t.x,t.y)}}]),n}(S7));var qee=function(){var e=function(){function e(t){Zg(this,e),this.messageDisplayer=t,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.scores=fB.empty(),this.imagesLocation="assets/images/"}return Wg(e,[{key:"message",value:function(e){this.messageDisplayer.gameMessage(e)}},{key:"cancelMove",value:function(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?pB.SUCCESS:(this.messageDisplayer.gameMessage(e),pB.failure(e))}},{key:"cancelMoveAttempt",value:function(){}},{key:"getPlayerClass",value:function(e){switch(e){case R7.ZERO:return"player0";case R7.ONE:return"player1";default:return oB.expectToBe(e,A7.NONE),""}}},{key:"pass",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",d7.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name}));case 1:case"end":return t.stop()}},t)}))()}},{key:"getTurn",value:function(){return this.rules.node.gameState.turn}},{key:"getCurrentPlayer",value:function(){return this.rules.node.gameState.getCurrentPlayer()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"range",value:function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,t){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Wee=function(){var e,t=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getHexaCoordsBy",value:function(e,t){var n=new Zee(e,t);return this.getHexaCoordsAt(n)}},{key:"getHexaCoordsAt",value:function(e){var t,n="",r=this.hexaLayout.getHexaCoordsAt(e),i=Hg(r);try{for(i.s();!(t=i.n()).done;){var a=t.value;n+=a.x+" "+a.y+" "}}catch(o){i.e(o)}finally{i.f()}return n+=r[0].x+" "+r[0].y}},{key:"getCenterBy",value:function(e,t){var n=new Zee(e,t);return this.getCenterAt(n)}},{key:"getCenterAt",value:function(e){return this.hexaLayout.getCenterAt(e)}}]),n}(qee);return t.\u0275fac=function(n){return(e||(e=$C(t)))(n||t)},t.\u0275cmp=Gm({type:t,selectors:[["ng-component"]],features:[Rb],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),jee=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,[{key:"equals",value:function(e){return this===e}},{key:"is",value:function(e){return this.value===e.value}},{key:"isPlayer",value:function(){return this===e.ZERO||this===e.ONE}}],[{key:"from",value:function(t){switch(t){case e.ZERO.value:return e.ZERO;case e.ONE.value:return e.ONE;case e.EMPTY.value:return e.EMPTY;case e.UNREACHABLE.value:return e.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+t)}}},{key:"ofPlayer",value:function(t){return t===R7.ZERO?e.ZERO:(oB.expectToBe(t,R7.ONE),e.ONE)}}]),e}();jee.ZERO=new jee(R7.ZERO.value),jee.ONE=new jee(R7.ONE.value),jee.EMPTY=new jee(A7.NONE.value),jee.UNREACHABLE=new jee(3);var Yee=function(e){xg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,r)}return Wg(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}],[{key:"getAngle",value:function(e){switch(e){case n.UP:return 0;case n.UP_RIGHT:return 60;case n.RIGHT:return 120;case n.DOWN:return 180;case n.DOWN_LEFT:return 240;default:return oB.expectToBe(e,n.LEFT),300}}}]),n}(Bee);Yee.UP=new Yee(0,-1),Yee.LEFT=new Yee(-1,0),Yee.UP_RIGHT=new Yee(1,-1),Yee.DOWN_LEFT=new Yee(-1,1),Yee.RIGHT=new Yee(1,0),Yee.DOWN=new Yee(0,1),Yee.factory=new(function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).all=[Yee.UP,Yee.UP_RIGHT,Yee.RIGHT,Yee.DOWN,Yee.DOWN_LEFT,Yee.LEFT],e}return Wg(n)}(zee)),Yee.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){switch(e){case Yee.UP:return 0;case Yee.UP_RIGHT:return 1;case Yee.RIGHT:return 2;case Yee.DOWN:return 3;case Yee.DOWN_LEFT:return 4;default:return 5}}},{key:"decodeNumber",value:function(e){return v7(0<=e&&e<=5,"Invalid encoded number for HexaDirection "+e),Yee.factory.all[e]}}]),n}(T7));var Kee=function(){function e(t,n,r){Zg(this,e),this.size=t,this.origin=n,this.orientation=r}return Wg(e,[{key:"getCenterAt",value:function(e){var t=this.orientation.conversionMatrix;return new Zee(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}},{key:"getCornerOffset",value:function(e){var t=2*Math.PI*(this.orientation.startAngle+e)/6;return new Zee(this.size*Math.cos(t),this.size*Math.sin(t))}},{key:"getHexaCoordsAt",value:function(e){for(var t=this.getCenterAt(e),n=[],r=0;r<6;r+=1){var i=this.getCornerOffset(r);n.push(new Zee(t.x+i.x,t.y+i.y))}return n}}]),e}(),Qee=Wg(function e(){Zg(this,e)}),Xee=function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.call(this)).startAngle=.5,e.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],e.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3],e}return Wg(n)}(Qee);Xee.INSTANCE=new Xee;var Jee=function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.call(this)).startAngle=0,e.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],e.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3],e}return Wg(n,[{key:"isOnBorder",value:function(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}},{key:"isOnTopRightBorder",value:function(e,t){return 0===t.y}},{key:"isOnRightBorder",value:function(e,t){return t.x===e.width-1}},{key:"isOnLeftBorder",value:function(e,t){return 0===t.x}},{key:"isOnBottomLeftBorder",value:function(e,t){return t.y===e.height-1}},{key:"isOnTopLeftBorder",value:function(e,t){return null!=e.excludedCases[t.y]?t.x===e.excludedCases[t.y]:t.y===e.excludedCases.length&&0===t.x}},{key:"isOnBottomRightBorder",value:function(e,t){return null!=e.excludedCases[e.height-1-t.y]?e.width-1-t.x===e.excludedCases[e.height-1-t.y]:e.height-1-t.y===e.excludedCases.length&&t.x===e.width-1}},{key:"getAllBorders",value:function(e){var t=this,n=[];return e.forEachCoord(function(r,i){t.isOnBorder(e,r)&&n.push(r)}),n}},{key:"isTopCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}},{key:"isTopLeftCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isTopRightCorner",value:function(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}},{key:"isBottomCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}},{key:"isBottomLeftCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isBottomRightCorner",value:function(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}]),n}(Qee);Jee.INSTANCE=new Jee;var ete=function(){var e=Wg(function e(){Zg(this,e)});return e.CANNOT_CHOOSE_OPPONENT_PIECE=function(){return $localize(T||(T=_g(["You cannot pick a piece of the opponent."])))},e.MUST_CLICK_ON_EMPTY_SPACE=function(){return $localize(I||(I=_g(["You must click on an empty space."])))},e.MUST_CLICK_ON_EMPTY_SQUARE=function(){return $localize(A||(A=_g(["You must click on an empty square."])))},e.CANNOT_SELF_CAPTURE=function(){return $localize(R||(R=_g(["Your landing space should be empty or contain a piece of the opponent."])))},e.MUST_CHOOSE_PLAYER_PIECE=function(){return $localize(M||(M=_g(["You must pick one of your pieces."])))},e.CANNOT_PASS=function(){return $localize(x||(x=_g(["You cannot pass your turn."])))},e.MUST_LAND_ON_EMPTY_SPACE=function(){return $localize(N||(N=_g(["You must drop your piece on an empty space."])))},e.MUST_PASS=function(){return $localize(D||(D=_g(["You must pass your turn."])))},e.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=function(){return $localize(L||(L=_g(["You have selected an empty space, you must select one of your own pieces."])))},e.MOVE_CANNOT_BE_STATIC=function(){return $localize(F||(F=_g(["You must choose different starting and ending coordinates."])))},e.SOMETHING_IN_THE_WAY=function(){return $localize(U||(U=_g(["There is a piece between the piece you chose and its landing space."])))},e}(),tte=function(){function e(t,n){Zg(this,e),this.ruler=t,this.name=n}return Wg(e,[{key:"toString",value:function(){return this.name}}]),e}(),nte=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,[{key:"toString",value:function(){return""+this.value}}],[{key:"fromWinner",value:function(t){return t.isPlayer()?new e(t.getVictoryValue()):new e(0)}}]),e}(),rte=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"toComparableObjectSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return t.equals(e)})||t.push(e)}),t}},{key:"toComparableSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return lB(t,e)})||t.push(e)}),t}}]),e}(),ite=function(e){function t(e){Zg(this,t),this.values=void 0===e?[]:rte.toComparableSet(e)}return Wg(t,[{key:"equals",value:function(e){if(e.size()!==this.size())return!1;var t,n=Hg(this);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===e.contains(r))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"toString",value:function(){var e,t="",n=Hg(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t+=null==r?"null, ":r.toString()+", "}}catch(i){n.e(i)}finally{n.f()}return"["+t.slice(0,-2)+"]"}},{key:"add",value:function(e){return!this.contains(e)&&(this.values.push(e),!0)}},{key:"union",value:function(e){var t,n=Hg(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"contains",value:function(e){var t,n=Hg(this.values);try{for(n.s();!(t=n.n()).done;){if(lB(t.value,e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"size",value:function(){return this.values.length}},{key:"toList",value:function(){var e,t=[],n=Hg(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"getAnyElement",value:function(){return this.size()>0?fB.of(this.values[0]):fB.empty()}},{key:Symbol.iterator,value:function(){return this.values.values()}}]),t}(),ate=function(){function e(t){Zg(this,e),this.turn=t}return Wg(e,[{key:"getCurrentPlayer",value:function(){return R7.fromTurn(this.turn)}},{key:"getCurrentOpponent",value:function(){return this.turn%2==1?R7.ZERO:R7.ONE}}]),e}(),ote=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,r)).board=e,i}return Wg(n,[{key:"getPieceAt",value:function(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}},{key:"tryToGetPieceAt",value:function(e){return this.isOnBoard(e)?fB.of(this.board[e.y][e.x]):fB.empty()}},{key:"isOnBoard",value:function(e){return e.isInRange(this.board[0].length,this.board.length)}},{key:"getPieceAtXY",value:function(e,t){return this.getPieceAt(new Zee(e,t))}},{key:"forEachCoord",value:function(e){var t,n=Hg(this.getCoordsAndContents());try{for(n.s();!(t=n.n()).done;){var r=Sg(t.value,2);e(r[0],r[1])}}catch(i){n.e(i)}finally{n.f()}}},{key:"getCoordsAndContents",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++){var r=new Zee(n,t);this.isOnBoard(r)&&e.push([r,this.getPieceAt(r)])}return e}},{key:"getCopiedBoard",value:function(){return D7.copyBiArray(this.board)}}]),n}(ate),ste=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isInBoard",value:function(e){return e.isInRange(9,9)&&this.getPieceAt(e)!==jee.UNREACHABLE}},{key:"isPiece",value:function(e){return this.getPieceAt(e).isPlayer()}},{key:"getScores",value:function(){for(var e=[14,14],t=0;t<9;t++)for(var n=0;n<9;n++)this.getPieceAtXY(n,t)===jee.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===jee.ONE&&(e[0]=e[0]-1);return e}}],[{key:"getInitialState",value:function(){var e=jee.EMPTY,t=jee.UNREACHABLE,r=jee.ZERO,i=jee.ONE;return new n([[t,t,t,t,i,i,i,i,i],[t,t,t,i,i,i,i,i,i],[t,t,e,e,i,i,i,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,r,r,r,e,e,t,t],[r,r,r,r,r,r,t,t,t],[r,r,r,r,r,t,t,t,t]],0)}}]),n}(ote),ute=Wg(function e(){Zg(this,e)}),cte=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).coord=new Zee(e,r),i}return Wg(n)}(ute),lte=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;if(Zg(this,n),(a=t.call(this,e.x,e.y)).dir=r,a.lastPiece=i,e.isNotInRange(9,9))throw new Error("Coord "+e.toString()+" out of range, invalid move!");return Lg(a)}return Wg(n,[{key:"toString",value:function(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}},{key:"isSingleCoord",value:function(){return this.lastPiece.isAbsent()}},{key:"equals",value:function(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}],[{key:"fromSingleCoord",value:function(e,t){try{return hB.success(new n(e,t,fB.empty()))}catch(r){return hB.failure(r.message)}}},{key:"fromDoubleCoord",value:function(e,t,r){var i=[e,t];D7.sortByDescending(i,n.sortCoord);var a=i[1].getDirectionToward(i[0]).get(),o=Yee.factory.fromDelta(a.x,a.y);if(o.isFailure())return hB.failure("Invalid direction");var s=o.get();return i[1].getDistance(i[0])>2?hB.failure("Distance between first coord and last coord is too great"):s.equals(r)?n.fromSingleCoord(i[1],r):s.getOpposite().equals(r)?n.fromSingleCoord(i[0],r):hB.success(new n(i[1],r,fB.of(i[0])))}},{key:"sortCoord",value:function(e){return 9*e.y+e.x}}]),n}(cte);lte.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 104831}},{key:"encodeNumber",value:function(e){var t=9*e.coord.x*8+8*e.coord.y+e.dir.toInt();if(e.isSingleCoord())return t;var n=e.lastPiece.get();return 9*n.x*2*9*9*8+2*n.y*9*9*8+648+t}},{key:"decodeNumber",value:function(e){var t=e%8;e=(e-t)/8;var n=Yee.factory.fromInt(t).get(),r=e%9,i=(e=(e-r)/9)%9;e=(e-i)/9;var a=new Zee(i,r);if(0===e)return lte.fromSingleCoord(a,n).get();var o=(e=(e-1)/2)%9,s=(e=(e-o)/9)%9;e=(e-s)/9;var u=new Zee(s,o);return lte.fromDoubleCoord(a,u,n).get()}}]),n}(T7));var fte=(function(e){e.VICTORY="VICTORY",e.PRE_VICTORY="PRE_VICTORY",e.DEFAULT="DEFAULT"}(fte||(fte={})),fte),hte=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Zg(this,e),this.map=t,this.isImmutable=n}return Wg(e,[{key:"makeImmutable",value:function(){this.isImmutable=!0}},{key:"get",value:function(e){var t,n=Hg(this.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(lB(r.key,e))return fB.of(r.value)}}catch(i){n.e(i)}finally{n.f()}return fB.empty()}},{key:"forEach",value:function(e){for(var t=0;t<this.map.length;t++)e(this.getByIndex(t))}},{key:"getByIndex",value:function(e){return this.map[e]}},{key:"putAll",value:function(e){this.checkImmutability("putAll");var t,n=Hg(e.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.put(r.key,r.value)}}catch(i){n.e(i)}finally{n.f()}}},{key:"checkImmutability",value:function(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}},{key:"put",value:function(e,t){this.checkImmutability("put");var n,r=Hg(this.map);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(lB(i.key,e)){var a=i.value;return i.value=t,fB.of(a)}}}catch(o){r.e(o)}finally{r.f()}return this.map.push({key:e,value:t}),fB.empty()}},{key:"containsKey",value:function(e){return this.map.some(function(t){return lB(t.key,e)})}},{key:"size",value:function(){return this.map.length}},{key:"listKeys",value:function(){return this.map.map(function(e){return e.key})}},{key:"getKeySet",value:function(){return new ite(this.listKeys())}},{key:"filter",value:function(t){var n,r=new e,i=Hg(this.map);try{for(i.s();!(n=i.n()).done;){var a=n.value;t(a.key,a.value)&&r.set(a.key,a.value)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"replace",value:function(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}},{key:"set",value:function(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}},{key:"delete",value:function(e){this.checkImmutability("delete");for(var t=0;t<this.map.length;t++)if(lB(this.map[t].key,e)){var n=this.map[t].value,r=this.map.slice(0,t),i=this.map.slice(t+1);return this.map=r.concat(i),n}throw new Error('No Value to delete for key "'+e.toString()+'"!')}},{key:"getCopy",value:function(){var e,t=new this.constructor,n=Hg(this.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value;t.set(r,this.get(r).get())}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"equals",value:function(e){var t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;var r,i=Hg(t);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=this.get(a).get(),s=e.get(a);if(v7(s.isPresent(),"value is absent in a map even though its key is present!"),!1===lB(o,s.get()))return!1}}catch(u){i.e(u)}finally{i.f()}return!0}}],[{key:"from",value:function(t){for(var n=Object.keys(t),r=new e,i=0,a=n;i<a.length;i++){var o=a[i];r.set(o,t[o])}return r}}]),e}(),dte=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"reverse",value:function(){var e,t=new n,r=Hg(this.listKeys());try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.get(i).get();if(t.containsKey(a))t.get(a).get().add(i);else{var o=new ite;o.add(i),t.set(a,o)}}}catch(s){r.e(s)}finally{r.f()}return t}}]),n}(hte),vte=function(){var e=Wg(function e(){Zg(this,e)});return e.createdNodes=0,e.minimaxTime=0,e}(),pte=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fB.empty(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fB.empty(),i=arguments.length>3?arguments[3]:void 0;if(Zg(this,e),this.gameState=t,this.mother=n,this.move=r,this.minimaxCreator=i,this.childs=fB.empty(),this.hopedValue=new hte,this.ownValue=new hte,this.possibleMoves=new hte,this.ownValue=new hte,null!=i){var a=i.getBoardValue(this);this.ownValue.set(i.name,a),this.hopedValue.set(i.name,a.value)}vte.createdNodes++,sB(e.VERBOSE||!1,"creating "+this.myToString())}return Wg(e,[{key:"findBestMove",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=(new Date).getTime(),a=this.alphaBeta(e,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,t,n,r);a.gameState.turn>this.gameState.turn+1;)a=a.mother.get(),e--;return vte.minimaxTime+=(new Date).getTime()-i,a.move.get()}},{key:"alphaBeta",value:function(t,n,r,i,a,o){if(t<1)return sB(e.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+t),this;if(i.ruler.getGameStatus(this).isEndGame)return sB(e.VERBOSE||!1,"isLeaf-EndGame("+e.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+t),this;var s=this.getPossibleMoves(i);v7(s.size()>0,"Minimax "+i.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=fB.of([]));var u=this.getBestChilds(s,t,n,r,i,a,o),c=this.getBestChildAmongst(u,a),l=c.hopedValue.get(i.toString()).get();return this.hopedValue.put(i.toString(),l),c}},{key:"getPossibleMoves",value:function(e){var t=this.possibleMoves.get(e.name);if(t.isAbsent()){var n=e.getListMoves(this);return this.possibleMoves.set(e.name,new ite(n)),new ite(n)}return t.get()}},{key:"getBestChilds",value:function(e,t,n,r,i,a,o){var s,u=[],c=this.gameState.getCurrentPlayer(),l=c===R7.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,f=c===R7.ZERO?function(e,t){return e<t}:function(e,t){return e>t},h=Hg(e);try{for(h.s();!(s=h.n()).done;){var d=s.value,v=this.getOrCreateChild(d,i).alphaBeta(t-1,n,r,i,a,o),p=v.getHopedValue(i);if(f(p,l)||0===u.length?(l=p,u=[v]):p===l&&u.push(v),o&&f(l,c===R7.ZERO?n:r))break;c===R7.ZERO?r=Math.min(l,r):n=Math.max(l,n)}}catch(g){h.e(g)}finally{h.f()}return u}},{key:"getBestChildAmongst",value:function(e,t){return t?e[Math.floor(Math.random()*e.length)]:e[0]}},{key:"getOrCreateChild",value:function(t,n){var r=this.getSonByMove(t);if(r.isAbsent()){var i=n.ruler.isLegal(t,this.gameState),a=t.toString();v7(i.isSuccess(),'The minimax "'+n.name+'" has proposed an illegal move ('+a+"), this should not happen.");var o=n.ruler.applyLegalMove(t,this.gameState,i.get());r=fB.of(new e(o,fB.of(this),fB.of(t),n)),this.childs.get().push(r.get())}return r.get()}},{key:"getSonByMove",value:function(e){v7(this.childs.isPresent(),"Cannot get son of uncalculated node");var t,n=Hg(this.childs.get());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.move.isPresent()&&r.move.equalsValue(e))return fB.of(r)}}catch(i){n.e(i)}finally{n.f()}return fB.empty()}},{key:"getInitialNode",value:function(){for(var e=this;e.mother.isPresent();)e=e.mother.get();return e}},{key:"getHopedValue",value:function(e){return this.hopedValue.get(e.name).get()}},{key:"getOwnValue",value:function(e){var t=this.ownValue.get(e.name);if(t.isAbsent()){var n=e.getBoardValue(this);return this.ownValue.set(e.name,n),n}return t.get()}},{key:"myToString",value:function(){var e="",t=this;if(t.mother.isAbsent())return"NodeInitial: "+t.gameState.turn;for(;t.mother.isPresent();)e=(t.move.isAbsent()?" ":" > "+t.move.get().toString()+"> ")+t.gameState.turn+" "+e,t=t.mother.get();return"Node: "+e}},{key:"hasMoves",value:function(){return this.childs.isPresent()}},{key:"countDescendants",value:function(){if(this.childs.isAbsent())return 0;var e,t=this.childs.get().length,n=Hg(this.childs.get());try{for(n.s();!(e=n.n()).done;){t+=e.value.countDescendants()}}catch(r){n.e(r)}finally{n.f()}return t}}],[{key:"getScoreStatus",value:function(t){var n=!1;return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER?(sB(e.VERBOSE||n,"VICTORY"),fte.VICTORY):t===Number.MIN_SAFE_INTEGER+1?(sB(e.VERBOSE||n,"PRE_VICTORY_MIN"),fte.PRE_VICTORY):t===Number.MAX_SAFE_INTEGER-1?(sB(e.VERBOSE||n,"PRE_VICTORY_MAX"),fte.PRE_VICTORY):(sB(e.VERBOSE||n,"DEFAULT"),fte.DEFAULT)}}]),e}();pte.VERBOSE=!1,pte.minimaxes=new hte;var gte=function(){function e(t,n){Zg(this,e),this.isEndGame=t,this.winner=n}return Wg(e,[{key:"toBoardValue",value:function(){return this.winner.isPlayer()?this.winner.getVictoryValue():0}}],[{key:"getVictory",value:function(t){return t===R7.ZERO?e.ZERO_WON:e.ONE_WON}},{key:"getDefeat",value:function(t){return t===R7.ZERO?e.ONE_WON:e.ZERO_WON}}]),e}();gte.ZERO_WON=new gte(!0,R7.ZERO),gte.ONE_WON=new gte(!0,R7.ONE),gte.DRAW=new gte(!0,A7.NONE),gte.ONGOING=new gte(!1,A7.NONE);var yte=function(){function e(t){Zg(this,e),this.stateType=t,this.setInitialBoard()}return Wg(e,[{key:"choose",value:function(e){var t=!1;sB(t,"Rules.choose: "+e.toString()+" was proposed");var n=this.isLegal(e,this.node.gameState);if(this.node.hasMoves()){sB(t,"Rules.choose: current node has moves");var r=this.node.getSonByMove(e);if(r.isPresent())return v7(n.isSuccess(),"Rules.choose: Move is illegal: "+n.getReasonOr("")),sB(t,"Rules.choose: and this proposed move is found in the list, so it is legal"),this.node=r.get(),!0}if(sB(t,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),n.isFailure())return sB(t,"Rules.choose: Move is illegal: "+n.getReason()),!1;sB(t,"Rules.choose: Move is legal, let's apply it");var i=this.applyLegalMove(e,this.node.gameState,n.get()),a=new pte(i,fB.of(this.node),fB.of(e));return this.node=a,!0}},{key:"setInitialBoard",value:function(){if(null==this.node){var e=this.stateType.getInitialState();pte.ruler=this,this.node=new pte(e)}else this.node=this.node.getInitialNode()}},{key:"applyMoves",value:function(e,t,n){var r,i=0,a=Hg(e);try{for(a.s();!(r=a.n()).done;){var o=n(r.value),s=this.isLegal(o,t);v7(s.isSuccess(),"Can't create state from invalid moves ("+i+"): "+s.toString()+"."),t=this.applyLegalMove(o,t,s.get()),i++}}catch(u){a.e(u)}finally{a.f()}return t}}]),e}(),mte=function(){var e=Wg(function e(){Zg(this,e)});return e.CANNOT_MOVE_MORE_THAN_THREE_PIECES=function(){return $localize(V||(V=_g(["You cannot move more than 3 of your pieces!"])))},e.NOT_ENOUGH_PIECE_TO_PUSH=function(){return $localize(B||(B=_g(["You don't have enough pieces to push that group!"])))},e.CANNOT_PUSH_YOUR_OWN_PIECES=function(){return $localize(z||(z=_g(["You cannot push this piece because it is blocked by one of yours!"])))},e.MUST_ONLY_TRANSLATE_YOUR_PIECES=function(){return $localize(H||(H=_g(["This line contains pieces of your opponent or empty spaces, which is forbidden."])))},e.TRANSLATION_IMPOSSIBLE=function(){return $localize(G||(G=_g(["This move is impossible, some landing spaces are occupied."])))},e.LINE_AND_COORD_NOT_ALIGNED=function(){return $localize($||($=_g(["This space is not aligned with the current line."])))},e}(),kte=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){return new ste(n,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=this.getFirstPieceValidity(e,t);return r.isFailure()?r.toFailedFallible():e.isSingleCoord()?n.isLegalPush(e,t):n.isLegalSideStep(e,t)}},{key:"getFirstPieceValidity",value:function(e,t){var n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?pB.failure(ete.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===jee.ofPlayer(t.getCurrentOpponent())?pB.failure(ete.CANNOT_CHOOSE_OPPONENT_PIECE()):pB.SUCCESS}},{key:"isLegalPush",value:function(e,t){var r=1,i=e.coord.getNext(e.dir),a=jee.ofPlayer(t.getCurrentPlayer()),o=jee.EMPTY,s=t.getCopiedBoard();for(s[e.coord.y][e.coord.x]=o;r<=3&&t.isOnBoard(i)&&t.getPieceAt(i)===a;)r++,i=i.getNext(e.dir);return r>3?hB.failure(mte.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===t.isInBoard(i)||(s[i.y][i.x]=a,t.getPieceAt(i)===o)?hB.success(s):n.isLegalRealPush(i,e,t,r,s)}},{key:"isLegalRealPush",value:function(e,t,n,r,i){for(var a=0,o=jee.ofPlayer(n.getCurrentOpponent()),s=jee.ofPlayer(n.getCurrentPlayer());a<r&&n.isOnBoard(e)&&n.getPieceAt(e)===o;)a++,e=e.getNext(t.dir);return a>=r?hB.failure(mte.NOT_ENOUGH_PIECE_TO_PUSH()):e.isInRange(9,9)&&(n.getPieceAt(e)===jee.EMPTY&&(i[e.y][e.x]=o),n.getPieceAt(e)===s)?hB.failure(mte.CANNOT_PUSH_YOUR_OWN_PIECES()):hB.success(i)}},{key:"isLegalSideStep",value:function(e,t){var n=e.lastPiece.get(),r=e.coord.getDirectionToward(n).get();n=n.getNext(r);for(var i=e.coord,a=jee.ofPlayer(t.getCurrentPlayer()),o=t.getCopiedBoard();!1===i.equals(n)&&i.isInRange(9,9);){if(t.getPieceAt(i)!==a)return hB.failure(mte.MUST_ONLY_TRANSLATE_YOUR_PIECES());var s=i.getNext(e.dir);if(o[i.y][i.x]=jee.EMPTY,s.isInRange(9,9)){if(t.isPiece(s))return hB.failure(mte.TRANSLATION_IMPOSSIBLE());t.getPieceAt(s)===jee.EMPTY&&(o[s.y][s.x]=a)}i=i.getNext(r)}return hB.success(o)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getScores();return t[0]>5?gte.ZERO_WON:t[1]>5?gte.ONE_WON:gte.ONGOING}}]),n}(yte),Cte=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<9;i++)for(var a=0;a<9;a++){var o=new Zee(a,i);if(!1!==n.getPieceAt(o).is(r)){var s,u=Hg(Yee.factory.all);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=lte.fromSingleCoord(o,c).get();if(this.isAcceptablePush(l,n)){t.push(l);var f,h=Hg(Yee.factory.all);try{for(h.s();!(f=h.n()).done;)for(var d=f.value,v=1;v<=2&&!d.equals(c);v++){var p=o.getNext(d,v);if(!p.isInRange(9,9))break;var g=lte.fromDoubleCoord(o,p,c).get();kte.isLegal(g,n).isSuccess()&&t.push(g)}}catch(y){h.e(y)}finally{h.f()}}}}catch(y){u.e(y)}finally{u.f()}}}return new ite(t).toList()}},{key:"isAcceptablePush",value:function(e,t){var n=t.getScores(),r=kte.isLegal(e,t);if(r.isSuccess()){var i=t.getCurrentOpponent().value;return!(new ste(r.get(),t.turn+1).getScores()[i]>n[i])}return!1}},{key:"getBoardValue",value:function(e){var t=kte.getGameStatus(e);if(t.isEndGame)return new nte(t.toBoardValue());var n=e.gameState.getScores();return new nte(n[1]-n[0])}}]),n}(tte),wte=function(){function e(t,n,r){Zg(this,e),this.title=t,this.instruction=n,this.state=r,this.previousMove=fB.empty()}return Wg(e,[{key:"isMove",value:function(){return!1}},{key:"isAnyMove",value:function(){return!1}},{key:"isClick",value:function(){return!1}},{key:"isPredicate",value:function(){return!1}},{key:"isInformation",value:function(){return!1}},{key:"hasSolution",value:function(){return!1}},{key:"withPreviousMove",value:function(e){return this.previousMove=fB.of(e),this}}],[{key:"fromMove",value:function(e,t,n,r,i,a){return new Ete(e,t,n,r,i,a)}},{key:"forClick",value:function(e,t,n,r,i,a){return new Pte(e,t,n,r,i,a)}},{key:"anyMove",value:function(e,t,n,r,i){return new bte(e,t,n,r,i)}},{key:"fromPredicate",value:function(e,t,n,r,i,a){return new Ste(e,t,n,r,i,a)}},{key:"informational",value:function(e,t,n){return new Ote(e,t,n)}}]),e}(),_te=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,e,r,i)).successMessage=a,o}return Wg(n,[{key:"hasSolution",value:function(){return!0}},{key:"getSuccessMessage",value:function(){return this.successMessage}}]),n}(wte),Ete=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,e,r,i,o)).acceptedMoves=a,u.failureMessage=s,v7(a.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational"),u}return Wg(n,[{key:"isMove",value:function(){return!0}},{key:"getSolution",value:function(){return this.acceptedMoves[0]}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(_te),bte=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o){var s;return Zg(this,n),(s=t.call(this,e,r,i,o)).solutionMove=a,s}return Wg(n,[{key:"getSolution",value:function(){return this.solutionMove}},{key:"isAnyMove",value:function(){return!0}}]),n}(_te),Pte=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,e,r,i,o)).acceptedClicks=a,u.failureMessage=s,u}return Wg(n,[{key:"isClick",value:function(){return!0}},{key:"getSolution",value:function(){return this.acceptedClicks[0]}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(_te),Ste=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,e,r,i,s)).solutionMove=a,u.predicate=o,u}return Wg(n,[{key:"getSolution",value:function(){return this.solutionMove}},{key:"isPredicate",value:function(){return!0}}]),n}(_te),Ote=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isInformation",value:function(){return!0}}]),n}(wte),Tte=jee.EMPTY,Ite=jee.UNREACHABLE,Ate=jee.ZERO,Rte=jee.ONE,Mte=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(Z||(Z=_g(["Initial board and goal of the game"]))),$localize(q||(q=_g(["At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!"]))),ste.getInitialState()),wte.anyMove($localize(W||(W=_g(["Moving a piece"]))),$localize(j||(j=_g(["At each turn, move one, two, or three pieces either along their line, or on their side.\n        For your moves you can therefore choose between up to 6 directions.\n        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).\n        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>\n        You're playing Dark, make any move!"]))),ste.getInitialState(),lte.fromSingleCoord(new Zee(2,6),Yee.UP).get(),$localize(Y||(Y=_g(["Congratulations!"])))),wte.fromMove($localize(K||(K=_g(["Pushing"]))),$localize(Q||(Q=_g(["To push one opponent piece, you must move at least two of your pieces.\n        To push two opponent pieces, you must move three of your pieces.\n        If one of your pieces is in the way, it will be impossible to push.\n        You cannot move more than three pieces.<br/><br/>\n        Only one push towards the right is possible here, find it. (You're playing Dark)."]))),new ste([[Ite,Ite,Ite,Ite,Tte,Ate,Ate,Rte,Rte],[Ite,Ite,Ite,Tte,Tte,Tte,Tte,Tte,Tte],[Ite,Ite,Tte,Ate,Ate,Ate,Rte,Ate,Tte],[Ite,Tte,Tte,Tte,Tte,Tte,Tte,Tte,Tte],[Tte,Tte,Tte,Tte,Ate,Ate,Ate,Rte,Rte],[Tte,Tte,Tte,Tte,Tte,Tte,Tte,Tte,Ite],[Tte,Tte,Tte,Tte,Ate,Rte,Tte,Ite,Ite],[Tte,Tte,Tte,Ate,Tte,Tte,Ite,Ite,Ite],[Tte,Tte,Ate,Tte,Tte,Ite,Ite,Ite,Ite]],0),[lte.fromSingleCoord(new Zee(4,4),Yee.RIGHT).get()],$localize(X||(X=_g(["Congratulations! You know everything you need to start a game!"]))),$localize(J||(J=_g(["Failed!"]))))]});function xte(e,t){if(1&e){var n=aP();cC(),eP(0,"circle",6),uP("click",function(){Nk(n);var e=fP(2).index,t=fP().index;return fP().onPieceClick(e,t)}),tP()}if(2&e){var r=fP(2).index,i=fP().index,a=fP();vP("id","piece_",r,"_",i,""),Xb("ngClass",a.getPieceClasses(r,i)),$b("cx",a.getCenterBy(r,i).x)("cy",a.getCenterBy(r,i).y)("r",.5*a.SPACE_SIZE)}}function Nte(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"polyline",4),uP("click",function(){Nk(n);var e=fP().index,t=fP().index;return fP().onCaseClick(e,t)}),tP(),Yb(2,xte,1,6,"circle",5),tP()}if(2&e){var r=fP(),i=r.index,a=r.$implicit,o=fP().index,s=fP();pE(1),vP("id","case_",i,"_",o,""),Xb("ngClass",s.getSquareClasses(i,o)),$b("points",s.getHexaCoordsBy(i,o)),pE(1),Xb("ngIf",s.isPiece(a))}}function Dte(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Nte,3,5,"g",3),tP()),2&e){var n=t.$implicit,r=fP(2);pE(1),Xb("ngIf",r.isBoard(n))}}function Lte(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Dte,2,1,"g",1),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}function Fte(e,t){1&e&&(cC(),eP(0,"marker",7),nP(1,"polygon",8),tP()),2&e&&dP("id","arrowhead_",t.$implicit.dir.toString(),"")}function Ute(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),nP(1,"line",9),eP(2,"line",10),uP("click",function(){var e=Nk(n).$implicit;return fP().chooseDirection(e.dir)}),tP(),eP(3,"polygon",11),uP("click",function(){var e=Nk(n).$implicit;return fP().chooseDirection(e.dir)}),tP(),tP()}if(2&e){var r=t.$implicit;pE(1),dP("id","line_start_",r.dir.toString(),""),$b("x1",r.startCenter.x)("y1",r.startCenter.y)("x2",r.middle.x)("y2",r.middle.y),pE(1),dP("id","line_end_",r.dir.toString(),""),$b("x1",r.middle.x)("y1",r.middle.y)("x2",r.landingCenter.x)("y2",r.landingCenter.y),pE(1),dP("id","direction_",r.dir.toString(),""),$b("transform",r.transformation)}}var Vte=Wg(function e(t,n,r,i,a,o){Zg(this,e),this.startCenter=t,this.middle=n,this.landingCenter=r,this.landing=i,this.dir=a,this.transformation=o}),Bte=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).moveds=[],r.directions=[],r.selecteds=[],r.rules=new kte(ste),r.availableMinimaxes=[new Cte(r.rules,"Dummy")],r.encoder=lte.encoder,r.tutorial=(new Mte).tutorial,r.scores=fB.of([0,0]),r.SPACE_SIZE=30,r.hexaLayout=new Kee(r.SPACE_SIZE,new Zee(-8*r.SPACE_SIZE,2*r.SPACE_SIZE),Xee.INSTANCE),r.updateBoard(),r}return Wg(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.hexaBoard=this.rules.node.gameState.getCopiedBoard(),this.scores=fB.of(this.rules.node.gameState.getScores())}},{key:"hidePreviousMove",value:function(){this.moveds=[]}},{key:"cancelMoveAttempt",value:function(){this.directions=[],this.selecteds=[]}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get();e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}},{key:"showPushingMove",value:function(e){var t=this.rules.node.mother.get().gameState,n=e.coord;for(this.moveds=[n],n=n.getNext(e.dir);n.isInRange(9,9)&&t.isPiece(n);)this.moveds.push(n),n=n.getNext(e.dir);n.isInRange(9,9)&&this.moveds.push(n)}},{key:"showSideStepMove",value:function(e){var t=e.lastPiece.get(),n=e.coord.getDirectionToward(t).get();t=t.getNext(n);for(var r=e.coord;!1===r.equals(t);)this.moveds.push(r),this.moveds.push(r.getNext(e.dir)),r=r.getNext(n)}},{key:"onPieceClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#piece_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=n.rules.node.gameState.getCurrentOpponent(),r.abrupt("return",n.hexaBoard[t][e].is(a)?n.opponentClick(e,t):0===n.selecteds.length?n.firstClick(e,t):1===n.selecteds.length?n.secondClick(e,t):n.thirdClick(e,t));case 5:case"end":return r.stop()}},r)}))()}},{key:"opponentClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.tryChoosingDirection(e,t);case 2:if(!r.sent.isSuccess()){r.next=6;break}r.t0=pB.SUCCESS,r.next=7;break;case 6:r.t0=n.cancelMove(ete.CANNOT_CHOOSE_OPPONENT_PIECE());case 7:return r.abrupt("return",r.t0);case 8:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.selecteds=[new Zee(e,t)],n.showPossibleDirections(),pB.SUCCESS));case 1:case"end":return r.stop()}},r)}))()}},{key:"showPossibleDirections",value:function(){this.directions=[],this.showDirection(1===this.selecteds.length)}},{key:"showDirection",value:function(e){var t,n=this.rules.node.gameState,r=jee.ofPlayer(n.getCurrentPlayer()),i=this.selecteds[0],a=this.selecteds[this.selecteds.length-1],o=Hg(Yee.factory.all);try{for(o.s();!(t=o.n()).done;){var s,u=t.value,c=i.getNext(u,1);if(n.isOnBoard(c)&&n.getPieceAt(c)===r){if(e)continue;if(c=a.getNext(u,1),n.isOnBoard(c)&&n.getPieceAt(c)===r)continue}if(s=e?lte.fromSingleCoord(i,u).get():lte.fromDoubleCoord(i,a,u).get(),this.rules.isLegal(s,n).isSuccess()){var l=this.getCenterAt(i),f=this.getCenterAt(c),h=this.getMiddleOfArrow(u,c,f),d=f.x+" "+f.y,v=Yee.getAngle(u)+150,p=new Vte(l,h,f,c,u,"rotate("+v+" "+d+") translate("+d+")");this.directions.push(p)}}}catch(g){o.e(g)}finally{o.f()}}},{key:"getMiddleOfArrow",value:function(e,t,n){var r=t.getPrevious(e),i=this.getCenterAt(r);return new Zee(i.x+(n.x-i.x)/2,i.y+(n.y-i.y)/2)}},{key:"isBoard",value:function(e){return e!==jee.UNREACHABLE}},{key:"isPiece",value:function(e){return e!==jee.EMPTY}},{key:"secondClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.selecteds[0],!(a=new Zee(e,t)).equals(i)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),pB.SUCCESS));case 3:if(!1!==a.isHexagonallyAlignedWith(i)){r.next=5;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 5:if(!((o=a.getDistance(i))>2)){r.next=8;break}return r.abrupt("return",n.cancelMove(mte.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 8:for(s=i.getDirectionToward(a).get(),n.selecteds=[i],u=0;u<o;u++)n.selecteds.push(i.getNext(s,u+1));if(3!==n.selecteds.length){r.next=15;break}if(c=n.selecteds[1],l=n.rules.node.gameState.getCurrentPlayer(),!1!==n.hexaBoard[c.y][c.x].is(l)){r.next=15;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 15:return r.abrupt("return",(n.showPossibleDirections(),pB.SUCCESS));case 16:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new Zee(e,t),a=n.selecteds[0],!i.equals(a)){r.next=3;break}return r.abrupt("return",n.deselectExtremity(!0));case 3:return o=n.selecteds[n.selecteds.length-1],r.abrupt("return",i.equals(o)?n.deselectExtremity(!1):3===n.selecteds.length&&i.equals(n.selecteds[1])?(n.cancelMoveAttempt(),pB.SUCCESS):n.tryExtension(i,a,o));case 5:case"end":return r.stop()}},r)}))()}},{key:"tryExtension",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o,s,u,c;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=Hee.factory.fromMove(t,e)).isSuccess()){i.next=6;break}if(o=Hee.factory.fromMove(n,e),!a.equals(o)){i.next=6;break}return s=t.getDistance(e),u=n.getDistance(e),i.abrupt("return",2===Math.max(s,u)?(r.selecteds.push(e),D7.sortByDescending(r.selecteds,lte.sortCoord),r.showPossibleDirections(),pB.SUCCESS):r.cancelMove(mte.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 6:return c=r.cancelMove(mte.LINE_AND_COORD_NOT_ALIGNED()),i.next=9,r.firstClick(e.x,e.y);case 9:return i.abrupt("return",c);case 10:case"end":return i.stop()}},i)}))()}},{key:"deselectExtremity",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.selecteds=t.selecteds.slice(e?1:0,e?void 0:-1),t.showPossibleDirections(),pB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"chooseDirection",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#direction_"+e.toString()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t._chooseDirection(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"_chooseDirection",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.rules.node.gameState,a=t.selecteds[0],n.abrupt("return",(i=1===t.selecteds.length?lte.fromSingleCoord(a,e).get():lte.fromDoubleCoord(a,t.selecteds[t.selecteds.length-1],e).get(),t.chooseMove(i,r,t.scores.get())));case 3:case"end":return n.stop()}},n)}))()}},{key:"onCaseClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#case_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.tryChoosingDirection(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"tryChoosingDirection",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new Zee(e,t),a=Hg(n.directions),r.prev=2,a.s();case 4:if((o=a.n()).done){r.next=10;break}if(!(s=o.value).landing.equals(i)){r.next=8;break}return r.abrupt("return",n._chooseDirection(s.dir));case 8:r.next=4;break;case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(2),a.e(r.t0);case 15:return r.prev=15,a.f(),r.finish(15);case 18:return r.abrupt("return",pB.failure("not a direction"));case 19:case"end":return r.stop()}},r,null,[[2,12,15,18]])}))()}},{key:"getSquareClasses",value:function(e,t){var n=new Zee(e,t),r=[];return this.moveds.some(function(e){return e.equals(n)})&&r.push("moved"),r}},{key:"getPieceClasses",value:function(e,t){var n=new Zee(e,t),r=R7.of(this.hexaBoard[t][e].value),i=[this.getPlayerClass(r)];return this.selecteds.some(function(e){return e.equals(n)})&&i.push("highlighted"),i}}]),n}(Wee);return e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-abalone"]],features:[Rb],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),Yb(1,Lte,2,1,"g",1),eP(2,"defs"),Yb(3,Fte,2,1,"marker",2),tP(),Yb(4,Ute,4,12,"g",1),tP()),2&e&&(pE(1),Xb("ngForOf",t.hexaBoard),pE(2),Xb("ngForOf",t.directions),pE(1),Xb("ngForOf",t.directions))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),zte=function(){function e(t){Zg(this,e),this.x=t}return Wg(e,[{key:"equals",value:function(e){return this.x===e.x}}],[{key:"from",value:function(t){switch(t){case 0:return e.ZERO;case 1:return e.ONE;case 2:return e.TWO;default:return v7(3===t,"Invalid Apagos Coord "+t),e.THREE}}}]),e}();zte.ZERO=new zte(0),zte.ONE=new zte(1),zte.TWO=new zte(2),zte.THREE=new zte(3);var Hte=function(){var e=Wg(function e(){Zg(this,e)});return e.PIECE_SHOULD_MOVE_DOWNWARD=function(){return $localize(ee||(ee=_g(["Pieces should only move downward!"])))},e.CANNOT_LAND_ON_A_FULL_SQUARE=function(){return $localize(te||(te=_g(["That square is already full, you cannot put a piece in it!"])))},e.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=function(){return $localize(ne||(ne=_g(["You have no pieces in that square, select one that contains at least one of your pieces!"])))},e.NO_PIECE_REMAINING_TO_DROP=function(){return $localize(re||(re=_g(["There are no remaining pieces of that color to drop!"])))},e.NO_POSSIBLE_TRANSFER_REMAINS=function(){return $localize(ie||(ie=_g(["There is no possible transfer from that square!"])))},e}(),Gte=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this)).landing=e,a.piece=r,a.starting=i,a}return Wg(n,[{key:"isDrop",value:function(){return this.piece.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}},{key:"equals",value:function(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}],[{key:"drop",value:function(e,t){return oB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(e)&&n.piece.equalsValue(t)&&n.starting.equals(fB.empty())}))}},{key:"transfer",value:function(e,t){if(e.x<=t.x)return hB.failure(Hte.PIECE_SHOULD_MOVE_DOWNWARD());var r=oB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(t)&&n.piece.equals(fB.empty())&&n.starting.equals(fB.of(e))}));return hB.success(r)}}]),n}(ute);Gte.ALL_MOVES=[new Gte(zte.ZERO,fB.of(R7.ZERO),fB.empty()),new Gte(zte.ONE,fB.of(R7.ZERO),fB.empty()),new Gte(zte.TWO,fB.of(R7.ZERO),fB.empty()),new Gte(zte.THREE,fB.of(R7.ZERO),fB.empty()),new Gte(zte.ZERO,fB.of(R7.ONE),fB.empty()),new Gte(zte.ONE,fB.of(R7.ONE),fB.empty()),new Gte(zte.TWO,fB.of(R7.ONE),fB.empty()),new Gte(zte.THREE,fB.of(R7.ONE),fB.empty()),new Gte(zte.TWO,fB.empty(),fB.of(zte.THREE)),new Gte(zte.ONE,fB.empty(),fB.of(zte.THREE)),new Gte(zte.ZERO,fB.empty(),fB.of(zte.THREE)),new Gte(zte.ONE,fB.empty(),fB.of(zte.TWO)),new Gte(zte.ZERO,fB.empty(),fB.of(zte.TWO)),new Gte(zte.ZERO,fB.empty(),fB.of(zte.ONE))],Gte.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return Gte.ALL_MOVES.length}},{key:"encodeNumber",value:function(e){var t=Gte.ALL_MOVES.findIndex(function(t){return t.equals(e)});return v7(t>=0,e.toString()+" is not part of possibles moves of Apagos!"),t}},{key:"decodeNumber",value:function(e){return v7(e<Gte.ALL_MOVES.length,e+" is not a valid encoded number for ApagosMove decoder"),Gte.ALL_MOVES[e]}}]),n}(T7));var $te=function(){function e(t){Zg(this,e),this.containing=t}return Wg(e,[{key:"isFull",value:function(){return this.count(R7.ZERO)+this.count(R7.ONE)>=this.count(A7.NONE)}},{key:"count",value:function(e){return this.containing.get(e).get()}},{key:"addPiece",value:function(t){var n=this.count(R7.ZERO),r=this.count(R7.ONE),i=this.count(A7.NONE);return t===R7.ZERO?n++:r++,e.from(n,r,i).get()}},{key:"substractPiece",value:function(t){var n=this.count(R7.ZERO),r=this.count(R7.ONE),i=this.count(A7.NONE);return t===R7.ZERO?n--:r--,e.from(n,r,i).get()}},{key:"getDominatingPlayer",value:function(){var e=this.count(R7.ZERO),t=this.count(R7.ONE);return e>t?R7.ZERO:t>e?R7.ONE:A7.NONE}},{key:"equals",value:function(e){return this.containing.equals(e.containing)}}],[{key:"from",value:function(t,n,r){if(t+n>r)return hB.failure("invalid starting space");var i=new hte([{key:R7.ZERO,value:t},{key:R7.ONE,value:n},{key:A7.NONE,value:r}]);i.makeImmutable();var a=new e(i);return hB.success(a)}}]),e}(),Zte=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e)).board=r,a.remaining=i,a.remaining.makeImmutable(),a}return Wg(n,[{key:"getPieceAt",value:function(e){return this.board[e.x]}},{key:"updateAt",value:function(e,t){for(var r=[],i=0;i<4;i++)r.push(e.x===i?t:this.board[i]);var a=this.getRemainingCopy();return new n(this.turn,r,a)}},{key:"getRemainingCopy",value:function(){return this.remaining.getCopy()}},{key:"getRemaining",value:function(e){return this.remaining.get(e).get()}},{key:"equals",value:function(e){return this.turn===e.turn&&D7.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}},{key:"fromRepresentation",value:function(e,t,r,i){for(var a=[],o=0;o<4;o++){var s=$te.from(t[0][o],t[1][o],t[2][o]).get();a.push(s)}var u=new hte;return u.set(R7.ZERO,r),u.set(R7.ONE,i),new n(e,a,u)}}]),n}(ate);return e.PIECES_PER_PLAYER=10,e}(),qte=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=t.getRemainingCopy(),r=n.get(e.piece.get()).get();n.put(e.piece.get(),r-1);var i=new Zte(t.turn+1,t.board,n),a=e.piece.get(),o=i.getPieceAt(e.landing).addPiece(a);if(e.landing===zte.THREE)return i.updateAt(e.landing,o);var s=zte.from(e.landing.x+1),u=i.getPieceAt(s);return i.updateAt(e.landing,u).updateAt(s,o)}},{key:"applyLegalTransfer",value:function(e,t){var n=t.getCurrentPlayer(),r=e.starting.get(),i=t.getPieceAt(r).substractPiece(n),a=t.getPieceAt(e.landing).addPiece(n),o=t.updateAt(r,i);return o=o.updateAt(e.landing,a),new Zte(o.turn+1,o.board,o.remaining)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.landing).isFull()?hB.failure(Hte.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}},{key:"isLegalDrop",value:function(e,t){return t.getRemaining(e.piece.get())<=0?hB.failure(Hte.NO_PIECE_REMAINING_TO_DROP()):hB.success(void 0)}},{key:"isLegalSlideDown",value:function(e,t){var n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?hB.failure(Hte.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):hB.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=0;n<4;n++)if(!1===t.getPieceAt(zte.from(n)).isFull())return gte.ONGOING;var r=t.getPieceAt(zte.THREE).getDominatingPlayer();return v7(r.isPlayer(),"winner can only be a player if the game is finished"),gte.getVictory(r)}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=fB.of(new n(Zte))),this.singleton.get()}}]),n}(yte);qte.singleton=fB.empty();var Wte=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=e.gameState;return Gte.ALL_MOVES.filter(function(e){return qte.get().isLegal(e,t).isSuccess()})}},{key:"getBoardValue",value:function(e){var t=qte.get().getGameStatus(e);if(t.isEndGame)return nte.fromWinner(t.winner);var n=e.gameState.board[3].getDominatingPlayer();return n.isPlayer()?new nte(n.getScoreModifier()):new nte(0)}}]),n}(tte),jte=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(ae||(ae=_g(["Initial board and goal of the game"]))),$localize(oe||(oe=_g(["At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!"]))),Zte.getInitialState()),wte.anyMove($localize(se||(se=_g(["Drop"]))),$localize(ue||(ue=_g(["There are two kind of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right. You're playing Light.<br/><br/>Drop a piece on one of those three squares."]))),Zte.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),Gte.drop(zte.ZERO,R7.ZERO),$localize(ce||(ce=_g(["Congratulations!"])))),wte.fromPredicate($localize(le||(le=_g(["Transfer"]))),$localize(fe||(fe=_g(["The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from an higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!"]))),Zte.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),Gte.transfer(zte.TWO,zte.ZERO).get(),function(e,t,n){return e.isDrop()?pB.failure($localize(he||(he=_g(["This move is a drop, please do a transfer!"])))):pB.SUCCESS},$localize(de||(de=_g(["Congratulations!"])))),wte.fromPredicate($localize(ve||(ve=_g(["Victory"]))),$localize(pe||(pe=_g(["When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!"]))),Zte.fromRepresentation(2,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),Gte.drop(zte.TWO,R7.ONE),function(e,t,n){return e.isDrop()?e.piece.equalsValue(R7.ONE)?pB.SUCCESS:pB.failure($localize(ge||(ge=_g(["You actively made your opponent win!"])))):pB.failure($localize(ye||(ye=_g(["Wrong choice, your opponent will win in the next turn no matter which piece is dropped!"]))))},$localize(me||(me=_g(["Congratulations!"]))))]});function Yte(e,t){if(1&e&&(cC(),nP(0,"circle",5)),2&e){var n=t.$implicit,r=fP();$b("cx",(n+1)*r.PIECE_RADIUS)("cy",r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function Kte(e,t){if(1&e){var n=aP();cC(),eP(0,"polygon",7),uP("click",function(){Nk(n);var e=fP().index,t=fP();return t.onArrowClick(e,t.PlayerOrNone.ZERO)}),tP()}if(2&e){var r=fP().index,i=fP();dP("id","dropArrow_zero_",r,""),Xb("ngClass",i.getArrowClasses(r,i.PlayerOrNone.ZERO)),$b("points",i.ARROW_COORD)("transform",i.getArrowTransform(r,i.PlayerOrNone.ZERO))}}function Qte(e,t){if(1&e){var n=aP();cC(),eP(0,"polygon",7),uP("click",function(){Nk(n);var e=fP().index,t=fP();return t.onArrowClick(e,t.PlayerOrNone.ONE)}),tP()}if(2&e){var r=fP().index,i=fP();dP("id","dropArrow_one_",r,""),Xb("ngClass",i.getArrowClasses(r,i.PlayerOrNone.ONE)),$b("points",i.ARROW_COORD)("transform",i.getArrowTransform(r,i.PlayerOrNone.ONE))}}function Xte(e,t){if(1&e){var n=aP();cC(),rP(0),eP(1,"circle",8),uP("click",function(){Nk(n);var e=fP().index;return fP().onSquareClick(e)}),tP(),iP()}if(2&e){var r=t.$implicit,i=fP(),a=i.index,o=i.$implicit,s=fP();pE(1),pP("id","square_",a,"_piece_",r,"_out_of_",o.count(s.PlayerOrNone.NONE),""),Xb("ngClass",s.getPieceClasses(a,r,o)),$b("cx",s.getCircleCenter(a,r,o).x)("cy",s.getCircleCenter(a,r,o).y)}}function Jte(e,t){if(1&e){var n=aP();cC(),rP(0),Yb(1,Kte,1,4,"polygon",6),Yb(2,Qte,1,4,"polygon",6),eP(3,"rect",7),uP("click",function(){var e=Nk(n).index;return fP().onSquareClick(e)}),tP(),Yb(4,Xte,2,6,"ng-container",3),iP()}if(2&e){var r=t.$implicit,i=t.index,a=fP();pE(1),Xb("ngIf",a.canDisplayArrow(i,a.PlayerOrNone.ZERO)),pE(1),Xb("ngIf",a.canDisplayArrow(i,a.PlayerOrNone.ONE)),pE(1),dP("id","square_",i,""),Xb("ngClass",a.getSquareClasses(i)),$b("x",i*a.SPACE_SIZE)("y",(5-i)*a.SPACE_SIZE*.25)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),pE(1),Xb("ngForOf",a.range(r.count(a.PlayerOrNone.NONE)))}}function ene(e,t){if(1&e&&(cC(),nP(0,"circle",9)),2&e){var n=t.$implicit,r=fP();$b("cx",4*r.SPACE_SIZE-(n+1)*r.PIECE_RADIUS)("cy",2.25*r.SPACE_SIZE+3*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}var tne=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).PlayerOrNone=A7,r.ARROW_COORD=n.getArrowCoord(),r.PIECES_PER_PLAYER=Zte.PIECES_PER_PLAYER,r.selectedPiece=fB.empty(),r.leftPiece=fB.empty(),r.droppedPiece=fB.empty(),r.displayableArrow=[],r.rules=new qte(Zte),r.availableMinimaxes=[new Wte(r.rules,"ApagosDummyMinimax")],r.encoder=Gte.encoder,r.tutorial=(new jte).tutorial,r.PIECE_RADIUS=200/(r.PIECES_PER_PLAYER+1),r.updateBoard(),r}return Wg(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=fB.empty(),this.showPossibleDrops()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.board,this.remainingZero=e.remaining.get(R7.ZERO).get(),this.remainingOne=e.remaining.get(R7.ONE).get(),this.hideLastMove(),this.rules.node.move.isPresent()&&this.showLastMove(),this.showPossibleDrops()}},{key:"hideLastMove",value:function(){this.movedSquare=[],this.droppedPiece=fB.empty(),this.leftPiece=fB.empty(),this.selectedPiece=fB.empty()}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}},{key:"showLastDrop",value:function(e){var t=e.piece.get(),n=e.landing.x;this.movedSquare=[n],3!==e.landing.x&&(n+=1,this.movedSquare.push(n));var r=this.getLowestPlayerPiece(this.board[n],t);this.droppedPiece=fB.of({square:n,piece:r})}},{key:"getLowestPlayerPiece",value:function(e,t){var n=e.count(t);return t===R7.ZERO?n-1:e.count(A7.NONE)-n}},{key:"showLastTransfer",value:function(e){var t=this.rules.node.mother.get().gameState,n=t.getCurrentPlayer(),r=e.starting.get().x,i=this.getLowestPlayerPiece(t.board[r],n);this.leftPiece=fB.of({square:r,piece:i});var a=e.landing.x,o=this.getLowestPlayerPiece(this.board[a],n);this.droppedPiece=fB.of({square:a,piece:o})}},{key:"showPossibleDrops",value:function(){this.displayableArrow=[];for(var e=this.rules.node.gameState,t=0;t<4;t++)!1===e.board[t].isFull()&&(e.remaining.get(R7.ZERO).get()>0&&this.displayableArrow.push({x:t,player:R7.ZERO}),e.remaining.get(R7.ONE).get()>0&&this.displayableArrow.push({x:t,player:R7.ONE}))}},{key:"getCircleCenter",value:function(e,t,n){var r=e*this.SPACE_SIZE+.5*this.SPACE_SIZE,i=(5-e)*this.SPACE_SIZE*.25+.5*this.SPACE_SIZE;if(1===n.count(A7.NONE))return new Zee(r,i);var a=n.count(A7.NONE),o=2*t*Math.PI/a-Math.PI/2,s=.3*this.SPACE_SIZE,u=s*Math.cos(o),c=s*Math.sin(o);return new Zee(r+u,i+c)}},{key:"canDisplayArrow",value:function(e,t){return this.displayableArrow.some(function(n){return n.x===e&&n.player.equals(t)})}},{key:"getArrowClasses",value:function(e,t){return[this.getPlayerClass(t)]}},{key:"getArrowTransform",value:function(e,t){var n=t===R7.ZERO?0:.5*this.SPACE_SIZE;return"translate("+(n+=e*this.SPACE_SIZE)+", "+(3-e)*this.SPACE_SIZE*.25+")"}},{key:"getSquareClasses",value:function(e){var t=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?t.push("selected"):this.movedSquare.includes(e)&&t.push("last-move"),t}},{key:"onArrowClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#dropArrow_"+(t===R7.ZERO?"zero":"one")+"_"+e)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=zte.from(e),n.selectedPiece.isPresent()?(s=n.selectedPiece.get().square,o=Gte.transfer(zte.from(s),a).get()):o=Gte.drop(a,t),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 6:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e,t,n){var r={square:e,piece:t},i=[],a=n.count(R7.ZERO),o=n.count(R7.ONE);if(this.selectedPiece.equalsValue(r))i.push("selected");else if(this.droppedPiece.equalsValue(r))i.push("last-move");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===t)return i.push("captured-stroke"),i;this.rules.node.gameState.getCurrentOpponent()===R7.ZERO?a++:o++}var s=n.count(A7.NONE)-(o+a),u=this.getPieceColor(t,a,s);return""!==u&&i.push(u),i}},{key:"getPieceColor",value:function(e,t,n){return e<t?"player0":e>=t+n?"player1":""}},{key:"onSquareClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#square_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.selectedPiece.isPresent()||t.selectedPiece.get().square!==e){n.next=5;break}return n.abrupt("return",(t.cancelMoveAttempt(),pB.SUCCESS));case 5:return i=t.rules.node.gameState.getCurrentPlayer(),a=t.board[e],n.abrupt("return",a.count(i)<=0?t.cancelMove(Hte.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(t.selectedPiece=fB.of({square:e,piece:t.getLowestPlayerPiece(a,i)}),0===t.showAndGetPossibleTranfers().length?t.cancelMove(Hte.NO_POSSIBLE_TRANSFER_REMAINS()):pB.SUCCESS));case 7:case"end":return n.stop()}},n)}))()}},{key:"showAndGetPossibleTranfers",value:function(){this.displayableArrow=[];for(var e=this.selectedPiece.get().square-1,t=this.rules.node.gameState.getCurrentPlayer();0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:t}),e--;return this.displayableArrow}}],[{key:"getArrowCoord",value:function(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}}]),n}(qee);return e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-apagos"]],features:[Rb],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-8 -8 416 350","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player0",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],["class","base mid-stroke player1",4,"ngFor","ngForOf"],[1,"base","mid-stroke","player0"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","player1"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),Yb(1,Yte,1,3,"circle",1),eP(2,"g",2),Yb(3,Jte,5,9,"ng-container",3),tP(),Yb(4,ene,1,3,"circle",4),tP()),2&e&&(pE(1),Xb("ngForOf",t.range(t.remainingZero)),pE(1),$b("transform","translate(0, "+2*t.PIECE_RADIUS+")"),pE(1),Xb("ngForOf",t.board),pE(1),Xb("ngForOf",t.range(t.remainingOne)))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),nne=function(){var e,t=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getViewBox",value:function(){return-.5*this.STROKE_WIDTH+" "+-.5*this.STROKE_WIDTH+" "+(this.board.length*this.SPACE_SIZE+this.STROKE_WIDTH)+" "+(this.board[0].length*this.SPACE_SIZE+this.STROKE_WIDTH)}}]),n}(qee);return t.\u0275fac=function(n){return(e||(e=$C(t)))(n||t)},t.\u0275cmp=Gm({type:t,selectors:[["ng-component"]],features:[Rb],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),rne=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r)).captured=i,a}return Wg(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}}],[{key:"getInitialState",value:function(){return new n(D7.createTable(6,2,4),0,[0,0])}}]),n}(ote),ine=function(){var e=Wg(function e(){Zg(this,e)});return e.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=function(){return $localize(ke||(ke=_g(["You cannot distribute from the opponent's home."])))},e.MUST_CHOOSE_NON_EMPTY_HOUSE=function(){return $localize(Ce||(Ce=_g(["You should choose a non-empty house to distribute."])))},e.SHOULD_DISTRIBUTE=function(){return $localize(we||(we=_g(["You should distribute but you do not."])))},e}(),ane=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,r){sB(n.VERBOSE,{called:"AwaleRules.applyLegalMove",move:e,state:t});var i=e.x,a=t.getCurrentPlayer().value,o=t.getCurrentPlayer().getOpponent().value,s=t.getCopiedBoard(),u=n.distribute(i,a,s);if(u.y===a)return new rne(s,t.turn+1,t.captured);var c=[0,0],l=D7.copyBiArray(s);return c[a]=n.capture(u.x,o,a,s),c[a]>0&&n.isStarving(o,s)&&(s=l,c=[0,0]),n.isStarving(a,s)&&!1===n.canDistribute(o,s)&&(c[o]+=n.mansoon(o,s)),c[0]+=t.captured[0],c[1]+=t.captured[1],new rne(s,t.turn+1,c)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"mansoon",value:function(e,t){var n=0,r=0;do{n+=t[e][r],t[e][r]=0,r++}while(r<6);return n}},{key:"isLegal",value:function(e,t){var r=t.getCurrentPlayer().value,i=t.getCurrentPlayer().getOpponent().value,a=e.x;if(0===t.getPieceAtXY(a,r))return hB.failure(ine.MUST_CHOOSE_NON_EMPTY_HOUSE());var o=n.isStarving(i,t.board),s=!1===n.doesDistribute(a,r,t.board);return o&&s?hB.failure(ine.SHOULD_DISTRIBUTE()):hB.success(void 0)}},{key:"doesDistribute",value:function(e,t,n){return 0===t?n[t][e]>5-e:n[t][e]>e}},{key:"canDistribute",value:function(e,t){for(var r=0;r<6;r++)if(n.doesDistribute(r++,e,t))return!0;return!1}},{key:"isStarving",value:function(e,t){var n=0;do{if(t[e][n++]>0)return!1}while(n<6);return!0}},{key:"distribute",value:function(e,t,n){var r=e,i=t,a=n[t][e];for(n[t][e]=0;a>0;)0===t?5===e?t=1:e++:0===e?t=0:e--,(e!==r||t!==i)&&(n[t][e]+=1,a--);return new Zee(e,t)}},{key:"capture",value:function(e,t,n,r){v7(t!==n,"AwaleRules.capture called with wrong values of x and player");var i=r[t][e];if(i<2||i>3)return 0;var a=0,o=-1,s=-1;0===n&&(o=1,s=6);do{a+=i,r[t][e]=0,i=r[t][e+=o]}while(e!==s&&(2===i||3===i));return a}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captured[0]>24?gte.ZERO_WON:t.captured[1]>24?gte.ONE_WON:24===t.captured[0]&&24===t.captured[1]?gte.DRAW:gte.ONGOING}}]),n}(yte);return e.VERBOSE=!1,e}(),one=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).x=e,r}return Wg(n,[{key:"equals",value:function(e){return e===this||e.x===this.x}},{key:"toString",value:function(){return"AwaleMove("+this.x+")"}}],[{key:"from",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;default:return v7(5===e,"Invalid x for AwaleMove: "+e),n.FIVE}}}]),n}(ute);one.ZERO=new one(0),one.ONE=new one(1),one.TWO=new one(2),one.THREE=new one(3),one.FOUR=new one(4),one.FIVE=new one(5),one.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return one.from(e)}}]),n}(T7));var sne=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState,i=r.turn%2,a=0;do{0!==r.getPieceAtXY(a,i)&&(t=one.from(a),ane.isLegal(t,r).isSuccess()&&(t=one.from(a),n.push(t))),a++}while(a<6);return this.orderMoves(e,n)}},{key:"orderMoves",value:function(e,t){var n=e.gameState.getCurrentPlayer().value,r=e.gameState.getCurrentPlayer().getOpponent().value;return D7.sortByDescending(t,function(t){var i,a=e.gameState.getCopiedBoard(),o=a[n][t.x],s=ane.distribute(t.x,n,a),u=0;return s.y===n?(i=0,o<=6&&(u=10)):i=ane.capture(s.x,r,n,a),100*i+u-o}),t}},{key:"getBoardValue",value:function(e){var t=ane.getGameStatus(e);if(t.isEndGame)return nte.fromWinner(t.winner);var n=e.gameState.getCapturedCopy();return new nte(n[1]-n[0])}}]),n}(tte),une=Wg(function e(){Zg(this,e),this.tutorial=[wte.anyMove($localize(_e||(_e=_g(["Sowing"]))),$localize(Ee||(Ee=_g(["Awal\xe9 is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.\n         Let's see how seeds are sown.\n         As you're playing first, the 6 houses on the top are yours.<br/><br>\n         Click on any of them to sow the seeds it contains: they will be sown clockwise, one seed per house."]))),rne.getInitialState(),one.ZERO,$localize(be||(be=_g(["Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.\n        This is how seeds are sown:\n        one by one from the house next to the one they come from, clockwise."])))),wte.anyMove($localize(Pe||(Pe=_g(["Big sowing"]))),$localize(Se||(Se=_g(["You are now the second player (on the bottom).\n        When there are enough seeds to make a full turn, something else happens.<br/><br/>\n        Sow the house that contains 12 seeds."]))),new rne([[0,0,0,0,0,0],[0,12,0,0,0,0]],1,[0,0]),one.ONE,$localize(Oe||(Oe=_g(["See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds)."])))),wte.fromMove($localize(Te||(Te=_g(["Simple capture"]))),$localize(Ie||(Ie=_g(["After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.\n         Then, the player looks at the preceding house:\n         if it is still in the opponent's side and contains two or three seeds, they are also captured.\n         This continues until we reach either the player's side or a house containing neither two nor three seeds.<br/><br/>\n         You are the second player, try to capture some pieces!"]))),new rne([[1,0,0,0,1,0],[1,0,0,0,1,0]],1,[0,0]),[one.ZERO],$localize(Ae||(Ae=_g(["Well done! This was a simple capture, now let us see how to make multiple captures."]))),$localize(Re||(Re=_g(["Failed. Try again and sow from the leftmost house."])))),wte.fromMove($localize(Me||(Me=_g(["Multiple captures"]))),$localize(xe||(xe=_g(["By sowing from your leftmost house, you will change the number of seeds in a house from 2 to 3, and from the preceding house from 1 to 2.\n        As these are consecutive houses, all seeds in them will be captured.<br/><br/>\n        Capture them."]))),new rne([[2,1,0,0,1,0],[2,0,0,0,1,0]],1,[0,0]),[one.ZERO],$localize(Ne||(Ne=_g(["Nice, you win 3 points from the first house, and 2 from the second!"]))),$localize(De||(De=_g(["Failed. Try again."])))),wte.fromMove($localize(Le||(Le=_g(["Interrupted capture"]))),$localize(Fe||(Fe=_g(["By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>\n        Do it."]))),new rne([[1,0,1,0,0,1],[3,0,0,0,1,0]],1,[0,0]),[one.ZERO],$localize(Ue||(Ue=_g(["Notice that because the second house was not capturable, the captured was interrupted and you have not captured the first house."]))),$localize(Ve||(Ve=_g(["Failed. Try again."])))),wte.fromMove($localize(Be||(Be=_g(["Capture on the other side only"]))),$localize(ze||(ze=_g(["Try to capture the two leftmost houses of the opponent."]))),new rne([[2,2,0,0,1,0],[1,3,0,0,0,0]],1,[0,0]),[one.ONE],$localize(He||(He=_g(["Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!"]))),$localize(Ge||(Ge=_g(["You have only captured one house, try again!"])))),wte.fromMove($localize($e||($e=_g(["Do not starve"]))),$localize(Ze||(Ze=_g(["You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>\n        Try it."]))),new rne([[1,1,1,1,1,0],[5,0,0,1,0,0]],1,[0,0]),[one.ZERO],$localize(qe||(qe=_g(["Sadly, you cannot capture here, otherwise the opponent could not play after you.\n        When this happens, the move can be made, but no capture takes place!"]))),$localize(We||(We=_g(["Failed. Try again."])))),wte.anyMove($localize(je||(je=_g(["Feeding is mandatory"]))),$localize(Ye||(Ye=_g(["You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>\n        Go ahead!"]))),new rne([[0,0,0,0,0,0],[0,1,2,4,4,5]],1,[0,0]),one.THREE,$localize(Ke||(Ke=_g(["Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.\n        It is often a good way to have easy captures!"])))),wte.anyMove($localize(Qe||(Qe=_g(["End of the game"]))),$localize(Xe||(Xe=_g(["A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>\n         Sow the house on the top right."]))),new rne([[0,0,0,0,0,1],[0,1,2,3,4,4]],0,[0,0]),one.FIVE,$localize(Je||(Je=_g(["Also, as soon as on player cannot play, the other player captures all the seeds in its own side.\n         Here, it was the first player's turn, and the second player has taken all the remaining seeds."]))))]});function cne(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"circle",4),uP("click",function(){var e=Nk(n).index,t=fP().index;return fP().onClick(e,t)}),tP(),eP(2,"text",5),uP("click",function(){var e=Nk(n).index,t=fP().index;return fP().onClick(e,t)}),FP(3),tP(),tP()}if(2&e){var r=t.$implicit,i=t.index,a=fP().index,o=fP();pE(1),vP("id","click_",i,"_",a,""),Xb("ngClass",o.getSquareClasses(i,a)),$b("cx",50+100*i)("cy",50+120*a),pE(1),$b("x",50+100*i)("y",66+120*a),pE(1),VP(" ",r," ")}}function lne(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,cne,4,8,"g",2),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}var fne=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).last=fB.empty(),r.captured=[],r.moved=[],r.scores=fB.of([0,0]),r.rules=new ane(rne),r.availableMinimaxes=[new sne(r.rules,"AwaleMinimax")],r.encoder=one.encoder,r.tutorial=(new une).tutorial,r.updateBoard(),r}return Wg(n,[{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.scores=fB.of(e.getCapturedCopy()),this.hidePreviousMove();var t=this.rules.node.move;if(this.board=e.getCopiedBoard(),t.isPresent()){var n=e.getCurrentOpponent().value;this.last=fB.of(new Zee(t.get().x,n)),this.showPreviousMove()}else this.last=fB.empty()}},{key:"hidePreviousMove",value:function(){this.captured=[],this.moved=[]}},{key:"showPreviousMove",value:function(){for(var e=this.rules.node.mother.get().gameState,t=0;t<=1;t++)for(var n=0;n<=5;n++){var r=new Zee(n,t),i=this.board[t][n],a=e.getPieceAt(r);this.last.equalsValue(r)||(i<a?this.captured.push(r):i>a&&this.moved.push(r))}}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(t===n.rules.node.gameState.getCurrentPlayer().value){r.next=5;break}return r.abrupt("return",n.cancelMove(ine.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME()));case 5:return n.last=fB.empty(),a=one.from(e),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState,n.scores.get()));case 8:case"end":return r.stop()}},r)}))()}},{key:"getSquareClasses",value:function(e,t){var n=new Zee(e,t);return this.captured.some(function(e){return e.equals(n)})?["captured"]:this.last.equalsValue(n)?["moved","highlighted"]:this.moved.some(function(e){return e.equals(n)})?["moved"]:[]}}]),n}(nne);return e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-awale-component"]],features:[Rb],decls:4,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"click"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),nP(1,"rect",1),Yb(2,lne,2,1,"g",2),nP(3,"line",3),tP()),2&e&&(pE(2),Xb("ngForOf",t.board))},directives:[LA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),hne=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;if(Zg(this,n),i=t.call(this,e.x,e.y),e.equals(r))throw new Error(ete.MOVE_CANNOT_BE_STATIC());return i.end=r,Lg(i)}return Wg(n,[{key:"length",value:function(){return this.coord.getDistance(this.end)}},{key:"getDirection",value:function(){return Hee.factory.fromMove(this.coord,this.end)}}],[{key:"getEncoder",value:function(e,t,n){return new(function(r){xg(a,r);var i=Dg(a);function a(){var n;return Zg(this,a),(n=i.apply(this,arguments)).shiftAX=t,n.shiftDY=n.shiftAX*e,n.shiftDX=n.shiftDY*t,n}return Wg(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftDX+(t-1)*this.shiftDY+(e-1)*this.shiftAX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftDX+e.coord.y*this.shiftDY+e.end.x*this.shiftAX+e.end.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new Zee((r-=r%1)%e,i);r/=e;var o=(r-=r%1)%t;r/=t;var s=new Zee((r-=r%1)%e,o);return n(s,a)}}]),a}(T7))}}]),n}(cte),dne=function(){var e=Wg(function e(){Zg(this,e)});return e.LANDING_ON_OCCUPIED_SQUARE=function(){return $localize(et||(et=_g(["You cannot land on an occupied square."])))},e.THRONE_IS_LEFT_FOR_GOOD=function(){return $localize(tt||(tt=_g(["Once you left the central throne, you cannot return to it."])))},e.SOLDIERS_CANNOT_SIT_ON_THRONE=function(){return $localize(nt||(nt=_g(["Soldiers cannot sit on the throne."])))},e.MOVE_MUST_BE_ORTHOGONAL=function(){return $localize(rt||(rt=_g(["Tafl moves must be orthogonal."])))},e}(),vne=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;if(Zg(this,n),i=t.call(this,e,r),e.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+e.toString()+".");if(r.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+r.toString()+".");var a=e.getDirectionToward(r);if(a.isFailure()||a.get().isDiagonal())throw new Error(dne.MOVE_MUST_BE_ORTHOGONAL());return Lg(i)}return Wg(n,[{key:"equals",value:function(e){return e===this||!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"TaflMove("+this.coord+"->"+this.end+")"}}]),n}(hne),pne=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getMaximalDistance",value:function(){return 7}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return hB.success(r)}catch(r){return hB.failure(r.message)}}}]),n}(vne);pne.encoder=hne.getEncoder(7,7,pne.of);var gne={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:R7.ZERO},yne=function(){function e(t,n){Zg(this,e),this.owner=t,this.king=n}return Wg(e,[{key:"isKing",value:function(){return this.king}},{key:"getOwner",value:function(){return this.owner}}]),e}();yne.UNOCCUPIED=new yne(A7.NONE,!1),yne.PLAYER_ONE_KING=new yne(R7.ONE,!0),yne.INVADERS=new yne(R7.ZERO,!1),yne.DEFENDERS=new yne(R7.ONE,!1);var mne=Wg(function e(t){Zg(this,e),this.value=t});mne.NONE=new mne("NONE"),mne.OPPONENT=new mne("OPPONENT"),mne.PLAYER=new mne("PLAYER");var kne=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isCentralThrone",value:function(e){return e.equals(this.getCentralThrone())}},{key:"getCentralThrone",value:function(){var e=(this.board.length-1)/2;return new Zee(e,e)}},{key:"getRelativeOwner",value:function(e,t){var n=this.getAbsoluteOwner(t);return n===A7.NONE?mne.NONE:e===n?mne.PLAYER:mne.OPPONENT}},{key:"getAbsoluteOwner",value:function(e){return this.getPieceAt(e).getOwner()}}]),n}(ote),Cne=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=yne.UNOCCUPIED,t=yne.INVADERS,r=yne.DEFENDERS;return new n([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,r,e,e,e],[t,t,r,yne.PLAYER_ONE_KING,r,t,t],[e,e,e,r,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}}]),n}(kne),wne=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e)).config=r,a.generateMove=i,a}return Wg(n,[{key:"isLegal",value:function(e,t){sB(n.VERBOSE,{tablutRules_isLegal:{move:e,state:t}});var r=t.getCurrentPlayer(),i=this.getMoveValidity(r,e,t);return i.isFailure()?hB.failure(i.getReason()):hB.success(void 0)}},{key:"getMoveValidity",value:function(e,t,n){var r=n.getRelativeOwner(e,t.coord);if(r===mne.NONE)return pB.failure(ete.MUST_CHOOSE_PLAYER_PIECE());if(r===mne.OPPONENT)return pB.failure(ete.CANNOT_CHOOSE_OPPONENT_PIECE());if(n.getRelativeOwner(e,t.end)!==mne.NONE)return pB.failure(dne.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(n,t.end)){if(!n.getPieceAt(t.coord).isKing())return pB.failure(dne.SOLDIERS_CANNOT_SIT_ON_THRONE());if(n.isCentralThrone(t.end)&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return pB.failure(dne.THRONE_IS_LEFT_FOR_GOOD())}for(var i=t.coord.getDirectionToward(t.end).get(),a=t.coord.getOrthogonalDistance(t.end),o=t.coord.getNext(i),s=1;s<a;s++){if(n.getPieceAt(o)!==yne.UNOCCUPIED)return pB.failure(ete.SOMETHING_IN_THE_WAY());o=o.getNext(i)}return pB.SUCCESS}},{key:"isThrone",value:function(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}},{key:"isExternalThrone",value:function(e){var t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}},{key:"tryCapture",value:function(e,t,n,r){var i=t.getNext(n);return i.isInRange(this.config.WIDTH,this.config.WIDTH)&&r.getRelativeOwner(e,i)===mne.OPPONENT?r.getPieceAt(i).isKing()?this.captureKing(e,t,n,r):this.capturePawn(e,t,n,r):fB.empty()}},{key:"captureKing",value:function(e,t,n,r){var i=t.getNext(n),a=this.getSurroundings(i,n,e,r),o=a.backCoord,s=a.back,u=a.backInRange,c=a.left,l=a.leftCoord,f=a.right,h=a.rightCoord;return!1===u?this.captureKingAgainstTheWall(c,f,i):s===mne.NONE&&this.isThrone(r,o)?this.captureKingAgainstThrone(o,i,c,f):s===mne.PLAYER?this.captureKingWithAtLeastASandwich(r,i,c,l,f,h):fB.empty()}},{key:"getSurroundings",value:function(e,t,n,r){var i=e.getNext(t),a=i.isInRange(this.config.WIDTH,this.config.WIDTH),o=a?r.getRelativeOwner(n,i):mne.NONE,s=e.getLeft(t),u=s.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,s):mne.NONE,c=e.getRight(t),l=c.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,c):mne.NONE;return{backCoord:i,back:o,backInRange:a,leftCoord:s,left:u,rightCoord:c,right:l}}},{key:"captureKingAgainstTheWall",value:function(e,t,r){var i=e===mne.PLAYER?1:0;return 2===(i+=t===mne.PLAYER?1:0)&&this.config.BORDER_CAN_SURROUND_KING?(sB(n.VERBOSE||!1,"king captured by 3 invaders against 1 border"),fB.of(r)):fB.empty()}},{key:"captureKingAgainstThrone",value:function(e,t,n,r){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return fB.of(t)}else{var i=r===mne.PLAYER,a=n===mne.PLAYER||i;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&a)return fB.of(t)}return fB.empty()}},{key:"capturePawn",value:function(e,t,r,i){var a=!1,o=t.getNext(r),s=o.getNext(r),u=mne.NONE;return s.isInRange(this.config.WIDTH,this.config.WIDTH)&&(u=i.getRelativeOwner(e,s)),u===mne.NONE?!1===this.isThrone(i,s)?(sB(n.VERBOSE||a,"cannot capture a pawn without an ally; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")cannot capture a pawn without an ally behind"),fB.empty()):(sB(n.VERBOSE||a,"pawn captured by 1 opponent and 1 throne; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),fB.of(o)):u===mne.PLAYER?(sB(n.VERBOSE||a,"pawn captured by 2 opponents; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),fB.of(o)):(sB(n.VERBOSE||a,"no captures; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),fB.empty())}},{key:"captureKingWithAtLeastASandwich",value:function(e,t,r,i,a,o){if(!1===this.kingTouchCentralThrone(e,t)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return fB.of(t);var s=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,u=this.isThrone(e,i),c=r===mne.PLAYER||u&&s,l=this.isThrone(e,o);return c&&(a===mne.PLAYER||l&&s)?(sB(n.VERBOSE||!1,"king captured by 4 invaders"),fB.of(t)):fB.empty()}},{key:"kingTouchCentralThrone",value:function(e,t){var n=e.getCentralThrone();return t.getOrthogonalDistance(n)<=1}},{key:"applyLegalMove",value:function(e,t){sB(n.VERBOSE,{TablutRules_applyLegalMove:{move:e,state:t}});var r=t.turn,i=t.getCopiedBoard(),a=t.getCurrentPlayer(),o=e.coord,s=e.end;i[s.y][s.x]=i[o.y][o.x],i[o.y][o.x]=yne.UNOCCUPIED;var u,c=Hg(Gee.ORTHOGONALS);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=this.tryCapture(a,e.end,l,t);f.isPresent()&&(i[f.get().y][f.get().x]=yne.UNOCCUPIED)}}catch(h){c.e(h)}finally{c.f()}return t.from(i,r+1)}},{key:"getGameStatus",value:function(e){var t=this.getWinner(e.gameState);return t.isPresent()?gte.getVictory(t.get()):gte.ONGOING}},{key:"getWinner",value:function(e){var t=!1,n=this.getKingCoord(e);if(n.isAbsent())return sB(t,"The king is dead, victory to invader"),fB.of(this.getInvader());var r=n.get();return this.isExternalThrone(r)?(sB(t,"The king escape, victory to defender"),fB.of(this.getDefender())):this.isPlayerImmobilized(R7.ZERO,e)?(sB(t,"Zero has no move, victory to one"),fB.of(R7.ONE)):this.isPlayerImmobilized(R7.ONE,e)?(sB(t,"One has no move, victory to zero"),fB.of(R7.ZERO)):(sB(t,"no victory"),fB.empty())}},{key:"getKingCoord",value:function(e){sB(n.VERBOSE,{TablutRules_getKingCoord:{state:e,con:this.config}});for(var t=0;t<this.config.WIDTH;t++)for(var r=0;r<this.config.WIDTH;r++)if(e.getPieceAtXY(r,t).isKing())return fB.of(new Zee(r,t));return fB.empty()}},{key:"getInvader",value:function(){return this.config.INVADER}},{key:"getDefender",value:function(){return this.config.INVADER.getOpponent()}},{key:"isPlayerImmobilized",value:function(e,t){return 0===this.getPlayerListMoves(e,t).length}},{key:"getPlayerListMoves",value:function(e,t){var r=[],i=this.getPlayerListPawns(e,t);sB(n.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:e,state:t}});var a,o=Hg(i);try{for(o.s();!(a=o.n()).done;){var s,u=a.value,c=Hg(this.getPossibleDestinations(u,t));try{for(c.s();!(s=c.n()).done;){var l=s.value,f=this.generateMove(u,l);r.push(f)}}catch(h){c.e(h)}finally{c.f()}}}catch(h){o.e(h)}finally{o.f()}return r}},{key:"getPlayerListPawns",value:function(e,t){for(var n=[],r=0;r<this.config.WIDTH;r++)for(var i=0;i<this.config.WIDTH;i++){var a=new Zee(i,r);t.getAbsoluteOwner(a)===e&&n.push(a)}return n}},{key:"getPossibleDestinations",value:function(e,t){var n,r,i=[],a=Hg(Gee.ORTHOGONALS);try{for(a.s();!(r=a.n()).done;){var o=r.value;n=e.getNext(o,1);for(var s=!1;n.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===s;)t.getAbsoluteOwner(n)===A7.NONE?this.isExternalThrone(n)?t.getPieceAt(e).isKing()&&i.push(n):t.isCentralThrone(n)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&i.push(n):i.push(n):s=!0,n=n.getNext(o,1)}}catch(u){a.e(u)}finally{a.f()}return i}}]),n}(yte);return e.VERBOSE=!1,e}(),_ne=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.call(this,Cne,gne,pne.of)}return Wg(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),pte.ruler=this.singleton,n.singleton}}]),n}(wne),Ene=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e)).VERBOSE=r,a.generateMove=i,a.viewInfo={pieceClasses:[]},a.EMPTY=yne.UNOCCUPIED,a.captureds=[],a.chosen=new Zee(-1,-1),a.lastMove=fB.empty(),a}return Wg(n,[{key:"getViewBox",value:function(){var e=-this.STROKE_WIDTH,t=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return e+" "+e+" "+t+" "+t}},{key:"updateBoard",value:function(){sB(this.VERBOSE,"taflComponent.updateBoard"),this.lastMove=this.rules.node.move,this.board=this.rules.node.gameState.getCopiedBoard(),this.captureds=[],this.lastMove.isPresent()&&this.showPreviousMove(),this.updateViewInfo()}},{key:"showPreviousMove",value:function(){var e,t=this.rules.node.mother.get().gameState,n=this.rules.node.gameState.getCurrentOpponent(),r=Hg(Gee.ORTHOGONALS);try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.lastMove.get().end.getNext(i,1);if(a.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){var o=t.getRelativeOwner(n,a)===mne.OPPONENT,s=this.rules.node.gameState.getPieceAt(a)===yne.UNOCCUPIED;o&&s&&this.captureds.push(a)}}}catch(u){r.e(u)}finally{r.f()}}},{key:"updateViewInfo",value:function(){for(var e=[],t=0;t<this.board.length;t++){for(var n=[],r=0;r<this.board[0].length;r++){var i;i=this.board[t][r].getOwner()===A7.NONE?[""]:this.getPieceClasses(r,t),n.push(i)}e.push(n)}this.viewInfo={pieceClasses:e}}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(n.VERBOSE,"TaflComponent.onClick("+e+", "+t+")"),i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):-1===n.chosen.x?n.choosePiece(e,t):n.chooseDestination(e,t));case 3:case"end":return r.stop()}},r)}))()}},{key:"chooseDestination",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(sB(n.VERBOSE,"TaflComponent.chooseDestination"),i=n.chosen,a=new Zee(e,t),!(o=n.generateMove(i,a)).isSuccess()){r.next=9;break}return n.cancelMove(),r.next=6,n.chooseMove(o.get(),n.rules.node.gameState);case 6:r.t0=r.sent,r.next=10;break;case 9:r.t0=n.cancelMove(o.getReason());case 10:return r.abrupt("return",r.t0);case 11:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){return sB(this.VERBOSE,"TaflComponent.choosePiece"),this.board[t][e]===yne.UNOCCUPIED?this.cancelMove(ete.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(e,t)?(this.chosen=new Zee(e,t),this.updateViewInfo(),sB(this.VERBOSE,"selected piece = ("+e+", "+t+")"),pB.SUCCESS):this.cancelMove(ete.CANNOT_CHOOSE_OPPONENT_PIECE())}},{key:"pieceBelongToCurrentPlayer",value:function(e,t){var n=this.rules.node.gameState,r=n.getCurrentPlayer(),i=new Zee(e,t);return n.getRelativeOwner(r,i)===mne.PLAYER}},{key:"cancelMoveAttempt",value:function(){this.chosen=new Zee(-1,-1)}},{key:"isThrone",value:function(e,t){return this.rules.isThrone(this.rules.node.gameState,new Zee(e,t))}},{key:"isCentralThrone",value:function(e,t){return!1===this.rules.node.gameState.isCentralThrone(new Zee(e,t))}},{key:"getPieceClasses",value:function(e,t){var n=[],r=new Zee(e,t),i=this.rules.node.gameState.getAbsoluteOwner(r);return n.push(this.getPlayerClass(i)),this.chosen.equals(r)&&n.push("selected"),n}},{key:"getRectClasses",value:function(e,t){var n=[],r=new Zee(e,t);if(this.captureds.some(function(e){return e.equals(r)}))n.push("captured");else if(this.lastMove.isPresent()){var i=this.lastMove.get().coord,a=this.lastMove.get().end;(r.equals(i)||r.equals(a))&&n.push("moved")}return n}},{key:"getClickables",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++)this.isClickable(n,t)&&e.push(new Zee(n,t));return e}},{key:"isClickable",value:function(e,t){return this.pieceBelongToCurrentPlayer(e,t)}},{key:"isInvader",value:function(e,t){return this.board[t][e]===yne.INVADERS}},{key:"isKing",value:function(e,t){return this.board[t][e].isKing()}}]),n}(nne),bne=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){sB(!1,{TaflMinimax_getListMoves:{node:e}});var t=e.gameState,n=t.getCurrentPlayer(),r=this.ruler.getPlayerListMoves(n,t);return this.orderMoves(t,r)}},{key:"orderMoves",value:function(e,t){var n=this,r=this.ruler.getKingCoord(e).get();return e.getCurrentPlayer()===this.ruler.config.INVADER?D7.sortByDescending(t,function(e){return-e.end.getOrthogonalDistance(r)}):D7.sortByDescending(t,function(e){return e.coord.equals(r)?n.ruler.isExternalThrone(e.end)?2:1:0}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getWinner(t);if(n.isPresent())return new nte(n.get().getVictoryValue());var r=this.ruler.getPlayerListPawns(R7.ZERO,t).length,i=this.ruler.getPlayerListPawns(R7.ONE,t).length,a=[1,2][this.ruler.config.INVADER.value];a*=R7.ZERO.getScoreModifier();var o=[2,1][this.ruler.config.INVADER.value];return o*=R7.ONE.getScoreModifier(),new nte(r*a+i*o)}}]),n}(tte),Pne=function(){function e(t,n){Zg(this,e),this.directThreats=t,this.mover=n}return Wg(e,[{key:"equals",value:function(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}]),e}(),Sne=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,new ite([e]),r)).directThreat=e,i.mover=r,i}return Wg(n)}(Pne),One=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"toFields",value:function(e){return[[e.y],e.x]}}]),n}(function(e,t){xg(r,e);var n=Dg(r);function r(e){var t;if(Zg(this,r),(t=n.call(this)).map=[],t.values=[],void 0!==e){var i,a=Hg(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;t.add(o)}}catch(s){a.e(s)}finally{a.f()}}return Lg(t)}return Wg(r,[{key:"add",value:function(e){var t,n=this.toFields(e),r=this.map,i=Hg(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;void 0===r[a]&&(r[a]=[]),r=r[a]}}catch(s){i.e(s)}finally{i.f()}var o=n[1];return void 0===r[o]&&(r[o]=!0,this.values.push(e),!0)}},{key:"contains",value:function(e){var t,n=this.toFields(e),r=this.map,i=Hg(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(void 0===r[a])return!1;r=r[a]}}catch(o){i.e(o)}finally{i.f()}return void 0!==r[n[1]]}},{key:t,value:function(){return this.values.values()}}]),r}(ite,Symbol.iterator)),Tne=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e,r)).width=i.ruler.config.WIDTH,i.maxInfluence=16*(2*i.width-2),i.scoreByThreatenedPiece=16*i.maxInfluence+1,i.scoreBySafePiece=16*i.scoreByThreatenedPiece+1,i}return Wg(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new nte(t.toBoardValue());var n,r=e.gameState,i=yne.UNOCCUPIED,a=0,o=this.getPiecesMap(r),s=this.getThreatMap(r,o),u=this.filterThreatMap(s,r),c=Hg(R7.PLAYERS);try{for(c.s();!(n=c.n()).done;){var l,f=n.value,h=Hg(o.get(f).get());try{for(h.s();!(l=h.n()).done;){var d=l.value;if(u.get(d).isPresent())a+=f.getScoreModifier()*this.scoreByThreatenedPiece;else{a+=f.getScoreModifier()*this.scoreBySafePiece;var v,p=0,g=Hg(Gee.ORTHOGONALS);try{for(g.s();!(v=g.n()).done;)for(var y=v.value,m=d.getNext(y,1);m.isInRange(this.width,this.width)&&r.getPieceAt(m)===i;)p++,m=m.getNext(y,1)}catch(k){g.e(k)}finally{g.f()}a+=p*f.getScoreModifier()}}}catch(k){h.e(k)}finally{h.f()}}}catch(k){c.e(k)}finally{c.f()}return new nte(a)}},{key:"getPiecesMap",value:function(e){for(var t=yne.UNOCCUPIED,n=[],r=[],i=0;i<this.width;i++)for(var a=0;a<this.width;a++){var o=new Zee(a,i);e.getPieceAt(o)!==t&&(e.getAbsoluteOwner(o)===R7.ZERO?n.push(o):r.push(o))}return new hte([{key:R7.ZERO,value:new One(n)},{key:R7.ONE,value:new One(r)}])}},{key:"getThreatMap",value:function(e,t){var n,r=new hte,i=Hg(R7.PLAYERS);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=Hg(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreats(u,e);this.isThreatReal(u,e,c)&&r.set(u,new ite(c))}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return r}},{key:"getThreats",value:function(e,t){var n=t.getAbsoluteOwner(e);v7(n.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");var r,i=n.getOpponent(),a=[],o=Hg(Gee.ORTHOGONALS);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=e.getPrevious(s,1);if(this.isAThreat(u,t,i)){var c,l=[],f=Hg(Gee.ORTHOGONALS);try{for(f.s();!(c=f.n()).done;){var h=c.value;if(h!==s.getOpposite()){for(var d=e.getNext(s,1);d.isInRange(this.width,this.width)&&t.getPieceAt(d)===yne.UNOCCUPIED;)d=d.getNext(h);d.isInRange(this.width,this.width)&&t.getAbsoluteOwner(d)===i&&!1===e.getNext(s,1).equals(d)&&l.push(d)}}}catch(v){f.e(v)}finally{f.f()}a.push(new Sne(u,new One(l)))}}}catch(v){o.e(v)}finally{o.f()}return a}},{key:"isAThreat",value:function(e,t,n){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==n&&(!this.ruler.isThrone(t,e)||n!==R7.ONE&&t.getPieceAt(e)!==yne.UNOCCUPIED))}},{key:"isThreatReal",value:function(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;var r,i=Hg(n);try{for(i.s();!(r=i.n()).done;){if(r.value.mover.size()>0)return!0}}catch(a){i.e(a)}finally{i.f()}return!1}},{key:"filterThreatMap",value:function(e,t){var n,r=new hte,i=e.listKeys(),a=i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentPlayer()}),o=new One(i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentOpponent()})),s=Hg(a);try{for(s.s();!(n=s.n()).done;){var u,c=n.value,l=e.get(c).get(),f=[],h=Hg(l);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(!1===o.contains(d.directThreat)){var v,p=[],g=Hg(d.mover);try{for(g.s();!(v=g.n()).done;){var y=v.value;!1===o.contains(y)&&p.push(y)}}catch(_){g.e(_)}finally{g.f()}p.length>0&&f.push(new Sne(d.directThreat,new One(p)))}}}catch(_){h.e(_)}finally{h.f()}f.length>0&&r.set(c,new ite(f))}}catch(_){s.e(_)}finally{s.f()}var m,k=Hg(o);try{for(k.s();!(m=k.n()).done;){var C=m.value,w=e.get(C).get();r.set(C,w)}}catch(_){k.e(_)}finally{k.f()}return r}}]),n}(bne),Ine=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new nte(t.toBoardValue());var r,i=e.gameState,a=this.ruler.config.WIDTH,o=yne.UNOCCUPIED,s=0,u=this.getPiecesMap(i),c=this.getThreatMap(i,u),l=this.filterThreatMap(c,i),f=Hg(R7.PLAYERS);try{for(f.s();!(r=f.n()).done;){var h,d=r.value,v=new One,p=Hg(u.get(d).get());try{for(p.s();!(h=p.n()).done;){var g=h.value;if(l.get(g).isPresent())s+=d.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE;else{s+=d.getScoreModifier()*n.SCORE_BY_SAFE_PIECE;var y,m=Hg(Gee.ORTHOGONALS);try{for(m.s();!(y=m.n()).done;)for(var k=y.value,C=g.getNext(k,1);C.isInRange(a,a)&&i.getPieceAt(C)===o;)v.add(C),C=C.getNext(k,1)}catch(P){m.e(P)}finally{m.f()}}}}catch(P){p.e(P)}finally{p.f()}var w,_=Hg(v);try{for(_.s();!(w=_.n()).done;){var E=w.value,b=n.CONTROL_VALUE[E.y][E.x];s+=d.getScoreModifier()*b}}catch(P){_.e(P)}finally{_.f()}}}catch(P){f.e(P)}finally{f.f()}return new nte(s)}}]),n}(Tne);Ine.SCORE_BY_THREATENED_PIECE=530,Ine.SCORE_BY_SAFE_PIECE=16*Ine.SCORE_BY_THREATENED_PIECE+1,Ine.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];var Ane=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new nte(t.toBoardValue());var n,r=e.gameState,i=this.ruler.config.WIDTH,a=yne.UNOCCUPIED,o=0,s=0,u=0,c=this.getPiecesMap(r),l=this.getThreatMap(r,c),f=this.filterThreatMap(l,r),h=Hg(R7.PLAYERS);try{for(h.s();!(n=h.n()).done;){var d,v=n.value,p=new One,g=Hg(c.get(v).get());try{for(g.s();!(d=g.n()).done;){var y=d.value;if(f.get(y).isPresent())s+=v.getScoreModifier();else{o+=v.getScoreModifier();var m,k=Hg(Gee.ORTHOGONALS);try{for(k.s();!(m=k.n()).done;)for(var C=m.value,w=y.getNext(C,1);w.isInRange(i,i)&&r.getPieceAt(w)===a;)p.add(w),w=w.getNext(C,1)}catch(O){k.e(O)}finally{k.f()}}}}catch(O){g.e(O)}finally{g.f()}var _,E=Hg(p);try{for(E.s();!(_=E.n()).done;){var b=_.value,P=Ine.CONTROL_VALUE[b.y][b.x];u+=v.getScoreModifier()*P}}catch(O){E.e(O)}finally{E.f()}}}catch(O){h.e(O)}finally{h.f()}var S=this.getStepForEscape(r);return new nte(531*S*17*17+531*o*17+531*s+u)}},{key:"getStepForEscape",value:function(e){var t=this.ruler.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(Number.MAX_SAFE_INTEGER)}},{key:"_getStepForEscape",value:function(e,t,n,r){var i=this,a=this.getNextGen(e,n,r);return 0===a.length?fB.empty():a.some(function(e){return i.ruler.isExternalThrone(e)})?fB.of(t):(t++,r.push.apply(r,Bg(a)),this._getStepForEscape(e,t,a,r))}},{key:"getNextGen",value:function(e,t,n){var r,i=this,a=[],o=Hg(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=Hg(Gee.ORTHOGONALS);try{var l=function(){for(var t=s.value,r=u.getNext(t,1);r.isInRange(i.ruler.config.WIDTH,i.ruler.config.WIDTH)&&e.getPieceAt(r)===yne.UNOCCUPIED;)n.every(function(e){return!1===e.equals(r)})&&a.push(r),r=r.getNext(t,1)};for(c.s();!(s=c.n()).done;)l()}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}return a}}]),n}(Ine);Ane.SCORE_BY_THREATENED_PIECE=530,Ane.SCORE_BY_SAFE_PIECE=16*Ine.SCORE_BY_THREATENED_PIECE+1,Ane.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];var Rne=yne.UNOCCUPIED,Mne=yne.INVADERS,xne=yne.DEFENDERS,Nne=yne.PLAYER_ONE_KING,Dne=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(it||(it=_g(["Goal of the game"]))),$localize(at||(at=_g(["Brandhub is the Irish version of the family of viking strategy game called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne."]))),Cne.getInitialState()),wte.anyMove($localize(ot||(ot=_g(["Moving"]))),$localize(st||(st=_g(["All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, he can't go back on it, nor can the other pieces.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move."]))),Cne.getInitialState(),pne.of(new Zee(3,1),new Zee(1,1)),$localize(ut||(ut=_g(["Congratulations!"])))),wte.fromMove($localize(ct||(ct=_g(["Capturing a soldier (1/2)"]))),$localize(lt||(lt=_g(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new Cne([[Rne,Rne,Rne,Mne,Rne,Rne,Rne],[Rne,Rne,Rne,Mne,Rne,Rne,Rne],[Mne,Rne,Rne,xne,Rne,Rne,Rne],[Rne,Rne,xne,Nne,xne,Mne,Mne],[Rne,Rne,Mne,Rne,Rne,Rne,Rne],[Rne,Rne,Rne,xne,Rne,Mne,Rne],[Rne,Rne,Rne,Mne,Rne,Rne,Rne]],1),[pne.of(new Zee(3,5),new Zee(2,5))],$localize(ft||(ft=_g(["Congratulations, that will teach him a lesson!"]))),$localize(ht||(ht=_g(["Failed, you missed an opportunity to capture a piece of the opponent."])))),wte.fromMove($localize(dt||(dt=_g(["Capturing a soldier (2/2)"]))),$localize(vt||(vt=_g(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new Cne([[Rne,Rne,Rne,Mne,Rne,Rne,Rne],[Rne,Rne,Mne,Rne,Rne,Rne,Rne],[Rne,Rne,Rne,xne,Rne,Rne,Rne],[Mne,xne,Rne,Rne,xne,Mne,Mne],[Rne,xne,Rne,Rne,Rne,Rne,Rne],[Rne,Mne,Rne,Nne,Rne,Mne,Rne],[Rne,Rne,Rne,Mne,Rne,Rne,Rne]],12),[pne.of(new Zee(2,1),new Zee(3,1)),pne.of(new Zee(3,0),new Zee(3,1))],$localize(pt||(pt=_g(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(gt||(gt=_g(["Failed, you did not do the expected move."])))),wte.fromMove($localize(yt||(yt=_g(["Capturing the king on his throne"]))),$localize(mt||(mt=_g(["To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>Capture the king."]))),new Cne([[Rne,Rne,Rne,Rne,Rne,Rne,Rne],[Rne,Rne,Rne,xne,Rne,Rne,Rne],[Rne,Rne,Rne,Mne,Rne,Rne,Rne],[Rne,Mne,Rne,Nne,Mne,Rne,Rne],[Rne,Rne,Rne,Mne,Rne,Rne,Rne],[Rne,xne,Rne,Rne,Rne,Rne,Rne],[Rne,Rne,Rne,Rne,Rne,Rne,Rne]],72),[pne.of(new Zee(1,3),new Zee(2,3))],$localize(kt||(kt=_g(["Congratulations, you won!"]))),$localize(Ct||(Ct=_g(["Failed, you let the king run away."])))),wte.fromMove($localize(wt||(wt=_g(["Capturing the king next to his throne"]))),$localize(_t||(_t=_g(["Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>Capture the king."]))),new Cne([[Rne,Rne,Mne,Rne,Rne,Rne,Rne],[Rne,Rne,Rne,Mne,Rne,Rne,Rne],[Rne,Rne,Rne,Nne,Mne,Rne,Rne],[Rne,Mne,xne,Rne,xne,Rne,Rne],[Rne,Rne,Rne,Mne,Rne,Rne,Rne],[Rne,Rne,Rne,Rne,Rne,Rne,Rne],[Rne,Rne,Rne,Rne,Rne,Rne,Rne]],72),[pne.of(new Zee(2,0),new Zee(2,2))],$localize(Et||(Et=_g(["The king is dead, long live the king. Congratulations, you won."]))),$localize(bt||(bt=_g(["Failed!"])))),wte.fromMove($localize(Pt||(Pt=_g(["Capturing the king far from his throne"]))),$localize(St||(St=_g(["When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>Capture the king."]))),new Cne([[Rne,Rne,Rne,Rne,Rne,Rne,Rne],[Rne,Rne,Rne,Rne,Rne,Rne,Rne],[Rne,Mne,Rne,Mne,Rne,Rne,Rne],[Mne,Rne,Rne,Rne,xne,Rne,Rne],[Rne,Rne,Rne,xne,Rne,Rne,Rne],[Rne,Rne,Rne,Rne,Rne,Rne,Rne],[Rne,Nne,Rne,Mne,Rne,Rne,Rne]],72),[pne.of(new Zee(3,6),new Zee(2,6))],$localize(Ot||(Ot=_g(["The king is dead, long live the king. Congratulations, you won."]))),$localize(Tt||(Tt=_g(["Failed!"]))))]});function Lne(e,t){1&e&&(cC(),nP(0,"polyline",8))}function Fne(e,t){1&e&&(cC(),nP(0,"polyline",9))}function Une(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Lne,1,0,"polyline",6),Yb(2,Fne,1,0,"ng-template",null,7,MT),tP()),2&e){var n=Kb(3),r=fP().index,i=fP().index,a=fP();pE(1),Xb("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function Vne(e,t){if(1&e&&(cC(),eP(0,"g"),nP(1,"line",10),nP(2,"line",10),nP(3,"line",10),nP(4,"line",10),nP(5,"line",10),tP()),2&e){var n=fP(2).index,r=fP().index,i=fP();pE(1),Xb("ngClass",i.viewInfo.pieceClasses[r][n]),$b("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),pE(1),Xb("ngClass",i.viewInfo.pieceClasses[r][n]),$b("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),pE(1),Xb("ngClass",i.viewInfo.pieceClasses[r][n]),$b("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),pE(1),Xb("ngClass",i.viewInfo.pieceClasses[r][n]),$b("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),pE(1),Xb("ngClass",i.viewInfo.pieceClasses[r][n]),$b("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function Bne(e,t){if(1&e&&(cC(),nP(0,"polyline",15)),2&e){var n=fP(3).index,r=fP().index;Xb("ngClass",fP().viewInfo.pieceClasses[r][n])}}function zne(e,t){if(1&e&&(cC(),nP(0,"line",10),nP(1,"line",10),nP(2,"line",10),nP(3,"line",10)),2&e){var n=fP(3).index,r=fP().index,i=fP();Xb("ngClass",i.viewInfo.pieceClasses[r][n]),$b("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),pE(1),Xb("ngClass",i.viewInfo.pieceClasses[r][n]),$b("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),pE(1),Xb("ngClass",i.viewInfo.pieceClasses[r][n]),$b("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),pE(1),Xb("ngClass",i.viewInfo.pieceClasses[r][n]),$b("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function Hne(e,t){if(1&e&&(cC(),Yb(0,Bne,1,1,"polyline",13),Yb(1,zne,4,20,"ng-template",null,14,MT)),2&e){var n=Kb(2),r=fP(2).index,i=fP().index;Xb("ngIf",fP().isKing(r,i))("ngIfElse",n)}}function Gne(e,t){if(1&e&&(cC(),eP(0,"g"),nP(1,"circle",10),Yb(2,Vne,6,25,"g",11),Yb(3,Hne,3,2,"ng-template",null,12,MT),tP()),2&e){var n=Kb(4),r=fP().index,i=fP().index,a=fP();pE(1),Xb("ngClass",a.viewInfo.pieceClasses[i][r]),$b("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)("cx",.5*a.SPACE_SIZE)("cy",.5*a.SPACE_SIZE),pE(1),Xb("ngIf",a.isInvader(r,i))("ngIfElse",n)}}function $ne(e,t){if(1&e){var n=aP();cC(),eP(0,"g",3),uP("click",function(){var e=Nk(n).index,t=fP().index;return fP().onClick(e,t)}),nP(1,"rect",4),Yb(2,Une,4,2,"g",5),Yb(3,Gne,5,6,"g",5),tP()}if(2&e){var r=t.index,i=fP().index,a=fP();vP("id","click_",r,"_",i,""),$b("transform","translate("+a.SPACE_SIZE*r+", "+a.SPACE_SIZE*i+")"),pE(1),Xb("ngClass",a.getRectClasses(r,i)),$b("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),pE(1),Xb("ngIf",a.board[i][r]===a.EMPTY&&a.isThrone(r,i)),pE(1),Xb("ngIf",a.board[i][r]!==a.EMPTY)}}function Zne(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,$ne,4,8,"g",2),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}function qne(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"rect",16),uP("click",function(){var e=Nk(n).$implicit;return fP().onClick(e.x,e.y)}),tP(),tP()}if(2&e){var r=t.$implicit,i=fP();pE(1),vP("id","click_",r.x,"_",r.y,""),$b("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var Wne=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e,!1,pne.from)).rules=_ne.get(),r.availableMinimaxes=[new bne(r.rules,"DummyBot"),new Tne(r.rules,"Piece > Influence"),new Ine(r.rules,"Piece > Control"),new Ane(r.rules,"Escape > Piece > Control")],r.encoder=pne.encoder,r.tutorial=(new Dne).tutorial,r}return Wg(n,[{key:"ngOnInit",value:function(){this.updateBoard()}}]),n}(Ene);return e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-brandhub"]],features:[Rb],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15",1,"base"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60, 10 20",1,"base"],[1,"base",3,"ngClass"],[4,"ngIf","ngIfElse"],["defender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),Yb(1,Zne,2,1,"g",1),Yb(2,qne,2,6,"g",1),tP()),2&e&&($b("viewBox",t.getViewBox()),pE(1),Xb("ngForOf",t.board),pE(1),Xb("ngForOf",t.getClickables()))},directives:[LA,NA,UA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),jne=function(){var e,t=function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).SPACE_SIZE=50,e}return Wg(n,[{key:"getTriangleCornerCoords",value:function(e,t){return(e+t)%2==1?this.getDownwardCoordinate(e,t):this.getUpwardCoordinate(e,t)}},{key:"getTriangleCoordinate",value:function(e,t){return this.getTriangleCornerCoords(e,t).map(function(e){return e.x+","+e.y}).reduce(function(e,t){return e+","+t})}},{key:"getDownwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new Zee(.5*this.SPACE_SIZE*e,i);return[o,new Zee(n,a),new Zee(r,i),o]}},{key:"getUpwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new Zee(.5*this.SPACE_SIZE*e,a);return[o,new Zee(n,i),new Zee(r,a),o]}},{key:"getPyramidCoordinate",value:function(e,t){return(e+t)%2==1?this.getDownwardPyramidCoordinate(e,t):this.getUpwardPyramidCoordinate(e,t)}},{key:"getDownwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=this.SPACE_SIZE*t,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}},{key:"getUpwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=(t+1)*this.SPACE_SIZE,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}}]),n}(qee);return t.\u0275fac=function(n){return(e||(e=$C(t)))(n||t)},t.\u0275cmp=Gm({type:t,selectors:[["ng-component"]],features:[Rb],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),Yne=function(){var e=Wg(function e(){Zg(this,e)});return e.INVALID_DISTANCE=function(){return $localize(It||(It=_g(["Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is."])))},e.NOT_ENOUGH_TILES_TO_EXCHANGE=function(){return $localize(At||(At=_g(["You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it."])))},e.FIRST_CLICK_SHOULD_NOT_BE_NULL=function(){return $localize(Rt||(Rt=_g(["Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles."])))},e.CANNOT_CAPTURE_FROM_EMPTY=function(){return $localize(Mt||(Mt=_g(["You cannot capture from an empty space."])))},e.CANNOT_CAPTURE_OWN_PIECES=function(){return $localize(xt||(xt=_g(["You cannot capture your own pieces."])))},e}(),Kne=function(){function e(t,n){Zg(this,e),this.direction=t,this.str=n}return Wg(e,[{key:"toInt",value:function(){var t=this;return e.STEPS.findIndex(function(e){return e.direction.equals(t.direction)})}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return this.str}}],[{key:"fromCoords",value:function(t,n){var r=t.getVectorToward(n),i=e.STEPS.findIndex(function(e){return e.direction.equals(r)});if(-1===i)throw new Error(Yne.INVALID_DISTANCE());return e.STEPS[i]}}]),e}();Kne.LEFT=new Kne(new Vee(-2,0),"LEFT"),Kne.UP_LEFT=new Kne(Hee.UP_LEFT,"UP_LEFT"),Kne.UP_RIGHT=new Kne(Hee.UP_RIGHT,"UP_RIGHT"),Kne.RIGHT=new Kne(new Vee(2,0),"RIGHT"),Kne.DOWN_LEFT=new Kne(Hee.DOWN_LEFT,"DOWN_LEFT"),Kne.DOWN_RIGHT=new Kne(Hee.DOWN_RIGHT,"DOWN_RIGHT"),Kne.STEPS=[Kne.LEFT,Kne.UP_LEFT,Kne.UP_RIGHT,Kne.RIGHT,Kne.DOWN_LEFT,Kne.DOWN_RIGHT];var Qne=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this)).start=e,o.step=r,o.landingCoord=i,o.capture=a,o}return Wg(n,[{key:"isTileExchange",value:function(){return this.capture.isPresent()}},{key:"toString",value:function(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}},{key:"equals",value:function(e){return!(!this.capture.equals(e.capture)||!this.start.equals(e.start)||!this.step.equals(e.step))}}],[{key:"fromMovement",value:function(e,t){if(e.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");var r=new Zee(e.x+t.direction.x,e.y+t.direction.y);if(r.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new n(fB.of(e),fB.of(t),fB.of(r),fB.empty())}},{key:"fromTilesExchange",value:function(e){if(e.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new n(fB.empty(),fB.empty(),fB.empty(),fB.of(e))}},{key:"fromCoordToCoord",value:function(e,t){var r=Kne.fromCoords(e,t);return n.fromMovement(e,r)}}]),n}(ute);Qne.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 1035}},{key:"encodeNumber",value:function(e){if(e.isTileExchange()){var t=e.capture.get().y;return 10*e.capture.get().x+t}var n=e.start.get().y,r=e.start.get().x;return 150*(e.step.get().toInt()+1)+10*r+n}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%10,n=(e=(e-t)/10)%15;return 0==(e=(e-n)/15)?Qne.fromTilesExchange(new Zee(n,t)):Qne.fromMovement(new Zee(n,t),Kne.STEPS[e-1])}}]),n}(T7));var Xne=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"getNeighbors",value:function(e){var t=new Zee(e.x-1,e.y),n=new Zee(e.x+1,e.y);return(e.x+e.y)%2==1?[t,n,new Zee(e.x,e.y-1)]:[t,n,new Zee(e.x,e.y+1)]}},{key:"getFakeNeighbors",value:function(e){return new Zee(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}},{key:"getCommonNeighbor",value:function(t,n){for(var r=e.getNeighbors(t),i=e.getNeighbors(n),a=0;a<r.length;){for(var o=r[a],s=0;s<i.length;){if(o.equals(i[s]))return fB.of(o);s++}a++}return fB.empty()}},{key:"isSpaceDark",value:function(e){return(e.x+e.y)%2==0}}]),e}(),Jne=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getEmptyNeighbors",value:function(e,t){return n.getEmptyNeighbors(this.board,e,t)}}],[{key:"getEmptyNeighbors",value:function(e,t,n){var r,i=[],a=Hg(Xne.getNeighbors(t));try{for(a.s();!(r=a.n()).done;){var o=r.value;o.isInRange(e[0].length,e.length)&&e[o.y][o.x]===n&&i.push(o)}}catch(s){a.e(s)}finally{a.f()}return i}}]),n}(ote),ere=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,e,r)).tiles=i,o.captures=a,o}return Wg(n,[{key:"applyLegalMovement",value:function(e){sB(n.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:e}});var t=e.start.get(),r=e.landingCoord.get(),i=this.getCopiedBoard();return i[r.y][r.x]=jee.ofPlayer(this.getCurrentPlayer()),i[t.y][t.x]=jee.EMPTY,new n(i,this.turn,this.tiles,this.captures)}},{key:"doMovementCaptures",value:function(e){sB(n.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:e}});var t,r=this,i=Hg(this.getCapturedNeighbors(e.landingCoord.get()));try{for(i.s();!(t=i.n()).done;){var a=t.value;r=r.capture(a)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"getCapturedNeighbors",value:function(e){var t=this,n=this.getCurrentOpponent();return Xne.getNeighbors(e).filter(function(e){return!e.isNotInRange(15,10)&&!!t.getPieceAt(e).is(n)&&t.isSurrounded(e)})}},{key:"isSurrounded",value:function(e){return 0===this.getEmptyNeighbors(e,jee.EMPTY).length}},{key:"capture",value:function(e){sB(n.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:e}});var t=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return sB(n.VERBOSE,e.toString()+" has been captured"),t[e.y][e.x]=jee.EMPTY,r[this.getCurrentPlayer().value]+=1,new n(t,this.turn,this.tiles,r)}},{key:"removeTilesIfNeeded",value:function(e,t){sB(n.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,piece:e,countTiles:t}});var r=this,i=n.getTilesUpperLeftCoord(e);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){r=this.deconnectTile(i,t);var a,o=Hg(n.getPresentNeighborEntrances(i));try{for(o.s();!(a=o.n()).done;){var s=a.value,u=r.getPieceAt(s);u===jee.EMPTY?r=r.removeTilesIfNeeded(s,t):u.is(this.getCurrentOpponent())&&r.isSurrounded(s)&&(r=r.capture(s))}}catch(c){o.e(c)}finally{o.f()}}return r}},{key:"isTileEmpty",value:function(e){v7(this.getPieceAt(e)!==jee.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(var t=0;t<2;t++)for(var n=0;n<3;n++){var r=e.getNext(new Vee(n,t),1);if(this.getPieceAt(r)!==jee.EMPTY)return!1}return!0}},{key:"isDeconnectable",value:function(e){var t=this.getPresentNeighborTilesRelativeIndexes(e);if(t.length>3)return!1;for(var n=0,r=1;r<t.length;r++)!1===this.areNeighbor(t[r-1],t[r])&&(n+=1);return!1===this.areNeighbor(t[0],t[t.length-1])&&(n+=1),n<=1}},{key:"areNeighbor",value:function(e,t){return e+1===t||0===e&&5===t}},{key:"getPresentNeighborTilesRelativeIndexes",value:function(e){for(var t=[],r=fB.empty(),i=0;i<6;i++){var a=e.getNext(n.NEIGHBORS_TILES_DIRECTIONS[i],1);a.isInRange(15,10)&&this.getPieceAt(a)!==jee.UNREACHABLE&&(r.isAbsent()&&(r=fB.of(i)),t.push(i-r.get()))}return t}},{key:"deconnectTile",value:function(e,t){sB(n.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:e,countTiles:t}});for(var r=this.getCopiedBoard(),i=e.x,a=e.y,o=0;o<2;o++)for(var s=0;s<3;s++)r[a+o][i+s]=jee.UNREACHABLE;var u=[this.tiles[0],this.tiles[1]];return t&&(u[this.getCurrentPlayer().value]+=1),new n(r,this.turn,u,this.captures)}},{key:"getLegalLandings",value:function(e){var t,n=[],r=Hg(Kne.STEPS);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=e.getNext(i.direction,1);this.isOnBoard(a)&&this.getPieceAt(a)===jee.EMPTY&&n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPiecesByFreedom",value:function(){for(var e=[[0,0,0,0],[0,0,0,0]],t=0;t<10;t++)for(var n=0;n<15;n++){var r=this.board[t][n];if(r.isPlayer()){var i=this.getEmptyNeighbors(new Zee(n,t),jee.EMPTY).length;e[r.value][i]=e[r.value][i]+1}}return e}}],[{key:"getTilesUpperLeftCoord",value:function(e){var t=e.x-e.x%3,n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new Zee(t,n)}},{key:"getPresentNeighborEntrances",value:function(e){return[new Zee(e.x+1,e.y-1),new Zee(e.x+3,e.y+0),new Zee(e.x+3,e.y+1),new Zee(e.x+1,e.y+2),new Zee(e.x-1,e.y+1),new Zee(e.x-1,e.y+0)].filter(n.isInRange)}},{key:"getInitialState",value:function(){var e=jee.EMPTY,t=jee.UNREACHABLE,r=jee.ZERO,i=jee.ONE;return new n([[t,t,t,t,t,t,r,e,r,t,t,t,t,t,t],[t,t,t,e,e,r,e,e,e,r,e,e,t,t,t],[e,i,e,i,e,e,r,e,r,e,e,i,e,i,e],[i,e,e,e,i,e,e,e,e,e,i,e,e,e,i],[e,i,e,i,e,e,e,e,e,e,e,i,e,i,e],[e,r,e,r,e,e,e,e,e,e,e,r,e,r,e],[r,e,e,e,r,e,e,e,e,e,r,e,e,e,r],[e,r,e,r,e,e,i,e,i,e,e,r,e,r,e],[t,t,t,e,e,i,e,e,e,i,e,e,t,t,t],[t,t,t,t,t,t,i,e,i,t,t,t,t,t,t]],0,[0,0],[0,0])}}]),n}(Jne);ere.VERBOSE=!1,ere.NEIGHBORS_TILES_DIRECTIONS=[new Vee(0,-2),new Vee(3,-1),new Vee(3,1),new Vee(0,2),new Vee(-3,1),new Vee(-3,-1)],ere.isInRange=function(e){return e.isInRange(15,10)};var tre=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isTileExchange()?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}},{key:"applyLegalTileExchange",value:function(e,t){var r=t.getCopiedBoard(),i=e.capture.get();r[i.y][i.x]=jee.EMPTY;var a=[t.captures[0],t.captures[1]];a[t.getCurrentPlayer().value]+=1;var o=[t.tiles[0],t.tiles[1]];o[t.getCurrentPlayer().value]-=2;var s=new ere(r,t.turn,o,a),u=s.removeTilesIfNeeded(i,!1),c=new ere(u.getCopiedBoard(),u.turn+1,u.tiles,u.captures);return sB(n.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:t,afterCapture:s,afterTileRemoval:u,resultingState:c}}),c}},{key:"applyLegalMovement",value:function(e,t){var r=t.applyLegalMovement(e),i=r.removeTilesIfNeeded(e.start.get(),!0),a=i.doMovementCaptures(e),o=new ere(a.board,t.turn+1,a.tiles,a.captures);return sB(n.VERBOSE,{ab_state:t,afterMovement:r,afterTilesRemoved:i,afterCaptures:a,resultingState:o}),o}},{key:"isLegal",value:function(e,t){return e.isTileExchange()?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}},{key:"isLegalTileExchange",value:function(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return hB.failure(Yne.NOT_ENOUGH_TILES_TO_EXCHANGE());var n=t.getPieceAt(e.capture.get());return n===jee.UNREACHABLE||n===jee.EMPTY?hB.failure(Yne.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?hB.failure(Yne.CANNOT_CAPTURE_OWN_PIECES()):hB.success(void 0)}},{key:"isLegalMovement",value:function(e,t){if(t.getPieceAt(e.start.get())===jee.UNREACHABLE){var n="Cannot start with a coord outside the board "+e.start.get().toString()+".";return hB.failure(n)}if(t.getPieceAt(e.landingCoord.get())===jee.UNREACHABLE){var r="Cannot end with a coord outside the board "+e.landingCoord.get().toString()+".";return hB.failure(r)}var i=t.getPieceAt(e.start.get());return i===jee.EMPTY?hB.failure(ete.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):i.is(t.getCurrentOpponent())?hB.failure(ete.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(e.landingCoord.get()).is(t.getCurrentPlayer())?hB.failure(ete.MUST_LAND_ON_EMPTY_SPACE()):hB.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captures[0]>=18?gte.ZERO_WON:t.captures[1]>=18?gte.ONE_WON:gte.ONGOING}}]),n}(yte);return e.VERBOSE=!1,e}(),nre=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),this.putCaptureFirst(e,t)}},{key:"getListExchanges",value:function(e){var t=[],n=e.gameState,r=n.getCurrentPlayer().value,i=jee.ofPlayer(n.getCurrentOpponent());if(n.tiles[r]<2)return t;for(var a=0;a<10;a++)for(var o=0;o<15;o++){var s=new Zee(o,a);if(n.getPieceAt(s)===i){var u=Qne.fromTilesExchange(s);t.push(u)}}return t}},{key:"getListMovement",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<10;i++)for(var a=0;a<15;a++){var o=new Zee(a,i);if(n.getPieceAt(o).is(r)){var s,u=Hg(n.getLegalLandings(o));try{for(u.s();!(s=u.n()).done;){var c=s.value,l=Qne.fromCoordToCoord(o,c);t.push(l)}}catch(f){u.e(f)}finally{u.f()}}}return t}},{key:"getBoardValue",value:function(e){var t=tre.getGameStatus(e);if(t.isEndGame)return nte.fromWinner(t.winner);var n=e.gameState,r=n.getPiecesByFreedom(),i=this.getPiecesScore(r);return new nte(2*n.captures[1]+i[1]-(2*n.captures[0]+i[0]))}},{key:"getPiecesScore",value:function(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}},{key:"getPlayerPiecesScore",value:function(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}},{key:"putCaptureFirst",value:function(e,t){var n=this;return D7.sortByDescending(t,function(t){return n.moveCapturesList(e,t).length}),t}},{key:"moveCapturesList",value:function(e,t){return t.isTileExchange()?[t.capture.get()]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.start.get(),!0).getCapturedNeighbors(t.landingCoord.get())}}]),n}(tte),rre=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getBoardValue",value:function(e){var t=tre.getGameStatus(e);if(t.isEndGame)return nte.fromWinner(t.winner);var r,i=e.gameState,a=this.getPiecesMap(i),o=this.getThreatMap(i,a),s=this.filterThreatMap(o,i),u=0,c=Hg(R7.PLAYERS);try{for(c.s();!(r=c.n()).done;){var l,f=r.value,h=Hg(a.get(f).get());try{for(h.s();!(l=h.n()).done;){var d=l.value;s.get(d).isPresent()?u+=f.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE:u+=f.getScoreModifier()*n.SCORE_BY_SAFE_PIECE}}catch(v){h.e(v)}finally{h.f()}}}catch(v){c.e(v)}finally{c.f()}return u+=i.tiles[1]-i.tiles[0],new nte(u)}},{key:"getPiecesMap",value:function(e){for(var t=new hte,n=[],r=[],i=0;i<10;i++)for(var a=0;a<15;a++){var o=new Zee(a,i),s=e.getPieceAt(o);s===jee.ZERO?n.push(o):s===jee.ONE&&r.push(o)}return t.set(R7.ZERO,new One(n)),t.set(R7.ONE,new One(r)),t}},{key:"getThreatMap",value:function(e,t){var n,r=new hte,i=Hg(R7.PLAYERS);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=Hg(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreat(u,e);c.isPresent()&&r.set(u,c.get())}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return r}},{key:"getThreat",value:function(e,t){var n,r=R7.of(t.getPieceAt(e).value).getOpponent(),i=fB.empty(),a=fB.empty(),o=[],s=Xne.getNeighbors(e).filter(function(e){return e.isInRange(15,10)}),u=Hg(s);try{for(u.s();!(n=u.n()).done;){var c=n.value,l=t.getPieceAt(c);if(l.is(r))o.push(c),this.tileCouldBeRemovedThisTurn(c,t,r)&&(a=fB.of(c));else if(l===jee.EMPTY){if(i.isPresent())return fB.empty();i=fB.of(c)}}}catch(g){u.e(g)}finally{u.f()}if(i.isPresent()){var f,h=[],d=Hg(Kne.STEPS);try{var v=function(){var e=f.value,n=i.get().getNext(e.direction,1);n.isInRange(15,10)&&t.getPieceAt(n).is(r)&&!1===o.some(function(e){return e.equals(n)})&&h.push(n)};for(d.s();!(f=d.n()).done;)v()}catch(g){d.e(g)}finally{d.f()}if(h.length>0)return fB.of(new Pne(new One(o),new One(h)))}if(a.isPresent()){o=o.filter(function(e){return e.equals(a.get())});var p=new One(o);return fB.of(new Pne(p,new One([a.get()])))}return fB.empty()}},{key:"tileCouldBeRemovedThisTurn",value:function(e,t,n){var r=n.getOpponent();if(!1===t.isDeconnectable(e))return!1;for(var i=fB.empty(),a=ere.getTilesUpperLeftCoord(e),o=0;o<2;o++)for(var s=0;s<3;s++){var u=a.getNext(new Vee(s,o),1);if(t.getPieceAt(u).is(n)){if(!this.pieceCouldLeaveTheTile(u,t))return!1;i=fB.of(u)}else if(t.getPieceAt(u).is(r))return!1}return i.isPresent()}},{key:"pieceCouldLeaveTheTile",value:function(e,t){var n,r=ere.getTilesUpperLeftCoord(e),i=Hg(Kne.STEPS);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=e.getNext(a.direction,1),s=ere.getTilesUpperLeftCoord(o);if(!1===r.equals(s)&&t.getPieceAt(o)===jee.EMPTY)return!0}}catch(u){i.e(u)}finally{i.f()}return!1}},{key:"filterThreatMap",value:function(e,t){var n,r=new hte,i=e.listKeys(),a=i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentPlayer())}),o=new One(i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentOpponent())})),s=Hg(a);try{for(s.s();!(n=s.n()).done;){var u,c=n.value,l=e.get(c).get(),f=fB.empty(),h=Hg(l.directThreats);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(!1===o.contains(d)){var v,p=[],g=Hg(l.mover);try{for(g.s();!(v=g.n()).done;){var y=v.value;!1===o.contains(y)&&p.push(y)}}catch(_){g.e(_)}finally{g.f()}p.length>0&&(f=fB.of(new Pne(l.directThreats,new One(p))))}}}catch(_){h.e(_)}finally{h.f()}f.isPresent()&&r.set(c,f.get())}}catch(_){s.e(_)}finally{s.f()}var m,k=Hg(o);try{for(k.s();!(m=k.n()).done;){var C=m.value,w=e.get(C).get();r.set(C,w)}}catch(_){k.e(_)}finally{k.f()}return r}}]),n}(nre);return e.SCORE_BY_THREATENED_PIECE=1e3,e.SCORE_BY_SAFE_PIECE=1e6,e}(),ire=jee.EMPTY,are=jee.UNREACHABLE,ore=jee.ZERO,sre=jee.ONE,ure=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(Nt||(Nt=_g(["Board and goal of the game"]))),$localize(Dt||(Dt=_g(["Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.\n         The triangles are the spaces on which pieces move during the game.\n         The tiles can be removed from the board (you will see how later).\n         The dark pieces belong to the first player and can only move on the dark spaces,\n         while the light pieces belong to the second player and can only move on the light spaces.\n         The goal of the game is to capture all of the opponent's pieces."]))),ere.getInitialState()),wte.anyMove($localize(Lt||(Lt=_g(["Move"]))),$localize(Ft||(Ft=_g(["To move a piece, you need to:\n        <ol>\n          <li>Click on one of your pieces.</li>\n          <li>Click on one of the triangular space highlighted in yellow.</li>\n        </ol>\n        You can pass through the opponent's pieces.\n        You're playing first, hence you're playing Dark.<br/><br/>\n        Perform any move."]))),ere.getInitialState(),Qne.fromCoordToCoord(new Zee(3,5),new Zee(5,5)),$localize(Ut||(Ut=_g(["Congratulations! Let's see captures now."])))),wte.fromMove($localize(Vt||(Vt=_g(["Capture"]))),$localize(Bt||(Bt=_g(["Every piece has three neighboring triangular spaces (2 on the sides).\n        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!\n        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>\n        You're playing Light, make a capture."]))),new ere([[are,are,are,are,are,are,ore,ire,ore,are,are,are,are,are,are],[are,are,are,ore,ire,ire,ire,ire,ire,ore,ire,ire,are,are,are],[ire,sre,ire,sre,ore,sre,ire,ire,ore,ire,ire,sre,ire,sre,ire],[sre,ire,ire,ire,ire,ire,ire,ire,ire,ire,sre,ire,ire,ire,sre],[ire,sre,ire,sre,ire,ire,ire,ire,ire,ire,ire,sre,ire,sre,ire],[ire,ore,ire,ore,ire,ire,ire,ire,ire,ire,ire,ore,ire,ore,ire],[ore,ire,ire,ire,ore,ire,ire,ire,ire,ire,ore,ire,ire,ire,ore],[ire,ore,ire,ore,ire,ire,sre,ire,sre,ire,ire,ore,ire,ore,ire],[are,are,are,ire,ire,sre,ire,ire,ire,sre,ire,ire,are,are,are],[are,are,are,are,are,are,sre,ire,sre,are,are,are,are,are,are]],3,[0,0],[0,0]),[Qne.fromCoordToCoord(new Zee(5,2),new Zee(4,1)),Qne.fromCoordToCoord(new Zee(3,4),new Zee(4,3))],$localize(zt||(zt=_g(["Congratulations!"]))),$localize(Ht||(Ht=_g(["Failed, you have not captured any piece."])))),wte.fromMove($localize(Gt||(Gt=_g(["Gain a tile"]))),$localize($t||($t=_g(["When a tile is empty, it can become removable from the board.\n        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.\n        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.\n        For example, here, the topmost dark piece will not disconnect its tile when leaving it.\n        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>\n        Perform a move that lets you gain two tiles."]))),new ere([[are,are,are,are,are,are,ire,ire,ire,are,are,are,are,are,are],[are,are,are,are,are,are,sre,ire,ire,are,are,are,are,are,are],[ire,ire,ire,are,are,are,ire,ire,ire,are,are,are,are,are,are],[ire,ire,sre,ire,ire,ire,ire,ore,ire,are,are,are,are,are,are],[ire,ire,ire,sre,ire,ire,ire,ire,ire,are,are,are,are,are,are],[ire,ire,ire,ire,ire,ire,ire,ire,ire,ire,ire,ore,are,are,are],[ire,ire,ore,ire,ire,sre,ire,ire,ire,ire,ore,ire,ire,ire,ore],[ire,ire,ire,ire,ire,ire,sre,ire,sre,ire,ire,ore,ire,ore,ire],[are,are,are,ire,ire,sre,ire,ire,ire,sre,ire,ire,are,are,are],[are,are,are,are,are,are,sre,ire,sre,are,are,are,are,are,are]],2,[0,0],[0,0]),[Qne.fromCoordToCoord(new Zee(2,6),new Zee(4,6)),Qne.fromCoordToCoord(new Zee(2,6),new Zee(3,5)),Qne.fromCoordToCoord(new Zee(2,6),new Zee(3,7))],$localize(Zt||(Zt=_g(["Congratulations!"]))),$localize(qt||(qt=_g(["Failed, you have not gained the two tiles that you could, try again!"])))),wte.fromMove($localize(Wt||(Wt=_g(["Exchanging a tile"]))),$localize(jt||(jt=_g(["When you have a tile, you can see it on the left of the board.\n        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.\n        This will cost you two tiles.\n        If any tiles are removed during that turn, nobody will get them.<br/><br/>\n        Gain some time and capture the last piece!"]))),new ere([[are,are,are,are,are,are,are,are,are,are,are,are,are,are,are],[are,are,are,are,are,are,are,are,are,are,are,are,are,are,are],[are,are,are,are,are,are,are,are,are,are,are,are,are,are,are],[are,are,are,are,are,are,are,are,are,are,are,are,are,are,are],[are,are,are,are,are,are,are,are,are,are,are,are,are,are,are],[are,are,are,ire,ire,ore,are,are,are,are,are,are,are,are,are],[are,are,are,ire,ire,ire,ire,ire,ire,are,are,are,are,are,are],[are,are,are,ire,ire,ire,sre,ire,sre,are,are,are,are,are,are],[are,are,are,ire,ire,sre,ire,ire,ire,are,are,are,are,are,are],[are,are,are,are,are,are,sre,ire,sre,are,are,are,are,are,are]],1,[0,2],[0,0]),[Qne.fromTilesExchange(new Zee(5,5))],$localize(Yt||(Yt=_g(["Congratulations!"]))),$localize(Kt||(Kt=_g(["It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!"])))),wte.fromMove($localize(Qt||(Qt=_g(["Special capture"]))),$localize(Xt||(Xt=_g(["When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!\n        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>\n        A move that demonstrate both of these things can be done on this board by Light. Try it!"]))),new ere([[are,are,are,are,are,are,are,are,are,are,are,are,are,are,are],[are,are,are,are,are,are,are,are,are,are,are,are,are,are,are],[are,are,are,are,are,are,are,are,are,are,are,are,are,are,are],[are,are,are,are,are,are,are,are,are,are,are,are,are,are,are],[are,are,are,are,are,are,ire,ire,ore,are,are,are,are,are,are],[are,are,are,ire,ire,ore,ire,ire,ire,are,are,are,are,are,are],[are,are,are,ire,ore,sre,ire,sre,ire,are,are,are,are,are,are],[are,are,are,ire,sre,ore,ire,ire,ire,are,are,are,are,are,are],[are,are,are,ire,ire,sre,are,are,are,are,are,are,are,are,are],[are,are,are,are,are,are,are,are,are,are,are,are,are,are,are]],1,[0,0],[0,0]),[Qne.fromCoordToCoord(new Zee(7,6),new Zee(6,5)),Qne.fromCoordToCoord(new Zee(7,6),new Zee(8,5))],$localize(Jt||(Jt=_g(["Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.\n        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space."]))),$localize(en||(en=_g(["Failed!"]))))]});function cre(e,t){if(1&e&&(cC(),nP(0,"polygon",13)),2&e){var n=fP().index,r=fP().index,i=fP();Xb("ngClass",i.getPyramidClass(n,r)),$b("points",i.getPyramidCoordinate(n,r))}}function lre(e,t){if(1&e&&(cC(),nP(0,"polygon",15)),2&e){var n=fP(2).index,r=fP().index,i=fP();Xb("ngClass",i.getEmptyClass(n,r)),$b("points",i.getTriangleCoordinate(n,r))}}function fre(e,t){if(1&e&&(cC(),Yb(0,lre,1,2,"polygon",14)),2&e){var n=fP().index,r=fP().index;Xb("ngIf",fP().isEmptyCase(n,r))}}function hre(e,t){if(1&e&&(cC(),nP(0,"polygon",16)),2&e){var n=fP().index,r=fP().index,i=fP();vP("id","dark_line_",n,"_",r,""),$b("points",i.getLineCoordinate(n,r))}}function dre(e,t){if(1&e&&(cC(),nP(0,"polygon",17)),2&e){var n=fP().index,r=fP().index,i=fP();vP("id","dark_line_",n,"_",r,""),$b("points",i.getLineCoordinate(n,r))}}function vre(e,t){if(1&e){var n=aP();cC(),eP(0,"g",8),uP("click",function(){var e=Nk(n).index,t=fP().index;return fP().onClick(e,t)}),Yb(1,cre,1,2,"polygon",9),Yb(2,fre,1,1,"ng-template",null,10,MT),Yb(4,hre,1,3,"polygon",11),Yb(5,dre,1,3,"polygon",12),tP()}if(2&e){var r=t.$implicit,i=t.index,a=Kb(3),o=fP().index,s=fP();vP("id","click_",i,"_",o,""),pE(1),Xb("ngIf",s.isPyramid(i,o))("ngIfElse",a),pE(3),Xb("ngIf",r!==s.NONE),pE(1),Xb("ngIf",r!==s.NONE)}}function pre(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,vre,6,6,"g",7),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}function gre(e,t){if(1&e&&(cC(),nP(0,"polygon",18)),2&e){var n=t.$implicit;$b("points",fP().getTriangleCoordinate(n.x,n.y))}}function yre(e,t){if(1&e&&(cC(),nP(0,"polygon",19)),2&e){var n=fP();$b("points",n.getTriangleCoordinate(n.lastStart.get().x,n.lastStart.get().y))}}function mre(e,t){if(1&e&&(cC(),nP(0,"polygon",19)),2&e){var n=fP();$b("points",n.getTriangleCoordinate(n.lastEnd.get().x,n.lastEnd.get().y))}}function kre(e,t){if(1&e&&(cC(),nP(0,"polygon",20)),2&e){var n=fP();$b("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}function Cre(e,t){if(1&e&&(cC(),eP(0,"g",21),nP(1,"polygon",22),eP(2,"text",23),FP(3),tP(),tP()),2&e){var n=fP();pE(1),$b("points",n.getTilesCountCoordinate(0,0))("stroke",n.lastTurnWasTilesExchange(0)?"yellow":"black"),pE(1),$b("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+0*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),pE(1),UP(n.tiles[0])}}function wre(e,t){if(1&e&&(cC(),eP(0,"g",24),nP(1,"polygon",25),eP(2,"text",26),FP(3),tP(),tP()),2&e){var n=fP();pE(1),$b("points",n.getTilesCountCoordinate(0,9))("stroke",n.lastTurnWasTilesExchange(1)?"yellow":"black"),pE(1),$b("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+9*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),pE(1),UP(n.tiles[1])}}var _re=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).tiles=[0,0],r.NONE=jee.UNREACHABLE,r.chosenCoord=fB.empty(),r.lastStart=fB.empty(),r.lastEnd=fB.empty(),r.highlights=[],r.scores=fB.of([0,0]),r.rules=new tre(ere),r.availableMinimaxes=[new nre(r.rules,"Normal"),new rre(r.rules,"Piece > Threat > Tiles")],r.encoder=Qne.encoder,r.tutorial=(new ure).tutorial,r.SPACE_SIZE=70,r.updateBoard(),r}return Wg(n,[{key:"updateBoard",value:function(){this.chosenCoord=fB.empty(),this.state=this.rules.node.gameState,this.scores=fB.of(this.state.captures),this.tiles=this.state.tiles;var e=this.rules.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=fB.empty(),this.lastEnd=fB.empty()),this.board=this.rules.node.gameState.board}},{key:"showHighlight",value:function(){this.highlights=this.state.getLegalLandings(this.chosenCoord.get())}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=fB.empty(),this.highlights=[]}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new Zee(e,t),r.abrupt("return",n.chosenCoord.isAbsent()?n.firstClick(a):n.secondClick(a));case 5:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.state.getPieceAt(e)).is(t.state.getCurrentOpponent())){n.next=4;break}return i=Qne.fromTilesExchange(e),n.abrupt("return",t.chooseMove(i,t.state,t.state.captures));case 4:return n.abrupt("return",r.is(t.state.getCurrentPlayer())?(t.chosenCoord=fB.of(e),t.showHighlight(),pB.SUCCESS):t.cancelMove(Yne.FIRST_CLICK_SHOULD_NOT_BE_NULL()));case 5:case"end":return n.stop()}},n)}))()}},{key:"secondClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.equals(t.chosenCoord.get())){n.next=2;break}return n.abrupt("return",(t.cancelMoveAttempt(),pB.SUCCESS));case 2:if(!t.highlights.some(function(t){return t.equals(e)})){n.next=5;break}return r=Qne.fromCoordToCoord(t.chosenCoord.get(),e),n.abrupt("return",t.chooseMove(r,t.state,t.state.captures));case 5:return n.abrupt("return",t.cancelMove(Yne.INVALID_DISTANCE()));case 6:case"end":return n.stop()}},n)}))()}},{key:"isPyramid",value:function(e,t){return this.board[t][e].isPlayer()||this.wasOpponent(e,t)}},{key:"wasOpponent",value:function(e,t){var n=this.rules.node.mother;return n.isPresent()&&n.get().gameState.getPieceAtXY(e,t).is(n.get().gameState.getCurrentOpponent())}},{key:"getPyramidClass",value:function(e,t){var n=this.board[t][e];return n===jee.ZERO?this.getPlayerClass(R7.ZERO):n===jee.ONE?this.getPlayerClass(R7.ONE):"captured"}},{key:"isEmptyCase",value:function(e,t){return this.board[t][e]===jee.EMPTY||this.wasRemoved(e,t)}},{key:"wasRemoved",value:function(e,t){var n=this.rules.node.mother;if(this.board[t][e]===jee.UNREACHABLE&&n.isPresent()){var r=n.get().gameState.getPieceAtXY(e,t);return r===jee.EMPTY||r.is(n.get().gameState.getCurrentPlayer())}return!1}},{key:"getEmptyClass",value:function(e,t){return this.board[t][e]===jee.EMPTY?(e+t)%2==1?"background":"background2":"captured2"}},{key:"getTilesCountCoordinate",value:function(e,t){var n=100*e,r=100*t,i=n+25;return i+", "+r+", "+(n+75)+", "+r+", "+(n+100)+", "+(r+50)+", "+(n+75)+", "+(r+100)+", "+(n+25)+", "+(r+100)+", "+(n+0)+", "+(r+50)+", "+i+", "+r}},{key:"getLineCoordinate",value:function(e,t){var n=this.getTriangleCornerCoords(e,t);return e%3==0?n[0].x+","+n[0].y+","+n[1].x+","+n[1].y:e%3==1?n[0].x+","+n[0].y+","+n[2].x+","+n[2].y:n[1].x+","+n[1].y+","+n[2].x+","+n[2].y}},{key:"mustShowTilesOf",value:function(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}},{key:"lastTurnWasTilesExchange",value:function(e){return!this.rules.node.mother.isAbsent()&&this.rules.node.mother.get().gameState.tiles[e]>this.tiles[e]}}]),n}(jne);return e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-coerceo"]],features:[Rb],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill highlighted",4,"ngFor","ngForOf"],["class","base no-fill last-move",4,"ngIf"],["class","base no-fill selected",4,"ngIf"],["id","tilesCountZero",4,"ngIf"],["id","tilesCountOne",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptyCase",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","last-move"],[1,"base","no-fill","selected"],["id","tilesCountZero"],["stroke-linecap","round",1,"base","player0"],["id","playerZeroTilesCount","text-anchor","middle",1,"text"],["id","tilesCountOne"],["stroke-linecap","round",1,"base","player1"],["id","playerOneTilesCount","text-anchor","middle",1,"text"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),Yb(1,pre,2,1,"g",1),Yb(2,gre,1,1,"polygon",2),Yb(3,yre,1,1,"polygon",3),Yb(4,mre,1,1,"polygon",3),Yb(5,kre,1,1,"polygon",4),Yb(6,Cre,4,6,"g",5),Yb(7,wre,4,6,"g",6),tP()),2&e&&($b("viewBox","-5 -5 "+(10+8*t.SPACE_SIZE)+" "+(10+10*t.SPACE_SIZE)),pE(1),Xb("ngForOf",t.board),pE(1),Xb("ngForOf",t.highlights),pE(1),Xb("ngIf",t.lastStart.isPresent()),pE(1),Xb("ngIf",t.lastEnd.isPresent()),pE(1),Xb("ngIf",t.chosenCoord.isPresent()),pE(1),Xb("ngIf",t.mustShowTilesOf(0)),pE(1),Xb("ngIf",t.mustShowTilesOf(1)))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Ere=function(){var e=Wg(function e(){Zg(this,e)});return e.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=function(){return $localize(tn||(tn=_g(["Your piece should land on a neighboring square."])))},e.CANNOT_DROP_AFTER_TURN_40=function(){return $localize(nn||(nn=_g(["You cannot drop a piece during the moving phase."])))},e.CANNOT_MOVE_BEFORE_TURN_40=function(){return $localize(rn||(rn=_g(["You cannot move a piece before both players have dropped all of their pieces."])))},e.MUST_JUMP_OVER_PIECES=function(){return $localize(an||(an=_g(["A jump must be made over a piece, not over an empty square."])))},e.MUST_DROP_IN_CENTRAL_ZONE=function(){return $localize(on||(on=_g(["A drop must occur in the central zone of the board."])))},e.INVALID_JUMP=function(){return $localize(sn||(sn=_g(["A jump must land two squares from its original position, and be done in a straight line in any direction."])))},e.SAME_LOCATION_VISITED_IN_JUMP=function(){return $localize(un||(un=_g(["You are visiting the same location twice in a move, you are not allowed to do so."])))},e}(),bre=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isShelter",value:function(e){return 0===e.x||e.x===n.WIDTH-1?n.SHELTERS_INDICES.some(function(t){return e.y===t}):(0===e.y||e.y===n.HEIGHT-1)&&n.SHELTERS_INDICES.some(function(t){return e.x===t})}},{key:"isCentralZone",value:function(e){return e.x>=n.CENTRAL_ZONE_TOP_LEFT.x&&e.x<=n.CENTRAL_ZONE_BOTTOM_RIGHT.x&&e.y>=n.CENTRAL_ZONE_TOP_LEFT.y&&e.y<=n.CENTRAL_ZONE_BOTTOM_RIGHT.y}},{key:"isDropPhase",value:function(){return this.turn<40}},{key:"getSidePieces",value:function(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}],[{key:"getInitialState",value:function(){return new n(D7.createTable(n.WIDTH,n.HEIGHT,A7.NONE),0)}}]),n}(ote);bre.WIDTH=17,bre.HEIGHT=17,bre.CENTRAL_ZONE_TOP_LEFT=new Zee(4,6),bre.CENTRAL_ZONE_BOTTOM_RIGHT=new Zee(12,10),bre.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],bre.ALL_SHELTERS=new ite(bre.SHELTERS_INDICES.flatMap(function(e){return[new Zee(e,0),new Zee(e,bre.HEIGHT-1),new Zee(0,e),new Zee(bre.WIDTH-1,e)]})).toList();var Pre=function(e){xg(n,e);var t=Dg(n);function n(e){return Zg(this,n),t.call(this,e.x,e.y)}return Wg(n,[{key:"toString",value:function(){return"ConspirateursMoveDrop(".concat(this.coord.toString(),")")}},{key:"equals",value:function(e){return!!e.isDrop()&&this.coord.equals(e.coord)}},{key:"isDrop",value:function(){return!0}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e){return e.isInRange(bre.WIDTH,bre.HEIGHT)?hB.success(new n(e)):hB.failure("Move out of board")}}]),n}(cte);Pre.encoder=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"getEncoder",value:function(e,t,n){return new(function(r){xg(a,r);var i=Dg(a);function a(){var e;return Zg(this,a),(e=i.apply(this,arguments)).shiftX=t,e}return Wg(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftX+e.coord.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new Zee((r-=r%1)%e,i);return n(a)}}]),a}(T7))}}]),e}().getEncoder(bre.WIDTH,bre.HEIGHT,function(e){return Pre.of(e).get()});var Sre=function(e){xg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,r)}return Wg(n,[{key:"toString",value:function(){return"ConspirateursMoveSimple(".concat(this.coord.toString()," -> ").concat(this.end.toString(),")")}},{key:"equals",value:function(e){return!(!e.isSimple()||e!==this&&(!1===e.coord.equals(this.coord)||!1===e.end.equals(this.end)))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!0}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e,t){return e.isInRange(bre.WIDTH,bre.HEIGHT)&&t.isInRange(bre.WIDTH,bre.HEIGHT)?e.isAlignedWith(t)&&1===e.getDistance(t)?hB.success(new n(e,t)):hB.failure(Ere.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):hB.failure("Move out of board")}}]),n}(hne);Sre.encoder=hne.getEncoder(bre.WIDTH,bre.HEIGHT,function(e,t){return Sre.of(e,t).get()});var Ore=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).coords=e,r}return Wg(n,[{key:"addJump",value:function(e){var t=D7.copyImmutableArray(this.coords);return t.push(e),n.of(t)}},{key:"getStartingCoord",value:function(){return this.coords[0]}},{key:"getEndingCoord",value:function(){return this.coords[this.coords.length-1]}},{key:"getLandingCoords",value:function(){return this.coords.slice(1)}},{key:"getJumpedOverCoords",value:function(){for(var e=[],t=1;t<this.coords.length;t++){var n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}},{key:"toString",value:function(){return"ConspirateursMoveJump(".concat(this.coords.map(function(e){return e.toString()}).reduce(function(e,t){return e+" -> "+t}),")")}},{key:"equals",value:function(e){return!(e.isSimple()||e.isDrop()||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!0}}],[{key:"of",value:function(e){if(e.length<2)return hB.failure("ConspirateursMoveJump requires at least one jump, so two coords");var t,r=Hg(e);try{for(r.s();!(t=r.n()).done;){if(t.value.isNotInRange(bre.WIDTH,bre.HEIGHT))return hB.failure("Move out of board")}}catch(a){r.e(a)}finally{r.f()}for(var i=1;i<e.length;i++)if(e[i-1].getDirectionToward(e[i]).isFailure()||2!==e[i-1].getDistance(e[i]))return hB.failure(Ere.INVALID_JUMP());return new One(e).size()===e.length?hB.success(new n(e)):hB.failure(Ere.SAME_LOCATION_VISITED_IN_JUMP())}}]),n}(ute);Ore.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).coordEncoder=Zee.numberEncoder(bre.WIDTH,bre.HEIGHT),e}return Wg(n,[{key:"encodeMove",value:function(e){return{coords:e.coords.map(this.coordEncoder.encodeNumber)}}},{key:"decodeMove",value:function(e){v7(null!=oB.getNonNullable(e).coords,"Encoded ConspirateursMoveJump should contain coords");var t=oB.getNonNullable(e).coords.map(this.coordEncoder.decodeNumber);return Ore.of(t).get()}}]),n}(O7));var Tre=O7.disjunction3(Pre.encoder,Sre.encoder,Ore.encoder,function(e){return e.isDrop()},function(e){return e.isSimple()}),Ire=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.call(this,bre)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();if(e.isDrop())r[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(e.isSimple())r[e.coord.y][e.coord.x]=A7.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer();else{var i=e.getStartingCoord(),a=e.getEndingCoord();r[i.y][i.x]=A7.NONE,r[a.y][a.x]=t.getCurrentPlayer()}return new bre(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.dropLegality(e,t):e.isSimple()?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}},{key:"dropLegality",value:function(e,t){return t.turn>=40?hB.failure(Ere.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord).isPlayer()?hB.failure(ete.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?hB.failure(Ere.MUST_DROP_IN_CENTRAL_ZONE()):hB.success(void 0)}},{key:"simpleMoveLegality",value:function(e,t){return t.turn<40?hB.failure(Ere.CANNOT_MOVE_BEFORE_TURN_40()):t.getPieceAt(e.coord)!==t.getCurrentPlayer()?hB.failure(ete.MUST_CHOOSE_PLAYER_PIECE()):t.getPieceAt(e.end).isPlayer()?hB.failure(ete.MUST_LAND_ON_EMPTY_SPACE()):hB.success(void 0)}},{key:"jumpLegality",value:function(e,t){if(t.turn<40)return hB.failure(Ere.CANNOT_MOVE_BEFORE_TURN_40());if(t.getPieceAt(e.getStartingCoord())!==t.getCurrentPlayer())return hB.failure(ete.MUST_CHOOSE_PLAYER_PIECE());var n,r=Hg(e.getJumpedOverCoords());try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.getPieceAt(i)===A7.NONE)return hB.failure(Ere.MUST_JUMP_OVER_PIECES())}}catch(u){r.e(u)}finally{r.f()}var a,o=Hg(e.getLandingCoords());try{for(o.s();!(a=o.n()).done;){var s=a.value;if(t.getPieceAt(s).isPlayer())return hB.failure(ete.MUST_LAND_ON_EMPTY_SPACE())}}catch(u){o.e(u)}finally{o.f()}return hB.success(void 0)}},{key:"jumpTargetsFrom",value:function(e){for(var t=[],n=0,r=[new Zee(e.x+2,e.y),new Zee(e.x-2,e.y),new Zee(e.x,e.y+2),new Zee(e.x,e.y-2),new Zee(e.x+2,e.y+2),new Zee(e.x+2,e.y-2),new Zee(e.x-2,e.y+2),new Zee(e.x-2,e.y-2)];n<r.length;n++){var i=r[n];Ore.of([e,i]).isSuccess()&&t.push(i)}return t}},{key:"nextJumps",value:function(e,t){var n,r=e.getEndingCoord(),i=[],a=Hg(this.jumpTargetsFrom(r));try{for(a.s();!(n=a.n()).done;){var o=n.value,s=e.addJump(o);s.isSuccess()&&this.jumpLegality(s.get(),t).isSuccess()&&i.push(s.get())}}catch(u){a.e(u)}finally{a.f()}return i}},{key:"jumpHasPossibleNextTargets",value:function(e,t){return this.nextJumps(e,t).length>0}},{key:"getGameStatus",value:function(e){var t,n=e.gameState,r=[0,0],i=Hg(bre.ALL_SHELTERS);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=n.getPieceAt(a);if(o.isPlayer()&&(r[o.value]+=1,20===r[o.value]))return gte.getVictory(o)}}catch(s){i.e(s)}finally{i.f()}return gte.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=fB.of(new n)),n.singleton.get()}}]),n}(yte);Ire.singleton=fB.empty();var Are=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){return e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState)}},{key:"getListMovesDrop",value:function(e){for(var t=[],n=bre.CENTRAL_ZONE_TOP_LEFT,r=bre.CENTRAL_ZONE_BOTTOM_RIGHT,i=n.y;i<=r.y;i++)for(var a=n.x;a<=r.x;a++)e.getPieceAtXY(a,i)===A7.NONE&&t.push(Pre.of(new Zee(a,i)).get());return t}},{key:"getListMovesAfterDrop",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<bre.HEIGHT;r++)for(var i=0;i<bre.WIDTH;i++){var a=new Zee(i,r);e.getPieceAt(a)===n&&(t=(t=t.concat(this.getListSimpleMoves(e,a))).concat(this.getListJumps(e,a)))}return t}},{key:"getListSimpleMoves",value:function(e,t){for(var n=[],r=0,i=[new Zee(t.x+1,t.y),new Zee(t.x-1,t.y),new Zee(t.x,t.y+1),new Zee(t.x,t.y-1),new Zee(t.x+1,t.y+1),new Zee(t.x+1,t.y-1),new Zee(t.x-1,t.y+1),new Zee(t.x-1,t.y-1)];r<i.length;r++){var a=i[r],o=Sre.of(t,a);o.isSuccess()&&Ire.get().simpleMoveLegality(o.get(),e).isSuccess()&&n.push(o.get())}return n}},{key:"getListJumps",value:function(e,t){var n,r=new ite,i=Hg(Ire.get().jumpTargetsFrom(t));try{for(i.s();!(n=i.n()).done;){var a=n.value,o=Ore.of([t,a]).get();Ire.get().jumpLegality(o,e).isSuccess()&&(r.add(o),r.union(this.getListJumpStartingFrom(e,o)))}}catch(s){i.e(s)}finally{i.f()}return r.toList()}},{key:"getListJumpStartingFrom",value:function(e,t){var n,r=Ire.get().nextJumps(t,e),i=new ite(r),a=Hg(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;i.union(this.getListJumpStartingFrom(e,o))}}catch(s){a.e(s)}finally{a.f()}return i}},{key:"getBoardValue",value:function(e){for(var t=e.gameState,n=0,r=new hte([{key:R7.ZERO,value:0},{key:R7.ONE,value:0}]),i=0;i<bre.HEIGHT;i++)for(var a=0;a<bre.WIDTH;a++){var o=new Zee(a,i),s=t.getPieceAt(o);if(s.isPlayer())if(t.isShelter(o)){if(n+=20*s.getScoreModifier(),r.replace(s,r.get(s).get()+1),20===r.get(s).get())return new nte(s.getVictoryValue())}else{var u,c=100,l=Hg(bre.ALL_SHELTERS);try{for(l.s();!(u=l.n()).done;){var f=u.value;if(t.getPieceAt(f)===A7.NONE){var h=o.getOrthogonalDistance(f);c=Math.min(c,h)}}}catch(d){l.e(d)}finally{l.f()}n-=s.getScoreModifier()*c}}return new nte(n)}}]),n}(tte),Rre=A7.NONE,Mre=A7.ZERO,xre=A7.ONE,Nre=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(cn||(cn=_g(["Board and aim of the game"]))),$localize(ln||(ln=_g(["Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially."]))),bre.getInitialState()),wte.anyMove($localize(fn||(fn=_g(["Initial phase"]))),$localize(hn||(hn=_g(["In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>Drop one of your piece in the central zone."]))),bre.getInitialState(),Pre.of(new Zee(7,7)).get(),$localize(dn||(dn=_g(["Congratulations!"])))),wte.fromPredicate($localize(vn||(vn=_g(["Simple move"]))),$localize(pn||(pn=_g(["Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move."]))),new bre([[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Mre,Mre,xre,xre,Mre,Mre,xre,Mre,xre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Mre,xre,Mre,xre,Mre,Mre,Mre,Mre,xre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Mre,xre,Rre,Rre,Rre,Rre,Rre,xre,Mre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,xre,Mre,Mre,xre,xre,xre,Mre,Mre,Mre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,xre,Mre,xre,xre,xre,xre,xre,xre,Mre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre]],40),Sre.of(new Zee(4,6),new Zee(3,5)).get(),function(e,t,n){return e.isSimple()?pB.SUCCESS:pB.failure($localize(gn||(gn=_g(["You have made a jump, not a simple move. Try again!"]))))},$localize(yn||(yn=_g(["Congratulations!"])))),wte.fromPredicate($localize(mn||(mn=_g(["Jumps"]))),$localize(kn||(kn=_g(["The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful)."]))),new bre([[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Mre,Mre,xre,xre,Mre,Mre,xre,Mre,xre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Mre,xre,Mre,xre,Mre,Mre,Mre,Mre,xre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Mre,xre,Rre,Rre,Rre,Rre,Rre,xre,Mre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,xre,Mre,Mre,xre,xre,xre,Mre,Mre,Mre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,xre,Mre,xre,xre,xre,xre,xre,xre,Mre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre]],40),Ore.of([new Zee(6,7),new Zee(6,5)]).get(),function(e,t,n){return e.isJump()?pB.SUCCESS:pB.failure($localize(Cn||(Cn=_g(["You have not performed a jump. Try again!"]))))},$localize(wn||(wn=_g(["Congratulations!"])))),wte.fromMove($localize(_n||(_n=_g(["Chaining jumps in a single move"]))),$localize(En||(En=_g(["Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it."]))),new bre([[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,xre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,xre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,xre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Mre,Mre,Rre,xre,Mre,Mre,xre,Mre,xre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Mre,Rre,Mre,xre,Mre,Mre,Mre,Mre,xre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Mre,xre,Rre,Rre,Rre,Rre,Rre,xre,Mre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,xre,Mre,Mre,xre,xre,xre,Mre,Mre,Mre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,xre,Mre,xre,xre,xre,xre,xre,xre,Mre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre],[Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre,Rre]],40),[Ore.of([new Zee(8,6),new Zee(6,4),new Zee(6,2),new Zee(6,0)]).get()],$localize(bn||(bn=_g(["Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does."]))),$localize(Pn||(Pn=_g(["You have not performed a triple jump. Try again!"]))))]});function Dre(e,t){if(1&e){var n=aP();cC(),eP(0,"rect",9),uP("click",function(){Nk(n);var e=fP().$implicit;return fP(2).onClick(e.coord)}),tP()}if(2&e){var r=fP().$implicit,i=fP(2);$b("x",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.x+i.STROKE_WIDTH)("y",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE-3*i.STROKE_WIDTH)("height",i.SPACE_SIZE-3*i.STROKE_WIDTH)}}function Lre(e,t){if(1&e){var n=aP();cC(),eP(0,"circle",6),uP("click",function(){Nk(n);var e=fP().$implicit;return fP(2).onClick(e.coord)}),tP()}if(2&e){var r=fP(),i=r.index,a=r.$implicit,o=fP().index,s=fP();vP("id","piece_",i,"_",o,""),Xb("ngClass",a.pieceClasses),$b("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE*i+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*o+s.STROKE_WIDTH+s.SPACE_SIZE/2)}}function Fre(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"rect",6),uP("click",function(){var e=Nk(n).$implicit;return fP(2).onClick(e.coord)}),tP(),Yb(2,Dre,1,4,"rect",7),Yb(3,Lre,1,6,"circle",8),tP()}if(2&e){var r=t.$implicit,i=t.index,a=fP().index,o=fP();pE(1),vP("id","click_",i,"_",a,""),Xb("ngClass",r.squareClasses),$b("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),pE(1),Xb("ngIf",r.isShelter),pE(1),Xb("ngIf",r.hasPiece)}}function Ure(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Fre,4,9,"g",1),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}function Vre(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"rect",10),uP("click",function(){var e=Nk(n).$implicit;return fP().onClick(e)}),tP(),tP()}if(2&e){var r=t.$implicit,i=fP();pE(1),Xb("ngClass",i.viewInfo.boardInfo[r.y][r.x].shelterClasses),$b("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function Bre(e,t){if(1&e&&(cC(),nP(0,"circle",11)),2&e){var n=t.$implicit,r=fP();dP("id","sidePiece_0_",n,""),$b("cx",-r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function zre(e,t){if(1&e&&(cC(),nP(0,"circle",12)),2&e){var n=t.$implicit,r=fP();dP("id","sidePiece_1_",n,""),$b("cx",1715+r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function Hre(e,t){if(1&e&&(cC(),nP(0,"rect",13)),2&e){var n=fP();$b("x",n.SPACE_SIZE*n.CENTRAL_ZONE_START.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*n.CENTRAL_ZONE_START.y+n.STROKE_WIDTH)("width",n.CENTRAL_ZONE_SIZE.x*n.SPACE_SIZE)("height",n.CENTRAL_ZONE_SIZE.y*n.SPACE_SIZE)}}var Gre=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).ALL_SHELTERS=bre.ALL_SHELTERS,r.CENTRAL_ZONE_START=bre.CENTRAL_ZONE_TOP_LEFT,r.CENTRAL_ZONE_SIZE=new Vee(bre.CENTRAL_ZONE_BOTTOM_RIGHT.x-bre.CENTRAL_ZONE_TOP_LEFT.x+1,bre.CENTRAL_ZONE_BOTTOM_RIGHT.y-bre.CENTRAL_ZONE_TOP_LEFT.y+1),r.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},r.selected=fB.empty(),r.jumpInConstruction=fB.empty(),r.PIECE_RADIUS=r.SPACE_SIZE/2-r.STROKE_WIDTH,r.rules=Ire.get(),r.availableMinimaxes=[new Are(r.rules,"ConspirateursMinimax")],r.encoder=Tre,r.tutorial=(new Nre).tutorial,r}return Wg(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"updateViewInfo",value:function(){var e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(var t=0;t<bre.HEIGHT;t++){this.viewInfo.boardInfo.push([]);for(var n=0;n<bre.WIDTH;n++){var r=new Zee(n,t),i=e.getPieceAt(r),a={coord:r,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(i)],hasPiece:i.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[t].push(a)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}},{key:"updateOccupiedShelters",value:function(){var e,t=Hg(bre.ALL_SHELTERS);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=this.viewInfo.boardInfo[n.y][n.x];r.isShelter=!0,r.hasPiece&&r.shelterClasses.push("highlighted")}}catch(i){t.e(i)}finally{t.f()}}},{key:"updateSelected",value:function(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){var e=this.jumpInConstruction.get(),t=e.getStartingCoord(),n=e.getEndingCoord();this.viewInfo.boardInfo[t.y][t.x].hasPiece=!1,this.viewInfo.boardInfo[n.y][n.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected"],this.viewInfo.boardInfo[n.y][n.x].hasPiece=!0;var r,i=Hg(e.coords);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.boardInfo[a.y][a.x].squareClasses.push("moved")}}catch(s){i.e(s)}finally{i.f()}}else{var o=this.selected.get();this.viewInfo.boardInfo[o.y][o.x].pieceClasses.push("selected")}}},{key:"updateVictory",value:function(){var e=this.getState(),t=Ire.get().getGameStatus(this.rules.node);if(!0===t.isEndGame){var n,r=Hg(bre.ALL_SHELTERS);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.getPieceAt(i)===t.winner&&this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("victory")}}catch(a){r.e(a)}finally{r.f()}}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved");else if(e.isSimple())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved"),this.viewInfo.boardInfo[e.end.y][e.end.x].squareClasses.push("moved");else{this.viewInfo.lastMoveArrow="";var t,n=Hg(e.coords);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved"),this.viewInfo.lastMoveArrow+=r.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=r.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}catch(i){n.e(i)}finally{n.f()}}}},{key:"cancelMoveAttempt",value:function(){this.jumpInConstruction=fB.empty(),this.selected=fB.empty(),this.updateBoard()}},{key:"onClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if((i=t.getState()).getPieceAt(e)!==t.getCurrentPlayer()){n.next=6;break}return n.abrupt("return",(t.selected=fB.of(e),t.jumpInConstruction=fB.empty(),t.updateViewInfo(),pB.SUCCESS));case 6:if(!t.jumpInConstruction.isPresent()){n.next=8;break}return n.abrupt("return",t.constructJump(e));case 8:if(!t.selected.isPresent()){n.next=10;break}return n.abrupt("return",t.selectNextCoord(e));case 10:if(!i.isDropPhase()){n.next=13;break}return a=Pre.of(e),n.abrupt("return",(v7(a.isSuccess(),"ConspirateursMove should be valid by construction"),t.chooseMove(a.get(),i)));case 13:return n.abrupt("return",t.cancelMove(ete.MUST_CHOOSE_PLAYER_PIECE()));case 14:case"end":return n.stop()}},n)}))()}},{key:"constructJump",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.jumpInConstruction.get(),i=t.getState(),!e.equals(r.getEndingCoord())){n.next=3;break}return n.abrupt("return",t.chooseMove(r,i));case 3:if(!(a=r.addJump(e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(a.getReason()));case 6:return o=t.rules.jumpLegality(a.get(),i),n.abrupt("return",o.isFailure()?t.cancelMove(o.getReason()):t.updateJump(a.get()));case 8:case"end":return n.stop()}},n)}))()}},{key:"updateJump",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getState(),n.abrupt("return",t.rules.jumpHasPossibleNextTargets(e,r)?(t.jumpInConstruction=fB.of(e),t.updateViewInfo(),pB.SUCCESS):t.chooseMove(e,r));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectNextCoord",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.selected.get(),!(i=Sre.of(r,e)).isSuccess()){n.next=3;break}return n.abrupt("return",t.chooseMove(i.get(),t.getState()));case 3:return a=Ore.of([r,e]),n.abrupt("return",a.isFailure()?t.cancelMove(a.getReason()):t.updateJump(a.get()));case 5:case"end":return n.stop()}},n)}))()}}]),n}(qee);return e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-conspirateurs"]],features:[Rb],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1",3,"id",4,"ngFor","ngForOf"],["class","base no-fill highlighted mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0",3,"id"],[1,"base","mid-stroke","player1",3,"id"],[1,"base","no-fill","highlighted","mid-stroke"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),Yb(1,Ure,2,1,"g",1),Yb(2,Vre,2,5,"g",1),Yb(3,Bre,1,4,"circle",2),Yb(4,zre,1,4,"circle",3),Yb(5,Hre,1,4,"rect",4),nP(6,"polyline",5),tP()),2&e&&(pE(1),Xb("ngForOf",t.viewInfo.boardInfo),pE(1),Xb("ngForOf",t.ALL_SHELTERS),pE(1),Xb("ngForOf",t.range(t.viewInfo.sidePieces[0])),pE(1),Xb("ngForOf",t.range(t.viewInfo.sidePieces[1])),pE(1),Xb("ngIf",t.viewInfo.dropPhase),pE(1),$b("points",t.viewInfo.lastMoveArrow))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),$re=function(){function e(t,n){Zg(this,e),this.owner=t,this.otherPieceType=n}return Wg(e,[{key:"toString",value:function(){return"DiamPiece(".concat(this.owner,", ").concat(this.otherPieceType,")")}}],[{key:"of",value:function(t,n){return t===R7.ZERO?n?e.ZERO_SECOND:e.ZERO_FIRST:t===R7.ONE?n?e.ONE_SECOND:e.ONE_FIRST:e.EMPTY}}]),e}();$re.encoder=T7.tuple([R7.numberEncoder,T7.booleanEncoder],function(e){return[e.owner,e.otherPieceType]},function(e){return $re.of(e[0],e[1])}),$re.EMPTY=new $re(A7.NONE,!1),$re.ZERO_FIRST=new $re(R7.ZERO,!1),$re.ZERO_SECOND=new $re(R7.ZERO,!0),$re.ONE_FIRST=new $re(R7.ONE,!1),$re.ONE_SECOND=new $re(R7.ONE,!0),$re.PLAYER_PIECES=[$re.ZERO_FIRST,$re.ZERO_SECOND,$re.ONE_FIRST,$re.ONE_SECOND];var Zre=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;if(Zg(this,n),(i=t.call(this)).target=e,i.piece=r,r===$re.EMPTY)throw new Error("Cannot drop an empty piece");return Lg(i)}return Wg(n,[{key:"isDrop",value:function(){return!0}},{key:"getTarget",value:function(){return this.target}},{key:"equals",value:function(e){return!(this.target!==e.target||this.piece!==e.piece)}},{key:"toString",value:function(){return"DiamMoveDrop(".concat(this.target,", ").concat(this.piece,")")}}]),n}(ute);Zre.encoder=T7.tuple([T7.numberEncoder(7),$re.encoder],function(e){return[e.target,e.piece]},function(e){return new Zre(e[0],e[1])});var qre=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this)).start=e,i.moveDirection=r,i}return Wg(n,[{key:"isDrop",value:function(){return!1}},{key:"getTarget",value:function(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}},{key:"equals",value:function(e){return!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}},{key:"toString",value:function(){return"DiamMoveShift(".concat(this.start,", ").concat(this.moveDirection,")")}}],[{key:"fromRepresentation",value:function(e,t){return new n(new Zee(e.x,3-e.y),t)}}]),n}(ute);qre.encoder=T7.tuple([Zee.numberEncoder(8,4),T7.booleanEncoder],function(e){return[e.start,"clockwise"===e.moveDirection]},function(e){return new qre(e[0],e[1]?"clockwise":"counterclockwise")});var Wre=T7.disjunction(Zre.encoder,qre.encoder,function(e){return e.isDrop()}),jre=function(){var e=Wg(function e(){Zg(this,e)});return e.NO_MORE_PIECES_OF_THIS_TYPE=function(){return $localize(Sn||(Sn=_g(["You do not have any pieces of this type anymore."])))},e.SPACE_IS_FULL=function(){return $localize(On||(On=_g(["You cannot play here: this space is already full."])))},e.TARGET_STACK_TOO_HIGH=function(){return $localize(Tn||(Tn=_g(["You cannot add more pieces to the target stack, as it will contain more than 4 pieces."])))},e.MUST_SHIFT_TO_NEIGHBOR=function(){return $localize(In||(In=_g(["To perform a shift, you must move the pieces to a neighboring space."])))},e.MUST_SELECT_PIECE_FIRST=function(){return $localize(An||(An=_g(["You must first select either a piece from the side, or a stack of pieces to shift on the board."])))},e}(),Yre=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,i)).remainingPieces=r,a}return Wg(n,[{key:"getRemainingPiecesOf",value:function(e){return this.remainingPieces[n.pieceIndex(e)]}},{key:"getStackHeight",value:function(e){for(var t=0,r=0;r<n.HEIGHT&&this.getPieceAtXY(e,r)!==$re.EMPTY;r++)t++;return t}}],[{key:"getInitialState",value:function(){var e=$re.EMPTY;return new n([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}},{key:"fromRepresentation",value:function(e,t){for(var r=e.reverse(),i=[4,4,4,4],a=0;a<n.HEIGHT;a++)for(var o=0;o<n.WIDTH;o++){var s=r[a][o];r[a][o]!==$re.EMPTY&&i[n.pieceIndex(s)]--}return v7(i.every(function(e){return e>=0}),"Invalid DiamState representation uses too many pieces"),new n(r,i,t)}},{key:"pieceIndex",value:function(e){switch(e){case $re.ZERO_FIRST:return 0;case $re.ZERO_SECOND:return 1;case $re.ONE_FIRST:return 2;default:return oB.expectToBe(e,$re.ONE_SECOND),3}}}]),n}(ote);return e.WIDTH=8,e.HEIGHT=4,e}(),Kre=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.call(this,Yre)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=D7.copyBiArray(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;var r=D7.copyImmutableArray(t.remainingPieces);return r[Yre.pieceIndex(e.piece)]-=1,new Yre(n,r,t.turn+1)}},{key:"applyLegalShift",value:function(e,t){for(var n=D7.copyBiArray(t.board),r=e.getTarget(),i=t.getStackHeight(r),a=e.start.y;a<Yre.HEIGHT&&t.getPieceAtXY(e.start.x,a)!==$re.EMPTY;)n[i][r]=t.getPieceAtXY(e.start.x,a),n[a][e.start.x]=$re.EMPTY,i++,a++;return new Yre(n,t.remainingPieces,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}},{key:"isDropLegal",value:function(e,t){return e.piece.owner!==t.getCurrentPlayer()?hB.failure(ete.MUST_CHOOSE_PLAYER_PIECE()):0===t.getRemainingPiecesOf(e.piece)?hB.failure(jre.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}},{key:"dropHeightValidity",value:function(e,t){return t.getStackHeight(e.target)===Yre.HEIGHT?hB.failure(jre.SPACE_IS_FULL()):hB.success(void 0)}},{key:"isShiftLegal",value:function(e,t){return t.getPieceAt(e.start).owner!==t.getCurrentPlayer()?hB.failure(ete.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(e,t)}},{key:"shiftHeightValidity",value:function(e,t){var n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>Yre.HEIGHT?hB.failure(jre.TARGET_STACK_TOO_HIGH()):hB.success(void 0)}},{key:"getGameStatus",value:function(e){var t=this.findHighestAlignment(e.gameState);if(t.isPresent()){var n=e.gameState.getPieceAt(t.get());return v7(n.owner.isPlayer(),"highest alignment is owned by a player"),gte.getVictory(n.owner)}return gte.ONGOING}},{key:"findHighestAlignment",value:function(e){for(var t=0;t<Yre.WIDTH/2;t++)for(var n=Yre.HEIGHT-1;n>0;n--){var r=e.getPieceAtXY(t,n),i=e.getPieceAtXY(t+Yre.WIDTH/2,n);if(r!==$re.EMPTY&&r===i)return fB.of(new Zee(t,n))}return fB.empty()}},{key:"pieceCanMove",value:function(e,t){return!!this.isShiftLegal(new qre(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new qre(t,"counterclockwise"),e).isSuccess()}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=fB.of(new n)),n.singleton.get()}}]),n}(yte);Kre.singleton=fB.empty();var Qre=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=e.gameState,n=this.getListDrops(t),r=this.getListShifts(t);return n.concat(r)}},{key:"getListShifts",value:function(e){var t,n=[],r=Hg(this.getShiftSources(e));try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=0,o=[new qre(i,"clockwise"),new qre(i,"counterclockwise")];a<o.length;a++){var s=o[a];Kre.get().shiftHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){r.e(u)}finally{r.f()}return n}},{key:"getListDrops",value:function(e){for(var t=this.getRemainingPiecesForCurrentPlayer(e),n=[],r=0;r<Yre.WIDTH;r++){var i,a=Hg(t);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=new Zre(r,o);Kre.get().dropHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){a.e(u)}finally{a.f()}}return n}},{key:"getRemainingPiecesForCurrentPlayer",value:function(e){var t,n=[],r=Hg($re.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.currentPlayerCanDropPiece(e,i)&&n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"currentPlayerCanDropPiece",value:function(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}},{key:"getShiftSources",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<Yre.HEIGHT;r++)for(var i=0;i<Yre.WIDTH;i++)e.getPieceAtXY(i,r).owner===n&&t.push(new Zee(i,r));return t}},{key:"getBoardValue",value:function(e){var t=Kre.get().getGameStatus(e);return new nte(t.isEndGame?t.toBoardValue():0)}}]),n}(tte),Xre=$re.EMPTY,Jre=$re.ZERO_FIRST,eie=$re.ZERO_SECOND,tie=$re.ONE_FIRST,nie=$re.ONE_SECOND,rie=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(Rn||(Rn=_g(["Initial board and player pieces"]))),$localize(Mn||(Mn=_g(["Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right."]))),Yre.getInitialState()),wte.fromMove($localize(xn||(xn=_g(["Goal of the game"]))),$localize(Nn||(Nn=_g(["At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>Do it!"]))),Yre.fromRepresentation([[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,tie,Xre,Xre,Xre],[Jre,Xre,Xre,Xre,Jre,Xre,Xre,Xre]],3),[new Zre(0,$re.ONE_FIRST)],$localize(Dn||(Dn=_g(["Congratulations, you won!"]))),$localize(Ln||(Ln=_g(["Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board."])))),wte.fromMove($localize(Fn||(Fn=_g(["Types of move"]))),$localize(Un||(Un=_g(["You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more  than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board."]))),Yre.fromRepresentation([[Xre,Xre,Xre,Xre,Xre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,nie,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,Jre,Xre,Xre,Xre],[tie,Xre,Xre,Xre,eie,Xre,Xre,Xre]],4),[qre.fromRepresentation(new Zee(4,3),"counterclockwise"),qre.fromRepresentation(new Zee(4,3),"clockwise"),qre.fromRepresentation(new Zee(4,2),"counterclockwise"),qre.fromRepresentation(new Zee(4,2),"clockwise")],$localize(Vn||(Vn=_g(["Congratulations!"]))),$localize(Bn||(Bn=_g(["Failed, try to move one of your piece that is already on the board."])))),wte.fromMove($localize(zn||(zn=_g(["Special case"]))),$localize(Hn||(Hn=_g(["It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!"]))),Yre.fromRepresentation([[Xre,Xre,Xre,Xre,Jre,Xre,Xre,Xre],[Xre,Xre,Xre,Xre,nie,Xre,Xre,Jre],[Xre,Xre,Xre,Xre,Jre,Xre,Xre,nie],[Xre,tie,Xre,Xre,eie,Xre,Xre,tie]],8),[qre.fromRepresentation(new Zee(4,2),"counterclockwise")],$localize(Gn||(Gn=_g(["Congratulations!"]))),$localize($n||($n=_g(["Failed, try to shift a stack of pieces to the left."]))))]});function iie(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"path",6),uP("click",function(){var e=Nk(n).$implicit;return fP().onSpaceClick(e)}),tP(),eP(2,"path",7),uP("click",function(){var e=Nk(n).$implicit;return fP().onSpaceClick(e)}),tP(),tP()}if(2&e){var r=t.$implicit,i=fP();pE(1),dP("id","click_",r,""),Xb("ngClass",i.viewInfo.boardInfo[r].spaceClasses),$b("d",i.BOARD_PATHS[r]),pE(1),Xb("ngClass",i.viewInfo.boardInfo[r].spaceClasses),$b("d",i.DECORATION_PATHS[r])}}function aie(e,t){if(1&e){var n=aP();cC(),eP(0,"g",9),uP("click",function(){var e=Nk(n).$implicit,t=fP().$implicit;return fP().onPieceInGameClick(t,e.y)}),nP(1,"use",10),nP(2,"use",11),tP()}if(2&e){var r=t.$implicit;vP("id","click_",fP().$implicit,"_",r.y,""),Xb("ngClass",r.foregroundClasses),pE(1),Xb("ngClass",r.backgroundClasses),$b("x",r.drawPosition.x)("y",r.drawPosition.y),pE(1),$b("x",r.drawPosition.x)("y",r.drawPosition.y)}}function oie(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,aie,3,8,"g",8),tP()),2&e){var n=t.$implicit,r=fP();pE(1),Xb("ngForOf",r.viewInfo.boardInfo[n].pieces)}}function sie(e,t){if(1&e){var n=aP();cC(),eP(0,"g",12),uP("click",function(){var e=Nk(n).$implicit;return fP().onRemainingPieceClick(e.actualPiece)}),nP(1,"use",10),nP(2,"use",11),tP()}if(2&e){var r=t.$implicit;vP("id","piece_",r.actualPiece.owner.value,"_",r.actualPiece.otherPieceType?1:0,""),Xb("ngClass",r.foregroundClasses),pE(1),Xb("ngClass",r.backgroundClasses),$b("x",r.drawPosition.x)("y",r.drawPosition.y),pE(1),$b("x",r.drawPosition.x)("y",r.drawPosition.y)}}var uie=function(){return[0,1,2,3,4,5,6,7]},cie=function(){return[2,1,3,0,4,7,5,6]},lie=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],r.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],r.selected=fB.empty(),r.viewInfo={boardInfo:[],remainingPieces:[]},r.rules=Kre.get(),r.availableMinimaxes=[new Qre(r.rules,"DiamDummyMinimax")],r.encoder=Wre,r.tutorial=(new rie).tutorial,r}return Wg(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"onSpaceClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#click_"+e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t.onSpaceClickAfterCheck(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"onSpaceClickAfterCheck",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.selected.isPresent()){n.next=14;break}if("pieceFromReserve"!==(r=t.selected.get()).type){n.next=6;break}i=new Zre(e,r.piece),n.next=13;break;case 6:if((r.position.x+1)%Yre.WIDTH!==e){n.next=10;break}i=new qre(r.position,"clockwise"),n.next=13;break;case 10:if((r.position.x+(Yre.WIDTH-1))%Yre.WIDTH===e){n.next=12;break}return n.abrupt("return",t.cancelMove(jre.MUST_SHIFT_TO_NEIGHBOR()));case 12:i=new qre(r.position,"counterclockwise");case 13:return n.abrupt("return",t.chooseMove(i,t.getState()));case 14:return n.abrupt("return",t.cancelMove(jre.MUST_SELECT_PIECE_FIRST()));case 15:case"end":return n.stop()}},n)}))()}},{key:"onPieceInGameClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.getState().getPieceAtXY(e,t).owner===n.getCurrentPlayer()?(n.selected=fB.of({type:"pieceFromBoard",position:new Zee(e,t)}),n.updateViewInfo(),pB.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(ete.MUST_CHOOSE_PLAYER_PIECE()));case 2:case"end":return r.stop()}},r)}))()}},{key:"onRemainingPieceClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay(t.getPieceId(e)),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):e.owner===t.getCurrentPlayer()?(t.selected=fB.of({type:"pieceFromReserve",piece:e}),t.updateViewInfo(),pB.SUCCESS):t.cancelMove(ete.MUST_CHOOSE_PLAYER_PIECE()));case 2:case"end":return n.stop()}},n)}))()}},{key:"getPieceId",value:function(e){return"#piece_"+e.owner.value+"_"+(e.otherPieceType?1:0)}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"getLastMovedFromDrop",value:function(e,t){var n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),r=e.getTarget(),i=t.getStackHeight(e.getTarget()),a=this.getDrawPositionOnBoard(r,i),o=new Zee(r,i);return[{start:fB.empty(),end:o,startDrawPosition:n,endDrawPosition:a}]}},{key:"getLastMovedFromShift",value:function(e,t){for(var n=e.start.x,r=e.getTarget(),i=t.getStackHeight(r),a=[],o=e.start.y;o<Yre.HEIGHT&&t.getPieceAtXY(n,o)!==$re.EMPTY;o++,i++)a.push({start:fB.of(new Zee(n,o)),end:new Zee(r,i),startDrawPosition:this.getDrawPositionOnBoard(n,o),endDrawPosition:this.getDrawPositionOnBoard(r,i)});return a}},{key:"updateViewInfo",value:function(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}},{key:"updateBoardInfo",value:function(){for(var e=0;e<Yre.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}},{key:"showLastMove",value:function(){this.showLastMoveOnSpaces(),this.showLastMoveOnPieces()}},{key:"showLastMoveOnSpaces",value:function(){var e=this.rules.node.move;v7(e.isPresent(),"showLastMoveOnSpaces called without a last move");for(var t=e.get(),n=0;n<Yre.WIDTH;n++){var r=[];t.isDrop()?t.getTarget()===n&&r.push("moved"):(t.getTarget()===n||t.start.x===n)&&r.push("moved"),this.viewInfo.boardInfo[n].spaceClasses=r}}},{key:"showLastMoveOnPieces",value:function(){var e=this.rules.node.move;v7(e.isPresent(),"showLastMoveOnPieces called without a last move");var t,n=e.get(),r=this.getPreviousState(),i=Hg(n.isDrop()?this.getLastMovedFromDrop(n,r):this.getLastMovedFromShift(n,r));try{for(i.s();!(t=i.n()).done;){var a=t.value;this.viewInfo.boardInfo[a.end.x].pieces[a.end.y].foregroundClasses.push("last-move")}}catch(o){i.e(o)}finally{i.f()}}},{key:"updateRemainingPiecesInfo",value:function(){var e=this.getCurrentPlayer();this.viewInfo.remainingPieces=[];var t,n=this.isPlayerTurn(),r=Hg($re.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.getState().getRemainingPiecesOf(i),o=0;o<a;o++){var s=[];this.isTopPieceOfReserveAndSelected(o,a,i)&&s.push("selected"),n&&o===a-1&&i.owner===e&&s.push("clickable-hover"),this.viewInfo.remainingPieces.push({backgroundClasses:["player"+i.owner.value+(i.otherPieceType?"-alternate":"")],foregroundClasses:s,y:o,drawPosition:this.getDrawPositionRemainingPiece(i,o),actualPiece:i})}}catch(u){r.e(u)}finally{r.f()}}},{key:"isTopPieceOfReserveAndSelected",value:function(e,t,n){if(this.selected.isPresent()){var r=this.selected.get();return"pieceFromReserve"===r.type&&r.piece===n&&e===t-1}return!1}},{key:"getDrawPositionRemainingPiece",value:function(e,t){var r,i;return r=e.owner===R7.ZERO?-100:600,i=e.otherPieceType?100:450,new Zee(r,i).getNext(new Vee(0,-t*n.PIECE_HEIGHT))}},{key:"getPieces",value:function(e){for(var t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),r=[],i=0;i<Yre.HEIGHT;i++){var a=this.getState().getPieceAtXY(e,i),o=new Zee(e,i);if(a!==$re.EMPTY){var s=[];this.pieceFromBoardIsSelected(e,i)&&s.push("selected"),this.isVictory(e,i,t)&&s.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),o)&&s.push("clickable-hover"),r.push({backgroundClasses:["player"+a.owner.value+(a.otherPieceType?"-alternate":"")],foregroundClasses:s,y:i,drawPosition:this.getDrawPositionOnBoard(e,i),actualPiece:a})}}return r}},{key:"pieceFromBoardIsSelected",value:function(e,t){if(this.selected.isPresent()){var n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}},{key:"isVictory",value:function(e,t,n){if(n.isPresent()){var r=n.get();return r.x%4==e%4&&r.y===t}return!1}},{key:"getDrawPositionOnBoard",value:function(e,t){return n.CENTER[e].getNext(new Vee(0,-t*n.PIECE_HEIGHT))}},{key:"cancelMoveAttempt",value:function(){this.selected=fB.empty(),this.updateBoard()}}]),n}(qee);lie.CENTER=[new Zee(40,160),new Zee(100,50),new Zee(255,2),new Zee(400,50),new Zee(460,160),new Zee(400,270),new Zee(255,320),new Zee(100,270)],lie.PIECE_HEIGHT=36,lie.\u0275fac=function(e){return new(e||lie)(Qb(h7))},lie.\u0275cmp=Gm({type:lie,selectors:[["app-diam"]],features:[Rb],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 1.4319358,16.913484 V 49.329973 H 1.482219 A 39.498175,14.141265 0 0 0 40.938372,63.011675 39.498175,14.141265 0 0 0 80.394523,49.329973 h 0.06885 V 16.913484 h -0.02864 A 39.769348,14.114049 0 0 1 40.941466,29.431707 39.769348,14.114049 0 0 1 1.4481812,16.913484 Z"],["cx","40.952408","cy","15.225397","rx","39.769348","ry","14.11405"],[4,"ngFor","ngForOf"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),eP(1,"defs"),eP(2,"g",1),nP(3,"path",2),nP(4,"ellipse",3),tP(),tP(),Yb(5,iie,3,5,"g",4),Yb(6,oie,2,1,"g",4),Yb(7,sie,3,8,"g",5),tP()),2&e&&(pE(5),Xb("ngForOf",aT(3,uie)),pE(1),Xb("ngForOf",aT(4,cie)),pE(1),Xb("ngForOf",t.viewInfo.remainingPieces))},directives:[LA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var fie=function(){function e(t,n){Zg(this,e),this.offset=t,this.constant=n}return Wg(e,[{key:"toString",value:function(){return"Line(".concat(this.constant,", ").concat(this.offset,")")}},{key:"equals",value:function(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}},{key:"contains",value:function(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}},{key:"getDirection",value:function(){switch(this.constant){case"q":return Yee.DOWN;case"r":return Yee.RIGHT;case"s":return Yee.DOWN_LEFT}}}],[{key:"fromTwoCoords",value:function(t,n){var r=t.x,i=n.x,a=t.y,o=n.y,s=r+a,u=i+o;return r===i&&a!==o&&s!==u?fB.of(e.constantQ(r)):r!==i&&a===o&&s!==u?fB.of(e.constantR(a)):r!==i&&a!==o&&s===u?fB.of(e.constantS(s)):fB.empty()}},{key:"constantQ",value:function(t){return new e(t,"q")}},{key:"constantR",value:function(t){return new e(t,"r")}},{key:"constantS",value:function(t){return new e(t,"s")}},{key:"areOnSameLine",value:function(t){if(t.length<2)return!0;var n=e.fromTwoCoords(t[0],t[1]);if(n.isAbsent())return!1;var r,i=n.get(),a=Hg(t.slice(2));try{for(a.s();!(r=a.n()).done;){var o=r.value;if(!1===i.contains(o))return!1}}catch(s){a.e(s)}finally{a.f()}return!0}}]),e}(),hie=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,r,e)).board=r,u.width=i,u.height=a,u.excludedCases=o,u.empty=s,v7(u.excludedCases.length<u.height/2+1,"Invalid excluded cases specification for HexagonalGameState."),u}return Wg(n,[{key:"setAt",value:function(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}},{key:"equalsT",value:function(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedCases.length!==e.excludedCases.length)return!1;for(var n=0;n<this.excludedCases.length;n++)if(this.excludedCases[n]!==e.excludedCases[n])return!1;var r,i=Hg(this.allCoords());try{for(i.s();!(r=i.n()).done;){var a=r.value;if(!1===t(this.getPieceAt(a),e.getPieceAt(a)))return!1}}catch(o){i.e(o)}finally{i.f()}return!0}},{key:"allCoords",value:function(){var e=[];return this.forEachCoord(function(t){e.push(t)}),e}},{key:"allLines",value:function(){for(var e=[],t=0;t<this.width;t++)e.push(fie.constantQ(t));for(var n=0;n<this.height;n++)e.push(fie.constantR(n));for(var r=this.excludedCases.length;r<this.height+this.excludedCases.length;r++)e.push(fie.constantS(r));return e}},{key:"getEntranceOnLine",value:function(e){var t,n;switch(e.constant){case"q":return n=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new Zee(e.offset,n));case"r":return t=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new Zee(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new Zee(e.offset,0):new Zee(this.width-1,e.offset-this.width+1))}}},{key:"findEntranceFrom",value:function(e,t){for(var n=e.getDirection(),r=t,i=0;i<Math.max(this.width,this.height);i++){if(this.isOnBoard(r))return r;r=r.getNext(n)}var a=d7.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(a.getReason())}}],[{key:"neighbors",value:function(e,t){return[new Zee(e.x+t,e.y-t),new Zee(e.x+t,e.y),new Zee(e.x-t,e.y+t),new Zee(e.x-t,e.y),new Zee(e.x,e.y+t),new Zee(e.x,e.y-t)]}}]),n}(ote),die=function(){function e(t,n,r){Zg(this,e),this.owner=t,this.size=n,this.source=r}return Wg(e,[{key:"getValue",value:function(){return e.encoder.encodeNumber(this)}},{key:"getOwner",value:function(){return this.owner}},{key:"belongsTo",value:function(e){return this.owner===e}},{key:"containsSource",value:function(){return this.source}},{key:"isEmpty",value:function(){return 0===this.size}},{key:"getSize",value:function(){return this.size}},{key:"toString",value:function(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}}],[{key:"append",value:function(t,n){return new e(t.owner,t.size+n.size,t.source||n.source)}}]),e}();die.sizeEncoder=T7.numberEncoder(49),die.encoder=T7.tuple([T7.booleanEncoder,R7.numberEncoder,die.sizeEncoder],function(e){return[e.source,e.owner,e.size]},function(e){return new die(e[1],e[2],e[0])}),die.MAX_SIZE=49,die.EMPTY=new die(A7.NONE,0,!1),die.UNREACHABLE=new die(A7.NONE,-1,!1),die.PLAYER_ZERO=new die(R7.ZERO,1,!1),die.PLAYER_ONE=new die(R7.ONE,1,!1),die.SOURCE=new die(A7.NONE,1,!0);var vie=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,r,e,n.WIDTH,n.HEIGHT,n.EXCLUDED_SPACES,die.EMPTY)).alreadyPassed=i,a}return Wg(n,[{key:"getAllPieces",value:function(){for(var e=[],t=0;t<n.HEIGHT;t++)for(var r=0;r<n.WIDTH;r++){var i=new Zee(r,t);this.isOnBoard(i)&&!1===this.getPieceAt(i).isEmpty()&&e.push(i)}return e}},{key:"numberOfNeighbors",value:function(e){var t=this;return hie.neighbors(e,1).filter(function(e){return t.isOnBoard(e)&&!1===t.getPieceAt(e).isEmpty()}).length}},{key:"setAtUnsafe",value:function(e,t){var r=D7.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.alreadyPassed)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==die.UNREACHABLE}}],[{key:"balancedBoard",value:function(){var e=die.UNREACHABLE,t=die.PLAYER_ZERO,n=die.PLAYER_ONE,r=die.SOURCE;return[[e,e,t,n,n,n,t,t,n,r,n],[e,n,n,t,t,t,n,n,t,n,n],[n,n,n,n,t,r,n,t,t,t,t],[t,t,n,t,t,n,n,n,t,t,e],[t,r,t,n,n,t,t,t,n,e,e]]}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(n.WIDTH,n.HEIGHT)&&n.balancedBoard()[e.y][e.x]!==die.UNREACHABLE}},{key:"getInitialState",value:function(){return new n(n.balancedBoard(),0,!1)}}]),n}(hie);return e.WIDTH=11,e.HEIGHT=5,e.EXCLUDED_SPACES=[2,1],e}(),pie=function(e){xg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,r)}return Wg(n,[{key:"toString",value:function(){return this===n.PASS?"DvonnMove.PASS":"DvonnMove("+this.coord+"->"+this.end+")"}},{key:"length",value:function(){return this.coord.y===this.end.y?Math.abs(this.coord.x-this.end.x):Math.abs(this.coord.y-this.end.y)}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}}],[{key:"of",value:function(e,t){if(-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y)return n.PASS;if(!vie.isOnBoard(e))throw new Error("Starting coord of DvonnMove must be on the board, not at "+e.toString());if(!vie.isOnBoard(t))throw new Error("End coord of DvonnMove must be on the board, not at "+e.toString());if(e.y===t.y)return new n(e,t);if(e.x===t.x)return new n(e,t);if(e.x+e.y===t.x+t.y)return new n(e,t);throw new Error("Invalid move")}}]),n}(hne);pie.PASS=new pie(new Zee(-1,-1),new Zee(-2,-2)),pie.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 42148}},{key:"encodeNumber",value:function(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){if(e<0)return pie.PASS;var t=e%16,n=(e=e/16|0)%16,r=(e=e/16|0)%16;return new pie(new Zee((e=e/16|0)%16,r),new Zee(n,t))}}]),n}(T7));var gie=function(){var e=Wg(function e(){Zg(this,e)});return e.NOT_PLAYER_PIECE=function(){return $localize(Zn||(Zn=_g(["You must select a piece or a stack of your color."])))},e.EMPTY_STACK=function(){return $localize(qn||(qn=_g(["You must select a stack."])))},e.TOO_MANY_NEIGHBORS=function(){return $localize(Wn||(Wn=_g(["This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors."])))},e.CANT_REACH_TARGET=function(){return $localize(jn||(jn=_g(["This stack cannot move because it could never land on another piece."])))},e.INVALID_MOVE_LENGTH=function(){return $localize(Yn||(Yn=_g(["A stack must always be moved by as many spaces as there are pieces in the stack."])))},e.EMPTY_TARGET_STACK=function(){return $localize(Kn||(Kn=_g(["The stack must land on an occupied space."])))},e}(),yie=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isMovablePiece",value:function(e,t){v7(e.isOnBoard(t),"piece is not on the board");var r=e.getPieceAt(t);return r.getSize()<1?pB.failure(gie.EMPTY_STACK()):r.belongsTo(e.getCurrentPlayer())?e.numberOfNeighbors(t)>=6?pB.failure(gie.TOO_MANY_NEIGHBORS()):n.pieceHasTarget(e,t)?pB.SUCCESS:pB.failure(gie.CANT_REACH_TARGET()):pB.failure(gie.NOT_PLAYER_PIECE())}},{key:"canOnlyPass",value:function(e){return 0===n.getMovablePieces(e).length}},{key:"sourceCoords",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).containsSource()})}},{key:"markPiecesConnectedTo",value:function(e,t,n){var r=this;hie.neighbors(t,1).forEach(function(t){e.isOnBoard(t)&&!n[t.y][t.x]&&!e.getPieceAt(t).isEmpty()&&(n[t.y][t.x]=!0,r.markPiecesConnectedTo(e,t,n))})}},{key:"removeDisconnectedPieces",value:function(e){var t=this,n=D7.createTable(vie.WIDTH,vie.HEIGHT,!1);this.sourceCoords(e).forEach(function(r){n[r.y][r.x]=!0,t.markPiecesConnectedTo(e,r,n)});var r=e;return r.getAllPieces().forEach(function(e){n[e.y][e.x]||(r=r.setAt(e,die.EMPTY))}),r}},{key:"applyLegalMove",value:function(e,t,n){if(e===pie.PASS)return new vie(t.board,t.turn+1,!0);var r=t.getPieceAt(e.coord),i=t.getPieceAt(e.end),a=t.setAt(e.coord,die.EMPTY).setAt(e.end,die.append(r,i));return this.removeDisconnectedPieces(new vie(a.board,t.turn+1,!1))}},{key:"isLegal",value:function(e,t){if(0===n.getMovablePieces(t).length)return e!==pie.PASS||t.alreadyPassed?hB.failure(ete.MUST_PASS()):hB.success(void 0);if(e===pie.PASS)return hB.failure(ete.CANNOT_PASS());var r=this.isMovablePiece(t,e.coord);if(r.isFailure())return r.toFailedFallible();var i=t.getPieceAt(e.coord);return e.length()!==i.getSize()?hB.failure(gie.INVALID_MOVE_LENGTH()):t.getPieceAt(e.end).isEmpty()?hB.failure(gie.EMPTY_TARGET_STACK()):hB.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getScores(t);return 0===n.getMovablePieces(t).length?r[0]>r[1]?gte.ZERO_WON:r[0]<r[1]?gte.ONE_WON:gte.DRAW:gte.ONGOING}},{key:"getMovablePieces",value:function(e){return n.getFreePieces(e).filter(function(t){return n.pieceHasTarget(e,t)})}},{key:"getFreePieces",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6})}},{key:"pieceHasTarget",value:function(e,t){var n=e.getPieceAt(t).getSize();return void 0!==hie.neighbors(t,n).find(function(t){return e.isOnBoard(t)&&!e.getPieceAt(t).isEmpty()})}},{key:"pieceTargets",value:function(e,t){var n=e.getPieceAt(t).getSize();return hie.neighbors(t,n).filter(function(t){return e.isOnBoard(t)&&!1===e.getPieceAt(t).isEmpty()})}},{key:"getScores",value:function(e){var t=0,n=0;return e.getAllPieces().map(function(r){var i=e.getPieceAt(r);i.belongsTo(R7.ZERO)?t+=i.getSize():i.belongsTo(R7.ONE)&&(n+=i.getSize())}),[t,n]}}]),n}(yte),mie=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=e.move,n=e.gameState,r=[];return yie.getMovablePieces(n).forEach(function(e){return yie.pieceTargets(n,e).forEach(function(t){var n=pie.of(e,t);r.push(n)})}),0===r.length&&!1===t.equalsValue(pie.PASS)&&r.push(pie.PASS),r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=yie.getScores(t);return 0===yie.getMovablePieces(t).length?new nte(n[0]>n[1]?Number.MIN_SAFE_INTEGER:n[0]<n[1]?Number.MAX_SAFE_INTEGER:0):new nte(n[0]-n[1])}}]),n}(tte),kie=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=e.gameState,r=Rg(Vg(n.prototype),"getListMoves",this).call(this,e),i=t.getCurrentPlayer().getOpponent();return D7.sortByDescending(r,function(e){v7(e!==pie.PASS,"Cannot sort with DvonnMove.PASS");var n=t.getPieceAt(e.end);return n.belongsTo(i)?n.getSize():0}),r}},{key:"getBoardValue",value:function(e){var t=yie.getGameStatus(e);if(t.isEndGame)return new nte(t.toBoardValue());var n=e.gameState,r=yie.getScores(n),i=n.getAllPieces(),a=i.length,o=i.filter(function(e){return n.getPieceAt(e).belongsTo(R7.ZERO)}).length,s=i.filter(function(e){return n.getPieceAt(e).belongsTo(R7.ONE)}).length;return new nte((s*r[1]-o*r[0])/a)}}]),n}(mie),Cie=die.EMPTY,wie=die.UNREACHABLE,_ie=die.SOURCE,Eie=die.PLAYER_ZERO,bie=die.PLAYER_ONE,Pie=new die(R7.ZERO,2,!1),Sie=new die(R7.ONE,2,!1),Oie=new die(R7.ZERO,4,!1),Tie=new die(R7.ONE,4,!1),Iie=Wg(function e(){Zg(this,e),this.tutorial=[wte.anyMove($localize(Qn||(Qn=_g(["Moving"]))),$localize(Xn||(Xn=_g(["At Dvonn, each hexagonal space contains a stack of pieces.\n        If no number is indicated on a stack, it means that it only contains one piece.\n        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.\n        The owner of a stack is the one that has a piece at the top of the stack.\n        Only the owner of a stack can move it.\n        A stack cannot be moved if it is surrounded by 6 other stacks.\n        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.\n        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.\n        Therefore, there are six possible directions.\n        The player with dark pieces starts.<br/><br/>\n        You're playing Dark, click on a stack and move it by one space."]))),vie.getInitialState(),pie.of(new Zee(2,0),new Zee(3,0)),$localize(Jn||(Jn=_g(["Congratulations!"])))),wte.fromPredicate($localize(er||(er=_g(["Disconnection"]))),$localize(tr||(tr=_g(['Pieces with a lightning strike are called "sources".\n        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>\n        You\'re playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!']))),new vie([[wie,wie,bie,_ie,Cie,Cie,Cie,Cie,Cie,Cie,Cie],[wie,Cie,Eie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie],[Cie,Cie,Tie,Cie,Cie,Cie,Cie,bie,_ie,Cie,Cie],[Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,wie],[Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,wie,wie]],0,!1),pie.of(new Zee(2,1),new Zee(2,0)),function(e,t,n){return e.end.equals(new Zee(3,0))?pB.failure($localize(nr||(nr=_g(["You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it."])))):(v7(e.end.equals(new Zee(2,0)),"player made an impossible move"),pB.SUCCESS)},$localize(rr||(rr=_g(["Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!\n        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.\n        Disconnected stacks will not be visible at the next turn."])))),wte.fromPredicate($localize(ir||(ir=_g(["Moving on a source"]))),$localize(ar||(ar=_g(["You are allowed to move your stacks on any other stack.\n        This means that you can take control of a source by moving one of your stack on top of it.\n        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>\n        You're playing Dark and you can take control of a source, do it!"]))),new vie([[wie,wie,_ie,bie,Cie,Cie,Cie,Cie,Cie,Cie,Cie],[wie,Eie,Eie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie],[Cie,bie,Eie,bie,Cie,Cie,Eie,Sie,_ie,Cie,Cie],[Cie,Cie,bie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,wie],[Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,wie,wie]],0,!1),pie.of(new Zee(2,1),new Zee(2,0)),function(e,t,n){return e.end.equals(new Zee(2,0))?pB.SUCCESS:pB.failure($localize(or||(or=_g(["You have not taken possession of a source, try again."]))))},$localize(sr||(sr=_g(["Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!"])))),wte.informational($localize(ur||(ur=_g(["Passing"]))),$localize(cr||(cr=_g(["It can happen that you have no possible move to make.\n        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>\n        This is a situation that occurs here for Dark."]))),new vie([[wie,wie,_ie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie],[wie,Cie,Pie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie],[Cie,Cie,Sie,Cie,Cie,Cie,Cie,Sie,_ie,Oie,Cie],[Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,wie],[Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,wie,wie]],0,!1)),wte.fromMove($localize(lr||(lr=_g(["End of the game"]))),$localize(fr||(fr=_g(["When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>\n        Make your last move."]))),new vie([[wie,wie,_ie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie],[wie,Cie,Eie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie],[Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,_ie,Oie,Cie],[Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,wie],[Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,Cie,wie,wie]],0,!1),[pie.of(new Zee(2,1),new Zee(2,0))],$localize(hr||(hr=_g(["Congratulations, you won 6 - 0!"]))),$localize(dr||(dr=_g(["Bad idea, by moving on the source you would have won a point."]))))]});function Aie(e,t){if(1&e&&(cC(),nP(0,"circle",10)),2&e){var n=fP().$implicit,r=fP().$implicit,i=fP();Xb("ngClass",i.getPieceClasses(n)),$b("cx",i.getCenterAt(r).x)("cy",i.getCenterAt(r).y)("r",i.SPACE_SIZE)}}function Rie(e,t){if(1&e&&(cC(),nP(0,"polygon",11)),2&e){var n=fP().$implicit,r=fP().$implicit,i=fP();$b("transform",1===n.getSize()?"translate("+(i.getCenterAt(r).x-18)+" "+(i.getCenterAt(r).y-16)+") scale(0.10)":"translate("+(i.getCenterAt(r).x-3)+" "+(i.getCenterAt(r).y-12)+") scale(0.07)")}}function Mie(e,t){if(1&e){var n=aP();cC(),eP(0,"text",12),uP("click",function(){Nk(n);var e=fP(2).$implicit;return fP().onClick(e.x,e.y)}),FP(1),tP()}if(2&e){var r=fP().$implicit,i=fP().$implicit,a=fP();$b("x",r.containsSource()?a.getCenterAt(i).x-7:a.getCenterAt(i).x)("y",a.getCenterAt(i).y),pE(1),UP(r.getSize())}}function xie(e,t){if(1&e){var n=aP();cC(),eP(0,"g",5),uP("click",function(){Nk(n);var e=fP().$implicit;return fP().onClick(e.x,e.y)}),nP(1,"polyline",6),Yb(2,Aie,1,4,"circle",7),Yb(3,Rie,1,1,"polygon",8),Yb(4,Mie,2,3,"text",9),tP()}if(2&e){var r=t.$implicit,i=fP().$implicit,a=fP();vP("id","click_",i.x,"_",i.y,""),pE(1),$b("points",a.getHexaCoordsAt(i)),pE(1),Xb("ngIf",r.getSize()>0),pE(1),Xb("ngIf",r.containsSource()),pE(1),Xb("ngIf",r.getSize()>1)}}var Nie=function(e){return[e]};function Die(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,xie,5,6,"g",4),tP()),2&e){var n=t.$implicit,r=fP();pE(1),Xb("ngForOf",oT(1,Nie,r.state.getPieceAt(n)))}}function Lie(e,t){if(1&e&&(cC(),eP(0,"text",16),FP(1),tP()),2&e){var n=fP().$implicit,r=fP();$b("x",r.getCenterAt(n.coord).x)("y",r.getCenterAt(n.coord).y),pE(1),UP(n.caseContent.getSize())}}function Fie(e,t){if(1&e&&(cC(),eP(0,"g"),nP(1,"polyline",13),nP(2,"circle",14),Yb(3,Lie,2,3,"text",15),tP()),2&e){var n=t.$implicit,r=fP();pE(1),$b("points",r.getHexaCoordsAt(n.coord)),pE(1),vP("id","captured_",n.coord.x,"_",n.coord.y,""),Xb("ngClass",r.getPieceClasses(n.caseContent)),$b("cx",r.getCenterAt(n.coord).x)("cy",r.getCenterAt(n.coord).y)("r",r.SPACE_SIZE),pE(1),Xb("ngIf",n.caseContent.getSize()>1)}}function Uie(e,t){if(1&e&&(cC(),rP(0),nP(1,"polyline",17),nP(2,"polyline",17),iP()),2&e){var n=fP();pE(1),$b("points",n.getHexaCoordsAt(n.lastMove.get().coord)),pE(1),$b("points",n.getHexaCoordsAt(n.lastMove.get().end))}}function Vie(e,t){if(1&e&&(cC(),nP(0,"polyline",18)),2&e){var n=fP();$b("points",n.getHexaCoordsAt(n.chosen.get()))}}var Bie=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).lastMove=fB.empty(),r.chosen=fB.empty(),r.disconnecteds=[],r.rules=new yie(vie),r.availableMinimaxes=[new mie(r.rules,"DvonnMinimax"),new kie(r.rules,"DvonnMinimaxMaximizeStacks")],r.encoder=pie.encoder,r.tutorial=(new Iie).tutorial,r.SPACE_SIZE=30,r.canPass=!1,r.scores=fB.of(yie.getScores(r.rules.node.gameState)),r.hexaLayout=new Kee(1.5*r.SPACE_SIZE,new Zee(-r.SPACE_SIZE,2*r.SPACE_SIZE),Xee.INSTANCE),r.state=r.rules.node.gameState,r.hexaBoard=r.rules.node.gameState.board,r}return Wg(n,[{key:"hideLastMove",value:function(){this.lastMove=fB.empty()}},{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.state=this.rules.node.gameState,this.lastMove=this.rules.node.move,this.disconnecteds=[],this.lastMove.isPresent()?this.calculateDisconnecteds():this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=fB.of(yie.getScores(this.state))}},{key:"calculateDisconnecteds",value:function(){for(var e=this.rules.node.mother.get().gameState,t=this.rules.node.gameState,n=0;n<t.board.length;n++)for(var r=0;r<t.board[n].length;r++){var i=new Zee(r,n);if(!0===t.isOnBoard(i)&&!1===i.equals(this.lastMove.get().coord)){var a=t.getPieceAt(i),o=e.getPieceAt(i);if(a.isEmpty()&&!o.isEmpty()){var s={coord:new Zee(r,n),caseContent:o};this.disconnecteds.push(s)}}}}},{key:"cancelMoveAttempt",value:function(){this.chosen=fB.empty()}},{key:"pass",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return v7(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),t.next=3,e.chooseMove(pie.PASS,e.rules.node.gameState);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=5;break}r.t0=n.cancelMove(i.getReason()),r.next=18;break;case 5:if(!n.chosen.isAbsent()){r.next=9;break}r.t1=n.choosePiece(e,t),r.next=17;break;case 9:if(!n.chosen.equalsValue(new Zee(e,t))){r.next=13;break}r.t2=(n.cancelMoveAttempt(),pB.SUCCESS),r.next=16;break;case 13:return r.next=15,n.chooseDestination(e,t);case 15:r.t2=r.sent;case 16:r.t1=r.t2;case 17:r.t0=r.t1;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=new Zee(e,t),r=this.rules.isMovablePiece(this.rules.node.gameState,n);return r.isSuccess()?(this.chosen=fB.of(n),pB.SUCCESS):this.cancelMove(r.getReason())}},{key:"chooseDestination",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new Zee(e,t),o=pie.of(i,a),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 2:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e){if(e.containsSource()&&1===e.getSize())return["other-piece","dashed-stroke"];var t=this.getPlayerClass(e.getOwner());return e.containsSource()?[t,"other-piece-stroke","dashed-stroke"]:[t]}}]),n}(Wee);return e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-dvonn"]],features:[Rb],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"ngClass",4,"ngIf"],["class","other-piece-light","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"other-piece-light"],["dy","13",1,"text-center","text-medium",3,"click"],[1,"base","mid-stroke","captured"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-big","dy","17",4,"ngIf"],["dy","17",1,"text-center","text-big"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","selected"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),Yb(1,Die,2,3,"g",1),Yb(2,Fie,4,8,"g",1),Yb(3,Uie,3,2,"ng-container",2),Yb(4,Vie,1,1,"polyline",3),tP()),2&e&&(pE(1),Xb("ngForOf",t.state.allCoords()),pE(1),Xb("ngForOf",t.disconnecteds),pE(1),Xb("ngIf",t.lastMove.isPresent()),pE(1),Xb("ngIf",t.chosen.isPresent()))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),zie=(function(e){e[e.NONE=0]="NONE",e[e.SMALL=1]="SMALL",e[e.MEDIUM=2]="MEDIUM",e[e.BIG=3]="BIG"}(zie||(zie={})),zie),Hie=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,[{key:"getPlayer",value:function(){switch(this){case e.SMALL_DARK:case e.MEDIUM_DARK:case e.BIG_DARK:return R7.ZERO;case e.SMALL_LIGHT:case e.MEDIUM_LIGHT:case e.BIG_LIGHT:return R7.ONE;default:return A7.NONE}}},{key:"getSize",value:function(){switch(this){case e.BIG_DARK:case e.BIG_LIGHT:return zie.BIG;case e.MEDIUM_DARK:case e.MEDIUM_LIGHT:return zie.MEDIUM;case e.SMALL_DARK:case e.SMALL_LIGHT:return zie.SMALL;default:return oB.expectToBe(this,e.NONE),zie.NONE}}},{key:"belongsTo",value:function(e){return this.getPlayer()===e}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){switch(this){case e.BIG_DARK:return"BIG_DARK";case e.BIG_LIGHT:return"BIG_LIGHT";case e.MEDIUM_DARK:return"MEDIUM_DARK";case e.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case e.SMALL_DARK:return"SMALL_DARK";case e.SMALL_LIGHT:return"SMALL_LIGHT";default:return oB.expectToBe(this,e.NONE),"EMPTY"}}}],[{key:"of",value:function(e){switch(e){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}},{key:"ofSizeAndPlayer",value:function(t,n){return n===R7.ZERO&&t===zie.BIG?e.BIG_DARK:n===R7.ZERO&&t===zie.MEDIUM?e.MEDIUM_DARK:n===R7.ZERO&&t===zie.SMALL?e.SMALL_DARK:n===R7.ONE&&t===zie.BIG?e.BIG_LIGHT:n===R7.ONE&&t===zie.MEDIUM?e.MEDIUM_LIGHT:n===R7.ONE&&t===zie.SMALL?e.SMALL_LIGHT:e.NONE}}]),e}();Hie.SMALL_DARK=new Hie(0),Hie.SMALL_LIGHT=new Hie(1),Hie.MEDIUM_DARK=new Hie(2),Hie.MEDIUM_LIGHT=new Hie(3),Hie.BIG_DARK=new Hie(4),Hie.BIG_LIGHT=new Hie(5),Hie.NONE=new Hie(6);var Gie=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r)).remainingPieces=i,a}return Wg(n,[{key:"getRemainingPieces",value:function(){return D7.copyImmutableArray(this.remainingPieces)}},{key:"getRemainingPiecesOfPlayer",value:function(e){return this.getRemainingPieces().filter(function(t){return t.getPlayer()===e})}},{key:"pieceBelongsToCurrentPlayer",value:function(e){return e.belongsTo(this.getCurrentPlayer())}},{key:"isDroppable",value:function(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}},{key:"isInRemainingPieces",value:function(e){return this.remainingPieces.some(function(t){return t===e})}},{key:"getPlayerRemainingPieces",value:function(){var e=this;return this.remainingPieces.filter(function(t){return e.pieceBelongsToCurrentPlayer(t)})}}],[{key:"getInitialState",value:function(){var e=new $ie(A7.NONE,A7.NONE,A7.NONE).encode(),t=D7.createTable(3,3,e);return new n(D7.mapBiArray(t,function(e){return $ie.decode(e)}),0,[Hie.BIG_DARK,Hie.BIG_DARK,Hie.BIG_LIGHT,Hie.BIG_LIGHT,Hie.MEDIUM_DARK,Hie.MEDIUM_DARK,Hie.MEDIUM_LIGHT,Hie.MEDIUM_LIGHT,Hie.SMALL_DARK,Hie.SMALL_DARK,Hie.SMALL_LIGHT,Hie.SMALL_LIGHT])}}]),n}(ote),$ie=function(){function e(t,n,r){Zg(this,e),this.small=t,this.medium=n,this.big=r}return Wg(e,[{key:"isEmpty",value:function(){return this.small===A7.NONE&&this.medium===A7.NONE&&this.big===A7.NONE}},{key:"toList",value:function(){var e=[];return this.small.isPlayer()&&e.push(Hie.ofSizeAndPlayer(zie.SMALL,this.small)),this.medium.isPlayer()&&e.push(Hie.ofSizeAndPlayer(zie.MEDIUM,this.medium)),this.big.isPlayer()&&e.push(Hie.ofSizeAndPlayer(zie.BIG,this.big)),e}},{key:"toOrderedPieceNames",value:function(){var e=Hie.ofSizeAndPlayer(zie.SMALL,this.small),t=Hie.ofSizeAndPlayer(zie.MEDIUM,this.medium),n=Hie.ofSizeAndPlayer(zie.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}},{key:"getBiggest",value:function(){return this.big===R7.ZERO?Hie.BIG_DARK:this.big===R7.ONE?Hie.BIG_LIGHT:this.medium===R7.ZERO?Hie.MEDIUM_DARK:this.medium===R7.ONE?Hie.MEDIUM_LIGHT:this.small===R7.ZERO?Hie.SMALL_DARK:this.small===R7.ONE?Hie.SMALL_LIGHT:Hie.NONE}},{key:"tryToSuperposePiece",value:function(e){var t=this.getBiggest().getSize();if(e===Hie.NONE)throw new Error("Cannot move EMPTY on a space");return e.getSize()>t?fB.of(this.put(e)):fB.empty()}},{key:"removeBiggest",value:function(){var t,n=this.getBiggest();if(n===Hie.NONE)throw new Error("Cannot removed piece from empty space");var r=n.getSize();switch(r){case zie.BIG:t=new e(this.small,this.medium,A7.NONE);break;case zie.MEDIUM:t=new e(this.small,A7.NONE,A7.NONE);break;default:oB.expectToBe(r,zie.SMALL),t=new e(A7.NONE,A7.NONE,A7.NONE)}return{removedCase:t,removedPiece:n}}},{key:"put",value:function(t){if(t===Hie.NONE)throw new Error("Cannot put NONE on space");var n=t.getPlayer(),r=t.getSize();switch(r){case zie.BIG:return new e(this.small,this.medium,n);case zie.MEDIUM:return v7(this.big===A7.NONE,"Cannot put a piece on top of a bigger one"),new e(this.small,n,this.big);default:return oB.expectToBe(r,zie.SMALL),v7(this.big===A7.NONE,"Cannot put a piece on top of a bigger one"),v7(this.medium===A7.NONE,"Cannot put a piece on top of a bigger one"),new e(n,this.medium,this.big)}}},{key:"encode",value:function(){return this.small.value+3*this.medium.value+9*this.big.value}},{key:"belongsTo",value:function(e){return this.getBiggest().getPlayer()===e}},{key:"toString",value:function(){var e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}],[{key:"decode",value:function(t){v7(t%1==0,"EncapsuleCase must be encoded as integer: "+t),v7(t>=0,"To small representation for EncapsuleCase: "+t),v7(t<=26,"To big representation for EncapsuleCase: "+t);var n=R7.numberEncoder.decodeNumber(t%3);t-=n.value;var r=R7.numberEncoder.decodeNumber((t/=3)%3);return t-=r.value,new e(n,r,R7.numberEncoder.decodeNumber(t/=3))}}]),e}();$ie.EMPTY=new $ie(A7.NONE,A7.NONE,A7.NONE);var Zie=function(){var e=Wg(function e(){Zg(this,e)});return e.PIECE_OUT_OF_STOCK=function(){return $localize(vr||(vr=_g(["You do not have pieces of this type anymore."])))},e.INVALID_PLACEMENT=function(){return $localize(pr||(pr=_g(["You must put your piece on an empty square or on a smaller piece."])))},e.NOT_DROPPABLE=function(){return $localize(gr||(gr=_g(["You must pick your piece among the remaining ones."])))},e.INVALID_PIECE_SELECTED=function(){return $localize(yr||(yr=_g(["You must pick one of your remaining pieces or one piece on the board that is the biggest of its square."])))},e.SAME_DEST_AS_ORIGIN=function(){return $localize(mr||(mr=_g(["You must select a different landing square than the square where the move originates from."])))},e.END_YOUR_MOVE=function(){return $localize(kr||(kr=_g(["You are performing a move, you must select a landing square."])))},e}(),qie=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){var r,i=t.getCopiedBoard(),a=t.getRemainingPieces(),o=t.turn+1;if(i[e.landingCoord.y][e.landingCoord.x]=$ie.decode(n.encode()),e.isDropping()){r=e.piece.get();var s=a.indexOf(r);a=a.slice(0,s).concat(a.slice(s+1))}else{var u=e.startingCoord.get(),c=i[u.y][u.x].encode(),l=$ie.decode(c).removeBiggest();i[u.y][u.x]=$ie.decode(l.removedCase.encode()),r=l.removedPiece}return new Gie(i,o,a)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isVictory",value:function(e){var t,r=e.getCopiedBoard(),i=Hg(n.LINES);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=n.isVictoriousLine([r[a[0].y][a[0].x],r[a[1].y][a[1].x],r[a[2].y][a[2].x]]);if(o.isPresent())return o}}catch(s){i.e(s)}finally{i.f()}return fB.empty()}},{key:"isVictoriousLine",value:function(e){var t=e.map(function(e){return e.getBiggest()}).map(function(e){return e.getPlayer()});return t[0]===A7.NONE?fB.empty():t[0]===t[1]&&t[1]===t[2]?fB.of(t[0]):fB.empty()}},{key:"isLegal",value:function(e,t){var n;if(sB(!1,e.toString()),e.isDropping()){if(n=e.piece.get(),!1===t.pieceBelongsToCurrentPlayer(n))return hB.failure(ete.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.isInRemainingPieces(n))return hB.failure(Zie.PIECE_OUT_OF_STOCK())}else{var r=e.startingCoord.get();if(n=t.getPieceAt(r).getBiggest(),!1===t.pieceBelongsToCurrentPlayer(n))return hB.failure(ete.MUST_CHOOSE_PLAYER_PIECE())}var i=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return i.isPresent()?hB.success(i.get()):hB.failure(Zie.INVALID_PLACEMENT())}},{key:"getGameStatus",value:function(e){var t=n.isVictory(e.gameState);return t.isPresent()?gte.getVictory(t.get()):gte.ONGOING}}]),n}(yte);qie.LINES=[[new Zee(0,0),new Zee(0,1),new Zee(0,2)],[new Zee(1,0),new Zee(1,1),new Zee(1,2)],[new Zee(2,0),new Zee(2,1),new Zee(2,2)],[new Zee(0,0),new Zee(1,0),new Zee(2,0)],[new Zee(0,1),new Zee(1,1),new Zee(2,1)],[new Zee(0,2),new Zee(1,2),new Zee(2,2)],[new Zee(0,0),new Zee(1,1),new Zee(2,2)],[new Zee(0,2),new Zee(1,1),new Zee(2,0)]];var Wie=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this)).startingCoord=e,a.landingCoord=r,a.piece=i,a}return Wg(n,[{key:"isDropping",value:function(){return this.startingCoord.isAbsent()}},{key:"equals",value:function(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}},{key:"toString",value:function(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}],[{key:"fromMove",value:function(e,t){if(e.equals(t))throw new Error("Starting coord and landing coord must be separate coords");return new n(fB.of(e),t,fB.empty())}},{key:"fromDrop",value:function(e,t){return new n(fB.empty(),t,fB.of(e))}}]),n}(ute);Wie.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 161}},{key:"encodeNumber",value:function(e){var t=e.landingCoord.x,n=e.landingCoord.y;if(e.isDropping()){return 18*e.piece.get().value+6*t+2*n+0}var r=e.startingCoord.get().y;return 54*e.startingCoord.get().x+18*r+6*t+2*n+1}},{key:"decodeNumber",value:function(e){var t=e%2;e-=t;var n=(e/=2)%3;e-=n;var r=(e/=3)%3;e-=r,e/=3;var i=new Zee(r,n);if(0===t){var a=Hie.of(e);return Wie.fromDrop(a,i)}var o=e%3;e-=o;var s=new Zee((e/=3)%3,o);return Wie.fromMove(s,i)}}]),n}(T7));var jie=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getBoardValue",value:function(e){var t=qie.getGameStatus(e);return new nte(t.toBoardValue())}},{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getCurrentPlayer(),a=rte.toComparableObjectSet(n.getPlayerRemainingPieces()),o=0;o<3;o++)for(var s=0;s<3;s++){var u,c=new Zee(s,o),l=Hg(a);try{for(l.s();!(u=l.n()).done;){var f=u.value,h=Wie.fromDrop(f,c);qie.isLegal(h,n).isSuccess()&&t.push(h)}}catch(y){l.e(y)}finally{l.f()}if(r[o][s].belongsTo(i))for(var d=0;d<3;d++)for(var v=0;v<3;v++){var p=new Zee(v,d);if(!p.equals(c)){var g=Wie.fromMove(c,p);qie.isLegal(g,n).isSuccess()&&t.push(g)}}}return t}}]),n}(tte),Yie=new $ie(A7.NONE,A7.NONE,A7.NONE),Kie=new $ie(R7.ZERO,A7.NONE,A7.NONE),Qie=new $ie(A7.NONE,R7.ZERO,A7.NONE),Xie=new $ie(A7.NONE,A7.NONE,R7.ZERO),Jie=new $ie(R7.ONE,A7.NONE,A7.NONE),eae=new $ie(A7.NONE,A7.NONE,R7.ONE),tae=new $ie(R7.ONE,R7.ZERO,A7.NONE),nae=new $ie(R7.ZERO,R7.ZERO,A7.NONE),rae=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(Cr||(Cr=_g(["Goal of the game"]))),$localize(wr||(wr=_g(["The goal of Encapsule is to align three of your pieces.\n        Here, we have a victory of the dark player."]))),new Gie([[Kie,Jie,eae],[Yie,Qie,Yie],[Yie,Yie,Xie]],0,[Hie.SMALL_DARK,Hie.MEDIUM_DARK,Hie.BIG_DARK,Hie.SMALL_LIGHT,Hie.MEDIUM_LIGHT,Hie.MEDIUM_LIGHT,Hie.BIG_LIGHT])),wte.anyMove($localize(_r||(_r=_g(["Putting a piece"]))),$localize(Er||(Er=_g(["This is the initial board. You're playing Dark.<br/><br/>\n        Pick one of your piece on the side of the board and put it on the board."]))),Gie.getInitialState(),Wie.fromDrop(Hie.SMALL_DARK,new Zee(1,1)),$localize(br||(br=_g(["Congratulations!"])))),wte.fromMove($localize(Pr||(Pr=_g(["Moving"]))),$localize(Sr||(Sr=_g(["Another possible action is to move one of your pieces that is already on the board.<br/><br/>\n        Click on your dark piece and then on any empty square of the board."]))),new Gie([[Kie,eae,Yie],[Yie,Yie,Yie],[Yie,Yie,Yie]],0,[]),[Wie.fromMove(new Zee(0,0),new Zee(2,0)),Wie.fromMove(new Zee(0,0),new Zee(0,1)),Wie.fromMove(new Zee(0,0),new Zee(1,1)),Wie.fromMove(new Zee(0,0),new Zee(2,1)),Wie.fromMove(new Zee(0,0),new Zee(0,2)),Wie.fromMove(new Zee(0,0),new Zee(1,2)),Wie.fromMove(new Zee(0,0),new Zee(2,2))],$localize(Or||(Or=_g(["Congratulations!"]))),$localize(Tr||(Tr=_g(["Failed. Try again."])))),wte.fromPredicate($localize(Ir||(Ir=_g(["Particularity"]))),$localize(Ar||(Ar=_g(['At Encapsule, pieces encapsulate each other.\n        It is therefore possible to have up to three pieces per square!\n        However, only the biggest piece of each square counts:\n        you cannot win with a piece that is "hidden" by a bigger piece.\n        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.\n        Finally, you cannot encapsulate a piece with a smaller piece.\n        You\'re playing Dark and you can win now in various ways.<br/><br/>\n        Try to win by making a move, and not by putting a new piece on the board.']))),new Gie([[tae,Yie,Jie],[nae,eae,eae],[Yie,Yie,Yie]],0,[Hie.MEDIUM_DARK,Hie.BIG_DARK,Hie.MEDIUM_LIGHT,Hie.MEDIUM_LIGHT]),Wie.fromMove(new Zee(0,1),new Zee(0,2)),function(e,t,n){if(e.landingCoord.equals(new Zee(0,2))){if(e.isDropping())return pB.failure($localize(Rr||(Rr=_g(["You won, but the exercise is to win while moving a piece!"]))));if(e.startingCoord.equalsValue(new Zee(0,1)))return pB.SUCCESS}return pB.failure($localize(Mr||(Mr=_g(["Failed. Try again."]))))},$localize(xr||(xr=_g(["Congratulations!"]))))]});function iae(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"circle",5),uP("click",function(){var e=Nk(n),t=e.$implicit,r=e.index;return fP().onPieceClick(0,t,r)}),tP(),tP()}if(2&e){var r=t.$implicit,i=t.index,a=fP();pE(1),dP("id","piece_0_",r.toString(),""),Xb("ngClass",a.getSidePieceClasses(r,i)),$b("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(0,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}function aae(e,t){if(1&e){var n=aP();cC(),eP(0,"circle",8),uP("click",function(){Nk(n);var e=fP().index,t=fP().index;return fP().onBoardClick(e,t)}),tP()}if(2&e){var r=t.$implicit,i=fP().index,a=fP().index,o=fP();Xb("ngClass",o.getPieceClasses(r)),$b("r",o.getPieceRadius(r))("cx",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function oae(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"rect",6),uP("click",function(){var e=Nk(n).index,t=fP().index;return fP().onBoardClick(e,t)}),tP(),Yb(2,aae,1,4,"circle",7),tP()}if(2&e){var r=t.$implicit,i=t.index,a=fP().index,o=fP();pE(1),vP("id","click_",i,"_",a,""),Xb("ngClass",o.getRectClasses(i,a)),$b("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),pE(1),Xb("ngForOf",o.getListPieces(r))}}function sae(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,oae,3,8,"g",2),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}function uae(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"rect",9),uP("click",function(){var e=Nk(n).$implicit;return fP().onBoardClick(e.x,e.y)}),tP(),tP()}if(2&e){var r=t.$implicit,i=fP();pE(1),$b("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function cae(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"circle",5),uP("click",function(){var e=Nk(n),t=e.$implicit,r=e.index;return fP().onPieceClick(1,t,r)}),tP(),tP()}if(2&e){var r=t.$implicit,i=t.index,a=fP();pE(1),dP("id","piece_1_",r.toString(),""),Xb("ngClass",a.getSidePieceClasses(r,i)),$b("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(1,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}var lae=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).INTER_PIECE_SPACE=20,r.lastLandingCoord=fB.empty(),r.lastStartingCoord=fB.empty(),r.chosenCoord=fB.empty(),r.chosenPiece=fB.empty(),r.remainingPieceLeftX=[],r.rules=new qie(Gie),r.availableMinimaxes=[new jie(r.rules,"EncapsuleMinimax")],r.encoder=Wie.encoder,r.tutorial=(new rae).tutorial,r.updateBoard(),r}return Wg(n,[{key:"updateBoard",value:function(){this.board=this.rules.node.gameState.getCopiedBoard();var e=this.rules.node.move;this.calculateLeftX(),e.isPresent()?(this.lastLandingCoord=fB.of(e.get().landingCoord),this.lastStartingCoord=e.get().startingCoord):(this.lastLandingCoord=fB.empty(),this.lastStartingCoord=fB.empty())}},{key:"getListPieces",value:function(e){return e.toList()}},{key:"getRemainingPieces",value:function(e){return this.rules.node.gameState.getRemainingPiecesOfPlayer(R7.of(e))}},{key:"onBoardClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new Zee(e,t),o=n.rules.node.gameState,!n.chosenCoord.isAbsent()){r.next=9;break}if(n.chosenCoord=fB.of(a),!n.chosenPiece.isPresent()){r.next=8;break}return s=Wie.fromDrop(n.chosenPiece.get(),a),r.abrupt("return",n.chooseMove(s,n.rules.node.gameState));case 8:return r.abrupt("return",!1===o.getPieceAt(a).belongsTo(o.getCurrentPlayer())?n.cancelMove(Zie.INVALID_PIECE_SELECTED()):pB.SUCCESS);case 9:if(!n.chosenCoord.equalsValue(a)){r.next=11;break}return r.abrupt("return",n.cancelMove(Zie.SAME_DEST_AS_ORIGIN()));case 11:return u=Wie.fromMove(n.chosenCoord.get(),a),r.abrupt("return",n.chooseMove(u,n.rules.node.gameState));case 13:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=fB.empty(),this.chosenPiece=fB.empty(),this.chosenPieceIndex=-1}},{key:"onPieceClick",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=r.canUserPlay("#piece_"+e+"_"+t.toString()),i.abrupt("return",a.isFailure()?r.cancelMove(a.getReason()):!1===r.rules.node.gameState.isDroppable(t)?r.cancelMove(Zie.NOT_DROPPABLE()):r.chosenCoord.isAbsent()?(r.chosenPiece=fB.of(t),r.chosenPieceIndex=n,pB.SUCCESS):r.cancelMove(Zie.END_YOUR_MOVE()));case 2:case"end":return i.stop()}},i)}))()}},{key:"getRectClasses",value:function(e,t){return this.isSelected(e,t)?"moved":""}},{key:"isSelected",value:function(e,t){var n=new Zee(e,t);return!(!this.lastStartingCoord.equalsValue(n)&&!this.lastLandingCoord.equalsValue(n))}},{key:"getPieceClasses",value:function(e){return[this.getPieceStrokeClass(e)]}},{key:"getPieceStrokeClass",value:function(e){var t=e.getPlayer();return v7(t.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+t.value+"-stroke"}},{key:"getPieceRadius",value:function(e){switch(e.getSize()){case zie.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case zie.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return oB.expectToBe(e.getSize(),zie.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}},{key:"getHighlightedCases",value:function(){var e=[];return this.chosenCoord.isPresent()&&e.push(this.chosenCoord.get()),e}},{key:"getSidePieceClasses",value:function(e,t){var n=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex===t&&n.push("clickable "),n}},{key:"isSelectedPiece",value:function(e){return this.chosenPiece.equalsValue(e)}},{key:"calculateLeftX",value:function(){this.remainingPieceLeftX=[];for(var e=0;e<=1;e++){this.remainingPieceLeftX.push([]);for(var t=this.getRemainingPieces(e),n=0;n<t.length;n++)if(0===n)this.remainingPieceLeftX[e].push(0);else{var r=this.remainingPieceLeftX[e][n-1],i=2*this.getPieceRadius(t[n-1]);this.remainingPieceLeftX[e].push(r+i+this.INTER_PIECE_SPACE)}}}},{key:"getPieceLeftX",value:function(e,t){return this.remainingPieceLeftX[e][t]}}]),n}(nne);return e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-encapsule"]],features:[Rb],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 520 520","preserveAspectRatio","xMidYMid meet"],["remainingCasePlayerZero",""],[4,"ngFor","ngForOf"],["boardDiv",""],["remainingCasePlayerOne",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","highlighted",3,"click"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),eP(1,"g",null,1),Yb(3,iae,2,5,"g",2),tP(),eP(4,"g",null,3),Yb(6,sae,2,1,"g",2),Yb(7,uae,2,4,"g",2),tP(),eP(8,"g",null,4),Yb(10,cae,2,5,"g",2),tP(),tP()),2&e&&(pE(1),$b("transform","translate("+t.STROKE_WIDTH+", 0)"),pE(2),Xb("ngForOf",t.getRemainingPieces(0)),pE(1),$b("transform","translate("+(260-1.5*t.SPACE_SIZE-t.STROKE_WIDTH)+", "+t.SPACE_SIZE+")"),pE(2),Xb("ngForOf",t.board),pE(1),Xb("ngForOf",t.getHighlightedCases()),pE(1),$b("transform","translate("+t.STROKE_WIDTH+", "+(2*t.STROKE_WIDTH+4*t.SPACE_SIZE)+")"),pE(2),Xb("ngForOf",t.getRemainingPieces(1)))},directives:[LA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),fae=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o){var s;if(Zg(this,n),(s=t.call(this,e,r)).movedPieces=i,s.stepSize=a,s.direction=o,s.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+s.coord.toString()+".");if(i<1)throw new Error("Must select minimum one piece (got "+i+").");if(a<1)throw new Error("Step size must be minimum one (got "+a+").");if(a>i)throw new Error("Cannot move a phalanx further than its size (got step size "+a+" for "+i+" pieces).");return Lg(s)}return Wg(n,[{key:"toString",value:function(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||this.movedPieces!==e.movedPieces||this.stepSize!==e.stepSize)&&this.direction.equals(e.direction)}}]),n}(cte);fae.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 122303}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 8*e.coord.x*7*13*12+8*e.coord.y*7*13+8*(e.movedPieces-1)*7+8*(e.stepSize-1)+t}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%8;e-=t;var n=(e/=8)%7;e-=n;var r=(e/=7)%13;e-=r;var i=(e/=13)%12;e-=i;var a=e/=12,o=Hee.factory.fromInt(t);return new fae(a,i,r+1,n+1,o.get())}}]),n}(T7));var hae=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"count",value:function(e,t){for(var n=0,r=0;r<14;r++)this.board[t][r]===e&&n++;return n}},{key:"doesOwnPiece",value:function(e){for(var t=0;t<12;t++)for(var n=0;n<14;n++)if(this.board[t][n]===e)return!0;return!1}}],[{key:"getInitialState",value:function(){var e=A7.NONE,t=A7.ZERO,r=A7.ONE;return new n([[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t]],0)}}]),n}(ote),dae=function(){var e=Wg(function e(){Zg(this,e)});return e.PHALANX_IS_LEAVING_BOARD=function(){return $localize(Nr||(Nr=_g(["The move distance of your phalanx puts it out of the board."])))},e.SOMETHING_IN_PHALANX_WAY=function(){return $localize(Dr||(Dr=_g(["There is something in the way of your phalanx."])))},e.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=function(){return $localize(Lr||(Lr=_g(["Your phalanx must be bigger than the one you are capturing."])))},e.SQUARE_NOT_ALIGNED_WITH_SELECTED=function(){return $localize(Fr||(Fr=_g(["This square is not aligned with the selected piece."])))},e.SINGLE_PIECE_MUST_MOVE_BY_ONE=function(){return $localize(Ur||(Ur=_g(["A single piece can only move by one square."])))},e.SINGLE_PIECE_CANNOT_CAPTURE=function(){return $localize(Vr||(Vr=_g(["A single piece cannot make a capture."])))},e.SQUARE_NOT_ALIGNED_WITH_PHALANX=function(){return $localize(Br||(Br=_g(["This square is not aligned with the direction of the phalanx."])))},e.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=function(){return $localize(zr||(zr=_g(["A phalanx can't contain pieces outside of the board."])))},e.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE=function(){return $localize(Hr||(Hr=_g(["A phalanx cannot contain an empty square."])))},e.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=function(){return $localize(Gr||(Gr=_g(["A phalanx cannot contain a piece of the opponent."])))},e}(),vae=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){return new hae(n,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.count(R7.ZERO,0),r=t.count(R7.ONE,11);if(t.turn%2==0){if(n>r)return gte.ZERO_WON}else if(r>n)return gte.ONE_WON;return!1===t.doesOwnPiece(R7.ZERO)?gte.ONE_WON:!1===t.doesOwnPiece(R7.ONE)?gte.ZERO_WON:gte.ONGOING}}],[{key:"isLegal",value:function(e,t){var r=this.getPhalanxValidity(t,e);if(r.isFailure())return hB.failure(r.getReason());var i=this.getLandingStatus(t,e);if(i.isFailure())return i;var a=D7.copyBiArray(i.get()),o=t.getCurrentOpponent(),s=n.getCaptureValidity(t,a,e,o);return s.isFailure()?s:hB.success(s.get())}},{key:"getPhalanxValidity",value:function(e,t){for(var n=t.coord,r=0,i=e.getCurrentOpponent();r<t.movedPieces;){if(n.isNotInRange(14,12))return pB.failure(dae.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());var a=e.getPieceAt(n);if(a===A7.NONE)return pB.failure(dae.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(a===i)return pB.failure(dae.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());n=n.getNext(t.direction,1),r++}return pB.SUCCESS}},{key:"getLandingStatus",value:function(e,t){for(var n=e.getCopiedBoard(),r=e.getCurrentPlayer(),i=t.coord,a=t.coord.getNext(t.direction,t.movedPieces),o=0;o+1<t.stepSize;){if(n[i.y][i.x]=A7.NONE,n[a.y][a.x]=r,a.isNotInRange(14,12))return hB.failure(dae.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(a).isPlayer())return hB.failure(dae.SOMETHING_IN_PHALANX_WAY());o++,a=a.getNext(t.direction,1),i=i.getNext(t.direction,1)}return a.isNotInRange(14,12)?hB.failure(dae.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(a)===r?hB.failure(ete.CANNOT_SELF_CAPTURE()):(n[i.y][i.x]=A7.NONE,n[a.y][a.x]=r,hB.success(n))}},{key:"getCaptureValidity",value:function(e,t,n,r){for(var i=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),a=0;i.isInRange(14,12)&&e.getPieceAt(i)===r;){if(a>0&&(t[i.y][i.x]=A7.NONE),++a>=n.movedPieces)return hB.failure(dae.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(n.direction,1)}return hB.success(t)}}]),n}(yte),pae=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=n.getListMoves(e);return D7.sortByDescending(t,function(e){return e.stepSize}),t}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new nte(t.isEndGame?t.toBoardValue():this.getPieceCountPlusRowDomination(e.gameState))}},{key:"getPieceCountPlusRowDomination",value:function(e){for(var t=0,n=0;n<12;n++){for(var r=0,i=[0,0],a=0;a<14;a++){var o=new Zee(a,n),s=e.getPieceAt(o);if(s.isPlayer()){var u=s.getScoreModifier();t+=2002*u,i[s.value]=u,r+=u;for(var c=0,l=[Hee.UP_LEFT,Hee.UP,Hee.UP_RIGHT];c<l.length;c++)for(var f=l[c],h=o.getNext(f,1);h.isInRange(14,12)&&e.getPieceAt(h)===s;)t+=1*u,h=h.getNext(f,1)}}0!==r&&(t+=Math.abs(r)/r*2),t+=1*i.reduce(function(e,t){return e+t})}return t}}],[{key:"getListMoves",value:function(e){for(var t,n=e.gameState.getCurrentPlayer(),r=e.gameState.getCurrentOpponent(),i=A7.NONE,a=[],o=e.gameState,s=0;s<12;s++)for(var u=0;u<14;u++){var c=new Zee(u,s);if(o.getPieceAt(c)===n){var l,f=Hg(Hee.DIRECTIONS);try{for(f.s();!(l=f.n()).done;){for(var h=l.value,d=1,v=c.getNext(h,1);v.isInRange(14,12)&&o.getPieceAt(v)===n;)d+=1,v=v.getNext(h,1);for(var p=1;v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===i;)t=new fae(u,s,d,p,h),a=this.addMove(a,t,o),p++,v=v.getNext(h,1);v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===r&&(t=new fae(u,s,d,p,h),a=this.addMove(a,t,o))}}catch(g){f.e(g)}finally{f.f()}}}return a}},{key:"addMove",value:function(e,t,n){return vae.isLegal(t,n).isSuccess()&&e.push(t),e}}]),n}(tte),gae=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=pae.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}},{key:"orderMovesByPhalanxSizeAndFilter",value:function(e,t){var n=this;return D7.sortByDescending(e,function(e){return e.movedPieces}),e.length>40?e.filter(function(e){return!!n.moveIsCapture(e,t)||e.movedPieces*Math.random()>1}):e}},{key:"moveIsCapture",value:function(e,t){var n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new nte(t.isEndGame?t.toBoardValue():this.getPieceCountThenSupportThenAdvancement(e.gameState))}},{key:"getPieceCountThenSupportThenAdvancement",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=new Zee(r,n),a=e.getPieceAt(i);if(a.isPlayer()){var o=void 0,s=void 0;a===R7.ZERO?(o=12-n,s=[Hee.UP_LEFT,Hee.UP,Hee.UP_RIGHT]):(o=n+1,s=[Hee.DOWN_LEFT,Hee.DOWN,Hee.DOWN_RIGHT]);var u=a.getScoreModifier();t+=o*u,t+=149629*u;var c,l=Hg(s);try{for(l.s();!(c=l.n()).done;)for(var f=c.value,h=i.getNext(f,1);h.isInRange(14,12)&&e.getPieceAt(h)===a;)t+=337*u,h=h.getNext(f,1)}catch(d){l.e(d)}finally{l.f()}}}return t}}]),n}(tte),yae=function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).DOMINANCE_FACTOR=20,e.DEFENSE_FACTOR=5,e.TERRITORY_FACTOR=2,e.OFFENSE_FACTOR=10,e.CENTER_FACTOR=5,e.MOBILITY_FACTOR=.12,e}return Wg(n,[{key:"getDominance",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new Zee(r,n));i.isPlayer()&&(t+=i.getScoreModifier())}return t*this.DOMINANCE_FACTOR}},{key:"getDefense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new Zee(n,11))===R7.ZERO&&(t+=R7.ZERO.getScoreModifier()),e.getPieceAt(new Zee(n,0))===R7.ONE&&(t+=R7.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}},{key:"getTerritory",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new Zee(r,n));if(i.isPlayer()){for(var a=-1;a<=1;a++)for(var o=-1;o<=1;o++){var s=new Zee(r+a,n+o);if(s.isInRange(14,12)){var u=e.getPieceAt(s);(u===i||u===A7.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}},{key:"getOffense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new Zee(n,0))===R7.ZERO&&(t+=R7.ZERO.getScoreModifier()),e.getPieceAt(new Zee(n,11))===R7.ONE&&(t+=R7.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}},{key:"getCenter",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new Zee(r,n));i.isPlayer()&&(t+=i.getScoreModifier()*Math.sqrt((r-6.5)*(r-6.5)))}return t*this.CENTER_FACTOR}},{key:"getMobility",value:function(e){for(var t=0,n=0,r=0,i=0;i<12;i++)for(var a=0;a<14;a++){var o=new Zee(a,i),s=e.getPieceAt(o);if(s.isPlayer()){var u,c=Hg(Hee.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){for(var l=u.value,f=1,h=o.getNext(l,1);h.isInRange(14,12)&&e.getPieceAt(h)===s;)f+=1,h=h.getNext(l,1);for(var d=1;h.isInRange(14,12)&&d<=f&&e.getPieceAt(h)===A7.NONE;)d++,h=h.getNext(l,1);t+=d*d*s.getScoreModifier(),s===R7.ZERO?n=Math.max(n,d):s===R7.ONE&&(r=Math.max(r,d))}}catch(v){c.e(v)}finally{c.f()}}}return(t+n*R7.ZERO.getScoreModifier()+r*R7.ONE.getScoreModifier())*this.MOBILITY_FACTOR}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getGameStatus(e);if(n.isEndGame)return new nte(n.toBoardValue());var r=this.getDominance(t),i=this.getDefense(t),a=this.getTerritory(t),o=this.getCenter(t),s=this.getOffense(t),u=this.getMobility(t);return new nte(r+i+a+o+s+u)}}]),n}(pae),mae=A7.NONE,kae=A7.ZERO,Cae=A7.ONE,wae=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize($r||($r=_g(["Initial board"]))),$localize(Zr||(Zr=_g(["This is the initial board of Epaminondas.\n        The top line is the starting line of Light.\n        The bottom line is the starting line of Dark."]))),hae.getInitialState()),wte.informational($localize(qr||(qr=_g(["Goal of the game (1/2)"]))),$localize(Wr||(Wr=_g(["After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line\n        than the number of pieces the opponent has on the player's starting line, the player wins.\n        Here, it's Dark's turn to play: Dark has therefore won."]))),new hae([[mae,mae,mae,mae,mae,kae,mae,mae,Cae,Cae,Cae,Cae,Cae,Cae],[mae,mae,mae,mae,mae,kae,mae,mae,mae,mae,mae,mae,Cae,Cae],[mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,Cae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,kae,kae,kae,kae,mae,mae,mae]],0)),wte.informational($localize(jr||(jr=_g(["Goal of the game (2/2)"]))),$localize(Yr||(Yr=_g(["Here, it is Light's turn.\n        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line."]))),new hae([[mae,mae,mae,mae,mae,kae,mae,mae,mae,mae,Cae,Cae,Cae,Cae],[mae,mae,mae,mae,mae,kae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,Cae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,Cae,Cae,mae,mae,mae,kae,kae,mae,kae,kae,kae,kae]],1)),wte.fromPredicate($localize(Kr||(Kr=_g(["Moving a piece"]))),$localize(Qr||(Qr=_g(["Here is the starting board. Dark plays first.\n        Let's start with moving a single piece:\n        <ol>\n            <li>Click on a piece.</li>\n            <li>Click on a empty neighboring square.</li>\n        </ol>"]))),hae.getInitialState(),new fae(0,10,1,1,Hee.UP),function(e,t,n){return 1===e.movedPieces?pB.SUCCESS:pB.failure($localize(Xr||(Xr=_g(["Congratulations, you are in advance. But this is not the exercise here, try again."]))))},$localize(Jr||(Jr=_g(["This is how you move a single piece."])))),wte.fromPredicate($localize(ei||(ei=_g(["Moving a phalanx"]))),$localize(ti||(ti=_g(["Let us now see how to move multiple pieces along a line, which is called a phalanx:\n        <ol>\n            <li>Click on the first piece of the phalanx.</li>\n            <li>Click on the last piece of the phalanx.</li>\n            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>\n        </ol><br/>\n        Move a phalanx!"]))),hae.getInitialState(),new fae(0,11,2,1,Hee.UP),function(e,t,n){return e.movedPieces>1?pB.SUCCESS:pB.failure($localize(ni||(ni=_g(["Failed! You moved only one piece."]))))},$localize(ri||(ri=_g(["Congratulations!\n        The moved pieces can be horizontally, vertically, or diagonally aligned.\n        The move should be made along this axis, forward or backwards.\n        There can be no opponent nor holes in the phalanx."])))),wte.fromMove($localize(ii||(ii=_g(["Capture"]))),$localize(ai||(ai=_g(["In order to capture pieces of the opponent:\n        <ol>\n            <li>It must be aligned with the phalanx you are moving.</li>\n            <li>It must be strictly shorter than your phalanx.</li>\n            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>\n        </ol><br/>\n        Capture a phalanx."]))),new hae([[mae,mae,mae,mae,mae,mae,mae,mae,Cae,Cae,Cae,Cae,Cae,Cae],[mae,mae,mae,mae,mae,mae,Cae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,Cae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,Cae,mae,Cae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,Cae,Cae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,Cae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,kae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,kae,mae,mae,mae,mae,Cae,mae,mae,mae,mae,mae,mae],[mae,mae,kae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,kae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae,mae],[mae,mae,mae,mae,mae,mae,mae,kae,kae,kae,kae,kae,kae,kae]],0),[new fae(2,10,4,2,Hee.UP)],$localize(oi||(oi=_g(["Congratulations, you made it!\n        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment."]))),$localize(si||(si=_g(["Failed, you have not captured the phalanx."]))))]});function _ae(e,t){if(1&e){var n=aP();cC(),eP(0,"circle",4),uP("click",function(){Nk(n);var e=fP().index,t=fP().index;return fP().onClick(e,t)}),tP()}if(2&e){var r=fP().index,i=fP().index,a=fP();Xb("ngClass",a.getPieceClasses(r,i)),$b("cx",a.SPACE_SIZE*r+a.STROKE_WIDTH+a.SPACE_SIZE/2)("cy",a.SPACE_SIZE*i+a.STROKE_WIDTH+a.SPACE_SIZE/2)("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)}}function Eae(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"rect",2),uP("click",function(){var e=Nk(n).index,t=fP().index;return fP().onClick(e,t)}),tP(),Yb(2,_ae,1,4,"circle",3),tP()}if(2&e){var r=t.index,i=fP().index,a=fP();pE(1),vP("id","click_",r,"_",i,""),Xb("ngClass",a.getRectClasses(r,i)),$b("x",a.SPACE_SIZE*r+a.STROKE_WIDTH)("y",a.SPACE_SIZE*i+a.STROKE_WIDTH)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),pE(1),Xb("ngIf",a.board[i][r]!==a.NONE)}}function bae(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Eae,3,8,"g",1),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}function Pae(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"rect",5),uP("click",function(){var e=Nk(n).$implicit;return fP().onClick(e.x,e.y)}),tP(),tP()}if(2&e){var r=t.$implicit,i=fP();pE(1),$b("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var Sae=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).NONE=A7.NONE,r.firstPiece=fB.empty(),r.validExtensions=[],r.phalanxValidLandings=[],r.lastPiece=fB.empty(),r.phalanxDirection=fB.empty(),r.phalanxMiddles=[],r.moveds=[],r.captureds=[],r.rules=new vae(hae),r.availableMinimaxes=[new pae(r.rules,"Normal"),new gae(r.rules,"Positional"),new yae(r.rules,"Attack")],r.encoder=fae.encoder,r.tutorial=(new wae).tutorial,r.updateBoard(),r}return Wg(n,[{key:"updateBoard",value:function(){this.firstPiece=fB.empty(),this.lastPiece=fB.empty(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.board=this.rules.node.gameState.getCopiedBoard()}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get(),t=e.coord;this.moveds=[t];for(var n=1;n<e.stepSize+e.movedPieces;n++)t=t.getNext(e.direction,1),this.moveds.push(t);for(var r=this.rules.node.mother.get(),i=r.gameState.getCurrentOpponent();t.isInRange(14,12)&&r.gameState.getPieceAt(t)===i;)this.captureds.push(t),t=t.getNext(e.direction,1)}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.firstPiece.isAbsent()?n.firstClick(e,t):n.lastPiece.isAbsent()?n.secondClick(e,t):n.thirdClick(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=n.rules.node.gameState.getCurrentOpponent(),a=n.rules.node.gameState.getCurrentPlayer(),r.t0=n.board[t][e],r.next=r.t0===a?4:r.t0===i?5:6;break;case 4:return r.abrupt("return",(n.firstPiece=fB.of(new Zee(e,t)),n.validExtensions=n.getValidExtensions(a),n.phalanxValidLandings=n.getPhalanxValidLandings(),pB.SUCCESS));case 5:return r.abrupt("return",n.cancelMove(ete.CANNOT_CHOOSE_OPPONENT_PIECE()));case 6:return r.abrupt("return",(oB.expectToBe(n.board[t][e],A7.NONE),n.cancelMove(ete.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())));case 7:case"end":return r.stop()}},r)}))()}},{key:"hidePreviousMove",value:function(){this.captureds=[],this.moveds=[]}},{key:"getValidExtensions",value:function(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}},{key:"getFirstPieceExtensions",value:function(e){var t,n=[],r=Hg(Hee.DIRECTIONS);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.firstPiece.get().getNext(i,1);a.isInRange(14,12)&&this.board[a.y][a.x]===e;)n.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPhalanxValidExtensions",value:function(e){var t=Hee.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get(),n=this.lastPiece.get().getNext(t,1),r=this.getExtensionsToward(n,t,e);t=t.getOpposite();var i=this.firstPiece.get().getNext(t,1),a=this.getExtensionsToward(i,t,e);return r.concat(a)}},{key:"getExtensionsToward",value:function(e,t,n){for(var r=[];e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r.push(e),e=e.getNext(t,1);return r}},{key:"getPhalanxValidLandings",value:function(){if(this.lastPiece.isPresent()){var e=this.firstPiece.get(),t=this.lastPiece.get(),n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y),i=Math.max(n,r)+1,a=Hee.factory.fromMove(e,t).get(),o=t.getNext(a,1),s=this.getLandingsToward(o,a,i);a=a.getOpposite();var u=e.getNext(a,1);return this.getLandingsToward(u,a,i).concat(s)}return this.getNeighboringEmptyCases()}},{key:"getNeighboringEmptyCases",value:function(){var e,t=[],n=Hg(Hee.DIRECTIONS);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.firstPiece.get().getNext(r,1);i.isInRange(14,12)&&this.board[i.y][i.x]===A7.NONE&&t.push(i)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"getLandingsToward",value:function(e,t,n){for(var r=this.rules.node.gameState.getCurrentPlayer(),i=this.rules.node.gameState.getCurrentOpponent(),a=[];e.isInRange(14,12)&&a.length<n&&this.board[e.y][e.x]!==r;){if(this.board[e.y][e.x]===i)return this.getPhalanxLength(e,t,i)<n&&a.push(e),a;a.push(e),e=e.getNext(t,1)}return a}},{key:"getPhalanxLength",value:function(e,t,n){for(var r=0;e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r++,e=e.getNext(t,1);return r}},{key:"cancelMoveAttempt",value:function(){this.firstPiece=fB.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=fB.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}},{key:"secondClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,f;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new Zee(e,t),a=n.firstPiece.get(),!i.equals(a)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),pB.SUCCESS));case 3:if(o=n.rules.node.gameState.getCurrentOpponent(),s=n.rules.node.gameState.getCurrentPlayer(),i.isAlignedWith(a)){r.next=6;break}return r.abrupt("return",n.cancelMove(dae.SQUARE_NOT_ALIGNED_WITH_SELECTED()));case 6:u=i.getDistance(a),c=a.getDirectionToward(i).get(),r.t0=n.board[t][e],r.next=r.t0===A7.NONE?10:r.t0===o?11:12;break;case 10:return r.abrupt("return",1===u?n.tryMove(new fae(a.x,a.y,1,1,c)):n.cancelMove(dae.SINGLE_PIECE_MUST_MOVE_BY_ONE()));case 11:return r.abrupt("return",n.cancelMove(dae.SINGLE_PIECE_CANNOT_CAPTURE()));case 12:return oB.expectToBe(n.board[t][e],s),l=new fae(a.x,a.y,u,1,c),f=vae.getPhalanxValidity(n.rules.node.gameState,l),r.abrupt("return",f.isFailure()?n.cancelMove(f.getReason()):(n.lastPiece=fB.of(i),n.validExtensions=n.getValidExtensions(s),n.phalanxValidLandings=n.getPhalanxValidLandings(),n.phalanxMiddles=a.getCoordsToward(i),n.phalanxDirection=fB.of(c),pB.SUCCESS));case 15:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,f,h,d,v,p;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.rules.node.gameState.getCurrentPlayer(),a=new Zee(e,t),!n.firstPiece.equalsValue(a)){r.next=3;break}return r.abrupt("return",n.moveFirstPiece(i));case 3:if(!n.lastPiece.equalsValue(a)){r.next=5;break}return r.abrupt("return",n.moveLastPiece(i));case 5:if(o=n.firstPiece.get(),s=n.lastPiece.get(),a.isAlignedWith(o)){r.next=8;break}return r.abrupt("return",n.cancelMove(dae.SQUARE_NOT_ALIGNED_WITH_PHALANX()));case 8:if(u=Hee.factory.fromMove(o,s).get(),c=Hee.factory.fromMove(o,a).get(),u===c.getOpposite()&&(n.firstPiece=fB.of(s),n.lastPiece=fB.of(o),u=c),u===c){r.next=12;break}return r.abrupt("return",n.cancelMove(dae.SQUARE_NOT_ALIGNED_WITH_PHALANX()));case 12:if(n.board[t][e]!==i){r.next=16;break}return n.lastPiece=fB.of(a),l=n.firstPiece.get().getDistance(a)+1,f=new fae(n.firstPiece.get().x,n.firstPiece.get().y,l,1,u),h=vae.getPhalanxValidity(n.rules.node.gameState,f),r.abrupt("return",h.isFailure()?n.cancelMove(h.getReason()):(n.phalanxMiddles=n.firstPiece.get().getCoordsToward(n.lastPiece.get()),n.validExtensions=n.getValidExtensions(i),n.phalanxValidLandings=n.getPhalanxValidLandings(),pB.SUCCESS));case 16:return d=n.firstPiece.get().getDistance(n.lastPiece.get())+1,v=n.lastPiece.get().getDistance(a),p=new fae(n.firstPiece.get().x,n.firstPiece.get().y,d,v,u),r.abrupt("return",n.tryMove(p));case 18:case"end":return r.stop()}},r)}))()}},{key:"moveFirstPiece",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.firstPiece=fB.of(t.firstPiece.get().getNext(t.phalanxDirection.get(),1)),!t.firstPiece.equals(t.lastPiece)){n.next=6;break}return n.next=4,t.moveOnlyPiece(e);case 4:n.next=7;break;case 6:t.phalanxMiddles=t.phalanxMiddles.slice(1),t.validExtensions=t.getPhalanxValidExtensions(e);case 7:return t.phalanxValidLandings=t.getPhalanxValidLandings(),n.abrupt("return",pB.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveLastPiece",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=fB.of(t.lastPiece.get().getPrevious(t.phalanxDirection.get(),1)),t.firstPiece.equals(t.lastPiece)?t.moveOnlyPiece(e):(t.phalanxMiddles=t.firstPiece.get().getCoordsToward(t.lastPiece.get()),t.validExtensions=t.getPhalanxValidExtensions(e),t.phalanxValidLandings=t.getPhalanxValidLandings(),pB.SUCCESS)));case 1:case"end":return n.stop()}},n)}))()}},{key:"moveOnlyPiece",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=fB.empty(),t.validExtensions=t.getFirstPieceExtensions(e),t.phalanxDirection=fB.empty(),t.phalanxMiddles=[],t.phalanxValidLandings=t.getPhalanxValidLandings(),pB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e){var t=this.rules.node.gameState;return this.cancelMove(),this.chooseMove(e,t)}},{key:"getPieceClasses",value:function(e,t){var n=this.getPlayerClass(this.board[t][e]);return this.getPieceStrokeClasses(e,t).concat([n])}},{key:"getPieceStrokeClasses",value:function(e,t){var n=new Zee(e,t);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(n)||this.lastPiece.equalsValue(n)||this.phalanxMiddles.some(function(e){return e.equals(n)})?["highlighted"]:[]}},{key:"getRectClasses",value:function(e,t){var n=new Zee(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured"]:this.moveds.some(function(e){return e.equals(n)})?["moved"]:[]}},{key:"getHighlightedCoords",value:function(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}},{key:"getCurrentPlayerPieces",value:function(){for(var e=[],t=this.rules.node.gameState.getCurrentPlayer(),n=0;n<this.board.length;n++)for(var r=0;r<this.board[n].length;r++)this.board[n][r]===t&&e.push(new Zee(r,n));return e}}]),n}(nne);return e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-epaminondas"]],features:[Rb],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable",3,"click"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),Yb(1,bae,2,1,"g",1),Yb(2,Pae,2,4,"g",1),tP()),2&e&&(pE(1),Xb("ngForOf",t.board),pE(1),Xb("ngForOf",t.getHighlightedCoords()))},directives:[LA,NA,UA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}();function Oae(e){return new(function(t){xg(r,t);var n=Dg(r);function r(){return Zg(this,r),n.apply(this,arguments)}return Wg(r,[{key:"encode",value:function(t){return t.isPresent()?e.encode(t.get()):null}},{key:"decode",value:function(t){return null===t?fB.empty():fB.of(e.decode(t))}}]),r}(S7))}var Tae=function(){function e(t){if(Zg(this,e),t.length<4)throw new Error("Cannot create a GipfCapture with less than 4 captured pieces");if(!1===fie.areOnSameLine(t))throw new Error("Cannot create a GipfCapture with pieces that are not on the same line");this.capturedSpaces=D7.copyImmutableArray(t).sort(function(e,t){if(e.x===t.x){if(e.y===t.y)throw new Error("Cannot create a GipfCapture with duplicate cases");return e.y>t.y?1:-1}return e.x>t.x?1:-1});var n,r=fB.empty(),i=Hg(this.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(r.isPresent()&&1!==r.get().getDistance(a))throw new Error("Cannot create a GipfCapture with non-consecutive cases");r=fB.of(a)}}catch(o){i.e(o)}finally{i.f()}}return Wg(e,[{key:"toString",value:function(){var e,t="",n=Hg(this.capturedSpaces);try{for(n.s();!(e=n.n()).done;){var r=e.value;""!==t&&(t+=","),t+=r.toString()}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"size",value:function(){return this.capturedSpaces.length}},{key:"forEach",value:function(e){this.capturedSpaces.forEach(e)}},{key:"contains",value:function(e){for(var t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}},{key:"intersectsWith",value:function(e){return this.capturedSpaces.some(function(t){return e.contains(t)})}},{key:"getLine",value:function(){return fie.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}},{key:"equals",value:function(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(var t=0;t<this.capturedSpaces.length;t++)if(!this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}]),e}();Tae.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encode",value:function(e){return e.capturedSpaces.map(function(e){return Zee.encoder.encode(e)})}},{key:"decode",value:function(e){return new Tae(e.map(function(e){return Zee.encoder.decode(e)}))}}]),n}(S7));var Iae=function(){function e(t,n){Zg(this,e),this.coord=t,this.direction=n}return Wg(e,[{key:"toString",value:function(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}},{key:"equals",value:function(e){return!!this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}]),e}();Iae.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).optionalDirectionEncoder=Oae(Yee.encoder),e}return Wg(n,[{key:"encode",value:function(e){return{coord:Zee.encoder.encode(e.coord),direction:this.optionalDirectionEncoder.encode(e.direction)}}},{key:"decode",value:function(e){var t=e;return v7(null!=t.coord,"Invalid encoded GipfPlacement"),new Iae(Zee.encoder.decode(t.coord),this.optionalDirectionEncoder.decode(t.direction))}}]),n}(S7));var Aae=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this)).placement=e,a.initialCaptures=r,a.finalCaptures=i,a}return Wg(n,[{key:"toString",value:function(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=Hg(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"equals",value:function(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===D7.compareArray(this.initialCaptures,e.initialCaptures)||!1===D7.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}]),n}(ute);Aae.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encodeMove",value:function(e){var t={placement:Iae.encoder.encode(e.placement)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=Tae.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=Tae.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return v7(null!=t.placement,"Invalid encoded GipfMove"),new Aae(Iae.encoder.decode(t.placement),this.decodeArray(t,"initialCapture",Tae.encoder.decode),this.decodeArray(t,"finalCapture",Tae.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(O7));var Rae=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,r,e,7,7,[3,2,1],jee.EMPTY)).sidePieces=i,o.capturedPieces=a,o}return Wg(n,[{key:"equals",value:function(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&D7.compareTable(this.board,e.board)}},{key:"getNumberOfPiecesToPlace",value:function(e){return this.sidePieces[e.value]}},{key:"getNumberOfPiecesCaptured",value:function(e){return this.capturedPieces[e.value]}},{key:"setAtUnsafe",value:function(e,t){var r=D7.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.sidePieces,this.capturedPieces)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==jee.UNREACHABLE}}],[{key:"getInitialState",value:function(){var e=jee.EMPTY,t=jee.UNREACHABLE,r=jee.ZERO,i=jee.ONE;return new n([[t,t,t,i,e,e,r],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[r,e,e,e,e,e,i],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[i,e,e,r,t,t,t]],0,[12,12],[0,0])}}]),n}(hie),Mae=function(){var e=Wg(function e(){Zg(this,e)});return e.CAPTURE_MUST_BE_ALIGNED=function(){return $localize(ui||(ui=_g(["You can only capture when 4 or more of your pieces are aligned, and it is not the case."])))},e.INVALID_CAPTURED_PIECES=function(){return $localize(ci||(ci=_g(["You must select a valid capture that contains 4 pieces or more."])))},e.MISSING_CAPTURES=function(){return $localize(li||(li=_g(["There are still possible captures to be done."])))},e.PLACEMENT_NOT_ON_BORDER=function(){return $localize(fi||(fi=_g(["Pieces must be inserted in spaces on the edge of the board."])))},e.INVALID_PLACEMENT_DIRECTION=function(){return $localize(hi||(hi=_g(["You must select a valid placement direction."])))},e.PLACEMENT_WITHOUT_DIRECTION=function(){return $localize(di||(di=_g(["You must select a placement with a direction alongside the insertion space."])))},e.PLACEMENT_ON_COMPLETE_LINE=function(){return $localize(vi||(vi=_g(["You cannot place a piece on a complete line."])))},e.AMBIGUOUS_CAPTURE_COORD=function(){return $localize(pi||(pi=_g(["This piece belongs to two captures. Please select another piece in the capture you'd like to make."])))},e.CLICK_FURTHER_THAN_ONE_COORD=function(){return $localize(gi||(gi=_g(["You must click on an arrow to select your destination."])))},e.NO_DIRECTIONS_AVAILABLE=function(){return $localize(yi||(yi=_g(["You cannot insert a piece here, as all lines are full. Select another space."])))},e}(),xae=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){return new Rae(n.board,n.turn+1,n.sidePieces,n.capturedPieces)}},{key:"getPiecesMoved",value:function(e,t,r){var i=n.applyCaptures(t,e);if(r.direction.isAbsent())return[r.coord];var a=r.direction.get(),o=[];o.push(r.coord);for(var s=r.coord.getNext(a);i.isOnBoard(s)&&i.getPieceAt(s)!==jee.EMPTY;)o.push(s),s=s.getNext(a);return v7(i.isOnBoard(s)&&i.getPieceAt(s)===jee.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(s),o}},{key:"isLegal",value:function(e,t){var r=this.capturesValidity(t,e.initialCaptures);if(r.isFailure())return r.toFailedFallible();var i=n.applyCaptures(e.initialCaptures,t),a=this.noMoreCapturesValidity(i);if(a.isFailure())return a.toFailedFallible();var o=this.placementValidity(i,e.placement);if(o.isFailure())return o.toFailedFallible();var s=n.applyPlacement(e.placement,i),u=this.capturesValidity(s,e.finalCaptures);if(u.isFailure())return u.toFailedFallible();var c=n.applyCaptures(e.finalCaptures,s),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toFailedFallible():hB.success(c)}},{key:"capturesValidity",value:function(e,t){var r,i=e,a=Hg(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=this.captureValidity(i,o);if(s.isFailure())return s;i=n.applyCapture(o,i)}}catch(u){a.e(u)}finally{a.f()}return pB.SUCCESS}},{key:"captureValidity",value:function(e,t){var r=e.getCurrentPlayer(),i=n.getLinePortionWithFourPiecesOfPlayer(e,r,t.getLine());if(i.isAbsent())return pB.failure(Mae.CAPTURE_MUST_BE_ALIGNED());var a=i.get();return n.getCapturable(e,a).equals(t)?pB.SUCCESS:pB.failure(Mae.INVALID_CAPTURED_PIECES())}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===n.getLinePortionsWithFourPiecesOfPlayer(e,t).length?pB.SUCCESS:pB.failure(Mae.MISSING_CAPTURES())}},{key:"placementValidity",value:function(e,t){var r=this.placementCoordValidity(e,t.coord);if(r.isFailure())return r;if(e.getPieceAt(t.coord)!==jee.EMPTY){if(t.direction.isAbsent())return pB.failure(Mae.PLACEMENT_WITHOUT_DIRECTION());if(n.isLineComplete(e,t.coord,t.direction.get()))return pB.failure(Mae.PLACEMENT_ON_COMPLETE_LINE());var i,a=Hg(n.getAllDirectionsForEntrance(e,t.coord));try{for(a.s();!(i=a.n()).done;){if(i.value===t.direction.get())return pB.SUCCESS}}catch(o){a.e(o)}finally{a.f()}return pB.failure(Mae.INVALID_PLACEMENT_DIRECTION())}return pB.SUCCESS}},{key:"placementCoordValidity",value:function(e,t){return Jee.INSTANCE.isOnBorder(e,t)?pB.SUCCESS:pB.failure(Mae.PLACEMENT_NOT_ON_BORDER())}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getPlayerScore(t,R7.ZERO),i=n.getPlayerScore(t,R7.ONE);return r.isAbsent()?gte.ONE_WON:i.isAbsent()?gte.ZERO_WON:gte.ONGOING}}],[{key:"applyCaptures",value:function(e,t){var r=t;return e.forEach(function(e){r=n.applyCapture(e,r)}),r}},{key:"applyCapture",value:function(e,t){var n=t.getCurrentPlayer(),r=t,i=[t.sidePieces[0],t.sidePieces[1]],a=[t.capturedPieces[0],t.capturedPieces[1]];return e.forEach(function(e){var o=t.getPieceAt(e);r=r.setAt(e,jee.EMPTY),o.is(n)?i[n.value]+=1:a[n.value]+=1}),new Rae(r.board,t.turn,i,a)}},{key:"getPlacements",value:function(e){var t=[];return Jee.INSTANCE.getAllBorders(e).forEach(function(r){e.getPieceAt(r)===jee.EMPTY?t.push(new Iae(r,fB.empty())):n.getAllDirectionsForEntrance(e,r).forEach(function(i){!1===n.isLineComplete(e,r,i)&&t.push(new Iae(r,fB.of(i)))})}),t}},{key:"isLineComplete",value:function(e,t,r){return n.nextGapInLine(e,t,r).isAbsent()}},{key:"nextGapInLine",value:function(e,t,n){for(var r=t;e.isOnBoard(r);r=r.getNext(n))if(e.getPieceAt(r)===jee.EMPTY)return fB.of(r);return fB.empty()}},{key:"applyPlacement",value:function(e,t){var n=t.getCurrentPlayer(),r=t,i=jee.ofPlayer(t.getCurrentPlayer());if(e.direction.isAbsent()){var a=e.coord;if(t.getPieceAt(a)!==jee.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");r=r.setAt(a,i)}else for(var o=e.coord;r.isOnBoard(o)&&i!==jee.EMPTY;o=o.getNext(e.direction.get())){var s=t.getPieceAt(o);r=r.setAt(o,i),i=s}var u=[t.sidePieces[0],t.sidePieces[1]];return u[n.value]-=1,new Rae(r.board,t.turn,u,t.capturedPieces)}},{key:"getAllDirectionsForEntrance",value:function(e,t){if(Jee.INSTANCE.isTopLeftCorner(e,t))return[Yee.RIGHT,Yee.DOWN,Yee.UP_RIGHT];if(Jee.INSTANCE.isTopCorner(e,t))return[Yee.DOWN,Yee.DOWN_LEFT,Yee.RIGHT];if(Jee.INSTANCE.isTopRightCorner(e,t))return[Yee.DOWN_LEFT,Yee.DOWN,Yee.LEFT];if(Jee.INSTANCE.isBottomLeftCorner(e,t))return[Yee.UP_RIGHT,Yee.UP,Yee.RIGHT];if(Jee.INSTANCE.isBottomCorner(e,t))return[Yee.UP,Yee.LEFT,Yee.UP_RIGHT];if(Jee.INSTANCE.isBottomRightCorner(e,t))return[Yee.LEFT,Yee.UP,Yee.DOWN_LEFT];if(Jee.INSTANCE.isOnTopLeftBorder(e,t))return[Yee.RIGHT,Yee.DOWN];if(Jee.INSTANCE.isOnLeftBorder(e,t))return[Yee.UP_RIGHT,Yee.RIGHT];if(Jee.INSTANCE.isOnBottomLeftBorder(e,t))return[Yee.UP,Yee.UP_RIGHT];if(Jee.INSTANCE.isOnBottomRightBorder(e,t))return[Yee.LEFT,Yee.UP];if(Jee.INSTANCE.isOnRightBorder(e,t))return[Yee.LEFT,Yee.DOWN_LEFT];if(Jee.INSTANCE.isOnTopRightBorder(e,t))return[Yee.DOWN_LEFT,Yee.DOWN];throw new Error("not a border")}},{key:"getLinePortionsWithFourPiecesOfPlayer",value:function(e,t){var r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithFourPiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithFourPiecesOfPlayer",value:function(e,t,n){for(var r=0,i=e.getEntranceOnLine(n),a=n.getDirection(),o=i,s=i;e.isOnBoard(s);s=s.getNext(a))if(e.getPieceAt(s).is(t)?(0===r&&(o=s),r+=1):r=0,4===r)return fB.of({0:o,1:s,2:a});return fB.empty()}},{key:"getCapturable",value:function(e,t){for(var n=[],r=t[0],i=t[1],a=t[2],o=a.getOpposite(),s=r.getNext(o);e.isOnBoard(s)&&e.getPieceAt(s)!==jee.EMPTY;)n.push(s),s=s.getNext(o);for(var u=r;!u.equals(i);u=u.getNext(a))n.push(u);for(var c=i;e.isOnBoard(c)&&e.getPieceAt(c)!==jee.EMPTY;c=c.getNext(a))n.push(c);return new Tae(n)}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),r=[];return n.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(function(t){r.push(n.getCapturable(e,t))}),r}},{key:"getPlayerScore",value:function(e,t){var r=e.getNumberOfPiecesToPlace(t);if(0===r&&0===n.getPossibleCaptures(e).length)return fB.empty();var i=e.getNumberOfPiecesCaptured(t);return fB.of(r+3*i)}},{key:"isGameOver",value:function(e){var t=n.getPlayerScore(e,R7.ZERO),r=n.getPlayerScore(e,R7.ONE);return t.isAbsent()||r.isAbsent()}}]),n}(yte),Nae=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getBoardValue",value:function(e){var t=e.gameState,n=xae.getPlayerScore(t,R7.ZERO),r=xae.getPlayerScore(t,R7.ONE);return n.isAbsent()?new nte(R7.ONE.getVictoryValue()):r.isAbsent()?new nte(R7.ZERO.getVictoryValue()):new nte(n.get()-r.get())}},{key:"getListMoves",value:function(e){return this.getListMoveFromState(e.gameState)}},{key:"getListMoveFromState",value:function(e){var t=this,n=[];return xae.isGameOver(e)||this.getPossibleCaptureCombinations(e).forEach(function(r){var i=xae.applyCaptures(r,e);xae.getPlacements(i).forEach(function(e){var a=xae.applyPlacement(e,i);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new Aae(e,r,t);n.push(i)})})}),n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=xae.getPossibleCaptures(e);return n.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}],[{key:"getPossibleCaptureCombinationsFromPossibleCaptures",value:function(e){var t=n.computeIntersections(e),r=[[]];return e.forEach(function(e,n){if(0===t[n].length)r.forEach(function(e){e.push(n)});else{var i,a=[],o=t[n].some(function(e){return e>n}),s=Hg(r);try{for(s.s();!(i=s.n()).done;){var u=i.value;!0===u.some(function(e){return t[n].some(function(t){return e===t})})?a.push(D7.copyImmutableArray(u)):o?(a.push(D7.copyImmutableArray(u)),u.push(n),a.push(D7.copyImmutableArray(u))):(u.push(n),a.push(D7.copyImmutableArray(u)))}}catch(c){s.e(c)}finally{s.f()}r=a}}),r.map(function(t){return t.map(function(t){return e[t]})})}},{key:"computeIntersections",value:function(e){var t=[];return e.forEach(function(n,r){t.push([]),e.forEach(function(e,i){r!==i&&n.intersectsWith(e)&&t[r].push(i)})}),t}}]),n}(tte),Dae=Wg(function e(t,n,r,i,a,o){Zg(this,e),this.source=t,this.destination=n,this.x1=r,this.y1=i,this.x2=a,this.y2=o}),Lae=jee.UNREACHABLE,Fae=jee.EMPTY,Uae=jee.ZERO,Vae=jee.ONE,Bae=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(mi||(mi=_g(["Goal of the game"]))),$localize(ki||(ki=_g(["The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.\n        This is the initial board.\n        Each player has 12 pieces on the side and 3 pieces on the board.\n        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.\n        The first player plays with the dark pieces, the second player plays with the light pieces."]))),Rae.getInitialState()),wte.anyMove($localize(Ci||(Ci=_g(["Pushing"]))),$localize(wi||(wi=_g(["Pieces can only enter the board through the edges. To insert a new piece:\n        <ol>\n            <li>Click on a space on the edge of the board.</li>\n            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>\n        </ol>\n        You cannot push when a line is full.<br/><br/>\n        You're playing Dark, insert a piece."]))),Rae.getInitialState(),new Aae(new Iae(new Zee(3,0),fB.of(Yee.DOWN)),[],[]),$localize(_i||(_i=_g(["Congratulations!"])))),wte.fromMove($localize(Ei||(Ei=_g(["Capture (1/3)"]))),$localize(bi||(bi=_g(["To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.\n        There are multiple important aspects of a capture:\n        <ol>\n            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>\n            <li>As soon as there is an empty space on the line, the capture stops.</li>\n            <li>Your own pieces that are captured go back to your stock.\n                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>\n            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.\n                This means that a turn happens in three phases:\n                <ol type=\"A\">\n                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>\n                    <li>Make your insertion.</li>\n                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>\n                </ol>\n            </li>\n        </ol><br/>\n        You're playing Dark, you can make a capture, do it."]))),new Rae([[Lae,Lae,Lae,Uae,Vae,Fae,Fae],[Lae,Lae,Fae,Fae,Fae,Fae,Fae],[Lae,Fae,Fae,Fae,Fae,Fae,Fae],[Uae,Uae,Uae,Fae,Fae,Fae,Fae],[Vae,Fae,Fae,Fae,Fae,Fae,Lae],[Fae,Fae,Fae,Vae,Fae,Lae,Lae],[Fae,Fae,Fae,Vae,Lae,Lae,Lae]],42,[8,8],[0,0]),[new Aae(new Iae(new Zee(0,3),fB.of(Yee.RIGHT)),[],[new Tae([new Zee(0,3),new Zee(1,3),new Zee(2,3),new Zee(3,3)])])],$localize(Pi||(Pi=_g(["Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.\n        Let's now see how captures can really be useful."]))),$localize(Si||(Si=_g(["Failed!"])))),wte.fromMove($localize(Oi||(Oi=_g(["Capture (2/3)"]))),$localize(Ti||(Ti=_g(["Here, there are three different ways of capturing.\n        <ol>\n          <li>One way does not capture any of your opponent's pieces.</li>\n          <li>Another way captures one of your opponent's pieces.</li>\n          <li>The last way captures two of your opponent's pieces.</li>\n        </ol>\n        <br/><br/>\n        Pick the last one."]))),new Rae([[Lae,Lae,Lae,Fae,Fae,Fae,Fae],[Lae,Lae,Fae,Vae,Fae,Fae,Fae],[Lae,Fae,Fae,Uae,Fae,Fae,Fae],[Uae,Uae,Uae,Vae,Fae,Fae,Fae],[Fae,Fae,Fae,Uae,Fae,Fae,Lae],[Fae,Fae,Fae,Uae,Fae,Lae,Lae],[Fae,Fae,Fae,Vae,Lae,Lae,Lae]],42,[8,4],[2,3]),[new Aae(new Iae(new Zee(0,3),fB.of(Yee.RIGHT)),[],[new Tae([new Zee(3,1),new Zee(3,2),new Zee(3,3),new Zee(3,4),new Zee(3,5),new Zee(3,6)])])],$localize(Ii||(Ii=_g(["Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.\n        The most you can get is 3 per capture."]))),$localize(Ai||(Ai=_g(["Failed, the best capture was taking 2 of your opponent's pieces"])))),wte.fromMove($localize(Ri||(Ri=_g(["Capture (3/3)"]))),$localize(Mi||(Mi=_g(["Here, you must capture at the beginning of your turn.\n        This is due to a move of your opponent at the previous turn\n        (even though this is a fictitious board for pedagogical purpose).\n        After your capture, by performing the right move you can even capture two more of your opponent's pieces!\n        Keep it mind that the most useful in a capture is to take your opponent's pieces."]))),new Rae([[Lae,Lae,Lae,Uae,Fae,Fae,Uae],[Lae,Lae,Fae,Uae,Fae,Fae,Uae],[Lae,Uae,Uae,Fae,Uae,Vae,Uae],[Fae,Fae,Fae,Uae,Fae,Fae,Uae],[Fae,Fae,Fae,Uae,Fae,Fae,Lae],[Uae,Uae,Uae,Vae,Vae,Lae,Lae],[Fae,Fae,Fae,Uae,Lae,Lae,Lae]],42,[8,4],[2,3]),[new Aae(new Iae(new Zee(3,6),fB.of(Yee.UP)),[new Tae([new Zee(6,0),new Zee(6,1),new Zee(6,2),new Zee(6,3)])],[new Tae([new Zee(0,5),new Zee(1,5),new Zee(2,5),new Zee(3,5),new Zee(4,5)]),new Tae([new Zee(1,2),new Zee(2,2),new Zee(3,2),new Zee(4,2),new Zee(5,2)])]),new Aae(new Iae(new Zee(4,6),fB.of(Yee.UP)),[new Tae([new Zee(6,0),new Zee(6,1),new Zee(6,2),new Zee(6,3)])],[new Tae([new Zee(0,5),new Zee(1,5),new Zee(2,5),new Zee(3,5),new Zee(4,5)]),new Tae([new Zee(3,0),new Zee(3,1),new Zee(3,2),new Zee(3,3),new Zee(3,4)])]),new Aae(new Iae(new Zee(3,6),fB.of(Yee.UP)),[new Tae([new Zee(6,0),new Zee(6,1),new Zee(6,2),new Zee(6,3)])],[new Tae([new Zee(1,2),new Zee(2,2),new Zee(3,2),new Zee(4,2),new Zee(5,2)]),new Tae([new Zee(0,5),new Zee(1,5),new Zee(2,5),new Zee(3,5),new Zee(4,5)])])],$localize(xi||(xi=_g(["Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces."]))),$localize(Ni||(Ni=_g(["Failed, the best capture takes 2 of your opponent's pieces."]))))]});function zae(e,t){if(1&e&&(cC(),nP(0,"circle",11)),2&e){var n=fP().$implicit,r=fP();Xb("ngClass",r.getPieceClass(n)),$b("cx",r.getCenterAt(n).x)("cy",r.getCenterAt(n).y)("r",r.SPACE_SIZE)}}function Hae(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"g",8),uP("click",function(){var e=Nk(n).$implicit;return fP().onClick(e)}),nP(2,"polyline",9),Yb(3,zae,1,4,"circle",10),tP(),tP()}if(2&e){var r=t.$implicit,i=fP();pE(1),vP("id","click_",r.x,"_",r.y,""),pE(1),vP("id","case_",r.x,"_",r.y,""),Xb("ngClass",i.getSpaceClass(r)),$b("points",i.getHexaCoordsAt(r)),pE(1),Xb("ngIf",i.isPiece(r))}}function Gae(e,t){if(1&e){var n=aP();cC(),eP(0,"polyline",14),uP("click",function(){var e=Nk(n).$implicit;return fP(2).onClick(e)}),tP()}if(2&e){var r=t.$implicit;$b("points",fP(2).getHexaCoordsAt(r))}}function $ae(e,t){if(1&e&&(cC(),eP(0,"g",12),Yb(1,Gae,1,1,"polyline",13),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n.capturedSpaces)}}function Zae(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"line",15),uP("click",function(){var e=Nk(n).$implicit;return fP().onClick(e.destination)}),tP(),tP()}if(2&e){var r=t.$implicit;pE(1),$b("x1",r.x1)("y1",r.y1)("x2",r.x2)("y2",r.y2)}}function qae(e,t){if(1&e&&(cC(),eP(0,"g"),nP(1,"circle",16),tP()),2&e){var n=t.$implicit,r=fP().$implicit,i=fP();pE(1),vP("id","piece_",r,"_",n,""),Xb("ngClass",i.getSidePieceClass(r)),$b("cx",10+n*i.SPACE_SIZE*.5)("cy",10+(i.SPACE_SIZE+10)*r)("r",.5*i.SPACE_SIZE)}}function Wae(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,qae,2,6,"g",5),tP()),2&e){var n=t.$implicit,r=fP();pE(1),Xb("ngForOf",r.getPlayerSidePieces(n))}}function jae(e,t){if(1&e&&(cC(),nP(0,"line",17)),2&e){var n=fP();$b("x1",n.inserted.get().x1)("y1",n.inserted.get().y1)("x2",n.inserted.get().x2)("y2",n.inserted.get().y2)}}var Yae=function(){return[0,1]},Kae=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).inserted=fB.empty(),r.arrows=[],r.captured=[],r.moved=[],r.movePhase=n.PHASE_PLACEMENT_COORD,r.possibleCaptures=[],r.initialCaptures=[],r.placement=fB.empty(),r.placementEntrance=fB.empty(),r.finalCaptures=[],r.scores=fB.of([0,0]),r.rules=new xae(Rae),r.availableMinimaxes=[new Nae(r.rules,"GipfMinimax")],r.encoder=Aae.encoder,r.tutorial=(new Bae).tutorial,r.SPACE_SIZE=40,r.constructedState=r.rules.node.gameState,r.hexaLayout=new Kee(1.5*r.SPACE_SIZE,new Zee(2*r.SPACE_SIZE,0),Jee.INSTANCE),r}return Wg(n,[{key:"updateBoard",value:function(){this.showLastMove(),this.cancelMoveAttempt(),this.moveToInitialCaptureOrPlacementPhase()}},{key:"showLastMove",value:function(){this.inserted=fB.empty();var e=this.rules.node.move;if(e.isPresent()&&e.get().placement.direction.isPresent()){var t=e.get().placement;this.inserted=fB.of(this.arrowTowards(t.coord,t.direction.get()))}this.cancelMoveAttempt()}},{key:"arrowTowards",value:function(e,t){var n=e.getNext(t.getOpposite()),r=this.getCenterAt(e),i=this.getCenterAt(n);return new Dae(n,e,i.x,i.y,r.x,r.y)}},{key:"markCapture",value:function(e){var t=this;e.forEach(function(e){t.captured.push(e)})}},{key:"getAllCoords",value:function(){return this.constructedState.allCoords()}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.constructedState.getNumberOfPiecesToPlace(R7.of(e)),n=[],r=0;r<t;r+=1)n.push(r);return n}},{key:"isPiece",value:function(e){return this.getPiece(e)!==jee.EMPTY}},{key:"getPiece",value:function(e){return this.constructedState.getPieceAt(e)}},{key:"onClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){r.next=3;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 3:r.t0=t.movePhase,r.next=r.t0===n.PHASE_INITIAL_CAPTURE||r.t0===n.PHASE_FINAL_CAPTURE?6:r.t0===n.PHASE_PLACEMENT_COORD?7:8;break;case 6:return r.abrupt("return",t.selectCapture(e));case 7:return r.abrupt("return",t.selectPlacementCoord(e));case 8:if(oB.expectToBe(t.movePhase,n.PHASE_PLACEMENT_DIRECTION),!1!==(a=t.placementEntrance.get()).isAlignedWith(e)){r.next=12;break}return r.abrupt("return",t.cancelMove(Mae.INVALID_PLACEMENT_DIRECTION()));case 12:if(1===a.getDistance(e)){r.next=14;break}return r.abrupt("return",t.cancelMove(Mae.CLICK_FURTHER_THAN_ONE_COORD()));case 14:return o=Yee.factory.fromMove(a,e),r.abrupt("return",t.selectPlacementDirection(o.toOptional()));case 16:case"end":return r.stop()}},r)}))()}},{key:"selectCapture",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&i.push(t)}),!(i.length>1)){r.next=3;break}return r.abrupt("return",t.cancelMove(Mae.AMBIGUOUS_CAPTURE_COORD()));case 3:if(0!==i.length){r.next=5;break}return r.abrupt("return",t.cancelMove(Mae.MISSING_CAPTURES()));case 5:return a=i[0],r.abrupt("return",(t.constructedState=xae.applyCapture(a,t.constructedState),t.markCapture(a),t.possibleCaptures=xae.getPossibleCaptures(t.constructedState),t.movePhase===n.PHASE_INITIAL_CAPTURE?(t.initialCaptures.push(a),0===t.possibleCaptures.length?t.moveToPlacementPhase():pB.SUCCESS):(oB.expectToBe(t.movePhase,n.PHASE_FINAL_CAPTURE),t.finalCaptures.push(a),0===t.possibleCaptures.length?t.tryMove(t.initialCaptures,t.placement.get(),t.finalCaptures):pB.SUCCESS)));case 7:case"end":return r.stop()}},r)}))()}},{key:"moveToPlacementPhase",value:function(){return this.movePhase=n.PHASE_PLACEMENT_COORD,pB.SUCCESS}},{key:"moveToInitialCaptureOrPlacementPhase",value:function(){return this.possibleCaptures=xae.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?n.PHASE_PLACEMENT_COORD:n.PHASE_INITIAL_CAPTURE,pB.SUCCESS}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=xae.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove(e.initialCaptures,e.placement.get(),e.finalCaptures):(e.movePhase=n.PHASE_FINAL_CAPTURE,pB.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}},{key:"computeArrows",value:function(e){this.arrows=[];var t,n=Hg(xae.getAllDirectionsForEntrance(this.constructedState,e));try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===xae.isLineComplete(this.constructedState,e,r)){var i=e.getNext(r),a=this.getCenterAt(e),o=this.getCenterAt(i);this.arrows.push(new Dae(e,i,a.x,a.y,o.x,o.y))}}}catch(s){n.e(s)}finally{n.f()}}},{key:"selectPlacementCoord",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=t.rules.placementCoordValidity(t.constructedState,e),r.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):(t.placementEntrance=fB.of(e),t.constructedState.getPieceAt(e)===jee.EMPTY?t.selectPlacementDirection(fB.empty()):(t.movePhase=n.PHASE_PLACEMENT_DIRECTION,t.computeArrows(e),0===t.arrows.length&&t.cancelMove(Mae.NO_DIRECTIONS_AVAILABLE()),pB.SUCCESS)));case 2:case"end":return r.stop()}},r)}))()}},{key:"selectPlacementDirection",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.placement=fB.of(new Iae(t.placementEntrance.get(),e)),r=t.rules.placementValidity(t.constructedState,t.placement.get()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.arrows=[],t.constructedState=xae.applyPlacement(t.placement.get(),t.constructedState),t.moveToFinalCapturePhaseOrTryMove()));case 3:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=new Aae(t,e,n),i.next=3,r.chooseMove(a,r.rules.node.gameState,r.scores.get());case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"cancelMoveAttempt",value:function(){var e=this;this.constructedState=this.rules.node.gameState,this.captured=[],this.moved=[];var t=this.rules.node.move;if(t.isPresent()){var n=t.get(),r=this.rules.node.mother.get().gameState;n.initialCaptures.forEach(function(t){return e.markCapture(t)}),n.finalCaptures.forEach(function(t){return e.markCapture(t)}),this.moved=this.rules.getPiecesMoved(r,n.initialCaptures,n.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=fB.empty(),this.placement=fB.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}},{key:"getSpaceClass",value:function(e){return this.captured.some(function(t){return t.equals(e)})?"captured":this.moved.some(function(t){return t.equals(e)})?"moved":""}},{key:"getPieceClass",value:function(e){var t=this.getPiece(e);return this.getPlayerClass(R7.of(t.value))}},{key:"getSidePieceClass",value:function(e){return this.getPlayerClass(R7.of(e))}}]),n}(Wee);return e.PHASE_INITIAL_CAPTURE=0,e.PHASE_PLACEMENT_COORD=1,e.PHASE_PLACEMENT_DIRECTION=2,e.PHASE_FINAL_CAPTURE=3,e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-gipf"]],features:[Rb],decls:11,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -12 708 854","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved","moved-stroke"],[4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),eP(1,"defs"),eP(2,"marker",1),nP(3,"polygon",2),tP(),eP(4,"marker",3),nP(5,"polygon",4),tP(),tP(),Yb(6,Hae,4,7,"g",5),Yb(7,$ae,2,1,"g",6),Yb(8,Zae,2,4,"g",5),Yb(9,Wae,2,1,"g",5),Yb(10,jae,1,4,"line",7),tP()),2&e&&(pE(6),Xb("ngForOf",t.getAllCoords()),pE(1),Xb("ngForOf",t.possibleCaptures),pE(1),Xb("ngForOf",t.arrows),pE(1),Xb("ngForOf",aT(5,Yae)),pE(1),Xb("ngIf",t.inserted.isPresent()))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Qae=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"equals",value:function(e){return this===e||this.coord.equals(e.coord)}},{key:"toString",value:function(){return this===n.PASS?"GoMove.PASS":this===n.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(cte);Qae.PASS=new Qae(-1,0),Qae.ACCEPT=new Qae(-2,0),Qae.PASS_NUMBER=-1,Qae.ACCEPT_NUMBER=-2,Qae.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 360}},{key:"encodeNumber",value:function(e){return 19*e.coord.y+e.coord.x}},{key:"decodeNumber",value:function(e){if(e===Qae.PASS_NUMBER)return Qae.PASS;var t=e%19;return new Qae(t,(e-t)/19)}}]),n}(T7));var Xae=function(){function e(t,n){Zg(this,e),this.player=t,this.type=n}return Wg(e,[{key:"equals",value:function(e){return e===this}},{key:"toString",value:function(){switch(this){case e.DARK:return"GoPiece.DARK";case e.LIGHT:return"GoPiece.LIGHT";case e.EMPTY:return"GoPiece.EMPTY";case e.DEAD_DARK:return"GoPiece.DEAD_DARK";case e.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case e.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return v7(this===e.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}},{key:"isOccupied",value:function(){return[e.DARK,e.LIGHT,e.DEAD_DARK,e.DEAD_LIGHT].includes(this)}},{key:"isEmpty",value:function(){return[e.DARK_TERRITORY,e.LIGHT_TERRITORY,e.EMPTY].includes(this)}},{key:"isDead",value:function(){return[e.DEAD_DARK,e.DEAD_LIGHT].includes(this)}},{key:"isTerritory",value:function(){return[e.DARK_TERRITORY,e.LIGHT_TERRITORY].includes(this)}},{key:"getOwner",value:function(){return this.player}},{key:"nonTerritory",value:function(){return v7(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),e.EMPTY}}],[{key:"pieceBelongTo",value:function(e,t){return t===e.player&&"territory"!==e.type}},{key:"ofPlayer",value:function(t){return t===R7.ZERO?e.DARK:e.LIGHT}}]),e}();Xae.DARK=new Xae(R7.ZERO,"alive"),Xae.LIGHT=new Xae(R7.ONE,"alive"),Xae.EMPTY=new Xae(A7.NONE,"empty"),Xae.DEAD_DARK=new Xae(R7.ZERO,"dead"),Xae.DEAD_LIGHT=new Xae(R7.ONE,"dead"),Xae.DARK_TERRITORY=new Xae(A7.NONE,"territory"),Xae.LIGHT_TERRITORY=new Xae(A7.NONE,"territory");var Jae=(function(e){e.PLAYING="PLAYING",e.PASSED="PASSED",e.COUNTING="COUNTING",e.ACCEPT="ACCEPT",e.FINISHED="FINISHED"}(Jae||(Jae={})),Jae),eoe=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o){var s;return Zg(this,n),(s=t.call(this,e,i)).captured=r,s.koCoord=a,s.phase=o,s}return Wg(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}},{key:"copy",value:function(){return new n(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}},{key:"isDead",value:function(e){return this.getPieceAt(e).isDead()}},{key:"isTerritory",value:function(e){return this.getPieceAt(e).isTerritory()}}],[{key:"getInitialState",value:function(){var e=n.getStartingBoard();return new n(e,[0,0],0,fB.empty(),Jae.PLAYING)}},{key:"getStartingBoard",value:function(){return D7.createTable(n.WIDTH,n.HEIGHT,Xae.EMPTY)}}]),n}(ote);return e.WIDTH=13,e.HEIGHT=13,e}(),toe=function(){var e=function(){function e(t){Zg(this,e),this.color=t}return Wg(e,[{key:"selfContains",value:function(e){return this.getCoords().some(function(t){return t.equals(e)})}}],[{key:"insertAsEntryPoint",value:function(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}]),e}();return e.VERBOSE=!1,e}(),noe=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,e)).emptyCoords=r,u.darkCoords=i,u.lightCoords=a,u.deadDarkCoords=o,u.deadLightCoords=s,u}return Wg(n,[{key:"getCoords",value:function(){return this.color===Xae.DARK?this.darkCoords:this.color===Xae.LIGHT?this.lightCoords:this.color===Xae.DEAD_DARK?this.deadDarkCoords:this.color===Xae.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}},{key:"contains",value:function(e){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(function(t){return t.equals(e)})}},{key:"addPawn",value:function(e,t){switch(v7(!1===this.contains(e),"This group already contains "+e.toString()),t){case Xae.DARK:this.darkCoords=toe.insertAsEntryPoint(this.darkCoords,e);break;case Xae.LIGHT:this.lightCoords=toe.insertAsEntryPoint(this.lightCoords,e);break;case Xae.DEAD_DARK:this.deadDarkCoords=toe.insertAsEntryPoint(this.deadDarkCoords,e);break;case Xae.DEAD_LIGHT:this.deadLightCoords=toe.insertAsEntryPoint(this.deadLightCoords,e);break;default:oB.expectToBeMultiple(t,[Xae.EMPTY,Xae.DARK_TERRITORY,Xae.LIGHT_TERRITORY]),this.emptyCoords=toe.insertAsEntryPoint(this.emptyCoords,e)}}},{key:"isMonoWrapped",value:function(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}},{key:"getWrapper",value:function(){var e=new hte;e.set(Xae.EMPTY,this.emptyCoords.length),e.set(Xae.DARK,this.darkCoords.length+this.deadLightCoords.length),e.set(Xae.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),e.put(this.color.nonTerritory(),0);var t=e.filter(function(e,t){return t>0});if(1===t.size())return t.getByIndex(0).key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}},{key:"getNeighborsEntryPoints",value:function(){var e=[];return this.color!==Xae.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==Xae.DARK&&this.darkCoords.length>0&&e.push(this.darkCoords[0]),this.color!==Xae.LIGHT&&this.lightCoords.length>0&&e.push(this.lightCoords[0]),this.color!==Xae.DEAD_DARK&&this.deadDarkCoords.length>0&&e.push(this.deadDarkCoords[0]),this.color!==Xae.DEAD_LIGHT&&this.deadLightCoords.length>0&&e.push(this.deadLightCoords[0]),e}}]),n}(toe),roe=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getNewInstance",value:function(e){return new noe(e,[],[],[],[],[])}},{key:"getDirections",value:function(){return Gee.ORTHOGONALS}}]),n}(function(){function e(){Zg(this,e)}return Wg(e,[{key:"getGroupDatas",value:function(e,t){sB(toe.VERBOSE,"GroupDatas.getGroupDatas("+e+", "+t+")");var n=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,n)}},{key:"_getGroupDatas",value:function(e,t,n){sB(toe.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:n,coord:e}});var r=t[e.y][e.x];if(n.addPawn(e,r),r===n.color){var i,a=Hg(this.getDirections());try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e.getNext(o);s.isInRange(t[0].length,t.length)&&(n.contains(s)||(n=this._getGroupDatas(s,t,n)))}}catch(u){a.e(u)}finally{a.f()}}return n}}]),e}()),ioe=function(){var e=Wg(function e(){Zg(this,e)});return e.ILLEGAL_KO=function(){return $localize(Di||(Di=_g(["This move is a ko, you must play somewhere else before you can play in this intersection again."])))},e.CANNOT_PASS_AFTER_PASSED_PHASE=function(){return $localize(Li||(Li=_g(["We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn."])))},e.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=function(){return $localize(Fi||(Fi=_g(["You cannot accept before the counting phase."])))},e.OCCUPIED_INTERSECTION=function(){return $localize(Ui||(Ui=_g(["This intersection is already occupied."])))},e.CANNOT_COMMIT_SUICIDE=function(){return $localize(Vi||(Vi=_g(["You cannot commit suicide."])))},e}(),aoe=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,r){return sB(n.VERBOSE,{applyLegalMove:{legalMove:e,state:t,status:r}}),n.isPass(e)?(sB(n.VERBOSE,"GoRules.applyLegalMove: isPass"),n.applyPass(t)):n.isAccept(e)?(sB(n.VERBOSE,"GoRules.applyLegalMove: isAccept"),n.applyLegalAccept(t)):n.isLegalDeadMarking(e,t)?(sB(n.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),n.applyDeadMarkingMove(e,t)):(sB(n.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),n.applyNormalLegalMove(e,t,r))}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=!1;if(sB(n.VERBOSE||r,{isLegal:{move:e,state:t}}),n.isPass(e)){var i=t.phase===Jae.PLAYING,a=t.phase===Jae.PASSED;return sB(n.VERBOSE||r,"GoRules.isLegal at "+t.phase+(i||a?" forbid":" allowed")+" passing on "+t.getCopiedBoard()),i||a?hB.success([]):hB.failure(ioe.CANNOT_PASS_AFTER_PASSED_PHASE())}if(n.isAccept(e)){var o=t.phase===Jae.ACCEPT;return t.phase===Jae.COUNTING||o?hB.success([]):hB.failure(ioe.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return n.isOccupied(e.coord,t.getCopiedBoard())?(sB(n.VERBOSE||r,"GoRules.isLegal: move is marking"),n.isLegalDeadMarking(e,t)?hB.success([]):hB.failure(ioe.OCCUPIED_INTERSECTION())):(sB(n.VERBOSE||r,"GoRules.isLegal: move is normal stuff: "+e.toString()),n.isLegalNormalMove(e,t))}},{key:"getNewKo",value:function(e,t,n){if(1===n.length){var r=n[0],i=e.coord,a=t[i.y][i.x],o=(new roe).getGroupDatas(i,t),s=o.emptyCoords,u=Xae.pieceBelongTo(a,R7.ZERO)?o.darkCoords:o.lightCoords;if(1===s.length&&s[0].equals(r)&&1===u.length)return fB.of(r)}return fB.empty()}},{key:"markTerritoryAndCount",value:function(e){sB(n.VERBOSE,{markTerritoryAndCount:{state:e}});var t,r=e.getCopiedBoard(),i=n.getTerritoryLikeGroup(e),a=e.getCapturedCopy(),o=Hg(i);try{for(o.s();!(t=o.n()).done;){var s=t.value,u=s.getWrapper();if(u===Xae.LIGHT){a[1]+=s.emptyCoords.length;var c,l=Hg(s.getCoords());try{for(l.s();!(c=l.n()).done;){var f=c.value;r[f.y][f.x]=Xae.LIGHT_TERRITORY}}catch(p){l.e(p)}finally{l.f()}}else{v7(u===Xae.DARK,"territory should be wrapped by dark or light, not by "+u.toString()),a[0]+=s.emptyCoords.length;var h,d=Hg(s.getCoords());try{for(d.s();!(h=d.n()).done;){var v=h.value;r[v.y][v.x]=Xae.DARK_TERRITORY}}catch(p){d.e(p)}finally{d.f()}}}}catch(p){o.e(p)}finally{o.f()}return new eoe(r,a,e.turn,e.koCoord,e.phase)}},{key:"removeAndSubstractTerritory",value:function(e){for(var t,n=e.getCopiedBoard(),r=e.getCapturedCopy(),i=0;i<e.board.length;i++)for(var a=0;a<e.board[0].length;a++)(t=n[i][a])===Xae.DARK_TERRITORY?(n[i][a]=Xae.EMPTY,r[0]=r[0]-1):t===Xae.LIGHT_TERRITORY&&(n[i][a]=Xae.EMPTY,r[1]=r[1]-1);return new eoe(n,r,e.turn,e.koCoord,e.phase)}},{key:"getEmptyZones",value:function(e){return n.getGroupsDatasWhere(e.getCopiedBoard(),function(e){return e.isEmpty()})}},{key:"getGroupsDatasWhere",value:function(e,t){for(var n,r,i=[],a=new roe,o=0;o<e.length;o++)for(var s=0;s<e[0].length;s++)n=new Zee(s,o),t(e[o][s])&&(i.some(function(e){return e.selfContains(n)})||(r=a.getGroupDatas(n,e),i.push(r)));return i}},{key:"addDeadToScore",value:function(e){for(var t,n=e.getCapturedCopy(),r=n[1],i=n[0],a=0;a<e.board.length;a++)for(var o=0;o<e.board[0].length;o++)(t=e.getPieceAtXY(o,a))===Xae.DEAD_DARK?r++:t===Xae.DEAD_LIGHT&&i++;return[i,r]}},{key:"switchAliveness",value:function(e,t){var n=t.getCopiedBoard();v7(!1===n[e.y][e.x].isEmpty(),"Can't switch emptyness aliveness");var r=(new roe).getGroupDatas(e,n),i=t.getCapturedCopy();switch(r.color){case Xae.DEAD_DARK:i[1]-=2*r.deadDarkCoords.length;var a,o=Hg(r.deadDarkCoords);try{for(o.s();!(a=o.n()).done;){var s=a.value;n[s.y][s.x]=Xae.DARK}}catch(y){o.e(y)}finally{o.f()}break;case Xae.DEAD_LIGHT:i[0]-=2*r.deadLightCoords.length;var u,c=Hg(r.deadLightCoords);try{for(c.s();!(u=c.n()).done;){var l=u.value;n[l.y][l.x]=Xae.LIGHT}}catch(y){c.e(y)}finally{c.f()}break;case Xae.LIGHT:i[0]+=2*r.lightCoords.length;var f,h=Hg(r.lightCoords);try{for(h.s();!(f=h.n()).done;){var d=f.value;n[d.y][d.x]=Xae.DEAD_LIGHT}}catch(y){h.e(y)}finally{h.f()}break;default:oB.expectToBe(r.color,Xae.DARK),i[1]+=2*r.darkCoords.length;var v,p=Hg(r.darkCoords);try{for(p.s();!(v=p.n()).done;){var g=v.value;n[g.y][g.x]=Xae.DEAD_DARK}}catch(y){p.e(y)}finally{p.f()}}return new eoe(n,i,t.turn,t.koCoord,t.phase)}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.phase===Jae.FINISHED?t.captured[0]>t.captured[1]?gte.ZERO_WON:t.captured[1]>t.captured[0]?gte.ONE_WON:gte.DRAW:gte.ONGOING}},{key:"isPass",value:function(e){return e.equals(Qae.PASS)}},{key:"isAccept",value:function(e){return e.equals(Qae.ACCEPT)}},{key:"isLegalDeadMarking",value:function(e,t){return n.isOccupied(e.coord,t.getCopiedBoard())&&(t.phase===Jae.COUNTING||t.phase===Jae.ACCEPT)}},{key:"isLegalNormalMove",value:function(e,t){var r=t.getCopiedBoard();if(n.isKo(e,t))return hB.failure(ioe.ILLEGAL_KO());[Jae.COUNTING,Jae.ACCEPT].includes(t.phase)&&(t=n.resurrectStones(t));var i=n.getCaptureState(e,t);if(ooe.isCapturing(i))return hB.success(i.capturedCoords);r[e.coord.y][e.coord.x]=t.turn%2==0?Xae.DARK:Xae.LIGHT;var a=0===(new roe).getGroupDatas(e.coord,r).emptyCoords.length;return r[e.coord.y][e.coord.x]=Xae.EMPTY,a?hB.failure(ioe.CANNOT_COMMIT_SUICIDE()):hB.success([])}},{key:"isOccupied",value:function(e,t){return t[e.y][e.x].isOccupied()}},{key:"isKo",value:function(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}},{key:"getCaptureState",value:function(e,t){sB(n.VERBOSE||!1,{getCaptureState:{move:e,state:t}});var r,i,a=new ooe,o=Hg(Gee.ORTHOGONALS);try{for(o.s();!(i=o.n()).done;){var s=i.value;(r=n.getCapturedInDirection(e.coord,s,t)).length>0&&a.capturedCoords.every(function(e){return!r[0].equals(e)})&&(a.capturedCoords=a.capturedCoords.concat(r))}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getCapturedInDirection",value:function(e,t,r){var i=r.getCopiedBoard(),a=e.getNext(t);if(a.isInRange(r.board[0].length,r.board.length)&&i[a.y][a.x]===(r.turn%2==0?Xae.LIGHT:Xae.DARK)){sB(n.VERBOSE||!1,"a group could be captured");var o=(new roe).getGroupDatas(a,i);if(n.isCapturableGroup(o,r.koCoord))return sB(n.VERBOSE||!1,{neightbooringGroupCoord:o.getCoords(),message:"is capturable"}),o.getCoords()}return[]}},{key:"isCapturableGroup",value:function(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}},{key:"getTerritoryLikeGroup",value:function(e){return n.getEmptyZones(e).filter(function(e){return e.isMonoWrapped()})}},{key:"applyPass",value:function(e){var t,r,i=e.getCopiedBoard(),a=e.getCapturedCopy(),o=e.turn;return e.phase===Jae.PASSED?(t=Jae.COUNTING,r=new eoe(i,a,o+1,fB.empty(),t),r=n.markTerritoryAndCount(r)):(v7(e.phase===Jae.PLAYING,"Cannot pass in counting phase!"),t=Jae.PASSED,r=new eoe(i,a,o+1,fB.empty(),t)),r}},{key:"applyLegalAccept",value:function(e){var t,n=e.getCopiedBoard();return t=e.phase===Jae.COUNTING?Jae.ACCEPT:Jae.FINISHED,new eoe(n,e.getCapturedCopy(),e.turn+1,fB.empty(),t)}},{key:"applyNormalLegalMove",value:function(e,t,r){var i;sB(n.VERBOSE,{applyNormalLegal:{currentState:t,legalMove:e,status:status}}),i=[Jae.COUNTING,Jae.ACCEPT].includes(t.phase)?n.resurrectStones(t):t.copy();var a=e.coord.x,o=e.coord.y,s=i.getCopiedBoard(),u=i.turn,c=Xae.ofPlayer(i.getCurrentPlayer()),l=u+1;s[o][a]=c;var f,h=Hg(r);try{for(h.s();!(f=h.n()).done;){var d=f.value;s[d.y][d.x]=Xae.EMPTY}}catch(g){h.e(g)}finally{h.f()}var v=n.getNewKo(e,s,r),p=i.getCapturedCopy();return p[c.player.value]+=r.length,new eoe(s,p,l,v,Jae.PLAYING)}},{key:"resurrectStones",value:function(e){for(var t=0;t<e.board.length;t++)for(var r=0;r<e.board[0].length;r++)e.getPieceAtXY(r,t).isDead()&&(e=n.switchAliveness(new Zee(r,t),e));return n.removeAndSubstractTerritory(e)}},{key:"applyDeadMarkingMove",value:function(e,t){sB(n.VERBOSE,{applyDeadMarkingMove:{legalMove:e,state:t}});var r=n.removeAndSubstractTerritory(t),i=n.switchAliveness(e.coord,r),a=new eoe(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,fB.empty(),Jae.COUNTING);return n.markTerritoryAndCount(a)}}]),n}(yte);return e.VERBOSE=!1,e}(),ooe=function(){function e(){Zg(this,e),this.capturedCoords=[]}return Wg(e,null,[{key:"isCapturing",value:function(e){return e.capturedCoords.length>0}}]),e}(),soe=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){sB(aoe.VERBOSE||!1,"GoRules.getListMoves");var t=e.gameState,n=this.getPlayingMovesList(t);if(t.phase===Jae.PLAYING||t.phase===Jae.PASSED)return n.push(Qae.PASS),n;sB(aoe.VERBOSE||!1,"GoRules.getListMoves in counting phase");var r=this.getCountingMovesList(t);return 0===r.length?[Qae.ACCEPT]:r}},{key:"getPlayingMovesList",value:function(e){for(var t,n=[],r=0;r<e.board.length;r++)for(var i=0;i<e.board[0].length;i++)t=new Qae(i,r),e.getPieceAt(t.coord)===Xae.EMPTY&&aoe.isLegal(t,e).isSuccess()&&n.push(t);return n}},{key:"getCountingMovesList",value:function(e){var t,n=[],r=this.getCorrectBoard(e).getCopiedBoard(),i=Hg(aoe.getGroupsDatasWhere(r,function(e){return e!==Xae.EMPTY}));try{for(i.s();!(t=i.n()).done;){var a=t.value.getCoords()[0],o=r[a.y][a.x];if(e.getPieceAt(a)!==o){var s=new Qae(a.x,a.y);return n.push(s),n}}}catch(u){i.e(u)}finally{i.f()}return n}},{key:"getCorrectBoard",value:function(e){var t=this.mapBoard(e.getCopiedBoard(),function(e){return e===Xae.DARK?Xae.DEAD_DARK:e===Xae.LIGHT?Xae.DEAD_LIGHT:e.isTerritory()?Xae.EMPTY:e}),n=new eoe(t,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),r=aoe.getTerritoryLikeGroup(n);return this.setAliveUniqueWrapper(n,r)}},{key:"mapBoard",value:function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[0].length;r++)e[n][r]=t(e[n][r]);return e}},{key:"setAliveUniqueWrapper",value:function(e,t){var n,r=e.copy(),i=Hg(t);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=Hg(o.deadDarkCoords.concat(o.deadLightCoords));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.isDead(u)&&(r=aoe.switchAliveness(u,r))}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=aoe.getGameStatus(e);if(n.isEndGame)return new nte(n.toBoardValue());sB(aoe.VERBOSE||!1,"GoRules.getBoardValue");var r=aoe.markTerritoryAndCount(t),i=r.getCapturedCopy(),a=this.getDeadStones(r);return new nte(i[1]+2*a[0]-(i[0]+2*a[1]))}},{key:"getDeadStones",value:function(e){for(var t=[0,0],n=0;n<e.board.length;n++)for(var r=0;r<e.board[0].length;r++){var i=e.getPieceAtXY(r,n);"dead"===i.type&&(t[i.player.value]=t[i.player.value]+1)}return t}}]),n}(tte),uoe=Xae.LIGHT,coe=Xae.DARK,loe=Xae.DEAD_LIGHT,foe=Xae.LIGHT_TERRITORY,hoe=Xae.DARK_TERRITORY,doe=Xae.EMPTY,voe=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(Bi||(Bi=_g(["Preliminary information"]))),$localize(zi||(zi=_g(["The game of Go is played on a board called a Goban, and the stones are placed on the intersections.\n        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.\n        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).\n        For this tutorial, we will use a smaller board for pedagogical purposes."]))),eoe.getInitialState()),wte.informational($localize(Hi||(Hi=_g(["Goal of the game"]))),$localize(Gi||(Gi=_g(["The goal of the game is to have the most points at the end of the game.\n        We call \"territories\" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.\n        Here, Dark has 9 territories on the left, and Light has 8 on the right.\n        The top part belongs to no one.\n        Each player's score at the end of the game is the sum of that player's territories and captures."]))),new eoe([[doe,coe,doe,doe,uoe,uoe],[doe,coe,doe,doe,uoe,doe],[doe,coe,coe,uoe,uoe,doe],[doe,doe,coe,uoe,doe,doe],[doe,doe,coe,uoe,doe,doe],[doe,doe,coe,uoe,doe,doe]],[0,0],0,fB.empty(),Jae.PLAYING)),wte.fromMove($localize($i||($i=_g(["Simple capture"]))),$localize(Zi||(Zi=_g(["An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).\n        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.\n        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>\n        The light piece only has one liberty left, play there."]))),new eoe([[doe,doe,doe,doe,doe],[doe,doe,coe,doe,doe],[doe,coe,uoe,doe,doe],[doe,doe,coe,doe,doe],[doe,doe,doe,doe,doe]],[0,0],0,fB.empty(),Jae.PLAYING),[new Qae(3,2)],$localize(qi||(qi=_g(["Congratulations, you have earned one point."]))),$localize(Wi||(Wi=_g(["Failed, try again by playing on one of the intersections directly next to the light stone."])))),wte.fromMove($localize(ji||(ji=_g(["Capturing multiple stones"]))),$localize(Yi||(Yi=_g(["Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>\n        The light group here only has one liberty left, capture it."]))),new eoe([[doe,coe,doe,doe,doe],[coe,uoe,doe,doe,doe],[coe,uoe,uoe,coe,doe],[doe,coe,coe,doe,doe],[doe,doe,doe,doe,doe]],[0,0],0,fB.empty(),Jae.PLAYING),[new Qae(2,1)],$localize(Ki||(Ki=_g(["Congratulations, you have earned three points and formed a territory."]))),$localize(Qi||(Qi=_g(["Failed, you have not captured the group. Play on the last liberty of that group."])))),wte.informational($localize(Xi||(Xi=_g(["Suicide"]))),$localize(Ji||(Ji=_g(["In Go, suicide is forbidden.\n        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.\n        Here, the top left intersection is a suicide for Light.\n        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player."]))),new eoe([[doe,coe,doe,doe,doe],[coe,doe,doe,doe,doe],[coe,doe,doe,doe,uoe],[uoe,coe,doe,uoe,doe],[doe,uoe,doe,uoe,coe]],[0,0],0,fB.empty(),Jae.PLAYING)),wte.informational($localize(ea||(ea=_g(["Life and death (death)"]))),$localize(ta||(ta=_g(["From the capture rule follows the life and death notion:\n        dead stones are stones that are definitely capturable (without losing anything else).\n        Alive stones are stones that can never be captured.\n        From the capture rule, Dark can play inside Light's territory and make a capture.\n        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).\n        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories."]))),new eoe([[doe,doe,doe,doe,doe],[coe,coe,coe,doe,doe],[uoe,uoe,coe,doe,doe],[doe,uoe,coe,doe,doe],[uoe,uoe,coe,doe,doe]],[0,0],0,fB.empty(),Jae.PLAYING)),wte.informational($localize(na||(na=_g(["Life and death (eyes)"]))),$localize(ra||(ra=_g(["Here, Light cannot play on the top left, nor on the bottom left.\n        Light will never be able to capture Dark.\n        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive."]))),new eoe([[doe,coe,uoe,doe,doe],[uoe,coe,uoe,doe,doe],[coe,coe,uoe,doe,doe],[uoe,coe,uoe,doe,doe],[doe,coe,uoe,doe,doe]],[0,0],0,fB.empty(),Jae.PLAYING)),wte.informational($localize(ia||(ia=_g(["Seki"]))),$localize(aa||(aa=_g(["If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.\n        Similarly, if Light plays on the middle line, Dark will capture Light.\n        In other words, there is no point in playing on the middle line.\n        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral."]))),new eoe([[doe,uoe,coe,doe,uoe,coe,doe],[doe,uoe,coe,coe,uoe,coe,doe],[doe,uoe,coe,coe,uoe,coe,doe],[doe,uoe,coe,coe,uoe,coe,doe],[doe,uoe,coe,uoe,uoe,coe,doe],[doe,uoe,coe,uoe,uoe,coe,doe],[doe,uoe,coe,doe,uoe,coe,doe]],[0,0],0,fB.empty(),Jae.PLAYING)),wte.fromMove($localize(oa||(oa=_g(["Ko"]))),$localize(sa||(sa=_g(["A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>\n        Capture the light stone."]))),new eoe([[doe,doe,doe,doe,doe,doe,doe],[doe,doe,doe,doe,doe,doe,doe],[doe,doe,doe,coe,uoe,doe,doe],[doe,doe,coe,uoe,doe,uoe,doe],[doe,doe,doe,coe,uoe,doe,doe],[doe,doe,doe,doe,doe,doe,doe],[doe,doe,doe,doe,doe,doe,doe]],[0,0],0,fB.empty(),Jae.PLAYING),[new Qae(4,3)],$localize(ua||(ua=_g(["Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.\n        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.\n        This rule is called the Ko.\n        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after."]))),$localize(ca||(ca=_g(["Failed!"])))),wte.fromMove($localize(la||(la=_g(["End of the game"]))),$localize(fa||(fa=_g(["When a player feels that there is no advantage to putting a new stone, that player can pass a turn.\n        The game phase stops when both players pass consecutively, and we move on to the counting phase.\n        The dead groups are then marked by clicking on them.\n        Every intersection in a player's territory earns that player a point.\n        The winner is the one with most points.<br/><br/>\n        A last stone is dead, mark it."]))),new eoe([[uoe,coe,coe,coe,coe,coe,hoe,hoe,hoe],[uoe,uoe,uoe,uoe,coe,coe,coe,hoe,hoe],[uoe,foe,uoe,uoe,coe,loe,loe,coe,hoe],[coe,uoe,uoe,uoe,uoe,coe,hoe,hoe,hoe],[doe,uoe,foe,uoe,coe,coe,loe,coe,hoe],[uoe,foe,uoe,uoe,coe,coe,coe,coe,coe],[uoe,uoe,coe,coe,coe,uoe,uoe,coe,uoe],[coe,coe,coe,uoe,uoe,uoe,foe,uoe,uoe],[hoe,hoe,coe,coe,coe,uoe,uoe,foe,foe]],[0,0],0,fB.empty(),Jae.COUNTING),[new Qae(0,3)],$localize(ha||(ha=_g(["Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.\n        The intersections where the prisoners are count as Dark's territory\n        Light has 8 territories and 1 prisoner.\n        The end result is therefore 18 - 9 for Dark."]))),$localize(da||(da=_g(["Failed, try again."]))))]});function poe(e,t){if(1&e&&(cC(),nP(0,"circle",10)),2&e){var n=fP(2).index,r=fP().index;$b("cx",25+50*n)("cy",25+50*r)("r",22)}}function goe(e,t){if(1&e){var n=aP();cC(),eP(0,"line",11),uP("click",function(){Nk(n);var e=fP(2).index,t=fP().index;return fP().onClick(e,t)}),tP()}if(2&e){var r=fP(2).index,i=fP().index;$b("x1",50*r)("y1",50*i)("x2",50+50*r)("y2",50+50*i)}}function yoe(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"circle",7),uP("click",function(){Nk(n);var e=fP().index,t=fP().index;return fP().onClick(e,t)}),tP(),Yb(2,poe,1,3,"circle",8),Yb(3,goe,1,4,"line",9),tP()}if(2&e){var r=fP().index,i=fP().index,a=fP();pE(1),Xb("ngClass",a.getSpaceClass(r,i)),$b("cx",25+50*r)("cy",25+50*i)("r",22),pE(1),Xb("ngIf",a.isLastCase(r,i)),pE(1),Xb("ngIf",a.isDead(r,i))}}function moe(e,t){if(1&e){var n=aP();cC(),eP(0,"circle",15),uP("click",function(){Nk(n);var e=fP(2).index,t=fP().index;return fP().onClick(e,t)}),tP()}if(2&e){var r=fP(2),i=r.index,a=r.$implicit,o=fP().index,s=fP();$b("cx",25+50*i)("cy",25+50*o)("r",10)("class",a===s.GoPiece.LIGHT_TERRITORY?"player1":"player0")}}function koe(e,t){if(1&e){var n=aP();cC(),eP(0,"rect",12),uP("click",function(){Nk(n);var e=fP().index,t=fP().index;return fP().onClick(e,t)}),tP(),eP(1,"line",13),uP("click",function(){Nk(n);var e=fP().index,t=fP().index;return fP().onClick(e,t)}),tP(),eP(2,"line",13),uP("click",function(){Nk(n);var e=fP().index,t=fP().index;return fP().onClick(e,t)}),tP(),Yb(3,moe,1,4,"circle",14)}if(2&e){var r=fP().index,i=fP().index,a=fP();vP("id","click_",r,"_",i,""),$b("x",50*r)("y",50*i),pE(1),$b("x1",50*r)("y1",25+50*i)("x2",50+50*r)("y2",25+50*i),pE(1),$b("x1",25+50*r)("y1",50*i)("x2",25+50*r)("y2",50+50*i),pE(1),Xb("ngIf",a.isTerritory(r,i))}}function Coe(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,yoe,4,6,"g",5),Yb(2,koe,4,13,"ng-template",null,6,MT),tP()),2&e){var n=t.index,r=Kb(3),i=fP().index,a=fP();pE(1),Xb("ngIf",a.caseIsFull(n,i))("ngIfElse",r)}}function woe(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Coe,4,2,"g",2),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}function _oe(e,t){if(1&e&&(cC(),nP(0,"rect",16)),2&e){var n=fP();$b("x",12.5+50*n.ko.get().x)("y",12.5+50*n.ko.get().y)}}function Eoe(e,t){if(1&e){var n=aP();cC(),eP(0,"circle",17),uP("click",function(){var e=Nk(n).$implicit;return fP().onClick(e.x,e.y)}),tP()}if(2&e){var r=t.$implicit;$b("cx",25+50*r.x)("cy",25+50*r.y)("r",7)}}var boe=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).ko=fB.empty(),r.last=fB.empty(),r.captures=[],r.GoPiece=Xae,r.scores=fB.of([0,0]),r.rules=new aoe(eoe),r.availableMinimaxes=[new soe(r.rules,"GoMinimax")],r.encoder=Qae.encoder,r.tutorial=(new voe).tutorial,r.canPass=!0,r.updateBoard(),r}return Wg(n,[{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return n.last=fB.empty(),a=new Qae(e,t),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState,n.scores.get()));case 6:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){sB(n.VERBOSE,"updateBoard");var e=this.rules.node.gameState,t=this.rules.node.move,r=e.phase;this.board=e.getCopiedBoard(),this.scores=fB.of(e.getCapturedCopy()),this.ko=e.koCoord,t.isPresent()?this.showCaptures():this.captures=[],this.last=t.map(function(e){return e.coord}),this.canPass=r!==Jae.FINISHED}},{key:"showCaptures",value:function(){var e=this.rules.node.mother.get().gameState;this.captures=[];for(var t=0;t<this.board.length;t++)for(var n=0;n<this.board[0].length;n++){var r=new Zee(n,t),i=!1===e.getPieceAt(r).isEmpty(),a=this.board[t][n]===Xae.EMPTY,o=!1===this.ko.equalsValue(r);i&&a&&o&&this.captures.push(r)}}},{key:"pass",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.rules.node.gameState.phase,t.abrupt("return",n===Jae.PLAYING||n===Jae.PASSED?e.onClick(Qae.PASS.coord.x,Qae.PASS.coord.y):(v7(n===Jae.COUNTING||n===Jae.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(Qae.ACCEPT.coord.x,Qae.ACCEPT.coord.y)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getSpaceClass",value:function(e,t){var n=this.rules.node.gameState.getPieceAtXY(e,t);return this.getPlayerClass(n.getOwner())}},{key:"caseIsFull",value:function(e,t){return this.rules.node.gameState.getPieceAtXY(e,t)!==Xae.EMPTY&&!this.isTerritory(e,t)}},{key:"isLastCase",value:function(e,t){if(this.last.isPresent()){var n=this.last.get();return e===n.x&&t===n.y}return!1}},{key:"isDead",value:function(e,t){return this.rules.node.gameState.isDead(new Zee(e,t))}},{key:"isTerritory",value:function(e,t){return this.rules.node.gameState.isTerritory(new Zee(e,t))}}]),n}(nne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-go"]],features:[Rb],decls:5,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["width","25","height","25","class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke highlighted",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","highlighted"],[1,"base","no-fill","captured-stroke",3,"click"],["width","50","height","50","fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],["width","25","height","25",1,"captured-stroke","mid-stroke","no-fill"],[1,"captured",3,"click"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),nP(1,"rect",1),Yb(2,woe,2,1,"g",2),Yb(3,_oe,1,2,"rect",3),Yb(4,Eoe,1,3,"circle",4),tP()),2&e&&($b("viewBox","0 -3 "+50*t.board.length+" "+(6+50*t.board.length)),pE(1),$b("width",50*t.board.length)("height",50*t.board.length),pE(1),Xb("ngForOf",t.board),pE(1),Xb("ngIf",t.ko.isPresent()),pE(1),Xb("ngForOf",t.captures))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Poe=function(){function e(t,n,r){Zg(this,e),this.value=t,this.name=n,this.rgb=r}return Wg(e,null,[{key:"of",value:function(t){switch(t){case 0:return e.ANY;case 1:return e.ORANGE;case 2:return e.BLUE;case 3:return e.PURPLE;case 4:return e.PINK;case 5:return e.YELLOW;case 6:return e.RED;case 7:return e.GREEN;default:return oB.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),e.BROWN}}}]),e}();Poe.ANY=new Poe(0,"any","#000"),Poe.ORANGE=new Poe(1,"orange","#d67421"),Poe.BLUE=new Poe(2,"blue","#006bac"),Poe.PURPLE=new Poe(3,"purple","#6f3787"),Poe.PINK=new Poe(4,"pink","#d2719e"),Poe.YELLOW=new Poe(5,"yellow","#e2c200"),Poe.RED=new Poe(6,"red","#d23339"),Poe.GREEN=new Poe(7,"green","#009157"),Poe.BROWN=new Poe(8,"brown","#562500");var Soe=function(){function e(t,n){Zg(this,e),this.player=t,this.color=n}return Wg(e,[{key:"equals",value:function(e){return e.player===this.player&&e.color===this.color}},{key:"isEmpty",value:function(){return this.player.equals(A7.NONE)}},{key:"belongsTo",value:function(e){return this.player===e}}],[{key:"of",value:function(t,n){return new e(t,Poe.of(n))}},{key:"createPlayerColors",value:function(t){return{ORANGE:new e(t,Poe.ORANGE),BLUE:new e(t,Poe.BLUE),PURPLE:new e(t,Poe.PURPLE),PINK:new e(t,Poe.PINK),YELLOW:new e(t,Poe.YELLOW),RED:new e(t,Poe.RED),GREEN:new e(t,Poe.GREEN),BROWN:new e(t,Poe.BROWN)}}}]),e}();Soe.EMPTY=new Soe(A7.NONE,Poe.ANY),Soe.ZERO=Soe.createPlayerColors(R7.ZERO),Soe.ONE=Soe.createPlayerColors(R7.ONE);var Ooe=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"getColorAt",value:function(t,n){return e.COLORS[n][t]}},{key:"getInitialBoard",value:function(){var e=Soe.EMPTY;return[[1,2,3,4,5,6,7,8].map(function(e){return Soe.of(R7.ONE,e)}),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(function(e){return Soe.of(R7.ZERO,e)})]}},{key:"isEmptyAt",value:function(e,t){return e[t.y][t.x].equals(Soe.EMPTY)}},{key:"allPieceCoords",value:function(t){for(var n=[],r=0;r<t.length;r++)for(var i=0;i<t[r].length;i++){var a=new Zee(i,r);e.isEmptyAt(t,a)||n.push(a)}return n}}]),e}();Ooe.INITIAL=Ooe.getInitialBoard(),Ooe.SIZE=8,Ooe.COLORS=D7.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],Poe.of);var Toe=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.call(this)}return Wg(n,[{key:"isPieceMove",value:function(){return!1}},{key:"length",value:function(){return 0}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"KamisadoMove(PASS)"}}]),n}(ute);Toe.PASS=new Toe;var Ioe,Aoe=function(e){xg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,r)}return Wg(n,[{key:"isPieceMove",value:function(){return!0}},{key:"equals",value:function(e){return e===this||!!e.isPieceMove()&&!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"KamisadoMove("+this.coord+"->"+this.end+")"}}],[{key:"of",value:function(e,t){if(e.isNotInRange(Ooe.SIZE,Ooe.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+e.toString());if(t.isNotInRange(Ooe.SIZE,Ooe.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+t.toString());return new n(e,t)}}]),n}(hne);!function(e){e.PASS=Toe.PASS,e.of=function(e,t){return Aoe.of(e,t)},e.encoder=new(function(t){xg(r,t);var n=Dg(r);function r(){return Zg(this,r),n.apply(this,arguments)}return Wg(r,[{key:"maxValue",value:function(){return 34952}},{key:"encodeNumber",value:function(e){return e.isPieceMove()?4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y:0}},{key:"decodeNumber",value:function(t){if(0===t)return e.PASS;var n=t%16,r=(t=t/16|0)%16,i=(t=t/16|0)%16;return e.of(new Zee((t=t/16|0)%16,i),new Zee(r,n))}}]),r}(T7))}(Ioe||(Ioe={}));var Roe=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o){var s;return Zg(this,n),(s=t.call(this,D7.copyBiArray(o),e)).colorToPlay=r,s.coordToPlay=i,s.alreadyPassed=a,s}return Wg(n,null,[{key:"getInitialState",value:function(){return new n(0,Poe.ANY,fB.empty(),!1,Ooe.INITIAL)}}]),n}(ote),Moe=function(){var e=Wg(function e(){Zg(this,e)});return e.NOT_RIGHT_COLOR=function(){return $localize(va||(va=_g(["This piece is not of the color you have to play."])))},e.DIRECTION_NOT_ALLOWED=function(){return $localize(pa||(pa=_g(["You can only move forward, orthogonally or diagonally."])))},e.MOVE_BLOCKED=function(){return $localize(ga||(ga=_g(["This move is blocked by another piece."])))},e.PLAY_WITH_SELECTED_PIECE=function(){return $localize(ya||(ya=_g(["You must play with the selected piece."])))},e}(),xoe=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"nextCoordToPlay",value:function(e,t){return fB.ofNullable(Ooe.allPieceCoords(e.board).find(function(n){var r=e.getPieceAt(n);return r.player===e.getCurrentOpponent()&&r.color===t}))}},{key:"applyLegalMove",value:function(e,t,n){if(e.isPieceMove()){var r=e.coord,i=e.end,a=t.getCopiedBoard();a[i.y][i.x]=a[r.y][r.x],a[r.y][r.x]=Soe.EMPTY;var o=Ooe.getColorAt(i.x,i.y),s=this.nextCoordToPlay(t,o);return new Roe(t.turn+1,o,s,!1,a)}var u=this.nextCoordToPlay(t,t.colorToPlay);return new Roe(t.turn+1,t.colorToPlay,u,!0,t.board)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=t.getCurrentPlayer();if(n.mustPass(t)&&t.alreadyPassed)return gte.getDefeat(r);var i=Sg(n.getFurthestPiecePositions(t),2),a=i[0];return 7===i[1]?gte.ONE_WON:0===a?gte.ZERO_WON:gte.ONGOING}}],[{key:"getColorMatchingPiece",value:function(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new Zee(0,7),new Zee(1,7),new Zee(2,7),new Zee(3,7),new Zee(4,7),new Zee(5,7),new Zee(6,7),new Zee(7,7)]}},{key:"getMovablePieces",value:function(e){var t=this;return n.getColorMatchingPiece(e).filter(function(n){var r,i=Hg(t.playerDirections(e.getCurrentPlayer()));try{for(i.s();!(r=i.n()).done;){var a=r.value,o=n.getNext(a);if(e.isOnBoard(o)&&Ooe.isEmptyAt(e.board,o))return!0}}catch(s){i.e(s)}finally{i.f()}return!1})}},{key:"playerDirections",value:function(e){return e===R7.ONE?[Hee.DOWN,Hee.DOWN_LEFT,Hee.DOWN_RIGHT]:[Hee.UP,Hee.UP_LEFT,Hee.UP_RIGHT]}},{key:"directionAllowedForPlayer",value:function(e,t){return t===R7.ZERO?e.y<0:e.y>0}},{key:"getListMovesFromState",value:function(e){var t=n.getMovablePieces(e);return 0===t.length?(v7(!1===e.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[Ioe.PASS]):n.getListMovesFromNonBlockedState(e,t)}},{key:"getListMovesFromNonBlockedState",value:function(e,t){var r,i=[],a=e.getCurrentPlayer(),o=Hg(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=Hg(n.playerDirections(a));try{for(c.s();!(s=c.n()).done;)for(var l=s.value,f=1;f<Ooe.SIZE;f++){var h=u.getNext(l,f);if(!e.isOnBoard(h)||!Ooe.isEmptyAt(e.board,h))break;var d=Ioe.of(u,h);i.push(d)}}catch(v){c.e(v)}finally{c.f()}}}catch(v){o.e(v)}finally{o.f()}return i}},{key:"mustPass",value:function(e){return 0===this.getMovablePieces(e).length}},{key:"getFurthestPiecePositions",value:function(e){var t=7,n=0;return Ooe.allPieceCoords(e.board).forEach(function(r){var i=e.getPieceAt(r);v7(i!==Soe.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),i.player===R7.ONE?n=Math.max(n,r.y):t=Math.min(t,r.y)}),[t,n]}},{key:"isLegal",value:function(e,t){if(e.isPieceMove()){var r=e.coord,i=e.end,a=t.colorToPlay,o=t.getPieceAt(r);if(!o.belongsTo(t.getCurrentPlayer()))return hB.failure(ete.MUST_CHOOSE_PLAYER_PIECE());if(a!==Poe.ANY&&o.color!==a)return hB.failure(Moe.NOT_RIGHT_COLOR());if(!t.getPieceAt(i).isEmpty())return hB.failure(ete.MUST_CLICK_ON_EMPTY_SPACE());var s=Hee.factory.fromMove(r,i);if(s.isFailure())return hB.failure(Moe.DIRECTION_NOT_ALLOWED());var u=s.get();if(!n.directionAllowedForPlayer(u,t.getCurrentPlayer()))return hB.failure(Moe.DIRECTION_NOT_ALLOWED());for(var c=r;!c.equals(i);)if(c=c.getNext(u),!t.getPieceAt(c).isEmpty())return hB.failure(Moe.MOVE_BLOCKED());return hB.success(void 0)}return this.isLegalPass(t)}},{key:"isLegalPass",value:function(e){return this.mustPass(e)&&!e.alreadyPassed?hB.success(void 0):hB.failure(ete.CANNOT_PASS())}}]),n}(yte),Noe=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=xoe.getListMovesFromState(e.gameState);return D7.sortByDescending(t,function(e){return e.length()}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=t.getCurrentPlayer();if(xoe.mustPass(t)&&t.alreadyPassed)return new nte(n.getDefeatValue());var r=Sg(xoe.getFurthestPiecePositions(t),2),i=r[0],a=r[1];return new nte(7===a?R7.ONE.getVictoryValue():0===i?R7.ZERO.getVictoryValue():a-(7-i))}}]),n}(tte),Doe=Soe.EMPTY,Loe=Soe.ZERO.ORANGE,Foe=Soe.ONE.ORANGE,Uoe=Soe.ZERO.BLUE,Voe=Soe.ONE.BLUE,Boe=Soe.ZERO.PURPLE,zoe=Soe.ONE.PURPLE,Hoe=Soe.ZERO.PINK,Goe=Soe.ONE.PINK,$oe=Soe.ZERO.YELLOW,Zoe=Soe.ONE.YELLOW,qoe=Soe.ZERO.RED,Woe=Soe.ONE.RED,joe=Soe.ZERO.GREEN,Yoe=Soe.ONE.GREEN,Koe=Soe.ZERO.BROWN,Qoe=Soe.ONE.BROWN,Xoe=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(ma||(ma=_g(["Goal of the game"]))),$localize(ka||(ka=_g(["At Kamisado, there are two ways to win the game:\n        either by moving one of your pieces on the opponent's starting line,\n        or by forcing the opponent to make a move that blocks the entire game.\n        Here, Dark wins because its brown piece is on Light's starting line, on the top left."]))),new Roe(5,Poe.ORANGE,fB.empty(),!1,[[Koe,Voe,zoe,Goe,Zoe,Woe,Yoe,Qoe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Doe,Doe,Doe,Foe,Doe,Doe,Doe,Doe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Doe,joe,qoe,$oe,Hoe,Boe,Uoe,Loe]])).withPreviousMove(Ioe.of(new Zee(0,7),new Zee(0,0))),wte.anyMove($localize(Ca||(Ca=_g(["Initial board and initial move"]))),$localize(wa||(wa=_g(["Here is the initial board.\n        At Kamisado, pieces can only move forward, vertically or diagonally.\n        You're playing first, with dark pieces, you can make your first move.<br/><br/>\n        Click on the piece of your choice and click on the landing square."]))),Roe.getInitialState(),Ioe.of(new Zee(7,7),new Zee(3,3)),$localize(_a||(_a=_g(["Perfect! Note that each of your piece has a different color."])))),wte.fromMove($localize(Ea||(Ea=_g(["Moving"]))),$localize(ba||(ba=_g(["Let us now consider the move of Light, after the blue piece has been moved by Dark.\n        All moves after the initial move must be made from the piece that corresponds to the color\n        of the square upon which the last move ended.\n        Here, the last move ended on the pink square, hence the pink piece must move.\n        It is already selected, you do not have to click on it.<br/><br/>\n        Move it on a blue square."]))),new Roe(1,Poe.PINK,fB.of(new Zee(3,0)),!1,[[Foe,Voe,zoe,Goe,Zoe,Woe,Yoe,Qoe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Doe,Doe,Doe,Doe,Doe,Doe,Uoe,Doe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Koe,joe,qoe,$oe,Hoe,Boe,Doe,Loe]]),[Ioe.of(new Zee(3,0),new Zee(3,6)),Ioe.of(new Zee(3,0),new Zee(4,1))],$localize(Pa||(Pa=_g(["Congratulations!"]))),$localize(Sa||(Sa=_g(["You have not moved your pink piece on a blue square!"])))).withPreviousMove(Ioe.of(new Zee(6,7),new Zee(6,5))),wte.informational($localize(Oa||(Oa=_g(["Stuck situation"]))),$localize(Ta||(Ta=_g(["Dark moved to another pink square, hence you have to move your pink piece again.\n        However, your pink piece is stuck! In this case, you must pass your turn.\n        Dark will now have to play by moving its pink piece."]))),new Roe(1,Poe.PINK,fB.of(new Zee(3,6)),!1,[[Foe,Voe,zoe,Doe,Zoe,Woe,Yoe,Qoe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Uoe],[Doe,Doe,Doe,Doe,Doe,Doe,Doe,Doe],[Doe,Doe,Doe,Goe,Doe,Doe,Doe,Doe],[Koe,joe,qoe,$oe,Hoe,Boe,Doe,Loe]])).withPreviousMove(Ioe.of(new Zee(6,5),new Zee(7,4))),wte.fromMove($localize(Ia||(Ia=_g(["Victory by blocking"]))),$localize(Aa||(Aa=_g(["At any time, if a player blocks the entire game, that player loses.\n        In other words, if a player forces its opponent to move a piece that the opponent cannot move,\n        and the player cannot move its own piece of the same color, then that player loses.\n        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>\n        Try to make this move."]))),new Roe(2,Poe.RED,fB.of(new Zee(2,4)),!1,[[Doe,Voe,zoe,Doe,Doe,Woe,Doe,Doe],[Doe,Doe,Doe,Zoe,Doe,Doe,Doe,Doe],[Doe,Doe,Doe,Goe,Doe,zoe,Doe,Doe],[Doe,Doe,Doe,$oe,Doe,Doe,Doe,Doe],[Doe,Doe,qoe,Doe,Doe,Doe,Doe,Doe],[Doe,Doe,Doe,Doe,Doe,Doe,Yoe,Doe],[Foe,Doe,Doe,Doe,Doe,Hoe,Doe,Qoe],[Koe,joe,Doe,Doe,Doe,Doe,Uoe,Loe]]),[Ioe.of(new Zee(2,4),new Zee(0,2))],$localize(Ra||(Ra=_g(["Perfect!\n         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.\n         Your orange piece will be stuck and you will have to pass your turn.\n         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.\n         In this case, the last player to have moved a piece loses.\n         Here, your opponent will have moved its green piece last, you therefore win!"]))),$localize(Ma||(Ma=_g(["Failed!"])))).withPreviousMove(Ioe.of(new Zee(4,0),new Zee(3,1)))]});function Joe(e,t){if(1&e&&(cC(),nP(0,"circle",8)),2&e){var n=fP(),r=n.$implicit,i=n.index,a=fP().index,o=fP();Xb("ngClass",o.piecePlayerClass(r)),$b("cx",o.SPACE_SIZE/2+i*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+a*o.SPACE_SIZE)("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)}}function ese(e,t){if(1&e&&(cC(),nP(0,"rect",9)),2&e){var n=fP(),r=n.index,i=n.$implicit,a=fP().index,o=fP();$b("x",o.SPACE_SIZE/2+r*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+a*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(i)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(i)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)("fill",o.pieceColor(i))}}function tse(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"g",4),uP("click",function(){var e=Nk(n).index,t=fP().index;return fP().onClick(e,t)}),nP(2,"rect",5),Yb(3,Joe,1,4,"circle",6),Yb(4,ese,1,7,"rect",7),tP(),tP()}if(2&e){var r=t.$implicit,i=t.index,a=fP().index,o=fP();pE(1),vP("id","click_",i,"_",a,""),pE(1),$b("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE)("fill",o.backgroundColor(i,a)),pE(1),Xb("ngIf",r!==o.UNOCCUPIED),pE(1),Xb("ngIf",r!==o.UNOCCUPIED)}}function nse(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,tse,5,9,"g",1),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}function rse(e,t){if(1&e&&(cC(),eP(0,"g"),nP(1,"rect",10),nP(2,"rect",10),tP()),2&e){var n=fP();pE(1),$b("x",n.lastPieceMove.get().coord.x*n.SPACE_SIZE)("y",n.lastPieceMove.get().coord.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE),pE(1),$b("x",n.lastPieceMove.get().end.x*n.SPACE_SIZE)("y",n.lastPieceMove.get().end.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function ise(e,t){if(1&e&&(cC(),nP(0,"circle",11)),2&e){var n=fP();$b("cx",n.SPACE_SIZE/2+n.chosen.get().x*n.SPACE_SIZE)("cy",n.SPACE_SIZE/2+n.chosen.get().y*n.SPACE_SIZE)("r",n.SPACE_SIZE/2-n.STROKE_WIDTH)}}var ase=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).UNOCCUPIED=Soe.EMPTY,r.lastMove=fB.empty(),r.lastPieceMove=fB.empty(),r.chosen=fB.empty(),r.chosenAutomatically=!1,r.rules=new xoe(Roe),r.availableMinimaxes=[new Noe(r.rules,"KamisadoMinimax")],r.encoder=Ioe.encoder,r.tutorial=(new Xoe).tutorial,r.canPass=!1,r.updateBoard(),r}return Wg(n,[{key:"backgroundColor",value:function(e,t){return Ooe.getColorAt(e,t).rgb}},{key:"isPlayerZero",value:function(e){return e.player===R7.ZERO}},{key:"pieceColor",value:function(e){return e.color.rgb}},{key:"piecePlayerClass",value:function(e){return this.getPlayerClass(e.player)}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;if(this.board=e.getCopiedBoard(),this.lastMove=this.rules.node.move,this.lastPieceMove=fB.empty(),this.lastMove.isPresent()){var t=this.lastMove.get();t.isPieceMove()&&(this.lastPieceMove=fB.of(t))}this.canPass=xoe.mustPass(e);var n=this.rules.getGameStatus(this.rules.node)!==gte.ONGOING;this.canPass||e.coordToPlay.isAbsent()||n?(this.chosenAutomatically=!1,this.chosen=fB.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}},{key:"pass",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(v7(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(Ioe.PASS,e.rules.node.gameState)));case 1:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new Zee(e,t),!n.canPass){r.next=6;break}return r.abrupt("return",n.cancelMove(ete.MUST_PASS()));case 6:if(!n.chosen.isAbsent()){r.next=8;break}return r.abrupt("return",n.choosePiece(e,t));case 8:if(!1!==n.chosenAutomatically||!n.chosen.equalsValue(a)){r.next=10;break}return r.abrupt("return",(n.cancelMoveAttempt(),pB.SUCCESS));case 10:if(o=n.rules.node.gameState.getPieceAtXY(e,t),s=n.rules.node.gameState.getCurrentPlayer(),!o.belongsTo(s)){r.next=15;break}r.t0=n.chosenAutomatically?n.cancelMove(Moe.PLAY_WITH_SELECTED_PIECE()):(n.chosen=fB.of(a),pB.SUCCESS),r.next=18;break;case 15:return r.next=17,n.chooseDestination(e,t);case 17:r.t0=r.sent;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=this.rules.node.gameState.getPieceAtXY(e,t),r=this.rules.node.gameState.getCurrentOpponent();return n.belongsTo(r)?this.cancelMove(ete.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=fB.of(new Zee(e,t)),pB.SUCCESS)}},{key:"chooseDestination",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new Zee(e,t),o=Ioe.of(i,a),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 2:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenAutomatically||(this.chosen=fB.empty())}}]),n}(nne);return e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-kamisado"]],features:[Rb],decls:4,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill highlighted",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","highlighted"],["id","selectedPiece",1,"base","mid-stroke","no-fill","highlighted"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),Yb(1,nse,2,1,"g",1),Yb(2,rse,3,8,"g",2),Yb(3,ise,1,3,"circle",3),tP()),2&e&&($b("viewBox",t.getViewBox()),pE(1),Xb("ngForOf",t.board),pE(1),Xb("ngIf",t.lastPieceMove.isPresent()),pE(1),Xb("ngIf",t.chosen.isPresent()))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),ose=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,null,[{key:"getInitialState",value:function(){var e=A7.NONE,t=A7.ZERO,r=A7.ONE;return new n([[e,t,t,t,t,t,t,e],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[e,t,t,t,t,t,t,e]],0)}},{key:"isOnBoard",value:function(e){return e.isInRange(n.SIZE,n.SIZE)}}]),n}(ote);return e.SIZE=8,e}(),sse=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r)).direction=i,a.direction=Hee.factory.fromMove(e,r).get(),a}return Wg(n,[{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"LinesOfActionMove("+this.coord+"->"+this.end+")"}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}],[{key:"of",value:function(e,t){var r=Hee.factory.fromMove(e,t);return r.isFailure()?hB.failure(r.getReason()):e.isNotInRange(ose.SIZE,ose.SIZE)?hB.failure("start coord is not in range"):t.isNotInRange(ose.SIZE,ose.SIZE)?hB.failure("end coord is not in range"):hB.success(new n(e,t,r.get()))}}]),n}(hne);sse.encoder=hne.getEncoder(ose.SIZE,ose.SIZE,function(e,t){return sse.of(e,t).get()});var use=function(){var e=Wg(function e(){Zg(this,e)});return e.INVALID_MOVE_LENGTH=function(){return $localize(xa||(xa=_g(["Your move should have a length equal to the number of pieces that exist on the same line."])))},e.CANNOT_JUMP_OVER_OPPONENT=function(){return $localize(Na||(Na=_g(["You cannot jump over the opponent's pieces."])))},e.PIECE_CANNOT_MOVE=function(){return $localize(Da||(Da=_g(["This piece has no possible move, select another one."])))},e.INVALID_DIRECTION=function(){return $localize(La||(La=_g(["A move must be orthogonal or diagonal."])))},e}(),cse=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();return r[e.coord.y][e.coord.x]=A7.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer(),new ose(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=Sg(n.getNumberOfGroups(t),2),i=r[0],a=r[1];return 1===i&&a>1?gte.ZERO_WON:i>1&&1===a?gte.ONE_WON:gte.ONGOING}}],[{key:"getListMovesFromState",value:function(e){var t=[];if(n.getVictory(e).isPresent())return t;for(var r=0;r<ose.SIZE;r++)for(var i=0;i<ose.SIZE;i++){var a=new Zee(i,r);if(e.getPieceAt(a).isPlayer()){var o,s=Hg(n.possibleTargets(e,a));try{for(s.s();!(o=s.n()).done;){var u=o.value,c=sse.of(a,u).get();t.push(c)}}catch(l){s.e(l)}finally{s.f()}}}return t}},{key:"getNumberOfGroups",value:function(e){for(var t=D7.createTable(ose.SIZE,ose.SIZE,-1),r=[0,0],i=0,a=0;a<ose.SIZE;a++)for(var o=0;o<ose.SIZE;o++)if(-1===t[a][o]){var s=e.getPieceAt(new Zee(o,a));s.isPlayer()&&(i+=1,n.markGroupStartingAt(e,t,new Zee(o,a),i),r[s.value]+=1)}return r}},{key:"markGroupStartingAt",value:function(e,t,n,r){for(var i=[n],a=e.getPieceAt(n);i.length>0;){var o=oB.getNonNullable(i.pop());if(-1===t[o.y][o.x]){var s=e.getPieceAt(o);if(s===a){t[o.y][o.x]=r;var u,c=Hg(Hee.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=o.getNext(l);e.isOnBoard(f)&&i.push(f)}}catch(h){c.e(h)}finally{c.f()}}else s===A7.NONE&&(t[o.y][o.x]=0)}}}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)!==t.getCurrentPlayer()?hB.failure(ete.MUST_CHOOSE_PLAYER_PIECE()):e.length()!==this.numberOfPiecesOnLine(t,e.coord,e.direction)?hB.failure(use.INVALID_MOVE_LENGTH()):e.coord.getCoordsToward(e.end).some(function(e){return t.getPieceAt(e)===t.getCurrentOpponent()})?hB.failure(use.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.end)===t.getCurrentPlayer()?hB.failure(ete.CANNOT_SELF_CAPTURE()):hB.success(void 0)}},{key:"numberOfPiecesOnLine",value:function(e,t,r){var i,a=0,o=Hg(n.getLineCoords(t,r));try{for(o.s();!(i=o.n()).done;){var s=i.value;e.getPieceAt(s).isPlayer()&&(a+=1)}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getLineCoords",value:function(e,t){for(var r=n.getEntranceAndForwardDirection(e,t),i=r[0],a=r[1],o=[];ose.isOnBoard(i);)o.push(i),i=i.getNext(a);return o}},{key:"getEntranceAndForwardDirection",value:function(e,t){switch(t){case Hee.UP:case Hee.DOWN:return[new Zee(e.x,0),Hee.DOWN];case Hee.LEFT:case Hee.RIGHT:return[new Zee(0,e.y),Hee.RIGHT];case Hee.UP_RIGHT:case Hee.DOWN_LEFT:return[new Zee(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),Hee.UP_RIGHT];default:return oB.expectToBeMultiple(t,[Hee.UP_LEFT,Hee.DOWN_RIGHT]),[new Zee(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),Hee.DOWN_RIGHT]}}},{key:"getVictory",value:function(e){var t=Sg(n.getNumberOfGroups(e),2),r=t[0],i=t[1];return 1===r&&1===i?fB.of(A7.NONE):1===r?fB.of(R7.ZERO):1===i?fB.of(R7.ONE):fB.empty()}},{key:"possibleTargets",value:function(e,t){var r,i=[],a=Hg(Hee.DIRECTIONS);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.numberOfPiecesOnLine(e,t,o),u=t.getNext(o,s);if(e.isOnBoard(u)){var c=sse.of(t,u).get();n.isLegal(c,e).isSuccess()&&i.push(u)}}}catch(l){a.e(l)}finally{a.f()}return i}}]),n}(yte),lse=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){return cse.getListMovesFromState(e.gameState)}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Sg(cse.getNumberOfGroups(t),2),r=n[0],i=n[1];return new nte(1===r&&i>1?R7.ZERO.getVictoryValue():r>1&&1===i?R7.ONE.getVictoryValue():100/r*R7.ZERO.getScoreModifier()+100/i*R7.ONE.getScoreModifier())}}]),n}(tte),fse=A7.NONE,hse=A7.ZERO,dse=A7.ONE,vse=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(Fa||(Fa=_g(["Goal of the game"]))),$localize(Ua||(Ua=_g(["At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.\n        Here, Dark wins the game:\n        Dark's pieces are forming a single group, while Light's pieces form three groups."]))),new ose([[fse,fse,fse,fse,fse,fse,fse,fse],[dse,fse,fse,fse,hse,fse,fse,dse],[fse,fse,hse,hse,dse,fse,fse,fse],[fse,fse,fse,hse,fse,fse,fse,fse],[fse,fse,fse,fse,fse,fse,fse,fse],[fse,fse,fse,fse,fse,fse,fse,fse],[fse,fse,fse,fse,fse,fse,fse,fse],[fse,fse,fse,fse,fse,fse,fse,fse]],0)),wte.anyMove($localize(Va||(Va=_g(["Initial board and initial move"]))),$localize(Ba||(Ba=_g(["Here is the initial board.\n         Moves can be made orthogonally or diagonally.\n         The length of a move is equal to the number of pieces that are on the line of the move.\n         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>\n         You're playing Dark, make the first move!"]))),ose.getInitialState(),sse.of(new Zee(1,7),new Zee(1,5)).get(),$localize(za||(za=_g(["Congratulations!"])))),wte.fromMove($localize(Ha||(Ha=_g(["Jumping"]))),$localize(Ga||(Ga=_g(["During a move, it is possible to jump above your own pieces.\n        But it is forbidden to jump over the opponent's pieces.<br/><br/>\n        You're playing Dark, make a jump over one of your pieces on the following board."]))),new ose([[fse,fse,fse,fse,fse,fse,fse,fse],[fse,fse,dse,hse,hse,fse,fse,fse],[fse,fse,fse,fse,fse,fse,fse,fse],[fse,fse,fse,fse,fse,fse,fse,fse],[fse,fse,fse,fse,fse,fse,fse,fse],[fse,fse,fse,fse,fse,fse,fse,fse],[fse,fse,fse,fse,fse,fse,fse,dse],[fse,fse,fse,fse,fse,fse,fse,hse]],0),[sse.of(new Zee(3,1),new Zee(6,1)).get()],$localize($a||($a=_g(["Congratulations!"]))),$localize(Za||(Za=_g(["Failed. You did not jump over one of your pieces."])))),wte.fromMove($localize(qa||(qa=_g(["Moving"]))),$localize(Wa||(Wa=_g(["Here is a different board. Pick the dark piece in the middle (line 4, column 4)\n        and observe its possible moves.\n        Horizontally, this piece can move only of one square because it is the only piece on this line.\n        Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.\n        But it can only go up, as below it the landing square is occupied by one of your pieces.\n        Diagonally, only one move is possible: on the diagonal that contains three pieces,\n        only in the direction where it does not jump over one of the opponent's pieces.\n        On the other diagonal, there are too many pieces to end the move on the board.<br/><br/>\n        Make one of these moves."]))),new ose([[fse,fse,fse,fse,fse,fse,dse,fse],[fse,fse,fse,fse,fse,hse,fse,fse],[fse,fse,fse,fse,dse,fse,fse,fse],[fse,fse,fse,hse,fse,fse,fse,fse],[fse,fse,fse,fse,fse,fse,fse,dse],[fse,fse,fse,fse,fse,dse,fse,dse],[fse,fse,fse,hse,fse,fse,dse,dse],[fse,fse,fse,hse,fse,fse,fse,fse]],0),[sse.of(new Zee(3,3),new Zee(3,0)).get(),sse.of(new Zee(3,3),new Zee(0,0)).get(),sse.of(new Zee(3,3),new Zee(2,3)).get(),sse.of(new Zee(3,3),new Zee(4,3)).get()],$localize(ja||(ja=_g(["Congratulations!"]))),$localize(Ya||(Ya=_g(["Failed. This was not one of the expected moves."])))),wte.fromPredicate($localize(Ka||(Ka=_g(["Capturing"]))),$localize(Qa||(Qa=_g(["If a move ends on an opponent's piece, it is captured and removed from the board.\n        However, a move cannot end on one of the player's pieces.\n        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!\n        If a player has only one piece, that player wins the game.<br/><br/>\n        On the following board, try to capture one piece with Dark."]))),new ose([[fse,hse,fse,hse,hse,hse,hse,fse],[dse,fse,fse,fse,fse,fse,fse,dse],[fse,fse,hse,fse,dse,fse,fse,fse],[dse,fse,fse,fse,fse,fse,fse,dse],[dse,fse,fse,fse,fse,fse,fse,dse],[dse,fse,fse,fse,fse,fse,fse,dse],[dse,fse,fse,fse,fse,fse,fse,dse],[fse,hse,hse,hse,hse,hse,hse,fse]],0),sse.of(new Zee(2,2),new Zee(4,2)).get(),function(e,t,n){return t.getPieceAt(e.end)===A7.ONE?pB.SUCCESS:pB.failure($localize(Xa||(Xa=_g(["Failed!"]))))},$localize(Ja||(Ja=_g(["Congratulations!"])))),wte.fromMove($localize(eo||(eo=_g(["Tie"]))),$localize(to||(to=_g(["In the special case where a move ends up connecting all pieces of both player, simultaneously,\n        then the game ends up with a tie.<br/><br/>\n        You're playing Dark, force the tie in one move."]))),new ose([[fse,fse,fse,fse,fse,fse,fse,fse],[fse,fse,fse,fse,fse,fse,fse,fse],[hse,fse,fse,hse,dse,hse,fse,fse],[fse,fse,fse,hse,fse,fse,fse,dse],[fse,fse,fse,fse,fse,fse,fse,dse],[fse,fse,fse,fse,fse,fse,fse,dse],[fse,fse,fse,fse,fse,fse,fse,dse],[fse,fse,fse,fse,fse,fse,fse,fse]],0),[sse.of(new Zee(0,2),new Zee(4,2)).get()],$localize(no||(no=_g(["Congratulations!"]))),$localize(ro||(ro=_g(["Failed!"]))))]});function pse(e,t){if(1&e&&(cC(),nP(0,"circle",3)),2&e){var n=fP().index,r=fP().index,i=fP();Xb("ngClass",i.getPieceClasses(n,r)),$b("cx",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+r*i.SPACE_SIZE)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function gse(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"g",2),uP("click",function(){var e=Nk(n).index,t=fP().index;return fP().onClick(e,t)}),nP(2,"rect",3),Yb(3,pse,1,4,"circle",4),tP(),tP()}if(2&e){var r=t.$implicit,i=t.index,a=fP().index,o=fP();pE(1),vP("id","click_",i,"_",a,""),pE(1),Xb("ngClass",o.getSquareClasses(i,a)),$b("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),pE(1),Xb("ngIf",r!==o.EMPTY)}}function yse(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,gse,4,8,"g",1),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}function mse(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"rect",5),uP("click",function(){var e=Nk(n).$implicit;return fP().onClick(e.x,e.y)}),tP(),tP()}if(2&e){var r=t.$implicit,i=fP();pE(1),$b("x",r.x*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("y",r.y*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("width",i.INDICATOR_SIZE)("height",i.INDICATOR_SIZE)}}var kse=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).INDICATOR_SIZE=20,r.EMPTY=A7.NONE,r.targets=[],r.selected=fB.empty(),r.lastMove=fB.empty(),r.captured=fB.empty(),r.rules=new cse(ose),r.availableMinimaxes=[new lse(r.rules,"LinesOfActionMinimax")],r.encoder=sse.encoder,r.tutorial=(new vse).tutorial,r.updateBoard(),r}return Wg(n,[{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new Zee(e,t),!n.selected.isPresent()){r.next=9;break}if(n.getState().getPieceAt(a)!==n.getState().getCurrentPlayer()){r.next=7;break}return r.abrupt("return",n.select(a));case 7:return o=sse.of(n.selected.get(),new Zee(e,t)),r.abrupt("return",o.isSuccess()?n.chooseMove(o.get(),n.rules.node.gameState):n.cancelMove(use.INVALID_DIRECTION()));case 9:return r.abrupt("return",n.select(a));case 10:case"end":return r.stop()}},r)}))()}},{key:"select",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.getState().getPieceAt(e)!==t.getState().getCurrentPlayer()?t.cancelMove(ete.MUST_CHOOSE_PLAYER_PIECE()):(t.selected=fB.of(e),t.targets=cse.possibleTargets(t.rules.node.gameState,t.selected.get()),0===t.targets.length?t.cancelMove(use.PIECE_CANNOT_MOVE()):pB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"updateBoard",value:function(){if(this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.lastMove.get();this.captured=this.getPreviousState().getPieceAt(e.end).isPlayer()?fB.of(e.end):fB.empty()}}},{key:"cancelMoveAttempt",value:function(){this.selected=fB.empty(),this.targets=[]}},{key:"getSquareClasses",value:function(e,t){var n=new Zee(e,t);if(this.lastMove.isPresent()){var r=this.lastMove.get().coord,i=this.lastMove.get().end;if(this.captured.isPresent()&&n.equals(this.captured.get()))return["captured"];if(n.equals(r)||n.equals(i))return["moved"]}return[]}},{key:"getPieceClasses",value:function(e,t){var n=this.board[t][e],r=new Zee(e,t),i=[this.getPlayerClass(n)];return this.selected.isPresent()&&this.selected.get().equals(r)&&i.push("selected"),i}}]),n}(nne);return e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-linesofaction"]],features:[Rb],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"indicator",3,"click"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),Yb(1,yse,2,1,"g",1),Yb(2,mse,2,4,"g",1),tP()),2&e&&(pE(1),Xb("ngForOf",t.board),pE(1),Xb("ngForOf",t.targets))},directives:[LA,NA,UA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Cse=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{top:0,bottom:0,left:0,right:0};return Zg(this,n),(a=t.call(this,e.x,e.y)).direction=r,a.orientation=i,a.captures=o,a}return Wg(n,[{key:"toString",value:function(){return"LodestoneMove(".concat(this.coord.toString(),", ").concat(this.direction,", ").concat(this.orientation,", { top: ").concat(this.captures.top,", bottom: ").concat(this.captures.bottom,", left: ").concat(this.captures.left,", right: ").concat(this.captures.right," })")}},{key:"equals",value:function(e){return this===e||!(!1===this.coord.equals(e.coord)||this.orientation!==e.orientation||this.direction!==e.direction||this.captures.top!==e.captures.top||this.captures.bottom!==e.captures.bottom||this.captures.left!==e.captures.left||this.captures.right!==e.captures.right)}}]),n}(cte);Cse.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encodeMove",value:function(e){return{coord:Zee.encoder.encode(e.coord),direction:e.direction,orientation:e.orientation,captures:e.captures}}},{key:"decodeMove",value:function(e){var t=e;return v7(null!=t.coord,"Invalid encoded LodestoneMove"),v7(null!=t.direction,"Invalid encoded LodestoneMove"),v7(null!=t.orientation,"Invalid encoded LodestoneMove"),v7(null!=t.captures,"Invalid encoded LodestoneMove"),new Cse(Zee.encoder.decode(t.coord),t.direction,t.orientation,t.captures)}}]),n}(O7));var wse=function(){var e=Wg(function e(){Zg(this,e)});return e.MUST_FLIP_LODESTONE=function(){return $localize(io||(io=_g(["You must flip your lodestone before putting it back on the board."])))},e.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES=function(){return $localize(ao||(ao=_g(["As long as there are pressure plates, you must place all the pieces that you have captured on them."])))},e.TARGET_IS_CRUMBLED=function(){return $localize(oo||(oo=_g(["You must place your lodestone on a non-crumbled square!"])))},e.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE=function(){return $localize(so||(so=_g(["You placed too many captures on the same pressure plate, which has not enough space left."])))},e.MUST_PLACE_CAPTURES=function(){return $localize(uo||(uo=_g(["You must place your captures on the pressure plates, on the side of the board."])))},e.NO_CAPTURES_TO_PLACE_YET=function(){return $localize(co||(co=_g(["You cannot place any capture now, you must first place your lodestone on the board!"])))},e}(),_se=function(){function e(t){Zg(this,e),this.unreachable=t}return Wg(e,[{key:"isLodestone",value:function(){return!1}},{key:"isPlayerPiece",value:function(){return!1}},{key:"isEmpty",value:function(){return!0}},{key:"isUnreachable",value:function(){return this.unreachable}},{key:"equals",value:function(e){return this===e}}]),e}();_se.UNREACHABLE=new _se(!0),_se.EMPTY=new _se(!1);var Ese=function(){function e(t){Zg(this,e),this.owner=t}return Wg(e,[{key:"isLodestone",value:function(){return!1}},{key:"isPlayerPiece",value:function(){return!0}},{key:"isEmpty",value:function(){return!1}},{key:"isUnreachable",value:function(){return!1}},{key:"equals",value:function(e){return this===e}}],[{key:"of",value:function(t){return t===R7.ZERO?e.ZERO:e.ONE}}]),e}();Ese.ZERO=new Ese(R7.ZERO),Ese.ONE=new Ese(R7.ONE);var bse=function(){function e(t,n,r){Zg(this,e),this.owner=t,this.direction=n,this.orientation=r}return Wg(e,[{key:"isLodestone",value:function(){return!0}},{key:"isPlayerPiece",value:function(){return!1}},{key:"isEmpty",value:function(){return!1}},{key:"isUnreachable",value:function(){return!1}},{key:"equals",value:function(e){return this===e}}],[{key:"of",value:function(t,n){return e.LODESTONES[t.value][n.direction][n.orientation]}}]),e}();bse.LODESTONES={0:{push:{diagonal:new bse(R7.ZERO,"push","diagonal"),orthogonal:new bse(R7.ZERO,"push","orthogonal")},pull:{diagonal:new bse(R7.ZERO,"pull","diagonal"),orthogonal:new bse(R7.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new bse(R7.ONE,"push","diagonal"),orthogonal:new bse(R7.ONE,"push","orthogonal")},pull:{diagonal:new bse(R7.ONE,"pull","diagonal"),orthogonal:new bse(R7.ONE,"pull","orthogonal")}}};var Pse=function(){function e(t,n){Zg(this,e),this.width=t,this.pieces=n}return Wg(e,[{key:"remainingSpaces",value:function(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}},{key:"addCaptured",value:function(t,n){if(this.pieces.length+n>=this.width)return 5===this.width?e.EMPTY_3.addCaptured(t,n+this.pieces.length-5):(v7(this.pieces.length+n===3,"should never put more pieces than the plate can support"),fB.empty());for(var r=D7.copyImmutableArray(this.pieces),i=0;i<n;i++)r.push(Ese.of(t));return fB.of(new e(this.width,r))}},{key:"getPieceAt",value:function(e){return e<this.pieces.length?this.pieces[e]:_se.EMPTY}}]),e}();Pse.POSITIONS=["top","bottom","left","right"],Pse.EMPTY_5=new Pse(5,[]),Pse.EMPTY_3=new Pse(3,[]);var Sse=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,e,r)).lodestones=i,o.pressurePlates=a,o}return Wg(n,[{key:"withBoard",value:function(e){return new n(e,this.turn,this.lodestones,this.pressurePlates)}},{key:"remainingSpaces",value:function(){var e=this.remainingSpacesDetails();return e.top+e.bottom+e.left+e.right}},{key:"remainingSpacesDetails",value:function(){var e,t={top:0,bottom:0,left:0,right:0},n=Hg(Pse.POSITIONS);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.pressurePlates[r];i.isPresent()&&(t[r]=i.get().remainingSpaces())}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"numberOfPieces",value:function(){for(var e=[0,0],t=0;t<n.SIZE;t++)for(var r=0;r<n.SIZE;r++){var i=this.getPieceAtXY(r,t);i.isPlayerPiece()&&(e[i.owner.value]+=1)}return e}},{key:"getScores",value:function(){var e=this.numberOfPieces();return[24-e[1],24-e[0]]}},{key:"nextLodestoneDirection",value:function(){var e=this.getCurrentPlayer(),t=this.lodestones.get(e);if(!t.isPresent())return fB.empty();var n=this.getPieceAt(t.get());switch(v7(n.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+t.get()),n.direction){case"push":return fB.of("pull");case"pull":return fB.of("push")}}}],[{key:"getInitialState",value:function(){var e=_se.EMPTY,t=Ese.ZERO,r=Ese.ONE;return new n([[e,e,t,r,t,r,e,e],[e,t,r,t,r,t,r,e],[t,r,t,r,t,r,t,r],[r,t,r,e,e,t,r,t],[t,r,t,e,e,r,t,r],[r,t,r,t,r,t,r,t],[e,r,t,r,t,r,t,e],[e,e,r,t,r,t,e,e]],0,new hte,{top:fB.of(Pse.EMPTY_5),bottom:fB.of(Pse.EMPTY_5),left:fB.of(Pse.EMPTY_5),right:fB.of(Pse.EMPTY_5)})}}]),n}(ote);return e.SIZE=8,e}(),Ose=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.call(this,Sse)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCurrentPlayer(),i=r.getOpponent(),a=D7.copyBiArray(n.board),o=t.lodestones.getCopy();o.put(r,e.coord);var s=bg({},t.pressurePlates);return this.updatePressurePlates(a,s,o,i,e.captures),new Sse(a,t.turn+1,o,s)}},{key:"updatePressurePlates",value:function(e,t,n,r,i){var a,o=Hg(Pse.POSITIONS);try{for(o.s();!(a=o.n()).done;){var s=a.value;t[s]=this.updatePressurePlate(e,s,t[s],n,r,i[s])}}catch(u){o.e(u)}finally{o.f()}}},{key:"updatePressurePlate",value:function(e,t,r,i,a,o){if(r.isPresent()){var s=r.get().addCaptured(a,o),u=n.THREATENED_COORD_RANGE.get(t).get();return s.isAbsent()?(this.removePressurePlate(e,u.startForBigPlate,u.direction,i),this.removePressurePlate(e,u.startForSmallPlate,u.direction,i)):s.get().width<r.get().width&&this.removePressurePlate(e,u.startForBigPlate,u.direction,i),s}return r}},{key:"removePressurePlate",value:function(e,t,n,r){for(var i=t;i.isInRange(Sse.SIZE,Sse.SIZE);i=i.getNext(n)){var a,o=Hg(R7.PLAYERS);try{for(o.s();!(a=o.n()).done;){var s=a.value;r.get(s).equalsValue(i)&&r.delete(s)}}catch(u){o.e(u)}finally{o.f()}e[i.y][i.x]=_se.UNREACHABLE}}},{key:"isLegal",value:function(e,t){var n=this.isLegalWithoutCaptures(t,e.coord,e.direction);if(n.isFailure())return hB.failure(n.getReason());var r=this.applyMoveWithoutPlacingCaptures(t,e.coord,e);if(e.captures.top+e.captures.bottom+e.captures.left+e.captures.right!==Math.min(r.captures.length,t.remainingSpaces()))return hB.failure(wse.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());var i,a=Hg(Pse.POSITIONS);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=t.pressurePlates[o];if(s.isPresent()&&s.get().remainingSpaces()<e.captures[o])return hB.failure(wse.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}}catch(u){a.e(u)}finally{a.f()}return hB.success(r)}},{key:"applyMoveWithoutPlacingCaptures",value:function(e,t,n){var r,i=D7.copyBiArray(e.board),a=e.lodestones.get(e.getCurrentPlayer());if(a.isPresent()){var o=a.get();i[o.y][o.x]=_se.EMPTY}return(r="pull"===n.direction?this.applyPull(e,i,t,n.orientation):this.applyPush(e,i,t,n.orientation)).board[t.y][t.x]=bse.of(e.getCurrentPlayer(),n),r.moved.push(t),r}},{key:"applyPull",value:function(e,t,n,r){var i,a=e.getCurrentPlayer(),o=a.getOpponent(),s=[],u=[],c=Hg("diagonal"===r?Hee.DIAGONALS:Hee.ORTHOGONALS);try{for(c.s();!(i=c.n()).done;)for(var l=i.value,f=n.getNext(l);e.isOnBoard(f);f=f.getNext(l)){var h=t[f.y][f.x],d=f.getNext(l);if(e.isOnBoard(d)){var v=t[d.y][d.x];v.isPlayerPiece()&&v.owner===a&&(h.isEmpty()?(u.push(f),t[f.y][f.x]=v,u.push(d),t[d.y][d.x]=_se.EMPTY):h.isPlayerPiece()&&h.owner===o&&(s.push(f),t[f.y][f.x]=v,u.push(d),t[d.y][d.x]=_se.EMPTY))}}}catch(p){c.e(p)}finally{c.f()}return{board:t,captures:s,moved:u}}},{key:"applyPush",value:function(e,t,n,r){var i,a=e.getCurrentPlayer().getOpponent(),o=[],s=[],u=Hg("diagonal"===r?Hee.DIAGONALS:Hee.ORTHOGONALS);try{for(u.s();!(i=u.n()).done;)for(var c=i.value,l=n.getNext(c,Sse.SIZE);!1===l.equals(n);l=l.getPrevious(c))if(e.isOnBoard(l)){var f=t[l.y][l.x];if(f.isPlayerPiece()&&f.owner===a){var h=l.getNext(c);if(e.isOnBoard(h)){var d=t[h.y][h.x];d.isUnreachable()?(o.push(l),t[l.y][l.x]=_se.EMPTY):d.isEmpty()&&(s.push(h),t[h.y][h.x]=f,s.push(l),t[l.y][l.x]=_se.EMPTY)}else o.push(l),t[l.y][l.x]=_se.EMPTY}}}catch(v){u.e(v)}finally{u.f()}return{board:t,captures:o,moved:s}}},{key:"isLegalWithoutCaptures",value:function(e,t,n){var r=this.isTargetLegal(e,t);if(r.isFailure())return r;var i=e.nextLodestoneDirection();return!1===(i.isAbsent()||i.equalsValue(n))?pB.failure(wse.MUST_FLIP_LODESTONE()):pB.SUCCESS}},{key:"isTargetLegal",value:function(e,t){var n=e.getPieceAt(t);if(n.isUnreachable())return pB.failure(wse.TARGET_IS_CRUMBLED());if(n.isPlayerPiece())return pB.failure(ete.MUST_CLICK_ON_EMPTY_SQUARE());var r=e.getCurrentPlayer();return n.isLodestone()&&n.owner!==r?pB.failure(ete.MUST_CLICK_ON_EMPTY_SQUARE()):pB.SUCCESS}},{key:"getGameStatus",value:function(e){var t=e.gameState.numberOfPieces();return 0===t[0]&&0===t[1]?gte.DRAW:0===t[0]?gte.ONE_WON:0===t[1]?gte.ZERO_WON:gte.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=fB.of(new n)),n.singleton.get()}}]),n}(yte);Ose.THREATENED_COORD_RANGE=hte.from({top:{startForBigPlate:new Zee(0,0),startForSmallPlate:new Zee(0,1),direction:Hee.RIGHT},bottom:{startForBigPlate:new Zee(0,Sse.SIZE-1),startForSmallPlate:new Zee(0,Sse.SIZE-2),direction:Hee.RIGHT},left:{startForBigPlate:new Zee(0,0),startForSmallPlate:new Zee(1,0),direction:Hee.DOWN},right:{startForBigPlate:new Zee(Sse.SIZE-1,0),startForSmallPlate:new Zee(Sse.SIZE-2,0),direction:Hee.DOWN}}),Ose.singleton=fB.empty();var Tse=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=this,n=e.gameState;return this.flatMapEmptyCoords(n,function(e){var r,i=[],a=Hg(t.nextDirection(n));try{for(a.s();!(r=a.n()).done;)for(var o=r.value,s=0,u=["diagonal","orthogonal"];s<u.length;s++){var c,l=u[s],f=Ose.get().applyMoveWithoutPlacingCaptures(n,e,{direction:o,orientation:l}).captures.length,h=Hg(t.captureCombinations(n,f));try{for(h.s();!(c=h.n()).done;){var d=c.value;i.push(new Cse(e,o,l,d))}}catch(v){h.e(v)}finally{h.f()}}}catch(v){a.e(v)}finally{a.f()}return i})}},{key:"captureCombinations",value:function(e,t){if(0===t)return new ite([{top:0,bottom:0,left:0,right:0}]);var n,r=new ite,i=e.remainingSpacesDetails(),a=this.captureCombinations(e,t-1),o=Hg(a);try{for(o.s();!(n=o.n()).done;){var s=n.value;s.top+1<=i.top&&r.add(bg(bg({},s),{},{top:s.top+1})),s.bottom+1<=i.bottom&&r.add(bg(bg({},s),{},{bottom:s.bottom+1})),s.left+1<=i.left&&r.add(bg(bg({},s),{},{left:s.left+1})),s.right+1<=i.right&&r.add(bg(bg({},s),{},{right:s.right+1}))}}catch(u){o.e(u)}finally{o.f()}return 0===r.size()?a:r}},{key:"flatMapEmptyCoords",value:function(e,t){for(var n=[],r=0;r<Sse.SIZE;r++)for(var i=0;i<Sse.SIZE;i++){var a=new Zee(i,r),o=e.getPieceAt(a);(o.isEmpty()&&!1===o.isUnreachable()||o.isLodestone()&&o.owner===e.getCurrentPlayer())&&(n=n.concat(t(a)))}return n}},{key:"nextDirection",value:function(e){var t=e.nextLodestoneDirection();return t.isPresent()?[t.get()]:["push","pull"]}},{key:"getBoardValue",value:function(e){var t,n=e.gameState.getScores();return t=24===n[0]&&24!==n[1]?R7.ZERO.getVictoryValue():24!==n[0]&&24===n[1]?R7.ONE.getVictoryValue():n[0]*R7.ZERO.getScoreModifier()+n[1]*R7.ONE.getScoreModifier(),new nte(t)}}]),n}(tte),Ise=_se.UNREACHABLE,Ase=_se.EMPTY,Rse=Ese.ZERO,Mse=Ese.ONE,xse=bse.of(R7.ONE,{direction:"push",orientation:"orthogonal"}),Nse={top:fB.of(Pse.EMPTY_5),bottom:fB.of(Pse.EMPTY_5),left:fB.of(Pse.EMPTY_5),right:fB.of(Pse.EMPTY_5)},Dse=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(lo||(lo=_g(["Board and aim of the game"]))),$localize(fo||(fo=_g(["Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone."]))),Sse.getInitialState()),wte.forClick($localize(ho||(ho=_g(["Selecting a lodestone"]))),$localize(vo||(vo=_g(["To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally."]))),Sse.getInitialState(),["#lodestone_push_diagonal"],$localize(po||(po=_g(["Congratulations!"]))),$localize(go||(go=_g(["This is not the right lodestone, try again."])))),wte.informational($localize(yo||(yo=_g(["The repelling lodestone"]))),$localize(mo||(mo=_g(["Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured."]))),Sse.getInitialState()),wte.informational($localize(ko||(ko=_g(["The attracting lodestone"]))),$localize(Co||(Co=_g(["When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it."]))),Sse.getInitialState()),wte.informational($localize(wo||(wo=_g(["Flipping the lodestone"]))),$localize(_o||(_o=_g(["Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn."]))),Sse.getInitialState()),wte.fromPredicate($localize(Eo||(Eo=_g(["Capturing"]))),$localize(bo||(bo=_g(["To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates."]))),Sse.getInitialState(),new Cse(new Zee(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),function(e,t,n){return 32===n.remainingSpaces()?pB.failure($localize(Po||(Po=_g(["You have not captured any of the opponent's pieces, try again!"])))):pB.SUCCESS},"Congratulations!"),wte.fromPredicate($localize(So||(So=_g(["Crumbling a first pressure plate"]))),$localize(Oo||(Oo=_g(["When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble."]))),new Sse([[Ase,Ase,Ase,Ase,Mse,Ase,Ase,Ase],[Ase,Ase,Rse,Ase,Ase,Mse,Ase,Ase],[Ase,Ase,xse,Ase,Ase,Ase,Ase,Rse],[Ase,Ase,Ase,Ase,Mse,Ase,Ase,Rse],[Ase,Ase,Ase,Ase,Ase,Rse,Ase,Ase],[Ase,Ase,Ase,Ase,Ase,Ase,Ase,Ase],[Ase,Ase,Ase,Ase,Ase,Ase,Ase,Ase],[Ase,Ase,Ase,Ase,Ase,Ase,Ase,Ase]],0,new hte([{key:R7.ONE,value:new Zee(2,2)}]),bg(bg({},Nse),{},{top:Pse.EMPTY_5.addCaptured(R7.ONE,4)})),new Cse(new Zee(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),function(e,t,n){return 5===n.pressurePlates.top.get().width?pB.failure($localize(To||(To=_g(["You must capture and place your capture on the top pressure plate to make it crumble!"])))):pB.SUCCESS},"Congratulations!"),wte.fromPredicate($localize(Io||(Io=_g(["Crumbling a second pressure plate"]))),$localize(Ao||(Ao=_g(["Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble."]))),new Sse([[Ise,Ise,Ise,Ise,Ise,Ise,Ise,Ise],[Ase,Ase,Ase,Ase,Ase,Ase,Ase,Ase],[Ase,Ase,Ase,Ase,Ase,Ase,Ase,Rse],[Ase,Ase,Ase,Ase,Ase,Rse,Ase,Rse],[Ase,xse,Ase,Ase,Mse,Ase,Ase,Ase],[Ase,Ase,Ase,Ase,Ase,Ase,Ase,Ase],[Ase,Ase,Ase,Ase,Mse,Ase,Ase,Ase],[Ase,Ase,Ase,Ase,Ase,Ase,Ase,Ase]],0,new hte([{key:R7.ONE,value:new Zee(1,4)}]),bg(bg({},Nse),{},{top:Pse.EMPTY_3.addCaptured(R7.ONE,2)})),new Cse(new Zee(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),function(e,t,n){return n.pressurePlates.top.isPresent()?pB.failure($localize(Ro||(Ro=_g(["You must capture and place your capture on the top pressure plate to make it crumble a second time!"])))):pB.SUCCESS},"Congratulations!"),wte.informational($localize(Mo||(Mo=_g(["Minimal board"]))),$localize(xo||(xo=_g(["After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board."]))),new Sse([[Ise,Ise,Ise,Ise,Ise,Ise,Ise,Ise],[Ise,Ise,Ise,Ise,Ise,Ise,Ise,Ise],[Ise,Ise,Rse,Mse,Ase,Ase,Ise,Ise],[Ise,Ise,xse,Mse,Ase,Ase,Ise,Ise],[Ise,Ise,Ase,Rse,Rse,Ase,Ise,Ise],[Ise,Ise,Rse,Ase,Ase,Ase,Ise,Ise],[Ise,Ise,Ise,Ise,Ise,Ise,Ise,Ise],[Ise,Ise,Ise,Ise,Ise,Ise,Ise,Ise]],0,new hte([{key:R7.ONE,value:new Zee(2,3)}]),{top:fB.empty(),bottom:fB.empty(),left:fB.empty(),right:fB.empty()})),wte.fromMove($localize(No||(No=_g(["Making the lodestone fall"]))),$localize(Do||(Do=_g(["If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!"]))),new Sse([[Ase,Ase,Ase,Ase,Ase,Ase,Ase,Ase],[Ase,Ase,Ase,Ase,Ase,Mse,Ase,Ase],[Ase,Ase,Ase,xse,Ase,Ase,Rse,Ase],[Ase,Ase,Rse,Rse,Mse,Ase,Ase,Rse],[Ase,Ase,Ase,Ase,Ase,Rse,Ase,Ase],[Ase,Ase,Rse,Ase,Ase,Ase,Ase,Ase],[Ase,Ase,Mse,Ase,Ase,Ase,Ase,Ase],[Ase,Ase,Ase,Ase,Ase,Ase,Ase,Ase]],0,new hte([{key:R7.ONE,value:new Zee(3,2)}]),bg(bg({},Nse),{},{top:Pse.EMPTY_5.addCaptured(R7.ONE,4)})),[new Cse(new Zee(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize(Lo||(Lo=_g(["Congratulations! At your next turn, you will be allowed to place your lodestone on any side."]))),$localize(Fo||(Fo=_g(["Failed, try again."])))),wte.fromMove($localize(Uo||(Uo=_g(["End of the game"]))),$localize(Vo||(Vo=_g(["In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!"]))),new Sse([[Ise,Ise,Ise,Ise,Ise,Ise,Ise,Ise],[Ise,Ise,Ise,Ise,Ise,Ise,Ise,Ise],[Ise,Mse,Rse,Mse,Ase,Ase,Ise,Ise],[Ise,Mse,xse,Ase,Mse,Ase,Ise,Ise],[Ise,Ase,Ase,Rse,Rse,Ase,Ise,Ise],[Ise,Mse,Rse,Ase,Mse,Ase,Ise,Ise],[Ise,Ase,Ase,Ase,Rse,Ase,Ise,Ise],[Ise,Ise,Ise,Ise,Ise,Ise,Ise,Ise]],0,new hte([{key:R7.ONE,value:new Zee(2,3)}]),{top:fB.empty(),bottom:Pse.EMPTY_3.addCaptured(R7.ZERO,2),left:fB.of(Pse.EMPTY_3),right:fB.empty()}),[new Cse(new Zee(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize(Bo||(Bo=_g(["Congratulations, you won!"]))),$localize(zo||(zo=_g(["This is not the winning move. Try again."]))))]});function Lse(e,t){if(1&e&&(cC(),nP(0,"circle",10)),2&e){var n=fP(2),r=n.index,i=n.$implicit,a=fP().index,o=fP();vP("id","piece_",r,"_",a,""),Xb("ngClass",i.pieceClasses),$b("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Fse(e,t){if(1&e&&(cC(),nP(0,"polygon",15)),2&e){var n=fP().$implicit,r=fP(3).$implicit,i=fP(2);jb("transform","rotate(",90*n,")"),Xb("ngClass",r.lodestone.movingClass),$b("points",i.TRIANGLE_OUT)}}function Use(e,t){if(1&e&&(cC(),nP(0,"polygon",15)),2&e){var n=fP().$implicit,r=fP(3).$implicit,i=fP(2);jb("transform","rotate(",90*n,")"),Xb("ngClass",r.lodestone.movingClass),$b("points",i.TRIANGLE_IN)}}function Vse(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Fse,1,3,"polygon",14),Yb(2,Use,1,3,"polygon",14),tP()),2&e){var n=fP(3).$implicit;pE(1),Xb("ngIf","push"===n.lodestone.direction),pE(1),Xb("ngIf","pull"===n.lodestone.direction)}}var Bse=function(){return[0,1,2,3]};function zse(e,t){if(1&e&&(cC(),eP(0,"g",11),nP(1,"circle",12),nP(2,"circle",13),eP(3,"g"),Yb(4,Vse,3,2,"g",1),tP(),tP()),2&e){var n=fP(2),r=n.index,i=n.$implicit,a=fP().index,o=fP();$b("transform",o.getSquareTransform(r,a)),pE(1),Xb("ngClass",i.lodestone.selectedClass),$b("r",o.PIECE_RADIUS),pE(1),Xb("ngClass",i.lodestone.pieceClasses),$b("r",o.PIECE_RADIUS/4),pE(1),jb("transform","rotate(","diagonal"===i.lodestone.orientation?45:0,")"),pE(1),Xb("ngForOf",aT(7,Bse))}}function Hse(e,t){if(1&e){var n=aP();cC(),eP(0,"g",6),uP("click",function(){Nk(n);var e=fP().$implicit;return fP(2).selectCoord(e.coord)}),nP(1,"rect",7),Yb(2,Lse,1,6,"circle",8),Yb(3,zse,5,8,"g",9),tP()}if(2&e){var r=fP(),i=r.index,a=r.$implicit,o=fP().index,s=fP();vP("id","square_",i,"_",o,""),pE(1),Xb("ngClass",a.squareClasses),$b("x",s.SPACE_SIZE*i+s.STROKE_WIDTH)("y",s.SPACE_SIZE*o+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),pE(1),Xb("ngIf",a.hasPiece),pE(1),Xb("ngIf",a.lodestone)}}function Gse(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Hse,4,9,"g",5),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngIf",!1===n.crumbled)}}function $se(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Gse,2,1,"g",1),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}function Zse(e,t){if(1&e&&(cC(),eP(0,"g",16),nP(1,"circle",17),tP()),2&e){var n=t.$implicit,r=t.index,i=fP();dP("id","capture_",r,""),$b("transform",i.getCaptureTransform(r)),pE(1),Xb("ngClass",n.pieceClasses),$b("r",i.PIECE_RADIUS)}}function qse(e,t){if(1&e&&(cC(),eP(0,"g"),nP(1,"polygon",15),tP()),2&e){var n=t.$implicit,r=fP().$implicit,i=fP();pE(1),jb("transform","rotate(",90*n,")"),Xb("ngClass",r.movingClass),$b("points","push"===r.direction?i.TRIANGLE_OUT:i.TRIANGLE_IN)}}function Wse(e,t){if(1&e){var n=aP();cC(),eP(0,"g",6),uP("click",function(){var e=Nk(n).$implicit;return fP().selectLodestone(e)}),nP(1,"circle",12),nP(2,"circle",13),eP(3,"g"),Yb(4,qse,2,3,"g",1),tP(),tP()}if(2&e){var r=t.$implicit,i=t.index,a=fP();vP("id","lodestone_",r.direction,"_",r.orientation,""),$b("transform",a.getAvailableLodestoneTransform(i)),pE(1),Xb("ngClass",r.selectedClass),$b("r",a.PIECE_RADIUS),pE(1),Xb("ngClass",r.pieceClasses),$b("r",a.PIECE_RADIUS/4),pE(1),jb("transform","rotate(","diagonal"===r.orientation?45:0,")"),pE(1),Xb("ngForOf",aT(9,Bse))}}function jse(e,t){if(1&e&&(cC(),nP(0,"circle",10)),2&e){var n=fP(),r=n.index,i=n.$implicit,a=fP().$implicit,o=fP();vP("id","platePiece_",a.position,"_",r,""),Xb("ngClass",i.pieceClasses),$b("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*i.coord.x+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i.coord.y+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Yse(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"g",6),uP("click",function(){var e=Nk(n),t=e.$implicit,r=e.index,i=fP().$implicit;return fP().onPressurePlateClick(t.temporary,i.position,r)}),nP(2,"rect",18),Yb(3,jse,1,6,"circle",8),tP(),tP()}if(2&e){var r=t.$implicit,i=t.index,a=fP().$implicit,o=fP();$b("transform",o.getPressurePlateTransform(a.position)),pE(1),vP("id","plate_",a.position,"_",i,""),pE(1),vP("id","plateSquare_",a.position,"_",i,""),Xb("ngClass",r.squareClasses),$b("x",o.SPACE_SIZE*r.coord.x+o.STROKE_WIDTH)("y",o.SPACE_SIZE*r.coord.y+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),pE(1),Xb("ngIf",r.hasPiece)}}function Kse(e,t){if(1&e&&(cC(),eP(0,"g",16),Yb(1,Yse,4,11,"g",1),tP()),2&e){var n=t.$implicit;dP("id","pressurePlate_",n.position,""),pE(1),Xb("ngForOf",n.coords)}}function Qse(e,t){if(1&e&&(cC(),nP(0,"rect",19)),2&e){var n=fP();vP("id","selection_",n.viewInfo.selected.get().x,"_",n.viewInfo.selected.get().y,""),$b("x",n.SPACE_SIZE*n.viewInfo.selected.get().x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*n.viewInfo.selected.get().y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}var Xse=function(e){xg(n,e);var t=Dg(n);function n(e){var r;Zg(this,n),(r=t.call(this,e)).viewInfo={availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:fB.empty(),pressurePlateShift:{top:new Vee(0,0),left:new Vee(0,0),right:new Vee(0,0),bottom:new Vee(0,0)}},r.stateAfterPlacingLodestone=fB.empty(),r.lastInfos=fB.empty(),r.capturesToPlace=0,r.selectedCoord=fB.empty(),r.selectedLodestone=fB.empty(),r.captures={top:0,bottom:0,left:0,right:0},r.rules=Ose.get(),r.tutorial=(new Dse).tutorial,r.availableMinimaxes=[new Tse(r.rules,"LodestoneDummyMinimax")],r.encoder=Cse.encoder,r.PIECE_RADIUS=.5*(r.SPACE_SIZE-2*r.STROKE_WIDTH);var i=.8*r.PIECE_RADIUS,a=.3*r.PIECE_RADIUS,o=.2*r.PIECE_RADIUS;return r.TRIANGLE_OUT="".concat(i,",0 ").concat(a,",").concat(o," ").concat(a,",-").concat(o),r.TRIANGLE_IN="".concat(a,",0 ").concat(i,",").concat(a," ").concat(i,",-").concat(a),r.displayedState=r.rules.node.gameState,r.scores=fB.of([0,0]),r}return Wg(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"selectCoord",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#square_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!(t.capturesToPlace>0)){n.next=5;break}return n.abrupt("return",t.cancelMove(wse.MUST_PLACE_CAPTURES()));case 5:return i=Ose.get().isTargetLegal(t.getState(),e),n.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):t.selectedLodestone.isPresent()?(t.selectedCoord=fB.of(e),t.putLodestone()):(t.selectedCoord=fB.of(e),t.updateViewInfo(),pB.SUCCESS));case 7:case"end":return n.stop()}},n)}))()}},{key:"selectLodestone",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#lodestone_"+e.direction+"_"+e.orientation)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return v7(0===t.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed"),i=t.getCurrentPlayer(),n.abrupt("return",(t.selectedLodestone=fB.of(bse.of(i,e)),t.selectedCoord.isPresent()?t.putLodestone():(t.updateViewInfo(),pB.SUCCESS)));case 6:case"end":return n.stop()}},n)}))()}},{key:"putLodestone",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return v7(e.selectedCoord.isPresent(),"coord should have been selected"),v7(e.selectedLodestone.isPresent(),"lodestone should have been selected"),n=e.selectedCoord.get(),r=e.selectedLodestone.get(),i=e.getState(),v7(Ose.get().isLegalWithoutCaptures(i,n,r.direction).isSuccess(),"Lodestone component should only allow creation of legal moves"),a=Ose.get().applyMoveWithoutPlacingCaptures(i,n,r),t.abrupt("return",(e.lastInfos=fB.of(a),e.capturesToPlace=Math.min(a.captures.length,i.remainingSpaces()),0===e.capturesToPlace?e.applyMove():(e.displayedState=e.displayedState.withBoard(a.board),e.stateAfterPlacingLodestone=fB.of(e.displayedState),e.updateViewInfo(),pB.SUCCESS)));case 5:case"end":return t.stop()}},t)}))()}},{key:"applyMove",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return v7(e.selectedCoord.isPresent(),"coord should have been selected"),v7(e.selectedLodestone.isPresent(),"lodestone should have been selected"),n=e.selectedCoord.get(),r=e.selectedLodestone.get(),i=new Cse(n,r.direction,r.orientation,e.captures),t.abrupt("return",e.chooseMove(i,e.getState()));case 3:case"end":return t.stop()}},t)}))()}},{key:"onPressurePlateClick",value:function(e,t,n){return e?this.deselectPressurePlate(t,n):this.selectPressurePlate(t,n)}},{key:"selectPressurePlate",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#plate_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(0!==n.capturesToPlace){r.next=5;break}return r.abrupt("return",n.cancelMove(wse.NO_CAPTURES_TO_PLACE_YET()));case 5:return n.capturesToPlace--,n.captures[e]++,a=n.stateAfterPlacingLodestone.get(),o=n.getCurrentPlayer().getOpponent(),s=D7.copyBiArray(a.board),u=bg({},a.pressurePlates),c=a.lodestones.getCopy(),r.abrupt("return",(Ose.get().updatePressurePlates(s,u,c,o,n.captures),n.displayedState=new Sse(s,a.turn,c,u),0===n.capturesToPlace?n.applyMove():(n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),pB.SUCCESS)));case 8:case"end":return r.stop()}},r)}))()}},{key:"deselectPressurePlate",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#plate_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return n.capturesToPlace++,n.captures[e]--,a=n.stateAfterPlacingLodestone.get(),o=n.getCurrentPlayer().getOpponent(),s=D7.copyBiArray(a.board),u=bg({},a.pressurePlates),c=a.lodestones.getCopy(),r.abrupt("return",(Ose.get().updatePressurePlates(s,u,c,o,n.captures),n.displayedState=new Sse(s,a.turn,c,u),n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),pB.SUCCESS));case 6:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.rules.node.move.isPresent()&&this.showLastMove(),this.scores=fB.of(this.getState().getScores())}},{key:"cancelMoveAttempt",value:function(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=fB.empty(),this.lastInfos=fB.empty();var e=this.displayedState.lodestones.get(this.getCurrentPlayer());if(e.isPresent()){var t=D7.copyBiArray(this.displayedState.board);t[e.get().y][e.get().x]=_se.EMPTY,this.displayedState=this.displayedState.withBoard(t)}this.selectedCoord=fB.empty(),this.selectedLodestone=fB.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}},{key:"updateViewInfo",value:function(){var e=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(e),this.viewInfo.opponentClass=this.getPlayerClass(e.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}},{key:"showBoard",value:function(){this.viewInfo.boardInfo=[];for(var e=0;e<Sse.SIZE;e++){this.viewInfo.boardInfo.push([]);for(var t=0;t<Sse.SIZE;t++){var n=new Zee(t,e);this.viewInfo.boardInfo[e].push(this.getSquareInfo(n))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:fB.empty()}},{key:"getSquareInfo",value:function(e){var t=this.displayedState.getPieceAt(e),n={coord:e,squareClasses:[],crumbled:t.isUnreachable(),hasPiece:t.isPlayerPiece(),pieceClasses:[]};return t.isPlayerPiece()&&(n.pieceClasses=[this.getPlayerClass(t.owner)]),t.isLodestone()&&(n.lodestone={direction:t.direction,pieceClasses:[this.getPlayerClass(t.owner)],selectedClass:"",movingClass:"",orientation:t.orientation},n.lodestone.movingClass=this.getPlayerClass("push"===t.direction?t.owner.getOpponent():t.owner)),n}},{key:"showAvailableLodestones",value:function(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{var e=this.getState().getCurrentPlayer(),t=this.getState().nextLodestoneDirection();if(t.isPresent()){var n=t.get();this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:n,orientation:"orthogonal"}),this.nextLodestone(e,{direction:n,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"push",orientation:"diagonal"}),this.nextLodestone(e,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"pull",orientation:"diagonal"})]}}},{key:"showCapturesToPlace",value:function(){var e=this.getCurrentPlayer().getOpponent();this.viewInfo.capturesToPlace=[];for(var t=0;t<this.capturesToPlace;t++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(e)]})}},{key:"nextLodestone",value:function(e,t){var n=bse.of(e,t),r={direction:n.direction,orientation:n.orientation,pieceClasses:[this.getPlayerClass(n.owner)],movingClass:"",selectedClass:""};return r.movingClass=this.getPlayerClass("push"===n.direction?n.owner.getOpponent():n.owner),this.selectedLodestone.equalsValue(n)&&(r.selectedClass="selected"),r}},{key:"showPressurePlates",value:function(){this.viewInfo.pressurePlates=[];var e,t=Hg(Pse.POSITIONS);try{for(t.s();!(e=t.n()).done;){var r=e.value,i=[],a=this.displayedState.pressurePlates[r];if(a.isPresent())for(var o=n.PRESSURE_PLATES_POSITIONS.get(r).get(),s=a.get().width,u=5===s?o.startForBigPlate:o.startForSmallPlate,c=0;c<s;c++){u=u.getNext(o.direction);var l=a.get().getPieceAt(c),f="";l.isPlayerPiece()&&(f=this.getPlayerClass(l.owner)),i.push({coord:u,hasPiece:l.isPlayerPiece(),pieceClasses:[f],squareClasses:[],temporary:!1})}this.viewInfo.pressurePlates.push({position:r,coords:i})}}catch(h){t.e(h)}finally{t.f()}}},{key:"showLastMove",value:function(){var e=this.rules.node.mother.get().gameState,t=this.rules.node.move.get();this.lastInfos=fB.of(Ose.get().applyMoveWithoutPlacingCaptures(e,t.coord,t)),this.updateViewInfo();var n=this.getState();this.showPressurePlateDifferences(e,n,!1)}},{key:"showPressurePlateDifferences",value:function(e,t,n){var r,i=Hg(Pse.POSITIONS);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.showPressurePlateDifference(e.pressurePlates[a],t.pressurePlates[a],a,n)}}catch(o){i.e(o)}finally{i.f()}}},{key:"showPressurePlateDifference",value:function(e,t,n,r){if(e.isPresent()&&t.isPresent()){var i=e.get(),a=t.get(),o=oB.getNonNullable(this.viewInfo.pressurePlates.find(function(e){return e.position===n}));if(i.width===a.width)for(var s=0;s<a.width;s++){var u=i.getPieceAt(s),c=a.getPieceAt(s);!1===u.equals(c)&&(o.coords[s].squareClasses.push("moved"),o.coords[s].temporary=r,r&&o.coords[s].pieceClasses.push("semi-transparent"))}else{var l,f=Hg(o.coords);try{for(f.s();!(l=f.n()).done;){l.value.squareClasses.push("moved")}}catch(h){f.e(h)}finally{f.f()}}}}},{key:"showMovedAndCaptured",value:function(e){var t,n=Hg(e.moved);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved")}}catch(s){n.e(s)}finally{n.f()}var i,a=Hg(e.captures);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.viewInfo.boardInfo[o.y][o.x].squareClasses.push("captured")}}catch(s){a.e(s)}finally{a.f()}}},{key:"computePressurePlateShift",value:function(){var e=this.displayedState,t=this.getPressurePlateShift(e.pressurePlates.left),n=this.getPressurePlateShift(e.pressurePlates.right),r=this.getPressurePlateShift(e.pressurePlates.top),i=this.getPressurePlateShift(e.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new Zee(.5*(t-n),0),this.viewInfo.pressurePlateShift.bottom=new Zee(.5*(t-n),0),this.viewInfo.pressurePlateShift.left=new Zee(0,.5*(r-i)),this.viewInfo.pressurePlateShift.right=new Zee(0,.5*(r-i))}},{key:"getPressurePlateShift",value:function(e){return e.isAbsent()?2:3===e.get().width?1:0}},{key:"getSquareTransform",value:function(e,t){return"translate(".concat(e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,", ").concat(t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getCaptureTransform",value:function(e){return"translate(".concat((e+(Sse.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE,", ").concat(-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getAvailableLodestoneTransform",value:function(e){return"translate(".concat((e+(Sse.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE,", ").concat(30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getPressurePlateTransform",value:function(e){return"translate(".concat(this.viewInfo.pressurePlateShift[e].x*this.SPACE_SIZE,", ").concat(this.viewInfo.pressurePlateShift[e].y*this.SPACE_SIZE,")")}}]),n}(qee);Xse.PRESSURE_PLATE_EXTRA_SHIFT=.2,Xse.PRESSURE_PLATES_POSITIONS=hte.from({top:{startForBigPlate:new Zee(.5,-1-Xse.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new Zee(1.5,0-Xse.PRESSURE_PLATE_EXTRA_SHIFT),direction:Hee.RIGHT},bottom:{startForBigPlate:new Zee(.5,8+Xse.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new Zee(1.5,7+Xse.PRESSURE_PLATE_EXTRA_SHIFT),direction:Hee.RIGHT},left:{startForBigPlate:new Zee(-1-Xse.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new Zee(0-Xse.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Hee.DOWN},right:{startForBigPlate:new Zee(8+Xse.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new Zee(7+Xse.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Hee.DOWN}}),Xse.\u0275fac=function(e){return new(e||Xse)(Qb(h7))},Xse.\u0275cmp=Gm({type:Xse,selectors:[["app-lodestone"]],features:[Rb],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected",3,"id"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),Yb(1,$se,2,1,"g",1),Yb(2,Zse,2,4,"g",2),Yb(3,Wse,5,10,"g",3),Yb(4,Kse,2,2,"g",2),Yb(5,Qse,1,6,"rect",4),tP()),2&e&&(pE(1),Xb("ngForOf",t.viewInfo.boardInfo),pE(1),Xb("ngForOf",t.viewInfo.capturesToPlace),pE(1),Xb("ngForOf",t.viewInfo.availableLodestones),pE(1),Xb("ngForOf",t.viewInfo.pressurePlates),pE(1),Xb("ngIf",t.viewInfo.selected.isPresent()))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Jse=function(){var e=Wg(function e(){Zg(this,e)});return e.START_COORD_OUT_OF_RANGE=function(){return $localize(Ho||(Ho=_g(["Start coord cannot be out of range"])))},e.END_COORD_OUT_OF_RANGE=function(){return $localize(Go||(Go=_g(["End coord cannot be out of range"])))},e.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP=function(){return $localize($o||($o=_g(["Pawns must move one step diagonally."])))},e.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS=function(){return $localize(Zo||(Zo=_g(["Drones must move one or two steps in any direction."])))},e}(),eue=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r)).calledTheClock=i,a}return Wg(n,[{key:"toString",value:function(){return"MartianChessMove(("+this.coord.x+", "+this.coord.y+") -> ("+this.end.x+", "+this.end.y+")"+(this.calledTheClock?", CALL_THE_CLOCK":"")+")"}},{key:"equals",value:function(e){return!1!==this.coord.equals(e.coord)&&!1!==this.end.equals(e.end)&&this.calledTheClock===e.calledTheClock}},{key:"isValidForPawn",value:function(){var e=Math.abs(this.coord.x-this.end.x),t=Math.abs(this.coord.y-this.end.y);return 1===e&&1===t}},{key:"isValidForDrone",value:function(){return this.coord.getDistance(this.end)<=2}},{key:"isUndoneBy",value:function(e){if(e.isAbsent())return!1;var t=e.get();return t.end.equals(this.coord)&&t.coord.equals(this.end)}}],[{key:"from",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.isNotInRange(4,8))return hB.failure(Jse.START_COORD_OUT_OF_RANGE());if(t.isNotInRange(4,8))return hB.failure(Jse.END_COORD_OUT_OF_RANGE());if(t.equals(e))return hB.failure(ete.MOVE_CANNOT_BE_STATIC());var i=Hee.factory.fromDelta(t.x-e.x,t.y-e.y);return i.isFailure()?hB.failure(i.getReason()):hB.success(new n(e,t,r))}}]),n}(hne);eue.encoder=T7.tuple([Zee.numberEncoder(4,8),Zee.numberEncoder(4,8),T7.booleanEncoder],function(e){return[e.coord,e.end,e.calledTheClock]},function(e){return eue.from(e[0],e[1],e[2]).get()});var tue=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,[{key:"getValue",value:function(){return this.value}},{key:"equals",value:function(e){return this.getValue()===e.getValue()}}],[{key:"tryMerge",value:function(t,n){v7(t!==e.EMPTY&&n!==e.EMPTY,"tryMerge cannot be called with empty pieces");var r=t.value+n.value;return 2===r||3===r?fB.of(e.from(r)):fB.empty()}},{key:"from",value:function(t){return t===e.DRONE.value?e.DRONE:(oB.expectToBe(t,e.QUEEN.value),e.QUEEN)}}]),e}();tue.EMPTY=new tue(0),tue.PAWN=new tue(1),tue.DRONE=new tue(2),tue.QUEEN=new tue(3);var nue=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e,r)).ruler=e,i}return Wg(n,[{key:"getListMoves",value:function(e){var t,n=e.gameState,r=n.getCurrentPlayer(),i=[],a=Hg(n.getPlayerTerritory(r));try{for(a.s();!(t=a.n()).done;)for(var o=t.value,s=0;s<4;s++)switch(n.getPieceAtXY(s,o)){case tue.PAWN:i=i.concat(this.getMovesForPawnAt(n,s,o));break;case tue.DRONE:i=i.concat(this.getMovesForDroneAt(n,s,o));break;case tue.QUEEN:i=i.concat(this.getMovesForQueenAt(n,s,o))}}catch(u){a.e(u)}finally{a.f()}return i}},{key:"getMovesForPawnAt",value:function(e,t,n){var r,i=new Zee(t,n),a=[],o=Hg(Hee.DIAGONALS);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=i.getNext(s);u.isInRange(4,8)&&a.push(u)}}catch(c){o.e(c)}finally{o.f()}return this.addLegalMoves(e,i,a)}},{key:"addLegalMoves",value:function(e,t,n){var r,i=[],a=e.getPieceAt(t),o=!1===e.isTherePieceOnPlayerSide(tue.DRONE),s=!1===e.isTherePieceOnPlayerSide(tue.QUEEN),u=e.lastMove,c=Hg(n);try{for(c.s();!(r=c.n()).done;){var l=r.value,f=e.getPieceAt(l);if(f===tue.EMPTY)this.add(i,eue.from(t,l).get(),u);else if(e.isInPlayerTerritory(l)){var h=tue.tryMerge(f,a);if(h.isPresent()){var d=h.get(),v=eue.from(t,l).get();(d===tue.DRONE&&o||d===tue.QUEEN&&s)&&this.add(i,v,u)}}else this.add(i,eue.from(t,l).get(),u)}}catch(p){c.e(p)}finally{c.f()}return i}},{key:"add",value:function(e,t,n){!1===t.isUndoneBy(n)&&e.push(t)}},{key:"getMovesForDroneAt",value:function(e,t,n){var r=new Zee(t,n),i=this.getLandingCoordsForLinearMove(r,e,2);return this.addLegalMoves(e,r,i)}},{key:"getLandingCoordsForLinearMove",value:function(e,t,n){var r,i=[],a=Hg(Hee.DIRECTIONS);try{for(a.s();!(r=a.n()).done;){for(var o=r.value,s=1,u=e.getNext(o,s),c=t.tryToGetPieceAt(u),l=c.equalsValue(tue.EMPTY);l;)i.push(u),s++,u=e.getNext(o,s),l=(c=t.tryToGetPieceAt(u)).equalsValue(tue.EMPTY)&&s<n;c.isPresent()&&i.push(u)}}catch(f){a.e(f)}finally{a.f()}return i}},{key:"getMovesForQueenAt",value:function(e,t,n){var r=new Zee(t,n),i=this.getLandingCoordsForQueen(r,e);return this.addLegalMoves(e,r,i)}},{key:"getLandingCoordsForQueen",value:function(e,t){return this.getLandingCoordsForLinearMove(e,t,8)}},{key:"getBoardValue",value:function(e){var t,n=this.ruler.getGameStatus(e);if(n.isEndGame)t=n.toBoardValue();else{var r=e.gameState.getScoreOf(R7.ZERO);t=e.gameState.getScoreOf(R7.ONE)-r}return new nte(t)}}]),n}(tte),rue=function(){function e(t){Zg(this,e),this.captures=t,t.makeImmutable()}return Wg(e,[{key:"toValue",value:function(){var e=0;return this.captures.forEach(function(t){e+=t.key.getValue()*t.value}),e}},{key:"add",value:function(t){var n=this.captures.getCopy();return e.addToMap(n,t),new e(n)}}],[{key:"from",value:function(t){var n,r=new hte,i=Hg(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;e.addToMap(r,a)}}catch(o){i.e(o)}finally{i.f()}return new e(r)}},{key:"addToMap",value:function(e,t){var n=e.get(t);n.isPresent()?e.replace(t,n.get()+1):e.set(t,1)}}]),e}(),iue=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fB.empty(),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:fB.empty(),s=arguments.length>4?arguments[4]:void 0;return Zg(this,n),(i=t.call(this,e,r)).lastMove=a,i.countDown=o,null==s&&(s=new hte([{key:R7.ZERO,value:rue.from([])},{key:R7.ONE,value:rue.from([])}])),s.makeImmutable(),i.captured=s,i}return Wg(n,[{key:"getPlayerTerritory",value:function(e){return e===R7.ZERO?n.PLAYER_ZERO_TERRITORY:n.PLAYER_ONE_TERRITORY}},{key:"isTherePieceOnPlayerSide",value:function(e){var t,n=this.getCurrentPlayer(),r=Hg(this.getPlayerTerritory(n));try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=0;a<4;a++)if(this.getPieceAtXY(a,i)===e)return!0}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"getScoreOf",value:function(e){return this.captured.get(e).get().toValue()}},{key:"getEmptyTerritory",value:function(){return this.isTerritoryEmpty(R7.ZERO)?fB.of(R7.ZERO):this.isTerritoryEmpty(R7.ONE)?fB.of(R7.ONE):fB.empty()}},{key:"isTerritoryEmpty",value:function(e){var t,n=Hg(this.getPlayerTerritory(e));try{for(n.s();!(t=n.n()).done;)for(var r=t.value,i=0;i<4;i++)if(this.getPieceAtXY(i,r)!==tue.EMPTY)return!1}catch(a){n.e(a)}finally{n.f()}return!0}},{key:"isInOpponentTerritory",value:function(e){var t=this.getCurrentOpponent();return this.getPlayerTerritory(t).contains(e.y)}},{key:"isInPlayerTerritory",value:function(e){var t=this.getCurrentPlayer();return this.getPlayerTerritory(t).contains(e.y)}},{key:"getCapturesOf",value:function(e){var t=this.captured.get(R7.fromTurn(e)).get();return[t.captures.get(tue.PAWN).getOrElse(0),t.captures.get(tue.DRONE).getOrElse(0),t.captures.get(tue.QUEEN).getOrElse(0)]}}],[{key:"getInitialState",value:function(){var e=tue.EMPTY,t=tue.PAWN,r=tue.DRONE,i=tue.QUEEN;return new n([[i,i,r,e],[i,r,t,e],[r,t,t,e],[e,e,e,e],[e,e,e,e],[e,t,t,r],[e,t,r,i],[e,r,i,i]],0,fB.empty())}}]),n}(ote);iue.PLAYER_ZERO_TERRITORY=new ite([0,1,2,3]),iue.PLAYER_ONE_TERRITORY=new ite([4,5,6,7]);var aue=function(){var e=Wg(function e(){Zg(this,e)});return e.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY=function(){return $localize(qo||(qo=_g(["You must pick a piece from your side of the board in order to move it."])))},e.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT=function(){return $localize(Wo||(Wo=_g(["This is not a valid promotion nor a valid capture."])))},e.CANNOT_UNDO_LAST_MOVE=function(){return $localize(jo||(jo=_g(["You cannot perform a move that is the reverse of the previous one."])))},e}(),oue=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,r){var i=t.getCopiedBoard();i[e.coord.y][e.coord.x]=tue.EMPTY,i[e.end.y][e.end.x]=r.finalPiece;var a=r.score,o=t.countDown;if(o.isPresent())if(this.isCapture(e,t))o=n.STARTING_COUNT_DOWN;else{var s=t.countDown.get();o=fB.of(s-1)}return e.calledTheClock&&(o=n.STARTING_COUNT_DOWN),new iue(i,t.turn+1,fB.of(e),o,a)}},{key:"isLegal",value:function(e,t){this.assertNonDoubleClockCall(e,t);var n=this.isLegalMove(e,t);if(n.isFailure())return hB.failure(n.getReason());if(e.isUndoneBy(t.lastMove))return hB.failure(aue.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(e,t))return this.isLegalFieldPromotion(e,t);var r=t.getPieceAt(e.coord),i=t.captured.getCopy();if(this.isCapture(e,t)){var a=t.getCurrentPlayer(),o=i.get(a).get(),s=t.getPieceAt(e.end);o=o.add(s),i.replace(a,o),i.makeImmutable()}return hB.success({finalPiece:r,score:i})}},{key:"assertNonDoubleClockCall",value:function(e,t){v7(!1===(t.countDown.isPresent()&&e.calledTheClock),"Should not call the clock twice")}},{key:"isCapture",value:function(e,t){var n=t.isInOpponentTerritory(e.end),r=t.getPieceAt(e.end)!==tue.EMPTY;return n&&r}},{key:"isFieldPromotion",value:function(e,t){var n=t.isInPlayerTerritory(e.end),r=t.getPieceAt(e.end)!==tue.EMPTY;return n&&r}},{key:"isLegalFieldPromotion",value:function(e,t){var n=this.getPromotedPiece(e,t);if(n.isAbsent())return hB.failure(aue.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());var r=n.get();if(t.isTherePieceOnPlayerSide(r))return hB.failure(aue.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());var i={finalPiece:r,score:t.captured.getCopy()};return hB.success(i)}},{key:"isLegalMove",value:function(e,t){if(!1===t.isInPlayerTerritory(e.coord))return hB.failure(aue.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());var n=t.getPieceAt(e.coord);if(n===tue.EMPTY)return hB.failure(ete.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===tue.PAWN)return e.isValidForPawn()?hB.success(void 0):hB.failure(Jse.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(n===tue.DRONE&&!1===e.isValidForDrone())return hB.failure(Jse.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());var r,i=Hg(e.coord.getUntil(e.end));try{for(i.s();!(r=i.n()).done;){var a=r.value;if(t.getPieceAt(a)!==tue.EMPTY)return hB.failure(ete.SOMETHING_IN_THE_WAY())}}catch(o){i.e(o)}finally{i.f()}return hB.success(void 0)}},{key:"getPromotedPiece",value:function(e,t){var n=t.getPieceAt(e.coord),r=t.getPieceAt(e.end);return tue.tryMerge(n,r)}},{key:"getGameStatus",value:function(e){var t=e.gameState;if(t.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(t,gte.DRAW);if(t.getEmptyTerritory().isPresent()){var n=t.getCurrentOpponent(),r=gte.getVictory(n);return this.getGameStatusScoreVictoryOr(t,r)}return gte.ONGOING}},{key:"getGameStatusScoreVictoryOr",value:function(e,t){var n=e.getScoreOf(R7.ZERO),r=e.getScoreOf(R7.ONE);return n>r?gte.ZERO_WON:r>n?gte.ONE_WON:t}}]),n}(yte);oue.STARTING_COUNT_DOWN=fB.of(7);var sue=function(){var e=Wg(function e(){Zg(this,e)});return e.YOU_DID_NOT_CAPTURE_ANY_PIECE=function(){return $localize(Yo||(Yo=_g(["Failed, you did not capture any piece."])))},e}(),uue=tue.EMPTY,cue=tue.PAWN,lue=tue.DRONE,fue=tue.QUEEN,hue=function(){return $localize(Ko||(Ko=_g(["This is not a field promotion!"])))},due=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(Qo||(Qo=_g(["Goal of the game"]))),$localize(Xo||(Xo=_g(["At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal."]))),iue.getInitialState()),wte.informational($localize(Jo||(Jo=_g(["The pieces"]))),$localize(es||(es=_g(["The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>"]))),iue.getInitialState()),wte.fromPredicate($localize(ts||(ts=_g(["Moving pawns"]))),$localize(ns||(ns=_g(["Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn."]))),iue.getInitialState(),eue.from(new Zee(1,2),new Zee(2,3)).get(),function(e,t,n){return n.getPieceAt(e.end)===tue.PAWN?pB.SUCCESS:pB.failure($localize(rs||(rs=_g(["This is not a pawn!"]))))},$localize(is||(is=_g(["Congratulations!"])))),wte.fromPredicate($localize(as||(as=_g(["Moving drones"]))),$localize(os||(os=_g(["Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone."]))),iue.getInitialState(),eue.from(new Zee(2,0),new Zee(3,0)).get(),function(e,t,n){return n.getPieceAt(e.end)===tue.DRONE?pB.SUCCESS:pB.failure($localize(ss||(ss=_g(["This is not a drone!"]))))},$localize(us||(us=_g(["Congratulations!"])))),wte.fromPredicate($localize(cs||(cs=_g(["Moving queens"]))),$localize(ls||(ls=_g(["Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen."]))),new iue([[lue,cue,uue,uue],[fue,uue,uue,uue],[uue,uue,uue,uue],[uue,uue,fue,uue],[uue,uue,uue,uue],[uue,uue,uue,uue],[uue,uue,uue,uue],[fue,lue,cue,uue]],0),eue.from(new Zee(2,3),new Zee(2,7)).get(),function(e,t,n){return n.getPieceAt(e.end)===tue.QUEEN?pB.SUCCESS:pB.failure($localize(fs||(fs=_g(["This is not a queen!"]))))},$localize(hs||(hs=_g(["Congratulations!"])))),wte.fromMove($localize(ds||(ds=_g(["Capture"]))),$localize(vs||(vs=_g(["When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it."]))),new iue([[lue,cue,cue,uue],[uue,uue,uue,uue],[fue,uue,uue,uue],[uue,uue,uue,uue],[uue,uue,cue,uue],[uue,uue,uue,uue],[uue,uue,uue,uue],[uue,lue,cue,uue]],0),[eue.from(new Zee(0,2),new Zee(2,4)).get()],$localize(ps||(ps=_g(["Congratulations! By capturing that pawn, you won one point."]))),sue.YOU_DID_NOT_CAPTURE_ANY_PIECE()),wte.fromMove($localize(gs||(gs=_g(["Field Promotion (1/2)"]))),$localize(ys||(ys=_g(["It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it."]))),new iue([[uue,uue,uue,fue],[uue,cue,uue,uue],[uue,uue,cue,uue],[uue,uue,uue,uue],[uue,uue,uue,uue],[uue,uue,uue,fue],[uue,uue,lue,uue],[uue,cue,uue,uue]],0),[eue.from(new Zee(1,1),new Zee(2,2)).get(),eue.from(new Zee(2,2),new Zee(1,1)).get()],$localize(ms||(ms=_g(["Congratulations!"]))),hue()),wte.fromPredicate($localize(ks||(ks=_g(["Field Promotion (2/2)"]))),$localize(Cs||(Cs=_g(["The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it."]))),new iue([[cue,uue,uue,uue],[uue,uue,uue,uue],[uue,uue,uue,uue],[uue,uue,uue,uue],[uue,uue,uue,uue],[uue,uue,uue,uue],[uue,uue,lue,uue],[uue,cue,uue,uue]],1),eue.from(new Zee(1,7),new Zee(2,6)).get(),function(e,t,n){return n.getPieceAt(e.end)===tue.QUEEN?pB.SUCCESS:pB.failure(hue())},$localize(ws||(ws=_g(["Congratulations!"])))),wte.fromPredicate($localize(_s||(_s=_g(["Call the clock"]))),$localize(Es||(Es=_g(['When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You\'re playing Dark. Call the clock and perform a move.']))),iue.getInitialState(),eue.from(new Zee(2,2),new Zee(3,3),!0).get(),function(e,t,n){return e.calledTheClock?pB.SUCCESS:pB.failure($localize(bs||(bs=_g(["You did not call the clock!"]))))},$localize(Ps||(Ps=_g(["Congratulations!"])))),wte.fromMove($localize(Ss||(Ss=_g(["Restarting the clock"]))),$localize(Os||(Os=_g(["If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You are playing Dark, do a capture to restart the countdown."]))),new iue([[uue,uue,uue,uue],[uue,cue,uue,uue],[uue,uue,uue,uue],[uue,uue,uue,uue],[uue,uue,uue,uue],[uue,uue,uue,cue],[uue,uue,lue,uue],[uue,cue,uue,uue]],14,fB.empty(),fB.of(1)),[eue.from(new Zee(1,1),new Zee(2,2)).get()],$localize(Ts||(Ts=_g(["Congratulations!"]))),$localize(Is||(Is=_g(["This is not a capture, the game is now over, please retry!"])))),wte.anyMove($localize(As||(As=_g(["End game (by clock)"]))),$localize(Rs||(Rs=_g(["When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You are playing Dark, do the last move."]))),new iue([[uue,uue,uue,fue],[uue,cue,uue,uue],[uue,uue,uue,uue],[uue,uue,uue,uue],[uue,uue,uue,uue],[lue,uue,uue,uue],[uue,uue,uue,uue],[uue,lue,uue,uue]],14,fB.empty(),fB.of(1)),eue.from(new Zee(1,1),new Zee(2,2)).get(),$localize(Ms||(Ms=_g(["Congratulations!"])))),wte.fromPredicate($localize(xs||(xs=_g(["End by emptyness"]))),$localize(Ns||(Ns=_g(["When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!"]))),new iue([[uue,uue,uue,fue],[uue,cue,uue,uue],[uue,uue,uue,uue],[uue,uue,uue,uue],[uue,uue,cue,uue],[uue,uue,uue,uue],[uue,uue,uue,uue],[uue,uue,uue,uue]],1),eue.from(new Zee(2,4),new Zee(1,3)).get(),function(e,t,n){return 3===e.end.y?pB.SUCCESS:pB.failure($localize(Ds||(Ds=_g(["Your piece is still in you territory!"]))))},$localize(Ls||(Ls=_g(["Congratulations!"]))))]});function vue(e,t){if(1&e&&(cC(),nP(0,"g",20)),2&e){var n=fP(2).index,r=fP().index,i=fP();SP(i.style),vP("mainShapeId","pawn_",n,"_",r,""),Xb("pieceClasses",i.getPieceClasses(n,r))}}function pue(e,t){if(1&e&&(cC(),nP(0,"g",21)),2&e){var n=fP(2).index,r=fP().index,i=fP();SP(i.style),vP("mainShapeId","drone_",n,"_",r,""),Xb("pieceClasses",i.getPieceClasses(n,r))}}function gue(e,t){if(1&e&&(cC(),nP(0,"g",22)),2&e){var n=fP(2).index,r=fP().index,i=fP();SP(i.style),vP("mainShapeId","queen_",n,"_",r,""),Xb("pieceClasses",i.getPieceClasses(n,r))}}function yue(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,vue,1,5,"g",17),Yb(2,pue,1,5,"g",18),Yb(3,gue,1,5,"g",19),tP()),2&e){var n=fP(),r=n.index,i=n.$implicit,a=fP().index,o=fP();$b("transform",o.getPieceLocation(r,a)),pE(1),Xb("ngIf",i===o.pieces.PAWN),pE(1),Xb("ngIf",i===o.pieces.DRONE),pE(1),Xb("ngIf",i===o.pieces.QUEEN)}}function mue(e,t){if(1&e){var n=aP();cC(),eP(0,"g",15),uP("click",function(){var e=Nk(n).index,t=fP().index;return fP().onClick(e,t)}),nP(1,"rect",16),Yb(2,yue,4,4,"g",14),tP()}if(2&e){var r=t.$implicit,i=t.index,a=fP().index,o=fP();vP("id","click_",i,"_",a,""),$b("transform","translate(0,  "+(a<=3?0:2*o.STROKE_WIDTH)+")"),pE(1),vP("id","square_",i,"_",a,""),Xb("ngClass",o.getSquareClasses(i,a)),$b("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),pE(1),Xb("ngIf",r!==o.pieces.EMPTY)}}function kue(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"rect",23),uP("click",function(){var e=Nk(n).$implicit;return fP(3).onClick(e.x,e.y)}),tP(),tP()}if(2&e){var r=t.$implicit,i=fP(3);pE(1),vP("id","indicator_",r.x,"_",r.y,""),$b("transform","translate(0,  "+(r.y<=3?0:2*i.STROKE_WIDTH)+")")("x",r.x*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("y",r.y*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("width",i.INDICATOR_SIZE)("height",i.INDICATOR_SIZE)}}function Cue(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,kue,2,7,"g",1),tP()),2&e){var n=fP(2);pE(1),Xb("ngForOf",n.selectedPieceInfo.get().legalLandings)}}function wue(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,mue,3,11,"g",13),Yb(2,Cue,2,1,"g",14),tP()),2&e){var n=t.$implicit,r=fP();$b("transform","translate("+r.SPACE_SIZE+", 0)"),pE(1),Xb("ngForOf",n),pE(1),Xb("ngIf",r.selectedPieceInfo.isPresent())}}function _ue(e,t){if(1&e&&(cC(),eP(0,"text",24),FP(1),tP()),2&e){var n=fP();Xb("ngClass","player"+n.getCurrentPlayer().value)("ngClass",n.getClockCircleClasses()),$b("x",.5*n.SPACE_SIZE)("y",.5*n.SPACE_SIZE),pE(1),UP(n.countDown.get())}}function Eue(e,t){if(1&e&&(cC(),nP(0,"polyline",25)),2&e){var n=fP();Xb("ngClass",n.getClockCircleClasses()),$b("points",n.clockNeedlesPoints)}}var bue=function(e){return[e]};function Pue(e,t){if(1&e){var n=aP();cC(),rP(0),eP(1,"g",28),uP("click",function(){var e=Nk(n).index;return fP(2).chooseStyle(e)}),tP(),iP()}if(2&e){var r=t.$implicit,i=t.index,a=fP(2);pE(1),SP(r.style),Xb("id",r.name)("pieceClasses",oT(5,bue,"player"+a.getCurrentPlayer().value)),$b("transform","translate(0, "+-(i+1)*a.SPACE_SIZE+")")}}function Sue(e,t){if(1&e&&(cC(),eP(0,"g",26),nP(1,"rect",27),Yb(2,Pue,2,7,"ng-container",1),tP()),2&e){var n=fP();pE(1),$b("x",0)("y",-n.listOfStyles.length*n.SPACE_SIZE)("width",1*n.SPACE_SIZE)("height",n.listOfStyles.length*n.SPACE_SIZE),pE(1),Xb("ngForOf",n.listOfStyles)}}function Oue(e,t){if(1&e&&(cC(),eP(0,"text",34),FP(1),tP()),2&e){var n=fP(2).$implicit,r=fP().$implicit,i=fP();Xb("ngClass","player"+(0===r?1:0)),$b("x",i.SPACE_SIZE/2)("y",i.SPACE_SIZE/2),pE(1),UP(n+" x ")}}function Tue(e,t){if(1&e&&(cC(),nP(0,"g",35)),2&e){var n=fP(3).$implicit;SP(fP().style),Xb("pieceClasses",oT(3,bue,"player"+(0===n?1:0)))}}function Iue(e,t){if(1&e&&(cC(),nP(0,"g",36)),2&e){var n=fP(3).$implicit;SP(fP().style),Xb("pieceClasses",oT(3,bue,"player"+(0===n?1:0)))}}function Aue(e,t){if(1&e&&(cC(),nP(0,"g",37)),2&e){var n=fP(3).$implicit;SP(fP().style),Xb("pieceClasses",oT(3,bue,"player"+(0===n?1:0)))}}function Rue(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Oue,2,4,"text",30),eP(2,"g",29),Yb(3,Tue,1,5,"g",31),Yb(4,Iue,1,5,"g",32),Yb(5,Aue,1,5,"g",33),tP(),tP()),2&e){var n=fP(),r=n.index,i=n.$implicit,a=fP().$implicit,o=fP();$b("transform","translate(0, "+2*r*o.SPACE_SIZE+")"),pE(1),Xb("ngIf",i>1),pE(1),vP("id","piece_",r,"_player_",a,""),$b("transform","translate("+o.SPACE_SIZE+", 0)"),pE(1),Xb("ngIf",0===r),pE(1),Xb("ngIf",1===r),pE(1),Xb("ngIf",2===r)}}function Mue(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Rue,6,8,"g",14),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngIf",n>0)}}function xue(e,t){if(1&e&&(cC(),eP(0,"g"),eP(1,"g",29),Yb(2,Mue,2,1,"g",1),tP(),tP()),2&e){var n=t.$implicit,r=fP();pE(1),dP("id","capture_of_player_",n,""),$b("transform","scale(0.5, 0.5) translate("+-r.SPACE_SIZE/2+", "+(r.SPACE_SIZE/2+n*(10*r.SPACE_SIZE+4*r.STROKE_WIDTH))+")"),pE(1),Xb("ngForOf",r.state.getCapturesOf(n))}}var Nue=function(){return[0,1]},Due=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).INDICATOR_SIZE=20,r.LEFT=n.SPACE_SIZE/-4+n.STROKE_WIDTH/-2,r.UP=-n.STROKE_WIDTH/2,r.WIDTH=6.5*n.SPACE_SIZE+n.STROKE_WIDTH,r.HEIGHT=8*n.SPACE_SIZE+3*n.STROKE_WIDTH,r.MartianChessComponent=n,r.style={shape:"Circle",points:"Horizontal Points"},r.pieces=tue,r.selectedPieceInfo=fB.empty(),r.countDown=fB.empty(),r.callTheClock=!1,r.displayModePanel=!1,r.listOfStyles=[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}],r.rules=new oue(iue),r.availableMinimaxes=[new nue(r.rules,"Martian Chess Dummy Minimax")],r.SPACE_SIZE=n.SPACE_SIZE,r.configCogTransformation=r.getConfigCogTransformation(),r.configViewTranslation=r.getConfigViewTranslation(),r.clockNeedlesPoints=r.getClockNeedlesPoints(),r.encoder=eue.encoder,r.tutorial=(new due).tutorial,r.scores=fB.of([0,0]),r.updateBoard(),r}return Wg(n,[{key:"getConfigViewTranslation",value:function(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}},{key:"getConfigCogTransformation",value:function(){var e=this.STROKE_WIDTH,t=(this.SPACE_SIZE-e)/40;return"translate("+1*e+", "+1*e+") scale("+t+" "+t+")"}},{key:"getClockNeedlesPoints",value:function(){var e=.5*this.SPACE_SIZE;return e+" "+.1*this.SPACE_SIZE+", "+e+" "+e+", "+.75*this.SPACE_SIZE+" "+e}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.board=this.state.board;var e=this.state.getScoreOf(R7.ZERO),t=this.state.getScoreOf(R7.ONE);this.countDown=this.state.countDown,this.scores=fB.of([e,t])}},{key:"getPieceLocation",value:function(e,t){return"translate("+this.SPACE_SIZE*e+", "+this.SPACE_SIZE*t+")"}},{key:"getPieceClasses",value:function(e,t){var n=new Zee(e,t),r=[];return r.push(t<=3?"player0":"player1"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(n)&&r.push("highlighted"),this.rules.node.move.isPresent()&&this.rules.node.move.get().end.equals(n)&&this.rules.node.mother.get().gameState.getPieceAt(n)!==tue.EMPTY&&this.rules.node.gameState.isInOpponentTerritory(new Zee(0,t))&&r.push("highlighted"),r}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n.displayModePanel=!1,!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=4;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 4:return a=new Zee(e,t),r.abrupt("return",n.selectedPieceInfo.isPresent()?n.secondClick(a):n.firstClick(a));case 6:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.isOneOfUsersPieces(e)?t.selectAsFirstPiece(e):(t.cancelMoveAttempt(),pB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"selectAsFirstPiece",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getLegalLandings(e),n.abrupt("return",(t.selectedPieceInfo=fB.of({selectedPiece:e,legalLandings:r}),pB.SUCCESS));case 2:case"end":return n.stop()}},n)}))()}},{key:"getLegalLandings",value:function(e){var t=this,n=this.state.getPieceAt(e);return(n===tue.PAWN?Hee.DIAGONALS.map(function(t){return e.getNext(t)}):this.getValidLinearLandingSquareUntil(e,n===tue.DRONE?2:8)).filter(function(n){var r=eue.from(e,n);return!!r.isSuccess()&&t.rules.isLegal(r.get(),t.getState()).isSuccess()})}},{key:"getValidLinearLandingSquareUntil",value:function(e,t){var n=this;return Hee.DIRECTIONS.flatMap(function(r){for(var i=[],a=e.getNext(r),o=1;a.isInRange(4,8)&&o<=t&&(i.push(a),n.getState().getPieceAt(a)===tue.EMPTY);)a=a.getNext(r),o++;return i})}},{key:"secondClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.selectedPieceInfo.get()).selectedPiece.equals(e)){n.next=3;break}return n.abrupt("return",(t.cancelMoveAttempt(),pB.SUCCESS));case 3:if(!r.legalLandings.some(function(t){return t.equals(e)})){n.next=8;break}return v7((i=eue.from(r.selectedPiece,e,t.callTheClock)).isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!"),a=t.rules.node.gameState,n.abrupt("return",t.chooseMove(i.get(),a));case 8:if(!t.isOneOfUsersPieces(e)){n.next=10;break}return n.abrupt("return",t.selectAsFirstPiece(e));case 10:return o=eue.from(r.selectedPiece,e,t.callTheClock),n.abrupt("return",o.isSuccess()?t.chooseMove(o.get(),t.getState()):t.cancelMove(o.getReason()));case 12:case"end":return n.stop()}},n)}))()}},{key:"isOneOfUsersPieces",value:function(e){return this.state.getPieceAt(e)!==tue.EMPTY&&this.state.isInPlayerTerritory(e)}},{key:"cancelMoveAttempt",value:function(){this.selectedPieceInfo=fB.empty(),this.callTheClock=!1}},{key:"onClockClick",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#clockOrCountDownView"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):(e.getState().countDown.isAbsent()&&(e.callTheClock=!e.callTheClock),pB.SUCCESS));case 2:case"end":return t.stop()}},t)}))()}},{key:"getClockCircleClasses",value:function(){var e=["base"];return this.callTheClock&&e.push("highlighted"),this.getCurrentPlayer()===R7.ZERO?e.push("player0-stroke"):e.push("player1-stroke"),e}},{key:"getSquareClasses",value:function(e,t){var n=new Zee(e,t),r=["base"];if(this.rules.node.move.isPresent()){var i=this.rules.node,a=i.move.get();a.coord.equals(n)?r.push("moved"):a.end.equals(n)&&(i.mother.get().gameState.getPieceAt(n)===tue.EMPTY||i.gameState.isInOpponentTerritory(new Zee(0,t))?r.push("moved"):r.push("captured"))}return r}},{key:"onModeCogClick",value:function(){this.displayModePanel=!this.displayModePanel}},{key:"chooseStyle",value:function(e){this.style=this.listOfStyles[e].style,this.displayModePanel=!1}}],[{key:"getRegularPolygon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=n.getRegularPolygonCoords(e,t);return n.mapCoordsToString(r)}},{key:"getNPointedStar",value:function(e,t){var r=this.getNPointedStarCoords(e,t);return n.mapCoordsToString(r)}},{key:"getNPointedStarCoords",value:function(e,t){var r=[],i=.5*n.SPACE_SIZE,a=.5*n.SPACE_SIZE;e*=2;for(var o=0;o<e;o++){var s=(o*(360/e)+t)/180*Math.PI,u=o%2==0?n.SPACE_SIZE/2:n.SPACE_SIZE/6,c=i+.8*u*Math.cos(s),l=a+.8*u*Math.sin(s);r.push(new Zee(c,l))}return r}},{key:"getRegularPolygonCoords",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[],i=.5*n.SPACE_SIZE,a=.5*n.SPACE_SIZE,o=0;o<e;o++){var s=(o*(360/e)-90)/180*Math.PI,u=.5*n.SPACE_SIZE,c=i+.8*u*Math.cos(s),l=a+.8*u*Math.sin(s)+t;r.push(new Zee(c,l))}return r}},{key:"mapCoordsToString",value:function(e){var t,n="",r=Hg(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n+=i.x+", "+i.y+" "}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getRadius",value:function(e){return this.SPACE_SIZE*e/10}}]),n}(nne);return e.SPACE_SIZE=100,e.STROKE_WIDTH=8,e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-martian-chess"]],features:[Rb],decls:15,vars:25,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","canal",3,"ngClass"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),Yb(1,wue,3,3,"g",1),eP(2,"g",2),uP("click",function(){return t.onClockClick()}),nP(3,"rect",3),nP(4,"circle",4),Yb(5,_ue,2,5,"text",5),Yb(6,Eue,1,2,"polyline",6),tP(),nP(7,"line",7),eP(8,"g",8),eP(9,"g",9),uP("click",function(){return t.onModeCogClick()}),nP(10,"rect",3),nP(11,"path",10),tP(),Yb(12,Sue,3,5,"g",11),tP(),eP(13,"g",12),Yb(14,xue,3,3,"g",1),tP(),tP()),2&e&&($b("viewBox",t.LEFT+" "+t.UP+" "+t.WIDTH+" "+t.HEIGHT),pE(1),Xb("ngForOf",t.board),pE(1),$b("transform","translate("+5.25*t.SPACE_SIZE+", 0)"),pE(1),$b("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),pE(1),Xb("ngClass",t.getClockCircleClasses()),$b("cx",.5*t.SPACE_SIZE)("cy",.5*t.SPACE_SIZE)("r",.4*t.SPACE_SIZE),pE(1),Xb("ngIf",t.countDown.isPresent()),pE(1),Xb("ngIf",t.countDown.isAbsent()),pE(1),Xb("ngClass","player"+t.getCurrentPlayer().value),$b("x1",t.SPACE_SIZE)("y1",5*t.SPACE_SIZE+8)("x2",5*t.SPACE_SIZE)("y2",5*t.SPACE_SIZE+8)("stroke-width",2*t.STROKE_WIDTH),pE(1),$b("transform",t.configViewTranslation),pE(2),$b("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),pE(1),Xb("ngClass","player"+t.getCurrentPlayer().value),$b("transform",t.configCogTransformation),pE(1),Xb("ngIf",t.displayModePanel),pE(2),Xb("ngForOf",aT(24,Nue)))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Lue=Number.MAX_SAFE_INTEGER,Fue=Number.MIN_SAFE_INTEGER,Uue=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,D7.copyBiArray(n.initialBoard),e)).turn=e,i.location=r,i}return Wg(n,null,[{key:"getInitialState",value:function(){return new n(0,new Zee(0,0))}}]),n}(ote);Uue.BOARD_0=[[6,4,3,1],[4,4,3,1],[3,3,2,0],[1,1,0,0]],Uue.BOARD_1=[[0,+Lue,-1,-1],[1,2,+Lue,-1],[+Fue,3,4,-1],[-1,+Fue,+Fue,-1]],Uue.BOARD_2=[[0,+Lue,-1,-1],[+Lue,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],Uue.BOARD_3=[[0,1,+Fue,-1],[1,+Fue,-1,-1],[+Fue,-1,-1,-1],[-1,-1,-1,-1]],Uue.BOARD_4=[[0,1,+Fue,-1],[1,+Fue,-1,-1],[+Fue,-1,-1,-1],[-1,-1,-1,1]],Uue.initialBoard=Uue.BOARD_0;var Vue=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){var r=new Zee(t.location.x+(!0===e.right?1:0),t.location.y+(!1===e.right?1:0));return new Uue(t.turn+1,r)}},{key:"isLegal",value:function(e,t){var n=t.location,r=t.getCopiedBoard();return n.x+1===r[0].length&&!0===e.right||n.y+1===r.length&&!1===e.right?hB.failure("incorrect move"):hB.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getPieceAt(t.location);return n===R7.ZERO.getVictoryValue()?gte.ZERO_WON:n===R7.ONE.getVictoryValue()?gte.ONE_WON:t.location.equals(new Zee(3,3))?0===n?gte.DRAW:n>0?gte.ONE_WON:gte.ZERO_WON:gte.ONGOING}}]),n}(yte),Bue=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).right=e,r}return Wg(n,[{key:"equals",value:function(e){return this===e||this.right===e.right}},{key:"toString",value:function(){return this.right?"Move RIGHT":"Move DOWN"}}]),n}(ute);Bue.RIGHT=new Bue(!0),Bue.DOWN=new Bue(!1),Bue.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 1}},{key:"decodeNumber",value:function(e){return 0===e?Bue.RIGHT:Bue.DOWN}},{key:"encodeNumber",value:function(e){return e.right?0:1}}]),n}(T7));var zue=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getBoardValue",value:function(e){var t=Vue.getGameStatus(e);if(t.isEndGame)return new nte(t.toBoardValue());var n=e.gameState;return new nte(n.getPieceAt(n.location))}},{key:"getListMoves",value:function(e){var t=[],n=e.gameState;return n.location.x<3&&t.push(Bue.RIGHT),n.location.y<3&&t.push(Bue.DOWN),t}}]),n}(tte);function Hue(e,t){1&e&&(rP(0),FP(1,"("),iP())}function Gue(e,t){1&e&&(rP(0),FP(1,")"),iP())}function $ue(e,t){if(1&e&&(eP(0,"td"),Yb(1,Hue,2,0,"ng-container",3),FP(2),Yb(3,Gue,2,0,"ng-container",3),tP()),2&e){var n=t.$implicit,r=t.index,i=fP().index,a=fP();pE(1),Xb("ngIf",a.coord.x===r&&a.coord.y===i),pE(1),VP(" ",n," "),pE(1),Xb("ngIf",a.coord.x===r&&a.coord.y===i)}}function Zue(e,t){if(1&e&&(eP(0,"tr"),Yb(1,$ue,4,3,"td",0),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}var que=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).coord=new Zee(-1,-1),r.rules=new Vue(Uue),r.availableMinimaxes=[new zue(r.rules,"MinimaxTestingMinimax")],r.encoder=Bue.encoder,r}return Wg(n,[{key:"chooseRight",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_right"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(Bue.RIGHT,e.rules.node.gameState));case 2:case"end":return t.stop()}},t)}))()}},{key:"chooseDown",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_down"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(Bue.DOWN,e.rules.node.gameState));case 2:case"end":return t.stop()}},t)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.coord=e.location}}]),n}(nne);return e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-minimax-testing"]],features:[Rb],decls:8,vars:2,consts:[[4,"ngFor","ngForOf"],["id","click_right",3,"click"],["id","click_down",3,"click"],[4,"ngIf"]],template:function(e,t){1&e&&(eP(0,"table"),Yb(1,Zue,2,1,"tr",0),eP(2,"div",1),uP("click",function(){return t.chooseRight()}),FP(3," goRight "),tP(),eP(4,"div",2),uP("click",function(){return t.chooseDown()}),FP(5," goDown "),tP(),eP(6,"div"),FP(7),tP(),tP()),2&e&&(pE(1),Xb("ngForOf",t.board),pE(6),VP(" ",t.coord," "))},directives:[LA,UA],encapsulation:2}),e}(),Wue=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,null,[{key:"getInitialState",value:function(){return new n(D7.createTable(7,6,A7.NONE),0)}}]),n}(ote),jue=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this)).x=e,r}return Wg(n,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"P4Move("+this.x+")"}}],[{key:"of",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;case 5:return n.FIVE;case 6:return n.SIX;default:throw new Error("Invalid P4Move")}}}]),n}(ute);jue.ZERO=new jue(0),jue.ONE=new jue(1),jue.TWO=new jue(2),jue.THREE=new jue(3),jue.FOUR=new jue(4),jue.FIVE=new jue(5),jue.SIX=new jue(6),jue.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 6}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return jue.of(e)}}]),n}(T7));var Yue=function(){var e=Wg(function e(){Zg(this,e)});return e.COLUMN_IS_FULL=function(){return $localize(Fs||(Fs=_g(["Please put your piece in an incomplete column."])))},e}(),Kue=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,r){var i=e.x,a=t.getCopiedBoard(),o=n.getLowestUnoccupiedCase(a,i),s=t.turn;return a[o][i]=t.getCurrentPlayer(),new Wue(a,s+1)}},{key:"isLegal",value:function(e,t){return sB(n.VERBOSE,{context:"P4Rules.isLegal",move:e.toString(),state:t}),t.getPieceAtXY(e.x,0).isPlayer()?hB.failure(Yue.COLUMN_IS_FULL()):hB.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,r=0;r<7;r++)for(var i=5;i>=0&&t.board[i][r].isPlayer();i--){var a=n.getSquareScore(t.board,new Zee(r,i));if(pte.getScoreStatus(a)===fte.VICTORY)return gte.getVictory(t.getCurrentOpponent())}return 42===t.turn?gte.DRAW:gte.ONGOING}}],[{key:"getVictoriousCoords",value:function(e){for(var t=[],r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r].isPlayer();i--){var a=n.getSquareScore(e.board,new Zee(r,i));(a===R7.ZERO.getVictoryValue()||a===R7.ONE.getVictoryValue())&&t.push(new Zee(r,i))}return t}},{key:"getBoardValueFromScratch",value:function(e){sB(n.VERBOSE,{P4Rules_getBoardValueFromScratch:{state:e}});for(var t=0,r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r].isPlayer();i--){var a=n.getSquareScore(e.board,new Zee(r,i));if(pte.getScoreStatus(a)!==fte.DEFAULT)return sB(n.VERBOSE,{preVictoryOrVictory:{state:e,tmpScore:a,coord:{x:r,y:i}}}),new nte(a);t+=a}return new nte(t)}},{key:"getLowestUnoccupiedCase",value:function(e,t){for(var n=0;n<6&&e[n][t]===A7.NONE;)n++;return n-1}},{key:"getNumberOfFreeSpacesAndAllies",value:function(e,t,n,r,i){for(var a=0,o=0,s=!0,u=new Zee(t.x+n.x,t.y+n.y);u.isInRange(7,6)&&3!==a;){var c=e[u.y][u.x];if(c===r)return[a,o];c===i&&s?o++:s=!1,c!==r&&c!==i&&a++,u=u.getNext(n)}return[a,o]}},{key:"getOpponent",value:function(e,t){var n=e[t.y][t.x];return v7(n.isPlayer(),"getOpponent should not be called with PlayerOrNone.NONE"),n===R7.ONE?R7.ZERO:R7.ONE}},{key:"getSquareScore",value:function(e,t){sB(n.VERBOSE,"getSquareScore(board, "+t.x+", "+t.y+") called"),sB(n.VERBOSE,e);var r,i=0,a=n.getOpponent(e,t),o=a.getOpponent(),s=new hte,u=new hte,c=Hg(Hee.DIRECTIONS);try{for(c.s();!(r=c.n()).done;){var l=r.value,f=n.getNumberOfFreeSpacesAndAllies(e,t,l,a,o);s.set(l,f[0]),u.set(l,f[1])}}catch(y){c.e(y)}finally{c.f()}for(var h=0,d=[Hee.UP,Hee.UP_RIGHT,Hee.RIGHT,Hee.DOWN_RIGHT];h<d.length;h++){var v=d[h],p=u.get(v).get()+u.get(v.getOpposite()).get();if(p>2)return sB(n.VERBOSE,{text:"there is some kind of victory here ("+t.x+", "+t.y+")\nline allies : "+p+"\n",board:e}),o.getVictoryValue();var g=s.get(v).get()+s.get(v.getOpposite()).get();3===g?i+=2:g>3&&(i+=g-2)}return i*o.getScoreModifier()}},{key:"getListMoves",value:function(e){sB(n.VERBOSE,{context:"P4Rules.getListMoves",node:e});for(var t=e.gameState,r=[],i=0;i<7;i++)if(t.getPieceAtXY(i,0)===A7.NONE){var a=jue.of(i);r.push(a)}return r}},{key:"getBoardValue",value:function(e){return sB(n.VERBOSE,{text:"P4Rules.getBoardValue called",board:e.getCopiedBoard()}),n.getBoardValueFromScratch(e)}}]),n}(yte);return e.VERBOSE=!1,e}(),Que=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){return Kue.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=e.gameState;return sB(Kue.VERBOSE,{text:"P4Rules instance methods getBoardValue called",board:t.getCopiedBoard()}),Kue.getBoardValue(t)}}]),n}(tte),Xue=A7.NONE,Jue=A7.ZERO,ece=A7.ONE,tce=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(Us||(Us=_g(["Goal of the game"]))),$localize(Vs||(Vs=_g(["The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.\n        The first player plays Dark, the second plays Light.\n        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally)."]))),Wue.getInitialState()),wte.anyMove($localize(Bs||(Bs=_g(["Dropping a piece"]))),$localize(zs||(zs=_g(["Click on any space in any column."]))),Wue.getInitialState(),jue.THREE,$localize(Hs||(Hs=_g(["As you can see, the piece falls at the bottom of the column."])))),wte.fromMove($localize(Gs||(Gs=_g(["Victory"]))),$localize($s||($s=_g(["You're playing Dark.\n        Place your piece so that you create a horizontal alignment of 4 of your pieces."]))),new Wue([[Xue,Xue,Xue,Xue,Xue,Xue,Xue],[Xue,Xue,Xue,Xue,Xue,Xue,Xue],[Xue,Xue,Xue,Xue,Xue,Xue,Xue],[Xue,Xue,Xue,ece,Xue,Xue,Xue],[Xue,Xue,Xue,ece,Xue,Xue,Xue],[Xue,Xue,Jue,Jue,Jue,ece,Xue]],0),[jue.of(1)],$localize(Zs||(Zs=_g(["You won!"]))),$localize(qs||(qs=_g(["Failed, you have not aligned 4 pieces and missed an opportunity to win."])))),wte.fromMove($localize(Ws||(Ws=_g(["Other victory"]))),$localize(js||(js=_g(["You can also align 4 pieces diagonally or vertically."]))),new Wue([[Xue,Xue,Xue,Xue,Xue,Xue,Xue],[Xue,Xue,Xue,Xue,Xue,Xue,Xue],[Xue,Xue,Xue,Xue,Xue,Xue,Xue],[Xue,Xue,Xue,Jue,ece,Xue,Xue],[Xue,Xue,Jue,Jue,ece,Xue,Xue],[Xue,Jue,ece,Jue,Jue,Xue,Xue]],0),[jue.of(3),jue.of(4)],$localize(Ys||(Ys=_g(["You won!"]))),$localize(Ks||(Ks=_g(["Failed, you have not aligned 4 pieces and missed an opportunity to win."]))))]});function nce(e,t){if(1&e&&(cC(),nP(0,"circle",8)),2&e){var n=fP().index,r=fP().index,i=fP();Xb("ngClass",i.getSquareFillClass(n,r)),$b("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function rce(e,t){if(1&e){var n=aP();cC(),eP(0,"g",5),uP("click",function(){var e=Nk(n).index;return fP(2).onClick(e)}),nP(1,"rect",6),Yb(2,nce,1,4,"circle",7),tP()}if(2&e){var r=t.$implicit,i=t.index,a=fP().index,o=fP();dP("id","click_",i,""),pE(1),$b("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),pE(1),Xb("ngIf",r!==o.EMPTY)}}function ice(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,rce,3,6,"g",4),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}function ace(e,t){if(1&e&&(cC(),nP(0,"rect",9)),2&e){var n=fP();$b("x",n.SPACE_SIZE*n.last.get().x)("y",n.SPACE_SIZE*n.last.get().y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function oce(e,t){if(1&e&&(cC(),nP(0,"rect",10)),2&e){var n=t.$implicit,r=fP();vP("id","victory_coord_",n.x,"_",n.y,""),$b("x",r.SPACE_SIZE*n.x)("y",r.SPACE_SIZE*n.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}var sce=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).EMPTY=A7.NONE,r.victoryCoords=[],r.rules=new Kue(Wue),r.availableMinimaxes=[new Que(r.rules,"P4Minimax")],r.encoder=jue.encoder,r.tutorial=(new tce).tutorial,r.updateBoard(),r}return Wg(n,[{key:"onClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=jue.of(e),n.next=6,t.chooseMove(i,t.rules.node.gameState);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState,t=this.rules.node.move;this.victoryCoords=Kue.getVictoriousCoords(e),this.board=e.board,t.isPresent()?this.showLastMove():this.hideLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move,t=Kue.getLowestUnoccupiedCase(this.rules.node.gameState.board,e.get().x)+1;this.last=fB.of(new Zee(e.get().x,t))}},{key:"hideLastMove",value:function(){this.last=fB.empty()}},{key:"getSquareFillClass",value:function(e,t){return[this.getPlayerClass(this.board[t][e])]}}]),n}(nne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-p4"]],features:[Rb],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),Yb(1,ice,2,1,"g",1),Yb(2,ace,1,4,"rect",2),Yb(3,oce,1,6,"rect",3),tP()),2&e&&(pE(1),Xb("ngForOf",t.board),pE(1),Xb("ngIf",t.last.isPresent()),pE(1),Xb("ngForOf",t.victoryCoords))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),uce=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Zg(this,n),(a=t.call(this,e,r)).blockTurned=i,a.turnedClockwise=o,a.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+a.coord.toString());return Lg(a)}return Wg(n,[{key:"toString",value:function(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}},{key:"equals",value:function(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}],[{key:"withRotation",value:function(e,t,r,i){if(r<0||3<r)throw new Error("This block do not exist: "+r);return new n(e,t,fB.of(r),i)}},{key:"rotationless",value:function(e,t){return new n(e,t,fB.empty())}}]),n}(cte);uce.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encodeMove",value:function(e){var t={coord:Zee.encoder.encode(e.coord)};return e.blockTurned.isPresent()&&(t.blockTurned=e.blockTurned.get(),t.turnedClockwise=e.turnedClockwise),t}},{key:"decodeMove",value:function(e){var t=e,n=Zee.encoder.decode(t.coord),r=fB.ofNullable(t.blockTurned);if(r.isPresent()){var i=t.turnedClockwise;return uce.withRotation(n.x,n.y,r.get(),i)}return uce.rotationless(n.x,n.y)}}]),n}(O7));var cce=function(){var e=Wg(function e(){Zg(this,e)});return e.CANNOT_ROTATE_NEUTRAL_BLOCK=function(){return $localize(Qs||(Qs=_g(["If the quadrant to turn is neutral, please just use move without rotation."])))},e.MUST_CHOOSE_BLOCK_TO_ROTATE=function(){return $localize(Xs||(Xs=_g(["No quadrant is neutral, you must pick a quadrant to rotate."])))},e}(),lce=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e,r)).neutralBlocks=i.getBlocksNeutralities(),i}return Wg(n,[{key:"getBlocksNeutralities",value:function(){for(var e=[],t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}},{key:"getBlockNeutrality",value:function(e){var t=n.getBlockCenter(e),r=this.getPieceAt(t.getNext(Hee.UP,1)),i=this.getPieceAt(t.getNext(Hee.UP_LEFT,1));return this.getPieceAt(t.getNext(Hee.RIGHT,1))===r&&this.getPieceAt(t.getNext(Hee.DOWN,1))===r&&this.getPieceAt(t.getNext(Hee.LEFT,1))===r&&this.getPieceAt(t.getNext(Hee.UP_RIGHT,1))===i&&this.getPieceAt(t.getNext(Hee.DOWN_RIGHT,1))===i&&this.getPieceAt(t.getNext(Hee.DOWN_LEFT,1))===i}},{key:"applyLegalDrop",value:function(e){var t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new n(t,this.turn)}},{key:"applyLegalMove",value:function(e){var t=this.applyLegalDrop(e),r=t.getCopiedBoard();if(e.blockTurned.isPresent()){var i=n.getBlockCenter(e.blockTurned.get());if(e.turnedClockwise){var a,o=Hg(n.ROTATION_MAP);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=s[0].getNext(i),c=s[1].getNext(i),l=t.getPieceAt(u);r[c.y][c.x]=l}}catch(y){o.e(y)}finally{o.f()}}else{var f,h=Hg(n.ROTATION_MAP);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=d[1].getNext(i),p=d[0].getNext(i),g=t.getPieceAt(v);r[p.y][p.x]=g}}catch(y){h.e(y)}finally{h.f()}}}return new n(r,this.turn+1)}},{key:"blockIsNeutral",value:function(e){return this.neutralBlocks.includes(e)}}],[{key:"getInitialState",value:function(){return new n(D7.createTable(6,6,A7.NONE),0)}},{key:"getBlockCenter",value:function(e){return new Zee(1+(e%2==0?0:3),1+(e<2?0:3))}}]),n}(ote);lce.ROTATION_MAP=[[new Zee(-1,-1),new Zee(1,-1)],[new Zee(0,-1),new Zee(1,0)],[new Zee(1,-1),new Zee(1,1)],[new Zee(1,0),new Zee(0,1)],[new Zee(1,1),new Zee(-1,1)],[new Zee(0,1),new Zee(-1,0)],[new Zee(-1,1),new Zee(-1,-1)],[new Zee(-1,0),new Zee(0,-1)]];var fce=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).isPlayer())return hB.failure(ete.MUST_LAND_ON_EMPTY_SPACE());var n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return hB.failure(cce.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){var r=e.blockTurned.get();if(n.neutralBlocks.includes(r))return hB.failure(cce.CANNOT_ROTATE_NEUTRAL_BLOCK())}return hB.success(void 0)}},{key:"getVictoryCoords",value:function(e){var t,r=[],i=Hg(n.VICTORY_SOURCE);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=e.getPieceAt(a[0]),s=[a[0]];if(o.isPlayer()){for(var u=a[0].getNext(a[1]),c=!0,l=0;l<3&&c;l++)e.getPieceAt(u)!==o?c=!1:(s.push(u),u=u.getNext(a[1]));if(c&&(e.getPieceAt(u)===o&&(s.push(u),r=r.concat(s)),a[2])){var f=a[0].getPrevious(a[1],1);e.getPieceAt(f)===o&&(s.push(f),r=r.concat(s))}}}}catch(h){i.e(h)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=this.getVictoryCoords(t),r=[!1,!1],i=0;i<n.length;i+=5)r[t.getPieceAt(n[i]).value]=!0;return!0===r[0]?!0===r[1]?gte.DRAW:gte.ZERO_WON:!0===r[1]?gte.ONE_WON:36===t.turn?gte.DRAW:gte.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=fB.of(new n(lce))),n.singleton.get()}}]),n}(yte);fce.singleton=fB.empty(),fce.VICTORY_SOURCE=[[new Zee(1,0),new Vee(1,1),!1],[new Zee(0,1),new Vee(1,1),!1],[new Zee(4,0),new Vee(-1,1),!1],[new Zee(5,1),new Vee(-1,1),!1],[new Zee(1,1),new Vee(1,1),!0],[new Zee(4,1),new Vee(-1,1),!0],[new Zee(0,1),new Vee(0,1),!0],[new Zee(1,1),new Vee(0,1),!0],[new Zee(2,1),new Vee(0,1),!0],[new Zee(3,1),new Vee(0,1),!0],[new Zee(4,1),new Vee(0,1),!0],[new Zee(5,1),new Vee(0,1),!0],[new Zee(1,0),new Vee(1,0),!0],[new Zee(1,1),new Vee(1,0),!0],[new Zee(1,2),new Vee(1,0),!0],[new Zee(1,3),new Vee(1,0),!0],[new Zee(1,4),new Vee(1,0),!0],[new Zee(1,5),new Vee(1,0),!0]];var hce=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=[],r=e.gameState.neutralBlocks;if(0===e.gameState.turn)return n.FIRST_TURN_MOVES;var i,a=Hg(this.getLegalDrops(e.gameState));try{for(a.s();!(i=a.n()).done;){var o,s=i.value,u=uce.rotationless(s.x,s.y),c=e.gameState.applyLegalDrop(u),l=Hg(this.getLegalRotations(c,r));try{for(l.s();!(o=l.n()).done;){var f=o.value;t.push(uce.withRotation(s.x,s.y,f[0],f[1]))}}catch(h){l.e(h)}finally{l.f()}0===c.neutralBlocks.length==0&&t.push(u)}}catch(h){a.e(h)}finally{a.f()}return t}},{key:"getLegalDrops",value:function(e){for(var t=[],n=0;n<6;n++)for(var r=0;r<6;r++){var i=new Zee(r,n);e.getPieceAt(i)===A7.NONE&&t.push(i)}return t}},{key:"getLegalRotations",value:function(e,t){for(var n=0===e.neutralBlocks.length,r=[],i=0;i<4;i++)!1===e.blockIsNeutral(i)&&(t.includes(i)?n&&r.push([i,!0]):r.push([i,!0],[i,!1]));return r}},{key:"getBoardValue",value:function(e){return new nte(fce.get().getGameStatus(e).toBoardValue())}}]),n}(tte);hce.FIRST_TURN_MOVES=[uce.rotationless(0,0),uce.rotationless(1,0),uce.rotationless(2,0),uce.rotationless(0,1),uce.rotationless(1,1),uce.rotationless(0,2)];var dce=A7.NONE,vce=A7.ZERO,pce=A7.ONE,gce=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(Js||(Js=_g(["Initial board"]))),$localize(eu||(eu=_g(["The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate."]))),lce.getInitialState()),wte.informational($localize(tu||(tu=_g(["Goal of the game"]))),$localize(nu||(nu=_g(["The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins."]))),new lce([[vce,dce,dce,vce,pce,dce],[vce,pce,dce,dce,dce,dce],[vce,dce,pce,dce,dce,dce],[vce,dce,dce,dce,dce,pce],[vce,dce,dce,dce,pce,dce],[dce,dce,dce,dce,dce,dce]],10)).withPreviousMove(uce.withRotation(0,0,0,!1)),wte.fromPredicate($localize(ru||(ru=_g(["Simple move"]))),$localize(iu||(iu=_g(["At their turn, players put a piece on the board and possibly rotate one quadrant.\n        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.\n        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>\n        Do it."]))),new lce([[dce,dce,dce,dce,dce,dce],[dce,vce,dce,dce,pce,dce],[dce,dce,dce,dce,dce,dce],[dce,dce,dce,dce,dce,dce],[dce,pce,dce,dce,vce,dce],[dce,dce,dce,dce,dce,dce]],10),uce.rotationless(2,2),function(e,t,n){return e.blockTurned.isPresent()?pB.failure($localize(au||(au=_g(["You have made a move with a rotation. This tutorial step is about moves without rotations!"])))):pB.SUCCESS},$localize(ou||(ou=_g(["Congratulations!"])))),wte.fromPredicate($localize(su||(su=_g(["Move with rotation"]))),$localize(uu||(uu=_g(["After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>\n        Click on one of them and see the rotation!"]))),new lce([[dce,dce,dce,dce,dce,dce],[dce,vce,dce,dce,pce,dce],[dce,dce,dce,dce,dce,dce],[dce,dce,dce,dce,dce,dce],[dce,pce,dce,dce,vce,dce],[dce,dce,dce,dce,dce,dce]],10),uce.withRotation(0,0,0,!0),function(e,t,n){return e.blockTurned.isPresent()?pB.SUCCESS:pB.failure($localize(cu||(cu=_g(["You made a move without rotation, try again!"]))))},$localize(lu||(lu=_g(["Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation."]))))]});function yce(e,t){if(1&e){var n=aP();cC(),rP(0),eP(1,"circle",9),uP("click",function(){var e=Nk(n).$implicit,t=fP().$implicit,r=fP().index,i=fP().index;return fP().onClick(3*r+e,3*i+t)}),tP(),iP()}if(2&e){var r=t.$implicit,i=fP().$implicit,a=fP(),o=a.index,s=a.$implicit,u=fP(),c=u.index,l=u.$implicit,f=fP();pE(1),vP("id","click_",3*o+r,"_",3*c+i,""),Xb("ngClass",f.getSquareClasses(3*o+r,3*c+i)),$b("cx",s+2*f.STROKE_WIDTH+(r+.5)*f.SPACE_SIZE)("cy",l+2*f.STROKE_WIDTH+(i+.5)*f.SPACE_SIZE)("r",(f.SPACE_SIZE-f.STROKE_WIDTH)/2)}}var mce=function(){return[0,1,2]};function kce(e,t){1&e&&(cC(),rP(0),Yb(1,yce,2,6,"ng-container",3),iP()),2&e&&(pE(1),Xb("ngForOf",aT(1,mce)))}function Cce(e,t){if(1&e&&(cC(),rP(0),nP(1,"rect",8),Yb(2,kce,2,2,"ng-container",3),iP()),2&e){var n=t.$implicit,r=t.index,i=fP(),a=i.index,o=i.$implicit,s=fP();pE(1),Xb("ngClass",s.getBlockClasses(r,a)),$b("x",s.STROKE_WIDTH+n)("y",s.STROKE_WIDTH+o)("rx",3*s.STROKE_WIDTH)("ry",3*s.STROKE_WIDTH)("width",s.BLOCK_WIDTH)("height",s.BLOCK_WIDTH),pE(1),Xb("ngForOf",aT(8,mce))}}var wce=function(e){return[0,e]};function _ce(e,t){if(1&e&&(cC(),rP(0),Yb(1,Cce,3,9,"ng-container",3),iP()),2&e){var n=fP();pE(1),Xb("ngForOf",oT(1,wce,n.BLOCK_SEPARATION))}}function Ece(e,t){if(1&e&&(cC(),nP(0,"circle",10)),2&e){var n=fP();vP("id","currentDrop_",n.currentDrop.get().x,"_",n.currentDrop.get().y,""),Xb("ngClass",n.getPlayerClass(n.rules.node.gameState.getCurrentPlayer())),$b("cx",n.getCenter(n.currentDrop.get().x))("cy",n.getCenter(n.currentDrop.get().y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)}}function bce(e,t){if(1&e){var n=aP();cC(),eP(0,"path",11),uP("click",function(){var e=Nk(n).$implicit;return fP().rotate(e)}),tP()}if(2&e){var r=t.$implicit,i=fP();vP("id","rotate_",r[1],"_",r[2]?"clockwise":"counterclockwise",""),$b("d",r[0])("stroke-width",2*i.STROKE_WIDTH)}}function Pce(e,t){if(1&e&&(cC(),nP(0,"circle",12)),2&e){var n=t.$implicit,r=fP();vP("id","victoryCoord_",n.x,"_",n.y,""),Xb("ngClass",r.getSquareClasses(n.x,n.y)),$b("cx",r.getCenter(n.x))("cy",r.getCenter(n.y))("r",(r.SPACE_SIZE-r.STROKE_WIDTH)/2)("stroke-width",r.STROKE_WIDTH)}}function Sce(e,t){if(1&e){var n=aP();cC(),eP(0,"g",13),uP("click",function(){return Nk(n),fP().skipRotation()}),nP(1,"circle",14),nP(2,"line",15),tP()}if(2&e){var r=fP();pE(1),$b("cx",r.BLOCK_SEPARATION)("cy",r.BLOCK_SEPARATION)("r",.75*r.SPACE_SIZE)("stroke-width",2*r.STROKE_WIDTH),pE(1),$b("x1",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("y1",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("x2",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("y2",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("stroke-width",2*r.STROKE_WIDTH)}}var Oce=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).arrows=[],r.victoryCoords=[],r.rules=new fce(lce),r.availableMinimaxes=[new hce(r.rules,"PentagoMinimax")],r.encoder=uce.encoder,r.tutorial=(new gce).tutorial,r.BLOCK_WIDTH=3*r.SPACE_SIZE+2*r.STROKE_WIDTH,r.BLOCK_SEPARATION=r.BLOCK_WIDTH+2*r.STROKE_WIDTH,r.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*r.SPACE_SIZE,r.ARROWS=r.generateArrowsCoord(),r.updateBoard(),r}return Wg(n,[{key:"updateBoard",value:function(){this.board=this.rules.node.gameState.getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.rules.node.gameState),this.showLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move;if(this.cancelMoveAttempt(),e.isAbsent())this.hidePreviousMove();else{var t=e.get();this.movedBlock=t.blockTurned;var n=new Zee(t.coord.x%3-1,t.coord.y%3-1);if(t.blockTurned.isPresent()&&!1===n.equals(new Zee(0,0))&&this.coordBelongToBlock(t)){var r;r=t.turnedClockwise?oB.getNonNullable(lce.ROTATION_MAP.find(function(e){return e[0].equals(n)}))[1]:oB.getNonNullable(lce.ROTATION_MAP.find(function(e){return e[1].equals(n)}))[0];var i=t.blockTurned.get();r=r.getNext(new Vee(i%2==0?1:4,i<2?1:4),1),this.lastDrop=fB.of(r)}else this.lastDrop=fB.of(t.coord)}}},{key:"coordBelongToBlock",value:function(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}},{key:"hidePreviousMove",value:function(){this.lastDrop=fB.empty(),this.movedBlock=fB.empty(),this.victoryCoords=[]}},{key:"generateArrowsCoord",value:function(){var e=2*this.BLOCK_SEPARATION,t=this.SPACE_SIZE,n=.5*this.SPACE_SIZE;return[["M "+n+" 0 q "+t+" -"+t+" "+2*t+" 0",0,!0],["M 0 "+n+" q -"+t+" "+t+" 0 "+2*t,0,!1],["M "+e+" "+n+" q "+t+" "+t+" 0 "+2*t,1,!0],["M "+(e-n)+" 0 q -"+t+" -"+t+" -"+2*t+" 0",1,!1],["M 0 "+(e-n)+" q -"+t+" -"+t+" 0 -"+2*t,2,!0],["M "+n+" "+e+" q "+t+" "+t+" "+2*t+" 0",2,!1],["M "+(e-n)+" "+e+" q -"+t+" "+t+" -"+2*t+" 0",3,!0],["M "+e+" "+(e-n)+"  q "+t+" -"+t+" 0 -"+2*t,3,!1]]}},{key:"cancelMoveAttempt",value:function(){this.arrows=[],this.currentDrop=fB.empty(),this.canSkipRotation=!1}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(!n.board[t][e].isPlayer()){r.next=5;break}return r.abrupt("return",n.cancelMove(ete.MUST_LAND_ON_EMPTY_SPACE()));case 5:if(a=uce.rotationless(e,t),o=n.rules.node.gameState,4!==(s=o.applyLegalDrop(a)).neutralBlocks.length){r.next=8;break}return r.abrupt("return",n.chooseMove(a,o));case 8:return u=n.rules.getGameStatus(n.rules.node),r.abrupt("return",(n.canSkipRotation=s.neutralBlocks.length>0&&!1===u.isEndGame,n.currentDrop=fB.of(new Zee(e,t)),n.displayArrows(s.neutralBlocks),pB.SUCCESS));case 10:case"end":return r.stop()}},r)}))()}},{key:"getCenter",value:function(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}},{key:"displayArrows",value:function(e){var t=this;this.arrows=[];for(var n=function(n){if(!1===e.includes(n)){var r=t.ARROWS.filter(function(e){return e[1]===n});t.arrows=t.arrows.concat(r)}},r=0;r<4;r++)n(r)}},{key:"getBlockClasses",value:function(e,t){return this.movedBlock.equalsValue(e+2*t)?["moved"]:[]}},{key:"getSquareClasses",value:function(e,t){var n=[],r=this.getPlayerClass(this.board[t][e]);return n.push(r),this.lastDrop.equalsValue(new Zee(e,t))&&n.push("last-move"),n}},{key:"rotate",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#rotate_"+e[1]+"_"+(e[2]?"clockwise":"counterclockwise"))).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=t.currentDrop.get(),a=uce.withRotation(i.x,i.y,e[1],e[2]),n.abrupt("return",t.chooseMove(a,t.rules.node.gameState));case 5:case"end":return n.stop()}},n)}))()}},{key:"skipRotation",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.canUserPlay("#skipRotation")).isFailure()){t.next=3;break}return t.abrupt("return",e.cancelMove(n.getReason()));case 3:return r=e.currentDrop.get(),i=uce.rotationless(r.x,r.y),t.abrupt("return",e.chooseMove(i,e.rules.node.gameState));case 5:case"end":return t.stop()}},t)}))()}}]),n}(nne);return e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-pentago"]],features:[Rb],decls:9,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-60 -60 780 780"],["id","arrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#arrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#arrowhead)",1,"no-fill",3,"id","click"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),eP(1,"defs"),eP(2,"marker",1),nP(3,"polygon",2),tP(),tP(),Yb(4,_ce,2,3,"ng-container",3),Yb(5,Ece,1,6,"circle",4),Yb(6,bce,1,4,"path",5),Yb(7,Pce,1,7,"circle",6),Yb(8,Sce,3,9,"g",7),tP()),2&e&&(pE(4),Xb("ngForOf",oT(5,wce,t.BLOCK_SEPARATION)),pE(1),Xb("ngIf",t.currentDrop.isPresent()),pE(1),Xb("ngForOf",t.arrows),pE(1),Xb("ngForOf",t.victoryCoords),pE(1),Xb("ngIf",t.canSkipRotation))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Tce=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;if(Zg(this,n),(a=t.call(this,e,r)).z=i,e<0||e>3)throw new Error("PylosCoord: Invalid X: ".concat(e,"."));if(r<0||r>3)throw new Error("PylosCoord: Invalid Y: ".concat(r,"."));if(i<0||i>3)throw new Error("PylosCoord: Invalid Z: ".concat(i,"."));var o=4-i;if(a.isNotInRange(o,o))throw new Error(a.toString()+" is not in range.");return Lg(a)}return Wg(n,[{key:"toString",value:function(){return"PylosCoord"+this.toShortString()}},{key:"toShortString",value:function(){return"("+this.x+", "+this.y+", "+this.z+")"}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"isUpperThan",value:function(e){return this.z>e.z}},{key:"getLowerPieces",value:function(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");var e=this.z-1;return[new n(this.x,this.y,e),new n(this.x+1,this.y,e),new n(this.x,this.y+1,e),new n(this.x+1,this.y+1,e)]}},{key:"getHigherCoords",value:function(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");var e=this.z+1,t=new Zee(this.x-1,this.y-1),r=new Zee(this.x,this.y-1),i=new Zee(this.x-1,this.y),a=new Zee(this.x,this.y),o=4-e;return[t,r,i,a].filter(function(e){return e.isInRange(o,o)}).map(function(t){return new n(t.x,t.y,e)})}},{key:"getNextValid",value:function(e){var t=new Zee(this.x,this.y).getNext(e),r=4-this.z;return t.isNotInRange(r,r)?fB.empty():fB.of(new n(t.x,t.y,this.z))}}],[{key:"encodeOptional",value:function(e){return e.isPresent()?n.encode(e.get())+1:0}},{key:"encode",value:function(e){return 16*e.x+4*e.y+e.z}},{key:"decodeToOptional",value:function(e){return 0===e?fB.empty():fB.of(n.decode(e-1))}},{key:"decode",value:function(e){var t=e%4;e-=t;var r=(e/=4)%4;return e-=r,new n(e/=4,r,t)}}]),n}(Zee),Ice=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this)).startingCoord=e,o.landingCoord=r,o.firstCapture=i,o.secondCapture=a,o}return Wg(n,[{key:"isClimb",value:function(){return this.startingCoord.isPresent()}},{key:"toString",value:function(){var e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}},{key:"equals",value:function(e){return e===this||!!(this.startingCoord.equals(e.startingCoord)&&this.landingCoord.equals(e.landingCoord)&&this.firstCapture.equals(e.firstCapture)&&this.secondCapture.equals(e.secondCapture))}}],[{key:"fromClimb",value:function(e,t,r){var i=fB.of(e),a=n.checkCaptures(r),o=new n(i,t,a.firstCapture,a.secondCapture);if(!t.isUpperThan(e))throw new Error("PylosMove: When piece move it must move upward.");return o}},{key:"checkCaptures",value:function(e){var t=fB.empty(),n=fB.empty();if(e.length>0&&(t=fB.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=fB.of(e[1]),e[1].isUpperThan(e[0])&&(t=fB.of(e[1]),n=fB.of(e[0])),e.length>2)throw new Error("PylosMove: can't capture that much piece.")}return{firstCapture:t,secondCapture:n}}},{key:"fromDrop",value:function(e,t){var r=fB.empty(),i=n.checkCaptures(t);return new n(r,e,i.firstCapture,i.secondCapture)}},{key:"changeCapture",value:function(e,t){var r=n.checkCaptures(t);return new n(e.startingCoord,e.landingCoord,r.firstCapture,r.secondCapture)}}]),n}(ute);Ice.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 17575999}},{key:"encodeNumber",value:function(e){var t=Tce.encode(e.landingCoord),n=Tce.encodeOptional(e.startingCoord),r=Tce.encodeOptional(e.firstCapture);return 270400*Tce.encodeOptional(e.secondCapture)+4160*r+64*n+t}},{key:"decodeNumber",value:function(e){var t=Tce.decode(e%64);e-=e%64;var n=Tce.decodeToOptional((e/=64)%65);e-=e%65;var r=Tce.decodeToOptional((e/=65)%65);e-=e%65;var i=Tce.decodeToOptional(e/=65);return new Ice(n,t,r,i)}}]),n}(T7));var Ace=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,r)).boards=e,i}return Wg(n,[{key:"getPieceAt",value:function(e){return this.boards[e.z][e.y][e.x]}},{key:"applyLegalMove",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=[];return r.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&r.push({coord:e.startingCoord.get(),value:A7.NONE}),e.firstCapture.isPresent()&&r.push({coord:e.firstCapture.get(),value:A7.NONE}),e.secondCapture.isPresent()&&r.push({coord:e.secondCapture.get(),value:A7.NONE}),t=n?this.turn+1:this.turn,this.setBoardAts(r,t)}},{key:"setBoardAts",value:function(e,t){var r,i=[D7.copyBiArray(this.boards[0]),D7.copyBiArray(this.boards[1]),D7.copyBiArray(this.boards[2]),D7.copyBiArray(this.boards[3])],a=Hg(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.coord;i[s.z][s.y][s.x]=o.value}}catch(u){a.e(u)}finally{a.f()}return new n(i,t)}},{key:"isLandable",value:function(e){if(this.getPieceAt(e).isPlayer())return!1;if(0===e.z)return!0;var t,n=Hg(e.getLowerPieces());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r)===A7.NONE)return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"isSupporting",value:function(e){if(3===e.z)return!1;var t,n=Hg(e.getHigherCoords());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r).isPlayer())return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"getPiecesRepartition",value:function(){var e={};e[A7.NONE.value]=0,e[R7.ZERO.value]=0,e[R7.ONE.value]=0;for(var t=0;t<3;t++)for(var n=0;n<4-t;n++)for(var r=0;r<4-t;r++){var i=new Tce(r,n,t),a=this.getPieceAt(i);e[a.value]=1+e[a.value]}return e}},{key:"removeCoord",value:function(e){return this.setBoardAts([{coord:e,value:A7.NONE}],this.turn)}},{key:"applyDrop",value:function(e){var t={coord:e,value:this.getCurrentPlayer()};return this.setBoardAts([t],this.turn)}},{key:"getFreeToMoves",value:function(){for(var e=[],t=this.getCurrentPlayer(),r=0;r<=2;r++){var i,a=n.getLevelRange(r),o=Hg(a);try{for(o.s();!(i=o.n()).done;){var s,u=i.value,c=Hg(a);try{for(c.s();!(s=c.n()).done;){var l=s.value,f=new Tce(l,u,r);this.getPieceAt(f).equals(t)&&!1===this.isSupporting(f)&&e.push(f)}}catch(h){c.e(h)}finally{c.f()}}}catch(h){o.e(h)}finally{o.f()}}return e}}],[{key:"getInitialState",value:function(){return new n([D7.createTable(4,4,A7.NONE),D7.createTable(3,3,A7.NONE),D7.createTable(2,2,A7.NONE),[[A7.NONE]]],0)}},{key:"getLevelRange",value:function(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return oB.expectToBe(e,2),[0,1]}}}]),n}(ate),Rce=function(){var e=Wg(function e(){Zg(this,e)});return e.MUST_MOVE_UPWARD=function(){return $localize(fu||(fu=_g(["You must move your pieces upward."])))},e.SHOULD_HAVE_SUPPORTING_PIECES=function(){return $localize(hu||(hu=_g(["Your piece must land on the board or on 4 other pieces."])))},e.CANNOT_MOVE_SUPPORTING_PIECE=function(){return $localize(du||(du=_g(["You cannot move a supporting piece."])))},e.CANNOT_CAPTURE=function(){return $localize(vu||(vu=_g(["You cannot capture."])))},e.INVALID_FIRST_CAPTURE=function(){return $localize(pu||(pu=_g(["Your first capture is invalid."])))},e.INVALID_SECOND_CAPTURE=function(){return $localize(gu||(gu=_g(["Your second capture is invalid."])))},e}(),Mce=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){var n=this.isLegalStartingCoord(e,t);if(n.isFailure())return hB.failure(n.getReason());var r=n.get(),i=this.isLegalLandingCoord(e,r);if(i.isFailure())return hB.failure(i.getReason());var a=i.get(),o=this.isLegalCaptures(e,a);return o.isFailure()?o:hB.success(void 0)}},{key:"isLegalStartingCoord",value:function(e,t){var n=t.getCurrentOpponent();if(e.startingCoord.isPresent()){var r=e.startingCoord.get(),i=t.getPieceAt(r);if(i===n)return hB.failure(ete.CANNOT_CHOOSE_OPPONENT_PIECE());if(i===A7.NONE)return hB.failure(ete.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===r.getHigherCoords().filter(function(e){return t.getPieceAt(e).isPlayer()}).length){var a=t.removeCoord(e.startingCoord.get());return hB.success(a)}return hB.failure(Rce.CANNOT_MOVE_SUPPORTING_PIECE())}return hB.success(t)}},{key:"isLegalLandingCoord",value:function(e,t){return t.getPieceAt(e.landingCoord).isPlayer()?hB.failure(ete.MUST_LAND_ON_EMPTY_SPACE()):t.isLandable(e.landingCoord)?hB.success(t.applyDrop(e.landingCoord)):hB.failure(Rce.SHOULD_HAVE_SUPPORTING_PIECES())}},{key:"isLegalCaptures",value:function(e,t){if(e.firstCapture.isAbsent())return hB.success(void 0);if(!1===n.canCapture(t,e.landingCoord))return hB.failure(Rce.CANNOT_CAPTURE());if(n.isValidCapture(t,e,e.firstCapture.get())){var r=t.removeCoord(e.firstCapture.get());return e.secondCapture.isAbsent()||n.isValidCapture(r,e,e.secondCapture.get())?hB.success(void 0):hB.failure(Rce.INVALID_SECOND_CAPTURE())}return hB.failure(Rce.INVALID_FIRST_CAPTURE())}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getStateInfo",value:function(e){for(var t=[],n=[],r=0;r<3;r++)for(var i=0;i<4-r;i++)for(var a=0;a<4-r;a++){var o=new Tce(a,i,r);e.getPieceAt(o)===e.getCurrentPlayer()&&!1===e.isSupporting(o)&&t.push(o),e.isLandable(o)&&n.push(o)}return{freeToMove:t,landable:n}}},{key:"getClimbingMoves",value:function(e){var t,n=[],r=Hg(e.freeToMove);try{var i=function(){var r,i=t.value,a=Hg(e.landable);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.isUpperThan(i)&&!1===o.getLowerPieces().some(function(e){return i.equals(e)})){var s=Ice.fromClimb(i,o,[]);n.push(s)}}}catch(u){a.e(u)}finally{a.f()}};for(r.s();!(t=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getDropMoves",value:function(e){var t,n=[],r=Hg(e.landable);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=Ice.fromDrop(i,[]);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"canCapture",value:function(e,t){for(var n=e.getCurrentPlayer(),r=0,i=[Gee.UP,Gee.DOWN];r<i.length;r++){var a=i[r],o=t.getNextValid(a);if(o.isPresent()&&e.getPieceAt(o.get())===n)for(var s=0,u=[Gee.LEFT,Gee.RIGHT];s<u.length;s++){var c=u[s],l=o.get().getNextValid(c);if(l.isPresent()&&e.getPieceAt(l.get())===n){var f=a.getOpposite(),h=l.get().getNextValid(f).get();if(e.getPieceAt(h)===n)return!0}}}return!1}},{key:"getPossibleCaptures",value:function(e){var t,n=new ite,r=Hg(e.getFreeToMoves());try{for(r.s();!(t=r.n()).done;){var i=t.value;n.add(new ite([i]));var a,o=Hg(e.removeCoord(i).getFreeToMoves());try{for(o.s();!(a=o.n()).done;){var s=a.value,u=new ite([i,s]);n.add(u)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){r.e(c)}finally{r.f()}return n}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isValidCapture",value:function(e,t,n){var r=e.getCurrentPlayer();return!(!n.equals(t.landingCoord)&&e.getPieceAt(n)!==r)&&0===n.getHigherCoords().filter(function(n){return e.getPieceAt(n).isPlayer()&&!1===n.equals(t.firstCapture.get())}).length}},{key:"getGameStatus",value:function(e){var t=e.gameState.getPiecesRepartition();return 15===t[R7.ZERO.value]?gte.ONE_WON:15===t[R7.ONE.value]?gte.ZERO_WON:gte.ONGOING}}]),n}(yte),xce=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){return n.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=Mce.getGameStatus(e);if(t.isEndGame)return new nte(t.toBoardValue());var n=e.gameState.getPiecesRepartition();return new nte(n[R7.ZERO.value]-n[R7.ONE.value])}}],[{key:"getListMoves",value:function(e){var t,n=e.gameState,r=[],i=Mce.getStateInfo(n),a=Mce.getClimbingMoves(i),o=Mce.getDropMoves(i),s=Hg(a.concat(o));try{for(s.s();!(t=s.n()).done;){var u=t.value,c=n.applyLegalMove(u,!1),l=new ite;Mce.canCapture(c,u.landingCoord)?l=Mce.getPossibleCaptures(c):r.push(u);var f,h=Hg(l);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=Ice.changeCapture(u,d.toList());r.push(v)}}catch(p){h.e(p)}finally{h.f()}}}catch(p){s.e(p)}finally{s.f()}return r}}]),n}(tte),Nce=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t=xce.getListMoves(e);return this.orderMoves(t)}},{key:"orderMoves",value:function(e){return e.sort(function(e,t){var r=12*n.countStoneUsed(e),i=12*n.countStoneUsed(t);return r+n.sumMoveEmplacementByValue(e)-(i+n.sumMoveEmplacementByValue(t))})}}],[{key:"countStoneUsed",value:function(e){var t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}},{key:"sumMoveEmplacementByValue",value:function(e){var t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}}]),n}(xce),Dce=A7.NONE,Lce=A7.ZERO,Fce=A7.ONE,Uce=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(yu||(yu=_g(["Goal of the game"]))),$localize(mu||(mu=_g(["At Pylos, the goal is to be the last to play.\n        To do this, you have to save up your pieces.\n        As soon as a player puts its last piece, that player loses the game immediately.\n        Here is what the initial board looks like, it is a board of 4 x 4 squares.\n        This board will become a pyramid, little by little.\n        It will be filled by the pieces of your stock. Each player has 15 pieces."]))),Ace.getInitialState()),wte.anyMove($localize(ku||(ku=_g(["Dropping a piece"]))),$localize(Cu||(Cu=_g(["When it is your turn, you can always drop one of your piece on an empty square.\n        The gray squares are where you can drop your pieces.<br/><br/>\n        Click on one of the squares to drop a piece there."]))),Ace.getInitialState(),Ice.fromDrop(new Tce(1,1,0),[]),$localize(wu||(wu=_g(["There you go, as simple as that."])))),wte.fromMove($localize(_u||(_u=_g(["Climbing"]))),$localize(Eu||(Eu=_g(["When 4 pieces form a square, it is possible to put a fifth piece on top.\n        However, when that happens, you can save a piece by climbing instead of dropping a piece.\n        To climb:\n        <ol>\n            <li>Click on one of your free pieces, which should be lower than the landing square.</li>\n            <li>Click on an empty landing square, higher than your selected piece.</li>\n        </ol><br/>\n        Go ahead, climb!"]))),new Ace([[[Lce,Fce,Dce,Dce],[Fce,Lce,Dce,Dce],[Dce,Dce,Dce,Dce],[Dce,Dce,Dce,Lce]],[[Dce,Dce,Dce],[Dce,Dce,Dce],[Dce,Dce,Dce]],[[Dce,Dce],[Dce,Dce]],[[Dce]]],0),[Ice.fromClimb(new Tce(3,3,0),new Tce(0,0,1),[])],$localize(bu||(bu=_g(["Congratulations!<br/>\n        Some important notes:\n        <ol>\n            <li>You cannot move a piece that is directly below another one.</li>\n            <li>Of course, you cannot move the opponent's pieces.</li>\n            <li>You can only climb when the landing square is higher than the starting square.</li>\n        </ol>"]))),$localize(Pu||(Pu=_g(["Failed!"])))),wte.fromMove($localize(Su||(Su=_g(["Square (1/2)"]))),$localize(Ou||(Ou=_g(["When the piece you just moved or dropped is the fourth one of a square of your color,\n        you can choose anywhere on the board one or two of your pieces.\n        These pieces will be removed from the board, allowing you to save up one or two pieces.\n        A chosen piece must not be directly below another piece.\n        A chosen piece can be the piece you just placed.\n        You're playing Dark.<br/><br/>\n        Form a square, then click twice on one of the four pieces to remove only that one."]))),new Ace([[[Lce,Lce,Dce,Dce],[Dce,Lce,Dce,Dce],[Dce,Dce,Dce,Dce],[Dce,Dce,Dce,Dce]],[[Dce,Dce,Dce],[Dce,Dce,Dce],[Dce,Dce,Dce]],[[Dce,Dce],[Dce,Dce]],[[Dce]]],0),[Ice.fromDrop(new Tce(0,1,0),[new Tce(0,0,0)]),Ice.fromDrop(new Tce(0,1,0),[new Tce(0,1,0)]),Ice.fromDrop(new Tce(0,1,0),[new Tce(1,0,0)]),Ice.fromDrop(new Tce(0,1,0),[new Tce(1,1,0)])],$localize(Tu||(Tu=_g(["Congratulations, you have saved up one piece."]))),$localize(Iu||(Iu=_g(["Failed!"])))),wte.fromPredicate($localize(Au||(Au=_g(["Square (2/2)"]))),$localize(Ru||(Ru=_g(["You're playing Dark.<br/><br/>\n        Do like in the previous step, but this time click on two different pieces."]))),new Ace([[[Lce,Lce,Dce,Dce],[Dce,Lce,Dce,Dce],[Dce,Dce,Dce,Dce],[Dce,Dce,Dce,Dce]],[[Dce,Dce,Dce],[Dce,Dce,Dce],[Dce,Dce,Dce]],[[Dce,Dce],[Dce,Dce]],[[Dce]]],0),Ice.fromDrop(new Tce(0,1,0),[new Tce(0,0,0),new Tce(1,0,0)]),function(e,t,n){return e.secondCapture.isPresent()?pB.SUCCESS:e.firstCapture.isPresent()?pB.failure($localize(Mu||(Mu=_g(["Failed, you only captured one piece."])))):pB.failure(sue.YOU_DID_NOT_CAPTURE_ANY_PIECE())},$localize(xu||(xu=_g(["Congratulations, you have saved up two pieces."]))))]});function Vce(e,t){if(1&e&&(cC(),eP(0,"g"),nP(1,"circle",4),tP()),2&e){var n=t.$implicit,r=fP().$implicit,i=fP();pE(1),vP("id","piece_",r,"_",n,""),Xb("ngClass",i.getPlayerPieceClass(r)),$b("cx",.5*i.SPACE_SIZE+(800-i.SPACE_SIZE)/14*n)("cy",860+(i.SPACE_SIZE+10)*r)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function Bce(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Vce,2,6,"g",1),tP()),2&e){var n=t.$implicit,r=fP();pE(1),Xb("ngForOf",r.getPlayerSidePieces(n))}}function zce(e,t){if(1&e){var n=aP();cC(),eP(0,"circle",8),uP("click",function(){Nk(n);var e=fP(2).$implicit,t=fP().$implicit,r=fP().$implicit;return fP().onPieceClick(e,t,r)}),tP()}if(2&e){var r=fP(2).$implicit,i=fP().$implicit,a=fP().$implicit,o=fP();pP("id","piece_",r,"_",i,"_",a,""),Xb("ngClass",o.getPieceClasses(r,i,a)),$b("r",o.getPieceRadius(a)-o.STROKE_WIDTH)("cx",o.getPieceCx(r,i,a))("cy",o.getPieceCy(r,i,a))}}function Hce(e,t){if(1&e){var n=aP();cC(),eP(0,"rect",8),uP("click",function(){Nk(n);var e=fP(2).$implicit,t=fP().$implicit,r=fP().$implicit;return fP().onDrop(e,t,r)}),tP()}if(2&e){var r=fP(2).$implicit,i=fP().$implicit,a=fP().$implicit,o=fP();pP("id","drop_",r,"_",i,"_",a,""),Xb("ngClass",o.getSquareClasses(r,i,a)),$b("width",2*o.getPieceRadius(a))("height",2*o.getPieceRadius(a))("x",o.getPieceCx(r,i,a)-o.getPieceRadius(a))("y",o.getPieceCy(r,i,a)-o.getPieceRadius(a))}}function Gce(e,t){if(1&e&&(cC(),rP(0),Yb(1,zce,1,7,"circle",6),Yb(2,Hce,1,8,"ng-template",null,7,MT),iP()),2&e){var n=Kb(3),r=fP().$implicit,i=fP().$implicit,a=fP().$implicit,o=fP();pE(1),Xb("ngIf",o.isOccupied(r,i,a))("ngIfElse",n)}}function $ce(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Gce,4,2,"ng-container",5),tP()),2&e){var n=t.$implicit,r=fP().$implicit,i=fP().$implicit,a=fP();pE(1),Xb("ngIf",a.mustDraw(n,r,i))}}function Zce(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,$ce,2,1,"g",1),tP()),2&e){var n=fP().$implicit,r=fP();pE(1),Xb("ngForOf",r.getLevelRange(n))}}function qce(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Zce,2,1,"g",1),tP()),2&e){var n=t.$implicit,r=fP();pE(1),Xb("ngForOf",r.getLevelRange(n))}}function Wce(e,t){if(1&e&&(cC(),nP(0,"rect",9)),2&e){var n=fP();pP("id","highCapture_",n.highCapture.get().x,"_",n.highCapture.get().y,"_",n.highCapture.get().z,""),$b("width",2*n.getPieceRadius(n.highCapture.get().z))("height",2*n.getPieceRadius(n.highCapture.get().z))("x",n.getPieceCx(n.highCapture.get().x,n.highCapture.get().y,n.highCapture.get().z)-n.getPieceRadius(n.highCapture.get().z))("y",n.getPieceCy(n.highCapture.get().x,n.highCapture.get().y,n.highCapture.get().z)-n.getPieceRadius(n.highCapture.get().z))}}var jce=function(){return[0,1]},Yce=function(){return[0,1,2]},Kce=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).lastLandingCoord=fB.empty(),r.lastStartingCoord=fB.empty(),r.lastFirstCapture=fB.empty(),r.lastSecondCapture=fB.empty(),r.highCapture=fB.empty(),r.chosenStartingCoord=fB.empty(),r.chosenLandingCoord=fB.empty(),r.chosenFirstCapture=fB.empty(),r.lastMove=fB.empty(),r.remainingPieces={0:15,1:15},r.rules=new Mce(Ace),r.availableMinimaxes=[new xce(r.rules,"PylosMinimax"),new Nce(r.rules,"PylosOrderedMinimax")],r.encoder=Ice.encoder,r.tutorial=(new Uce).tutorial,r.SPACE_SIZE=r.getPieceRadius(0),r.updateBoard(),r}return Wg(n,[{key:"getLevelRange",value:function(e){return Ace.getLevelRange(e)}},{key:"mustDraw",value:function(e,t,n){var r=new Tce(e,t,n);return!!(this.constructedState.getPieceAt(r).isPlayer()||this.justClimbed(r)||this.isCaptured(r))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(r)}},{key:"isCaptured",value:function(e){return this.chosenFirstCapture.equalsValue(e)}},{key:"onPieceClick",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#piece_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new Tce(e,t,n),i.abrupt("return",r.state.getPieceAt(o)===r.state.getCurrentOpponent()?r.cancelMove(ete.CANNOT_CHOOSE_OPPONENT_PIECE()):r.isSupporting(o)?r.cancelMove(Rce.CANNOT_MOVE_SUPPORTING_PIECE()):r.chosenLandingCoord.isAbsent()?r.onClimbClick(o):r.onCaptureClick(o));case 5:case"end":return i.stop()}},i)}))()}},{key:"isSupporting",value:function(e){return this.constructedState.isSupporting(e)}},{key:"onClimbClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.chosenStartingCoord=fB.of(e),t.constructedState=t.constructedState.removeCoord(e),pB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"onCaptureClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.chosenFirstCapture.isAbsent()?(t.chosenFirstCapture=fB.of(e),t.constructedState=t.constructedState.removeCoord(e),pB.SUCCESS):t.chosenFirstCapture.equalsValue(e)?t.concludeMoveWithCapture([t.chosenFirstCapture.get()]):t.concludeMoveWithCapture([t.chosenFirstCapture.get(),e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"concludeMoveWithCapture",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(r=t.chosenStartingCoord.isAbsent()?Ice.fromDrop(t.chosenLandingCoord.get(),e):Ice.fromClimb(t.chosenStartingCoord.get(),t.chosenLandingCoord.get(),e),t.tryMove(r,t.state)));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.cancelMove(),n.chooseMove(e,t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.constructedState=this.state,this.chosenStartingCoord=fB.empty(),this.chosenLandingCoord=fB.empty(),this.chosenFirstCapture=fB.empty()}},{key:"onDrop",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#drop_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new Tce(e,t,n),i.abrupt("return",Mce.canCapture(r.constructedState,o)?(r.chosenLandingCoord=fB.of(o),r.constructedState=r.constructedState.applyDrop(o),pB.SUCCESS):r.isCapturelessMoveFinished(o)?(r.chosenLandingCoord=fB.of(o),r.concludeMoveWithCapture([])):r.cancelMove(Rce.MUST_MOVE_UPWARD()));case 5:case"end":return i.stop()}},i)}))()}},{key:"isCapturelessMoveFinished",value:function(e){return!!this.chosenStartingCoord.isAbsent()||e.isUpperThan(this.chosenStartingCoord.get())}},{key:"getSquareClasses",value:function(e,t,n){var r=new Tce(e,t,n);if(this.lastMove.isPresent()){var i=this.lastMove.get();if(i.firstCapture.equalsValue(r)||i.secondCapture.equalsValue(r))return["captured"];if(r.equals(i.landingCoord)||i.startingCoord.equalsValue(r))return["moved"]}else if(this.justClimbed(r))return["moved"];return[]}},{key:"justClimbed",value:function(e){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(e)}},{key:"getPieceRadius",value:function(e){return 90+5*e}},{key:"getPieceCx",value:function(e,t,n){return 100+100*n+200*e}},{key:"getPieceCy",value:function(e,t,n){return 100+100*n+200*t}},{key:"isOccupied",value:function(e,t,n){var r=new Tce(e,t,n);if(this.justClimbed(r))return!1;var i=this.rules.node.gameState.getPieceAt(r).isPlayer(),a=this.chosenLandingCoord.equalsValue(r);return i||a}},{key:"getPieceClasses",value:function(e,t,n){var r=new Tce(e,t,n),i=[this.getPieceFillClass(r)];return(this.lastLandingCoord.equalsValue(r)||this.lastStartingCoord.equalsValue(r))&&i.push("highlighted"),(this.chosenStartingCoord.equalsValue(r)||this.chosenLandingCoord.equalsValue(r))&&i.push("selected"),this.chosenFirstCapture.equalsValue(r)&&i.push("pre-captured"),i}},{key:"getPieceFillClass",value:function(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerPieceClass(this.state.getPieceAt(e).value)}},{key:"getPlayerPieceClass",value:function(e){return this.getPlayerClass(R7.of(e))}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.remainingPieces[e],n=[],r=0;r<t;r++)n.push(r);return n}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.constructedState=this.state,this.lastMove=this.rules.node.move;var e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=fB.empty(),this.cancelMoveAttempt(),this.lastMove.isPresent()?this.showLastMove():this.hideLastMove()}},{key:"showLastMove",value:function(){var e=this.lastMove.get();this.lastLandingCoord=fB.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.mustDrawCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}},{key:"hideLastMove",value:function(){this.lastStartingCoord=fB.empty(),this.lastLandingCoord=fB.empty(),this.lastFirstCapture=fB.empty(),this.lastSecondCapture=fB.empty()}},{key:"mustDrawCoord",value:function(e){return this.mustDraw(e.x,e.y,e.z)}}]),n}(qee);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-pylos"]],features:[Rb],decls:5,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 1021","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["x","0","y","0","width","800","height","800",1,"base"],["class","base captured",3,"id",4,"ngIf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base",3,"id","ngClass","click"],[1,"base","captured",3,"id"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),Yb(1,Bce,2,1,"g",1),nP(2,"rect",2),Yb(3,qce,2,1,"g",1),Yb(4,Wce,1,7,"rect",3),tP()),2&e&&(pE(1),Xb("ngForOf",aT(3,jce)),pE(2),Xb("ngForOf",aT(4,Yce)),pE(1),Xb("ngIf",t.highCapture.isPresent()))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Qce=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"QuartoPiece("+this.value+")"}},{key:"isRectangle",value:function(){return this.value%4<2}}],[{key:"fromInt",value:function(t){if(0<=t&&t<=15)return e.pieces[t];if(16===t)return e.EMPTY;throw new Error("Invalid piece ("+t+")")}}]),e}();Qce.AAAA=new Qce(0),Qce.AAAB=new Qce(1),Qce.AABA=new Qce(2),Qce.AABB=new Qce(3),Qce.ABAA=new Qce(4),Qce.ABAB=new Qce(5),Qce.ABBA=new Qce(6),Qce.ABBB=new Qce(7),Qce.BAAA=new Qce(8),Qce.BAAB=new Qce(9),Qce.BABA=new Qce(10),Qce.BABB=new Qce(11),Qce.BBAA=new Qce(12),Qce.BBAB=new Qce(13),Qce.BBBA=new Qce(14),Qce.BBBB=new Qce(15),Qce.EMPTY=new Qce(16),Qce.pieces=[Qce.AAAA,Qce.AAAB,Qce.AABA,Qce.AABB,Qce.ABAA,Qce.ABAB,Qce.ABBA,Qce.ABBB,Qce.BAAA,Qce.BAAB,Qce.BABA,Qce.BABB,Qce.BBAA,Qce.BBAB,Qce.BBBA,Qce.BBBB];var Xce=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r)).piece=i,a}return Wg(n,[{key:"toString",value:function(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}},{key:"equals",value:function(e){return this===e||!!e.coord.equals(this.coord)&&this.piece===e.piece}}]),n}(cte);Xce.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 496}},{key:"encodeNumber",value:function(e){return 128*e.coord.x+32*e.coord.y+e.piece.value}},{key:"decodeNumber",value:function(e){var t=e%32;e-=t;var n=(e/=32)%4;return e-=n,new Xce(e/=4,n,Qce.fromInt(t))}}]),n}(T7));var Jce=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,e,r)).pieceInHand=i,a}return Wg(n,[{key:"getRemainingPieces",value:function(){var e,t=[],r=Hg(Qce.pieces);try{for(r.s();!(e=r.n()).done;){var i=e.value;n.isGivable(i,this.board,this.pieceInHand)&&t.push(i)}}catch(a){r.e(a)}finally{r.f()}return t}}],[{key:"getInitialState",value:function(){return new n(D7.createTable(4,4,Qce.EMPTY),0,Qce.AAAA)}},{key:"isGivable",value:function(e,t,r){return e!==r&&!1===n.isAlreadyOnBoard(e,t)}},{key:"isAlreadyOnBoard",value:function(e,t){for(var n=0;n<4;n++)for(var r=0;r<4;r++)if(t[n][r]===e)return!0;return!1}}]),n}(ote),ele=function(){var e=Wg(function e(){Zg(this,e)});return e.MUST_GIVE_A_PIECE=function(){return $localize(Nu||(Nu=_g(["You must give a piece."])))},e.PIECE_ALREADY_ON_BOARD=function(){return $localize(Du||(Du=_g(["That piece is already on the board."])))},e.CANNOT_GIVE_PIECE_IN_HAND=function(){return $localize(Lu||(Lu=_g(["You cannot give the piece that was in your hands."])))},e}(),tle=function(){function e(t){Zg(this,e),this.subCriterion=[fB.empty(),fB.empty(),fB.empty(),fB.empty()],this.subCriterion[0]=fB.of(8==(8&t.value)),this.subCriterion[1]=fB.of(4==(4&t.value)),this.subCriterion[2]=fB.of(2==(2&t.value)),this.subCriterion[3]=fB.of(1==(1&t.value))}return Wg(e,[{key:"mergeWith",value:function(e){for(var t=4,n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=fB.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}},{key:"mergeWithQuartoPiece",value:function(t){var n=new e(t);return this.mergeWith(n)}},{key:"areAllAbsent",value:function(){for(var e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}},{key:"match",value:function(e){for(var t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}},{key:"matchPiece",value:function(t){return this.match(new e(t))}},{key:"toString",value:function(){return"Criterion{"+this.subCriterion.map(function(e){return e.isPresent()?e.get()?"1":"0":"x"}).join(" ")+"}"}}]),e}(),nle=function(){function e(t,n){Zg(this,e),this.initialCoord=t,this.direction=n}return Wg(e,[{key:"allCoords",value:function(){for(var e=[],t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}]),e}(),rle=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t).toFallible(void 0)}},{key:"applyLegalMove",value:function(e,t){var n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.pieceInHand,new Jce(n,t.turn+1,e.piece)}},{key:"getGameStatus",value:function(e){var t,r=e.gameState,i={score:fte.DEFAULT,sensitiveSquares:new One},a=Hg(n.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=n.updateBoardStatus(o,r,i)).score===fte.VICTORY)return n.scoreToGameStatus(i.score,r.turn)}}catch(s){a.e(s)}finally{a.f()}return n.scoreToGameStatus(i.score,r.turn)}},{key:"getVictoriousCoords",value:function(e){var t,r=Hg(n.lines);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(n.isThereAVictoriousLine(i,e))return i.allCoords()}}catch(a){r.e(a)}finally{r.f()}return[]}}],[{key:"isOccupied",value:function(e){return e!==Qce.EMPTY}},{key:"isLegal",value:function(e,t){var r=e.coord.x,i=e.coord.y,a=e.piece,o=t.getCopiedBoard(),s=t.pieceInHand;return n.isOccupied(o[i][r])?pB.failure(ete.MUST_LAND_ON_EMPTY_SPACE()):a===Qce.EMPTY?15===t.turn?pB.SUCCESS:pB.failure(ele.MUST_GIVE_A_PIECE()):Jce.isAlreadyOnBoard(a,o)?pB.failure(ele.PIECE_ALREADY_ON_BOARD()):s===a?pB.failure(ele.CANNOT_GIVE_PIECE_IN_HAND()):pB.SUCCESS}},{key:"updateBoardStatus",value:function(e,t,n){return n.score===fte.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:fte.VICTORY,sensitiveSquares:new One}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}},{key:"isThereAVictoriousLine",value:function(e,t){for(var r=e.initialCoord,i=t.getPieceAt(r),a=new tle(i),o=0;o<3&&!1!==n.isOccupied(i)&&!a.areAllAbsent();o++)r=r.getNext(e.direction,1),i=t.getPieceAt(r),a.mergeWithQuartoPiece(i);return!(!n.isOccupied(i)||a.areAllAbsent())}},{key:"searchForVictoryOrPreVictoryInLine",value:function(e,t,r){var i=n.getLineInfos(e,t,r);if(i.boardStatus.isPresent())return i.boardStatus.get();var a=i.commonCriterion,o=i.sensitiveCoord;if(a.isPresent()&&!1===a.get().areAllAbsent()){if(o.isAbsent())return{score:fte.VICTORY,sensitiveSquares:new One};a.get().matchPiece(t.pieceInHand)&&(r.score=fte.PRE_VICTORY);var s=o.get();r.sensitiveSquares.add(s)}return r}},{key:"getLineInfos",value:function(e,t,r){for(var i=fB.empty(),a=fB.empty(),o=e.initialCoord,s=0;s<4;s++){var u=t.getPieceAt(o);if(u===Qce.EMPTY){if(!i.isAbsent())return{sensitiveCoord:fB.of(o),commonCriterion:a,boardStatus:fB.of(r)};i=fB.of(o)}else a.isAbsent()?(a=fB.of(new tle(u)),sB(n.VERBOSE,"set commonCrit to "+a.toString())):(a.get().mergeWithQuartoPiece(u),sB(n.VERBOSE,"update commonCrit: "+a.toString()));o=o.getNext(e.direction,1)}return{commonCriterion:a,sensitiveCoord:i,boardStatus:fB.empty()}}},{key:"scoreToGameStatus",value:function(e,t){var n=R7.of(t%2);return e===fte.VICTORY?gte.getDefeat(n):16===t?gte.DRAW:gte.ONGOING}}]),n}(yte);rle.VERBOSE=!1,rle.lines=[new nle(new Zee(0,0),Hee.DOWN),new nle(new Zee(1,0),Hee.DOWN),new nle(new Zee(2,0),Hee.DOWN),new nle(new Zee(3,0),Hee.DOWN),new nle(new Zee(0,0),Hee.RIGHT),new nle(new Zee(0,1),Hee.RIGHT),new nle(new Zee(0,2),Hee.RIGHT),new nle(new Zee(0,3),Hee.RIGHT),new nle(new Zee(0,0),Hee.DOWN_RIGHT),new nle(new Zee(0,3),Hee.UP_RIGHT)];var ile=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getRemainingPieces(),a=n.pieceInHand,o=0;o<4;o++)for(var s=0;s<4;s++)if(r[o][s]===Qce.EMPTY){if(n.getCopiedBoard()[o][s]=a,15===n.turn){var u=new Xce(s,o,Qce.EMPTY);return t.push(u),t}var c,l=Hg(i);try{for(l.s();!(c=l.n()).done;){var f=c.value,h=new Xce(s,o,f);t.push(h)}}catch(d){l.e(d)}finally{l.f()}}return t}},{key:"getBoardValue",value:function(e){var t,r=e.gameState,i={score:fte.DEFAULT,sensitiveSquares:new One},a=Hg(rle.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=rle.updateBoardStatus(o,r,i)).score===fte.VICTORY)break}}catch(s){a.e(s)}finally{a.f()}return n.scoreToBoardValue(i.score,r.turn)}}],[{key:"scoreToBoardValue",value:function(e,t){if(e===fte.DEFAULT)return new nte(0);var n=R7.of(t%2);return new nte(e===fte.PRE_VICTORY?n.getPreVictory():n.getDefeatValue())}}]),n}(tte),ale=Qce.AABA,ole=Qce.AABB,sle=Qce.ABAA,ule=Qce.ABAB,cle=Qce.ABBA,lle=Qce.BAAA,fle=Qce.BAAB,hle=Qce.BABB,dle=Qce.BBAA,vle=Qce.BBAB,ple=Qce.BBBA,gle=Qce.BBBB,yle=Qce.EMPTY,mle=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(Fu||(Fu=_g(["Goal of the game"]))),$localize(Uu||(Uu=_g(["Quarto is an alignment game.\n        The goal is to align four pieces that have at least one common aspect:\n        <ul>\n          <li>their color (light or dark),</li>\n          <li>their size (big or small),</li>\n          <li>their pattern (empty or dotted),</li>\n          <li>their shape (round or square).</li>\n        </ul>\n        Here, we have a board with a victory by an alignment of dark pieces."]))),new Jce([[ple,dle,sle,ale],[yle,yle,yle,yle],[yle,yle,yle,yle],[yle,yle,yle,yle]],7,Qce.ABAB)),wte.anyMove($localize(Vu||(Vu=_g(["Placement"]))),$localize(Bu||(Bu=_g(["Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,\n        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.\n        If you prefer, the order of these two steps can be reversed.\n        Keep in mind that the second click confirms the move.<br/><br/>\n        Make a move."]))),new Jce([[ple,ole,cle,yle],[yle,yle,yle,yle],[yle,lle,yle,yle],[yle,yle,yle,yle]],7,Qce.ABAA),new Xce(2,2,Qce.BAAB),$localize(zu||(zu=_g(["Perfect!"])))),wte.fromMove($localize(Hu||(Hu=_g(["Situation"]))),$localize(Gu||(Gu=_g(["We have here a tricky situation.<br/><br/>\n        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move."]))),new Jce([[gle,ple,vle,yle],[sle,hle,dle,yle],[ule,lle,fle,yle],[yle,yle,yle,yle]],7,Qce.AABA),[new Xce(3,3,Qce.AABB)],$localize($u||($u=_g(["Well done!"]))),$localize(Zu||(Zu=_g(["Failed!"]))))]});function kle(e,t){if(1&e&&(cC(),nP(0,"rect",11)),2&e){var n=fP(2),r=n.$implicit,i=n.index,a=fP().index,o=fP();Xb("ngClass",o.getPieceClasses(r.value)),$b("x",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("y",o.SPACE_SIZE*a+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("width",2*o.getPieceSize(r.value))("height",2*o.getPieceSize(r.value))}}function Cle(e,t){if(1&e&&(cC(),nP(0,"circle",11)),2&e){var n=fP(2),r=n.$implicit,i=n.index,a=fP().index,o=fP();Xb("ngClass",o.getPieceClasses(r.value)),$b("cx",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.SPACE_SIZE/2)("r",o.getPieceSize(r.value))}}function wle(e,t){if(1&e&&(cC(),nP(0,"circle")),2&e){var n=fP(2).index,r=fP().index,i=fP();$b("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function _le(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,kle,1,5,"rect",9),Yb(2,Cle,1,4,"ng-template",null,10,MT),Yb(4,wle,1,3,"circle",3),tP()),2&e){var n=Kb(3),r=fP().$implicit,i=fP(2);pE(1),Xb("ngIf",r.isRectangle())("ngIfElse",n),pE(3),Xb("ngIf",i.pieceHasDot(r.value))}}function Ele(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"rect",8),uP("click",function(){var e=Nk(n).index,t=fP().index;return fP().chooseCoord(e,t)}),tP(),Yb(2,_le,5,3,"g",3),tP()}if(2&e){var r=t.$implicit,i=t.index,a=fP().index,o=fP();pE(1),vP("id","chooseCoord_",i,"_",a,""),Xb("ngClass",o.getSquareClasses(i,a)),$b("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),pE(1),Xb("ngIf",r!==o.EMPTY)}}function ble(e,t){if(1&e&&(cC(),eP(0,"g",null,7),Yb(2,Ele,3,8,"g",2),tP()),2&e){var n=t.$implicit;pE(2),Xb("ngForOf",n)}}function Ple(e,t){if(1&e&&(cC(),nP(0,"rect",15)),2&e){var n=fP(2);Xb("ngClass",n.getPieceClasses(n.pieceInHand.value)),$b("x",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("y",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function Sle(e,t){if(1&e&&(cC(),nP(0,"circle",11)),2&e){var n=fP(2);Xb("ngClass",n.getPieceClasses(n.pieceInHand.value)),$b("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",n.getPieceSize(n.pieceInHand.value))}}function Ole(e,t){if(1&e&&(cC(),nP(0,"circle")),2&e){var n=fP(2);$b("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",10)}}function Tle(e,t){if(1&e&&(cC(),eP(0,"g",null,12),nP(2,"rect",13),Yb(3,Ple,1,5,"rect",14),Yb(4,Sle,1,4,"ng-template",null,10,MT),Yb(6,Ole,1,3,"circle",3),tP()),2&e){var n=Kb(5),r=fP();$b("transform","translate("+r.chosen.get().x*r.SPACE_SIZE+" "+r.chosen.get().y*r.SPACE_SIZE+")"),pE(2),$b("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),pE(1),Xb("ngIf",r.pieceInHand.isRectangle())("ngIfElse",n),pE(3),Xb("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function Ile(e,t){if(1&e&&(cC(),eP(0,"g",null,16),nP(2,"rect",17),tP()),2&e){var n=t.$implicit,r=fP();pE(2),$b("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)("transform","translate("+n.x*r.SPACE_SIZE+" "+n.y*r.SPACE_SIZE+")")}}function Ale(e,t){if(1&e&&(cC(),nP(0,"rect",11)),2&e){var n=fP(2);Xb("ngClass",n.getPieceClasses(n.pieceInHand.value)),$b("x",0)("y",.75*n.SPACE_SIZE)("transform","translate("+-n.getPieceSize(n.pieceInHand.value)+", "+-n.getPieceSize(n.pieceInHand.value)+")")("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function Rle(e,t){if(1&e&&(cC(),nP(0,"circle",19)),2&e){var n=fP(2);Xb("ngClass",n.getPieceClasses(n.pieceInHand.value)),$b("cy",.75*n.SPACE_SIZE)("r",n.getPieceSize(n.pieceInHand.value))}}function Mle(e,t){1&e&&(cC(),nP(0,"circle",20)),2&e&&$b("cy",.75*fP(2).SPACE_SIZE)("r",10)}function xle(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Ale,1,6,"rect",9),Yb(2,Rle,1,3,"ng-template",null,10,MT),Yb(4,Mle,1,2,"circle",18),tP()),2&e){var n=Kb(3),r=fP();pE(1),Xb("ngIf",r.pieceInHand.isRectangle())("ngIfElse",n),pE(3),Xb("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function Nle(e,t){if(1&e&&(cC(),nP(0,"rect",27)),2&e){var n=fP(2).index,r=fP().index,i=fP();$b("x",i.SPACE_SIZE*n)("y",i.SPACE_SIZE*r)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function Dle(e,t){if(1&e&&(cC(),nP(0,"rect",11)),2&e){var n=fP(2).index,r=fP().index,i=fP();Xb("ngClass",i.getPieceClasses(4*r+n)),$b("x",i.SPACE_SIZE*n+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("y",i.SPACE_SIZE*r+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("width",2*i.getPieceSize(4*r+n))("height",2*i.getPieceSize(4*r+n))}}function Lle(e,t){if(1&e&&(cC(),nP(0,"circle",11)),2&e){var n=fP(2).index,r=fP().index,i=fP();Xb("ngClass",i.getPieceClasses(4*r+n)),$b("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.getPieceSize(4*r+n))}}function Fle(e,t){if(1&e&&(cC(),nP(0,"circle")),2&e){var n=fP(2).index,r=fP().index,i=fP();$b("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function Ule(e,t){if(1&e){var n=aP();cC(),eP(0,"g",25),uP("click",function(){Nk(n);var e=fP().index,t=fP().index;return fP().choosePiece(4*t+e)}),Yb(1,Nle,1,4,"rect",26),Yb(2,Dle,1,5,"rect",9),Yb(3,Lle,1,4,"ng-template",null,10,MT),Yb(5,Fle,1,3,"circle",3),tP()}if(2&e){var r=Kb(4),i=fP().index,a=fP().index,o=fP();dP("id","choosePiece_",4*a+i,""),pE(1),Xb("ngIf",o.pieceToGive.value===4*a+i),pE(1),Xb("ngIf",(4*a+i)%4<2)("ngIfElse",r),pE(3),Xb("ngIf",o.pieceHasDot(4*a+i))}}function Vle(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Ule,6,5,"g",24),tP()),2&e){var n=t.index,r=fP().index,i=fP();pE(1),Xb("ngIf",i.isRemaining(4*r+n))}}function Ble(e,t){if(1&e&&(cC(),eP(0,"g",null,21),nP(2,"rect",22,23),Yb(4,Vle,2,1,"g",2),tP()),2&e){var n=t.$implicit,r=fP();$b("transform","translate(0 "+6.5*r.SPACE_SIZE+")"),pE(2),$b("x",-.125*r.SPACE_SIZE)("y",-.125*r.SPACE_SIZE)("width",4.25*r.SPACE_SIZE)("height",4.25*r.SPACE_SIZE),pE(2),Xb("ngForOf",n)}}var zle=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).EMPTY=Qce.EMPTY,r.chosen=fB.empty(),r.lastMove=fB.empty(),r.pieceInHand=Qce.EMPTY,r.pieceToGive=Qce.EMPTY,r.victoriousCoords=[],r.rules=new rle(Jce),r.availableMinimaxes=[new ile(r.rules,"QuartoMinimax")],r.encoder=Xce.encoder,r.tutorial=(new mle).tutorial,r.pieceInHand=r.rules.node.gameState.pieceInHand,r.updateBoard(),r}return Wg(n,[{key:"updateBoard",value:function(){var e=this.rules.node.gameState,t=this.rules.node.move;this.board=e.getCopiedBoard(),this.chosen=fB.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=t.map(function(e){return e.coord})}},{key:"chooseCoord",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#chooseCoord_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(n.hideLastMove(),n.board[t][e]!==Qce.EMPTY){r.next=11;break}if(n.showPieceInHandOnBoard(e,t),15!==n.rules.node.gameState.turn){r.next=7;break}return a=new Xce(e,t,Qce.EMPTY),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState));case 7:if(n.pieceToGive!==Qce.EMPTY){r.next=9;break}return r.abrupt("return",pB.SUCCESS);case 9:return o=new Xce(e,t,n.pieceToGive),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 11:return r.abrupt("return",n.cancelMove(ete.MUST_CLICK_ON_EMPTY_SPACE()));case 12:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#choosePiece_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(t.hideLastMove(),t.pieceToGive=Qce.fromInt(e),!t.chosen.isAbsent()){n.next=5;break}return n.abrupt("return",pB.SUCCESS);case 5:return i=t.chosen.get(),a=new Xce(i.x,i.y,t.pieceToGive),n.abrupt("return",t.chooseMove(a,t.rules.node.gameState));case 7:case"end":return n.stop()}},n)}))()}},{key:"hideLastMove",value:function(){this.lastMove=fB.empty()}},{key:"cancelMoveAttempt",value:function(){this.hideLastMove(),this.pieceToGive=Qce.EMPTY}},{key:"showPieceInHandOnBoard",value:function(e,t){this.chosen=fB.of(new Zee(e,t))}},{key:"isRemaining",value:function(e){return Jce.isGivable(Qce.fromInt(e),this.board,this.pieceInHand)}},{key:"getSquareClasses",value:function(e,t){var n=new Zee(e,t);return this.lastMove.equalsValue(n)?["moved"]:[]}},{key:"getPieceClasses",value:function(e){var t=[];return t.push(e%2==0?"player0":"player1"),t}},{key:"getPieceSize",value:function(e){return e<8?40:25}},{key:"pieceHasDot",value:function(e){return e!==Qce.EMPTY.value&&e%8<4}}]),n}(nne);return e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-quarto"]],features:[Rb],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],["chosenPiece",""],["id","highlight","x","0","y","0",1,"base","highlighted","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],[3,"id","click",4,"ngIf"],[3,"id","click"],["class","base highlighted",4,"ngIf"],[1,"base","highlighted"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),eP(1,"g",1),Yb(2,ble,3,1,"g",2),Yb(3,Tle,7,6,"g",3),Yb(4,Ile,3,3,"g",2),eP(5,"g",null,4),nP(7,"rect",5,6),Yb(9,xle,5,3,"g",3),tP(),Yb(10,Ble,5,6,"g",2),tP(),tP()),2&e&&($b("viewBox","0 0 "+4.25*t.SPACE_SIZE+" "+10.75*t.SPACE_SIZE),pE(2),Xb("ngForOf",t.board),pE(1),Xb("ngIf",t.chosen.isPresent()),pE(1),Xb("ngForOf",t.victoriousCoords),pE(1),$b("transform","translate("+2*t.SPACE_SIZE+", "+4.5*t.SPACE_SIZE+")"),pE(2),$b("width",1.5*t.SPACE_SIZE)("height",1.5*t.SPACE_SIZE)("transform","translate("+-.75*t.SPACE_SIZE+", 0)"),pE(2),Xb("ngIf",t.chosen.isAbsent()),pE(1),Xb("ngForOf",t.board))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Hle=function(){var e=Wg(function e(){Zg(this,e)});return e.NO_INSIDE_CLICK=function(){return $localize(qu||(qu=_g(["You must pick a space from the edge of the board."])))},e}(),Gle=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;Zg(this,n),(a=t.call(this,e,r)).direction=i;var o=n.isValidCoord(a.coord);if(o.isFailure())throw new Error(o.getReason());if(0===e&&i===Gee.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===e&&i===Gee.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===r&&i===Gee.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===r&&i===Gee.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.");return a}return Wg(n,[{key:"toString",value:function(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.direction===this.direction}}],[{key:"isValidCoord",value:function(e){return e.isNotInRange(5,5)?pB.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&4!==e.x&&0!==e.y&&4!==e.y?pB.failure(Hle.NO_INSIDE_CLICK()):pB.SUCCESS}}]),n}(cte);Gle.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 128}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 20*e.coord.x+4*e.coord.y+t}},{key:"decodeNumber",value:function(e){var t=Gee.factory.fromInt(e%4).get();e-=e%4;var n=(e/=4)%5;return e-=e%5,new Gle(e/=5,n,t)}}]),n}(T7));var $le=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e){for(var t=this.getCopiedBoard(),r=this.turn+1,i=e.coord,a=e.coord.getNext(e.direction);a.isInRange(5,5);)t[i.y][i.x]=t[a.y][a.x],i=i.getNext(e.direction),a=a.getNext(e.direction);return t[i.y][i.x]=this.getCurrentPlayer(),new n(t,r)}}],[{key:"getInitialState",value:function(){return new n(D7.createTable(5,5,A7.NONE),0)}}]),n}(ote),Zle=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?hB.failure(ete.CANNOT_CHOOSE_OPPONENT_PIECE()):hB.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getLinesSums(t),i=n.getFullestLine(r[R7.ZERO.value]),a=n.getFullestLine(r[R7.ONE.value]),o=t.getCurrentPlayer();return 5===i&&(o===R7.ZERO||a<5)?gte.ZERO_WON:5===a?gte.ONE_WON:gte.ONGOING}}],[{key:"getVerticalCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=0;r<5;r++)e.gameState.getPieceAtXY(0,r)!==t&&n.push(new Zee(0,r)),e.gameState.getPieceAtXY(4,r)!==t&&n.push(new Zee(4,r));return n}},{key:"getHorizontalCenterCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=1;r<4;r++)e.gameState.getPieceAtXY(r,0)!==t&&n.push(new Zee(r,0)),e.gameState.getPieceAtXY(r,4)!==t&&n.push(new Zee(r,4));return n}},{key:"getPossibleDirections",value:function(e){var t=[];return 0!==e.x&&t.push(Gee.LEFT),0!==e.y&&t.push(Gee.UP),4!==e.x&&t.push(Gee.RIGHT),4!==e.y&&t.push(Gee.DOWN),t}},{key:"getLinesSums",value:function(e){var t={};t[R7.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[R7.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(var n=0;n<5;n++)for(var r=0;r<5;r++){var i=e.getPieceAtXY(r,n);if(i.isPlayer()){var a=i.value;t[a].columns[r]=t[a].columns[r]+1,t[a].rows[n]=t[a].rows[n]+1,r===n&&(t[a].diagonals[0]=t[a].diagonals[0]+1),r+n===4&&(t[a].diagonals[1]=t[a].diagonals[1]+1)}}return t}},{key:"getVictoriousCoords",value:function(e){for(var t=n.getLinesSums(e),r=[],i=0;i<2;i++){for(var a=0;a<5;a++){if(5===t[i].columns[a])for(var o=0;o<5;o++)r.push(new Zee(a,o));if(5===t[i].rows[a])for(var s=0;s<5;s++)r.push(new Zee(s,a))}if(5===t[i].diagonals[0])for(var u=0;u<5;u++)r.push(new Zee(u,u));if(5===t[i].diagonals[1])for(var c=0;c<5;c++)r.push(new Zee(c,4-c))}return r}},{key:"getFullestLine",value:function(e){var t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max.apply(Math,Bg(t))}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}}]),n}(yte),qle=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t,n=[],r=Zle.getVerticalCoords(e),i=Hg(Zle.getHorizontalCenterCoords(e).concat(r));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=Hg(Zle.getPossibleDirections(o));try{for(s.s();!(a=s.n()).done;){var u=a.value,c=new Gle(o.x,o.y,u);n.push(c)}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Zle.getLinesSums(t),r=Zle.getFullestLine(n[R7.ZERO.value]),i=Zle.getFullestLine(n[R7.ONE.value]),a=t.getCurrentPlayer();return new nte(5===r&&(a===R7.ZERO||i<5)?R7.ZERO.getVictoryValue():5===i?R7.ONE.getVictoryValue():i-r)}}]),n}(tte),Wle=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"getArrowTransform",value:function(e,t,n){var r,i,a;switch(n){case Gee.UP:r=0,i=-1,a=-90;break;case Gee.DOWN:r=0,i=1,a=90;break;case Gee.LEFT:r=-1,i=0,a=180;break;default:oB.expectToBe(n,Gee.RIGHT),r=1,i=0,a=0}return["translate(".concat(t.x*e+e/2+r*e/4," ").concat(t.y*e+e/2+i*e/4,")"),"scale(2.5)","rotate(".concat(a,")")].join(" ")}}]),e}(),jle=A7.NONE,Yle=A7.ZERO,Kle=A7.ONE,Qle=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(Wu||(Wu=_g(["Goal of the game."]))),$localize(ju||(ju=_g(["At Quixo, the goal is to align 5 of your pieces.\n        The first player plays with dark pieces, the second with light pieces.\n        The board is made of 25 spaces spread over a 5x5 square.\n        Every piece has a neutral side, a light side, and a dark side."]))),$le.getInitialState()),wte.fromMove($localize(Yu||(Yu=_g(["What a move looks like (without animation)"]))),$localize(Ku||(Ku=_g(["When it is your turn:\n        <ol>\n            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.\n                You can only choose a piece from the edge of the board.</li>\n            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>\n        </ol>\n        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.\n        Once on the other side, all pieces will move by one space in the opposing direction.\n        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>\n        For example, take the bottom right neutral piece, and move it to the left (you're playing Light)."]))),new $le([[jle,jle,jle,jle,jle],[jle,jle,jle,jle,jle],[jle,jle,jle,jle,jle],[jle,jle,jle,jle,jle],[Yle,Yle,Yle,Yle,jle]],1),[new Gle(4,4,Gee.LEFT)],$localize(Qu||(Qu=_g(["See how the four dark pieces have been moved one space to the right.\n        The neutral piece has been move 4 pieces to the left and has become light."]))),$localize(Xu||(Xu=_g(["Failed!"])))),wte.fromMove($localize(Ju||(Ju=_g(["Victory"]))),$localize(ec||(ec=_g(["You already know everything you need in order to play, but there is one last particularity.\n        If you create a line of 5 of your pieces, you win.\n        If you create a line of 5 of your opponent's pieces, you lose.\n        If you create both, you lose too!<br/><br/>\n        You can win with this board, try it.\n        You're playing Light."]))),new $le([[jle,Kle,jle,Kle,Kle],[jle,Yle,Yle,jle,Yle],[Kle,Kle,Kle,Yle,Kle],[Yle,jle,Yle,Kle,Kle],[Kle,Yle,jle,Kle,Yle]],31),[new Gle(3,0,Gee.DOWN)],$localize(tc||(tc=_g(["Congratulations, you won!"]))),$localize(nc||(nc=_g(["Failed!"]))))]});function Xle(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"circle",4),uP("click",function(){var e=Nk(n).index,t=fP().index;return fP().onBoardClick(e,t)}),tP(),tP()}if(2&e){var r=t.index,i=fP().index,a=fP();pE(1),vP("id","click_",r,"_",i,""),Xb("ngClass",a.getPieceClasses(r,i)),$b("cx",50+100*r)("cy",50+100*i)}}function Jle(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Xle,2,5,"g",2),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}function efe(e,t){if(1&e){var n=aP();cC(),eP(0,"use",6),uP("click",function(){var e=Nk(n).$implicit;return fP(2).chooseDirection(e)}),tP()}if(2&e){var r=t.$implicit,i=fP(2);dP("id","chooseDirection_",r,""),$b("transform",i.getArrowTransform(i.chosenCoord.get(),r))}}function tfe(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,efe,1,2,"use",5),tP()),2&e){var n=fP();pE(1),Xb("ngForOf",n.getPossiblesDirections())}}var nfe=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).lastMoveCoord=fB.empty(),r.chosenCoord=fB.empty(),r.victoriousCoords=[],r.rules=new Zle($le),r.availableMinimaxes=[new qle(r.rules,"QuixoMinimax")],r.encoder=Gle.encoder,r.tutorial=(new Qle).tutorial,r.updateBoard(),r}return Wg(n,[{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.board=this.state.board,this.lastMoveCoord=this.rules.node.move.map(function(e){return e.coord}),this.victoriousCoords=Zle.getVictoriousCoords(this.state)}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=fB.empty()}},{key:"getPieceClasses",value:function(e,t){var n=new Zee(e,t),r=[];return r.push(this.getPlayerClass(this.board[t][e])),this.chosenCoord.equalsValue(n)?r.push("selected"):this.lastMoveCoord.equalsValue(n)&&r.push("last-move"),this.victoriousCoords.some(function(e){return e.equals(n)})&&r.push("victory-stroke"),r}},{key:"onBoardClick",value:function(e,t){var n=this.canUserPlay("#click_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());var r=new Zee(e,t),i=Gle.isValidCoord(r);return i.isFailure()?this.cancelMove(i.getReason()):this.board[t][e]===this.state.getCurrentOpponent()?this.cancelMove(ete.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord=fB.of(r),pB.SUCCESS)}},{key:"getPossiblesDirections",value:function(){var e=[],t=this.chosenCoord.get();return 4!==t.x&&e.push("RIGHT"),0!==t.x&&e.push("LEFT"),4!==t.y&&e.push("DOWN"),0!==t.y&&e.push("UP"),e}},{key:"chooseDirection",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#chooseDirection_"+e)).isFailure()){n.next=5;break}n.t0=t.cancelMove(r.getReason()),n.next=9;break;case 5:return t.chosenDirection=Gee.factory.fromString(e).get(),n.next=8,t.tryMove();case 8:n.t0=n.sent;case 9:return n.abrupt("return",n.t0);case 10:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new Gle(n.x,n.y,e.chosenDirection),t.abrupt("return",(e.cancelMove(),e.chooseMove(r,e.rules.node.gameState)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getArrowTransform",value:function(e,t){return Wle.getArrowTransform(this.SPACE_SIZE,e,Gee.factory.fromString(t).get())}}]),n}(nne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-quixo"]],features:[Rb],decls:5,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 500 500","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -3.5, 10 0, 0 3.5"],[4,"ngFor","ngForOf"],[4,"ngIf"],["r","45",1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",3,"id","click"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),eP(1,"defs"),nP(2,"polygon",1),tP(),Yb(3,Jle,2,1,"g",2),Yb(4,tfe,2,1,"g",3),tP()),2&e&&(pE(3),Xb("ngForOf",t.board),pE(1),Xb("ngIf",t.chosenCoord.isPresent()))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),rfe=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"countScore",value:function(){for(var e=[0,0],t=0;t<n.BOARD_HEIGHT;t++)for(var r=0;r<n.BOARD_WIDTH;r++){var i=this.board[t][r];i.isPlayer()&&(e[i.value]+=1)}return e}}],[{key:"getInitialState",value:function(){var e=D7.createTable(n.BOARD_WIDTH,n.BOARD_HEIGHT,A7.NONE);return e[3][3]=R7.ZERO,e[4][4]=R7.ZERO,e[3][4]=R7.ONE,e[4][3]=R7.ONE,new n(e,0)}},{key:"getNeighboringPawnLike",value:function(e,t,n,r){for(var i,a=[],o=-1;o<2;o++)for(var s=-1;s<2;s++)(i=new Zee(n+s,r+o)).isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[i.y][i.x]===t&&a.push(i);return a}}]),n}(ote);return e.BOARD_WIDTH=8,e.BOARD_HEIGHT=8,e}(),ife=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"equals",value:function(e){return e===this||e.coord.equals(this.coord)}},{key:"toString",value:function(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(cte);ife.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return(rfe.BOARD_HEIGHT-1)*rfe.BOARD_WIDTH+(rfe.BOARD_WIDTH-1)}},{key:"encodeNumber",value:function(e){return e.coord.y*rfe.BOARD_WIDTH+e.coord.x}},{key:"decodeNumber",value:function(e){var t=e%rfe.BOARD_WIDTH;return new ife(t,(e-t)/rfe.BOARD_WIDTH)}}]),n}(T7)),ife.PASS=new ife(-1,-1),ife.PASS_NUMBER=ife.encoder.encodeNumber(ife.PASS);var afe=function(){var e=Wg(function e(){Zg(this,e)});return e.NO_ELEMENT_SWITCHED=function(){return $localize(rc||(rc=_g(["Your move should switch at least one piece."])))},e}(),ofe=Wg(function e(t,n){Zg(this,e),this.move=t,this.switched=n}),sfe=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.turn,i=t.getCurrentPlayer(),a=t.getCopiedBoard();if(e.equals(ife.PASS))return new rfe(a,r+1);var o,s=Hg(n);try{for(s.s();!(o=s.n()).done;){var u=o.value;a[u.y][u.x]=i}}catch(c){s.e(c)}finally{s.f()}return a[e.coord.y][e.coord.x]=i,new rfe(a,r+1)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}},{key:"isLegal",value:function(e,t){if(e.equals(ife.PASS))return n.playerCanOnlyPass(t)?hB.success([]):hB.failure(ete.MUST_PASS());if(t.getPieceAt(e.coord).isPlayer())return sB(n.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),hB.failure(ete.MUST_CLICK_ON_EMPTY_SPACE());var r=t.getCopiedBoard(),i=n.getAllSwitcheds(e,t.getCurrentPlayer(),r);return sB(n.VERBOSE,"ReversiRules.isLegal: "+i.length+" element(s) switched"),0===i.length?hB.failure(afe.NO_ELEMENT_SWITCHED()):hB.success(i)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;if(!1===n.isGameEnded(t))return gte.ONGOING;var r=t.countScore(),i=r[1]-r[0];return i<0?gte.ZERO_WON:i>0?gte.ONE_WON:gte.DRAW}},{key:"getAllSwitcheds",value:function(e,t,r){var i,a=[],o=t.getOpponent(),s=Hg(Hee.DIRECTIONS);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=e.coord.getNext(u);if(c.isInRange(rfe.BOARD_WIDTH,rfe.BOARD_HEIGHT)&&r[c.y][c.x]===o){var l,f=Hg(n.getSandwicheds(t,u,c,r));try{for(f.s();!(l=f.n()).done;){var h=l.value;a.push(h)}}catch(d){f.e(d)}finally{f.f()}}}}catch(d){s.e(d)}finally{s.f()}return a}},{key:"getSandwicheds",value:function(e,t,n,r){for(var i=[n],a=n.getNext(t);a.isInRange(rfe.BOARD_WIDTH,rfe.BOARD_HEIGHT);){var o=r[a.y][a.x];if(o===e)return i;if(o===A7.NONE)return[];i.push(a),a=a.getNext(t)}return[]}},{key:"isGameEnded",value:function(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}},{key:"playerCanOnlyPass",value:function(e){var t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(ife.PASS)}},{key:"nextPlayerCantOnlyPass",value:function(e){var t=e.getCopiedBoard(),n=new rfe(t,e.turn+1);return this.playerCanOnlyPass(n)}},{key:"getListMoves",value:function(e){for(var t,r=[],i=e.getCurrentPlayer(),a=e.getCurrentOpponent(),o=0;o<8;o++)for(var s=0;s<8;s++)if(e.getPieceAtXY(s,o)===A7.NONE&&(t=e.getCopiedBoard(),rfe.getNeighboringPawnLike(t,a,s,o).length>0)){var u=new ife(s,o),c=n.getAllSwitcheds(u,i,t);if(c.length>0){var l,f=Hg(c);try{for(f.s();!(l=f.n()).done;){var h=l.value;v7(i!==e.getPieceAt(h),h+"was already switched!"),t[h.y][h.x]=i}}catch(d){f.e(d)}finally{f.f()}t[o][s]=i,r.push(new ofe(u,c.length))}}return 0===r.length&&r.push(new ofe(ife.PASS,0)),r}}]),n}(yte);return e.VERBOSE=!1,e}(),ufe=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getBoardValue",value:function(e){var t=sfe.getGameStatus(e);if(t.isEndGame)return nte.fromWinner(t.winner);for(var n=e.gameState.getCopiedBoard(),r=0,i=0,a=0;a<rfe.BOARD_HEIGHT;a++)for(var o=0;o<rfe.BOARD_WIDTH;o++){var s=(0===o||o===rfe.BOARD_WIDTH-1?4:1)*(0===a||a===rfe.BOARD_HEIGHT-1?4:1);n[a][o]===R7.ZERO&&(r+=s),n[a][o]===R7.ONE&&(i+=s)}return r*=R7.ZERO.getScoreModifier(),i*=R7.ONE.getScoreModifier(),new nte(i+r)}},{key:"getListMoves",value:function(e){var t=sfe.getListMoves(e.gameState);return D7.sortByDescending(t,function(e){return n.bestCoords.some(function(t){return e.move.coord.equals(t)})?100:e.switched}),t.map(function(e){return e.move})}}]),n}(tte);ufe.bestCoords=[new Zee(0,0),new Zee(0,rfe.BOARD_HEIGHT-1),new Zee(rfe.BOARD_WIDTH-1,0),new Zee(rfe.BOARD_WIDTH-1,rfe.BOARD_HEIGHT-1)];var cfe=A7.NONE,lfe=A7.ZERO,ffe=A7.ONE,hfe=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(ic||(ic=_g(["Goal of the game"]))),$localize(ac||(ac=_g(["At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.\n        When one piece is flipped, its owner changes.\n        The player owning the most pieces at the end of the game wins.\n        Here, Dark has 28 points and Light has 36, hence Light wins."]))),new rfe([[lfe,lfe,lfe,lfe,lfe,lfe,lfe,lfe],[lfe,ffe,ffe,ffe,ffe,ffe,ffe,lfe],[lfe,ffe,ffe,ffe,ffe,ffe,ffe,lfe],[lfe,ffe,ffe,ffe,ffe,ffe,ffe,lfe],[lfe,ffe,ffe,ffe,ffe,ffe,ffe,lfe],[lfe,ffe,ffe,ffe,ffe,ffe,ffe,lfe],[lfe,ffe,ffe,ffe,ffe,ffe,ffe,lfe],[lfe,lfe,lfe,lfe,lfe,lfe,lfe,lfe]],60)),wte.anyMove($localize(oc||(oc=_g(["Capture (1/2)"]))),$localize(sc||(sc=_g(["At the beginning of the game, pieces are placed as shown here.\n        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>\n        Do any move by clicking to put your piece\n        Dark plays first."]))),rfe.getInitialState(),new ife(2,4),$localize(uc||(uc=_g(["Congratulations!"])))),wte.fromMove($localize(cc||(cc=_g(["Capture (2/2)"]))),$localize(lc||(lc=_g(["A move can also capture a bigger line, and more than one lines at a time\n        You're playing light here.<br/><br/>\n        Play on the bottom left to see an example."]))),new rfe([[cfe,cfe,cfe,cfe,cfe,cfe,cfe,cfe],[cfe,cfe,cfe,cfe,cfe,cfe,cfe,cfe],[cfe,cfe,cfe,cfe,cfe,cfe,cfe,cfe],[cfe,cfe,cfe,cfe,ffe,cfe,cfe,cfe],[cfe,cfe,cfe,lfe,cfe,cfe,cfe,cfe],[cfe,cfe,lfe,cfe,cfe,cfe,cfe,cfe],[lfe,lfe,cfe,cfe,cfe,cfe,cfe,cfe],[cfe,lfe,ffe,lfe,ffe,lfe,cfe,cfe]],1),[new ife(0,7)],$localize(fc||(fc=_g(["Congratulations!"]))),$localize(hc||(hc=_g(["Lower and more to the left, please."])))),wte.informational($localize(dc||(dc=_g(["Passing a turn"]))),$localize(vc||(vc=_g(["If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass\n        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way."]))),new rfe([[ffe,lfe,lfe,lfe,lfe,lfe,ffe,lfe],[lfe,ffe,ffe,ffe,ffe,ffe,ffe,lfe],[lfe,ffe,ffe,ffe,ffe,ffe,ffe,lfe],[lfe,ffe,ffe,ffe,ffe,ffe,ffe,lfe],[lfe,ffe,ffe,ffe,ffe,ffe,ffe,lfe],[lfe,ffe,ffe,ffe,ffe,ffe,ffe,lfe],[ffe,ffe,ffe,ffe,ffe,ffe,cfe,cfe],[lfe,lfe,lfe,lfe,lfe,lfe,cfe,cfe]],60))]});function dfe(e,t){if(1&e&&(cC(),nP(0,"circle",4)),2&e){var n=fP().index,r=fP().index,i=fP();Xb("ngClass",i.getPieceClass(n,r)),$b("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)}}function vfe(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"rect",2),uP("click",function(){var e=Nk(n).index,t=fP().index;return fP().onClick(e,t)}),tP(),Yb(2,dfe,1,4,"circle",3),tP()}if(2&e){var r=t.index,i=fP().index,a=fP();pE(1),vP("id","click_",r,"_",i,""),Xb("ngClass",a.getRectClasses(r,i)),$b("x",a.SPACE_SIZE*r)("y",a.SPACE_SIZE*i)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),pE(1),Xb("ngIf",a.board[i][r]!==a.EMPTY)}}function pfe(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,vfe,3,8,"g",1),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}var gfe=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).EMPTY=A7.NONE,r.lastMove=new Zee(-2,-2),r.captureds=[],r.scores=fB.of([2,2]),r.rules=new sfe(rfe),r.availableMinimaxes=[new ufe(r.rules,"ReversiMinimax")],r.encoder=ife.encoder,r.tutorial=(new hfe).tutorial,r.canPass=!1,r.updateBoard(),r}return Wg(n,[{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new ife(e,t),r.next=6,n.chooseMove(a,n.rules.node.gameState,n.scores.get());case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.captureds=[],this.rules.node.move.isPresent()?this.showPreviousMove():this.lastMove=new Zee(-2,-2),this.scores=fB.of(e.countScore()),this.canPass=sfe.playerCanOnlyPass(e)}},{key:"showPreviousMove",value:function(){this.lastMove=this.rules.node.move.get().coord;var e,t=this.rules.node.gameState.getCurrentPlayer(),n=this.rules.node.gameState.getCurrentOpponent(),r=Hg(Hee.DIRECTIONS);try{for(r.s();!(e=r.n()).done;)for(var i=e.value,a=this.lastMove.getNext(i,1);a.isInRange(rfe.BOARD_WIDTH,rfe.BOARD_HEIGHT)&&this.rules.node.gameState.getPieceAt(a)===n&&this.rules.node.mother.get().gameState.getPieceAt(a)===t;)this.captureds.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}}},{key:"getRectClasses",value:function(e,t){var n=new Zee(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured"]:n.equals(this.lastMove)?["moved"]:[]}},{key:"getPieceClass",value:function(e,t){return this.getPlayerClass(this.board[t][e])}},{key:"pass",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(v7(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(ife.PASS.coord.x,ife.PASS.coord.y)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(nne);return e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-reversi"]],features:[Rb],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),Yb(1,pfe,2,1,"g",1),tP()),2&e&&($b("viewBox","0 -4 "+8*t.SPACE_SIZE+" "+(10+8*t.SPACE_SIZE)),pE(1),Xb("ngForOf",t.board))},directives:[LA,NA,UA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),yfe=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,null,[{key:"getInitialState",value:function(){var e=jee.UNREACHABLE,t=jee.ZERO,r=jee.ONE,i=jee.EMPTY;return new n([[e,e,t,r,i,i,i,t,r,e,e],[e,i,i,i,i,i,i,i,i,i,e],[r,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,r],[e,i,i,i,i,i,i,i,i,i,e],[e,e,r,t,i,i,i,r,t,e,e]],0)}}]),n}(Jne);return e.HEIGHT=6,e.WIDTH=11,e}(),mfe=function(){var e=Wg(function e(){Zg(this,e)});return e.CAN_ONLY_REBOUND_ON_BLACK=function(){return $localize(pc||(pc=_g(["You can only rebound on dark spaces."])))},e.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=function(){return $localize(gc||(gc=_g(["You can only rebound on empty spaces."])))},e.MUST_CHOOSE_PYRAMID_FIRST=function(){return $localize(yc||(yc=_g(["You must pick one of your pyramids first."])))},e.MUST_CHOOSE_OWN_PYRAMID=function(){return $localize(mc||(mc=_g(["You must pick one of your pyramids."])))},e.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=function(){return $localize(kc||(kc=_g(["Those two spaces are not neighbors."])))},e.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=function(){return $localize(Cc||(Cc=_g(["Those two spaces have no intermediary neighbor."])))},e}(),kfe=function(e){xg(n,e);var t=Dg(n);function n(e,r){return Zg(this,n),t.call(this,e,r)}return Wg(n,[{key:"isSimpleStep",value:function(){return Math.abs(this.coord.x-this.end.x)+Math.abs(this.coord.y-this.end.y)===1}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"SaharaMove("+this.coord+"->"+this.end+")"}}],[{key:"checkDistanceAndLocation",value:function(e,t){var n=Math.abs(e.x-t.x)+Math.abs(e.y-t.y);if(0===n)return pB.failure(ete.MOVE_CANNOT_BE_STATIC());if(1===n){var r=Xne.getFakeNeighbors(e);if(t.equals(r))return pB.failure(mfe.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return pB.failure($localize(wc||(wc=_g(["You can move one or two spaces, not ","."])),n));if(Xne.isSpaceDark(e))return pB.failure(mfe.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return pB.failure(mfe.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return pB.SUCCESS}},{key:"from",value:function(e,t){if(!e.isInRange(yfe.WIDTH,yfe.HEIGHT))throw new Error("Move must start inside the board not at "+e.toString()+".");if(!t.isInRange(yfe.WIDTH,yfe.HEIGHT))throw new Error("Move must end inside the board not at "+t.toString()+".");var r=n.checkDistanceAndLocation(e,t);return r.isFailure()?r.toFailedFallible():hB.success(new n(e,t))}}]),n}(hne);kfe.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 396*yfe.WIDTH+66*yfe.HEIGHT+6*yfe.WIDTH+yfe.HEIGHT}},{key:"encodeNumber",value:function(e){return 396*e.coord.x+66*e.coord.y+6*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){var t=e%6;e-=t;var n=(e/=6)%11;e-=n;var r=(e/=11)%6;return e-=r,kfe.from(new Zee(e/=6,r),new Zee(n,t)).get()}}]),n}(T7));var Cfe=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,r){sB(n.VERBOSE,"Legal move "+e.toString()+" applied");var i=t.getCopiedBoard();return i[e.end.y][e.end.x]=i[e.coord.y][e.coord.x],i[e.coord.y][e.coord.x]=jee.EMPTY,new yfe(i,t.turn+1)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).value!==t.getCurrentPlayer().value)return hB.failure(ete.CANNOT_CHOOSE_OPPONENT_PIECE());if(t.getPieceAt(e.end)!==jee.EMPTY)return hB.failure(ete.MUST_LAND_ON_EMPTY_SPACE());var n=Xne.getCommonNeighbor(e.coord,e.end);return n.isPresent()?t.getPieceAt(n.get())===jee.EMPTY?hB.success(void 0):hB.failure(mfe.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):hB.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getCopiedBoard(),r=n.getBoardValuesFor(t,R7.ZERO),i=n.getBoardValuesFor(t,R7.ONE);return n.getGameStatusFromFreedoms(r,i)}},{key:"getLandingCoords",value:function(e,t){var n=function(t){return t.isInRange(yfe.WIDTH,yfe.HEIGHT)&&e[t.y][t.x]===jee.EMPTY},r=new ite(Xne.getNeighbors(t).filter(n));if(!0===Xne.isSpaceDark(t))return r.toList();var i,a=new ite(r.toList()),o=Hg(r);try{for(o.s();!(i=o.n()).done;){var s,u=i.value,c=Hg(Xne.getNeighbors(u).filter(n));try{for(c.s();!(s=c.n()).done;){var l=s.value;a.add(l)}}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}return a.toList()}}],[{key:"getStartingCoords",value:function(e,t){for(var n=[],r=0;r<yfe.HEIGHT;r++)for(var i=0;i<yfe.WIDTH;i++)e[r][i].is(t)&&n.push(new Zee(i,r));return n}},{key:"getBoardValuesFor",value:function(e,t){var r,i=[],a=Hg(n.getStartingCoords(e,t));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=Jne.getEmptyNeighbors(e,o,jee.EMPTY).length;if(0===s)return[0];i.push(s)}}catch(u){a.e(u)}finally{a.f()}return i.sort(function(e,t){return e-t})}},{key:"getGameStatusFromFreedoms",value:function(e,t){return 0===e[0]?gte.ONE_WON:0===t[0]?gte.ZERO_WON:gte.ONGOING}}]),n}(yte);return e.VERBOSE=!1,e}(),wfe=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState.getCopiedBoard(),i=e.gameState.getCurrentPlayer(),a=Hg(Cfe.getStartingCoords(r,i));try{for(a.s();!(t=a.n()).done;){var o,s=t.value,u=Hg(Jne.getEmptyNeighbors(r,s,jee.EMPTY));try{for(u.s();!(o=u.n()).done;){var c=o.value,l=kfe.from(s,c).get();if(r[c.y][c.x]=r[s.y][s.x],r[s.y][s.x]=jee.EMPTY,n.push(l),(c.y+c.x)%2==0){var f,h=Hg(Jne.getEmptyNeighbors(r,c,jee.EMPTY));try{for(h.s();!(f=h.n()).done;){var d=f.value;if(!d.equals(s)){var v=kfe.from(s,d).get();r[d.y][d.x]=r[c.y][c.x],r[c.y][c.x]=jee.EMPTY,n.push(v),r[c.y][c.x]=r[d.y][d.x],r[d.y][d.x]=jee.EMPTY}}}catch(p){h.e(p)}finally{h.f()}}r[s.y][s.x]=r[c.y][c.x],r[c.y][c.x]=jee.EMPTY}}catch(p){u.e(p)}finally{u.f()}}}catch(p){a.e(p)}finally{a.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState.getCopiedBoard(),n=Cfe.getBoardValuesFor(t,R7.ZERO),r=Cfe.getBoardValuesFor(t,R7.ONE),i=Cfe.getGameStatusFromFreedoms(n,r);if(i.isEndGame)return nte.fromWinner(i.winner);for(var a=0;a<6&&n[a]===r[a];)a++;return new nte(r[a%6]-n[a%6])}}]),n}(tte),_fe=jee.UNREACHABLE,Efe=jee.ZERO,bfe=jee.ONE,Pfe=jee.EMPTY,Sfe=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(_c||(_c=_g(["Initial board"]))),$localize(Ec||(Ec=_g(["S\xe2h\xe2r\xe2 is played on a board where each space is a triangle.\n        Each player has six pyramids."]))),yfe.getInitialState()),wte.informational($localize(bc||(bc=_g(["Goal of the game"]))),$localize(Pc||(Pc=_g(["At S\xe2h\xe2r\xe2, the goal of the game is to immobilize one of the opponent's pyramids.\n        To do so, you have to occupy all neighboring space of that pyramid.\n        Here, Light has lost because its leftmost pyramid is immobilized."]))),new yfe([[_fe,_fe,Pfe,Pfe,bfe,Pfe,Pfe,Efe,bfe,_fe,_fe],[_fe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,_fe],[bfe,Efe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Efe],[Efe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,bfe],[_fe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,_fe],[_fe,_fe,bfe,Efe,Pfe,Pfe,Pfe,bfe,Efe,_fe,_fe]],3)),wte.fromPredicate($localize(Sc||(Sc=_g(["Simple step"]))),$localize(Oc||(Oc=_g(["To immobilize your opponent, you have to move your pyramids.\n        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).\n        You're the first player, playing with the dark pyramids.\n        <ol>\n            <li>Click on one of your pyramids.</li>\n            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>\n        </ol><br/>\n        Do any simple step."]))),yfe.getInitialState(),kfe.from(new Zee(2,0),new Zee(2,1)).get(),function(e,t,n){return e.isSimpleStep()?pB.SUCCESS:pB.failure($localize(Tc||(Tc=_g(["You have made a double step, which is good but it is the next exercise!"]))))},$localize(Ic||(Ic=_g(["Congratulations!"])))),wte.fromPredicate($localize(Ac||(Ac=_g(["Double step"]))),$localize(Rc||(Rc=_g(["When a pyramid shares its vertices with dark spaces, it can move one or two steps.\n        To do so:\n        <ol>\n            <li>Click on the pyramid to move.</li>\n            <li>Click on one of the 6 destinations that you can reach in two steps:\n                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.\n        </ol>"]))),yfe.getInitialState(),kfe.from(new Zee(7,0),new Zee(5,0)).get(),function(e,t,n){return e.isSimpleStep()?pB.failure($localize(Mc||(Mc=_g(["Failed! You have made a single step."])))):pB.SUCCESS},$localize(xc||(xc=_g(["Congratulations!"]))))]});function Ofe(e,t){if(1&e&&(cC(),eP(0,"g"),nP(1,"polygon",7),tP()),2&e){var n=fP().index,r=fP().index,i=fP();pE(1),Xb("ngClass",i.getPlayerClassFor(n,r)),$b("points",i.getPyramidCoordinate(n,r))}}function Tfe(e,t){if(1&e&&(cC(),nP(0,"polygon",10)),2&e){var n=fP(2).index,r=fP().index;$b("points",fP().getTriangleCoordinate(n,r))}}function Ife(e,t){if(1&e&&(cC(),nP(0,"polygon",11)),2&e){var n=fP(2).index,r=fP().index;$b("points",fP().getTriangleCoordinate(n,r))}}function Afe(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Tfe,1,1,"polygon",8),Yb(2,Ife,1,1,"polygon",9),tP()),2&e){var n=fP().index,r=fP().index;pE(1),Xb("ngIf",(n+r)%2==1),pE(1),Xb("ngIf",(n+r)%2==0)}}function Rfe(e,t){if(1&e){var n=aP();cC(),eP(0,"g",5),uP("click",function(){var e=Nk(n).index,t=fP().index;return fP().onClick(e,t)}),Yb(1,Ofe,2,2,"g",6),Yb(2,Afe,3,2,"g",6),tP()}if(2&e){var r=t.$implicit;vP("id","click_",t.index,"_",fP().index,""),pE(1),Xb("ngIf",r.isPlayer()),pE(1),Xb("ngIf",2===r.value)}}function Mfe(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Rfe,3,4,"g",4),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}function xfe(e,t){if(1&e&&(cC(),nP(0,"polygon",14)),2&e){var n=t.$implicit,r=fP(2);vP("id","possible_landing_",n.x,"_",n.y,""),$b("points",r.getTriangleCoordinate(n.x,n.y))}}function Nfe(e,t){if(1&e&&(cC(),nP(0,"polygon",15)),2&e){var n=fP(2);vP("id","chosen_coord_",n.chosenCoord.get().x,"_",n.chosenCoord.get().y,""),$b("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}function Dfe(e,t){if(1&e&&(cC(),rP(0),Yb(1,xfe,1,3,"polygon",12),Yb(2,Nfe,1,3,"polygon",13),iP()),2&e){var n=fP();pE(1),Xb("ngForOf",n.possibleLandings),pE(1),Xb("ngIf",n.chosenCoord.isPresent())}}function Lfe(e,t){if(1&e&&(cC(),rP(0),nP(1,"polygon",16),nP(2,"polygon",16),iP()),2&e){var n=fP(2);pE(1),$b("points",n.getTriangleCoordinate(n.lastCoord.get().x,n.lastCoord.get().y)),pE(1),$b("points",n.getTriangleCoordinate(n.lastMoved.get().x,n.lastMoved.get().y))}}function Ffe(e,t){1&e&&(cC(),Yb(0,Lfe,3,2,"ng-container",6)),2&e&&Xb("ngIf",fP().lastMoved.isPresent())}var Ufe=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).lastCoord=fB.empty(),r.lastMoved=fB.empty(),r.chosenCoord=fB.empty(),r.possibleLandings=[],r.rules=new Cfe(yfe),r.availableMinimaxes=[new wfe(r.rules,"SaharaMinimax")],r.encoder=kfe.encoder,r.tutorial=(new Sfe).tutorial,r.updateBoard(),r}return Wg(n,[{key:"cancelMoveAttempt",value:function(){this.possibleLandings=[],this.chosenCoord=fB.empty()}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=n.rules.node.gameState.getCurrentPlayer(),o=jee.ofPlayer(a),r.abrupt("return",n.chosenCoord.isAbsent()||n.board[t][e]===o?n.choosePiece(e,t):n.chooseLandingCoord(e,t));case 5:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){if(this.board[t][e]===jee.EMPTY)return this.cancelMove(mfe.MUST_CHOOSE_PYRAMID_FIRST());if(this.board[t][e].is(R7.fromTurn(this.getTurn()))){var n=new Zee(e,t);return this.selectPiece(n),pB.SUCCESS}return this.cancelMove(mfe.MUST_CHOOSE_OWN_PYRAMID())}},{key:"selectPiece",value:function(e){this.chosenCoord=fB.of(e),this.possibleLandings=this.rules.getLandingCoords(this.board,e)}},{key:"chooseLandingCoord",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new Zee(e,t),!(a=kfe.from(n.chosenCoord.get(),i)).isFailure()){r.next=5;break}r.t0=n.cancelMove(a.getReason()),r.next=8;break;case 5:return r.next=7,n.chooseMove(a.get(),n.rules.node.gameState);case 7:r.t0=r.sent;case 8:return r.abrupt("return",r.t0);case 9:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.move;this.lastCoord=e.map(function(e){return e.coord}),this.lastMoved=e.map(function(e){return e.end}),this.board=this.rules.node.gameState.board}},{key:"getPlayerClassFor",value:function(e,t){return this.getPlayerClass(R7.of(this.board[t][e].value))}}]),n}(jne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-sahara"]],features:[Rb],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],["class","base no-fill small-stroke highlighted",3,"id",4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected",3,"id",4,"ngIf"],[1,"base","no-fill","small-stroke","highlighted",3,"id"],[1,"base","no-fill","small-stroke","selected",3,"id"],[1,"base","no-fill","small-stroke","moved-stroke"]],template:function(e,t){if(1&e&&(cC(),eP(0,"svg",0),Yb(1,Mfe,2,1,"g",1),Yb(2,Dfe,3,2,"ng-container",2),Yb(3,Ffe,1,1,"ng-template",null,3,MT),tP()),2&e){var n=Kb(4);pE(1),Xb("ngForOf",t.board),pE(1),Xb("ngIf",t.chosenCoord.isPresent())("ngIfElse",n)}},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Vfe=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this,e,r)).x=e,o.y=r,o.moveDirection=i,o.landingOrientation=a,o.checkValidity(),o}return Wg(n,[{key:"checkValidity",value:function(){var e=this.coord.isInRange(5,5);if(this.isRotation()){if(!e)throw new Error("Cannot rotate piece outside the board: "+this.toString()+".")}else if(this.coord.getNext(this.moveDirection.get()).isNotInRange(5,5)){if(!e)throw new Error("SiamMove should end or start on the board: "+this.toString()+".");if(this.moveDirection.get()!==this.landingOrientation)throw new Error("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+this.toString()+".")}}},{key:"isRotation",value:function(){return this.moveDirection.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||!1===this.moveDirection.equals(e.moveDirection))&&this.landingOrientation===e.landingOrientation}},{key:"toString",value:function(){var e=this.moveDirection.isAbsent()?"-":this.moveDirection.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}},{key:"isInsertion",value:function(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}]),n}(cte);Vfe.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"maxValue",value:function(){return 2408}},{key:"encodeNumber",value:function(e){var t=e.coord.y+1,n=e.coord.x+1,r=e.moveDirection.isAbsent()?4:e.moveDirection.get().toInt();return 245*e.landingOrientation.toInt()+49*r+7*n+t}},{key:"decodeNumber",value:function(e){var t=e%7;e-=t;var n=(e/=7)%7;e-=n;var r=(e/=7)%5,i=4===r?fB.empty():Gee.factory.fromInt(r).toOptional();e-=r;var a=Gee.factory.fromInt(e/=5).get();return new Vfe(n-1,t-1,i,a)}}]),n}(T7));var Bfe=function(){function e(t){Zg(this,e),this.value=t}return Wg(e,[{key:"belongTo",value:function(e){return e===R7.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}},{key:"isEmptyOrMountain",value:function(){return 0===this.value||9===this.value}},{key:"isPiece",value:function(){return!this.isEmptyOrMountain()}},{key:"getOwner",value:function(){return 1<=this.value&&this.value<=4?R7.ZERO:5<=this.value&&this.value<=8?R7.ONE:A7.NONE}},{key:"getOptionalDirection",value:function(){switch(this.value){case 0:return fB.empty();case 1:case 5:return fB.of(Gee.UP);case 2:case 6:return fB.of(Gee.RIGHT);case 3:case 7:return fB.of(Gee.DOWN);case 4:case 8:return fB.of(Gee.LEFT);default:return oB.expectToBe(this.value,9),fB.empty()}}},{key:"getDirection",value:function(){return this.getOptionalDirection().get()}},{key:"toString",value:function(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return oB.expectToBe(this.value,9),"MOUNTAIN"}}}],[{key:"decode",value:function(t){switch(t){case 0:return e.EMPTY;case 1:return e.LIGHT_UP;case 2:return e.LIGHT_RIGHT;case 3:return e.LIGHT_DOWN;case 4:return e.LIGHT_LEFT;case 5:return e.DARK_UP;case 6:return e.DARK_RIGHT;case 7:return e.DARK_DOWN;case 8:return e.DARK_LEFT;case 9:return e.MOUNTAIN}}},{key:"of",value:function(t,n){return n===R7.ZERO?t===Gee.UP?e.LIGHT_UP:t===Gee.RIGHT?e.LIGHT_RIGHT:t===Gee.DOWN?e.LIGHT_DOWN:e.LIGHT_LEFT:t===Gee.UP?e.DARK_UP:t===Gee.RIGHT?e.DARK_RIGHT:t===Gee.DOWN?e.DARK_DOWN:e.DARK_LEFT}}]),e}();Bfe.EMPTY=new Bfe(0),Bfe.LIGHT_UP=new Bfe(1),Bfe.LIGHT_RIGHT=new Bfe(2),Bfe.LIGHT_DOWN=new Bfe(3),Bfe.LIGHT_LEFT=new Bfe(4),Bfe.DARK_UP=new Bfe(5),Bfe.DARK_RIGHT=new Bfe(6),Bfe.DARK_DOWN=new Bfe(7),Bfe.DARK_LEFT=new Bfe(8),Bfe.MOUNTAIN=new Bfe(9);var zfe=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"countPlayerPawn",value:function(){for(var e=0,t=0;t<5;t++)for(var n=0;n<5;n++)this.board[t][n].belongTo(this.getCurrentPlayer())&&e++;return e}}],[{key:"getInitialState",value:function(){var e=D7.createTable(5,5,Bfe.EMPTY);return e[2][1]=Bfe.MOUNTAIN,e[2][2]=Bfe.MOUNTAIN,e[2][3]=Bfe.MOUNTAIN,new n(e,0)}}]),n}(ote),Hfe=function(){var e=Wg(function e(){Zg(this,e)});return e.CANNOT_INSERT_WHEN_SELECTED=function(){return $localize(Nc||(Nc=_g(["You cannot insert a piece when you have already selected a piece."])))},e.NO_REMAINING_PIECE_TO_INSERT=function(){return $localize(Dc||(Dc=_g(["You cannot insert a piece, all your pieces are already on the board."])))},e.NOT_ENOUGH_FORCE_TO_PUSH=function(){return $localize(Lc||(Lc=_g(["You do not have enough strength to push."])))},e.MUST_MOVE_OR_ROTATE=function(){return $localize(Fc||(Fc=_g(["You must move or rotate your piece."])))},e.ILLEGAL_PUSH=function(){return $localize(Uc||(Uc=_g(["Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board."])))},e.MUST_INSERT_OR_CHOOSE_YOUR_PIECE=function(){return $localize(Vc||(Vc=_g(["You should insert or choose one of your pieces!"])))},e}(),Gfe=Wg(function e(t,n){Zg(this,e),this.resultingBoard=t,this.moved=n}),$fe=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"isLegal",value:function(e,t){if(sB(n.VERBOSE,{SiamRules_isLegal:{move:e,state:t}}),!e.isInsertion()&&!t.getPieceAt(e.coord).belongTo(t.getCurrentPlayer()))return hB.failure(ete.MUST_CHOOSE_PLAYER_PIECE());if(e.isRotation())return sB(n.VERBOSE,"Move is rotation"),this.isLegalRotation(e,t);var r;if(e.isInsertion()){sB(n.VERBOSE,"Move is insertion");var i=this.isLegalInsertion(e.coord,t);if(i.legal.isFailure())return hB.failure(i.legal.getReason());r=i.insertedPiece}else sB(n.VERBOSE,"Move is forward"),r=t.getPieceAt(e.coord);return n.isLegalForwarding(e,t,r)}},{key:"isLegalInsertion",value:function(e,t){var r=t.countPlayerPawn(),i=t.getCurrentPlayer(),a=r<5?pB.SUCCESS:pB.failure(Hfe.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:n.getInsertedPiece(e,i),legal:a}}},{key:"isLegalRotation",value:function(e,t){sB(n.VERBOSE,{isLegalRotation:{rotation:e,state:t}});var r=e.coord,i=t.getPieceAt(r),a=t.getCurrentPlayer();if(i.getDirection()===e.landingOrientation)return hB.failure(Hfe.MUST_MOVE_OR_ROTATE());var o=t.getCopiedBoard();return o[r.y][r.x]=Bfe.of(e.landingOrientation,a),hB.success(new Gfe(o,[r]))}},{key:"applyLegalMove",value:function(e,t,n){var r=D7.copyBiArray(n.resultingBoard);return new zfe(r,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=n.getMountainsRowsAndColumns(e.gameState),r=n.getWinner(e.gameState,e.move,t.nbMountain);return r.isPlayer()?gte.getVictory(r):gte.ONGOING}}],[{key:"getInsertedPiece",value:function(e,t){return Bfe.of(-1===e.x?Gee.RIGHT:-1===e.y?Gee.DOWN:5===e.x?Gee.LEFT:Gee.UP,t)}},{key:"isLegalForwarding",value:function(e,t,r){sB(n.VERBOSE,{isLegalForwarding:{move:e.toString(),state:t,firstPiece:r}});var i=[],a=Bfe.of(e.landingOrientation,t.getCurrentPlayer()),o=e.moveDirection.get(),s=e.coord.getNext(o);if(s.isInRange(5,5)&&t.getPieceAt(s)!==Bfe.EMPTY&&!1===n.isStraight(r,e))return sB(n.VERBOSE,"Illegal push because not straight or not pushing anything or leaving the board"),hB.failure(Hfe.ILLEGAL_PUSH());var u=fB.of(o),c=o.getOpposite(),l=0,f=t.getCopiedBoard();e.coord.isInRange(5,5)&&(f[e.coord.y][e.coord.x]=Bfe.EMPTY,i.push(e.coord));for(var h=s.isInRange(5,5)&&a!==Bfe.EMPTY;h;){u.equalsValue(o)?l++:u.equalsValue(c)&&l--,sB(n.VERBOSE,{totalForce:l,movingPiece:a,landingCoord:s});var d=f[s.y][s.x];d===Bfe.MOUNTAIN&&(l-=.9),f[s.y][s.x]=a,i.push(s),a=d,s=s.getNext(o),u=a.getOptionalDirection(),h=s.isInRange(5,5)&&a!==Bfe.EMPTY&&l>0}return s.isNotInRange(5,5)&&(sB(n.VERBOSE,"This movement would push "+a+" outside the board"),u.equalsValue(o)?l++:u.equalsValue(c)&&l--),l<=0?(sB(n.VERBOSE,"This move is an illegal push: "+f),hB.failure(Hfe.NOT_ENOUGH_FORCE_TO_PUSH())):(sB(n.VERBOSE,"This move is a legal push: "+f),hB.success(new Gfe(f,i)))}},{key:"isStraight",value:function(e,t){var n=e.getDirection();return t.moveDirection.equalsValue(n)&&n===t.landingOrientation}},{key:"getBoardValueInfo",value:function(e,t){var r=n.getMountainsRowsAndColumns(t),i=r.rows,a=r.columns,o=n.getWinner(t,e,r.nbMountain);if(o.isPlayer())return o===R7.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};var s,u=n.getPushers(t,a,i),c=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER,f=t.getCurrentPlayer(),h=Hg(u);try{for(h.s();!(s=h.n()).done;){var d=s.value;d.coord.isInRange(5,5)?t.getPieceAt(d.coord).belongTo(R7.ZERO)?c=Math.min(c,d.distance):l=Math.min(l,d.distance):f===R7.ZERO?c=Math.min(c,d.distance):l=Math.min(l,d.distance)}}catch(v){h.e(v)}finally{h.f()}return{shortestZero:c,shortestOne:l,boardValue:n.getScoreFromShortestDistances(c,l,f)}}},{key:"getScoreFromShortestDistances",value:function(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);var r=6-e,i=6-t;return r===i?n.getScoreModifier():r>i?-10*(r+1)+(i+1):10*(i+1)-(r+1)}},{key:"getMountainsRowsAndColumns",value:function(e){for(var t=[],n=[],r=0,i=0;i<5;i++)for(var a=0;a<5;a++)e.getPieceAtXY(a,i)===Bfe.MOUNTAIN&&(t.includes(i)||t.push(i),n.includes(a)||n.push(a),r++);return{rows:t,columns:n,nbMountain:r}}},{key:"getWinner",value:function(e,t,r){return 2===r?n.getPusher(e,t.get()):A7.NONE}},{key:"getPusher",value:function(e,t){var r=t.coord,i=(r.isInRange(5,5)?e.getPieceAt(r.getNext(t.landingOrientation)):n.getInsertedPiece(r,e.getCurrentOpponent())).getDirection(),a=n.getPusherCoord(e,i,r),o=e.getPieceAt(a).getOwner();return sB(n.VERBOSE,r.toString()+" belong to "+e.getCurrentOpponent().value+", "+a.toString()+" belong to "+o.value+", "+o.value+" win"),o}},{key:"getPusherCoord",value:function(e,t,n){for(var r=n.getNext(t),i=n;r.isInRange(5,5);){n=r,r=r.getNext(t);var a=e.getPieceAt(n);a!==Bfe.MOUNTAIN&&a.getDirection()===t&&(i=n)}return i}},{key:"getPushers",value:function(e,t,r){sB(n.VERBOSE,{getPushers:{state:e,mountainsColumn:t,mountainsRow:r}});var i,a=[],o=[],s=Hg(t);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=Gee.DOWN,l=new Zee(u,4);o.push({direction:c,fallingCoord:l}),c=Gee.UP,l=new Zee(u,0),o.push({direction:c,fallingCoord:l})}}catch(k){s.e(k)}finally{s.f()}var f,h=Hg(r);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=Gee.LEFT,p=new Zee(0,d);o.push({direction:v,fallingCoord:p}),v=Gee.RIGHT,p=new Zee(4,d),o.push({direction:v,fallingCoord:p})}}catch(k){h.e(k)}finally{h.f()}for(var g=0,y=o;g<y.length;g++){var m=y[g];a=n.addPotentialDirectionPusher(e,m.fallingCoord,m.direction,a)}return a}},{key:"addPotentialDirectionPusher",value:function(e,t,r,i){var a=n.getLineClosestPusher(e,t,r);if(a.isAbsent())return i;var o=a.get(),s=o.distance;return sB(n.VERBOSE,"new closest challenger"),i.push({coord:o.coord,distance:s}),i}},{key:"getLineClosestPusher",value:function(e,t,r){sB(n.VERBOSE,{getDirectionClosestPusher:{state:e,fallingCoord:t,direction:r.toString()}});for(var i=r.getOpposite(),a=1,o=e.getPieceAt(t),s=t,u=fB.empty(),c=!1,l=!1,f=0;s.isInRange(5,5)&&!1===c;){var h=e.getPieceAt(s);if(h.isEmptyOrMountain())h===Bfe.MOUNTAIN?(f+=.9,l=!0):a++;else{var d=h.getDirection();d===r?l&&((f-=1)<=0&&(c=!0,s=s.getNext(r))):d===i?(f+=1,l||a++):l?(u=fB.of(s),o!==Bfe.EMPTY&&a++):a++}o=h,s=s.getPrevious(r)}if(!1===c&&u.isPresent())for(a++,f-=1;!1===s.equals(u.get());)s=s.getNext(r),a--;return s.isNotInRange(5,5)&&(f-=1,5===e.countPlayerPawn())||f>0?fB.empty():fB.of({distance:a,coord:s})}},{key:"getPushingInsertions",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=[],i=[],a=0;a<5;a++)r.push(new Vfe(-1,a,fB.of(Gee.RIGHT),Gee.RIGHT)),i.push(Bfe.of(Gee.RIGHT,n)),r.push(new Vfe(5,a,fB.of(Gee.LEFT),Gee.LEFT)),i.push(Bfe.of(Gee.LEFT,n)),r.push(new Vfe(a,-1,fB.of(Gee.DOWN),Gee.DOWN)),i.push(Bfe.of(Gee.DOWN,n)),r.push(new Vfe(a,5,fB.of(Gee.UP),Gee.UP)),i.push(Bfe.of(Gee.UP,n));for(var o=0;o<r.length;o++)this.isLegalForwarding(r[o],e,i[o]).isSuccess()&&t.push(r[o]);return t}},{key:"getDerapingInsertions",value:function(e){for(var t,n,r=[],i=e.getCurrentPlayer(),a=1;a<=3;a++)t=new Vfe(-1,a,fB.of(Gee.RIGHT),Gee.UP),n=Bfe.of(Gee.UP,i),this.isLegalForwarding(t,e,n).isSuccess()&&(r.push(t),t=new Vfe(-1,a,fB.of(Gee.RIGHT),Gee.DOWN),n=Bfe.of(Gee.DOWN,i),this.isLegalForwarding(t,e,n),r.push(t)),t=new Vfe(5,a,fB.of(Gee.LEFT),Gee.UP),n=Bfe.of(Gee.UP,i),this.isLegalForwarding(t,e,n).isSuccess()&&(r.push(t),t=new Vfe(5,a,fB.of(Gee.LEFT),Gee.DOWN),n=Bfe.of(Gee.DOWN,i),this.isLegalForwarding(t,e,n),r.push(t));for(var o=1;o<=3;o++)t=new Vfe(o,-1,fB.of(Gee.DOWN),Gee.LEFT),n=Bfe.of(Gee.LEFT,i),this.isLegalForwarding(t,e,n).isSuccess()&&(r.push(t),t=new Vfe(o,-1,fB.of(Gee.DOWN),Gee.RIGHT),n=Bfe.of(Gee.RIGHT,i),this.isLegalForwarding(t,e,n),r.push(t)),t=new Vfe(o,5,fB.of(Gee.UP),Gee.LEFT),n=Bfe.of(Gee.LEFT,i),this.isLegalForwarding(t,e,n).isSuccess()&&(r.push(t),t=new Vfe(o,5,fB.of(Gee.UP),Gee.RIGHT),n=Bfe.of(Gee.RIGHT,i),this.isLegalForwarding(t,e,n),r.push(t));return r}},{key:"getCoordDirection",value:function(e,t,n){var r=new Zee(t,n);return this.getInsertedPiece(r,e.getCurrentPlayer()).getDirection()}},{key:"getMovesFrom",value:function(e,t,r,i){var a,o=[],s=t.getDirection(),u=Hg(Gee.ORTHOGONALS);try{for(u.s();!(a=u.n()).done;){var c=a.value;if(c!==s){var l=new Vfe(r,i,fB.empty(),c);o.push(l)}var f,h=Hg(new Zee(r+c.x,i+c.y).isInRange(5,5)?Gee.ORTHOGONALS:[c]);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=new Vfe(r,i,fB.of(c),d);n.isLegalForwarding(v,e,t).isSuccess()&&o.push(v)}}catch(p){h.e(p)}finally{h.f()}}}catch(p){u.e(p)}finally{u.f()}return o}}]),n}(yte);return e.VERBOSE=!1,e}(),Zfe=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getBoardValue",value:function(e){return new nte($fe.getBoardValueInfo(e.move,e.gameState).boardValue)}},{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState.getCurrentPlayer(),r=0;r<5;r++)for(var i=0;i<5;i++){var a=e.gameState.getPieceAtXY(i,r);a.belongTo(n)&&(t=t.concat($fe.getMovesFrom(e.gameState,a,i,r)))}return e.gameState.countPlayerPawn()<5&&(t=(t=t.concat($fe.getPushingInsertions(e.gameState))).concat($fe.getDerapingInsertions(e.gameState))),sB($fe.VERBOSE,{getListMovesResult:t}),t}}]),n}(tte),qfe=Bfe.EMPTY,Wfe=Bfe.MOUNTAIN,jfe=Bfe.LIGHT_UP,Yfe=Bfe.LIGHT_LEFT,Kfe=Bfe.LIGHT_RIGHT,Qfe=Bfe.LIGHT_DOWN,Xfe=Bfe.DARK_UP,Jfe=Bfe.DARK_LEFT,ehe=Bfe.DARK_RIGHT,the=Bfe.DARK_DOWN,nhe=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(Bc||(Bc=_g(["Goal of the game"]))),$localize(zc||(zc=_g(["The goal at Siam is to be the first to push a mountain out of the board.\n        The initial board contains three mountains, and no pieces are initially on the board.\n        During its turn, a player can do one of the following three actions:\n        <ol>\n            <li>Put a new piece on the board.</li>\n            <li>Change the orientation of one of its piece, and optionally move it.</li>\n            <li>Take one of its pieces out of the board.</li>\n        </ol>"]))),zfe.getInitialState()),wte.anyMove($localize(Hc||(Hc=_g(["Inserting a piece"]))),$localize(Gc||(Gc=_g(["Each player has 5 pieces in total.\n        As long as you do not have 5 pieces on the board, you can insert new pieces. To do so:\n        <ol>\n            <li>Click on one of the big arrows alongside the board.</li>\n            <li>Click on one of the small arrows that appeared on the landing square of your piece.\n                This is the direction in which your piece will be oriented.</li>\n        </ol><br/>\n        Insert a piece on the board."]))),zfe.getInitialState(),new Vfe(2,-1,fB.of(Gee.DOWN),Gee.DOWN),$localize($c||($c=_g(["Congratulations!"])))),wte.fromMove($localize(Zc||(Zc=_g(["Moving a piece"]))),$localize(qc||(qc=_g(['We will distinguish here "moving" and "pushing".\n        A move is made from a piece\'s square to an empty neighboring square, horizontally or vertically.\n        During that move, you can also move the piece out of the board.\n        To move a piece:\n        <ol>\n            <li>Click on it.</li>\n            <li>Click on one of the 4 arrows to pick the direction in which it will move.\n                You can also click on the middle dot to change the piece\'s orientation without moving it.</li>\n            <li>Click on one of the 4 arrows on the landing square to pick its orientation.</li>\n        </ol><br/>\n        Try to move the piece that is on the board one square upwards and to orient it downwards.']))),new zfe([[qfe,qfe,qfe,qfe,qfe],[qfe,qfe,qfe,qfe,qfe],[qfe,Wfe,Wfe,Wfe,qfe],[qfe,qfe,qfe,qfe,qfe],[qfe,qfe,jfe,qfe,qfe]],0),[new Vfe(2,4,fB.of(Gee.UP),Gee.DOWN)],$localize(Wc||(Wc=_g(["Congratulations, you made a side-slip!"]))),$localize(jc||(jc=_g(["Failed!"])))),wte.fromMove($localize(Yc||(Yc=_g(["Moving a piece out of the board"]))),$localize(Kc||(Kc=_g(["To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>\n        Get that piece out of the board!"]))),new zfe([[qfe,qfe,qfe,qfe,qfe],[qfe,qfe,qfe,qfe,qfe],[qfe,Wfe,Wfe,Wfe,qfe],[qfe,qfe,qfe,qfe,qfe],[qfe,qfe,jfe,qfe,qfe]],0),[new Vfe(2,4,fB.of(Gee.DOWN),Gee.DOWN)],$localize(Qc||(Qc=_g(["Congratulations, even if in this context it was not a useful move."]))),$localize(Xc||(Xc=_g(["Failed, the piece is still on the board."])))),wte.fromMove($localize(Jc||(Jc=_g(["Pushing"]))),$localize(el||(el=_g(['When the landing square of your move is occupied, we use the term "push".\n        In order to push, multiple conditions must hold:\n        <ol>\n            <li>Your piece must already be oriented in the direction of the push.</li>\n            <li>The number of the pieces (opponent\'s or not) that are facing yours (called the resistants)\n                must be smaller than the number of pieces that are oriented in the same direction as the push, yourself included (the pushers).</li>\n            <li>The number of mountains on that line must be smaller or equal to the difference between the pushers and the resistants.</li>\n        </ol>\n        Your piece on the top right cannot push because there is one mountain too much.\n        Your piece on the bottom right can push.<br/><br/>\n        Do it.']))),new zfe([[Kfe,Wfe,Wfe,Jfe,Yfe],[qfe,qfe,qfe,qfe,qfe],[qfe,qfe,qfe,Wfe,qfe],[qfe,qfe,qfe,qfe,qfe],[qfe,qfe,ehe,Jfe,Yfe]],0),[new Vfe(4,4,fB.of(Gee.LEFT),Gee.LEFT)],$localize(tl||(tl=_g(["Congratulations!"]))),$localize(nl||(nl=_g(["Failed!"])))),wte.fromMove($localize(rl||(rl=_g(["Victory"]))),$localize(il||(il=_g(["The game ends when a mountain is pushed out of the board.\n        If you pushed it and nobody is in front of you, you're the winner.\n        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.\n        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>\n        You have two ways of ending the game here: you can either win, or lose. Choose correctly!"]))),new zfe([[qfe,qfe,qfe,qfe,qfe],[qfe,qfe,qfe,qfe,qfe],[Wfe,Xfe,Yfe,qfe,Qfe],[qfe,qfe,qfe,qfe,the],[qfe,qfe,qfe,qfe,Wfe]],0),[new Vfe(2,2,fB.of(Gee.LEFT),Gee.LEFT)],$localize(al||(al=_g(["Congratulations, you won!"]))),$localize(ol||(ol=_g(["Failed, you lost."]))))]});function rhe(e,t){if(1&e){var n=aP();cC(),eP(0,"use",7),uP("click",function(){var e=Nk(n).$implicit;return fP(3).insertAt(e.x,e.y)}),tP()}if(2&e){var r=t.$implicit,i=fP(3);vP("id","insertAt_",r.x,"_",r.y,""),$b("transform",i.getInsertionArrowTransform(r.x+1,r.y+1,r.dir))}}var ihe=function(e,t){return{dir:"DOWN",x:e,y:t}},ahe=function(e){return{dir:"UP",x:e,y:5}},ohe=function(e,t){return{dir:"RIGHT",x:e,y:t}},she=function(e){return{dir:"LEFT",x:5,y:e}},uhe=function(e,t,n,r){return[e,t,n,r]};function che(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,rhe,1,3,"use",6),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",function(e,t,n,r,i,a,o){return function(e,t,n,r,i,a,o,s,u){var c=t+n;return function(e,t,n,r,i,a){var o=Gb(e,t,n,r);return Gb(e,t+2,i,a)||o}(e,c,i,a,o,s)?zb(e,c+4,u?r.call(u,i,a,o,s):r(i,a,o,s)):uT(e,c+4)}(Mk(),Gk(),e,t,n,r,i,a,o)}(11,uhe,sT(1,ihe,n,-1),oT(4,ahe,n),sT(6,ohe,-1,n),oT(9,she,n)))}}var lhe=function(){return[0,1,2,3,4]};function fhe(e,t){1&e&&(cC(),rP(0),Yb(1,che,2,16,"g",5),iP()),2&e&&(pE(1),Xb("ngForOf",aT(1,lhe)))}function hhe(e,t){if(1&e){var n=aP();cC(),eP(0,"use",13),uP("click",function(){var e=Nk(n).$implicit;return fP(5).chooseDirection(e)}),tP()}if(2&e){var r=t.$implicit,i=fP(3).index,a=fP().index,o=fP();dP("id","chooseDirection_",r,""),$b("transform",o.getArrowTransform(i+1,a+1,r))}}var dhe=function(){return["RIGHT","DOWN","LEFT","UP"]};function vhe(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"circle",11),uP("click",function(){return Nk(n),fP(4).chooseDirection("")}),tP(),Yb(2,hhe,1,2,"use",12),tP()}if(2&e){var r=fP(2).index,i=fP().index,a=fP();pE(1),$b("cx",(r+1)*a.SPACE_SIZE+a.SPACE_SIZE/2)("cy",(i+1)*a.SPACE_SIZE+a.SPACE_SIZE/2),pE(1),Xb("ngForOf",aT(3,dhe))}}function phe(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"use",10),uP("click",function(){Nk(n);var e=fP().index,t=fP().index;return fP().clickPiece(e,t)}),tP(),Yb(2,vhe,3,4,"g",4),tP()}if(2&e){var r=fP(),i=r.index,a=r.$implicit,o=fP().index,s=fP();pE(1),vP("id","clickPiece_",i,"_",o,""),Xb("ngClass",s.getPieceClasses(a)),$b("transform",s.getPieceTransform(i,o)),pE(1),Xb("ngIf",s.choosingDirection(i,o))}}function ghe(e,t){if(1&e){var n=aP();cC(),eP(0,"use",14),uP("click",function(){Nk(n);var e=fP().index,t=fP().index;return fP().clickPiece(e,t)}),tP()}if(2&e){var r=fP().index,i=fP().index,a=fP();$b("transform","translate("+(r+1)*a.SPACE_SIZE+" "+(i+1)*a.SPACE_SIZE+")")}}function yhe(e,t){if(1&e){var n=aP();cC(),eP(0,"use",13),uP("click",function(){var e=Nk(n).$implicit;return fP(4).chooseOrientation(e)}),tP()}if(2&e){var r=t.$implicit,i=fP(2).index,a=fP().index,o=fP();dP("id","chooseOrientation_",r,""),$b("transform",o.getArrowTransform(i+1,a+1,r))}}function mhe(e,t){1&e&&(cC(),eP(0,"g"),Yb(1,yhe,1,2,"use",12),tP()),2&e&&(pE(1),Xb("ngForOf",aT(1,dhe)))}function khe(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"rect",8),uP("click",function(){var e=Nk(n).index,t=fP().index;return fP().insertAt(e,t)}),tP(),Yb(2,phe,3,5,"g",4),Yb(3,ghe,1,1,"use",9),Yb(4,mhe,2,2,"g",4),tP()}if(2&e){var r=t.$implicit,i=t.index,a=fP().index,o=fP();pE(1),vP("id","insertAt_",i,"_",a,""),Xb("ngClass",o.getSquareClasses(i,a)),$b("x",o.SPACE_SIZE*(i+1))("y",o.SPACE_SIZE*(a+1))("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),pE(1),Xb("ngIf",r.isPiece()),pE(1),Xb("ngIf",o.isMountain(r)),pE(1),Xb("ngIf",o.choosingOrientation(i,a))}}function Che(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,khe,5,10,"g",5),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}var whe=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).lastMove=fB.empty(),r.chosenCoord=fB.empty(),r.landingCoord=fB.empty(),r.chosenDirection=fB.empty(),r.chosenOrientation=fB.empty(),r.movedPieces=[],r.rules=new $fe(zfe),r.availableMinimaxes=[new Zfe(r.rules,"SiamMinimax")],r.encoder=Vfe.encoder,r.tutorial=(new nhe).tutorial,r.updateBoard(),r}return Wg(n,[{key:"updateBoard",value:function(){if(sB(n.VERBOSE,"updateBoard"),this.board=this.rules.node.gameState.board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.rules.node.mother.get().gameState;this.movedPieces=this.rules.isLegal(this.lastMove.get(),e).get().moved}else this.movedPieces=[]}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=fB.empty(),this.chosenDirection=fB.empty(),this.landingCoord=fB.empty(),this.chosenOrientation=fB.empty()}},{key:"clickPiece",value:function(e,t){var n=this.canUserPlay("#clickPiece_"+e+"_"+t);return n.isFailure()?this.cancelMove(n.getReason()):this.board[t][e].getOwner()!==this.getCurrentPlayer()?this.cancelMove(ete.MUST_CHOOSE_PLAYER_PIECE()):(this.chosenCoord=fB.of(new Zee(e,t)),pB.SUCCESS)}},{key:"chooseDirection",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(sB(n.VERBOSE,"SiamComponent.chooseDirection("+e+")"),!(i=t.canUserPlay("#chooseDirection_"+e)).isFailure()){r.next=4;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 4:if(""!==e){r.next=8;break}t.chosenDirection=fB.empty(),t.landingCoord=t.chosenCoord,r.next=15;break;case 8:if(a=Gee.factory.fromString(e).get(),t.chosenDirection=fB.of(a),t.landingCoord=fB.of(t.chosenCoord.get().getNext(a)),!t.landingCoord.get().isNotInRange(5,5)){r.next=15;break}return sB(n.VERBOSE,"orientation and direction should be the same: "+a),t.chosenOrientation=fB.of(a),r.next=14,t.tryMove();case 14:return r.abrupt("return",r.sent);case 15:return r.abrupt("return",pB.SUCCESS);case 16:case"end":return r.stop()}},r)}))()}},{key:"chooseOrientation",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(sB(n.VERBOSE,"SiamComponent.chooseOrientation("+e+")"),!(i=t.canUserPlay("#chooseOrientation_"+e)).isFailure()){r.next=6;break}r.t0=t.cancelMove(i.getReason()),r.next=10;break;case 6:return t.chosenOrientation=fB.of(Gee.factory.fromString(e).get()),r.next=9,t.tryMove();case 9:r.t0=r.sent;case 10:return r.abrupt("return",r.t0);case 11:case"end":return r.stop()}},r)}))()}},{key:"insertAt",value:function(e,t){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(sB(n.VERBOSE,"SiamComponent.insertAt("+e+", "+t+")"),!(a=r.canUserPlay("#insertAt_"+e+"_"+t)).isFailure()){i.next=4;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 4:if(!r.chosenCoord.isPresent()){i.next=6;break}return i.abrupt("return",r.cancelMove(Hfe.CANNOT_INSERT_WHEN_SELECTED()));case 6:if(o=new Zee(e,t),!r.getState().isOnBoard(o)||!r.getState().getPieceAtXY(e,t).isEmptyOrMountain()){i.next=9;break}return i.abrupt("return",r.cancelMove(Hfe.MUST_INSERT_OR_CHOOSE_YOUR_PIECE()));case 9:return r.chosenCoord=fB.of(o),s=$fe.getCoordDirection(r.getState(),e,t),i.abrupt("return",(r.chosenDirection=fB.of(s),r.landingCoord=fB.of(r.chosenCoord.get().getNext(s)),pB.SUCCESS));case 12:case"end":return i.stop()}},i)}))()}},{key:"tryMove",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new Vfe(n.x,n.y,e.chosenDirection,e.chosenOrientation.get()),e.cancelMove(),t.next=4,e.chooseMove(r,e.rules.node.gameState);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t)}))()}},{key:"isMountain",value:function(e){return e===Bfe.MOUNTAIN}},{key:"choosingOrientation",value:function(e,t){var r=new Zee(e,t);return!!(this.chosenCoord.isPresent()&&this.landingCoord.equalsValue(r)&&this.chosenOrientation.isAbsent())&&(sB(n.VERBOSE,"choosing orientation now"),!0)}},{key:"choosingDirection",value:function(e,t){var r=new Zee(e,t);return!!(this.chosenCoord.equalsValue(r)&&this.chosenDirection.isAbsent()&&this.landingCoord.isAbsent()&&this.chosenOrientation.isAbsent())&&(sB(n.VERBOSE,"choosing direction now"),!0)}},{key:"getInsertionArrowTransform",value:function(e,t,n){var r="rotate(".concat(90*(Gee.factory.fromString(n).get().toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",r].join(" ")}},{key:"getPieceTransform",value:function(e,t){var n="rotate(".concat(90*(this.board[t][e].getDirection().toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate("+(e+1)*this.SPACE_SIZE+", "+(t+1)*this.SPACE_SIZE+")",n].join(" ")}},{key:"getArrowTransform",value:function(e,t,n){return Wle.getArrowTransform(this.SPACE_SIZE,new Zee(e,t),Gee.factory.fromString(n).get())}},{key:"getPieceClasses",value:function(e){return[this.getPlayerClass(e.getOwner())]}},{key:"getSquareClasses",value:function(e,t){var n=new Zee(e,t);return this.movedPieces.some(function(e){return e.equals(n)})?["moved"]:[]}}]),n}(nne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-siam"]],features:[Rb],decls:7,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 700 700","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 93, 90 50, 70 50, 70 7, 27.5 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngIf"],[4,"ngFor","ngForOf"],[0,"xlink","href","#arrow","class","base mid-stroke",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","click"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#mountain","fill","brown",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],["id","chooseDirection_","r","8",1,"arrow","selected-fill","no-stroke",3,"click"],["class","arrow selected-fill no-stroke",0,"xlink","href","#triangle",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"arrow","selected-fill","no-stroke",3,"id","click"],[0,"xlink","href","#mountain","fill","brown",3,"click"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),eP(1,"defs"),nP(2,"polygon",1),nP(3,"polygon",2),nP(4,"polygon",3),tP(),Yb(5,fhe,2,2,"ng-container",4),Yb(6,Che,2,1,"g",5),tP()),2&e&&(pE(5),Xb("ngIf",t.isPlayerTurn()),pE(1),Xb("ngForOf",t.board))},directives:[UA,LA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),_he=function(){var e=Wg(function e(){Zg(this,e)});return e.NO_MOVEMENT_BEFORE_TURN_40=function(){return $localize(sl||(sl=_g(["You cannot move yet. Pick a space where you will put a new piece."])))},e.MUST_CUT=function(){return $localize(ul||(ul=_g(["Several groups are of the same size, you must pick the one to keep."])))},e.CANNOT_CHOOSE_TO_KEEP=function(){return $localize(cl||(cl=_g(["You cannot choose which part to keep when one is smaller than the other."])))},e.CAN_NO_LONGER_DROP=function(){return $localize(ll||(ll=_g(["You cannot put new pieces anymore. Pick a piece to move."])))},e.MUST_CAPTURE_BIGGEST_GROUPS=function(){return $localize(fl||(fl=_g(["You must choose one of the biggest groups to keep it."])))},e.CANNOT_KEEP_EMPTY_COORD=function(){return $localize(hl||(hl=_g(["You cannot pick an empty space. Pick one of the biggest groups."])))},e.MUST_DROP_NEXT_TO_OTHER_PIECE=function(){return $localize(dl||(dl=_g(["You must put this piece next to another piece."])))},e}(),Ehe=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;Zg(this,n),(a=t.call(this,r)).pieces=e;var o=a.getCalculatedScale();return a.pieces=o.pieces,a.width=o.width,a.height=o.height,a.offset=null!=i?i:o.offset,a.pieces.makeImmutable(),a}return Wg(n,[{key:"getCalculatedScale",value:function(){var e,t=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,a=Hg(this.pieces.listKeys());try{for(a.s();!(e=a.n()).done;){var o=e.value;t=Math.min(o.x,t),n=Math.max(o.x,n),r=Math.min(o.y,r),i=Math.max(o.y,i)}}catch(v){a.e(v)}finally{a.f()}var s=new dte,u=new Vee(-t,-r);if(0!==t||0!==r){var c,l=Hg(this.pieces.listKeys());try{for(l.s();!(c=l.n()).done;){var f=c.value,h=this.pieces.delete(f),d=f.getNext(u);s.set(d,h)}}catch(v){l.e(v)}finally{l.f()}}else s=this.pieces;return{width:n+1-t,height:i+1-r,pieces:s,offset:u}}},{key:"toRepresentation",value:function(){var e,t=D7.createTable(this.width,this.height,A7.NONE.value),n=Hg(this.pieces.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.getPieceAt(r).value;t[r.y][r.x]=i}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"isIllegalLandingZone",value:function(e,t){return this.pieces.containsKey(e)?pB.failure(ete.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?pB.SUCCESS:pB.failure(_he.MUST_DROP_NEXT_TO_OTHER_PIECE())}},{key:"isCoordConnected",value:function(e,t){var n,r=Hg(Yee.factory.all);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=e.getNext(i,1);if(this.pieces.containsKey(a)&&!1===t.equalsValue(a))return!0}}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"isOnBoard",value:function(e){return this.pieces.containsKey(e)}},{key:"getPieceAt",value:function(e){return this.isOnBoard(e)?this.pieces.get(e).get():A7.NONE}},{key:"applyLegalDrop",value:function(e){var t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new n(t,this.turn+1)}},{key:"applyLegalDeplacement",value:function(e,t){var r=n.deplacePiece(this,e),i=new dte;if(t.size()>0){i=new dte;var a,o=Hg(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.set(s,r.get(s).get())}}catch(u){o.e(u)}finally{o.f()}}else i=r.getCopy();return new n(i,this.turn+1)}},{key:"countPieces",value:function(){var e=this.pieces.reverse(),t=e.get(R7.ZERO).getOrElse(new One),n=e.get(R7.ONE).getOrElse(new One);return[t.size(),n.size()]}},{key:"switchPiece",value:function(e){var t=this.pieces.getCopy(),r=this.getPieceAt(e);if(r.isPlayer())return t.replace(e,r.getOpponent()),new n(t,this.turn,this.offset);d7.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:e.toString()})}},{key:"equals",value:function(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation([[R7.ZERO.value],[R7.ONE.value]],0)}},{key:"fromRepresentation",value:function(e,t,r){for(var i=new dte,a=0;a<e.length;a++)for(var o=0;o<e[0].length;o++)e[a][o]!==A7.NONE.value&&i.set(new Zee(o,a),R7.of(e[a][o]));return new n(i,t,r)}},{key:"deplacePiece",value:function(e,t){var n=e.pieces.getCopy();return n.delete(t.start.get()),n.set(t.landing,e.getCurrentPlayer()),n}},{key:"getGroups",value:function(e,t){var r,i=new dte,a=0,o=Hg(Yee.factory.all);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=t.getNext(s,1);i=n.putCoordInGroup(e,u,i,""+a),a++}}catch(h){o.e(h)}finally{o.f()}for(var c=i.reverse(),l=new ite,f=0;f<c.size();f++)l.add(c.getByIndex(f).value);return l}},{key:"putCoordInGroup",value:function(e,t,r,i){if(e.get(t).isPresent()&&r.get(t).isAbsent()){r.set(t,i);var a,o=Hg(Yee.factory.all);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=t.getNext(s,1);r=n.putCoordInGroup(e,u,r,i)}}catch(c){o.e(c)}finally{o.f()}}return r}}]),n}(ate),bhe=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;if(Zg(this,n),(a=t.call(this)).start=e,a.landing=r,a.keep=i,e.equalsValue(r))throw new Error("Deplacement cannot be static!");if(e.isPresent()&&e.equals(i))throw new Error("Cannot keep starting coord, since it will always be empty after move!");return Lg(a)}return Wg(n,[{key:"isDrop",value:function(){return this.start.isAbsent()}},{key:"isCut",value:function(){return this.keep.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}},{key:"equals",value:function(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}],[{key:"fromDrop",value:function(e){return new n(fB.empty(),e,fB.empty())}},{key:"fromMovement",value:function(e,t){return new n(fB.of(e),t,fB.empty())}},{key:"fromCut",value:function(e,t,r){return new n(fB.of(e),t,fB.of(r))}}]),n}(ute);bhe.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encodeMove",value:function(e){return{start:e.start.isPresent()?Zee.encoder.encode(e.start.get()):null,landing:Zee.encoder.encode(e.landing),keep:e.keep.isPresent()?Zee.encoder.encode(e.keep.get()):null}}},{key:"decodeMove",value:function(e){var t=e;if("object"!=typeof e)throw new Error("Invalid encodedMove of type "+typeof e+"!");var n=Zee.encoder.decode(t.landing);if(null==t.start)return bhe.fromDrop(n);var r=Zee.encoder.decode(t.start);if(null==t.keep)return bhe.fromMovement(r,n);var i=Zee.encoder.decode(t.keep);return bhe.fromCut(r,n,i)}}]),n}(O7));var Phe=function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,n)}},{key:"isLegal",value:function(e,t){sB(this.VERBOSE,{called:"SixRules.isLegal",move:e,state:t});var r=t.isIllegalLandingZone(e.landing,e.start);return r.isFailure()?r.toFailedFallible():t.turn<40?this.isLegalDrop(e,t):n.isLegalPhaseTwoMove(e,t)}},{key:"isLegalDrop",value:function(e,t){return!1===e.isDrop()?hB.failure(_he.NO_MOVEMENT_BEFORE_TURN_40()):hB.success(t.pieces.getKeySet())}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getCurrentOpponent(),r=[];if(e.move.isPresent()&&(r=this.getShapeVictory(e.move.get(),t)),6===r.length)return gte.getVictory(n);if(t.turn>39){var i=t.countPieces(),a=i[0],o=i[1];return a<6&&o<6?a<o?gte.ONE_WON:o<a?gte.ZERO_WON:gte.DRAW:a<6?gte.getDefeat(R7.ZERO):o<6?gte.getDefeat(R7.ONE):gte.ONGOING}return gte.ONGOING}},{key:"startSearchingVictorySources",value:function(){sB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"getShapeVictory",value:function(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();var n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(sB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){sB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(Yee.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return[];var o=(e+i.length)%6;i.push(a),a=a.getNext(Yee.factory.all[o],1)}return i}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=Yee.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return[];s=!0,i=i.getOpposite(),a=a.getNext(i,o.length)}a=a.getNext(i,1)}return o}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){sB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=Yee.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.length%2==0&&(i=Yee.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return a}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){sB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=Yee.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.push(o),a.length%2==0&&(i=Yee.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return a}}],[{key:"getLegalLandings",value:function(e){var t,n=new One,r=Hg(e.pieces.listKeys());try{for(r.s();!(t=r.n()).done;){var i,a=t.value,o=Hg(Yee.factory.all);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=a.getNext(s,1);e.getPieceAt(u)===A7.NONE&&n.add(u)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){r.e(c)}finally{r.f()}return n.toList()}},{key:"isLegalPhaseTwoMove",value:function(e,t){if(e.isDrop())return hB.failure(_he.CAN_NO_LONGER_DROP());switch(t.getPieceAt(e.start.get())){case A7.NONE:return hB.failure(ete.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());case t.getCurrentOpponent():return hB.failure(ete.CANNOT_CHOOSE_OPPONENT_PIECE())}var r=Ehe.deplacePiece(t,e),i=Ehe.getGroups(r,e.start.get());if(n.isSplit(i)){var a=this.getBiggerGroups(i);return 1===a.size()?e.keep.isPresent()?hB.failure(_he.CANNOT_CHOOSE_TO_KEEP()):hB.success(a.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,a,r)}return hB.success(new One)}},{key:"isSplit",value:function(e){return e.size()>1}},{key:"getBiggerGroups",value:function(e){var t,n=0,r=new ite,i=Hg(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=a.size();o>n?(n=o,r=new ite([a])):o===n&&r.add(a)}}catch(s){i.e(s)}finally{i.f()}return r}},{key:"moveKeepBiggerGroup",value:function(e,t,n){if(e.isAbsent())return hB.failure(_he.MUST_CUT());if(n.get(e.get()).isAbsent())return hB.failure(_he.CANNOT_KEEP_EMPTY_COORD());var r,i=e.get(),a=Hg(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.contains(i))return hB.success(o)}}catch(s){a.e(s)}finally{a.f()}return hB.failure(_he.MUST_CAPTURE_BIGGEST_GROUPS())}}]),n}(yte),She=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"calculateBoardValue",value:function(e,t){this.startSearchingVictorySources();for(var n={status:fte.DEFAULT,victory:fB.empty(),preVictory:fB.empty(),sum:0};this.hasNextVictorySource();){var r,i=this.getNextVictorySource();if((r=n.status===fte.PRE_VICTORY?this.searchVictoryOnly(i,e,t):this.getBoardInfo(i,e,t,n)).status===fte.VICTORY)return r;n={status:r.status,victory:fB.empty(),preVictory:r.preVictory,sum:n.sum+r.sum}}return n}}]),n}(tte),Ohe=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e)).value=e,i.preVictory=r,i}return Wg(n)}(nte),The=function(e){xg(n,e);var t=Dg(n);function n(){var e;return Zg(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return Wg(n,[{key:"getListMoves",value:function(e){var t=n.get(),r=e.getOwnValue(t);if(r.preVictory.isPresent())return e.gameState.turn<40?this.createForcedDrop(r):this.createForcedDeplacement(e,r);var i=Phe.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrop(i):this.getListDeplacement(e.gameState,i)}},{key:"createForcedDrop",value:function(e){sB(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:e});var t=[],n=bhe.fromDrop(e.preVictory.get());return t.push(n),t}},{key:"createForcedDeplacement",value:function(e,t){sB(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:e});var n=this.getSafelyMovablePieceOrFirstOne(e),r=[t.preVictory.get()];return this.getDeplacementFrom(e.gameState,n,r)}},{key:"getDeplacementFrom",value:function(e,t,n){var r,i=[],a=Hg(t);try{for(a.s();!(r=a.n()).done;){var o,s=r.value,u=Hg(n);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=bhe.fromMovement(s,c);if(e.isCoordConnected(c,fB.of(s))){var f=Ehe.deplacePiece(e,l),h=Ehe.getGroups(f,l.start.get());if(Phe.isSplit(h)){var d,v=Hg(h);try{for(v.s();!(d=v.n()).done;){var p=d.value.getAnyElement().get(),g=bhe.fromCut(s,c,p);i.push(g)}}catch(y){v.e(y)}finally{v.f()}}else i.push(l)}}}catch(y){u.e(y)}finally{u.f()}}}catch(y){a.e(y)}finally{a.f()}return i}},{key:"getSafelyMovablePieceOrFirstOne",value:function(e){var t,n=e.gameState,r=n.pieces.reverse(),i=n.getCurrentPlayer(),a=r.get(i).get(),o=a.getAnyElement().get(),s=[],u=Hg(a);try{for(u.s();!(t=u.n()).done;){var c=t.value;!1===this.isPieceBlockingAVictory(n,c)&&s.push(c)}}catch(l){u.e(l)}finally{u.f()}return new One(0===s.length?[o]:s)}},{key:"isPieceBlockingAVictory",value:function(e,t){var n=e.switchPiece(t),r=bhe.fromDrop(t);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,r,n).status===fte.VICTORY)return!0;return!1}},{key:"getListDrop",value:function(e){var t,n=[],r=Hg(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=bhe.fromDrop(i);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getListDeplacement",value:function(e,t){var n=e.getCurrentPlayer(),r=e.pieces.reverse().get(n).get();return this.getDeplacementFrom(e,r,t)}},{key:"getBoardValue",value:function(e){var t=e.move,n=e.gameState,r=n.getCurrentOpponent(),i=r.getVictoryValue(),a={status:fte.DEFAULT,victory:fB.empty(),preVictory:fB.empty(),sum:0};t.isPresent()&&(a=this.calculateBoardValue(t.get(),n));var o=fB.empty();if(a.status===fte.DEFAULT&&a.preVictory.isPresent()&&(o=fB.of(a.preVictory.get())),a.status===fte.VICTORY)return new Ohe(i,fB.empty());if(n.turn>39){var s=n.countPieces(),u=s[0],c=s[1];return u<6&&c<6?new Ohe(u<c?R7.ONE.getVictoryValue():c<u?R7.ZERO.getVictoryValue():0,fB.empty()):u<6?new Ohe(R7.ZERO.getDefeatValue(),fB.empty()):c<6?new Ohe(R7.ONE.getDefeatValue(),fB.empty()):new Ohe(u-c,o)}return new Ohe(a.status===fte.PRE_VICTORY?r.getPreVictory():a.sum*r.getScoreModifier(),o)}},{key:"startSearchingVictorySources",value:function(){sB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(sB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){sB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(Yee.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return{status:fte.PRE_VICTORY,victory:fB.empty(),preVictory:fB.empty(),sum:0};var o=(e+i.length)%6;i.push(a),a=a.getNext(Yee.factory.all[o],1)}return{status:fte.VICTORY,victory:fB.of(i),preVictory:fB.empty(),sum:0}}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=Yee.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return{status:fte.PRE_VICTORY,victory:fB.empty(),preVictory:fB.empty(),sum:0};s=!0,i=i.getOpposite(),a=a.getNext(i,o.length-1)}a=a.getNext(i,1)}return{status:fte.VICTORY,victory:fB.of(o),preVictory:fB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){sB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=Yee.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:fte.PRE_VICTORY,victory:fB.empty(),preVictory:fB.empty(),sum:0};a.length%2==0&&(i=Yee.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return{status:fte.VICTORY,victory:fB.of(a),preVictory:fB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){sB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=Yee.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:fte.PRE_VICTORY,victory:fB.empty(),preVictory:fB.empty(),sum:0};a.push(o),a.length%2==0&&(i=Yee.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return{status:fte.VICTORY,victory:fB.of(a),preVictory:fB.empty(),sum:0}}},{key:"getBoardInfo",value:function(e,t,n,r){sB(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:e,move:t,state:n,boardInfo:r});var i=t.landing.getNext(n.offset,1);switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,i,n,r);case"LINE":return this.getBoardInfoForLine(e.index,i,n,r);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,i,n,r);default:return this.getBoardInfoForTriangleEdge(e.index,i,n,r)}}},{key:"getBoardInfoForCircle",value:function(e,t,n,r){sB(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=[t],o=t.getNext(Yee.factory.all[e],1),s=0,u=fB.empty();a.length<6;){var c=n.getPieceAt(o);if(c===i)return r;var l=(e+a.length)%6;a.push(o);var f=Yee.factory.all[l];c===A7.NONE?(s+=.16,u=fB.of(o)):s++,o=o.getNext(f,1)}return this.getBoardInfoResult(s,u,a,r)}},{key:"getBoardInfoResult",value:function(e,t,n,r){var i=r.preVictory;if(4.16===e){if(sB(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(t))return{status:fte.PRE_VICTORY,victory:fB.empty(),preVictory:fB.empty(),sum:0};i=t}else if(5===e)return{status:fte.VICTORY,victory:fB.of(n),preVictory:fB.empty(),sum:0};return{status:r.status,victory:fB.empty(),preVictory:i,sum:r.sum+e}}},{key:"getBoardInfoForLine",value:function(e,t,n,r){sB(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=Yee.factory.all[e],a=t.getPrevious(i,5),o=[],s=[],u=fB.empty(),c=0;c<6;c++){var l=this.updateEncounterAndReturnLastEmpty(n,a,s);l.isPresent()&&(u=l),o.push(a),a=a.getNext(i,1)}for(var f=r.status,h=r.preVictory,d=0,v=0;d<6;){var p=s.reduce(function(e,t){return e+t});if(6===p)return{status:fte.VICTORY,victory:fB.of(o),preVictory:fB.empty(),sum:0};5.16===p&&f===fte.DEFAULT&&(h.isPresent()?(v7(!1===h.equals(u),"Impossible to have point aligned with differents line to a same point"),f=fte.PRE_VICTORY):h=u),v=Math.max(v,p),(o=o.slice(1,6)).push(a),s=s.slice(1,6);var g=this.updateEncounterAndReturnLastEmpty(n,a,s);g.isPresent()&&(u=g),d++,a=a.getNext(i,1)}var y={status:f,victory:fB.of(o),preVictory:h,sum:v};return this.getBoardInfoResult(v,u,o,y)}},{key:"updateEncounterAndReturnLastEmpty",value:function(e,t,n){var r=e.getCurrentPlayer();switch(e.getPieceAt(t)){case r:return n.push(-7),fB.empty();case A7.NONE:return n.push(.16),fB.of(t);default:return n.push(1),fB.empty()}}},{key:"getBoardInfoForTriangleCorner",value:function(e,t,n,r){sB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=Yee.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=fB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===A7.NONE?(u+=.16,c=fB.of(s)):u++,o.length%2==0&&(a=Yee.factory.all[(e+o.length)%6]),o.push(s),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}},{key:"getBoardInfoForTriangleEdge",value:function(e,t,n,r){sB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=Yee.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=fB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===A7.NONE?(u+=.16,c=fB.of(s)):u++,o.push(s),o.length%2==0&&(a=Yee.factory.all[(e+o.length)%6]),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}}],[{key:"get",value:function(){if(n.singleton.isAbsent()){var e=new Phe(Ehe);n.singleton=fB.of(new n(e,"SixMinimax"))}return n.singleton.get()}}]),n}(She);The.singleton=fB.empty();var Ihe=A7.NONE.value,Ahe=R7.ZERO.value,Rhe=R7.ONE.value,Mhe=function(){var e=Wg(function e(){Zg(this,e)});return e.MOVEMENT_NOT_DISCONNECTING=function(){return $localize(vl||(vl=_g(["This move does not disconnect your opponent's pieces. Try again with another piece."])))},e.MOVEMENT_SELF_DISCONNECTING=function(){return $localize(pl||(pl=_g(["You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!"])))},e}(),xhe=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(gl||(gl=_g(["Six"]))),$localize(yl||(yl=_g(["Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.\n        Each player has 21 pieces, with one for each player already on the board.\n        The goal of the game is to form one of the three winning shapes with your pieces."]))),Ehe.getInitialState()),wte.fromMove($localize(ml||(ml=_g(["Victory (line)"]))),$localize(kl||(kl=_g(["On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>\n        Find the victory. You're playing Dark."]))),Ehe.fromRepresentation([[Ahe,Rhe,Rhe,Rhe,Rhe,Ahe],[Ihe,Ahe,Rhe,Ihe,Ahe,Ihe],[Rhe,Rhe,Ahe,Ihe,Ihe,Ihe],[Ihe,Ihe,Ahe,Ihe,Ihe,Ihe],[Ihe,Ahe,Ihe,Ihe,Ihe,Ihe],[Ahe,Ihe,Ihe,Ihe,Ihe,Ihe]],0),[bhe.fromDrop(new Zee(3,2))],$localize(Cl||(Cl=_g(["Congratulations!"]))),$localize(wl||(wl=_g(["Failed!"])))),wte.fromMove($localize(_l||(_l=_g(["Victory (circle)"]))),$localize(El||(El=_g(["On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),Ehe.fromRepresentation([[Ihe,Ihe,Ihe,Rhe,Ihe,Ihe],[Ihe,Ihe,Rhe,Rhe,Ahe,Ahe],[Ihe,Rhe,Ihe,Ahe,Rhe,Ihe],[Rhe,Ahe,Ahe,Ahe,Ahe,Rhe]],0),[bhe.fromDrop(new Zee(5,2))],$localize(bl||(bl=_g(["Congratulations! Note that if a piece is inside the circle, it does not change anything."]))),$localize(Pl||(Pl=_g(["Failed!"])))),wte.fromMove($localize(Sl||(Sl=_g(["Victory (triangle)"]))),$localize(Ol||(Ol=_g(["On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),Ehe.fromRepresentation([[Ihe,Ihe,Ihe,Rhe,Ihe,Ihe],[Ihe,Ahe,Rhe,Ahe,Ahe,Ahe],[Ihe,Ahe,Ihe,Ahe,Ahe,Ihe],[Rhe,Rhe,Rhe,Ihe,Rhe,Ihe]],0),[bhe.fromDrop(new Zee(3,3))],$localize(Tl||(Tl=_g(["Congratulations!"]))),$localize(Il||(Il=_g(["Failed!"])))),wte.fromPredicate($localize(Al||(Al=_g(["Second phase"]))),$localize(Rl||(Rl=_g(["After 40 turns, your pieces have all been placed and we move on to the second phase of the game.\n        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.\n        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>\n        You're playing Dark. Make a move that disconnects one of your opponent's pieces."]))),Ehe.fromRepresentation([[Ihe,Ihe,Ihe,Ihe,Ihe,Ihe,Ihe,Rhe,Ihe],[Ihe,Ihe,Ihe,Ihe,Ihe,Ihe,Ahe,Ihe,Ihe],[Ihe,Ihe,Ihe,Ihe,Ahe,Ahe,Ahe,Ihe,Ihe],[Ihe,Ihe,Ihe,Ihe,Rhe,Rhe,Ihe,Rhe,Ahe],[Ihe,Ahe,Rhe,Rhe,Ahe,Ahe,Rhe,Ihe,Ihe],[Ahe,Ahe,Ahe,Ahe,Rhe,Rhe,Rhe,Ahe,Ihe],[Rhe,Rhe,Ahe,Ihe,Rhe,Rhe,Ahe,Ihe,Ihe],[Ihe,Ahe,Ihe,Ahe,Ahe,Ihe,Ihe,Ihe,Ihe],[Rhe,Rhe,Rhe,Rhe,Ihe,Ihe,Ihe,Ihe,Ihe],[Ihe,Ahe,Ihe,Rhe,Ihe,Ihe,Ihe,Ihe,Ihe]],40),bhe.fromMovement(new Zee(6,1),new Zee(5,1)),function(e,t,n){var r=n.countPieces();return 19===r[0]?18===r[1]?pB.SUCCESS:pB.failure(Mhe.MOVEMENT_NOT_DISCONNECTING()):pB.failure(Mhe.MOVEMENT_SELF_DISCONNECTING())},$localize(Ml||(Ml=_g(["Congratulations, your opponent now has one piece less and you're closer to victory!"])))),wte.fromPredicate($localize(xl||(xl=_g(["Victory by disconnection"]))),$localize(Nl||(Nl=_g(["During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.\n        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.\n        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>\n        Here, you're playing Dark and you can win. Do it!"]))),Ehe.fromRepresentation([[Ihe,Ihe,Ihe,Ihe,Ihe,Rhe],[Ihe,Ihe,Ihe,Ihe,Ahe,Rhe],[Ihe,Ihe,Ihe,Rhe,Ahe,Ahe],[Ihe,Ihe,Ahe,Ihe,Rhe,Ahe],[Rhe,Rhe,Ihe,Ihe,Ihe,Ahe],[Ahe,Rhe,Ihe,Ihe,Ihe,Ihe],[Ahe,Ihe,Ihe,Ihe,Ihe,Ihe]],40),bhe.fromMovement(new Zee(2,3),new Zee(3,3)),function(e,t,n){return e.start.equalsValue(new Zee(2,3))?pB.SUCCESS:pB.failure(Mhe.MOVEMENT_NOT_DISCONNECTING())},$localize(Dl||(Dl=_g(["Congratulations, you won!"])))),wte.fromPredicate($localize(Ll||(Ll=_g(["Special disconnection"]))),$localize(Fl||(Fl=_g(["During a disconnection, two or more groups could have the same size,\n        in which case you will have to click on the group you wish to keep.<br/><br/>\n        You're playing Dark, play such a move!"]))),Ehe.fromRepresentation([[Ihe,Ihe,Ihe,Ihe,Ihe,Rhe],[Ihe,Ihe,Ihe,Ihe,Ahe,Rhe],[Ihe,Ihe,Ihe,Rhe,Ahe,Ahe],[Ahe,Ihe,Ahe,Ihe,Ihe,Rhe],[Rhe,Rhe,Ihe,Ihe,Ihe,Ihe],[Ahe,Ahe,Ihe,Ihe,Ihe,Ihe],[Ahe,Ihe,Ihe,Ihe,Ihe,Ihe]],40),bhe.fromCut(new Zee(2,3),new Zee(2,5),new Zee(2,5)),function(e,t,n){return e.keep.isAbsent()?pB.failure($localize(Ul||(Ul=_g(["This move has not cut the board in two equal halves."])))):n.getPieceAt(e.landing.getNext(n.offset))===A7.NONE?pB.failure($localize(Vl||(Vl=_g(["Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again."])))):pB.SUCCESS},$localize(Bl||(Bl=_g(["Congratulations, you won!"]))))]});function Nhe(e,t){if(1&e){var n=aP();cC(),eP(0,"polyline",10),uP("click",function(){var e=Nk(n).$implicit;return fP().onPieceClick(e)}),tP()}if(2&e){var r=t.$implicit,i=fP();vP("id","piece_",r.x,"_",r.y,""),Xb("ngClass",i.getPieceClass(r)),$b("points",i.getHexaCoordsAt(r))}}function Dhe(e,t){if(1&e){var n=aP();cC(),eP(0,"polyline",11),uP("click",function(){var e=Nk(n).$implicit;return fP().onNeighborClick(e)}),tP()}if(2&e){var r=t.$implicit,i=fP();vP("id","neighbor_",r.x,"_",r.y,""),$b("points",i.getHexaCoordsAt(r))}}function Lhe(e,t){if(1&e){var n=aP();cC(),eP(0,"polyline",10),uP("click",function(){Nk(n);var e=fP();return e.onPieceClick(e.chosenLanding.get())}),tP()}if(2&e){var r=fP();vP("id","chosenLanding_",r.chosenLanding.get().x,"_",r.chosenLanding.get().y,""),Xb("ngClass",r.getPlayerClass(r.state.getCurrentPlayer())),$b("points",r.getHexaCoordsAt(r.chosenLanding.get()))}}function Fhe(e,t){if(1&e&&(cC(),nP(0,"polyline",12)),2&e){var n=t.$implicit,r=fP();vP("id","disconnected_",n.x,"_",n.y,""),$b("points",r.getHexaCoordsAt(n))}}function Uhe(e,t){if(1&e){var n=aP();cC(),eP(0,"polyline",13),uP("click",function(){Nk(n);var e=fP();return e.onNeighborClick(e.leftCoord.get())}),tP()}if(2&e){var r=fP();vP("id","leftCoord_",r.leftCoord.get().x,"_",r.leftCoord.get().y,""),$b("points",r.getHexaCoordsAt(r.leftCoord.get()))}}function Vhe(e,t){if(1&e){var n=aP();cC(),eP(0,"polyline",14),uP("click",function(){Nk(n);var e=fP();return e.onPieceClick(e.lastDrop.get())}),tP()}if(2&e){var r=fP();vP("id","lastDrop_",r.lastDrop.get().x,"_",r.lastDrop.get().y,""),$b("points",r.getHexaCoordsAt(r.lastDrop.get()))}}function Bhe(e,t){if(1&e){var n=aP();cC(),eP(0,"polyline",15),uP("click",function(){Nk(n);var e=fP();return e.onPieceClick(e.selectedPiece.get())}),tP()}if(2&e){var r=fP();vP("id","selectedPiece_",r.selectedPiece.get().x,"_",r.selectedPiece.get().y,""),Xb("ngClass",r.getSelectedPieceClass()),$b("points",r.getHexaCoordsAt(r.selectedPiece.get()))}}function zhe(e,t){if(1&e&&(cC(),nP(0,"polyline",16)),2&e){var n=t.$implicit,r=fP();vP("id","victoryCoord_",n.x,"_",n.y,""),$b("points",r.getHexaCoordsAt(n))}}function Hhe(e,t){if(1&e){var n=aP();cC(),eP(0,"g",19),uP("click",function(){var e=Nk(n).$implicit;return fP(2).onPieceClick(e)}),nP(1,"polyline",20),tP()}if(2&e){var r=t.$implicit,i=fP(2);pE(1),vP("id","cuttable_",r.x,"_",r.y,""),$b("points",i.getHexaCoordsAt(r))}}function Ghe(e,t){if(1&e&&(cC(),eP(0,"g",17),Yb(1,Hhe,2,3,"g",18),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}var $he=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).disconnecteds=[],r.cuttableGroups=[],r.leftCoord=fB.empty(),r.lastDrop=fB.empty(),r.selectedPiece=fB.empty(),r.chosenLanding=fB.empty(),r.nextClickShouldSelectGroup=!1,r.rules=new Phe(Ehe),r.availableMinimaxes=[new The(r.rules,"SixMinimax")],r.encoder=bhe.encoder,r.tutorial=(new xhe).tutorial,r.SPACE_SIZE=30,r.hexaLayout=new Kee(1.5*r.SPACE_SIZE,new Zee(2*r.SPACE_SIZE,0),Jee.INSTANCE),r.updateBoard(),r}return Wg(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=fB.empty(),this.chosenLanding=fB.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.rules.node.move.isPresent()?this.showLastMove():(this.leftCoord=fB.empty(),this.lastDrop=fB.empty(),this.victoryCoords=[],this.disconnecteds=[]),this.pieces=this.state.pieces.listKeys(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}},{key:"getViewBox",value:function(){var e=this.mapAbstractCoordToCornerCoords(),t=this.getLimits(e);return t.minX-this.STROKE_WIDTH/2+" "+(t.minY-this.STROKE_WIDTH/2)+" "+(this.STROKE_WIDTH+t.maxX-t.minX)+" "+(this.STROKE_WIDTH+t.maxY-t.minY)}},{key:"mapAbstractCoordToCornerCoords",value:function(){var e,t=this,n=[],r=Hg(this.pieces.concat(this.disconnecteds).concat(this.neighbors).map(function(e){return t.hexaLayout.getHexaCoordsAt(e)}));try{for(r.s();!(e=r.n()).done;){var i=e.value;n=n.concat(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getLimits",value:function(e){var t,n=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,o=Hg(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;s.x<i&&(i=s.x),s.y<a&&(a=s.y),n=Math.max(n,s.x),r=Math.max(r,s.y)}}catch(u){o.e(u)}finally{o.f()}return{minX:i,minY:a,maxX:n,maxY:r}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();this.lastDrop=fB.of(e.landing.getNext(this.state.offset,1)),this.leftCoord=!1===e.isDrop()?fB.of(e.start.get().getNext(this.state.offset,1)):fB.empty();var t=this.rules.node.gameState;this.rules.getGameStatus(this.rules.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,t)),this.disconnecteds=this.getDisconnected()}},{key:"getDisconnected",value:function(){var e,t=this,n=this.rules.node.mother.get().gameState.pieces.listKeys(),r=this.rules.node.gameState.pieces.listKeys(),i=[],a=Hg(n);try{var o=function(){var n=e.value;!1===t.rules.node.move.get().start.equalsValue(n)&&!1===r.some(function(e){return e.equals(n.getNext(t.state.offset,1))})&&i.push(n.getNext(t.state.offset,1))};for(a.s();!(e=a.n()).done;)o()}catch(u){a.e(u)}finally{a.f()}var s=this.lastDrop.get();return!1===this.pieces.some(function(e){return e.equals(s)})&&!1===r.some(function(e){return e.equals(s)})&&i.push(s),i}},{key:"getEmptyNeighbors",value:function(){var e=Phe.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){var t=this.chosenLanding.get();e=e.filter(function(e){return!1===e.equals(t)})}return e}},{key:"getPieceClass",value:function(e){var t=this.rules.node.gameState.getPieceAt(e);return this.getPlayerClass(t)}},{key:"onPieceClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#piece_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!(t.state.turn<40)){n.next=5;break}return n.abrupt("return",t.cancelMove(_he.NO_MOVEMENT_BEFORE_TURN_40()));case 5:if(!t.chosenLanding.isAbsent()){n.next=7;break}return n.abrupt("return",t.state.getPieceAt(e)===t.state.getCurrentOpponent()?t.cancelMove(ete.CANNOT_CHOOSE_OPPONENT_PIECE()):(t.selectedPiece=fB.of(e),pB.SUCCESS));case 7:return i=bhe.fromCut(t.selectedPiece.get(),t.chosenLanding.get(),e),n.abrupt("return",t.chooseMove(i,t.state));case 9:case"end":return n.stop()}},n)}))()}},{key:"onNeighborClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#neighbor_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.nextClickShouldSelectGroup){n.next=5;break}return n.abrupt("return",t.cancelMove(_he.MUST_CUT()));case 5:if(!(t.state.turn<40)){n.next=7;break}return n.abrupt("return",t.chooseMove(bhe.fromDrop(e),t.state));case 7:if(!t.selectedPiece.isAbsent()){n.next=9;break}return n.abrupt("return",t.cancelMove(_he.CAN_NO_LONGER_DROP()));case 9:return i=bhe.fromMovement(t.selectedPiece.get(),e),a=Phe.isLegalPhaseTwoMove(i,t.state),n.abrupt("return",t.neededCutting(a)?(t.chosenLanding=fB.of(e),t.moveVirtuallyPiece(),t.showCuttable(),t.nextClickShouldSelectGroup=!0,pB.SUCCESS):t.chooseMove(i,t.state));case 11:case"end":return n.stop()}},n)}))()}},{key:"neededCutting",value:function(e){return e.isFailure()&&e.getReason()===_he.MUST_CUT()}},{key:"moveVirtuallyPiece",value:function(){var e=this.selectedPiece.get();this.pieces=this.pieces.filter(function(t){return!1===t.equals(e)}),this.neighbors=this.getEmptyNeighbors()}},{key:"showCuttable",value:function(){var e=bhe.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),t=Ehe.deplacePiece(this.state,e),n=Ehe.getGroups(t,e.start.get()),r=Phe.getBiggerGroups(n);this.cuttableGroups=[];var i,a=Hg(r);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.cuttableGroups.push(o.toList())}}catch(s){a.e(s)}finally{a.f()}}},{key:"getSelectedPieceClass",value:function(){return this.chosenLanding.isPresent()?"moved":"selected"}}]),n}(Wee);return e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-six"]],features:[Rb],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured",3,"id",4,"ngFor","ngForOf"],["class","base round moved mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round highlighted mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured",3,"id"],[1,"base","round","moved","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","highlighted","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["stroke-linecap","round",1,"no-fill",3,"id"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),Yb(1,Nhe,1,4,"polyline",1),Yb(2,Dhe,1,3,"polyline",2),Yb(3,Lhe,1,4,"polyline",3),Yb(4,Fhe,1,3,"polyline",4),Yb(5,Uhe,1,3,"polyline",5),Yb(6,Vhe,1,3,"polyline",6),Yb(7,Bhe,1,4,"polyline",7),Yb(8,zhe,1,3,"polyline",8),Yb(9,Ghe,2,1,"g",9),tP()),2&e&&($b("viewBox",t.viewBox),pE(1),Xb("ngForOf",t.pieces),pE(1),Xb("ngForOf",t.neighbors),pE(1),Xb("ngIf",t.chosenLanding.isPresent()),pE(1),Xb("ngForOf",t.disconnecteds),pE(1),Xb("ngIf",t.leftCoord.isPresent()),pE(1),Xb("ngIf",t.lastDrop.isPresent()),pE(1),Xb("ngIf",t.selectedPiece.isPresent()),pE(1),Xb("ngForOf",t.victoryCoords),pE(1),Xb("ngForOf",t.cuttableGroups))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Zhe=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getMaximalDistance",value:function(){return 9}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return hB.success(r)}catch(r){return hB.failure(r.message)}}}]),n}(vne);Zhe.encoder=hne.getEncoder(9,9,Zhe.of);var qhe={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:R7.ZERO},Whe=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=yne.UNOCCUPIED,t=yne.INVADERS,r=yne.DEFENDERS;return new n([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,r,e,e,e,e],[t,e,e,e,r,e,e,e,t],[t,t,r,r,yne.PLAYER_ONE_KING,r,r,t,t],[t,e,e,e,r,e,e,e,t],[e,e,e,e,r,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}}]),n}(kne),jhe=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.call(this,Whe,qhe,Zhe.of)}return Wg(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),pte.ruler=this.singleton,n.singleton}}]),n}(wne),Yhe=yne.UNOCCUPIED,Khe=yne.INVADERS,Qhe=yne.DEFENDERS,Xhe=yne.PLAYER_ONE_KING,Jhe=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(zl||(zl=_g(["Goal of the game"]))),$localize(Hl||(Hl=_g(["Tablut is a strategy game that was played by the Vikings.\n        The goal of the game is different for each player.\n        The attacker plays first. Its pieces (dark) are close to the edges.\n        Its goal is to capture the king, which is in the center of the board.\n        The defender plays second. Its pieces (light) are in the middle.\n        Its goal is to move the king on one of the 4 thrones in the corners.\n        Note that the square in which the king starts, in the center of the board, is also a throne."]))),Whe.getInitialState()),wte.anyMove($localize(Gl||(Gl=_g(["Moving"]))),$localize($l||($l=_g(["All pieces move the same way.\n        Similarly to a rook in chess, a piece can move:\n        <ol>\n            <li>By as many squares as you want.</li>\n            <li>Without going over another piece or stopping on another piece.</li>\n            <li>Horizontally or vertically.</li>\n            <li>Only the king can land on a throne.</li>\n        </ol>\n        To move a piece, click on it and then on its landing square.<br/><br/>\n        You're playing Dark, do the first move."]))),Whe.getInitialState(),Zhe.of(new Zee(4,1),new Zee(1,1)),$localize(Zl||(Zl=_g(["Congratulations!"])))),wte.fromMove($localize(ql||(ql=_g(["Capturing a soldier (1/2)"]))),$localize(Wl||(Wl=_g(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new Whe([[Yhe,Yhe,Yhe,Khe,Khe,Khe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Khe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Qhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Khe,Qhe,Yhe,Yhe,Yhe,Khe],[Khe,Khe,Qhe,Qhe,Xhe,Qhe,Qhe,Khe,Khe],[Yhe,Yhe,Yhe,Yhe,Qhe,Yhe,Yhe,Yhe,Khe],[Yhe,Yhe,Yhe,Yhe,Qhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Khe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Khe,Khe,Khe,Yhe,Yhe,Yhe]],1),[Zhe.of(new Zee(2,4),new Zee(2,3)),Zhe.of(new Zee(4,2),new Zee(3,2))],$localize(jl||(jl=_g(["Congratulations, that will teach him a lesson!"]))),$localize(Yl||(Yl=_g(["Failed, you missed an opportunity to capture a piece of the opponent."])))),wte.fromMove($localize(Kl||(Kl=_g(["Capturing a soldier (2/2)"]))),$localize(Ql||(Ql=_g(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new Whe([[Yhe,Yhe,Yhe,Khe,Khe,Khe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Khe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Qhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Qhe,Yhe,Xhe,Yhe,Qhe,Yhe,Khe],[Khe,Khe,Yhe,Qhe,Yhe,Qhe,Qhe,Khe,Khe],[Yhe,Yhe,Yhe,Yhe,Qhe,Yhe,Yhe,Yhe,Khe],[Yhe,Yhe,Yhe,Yhe,Qhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Khe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Khe,Khe,Khe,Yhe,Yhe,Yhe]],12),[Zhe.of(new Zee(1,4),new Zee(2,4))],$localize(Xl||(Xl=_g(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(Jl||(Jl=_g(["Failed, you did not do the expected move."])))),wte.fromMove($localize(ef||(ef=_g(["Capturing the king (1/2)"]))),$localize(tf||(tf=_g(["To capture the king, two soldiers are not enough.\n        For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.\n        This also works if the king is on the throne.<br/><br/>\n        Capture the king."]))),new Whe([[Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Khe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe],[Khe,Xhe,Yhe,Khe,Yhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Khe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe]],72),[Zhe.of(new Zee(3,4),new Zee(2,4))],$localize(nf||(nf=_g(["Congratulations, you won!"]))),$localize(rf||(rf=_g(["Failed, you let the king run away."])))),wte.fromMove($localize(af||(af=_g(["Capturing the king (2/2)"]))),$localize(of||(of=_g(["Another way to capture the king is to immobilize it against an edge of the board.\n        Note that the king cannot be captured next to a throne.<br/><br/>\n        Capture the king."]))),new Whe([[Yhe,Yhe,Khe,Xhe,Khe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Khe,Yhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe,Yhe]],72),[Zhe.of(new Zee(3,3),new Zee(3,1))],$localize(sf||(sf=_g(["The king is dead, long live the king. Congratulations, you won."]))),$localize(uf||(uf=_g(["Failed!"]))))]});function ede(e,t){1&e&&(cC(),nP(0,"polyline",8))}function tde(e,t){1&e&&(cC(),nP(0,"polyline",9))}function nde(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,ede,1,0,"polyline",6),Yb(2,tde,1,0,"ng-template",null,7,MT),tP()),2&e){var n=Kb(3),r=fP().index,i=fP().index,a=fP();pE(1),Xb("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function rde(e,t){if(1&e&&(cC(),eP(0,"g"),nP(1,"line",10),nP(2,"line",10),nP(3,"line",10),nP(4,"line",10),nP(5,"line",10),tP()),2&e){var n=fP(2).index,r=fP().index,i=fP();pE(1),Xb("ngClass",i.viewInfo.pieceClasses[r][n]),$b("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),pE(1),Xb("ngClass",i.viewInfo.pieceClasses[r][n]),$b("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),pE(1),Xb("ngClass",i.viewInfo.pieceClasses[r][n]),$b("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),pE(1),Xb("ngClass",i.viewInfo.pieceClasses[r][n]),$b("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),pE(1),Xb("ngClass",i.viewInfo.pieceClasses[r][n]),$b("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function ide(e,t){if(1&e&&(cC(),nP(0,"polyline",15)),2&e){var n=fP(3).index,r=fP().index;Xb("ngClass",fP().viewInfo.pieceClasses[r][n])}}function ade(e,t){if(1&e&&(cC(),nP(0,"line",10),nP(1,"line",10),nP(2,"line",10),nP(3,"line",10)),2&e){var n=fP(3).index,r=fP().index,i=fP();Xb("ngClass",i.viewInfo.pieceClasses[r][n]),$b("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),pE(1),Xb("ngClass",i.viewInfo.pieceClasses[r][n]),$b("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),pE(1),Xb("ngClass",i.viewInfo.pieceClasses[r][n]),$b("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),pE(1),Xb("ngClass",i.viewInfo.pieceClasses[r][n]),$b("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function ode(e,t){if(1&e&&(cC(),Yb(0,ide,1,1,"polyline",13),Yb(1,ade,4,20,"ng-template",null,14,MT)),2&e){var n=Kb(2),r=fP(2).index,i=fP().index;Xb("ngIf",fP().isKing(r,i))("ngIfElse",n)}}function sde(e,t){if(1&e&&(cC(),eP(0,"g"),nP(1,"circle",10),Yb(2,rde,6,25,"g",11),Yb(3,ode,3,2,"ng-template",null,12,MT),tP()),2&e){var n=Kb(4),r=fP().index,i=fP().index,a=fP();pE(1),Xb("ngClass",a.viewInfo.pieceClasses[i][r]),$b("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)("cx",.5*a.SPACE_SIZE)("cy",.5*a.SPACE_SIZE),pE(1),Xb("ngIf",a.isInvader(r,i))("ngIfElse",n)}}function ude(e,t){if(1&e){var n=aP();cC(),eP(0,"g",3),uP("click",function(){var e=Nk(n).index,t=fP().index;return fP().onClick(e,t)}),nP(1,"rect",4),Yb(2,nde,4,2,"g",5),Yb(3,sde,5,6,"g",5),tP()}if(2&e){var r=t.index,i=fP().index,a=fP();vP("id","click_",r,"_",i,""),$b("transform","translate("+a.SPACE_SIZE*r+", "+a.SPACE_SIZE*i+")"),pE(1),Xb("ngClass",a.getRectClasses(r,i)),$b("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),pE(1),Xb("ngIf",a.board[i][r]===a.EMPTY&&a.isThrone(r,i)),pE(1),Xb("ngIf",a.board[i][r]!==a.EMPTY)}}function cde(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,ude,4,8,"g",2),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}function lde(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"rect",16),uP("click",function(){var e=Nk(n).$implicit;return fP().onClick(e.x,e.y)}),tP(),tP()}if(2&e){var r=t.$implicit,i=fP();pE(1),vP("id","click_",r.x,"_",r.y,""),$b("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var fde=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e,!1,Zhe.from)).rules=jhe.get(),r.availableMinimaxes=[new bne(r.rules,"DummyBot"),new Tne(r.rules,"Piece > Influence"),new Ine(r.rules,"Piece > Control"),new Ane(r.rules,"Escape > Piece > Control")],r.encoder=Zhe.encoder,r.tutorial=(new Jhe).tutorial,r.updateBoard(),r}return Wg(n)}(Ene);return e.\u0275fac=function(t){return new(t||e)(Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["app-tablut"]],features:[Rb],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15",1,"base"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60, 10 20",1,"base"],[1,"base",3,"ngClass"],[4,"ngIf","ngIfElse"],["defender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),Yb(1,cde,2,1,"g",1),Yb(2,lde,2,6,"g",1),tP()),2&e&&($b("viewBox",t.getViewBox()),pE(1),Xb("ngForOf",t.board),pE(1),Xb("ngForOf",t.getClickables()))},directives:[LA,NA,UA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),hde=Wg(function e(){Zg(this,e)});hde.PLACEMENT_AFTER_INITIAL_PHASE=function(){return $localize(cf||(cf=_g(["You cannot put a new ring after the tenth turn."])))},hde.NO_MARKERS_IN_INITIAL_PHASE=function(){return $localize(lf||(lf=_g(["You cannot put a marker in a ring before placing all of your rings."])))},hde.MISSING_CAPTURES=Mae.MISSING_CAPTURES,hde.MOVE_DIRECTION_INVALID=function(){return $localize(ff||(ff=_g(["The direction of your move is invalid: a move is made along a straight line."])))},hde.CAN_ONLY_CAPTURE_YOUR_MARKERS=function(){return $localize(hf||(hf=_g(["You can only capture your own markers."])))},hde.SHOULD_SELECT_PLAYER_RING=function(){return $localize(df||(df=_g(["You must pick one of your own rings to move."])))},hde.SHOULD_END_MOVE_ON_EMPTY_SPACE=function(){return $localize(vf||(vf=_g(["Your ring must land on an empty space."])))},hde.MOVE_SHOULD_NOT_PASS_ABOVE_RING=function(){return $localize(pf||(pf=_g(["A ring can only jump over markers or empty spaces, not over another ring."])))},hde.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=function(){return $localize(gf||(gf=_g(["Your ring must land on the first empty space after a group of markers."])))},hde.AMBIGUOUS_CAPTURE_COORD=Mae.AMBIGUOUS_CAPTURE_COORD,hde.CAPTURE_SHOULD_TAKE_RING=function(){return $localize(yf||(yf=_g(["When you capture markers, you must take one of your ring as well by clicking on it."])))};var dde=function(){function e(t,n){Zg(this,e),this.player=t,this.isRing=n}return Wg(e,[{key:"equals",value:function(e){return this===e}},{key:"flip",value:function(){return v7(!1===this.isRing,"cannot flip a ring (it should never happen)"),v7(this.player.isPlayer(),"cannot flip a non-player piece"),e.of(this.player.getOpponent(),this.isRing)}},{key:"toString",value:function(){switch(this){case e.UNREACHABLE:return"NONE";case e.EMPTY:return"EMPTY";case e.MARKER_ZERO:return"MARKER_ZERO";case e.MARKER_ONE:return"MARKER_ONE";case e.RING_ZERO:return"RING_ZERO";default:return oB.expectToBe(this,e.RING_ONE),"RING_ONE"}}}],[{key:"of",value:function(t,n){return t===A7.NONE?e.EMPTY:n?e.RINGS[t.value]:e.MARKERS[t.value]}}]),e}();dde.encoder=T7.tuple([R7.numberEncoder,T7.booleanEncoder],function(e){return[e.player,e.isRing]},function(e){return dde.of(e[0],e[1])}),dde.UNREACHABLE=new dde(A7.NONE,!1),dde.EMPTY=new dde(A7.NONE,!1),dde.MARKER_ZERO=new dde(R7.ZERO,!1),dde.MARKER_ONE=new dde(R7.ONE,!1),dde.MARKERS=[dde.MARKER_ZERO,dde.MARKER_ONE],dde.RING_ZERO=new dde(R7.ZERO,!0),dde.RING_ONE=new dde(R7.ONE,!0),dde.RINGS=[dde.RING_ZERO,dde.RING_ONE];var vde=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r,i){var a;return Zg(this,n),(a=t.call(this,i,e,n.SIZE,n.SIZE,[6,4,3,2,1],dde.EMPTY)).sideRings=r,a}return Wg(n,[{key:"isInitialPlacementPhase",value:function(){return this.turn<10}},{key:"countScores",value:function(){return this.turn<10?[0,0]:this.sideRings}},{key:"equals",value:function(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&D7.compareTable(this.board,e.board)}},{key:"getRingCoords",value:function(e){var t=[];return this.forEachCoord(function(n,r){r.isRing&&r.player===e&&t.push(n)}),t}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==dde.UNREACHABLE}},{key:"setAtUnsafe",value:function(e,t){var r=D7.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.sideRings,this.turn)}}],[{key:"getInitialState",value:function(){var e=dde.EMPTY,t=dde.UNREACHABLE;return new n([[t,t,t,t,t,t,e,e,e,e,t],[t,t,t,t,e,e,e,e,e,e,e],[t,t,t,e,e,e,e,e,e,e,e],[t,t,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,t,t],[e,e,e,e,e,e,e,e,t,t,t],[e,e,e,e,e,e,e,t,t,t,t],[t,e,e,e,e,t,t,t,t,t,t]],[5,5],0)}}]),n}(hie);return e.SIZE=11,e}(),pde=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;if(Zg(this,n),i=t.call(this,e),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");return i.ringTaken=fB.ofNullable(r),Lg(i)}return Wg(n,[{key:"setRingTaken",value:function(e){return new n(this.capturedSpaces,e)}},{key:"equals",value:function(e){return!(!1===Rg(Vg(n.prototype),"equals",this).call(this,e)||!1===this.ringTaken.equals(e.ringTaken))}}],[{key:"of",value:function(e,t,r){for(var i=[],a=Yee.factory.fromMove(e,t).get(),o=e;!1===o.equals(t);o=o.getNext(a))i.push(o);return i.push(t),new n(i,r)}}]),n}(Tae);pde.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encode",value:function(e){return{captured:e.capturedSpaces.map(function(e){return Zee.encoder.encode(e)}),ringTaken:Zee.encoder.encode(e.ringTaken.get())}}},{key:"decode",value:function(e){var t=e;return v7(null!=t.captured&&null!=t.ringTaken,"Invalid encoded YinshCapture"),new pde(t.captured.map(function(e){return Zee.encoder.decode(e)}),Zee.encoder.decode(t.ringTaken))}}]),n}(S7));var gde=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a){var o;return Zg(this,n),(o=t.call(this)).initialCaptures=e,o.start=r,o.end=i,o.finalCaptures=a,o}return Wg(n,[{key:"isInitialPlacement",value:function(){return this.end.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===D7.compareArray(this.initialCaptures,e.initialCaptures)||!1===D7.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"toString",value:function(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=Hg(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}}]),n}(ute);gde.coordOptionalEncoder=Oae(Zee.encoder),gde.encoder=new(function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"encodeMove",value:function(e){var t={moveStart:Zee.encoder.encode(e.start),moveEnd:gde.coordOptionalEncoder.encode(e.end)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=pde.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=pde.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return v7(null!=t.moveStart,"Invalid encoded YinshMove"),new gde(this.decodeArray(t,"initialCapture",pde.encoder.decode),Zee.encoder.decode(t.moveStart),gde.coordOptionalEncoder.decode(t.moveEnd),this.decodeArray(t,"finalCapture",pde.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(O7));var yde=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return t.isEndGame?nte.fromWinner(t.winner):new nte(e.gameState.sideRings[0]*R7.ZERO.getScoreModifier()+e.gameState.sideRings[1]*R7.ONE.getScoreModifier())}},{key:"getListMoves",value:function(e){var t=this,n=[],r=e.gameState;if(r.isInitialPlacementPhase()){var i,a=Hg(r.getCoordsAndContents());try{for(a.s();!(i=a.n()).done;){var o=Sg(i.value,2),s=o[0];o[1]===dde.EMPTY&&n.push(new gde([],s,fB.empty(),[]))}}catch(c){a.e(c)}finally{a.f()}}else{var u=this.ruler;this.getPossibleCaptureCombinations(r).forEach(function(e){var i=u.applyCaptures(e,r);t.getRingMoves(i).forEach(function(r){var a=u.applyRingMoveAndFlip(r.start,r.end,i);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new gde(e,r.start,fB.of(r.end),t);n.push(i)})})})}return n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=this.ruler.getPossibleCaptures(e),n=this.getRingCoords(e);return Nae.getPossibleCaptureCombinationsFromPossibleCaptures(t).map(function(e){return function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"getCombinations",value:function(e,t){var n=this;return v7(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(function(e){return n.getPermutations(e)}).reduce(function(e,t){return e.concat(t)})}},{key:"getPermutations",value:function(e){for(var t=e.length,n=[e.slice()],r=new Array(t).fill(0),i=1;i<t;)if(r[i]<i){var a=i%2&&r[i],o=e[i];e[i]=e[a],e[a]=o,++r[i],i=1,n.push(e.slice())}else r[i]=0,++i;return n}},{key:"getSubsetsOfSize",value:function(e,t){return function t(n,r){if(r>=e.length||n<1)return[[]];for(var i=[];r<=e.length-n;){var a,o=e[r],s=Hg(t(n-1,r+1));try{for(s.s();!(a=s.n()).done;){var u=a.value;u.push(o),i.push(u)}}catch(c){s.e(c)}finally{s.f()}++r}return i}(t,0)}}]),e}().getCombinations(n,e.length).map(function(t){return e.map(function(e,n){return new pde(e.capturedSpaces,t[n])})})}).reduce(function(e,t){return e.concat(t)},[])}},{key:"getRingMoves",value:function(e){var t,n=this.ruler,r=[],i=Hg(this.getRingCoords(e));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=Hg(n.getRingTargets(e,o));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.push({start:o,end:u})}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getRingCoords",value:function(e){var t=e.getCurrentPlayer().value,n=[];return e.forEachCoord(function(e,r){r===dde.RINGS[t]&&n.push(e)}),n}}]),n}(tte),mde=function(e){xg(n,e);var t=Dg(n);function n(){return Zg(this,n),t.apply(this,arguments)}return Wg(n,[{key:"applyLegalMove",value:function(e,t,n){return new vde(n.board,n.sideRings,n.turn+1)}},{key:"applyCaptures",value:function(e,t){var n=this,r=t;return e.forEach(function(e){r=n.applyCapture(e,r)}),r}},{key:"applyCapture",value:function(e,t){var n=this.applyCaptureWithoutTakingRing(t,e);return this.takeRing(new vde(n,t.sideRings,t.turn),e.ringTaken.get())}},{key:"takeRing",value:function(e,t){var n=e.getCurrentPlayer().value,r=e.setAt(t,dde.EMPTY).board,i=[e.sideRings[0],e.sideRings[1]];return i[n]+=1,new vde(r,i,e.turn)}},{key:"applyCaptureWithoutTakingRing",value:function(e,t){return t.forEach(function(t){e=e.setAt(t,dde.EMPTY)}),e.board}},{key:"ringSelectionValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)===dde.RINGS[n]?pB.SUCCESS:pB.failure(hde.CAPTURE_SHOULD_TAKE_RING())}},{key:"applyRingMoveAndFlip",value:function(e,t,n){var r=n.getCurrentPlayer().value,i=n.setAt(e,dde.MARKERS[r]);i=i.setAt(t,dde.RINGS[r]);for(var a=Yee.factory.fromMove(e,t).get(),o=e.getNext(a);!1===o.equals(t);o=o.getNext(a)){var s=i.getPieceAt(o);s!==dde.EMPTY&&(i=i.setAt(o,s.flip()))}return i}},{key:"isLegal",value:function(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return hB.failure(hde.NO_MARKERS_IN_INITIAL_PHASE());var n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toFailedFallible();var r=this.applyCaptures(e.initialCaptures,t),i=this.moveValidity(r,e.start,e.end.get());if(i.isFailure())return i.toFailedFallible();var a=this.applyRingMoveAndFlip(e.start,e.end.get(),r),o=this.capturesValidity(a,e.finalCaptures);if(o.isFailure())return o.toFailedFallible();var s=this.applyCaptures(e.finalCaptures,a),u=this.noMoreCapturesValidity(s);return u.isFailure()?u.toFailedFallible():hB.success(s)}},{key:"initialPlacementValidity",value:function(e,t){if(!0!==e.isInitialPlacementPhase())return hB.failure(hde.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==dde.EMPTY)return hB.failure(ete.MUST_CLICK_ON_EMPTY_SPACE());var n=e.getCurrentPlayer(),r=[e.sideRings[0],e.sideRings[1]];r[n.value]-=1;var i=e.setAt(t,dde.of(n,!0)).board,a=new vde(i,r,e.turn);return hB.success(a)}},{key:"moveStartValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==dde.RINGS[n]?pB.failure(hde.SHOULD_SELECT_PLAYER_RING()):pB.SUCCESS}},{key:"moveValidity",value:function(e,t,n){var r=this.moveStartValidity(e,t);if(r.isFailure())return r;if(e.getPieceAt(n)!==dde.EMPTY)return pB.failure(hde.SHOULD_END_MOVE_ON_EMPTY_SPACE());var i=Yee.factory.fromMove(t,n);if(i.isFailure())return pB.failure(hde.MOVE_DIRECTION_INVALID());for(var a=i.get(),o=!1,s=t.getNext(a);!1===s.equals(n);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===dde.EMPTY){if(o)return pB.failure(hde.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(u.isRing)return pB.failure(hde.MOVE_SHOULD_NOT_PASS_ABOVE_RING());o=!0}}return pB.SUCCESS}},{key:"capturesValidity",value:function(e,t){var n,r=e,i=Hg(t);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=this.captureValidity(r,a);if(o.isFailure())return o;r=this.applyCapture(a,r)}}catch(s){i.e(s)}finally{i.f()}return pB.SUCCESS}},{key:"captureValidity",value:function(e,t){var n,r=e.getCurrentPlayer().value,i=Hg(t.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(e.getPieceAt(a)!==dde.MARKERS[r])return pB.failure(hde.CAN_ONLY_CAPTURE_YOUR_MARKERS())}}catch(o){i.e(o)}finally{i.f()}return e.getPieceAt(t.ringTaken.get())!==dde.RINGS[r]?pB.failure(hde.CAPTURE_SHOULD_TAKE_RING()):pB.SUCCESS}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?pB.SUCCESS:pB.failure(hde.MISSING_CAPTURES())}},{key:"getLinePortionsWithAtLeastFivePiecesOfPlayer",value:function(e,t){var n=this,r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithAtLeastFivePiecesOfPlayer",value:function(e,t,n){var r,i=0,a=e.getEntranceOnLine(n),o=n.getDirection(),s=a;for(r=a;e.isOnBoard(r);r=r.getNext(o)){var u=e.getPieceAt(r);if(u.player===t&&!1===u.isRing)0===i&&(s=r),i+=1;else{if(i>=5)break;i=0}}return i>=5?fB.of({start:s,end:r,dir:o}):fB.empty()}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(function(e){for(var t=e.start;t.getDistance(e.end)>=5;t=t.getNext(e.dir))n.push(pde.of(t,t.getNext(e.dir,4)))}),n}},{key:"getRingTargets",value:function(e,t){var n,r=[],i=Hg(Yee.factory.all);try{for(i.s();!(n=i.n()).done;)for(var a=n.value,o=!1,s=t.getNext(a);e.isOnBoard(s);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===dde.EMPTY){if(r.push(s),o)break}else{if(u.isRing)break;o=!0}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){return e.gameState.isInitialPlacementPhase()?gte.ONGOING:e.gameState.sideRings[0]>=3?gte.ZERO_WON:e.gameState.sideRings[1]>=3?gte.ONE_WON:gte.ONGOING}}]),n}(yte),kde=dde.EMPTY,Cde=dde.UNREACHABLE,wde=dde.MARKER_ZERO,_de=dde.RING_ZERO,Ede=dde.MARKER_ONE,bde=dde.RING_ONE,Pde=function(){var e=Wg(function e(){Zg(this,e)});return e.MUST_ALIGN_FIVE=function(){return $localize(mf||(mf=_g(["Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time."])))},e.MUST_CAPTURE_TWO=function(){return $localize(kf||(kf=_g(["Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again."])))},e}(),Sde=Wg(function e(){Zg(this,e),this.tutorial=[wte.informational($localize(Cf||(Cf=_g(["Goal of the game"]))),$localize(wf||(wf=_g(["The goal at Yinsh is to capture three rings in total.\n        The rings taken are shown on the top left for the dark player,\n        and on the bottom right for the light player. Here, Dark won the game.\n        Note that on the board you have two types of pieces for each player:\n        rings (empty circles) and markers (full circles)."]))),new vde([[Cde,Cde,Cde,Cde,Cde,Cde,kde,kde,kde,kde,Cde],[Cde,Cde,Cde,Cde,kde,kde,kde,kde,kde,kde,kde],[Cde,Cde,Cde,wde,bde,kde,kde,kde,kde,kde,kde],[Cde,Cde,kde,wde,kde,bde,kde,Ede,kde,kde,kde],[Cde,kde,_de,Ede,kde,kde,bde,wde,kde,kde,kde],[Cde,kde,kde,wde,Ede,kde,kde,kde,kde,kde,Cde],[kde,kde,kde,wde,kde,kde,kde,bde,kde,kde,Cde],[kde,kde,kde,Ede,wde,_de,kde,kde,kde,Cde,Cde],[kde,kde,kde,kde,kde,kde,kde,kde,Cde,Cde,Cde],[kde,kde,kde,kde,kde,kde,kde,Cde,Cde,Cde,Cde],[Cde,kde,kde,kde,kde,Cde,Cde,Cde,Cde,Cde,Cde]],[3,1],20)),wte.anyMove($localize(_f||(_f=_g(["Initial board and placement phase"]))),$localize(Ef||(Ef=_g(["The initial board is empty.\n        At the beginning of the game, each player puts one of its ring on the board at their turn.\n        This phase stops when all rings have been placed on the board.\n        Put one of your ring on the board by clicking the space where you want to place it."]))),new vde(vde.getInitialState().board,[5,5],0),new gde([],new Zee(5,5),fB.empty(),[]),$localize(bf||(bf=_g(["Congratulations!"])))),wte.anyMove($localize(Pf||(Pf=_g(["Putting a marker"]))),$localize(Sf||(Sf=_g(["Once the initial phase is done and all rings are on the board, you need to place markers on the board.\n        To do so, put a marker in a ring by clicking on that ring.\n        Then, the ring must be moved in a straight line, in any direction.\n        A ring cannot pass through other rings during its move.\n        If it goes over a group of markers, your move must stop at the first empty space after that group.\n        All markers in the group are then flipped and their color change.<br/><br/>\n        You're playing Dark, do a move."]))),new vde([[Cde,Cde,Cde,Cde,Cde,Cde,kde,kde,kde,kde,Cde],[Cde,Cde,Cde,Cde,kde,kde,kde,kde,kde,kde,kde],[Cde,Cde,Cde,bde,kde,kde,kde,kde,kde,kde,kde],[Cde,Cde,bde,kde,kde,bde,kde,kde,kde,kde,kde],[Cde,kde,_de,Ede,kde,kde,bde,kde,kde,kde,kde],[Cde,kde,kde,Ede,kde,kde,kde,kde,kde,kde,Cde],[kde,kde,kde,kde,_de,kde,kde,bde,kde,kde,Cde],[kde,kde,kde,kde,kde,_de,kde,kde,kde,Cde,Cde],[kde,kde,kde,_de,kde,kde,kde,Cde,Cde,Cde,Cde],[kde,kde,kde,kde,kde,kde,kde,Cde,Cde,Cde,Cde],[Cde,kde,kde,kde,kde,Cde,Cde,Cde,Cde,Cde,Cde]],[0,0],20),new gde([],new Zee(2,4),fB.of(new Zee(4,4)),[]),$localize(Of||(Of=_g(["Congratulations!"])))),wte.fromPredicate($localize(Tf||(Tf=_g(["Getting a ring by aligning 5 markers"]))),$localize(If||(If=_g(["Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.\n        To do so, you need to align 5 markers of your color.\n        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.\n        You will then have one more point.\n        You must capture when you can.<br/><br/>\n        You're playing Dark, perform a capture!"]))),new vde([[Cde,Cde,Cde,Cde,Cde,Cde,kde,kde,kde,kde,Cde],[Cde,Cde,Cde,Cde,kde,kde,kde,kde,kde,kde,kde],[Cde,Cde,Cde,bde,kde,kde,kde,kde,kde,kde,kde],[Cde,Cde,bde,kde,kde,bde,kde,kde,kde,kde,kde],[Cde,kde,wde,wde,_de,Ede,Ede,kde,kde,kde,kde],[Cde,kde,kde,bde,kde,kde,kde,kde,kde,kde,Cde],[kde,kde,kde,kde,_de,kde,kde,bde,kde,kde,Cde],[kde,kde,kde,kde,kde,_de,kde,kde,kde,Cde,Cde],[kde,kde,kde,_de,kde,kde,kde,_de,Cde,Cde,Cde],[kde,kde,kde,kde,kde,kde,kde,Cde,Cde,Cde,Cde],[Cde,kde,kde,kde,kde,Cde,Cde,Cde,Cde,Cde,Cde]],[0,0],20),new gde([],new Zee(4,4),fB.of(new Zee(7,4)),[pde.of(new Zee(2,4),new Zee(6,4),new Zee(7,4))]),function(e,t,n){return 1===n.sideRings[R7.ZERO.value]?pB.SUCCESS:pB.failure(Pde.MUST_ALIGN_FIVE())},$localize(Af||(Af=_g(["Congratulations!"])))),wte.fromPredicate($localize(Rf||(Rf=_g(["Compound captures"]))),$localize(Mf||(Mf=_g(["During a turn, you could have to choose between multiple captures,\n        or you could even capture multiple times!\n        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>\n        Here, you can capture two rings, do it!"]))),new vde([[Cde,Cde,Cde,Cde,Cde,Cde,kde,kde,kde,kde,Cde],[Cde,Cde,Cde,Cde,_de,kde,kde,bde,bde,_de,kde],[Cde,Cde,Cde,_de,kde,kde,Ede,bde,kde,_de,kde],[Cde,Cde,kde,_de,kde,kde,kde,kde,kde,bde,kde],[Cde,kde,kde,kde,kde,wde,kde,kde,bde,kde,kde],[Cde,kde,kde,kde,wde,wde,kde,Ede,kde,kde,Cde],[kde,kde,kde,wde,kde,wde,kde,kde,kde,kde,Cde],[kde,kde,wde,kde,kde,wde,kde,kde,kde,Cde,Cde],[kde,wde,kde,kde,kde,wde,kde,kde,Cde,Cde,Cde],[kde,kde,kde,kde,kde,wde,kde,Cde,Cde,Cde,Cde],[Cde,kde,kde,kde,kde,Cde,Cde,Cde,Cde,Cde,Cde]],[0,0],10),new gde([pde.of(new Zee(5,4),new Zee(1,8),new Zee(3,2)),pde.of(new Zee(5,9),new Zee(5,5),new Zee(3,3))],new Zee(4,1),fB.of(new Zee(4,2)),[]),function(e,t,n){return 2===n.sideRings[R7.ZERO.value]?pB.SUCCESS:pB.failure(Pde.MUST_CAPTURE_TWO())},$localize(xf||(xf=_g(["Congratulations!"]))))]});function Ode(e,t){if(1&e&&(cC(),nP(0,"circle",9)),2&e){var n=fP(2).$implicit,r=fP(2);$b("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringOuterSize)}}function Tde(e,t){if(1&e&&(cC(),nP(0,"circle",10)),2&e){var n=fP(2),r=n.index,i=n.$implicit,a=fP().index,o=fP();vP("id","ring_",r,"_",a,""),Xb("ngClass",i.ringClasses),$b("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.ringMidSize)}}function Ide(e,t){if(1&e&&(cC(),nP(0,"circle",9)),2&e){var n=fP(2).$implicit,r=fP(2);$b("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringInnerSize)}}function Ade(e,t){if(1&e&&(cC(),nP(0,"circle",11)),2&e){var n=fP(2),r=n.index,i=n.$implicit,a=fP().index,o=fP();vP("id","marker_",r,"_",a,""),Xb("ngClass",i.markerClasses),$b("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.markerSize)}}function Rde(e,t){if(1&e){var n=aP();cC(),eP(0,"g",3),uP("click",function(){Nk(n);var e=fP().$implicit;return fP(2).onClick(e.coord)}),nP(1,"polyline",4),eP(2,"g",5),Yb(3,Ode,1,3,"circle",6),Yb(4,Tde,1,6,"circle",7),Yb(5,Ide,1,3,"circle",6),Yb(6,Ade,1,6,"circle",8),tP(),tP()}if(2&e){var r=fP(),i=r.index,a=r.$implicit,o=fP().index;vP("id","click_",i,"_",o,""),pE(1),vP("id","space_",i,"_",o,""),Xb("ngClass",a.spaceClasses),$b("points",a.coordinates),pE(1),vP("id","pieceGroup_",i,"_",o,""),Xb("ngClass",a.removedClass),pE(1),Xb("ngIf",a.isRing),pE(1),Xb("ngIf",a.isRing),pE(1),Xb("ngIf",a.isRing),pE(1),Xb("ngIf",a.isMarker)}}function Mde(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Rde,7,13,"g",2),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngIf",null!=n)}}function xde(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Mde,2,1,"g",1),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}function Nde(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"polyline",12),uP("click",function(){var e=Nk(n).$implicit;return fP().onClick(e)}),tP(),tP()}if(2&e){var r=t.$implicit,i=fP();pE(1),vP("id","selected_",r.x,"_",r.y,""),$b("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function Dde(e,t){if(1&e){var n=aP();cC(),eP(0,"polyline",14),uP("click",function(){Nk(n);var e=fP().$implicit;return fP().onClick(e)}),tP()}if(2&e){var r=fP().$implicit,i=fP();vP("id","selectable_",r.x,"_",r.y,""),$b("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function Lde(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Dde,1,3,"polyline",13),tP()),2&e){var n=fP();pE(1),Xb("ngIf",n.isPlayerTurn())}}function Fde(e,t){if(1&e){var n=aP();cC(),eP(0,"g"),eP(1,"rect",15),uP("click",function(){var e=Nk(n).$implicit;return fP().onClick(e)}),tP(),tP()}if(2&e){var r=t.$implicit,i=fP();pE(1),$b("x",i.viewInfo.spaceInfo[r.y][r.x].center.x-i.viewInfo.indicatorSize/2)("y",i.viewInfo.spaceInfo[r.y][r.x].center.y-i.viewInfo.indicatorSize/2)("width",i.viewInfo.indicatorSize)("height",i.viewInfo.indicatorSize)}}function Ude(e,t){if(1&e&&(cC(),eP(0,"g"),nP(1,"circle",16),nP(2,"circle",9),nP(3,"circle",17),tP()),2&e){var n=t.index,r=fP().$implicit,i=fP();pE(1),vP("id","player_",r,"_sideRing_",n+1,""),$b("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringOuterSize),pE(1),$b("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringInnerSize),pE(1),Xb("ngClass",i.viewInfo.sideRingClass[r]),$b("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringMidSize)}}var Vde=function(){return[]};function Bde(e,t){if(1&e&&(cC(),eP(0,"g"),Yb(1,Ude,4,12,"g",1),tP()),2&e){var n=t.$implicit,r=fP();pE(1),Xb("ngForOf",aT(1,Vde).constructor(r.viewInfo.sideRings[n]))}}var zde=function(){return[0,1]},Hde=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,e)).movePhase="MOVE_START",r.moveStart=fB.empty(),r.moveEnd=fB.empty(),r.currentlyMoved=[],r.currentCapture=fB.empty(),r.initialCaptures=[],r.finalCaptures=[],r.possibleCaptures=[],r.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:n.MARKER_SIZE,ringOuterSize:n.RING_OUTER_SIZE,ringMidSize:n.RING_MID_SIZE,ringInnerSize:n.RING_INNER_SIZE,indicatorSize:n.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},r.scores=fB.of([0,0]),r.rules=new mde(vde),r.availableMinimaxes=[new yde(r.rules,"YinshMinimax")],r.encoder=gde.encoder,r.tutorial=(new Sde).tutorial,r.hexaLayout=new Kee(1.5*n.RING_OUTER_SIZE,new Zee(2*n.RING_OUTER_SIZE,0),Jee.INSTANCE),r.constructedState=r.rules.node.gameState,r.constructedState.allCoords().forEach(function(e){null==r.viewInfo.spaceInfo[e.y]&&(r.viewInfo.spaceInfo[e.y]=[]),r.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:r.getHexaCoordsAt(e),center:r.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}}),r}return Wg(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.scores=fB.of(this.rules.node.gameState.countScores())}},{key:"updateViewInfo",value:function(){var e=this;this.constructedState.allCoords().forEach(function(t){e.viewInfo.spaceInfo[t.y][t.x].spaceClasses=e.getSpaceClasses(t);var n=e.constructedState.getPieceAt(t);e.viewInfo.spaceInfo[t.y][t.x].removedClass="",e.setRingInfo(t,n),e.setMarkerInfo(t,n)});var t,n=Hg(R7.PLAYERS);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.sideRings[r.value]=this.constructedState.sideRings[r.value]}}catch(c){n.e(c)}finally{n.f()}switch(this.showCurrentMoveCaptures(),this.showLastMove(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];var i,a=Hg(this.possibleCaptures);try{for(a.s();!(i=a.n()).done;){var o,s=Hg(i.value.capturedSpaces);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.viewInfo.selectableCoords.push(u)}}catch(c){s.e(c)}finally{s.f()}}}catch(c){a.e(c)}finally{a.f()}break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.rules.node.gameState.isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}},{key:"showCurrentMoveCaptures",value:function(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());var e,t=Hg(this.initialCaptures);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.markCurrentCapture(n)}}catch(o){t.e(o)}finally{t.f()}var r,i=Hg(this.finalCaptures);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.markCurrentCapture(a)}}catch(o){i.e(o)}finally{i.f()}}},{key:"getSpaceClasses",value:function(e){return this.currentlyMoved.some(function(t){return t.equals(e)})?["moved"]:[]}},{key:"setRingInfo",value:function(e,t){if(t.isRing){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[n+"-stroke"]}else this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[]}},{key:"setMarkerInfo",value:function(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==dde.EMPTY&&(!t.isRing||t.isRing&&this.moveStart.equalsValue(e))){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[n]}}},{key:"cancelMoveAttempt",value:function(){this.constructedState=this.rules.node.gameState,this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=fB.empty(),this.moveStart=fB.empty(),this.moveEnd=fB.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}},{key:"showLastMove",value:function(){var e=this,t=this.rules.node.move;if(t.isPresent()){var n=t.get();if(n.isInitialPlacement())this.viewInfo.spaceInfo[n.start.y][n.start.x].spaceClasses=["moved"];else{var r,i=Hg(this.coordsBetween(n.start,n.end.get()));try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.spaceInfo[a.y][a.x].spaceClasses=["moved"]}}catch(s){i.e(s)}finally{i.f()}var o=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();n.initialCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)}),n.finalCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)})}}}},{key:"coordsBetween",value:function(e,t){for(var n=[],r=Yee.factory.fromMove(e,t).get(),i=e;!i.equals(t);i=i.getNext(r))this.constructedState.getPieceAt(i)!==dde.EMPTY&&n.push(i),n.push(t);return n}},{key:"showLastMoveCapture",value:function(e,t){var n,r=Hg(e.capturedSpaces);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.viewInfo.spaceInfo[i.y][i.x].spaceClasses=["captured"],t&&this.markRemovedMarker(i,this.rules.node.gameState.getCurrentPlayer().getOpponent())}}catch(a){r.e(a)}finally{r.f()}this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured"],t&&this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer().getOpponent())}},{key:"moveToInitialCaptureOrMovePhase",value:function(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),pB.SUCCESS}},{key:"onClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:n.t0=t.movePhase,n.next="INITIAL_CAPTURE_SELECT_FIRST"===n.t0||"FINAL_CAPTURE_SELECT_FIRST"===n.t0?6:"INITIAL_CAPTURE_SELECT_LAST"===n.t0||"FINAL_CAPTURE_SELECT_LAST"===n.t0?7:"INITIAL_CAPTURE_SELECT_RING"===n.t0||"FINAL_CAPTURE_SELECT_RING"===n.t0?8:"MOVE_START"===n.t0?9:"MOVE_END"===n.t0?10:11;break;case 6:return n.abrupt("return",t.selectCaptureFirstCoord(e));case 7:return n.abrupt("return",t.selectCaptureLastCoord(e));case 8:return n.abrupt("return",t.selectRing(e));case 9:return n.abrupt("return",t.selectMoveStart(e));case 10:return n.abrupt("return",t.selectMoveEnd(e));case 11:case"end":return n.stop()}},n)}))()}},{key:"selectCaptureFirstCoord",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),!(r.length>1)){n.next=5;break}t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(r),n.next=8;break;case 5:if(0!==r.length){n.next=7;break}return n.abrupt("return",t.cancelMove(hde.MISSING_CAPTURES()));case 7:t.selectCapture(r[0]);case 8:return n.abrupt("return",pB.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveToCaptureSelectLast",value:function(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;var t,n=Hg(e);try{for(n.s();!(t=n.n()).done;){var r,i=Hg(t.value.capturedSpaces);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.selectableCoords.push(a)}}catch(o){i.e(o)}finally{i.f()}}}catch(o){n.e(o)}finally{n.f()}"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(oB.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}},{key:"selectCaptureLastCoord",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=[],n.abrupt("return",(t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),r.length>1?t.cancelMove(hde.AMBIGUOUS_CAPTURE_COORD()):0===r.length?t.cancelMove(hde.MISSING_CAPTURES()):t.selectCapture(r[0])));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectCapture",value:function(e){return this.currentCapture=fB.of(e),this.constructedState=new vde(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(v7("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),pB.SUCCESS}},{key:"markCurrentCapture",value:function(e){var t,n=Hg(e.capturedSpaces);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.selectedCoords.push(r),this.markRemovedMarker(r,this.rules.node.gameState.getCurrentPlayer())}}catch(i){n.e(i)}finally{n.f()}e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer()))}},{key:"markRemovedMarker",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setMarkerInfo(e,dde.MARKERS[t.value])}},{key:"markRemovedRing",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setRingInfo(e,dde.RINGS[t.value])}},{key:"selectRing",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.rules.ringSelectionValidity(t.constructedState,e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return t.constructedState=t.rules.takeRing(t.constructedState,e),i=t.currentCapture.get().setRingTaken(e),n.abrupt("return","INITIAL_CAPTURE_SELECT_RING"===(t.currentCapture=fB.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase)?(t.initialCaptures.push(i),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),pB.SUCCESS)):(oB.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(i),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),pB.SUCCESS)));case 6:case"end":return n.stop()}},n)}))()}},{key:"moveToMovePhase",value:function(){return this.movePhase="MOVE_START",this.updateViewInfo(),pB.SUCCESS}},{key:"tryMove",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new gde(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures),t.next=3,e.chooseMove(n,e.rules.node.gameState,e.scores.get());case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"selectMoveStart",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.constructedState.isInitialPlacementPhase()){n.next=3;break}return r=t.rules.initialPlacementValidity(t.constructedState,e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.moveStart=fB.of(e),t.tryMove()));case 3:if(!(i=t.rules.moveStartValidity(t.constructedState,e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(i.getReason()));case 6:return t.moveStart=fB.of(e),t.movePhase="MOVE_END",t.updateViewInfo(),n.abrupt("return",pB.SUCCESS);case 8:case"end":return n.stop()}},n)}))()}},{key:"selectMoveEnd",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.moveEnd=fB.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.moveStart.get(),e,t.constructedState),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove()));case 2:case"end":return n.stop()}},n)}))()}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),pB.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(Wee);function Gde(e,t){if(1&e&&(eP(0,"option",5),FP(1),tP()),2&e){var n=t.$implicit;Xb("value",n.urlName),pE(1),UP(n.name)}}Hde.RING_OUTER_SIZE=40,Hde.RING_MID_SIZE=34,Hde.RING_INNER_SIZE=28,Hde.MARKER_SIZE=Hde.RING_INNER_SIZE,Hde.INDICATOR_SIZE=10,Hde.\u0275fac=function(e){return new(e||Hde)(Qb(h7))},Hde.\u0275cmp=Gm({type:Hde,selectors:[["app-yinsh"]],features:[Rb],decls:6,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected",3,"id","click"],["pointer-events","fill","class","base no-fill capturable","stroke-linecap","round",3,"id","click",4,"ngIf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable",3,"id","click"],[1,"indicator",3,"click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(cC(),eP(0,"svg",0),Yb(1,xde,2,1,"g",1),Yb(2,Nde,2,3,"g",1),Yb(3,Lde,2,1,"g",1),Yb(4,Fde,2,4,"g",1),Yb(5,Bde,2,2,"g",1),tP()),2&e&&(pE(1),Xb("ngForOf",t.viewInfo.spaceInfo),pE(1),Xb("ngForOf",t.viewInfo.selectedCoords),pE(1),Xb("ngForOf",t.viewInfo.selectableCoords),pE(1),Xb("ngForOf",t.viewInfo.targets),pE(1),Xb("ngForOf",aT(5,zde)))},directives:[LA,UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var $de=function(){var e=Wg(function e(){Zg(this,e)});return e.ABALONE=function(){return $localize(Nf||(Nf=_g(["Use simple mechanics to push 6 of the opponent's pieces out of the board!"])))},e.APAGOS=function(){return $localize(Df||(Df=_g(["Very simple game, but, will you be able to win everytime?"])))},e.AWALE=function(){return $localize(Lf||(Lf=_g(["The international version of the famous African strategy game!"])))},e.BRANDHUB=function(){return $localize(Ff||(Ff=_g(["The Irish version of the Tafl game family!"])))},e.COERCEO=function(){return $localize(Uf||(Uf=_g(["Get rid of all of your opponent's pieces on a board that shrinks little by little!"])))},e.CONSPIRATEURS=function(){return $localize(Vf||(Vf=_g(["Hide all of your pieces before your opponent does, or risk to be discovered!"])))},e.DIAM=function(){return $localize(Bf||(Bf=_g(["Drop your pieces and move them around to align two pieces of the same color across the board to win!"])))},e.DVONN=function(){return $localize(zf||(zf=_g(["Stack your pieces and control as many stacks as you can to win!"])))},e.ENCAPSULE=function(){return $localize(Hf||(Hf=_g(["An enhanced tic-tac-toe where piece can encapsule other and prevent them to win."])))},e.EPAMINONDAS=function(){return $localize(Gf||(Gf=_g(["An antiquity-war inspired game. Be the first to pierce your opponent's lines!"])))},e.GIPF=function(){return $localize($f||($f=_g(["A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!"])))},e.GO=function(){return $localize(Zf||(Zf=_g(["The oldest strategy game still practiced widely. A territory control game."])))},e.KAMISADO=function(){return $localize(qf||(qf=_g(["Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!"])))},e.LINES_OF_ACTION=function(){return $localize(Wf||(Wf=_g(["Regroup your pieces to win. But your possible moves will often change!"])))},e.LODESTONE=function(){return $localize(jf||(jf=_g(["Push and crush your opponent's pieces using magnetic forces!"])))},e.MARTIAN_CHESS=function(){return $localize(Yf||(Yf=_g(["Win points by capturing pieces, but you only control pieces on your side of the board!"])))},e.P4=function(){return $localize(Kf||(Kf=_g(["The classical 4 in a row game!"])))},e.PENTAGO=function(){return $localize(Qf||(Qf=_g(["Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!"])))},e.PYLOS=function(){return $localize(Xf||(Xf=_g(["Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!"])))},e.QUARTO=function(){return $localize(Jf||(Jf=_g(["Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!"])))},e.QUIXO=function(){return $localize(eh||(eh=_g(["Align 5 of your pieces on a board where pieces slide!"])))},e.REVERSI=function(){return $localize(th||(th=_g(["Sandwich your opponent's pieces to dominate the board!"])))},e.SAHARA=function(){return $localize(nh||(nh=_g(["Immobilize one of your opponent's pyramids before your opponent does!"])))},e.SIAM=function(){return $localize(rh||(rh=_g(["Be the first to push a mountain out of the board!"])))},e.SIX=function(){return $localize(ih||(ih=_g(["Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!"])))},e.TABLUT=function(){return $localize(ah||(ah=_g(["The Viking board game! Invaders must capture the king, defender must make him escape!"])))},e.YINSH=function(){return $localize(oh||(oh=_g(["Align your pieces to score points, but beware, pieces can flip!"])))},e}(),Zde=function(){var e=Wg(function e(t,n,r,i,a){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];Zg(this,e),this.name=t,this.urlName=n,this.component=r,this.creationDate=i,this.description=a,this.display=o});return e.ALL_GAMES=function(){return[new e("MinimaxTesting","MinimaxTesting",que,new Date("1970-01-01"),"",!1),new e($localize(sh||(sh=_g(["Four in a Row"]))),"P4",sce,new Date("2018-08-28"),$de.P4()),new e($localize(uh||(uh=_g(["Awal\xe9"]))),"Awale",fne,new Date("2018-11-29"),$de.AWALE()),new e($localize(ch||(ch=_g(["Quarto"]))),"Quarto",zle,new Date("2018-12-09"),$de.QUARTO()),new e($localize(lh||(lh=_g(["Tablut"]))),"Tablut",fde,new Date("2018-12-27"),$de.TABLUT()),new e($localize(fh||(fh=_g(["Reversi"]))),"Reversi",gfe,new Date("2019-01-16"),$de.REVERSI()),new e($localize(hh||(hh=_g(["Go"]))),"Go",boe,new Date("2019-12-21"),$de.GO()),new e($localize(dh||(dh=_g(["Encapsule"]))),"Encapsule",lae,new Date("2019-12-30"),$de.ENCAPSULE()),new e($localize(vh||(vh=_g(["Siam"]))),"Siam",whe,new Date("2020-01-11"),$de.SIAM()),new e($localize(ph||(ph=_g(["Sahara"]))),"Sahara",Ufe,new Date("2020-02-29"),$de.SAHARA()),new e($localize(gh||(gh=_g(["Pylos"]))),"Pylos",Kce,new Date("2020-10-02"),$de.PYLOS()),new e($localize(yh||(yh=_g(["Kamisado"]))),"Kamisado",ase,new Date("2020-10-03"),$de.KAMISADO()),new e($localize(mh||(mh=_g(["Quixo"]))),"Quixo",nfe,new Date("2020-10-15"),$de.QUIXO()),new e($localize(kh||(kh=_g(["Dvonn"]))),"Dvonn",Bie,new Date("2020-10-21"),$de.DVONN()),new e($localize(Ch||(Ch=_g(["Epaminondas"]))),"Epaminondas",Sae,new Date("2021-01-16"),$de.EPAMINONDAS()),new e($localize(wh||(wh=_g(["Gipf"]))),"Gipf",Kae,new Date("2021-02-22"),$de.GIPF()),new e($localize(_h||(_h=_g(["Coerceo"]))),"Coerceo",_re,new Date("2021-03-21"),$de.COERCEO()),new e($localize(Eh||(Eh=_g(["Six"]))),"Six",$he,new Date("2021-04-08"),$de.SIX()),new e($localize(bh||(bh=_g(["Lines of Action"]))),"LinesOfAction",kse,new Date("2021-04-28"),$de.LINES_OF_ACTION()),new e($localize(Ph||(Ph=_g(["Pentago"]))),"Pentago",Oce,new Date("2021-05-23"),$de.PENTAGO()),new e($localize(Sh||(Sh=_g(["Abalone"]))),"Abalone",Bte,new Date("2021-07-13"),$de.ABALONE()),new e($localize(Oh||(Oh=_g(["Yinsh"]))),"Yinsh",Hde,new Date("2021-07-31"),$de.YINSH()),new e($localize(Th||(Th=_g(["Apagos"]))),"Apagos",tne,new Date("2021-11-04"),$de.APAGOS()),new e($localize(Ih||(Ih=_g(["Diam"]))),"Diam",lie,new Date("2021-11-30"),$de.DIAM()),new e($localize(Ah||(Ah=_g(["Brandhub"]))),"Brandhub",Wne,new Date("2021-12-07"),$de.BRANDHUB()),new e($localize(Rh||(Rh=_g(["Conspirateurs"]))),"Conspirateurs",Gre,new Date("2021-12-30"),$de.CONSPIRATEURS()),new e($localize(Mh||(Mh=_g(["Lodestone"]))),"Lodestone",Xse,new Date("2022-06-24"),$de.LODESTONE()),new e($localize(xh||(xh=_g(["Martian Chess"]))),"MartianChess",Due,new Date("2022-07-01"),$de.MARTIAN_CHESS())].sort(function(e,t){return e.name.localeCompare(t.name)})},e}(),qde=function(){var e=function(){function e(){Zg(this,e),this.games=Zde.ALL_GAMES().filter(function(e){return!0===e.display}),this.pickGame=new gT}return Wg(e,[{key:"onChange",value:function(e){this.pickGame.emit(e.target.value)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Gm({type:e,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){return[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],$localize(Nh||(Nh=_g(["Pick a game"]))),[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,t){1&e&&(eP(0,"div",0),eP(1,"select",1),uP("change",function(e){return t.onChange(e)}),eP(2,"option",2),ZS(3,3),tP(),Yb(4,Gde,2,2,"option",4),tP(),tP()),2&e&&(pE(4),Xb("ngForOf",t.games))},directives:[ox,lx,LA],encapsulation:2}),e}();function Wde(e,t){if(1&e){var n=aP();eP(0,"div",26),eP(1,"div",27),uP("click",function(){return Nk(n),fP().closeInfo()}),tP(),eP(2,"div",28),eP(3,"header",29),eP(4,"p",30),FP(5),tP(),eP(6,"button",31),uP("click",function(){return Nk(n),fP().closeInfo()}),tP(),tP(),eP(7,"section",32),eP(8,"div",6),eP(9,"div",33),eP(10,"p",34),nP(11,"img",35),tP(),tP(),eP(12,"div",7),eP(13,"div",13),FP(14),tP(),tP(),tP(),eP(15,"div",6),eP(16,"div",33),eP(17,"a",36),uP("click",function(){Nk(n);var e=fP();return e.createGame(e.gameInfoDetails.get().urlName)}),nP(18,"fa-icon",37),FP(19,"\xa0"),eP(20,"span"),ZS(21,38),tP(),tP(),tP(),eP(22,"div",33),eP(23,"a",36),uP("click",function(){Nk(n);var e=fP();return e.createLocalGame(e.gameInfoDetails.get().urlName)}),nP(24,"fa-icon",37),FP(25,"\xa0"),eP(26,"span"),ZS(27,39),tP(),tP(),tP(),eP(28,"div",33),eP(29,"a",36),uP("click",function(){Nk(n);var e=fP();return e.createTutorial(e.gameInfoDetails.get().urlName)}),nP(30,"fa-icon",37),FP(31,"\xa0"),eP(32,"span"),ZS(33,40),tP(),tP(),tP(),tP(),tP(),tP(),tP()}if(2&e){var r=fP();pE(5),UP(r.gameInfoDetails.get().name),pE(6),vP("src","assets/images/",r.theme,"/",r.gameInfoDetails.get().urlName,".png",u_),pE(3),VP(" ",r.gameInfoDetails.get().description," "),pE(4),Xb("icon",r.iconOnlineGame),pE(6),Xb("icon",r.iconLocalGame),pE(6),Xb("icon",r.iconTutorial)}}function jde(e,t){if(1&e){var n=aP();eP(0,"div",8),eP(1,"div",9),eP(2,"p",10),FP(3),tP(),tP(),eP(4,"div",42),eP(5,"figure",34),eP(6,"img",43),uP("click",function(){var e=Nk(n).$implicit;return fP(2).openInfo(e)}),tP(),eP(7,"figcaption",44),uP("click",function(){var e=Nk(n).$implicit;return fP(2).openInfo(e)}),eP(8,"div",45),FP(9,"?"),tP(),tP(),eP(10,"figcaption",46),eP(11,"a",47),uP("click",function(){var e=Nk(n).$implicit;return fP(2).createGame(e.urlName)}),nP(12,"fa-icon",37),tP(),eP(13,"a",48),uP("click",function(){var e=Nk(n).$implicit;return fP(2).createLocalGame(e.urlName)}),nP(14,"fa-icon",37),tP(),eP(15,"a",49),uP("click",function(){var e=Nk(n).$implicit;return fP(2).createTutorial(e.urlName)}),nP(16,"fa-icon",37),tP(),tP(),tP(),tP(),eP(17,"div",50),FP(18),tP(),tP()}if(2&e){var r=t.$implicit,i=fP(2);pE(3),UP(r.name),pE(3),dP("id","image_",r.urlName,""),vP("src","assets/images/",i.theme,"/",r.urlName,".png",u_),pE(5),dP("id","playOnline_",r.urlName,""),pE(1),Xb("icon",i.iconOnlineGame),pE(1),dP("id","playLocally_",r.urlName,""),pE(1),Xb("icon",i.iconLocalGame),pE(1),dP("id","startTutorial_",r.urlName,""),pE(1),Xb("icon",i.iconTutorial),pE(2),VP(" ",r.description," ")}}function Yde(e,t){if(1&e&&(eP(0,"div",7),Yb(1,jde,19,11,"div",41),tP()),2&e){var n=t.$implicit;pE(1),Xb("ngForOf",n)}}var Kde=function(){var e=function(){function e(t,n){Zg(this,e),this.router=t,this.numberOfColumns=4,this.games=[],this.iconOnlineGame=Q7,this.iconLocalGame=Y7,this.iconTutorial=W7,this.gameInfoDetails=fB.empty(),this.theme=n.getTheme();for(var r=Zde.ALL_GAMES().filter(function(e){return!0===e.display}),i=0,a=0;a<r.length;a++)a<this.numberOfColumns&&this.games.push([]),this.games[i].push(r[a]),i=(i+1)%this.numberOfColumns}return Wg(e,[{key:"createGame",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/play",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createLocalGame",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/local",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createTutorial",value:function(e){return this.router.navigate(["/tutorial",e])}},{key:"openInfo",value:function(e){this.gameInfoDetails=fB.of(e)}},{key:"closeInfo",value:function(){this.gameInfoDetails=fB.empty()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(jL),Qb(q7))},e.\u0275cmp=Gm({type:e,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){return[[1,"hero"],[1,"hero-body"],[1,"title"],$localize(Dh||(Dh=_g(["EveryBoard"]))),[1,"subtitle"],$localize(Lh||(Lh=_g(["EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.",":LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn."])),"\ufffd#6\ufffd\ufffd/#6\ufffd"),[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],$localize(Fh||(Fh=_g(["Play online"]))),[1,"card-content"],[1,"content"],["id","createOnlineGame","routerLink","/play",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(Uh||(Uh=_g(["Create an online game"]))),["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],$localize(Vh||(Vh=_g(["See the game list"]))),$localize(Bh||(Bh=_g(["Play offline"]))),[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(zh||(zh=_g(["Play"]))),["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],$localize(Hh||(Hh=_g(["Learn"]))),["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],$localize(Gh||(Gh=_g(["Play online"]))),$localize($h||($h=_g(["Play offline"]))),$localize(Zh||(Zh=_g(["Learn the rules"]))),["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",$localize(qh||(qh=_g(["Play online"]))),1,"button",3,"id","click"],["data-tooltip",$localize(Wh||(Wh=_g(["Play offline"]))),1,"button",3,"id","click"],["data-tooltip",$localize(jh||(jh=_g(["Learn the rules"]))),1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,t){1&e&&(eP(0,"section",0),eP(1,"div",1),eP(2,"p",2),ZS(3,3),tP(),eP(4,"p",4),GS(5,5),nP(6,"br"),$S(),tP(),tP(),eP(7,"div",6),eP(8,"div",7),eP(9,"div",8),eP(10,"header",9),eP(11,"p",10),ZS(12,11),tP(),tP(),eP(13,"div",12),eP(14,"div",13),eP(15,"button",14),ZS(16,15),tP(),eP(17,"button",16),ZS(18,17),tP(),tP(),tP(),tP(),tP(),eP(19,"div",7),eP(20,"div",8),eP(21,"header",9),eP(22,"p",10),ZS(23,18),tP(),tP(),eP(24,"div",12),eP(25,"div",19),eP(26,"button",20),ZS(27,21),tP(),eP(28,"button",22),ZS(29,23),tP(),tP(),tP(),tP(),tP(),tP(),Yb(30,Wde,34,7,"div",24),eP(31,"div",6),Yb(32,Yde,2,1,"div",25),tP(),tP()),2&e&&(pE(30),Xb("ngIf",t.gameInfoDetails.isPresent()),pE(2),Xb("ngForOf",t.games))},directives:[KL,UA,LA,Eee],encapsulation:2}),e}(),Qde=function(){var e=function(){function e(t){Zg(this,e),this.element=t}return Wg(e,[{key:"ngAfterViewInit",value:function(){this.element.nativeElement.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(uO))},e.\u0275dir=Ym({type:e,selectors:[["","autofocus",""]]}),e}(),Xde=function(){var e=function(){function e(t){var n=this;Zg(this,e),this.shown=!1,this.input=t.nativeElement.parentNode.previousSibling,t.nativeElement.addEventListener("click",function(e){n.toggle()})}return Wg(e,[{key:"toggle",value:function(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(uO))},e.\u0275dir=Ym({type:e,selectors:[["","toggleVisibility",""]]}),e}();function Jde(e,t){if(1&e&&(eP(0,"div",29),eP(1,"div",30),ZS(2,31),tP(),eP(3,"div",32),FP(4),tP(),tP()),2&e){var n=fP();pE(4),UP(n.errorMessage)}}var eve=function(){return["/register"]},tve=function(){return["/reset-password"]},nve=function(){var e=function(){function e(t,n){Zg(this,e),this.router=t,this.connectedUserService=n,this.faEye=K7,this.loginForm=new BM({email:new VM,password:new VM})}return Wg(e,[{key:"ngOnInit",value:function(){var e,t=this;this.userSubscription=this.connectedUserService.subscribeToUser((e=aB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n!==k7.NOT_CONNECTED,!e.t0){e.next=4;break}return e.next=4,t.redirect();case 4:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"loginWithEmail",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.connectedUserService.doEmailLogin(e.email,e.password);case 2:(r=n.sent).isFailure()&&(t.errorMessage=r.getReason());case 4:case"end":return n.stop()}},n)}))()}},{key:"loginWithGoogle",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connectedUserService.doGoogleLogin();case 2:(n=t.sent).isFailure()&&(e.errorMessage=n.getReason());case 4:case"end":return t.stop()}},t)}))()}},{key:"redirect",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.router.navigate(["/lobby"]));case 1:case"end":return t.stop()}},t)}))()}},{key:"canLogin",value:function(){var e,t;return!(""===(null!==(e=this.loginForm.value.email)&&void 0!==e?e:"")||""===(null!==(t=this.loginForm.value.password)&&void 0!==t?t:""))}},{key:"ngOnDestroy",value:function(){this.userSubscription.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(jL),Qb(C7))},e.\u0275cmp=Gm({type:e,selectors:[["app-login"]],decls:49,vars:8,consts:function(){return[[1,"box"],[1,"title"],$localize(Yh||(Yh=_g(["Log in"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(Kh||(Kh=_g(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",$localize(Qh||(Qh=_g(["Email"]))),"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],$localize(Xh||(Xh=_g(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",$localize(Jh||(Jh=_g(["Password"]))),"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(ed||(ed=_g(["Log in"]))),["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(td||(td=_g(["Log in with Google"]))),["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],$localize(nd||(nd=_g(["No account?"]))),[3,"routerLink"],$localize(rd||(rd=_g(["Register"]))),$localize(id||(id=_g(["Forgot your password?"]))),$localize(ad||(ad=_g(["Reset your password"]))),["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(od||(od=_g(["Connection error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(eP(0,"div",0),eP(1,"p",1),ZS(2,2),tP(),eP(3,"form",3),eP(4,"div",4),eP(5,"div",5),eP(6,"label",6),ZS(7,7),tP(),tP(),eP(8,"div",8),eP(9,"div",9),eP(10,"div",10),nP(11,"input",11),tP(),tP(),tP(),tP(),eP(12,"div",4),eP(13,"div",5),eP(14,"label",12),ZS(15,13),tP(),tP(),eP(16,"div",8),eP(17,"div",9),eP(18,"div",14),nP(19,"input",15),eP(20,"span",16),nP(21,"fa-icon",17),tP(),tP(),tP(),tP(),tP(),eP(22,"div",4),nP(23,"div",5),eP(24,"div",8),eP(25,"div",9),eP(26,"div",10),eP(27,"button",18),uP("click",function(){return t.loginWithEmail(t.loginForm.value)}),ZS(28,19),tP(),tP(),tP(),tP(),tP(),eP(29,"div",4),nP(30,"div",5),eP(31,"div",8),eP(32,"div",9),eP(33,"div",10),eP(34,"button",20),uP("click",function(){return t.loginWithGoogle()}),ZS(35,21),tP(),tP(),tP(),tP(),tP(),Yb(36,Jde,5,1,"div",22),eP(37,"p",23),rP(38),ZS(39,24),iP(),FP(40,"\xa0 "),eP(41,"a",25),ZS(42,26),tP(),tP(),eP(43,"p",23),rP(44),ZS(45,27),iP(),FP(46,"\xa0 "),eP(47,"a",25),ZS(48,28),tP(),tP(),tP(),tP()),2&e&&(pE(3),Xb("formGroup",t.loginForm),pE(18),Xb("icon",t.faEye),pE(6),Xb("disabled",!t.canLogin()),pE(9),Xb("ngIf",t.errorMessage),pE(5),Xb("routerLink",aT(6,eve)),pE(6),Xb("routerLink",aT(7,tve)))},directives:[jM,gM,ex,VR,pM,nx,Qde,hx,Eee,Xde,UA,QL],encapsulation:2}),e}(),rve=function(){var e=function(){function e(t){Zg(this,e),this.userDAO=t}return Wg(e,[{key:"subscribeToActiveUsers",value:function(t){var n=this;sB(e.VERBOSE,"ActiveUsersService.subscribeToActiveUsers");var r=[],i=new F7(function(i){var a;sB(e.VERBOSE,"our DAO gave us "+i.length+" new user(s)"),r=n.sort((a=r).concat.apply(a,Bg(i))),t(r)},function(i){var a=r;sB(e.VERBOSE,"our DAO updated "+i.length+" user(s)");var o,s=Hg(i);try{var u=function(){var e=o.value;a.forEach(function(t){t.id===e.id&&(t.data=e.data)}),a=n.sort(a)};for(s.s();!(o=s.n()).done;)u()}catch(c){s.e(c)}finally{s.f()}t(r=a)},function(e){r=r.filter(function(t){return!e.some(function(e){return e.id===t.id})}),t(r)});return this.userDAO.observingWhere([["state","==","online"],["verified","==",!0]],i)}},{key:"sort",value:function(e){return e.sort(function(e,t){var n=oB.getNonNullable(e.data).lastUpdateTime,r=oB.getNonNullable(n).seconds,i=oB.getNonNullable(t.data).lastUpdateTime;return r-oB.getNonNullable(i).seconds})}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(pw(p7))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ive=function(){var e=function(){function e(t){Zg(this,e),this.partDAO=t}return Wg(e,[{key:"subscribeToActiveParts",value:function(e){var t=[],n=new F7(function(n){var r;t=(r=t).concat.apply(r,Bg(n)),e(t)},function(n){var r,i=t,a=Hg(n);try{var o=function(){var e=r.value;i.forEach(function(t){t.id===e.id&&(t.data=e.data)})};for(a.s();!(r=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}e(t=i)},function(n){var r,i=[],a=Hg(t);try{var o=function(){var e=r.value;n.some(function(t){return t.id===e.id})||i.push(e)};for(a.s();!(r=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}e(t=i)});return this.partDAO.observingWhere([["result","==",w7.UNACHIEVED.value]],n)}},{key:"userHasActivePart",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.partDAO.findWhere([["playerZero","==",e],["result","==",w7.UNACHIEVED.value]]);case 2:return r=n.sent,n.next=5,t.partDAO.findWhere([["playerOne","==",e],["result","==",w7.UNACHIEVED.value]]);case 5:return i=n.sent,n.abrupt("return",r.length>0||i.length>0);case 7:case"end":return n.stop()}},n)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(L7))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"any"}),e}(),ave=function(){var e=function(){function e(t){Zg(this,e),this.router=t}return Wg(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"navigateToOnlineGameCreation",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/play",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(jL))},e.\u0275cmp=Gm({type:e,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playOnline",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(sd||(sd=_g(["Create an online game"])))]},template:function(e,t){1&e&&(eP(0,"app-pick-game",0),uP("pickGame",function(e){return t.pickGame(e)}),tP(),eP(1,"button",1),uP("click",function(){return t.navigateToOnlineGameCreation()}),ZS(2,2),tP()),2&e&&(pE(1),Xb("disabled",!t.selectedGame))},directives:[qde],encapsulation:2}),e}(),ove=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"transform",value:function(e){return pA(1e3*e.seconds,"HH:mm:ss","en-US")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=Km({name:"firebaseDate",type:e,pure:!0}),e}(),sve=["chatDiv"];function uve(e,t){1&e&&(rP(0),ZS(1,5),iP())}function cve(e,t){1&e&&ZS(0,6),2&e&&(qS(fP().unreadMessagesText),WS(0))}function lve(e,t){if(1&e){var n=aP();eP(0,"button",11),uP("click",function(){return Nk(n),fP(2).scrollToBottom()}),FP(1),tP()}if(2&e){var r=fP(2);pE(1),VP("",r.unreadMessagesText," \u2193")}}function fve(e,t){if(1&e&&(eP(0,"p"),FP(1),fT(2,"firebaseDate"),eP(3,"b",12),FP(4),tP(),eP(5,"span",13),FP(6),tP(),tP()),2&e){var n=t.$implicit;pE(1),VP(" [",hT(2,3,n.postedTime),"] "),pE(3),VP("",n.sender.name," : "),pE(2),UP(n.content)}}function hve(e,t){if(1&e){var n=aP();eP(0,"div"),Yb(1,lve,2,1,"button",7),eP(2,"div",8,9),uP("scroll",function(){return Nk(n),fP().updateCurrentScrollPosition()}),Yb(4,fve,7,5,"p",10),tP(),tP()}if(2&e){var r=fP();pE(1),Xb("ngIf",r.showUnreadMessagesButton),pE(3),Xb("ngForOf",r.chat)}}var dve=function(){return{standalone:!0}};function vve(e,t){if(1&e){var n=aP();eP(0,"form",14),uP("onSubmit",function(){return Nk(n),fP().sendMessage()}),eP(1,"div",15),eP(2,"div",16),eP(3,"input",17,18),uP("ngModelChange",function(e){return Nk(n),fP().userMessage=e}),tP(),eP(5,"p",19),FP(6),tP(),tP(),eP(7,"div",20),eP(8,"button",21),uP("click",function(){return Nk(n),fP().sendMessage()}),nP(9,"fa-icon",22),tP(),tP(),tP(),eP(10,"div",23),eP(11,"p"),eP(12,"strong"),ZS(13,24),tP(),tP(),tP(),tP()}if(2&e){var r=Kb(4),i=fP();pE(3),Xb("ngModel",i.userMessage)("ngModelOptions",aT(4,dve)),pE(3),VP("",r.value.length,"/128"),pE(3),Xb("icon",i.faReply)}}var pve=function(){var e=function(){function e(t,n){Zg(this,e),this.chatService=t,this.connectedUserService=n,this.userMessage="",this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=X7,this.isNearBottom=!0,this.notYetScrolled=!0,sB(e.VERBOSE,"ChatComponent constructor")}return Wg(e,[{key:"ngOnInit",value:function(){sB(e.VERBOSE,"ChatComponent.ngOnInit for chat ".concat(this.chatId)),v7(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}},{key:"ngAfterViewChecked",value:function(){this.scrollToBottomIfNeeded()}},{key:"loadChatContent",value:function(){var e=this,t=function(t){e.updateMessages(t.flatMap(function(e){return null==e.data.postedTime?[]:[e.data]}))},n=new F7(t,t,function(){});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,n)}},{key:"updateMessages",value:function(e){this.chat=this.chat.concat(e);var t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}},{key:"updateUnreadMessagesText",value:function(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize(ud||(ud=_g(["no new message"]))),this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize(cd||(cd=_g(["1 new message"]))):$localize(ld||(ld=_g([""," new messages"])),e)}},{key:"scrollToBottomIfNeeded",value:function(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}},{key:"updateCurrentScrollPosition",value:function(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}},{key:"scrollToBottom",value:function(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}},{key:"scrollTo",value:function(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}},{key:"sendMessage",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.userMessage,e.userMessage="",r=e.connectedUserService.user.get().toMinimalUser(),t.next=5,e.chatService.sendMessage(e.chatId,r,n,e.turn);case 5:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.chatSubscription.unsubscribe()}},{key:"switchChatVisibility",value:function(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Qb(c7),Qb(C7))},e.\u0275cmp=Gm({type:e,selectors:[["app-chat"]],viewQuery:function(e,t){var n;(1&e&&IT(sve,5),2&e)&&(TT(n=AT())&&(t.chatDiv=n.first))},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){return[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],$localize(fd||(fd=_g(["Hide chat"]))),$localize(hd||(hd=_g(["Show chat (",":INTERPOLATION:)"])),"\ufffd0\ufffd"),["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",$localize(dd||(dd=_g(["Type your message here"]))),"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],$localize(vd||(vd=_g(["Be polite"])))]},template:function(e,t){if(1&e&&(eP(0,"div"),eP(1,"button",0),uP("click",function(){return t.switchChatVisibility()}),Yb(2,uve,2,0,"ng-container",1),Yb(3,cve,1,1,"ng-template",null,2,MT),tP(),Yb(5,hve,5,2,"div",3),Yb(6,vve,14,5,"form",4),tP()),2&e){var n=Kb(4);pE(2),Xb("ngIf",t.visible)("ngIfElse",n),pE(3),Xb("ngIf",t.visible),pE(1),Xb("ngIf",t.visible)}},directives:[UA,LA,jM,gM,$M,VR,vx,pM,WM,Eee],pipes:[ove],encapsulation:2}),e}();function gve(e,t){if(1&e&&(rP(0),FP(1),iP()),2&e){var n=fP().$implicit;pE(1),UP(n.data.playerOne.name)}}function yve(e,t){1&e&&(rP(0),ZS(1,26),iP())}function mve(e,t){if(1&e){var n=aP();eP(0,"tr",22),uP("click",function(){var e=Nk(n).$implicit;return fP(2).joinGame(e.id,e.data.typeGame)}),eP(1,"td",23),FP(2),tP(),eP(3,"td",23),FP(4),tP(),eP(5,"td",23),Yb(6,gve,2,1,"ng-container",24),Yb(7,yve,2,0,"ng-template",null,25,MT),tP(),eP(9,"td",23),FP(10),tP(),tP()}if(2&e){var r=t.$implicit,i=t.index,a=Kb(8);dP("id","part_",i,""),pE(2),UP(r.data.typeGame),pE(2),UP(r.data.playerZero.name),pE(2),Xb("ngIf",r.data.playerOne)("ngIfElse",a),pE(4),UP(r.data.turn)}}function kve(e,t){if(1&e&&(eP(0,"div",13),eP(1,"div",14),eP(2,"table",15),eP(3,"thead"),eP(4,"tr"),eP(5,"th",16),ZS(6,17),tP(),eP(7,"th",16),ZS(8,18),tP(),eP(9,"th",16),ZS(10,19),tP(),eP(11,"th",16),ZS(12,20),tP(),tP(),tP(),eP(13,"tbody"),Yb(14,mve,11,6,"tr",21),tP(),tP(),tP(),tP()),2&e){var n=fP();pE(14),Xb("ngForOf",n.activeParts)}}function Cve(e,t){1&e&&(eP(0,"div",27),nP(1,"app-online-game-selection",28),tP())}function wve(e,t){if(1&e&&(eP(0,"li",39),FP(1),fT(2,"firebaseDate"),tP()),2&e){var n=fP().$implicit;hP("id",n.data.username),pE(1),BP("",n.data.username,": ",hT(2,3,n.data.lastUpdateTime),"")}}function _ve(e,t){if(1&e&&(rP(0),Yb(1,wve,3,5,"li",38),iP()),2&e){var n=t.$implicit;pE(1),Xb("ngIf",n.data.lastUpdateTime)}}function Eve(e,t){if(1&e&&(eP(0,"div",29),eP(1,"div",30),eP(2,"div",31),nP(3,"app-chat",32),tP(),tP(),eP(4,"div",33),eP(5,"div",34),eP(6,"p"),ZS(7,35),tP(),eP(8,"ul",36),Yb(9,_ve,2,1,"ng-container",37),tP(),tP(),tP(),tP()),2&e){var n=fP();pE(3),Xb("turn",-1),pE(6),Xb("ngForOf",n.activeUsers)}}var bve=function(){var e=function(){function e(t,n,r){Zg(this,e),this.router=t,this.activeUsersService=n,this.activePartsService=r,this.activeUsers=[],this.activeParts=[],this.currentTab="games"}return Wg(e,[{key:"ngOnInit",value:function(){var t=this;sB(e.VERBOSE,"lobbyComponent.ngOnInit"),this.activeUsersSubscription=this.activeUsersService.subscribeToActiveUsers(function(e){t.activeUsers=e}),this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(function(e){t.activeParts=e})}},{key:"ngOnDestroy",value:function(){sB(e.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activeUsersSubscription.unsubscribe(),this.activePartsSubscription.unsubscribe()}},{key:"joinGame",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.router.navigate(["/play",t,e]);case 2:case"end":return r.stop()}},r)}))()}},{key:"selectTab",value:function(e){this.currentTab=e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Qb(jL),Qb(rve),Qb(ive))},e.\u0275cmp=Gm({type:e,selectors:[["app-lobby"]],decls:14,vars:3,consts:function(){return[[1,"tabs","is-centered"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],$localize(pd||(pd=_g(["Games"]))),["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"click"],$localize(gd||(gd=_g(["Create"]))),["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],$localize(yd||(yd=_g(["Chat"]))),["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(md||(md=_g(["Game"]))),$localize(kd||(kd=_g(["First player"]))),$localize(Cd||(Cd=_g(["Second player"]))),$localize(wd||(wd=_g(["Turn"]))),[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],$localize(_d||(_d=_g(["Waiting for opponent"]))),["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],["id","chatContainerDiv",1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"],[1,"column","is-3","is-hidden"],["id","onlineUsers",1,"box"],$localize(Ed||(Ed=_g(["Connected users:"]))),["id","activeUsersList"],[4,"ngFor","ngForOf"],[3,"id",4,"ngIf"],[3,"id"]]},template:function(e,t){1&e&&(eP(0,"div",0),eP(1,"ul"),eP(2,"li",1),eP(3,"a",2),uP("click",function(){return t.selectTab("games")}),ZS(4,3),tP(),tP(),eP(5,"li",4),eP(6,"a",5),uP("click",function(){return t.selectTab("create")}),ZS(7,6),tP(),tP(),eP(8,"li",7),eP(9,"a",8),uP("click",function(){return t.selectTab("chat")}),ZS(10,9),tP(),tP(),tP(),tP(),Yb(11,kve,15,1,"div",10),Yb(12,Cve,2,0,"div",11),Yb(13,Eve,10,2,"div",12)),2&e&&(pE(11),Xb("ngIf","games"===t.currentTab),pE(1),Xb("ngIf","create"===t.currentTab),pE(1),Xb("ngIf","chat"===t.currentTab))},directives:[NA,UA,LA,ave,pve],pipes:[ove],encapsulation:2}),e}(),Pve=function(){var e=Wg(function e(t){var n;Zg(this,e),this.route=t,this.message=null!==(n=t.snapshot.paramMap.get("message"))&&void 0!==n?n:$localize(bd||(bd=_g(["This page does not exist."])))});return e.\u0275fac=function(t){return new(t||e)(Qb(OD))},e.\u0275cmp=Gm({type:e,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){return[[1,"message","is-danger"],[1,"message-header"],$localize(Pd||(Pd=_g(["Not found"]))),[1,"message-body"]]},template:function(e,t){1&e&&(eP(0,"div",0),eP(1,"div",1),ZS(2,2),tP(),eP(3,"div",3),FP(4),tP(),tP()),2&e&&(pE(4),UP(t.message))},encapsulation:2}),e}();function Sve(e,t){}var Ove=function(){var e=Wg(function e(t){Zg(this,e),this.viewContainerRef=t,sB(e.VERBOSE,"GameIncluderComponent constructor")});return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Qb(ZO))},e.\u0275cmp=Gm({type:e,selectors:[["app-game-includer"]],decls:1,vars:0,template:function(e,t){1&e&&Yb(0,Sve,0,0,"ng-template")},encapsulation:2}),e}(),Tve=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"NO_MATCHING_GAME",value:function(e){return $localize(Sd||(Sd=_g(["This game (",") does not exist."])),e)}}]),e}();return e.NOT_YOUR_TURN=function(){return $localize(Od||(Od=_g(["It is not your turn!"])))},e.NO_CLONING_FEATURE=function(){return $localize(Td||(Td=_g(["You cannot clone a game. This feature might be implemented later."])))},e}(),Ive=function(){var e=function(){function e(t,n,r,i,a){Zg(this,e),this.componentFactoryResolver=t,this.actRoute=n,this.connectedUserService=r,this.router=i,this.messageDisplayer=a,this.players=[fB.empty(),fB.empty()],this.observerRole=A7.NONE,this.endGame=!1,this.Player=R7,sB(e.VERBOSE,"GameWrapper.constructed: "+(null!=this.gameIncluder))}return Wg(e,[{key:"getMatchingComponent",value:function(t){return sB(e.VERBOSE,"GameWrapper.getMatchingComponent"),fB.ofNullable(Zde.ALL_GAMES().find(function(e){return e.urlName===t})).map(function(e){return e.component})}},{key:"afterGameIncluderViewInit",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return sB(e.VERBOSE,"GameWrapper.afterGameIncluderViewInit"),n.next=3,t.createGameComponent();case 3:return r=n.sent,n.abrupt("return",(r&&t.gameComponent.rules.setInitialBoard(),r));case 5:case"end":return n.stop()}},n)}))()}},{key:"createGameComponent",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(sB(e.VERBOSE,"GameWrapper.createGameComponent"),r=oB.getNonNullable(t.actRoute.snapshot.paramMap.get("compo")),!(i=t.getMatchingComponent(r)).isAbsent()){n.next=6;break}return n.next=5,t.router.navigate(["/notFound",Tve.NO_MATCHING_GAME(r)],{skipLocationChange:!0});case 5:return n.abrupt("return",!1);case 6:return v7(null!=t.gameIncluder,"GameIncluder should be present"),a=t.componentFactoryResolver.resolveComponentFactory(i.get()),o=t.gameIncluder.viewContainerRef.createComponent(a),n.abrupt("return",(t.gameComponent=o.instance,t.gameComponent.chooseMove=function(e,n,r){return t.receiveValidMove(e,n,r)},t.gameComponent.canUserPlay=function(e){return t.onUserClick(e)},t.gameComponent.isPlayerTurn=function(){return t.isPlayerTurn()},t.gameComponent.cancelMoveOnWrapper=function(e){t.onCancelMove(e)},t.canPass=t.gameComponent.canPass,!0));case 9:case"end":return n.stop()}},n)}))()}},{key:"receiveValidMove",value:function(t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(sB(e.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:t,state:n,scores:r}}),i.isPlayerTurn()){a.next=2;break}return a.abrupt("return",pB.failure(Tve.NOT_YOUR_TURN()));case 2:if(!i.endGame){a.next=4;break}return a.abrupt("return",pB.failure($localize(Id||(Id=_g(["The game has ended."])))));case 4:if(!(o=i.gameComponent.rules.isLegal(t,n)).isFailure()){a.next=9;break}a.t0=(i.gameComponent.cancelMove(o.getReason()),pB.ofFallible(o)),a.next=14;break;case 9:return i.gameComponent.cancelMoveAttempt(),a.next=12,i.onLegalUserMove(t,r);case 12:sB(e.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),a.t0=pB.SUCCESS;case 14:return a.abrupt("return",a.t0);case 15:case"end":return a.stop()}},a)}))()}},{key:"onUserClick",value:function(e){if(this.observerRole===A7.NONE){var t=Tve.NO_CLONING_FEATURE();return pB.failure(t)}return this.isPlayerTurn()?pB.SUCCESS:pB.failure(Tve.NOT_YOUR_TURN())}},{key:"onCancelMove",value:function(e){}},{key:"isPlayerTurn",value:function(){if(this.observerRole===A7.NONE||null==this.gameComponent)return!1;var t=this.gameComponent.rules.node.gameState.turn,n=t%2,r=this.getPlayer();return sB(e.VERBOSE,{isPlayerTurn:{turn:t,players:this.players,player:r,observer:this.observerRole,areYouPlayer:this.players[n].isPresent()&&lB(this.players[n].get(),r),isThereAPlayer:this.players[n]}}),!this.players[n].isPresent()||this.players[n].equalsValue(r)}},{key:"getBoardHighlight",value:function(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.rules.node.gameState.turn%2+"-bg"]:[]}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Qb(iO),Qb(OD),Qb(C7),Qb(jL),Qb(h7))},e.\u0275cmp=Gm({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var n;(1&e&&IT(Ove,5),2&e)&&(TT(n=AT())&&(t.gameIncluder=n.first))},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),Ave=function(){function e(t,n,r){Zg(this,e),this.added=t,this.modified=n,this.removed=r}return Wg(e,[{key:"addNewKeys",value:function(e,t){var n,r=Hg(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;null!=t[i]&&(this.added[i]=t[i])}}catch(a){r.e(a)}finally{r.f()}}},{key:"addCommonKeys",value:function(e,t,n){var r,i=Hg(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.addCommonKey(a,n[a],t[a])}}catch(o){i.e(o)}finally{i.f()}}},{key:"addCommonKey",value:function(t,n,r){if(null==r)null!=n&&(this.removed[t]=n);else if(null==n)this.added[t]=r;else if(["string","boolean","number"].includes(typeof n))n!==r&&(this.modified[t]=r);else if(Array.isArray(n)){if(!Array.isArray(r))throw new Error("Thing should not change type");n.length===r.length?this.addCommonKeyList(t,n,r):this.modified[t]=r}else{v7("object"==typeof n,"ObjectDifference: expected JSON, but got a ".concat(typeof n," in ").concat(t)),v7("object"==typeof r,"ObjectDifference: expected JSON, but got a ".concat(typeof r," in ").concat(t));var i=e.from(n,r);i.countChanges()>0&&(this.modified[t]=i)}}},{key:"addCommonKeyList",value:function(t,n,r){for(var i=!0,a=0;i&&a<n.length;a++)typeof n[a]==typeof r[a]&&"object"==typeof n[a]?e.differs(n[a],r[a])&&(i=!1,this.modified[t]=r):n[a]!==r[a]&&(i=!1,this.modified[t]=r)}},{key:"addRemovedKeys",value:function(e,t){var n,r=Hg(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.removed[i]=t[i]}}catch(a){r.e(a)}finally{r.f()}}},{key:"countChanges",value:function(){var e=Object.keys(this.removed).length,t=Object.keys(this.modified).length;return Object.keys(this.added).length+t+e}},{key:"isPresent",value:function(e){return null!=this.added[e]?{state:"added",present:!0}:null!=this.modified[e]?{state:"modified",present:!0}:null!=this.removed[e]?{state:"removed",present:!0}:{state:null,present:!1}}}],[{key:"from",value:function(t,n){var r=new e({},{},{});if(null==t)return r.added=bg({},n),r;if(null==n)return r.removed=bg({},t),r;var i=Object.keys(t),a=Object.keys(n),o=i.filter(function(e){return!1===a.includes(e)}),s=i.filter(function(e){return a.includes(e)}),u=a.filter(function(e){return!1===i.includes(e)});return r.addNewKeys(u,n),r.addCommonKeys(s,n,t),r.addRemovedKeys(o,t),r}},{key:"differs",value:function(t,n){return e.from(t,n).countChanges()>0}}]),e}();function Rve(e){return 1e3*e.seconds+e.nanoseconds/1e6}function Mve(e,t){return Rve(t)-Rve(e)}function xve(e){return Ey(function(t,n){Vy(e).subscribe(new by(n,function(){return n.complete()},iy)),!n.closed&&t.subscribe(n)})}var Nve=function(){var e=function(){function e(){Zg(this,e)}return Wg(e,[{key:"transform",value:function(e){var t=e%60,n=(e-t)%3600/60,r=(e-60*n-t)/3600,i=[];if(r>1?i.push($localize(Ad||(Ad=_g([""," hours"])),r)):1===r&&i.push($localize(Rd||(Rd=_g(["1 hour"])))),n>1?i.push($localize(Md||(Md=_g([""," minutes"])),n)):1===n&&i.push($localize(xd||(xd=_g(["1 minute"])))),t>1?i.push($localize(Nd||(Nd=_g([""," seconds"])),t)):1===t&&i.push($localize(Dd||(Dd=_g(["1 second"])))),0===i.length)return $localize(Ld||(Ld=_g(["0 seconds"])));if(1===i.length)return i[0];var a=i.slice(0,-1).join(", "),o=i.slice(-1)[0];return $localize(Fd||(Fd=_g([""," and ",""])),a,o)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=Km({name:"humanDuration",type:e,pure:!0}),e}();function Dve(e,t){if(1&e&&(rP(0),FP(1),iP()),2&e){var n=fP(3);pE(1),UP(n.viewInfo.chosenOpponent)}}function Lve(e,t){1&e&&ZS(0,44)}function Fve(e,t){if(1&e&&(eP(0,"div",45),eP(1,"div",8),eP(2,"label",46),rP(3),ZS(4,47),iP(),eP(5,"output"),FP(6),fT(7,"humanDuration"),tP(),tP(),eP(8,"div",37),nP(9,"input",48),tP(),tP(),eP(10,"div",8),eP(11,"label",49),GS(12,50),nP(13,"output"),fT(14,"humanDuration"),$S(),tP(),eP(15,"div",37),nP(16,"input",51),tP(),tP(),tP()),2&e){var n=fP(3);pE(6),UP(hT(7,2,n.viewInfo.maximalMoveDuration||0)),pE(8),qS(hT(14,4,n.viewInfo.totalPartDuration||0)),WS(12)}}function Uve(e,t){1&e&&(eP(0,"div"),GS(1,52),nP(2,"br"),$S(),tP())}function Vve(e,t){1&e&&(eP(0,"button",64),ZS(1,65),tP())}function Bve(e,t){if(1&e){var n=aP();eP(0,"tr",60),uP("click",function(){var e=Nk(n).$implicit;return fP(4).selectOpponent(e)}),eP(1,"td",61),FP(2),tP(),eP(3,"td",62),Yb(4,Vve,2,0,"button",63),tP(),tP()}if(2&e){var r=t.$implicit,i=fP(4);dP("id","presenceOf_",r,""),Xb("ngClass",i.viewInfo.candidateClasses[r]),pE(1),Xb("id",i.viewInfo.chosenOpponent===r?"selected_"+r:"candidate_"+r),pE(1),UP(r),pE(2),Xb("ngIf",i.viewInfo.chosenOpponent!==r)}}function zve(e,t){if(1&e&&(rP(0),ZS(1,53),iP(),eP(2,"div",54),eP(3,"table",55),eP(4,"thead"),eP(5,"tr"),eP(6,"th",56),ZS(7,57),tP(),eP(8,"th",56),ZS(9,58),tP(),tP(),tP(),eP(10,"tbody"),Yb(11,Bve,5,5,"tr",59),tP(),tP(),tP()),2&e){var n=fP(3);pE(11),Xb("ngForOf",n.viewInfo.candidates)}}function Hve(e,t){if(1&e){var n=aP();eP(0,"button",66),uP("click",function(){return Nk(n),fP(3).changeConfig()}),ZS(1,67),tP()}}function Gve(e,t){if(1&e){var n=aP();eP(0,"div"),eP(1,"h1",4),ZS(2,5),tP(),eP(3,"form",6),eP(4,"fieldset",7),eP(5,"div",8),eP(6,"label",9),ZS(7,10),tP(),eP(8,"div",11),eP(9,"button",12),uP("click",function(){return Nk(n),fP(2).selectFirstPlayer("RANDOM")}),ZS(10,13),tP(),eP(11,"button",14),uP("click",function(){return Nk(n),fP(2).selectFirstPlayer("CREATOR")}),ZS(12,15),tP(),eP(13,"button",16),uP("click",function(){return Nk(n),fP(2).selectFirstPlayer("CHOSEN_PLAYER")}),Yb(14,Dve,2,1,"ng-container",17),Yb(15,Lve,1,0,"ng-template",null,18,MT),tP(),tP(),tP(),eP(17,"div",8),eP(18,"label",9),ZS(19,19),tP(),eP(20,"div",11),eP(21,"div",20),uP("click",function(){return Nk(n),fP(2).selectPartType("STANDARD")}),eP(22,"div",21),eP(23,"span"),ZS(24,22),tP(),tP(),eP(25,"div",23),eP(26,"div",24),eP(27,"div",25),eP(28,"p"),rP(29),ZS(30,26),iP(),eP(31,"strong"),FP(32),fT(33,"humanDuration"),tP(),nP(34,"br"),rP(35),GS(36,27),nP(37,"strong"),fT(38,"humanDuration"),$S(),iP(),tP(),tP(),tP(),tP(),tP(),eP(39,"div",28),uP("click",function(){return Nk(n),fP(2).selectPartType("BLITZ")}),eP(40,"div",21),eP(41,"span"),ZS(42,29),tP(),tP(),eP(43,"div",23),eP(44,"div",24),eP(45,"div",25),eP(46,"p"),rP(47),ZS(48,30),iP(),eP(49,"strong"),FP(50),fT(51,"humanDuration"),tP(),nP(52,"br"),rP(53),GS(54,31),nP(55,"strong"),fT(56,"humanDuration"),$S(),iP(),tP(),tP(),tP(),tP(),tP(),eP(57,"button",32),uP("click",function(){return Nk(n),fP(2).selectPartType("CUSTOM")}),ZS(58,33),tP(),tP(),tP(),Yb(59,Fve,17,6,"div",34),eP(60,"div",8),eP(61,"label",35),ZS(62,36),tP(),eP(63,"div",37),Yb(64,Uve,3,0,"div",17),Yb(65,zve,12,1,"ng-template",null,38,MT),tP(),tP(),tP(),eP(67,"div",8),eP(68,"div",11),eP(69,"button",39),uP("click",function(){return Nk(n),fP(2).proposeConfig()}),ZS(70,40),tP(),Yb(71,Hve,2,0,"button",41),eP(72,"button",42),uP("click",function(){return Nk(n),fP(2).cancelGameCreation()}),ZS(73,43),tP(),tP(),tP(),tP(),tP()}if(2&e){var r=Kb(16),i=Kb(66),a=fP(2);pE(3),Xb("formGroup",a.configFormGroup),pE(1),Xb("disabled",!a.viewInfo.canEditConfig),pE(5),Xb("ngClass",a.viewInfo.firstPlayerClasses.RANDOM),pE(2),Xb("ngClass",a.viewInfo.firstPlayerClasses.CREATOR),pE(2),Xb("ngClass",a.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),pE(1),Xb("ngIf",a.viewInfo.chosenOpponent)("ngIfElse",r),pE(7),Xb("ngClass",a.viewInfo.partTypeClasses.STANDARD),pE(11),UP(hT(33,19,a.partType.NORMAL_MOVE_DURATION)),pE(6),qS(hT(38,21,a.partType.NORMAL_PART_DURATION)),WS(36),pE(1),Xb("ngClass",a.viewInfo.partTypeClasses.BLITZ),pE(11),UP(hT(51,23,a.partType.BLITZ_MOVE_DURATION)),pE(6),qS(hT(56,25,a.partType.BLITZ_PART_DURATION)),WS(54),pE(1),Xb("ngClass",a.viewInfo.partTypeClasses.CUSTOM),pE(2),Xb("ngIf",a.viewInfo.showCustomTime),pE(5),Xb("ngIf",0===a.viewInfo.candidates.length)("ngIfElse",i),pE(5),Xb("disabled",!a.viewInfo.canProposeConfig),pE(2),Xb("ngIf",a.viewInfo.canReviewConfig)}}function $ve(e,t){if(1&e&&(eP(0,"div",74),eP(1,"p"),GS(2,75),nP(3,"br"),$S(),tP(),tP()),2&e){var n=fP(3);pE(3),qS(n.viewInfo.creator),WS(2)}}function Zve(e,t){if(1&e&&(eP(0,"span"),ZS(1,81),tP()),2&e){var n=fP(4);pE(1),qS(n.viewInfo.creator),WS(1)}}function qve(e,t){1&e&&(eP(0,"span"),ZS(1,82),tP())}function Wve(e,t){1&e&&(eP(0,"span"),ZS(1,83),tP())}function jve(e,t){if(1&e){var n=aP();eP(0,"div",74),eP(1,"p"),ZS(2,76),tP(),eP(3,"ul"),eP(4,"li"),Yb(5,Zve,2,1,"span",2),Yb(6,qve,2,0,"span",2),Yb(7,Wve,2,0,"span",2),tP(),eP(8,"li"),GS(9,77),nP(10,"strong"),fT(11,"humanDuration"),$S(),tP(),eP(12,"li"),GS(13,78),nP(14,"strong"),fT(15,"humanDuration"),$S(),tP(),tP(),eP(16,"button",79),uP("click",function(){return Nk(n),fP(3).acceptConfig()}),ZS(17,80),tP(),tP()}if(2&e){var r=fP(3);pE(2),qS(r.viewInfo.creator)(r.viewInfo.partTypeName),WS(2),pE(3),Xb("ngIf","CREATOR"===r.viewInfo.firstPlayer),pE(1),Xb("ngIf","CHOSEN_PLAYER"===r.viewInfo.firstPlayer),pE(1),Xb("ngIf","RANDOM"===r.viewInfo.firstPlayer),pE(4),qS(hT(11,7,r.viewInfo.maximalMoveDuration||0)),WS(9),pE(4),qS(hT(15,9,r.viewInfo.totalPartDuration||0)),WS(13)}}function Yve(e,t){if(1&e&&(eP(0,"div"),eP(1,"div",68),eP(2,"div",69),eP(3,"p"),ZS(4,70),tP(),tP(),eP(5,"div",71),Yb(6,$ve,4,1,"div",72),Yb(7,jve,18,11,"ng-template",null,73,MT),tP(),tP(),tP()),2&e){var n=Kb(8),r=fP(2);pE(6),Xb("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function Kve(e,t){if(1&e&&(rP(0),ZS(1,86),iP()),2&e){var n=fP(3);pE(1),qS(n.viewInfo.creator),WS(1)}}function Qve(e,t){if(1&e&&ZS(0,87),2&e){var n=fP(3);qS(n.viewInfo.creator)(n.viewInfo.chosenOpponent),WS(0)}}function Xve(e,t){if(1&e&&(eP(0,"div",68),eP(1,"div",69),eP(2,"p"),ZS(3,84),tP(),tP(),eP(4,"div",71),eP(5,"p"),Yb(6,Kve,2,1,"ng-container",17),Yb(7,Qve,1,2,"ng-template",null,85,MT),tP(),tP(),tP()),2&e){var n=Kb(8),r=fP(2);pE(6),Xb("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function Jve(e,t){if(1&e&&(eP(0,"div",1),Yb(1,Gve,74,27,"div",2),Yb(2,Yve,9,2,"div",2),Yb(3,Xve,9,2,"div",3),tP()),2&e){var n=fP();pE(1),Xb("ngIf",n.viewInfo.userIsCreator),pE(1),Xb("ngIf",n.viewInfo.userIsChosenOpponent),pE(1),Xb("ngIf",n.viewInfo.userIsObserver)}}var epe=function(){function e(t,n,r,i,a,o,s,u){Zg(this,e),this.router=t,this.connectedUserService=n,this.gameService=r,this.configRoomService=i,this.chatService=a,this.userService=o,this.formBuilder=s,this.messageDisplayer=u,this.partType=b7,this.gameStartNotification=new gT,this.gameStarted=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentConfigRoom=null,this.candidates=[],this.ngUnsubscribe=new Cy,this.allUserInterval=fB.empty(),this.ownTokenInterval=fB.empty(),this.selfSubscription=new qg,this.configRoomSubscription=new qg,this.candidatesSubscription=new qg,this.allDocDeleted=!1,sB(e.VERBOSE,"PartCreationComponent constructed")}return Wg(e,[{key:"ngOnInit",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return sB(e.VERBOSE,"PartCreationComponent.ngOnInit"),t.checkInputs(),t.createForms(),n.next=3,t.configRoomService.joinGame(t.partId);case 3:if(!(r=n.sent).isFailure()){n.next=9;break}i=r.getReason(),t.messageDisplayer.criticalMessage(i),n.next=16;break;case 9:return n.next=11,t.updateUserDocWithObservedPart();case 11:return n.next=13,t.startSendingPresenceTokens();case 13:t.subscribeToConfigRoomDoc(),t.subscribeToFormElements(),sB(e.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds");case 16:case"end":return n.stop()}},n)}))()}},{key:"checkInputs",value:function(){var e=this.connectedUserService.user;v7(e.isPresent()&&e.get()!==k7.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),v7(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}},{key:"createForms",value:function(){this.configFormGroup=this.formBuilder.group({firstPlayer:[E7.RANDOM.value,ZR.required],maximalMoveDuration:[b7.NORMAL_MOVE_DURATION,ZR.required],partType:["STANDARD",ZR.required],totalPartDuration:[b7.NORMAL_PART_DURATION,ZR.required],chosenOpponent:["",ZR.required]})}},{key:"updateUserDocWithObservedPart",value:function(){return sB(e.VERBOSE,"updateUserDocWithObservedPart of '"+this.partId+"'"),this.connectedUserService.updateObservedPart(this.partId)}},{key:"subscribeToConfigRoomDoc",value:function(){var e,t=this,n=(e=aB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onCurrentConfigRoomUpdate(n);case 2:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}),r=function(){var e=aB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onCandidatesUpdate(n);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,n),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,r)}},{key:"getForm",value:function(e){return oB.getNonNullable(this.configFormGroup.get(e))}},{key:"subscribeToFormElements",value:function(){var e=this;this.getForm("chosenOpponent").valueChanges.pipe(xve(this.ngUnsubscribe)).subscribe(function(t){void 0!==e.viewInfo.chosenOpponent&&(e.viewInfo.candidateClasses[e.viewInfo.chosenOpponent]=[]),e.viewInfo.candidateClasses[t]=["is-selected"],e.viewInfo.chosenOpponent=t;var n=oB.getNonNullable(e.currentConfigRoom).partStatus;e.viewInfo.canProposeConfig=n!==P7.CONFIG_PROPOSED.value&&""!==t}),this.getForm("partType").valueChanges.pipe(xve(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.partTypeClasses[e.viewInfo.partType]=[],e.viewInfo.partTypeClasses[t]=["is-primary","is-selected"],e.viewInfo.partType=t,e.viewInfo.showCustomTime="CUSTOM"===t}),this.getForm("maximalMoveDuration").valueChanges.pipe(xve(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.maximalMoveDuration=t}),this.getForm("totalPartDuration").valueChanges.pipe(xve(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.totalPartDuration=t}),this.getForm("firstPlayer").valueChanges.pipe(xve(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.firstPlayerClasses[e.viewInfo.firstPlayer]=[],e.viewInfo.firstPlayerClasses[t]=["is-primary","is-selected"],e.viewInfo.firstPlayer=t})}},{key:"updateViewInfo",value:function(){var e,t,n=oB.getNonNullable(this.currentConfigRoom),r=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=n.partStatus===P7.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=n.partStatus!==P7.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=r.id===n.creator.id,this.viewInfo.userIsChosenOpponent=r.id===(null===(e=n.chosenOpponent)||void 0===e?void 0:e.id),this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=n.partStatus!==P7.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=n.creator.name,this.viewInfo.candidates=this.candidates.map(function(e){return e.name}),r.id===n.creator.id?this.setDataForCreator(n):(this.viewInfo.maximalMoveDuration=n.maximalMoveDuration,this.viewInfo.totalPartDuration=n.totalPartDuration,this.viewInfo.partType=n.partType,this.viewInfo.chosenOpponent=null===(t=n.chosenOpponent)||void 0===t?void 0:t.name,this.viewInfo.firstPlayer=n.firstPlayer),n.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize(Ud||(Ud=_g(["custom"])));break;case"BLITZ":this.viewInfo.partTypeName=$localize(Vd||(Vd=_g(["blitz"])));break;case"STANDARD":this.viewInfo.partTypeName=$localize(Bd||(Bd=_g(["standard"])))}}},{key:"setDataForCreator",value:function(e){var t,n,r,i;this.viewInfo.maximalMoveDuration=null!==(t=this.viewInfo.maximalMoveDuration)&&void 0!==t?t:e.maximalMoveDuration,this.viewInfo.totalPartDuration=null!==(n=this.viewInfo.totalPartDuration)&&void 0!==n?n:e.totalPartDuration;var a=this.viewInfo.chosenOpponent;null==a||""===a?a=null!==(r=null===(i=e.chosenOpponent)||void 0===i?void 0:i.name)&&void 0!==r?r:"":!1===this.candidates.some(function(e){return e.name===a})&&(a=""),this.getForm("chosenOpponent").setValue(a)}},{key:"selectFirstPlayer",value:function(e){this.getForm("firstPlayer").setValue(e)}},{key:"selectPartType",value:function(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(b7.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(b7.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(b7.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(b7.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}},{key:"selectOpponent",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,"PartCreationComponent.setChosenOpponent("+t+")"),i=n.getUserFromName(t),r.abrupt("return",n.configRoomService.setChosenOpponent(n.partId,i));case 3:case"end":return r.stop()}},r)}))()}},{key:"getUserFromName",value:function(e){var t=this.candidates.find(function(t){return t.name===e});return oB.getNonNullable(t)}},{key:"changeConfig",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.configRoomService.reviewConfig(e.partId));case 1:case"end":return t.stop()}},t)}))()}},{key:"proposeConfig",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getForm("chosenOpponent").value,r=e.getForm("partType").value,i=e.getForm("maximalMoveDuration").value,a=e.getForm("firstPlayer").value,o=e.getForm("totalPartDuration").value,s=e.getUserFromName(n),t.abrupt("return",e.configRoomService.proposeConfig(e.partId,s,b7.of(r),i,E7.of(a),o));case 2:case"end":return t.stop()}},t)}))()}},{key:"cancelGameCreation",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.allDocDeleted=!0,n.next=3,t.connectedUserService.removeObservedPart();case 3:return sB(e.VERBOSE,"PartCreationComponent.cancelGameCreation"),n.next=6,t.chatService.deleteChat(t.partId);case 6:return sB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat deleted"),n.next=9,t.gameService.deletePart(t.partId);case 9:return sB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat and part deleted"),n.next=12,t.configRoomService.deleteConfigRoom(t.partId,t.candidates);case 12:sB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat, part, and configRoom deleted");case 13:case"end":return n.stop()}},n)}))()}},{key:"onCurrentConfigRoomUpdate",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(sB(e.VERBOSE,{PartCreationComponent_onCurrentConfigRoomUpdate:{before:JSON.stringify(n.currentConfigRoom),then:JSON.stringify(t)}}),!t.isAbsent()){r.next=2;break}return r.abrupt("return",(sB(e.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: LAST UPDATE : the game is cancelled"),n.onGameCancelled()));case 2:if(n.chosenOpponentJustLeft(t.get())&&(i=oB.getNonNullable(n.currentConfigRoom),a=oB.getNonNullable(i.chosenOpponent).name,n.messageDisplayer.infoMessage($localize(zd||(zd=_g([""," left the game, please pick another opponent."])),a))),n.currentConfigRoom=t.get(),r.t0=n.allUserInterval.isAbsent(),!r.t0){r.next=8;break}return r.next=8,n.observePlayers();case 8:n.updateViewInfo(),n.isGameStarted()&&(sB(e.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: the game has started"),n.onGameStarted());case 10:case"end":return r.stop()}},r)}))()}},{key:"onCandidatesUpdate",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t.candidates=e,t.updateViewInfo();case 1:case"end":return n.stop()}},n)}))()}},{key:"chosenOpponentJustLeft",value:function(e){return null!=this.currentConfigRoom&&null!=this.currentConfigRoom.chosenOpponent&&null==e.chosenOpponent}},{key:"onGameCancelled",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return sB(e.VERBOSE,"PartCreationComponent.onGameCancelled"),t.messageDisplayer.infoMessage($localize(Hd||(Hd=_g(["The game has been canceled!"])))),n.next=4,t.router.navigate(["/lobby"]);case 4:case"end":return n.stop()}},n)}))()}},{key:"isGameStarted",value:function(){return oB.getNonNullable(this.currentConfigRoom).partStatus===P7.PART_STARTED.value}},{key:"onGameStarted",value:function(){var t=oB.getNonNullable(this.currentConfigRoom);sB(e.VERBOSE,{partCreationComponent_onGameStarted:{configRoom:t}}),this.gameStartNotification.emit(t),this.gameStarted=!0,sB(e.VERBOSE,"PartCreationComponent.onGameStarted finished")}},{key:"observePlayers",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:v7(t.allUserInterval.isAbsent(),"Cannot observe players multiple times"),r=t.connectedUserService.user.get().id,t.allUserInterval=fB.of(window.setInterval(aB(regeneratorRuntime.mark(function e(){var n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=oB.getNonNullable(t.currentConfigRoom),i=t.lastToken,r!==n.creator.id){e.next=6;break}return e.next=4,t.checkCandidatesTokensFreshness(i);case 4:e.next=8;break;case 6:return e.next=8,t.checkCreatorTokenFreshness(i);case 8:case"end":return e.stop()}},e)})),e.TOKEN_INTERVAL));case 3:case"end":return n.stop()}},n)}))()}},{key:"checkCreatorTokenFreshness",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=oB.getNonNullable(t.currentConfigRoom),n.next=3,t.didUserTimeout(r.creator.id,e);case 3:if(n.t0=n.sent,!n.t0){n.next=7;break}return n.next=7,t.destroyDocIfPartDidNotStart();case 7:case"end":return n.stop()}},n)}))()}},{key:"destroyDocIfPartDidNotStart",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return v7(0==(oB.getNonNullable(e.currentConfigRoom).partStatus===P7.PART_STARTED.value),"Should not try to cancelGameCreation when part started!"),v7(!1===e.allDocDeleted,"Should not delete doc twice"),t.next=4,e.cancelGameCreation();case 4:case"end":return t.stop()}},t)}))()}},{key:"checkCandidatesTokensFreshness",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=Hg(t.candidates),n.prev=1,r.s();case 3:if((i=r.n()).done){n.next=13;break}return a=i.value,n.next=7,t.didUserTimeout(a.id,e);case 7:if(n.t0=n.sent,!n.t0){n.next=11;break}return n.next=11,t.removeCandidateFromLobby(a);case 11:n.next=3;break;case 13:n.next=18;break;case 15:n.prev=15,n.t1=n.catch(1),r.e(n.t1);case 18:return n.prev=18,r.f(),n.finish(18);case 21:case"end":return n.stop()}},n,null,[[1,15,18,21]])}))()}},{key:"didUserTimeout",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,r.userService.getUserLastUpdateTime(t);case 2:return a=i.sent,i.abrupt("return",a.isAbsent()?(d7.logError("PartCreationComponent","found no user while observing "+t+" !"),!0):Mve(a.get(),n)>e.TOKEN_TIMEOUT);case 4:case"end":return i.stop()}},i)}))()}},{key:"removeCandidateFromLobby",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=oB.getNonNullable(t.currentConfigRoom),n.t0=e.id===(null===(r=i.chosenOpponent)||void 0===r?void 0:r.id),!n.t0){n.next=5;break}return n.next=5,t.configRoomService.reviewConfigAndRemoveChosenOpponent(t.partId);case 5:return n.abrupt("return",t.configRoomService.removeCandidate(t.partId,e));case 6:case"end":return n.stop()}},n)}))()}},{key:"startSendingPresenceTokens",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.connectedUserService.sendPresenceToken();case 2:v7(t.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),t.ownTokenInterval=fB.of(window.setInterval(function(){t.connectedUserService.sendPresenceToken()},e.TOKEN_INTERVAL)),r=t.connectedUserService.user.get().id,t.selfSubscription=t.userService.observeUser(r,function(e){v7(e.isPresent(),"connected user should exist");var n=e.get();null!=n.lastUpdateTime&&(t.lastToken=n.lastUpdateTime)});case 6:case"end":return n.stop()}},n)}))()}},{key:"stopSendingPresenceTokensAndObservingUsersIfNeeded",value:function(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=fB.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}},{key:"acceptConfig",value:function(){return sB(e.VERBOSE,"PartCreationComponent.acceptConfig"),this.gameService.acceptConfig(this.partId,oB.getNonNullable(this.currentConfigRoom))}},{key:"ngOnDestroy",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(sB(e.VERBOSE,"PartCreationComponent.ngOnDestroy"),t.ngUnsubscribe.next(),t.ngUnsubscribe.complete(),t.configRoomSubscription.unsubscribe(),t.candidatesSubscription.unsubscribe(),t.stopSendingPresenceTokensAndObservingUsersIfNeeded(),r=t.connectedUserService.user.get(),n.t0=!0!==t.gameStarted,!n.t0){n.next=23;break}if(null!==t.currentConfigRoom){n.next=8;break}sB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"),n.next=23;break;case 8:if(!0!==t.allDocDeleted){n.next=12;break}sB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: part has already been deleted"),n.next=23;break;case 12:if(r.id!==t.currentConfigRoom.creator.id){n.next=18;break}return sB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),n.next=16,t.cancelGameCreation();case 16:n.next=23;break;case 18:return sB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you are about to cancel game joining"),n.next=21,t.connectedUserService.removeObservedPart();case 21:return n.next=23,t.configRoomService.cancelJoining(t.partId);case 23:case"end":return n.stop()}},n)}))()}}]),e}();function tpe(e,t){if(1&e){var n=aP();eP(0,"button",3),uP("click",function(){return Nk(n),fP().addTime()}),ZS(1,4),tP()}if(2&e){var r=fP();pE(1),qS(r.timeToAdd),WS(1)}}epe.VERBOSE=!1,epe.TOKEN_INTERVAL=5e3,epe.TOKEN_TIMEOUT=2*epe.TOKEN_INTERVAL,epe.\u0275fac=function(e){return new(e||epe)(Qb(jL),Qb(C7),Qb(B7),Qb(V7),Qb(c7),Qb(g7),Qb(mx),Qb(h7))},epe.\u0275cmp=Gm({type:epe,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){return[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],$localize(Gd||(Gd=_g(["Game creation"]))),[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],$localize($d||($d=_g(["First player"]))),[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],$localize(Zd||(Zd=_g(["Random"]))),["id","firstPlayerCreator",1,"button",3,"ngClass","click"],$localize(qd||(qd=_g(["You"]))),["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],$localize(Wd||(Wd=_g(["Game type"]))),["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],$localize(jd||(jd=_g(["Standard"]))),["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],$localize(Yd||(Yd=_g(["Maximal turn duration: "]))),$localize(Kd||(Kd=_g(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#37\ufffd","\ufffd0\ufffd","\ufffd/#37\ufffd"),["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],$localize(Qd||(Qd=_g(["Blitz"]))),$localize(Xd||(Xd=_g(["Maximal turn duration: "]))),$localize(Jd||(Jd=_g(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#55\ufffd","\ufffd0\ufffd","\ufffd/#55\ufffd"),["id","partTypeCustom",1,"button",3,"ngClass","click"],$localize(ev||(ev=_g(["Custom"]))),["id","customTime",4,"ngIf"],[1,"label"],$localize(tv||(tv=_g(["Opponents"]))),[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],$localize(nv||(nv=_g(["Propose configuration"]))),["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],$localize(rv||(rv=_g(["Cancel game"]))),$localize(iv||(iv=_g(["The opponent"]))),["id","customTime"],["for","maximalMoveDuration",1,"label"],$localize(av||(av=_g(["Maximal turn duration: "]))),["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],$localize(ov||(ov=_g(["Maximal game duration: ",":START_TAG_OUTPUT:",":INTERPOLATION: per player",":CLOSE_TAG_OUTPUT:"])),"\ufffd#13\ufffd","\ufffd0\ufffd","\ufffd/#13\ufffd"),["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],$localize(sv||(sv=_g(["Potential opponents that join the game will appear here.",":LINE_BREAK:Wait for an opponent to join, so that you can pick one."])),"\ufffd#2\ufffd\ufffd/#2\ufffd"),$localize(uv||(uv=_g(["Click on the opponent against which you would like to play."]))),["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(cv||(cv=_g(["Name"]))),$localize(lv||(lv=_g(["Actions"]))),[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],$localize(fv||(fv=_g(["Pick"]))),["id","reviewConfig",1,"button",3,"click"],$localize(hv||(hv=_g(["Change configuration"]))),[1,"message","is-primary"],[1,"message-header"],$localize(dv||(dv=_g(["Configuration proposal"]))),[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],$localize(vv||(vv=_g(["You have been selected as the opponent.",":LINE_BREAK: ",":INTERPOLATION: is modifying the configuration."])),"\ufffd#3\ufffd\ufffd/#3\ufffd","\ufffd0\ufffd"),$localize(pv||(pv=_g(["",":INTERPOLATION: proposes to play a ",":INTERPOLATION_1: game"])),"\ufffd0\ufffd","\ufffd1\ufffd"),$localize(gv||(gv=_g(["a turn lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: ",":CLOSE_TAG_STRONG:"])),"\ufffd#10\ufffd","\ufffd0\ufffd","\ufffd/#10\ufffd"),$localize(yv||(yv=_g(["the game lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#14\ufffd","\ufffd0\ufffd","\ufffd/#14\ufffd"),["id","acceptConfig",1,"button","is-primary",3,"click"],$localize(mv||(mv=_g(["Accept and start"]))),$localize(kv||(kv=_g(["",":INTERPOLATION: plays first"])),"\ufffd0\ufffd"),$localize(Cv||(Cv=_g(["you play first"]))),$localize(wv||(wv=_g(["the first player is selected randomly"]))),$localize(_v||(_v=_g(["One moment..."]))),["proposalSent",""],$localize(Ev||(Ev=_g(["",":INTERPOLATION: is configuring the game."])),"\ufffd0\ufffd"),$localize(bv||(bv=_g(["",":INTERPOLATION: has proposed a configuration to ",":INTERPOLATION_1:."])),"\ufffd0\ufffd","\ufffd1\ufffd")]},template:function(e,t){1&e&&Yb(0,Jve,4,3,"div",0),2&e&&Xb("ngIf",t.viewInfo)},directives:[UA,jM,gM,ex,NA,VR,QM,pM,nx,LA],pipes:[Nve],encapsulation:2});var npe=function(){var e=function(){function e(){Zg(this,e),this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new gT,this.addTimeToOpponent=new gT,this.cssClasses=e.SAFE_TIME}return Wg(e,[{key:"ngOnInit",value:function(){sB(e.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}},{key:"setDuration",value:function(t){if(sB(e.VERBOSE,this.debugName+".set("+t+"ms)"),this.started)throw new Error("Should not set a chrono that has already been started ("+this.debugName+")!");this.isSet=!0,this.changeDuration(t)}},{key:"changeDuration",value:function(e){var t=!1;!1===this.isPaused&&(this.pause(),t=!0),this.remainingMs=e,this.displayDuration(),t&&this.resume()}},{key:"displayDuration",value:function(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}},{key:"start",value:function(){if(sB(e.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),!1===this.isSet)throw new Error("Should not start a chrono that has not been set!");if(this.started)throw new Error("Should not start chrono that has already been started ("+this.debugName+")");this.started=!0,this.resume()}},{key:"resume",value:function(){var t=this;if(sB(e.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),!1===this.isPaused||!1===this.started)throw new Error("Should only resume chrono that are started and paused!");this.startTime=Date.now();var n=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(function(){t.onEndReached()},n),this.countSeconds()}},{key:"onEndReached",value:function(){sB(e.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}},{key:"countSeconds",value:function(){var e=this;this.timeoutHandleSec=window.setTimeout(function(){e.updateShownTime()},1e3)}},{key:"isIdle",value:function(){return!1===this.started||this.isPaused}},{key:"pause",value:function(){if(sB(e.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),!this.started)throw new Error("Should not pause not started chrono ("+this.debugName+")");if(this.isPaused)throw new Error("Should not pause already paused chrono ("+this.debugName+")");this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}},{key:"stop",value:function(){if(sB(e.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),!1===this.started)throw new Error("Should only stop chrono that are started!");this.pause(),this.started=!1,this.isSet=!1}},{key:"isStarted",value:function(){return this.started}},{key:"getTimeClass",value:function(){return!1===this.active?e.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?e.DANGER_TIME_ODD:e.DANGER_TIME_EVEN:e.SAFE_TIME}},{key:"updateShownTime",value:function(){var e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}},{key:"clearTimeouts",value:function(){sB(e.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}},{key:"addTime",value:function(){this.addTimeToOpponent.emit()}},{key:"ngOnDestroy",value:function(){this.clearTimeouts()}}]),e}();return e.VERBOSE=!1,e.DANGER_TIME_EVEN="has-background-danger has-text-white",e.DANGER_TIME_ODD="has-background-warning has-text-white",e.PASSIVE_STYLE="has-text-passive is-italic",e.SAFE_TIME="",e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Gm({type:e,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){return[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],$localize(Pv||(Pv=_g(["Add ",":INTERPOLATION:"])),"\ufffd0\ufffd")]},template:function(e,t){1&e&&(eP(0,"div",0),eP(1,"p",1),FP(2),fT(3,"number"),tP(),Yb(4,tpe,2,1,"button",2),tP()),2&e&&(Xb("ngClass",t.getTimeClass()),pE(2),BP("",t.displayedMinute,":",function(e,t,n,r){var i=Mk(),a=Ek(i,23);return vT(i,dT(i,23)?lT(i,Gk(),4,a.transform,n,r,a):a.transform(n,r))}(0,0,t.displayedSec,"2.0-0"),""),pE(2),Xb("ngIf",t.canAddTime))},directives:[NA,UA],pipes:[zA],encapsulation:2}),e}(),rpe=["partCreation"],ipe=["chatComponent"],ape=["chronoZeroGlobal"],ope=["chronoOneGlobal"],spe=["chronoZeroTurn"],upe=["chronoOneTurn"];function cpe(e,t){if(1&e){var n=aP();eP(0,"app-part-creation",5,6),uP("gameStartNotification",function(e){return Nk(n),fP().startGame(e)}),tP()}2&e&&Xb("partId",fP().currentPartId)}function lpe(e,t){1&e&&(rP(0),ZS(1,40),iP())}function fpe(e,t){if(1&e&&(rP(0),ZS(1,41),iP()),2&e){var n=fP(4);pE(1),qS(null==n.currentPlayer?null:n.currentPlayer.name),WS(1)}}function hpe(e,t){if(1&e&&(eP(0,"p",37),Yb(1,lpe,2,0,"ng-container",38),Yb(2,fpe,2,1,"ng-template",null,39,MT),tP()),2&e){var n=Kb(3),r=fP(3);pE(1),Xb("ngIf",(null==r.currentPlayer?null:r.currentPlayer.name)===r.getPlayer().name)("ngIfElse",n)}}function dpe(e,t){if(1&e&&(eP(0,"div",33),eP(1,"p",34),ZS(2,35),tP(),Yb(3,hpe,4,2,"p",36),tP()),2&e){var n=fP(2);pE(2),qS(n.currentPart.getTurn()+1),WS(2),pE(1),Xb("ngIf",!1===n.endGame)}}function vpe(e,t){if(1&e&&(eP(0,"p",42),FP(1),tP()),2&e){var n=fP(2);Xb("ngClass",n.getPlayerNameClass(n.Player.ZERO)),pE(1),UP(n.players[0].get().name)}}function ppe(e,t){if(1&e&&(eP(0,"p",43),ZS(1,44),tP()),2&e){var n=fP(2);pE(1),qS(n.gameComponent.scores.get()[0]),WS(1)}}function gpe(e,t){if(1&e&&(eP(0,"p",45),FP(1),tP()),2&e){var n=fP(2);Xb("ngClass",n.getPlayerNameClass(n.Player.ONE)),pE(1),UP(n.players[1].get().name)}}function ype(e,t){if(1&e&&(eP(0,"p",46),ZS(1,47),tP()),2&e){var n=fP(2);pE(1),qS(n.gameComponent.scores.get()[1]),WS(1)}}function mpe(e,t){if(1&e){var n=aP();eP(0,"button",56),uP("click",function(){return Nk(n),fP(3).resign()}),ZS(1,57),tP()}}function kpe(e,t){if(1&e){var n=aP();eP(0,"button",58),uP("click",function(){return Nk(n),fP(3).proposeDraw()}),ZS(1,59),tP()}}function Cpe(e,t){if(1&e){var n=aP();eP(0,"button",60),uP("click",function(){return Nk(n),fP(3).acceptDraw()}),ZS(1,61),tP()}}function wpe(e,t){if(1&e){var n=aP();eP(0,"button",62),uP("click",function(){return Nk(n),fP(3).refuseDraw()}),ZS(1,63),tP()}}function _pe(e,t){if(1&e){var n=aP();eP(0,"button",64),uP("click",function(){return Nk(n),fP(3).gameComponent.pass()}),ZS(1,65),tP()}}function Epe(e,t){if(1&e){var n=aP();eP(0,"button",66),uP("click",function(){return Nk(n),fP(3).acceptTakeBack()}),ZS(1,67),tP()}}function bpe(e,t){if(1&e){var n=aP();eP(0,"button",68),uP("click",function(){return Nk(n),fP(3).refuseTakeBack()}),ZS(1,69),tP()}}function Ppe(e,t){if(1&e){var n=aP();eP(0,"button",70),uP("click",function(){return Nk(n),fP(3).askTakeBack()}),ZS(1,71),tP()}}function Spe(e,t){if(1&e&&(rP(0),Yb(1,mpe,2,0,"button",48),Yb(2,kpe,2,0,"button",49),Yb(3,Cpe,2,0,"button",50),Yb(4,wpe,2,0,"button",51),Yb(5,_pe,2,0,"button",52),Yb(6,Epe,2,0,"button",53),Yb(7,bpe,2,0,"button",54),Yb(8,Ppe,2,0,"button",55),iP()),2&e){var n=fP(2);pE(1),Xb("ngIf",n.canResign()),pE(1),Xb("ngIf",n.canProposeDraw()),pE(1),Xb("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),pE(1),Xb("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),pE(1),Xb("ngIf",!1===n.endGame&&n.isPlaying()&&n.gameComponent.canPass&&(null==n.currentPlayer?null:n.currentPlayer.name)===n.getPlayer().name),pE(1),Xb("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),pE(1),Xb("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),pE(1),Xb("ngIf",!1===n.endGame&&!1===n.isOpponentWaitingForTakeBackResponse()&&n.canAskTakeBack())}}function Ope(e,t){1&e&&(eP(0,"div"),eP(1,"p",73),ZS(2,74),tP(),tP())}function Tpe(e,t){1&e&&(eP(0,"p",78),ZS(1,79),tP())}function Ipe(e,t){1&e&&(eP(0,"p",80),ZS(1,81),tP())}function Ape(e,t){1&e&&(eP(0,"p",82),ZS(1,83),tP())}function Rpe(e,t){if(1&e&&(eP(0,"div"),Yb(1,Tpe,2,0,"p",75),Yb(2,Ipe,2,0,"p",76),Yb(3,Ape,2,0,"p",77),tP()),2&e){var n=fP(3);pE(1),Xb("ngIf",n.currentPart.getDrawAccepter().name===n.getPlayer().name),pE(1),Xb("ngIf",n.currentPart.getDrawAccepter().name!==n.getPlayer().name&&n.isPlaying()),pE(1),Xb("ngIf",!1===n.isPlaying())}}function Mpe(e,t){1&e&&(eP(0,"p",86),ZS(1,87),tP())}function xpe(e,t){1&e&&(eP(0,"p",88),ZS(1,89),tP())}function Npe(e,t){if(1&e&&(eP(0,"p",88),ZS(1,90),tP()),2&e){var n=fP(4);pE(1),qS(n.currentPart.getWinner().get().name),WS(1)}}function Dpe(e,t){if(1&e&&(eP(0,"div"),Yb(1,Mpe,2,0,"p",84),Yb(2,xpe,2,0,"p",85),Yb(3,Npe,2,1,"p",85),tP()),2&e){var n=fP(3);pE(1),Xb("ngIf",n.currentPart.getWinner().get().name===n.getPlayer().name),pE(1),Xb("ngIf",n.currentPart.getWinner().get().name!==n.getPlayer().name&&n.isPlaying()),pE(1),Xb("ngIf",!1===n.isPlaying())}}function Lpe(e,t){if(1&e&&(eP(0,"p",86),ZS(1,91),tP()),2&e){var n=fP(4);pE(1),qS(n.currentPart.getLoser().get().name),WS(1)}}function Fpe(e,t){1&e&&(eP(0,"p",88),ZS(1,92),tP())}function Upe(e,t){if(1&e&&(eP(0,"p",88),ZS(1,93),tP()),2&e){var n=fP(4);pE(1),qS(n.currentPart.getLoser().get().name),WS(1)}}function Vpe(e,t){if(1&e&&(eP(0,"div"),Yb(1,Lpe,2,1,"p",84),Yb(2,Fpe,2,0,"p",85),Yb(3,Upe,2,1,"p",85),tP()),2&e){var n=fP(3);pE(1),Xb("ngIf",n.currentPart.getWinner().get().name===n.getPlayer().name),pE(1),Xb("ngIf",n.currentPart.getWinner().get().name!==n.getPlayer().name&&n.isPlaying()),pE(1),Xb("ngIf",!1===n.isPlaying())}}function Bpe(e,t){1&e&&(eP(0,"p",95),ZS(1,96),tP())}function zpe(e,t){if(1&e&&(eP(0,"p",95),ZS(1,97),tP()),2&e){var n=fP(4);pE(1),qS(n.currentPart.getLoser().get().name),WS(1)}}function Hpe(e,t){if(1&e&&(eP(0,"div"),Yb(1,Bpe,2,0,"p",94),Yb(2,zpe,2,1,"p",94),tP()),2&e){var n=fP(3);pE(1),Xb("ngIf",n.currentPart.getWinner().get().name!==n.getPlayer().name&&n.isPlaying()),pE(1),Xb("ngIf",!1===n.isPlaying()||n.currentPart.getWinner().get().name===n.getPlayer().name)}}function Gpe(e,t){if(1&e&&(eP(0,"div",72),nP(1,"hr"),Yb(2,Ope,3,0,"div",26),Yb(3,Rpe,4,3,"div",26),Yb(4,Dpe,4,3,"div",26),Yb(5,Vpe,4,3,"div",26),Yb(6,Hpe,3,2,"div",26),tP()),2&e){var n=fP(2);pE(2),Xb("ngIf",n.currentPart.isHardDraw()),pE(1),Xb("ngIf",n.currentPart.isAgreedDraw()),pE(1),Xb("ngIf",n.currentPart.isWin()),pE(1),Xb("ngIf",n.currentPart.isTimeout()),pE(1),Xb("ngIf",n.currentPart.isResign())}}function $pe(e,t){1&e&&(eP(0,"button",98),ZS(1,99),tP())}function Zpe(e,t){if(1&e){var n=aP();eP(0,"button",100),uP("click",function(){return Nk(n),fP(2).proposeRematch()}),ZS(1,101),tP()}}function qpe(e,t){if(1&e){var n=aP();eP(0,"button",102),uP("click",function(){return Nk(n),fP(2).acceptRematch()}),ZS(1,103),tP()}}function Wpe(e,t){if(1&e){var n=aP();eP(0,"div",7),eP(1,"div",8),eP(2,"div",9),Yb(3,dpe,4,2,"div",10),eP(4,"div",11),Yb(5,vpe,2,2,"p",12),Yb(6,ppe,2,1,"p",13),eP(7,"app-count-down",14,15),uP("outOfTimeAction",function(){Nk(n);var e=fP();return e.reachedOutOfTime(e.Player.ZERO)})("addTimeToOpponent",function(){return Nk(n),fP().addGlobalTime()}),tP(),eP(9,"app-count-down",16,17),uP("outOfTimeAction",function(){Nk(n);var e=fP();return e.reachedOutOfTime(e.Player.ZERO)})("addTimeToOpponent",function(){return Nk(n),fP().addTurnTime()}),tP(),tP(),eP(11,"p",18),ZS(12,19),tP(),eP(13,"div",11),Yb(14,gpe,2,2,"p",20),Yb(15,ype,2,1,"p",21),eP(16,"app-count-down",22,23),uP("outOfTimeAction",function(){Nk(n);var e=fP();return e.reachedOutOfTime(e.Player.ONE)})("addTimeToOpponent",function(){return Nk(n),fP().addGlobalTime()}),tP(),eP(18,"app-count-down",24,25),uP("outOfTimeAction",function(){Nk(n);var e=fP();return e.reachedOutOfTime(e.Player.ONE)})("addTimeToOpponent",function(){return Nk(n),fP().addTurnTime()}),tP(),tP(),nP(20,"hr"),Yb(21,Spe,9,8,"ng-container",26),Yb(22,Gpe,7,5,"div",27),Yb(23,$pe,2,0,"button",28),Yb(24,Zpe,2,0,"button",29),Yb(25,qpe,2,0,"button",30),tP(),tP(),eP(26,"div",31),eP(27,"div",32),nP(28,"app-game-includer"),tP(),tP(),tP()}if(2&e){var r=fP();pE(3),Xb("ngIf",r.currentPart),pE(2),Xb("ngIf",r.players[0].isPresent()),pE(1),Xb("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),pE(1),Xb("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",r.observerRole===r.Player.ONE&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),pE(2),Xb("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",r.observerRole===r.Player.ONE&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),pE(5),Xb("ngIf",r.players[1].isPresent()),pE(1),Xb("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),pE(1),Xb("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",r.observerRole===r.Player.ZERO&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),pE(2),Xb("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",r.observerRole===r.Player.ZERO&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),pE(3),Xb("ngIf",r.isPlaying()),pE(1),Xb("ngIf",r.endGame),pE(1),Xb("ngIf",r.endGame),pE(1),Xb("ngIf",r.endGame&&r.isPlaying()&&!1===r.rematchProposed),pE(1),Xb("ngIf",r.endGame&&r.isPlaying()&&r.rematchProposed&&r.opponentProposedRematch),pE(1),Xb("ngClass",r.getBoardHighlight())}}var jpe=function(){var e=Wg(function e(){Zg(this,e)});return e.NO_MATCHING_PART=function(){return $localize(Sv||(Sv=_g(["The game you tried to join does not exist."])))},e}(),Ype=Wg(function e(t){Zg(this,e),this.value=t});Ype.PRE_START_DOC=new Ype("PRE_START_DOC"),Ype.STARTING_DOC=new Ype("STARTING_DOC"),Ype.DUPLICATE=new Ype("DUPLICATE"),Ype.MOVE_WITHOUT_TIME=new Ype("MOVE_WITHOUT_TIME"),Ype.MOVE=new Ype("MOVE"),Ype.REQUEST=new Ype("REQUEST"),Ype.END_GAME=new Ype("END_GAME"),Ype.END_GAME_WITHOUT_TIME=new Ype("END_GAME_WITHOUT_TIME"),Ype.ACCEPT_TAKE_BACK_WITHOUT_TIME=new Ype("ACCEPT_TAKE_BACK_WITHOUT_TIME");var Kpe=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o,s,u){var c;return Zg(this,n),(c=t.call(this,e,r,o,i,a)).userService=s,c.gameService=u,c.gameStarted=!1,c.opponent=null,c.rematchProposed=!1,c.opponentProposedRematch=!1,c.hasUserPlayed=[!1,!1],c.msToSubstract=[0,0],c.opponentSubscription=new qg,c.partSubscription=new qg,c.OFFLINE_FONT_COLOR={color:"lightgrey"},c.globalTimeMessage=$localize(Ov||(Ov=_g(["5 minutes"]))),c.turnTimeMessage=$localize(Tv||(Tv=_g(["30 seconds"]))),sB(n.VERBOSE,"OnlineGameWrapperComponent constructed"),c}return Wg(n,[{key:"extractPartIdFromURL",value:function(){return oB.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}},{key:"extractGameNameFromURL",value:function(){return oB.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}},{key:"isPlaying",value:function(){return this.observerRole.isPlayer()}},{key:"getPlayer",value:function(){return this.authUser.toMinimalUser()}},{key:"isPlayer",value:function(e){return this.observerRole===e}},{key:"isOpponent",value:function(e){return this.observerRole!==e}},{key:"redirectIfPartOrGameIsInvalid",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.extractGameNameFromURL(),!Zde.ALL_GAMES().some(function(e){return e.urlName===n})){t.next=11;break}return t.next=4,e.gameService.getPartValidity(e.currentPartId,n);case 4:if(!t.sent.isFailure()){t.next=9;break}return e.routerEventsSub.unsubscribe(),r=jpe.NO_MATCHING_PART(),t.next=9,e.router.navigate(["/notFound",r],{skipLocationChange:!0});case 9:t.next=15;break;case 11:return e.routerEventsSub.unsubscribe(),i=Tve.NO_MATCHING_GAME(n),t.next=15,e.router.navigate(["/notFound",i],{skipLocationChange:!0});case 15:case"end":return t.stop()}},t)}))()}},{key:"setCurrentPartIdOrRedirect",value:function(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}},{key:"ngOnInit",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return sB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),e.routerEventsSub=e.router.events.subscribe(function(){var t=aB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=n instanceof wN,!t.t0){t.next=4;break}return t.next=4,e.setCurrentPartIdOrRedirect();case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),e.userSub=e.connectedUserService.subscribeToUser(function(t){e.authUser=t}),t.next=5,e.setCurrentPartIdOrRedirect();case 5:sB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit done");case 6:case"end":return t.stop()}},t)}))()}},{key:"startGame",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:sB(n.VERBOSE,"OnlineGameWrapperComponent.startGame"),v7(!1===t.gameStarted,"Should not start already started game"),t.configRoom=e,t.gameStarted=!0,window.setTimeout(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=v7,e.next=3,t.afterGameIncluderViewInit();case 3:e.t1=e.sent,(0,e.t0)(e.t1,"Game should be created successfully, otherwise part-creation would have redirected"),t.startPart();case 6:case"end":return e.stop()}},e)})),1);case 1:case"end":return r.stop()}},r)}))()}},{key:"startPart",value:function(){var e,t=this;sB(n.VERBOSE,"OnlineGameWrapperComponent.startPart"),this.partSubscription=this.gameService.subscribeToChanges(this.currentPartId,(e=aB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return v7(n.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.next=3,t.onCurrentPartUpdate(n.get());case 3:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"onCurrentPartUpdate",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new _7(t.currentPartId,e),sB(n.VERBOSE,{OnlineGameWrapperComponent_onCurrentPartUpdate:{before:t.currentPart,then:e.data,before_part_turn:i.data.turn,before_state_turn:t.gameComponent.rules.node.gameState.turn,nbPlayedMoves:i.data.listMoves.length}}),a=t.getUpdateType(i),o=e.turn,sB(n.VERBOSE,a===Ype.REQUEST?"UpdateType: Request("+oB.getNonNullable(i.data.request).code+") ("+o+")":"UpdateType: "+a.value+"("+o+")"),s=t.currentPart,r.t0=(t.currentPart=i,a),r.next=r.t0===Ype.REQUEST?8:r.t0===Ype.ACCEPT_TAKE_BACK_WITHOUT_TIME?11:r.t0===Ype.DUPLICATE?12:r.t0===Ype.END_GAME_WITHOUT_TIME?13:r.t0===Ype.END_GAME?14:r.t0===Ype.MOVE_WITHOUT_TIME?15:r.t0===Ype.MOVE?16:r.t0===Ype.PRE_START_DOC?17:19;break;case 8:return r.next=10,t.onRequest(oB.getNonNullable(i.data.request),s);case 10:return r.abrupt("return",r.sent);case 11:case 13:case 15:return r.abrupt("return",void(t.currentPart=s));case 12:return r.abrupt("return");case 14:return r.abrupt("return",t.applyEndGame());case 16:return r.abrupt("return",(t.msToSubstract=t.getLastUpdateTime(s,i,a),t.doNewMoves(i)));case 17:return u=null==t.currentPart||null!=t.currentPart.data.beginning,r.abrupt("return",void v7(null==s||null==s.data.beginning||u,"old part had no beginning time or new part has, we did not expect this!"));case 19:return r.abrupt("return",(v7(a===Ype.STARTING_DOC,"Unexpected update type "+a),t.setChronos(),t.setPlayersDatas(i),t.startCountDownFor(R7.ZERO)));case 20:case"end":return r.stop()}},r)}))()}},{key:"getUpdateType",value:function(e){var t=Ave.from(null!=this.currentPart?this.currentPart.data:null,e.data);sB(n.VERBOSE,{diff:t});var r=t.countChanges();if(0===r)return Ype.DUPLICATE;if(e.data.request){var i=null!=t.removed.lastUpdateTime;return"TakeBackAccepted"===e.data.request.code&&i?Ype.ACCEPT_TAKE_BACK_WITHOUT_TIME:Ype.REQUEST}if(this.isMove(t,r))return 1===e.data.turn?null==e.data.lastUpdateTime?Ype.MOVE_WITHOUT_TIME:Ype.MOVE:null==t.modified.lastUpdateTime?Ype.MOVE_WITHOUT_TIME:Ype.MOVE;if(null==e.data.beginning)return Ype.PRE_START_DOC;if(e.data.result!==w7.UNACHIEVED.value){var a=null==t.modified.lastUpdateTime;return null!=t.modified.turn&&a?Ype.END_GAME_WITHOUT_TIME:Ype.END_GAME}return v7(null!=e.data.beginning&&0===e.data.listMoves.length,"Unexpected update: "+JSON.stringify(t)),Ype.STARTING_DOC}},{key:"isMove",value:function(e,t){if(null!=e.modified.listMoves&&null!=e.modified.turn){return t===(e.isPresent("lastUpdateTime").present?1:0)+(e.isPresent("scorePlayerZero").present?1:0)+(e.isPresent("scorePlayerOne").present?1:0)+(e.isPresent("remainingMsForZero").present?1:0)+(e.isPresent("remainingMsForOne").present?1:0)+(null==e.removed.request?0:1)+3}return!1}},{key:"getLastUpdateTime",value:function(e,t,n){var r=this.getMoreRecentTime(e),i=this.getMoreRecentTime(t);v7(null!=r,"oldTime should not be null"),v7(null!=i,"updateTime should not be null");var a=R7.fromTurn(e.data.turn);return this.getTimeUsedForLastTurn(oB.getNonNullable(r),oB.getNonNullable(i),n,a)}},{key:"getMoreRecentTime",value:function(e){var t;return null!==(t=e.data.lastUpdateTime)&&void 0!==t?t:e.data.beginning}},{key:"getTimeUsedForLastTurn",value:function(e,t,n,r){var i=Mve(e,t),a=[0,0];return a[r.value]=i,a}},{key:"setChronos",value:function(){sB(n.VERBOSE,"onlineGameWrapperComponent.setChronos()"),this.chronoZeroGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoOneGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoZeroTurn.setDuration(1e3*this.configRoom.maximalMoveDuration),this.chronoOneTurn.setDuration(1e3*this.configRoom.maximalMoveDuration)}},{key:"didUserPlay",value:function(e){return this.hasUserPlayed[e.value]}},{key:"doNewMoves",value:function(e){sB(n.VERBOSE,"OnlineGameWrapperComponent.doNewMoves"),this.switchPlayer();for(var t=D7.copyImmutableArray(e.data.listMoves),r=this.gameComponent.rules;r.node.gameState.turn<t.length;){var i=r.node.gameState.turn,a=this.gameComponent.encoder.decode(t[i]),o=r.isLegal(a,r.node.gameState),s="We received an incorrect db move: "+a.toString()+" in "+t+" at turn "+i+'because "'+o.getReasonOr("")+'"';v7(o.isSuccess(),s),r.choose(a)}this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get(),this.gameComponent.updateBoard()}},{key:"switchPlayer",value:function(){sB(n.VERBOSE,"OnlineGameWrapperComponent.switchPlayer");var e=R7.fromTurn(this.currentPart.data.turn);this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get();var t=e.getOpponent();this.didUserPlay(t)&&this.pauseCountDownsFor(t),this.didUserPlay(e)?(sB(n.VERBOSE,"OnlineGameWrapperComponent.onCurrentPartUpdate: changing current player"),this.resumeCountDownFor(e)):this.startCountDownFor(e)}},{key:"resetChronoFor",value:function(e){this.pauseCountDownsFor(e),this.resumeCountDownFor(e)}},{key:"applyEndGame",value:function(){var e=this.currentPart,t=R7.fromTurn(e.data.turn);this.endGame=!0,[w7.VICTORY,w7.HARD_DRAW].some(function(t){return t.value===e.data.result})?this.doNewMoves(this.currentPart):(v7(!0===[w7.RESIGN,w7.TIMEOUT,w7.HARD_DRAW,w7.AGREED_DRAW_BY_ZERO,w7.AGREED_DRAW_BY_ONE].some(function(t){return t.value===e.data.result}),"Unknown type of end game ("+e.data.result+")"),sB(n.VERBOSE,"endGame est true et winner est "+e.getWinner())),this.stopCountdownsFor(t)}},{key:"notifyDraw",value:function(e,t){return this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.observerRole,e,[0,0],t,!0)}},{key:"notifyTimeoutVictory",value:function(e,t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i.endGame=!0,o=i.currentPart.setWinnerAndLoser(e,r),i.currentPart=o,a.next=5,i.gameService.notifyTimeout(i.currentPartId,t,n,e,r);case 5:case"end":return a.stop()}},a)}))()}},{key:"notifyVictory",value:function(e,t){sB(n.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");var r=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);return r===gte.ONE_WON?this.currentPart=this.currentPart.setWinnerAndLoser(this.players[1].get(),this.players[0].get()):(v7(r===gte.ZERO_WON,"impossible to get a victory without winner!"),this.currentPart=this.currentPart.setWinnerAndLoser(this.players[0].get(),this.players[1].get())),this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.observerRole,e,[0,0],t,!1,this.currentPart.getWinner().get(),this.currentPart.getLoser().get())}},{key:"canAskTakeBack",value:function(){return v7(this.isPlaying(),"Non playing should not call canAskTakeBack"),!(null==this.currentPart||this.currentPart.data.turn<=this.observerRole.value||this.currentPart.data.request&&"TakeBackRefused"===this.currentPart.data.request.code&&this.observerRole.isPlayer()&&this.currentPart.data.request.data.player===this.observerRole.getOpponent().value)&&this.getTakeBackRequester()===A7.NONE}},{key:"isOpponentWaitingForTakeBackResponse",value:function(){var e=this.getTakeBackRequester();return!!e.isPlayer()&&this.isOpponent(e)}},{key:"getTakeBackRequester",value:function(){if(null==this.currentPart)return A7.NONE;var e=this.currentPart.data.request;return e&&"TakeBackAsked"===e.code?M7.getPlayer(e):A7.NONE}},{key:"canProposeDraw",value:function(){return v7(this.isPlaying(),"Non playing should not call canProposeDraw"),!(this.endGame||null==this.currentPart||this.currentPart.data.request&&"DrawRefused"===this.currentPart.data.request.code&&this.observerRole.isPlayer()&&M7.getPlayer(this.currentPart.data.request)===this.observerRole.getOpponent()||this.isOpponentWaitingForDrawResponse())&&this.getDrawRequester()===A7.NONE}},{key:"isOpponentWaitingForDrawResponse",value:function(){var e=this.getDrawRequester();return e!==A7.NONE&&this.isOpponent(e)}},{key:"getDrawRequester",value:function(){if(null==this.currentPart)return A7.NONE;var e=this.currentPart.data.request;return e&&"DrawProposed"===e.code?M7.getPlayer(e):A7.NONE}},{key:"onRequest",value:function(e,t){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=(sB(n.VERBOSE,{called:"OnlineGameWrapper.onRequest(",request:e,oldPart:t}),e.code),i.next="TakeBackAsked"===i.t0||"TakeBackRefused"===i.t0||"DrawProposed"===i.t0||"DrawRefused"===i.t0?3:"TakeBackAccepted"===i.t0?4:"RematchProposed"===i.t0?6:"RematchAccepted"===i.t0?10:"AddTurnTime"===i.t0?15:"AddGlobalTime"===i.t0?18:21;break;case 3:case 14:return i.abrupt("break",24);case 4:return r.takeBackTo(r.currentPart.data.turn),i.abrupt("break",24);case 6:return r.rematchProposed=!0,a=M7.getPlayer(e).getOpponent(),r.isPlayer(a)&&(sB(n.VERBOSE,"ton adversaire te propose une revanche"),r.opponentProposedRematch=!0),i.abrupt("break",24);case 10:return i.next=12,r.router.navigate(["/nextGameLoading"]);case 12:return i.next=14,r.router.navigate(["/play",M7.getTypeGame(e),M7.getPartId(e)]);case 15:return 3e4,o=R7.of(e.data.player),r.addTurnTimeTo(o,3e4),i.abrupt("break",24);case 18:return 3e5,s=R7.of(e.data.player),r.addGlobalTimeTo(s,3e5),i.abrupt("break",24);case 21:return oB.expectToBe(e.code,"DrawAccepted","Unknown RequestType : "+e.code+" for "+JSON.stringify(e)),i.next=24,r.acceptDraw();case 24:case"end":return i.stop()}},i)}))()}},{key:"takeBackTo",value:function(e){if(sB(n.VERBOSE,"OnlineGameWrapperComponent.takeBackTo"),this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.gameComponent.rules.node.gameState.turn===e)this.switchPlayer();else{this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get();var t=R7.fromTurn(e);this.resetChronoFor(t)}this.gameComponent.updateBoard()}},{key:"setPlayersDatas",value:function(e){var t=this;sB(n.VERBOSE,{OnlineGameWrapper_setPlayersDatas:e}),this.players=[fB.of(e.data.playerZero),fB.ofNullable(e.data.playerOne)],v7(null!=e.data.playerOne,"should not setPlayersDatas when players data is not received"),this.currentPlayer=this.players[e.data.turn%2].get();var r=fB.empty();if(this.players[0].get().id===this.authUser.id?(this.observerRole=R7.ZERO,r=this.players[1]):this.players[1].get().id===this.authUser.id?(this.observerRole=R7.ONE,r=this.players[0]):this.observerRole=A7.NONE,r.isPresent()){this.opponentSubscription=this.userService.observeUser(r.get().id,function(e){v7(e.isPresent(),"opponent was deleted, what sorcery is this"),t.opponent={id:r.get().id,name:oB.getNonNullable(e.get().username)}})}}},{key:"onLegalUserMove",value:function(e,t){var r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(sB(n.VERBOSE,"dans OnlineGameWrapperComponent.onLegalUserMove"),r.isOpponentWaitingForTakeBackResponse()){i.next=2;break}return i.abrupt("return",r.updateDBBoard(e,r.msToSubstract,t));case 2:r.gameComponent.message("You must answer to take back request");case 3:case"end":return i.stop()}},i)}))()}},{key:"updateDBBoard",value:function(e,t,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o=i.gameComponent.encoder.encodeMove(e),sB(n.VERBOSE,"OnlineGameWrapperComponent.updateDBBoard("+e.toString()+", "+r+")"),i.gameComponent.rules.choose(e),s=i.gameComponent.rules.getGameStatus(i.gameComponent.rules.node),a.abrupt("return",s.isEndGame?s===gte.DRAW?i.notifyDraw(o,r):i.notifyVictory(o,r):i.gameService.updateDBBoard(i.currentPartId,i.observerRole,o,t,r));case 4:case"end":return a.stop()}},a)}))()}},{key:"resign",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return sB(n.VERBOSE,"OnlineGameWrapperComponent.resign"),r=e.getLastIndex(),i=e.observerRole,a=e.getPlayer(),o=e.players[(e.observerRole.value+1)%2].get(),t.next=4,e.gameService.resign(e.currentPartId,r,i,o,a);case 4:case"end":return t.stop()}},t)}))()}},{key:"getLastIndex",value:function(){return this.currentPart.data.lastUpdate.index}},{key:"reachedOutOfTime",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(sB(n.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+e+")"),i=t.getLastIndex(),a=t.observerRole,t.stopCountdownsFor(e),e!==t.observerRole){r.next=8;break}return o=oB.getNonNullable(t.opponent),r.next=6,t.notifyTimeoutVictory(o,a,i,t.authUser.toMinimalUser());case 6:r.next=13;break;case 8:if(v7(!1===t.endGame,"time might be better handled in the future"),!t.opponentIsOffline()){r.next=13;break}return s=oB.getNonNullable(t.opponent),r.next=12,t.notifyTimeoutVictory(t.authUser.toMinimalUser(),a,e.value,s);case 12:t.endGame=!0;case 13:case"end":return r.stop()}},r)}))()}},{key:"acceptRematch",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return v7(e.isPlaying(),"Non playing should not call acceptRematch"),n=new _7(e.currentPartId,e.currentPart.data),t.next=4,e.gameService.acceptRematch(n,e.getLastIndex(),e.observerRole);case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}},t)}))()}},{key:"proposeRematch",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return v7(e.isPlaying(),"Non playing should not call proposeRematch"),t.next=3,e.gameService.proposeRematch(e.currentPartId,e.getLastIndex(),e.observerRole);case 3:return t.abrupt("return",!0);case 4:case"end":return t.stop()}},t)}))()}},{key:"proposeDraw",value:function(){return v7(this.isPlaying(),"Non playing should not call proposeDraw"),this.gameService.proposeDraw(this.currentPartId,this.getLastIndex(),this.observerRole)}},{key:"acceptDraw",value:function(){return v7(this.isPlaying(),"Non playing should not call acceptDraw"),this.gameService.acceptDraw(this.currentPartId,this.getLastIndex(),this.observerRole)}},{key:"refuseDraw",value:function(){return v7(this.isPlaying(),"Non playing should not call refuseDraw"),this.gameService.refuseDraw(this.currentPartId,this.getLastIndex(),this.observerRole)}},{key:"askTakeBack",value:function(){return v7(this.isPlaying(),"Non playing should not call askTakeBack"),this.gameService.askTakeBack(this.currentPartId,this.getLastIndex(),this.observerRole)}},{key:"acceptTakeBack",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return v7(e.isPlaying(),"Non playing should not call acceptTakeBack"),n=e.observerRole,t.next=4,e.gameService.acceptTakeBack(e.currentPartId,e.currentPart,n,e.msToSubstract);case 4:e.msToSubstract=[0,0];case 5:case"end":return t.stop()}},t)}))()}},{key:"refuseTakeBack",value:function(){return v7(this.isPlaying(),"Non playing should not call refuseTakeBack"),this.gameService.refuseTakeBack(this.currentPartId,this.getLastIndex(),this.observerRole)}},{key:"startCountDownFor",value:function(e){sB(n.VERBOSE,"dans OnlineGameWrapperComponent.startCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),this.hasUserPlayed[e.value]=!0,e===R7.ZERO?(this.chronoZeroGlobal.start(),this.chronoZeroTurn.start()):(this.chronoOneGlobal.start(),this.chronoOneTurn.start())}},{key:"resumeCountDownFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];sB(n.VERBOSE,"dans OnlineGameWrapperComponent.resumeCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===R7.ZERO?(this.chronoZeroGlobal.changeDuration(oB.getNonNullable(this.currentPart.data.remainingMsForZero)),this.chronoZeroGlobal.resume(),t=this.chronoZeroTurn):(this.chronoOneGlobal.changeDuration(oB.getNonNullable(this.currentPart.data.remainingMsForOne)),this.chronoOneGlobal.resume(),t=this.chronoOneTurn),r?(t.setDuration(1e3*this.configRoom.maximalMoveDuration),t.start()):t.resume()}},{key:"pauseCountDownsFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];sB(n.VERBOSE,"dans OnlineGameWrapperComponent.pauseCountDownFor("+e.value+") (turn "+this.currentPart.data.turn+")"),e===R7.ZERO?(this.chronoZeroGlobal.pause(),t=this.chronoZeroTurn):(this.chronoOneGlobal.pause(),t=this.chronoOneTurn),r?t.stop():t.pause()}},{key:"stopCountdownsFor",value:function(e){sB(n.VERBOSE,"cdc::stopCountDownsFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===R7.ZERO?(this.chronoZeroGlobal.isStarted()&&this.chronoZeroGlobal.stop(),this.chronoZeroTurn.isStarted()&&this.chronoZeroTurn.stop()):(this.chronoOneGlobal.isStarted()&&this.chronoOneGlobal.stop(),this.chronoOneTurn.isStarted()&&this.chronoOneTurn.stop())}},{key:"getPlayerNameClass",value:function(e){return this.opponentIsOffline()?"has-text-grey-light":e===R7.ZERO?"has-text-white":"has-text-black"}},{key:"opponentIsOffline",value:function(){return!1}},{key:"canResign",value:function(){return v7(this.isPlaying(),"Non playing should not call canResign"),!(!0===this.endGame||null==this.opponent)}},{key:"addGlobalTime",value:function(){var e=this.observerRole,t=this.getLastIndex();return this.gameService.addGlobalTime(this.currentPartId,t,this.currentPart.data,e)}},{key:"addTurnTime",value:function(){return this.gameService.addTurnTime(this.observerRole,this.getLastIndex(),this.currentPartId)}},{key:"addTurnTimeTo",value:function(e,t){var n=R7.fromTurn(this.currentPart.getTurn());this.pauseCountDownsFor(n,!1),e===R7.ZERO?this.chronoZeroTurn.changeDuration(this.chronoZeroTurn.remainingMs+t):this.chronoOneTurn.changeDuration(this.chronoOneTurn.remainingMs+t),this.resumeCountDownFor(n,!1)}},{key:"addGlobalTimeTo",value:function(e,t){e===R7.ZERO?this.chronoZeroGlobal.changeDuration(this.chronoZeroGlobal.remainingMs+t):this.chronoOneGlobal.changeDuration(this.chronoOneGlobal.remainingMs+t)}},{key:"ngOnDestroy",value:function(){sB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy"),this.routerEventsSub.unsubscribe(),this.userSub.unsubscribe(),!0===this.gameStarted&&(this.opponentSubscription.unsubscribe(),this.partSubscription.unsubscribe()),sB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy finished")}}]),n}(Ive);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Qb(iO),Qb(OD),Qb(jL),Qb(h7),Qb(C7),Qb(g7),Qb(B7))},e.\u0275cmp=Gm({type:e,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){var n;(1&e&&(IT(rpe,5),IT(ipe,5),IT(ape,5),IT(ope,5),IT(spe,5),IT(upe,5)),2&e)&&(TT(n=AT())&&(t.partCreation=n.first),TT(n=AT())&&(t.chatComponent=n.first),TT(n=AT())&&(t.chronoZeroGlobal=n.first),TT(n=AT())&&(t.chronoOneGlobal=n.first),TT(n=AT())&&(t.chronoZeroTurn=n.first),TT(n=AT())&&(t.chronoOneTurn=n.first))},features:[Rb],decls:5,vars:4,consts:function(){return[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],$localize(Iv||(Iv=_g(["vs."]))),["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],[4,"ngIf"],["class","block","id","winnerIndicator",4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","proposeRematchButton","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["class","button is-fullwidth is-warning","id","acceptRematchButton",3,"click",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(Av||(Av=_g(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],$localize(Rv||(Rv=_g(["It is your turn."]))),$localize(Mv||(Mv=_g(["It is ",":INTERPOLATION:'s turn."])),"\ufffd0\ufffd"),["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],$localize(xv||(xv=_g(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],$localize(Nv||(Nv=_g(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["class","button is-fullwidth mb-1","id","resignButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","proposeDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","refuseDrawButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","passButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptTakeBackButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","color","warn","id","refuseTakeBackButton",3,"click",4,"ngIf"],["class","button is-fullwidth","id","askTakeBackButton",3,"click",4,"ngIf"],["id","resignButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Dv||(Dv=_g(["Resign"]))),["id","proposeDrawButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Lv||(Lv=_g(["Propose a draw"]))),["id","acceptDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Fv||(Fv=_g(["Accept draw"]))),["id","refuseDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Uv||(Uv=_g(["Reject draw"]))),["id","passButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Vv||(Vv=_g(["Pass a turn"]))),["id","acceptTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Bv||(Bv=_g(["Accept take back"]))),["color","warn","id","refuseTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(zv||(zv=_g(["Reject take back"]))),["id","askTakeBackButton",1,"button","is-fullwidth",3,"click"],$localize(Hv||(Hv=_g(["Ask to take back one move"]))),["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],$localize(Gv||(Gv=_g(["Draw"]))),["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],$localize($v||($v=_g(["You agreed to draw."]))),["id","yourOpponentAgreedToDrawIndicator",1,"title"],$localize(Zv||(Zv=_g(["Your draw proposal has been accepted."]))),["id","playersAgreedToDraw",1,"title"],$localize(qv||(qv=_g(["Players agreed to draw."]))),["class","title","id","youWonIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],$localize(Wv||(Wv=_g(["You won."]))),[1,"title"],$localize(jv||(jv=_g(["You lost."]))),$localize(Yv||(Yv=_g(["",":INTERPOLATION: won."])),"\ufffd0\ufffd"),$localize(Kv||(Kv=_g(["",":INTERPOLATION: has reached their time limit. You won."])),"\ufffd0\ufffd"),$localize(Qv||(Qv=_g(["You reached your time limit."]))),$localize(Xv||(Xv=_g(["",":INTERPOLATION: has reached their time limit."])),"\ufffd0\ufffd"),["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],$localize(Jv||(Jv=_g(["You resigned."]))),$localize(ep||(ep=_g(["",":INTERPOLATION: has resigned."])),"\ufffd0\ufffd"),["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],$localize(tp||(tp=_g(["Go back to the game list"]))),["id","proposeRematchButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(np||(np=_g(["Propose to play again"]))),["id","acceptRematchButton",1,"button","is-fullwidth","is-warning",3,"click"],$localize(rp||(rp=_g(["Accept to play again"])))]},template:function(e,t){1&e&&(Yb(0,cpe,2,1,"app-part-creation",0),Yb(1,Wpe,29,27,"div",1),eP(2,"div",2),eP(3,"div",3),nP(4,"app-chat",4),tP(),tP()),2&e&&(Xb("ngIf",!1===t.gameStarted),pE(1),Xb("ngIf",t.gameStarted),pE(3),Xb("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},directives:[UA,pve,epe,npe,NA,Ove,KL],encapsulation:2}),e}();function Qpe(e,t){if(1&e&&(eP(0,"option",25),FP(1),tP()),2&e){var n=t.$implicit;Xb("value",n.name),pE(1),UP(n.name)}}function Xpe(e,t){if(1&e&&(eP(0,"option",25),ZS(1,29),tP()),2&e){var n=t.$implicit;Xb("value",n),pE(1),qS(n),WS(1)}}var Jpe=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function ege(e,t){if(1&e){var n=aP();eP(0,"select",26),uP("ngModelChange",function(e){return Nk(n),fP(2).aiDepths[0]=e})("change",function(){Nk(n);var e=fP(2);return e.updatePlayer(e.Player.ZERO)}),eP(1,"option",27),ZS(2,28),tP(),Yb(3,Xpe,2,2,"option",16),tP()}2&e&&(Xb("ngModel",fP(2).aiDepths[0]),pE(3),Xb("ngForOf",aT(2,Jpe)))}function tge(e,t){if(1&e&&(eP(0,"p",30),ZS(1,31),tP()),2&e){var n=fP(2);pE(1),qS(n.gameComponent.scores.get()[0]),WS(1)}}function nge(e,t){if(1&e&&(eP(0,"option",25),FP(1),tP()),2&e){var n=t.$implicit;Xb("value",n.name),pE(1),UP(n.name)}}function rge(e,t){if(1&e&&(eP(0,"option",25),ZS(1,34),tP()),2&e){var n=t.$implicit;Xb("value",n),pE(1),qS(n),WS(1)}}function ige(e,t){if(1&e){var n=aP();eP(0,"select",32),uP("ngModelChange",function(e){return Nk(n),fP(2).aiDepths[1]=e})("change",function(){Nk(n);var e=fP(2);return e.updatePlayer(e.Player.ONE)}),eP(1,"option",27),ZS(2,33),tP(),Yb(3,rge,2,2,"option",16),tP()}2&e&&(Xb("ngModel",fP(2).aiDepths[1]),pE(3),Xb("ngForOf",aT(2,Jpe)))}function age(e,t){if(1&e&&(eP(0,"p",35),ZS(1,36),tP()),2&e){var n=fP(2);pE(1),qS(n.gameComponent.scores.get()[1]),WS(1)}}function oge(e,t){if(1&e&&(eP(0,"h4"),ZS(1,40),tP()),2&e){var n=fP(3);pE(1),qS(n.winner.get()),WS(1)}}function sge(e,t){1&e&&(eP(0,"h4",41),ZS(1,42),tP())}function uge(e,t){if(1&e&&(eP(0,"div",37),Yb(1,oge,2,1,"h4",38),Yb(2,sge,2,0,"h4",39),tP()),2&e){var n=fP(2);pE(1),Xb("ngIf",n.winner.isPresent()),pE(1),Xb("ngIf",n.winner.isAbsent())}}function cge(e,t){if(1&e){var n=aP();eP(0,"div",6),eP(1,"div",7),eP(2,"p",8),ZS(3,9),tP(),tP(),eP(4,"div",10),eP(5,"div",11),eP(6,"div",12),eP(7,"select",13),uP("change",function(){Nk(n);var e=fP();return e.updatePlayer(e.Player.ZERO)})("ngModelChange",function(e){return Nk(n),fP().playerSelection[0]=e}),eP(8,"option",14),ZS(9,15),tP(),Yb(10,Qpe,2,2,"option",16),tP(),tP(),eP(11,"div",12),Yb(12,ege,4,3,"select",17),tP(),Yb(13,tge,2,1,"p",18),tP(),eP(14,"div",19),eP(15,"div",12),eP(16,"select",20),uP("change",function(){Nk(n);var e=fP();return e.updatePlayer(e.Player.ONE)})("ngModelChange",function(e){return Nk(n),fP().playerSelection[1]=e}),eP(17,"option",14),ZS(18,21),tP(),Yb(19,nge,2,2,"option",16),tP(),tP(),eP(20,"div",12),Yb(21,ige,4,3,"select",22),tP(),Yb(22,age,2,1,"p",23),tP(),tP(),Yb(23,uge,3,2,"div",24),tP()}if(2&e){var r=fP();pE(3),qS(r.gameComponent.rules.node.gameState.turn+1),WS(3),pE(4),Xb("ngModel",r.playerSelection[0]),pE(3),Xb("ngForOf",r.gameComponent.availableMinimaxes),pE(2),Xb("ngIf",!1===r.players[0].equalsValue("human")),pE(1),Xb("ngIf",r.gameComponent.scores.isPresent()),pE(3),Xb("ngModel",r.playerSelection[1]),pE(3),Xb("ngForOf",r.gameComponent.availableMinimaxes),pE(2),Xb("ngIf",!1===r.players[1].equalsValue("human")),pE(1),Xb("ngIf",r.gameComponent.scores.isPresent()),pE(1),Xb("ngIf",r.endGame)}}function lge(e,t){if(1&e&&(rP(0),FP(1),nP(2,"br"),iP()),2&e){var n=t.$implicit,r=fP(3);pE(1),VP(" ",n.name+": "+n.getBoardValue(r.gameComponent.rules.node)," ")}}function fge(e,t){if(1&e&&(rP(0),Yb(1,lge,3,1,"ng-container",48),FP(2),nP(3,"br"),FP(4),nP(5,"br"),iP()),2&e){var n=fP(2);pE(1),Xb("ngForOf",n.gameComponent.availableMinimaxes),pE(1),VP(" Created ",n.getCreatedNodes()," nodes."),pE(2),VP(" Minimax time: ",n.getMinimaxTime(),"ms.")}}function hge(e,t){if(1&e){var n=aP();eP(0,"button",49),uP("click",function(){return Nk(n),fP(2).gameComponent.pass()}),ZS(1,50),tP()}}function dge(e,t){if(1&e){var n=aP();eP(0,"button",51),uP("click",function(){return Nk(n),fP(2).takeBack()}),ZS(1,52),tP()}}function vge(e,t){if(1&e){var n=aP();eP(0,"div",43),Yb(1,fge,6,3,"ng-container",38),Yb(2,hge,2,0,"button",44),Yb(3,dge,2,0,"button",45),eP(4,"button",46),uP("click",function(){return Nk(n),fP().restartGame()}),ZS(5,47),tP(),tP()}if(2&e){var r=fP();pE(1),Xb("ngIf",r.gameComponent.rules.node.move),pE(1),Xb("ngIf",!1===r.endGame&&r.gameComponent.canPass),pE(1),Xb("ngIf",r.canTakeBack())}}var pge=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,e,r,i,a,o)).cdr=s,u.aiDepths=["0","0"],u.playerSelection=["human","human"],u.winner=fB.empty(),u.botTimeOut=1e3,u.players=[fB.of(u.playerSelection[0]),fB.of(u.playerSelection[1])],u.observerRole=R7.ZERO,sB(n.VERBOSE,"LocalGameWrapper.constructor"),u}return Wg(n,[{key:"getCreatedNodes",value:function(){return vte.createdNodes}},{key:"getMinimaxTime",value:function(){return vte.minimaxTime}},{key:"ngAfterViewInit",value:function(){var e=this;setTimeout(aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.afterGameIncluderViewInit();case 2:if(t.t0=t.sent,!t.t0){t.next=5;break}e.restartGame(),e.cdr.detectChanges();case 5:case"end":return t.stop()}},t)})),1)}},{key:"updatePlayer",value:function(e){this.players[e.value]=fB.of(this.playerSelection[e.value]),this.proposeAIToPlay()}},{key:"onLegalUserMove",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:sB(n.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),t.gameComponent.rules.choose(e),t.updateBoard(),t.proposeAIToPlay();case 1:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.gameComponent.updateBoard();var e=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer()&&(this.winner=fB.of($localize(ip||(ip=_g(["Player ",""])),e.winner.value+1))))}},{key:"proposeAIToPlay",value:function(){var e=this,t=this.getPlayingAI();t.isPresent()&&window.setTimeout(aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.doAIMove(t.get());case 2:case"end":return n.stop()}},n)})),this.botTimeOut)}},{key:"getPlayingAI",value:function(){var e=this;if(this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node).isEndGame)return fB.empty();var t=this.gameComponent.rules.node.gameState.turn%2;return"0"===this.aiDepths[t]?fB.empty():fB.ofNullable(this.gameComponent.availableMinimaxes.find(function(n){return e.players[t].isPresent()&&e.players[t].get()===n.name}))}},{key:"doAIMove",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return v7((r=t.gameComponent.rules).getGameStatus(r.node)===gte.ONGOING,"AI should not try to play when game is over!"),i=Number.parseInt(t.aiDepths[r.node.gameState.turn%2%2]),a=r.node.findBestMove(i,e,!0),n.abrupt("return",r.choose(a)?(t.updateBoard(),t.cdr.detectChanges(),t.proposeAIToPlay(),pB.SUCCESS):(t.messageDisplayer.criticalMessage($localize(ap||(ap=_g(["The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!"])))),d7.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:a.toString()})));case 4:case"end":return n.stop()}},n)}))()}},{key:"canTakeBack",value:function(){return this.gameComponent.rules.node.gameState.turn>0}},{key:"takeBack",value:function(){this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.isAITurn()&&(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get()),this.gameComponent.updateBoard()}},{key:"isAITurn",value:function(){return this.getPlayingAI().isPresent()}},{key:"restartGame",value:function(){var e=this.gameComponent.rules.stateType.getInitialState();this.gameComponent.rules.node=new pte(e),this.gameComponent.updateBoard(),this.endGame=!1,this.winner=fB.empty(),this.proposeAIToPlay()}},{key:"getPlayer",value:function(){return"human"}}]),n}(Ive);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Qb(iO),Qb(OD),Qb(C7),Qb(jL),Qb(h7),Qb(NO))},e.\u0275cmp=Gm({type:e,selectors:[["app-local-game-wrapper"]],features:[Rb],decls:7,vars:3,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(op||(op=_g(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],$localize(sp||(sp=_g(["Human"]))),[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],$localize(up||(up=_g(["Human"]))),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["class","block","id","gameResult",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],$localize(cp||(cp=_g(["Pick the level"]))),$localize(lp||(lp=_g(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreOne",1,"block"],$localize(fp||(fp=_g(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],$localize(hp||(hp=_g(["Pick the level"]))),$localize(dp||(dp=_g(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreZero",1,"block"],$localize(vp||(vp=_g(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","gameResult",1,"block"],[4,"ngIf"],["id","draw",4,"ngIf"],$localize(pp||(pp=_g(["",":INTERPOLATION: won"])),"\ufffd0\ufffd"),["id","draw"],$localize(gp||(gp=_g(["Draw"]))),[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],$localize(yp||(yp=_g(["Start a new game"]))),[4,"ngFor","ngForOf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],$localize(mp||(mp=_g(["Pass a turn"]))),["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],$localize(kp||(kp=_g(["Take back move"])))]},template:function(e,t){1&e&&(eP(0,"div",0),eP(1,"div",1),Yb(2,cge,24,10,"div",2),Yb(3,vge,6,3,"div",3),tP(),eP(4,"div",4),eP(5,"div",5),nP(6,"app-game-includer"),tP(),tP(),tP()),2&e&&(pE(2),Xb("ngIf",t.gameComponent),pE(1),Xb("ngIf",t.gameComponent),pE(1),Xb("ngClass",t.getBoardHighlight()))},directives:[UA,NA,Ove,ax,pM,WM,ox,lx,LA],encapsulation:2,changeDetection:0}),e}(),gge=function(){var e=Wg(function e(){Zg(this,e)});return e.STEP_FINISHED=function(){return $localize(Cp||(Cp=_g(["Step finished!"])))},e.INFORMATIONAL_STEP=function(){return $localize(wp||(wp=_g(["This step is not expecting any move from your part."])))},e}();function yge(e,t){if(1&e&&(eP(0,"div",20),eP(1,"div",21),ZS(2,22),tP(),eP(3,"div",23),FP(4),tP(),tP()),2&e){var n=fP();pE(4),UP(n.currentReason.get())}}function mge(e,t){if(1&e){var n=aP();eP(0,"button",24),uP("click",function(){return Nk(n),fP().retry()}),ZS(1,25),tP()}}function kge(e,t){1&e&&(rP(0),ZS(1,30),iP())}function Cge(e,t){1&e&&(rP(0),ZS(1,31),iP())}function wge(e,t){if(1&e&&Yb(0,Cge,2,0,"ng-container",27),2&e){fP();var n=Kb(5),r=fP();Xb("ngIf",r.stepFinished&&r.stepFinished[r.stepIndex])("ngIfElse",n)}}function _ge(e,t){1&e&&(rP(0),ZS(1,32),iP())}function Ege(e,t){if(1&e){var n=aP();eP(0,"button",26),uP("click",function(){return Nk(n),fP().next()}),Yb(1,kge,2,0,"ng-container",27),Yb(2,wge,1,2,"ng-template",null,28,MT),Yb(4,_ge,2,0,"ng-template",null,29,MT),tP()}if(2&e){var r=Kb(3),i=fP();pE(1),Xb("ngIf",i.steps[i.stepIndex]&&i.steps[i.stepIndex].isInformation())("ngIfElse",r)}}function bge(e,t){if(1&e){var n=aP();eP(0,"button",33),uP("click",function(){return Nk(n),fP().start()}),ZS(1,34),tP()}}function Pge(e,t){if(1&e){var n=aP();eP(0,"button",35),uP("click",function(){return Nk(n),fP().playLocally()}),ZS(1,36),tP()}}function Sge(e,t){if(1&e){var n=aP();eP(0,"button",37),uP("click",function(){return Nk(n),fP().createGame()}),ZS(1,38),tP()}}function Oge(e,t){if(1&e){var n=aP();eP(0,"button",39),uP("click",function(){return Nk(n),fP().showSolution()}),ZS(1,40),tP()}}function Tge(e,t){if(1&e&&(rP(0),eP(1,"option",42),FP(2),tP(),iP()),2&e){var n=fP(),r=n.index,i=n.$implicit;pE(1),dP("id","step_",r,""),Xb("value",r),pE(1),UP(i.title)}}function Ige(e,t){1&e&&(rP(0),FP(1,"v "),iP())}function Age(e,t){1&e&&FP(0,"x ")}function Rge(e,t){if(1&e&&(eP(0,"option",43),Yb(1,Ige,2,0,"ng-container",27),Yb(2,Age,1,0,"ng-template",null,44,MT),eP(4,"span",45),FP(5),tP(),tP()),2&e){var n=Kb(3),r=fP(),i=r.index,a=r.$implicit,o=fP();Xb("value",i),pE(1),Xb("ngIf",o.stepFinished[i])("ngIfElse",n),pE(3),dP("id","step_",i,""),pE(1),UP(a.title)}}function Mge(e,t){if(1&e&&(rP(0),Yb(1,Tge,3,3,"ng-container",27),Yb(2,Rge,6,5,"ng-template",null,41,MT),iP()),2&e){var n=t.index,r=Kb(3),i=fP();pE(1),Xb("ngIf",n===i.stepIndex)("ngIfElse",r)}}var xge=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r,i,a,o,s){var u;return Zg(this,n),(u=t.call(this,e,r,s,i,a)).cdr=o,u.connectedUserService=s,u.COMPLETED_TUTORIAL_MESSAGE=$localize(_p||(_p=_g(["Congratulations, you completed the tutorial."]))),u.steps=[],u.successfulSteps=0,u.stepIndex=-1,u.currentMessage="",u.currentReason=fB.empty(),u.moveAttemptMade=!1,u.stepFinished=[],u.tutorialOver=!1,sB(n.VERBOSE,"TutorialGameWrapperComponent.constructor"),u.observerRole=R7.ZERO,u}return Wg(n,[{key:"getNumberOfSteps",value:function(){return this.steps.length}},{key:"getCurrentStepTitle",value:function(){return this.steps.length>0?this.steps[this.stepIndex].title:""}},{key:"ngAfterViewInit",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return sB(n.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),t.next=3,e.afterGameIncluderViewInit();case 3:if(t.t0=t.sent,!t.t0){t.next=6;break}e.start();case 6:case"end":return t.stop()}},t)}))()}},{key:"start",value:function(){this.startTutorial(this.gameComponent.tutorial)}},{key:"startTutorial",value:function(e){sB(n.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:e}}),this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}},{key:"getCompletionArray",value:function(){return this.steps.map(function(){return!1})}},{key:"changeStep",value:function(e){this.showStep(Number.parseInt(e.target.value,10))}},{key:"showStep",value:function(e){sB(n.VERBOSE,"tutorialGameWrapperComponent.showStep("+e+")"),this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;var t=this.steps[this.stepIndex];this.currentMessage=t.instruction,this.currentReason=fB.empty(),this.gameComponent.rules.node=new pte(t.state,fB.empty(),t.previousMove),this.gameComponent.updateBoard(),this.cdr.detectChanges()}},{key:"onLegalUserMove",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:sB(n.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:e}}),i=t.steps[t.stepIndex],v7(t.gameComponent.rules.choose(e),"It should be impossible to call onLegalUserMove with an illegal move"),sB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),t.gameComponent.updateBoard(),t.moveAttemptMade=!0,i.isPredicate()?(a=t.gameComponent.rules.node.mother.get().gameState,o=t.gameComponent.rules.node.gameState,(s=oB.getNonNullable(i.predicate)(e,a,o)).isSuccess()?t.showStepSuccess(i.getSuccessMessage()):t.currentReason=fB.of(s.getReason())):i.isAnyMove()?(sB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(i.getSuccessMessage())):(v7(i.isMove(),"cannot reach here with a click step"),(u=i).acceptedMoves.some(function(t){return t.equals(e)})?(sB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(u.getSuccessMessage())):(sB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),t.currentReason=fB.of(u.getFailureMessage()))),t.cdr.detectChanges();case 4:case"end":return r.stop()}},r)}))()}},{key:"retry",value:function(){sB(n.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}},{key:"onUserClick",value:function(e){var t=this;if(sB(n.VERBOSE,"tutorialGameWrapper.onUserClick("+e+")"),this.currentReason=fB.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return pB.failure(gge.STEP_FINISHED());var r=this.steps[this.stepIndex];return r.isClick()?(this.gameComponent.updateBoard(),this.moveAttemptMade=!0,oB.getNonNullable(r.acceptedClicks).some(function(t){return t===e})?this.showStepSuccess(r.getSuccessMessage()):this.currentMessage=r.getFailureMessage(),pB.SUCCESS):r.isMove()||r.isPredicate()||r.isAnyMove()?(window.setTimeout(function(){t.cdr.detectChanges()},10),pB.SUCCESS):pB.failure(gge.INFORMATIONAL_STEP())}},{key:"onCancelMove",value:function(e){sB(n.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+e+")"),void 0!==e&&(this.currentReason=fB.of(e)),this.cdr.detectChanges()}},{key:"showStepSuccess",value:function(e){sB(n.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}},{key:"updateSuccessCount",value:function(){var e,t=0,n=Hg(this.stepFinished);try{for(n.s();!(e=n.n()).done;){e.value&&t++}}catch(r){n.e(r)}finally{n.f()}this.successfulSteps=t}},{key:"next",value:function(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{for(var e=(this.stepIndex+1)%this.steps.length;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}},{key:"showSolution",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:sB(n.VERBOSE,"tutorialGameWrapper.showSolution()"),v7((r=e.steps[e.stepIndex]).hasSolution(),"step must have solution"),(a=(i=r).getSolution())instanceof ute?(e.showStep(e.stepIndex),e.gameComponent.rules.choose(a),e.gameComponent.updateBoard()):(e.showStep(e.stepIndex),window.document.querySelector(a).dispatchEvent(new Event("click"))),e.currentMessage=i.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges();case 5:case"end":return t.stop()}},t)}))()}},{key:"playLocally",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=oB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/local",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"createGame",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=oB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/play",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"getPlayer",value:function(){return"tutorial-player"}}]),n}(Ive);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Qb(iO),Qb(OD),Qb(jL),Qb(h7),Qb(NO),Qb(C7))},e.\u0275cmp=Gm({type:e,selectors:[["app-tutorial-game-wrapper"]],features:[Rb],decls:22,vars:15,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(Ep||(Ep=_g(["Failure"]))),["id","currentReason",1,"message-body"],["id","retryButton",1,"button","mr-3",3,"click"],$localize(bp||(bp=_g(["Try again"]))),["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],$localize(Pp||(Pp=_g(["Ok"]))),$localize(Sp||(Sp=_g(["Continue"]))),$localize(Op||(Op=_g(["Skip"]))),["id","restartButton",1,"button",3,"click"],$localize(Tp||(Tp=_g(["Try again"]))),["id","playLocallyButton",1,"button",3,"click"],$localize(Ip||(Ip=_g(["Play locally"]))),["id","playOnlineButton",1,"button",3,"click"],$localize(Ap||(Ap=_g(["Create an online game"]))),["id","showSolutionButton",1,"button",3,"click"],$localize(Rp||(Rp=_g(["See solution"]))),["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(eP(0,"div",0),eP(1,"div",1),eP(2,"div",2),nP(3,"progress",3),eP(4,"div",4),eP(5,"p",5),FP(6),tP(),nP(7,"p",6),tP(),Yb(8,yge,5,1,"div",7),eP(9,"div",8),Yb(10,mge,2,0,"button",9),Yb(11,Ege,6,2,"button",10),Yb(12,bge,2,0,"button",11),Yb(13,Pge,2,0,"button",12),Yb(14,Sge,2,0,"button",13),Yb(15,Oge,2,0,"button",14),eP(16,"div",15),eP(17,"select",16),uP("change",function(e){return t.changeStep(e)}),Yb(18,Mge,4,2,"ng-container",17),tP(),tP(),tP(),tP(),tP(),eP(19,"div",18),eP(20,"div",19),nP(21,"app-game-includer"),tP(),tP(),tP()),2&e&&(pE(3),$b("value",t.successfulSteps)("max",t.getNumberOfSteps()),pE(3),zP("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),pE(1),Xb("innerHTML",t.currentMessage,s_),pE(1),Xb("ngIf",t.currentReason.isPresent()),pE(2),Xb("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),pE(1),Xb("ngIf",!1===t.tutorialOver),pE(1),Xb("ngIf",t.tutorialOver),pE(1),Xb("ngIf",t.tutorialOver),pE(1),Xb("ngIf",t.tutorialOver),pE(1),Xb("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),pE(3),Xb("ngForOf",t.steps),pE(1),Xb("ngClass",t.getBoardHighlight()))},directives:[UA,LA,NA,Ove,ox,lx],encapsulation:2,changeDetection:0}),e}();function Nge(e,t){if(1&e&&(eP(0,"div",35),eP(1,"div",36),ZS(2,37),tP(),eP(3,"div",38),FP(4),tP(),tP()),2&e){var n=fP();pE(4),UP(n.errorMessage)}}var Dge=function(){return["/login"]},Lge=function(){var e=function(){function e(t,n){Zg(this,e),this.authService=t,this.router=n,this.faEye=K7,this.registrationForm=new BM({email:new VM,username:new VM,password:new VM})}return Wg(e,[{key:"registerWithEmail",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.registrationForm.value.username,r=e.registrationForm.value.email,i=e.registrationForm.value.password,null!=n&&null!=r&&null!=i){t.next=5;break}e.errorMessage=$localize(Mp||(Mp=_g(["There are missing fields in the registration form, please check that you filled in all fields."]))),t.next=21;break;case 5:return t.next=7,e.authService.doRegister(n,r,i);case 7:if(!(a=t.sent).isSuccess()){t.next=20;break}return t.next=11,e.authService.sendEmailVerification();case 11:if(!(o=t.sent).isSuccess()){t.next=17;break}return t.next=15,e.router.navigate(["/verify-account"]);case 15:t.next=18;break;case 17:e.errorMessage=o.getReason();case 18:t.next=21;break;case 20:e.errorMessage=a.getReason();case 21:case"end":return t.stop()}},t)}))()}},{key:"registerWithGoogle",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.doGoogleLogin();case 2:if(!(n=t.sent).isSuccess()){t.next=8;break}return t.next=6,e.router.navigate(["/verify-account"]);case 6:t.next=9;break;case 8:e.errorMessage=n.getReason();case 9:case"end":return t.stop()}},t)}))()}},{key:"getPasswordHelpClass",value:function(){var e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}},{key:"canRegister",value:function(){var e,t,n,r=null!==(e=this.registrationForm.value.password)&&void 0!==e?e:"";return!(""===(null!==(t=this.registrationForm.value.email)&&void 0!==t?t:"")||""===(null!==(n=this.registrationForm.value.username)&&void 0!==n?n:"")||""===r||r.length<6)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(C7),Qb(jL))},e.\u0275cmp=Gm({type:e,selectors:[["app-register"]],decls:56,vars:7,consts:function(){return[[1,"box"],[1,"title"],$localize(xp||(xp=_g(["Registering"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(Np||(Np=_g(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",$localize(Dp||(Dp=_g(["Email"]))),"type","email","autofocus","","required","",1,"input"],[1,"help"],$localize(Lp||(Lp=_g(["A confirmation email will be sent to validate your account."]))),["for","username",1,"label"],$localize(Fp||(Fp=_g(["Username"]))),["id","username","formControlName","username","name","username","placeholder",$localize(Up||(Up=_g(["Username"]))),"type","text","required","",1,"input"],["for","password",1,"label"],$localize(Vp||(Vp=_g(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",$localize(Bp||(Bp=_g(["Password"]))),"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],$localize(zp||(zp=_g(["The password should be at least 6 characters long"]))),["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(Hp||(Hp=_g(["Register"]))),[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(Gp||(Gp=_g(["Register with Google"]))),[1,"help","level-right"],$localize($p||($p=_g(["Have an account?"]))),[3,"routerLink"],$localize(Zp||(Zp=_g(["Log in"]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(qp||(qp=_g(["Registration error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(eP(0,"div",0),eP(1,"p",1),ZS(2,2),tP(),eP(3,"form",3),eP(4,"div",4),eP(5,"div",5),eP(6,"label",6),ZS(7,7),tP(),tP(),eP(8,"div",8),eP(9,"div",9),eP(10,"div",10),nP(11,"input",11),eP(12,"p",12),ZS(13,13),tP(),tP(),tP(),tP(),tP(),eP(14,"div",4),eP(15,"div",5),eP(16,"label",14),ZS(17,15),tP(),tP(),eP(18,"div",8),eP(19,"div",9),eP(20,"div",10),nP(21,"input",16),tP(),tP(),tP(),tP(),eP(22,"div",4),eP(23,"div",5),eP(24,"label",17),ZS(25,18),tP(),tP(),eP(26,"div",8),eP(27,"div",9),eP(28,"div",19),nP(29,"input",20),eP(30,"span",21),nP(31,"fa-icon",22),tP(),eP(32,"p",23),ZS(33,24),tP(),tP(),tP(),tP(),tP(),eP(34,"div",4),nP(35,"div",5),eP(36,"div",8),eP(37,"div",9),eP(38,"div",10),eP(39,"button",25),uP("click",function(){return t.registerWithEmail()}),ZS(40,26),tP(),tP(),tP(),tP(),tP(),eP(41,"div",4),nP(42,"div",5),eP(43,"div",27),Yb(44,Nge,5,1,"div",28),tP(),tP(),eP(45,"div",4),nP(46,"div",5),eP(47,"div",8),eP(48,"button",29),uP("click",function(){return t.registerWithGoogle()}),ZS(49,30),tP(),tP(),tP(),eP(50,"p",31),rP(51),ZS(52,32),iP(),FP(53,"\xa0 "),eP(54,"a",33),ZS(55,34),tP(),tP(),tP(),tP()),2&e&&(pE(3),Xb("formGroup",t.registrationForm),pE(28),Xb("icon",t.faEye),pE(1),Xb("ngClass",t.getPasswordHelpClass()),pE(7),Xb("disabled",!t.canRegister()),pE(5),Xb("ngIf",t.errorMessage),pE(10),Xb("routerLink",aT(6,Dge)))},directives:[jM,gM,ex,VR,pM,nx,Qde,hx,Eee,Xde,NA,UA,QL],encapsulation:2}),e}(),Fge=function(){var e=function(){function e(t){Zg(this,e),this.router=t}return Wg(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"playLocally",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["local/"+e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(jL))},e.\u0275cmp=Gm({type:e,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playLocally",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(Wp||(Wp=_g(["Play offline"])))]},template:function(e,t){1&e&&(eP(0,"app-pick-game",0),uP("pickGame",function(e){return t.pickGame(e)}),tP(),eP(1,"button",1),uP("click",function(){return t.playLocally()}),ZS(2,2),tP()),2&e&&(pE(1),Xb("disabled",!t.selectedGame))},directives:[qde],encapsulation:2}),e}(),Uge=function(){var e=function(){function e(t){Zg(this,e),this.router=t}return Wg(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"launchTutorial",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/tutorial/",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(jL))},e.\u0275cmp=Gm({type:e,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(jp||(jp=_g(["Learn the rules"])))]},template:function(e,t){1&e&&(eP(0,"app-pick-game",0),uP("pickGame",function(e){return t.pickGame(e)}),tP(),eP(1,"button",1),uP("click",function(){return t.launchTutorial()}),ZS(2,2),tP()),2&e&&(pE(1),Xb("disabled",!t.selectedGame))},directives:[qde],encapsulation:2}),e}(),Vge=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Gm({type:e,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){return[$localize(Yp||(Yp=_g(["The replay game is loading, please wait, it should not take long."])))]},template:function(e,t){1&e&&(eP(0,"p"),ZS(1,0),tP())},encapsulation:2}),e}();function Bge(e,t){if(1&e&&(cC(),nP(0,"polygon",4)),2&e){var n=fP();Xb("id",n.mainShapeId)("ngClass",n.pieceClasses),$b("points",n.MartianChessQueenComponent.HEPTAGON)}}function zge(e,t){if(1&e&&(cC(),nP(0,"polygon",4)),2&e){var n=fP();Xb("id",n.mainShapeId)("ngClass",n.pieceClasses),$b("points",n.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function Hge(e,t){if(1&e&&(cC(),nP(0,"circle",5)),2&e){var n=fP();Xb("id",n.mainShapeId)("ngClass",n.pieceClasses),$b("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function Gge(e,t){if(1&e&&(rP(0),cC(),nP(1,"circle",6),nP(2,"circle",6),nP(3,"circle",6),iP()),2&e){var n=fP();pE(1),$b("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(3)),pE(1),$b("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(2)),pE(1),$b("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(1))}}function $ge(e,t){if(1&e&&(cC(),eP(0,"g"),nP(1,"circle",7),nP(2,"circle",7),nP(3,"circle",7),tP()),2&e){var n=fP();pE(1),$b("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.45*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),pE(1),$b("cx",.45*n.MartianChessComponent.SPACE_SIZE)("cy",.55*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),pE(1),$b("cx",.55*n.MartianChessComponent.SPACE_SIZE)("cy",.55*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function Zge(e,t){if(1&e&&(cC(),eP(0,"g",8),nP(1,"circle",9),nP(2,"circle",9),nP(3,"circle",9),tP()),2&e){var n=fP();Xb("ngClass",n.pieceClasses),pE(1),$b("cx",.5*n.MartianChessComponent.SPACE_SIZE-3*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),pE(1),$b("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),pE(1),$b("cx",.5*n.MartianChessComponent.SPACE_SIZE+3*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}var qge=Wg(function e(){Zg(this,e),this.MartianChessQueenComponent=e,this.MartianChessComponent=Due,this.horizontalDotsRadius=Due.SPACE_SIZE/15});function Wge(e,t){if(1&e&&(cC(),nP(0,"polygon",4)),2&e){var n=fP();Xb("id",n.mainShapeId)("ngClass",n.pieceClasses),$b("points",n.MartianChessDroneComponent.PENTAGON)}}function jge(e,t){if(1&e&&(cC(),nP(0,"polygon",4)),2&e){var n=fP();Xb("id",n.mainShapeId)("ngClass",n.pieceClasses),$b("points",n.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function Yge(e,t){if(1&e&&(cC(),nP(0,"circle",5)),2&e){var n=fP();Xb("id",n.mainShapeId)("ngClass",n.pieceClasses),$b("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function Kge(e,t){if(1&e&&(rP(0),cC(),nP(1,"circle",6),nP(2,"circle",6),iP()),2&e){var n=fP();pE(1),$b("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(2)),pE(1),$b("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(1))}}function Qge(e,t){if(1&e&&(cC(),eP(0,"g",7),nP(1,"circle",8),nP(2,"circle",8),tP()),2&e){var n=fP();Xb("ngClass",n.pieceClasses),pE(1),$b("cx",.4*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),pE(1),$b("cx",.6*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function Xge(e,t){if(1&e&&(cC(),eP(0,"g",7),nP(1,"circle",9),nP(2,"circle",9),tP()),2&e){var n=fP();Xb("ngClass",n.pieceClasses),pE(1),$b("cx",.5*n.MartianChessComponent.SPACE_SIZE-2*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),pE(1),$b("cx",.5*n.MartianChessComponent.SPACE_SIZE+2*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}qge.HEPTAGON=Due.getRegularPolygon(7),qge.EIGHT_POINTED_STAR=Due.getNPointedStar(8,0),qge.\u0275fac=function(e){return new(e||qge)},qge.\u0275cmp=Gm({type:qge,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(Yb(0,Bge,1,3,"polygon",0),Yb(1,zge,1,3,"polygon",0),Yb(2,Hge,1,5,"circle",1),Yb(3,Gge,4,9,"ng-container",2),Yb(4,$ge,4,9,"g",2),Yb(5,Zge,4,10,"g",3)),2&e&&(Xb("ngIf","Polygon"===t.style.shape),pE(1),Xb("ngIf","Star"===t.style.shape),pE(1),Xb("ngIf","Circle"===t.style.shape),pE(1),Xb("ngIf","Concentric Circles"===t.style.points),pE(1),Xb("ngIf","Dots"===t.style.points),pE(1),Xb("ngIf","Horizontal Points"===t.style.points))},directives:[UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Jge=Wg(function e(){Zg(this,e),this.MartianChessComponent=Due,this.MartianChessDroneComponent=e,this.horizontalDotsRadius=Due.SPACE_SIZE/15});function eye(e,t){if(1&e&&(cC(),nP(0,"polygon",5)),2&e){var n=fP();Xb("id",n.mainShapeId)("ngClass",n.pieceClasses),$b("points",n.MartianChessPawnComponent.TRIANGLE)}}function tye(e,t){if(1&e&&(cC(),nP(0,"polygon",5)),2&e){var n=fP();Xb("id",n.mainShapeId)("ngClass",n.pieceClasses),$b("points",n.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function nye(e,t){if(1&e&&(cC(),nP(0,"circle",6)),2&e){var n=fP();Xb("id",n.mainShapeId)("ngClass",n.pieceClasses),$b("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function rye(e,t){if(1&e&&(cC(),nP(0,"circle",7)),2&e){var n=fP();$b("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE+n.getConcreteTriangleYOffset())("r",n.MartianChessComponent.getRadius(1))}}function iye(e,t){if(1&e&&(cC(),nP(0,"circle",8)),2&e){var n=fP();$b("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function aye(e,t){if(1&e&&(cC(),eP(0,"g",9),nP(1,"circle",10),tP()),2&e){var n=fP();Xb("ngClass",n.pieceClasses),pE(1),$b("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}Jge.FOUR_POINTED_STAR_VERTICAL=Due.getNPointedStar(4,0),Jge.PENTAGON=Due.getRegularPolygon(5),Jge.\u0275fac=function(e){return new(e||Jge)},Jge.\u0275cmp=Gm({type:Jge,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(Yb(0,Wge,1,3,"polygon",0),Yb(1,jge,1,3,"polygon",0),Yb(2,Yge,1,5,"circle",1),Yb(3,Kge,3,6,"ng-container",2),Yb(4,Qge,3,7,"g",3),Yb(5,Xge,3,7,"g",3)),2&e&&(Xb("ngIf","Polygon"===t.style.shape),pE(1),Xb("ngIf","Star"===t.style.shape),pE(1),Xb("ngIf","Circle"===t.style.shape),pE(1),Xb("ngIf","Concentric Circles"===t.style.points),pE(1),Xb("ngIf","Dots"===t.style.points),pE(1),Xb("ngIf","Horizontal Points"===t.style.points))},directives:[UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var oye=function(){function e(){Zg(this,e),this.MartianChessComponent=Due,this.MartianChessPawnComponent=e,this.horizontalDotsRadius=Due.SPACE_SIZE/15}return Wg(e,[{key:"getConcreteTriangleYOffset",value:function(){return"Polygon"===this.style.shape?e.TRIANGLE_Y_OFFSET:0}}],[{key:"getTriangle",value:function(){return Due.getRegularPolygon(3,e.TRIANGLE_Y_OFFSET)}},{key:"yOffsetForVerticalCentering",value:function(){var e=Due.getRegularPolygonCoords(3).map(function(e){return e.y});return(e.reduce(function(e,t){return Math.min(e,t)})+(100-e.reduce(function(e,t){return Math.max(e,t)})))/4}}]),e}();oye.FOUR_POINTED_STAR_DIAGONAL=Due.getNPointedStar(4,45),oye.TRIANGLE_Y_OFFSET=oye.yOffsetForVerticalCentering(),oye.TRIANGLE=oye.getTriangle(),oye.\u0275fac=function(e){return new(e||oye)},oye.\u0275cmp=Gm({type:oye,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(Yb(0,eye,1,3,"polygon",0),Yb(1,tye,1,3,"polygon",0),Yb(2,nye,1,5,"circle",1),Yb(3,rye,1,3,"circle",2),Yb(4,iye,1,3,"circle",3),Yb(5,aye,2,4,"g",4)),2&e&&(Xb("ngIf","Polygon"===t.style.shape),pE(1),Xb("ngIf","Star"===t.style.shape),pE(1),Xb("ngIf","Circle"===t.style.shape),pE(1),Xb("ngIf","Concentric Circles"===t.style.points),pE(1),Xb("ngIf","Dots"===t.style.points),pE(1),Xb("ngIf","Horizontal Points"===t.style.points))},directives:[UA,NA],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var sye={apiKey:"AIzaSyAt5QHXLnm2Uf9X7VN6XPPiSaipoh3oRHo",authDomain:"firestore-c9d47.firebaseapp.com",databaseURL:"https://firestore-c9d47.firebaseio.com",projectId:"firestore-c9d47",storageBucket:"firestore-c9d47.appspot.com",messagingSenderId:"936588361631",appId:"1:936588361631:web:2c059886d8d427edbac7aa"},uye=function(){var e=function(){function e(t){Zg(this,e),this.authService=t}return Wg(e,[{key:"canActivate",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t){var n;e.userSub=e.authService.subscribeToUser((n=aB(regeneratorRuntime.mark(function n(r){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.evaluateUserPermission(r).then(t);case 2:case"end":return n.stop()}},n)})),function(e){return n.apply(this,arguments)}))}));case 1:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(pw(C7))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),cye=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e)).router=r,i}return Wg(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!1!==e.verified||t.router.parseUrl("/verify-account"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(uye);return e.\u0275fac=function(t){return new(t||e)(pw(C7),pw(jL))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function lye(e,t){1&e&&(eP(0,"p",20),ZS(1,21),tP())}function fye(e,t){if(1&e){var n=aP();eP(0,"div",7),eP(1,"p",8),ZS(2,9),tP(),eP(3,"div",10),eP(4,"p",11),ZS(5,12),tP(),eP(6,"button",13),uP("click",function(){return Nk(n),fP().finalizeEmailVerification()}),ZS(7,14),tP(),tP(),eP(8,"div",15),eP(9,"p",11),ZS(10,16),tP(),eP(11,"button",17),uP("click",function(){return Nk(n),fP().sendEmailVerification()}),ZS(12,18),tP(),tP(),Yb(13,lye,2,0,"p",19),tP()}if(2&e){var r=fP();pE(2),qS(r.emailAddress),WS(2),pE(11),Xb("ngIf",r.success)}}function hye(e,t){if(1&e){var n=aP();eP(0,"div",24),eP(1,"div",8),ZS(2,25),tP(),eP(3,"form",26),eP(4,"div",27),eP(5,"div",28),nP(6,"input",29),tP(),eP(7,"div",28),eP(8,"button",30),uP("click",function(){Nk(n);var e=fP(2);return e.pickUsername(e.usernameForm.value)}),ZS(9,31),tP(),tP(),tP(),tP(),tP()}if(2&e){var r=fP(2);pE(3),Xb("formGroup",r.usernameForm)}}var dye=function(){return["/lobby"]};function vye(e,t){1&e&&(eP(0,"div",32),GS(1,33),nP(2,"a",34),$S(),tP()),2&e&&(pE(2),Xb("routerLink",aT(1,dye)))}function pye(e,t){if(1&e&&(rP(0),Yb(1,hye,10,1,"div",22),Yb(2,vye,3,2,"div",23),iP()),2&e){var n=fP();pE(1),Xb("ngIf",!n.success),pE(1),Xb("ngIf",n.success)}}function gye(e,t){if(1&e&&(eP(0,"div",35),eP(1,"div",36),FP(2),tP(),tP()),2&e){var n=fP();pE(2),UP(n.errorMessage)}}var yye=function(){var e=function(){function e(t,n){Zg(this,e),this.authService=t,this.router=n,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new BM({username:new VM})}return Wg(e,[{key:"ngOnInit",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.userSub=e.authService.subscribeToUser(function(){var t=aB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.emailAddress=n.email.get(),!n.username.isAbsent()){t.next=5;break}e.verificationType="enter-username",t.next=11;break;case 5:if(e.verificationType="send-email",!0===e.triedToFinalize&&!1===n.verified&&(e.errorMessage=$localize(Kp||(Kp=_g(["You have not verified your email! Click on the link in the verification email."])))),t.t0=!0===n.verified,!t.t0){t.next=11;break}return t.next=11,e.router.navigate(["/lobby"]);case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"pickUsername",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.authService.setUsername(e.username);case 2:(r=n.sent).isSuccess()?t.success=!0:t.errorMessage=r.getReason();case 4:case"end":return n.stop()}},n)}))()}},{key:"sendEmailVerification",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.sendEmailVerification();case 2:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=n.getReason();case 4:case"end":return t.stop()}},t)}))()}},{key:"finalizeEmailVerification",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.triedToFinalize=!0,t.next=3,e.authService.reloadUser();case 3:window.open(window.location.href,"_self");case 4:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){null!=this.userSub&&null!=this.userSub.unsubscribe&&this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(C7),Qb(jL))},e.\u0275cmp=Gm({type:e,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){return[[1,"box"],[1,"message","is-info"],[1,"message-header"],$localize(Qp||(Qp=_g(["Account verification"]))),["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],$localize(Xp||(Xp=_g(["In order to finalize your account, you must click on the link that you should have received on your email address (",":INTERPOLATION:). The email could be in your spam folder."])),"\ufffd0\ufffd"),[1,"block","level-left"],[1,"level-item"],$localize(Jp||(Jp=_g(["Once you have verified your email, click on the following button:"]))),["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],$localize(eg||(eg=_g(["Finalize email verification"]))),[1,"level-left"],$localize(tg||(tg=_g(["If you have not received the verification email, click on the following button:"]))),["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],$localize(ng||(ng=_g(["Send verification email again"]))),["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],$localize(rg||(rg=_g(["The email has been sent"]))),["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],$localize(ig||(ig=_g(["In order to finalize your account, you must choose a username."]))),[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",$localize(ag||(ag=_g(["Username"]))),"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],$localize(og||(og=_g(["Pick username"]))),["id","success",1,"message-body"],$localize(sg||(sg=_g(["Your account has now been finalized, you can go back to the ",":START_LINK:list of games",":CLOSE_LINK:."])),"\ufffd#2\ufffd","\ufffd/#2\ufffd"),[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(eP(0,"div",0),eP(1,"div",1),eP(2,"div",2),ZS(3,3),tP(),Yb(4,fye,14,2,"div",4),Yb(5,pye,3,2,"ng-container",5),tP(),Yb(6,gye,3,1,"div",6),tP()),2&e&&(pE(4),Xb("ngIf","send-email"===t.verificationType),pE(1),Xb("ngIf","enter-username"===t.verificationType),pE(1),Xb("ngIf",t.errorMessage))},directives:[UA,jM,gM,ex,VR,hx,pM,nx,QL],encapsulation:2}),e}(),mye=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e)).router=r,i}return Wg(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!e.verified||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(uye);return e.\u0275fac=function(t){return new(t||e)(pw(C7),pw(jL))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),kye=function(){var e=function(e){xg(n,e);var t=Dg(n);function n(e,r){var i;return Zg(this,n),(i=t.call(this,e)).router=r,i}return Wg(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(uye);return e.\u0275fac=function(t){return new(t||e)(pw(C7),pw(jL))},e.\u0275prov=dm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Cye(e,t){1&e&&(eP(0,"p",12),ZS(1,13),tP())}function wye(e,t){if(1&e&&(eP(0,"div",14),eP(1,"div",15),ZS(2,16),tP(),eP(3,"div",17),FP(4),tP(),tP()),2&e){var n=fP();pE(4),UP(n.errorMessage.get())}}var _ye=function(){return{standalone:!0}},Eye=function(){var e=function(){function e(t){Zg(this,e),this.authService=t,this.success=!1,this.errorMessage=fB.empty(),this.email=""}return Wg(e,[{key:"resetPassword",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return v7(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=fB.empty(),e.success=!1,t.next=3,e.authService.sendPasswordResetEmail(e.email);case 3:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=fB.of(n.getReason());case 5:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(C7))},e.\u0275cmp=Gm({type:e,selectors:[["app-reset-password"]],decls:12,vars:6,consts:function(){return[[1,"box"],[1,"title"],$localize(ug||(ug=_g(["Password reset"]))),[1,"field"],[1,"control"],["id","email","name","email","placeholder",$localize(cg||(cg=_g(["Email"]))),"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],$localize(lg||(lg=_g(["An email will be sent with instruction to reset your password."]))),["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],$localize(fg||(fg=_g(["Reset password"]))),["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],$localize(hg||(hg=_g(["The email has been sent, please follow the instructions from that email."]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(dg||(dg=_g(["Error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(eP(0,"div",0),eP(1,"p",1),ZS(2,2),tP(),eP(3,"div",3),eP(4,"div",4),eP(5,"input",5),uP("ngModelChange",function(e){return t.email=e}),tP(),eP(6,"p",6),ZS(7,7),tP(),Yb(8,Cye,2,0,"p",8),tP(),tP(),eP(9,"button",9),uP("click",function(){return t.resetPassword()}),ZS(10,10),tP(),Yb(11,wye,5,1,"div",11),tP()),2&e&&(pE(5),Xb("ngModel",t.email)("ngModelOptions",aT(5,_ye)),pE(3),Xb("ngIf",t.success),pE(1),Xb("disabled",""===t.email),pE(2),Xb("ngIf",t.errorMessage.isPresent()))},directives:[VR,Qde,hx,pM,WM,UA],encapsulation:2}),e}();function bye(e,t){if(1&e&&(eP(0,"option",13),FP(1),tP()),2&e){var n=t.$implicit,r=fP();Xb("value",n.value)("selected",n.value===r.currentTheme),pE(1),VP(" ",n.name," ")}}function Pye(e,t){if(1&e&&(eP(0,"option",13),FP(1),tP()),2&e){var n=t.$implicit,r=fP();Xb("value",n.value)("selected",n.value===r.currentLanguage),pE(1),VP(" ",n.name," ")}}var Sye=function(){var e=function(){function e(t,n){Zg(this,e),this.userSettingsService=t,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize(vg||(vg=_g(["Light"])))},{value:"dark",name:$localize(pg||(pg=_g(["Dark"])))}],this.currentTheme=n.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}return Wg(e,[{key:"changeLanguage",value:function(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}},{key:"changeTheme",value:function(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}},{key:"reload",value:function(){window.open(window.location.href,"_self")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(Z7),Qb(q7))},e.\u0275cmp=Gm({type:e,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){return[[1,"box"],[1,"title"],$localize(gg||(gg=_g(["User settings"]))),[1,"field"],["for","theme",1,"label"],$localize(yg||(yg=_g(["Theme"]))),[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],$localize(mg||(mg=_g(["Language"]))),["id","language",3,"change"],[3,"value","selected"]]},template:function(e,t){1&e&&(eP(0,"div",0),eP(1,"p",1),ZS(2,2),tP(),eP(3,"div",3),eP(4,"label",4),ZS(5,5),tP(),eP(6,"div",6),eP(7,"div",7),eP(8,"select",8),uP("change",function(e){return t.changeTheme(e)}),Yb(9,bye,2,3,"option",9),tP(),tP(),tP(),tP(),eP(10,"div",3),eP(11,"label",10),ZS(12,11),tP(),eP(13,"div",6),eP(14,"div",7),eP(15,"select",12),uP("change",function(e){return t.changeLanguage(e)}),Yb(16,Pye,2,3,"option",9),tP(),tP(),tP(),tP(),tP()),2&e&&(pE(9),Xb("ngForOf",t.availableThemes),pE(7),Xb("ngForOf",t.availableLanguages))},directives:[LA,ox,lx],encapsulation:2}),e}(),Oye=function(){var e=Wg(function e(){Zg(this,e)});return e.ALREADY_INGAME=function(){return $localize(kg||(kg=_g(["You are already in a game. Finish it or cancel it first."])))},e}(),Tye=function(){var e=function(){function e(t,n,r,i,a,o){Zg(this,e),this.route=t,this.router=n,this.connectedUserService=r,this.messageDisplayer=i,this.activePartsService=a,this.gameService=o}return Wg(e,[{key:"ngOnInit",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createGameAndRedirectOrShowError(e.extractGameFromURL());case 2:case"end":return t.stop()}},t)}))()}},{key:"extractGameFromURL",value:function(){return oB.getNonNullable(this.route.snapshot.paramMap.get("compo"))}},{key:"createGameAndRedirectOrShowError",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(v7((r=t.connectedUserService.user.get()).isConnected(),"User must be connected and have a username to reach this page"),i=r.toMinimalUser(),!1!==t.gameExists(e)){n.next=7;break}return n.next=6,t.router.navigate(["/notFound",Tve.NO_MATCHING_GAME(e)],{skipLocationChange:!0});case 6:case 19:return n.abrupt("return",!1);case 7:return n.next=9,t.canCreateOnlineGame(i);case 9:if(!n.sent){n.next=16;break}return n.next=12,t.gameService.createPartConfigRoomAndChat(e);case 12:return a=n.sent,n.next=15,t.router.navigate(["/play",e,a]);case 15:return n.abrupt("return",!0);case 16:return t.messageDisplayer.infoMessage(Oye.ALREADY_INGAME()),n.next=19,t.router.navigate(["/lobby"]);case 20:case"end":return n.stop()}},n)}))()}},{key:"gameExists",value:function(e){return fB.ofNullable(Zde.ALL_GAMES().find(function(t){return t.urlName===e})).isPresent()}},{key:"canCreateOnlineGame",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=!1,n.next=3,t.activePartsService.userHasActivePart(e);case 3:return n.t1=n.sent,n.abrupt("return",n.t0===n.t1);case 5:case"end":return n.stop()}},n)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Qb(OD),Qb(jL),Qb(C7),Qb(h7),Qb(ive),Qb(B7))},e.\u0275cmp=Gm({type:e,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){return[$localize(Cg||(Cg=_g(["Creating online game, please wait, it should not take long."])))]},template:function(e,t){1&e&&(eP(0,"p"),ZS(1,0),tP())},encapsulation:2}),e}();!function(e,t,n){!function(e,t,n){"string"!=typeof t&&(n=t,t=e[YP.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),ZP[t]=e,n&&(ZP[t][YP.ExtraData]=n)}(e,void 0,void 0)}(rB());var Iye=[{path:"login",component:nve},{path:"lobby",component:bve,canActivate:[cye]},{path:"settings",component:Sye},{path:"register",component:Lge,canActivate:[kye]},{path:"reset-password",component:Eye,canActivate:[kye]},{path:"notFound/:message",component:Pve},{path:"nextGameLoading",component:Vge,canActivate:[cye]},{path:"verify-account",component:yye,canActivate:[mye]},{path:"play",component:ave,canActivate:[cye]},{path:"play/:compo",component:Tye,canActivate:[cye]},{path:"play/:compo/:id",component:Kpe,canActivate:[cye]},{path:"local",component:Fge},{path:"local/:compo",component:pge},{path:"tutorial",component:Uge},{path:"tutorial/:compo",component:xge},{path:"",component:Kde},{path:"**",component:Pve}],Aye=function(){function e(){Zg(this,e)}return Wg(e,null,[{key:"app",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:x3,providers:[{provide:I3,useFactory:M3(e),multi:!0,deps:[eI,Ib,C3].concat(n)}]}}(function(){return N3(sye)})}},{key:"firestore",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:Z8,providers:[{provide:z8,useFactory:H8(e),multi:!0,deps:[eI,Ib,C3,T3,[new Ew,S8],[new Ew,d4]].concat(n)}]}}(function(){var e=X8();return e.toJSON(),e})}},{key:"auth",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:R8,providers:[{provide:O8,useFactory:T8(e),multi:!0,deps:[eI,Ib,C3,T3,[new Ew,d4]].concat(n)}]}}(function(){return x8()})}}]),e}(),Rye=function(){var e=Wg(function e(){Zg(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Wm({type:e,bootstrap:[Uee]}),e.\u0275inj=vm({providers:[C7,B7,V7,g7,c7,q7,{provide:HT,useValue:$7.getLocale()}],imports:[[Aye.app(),Aye.firestore(),Aye.auth(),PR,tN,cF.forRoot(Iye,{useHash:!1}),yx,gx,tB,bee]]}),e}();!function(e,t,n){var r=e.\u0275cmp;r.directiveDefs=function(){return t.map($m)},r.pipeDefs=function(){return n.map(Zm)}}(Due,[LA,NA,UA,oye,Jge,qge],[]),"undefined"!=typeof window&&window,"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,"undefined"!=typeof global&&global;var Mye=function(){function e(t){Zg(this,e),this.digits=t}return Wg(e,[{key:"clone",value:function(){return new e(this.digits.slice())}},{key:"add",value:function(e){var t=this.clone();return t.addToSelf(e),t}},{key:"addToSelf",value:function(e){for(var t=Math.max(this.digits.length,e.digits.length),n=0,r=0;r<t;r++){var i=n;r<this.digits.length&&(i+=this.digits[r]),r<e.digits.length&&(i+=e.digits[r]),i>=10?(this.digits[r]=i-10,n=1):(this.digits[r]=i,n=0)}n>0&&(this.digits[t]=1)}},{key:"toString",value:function(){for(var e="",t=this.digits.length-1;t>=0;t--)e+=this.digits[t];return e}}],[{key:"zero",value:function(){return new e([0])}},{key:"one",value:function(){return new e([1])}}]),e}(),xye=function(){function e(t){Zg(this,e),this.powerOfTwos=[t]}return Wg(e,[{key:"getValue",value:function(){return this.powerOfTwos[0]}},{key:"multiplyBy",value:function(e){var t=Mye.zero();return this.multiplyByAndAddTo(e,t),t}},{key:"multiplyByAndAddTo",value:function(e,t){for(var n=0;0!==e;e>>>=1,n++)if(1&e){var r=this.getMultipliedByPowerOfTwo(n);t.addToSelf(r)}}},{key:"getMultipliedByPowerOfTwo",value:function(e){for(var t=this.powerOfTwos.length;t<=e;t++){var n=this.powerOfTwos[t-1];this.powerOfTwos[t]=n.add(n)}return this.powerOfTwos[e]}}]),e}(),Nye=function(){function e(t){Zg(this,e),this.base=t,this.exponents=[new xye(Mye.one())]}return Wg(e,[{key:"toThePowerOf",value:function(e){for(var t=this.exponents.length;t<=e;t++){var n=this.exponents[t-1].multiplyBy(this.base);this.exponents[t]=new xye(n)}return this.exponents[e]}}]),e}();function Dye(e){var t=function(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r>=55296&&r<=56319&&e.length>n+1){var i=e.charCodeAt(n+1);i>=56320&&i<=57343&&(n++,r=(r-55296<<10)+i-56320+65536)}r<=127?t.push(r):r<=2047?t.push(r>>6&31|192,63&r|128):r<=65535?t.push(r>>12|224,r>>6&63|128,63&r|128):r<=2097151&&t.push(r>>18&7|240,r>>12&63|128,r>>6&63|128,63&r|128)}return t}(e),n=Lye(t,0),r=Lye(t,102072);return 0==n&&(0==r||1==r)&&(n^=319790063,r^=-1801410264),[n,r]}function Lye(e,t){var n,r=2654435769,i=2654435769,a=e.length;for(n=0;n+12<=a;n+=12){var o=Fye(r=Vye(r,Gye(e,n,Uye.Little)),i=Vye(i,Gye(e,n+4,Uye.Little)),t=Vye(t,Gye(e,n+8,Uye.Little)));r=o[0],i=o[1],t=o[2]}return r=Vye(r,Gye(e,n,Uye.Little)),i=Vye(i,Gye(e,n+4,Uye.Little)),t=Vye(t,a),Fye(r,i,t=Vye(t,Gye(e,n+8,Uye.Little)<<8))[2]}function Fye(e,t,n){return e=zye(e,t),e=zye(e,n),e^=n>>>13,t=zye(t,n),t=zye(t,e),t^=e<<8,n=zye(n,e),n=zye(n,t),n^=t>>>13,e=zye(e,t),e=zye(e,n),e^=n>>>12,t=zye(t,n),t=zye(t,e),t^=e<<16,n=zye(n,e),n=zye(n,t),n^=t>>>5,e=zye(e,t),e=zye(e,n),e^=n>>>3,t=zye(t,n),t=zye(t,e),t^=e<<10,n=zye(n,e),n=zye(n,t),[e,t,n^=t>>>15]}var Uye=((Uye=Uye||{})[Uye.Little=0]="Little",Uye[Uye.Big=1]="Big",Uye);function Vye(e,t){return Bye(e,t)[1]}function Bye(e,t){var n=(65535&e)+(65535&t),r=(e>>>16)+(t>>>16)+(n>>>16);return[r>>>16,r<<16|65535&n]}function zye(e,t){var n=(65535&e)-(65535&t);return(e>>16)-(t>>16)+(n>>16)<<16|65535&n}function Hye(e,t){return t>=e.length?0:e[t]}function Gye(e,t,n){var r=0;if(n===Uye.Big)for(var i=0;i<4;i++)r+=Hye(e,t+i)<<24-8*i;else for(var a=0;a<4;a++)r+=Hye(e,t+a)<<8*a;return r}var $ye=new Nye(256);function Zye(e,t){if(":"!==t.charAt(0))return{text:e};var n=function(e,t){for(var n=1,r=1;n<e.length;n++,r++)if("\\"===t[r])r++;else if(":"===e[n])return n;throw new Error('Unterminated $localize metadata block in "'.concat(t,'".'))}(e,t);return{block:e.substring(1,n),text:e.substring(n+1)}}function qye(e){return 1===e?"PH":"PH_"+(e-1)}Object.keys({useClass:null}),Object.keys({useFactory:null}),Object.keys({useValue:null}),Object.keys({useExisting:null});var Wye=function(e){xg(n,e);var t=Dg(n);function n(e){var r;return Zg(this,n),(r=t.call(this,"No translation found for ".concat(Yye(e),"."))).parsedMessage=e,r.type="MissingTranslationError",r}return Wg(n)}(Ig(Error));function jye(e,t){return Object.defineProperty(e,"raw",{value:t}),e}function Yye(e){var t=e.meaning&&' - "'.concat(e.meaning,'"'),n=e.legacyIds&&e.legacyIds.length>0?" [".concat(e.legacyIds.map(function(e){return'"'.concat(e,'"')}).join(", "),"]"):"";return'"'.concat(e.id,'"').concat(n,' ("').concat(e.text,'"').concat(t,")")}function Kye(e,t){try{return function(e,t,n){var r=function(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a={},o={},s=function(e,t){var n=Zye(e,t),r=n.text,i=n.block;if(void 0===i)return{text:r};var a=wg(i.split("\u241f")),o=a[0],s=a.slice(1),u=Sg(o.split("@@",2),2),c=u[0],l=u[1],f=Sg(c.split("|",2),2),h=f[0],d=f[1];return void 0===d&&(d=h,h=void 0),""===d&&(d=void 0),{text:r,meaning:h,description:d,customId:l,legacyIds:s}}(e[0],e.raw[0]),u=[s.text],c=[],l=s.text,f=1;f<e.length;f++){var h=Zye(e[f],e.raw[f]),d=h.text,v=h.block,p=void 0===v?qye(f):v;l+="{$".concat(p,"}").concat(d),void 0!==t&&(a[p]=t[f-1],o[p]=i[f-1]),c.push(p),u.push(d)}var g=s.customId||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Dye(e);if(t){var r=Dye(t);n=function(e,t){var n=e[0],r=t[0],i=Bye(e[1],t[1]),a=i[0],o=i[1];return[Vye(Vye(n,r),a),o]}(function(e,t){var n=e[0],r=e[1];return[n<<1|r>>>31,r<<1|n>>>31]}(n),r)}return function(e,t){var n=$ye.toThePowerOf(0).multiplyBy(t);return $ye.toThePowerOf(4).multiplyByAndAddTo(e,n),n.toString()}(2147483647&n[0],n[1])}(l,s.meaning||""),y=s.legacyIds?s.legacyIds.filter(function(e){return e!==g}):[];return{id:g,legacyIds:y,substitutions:a,substitutionLocations:o,text:l,customId:s.customId,meaning:s.meaning||"",description:s.description||"",messageParts:u,messagePartLocations:r,placeholderNames:c,location:n}}(t,n),i=e[r.id];if(void 0!==r.legacyIds)for(var a=0;a<r.legacyIds.length&&void 0===i;a++)i=e[r.legacyIds[a]];if(void 0===i)throw new Wye(r);return[i.messageParts,i.placeholderNames.map(function(e){if(r.substitutions.hasOwnProperty(e))return r.substitutions[e];throw new Error("There is a placeholder name mismatch with the translation provided for the message ".concat(Yye(r),".\nThe translation contains a placeholder with name ").concat(e,", which does not exist in the message."))})]}($localize.TRANSLATIONS,e,t)}catch(n){return console.warn(n.message),[e,t]}}function Qye(){(function(){if(hI)throw new Error("Cannot enable prod mode after platform setup.");fI=!1})(),ER().bootstrapModule(Rye).catch(function(e){return console.error(e)})}var Xye=$7.getLocale();"en"!==Xye?fetch("/assets/"+Xye+".json").then(function(e){return e.ok?e.json():{locale:"en",translations:{}}}).then(function(e){(function(e){$localize.translate||($localize.translate=Kye),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(e).forEach(function(t){$localize.TRANSLATIONS[t]=function(e){for(var t=e.split(/{\$([^}]*)}/),n=[t[0]],r=[],i=1;i<t.length-1;i+=2)r.push(t[i]),n.push("".concat(t[i+1]));var a=n.map(function(e){return":"===e.charAt(0)?"\\"+e:e});return{text:e,messageParts:jye(n,a),placeholderNames:r}}(e[t])})})(e.translations),$localize.locale=e.locale,Qye()}).catch(function(e){console.log(e)}):Qye()}},function(e){e(e.s=6607)}])}();