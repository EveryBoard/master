(self.webpackChunkEveryBoard=self.webpackChunkEveryBoard||[]).push([[179],{8255:function(e){function t(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=8255,e.exports=t},9575:function(e,t,n){var r,i,s;!function(o){if("object"==typeof e.exports){var a=o(0,t);void 0!==a&&(e.exports=a)}else i=[n,t],void 0!==(s="function"==typeof(r=o)?r.apply(t,i):r)&&(e.exports=s)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0;t.default=["fr",[["AM","PM"],n,n],n,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],n,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],n,[["av. J.-C.","ap. J.-C."],n,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1} '\xe0' {0}",n,n],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[n,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[n,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[n,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[n,"\xa5"],KMF:[n,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[n,"$C"],NZD:["$NZ","$"],RHD:["$RH"],RON:[n,"L"],RWF:[n,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[n,"$T"],TTD:["$TT","$"],TWD:[n,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[n,"$"],XPF:["FCFP"],ZMW:[n,"Kw"]},"ltr",function(e){var t=Math.floor(Math.abs(e));return 0===t||1===t?1:5}]})},5378:function(e,t){!function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(e){for(var n,r=1;r<arguments.length;r++)n=arguments[r]??{},r%2?t(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))});return e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function s(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(){var e;return null!==(e=h)&&void 0!==e?e:document}var l={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},c=n({},l),u={},h=null,d=function(e,t,n,r,i){return"top-left"===e?"left:".concat(r,";top:").concat(t,";text-align:left;align-items:flex-start;"):"top-right"===e?"right:".concat(i,";top:").concat(t,";text-align:right;align-items:flex-end;"):"top-center"===e?"top:".concat(t,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===e?"left:".concat(r,";bottom:").concat(n,";text-align:left;align-items:flex-start;"):"bottom-right"===e?"right:".concat(i,";bottom:").concat(n,";text-align:right;align-items:flex-end;"):"bottom-center"===e?"bottom:".concat(n,";left:0;right:0;text-align:center;align-items:center;"):"center"===e?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0},f=function(){function e(t){var n=this;r(this,e),this.element=a().createElement("div"),this.opacity=t.opacity,this.type=t.type,this.animate=t.animate,this.dismissible=t.dismissible,this.closeOnClick=t.closeOnClick,this.message=t.message,this.duration=t.duration,this.pauseOnHover=t.pauseOnHover,this.offsetTop=t.offsetTop,this.offsetBottom=t.offsetBottom,this.offsetLeft=t.offsetLeft,this.offsetRight=t.offsetRight,this.extraClasses=t.extraClasses;var i="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),s=["notification",this.extraClasses];if(this.type&&s.push(this.type),this.animate&&this.animate.in){var o="animate__".concat(this.animate.in),l=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";s.push("animate__animated ".concat(o," ").concat(l)),this.onAnimationEnd(function(){return n.element.classList.remove(o)})}if(this.element.className=s.join(" "),this.dismissible){var c=a().createElement("button");c.className="delete",c.addEventListener("click",function(){n.destroy()}),this.element.insertAdjacentElement("afterbegin",c)}else i+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){n.destroy()}),this.element.setAttribute("style",i),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var u=new p(function(){n.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){u.pause()}),this.element.addEventListener("mouseout",function(){u.resume()}))}return s(e,[{key:"destroy",value:function(){var e=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){e.removeParent(e.element.parentNode),e.element.remove(),delete u.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete u.position)}},{key:"removeParent",value:function(e){e&&1>=e.children.length&&e.remove()}},{key:"onAnimationEnd",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var n in t)if(void 0!==this.element.style[n]){this.element.addEventListener(t[n],function(){return e()});break}}}]),e}(),p=function(){function e(t,n){r(this,e),this.remaining=n,this.callback=t,this.resume()}return s(e,[{key:"pause",value:function(){"undefined"==typeof document||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){"undefined"==typeof document||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),e}();e.resetDefaults=function(){c=n({},l)},e.setDefaults=function(e){c=n(n({},l),e)},e.setDoc=function(e){for(var t in u)u[t].remove();u={},h=e},e.toast=function(e){if(!e.message)throw new Error("message is required");var t=n(n({},c),e),r=new f(t),i=function(e,t,n,r,i,s){if(u.position)return u.position;var o=a().createElement("div");return o.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+d(t,n,r,i,s)),e.appendChild(o),u.position=o,o}(t.appendTo||a().body,t.position||c.position,t.offsetTop||c.offsetTop,t.offsetBottom||c.offsetBottom,t.offsetLeft||c.offsetLeft,t.offsetRight||c.offsetRight);if(t.single)for(var s=i.lastElementChild;s;)i.removeChild(s),s=i.lastElementChild;i.appendChild(r.element)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},6607:function(e,t,n){"use strict";function r(e){return"function"==typeof e}function i(e){const t=e(e=>{Error.call(e),e.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const s=i(e=>function(t){e(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((e,t)=>`${t+1}) ${e.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function o(e,t){if(e){const n=e.indexOf(t);0<=n&&e.splice(n,1)}}class a{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:i}=this;if(i)if(this._parentage=null,Array.isArray(i))for(const e of i)e.remove(this);else i.remove(this);const{initialTeardown:o}=this;if(r(o))try{o()}catch(t){e=t instanceof s?t.errors:[t]}const{_teardowns:a}=this;if(a){this._teardowns=null;for(const t of a)try{u(t)}catch(n){e=e??[],n instanceof s?e=[...e,...n.errors]:e.push(n)}}if(e)throw new s(e)}}add(e){var t;if(e&&e!==this)if(this.closed)u(e);else{if(e instanceof a){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._teardowns=null!==(t=this._teardowns)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&o(t,e)}remove(e){const{_teardowns:t}=this;t&&o(t,e),e instanceof a&&e._removeParent(this)}}a.EMPTY=(()=>{const e=new a;return e.closed=!0,e})();const l=a.EMPTY;function c(e){return e instanceof a||e&&"closed"in e&&r(e.remove)&&r(e.add)&&r(e.unsubscribe)}function u(e){r(e)?e():e.unsubscribe()}const h={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},d={setTimeout(...e){const{delegate:t}=d;return((null==t?void 0:t.setTimeout)||setTimeout)(...e)},clearTimeout(e){const{delegate:t}=d;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function f(e){d.setTimeout(()=>{const{onUnhandledError:t}=h;if(!t)throw e;t(e)})}function p(){}const g=m("C",void 0,void 0);function m(e,t,n){return{kind:e,value:t,error:n}}let y=null;function v(e){if(h.useDeprecatedSynchronousErrorHandling){const t=!y;if(t&&(y={errorThrown:!1,error:null}),e(),t){const{errorThrown:e,error:t}=y;if(y=null,e)throw t}}else e()}class C extends a{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,c(e)&&e.add(this)):this.destination=S}static create(e,t,n){return new _(e,t,n)}next(e){this.isStopped?P(m("N",e,void 0),this):this._next(e)}error(e){this.isStopped?P(m("E",void 0,e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?P(g,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class _ extends C{constructor(e,t,n){let i;if(super(),r(e))i=e;else if(e){let r;({next:i,error:t,complete:n}=e),this&&h.useDeprecatedNextContext?(r=Object.create(e),r.unsubscribe=()=>this.unsubscribe()):r=e,i=null==i?void 0:i.bind(r),t=null==t?void 0:t.bind(r),n=null==n?void 0:n.bind(r)}this.destination={next:i?E(i):p,error:E(t??w),complete:n?E(n):p}}}function E(e,t){return(...t)=>{try{e(...t)}catch(n){h.useDeprecatedSynchronousErrorHandling?function(e){h.useDeprecatedSynchronousErrorHandling&&y&&(y.errorThrown=!0,y.error=e)}(n):f(n)}}}function w(e){throw e}function P(e,t){const{onStoppedNotification:n}=h;n&&d.setTimeout(()=>n(e,t))}const S={closed:!0,next:p,error:w,complete:p},b="function"==typeof Symbol&&Symbol.observable||"@@observable";function O(e){return e}let T=(()=>{class e{constructor(e){e&&(this._subscribe=e)}lift(t){const n=new e;return n.source=this,n.operator=t,n}subscribe(e,t,n){const i=function(e){return e&&e instanceof C||function(e){return e&&r(e.next)&&r(e.error)&&r(e.complete)}(e)&&c(e)}(e)?e:new _(e,t,n);return v(()=>{const{operator:e,source:t}=this;i.add(e?e.call(i,t):t?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(e){try{return this._subscribe(e)}catch(t){e.error(t)}}forEach(e,t){return new(t=I(t))((t,n)=>{const r=new _({next:t=>{try{e(t)}catch(i){n(i),r.unsubscribe()}},error:n,complete:t});this.subscribe(r)})}_subscribe(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)}[b](){return this}pipe(...e){return function(e){return 0===e.length?O:1===e.length?e[0]:function(t){return e.reduce((e,t)=>t(e),t)}}(e)(this)}toPromise(e){return new(e=I(e))((e,t)=>{let n;this.subscribe(e=>n=e,e=>t(e),()=>e(n))})}}return e.create=t=>new e(t),e})();function I(e){var t;return null!==(t=e??h.Promise)&&void 0!==t?t:Promise}const k=i(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let A=(()=>{class e extends T{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const t=new M(this,this);return t.operator=e,t}_throwIfClosed(){if(this.closed)throw new k}next(e){v(()=>{if(this._throwIfClosed(),!this.isStopped){const t=this.observers.slice();for(const n of t)n.next(e)}})}error(e){v(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:t}=this;for(;t.length;)t.shift().error(e)}})}complete(){v(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:t,isStopped:n,observers:r}=this;return t||n?l:(r.push(e),new a(()=>o(r,e)))}_checkFinalizedStatuses(e){const{hasError:t,thrownError:n,isStopped:r}=this;t?e.error(n):r&&e.complete()}asObservable(){const e=new T;return e.source=this,e}}return e.create=(e,t)=>new M(e,t),e})();class M extends A{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}error(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:l}}function N(e){return r(null==e?void 0:e.lift)}function R(e){return t=>{if(N(t))return t.lift(function(t){try{return e(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}class x extends C{constructor(e,t,n,r,i){super(e),this.onFinalize=i,this._next=t?function(n){try{t(n)}catch(r){e.error(r)}}:super._next,this._error=r?function(t){try{r(t)}catch(n){e.error(n)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(t){e.error(t)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}function D(e,t){return R((n,r)=>{let i=0;n.subscribe(new x(r,n=>{r.next(e.call(t,n,i++))}))})}function L(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function F(e){return this instanceof F?(this.v=e,this):new F(e)}function U(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){s.push([e,t,n,r])>1||a(e,t)})})}function a(e,t){try{!function(e){e.value instanceof F?Promise.resolve(e.value.v).then(l,c):u(s[0][2],e)}(i[e](t))}catch(n){u(s[0][3],n)}}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function V(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){!function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}(r,i,(t=e[n](t)).done,t.value)})}}}const B=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function $(e){return r(null==e?void 0:e.then)}function z(e){return r(e[b])}function H(e){return Symbol.asyncIterator&&r(null==e?void 0:e[Symbol.asyncIterator])}function G(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Z="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function q(e){return r(null==e?void 0:e[Z])}function W(e){return U(this,arguments,function*(){const t=e.getReader();try{for(;;){const{value:e,done:n}=yield F(t.read());if(n)return yield F(void 0);yield yield F(e)}}finally{t.releaseLock()}})}function j(e){return r(null==e?void 0:e.getReader)}function Y(e){if(e instanceof T)return e;if(null!=e){if(z(e))return function(e){return new T(t=>{const n=e[b]();if(r(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(B(e))return function(e){return new T(t=>{for(let n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if($(e))return function(e){return new T(t=>{e.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,f)})}(e);if(H(e))return K(e);if(q(e))return function(e){return new T(t=>{for(const n of e)if(t.next(n),t.closed)return;t.complete()})}(e);if(j(e))return function(e){return K(W(e))}(e)}throw G(e)}function K(e){return new T(t=>{(function(e,t){var n,r,i,s;return function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,a)}l((r=r.apply(e,t||[])).next())})}(this,void 0,void 0,function*(){try{for(n=V(e);!(r=yield n.next()).done;)if(t.next(r.value),t.closed)return}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}t.complete()})})(e,t).catch(e=>t.error(e))})}function Q(e,t,n,r=0,i=!1){const s=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(s),!i)return s}function X(e,t,n=1/0){return r(t)?X((n,r)=>D((e,i)=>t(n,e,r,i))(Y(e(n,r))),n):("number"==typeof t&&(n=t),R((t,r)=>function(e,t,n,r,i,s,o,a){const l=[];let c=0,u=0,h=!1;const d=()=>{h&&!l.length&&!c&&t.complete()},f=e=>c<r?p(e):l.push(e),p=e=>{c++;let i=!1;Y(n(e,u++)).subscribe(new x(t,e=>{t.next(e)},()=>{i=!0},void 0,()=>{if(i)try{for(c--;l.length&&c<r;){const e=l.shift();p(e)}d()}catch(e){t.error(e)}}))};return e.subscribe(new x(t,f,()=>{h=!0,d()})),()=>{}}(t,r,e,n)))}function J(e=1/0){return X(O,e)}const ee=new T(e=>e.complete());function te(e){return e[e.length-1]}function ne(e){return r(te(e))?e.pop():void 0}function re(e){return function(e){return e&&r(e.schedule)}(te(e))?e.pop():void 0}function ie(e,t=0){return R((n,r)=>{n.subscribe(new x(r,n=>Q(r,e,()=>r.next(n),t),()=>Q(r,e,()=>r.complete(),t),n=>Q(r,e,()=>r.error(n),t)))})}function se(e,t=0){return R((n,r)=>{r.add(e.schedule(()=>n.subscribe(r),t))})}function oe(e,t){if(!e)throw new Error("Iterable cannot be null");return new T(n=>{Q(n,t,()=>{const r=e[Symbol.asyncIterator]();Q(n,t,()=>{r.next().then(e=>{e.done?n.complete():n.next(e.value)})},0,!0)})})}function ae(e,t){return t?function(e,t){if(null!=e){if(z(e))return function(e,t){return Y(e).pipe(se(t),ie(t))}(e,t);if(B(e))return function(e,t){return new T(n=>{let r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if($(e))return function(e,t){return Y(e).pipe(se(t),ie(t))}(e,t);if(H(e))return oe(e,t);if(q(e))return function(e,t){return new T(n=>{let i;return Q(n,t,()=>{i=e[Z](),Q(n,t,()=>{let e,t;try{({value:e,done:t}=i.next())}catch(r){return void n.error(r)}t?n.complete():n.next(e)},0,!0)}),()=>r(null==i?void 0:i.return)&&i.return()})}(e,t);if(j(e))return function(e,t){return oe(W(e),t)}(e,t)}throw G(e)}(e,t):Y(e)}function le(e){return e<=0?()=>ee:R((t,n)=>{let r=0;t.subscribe(new x(n,t=>{++r<=e&&(n.next(t),e<=r&&n.complete())}))})}function ce(e,t,...n){return!0===t?(e(),null):!1===t?null:t(...n).pipe(le(1)).subscribe(()=>e())}function ue(e){for(let t in e)if(e[t]===ue)return t;throw Error("Could not find renamed property on target object.")}function he(e,t){for(const n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function de(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(de).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function fe(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const pe=ue({__forward_ref__:ue});function ge(e){return e.__forward_ref__=ge,e.toString=function(){return de(this())},e}function me(e){return ye(e)?e():e}function ye(e){return"function"==typeof e&&e.hasOwnProperty(pe)&&e.__forward_ref__===ge}class ve extends Error{constructor(e,t){super(function(e,t){return`${e?`NG0${e}: `:""}${t}`}(e,t)),this.code=e}}function Ce(e){return"string"==typeof e?e:null==e?"":String(e)}function _e(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Ce(e)}function Ee(e,t){const n=t?` in ${t}`:"";throw new ve("201",`No provider for ${_e(e)} found${n}`)}function we(e,t,n,r){throw new Error(`ASSERTION ERROR: ${e}`+(null==r?"":` [Expected=> ${n} ${r} ${t} <=Actual]`))}function Pe(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Se(e){return{providers:e.providers||[],imports:e.imports||[]}}function be(e){return Oe(e,Ie)||Oe(e,Ae)}function Oe(e,t){return e.hasOwnProperty(t)?e[t]:null}function Te(e){return e&&(e.hasOwnProperty(ke)||e.hasOwnProperty(Me))?e[ke]:null}const Ie=ue({"\u0275prov":ue}),ke=ue({"\u0275inj":ue}),Ae=ue({ngInjectableDef:ue}),Me=ue({ngInjectorDef:ue});var Ne=(()=>((Ne=Ne||{})[Ne.Default=0]="Default",Ne[Ne.Host=1]="Host",Ne[Ne.Self=2]="Self",Ne[Ne.SkipSelf=4]="SkipSelf",Ne[Ne.Optional=8]="Optional",Ne))();let Re;function xe(e){const t=Re;return Re=e,t}function De(e,t,n){const r=be(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&Ne.Optional?null:void 0!==t?t:void Ee(de(e),"Injector")}function Le(e){return{toString:e}.toString()}var Fe=(()=>((Fe=Fe||{})[Fe.OnPush=0]="OnPush",Fe[Fe.Default=1]="Default",Fe))(),Ue=(()=>((Ue=Ue||{})[Ue.Emulated=0]="Emulated",Ue[Ue.None=2]="None",Ue[Ue.ShadowDom=3]="ShadowDom",Ue))();const Ve="undefined"!=typeof globalThis&&globalThis,Be="undefined"!=typeof window&&window,$e="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,ze=Ve||"undefined"!=typeof global&&global||Be||$e,He={},Ge=[],Ze=ue({"\u0275cmp":ue}),qe=ue({"\u0275dir":ue}),We=ue({"\u0275pipe":ue}),je=ue({"\u0275mod":ue}),Ye=ue({"\u0275loc":ue}),Ke=ue({"\u0275fac":ue}),Qe=ue({__NG_ELEMENT_ID__:ue});let Xe=0;function Je(e){return Le(()=>{const t={},n={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===Fe.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||Ge,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||Ue.Emulated,id:"c",styles:e.styles||Ge,_:null,setInput:null,schemas:e.schemas||null,tView:null},r=e.directives,i=e.features,s=e.pipes;return n.id+=Xe++,n.inputs=it(e.inputs,t),n.outputs=it(e.outputs),i&&i.forEach(e=>e(n)),n.directiveDefs=r?()=>("function"==typeof r?r():r).map(et):null,n.pipeDefs=s?()=>("function"==typeof s?s():s).map(tt):null,n})}function et(e){return at(e)||function(e){return e[qe]||null}(e)}function tt(e){return function(e){return e[We]||null}(e)}const nt={};function rt(e){return Le(()=>{const t={type:e.type,bootstrap:e.bootstrap||Ge,declarations:e.declarations||Ge,imports:e.imports||Ge,exports:e.exports||Ge,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(nt[e.id]=e.type),t})}function it(e,t){if(null==e)return He;const n={};for(const r in e)if(e.hasOwnProperty(r)){let i=e[r],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),n[i]=r,t&&(t[i]=s)}return n}const st=Je;function ot(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function at(e){return e[Ze]||null}function lt(e,t){const n=e[je]||null;if(!n&&!0===t)throw new Error(`Type ${de(e)} does not have '\u0275mod' property.`);return n}function ct(e){return Array.isArray(e)&&"object"==typeof e[1]}function ut(e){return Array.isArray(e)&&!0===e[1]}function ht(e){return 0!=(8&e.flags)}function dt(e){return 2==(2&e.flags)}function ft(e){return 1==(1&e.flags)}function pt(e){return null!==e.template}function gt(e){return 0!=(512&e[2])}function mt(e,t){return e.hasOwnProperty(Ke)?e[Ke]:null}class yt{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function vt(){return Ct}function Ct(e){return e.type.prototype.ngOnChanges&&(e.setInput=Et),_t}function _t(){const e=Pt(this),t=null==e?void 0:e.current;if(t){const n=e.previous;if(n===He)e.previous=t;else for(let e in t)n[e]=t[e];e.current=null,this.ngOnChanges(t)}}function Et(e,t,n,r){const i=Pt(e)||function(e,t){return e[wt]=t}(e,{previous:He,current:null}),s=i.current||(i.current={}),o=i.previous,a=this.declaredInputs[n],l=o[a];s[a]=new yt(l&&l.currentValue,t,o===He),e[r]=t}vt.ngInherit=!0;const wt="__ngSimpleChanges__";function Pt(e){return e[wt]||null}const St="http://www.w3.org/2000/svg";let bt;function Ot(){return void 0!==bt?bt:"undefined"!=typeof document?document:void 0}function Tt(e){return!!e.listen}const It={createRenderer:(e,t)=>Ot()};function kt(e){for(;Array.isArray(e);)e=e[0];return e}function At(e,t){return kt(t[e])}function Mt(e,t){return kt(t[e.index])}function Nt(e,t){return e.data[t]}function Rt(e,t){return e[t]}function xt(e,t){const n=t[e];return ct(n)?n:n[0]}function Dt(e){return 4==(4&e[2])}function Lt(e){return 128==(128&e[2])}function Ft(e,t){return null==t?null:e[t]}function Ut(e){e[18]=0}function Vt(e,t){e[5]+=t;let n=e,r=e[3];for(;null!==r&&(1===t&&1===n[5]||-1===t&&0===n[5]);)r[5]+=t,n=r,r=r[3]}const Bt={lFrame:fn(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function $t(){return Bt.bindingsEnabled}function zt(){return Bt.lFrame.lView}function Ht(){return Bt.lFrame.tView}function Gt(e){return Bt.lFrame.contextLView=e,e[8]}function Zt(){let e=qt();for(;null!==e&&64===e.type;)e=e.parent;return e}function qt(){return Bt.lFrame.currentTNode}function Wt(){const e=Bt.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}function jt(e,t){const n=Bt.lFrame;n.currentTNode=e,n.isParent=t}function Yt(){return Bt.lFrame.isParent}function Kt(){Bt.lFrame.isParent=!1}function Qt(){return Bt.isInCheckNoChangesMode}function Xt(e){Bt.isInCheckNoChangesMode=e}function Jt(){const e=Bt.lFrame;let t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function en(){return Bt.lFrame.bindingIndex}function tn(){return Bt.lFrame.bindingIndex++}function nn(e){const t=Bt.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function rn(e){Bt.lFrame.inI18n=e}function sn(e,t){const n=Bt.lFrame;n.bindingIndex=n.bindingRootIndex=e,on(t)}function on(e){Bt.lFrame.currentDirectiveIndex=e}function an(){return Bt.lFrame.currentQueryIndex}function ln(e){Bt.lFrame.currentQueryIndex=e}function cn(e){const t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function un(e,t,n){if(n&Ne.SkipSelf){let r=t,i=e;for(;!(r=r.parent,null!==r||n&Ne.Host||(r=cn(i),null===r||(i=i[15],10&r.type))););if(null===r)return!1;t=r,e=i}const r=Bt.lFrame=dn();return r.currentTNode=t,r.lView=e,!0}function hn(e){const t=dn(),n=e[1];Bt.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function dn(){const e=Bt.lFrame,t=null===e?null:e.child;return null===t?fn(e):t}function fn(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function pn(){const e=Bt.lFrame;return Bt.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const gn=pn;function mn(){const e=pn();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function yn(){return Bt.lFrame.selectedIndex}function vn(e){Bt.lFrame.selectedIndex=e}function Cn(){const e=Bt.lFrame;return Nt(e.tView,e.selectedIndex)}function _n(){Bt.lFrame.currentNamespace=St}function En(e,t){for(let n=t.directiveStart,r=t.directiveEnd;n<r;n++){const t=e.data[n].type.prototype,{ngAfterContentInit:r,ngAfterContentChecked:i,ngAfterViewInit:s,ngAfterViewChecked:o,ngOnDestroy:a}=t;r&&(e.contentHooks||(e.contentHooks=[])).push(-n,r),i&&((e.contentHooks||(e.contentHooks=[])).push(n,i),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,i)),s&&(e.viewHooks||(e.viewHooks=[])).push(-n,s),o&&((e.viewHooks||(e.viewHooks=[])).push(n,o),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,o)),null!=a&&(e.destroyHooks||(e.destroyHooks=[])).push(n,a)}}function wn(e,t,n){bn(e,t,3,n)}function Pn(e,t,n,r){(3&e[2])===n&&bn(e,t,n,r)}function Sn(e,t){let n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function bn(e,t,n,r){const i=r??-1,s=t.length-1;let o=0;for(let a=void 0!==r?65535&e[18]:0;a<s;a++)if("number"==typeof t[a+1]){if(o=t[a],null!=r&&o>=r)break}else t[a]<0&&(e[18]+=65536),(o<i||-1==i)&&(On(e,n,t,a),e[18]=(4294901760&e[18])+a+2),a++}function On(e,t,n,r){const i=n[r]<0,s=n[r+1],o=e[i?-n[r]:n[r]];if(i){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{s.call(o)}finally{}}}else try{s.call(o)}finally{}}class Tn{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function In(e,t,n){const r=Tt(e);let i=0;for(;i<n.length;){const s=n[i];if("number"==typeof s){if(0!==s)break;i++;const o=n[i++],a=n[i++],l=n[i++];r?e.setAttribute(t,a,l,o):t.setAttributeNS(o,a,l)}else{const o=s,a=n[++i];An(o)?r&&e.setProperty(t,o,a):r?e.setAttribute(t,o,a):t.setAttribute(o,a),i++}}return i}function kn(e){return 3===e||4===e||6===e}function An(e){return 64===e.charCodeAt(0)}function Mn(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else{let n=-1;for(let r=0;r<t.length;r++){const i=t[r];"number"==typeof i?n=i:0===n||Nn(e,n,i,null,-1===n||2===n?t[++r]:null)}}return e}function Nn(e,t,n,r,i){let s=0,o=e.length;if(-1===t)o=-1;else for(;s<e.length;){const n=e[s++];if("number"==typeof n){if(n===t){o=-1;break}if(n>t){o=s-1;break}}}for(;s<e.length;){const t=e[s];if("number"==typeof t)break;if(t===n){if(null===r)return void(null!==i&&(e[s+1]=i));if(r===e[s+1])return void(e[s+2]=i)}s++,null!==r&&s++,null!==i&&s++}-1!==o&&(e.splice(o,0,t),s=o+1),e.splice(s++,0,n),null!==r&&e.splice(s++,0,r),null!==i&&e.splice(s++,0,i)}function Rn(e){return-1!==e}function xn(e){return 32767&e}function Dn(e,t){let n=function(e){return e>>16}(e),r=t;for(;n>0;)r=r[15],n--;return r}let Ln=!0;function Fn(e){const t=Ln;return Ln=e,t}let Un=0;function Vn(e,t){const n=$n(e,t);if(-1!==n)return n;const r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,Bn(r.data,e),Bn(t,null),Bn(r.blueprint,null));const i=zn(e,t),s=e.injectorIndex;if(Rn(i)){const e=xn(i),n=Dn(i,t),r=n[1].data;for(let i=0;i<8;i++)t[s+i]=n[e+i]|r[e+i]}return t[s+8]=i,s}function Bn(e,t){e.push(0,0,0,0,0,0,0,0,t)}function $n(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function zn(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,r=null,i=t;for(;null!==i;){const e=i[1],t=e.type;if(r=2===t?e.declTNode:1===t?i[6]:null,null===r)return-1;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function Hn(e,t,n){!function(e,t,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(Qe)&&(r=n[Qe]),null==r&&(r=n[Qe]=Un++);const i=255&r;t.data[e+(i>>5)]|=1<<i}(e,t,n)}function Gn(e,t,n){if(n&Ne.Optional)return e;Ee(t,"NodeInjector")}function Zn(e,t,n,r){if(n&Ne.Optional&&void 0===r&&(r=null),0==(n&(Ne.Self|Ne.Host))){const i=e[9],s=xe(void 0);try{return i?i.get(t,r,n&Ne.Optional):De(t,r,n&Ne.Optional)}finally{xe(s)}}return Gn(r,t,n)}function qn(e,t,n,r=Ne.Default,i){if(null!==e){const s=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(Qe)?e[Qe]:void 0;return"number"==typeof t?t>=0?255&t:jn:t}(n);if("function"==typeof s){if(!un(t,e,r))return r&Ne.Host?Gn(i,n,r):Zn(t,n,r,i);try{const e=s(r);if(null!=e||r&Ne.Optional)return e;Ee(n)}finally{gn()}}else if("number"==typeof s){let i=null,o=$n(e,t),a=-1,l=r&Ne.Host?t[16][6]:null;for((-1===o||r&Ne.SkipSelf)&&(a=-1===o?zn(e,t):t[o+8],-1!==a&&Jn(r,!1)?(i=t[1],o=xn(a),t=Dn(a,t)):o=-1);-1!==o;){const e=t[1];if(Xn(s,o,e.data)){const e=Yn(o,t,n,i,r,l);if(e!==Wn)return e}a=t[o+8],-1!==a&&Jn(r,t[1].data[o+8]===l)&&Xn(s,o,t)?(i=e,o=xn(a),t=Dn(a,t)):o=-1}}}return Zn(t,n,r,i)}const Wn={};function jn(){return new er(Zt(),zt())}function Yn(e,t,n,r,i,s){const o=t[1],a=o.data[e+8],l=Kn(a,o,n,null==r?dt(a)&&Ln:r!=o&&0!=(3&a.type),i&Ne.Host&&s===a);return null!==l?Qn(t,o,l,a):Wn}function Kn(e,t,n,r,i){const s=e.providerIndexes,o=t.data,a=1048575&s,l=e.directiveStart,c=s>>20,u=i?a+c:e.directiveEnd;for(let h=r?a:a+c;h<u;h++){const e=o[h];if(h<l&&n===e||h>=l&&e.type===n)return h}if(i){const e=o[l];if(e&&pt(e)&&e.type===n)return l}return null}function Qn(e,t,n,r){let i=e[n];const s=t.data;if(function(e){return e instanceof Tn}(i)){const o=i;o.resolving&&function(e,t){throw new ve("200",`Circular dependency in DI detected for ${e}`)}(_e(s[n]));const a=Fn(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?xe(o.injectImpl):null;un(e,r,Ne.Default);try{i=e[n]=o.factory(void 0,s,e,r),t.firstCreatePass&&n>=r.directiveStart&&function(e,t,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=t.type.prototype;if(r){const r=Ct(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,r),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,r)}i&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,i),s&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s))}(n,s[n],t)}finally{null!==l&&xe(l),Fn(a),o.resolving=!1,gn()}}return i}function Xn(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function Jn(e,t){return!(e&Ne.Self||e&Ne.Host&&t)}class er{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return qn(this._tNode,this._lView,e,n,t)}}function tr(e){return Le(()=>{const t=e.prototype.constructor,n=t[Ke]||nr(t),r=Object.prototype;let i=Object.getPrototypeOf(e.prototype).constructor;for(;i&&i!==r;){const e=i[Ke]||nr(i);if(e&&e!==n)return e;i=Object.getPrototypeOf(i)}return e=>new e})}function nr(e){return ye(e)?()=>{const t=nr(me(e));return t&&t()}:mt(e)}function rr(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;const n=e.attrs;if(n){const e=n.length;let r=0;for(;r<e;){const i=n[r];if(kn(i))break;if(0===i)r+=2;else if("number"==typeof i)for(r++;r<e&&"string"==typeof n[r];)r++;else{if(i===t)return n[r+1];r+=2}}}return null}(Zt(),e)}const ir="__parameters__";function sr(e,t,n){return Le(()=>{const r=function(e){return function(...t){if(e){const n=e(...t);for(const e in n)this[e]=n[e]}}}(t);function i(...e){if(this instanceof i)return r.apply(this,e),this;const t=new i(...e);return n.annotation=t,n;function n(e,n,r){const i=e.hasOwnProperty(ir)?e[ir]:Object.defineProperty(e,ir,{value:[]})[ir];for(;i.length<=r;)i.push(null);return(i[r]=i[r]||[]).push(t),e}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i})}class or{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Pe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}const ar=new or("AnalyzeForEntryComponents"),lr=Function;function cr(e,t){void 0===t&&(t=e);for(let n=0;n<e.length;n++){let r=e[n];Array.isArray(r)?(t===e&&(t=e.slice(0,n)),cr(r,t)):t!==e&&t.push(r)}return t}function ur(e,t){e.forEach(e=>Array.isArray(e)?ur(e,t):t(e))}function hr(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function dr(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function fr(e,t){const n=[];for(let r=0;r<e;r++)n.push(t);return n}function pr(e,t,n){let r=mr(e,t);return r>=0?e[1|r]=n:(r=~r,function(e,t,n,r){let i=e.length;if(i==t)e.push(n,r);else if(1===i)e.push(r,e[0]),e[0]=n;else{for(i--,e.push(e[i-1],e[i]);i>t;)e[i]=e[i-2],i--;e[t]=n,e[t+1]=r}}(e,r,t,n)),r}function gr(e,t){const n=mr(e,t);if(n>=0)return e[1|n]}function mr(e,t){return function(e,t,n){let r=0,i=e.length>>n;for(;i!==r;){const s=r+(i-r>>1),o=e[s<<n];if(t===o)return s<<n;o>t?i=s:r=s+1}return~(i<<n)}(e,t,1)}const yr={},vr="__NG_DI_FLAG__",Cr="ngTempTokenPath",_r=/\n/gm,Er="__source",wr=ue({provide:String,useValue:ue});let Pr;function Sr(e){const t=Pr;return Pr=e,t}function br(e,t=Ne.Default){if(void 0===Pr)throw new Error("inject() must be called from an injection context");return null===Pr?De(e,void 0,t):Pr.get(e,t&Ne.Optional?null:void 0,t)}function Or(e,t=Ne.Default){return(Re||br)(me(e),t)}function Tr(e){const t=[];for(let n=0;n<e.length;n++){const r=me(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");let e,n=Ne.Default;for(let t=0;t<r.length;t++){const i=r[t],s=kr(i);"number"==typeof s?-1===s?e=i.token:n|=s:e=i}t.push(Or(e,n))}else t.push(Or(r))}return t}function Ir(e,t){return e[vr]=t,e.prototype[vr]=t,e}function kr(e){return e[vr]}function Ar(e,t,n,r){const i=e[Cr];throw t[Er]&&i.unshift(t[Er]),e.message=function(e,t,n,r=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;let i=de(t);if(Array.isArray(t))i=t.map(de).join(" -> ");else if("object"==typeof t){let e=[];for(let n in t)if(t.hasOwnProperty(n)){let r=t[n];e.push(n+":"+("string"==typeof r?JSON.stringify(r):de(r)))}i=`{${e.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${e.replace(_r,"\n  ")}`}("\n"+e.message,i,n,r),e.ngTokenPath=i,e[Cr]=null,e}const Mr=Ir(sr("Inject",e=>({token:e})),-1),Nr=Ir(sr("Optional"),8),Rr=Ir(sr("SkipSelf"),4);let xr,Dr;function Lr(e){var t;return(null===(t=function(){if(void 0===xr&&(xr=null,ze.trustedTypes))try{xr=ze.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return xr}())||void 0===t?void 0:t.createHTML(e))||e}function Fr(e){var t;return(null===(t=function(){if(void 0===Dr&&(Dr=null,ze.trustedTypes))try{Dr=ze.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return Dr}())||void 0===t?void 0:t.createHTML(e))||e}class Ur{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class Vr extends Ur{getTypeName(){return"HTML"}}class Br extends Ur{getTypeName(){return"Style"}}class $r extends Ur{getTypeName(){return"Script"}}class zr extends Ur{getTypeName(){return"URL"}}class Hr extends Ur{getTypeName(){return"ResourceURL"}}function Gr(e){return e instanceof Ur?e.changingThisBreaksApplicationSecurity:e}function Zr(e,t){const n=qr(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===t}function qr(e){return e instanceof Ur&&e.getTypeName()||null}function Wr(e){const t=new Yr(e);return function(){try{return!!(new window.DOMParser).parseFromString(Lr(""),"text/html")}catch{return!1}}()?new jr(t):t}class jr{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(Lr(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class Yr{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const t=this.inertDocument.createElement("body");e.appendChild(t)}}getInertBodyElement(e){const t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=Lr(e),t;const n=this.inertDocument.createElement("body");return n.innerHTML=Lr(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(e){const t=e.attributes;for(let r=t.length-1;0<r;r--){const n=t.item(r).name;("xmlns:ns1"===n||0===n.indexOf("ns1:"))&&e.removeAttribute(n)}let n=e.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const Kr=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Qr=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Xr(e){return(e=String(e)).match(Kr)||e.match(Qr)?e:"unsafe:"+e}function Jr(e){return(e=String(e)).split(",").map(e=>Xr(e.trim())).join(", ")}function ei(e){const t={};for(const n of e.split(","))t[n]=!0;return t}function ti(...e){const t={};for(const n of e)for(const e in n)n.hasOwnProperty(e)&&(t[e]=!0);return t}const ni=ei("area,br,col,hr,img,wbr"),ri=ei("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),ii=ei("rp,rt"),si=ti(ni,ti(ri,ei("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),ti(ii,ei("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ti(ii,ri)),oi=ei("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),ai=ei("srcset"),li=ti(oi,ai,ei("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ei("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),ci=ei("script,style,template");class ui{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let e=this.checkClobberedElement(t,t.nextSibling);if(e){t=e;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!si.hasOwnProperty(t))return this.sanitizedSomething=!0,!ci.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const n=e.attributes;for(let r=0;r<n.length;r++){const e=n.item(r),t=e.name,i=t.toLowerCase();if(!li.hasOwnProperty(i)){this.sanitizedSomething=!0;continue}let s=e.value;oi[i]&&(s=Xr(s)),ai[i]&&(s=Jr(s)),this.buf.push(" ",t,'="',fi(s),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();si.hasOwnProperty(t)&&!ni.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(fi(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const hi=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,di=/([^\#-~ |!])/g;function fi(e){return e.replace(/&/g,"&amp;").replace(hi,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(di,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let pi;function gi(e,t){let n=null;try{pi=pi||Wr(e);let r=t?String(t):"";n=pi.getInertBodyElement(r);let i=5,s=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=s,s=n.innerHTML,n=pi.getInertBodyElement(r)}while(r!==s);return Lr((new ui).sanitizeChildren(mi(n)||n))}finally{if(n){const e=mi(n)||n;for(;e.firstChild;)e.removeChild(e.firstChild)}}}function mi(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var yi=(()=>((yi=yi||{})[yi.NONE=0]="NONE",yi[yi.HTML=1]="HTML",yi[yi.STYLE=2]="STYLE",yi[yi.SCRIPT=3]="SCRIPT",yi[yi.URL=4]="URL",yi[yi.RESOURCE_URL=5]="RESOURCE_URL",yi))();function vi(e){const t=_i();return t?Fr(t.sanitize(yi.HTML,e)||""):Zr(e,"HTML")?Fr(Gr(e)):gi(Ot(),Ce(e))}function Ci(e){const t=_i();return t?t.sanitize(yi.URL,e)||"":Zr(e,"URL")?Gr(e):Xr(Ce(e))}function _i(){const e=zt();return e&&e[12]}const Ei="__ngContext__";function wi(e,t){e[Ei]=t}function Pi(e){const t=function(e){return e[Ei]||null}(e);return t?Array.isArray(t)?t:t.lView:null}function Si(e){return e.ngOriginalError}function bi(e,...t){e.error(...t)}class Oi{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),n=this._findContext(e),r=(i=e)&&i.ngErrorLogger||bi;var i;r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),n&&r(this._console,"ERROR CONTEXT",n)}_findContext(e){return e?e.ngDebugContext||this._findContext(Si(e)):null}_findOriginalError(e){let t=e&&Si(e);for(;t&&Si(t);)t=Si(t);return t||null}}const Ti=/^>|^->|<!--|-->|--!>|<!-$/g,Ii=/(<|>)/;const ki=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(ze))();function Ai(e){return e instanceof Function?e():e}var Mi=(()=>((Mi=Mi||{})[Mi.Important=1]="Important",Mi[Mi.DashCase=2]="DashCase",Mi))();let Ni;function Ri(e,t){return Ni(e,t)}function xi(e){const t=e[3];return ut(t)?t[3]:t}function Di(e){return Fi(e[13])}function Li(e){return Fi(e[4])}function Fi(e){for(;null!==e&&!ut(e);)e=e[4];return e}function Ui(e,t,n,r,i){if(null!=r){let s,o=!1;ut(r)?s=r:ct(r)&&(o=!0,r=r[0]);const a=kt(r);0===e&&null!==n?null==i?Ki(t,n,a):Yi(t,n,a,i||null,!0):1===e&&null!==n?Yi(t,n,a,i||null,!0):2===e?ls(t,a,o):3===e&&t.destroyNode(a),null!=s&&function(e,t,n,r,i){const s=n[7];s!==kt(n)&&Ui(t,e,r,s,i);for(let o=10;o<n.length;o++){const i=n[o];us(i[1],i,e,t,r,s)}}(t,e,s,n,i)}}function Vi(e,t){return Tt(e)?e.createText(t):e.createTextNode(t)}function Bi(e,t,n){Tt(e)?e.setValue(t,n):t.textContent=n}function $i(e,t){return e.createComment(function(e){return e.replace(Ti,e=>e.replace(Ii,"\u200b$1\u200b"))}(t))}function zi(e,t,n){return Tt(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function Hi(e,t){const n=e[9],r=n.indexOf(t),i=t[3];1024&t[2]&&(t[2]&=-1025,Vt(i,-1)),n.splice(r,1)}function Gi(e,t){if(e.length<=10)return;const n=10+t,r=e[n];if(r){const i=r[17];null!==i&&i!==e&&Hi(i,r),t>0&&(e[n-1][4]=r[4]);const s=dr(e,10+t);!function(e,t){us(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);const o=s[19];null!==o&&o.detachView(s[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function Zi(e,t){if(!(256&t[2])){const n=t[11];Tt(n)&&n.destroyNode&&us(e,t,n,3,null,null),function(e){let t=e[13];if(!t)return qi(e[1],e);for(;t;){let n=null;if(ct(t))n=t[13];else{const e=t[10];e&&(n=e)}if(!n){for(;t&&!t[4]&&t!==e;)ct(t)&&qi(t[1],t),t=t[3];null===t&&(t=e),ct(t)&&qi(t[1],t),n=t&&t[4]}t=n}}(t)}}function qi(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let r=0;r<n.length;r+=2){const e=t[n[r]];if(!(e instanceof Tn)){const t=n[r+1];if(Array.isArray(t))for(let n=0;n<t.length;n+=2){const r=e[t[n]],i=t[n+1];try{i.call(r)}finally{}}else try{t.call(e)}finally{}}}}(e,t),function(e,t){const n=e.cleanup,r=t[7];let i=-1;if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const e=n[s+1],o="function"==typeof e?e(t):kt(t[e]),a=r[i=n[s+2]],l=n[s+3];"boolean"==typeof l?o.removeEventListener(n[s],a,l):l>=0?r[i=l]():r[i=-l].unsubscribe(),s+=2}else{const e=r[i=n[s+1]];n[s].call(e)}if(null!==r){for(let e=i+1;e<r.length;e++)r[e]();t[7]=null}}(e,t),1===t[1].type&&Tt(t[11])&&t[11].destroy();const n=t[17];if(null!==n&&ut(t[3])){n!==t[3]&&Hi(n,t);const r=t[19];null!==r&&r.detachView(e)}}}function Wi(e,t,n){return ji(e,t.parent,n)}function ji(e,t,n){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[0];if(2&r.flags){const t=e.data[r.directiveStart].encapsulation;if(t===Ue.None||t===Ue.Emulated)return null}return Mt(r,n)}function Yi(e,t,n,r,i){Tt(e)?e.insertBefore(t,n,r,i):t.insertBefore(n,r,i)}function Ki(e,t,n){Tt(e)?e.appendChild(t,n):t.appendChild(n)}function Qi(e,t,n,r,i){null!==r?Yi(e,t,n,r,i):Ki(e,t,n)}function Xi(e,t){return Tt(e)?e.parentNode(t):t.parentNode}function Ji(e,t,n){return ns(e,t,n)}function es(e,t,n){return 40&e.type?Mt(e,n):null}let ts,ns=es;function rs(e,t){ns=e,ts=t}function is(e,t,n,r){const i=Wi(e,r,t),s=t[11],o=Ji(r.parent||t[6],r,t);if(null!=i)if(Array.isArray(n))for(let a=0;a<n.length;a++)Qi(s,i,n[a],o,!1);else Qi(s,i,n,o,!1);void 0!==ts&&ts(s,r,t,n,i)}function ss(e,t){if(null!==t){const n=t.type;if(3&n)return Mt(t,e);if(4&n)return as(-1,e[t.index]);if(8&n){const n=t.child;if(null!==n)return ss(e,n);{const n=e[t.index];return ut(n)?as(-1,n):kt(n)}}if(32&n)return Ri(t,e)()||kt(e[t.index]);{const n=os(e,t);return null!==n?Array.isArray(n)?n[0]:ss(xi(e[16]),n):ss(e,t.next)}}return null}function os(e,t){return null!==t?e[16][6].projection[t.projection]:null}function as(e,t){const n=10+e+1;if(n<t.length){const e=t[n],r=e[1].firstChild;if(null!==r)return ss(e,r)}return t[7]}function ls(e,t,n){const r=Xi(e,t);r&&function(e,t,n,r){Tt(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}function cs(e,t,n,r,i,s,o){for(;null!=n;){const a=r[n.index],l=n.type;if(o&&0===t&&(a&&wi(kt(a),r),n.flags|=4),64!=(64&n.flags))if(8&l)cs(e,t,n.child,r,i,s,!1),Ui(t,e,i,a,s);else if(32&l){const o=Ri(n,r);let l;for(;l=o();)Ui(t,e,i,l,s);Ui(t,e,i,a,s)}else 16&l?hs(e,t,r,n,i,s):Ui(t,e,i,a,s);n=o?n.projectionNext:n.next}}function us(e,t,n,r,i,s){cs(n,r,e.firstChild,t,i,s,!1)}function hs(e,t,n,r,i,s){const o=n[16],a=o[6].projection[r.projection];if(Array.isArray(a))for(let l=0;l<a.length;l++)Ui(t,e,i,a[l],s);else cs(e,t,a,o[3],i,s,!0)}function ds(e,t,n){Tt(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function fs(e,t,n){Tt(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function ps(e,t,n){let r=e.length;for(;;){const i=e.indexOf(t,n);if(-1===i)return i;if(0===i||e.charCodeAt(i-1)<=32){const n=t.length;if(i+n===r||e.charCodeAt(i+n)<=32)return i}n=i+1}}const gs="ng-template";function ms(e,t,n){let r=0;for(;r<e.length;){let i=e[r++];if(n&&"class"===i){if(i=e[r],-1!==ps(i.toLowerCase(),t,0))return!0}else if(1===i){for(;r<e.length&&"string"==typeof(i=e[r++]);)if(i.toLowerCase()===t)return!0;return!1}}return!1}function ys(e){return 4===e.type&&e.value!==gs}function vs(e,t,n){return t===(4!==e.type||n?e.value:gs)}function Cs(e,t,n){let r=4;const i=e.attrs||[],s=function(e){for(let t=0;t<e.length;t++)if(kn(e[t]))return t;return e.length}(i);let o=!1;for(let a=0;a<t.length;a++){const l=t[a];if("number"!=typeof l){if(!o)if(4&r){if(r=2|1&r,""!==l&&!vs(e,l,n)||""===l&&1===t.length){if(_s(r))return!1;o=!0}}else{const c=8&r?l:t[++a];if(8&r&&null!==e.attrs){if(!ms(e.attrs,c,n)){if(_s(r))return!1;o=!0}continue}const u=Es(8&r?"class":l,i,ys(e),n);if(-1===u){if(_s(r))return!1;o=!0;continue}if(""!==c){let e;e=u>s?"":i[u+1].toLowerCase();const t=8&r?e:null;if(t&&-1!==ps(t,c,0)||2&r&&c!==e){if(_s(r))return!1;o=!0}}}}else{if(!o&&!_s(r)&&!_s(l))return!1;if(o&&_s(l))continue;o=!1,r=l|1&r}}return _s(r)||o}function _s(e){return 0==(1&e)}function Es(e,t,n,r){if(null===t)return-1;let i=0;if(r||!n){let n=!1;for(;i<t.length;){const r=t[i];if(r===e)return i;if(3===r||6===r)n=!0;else{if(1===r||2===r){let e=t[++i];for(;"string"==typeof e;)e=t[++i];continue}if(4===r)break;if(0===r){i+=4;continue}}i+=n?1:2}return-1}return function(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function ws(e,t,n=!1){for(let r=0;r<t.length;r++)if(Cs(e,t[r],n))return!0;return!1}function Ps(e,t){e:for(let n=0;n<t.length;n++){const r=t[n];if(e.length===r.length){for(let t=0;t<e.length;t++)if(e[t]!==r[t])continue e;return!0}}return!1}function Ss(e,t){return e?":not("+t.trim()+")":t}function bs(e){let t=e[0],n=1,r=2,i="",s=!1;for(;n<e.length;){let o=e[n];if("string"==typeof o)if(2&r){const t=e[++n];i+="["+o+(t.length>0?'="'+t+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!_s(o)&&(t+=Ss(s,i),i=""),r=o,s=s||!_s(r);n++}return""!==i&&(t+=Ss(s,i)),t}const Os={};function Ts(e){Is(Ht(),zt(),yn()+e,Qt())}function Is(e,t,n,r){if(!r)if(3==(3&t[2])){const r=e.preOrderCheckHooks;null!==r&&wn(t,r,n)}else{const r=e.preOrderHooks;null!==r&&Pn(t,r,0,n)}vn(n)}function ks(e,t){return e<<17|t<<2}function As(e){return e>>17&32767}function Ms(e){return 2|e}function Ns(e){return(131068&e)>>2}function Rs(e,t){return-131069&e|t<<2}function xs(e){return 1|e}function Ds(e,t){const n=e.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const i=n[r],s=n[r+1];if(-1!==s){const n=e.data[s];ln(i),n.contentQueries(2,t[s],s)}}}function Ls(e,t,n,r,i,s,o,a,l,c){const u=t.blueprint.slice();return u[0]=i,u[2]=140|r,Ut(u),u[3]=u[15]=e,u[8]=n,u[10]=o||e&&e[10],u[11]=a||e&&e[11],u[12]=l||e&&e[12]||null,u[9]=c||e&&e[9]||null,u[6]=s,u[16]=2==t.type?e[16]:u,u}function Fs(e,t,n,r,i){let s=e.data[t];if(null===s)s=Us(e,t,n,r,i),Bt.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=n,s.value=r,s.attrs=i;const e=Wt();s.injectorIndex=null===e?-1:e.injectorIndex}return jt(s,!0),s}function Us(e,t,n,r,i){const s=qt(),o=Yt(),a=e.data[t]=function(e,t,n,r,i,s){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,t,r,i);return null===e.firstChild&&(e.firstChild=a),null!==s&&(o?null==s.child&&null!==a.parent&&(s.child=a):null===s.next&&(s.next=a)),a}function Vs(e,t,n,r){if(0===n)return-1;const i=t.length;for(let s=0;s<n;s++)t.push(r),e.blueprint.push(r),e.data.push(null);return i}function Bs(e,t,n){hn(t);try{const r=e.viewQuery;null!==r&&Co(1,r,n);const i=e.template;null!==i&&Hs(e,t,i,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&Ds(e,t),e.staticViewQueries&&Co(2,e.viewQuery,n);const s=e.components;null!==s&&function(e,t){for(let n=0;n<t.length;n++)po(e,t[n])}(t,s)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[2]&=-5,mn()}}function $s(e,t,n,r){const i=t[2];if(256==(256&i))return;hn(t);const s=Qt();try{Ut(t),function(e){Bt.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&Hs(e,t,n,2,r);const o=3==(3&i);if(!s)if(o){const n=e.preOrderCheckHooks;null!==n&&wn(t,n,null)}else{const n=e.preOrderHooks;null!==n&&Pn(t,n,0,null),Sn(t,0)}if(function(e){for(let t=Di(e);null!==t;t=Li(t)){if(!t[2])continue;const e=t[9];for(let t=0;t<e.length;t++){const n=e[t],r=n[3];0==(1024&n[2])&&Vt(r,1),n[2]|=1024}}}(t),function(e){for(let t=Di(e);null!==t;t=Li(t))for(let e=10;e<t.length;e++){const n=t[e],r=n[1];Lt(n)&&$s(r,n,r.template,n[8])}}(t),null!==e.contentQueries&&Ds(e,t),!s)if(o){const n=e.contentCheckHooks;null!==n&&wn(t,n)}else{const n=e.contentHooks;null!==n&&Pn(t,n,1),Sn(t,1)}!function(e,t){const n=e.hostBindingOpCodes;if(null!==n)try{for(let e=0;e<n.length;e++){const r=n[e];if(r<0)vn(~r);else{const i=r,s=n[++e],o=n[++e];sn(s,i),o(2,t[i])}}}finally{vn(-1)}}(e,t);const a=e.components;null!==a&&function(e,t){for(let n=0;n<t.length;n++)ho(e,t[n])}(t,a);const l=e.viewQuery;if(null!==l&&Co(2,l,r),!s)if(o){const n=e.viewCheckHooks;null!==n&&wn(t,n)}else{const n=e.viewHooks;null!==n&&Pn(t,n,2),Sn(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),s||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,Vt(t[3],-1))}finally{mn()}}function zs(e,t,n,r){const i=t[10],s=!Qt(),o=Dt(t);try{s&&!o&&i.begin&&i.begin(),o&&Bs(e,t,r),$s(e,t,n,r)}finally{s&&!o&&i.end&&i.end()}}function Hs(e,t,n,r,i){const s=yn(),o=2&r;try{vn(-1),o&&t.length>20&&Is(e,t,20,Qt()),n(r,i)}finally{vn(s)}}function Gs(e,t,n){if(ht(t)){const r=t.directiveEnd;for(let i=t.directiveStart;i<r;i++){const t=e.data[i];t.contentQueries&&t.contentQueries(1,n[i],i)}}}function Zs(e,t,n){!$t()||(function(e,t,n,r){const i=n.directiveStart,s=n.directiveEnd;e.firstCreatePass||Vn(n,t),wi(r,t);const o=n.initialInputs;for(let a=i;a<s;a++){const r=e.data[a],s=pt(r);s&&so(t,n,r);const l=Qn(t,e,a,n);wi(l,t),null!==o&&lo(0,a-i,l,r,0,o),s&&(xt(n.index,t)[8]=l)}}(e,t,n,Mt(n,t)),128==(128&n.flags)&&function(e,t,n){const r=n.directiveStart,i=n.directiveEnd,s=n.index,o=Bt.lFrame.currentDirectiveIndex;try{vn(s);for(let n=r;n<i;n++){const r=e.data[n],i=t[n];on(n),(null!==r.hostBindings||0!==r.hostVars||null!==r.hostAttrs)&&eo(r,i)}}finally{vn(-1),on(o)}}(e,t,n))}function qs(e,t,n=Mt){const r=t.localNames;if(null!==r){let i=t.index+1;for(let s=0;s<r.length;s+=2){const o=r[s+1],a=-1===o?n(t,e):e[o];e[i++]=a}}}function Ws(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=js(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function js(e,t,n,r,i,s,o,a,l,c){const u=20+r,h=u+i,d=function(e,t){const n=[];for(let r=0;r<t;r++)n.push(r<e?null:Os);return n}(u,h),f="function"==typeof c?c():c;return d[1]={type:e,blueprint:d,template:n,queries:null,viewQuery:a,declTNode:t,data:d.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function Ys(e,t,n,r){const i=Eo(t);null===n?i.push(r):(i.push(n),e.firstCreatePass&&wo(e).push(r,i.length-1))}function Ks(e,t,n){for(let r in e)if(e.hasOwnProperty(r)){const i=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,i):n[r]=[t,i]}return n}function Qs(e,t,n,r,i,s,o,a){const l=Mt(t,n);let c,u=t.inputs;!a&&null!=u&&(c=u[r])?(So(e,n,c,r,i),dt(t)&&function(e,t){const n=xt(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(r=function(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(r),i=null!=o?o(i,t.value||"",r):i,Tt(s)?s.setProperty(l,r,i):An(r)||(l.setProperty?l.setProperty(r,i):l[r]=i))}function Xs(e,t,n,r){let i=!1;if($t()){const s=function(e,t,n){const r=e.directiveRegistry;let i=null;if(r)for(let s=0;s<r.length;s++){const o=r[s];ws(n,o.selectors,!1)&&(i||(i=[]),Hn(Vn(n,t),e,o.type),pt(o)?(to(e,n),i.unshift(o)):i.push(o))}return i}(e,t,n),o=null===r?null:{"":-1};if(null!==s){i=!0,ro(n,e.data.length,s.length);for(let e=0;e<s.length;e++){const t=s[e];t.providersResolver&&t.providersResolver(t)}let r=!1,a=!1,l=Vs(e,t,s.length,null);for(let i=0;i<s.length;i++){const c=s[i];n.mergedAttrs=Mn(n.mergedAttrs,c.hostAttrs),io(e,n,t,l,c),no(l,c,o),null!==c.contentQueries&&(n.flags|=8),(null!==c.hostBindings||null!==c.hostAttrs||0!==c.hostVars)&&(n.flags|=128);const u=c.type.prototype;!r&&(u.ngOnChanges||u.ngOnInit||u.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),r=!0),!a&&(u.ngOnChanges||u.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),a=!0),l++}!function(e,t){const n=t.directiveEnd,r=e.data,i=t.attrs,s=[];let o=null,a=null;for(let l=t.directiveStart;l<n;l++){const e=r[l],n=e.inputs,c=null===i||ys(t)?null:co(n,i);s.push(c),o=Ks(n,l,o),a=Ks(e.outputs,l,a)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=s,t.inputs=o,t.outputs=a}(e,n)}o&&function(e,t,n){if(t){const r=e.localNames=[];for(let e=0;e<t.length;e+=2){const i=n[t[e+1]];if(null==i)throw new ve("301",`Export of name '${t[e+1]}' not found!`);r.push(t[e],i)}}}(n,r,o)}return n.mergedAttrs=Mn(n.mergedAttrs,n.attrs),i}function Js(e,t,n,r,i,s){const o=s.hostBindings;if(o){let n=e.hostBindingOpCodes;null===n&&(n=e.hostBindingOpCodes=[]);const s=~t.index;(function(e){let t=e.length;for(;t>0;){const n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(n)!=s&&n.push(s),n.push(r,i,o)}}function eo(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function to(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function no(e,t,n){if(n){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;pt(t)&&(n[""]=e)}}function ro(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function io(e,t,n,r,i){e.data[r]=i;const s=i.factory||(i.factory=mt(i.type)),o=new Tn(s,pt(i),null);e.blueprint[r]=o,n[r]=o,Js(e,t,0,r,Vs(e,n,i.hostVars,Os),i)}function so(e,t,n){const r=Mt(t,e),i=Ws(n),s=e[10],o=go(e,Ls(e,i,null,n.onPush?64:16,r,t,s,s.createRenderer(r,n),null,null));e[t.index]=o}function oo(e,t,n,r,i,s){const o=Mt(e,t);ao(t[11],o,s,e.value,n,r,i)}function ao(e,t,n,r,i,s,o){if(null==s)Tt(e)?e.removeAttribute(t,i,n):t.removeAttribute(i);else{const a=null==o?Ce(s):o(s,r||"",i);Tt(e)?e.setAttribute(t,i,a,n):n?t.setAttributeNS(n,i,a):t.setAttribute(i,a)}}function lo(e,t,n,r,i,s){const o=s[t];if(null!==o){const e=r.setInput;for(let t=0;t<o.length;){const i=o[t++],s=o[t++],a=o[t++];null!==e?r.setInput(n,a,i,s):n[s]=a}}}function co(e,t){let n=null,r=0;for(;r<t.length;){const i=t[r];if(0!==i)if(5!==i){if("number"==typeof i)break;e.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,e[i],t[r+1])),r+=2}else r+=2;else r+=4}return n}function uo(e,t,n,r){return new Array(e,!0,!1,t,null,0,r,n,null,null)}function ho(e,t){const n=xt(t,e);if(Lt(n)){const e=n[1];80&n[2]?$s(e,n,e.template,n[8]):n[5]>0&&fo(n)}}function fo(e){for(let n=Di(e);null!==n;n=Li(n))for(let e=10;e<n.length;e++){const t=n[e];if(1024&t[2]){const e=t[1];$s(e,t,e.template,t[8])}else t[5]>0&&fo(t)}const t=e[1].components;if(null!==t)for(let n=0;n<t.length;n++){const r=xt(t[n],e);Lt(r)&&r[5]>0&&fo(r)}}function po(e,t){const n=xt(t,e),r=n[1];(function(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])})(r,n),Bs(r,n,n[8])}function go(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function mo(e){for(;e;){e[2]|=64;const t=xi(e);if(gt(e)&&!t)return e;e=t}return null}function yo(e,t,n){const r=t[10];r.begin&&r.begin();try{$s(e,t,e.template,n)}catch(i){throw Po(t,i),i}finally{r.end&&r.end()}}function vo(e){!function(e){for(let t=0;t<e.components.length;t++){const n=e.components[t],r=Pi(n),i=r[1];zs(i,r,i.template,n)}}(e[8])}function Co(e,t,n){ln(0),t(e,n)}const _o=(()=>Promise.resolve(null))();function Eo(e){return e[7]||(e[7]=[])}function wo(e){return e.cleanup||(e.cleanup=[])}function Po(e,t){const n=e[9],r=n?n.get(Oi,null):null;r&&r.handleError(t)}function So(e,t,n,r,i){for(let s=0;s<n.length;){const o=n[s++],a=n[s++],l=t[o],c=e.data[o];null!==c.setInput?c.setInput(l,i,r,a):l[a]=i}}function bo(e,t,n){const r=At(t,e);Bi(e[11],r,n)}function Oo(e,t,n){let r=n?e.styles:null,i=n?e.classes:null,s=0;if(null!==t)for(let o=0;o<t.length;o++){const e=t[o];"number"==typeof e?s=e:1==s?i=fe(i,e):2==s&&(r=fe(r,e+": "+t[++o]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=i:e.classesWithoutHost=i}const To=new or("INJECTOR",-1);class Io{get(e,t=yr){if(t===yr){const t=new Error(`NullInjectorError: No provider for ${de(e)}!`);throw t.name="NullInjectorError",t}return t}}const ko=new or("Set Injector scope."),Ao={},Mo={};let No;function Ro(){return void 0===No&&(No=new Io),No}function xo(e,t=null,n=null,r){return new Do(e,n,t||Ro(),r)}class Do{constructor(e,t,n,r=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const i=[];t&&ur(t,n=>this.processProvider(n,e,t)),ur([e],e=>this.processInjectorType(e,[],i)),this.records.set(To,Uo(void 0,this));const s=this.records.get(ko);this.scope=null!=s?s.value:null,this.source=r||("object"==typeof e?null:de(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=yr,n=Ne.Default){this.assertNotDestroyed();const r=Sr(this),i=xe(void 0);try{if(!(n&Ne.SkipSelf)){let t=this.records.get(e);if(void 0===t){const n=("function"==typeof(s=e)||"object"==typeof s&&s instanceof or)&&be(e);t=n&&this.injectableDefInScope(n)?Uo(Lo(e),Ao):null,this.records.set(e,t)}if(null!=t)return this.hydrate(e,t)}return(n&Ne.Self?Ro():this.parent).get(e,t=n&Ne.Optional&&t===yr?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[Cr]=o[Cr]||[]).unshift(de(e)),r)throw o;return Ar(o,e,"R3InjectorError",this.source)}throw o}finally{xe(i),Sr(r)}var s}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((t,n)=>e.push(de(n))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,t,n){if(!(e=me(e)))return!1;let r=Te(e);const i=null==r&&e.ngModule||void 0,s=void 0===i?e:i,o=-1!==n.indexOf(s);if(void 0!==i&&(r=Te(i)),null==r)return!1;if(null!=r.imports&&!o){let e;n.push(s);try{ur(r.imports,r=>{this.processInjectorType(r,t,n)&&(void 0===e&&(e=[]),e.push(r))})}finally{}if(void 0!==e)for(let t=0;t<e.length;t++){const{ngModule:n,providers:r}=e[t];ur(r,e=>this.processProvider(e,n,r||Ge))}}this.injectorDefTypes.add(s);const a=mt(s)||(()=>new s);this.records.set(s,Uo(a,Ao));const l=r.providers;if(null!=l&&!o){const t=e;ur(l,e=>this.processProvider(e,t,l))}return void 0!==i&&void 0!==e.providers}processProvider(e,t,n){let r=Bo(e=me(e))?e:me(e&&e.provide);const i=(s=e,Vo(s)?Uo(void 0,s.useValue):Uo(Fo(s),Ao));var s;if(Bo(e)||!0!==e.multi)this.records.get(r);else{let t=this.records.get(r);t||(t=Uo(void 0,Ao,!0),t.factory=()=>Tr(t.multi),this.records.set(r,t)),r=e,t.multi.push(e)}this.records.set(r,i)}hydrate(e,t){return t.value===Ao&&(t.value=Mo,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value;var n}injectableDefInScope(e){if(!e.providedIn)return!1;const t=me(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function Lo(e){const t=be(e),n=null!==t?t.factory:mt(e);if(null!==n)return n;if(e instanceof or)throw new Error(`Token ${de(e)} is missing a \u0275prov definition.`);if(e instanceof Function)return function(e){const t=e.length;if(t>0){const n=fr(t,"?");throw new Error(`Can't resolve all parameters for ${de(e)}: (${n.join(", ")}).`)}const n=function(e){const t=e&&(e[Ie]||e[Ae]);if(t){const n=function(e){if(e.hasOwnProperty("name"))return e.name;const t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),t}return null}(e);return null!==n?()=>n.factory(e):()=>new e}(e);throw new Error("unreachable")}function Fo(e,t,n){let r;if(Bo(e)){const t=me(e);return mt(t)||Lo(t)}if(Vo(e))r=()=>me(e.useValue);else if(function(e){return!(!e||!e.useFactory)}(e))r=()=>e.useFactory(...Tr(e.deps||[]));else if(function(e){return!(!e||!e.useExisting)}(e))r=()=>Or(me(e.useExisting));else{const t=me(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return mt(t)||Lo(t);r=()=>new t(...Tr(e.deps))}return r}function Uo(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function Vo(e){return null!==e&&"object"==typeof e&&wr in e}function Bo(e){return"function"==typeof e}const $o=function(e,t,n){return function(e,t=null,n=null,r){const i=xo(e,t,n,r);return i._resolveInjectorDefTypes(),i}({name:n},t,e,n)};let zo=(()=>{class e{static create(e,t){return Array.isArray(e)?$o(e,t,""):$o(e.providers,e.parent,e.name||"")}}return e.THROW_IF_NOT_FOUND=yr,e.NULL=new Io,e.\u0275prov=Pe({token:e,providedIn:"any",factory:()=>Or(To)}),e.__NG_ELEMENT_ID__=-1,e})();function Ho(e,t){En(Pi(e)[1],Zt())}function Go(e){let t=function(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0;const r=[e];for(;t;){let i;if(pt(e))i=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");i=t.\u0275dir}if(i){if(n){r.push(i);const t=e;t.inputs=Zo(e.inputs),t.declaredInputs=Zo(e.declaredInputs),t.outputs=Zo(e.outputs);const n=i.hostBindings;n&&jo(e,n);const s=i.viewQuery,o=i.contentQueries;if(s&&qo(e,s),o&&Wo(e,o),he(e.inputs,i.inputs),he(e.declaredInputs,i.declaredInputs),he(e.outputs,i.outputs),pt(i)&&i.data.animation){const t=e.data;t.animation=(t.animation||[]).concat(i.data.animation)}}const t=i.features;if(t)for(let r=0;r<t.length;r++){const i=t[r];i&&i.ngInherit&&i(e),i===Go&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){let t=0,n=null;for(let r=e.length-1;r>=0;r--){const i=e[r];i.hostVars=t+=i.hostVars,i.hostAttrs=Mn(i.hostAttrs,n=Mn(n,i.hostAttrs))}}(r)}function Zo(e){return e===He?{}:e===Ge?[]:e}function qo(e,t){const n=e.viewQuery;e.viewQuery=n?(e,r)=>{t(e,r),n(e,r)}:t}function Wo(e,t){const n=e.contentQueries;e.contentQueries=n?(e,r,i)=>{t(e,r,i),n(e,r,i)}:t}function jo(e,t){const n=e.hostBindings;e.hostBindings=n?(e,r)=>{t(e,r),n(e,r)}:t}let Yo=null;function Ko(){if(!Yo){const e=ze.Symbol;if(e&&e.iterator)Yo=e.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const n=e[t];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(Yo=n)}}}return Yo}class Qo{constructor(e){this.wrapped=e}static wrap(e){return new Qo(e)}static unwrap(e){return Qo.isWrapped(e)?e.wrapped:e}static isWrapped(e){return e instanceof Qo}}function Xo(e){return!!Jo(e)&&(Array.isArray(e)||!(e instanceof Map)&&Ko()in e)}function Jo(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function ea(e,t,n){return e[t]=n}function ta(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function na(e,t,n,r){const i=ta(e,t,n);return ta(e,t+1,r)||i}function ra(e,t,n,r){const i=zt();return ta(i,tn(),t)&&(Ht(),oo(Cn(),i,e,t,n,r)),ra}function ia(e,t,n,r){return ta(e,tn(),n)?t+Ce(n)+r:Os}function sa(e,t,n,r,i,s){const o=na(e,en(),n,i);return nn(2),o?t+Ce(n)+r+Ce(i)+s:Os}function oa(e,t,n,r,i,s,o,a){const l=function(e,t,n,r,i){const s=na(e,t,n,r);return ta(e,t+2,i)||s}(e,en(),n,i,o);return nn(3),l?t+Ce(n)+r+Ce(i)+s+Ce(o)+a:Os}function aa(e,t,n,r,i,s){const o=zt(),a=ia(o,t,n,r);return a!==Os&&oo(Cn(),o,e,a,i,s),aa}function la(e,t,n,r,i,s,o,a){const l=zt(),c=Ht(),u=e+20,h=c.firstCreatePass?function(e,t,n,r,i,s,o,a,l){const c=t.consts,u=Fs(t,e,4,o||null,Ft(c,a));Xs(t,n,u,Ft(c,l)),En(t,u);const h=u.tViews=js(2,u,r,i,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c);return null!==t.queries&&(t.queries.template(t,u),h.queries=t.queries.embeddedTView(u)),u}(u,c,l,t,n,r,i,s,o):c.data[u];jt(h,!1);const d=l[11].createComment("");is(c,l,d,h),wi(d,l),go(l,l[u]=uo(d,l,d,h)),ft(h)&&Zs(c,l,h),null!=o&&qs(l,h,a)}function ca(e){return Rt(Bt.lFrame.contextLView,20+e)}function ua(e,t=Ne.Default){const n=zt();return null===n?Or(e,t):qn(Zt(),n,me(e),t)}function ha(e,t,n){const r=zt();return ta(r,tn(),t)&&Qs(Ht(),Cn(),r,e,t,r[11],n,!1),ha}function da(e,t,n,r,i){const s=i?"class":"style";So(e,n,t.inputs[s],s,r)}function fa(e,t,n,r){const i=zt(),s=Ht(),o=20+e,a=i[11],l=i[o]=zi(a,t,Bt.lFrame.currentNamespace),c=s.firstCreatePass?function(e,t,n,r,i,s,o){const a=t.consts,l=Fs(t,e,2,i,Ft(a,s));return Xs(t,n,l,Ft(a,o)),null!==l.attrs&&Oo(l,l.attrs,!1),null!==l.mergedAttrs&&Oo(l,l.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,l),l}(o,s,i,0,t,n,r):s.data[o];jt(c,!0);const u=c.mergedAttrs;null!==u&&In(a,l,u);const h=c.classes;null!==h&&fs(a,l,h);const d=c.styles;null!==d&&ds(a,l,d),64!=(64&c.flags)&&is(s,i,l,c),0===Bt.lFrame.elementDepthCount&&wi(l,i),Bt.lFrame.elementDepthCount++,ft(c)&&(Zs(s,i,c),Gs(s,c,i)),null!==r&&qs(i,c)}function pa(){let e=Zt();Yt()?Kt():(e=e.parent,jt(e,!1));const t=e;Bt.lFrame.elementDepthCount--;const n=Ht();n.firstCreatePass&&(En(n,e),ht(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&da(n,t,zt(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&da(n,t,zt(),t.stylesWithoutHost,!1)}function ga(e,t,n,r){fa(e,t,n,r),pa()}function ma(e,t,n){const r=zt(),i=Ht(),s=e+20,o=i.firstCreatePass?function(e,t,n,r,i){const s=t.consts,o=Ft(s,r),a=Fs(t,e,8,"ng-container",o);return null!==o&&Oo(a,o,!0),Xs(t,n,a,Ft(s,i)),null!==t.queries&&t.queries.elementStart(t,a),a}(s,i,r,t,n):i.data[s];jt(o,!0);const a=r[s]=r[11].createComment("");is(i,r,a,o),wi(a,r),ft(o)&&(Zs(i,r,o),Gs(i,o,r)),null!=n&&qs(r,o)}function ya(){let e=Zt();const t=Ht();Yt()?Kt():(e=e.parent,jt(e,!1)),t.firstCreatePass&&(En(t,e),ht(e)&&t.queries.elementEnd(e))}function va(){return zt()}function Ca(e){return!!e&&"function"==typeof e.then}const _a=function(e){return!!e&&"function"==typeof e.subscribe};function Ea(e,t,n,r){const i=zt(),s=Ht(),o=Zt();return function(e,t,n,r,i,s,o,a){const l=ft(r),c=e.firstCreatePass&&wo(e),u=t[8],h=Eo(t);let d=!0;if(3&r.type||a){const f=Mt(r,t),p=a?a(f):f,g=h.length,m=a?e=>a(kt(e[r.index])):r.index;if(Tt(n)){let o=null;if(!a&&l&&(o=function(e,t,n,r){const i=e.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const e=i[s];if(e===n&&i[s+1]===r){const e=t[7],n=i[s+2];return e.length>n?e[n]:null}"string"==typeof e&&(s+=2)}return null}(e,t,i,r.index)),null!==o)(o.__ngLastListenerFn__||o).__ngNextListenerFn__=s,o.__ngLastListenerFn__=s,d=!1;else{s=Pa(r,t,u,s,!1);const e=n.listen(p,i,s);h.push(s,e),c&&c.push(i,m,g,g+1)}}else s=Pa(r,t,u,s,!0),p.addEventListener(i,s,o),h.push(s),c&&c.push(i,m,g,o)}else s=Pa(r,t,u,s,!1);const f=r.outputs;let p;if(d&&null!==f&&(p=f[i])){const e=p.length;if(e)for(let n=0;n<e;n+=2){const e=t[p[n]][p[n+1]].subscribe(s),o=h.length;h.push(s,e),c&&c.push(i,r.index,o,-(o+1))}}}(s,i,i[11],o,e,t,!!n,r),Ea}function wa(e,t,n,r){try{return!1!==n(r)}catch(i){return Po(e,i),!1}}function Pa(e,t,n,r,i){return function n(s){if(s===Function)return r;const o=2&e.flags?xt(e.index,t):t;0==(32&t[2])&&mo(o);let a=wa(t,0,r,s),l=n.__ngNextListenerFn__;for(;l;)a=wa(t,0,l,s)&&a,l=l.__ngNextListenerFn__;return i&&!1===a&&(s.preventDefault(),s.returnValue=!1),a}}function Sa(e=1){return function(e){return(Bt.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,Bt.lFrame.contextLView))[8]}(e)}function ba(e,t){let n=null;const r=function(e){const t=e.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(e);for(let i=0;i<t.length;i++){const s=t[i];if("*"!==s){if(null===r?ws(e,s,!0):Ps(r,s))return i}else n=i}return n}function Oa(e,t,n){return Ta(e,"",t,"",n),Oa}function Ta(e,t,n,r,i){const s=zt(),o=ia(s,t,n,r);return o!==Os&&Qs(Ht(),Cn(),s,e,o,s[11],i,!1),Ta}function Ia(e,t,n,r,i,s,o){const a=zt(),l=sa(a,t,n,r,i,s);return l!==Os&&Qs(Ht(),Cn(),a,e,l,a[11],o,!1),Ia}function ka(e,t,n,r,i,s,o,a,l){const c=zt(),u=oa(c,t,n,r,i,s,o,a);return u!==Os&&Qs(Ht(),Cn(),c,e,u,c[11],l,!1),ka}function Aa(e,t,n,r,i){const s=e[n+1],o=null===t;let a=r?As(s):Ns(s),l=!1;for(;0!==a&&(!1===l||o);){const n=e[a+1];Ma(e[a],t)&&(l=!0,e[a+1]=r?xs(n):Ms(n)),a=r?As(n):Ns(n)}l&&(e[n+1]=r?Ms(s):xs(s))}function Ma(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&mr(e,t)>=0}const Na={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Ra(e){return e.substring(Na.key,Na.keyEnd)}function xa(e){return e.substring(Na.value,Na.valueEnd)}function Da(e,t){const n=Na.textEnd;let r=Na.key=La(e,t,n);return n===r?-1:(r=Na.keyEnd=function(e,t,n){let r;for(;t<n&&(45===(r=e.charCodeAt(t))||95===r||(-33&r)>=65&&(-33&r)<=90||r>=48&&r<=57);)t++;return t}(e,r,n),r=Fa(e,r,n),r=Na.value=La(e,r,n),r=Na.valueEnd=function(e,t,n){let r=-1,i=-1,s=-1,o=t,a=o;for(;o<n;){const l=e.charCodeAt(o++);if(59===l)return a;34===l||39===l?a=o=Ua(e,l,o,n):t===o-4&&85===s&&82===i&&76===r&&40===l?a=o=Ua(e,41,o,n):l>32&&(a=o),s=i,i=r,r=-33&l}return a}(e,r,n),Fa(e,r,n))}function La(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function Fa(e,t,n,r){return(t=La(e,t,n))<n&&t++,t}function Ua(e,t,n,r){let i=-1,s=n;for(;s<r;){const n=e.charCodeAt(s++);if(n==t&&92!==i)return s;i=92==n&&92===i?0:n}throw new Error}function Va(e,t){return function(e,t,n,r){const i=zt(),s=Ht(),o=nn(2);s.firstUpdatePass&&Ha(s,e,o,r),t!==Os&&ta(i,o,t)&&Wa(s,s.data[yn()],i,i[11],e,i[o+1]=function(e,t){return null==e||("string"==typeof t?e+=t:"object"==typeof e&&(e=de(Gr(e)))),e}(t,n),r,o)}(e,t,null,!0),Va}function Ba(e){!function(e,t,n,r){const i=Ht(),s=nn(2);i.firstUpdatePass&&Ha(i,null,s,r);const o=zt();if(n!==Os&&ta(o,s,n)){const a=i.data[yn()];if(Ka(a,r)&&!za(i,s)){let e=r?a.classesWithoutHost:a.stylesWithoutHost;null!==e&&(n=fe(e,n||"")),da(i,a,o,n,r)}else!function(e,t,n,r,i,s,o,a){i===Os&&(i=Ge);let l=0,c=0,u=0<i.length?i[0]:null,h=0<s.length?s[0]:null;for(;null!==u||null!==h;){const d=l<i.length?i[l+1]:void 0,f=c<s.length?s[c+1]:void 0;let p,g=null;u===h?(l+=2,c+=2,d!==f&&(g=h,p=f)):null===h||null!==u&&u<h?(l+=2,g=u):(c+=2,g=h,p=f),null!==g&&Wa(e,t,n,r,g,p,o,a),u=l<i.length?i[l]:null,h=c<s.length?s[c]:null}}(i,a,o,o[11],o[s+1],o[s+1]=function(e,t,n){if(null==n||""===n)return Ge;const r=[],i=Gr(n);if(Array.isArray(i))for(let s=0;s<i.length;s++)e(r,i[s],!0);else if("object"==typeof i)for(const s in i)i.hasOwnProperty(s)&&e(r,s,i[s]);else"string"==typeof i&&t(r,i);return r}(e,t,n),r,s)}}(qa,$a,e,!1)}function $a(e,t){for(let n=function(e){return function(e){Na.key=0,Na.keyEnd=0,Na.value=0,Na.valueEnd=0,Na.textEnd=e.length}(e),Da(e,La(e,0,Na.textEnd))}(t);n>=0;n=Da(t,n))qa(e,Ra(t),xa(t))}function za(e,t){return t>=e.expandoStartIndex}function Ha(e,t,n,r){const i=e.data;if(null===i[n+1]){const s=i[yn()],o=za(e,n);Ka(s,r)&&null===t&&!o&&(t=!1),t=function(e,t,n,r){const i=function(e){const t=Bt.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e);let s=r?t.residualClasses:t.residualStyles;if(null===i)0===(r?t.classBindings:t.styleBindings)&&(n=Za(n=Ga(null,e,t,n,r),t.attrs,r),s=null);else{const o=t.directiveStylingLast;if(-1===o||e[o]!==i)if(n=Ga(i,e,t,n,r),null===s){let n=function(e,t,n){const r=n?t.classBindings:t.styleBindings;if(0!==Ns(r))return e[As(r)]}(e,t,r);void 0!==n&&Array.isArray(n)&&(n=Ga(null,e,t,n[1],r),n=Za(n,t.attrs,r),function(e,t,n,r){e[As(n?t.classBindings:t.styleBindings)]=r}(e,t,r,n))}else s=function(e,t,n){let r;const i=t.directiveEnd;for(let s=1+t.directiveStylingLast;s<i;s++)r=Za(r,e[s].hostAttrs,n);return Za(r,t.attrs,n)}(e,t,r)}return void 0!==s&&(r?t.residualClasses=s:t.residualStyles=s),n}(i,s,t,r),function(e,t,n,r,i,s){let o=s?t.classBindings:t.styleBindings,a=As(o),l=Ns(o);e[r]=n;let c,u=!1;if(Array.isArray(n)){const e=n;c=e[1],(null===c||mr(e,c)>0)&&(u=!0)}else c=n;if(i)if(0!==l){const t=As(e[a+1]);e[r+1]=ks(t,a),0!==t&&(e[t+1]=Rs(e[t+1],r)),e[a+1]=function(e,t){return 131071&e|t<<17}(e[a+1],r)}else e[r+1]=ks(a,0),0!==a&&(e[a+1]=Rs(e[a+1],r)),a=r;else e[r+1]=ks(l,0),0===a?a=r:e[l+1]=Rs(e[l+1],r),l=r;u&&(e[r+1]=Ms(e[r+1])),Aa(e,c,r,!0),Aa(e,c,r,!1),function(e,t,n,r,i){const s=i?e.residualClasses:e.residualStyles;null!=s&&"string"==typeof t&&mr(s,t)>=0&&(n[r+1]=xs(n[r+1]))}(t,c,e,r,s),o=ks(a,l),s?t.classBindings=o:t.styleBindings=o}(i,s,t,n,o,r)}}function Ga(e,t,n,r,i){let s=null;const o=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<o&&(s=t[a],r=Za(r,s.hostAttrs,i),s!==e);)a++;return null!==e&&(n.directiveStylingLast=a),r}function Za(e,t,n){const r=n?1:2;let i=-1;if(null!==t)for(let s=0;s<t.length;s++){const o=t[s];"number"==typeof o?i=o:i===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),pr(e,o,!!n||t[++s]))}return void 0===e?null:e}function qa(e,t,n){pr(e,t,Gr(n))}function Wa(e,t,n,r,i,s,o,a){if(!(3&t.type))return;const l=e.data,c=l[a+1];Ya(function(e){return 1==(1&e)}(c)?ja(l,t,n,i,Ns(c),o):void 0)||(Ya(s)||function(e){return 2==(2&e)}(c)&&(s=ja(l,null,n,i,a,o)),function(e,t,n,r,i){const s=Tt(e);if(t)i?s?e.addClass(n,r):n.classList.add(r):s?e.removeClass(n,r):n.classList.remove(r);else{let t=-1===r.indexOf("-")?void 0:Mi.DashCase;if(null==i)s?e.removeStyle(n,r,t):n.style.removeProperty(r);else{const o="string"==typeof i&&i.endsWith("!important");o&&(i=i.slice(0,-10),t|=Mi.Important),s?e.setStyle(n,r,i,t):n.style.setProperty(r,i,o?"important":"")}}}(r,o,At(yn(),n),i,s))}function ja(e,t,n,r,i,s){const o=null===t;let a;for(;i>0;){const t=e[i],s=Array.isArray(t),l=s?t[1]:t,c=null===l;let u=n[i+1];u===Os&&(u=c?Ge:void 0);let h=c?gr(u,r):l===r?u:void 0;if(s&&!Ya(h)&&(h=gr(t,r)),Ya(h)&&(a=h,o))return a;const d=e[i+1];i=o?As(d):Ns(d)}if(null!==t){let e=s?t.residualClasses:t.residualStyles;null!=e&&(a=gr(e,r))}return a}function Ya(e){return void 0!==e}function Ka(e,t){return 0!=(e.flags&(t?16:32))}function Qa(e,t=""){const n=zt(),r=Ht(),i=e+20,s=r.firstCreatePass?Fs(r,i,1,t,null):r.data[i],o=n[i]=Vi(n[11],t);is(r,n,o,s),jt(s,!1)}function Xa(e){return Ja("",e,""),Xa}function Ja(e,t,n){const r=zt(),i=ia(r,e,t,n);return i!==Os&&bo(r,yn(),i),Ja}function el(e,t,n,r,i){const s=zt(),o=sa(s,e,t,n,r,i);return o!==Os&&bo(s,yn(),o),el}function tl(e,t,n,r,i,s,o){const a=zt(),l=oa(a,e,t,n,r,i,s,o);return l!==Os&&bo(a,yn(),l),tl}function nl(e,t,n){const r=zt();return ta(r,tn(),t)&&Qs(Ht(),Cn(),r,e,t,r[11],n,!0),nl}const rl=void 0;var il=["en",[["a","p"],["AM","PM"],rl],[["AM","PM"],rl,rl],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],rl,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],rl,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",rl,"{1} 'at' {0}",rl],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){const t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}];let sl={};function ol(e){const t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e);let n=ll(t);if(n)return n;const r=t.split("-")[0];if(n=ll(r),n)return n;if("en"===r)return il;throw new Error(`Missing locale data for the locale "${e}".`)}function al(e){return ol(e)[cl.PluralCase]}function ll(e){return e in sl||(sl[e]=ze.ng&&ze.ng.common&&ze.ng.common.locales&&ze.ng.common.locales[e]),sl[e]}var cl=(()=>((cl=cl||{})[cl.LocaleId=0]="LocaleId",cl[cl.DayPeriodsFormat=1]="DayPeriodsFormat",cl[cl.DayPeriodsStandalone=2]="DayPeriodsStandalone",cl[cl.DaysFormat=3]="DaysFormat",cl[cl.DaysStandalone=4]="DaysStandalone",cl[cl.MonthsFormat=5]="MonthsFormat",cl[cl.MonthsStandalone=6]="MonthsStandalone",cl[cl.Eras=7]="Eras",cl[cl.FirstDayOfWeek=8]="FirstDayOfWeek",cl[cl.WeekendRange=9]="WeekendRange",cl[cl.DateFormat=10]="DateFormat",cl[cl.TimeFormat=11]="TimeFormat",cl[cl.DateTimeFormat=12]="DateTimeFormat",cl[cl.NumberSymbols=13]="NumberSymbols",cl[cl.NumberFormats=14]="NumberFormats",cl[cl.CurrencyCode=15]="CurrencyCode",cl[cl.CurrencySymbol=16]="CurrencySymbol",cl[cl.CurrencyName=17]="CurrencyName",cl[cl.Currencies=18]="Currencies",cl[cl.Directionality=19]="Directionality",cl[cl.PluralCase=20]="PluralCase",cl[cl.ExtraData=21]="ExtraData",cl))();const ul=["zero","one","two","few","many"],hl="en-US",dl={marker:"element"},fl={marker:"ICU"};var pl=(()=>((pl=pl||{})[pl.SHIFT=2]="SHIFT",pl[pl.APPEND_EAGERLY=1]="APPEND_EAGERLY",pl[pl.COMMENT=2]="COMMENT",pl))();let gl=hl;function ml(e){(function(e,t){null==e&&we(t,e,null,"!=")})(e,"Expected localeId to be defined"),"string"==typeof e&&(gl=e.toLowerCase().replace(/_/g,"-"))}function yl(e,t,n){const r=t.insertBeforeIndex,i=Array.isArray(r)?r[0]:r;return null===i?es(e,0,n):kt(n[i])}function vl(e,t,n,r,i){const s=t.insertBeforeIndex;if(Array.isArray(s)){let o=r,a=null;if(3&t.type||(a=o,o=i),null!==o&&0==(2&t.flags))for(let t=1;t<s.length;t++)Yi(e,o,n[s[t]],a,!1)}}function Cl(e,t){if(e.push(t),e.length>1)for(let n=e.length-2;n>=0;n--){const r=e[n];_l(r)||El(r,t)&&null===wl(r)&&Pl(r,t.index)}}function _l(e){return!(64&e.type)}function El(e,t){return _l(t)||e.index>t.index}function wl(e){const t=e.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function Pl(e,t){const n=e.insertBeforeIndex;Array.isArray(n)?n[0]=t:(rs(yl,vl),e.insertBeforeIndex=t)}function Sl(e,t){const n=e.data[t];return null===n||"string"==typeof n?null:n.hasOwnProperty("currentCaseLViewIndex")?n:n.value}function bl(e,t,n){const r=Us(e,n,64,null,null);return Cl(t,r),r}function Ol(e,t){const n=t[e.currentCaseLViewIndex];return null===n?n:n<0?~n:n}function Tl(e){return e>>>17}function Il(e){return(131070&e)>>>1}let kl=0,Al=0;function Ml(e,t,n,r){const i=n[11];let s,o=null;for(let a=0;a<t.length;a++){const l=t[a];if("string"==typeof l){const e=t[++a];null===n[e]&&(n[e]=Vi(i,l))}else if("number"==typeof l)switch(1&l){case 0:const c=Tl(l);let u,h;if(null===o&&(o=c,s=Xi(i,r)),c===o?(u=r,h=s):(u=null,h=kt(n[c])),null!==h){const t=Il(l);Yi(i,h,n[t],u,!1);const r=Sl(e,t);if(null!==r&&"object"==typeof r){const t=Ol(r,n);null!==t&&Ml(e,r.create[t],n,n[r.anchorIdx])}}break;case 1:const d=t[++a],f=t[++a];ao(i,At(l>>>1,n),null,null,d,f,null);break;default:throw new Error(`Unable to determine the type of mutate operation for "${l}"`)}else switch(l){case fl:const e=t[++a],r=t[++a];null===n[r]&&wi(n[r]=$i(i,e),n);break;case dl:const s=t[++a],o=t[++a];null===n[o]&&wi(n[o]=zi(i,s,null),n)}}}function Nl(e,t,n,r,i){for(let s=0;s<n.length;s++){const o=n[s],a=n[++s];if(o&i){let i="";for(let o=s+1;o<=s+a;o++){const s=n[o];if("string"==typeof s)i+=s;else if("number"==typeof s)if(s<0)i+=Ce(t[r-s]);else{const a=s>>>2;switch(3&s){case 1:const s=n[++o],l=n[++o],c=e.data[a];"string"==typeof c?ao(t[11],t[a],null,c,s,i,l):Qs(e,c,t,s,i,t[11],l,!1);break;case 0:const u=t[a];null!==u&&Bi(t[11],u,i);break;case 2:xl(e,Sl(e,a),t,i);break;case 3:Rl(e,Sl(e,a),r,t)}}}}else{const i=n[s+1];if(i>0&&3==(3&i)){const n=Sl(e,i>>>2);t[n.currentCaseLViewIndex]<0&&Rl(e,n,r,t)}}s+=a}}function Rl(e,t,n,r){let i=r[t.currentCaseLViewIndex];if(null!==i){let s=kl;i<0&&(i=r[t.currentCaseLViewIndex]=~i,s=-1),Nl(e,r,t.update[i],n,s)}}function xl(e,t,n,r){const i=function(e,t){let n=e.cases.indexOf(t);if(-1===n)switch(e.type){case 1:{const r=function(e,t){const n=al(t)(parseInt(e,10)),r=ul[n];return void 0!==r?r:"other"}(t,gl);n=e.cases.indexOf(r),-1===n&&"other"!==r&&(n=e.cases.indexOf("other"));break}case 0:n=e.cases.indexOf("other")}return-1===n?null:n}(t,r);if(Ol(t,n)!==i&&(Dl(e,t,n),n[t.currentCaseLViewIndex]=null===i?null:~i,null!==i)){const r=n[t.anchorIdx];r&&Ml(e,t.create[i],n,r)}}function Dl(e,t,n){let r=Ol(t,n);if(null!==r){const i=t.remove[r];for(let t=0;t<i.length;t++){const r=i[t];if(r>0){const e=At(r,n);null!==e&&ls(n[11],e)}else Dl(e,Sl(e,~r),n)}}}function Ll(){const e=[];let t,n,r=-1;function i(e,t){r=0;const i=Ol(e,t);n=null!==i?e.remove[i]:Ge}function s(){if(r<n.length){const o=n[r++];return o>0?t[o]:(e.push(r,n),i(t[1].data[~o],t),s())}return 0===e.length?null:(n=e.pop(),r=e.pop(),s())}return function(n,r){for(t=r;e.length;)e.pop();return i(n.value,r),s}}const Fl=/\ufffd(\d+):?\d*\ufffd/gi,Ul=/\ufffd(\d+)\ufffd/,Vl=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,Bl=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,$l=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,zl=/\uE500/g;function Hl(e,t,n,r,i,s,o){const a=Vs(e,r,1,null);let l=a<<pl.SHIFT,c=Wt();t===c&&(c=null),null===c&&(l|=pl.APPEND_EAGERLY),o&&(l|=pl.COMMENT,function(e){void 0===Ni&&(Ni=e())}(Ll)),i.push(l,null===s?"":s);const u=Us(e,a,o?32:1,null===s?"":s,null);Cl(n,u);const h=u.index;return jt(u,!1),null!==c&&t!==c&&function(e,t){let n=e.insertBeforeIndex;null===n?(rs(yl,vl),n=e.insertBeforeIndex=[null,t]):(function(e,t,n){e!=t&&we(n,e,t,"==")}(Array.isArray(n),!0,"Expecting array here"),n.push(t))}(c,h),u}function Gl(e,t,n,r,i,s,o){const a=o.match(Fl),l=Hl(e,t,n,s,r,a?null:o,!1);a&&Zl(i,o,l.index,null,0,null)}function Zl(e,t,n,r,i,s){const o=e.length,a=o+1;e.push(null,null);const l=o+2,c=t.split(Fl);let u=0;for(let h=0;h<c.length;h++){const t=c[h];if(1&h){const n=i+parseInt(t,10);e.push(-1-n),u|=ql(n)}else""!==t&&e.push(t)}return e.push(n<<2|(r?1:0)),r&&e.push(r,s),e[o]=u,e[a]=e.length-l,u}function ql(e){return 1<<Math.min(e,31)}function Wl(e){let t,n,r="",i=0,s=!1;for(;null!==(t=Bl.exec(e));)s?t[0]===`\ufffd/*${n}\ufffd`&&(i=t.index,s=!1):(r+=e.substring(i,t.index+t[0].length),n=t[1],s=!0);return r+=e.substr(i),r}function jl(e,t,n,r,i,s){let o=0;const a={type:i.type,currentCaseLViewIndex:Vs(e,t,1,null),anchorIdx:s,cases:[],create:[],remove:[],update:[]};(function(e,t,n){e.push(ql(t.mainBinding),2,-1-t.mainBinding,n<<2|2)})(n,i,s),function(e,t,n){const r=e.data[t];null===r?e.data[t]=n:r.value=n}(e,s,a);const l=i.values;for(let c=0;c<l.length;c++){const s=l[c],u=[];for(let e=0;e<s.length;e++){const t=s[e];if("string"!=typeof t){const n=u.push(t)-1;s[e]=`\x3c!--\ufffd${n}\ufffd--\x3e`}}o=Ql(e,a,t,n,r,i.cases[c],s.join(""),u)|o}o&&function(e,t,n){e.push(t,1,n<<2|3)}(n,o,s)}function Yl(e){const t=[],n=[];let r=1,i=0;const s=Kl(e=e.replace(Vl,function(e,t,n){return r="select"===n?0:1,i=parseInt(t.substr(1),10),""}));for(let o=0;o<s.length;){let e=s[o++].trim();1===r&&(e=e.replace(/\s*(?:=)?(\w+)\s*/,"$1")),e.length&&t.push(e);const i=Kl(s[o++]);t.length>n.length&&n.push(i)}return{type:r,mainBinding:i,cases:t,values:n}}function Kl(e){if(!e)return[];let t=0;const n=[],r=[],i=/[{}]/g;let s;for(i.lastIndex=0;s=i.exec(e);){const i=s.index;if("}"==s[0]){if(n.pop(),0==n.length){const n=e.substring(t,i);Vl.test(n)?r.push(Yl(n)):r.push(n),t=i+1}}else{if(0==n.length){const n=e.substring(t,i);r.push(n),t=i+1}n.push("{")}}const o=e.substring(t);return r.push(o),r}function Ql(e,t,n,r,i,s,o,a){const l=[],c=[],u=[];t.cases.push(s),t.create.push(l),t.remove.push(c),t.update.push(u);const h=Wr(Ot()).getInertBodyElement(o),d=mi(h)||h;return d?Xl(e,t,n,r,l,c,u,d,i,a,0):0}function Xl(e,t,n,r,i,s,o,a,l,c,u){let h=0,d=a.firstChild;for(;d;){const a=Vs(e,n,1,null);switch(d.nodeType){case Node.ELEMENT_NODE:const f=d,p=f.tagName.toLowerCase();if(si.hasOwnProperty(p)){tc(i,dl,p,l,a),e.data[a]=p;const g=f.attributes;for(let e=0;e<g.length;e++){const t=g.item(e),n=t.name.toLowerCase();t.value.match(Fl)?li.hasOwnProperty(n)&&Zl(o,t.value,a,t.name,0,oi[n]?Xr:ai[n]?Jr:null):nc(i,a,t)}h=Xl(e,t,n,r,i,s,o,d,a,c,u+1)|h,Jl(s,a,u)}break;case Node.TEXT_NODE:const g=d.textContent||"",m=g.match(Fl);tc(i,null,m?"":g,l,a),Jl(s,a,u),m&&(h=Zl(o,g,a,null,0,null)|h);break;case Node.COMMENT_NODE:const y=Ul.exec(d.textContent||"");if(y){const t=c[parseInt(y[1],10)];tc(i,fl,"",l,a),jl(e,n,r,l,t,a),ec(s,a,u)}}d=d.nextSibling}return h}function Jl(e,t,n){0===n&&e.push(t)}function ec(e,t,n){0===n&&(e.push(~t),e.push(t))}function tc(e,t,n,r,i){null!==t&&e.push(t),e.push(n,i,function(e,t,n){return 0|t<<17|n<<1}(0,r,i))}function nc(e,t,n){e.push(t<<1|1,n.name,n.value)}function rc(e,t,n=-1){const r=Ht(),i=zt(),s=20+e,o=Ft(r.consts,t),a=Wt();r.firstCreatePass&&function(e,t,n,r,i,s){const o=Wt(),a=[],l=[],c=[[]];i=function(e,t){if(function(e){return-1===e}(t))return Wl(e);{const n=e.indexOf(`:${t}\ufffd`)+2+t.toString().length,r=e.search(new RegExp(`\ufffd\\/\\*\\d+:${t}\ufffd`));return Wl(e.substring(n,r))}}(i,s);const u=function(e){return e.replace(zl," ")}(i).split($l);for(let h=0;h<u.length;h++){let r=u[h];if(0==(1&h)){const s=Kl(r);for(let r=0;r<s.length;r++){let u=s[r];if(0==(1&r)){const t=u;""!==t&&Gl(e,o,c[0],a,l,n,t)}else{const r=u;if("object"!=typeof r)throw new Error(`Unable to parse ICU expression in "${i}" message.`);jl(e,n,l,t,r,Hl(e,o,c[0],n,a,"",!0).index)}}}else{const t=47===r.charCodeAt(0),n=(r.charCodeAt(t?1:0),20+Number.parseInt(r.substring(t?2:1)));if(t)c.shift(),jt(Wt(),!1);else{const t=bl(e,c[0],n);c.unshift([]),jt(t,!0)}}}e.data[r]={create:a,update:l}}(r,null===a?0:a.index,i,s,o,n);const l=r.data[s],c=ji(r,a===i[6]?null:a,i);(function(e,t,n,r){const i=e[11];for(let s=0;s<t.length;s++){const o=t[s++],a=t[s],l=(o&pl.COMMENT)===pl.COMMENT,c=(o&pl.APPEND_EAGERLY)===pl.APPEND_EAGERLY,u=o>>>pl.SHIFT;let h=e[u];null===h&&(h=e[u]=l?i.createComment(a):Vi(i,a)),c&&null!==n&&Yi(i,n,h,r,!1)}})(i,l.create,c,a&&8&a.type?i[a.index]:null),rn(!0)}function ic(){rn(!1)}function sc(e,t,n){rc(e,t,n),ic()}function oc(e){return function(e){e&&(kl|=1<<Math.min(Al,31)),Al++}(ta(zt(),tn(),e)),oc}function ac(e){!function(e,t,n){if(Al>0){const r=e.data[n];Nl(e,t,Array.isArray(r)?r:r.update,en()-Al-1,kl)}kl=0,Al=0}(Ht(),zt(),e+20)}function lc(e,t,n,r,i){if(e=me(e),Array.isArray(e))for(let s=0;s<e.length;s++)lc(e[s],t,n,r,i);else{const s=Ht(),o=zt();let a=Bo(e)?e:me(e.provide),l=Fo(e);const c=Zt(),u=1048575&c.providerIndexes,h=c.directiveStart,d=c.providerIndexes>>20;if(Bo(e)||!e.multi){const r=new Tn(l,i,ua),f=hc(a,t,i?u:u+d,h);-1===f?(Hn(Vn(c,o),s,a),cc(s,e,t.length),t.push(a),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),n.push(r),o.push(r)):(n[f]=r,o[f]=r)}else{const f=hc(a,t,u+d,h),p=hc(a,t,u,u+d),g=f>=0&&n[f],m=p>=0&&n[p];if(i&&!m||!i&&!g){Hn(Vn(c,o),s,a);const u=function(e,t,n,r,i){const s=new Tn(e,n,ua);return s.multi=[],s.index=t,s.componentProviders=0,uc(s,i,r&&!n),s}(i?fc:dc,n.length,i,r,l);!i&&m&&(n[p].providerFactory=u),cc(s,e,t.length,0),t.push(a),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),n.push(u),o.push(u)}else cc(s,e,f>-1?f:p,uc(n[i?p:f],l,!i&&r));!i&&r&&m&&n[p].componentProviders++}}}function cc(e,t,n,r){const i=Bo(t);if(i||function(e){return!!e.useClass}(t)){const s=(t.useClass||t).prototype.ngOnDestroy;if(s){const o=e.destroyHooks||(e.destroyHooks=[]);if(!i&&t.multi){const e=o.indexOf(n);-1===e?o.push(n,[r,s]):o[e+1].push(r,s)}else o.push(n,s)}}}function uc(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function hc(e,t,n,r){for(let i=n;i<r;i++)if(t[i]===e)return i;return-1}function dc(e,t,n,r){return pc(this.multi,[])}function fc(e,t,n,r){const i=this.multi;let s;if(this.providerFactory){const e=this.providerFactory.componentProviders,t=Qn(n,n[1],this.providerFactory.index,r);s=t.slice(0,e),pc(i,s);for(let n=e;n<t.length;n++)s.push(t[n])}else s=[],pc(i,s);return s}function pc(e,t){for(let n=0;n<e.length;n++)t.push((0,e[n])());return t}function gc(e,t=[]){return n=>{n.providersResolver=(n,r)=>function(e,t,n){const r=Ht();if(r.firstCreatePass){const i=pt(e);lc(n,r.data,r.blueprint,i,!0),lc(t,r.data,r.blueprint,i,!1)}}(n,r?r(e):e,t)}}class mc{}const yc="ngComponent";class vc{resolveComponentFactory(e){throw function(e){const t=Error(`No component factory found for ${de(e)}. Did you add it to @NgModule.entryComponents?`);return t[yc]=e,t}(e)}}let Cc=(()=>{class e{}return e.NULL=new vc,e})();function _c(...e){}function Ec(e,t){return new Pc(Mt(e,t))}const wc=function(){return Ec(Zt(),zt())};let Pc=(()=>{class e{constructor(e){this.nativeElement=e}}return e.__NG_ELEMENT_ID__=wc,e})();function Sc(e){return e instanceof Pc?e.nativeElement:e}class bc{}let Oc=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>Tc(),e})();const Tc=function(){const e=zt(),t=xt(Zt().index,e);return function(e){return e[11]}(ct(t)?t:e)};let Ic=(()=>{class e{}return e.\u0275prov=Pe({token:e,providedIn:"root",factory:()=>null}),e})();class kc{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const Ac=new kc("12.2.16");class Mc{constructor(){}supports(e){return Xo(e)}create(e){return new Rc(e)}}const Nc=(e,t)=>t;class Rc{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Nc}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,r=0,i=null;for(;t||n;){const s=!n||t&&t.currentIndex<Fc(n,r,i)?t:n,o=Fc(s,r,i),a=s.currentIndex;if(s===n)r--,n=n._nextRemoved;else if(t=t._next,null==s.previousIndex)r++;else{i||(i=[]);const e=o-r,t=a-r;if(e!=t){for(let n=0;n<e;n++){const r=n<i.length?i[n]:i[n]=0,s=r+n;t<=s&&s<e&&(i[n]=r+1)}i[s.previousIndex]=t-e}}o!==a&&e(s,o,a)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Xo(e))throw new Error(`Error trying to diff '${de(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t,n,r,i=this._itHead,s=!1;if(Array.isArray(e)){this.length=e.length;for(let t=0;t<this.length;t++)n=e[t],r=this._trackByFn(t,n),null!==i&&Object.is(i.trackById,r)?(s&&(i=this._verifyReinsertion(i,n,r,t)),Object.is(i.item,n)||this._addIdentityChange(i,n)):(i=this._mismatch(i,n,r,t),s=!0),i=i._next}else t=0,function(e,t){if(Array.isArray(e))for(let n=0;n<e.length;n++)t(e[n]);else{const n=e[Ko()]();let r;for(;!(r=n.next()).done;)t(r.value)}}(e,e=>{r=this._trackByFn(t,e),null!==i&&Object.is(i.trackById,r)?(s&&(i=this._verifyReinsertion(i,e,r,t)),Object.is(i.item,e)||this._addIdentityChange(i,e)):(i=this._mismatch(i,e,r,t),s=!0),i=i._next,t++}),this.length=t;return this._truncate(i),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,r){let i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,r)):e=this._addAfter(new xc(t,n),i,r),e}_verifyReinsertion(e,t,n,r){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?e=this._reinsertAfter(i,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,i=e._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new Lc),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Lc),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class xc{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Dc{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class Lc{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new Dc,this.map.set(t,n)),n.add(e)}get(e,t){const n=this.map.get(e);return n?n.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Fc(e,t,n){const r=e.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+t+i}class Uc{constructor(){}supports(e){return e instanceof Map||Jo(e)}create(){return new Vc}}class Vc{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||Jo(e)))throw new Error(`Error trying to diff '${de(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(e,n)=>{if(t&&t.key===n)this._maybeAddToChanges(t,e),this._appendAfter=t,t=t._next;else{const r=this._getOrCreateRecordForKey(n,e);t=this._insertBeforeOrAppend(t,r)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let e=t;null!==e;e=e._nextRemoved)e===this._mapHead&&(this._mapHead=null),this._records.delete(e.key),e._nextRemoved=e._next,e.previousValue=e.currentValue,e.currentValue=null,e._prev=null,e._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const n=this._records.get(e);this._maybeAddToChanges(n,t);const r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}const n=new Bc(e);return this._records.set(e,n),n.currentValue=t,this._addToAdditions(n),n}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(n=>t(e[n],n))}}class Bc{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function $c(){return new zc([new Mc])}let zc=(()=>{class e{constructor(e){this.factories=e}static create(t,n){if(null!=n){const e=n.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:n=>e.create(t,n||$c()),deps:[[e,new Rr,new Nr]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(null!=t)return t;throw new Error(`Cannot find a differ supporting object '${e}' of type '${function(e){return e.name||typeof e}(e)}'`)}}return e.\u0275prov=Pe({token:e,providedIn:"root",factory:$c}),e})();function Hc(){return new Gc([new Uc])}let Gc=(()=>{class e{constructor(e){this.factories=e}static create(t,n){if(n){const e=n.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:n=>e.create(t,n||Hc()),deps:[[e,new Rr,new Nr]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(t)return t;throw new Error(`Cannot find a differ supporting object '${e}'`)}}return e.\u0275prov=Pe({token:e,providedIn:"root",factory:Hc}),e})();function Zc(e,t,n,r,i=!1){for(;null!==n;){const s=t[n.index];if(null!==s&&r.push(kt(s)),ut(s))for(let e=10;e<s.length;e++){const t=s[e],n=t[1].firstChild;null!==n&&Zc(t[1],t,n,r)}const o=n.type;if(8&o)Zc(e,t,n.child,r);else if(32&o){const e=Ri(n,t);let i;for(;i=e();)r.push(i)}else if(16&o){const e=os(t,n);if(Array.isArray(e))r.push(...e);else{const n=xi(t[16]);Zc(n[1],n,e,r,!0)}}n=i?n.projectionNext:n.next}return r}class qc{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return Zc(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(ut(e)){const t=e[8],n=t?t.indexOf(this):-1;n>-1&&(Gi(e,n),dr(t,n))}this._attachedToViewContainer=!1}Zi(this._lView[1],this._lView)}onDestroy(e){Ys(this._lView[1],this._lView,null,e)}markForCheck(){mo(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){yo(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(e,t,n){Xt(!0);try{yo(e,t,n)}finally{Xt(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var e;this._appRef=null,us(this._lView[1],e=this._lView,e[11],2,null,null)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class Wc extends qc{constructor(e){super(e),this._view=e}detectChanges(){vo(this._view)}checkNoChanges(){!function(e){Xt(!0);try{vo(e)}finally{Xt(!1)}}(this._view)}get context(){return null}}const jc=function(e){return function(e,t,n){if(dt(e)&&!n){const n=xt(e.index,t);return new qc(n,n)}return 47&e.type?new qc(t[16],t):null}(Zt(),zt(),16==(16&e))};let Yc=(()=>{class e{}return e.__NG_ELEMENT_ID__=jc,e})();const Kc=[new Uc],Qc=new zc([new Mc]),Xc=new Gc(Kc),Jc=function(){return ru(Zt(),zt())};let eu=(()=>{class e{}return e.__NG_ELEMENT_ID__=Jc,e})();const tu=eu,nu=class extends tu{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}createEmbeddedView(e){const t=this._declarationTContainer.tViews,n=Ls(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];const r=this._declarationLView[19];return null!==r&&(n[19]=r.createEmbeddedView(t)),Bs(t,n,e),new qc(n)}};function ru(e,t){return 4&e.type?new nu(t,e,Ec(e,t)):null}class iu{}class su{}const ou=function(){return du(Zt(),zt())};let au=(()=>{class e{}return e.__NG_ELEMENT_ID__=ou,e})();const lu=au,cu=class extends lu{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return Ec(this._hostTNode,this._hostLView)}get injector(){return new er(this._hostTNode,this._hostLView)}get parentInjector(){const e=zn(this._hostTNode,this._hostLView);if(Rn(e)){const t=Dn(e,this._hostLView),n=xn(e);return new er(t[1].data[n+8],t)}return new er(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=uu(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,n){const r=e.createEmbeddedView(t||{});return this.insert(r,n),r}createComponent(e,t,n,r,i){const s=n||this.parentInjector;if(!i&&null==e.ngModule&&s){const e=s.get(iu,null);e&&(i=e)}const o=e.create(s,r,void 0,i);return this.insert(o.hostView,t),o}insert(e,t){const n=e._lView,r=n[1];if(ut(n[3])){const t=this.indexOf(e);if(-1!==t)this.detach(t);else{const t=n[3],r=new cu(t,t[6],t[3]);r.detach(r.indexOf(e))}}const i=this._adjustIndex(t),s=this._lContainer;!function(e,t,n,r){const i=10+r,s=n.length;r>0&&(n[i-1][4]=t),r<s-10?(t[4]=n[i],hr(n,10+r,t)):(n.push(t),t[4]=null),t[3]=n;const o=t[17];null!==o&&n!==o&&function(e,t){const n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(o,t);const a=t[19];null!==a&&a.insertView(e),t[2]|=128}(r,n,s,i);const o=as(i,s),a=n[11],l=Xi(a,s[7]);return null!==l&&function(e,t,n,r,i,s){r[0]=i,r[6]=t,us(e,r,n,1,i,s)}(r,s[6],a,n,l,o),e.attachToViewContainerRef(),hr(hu(s),i,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=uu(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=Gi(this._lContainer,t);n&&(dr(hu(this._lContainer),t),Zi(n[1],n))}detach(e){const t=this._adjustIndex(e,-1),n=Gi(this._lContainer,t);return n&&null!=dr(hu(this._lContainer),t)?new qc(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function uu(e){return e[8]}function hu(e){return e[8]||(e[8]=[])}function du(e,t){let n;const r=t[e.index];if(ut(r))n=r;else{let i;if(8&e.type)i=kt(r);else{const n=t[11];i=n.createComment("");const r=Mt(e,t);Yi(n,Xi(n,r),i,function(e,t){return Tt(e)?e.nextSibling(t):t.nextSibling}(n,r),!1)}t[e.index]=n=uo(r,t,i,e),go(t,n)}return new cu(n,e,t)}const fu={};class pu extends Cc{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=at(e);return new yu(t,this.ngModule)}}function gu(e){const t=[];for(let n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}const mu=new or("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>ki});class yu extends mc{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=e.selectors.map(bs).join(","),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return gu(this.componentDef.inputs)}get outputs(){return gu(this.componentDef.outputs)}create(e,t,n,r){const i=(r=r||this.ngModule)?function(e,t){return{get:(n,r,i)=>{const s=e.get(n,fu,i);return s!==fu||r===fu?s:t.get(n,r,i)}}}(e,r.injector):e,s=i.get(bc,It),o=i.get(Ic,null),a=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",c=n?function(e,t,n){if(Tt(e))return e.selectRootElement(t,n===Ue.ShadowDom);let r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(a,n,this.componentDef.encapsulation):zi(s.createRenderer(null,this.componentDef),l,function(e){const t=e.toLowerCase();return"svg"===t?St:"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),u=this.componentDef.onPush?576:528,h=function(e,t){return{components:[],scheduler:e||ki,clean:_o,playerHandler:t||null,flags:0}}(),d=js(0,null,null,1,0,null,null,null,null,null),f=Ls(null,d,h,u,null,null,s,a,o,i);let p,g;hn(f);try{const e=function(e,t,n,r,i,s){const o=n[1];n[20]=e;const a=Fs(o,20,2,"#host",null),l=a.mergedAttrs=t.hostAttrs;null!==l&&(Oo(a,l,!0),null!==e&&(In(i,e,l),null!==a.classes&&fs(i,e,a.classes),null!==a.styles&&ds(i,e,a.styles)));const c=r.createRenderer(e,t),u=Ls(n,Ws(t),null,t.onPush?64:16,n[20],a,r,c,s||null,null);return o.firstCreatePass&&(Hn(Vn(a,n),o,t.type),to(o,a),ro(a,n.length,1)),go(n,u),n[20]=u}(c,this.componentDef,f,s,a);if(c)if(n)In(a,c,["ng-version",Ac.full]);else{const{attrs:e,classes:t}=function(e){const t=[],n=[];let r=1,i=2;for(;r<e.length;){let s=e[r];if("string"==typeof s)2===i?""!==s&&t.push(s,e[++r]):8===i&&n.push(s);else{if(!_s(i))break;i=s}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]);e&&In(a,c,e),t&&t.length>0&&fs(a,c,t.join(" "))}if(g=Nt(d,20),void 0!==t){const e=g.projection=[];for(let n=0;n<this.ngContentSelectors.length;n++){const r=t[n];e.push(null!=r?Array.from(r):null)}}p=function(e,t,n,r,i){const s=n[1],o=function(e,t,n){const r=Zt();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),io(e,r,t,Vs(e,t,1,null),n));const i=Qn(t,e,r.directiveStart,r);wi(i,t);const s=Mt(r,t);return s&&wi(s,t),i}(s,n,t);if(r.components.push(o),e[8]=o,i&&i.forEach(e=>e(o,t)),t.contentQueries){const e=Zt();t.contentQueries(1,o,e.directiveStart)}const a=Zt();return!s.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(vn(a.index),Js(n[1],a,0,a.directiveStart,a.directiveEnd,t),eo(t,o)),o}(e,this.componentDef,f,h,[Ho]),Bs(d,f,null)}finally{mn()}return new vu(this.componentType,p,Ec(g,f),f,g)}}class vu extends class{}{constructor(e,t,n,r,i){super(),this.location=n,this._rootLView=r,this._tNode=i,this.instance=t,this.hostView=this.changeDetectorRef=new Wc(r),this.componentType=e}get injector(){return new er(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const Cu=new Map;class _u extends iu{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new pu(this);const n=lt(e),r=e[Ye]||null;r&&ml(r),this._bootstrapComponents=Ai(n.bootstrap),this._r3Injector=xo(e,t,[{provide:iu,useValue:this},{provide:Cc,useValue:this.componentFactoryResolver}],de(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=zo.THROW_IF_NOT_FOUND,n=Ne.Default){return e===zo||e===iu||e===To?this:this._r3Injector.get(e,t,n)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Eu extends su{constructor(e){super(),this.moduleType=e,null!==lt(e)&&function(e){const t=new Set;!function e(n){const r=lt(n,!0),i=r.id;null!==i&&(function(e,t,n){if(t&&t!==n)throw new Error(`Duplicate module registered for ${e} - ${de(t)} vs ${de(t.name)}`)}(i,Cu.get(i),n),Cu.set(i,n));const s=Ai(r.imports);for(const o of s)t.has(o)||(t.add(o),e(o))}(e)}(e)}create(e){return new _u(this.moduleType,e)}}function wu(e,t,n){const r=Jt()+e,i=zt();return i[r]===Os?ea(i,r,n?t.call(n):t()):function(e,t){return e[t]}(i,r)}function Pu(e,t,n,r){return Tu(zt(),Jt(),e,t,n,r)}function Su(e,t,n,r,i){return Iu(zt(),Jt(),e,t,n,r,i)}function bu(e,t,n,r,i,s,o){return function(e,t,n,r,i,s,o,a,l){const c=t+n;return function(e,t,n,r,i,s){const o=na(e,t,n,r);return na(e,t+2,i,s)||o}(e,c,i,s,o,a)?ea(e,c+4,l?r.call(l,i,s,o,a):r(i,s,o,a)):Ou(e,c+4)}(zt(),Jt(),e,t,n,r,i,s,o)}function Ou(e,t){const n=e[t];return n===Os?void 0:n}function Tu(e,t,n,r,i,s){const o=t+n;return ta(e,o,i)?ea(e,o+1,s?r.call(s,i):r(i)):Ou(e,o+1)}function Iu(e,t,n,r,i,s,o){const a=t+n;return na(e,a,i,s)?ea(e,a+2,o?r.call(o,i,s):r(i,s)):Ou(e,a+2)}function ku(e,t){const n=Ht();let r;const i=e+20;n.firstCreatePass?(r=function(e,t){if(t)for(let n=t.length-1;n>=0;n--){const r=t[n];if(e===r.name)return r}throw new ve("302",`The pipe '${e}' could not be found!`)}(t,n.pipeRegistry),n.data[i]=r,r.onDestroy&&(n.destroyHooks||(n.destroyHooks=[])).push(i,r.onDestroy)):r=n.data[i];const s=r.factory||(r.factory=mt(r.type)),o=xe(ua);try{const e=Fn(!1),t=s();return Fn(e),function(e,t,n,r){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=r}(n,zt(),i,t),t}finally{xe(o)}}function Au(e,t,n){const r=e+20,i=zt(),s=Rt(i,r);return Nu(i,Mu(i,r)?Tu(i,Jt(),t,s.transform,n,s):s.transform(n))}function Mu(e,t){return e[1].data[t].pure}function Nu(e,t){return Qo.isWrapped(t)&&(t=Qo.unwrap(t),e[en()]=Os),t}function Ru(e){return t=>{setTimeout(e,void 0,t)}}const xu=class extends A{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){var r,i,s;let o=e,l=t||(()=>null),c=n;if(e&&"object"==typeof e){const t=e;o=null===(r=t.next)||void 0===r?void 0:r.bind(t),l=null===(i=t.error)||void 0===i?void 0:i.bind(t),c=null===(s=t.complete)||void 0===s?void 0:s.bind(t)}this.__isAsync&&(l=Ru(l),o&&(o=Ru(o)),c&&(c=Ru(c)));const u=super.subscribe({next:o,error:l,complete:c});return e instanceof a&&e.add(u),u}};function Du(){return this._results[Ko()]()}class Lu{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Ko(),n=Lu.prototype;n[t]||(n[t]=Du)}get changes(){return this._changes||(this._changes=new xu)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const n=this;n.dirty=!1;const r=cr(e);(this._changesDetected=!function(e,t,n){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++){let i=e[r],s=t[r];if(n&&(i=n(i),s=n(s)),s!==i)return!1}return!0}(n._results,r,t))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class Fu{constructor(e){this.queryList=e,this.matches=null}clone(){return new Fu(this.queryList)}setDirty(){this.queryList.setDirty()}}class Uu{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let e=0;e<n;e++){const n=t.getByIndex(e);r.push(this.queries[n.indexInDeclarationView].clone())}return new Uu(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==Yu(e,t).matches&&this.queries[t].setDirty()}}class Vu{constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class Bu{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const r=null!==t?t.length:0,i=this.getByIndex(n).embeddedTView(e,r);i&&(i.indexInDeclarationView=n,null!==t?t.push(i):t=[i])}return null!==t?new Bu(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class $u{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new $u(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){const i=n[r];this.matchTNodeWithReadOption(e,t,zu(t,i)),this.matchTNodeWithReadOption(e,t,Kn(t,e,i,!1,!1))}else n===eu?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Kn(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===Pc||r===au||r===eu&&4&t.type)this.addMatch(t.index,-2);else{const n=Kn(t,e,r,!1,!1);null!==n&&this.addMatch(t.index,n)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function zu(e,t){const n=e.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function Hu(e,t,n,r){return-1===n?function(e,t){return 11&e.type?Ec(e,t):4&e.type?ru(e,t):null}(t,e):-2===n?function(e,t,n){return n===Pc?Ec(t,e):n===eu?ru(t,e):n===au?du(t,e):void 0}(e,t,r):Qn(e,e[1],n,t)}function Gu(e,t,n,r){const i=t[19].queries[r];if(null===i.matches){const r=e.data,s=n.matches,o=[];for(let e=0;e<s.length;e+=2){const i=s[e];o.push(i<0?null:Hu(t,r[i],s[e+1],n.metadata.read))}i.matches=o}return i.matches}function Zu(e,t,n,r){const i=e.queries.getByIndex(n),s=i.matches;if(null!==s){const o=Gu(e,t,i,n);for(let e=0;e<s.length;e+=2){const n=s[e];if(n>0)r.push(o[e/2]);else{const i=s[e+1],o=t[-n];for(let e=10;e<o.length;e++){const t=o[e];t[17]===t[3]&&Zu(t[1],t,i,r)}if(null!==o[9]){const e=o[9];for(let t=0;t<e.length;t++){const n=e[t];Zu(n[1],n,i,r)}}}}}return r}function qu(e){const t=zt(),n=Ht(),r=an();ln(r+1);const i=Yu(n,r);if(e.dirty&&Dt(t)===(2==(2&i.metadata.flags))){if(null===i.matches)e.reset([]);else{const s=i.crossesNgTemplate?Zu(n,t,r,[]):Gu(n,t,i,r);e.reset(s,Sc),e.notifyOnChanges()}return!0}return!1}function Wu(e,t,n){const r=Ht();r.firstCreatePass&&(function(e,t,n){null===e.queries&&(e.queries=new Bu),e.queries.track(new $u(t,n))}(r,new Vu(e,t,n),-1),2==(2&t)&&(r.staticViewQueries=!0)),function(e,t,n){const r=new Lu(4==(4&n));Ys(e,t,r,r.destroy),null===t[19]&&(t[19]=new Uu),t[19].queries.push(new Fu(r))}(r,zt(),t)}function ju(){return e=zt(),t=an(),e[19].queries[t].queryList;var e,t}function Yu(e,t){return e.queries.getByIndex(t)}function Ku(e,t){return ru(e,t)}const Qu=new or("Application Initializer");let Xu=(()=>{class e{constructor(e){this.appInits=e,this.resolve=_c,this.reject=_c,this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}runInitializers(){if(this.initialized)return;const e=[],t=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const t=this.appInits[n]();if(Ca(t))e.push(t);else if(_a(t)){const n=new Promise((e,n)=>{t.subscribe({complete:e,error:n})});e.push(n)}}Promise.all(e).then(()=>{t()}).catch(e=>{this.reject(e)}),0===e.length&&t(),this.initialized=!0}}return e.\u0275fac=function(t){return new(t||e)(Or(Qu,8))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();const Ju=new or("AppId"),eh={provide:Ju,useFactory:function(){return`${th()}${th()}${th()}`},deps:[]};function th(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const nh=new or("Platform Initializer"),rh=new or("Platform ID"),ih=new or("appBootstrapListener");let sh=(()=>{class e{log(e){console.log(e)}warn(e){console.warn(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();const oh=new or("LocaleId"),ah=new or("DefaultCurrencyCode");class lh{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}const ch=function(e){return new Eu(e)},uh=ch,hh=function(e){return Promise.resolve(ch(e))},dh=function(e){const t=ch(e),n=Ai(lt(e).declarations).reduce((e,t)=>{const n=at(t);return n&&e.push(new yu(n)),e},[]);return new lh(t,n)},fh=dh,ph=function(e){return Promise.resolve(dh(e))};let gh=(()=>{class e{constructor(){this.compileModuleSync=uh,this.compileModuleAsync=hh,this.compileModuleAndAllComponentsSync=fh,this.compileModuleAndAllComponentsAsync=ph}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();const mh=(()=>Promise.resolve(0))();function yh(e){"undefined"==typeof Zone?mh.then(()=>{e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}class vh{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new xu(!1),this.onMicrotaskEmpty=new xu(!1),this.onStable=new xu(!1),this.onError=new xu(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!n&&t,r.shouldCoalesceRunChangeDetection=n,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function(){let e=ze.requestAnimationFrame,t=ze.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){const t=()=>{!function(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(ze,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,Eh(e),e.isCheckStableRunning=!0,_h(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),Eh(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{try{return wh(e),n.invokeTask(i,s,o,a)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||e.shouldCoalesceRunChangeDetection)&&t(),Ph(e)}},onInvoke:(n,r,i,s,o,a,l)=>{try{return wh(e),n.invoke(i,s,o,a,l)}finally{e.shouldCoalesceRunChangeDetection&&t(),Ph(e)}},onHasTask:(t,n,r,i)=>{t.hasTask(r,i),n===r&&("microTask"==i.change?(e._hasPendingMicrotasks=i.microTask,Eh(e),_h(e)):"macroTask"==i.change&&(e.hasPendingMacrotasks=i.macroTask))},onHandleError:(t,n,r,i)=>(t.handleError(r,i),e.runOutsideAngular(()=>e.onError.emit(i)),!1)})}(r)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!vh.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(vh.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,r){const i=this._inner,s=i.scheduleEventTask("NgZoneEvent: "+r,e,Ch,_c,_c);try{return i.runTask(s,t,n)}finally{i.cancelTask(s)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const Ch={};function _h(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Eh(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function wh(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function Ph(e){e._nesting--,_h(e)}class Sh{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new xu,this.onMicrotaskEmpty=new xu,this.onStable=new xu,this.onError=new xu}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,r){return e.apply(t,n)}}let bh=(()=>{class e{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{vh.assertNotInAngularZone(),yh(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())yh(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(t=>!t.updateCb||!t.updateCb(e)||(clearTimeout(t.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,t,n){let r=-1;t&&t>0&&(r=setTimeout(()=>{this._callbacks=this._callbacks.filter(e=>e.timeoutId!==r),e(this._didWork,this.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:r,updateCb:n})}whenStable(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,t,n){return[]}}return e.\u0275fac=function(t){return new(t||e)(Or(vh))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),Oh=(()=>{class e{constructor(){this._applications=new Map,Ih.addToWindow(this)}registerApplication(e,t){this._applications.set(e,t)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,t=!0){return Ih.findTestabilityInTree(this,e,t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();class Th{addToWindow(e){}findTestabilityInTree(e,t,n){return null}}let Ih=new Th,kh=!0,Ah=!1;let Mh;const Nh=new or("AllowMultipleToken");class Rh{constructor(e,t){this.name=e,this.token=t}}function xh(e,t,n=[]){const r=`Platform: ${t}`,i=new or(r);return(t=[])=>{let s=Dh();if(!s||s.injector.get(Nh,!1))if(e)e(n.concat(t).concat({provide:i,useValue:!0}));else{const e=n.concat(t).concat({provide:i,useValue:!0},{provide:ko,useValue:"platform"});!function(e){if(Mh&&!Mh.destroyed&&!Mh.injector.get(Nh,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Mh=e.get(Lh);const t=e.get(nh,null);t&&t.forEach(e=>e())}(zo.create({providers:e,name:r}))}return function(e){const t=Dh();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(i)}}function Dh(){return Mh&&!Mh.destroyed?Mh:null}let Lh=(()=>{class e{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,t){const n=function(e,t){let n;return n="noop"===e?new Sh:("zone.js"===e?void 0:e)||new vh({enableLongStackTrace:(Ah=!0,kh),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),n}(t?t.ngZone:void 0,{ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1}),r=[{provide:vh,useValue:n}];return n.run(()=>{const i=zo.create({providers:r,parent:this.injector,name:e.moduleType.name}),s=e.create(i),o=s.injector.get(Oi,null);if(!o)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.runOutsideAngular(()=>{const e=n.onError.subscribe({next:e=>{o.handleError(e)}});s.onDestroy(()=>{Vh(this._modules,s),e.unsubscribe()})}),function(e,n,r){try{const t=r();return Ca(t)?t.catch(t=>{throw n.runOutsideAngular(()=>e.handleError(t)),t}):t}catch(t){throw n.runOutsideAngular(()=>e.handleError(t)),t}}(o,n,()=>{const e=s.injector.get(Xu);return e.runInitializers(),e.donePromise.then(()=>(ml(s.injector.get(oh,hl)||hl),this._moduleDoBootstrap(s),s))})})}bootstrapModule(e,t=[]){const n=Fh({},t);return function(e,t,n){const r=new Eu(n);return Promise.resolve(r)}(0,0,e).then(e=>this.bootstrapModuleFactory(e,n))}_moduleDoBootstrap(e){const t=e.injector.get(Uh);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(e=>t.bootstrap(e));else{if(!e.instance.ngDoBootstrap)throw new Error(`The module ${de(e.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);e.instance.ngDoBootstrap(t)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(e=>e.destroy()),this._destroyListeners.forEach(e=>e()),this._destroyed=!0}get destroyed(){return this._destroyed}}return e.\u0275fac=function(t){return new(t||e)(Or(zo))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();function Fh(e,t){return Array.isArray(t)?t.reduce(Fh,e):Object.assign(Object.assign({},e),t)}let Uh=(()=>{class e{constructor(e,t,n,r,i){this._zone=e,this._injector=t,this._exceptionHandler=n,this._componentFactoryResolver=r,this._initStatus=i,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new T(e=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{e.next(this._stable),e.complete()})}),o=new T(e=>{let t;this._zone.runOutsideAngular(()=>{t=this._zone.onStable.subscribe(()=>{vh.assertNotInAngularZone(),yh(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,e.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{vh.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{e.next(!1)}))});return()=>{t.unsubscribe(),n.unsubscribe()}});this.isStable=function(...e){const t=re(e),n=function(e,t){return"number"==typeof te(e)?e.pop():1/0}(e),r=e;return r.length?1===r.length?Y(r[0]):J(n)(ae(r,t)):ee}(s,o.pipe(function(e={}){const{connector:t=(()=>new A),resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=e;return e=>{let s=null,o=null,a=null,l=0,c=!1,u=!1;const h=()=>{null==o||o.unsubscribe(),o=null},d=()=>{h(),s=a=null,c=u=!1},f=()=>{const e=s;d(),null==e||e.unsubscribe()};return R((e,p)=>{l++,!u&&!c&&h();const g=a=a??t();p.add(()=>{l--,0===l&&!u&&!c&&(o=ce(f,i))}),g.subscribe(p),s||(s=new _({next:e=>g.next(e),error:e=>{u=!0,h(),o=ce(d,n,e),g.error(e)},complete:()=>{c=!0,h(),o=ce(d,r),g.complete()}}),ae(e).subscribe(s))})(e)}}()))}bootstrap(e,t){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=e instanceof mc?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);const r=function(e){return e.isBoundToModule}(n)?void 0:this._injector.get(iu),i=n.create(zo.NULL,[],t||n.selector,r),s=i.location.nativeElement,o=i.injector.get(bh,null),a=o&&i.injector.get(Oh);return o&&a&&a.registerApplication(s,o),i.onDestroy(()=>{this.detachView(i.hostView),Vh(this.components,i),a&&a.unregisterApplication(s)}),this._loadComponent(i),i}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const t=e;this._views.push(t),t.attachToAppRef(this)}detachView(e){const t=e;Vh(this._views,t),t.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(ih,[]).concat(this._bootstrapListeners).forEach(t=>t(e))}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return e.\u0275fac=function(t){return new(t||e)(Or(vh),Or(zo),Or(Oi),Or(Cc),Or(Xu))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();function Vh(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class Bh{}class $h{}const zh={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let Hh=(()=>{class e{constructor(e,t){this._compiler=e,this._config=t||zh}load(e){return this.loadAndCompile(e)}loadAndCompile(e){let[t,r]=e.split("#");return void 0===r&&(r="default"),n(8255)(t).then(e=>e[r]).then(e=>Gh(e,t,r)).then(e=>this._compiler.compileModuleAsync(e))}loadFactory(e){let[t,r]=e.split("#"),i="NgFactory";return void 0===r&&(r="default",i=""),n(8255)(this._config.factoryPathPrefix+t+this._config.factoryPathSuffix).then(e=>e[r+i]).then(e=>Gh(e,t,r))}}return e.\u0275fac=function(t){return new(t||e)(Or(gh),Or($h,8))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();function Gh(e,t,n){if(!e)throw new Error(`Cannot find '${n}' in '${t}'`);return e}const Zh=xh(null,"core",[{provide:rh,useValue:"unknown"},{provide:Lh,deps:[zo]},{provide:Oh,deps:[]},{provide:sh,deps:[]}]),qh=[{provide:Uh,useClass:Uh,deps:[vh,zo,Oi,Cc,Xu]},{provide:mu,deps:[vh],useFactory:function(e){let t=[];return e.onStable.subscribe(()=>{for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:Xu,useClass:Xu,deps:[[new Nr,Qu]]},{provide:gh,useClass:gh,deps:[]},eh,{provide:zc,useFactory:function(){return Qc},deps:[]},{provide:Gc,useFactory:function(){return Xc},deps:[]},{provide:oh,useFactory:function(e){return ml(e=e||"undefined"!=typeof $localize&&$localize.locale||hl),e},deps:[[new Mr(oh),new Nr,new Rr]]},{provide:ah,useValue:"USD"}];let Wh=(()=>{class e{constructor(e){}}return e.\u0275fac=function(t){return new(t||e)(Or(Uh))},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({providers:qh}),e})(),jh=null;function Yh(){return jh}const Kh=new or("DocumentToken");let Qh=(()=>{class e{historyGo(e){throw new Error("Not implemented")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({factory:Xh,token:e,providedIn:"platform"}),e})();function Xh(){return Or(ed)}const Jh=new or("Location Initialized");let ed=(()=>{class e extends Qh{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Yh().getBaseHref(this._doc)}onPopState(e){const t=Yh().getGlobalEventTarget(this._doc,"window");return t.addEventListener("popstate",e,!1),()=>t.removeEventListener("popstate",e)}onHashChange(e){const t=Yh().getGlobalEventTarget(this._doc,"window");return t.addEventListener("hashchange",e,!1),()=>t.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,t,n){td()?this._history.pushState(e,t,n):this.location.hash=n}replaceState(e,t,n){td()?this._history.replaceState(e,t,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return e.\u0275fac=function(t){return new(t||e)(Or(Kh))},e.\u0275prov=Pe({factory:nd,token:e,providedIn:"platform"}),e})();function td(){return!!window.history.pushState}function nd(){return new ed(Or(Kh))}function rd(e,t){if(0==e.length)return t;if(0==t.length)return e;let n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function id(e){const t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function sd(e){return e&&"?"!==e[0]?"?"+e:e}let od=(()=>{class e{historyGo(e){throw new Error("Not implemented")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({factory:ad,token:e,providedIn:"root"}),e})();function ad(e){const t=Or(Kh).location;return new cd(Or(Qh),t&&t.origin||"")}const ld=new or("appBaseHref");let cd=(()=>{class e extends od{constructor(e,t){if(super(),this._platformLocation=e,this._removeListenerFns=[],null==t&&(t=this._platformLocation.getBaseHrefFromDOM()),null==t)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=t}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return rd(this._baseHref,e)}path(e=!1){const t=this._platformLocation.pathname+sd(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?`${t}${n}`:t}pushState(e,t,n,r){const i=this.prepareExternalUrl(n+sd(r));this._platformLocation.pushState(e,t,i)}replaceState(e,t,n,r){const i=this.prepareExternalUrl(n+sd(r));this._platformLocation.replaceState(e,t,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var t,n;null===(n=(t=this._platformLocation).historyGo)||void 0===n||n.call(t,e)}}return e.\u0275fac=function(t){return new(t||e)(Or(Qh),Or(ld,8))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),ud=(()=>{class e extends od{constructor(e,t){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=t&&(this._baseHref=t)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let t=this._platformLocation.hash;return null==t&&(t="#"),t.length>0?t.substring(1):t}prepareExternalUrl(e){const t=rd(this._baseHref,e);return t.length>0?"#"+t:t}pushState(e,t,n,r){let i=this.prepareExternalUrl(n+sd(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(e,t,i)}replaceState(e,t,n,r){let i=this.prepareExternalUrl(n+sd(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var t,n;null===(n=(t=this._platformLocation).historyGo)||void 0===n||n.call(t,e)}}return e.\u0275fac=function(t){return new(t||e)(Or(Qh),Or(ld,8))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),hd=(()=>{class e{constructor(e,t){this._subject=new xu,this._urlChangeListeners=[],this._platformStrategy=e;const n=this._platformStrategy.getBaseHref();this._platformLocation=t,this._baseHref=id(fd(n)),this._platformStrategy.onPopState(e=>{this._subject.emit({url:this.path(!0),pop:!0,state:e.state,type:e.type})})}path(e=!1){return this.normalize(this._platformStrategy.path(e))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(e,t=""){return this.path()==this.normalize(e+sd(t))}normalize(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,fd(t)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}go(e,t="",n=null){this._platformStrategy.pushState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+sd(t)),n)}replaceState(e,t="",n=null){this._platformStrategy.replaceState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+sd(t)),n)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(e=0){var t,n;null===(n=(t=this._platformStrategy).historyGo)||void 0===n||n.call(t,e)}onUrlChange(e){this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(e=>{this._notifyUrlChangeListeners(e.url,e.state)}))}_notifyUrlChangeListeners(e="",t){this._urlChangeListeners.forEach(n=>n(e,t))}subscribe(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})}}return e.\u0275fac=function(t){return new(t||e)(Or(od),Or(Qh))},e.normalizeQueryParams=sd,e.joinWithSlash=rd,e.stripTrailingSlash=id,e.\u0275prov=Pe({factory:dd,token:e,providedIn:"root"}),e})();function dd(){return new hd(Or(od),Or(Qh))}function fd(e){return e.replace(/\/index.html$/,"")}var pd=(()=>((pd=pd||{})[pd.Decimal=0]="Decimal",pd[pd.Percent=1]="Percent",pd[pd.Currency=2]="Currency",pd[pd.Scientific=3]="Scientific",pd))(),gd=(()=>((gd=gd||{})[gd.Zero=0]="Zero",gd[gd.One=1]="One",gd[gd.Two=2]="Two",gd[gd.Few=3]="Few",gd[gd.Many=4]="Many",gd[gd.Other=5]="Other",gd))(),md=(()=>((md=md||{})[md.Format=0]="Format",md[md.Standalone=1]="Standalone",md))(),yd=(()=>((yd=yd||{})[yd.Narrow=0]="Narrow",yd[yd.Abbreviated=1]="Abbreviated",yd[yd.Wide=2]="Wide",yd[yd.Short=3]="Short",yd))(),vd=(()=>((vd=vd||{})[vd.Short=0]="Short",vd[vd.Medium=1]="Medium",vd[vd.Long=2]="Long",vd[vd.Full=3]="Full",vd))(),Cd=(()=>((Cd=Cd||{})[Cd.Decimal=0]="Decimal",Cd[Cd.Group=1]="Group",Cd[Cd.List=2]="List",Cd[Cd.PercentSign=3]="PercentSign",Cd[Cd.PlusSign=4]="PlusSign",Cd[Cd.MinusSign=5]="MinusSign",Cd[Cd.Exponential=6]="Exponential",Cd[Cd.SuperscriptingExponent=7]="SuperscriptingExponent",Cd[Cd.PerMille=8]="PerMille",Cd[Cd.Infinity=9]="Infinity",Cd[Cd.NaN=10]="NaN",Cd[Cd.TimeSeparator=11]="TimeSeparator",Cd[Cd.CurrencyDecimal=12]="CurrencyDecimal",Cd[Cd.CurrencyGroup=13]="CurrencyGroup",Cd))();function _d(e,t){return Od(ol(e)[cl.DateFormat],t)}function Ed(e,t){return Od(ol(e)[cl.TimeFormat],t)}function wd(e,t){return Od(ol(e)[cl.DateTimeFormat],t)}function Pd(e,t){const n=ol(e),r=n[cl.NumberSymbols][t];if(void 0===r){if(t===Cd.CurrencyDecimal)return n[cl.NumberSymbols][Cd.Decimal];if(t===Cd.CurrencyGroup)return n[cl.NumberSymbols][Cd.Group]}return r}const Sd=al;function bd(e){if(!e[cl.ExtraData])throw new Error(`Missing extra locale data for the locale "${e[cl.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Od(e,t){for(let n=t;n>-1;n--)if(void 0!==e[n])return e[n];throw new Error("Locale data API: locale data undefined")}function Td(e){const[t,n]=e.split(":");return{hours:+t,minutes:+n}}const Id=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,kd={},Ad=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Md=(()=>((Md=Md||{})[Md.Short=0]="Short",Md[Md.ShortGMT=1]="ShortGMT",Md[Md.Long=2]="Long",Md[Md.Extended=3]="Extended",Md))(),Nd=(()=>((Nd=Nd||{})[Nd.FullYear=0]="FullYear",Nd[Nd.Month=1]="Month",Nd[Nd.Date=2]="Date",Nd[Nd.Hours=3]="Hours",Nd[Nd.Minutes=4]="Minutes",Nd[Nd.Seconds=5]="Seconds",Nd[Nd.FractionalSeconds=6]="FractionalSeconds",Nd[Nd.Day=7]="Day",Nd))(),Rd=(()=>((Rd=Rd||{})[Rd.DayPeriods=0]="DayPeriods",Rd[Rd.Days=1]="Days",Rd[Rd.Months=2]="Months",Rd[Rd.Eras=3]="Eras",Rd))();function xd(e,t,n,r){let i=function(e){if(Wd(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){const[t,n=1,r=1]=e.split("-").map(e=>+e);return Dd(t,n-1,r)}const t=parseFloat(e);if(!isNaN(e-t))return new Date(t);let n;if(n=e.match(Id))return function(e){const t=new Date(0);let n=0,r=0;const i=e[8]?t.setUTCFullYear:t.setFullYear,s=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),r=Number(e[9]+e[11])),i.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));const o=Number(e[4]||0)-n,a=Number(e[5]||0)-r,l=Number(e[6]||0),c=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return s.call(t,o,a,l,c),t}(n)}const t=new Date(e);if(!Wd(t))throw new Error(`Unable to convert "${e}" into a date`);return t}(e);t=Ld(n,t)||t;let s,o=[];for(;t;){if(s=Ad.exec(t),!s){o.push(t);break}{o=o.concat(s.slice(1));const e=o.pop();if(!e)break;t=e}}let a=i.getTimezoneOffset();r&&(a=qd(r,a),i=function(e,t,n){const r=e.getTimezoneOffset();return function(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,-1*(qd(t,r)-r))}(i,r));let l="";return o.forEach(e=>{const t=function(e){if(Zd[e])return Zd[e];let t;switch(e){case"G":case"GG":case"GGG":t=Bd(Rd.Eras,yd.Abbreviated);break;case"GGGG":t=Bd(Rd.Eras,yd.Wide);break;case"GGGGG":t=Bd(Rd.Eras,yd.Narrow);break;case"y":t=Vd(Nd.FullYear,1,0,!1,!0);break;case"yy":t=Vd(Nd.FullYear,2,0,!0,!0);break;case"yyy":t=Vd(Nd.FullYear,3,0,!1,!0);break;case"yyyy":t=Vd(Nd.FullYear,4,0,!1,!0);break;case"Y":t=Gd(1);break;case"YY":t=Gd(2,!0);break;case"YYY":t=Gd(3);break;case"YYYY":t=Gd(4);break;case"M":case"L":t=Vd(Nd.Month,1,1);break;case"MM":case"LL":t=Vd(Nd.Month,2,1);break;case"MMM":t=Bd(Rd.Months,yd.Abbreviated);break;case"MMMM":t=Bd(Rd.Months,yd.Wide);break;case"MMMMM":t=Bd(Rd.Months,yd.Narrow);break;case"LLL":t=Bd(Rd.Months,yd.Abbreviated,md.Standalone);break;case"LLLL":t=Bd(Rd.Months,yd.Wide,md.Standalone);break;case"LLLLL":t=Bd(Rd.Months,yd.Narrow,md.Standalone);break;case"w":t=Hd(1);break;case"ww":t=Hd(2);break;case"W":t=Hd(1,!0);break;case"d":t=Vd(Nd.Date,1);break;case"dd":t=Vd(Nd.Date,2);break;case"c":case"cc":t=Vd(Nd.Day,1);break;case"ccc":t=Bd(Rd.Days,yd.Abbreviated,md.Standalone);break;case"cccc":t=Bd(Rd.Days,yd.Wide,md.Standalone);break;case"ccccc":t=Bd(Rd.Days,yd.Narrow,md.Standalone);break;case"cccccc":t=Bd(Rd.Days,yd.Short,md.Standalone);break;case"E":case"EE":case"EEE":t=Bd(Rd.Days,yd.Abbreviated);break;case"EEEE":t=Bd(Rd.Days,yd.Wide);break;case"EEEEE":t=Bd(Rd.Days,yd.Narrow);break;case"EEEEEE":t=Bd(Rd.Days,yd.Short);break;case"a":case"aa":case"aaa":t=Bd(Rd.DayPeriods,yd.Abbreviated);break;case"aaaa":t=Bd(Rd.DayPeriods,yd.Wide);break;case"aaaaa":t=Bd(Rd.DayPeriods,yd.Narrow);break;case"b":case"bb":case"bbb":t=Bd(Rd.DayPeriods,yd.Abbreviated,md.Standalone,!0);break;case"bbbb":t=Bd(Rd.DayPeriods,yd.Wide,md.Standalone,!0);break;case"bbbbb":t=Bd(Rd.DayPeriods,yd.Narrow,md.Standalone,!0);break;case"B":case"BB":case"BBB":t=Bd(Rd.DayPeriods,yd.Abbreviated,md.Format,!0);break;case"BBBB":t=Bd(Rd.DayPeriods,yd.Wide,md.Format,!0);break;case"BBBBB":t=Bd(Rd.DayPeriods,yd.Narrow,md.Format,!0);break;case"h":t=Vd(Nd.Hours,1,-12);break;case"hh":t=Vd(Nd.Hours,2,-12);break;case"H":t=Vd(Nd.Hours,1);break;case"HH":t=Vd(Nd.Hours,2);break;case"m":t=Vd(Nd.Minutes,1);break;case"mm":t=Vd(Nd.Minutes,2);break;case"s":t=Vd(Nd.Seconds,1);break;case"ss":t=Vd(Nd.Seconds,2);break;case"S":t=Vd(Nd.FractionalSeconds,1);break;case"SS":t=Vd(Nd.FractionalSeconds,2);break;case"SSS":t=Vd(Nd.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=$d(Md.Short);break;case"ZZZZZ":t=$d(Md.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=$d(Md.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=$d(Md.Long);break;default:return null}return Zd[e]=t,t}(e);l+=t?t(i,n,a):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function Dd(e,t,n){const r=new Date(0);return r.setFullYear(e,t,n),r.setHours(0,0,0),r}function Ld(e,t){const n=function(e){return ol(e)[cl.LocaleId]}(e);if(kd[n]=kd[n]||{},kd[n][t])return kd[n][t];let r="";switch(t){case"shortDate":r=_d(e,vd.Short);break;case"mediumDate":r=_d(e,vd.Medium);break;case"longDate":r=_d(e,vd.Long);break;case"fullDate":r=_d(e,vd.Full);break;case"shortTime":r=Ed(e,vd.Short);break;case"mediumTime":r=Ed(e,vd.Medium);break;case"longTime":r=Ed(e,vd.Long);break;case"fullTime":r=Ed(e,vd.Full);break;case"short":const t=Ld(e,"shortTime"),n=Ld(e,"shortDate");r=Fd(wd(e,vd.Short),[t,n]);break;case"medium":const i=Ld(e,"mediumTime"),s=Ld(e,"mediumDate");r=Fd(wd(e,vd.Medium),[i,s]);break;case"long":const o=Ld(e,"longTime"),a=Ld(e,"longDate");r=Fd(wd(e,vd.Long),[o,a]);break;case"full":const l=Ld(e,"fullTime"),c=Ld(e,"fullDate");r=Fd(wd(e,vd.Full),[l,c])}return r&&(kd[n][t]=r),r}function Fd(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),e}function Ud(e,t,n="-",r,i){let s="";(e<0||i&&e<=0)&&(i?e=1-e:(e=-e,s=n));let o=String(e);for(;o.length<t;)o="0"+o;return r&&(o=o.substr(o.length-t)),s+o}function Vd(e,t,n=0,r=!1,i=!1){return function(s,o){let a=function(e,t){switch(e){case Nd.FullYear:return t.getFullYear();case Nd.Month:return t.getMonth();case Nd.Date:return t.getDate();case Nd.Hours:return t.getHours();case Nd.Minutes:return t.getMinutes();case Nd.Seconds:return t.getSeconds();case Nd.FractionalSeconds:return t.getMilliseconds();case Nd.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${e}".`)}}(e,s);if((n>0||a>-n)&&(a+=n),e===Nd.Hours)0===a&&-12===n&&(a=12);else if(e===Nd.FractionalSeconds)return function(e,t){return Ud(e,3).substr(0,t)}(a,t);const l=Pd(o,Cd.MinusSign);return Ud(a,t,l,r,i)}}function Bd(e,t,n=md.Format,r=!1){return function(i,s){return function(e,t,n,r,i,s){switch(n){case Rd.Months:return function(e,t,n){const r=ol(e),i=Od([r[cl.MonthsFormat],r[cl.MonthsStandalone]],t);return Od(i,n)}(t,i,r)[e.getMonth()];case Rd.Days:return function(e,t,n){const r=ol(e),i=Od([r[cl.DaysFormat],r[cl.DaysStandalone]],t);return Od(i,n)}(t,i,r)[e.getDay()];case Rd.DayPeriods:const o=e.getHours(),a=e.getMinutes();if(s){const e=function(e){const t=ol(e);return bd(t),(t[cl.ExtraData][2]||[]).map(e=>"string"==typeof e?Td(e):[Td(e[0]),Td(e[1])])}(t),n=function(e,t,n){const r=ol(e);bd(r);const i=Od([r[cl.ExtraData][0],r[cl.ExtraData][1]],t)||[];return Od(i,n)||[]}(t,i,r),s=e.findIndex(e=>{if(Array.isArray(e)){const[t,n]=e,r=o>=t.hours&&a>=t.minutes,i=o<n.hours||o===n.hours&&a<n.minutes;if(t.hours<n.hours){if(r&&i)return!0}else if(r||i)return!0}else if(e.hours===o&&e.minutes===a)return!0;return!1});if(-1!==s)return n[s]}return function(e,t,n){const r=ol(e),i=Od([r[cl.DayPeriodsFormat],r[cl.DayPeriodsStandalone]],t);return Od(i,n)}(t,i,r)[o<12?0:1];case Rd.Eras:return function(e,t){return Od(ol(e)[cl.Eras],t)}(t,r)[e.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${n}`)}}(i,s,e,t,n,r)}}function $d(e){return function(t,n,r){const i=-1*r,s=Pd(n,Cd.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(e){case Md.Short:return(i>=0?"+":"")+Ud(o,2,s)+Ud(Math.abs(i%60),2,s);case Md.ShortGMT:return"GMT"+(i>=0?"+":"")+Ud(o,1,s);case Md.Long:return"GMT"+(i>=0?"+":"")+Ud(o,2,s)+":"+Ud(Math.abs(i%60),2,s);case Md.Extended:return 0===r?"Z":(i>=0?"+":"")+Ud(o,2,s)+":"+Ud(Math.abs(i%60),2,s);default:throw new Error(`Unknown zone width "${e}"`)}}}function zd(e){return Dd(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))}function Hd(e,t=!1){return function(n,r){let i;if(t){const e=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,t=n.getDate();i=1+Math.floor((t+e)/7)}else{const e=zd(n),t=function(e){const t=Dd(e,0,1).getDay();return Dd(e,0,1+(t<=4?4:11)-t)}(e.getFullYear()),r=e.getTime()-t.getTime();i=1+Math.round(r/6048e5)}return Ud(i,e,Pd(r,Cd.MinusSign))}}function Gd(e,t=!1){return function(n,r){return Ud(zd(n).getFullYear(),e,Pd(r,Cd.MinusSign),t)}}const Zd={};function qd(e,t){e=e.replace(/:/g,"");const n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function Wd(e){return e instanceof Date&&!isNaN(e.valueOf())}const jd=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function Yd(e){const t=parseInt(e);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+e);return t}class Kd{}let Qd=(()=>{class e extends Kd{constructor(e){super(),this.locale=e}getPluralCategory(e,t){switch(Sd(t||this.locale)(e)){case gd.Zero:return"zero";case gd.One:return"one";case gd.Two:return"two";case gd.Few:return"few";case gd.Many:return"many";default:return"other"}}}return e.\u0275fac=function(t){return new(t||e)(Or(oh))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();function Xd(e,t){t=encodeURIComponent(t);for(const n of e.split(";")){const e=n.indexOf("="),[r,i]=-1==e?[n,""]:[n.slice(0,e),n.slice(e+1)];if(r.trim()===t)return decodeURIComponent(i)}return null}let Jd=(()=>{class e{constructor(e,t,n,r){this._iterableDiffers=e,this._keyValueDiffers=t,this._ngEl=n,this._renderer=r,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(Xo(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(e=>this._toggleClass(e.key,e.currentValue)),e.forEachChangedItem(e=>this._toggleClass(e.key,e.currentValue)),e.forEachRemovedItem(e=>{e.previousValue&&this._toggleClass(e.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(e=>{if("string"!=typeof e.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${de(e.item)}`);this._toggleClass(e.item,!0)}),e.forEachRemovedItem(e=>this._toggleClass(e.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(e=>this._toggleClass(e,!0)):Object.keys(e).forEach(t=>this._toggleClass(t,!!e[t])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(e=>this._toggleClass(e,!1)):Object.keys(e).forEach(e=>this._toggleClass(e,!1)))}_toggleClass(e,t){(e=e.trim())&&e.split(/\s+/g).forEach(e=>{t?this._renderer.addClass(this._ngEl.nativeElement,e):this._renderer.removeClass(this._ngEl.nativeElement,e)})}}return e.\u0275fac=function(t){return new(t||e)(ua(zc),ua(Gc),ua(Pc),ua(Oc))},e.\u0275dir=st({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e})();class ef{constructor(e,t,n,r){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let tf=(()=>{class e{constructor(e,t,n){this._viewContainer=e,this._template=t,this._differs=n,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch{throw new Error(`Cannot find a differ supporting object '${e}' of type '${function(e){return e.name||typeof e}(e)}'. NgFor only supports binding to Iterables such as Arrays.`)}}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const t=[];e.forEachOperation((e,n,r)=>{if(null==e.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new ef(null,this._ngForOf,-1,-1),null===r?void 0:r),i=new nf(e,n);t.push(i)}else if(null==r)this._viewContainer.remove(null===n?void 0:n);else if(null!==n){const i=this._viewContainer.get(n);this._viewContainer.move(i,r);const s=new nf(e,i);t.push(s)}});for(let n=0;n<t.length;n++)this._perViewChange(t[n].view,t[n].record);for(let n=0,r=this._viewContainer.length;n<r;n++){const e=this._viewContainer.get(n);e.context.index=n,e.context.count=r,e.context.ngForOf=this._ngForOf}e.forEachIdentityChange(e=>{this._viewContainer.get(e.currentIndex).context.$implicit=e.item})}_perViewChange(e,t){e.context.$implicit=t.item}static ngTemplateContextGuard(e,t){return!0}}return e.\u0275fac=function(t){return new(t||e)(ua(au),ua(eu),ua(zc))},e.\u0275dir=st({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e})();class nf{constructor(e,t){this.record=e,this.view=t}}let rf=(()=>{class e{constructor(e,t){this._viewContainer=e,this._context=new sf,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=t}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){of("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){of("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,t){return!0}}return e.\u0275fac=function(t){return new(t||e)(ua(au),ua(eu))},e.\u0275dir=st({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e})();class sf{constructor(){this.$implicit=null,this.ngIf=null}}function of(e,t){if(t&&!t.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${de(t)}'.`)}let af=(()=>{class e{constructor(e){this._locale=e}transform(t,n,r){if(!function(e){return!(null==e||""===e||e!=e)}(t))return null;r=r||this._locale;try{return function(e,t,n){return function(e,t,n,r,i,s,o=!1){let a="",l=!1;if(isFinite(e)){let c=function(e){let t,n,r,i,s,o=Math.abs(e)+"",a=0;for((n=o.indexOf("."))>-1&&(o=o.replace(".","")),(r=o.search(/e/i))>0?(n<0&&(n=r),n+=+o.slice(r+1),o=o.substring(0,r)):n<0&&(n=o.length),r=0;"0"===o.charAt(r);r++);if(r===(s=o.length))t=[0],n=1;else{for(s--;"0"===o.charAt(s);)s--;for(n-=r,t=[],i=0;r<=s;r++,i++)t[i]=Number(o.charAt(r))}return n>22&&(t=t.splice(0,21),a=n-1,n=1),{digits:t,exponent:a,integerLen:n}}(e);o&&(c=function(e){if(0===e.digits[0])return e;const t=e.digits.length-e.integerLen;return e.exponent?e.exponent+=2:(0===t?e.digits.push(0,0):1===t&&e.digits.push(0),e.integerLen+=2),e}(c));let u=t.minInt,h=t.minFrac,d=t.maxFrac;if(s){const e=s.match(jd);if(null===e)throw new Error(`${s} is not a valid digit info`);const t=e[1],n=e[3],r=e[5];null!=t&&(u=Yd(t)),null!=n&&(h=Yd(n)),null!=r?d=Yd(r):null!=n&&h>d&&(d=h)}!function(e,t,n){if(t>n)throw new Error(`The minimum number of digits after fraction (${t}) is higher than the maximum (${n}).`);let r=e.digits,i=r.length-e.integerLen;const s=Math.min(Math.max(t,i),n);let o=s+e.integerLen,a=r[o];if(o>0){r.splice(Math.max(e.integerLen,o));for(let e=o;e<r.length;e++)r[e]=0}else{i=Math.max(0,i),e.integerLen=1,r.length=Math.max(1,o=s+1),r[0]=0;for(let e=1;e<o;e++)r[e]=0}if(a>=5)if(o-1<0){for(let t=0;t>o;t--)r.unshift(0),e.integerLen++;r.unshift(1),e.integerLen++}else r[o-1]++;for(;i<Math.max(0,s);i++)r.push(0);let l=0!==s;const c=t+e.integerLen,u=r.reduceRight(function(e,t,n,r){return r[n]=(t+=e)<10?t:t-10,l&&(0===r[n]&&n>=c?r.pop():l=!1),t>=10?1:0},0);u&&(r.unshift(u),e.integerLen++)}(c,h,d);let f=c.digits,p=c.integerLen;const g=c.exponent;let m=[];for(l=f.every(e=>!e);p<u;p++)f.unshift(0);for(;p<0;p++)f.unshift(0);p>0?m=f.splice(p,f.length):(m=f,f=[0]);const y=[];for(f.length>=t.lgSize&&y.unshift(f.splice(-t.lgSize,f.length).join(""));f.length>t.gSize;)y.unshift(f.splice(-t.gSize,f.length).join(""));f.length&&y.unshift(f.join("")),a=y.join(Pd(n,r)),m.length&&(a+=Pd(n,i)+m.join("")),g&&(a+=Pd(n,Cd.Exponential)+"+"+g)}else a=Pd(n,Cd.Infinity);return a=e<0&&!l?t.negPre+a+t.negSuf:t.posPre+a+t.posSuf,a}(e,function(e,t="-"){const n={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=e.split(";"),i=r[0],s=r[1],o=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],a=o[0],l=o[1]||"";n.posPre=a.substr(0,a.indexOf("#"));for(let u=0;u<l.length;u++){const e=l.charAt(u);"0"===e?n.minFrac=n.maxFrac=u+1:"#"===e?n.maxFrac=u+1:n.posSuf+=e}const c=a.split(",");if(n.gSize=c[1]?c[1].length:0,n.lgSize=c[2]||c[1]?(c[2]||c[1]).length:0,s){const e=i.length-n.posPre.length-n.posSuf.length,t=s.indexOf("#");n.negPre=s.substr(0,t).replace(/'/g,""),n.negSuf=s.substr(t+e).replace(/'/g,"")}else n.negPre=t+n.posPre,n.negSuf=n.posSuf;return n}(function(e,t){return ol(e)[cl.NumberFormats][t]}(t,pd.Decimal),Pd(t,Cd.MinusSign)),t,Cd.Group,Cd.Decimal,n)}(function(e){if("string"==typeof e&&!isNaN(Number(e)-parseFloat(e)))return Number(e);if("number"!=typeof e)throw new Error(`${e} is not a number`);return e}(t),r,n)}catch(i){throw function(e,t){return Error(`InvalidPipeArgument: '${t}' for pipe '${de(e)}'`)}(e,i.message)}}}return e.\u0275fac=function(t){return new(t||e)(ua(oh,16))},e.\u0275pipe=ot({name:"number",type:e,pure:!0}),e})();let lf=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({providers:[{provide:Kd,useClass:Qd}]}),e})();let cf=(()=>{class e{}return e.\u0275prov=Pe({token:e,providedIn:"root",factory:()=>new uf(Or(Kh),window)}),e})();class uf{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function(e,t){const n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow)){const n=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let r=n.currentNode;for(;r;){const e=r.shadowRoot;if(e){const n=e.getElementById(t)||e.querySelector(`[name="${t}"]`);if(n)return n}r=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}attemptFocus(e){return e.focus(),this.document.activeElement===e}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=hf(this.window.history)||hf(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function hf(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}class df{}class ff extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){var e;e=new ff,jh||(jh=e)}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=(gf=gf||document.querySelector("base"),gf?gf.getAttribute("href"):null);return null==t?null:function(e){pf=pf||document.createElement("a"),pf.setAttribute("href",e);const t=pf.pathname;return"/"===t.charAt(0)?t:`/${t}`}(t)}resetBaseElement(){gf=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Xd(document.cookie,e)}}let pf,gf=null;const mf=new or("TRANSITION_ID"),yf=[{provide:Qu,useFactory:function(e,t,n){return()=>{n.get(Xu).donePromise.then(()=>{const n=Yh(),r=t.querySelectorAll(`style[ng-transition="${e}"]`);for(let e=0;e<r.length;e++)n.remove(r[e])})}},deps:[mf,Kh,zo],multi:!0}];class vf{static init(){var e;e=new vf,Ih=e}addToWindow(e){ze.getAngularTestability=(t,n=!0)=>{const r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},ze.getAllAngularTestabilities=()=>e.getAllTestabilities(),ze.getAllAngularRootElements=()=>e.getAllRootElements(),ze.frameworkStabilizers||(ze.frameworkStabilizers=[]),ze.frameworkStabilizers.push(e=>{const t=ze.getAllAngularTestabilities();let n=t.length,r=!1;const i=function(t){r=r||t,n--,0==n&&e(r)};t.forEach(function(e){e.whenStable(i)})})}findTestabilityInTree(e,t,n){return null==t?null:e.getTestability(t)??(n?Yh().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}}let Cf=(()=>{class e{build(){return new XMLHttpRequest}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();const _f=new or("EventManagerPlugins");let Ef=(()=>{class e{constructor(e,t){this._zone=t,this._eventNameToPlugin=new Map,e.forEach(e=>e.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}addGlobalEventListener(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}getZone(){return this._zone}_findPluginFor(e){const t=this._eventNameToPlugin.get(e);if(t)return t;const n=this._plugins;for(let r=0;r<n.length;r++){const t=n[r];if(t.supports(e))return this._eventNameToPlugin.set(e,t),t}throw new Error(`No event manager plugin found for event ${e}`)}}return e.\u0275fac=function(t){return new(t||e)(Or(_f),Or(vh))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();class wf{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const r=Yh().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,n)}}let Pf=(()=>{class e{constructor(){this._stylesSet=new Set}addStyles(e){const t=new Set;e.forEach(e=>{this._stylesSet.has(e)||(this._stylesSet.add(e),t.add(e))}),this.onStylesAdded(t)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),Sf=(()=>{class e extends Pf{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,t,n){e.forEach(e=>{const r=this._doc.createElement("style");r.textContent=e,n.push(t.appendChild(r))})}addHost(e){const t=[];this._addStylesToHost(this._stylesSet,e,t),this._hostNodes.set(e,t)}removeHost(e){const t=this._hostNodes.get(e);t&&t.forEach(bf),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((t,n)=>{this._addStylesToHost(e,n,t)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(bf))}}return e.\u0275fac=function(t){return new(t||e)(Or(Kh))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();function bf(e){Yh().remove(e)}const Of={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Tf=/%COMP%/g;function If(e,t,n){for(let r=0;r<t.length;r++){let i=t[r];Array.isArray(i)?If(e,i,n):(i=i.replace(Tf,e),n.push(i))}return n}function kf(e){return t=>{if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}let Af=(()=>{class e{constructor(e,t,n){this.eventManager=e,this.sharedStylesHost=t,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new Mf(e)}createRenderer(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case Ue.Emulated:{let n=this.rendererByCompId.get(t.id);return n||(n=new Nf(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n}case 1:case Ue.ShadowDom:return new Rf(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){const e=If(t.id,t.styles,[]);this.sharedStylesHost.addStyles(e),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return e.\u0275fac=function(t){return new(t||e)(Or(Ef),Or(Sf),Or(Ju))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();class Mf{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS(Of[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,n){e&&e.insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;const i=Of[r];i?e.setAttributeNS(i,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const r=Of[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(Mi.DashCase|Mi.Important)?e.style.setProperty(t,n,r&Mi.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&Mi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,kf(n)):this.eventManager.addEventListener(e,t,kf(n))}}class Nf extends Mf{constructor(e,t,n,r){super(e),this.component=n;const i=If(r+"-"+n.id,n.styles,[]);t.addStyles(i),this.contentAttr="_ngcontent-%COMP%".replace(Tf,r+"-"+n.id),this.hostAttr="_nghost-%COMP%".replace(Tf,r+"-"+n.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}class Rf extends Mf{constructor(e,t,n,r){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const i=If(r.id,r.styles,[]);for(let s=0;s<i.length;s++){const e=document.createElement("style");e.textContent=i[s],this.shadowRoot.appendChild(e)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let xf=(()=>{class e extends wf{constructor(e){super(e)}supports(e){return!0}addEventListener(e,t,n){return e.addEventListener(t,n,!1),()=>this.removeEventListener(e,t,n)}removeEventListener(e,t,n){return e.removeEventListener(t,n)}}return e.\u0275fac=function(t){return new(t||e)(Or(Kh))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();const Df=["alt","control","meta","shift"],Lf={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Ff={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Uf={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let Vf=(()=>{class e extends wf{constructor(e){super(e)}supports(t){return null!=e.parseEventName(t)}addEventListener(t,n,r){const i=e.parseEventName(n),s=e.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Yh().onAndCancel(t,i.domEventName,s))}static parseEventName(t){const n=t.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const i=e._normalizeKey(n.pop());let s="";if(Df.forEach(e=>{const t=n.indexOf(e);t>-1&&(n.splice(t,1),s+=e+".")}),s+=i,0!=n.length||0===i.length)return null;const o={};return o.domEventName=r,o.fullKey=s,o}static getEventFullKey(e){let t="",n=function(e){let t=e.key;if(null==t){if(t=e.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&Ff.hasOwnProperty(t)&&(t=Ff[t]))}return Lf[t]||t}(e);return n=n.toLowerCase()," "===n?n="space":"."===n&&(n="dot"),Df.forEach(r=>{r!=n&&Uf[r](e)&&(t+=r+".")}),t+=n,t}static eventCallback(t,n,r){return i=>{e.getEventFullKey(i)===t&&r.runGuarded(()=>n(i))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return e.\u0275fac=function(t){return new(t||e)(Or(Kh))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),Bf=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({factory:function(){return Or($f)},token:e,providedIn:"root"}),e})(),$f=(()=>{class e extends Bf{constructor(e){super(),this._doc=e}sanitize(e,t){if(null==t)return null;switch(e){case yi.NONE:return t;case yi.HTML:return Zr(t,"HTML")?Gr(t):gi(this._doc,String(t)).toString();case yi.STYLE:return Zr(t,"Style")?Gr(t):t;case yi.SCRIPT:if(Zr(t,"Script"))return Gr(t);throw new Error("unsafe value used in a script context");case yi.URL:return qr(t),Zr(t,"URL")?Gr(t):Xr(String(t));case yi.RESOURCE_URL:if(Zr(t,"ResourceURL"))return Gr(t);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function(e){return new Vr(e)}(e)}bypassSecurityTrustStyle(e){return function(e){return new Br(e)}(e)}bypassSecurityTrustScript(e){return function(e){return new $r(e)}(e)}bypassSecurityTrustUrl(e){return function(e){return new zr(e)}(e)}bypassSecurityTrustResourceUrl(e){return function(e){return new Hr(e)}(e)}}return e.\u0275fac=function(t){return new(t||e)(Or(Kh))},e.\u0275prov=Pe({factory:function(){return function(e){return new $f(e.get(Kh))}(Or(To))},token:e,providedIn:"root"}),e})();const zf=[{provide:rh,useValue:"browser"},{provide:nh,useValue:function(){ff.makeCurrent(),vf.init()},multi:!0},{provide:Kh,useFactory:function(){return e=document,bt=e,document;var e},deps:[]}],Hf=xh(Zh,"browser",zf),Gf=[[],{provide:ko,useValue:"root"},{provide:Oi,useFactory:function(){return new Oi},deps:[]},{provide:_f,useClass:xf,multi:!0,deps:[Kh,vh,rh]},{provide:_f,useClass:Vf,multi:!0,deps:[Kh]},[],{provide:Af,useClass:Af,deps:[Ef,Sf,Ju]},{provide:bc,useExisting:Af},{provide:Pf,useExisting:Sf},{provide:Sf,useClass:Sf,deps:[Kh]},{provide:bh,useClass:bh,deps:[vh]},{provide:Ef,useClass:Ef,deps:[_f,vh]},{provide:df,useClass:Cf,deps:[]},[]];let Zf=(()=>{class e{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:e,providers:[{provide:Ju,useValue:t.appId},{provide:mf,useExisting:Ju},yf]}}}return e.\u0275fac=function(t){return new(t||e)(Or(e,12))},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({providers:Gf,imports:[lf,Wh]}),e})();"undefined"!=typeof window&&window;const{isArray:qf}=Array,{getPrototypeOf:Wf,prototype:jf,keys:Yf}=Object;function Kf(e){if(1===e.length){const t=e[0];if(qf(t))return{args:t,keys:null};if(function(e){return e&&"object"==typeof e&&Wf(e)===jf}(t)){const e=Yf(t);return{args:e.map(e=>t[e]),keys:e}}}return{args:e,keys:null}}const{isArray:Qf}=Array;function Xf(e){return D(t=>function(e,t){return Qf(t)?e(...t):e(t)}(e,t))}function Jf(e,t){return e.reduce((e,n,r)=>(e[n]=t[r],e),{})}let ep=(()=>{class e{constructor(e,t){this._renderer=e,this._elementRef=t,this.onChange=e=>{},this.onTouched=()=>{}}setProperty(e,t){this._renderer.setProperty(this._elementRef.nativeElement,e,t)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return e.\u0275fac=function(t){return new(t||e)(ua(Oc),ua(Pc))},e.\u0275dir=st({type:e}),e})(),tp=(()=>{class e extends ep{}return e.\u0275fac=function(){let t;return function(n){return(t||(t=tr(e)))(n||e)}}(),e.\u0275dir=st({type:e,features:[Go]}),e})();const np=new or("NgValueAccessor"),rp={provide:np,useExisting:ge(()=>sp),multi:!0},ip=new or("CompositionEventMode");let sp=(()=>{class e extends ep{constructor(e,t,n){super(e,t),this._compositionMode=n,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const e=Yh()?Yh().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return e.\u0275fac=function(t){return new(t||e)(ua(Oc),ua(Pc),ua(ip,8))},e.\u0275dir=st({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&Ea("input",function(e){return t._handleInput(e.target.value)})("blur",function(){return t.onTouched()})("compositionstart",function(){return t._compositionStart()})("compositionend",function(e){return t._compositionEnd(e.target.value)})},features:[gc([rp]),Go]}),e})();function op(e){return null==e||0===e.length}function ap(e){return null!=e&&"number"==typeof e.length}const lp=new or("NgValidators"),cp=new or("NgAsyncValidators"),up=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class hp{static min(e){return t=e,e=>{if(op(e.value)||op(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null};var t}static max(e){return t=e,e=>{if(op(e.value)||op(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null};var t}static required(e){return dp(e)}static requiredTrue(e){return!0===e.value?null:{required:!0}}static email(e){return op((t=e).value)||up.test(t.value)?null:{email:!0};var t}static minLength(e){return t=e,e=>op(e.value)||!ap(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null;var t}static maxLength(e){return fp(e)}static pattern(e){return function(e){if(!e)return pp;let t,n;return"string"==typeof e?(n="","^"!==e.charAt(0)&&(n+="^"),n+=e,"$"!==e.charAt(e.length-1)&&(n+="$"),t=new RegExp(n)):(n=e.toString(),t=e),e=>{if(op(e.value))return null;const r=e.value;return t.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}}(e)}static nullValidator(e){return null}static compose(e){return _p(e)}static composeAsync(e){return wp(e)}}function dp(e){return op(e.value)?{required:!0}:null}function fp(e){return t=>ap(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null}function pp(e){return null}function gp(e){return null!=e}function mp(e){const t=Ca(e)?ae(e):e;return _a(t),t}function yp(e){let t={};return e.forEach(e=>{t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function vp(e,t){return t.map(t=>t(e))}function Cp(e){return e.map(e=>function(e){return!e.validate}(e)?e:t=>e.validate(t))}function _p(e){if(!e)return null;const t=e.filter(gp);return 0==t.length?null:function(e){return yp(vp(e,t))}}function Ep(e){return null!=e?_p(Cp(e)):null}function wp(e){if(!e)return null;const t=e.filter(gp);return 0==t.length?null:function(e){return function(...e){const t=ne(e),{args:n,keys:r}=Kf(e),i=new T(e=>{const{length:t}=n;if(!t)return void e.complete();const i=new Array(t);let s=t,o=t;for(let a=0;a<t;a++){let t=!1;Y(n[a]).subscribe(new x(e,e=>{t||(t=!0,o--),i[a]=e},()=>s--,void 0,()=>{(!s||!t)&&(o||e.next(r?Jf(r,i):i),e.complete())}))}});return t?i.pipe(Xf(t)):i}(vp(e,t).map(mp)).pipe(D(yp))}}function Pp(e){return null!=e?wp(Cp(e)):null}function Sp(e,t){return null===e?[t]:Array.isArray(e)?[...e,t]:[e,t]}function bp(e){return e._rawValidators}function Op(e){return e._rawAsyncValidators}function Tp(e){return e?Array.isArray(e)?e:[e]:[]}function Ip(e,t){return Array.isArray(e)?e.includes(t):e===t}function kp(e,t){const n=Tp(t);return Tp(e).forEach(e=>{Ip(n,e)||n.push(e)}),n}function Ap(e,t){return Tp(t).filter(t=>!Ip(e,t))}let Mp=(()=>{class e{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Ep(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Pp(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=st({type:e}),e})(),Np=(()=>{class e extends Mp{get formDirective(){return null}get path(){return null}}return e.\u0275fac=function(){let t;return function(n){return(t||(t=tr(e)))(n||e)}}(),e.\u0275dir=st({type:e,features:[Go]}),e})();class Rp extends Mp{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class xp{constructor(e){this._cd=e}is(e){var t,n,r;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(r=null===(n=this._cd)||void 0===n?void 0:n.control)||void 0===r?void 0:r[e])}}let Dp=(()=>{class e extends xp{constructor(e){super(e)}}return e.\u0275fac=function(t){return new(t||e)(ua(Rp,2))},e.\u0275dir=st({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&Va("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[Go]}),e})(),Lp=(()=>{class e extends xp{constructor(e){super(e)}}return e.\u0275fac=function(t){return new(t||e)(ua(Np,10))},e.\u0275dir=st({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,t){2&e&&Va("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))("ng-submitted",t.is("submitted"))},features:[Go]}),e})();function Fp(e,t){return[...t.path,e]}function Up(e,t){$p(e,t),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(n=>{e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&Hp(e,t)})}(e,t),function(e,t){const n=(e,n)=>{t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)};e.registerOnChange(n),t._registerOnDestroy(()=>{e._unregisterOnChange(n)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&Hp(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function(e,t){if(t.valueAccessor.setDisabledState){const n=e=>{t.valueAccessor.setDisabledState(e)};e.registerOnDisabledChange(n),t._registerOnDestroy(()=>{e._unregisterOnDisabledChange(n)})}}(e,t)}function Vp(e,t,n=!0){const r=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(r),t.valueAccessor.registerOnTouched(r)),zp(e,t),e&&(t._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(()=>{}))}function Bp(e,t){e.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function $p(e,t){const n=bp(e);null!==t.validator?e.setValidators(Sp(n,t.validator)):"function"==typeof n&&e.setValidators([n]);const r=Op(e);null!==t.asyncValidator?e.setAsyncValidators(Sp(r,t.asyncValidator)):"function"==typeof r&&e.setAsyncValidators([r]);const i=()=>e.updateValueAndValidity();Bp(t._rawValidators,i),Bp(t._rawAsyncValidators,i)}function zp(e,t){let n=!1;if(null!==e){if(null!==t.validator){const r=bp(e);if(Array.isArray(r)&&r.length>0){const i=r.filter(e=>e!==t.validator);i.length!==r.length&&(n=!0,e.setValidators(i))}}if(null!==t.asyncValidator){const r=Op(e);if(Array.isArray(r)&&r.length>0){const i=r.filter(e=>e!==t.asyncValidator);i.length!==r.length&&(n=!0,e.setAsyncValidators(i))}}}const r=()=>{};return Bp(t._rawValidators,r),Bp(t._rawAsyncValidators,r),n}function Hp(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function Gp(e,t){$p(e,t)}function Zp(e,t){if(!e.hasOwnProperty("model"))return!1;const n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}function qp(e,t){e._syncPendingControls(),t.forEach(e=>{const t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)})}function Wp(e,t){if(!t)return null;let n,r,i;return Array.isArray(t),t.forEach(e=>{e.constructor===sp?n=e:function(e){return Object.getPrototypeOf(e.constructor)===tp}(e)?r=e:i=e}),i||r||n||null}function jp(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const Yp="VALID",Kp="INVALID",Qp="PENDING",Xp="DISABLED";function Jp(e){return(rg(e)?e.validators:e)||null}function eg(e){return Array.isArray(e)?Ep(e):e||null}function tg(e,t){return(rg(t)?t.asyncValidators:e)||null}function ng(e){return Array.isArray(e)?Pp(e):e||null}function rg(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}class ig{constructor(e,t){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=eg(this._rawValidators),this._composedAsyncValidatorFn=ng(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Yp}get invalid(){return this.status===Kp}get pending(){return this.status==Qp}get disabled(){return this.status===Xp}get enabled(){return this.status!==Xp}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=eg(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=ng(e)}addValidators(e){this.setValidators(kp(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(kp(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Ap(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Ap(e,this._rawAsyncValidators))}hasValidator(e){return Ip(this._rawValidators,e)}hasAsyncValidator(e){return Ip(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Qp,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Xp,this.errors=null,this._forEachChild(t=>{t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(e=>e(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Yp,this._forEachChild(t=>{t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(e=>e(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Yp||this.status===Qp)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Xp:Yp}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Qp,this._hasOwnPendingAsyncValidator=!0;const t=mp(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(t=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(t,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){return function(e,t,n){if(null==t||(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length))return null;let r=e;return t.forEach(e=>{r=r instanceof og?r.controls.hasOwnProperty(e)?r.controls[e]:null:r instanceof ag&&r.at(e)||null}),r}(this,e)}getError(e,t){const n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new xu,this.statusChanges=new xu}_calculateStatus(){return this._allControlsDisabled()?Xp:this.errors?Kp:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Qp)?Qp:this._anyControlsHaveStatus(Kp)?Kp:Yp}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_isBoxedValue(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){rg(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class sg extends ig{constructor(e=null,t,n){super(Jp(t),tg(n,t)),this._onChange=[],this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(e=>e(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=null,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){jp(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){jp(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}class og extends ig{constructor(e,t,n){super(Jp(t),tg(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,n={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){this._checkAllValuesPresent(e),Object.keys(e).forEach(n=>{this._throwIfControlMissing(n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,r)=>{n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t instanceof sg?t.value:t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(e,t)=>!!t._syncPendingControls()||e);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_throwIfControlMissing(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error(`Cannot find form control with name: ${e}.`)}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const t of Object.keys(this.controls)){const n=this.controls[t];if(this.contains(t)&&e(n))return!0}return!1}_reduceValue(){return this._reduceChildren({},(e,t,n)=>((t.enabled||this.disabled)&&(e[n]=t.value),e))}_reduceChildren(e,t){let n=e;return this._forEachChild((e,r)=>{n=t(n,e,r)}),n}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(e){this._forEachChild((t,n)=>{if(void 0===e[n])throw new Error(`Must supply a value for form control with name: '${n}'.`)})}}class ag extends ig{constructor(e,t,n){super(Jp(t),tg(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[e]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,n={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){this._checkAllValuesPresent(e),e.forEach((e,n)=>{this._throwIfControlMissing(n),this.at(n).setValue(e,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((e,n)=>{this.at(n)&&this.at(n).patchValue(e,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((n,r)=>{n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e instanceof sg?e.value:e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_syncPendingControls(){let e=this.controls.reduce((e,t)=>!!t._syncPendingControls()||e,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_throwIfControlMissing(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error(`Cannot find form control at index ${e}`)}_forEachChild(e){this.controls.forEach((t,n)=>{e(t,n)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_checkAllValuesPresent(e){this._forEachChild((t,n)=>{if(void 0===e[n])throw new Error(`Must supply a value for form control at index: ${n}.`)})}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}const lg={provide:Np,useExisting:ge(()=>ug)},cg=(()=>Promise.resolve(null))();let ug=(()=>{class e extends Np{constructor(e,t){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new xu,this.form=new og({},Ep(e),Pp(t))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){cg.then(()=>{const t=this._findContainer(e.path);e.control=t.registerControl(e.name,e.control),Up(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){cg.then(()=>{const t=this._findContainer(e.path);t&&t.removeControl(e.name),jp(this._directives,e)})}addFormGroup(e){cg.then(()=>{const t=this._findContainer(e.path),n=new og({});Gp(n,e),t.registerControl(e.name,n),n.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){cg.then(()=>{const t=this._findContainer(e.path);t&&t.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,t){cg.then(()=>{this.form.get(e.path).setValue(t)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,qp(this.form,this._directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return e.\u0275fac=function(t){return new(t||e)(ua(lp,10),ua(cp,10))},e.\u0275dir=st({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&Ea("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[gc([lg]),Go]}),e})();const hg={provide:Rp,useExisting:ge(()=>fg)},dg=(()=>Promise.resolve(null))();let fg=(()=>{class e extends Rp{constructor(e,t,n,r){super(),this.control=new sg,this._registered=!1,this.update=new xu,this._parent=e,this._setValidators(t),this._setAsyncValidators(n),this.valueAccessor=Wp(0,r)}ngOnChanges(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),Zp(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?Fp(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Up(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){dg.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1})})}_updateDisabled(e){const t=e.isDisabled.currentValue,n=""===t||t&&"false"!==t;dg.then(()=>{n&&!this.control.disabled?this.control.disable():!n&&this.control.disabled&&this.control.enable()})}}return e.\u0275fac=function(t){return new(t||e)(ua(Np,9),ua(lp,10),ua(cp,10),ua(np,10))},e.\u0275dir=st({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[gc([hg]),Go,vt]}),e})(),pg=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=st({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e})(),gg=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({}),e})();const mg={provide:np,useExisting:ge(()=>yg),multi:!0};let yg=(()=>{class e extends tp{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=t=>{e(""==t?null:parseFloat(t))}}}return e.\u0275fac=function(){let t;return function(n){return(t||(t=tr(e)))(n||e)}}(),e.\u0275dir=st({type:e,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&Ea("change",function(e){return t.onChange(e.target.value)})("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[gc([mg]),Go]}),e})();const vg=new or("NgModelWithFormControlWarning"),Cg={provide:Np,useExisting:ge(()=>_g)};let _g=(()=>{class e extends Np{constructor(e,t){super(),this.validators=e,this.asyncValidators=t,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new xu,this._setValidators(e),this._setAsyncValidators(t)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(zp(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const t=this.form.get(e.path);return Up(t,e),t.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),t}getControl(e){return this.form.get(e.path)}removeControl(e){Vp(e.control||null,e,!1),jp(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,t){this.form.get(e.path).setValue(t)}onSubmit(e){return this.submitted=!0,qp(this.form,this.directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const t=e.control,n=this.form.get(e.path);t!==n&&(Vp(t||null,e),n instanceof sg&&(Up(n,e),e.control=n))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const t=this.form.get(e.path);Gp(t,e),t.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const t=this.form.get(e.path);t&&function(e,t){return zp(e,t)}(t,e)&&t.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){$p(this.form,this),this._oldForm&&zp(this._oldForm,this)}_checkFormPresent(){}}return e.\u0275fac=function(t){return new(t||e)(ua(lp,10),ua(cp,10))},e.\u0275dir=st({type:e,selectors:[["","formGroup",""]],hostBindings:function(e,t){1&e&&Ea("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[gc([Cg]),Go,vt]}),e})();const Eg={provide:Rp,useExisting:ge(()=>wg)};let wg=(()=>{class e extends Rp{constructor(e,t,n,r,i){super(),this._ngModelWarningConfig=i,this._added=!1,this.update=new xu,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(t),this._setAsyncValidators(n),this.valueAccessor=Wp(0,r)}set isDisabled(e){}ngOnChanges(e){this._added||this._setUpControl(),Zp(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return Fp(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}return e.\u0275fac=function(t){return new(t||e)(ua(Np,13),ua(lp,10),ua(cp,10),ua(np,10),ua(vg,8))},e.\u0275dir=st({type:e,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[gc([Eg]),Go,vt]}),e._ngModelWarningSentOnce=!1,e})();const Pg={provide:np,useExisting:ge(()=>bg),multi:!0};function Sg(e,t){return null==e?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let bg=(()=>{class e extends tp{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const t=this._getOptionId(e);null==t&&this.setProperty("selectedIndex",-1);const n=Sg(t,e);this.setProperty("value",n)}registerOnChange(e){this.onChange=t=>{this.value=this._getOptionValue(t),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const t of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(t),e))return t;return null}_getOptionValue(e){const t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}return e.\u0275fac=function(){let t;return function(n){return(t||(t=tr(e)))(n||e)}}(),e.\u0275dir=st({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&Ea("change",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[gc([Pg]),Go]}),e})(),Og=(()=>{class e{constructor(e,t,n){this._element=e,this._renderer=t,this._select=n,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(Sg(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return e.\u0275fac=function(t){return new(t||e)(ua(Pc),ua(Oc),ua(bg,9))},e.\u0275dir=st({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();const Tg={provide:np,useExisting:ge(()=>kg),multi:!0};function Ig(e,t){return null==e?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let kg=(()=>{class e extends tp{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let t;if(this.value=e,Array.isArray(e)){const n=e.map(e=>this._getOptionId(e));t=(e,t)=>{e._setSelected(n.indexOf(t.toString())>-1)}}else t=(e,t)=>{e._setSelected(!1)};this._optionMap.forEach(t)}registerOnChange(e){this.onChange=t=>{const n=[];if(void 0!==t.selectedOptions){const e=t.selectedOptions;for(let t=0;t<e.length;t++){const r=e.item(t),i=this._getOptionValue(r.value);n.push(i)}}else{const e=t.options;for(let t=0;t<e.length;t++){const r=e.item(t);if(r.selected){const e=this._getOptionValue(r.value);n.push(e)}}}this.value=n,e(n)}}_registerOption(e){const t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}_getOptionId(e){for(const t of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(t)._value,e))return t;return null}_getOptionValue(e){const t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}return e.\u0275fac=function(){let t;return function(n){return(t||(t=tr(e)))(n||e)}}(),e.\u0275dir=st({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&Ea("change",function(e){return t.onChange(e.target)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[gc([Tg]),Go]}),e})(),Ag=(()=>{class e{constructor(e,t,n){this._element=e,this._renderer=t,this._select=n,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(Ig(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(Ig(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return e.\u0275fac=function(t){return new(t||e)(ua(Pc),ua(Oc),ua(kg,9))},e.\u0275dir=st({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();const Mg={provide:lp,useExisting:ge(()=>Ng),multi:!0};let Ng=(()=>{class e{constructor(){this._required=!1}get required(){return this._required}set required(e){this._required=null!=e&&!1!==e&&"false"!=`${e}`,this._onChange&&this._onChange()}validate(e){return this.required?dp(e):null}registerOnValidatorChange(e){this._onChange=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=st({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,t){2&e&&ra("required",t.required?"":null)},inputs:{required:"required"},features:[gc([Mg])]}),e})();const Rg={provide:lp,useExisting:ge(()=>xg),multi:!0};let xg=(()=>{class e{constructor(){this._validator=pp}ngOnChanges(e){"maxlength"in e&&(this._createValidator(),this._onChange&&this._onChange())}validate(e){return this.enabled()?this._validator(e):null}registerOnValidatorChange(e){this._onChange=e}_createValidator(){this._validator=this.enabled()?fp(function(e){return"number"==typeof e?e:parseInt(e,10)}(this.maxlength)):pp}enabled(){return null!=this.maxlength}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=st({type:e,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,t){2&e&&ra("maxlength",t.enabled()?t.maxlength:null)},inputs:{maxlength:"maxlength"},features:[gc([Rg]),vt]}),e})(),Dg=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({imports:[[gg]]}),e})(),Lg=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({imports:[Dg]}),e})(),Fg=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:vg,useValue:t.warnOnNgModelWithFormControl}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({imports:[Dg]}),e})(),Ug=(()=>{class e{group(e,t=null){const n=this._reduceControls(e);let r,i=null,s=null;return null!=t&&(function(e){return void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn}(t)?(i=null!=t.validators?t.validators:null,s=null!=t.asyncValidators?t.asyncValidators:null,r=null!=t.updateOn?t.updateOn:void 0):(i=null!=t.validator?t.validator:null,s=null!=t.asyncValidator?t.asyncValidator:null)),new og(n,{asyncValidators:s,updateOn:r,validators:i})}control(e,t,n){return new sg(e,t,n)}array(e,t,n){const r=e.map(e=>this._createControl(e));return new ag(r,t,n)}_reduceControls(e){const t={};return Object.keys(e).forEach(n=>{t[n]=this._createControl(e[n])}),t}_createControl(e){return e instanceof sg||e instanceof og||e instanceof ag?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({factory:function(){return new e},token:e,providedIn:Fg}),e})();function Vg(...e){return ae(e,re(e))}function Bg(e,t){return r(t)?X(e,t,1):X(e,1)}function $g(e,t){return R((n,r)=>{let i=0;n.subscribe(new x(r,n=>e.call(t,n,i++)&&r.next(n)))})}class zg{}class Hg{}class Gg{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(e=>{const t=e.indexOf(":");if(t>0){const n=e.slice(0,t),r=n.toLowerCase(),i=e.slice(t+1).trim();this.maybeSetNormalizedName(n,r),this.headers.has(r)?this.headers.get(r).push(i):this.headers.set(r,[i])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let n=e[t];const r=t.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(r,n),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Gg?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Gg;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Gg?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...n),this.headers.set(t,r);break;case"d":const i=e.value;if(i){let e=this.headers.get(t);if(!e)return;e=e.filter(e=>-1===i.indexOf(e)),0===e.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,e)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Zg{encodeKey(e){return jg(e)}encodeValue(e){return jg(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const qg=/%(\d[a-f0-9])/gi,Wg={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function jg(e){return encodeURIComponent(e).replace(qg,(e,t)=>{var n;return null!==(n=Wg[t])&&void 0!==n?n:e})}function Yg(e){return`${e}`}class Kg{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Zg,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){const n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(e=>{const r=e.indexOf("="),[i,s]=-1==r?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,r)),t.decodeValue(e.slice(r+1))],o=n.get(i)||[];o.push(s),n.set(i,o)}),n}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t];this.map.set(t,Array.isArray(n)?n:[n])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const r=e[n];Array.isArray(r)?r.forEach(e=>{t.push({param:n,value:e,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(e=>t+"="+this.encoder.encodeValue(e)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Kg({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(Yg(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let t=this.map.get(e.param)||[];const n=t.indexOf(Yg(e.value));-1!==n&&t.splice(n,1),t.length>0?this.map.set(e.param,t):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Qg{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}keys(){return this.map.keys()}}function Xg(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function Jg(e){return"undefined"!=typeof Blob&&e instanceof Blob}function em(e){return"undefined"!=typeof FormData&&e instanceof FormData}class tm{constructor(e,t,n,r){let i;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,i=r):i=n,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params)),this.headers||(this.headers=new Gg),this.context||(this.context=new Qg),this.params){const e=this.params.toString();if(0===e.length)this.urlWithParams=t;else{const n=t.indexOf("?");this.urlWithParams=t+(-1===n?"?":n<t.length-1?"&":"")+e}}else this.params=new Kg,this.urlWithParams=t}serializeBody(){return null===this.body?null:Xg(this.body)||Jg(this.body)||em(this.body)||"undefined"!=typeof URLSearchParams&&this.body instanceof URLSearchParams||"string"==typeof this.body?this.body:this.body instanceof Kg?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||em(this.body)?null:Jg(this.body)?this.body.type||null:Xg(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Kg?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var t;const n=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let l=e.headers||this.headers,c=e.params||this.params;const u=null!==(t=e.context)&&void 0!==t?t:this.context;return void 0!==e.setHeaders&&(l=Object.keys(e.setHeaders).reduce((t,n)=>t.set(n,e.setHeaders[n]),l)),e.setParams&&(c=Object.keys(e.setParams).reduce((t,n)=>t.set(n,e.setParams[n]),c)),new tm(n,r,s,{params:c,headers:l,context:u,reportProgress:a,responseType:i,withCredentials:o})}}var nm=(()=>((nm=nm||{})[nm.Sent=0]="Sent",nm[nm.UploadProgress=1]="UploadProgress",nm[nm.ResponseHeader=2]="ResponseHeader",nm[nm.DownloadProgress=3]="DownloadProgress",nm[nm.Response=4]="Response",nm[nm.User=5]="User",nm))();class rm{constructor(e,t=200,n="OK"){this.headers=e.headers||new Gg,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class im extends rm{constructor(e={}){super(e),this.type=nm.ResponseHeader}clone(e={}){return new im({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class sm extends rm{constructor(e={}){super(e),this.type=nm.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new sm({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class om extends rm{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function am(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let lm=(()=>{class e{constructor(e){this.handler=e}request(e,t,n={}){let r;if(e instanceof tm)r=e;else{let i,s;i=n.headers instanceof Gg?n.headers:new Gg(n.headers),n.params&&(s=n.params instanceof Kg?n.params:new Kg({fromObject:n.params})),r=new tm(e,t,void 0!==n.body?n.body:null,{headers:i,context:n.context,params:s,reportProgress:n.reportProgress,responseType:n.responseType||"json",withCredentials:n.withCredentials})}const i=Vg(r).pipe(Bg(e=>this.handler.handle(e)));if(e instanceof tm||"events"===n.observe)return i;const s=i.pipe($g(e=>e instanceof sm));switch(n.observe||"body"){case"body":switch(r.responseType){case"arraybuffer":return s.pipe(D(e=>{if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return s.pipe(D(e=>{if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return s.pipe(D(e=>{if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));default:return s.pipe(D(e=>e.body))}case"response":return s;default:throw new Error(`Unreachable: unhandled observe type ${n.observe}}`)}}delete(e,t={}){return this.request("DELETE",e,t)}get(e,t={}){return this.request("GET",e,t)}head(e,t={}){return this.request("HEAD",e,t)}jsonp(e,t){return this.request("JSONP",e,{params:(new Kg).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,t={}){return this.request("OPTIONS",e,t)}patch(e,t,n={}){return this.request("PATCH",e,am(n,t))}post(e,t,n={}){return this.request("POST",e,am(n,t))}put(e,t,n={}){return this.request("PUT",e,am(n,t))}}return e.\u0275fac=function(t){return new(t||e)(Or(zg))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();class cm{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const um=new or("HTTP_INTERCEPTORS");let hm=(()=>{class e{intercept(e,t){return t.handle(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();const dm=/^\)\]\}',?\n/;let fm=(()=>{class e{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new T(t=>{const n=this.xhrFactory.build();if(n.open(e.method,e.urlWithParams),e.withCredentials&&(n.withCredentials=!0),e.headers.forEach((e,t)=>n.setRequestHeader(e,t.join(","))),e.headers.has("Accept")||n.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const t=e.detectContentTypeHeader();null!==t&&n.setRequestHeader("Content-Type",t)}if(e.responseType){const t=e.responseType.toLowerCase();n.responseType="json"!==t?t:"text"}const r=e.serializeBody();let i=null;const s=()=>{if(null!==i)return i;const t=1223===n.status?204:n.status,r=n.statusText||"OK",s=new Gg(n.getAllResponseHeaders()),o=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(n)||e.url;return i=new im({headers:s,status:t,statusText:r,url:o}),i},o=()=>{let{headers:r,status:i,statusText:o,url:a}=s(),l=null;204!==i&&(l=void 0===n.response?n.responseText:n.response),0===i&&(i=l?200:0);let c=i>=200&&i<300;if("json"===e.responseType&&"string"==typeof l){const e=l;l=l.replace(dm,"");try{l=""!==l?JSON.parse(l):null}catch(u){l=e,c&&(c=!1,l={error:u,text:l})}}c?(t.next(new sm({body:l,headers:r,status:i,statusText:o,url:a||void 0})),t.complete()):t.error(new om({error:l,headers:r,status:i,statusText:o,url:a||void 0}))},a=e=>{const{url:r}=s(),i=new om({error:e,status:n.status||0,statusText:n.statusText||"Unknown Error",url:r||void 0});t.error(i)};let l=!1;const c=r=>{l||(t.next(s()),l=!0);let i={type:nm.DownloadProgress,loaded:r.loaded};r.lengthComputable&&(i.total=r.total),"text"===e.responseType&&!!n.responseText&&(i.partialText=n.responseText),t.next(i)},u=e=>{let n={type:nm.UploadProgress,loaded:e.loaded};e.lengthComputable&&(n.total=e.total),t.next(n)};return n.addEventListener("load",o),n.addEventListener("error",a),n.addEventListener("timeout",a),n.addEventListener("abort",a),e.reportProgress&&(n.addEventListener("progress",c),null!==r&&n.upload&&n.upload.addEventListener("progress",u)),n.send(r),t.next({type:nm.Sent}),()=>{n.removeEventListener("error",a),n.removeEventListener("abort",a),n.removeEventListener("load",o),n.removeEventListener("timeout",a),e.reportProgress&&(n.removeEventListener("progress",c),null!==r&&n.upload&&n.upload.removeEventListener("progress",u)),n.readyState!==n.DONE&&n.abort()}})}}return e.\u0275fac=function(t){return new(t||e)(Or(df))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();const pm=new or("XSRF_COOKIE_NAME"),gm=new or("XSRF_HEADER_NAME");class mm{}let ym=(()=>{class e{constructor(e,t,n){this.doc=e,this.platform=t,this.cookieName=n,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=Xd(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return e.\u0275fac=function(t){return new(t||e)(Or(Kh),Or(rh),Or(pm))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),vm=(()=>{class e{constructor(e,t){this.tokenService=e,this.headerName=t}intercept(e,t){const n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);const r=this.tokenService.getToken();return null!==r&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)}}return e.\u0275fac=function(t){return new(t||e)(Or(mm),Or(gm))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),Cm=(()=>{class e{constructor(e,t){this.backend=e,this.injector=t,this.chain=null}handle(e){if(null===this.chain){const e=this.injector.get(um,[]);this.chain=e.reduceRight((e,t)=>new cm(e,t),this.backend)}return this.chain.handle(e)}}return e.\u0275fac=function(t){return new(t||e)(Or(Hg),Or(zo))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),_m=(()=>{class e{static disable(){return{ngModule:e,providers:[{provide:vm,useClass:hm}]}}static withOptions(t={}){return{ngModule:e,providers:[t.cookieName?{provide:pm,useValue:t.cookieName}:[],t.headerName?{provide:gm,useValue:t.headerName}:[]]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({providers:[vm,{provide:um,useExisting:vm,multi:!0},{provide:mm,useClass:ym},{provide:pm,useValue:"XSRF-TOKEN"},{provide:gm,useValue:"X-XSRF-TOKEN"}]}),e})(),Em=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({providers:[lm,{provide:zg,useClass:Cm},fm,{provide:Hg,useExisting:fm}],imports:[[_m.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e})();class wm extends A{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}function Pm(e,t,n){e?Q(n,e,t):t()}const Sm=i(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function bm(...e){return J(1)(ae(e,re(e)))}function Om(e){return new T(t=>{Y(e()).subscribe(t)})}function Tm(){return R((e,t)=>{let n=null;e._refCount++;const r=new x(t,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(n=null);const r=e._connection,i=n;n=null,r&&(!i||r===i)&&r.unsubscribe(),t.unsubscribe()});e.subscribe(r),r.closed||(n=e.connect())})}class Im extends T{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,N(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,null==e||e.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new a;const t=this.getSubject();e.add(this.source.subscribe(new x(t,void 0,()=>{this._teardown(),t.complete()},e=>{this._teardown(),t.error(e)},()=>this._teardown()))),e.closed&&(this._connection=null,e=a.EMPTY)}return e}refCount(){return Tm()(this)}}function km(e,t){return R((n,r)=>{let i=null,s=0,o=!1;const a=()=>o&&!i&&r.complete();n.subscribe(new x(r,n=>{null==i||i.unsubscribe();let o=0;const l=s++;Y(e(n,l)).subscribe(i=new x(r,e=>r.next(t?t(n,e,l,o++):e),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Am(e,t,n,r,i){return(s,o)=>{let a=n,l=t,c=0;s.subscribe(new x(o,t=>{const n=c++;l=a?e(l,t,n):(a=!0,t),r&&o.next(l)},i&&(()=>{a&&o.next(l),o.complete()})))}}function Mm(e,t){return R(Am(e,t,arguments.length>=2,!0))}function Nm(e){return R((t,n)=>{let r,i=null,s=!1;i=t.subscribe(new x(n,void 0,void 0,o=>{r=Y(e(o,Nm(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):s=!0})),s&&(i.unsubscribe(),i=null,r.subscribe(n))})}function Rm(e){return e<=0?()=>ee:R((t,n)=>{let r=[];t.subscribe(new x(n,t=>{r.push(t),e<r.length&&r.shift()},()=>{for(const e of r)n.next(e);n.complete()},void 0,()=>{r=null}))})}function xm(e=Dm){return R((t,n)=>{let r=!1;t.subscribe(new x(n,e=>{r=!0,n.next(e)},()=>r?n.complete():n.error(e())))})}function Dm(){return new Sm}function Lm(e){return R((t,n)=>{let r=!1;t.subscribe(new x(n,e=>{r=!0,n.next(e)},()=>{r||n.next(e),n.complete()}))})}function Fm(e,t){const n=arguments.length>=2;return r=>r.pipe(e?$g((t,n)=>e(t,n,r)):O,le(1),n?Lm(t):xm(()=>new Sm))}function Um(e,t,n){const i=r(e)||t||n?{next:e,error:t,complete:n}:e;return i?R((e,t)=>{var n;null===(n=i.subscribe)||void 0===n||n.call(i);let r=!0;e.subscribe(new x(t,e=>{var n;null===(n=i.next)||void 0===n||n.call(i,e),t.next(e)},()=>{var e;r=!1,null===(e=i.complete)||void 0===e||e.call(i),t.complete()},e=>{var n;r=!1,null===(n=i.error)||void 0===n||n.call(i,e),t.error(e)},()=>{var e,t;r&&(null===(e=i.unsubscribe)||void 0===e||e.call(i)),null===(t=i.finalize)||void 0===t||t.call(i)}))}):O}class Vm{constructor(e,t){this.id=e,this.url=t}}class Bm extends Vm{constructor(e,t,n="imperative",r=null){super(e,t),this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class $m extends Vm{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class zm extends Vm{constructor(e,t,n){super(e,t),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Hm extends Vm{constructor(e,t,n){super(e,t),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Gm extends Vm{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Zm extends Vm{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class qm extends Vm{constructor(e,t,n,r,i){super(e,t),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=i}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Wm extends Vm{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class jm extends Vm{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ym{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Km{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Qm{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Xm{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Jm{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ey{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ty{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const ny="primary";class ry{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function iy(e){return new ry(e)}const sy="ngNavigationCancelingError";function oy(e){const t=Error("NavigationCancelingError: "+e);return t[sy]=!0,t}function ay(e,t,n){const r=n.path.split("/");if(r.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;const i={};for(let s=0;s<r.length;s++){const t=r[s],n=e[s];if(t.startsWith(":"))i[t.substring(1)]=n;else if(t!==n.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}function ly(e,t){const n=e?Object.keys(e):void 0,r=t?Object.keys(t):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!cy(e[i],t[i]))return!1;return!0}function cy(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;const n=[...e].sort(),r=[...t].sort();return n.every((e,t)=>r[t]===e)}return e===t}function uy(e){return Array.prototype.concat.apply([],e)}function hy(e){return e.length>0?e[e.length-1]:null}function dy(e,t){for(const n in e)e.hasOwnProperty(n)&&t(e[n],n)}function fy(e){return _a(e)?e:Ca(e)?ae(Promise.resolve(e)):Vg(e)}const py={exact:function e(t,n,r){if(!Py(t.segments,n.segments)||!Cy(t.segments,n.segments,r)||t.numberOfChildren!==n.numberOfChildren)return!1;for(const i in n.children)if(!t.children[i]||!e(t.children[i],n.children[i],r))return!1;return!0},subset:yy},gy={exact:function(e,t){return ly(e,t)},subset:function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(n=>cy(e[n],t[n]))},ignored:()=>!0};function my(e,t,n){return py[n.paths](e.root,t.root,n.matrixParams)&&gy[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function yy(e,t,n){return vy(e,t,t.segments,n)}function vy(e,t,n,r){if(e.segments.length>n.length){const i=e.segments.slice(0,n.length);return!(!Py(i,n)||t.hasChildren()||!Cy(i,n,r))}if(e.segments.length===n.length){if(!Py(e.segments,n)||!Cy(e.segments,n,r))return!1;for(const n in t.children)if(!e.children[n]||!yy(e.children[n],t.children[n],r))return!1;return!0}{const i=n.slice(0,e.segments.length),s=n.slice(e.segments.length);return!!(Py(e.segments,i)&&Cy(e.segments,i,r)&&e.children[ny])&&vy(e.children[ny],t,s,r)}}function Cy(e,t,n){return t.every((t,r)=>gy[n](e[r].parameters,t.parameters))}class _y{constructor(e,t,n){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=iy(this.queryParams)),this._queryParamMap}toString(){return Oy.serialize(this)}}class Ey{constructor(e,t){this.segments=e,this.children=t,this.parent=null,dy(t,(e,t)=>e.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ty(this)}}class wy{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=iy(this.parameters)),this._parameterMap}toString(){return xy(this)}}function Py(e,t){return e.length===t.length&&e.every((e,n)=>e.path===t[n].path)}class Sy{}class by{parse(e){const t=new Vy(e);return new _y(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Iy(e.root,!0)}`,n=function(e){const t=Object.keys(e).map(t=>{const n=e[t];return Array.isArray(n)?n.map(e=>`${Ay(t)}=${Ay(e)}`).join("&"):`${Ay(t)}=${Ay(n)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(e.queryParams);var r;return`${t}${n}${"string"==typeof e.fragment?`#${r=e.fragment,encodeURI(r)}`:""}`}}const Oy=new by;function Ty(e){return e.segments.map(e=>xy(e)).join("/")}function Iy(e,t){if(!e.hasChildren())return Ty(e);if(t){const t=e.children[ny]?Iy(e.children[ny],!1):"",n=[];return dy(e.children,(e,t)=>{t!==ny&&n.push(`${t}:${Iy(e,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function(e,t){let n=[];return dy(e.children,(e,r)=>{r===ny&&(n=n.concat(t(e,r)))}),dy(e.children,(e,r)=>{r!==ny&&(n=n.concat(t(e,r)))}),n}(e,(t,n)=>n===ny?[Iy(e.children[ny],!1)]:[`${n}:${Iy(t,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[ny]?`${Ty(e)}/${t[0]}`:`${Ty(e)}/(${t.join("//")})`}}function ky(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ay(e){return ky(e).replace(/%3B/gi,";")}function My(e){return ky(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ny(e){return decodeURIComponent(e)}function Ry(e){return Ny(e.replace(/\+/g,"%20"))}function xy(e){return`${My(e.path)}${function(e){return Object.keys(e).map(t=>`;${My(t)}=${My(e[t])}`).join("")}(e.parameters)}`}const Dy=/^[^\/()?;=#]+/;function Ly(e){const t=e.match(Dy);return t?t[0]:""}const Fy=/^[^=?&#]+/,Uy=/^[^?&#]+/;class Vy{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ey([],{}):new Ey([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[ny]=new Ey(e,t)),n}parseSegment(){const e=Ly(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new wy(Ny(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=Ly(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const e=Ly(this.remaining);e&&(n=e,this.capture(n))}e[Ny(t)]=Ny(n)}parseQueryParam(e){const t=function(e){const t=e.match(Fy);return t?t[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const e=function(e){const t=e.match(Uy);return t?t[0]:""}(this.remaining);e&&(n=e,this.capture(n))}const r=Ry(t),i=Ry(n);if(e.hasOwnProperty(r)){let t=e[r];Array.isArray(t)||(t=[t],e[r]=t),t.push(i)}else e[r]=i}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=Ly(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let i;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):e&&(i=ny);const s=this.parseChildren();t[i]=1===Object.keys(s).length?s[ny]:new Ey([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class By{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=$y(e,this._root);return t?t.children.map(e=>e.value):[]}firstChild(e){const t=$y(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=zy(e,this._root);return t.length<2?[]:t[t.length-2].children.map(e=>e.value).filter(t=>t!==e)}pathFromRoot(e){return zy(e,this._root).map(e=>e.value)}}function $y(e,t){if(e===t.value)return t;for(const n of t.children){const t=$y(e,n);if(t)return t}return null}function zy(e,t){if(e===t.value)return[t];for(const n of t.children){const r=zy(e,n);if(r.length)return r.unshift(t),r}return[]}class Hy{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Gy(e){const t={};return e&&e.children.forEach(e=>t[e.value.outlet]=e),t}class Zy extends By{constructor(e,t){super(e),this.snapshot=t,Qy(this,e)}toString(){return this.snapshot.toString()}}function qy(e,t){const n=function(e,t){const n=new Yy([],{},{},"",{},ny,t,null,e.root,-1,{});return new Ky("",new Hy(n,[]))}(e,t),r=new wm([new wy("",{})]),i=new wm({}),s=new wm({}),o=new wm({}),a=new wm(""),l=new Wy(r,i,o,a,s,ny,t,n.root);return l.snapshot=n.root,new Zy(new Hy(l,[]),n)}class Wy{constructor(e,t,n,r,i,s,o,a){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=s,this.component=o,this._futureSnapshot=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(D(e=>iy(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(D(e=>iy(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function jy(e,t="emptyOnly"){const n=e.pathFromRoot;let r=0;if("always"!==t)for(r=n.length-1;r>=1;){const e=n[r],t=n[r-1];if(e.routeConfig&&""===e.routeConfig.path)r--;else{if(t.component)break;r--}}return function(e){return e.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(r))}class Yy{constructor(e,t,n,r,i,s,o,a,l,c,u){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=s,this.component=o,this.routeConfig=a,this._urlSegment=l,this._lastPathIndex=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=iy(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=iy(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(e=>e.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Ky extends By{constructor(e,t){super(t),this.url=e,Qy(this,t)}toString(){return Xy(this._root)}}function Qy(e,t){t.value._routerState=e,t.children.forEach(t=>Qy(e,t))}function Xy(e){const t=e.children.length>0?` { ${e.children.map(Xy).join(", ")} } `:"";return`${e.value}${t}`}function Jy(e){if(e.snapshot){const t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,ly(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),ly(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!ly(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),ly(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function ev(e,t){const n=ly(e.params,t.params)&&function(e,t){return Py(e,t)&&e.every((e,n)=>ly(e.parameters,t[n].parameters))}(e.url,t.url);return n&&!(!e.parent!=!t.parent)&&(!e.parent||ev(e.parent,t.parent))}function tv(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=t.value;const i=function(e,t,n){return t.children.map(t=>{for(const r of n.children)if(e.shouldReuseRoute(t.value,r.value.snapshot))return tv(e,t,r);return tv(e,t)})}(e,t,n);return new Hy(r,i)}{if(e.shouldAttach(t.value)){const n=e.retrieve(t.value);if(null!==n){const e=n.route;return nv(t,e),e}}const n=function(e){return new Wy(new wm(e.url),new wm(e.params),new wm(e.queryParams),new wm(e.fragment),new wm(e.data),e.outlet,e.component,e)}(t.value),r=t.children.map(t=>tv(e,t));return new Hy(n,r)}}function nv(e,t){if(e.value.routeConfig!==t.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==t.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");t.value._futureSnapshot=e.value;for(let n=0;n<e.children.length;++n)nv(e.children[n],t.children[n])}function rv(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function iv(e){return"object"==typeof e&&null!=e&&e.outlets}function sv(e,t,n,r,i){let s={};return r&&dy(r,(e,t)=>{s[t]=Array.isArray(e)?e.map(e=>`${e}`):`${e}`}),new _y(n.root===e?t:ov(n.root,e,t),s,i)}function ov(e,t,n){const r={};return dy(e.children,(e,i)=>{r[i]=e===t?n:ov(e,t,n)}),new Ey(e.segments,r)}class av{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&rv(n[0]))throw new Error("Root segment cannot have matrix parameters");const r=n.find(iv);if(r&&r!==hy(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class lv{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function cv(e,t,n){if(e||(e=new Ey([],{})),0===e.segments.length&&e.hasChildren())return uv(e,t,n);const r=function(e,t,n){let r=0,i=t;const s={match:!1,pathIndex:0,commandIndex:0};for(;i<e.segments.length;){if(r>=n.length)return s;const t=e.segments[i],o=n[r];if(iv(o))break;const a=`${o}`,l=r<n.length-1?n[r+1]:null;if(i>0&&void 0===a)break;if(a&&l&&"object"==typeof l&&void 0===l.outlets){if(!pv(a,l,t))return s;r+=2}else{if(!pv(a,{},t))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(e,t,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){const t=new Ey(e.segments.slice(0,r.pathIndex),{});return t.children[ny]=new Ey(e.segments.slice(r.pathIndex),e.children),uv(t,0,i)}return r.match&&0===i.length?new Ey(e.segments,{}):r.match&&!e.hasChildren()?hv(e,t,n):r.match?uv(e,0,i):hv(e,t,n)}function uv(e,t,n){if(0===n.length)return new Ey(e.segments,{});{const r=function(e){return iv(e[0])?e[0].outlets:{[ny]:e}}(n),i={};return dy(r,(n,r)=>{"string"==typeof n&&(n=[n]),null!==n&&(i[r]=cv(e.children[r],t,n))}),dy(e.children,(e,t)=>{void 0===r[t]&&(i[t]=e)}),new Ey(e.segments,i)}}function hv(e,t,n){const r=e.segments.slice(0,t);let i=0;for(;i<n.length;){const s=n[i];if(iv(s)){const e=dv(s.outlets);return new Ey(r,e)}if(0===i&&rv(n[0])){r.push(new wy(e.segments[t].path,fv(n[0]))),i++;continue}const o=iv(s)?s.outlets[ny]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&rv(a)?(r.push(new wy(o,fv(a))),i+=2):(r.push(new wy(o,{})),i++)}return new Ey(r,{})}function dv(e){const t={};return dy(e,(e,n)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[n]=hv(new Ey([],{}),0,e))}),t}function fv(e){const t={};return dy(e,(e,n)=>t[n]=`${e}`),t}function pv(e,t,n){return e==n.path&&ly(t,n.parameters)}class gv{constructor(e,t,n,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),Jy(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const r=Gy(t);e.children.forEach(e=>{const t=e.value.outlet;this.deactivateRoutes(e,r[t],n),delete r[t]}),dy(r,(e,t)=>{this.deactivateRouteAndItsChildren(e,n)})}deactivateRoutes(e,t,n){const r=e.value,i=t?t.value:null;if(r===i)if(r.component){const i=n.getContext(r.outlet);i&&this.deactivateChildRoutes(e,t,i.children)}else this.deactivateChildRoutes(e,t,n);else i&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet);if(n&&n.outlet){const t=n.outlet.detach(),r=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:t,route:e,contexts:r})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,i=Gy(e);for(const s of Object.keys(i))this.deactivateRouteAndItsChildren(i[s],r);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(e,t,n){const r=Gy(t);e.children.forEach(e=>{this.activateRoutes(e,r[e.value.outlet],n),this.forwardEvent(new ey(e.value.snapshot))}),e.children.length&&this.forwardEvent(new Xm(e.value.snapshot))}activateRoutes(e,t,n){const r=e.value,i=t?t.value:null;if(Jy(r),r===i)if(r.component){const i=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,i.children)}else this.activateChildRoutes(e,t,n);else if(r.component){const t=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const e=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),t.children.onOutletReAttached(e.contexts),t.attachRef=e.componentRef,t.route=e.route.value,t.outlet&&t.outlet.attach(e.componentRef,e.route.value),mv(e.route)}else{const n=function(e){for(let t=e.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig;if(e&&e.component)return null}return null}(r.snapshot),i=n?n.module.componentFactoryResolver:null;t.attachRef=null,t.route=r,t.resolver=i,t.outlet&&t.outlet.activateWith(r,i),this.activateChildRoutes(e,null,t.children)}}else this.activateChildRoutes(e,null,n)}}function mv(e){Jy(e.value),e.children.forEach(mv)}class yv{constructor(e,t){this.routes=e,this.module=t}}function vv(e){return"function"==typeof e}function Cv(e){return e instanceof _y}const _v=Symbol("INITIAL_VALUE");function Ev(){return km(e=>function(...e){const t=re(e),n=ne(e),{args:r,keys:i}=Kf(e);if(0===r.length)return ae([],t);const s=new T(function(e,t,n=O){return r=>{Pm(t,()=>{const{length:i}=e,s=new Array(i);let o=i,a=i;for(let l=0;l<i;l++)Pm(t,()=>{const i=ae(e[l],t);let c=!1;i.subscribe(new x(r,e=>{s[l]=e,c||(c=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,t,i?e=>Jf(i,e):O));return n?s.pipe(Xf(n)):s}(e.map(e=>e.pipe(le(1),function(...e){const t=re(e);return R((n,r)=>{(t?bm(e,n,t):bm(e,n)).subscribe(r)})}(_v)))).pipe(Mm((e,t)=>{let n=!1;return t.reduce((e,r,i)=>e!==_v?e:(r===_v&&(n=!0),n||!1!==r&&i!==t.length-1&&!Cv(r)?e:r),e)},_v),$g(e=>e!==_v),D(e=>Cv(e)?e:!0===e),le(1)))}let wv=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Je({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&ga(0,"router-outlet")},directives:function(){return[_C]},encapsulation:2}),e})();function Pv(e,t=""){for(let n=0;n<e.length;n++){const r=e[n];Sv(r,bv(t,r))}}function Sv(e,t){e.children&&Pv(e.children,t)}function bv(e,t){return t?e||t.path?e&&!t.path?`${e}/`:!e&&t.path?t.path:`${e}/${t.path}`:"":e}function Ov(e){const t=e.children&&e.children.map(Ov),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==ny&&(n.component=wv),n}function Tv(e){return e.outlet||ny}function Iv(e,t){const n=e.filter(e=>Tv(e)===t);return n.push(...e.filter(e=>Tv(e)!==t)),n}const kv={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function Av(e,t,n){var r;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?Object.assign({},kv):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const i=(t.matcher||ay)(n,e,t);if(!i)return Object.assign({},kv);const s={};dy(i.posParams,(e,t)=>{s[t]=e.path});const o=i.consumed.length>0?Object.assign(Object.assign({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,lastChild:i.consumed.length,parameters:o,positionalParamSegments:null!==(r=i.posParams)&&void 0!==r?r:{}}}function Mv(e,t,n,r,i="corrected"){if(n.length>0&&function(e,t,n){return n.some(n=>Nv(e,t,n)&&Tv(n)!==ny)}(e,n,r)){const i=new Ey(t,function(e,t,n,r){const i={};i[ny]=r,r._sourceSegment=e,r._segmentIndexShift=t.length;for(const s of n)if(""===s.path&&Tv(s)!==ny){const n=new Ey([],{});n._sourceSegment=e,n._segmentIndexShift=t.length,i[Tv(s)]=n}return i}(e,t,r,new Ey(n,e.children)));return i._sourceSegment=e,i._segmentIndexShift=t.length,{segmentGroup:i,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return n.some(n=>Nv(e,t,n))}(e,n,r)){const s=new Ey(e.segments,function(e,t,n,r,i,s){const o={};for(const a of r)if(Nv(e,n,a)&&!i[Tv(a)]){const n=new Ey([],{});n._sourceSegment=e,n._segmentIndexShift="legacy"===s?e.segments.length:t.length,o[Tv(a)]=n}return Object.assign(Object.assign({},i),o)}(e,t,n,r,e.children,i));return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}const s=new Ey(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function Nv(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function Rv(e,t,n,r){return!!(Tv(e)===r||r!==ny&&Nv(t,n,e))&&("**"===e.path||Av(t,e,n).matched)}function xv(e,t,n){return 0===t.length&&!e.children[n]}class Dv{constructor(e){this.segmentGroup=e||null}}class Lv{constructor(e){this.urlTree=e}}function Fv(e){return new T(t=>t.error(new Dv(e)))}function Uv(e){return new T(t=>t.error(new Lv(e)))}function Vv(e){return new T(t=>t.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e}'`)))}class Bv{constructor(e,t,n,r,i){this.configLoader=t,this.urlSerializer=n,this.urlTree=r,this.config=i,this.allowRedirects=!0,this.ngModule=e.get(iu)}apply(){const e=Mv(this.urlTree.root,[],[],this.config).segmentGroup,t=new Ey(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,t,ny).pipe(D(e=>this.createUrlTree($v(e),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Nm(e=>{if(e instanceof Lv)return this.allowRedirects=!1,this.match(e.urlTree);throw e instanceof Dv?this.noMatchError(e):e}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,ny).pipe(D(t=>this.createUrlTree($v(t),e.queryParams,e.fragment))).pipe(Nm(e=>{throw e instanceof Dv?this.noMatchError(e):e}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,n){const r=e.segments.length>0?new Ey([],{[ny]:e}):e;return new _y(r,t,n)}expandSegmentGroup(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(D(e=>new Ey([],e))):this.expandSegment(e,n,t,n.segments,r,!0)}expandChildren(e,t,n){const r=[];for(const i of Object.keys(n.children))"primary"===i?r.unshift(i):r.push(i);return ae(r).pipe(Bg(r=>{const i=n.children[r],s=Iv(t,r);return this.expandSegmentGroup(e,s,i,r).pipe(D(e=>({segment:e,outlet:r})))}),Mm((e,t)=>(e[t.outlet]=t.segment,e),{}),function(e,t){const n=arguments.length>=2;return r=>r.pipe(e?$g((t,n)=>e(t,n,r)):O,Rm(1),n?Lm(t):xm(()=>new Sm))}())}expandSegment(e,t,n,r,i,s){return ae(n).pipe(Bg(o=>this.expandSegmentAgainstRoute(e,t,n,o,r,i,s).pipe(Nm(e=>{if(e instanceof Dv)return Vg(null);throw e}))),Fm(e=>!!e),Nm((e,n)=>{if(e instanceof Sm||"EmptyError"===e.name){if(xv(t,r,i))return Vg(new Ey([],{}));throw new Dv(t)}throw e}))}expandSegmentAgainstRoute(e,t,n,r,i,s,o){return Rv(r,t,i,s)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,i,s):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,s):Fv(t):Fv(t)}expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,s){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,s):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,s)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,r){const i=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?Uv(i):this.lineralizeSegments(n,i).pipe(X(n=>{const i=new Ey(n,{});return this.expandSegment(e,i,t,n,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,s){const{matched:o,consumedSegments:a,lastChild:l,positionalParamSegments:c}=Av(t,r,i);if(!o)return Fv(t);const u=this.applyRedirectCommands(a,r.redirectTo,c);return r.redirectTo.startsWith("/")?Uv(u):this.lineralizeSegments(r,u).pipe(X(r=>this.expandSegment(e,t,n,r.concat(i.slice(l)),s,!1)))}matchSegmentAgainstRoute(e,t,n,r,i){if("**"===n.path)return n.loadChildren?(n._loadedConfig?Vg(n._loadedConfig):this.configLoader.load(e.injector,n)).pipe(D(e=>(n._loadedConfig=e,new Ey(r,{})))):Vg(new Ey(r,{}));const{matched:s,consumedSegments:o,lastChild:a}=Av(t,n,r);if(!s)return Fv(t);const l=r.slice(a);return this.getChildConfig(e,n,r).pipe(X(e=>{const r=e.module,s=e.routes,{segmentGroup:a,slicedSegments:c}=Mv(t,o,l,s),u=new Ey(a.segments,a.children);if(0===c.length&&u.hasChildren())return this.expandChildren(r,s,u).pipe(D(e=>new Ey(o,e)));if(0===s.length&&0===c.length)return Vg(new Ey(o,{}));const h=Tv(n)===i;return this.expandSegment(r,u,s,c,h?ny:i,!0).pipe(D(e=>new Ey(o.concat(e.segments),e.children)))}))}getChildConfig(e,t,n){return t.children?Vg(new yv(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?Vg(t._loadedConfig):this.runCanLoadGuards(e.injector,t,n).pipe(X(n=>{return n?this.configLoader.load(e.injector,t).pipe(D(e=>(t._loadedConfig=e,e))):(r=t,new T(e=>e.error(oy(`Cannot load children because the guard of the route "path: '${r.path}'" returned false`))));var r})):Vg(new yv([],e))}runCanLoadGuards(e,t,n){const r=t.canLoad;return r&&0!==r.length?Vg(r.map(r=>{const i=e.get(r);let s;if((o=i)&&vv(o.canLoad))s=i.canLoad(t,n);else{if(!vv(i))throw new Error("Invalid CanLoad guard");s=i(t,n)}var o;return fy(s)})).pipe(Ev(),Um(e=>{if(!Cv(e))return;const t=oy(`Redirecting to "${this.urlSerializer.serialize(e)}"`);throw t.url=e,t}),D(e=>!0===e)):Vg(!0)}lineralizeSegments(e,t){let n=[],r=t.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Vg(n);if(r.numberOfChildren>1||!r.children[ny])return Vv(e.redirectTo);r=r.children[ny]}}applyRedirectCommands(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreatreUrlTree(e,t,n,r){const i=this.createSegmentGroup(e,t.root,n,r);return new _y(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return dy(e,(e,r)=>{if("string"==typeof e&&e.startsWith(":")){const i=e.substring(1);n[r]=t[i]}else n[r]=e}),n}createSegmentGroup(e,t,n,r){const i=this.createSegments(e,t.segments,n,r);let s={};return dy(t.children,(t,i)=>{s[i]=this.createSegmentGroup(e,t,n,r)}),new Ey(i,s)}createSegments(e,t,n,r){return t.map(t=>t.path.startsWith(":")?this.findPosParam(e,t,r):this.findOrReturn(t,n))}findPosParam(e,t,n){const r=n[t.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return r}findOrReturn(e,t){let n=0;for(const r of t){if(r.path===e.path)return t.splice(n),r;n++}return e}}function $v(e){const t={};for(const n of Object.keys(e.children)){const r=$v(e.children[n]);(r.segments.length>0||r.hasChildren())&&(t[n]=r)}return function(e){if(1===e.numberOfChildren&&e.children[ny]){const t=e.children[ny];return new Ey(e.segments.concat(t.segments),t.children)}return e}(new Ey(e.segments,t))}class zv{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Hv{constructor(e,t){this.component=e,this.route=t}}function Gv(e,t,n){const r=e._root;return qv(r,t?t._root:null,n,[r.value])}function Zv(e,t,n){const r=function(e){if(!e)return null;for(let t=e.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function qv(e,t,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=Gy(t);return e.children.forEach(e=>{(function(e,t,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=e.value,o=t?t.value:null,a=n?n.getContext(e.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!Py(e.url,t.url);case"pathParamsOrQueryParamsChange":return!Py(e.url,t.url)||!ly(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ev(e,t)||!ly(e.queryParams,t.queryParams);default:return!ev(e,t)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new zv(r)):(s.data=o.data,s._resolvedData=o._resolvedData),qv(e,t,s.component?a?a.children:null:n,r,i),l&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Hv(a.outlet.component,o))}else o&&Wv(t,a,i),i.canActivateChecks.push(new zv(r)),qv(e,null,s.component?a?a.children:null:n,r,i)})(e,s[e.value.outlet],n,r.concat([e.value]),i),delete s[e.value.outlet]}),dy(s,(e,t)=>Wv(e,n.getContext(t),i)),i}function Wv(e,t,n){const r=Gy(e),i=e.value;dy(r,(e,r)=>{Wv(e,i.component?t?t.children.getContext(r):null:t,n)}),n.canDeactivateChecks.push(new Hv(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}class jv{}function Yv(e){return new T(t=>t.error(e))}class Kv{constructor(e,t,n,r,i,s){this.rootComponentType=e,this.config=t,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=i,this.relativeLinkResolution=s}recognize(){const e=Mv(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,ny);if(null===t)return null;const n=new Yy([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},ny,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Hy(n,t),i=new Ky(this.url,r);return this.inheritParamsAndData(i._root),i}inheritParamsAndData(e){const t=e.value,n=jy(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(e=>this.inheritParamsAndData(e))}processSegmentGroup(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}processChildren(e,t){const n=[];for(const i of Object.keys(t.children)){const r=t.children[i],s=Iv(e,i),o=this.processSegmentGroup(s,r,i);if(null===o)return null;n.push(...o)}const r=Xv(n);return r.sort((e,t)=>e.value.outlet===ny?-1:t.value.outlet===ny?1:e.value.outlet.localeCompare(t.value.outlet)),r}processSegment(e,t,n,r){for(const i of e){const e=this.processSegmentAgainstRoute(i,t,n,r);if(null!==e)return e}return xv(t,n,r)?[]:null}processSegmentAgainstRoute(e,t,n,r){if(e.redirectTo||!Rv(e,t,n,r))return null;let i,s=[],o=[];if("**"===e.path){const r=n.length>0?hy(n).parameters:{};i=new Yy(n,r,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,tC(e),Tv(e),e.component,e,Jv(t),eC(t)+n.length,nC(e))}else{const r=Av(t,e,n);if(!r.matched)return null;s=r.consumedSegments,o=n.slice(r.lastChild),i=new Yy(s,r.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,tC(e),Tv(e),e.component,e,Jv(t),eC(t)+s.length,nC(e))}const a=(u=e).children?u.children:u.loadChildren?u._loadedConfig.routes:[],{segmentGroup:l,slicedSegments:c}=Mv(t,s,o,a.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution);var u;if(0===c.length&&l.hasChildren()){const e=this.processChildren(a,l);return null===e?null:[new Hy(i,e)]}if(0===a.length&&0===c.length)return[new Hy(i,[])];const h=Tv(e)===r,d=this.processSegment(a,l,c,h?ny:r);return null===d?null:[new Hy(i,d)]}}function Qv(e){const t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function Xv(e){const t=[],n=new Set;for(const r of e){if(!Qv(r)){t.push(r);continue}const e=t.find(e=>r.value.routeConfig===e.value.routeConfig);void 0!==e?(e.children.push(...r.children),n.add(e)):t.push(r)}for(const r of n){const e=Xv(r.children);t.push(new Hy(r.value,e))}return t.filter(e=>!n.has(e))}function Jv(e){let t=e;for(;t._sourceSegment;)t=t._sourceSegment;return t}function eC(e){let t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;for(;t._sourceSegment;)t=t._sourceSegment,n+=t._segmentIndexShift?t._segmentIndexShift:0;return n-1}function tC(e){return e.data||{}}function nC(e){return e.resolve||{}}function rC(e){return km(t=>{const n=e(t);return n?ae(n).pipe(D(()=>t)):Vg(t)})}class iC extends class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const sC=new or("ROUTES");class oC{constructor(e,t,n,r){this.loader=e,this.compiler=t,this.onLoadStartListener=n,this.onLoadEndListener=r}load(e,t){if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);const n=this.loadModuleFactory(t.loadChildren).pipe(D(n=>{this.onLoadEndListener&&this.onLoadEndListener(t);const r=n.create(e);return new yv(uy(r.injector.get(sC,void 0,Ne.Self|Ne.Optional)).map(Ov),r)}),Nm(e=>{throw t._loader$=void 0,e}));return t._loader$=new Im(n,()=>new A).pipe(Tm()),t._loader$}loadModuleFactory(e){return"string"==typeof e?ae(this.loader.load(e)):fy(e()).pipe(X(e=>e instanceof su?Vg(e):ae(this.compiler.compileModuleAsync(e))))}}class aC{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new lC,this.attachRef=null}}class lC{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new aC,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}class cC{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function uC(e){throw e}function hC(e,t,n){return t.parse("/")}function dC(e,t){return Vg(null)}const fC={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},pC={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let gC=(()=>{class e{constructor(e,t,n,r,i,s,o,a){this.rootComponentType=e,this.urlSerializer=t,this.rootContexts=n,this.location=r,this.config=a,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new A,this.errorHandler=uC,this.malformedUriErrorHandler=hC,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:dC,afterPreactivation:dC},this.urlHandlingStrategy=new cC,this.routeReuseStrategy=new iC,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=i.get(iu),this.console=i.get(sh);const l=i.get(vh);this.isNgZoneEnabled=l instanceof vh&&vh.isInAngularZone(),this.resetConfig(a),this.currentUrlTree=new _y(new Ey([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new oC(s,o,e=>this.triggerEvent(new Ym(e)),e=>this.triggerEvent(new Km(e))),this.routerState=qy(this.currentUrlTree,this.rootComponentType),this.transitions=new wm({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var e;return null===(e=this.location.getState())||void 0===e?void 0:e.\u0275routerPageId}setupNavigations(e){const t=this.events;return e.pipe($g(e=>0!==e.id),D(e=>Object.assign(Object.assign({},e),{extractedUrl:this.urlHandlingStrategy.extract(e.rawUrl)})),km(e=>{let n=!1,r=!1;return Vg(e).pipe(Um(e=>{this.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),km(e=>{const n=this.browserUrlTree.toString(),i=!this.navigated||e.extractedUrl.toString()!==n||n!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||i)&&this.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return mC(e.source)&&(this.browserUrlTree=e.extractedUrl),Vg(e).pipe(km(e=>{const n=this.transitions.getValue();return t.next(new Bm(e.id,this.serializeUrl(e.extractedUrl),e.source,e.restoredState)),n!==this.transitions.getValue()?ee:Promise.resolve(e)}),function(e,t,n,r){return km(i=>function(e,t,n,r,i){return new Bv(e,t,n,r,i).apply()}(e,t,n,i.extractedUrl,r).pipe(D(e=>Object.assign(Object.assign({},i),{urlAfterRedirects:e}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Um(e=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:e.urlAfterRedirects})}),function(e,t,n,i,s){return X(o=>function(e,t,n,i,s="emptyOnly",o="legacy"){try{const r=new Kv(e,t,n,i,s,o).recognize();return null===r?Yv(new jv):Vg(r)}catch(r){return Yv(r)}}(e,t,o.urlAfterRedirects,n(o.urlAfterRedirects),i,s).pipe(D(e=>Object.assign(Object.assign({},o),{targetSnapshot:e}))))}(this.rootComponentType,this.config,e=>this.serializeUrl(e),this.paramsInheritanceStrategy,this.relativeLinkResolution),Um(e=>{"eager"===this.urlUpdateStrategy&&(e.extras.skipLocationChange||this.setBrowserUrl(e.urlAfterRedirects,e),this.browserUrlTree=e.urlAfterRedirects);const n=new Gm(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.next(n)}));if(i&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:n,extractedUrl:r,source:i,restoredState:s,extras:o}=e,a=new Bm(n,this.serializeUrl(r),i,s);t.next(a);const l=qy(r,this.rootComponentType).snapshot;return Vg(Object.assign(Object.assign({},e),{targetSnapshot:l,urlAfterRedirects:r,extras:Object.assign(Object.assign({},o),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=e.rawUrl,this.browserUrlTree=e.urlAfterRedirects,e.resolve(null),ee}),rC(e=>{const{targetSnapshot:t,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:s,replaceUrl:o}}=e;return this.hooks.beforePreactivation(t,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!s,replaceUrl:!!o})}),Um(e=>{const t=new Zm(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}),D(e=>Object.assign(Object.assign({},e),{guards:Gv(e.targetSnapshot,e.currentSnapshot,this.rootContexts)})),function(e,t){return X(n=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return 0===o.length&&0===s.length?Vg(Object.assign(Object.assign({},n),{guardsResult:!0})):function(e,t,n,r){return ae(e).pipe(X(e=>function(e,t,n,r,i){const s=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return s&&0!==s.length?Vg(s.map(s=>{const o=Zv(s,t,i);let a;if(function(e){return e&&vv(e.canDeactivate)}(o))a=fy(o.canDeactivate(e,t,n,r));else{if(!vv(o))throw new Error("Invalid CanDeactivate guard");a=fy(o(e,t,n,r))}return a.pipe(Fm())})).pipe(Ev()):Vg(!0)}(e.component,e.route,n,t,r)),Fm(e=>!0!==e,!0))}(o,r,i,e).pipe(X(n=>n&&function(e){return"boolean"==typeof e}(n)?function(e,t,n,r){return ae(t).pipe(Bg(t=>bm(function(e,t){return null!==e&&t&&t(new Qm(e)),Vg(!0)}(t.route.parent,r),function(e,t){return null!==e&&t&&t(new Jm(e)),Vg(!0)}(t.route,r),function(e,t,n){const r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(e=>function(e){const t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)).filter(e=>null!==e).map(t=>Om(()=>Vg(t.guards.map(i=>{const s=Zv(i,t.node,n);let o;if(function(e){return e&&vv(e.canActivateChild)}(s))o=fy(s.canActivateChild(r,e));else{if(!vv(s))throw new Error("Invalid CanActivateChild guard");o=fy(s(r,e))}return o.pipe(Fm())})).pipe(Ev())));return Vg(i).pipe(Ev())}(e,t.path,n),function(e,t,n){const r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return Vg(!0);const i=r.map(r=>Om(()=>{const i=Zv(r,t,n);let s;if(function(e){return e&&vv(e.canActivate)}(i))s=fy(i.canActivate(t,e));else{if(!vv(i))throw new Error("Invalid CanActivate guard");s=fy(i(t,e))}return s.pipe(Fm())}));return Vg(i).pipe(Ev())}(e,t.route,n))),Fm(e=>!0!==e,!0))}(r,s,e,t):Vg(n)),D(e=>Object.assign(Object.assign({},n),{guardsResult:e})))})}(this.ngModule.injector,e=>this.triggerEvent(e)),Um(e=>{if(Cv(e.guardsResult)){const t=oy(`Redirecting to "${this.serializeUrl(e.guardsResult)}"`);throw t.url=e.guardsResult,t}const t=new qm(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);this.triggerEvent(t)}),$g(e=>!!e.guardsResult||(this.restoreHistory(e),this.cancelNavigationTransition(e,""),!1)),rC(e=>{if(e.guards.canActivateChecks.length)return Vg(e).pipe(Um(e=>{const t=new Wm(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}),km(e=>{let t=!1;return Vg(e).pipe(function(e,t){return X(n=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return Vg(n);let s=0;return ae(i).pipe(Bg(n=>function(e,t,n,r){return function(e,t,n,r){const i=Object.keys(e);if(0===i.length)return Vg({});const s={};return ae(i).pipe(X(i=>function(e,t,n,r){const i=Zv(e,t,r);return fy(i.resolve?i.resolve(t,n):i(t,n))}(e[i],t,n,r).pipe(Um(e=>{s[i]=e}))),Rm(1),X(()=>Object.keys(s).length===i.length?Vg(s):ee))}(e._resolve,e,t,r).pipe(D(t=>(e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),jy(e,n).resolve),null)))}(n.route,r,e,t)),Um(()=>s++),Rm(1),X(e=>s===i.length?Vg(n):ee))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Um({next:()=>t=!0,complete:()=>{t||(this.restoreHistory(e),this.cancelNavigationTransition(e,"At least one route resolver didn't emit any value."))}}))}),Um(e=>{const t=new jm(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}))}),rC(e=>{const{targetSnapshot:t,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:s,replaceUrl:o}}=e;return this.hooks.afterPreactivation(t,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!s,replaceUrl:!!o})}),D(e=>{const t=function(e,t,n){const r=tv(e,t._root,n?n._root:void 0);return new Zy(r,t)}(this.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:t})}),Um(e=>{this.currentUrlTree=e.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(e.urlAfterRedirects,e.rawUrl),this.routerState=e.targetRouterState,"deferred"===this.urlUpdateStrategy&&(e.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,e),this.browserUrlTree=e.urlAfterRedirects)}),((e,t,n)=>D(r=>(new gv(t,r.targetRouterState,r.currentRouterState,n).activate(e),r)))(this.rootContexts,this.routeReuseStrategy,e=>this.triggerEvent(e)),Um({next(){n=!0},complete(){n=!0}}),function(e){return R((t,n)=>{try{t.subscribe(n)}finally{n.add(e)}})}(()=>{var t;if(!n&&!r){const t=`Navigation ID ${e.id} is not equal to the current navigation id ${this.navigationId}`;"replace"===this.canceledNavigationResolution?(this.restoreHistory(e),this.cancelNavigationTransition(e,t)):this.cancelNavigationTransition(e,t)}(null===(t=this.currentNavigation)||void 0===t?void 0:t.id)===e.id&&(this.currentNavigation=null)}),Nm(n=>{if(r=!0,function(e){return e&&e[sy]}(n)){const r=Cv(n.url);r||(this.navigated=!0,this.restoreHistory(e,!0));const i=new zm(e.id,this.serializeUrl(e.extractedUrl),n.message);t.next(i),r?setTimeout(()=>{const t=this.urlHandlingStrategy.merge(n.url,this.rawUrlTree),r={skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||mC(e.source)};this.scheduleNavigation(t,"imperative",null,r,{resolve:e.resolve,reject:e.reject,promise:e.promise})},0):e.resolve(!1)}else{this.restoreHistory(e,!0);const r=new Hm(e.id,this.serializeUrl(e.extractedUrl),n);t.next(r);try{e.resolve(this.errorHandler(n))}catch(i){e.reject(i)}}return ee}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}getTransition(){const e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}setTransition(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const t=this.extractLocationChangeInfoFromEvent(e);this.shouldScheduleNavigation(this.lastLocationChangeInfo,t)&&setTimeout(()=>{const{source:e,state:n,urlTree:r}=t,i={replaceUrl:!0};if(n){const e=Object.assign({},n);delete e.navigationId,delete e.\u0275routerPageId,0!==Object.keys(e).length&&(i.state=e)}this.scheduleNavigation(r,e,n,i)},0),this.lastLocationChangeInfo=t}))}extractLocationChangeInfoFromEvent(e){var t;return{source:"popstate"===e.type?"popstate":"hashchange",urlTree:this.parseUrl(e.url),state:(null===(t=e.state)||void 0===t?void 0:t.navigationId)?e.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(e,t){if(!e)return!0;const n=t.urlTree.toString()===e.urlTree.toString();return t.transitionId!==e.transitionId||!n||!("hashchange"===t.source&&"popstate"===e.source||"popstate"===t.source&&"hashchange"===e.source)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){Pv(e),this.config=e.map(Ov),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,t={}){const{relativeTo:n,queryParams:r,fragment:i,queryParamsHandling:s,preserveFragment:o}=t,a=n||this.routerState.root,l=o?this.currentUrlTree.fragment:i;let c=null;switch(s){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}return null!==c&&(c=this.removeEmptyProps(c)),function(e,t,n,r,i){if(0===n.length)return sv(t.root,t.root,t,r,i);const s=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new av(!0,0,e);let t=0,n=!1;const r=e.reduce((e,r,i)=>{if("object"==typeof r&&null!=r){if(r.outlets){const t={};return dy(r.outlets,(e,n)=>{t[n]="string"==typeof e?e.split("/"):e}),[...e,{outlets:t}]}if(r.segmentPath)return[...e,r.segmentPath]}return"string"!=typeof r?[...e,r]:0===i?(r.split("/").forEach((r,i)=>{0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?t++:""!=r&&e.push(r))}),e):[...e,r]},[]);return new av(n,t,r)}(n);if(s.toRoot())return sv(t.root,new Ey([],{}),t,r,i);const o=function(e,t,n){if(e.isAbsolute)return new lv(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){const e=n.snapshot._urlSegment;return new lv(e,e===t.root,0)}const r=rv(e.commands[0])?0:1;return function(e,t,n){let r=e,i=t,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new Error("Invalid number of '../'");i=r.segments.length}return new lv(r,!1,i-s)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+r,e.numberOfDoubleDots)}(s,t,e),a=o.processChildren?uv(o.segmentGroup,o.index,s.commands):cv(o.segmentGroup,o.index,s.commands);return sv(o.segmentGroup,a,t,r,i)}(a,this.currentUrlTree,e,c,l??null)}navigateByUrl(e,t={skipLocationChange:!1}){const n=Cv(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,t)}navigate(e,t={skipLocationChange:!1}){return function(e){for(let t=0;t<e.length;t++){const n=e[t];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${t}`)}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let t;try{t=this.urlSerializer.parse(e)}catch(n){t=this.malformedUriErrorHandler(n,this.urlSerializer,e)}return t}isActive(e,t){let n;if(n=!0===t?Object.assign({},fC):!1===t?Object.assign({},pC):t,Cv(e))return my(this.currentUrlTree,e,n);const r=this.parseUrl(e);return my(this.currentUrlTree,r,n)}removeEmptyProps(e){return Object.keys(e).reduce((t,n)=>{const r=e[n];return null!=r&&(t[n]=r),t},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new $m(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,e.resolve(!0)},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}scheduleNavigation(e,t,n,r,i){var s,o;if(this.disposed)return Promise.resolve(!1);const a=this.getTransition(),l=mC(t)&&a&&!mC(a.source),c=(this.lastSuccessfulId===a.id||this.currentNavigation?a.rawUrl:a.urlAfterRedirects).toString()===e.toString();if(l&&c)return Promise.resolve(!0);let u,h,d;i?(u=i.resolve,h=i.reject,d=i.promise):d=new Promise((e,t)=>{u=e,h=t});const f=++this.navigationId;let p;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(n=this.location.getState()),p=n&&n.\u0275routerPageId?n.\u0275routerPageId:r.replaceUrl||r.skipLocationChange?null!==(s=this.browserPageId)&&void 0!==s?s:0:(null!==(o=this.browserPageId)&&void 0!==o?o:0)+1):p=0,this.setTransition({id:f,targetPageId:p,source:t,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:r,resolve:u,reject:h,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(e=>Promise.reject(e))}setBrowserUrl(e,t){const n=this.urlSerializer.serialize(e),r=Object.assign(Object.assign({},t.extras.state),this.generateNgRouterState(t.id,t.targetPageId));this.location.isCurrentPathEqualTo(n)||t.extras.replaceUrl?this.location.replaceState(n,"",r):this.location.go(n,"",r)}restoreHistory(e,t=!1){var n,r;if("computed"===this.canceledNavigationResolution){const t=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(n=this.currentNavigation)||void 0===n?void 0:n.finalUrl)||0===t?this.currentUrlTree===(null===(r=this.currentNavigation)||void 0===r?void 0:r.finalUrl)&&0===t&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(t)}else"replace"===this.canceledNavigationResolution&&(t&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,t){const n=new zm(e.id,this.serializeUrl(e.extractedUrl),t);this.triggerEvent(n),e.resolve(!1)}generateNgRouterState(e,t){return"computed"===this.canceledNavigationResolution?{navigationId:e,"\u0275routerPageId":t}:{navigationId:e}}}return e.\u0275fac=function(t){return new(t||e)(Or(lr),Or(Sy),Or(lC),Or(hd),Or(zo),Or(Bh),Or(gh),Or(void 0))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();function mC(e){return"imperative"!==e}let yC=(()=>{class e{constructor(e,t,n,r,i){this.router=e,this.route=t,this.commands=[],this.onChanges=new A,null==n&&r.setAttribute(i.nativeElement,"tabindex","0")}ngOnChanges(e){this.onChanges.next(this)}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}onClick(){const e={skipLocationChange:CC(this.skipLocationChange),replaceUrl:CC(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:CC(this.preserveFragment)})}}return e.\u0275fac=function(t){return new(t||e)(ua(gC),ua(Wy),rr("tabindex"),ua(Oc),ua(Pc))},e.\u0275dir=st({type:e,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,t){1&e&&Ea("click",function(){return t.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[vt]}),e})(),vC=(()=>{class e{constructor(e,t,n){this.router=e,this.route=t,this.locationStrategy=n,this.commands=[],this.onChanges=new A,this.subscription=e.events.subscribe(e=>{e instanceof $m&&this.updateTargetUrlAndHref()})}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}ngOnChanges(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(e,t,n,r,i){if(0!==e||t||n||r||i||"string"==typeof this.target&&"_self"!=this.target)return!0;const s={skipLocationChange:CC(this.skipLocationChange),replaceUrl:CC(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,s),!1}updateTargetUrlAndHref(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:CC(this.preserveFragment)})}}return e.\u0275fac=function(t){return new(t||e)(ua(gC),ua(Wy),ua(od))},e.\u0275dir=st({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,t){1&e&&Ea("click",function(e){return t.onClick(e.button,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey)}),2&e&&(nl("href",t.href,Ci),ra("target",t.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[vt]}),e})();function CC(e){return""===e||!!e}let _C=(()=>{class e{constructor(e,t,n,r,i){this.parentContexts=e,this.location=t,this.resolver=n,this.changeDetector=i,this.activated=null,this._activatedRoute=null,this.activateEvents=new xu,this.deactivateEvents=new xu,this.name=r||ny,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,e}attach(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;const n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new EC(e,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return e.\u0275fac=function(t){return new(t||e)(ua(lC),ua(au),ua(Cc),rr("name"),ua(Yc))},e.\u0275dir=st({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),e})();class EC{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===Wy?this.route:e===lC?this.childContexts:this.parent.get(e,t)}}class wC{}class PC{preload(e,t){return Vg(null)}}let SC=(()=>{class e{constructor(e,t,n,r,i){this.router=e,this.injector=r,this.preloadingStrategy=i,this.loader=new oC(t,n,t=>e.triggerEvent(new Ym(t)),t=>e.triggerEvent(new Km(t)))}setUpPreloading(){this.subscription=this.router.events.pipe($g(e=>e instanceof $m),Bg(()=>this.preload())).subscribe(()=>{})}preload(){const e=this.injector.get(iu);return this.processRoutes(e,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,t){const n=[];for(const r of t)if(r.loadChildren&&!r.canLoad&&r._loadedConfig){const e=r._loadedConfig;n.push(this.processRoutes(e.module,e.routes))}else r.loadChildren&&!r.canLoad?n.push(this.preloadConfig(e,r)):r.children&&n.push(this.processRoutes(e,r.children));return ae(n).pipe(J(),D(e=>{}))}preloadConfig(e,t){return this.preloadingStrategy.preload(t,()=>(t._loadedConfig?Vg(t._loadedConfig):this.loader.load(e.injector,t)).pipe(X(e=>(t._loadedConfig=e,this.processRoutes(e.module,e.routes)))))}}return e.\u0275fac=function(t){return new(t||e)(Or(gC),Or(Bh),Or(gh),Or(zo),Or(wC))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),bC=(()=>{class e{constructor(e,t,n={}){this.router=e,this.viewportScroller=t,this.options=n,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},n.scrollPositionRestoration=n.scrollPositionRestoration||"disabled",n.anchorScrolling=n.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof Bm?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof $m&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof ty&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,t){this.router.triggerEvent(new ty(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(Or(gC),Or(cf),Or(void 0))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();const OC=new or("ROUTER_CONFIGURATION"),TC=new or("ROUTER_FORROOT_GUARD"),IC=[hd,{provide:Sy,useClass:by},{provide:gC,useFactory:function(e,t,n,r,i,s,o,a={},l,c){const u=new gC(null,e,t,n,r,i,s,uy(o));return l&&(u.urlHandlingStrategy=l),c&&(u.routeReuseStrategy=c),function(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy)}(a,u),a.enableTracing&&u.events.subscribe(e=>{var t,n;null===(t=console.group)||void 0===t||t.call(console,`Router Event: ${e.constructor.name}`),console.log(e.toString()),console.log(e),null===(n=console.groupEnd)||void 0===n||n.call(console)}),u},deps:[Sy,lC,hd,zo,Bh,gh,sC,OC,[class{},new Nr],[class{},new Nr]]},lC,{provide:Wy,useFactory:function(e){return e.routerState.root},deps:[gC]},{provide:Bh,useClass:Hh},SC,PC,class{preload(e,t){return t().pipe(Nm(()=>Vg(null)))}},{provide:OC,useValue:{enableTracing:!1}}];function kC(){return new Rh("Router",gC)}let AC=(()=>{class e{constructor(e,t){}static forRoot(t,n){return{ngModule:e,providers:[IC,xC(t),{provide:TC,useFactory:RC,deps:[[gC,new Nr,new Rr]]},{provide:OC,useValue:n||{}},{provide:od,useFactory:NC,deps:[Qh,[new Mr(ld),new Nr],OC]},{provide:bC,useFactory:MC,deps:[gC,cf,OC]},{provide:wC,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:PC},{provide:Rh,multi:!0,useFactory:kC},[DC,{provide:Qu,multi:!0,useFactory:LC,deps:[DC]},{provide:UC,useFactory:FC,deps:[DC]},{provide:ih,multi:!0,useExisting:UC}]]}}static forChild(t){return{ngModule:e,providers:[xC(t)]}}}return e.\u0275fac=function(t){return new(t||e)(Or(TC,8),Or(gC,8))},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({}),e})();function MC(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new bC(e,t,n)}function NC(e,t,n={}){return n.useHash?new ud(e,t):new cd(e,t)}function RC(e){return"guarded"}function xC(e){return[{provide:ar,multi:!0,useValue:e},{provide:sC,multi:!0,useValue:e}]}let DC=(()=>{class e{constructor(e){this.injector=e,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new A}appInitializer(){return this.injector.get(Jh,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let e=null;const t=new Promise(t=>e=t),n=this.injector.get(gC),r=this.injector.get(OC);return"disabled"===r.initialNavigation?(n.setUpLocationChangeListener(),e(!0)):"enabled"===r.initialNavigation||"enabledBlocking"===r.initialNavigation?(n.hooks.afterPreactivation=()=>this.initNavigation?Vg(null):(this.initNavigation=!0,e(!0),this.resultOfPreactivationDone),n.initialNavigation()):e(!0),t})}bootstrapListener(e){const t=this.injector.get(OC),n=this.injector.get(SC),r=this.injector.get(bC),i=this.injector.get(gC),s=this.injector.get(Uh);e===s.components[0]&&(("enabledNonBlocking"===t.initialNavigation||void 0===t.initialNavigation)&&i.initialNavigation(),n.setUpPreloading(),r.init(),i.resetRootComponentType(s.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return e.\u0275fac=function(t){return new(t||e)(Or(zo))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();function LC(e){return e.appInitializer.bind(e)}function FC(e){return e.bootstrapListener.bind(e)}const UC=new or("Router Initializer");class VC{}const BC="*";function $C(e,t=null){return{type:2,steps:e,options:t}}function zC(e){return{type:6,styles:e,offset:null}}function HC(e){Promise.resolve(null).then(e)}class GC{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){HC(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}}class ZC{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,r=0;const i=this.players.length;0==i?HC(()=>this._onFinish()):this.players.forEach(e=>{e.onDone(()=>{++t==i&&this._onFinish()}),e.onDestroy(()=>{++n==i&&this._onDestroy()}),e.onStart(()=>{++r==i&&this._onStart()})}),this.totalTime=this.players.reduce((e,t)=>Math.max(e,t.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(e=>{const n=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(n)})}getPosition(){const e=this.players.reduce((e,t)=>null===e||t.totalTime>e.totalTime?t:e,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}}function qC(){return"undefined"!=typeof window&&void 0!==window.document}function WC(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function jC(e){switch(e.length){case 0:return new GC;case 1:return e[0];default:return new ZC(e)}}function YC(e,t,n,r,i={},s={}){const o=[],a=[];let l=-1,c=null;if(r.forEach(e=>{const n=e.offset,r=n==l,u=r&&c||{};Object.keys(e).forEach(n=>{let r=n,a=e[n];if("offset"!==n)switch(r=t.normalizePropertyName(r,o),a){case"!":a=i[n];break;case BC:a=s[n];break;default:a=t.normalizeStyleValue(n,r,a,o)}u[r]=a}),r||a.push(u),c=u,l=n}),o.length){const e="\n - ";throw new Error(`Unable to animate due to the following errors:${e}${o.join(e)}`)}return a}function KC(e,t,n,r){switch(t){case"start":e.onStart(()=>r(n&&QC(n,"start",e)));break;case"done":e.onDone(()=>r(n&&QC(n,"done",e)));break;case"destroy":e.onDestroy(()=>r(n&&QC(n,"destroy",e)))}}function QC(e,t,n){const r=XC(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,n.totalTime??e.totalTime,!!n.disabled),i=e._data;return null!=i&&(r._data=i),r}function XC(e,t,n,r,i="",s=0,o){return{element:e,triggerName:t,fromState:n,toState:r,phaseName:i,totalTime:s,disabled:!!o}}function JC(e,t,n){let r;return e instanceof Map?(r=e.get(t),r||e.set(t,r=n)):(r=e[t],r||(r=e[t]=n)),r}function e_(e){const t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}let t_=(e,t)=>!1,n_=(e,t)=>!1,r_=(e,t,n)=>[];const i_=WC();(i_||"undefined"!=typeof Element)&&(t_=qC()?(e,t)=>{for(;t&&t!==document.documentElement;){if(t===e)return!0;t=t.parentNode||t.host}return!1}:(e,t)=>e.contains(t),n_=(()=>{if(i_||Element.prototype.matches)return(e,t)=>e.matches(t);{const e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?(e,n)=>t.apply(e,[n]):n_}})(),r_=(e,t,n)=>{let r=[];if(n){const n=e.querySelectorAll(t);for(let e=0;e<n.length;e++)r.push(n[e])}else{const n=e.querySelector(t);n&&r.push(n)}return r});let s_=null,o_=!1;function a_(e){s_||(s_=("undefined"!=typeof document?document.body:null)||{},o_=!!s_.style&&"WebkitAppearance"in s_.style);let t=!0;return s_.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(t=e in s_.style,!t&&o_&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in s_.style)),t}const l_=n_,c_=t_,u_=r_;function h_(e){const t={};return Object.keys(e).forEach(n=>{const r=n.replace(/([a-z])([A-Z])/g,"$1-$2");t[r]=e[n]}),t}let d_=(()=>{class e{validateStyleProperty(e){return a_(e)}matchesElement(e,t){return l_(e,t)}containsElement(e,t){return c_(e,t)}query(e,t,n){return u_(e,t,n)}computeStyle(e,t,n){return n||""}animate(e,t,n,r,i,s=[],o){return new GC(n,r)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})(),f_=(()=>{class e{}return e.NOOP=new d_,e})();const p_="ng-enter",g_="ng-leave",m_="ng-trigger",y_=".ng-trigger",v_="ng-animating",C_=".ng-animating";function __(e){if("number"==typeof e)return e;const t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:E_(parseFloat(t[1]),t[2])}function E_(e,t){return"s"===t?1e3*e:e}function w_(e,t,n){return e.hasOwnProperty("duration")?e:function(e,t,n){let r,i=0,s="";if("string"==typeof e){const n=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===n)return t.push(`The provided timing value "${e}" is invalid.`),{duration:0,delay:0,easing:""};r=E_(parseFloat(n[1]),n[2]);const o=n[3];null!=o&&(i=E_(parseFloat(o),n[4]));const a=n[5];a&&(s=a)}else r=e;if(!n){let n=!1,s=t.length;r<0&&(t.push("Duration values below 0 are not allowed for this animation step."),n=!0),i<0&&(t.push("Delay values below 0 are not allowed for this animation step."),n=!0),n&&t.splice(s,0,`The provided timing value "${e}" is invalid.`)}return{duration:r,delay:i,easing:s}}(e,t,n)}function P_(e,t={}){return Object.keys(e).forEach(n=>{t[n]=e[n]}),t}function S_(e,t,n={}){if(t)for(let r in e)n[r]=e[r];else P_(e,n);return n}function b_(e,t,n){return n?t+":"+n+";":""}function O_(e){let t="";for(let n=0;n<e.style.length;n++){const r=e.style.item(n);t+=b_(0,r,e.style.getPropertyValue(r))}for(const n in e.style)e.style.hasOwnProperty(n)&&!n.startsWith("_")&&(t+=b_(0,L_(n),e.style[n]));e.setAttribute("style",t)}function T_(e,t,n){e.style&&(Object.keys(t).forEach(r=>{const i=D_(r);n&&!n.hasOwnProperty(r)&&(n[r]=e.style[i]),e.style[i]=t[r]}),WC()&&O_(e))}function I_(e,t){e.style&&(Object.keys(t).forEach(t=>{const n=D_(t);e.style[n]=""}),WC()&&O_(e))}function k_(e){return Array.isArray(e)?1==e.length?e[0]:$C(e):e}const A_=new RegExp("{{\\s*(.+?)\\s*}}","g");function M_(e){let t=[];if("string"==typeof e){let n;for(;n=A_.exec(e);)t.push(n[1]);A_.lastIndex=0}return t}function N_(e,t,n){const r=e.toString(),i=r.replace(A_,(e,r)=>{let i=t[r];return t.hasOwnProperty(r)||(n.push(`Please provide a value for the animation param ${r}`),i=""),i.toString()});return i==r?e:i}function R_(e){const t=[];let n=e.next();for(;!n.done;)t.push(n.value),n=e.next();return t}const x_=/-+([a-z0-9])/g;function D_(e){return e.replace(x_,(...e)=>e[1].toUpperCase())}function L_(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function F_(e,t){return 0===e||0===t}function U_(e,t,n){const r=Object.keys(n);if(r.length&&t.length){let s=t[0],o=[];if(r.forEach(e=>{s.hasOwnProperty(e)||o.push(e),s[e]=n[e]}),o.length)for(var i=1;i<t.length;i++){let n=t[i];o.forEach(function(t){n[t]=B_(e,t)})}}return t}function V_(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw new Error(`Unable to resolve animation metadata node #${t.type}`)}}function B_(e,t){return window.getComputedStyle(e)[t]}function $_(e,t){const n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(e=>function(e,t,n){if(":"==e[0]){const r=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,t)=>parseFloat(t)>parseFloat(e);case":decrement":return(e,t)=>parseFloat(t)<parseFloat(e);default:return t.push(`The transition alias value "${e}" is not supported`),"* => *"}}(e,n);if("function"==typeof r)return void t.push(r);e=r}const r=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return n.push(`The provided transition expression "${e}" is not supported`),t;const i=r[1],s=r[2],o=r[3];t.push(G_(i,o));"<"==s[0]&&!("*"==i&&"*"==o)&&t.push(G_(o,i))}(e,n,t)):n.push(e),n}const z_=new Set(["true","1"]),H_=new Set(["false","0"]);function G_(e,t){const n=z_.has(e)||H_.has(e),r=z_.has(t)||H_.has(t);return(i,s)=>{let o="*"==e||e==i,a="*"==t||t==s;return!o&&n&&"boolean"==typeof i&&(o=i?z_.has(e):H_.has(e)),!a&&r&&"boolean"==typeof s&&(a=s?z_.has(t):H_.has(t)),o&&a}}const Z_=new RegExp("s*:selfs*,?","g");function q_(e,t,n){return new W_(e).build(t,n)}class W_{constructor(e){this._driver=e}build(e,t){const n=new j_(t);return this._resetContextStyleTimingState(n),V_(this,k_(e),n)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,r=t.depCount=0;const i=[],s=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(e=>{if(this._resetContextStyleTimingState(t),0==e.type){const n=e,r=n.name;r.toString().split(/\s*,\s*/).forEach(e=>{n.name=e,i.push(this.visitState(n,t))}),n.name=r}else if(1==e.type){const i=this.visitTransition(e,t);n+=i.queryCount,r+=i.depCount,s.push(i)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:i,transitions:s,queryCount:n,depCount:r,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){const i=new Set,s=r||{};if(n.styles.forEach(e=>{if(Y_(e)){const t=e;Object.keys(t).forEach(e=>{M_(t[e]).forEach(e=>{s.hasOwnProperty(e)||i.add(e)})})}}),i.size){const n=R_(i.values());t.errors.push(`state("${e.name}", ...) must define default values for all the following style substitutions: ${n.join(", ")}`)}}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=V_(this,k_(e.animation),t);return{type:1,matchers:$_(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:K_(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(e=>V_(this,e,t)),options:K_(e.options)}}visitGroup(e,t){const n=t.currentTime;let r=0;const i=e.steps.map(e=>{t.currentTime=n;const i=V_(this,e,t);return r=Math.max(r,t.currentTime),i});return t.currentTime=r,{type:3,steps:i,options:K_(e.options)}}visitAnimate(e,t){const n=function(e,t){let n=null;if(e.hasOwnProperty("duration"))n=e;else if("number"==typeof e)return Q_(w_(e,t).duration,0,"");const r=e;if(r.split(/\s+/).some(e=>"{"==e.charAt(0)&&"{"==e.charAt(1))){const e=Q_(0,0,"");return e.dynamic=!0,e.strValue=r,e}return n=n||w_(r,t),Q_(n.duration,n.delay,n.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let r,i=e.styles?e.styles:zC({});if(5==i.type)r=this.visitKeyframes(i,t);else{let i=e.styles,s=!1;if(!i){s=!0;const e={};n.easing&&(e.easing=n.easing),i=zC(e)}t.currentTime+=n.duration+n.delay;const o=this.visitStyle(i,t);o.isEmptyStep=s,r=o}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[];Array.isArray(e.styles)?e.styles.forEach(e=>{"string"==typeof e?e==BC?n.push(e):t.errors.push(`The provided style string value ${e} is not allowed.`):n.push(e)}):n.push(e.styles);let r=!1,i=null;return n.forEach(e=>{if(Y_(e)){const t=e,n=t.easing;if(n&&(i=n,delete t.easing),!r)for(let e in t)if(t[e].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:e.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let r=t.currentTime,i=t.currentTime;n&&i>0&&(i-=n.duration+n.delay),e.styles.forEach(e=>{"string"!=typeof e&&Object.keys(e).forEach(n=>{if(!this._driver.validateStyleProperty(n))return void t.errors.push(`The provided animation property "${n}" is not a supported CSS property for animations`);const s=t.collectedStyles[t.currentQuerySelector],o=s[n];let a=!0;o&&(i!=r&&i>=o.startTime&&r<=o.endTime&&(t.errors.push(`The CSS property "${n}" that exists between the times of "${o.startTime}ms" and "${o.endTime}ms" is also being animated in a parallel animation between the times of "${i}ms" and "${r}ms"`),a=!1),i=o.startTime),a&&(s[n]={startTime:i,endTime:r}),t.options&&function(e,t,n){const r=t.params||{},i=M_(e);i.length&&i.forEach(e=>{r.hasOwnProperty(e)||n.push(`Unable to resolve the local animation param ${e} in the given list of values`)})}(e[n],t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),n;let r=0;const i=[];let s=!1,o=!1,a=0;const l=e.steps.map(e=>{const n=this._makeStyleAst(e,t);let l=null!=n.offset?n.offset:function(e){if("string"==typeof e)return null;let t=null;if(Array.isArray(e))e.forEach(e=>{if(Y_(e)&&e.hasOwnProperty("offset")){const n=e;t=parseFloat(n.offset),delete n.offset}});else if(Y_(e)&&e.hasOwnProperty("offset")){const n=e;t=parseFloat(n.offset),delete n.offset}return t}(n.styles),c=0;return null!=l&&(r++,c=n.offset=l),o=o||c<0||c>1,s=s||c<a,a=c,i.push(c),n});o&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),s&&t.errors.push("Please ensure that all keyframe offsets are in order");const c=e.steps.length;let u=0;r>0&&r<c?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==r&&(u=1/(c-1));const h=c-1,d=t.currentTime,f=t.currentAnimateTimings,p=f.duration;return l.forEach((e,r)=>{const s=u>0?r==h?1:u*r:i[r],o=s*p;t.currentTime=d+f.delay+o,f.duration=o,this._validateStyleAst(e,t),e.offset=s,n.styles.push(e)}),n}visitReference(e,t){return{type:8,animation:V_(this,k_(e.animation),t),options:K_(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:K_(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:K_(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[i,s]=function(e){const t=!!e.split(/\s*,\s*/).find(e=>":self"==e);return t&&(e=e.replace(Z_,"")),e=e.replace(/@\*/g,y_).replace(/@\w+/g,e=>y_+"-"+e.substr(1)).replace(/:animating/g,C_),[e,t]}(e.selector);t.currentQuerySelector=n.length?n+" "+i:i,JC(t.collectedStyles,t.currentQuerySelector,{});const o=V_(this,k_(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:i,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:o,originalSelector:e.selector,options:K_(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:w_(e.timings,t.errors,!0);return{type:12,animation:V_(this,k_(e.animation),t),timings:n,options:null}}}class j_{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function Y_(e){return!Array.isArray(e)&&"object"==typeof e}function K_(e){return e?(e=P_(e)).params&&(e.params=function(e){return e?P_(e):null}(e.params)):e={},e}function Q_(e,t,n){return{duration:e,delay:t,easing:n}}function X_(e,t,n,r,i,s,o=null,a=!1){return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:r,duration:i,delay:s,totalTime:i+s,easing:o,subTimeline:a}}class J_{constructor(){this._map=new Map}consume(e){let t=this._map.get(e);return t?this._map.delete(e):t=[],t}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const eE=new RegExp(":enter","g"),tE=new RegExp(":leave","g");function nE(e,t,n,r,i,s={},o={},a,l,c=[]){return(new rE).buildKeyframes(e,t,n,r,i,s,o,a,l,c)}class rE{buildKeyframes(e,t,n,r,i,s,o,a,l,c=[]){l=l||new J_;const u=new sE(e,t,l,r,i,c,[]);u.options=a,u.currentTimeline.setStyles([s],null,u.errors,a),V_(this,n,u);const h=u.timelines.filter(e=>e.containsAnimation());if(h.length&&Object.keys(o).length){const e=h[h.length-1];e.allowOnlyTimelineStyles()||e.setStyles([o],null,u.errors,a)}return h.length?h.map(e=>e.buildKeyframes()):[X_(t,[],[],[],0,0,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.consume(t.element);if(n){const r=t.createSubContext(e.options),i=t.currentTimeline.currentTime,s=this._visitSubInstructions(n,r,r.options);i!=s&&t.transformIntoNewTimeline(s)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_visitSubInstructions(e,t,n){let r=t.currentTimeline.currentTime;const i=null!=n.duration?__(n.duration):null,s=null!=n.delay?__(n.delay):null;return 0!==i&&e.forEach(e=>{const n=t.appendInstructionToTimeline(e,i,s);r=Math.max(r,n.duration+n.delay)}),r}visitReference(e,t){t.updateOptions(e.options,!0),V_(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let r=t;const i=e.options;if(i&&(i.params||i.delay)&&(r=t.createSubContext(i),r.transformIntoNewTimeline(),null!=i.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=iE);const e=__(i.delay);r.delayNextStep(e)}e.steps.length&&(e.steps.forEach(e=>V_(this,e,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let r=t.currentTimeline.currentTime;const i=e.options&&e.options.delay?__(e.options.delay):0;e.steps.forEach(s=>{const o=t.createSubContext(e.options);i&&o.delayNextStep(i),V_(this,s,o),r=Math.max(r,o.currentTimeline.currentTime),n.push(o.currentTimeline)}),n.forEach(e=>t.currentTimeline.mergeTimelineCollectedStyles(e)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return w_(t.params?N_(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());const i=e.style;5==i.type?this.visitKeyframes(i,t):(t.incrementTime(n.duration),this.visitStyle(i,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();const i=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(i):n.setStyles(e.styles,i,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,r=t.currentTimeline.duration,i=n.duration,s=t.createSubContext().currentTimeline;s.easing=n.easing,e.styles.forEach(e=>{s.forwardTime((e.offset||0)*i),s.setStyles(e.styles,e.easing,t.errors,t.options),s.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(s),t.transformIntoNewTimeline(r+i),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,r=e.options||{},i=r.delay?__(r.delay):0;i&&(6===t.previousNode.type||0==n&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=iE);let s=n;const o=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=o.length;let a=null;o.forEach((n,r)=>{t.currentQueryIndex=r;const o=t.createSubContext(e.options,n);i&&o.delayNextStep(i),n===t.element&&(a=o.currentTimeline),V_(this,e.animation,o),o.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,o.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(s),a&&(t.currentTimeline.mergeTimelineCollectedStyles(a),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,r=t.currentTimeline,i=e.timings,s=Math.abs(i.duration),o=s*(t.currentQueryTotal-1);let a=s*t.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":a=o-a;break;case"full":a=n.currentStaggerTime}const l=t.currentTimeline;a&&l.delayNextStep(a);const c=l.currentTime;V_(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-c+(r.startTime-n.currentTimeline.startTime)}}const iE={};class sE{constructor(e,t,n,r,i,s,o,a){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=i,this.errors=s,this.timelines=o,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=iE,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=a||new oE(this._driver,t,0),o.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let r=this.options;null!=n.duration&&(r.duration=__(n.duration)),null!=n.delay&&(r.delay=__(n.delay));const i=n.params;if(i){let e=r.params;e||(e=this.options.params={}),Object.keys(i).forEach(n=>{(!t||!e.hasOwnProperty(n))&&(e[n]=N_(i[n],e,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(e=>{n[e]=t[e]})}}return e}createSubContext(e=null,t,n){const r=t||this.element,i=new sE(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(e),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(e){return this.previousNode=iE,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(n??0)+e.delay,easing:""},i=new aE(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(i),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,r,i,s){let o=[];if(r&&o.push(this.element),e.length>0){e=(e=e.replace(eE,"."+this._enterClassName)).replace(tE,"."+this._leaveClassName);let t=this._driver.query(this.element,e,1!=n);0!==n&&(t=n<0?t.slice(t.length+n,t.length):t.slice(0,n)),o.push(...t)}return!i&&0==o.length&&s.push(`\`query("${t}")\` returned zero elements. (Use \`query("${t}", { optional: true })\` if you wish to allow this.)`),o}}class oE{constructor(e,t,n,r){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new oE(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(e=>{this._backFill[e]=this._globalTimelineStyles[e]||BC,this._currentKeyframe[e]=BC}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,r){t&&(this._previousKeyframe.easing=t);const i=r&&r.params||{},s=function(e,t){const n={};let r;return e.forEach(e=>{"*"===e?(r=r||Object.keys(t),r.forEach(e=>{n[e]=BC})):S_(e,!1,n)}),n}(e,this._globalTimelineStyles);Object.keys(s).forEach(e=>{const t=N_(s[e],i,n);this._pendingStyles[e]=t,this._localTimelineStyles.hasOwnProperty(e)||(this._backFill[e]=this._globalTimelineStyles.hasOwnProperty(e)?this._globalTimelineStyles[e]:BC),this._updateStyle(e,t)})}applyStylesToKeyframe(){const e=this._pendingStyles,t=Object.keys(e);0!=t.length&&(this._pendingStyles={},t.forEach(t=>{this._currentKeyframe[t]=e[t]}),Object.keys(this._localTimelineStyles).forEach(e=>{this._currentKeyframe.hasOwnProperty(e)||(this._currentKeyframe[e]=this._localTimelineStyles[e])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(e=>{const t=this._localTimelineStyles[e];this._pendingStyles[e]=t,this._updateStyle(e,t)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){Object.keys(e._styleSummary).forEach(t=>{const n=this._styleSummary[t],r=e._styleSummary[t];(!n||r.time>n.time)&&this._updateStyle(t,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((i,s)=>{const o=S_(i,!0);Object.keys(o).forEach(n=>{const r=o[n];"!"==r?e.add(n):r==BC&&t.add(n)}),n||(o.offset=s/this.duration),r.push(o)});const i=e.size?R_(e.values()):[],s=t.size?R_(t.values()):[];if(n){const e=r[0],t=P_(e);e.offset=0,t.offset=1,r=[e,t]}return X_(this.element,r,i,s,this.duration,this.startTime,this.easing,!1)}}class aE extends oE{constructor(e,t,n,r,i,s,o=!1){super(e,t,s.delay),this.keyframes=n,this.preStyleProps=r,this.postStyleProps=i,this._stretchStartingKeyframe=o,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const i=[],s=n+t,o=t/s,a=S_(e[0],!1);a.offset=0,i.push(a);const l=S_(e[0],!1);l.offset=lE(o),i.push(l);const c=e.length-1;for(let r=1;r<=c;r++){let o=S_(e[r],!1);o.offset=lE((t+o.offset*n)/s),i.push(o)}n=s,t=0,r="",e=i}return X_(this.element,e,this.preStyleProps,this.postStyleProps,n,t,r,!0)}}function lE(e,t=3){const n=Math.pow(10,t-1);return Math.round(e*n)/n}class cE{}class uE extends cE{normalizePropertyName(e,t){return D_(e)}normalizeStyleValue(e,t,n,r){let i="";const s=n.toString().trim();if(hE[t]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{const t=n.match(/^[+-]?[\d\.]+([a-z]*)$/);t&&0==t[1].length&&r.push(`Please provide a CSS unit value for ${e}:${n}`)}return s+i}}const hE=(()=>function(e){const t={};return e.forEach(e=>t[e]=!0),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function dE(e,t,n,r,i,s,o,a,l,c,u,h,d){return{type:0,element:e,triggerName:t,isRemovalTransition:i,fromState:n,fromStyles:s,toState:r,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:h,errors:d}}const fE={};class pE{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,r){return function(e,t,n,r,i){return e.some(e=>e(t,n,r,i))}(this.ast.matchers,e,t,n,r)}buildStyles(e,t,n){const r=this._stateStyles["*"],i=this._stateStyles[e],s=r?r.buildStyles(t,n):{};return i?i.buildStyles(t,n):s}build(e,t,n,r,i,s,o,a,l,c){const u=[],h=this.ast.options&&this.ast.options.params||fE,d=this.buildStyles(n,o&&o.params||fE,u),f=a&&a.params||fE,p=this.buildStyles(r,f,u),g=new Set,m=new Map,y=new Map,v="void"===r,C={params:Object.assign(Object.assign({},h),f)},_=c?[]:nE(e,t,this.ast.animation,i,s,d,p,C,l,u);let E=0;if(_.forEach(e=>{E=Math.max(e.duration+e.delay,E)}),u.length)return dE(t,this._triggerName,n,r,v,d,p,[],[],m,y,E,u);_.forEach(e=>{const n=e.element,r=JC(m,n,{});e.preStyleProps.forEach(e=>r[e]=!0);const i=JC(y,n,{});e.postStyleProps.forEach(e=>i[e]=!0),n!==t&&g.add(n)});const w=R_(g.values());return dE(t,this._triggerName,n,r,v,d,p,_,w,m,y,E)}}class gE{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n={},r=P_(this.defaultParams);return Object.keys(e).forEach(t=>{const n=e[t];null!=n&&(r[t]=n)}),this.styles.styles.forEach(e=>{if("string"!=typeof e){const i=e;Object.keys(i).forEach(e=>{let s=i[e];s.length>1&&(s=N_(s,r,t));const o=this.normalizer.normalizePropertyName(e,t);s=this.normalizer.normalizeStyleValue(e,o,s,t),n[o]=s})}}),n}}class mE{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states={},t.states.forEach(e=>{this.states[e.name]=new gE(e.style,e.options&&e.options.params||{},n)}),yE(this.states,"true","1"),yE(this.states,"false","0"),t.transitions.forEach(t=>{this.transitionFactories.push(new pE(e,t,this.states))}),this.fallbackTransition=function(e,t,n){return new pE(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[(e,t)=>!0],options:null,queryCount:0,depCount:0},t)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,r){return this.transitionFactories.find(i=>i.match(e,t,n,r))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function yE(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}const vE=new J_;class CE{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(e,t){const n=[],r=q_(this._driver,t,n);if(n.length)throw new Error(`Unable to build the animation due to the following errors: ${n.join("\n")}`);this._animations[e]=r}_buildPlayer(e,t,n){const r=e.element,i=YC(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,i,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const r=[],i=this._animations[e];let s;const o=new Map;if(i?(s=nE(this._driver,t,i,p_,g_,{},{},n,vE,r),s.forEach(e=>{const t=JC(o,e.element,{});e.postStyleProps.forEach(e=>t[e]=null)})):(r.push("The requested animation doesn't exist or has already been destroyed"),s=[]),r.length)throw new Error(`Unable to create the animation due to the following errors: ${r.join("\n")}`);o.forEach((e,t)=>{Object.keys(e).forEach(n=>{e[n]=this._driver.computeStyle(t,n,BC)})});const a=jC(s.map(e=>{const t=o.get(e.element);return this._buildPlayer(e,{},t)}));return this._playersById[e]=a,a.onDestroy(()=>this.destroy(e)),this.players.push(a),a}destroy(e){const t=this._getPlayer(e);t.destroy(),delete this._playersById[e];const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById[e];if(!t)throw new Error(`Unable to find the timeline player referenced by ${e}`);return t}listen(e,t,n,r){const i=XC(t,"","","");return KC(this._getPlayer(e),n,i,r),()=>{}}command(e,t,n,r){if("register"==n)return void this.register(e,r[0]);if("create"==n)return void this.create(e,t,r[0]||{});const i=this._getPlayer(e);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const _E="ng-animate-queued",EE="ng-animate-disabled",wE=".ng-animate-disabled",PE=[],SE={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},bE={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},OE="__ng_removed";class TE{constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=(n?e.value:e)??null,n){const t=P_(e);delete t.value,this.options=t}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const e=this.options.params;Object.keys(t).forEach(n=>{null==e[n]&&(e[n]=t[n])})}}}const IE="void",kE=new TE(IE);class AE{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,UE(t,this._hostClassName)}listen(e,t,n,r){if(!this._triggers.hasOwnProperty(t))throw new Error(`Unable to listen on the animation trigger event "${n}" because the animation trigger "${t}" doesn't exist!`);if(null==n||0==n.length)throw new Error(`Unable to listen on the animation trigger "${t}" because the provided event is undefined!`);if("start"!=(i=n)&&"done"!=i)throw new Error(`The provided animation trigger event "${n}" for the animation trigger "${t}" is not supported!`);var i;const s=JC(this._elementListeners,e,[]),o={name:t,phase:n,callback:r};s.push(o);const a=JC(this._engine.statesByElement,e,{});return a.hasOwnProperty(t)||(UE(e,m_),UE(e,m_+"-"+t),a[t]=kE),()=>{this._engine.afterFlush(()=>{const e=s.indexOf(o);e>=0&&s.splice(e,1),this._triggers[t]||delete a[t]})}}register(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}_getTrigger(e){const t=this._triggers[e];if(!t)throw new Error(`The provided animation trigger "${e}" has not been registered!`);return t}trigger(e,t,n,r=!0){const i=this._getTrigger(t),s=new NE(this.id,t,e);let o=this._engine.statesByElement.get(e);o||(UE(e,m_),UE(e,m_+"-"+t),this._engine.statesByElement.set(e,o={}));let a=o[t];const l=new TE(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&a&&l.absorbOptions(a.options),o[t]=l,a||(a=kE),l.value!==IE&&a.value===l.value){if(!function(e,t){const n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(let i=0;i<n.length;i++){const r=n[i];if(!t.hasOwnProperty(r)||e[r]!==t[r])return!1}return!0}(a.params,l.params)){const t=[],n=i.matchStyles(a.value,a.params,t),r=i.matchStyles(l.value,l.params,t);t.length?this._engine.reportError(t):this._engine.afterFlush(()=>{I_(e,n),T_(e,r)})}return}const c=JC(this._engine.playersByElement,e,[]);c.forEach(e=>{e.namespaceId==this.id&&e.triggerName==t&&e.queued&&e.destroy()});let u=i.matchTransition(a.value,l.value,e,l.params),h=!1;if(!u){if(!r)return;u=i.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:u,fromState:a,toState:l,player:s,isFallbackTransition:h}),h||(UE(e,_E),s.onStart(()=>{VE(e,_E)})),s.onDone(()=>{let t=this.players.indexOf(s);t>=0&&this.players.splice(t,1);const n=this._engine.playersByElement.get(e);if(n){let e=n.indexOf(s);e>=0&&n.splice(e,1)}}),this.players.push(s),c.push(s),s}deregister(e){delete this._triggers[e],this._engine.statesByElement.forEach((t,n)=>{delete t[e]}),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(t=>t.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(e=>e.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,y_,!0);n.forEach(e=>{if(e[OE])return;const n=this._engine.fetchNamespacesByElement(e);n.size?n.forEach(n=>n.triggerLeaveAnimation(e,t,!1,!0)):this.clearElementCache(e)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(e=>this.clearElementCache(e)))}triggerLeaveAnimation(e,t,n,r){const i=this._engine.statesByElement.get(e);if(i){const s=[];if(Object.keys(i).forEach(t=>{if(this._triggers[t]){const n=this.trigger(e,t,IE,r);n&&s.push(n)}}),s.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),n&&jC(s).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const r=new Set;t.forEach(t=>{const i=t.name;if(r.has(i))return;r.add(i);const s=this._triggers[i].fallbackTransition,o=n[i]||kE,a=new TE(IE),l=new NE(this.id,i,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:i,transition:s,fromState:o,toState:a,player:l,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(n.totalAnimations){const t=n.players.length?n.playersByQueriedElement.get(e):[];if(t&&t.length)r=!0;else{let t=e;for(;t=t.parentNode;)if(n.statesByElement.get(t)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)n.markElementAsRemoved(this.id,e,!1,t);else{const r=e[OE];(!r||r===SE)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){UE(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const i=n.element,s=this._elementListeners.get(i);s&&s.forEach(t=>{if(t.name==n.triggerName){const r=XC(i,n.triggerName,n.fromState.value,n.toState.value);r._data=e,KC(n.player,t.phase,r,t.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(n)}),this._queue=[],t.sort((e,t)=>{const n=e.transition.ast.depCount,r=t.transition.ast.depCount;return 0==n||0==r?n-r:this._engine.driver.containsElement(e.element,t.element)?1:-1})}destroy(e){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(t=>t.element===e)||t,t}}class ME{constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(e,t)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(t=>{t.queued&&e.push(t)})}),e}createNamespace(e,t){const n=new AE(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList.length-1;if(n>=0){let r=!1;for(let i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,t)){this._namespaceList.splice(i+1,0,e),r=!0;break}r||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}destroy(e,t){if(!e)return;const n=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[e];const t=this._namespaceList.indexOf(n);t>=0&&this._namespaceList.splice(t,1)}),this.afterFlushAnimationsDone(()=>n.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n){const e=Object.keys(n);for(let r=0;r<e.length;r++){const i=n[e[r]].namespaceId;if(i){const e=this._fetchNamespace(i);e&&t.add(e)}}}return t}trigger(e,t,n,r){if(RE(t)){const i=this._fetchNamespace(e);if(i)return i.trigger(t,n,r),!0}return!1}insertNode(e,t,n,r){if(!RE(t))return;const i=t[OE];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;const e=this.collectedLeaveElements.indexOf(t);e>=0&&this.collectedLeaveElements.splice(e,1)}if(e){const r=this._fetchNamespace(e);r&&r.insertNode(t,n)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),UE(e,EE)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),VE(e,EE))}removeNode(e,t,n,r){if(RE(t)){const i=e?this._fetchNamespace(e):null;if(i?i.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){const n=this.namespacesByHostElement.get(t);n&&n.id!==e&&n.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,n,r){this.collectedLeaveElements.push(t),t[OE]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}listen(e,t,n,r,i){return RE(t)?this._fetchNamespace(e).listen(t,n,r,i):()=>{}}_buildInstruction(e,t,n,r,i){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,i)}destroyInnerAnimations(e){let t=this.driver.query(e,y_,!0);t.forEach(e=>this.destroyActiveAnimationsForElement(e)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,C_,!0),t.forEach(e=>this.finishActiveQueriedAnimationOnElement(e)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(e=>{e.queued?e.markedForDestroy=!0:e.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(e=>e.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return jC(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[OE];if(t&&t.setForRemoval){if(e[OE]=SE,t.namespaceId){this.destroyInnerAnimations(e);const n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}this.driver.matchesElement(e,wE)&&this.markElementAsDisabled(e,!1),this.driver.query(e,wE,!0).forEach(e=>{this.markElementAsDisabled(e,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((e,t)=>this._balanceNamespaceList(e,t)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)UE(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let e=0;e<n.length;e++)n[e]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(e=>e()),this._flushFns=[],this._whenQuietFns.length){const e=this._whenQuietFns;this._whenQuietFns=[],t.length?jC(t).onDone(()=>{e.forEach(e=>e())}):e.forEach(e=>e())}}reportError(e){throw new Error(`Unable to process animations due to the following failed trigger transitions\n ${e.join("\n")}`)}_flushAnimations(e,t){const n=new J_,r=[],i=new Map,s=[],o=new Map,a=new Map,l=new Map,c=new Set;this.disabledNodes.forEach(e=>{c.add(e);const t=this.driver.query(e,".ng-animate-queued",!0);for(let n=0;n<t.length;n++)c.add(t[n])});const u=this.bodyNode,h=Array.from(this.statesByElement.keys()),d=LE(h,this.collectedEnterElements),f=new Map;let p=0;d.forEach((e,t)=>{const n=p_+p++;f.set(t,n),e.forEach(e=>UE(e,n))});const g=[],m=new Set,y=new Set;for(let A=0;A<this.collectedLeaveElements.length;A++){const e=this.collectedLeaveElements[A],t=e[OE];t&&t.setForRemoval&&(g.push(e),m.add(e),t.hasAnimation?this.driver.query(e,".ng-star-inserted",!0).forEach(e=>m.add(e)):y.add(e))}const v=new Map,C=LE(h,Array.from(m));C.forEach((e,t)=>{const n=g_+p++;v.set(t,n),e.forEach(e=>UE(e,n))}),e.push(()=>{d.forEach((e,t)=>{const n=f.get(t);e.forEach(e=>VE(e,n))}),C.forEach((e,t)=>{const n=v.get(t);e.forEach(e=>VE(e,n))}),g.forEach(e=>{this.processLeaveNode(e)})});const _=[],E=[];for(let A=this._namespaceList.length-1;A>=0;A--)this._namespaceList[A].drainQueuedTransitions(t).forEach(e=>{const t=e.player,i=e.element;if(_.push(t),this.collectedEnterElements.length){const e=i[OE];if(e&&e.setForMove)return void t.destroy()}const c=!u||!this.driver.containsElement(u,i),h=v.get(i),d=f.get(i),p=this._buildInstruction(e,n,d,h,c);if(p.errors&&p.errors.length)E.push(p);else{if(c)return t.onStart(()=>I_(i,p.fromStyles)),t.onDestroy(()=>T_(i,p.toStyles)),void r.push(t);if(e.isFallbackTransition)return t.onStart(()=>I_(i,p.fromStyles)),t.onDestroy(()=>T_(i,p.toStyles)),void r.push(t);p.timelines.forEach(e=>e.stretchStartingKeyframe=!0),n.append(i,p.timelines),s.push({instruction:p,player:t,element:i}),p.queriedElements.forEach(e=>JC(o,e,[]).push(t)),p.preStyleProps.forEach((e,t)=>{const n=Object.keys(e);if(n.length){let e=a.get(t);e||a.set(t,e=new Set),n.forEach(t=>e.add(t))}}),p.postStyleProps.forEach((e,t)=>{const n=Object.keys(e);let r=l.get(t);r||l.set(t,r=new Set),n.forEach(e=>r.add(e))})}});if(E.length){const e=[];E.forEach(t=>{e.push(`@${t.triggerName} has failed due to:\n`),t.errors.forEach(t=>e.push(`- ${t}\n`))}),_.forEach(e=>e.destroy()),this.reportError(e)}const w=new Map,P=new Map;s.forEach(e=>{const t=e.element;n.has(t)&&(P.set(t,t),this._beforeAnimationBuild(e.player.namespaceId,e.instruction,w))}),r.forEach(e=>{const t=e.element;this._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach(e=>{JC(w,t,[]).push(e),e.destroy()})});const S=g.filter(e=>zE(e,a,l)),b=new Map;DE(b,this.driver,y,l,BC).forEach(e=>{zE(e,a,l)&&S.push(e)});const O=new Map;d.forEach((e,t)=>{DE(O,this.driver,new Set(e),a,"!")}),S.forEach(e=>{const t=b.get(e),n=O.get(e);b.set(e,Object.assign(Object.assign({},t),n))});const T=[],I=[],k={};s.forEach(e=>{const{element:t,player:s,instruction:o}=e;if(n.has(t)){if(c.has(t))return s.onDestroy(()=>T_(t,o.toStyles)),s.disabled=!0,s.overrideTotalTime(o.totalTime),void r.push(s);let e=k;if(P.size>1){let n=t;const r=[];for(;n=n.parentNode;){const t=P.get(n);if(t){e=t;break}r.push(n)}r.forEach(t=>P.set(t,e))}const n=this._buildAnimation(s.namespaceId,o,w,i,O,b);if(s.setRealPlayer(n),e===k)T.push(s);else{const t=this.playersByElement.get(e);t&&t.length&&(s.parentPlayer=jC(t)),r.push(s)}}else I_(t,o.fromStyles),s.onDestroy(()=>T_(t,o.toStyles)),I.push(s),c.has(t)&&r.push(s)}),I.forEach(e=>{const t=i.get(e.element);if(t&&t.length){const n=jC(t);e.setRealPlayer(n)}}),r.forEach(e=>{e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()});for(let A=0;A<g.length;A++){const e=g[A],t=e[OE];if(VE(e,g_),t&&t.hasAnimation)continue;let n=[];if(o.size){let t=o.get(e);t&&t.length&&n.push(...t);let r=this.driver.query(e,C_,!0);for(let e=0;e<r.length;e++){let t=o.get(r[e]);t&&t.length&&n.push(...t)}}const r=n.filter(e=>!e.destroyed);r.length?BE(this,e,r):this.processLeaveNode(e)}return g.length=0,T.forEach(e=>{this.players.push(e),e.onDone(()=>{e.destroy();const t=this.players.indexOf(e);this.players.splice(t,1)}),e.play()}),T}elementContainsData(e,t){let n=!1;const r=t[OE];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,r,i){let s=[];if(t){const t=this.playersByQueriedElement.get(e);t&&(s=t)}else{const t=this.playersByElement.get(e);if(t){const e=!i||i==IE;t.forEach(t=>{t.queued||!e&&t.triggerName!=r||s.push(t)})}}return(n||r)&&(s=s.filter(e=>!(n&&n!=e.namespaceId||r&&r!=e.triggerName))),s}_beforeAnimationBuild(e,t,n){const r=t.element,i=t.isRemovalTransition?void 0:e,s=t.isRemovalTransition?void 0:t.triggerName;for(const o of t.timelines){const e=o.element,a=e!==r,l=JC(n,e,[]);this._getPreviousPlayers(e,a,i,s,t.toState).forEach(e=>{const t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),l.push(e)})}I_(r,t.fromStyles)}_buildAnimation(e,t,n,r,i,s){const o=t.triggerName,a=t.element,l=[],c=new Set,u=new Set,h=t.timelines.map(t=>{const h=t.element;c.add(h);const d=h[OE];if(d&&d.removedBeforeQueried)return new GC(t.duration,t.delay);const f=h!==a,p=function(e){const t=[];return $E(e,t),t}((n.get(h)||PE).map(e=>e.getRealPlayer())).filter(e=>!!e.element&&e.element===h),g=i.get(h),m=s.get(h),y=YC(0,this._normalizer,0,t.keyframes,g,m),v=this._buildPlayer(t,y,p);if(t.subTimeline&&r&&u.add(h),f){const t=new NE(e,o,h);t.setRealPlayer(v),l.push(t)}return v});l.forEach(e=>{JC(this.playersByQueriedElement,e.element,[]).push(e),e.onDone(()=>function(e,t,n){let r;if(e instanceof Map){if(r=e.get(t),r){if(r.length){const e=r.indexOf(n);r.splice(e,1)}0==r.length&&e.delete(t)}}else if(r=e[t],r){if(r.length){const e=r.indexOf(n);r.splice(e,1)}0==r.length&&delete e[t]}return r}(this.playersByQueriedElement,e.element,e))}),c.forEach(e=>UE(e,v_));const d=jC(h);return d.onDestroy(()=>{c.forEach(e=>VE(e,v_)),T_(a,t.toStyles)}),u.forEach(e=>{JC(r,e,[]).push(d)}),d}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new GC(e.duration,e.delay)}}class NE{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new GC,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(t=>{this._queuedCallbacks[t].forEach(n=>KC(e,t,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){JC(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function RE(e){return e&&1===e.nodeType}function xE(e,t){const n=e.style.display;return e.style.display=t??"none",n}function DE(e,t,n,r,i){const s=[];n.forEach(e=>s.push(xE(e)));const o=[];r.forEach((n,r)=>{const s={};n.forEach(e=>{const n=s[e]=t.computeStyle(r,e,i);(!n||0==n.length)&&(r[OE]=bE,o.push(r))}),e.set(r,s)});let a=0;return n.forEach(e=>xE(e,s[a++])),o}function LE(e,t){const n=new Map;if(e.forEach(e=>n.set(e,[])),0==t.length)return n;const r=new Set(t),i=new Map;function s(e){if(!e)return 1;let t=i.get(e);if(t)return t;const o=e.parentNode;return t=n.has(o)?o:r.has(o)?1:s(o),i.set(e,t),t}return t.forEach(e=>{const t=s(e);1!==t&&n.get(t).push(e)}),n}const FE="$$classes";function UE(e,t){if(e.classList)e.classList.add(t);else{let n=e[FE];n||(n=e[FE]={}),n[t]=!0}}function VE(e,t){if(e.classList)e.classList.remove(t);else{let n=e[FE];n&&delete n[t]}}function BE(e,t,n){jC(n).onDone(()=>e.processLeaveNode(t))}function $E(e,t){for(let n=0;n<e.length;n++){const r=e[n];r instanceof ZC?$E(r.players,t):t.push(r)}}function zE(e,t,n){const r=n.get(e);if(!r)return!1;let i=t.get(e);return i?r.forEach(e=>i.add(e)):t.set(e,r),n.delete(e),!0}class HE{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(e,t)=>{},this._transitionEngine=new ME(e,t,n),this._timelineEngine=new CE(e,t,n),this._transitionEngine.onRemovalComplete=(e,t)=>this.onRemovalComplete(e,t)}registerTrigger(e,t,n,r,i){const s=e+"-"+r;let o=this._triggerCache[s];if(!o){const e=[],t=q_(this._driver,i,e);if(e.length)throw new Error(`The animation trigger "${r}" has failed to build due to the following errors:\n - ${e.join("\n - ")}`);o=function(e,t,n){return new mE(e,t,n)}(r,t,this._normalizer),this._triggerCache[s]=o}this._transitionEngine.registerTrigger(t,r,o)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}onRemove(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,r){if("@"==n.charAt(0)){const[e,i]=e_(n);this._timelineEngine.command(e,t,i,r)}else this._transitionEngine.trigger(e,t,n,r)}listen(e,t,n,r,i){if("@"==n.charAt(0)){const[e,r]=e_(n);return this._timelineEngine.listen(e,t,r,i)}return this._transitionEngine.listen(e,t,n,r,i)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function GE(e,t){let n=null,r=null;return Array.isArray(t)&&t.length?(n=qE(t[0]),t.length>1&&(r=qE(t[t.length-1]))):t&&(n=qE(t)),n||r?new ZE(e,n,r):null}let ZE=(()=>{class e{constructor(t,n,r){this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;let i=e.initialStylesByElement.get(t);i||e.initialStylesByElement.set(t,i={}),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&T_(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(T_(this._element,this._initialStyles),this._endStyles&&(T_(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(I_(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(I_(this._element,this._endStyles),this._endStyles=null),T_(this._element,this._initialStyles),this._state=3)}}return e.initialStylesByElement=new WeakMap,e})();function qE(e){let t=null;const n=Object.keys(e);for(let r=0;r<n.length;r++){const i=n[r];WE(i)&&(t=t||{},t[i]=e[i])}return t}function WE(e){return"display"===e||"position"===e}const jE="animation",YE="animationend";class KE{constructor(e,t,n,r,i,s,o){this._element=e,this._name=t,this._duration=n,this._delay=r,this._easing=i,this._fillMode=s,this._onDoneFn=o,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=e=>this._handleCallback(e)}apply(){(function(e,t){const n=nw(e,"").trim();let r=0;n.length&&(function(e,t){let n=0;for(let r=0;r<e.length;r++)","===e.charAt(r)&&n++;return n}(n)+1,t=`${n}, ${t}`),tw(e,"",t)})(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),ew(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){QE(this._element,this._name,"paused")}resume(){QE(this._element,this._name,"running")}setPosition(e){const t=XE(this._element,this._name);this._position=e*this._duration,tw(this._element,"Delay",`-${this._position}ms`,t)}getPosition(){return this._position}_handleCallback(e){const t=e._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),ew(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function(e,t){const n=nw(e,"").split(","),r=JE(n,t);r>=0&&(n.splice(r,1),tw(e,"",n.join(",")))}(this._element,this._name))}}function QE(e,t,n){tw(e,"PlayState",n,XE(e,t))}function XE(e,t){const n=nw(e,"");return n.indexOf(",")>0?JE(n.split(","),t):JE([n],t)}function JE(e,t){for(let n=0;n<e.length;n++)if(e[n].indexOf(t)>=0)return n;return-1}function ew(e,t,n){n?e.removeEventListener(YE,t):e.addEventListener(YE,t)}function tw(e,t,n,r){const i=jE+t;if(null!=r){const t=e.style[i];if(t.length){const e=t.split(",");e[r]=n,n=e.join(",")}}e.style[i]=n}function nw(e,t){return e.style[jE+t]||""}class rw{constructor(e,t,n,r,i,s,o,a){this.element=e,this.keyframes=t,this.animationName=n,this._duration=r,this._delay=i,this._finalStyles=o,this._specialStyles=a,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this.currentSnapshot={},this._state=0,this.easing=s||"linear",this.totalTime=r+i,this._buildStyler()}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}destroy(){this.init(),!(this._state>=4)&&(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(e=>e()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}finish(){this.init(),!(this._state>=3)&&(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(e){this._styler.setPosition(e)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._state=0,this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new KE(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",()=>this.finish())}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}beforeDestroy(){this.init();const e={};if(this.hasStarted()){const t=this._state>=3;Object.keys(this._finalStyles).forEach(n=>{"offset"!=n&&(e[n]=t?this._finalStyles[n]:B_(this.element,n))})}this.currentSnapshot=e}}class iw extends GC{constructor(e,t){super(),this.element=e,this._startingStyles={},this.__initialized=!1,this._styles=h_(t)}init(){this.__initialized||!this._startingStyles||(this.__initialized=!0,Object.keys(this._styles).forEach(e=>{this._startingStyles[e]=this.element.style[e]}),super.init())}play(){!this._startingStyles||(this.init(),Object.keys(this._styles).forEach(e=>this.element.style.setProperty(e,this._styles[e])),super.play())}destroy(){!this._startingStyles||(Object.keys(this._startingStyles).forEach(e=>{const t=this._startingStyles[e];t?this.element.style.setProperty(e,t):this.element.style.removeProperty(e)}),this._startingStyles=null,super.destroy())}}class sw{constructor(){this._count=0}validateStyleProperty(e){return a_(e)}matchesElement(e,t){return l_(e,t)}containsElement(e,t){return c_(e,t)}query(e,t,n){return u_(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}buildKeyframeElement(e,t,n){n=n.map(e=>h_(e));let r=`@keyframes ${t} {\n`,i="";n.forEach(e=>{i=" ";const t=parseFloat(e.offset);r+=`${i}${100*t}% {\n`,i+=" ",Object.keys(e).forEach(t=>{const n=e[t];switch(t){case"offset":return;case"easing":return void(n&&(r+=`${i}animation-timing-function: ${n};\n`));default:return void(r+=`${i}${t}: ${n};\n`)}}),r+=`${i}}\n`}),r+="}\n";const s=document.createElement("style");return s.textContent=r,s}animate(e,t,n,r,i,s=[],o){const a=s.filter(e=>e instanceof rw),l={};F_(n,r)&&a.forEach(e=>{let t=e.currentSnapshot;Object.keys(t).forEach(e=>l[e]=t[e])});const c=function(e){let t={};return e&&(Array.isArray(e)?e:[e]).forEach(e=>{Object.keys(e).forEach(n=>{"offset"==n||"easing"==n||(t[n]=e[n])})}),t}(t=U_(e,t,l));if(0==n)return new iw(e,c);const u="gen_css_kf_"+this._count++,h=this.buildKeyframeElement(e,u,t);(function(e){var t;const n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e);return"undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot?n:document.head})(e).appendChild(h);const d=GE(e,t),f=new rw(e,t,u,n,r,i,c,d);return f.onDestroy(()=>{var e;(e=h).parentNode.removeChild(e)}),f}}class ow{constructor(e,t,n,r){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(e,t,n){return e.animate(t,n)}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(t=>{"offset"!=t&&(e[t]=this._finished?this._finalKeyframe[t]:B_(this.element,t))}),this.currentSnapshot=e}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}}class aw{constructor(){this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(lw().toString()),this._cssKeyframesDriver=new sw}validateStyleProperty(e){return a_(e)}matchesElement(e,t){return l_(e,t)}containsElement(e,t){return c_(e,t)}query(e,t,n){return u_(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}overrideWebAnimationsSupport(e){this._isNativeImpl=e}animate(e,t,n,r,i,s=[],o){if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,n,r,i,s);const a={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(a.easing=i);const l={},c=s.filter(e=>e instanceof ow);F_(n,r)&&c.forEach(e=>{let t=e.currentSnapshot;Object.keys(t).forEach(e=>l[e]=t[e])});const u=GE(e,t=U_(e,t=t.map(e=>S_(e,!1)),l));return new ow(e,t,a,u)}}function lw(){return qC()&&Element.prototype.animate||{}}let cw=(()=>{class e extends VC{constructor(e,t){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(t.body,{id:"0",encapsulation:Ue.None,styles:[],data:{animation:[]}})}build(e){const t=this._nextAnimationId.toString();this._nextAnimationId++;const n=Array.isArray(e)?$C(e):e;return dw(this._renderer,null,t,"register",[n]),new uw(t,this._renderer)}}return e.\u0275fac=function(t){return new(t||e)(Or(bc),Or(Kh))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();class uw extends class{}{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new hw(this._id,e,t||{},this._renderer)}}class hw{constructor(e,t,n,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return dw(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}function dw(e,t,n,r,i){return e.setProperty(t,`@@${n}:${r}`,i)}const fw="@.disabled";let pw=(()=>{class e{constructor(e,t,n){this.delegate=e,this.engine=t,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),t.onRemovalComplete=(e,t)=>{t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}createRenderer(e,t){const n=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){let e=this._rendererCache.get(n);return e||(e=new gw("",n,this.engine),this._rendererCache.set(n,e)),e}const r=t.id,i=t.id+"-"+this._currentId;this._currentId++,this.engine.register(i,e);const s=t=>{Array.isArray(t)?t.forEach(s):this.engine.registerTrigger(r,i,e,t.name,t)};return t.data.animation.forEach(s),new mw(this,i,n,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,t,n){e>=0&&e<this._microtaskId?this._zone.run(()=>t(n)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(e=>{const[t,n]=e;t(n)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([t,n]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return e.\u0275fac=function(t){return new(t||e)(Or(bc),Or(HE),Or(vh))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();class gw{constructor(e,t,n){this.namespaceId=e,this.delegate=t,this.engine=n,this.destroyNode=this.delegate.destroyNode?e=>t.destroyNode(e):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,r=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,r){this.delegate.setStyle(e,t,n,r)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==fw?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class mw extends gw{constructor(e,t,n,r){super(t,n,r),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==fw?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const r=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e);let i=t.substr(1),s="";return"@"!=i.charAt(0)&&([i,s]=function(e){const t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(i)),this.engine.listen(this.namespaceId,r,i,s,e=>{this.factory.scheduleListenerCallback(e._data||-1,n,e)})}return this.delegate.listen(e,t,n)}}let yw=(()=>{class e extends HE{constructor(e,t,n){super(e.body,t,n)}ngOnDestroy(){this.flush()}}return e.\u0275fac=function(t){return new(t||e)(Or(Kh),Or(f_),Or(cE))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e})();const vw=new or("AnimationModuleType"),Cw=[{provide:VC,useClass:cw},{provide:cE,useFactory:function(){return new uE}},{provide:HE,useClass:yw},{provide:bc,useFactory:function(e,t,n){return new pw(e,t,n)},deps:[Af,HE,vh]}],_w=[{provide:f_,useFactory:function(){return"function"==typeof lw()?new aw:new sw}},{provide:vw,useValue:"BrowserAnimations"},...Cw],Ew=[{provide:f_,useClass:d_},{provide:vw,useValue:"NoopAnimations"},...Cw];let ww=(()=>{class e{static withConfig(t){return{ngModule:e,providers:t.disableAnimations?Ew:_w}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({providers:_w,imports:[Zf]}),e})();var Pw=n(9575),Sw=n.n(Pw);function bw(e,t,n,r,i,s,o){try{var a=e[s](o),l=a.value}catch(c){return void n(c)}a.done?t(l):Promise.resolve(l).then(r,i)}function Ow(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var s=e.apply(t,n);function o(e){bw(s,r,i,o,a,"next",e)}function a(e){bw(s,r,i,o,a,"throw",e)}o(void 0)})}}class Tw{static expectToBe(e,t,n){if(e!==t)throw void 0!==n?new Error(n):new Error(`A default switch case did not observe the correct value, expected ${t}, but got ${e} instead.`)}static expectToBeMultiple(e,t){let n=!1;for(const r of t)if(e===r){n=!0;break}if(!1===n)throw new Error(`A default switch case did not observe the correct value, expected a value among ${t}, but got ${e} instead.`)}static getNonNullable(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}}function Iw(e,t){e&&console.log(t)}function kw(e,t){if(null!=e&&null!=t&&"object"==typeof e){if(null!=e.equals)return e.equals(t);{const n=e,r=t;for(const e of Object.keys(n)){if(!(e in r))return!1;if(!1===kw(n[e],r[e]))return!1}return!0}}return e===t}function Aw(e){return null==e||function(e){return"object"==typeof e&&null!=e&&null!=e.equals}(e)||function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e}(e)||function(e){if("object"==typeof e){for(const t in e)if(null!=e[t]&&!1===Aw(e[t]))return!1;return null!=e&&e.constructor.prototype===Object.prototype}return!1}(e)}function Mw(e,t){if(Aw(e)&&Aw(t))return kw(e,t);throw new Error(`Comparing non comparable objects: ${e.constructor.name} and ${t.constructor.name}`)}class Nw{constructor(e){this.value=e}static of(e){return new Nw(e)}static ofNullable(e){return null==e?Nw.empty():Nw.of(e)}static empty(){return new Nw(null)}isPresent(){return null!=this.value}isAbsent(){return null==this.value}get(){if(this.isPresent())return this.value;throw new Error("Value is absent")}getOrElse(e){return this.isPresent()?this.value:e}equals(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&Mw(this.value,e.value)}equalsValue(e){return this.equals(Nw.of(e))}toString(){return this.isAbsent()?"MGPOptional.empty()":`MGPOptional.of(${this.value})`}map(e){return this.isPresent()?Nw.of(e(this.get())):Nw.empty()}}class Rw{static success(e){return new xw(e)}static failure(e){return new Dw(e)}constructor(){}equals(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&Mw(this.get(),e.get())}}class xw extends Rw{constructor(e){super(),this.value=e}isSuccess(){return!0}isFailure(){return!1}get(){return this.value}getReason(){throw new Error("Cannot get failure reason from a success")}getReasonOr(e){return e}toOptional(){return Nw.of(this.value)}toString(){return`MGPFallible.success(${this.value})`}}class Dw extends Rw{constructor(e){super(),this.reason=e}isSuccess(){return!1}isFailure(){return!0}get(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}getReason(){return this.reason}getReasonOr(e){return this.getReason()}toOptional(){return Nw.empty()}toString(){return`MGPFallible.failure(${this.reason})`}}class Lw{constructor(e){this.reason=e}static ofFallible(e){return e.isSuccess()?Lw.SUCCESS:Lw.failure(e.getReason())}static failure(e){return new Lw(e)}isFailure(){return!1===this.isSuccess()}isSuccess(){return null==this.reason}getReason(){if(this.isSuccess())throw new Error("MGPValidation: Cannot extract failure reason from success.");return this.reason}toFallible(e){return this.isSuccess()?Rw.success(e):Rw.failure(this.getReason())}toFailedFallible(){if(this.isSuccess())throw new Error("MGPValidation: cannot convert into failed fallible.");return Rw.failure(this.getReason())}}Lw.SUCCESS=new Lw(null);const Fw=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},Uw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,o=s?e[i+1]:0,a=i+2<e.length,l=a?e[i+2]:0;let c=(15&o)<<2|l>>6,u=63&l;a||(u=64,s||(c=64)),r.push(n[t>>2],n[(3&t)<<4|o>>4],n[c],n[u])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Fw(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const o=i<e.length?n[e.charAt(i)]:64;++i;const a=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==o||null==a)throw Error();r.push(t<<2|s>>4),64!==o&&(r.push(s<<4&240|o>>2),64!==a&&r.push(o<<6&192|a))}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},Vw=function(e){return function(e){const t=Fw(e);return Uw.encodeByteArray(t,!0)}(e).replace(/\./g,"")};class Bw{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function $w(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function zw(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($w())}function Hw(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function Gw(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Zw(){const e=$w();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function qw(){return"object"==typeof indexedDB}function Ww(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}function jw(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}class Yw extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Yw.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Kw.prototype.create)}}class Kw{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(Qw,(e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`})}(i,n):"Error";return new Yw(r,`${this.serviceName}: ${s} (${r}).`,n)}}const Qw=/\{\$([^}]+)}/g;function Xw(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(Jw(n)&&Jw(s)){if(!Xw(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Jw(e){return null!==e&&"object"==typeof e}function eP(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function tP(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function nP(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class rP{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of["next","error","complete"])if(n in e&&"function"==typeof e[n])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=iP),void 0===r.error&&(r.error=iP),void 0===r.complete&&(r.complete=iP);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!=typeof console&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function iP(){}function sP(e,t=1e3,n=2){const r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}function oP(e){return e&&e._delegate?e._delegate:e}class aP{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const lP="[DEFAULT]";class cP{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new Bw;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:lP})}catch{}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch{}}}}clearInstance(e=lP){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){var e=this;return Ow(function*(){const t=Array.from(e.instances.values());yield Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(e=lP){return this.instances.has(e)}getOptions(e=lP){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(i)&&s.resolve(r);return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===lP?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}var r;return n||null}normalizeInstanceIdentifier(e=lP){return this.component?this.component.multipleInstances?e:lP:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class uP{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new cP(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const hP=[];var dP=(()=>{return(e=dP||(dP={}))[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",dP;var e})();const fP={debug:dP.DEBUG,verbose:dP.VERBOSE,info:dP.INFO,warn:dP.WARN,error:dP.ERROR,silent:dP.SILENT},pP=dP.INFO,gP={[dP.DEBUG]:"log",[dP.VERBOSE]:"log",[dP.INFO]:"info",[dP.WARN]:"warn",[dP.ERROR]:"error"},mP=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=gP[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class yP{constructor(e){this.name=e,this._logLevel=pP,this._logHandler=mP,this._userLogHandler=null,hP.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in dP))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?fP[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,dP.DEBUG,...e),this._logHandler(this,dP.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,dP.VERBOSE,...e),this._logHandler(this,dP.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,dP.INFO,...e),this._logHandler(this,dP.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,dP.WARN,...e),this._logHandler(this,dP.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,dP.ERROR,...e),this._logHandler(this,dP.ERROR,...e)}}let vP,CP;const _P=new WeakMap,EP=new WeakMap,wP=new WeakMap,PP=new WeakMap,SP=new WeakMap;let bP={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return EP.get(e);if("objectStoreNames"===t)return e.objectStoreNames||wP.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return TP(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function OP(e){return"function"==typeof e?function(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(CP||(CP=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(IP(this),t),TP(_P.get(this))}:function(...t){return TP(e.apply(IP(this),t))}:function(t,...n){const r=e.call(IP(this),t,...n);return wP.set(r,t.sort?t.sort():[t]),TP(r)}}(e):(e instanceof IDBTransaction&&function(e){if(EP.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});EP.set(e,t)}(e),((e,t)=>t.some(t=>e instanceof t))(e,vP||(vP=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,bP):e)}function TP(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(TP(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&_P.set(t,e)}).catch(()=>{}),SP.set(t,e),t}(e);if(PP.has(e))return PP.get(e);const t=OP(e);return t!==e&&(PP.set(e,t),SP.set(t,e)),t}const IP=e=>SP.get(e);function kP(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=TP(o);return r&&o.addEventListener("upgradeneeded",e=>{r(TP(o.result),e.oldVersion,e.newVersion,TP(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}function AP(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",()=>t()),TP(n).then(()=>{})}const MP=["get","getKey","getAll","getAllKeys","count"],NP=["put","add","delete","clear"],RP=new Map;function xP(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(RP.get(t))return RP.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=NP.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!MP.includes(n))return;const s=function(){var e=Ow(function*(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(yield Promise.all([o[n](...t),i&&s.done]))[0]});return function(t){return e.apply(this,arguments)}}();return RP.set(t,s),s}var DP;DP=bP,bP={...DP,get:(e,t,n)=>xP(e,t)||DP.get(e,t,n),has:(e,t)=>!!xP(e,t)||DP.has(e,t)};class LP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const FP="@firebase/app",UP=new yP("@firebase/app"),VP="[DEFAULT]",BP={[FP]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},$P=new Map,zP=new Map;function HP(e,t){try{e.container.addComponent(t)}catch(n){UP.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function GP(e){const t=e.name;if(zP.has(t))return UP.debug(`There were multiple attempts to register component ${t}.`),!1;zP.set(t,e);for(const n of $P.values())HP(n,e);return!0}function ZP(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const qP=new Kw("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."});class WP{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new aP("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qP.create("app-deleted",{appName:this._name})}}const jP="9.9.0";function YP(e,t={}){"object"!=typeof t&&(t={name:t});const n=Object.assign({name:VP,automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw qP.create("bad-app-name",{appName:String(r)});const i=$P.get(r);if(i){if(Xw(e,i.options)&&Xw(n,i.config))return i;throw qP.create("duplicate-app",{appName:r})}const s=new uP(r);for(const a of zP.values())s.addComponent(a);const o=new WP(e,n,s);return $P.set(r,o),o}function KP(e=VP){const t=$P.get(e);if(!t)throw qP.create("no-app",{appName:e});return t}function QP(){return Array.from($P.values())}function XP(e,t,n){var r;let i=null!==(r=BP[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void UP.warn(e.join(" "))}GP(new aP(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}const JP="firebase-heartbeat-store";let eS=null;function tS(){return eS||(eS=kP("firebase-heartbeat-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(JP)}}).catch(e=>{throw qP.create("storage-open",{originalErrorMessage:e.message})})),eS}function nS(){return nS=Ow(function*(e){var t;try{return(yield tS()).transaction(JP).objectStore(JP).get(sS(e))}catch(n){throw qP.create("storage-get",{originalErrorMessage:null===(t=n)||void 0===t?void 0:t.message})}}),nS.apply(this,arguments)}function rS(e,t){return iS.apply(this,arguments)}function iS(){return iS=Ow(function*(e,t){var n;try{const n=(yield tS()).transaction(JP,"readwrite");return yield n.objectStore(JP).put(t,sS(e)),n.done}catch(r){throw qP.create("storage-set",{originalErrorMessage:null===(n=r)||void 0===n?void 0:n.message})}}),iS.apply(this,arguments)}function sS(e){return`${e.name}!${e.options.appId}`}class oS{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new lS(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}triggerHeartbeat(){var e=this;return Ow(function*(){const t=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=aS();if(null===e._heartbeatsCache&&(e._heartbeatsCache=yield e._heartbeatsCachePromise),e._heartbeatsCache.lastSentHeartbeatDate!==n&&!e._heartbeatsCache.heartbeats.some(e=>e.date===n))return e._heartbeatsCache.heartbeats.push({date:n,agent:t}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),e._storage.overwrite(e._heartbeatsCache)})()}getHeartbeatsHeader(){var e=this;return Ow(function*(){if(null===e._heartbeatsCache&&(yield e._heartbeatsCachePromise),null===e._heartbeatsCache||0===e._heartbeatsCache.heartbeats.length)return"";const t=aS(),{heartbeatsToSend:n,unsentEntries:r}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),cS(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),cS(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(e._heartbeatsCache.heartbeats),i=Vw(JSON.stringify({version:2,heartbeats:n}));return e._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(e._heartbeatsCache.heartbeats=r,yield e._storage.overwrite(e._heartbeatsCache)):(e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache)),i})()}}function aS(){return(new Date).toISOString().substring(0,10)}class lS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return Ow(function*(){return!!qw()&&Ww().then(()=>!0).catch(()=>!1)})()}read(){var e=this;return Ow(function*(){return(yield e._canUseIndexedDBPromise)&&(yield function(e){return nS.apply(this,arguments)}(e.app))||{heartbeats:[]}})()}overwrite(e){var t=this;return Ow(function*(){var n;if(yield t._canUseIndexedDBPromise){const r=yield t.read();return rS(t.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})()}add(e){var t=this;return Ow(function*(){var n;if(yield t._canUseIndexedDBPromise){const r=yield t.read();return rS(t.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}})()}}function cS(e){return Vw(JSON.stringify({version:2,heartbeats:e})).length}GP(new aP("platform-logger",e=>new LP(e),"PRIVATE")),GP(new aP("heartbeat",e=>new oS(e),"PRIVATE")),XP(FP,"0.7.28",""),XP(FP,"0.7.28","esm2017"),XP("fire-js","");var uS,hS="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},dS={},fS=fS||{},pS=hS||self;function gS(){}function mS(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function yS(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var vS="closure_uid_"+(1e9*Math.random()>>>0),CS=0;function _S(e,t,n){return e.call.apply(e.bind,arguments)}function ES(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function wS(e,t,n){return(wS=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?_S:ES).apply(null,arguments)}function PS(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function SS(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function bS(){this.s=this.s,this.o=this.o}var OS={};bS.prototype.s=!1,bS.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,vS)&&e[vS]||(e[vS]=++CS)}(this);delete OS[e]}},bS.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const TS=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},IS=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){const r=e.length,i="string"==typeof e?e.split(""):e;for(let s=0;s<r;s++)s in i&&t.call(n,i[s],s,e)};function kS(e){return Array.prototype.concat.apply([],arguments)}function AS(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function MS(e){return/^[\s\xa0]*$/.test(e)}var NS,RS=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function xS(e,t){return-1!=e.indexOf(t)}function DS(e,t){return e<t?-1:e>t?1:0}e:{var LS=pS.navigator;if(LS){var FS=LS.userAgent;if(FS){NS=FS;break e}}NS=""}function US(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function VS(e){const t={};for(const n in e)t[n]=e[n];return t}var BS="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $S(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<BS.length;t++)n=BS[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function zS(e){return zS[" "](e),e}zS[" "]=gS;var HS,GS=xS(NS,"Opera"),ZS=xS(NS,"Trident")||xS(NS,"MSIE"),qS=xS(NS,"Edge"),WS=qS||ZS,jS=xS(NS,"Gecko")&&!(xS(NS.toLowerCase(),"webkit")&&!xS(NS,"Edge"))&&!(xS(NS,"Trident")||xS(NS,"MSIE"))&&!xS(NS,"Edge"),YS=xS(NS.toLowerCase(),"webkit")&&!xS(NS,"Edge");function KS(){var e=pS.document;return e?e.documentMode:void 0}e:{var QS="",XS=function(){var e=NS;return jS?/rv:([^\);]+)(\)|;)/.exec(e):qS?/Edge\/([\d\.]+)/.exec(e):ZS?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):YS?/WebKit\/(\S+)/.exec(e):GS?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(XS&&(QS=XS?XS[1]:""),ZS){var JS=KS();if(null!=JS&&JS>parseFloat(QS)){HS=String(JS);break e}}HS=QS}var eb={};function tb(){return e=eb,Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){let e=0;const t=RS(String(HS)).split("."),n=RS("9").split("."),r=Math.max(t.length,n.length);for(let o=0;0==e&&o<r;o++){var i=t[o]||"",s=n[o]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==i[0].length&&0==s[0].length)break;e=DS(0==i[1].length?0:parseInt(i[1],10),0==s[1].length?0:parseInt(s[1],10))||DS(0==i[2].length,0==s[2].length)||DS(i[2],s[2]),i=i[3],s=s[3]}while(0==e)}return 0<=e}();var e}var nb=pS.document&&ZS&&(KS()||parseInt(HS,10))||void 0,rb=function(){if(!pS.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{pS.addEventListener("test",gS,t),pS.removeEventListener("test",gS,t)}catch{}return e}();function ib(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function sb(e,t){if(ib.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(jS){e:{try{zS(t.nodeName);var i=!0;break e}catch{}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:ob[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&sb.Z.h.call(this)}}ib.prototype.h=function(){this.defaultPrevented=!0},SS(sb,ib);var ob={2:"touch",3:"pen",4:"mouse"};sb.prototype.h=function(){sb.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var ab="closure_listenable_"+(1e6*Math.random()|0),lb=0;function cb(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++lb,this.ca=this.fa=!1}function ub(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function hb(e){this.src=e,this.g={},this.h=0}function db(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=TS(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(ub(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function fb(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.ca&&s.listener==t&&s.capture==!!n&&s.ia==r)return i}return-1}hb.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=fb(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new cb(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var pb="closure_lm_"+(1e6*Math.random()|0),gb={};function mb(e,t,n,r,i){if(r&&r.once)return vb(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)mb(e,t[s],n,r,i);return null}return n=bb(n),e&&e[ab]?e.N(t,n,yS(r)?!!r.capture:!!r,i):yb(e,t,n,!1,r,i)}function yb(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=yS(i)?!!i.capture:!!i,a=Pb(e);if(a||(e[pb]=a=new hb(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){var e=wb;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)rb||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Eb(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function vb(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)vb(e,t[s],n,r,i);return null}return n=bb(n),e&&e[ab]?e.O(t,n,yS(r)?!!r.capture:!!r,i):yb(e,t,n,!0,r,i)}function Cb(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)Cb(e,t[s],n,r,i);else r=yS(r)?!!r.capture:!!r,n=bb(n),e&&e[ab]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=fb(s=e.g[t],n,r,i))&&(ub(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--))):e&&(e=Pb(e))&&(t=e.g[t.toString()],e=-1,t&&(e=fb(t,n,r,i)),(n=-1<e?t[e]:null)&&_b(n))}function _b(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[ab])db(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Eb(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Pb(t))?(db(n,e),0==n.h&&(n.src=null,t[pb]=null)):ub(e)}}}function Eb(e){return e in gb?gb[e]:gb[e]="on"+e}function wb(e,t){if(e.ca)e=!0;else{t=new sb(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&_b(e),e=n.call(r,t)}return e}function Pb(e){return(e=e[pb])instanceof hb?e:null}var Sb="__closure_events_fn_"+(1e9*Math.random()>>>0);function bb(e){return"function"==typeof e?e:(e[Sb]||(e[Sb]=function(t){return e.handleEvent(t)}),e[Sb])}function Ob(){bS.call(this),this.i=new hb(this),this.P=this,this.I=null}function Tb(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new ib(t,e);else if(t instanceof ib)t.target=t.target||e;else{var i=t;$S(t=new ib(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=Ib(o,r,!0,t)&&i}if(i=Ib(o=t.g=e,r,!0,t)&&i,i=Ib(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=Ib(o=t.g=n[s],r,!1,t)&&i}function Ib(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.ca&&o.capture==n){var a=o.listener,l=o.ia||o.src;o.fa&&db(e.i,o),i=!1!==a.call(l,r)&&i}}return i&&!r.defaultPrevented}SS(Ob,bS),Ob.prototype[ab]=!0,Ob.prototype.removeEventListener=function(e,t,n,r){Cb(this,e,t,n,r)},Ob.prototype.M=function(){if(Ob.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)ub(n[r]);delete t.g[e],t.h--}}this.I=null},Ob.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Ob.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var kb=pS.JSON.stringify;function Ab(){var e=Fb;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Mb,Nb=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new Rb,e=>e.reset());class Rb{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function xb(e){pS.setTimeout(()=>{throw e},0)}function Db(e,t){Mb||function(){var e=pS.Promise.resolve(void 0);Mb=function(){e.then(Ub)}}(),Lb||(Mb(),Lb=!0),Fb.add(e,t)}var Lb=!1,Fb=new class{constructor(){this.h=this.g=null}add(e,t){const n=Nb.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}};function Ub(){for(var e;e=Ab();){try{e.h.call(e.g)}catch(n){xb(n)}var t=Nb;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Lb=!1}function Vb(e,t){Ob.call(this),this.h=e||1,this.g=t||pS,this.j=wS(this.kb,this),this.l=Date.now()}function Bb(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function $b(e,t,n){if("function"==typeof e)n&&(e=wS(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=wS(e.handleEvent,e)}return 2147483647<Number(t)?-1:pS.setTimeout(e,t||0)}function zb(e){e.g=$b(()=>{e.g=null,e.i&&(e.i=!1,zb(e))},e.j);const t=e.h;e.h=null,e.m.apply(null,t)}SS(Vb,Ob),(uS=Vb.prototype).da=!1,uS.S=null,uS.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Tb(this,"tick"),this.da&&(Bb(this),this.start()))}},uS.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},uS.M=function(){Vb.Z.M.call(this),Bb(this),delete this.g};class Hb extends bS{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:zb(this)}M(){super.M(),this.g&&(pS.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gb(e){bS.call(this),this.h=e,this.g={}}SS(Gb,bS);var Zb=[];function qb(e,t,n,r){Array.isArray(n)||(n&&(Zb[0]=n.toString()),n=Zb);for(var i=0;i<n.length;i++){var s=mb(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function Wb(e){US(e.g,function(e,t){this.g.hasOwnProperty(t)&&_b(e)},e),e.g={}}function jb(){this.g=!0}function Yb(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return kb(n)}catch{return t}}(e,n)+(r?" "+r:"")})}Gb.prototype.M=function(){Gb.Z.M.call(this),Wb(this)},Gb.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},jb.prototype.Aa=function(){this.g=!1},jb.prototype.info=function(){};var Kb={},Qb=null;function Xb(){return Qb=Qb||new Ob}function Jb(e){ib.call(this,Kb.Ma,e)}function eO(e){const t=Xb();Tb(t,new Jb(t,e))}function tO(e,t){ib.call(this,Kb.STAT_EVENT,e),this.stat=t}function nO(e){const t=Xb();Tb(t,new tO(t,e))}function rO(e,t){ib.call(this,Kb.Na,e),this.size=t}function iO(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return pS.setTimeout(function(){e()},t)}Kb.Ma="serverreachability",SS(Jb,ib),Kb.STAT_EVENT="statevent",SS(tO,ib),Kb.Na="timingevent",SS(rO,ib);var sO={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},oO={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function aO(){}function lO(){}aO.prototype.h=null;var cO,uO={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function hO(){ib.call(this,"d")}function dO(){ib.call(this,"c")}function fO(){}function pO(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new Gb(this),this.P=mO,this.W=new Vb(e=WS?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new gO}function gO(){this.i=null,this.g="",this.h=!1}SS(hO,ib),SS(dO,ib),SS(fO,aO),fO.prototype.g=function(){return new XMLHttpRequest},fO.prototype.i=function(){return{}},cO=new fO;var mO=45e3,yO={},vO={};function CO(e,t,n){e.K=1,e.v=zO(LO(t)),e.s=n,e.U=!0,_O(e,null)}function _O(e,t){e.F=Date.now(),SO(e),e.A=LO(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),tT(n.h,"t",r),e.C=0,n=e.l.H,e.h=new gO,e.g=tI(e.l,n?t:null,!e.s),0<e.O&&(e.L=new Hb(wS(e.Ia,e,e.g),e.O)),qb(e.V,e.g,"readystatechange",e.gb),t=e.H?VS(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),eO(1),function(e,t,n,r,i,s){e.info(function(){if(e.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+c+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.j,e.u,e.A,e.m,e.X,e.s)}function EO(e){return!!e.g&&"GET"==e.u&&2!=e.K&&e.l.Ba}function wO(e,t,n){let r,i=!0;for(;!e.I&&e.C<n.length;){if(r=PO(e,n),r==vO){4==t&&(e.o=4,nO(14),i=!1),Yb(e.j,e.m,null,"[Incomplete Response]");break}if(r==yO){e.o=4,nO(15),Yb(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}Yb(e.j,e.m,r,null),kO(e,r)}EO(e)&&r!=vO&&r!=yO&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,nO(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),WT(t),t.L=!0,nO(11))):(Yb(e.j,e.m,n,"[Invalid Chunked Response]"),IO(e),TO(e))}function PO(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?vO:(n=Number(t.substring(n,r)),isNaN(n)?yO:(r+=1)+n>t.length?vO:(t=t.substr(r,n),e.C=r+n,t))}function SO(e){e.Y=Date.now()+e.P,bO(e,e.P)}function bO(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=iO(wS(e.eb,e),t)}function OO(e){e.B&&(pS.clearTimeout(e.B),e.B=null)}function TO(e){0==e.l.G||e.I||KT(e.l,e)}function IO(e){OO(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,Bb(e.W),Wb(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function kO(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||aT(n.i,e)))if(n.I=e.N,!e.J&&aT(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0])e:if(n.u)n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=iO(wS(n.ab,n),6e3));else{if(n.g){if(!(n.g.F+3e3<e.F))break e;YT(n),UT(n)}qT(n),nO(18)}if(1>=oT(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else XT(n,11)}else if((e.J||n.g==e)&&YT(n),!MS(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(n.U=c[0],c=c[1],2==n.G)if("c"==c[0]){n.J=c[1],n.la=c[2];const t=c[3];null!=t&&(n.ma=t,n.h.info("VER="+n.ma));const i=c[4];null!=i&&(n.za=i,n.h.info("SVER="+n.za));const u=c[5];null!=u&&"number"==typeof u&&0<u&&(n.K=r=1.5*u,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.i;!s.g&&(xS(e,"spdy")||xS(e,"quic")||xS(e,"h2"))&&(s.j=s.l,s.g=new Set,s.h&&(lT(s,s.h),s.h=null))}if(r.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.sa=e,$O(r.F,r.D,e))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var o=e;if((r=n).oa=eI(r,r.H?r.la:null,r.W),o.J){cT(r.i,o);var a=o,l=r.K;l&&a.setTimeout(l),a.B&&(OO(a),SO(a)),r.g=o}else ZT(r);0<n.l.length&&$T(n)}else"stop"!=c[0]&&"close"!=c[0]||XT(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?XT(n,7):FT(n):"noop"!=c[0]&&n.j&&n.j.wa(c),n.A=0)}eO(4)}catch{}}function AO(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(mS(e)||"string"==typeof e)IS(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(mS(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(mS(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length;for(var s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}}function MO(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof MO)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function NO(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];RO(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)RO(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function RO(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(uS=pO.prototype).setTimeout=function(e){this.P=e},uS.gb=function(e){e=e.target;const t=this.L;t&&3==NT(e)?t.l():this.Ia(e)},uS.Ia=function(e){try{if(e==this.g)e:{const u=NT(this.g);var t=this.g.Da();const h=this.g.ba();if(!(3>u)&&(3!=u||WS||this.g&&(this.h.h||this.g.ga()||RT(this.g)))){this.I||4!=u||7==t||eO(8==t||0>=h?3:2),OO(this);var n=this.g.ba();this.N=n;t:if(EO(this)){var r=RT(this.g);e="";var i=r.length,s=4==NT(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){IO(this),TO(this);var o="";break t}this.h.i=new pS.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:s&&t==i-1});r.splice(0,i),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=200==n,function(e,t,n,r,i,s,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.X,u,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!MS(a)){var c=a;break t}}c=null}if(!(n=c)){this.i=!1,this.o=3,nO(12),IO(this),TO(this);break e}Yb(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,kO(this,n)}this.U?(wO(this,u,o),WS&&this.i&&3==u&&(qb(this.V,this.W,"tick",this.fb),this.W.start())):(Yb(this.j,this.m,o,null),kO(this,o)),4==u&&IO(this),this.i&&!this.I&&(4==u?KT(this.l,this):(this.i=!1,SO(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,nO(12)):(this.o=0,nO(13)),IO(this),TO(this)}}}catch{}},uS.fb=function(){if(this.g){var e=NT(this.g),t=this.g.ga();this.C<t.length&&(OO(this),wO(this,e,t),this.i&&4!=e&&SO(this))}},uS.cancel=function(){this.I=!0,IO(this)},uS.eb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(eO(3),nO(17)),IO(this),this.o=2,TO(this)):bO(this,this.Y-e)},(uS=MO.prototype).R=function(){NO(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},uS.T=function(){return NO(this),this.g.concat()},uS.get=function(e,t){return RO(this.h,e)?this.h[e]:t},uS.set=function(e,t){RO(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},uS.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],s=this.get(i);e.call(t,s,i,this)}};var xO=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function DO(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof DO){this.g=void 0!==t?t:e.g,FO(this,e.j),this.s=e.s,UO(this,e.i),VO(this,e.m),this.l=e.l,t=e.h;var n=new QO;n.i=t.i,t.g&&(n.g=new MO(t.g),n.h=t.h),BO(this,n),this.o=e.o}else e&&(n=String(e).match(xO))?(this.g=!!t,FO(this,n[1]||"",!0),this.s=HO(n[2]||""),UO(this,n[3]||"",!0),VO(this,n[4]),this.l=HO(n[5]||"",!0),BO(this,n[6]||"",!0),this.o=HO(n[7]||"")):(this.g=!!t,this.h=new QO(null,this.g))}function LO(e){return new DO(e)}function FO(e,t,n){e.j=n?HO(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function UO(e,t,n){e.i=n?HO(t,!0):t}function VO(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function BO(e,t,n){t instanceof QO?(e.h=t,function(e,t){t&&!e.j&&(XO(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(JO(this,t),tT(this,n,e))},e)),e.j=t}(e.h,e.g)):(n||(t=GO(t,YO)),e.h=new QO(t,e.g))}function $O(e,t,n){e.h.set(t,n)}function zO(e){return $O(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function HO(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function GO(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,ZO),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ZO(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}DO.prototype.toString=function(){var e=[],t=this.j;t&&e.push(GO(t,qO,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(GO(t,qO,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(GO(n,"/"==n.charAt(0)?jO:WO,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",GO(n,KO)),e.join("")};var qO=/[#\/\?@]/g,WO=/[#\?:]/g,jO=/[#\?]/g,YO=/[#\?@]/g,KO=/#/g;function QO(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function XO(e){e.g||(e.g=new MO,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function JO(e,t){XO(e),t=nT(e,t),RO(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,RO((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&NO(e)))}function eT(e,t){return XO(e),t=nT(e,t),RO(e.g.h,t)}function tT(e,t,n){JO(e,t),0<n.length&&(e.i=null,e.g.set(nT(e,t),AS(n)),e.h+=n.length)}function nT(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function rT(e){this.l=e||iT,e=pS.PerformanceNavigationTiming?0<(e=pS.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(pS.g&&pS.g.Ea&&pS.g.Ea()&&pS.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(uS=QO.prototype).add=function(e,t){XO(this),this.i=null,e=nT(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},uS.forEach=function(e,t){XO(this),this.g.forEach(function(n,r){IS(n,function(n){e.call(t,n,r,this)},this)},this)},uS.T=function(){XO(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],s=0;s<i.length;s++)n.push(t[r]);return n},uS.R=function(e){XO(this);var t=[];if("string"==typeof e)eT(this,e)&&(t=kS(t,this.g.get(nT(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=kS(t,e[n])}return t},uS.set=function(e,t){return XO(this),this.i=null,eT(this,e=nT(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},uS.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},uS.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var s=0;s<r.length;s++){var o=i;""!==r[s]&&(o+="="+encodeURIComponent(String(r[s]))),e.push(o)}}return this.i=e.join("&")};var iT=10;function sT(e){return!!e.h||!!e.g&&e.g.size>=e.j}function oT(e){return e.h?1:e.g?e.g.size:0}function aT(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function lT(e,t){e.g?e.g.add(t):e.h=t}function cT(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function uT(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return AS(e.i)}function hT(){}function dT(){this.g=new hT}function fT(e,t,n){const r=n||"";try{AO(e,function(e,n){let i=e;yS(e)&&(i=kb(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function pT(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch{}}function gT(e){this.l=e.$b||null,this.j=e.ib||!1}function mT(e,t){Ob.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=yT,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}rT.prototype.cancel=function(){if(this.i=uT(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}},hT.prototype.stringify=function(e){return pS.JSON.stringify(e,void 0)},hT.prototype.parse=function(e){return pS.JSON.parse(e,void 0)},SS(gT,aO),gT.prototype.g=function(){return new mT(this.l,this.j)},gT.prototype.i=function(e){return function(){return e}}({}),SS(mT,Ob);var yT=0;function vT(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function CT(e){e.readyState=4,e.l=null,e.j=null,e.A=null,_T(e)}function _T(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(uS=mT.prototype).open=function(e,t){if(this.readyState!=yT)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,_T(this)},uS.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||pS).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},uS.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,CT(this)),this.readyState=yT},uS.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,_T(this)),this.g&&(this.readyState=3,_T(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==pS.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;vT(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},uS.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?CT(this):_T(this),3==this.readyState&&vT(this)}},uS.Ua=function(e){this.g&&(this.response=this.responseText=e,CT(this))},uS.Ta=function(e){this.g&&(this.response=e,CT(this))},uS.ha=function(){this.g&&CT(this)},uS.setRequestHeader=function(e,t){this.v.append(e,t)},uS.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},uS.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(mT.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var ET=pS.JSON.parse;function wT(e){Ob.call(this),this.headers=new MO,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=PT,this.K=this.L=!1}SS(wT,Ob);var PT="",ST=/^https?$/i,bT=["POST","PUT"];function OT(e){return"content-type"==e.toLowerCase()}function TT(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,IT(e),AT(e)}function IT(e){e.D||(e.D=!0,Tb(e,"complete"),Tb(e,"error"))}function kT(e){if(e.h&&void 0!==fS&&(!e.C[1]||4!=NT(e)||2!=e.ba()))if(e.v&&4==NT(e))$b(e.Fa,0,e);else if(Tb(e,"readystatechange"),4==NT(e)){e.h=!1;try{const a=e.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===a){var i=String(e.H).match(xO)[1]||null;if(!i&&pS.self&&pS.self.location){var s=pS.self.location.protocol;i=s.substr(0,s.length-1)}r=!ST.test(i?i.toLowerCase():"")}n=r}if(n)Tb(e,"complete"),Tb(e,"success");else{e.m=6;try{var o=2<NT(e)?e.g.statusText:""}catch{o=""}e.j=o+" ["+e.ba()+"]",IT(e)}}finally{AT(e)}}}function AT(e,t){if(e.g){MT(e);const n=e.g,r=e.C[0]?gS:null;e.g=null,e.C=null,t||Tb(e,"ready");try{n.onreadystatechange=r}catch{}}}function MT(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(pS.clearTimeout(e.A),e.A=null)}function NT(e){return e.g?e.g.readyState:0}function RT(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case PT:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch{return null}}function xT(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){let t="";return US(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):$O(e,t,n))}function DT(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function LT(e){this.za=0,this.l=[],this.h=new jb,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=DT("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=DT("baseRetryDelayMs",5e3,e),this.$a=DT("retryDelaySeedMs",1e4,e),this.Ya=DT("forwardChannelMaxRetries",2,e),this.ra=DT("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new rT(e&&e.concurrentRequestLimit),this.Ca=new dT,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function FT(e){if(VT(e),3==e.G){var t=e.V++,n=LO(e.F);$O(n,"SID",e.J),$O(n,"RID",t),$O(n,"TYPE","terminate"),HT(e,n),(t=new pO(e,e.h,t,void 0)).K=2,t.v=zO(LO(n)),n=!1,pS.navigator&&pS.navigator.sendBeacon&&(n=pS.navigator.sendBeacon(t.v.toString(),"")),!n&&pS.Image&&((new Image).src=t.v,n=!0),n||(t.g=tI(t.l,null),t.g.ea(t.v)),t.F=Date.now(),SO(t)}JT(e)}function UT(e){e.g&&(WT(e),e.g.cancel(),e.g=null)}function VT(e){UT(e),e.u&&(pS.clearTimeout(e.u),e.u=null),YT(e),e.i.cancel(),e.m&&("number"==typeof e.m&&pS.clearTimeout(e.m),e.m=null)}function BT(e,t){e.l.push(new class{constructor(e,t){this.h=e,this.g=t}}(e.Za++,t)),3==e.G&&$T(e)}function $T(e){sT(e.i)||e.m||(e.m=!0,Db(e.Ha,e),e.C=0)}function zT(e,t){var n;n=t?t.m:e.V++;const r=LO(e.F);$O(r,"SID",e.J),$O(r,"RID",n),$O(r,"AID",e.U),HT(e,r),e.o&&e.s&&xT(r,e.o,e.s),n=new pO(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=GT(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),lT(e.i,n),CO(n,r,t)}function HT(e,t){e.j&&AO({},function(e,n){$O(t,n,e)})}function GT(e,t,n){n=Math.min(e.l.length,n);var r=e.j?wS(e.j.Oa,e.j,e):null;e:{var i=e.l;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].h,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=i[o].h;const a=i[o].g;if(n-=t,0>n)t=Math.max(0,i[o].h-100),s=!1;else try{fT(a,e,"req"+n+"_")}catch{r&&r(a)}}if(s){r=e.join("&");break e}}}return e=e.l.splice(0,n),t.D=e,r}function ZT(e){e.g||e.u||(e.Y=1,Db(e.Ga,e),e.A=0)}function qT(e){return!(e.g||e.u||3<=e.A||(e.Y++,e.u=iO(wS(e.Ga,e),QT(e,e.A)),e.A++,0))}function WT(e){null!=e.B&&(pS.clearTimeout(e.B),e.B=null)}function jT(e){e.g=new pO(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=LO(e.oa);$O(t,"RID","rpc"),$O(t,"SID",e.J),$O(t,"CI",e.N?"0":"1"),$O(t,"AID",e.U),HT(e,t),$O(t,"TYPE","xmlhttp"),e.o&&e.s&&xT(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=zO(LO(t)),n.s=null,n.U=!0,_O(n,e)}function YT(e){null!=e.v&&(pS.clearTimeout(e.v),e.v=null)}function KT(e,t){var n=null;if(e.g==t){YT(e),WT(e),e.g=null;var r=2}else{if(!aT(e.i,t))return;n=t.D,cT(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;Tb(r=Xb(),new rO(r,n,t,i)),$T(e)}else ZT(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(oT(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=iO(wS(e.Ha,e,t),QT(e,e.C)),e.C++,0)))}(e,t)||2==r&&qT(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:XT(e,5);break;case 4:XT(e,10);break;case 3:XT(e,6);break;default:XT(e,2)}}function QT(e,t){let n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function XT(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=wS(e.jb,e);n||(n=new DO("//www.google.com/images/cleardot.gif"),pS.location&&"http"==pS.location.protocol||FO(n,"https"),zO(n)),function(e,t){const n=new jb;if(pS.Image){const r=new Image;r.onload=PS(pT,n,r,"TestLoadImage: loaded",!0,t),r.onerror=PS(pT,n,r,"TestLoadImage: error",!1,t),r.onabort=PS(pT,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=PS(pT,n,r,"TestLoadImage: timeout",!1,t),pS.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else nO(2);e.G=0,e.j&&e.j.va(t),JT(e),VT(e)}function JT(e){e.G=0,e.I=-1,e.j&&((0!=uT(e.i).length||0!=e.l.length)&&(e.i.i.length=0,AS(e.l),e.l.length=0),e.j.ua())}function eI(e,t,n){let r=function(e){return e instanceof DO?LO(e):new DO(e,void 0)}(n);if(""!=r.i)t&&UO(r,t+"."+r.i),VO(r,r.m);else{const e=pS.location;r=function(e,t,n,r){var i=new DO(null,void 0);return e&&FO(i,e),t&&UO(i,t),n&&VO(i,n),r&&(i.l=r),i}(e.protocol,t?t+"."+e.hostname:e.hostname,+e.port,n)}return e.aa&&US(e.aa,function(e,t){$O(r,t,e)}),n=e.sa,(t=e.D)&&n&&$O(r,t,n),$O(r,"VER",e.ma),HT(e,r),r}function tI(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new wT(n&&e.Ba&&!e.qa?new gT({ib:!0}):e.qa)).L=e.H,t}function nI(){}function rI(){if(ZS&&!(10<=Number(nb)))throw Error("Environmental error: no available transport.")}function iI(e,t){Ob.call(this),this.g=new LT(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!MS(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!MS(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new aI(this)}function sI(e){hO.call(this);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function oI(){dO.call(this),this.status=1}function aI(e){this.g=e}(uS=wT.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():cO.g(),this.C=function(e){return e.h||(e.h=e.i())}(this.u?this.u:cO),this.g.onreadystatechange=wS(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(s){return void TT(this,s)}e=n||"";const i=new MO(this.headers);r&&AO(r,function(e,t){i.set(t,e)}),r=function(e){e:{var t=OT;const n=e.length,r="string"==typeof e?e.split(""):e;for(let i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=pS.FormData&&e instanceof pS.FormData,!(0<=TS(bT,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(e,t){this.g.setRequestHeader(t,e)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{MT(this),0<this.B&&((this.K=function(e){return ZS&&tb()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=wS(this.pa,this)):this.A=$b(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){TT(this,s)}},uS.pa=function(){void 0!==fS&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Tb(this,"timeout"),this.abort(8))},uS.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Tb(this,"complete"),Tb(this,"abort"),AT(this))},uS.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),AT(this,!0)),wT.Z.M.call(this)},uS.Fa=function(){this.s||(this.F||this.v||this.l?kT(this):this.cb())},uS.cb=function(){kT(this)},uS.ba=function(){try{return 2<NT(this)?this.g.status:-1}catch{return-1}},uS.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}},uS.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),ET(t)}},uS.Da=function(){return this.m},uS.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(uS=LT.prototype).ma=8,uS.G=1,uS.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch{}},uS.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const i=new pO(this,this.h,e,void 0);let s=this.s;if(this.P&&(s?(s=VS(s),$S(s,this.P)):s=this.P),null===this.o&&(i.H=s),this.ja)e:{for(var t=0,n=0;n<this.l.length;n++){var r=this.l[n];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.l.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=GT(this,i,t),$O(n=LO(this.F),"RID",e),$O(n,"CVER",22),this.D&&$O(n,"X-HTTP-Session-Id",this.D),HT(this,n),this.o&&s&&xT(n,this.o,s),lT(this.i,i),this.Ra&&$O(n,"TYPE","init"),this.ja?($O(n,"$req",t),$O(n,"SID","null"),i.$=!0,CO(i,n,null)):CO(i,n,t),this.G=2}}else 3==this.G&&(e?zT(this,e):0==this.l.length||sT(this.i)||zT(this))},uS.Ga=function(){if(this.u=null,jT(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=iO(wS(this.bb,this),e)}},uS.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,nO(10),UT(this),jT(this))},uS.ab=function(){null!=this.v&&(this.v=null,UT(this),qT(this),nO(19))},uS.jb=function(e){e?(this.h.info("Successfully pinged google.com"),nO(2)):(this.h.info("Failed to ping google.com"),nO(1))},(uS=nI.prototype).xa=function(){},uS.wa=function(){},uS.va=function(){},uS.ua=function(){},uS.Oa=function(){},rI.prototype.g=function(e,t){return new iI(e,t)},SS(iI,Ob),iI.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),Db(wS(e.hb,e,t))),nO(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=eI(e,null,e.W),$T(e)},iI.prototype.close=function(){FT(this.g)},iI.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,BT(this.g,t)}else this.v?((t={}).__data__=kb(e),BT(this.g,t)):BT(this.g,e)},iI.prototype.M=function(){this.g.j=null,delete this.j,FT(this.g),delete this.g,iI.Z.M.call(this)},SS(sI,hO),SS(oI,dO),SS(aI,nI),aI.prototype.xa=function(){Tb(this.g,"a")},aI.prototype.wa=function(e){Tb(this.g,new sI(e))},aI.prototype.va=function(e){Tb(this.g,new oI(e))},aI.prototype.ua=function(){Tb(this.g,"b")},rI.prototype.createWebChannel=rI.prototype.g,iI.prototype.send=iI.prototype.u,iI.prototype.open=iI.prototype.m,iI.prototype.close=iI.prototype.close,sO.NO_ERROR=0,sO.TIMEOUT=8,sO.HTTP_ERROR=6,oO.COMPLETE="complete",lO.EventType=uO,uO.OPEN="a",uO.CLOSE="b",uO.ERROR="c",uO.MESSAGE="d",Ob.prototype.listen=Ob.prototype.N,wT.prototype.listenOnce=wT.prototype.O,wT.prototype.getLastError=wT.prototype.La,wT.prototype.getLastErrorCode=wT.prototype.Da,wT.prototype.getStatus=wT.prototype.ba,wT.prototype.getResponseJson=wT.prototype.Qa,wT.prototype.getResponseText=wT.prototype.ga,wT.prototype.send=wT.prototype.ea;var lI=dS.createWebChannelTransport=function(){return new rI},cI=dS.getStatEventTarget=function(){return Xb()},uI=dS.ErrorCode=sO,hI=dS.EventType=oO,dI=dS.Event=Kb,fI=dS.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},pI=dS.FetchXmlHttpFactory=gT,gI=dS.WebChannel=lO,mI=dS.XhrIo=wT;const yI="@firebase/firestore";class vI{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}vI.UNAUTHENTICATED=new vI(null),vI.GOOGLE_CREDENTIALS=new vI("google-credentials-uid"),vI.FIRST_PARTY=new vI("first-party-uid"),vI.MOCK_USER=new vI("mock-user");let CI="9.9.0";const _I=new yP("@firebase/firestore");function EI(){return _I.logLevel}function wI(e,...t){if(_I.logLevel<=dP.DEBUG){const n=t.map(bI);_I.debug(`Firestore (${CI}): ${e}`,...n)}}function PI(e,...t){if(_I.logLevel<=dP.ERROR){const n=t.map(bI);_I.error(`Firestore (${CI}): ${e}`,...n)}}function SI(e,...t){if(_I.logLevel<=dP.WARN){const n=t.map(bI);_I.warn(`Firestore (${CI}): ${e}`,...n)}}function bI(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch{return e}}function OI(e="Unexpected state"){const t=`FIRESTORE (${CI}) INTERNAL ASSERTION FAILED: `+e;throw PI(t),new Error(t)}function TI(e,t){e||OI()}function II(e,t){return e}const kI={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class AI extends Yw{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class MI{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class NI{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class RI{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(vI.UNAUTHENTICATED))}shutdown(){}}class xI{constructor(e){this.t=e,this.currentUser=vI.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var n=this;let r=this.i;const i=e=>this.i!==r?(r=this.i,t(e)):Promise.resolve();let s=new MI;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new MI,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const t=s;e.enqueueRetryable(Ow(function*(){yield t.promise,yield i(n.currentUser)}))},a=e=>{wI("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?a(e):(wI("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new MI)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(wI("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(TI("string"==typeof t.accessToken),new NI(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return TI(null===e||"string"==typeof e),new vI(e)}}class DI{constructor(e,t,n){this.type="FirstParty",this.user=vI.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",t);const r=e.auth.getAuthHeaderValueForFirstParty([]);r&&this.headers.set("Authorization",r),n&&this.headers.set("X-Goog-Iam-Authorization-Token",n)}}class LI{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new DI(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(vI.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class FI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class UI{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,t){const n=e=>{null!=e.error&&wI("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.p;return this.p=e.token,wI("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{wI("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.g.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.g.getImmediate({optional:!0});e?r(e):wI("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(TI("string"==typeof e.token),this.p=e.token,new FI(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function VI(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class BI{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const r=VI(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length))}return n}}function $I(e,t){return e<t?-1:e>t?1:0}function zI(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}class HI{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new AI(kI.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new AI(kI.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new AI(kI.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new AI(kI.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return HI.fromMillis(Date.now())}static fromDate(e){return HI.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new HI(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?$I(this.nanoseconds,e.nanoseconds):$I(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class GI{constructor(e){this.timestamp=e}static fromTimestamp(e){return new GI(e)}static min(){return new GI(new HI(0,0))}static max(){return new GI(new HI(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class ZI{constructor(e,t,n){void 0===t?t=0:t>e.length&&OI(),void 0===n?n=e.length-t:n>e.length-t&&OI(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===ZI.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ZI?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class qI extends ZI{construct(e,t,n){return new qI(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new AI(kI.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(e=>e.length>0))}return new qI(t)}static emptyPath(){return new qI([])}}const WI=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class jI extends ZI{construct(e,t,n){return new jI(e,t,n)}static isValidIdentifier(e){return WI.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),jI.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new jI(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new AI(kI.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new AI(kI.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new AI(kI.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new AI(kI.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new jI(t)}static emptyPath(){return new jI([])}}class YI{constructor(e){this.path=e}static fromPath(e){return new YI(qI.fromString(e))}static fromName(e){return new YI(qI.fromString(e).popFirst(5))}static empty(){return new YI(qI.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===qI.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return qI.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new YI(new qI(e.slice()))}}function KI(e){return new QI(e.readTime,e.key,-1)}class QI{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new QI(GI.min(),YI.empty(),-1)}static max(){return new QI(GI.max(),YI.empty(),-1)}}function XI(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=YI.comparator(e.documentKey,t.documentKey),0!==n?n:$I(e.largestBatchId,t.largestBatchId))}const JI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";function ek(e){return tk.apply(this,arguments)}function tk(){return tk=Ow(function*(e){if(e.code!==kI.FAILED_PRECONDITION||e.message!==JI)throw e;wI("LocalStore","Unexpectedly lost primary lease")}),tk.apply(this,arguments)}class nk{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&OI(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new nk((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof nk?t:nk.resolve(t)}catch(t){return nk.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):nk.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):nk.reject(t)}static resolve(e){return new nk((t,n)=>{t(e)})}static reject(e){return new nk((t,n)=>{n(e)})}static waitFor(e){return new nk((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=nk.resolve(!1);for(const n of e)t=t.next(e=>e?nk.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new nk((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next(e=>{s[l]=e,++o,o===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new nk((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}function rk(e){return"IndexedDbTransactionError"===e.name}class ik{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.it(e),this.rt=e=>t.writeSequenceNumber(e))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}function sk(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function ok(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function ak(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}ik.ot=-1;class lk{constructor(e,t){this.comparator=e,this.root=t||uk.EMPTY}insert(e,t){return new lk(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,uk.BLACK,null,null))}remove(e){return new lk(this.comparator,this.root.remove(e,this.comparator).copy(null,null,uk.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ck(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ck(this.root,e,this.comparator,!1)}getReverseIterator(){return new ck(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ck(this.root,e,this.comparator,!0)}}class ck{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class uk{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=n??uk.RED,this.left=r??uk.EMPTY,this.right=i??uk.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new uk(e??this.key,t??this.value,n??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return uk.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return uk.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,uk.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,uk.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw OI();const e=this.left.check();if(e!==this.right.check())throw OI();return e+(this.isRed()?0:1)}}uk.EMPTY=null,uk.RED=!0,uk.BLACK=!1,uk.EMPTY=new class{constructor(){this.size=0}get key(){throw OI()}get value(){throw OI()}get color(){throw OI()}get left(){throw OI()}get right(){throw OI()}copy(e,t,n,r,i){return this}insert(e,t,n){return new uk(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class hk{constructor(e){this.comparator=e,this.data=new lk(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new dk(this.data.getIterator())}getIteratorFrom(e){return new dk(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof hk)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new hk(this.comparator);return t.data=e,t}}class dk{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class fk{constructor(e){this.fields=e,e.sort(jI.comparator)}static empty(){return new fk([])}unionWith(e){let t=new hk(jI.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new fk(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return zI(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class pk{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new pk(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new pk(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $I(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}pk.EMPTY_BYTE_STRING=new pk("");const gk=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mk(e){if(TI(!!e),"string"==typeof e){let t=0;const n=gk.exec(e);if(TI(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:yk(e.seconds),nanos:yk(e.nanos)}}function yk(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function vk(e){return"string"==typeof e?pk.fromBase64String(e):pk.fromUint8Array(e)}function Ck(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function _k(e){const t=e.mapValue.fields.__previous_value__;return Ck(t)?_k(t):t}function Ek(e){const t=mk(e.mapValue.fields.__local_write_time__.timestampValue);return new HI(t.seconds,t.nanos)}class wk{constructor(e,t,n,r,i,s,o,a){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class Pk{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Pk("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Pk&&e.projectId===this.projectId&&e.database===this.database}}function Sk(e){return null==e}function bk(e){return 0===e&&1/e==-1/0}const Ok={fields:{__type__:{stringValue:"__max__"}}};function Tk(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ck(e)?4:$k(e)?9007199254740991:10:OI()}function Ik(e,t){if(e===t)return!0;const n=Tk(e);if(n!==Tk(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Ek(e).isEqual(Ek(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=mk(e.timestampValue),r=mk(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return r=t,vk(e.bytesValue).isEqual(vk(r.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return yk(e.geoPointValue.latitude)===yk(t.geoPointValue.latitude)&&yk(e.geoPointValue.longitude)===yk(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return yk(e.integerValue)===yk(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=yk(e.doubleValue),r=yk(t.doubleValue);return n===r?bk(n)===bk(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return zI(e.arrayValue.values||[],t.arrayValue.values||[],Ik);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(sk(n)!==sk(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Ik(n[i],r[i])))return!1;return!0}(e,t);default:return OI()}var r}function kk(e,t){return void 0!==(e.values||[]).find(e=>Ik(e,t))}function Ak(e,t){if(e===t)return 0;const n=Tk(e),r=Tk(t);if(n!==r)return $I(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return $I(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=yk(e.integerValue||e.doubleValue),r=yk(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Mk(e.timestampValue,t.timestampValue);case 4:return Mk(Ek(e),Ek(t));case 5:return $I(e.stringValue,t.stringValue);case 6:return function(e,t){const n=vk(e),r=vk(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=$I(n[i],r[i]);if(0!==e)return e}return $I(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=$I(yk(e.latitude),yk(t.latitude));return 0!==n?n:$I(yk(e.longitude),yk(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=Ak(n[i],r[i]);if(e)return e}return $I(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Ok&&t===Ok)return 0;if(e===Ok)return 1;if(t===Ok)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=$I(r[o],s[o]);if(0!==e)return e;const t=Ak(n[r[o]],i[s[o]]);if(0!==t)return t}return $I(r.length,s.length)}(e.mapValue,t.mapValue);default:throw OI()}}function Mk(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return $I(e,t);const n=mk(e),r=mk(t),i=$I(n.seconds,r.seconds);return 0!==i?i:$I(n.nanos,r.nanos)}function Nk(e){return Rk(e)}function Rk(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=mk(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?vk(e.bytesValue).toBase64():"referenceValue"in e?YI.fromName(e.referenceValue).toString():"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Rk(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${Rk(e.fields[i])}`;return n+"}"}(e.mapValue):OI();var t}function xk(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Dk(e){return!!e&&"integerValue"in e}function Lk(e){return!!e&&"arrayValue"in e}function Fk(e){return!!e&&"nullValue"in e}function Uk(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Vk(e){return!!e&&"mapValue"in e}function Bk(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return ok(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=Bk(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Bk(e.arrayValue.values[n]);return t}return Object.assign({},e)}function $k(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class zk{constructor(e){this.value=e}static empty(){return new zk({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Vk(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Bk(t)}setAll(e){let t=jI.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Bk(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Vk(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ik(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Vk(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){ok(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new zk(Bk(this.value))}}function Hk(e){const t=[];return ok(e.fields,(e,n)=>{const r=new jI([e]);if(Vk(n)){const e=Hk(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new fk(t)}class Gk{constructor(e,t,n,r,i,s){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.data=i,this.documentState=s}static newInvalidDocument(e){return new Gk(e,0,GI.min(),GI.min(),zk.empty(),0)}static newFoundDocument(e,t,n){return new Gk(e,1,t,GI.min(),n,0)}static newNoDocument(e,t){return new Gk(e,2,t,GI.min(),zk.empty(),0)}static newUnknownDocument(e,t){return new Gk(e,3,t,GI.min(),zk.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=zk.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=zk.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=GI.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Gk&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Gk(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Zk{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ut=null}}function qk(e,t=null,n=[],r=[],i=null,s=null,o=null){return new Zk(e,t,n,r,i,s,o)}function Wk(e){const t=II(e);if(null===t.ut){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>{return(t=e).field.canonicalString()+t.op.toString()+Nk(t.value);var t}).join(","),e+="|ob:",e+=t.orderBy.map(e=>{return(t=e).field.canonicalString()+t.dir;var t}).join(","),Sk(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>Nk(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>Nk(e)).join(",")),t.ut=e}return t.ut}function jk(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let i=0;i<e.orderBy.length;i++)if(!aA(e.orderBy[i],t.orderBy[i]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let i=0;i<e.filters.length;i++)if((n=e.filters[i]).op!==(r=t.filters[i]).op||!n.field.isEqual(r.field)||!Ik(n.value,r.value))return!1;var n,r;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!cA(e.startAt,t.startAt)&&cA(e.endAt,t.endAt)}function Yk(e){return YI.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Kk extends class{}{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,n):new Qk(e,t,n):"array-contains"===t?new tA(e,n):"in"===t?new nA(e,n):"not-in"===t?new rA(e,n):"array-contains-any"===t?new iA(e,n):new Kk(e,t,n)}static ct(e,t,n){return"in"===t?new Xk(e,n):new Jk(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(Ak(t,this.value)):null!==t&&Tk(this.value)===Tk(t)&&this.at(Ak(t,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return OI()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Qk extends Kk{constructor(e,t,n){super(e,t,n),this.key=YI.fromName(n.referenceValue)}matches(e){const t=YI.comparator(e.key,this.key);return this.at(t)}}class Xk extends Kk{constructor(e,t){super(e,"in",t),this.keys=eA(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Jk extends Kk{constructor(e,t){super(e,"not-in",t),this.keys=eA(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function eA(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>YI.fromName(e.referenceValue))}class tA extends Kk{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Lk(t)&&kk(t.arrayValue,this.value)}}class nA extends Kk{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&kk(this.value.arrayValue,t)}}class rA extends Kk{constructor(e,t){super(e,"not-in",t)}matches(e){if(kk(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!kk(this.value.arrayValue,t)}}class iA extends Kk{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Lk(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>kk(this.value.arrayValue,e))}}class sA{constructor(e,t){this.position=e,this.inclusive=t}}class oA{constructor(e,t="asc"){this.field=e,this.dir=t}}function aA(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function lA(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?YI.comparator(YI.fromName(o.referenceValue),n.key):Ak(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function cA(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Ik(e.position[n],t.position[n]))return!1;return!0}class uA{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.lt=null,this.ft=null}}function hA(e){return new uA(e)}function dA(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function fA(e){for(const t of e.filters)if(t.ht())return t.field;return null}function pA(e){return null!==e.collectionGroup}function gA(e){const t=II(e);if(null===t.lt){t.lt=[];const e=fA(t),n=dA(t);if(null!==e&&null===n)e.isKeyField()||t.lt.push(new oA(e)),t.lt.push(new oA(jI.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.lt.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.lt.push(new oA(jI.keyField(),e))}}}return t.lt}function mA(e){const t=II(e);if(!t.ft)if("F"===t.limitType)t.ft=qk(t.path,t.collectionGroup,gA(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const i of gA(t))e.push(new oA(i.field,"desc"===i.dir?"asc":"desc"));const n=t.endAt?new sA(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new sA(t.startAt.position,t.startAt.inclusive):null;t.ft=qk(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t.ft}function yA(e,t,n){return new uA(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function vA(e,t){return jk(mA(e),mA(t))&&e.limitType===t.limitType}function CA(e){return`${Wk(mA(e))}|lt:${e.limitType}`}function _A(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>{return`${(t=e).field.canonicalString()} ${t.op} ${Nk(t.value)}`;var t}).join(", ")}]`),Sk(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>{return`${(t=e).field.canonicalString()} (${t.dir})`;var t}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>Nk(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>Nk(e)).join(",")),`Target(${t})`}(mA(e))}; limitType=${e.limitType})`}function EA(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):YI.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of e.explicitOrderBy)if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&(r=t,!((n=e).startAt&&!function(e,t,n){const r=lA(e,t,n);return e.inclusive?r<=0:r<0}(n.startAt,gA(n),r)||n.endAt&&!function(e,t,n){const r=lA(e,t,n);return e.inclusive?r>=0:r>0}(n.endAt,gA(n),r)));var n,r}function wA(e){return(t,n)=>{let r=!1;for(const i of gA(e)){const e=PA(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function PA(e,t,n){const r=e.field.isKeyField()?YI.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?Ak(r,i):OI()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return OI()}}function SA(e,t){if(e.dt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bk(t)?"-0":t}}function bA(e){return{integerValue:""+e}}function OA(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!bk(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?bA(t):SA(e,t)}class TA{constructor(){this._=void 0}}function IA(e,t,n){return e instanceof MA?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof NA?RA(e,t):e instanceof xA?DA(e,t):function(e,t){const n=AA(e,t),r=FA(n)+FA(e._t);return Dk(n)&&Dk(e._t)?bA(r):SA(e.wt,r)}(e,t)}function kA(e,t,n){return e instanceof NA?RA(e,t):e instanceof xA?DA(e,t):n}function AA(e,t){return e instanceof LA?Dk(r=t)||(n=r)&&"doubleValue"in n?t:{integerValue:0}:null;var n,r}class MA extends TA{}class NA extends TA{constructor(e){super(),this.elements=e}}function RA(e,t){const n=UA(t);for(const r of e.elements)n.some(e=>Ik(e,r))||n.push(r);return{arrayValue:{values:n}}}class xA extends TA{constructor(e){super(),this.elements=e}}function DA(e,t){let n=UA(t);for(const r of e.elements)n=n.filter(e=>!Ik(e,r));return{arrayValue:{values:n}}}class LA extends TA{constructor(e,t){super(),this.wt=e,this._t=t}}function FA(e){return yk(e.integerValue||e.doubleValue)}function UA(e){return Lk(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class VA{constructor(e,t){this.field=e,this.transform=t}}class BA{constructor(e,t){this.version=e,this.transformResults=t}}class $A{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new $A}static exists(e){return new $A(void 0,e)}static updateTime(e){return new $A(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function zA(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class HA{}function GA(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new eM(e.key,$A.none()):new YA(e.key,e.data,$A.none());{const n=e.data,r=zk.empty();let i=new hk(jI.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new KA(e.key,r,new fk(i.toArray()),$A.none())}}function ZA(e,t,n){e instanceof YA?function(e,t,n){const r=e.value.clone(),i=XA(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof KA?function(e,t,n){if(!zA(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=XA(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(QA(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):t.convertToNoDocument(n.version).setHasCommittedMutations()}function qA(e,t,n,r){return e instanceof YA?function(e,t,n,r){if(!zA(e.precondition,t))return n;const i=e.value.clone(),s=JA(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof KA?function(e,t,n,r){if(!zA(e.precondition,t))return n;const i=JA(e.fieldTransforms,r,t),s=t.data;return s.setAll(QA(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):(s=n,zA(e.precondition,i=t)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):s);var i,s}function WA(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=AA(r.transform,e||null);null!=i&&(null===n&&(n=zk.empty()),n.set(r.field,i))}return n||null}function jA(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(n=e.fieldTransforms)&&void 0===r||n&&r&&zI(n,r,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&(r=t.transform,(n=e.transform)instanceof NA&&r instanceof NA||n instanceof xA&&r instanceof xA?zI(n.elements,r.elements,Ik):n instanceof LA&&r instanceof LA?Ik(n._t,r._t):n instanceof MA&&r instanceof MA);var n,r}(e,t))))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var n,r}class YA extends HA{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class KA extends HA{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function QA(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function XA(e,t,n){const r=new Map;TI(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,kA(o,a,n[i]))}return r}function JA(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,IA(e,s,t))}return r}class eM extends HA{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class tM extends HA{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class nM{constructor(e){this.count=e}}var rM,iM;function sM(e){switch(e){default:return OI();case kI.CANCELLED:case kI.UNKNOWN:case kI.DEADLINE_EXCEEDED:case kI.RESOURCE_EXHAUSTED:case kI.INTERNAL:case kI.UNAVAILABLE:case kI.UNAUTHENTICATED:return!1;case kI.INVALID_ARGUMENT:case kI.NOT_FOUND:case kI.ALREADY_EXISTS:case kI.PERMISSION_DENIED:case kI.FAILED_PRECONDITION:case kI.ABORTED:case kI.OUT_OF_RANGE:case kI.UNIMPLEMENTED:case kI.DATA_LOSS:return!0}}function oM(e){if(void 0===e)return PI("GRPC error has no .code"),kI.UNKNOWN;switch(e){case rM.OK:return kI.OK;case rM.CANCELLED:return kI.CANCELLED;case rM.UNKNOWN:return kI.UNKNOWN;case rM.DEADLINE_EXCEEDED:return kI.DEADLINE_EXCEEDED;case rM.RESOURCE_EXHAUSTED:return kI.RESOURCE_EXHAUSTED;case rM.INTERNAL:return kI.INTERNAL;case rM.UNAVAILABLE:return kI.UNAVAILABLE;case rM.UNAUTHENTICATED:return kI.UNAUTHENTICATED;case rM.INVALID_ARGUMENT:return kI.INVALID_ARGUMENT;case rM.NOT_FOUND:return kI.NOT_FOUND;case rM.ALREADY_EXISTS:return kI.ALREADY_EXISTS;case rM.PERMISSION_DENIED:return kI.PERMISSION_DENIED;case rM.FAILED_PRECONDITION:return kI.FAILED_PRECONDITION;case rM.ABORTED:return kI.ABORTED;case rM.OUT_OF_RANGE:return kI.OUT_OF_RANGE;case rM.UNIMPLEMENTED:return kI.UNIMPLEMENTED;case rM.DATA_LOSS:return kI.DATA_LOSS;default:return OI()}}(iM=rM||(rM={}))[iM.OK=0]="OK",iM[iM.CANCELLED=1]="CANCELLED",iM[iM.UNKNOWN=2]="UNKNOWN",iM[iM.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",iM[iM.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",iM[iM.NOT_FOUND=5]="NOT_FOUND",iM[iM.ALREADY_EXISTS=6]="ALREADY_EXISTS",iM[iM.PERMISSION_DENIED=7]="PERMISSION_DENIED",iM[iM.UNAUTHENTICATED=16]="UNAUTHENTICATED",iM[iM.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",iM[iM.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",iM[iM.ABORTED=10]="ABORTED",iM[iM.OUT_OF_RANGE=11]="OUT_OF_RANGE",iM[iM.UNIMPLEMENTED=12]="UNIMPLEMENTED",iM[iM.INTERNAL=13]="INTERNAL",iM[iM.UNAVAILABLE=14]="UNAVAILABLE",iM[iM.DATA_LOSS=15]="DATA_LOSS";class aM{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ok(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return ak(this.inner)}size(){return this.innerSize}}const lM=new lk(YI.comparator);function cM(){return lM}const uM=new lk(YI.comparator);function hM(...e){let t=uM;for(const n of e)t=t.insert(n.key,n);return t}function dM(e){let t=uM;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function fM(){return gM()}function pM(){return gM()}function gM(){return new aM(e=>e.toString(),(e,t)=>e.isEqual(t))}const mM=new lk(YI.comparator),yM=new hk(YI.comparator);function vM(...e){let t=yM;for(const n of e)t=t.add(n);return t}const CM=new hk($I);function _M(){return CM}class EM{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t){const n=new Map;return n.set(e,wM.createSynthesizedTargetChangeForCurrentChange(e,t)),new EM(GI.min(),n,_M(),cM(),vM())}}class wM{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t){return new wM(pk.EMPTY_BYTE_STRING,t,vM(),vM(),vM())}}class PM{constructor(e,t,n,r){this.gt=e,this.removedTargetIds=t,this.key=n,this.yt=r}}class SM{constructor(e,t){this.targetId=e,this.It=t}}class bM{constructor(e,t,n=pk.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class OM{constructor(){this.Tt=0,this.Et=kM(),this.At=pk.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return 0!==this.Tt}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=vM(),t=vM(),n=vM();return this.Et.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:OI()}}),new wM(this.At,this.Rt,e,t,n)}Dt(){this.bt=!1,this.Et=kM()}Ct(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Ot(){this.bt=!0,this.Rt=!0}}class TM{constructor(e){this.Mt=e,this.Ft=new Map,this.$t=cM(),this.Bt=IM(),this.Lt=new hk($I)}Ut(e){for(const t of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(t,e.yt):this.Kt(t,e.key,e.yt);for(const t of e.removedTargetIds)this.Kt(t,e.key,e.yt)}Gt(e){this.forEachTarget(e,t=>{const n=this.Qt(t);switch(e.state){case 0:this.jt(t)&&n.Vt(e.resumeToken);break;case 1:n.kt(),n.Pt||n.Dt(),n.Vt(e.resumeToken);break;case 2:n.kt(),n.Pt||this.removeTarget(t);break;case 3:this.jt(t)&&(n.Ot(),n.Vt(e.resumeToken));break;case 4:this.jt(t)&&(this.Wt(t),n.Vt(e.resumeToken));break;default:OI()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach((e,n)=>{this.jt(n)&&t(n)})}zt(e){const t=e.targetId,n=e.It.count,r=this.Ht(t);if(r){const e=r.target;if(Yk(e))if(0===n){const n=new YI(e.path);this.Kt(t,n,Gk.newNoDocument(n,GI.min()))}else TI(1===n);else this.Jt(t)!==n&&(this.Wt(t),this.Lt=this.Lt.add(t))}}Yt(e){const t=new Map;this.Ft.forEach((n,r)=>{const i=this.Ht(r);if(i){if(n.current&&Yk(i.target)){const t=new YI(i.target.path);null!==this.$t.get(t)||this.Xt(r,t)||this.Kt(r,t,Gk.newNoDocument(t,e))}n.vt&&(t.set(r,n.St()),n.Dt())}});let n=vM();this.Bt.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.Ht(e);return!t||2===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.$t.forEach((t,n)=>n.setReadTime(e));const r=new EM(e,t,this.Lt,this.$t,n);return this.$t=cM(),this.Bt=IM(),this.Lt=new hk($I),r}qt(e,t){if(!this.jt(e))return;const n=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,n),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}Kt(e,t,n){if(!this.jt(e))return;const r=this.Qt(e);this.Xt(e,t)?r.Ct(t,1):r.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),n&&(this.$t=this.$t.insert(t,n))}removeTarget(e){this.Ft.delete(e)}Jt(e){const t=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let t=this.Ft.get(e);return t||(t=new OM,this.Ft.set(e,t)),t}Zt(e){let t=this.Bt.get(e);return t||(t=new hk($I),this.Bt=this.Bt.insert(e,t)),t}jt(e){const t=null!==this.Ht(e);return t||wI("WatchChangeAggregator","Detected inactive target",e),t}Ht(e){const t=this.Ft.get(e);return t&&t.Pt?null:this.Mt.te(e)}Wt(e){this.Ft.set(e,new OM),this.Mt.getRemoteKeysForTarget(e).forEach(t=>{this.Kt(e,t,null)})}Xt(e,t){return this.Mt.getRemoteKeysForTarget(e).has(t)}}function IM(){return new lk(YI.comparator)}function kM(){return new lk(YI.comparator)}const AM={asc:"ASCENDING",desc:"DESCENDING"},MM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class NM{constructor(e,t){this.databaseId=e,this.dt=t}}function RM(e,t){return e.dt?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function xM(e,t){return e.dt?t.toBase64():t.toUint8Array()}function DM(e,t){return RM(e,t.toTimestamp())}function LM(e){return TI(!!e),GI.fromTimestamp(function(e){const t=mk(e);return new HI(t.seconds,t.nanos)}(e))}function FM(e,t){return(n=e,new qI(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function UM(e){const t=qI.fromString(e);return TI(nN(t)),t}function VM(e,t){return FM(e.databaseId,t.path)}function BM(e,t){const n=UM(t);if(n.get(1)!==e.databaseId.projectId)throw new AI(kI.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new AI(kI.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new YI(HM(n))}function $M(e,t){return FM(e.databaseId,t)}function zM(e){return new qI(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function HM(e){return TI(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function GM(e,t,n){return{name:VM(e,t),fields:n.value.mapValue.fields}}function ZM(e,t){return{documents:[$M(e,t.path)]}}function qM(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=$M(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=$M(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(e){if(0===e.length)return;const t=e.map(e=>function(e){if("=="===e.op){if(Uk(e.value))return{unaryFilter:{field:QM(e.field),op:"IS_NAN"}};if(Fk(e.value))return{unaryFilter:{field:QM(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Uk(e.value))return{unaryFilter:{field:QM(e.field),op:"IS_NOT_NAN"}};if(Fk(e.value))return{unaryFilter:{field:QM(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:QM(e.field),op:KM(e.op),value:e.value}}}(e));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map(e=>{return{field:QM((t=e).field),direction:YM(t.dir)};var t})}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=(a=t.limit,e.dt||Sk(a)?a:{value:a});var a,l,c;return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt={before:(l=t.startAt).inclusive,values:l.position}),t.endAt&&(n.structuredQuery.endAt={before:!(c=t.endAt).inclusive,values:c.position}),n}function WM(e){let t=function(e){const t=UM(e);return 4===t.length?qI.emptyPath():HM(t)}(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){TI(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=jM(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(e=>{return new oA(XM((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Sk(t)?null:t}(n.limit));let l=null;var c;n.startAt&&(l=new sA((c=n.startAt).values||[],!!c.before));let u=null;return n.endAt&&(u=function(e){return new sA(e.values||[],!e.before)}(n.endAt)),function(e,t,n,r,i,s,o,a){return new uA(e,t,n,r,i,s,o,a)}(t,i,o,s,a,"F",l,u)}function jM(e){return e?void 0!==e.unaryFilter?[eN(e)]:void 0!==e.fieldFilter?[JM(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(e=>jM(e)).reduce((e,t)=>e.concat(t)):OI():[]}function YM(e){return AM[e]}function KM(e){return MM[e]}function QM(e){return{fieldPath:e.canonicalString()}}function XM(e){return jI.fromServerFormat(e.fieldPath)}function JM(e){return Kk.create(XM(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return OI()}}(e.fieldFilter.op),e.fieldFilter.value)}function eN(e){switch(e.unaryFilter.op){case"IS_NAN":const t=XM(e.unaryFilter.field);return Kk.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=XM(e.unaryFilter.field);return Kk.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=XM(e.unaryFilter.field);return Kk.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=XM(e.unaryFilter.field);return Kk.create(i,"!=",{nullValue:"NULL_VALUE"});default:return OI()}}function tN(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function nN(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class rN{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&ZA(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=qA(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=qA(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=pM();return this.mutations.forEach(r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=GA(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(GI.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),vM())}isEqual(e){return this.batchId===e.batchId&&zI(this.mutations,e.mutations,(e,t)=>jA(e,t))&&zI(this.baseMutations,e.baseMutations,(e,t)=>jA(e,t))}}class iN{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){TI(e.mutations.length===n.length);let r=mM;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new iN(e,t,n,r)}}class sN{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class oN{constructor(e,t,n,r,i=GI.min(),s=GI.min(),o=pk.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}withSequenceNumber(e){return new oN(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new oN(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new oN(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class aN{constructor(e){this.ne=e}}function lN(e){const t=WM({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?yA(t,t.limit,"L"):t}class cN{constructor(){}re(e,t){this.oe(e,t),t.ue()}oe(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(yk(e.integerValue));else if("doubleValue"in e){const n=yk(e.doubleValue);isNaN(n)?this.ce(t,13):(this.ce(t,15),bk(n)?t.ae(0):t.ae(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ce(t,20),"string"==typeof n?t.he(n):(t.he(`${n.seconds||""}`),t.ae(n.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(vk(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ce(t,45),t.ae(n.latitude||0),t.ae(n.longitude||0)}else"mapValue"in e?$k(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):OI()}le(e,t){this.ce(t,25),this.ge(e,t)}ge(e,t){t.he(e)}we(e,t){const n=e.fields||{};this.ce(t,55);for(const r of Object.keys(n))this.le(r,t),this.oe(n[r],t)}me(e,t){const n=e.values||[];this.ce(t,50);for(const r of n)this.oe(r,t)}_e(e,t){this.ce(t,37),YI.fromName(e).path.forEach(e=>{this.ce(t,60),this.ge(e,t)})}ce(e,t){e.ae(t)}fe(e){e.ae(2)}}cN.ye=new cN;class uN{constructor(){this.ze=new hN}addToCollectionParentIndex(e,t){return this.ze.add(t),nk.resolve()}getCollectionParents(e,t){return nk.resolve(this.ze.getEntries(t))}addFieldIndex(e,t){return nk.resolve()}deleteFieldIndex(e,t){return nk.resolve()}getDocumentsMatchingTarget(e,t){return nk.resolve(null)}getIndexType(e,t){return nk.resolve(0)}getFieldIndexes(e,t){return nk.resolve([])}getNextCollectionGroupToUpdate(e){return nk.resolve(null)}getMinOffset(e,t){return nk.resolve(QI.min())}getMinOffsetFromCollectionGroup(e,t){return nk.resolve(QI.min())}updateCollectionGroup(e,t,n){return nk.resolve()}updateIndexEntries(e,t){return nk.resolve()}}class hN{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new hk(qI.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new hk(qI.comparator)).toArray()}}new Uint8Array(0);class dN{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new dN(e,dN.DEFAULT_COLLECTION_PERCENTILE,dN.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}dN.DEFAULT_COLLECTION_PERCENTILE=10,dN.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,dN.DEFAULT=new dN(41943040,dN.DEFAULT_COLLECTION_PERCENTILE,dN.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),dN.DISABLED=new dN(-1,0,0);class fN{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new fN(0)}static Rn(){return new fN(-1)}}class pN{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class gN{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.getBaseDocument(e,t,n))).next(e=>(null!==n&&qA(n.mutation,e,fk.empty(),HI.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,vM()).next(()=>t))}getLocalViewOfDocuments(e,t,n=vM()){const r=fM();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=hM();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=fM();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,vM()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=cM();const s=gM(),o=gM();return t.forEach((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof KA)?i=i.insert(t.key,t):void 0!==o&&(s.set(t.key,o.mutation.getFieldMask()),qA(o.mutation,t,o.mutation.getFieldMask(),HI.now()))}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return o.set(e,new pN(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(e,t){const n=gM();let r=new lk((e,t)=>e-t),i=vM();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||fk.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||vM()).add(e);r=r.insert(i.batchId,a)})}).next(()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,l=r.value,c=pM();l.forEach(e=>{if(!i.has(e)){const r=GA(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,a,c))}return nk.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n){return YI.isDocumentKey((r=t).path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):pA(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var r}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):nk.resolve(fM());let o=-1,a=i;return s.next(t=>nk.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?nk.resolve():this.getBaseDocument(e,t,n).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,a,t,vM())).next(e=>({batchId:o,changes:dM(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new YI(t)).next(e=>{let t=hM();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n){const r=t.collectionGroup;let i=hM();return this.indexManager.getCollectionParents(e,r).next(s=>nk.forEach(s,s=>{const o=(a=t,l=s.child(r),new uA(l,null,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt));var a,l;return this.getDocumentsMatchingCollectionQuery(e,o,n).next(e=>{e.forEach((e,t)=>{i=i.insert(e,t)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,n){let r;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next(i=>(r=i,this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId))).next(e=>{e.forEach((e,t)=>{const n=t.getKey();null===r.get(n)&&(r=r.insert(n,Gk.newInvalidDocument(n)))});let n=hM();return r.forEach((r,i)=>{const s=e.get(r);void 0!==s&&qA(s.mutation,i,fk.empty(),HI.now()),EA(t,i)&&(n=n.insert(r,i))}),n})}getBaseDocument(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):nk.resolve(Gk.newInvalidDocument(t))}}class mN{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,t){return nk.resolve(this.Jn.get(t))}saveBundleMetadata(e,t){var n;return this.Jn.set(t.id,{id:(n=t).id,version:n.version,createTime:LM(n.createTime)}),nk.resolve()}getNamedQuery(e,t){return nk.resolve(this.Yn.get(t))}saveNamedQuery(e,t){return this.Yn.set(t.name,{name:(n=t).name,query:lN(n.bundledQuery),readTime:LM(n.readTime)}),nk.resolve();var n}}class yN{constructor(){this.overlays=new lk(YI.comparator),this.Xn=new Map}getOverlay(e,t){return nk.resolve(this.overlays.get(t))}getOverlays(e,t){const n=fM();return nk.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.ie(e,t,r)}),nk.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Xn.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.Xn.delete(n)),nk.resolve()}getOverlaysForCollection(e,t,n){const r=fM(),i=t.length+1,s=new YI(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return nk.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new lk((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=fM(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=fM(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=r)););return nk.resolve(o)}ie(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Xn.get(r.largestBatchId).delete(n.key);this.Xn.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new sN(t,n));let i=this.Xn.get(t);void 0===i&&(i=vM(),this.Xn.set(t,i)),this.Xn.set(t,i.add(n.key))}}class vN{constructor(){this.Zn=new hk(CN.ts),this.es=new hk(CN.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,t){const n=new CN(e,t);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}ss(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.rs(new CN(e,t))}os(e,t){e.forEach(e=>this.removeReference(e,t))}us(e){const t=new YI(new qI([])),n=new CN(t,e),r=new CN(t,e+1),i=[];return this.es.forEachInRange([n,r],e=>{this.rs(e),i.push(e.key)}),i}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const t=new YI(new qI([])),n=new CN(t,e),r=new CN(t,e+1);let i=vM();return this.es.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new CN(e,0),n=this.Zn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class CN{constructor(e,t){this.key=e,this.ls=t}static ts(e,t){return YI.comparator(e.key,t.key)||$I(e.ls,t.ls)}static ns(e,t){return $I(e.ls,t.ls)||YI.comparator(e.key,t.key)}}class _N{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.fs=1,this.ds=new hk(CN.ts)}checkEmpty(e){return nk.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.fs;this.fs++;const s=new rN(i,t,n,r);this.mutationQueue.push(s);for(const o of r)this.ds=this.ds.add(new CN(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return nk.resolve(s)}lookupMutationBatch(e,t){return nk.resolve(this._s(t))}getNextMutationBatchAfterBatchId(e,t){const n=this.ws(t+1),r=n<0?0:n;return nk.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return nk.resolve(0===this.mutationQueue.length?-1:this.fs-1)}getAllMutationBatches(e){return nk.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new CN(t,0),r=new CN(t,Number.POSITIVE_INFINITY),i=[];return this.ds.forEachInRange([n,r],e=>{const t=this._s(e.ls);i.push(t)}),nk.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new hk($I);return t.forEach(e=>{const t=new CN(e,0),r=new CN(e,Number.POSITIVE_INFINITY);this.ds.forEachInRange([t,r],e=>{n=n.add(e.ls)})}),nk.resolve(this.gs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;YI.isDocumentKey(i)||(i=i.child(""));const s=new CN(new YI(i),0);let o=new hk($I);return this.ds.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.ls)),!0)},s),nk.resolve(this.gs(o))}gs(e){const t=[];return e.forEach(e=>{const n=this._s(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){TI(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();let n=this.ds;return nk.forEach(t.mutations,r=>{const i=new CN(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.ds=n})}In(e){}containsKey(e,t){const n=new CN(t,0),r=this.ds.firstAfterOrEqual(n);return nk.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return nk.resolve()}ys(e,t){return this.ws(e)}ws(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}_s(e){const t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class EN{constructor(e){this.ps=e,this.docs=new lk(YI.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.ps(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return nk.resolve(n?n.document.mutableCopy():Gk.newInvalidDocument(t))}getEntries(e,t){let n=cM();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Gk.newInvalidDocument(e))}),nk.resolve(n)}getAllFromCollection(e,t,n){let r=cM();const i=new YI(t.child("")),s=this.docs.getIteratorFrom(i);for(;s.hasNext();){const{key:e,value:{document:i}}=s.getNext();if(!t.isPrefixOf(e.path))break;e.path.length>t.length+1||XI(KI(i),n)<=0||(r=r.insert(i.key,i.mutableCopy()))}return nk.resolve(r)}getAllFromCollectionGroup(e,t,n,r){OI()}Is(e,t){return nk.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new wN(this)}getSize(e){return nk.resolve(this.size)}}class wN extends class{constructor(){this.changes=new aM(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Gk.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?nk.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}{constructor(e){super(),this.zn=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.zn.addEntry(e,r)):this.zn.removeEntry(n)}),nk.waitFor(t)}getFromCache(e,t){return this.zn.getEntry(e,t)}getAllFromCache(e,t){return this.zn.getEntries(e,t)}}class PN{constructor(e){this.persistence=e,this.Ts=new aM(e=>Wk(e),jk),this.lastRemoteSnapshotVersion=GI.min(),this.highestTargetId=0,this.Es=0,this.As=new vN,this.targetCount=0,this.Rs=fN.An()}forEachTarget(e,t){return this.Ts.forEach((e,n)=>t(n)),nk.resolve()}getLastRemoteSnapshotVersion(e){return nk.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return nk.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),nk.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Es&&(this.Es=t),nk.resolve()}vn(e){this.Ts.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Rs=new fN(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,t){return this.vn(t),this.targetCount+=1,nk.resolve()}updateTargetData(e,t){return this.vn(t),nk.resolve()}removeTargetData(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,nk.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Ts.forEach((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Ts.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),nk.waitFor(i).next(()=>r)}getTargetCount(e){return nk.resolve(this.targetCount)}getTargetData(e,t){const n=this.Ts.get(t)||null;return nk.resolve(n)}addMatchingKeys(e,t,n){return this.As.ss(t,n),nk.resolve()}removeMatchingKeys(e,t,n){this.As.os(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),nk.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.As.us(t),nk.resolve()}getMatchingKeysForTargetId(e,t){const n=this.As.hs(t);return nk.resolve(n)}containsKey(e,t){return nk.resolve(this.As.containsKey(t))}}class SN{constructor(e,t){this.bs={},this.overlays={},this.Ps=new ik(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new PN(this),this.indexManager=new uN,this.remoteDocumentCache=new EN(e=>this.referenceDelegate.Ss(e)),this.wt=new aN(t),this.Ds=new mN(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new yN,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.bs[e.toKey()];return n||(n=new _N(t,this.referenceDelegate),this.bs[e.toKey()]=n),n}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,t,n){wI("MemoryPersistence","Starting transaction:",e);const r=new bN(this.Ps.next());return this.referenceDelegate.Cs(),n(r).next(e=>this.referenceDelegate.xs(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ns(e,t){return nk.or(Object.values(this.bs).map(n=>()=>n.containsKey(e,t)))}}class bN extends class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}{constructor(e){super(),this.currentSequenceNumber=e}}class ON{constructor(e){this.persistence=e,this.ks=new vN,this.Os=null}static Ms(e){return new ON(e)}get Fs(){if(this.Os)return this.Os;throw OI()}addReference(e,t,n){return this.ks.addReference(n,t),this.Fs.delete(n.toString()),nk.resolve()}removeReference(e,t,n){return this.ks.removeReference(n,t),this.Fs.add(n.toString()),nk.resolve()}markPotentiallyOrphaned(e,t){return this.Fs.add(t.toString()),nk.resolve()}removeTarget(e,t){this.ks.us(t.targetId).forEach(e=>this.Fs.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.Fs.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Cs(){this.Os=new Set}xs(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return nk.forEach(this.Fs,n=>{const r=YI.fromPath(n);return this.$s(e,r).next(e=>{e||t.removeEntry(r,GI.min())})}).next(()=>(this.Os=null,t.apply(e)))}updateLimboDocument(e,t){return this.$s(e,t).next(e=>{e?this.Fs.delete(t.toString()):this.Fs.add(t.toString())})}Ss(e){return 0}$s(e,t){return nk.or([()=>nk.resolve(this.ks.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ns(e,t)])}}class TN{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Pi=n,this.vi=r}static Vi(e,t){let n=vM(),r=vM();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new TN(e,t.fromCache,n,r)}}class IN{constructor(){this.Si=!1}initialize(e,t){this.Di=e,this.indexManager=t,this.Si=!0}getDocumentsMatchingQuery(e,t,n,r){return this.Ci(e,t).next(i=>i||this.xi(e,t,r,n)).next(n=>n||this.Ni(e,t))}Ci(e,t){return nk.resolve(null)}xi(e,t,n,r){return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||r.isEqual(GI.min())?this.Ni(e,t):this.Di.getDocuments(e,n).next(i=>{const s=this.ki(t,i);return this.Oi(t,s,n,r)?this.Ni(e,t):(EI()<=dP.DEBUG&&wI("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),_A(t)),this.Mi(e,s,t,function(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=GI.fromTimestamp(1e9===r?new HI(n+1,0):new HI(n,r));return new QI(i,YI.empty(),t)}(r,-1)))})}ki(e,t){let n=new hk(wA(e));return t.forEach((t,r)=>{EA(e,r)&&(n=n.add(r))}),n}Oi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ni(e,t){return EI()<=dP.DEBUG&&wI("QueryEngine","Using full collection scan to execute query:",_A(t)),this.Di.getDocumentsMatchingQuery(e,t,QI.min())}Mi(e,t,n,r){return this.Di.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}class kN{constructor(e,t,n,r){this.persistence=e,this.Fi=t,this.wt=r,this.$i=new lk($I),this.Bi=new aM(e=>Wk(e),jk),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(n)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new gN(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.$i))}}function AN(e,t){return MN.apply(this,arguments)}function MN(){return MN=Ow(function*(e,t){const n=II(e);return yield n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.qi(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],s=[];let o=vM();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({Ki:e,removedBatchIds:i,addedBatchIds:s}))})})}),MN.apply(this,arguments)}function NN(e,t){const n=II(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.Ui.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=nk.resolve();return s.forEach(e=>{o=o.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);TI(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=vM();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}function RN(e){const t=II(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Vs.getLastRemoteSnapshotVersion(e))}function xN(e,t){const n=II(e),r=t.snapshotVersion;let i=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.Ui.newChangeBuffer({trackRemovals:!0});i=n.$i;const o=[];t.targetChanges.forEach((s,a)=>{const l=i.get(a);if(!l)return;o.push(n.Vs.removeMatchingKeys(e,s.removedDocuments,a).next(()=>n.Vs.addMatchingKeys(e,s.addedDocuments,a)));let c=l.withSequenceNumber(e.currentSequenceNumber);var u,h,d;t.targetMismatches.has(a)?c=c.withResumeToken(pk.EMPTY_BYTE_STRING,GI.min()).withLastLimboFreeSnapshotVersion(GI.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(a,c),h=c,d=s,(0===(u=l).resumeToken.approximateByteSize()||h.snapshotVersion.toMicroseconds()-u.snapshotVersion.toMicroseconds()>=3e8||d.addedDocuments.size+d.modifiedDocuments.size+d.removedDocuments.size>0)&&o.push(n.Vs.updateTargetData(e,c))});let a=cM(),l=vM();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(function(e,t,n){let r=vM(),i=vM();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=cM();return n.forEach((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(GI.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):wI("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{Gi:r,Qi:i}})}(e,s,t.documentUpdates).next(e=>{a=e.Gi,l=e.Qi})),!r.isEqual(GI.min())){const t=n.Vs.getLastRemoteSnapshotVersion(e).next(t=>n.Vs.setTargetsMetadata(e,e.currentSequenceNumber,r));o.push(t)}return nk.waitFor(o).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,l)).next(()=>a)}).then(e=>(n.$i=i,e))}function DN(e,t){const n=II(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function LN(e,t){const n=II(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Vs.getTargetData(e,t).next(i=>i?(r=i,nk.resolve(r)):n.Vs.allocateTargetId(e).next(i=>(r=new oN(t,i,0,e.currentSequenceNumber),n.Vs.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.$i.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.$i=n.$i.insert(e.targetId,e),n.Bi.set(t,e.targetId)),e})}function FN(e,t,n){return UN.apply(this,arguments)}function UN(){return UN=Ow(function*(e,t,n){const r=II(e),i=r.$i.get(t),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(o){if(!rk(o))throw o;wI("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}r.$i=r.$i.remove(t),r.Bi.delete(i.target)}),UN.apply(this,arguments)}function VN(e,t,n){const r=II(e);let i=GI.min(),s=vM();return r.persistence.runTransaction("Execute query","readonly",e=>function(e,t,n){const r=II(e),i=r.Bi.get(n);return void 0!==i?nk.resolve(r.$i.get(i)):r.Vs.getTargetData(t,n)}(r,e,mA(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.Fi.getDocumentsMatchingQuery(e,t,n?i:GI.min(),n?s:vM())).next(e=>(function(e,t,n){let r=GI.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Li.set(t,r)}(r,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,ji:s})))}class BN{constructor(){this.activeTargetIds=_M()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class $N{constructor(){this.Fr=new BN,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,t,n){this.$r[e]=t}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new BN,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class zN{Br(e){}shutdown(){}}class HN{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){wI("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){wI("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const GN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class ZN{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}class qN extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.so=(e.ssl?"https":"http")+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,t,n,r,i){const s=this.oo(e,t);wI("RestConnection","Sending: ",s,n);const o={};return this.uo(o,r,i),this.co(e,s,o,n).then(e=>(wI("RestConnection","Received: ",e),e),t=>{throw SI("RestConnection",`${e} failed with error: `,t,"url: ",s,"request:",n),t})}ao(e,t,n,r,i,s){return this.ro(e,t,n,r,i)}uo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+CI,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}oo(e,t){return`${this.so}/v1/${t}:${GN[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,t,n,r){return new Promise((i,s)=>{const o=new mI;o.listenOnce(hI.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case uI.NO_ERROR:const t=o.getResponseJson();wI("Connection","XHR received:",JSON.stringify(t)),i(t);break;case uI.TIMEOUT:wI("Connection",'RPC "'+e+'" timed out'),s(new AI(kI.DEADLINE_EXCEEDED,"Request time out"));break;case uI.HTTP_ERROR:const n=o.getStatus();if(wI("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const e=o.getResponseJson().error;if(e&&e.status&&e.message){const t=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(kI).indexOf(t)>=0?t:kI.UNKNOWN}(e.status);s(new AI(t,e.message))}else s(new AI(kI.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new AI(kI.UNAVAILABLE,"Connection failed."));break;default:OI()}}finally{wI("Connection",'RPC "'+e+'" completed.')}});const a=JSON.stringify(r);o.send(t,"POST",a,n,15)})}ho(e,t,n){const r=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=lI(),s=cI(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new pI({})),this.uo(o.initMessageHeaders,t,n),zw()||Gw()||$w().indexOf("Electron/")>=0||Zw()||$w().indexOf("MSAppHost/")>=0||Hw()||(o.httpHeadersOverwriteParam="$httpHeaders");const a=r.join("");wI("Connection","Creating WebChannel: "+a,o);const l=i.createWebChannel(a,o);let c=!1,u=!1;const h=new ZN({jr:e=>{u?wI("Connection","Not sending because WebChannel is closed:",e):(c||(wI("Connection","Opening WebChannel transport."),l.open(),c=!0),wI("Connection","WebChannel sending:",e),l.send(e))},Wr:()=>l.close()}),d=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(t){setTimeout(()=>{throw t},0)}})};return d(l,gI.EventType.OPEN,()=>{u||wI("Connection","WebChannel transport opened.")}),d(l,gI.EventType.CLOSE,()=>{u||(u=!0,wI("Connection","WebChannel transport closed"),h.eo())}),d(l,gI.EventType.ERROR,e=>{u||(u=!0,SI("Connection","WebChannel transport errored:",e),h.eo(new AI(kI.UNAVAILABLE,"The operation could not be completed")))}),d(l,gI.EventType.MESSAGE,e=>{var t;if(!u){const n=e.data[0];TI(!!n);const r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){wI("Connection","WebChannel received error:",i);const e=i.status;let t=function(e){const t=rM[e];if(void 0!==t)return oM(t)}(e),n=i.message;void 0===t&&(t=kI.INTERNAL,n="Unknown error status: "+e+" with message "+i.message),u=!0,h.eo(new AI(t,n)),l.close()}else wI("Connection","WebChannel received:",n),h.no(n)}}),d(s,dI.STAT_EVENT,e=>{e.stat===fI.PROXY?wI("Connection","Detected buffering proxy"):e.stat===fI.NOPROXY&&wI("Connection","Detected no buffering proxy")}),setTimeout(()=>{h.Zr()},0),h}}function WN(){return"undefined"!=typeof document?document:null}function jN(e){return new NM(e,!0)}class YN{constructor(e,t,n=1e3,r=1.5,i=6e4){this.js=e,this.timerId=t,this.lo=n,this.fo=r,this._o=i,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const t=Math.floor(this.wo+this.To()),n=Math.max(0,Date.now()-this.yo),r=Math.max(0,t-n);r>0&&wI("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.wo} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,r,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}cancel(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}class KN{constructor(e,t,n,r,i,s,o,a){this.js=e,this.Ao=n,this.Ro=r,this.bo=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new YN(e,t)}Do(){return 1===this.state||5===this.state||this.Co()}Co(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.xo()}stop(){var e=this;return Ow(function*(){e.Do()&&(yield e.close(0))})()}No(){this.state=0,this.So.reset()}ko(){this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Oo()))}Mo(e){this.Fo(),this.stream.send(e)}Oo(){var e=this;return Ow(function*(){if(e.Co())return e.close(0)})()}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}close(e,t){var n=this;return Ow(function*(){n.Fo(),n.$o(),n.So.cancel(),n.Po++,4!==e?n.So.reset():t&&t.code===kI.RESOURCE_EXHAUSTED?(PI(t.toString()),PI("Using maximum backoff delay to prevent overloading the backend."),n.So.po()):t&&t.code===kI.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Bo(),n.stream.close(),n.stream=null),n.state=e,yield n.listener.Jr(t)})()}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),t=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,n])=>{this.Po===t&&this.Uo(e,n)},t=>{e(()=>{const e=new AI(kI.UNKNOWN,"Fetching auth token failed: "+t.message);return this.qo(e)})})}Uo(e,t){const n=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr(()=>{n(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(e=>{n(()=>this.qo(e))}),this.stream.onMessage(e=>{n(()=>this.onMessage(e))})}xo(){var e=this;this.state=5,this.So.Io(Ow(function*(){e.state=0,e.start()}))}qo(e){return wI("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return t=>{this.js.enqueueAndForget(()=>this.Po===e?t():(wI("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class QN extends KN{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.wt=i}Ko(e,t){return this.bo.ho("Listen",e,t)}onMessage(e){this.So.reset();const t=function(e,t){let n;if("targetChange"in t){const i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:OI(),s=t.targetChange.targetIds||[],o=function(e,t){return e.dt?(TI(void 0===t||"string"==typeof t),pk.fromBase64String(t||"")):(TI(void 0===t||t instanceof Uint8Array),pk.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,l=a&&function(e){const t=void 0===e.code?kI.UNKNOWN:oM(e.code);return new AI(t,e.message||"")}(a);n=new bM(i,s,o,l||null)}else if("documentChange"in t){const r=t.documentChange,i=BM(e,r.document.name),s=LM(r.document.updateTime),o=new zk({mapValue:{fields:r.document.fields}}),a=Gk.newFoundDocument(i,s,o);n=new PM(r.targetIds||[],r.removedTargetIds||[],a.key,a)}else if("documentDelete"in t){const r=t.documentDelete,i=BM(e,r.document),s=r.readTime?LM(r.readTime):GI.min(),o=Gk.newNoDocument(i,s);n=new PM([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in t){const r=t.documentRemove,i=BM(e,r.document);n=new PM([],r.removedTargetIds||[],i,null)}else{if(!("filter"in t))return OI();{const e=t.filter,r=new nM(e.count||0);n=new SM(e.targetId,r)}}var r;return n}(this.wt,e),n=function(e){if(!("targetChange"in e))return GI.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?GI.min():t.readTime?LM(t.readTime):GI.min()}(e);return this.listener.Go(t,n)}Qo(e){const t={};t.database=zM(this.wt),t.addTarget=function(e,t){let n;const r=t.target;return n=Yk(r)?{documents:ZM(e,r)}:{query:qM(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=xM(e,t.resumeToken):t.snapshotVersion.compareTo(GI.min())>0&&(n.readTime=RM(e,t.snapshotVersion.toTimestamp())),n}(this.wt,e);const n=function(e,t){const n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return OI()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);n&&(t.labels=n),this.Mo(t)}jo(e){const t={};t.database=zM(this.wt),t.removeTarget=e,this.Mo(t)}}class XN extends KN{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.wt=i,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,t){return this.bo.ho("Write",e,t)}onMessage(e){if(TI(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const t=function(e,t){return e&&e.length>0?(TI(void 0!==t),e.map(e=>function(e,t){let n=LM(e.updateTime?e.updateTime:t);return n.isEqual(GI.min())&&(n=LM(t)),new BA(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=LM(e.commitTime);return this.listener.Jo(n,t)}return TI(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=zM(this.wt),this.Mo(e)}Ho(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>function(e,t){let n;if(t instanceof YA)n={update:GM(e,t.key,t.value)};else if(t instanceof eM)n={delete:VM(e,t.key)};else if(t instanceof KA)n={update:GM(e,t.key,t.data),updateMask:tN(t.fieldMask)};else{if(!(t instanceof tM))return OI();n={verify:VM(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof MA)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof NA)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof xA)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof LA)return{fieldPath:t.field.canonicalString(),increment:n._t};throw OI()}(0,e))),t.precondition.isNone||(n.currentDocument=void 0!==(r=t.precondition).updateTime?{updateTime:DM(e,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:OI()),n;var r}(this.wt,e))};this.Mo(t)}}class JN extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.bo=n,this.wt=r,this.Zo=!1}tu(){if(this.Zo)throw new AI(kI.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,t,n){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,i])=>this.bo.ro(e,t,n,r,i)).catch(e=>{throw"FirebaseError"===e.name?(e.code===kI.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new AI(kI.UNKNOWN,e.toString())})}ao(e,t,n,r){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.bo.ao(e,t,n,i,s,r)).catch(e=>{throw"FirebaseError"===e.name?(e.code===kI.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new AI(kI.UNKNOWN,e.toString())})}terminate(){this.Zo=!0}}class eR{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(PI(t),this.su=!1):wI("OnlineStateTracker",t)}cu(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}class tR{constructor(e,t,n,r,i){var s=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=i,this.du.Br(e=>{n.enqueueAndForget(Ow(function*(){var e;dR(s)&&(wI("RemoteStore","Restarting streams for network reachability change."),yield(e=Ow(function*(e){const t=II(e);t.lu.add(4),yield iR(t),t._u.set("Unknown"),t.lu.delete(4),yield nR(t)}),function(t){return e.apply(this,arguments)})(s))}))}),this._u=new eR(n,r)}}function nR(e){return rR.apply(this,arguments)}function rR(){return rR=Ow(function*(e){if(dR(e))for(const t of e.fu)yield t(!0)}),rR.apply(this,arguments)}function iR(e){return sR.apply(this,arguments)}function sR(){return sR=Ow(function*(e){for(const t of e.fu)yield t(!1)}),sR.apply(this,arguments)}function oR(e,t){const n=II(e);n.hu.has(t.targetId)||(n.hu.set(t.targetId,t),hR(n)?uR(n):BR(n).Co()&&lR(n,t))}function aR(e,t){const n=II(e),r=BR(n);n.hu.delete(t),r.Co()&&cR(n,t),0===n.hu.size&&(r.Co()?r.ko():dR(n)&&n._u.set("Unknown"))}function lR(e,t){e.wu.Nt(t.targetId),BR(e).Qo(t)}function cR(e,t){e.wu.Nt(t),BR(e).jo(t)}function uR(e){e.wu=new TM({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),te:t=>e.hu.get(t)||null}),BR(e).start(),e._u.iu()}function hR(e){return dR(e)&&!BR(e).Do()&&e.hu.size>0}function dR(e){return 0===II(e).lu.size}function fR(e){e.wu=void 0}function pR(e){return gR.apply(this,arguments)}function gR(){return gR=Ow(function*(e){e.hu.forEach((t,n)=>{lR(e,t)})}),gR.apply(this,arguments)}function mR(e,t){return yR.apply(this,arguments)}function yR(){return yR=Ow(function*(e,t){fR(e),hR(e)?(e._u.uu(t),uR(e)):e._u.set("Unknown")}),yR.apply(this,arguments)}function vR(e,t,n){return CR.apply(this,arguments)}function CR(){return CR=Ow(function*(e,t,n){if(e._u.set("Online"),t instanceof bM&&2===t.state&&t.cause)try{yield(r=Ow(function*(e,t){const n=t.cause;for(const r of t.targetIds)e.hu.has(r)&&(yield e.remoteSyncer.rejectListen(r,n),e.hu.delete(r),e.wu.removeTarget(r))}),function(e,t){return r.apply(this,arguments)})(e,t)}catch(r){wI("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),yield _R(e,r)}else if(t instanceof PM?e.wu.Ut(t):t instanceof SM?e.wu.zt(t):e.wu.Gt(t),!n.isEqual(GI.min()))try{const t=yield RN(e.localStore);n.compareTo(t)>=0&&(yield function(e,t){const n=e.wu.Yt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.hu.get(r);i&&e.hu.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(t=>{const n=e.hu.get(t);if(!n)return;e.hu.set(t,n.withResumeToken(pk.EMPTY_BYTE_STRING,n.snapshotVersion)),cR(e,t);const r=new oN(n.target,t,1,n.sequenceNumber);lR(e,r)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n))}catch(r){wI("RemoteStore","Failed to raise snapshot:",r),yield _R(e,r)}var r}),CR.apply(this,arguments)}function _R(e,t,n){return ER.apply(this,arguments)}function ER(){return ER=Ow(function*(e,t,n){if(!rk(t))throw t;e.lu.add(1),yield iR(e),e._u.set("Offline"),n||(n=()=>RN(e.localStore)),e.asyncQueue.enqueueRetryable(Ow(function*(){wI("RemoteStore","Retrying IndexedDB access"),yield n(),e.lu.delete(1),yield nR(e)}))}),ER.apply(this,arguments)}function wR(e,t){return t().catch(n=>_R(e,n,t))}function PR(e){return SR.apply(this,arguments)}function SR(){return SR=Ow(function*(e){const t=II(e),n=$R(t);let r=t.au.length>0?t.au[t.au.length-1].batchId:-1;for(;bR(t);)try{const e=yield DN(t.localStore,r);if(null===e){0===t.au.length&&n.ko();break}r=e.batchId,OR(t,e)}catch(i){yield _R(t,i)}TR(t)&&IR(t)}),SR.apply(this,arguments)}function bR(e){return dR(e)&&e.au.length<10}function OR(e,t){e.au.push(t);const n=$R(e);n.Co()&&n.zo&&n.Ho(t.mutations)}function TR(e){return dR(e)&&!$R(e).Do()&&e.au.length>0}function IR(e){$R(e).start()}function kR(e){return AR.apply(this,arguments)}function AR(){return AR=Ow(function*(e){$R(e).Xo()}),AR.apply(this,arguments)}function MR(e){return NR.apply(this,arguments)}function NR(){return NR=Ow(function*(e){const t=$R(e);for(const n of e.au)t.Ho(n.mutations)}),NR.apply(this,arguments)}function RR(e,t,n){return xR.apply(this,arguments)}function xR(){return xR=Ow(function*(e,t,n){const r=e.au.shift(),i=iN.from(r,t,n);yield wR(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),yield PR(e)}),xR.apply(this,arguments)}function DR(e,t){return LR.apply(this,arguments)}function LR(){return LR=Ow(function*(e,t){var n;t&&$R(e).zo&&(yield(n=Ow(function*(e,t){if(sM(n=t.code)&&n!==kI.ABORTED){const n=e.au.shift();$R(e).No(),yield wR(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),yield PR(e)}var n}),function(e,t){return n.apply(this,arguments)})(e,t)),TR(e)&&IR(e)}),LR.apply(this,arguments)}function FR(e,t){return UR.apply(this,arguments)}function UR(){return UR=Ow(function*(e,t){const n=II(e);n.asyncQueue.verifyOperationInProgress(),wI("RemoteStore","RemoteStore received new credentials");const r=dR(n);n.lu.add(3),yield iR(n),r&&n._u.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(t),n.lu.delete(3),yield nR(n)}),UR.apply(this,arguments)}function VR(){return VR=Ow(function*(e,t){const n=II(e);t?(n.lu.delete(2),yield nR(n)):t||(n.lu.add(2),yield iR(n),n._u.set("Unknown"))}),VR.apply(this,arguments)}function BR(e){return e.mu||(e.mu=function(e,t,n){const r=II(e);return r.tu(),new QN(t,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,n)}(e.datastore,e.asyncQueue,{zr:pR.bind(null,e),Jr:mR.bind(null,e),Go:vR.bind(null,e)}),e.fu.push(function(){var t=Ow(function*(t){t?(e.mu.No(),hR(e)?uR(e):e._u.set("Unknown")):(yield e.mu.stop(),fR(e))});return function(e){return t.apply(this,arguments)}}())),e.mu}function $R(e){return e.gu||(e.gu=function(e,t,n){const r=II(e);return r.tu(),new XN(t,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,n)}(e.datastore,e.asyncQueue,{zr:kR.bind(null,e),Jr:DR.bind(null,e),Yo:MR.bind(null,e),Jo:RR.bind(null,e)}),e.fu.push(function(){var t=Ow(function*(t){t?(e.gu.No(),yield PR(e)):(yield e.gu.stop(),e.au.length>0&&(wI("RemoteStore",`Stopping write stream with ${e.au.length} pending writes`),e.au=[]))});return function(e){return t.apply(this,arguments)}}())),e.gu}class zR{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new MI,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new zR(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new AI(kI.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function HR(e,t){if(PI("AsyncQueue",`${t}: ${e}`),rk(e))return new AI(kI.UNAVAILABLE,`${t}: ${e}`);throw e}class GR{constructor(e){this.comparator=e?(t,n)=>e(t,n)||YI.comparator(t.key,n.key):(e,t)=>YI.comparator(e.key,t.key),this.keyedMap=hM(),this.sortedSet=new lk(this.comparator)}static emptySet(e){return new GR(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof GR)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new GR;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class ZR{constructor(){this.yu=new lk(YI.comparator)}track(e){const t=e.doc.key,n=this.yu.get(t);n?0!==e.type&&3===n.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==n.type?this.yu=this.yu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.yu=this.yu.remove(t):1===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):OI():this.yu=this.yu.insert(t,e)}pu(){const e=[];return this.yu.inorderTraversal((t,n)=>{e.push(n)}),e}}class qR{constructor(e,t,n,r,i,s,o,a){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a}static fromInitialDocuments(e,t,n,r){const i=[];return t.forEach(e=>{i.push({type:0,doc:e})}),new qR(e,t,GR.emptySet(t),i,n,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&vA(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class WR{constructor(){this.Iu=void 0,this.listeners=[]}}class jR{constructor(){this.queries=new aM(e=>CA(e),vA),this.onlineState="Unknown",this.Tu=new Set}}function YR(e,t){return KR.apply(this,arguments)}function KR(){return KR=Ow(function*(e,t){const n=II(e),r=t.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new WR),i)try{s.Iu=yield n.onListen(r)}catch(o){const e=HR(o,`Initialization of query '${_A(t.query)}' failed`);return void t.onError(e)}n.queries.set(r,s),s.listeners.push(t),t.Eu(n.onlineState),s.Iu&&t.Au(s.Iu)&&tx(n)}),KR.apply(this,arguments)}function QR(e,t){return XR.apply(this,arguments)}function XR(){return XR=Ow(function*(e,t){const n=II(e),r=t.query;let i=!1;const s=n.queries.get(r);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}),XR.apply(this,arguments)}function JR(e,t){const n=II(e);let r=!1;for(const i of t){const e=n.queries.get(i.query);if(e){for(const t of e.listeners)t.Au(i)&&(r=!0);e.Iu=i}}r&&tx(n)}function ex(e,t,n){const r=II(e),i=r.queries.get(t);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(t)}function tx(e){e.Tu.forEach(e=>{e.next()})}class nx{constructor(e,t,n){this.query=e,this.Ru=t,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=n||{}}Au(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new qR(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),t=!0):this.Vu(e,this.onlineState)&&(this.Su(e),t=!0),this.Pu=e,t}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}Vu(e,t){return!e.fromCache||!(this.options.Du&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}vu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Su(e){e=qR.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}class rx{constructor(e){this.key=e}}class ix{constructor(e){this.key=e}}class sx{constructor(e,t){this.query=e,this.Fu=t,this.$u=null,this.current=!1,this.Bu=vM(),this.mutatedKeys=vM(),this.Lu=wA(e),this.Uu=new GR(this.Lu)}get qu(){return this.Fu}Ku(e,t){const n=t?t.Gu:new ZR,r=t?t.Uu:this.Uu;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=EA(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.Qu(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.Lu(u,a)>0||l&&this.Lu(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(o=!0)),f&&(u?(s=s.add(u),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Uu:s,Gu:n,Oi:o,mutatedKeys:i}}Qu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const i=e.Gu.pu();i.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return OI()}};return n(e)-n(t)}(e.type,t.type)||this.Lu(e.doc,t.doc)),this.ju(n);const s=t?this.Wu():[],o=0===this.Bu.size&&this.current?1:0,a=o!==this.$u;return this.$u=o,0!==i.length||a?{snapshot:new qR(this.query,e.Uu,r,i,e.mutatedKeys,0===o,a,!1),zu:s}:{zu:s}}Eu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new ZR,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(e=>this.Fu=this.Fu.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Fu=this.Fu.delete(e)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=vM(),this.Uu.forEach(e=>{this.Hu(e.key)&&(this.Bu=this.Bu.add(e.key))});const t=[];return e.forEach(e=>{this.Bu.has(e)||t.push(new ix(e))}),this.Bu.forEach(n=>{e.has(n)||t.push(new rx(n))}),t}Ju(e){this.Fu=e.ji,this.Bu=vM();const t=this.Ku(e.documents);return this.applyChanges(t,!0)}Yu(){return qR.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}class ox{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class ax{constructor(e){this.key=e,this.Xu=!1}}class lx{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Zu={},this.tc=new aM(e=>CA(e),vA),this.ec=new Map,this.nc=new Set,this.sc=new lk(YI.comparator),this.ic=new Map,this.rc=new vN,this.oc={},this.uc=new Map,this.cc=fN.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return!0===this.ac}}function cx(e,t){return ux.apply(this,arguments)}function ux(){return ux=Ow(function*(e,t){const n=Fx(e);let r,i;const s=n.tc.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Yu();else{const e=yield LN(n.localStore,mA(t));n.isPrimaryClient&&oR(n.remoteStore,e);const s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=yield hx(n,t,r,"current"===s)}return i}),ux.apply(this,arguments)}function hx(e,t,n,r){return dx.apply(this,arguments)}function dx(){return dx=Ow(function*(e,t,n,r){e.hc=(t,n,r)=>{return(i=Ow(function*(e,t,n,r){let i=t.view.Ku(n);i.Oi&&(i=yield VN(e.localStore,t.query,!1).then(({documents:e})=>t.view.Ku(e,i)));const s=r&&r.targetChanges.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s);return kx(e,t.targetId,o.zu),o.snapshot}),function(e,t,n,r){return i.apply(this,arguments)})(e,t,n,r);var i};const i=yield VN(e.localStore,t,!0),s=new sx(t,i.ji),o=s.Ku(i.documents),a=wM.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState),l=s.applyChanges(o,e.isPrimaryClient,a);kx(e,n,l.zu);const c=new ox(t,n,s);return e.tc.set(t,c),e.ec.has(n)?e.ec.get(n).push(t):e.ec.set(n,[t]),l.snapshot}),dx.apply(this,arguments)}function fx(e,t){return px.apply(this,arguments)}function px(){return px=Ow(function*(e,t){const n=II(e),r=n.tc.get(t),i=n.ec.get(r.targetId);if(i.length>1)return n.ec.set(r.targetId,i.filter(e=>!vA(e,t))),void n.tc.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield FN(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),aR(n.remoteStore,r.targetId),Tx(n,r.targetId)}).catch(ek))):(Tx(n,r.targetId),yield FN(n.localStore,r.targetId,!0))}),px.apply(this,arguments)}function gx(){return gx=Ow(function*(e,t,n){const r=Ux(e);try{const e=yield function(e,t){const n=II(e),r=HI.now(),i=t.reduce((e,t)=>e.add(t.key),vM());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let a=cM(),l=vM();return n.Ui.getEntries(e,i).next(e=>{a=e,a.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,a)).next(i=>{s=i;const o=[];for(const e of t){const t=WA(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new KA(e.key,t,Hk(t.value.mapValue),$A.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)}).next(t=>{o=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:o.batchId,changes:dM(s)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.oc[e.currentUser.toKey()];r||(r=new lk($I)),r=r.insert(t,n),e.oc[e.currentUser.toKey()]=r}(r,e.batchId,n),yield Nx(r,e.changes),yield PR(r.remoteStore)}catch(i){const e=HR(i,"Failed to persist write");n.reject(e)}}),gx.apply(this,arguments)}function mx(e,t){return yx.apply(this,arguments)}function yx(){return yx=Ow(function*(e,t){const n=II(e);try{const e=yield xN(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.ic.get(t);r&&(TI(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.Xu=!0:e.modifiedDocuments.size>0?TI(r.Xu):e.removedDocuments.size>0&&(TI(r.Xu),r.Xu=!1))}),yield Nx(n,e,t)}catch(r){yield ek(r)}}),yx.apply(this,arguments)}function vx(e,t,n){const r=II(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.tc.forEach((n,r)=>{const i=r.view.Eu(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=II(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.listeners)i.Eu(t)&&(r=!0)}),r&&tx(n)}(r.eventManager,t),e.length&&r.Zu.Go(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function Cx(e,t,n){return _x.apply(this,arguments)}function _x(){return _x=Ow(function*(e,t,n){const r=II(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.ic.get(t),s=i&&i.key;if(s){let e=new lk(YI.comparator);e=e.insert(s,Gk.newNoDocument(s,GI.min()));const n=vM().add(s),i=new EM(GI.min(),new Map,new hk($I),e,n);yield mx(r,i),r.sc=r.sc.remove(s),r.ic.delete(t),Mx(r)}else yield FN(r.localStore,t,!1).then(()=>Tx(r,t,n)).catch(ek)}),_x.apply(this,arguments)}function Ex(e,t){return wx.apply(this,arguments)}function wx(){return wx=Ow(function*(e,t){const n=II(e),r=t.batch.batchId;try{const e=yield NN(n.localStore,t);Ox(n,r,null),bx(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield Nx(n,e)}catch(i){yield ek(i)}}),wx.apply(this,arguments)}function Px(e,t,n){return Sx.apply(this,arguments)}function Sx(){return Sx=Ow(function*(e,t,n){const r=II(e);try{const e=yield function(e,t){const n=II(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(TI(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);Ox(r,t,n),bx(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),yield Nx(r,e)}catch(i){yield ek(i)}}),Sx.apply(this,arguments)}function bx(e,t){(e.uc.get(t)||[]).forEach(e=>{e.resolve()}),e.uc.delete(t)}function Ox(e,t,n){const r=II(e);let i=r.oc[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.oc[r.currentUser.toKey()]=i}}function Tx(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.ec.get(t))e.tc.delete(r),n&&e.Zu.lc(r,n);e.ec.delete(t),e.isPrimaryClient&&e.rc.us(t).forEach(t=>{e.rc.containsKey(t)||Ix(e,t)})}function Ix(e,t){e.nc.delete(t.path.canonicalString());const n=e.sc.get(t);null!==n&&(aR(e.remoteStore,n),e.sc=e.sc.remove(t),e.ic.delete(n),Mx(e))}function kx(e,t,n){for(const r of n)r instanceof rx?(e.rc.addReference(r.key,t),Ax(e,r)):r instanceof ix?(wI("SyncEngine","Document no longer in limbo: "+r.key),e.rc.removeReference(r.key,t),e.rc.containsKey(r.key)||Ix(e,r.key)):OI()}function Ax(e,t){const n=t.key,r=n.path.canonicalString();e.sc.get(n)||e.nc.has(r)||(wI("SyncEngine","New document in limbo: "+n),e.nc.add(r),Mx(e))}function Mx(e){for(;e.nc.size>0&&e.sc.size<e.maxConcurrentLimboResolutions;){const t=e.nc.values().next().value;e.nc.delete(t);const n=new YI(qI.fromString(t)),r=e.cc.next();e.ic.set(r,new ax(n)),e.sc=e.sc.insert(n,r),oR(e.remoteStore,new oN(mA(hA(n.path)),r,2,ik.ot))}}function Nx(e,t,n){return Rx.apply(this,arguments)}function Rx(){return Rx=Ow(function*(e,t,n){const r=II(e),i=[],s=[],o=[];var a;r.tc.isEmpty()||(r.tc.forEach((e,a)=>{o.push(r.hc(a,t,n).then(e=>{if(e){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,e.fromCache?"not-current":"current"),i.push(e);const t=TN.Vi(a.targetId,e);s.push(t)}}))}),yield Promise.all(o),r.Zu.Go(i),yield(a=Ow(function*(e,t){const n=II(e);try{yield n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>nk.forEach(t,t=>nk.forEach(t.Pi,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>nk.forEach(t.vi,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(r){if(!rk(r))throw r;wI("LocalStore","Failed to update sequence numbers: "+r)}for(const i of t){const e=i.targetId;if(!i.fromCache){const t=n.$i.get(e),r=t.withLastLimboFreeSnapshotVersion(t.snapshotVersion);n.$i=n.$i.insert(e,r)}}}),function(e,t){return a.apply(this,arguments)})(r.localStore,s))}),Rx.apply(this,arguments)}function xx(e,t){return Dx.apply(this,arguments)}function Dx(){return Dx=Ow(function*(e,t){const n=II(e);if(!n.currentUser.isEqual(t)){wI("SyncEngine","User change. New user:",t.toKey());const e=yield AN(n.localStore,t);n.currentUser=t,(r=n).uc.forEach(e=>{e.forEach(e=>{e.reject(new AI(kI.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),r.uc.clear(),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),yield Nx(n,e.Ki)}var r}),Dx.apply(this,arguments)}function Lx(e,t){const n=II(e),r=n.ic.get(t);if(r&&r.Xu)return vM().add(r.key);{let e=vM();const r=n.ec.get(t);if(!r)return e;for(const t of r){const r=n.tc.get(t);e=e.unionWith(r.view.qu)}return e}}function Fx(e){const t=II(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=mx.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Lx.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Cx.bind(null,t),t.Zu.Go=JR.bind(null,t.eventManager),t.Zu.lc=ex.bind(null,t.eventManager),t}function Ux(e){const t=II(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Ex.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Px.bind(null,t),t}class Vx{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return Ow(function*(){t.wt=jN(e.databaseInfo.databaseId),t.sharedClientState=t.dc(e),t.persistence=t._c(e),yield t.persistence.start(),t.localStore=t.wc(e),t.gcScheduler=t.mc(e,t.localStore),t.indexBackfillerScheduler=t.gc(e,t.localStore)})()}mc(e,t){return null}gc(e,t){return null}wc(e){return function(e,t,n,r){return new kN(e,t,n,r)}(this.persistence,new IN,e.initialUser,this.wt)}_c(e){return new SN(ON.Ms,this.wt)}dc(e){return new $N}terminate(){var e=this;return Ow(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class Bx{initialize(e,t){var n=this;return Ow(function*(){n.localStore||(n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=e=>vx(n.syncEngine,e,1),n.remoteStore.remoteSyncer.handleCredentialChange=xx.bind(null,n.syncEngine),yield function(e,t){return VR.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient))})()}createEventManager(e){return new jR}createDatastore(e){const t=jN(e.databaseInfo.databaseId),n=new qN(e.databaseInfo);return new JN(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=e=>vx(this.syncEngine,e,0),s=HN.V()?new HN:new zN,new tR(t,n,r,i,s);var t,n,r,i,s}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new lx(e,t,n,r,i,s);return o&&(a.ac=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=Ow(function*(e){const t=II(e);wI("RemoteStore","RemoteStore shutting down."),t.lu.add(5),yield iR(t),t.du.shutdown(),t._u.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}class $x{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class zx{constructor(e,t,n,r){var i=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=vI.UNAUTHENTICATED,this.clientId=BI.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,function(){var e=Ow(function*(e){wI("FirestoreClient","Received user=",e.uid),yield i.authCredentialListener(e),i.user=e});return function(t){return e.apply(this,arguments)}}()),this.appCheckCredentials.start(n,e=>(wI("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}getConfiguration(){var e=this;return Ow(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new AI(kI.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new MI;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(Ow(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(n){const e=HR(n,"Failed to shutdown persistence");t.reject(e)}})),t.promise}}function Hx(e,t){return Gx.apply(this,arguments)}function Gx(){return Gx=Ow(function*(e,t){e.asyncQueue.verifyOperationInProgress(),wI("FirestoreClient","Initializing OfflineComponentProvider");const n=yield e.getConfiguration();yield t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(function(){var e=Ow(function*(e){r.isEqual(e)||(yield AN(t.localStore,e),r=e)});return function(t){return e.apply(this,arguments)}}()),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e.offlineComponents=t}),Gx.apply(this,arguments)}function Zx(e,t){return qx.apply(this,arguments)}function qx(){return qx=Ow(function*(e,t){e.asyncQueue.verifyOperationInProgress();const n=yield Wx(e);wI("FirestoreClient","Initializing OnlineComponentProvider");const r=yield e.getConfiguration();yield t.initialize(n,r),e.setCredentialChangeListener(e=>FR(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>FR(t.remoteStore,n)),e.onlineComponents=t}),qx.apply(this,arguments)}function Wx(e){return jx.apply(this,arguments)}function jx(){return jx=Ow(function*(e){return e.offlineComponents||(wI("FirestoreClient","Using default OfflineComponentProvider"),yield Hx(e,new Vx)),e.offlineComponents}),jx.apply(this,arguments)}function Yx(e){return Kx.apply(this,arguments)}function Kx(){return Kx=Ow(function*(e){return e.onlineComponents||(wI("FirestoreClient","Using default OnlineComponentProvider"),yield Zx(e,new Bx)),e.onlineComponents}),Kx.apply(this,arguments)}function Qx(e){return Xx.apply(this,arguments)}function Xx(){return Xx=Ow(function*(e){const t=yield Yx(e),n=t.eventManager;return n.onListen=cx.bind(null,t.syncEngine),n.onUnlisten=fx.bind(null,t.syncEngine),n}),Xx.apply(this,arguments)}const Jx=new Map;function eD(e,t,n){if(!n)throw new AI(kI.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function tD(e){if(!YI.isDocumentKey(e))throw new AI(kI.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function nD(e){if(YI.isDocumentKey(e))throw new AI(kI.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function rD(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const n=(t=e).constructor?t.constructor.name:null;return n?`a custom ${n} object`:"an object"}}var t;return"function"==typeof e?"a function":OI()}function iD(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new AI(kI.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=rD(e);throw new AI(kI.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}class sD{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new AI(kI.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new AI(kI.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new AI(kI.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class oD{constructor(e,t,n){this._authCredentials=t,this._appCheckCredentials=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sD({}),this._settingsFrozen=!1,e instanceof Pk?this._databaseId=e:(this._app=e,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new AI(kI.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Pk(e.options.projectId)}(e))}get app(){if(!this._app)throw new AI(kI.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new AI(kI.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sD(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new RI;switch(e.type){case"gapi":const t=e.client;return TI(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new LI(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new AI(kI.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Jx.get(e);t&&(wI("ComponentProvider","Removing Datastore"),Jx.delete(e),t.terminate())}(this),Promise.resolve()}}class aD{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new cD(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new aD(this.firestore,e,this._key)}}class lD{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new lD(this.firestore,e,this._query)}}class cD extends lD{constructor(e,t,n){super(e,t,hA(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new aD(this.firestore,null,new YI(e))}withConverter(e){return new cD(this.firestore,e,this._path)}}function uD(e,t,...n){if(e=oP(e),eD("collection","path",t),e instanceof oD){const r=qI.fromString(t,...n);return nD(r),new cD(e,null,r)}{if(!(e instanceof aD||e instanceof cD))throw new AI(kI.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(qI.fromString(t,...n));return nD(r),new cD(e.firestore,null,r)}}function hD(e,t,...n){if(e=oP(e),1===arguments.length&&(t=BI.I()),eD("doc","path",t),e instanceof oD){const r=qI.fromString(t,...n);return tD(r),new aD(e,null,new YI(r))}{if(!(e instanceof aD||e instanceof cD))throw new AI(kI.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(qI.fromString(t,...n));return tD(r),new aD(e.firestore,e instanceof cD?e.converter:null,new YI(r))}}class dD{constructor(){this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new YN(this,"async_queue_retry"),this.Kc=()=>{const e=WN();e&&wI("AsyncQueue","Visibility state changed to "+e.visibilityState),this.So.Eo()};const e=WN();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const t=WN();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const t=new MI;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Mc.push(e),this.jc()))}jc(){var e=this;return Ow(function*(){if(0!==e.Mc.length){try{yield e.Mc[0](),e.Mc.shift(),e.So.reset()}catch(t){if(!rk(t))throw t;wI("AsyncQueue","Operation failed with retryable error: "+t)}e.Mc.length>0&&e.So.Io(()=>e.jc())}})()}Qc(e){const t=this.Oc.then(()=>(this.Lc=!0,e().catch(e=>{throw this.Bc=e,this.Lc=!1,PI("INTERNAL UNHANDLED ERROR: ",function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e}).then(e=>(this.Lc=!1,e))));return this.Oc=t,t}enqueueAfterDelay(e,t,n){this.Gc(),this.qc.indexOf(e)>-1&&(t=0);const r=zR.createAndSchedule(this,e,t,n,e=>this.Wc(e));return this.$c.push(r),r}Gc(){this.Bc&&OI()}verifyOperationInProgress(){}zc(){var e=this;return Ow(function*(){let t;do{t=e.Oc,yield t}while(t!==e.Oc)})()}Hc(e){for(const t of this.$c)if(t.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.$c)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const t=this.$c.indexOf(e);this.$c.splice(t,1)}}function fD(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of["next","error","complete"])if(r in n&&"function"==typeof n[r])return!0;return!1}(e)}class pD extends oD{constructor(e,t,n){super(e,t,n),this.type="firestore",this._queue=new dD,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||yD(this),this._firestoreClient.terminate()}}function gD(e=KP()){return ZP(e,"firestore").getImmediate()}function mD(e){return e._firestoreClient||yD(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function yD(e){var t;const n=e._freezeSettings(),r=(i=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",new wk(e._databaseId,i,e._persistenceKey,(s=n).host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,s.useFetchStreams));var i,s;e._firestoreClient=new zx(e._authCredentials,e._appCheckCredentials,e._queue,r)}class vD{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new AI(kI.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new jI(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class CD{constructor(e){this._byteString=e}static fromBase64String(e){try{return new CD(pk.fromBase64String(e))}catch(t){throw new AI(kI.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new CD(pk.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class _D{constructor(e){this._methodName=e}}class ED{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new AI(kI.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new AI(kI.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return $I(this._lat,e._lat)||$I(this._long,e._long)}}const wD=/^__.*__$/;class PD{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new KA(e,this.data,this.fieldMask,t,this.fieldTransforms):new YA(e,this.data,t,this.fieldTransforms)}}class SD{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new KA(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function bD(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw OI()}}class OD{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.wt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Xc(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new OD(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.sa(e),r}ia(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.Xc(),r}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return VD(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(0===e.length)throw this.oa("Document fields must not be empty");if(bD(this.Zc)&&wD.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class TD{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.wt=n||jN(e)}aa(e,t,n,r=!1){return new OD({Zc:e,methodName:t,ca:n,path:jI.emptyPath(),na:!1,ua:r},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function ID(e){const t=e._freezeSettings(),n=jN(e._databaseId);return new TD(e._databaseId,!!t.ignoreUndefinedProperties,n)}function kD(e,t,n,r,i,s={}){const o=e.aa(s.merge||s.mergeFields?2:0,t,n,i);DD("Data must be an object, but it was:",o,r);const a=RD(r,o);let l,c;if(s.merge)l=new fk(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=LD(t,r,n);if(!o.contains(i))throw new AI(kI.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);BD(e,i)||e.push(i)}l=new fk(e),c=o.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=o.fieldTransforms;return new PD(new zk(a),l,c)}class AD extends _D{_toFieldTransform(e){if(2!==e.Zc)throw e.oa(1===e.Zc?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof AD}}class MD extends _D{_toFieldTransform(e){return new VA(e.path,new MA)}isEqual(e){return e instanceof MD}}function ND(e,t){if(xD(e=oP(e)))return DD("Unsupported field value:",t,e),RD(e,t);if(e instanceof _D)return function(e,t){if(!bD(t.Zc))throw t.oa(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.oa(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.na&&4!==t.Zc)throw t.oa("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=ND(i,t.ra(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=oP(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return OA(t.wt,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=HI.fromDate(e);return{timestampValue:RM(t.wt,n)}}if(e instanceof HI){const n=new HI(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:RM(t.wt,n)}}if(e instanceof ED)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof CD)return{bytesValue:xM(t.wt,e._byteString)};if(e instanceof aD){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.oa(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:FM(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.oa(`Unsupported field value: ${rD(e)}`)}(e,t)}function RD(e,t){const n={};return ak(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ok(e,(e,r)=>{const i=ND(r,t.ea(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function xD(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof HI||e instanceof ED||e instanceof CD||e instanceof aD||e instanceof _D)}function DD(e,t,n){if(!xD(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=rD(n);throw t.oa("an object"===r?e+" a custom object":e+" "+r)}var r}function LD(e,t,n){if((t=oP(t))instanceof vD)return t._internalPath;if("string"==typeof t)return UD(e,t);throw VD("Field path arguments must be of type string or ",e,!1,void 0,n)}const FD=new RegExp("[~\\*/\\[\\]]");function UD(e,t,n){if(t.search(FD)>=0)throw VD(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new vD(...t.split("."))._internalPath}catch{throw VD(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function VD(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new AI(kI.INVALID_ARGUMENT,a+e+l)}function BD(e,t){return e.some(e=>e.isEqual(t))}class $D{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new aD(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new zD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(HD("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class zD extends $D{data(){return super.data()}}function HD(e,t){return"string"==typeof t?UD(e,t):t instanceof vD?t._internalPath:t._delegate._internalPath}class GD{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ZD extends $D{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new qD(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(HD("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class qD extends ZD{data(e={}){return super.data(e)}}class WD{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new GD(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new qD(this._firestore,this._userDataWriter,n.key,n,new GD(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new AI(kI.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>({type:"added",doc:new qD(e._firestore,e._userDataWriter,n.doc.key,n.doc,new GD(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:t++}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new qD(e._firestore,e._userDataWriter,t.doc.key,t.doc,new GD(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:jD(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function jD(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return OI()}}function YD(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new AI(kI.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class KD{}function QD(e,...t){for(const n of t)e=n._apply(e);return e}class XD extends KD{constructor(e,t,n){super(),this.fa=e,this.da=t,this._a=n,this.type="where"}_apply(e){const t=ID(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new AI(kI.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){sL(o,s);const t=[];for(const n of o)t.push(iL(r,e,n));a={arrayValue:{values:t}}}else a=iL(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||sL(o,s),a=function(e,t,n,r=!1){return ND(n,e.aa(r?4:3,t))}(n,"where",o,"in"===s||"not-in"===s);const l=Kk.create(i,s,a);return function(e,t){if(t.ht()){const n=fA(e);if(null!==n&&!n.isEqual(t.field))throw new AI(kI.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${t.field.toString()}'`);const r=dA(e);null!==r&&oL(0,t.field,r)}const n=function(e,t){for(const n of e.filters)if(t.indexOf(n.op)>=0)return n.op;return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw new AI(kI.INVALID_ARGUMENT,n===t.op?`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`:`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}(e,l),l}(e._query,0,t,e.firestore._databaseId,this.fa,this.da,this._a);return new lD(e.firestore,e.converter,function(e,t){const n=e.filters.concat([t]);return new uA(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}(e._query,n))}}function JD(e,t,n){const r=t,i=HD("where",e);return new XD(i,r,n)}class eL extends KD{constructor(e,t){super(),this.fa=e,this.wa=t,this.type="orderBy"}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new AI(kI.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new AI(kI.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new oA(t,n);return function(e,t){if(null===dA(e)){const n=fA(e);null!==n&&oL(0,n,t.field)}}(e,r),r}(e._query,this.fa,this.wa);return new lD(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new uA(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function tL(e,t="asc"){const n=t,r=HD("orderBy",e);return new eL(r,n)}class nL extends KD{constructor(e,t,n){super(),this.type=e,this.ma=t,this.ga=n}_apply(e){return new lD(e.firestore,e.converter,yA(e._query,this.ma,this.ga))}}function rL(e){return function(e,t){if(t<=0)throw new AI(kI.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}("limit",e),new nL("limit",e,"F")}function iL(e,t,n){if("string"==typeof(n=oP(n))){if(""===n)throw new AI(kI.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!pA(t)&&-1!==n.indexOf("/"))throw new AI(kI.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(qI.fromString(n));if(!YI.isDocumentKey(r))throw new AI(kI.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return xk(e,new YI(r))}if(n instanceof aD)return xk(e,n._key);throw new AI(kI.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${rD(n)}.`)}function sL(e,t){if(!Array.isArray(e)||0===e.length)throw new AI(kI.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(e.length>10)throw new AI(kI.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function oL(e,t,n){if(!n.isEqual(t))throw new AI(kI.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}function aL(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}function lL(e){e=iD(e,aD);const t=iD(e.firestore,pD);return function(e,t,n={}){const r=new MI;return e.asyncQueue.enqueueAndForget(Ow(function*(){return function(e,t,n,r,i){const s=new $x({next:s=>{t.enqueueAndForget(()=>QR(e,o));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new AI(kI.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new AI(kI.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new nx(hA(n.path),s,{includeMetadataChanges:!0,Du:!0});return YR(e,o)}(yield Qx(e),e.asyncQueue,t,n,r)})),r.promise}(mD(t),e._key).then(n=>yL(t,e,n))}class cL extends class{convertValue(e,t="none"){switch(Tk(e)){case 0:return null;case 1:return e.booleanValue;case 2:return yk(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(vk(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw OI()}}convertObject(e,t){const n={};return ok(e.fields,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertGeoPoint(e){return new ED(yk(e.latitude),yk(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=_k(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Ek(e));default:return null}}convertTimestamp(e){const t=mk(e);return new HI(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=qI.fromString(e);TI(nN(n));const r=new Pk(n.get(1),n.get(3)),i=new YI(n.popFirst(5));return r.isEqual(t)||PI(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}{constructor(e){super(),this.firestore=e}convertBytes(e){return new CD(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new aD(this.firestore,null,t)}}function uL(e){e=iD(e,lD);const t=iD(e.firestore,pD),n=mD(t),r=new cL(t);return YD(e._query),function(e,t,n={}){const r=new MI;return e.asyncQueue.enqueueAndForget(Ow(function*(){return function(e,t,n,r,i){const s=new $x({next:n=>{t.enqueueAndForget(()=>QR(e,o)),n.fromCache&&"server"===r.source?i.reject(new AI(kI.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new nx(n,s,{includeMetadataChanges:!0,Du:!0});return YR(e,o)}(yield Qx(e),e.asyncQueue,t,n,r)})),r.promise}(n,e._query).then(n=>new WD(t,r,e,n))}function hL(e,t,n){e=iD(e,aD);const r=iD(e.firestore,pD),i=aL(e.converter,t,n);return mL(r,[kD(ID(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,$A.none())])}function dL(e,t,n,...r){e=iD(e,aD);const i=iD(e.firestore,pD),s=ID(i);let o;return o="string"==typeof(t=oP(t))||t instanceof vD?function(e,t,n,r,i,s){const o=e.aa(1,t,n),a=[LD(t,r,n)],l=[i];if(s.length%2!=0)throw new AI(kI.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(LD(t,s[d])),l.push(s[d+1]);const c=[],u=zk.empty();for(let d=a.length-1;d>=0;--d)if(!BD(c,a[d])){const e=a[d];let t=l[d];t=oP(t);const n=o.ia(e);if(t instanceof AD)c.push(e);else{const r=ND(t,n);null!=r&&(c.push(e),u.set(e,r))}}const h=new fk(c);return new SD(u,h,o.fieldTransforms)}(s,"updateDoc",e._key,t,n,r):function(e,t,n,r){const i=e.aa(1,t,n);DD("Data must be an object, but it was:",i,r);const s=[],o=zk.empty();ok(r,(e,r)=>{const a=UD(t,e,n);r=oP(r);const l=i.ia(a);if(r instanceof AD)s.push(a);else{const e=ND(r,l);null!=e&&(s.push(a),o.set(a,e))}});const a=new fk(s);return new SD(o,a,i.fieldTransforms)}(s,"updateDoc",e._key,t),mL(i,[o.toMutation(e._key,$A.exists(!0))])}function fL(e){return mL(iD(e.firestore,pD),[new eM(e._key,$A.none())])}function pL(e,t){const n=iD(e.firestore,pD),r=hD(e),i=aL(e.converter,t);return mL(n,[kD(ID(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,$A.exists(!1))]).then(()=>r)}function gL(e,...t){var n,r,i;e=oP(e);let s={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||fD(t[o])||(s=t[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(fD(t[o])){const e=t[o];t[o]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[o+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[o+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let l,c,u;if(e instanceof aD)c=iD(e.firestore,pD),u=hA(e._key.path),l={next:n=>{t[o]&&t[o](yL(c,e,n))},error:t[o+1],complete:t[o+2]};else{const n=iD(e,lD);c=iD(n.firestore,pD),u=n._query;const r=new cL(c);l={next:e=>{t[o]&&t[o](new WD(c,r,n,e))},error:t[o+1],complete:t[o+2]},YD(e._query)}return function(e,t,n,r){const i=new $x(r),s=new nx(t,i,n);return e.asyncQueue.enqueueAndForget(Ow(function*(){return YR(yield Qx(e),s)})),()=>{i.Tc(),e.asyncQueue.enqueueAndForget(Ow(function*(){return QR(yield Qx(e),s)}))}}(mD(c),u,a,l)}function mL(e,t){return function(e,t){const n=new MI;return e.asyncQueue.enqueueAndForget(Ow(function*(){return function(e,t,n){return gx.apply(this,arguments)}(yield function(e){return Yx(e).then(e=>e.syncEngine)}(e),t,n)})),n.promise}(mD(e),t)}function yL(e,t,n){const r=n.docs.get(t._key),i=new cL(e);return new ZD(e,i,t._key,r,new GD(n.hasPendingWrites,n.fromCache),t.converter)}function vL(){return new MD("serverTimestamp")}!function(e,t=!0){CI="9.9.0",GP(new aP("firestore",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=new pD(r,new xI(e.getProvider("auth-internal")),new UI(e.getProvider("app-check-internal")));return n=Object.assign({useFetchStreams:t},n),i._setSettings(n),i},"PUBLIC")),XP(yI,"3.4.12",e),XP(yI,"3.4.12","esm2017")}(),XP("firebase","9.9.0","app");const CL="@firebase/installations",_L="0.5.12",EL=`w:${_L}`,wL="FIS_v2",PL=new Kw("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function SL(e){return e instanceof Yw&&e.code.includes("request-failed")}function bL({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function OL(e){return{token:e.token,requestStatus:2,expiresIn:RL(e.expiresIn),creationTime:Date.now()}}function TL(e,t){return IL.apply(this,arguments)}function IL(){return IL=Ow(function*(e,t){const n=(yield t.json()).error;return PL.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}),IL.apply(this,arguments)}function kL({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function AL(e,{refreshToken:t}){const n=kL(e);return n.append("Authorization",function(e){return`${wL} ${e}`}(t)),n}function ML(e){return NL.apply(this,arguments)}function NL(){return NL=Ow(function*(e){const t=yield e();return t.status>=500&&t.status<600?e():t}),NL.apply(this,arguments)}function RL(e){return Number(e.replace("s","000"))}function xL(e,t){return DL.apply(this,arguments)}function DL(){return DL=Ow(function*({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const r=bL(e),i=kL(e),s=t.getImmediate({optional:!0});if(s){const e=yield s.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const o={method:"POST",headers:i,body:JSON.stringify({fid:n,authVersion:wL,appId:e.appId,sdkVersion:EL})},a=yield ML(()=>fetch(r,o));if(a.ok){const e=yield a.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:OL(e.authToken)}}throw yield TL("Create Installation",a)}),DL.apply(this,arguments)}function LL(e){return new Promise(t=>{setTimeout(t,e)})}const FL=/^[cdef][\w-]{21}$/;function UL(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){return function(e){return btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")}(e).substr(0,22)}(e);return FL.test(t)?t:""}catch{return""}}function VL(e){return`${e.appName}!${e.appId}`}const BL=new Map;function $L(e,t){const n=VL(e);zL(n,t),function(e,t){const n=(!HL&&"BroadcastChannel"in self&&(HL=new BroadcastChannel("[Firebase] FID Change"),HL.onmessage=e=>{zL(e.data.key,e.data.fid)}),HL);n&&n.postMessage({key:e,fid:t}),0===BL.size&&HL&&(HL.close(),HL=null)}(n,t)}function zL(e,t){const n=BL.get(e);if(n)for(const r of n)r(t)}let HL=null;const GL="firebase-installations-store";let ZL=null;function qL(){return ZL||(ZL=kP("firebase-installations-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(GL)}})),ZL}function WL(e,t){return jL.apply(this,arguments)}function jL(){return jL=Ow(function*(e,t){const n=VL(e),r=(yield qL()).transaction(GL,"readwrite"),i=r.objectStore(GL),s=yield i.get(n);return yield i.put(t,n),yield r.done,(!s||s.fid!==t.fid)&&$L(e,t.fid),t}),jL.apply(this,arguments)}function YL(e){return KL.apply(this,arguments)}function KL(){return KL=Ow(function*(e){const t=VL(e),n=(yield qL()).transaction(GL,"readwrite");yield n.objectStore(GL).delete(t),yield n.done}),KL.apply(this,arguments)}function QL(e,t){return XL.apply(this,arguments)}function XL(){return XL=Ow(function*(e,t){const n=VL(e),r=(yield qL()).transaction(GL,"readwrite"),i=r.objectStore(GL),s=yield i.get(n),o=t(s);return void 0===o?yield i.delete(n):yield i.put(o,n),yield r.done,o&&(!s||s.fid!==o.fid)&&$L(e,o.fid),o}),XL.apply(this,arguments)}function JL(e){return eF.apply(this,arguments)}function eF(){return eF=Ow(function*(e){let t;const n=yield QL(e.appConfig,n=>{const r=tF(n),i=nF(e,r);return t=i.registrationPromise,i.installationEntry});return""===n.fid?{installationEntry:yield t}:{installationEntry:n,registrationPromise:t}}),eF.apply(this,arguments)}function tF(e){return aF(e||{fid:UL(),registrationStatus:0})}function nF(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(PL.create("app-offline"))};const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function(e,t){return rF.apply(this,arguments)}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:iF(e)}:{installationEntry:t}}function rF(){return rF=Ow(function*(e,t){try{const n=yield xL(e,t);return WL(e.appConfig,n)}catch(n){throw SL(n)&&409===n.customData.serverCode?yield YL(e.appConfig):yield WL(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}),rF.apply(this,arguments)}function iF(e){return sF.apply(this,arguments)}function sF(){return sF=Ow(function*(e){let t=yield oF(e.appConfig);for(;1===t.registrationStatus;)yield LL(100),t=yield oF(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=yield JL(e);return n||t}return t}),sF.apply(this,arguments)}function oF(e){return QL(e,e=>{if(!e)throw PL.create("installation-not-found");return aF(e)})}function aF(e){return function(e){return 1===e.registrationStatus&&e.registrationTime+1e4<Date.now()}(e)?{fid:e.fid,registrationStatus:0}:e}function lF(e,t){return cF.apply(this,arguments)}function cF(){return cF=Ow(function*({appConfig:e,heartbeatServiceProvider:t},n){const r=uF(e,n),i=AL(e,n),s=t.getImmediate({optional:!0});if(s){const e=yield s.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const o={method:"POST",headers:i,body:JSON.stringify({installation:{sdkVersion:EL,appId:e.appId}})},a=yield ML(()=>fetch(r,o));if(a.ok)return OL(yield a.json());throw yield TL("Generate Auth Token",a)}),cF.apply(this,arguments)}function uF(e,{fid:t}){return`${bL(e)}/${t}/authTokens:generate`}function hF(e){return dF.apply(this,arguments)}function dF(){return dF=Ow(function*(e,t=!1){let n;const r=yield QL(e.appConfig,r=>{if(!vF(r))throw PL.create("not-registered");const i=r.authToken;if(!t&&CF(i))return r;if(1===i.requestStatus)return n=fF(e,t),r;{if(!navigator.onLine)throw PL.create("app-offline");const t=_F(r);return n=mF(e,t),t}});return n?yield n:r.authToken}),dF.apply(this,arguments)}function fF(e,t){return pF.apply(this,arguments)}function pF(){return pF=Ow(function*(e,t){let n=yield gF(e.appConfig);for(;1===n.authToken.requestStatus;)yield LL(100),n=yield gF(e.appConfig);const r=n.authToken;return 0===r.requestStatus?hF(e,t):r}),pF.apply(this,arguments)}function gF(e){return QL(e,e=>{if(!vF(e))throw PL.create("not-registered");return function(e){return 1===e.requestStatus&&e.requestTime+1e4<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function mF(e,t){return yF.apply(this,arguments)}function yF(){return yF=Ow(function*(e,t){try{const n=yield lF(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return yield WL(e.appConfig,r),n}catch(n){if(!SL(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});yield WL(e.appConfig,n)}else yield YL(e.appConfig);throw n}}),yF.apply(this,arguments)}function vF(e){return void 0!==e&&2===e.registrationStatus}function CF(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(e)}function _F(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}function EF(){return EF=Ow(function*(e){const t=e,{installationEntry:n,registrationPromise:r}=yield JL(t);return r?r.catch(console.error):hF(t).catch(console.error),n.fid}),EF.apply(this,arguments)}function wF(){return wF=Ow(function*(e,t=!1){const n=e;return yield PF(n),(yield hF(n,t)).token}),wF.apply(this,arguments)}function PF(e){return SF.apply(this,arguments)}function SF(){return SF=Ow(function*(e){const{registrationPromise:t}=yield JL(e);t&&(yield t)}),SF.apply(this,arguments)}function bF(e){return PL.create("missing-app-config-values",{valueName:e})}const OF="installations";GP(new aP(OF,e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw bF("App Configuration");if(!e.name)throw bF("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw bF(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:ZP(t,"heartbeat"),_delete:()=>Promise.resolve()}},"PUBLIC")),GP(new aP("installations-internal",e=>{const t=ZP(e.getProvider("app").getImmediate(),OF).getImmediate();return{getId:()=>function(e){return EF.apply(this,arguments)}(t),getToken:e=>function(e){return wF.apply(this,arguments)}(t,e)}},"PRIVATE")),XP(CL,_L),XP(CL,_L,"esm2017");const TF="@firebase/remote-config",IF=new Kw("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class kF{constructor(e,t,n,r){this.client=e,this.storage=t,this.storageCache=n,this.logger=r}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const n=Date.now()-t,r=n<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${n}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${r}.`),r}fetch(e){var t=this;return Ow(function*(){const[n,r]=yield Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);if(r&&t.isCachedDataFresh(e.cacheMaxAgeMillis,n))return r;e.eTag=r&&r.eTag;const i=yield t.client.fetch(e),s=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===i.status&&s.push(t.storage.setLastSuccessfulFetchResponse(i)),yield Promise.all(s),i})()}}function AF(e=navigator){return e.languages&&e.languages[0]||e.language}class MF{constructor(e,t,n,r,i,s){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=s}fetch(e){var t=this;return Ow(function*(){var n,r,i;const[s,o]=yield Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]),a=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${t.projectId}/namespaces/${t.namespace}:fetch?key=${t.apiKey}`,l={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},c={sdk_version:t.sdkVersion,app_instance_id:s,app_instance_id_token:o,app_id:t.appId,language_code:AF()},u={method:"POST",headers:l,body:JSON.stringify(c)},h=fetch(a,u),d=new Promise((t,n)=>{e.signal.addEventListener(()=>{const e=new Error("The operation was aborted.");e.name="AbortError",n(e)})});let f;try{yield Promise.race([h,d]),f=yield h}catch(v){let e="fetch-client-network";throw"AbortError"===(null===(n=v)||void 0===n?void 0:n.name)&&(e="fetch-timeout"),IF.create(e,{originalErrorMessage:null===(r=v)||void 0===r?void 0:r.message})}let p=f.status;const g=f.headers.get("ETag")||void 0;let m,y;if(200===f.status){let e;try{e=yield f.json()}catch(C){throw IF.create("fetch-client-parse",{originalErrorMessage:null===(i=C)||void 0===i?void 0:i.message})}m=e.entries,y=e.state}if("INSTANCE_STATE_UNSPECIFIED"===y?p=500:"NO_CHANGE"===y?p=304:("NO_TEMPLATE"===y||"EMPTY_CONFIG"===y)&&(m={}),304!==p&&200!==p)throw IF.create("fetch-status",{httpStatus:p});return{status:p,eTag:g,config:m}})()}}class NF{constructor(e,t){this.client=e,this.storage=t}fetch(e){var t=this;return Ow(function*(){const n=(yield t.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return t.attemptFetch(e,n)})()}attemptFetch(e,{throttleEndTimeMillis:t,backoffCount:n}){var r=this;return Ow(function*(){yield function(e,t){return new Promise((n,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(n,i);e.addEventListener(()=>{clearTimeout(s),r(IF.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(e.signal,t);try{const t=yield r.client.fetch(e);return yield r.storage.deleteThrottleMetadata(),t}catch(i){if(!function(e){if(!(e instanceof Yw&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(i))throw i;const t={throttleEndTimeMillis:Date.now()+sP(n),backoffCount:n+1};return yield r.storage.setThrottleMetadata(t),r.attemptFetch(e,t)}})()}}class RF{constructor(e,t,n,r,i){this.app=e,this._client=t,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function xF(e,t){var n;const r=e.target.error||void 0;return IF.create(t,{originalErrorMessage:r&&(null===(n=r)||void 0===n?void 0:n.message)})}const DF="app_namespace_store";class LF{constructor(e,t,n,r=function(){return new Promise((e,t)=>{var r;try{const n=indexedDB.open("firebase_remote_config",1);n.onerror=e=>{t(xF(e,"storage-open"))},n.onsuccess=t=>{e(t.target.result)},n.onupgradeneeded=e=>{0===e.oldVersion&&e.target.result.createObjectStore(DF,{keyPath:"compositeKey"})}}catch(n){t(IF.create("storage-open",{originalErrorMessage:null===(r=n)||void 0===r?void 0:r.message}))}})}()){this.appId=e,this.appName=t,this.namespace=n,this.openDbPromise=r}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(e){var t=this;return Ow(function*(){const n=yield t.openDbPromise;return new Promise((r,i)=>{var s;const o=n.transaction([DF],"readonly").objectStore(DF),a=t.createCompositeKey(e);try{const e=o.get(a);e.onerror=e=>{i(xF(e,"storage-get"))},e.onsuccess=e=>{const t=e.target.result;r(t?t.value:void 0)}}catch(l){i(IF.create("storage-get",{originalErrorMessage:null===(s=l)||void 0===s?void 0:s.message}))}})})()}set(e,t){var n=this;return Ow(function*(){const r=yield n.openDbPromise;return new Promise((i,s)=>{var o;const a=r.transaction([DF],"readwrite").objectStore(DF),l=n.createCompositeKey(e);try{const e=a.put({compositeKey:l,value:t});e.onerror=e=>{s(xF(e,"storage-set"))},e.onsuccess=()=>{i()}}catch(c){s(IF.create("storage-set",{originalErrorMessage:null===(o=c)||void 0===o?void 0:o.message}))}})})()}delete(e){var t=this;return Ow(function*(){const n=yield t.openDbPromise;return new Promise((r,i)=>{var s;const o=n.transaction([DF],"readwrite").objectStore(DF),a=t.createCompositeKey(e);try{const e=o.delete(a);e.onerror=e=>{i(xF(e,"storage-delete"))},e.onsuccess=()=>{r()}}catch(l){i(IF.create("storage-delete",{originalErrorMessage:null===(s=l)||void 0===s?void 0:s.message}))}})})()}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}class FF{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var e=this;return Ow(function*(){const t=e.storage.getLastFetchStatus(),n=e.storage.getLastSuccessfulFetchTimestampMillis(),r=e.storage.getActiveConfig(),i=yield t;i&&(e.lastFetchStatus=i);const s=yield n;s&&(e.lastSuccessfulFetchTimestampMillis=s);const o=yield r;o&&(e.activeConfig=o)})()}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}function UF(){return VF.apply(this,arguments)}function VF(){return(VF=Ow(function*(){if(!qw())return!1;try{return yield Ww()}catch{return!1}})).apply(this,arguments)}GP(new aP("remote-config",function(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw IF.create("registration-window");if(!qw())throw IF.create("indexed-db-unavailable");const{projectId:i,apiKey:s,appId:o}=n.options;if(!i)throw IF.create("registration-project-id");if(!s)throw IF.create("registration-api-key");if(!o)throw IF.create("registration-app-id");const a=new LF(o,n.name,t=t||"firebase"),l=new FF(a),c=new yP(TF);c.logLevel=dP.ERROR;const u=new MF(r,jP,t,i,s,o),h=new NF(u,a),d=new kF(h,a,l,c),f=new RF(n,d,l,a,c);return function(e){const t=oP(e);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(()=>{t._isInitializationComplete=!0}))}(f),f},"PUBLIC").setMultipleInstances(!0)),XP(TF,"0.3.11"),XP(TF,"0.3.11","esm2017");const BF="/firebase-messaging-sw.js",$F="/firebase-cloud-messaging-push-scope",zF="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",HF="google.c.a.c_id",GF="google.c.a.c_l",ZF="google.c.a.ts",qF="google.c.a.e";var WF=(()=>(function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(WF||(WF={})),WF))();function jF(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function YF(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}const KF="fcm_token_details_db",QF="fcm_token_object_Store";function XF(e){return JF.apply(this,arguments)}function JF(){return JF=Ow(function*(e){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(e=>e.name).includes(KF))return null;let t=null;return(yield kP(KF,5,{upgrade:(n=Ow(function*(n,r,i,s){var o;if(r<2||!n.objectStoreNames.contains(QF))return;const a=s.objectStore(QF),l=yield a.index("fcmSenderId").get(e);if(yield a.clear(),l)if(2===r){const e=l;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:null!==(o=e.createTime)&&void 0!==o?o:Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"==typeof e.vapidKey?e.vapidKey:jF(e.vapidKey)}}}else if(3===r){const e=l;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:jF(e.auth),p256dh:jF(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:jF(e.vapidKey)}}}else if(4===r){const e=l;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:jF(e.auth),p256dh:jF(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:jF(e.vapidKey)}}}}),function(e,t,r,i){return n.apply(this,arguments)})})).close(),yield AP(KF),yield AP("fcm_vapid_details_db"),yield AP("undefined"),eU(t)?t:null;var n}),JF.apply(this,arguments)}function eU(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}const tU="firebase-messaging-store";let nU=null;function rU(){return nU||(nU=kP("firebase-messaging-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(tU)}})),nU}function iU(e){return sU.apply(this,arguments)}function sU(){return sU=Ow(function*(e){const t=uU(e),n=yield(yield rU()).transaction(tU).objectStore(tU).get(t);if(n)return n;{const t=yield XF(e.appConfig.senderId);if(t)return yield oU(e,t),t}}),sU.apply(this,arguments)}function oU(e,t){return aU.apply(this,arguments)}function aU(){return aU=Ow(function*(e,t){const n=uU(e),r=(yield rU()).transaction(tU,"readwrite");return yield r.objectStore(tU).put(t,n),yield r.done,t}),aU.apply(this,arguments)}function lU(e){return cU.apply(this,arguments)}function cU(){return cU=Ow(function*(e){const t=uU(e),n=(yield rU()).transaction(tU,"readwrite");yield n.objectStore(tU).delete(t),yield n.done}),cU.apply(this,arguments)}function uU({appConfig:e}){return e.appId}const hU=new Kw("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function dU(e,t){return fU.apply(this,arguments)}function fU(){return fU=Ow(function*(e,t){var n;const r=yield CU(e),i=EU(t),s={method:"POST",headers:r,body:JSON.stringify(i)};let o;try{o=yield(yield fetch(vU(e.appConfig),s)).json()}catch(a){throw hU.create("token-subscribe-failed",{errorInfo:null===(n=a)||void 0===n?void 0:n.toString()})}if(o.error)throw hU.create("token-subscribe-failed",{errorInfo:o.error.message});if(!o.token)throw hU.create("token-subscribe-no-token");return o.token}),fU.apply(this,arguments)}function pU(e,t){return gU.apply(this,arguments)}function gU(){return gU=Ow(function*(e,t){var n;const r=yield CU(e),i=EU(t.subscriptionOptions),s={method:"PATCH",headers:r,body:JSON.stringify(i)};let o;try{o=yield(yield fetch(`${vU(e.appConfig)}/${t.token}`,s)).json()}catch(a){throw hU.create("token-update-failed",{errorInfo:null===(n=a)||void 0===n?void 0:n.toString()})}if(o.error)throw hU.create("token-update-failed",{errorInfo:o.error.message});if(!o.token)throw hU.create("token-update-no-token");return o.token}),gU.apply(this,arguments)}function mU(e,t){return yU.apply(this,arguments)}function yU(){return yU=Ow(function*(e,t){var n;const r={method:"DELETE",headers:yield CU(e)};try{const n=yield(yield fetch(`${vU(e.appConfig)}/${t}`,r)).json();if(n.error)throw hU.create("token-unsubscribe-failed",{errorInfo:n.error.message})}catch(i){throw hU.create("token-unsubscribe-failed",{errorInfo:null===(n=i)||void 0===n?void 0:n.toString()})}}),yU.apply(this,arguments)}function vU({projectId:e}){return`https://fcmregistrations.googleapis.com/v1/projects/${e}/registrations`}function CU(e){return _U.apply(this,arguments)}function _U(){return _U=Ow(function*({appConfig:e,installations:t}){const n=yield t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}),_U.apply(this,arguments)}function EU({p256dh:e,auth:t,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:t,p256dh:e}};return r!==zF&&(i.web.applicationPubKey=r),i}function wU(e){return PU.apply(this,arguments)}function PU(){return PU=Ow(function*(e){const t=yield AU(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:jF(t.getKey("auth")),p256dh:jF(t.getKey("p256dh"))},r=yield iU(e.firebaseDependencies);if(r){if(NU(r.subscriptionOptions,n))return Date.now()>=r.createTime+6048e5?OU(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{yield mU(e.firebaseDependencies,r.token)}catch(i){console.warn(i)}return IU(e.firebaseDependencies,n)}return IU(e.firebaseDependencies,n)}),PU.apply(this,arguments)}function SU(e){return bU.apply(this,arguments)}function bU(){return bU=Ow(function*(e){const t=yield iU(e.firebaseDependencies);t&&(yield mU(e.firebaseDependencies,t.token),yield lU(e.firebaseDependencies));const n=yield e.swRegistration.pushManager.getSubscription();return!n||n.unsubscribe()}),bU.apply(this,arguments)}function OU(e,t){return TU.apply(this,arguments)}function TU(){return TU=Ow(function*(e,t){try{const n=yield pU(e.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:n,createTime:Date.now()});return yield oU(e.firebaseDependencies,r),n}catch(n){throw yield SU(e),n}}),TU.apply(this,arguments)}function IU(e,t){return kU.apply(this,arguments)}function kU(){return kU=Ow(function*(e,t){const n={token:yield dU(e,t),createTime:Date.now(),subscriptionOptions:t};return yield oU(e,n),n.token}),kU.apply(this,arguments)}function AU(e,t){return MU.apply(this,arguments)}function MU(){return MU=Ow(function*(e,t){return(yield e.pushManager.getSubscription())||e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:YF(t)})}),MU.apply(this,arguments)}function NU(e,t){return t.vapidKey===e.vapidKey&&t.endpoint===e.endpoint&&t.auth===e.auth&&t.p256dh===e.p256dh}function RU(e){const t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(!t.notification)return;e.notification={};const n=t.notification.title;n&&(e.notification.title=n);const r=t.notification.body;r&&(e.notification.body=r);const i=t.notification.image;i&&(e.notification.image=i)}(t,e),function(e,t){!t.data||(e.data=t.data)}(t,e),function(e,t){var n,r,i,s,o;if(!t.fcmOptions&&!(null===(n=t.notification)||void 0===n?void 0:n.click_action))return;e.fcmOptions={};const a=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(s=t.notification)||void 0===s?void 0:s.click_action;a&&(e.fcmOptions.link=a);const l=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;l&&(e.fcmOptions.analyticsLabel=l)}(t,e),t}function xU(e){return"object"==typeof e&&!!e&&HF in e}function DU(e,t){const n=[];for(let r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function LU(e){return hU.create("missing-app-config-values",{valueName:e})}DU("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),DU("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class FU{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=function(e){if(!e||!e.options)throw LU("App Configuration Object");if(!e.name)throw LU("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(const r of t)if(!n[r])throw LU(r);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}function UU(e){return VU.apply(this,arguments)}function VU(){return VU=Ow(function*(e){var t;try{e.swRegistration=yield navigator.serviceWorker.register(BF,{scope:$F}),e.swRegistration.update().catch(()=>{})}catch(n){throw hU.create("failed-service-worker-registration",{browserErrorMessage:null===(t=n)||void 0===t?void 0:t.message})}}),VU.apply(this,arguments)}function BU(e,t){return $U.apply(this,arguments)}function $U(){return $U=Ow(function*(e,t){if(!t&&!e.swRegistration&&(yield UU(e)),t||!e.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw hU.create("invalid-sw-registration");e.swRegistration=t}}),$U.apply(this,arguments)}function zU(e,t){return HU.apply(this,arguments)}function HU(){return HU=Ow(function*(e,t){t?e.vapidKey=t:e.vapidKey||(e.vapidKey=zF)}),HU.apply(this,arguments)}function GU(){return GU=Ow(function*(e,t){if(!navigator)throw hU.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw hU.create("permission-blocked");return yield zU(e,null==t?void 0:t.vapidKey),yield BU(e,null==t?void 0:t.serviceWorkerRegistration),wU(e)}),GU.apply(this,arguments)}function ZU(e,t,n){return qU.apply(this,arguments)}function qU(){return qU=Ow(function*(e,t,n){const r=WU(t);(yield e.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[HF],message_name:n[GF],message_time:n[ZF],message_device_time:Math.floor(Date.now()/1e3)})}),qU.apply(this,arguments)}function WU(e){switch(e){case WF.NOTIFICATION_CLICKED:return"notification_open";case WF.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function jU(){return jU=Ow(function*(e,t){const n=t.data;if(!n.isFirebaseMessaging)return;e.onMessageHandler&&n.messageType===WF.PUSH_RECEIVED&&("function"==typeof e.onMessageHandler?e.onMessageHandler(RU(n)):e.onMessageHandler.next(RU(n)));const r=n.data;xU(r)&&"1"===r[qF]&&(yield ZU(e,n.messageType,r))}),jU.apply(this,arguments)}const YU="@firebase/messaging";function KU(){return QU.apply(this,arguments)}function QU(){return(QU=Ow(function*(){try{yield Ww()}catch{return!1}return"undefined"!=typeof window&&qw()&&jw()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}GP(new aP("messaging",e=>{const t=new FU(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",e=>function(e,t){return jU.apply(this,arguments)}(t,e)),t},"PUBLIC")),GP(new aP("messaging-internal",e=>{const t=e.getProvider("messaging").getImmediate();return{getToken:e=>function(e,t){return GU.apply(this,arguments)}(t,e)}},"PRIVATE")),XP(YU,"0.9.16"),XP(YU,"0.9.16","esm2017");const XU="analytics",JU="firebase_id",eV="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",tV="https://www.googletagmanager.com/gtag/js",nV=new yP("@firebase/analytics");function rV(e){return Promise.all(e.map(e=>e.catch(e=>e)))}function iV(e,t){const n=document.createElement("script");n.src=`${tV}?l=${e}&id=${t}`,n.async=!0,document.head.appendChild(n)}function sV(e,t,n,r,i,s){return oV.apply(this,arguments)}function oV(){return oV=Ow(function*(e,t,n,r,i,s){const o=r[i];try{if(o)yield t[o];else{const e=(yield rV(n)).find(e=>e.measurementId===i);e&&(yield t[e.appId])}}catch(a){nV.error(a)}e("config",i,s)}),oV.apply(this,arguments)}function aV(e,t,n,r,i){return lV.apply(this,arguments)}function lV(){return lV=Ow(function*(e,t,n,r,i){try{let s=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);const r=yield rV(n);for(const n of e){const e=r.find(e=>e.measurementId===n),i=e&&t[e.appId];if(!i){s=[];break}s.push(i)}}0===s.length&&(s=Object.values(t)),yield Promise.all(s),e("event",r,i||{})}catch(s){nV.error(s)}}),lV.apply(this,arguments)}function cV(){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(tV))return t;return null}const uV=new Kw("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),hV=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function dV(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}function fV(e){return pV.apply(this,arguments)}function pV(){return pV=Ow(function*(e){var t;const{appId:n,apiKey:r}=e,i={method:"GET",headers:dV(r)},s=eV.replace("{app-id}",n),o=yield fetch(s,i);if(200!==o.status&&304!==o.status){let e="";try{const n=yield o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch{}throw uV.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}),pV.apply(this,arguments)}function gV(e){return mV.apply(this,arguments)}function mV(){return mV=Ow(function*(e,t=hV,n){const{appId:r,apiKey:i,measurementId:s}=e.options;if(!r)throw uV.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw uV.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new EV;return setTimeout(Ow(function*(){a.abort()}),void 0!==n?n:6e4),yV({appId:r,apiKey:i,measurementId:s},o,a,t)}),mV.apply(this,arguments)}function yV(e,t,n){return vV.apply(this,arguments)}function vV(){return vV=Ow(function*(e,{throttleEndTimeMillis:t,backoffCount:n},r,i=hV){var s,o;const{appId:a,measurementId:l}=e;try{yield CV(r,t)}catch(c){if(l)return nV.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null===(s=c)||void 0===s?void 0:s.message}]`),{appId:a,measurementId:l};throw c}try{const t=yield fV(e);return i.deleteThrottleMetadata(a),t}catch(c){const t=c;if(!_V(t)){if(i.deleteThrottleMetadata(a),l)return nV.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null==t?void 0:t.message}]`),{appId:a,measurementId:l};throw c}const s=503===Number(null===(o=null==t?void 0:t.customData)||void 0===o?void 0:o.httpStatus)?sP(n,i.intervalMillis,30):sP(n,i.intervalMillis),u={throttleEndTimeMillis:Date.now()+s,backoffCount:n+1};return i.setThrottleMetadata(a,u),nV.debug(`Calling attemptFetch again in ${s} millis`),yV(e,u,r,i)}}),vV.apply(this,arguments)}function CV(e,t){return new Promise((n,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(n,i);e.addEventListener(()=>{clearTimeout(s),r(uV.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function _V(e){if(!(e instanceof Yw&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}class EV{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let wV,PV;function SV(){return SV=Ow(function*(e,t,n,r,i){if(i&&i.global)e("event",n,r);else{const i=yield t;e("event",n,Object.assign(Object.assign({},r),{send_to:i}))}}),SV.apply(this,arguments)}function bV(e){PV=e}function OV(e){wV=e}function TV(){return IV.apply(this,arguments)}function IV(){return IV=Ow(function*(){var e;if(!qw())return nV.warn(uV.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield Ww()}catch(t){return nV.warn(uV.create("indexeddb-unavailable",{errorInfo:null===(e=t)||void 0===e?void 0:e.toString()}).message),!1}return!0}),IV.apply(this,arguments)}function kV(){return kV=Ow(function*(e,t,n,r,i,s,o){var a;const l=gV(e);l.then(t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&nV.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(e=>nV.error(e)),t.push(l);const c=TV().then(e=>{if(e)return r.getId()}),[u,h]=yield Promise.all([l,c]);cV()||iV(s,u.measurementId),PV&&(i("consent","default",PV),bV(void 0)),i("js",new Date);const d=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return d.origin="firebase",d.update=!0,null!=h&&(d[JU]=h),i("config",u.measurementId,d),wV&&(i("set",wV),OV(void 0)),u.measurementId}),kV.apply(this,arguments)}class AV{constructor(e){this.app=e}_delete(){return delete MV[this.app.options.appId],Promise.resolve()}}let MV={},NV=[];const RV={};let xV,DV,LV="dataLayer",FV=!1;function UV(e,t,n){!function(){const e=[];if(Hw()&&e.push("This is a browser extension environment."),jw()||e.push("Cookies are not available."),e.length>0){const t=e.map((e,t)=>`(${t+1}) ${e}`).join(" "),n=uV.create("invalid-analytics-context",{errorInfo:t});nV.warn(n.message)}}();const r=e.options.appId;if(!r)throw uV.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw uV.create("no-api-key");nV.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=MV[r])throw uV.create("already-exists",{id:r});if(!FV){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(LV);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,i){let s=function(...e){window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(s=window[i]),window[i]=function(e,t,n,r){function i(){return(i=Ow(function*(i,s,o){try{"event"===i?yield aV(e,t,n,s,o):"config"===i?yield sV(e,t,n,r,s,o):"consent"===i?e("consent","update",o):e("set",s)}catch(a){nV.error(a)}})).apply(this,arguments)}return function(e,t,n){return i.apply(this,arguments)}}(s,e,t,n),{gtagCore:s,wrappedGtag:window[i]}}(MV,NV,RV,LV,"gtag");DV=e,xV=t,FV=!0}return MV[r]=function(e,t,n,r,i,s,o){return kV.apply(this,arguments)}(e,NV,RV,t,xV,LV,n),new AV(e)}function VV(){return BV.apply(this,arguments)}function BV(){return(BV=Ow(function*(){if(Hw()||!jw()||!qw())return!1;try{return yield Ww()}catch{return!1}})).apply(this,arguments)}const $V="@firebase/analytics";GP(new aP(XU,(e,{options:t})=>UV(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t),"PUBLIC")),GP(new aP("analytics-internal",function(e){try{const t=e.getProvider(XU).getImmediate();return{logEvent:(e,n,r)=>function(e,t,n,r){e=oP(e),function(e,t,n,r,i){return SV.apply(this,arguments)}(DV,MV[e.app.options.appId],t,n,r).catch(e=>nV.error(e))}(t,e,n,r)}}catch(t){throw uV.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),XP($V,"0.8.0"),XP($V,"0.8.0","esm2017");class zV extends a{constructor(e,t){super()}schedule(e,t=0){return this}}const HV={setInterval(...e){const{delegate:t}=HV;return((null==t?void 0:t.setInterval)||setInterval)(...e)},clearInterval(e){const{delegate:t}=HV;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0};class GV extends zV{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,n=0){return HV.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;HV.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let n,r=!1;try{this.work(e)}catch(i){r=!0,n=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,o(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const ZV={now:()=>(ZV.delegate||Date).now(),delegate:void 0};class qV{constructor(e,t=qV.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}qV.now=ZV.now;class WV extends qV{constructor(e,t=qV.now){super(e,t),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}const jV=new class extends WV{}(class extends GV{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,n=0){return null!=n&&n>0||null==n&&this.delay>0?super.requestAsyncId(e,t,n):e.flush(this)}}),YV=new WV(GV),KV=new kc("7.4.1"),QV="__angularfire_symbol__analyticsIsSupportedValue",XV="__angularfire_symbol__analyticsIsSupported",JV="__angularfire_symbol__remoteConfigIsSupportedValue",eB="__angularfire_symbol__remoteConfigIsSupported",tB="__angularfire_symbol__messagingIsSupportedValue",nB="__angularfire_symbol__messagingIsSupported";function rB(e,t,n){if(t){if(1===t.length)return t[0];const e=t.filter(e=>e.app===n);if(1===e.length)return e[0]}return n.container.getProvider(e).getImmediate({optional:!0})}globalThis[XV]||(globalThis[XV]=VV().then(e=>globalThis[QV]=e).catch(()=>globalThis[QV]=!1)),globalThis[nB]||(globalThis[nB]=KU().then(e=>globalThis[tB]=e).catch(()=>globalThis[tB]=!1)),globalThis[eB]||(globalThis[eB]=UF().then(e=>globalThis[JV]=e).catch(()=>globalThis[JV]=!1));const iB=(e,t)=>{const n=t?[t]:QP(),r=[];return n.forEach(t=>{t.container.getProvider(e).instances.forEach(e=>{r.includes(e)||r.push(e)})}),r};function sB(){}class oB{constructor(e,t=jV){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,n){const r=this.zone;return this.delegate.schedule(function(t){r.runGuarded(()=>{e.apply(this,[t])})},t,n)}}class aB{constructor(e){this.zone=e,this.task=null}call(e,t){const n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",sB,{},sB,sB)),t.pipe(Um({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let lB=(()=>{class e{constructor(e){this.ngZone=e,this.outsideAngular=e.runOutsideAngular(()=>new oB(Zone.current)),this.insideAngular=e.run(()=>new oB(Zone.current,YV)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return e.\u0275fac=function(t){return new(t||e)(Or(vh))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function cB(){const e=globalThis.\u0275AngularFireScheduler;if(!e)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return e}function uB(e){return cB().ngZone.runOutsideAngular(()=>e())}function hB(e){return cB().ngZone.run(()=>e())}function dB(e){return cB(),function(e){return function(t){return(t=t.lift(new aB(e.ngZone))).pipe(se(e.outsideAngular),ie(e.insideAngular))}}(cB())(e)}const fB=(e,t)=>{const n=void 0;return function(){const r=arguments;return t&&setTimeout(()=>{"scheduled"===t.state&&t.invoke()},10),hB(()=>e.apply(n,r))}},pB=(e,t)=>function(){let n;const r=arguments;for(let e=0;e<arguments.length;e++)"function"==typeof r[e]&&(t&&(n||(n=hB(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",sB,{},sB,sB)))),r[e]=fB(r[e],n));const i=uB(()=>e.apply(this,r));if(!t){if(i instanceof T){const e=cB();return i.pipe(se(e.outsideAngular),ie(e.insideAngular))}return hB(()=>i)}return i instanceof T?i.pipe(dB):i instanceof Promise?hB(()=>new Promise((e,t)=>i.then(t=>hB(()=>e(t)),e=>hB(()=>t(e))))):"function"==typeof i&&n?function(){return setTimeout(()=>{n&&"scheduled"===n.state&&n.invoke()},10),i.apply(this,arguments)}:hB(()=>i)};class gB{constructor(e){return e}}class mB{constructor(){return QP()}}const yB=new or("angularfire2._apps"),vB={provide:gB,useFactory:function(e){return e&&1===e.length?e[0]:new gB(KP())},deps:[[new Nr,yB]]},CB={provide:mB,deps:[[new Nr,yB]]};function _B(e){return(t,n)=>{const r=t.runOutsideAngular(()=>e(n));return new gB(r)}}let EB=(()=>{class e{constructor(e){XP("angularfire",KV.full,"core"),XP("angularfire",KV.full,"app"),XP("angular",Ac.full,e.toString())}}return e.\u0275fac=function(t){return new(t||e)(Or(rh))},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({providers:[vB,CB]}),e})();const wB=pB(YP,!0),PB=new Map,SB={activated:!1,tokenObservers:[]},bB={initialized:!1,enabled:!1};function OB(e){return PB.get(e)||SB}function TB(e,t){PB.set(e,t)}function IB(){return bB}class kB{constructor(e,t,n,r,i){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=r,r>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return Ow(function*(){t.stop();try{t.pending=new Bw,yield function(e){return new Promise(t=>{setTimeout(t,e)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new Bw,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(n){t.retryPolicy(n)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e}}}const AB=new Kw("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function MB(e){if(!OB(e).activated)throw AB.create("use-before-activation",{appName:e.name})}function NB(e,t){return RB.apply(this,arguments)}function RB(){return RB=Ow(function*({url:e,body:t},n){var r,i;const s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){const e=yield o.getHeartbeatsHeader();e&&(s["X-Firebase-Client"]=e)}const a={method:"POST",body:JSON.stringify(t),headers:s};let l,c;try{l=yield fetch(e,a)}catch(f){throw AB.create("fetch-network-error",{originalErrorMessage:null===(r=f)||void 0===r?void 0:r.message})}if(200!==l.status)throw AB.create("fetch-status-error",{httpStatus:l.status});try{c=yield l.json()}catch(f){throw AB.create("fetch-parse-error",{originalErrorMessage:null===(i=f)||void 0===i?void 0:i.message})}const u=c.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw AB.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});const h=1e3*Number(u[1]),d=Date.now();return{token:c.token,expireTimeMillis:d+h,issuedAtTimeMillis:d}}),RB.apply(this,arguments)}function xB(e,t){const{projectId:n,appId:r,apiKey:i}=e.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${n}/apps/${r}:exchangeDebugToken?key=${i}`,body:{debug_token:t}}}const DB="firebase-app-check-store";let LB=null;function FB(){return LB||(LB=new Promise((e,t)=>{var n;try{const n=indexedDB.open("firebase-app-check-database",1);n.onsuccess=t=>{e(t.target.result)},n.onerror=e=>{var n;t(AB.create("storage-open",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))},n.onupgradeneeded=e=>{0===e.oldVersion&&e.target.result.createObjectStore(DB,{keyPath:"compositeKey"})}}catch(r){t(AB.create("storage-open",{originalErrorMessage:null===(n=r)||void 0===n?void 0:n.message}))}}),LB)}function UB(){return UB=Ow(function*(e,t){const n=(yield FB()).transaction(DB,"readwrite"),r=n.objectStore(DB).put({compositeKey:e,value:t});return new Promise((e,t)=>{r.onsuccess=t=>{e()},n.onerror=e=>{var n;t(AB.create("storage-set",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))}})}),UB.apply(this,arguments)}const VB=new yP("@firebase/app-check");function BB(e,t){return qw()?function(e,t){return function(e,t){return UB.apply(this,arguments)}(function(e){return`${e.options.appId}-${e.name}`}(e),t)}(e,t).catch(e=>{VB.warn(`Failed to write token to IndexedDB. Error: ${e}`)}):Promise.resolve()}function $B(){return IB().enabled}function zB(){return HB.apply(this,arguments)}function HB(){return HB=Ow(function*(){const e=IB();if(e.enabled&&e.token)return e.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),HB.apply(this,arguments)}const GB={error:"UNKNOWN_ERROR"};function ZB(e){return Uw.encodeString(JSON.stringify(e),!1)}function qB(e){return WB.apply(this,arguments)}function WB(){return WB=Ow(function*(e,t=!1){const n=e.app;MB(n);const r=OB(n);let i,s=r.token;if(!s){const e=yield r.cachedTokenPromise;e&&QB(e)&&(s=e)}if(!t&&s&&QB(s))return{token:s.token};let o,a=!1;if($B()){r.exchangeTokenPromise||(r.exchangeTokenPromise=NB(xB(n,yield zB()),e.heartbeatServiceProvider).then(e=>(r.exchangeTokenPromise=void 0,e)),a=!0);const t=yield r.exchangeTokenPromise;return yield BB(n,t),TB(n,Object.assign(Object.assign({},r),{token:t})),{token:t.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().then(e=>(r.exchangeTokenPromise=void 0,e)),a=!0),s=yield r.exchangeTokenPromise}catch(l){"appCheck/throttled"===l.code?VB.warn(l.message):VB.error(l),i=l}return s?(o={token:s.token},TB(n,Object.assign(Object.assign({},r),{token:s})),yield BB(n,s)):o=XB(i),a&&KB(n,o),o}),WB.apply(this,arguments)}function jB(e,t){const n=OB(e),r=n.tokenObservers.filter(e=>e.next!==t);0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),TB(e,Object.assign(Object.assign({},n),{tokenObservers:r}))}function YB(e){const{app:t}=e,n=OB(t);let r=n.tokenRefresher;r||(r=function(e){const{app:t}=e;return new kB(Ow(function*(){let n;if(n=OB(t).token?yield qB(e,!0):yield qB(e),n.error)throw n.error}),()=>!0,()=>{const e=OB(t);if(e.token){let t=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return t=Math.min(t,e.token.expireTimeMillis-3e5),Math.max(0,t-Date.now())}return 0},3e4,96e4)}(e),TB(t,Object.assign(Object.assign({},n),{tokenRefresher:r}))),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function KB(e,t){const n=OB(e).tokenObservers;for(const r of n)try{"EXTERNAL"===r.type&&null!=t.error?r.error(t.error):r.next(t)}catch{}}function QB(e){return e.expireTimeMillis-Date.now()>0}function XB(e){return{token:ZB(GB),error:e}}class JB{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=OB(this.app);for(const t of e)jB(this.app,t.next);return Promise.resolve()}}const e$="app-check-internal";GP(new aP("app-check",e=>function(e,t){return new JB(e,t)}(e.getProvider("app").getImmediate(),e.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider(e$).initialize()})),GP(new aP(e$,e=>function(e){return{getToken:t=>qB(e,t),addTokenListener:t=>function(e,t,n,r){const{app:i}=e,s=OB(i),o={next:n,error:r,type:t};if(TB(i,Object.assign(Object.assign({},s),{tokenObservers:[...s.tokenObservers,o]})),s.token&&QB(s.token)){const t=s.token;Promise.resolve().then(()=>{n({token:t.token}),YB(e)}).catch(()=>{})}s.cachedTokenPromise.then(()=>YB(e))}(e,"INTERNAL",t),removeTokenListener:t=>jB(e.app,t)}}(e.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),XP("@firebase/app-check","0.5.11");class t${constructor(){return iB("app-check")}}"undefined"!=typeof window&&window;const n$=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},r$=new Kw("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),i$=new yP("@firebase/auth");function s$(e,...t){i$.logLevel<=dP.ERROR&&i$.error(`Auth (9.9.0): ${e}`,...t)}function o$(e,...t){throw u$(e,...t)}function a$(e,...t){return u$(e,...t)}function l$(e,t,n){const r=Object.assign(Object.assign({},n$()),{[t]:n});return new Kw("auth","Firebase",r).create(t,{appName:e.name})}function c$(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&o$(e,"argument-error"),l$(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function u$(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return r$.create(e,...t)}function h$(e,t,...n){if(!e)throw u$(t,...n)}function d$(e){const t="INTERNAL ASSERTION FAILED: "+e;throw s$(t),new Error(t)}function f$(e,t){e||d$(t)}const p$=new Map;function g$(e){f$(e instanceof Function,"Expected a class definition");let t=p$.get(e);return t?(f$(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,p$.set(e,t),t)}function m$(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function y$(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class v${constructor(e,t){this.shortDelay=e,this.longDelay=t,f$(t>e,"Short delay should be less than long delay!"),this.isMobile=zw()||Gw()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===y$()||"https:"===y$()||Hw()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function C$(e,t){f$(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class _${static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void d$("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void d$("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void d$("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const E$={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},w$=new v$(3e4,6e4);function P$(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function S$(e,t,n,r){return b$.apply(this,arguments)}function b$(){return b$=Ow(function*(e,t,n,r,i={}){return O$(e,i,Ow(function*(){let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=eP(Object.assign({key:e.config.apiKey},s)).slice(1),a=yield e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),_$.fetch()(A$(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},i))}))}),b$.apply(this,arguments)}function O$(e,t,n){return T$.apply(this,arguments)}function T$(){return T$=Ow(function*(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},E$),t);try{const t=new M$(e),i=yield Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=yield i.json();if("needConfirmation"in s)throw N$(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw N$(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw N$(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw N$(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw l$(e,a,o);o$(e,a)}}catch(i){if(i instanceof Yw)throw i;o$(e,"network-request-failed")}}),T$.apply(this,arguments)}function I$(e,t,n,r){return k$.apply(this,arguments)}function k$(){return k$=Ow(function*(e,t,n,r,i={}){const s=yield S$(e,t,n,r,i);return"mfaPendingCredential"in s&&o$(e,"multi-factor-auth-required",{_serverResponse:s}),s}),k$.apply(this,arguments)}function A$(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?C$(e.config,i):`${e.config.apiScheme}://${i}`}class M${constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(a$(this.auth,"network-request-failed")),w$.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function N$(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=a$(e,t,r);return i.customData._tokenResponse=n,i}function R$(){return R$=Ow(function*(e,t){return S$(e,"POST","/v1/accounts:delete",t)}),R$.apply(this,arguments)}function x$(e,t){return D$.apply(this,arguments)}function D$(){return D$=Ow(function*(e,t){return S$(e,"POST","/v1/accounts:lookup",t)}),D$.apply(this,arguments)}function L$(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}function F$(){return F$=Ow(function*(e,t=!1){const n=oP(e),r=yield n.getIdToken(t),i=V$(r);h$(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:L$(U$(i.auth_time)),issuedAtTime:L$(U$(i.iat)),expirationTime:L$(U$(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}),F$.apply(this,arguments)}function U$(e){return 1e3*Number(e)}function V$(e){var t;const[n,r,i]=e.split(".");if(void 0===n||void 0===r||void 0===i)return s$("JWT malformed, contained fewer than 3 sections"),null;try{const e=function(e){try{return Uw.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(r);return e?JSON.parse(e):(s$("Failed to decode base64 JWT payload"),null)}catch(s){return s$("Caught error parsing JWT payload as JSON",null===(t=s)||void 0===t?void 0:t.toString()),null}}function B$(e,t){return $$.apply(this,arguments)}function $$(){return $$=Ow(function*(e,t,n=!1){if(n)return t;try{return yield t}catch(r){throw r instanceof Yw&&z$(r)&&e.auth.currentUser===e&&(yield e.auth.signOut()),r}}),$$.apply(this,arguments)}function z$({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}class H${constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){var t=this;if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(Ow(function*(){yield t.iteration()}),n)}iteration(){var e=this;return Ow(function*(){var t;try{yield e.user.getIdToken(!0)}catch(n){return void("auth/network-request-failed"===(null===(t=n)||void 0===t?void 0:t.code)&&e.schedule(!0))}e.schedule()})()}}class G${constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=L$(this.lastLoginAt),this.creationTime=L$(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Z$(e){return q$.apply(this,arguments)}function q$(){return q$=Ow(function*(e){var t;const n=e.auth,r=yield e.getIdToken(),i=yield B$(e,x$(n,{idToken:r}));h$(null==i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?Y$(s.providerUserInfo):[],a=j$(e.providerData,o),l=!!e.isAnonymous&&!(e.email&&s.passwordHash||(null==a?void 0:a.length)),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new G$(s.createdAt,s.lastLoginAt),isAnonymous:l};Object.assign(e,c)}),q$.apply(this,arguments)}function W$(){return W$=Ow(function*(e){const t=oP(e);yield Z$(t),yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}),W$.apply(this,arguments)}function j$(e,t){return[...e.filter(e=>!t.some(t=>t.providerId===e.providerId)),...t]}function Y$(e){return e.map(e=>{var{providerId:t}=e,n=L(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}function K$(){return K$=Ow(function*(e,t){const n=yield O$(e,{},Ow(function*(){const n=eP({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=A$(e,r,"/v1/token",`key=${i}`),o=yield e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",_$.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}),K$.apply(this,arguments)}class Q${constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){h$(e.idToken,"internal-error"),h$(void 0!==e.idToken,"internal-error"),h$(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=V$(e);return h$(t,"internal-error"),h$(void 0!==t.exp,"internal-error"),h$(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}getToken(e,t=!1){var n=this;return Ow(function*(){return h$(!n.accessToken||n.refreshToken,e,"user-token-expired"),t||!n.accessToken||n.isExpired?n.refreshToken?(yield n.refresh(e,n.refreshToken),n.accessToken):null:n.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(e,t){var n=this;return Ow(function*(){const{accessToken:r,refreshToken:i,expiresIn:s}=yield function(e,t){return K$.apply(this,arguments)}(e,t);n.updateTokensAndExpiration(r,i,Number(s))})()}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Q$;return n&&(h$("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(h$("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(h$("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Q$,this.toJSON())}_performRefresh(){return d$("not implemented")}}function X$(e,t){h$("string"==typeof e||void 0===e,"internal-error",{appName:t})}class J${constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=L(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new H$(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new G$(i.createdAt||void 0,i.lastLoginAt||void 0)}getIdToken(e){var t=this;return Ow(function*(){const n=yield B$(t,t.stsTokenManager.getToken(t.auth,e));return h$(n,t.auth,"internal-error"),t.accessToken!==n&&(t.accessToken=n,yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)),n})()}getIdTokenResult(e){return function(e){return F$.apply(this,arguments)}(this,e)}reload(){return function(e){return W$.apply(this,arguments)}(this)}_assign(e){this!==e&&(h$(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new J$(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){h$(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){var n=this;return Ow(function*(){let r=!1;e.idToken&&e.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Z$(n)),yield n.auth._persistUserIfCurrent(n),r&&n.auth._notifyListenersIfCurrent(n)})()}delete(){var e=this;return Ow(function*(){const t=yield e.getIdToken();return yield B$(e,function(e,t){return R$.apply(this,arguments)}(e.auth,{idToken:t})),e.stsTokenManager.clearRefreshToken(),e.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(l=t.createdAt)&&void 0!==l?l:void 0,y=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:C,isAnonymous:_,providerData:E,stsTokenManager:w}=t;h$(v&&w,e,"internal-error");const P=Q$.fromJSON(this.name,w);h$("string"==typeof v,e,"internal-error"),X$(u,e.name),X$(h,e.name),h$("boolean"==typeof C,e,"internal-error"),h$("boolean"==typeof _,e,"internal-error"),X$(d,e.name),X$(f,e.name),X$(p,e.name),X$(g,e.name),X$(m,e.name),X$(y,e.name);const S=new J$({uid:v,auth:e,email:h,emailVerified:C,displayName:u,isAnonymous:_,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:P,createdAt:m,lastLoginAt:y});return E&&Array.isArray(E)&&(S.providerData=E.map(e=>Object.assign({},e))),g&&(S._redirectEventId=g),S}static _fromIdTokenResponse(e,t,n=!1){return Ow(function*(){const r=new Q$;r.updateFromServerResponse(t);const i=new J$({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return yield Z$(i),i})()}}const ez=(()=>{class e{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return Ow(function*(){return!0})()}_set(e,t){var n=this;return Ow(function*(){n.storage[e]=t})()}_get(e){var t=this;return Ow(function*(){const n=t.storage[e];return void 0===n?null:n})()}_remove(e){var t=this;return Ow(function*(){delete t.storage[e]})()}_addListener(e,t){}_removeListener(e,t){}}return e.type="NONE",e})();function tz(e,t,n){return`firebase:${e}:${t}:${n}`}class nz{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=tz(this.userKey,r.apiKey,i),this.fullPersistenceKey=tz("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){var e=this;return Ow(function*(){const t=yield e.persistence._get(e.fullUserKey);return t?J$._fromJSON(e.auth,t):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){var t=this;return Ow(function*(){if(t.persistence===e)return;const n=yield t.getCurrentUser();return yield t.removeCurrentUser(),t.persistence=e,n?t.setCurrentUser(n):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,n="authUser"){return Ow(function*(){if(!t.length)return new nz(g$(ez),e,n);const r=(yield Promise.all(t.map(function(){var e=Ow(function*(e){if(yield e._isAvailable())return e});return function(t){return e.apply(this,arguments)}}()))).filter(e=>e);let i=r[0]||g$(ez);const s=tz(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=yield n._get(s);if(t){const r=J$._fromJSON(e,t);n!==i&&(o=r),i=n;break}}catch{}const a=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&a.length?(i=a[0],o&&(yield i._set(s,o.toJSON())),yield Promise.all(t.map(function(){var e=Ow(function*(e){if(e!==i)try{yield e._remove(s)}catch{}});return function(t){return e.apply(this,arguments)}}())),new nz(i,e,n)):new nz(i,e,n)})()}}function rz(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(az(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(iz(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(cz(t))return"Blackberry";if(uz(t))return"Webos";if(sz(t))return"Safari";if((t.includes("chrome/")||oz(t))&&!t.includes("edge/"))return"Chrome";if(lz(t))return"Android";{const t=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===(null==t?void 0:t.length))return t[1]}return"Other"}function iz(e=$w()){return/firefox\//i.test(e)}function sz(e=$w()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function oz(e=$w()){return/crios\//i.test(e)}function az(e=$w()){return/iemobile/i.test(e)}function lz(e=$w()){return/android/i.test(e)}function cz(e=$w()){return/blackberry/i.test(e)}function uz(e=$w()){return/webos/i.test(e)}function hz(e=$w()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function dz(e=$w()){return hz(e)||lz(e)||uz(e)||cz(e)||/windows phone/i.test(e)||az(e)}function fz(e,t=[]){let n;switch(e){case"Browser":n=rz($w());break;case"Worker":n=`${rz($w())}-${e}`;break;default:n=e}return`${n}/JsCore/9.9.0/${t.length?t.join(","):"FirebaseCore-web"}`}class pz{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(i){r(i)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}runMiddleware(e){var t=this;return Ow(function*(){var n;if(t.auth.currentUser===e)return;const r=[];try{for(const n of t.queue)yield n(e),n.onAbort&&r.push(n.onAbort)}catch(i){r.reverse();for(const e of r)try{e()}catch{}throw t.auth._errorFactory.create("login-blocked",{originalMessage:null===(n=i)||void 0===n?void 0:n.message})}})()}}class gz{constructor(e,t,n){this.app=e,this.heartbeatServiceProvider=t,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new yz(this),this.idTokenSubscription=new yz(this),this.beforeStateQueue=new pz(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=r$,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=n.sdkClientVersion}_initializeWithPersistence(e,t){var n=this;return t&&(this._popupRedirectResolver=g$(t)),this._initializationPromise=this.queue(Ow(function*(){var r,i;if(!n._deleted&&(n.persistenceManager=yield nz.create(n,e),!n._deleted)){if(null===(r=n._popupRedirectResolver)||void 0===r?void 0:r._shouldInitProactively)try{yield n._popupRedirectResolver._initialize(n)}catch{}yield n.initializeCurrentUser(t),n.lastNotifiedUid=(null===(i=n.currentUser)||void 0===i?void 0:i.uid)||null,!n._deleted&&(n._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var e=this;return Ow(function*(){if(e._deleted)return;const t=yield e.assertedPersistence.getCurrentUser();if(e.currentUser||t){if(e.currentUser&&t&&e.currentUser.uid===t.uid)return e._currentUser._assign(t),void(yield e.currentUser.getIdToken());yield e._updateCurrentUser(t,!0)}})()}initializeCurrentUser(e){var t=this;return Ow(function*(){var n;const r=yield t.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&t.config.authDomain){yield t.getOrInitRedirectPersistenceManager();const r=null===(n=t.redirectUser)||void 0===n?void 0:n._redirectEventId,o=null==i?void 0:i._redirectEventId,a=yield t.tryRedirectSignIn(e);(!r||r===o)&&(null==a?void 0:a.user)&&(i=a.user,s=!0)}if(!i)return t.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield t.beforeStateQueue.runMiddleware(i)}catch(o){i=r,t._popupRedirectResolver._overrideRedirectResult(t,()=>Promise.reject(o))}return i?t.reloadAndSetCurrentUserOrClear(i):t.directlySetCurrentUser(null)}return h$(t._popupRedirectResolver,t,"argument-error"),yield t.getOrInitRedirectPersistenceManager(),t.redirectUser&&t.redirectUser._redirectEventId===i._redirectEventId?t.directlySetCurrentUser(i):t.reloadAndSetCurrentUserOrClear(i)})()}tryRedirectSignIn(e){var t=this;return Ow(function*(){let n=null;try{n=yield t._popupRedirectResolver._completeRedirectFn(t,e,!0)}catch{yield t._setRedirectUser(null)}return n})()}reloadAndSetCurrentUserOrClear(e){var t=this;return Ow(function*(){var n;try{yield Z$(e)}catch(r){if("auth/network-request-failed"!==(null===(n=r)||void 0===n?void 0:n.code))return t.directlySetCurrentUser(null)}return t.directlySetCurrentUser(e)})()}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}_delete(){var e=this;return Ow(function*(){e._deleted=!0})()}updateCurrentUser(e){var t=this;return Ow(function*(){const n=e?oP(e):null;return n&&h$(n.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(n&&n._clone(t))})()}_updateCurrentUser(e,t=!1){var n=this;return Ow(function*(){if(!n._deleted)return e&&h$(n.tenantId===e.tenantId,n,"tenant-id-mismatch"),t||(yield n.beforeStateQueue.runMiddleware(e)),n.queue(Ow(function*(){yield n.directlySetCurrentUser(e),n.notifyAuthListeners()}))})()}signOut(){var e=this;return Ow(function*(){return yield e.beforeStateQueue.runMiddleware(null),(e.redirectPersistenceManager||e._popupRedirectResolver)&&(yield e._setRedirectUser(null)),e._updateCurrentUser(null,!0)})()}setPersistence(e){var t=this;return this.queue(Ow(function*(){yield t.assertedPersistence.setPersistence(g$(e))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Kw("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}_setRedirectUser(e,t){var n=this;return Ow(function*(){const r=yield n.getOrInitRedirectPersistenceManager(t);return null===e?r.removeCurrentUser():r.setCurrentUser(e)})()}getOrInitRedirectPersistenceManager(e){var t=this;return Ow(function*(){if(!t.redirectPersistenceManager){const n=e&&g$(e)||t._popupRedirectResolver;h$(n,t,"argument-error"),t.redirectPersistenceManager=yield nz.create(t,[g$(n._redirectPersistence)],"redirectUser"),t.redirectUser=yield t.redirectPersistenceManager.getCurrentUser()}return t.redirectPersistenceManager})()}_redirectUserForId(e){var t=this;return Ow(function*(){var n,r;return t._isInitialized&&(yield t.queue(Ow(function*(){}))),(null===(n=t._currentUser)||void 0===n?void 0:n._redirectEventId)===e?t._currentUser:(null===(r=t.redirectUser)||void 0===r?void 0:r._redirectEventId)===e?t.redirectUser:null})()}_persistUserIfCurrent(e){var t=this;return Ow(function*(){if(e===t.currentUser)return t.queue(Ow(function*(){return t.directlySetCurrentUser(e)}))})()}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return h$(s,this,"internal-error"),s.then(()=>i(this.currentUser)),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}directlySetCurrentUser(e){var t=this;return Ow(function*(){t.currentUser&&t.currentUser!==e&&(t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh()),t.currentUser=e,e?yield t.assertedPersistence.setCurrentUser(e):yield t.assertedPersistence.removeCurrentUser()})()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return h$(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=fz(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var e=this;return Ow(function*(){var t;const n={"X-Client-Version":e.clientVersion};e.app.options.appId&&(n["X-Firebase-gmpid"]=e.app.options.appId);const r=yield null===(t=e.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();return r&&(n["X-Firebase-Client"]=r),n})()}}function mz(e){return oP(e)}class yz{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new rP(e,void 0);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return h$(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}class vz{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return d$("not implemented")}_getIdTokenResponse(e){return d$("not implemented")}_linkToIdToken(e,t){return d$("not implemented")}_getReauthenticationResolver(e){return d$("not implemented")}}function Cz(){return Cz=Ow(function*(e,t){return S$(e,"POST","/v1/accounts:update",t)}),Cz.apply(this,arguments)}function _z(){return _z=Ow(function*(e,t){return I$(e,"POST","/v1/accounts:signInWithPassword",P$(e,t))}),_z.apply(this,arguments)}function Ez(e,t){return wz.apply(this,arguments)}function wz(){return wz=Ow(function*(e,t){return S$(e,"POST","/v1/accounts:sendOobCode",P$(e,t))}),wz.apply(this,arguments)}function Pz(e,t){return Sz.apply(this,arguments)}function Sz(){return Sz=Ow(function*(e,t){return Ez(e,t)}),Sz.apply(this,arguments)}function bz(e,t){return Oz.apply(this,arguments)}function Oz(){return Oz=Ow(function*(e,t){return Ez(e,t)}),Oz.apply(this,arguments)}function Tz(){return Tz=Ow(function*(e,t){return I$(e,"POST","/v1/accounts:signInWithEmailLink",P$(e,t))}),Tz.apply(this,arguments)}function Iz(){return Iz=Ow(function*(e,t){return I$(e,"POST","/v1/accounts:signInWithEmailLink",P$(e,t))}),Iz.apply(this,arguments)}class kz extends vz{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new kz(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new kz(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){var t=this;return Ow(function*(){switch(t.signInMethod){case"password":return function(e,t){return _z.apply(this,arguments)}(e,{returnSecureToken:!0,email:t._email,password:t._password});case"emailLink":return function(e,t){return Tz.apply(this,arguments)}(e,{email:t._email,oobCode:t._password});default:o$(e,"internal-error")}})()}_linkToIdToken(e,t){var n=this;return Ow(function*(){switch(n.signInMethod){case"password":return function(e,t){return Cz.apply(this,arguments)}(e,{idToken:t,returnSecureToken:!0,email:n._email,password:n._password});case"emailLink":return function(e,t){return Iz.apply(this,arguments)}(e,{idToken:t,email:n._email,oobCode:n._password});default:o$(e,"internal-error")}})()}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}function Az(e,t){return Mz.apply(this,arguments)}function Mz(){return Mz=Ow(function*(e,t){return I$(e,"POST","/v1/accounts:signInWithIdp",P$(e,t))}),Mz.apply(this,arguments)}class Nz extends vz{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Nz(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):o$("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=L(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new Nz(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Az(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Az(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Az(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=eP(t)}return e}}class Rz{constructor(e){var t,n,r,i,s,o;const a=tP(nP(e)),l=null!==(t=a.apiKey)&&void 0!==t?t:null,c=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);h$(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=tP(nP(e)).link,n=t?tP(nP(t)).deep_link_id:null,r=tP(nP(e)).deep_link_id;return(r?tP(nP(r)).link:null)||r||n||t||e}(e);try{return new Rz(t)}catch{return null}}}let xz=(()=>{class e{constructor(){this.providerId=e.PROVIDER_ID}static credential(e,t){return kz._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Rz.parseLink(t);return h$(n,"argument-error"),kz._fromEmailAndCode(e,n.code,n.tenantId)}}return e.PROVIDER_ID="password",e.EMAIL_PASSWORD_SIGN_IN_METHOD="password",e.EMAIL_LINK_SIGN_IN_METHOD="emailLink",e})();class Dz{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Lz extends Dz{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}let Fz=(()=>{class e extends Lz{constructor(){super("google.com"),this.addScope("profile")}static credential(t,n){return Nz._fromParams({providerId:e.PROVIDER_ID,signInMethod:e.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:n})}static credentialFromResult(t){return e.credentialFromTaggedObject(t)}static credentialFromError(t){return e.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return e.credential(n,r)}catch{return null}}}return e.GOOGLE_SIGN_IN_METHOD="google.com",e.PROVIDER_ID="google.com",e})();function Uz(e,t){return Vz.apply(this,arguments)}function Vz(){return Vz=Ow(function*(e,t){return I$(e,"POST","/v1/accounts:signUp",P$(e,t))}),Vz.apply(this,arguments)}class Bz{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,n,r=!1){return Ow(function*(){const i=yield J$._fromIdTokenResponse(e,n,r),s=$z(n);return new Bz({user:i,providerId:s,_tokenResponse:n,operationType:t})})()}static _forOperation(e,t,n){return Ow(function*(){yield e._updateTokensIfNecessary(n,!0);const r=$z(n);return new Bz({user:e,providerId:r,_tokenResponse:n,operationType:t})})()}}function $z(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class zz extends Yw{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,zz.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new zz(e,t,n,r)}}function Hz(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{throw"auth/multi-factor-auth-required"===n.code?zz._fromErrorAndOperation(e,n,t,r):n})}function Gz(e,t){return Zz.apply(this,arguments)}function Zz(){return Zz=Ow(function*(e,t,n=!1){const r=yield B$(e,t._linkToIdToken(e.auth,yield e.getIdToken()),n);return Bz._forOperation(e,"link",r)}),Zz.apply(this,arguments)}function qz(){return qz=Ow(function*(e,t,n=!1){var r;const{auth:i}=e,s="reauthenticate";try{const r=yield B$(e,Hz(i,s,t,e),n);h$(r.idToken,i,"internal-error");const o=V$(r.idToken);h$(o,i,"internal-error");const{sub:a}=o;return h$(e.uid===a,i,"user-mismatch"),Bz._forOperation(e,s,r)}catch(o){throw"auth/user-not-found"===(null===(r=o)||void 0===r?void 0:r.code)&&o$(i,"user-mismatch"),o}}),qz.apply(this,arguments)}function Wz(e,t){return jz.apply(this,arguments)}function jz(){return jz=Ow(function*(e,t,n=!1){const r="signIn",i=yield Hz(e,r,t),s=yield Bz._fromIdTokenResponse(e,r,i);return n||(yield e._updateCurrentUser(s.user)),s}),jz.apply(this,arguments)}function Yz(){return Yz=Ow(function*(e,t){return Wz(mz(e),t)}),Yz.apply(this,arguments)}function Kz(e,t,n){var r;h$((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),h$(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(h$(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(h$(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function Qz(e,t,n){return Xz.apply(this,arguments)}function Xz(){return Xz=Ow(function*(e,t,n){const r=oP(e),i={requestType:"PASSWORD_RESET",email:t};n&&Kz(r,i,n),yield bz(r,i)}),Xz.apply(this,arguments)}function Jz(e,t,n){return eH.apply(this,arguments)}function eH(){return eH=Ow(function*(e,t,n){const r=mz(e),i=yield Uz(r,{returnSecureToken:!0,email:t,password:n}),s=yield Bz._fromIdTokenResponse(r,"signIn",i);return yield r._updateCurrentUser(s.user),s}),eH.apply(this,arguments)}function tH(e,t,n){return function(e,t){return Yz.apply(this,arguments)}(oP(e),xz.credential(t,n))}function nH(e,t){return rH.apply(this,arguments)}function rH(){return rH=Ow(function*(e,t){const n=oP(e),r={requestType:"VERIFY_EMAIL",idToken:yield e.getIdToken()};t&&Kz(n.auth,r,t);const{email:i}=yield Pz(n.auth,r);i!==e.email&&(yield e.reload())}),rH.apply(this,arguments)}function iH(e,t){return sH.apply(this,arguments)}function sH(){return sH=Ow(function*(e,t){return S$(e,"POST","/v1/accounts:update",t)}),sH.apply(this,arguments)}function oH(e,t){return aH.apply(this,arguments)}function aH(){return aH=Ow(function*(e,{displayName:t,photoURL:n}){if(void 0===t&&void 0===n)return;const r=oP(e),i={idToken:yield r.getIdToken(),displayName:t,photoUrl:n,returnSecureToken:!0},s=yield B$(r,iH(r.auth,i));r.displayName=s.displayName||null,r.photoURL=s.photoUrl||null;const o=r.providerData.find(({providerId:e})=>"password"===e);o&&(o.displayName=r.displayName,o.photoURL=r.photoURL),yield r._updateTokensIfNecessary(s)}),aH.apply(this,arguments)}function lH(e,t,n,r){return oP(e).onAuthStateChanged(t,n,r)}new WeakMap;const cH="__sak";class uH{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(cH,"1"),this.storage.removeItem(cH),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const hH=(()=>{class e extends uH{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=$w();return sz(e)||hz(e)}()&&function(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=dz(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);!t&&this.localCache[n]===e||this.notifyListeners(n,e)},i=this.storage.getItem(n);Zw()&&10===document.documentMode&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(e,t){var n=()=>super._set,r=this;return Ow(function*(){yield n().call(r,e,t),r.localCache[e]=JSON.stringify(t)})()}_get(e){var t=()=>super._get,n=this;return Ow(function*(){const r=yield t().call(n,e);return n.localCache[e]=JSON.stringify(r),r})()}_remove(e){var t=()=>super._remove,n=this;return Ow(function*(){yield t().call(n,e),delete n.localCache[e]})()}}return e.type="LOCAL",e})(),dH=(()=>{class e extends uH{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}return e.type="SESSION",e})();let fH=(()=>{class e{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const n=this.receivers.find(e=>e.isListeningto(t));if(n)return n;const r=new e(t);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}handleEvent(e){var t=this;return Ow(function*(){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=t.handlersMap[i];if(!(null==o?void 0:o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(function(){var e=Ow(function*(e){return e(n.origin,s)});return function(t){return e.apply(this,arguments)}}()),l=yield function(e){return Promise.all(e.map(function(){var e=Ow(function*(e){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}});return function(t){return e.apply(this,arguments)}}()))}(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})})()}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return e.receivers=[],e})();function pH(e="",t=10){let n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}class gH{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,n=50){var r=this;return Ow(function*(){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const c=pH("",20);i.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);o={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(t.data.response);break;default:clearTimeout(u),clearTimeout(s),l(new Error("invalid_response"))}}},r.handlers.add(o),i.port1.addEventListener("message",o.onMessage),r.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])}).finally(()=>{o&&r.removeMessageHandler(o)})})()}}function mH(){return window}function yH(){return void 0!==mH().WorkerGlobalScope&&"function"==typeof mH().importScripts}function vH(){return(vH=Ow(function*(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const CH="firebaseLocalStorageDb",_H="firebaseLocalStorage",EH="fbase_key";class wH{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function PH(e,t){return e.transaction([_H],t?"readwrite":"readonly").objectStore(_H)}function SH(){const e=indexedDB.open(CH,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(_H,{keyPath:EH})}catch(r){n(r)}}),e.addEventListener("success",Ow(function*(){const n=e.result;n.objectStoreNames.contains(_H)?t(n):(n.close(),yield function(){const e=indexedDB.deleteDatabase(CH);return new wH(e).toPromise()}(),t(yield SH()))}))})}function bH(e,t,n){return OH.apply(this,arguments)}function OH(){return OH=Ow(function*(e,t,n){const r=PH(e,!0).put({[EH]:t,value:n});return new wH(r).toPromise()}),OH.apply(this,arguments)}function TH(){return TH=Ow(function*(e,t){const n=PH(e,!1).get(t),r=yield new wH(n).toPromise();return void 0===r?null:r.value}),TH.apply(this,arguments)}function IH(e,t){const n=PH(e,!0).delete(t);return new wH(n).toPromise()}const kH=(()=>{class e{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var e=this;return Ow(function*(){return e.db||(e.db=yield SH()),e.db})()}_withRetries(e){var t=this;return Ow(function*(){let n=0;for(;;)try{const n=yield t._openDb();return yield e(n)}catch(r){if(n++>3)throw r;t.db&&(t.db.close(),t.db=void 0)}})()}initializeServiceWorkerMessaging(){var e=this;return Ow(function*(){return yH()?e.initializeReceiver():e.initializeSender()})()}initializeReceiver(){var e=this;return Ow(function*(){e.receiver=fH._getInstance(yH()?self:null),e.receiver._subscribe("keyChanged",function(){var t=Ow(function*(t,n){return{keyProcessed:(yield e._poll()).includes(n.key)}});return function(e,n){return t.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var e=Ow(function*(e,t){return["keyChanged"]});return function(t,n){return e.apply(this,arguments)}}())})()}initializeSender(){var e=this;return Ow(function*(){var t,n;if(e.activeServiceWorker=yield function(){return vH.apply(this,arguments)}(),!e.activeServiceWorker)return;e.sender=new gH(e.activeServiceWorker);const r=yield e.sender._send("ping",{},800);!r||(null===(t=r[0])||void 0===t?void 0:t.fulfilled)&&(null===(n=r[0])||void 0===n?void 0:n.value.includes("keyChanged"))&&(e.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(e){var t=this;return Ow(function*(){if(t.sender&&t.activeServiceWorker&&function(){var e;return(null===(e=null==navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===t.activeServiceWorker)try{yield t.sender._send("keyChanged",{key:e},t.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return Ow(function*(){try{if(!indexedDB)return!1;const e=yield SH();return yield bH(e,cH,"1"),yield IH(e,cH),!0}catch{}return!1})()}_withPendingWrite(e){var t=this;return Ow(function*(){t.pendingWrites++;try{yield e()}finally{t.pendingWrites--}})()}_set(e,t){var n=this;return Ow(function*(){return n._withPendingWrite(Ow(function*(){return yield n._withRetries(n=>bH(n,e,t)),n.localCache[e]=t,n.notifyServiceWorker(e)}))})()}_get(e){var t=this;return Ow(function*(){const n=yield t._withRetries(t=>function(e,t){return TH.apply(this,arguments)}(t,e));return t.localCache[e]=n,n})()}_remove(e){var t=this;return Ow(function*(){return t._withPendingWrite(Ow(function*(){return yield t._withRetries(t=>IH(t,e)),delete t.localCache[e],t.notifyServiceWorker(e)}))})()}_poll(){var e=this;return Ow(function*(){const t=yield e._withRetries(e=>{const t=PH(e,!1).getAll();return new wH(t).toPromise()});if(!t)return[];if(0!==e.pendingWrites)return[];const n=[],r=new Set;for(const{fbase_key:i,value:s}of t)r.add(i),JSON.stringify(e.localCache[i])!==JSON.stringify(s)&&(e.notifyListeners(i,s),n.push(i));for(const i of Object.keys(e.localCache))e.localCache[i]&&!r.has(i)&&(e.notifyListeners(i,null),n.push(i));return n})()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){var e=this;this.stopPolling(),this.pollTimer=setInterval(Ow(function*(){return e._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return e.type="LOCAL",e})();function AH(e){return`__${e}${Math.floor(1e6*Math.random())}`}function MH(e,t){return t?g$(t):(h$(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}AH("rcb"),new v$(3e4,6e4);class NH extends vz{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Az(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Az(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Az(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function RH(e){return Wz(e.auth,new NH(e),e.bypassAuthState)}function xH(e){const{auth:t,user:n}=e;return h$(n,t,"internal-error"),function(e,t){return qz.apply(this,arguments)}(n,new NH(e),e.bypassAuthState)}function DH(e){return LH.apply(this,arguments)}function LH(){return LH=Ow(function*(e){const{auth:t,user:n}=e;return h$(n,t,"internal-error"),Gz(n,new NH(e),e.bypassAuthState)}),LH.apply(this,arguments)}class FH{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){var e=this;return new Promise(function(){var t=Ow(function*(t,n){e.pendingPromise={resolve:t,reject:n};try{e.eventManager=yield e.resolver._initialize(e.auth),yield e.onExecution(),e.eventManager.registerConsumer(e)}catch(r){e.reject(r)}});return function(e,n){return t.apply(this,arguments)}}())}onAuthEvent(e){var t=this;return Ow(function*(){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o)return void t.reject(o);const l={auth:t.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:t.user,bypassAuthState:t.bypassAuthState};try{t.resolve(yield t.getIdpTask(a)(l))}catch(c){t.reject(c)}})()}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return RH;case"linkViaPopup":case"linkViaRedirect":return DH;case"reauthViaPopup":case"reauthViaRedirect":return xH;default:o$(this.auth,"internal-error")}}resolve(e){f$(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){f$(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const UH=new v$(2e3,1e4);function VH(e,t,n){return BH.apply(this,arguments)}function BH(){return BH=Ow(function*(e,t,n){const r=mz(e);c$(e,t,Dz);const i=MH(r,n);return new $H(r,"signInViaPopup",t,i).executeNotNull()}),BH.apply(this,arguments)}let $H=(()=>{class e extends FH{constructor(t,n,r,i,s){super(t,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,e.currentPopupAction&&e.currentPopupAction.cancel(),e.currentPopupAction=this}executeNotNull(){var e=this;return Ow(function*(){const t=yield e.execute();return h$(t,e.auth,"internal-error"),t})()}onExecution(){var e=this;return Ow(function*(){f$(1===e.filter.length,"Popup operations only handle one event");const t=pH();e.authWindow=yield e.resolver._openPopup(e.auth,e.provider,e.filter[0],t),e.authWindow.associatedEvent=t,e.resolver._originValidation(e.auth).catch(t=>{e.reject(t)}),e.resolver._isIframeWebStorageSupported(e.auth,t=>{t||e.reject(a$(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation()})()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(a$(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,e.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;this.pollId=(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?window.setTimeout(()=>{this.pollId=null,this.reject(a$(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(e,UH.get())};e()}}return e.currentPopupAction=null,e})();const zH=new Map;class HH extends FH{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}execute(){var e=()=>super.execute,t=this;return Ow(function*(){let n=zH.get(t.auth._key());if(!n){try{const r=(yield function(e,t){return GH.apply(this,arguments)}(t.resolver,t.auth))?yield e().call(t):null;n=()=>Promise.resolve(r)}catch(r){n=()=>Promise.reject(r)}zH.set(t.auth._key(),n)}return t.bypassAuthState||zH.set(t.auth._key(),()=>Promise.resolve(null)),n()})()}onAuthEvent(e){var t=()=>super.onAuthEvent,n=this;return Ow(function*(){if("signInViaRedirect"===e.type)return t().call(n,e);if("unknown"!==e.type){if(e.eventId){const r=yield n.auth._redirectUserForId(e.eventId);if(r)return n.user=r,t().call(n,e);n.resolve(null)}}else n.resolve(null)})()}onExecution(){return Ow(function*(){})()}cleanUp(){}}function GH(){return GH=Ow(function*(e,t){const n=WH(t),r=qH(e);if(!(yield r._isAvailable()))return!1;const i="true"===(yield r._get(n));return yield r._remove(n),i}),GH.apply(this,arguments)}function ZH(e,t){zH.set(e._key(),t)}function qH(e){return g$(e._redirectPersistence)}function WH(e){return tz("pendingRedirect",e.config.apiKey,e.name)}function jH(e,t){return YH.apply(this,arguments)}function YH(){return YH=Ow(function*(e,t,n=!1){const r=mz(e),i=MH(r,t),s=yield new HH(r,i,n).execute();return s&&!n&&(delete s.user._redirectEventId,yield r._persistUserIfCurrent(s.user),yield r._setRedirectUser(null,t)),s}),YH.apply(this,arguments)}class KH{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return XH(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!XH(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(a$(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(QH(e))}saveEventToCache(e){this.cachedEventUids.add(QH(e)),this.lastProcessedEventTime=Date.now()}}function QH(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function XH({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}function JH(e){return eG.apply(this,arguments)}function eG(){return eG=Ow(function*(e,t={}){return S$(e,"GET","/v1/projects",t)}),eG.apply(this,arguments)}const tG=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,nG=/^https?/;function rG(){return rG=Ow(function*(e){if(e.config.emulator)return;const{authorizedDomains:t}=yield JH(e);for(const n of t)try{if(iG(n))return}catch{}o$(e,"unauthorized-domain")}),rG.apply(this,arguments)}function iG(e){const t=m$(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!nG.test(n))return!1;if(tG.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const sG=new v$(3e4,6e4);function oG(){const e=mH().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}let aG=null;function lG(e){return aG=aG||function(e){return new Promise((t,n)=>{var r,i,s;function o(){oG(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{oG(),n(a$(e,"network-request-failed"))},timeout:sG.get()})}if(null===(i=null===(r=mH().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=mH().gapi)||void 0===s?void 0:s.load)){const t=AH("iframefcb");return mH()[t]=()=>{gapi.load?o():n(a$(e,"network-request-failed"))},function(e){return new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=a$("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})}(`https://apis.google.com/js/api.js?onload=${t}`).catch(e=>n(e))}o()}}).catch(e=>{throw aG=null,e})}(e),aG}const cG=new v$(5e3,15e3),uG={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},hG=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function dG(e){const t=e.config;h$(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?C$(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:jP},i=hG.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${eP(r).slice(1)}`}function fG(){return fG=Ow(function*(e){const t=yield lG(e),n=mH().gapi;return h$(n,e,"internal-error"),t.open({where:document.body,url:dG(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:uG,dontclear:!0},t=>new Promise(function(){var n=Ow(function*(n,r){yield t.restyle({setHideOnLeave:!1});const i=a$(e,"network-request-failed"),s=mH().setTimeout(()=>{r(i)},cG.get());function o(){mH().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{r(i)})});return function(e,t){return n.apply(this,arguments)}}()))}),fG.apply(this,arguments)}const pG={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class gG{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function mG(e,t,n,r,i,s){h$(e.config.authDomain,e,"auth-domain-config-required"),h$(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:jP,eventId:i};if(t instanceof Dz){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof Lz){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const l of Object.keys(a))void 0===a[l]&&delete a[l];return`${function({config:e}){return e.emulator?C$(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${eP(a).slice(1)}`}const yG="webStorageSupport",vG=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=dH,this._completeRedirectFn=jH,this._overrideRedirectResult=ZH}_openPopup(e,t,n,r){var i=this;return Ow(function*(){var s;f$(null===(s=i.eventManagers[e._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()");const o=mG(e,t,n,m$(),r);return function(e,t,n,r=500,i=600){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},pG),{width:r.toString(),height:i.toString(),top:s,left:o}),c=$w().toLowerCase();n&&(a=oz(c)?"_blank":n),iz(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(function(e=$w()){var t;return hz(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(c)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new gG(null);const h=window.open(t||"",a,u);h$(h,e,"popup-blocked");try{h.focus()}catch{}return new gG(h)}(e,o,pH())})()}_openRedirect(e,t,n,r){var i=this;return Ow(function*(){return yield i._originValidation(e),function(e){mH().location.href=e}(mG(e,t,n,m$(),r)),new Promise(()=>{})})()}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(f$(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}initAndGetManager(e){var t=this;return Ow(function*(){const n=yield function(e){return fG.apply(this,arguments)}(e),r=new KH(e);return n.register("authEvent",t=>(h$(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:r.onEvent(t.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:r},t.iframes[e._key()]=n,r})()}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(yG,{type:yG},n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[yG];void 0!==i&&t(!!i),o$(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return rG.apply(this,arguments)}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return dz()||sz()||hz()}};var CG="@firebase/auth";class _G{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}getToken(e){var t=this;return Ow(function*(){return t.assertAuthConfigured(),yield t.auth._initializationPromise,t.auth.currentUser?{accessToken:yield t.auth.currentUser.getIdToken(e)}:null})()}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);!t||(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){h$(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function EG(e=KP()){const t=ZP(e,"auth");return t.isInitialized()?t.getImmediate():function(e,t){const n=ZP(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(Xw(n.getOptions(),t??{}))return e;o$(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:vG,persistence:[kH,hH,dH]})}!function(e){GP(new aP("auth",(t,{options:n})=>{const r=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),{apiKey:s,authDomain:o}=r.options;return((t,r)=>{h$(s&&!s.includes(":"),"invalid-api-key",{appName:t.name}),h$(!(null==o?void 0:o.includes(":")),"argument-error",{appName:t.name});const i={apiKey:s,authDomain:o,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:fz(e)},a=new gz(t,r,i);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(g$);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(a,n),a})(r,i)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),GP(new aP("auth-internal",e=>{const t=mz(e.getProvider("auth").getImmediate());return new _G(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),XP(CG,"0.20.5",void 0),XP(CG,"0.20.5","esm2017")}("Browser");class wG{constructor(e){return e}}class PG{constructor(){return iB("auth")}}const SG=new or("angularfire2.auth-instances");function bG(e){return(t,n)=>{const r=t.runOutsideAngular(()=>e(n));return new wG(r)}}const OG={provide:PG,deps:[[new Nr,SG]]},TG={provide:wG,useFactory:function(e,t){const n=rB("auth",e,t);return n&&new wG(n)},deps:[[new Nr,SG],gB]};let IG=(()=>{class e{constructor(){XP("angularfire",KV.full,"auth")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({providers:[TG,OG]}),e})();const kG=pB(Jz,!0),AG=pB(EG,!0),MG=pB(lH,!0),NG=pB(nH,!0),RG=pB(Qz,!0),xG=pB(tH,!0),DG=pB(VH,!0),LG=pB(oH,!0);class FG{constructor(e){return e}}const UG=new or("angularfire2.firestore-instances");function VG(e){return(t,n)=>{const r=t.runOutsideAngular(()=>e(n));return new FG(r)}}const BG={provide:class{constructor(){return iB("firestore")}},deps:[[new Nr,UG]]},$G={provide:FG,useFactory:function(e,t){const n=rB("firestore",e,t);return n&&new FG(n)},deps:[[new Nr,UG],gB]};let zG=(()=>{class e{constructor(){XP("angularfire",KV.full,"fst")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({providers:[$G,BG]}),e})();const HG=pB(pL,!0),GG=pB(uD,!0),ZG=pB(fL,!0),qG=pB(hD,!0),WG=pB(lL,!0),jG=pB(uL,!0),YG=pB(gD,!0),KG=pB(rL,!0),QG=pB(gL,!0),XG=pB(tL,!0),JG=pB(QD,!0),eZ=pB(hL,!0),tZ=pB(dL,!0),nZ=pB(JD,!0);let rZ=(()=>{class e{constructor(e,t){this.collectionName=e,this.firestore=t,this.subDAOs={};this.collection=GG(t,this.collectionName).withConverter({fromFirestore:e=>e.data(),toFirestore:e=>e})}create(t){var n=this;return Ow(function*(){return Iw(e.VERBOSE,{called:n.collectionName+".create",newElement:t}),(yield HG(n.collection,t)).id})()}read(t){var n=this;return Ow(function*(){Iw(e.VERBOSE,{called:n.collectionName+".read",id:t});const r=yield WG(qG(n.collection,t));return r.exists()?Nw.of(Tw.getNonNullable(r.data())):Nw.empty()})()}exists(t){var n=this;return Ow(function*(){return Iw(e.VERBOSE,{called:n.collectionName+".exists",id:t}),(yield n.read(t)).isPresent()})()}update(t,n){var r=this;return Ow(function*(){return Iw(e.VERBOSE,{called:r.collectionName+".update",id:t,update:n}),tZ(qG(r.collection,t),n)})()}delete(t){return Iw(e.VERBOSE,{called:this.collectionName+".delete",id:t}),ZG(qG(this.collection,t))}set(t,n){return Iw(e.VERBOSE,{called:this.collectionName+".set",id:t,element:n}),eZ(qG(this.collection,t),n)}subscribeToChanges(e,t){return new a(QG(qG(this.collection,e),e=>{t(Nw.ofNullable(e.data()))}))}findWhere(e,t,n){var r=this;return Ow(function*(){const i=r.constructQuery(e,t,n);return(yield jG(i)).docs.map(e=>({id:e.id,data:e.data()}))})()}observingWhere(t,n,r){Iw(e.VERBOSE,{called:this.collectionName+".observingWhere"});const i=this.constructQuery(t,r);return new a(QG(i,t=>{const r=[],i=[],s=[];t.docChanges().forEach(e=>{const t={id:e.doc.id,data:e.doc.data()};switch(e.type){case"added":r.push(t);break;case"modified":i.push(t);break;case"removed":s.push(t)}}),r.length>0&&(Iw(e.VERBOSE,"firebase gave us "+r.length+" NEW "+this.collectionName),n.onDocumentCreated(r)),i.length>0&&(Iw(e.VERBOSE,"firebase gave us "+i.length+" MODIFIED "+this.collectionName),n.onDocumentModified(i)),s.length>0&&(Iw(e.VERBOSE,"firebase gave us "+s.length+" DELETED "+this.collectionName),n.onDocumentDeleted(s))}))}constructQuery(e,t,n){let r=JG(this.collection);null!=t&&(r=JG(r,XG(t))),null!=n&&(r=JG(r,KG(n)));for(const i of e)r=JG(r,nZ(i[0],i[1],i[2]));return r}subCollectionDAO(t,n){const r=`${this.collection.path}/${t}/${n}`;if(r in this.subDAOs)return this.subDAOs[r];{const t=new class extends e{constructor(e){super(r,e)}}(this.firestore);return this.subDAOs[r]=t,t}}}return e.VERBOSE=!1,e})(),iZ=(()=>{class e extends rZ{constructor(t){super("chats",t),Iw(e.VERBOSE,"ChatDAO.constructor")}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Or(FG))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),sZ=(()=>{class e{}return e.CANNOT_SEND_MESSAGE=()=>$localize`You're not allowed to send a message here.`,e.FORBIDDEN_MESSAGE=()=>$localize`This message is forbidden.`,e})(),oZ=(()=>{class e{constructor(t){this.chatDAO=t,Iw(e.VERBOSE,"ChatService.constructor")}addMessage(e,t){var n=this;return Ow(function*(){return n.chatDAO.subCollectionDAO(e,"messages").create(t)})()}getLastMessages(e,t){var n=this;return Ow(function*(){return n.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",t)})()}subscribeToMessages(e,t){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],t,"postedTime")}deleteChat(t){var n=this;return Ow(function*(){return Iw(e.VERBOSE,"ChatService.deleteChat "+t),n.chatDAO.delete(t)})()}createNewChat(e){var t=this;return Ow(function*(){return t.chatDAO.set(e,{})})()}sendMessage(e,t,n,r){var i=this;return Ow(function*(){if(!1===i.userCanSendMessage(t.name,e))return Lw.failure(sZ.CANNOT_SEND_MESSAGE());if(i.isForbiddenMessage(n))return Lw.failure(sZ.FORBIDDEN_MESSAGE());const s={content:n,sender:t,postedTime:vL(),currentTurn:r};return yield i.addMessage(e,s),Lw.SUCCESS})()}userCanSendMessage(e,t){return""!==e}isForbiddenMessage(e){return""===e}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Or(iZ))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),aZ=(()=>{class e extends rZ{constructor(e){super("errors",e)}}return e.\u0275fac=function(t){return new(t||e)(Or(FG))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var lZ=n(5378);let cZ=(()=>{class e{infoMessage(e){this.message(e,"is-info")}gameMessage(e){this.message(e,"is-warning")}criticalMessage(e){this.message(e,"is-danger")}message(e,t){(0,lZ.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:t,dismissible:!0})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class uZ{constructor(e,t,n){this.errorDAO=e,this.router=t,this.messageDisplayer=n,uZ.setSingletonInstance(this)}static setSingletonInstance(e){uZ.singleton=Nw.of(e)}static logErrorAndFail(e,t,n){throw uZ.logError(e,t,n),new Error(`${e}: ${t} (extra data: ${JSON.stringify(n)})`)}static logError(e,t,n){if(this.singleton.isAbsent())throw new Error(`${e}: ${t} (extra data: ${JSON.stringify(n)})`);return this.singleton.get().logError(e,t,n),Lw.failure(e+": "+t)}findErrors(e,t,n,r){return this.errorDAO.findWhere(void 0===r?[["component","==",e],["route","==",t],["message","==",n]]:[["component","==",e],["route","==",t],["message","==",n],["data","==",r]])}logError(e,t,n){var r=this;return Ow(function*(){r.messageDisplayer.criticalMessage($localize`An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible.`);const i=r.router.url,s=yield r.findErrors(e,i,t,n);if(0===s.length){const s={component:e,route:i,message:t,firstEncounter:vL(),lastEncounter:vL(),occurences:1};null!=n&&(s.data=n),yield r.errorDAO.create(s)}else{const e=s[0].id,t=s[0].data;yield r.errorDAO.update(e,{lastEncounter:vL(),occurences:t.occurences+1})}})()}}function hZ(e,t){if(!1===e)throw uZ.logError("Assertion failure",t),new Error(`Assertion failure: ${t}`)}uZ.singleton=Nw.empty(),uZ.\u0275fac=function(e){return new(e||uZ)(Or(aZ),Or(gC),Or(cZ))},uZ.\u0275prov=Pe({token:uZ,factory:uZ.\u0275fac,providedIn:"root"});let dZ=(()=>{class e extends rZ{constructor(t){super(e.COLLECTION_NAME,t),Iw(e.VERBOSE,"UserDAO.constructor")}}return e.VERBOSE=!1,e.COLLECTION_NAME="users",e.\u0275fac=function(t){return new(t||e)(Or(FG))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),fZ=(()=>{class e{constructor(e){this.userDAO=e}usernameIsAvailable(e){var t=this;return Ow(function*(){return 0===(yield t.userDAO.findWhere([["username","==",e]])).length})()}setUsername(e,t){var n=this;return Ow(function*(){yield n.userDAO.update(e,{username:t})})()}markAsVerified(e){var t=this;return Ow(function*(){yield t.userDAO.update(e,{verified:!0})})()}observeUser(e,t){return this.userDAO.subscribeToChanges(e,t)}getUserLastUpdateTime(e){var t=this;return Ow(function*(){const n=yield t.userDAO.read(e);if(n.isAbsent())return Nw.empty();{const e=n.get().lastUpdateTime;return hZ(null!=e,"should not receive a lastUpdateTime equal to null"),Nw.of(e)}})()}updatePresenceToken(e){return this.userDAO.update(e,{lastUpdateTime:vL()})}}return e.\u0275fac=function(t){return new(t||e)(Or(dZ))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class pZ extends A{constructor(e=1/0,t=1/0,n=ZV){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:n,_infiniteTimeWindow:r,_timestampProvider:i,_windowTime:s}=this;t||(n.push(e),!r&&n.push(i.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:r}=this,i=r.slice();for(let s=0;s<i.length&&!e.closed;s+=n?1:2)e.next(i[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:r}=this,i=(r?1:2)*e;if(e<1/0&&i<n.length&&n.splice(0,n.length-i),!r){const e=t.now();let r=0;for(let t=1;t<n.length&&n[t]<=e;t+=2)r=t;r&&n.splice(0,r+1)}}}class gZ{static createUserWithEmailAndPassword(e,t,n){return kG(e,t,n)}static sendEmailVerification(e){return NG(e)}static sendPasswordResetEmail(e,t){return RG(e,t)}static signInWithEmailAndPassword(e,t,n){return Ow(function*(){return(yield xG(e,t,n)).user})()}static signInWithPopup(e,t){return Ow(function*(){return(yield DG(e,t)).user})()}static updateProfile(e,t){return LG(e,t)}}class mZ{constructor(e,t,n,r){this.id=e,this.email=t,this.username=n,this.verified=r}isConnected(){return this.email.isPresent()}toMinimalUser(){return{id:this.id,name:this.username.get()}}}mZ.NOT_CONNECTED=new mZ("",Nw.empty(),Nw.empty(),!1);let yZ=(()=>{class e{constructor(t,n,r){var i=this;this.userDAO=t,this.userService=n,this.auth=r,this.user=Nw.empty(),this.userSubscription=new a,Iw(e.VERBOSE,"ConnectedUserService constructor"),this.userRS=new pZ(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new a(MG(this.auth,function(){var t=Ow(function*(t){null==t?(Iw(e.VERBOSE,"User is not connected"),i.userSubscription.unsubscribe(),i.userRS.next(mZ.NOT_CONNECTED),i.user=Nw.empty()):(hZ(i.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),i.userSubscription=i.userDAO.subscribeToChanges(t.uid,n=>{if(n.isPresent()){const r=n.get().username;Iw(e.VERBOSE,`User ${r} is connected, and the verified status is ${i.emailVerified(t)}`);const s=!0===i.emailVerified(t)&&null!=r;if(!0===s&&!1===n.get().verified)return i.userService.markAsVerified(t.uid);const o=new mZ(t.uid,Nw.ofNullable(t.email),Nw.ofNullable(r),s);i.user=Nw.of(o),i.userRS.next(o)}}))});return function(e){return t.apply(this,arguments)}}()))}emailVerified(e){return e.emailVerified}sendPasswordResetEmail(e){var t=this;return Ow(function*(){try{return yield gZ.sendPasswordResetEmail(t.auth,e),Lw.SUCCESS}catch(n){return Lw.failure(t.mapFirebaseError(n))}})()}doRegister(t,n,r){var i=this;return Ow(function*(){return Iw(e.VERBOSE,"ConnectedUserService.doRegister("+n+")"),(yield i.userService.usernameIsAvailable(t))?i.registerAfterUsernameCheck(t,n,r):Rw.failure($localize`This username is already in use.`)})()}registerAfterUsernameCheck(e,t,n){var r=this;return Ow(function*(){try{const i=yield gZ.createUserWithEmailAndPassword(r.auth,t,n);yield gZ.signInWithEmailAndPassword(r.auth,t,n);const s=Tw.getNonNullable(i.user);return yield r.createUser(s.uid,e),Rw.success(s)}catch(i){return Rw.failure(r.mapFirebaseError(i))}})()}mapFirebaseError(e){switch(e.code){case"auth/email-already-in-use":return $localize`This email address is already in use.`;case"auth/invalid-email":return $localize`This email address is invalid.`;case"auth/user-not-found":case"auth/wrong-password":return $localize`You have entered invalid credentials.`;case"auth/invalid-credential":return $localize`The credential is invalid or has expired, please try again.`;case"auth/weak-password":return $localize`Your password is too weak, please use a stronger password.`;case"auth/too-many-requests":return $localize`There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later.`;case"auth/popup-closed-by-user":return $localize`You closed the authentication popup without finalizing your log in.`;case"auth/popup-blocked":return $localize`The authentication popup was blocked. Try again after disabling popup blocking.`;default:return uZ.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}sendEmailVerification(){var t=this;return Ow(function*(){Iw(e.VERBOSE,"ConnectedUserService.sendEmailVerification()");const n=Nw.ofNullable(t.auth.currentUser);if(!n.isPresent())return uZ.logError("ConnectedUserService","Unlogged users cannot request for email verification");if(t.emailVerified(n.get()))return uZ.logError("ConnectedUserService","Verified users should not ask email verification after being verified");try{return yield gZ.sendEmailVerification(n.get()),Lw.SUCCESS}catch(r){return Lw.failure(t.mapFirebaseError(r))}})()}doEmailLogin(t,n){var r=this;return Ow(function*(){Iw(e.VERBOSE,"ConnectedUserService.doEmailLogin("+t+")");try{return yield gZ.signInWithEmailAndPassword(r.auth,t,n),Lw.SUCCESS}catch(i){return Lw.failure(r.mapFirebaseError(i))}})()}createUser(e,t){var n=this;return Ow(function*(){null==t?yield n.userDAO.set(e,{verified:!1}):yield n.userDAO.set(e,{username:t,verified:!1})})()}doGoogleLogin(){var e=this;return Ow(function*(){return Lw.ofFallible(yield e.registerOrLoginWithGoogle())})()}registerOrLoginWithGoogle(){var e=this;return Ow(function*(){try{const t=new Fz;t.addScope("profile"),t.addScope("email");const n=yield gZ.signInWithPopup(e.auth,t);return!1===(yield e.userDAO.exists(n.uid))&&(yield e.createUser(n.uid)),Rw.success(n)}catch(t){return Rw.failure(e.mapFirebaseError(t))}})()}disconnect(){var e=this;return Ow(function*(){return Nw.ofNullable(e.auth.currentUser).isPresent()?(yield e.auth.signOut(),Lw.SUCCESS):Lw.failure("Cannot disconnect a non-connected user")})()}subscribeToUser(e){return this.userObs.subscribe(e)}setUsername(e){var t=this;return Ow(function*(){if(""===e)return Lw.failure($localize`Your username may not be empty.`);try{if(!1===(yield t.userService.usernameIsAvailable(e)))return Lw.failure($localize`This username is already in use, please select a different one.`);const n=Tw.getNonNullable(t.auth.currentUser);return yield gZ.updateProfile(n,{displayName:e}),yield t.userService.setUsername(n.uid,e),yield t.userService.markAsVerified(n.uid),yield t.reloadUser(),Lw.SUCCESS}catch(n){return Lw.failure(t.mapFirebaseError(n))}})()}setPicture(e){var t=this;return Ow(function*(){try{const n=Tw.getNonNullable(t.auth.currentUser);return yield gZ.updateProfile(n,{photoURL:e}),Lw.SUCCESS}catch(n){return Lw.failure(t.mapFirebaseError(n))}})()}reloadUser(){var e=this;return Ow(function*(){const t=Tw.getNonNullable(e.auth.currentUser);yield t.getIdToken(!0),yield t.reload()})()}updateObservedPart(e){return hZ(this.user.isPresent(),"Should not call updateObservedPart when not connected"),this.userDAO.update(this.user.get().id,{observedPart:e})}removeObservedPart(){return hZ(this.user.isPresent(),"Should not call removeObservedPart when not connected"),this.userDAO.update(this.user.get().id,{observedPart:null})}sendPresenceToken(){return hZ(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Or(dZ),Or(fZ),Or(wG))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class vZ{constructor(e){this.value=e}}vZ.HARD_DRAW=new vZ(0),vZ.RESIGN=new vZ(1),vZ.ESCAPE=new vZ(2),vZ.VICTORY=new vZ(3),vZ.TIMEOUT=new vZ(4),vZ.UNACHIEVED=new vZ(5),vZ.AGREED_DRAW_BY_ZERO=new vZ(6),vZ.AGREED_DRAW_BY_ONE=new vZ(7);class CZ{constructor(e,t){this.id=e,this.data=t}getTurn(){return this.data.turn}isHardDraw(){return this.data.result===vZ.HARD_DRAW.value}isAgreedDraw(){return this.data.result===vZ.AGREED_DRAW_BY_ZERO.value||this.data.result===vZ.AGREED_DRAW_BY_ONE.value}getDrawAccepter(){return this.data.result===vZ.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(hZ(this.data.result===vZ.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),Tw.getNonNullable(this.data.playerOne))}isWin(){return this.data.result===vZ.VICTORY.value}isTimeout(){return this.data.result===vZ.TIMEOUT.value}isResign(){return this.data.result===vZ.RESIGN.value}getWinner(){return Nw.ofNullable(this.data.winner)}getLoser(){return Nw.ofNullable(this.data.loser)}setWinnerAndLoser(e,t){return new CZ(this.id,{...this.data,winner:e,loser:t})}}class _Z{constructor(e){this.value=e}static of(e){switch(e){case"CREATOR":return _Z.CREATOR;case"RANDOM":return _Z.RANDOM;default:return hZ("CHOSEN_PLAYER"===e,"Invalid value for FirstPlayer: "+e+"."),_Z.CHOSEN_PLAYER}}}_Z.CREATOR=new _Z("CREATOR"),_Z.RANDOM=new _Z("RANDOM"),_Z.CHOSEN_PLAYER=new _Z("CHOSEN_PLAYER");class EZ{constructor(e){this.value=e}static of(e){switch(e){case"STANDARD":return EZ.STANDARD;case"BLITZ":return EZ.BLITZ;case"CUSTOM":return EZ.CUSTOM;default:throw new Error("Invalid part type: "+e+".")}}}EZ.STANDARD=new EZ("STANDARD"),EZ.BLITZ=new EZ("BLITZ"),EZ.CUSTOM=new EZ("CUSTOM"),EZ.NORMAL_MOVE_DURATION=120,EZ.NORMAL_PART_DURATION=1800,EZ.BLITZ_MOVE_DURATION=30,EZ.BLITZ_PART_DURATION=900;class wZ{constructor(e){this.value=e}}wZ.PART_CREATED=new wZ(0),wZ.CONFIG_PROPOSED=new wZ(2),wZ.PART_STARTED=new wZ(3),wZ.PART_FINISHED=new wZ(4);class PZ{}class SZ extends PZ{static disjunction3(e,t,n,r,i){return new class extends SZ{encodeMove(s){return r(s)?{type:"T1",encoded:e.encode(s)}:i(s)?{type:"T2",encoded:t.encode(s)}:{type:"T3",encoded:n.encode(s)}}decodeMove(r){const i=Tw.getNonNullable(r).type,s=Tw.getNonNullable(r).encoded;return"T1"===i?e.decode(s):"T2"===i?t.decode(s):n.decode(s)}}}encode(e){return this.encodeMove(e)}decode(e){return hZ(!1===Array.isArray(e),"MoveEncoder.decode called with an array"),this.decodeMove(e)}}class bZ extends SZ{static ofN(e,t,n){return new class extends bZ{maxValue(){return e}encodeNumber(e){return t(e)}decodeNumber(e){return n(e)}}}static tuple(e,t,n){return new class extends bZ{maxValue(){let t=0;return Object.keys(e).forEach(n=>{t=t*e[n].shift()+e[n].maxValue()}),t}encodeNumber(n){const r=t(n);let i=0;return Object.keys(r).forEach(t=>{i=i*e[t].shift()+e[t].encode(r[t])}),i}decodeNumber(t){const r={};let i=t;return Object.keys(e).reverse().forEach(t=>{const n=i%e[t].shift();i=(i-n)/e[t].shift(),r[t]=e[t].decode(n)}),n(r)}}}static disjunction(e,t,n){return new class extends bZ{maxValue(){return Math.max(2*e.maxValue(),2*t.maxValue()+1)}encodeNumber(r){return n(r)?2*e.encodeNumber(r):2*t.encodeNumber(r)+1}decodeNumber(n){return n%2==0?e.decodeNumber(n/2):t.decodeNumber((n-1)/2)}}}static numberEncoder(e){return new class extends bZ{maxValue(){return e}encodeNumber(t){if(t>e)throw new Error("Cannot encode number bigger than the max with numberEncoder");return t}decodeNumber(t){if(t>e)throw new Error("Cannot decode number bigger than the max with numberEncoder");return t}}}shift(){return this.maxValue()+1}encodeMove(e){return this.encodeNumber(e)}decodeMove(e){return hZ("number"==typeof e,"Invalid encoded number"),this.decodeNumber(e)}}bZ.booleanEncoder=new class extends bZ{maxValue(){return 1}encodeNumber(e){return e?1:0}decodeNumber(e){if(0===e)return!1;if(1===e)return!0;throw new Error("Invalid encoded boolean")}};class OZ{constructor(){this.value=2}isPlayer(){return!1}toString(){return"PlayerNone"}equals(e){return this===e}}OZ.NONE=new OZ;class TZ{constructor(e){this.value=e}static of(e){return 0===e?TZ.ZERO:(Tw.expectToBe(e,1),TZ.ONE)}static fromTurn(e){return e%2==0?TZ.ZERO:TZ.ONE}isPlayer(){return!0}toString(){return"Player "+this.value}equals(e){return this===e}getScoreModifier(){return 0===this.value?-1:1}getPreVictory(){return this.getVictoryValue()-this.getScoreModifier()}getDefeatValue(){return this===TZ.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}getVictoryValue(){return this===TZ.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}getOpponent(){return this===TZ.ZERO?TZ.ONE:(Tw.expectToBe(this,TZ.ONE),TZ.ZERO)}}var IZ;TZ.numberEncoder=bZ.ofN(2,e=>e.value,e=>2===e?IZ.NONE:TZ.of(e)),TZ.ZERO=new TZ(0),TZ.ONE=new TZ(1),TZ.PLAYERS=[TZ.ZERO,TZ.ONE],function(e){e.ZERO=TZ.ZERO,e.ONE=TZ.ONE,e.NONE=OZ.NONE}(IZ||(IZ={}));class kZ{static rematchAccepted(e,t){return AZ("RematchAccepted",{typeGame:e,partId:t})}static getPlayer(e){return TZ.of(Tw.getNonNullable(e.data).player)}static getTypeGame(e){return Tw.getNonNullable(e.data).typeGame}static getPartId(e){return Tw.getNonNullable(e.data).partId}}function AZ(e,t){return{code:e,data:t}}function MZ(e){return t=>AZ(e,{player:t.value})}kZ.drawProposed=MZ("DrawProposed"),kZ.drawAccepted=AZ("DrawAccepted",{}),kZ.drawRefused=MZ("DrawRefused"),kZ.takeBackAsked=MZ("TakeBackAsked"),kZ.takeBackRefused=MZ("TakeBackRefused"),kZ.takeBackAccepted=MZ("TakeBackAccepted"),kZ.rematchProposed=MZ("RematchProposed"),kZ.addTurnTime=MZ("AddTurnTime"),kZ.addGlobalTime=MZ("AddGlobalTime");class NZ{static mapBiArray(e,t){const n=[];let r=0;for(;r<e.length;){n[r]=[];let i=0;for(;i<e[r].length;)n[r][i]=t(e[r][i]),i++;r++}return n}static createTable(e,t,n){const r=[];let i=t-1;for(;i>=0;){r[i]=[];let t=e-1;for(;t>=0;)r[i][t]=n,t--;i--}return r}static copyBiArray(e){const t=[];let n=0;for(;n<e.length;)t[n]=NZ.copyImmutableArray(e[n]),n++;return t}static copyImmutableArray(e){const t=[];let n=0;for(;n<e.length;)t[n]=e[n],n++;return t}static sortByDescending(e,t){e.sort((e,n)=>{const r=t(e),i=t(n);return r<i?1:r>i?-1:0})}static compareArray(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===Mw(e[n],t[n]))return!1;return!0}static compareTable(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===NZ.compareArray(e[n],t[n]))return!1;return!0}}let RZ=(()=>{class e extends rZ{constructor(t){super("parts",t),Iw(e.VERBOSE,"PartDAO.constructor")}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Or(FG))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class xZ{constructor(e,t,n){this.onDocumentCreated=e,this.onDocumentModified=t,this.onDocumentDeleted=n}}let DZ=(()=>{class e extends rZ{constructor(t){super("config-room",t),Iw(e.VERBOSE,"ConfigRoomDAO.constructor")}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Or(FG))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),LZ=(()=>{class e{constructor(t,n){this.configRoomDAO=t,this.connectedUserService=n,Iw(e.VERBOSE,"ConfigRoomService.constructor")}addCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(t.id,t)}removeCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(t.id)}subscribeToChanges(e,t){return this.configRoomDAO.subscribeToChanges(e,t)}subscribeToCandidates(e,t){let n=[];const r=new xZ(e=>{for(const t of e)n.push(t.data);t(n)},e=>{for(const t of e)n=n.map(e=>e.id===t.data.id?t.data:e);t(n)},e=>{for(const t of e)n=n.filter(e=>e.id!==t.data.id);t(n)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],r)}createInitialConfigRoom(t){var n=this;return Ow(function*(){Iw(e.VERBOSE,"ConfigRoomService.createInitialConfigRoom("+t+")");const r=n.connectedUserService.user.get().toMinimalUser();return n.configRoomDAO.set(t,{chosenOpponent:null,firstPlayer:_Z.RANDOM.value,partType:EZ.STANDARD.value,partStatus:wZ.PART_CREATED.value,maximalMoveDuration:EZ.NORMAL_MOVE_DURATION,totalPartDuration:EZ.NORMAL_PART_DURATION,creator:r})})()}joinGame(t){var n=this;return Ow(function*(){Iw(e.VERBOSE,"ConfigRoomService.joinGame("+t+")");const r=n.connectedUserService.user.get().toMinimalUser(),i=yield n.configRoomDAO.read(t);return i.isAbsent()?Lw.failure(e.GAME_DOES_NOT_EXIST()):(i.get().creator.id!==r.id&&(yield n.addCandidate(t,r)),Lw.SUCCESS)})()}cancelJoining(t){var n=this;return Ow(function*(){Iw(e.VERBOSE,`ConfigRoomService.cancelJoining(${t})`);const r=n.connectedUserService.user.get().toMinimalUser(),i=yield n.configRoomDAO.read(t);if(!i.isAbsent()){const e=i.get(),s=[n.removeCandidate(t,r)];e.chosenOpponent?.id===r.id&&s.push(n.configRoomDAO.update(t,{chosenOpponent:null,partStatus:wZ.PART_CREATED.value})),yield Promise.all(s)}})()}deleteConfigRoom(t,n){var r=this;return Ow(function*(){Iw(e.VERBOSE,`ConfigRoomService.deleteConfigRoom(${t}`),yield Promise.all(n.map(e=>r.removeCandidate(t,e))),yield r.configRoomDAO.delete(t)})()}proposeConfig(t,n,r,i,s,o){var a=this;return Ow(function*(){return Iw(e.VERBOSE,{configRoomService_proposeConfig:{configRoomId:t,maximalMoveDuration:i,firstPlayer:s,totalPartDuration:o}}),a.configRoomDAO.update(t,{partStatus:wZ.CONFIG_PROPOSED.value,chosenOpponent:n,partType:r.value,maximalMoveDuration:i,totalPartDuration:o,firstPlayer:s.value})})()}setChosenOpponent(t,n){return Iw(e.VERBOSE,`ConfigRoomService.setChosenOpponent(${t}, ${n.name})`),this.configRoomDAO.update(t,{chosenOpponent:n})}reviewConfig(t){var n=this;return Ow(function*(){return Iw(e.VERBOSE,`ConfigRoomService.reviewConfig(${t})`),n.configRoomDAO.update(t,{partStatus:wZ.PART_CREATED.value})})()}reviewConfigAndRemoveChosenOpponent(t){var n=this;return Ow(function*(){return Iw(e.VERBOSE,`ConfigRoomService.reviewConfigAndRemoveChosenOpponent(${t})`),n.configRoomDAO.update(t,{partStatus:wZ.PART_CREATED.value,chosenOpponent:null})})()}acceptConfig(t){return Iw(e.VERBOSE,`ConfigRoomService.acceptConfig(${t}`),this.configRoomDAO.update(t,{partStatus:wZ.PART_STARTED.value})}createConfigRoom(t,n){var r=this;return Ow(function*(){return Iw(e.VERBOSE,`ConfigRoomService.create(${t}`+JSON.stringify(n)+")"),r.configRoomDAO.set(t,n)})()}readConfigRoomById(t){var n=this;return Ow(function*(){return Iw(e.VERBOSE,`ConfigRoomService.readConfigRoomById(${t})`),(yield n.configRoomDAO.read(t)).get()})()}}return e.VERBOSE=!1,e.GAME_DOES_NOT_EXIST=()=>$localize`Game does not exist`,e.\u0275fac=function(t){return new(t||e)(Or(DZ),Or(yZ))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),FZ=(()=>{class e{constructor(t,n,r,i){this.partDAO=t,this.connectedUserService=n,this.configRoomService=r,this.chatService=i,Iw(e.VERBOSE,"GameService.constructor")}updateAndBumpIndex(e,t,n,r){var i=this;return Ow(function*(){return r={...r,lastUpdate:{index:n+1,player:t.value}},i.partDAO.update(e,r)})()}getPartValidity(e,t){var n=this;return Ow(function*(){const r=yield n.partDAO.read(e);return r.isAbsent()?Lw.failure("NONEXISTENT_PART"):r.get().typeGame===t?Lw.SUCCESS:Lw.failure("WRONG_GAME_TYPE")})()}createUnstartedPart(t){Iw(e.VERBOSE,"GameService.createPart("+t+")");const n=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({lastUpdate:{index:0,player:0},typeGame:t,playerZero:n,turn:-1,result:vZ.UNACHIEVED.value,listMoves:[]})}createChat(t){return Iw(e.VERBOSE,"GameService.createChat("+t+")"),this.chatService.createNewChat(t)}createPartConfigRoomAndChat(t){var n=this;return Ow(function*(){Iw(e.VERBOSE,`GameService.createGame(${t})`);const r=yield n.createUnstartedPart(t);return yield n.configRoomService.createInitialConfigRoom(r),yield n.createChat(r),r})()}startGameWithConfig(t,n,r,i){Iw(e.VERBOSE,"GameService.startGameWithConfig("+t+", "+JSON.stringify(i));const s=this.getStartingConfig(i);return this.updateAndBumpIndex(t,n,r,s)}getStartingConfig(e){let t,n,r=_Z.of(e.firstPlayer);return r===_Z.RANDOM&&(r=Math.random()<.5?_Z.CREATOR:_Z.CHOSEN_PLAYER),r===_Z.CREATOR?(t=e.creator,n=Tw.getNonNullable(e.chosenOpponent)):(t=Tw.getNonNullable(e.chosenOpponent),n=e.creator),{playerZero:t,playerOne:n,turn:0,beginning:vL(),remainingMsForZero:1e3*e.totalPartDuration,remainingMsForOne:1e3*e.totalPartDuration}}deletePart(t){return Iw(e.VERBOSE,"GameService.deletePart("+t+")"),this.partDAO.delete(t)}acceptConfig(t,n){var r=this;return Ow(function*(){return Iw(e.VERBOSE,{gameService_acceptConfig:{partId:t,configRoom:n}}),yield r.configRoomService.acceptConfig(t),r.startGameWithConfig(t,TZ.ONE,0,n)})()}subscribeToChanges(e,t){return this.partDAO.subscribeToChanges(e,t)}resign(e,t,n,r,i){return this.updateAndBumpIndex(e,n,t,{winner:r,loser:i,result:vZ.RESIGN.value,request:null})}notifyTimeout(e,t,n,r,i){return this.updateAndBumpIndex(e,t,n,{winner:r,loser:i,result:vZ.TIMEOUT.value,request:null})}sendRequest(e,t,n,r){return this.updateAndBumpIndex(e,t,n,{request:r})}proposeDraw(e,t,n){return this.sendRequest(e,n,t,kZ.drawProposed(n))}acceptDraw(e,t,n){return this.updateAndBumpIndex(e,n,t,{result:(n===TZ.ZERO?vZ.AGREED_DRAW_BY_ZERO:vZ.AGREED_DRAW_BY_ONE).value,request:null})}refuseDraw(e,t,n){return this.sendRequest(e,n,t,kZ.drawRefused(n))}proposeRematch(e,t,n){return this.sendRequest(e,n,t,kZ.rematchProposed(n))}acceptRematch(t,n,r){var i=this;return Ow(function*(){Iw(e.VERBOSE,{called:"GameService.acceptRematch(",partDocument:t});const s=Tw.getNonNullable(t.data),o=yield i.configRoomService.readConfigRoomById(t.id);let a;const l=i.connectedUserService.user.get().toMinimalUser();let c;s.playerZero.id===l.id?(c=Tw.getNonNullable(s.playerOne),a=_Z.CHOSEN_PLAYER):(c=s.playerZero,a=_Z.CREATOR);const u={...o,firstPlayer:a.value,creator:l,chosenOpponent:c,partStatus:wZ.PART_STARTED.value},h=i.getStartingConfig(u),d={lastUpdate:{index:0,player:r.value},typeGame:s.typeGame,result:vZ.UNACHIEVED.value,listMoves:[],...h},f=yield i.partDAO.create(d);return yield i.configRoomService.createConfigRoom(f,u),yield i.createChat(f),i.sendRequest(t.id,r,n,kZ.rematchAccepted(s.typeGame,f))})()}askTakeBack(e,t,n){return this.sendRequest(e,n,t,kZ.takeBackAsked(n))}acceptTakeBack(e,t,n,r){var i=this;return Ow(function*(){hZ(kZ.getPlayer(Tw.getNonNullable(t.data.request))!==n,"Illegal to accept your own request");const s=kZ.takeBackAccepted(n);let o=t.data.listMoves.slice(0,t.data.listMoves.length-1);o.length%2===n.value&&(o=o.slice(0,o.length-1));const a={request:s,listMoves:o,turn:o.length,lastUpdateTime:vL(),remainingMsForZero:Tw.getNonNullable(t.data.remainingMsForZero)-r[0],remainingMsForOne:Tw.getNonNullable(t.data.remainingMsForOne)-r[1]},l=t.data.lastUpdate.index;return yield i.updateAndBumpIndex(e,n,l,a)})()}refuseTakeBack(e,t,n){const r=kZ.takeBackRefused(n);return this.updateAndBumpIndex(e,n,t,{request:r})}addGlobalTime(e,t,n,r){var i=this;return Ow(function*(){let s={request:kZ.addGlobalTime(r.getOpponent())};return s=r===TZ.ZERO?{...s,remainingMsForOne:Tw.getNonNullable(n.remainingMsForOne)+3e5}:{...s,remainingMsForZero:Tw.getNonNullable(n.remainingMsForZero)+3e5},yield i.updateAndBumpIndex(e,r,t,s)})()}addTurnTime(e,t,n){var r=this;return Ow(function*(){const i={request:kZ.addTurnTime(e.getOpponent())};return yield r.updateAndBumpIndex(n,e,t,i)})()}updateDBBoard(t,n,r,i,s,o,a,l){var c=this;return Ow(function*(){Iw(e.VERBOSE,{gameService_updateDBBoard:{partId:t,encodedMove:r,scores:s,msToSubstract:i,notifyDraw:o,winner:a,loser:l}});const u=(yield c.partDAO.read(t)).get(),h=u.lastUpdate.index,d=u.turn+1,f=NZ.copyImmutableArray(u.listMoves);f[f.length]=r;let p={listMoves:f,turn:d,request:null,lastUpdateTime:vL()};return p=c.updateScore(p,s),p=c.substractMs(p,u,i),null!=a?p={...p,winner:a,loser:l,result:vZ.VICTORY.value}:!0===o&&(p={...p,result:vZ.HARD_DRAW.value}),yield c.updateAndBumpIndex(t,n,h,p)})()}updateScore(e,t){return void 0!==t?{...e,scorePlayerZero:t[0],scorePlayerOne:t[1]}:e}substractMs(e,t,n){return n[0]>0?{...e,remainingMsForZero:Tw.getNonNullable(t.remainingMsForZero)-n[0]}:n[1]>0?{...e,remainingMsForOne:Tw.getNonNullable(t.remainingMsForOne)-n[1]}:e}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Or(RZ),Or(yZ),Or(LZ),Or(oZ))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var UZ={prefix:"fab",iconName:"facebook",icon:[512,512,[],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},VZ={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},BZ={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]};class $Z{static getNavigatorLanguage(){return navigator.language}static getLocale(){const e=(localStorage.getItem("locale")??$Z.getNavigatorLanguage()??"fr").slice(0,2).toLowerCase();return["en","fr"].some(t=>t===e)?e:"fr"}}let zZ=(()=>{class e{changeTheme(e){localStorage.setItem("theme",e)}getTheme(){return Nw.ofNullable(localStorage.getItem("theme"))}changeLanguage(e){localStorage.setItem("locale",e.toLowerCase())}getLanguage(){return $Z.getLocale()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),HZ=(()=>{class e{constructor(e,t){this.document=e,this.userSettingsService=t,this.availableThemes=["dark","light"];const n=this.getStoredTheme();n.isPresent()?this.loadTheme(n.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}getStoredTheme(){const e=this.userSettingsService.getTheme();if(e.isPresent()){const t=e.get();if(this.availableThemes.some(e=>e===t))return Nw.of(t)}return Nw.empty()}loadTheme(e){this.loadStyle(e+".css"),this.theme=e}loadStyle(e){const t=this.document.getElementsByTagName("head")[0],n=this.document.getElementById("theme");if(null!=n)n.href=e;else{const n=this.document.createElement("link");n.id="theme",n.rel="stylesheet",n.href=`${e}`,t.appendChild(n)}}getTheme(){return this.theme}}return e.\u0275fac=function(t){return new(t||e)(Or(Kh),Or(zZ))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var GZ={prefix:"fas",iconName:"book-open",icon:[576,512,[],"f518","M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"]},ZZ={prefix:"fas",iconName:"cog",icon:[512,512,[],"f013","M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"]},qZ={prefix:"fas",iconName:"desktop",icon:[576,512,[],"f108","M528 0H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h192l-16 48h-72c-13.3 0-24 10.7-24 24s10.7 24 24 24h272c13.3 0 24-10.7 24-24s-10.7-24-24-24h-72l-16-48h192c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zm-16 352H64V64h448v288z"]},WZ={prefix:"fas",iconName:"eye",icon:[576,512,[],"f06e","M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"]},jZ={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M640 264v-16c0-8.84-7.16-16-16-16H344v-40h72c17.67 0 32-14.33 32-32V32c0-17.67-14.33-32-32-32H224c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h72v40H16c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h104v40H64c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h304v40h-56c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h104c8.84 0 16-7.16 16-16zM256 128V64h128v64H256zm-64 320H96v-64h96v64zm352 0h-96v-64h96v64z"]},YZ={prefix:"fas",iconName:"reply",icon:[512,512,[],"f3e5","M8.309 189.836L184.313 37.851C199.719 24.546 224 35.347 224 56.015v80.053c160.629 1.839 288 34.032 288 186.258 0 61.441-39.581 122.309-83.333 154.132-13.653 9.931-33.111-2.533-28.077-18.631 45.344-145.012-21.507-183.51-176.59-185.742V360c0 20.7-24.3 31.453-39.687 18.164l-176.004-152c-11.071-9.562-11.086-26.753 0-36.328z"]},KZ={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"]};function QZ(e){return(QZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function JZ(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eq(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){JZ(e,t,n[t])})}return e}function tq(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(r=(o=a.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(l){i=!0,s=l}finally{try{!r&&null!=a.return&&a.return()}finally{if(i)throw s}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var nq={},rq={};try{"undefined"!=typeof window&&(nq=window),"undefined"!=typeof document&&(rq=document),"undefined"!=typeof MutationObserver&&MutationObserver,"undefined"!=typeof performance&&performance}catch{}var iq=(nq.navigator||{}).userAgent,sq=void 0===iq?"":iq,oq=nq,aq=rq,lq=!!aq.documentElement&&!!aq.head&&"function"==typeof aq.addEventListener&&"function"==typeof aq.createElement,cq=(~sq.indexOf("MSIE")||sq.indexOf("Trident/"),"___FONT_AWESOME___"),uq="svg-inline--fa",hq=[1,2,3,4,5,6,7,8,9,10],dq=hq.concat([11,12,13,14,15,16,17,18,19,20]),fq={GROUP:"group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},pq=(["xs","sm","lg","fw","ul","li","border","pull-left","pull-right","spin","pulse","rotate-90","rotate-180","rotate-270","flip-horizontal","flip-vertical","flip-both","stack","stack-1x","stack-2x","inverse","layers","layers-text","layers-counter",fq.GROUP,fq.SWAP_OPACITY,fq.PRIMARY,fq.SECONDARY].concat(hq.map(function(e){return"".concat(e,"x")})).concat(dq.map(function(e){return"w-".concat(e)})),oq.FontAwesomeConfig||{});aq&&"function"==typeof aq.querySelector&&[["data-family-prefix","familyPrefix"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(e){var t=tq(e,2),n=t[1],r=function(e){return""===e||"false"!==e&&("true"===e||e)}(function(e){var t=aq.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}(t[0]));null!=r&&(pq[n]=r)});var gq=eq({},{familyPrefix:"fa",replacementClass:uq,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},pq);gq.autoReplaceSvg||(gq.observeMutations=!1);var mq=eq({},gq);oq.FontAwesomeConfig=mq;var yq=oq||{};yq[cq]||(yq[cq]={}),yq[cq].styles||(yq[cq].styles={}),yq[cq].hooks||(yq[cq].hooks={}),yq[cq].shims||(yq[cq].shims=[]);var vq=yq[cq],Cq=[];lq&&((aq.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(aq.readyState)||aq.addEventListener("DOMContentLoaded",function e(){aq.removeEventListener("DOMContentLoaded",e),Cq.map(function(e){return e()})}));var _q,Eq="pending",wq="fulfilled",Pq="rejected",Sq=function(){},bq="undefined"!=typeof global&&void 0!==global.process&&"function"==typeof global.process.emit,Oq="undefined"==typeof setImmediate?setTimeout:setImmediate,Tq=[];function Iq(){for(var e=0;e<Tq.length;e++)Tq[e][0](Tq[e][1]);Tq=[],_q=!1}function kq(e,t){Tq.push([e,t]),_q||(_q=!0,Oq(Iq,0))}function Aq(e){var t=e.owner,n=t._state,r=t._data,i=e[n],s=e.then;if("function"==typeof i){n=wq;try{r=i(r)}catch(o){xq(s,o)}}Mq(s,r)||(n===wq&&Nq(s,r),n===Pq&&xq(s,r))}function Mq(e,t){var n;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"===QZ(t))){var r=t.then;if("function"==typeof r)return r.call(t,function(r){n||(n=!0,t===r?Rq(e,r):Nq(e,r))},function(t){n||(n=!0,xq(e,t))}),!0}}catch(i){return n||xq(e,i),!0}return!1}function Nq(e,t){(e===t||!Mq(e,t))&&Rq(e,t)}function Rq(e,t){e._state===Eq&&(e._state="settled",e._data=t,kq(Lq,e))}function xq(e,t){e._state===Eq&&(e._state="settled",e._data=t,kq(Fq,e))}function Dq(e){e._then=e._then.forEach(Aq)}function Lq(e){e._state=wq,Dq(e)}function Fq(e){e._state=Pq,Dq(e),!e._handled&&bq&&global.process.emit("unhandledRejection",e._data,e)}function Uq(e){global.process.emit("rejectionHandled",e)}function Vq(e){if("function"!=typeof e)throw new TypeError("Promise resolver "+e+" is not a function");if(!(this instanceof Vq))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(e,t){function n(e){xq(t,e)}try{e(function(e){Nq(t,e)},n)}catch(r){n(r)}}(e,this)}Vq.prototype={constructor:Vq,_state:Eq,_then:null,_data:void 0,_handled:!1,then:function(e,t){var n={owner:this,then:new this.constructor(Sq),fulfilled:e,rejected:t};return(t||e)&&!this._handled&&(this._handled=!0,this._state===Pq&&bq&&kq(Uq,this)),this._state===wq||this._state===Pq?kq(Aq,n):this._then.push(n),n.then},catch:function(e){return this.then(null,e)}},Vq.all=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.all().");return new Vq(function(t,n){var r=[],i=0;function s(e){return i++,function(n){r[e]=n,--i||t(r)}}for(var o,a=0;a<e.length;a++)(o=e[a])&&"function"==typeof o.then?o.then(s(a),n):r[a]=o;i||t(r)})},Vq.race=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.race().");return new Vq(function(t,n){for(var r,i=0;i<e.length;i++)(r=e[i])&&"function"==typeof r.then?r.then(t,n):t(r)})},Vq.resolve=function(e){return e&&"object"===QZ(e)&&e.constructor===Vq?e:new Vq(function(t){t(e)})},Vq.reject=function(e){return new Vq(function(t,n){n(e)})};var Bq={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function $q(){for(var e=12,t="";e-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function zq(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Hq(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,": ").concat(e[n],";")},"")}function Gq(e){return e.size!==Bq.size||e.x!==Bq.x||e.y!==Bq.y||e.rotate!==Bq.rotate||e.flipX||e.flipY}function Zq(e){var t=e.transform,n=e.iconWidth,r={transform:"translate(".concat(e.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),s="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),o="rotate(".concat(t.rotate," 0 0)");return{outer:r,inner:{transform:"".concat(i," ").concat(s," ").concat(o)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}var qq={x:0,y:0,width:"100%",height:"100%"};function Wq(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}function jq(e){return"g"===e.tag?e.children:[e]}function Yq(e){var t=e.icons,n=t.main,r=t.mask,i=e.prefix,s=e.iconName,o=e.transform,a=e.symbol,l=e.title,c=e.maskId,u=e.titleId,h=e.extra,d=e.watchable,f=void 0!==d&&d,p=r.found?r:n,g=p.width,m=p.height,y="fak"===i,v=y?"":"fa-w-".concat(Math.ceil(g/m*16)),C=[mq.replacementClass,s?"".concat(mq.familyPrefix,"-").concat(s):"",v].filter(function(e){return-1===h.classes.indexOf(e)}).filter(function(e){return""!==e||!!e}).concat(h.classes).join(" "),_={children:[],attributes:eq({},h.attributes,{"data-prefix":i,"data-icon":s,class:C,role:h.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(g," ").concat(m)})},E=y&&!~h.classes.indexOf("fa-fw")?{width:"".concat(g/m*16*.0625,"em")}:{};f&&(_.attributes["data-fa-i2svg"]=""),l&&_.children.push({tag:"title",attributes:{id:_.attributes["aria-labelledby"]||"title-".concat(u||$q())},children:[l]});var w=eq({},_,{prefix:i,iconName:s,main:n,mask:r,maskId:c,transform:o,symbol:a,styles:eq({},E,h.styles)}),P=r.found&&n.found?function(e){var t=e.children,n=e.attributes,r=e.main,i=e.mask,s=e.maskId,o=r.icon,a=i.icon,l=Zq({transform:e.transform,containerWidth:i.width,iconWidth:r.width}),c={tag:"rect",attributes:eq({},qq,{fill:"white"})},u=o.children?{children:o.children.map(Wq)}:{},h={tag:"g",attributes:eq({},l.inner),children:[Wq(eq({tag:o.tag,attributes:eq({},o.attributes,l.path)},u))]},d={tag:"g",attributes:eq({},l.outer),children:[h]},f="mask-".concat(s||$q()),p="clip-".concat(s||$q()),g={tag:"mask",attributes:eq({},qq,{id:f,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[c,d]},m={tag:"defs",children:[{tag:"clipPath",attributes:{id:p},children:jq(a)},g]};return t.push(m,{tag:"rect",attributes:eq({fill:"currentColor","clip-path":"url(#".concat(p,")"),mask:"url(#".concat(f,")")},qq)}),{children:t,attributes:n}}(w):function(e){var t=e.children,n=e.attributes,r=e.main,i=e.transform,s=Hq(e.styles);if(s.length>0&&(n.style=s),Gq(i)){var o=Zq({transform:i,containerWidth:r.width,iconWidth:r.width});t.push({tag:"g",attributes:eq({},o.outer),children:[{tag:"g",attributes:eq({},o.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:eq({},r.icon.attributes,o.path)}]}]})}else t.push(r.icon);return{children:t,attributes:n}}(w),S=P.attributes;return w.children=P.children,w.attributes=S,a?function(e){var t=e.iconName,n=e.children,r=e.symbol;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:eq({},e.attributes,{id:!0===r?"".concat(e.prefix,"-").concat(mq.familyPrefix,"-").concat(t):r}),children:n}]}]}(w):function(e){var t=e.children,n=e.main,r=e.mask,i=e.attributes,s=e.styles,o=e.transform;if(Gq(o)&&n.found&&!r.found){var a={x:n.width/n.height/2,y:.5};i.style=Hq(eq({},s,{"transform-origin":"".concat(a.x+o.x/16,"em ").concat(a.y+o.y/16,"em")}))}return[{tag:"svg",attributes:i,children:t}]}(w)}var Kq=function(e,t,n,r){var i,s,o,a=Object.keys(e),l=a.length,c=void 0!==r?function(e,t){return function(n,r,i,s){return e.call(t,n,r,i,s)}}(t,r):t;for(void 0===n?(i=1,o=e[a[0]]):(i=0,o=n);i<l;i++)o=c(o,e[s=a[i]],s,e);return o};function Qq(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.skipHooks,i=void 0!==r&&r,s=Object.keys(t).reduce(function(e,n){var r=t[n];return r.icon?e[r.iconName]=r.icon:e[n]=r,e},{});"function"!=typeof vq.hooks.addPack||i?vq.styles[e]=eq({},vq.styles[e]||{},s):vq.hooks.addPack(e,s),"fas"===e&&Qq("fa",t)}var Xq=vq.styles,Jq=vq.shims,eW=function(){var e=function(e){return Kq(Xq,function(t,n,r){return t[r]=Kq(n,e,{}),t},{})};e(function(e,t,n){return t[3]&&(e[t[3]]=n),e}),e(function(e,t,n){var r=t[2];return e[n]=n,r.forEach(function(t){e[t]=n}),e});var t="far"in Xq;Kq(Jq,function(e,n){var r=n[1];return"far"===r&&!t&&(r="fas"),e[n[0]]={prefix:r,iconName:n[2]},e},{})};function tW(e,t,n){if(e&&e[t]&&e[t][n])return{prefix:t,iconName:n,icon:e[t][n]}}function nW(e){var t=e.tag,n=e.attributes,r=void 0===n?{}:n,i=e.children,s=void 0===i?[]:i;return"string"==typeof e?zq(e):"<".concat(t," ").concat(function(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,'="').concat(zq(e[n]),'" ')},"").trim()}(r),">").concat(s.map(nW).join(""),"</").concat(t,">")}eW();function rW(e){this.name="MissingIcon",this.message=e||"Icon unavailable",this.stack=(new Error).stack}(rW.prototype=Object.create(Error.prototype)).constructor=rW;var iW={fill:"currentColor"},sW={attributeType:"XML",repeatCount:"indefinite",dur:"2s"},oW=(eq({},iW,{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"}),eq({},sW,{attributeName:"opacity"}));function aW(e){var t=e[0],n=e[1],r=tq(e.slice(4),1)[0];return{found:!0,width:t,height:n,icon:Array.isArray(r)?{tag:"g",attributes:{class:"".concat(mq.familyPrefix,"-").concat(fq.GROUP)},children:[{tag:"path",attributes:{class:"".concat(mq.familyPrefix,"-").concat(fq.SECONDARY),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(mq.familyPrefix,"-").concat(fq.PRIMARY),fill:"currentColor",d:r[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:r}}}}eq({},iW,{cx:"256",cy:"364",r:"28"}),eq({},sW,{attributeName:"r",values:"28;14;28;28;14;28;"}),eq({},oW,{values:"1;0;1;1;0;1;"}),eq({},iW,{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),eq({},oW,{values:"1;0;0;0;0;1;"}),eq({},iW,{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),eq({},oW,{values:"0;0;1;1;0;0;"});var lW=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.definitions={}}return function(e,t,n){t&&XZ(e.prototype,t)}(e,[{key:"add",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.reduce(this._pullDefinitions,{});Object.keys(i).forEach(function(t){e.definitions[t]=eq({},e.definitions[t]||{},i[t]),Qq(t,i[t]),eW()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,t){var n=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(n).map(function(t){var r=n[t],i=r.prefix,s=r.iconName,o=r.icon;e[i]||(e[i]={}),e[i][s]=o}),e}}]),e}();function cW(){mq.autoAddCss&&!fW&&(function(e){if(e&&lq){var t=aq.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;for(var n=aq.head.childNodes,r=null,i=n.length-1;i>-1;i--){var s=n[i],o=(s.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=s)}aq.head.insertBefore(t,r)}}(function(){var e="fa",t=uq,n=mq.familyPrefix,r=mq.replacementClass,i='svg:not(:root).svg-inline--fa {\n  overflow: visible;\n}\n\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.225em;\n}\n.svg-inline--fa.fa-w-1 {\n  width: 0.0625em;\n}\n.svg-inline--fa.fa-w-2 {\n  width: 0.125em;\n}\n.svg-inline--fa.fa-w-3 {\n  width: 0.1875em;\n}\n.svg-inline--fa.fa-w-4 {\n  width: 0.25em;\n}\n.svg-inline--fa.fa-w-5 {\n  width: 0.3125em;\n}\n.svg-inline--fa.fa-w-6 {\n  width: 0.375em;\n}\n.svg-inline--fa.fa-w-7 {\n  width: 0.4375em;\n}\n.svg-inline--fa.fa-w-8 {\n  width: 0.5em;\n}\n.svg-inline--fa.fa-w-9 {\n  width: 0.5625em;\n}\n.svg-inline--fa.fa-w-10 {\n  width: 0.625em;\n}\n.svg-inline--fa.fa-w-11 {\n  width: 0.6875em;\n}\n.svg-inline--fa.fa-w-12 {\n  width: 0.75em;\n}\n.svg-inline--fa.fa-w-13 {\n  width: 0.8125em;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-15 {\n  width: 0.9375em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-w-17 {\n  width: 1.0625em;\n}\n.svg-inline--fa.fa-w-18 {\n  width: 1.125em;\n}\n.svg-inline--fa.fa-w-19 {\n  width: 1.1875em;\n}\n.svg-inline--fa.fa-w-20 {\n  width: 1.25em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-border {\n  height: 1.5em;\n}\n.svg-inline--fa.fa-li {\n  width: 2em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: #ff253a;\n  border-radius: 1em;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  color: #fff;\n  height: 1.5em;\n  line-height: 1;\n  max-width: 5em;\n  min-width: 1.5em;\n  overflow: hidden;\n  padding: 0.25em;\n  right: 0;\n  text-overflow: ellipsis;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: 0;\n  right: 0;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: 0;\n  left: 0;\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  right: 0;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: 0;\n  right: auto;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-lg {\n  font-size: 1.3333333333em;\n  line-height: 0.75em;\n  vertical-align: -0.0667em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: 2.5em;\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: -2em;\n  position: absolute;\n  text-align: center;\n  width: 2em;\n  line-height: inherit;\n}\n\n.fa-border {\n  border: solid 0.08em #eee;\n  border-radius: 0.1em;\n  padding: 0.2em 0.25em 0.15em;\n}\n\n.fa-pull-left {\n  float: left;\n}\n\n.fa-pull-right {\n  float: right;\n}\n\n.fa.fa-pull-left,\n.fas.fa-pull-left,\n.far.fa-pull-left,\n.fal.fa-pull-left,\n.fab.fa-pull-left {\n  margin-right: 0.3em;\n}\n.fa.fa-pull-right,\n.fas.fa-pull-right,\n.far.fa-pull-right,\n.fal.fa-pull-right,\n.fab.fa-pull-right {\n  margin-left: 0.3em;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n          animation: fa-spin 2s infinite linear;\n}\n\n.fa-pulse {\n  -webkit-animation: fa-spin 1s infinite steps(8);\n          animation: fa-spin 1s infinite steps(8);\n}\n\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n:root .fa-rotate-90,\n:root .fa-rotate-180,\n:root .fa-rotate-270,\n:root .fa-flip-horizontal,\n:root .fa-flip-vertical,\n:root .fa-flip-both {\n  -webkit-filter: none;\n          filter: none;\n}\n\n.fa-stack {\n  display: inline-block;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: #fff;\n}\n\n.sr-only {\n  border: 0;\n  clip: rect(0, 0, 0, 0);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n.sr-only-focusable:active, .sr-only-focusable:focus {\n  clip: auto;\n  height: auto;\n  margin: 0;\n  overflow: visible;\n  position: static;\n  width: auto;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse {\n  color: #fff;\n}';if(n!==e||r!==t){var s=new RegExp("\\.".concat(e,"\\-"),"g"),o=new RegExp("\\--".concat(e,"\\-"),"g"),a=new RegExp("\\.".concat(t),"g");i=i.replace(s,".".concat(n,"-")).replace(o,"--".concat(n,"-")).replace(a,".".concat(r))}return i}()),fW=!0)}function uW(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map(function(e){return nW(e)})}}),Object.defineProperty(e,"node",{get:function(){if(lq){var t=aq.createElement("div");return t.innerHTML=e.html,t.children}}}),e}function hW(e){var t=e.prefix,n=void 0===t?"fa":t,r=e.iconName;if(r)return tW(dW.definitions,n,r)||tW(vq.styles,n,r)}var dW=new lW,fW=!1,pW=function(e){return function(e){var t={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e?e.toLowerCase().split(" ").reduce(function(e,t){var n=t.toLowerCase().split("-"),r=n[0],i=n.slice(1).join("-");if(r&&"h"===i)return e.flipX=!0,e;if(r&&"v"===i)return e.flipY=!0,e;if(i=parseFloat(i),isNaN(i))return e;switch(r){case"grow":e.size=e.size+i;break;case"shrink":e.size=e.size-i;break;case"left":e.x=e.x-i;break;case"right":e.x=e.x+i;break;case"up":e.y=e.y-i;break;case"down":e.y=e.y+i;break;case"rotate":e.rotate=e.rotate+i}return e},t):t}(e)},gW=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:hW(t||{}),i=n.mask;return i&&(i=(i||{}).icon?i:hW(i||{})),e(r,eq({},n,{mask:i}))}}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,r=void 0===n?Bq:n,i=t.symbol,s=void 0!==i&&i,o=t.mask,a=void 0===o?null:o,l=t.maskId,c=void 0===l?null:l,u=t.title,h=void 0===u?null:u,d=t.titleId,f=void 0===d?null:d,p=t.classes,g=void 0===p?[]:p,m=t.attributes,y=void 0===m?{}:m,v=t.styles,C=void 0===v?{}:v;if(e){var _=e.prefix,E=e.iconName,w=e.icon;return uW(eq({type:"icon"},e),function(){return cW(),mq.autoA11y&&(h?y["aria-labelledby"]="".concat(mq.replacementClass,"-title-").concat(f||$q()):(y["aria-hidden"]="true",y.focusable="false")),Yq({icons:{main:aW(w),mask:a?aW(a.icon):{found:!1,width:null,height:null,icon:{}}},prefix:_,iconName:E,transform:eq({},Bq,r),symbol:s,title:h,maskId:c,titleId:f,extra:{attributes:y,styles:C,classes:g}})})}});const mW=["*"],yW=e=>{const t={"fa-spin":e.spin,"fa-pulse":e.pulse,"fa-fw":e.fixedWidth,"fa-border":e.border,"fa-inverse":e.inverse,"fa-layers-counter":e.counter,"fa-flip-horizontal":"horizontal"===e.flip||"both"===e.flip,"fa-flip-vertical":"vertical"===e.flip||"both"===e.flip,[`fa-${e.size}`]:null!==e.size,[`fa-rotate-${e.rotate}`]:null!==e.rotate,[`fa-pull-${e.pull}`]:null!==e.pull,[`fa-stack-${e.stackItemSize}`]:null!=e.stackItemSize};return Object.keys(t).map(e=>t[e]?e:null).filter(e=>e)};let vW=(()=>{class e{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),CW=(()=>{class e{constructor(){this.definitions={}}addIcons(...e){for(const t of e){t.prefix in this.definitions||(this.definitions[t.prefix]={}),this.definitions[t.prefix][t.iconName]=t;for(const e of t.icon[2])"string"==typeof e&&(this.definitions[t.prefix][e]=t)}}addIconPacks(...e){for(const t of e){const e=Object.keys(t).map(e=>t[e]);this.addIcons(...e)}}getIconDefinition(e,t){return e in this.definitions&&t in this.definitions[e]?this.definitions[e][t]:null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),_W=(()=>{class e{constructor(){this.stackItemSize="1x"}ngOnChanges(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=st({type:e,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[vt]}),e})(),EW=(()=>{class e{constructor(e,t){this.renderer=e,this.elementRef=t}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${e.size.currentValue}`),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${e.size.previousValue}`))}}return e.\u0275fac=function(t){return new(t||e)(ua(Oc),ua(Pc))},e.\u0275cmp=Je({type:e,selectors:[["fa-stack"]],inputs:{size:"size"},features:[vt],ngContentSelectors:mW,decls:1,vars:0,template:function(e,t){1&e&&(function(e){const t=zt()[16][6];if(!t.projection){const n=t.projection=fr(e?e.length:1,null),r=n.slice();let i=t.child;for(;null!==i;){const t=e?ba(i,e):0;null!==t&&(r[t]?r[t].projectionNext=i:n[t]=i,r[t]=i),i=i.next}}}(),function(e,t=0,n){const r=zt(),i=Ht(),s=Fs(i,20+e,16,null,n||null);null===s.projection&&(s.projection=t),Kt(),64!=(64&s.flags)&&function(e,t,n){hs(t[11],0,t,n,Wi(e,n,t),Ji(n.parent||t[6],n,t))}(i,r,s)}(0))},encapsulation:2}),e})(),wW=(()=>{class e{constructor(e,t,n,r,i){this.sanitizer=e,this.config=t,this.iconLibrary=n,this.stackItem=r,this.classes=[],null!=i&&null==r&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(e){if(null==this.icon&&null==this.config.fallbackIcon)return(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})();let t=null;if(t=this.icon??this.config.fallbackIcon,e){const e=this.findIconDefinition(t);if(null!=e){const t=this.buildParams();this.renderIcon(e,t)}}}render(){this.ngOnChanges({})}findIconDefinition(e){const t=((e,t)=>(e=>void 0!==e.prefix&&void 0!==e.iconName)(e)?e:Array.isArray(e)&&2===e.length?{prefix:e[0],iconName:e[1]}:"string"==typeof e?{prefix:t,iconName:e}:void 0)(e,this.config.defaultPrefix);return"icon"in t?t:this.iconLibrary.getIconDefinition(t.prefix,t.iconName)??((e=>{throw new Error(`Could not find icon with iconName=${e.iconName} and prefix=${e.prefix} in the icon library.`)})(t),null)}buildParams(){const e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},t="string"==typeof this.transform?pW(this.transform):this.transform;return{title:this.title,transform:t,classes:[...yW(e),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(e,t){const n=gW(e,t);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(n.html.join("\n"))}}return e.\u0275fac=function(t){return new(t||e)(ua(Bf),ua(vW),ua(CW),ua(_W,8),ua(EW,8))},e.\u0275cmp=Je({type:e,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,t){2&e&&(nl("innerHTML",t.renderedIconHTML,vi),ra("title",t.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[vt],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})(),PW=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e}),e.\u0275inj=Se({}),e})();function SW(e,t){if(1&e&&(ma(0),ga(1,"fa-icon",24),ya()),2&e){const e=Sa();Ts(1),ha("icon",e.faSpinner)}}function bW(e,t){if(1&e){const e=va();ma(0),fa(1,"div",9),fa(2,"a",10),Qa(3),pa(),fa(4,"div",12),fa(5,"a",26),Ea("click",function(){return Gt(e),Sa(2).logout()}),sc(6,27),pa(),pa(),pa(),ya()}if(2&e){const e=Sa(2);Ts(3),Xa(e.username.get())}}const OW=function(){return["/register"]},TW=function(){return["/login"]};function IW(e,t){1&e&&(fa(0,"div",28),fa(1,"a",29),fa(2,"strong"),sc(3,30),pa(),pa(),fa(4,"a",31),sc(5,32),pa(),pa()),2&e&&(Ts(1),ha("routerLink",wu(2,OW)),Ts(3),ha("routerLink",wu(3,TW)))}function kW(e,t){if(1&e&&(la(0,bW,7,1,"ng-container",22),la(1,IW,6,4,"ng-template",null,25,Ku)),2&e){const e=ca(2);ha("ngIf",Sa().username.isPresent())("ngIfElse",e)}}const AW=function(){return["/"]},MW=function(){return["/play"]},NW=function(){return["/lobby"]},RW=function(){return["/local"]},xW=function(){return["/tutorial"]},DW=function(){return["/settings"]};let LW=(()=>{class e{constructor(e,t,n){this.router=e,this.connectedUserService=t,this.userService=n,this.loading=!0,this.username=Nw.empty(),this.faCog=ZZ,this.faSpinner=KZ,this.showMenu=!1}ngOnInit(){this.userSub=this.connectedUserService.subscribeToUser(e=>{this.loading=!1,this.username=e.username.isPresent()?e.username:e.email})}logout(){var e=this;return Ow(function*(){yield e.connectedUserService.disconnect(),yield e.router.navigate(["/"])})()}ngOnDestroy(){this.userSub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(ua(gC),ua(yZ),ua(fZ))},e.\u0275cmp=Je({type:e,selectors:[["app-header"]],decls:35,vars:19,consts:function(){let e,t,n,r,i,s,o,a,l,c,u;return e=$localize`Home`,t=$localize`Play online`,n=$localize`Create a game`,r=$localize`Join a game`,i=$localize`Play offline`,s=$localize`Create a game`,o=$localize`Learn the rules`,a=$localize`Settings`,l=$localize`Log out`,c=$localize`Register`,u=$localize`Log in`,[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],e,[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],t,[1,"navbar-dropdown"],n,r,i,s,o,[1,"navbar-end"],["data-tooltip",a,1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","logout",1,"navbar-item",3,"click"],l,[1,"buttons"],[1,"button","is-primary",3,"routerLink"],c,[1,"button","is-light",3,"routerLink"],u]},template:function(e,t){if(1&e&&(fa(0,"nav",0),fa(1,"div",1),fa(2,"a",2),ga(3,"img",3),pa(),fa(4,"a",4),Ea("click",function(){return t.showMenu=!t.showMenu}),ga(5,"span",5),ga(6,"span",5),ga(7,"span",5),pa(),pa(),fa(8,"div",6),Ea("click",function(){return t.showMenu=!t.showMenu}),fa(9,"div",7),fa(10,"a",2),sc(11,8),pa(),fa(12,"div",9),fa(13,"a",10),sc(14,11),pa(),fa(15,"div",12),fa(16,"a",2),sc(17,13),pa(),fa(18,"a",2),sc(19,14),pa(),pa(),pa(),fa(20,"div",9),fa(21,"a",10),sc(22,15),pa(),fa(23,"div",12),fa(24,"a",2),sc(25,16),pa(),fa(26,"a",2),sc(27,17),pa(),pa(),pa(),pa(),fa(28,"div",18),fa(29,"a",19),ga(30,"fa-icon",20),pa(),fa(31,"div",21),la(32,SW,2,1,"ng-container",22),la(33,kW,3,2,"ng-template",null,23,Ku),pa(),pa(),pa(),pa()),2&e){const e=ca(34);Ts(2),ha("routerLink",wu(12,AW)),Ts(2),ha("ngClass",t.showMenu?"is-active":""),Ts(4),ha("ngClass",t.showMenu?"is-active":""),Ts(2),ha("routerLink",wu(13,AW)),Ts(6),ha("routerLink",wu(14,MW)),Ts(2),ha("routerLink",wu(15,NW)),Ts(6),ha("routerLink",wu(16,RW)),Ts(2),ha("routerLink",wu(17,xW)),Ts(3),ha("routerLink",wu(18,DW)),Ts(1),ha("icon",t.faCog),Ts(2),ha("ngIf",t.loading)("ngIfElse",e)}},directives:[vC,Jd,wW,rf],encapsulation:2}),e})(),FW=(()=>{class e{constructor(e,t){this._themeService=e,this._errorLoggerService=t,this.faTwitter=BZ,this.faFacebook=UZ,this.faGithub=VZ}}return e.\u0275fac=function(t){return new(t||e)(ua(HZ),ua(uZ))},e.\u0275cmp=Je({type:e,selectors:[["app-root"]],decls:18,vars:3,consts:function(){let e;return e=$localize`If you like ${"\ufffd#8\ufffd"}:START_TAG_STRONG:EveryBoard${"\ufffd/#8\ufffd"}:CLOSE_TAG_STRONG:, follow us!`,[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],e,["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoard"],["href","https://facebook.com/EveryBoard"]]},template:function(e,t){1&e&&(ga(0,"app-header"),fa(1,"main",0),ga(2,"router-outlet"),pa(),fa(3,"footer",1),fa(4,"div",2),fa(5,"p"),fa(6,"span"),rc(7,3),ga(8,"strong"),ic(),pa(),Qa(9," \xa0 "),fa(10,"a",4),ga(11,"fa-icon",5),pa(),Qa(12,"\xa0 "),fa(13,"a",6),ga(14,"fa-icon",5),pa(),Qa(15,"\xa0 "),fa(16,"a",7),ga(17,"fa-icon",5),pa(),pa(),pa(),pa()),2&e&&(Ts(11),ha("icon",t.faGithub),Ts(3),ha("icon",t.faTwitter),Ts(3),ha("icon",t.faFacebook))},directives:[LW,_C,wW],encapsulation:2}),e})();class UW{constructor(e,t){this.x=e,this.y=t}equals(e){return this.x===e.x&&this.y===e.y}}class VW extends UW{isDown(){return 1===this.y}isUp(){return-1===this.y}isLeft(){return-1===this.x}isRight(){return 1===this.x}toInt(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}toString(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}class BW{of(e,t){for(const n of this.all)if(n.x===e&&n.y===t)return Rw.success(n);return Rw.failure("Invalid x and y in direction construction")}fromDelta(e,t){return 0===e&&0===t?Rw.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.of(Math.sign(e),Math.sign(t)):Rw.failure(HW.DIRECTION_MUST_BE_LINEAR())}fromMove(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}fromString(e){switch(e){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return Rw.failure(`Invalid direction string ${e}`)}}fromInt(e){switch(e){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return Rw.failure(`Invalid int direction: ${e}`)}}}class $W extends VW{constructor(e,t){super(e,t)}isDiagonal(){return 0!==this.x&&0!==this.y}getOpposite(){return $W.factory.of(-this.x,-this.y).get()}}$W.UP=new $W(0,-1),$W.UP_RIGHT=new $W(1,-1),$W.RIGHT=new $W(1,0),$W.DOWN_RIGHT=new $W(1,1),$W.DOWN=new $W(0,1),$W.DOWN_LEFT=new $W(-1,1),$W.LEFT=new $W(-1,0),$W.UP_LEFT=new $W(-1,-1),$W.factory=new class extends BW{constructor(){super(...arguments),this.all=[$W.UP,$W.UP_RIGHT,$W.RIGHT,$W.DOWN_RIGHT,$W.DOWN,$W.DOWN_LEFT,$W.LEFT,$W.UP_LEFT]}},$W.DIRECTIONS=$W.factory.all,$W.DIAGONALS=[$W.UP_RIGHT,$W.DOWN_RIGHT,$W.DOWN_LEFT,$W.UP_LEFT],$W.ORTHOGONALS=[$W.UP,$W.RIGHT,$W.DOWN,$W.LEFT],$W.encoder=new class extends PZ{encode(e){return e.toString()}decode(e){return hZ("string"==typeof e,"Invalid encoded direction"),$W.factory.fromString(e).get()}};class zW extends VW{constructor(e,t){super(e,t)}getOpposite(){return zW.factory.of(-this.x,-this.y).get()}}zW.UP=new zW(0,-1),zW.RIGHT=new zW(1,0),zW.DOWN=new zW(0,1),zW.LEFT=new zW(-1,0),zW.factory=new class extends BW{constructor(){super(...arguments),this.all=[zW.UP,zW.RIGHT,zW.DOWN,zW.LEFT]}of(e,t){return 0===e&&-1===t?Rw.success(zW.UP):1===e&&0===t?Rw.success(zW.RIGHT):0===e&&1===t?Rw.success(zW.DOWN):-1===e&&0===t?Rw.success(zW.LEFT):Rw.failure("Invalid orthogonal from x and y")}},zW.ORTHOGONALS=zW.factory.all,zW.encoder=new class extends PZ{encode(e){return e.toString()}decode(e){return hZ("string"==typeof e,"Invalid encoded orthogonal"),zW.factory.fromString(e).get()}};let HW=(()=>{class e{}return e.DIRECTION_MUST_BE_LINEAR=()=>$localize`You must move in a straight line! You can only move orthogonally or diagonally!`,e})();class GW{constructor(e,t){this.x=e,this.y=t}static numberEncoder(e,t){return bZ.tuple([bZ.numberEncoder(e),bZ.numberEncoder(t)],e=>[e.x,e.y],e=>new GW(e[0],e[1]))}getNext(e,t){return new GW(this.x+(t=t??1)*e.x,this.y+t*e.y)}getPrevious(e,t){return this.getNext(e,-(t=t??1))}getLeft(e){return new GW(this.x+e.y,this.y+-e.x)}getRight(e){return new GW(this.x+-e.y,this.y+e.x)}getOpposite(){return new GW(-this.x,-this.y)}isInRange(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}isNotInRange(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}getDirectionToward(e){return $W.factory.fromMove(this,e)}getOrthogonalDistance(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}getDistance(e){if(!e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");const t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}isHexagonallyAlignedWith(e){const t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}isAlignedWith(e){const t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}getVectorToward(e){return new GW(e.x-this.x,e.y-this.y)}getMinimalVectorToward(e){return this.getVectorToward(e).toVector()}getCoordsToward(e){if(e.equals(this))return[];if(!e.isAlignedWith(this))return[];const t=this.getDirectionToward(e).get();let n=this.getNext(t,1);const r=[];for(;!1===n.equals(e);)r.push(n),n=n.getNext(t,1);return r}toVector(){const e=Math.abs(this.x),t=Math.abs(this.y),n=Math.max(e,t);let r=this.x,i=this.y,s=2;for(;s<=n;)r%s==0&&i%s==0?(r/=s,i/=s):s++;return new GW(r,i)}isBetween(e,t){const n=e.getMinimalVectorToward(this),r=t.getMinimalVectorToward(this);return n.equals(r.getOpposite())}getUntil(e){const t=[],n=this.getDirectionToward(e).get();let r=this.getNext(n);for(;!1===r.equals(e);)t.push(r),r=r.getNext(n);return t}equals(e){return this===e||e.x===this.x&&e.y===this.y}compareTo(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}toString(){return"("+this.x+", "+this.y+")"}}GW.encoder=new class extends PZ{encode(e){return{x:e.x,y:e.y}}decode(e){const t=e;return hZ(null!=t.x&&"number"==typeof t.x&&null!=t.y&&"number"==typeof t.y,"Invalid encoded coord"),new GW(t.x,t.y)}};let ZW=(()=>{class e{constructor(e){this.messageDisplayer=e,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.scores=Nw.empty(),this.imagesLocation="assets/images/"}message(e){this.messageDisplayer.gameMessage(e)}cancelMove(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?Lw.SUCCESS:(this.messageDisplayer.gameMessage(e),Lw.failure(e))}cancelMoveAttempt(){}getPlayerClass(e){switch(e){case TZ.ZERO:return"player0";case TZ.ONE:return"player1";default:return Tw.expectToBe(e,IZ.NONE),""}}pass(){var e=this;return Ow(function*(){return uZ.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name})})()}getTurn(){return this.rules.node.gameState.turn}getCurrentPlayer(){return this.rules.node.gameState.getCurrentPlayer()}getState(){return this.rules.node.gameState}getPreviousState(){return this.rules.node.mother.get().gameState}range(e){const t=[];for(let n=0;n<e;n++)t.push(n);return t}}return e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,t){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),qW=(()=>{class e extends ZW{getHexaCoordsBy(e,t){const n=new GW(e,t);return this.getHexaCoordsAt(n)}getHexaCoordsAt(e){let t="";const n=this.hexaLayout.getHexaCoordsAt(e);for(const r of n)t+=r.x+" "+r.y+" ";return t+=n[0].x+" "+n[0].y,t}getCenterBy(e,t){const n=new GW(e,t);return this.getCenterAt(n)}getCenterAt(e){return this.hexaLayout.getCenterAt(e)}}return e.\u0275fac=function(){let t;return function(n){return(t||(t=tr(e)))(n||e)}}(),e.\u0275cmp=Je({type:e,selectors:[["ng-component"]],features:[Go],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();class WW{constructor(e){this.value=e}static from(e){switch(e){case WW.ZERO.value:return WW.ZERO;case WW.ONE.value:return WW.ONE;case WW.EMPTY.value:return WW.EMPTY;case WW.UNREACHABLE.value:return WW.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+e)}}static ofPlayer(e){return e===TZ.ZERO?WW.ZERO:(Tw.expectToBe(e,TZ.ONE),WW.ONE)}equals(e){return this===e}is(e){return this.value===e.value}isPlayer(){return this===WW.ZERO||this===WW.ONE}}WW.ZERO=new WW(TZ.ZERO.value),WW.ONE=new WW(TZ.ONE.value),WW.EMPTY=new WW(IZ.NONE.value),WW.UNREACHABLE=new WW(3);class jW extends VW{constructor(e,t){super(e,t)}static getAngle(e){switch(e){case jW.UP:return 0;case jW.UP_RIGHT:return 60;case jW.RIGHT:return 120;case jW.DOWN:return 180;case jW.DOWN_LEFT:return 240;default:return Tw.expectToBe(e,jW.LEFT),300}}getOpposite(){return jW.factory.of(-this.x,-this.y).get()}}jW.UP=new jW(0,-1),jW.LEFT=new jW(-1,0),jW.UP_RIGHT=new jW(1,-1),jW.DOWN_LEFT=new jW(-1,1),jW.RIGHT=new jW(1,0),jW.DOWN=new jW(0,1),jW.factory=new class extends BW{constructor(){super(...arguments),this.all=[jW.UP,jW.UP_RIGHT,jW.RIGHT,jW.DOWN,jW.DOWN_LEFT,jW.LEFT]}},jW.encoder=new class extends bZ{maxValue(){return 5}encodeNumber(e){switch(e){case jW.UP:return 0;case jW.UP_RIGHT:return 1;case jW.RIGHT:return 2;case jW.DOWN:return 3;case jW.DOWN_LEFT:return 4;default:return 5}}decodeNumber(e){return hZ(0<=e&&e<=5,"Invalid encoded number for HexaDirection "+e),jW.factory.all[e]}};class YW{constructor(e,t,n){this.size=e,this.origin=t,this.orientation=n}getCenterAt(e){const t=this.orientation.conversionMatrix;return new GW(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}getCornerOffset(e){const t=2*Math.PI*(this.orientation.startAngle+e)/6;return new GW(this.size*Math.cos(t),this.size*Math.sin(t))}getHexaCoordsAt(e){const t=this.getCenterAt(e),n=[];for(let r=0;r<6;r+=1){const e=this.getCornerOffset(r);n.push(new GW(t.x+e.x,t.y+e.y))}return n}}class KW{}class QW extends KW{constructor(){super(),this.startAngle=.5,this.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],this.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3]}}QW.INSTANCE=new QW;class XW extends KW{constructor(){super(),this.startAngle=0,this.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],this.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3]}isOnBorder(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}isOnTopRightBorder(e,t){return 0===t.y}isOnRightBorder(e,t){return t.x===e.width-1}isOnLeftBorder(e,t){return 0===t.x}isOnBottomLeftBorder(e,t){return t.y===e.height-1}isOnTopLeftBorder(e,t){return null!=e.excludedCases[t.y]?t.x===e.excludedCases[t.y]:t.y===e.excludedCases.length&&0===t.x}isOnBottomRightBorder(e,t){return null!=e.excludedCases[e.height-1-t.y]?e.width-1-t.x===e.excludedCases[e.height-1-t.y]:e.height-1-t.y===e.excludedCases.length&&t.x===e.width-1}getAllBorders(e){const t=[];return e.forEachCoord((n,r)=>{this.isOnBorder(e,n)&&t.push(n)}),t}isTopCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}isTopLeftCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isTopRightCorner(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}isBottomCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}isBottomLeftCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isBottomRightCorner(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}XW.INSTANCE=new XW;let JW=(()=>{class e{}return e.CANNOT_CHOOSE_OPPONENT_PIECE=()=>$localize`You cannot pick a piece of the opponent.`,e.MUST_CLICK_ON_EMPTY_SPACE=()=>$localize`You must click on an empty space.`,e.MUST_CLICK_ON_EMPTY_SQUARE=()=>$localize`You must click on an empty square.`,e.CANNOT_SELF_CAPTURE=()=>$localize`Your landing space should be empty or contain a piece of the opponent.`,e.MUST_CHOOSE_PLAYER_PIECE=()=>$localize`You must pick one of your pieces.`,e.CANNOT_PASS=()=>$localize`You cannot pass your turn.`,e.MUST_LAND_ON_EMPTY_SPACE=()=>$localize`You must drop your piece on an empty space.`,e.MUST_PASS=()=>$localize`You must pass your turn.`,e.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=()=>$localize`You have selected an empty space, you must select one of your own pieces.`,e.MOVE_CANNOT_BE_STATIC=()=>$localize`You must choose different starting and ending coordinates.`,e.SOMETHING_IN_THE_WAY=()=>$localize`There is a piece between the piece you chose and its landing space.`,e})();class ej{constructor(e,t){this.ruler=e,this.name=t}toString(){return this.name}}class tj{constructor(e){this.value=e}static fromWinner(e){return e.isPlayer()?new tj(e.getVictoryValue()):new tj(0)}toString(){return""+this.value}}class nj{static toComparableObjectSet(e){const t=[];return e.forEach(e=>{t.some(t=>t.equals(e))||t.push(e)}),t}static toComparableSet(e){const t=[];return e.forEach(e=>{t.some(t=>Mw(t,e))||t.push(e)}),t}}class rj{constructor(e){this.values=void 0===e?[]:nj.toComparableSet(e)}equals(e){if(e.size()!==this.size())return!1;for(const t of this)if(!1===e.contains(t))return!1;return!0}toString(){let e="";for(const t of this)e+=null==t?"null, ":t.toString()+", ";return"["+e.slice(0,-2)+"]"}add(e){return!this.contains(e)&&(this.values.push(e),!0)}union(e){for(const t of e)this.add(t)}contains(e){for(const t of this.values)if(Mw(t,e))return!0;return!1}size(){return this.values.length}toList(){const e=[];for(const t of this)e.push(t);return e}getAnyElement(){return this.size()>0?Nw.of(this.values[0]):Nw.empty()}[Symbol.iterator](){return this.values.values()}}class ij{constructor(e){this.turn=e}getCurrentPlayer(){return TZ.fromTurn(this.turn)}getCurrentOpponent(){return this.turn%2==1?TZ.ZERO:TZ.ONE}}class sj extends ij{constructor(e,t){super(t),this.board=e}getPieceAt(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}tryToGetPieceAt(e){return this.isOnBoard(e)?Nw.of(this.board[e.y][e.x]):Nw.empty()}isOnBoard(e){return e.isInRange(this.board[0].length,this.board.length)}getPieceAtXY(e,t){return this.getPieceAt(new GW(e,t))}forEachCoord(e){for(const[t,n]of this.getCoordsAndContents())e(t,n)}getCoordsAndContents(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[t].length;n++){const r=new GW(n,t);this.isOnBoard(r)&&e.push([r,this.getPieceAt(r)])}return e}getCopiedBoard(){return NZ.copyBiArray(this.board)}}class oj extends sj{static getInitialState(){const e=WW.EMPTY,t=WW.UNREACHABLE,n=WW.ZERO,r=WW.ONE;return new oj([[t,t,t,t,r,r,r,r,r],[t,t,t,r,r,r,r,r,r],[t,t,e,e,r,r,r,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,n,n,n,e,e,t,t],[n,n,n,n,n,n,t,t,t],[n,n,n,n,n,t,t,t,t]],0)}isInBoard(e){return e.isInRange(9,9)&&this.getPieceAt(e)!==WW.UNREACHABLE}isPiece(e){return this.getPieceAt(e).isPlayer()}getScores(){const e=[14,14];for(let t=0;t<9;t++)for(let n=0;n<9;n++)this.getPieceAtXY(n,t)===WW.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===WW.ONE&&(e[0]=e[0]-1);return e}}class aj{}class lj extends aj{constructor(e,t){super(),this.coord=new GW(e,t)}}class cj extends lj{constructor(e,t,n){if(super(e.x,e.y),this.dir=t,this.lastPiece=n,e.isNotInRange(9,9))throw new Error("Coord "+e.toString()+" out of range, invalid move!")}static fromSingleCoord(e,t){try{return Rw.success(new cj(e,t,Nw.empty()))}catch(n){return Rw.failure(n.message)}}static fromDoubleCoord(e,t,n){const r=[e,t];NZ.sortByDescending(r,cj.sortCoord);const i=r[1].getDirectionToward(r[0]).get(),s=jW.factory.fromDelta(i.x,i.y);if(s.isFailure())return Rw.failure("Invalid direction");const o=s.get();return r[1].getDistance(r[0])>2?Rw.failure("Distance between first coord and last coord is too great"):o.equals(n)?cj.fromSingleCoord(r[1],n):o.getOpposite().equals(n)?cj.fromSingleCoord(r[0],n):Rw.success(new cj(r[1],n,Nw.of(r[0])))}static sortCoord(e){return 9*e.y+e.x}toString(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}isSingleCoord(){return this.lastPiece.isAbsent()}equals(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}cj.encoder=new class extends bZ{maxValue(){return 104831}encodeNumber(e){const t=9*e.coord.x*8+8*e.coord.y+e.dir.toInt();if(e.isSingleCoord())return t;{const n=e.lastPiece.get();return 9*n.x*2*9*9*8+2*n.y*9*9*8+648+t}}decodeNumber(e){const t=e%8;e=(e-t)/8;const n=jW.factory.fromInt(t).get(),r=e%9,i=(e=(e-r)/9)%9;e=(e-i)/9;const s=new GW(i,r);if(0===e)return cj.fromSingleCoord(s,n).get();{const t=(e=(e-1)/2)%9,r=(e=(e-t)/9)%9;e=(e-r)/9;const i=new GW(r,t);return cj.fromDoubleCoord(s,i,n).get()}}};var uj=(()=>(function(e){e.VICTORY="VICTORY",e.PRE_VICTORY="PRE_VICTORY",e.DEFAULT="DEFAULT"}(uj||(uj={})),uj))();class hj{constructor(e=[],t=!1){this.map=e,this.isImmutable=t}static from(e){const t=Object.keys(e),n=new hj;for(const r of t)n.set(r,e[r]);return n}makeImmutable(){this.isImmutable=!0}get(e){for(const t of this.map)if(Mw(t.key,e))return Nw.of(t.value);return Nw.empty()}forEach(e){for(let t=0;t<this.map.length;t++)e(this.getByIndex(t))}getByIndex(e){return this.map[e]}putAll(e){this.checkImmutability("putAll");for(const t of e.map)this.put(t.key,t.value)}checkImmutability(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}put(e,t){this.checkImmutability("put");for(const n of this.map)if(Mw(n.key,e)){const e=n.value;return n.value=t,Nw.of(e)}return this.map.push({key:e,value:t}),Nw.empty()}containsKey(e){return this.map.some(t=>Mw(t.key,e))}size(){return this.map.length}listKeys(){return this.map.map(e=>e.key)}getKeySet(){return new rj(this.listKeys())}filter(e){const t=new hj;for(const n of this.map)e(n.key,n.value)&&t.set(n.key,n.value);return t}replace(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}set(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}delete(e){this.checkImmutability("delete");for(let t=0;t<this.map.length;t++)if(Mw(this.map[t].key,e)){const e=this.map[t].value,n=this.map.slice(0,t),r=this.map.slice(t+1);return this.map=n.concat(r),e}throw new Error('No Value to delete for key "'+e.toString()+'"!')}getCopy(){const e=new this.constructor;for(const t of this.listKeys())e.set(t,this.get(t).get());return e}equals(e){const t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;for(const r of t){const t=this.get(r).get(),n=e.get(r);if(hZ(n.isPresent(),"value is absent in a map even though its key is present!"),!1===Mw(t,n.get()))return!1}return!0}}class dj extends hj{reverse(){const e=new dj;for(const t of this.listKeys()){const n=this.get(t).get();if(e.containsKey(n))e.get(n).get().add(t);else{const r=new rj;r.add(t),e.set(n,r)}}return e}}let fj=(()=>{class e{}return e.createdNodes=0,e.minimaxTime=0,e})();class pj{constructor(e,t=Nw.empty(),n=Nw.empty(),r){if(this.gameState=e,this.mother=t,this.move=n,this.minimaxCreator=r,this.childs=Nw.empty(),this.hopedValue=new hj,this.ownValue=new hj,this.possibleMoves=new hj,this.ownValue=new hj,null!=r){const e=r.getBoardValue(this);this.ownValue.set(r.name,e),this.hopedValue.set(r.name,e.value)}fj.createdNodes++,Iw(pj.VERBOSE||!1,"creating "+this.myToString())}static getScoreStatus(e){const t=!1;return e===Number.MAX_SAFE_INTEGER||e===Number.MIN_SAFE_INTEGER?(Iw(pj.VERBOSE||t,"VICTORY"),uj.VICTORY):e===Number.MIN_SAFE_INTEGER+1?(Iw(pj.VERBOSE||t,"PRE_VICTORY_MIN"),uj.PRE_VICTORY):e===Number.MAX_SAFE_INTEGER-1?(Iw(pj.VERBOSE||t,"PRE_VICTORY_MAX"),uj.PRE_VICTORY):(Iw(pj.VERBOSE||t,"DEFAULT"),uj.DEFAULT)}findBestMove(e,t,n=!1,r=!0){const i=(new Date).getTime();let s=this.alphaBeta(e,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,t,n,r);for(;s.gameState.turn>this.gameState.turn+1;)s=s.mother.get(),e--;return fj.minimaxTime+=(new Date).getTime()-i,s.move.get()}alphaBeta(e,t,n,r,i,s){if(e<1)return Iw(pj.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+e),this;if(r.ruler.getGameStatus(this).isEndGame)return Iw(pj.VERBOSE||!1,"isLeaf-EndGame("+pj.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+e),this;const o=this.getPossibleMoves(r);hZ(o.size()>0,"Minimax "+r.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=Nw.of([]));const a=this.getBestChilds(o,e,t,n,r,i,s),l=this.getBestChildAmongst(a,i),c=l.hopedValue.get(r.toString()).get();return this.hopedValue.put(r.toString(),c),l}getPossibleMoves(e){const t=this.possibleMoves.get(e.name);if(t.isAbsent()){const t=e.getListMoves(this);return this.possibleMoves.set(e.name,new rj(t)),new rj(t)}return t.get()}getBestChilds(e,t,n,r,i,s,o){let a=[];const l=this.gameState.getCurrentPlayer();let c=l===TZ.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER;const u=l===TZ.ZERO?(e,t)=>e<t:(e,t)=>e>t;for(const h of e){const e=this.getOrCreateChild(h,i).alphaBeta(t-1,n,r,i,s,o),d=e.getHopedValue(i);if(u(d,c)||0===a.length?(c=d,a=[e]):d===c&&a.push(e),o&&u(c,l===TZ.ZERO?n:r))break;l===TZ.ZERO?r=Math.min(c,r):n=Math.max(c,n)}return a}getBestChildAmongst(e,t){return t?e[Math.floor(Math.random()*e.length)]:e[0]}getOrCreateChild(e,t){let n=this.getSonByMove(e);if(n.isAbsent()){const r=t.ruler.isLegal(e,this.gameState),i=e.toString();hZ(r.isSuccess(),'The minimax "'+t.name+'" has proposed an illegal move ('+i+"), this should not happen.");const s=t.ruler.applyLegalMove(e,this.gameState,r.get());n=Nw.of(new pj(s,Nw.of(this),Nw.of(e),t)),this.childs.get().push(n.get())}return n.get()}getSonByMove(e){hZ(this.childs.isPresent(),"Cannot get son of uncalculated node");for(const t of this.childs.get())if(t.move.isPresent()&&t.move.equalsValue(e))return Nw.of(t);return Nw.empty()}getInitialNode(){let e=this;for(;e.mother.isPresent();)e=e.mother.get();return e}getHopedValue(e){return this.hopedValue.get(e.name).get()}getOwnValue(e){const t=this.ownValue.get(e.name);if(t.isAbsent()){const t=e.getBoardValue(this);return this.ownValue.set(e.name,t),t}return t.get()}myToString(){let e="",t=this;if(t.mother.isAbsent())return"NodeInitial: "+t.gameState.turn;for(;t.mother.isPresent();)e=(t.move.isAbsent()?" ":" > "+t.move.get().toString()+"> ")+t.gameState.turn+" "+e,t=t.mother.get();return"Node: "+e}hasMoves(){return this.childs.isPresent()}countDescendants(){if(this.childs.isAbsent())return 0;let e=this.childs.get().length;for(const t of this.childs.get())e+=t.countDescendants();return e}}pj.VERBOSE=!1,pj.minimaxes=new hj;class gj{constructor(e,t){this.isEndGame=e,this.winner=t}static getVictory(e){return e===TZ.ZERO?gj.ZERO_WON:gj.ONE_WON}static getDefeat(e){return e===TZ.ZERO?gj.ONE_WON:gj.ZERO_WON}toBoardValue(){return this.winner.isPlayer()?this.winner.getVictoryValue():0}}gj.ZERO_WON=new gj(!0,TZ.ZERO),gj.ONE_WON=new gj(!0,TZ.ONE),gj.DRAW=new gj(!0,IZ.NONE),gj.ONGOING=new gj(!1,IZ.NONE);class mj{constructor(e){this.stateType=e,this.setInitialBoard()}choose(e){const t=!1;Iw(t,"Rules.choose: "+e.toString()+" was proposed");const n=this.isLegal(e,this.node.gameState);if(this.node.hasMoves()){Iw(t,"Rules.choose: current node has moves");const r=this.node.getSonByMove(e);if(r.isPresent())return hZ(n.isSuccess(),"Rules.choose: Move is illegal: "+n.getReasonOr("")),Iw(t,"Rules.choose: and this proposed move is found in the list, so it is legal"),this.node=r.get(),!0}if(Iw(t,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),n.isFailure())return Iw(t,"Rules.choose: Move is illegal: "+n.getReason()),!1;Iw(t,"Rules.choose: Move is legal, let's apply it");const r=this.applyLegalMove(e,this.node.gameState,n.get()),i=new pj(r,Nw.of(this.node),Nw.of(e));return this.node=i,!0}setInitialBoard(){if(null==this.node){const e=this.stateType.getInitialState();pj.ruler=this,this.node=new pj(e)}else this.node=this.node.getInitialNode()}applyMoves(e,t,n){let r=0;for(const i of e){const e=n(i),s=this.isLegal(e,t);hZ(s.isSuccess(),"Can't create state from invalid moves ("+r+"): "+s.toString()+"."),t=this.applyLegalMove(e,t,s.get()),r++}return t}}let yj=(()=>{class e{}return e.CANNOT_MOVE_MORE_THAN_THREE_PIECES=()=>$localize`You cannot move more than 3 of your pieces!`,e.NOT_ENOUGH_PIECE_TO_PUSH=()=>$localize`You don't have enough pieces to push that group!`,e.CANNOT_PUSH_YOUR_OWN_PIECES=()=>$localize`You cannot push this piece because it is blocked by one of yours!`,e.MUST_ONLY_TRANSLATE_YOUR_PIECES=()=>$localize`This line contains pieces of your opponent or empty spaces, which is forbidden.`,e.TRANSLATION_IMPOSSIBLE=()=>$localize`This move is impossible, some landing spaces are occupied.`,e.LINE_AND_COORD_NOT_ALIGNED=()=>$localize`This space is not aligned with the current line.`,e})();class vj extends mj{static isLegal(e,t){const n=this.getFirstPieceValidity(e,t);return n.isFailure()?n.toFailedFallible():e.isSingleCoord()?vj.isLegalPush(e,t):vj.isLegalSideStep(e,t)}static getFirstPieceValidity(e,t){const n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?Lw.failure(JW.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===WW.ofPlayer(t.getCurrentOpponent())?Lw.failure(JW.CANNOT_CHOOSE_OPPONENT_PIECE()):Lw.SUCCESS}static isLegalPush(e,t){let n=1,r=e.coord.getNext(e.dir);const i=WW.ofPlayer(t.getCurrentPlayer()),s=WW.EMPTY,o=t.getCopiedBoard();for(o[e.coord.y][e.coord.x]=s;n<=3&&t.isOnBoard(r)&&t.getPieceAt(r)===i;)n++,r=r.getNext(e.dir);return n>3?Rw.failure(yj.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===t.isInBoard(r)||(o[r.y][r.x]=i,t.getPieceAt(r)===s)?Rw.success(o):vj.isLegalRealPush(r,e,t,n,o)}static isLegalRealPush(e,t,n,r,i){let s=0;const o=WW.ofPlayer(n.getCurrentOpponent()),a=WW.ofPlayer(n.getCurrentPlayer());for(;s<r&&n.isOnBoard(e)&&n.getPieceAt(e)===o;)s++,e=e.getNext(t.dir);return s>=r?Rw.failure(yj.NOT_ENOUGH_PIECE_TO_PUSH()):e.isInRange(9,9)&&(n.getPieceAt(e)===WW.EMPTY&&(i[e.y][e.x]=o),n.getPieceAt(e)===a)?Rw.failure(yj.CANNOT_PUSH_YOUR_OWN_PIECES()):Rw.success(i)}static isLegalSideStep(e,t){let n=e.lastPiece.get();const r=e.coord.getDirectionToward(n).get();n=n.getNext(r);let i=e.coord;const s=WW.ofPlayer(t.getCurrentPlayer()),o=t.getCopiedBoard();for(;!1===i.equals(n)&&i.isInRange(9,9);){if(t.getPieceAt(i)!==s)return Rw.failure(yj.MUST_ONLY_TRANSLATE_YOUR_PIECES());const n=i.getNext(e.dir);if(o[i.y][i.x]=WW.EMPTY,n.isInRange(9,9)){if(t.isPiece(n))return Rw.failure(yj.TRANSLATION_IMPOSSIBLE());t.getPieceAt(n)===WW.EMPTY&&(o[n.y][n.x]=s)}i=i.getNext(r)}return Rw.success(o)}static getGameStatus(e){const t=e.gameState.getScores();return t[0]>5?gj.ZERO_WON:t[1]>5?gj.ONE_WON:gj.ONGOING}applyLegalMove(e,t,n){return new oj(n,t.turn+1)}isLegal(e,t){return vj.isLegal(e,t)}getGameStatus(e){return vj.getGameStatus(e)}}class Cj extends ej{getListMoves(e){const t=[],n=e.gameState,r=n.getCurrentPlayer();for(let i=0;i<9;i++)for(let e=0;e<9;e++){const s=new GW(e,i);if(!1!==n.getPieceAt(s).is(r))for(const e of jW.factory.all){const r=cj.fromSingleCoord(s,e).get();if(this.isAcceptablePush(r,n)){t.push(r);for(const r of jW.factory.all)for(let i=1;i<=2&&!r.equals(e);i++){const o=s.getNext(r,i);if(!o.isInRange(9,9))break;{const r=cj.fromDoubleCoord(s,o,e).get();vj.isLegal(r,n).isSuccess()&&t.push(r)}}}}}return new rj(t).toList()}isAcceptablePush(e,t){const n=t.getScores(),r=vj.isLegal(e,t);if(r.isSuccess()){const e=t.getCurrentOpponent().value;return!(new oj(r.get(),t.turn+1).getScores()[e]>n[e])}return!1}getBoardValue(e){const t=vj.getGameStatus(e);if(t.isEndGame)return new tj(t.toBoardValue());const n=e.gameState.getScores();return new tj(n[1]-n[0])}}class _j{constructor(e,t,n){this.title=e,this.instruction=t,this.state=n,this.previousMove=Nw.empty()}static fromMove(e,t,n,r,i,s){return new wj(e,t,n,r,i,s)}static forClick(e,t,n,r,i,s){return new Sj(e,t,n,r,i,s)}static anyMove(e,t,n,r,i){return new Pj(e,t,n,r,i)}static fromPredicate(e,t,n,r,i,s){return new bj(e,t,n,r,i,s)}static informational(e,t,n){return new Oj(e,t,n)}isMove(){return!1}isAnyMove(){return!1}isClick(){return!1}isPredicate(){return!1}isInformation(){return!1}hasSolution(){return!1}withPreviousMove(e){return this.previousMove=Nw.of(e),this}}class Ej extends _j{constructor(e,t,n,r){super(e,t,n),this.successMessage=r}hasSolution(){return!0}getSuccessMessage(){return this.successMessage}}class wj extends Ej{constructor(e,t,n,r,i,s){super(e,t,n,i),this.acceptedMoves=r,this.failureMessage=s,hZ(r.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational")}isMove(){return!0}getSolution(){return this.acceptedMoves[0]}getFailureMessage(){return this.failureMessage}}class Pj extends Ej{constructor(e,t,n,r,i){super(e,t,n,i),this.solutionMove=r}getSolution(){return this.solutionMove}isAnyMove(){return!0}}class Sj extends Ej{constructor(e,t,n,r,i,s){super(e,t,n,i),this.acceptedClicks=r,this.failureMessage=s}isClick(){return!0}getSolution(){return this.acceptedClicks[0]}getFailureMessage(){return this.failureMessage}}class bj extends Ej{constructor(e,t,n,r,i,s){super(e,t,n,s),this.solutionMove=r,this.predicate=i}getSolution(){return this.solutionMove}isPredicate(){return!0}}class Oj extends _j{isInformation(){return!0}}const Tj=WW.EMPTY,Ij=WW.UNREACHABLE,kj=WW.ZERO,Aj=WW.ONE;class Mj{constructor(){this.tutorial=[_j.informational($localize`Initial board and goal of the game`,$localize`At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!`,oj.getInitialState()),_j.anyMove($localize`Moving a piece`,$localize`At each turn, move one, two, or three pieces either along their line, or on their side.
        For your moves you can therefore choose between up to 6 directions.
        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).
        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>
        You're playing Dark, make any move!`,oj.getInitialState(),cj.fromSingleCoord(new GW(2,6),jW.UP).get(),$localize`Congratulations!`),_j.fromMove($localize`Pushing`,$localize`To push one opponent piece, you must move at least two of your pieces.
        To push two opponent pieces, you must move three of your pieces.
        If one of your pieces is in the way, it will be impossible to push.
        You cannot move more than three pieces.<br/><br/>
        Only one push towards the right is possible here, find it. (You're playing Dark).`,new oj([[Ij,Ij,Ij,Ij,Tj,kj,kj,Aj,Aj],[Ij,Ij,Ij,Tj,Tj,Tj,Tj,Tj,Tj],[Ij,Ij,Tj,kj,kj,kj,Aj,kj,Tj],[Ij,Tj,Tj,Tj,Tj,Tj,Tj,Tj,Tj],[Tj,Tj,Tj,Tj,kj,kj,kj,Aj,Aj],[Tj,Tj,Tj,Tj,Tj,Tj,Tj,Tj,Ij],[Tj,Tj,Tj,Tj,kj,Aj,Tj,Ij,Ij],[Tj,Tj,Tj,kj,Tj,Tj,Ij,Ij,Ij],[Tj,Tj,kj,Tj,Tj,Ij,Ij,Ij,Ij]],0),[cj.fromSingleCoord(new GW(4,4),jW.RIGHT).get()],$localize`Congratulations! You know everything you need to start a game!`,$localize`Failed!`)]}}function Nj(e,t){if(1&e){const e=va();_n(),fa(0,"circle",6),Ea("click",function(){Gt(e);const t=Sa(2).index,n=Sa().index;return Sa().onPieceClick(t,n)}),pa()}if(2&e){const e=Sa(2).index,t=Sa().index,n=Sa();Ia("id","piece_",e,"_",t,""),ha("ngClass",n.getPieceClasses(e,t)),ra("cx",n.getCenterBy(e,t).x)("cy",n.getCenterBy(e,t).y)("r",.5*n.SPACE_SIZE)}}function Rj(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"polyline",4),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().onCaseClick(t,n)}),pa(),la(2,Nj,1,6,"circle",5),pa()}if(2&e){const e=Sa(),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();Ts(1),Ia("id","case_",t,"_",r,""),ha("ngClass",i.getSquareClasses(t,r)),ra("points",i.getHexaCoordsBy(t,r)),Ts(1),ha("ngIf",i.isPiece(n))}}function xj(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,Rj,3,5,"g",3),pa()),2&e){const e=t.$implicit,n=Sa(2);Ts(1),ha("ngIf",n.isBoard(e))}}function Dj(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,xj,2,1,"g",1),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}function Lj(e,t){1&e&&(_n(),fa(0,"marker",7),ga(1,"polygon",8),pa()),2&e&&Ta("id","arrowhead_",t.$implicit.dir.toString(),"")}function Fj(e,t){if(1&e){const e=va();_n(),fa(0,"g"),ga(1,"line",9),fa(2,"line",10),Ea("click",function(){const t=Gt(e).$implicit;return Sa().chooseDirection(t.dir)}),pa(),fa(3,"polygon",11),Ea("click",function(){const t=Gt(e).$implicit;return Sa().chooseDirection(t.dir)}),pa(),pa()}if(2&e){const e=t.$implicit;Ts(1),Ta("id","line_start_",e.dir.toString(),""),ra("x1",e.startCenter.x)("y1",e.startCenter.y)("x2",e.middle.x)("y2",e.middle.y),Ts(1),Ta("id","line_end_",e.dir.toString(),""),ra("x1",e.middle.x)("y1",e.middle.y)("x2",e.landingCenter.x)("y2",e.landingCenter.y),Ts(1),Ta("id","direction_",e.dir.toString(),""),ra("transform",e.transformation)}}class Uj{constructor(e,t,n,r,i,s){this.startCenter=e,this.middle=t,this.landingCenter=n,this.landing=r,this.dir=i,this.transformation=s}}let Vj=(()=>{class e extends qW{constructor(e){super(e),this.moveds=[],this.directions=[],this.selecteds=[],this.rules=new vj(oj),this.availableMinimaxes=[new Cj(this.rules,"Dummy")],this.encoder=cj.encoder,this.tutorial=(new Mj).tutorial,this.scores=Nw.of([0,0]),this.SPACE_SIZE=30,this.hexaLayout=new YW(this.SPACE_SIZE,new GW(-8*this.SPACE_SIZE,2*this.SPACE_SIZE),QW.INSTANCE),this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.hexaBoard=this.rules.node.gameState.getCopiedBoard(),this.scores=Nw.of(this.rules.node.gameState.getScores())}hidePreviousMove(){this.moveds=[]}cancelMoveAttempt(){this.directions=[],this.selecteds=[]}showPreviousMove(){const e=this.rules.node.move.get();e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}showPushingMove(e){const t=this.rules.node.mother.get().gameState;let n=e.coord;for(this.moveds=[n],n=n.getNext(e.dir);n.isInRange(9,9)&&t.isPiece(n);)this.moveds.push(n),n=n.getNext(e.dir);n.isInRange(9,9)&&this.moveds.push(n)}showSideStepMove(e){let t=e.lastPiece.get();const n=e.coord.getDirectionToward(t).get();t=t.getNext(n);let r=e.coord;for(;!1===r.equals(t);)this.moveds.push(r),this.moveds.push(r.getNext(e.dir)),r=r.getNext(n)}onPieceClick(e,t){var n=this;return Ow(function*(){const r=n.canUserPlay("#piece_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=n.rules.node.gameState.getCurrentOpponent();return n.hexaBoard[t][e].is(i)?n.opponentClick(e,t):0===n.selecteds.length?n.firstClick(e,t):1===n.selecteds.length?n.secondClick(e,t):n.thirdClick(e,t)})()}opponentClick(e,t){var n=this;return Ow(function*(){return(yield n.tryChoosingDirection(e,t)).isSuccess()?Lw.SUCCESS:n.cancelMove(JW.CANNOT_CHOOSE_OPPONENT_PIECE())})()}firstClick(e,t){var n=this;return Ow(function*(){return n.selecteds=[new GW(e,t)],n.showPossibleDirections(),Lw.SUCCESS})()}showPossibleDirections(){this.directions=[],this.showDirection(1===this.selecteds.length)}showDirection(e){const t=this.rules.node.gameState,n=WW.ofPlayer(t.getCurrentPlayer()),r=this.selecteds[0],i=this.selecteds[this.selecteds.length-1];for(const s of jW.factory.all){let o,a=r.getNext(s,1);if(t.isOnBoard(a)&&t.getPieceAt(a)===n){if(e)continue;if(a=i.getNext(s,1),t.isOnBoard(a)&&t.getPieceAt(a)===n)continue}if(o=e?cj.fromSingleCoord(r,s).get():cj.fromDoubleCoord(r,i,s).get(),this.rules.isLegal(o,t).isSuccess()){const e=this.getCenterAt(r),t=this.getCenterAt(a),n=this.getMiddleOfArrow(s,a,t),i=t.x+" "+t.y,o=jW.getAngle(s)+150,l=new Uj(e,n,t,a,s,"rotate("+o+" "+i+") translate("+i+")");this.directions.push(l)}}}getMiddleOfArrow(e,t,n){const r=t.getPrevious(e),i=this.getCenterAt(r);return new GW(i.x+(n.x-i.x)/2,i.y+(n.y-i.y)/2)}isBoard(e){return e!==WW.UNREACHABLE}isPiece(e){return e!==WW.EMPTY}secondClick(e,t){var n=this;return Ow(function*(){const r=n.selecteds[0],i=new GW(e,t);if(i.equals(r))return n.cancelMoveAttempt(),Lw.SUCCESS;if(!1===i.isHexagonallyAlignedWith(r))return n.cancelMoveAttempt(),n.firstClick(e,t);const s=i.getDistance(r);if(s>2)return n.cancelMove(yj.CANNOT_MOVE_MORE_THAN_THREE_PIECES());const o=r.getDirectionToward(i).get();n.selecteds=[r];for(let e=0;e<s;e++)n.selecteds.push(r.getNext(o,e+1));if(3===n.selecteds.length){const r=n.selecteds[1],i=n.rules.node.gameState.getCurrentPlayer();if(!1===n.hexaBoard[r.y][r.x].is(i))return n.cancelMoveAttempt(),n.firstClick(e,t)}return n.showPossibleDirections(),Lw.SUCCESS})()}thirdClick(e,t){var n=this;return Ow(function*(){const r=new GW(e,t),i=n.selecteds[0];if(r.equals(i))return n.deselectExtremity(!0);const s=n.selecteds[n.selecteds.length-1];return r.equals(s)?n.deselectExtremity(!1):3===n.selecteds.length&&r.equals(n.selecteds[1])?(n.cancelMoveAttempt(),Lw.SUCCESS):n.tryExtension(r,i,s)})()}tryExtension(e,t,n){var r=this;return Ow(function*(){const i=$W.factory.fromMove(t,e);if(i.isSuccess()){const s=$W.factory.fromMove(n,e);if(i.equals(s)){const i=t.getDistance(e),s=n.getDistance(e);return 2===Math.max(i,s)?(r.selecteds.push(e),NZ.sortByDescending(r.selecteds,cj.sortCoord),r.showPossibleDirections(),Lw.SUCCESS):r.cancelMove(yj.CANNOT_MOVE_MORE_THAN_THREE_PIECES())}}const s=r.cancelMove(yj.LINE_AND_COORD_NOT_ALIGNED());return yield r.firstClick(e.x,e.y),s})()}deselectExtremity(e){var t=this;return Ow(function*(){return t.selecteds=t.selecteds.slice(e?1:0,e?void 0:-1),t.showPossibleDirections(),Lw.SUCCESS})()}chooseDirection(e){var t=this;return Ow(function*(){const n=t.canUserPlay("#direction_"+e.toString());return n.isFailure()?t.cancelMove(n.getReason()):t._chooseDirection(e)})()}_chooseDirection(e){var t=this;return Ow(function*(){const n=t.rules.node.gameState;let r;const i=t.selecteds[0];return r=1===t.selecteds.length?cj.fromSingleCoord(i,e).get():cj.fromDoubleCoord(i,t.selecteds[t.selecteds.length-1],e).get(),t.chooseMove(r,n,t.scores.get())})()}onCaseClick(e,t){var n=this;return Ow(function*(){const r=n.canUserPlay("#case_"+e+"_"+t);return r.isFailure()?n.cancelMove(r.getReason()):n.tryChoosingDirection(e,t)})()}tryChoosingDirection(e,t){var n=this;return Ow(function*(){const r=new GW(e,t);for(const e of n.directions)if(e.landing.equals(r))return n._chooseDirection(e.dir);return Lw.failure("not a direction")})()}getSquareClasses(e,t){const n=new GW(e,t),r=[];return this.moveds.some(e=>e.equals(n))&&r.push("moved"),r}getPieceClasses(e,t){const n=new GW(e,t),r=TZ.of(this.hexaBoard[t][e].value),i=[this.getPlayerClass(r)];return this.selecteds.some(e=>e.equals(n))&&i.push("highlighted"),i}}return e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-abalone"]],features:[Go],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,Dj,2,1,"g",1),fa(2,"defs"),la(3,Lj,2,1,"marker",2),pa(),la(4,Fj,4,12,"g",1),pa()),2&e&&(Ts(1),ha("ngForOf",t.hexaBoard),Ts(2),ha("ngForOf",t.directions),Ts(1),ha("ngForOf",t.directions))},directives:[tf,rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class Bj{constructor(e){this.x=e}static from(e){switch(e){case 0:return Bj.ZERO;case 1:return Bj.ONE;case 2:return Bj.TWO;default:return hZ(3===e,"Invalid Apagos Coord "+e),Bj.THREE}}equals(e){return this.x===e.x}}Bj.ZERO=new Bj(0),Bj.ONE=new Bj(1),Bj.TWO=new Bj(2),Bj.THREE=new Bj(3);let $j=(()=>{class e{}return e.PIECE_SHOULD_MOVE_DOWNWARD=()=>$localize`Pieces should only move downward!`,e.CANNOT_LAND_ON_A_FULL_SQUARE=()=>$localize`That square is already full, you cannot put a piece in it!`,e.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=()=>$localize`You have no pieces in that square, select one that contains at least one of your pieces!`,e.NO_PIECE_REMAINING_TO_DROP=()=>$localize`There are no remaining pieces of that color to drop!`,e.NO_POSSIBLE_TRANSFER_REMAINS=()=>$localize`There is no possible transfer from that square!`,e})();class zj extends aj{constructor(e,t,n){super(),this.landing=e,this.piece=t,this.starting=n}static drop(e,t){return Tw.getNonNullable(zj.ALL_MOVES.find(n=>n.landing.equals(e)&&n.piece.equalsValue(t)&&n.starting.equals(Nw.empty())))}static transfer(e,t){if(e.x<=t.x)return Rw.failure($j.PIECE_SHOULD_MOVE_DOWNWARD());const n=Tw.getNonNullable(zj.ALL_MOVES.find(n=>n.landing.equals(t)&&n.piece.equals(Nw.empty())&&n.starting.equals(Nw.of(e))));return Rw.success(n)}isDrop(){return this.piece.isPresent()}toString(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}equals(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}zj.ALL_MOVES=[new zj(Bj.ZERO,Nw.of(TZ.ZERO),Nw.empty()),new zj(Bj.ONE,Nw.of(TZ.ZERO),Nw.empty()),new zj(Bj.TWO,Nw.of(TZ.ZERO),Nw.empty()),new zj(Bj.THREE,Nw.of(TZ.ZERO),Nw.empty()),new zj(Bj.ZERO,Nw.of(TZ.ONE),Nw.empty()),new zj(Bj.ONE,Nw.of(TZ.ONE),Nw.empty()),new zj(Bj.TWO,Nw.of(TZ.ONE),Nw.empty()),new zj(Bj.THREE,Nw.of(TZ.ONE),Nw.empty()),new zj(Bj.TWO,Nw.empty(),Nw.of(Bj.THREE)),new zj(Bj.ONE,Nw.empty(),Nw.of(Bj.THREE)),new zj(Bj.ZERO,Nw.empty(),Nw.of(Bj.THREE)),new zj(Bj.ONE,Nw.empty(),Nw.of(Bj.TWO)),new zj(Bj.ZERO,Nw.empty(),Nw.of(Bj.TWO)),new zj(Bj.ZERO,Nw.empty(),Nw.of(Bj.ONE))],zj.encoder=new class extends bZ{maxValue(){return zj.ALL_MOVES.length}encodeNumber(e){const t=zj.ALL_MOVES.findIndex(t=>t.equals(e));return hZ(t>=0,e.toString()+" is not part of possibles moves of Apagos!"),t}decodeNumber(e){return hZ(e<zj.ALL_MOVES.length,e+" is not a valid encoded number for ApagosMove decoder"),zj.ALL_MOVES[e]}};class Hj{constructor(e){this.containing=e}static from(e,t,n){if(e+t>n)return Rw.failure("invalid starting space");const r=new hj([{key:TZ.ZERO,value:e},{key:TZ.ONE,value:t},{key:IZ.NONE,value:n}]);r.makeImmutable();const i=new Hj(r);return Rw.success(i)}isFull(){return this.count(TZ.ZERO)+this.count(TZ.ONE)>=this.count(IZ.NONE)}count(e){return this.containing.get(e).get()}addPiece(e){let t=this.count(TZ.ZERO),n=this.count(TZ.ONE);const r=this.count(IZ.NONE);return e===TZ.ZERO?t++:n++,Hj.from(t,n,r).get()}substractPiece(e){let t=this.count(TZ.ZERO),n=this.count(TZ.ONE);const r=this.count(IZ.NONE);return e===TZ.ZERO?t--:n--,Hj.from(t,n,r).get()}getDominatingPlayer(){const e=this.count(TZ.ZERO),t=this.count(TZ.ONE);return e>t?TZ.ZERO:t>e?TZ.ONE:IZ.NONE}equals(e){return this.containing.equals(e.containing)}}let Gj=(()=>{class e extends ij{constructor(e,t,n){super(e),this.board=t,this.remaining=n,this.remaining.makeImmutable()}static getInitialState(){return e.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}static fromRepresentation(t,n,r,i){const s=[];for(let e=0;e<4;e++){const t=Hj.from(n[0][e],n[1][e],n[2][e]).get();s.push(t)}const o=new hj;return o.set(TZ.ZERO,r),o.set(TZ.ONE,i),new e(t,s,o)}getPieceAt(e){return this.board[e.x]}updateAt(t,n){const r=[];for(let e=0;e<4;e++)r.push(t.x===e?n:this.board[e]);const i=this.getRemainingCopy();return new e(this.turn,r,i)}getRemainingCopy(){return this.remaining.getCopy()}getRemaining(e){return this.remaining.get(e).get()}equals(e){return this.turn===e.turn&&NZ.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}return e.PIECES_PER_PLAYER=10,e})();class Zj extends mj{static get(){return Zj.singleton.isAbsent()&&(Zj.singleton=Nw.of(new Zj(Gj))),this.singleton.get()}applyLegalMove(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}applyLegalDrop(e,t){const n=t.getRemainingCopy(),r=n.get(e.piece.get()).get();n.put(e.piece.get(),r-1);const i=new Gj(t.turn+1,t.board,n),s=e.piece.get(),o=i.getPieceAt(e.landing).addPiece(s);if(e.landing===Bj.THREE)return i.updateAt(e.landing,o);{const t=Bj.from(e.landing.x+1),n=i.getPieceAt(t);return i.updateAt(e.landing,n).updateAt(t,o)}}applyLegalTransfer(e,t){const n=t.getCurrentPlayer(),r=e.starting.get(),i=t.getPieceAt(r).substractPiece(n),s=t.getPieceAt(e.landing).addPiece(n);let o=t.updateAt(r,i);return o=o.updateAt(e.landing,s),new Gj(o.turn+1,o.board,o.remaining)}isLegal(e,t){return t.getPieceAt(e.landing).isFull()?Rw.failure($j.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}isLegalDrop(e,t){return t.getRemaining(e.piece.get())<=0?Rw.failure($j.NO_PIECE_REMAINING_TO_DROP()):Rw.success(void 0)}isLegalSlideDown(e,t){const n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?Rw.failure($j.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):Rw.success(void 0)}getGameStatus(e){const t=e.gameState;for(let r=0;r<4;r++)if(!1===t.getPieceAt(Bj.from(r)).isFull())return gj.ONGOING;const n=t.getPieceAt(Bj.THREE).getDominatingPlayer();return hZ(n.isPlayer(),"winner can only be a player if the game is finished"),gj.getVictory(n)}}Zj.singleton=Nw.empty();class qj extends ej{getListMoves(e){const t=e.gameState;return zj.ALL_MOVES.filter(function(e){return Zj.get().isLegal(e,t).isSuccess()})}getBoardValue(e){const t=Zj.get().getGameStatus(e);if(t.isEndGame)return tj.fromWinner(t.winner);const n=e.gameState.board[3].getDominatingPlayer();return n.isPlayer()?new tj(n.getScoreModifier()):new tj(0)}}class Wj{constructor(){this.tutorial=[_j.informational($localize`Initial board and goal of the game`,$localize`At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!`,Gj.getInitialState()),_j.anyMove($localize`Drop`,$localize`There are two kind of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right. You're playing Light.<br/><br/>Drop a piece on one of those three squares.`,Gj.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),zj.drop(Bj.ZERO,TZ.ZERO),$localize`Congratulations!`),_j.fromPredicate($localize`Transfer`,$localize`The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from an higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!`,Gj.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),zj.transfer(Bj.TWO,Bj.ZERO).get(),(e,t,n)=>e.isDrop()?Lw.failure($localize`This move is a drop, please do a transfer!`):Lw.SUCCESS,$localize`Congratulations!`),_j.fromPredicate($localize`Victory`,$localize`When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!`,Gj.fromRepresentation(2,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),zj.drop(Bj.TWO,TZ.ONE),(e,t,n)=>e.isDrop()?e.piece.equalsValue(TZ.ONE)?Lw.SUCCESS:Lw.failure($localize`You actively made your opponent win!`):Lw.failure($localize`Wrong choice, your opponent will win in the next turn no matter which piece is dropped!`),$localize`Congratulations!`)]}}function jj(e,t){if(1&e&&(_n(),ga(0,"circle",5)),2&e){const e=t.$implicit,n=Sa();ra("cx",(e+1)*n.PIECE_RADIUS)("cy",n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function Yj(e,t){if(1&e){const e=va();_n(),fa(0,"polygon",7),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa();return n.onArrowClick(t,n.PlayerOrNone.ZERO)}),pa()}if(2&e){const e=Sa().index,t=Sa();Ta("id","dropArrow_zero_",e,""),ha("ngClass",t.getArrowClasses(e,t.PlayerOrNone.ZERO)),ra("points",t.ARROW_COORD)("transform",t.getArrowTransform(e,t.PlayerOrNone.ZERO))}}function Kj(e,t){if(1&e){const e=va();_n(),fa(0,"polygon",7),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa();return n.onArrowClick(t,n.PlayerOrNone.ONE)}),pa()}if(2&e){const e=Sa().index,t=Sa();Ta("id","dropArrow_one_",e,""),ha("ngClass",t.getArrowClasses(e,t.PlayerOrNone.ONE)),ra("points",t.ARROW_COORD)("transform",t.getArrowTransform(e,t.PlayerOrNone.ONE))}}function Qj(e,t){if(1&e){const e=va();_n(),ma(0),fa(1,"circle",8),Ea("click",function(){Gt(e);const t=Sa().index;return Sa().onSquareClick(t)}),pa(),ya()}if(2&e){const e=t.$implicit,n=Sa(),r=n.index,i=n.$implicit,s=Sa();Ts(1),ka("id","square_",r,"_piece_",e,"_out_of_",i.count(s.PlayerOrNone.NONE),""),ha("ngClass",s.getPieceClasses(r,e,i)),ra("cx",s.getCircleCenter(r,e,i).x)("cy",s.getCircleCenter(r,e,i).y)}}function Xj(e,t){if(1&e){const e=va();_n(),ma(0),la(1,Yj,1,4,"polygon",6),la(2,Kj,1,4,"polygon",6),fa(3,"rect",7),Ea("click",function(){const t=Gt(e).index;return Sa().onSquareClick(t)}),pa(),la(4,Qj,2,6,"ng-container",3),ya()}if(2&e){const e=t.$implicit,n=t.index,r=Sa();Ts(1),ha("ngIf",r.canDisplayArrow(n,r.PlayerOrNone.ZERO)),Ts(1),ha("ngIf",r.canDisplayArrow(n,r.PlayerOrNone.ONE)),Ts(1),Ta("id","square_",n,""),ha("ngClass",r.getSquareClasses(n)),ra("x",n*r.SPACE_SIZE)("y",(5-n)*r.SPACE_SIZE*.25)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),Ts(1),ha("ngForOf",r.range(e.count(r.PlayerOrNone.NONE)))}}function Jj(e,t){if(1&e&&(_n(),ga(0,"circle",9)),2&e){const e=t.$implicit,n=Sa();ra("cx",4*n.SPACE_SIZE-(e+1)*n.PIECE_RADIUS)("cy",2.25*n.SPACE_SIZE+3*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}let eY=(()=>{class e extends ZW{constructor(t){super(t),this.PlayerOrNone=IZ,this.ARROW_COORD=e.getArrowCoord(),this.PIECES_PER_PLAYER=Gj.PIECES_PER_PLAYER,this.selectedPiece=Nw.empty(),this.leftPiece=Nw.empty(),this.droppedPiece=Nw.empty(),this.displayableArrow=[],this.rules=new Zj(Gj),this.availableMinimaxes=[new qj(this.rules,"ApagosDummyMinimax")],this.encoder=zj.encoder,this.tutorial=(new Wj).tutorial,this.PIECE_RADIUS=200/(this.PIECES_PER_PLAYER+1),this.updateBoard()}static getArrowCoord(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}cancelMoveAttempt(){this.selectedPiece=Nw.empty(),this.showPossibleDrops()}updateBoard(){const e=this.rules.node.gameState;this.board=e.board,this.remainingZero=e.remaining.get(TZ.ZERO).get(),this.remainingOne=e.remaining.get(TZ.ONE).get(),this.hideLastMove(),this.rules.node.move.isPresent()&&this.showLastMove(),this.showPossibleDrops()}hideLastMove(){this.movedSquare=[],this.droppedPiece=Nw.empty(),this.leftPiece=Nw.empty(),this.selectedPiece=Nw.empty()}showLastMove(){const e=this.rules.node.move.get();e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}showLastDrop(e){const t=e.piece.get();let n=e.landing.x;this.movedSquare=[n],3!==e.landing.x&&(n+=1,this.movedSquare.push(n));const r=this.getLowestPlayerPiece(this.board[n],t);this.droppedPiece=Nw.of({square:n,piece:r})}getLowestPlayerPiece(e,t){const n=e.count(t);return t===TZ.ZERO?n-1:e.count(IZ.NONE)-n}showLastTransfer(e){const t=this.rules.node.mother.get().gameState,n=t.getCurrentPlayer(),r=e.starting.get().x,i=this.getLowestPlayerPiece(t.board[r],n);this.leftPiece=Nw.of({square:r,piece:i});const s=e.landing.x,o=this.getLowestPlayerPiece(this.board[s],n);this.droppedPiece=Nw.of({square:s,piece:o})}showPossibleDrops(){this.displayableArrow=[];const e=this.rules.node.gameState;for(let t=0;t<4;t++)!1===e.board[t].isFull()&&(e.remaining.get(TZ.ZERO).get()>0&&this.displayableArrow.push({x:t,player:TZ.ZERO}),e.remaining.get(TZ.ONE).get()>0&&this.displayableArrow.push({x:t,player:TZ.ONE}))}getCircleCenter(e,t,n){const r=e*this.SPACE_SIZE+.5*this.SPACE_SIZE,i=(5-e)*this.SPACE_SIZE*.25+.5*this.SPACE_SIZE;if(1===n.count(IZ.NONE))return new GW(r,i);const s=n.count(IZ.NONE),o=2*t*Math.PI/s-Math.PI/2,a=.3*this.SPACE_SIZE,l=a*Math.cos(o),c=a*Math.sin(o);return new GW(r+l,i+c)}canDisplayArrow(e,t){return this.displayableArrow.some(n=>n.x===e&&n.player.equals(t))}getArrowClasses(e,t){return[this.getPlayerClass(t)]}getArrowTransform(e,t){let n=t===TZ.ZERO?0:.5*this.SPACE_SIZE;return n+=e*this.SPACE_SIZE,"translate("+n+", "+(3-e)*this.SPACE_SIZE*.25+")"}getSquareClasses(e){const t=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?t.push("selected"):this.movedSquare.includes(e)&&t.push("last-move"),t}onArrowClick(e,t){var n=this;return Ow(function*(){const r=n.canUserPlay("#dropArrow_"+(t===TZ.ZERO?"zero":"one")+"_"+e);if(r.isFailure())return n.cancelMove(r.getReason());const i=Bj.from(e);let s;if(n.selectedPiece.isPresent()){const e=n.selectedPiece.get().square;s=zj.transfer(Bj.from(e),i).get()}else s=zj.drop(i,t);return n.chooseMove(s,n.rules.node.gameState)})()}getPieceClasses(e,t,n){const r={square:e,piece:t},i=[];let s=n.count(TZ.ZERO),o=n.count(TZ.ONE);if(this.selectedPiece.equalsValue(r))i.push("selected");else if(this.droppedPiece.equalsValue(r))i.push("last-move");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===t)return i.push("captured-stroke"),i;this.rules.node.gameState.getCurrentOpponent()===TZ.ZERO?s++:o++}const a=n.count(IZ.NONE)-(o+s),l=this.getPieceColor(t,s,a);return""!==l&&i.push(l),i}getPieceColor(e,t,n){return e<t?"player0":e>=t+n?"player1":""}onSquareClick(e){var t=this;return Ow(function*(){const n=t.canUserPlay("#square_"+e);if(n.isFailure())return t.cancelMove(n.getReason());if(t.selectedPiece.isPresent()&&t.selectedPiece.get().square===e)return t.cancelMoveAttempt(),Lw.SUCCESS;const r=t.rules.node.gameState.getCurrentPlayer(),i=t.board[e];return i.count(r)<=0?t.cancelMove($j.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(t.selectedPiece=Nw.of({square:e,piece:t.getLowestPlayerPiece(i,r)}),0===t.showAndGetPossibleTranfers().length?t.cancelMove($j.NO_POSSIBLE_TRANSFER_REMAINS()):Lw.SUCCESS)})()}showAndGetPossibleTranfers(){this.displayableArrow=[];let e=this.selectedPiece.get().square-1;const t=this.rules.node.gameState.getCurrentPlayer();for(;0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:t}),e--;return this.displayableArrow}}return e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-apagos"]],features:[Go],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-8 -8 416 350","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player0",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],["class","base mid-stroke player1",4,"ngFor","ngForOf"],[1,"base","mid-stroke","player0"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","player1"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,jj,1,3,"circle",1),fa(2,"g",2),la(3,Xj,5,9,"ng-container",3),pa(),la(4,Jj,1,3,"circle",4),pa()),2&e&&(Ts(1),ha("ngForOf",t.range(t.remainingZero)),Ts(1),ra("transform","translate(0, "+2*t.PIECE_RADIUS+")"),Ts(1),ha("ngForOf",t.board),Ts(1),ha("ngForOf",t.range(t.remainingOne)))},directives:[tf,rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),tY=(()=>{class e extends ZW{getViewBox(){return-.5*this.STROKE_WIDTH+" "+-.5*this.STROKE_WIDTH+" "+(this.board.length*this.SPACE_SIZE+this.STROKE_WIDTH)+" "+(this.board[0].length*this.SPACE_SIZE+this.STROKE_WIDTH)}}return e.\u0275fac=function(){let t;return function(n){return(t||(t=tr(e)))(n||e)}}(),e.\u0275cmp=Je({type:e,selectors:[["ng-component"]],features:[Go],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();class nY extends sj{constructor(e,t,n){super(e,t),this.captured=n}static getInitialState(){const e=NZ.createTable(6,2,4);return new nY(e,0,[0,0])}getCapturedCopy(){return[this.captured[0],this.captured[1]]}}let rY=(()=>{class e{}return e.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=()=>$localize`You cannot distribute from the opponent's home.`,e.MUST_CHOOSE_NON_EMPTY_HOUSE=()=>$localize`You should choose a non-empty house to distribute.`,e.SHOULD_DISTRIBUTE=()=>$localize`You should distribute but you do not.`,e})(),iY=(()=>{class e extends mj{applyLegalMove(t,n,r){Iw(e.VERBOSE,{called:"AwaleRules.applyLegalMove",move:t,state:n});const i=t.x,s=n.getCurrentPlayer().value,o=n.getCurrentPlayer().getOpponent().value;let a=n.getCopiedBoard();const l=e.distribute(i,s,a);if(l.y===s)return new nY(a,n.turn+1,n.captured);{let t=[0,0];const r=NZ.copyBiArray(a);return t[s]=e.capture(l.x,o,s,a),t[s]>0&&e.isStarving(o,a)&&(a=r,t=[0,0]),e.isStarving(s,a)&&!1===e.canDistribute(o,a)&&(t[o]+=e.mansoon(o,a)),t[0]+=n.captured[0],t[1]+=n.captured[1],new nY(a,n.turn+1,t)}}static mansoon(e,t){let n=0,r=0;do{n+=t[e][r],t[e][r]=0,r++}while(r<6);return n}static isLegal(t,n){const r=n.getCurrentPlayer().value,i=n.getCurrentPlayer().getOpponent().value,s=t.x;if(0===n.getPieceAtXY(s,r))return Rw.failure(rY.MUST_CHOOSE_NON_EMPTY_HOUSE());const o=e.isStarving(i,n.board),a=!1===e.doesDistribute(s,r,n.board);return o&&a?Rw.failure(rY.SHOULD_DISTRIBUTE()):Rw.success(void 0)}isLegal(t,n){return e.isLegal(t,n)}static doesDistribute(e,t,n){return 0===t?n[t][e]>5-e:n[t][e]>e}static canDistribute(t,n){for(let r=0;r<6;r++)if(e.doesDistribute(r++,t,n))return!0;return!1}static isStarving(e,t){let n=0;do{if(t[e][n++]>0)return!1}while(n<6);return!0}static distribute(e,t,n){const r=e,i=t;let s=n[t][e];for(n[t][e]=0;s>0;)0===t?5===e?t=1:e++:0===e?t=0:e--,(e!==r||t!==i)&&(n[t][e]+=1,s--);return new GW(e,t)}static capture(e,t,n,r){hZ(t!==n,"AwaleRules.capture called with wrong values of x and player");let i=r[t][e];if(i<2||i>3)return 0;let s=0,o=-1,a=-1;0===n&&(o=1,a=6);do{s+=i,r[t][e]=0,i=r[t][e+=o]}while(e!==a&&(2===i||3===i));return s}static getGameStatus(e){const t=e.gameState;return t.captured[0]>24?gj.ZERO_WON:t.captured[1]>24?gj.ONE_WON:24===t.captured[0]&&24===t.captured[1]?gj.DRAW:gj.ONGOING}getGameStatus(t){return e.getGameStatus(t)}}return e.VERBOSE=!1,e})();class sY extends aj{constructor(e){super(),this.x=e}static from(e){switch(e){case 0:return sY.ZERO;case 1:return sY.ONE;case 2:return sY.TWO;case 3:return sY.THREE;case 4:return sY.FOUR;default:return hZ(5===e,"Invalid x for AwaleMove: "+e),sY.FIVE}}equals(e){return e===this||e.x===this.x}toString(){return"AwaleMove("+this.x+")"}}sY.ZERO=new sY(0),sY.ONE=new sY(1),sY.TWO=new sY(2),sY.THREE=new sY(3),sY.FOUR=new sY(4),sY.FIVE=new sY(5),sY.encoder=new class extends bZ{maxValue(){return 5}encodeNumber(e){return e.x}decodeNumber(e){return sY.from(e)}};class oY extends ej{getListMoves(e){const t=[],n=e.gameState,r=n.turn%2;let i,s=0;do{0!==n.getPieceAtXY(s,r)&&(i=sY.from(s),iY.isLegal(i,n).isSuccess()&&(i=sY.from(s),t.push(i))),s++}while(s<6);return this.orderMoves(e,t)}orderMoves(e,t){const n=e.gameState.getCurrentPlayer().value,r=e.gameState.getCurrentPlayer().getOpponent().value;return NZ.sortByDescending(t,t=>{const i=e.gameState.getCopiedBoard(),s=i[n][t.x],o=iY.distribute(t.x,n,i);let a,l=0;return o.y===n?(a=0,s<=6&&(l=10)):a=iY.capture(o.x,r,n,i),100*a+l-s}),t}getBoardValue(e){const t=iY.getGameStatus(e);if(t.isEndGame)return tj.fromWinner(t.winner);const n=e.gameState.getCapturedCopy();return new tj(n[1]-n[0])}}class aY{constructor(){this.tutorial=[_j.anyMove($localize`Sowing`,$localize`Awal is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.
         Let's see how seeds are sown.
         As you're playing first, the 6 houses on the top are yours.<br/><br>
         Click on any of them to sow the seeds it contains: they will be sown clockwise, one seed per house.`,nY.getInitialState(),sY.ZERO,$localize`Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.
        This is how seeds are sown:
        one by one from the house next to the one they come from, clockwise.`),_j.anyMove($localize`Big sowing`,$localize`You are now the second player (on the bottom).
        When there are enough seeds to make a full turn, something else happens.<br/><br/>
        Sow the house that contains 12 seeds.`,new nY([[0,0,0,0,0,0],[0,12,0,0,0,0]],1,[0,0]),sY.ONE,$localize`See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds).`),_j.fromMove($localize`Simple capture`,$localize`After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.
         Then, the player looks at the preceding house:
         if it is still in the opponent's side and contains two or three seeds, they are also captured.
         This continues until we reach either the player's side or a house containing neither two nor three seeds.<br/><br/>
         You are the second player, try to capture some pieces!`,new nY([[1,0,0,0,1,0],[1,0,0,0,1,0]],1,[0,0]),[sY.ZERO],$localize`Well done! This was a simple capture, now let us see how to make multiple captures.`,$localize`Failed. Try again and sow from the leftmost house.`),_j.fromMove($localize`Multiple captures`,$localize`By sowing from your leftmost house, you will change the number of seeds in a house from 2 to 3, and from the preceding house from 1 to 2.
        As these are consecutive houses, all seeds in them will be captured.<br/><br/>
        Capture them.`,new nY([[2,1,0,0,1,0],[2,0,0,0,1,0]],1,[0,0]),[sY.ZERO],$localize`Nice, you win 3 points from the first house, and 2 from the second!`,$localize`Failed. Try again.`),_j.fromMove($localize`Interrupted capture`,$localize`By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>
        Do it.`,new nY([[1,0,1,0,0,1],[3,0,0,0,1,0]],1,[0,0]),[sY.ZERO],$localize`Notice that because the second house was not capturable, the captured was interrupted and you have not captured the first house.`,$localize`Failed. Try again.`),_j.fromMove($localize`Capture on the other side only`,$localize`Try to capture the two leftmost houses of the opponent.`,new nY([[2,2,0,0,1,0],[1,3,0,0,0,0]],1,[0,0]),[sY.ONE],$localize`Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!`,$localize`You have only captured one house, try again!`),_j.fromMove($localize`Do not starve`,$localize`You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>
        Try it.`,new nY([[1,1,1,1,1,0],[5,0,0,1,0,0]],1,[0,0]),[sY.ZERO],$localize`Sadly, you cannot capture here, otherwise the opponent could not play after you.
        When this happens, the move can be made, but no capture takes place!`,$localize`Failed. Try again.`),_j.anyMove($localize`Feeding is mandatory`,$localize`You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>
        Go ahead!`,new nY([[0,0,0,0,0,0],[0,1,2,4,4,5]],1,[0,0]),sY.THREE,$localize`Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.
        It is often a good way to have easy captures!`),_j.anyMove($localize`End of the game`,$localize`A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>
         Sow the house on the top right.`,new nY([[0,0,0,0,0,1],[0,1,2,3,4,4]],0,[0,0]),sY.FIVE,$localize`Also, as soon as on player cannot play, the other player captures all the seeds in its own side.
         Here, it was the first player's turn, and the second player has taken all the remaining seeds.`)]}}function lY(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"circle",4),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),pa(),fa(2,"text",5),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),Qa(3),pa(),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();Ts(1),Ia("id","click_",n,"_",r,""),ha("ngClass",i.getSquareClasses(n,r)),ra("cx",50+100*n)("cy",50+120*r),Ts(1),ra("x",50+100*n)("y",66+120*r),Ts(1),Ja(" ",e," ")}}function cY(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,lY,4,8,"g",2),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}let uY=(()=>{class e extends tY{constructor(e){super(e),this.last=Nw.empty(),this.captured=[],this.moved=[],this.scores=Nw.of([0,0]),this.rules=new iY(nY),this.availableMinimaxes=[new oY(this.rules,"AwaleMinimax")],this.encoder=sY.encoder,this.tutorial=(new aY).tutorial,this.updateBoard()}updateBoard(){const e=this.rules.node.gameState;this.scores=Nw.of(e.getCapturedCopy()),this.hidePreviousMove();const t=this.rules.node.move;if(this.board=e.getCopiedBoard(),t.isPresent()){const n=e.getCurrentOpponent().value;this.last=Nw.of(new GW(t.get().x,n)),this.showPreviousMove()}else this.last=Nw.empty()}hidePreviousMove(){this.captured=[],this.moved=[]}showPreviousMove(){const e=this.rules.node.mother.get().gameState;for(let t=0;t<=1;t++)for(let n=0;n<=5;n++){const r=new GW(n,t),i=this.board[t][n],s=e.getPieceAt(r);this.last.equalsValue(r)||(i<s?this.captured.push(r):i>s&&this.moved.push(r))}}onClick(e,t){var n=this;return Ow(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());if(t!==n.rules.node.gameState.getCurrentPlayer().value)return n.cancelMove(rY.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME());n.last=Nw.empty();const i=sY.from(e);return n.chooseMove(i,n.rules.node.gameState,n.scores.get())})()}getSquareClasses(e,t){const n=new GW(e,t);return this.captured.some(e=>e.equals(n))?["captured"]:this.last.equalsValue(n)?["moved","highlighted"]:this.moved.some(e=>e.equals(n))?["moved"]:[]}}return e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-awale-component"]],features:[Go],decls:4,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),ga(1,"rect",1),la(2,cY,2,1,"g",2),ga(3,"line",3),pa()),2&e&&(Ts(2),ha("ngForOf",t.board))},directives:[tf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class hY extends lj{constructor(e,t){if(super(e.x,e.y),e.equals(t))throw new Error(JW.MOVE_CANNOT_BE_STATIC());this.end=t}static getEncoder(e,t,n){return new class extends bZ{constructor(){super(...arguments),this.shiftAX=t,this.shiftDY=this.shiftAX*e,this.shiftDX=this.shiftDY*t}maxValue(){return(e-1)*this.shiftDX+(t-1)*this.shiftDY+(e-1)*this.shiftAX+(t-1)}encodeNumber(e){return e.coord.x*this.shiftDX+e.coord.y*this.shiftDY+e.end.x*this.shiftAX+e.end.y}decodeNumber(r){const i=r%t;r/=t;const s=new GW((r-=r%1)%e,i);r/=e;const o=(r-=r%1)%t;r/=t;const a=new GW((r-=r%1)%e,o);return n(a,s)}}}length(){return this.coord.getDistance(this.end)}getDirection(){return $W.factory.fromMove(this.coord,this.end)}}let dY=(()=>{class e{}return e.LANDING_ON_OCCUPIED_SQUARE=()=>$localize`You cannot land on an occupied square.`,e.THRONE_IS_LEFT_FOR_GOOD=()=>$localize`Once you left the central throne, you cannot return to it.`,e.SOLDIERS_CANNOT_SIT_ON_THRONE=()=>$localize`Soldiers cannot sit on the throne.`,e.MOVE_MUST_BE_ORTHOGONAL=()=>$localize`Tafl moves must be orthogonal.`,e})();class fY extends hY{constructor(e,t){if(super(e,t),e.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+e.toString()+".");if(t.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+t.toString()+".");const n=e.getDirectionToward(t);if(n.isFailure()||n.get().isDiagonal())throw new Error(dY.MOVE_MUST_BE_ORTHOGONAL())}equals(e){return e===this||!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}toString(){return"TaflMove("+this.coord+"->"+this.end+")"}}class pY extends fY{static of(e,t){return new pY(e,t)}static from(e,t){try{const n=new pY(e,t);return Rw.success(n)}catch(n){return Rw.failure(n.message)}}getMaximalDistance(){return 7}}pY.encoder=hY.getEncoder(7,7,pY.of);const gY={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:TZ.ZERO};class mY{constructor(e,t){this.owner=e,this.king=t}isKing(){return this.king}getOwner(){return this.owner}}mY.UNOCCUPIED=new mY(IZ.NONE,!1),mY.PLAYER_ONE_KING=new mY(TZ.ONE,!0),mY.INVADERS=new mY(TZ.ZERO,!1),mY.DEFENDERS=new mY(TZ.ONE,!1);class yY{constructor(e){this.value=e}}yY.NONE=new yY("NONE"),yY.OPPONENT=new yY("OPPONENT"),yY.PLAYER=new yY("PLAYER");class vY extends sj{isCentralThrone(e){return e.equals(this.getCentralThrone())}getCentralThrone(){const e=(this.board.length-1)/2;return new GW(e,e)}getRelativeOwner(e,t){const n=this.getAbsoluteOwner(t);let r;return r=n===IZ.NONE?yY.NONE:e===n?yY.PLAYER:yY.OPPONENT,r}getAbsoluteOwner(e){return this.getPieceAt(e).getOwner()}}class CY extends vY{static getInitialState(){const e=mY.UNOCCUPIED,t=mY.INVADERS,n=mY.DEFENDERS;return new CY([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,n,e,e,e],[t,t,n,mY.PLAYER_ONE_KING,n,t,t],[e,e,e,n,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}from(e,t){return new CY(e,t)}}let _Y=(()=>{class e extends mj{constructor(e,t,n){super(e),this.config=t,this.generateMove=n}isLegal(t,n){Iw(e.VERBOSE,{tablutRules_isLegal:{move:t,state:n}});const r=n.getCurrentPlayer(),i=this.getMoveValidity(r,t,n);return i.isFailure()?Rw.failure(i.getReason()):Rw.success(void 0)}getMoveValidity(e,t,n){const r=n.getRelativeOwner(e,t.coord);if(r===yY.NONE)return Lw.failure(JW.MUST_CHOOSE_PLAYER_PIECE());if(r===yY.OPPONENT)return Lw.failure(JW.CANNOT_CHOOSE_OPPONENT_PIECE());if(n.getRelativeOwner(e,t.end)!==yY.NONE)return Lw.failure(dY.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(n,t.end)){if(!n.getPieceAt(t.coord).isKing())return Lw.failure(dY.SOLDIERS_CANNOT_SIT_ON_THRONE());if(n.isCentralThrone(t.end)&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return Lw.failure(dY.THRONE_IS_LEFT_FOR_GOOD())}const i=t.coord.getDirectionToward(t.end).get(),s=t.coord.getOrthogonalDistance(t.end);let o=t.coord.getNext(i);for(let a=1;a<s;a++){if(n.getPieceAt(o)!==mY.UNOCCUPIED)return Lw.failure(JW.SOMETHING_IN_THE_WAY());o=o.getNext(i)}return Lw.SUCCESS}isThrone(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}isExternalThrone(e){const t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}tryCapture(e,t,n,r){const i=t.getNext(n);return i.isInRange(this.config.WIDTH,this.config.WIDTH)&&r.getRelativeOwner(e,i)===yY.OPPONENT?r.getPieceAt(i).isKing()?this.captureKing(e,t,n,r):this.capturePawn(e,t,n,r):Nw.empty()}captureKing(e,t,n,r){const i=t.getNext(n),{backCoord:s,back:o,backInRange:a,left:l,leftCoord:c,right:u,rightCoord:h}=this.getSurroundings(i,n,e,r);return!1===a?this.captureKingAgainstTheWall(l,u,i):o===yY.NONE&&this.isThrone(r,s)?this.captureKingAgainstThrone(s,i,l,u):o===yY.PLAYER?this.captureKingWithAtLeastASandwich(r,i,l,c,u,h):Nw.empty()}getSurroundings(e,t,n,r){const i=e.getNext(t),s=i.isInRange(this.config.WIDTH,this.config.WIDTH),o=s?r.getRelativeOwner(n,i):yY.NONE,a=e.getLeft(t),l=a.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,a):yY.NONE,c=e.getRight(t),u=c.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,c):yY.NONE;return{backCoord:i,back:o,backInRange:s,leftCoord:a,left:l,rightCoord:c,right:u}}captureKingAgainstTheWall(t,n,r){let i=t===yY.PLAYER?1:0;return i+=n===yY.PLAYER?1:0,2===i&&this.config.BORDER_CAN_SURROUND_KING?(Iw(e.VERBOSE||!1,"king captured by 3 invaders against 1 border"),Nw.of(r)):Nw.empty()}captureKingAgainstThrone(e,t,n,r){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return Nw.of(t)}else{const e=r===yY.PLAYER,i=n===yY.PLAYER||e;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&i)return Nw.of(t)}return Nw.empty()}capturePawn(t,n,r,i){const s=!1,o=n.getNext(r),a=o.getNext(r);let l=yY.NONE;return a.isInRange(this.config.WIDTH,this.config.WIDTH)&&(l=i.getRelativeOwner(t,a)),l===yY.NONE?!1===this.isThrone(i,a)?(Iw(e.VERBOSE||s,"cannot capture a pawn without an ally; "+o+"threatened by "+t+"'s pawn in  "+n+" coming from this direction ("+r.x+", "+r.y+")cannot capture a pawn without an ally behind"),Nw.empty()):(Iw(e.VERBOSE||s,"pawn captured by 1 opponent and 1 throne; "+o+"threatened by "+t+"'s pawn in  "+n+" coming from this direction ("+r.x+", "+r.y+")"),Nw.of(o)):l===yY.PLAYER?(Iw(e.VERBOSE||s,"pawn captured by 2 opponents; "+o+"threatened by "+t+"'s pawn in  "+n+" coming from this direction ("+r.x+", "+r.y+")"),Nw.of(o)):(Iw(e.VERBOSE||s,"no captures; "+o+"threatened by "+t+"'s pawn in  "+n+" coming from this direction ("+r.x+", "+r.y+")"),Nw.empty())}captureKingWithAtLeastASandwich(t,n,r,i,s,o){if(!1===this.kingTouchCentralThrone(t,n)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return Nw.of(n);const a=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,l=this.isThrone(t,i),c=r===yY.PLAYER||l&&a,u=this.isThrone(t,o);return c&&(s===yY.PLAYER||u&&a)?(Iw(e.VERBOSE||!1,"king captured by 4 invaders"),Nw.of(n)):Nw.empty()}kingTouchCentralThrone(e,t){const n=e.getCentralThrone();return t.getOrthogonalDistance(n)<=1}applyLegalMove(t,n){Iw(e.VERBOSE,{TablutRules_applyLegalMove:{move:t,state:n}});const r=n.turn,i=n.getCopiedBoard(),s=n.getCurrentPlayer(),o=t.coord,a=t.end;i[a.y][a.x]=i[o.y][o.x],i[o.y][o.x]=mY.UNOCCUPIED;for(const e of zW.ORTHOGONALS){const r=this.tryCapture(s,t.end,e,n);r.isPresent()&&(i[r.get().y][r.get().x]=mY.UNOCCUPIED)}return n.from(i,r+1)}getGameStatus(e){const t=this.getWinner(e.gameState);return t.isPresent()?gj.getVictory(t.get()):gj.ONGOING}getWinner(e){const t=!1,n=this.getKingCoord(e);if(n.isAbsent())return Iw(t,"The king is dead, victory to invader"),Nw.of(this.getInvader());const r=n.get();return this.isExternalThrone(r)?(Iw(t,"The king escape, victory to defender"),Nw.of(this.getDefender())):this.isPlayerImmobilized(TZ.ZERO,e)?(Iw(t,"Zero has no move, victory to one"),Nw.of(TZ.ONE)):this.isPlayerImmobilized(TZ.ONE,e)?(Iw(t,"One has no move, victory to zero"),Nw.of(TZ.ZERO)):(Iw(t,"no victory"),Nw.empty())}getKingCoord(t){Iw(e.VERBOSE,{TablutRules_getKingCoord:{state:t,con:this.config}});for(let e=0;e<this.config.WIDTH;e++)for(let n=0;n<this.config.WIDTH;n++)if(t.getPieceAtXY(n,e).isKing())return Nw.of(new GW(n,e));return Nw.empty()}getInvader(){return this.config.INVADER}getDefender(){return this.config.INVADER.getOpponent()}isPlayerImmobilized(e,t){return 0===this.getPlayerListMoves(e,t).length}getPlayerListMoves(t,n){const r=[],i=this.getPlayerListPawns(t,n);Iw(e.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:t,state:n}});for(const e of i){const t=this.getPossibleDestinations(e,n);for(const n of t){const t=this.generateMove(e,n);r.push(t)}}return r}getPlayerListPawns(e,t){const n=[];for(let r=0;r<this.config.WIDTH;r++)for(let i=0;i<this.config.WIDTH;i++){const s=new GW(i,r);t.getAbsoluteOwner(s)===e&&n.push(s)}return n}getPossibleDestinations(e,t){const n=[];let r;for(const i of zW.ORTHOGONALS){r=e.getNext(i,1);let s=!1;for(;r.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===s;)t.getAbsoluteOwner(r)===IZ.NONE?this.isExternalThrone(r)?t.getPieceAt(e).isKing()&&n.push(r):t.isCentralThrone(r)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&n.push(r):n.push(r):s=!0,r=r.getNext(i,1)}return n}}return e.VERBOSE=!1,e})();class EY extends _Y{constructor(){super(CY,gY,pY.of)}static get(){return null==EY.singleton&&(EY.singleton=new EY),pj.ruler=this.singleton,EY.singleton}}class wY extends tY{constructor(e,t,n){super(e),this.VERBOSE=t,this.generateMove=n,this.viewInfo={pieceClasses:[]},this.EMPTY=mY.UNOCCUPIED,this.captureds=[],this.chosen=new GW(-1,-1),this.lastMove=Nw.empty()}getViewBox(){const e=-this.STROKE_WIDTH,t=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return e+" "+e+" "+t+" "+t}updateBoard(){Iw(this.VERBOSE,"taflComponent.updateBoard"),this.lastMove=this.rules.node.move,this.board=this.rules.node.gameState.getCopiedBoard(),this.captureds=[],this.lastMove.isPresent()&&this.showPreviousMove(),this.updateViewInfo()}showPreviousMove(){const e=this.rules.node.mother.get().gameState,t=this.rules.node.gameState.getCurrentOpponent();for(const n of zW.ORTHOGONALS){const r=this.lastMove.get().end.getNext(n,1);if(r.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){const n=e.getRelativeOwner(t,r)===yY.OPPONENT,i=this.rules.node.gameState.getPieceAt(r)===mY.UNOCCUPIED;n&&i&&this.captureds.push(r)}}}updateViewInfo(){const e=[];for(let t=0;t<this.board.length;t++){const n=[];for(let e=0;e<this.board[0].length;e++){let r=[];r=this.board[t][e].getOwner()===IZ.NONE?[""]:this.getPieceClasses(e,t),n.push(r)}e.push(n)}this.viewInfo={pieceClasses:e}}onClick(e,t){var n=this;return Ow(function*(){Iw(n.VERBOSE,"TaflComponent.onClick("+e+", "+t+")");const r=n.canUserPlay("#click_"+e+"_"+t);return r.isFailure()?n.cancelMove(r.getReason()):-1===n.chosen.x?n.choosePiece(e,t):n.chooseDestination(e,t)})()}chooseDestination(e,t){var n=this;return Ow(function*(){Iw(n.VERBOSE,"TaflComponent.chooseDestination");const r=n.chosen,i=new GW(e,t),s=n.generateMove(r,i);return s.isSuccess()?(n.cancelMove(),yield n.chooseMove(s.get(),n.rules.node.gameState)):n.cancelMove(s.getReason())})()}choosePiece(e,t){return Iw(this.VERBOSE,"TaflComponent.choosePiece"),this.board[t][e]===mY.UNOCCUPIED?this.cancelMove(JW.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(e,t)?(this.chosen=new GW(e,t),this.updateViewInfo(),Iw(this.VERBOSE,"selected piece = ("+e+", "+t+")"),Lw.SUCCESS):this.cancelMove(JW.CANNOT_CHOOSE_OPPONENT_PIECE())}pieceBelongToCurrentPlayer(e,t){const n=this.rules.node.gameState,r=n.getCurrentPlayer(),i=new GW(e,t);return n.getRelativeOwner(r,i)===yY.PLAYER}cancelMoveAttempt(){this.chosen=new GW(-1,-1)}isThrone(e,t){return this.rules.isThrone(this.rules.node.gameState,new GW(e,t))}isCentralThrone(e,t){return!1===this.rules.node.gameState.isCentralThrone(new GW(e,t))}getPieceClasses(e,t){const n=[],r=new GW(e,t),i=this.rules.node.gameState.getAbsoluteOwner(r);return n.push(this.getPlayerClass(i)),this.chosen.equals(r)&&n.push("selected"),n}getRectClasses(e,t){const n=[],r=new GW(e,t);if(this.captureds.some(e=>e.equals(r)))n.push("captured");else if(this.lastMove.isPresent()){const e=this.lastMove.get().coord,t=this.lastMove.get().end;(r.equals(e)||r.equals(t))&&n.push("moved")}return n}getClickables(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[t].length;n++)this.isClickable(n,t)&&e.push(new GW(n,t));return e}isClickable(e,t){return this.pieceBelongToCurrentPlayer(e,t)}isInvader(e,t){return this.board[t][e]===mY.INVADERS}isKing(e,t){return this.board[t][e].isKing()}}class PY extends ej{getListMoves(e){Iw(!1,{TaflMinimax_getListMoves:{node:e}});const t=e.gameState,n=t.getCurrentPlayer(),r=this.ruler.getPlayerListMoves(n,t);return this.orderMoves(t,r)}orderMoves(e,t){const n=this.ruler.getKingCoord(e).get();return e.getCurrentPlayer()===this.ruler.config.INVADER?NZ.sortByDescending(t,e=>-e.end.getOrthogonalDistance(n)):NZ.sortByDescending(t,e=>e.coord.equals(n)?this.ruler.isExternalThrone(e.end)?2:1:0),t}getBoardValue(e){const t=e.gameState,n=this.ruler.getWinner(t);if(n.isPresent())return new tj(n.get().getVictoryValue());const r=this.ruler.getPlayerListPawns(TZ.ZERO,t).length,i=this.ruler.getPlayerListPawns(TZ.ONE,t).length;let s=[1,2][this.ruler.config.INVADER.value];s*=TZ.ZERO.getScoreModifier();let o=[2,1][this.ruler.config.INVADER.value];return o*=TZ.ONE.getScoreModifier(),new tj(r*s+i*o)}}class SY{constructor(e,t){this.directThreats=e,this.mover=t}equals(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}class bY extends SY{constructor(e,t){super(new rj([e]),t),this.directThreat=e,this.mover=t}}class OY extends rj{constructor(e){if(super(),this.map=[],this.values=[],void 0!==e)for(const t of e)this.add(t)}add(e){const t=this.toFields(e);let n=this.map;for(const i of t[0])void 0===n[i]&&(n[i]=[]),n=n[i];const r=t[1];return void 0===n[r]&&(n[r]=!0,this.values.push(e),!0)}contains(e){const t=this.toFields(e);let n=this.map;for(const r of t[0]){if(void 0===n[r])return!1;n=n[r]}return void 0!==n[t[1]]}[Symbol.iterator](){return this.values.values()}}class TY extends OY{toFields(e){return[[e.y],e.x]}}class IY extends PY{constructor(e,t){super(e,t),this.width=this.ruler.config.WIDTH,this.maxInfluence=16*(2*this.width-2),this.scoreByThreatenedPiece=16*this.maxInfluence+1,this.scoreBySafePiece=16*this.scoreByThreatenedPiece+1}getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return new tj(t.toBoardValue());const n=e.gameState,r=mY.UNOCCUPIED;let i=0;const s=this.getPiecesMap(n),o=this.getThreatMap(n,s),a=this.filterThreatMap(o,n);for(const l of TZ.PLAYERS)for(const e of s.get(l).get())if(a.get(e).isPresent())i+=l.getScoreModifier()*this.scoreByThreatenedPiece;else{i+=l.getScoreModifier()*this.scoreBySafePiece;let t=0;for(const i of zW.ORTHOGONALS){let s=e.getNext(i,1);for(;s.isInRange(this.width,this.width)&&n.getPieceAt(s)===r;)t++,s=s.getNext(i,1)}i+=t*l.getScoreModifier()}return new tj(i)}getPiecesMap(e){const t=mY.UNOCCUPIED,n=[],r=[];for(let i=0;i<this.width;i++)for(let s=0;s<this.width;s++){const o=new GW(s,i);e.getPieceAt(o)!==t&&(e.getAbsoluteOwner(o)===TZ.ZERO?n.push(o):r.push(o))}return new hj([{key:TZ.ZERO,value:new TY(n)},{key:TZ.ONE,value:new TY(r)}])}getThreatMap(e,t){const n=new hj;for(const r of TZ.PLAYERS)for(const i of t.get(r).get()){const t=this.getThreats(i,e);this.isThreatReal(i,e,t)&&n.set(i,new rj(t))}return n}getThreats(e,t){const n=t.getAbsoluteOwner(e);hZ(n.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");const r=n.getOpponent(),i=[];for(const s of zW.ORTHOGONALS){const n=e.getPrevious(s,1);if(this.isAThreat(n,t,r)){const o=[];for(const n of zW.ORTHOGONALS){if(n===s.getOpposite())continue;let i=e.getNext(s,1);for(;i.isInRange(this.width,this.width)&&t.getPieceAt(i)===mY.UNOCCUPIED;)i=i.getNext(n);i.isInRange(this.width,this.width)&&t.getAbsoluteOwner(i)===r&&!1===e.getNext(s,1).equals(i)&&o.push(i)}i.push(new bY(n,new TY(o)))}}return i}isAThreat(e,t,n){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==n&&(!this.ruler.isThrone(t,e)||n!==TZ.ONE&&t.getPieceAt(e)!==mY.UNOCCUPIED))}isThreatReal(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;for(const r of n)if(r.mover.size()>0)return!0;return!1}filterThreatMap(e,t){const n=new hj,r=e.listKeys(),i=r.filter(e=>t.getAbsoluteOwner(e)===t.getCurrentPlayer()),s=new TY(r.filter(e=>t.getAbsoluteOwner(e)===t.getCurrentOpponent()));for(const o of i){const t=e.get(o).get(),r=[];for(const e of t)if(!1===s.contains(e.directThreat)){const t=[];for(const n of e.mover)!1===s.contains(n)&&t.push(n);t.length>0&&r.push(new bY(e.directThreat,new TY(t)))}r.length>0&&n.set(o,new rj(r))}for(const o of s){const t=e.get(o).get();n.set(o,t)}return n}}class kY extends IY{getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return new tj(t.toBoardValue());const n=e.gameState,r=this.ruler.config.WIDTH,i=mY.UNOCCUPIED;let s=0;const o=this.getPiecesMap(n),a=this.getThreatMap(n,o),l=this.filterThreatMap(a,n);for(const c of TZ.PLAYERS){const e=new TY;for(const t of o.get(c).get())if(l.get(t).isPresent())s+=c.getScoreModifier()*kY.SCORE_BY_THREATENED_PIECE;else{s+=c.getScoreModifier()*kY.SCORE_BY_SAFE_PIECE;for(const s of zW.ORTHOGONALS){let o=t.getNext(s,1);for(;o.isInRange(r,r)&&n.getPieceAt(o)===i;)e.add(o),o=o.getNext(s,1)}}for(const t of e){const e=kY.CONTROL_VALUE[t.y][t.x];s+=c.getScoreModifier()*e}}return new tj(s)}}kY.SCORE_BY_THREATENED_PIECE=530,kY.SCORE_BY_SAFE_PIECE=16*kY.SCORE_BY_THREATENED_PIECE+1,kY.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];class AY extends kY{getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return new tj(t.toBoardValue());const n=e.gameState,r=this.ruler.config.WIDTH,i=mY.UNOCCUPIED;let s=0,o=0,a=0;const l=this.getPiecesMap(n),c=this.getThreatMap(n,l),u=this.filterThreatMap(c,n);for(const d of TZ.PLAYERS){const e=new TY;for(const t of l.get(d).get())if(u.get(t).isPresent())o+=d.getScoreModifier();else{s+=d.getScoreModifier();for(const s of zW.ORTHOGONALS){let o=t.getNext(s,1);for(;o.isInRange(r,r)&&n.getPieceAt(o)===i;)e.add(o),o=o.getNext(s,1)}}for(const t of e){const e=kY.CONTROL_VALUE[t.y][t.x];a+=d.getScoreModifier()*e}}const h=this.getStepForEscape(n);return new tj(531*h*17*17+531*s*17+531*o+a)}getStepForEscape(e){const t=this.ruler.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(Number.MAX_SAFE_INTEGER)}_getStepForEscape(e,t,n,r){const i=this.getNextGen(e,n,r);return 0===i.length?Nw.empty():i.some(e=>this.ruler.isExternalThrone(e))?Nw.of(t):(t++,r.push(...i),this._getStepForEscape(e,t,i,r))}getNextGen(e,t,n){const r=[];for(const i of t)for(const t of zW.ORTHOGONALS){let s=i.getNext(t,1);for(;s.isInRange(this.ruler.config.WIDTH,this.ruler.config.WIDTH)&&e.getPieceAt(s)===mY.UNOCCUPIED;)n.every(e=>!1===e.equals(s))&&r.push(s),s=s.getNext(t,1)}return r}}AY.SCORE_BY_THREATENED_PIECE=530,AY.SCORE_BY_SAFE_PIECE=16*kY.SCORE_BY_THREATENED_PIECE+1,AY.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];const MY=mY.UNOCCUPIED,NY=mY.INVADERS,RY=mY.DEFENDERS,xY=mY.PLAYER_ONE_KING;class DY{constructor(){this.tutorial=[_j.informational($localize`Goal of the game`,$localize`Brandhub is the Irish version of the family of viking strategy game called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,CY.getInitialState()),_j.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, he can't go back on it, nor can the other pieces.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,CY.getInitialState(),pY.of(new GW(3,1),new GW(1,1)),$localize`Congratulations!`),_j.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it.`,new CY([[MY,MY,MY,NY,MY,MY,MY],[MY,MY,MY,NY,MY,MY,MY],[NY,MY,MY,RY,MY,MY,MY],[MY,MY,RY,xY,RY,NY,NY],[MY,MY,NY,MY,MY,MY,MY],[MY,MY,MY,RY,MY,NY,MY],[MY,MY,MY,NY,MY,MY,MY]],1),[pY.of(new GW(3,5),new GW(2,5))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),_j.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it.`,new CY([[MY,MY,MY,NY,MY,MY,MY],[MY,MY,NY,MY,MY,MY,MY],[MY,MY,MY,RY,MY,MY,MY],[NY,RY,MY,MY,RY,NY,NY],[MY,RY,MY,MY,MY,MY,MY],[MY,NY,MY,xY,MY,NY,MY],[MY,MY,MY,NY,MY,MY,MY]],12),[pY.of(new GW(2,1),new GW(3,1)),pY.of(new GW(3,0),new GW(3,1))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),_j.fromMove($localize`Capturing the king on his throne`,$localize`To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>Capture the king.`,new CY([[MY,MY,MY,MY,MY,MY,MY],[MY,MY,MY,RY,MY,MY,MY],[MY,MY,MY,NY,MY,MY,MY],[MY,NY,MY,xY,NY,MY,MY],[MY,MY,MY,NY,MY,MY,MY],[MY,RY,MY,MY,MY,MY,MY],[MY,MY,MY,MY,MY,MY,MY]],72),[pY.of(new GW(1,3),new GW(2,3))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),_j.fromMove($localize`Capturing the king next to his throne`,$localize`Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>Capture the king.`,new CY([[MY,MY,NY,MY,MY,MY,MY],[MY,MY,MY,NY,MY,MY,MY],[MY,MY,MY,xY,NY,MY,MY],[MY,NY,RY,MY,RY,MY,MY],[MY,MY,MY,NY,MY,MY,MY],[MY,MY,MY,MY,MY,MY,MY],[MY,MY,MY,MY,MY,MY,MY]],72),[pY.of(new GW(2,0),new GW(2,2))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed!`),_j.fromMove($localize`Capturing the king far from his throne`,$localize`When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>Capture the king.`,new CY([[MY,MY,MY,MY,MY,MY,MY],[MY,MY,MY,MY,MY,MY,MY],[MY,NY,MY,NY,MY,MY,MY],[NY,MY,MY,MY,RY,MY,MY],[MY,MY,MY,RY,MY,MY,MY],[MY,MY,MY,MY,MY,MY,MY],[MY,xY,MY,NY,MY,MY,MY]],72),[pY.of(new GW(3,6),new GW(2,6))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed!`)]}}function LY(e,t){1&e&&(_n(),ga(0,"polyline",8))}function FY(e,t){1&e&&(_n(),ga(0,"polyline",9))}function UY(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,LY,1,0,"polyline",6),la(2,FY,1,0,"ng-template",null,7,Ku),pa()),2&e){const e=ca(3),t=Sa().index,n=Sa().index,r=Sa();Ts(1),ha("ngIf",r.isCentralThrone(t,n))("ngIfElse",e)}}function VY(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"line",10),ga(2,"line",10),ga(3,"line",10),ga(4,"line",10),ga(5,"line",10),pa()),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();Ts(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.04*n.SPACE_SIZE)("x2",.5*n.SPACE_SIZE)("y2",.96*n.SPACE_SIZE),Ts(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.1*n.SPACE_SIZE)("y2",.6*n.SPACE_SIZE),Ts(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.9*n.SPACE_SIZE)("y2",.6*n.SPACE_SIZE),Ts(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.4*n.SPACE_SIZE)("x2",.15*n.SPACE_SIZE)("y2",.75*n.SPACE_SIZE),Ts(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.4*n.SPACE_SIZE)("x2",.85*n.SPACE_SIZE)("y2",.75*n.SPACE_SIZE)}}function BY(e,t){if(1&e&&(_n(),ga(0,"polyline",15)),2&e){const e=Sa(3).index,t=Sa().index;ha("ngClass",Sa().viewInfo.pieceClasses[t][e])}}function $Y(e,t){if(1&e&&(_n(),ga(0,"line",10),ga(1,"line",10),ga(2,"line",10),ga(3,"line",10)),2&e){const e=Sa(3).index,t=Sa().index,n=Sa();ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.04*n.SPACE_SIZE)("x2",.5*n.SPACE_SIZE)("y2",.96*n.SPACE_SIZE),Ts(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.04*n.SPACE_SIZE)("y1",.5*n.SPACE_SIZE)("x2",.96*n.SPACE_SIZE)("y2",.5*n.SPACE_SIZE),Ts(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.2*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.8*n.SPACE_SIZE)("y2",.8*n.SPACE_SIZE),Ts(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.8*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.2*n.SPACE_SIZE)("y2",.8*n.SPACE_SIZE)}}function zY(e,t){if(1&e&&(_n(),la(0,BY,1,1,"polyline",13),la(1,$Y,4,20,"ng-template",null,14,Ku)),2&e){const e=ca(2),t=Sa(2).index,n=Sa().index;ha("ngIf",Sa().isKing(t,n))("ngIfElse",e)}}function HY(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"circle",10),la(2,VY,6,25,"g",11),la(3,zY,3,2,"ng-template",null,12,Ku),pa()),2&e){const e=ca(4),t=Sa().index,n=Sa().index,r=Sa();Ts(1),ha("ngClass",r.viewInfo.pieceClasses[n][t]),ra("r",r.SPACE_SIZE/2-r.STROKE_WIDTH)("cx",.5*r.SPACE_SIZE)("cy",.5*r.SPACE_SIZE),Ts(1),ha("ngIf",r.isInvader(t,n))("ngIfElse",e)}}function GY(e,t){if(1&e){const e=va();_n(),fa(0,"g",3),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),ga(1,"rect",4),la(2,UY,4,2,"g",5),la(3,HY,5,6,"g",5),pa()}if(2&e){const e=t.index,n=Sa().index,r=Sa();Ia("id","click_",e,"_",n,""),ra("transform","translate("+r.SPACE_SIZE*e+", "+r.SPACE_SIZE*n+")"),Ts(1),ha("ngClass",r.getRectClasses(e,n)),ra("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),Ts(1),ha("ngIf",r.board[n][e]===r.EMPTY&&r.isThrone(e,n)),Ts(1),ha("ngIf",r.board[n][e]!==r.EMPTY)}}function ZY(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,GY,4,8,"g",2),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}function qY(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",16),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t.x,t.y)}),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa();Ts(1),Ia("id","click_",e.x,"_",e.y,""),ra("x",n.SPACE_SIZE*e.x)("y",n.SPACE_SIZE*e.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let WY=(()=>{class e extends wY{constructor(e){super(e,!1,pY.from),this.rules=EY.get(),this.availableMinimaxes=[new PY(this.rules,"DummyBot"),new IY(this.rules,"Piece > Influence"),new kY(this.rules,"Piece > Control"),new AY(this.rules,"Escape > Piece > Control")],this.encoder=pY.encoder,this.tutorial=(new DY).tutorial}ngOnInit(){this.updateBoard()}}return e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-brandhub"]],features:[Go],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15",1,"base"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60, 10 20",1,"base"],[1,"base",3,"ngClass"],[4,"ngIf","ngIfElse"],["defender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,ZY,2,1,"g",1),la(2,qY,2,6,"g",1),pa()),2&e&&(ra("viewBox",t.getViewBox()),Ts(1),ha("ngForOf",t.board),Ts(1),ha("ngForOf",t.getClickables()))},directives:[tf,Jd,rf],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),jY=(()=>{class e extends ZW{constructor(){super(...arguments),this.SPACE_SIZE=50}getTriangleCornerCoords(e,t){return(e+t)%2==1?this.getDownwardCoordinate(e,t):this.getUpwardCoordinate(e,t)}getTriangleCoordinate(e,t){return this.getTriangleCornerCoords(e,t).map(e=>e.x+","+e.y).reduce((e,t)=>e+","+t)}getDownwardCoordinate(e,t){const n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,s=this.SPACE_SIZE*(t+1),o=new GW(.5*this.SPACE_SIZE*e,i);return[o,new GW(n,s),new GW(r,i),o]}getUpwardCoordinate(e,t){const n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,s=this.SPACE_SIZE*(t+1),o=new GW(.5*this.SPACE_SIZE*e,s);return[o,new GW(n,i),new GW(r,s),o]}getPyramidCoordinate(e,t){return(e+t)%2==1?this.getDownwardPyramidCoordinate(e,t):this.getUpwardPyramidCoordinate(e,t)}getDownwardPyramidCoordinate(e,t){const n=this.SPACE_SIZE*e/2,r=this.SPACE_SIZE*t,i=n+", "+r,s=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE),a=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE/2);return i+","+o+","+a+","+i+","+a+","+s+","+i+","+s+","+o+","+a+","+s}getUpwardPyramidCoordinate(e,t){const n=this.SPACE_SIZE*e/2,r=(t+1)*this.SPACE_SIZE,i=n+", "+r,s=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE),a=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE/2);return i+","+o+","+a+","+i+","+a+","+s+","+i+","+s+","+o+","+a+","+s}}return e.\u0275fac=function(){let t;return function(n){return(t||(t=tr(e)))(n||e)}}(),e.\u0275cmp=Je({type:e,selectors:[["ng-component"]],features:[Go],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})(),YY=(()=>{class e{}return e.INVALID_DISTANCE=()=>$localize`Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is.`,e.NOT_ENOUGH_TILES_TO_EXCHANGE=()=>$localize`You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it.`,e.FIRST_CLICK_SHOULD_NOT_BE_NULL=()=>$localize`Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles.`,e.CANNOT_CAPTURE_FROM_EMPTY=()=>$localize`You cannot capture from an empty space.`,e.CANNOT_CAPTURE_OWN_PIECES=()=>$localize`You cannot capture your own pieces.`,e})();class KY{constructor(e,t){this.direction=e,this.str=t}static fromCoords(e,t){const n=e.getVectorToward(t),r=KY.STEPS.findIndex(e=>e.direction.equals(n));if(-1===r)throw new Error(YY.INVALID_DISTANCE());return KY.STEPS[r]}toInt(){return KY.STEPS.findIndex(e=>e.direction.equals(this.direction))}equals(e){return this===e}toString(){return this.str}}KY.LEFT=new KY(new UW(-2,0),"LEFT"),KY.UP_LEFT=new KY($W.UP_LEFT,"UP_LEFT"),KY.UP_RIGHT=new KY($W.UP_RIGHT,"UP_RIGHT"),KY.RIGHT=new KY(new UW(2,0),"RIGHT"),KY.DOWN_LEFT=new KY($W.DOWN_LEFT,"DOWN_LEFT"),KY.DOWN_RIGHT=new KY($W.DOWN_RIGHT,"DOWN_RIGHT"),KY.STEPS=[KY.LEFT,KY.UP_LEFT,KY.UP_RIGHT,KY.RIGHT,KY.DOWN_LEFT,KY.DOWN_RIGHT];class QY extends aj{constructor(e,t,n,r){super(),this.start=e,this.step=t,this.landingCoord=n,this.capture=r}static fromMovement(e,t){if(e.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");const n=new GW(e.x+t.direction.x,e.y+t.direction.y);if(n.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new QY(Nw.of(e),Nw.of(t),Nw.of(n),Nw.empty())}static fromTilesExchange(e){if(e.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new QY(Nw.empty(),Nw.empty(),Nw.empty(),Nw.of(e))}static fromCoordToCoord(e,t){const n=KY.fromCoords(e,t);return QY.fromMovement(e,n)}isTileExchange(){return this.capture.isPresent()}toString(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}equals(e){return!(!this.capture.equals(e.capture)||!this.start.equals(e.start)||!this.step.equals(e.step))}}QY.encoder=new class extends bZ{maxValue(){return 1035}encodeNumber(e){if(e.isTileExchange()){const t=e.capture.get().y;return 10*e.capture.get().x+t}{const t=e.start.get().y,n=e.start.get().x;return 150*(e.step.get().toInt()+1)+10*n+t}}decodeNumber(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");const t=e%10,n=(e=(e-t)/10)%15;return 0==(e=(e-n)/15)?QY.fromTilesExchange(new GW(n,t)):QY.fromMovement(new GW(n,t),KY.STEPS[e-1])}};class XY{static getNeighbors(e){let t;const n=new GW(e.x-1,e.y),r=new GW(e.x+1,e.y);return t=(e.x+e.y)%2==1?[n,r,new GW(e.x,e.y-1)]:[n,r,new GW(e.x,e.y+1)],t}static getFakeNeighbors(e){return new GW(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}static getCommonNeighbor(e,t){const n=XY.getNeighbors(e),r=XY.getNeighbors(t);let i=0;for(;i<n.length;){const e=n[i];let t=0;for(;t<r.length;){if(e.equals(r[t]))return Nw.of(e);t++}i++}return Nw.empty()}static isSpaceDark(e){return(e.x+e.y)%2==0}}class JY extends sj{static getEmptyNeighbors(e,t,n){const r=[];for(const i of XY.getNeighbors(t))i.isInRange(e[0].length,e.length)&&e[i.y][i.x]===n&&r.push(i);return r}getEmptyNeighbors(e,t){return JY.getEmptyNeighbors(this.board,e,t)}}class eK extends JY{constructor(e,t,n,r){super(e,t),this.tiles=n,this.captures=r}static getTilesUpperLeftCoord(e){const t=e.x-e.x%3;let n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new GW(t,n)}static getPresentNeighborEntrances(e){return[new GW(e.x+1,e.y-1),new GW(e.x+3,e.y+0),new GW(e.x+3,e.y+1),new GW(e.x+1,e.y+2),new GW(e.x-1,e.y+1),new GW(e.x-1,e.y+0)].filter(eK.isInRange)}static getInitialState(){const e=WW.EMPTY,t=WW.UNREACHABLE,n=WW.ZERO,r=WW.ONE;return new eK([[t,t,t,t,t,t,n,e,n,t,t,t,t,t,t],[t,t,t,e,e,n,e,e,e,n,e,e,t,t,t],[e,r,e,r,e,e,n,e,n,e,e,r,e,r,e],[r,e,e,e,r,e,e,e,e,e,r,e,e,e,r],[e,r,e,r,e,e,e,e,e,e,e,r,e,r,e],[e,n,e,n,e,e,e,e,e,e,e,n,e,n,e],[n,e,e,e,n,e,e,e,e,e,n,e,e,e,n],[e,n,e,n,e,e,r,e,r,e,e,n,e,n,e],[t,t,t,e,e,r,e,e,e,r,e,e,t,t,t],[t,t,t,t,t,t,r,e,r,t,t,t,t,t,t]],0,[0,0],[0,0])}applyLegalMovement(e){Iw(eK.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:e}});const t=e.start.get(),n=e.landingCoord.get(),r=this.getCopiedBoard();return r[n.y][n.x]=WW.ofPlayer(this.getCurrentPlayer()),r[t.y][t.x]=WW.EMPTY,new eK(r,this.turn,this.tiles,this.captures)}doMovementCaptures(e){Iw(eK.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:e}});const t=this.getCapturedNeighbors(e.landingCoord.get());let n=this;for(const r of t)n=n.capture(r);return n}getCapturedNeighbors(e){const t=this.getCurrentOpponent();return XY.getNeighbors(e).filter(e=>!e.isNotInRange(15,10)&&!!this.getPieceAt(e).is(t)&&this.isSurrounded(e))}isSurrounded(e){return 0===this.getEmptyNeighbors(e,WW.EMPTY).length}capture(e){Iw(eK.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:e}});const t=this.getCopiedBoard(),n=[this.captures[0],this.captures[1]];return Iw(eK.VERBOSE,e.toString()+" has been captured"),t[e.y][e.x]=WW.EMPTY,n[this.getCurrentPlayer().value]+=1,new eK(t,this.turn,this.tiles,n)}removeTilesIfNeeded(e,t){Iw(eK.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,piece:e,countTiles:t}});let n=this;const r=eK.getTilesUpperLeftCoord(e);if(this.isTileEmpty(r)&&this.isDeconnectable(r)){n=this.deconnectTile(r,t);const e=eK.getPresentNeighborEntrances(r);for(const r of e){const e=n.getPieceAt(r);e===WW.EMPTY?n=n.removeTilesIfNeeded(r,t):e.is(this.getCurrentOpponent())&&n.isSurrounded(r)&&(n=n.capture(r))}}return n}isTileEmpty(e){hZ(this.getPieceAt(e)!==WW.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(let t=0;t<2;t++)for(let n=0;n<3;n++){const r=e.getNext(new UW(n,t),1);if(this.getPieceAt(r)!==WW.EMPTY)return!1}return!0}isDeconnectable(e){const t=this.getPresentNeighborTilesRelativeIndexes(e);if(t.length>3)return!1;let n=0;for(let r=1;r<t.length;r++)!1===this.areNeighbor(t[r-1],t[r])&&(n+=1);return!1===this.areNeighbor(t[0],t[t.length-1])&&(n+=1),n<=1}areNeighbor(e,t){return e+1===t||0===e&&5===t}getPresentNeighborTilesRelativeIndexes(e){const t=[];let n=Nw.empty();for(let r=0;r<6;r++){const i=e.getNext(eK.NEIGHBORS_TILES_DIRECTIONS[r],1);i.isInRange(15,10)&&this.getPieceAt(i)!==WW.UNREACHABLE&&(n.isAbsent()&&(n=Nw.of(r)),t.push(r-n.get()))}return t}deconnectTile(e,t){Iw(eK.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:e,countTiles:t}});const n=this.getCopiedBoard(),r=e.x,i=e.y;for(let o=0;o<2;o++)for(let e=0;e<3;e++)n[i+o][r+e]=WW.UNREACHABLE;const s=[this.tiles[0],this.tiles[1]];return t&&(s[this.getCurrentPlayer().value]+=1),new eK(n,this.turn,s,this.captures)}getLegalLandings(e){const t=[];for(const n of KY.STEPS){const r=e.getNext(n.direction,1);this.isOnBoard(r)&&this.getPieceAt(r)===WW.EMPTY&&t.push(r)}return t}getPiecesByFreedom(){const e=[[0,0,0,0],[0,0,0,0]];for(let t=0;t<10;t++)for(let n=0;n<15;n++){const r=this.board[t][n];if(r.isPlayer()){const i=this.getEmptyNeighbors(new GW(n,t),WW.EMPTY).length;e[r.value][i]=e[r.value][i]+1}}return e}}eK.VERBOSE=!1,eK.NEIGHBORS_TILES_DIRECTIONS=[new UW(0,-2),new UW(3,-1),new UW(3,1),new UW(0,2),new UW(-3,1),new UW(-3,-1)],eK.isInRange=e=>e.isInRange(15,10);let tK=(()=>{class e extends mj{applyLegalMove(e,t,n){return e.isTileExchange()?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}applyLegalTileExchange(t,n){const r=n.getCopiedBoard(),i=t.capture.get();r[i.y][i.x]=WW.EMPTY;const s=[n.captures[0],n.captures[1]];s[n.getCurrentPlayer().value]+=1;const o=[n.tiles[0],n.tiles[1]];o[n.getCurrentPlayer().value]-=2;const a=new eK(r,n.turn,o,s),l=a.removeTilesIfNeeded(i,!1),c=new eK(l.getCopiedBoard(),l.turn+1,l.tiles,l.captures);return Iw(e.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:n,afterCapture:a,afterTileRemoval:l,resultingState:c}}),c}applyLegalMovement(t,n){const r=n.applyLegalMovement(t),i=r.removeTilesIfNeeded(t.start.get(),!0),s=i.doMovementCaptures(t),o=new eK(s.board,n.turn+1,s.tiles,s.captures);return Iw(e.VERBOSE,{ab_state:n,afterMovement:r,afterTilesRemoved:i,afterCaptures:s,resultingState:o}),o}isLegal(e,t){return e.isTileExchange()?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}isLegalTileExchange(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return Rw.failure(YY.NOT_ENOUGH_TILES_TO_EXCHANGE());const n=t.getPieceAt(e.capture.get());return n===WW.UNREACHABLE||n===WW.EMPTY?Rw.failure(YY.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?Rw.failure(YY.CANNOT_CAPTURE_OWN_PIECES()):Rw.success(void 0)}isLegalMovement(e,t){if(t.getPieceAt(e.start.get())===WW.UNREACHABLE){const t="Cannot start with a coord outside the board "+e.start.get().toString()+".";return Rw.failure(t)}if(t.getPieceAt(e.landingCoord.get())===WW.UNREACHABLE){const t="Cannot end with a coord outside the board "+e.landingCoord.get().toString()+".";return Rw.failure(t)}const n=t.getPieceAt(e.start.get());return n===WW.EMPTY?Rw.failure(JW.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n.is(t.getCurrentOpponent())?Rw.failure(JW.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(e.landingCoord.get()).is(t.getCurrentPlayer())?Rw.failure(JW.MUST_LAND_ON_EMPTY_SPACE()):Rw.success(void 0)}static getGameStatus(e){const t=e.gameState;return t.captures[0]>=18?gj.ZERO_WON:t.captures[1]>=18?gj.ONE_WON:gj.ONGOING}getGameStatus(t){return e.getGameStatus(t)}}return e.VERBOSE=!1,e})();class nK extends ej{getListMoves(e){let t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),this.putCaptureFirst(e,t)}getListExchanges(e){const t=[],n=e.gameState,r=n.getCurrentPlayer().value,i=WW.ofPlayer(n.getCurrentOpponent());if(n.tiles[r]<2)return t;for(let s=0;s<10;s++)for(let e=0;e<15;e++){const r=new GW(e,s);if(n.getPieceAt(r)===i){const e=QY.fromTilesExchange(r);t.push(e)}}return t}getListMovement(e){const t=[],n=e.gameState,r=n.getCurrentPlayer();for(let i=0;i<10;i++)for(let e=0;e<15;e++){const s=new GW(e,i);if(n.getPieceAt(s).is(r)){const e=n.getLegalLandings(s);for(const n of e){const e=QY.fromCoordToCoord(s,n);t.push(e)}}}return t}getBoardValue(e){const t=tK.getGameStatus(e);if(t.isEndGame)return tj.fromWinner(t.winner);const n=e.gameState,r=n.getPiecesByFreedom(),i=this.getPiecesScore(r);return new tj(2*n.captures[1]+i[1]-(2*n.captures[0]+i[0]))}getPiecesScore(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}getPlayerPiecesScore(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}putCaptureFirst(e,t){return NZ.sortByDescending(t,t=>this.moveCapturesList(e,t).length),t}moveCapturesList(e,t){return t.isTileExchange()?[t.capture.get()]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.start.get(),!0).getCapturedNeighbors(t.landingCoord.get())}}let rK=(()=>{class e extends nK{getBoardValue(t){const n=tK.getGameStatus(t);if(n.isEndGame)return tj.fromWinner(n.winner);const r=t.gameState,i=this.getPiecesMap(r),s=this.getThreatMap(r,i),o=this.filterThreatMap(s,r);let a=0;for(const l of TZ.PLAYERS)for(const t of i.get(l).get())o.get(t).isPresent()?a+=l.getScoreModifier()*e.SCORE_BY_THREATENED_PIECE:a+=l.getScoreModifier()*e.SCORE_BY_SAFE_PIECE;return a+=r.tiles[1]-r.tiles[0],new tj(a)}getPiecesMap(e){const t=new hj,n=[],r=[];for(let i=0;i<10;i++)for(let t=0;t<15;t++){const s=new GW(t,i),o=e.getPieceAt(s);o===WW.ZERO?n.push(s):o===WW.ONE&&r.push(s)}return t.set(TZ.ZERO,new TY(n)),t.set(TZ.ONE,new TY(r)),t}getThreatMap(e,t){const n=new hj;for(const r of TZ.PLAYERS)for(const i of t.get(r).get()){const t=this.getThreat(i,e);t.isPresent()&&n.set(i,t.get())}return n}getThreat(e,t){const n=TZ.of(t.getPieceAt(e).value).getOpponent();let r=Nw.empty(),i=Nw.empty(),s=[];const o=XY.getNeighbors(e).filter(e=>e.isInRange(15,10));for(const a of o){const e=t.getPieceAt(a);if(e.is(n))s.push(a),this.tileCouldBeRemovedThisTurn(a,t,n)&&(i=Nw.of(a));else if(e===WW.EMPTY){if(r.isPresent())return Nw.empty();r=Nw.of(a)}}if(r.isPresent()){const e=[];for(const i of KY.STEPS){const o=r.get().getNext(i.direction,1);o.isInRange(15,10)&&t.getPieceAt(o).is(n)&&!1===s.some(e=>e.equals(o))&&e.push(o)}if(e.length>0)return Nw.of(new SY(new TY(s),new TY(e)))}if(i.isPresent()){s=s.filter(e=>e.equals(i.get()));const e=new TY(s);return Nw.of(new SY(e,new TY([i.get()])))}return Nw.empty()}tileCouldBeRemovedThisTurn(e,t,n){const r=n.getOpponent();if(!1===t.isDeconnectable(e))return!1;let i=Nw.empty();const s=eK.getTilesUpperLeftCoord(e);for(let o=0;o<2;o++)for(let e=0;e<3;e++){const a=s.getNext(new UW(e,o),1);if(t.getPieceAt(a).is(n)){if(!this.pieceCouldLeaveTheTile(a,t))return!1;i=Nw.of(a)}else if(t.getPieceAt(a).is(r))return!1}return i.isPresent()}pieceCouldLeaveTheTile(e,t){const n=eK.getTilesUpperLeftCoord(e);for(const r of KY.STEPS){const i=e.getNext(r.direction,1),s=eK.getTilesUpperLeftCoord(i);if(!1===n.equals(s)&&t.getPieceAt(i)===WW.EMPTY)return!0}return!1}filterThreatMap(e,t){const n=new hj,r=e.listKeys(),i=r.filter(e=>t.getPieceAt(e).is(t.getCurrentPlayer())),s=new TY(r.filter(e=>t.getPieceAt(e).is(t.getCurrentOpponent())));for(const o of i){const t=e.get(o).get();let r=Nw.empty();for(const e of t.directThreats)if(!1===s.contains(e)){const e=[];for(const n of t.mover)!1===s.contains(n)&&e.push(n);e.length>0&&(r=Nw.of(new SY(t.directThreats,new TY(e))))}r.isPresent()&&n.set(o,r.get())}for(const o of s){const t=e.get(o).get();n.set(o,t)}return n}}return e.SCORE_BY_THREATENED_PIECE=1e3,e.SCORE_BY_SAFE_PIECE=1e6,e})();const iK=WW.EMPTY,sK=WW.UNREACHABLE,oK=WW.ZERO,aK=WW.ONE;class lK{constructor(){this.tutorial=[_j.informational($localize`Board and goal of the game`,$localize`Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.
         The triangles are the spaces on which pieces move during the game.
         The tiles can be removed from the board (you will see how later).
         The dark pieces belong to the first player and can only move on the dark spaces,
         while the light pieces belong to the second player and can only move on the light spaces.
         The goal of the game is to capture all of the opponent's pieces.`,eK.getInitialState()),_j.anyMove($localize`Move`,$localize`To move a piece, you need to:
        <ol>
          <li>Click on one of your pieces.</li>
          <li>Click on one of the triangular space highlighted in yellow.</li>
        </ol>
        You can pass through the opponent's pieces.
        You're playing first, hence you're playing Dark.<br/><br/>
        Perform any move.`,eK.getInitialState(),QY.fromCoordToCoord(new GW(3,5),new GW(5,5)),$localize`Congratulations! Let's see captures now.`),_j.fromMove($localize`Capture`,$localize`Every piece has three neighboring triangular spaces (2 on the sides).
        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!
        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>
        You're playing Light, make a capture.`,new eK([[sK,sK,sK,sK,sK,sK,oK,iK,oK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,oK,iK,iK,iK,iK,iK,oK,iK,iK,sK,sK,sK],[iK,aK,iK,aK,oK,aK,iK,iK,oK,iK,iK,aK,iK,aK,iK],[aK,iK,iK,iK,iK,iK,iK,iK,iK,iK,aK,iK,iK,iK,aK],[iK,aK,iK,aK,iK,iK,iK,iK,iK,iK,iK,aK,iK,aK,iK],[iK,oK,iK,oK,iK,iK,iK,iK,iK,iK,iK,oK,iK,oK,iK],[oK,iK,iK,iK,oK,iK,iK,iK,iK,iK,oK,iK,iK,iK,oK],[iK,oK,iK,oK,iK,iK,aK,iK,aK,iK,iK,oK,iK,oK,iK],[sK,sK,sK,iK,iK,aK,iK,iK,iK,aK,iK,iK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,aK,iK,aK,sK,sK,sK,sK,sK,sK]],3,[0,0],[0,0]),[QY.fromCoordToCoord(new GW(5,2),new GW(4,1)),QY.fromCoordToCoord(new GW(3,4),new GW(4,3))],$localize`Congratulations!`,$localize`Failed, you have not captured any piece.`),_j.fromMove($localize`Gain a tile`,$localize`When a tile is empty, it can become removable from the board.
        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.
        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.
        For example, here, the topmost dark piece will not disconnect its tile when leaving it.
        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>
        Perform a move that lets you gain two tiles.`,new eK([[sK,sK,sK,sK,sK,sK,iK,iK,iK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,aK,iK,iK,sK,sK,sK,sK,sK,sK],[iK,iK,iK,sK,sK,sK,iK,iK,iK,sK,sK,sK,sK,sK,sK],[iK,iK,aK,iK,iK,iK,iK,oK,iK,sK,sK,sK,sK,sK,sK],[iK,iK,iK,aK,iK,iK,iK,iK,iK,sK,sK,sK,sK,sK,sK],[iK,iK,iK,iK,iK,iK,iK,iK,iK,iK,iK,oK,sK,sK,sK],[iK,iK,oK,iK,iK,aK,iK,iK,iK,iK,oK,iK,iK,iK,oK],[iK,iK,iK,iK,iK,iK,aK,iK,aK,iK,iK,oK,iK,oK,iK],[sK,sK,sK,iK,iK,aK,iK,iK,iK,aK,iK,iK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,aK,iK,aK,sK,sK,sK,sK,sK,sK]],2,[0,0],[0,0]),[QY.fromCoordToCoord(new GW(2,6),new GW(4,6)),QY.fromCoordToCoord(new GW(2,6),new GW(3,5)),QY.fromCoordToCoord(new GW(2,6),new GW(3,7))],$localize`Congratulations!`,$localize`Failed, you have not gained the two tiles that you could, try again!`),_j.fromMove($localize`Exchanging a tile`,$localize`When you have a tile, you can see it on the left of the board.
        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.
        This will cost you two tiles.
        If any tiles are removed during that turn, nobody will get them.<br/><br/>
        Gain some time and capture the last piece!`,new eK([[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,iK,iK,oK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,iK,iK,iK,iK,iK,iK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,iK,iK,iK,aK,iK,aK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,iK,iK,aK,iK,iK,iK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,aK,iK,aK,sK,sK,sK,sK,sK,sK]],1,[0,2],[0,0]),[QY.fromTilesExchange(new GW(5,5))],$localize`Congratulations!`,$localize`It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!`),_j.fromMove($localize`Special capture`,$localize`When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!
        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>
        A move that demonstrate both of these things can be done on this board by Light. Try it!`,new eK([[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,iK,iK,oK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,iK,iK,oK,iK,iK,iK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,iK,oK,aK,iK,aK,iK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,iK,aK,oK,iK,iK,iK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,iK,iK,aK,sK,sK,sK,sK,sK,sK,sK,sK,sK],[sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK,sK]],1,[0,0],[0,0]),[QY.fromCoordToCoord(new GW(7,6),new GW(6,5)),QY.fromCoordToCoord(new GW(7,6),new GW(8,5))],$localize`Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.
        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space.`,$localize`Failed!`)]}}function cK(e,t){if(1&e&&(_n(),ga(0,"polygon",13)),2&e){const e=Sa().index,t=Sa().index,n=Sa();ha("ngClass",n.getPyramidClass(e,t)),ra("points",n.getPyramidCoordinate(e,t))}}function uK(e,t){if(1&e&&(_n(),ga(0,"polygon",15)),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();ha("ngClass",n.getEmptyClass(e,t)),ra("points",n.getTriangleCoordinate(e,t))}}function hK(e,t){if(1&e&&(_n(),la(0,uK,1,2,"polygon",14)),2&e){const e=Sa().index,t=Sa().index;ha("ngIf",Sa().isEmptyCase(e,t))}}function dK(e,t){if(1&e&&(_n(),ga(0,"polygon",16)),2&e){const e=Sa().index,t=Sa().index,n=Sa();Ia("id","dark_line_",e,"_",t,""),ra("points",n.getLineCoordinate(e,t))}}function fK(e,t){if(1&e&&(_n(),ga(0,"polygon",17)),2&e){const e=Sa().index,t=Sa().index,n=Sa();Ia("id","dark_line_",e,"_",t,""),ra("points",n.getLineCoordinate(e,t))}}function pK(e,t){if(1&e){const e=va();_n(),fa(0,"g",8),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),la(1,cK,1,2,"polygon",9),la(2,hK,1,1,"ng-template",null,10,Ku),la(4,dK,1,3,"polygon",11),la(5,fK,1,3,"polygon",12),pa()}if(2&e){const e=t.$implicit,n=t.index,r=ca(3),i=Sa().index,s=Sa();Ia("id","click_",n,"_",i,""),Ts(1),ha("ngIf",s.isPyramid(n,i))("ngIfElse",r),Ts(3),ha("ngIf",e!==s.NONE),Ts(1),ha("ngIf",e!==s.NONE)}}function gK(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,pK,6,6,"g",7),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}function mK(e,t){if(1&e&&(_n(),ga(0,"polygon",18)),2&e){const e=t.$implicit;ra("points",Sa().getTriangleCoordinate(e.x,e.y))}}function yK(e,t){if(1&e&&(_n(),ga(0,"polygon",19)),2&e){const e=Sa();ra("points",e.getTriangleCoordinate(e.lastStart.get().x,e.lastStart.get().y))}}function vK(e,t){if(1&e&&(_n(),ga(0,"polygon",19)),2&e){const e=Sa();ra("points",e.getTriangleCoordinate(e.lastEnd.get().x,e.lastEnd.get().y))}}function CK(e,t){if(1&e&&(_n(),ga(0,"polygon",20)),2&e){const e=Sa();ra("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y))}}function _K(e,t){if(1&e&&(_n(),fa(0,"g",21),ga(1,"polygon",22),fa(2,"text",23),Qa(3),pa(),pa()),2&e){const e=Sa();Ts(1),ra("points",e.getTilesCountCoordinate(0,0))("stroke",e.lastTurnWasTilesExchange(0)?"yellow":"black"),Ts(1),ra("x",e.SPACE_SIZE/2+0*e.SPACE_SIZE)("y",16+e.SPACE_SIZE/2+0*e.SPACE_SIZE)("font-size",e.SPACE_SIZE/2),Ts(1),Xa(e.tiles[0])}}function EK(e,t){if(1&e&&(_n(),fa(0,"g",24),ga(1,"polygon",25),fa(2,"text",26),Qa(3),pa(),pa()),2&e){const e=Sa();Ts(1),ra("points",e.getTilesCountCoordinate(0,9))("stroke",e.lastTurnWasTilesExchange(1)?"yellow":"black"),Ts(1),ra("x",e.SPACE_SIZE/2+0*e.SPACE_SIZE)("y",16+e.SPACE_SIZE/2+9*e.SPACE_SIZE)("font-size",e.SPACE_SIZE/2),Ts(1),Xa(e.tiles[1])}}let wK=(()=>{class e extends jY{constructor(e){super(e),this.tiles=[0,0],this.NONE=WW.UNREACHABLE,this.chosenCoord=Nw.empty(),this.lastStart=Nw.empty(),this.lastEnd=Nw.empty(),this.highlights=[],this.scores=Nw.of([0,0]),this.rules=new tK(eK),this.availableMinimaxes=[new nK(this.rules,"Normal"),new rK(this.rules,"Piece > Threat > Tiles")],this.encoder=QY.encoder,this.tutorial=(new lK).tutorial,this.SPACE_SIZE=70,this.updateBoard()}updateBoard(){this.chosenCoord=Nw.empty(),this.state=this.rules.node.gameState,this.scores=Nw.of(this.state.captures),this.tiles=this.state.tiles;const e=this.rules.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=Nw.empty(),this.lastEnd=Nw.empty()),this.board=this.rules.node.gameState.board}showHighlight(){this.highlights=this.state.getLegalLandings(this.chosenCoord.get())}cancelMoveAttempt(){this.chosenCoord=Nw.empty(),this.highlights=[]}onClick(e,t){var n=this;return Ow(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=new GW(e,t);return n.chosenCoord.isAbsent()?n.firstClick(i):n.secondClick(i)})()}firstClick(e){var t=this;return Ow(function*(){const n=t.state.getPieceAt(e);if(n.is(t.state.getCurrentOpponent())){const n=QY.fromTilesExchange(e);return t.chooseMove(n,t.state,t.state.captures)}return n.is(t.state.getCurrentPlayer())?(t.chosenCoord=Nw.of(e),t.showHighlight(),Lw.SUCCESS):t.cancelMove(YY.FIRST_CLICK_SHOULD_NOT_BE_NULL())})()}secondClick(e){var t=this;return Ow(function*(){if(e.equals(t.chosenCoord.get()))return t.cancelMoveAttempt(),Lw.SUCCESS;if(t.highlights.some(t=>t.equals(e))){const n=QY.fromCoordToCoord(t.chosenCoord.get(),e);return t.chooseMove(n,t.state,t.state.captures)}return t.cancelMove(YY.INVALID_DISTANCE())})()}isPyramid(e,t){return this.board[t][e].isPlayer()||this.wasOpponent(e,t)}wasOpponent(e,t){const n=this.rules.node.mother;return n.isPresent()&&n.get().gameState.getPieceAtXY(e,t).is(n.get().gameState.getCurrentOpponent())}getPyramidClass(e,t){const n=this.board[t][e];return n===WW.ZERO?this.getPlayerClass(TZ.ZERO):n===WW.ONE?this.getPlayerClass(TZ.ONE):"captured"}isEmptyCase(e,t){return this.board[t][e]===WW.EMPTY||this.wasRemoved(e,t)}wasRemoved(e,t){const n=this.rules.node.mother;if(this.board[t][e]===WW.UNREACHABLE&&n.isPresent()){const r=n.get().gameState.getPieceAtXY(e,t);return r===WW.EMPTY||r.is(n.get().gameState.getCurrentPlayer())}return!1}getEmptyClass(e,t){return this.board[t][e]===WW.EMPTY?(e+t)%2==1?"background":"background2":"captured2"}getTilesCountCoordinate(e,t){const n=100*e,r=100*t,i=n+25;return i+", "+r+", "+(n+75)+", "+r+", "+(n+100)+", "+(r+50)+", "+(n+75)+", "+(r+100)+", "+(n+25)+", "+(r+100)+", "+(n+0)+", "+(r+50)+", "+i+", "+r}getLineCoordinate(e,t){const n=this.getTriangleCornerCoords(e,t);return e%3==0?n[0].x+","+n[0].y+","+n[1].x+","+n[1].y:e%3==1?n[0].x+","+n[0].y+","+n[2].x+","+n[2].y:n[1].x+","+n[1].y+","+n[2].x+","+n[2].y}mustShowTilesOf(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}lastTurnWasTilesExchange(e){return!this.rules.node.mother.isAbsent()&&this.rules.node.mother.get().gameState.tiles[e]>this.tiles[e]}}return e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-coerceo"]],features:[Go],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill highlighted",4,"ngFor","ngForOf"],["class","base no-fill last-move",4,"ngIf"],["class","base no-fill selected",4,"ngIf"],["id","tilesCountZero",4,"ngIf"],["id","tilesCountOne",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptyCase",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","last-move"],[1,"base","no-fill","selected"],["id","tilesCountZero"],["stroke-linecap","round",1,"base","player0"],["id","playerZeroTilesCount","text-anchor","middle",1,"text"],["id","tilesCountOne"],["stroke-linecap","round",1,"base","player1"],["id","playerOneTilesCount","text-anchor","middle",1,"text"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,gK,2,1,"g",1),la(2,mK,1,1,"polygon",2),la(3,yK,1,1,"polygon",3),la(4,vK,1,1,"polygon",3),la(5,CK,1,1,"polygon",4),la(6,_K,4,6,"g",5),la(7,EK,4,6,"g",6),pa()),2&e&&(ra("viewBox","-5 -5 "+(10+8*t.SPACE_SIZE)+" "+(10+10*t.SPACE_SIZE)),Ts(1),ha("ngForOf",t.board),Ts(1),ha("ngForOf",t.highlights),Ts(1),ha("ngIf",t.lastStart.isPresent()),Ts(1),ha("ngIf",t.lastEnd.isPresent()),Ts(1),ha("ngIf",t.chosenCoord.isPresent()),Ts(1),ha("ngIf",t.mustShowTilesOf(0)),Ts(1),ha("ngIf",t.mustShowTilesOf(1)))},directives:[tf,rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),PK=(()=>{class e{}return e.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=()=>$localize`Your piece should land on a neighboring square.`,e.CANNOT_DROP_AFTER_TURN_40=()=>$localize`You cannot drop a piece during the moving phase.`,e.CANNOT_MOVE_BEFORE_TURN_40=()=>$localize`You cannot move a piece before both players have dropped all of their pieces.`,e.MUST_JUMP_OVER_PIECES=()=>$localize`A jump must be made over a piece, not over an empty square.`,e.MUST_DROP_IN_CENTRAL_ZONE=()=>$localize`A drop must occur in the central zone of the board.`,e.INVALID_JUMP=()=>$localize`A jump must land two squares from its original position, and be done in a straight line in any direction.`,e.SAME_LOCATION_VISITED_IN_JUMP=()=>$localize`You are visiting the same location twice in a move, you are not allowed to do so.`,e})();class SK extends sj{static getInitialState(){const e=NZ.createTable(SK.WIDTH,SK.HEIGHT,IZ.NONE);return new SK(e,0)}isShelter(e){return 0===e.x||e.x===SK.WIDTH-1?SK.SHELTERS_INDICES.some(t=>e.y===t):(0===e.y||e.y===SK.HEIGHT-1)&&SK.SHELTERS_INDICES.some(t=>e.x===t)}isCentralZone(e){return e.x>=SK.CENTRAL_ZONE_TOP_LEFT.x&&e.x<=SK.CENTRAL_ZONE_BOTTOM_RIGHT.x&&e.y>=SK.CENTRAL_ZONE_TOP_LEFT.y&&e.y<=SK.CENTRAL_ZONE_BOTTOM_RIGHT.y}isDropPhase(){return this.turn<40}getSidePieces(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}SK.WIDTH=17,SK.HEIGHT=17,SK.CENTRAL_ZONE_TOP_LEFT=new GW(4,6),SK.CENTRAL_ZONE_BOTTOM_RIGHT=new GW(12,10),SK.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],SK.ALL_SHELTERS=new rj(SK.SHELTERS_INDICES.flatMap(e=>[new GW(e,0),new GW(e,SK.HEIGHT-1),new GW(0,e),new GW(SK.WIDTH-1,e)])).toList();class bK extends lj{constructor(e){super(e.x,e.y)}static of(e){return e.isInRange(SK.WIDTH,SK.HEIGHT)?Rw.success(new bK(e)):Rw.failure("Move out of board")}toString(){return`ConspirateursMoveDrop(${this.coord.toString()})`}equals(e){return!!e.isDrop()&&this.coord.equals(e.coord)}isDrop(){return!0}isSimple(){return!1}isJump(){return!1}}bK.encoder=class{static getEncoder(e,t,n){return new class extends bZ{constructor(){super(...arguments),this.shiftX=t}maxValue(){return(e-1)*this.shiftX+(t-1)}encodeNumber(e){return e.coord.x*this.shiftX+e.coord.y}decodeNumber(r){const i=r%t;r/=t;const s=new GW((r-=r%1)%e,i);return n(s)}}}}.getEncoder(SK.WIDTH,SK.HEIGHT,e=>bK.of(e).get());class OK extends hY{constructor(e,t){super(e,t)}static of(e,t){return e.isInRange(SK.WIDTH,SK.HEIGHT)&&t.isInRange(SK.WIDTH,SK.HEIGHT)?e.isAlignedWith(t)&&1===e.getDistance(t)?Rw.success(new OK(e,t)):Rw.failure(PK.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):Rw.failure("Move out of board")}toString(){return`ConspirateursMoveSimple(${this.coord.toString()} -> ${this.end.toString()})`}equals(e){return!(!e.isSimple()||e!==this&&(!1===e.coord.equals(this.coord)||!1===e.end.equals(this.end)))}isDrop(){return!1}isSimple(){return!0}isJump(){return!1}}OK.encoder=hY.getEncoder(SK.WIDTH,SK.HEIGHT,(e,t)=>OK.of(e,t).get());class TK extends aj{constructor(e){super(),this.coords=e}static of(e){if(e.length<2)return Rw.failure("ConspirateursMoveJump requires at least one jump, so two coords");for(const t of e)if(t.isNotInRange(SK.WIDTH,SK.HEIGHT))return Rw.failure("Move out of board");for(let t=1;t<e.length;t++)if(e[t-1].getDirectionToward(e[t]).isFailure()||2!==e[t-1].getDistance(e[t]))return Rw.failure(PK.INVALID_JUMP());return new TY(e).size()===e.length?Rw.success(new TK(e)):Rw.failure(PK.SAME_LOCATION_VISITED_IN_JUMP())}addJump(e){const t=NZ.copyImmutableArray(this.coords);return t.push(e),TK.of(t)}getStartingCoord(){return this.coords[0]}getEndingCoord(){return this.coords[this.coords.length-1]}getLandingCoords(){return this.coords.slice(1)}getJumpedOverCoords(){const e=[];for(let t=1;t<this.coords.length;t++){const n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}toString(){return`ConspirateursMoveJump(${this.coords.map(e=>e.toString()).reduce((e,t)=>e+" -> "+t)})`}equals(e){return!(e.isSimple()||e.isDrop()||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}isDrop(){return!1}isSimple(){return!1}isJump(){return!0}}TK.encoder=new class extends SZ{constructor(){super(...arguments),this.coordEncoder=GW.numberEncoder(SK.WIDTH,SK.HEIGHT)}encodeMove(e){return{coords:e.coords.map(this.coordEncoder.encodeNumber)}}decodeMove(e){hZ(null!=Tw.getNonNullable(e).coords,"Encoded ConspirateursMoveJump should contain coords");const t=Tw.getNonNullable(e).coords.map(this.coordEncoder.decodeNumber);return TK.of(t).get()}};const IK=SZ.disjunction3(bK.encoder,OK.encoder,TK.encoder,e=>e.isDrop(),e=>e.isSimple());class kK extends mj{constructor(){super(SK)}static get(){return kK.singleton.isAbsent()&&(kK.singleton=Nw.of(new kK)),kK.singleton.get()}applyLegalMove(e,t,n){const r=t.getCopiedBoard();if(e.isDrop())r[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(e.isSimple())r[e.coord.y][e.coord.x]=IZ.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer();else{const n=e.getStartingCoord(),i=e.getEndingCoord();r[n.y][n.x]=IZ.NONE,r[i.y][i.x]=t.getCurrentPlayer()}return new SK(r,t.turn+1)}isLegal(e,t){return e.isDrop()?this.dropLegality(e,t):e.isSimple()?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}dropLegality(e,t){return t.turn>=40?Rw.failure(PK.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord).isPlayer()?Rw.failure(JW.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?Rw.failure(PK.MUST_DROP_IN_CENTRAL_ZONE()):Rw.success(void 0)}simpleMoveLegality(e,t){return t.turn<40?Rw.failure(PK.CANNOT_MOVE_BEFORE_TURN_40()):t.getPieceAt(e.coord)!==t.getCurrentPlayer()?Rw.failure(JW.MUST_CHOOSE_PLAYER_PIECE()):t.getPieceAt(e.end).isPlayer()?Rw.failure(JW.MUST_LAND_ON_EMPTY_SPACE()):Rw.success(void 0)}jumpLegality(e,t){if(t.turn<40)return Rw.failure(PK.CANNOT_MOVE_BEFORE_TURN_40());if(t.getPieceAt(e.getStartingCoord())!==t.getCurrentPlayer())return Rw.failure(JW.MUST_CHOOSE_PLAYER_PIECE());for(const n of e.getJumpedOverCoords())if(t.getPieceAt(n)===IZ.NONE)return Rw.failure(PK.MUST_JUMP_OVER_PIECES());for(const n of e.getLandingCoords())if(t.getPieceAt(n).isPlayer())return Rw.failure(JW.MUST_LAND_ON_EMPTY_SPACE());return Rw.success(void 0)}jumpTargetsFrom(e){const t=[new GW(e.x+2,e.y),new GW(e.x-2,e.y),new GW(e.x,e.y+2),new GW(e.x,e.y-2),new GW(e.x+2,e.y+2),new GW(e.x+2,e.y-2),new GW(e.x-2,e.y+2),new GW(e.x-2,e.y-2)],n=[];for(const r of t)TK.of([e,r]).isSuccess()&&n.push(r);return n}nextJumps(e,t){const n=e.getEndingCoord(),r=[];for(const i of this.jumpTargetsFrom(n)){const n=e.addJump(i);n.isSuccess()&&this.jumpLegality(n.get(),t).isSuccess()&&r.push(n.get())}return r}jumpHasPossibleNextTargets(e,t){return this.nextJumps(e,t).length>0}getGameStatus(e){const t=e.gameState,n=[0,0];for(const r of SK.ALL_SHELTERS){const e=t.getPieceAt(r);if(e.isPlayer()&&(n[e.value]+=1,20===n[e.value]))return gj.getVictory(e)}return gj.ONGOING}}kK.singleton=Nw.empty();class AK extends ej{getListMoves(e){return e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState)}getListMovesDrop(e){const t=[],n=SK.CENTRAL_ZONE_TOP_LEFT,r=SK.CENTRAL_ZONE_BOTTOM_RIGHT;for(let i=n.y;i<=r.y;i++)for(let s=n.x;s<=r.x;s++)e.getPieceAtXY(s,i)===IZ.NONE&&t.push(bK.of(new GW(s,i)).get());return t}getListMovesAfterDrop(e){let t=[];const n=e.getCurrentPlayer();for(let r=0;r<SK.HEIGHT;r++)for(let i=0;i<SK.WIDTH;i++){const s=new GW(i,r);e.getPieceAt(s)===n&&(t=t.concat(this.getListSimpleMoves(e,s)),t=t.concat(this.getListJumps(e,s)))}return t}getListSimpleMoves(e,t){const n=[],r=[new GW(t.x+1,t.y),new GW(t.x-1,t.y),new GW(t.x,t.y+1),new GW(t.x,t.y-1),new GW(t.x+1,t.y+1),new GW(t.x+1,t.y-1),new GW(t.x-1,t.y+1),new GW(t.x-1,t.y-1)];for(const i of r){const r=OK.of(t,i);r.isSuccess()&&kK.get().simpleMoveLegality(r.get(),e).isSuccess()&&n.push(r.get())}return n}getListJumps(e,t){const n=new rj;for(const r of kK.get().jumpTargetsFrom(t)){const i=TK.of([t,r]).get();kK.get().jumpLegality(i,e).isSuccess()&&(n.add(i),n.union(this.getListJumpStartingFrom(e,i)))}return n.toList()}getListJumpStartingFrom(e,t){const n=kK.get().nextJumps(t,e),r=new rj(n);for(const i of n)r.union(this.getListJumpStartingFrom(e,i));return r}getBoardValue(e){const t=e.gameState;let n=0;const r=new hj([{key:TZ.ZERO,value:0},{key:TZ.ONE,value:0}]);for(let i=0;i<SK.HEIGHT;i++)for(let e=0;e<SK.WIDTH;e++){const s=new GW(e,i),o=t.getPieceAt(s);if(o.isPlayer())if(t.isShelter(s)){if(n+=20*o.getScoreModifier(),r.replace(o,r.get(o).get()+1),20===r.get(o).get())return new tj(o.getVictoryValue())}else{let e=100;for(const n of SK.ALL_SHELTERS)if(t.getPieceAt(n)===IZ.NONE){const t=s.getOrthogonalDistance(n);e=Math.min(e,t)}n-=o.getScoreModifier()*e}}return new tj(n)}}const MK=IZ.NONE,NK=IZ.ZERO,RK=IZ.ONE;class xK{constructor(){this.tutorial=[_j.informational($localize`Board and aim of the game`,$localize`Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially.`,SK.getInitialState()),_j.anyMove($localize`Initial phase`,$localize`In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>Drop one of your piece in the central zone.`,SK.getInitialState(),bK.of(new GW(7,7)).get(),$localize`Congratulations!`),_j.fromPredicate($localize`Simple move`,$localize`Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move.`,new SK([[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,NK,NK,RK,RK,NK,NK,RK,NK,RK,MK,MK,MK,MK],[MK,MK,MK,MK,NK,RK,NK,RK,NK,NK,NK,NK,RK,MK,MK,MK,MK],[MK,MK,MK,MK,NK,RK,MK,MK,MK,MK,MK,RK,NK,MK,MK,MK,MK],[MK,MK,MK,MK,RK,NK,NK,RK,RK,RK,NK,NK,NK,MK,MK,MK,MK],[MK,MK,MK,MK,RK,NK,RK,RK,RK,RK,RK,RK,NK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK]],40),OK.of(new GW(4,6),new GW(3,5)).get(),(e,t,n)=>e.isSimple()?Lw.SUCCESS:Lw.failure($localize`You have made a jump, not a simple move. Try again!`),$localize`Congratulations!`),_j.fromPredicate($localize`Jumps`,$localize`The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful).`,new SK([[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,NK,NK,RK,RK,NK,NK,RK,NK,RK,MK,MK,MK,MK],[MK,MK,MK,MK,NK,RK,NK,RK,NK,NK,NK,NK,RK,MK,MK,MK,MK],[MK,MK,MK,MK,NK,RK,MK,MK,MK,MK,MK,RK,NK,MK,MK,MK,MK],[MK,MK,MK,MK,RK,NK,NK,RK,RK,RK,NK,NK,NK,MK,MK,MK,MK],[MK,MK,MK,MK,RK,NK,RK,RK,RK,RK,RK,RK,NK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK]],40),TK.of([new GW(6,7),new GW(6,5)]).get(),(e,t,n)=>e.isJump()?Lw.SUCCESS:Lw.failure($localize`You have not performed a jump. Try again!`),$localize`Congratulations!`),_j.fromMove($localize`Chaining jumps in a single move`,$localize`Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it.`,new SK([[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,RK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,RK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,RK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,NK,NK,MK,RK,NK,NK,RK,NK,RK,MK,MK,MK,MK],[MK,MK,MK,MK,NK,MK,NK,RK,NK,NK,NK,NK,RK,MK,MK,MK,MK],[MK,MK,MK,MK,NK,RK,MK,MK,MK,MK,MK,RK,NK,MK,MK,MK,MK],[MK,MK,MK,MK,RK,NK,NK,RK,RK,RK,NK,NK,NK,MK,MK,MK,MK],[MK,MK,MK,MK,RK,NK,RK,RK,RK,RK,RK,RK,NK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK],[MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK,MK]],40),[TK.of([new GW(8,6),new GW(6,4),new GW(6,2),new GW(6,0)]).get()],$localize`Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does.`,$localize`You have not performed a triple jump. Try again!`)]}}function DK(e,t){if(1&e){const e=va();_n(),fa(0,"rect",9),Ea("click",function(){Gt(e);const t=Sa().$implicit;return Sa(2).onClick(t.coord)}),pa()}if(2&e){const e=Sa().$implicit,t=Sa(2);ra("x",1.5*t.STROKE_WIDTH+t.SPACE_SIZE*e.coord.x+t.STROKE_WIDTH)("y",1.5*t.STROKE_WIDTH+t.SPACE_SIZE*e.coord.y+t.STROKE_WIDTH)("width",t.SPACE_SIZE-3*t.STROKE_WIDTH)("height",t.SPACE_SIZE-3*t.STROKE_WIDTH)}}function LK(e,t){if(1&e){const e=va();_n(),fa(0,"circle",6),Ea("click",function(){Gt(e);const t=Sa().$implicit;return Sa(2).onClick(t.coord)}),pa()}if(2&e){const e=Sa(),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();Ia("id","piece_",t,"_",r,""),ha("ngClass",n.pieceClasses),ra("r",i.PIECE_RADIUS)("cx",i.SPACE_SIZE*t+i.STROKE_WIDTH+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.STROKE_WIDTH+i.SPACE_SIZE/2)}}function FK(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",6),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).onClick(t.coord)}),pa(),la(2,DK,1,4,"rect",7),la(3,LK,1,6,"circle",8),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();Ts(1),Ia("id","click_",n,"_",r,""),ha("ngClass",e.squareClasses),ra("x",i.SPACE_SIZE*n+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),Ts(1),ha("ngIf",e.isShelter),Ts(1),ha("ngIf",e.hasPiece)}}function UK(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,FK,4,9,"g",1),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}function VK(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",10),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t)}),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa();Ts(1),ha("ngClass",n.viewInfo.boardInfo[e.y][e.x].shelterClasses),ra("x",n.SPACE_SIZE*e.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*e.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function BK(e,t){if(1&e&&(_n(),ga(0,"circle",11)),2&e){const e=t.$implicit,n=Sa();Ta("id","sidePiece_0_",e,""),ra("cx",-n.PIECE_RADIUS)("cy",1670-e*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function $K(e,t){if(1&e&&(_n(),ga(0,"circle",12)),2&e){const e=t.$implicit,n=Sa();Ta("id","sidePiece_1_",e,""),ra("cx",1715+n.PIECE_RADIUS)("cy",1670-e*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function zK(e,t){if(1&e&&(_n(),ga(0,"rect",13)),2&e){const e=Sa();ra("x",e.SPACE_SIZE*e.CENTRAL_ZONE_START.x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.CENTRAL_ZONE_START.y+e.STROKE_WIDTH)("width",e.CENTRAL_ZONE_SIZE.x*e.SPACE_SIZE)("height",e.CENTRAL_ZONE_SIZE.y*e.SPACE_SIZE)}}let HK=(()=>{class e extends ZW{constructor(e){super(e),this.ALL_SHELTERS=SK.ALL_SHELTERS,this.CENTRAL_ZONE_START=SK.CENTRAL_ZONE_TOP_LEFT,this.CENTRAL_ZONE_SIZE=new UW(SK.CENTRAL_ZONE_BOTTOM_RIGHT.x-SK.CENTRAL_ZONE_TOP_LEFT.x+1,SK.CENTRAL_ZONE_BOTTOM_RIGHT.y-SK.CENTRAL_ZONE_TOP_LEFT.y+1),this.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},this.selected=Nw.empty(),this.jumpInConstruction=Nw.empty(),this.PIECE_RADIUS=this.SPACE_SIZE/2-this.STROKE_WIDTH,this.rules=kK.get(),this.availableMinimaxes=[new AK(this.rules,"ConspirateursMinimax")],this.encoder=IK,this.tutorial=(new xK).tutorial}ngOnInit(){this.updateBoard()}updateBoard(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}updateViewInfo(){const e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(let t=0;t<SK.HEIGHT;t++){this.viewInfo.boardInfo.push([]);for(let n=0;n<SK.WIDTH;n++){const r=new GW(n,t),i=e.getPieceAt(r),s={coord:r,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(i)],hasPiece:i.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[t].push(s)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}updateOccupiedShelters(){for(const e of SK.ALL_SHELTERS){const t=this.viewInfo.boardInfo[e.y][e.x];t.isShelter=!0,t.hasPiece&&t.shelterClasses.push("highlighted")}}updateSelected(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){const e=this.jumpInConstruction.get(),t=e.getStartingCoord(),n=e.getEndingCoord();this.viewInfo.boardInfo[t.y][t.x].hasPiece=!1,this.viewInfo.boardInfo[n.y][n.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected"],this.viewInfo.boardInfo[n.y][n.x].hasPiece=!0;for(const r of e.coords)this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved")}else{const e=this.selected.get();this.viewInfo.boardInfo[e.y][e.x].pieceClasses.push("selected")}}updateVictory(){const e=this.getState(),t=kK.get().getGameStatus(this.rules.node);if(!0===t.isEndGame)for(const n of SK.ALL_SHELTERS)e.getPieceAt(n)===t.winner&&this.viewInfo.boardInfo[n.y][n.x].squareClasses.push("victory")}showLastMove(){const e=this.rules.node.move.get();if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved");else if(e.isSimple())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved"),this.viewInfo.boardInfo[e.end.y][e.end.x].squareClasses.push("moved");else{this.viewInfo.lastMoveArrow="";for(const t of e.coords)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("moved"),this.viewInfo.lastMoveArrow+=t.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=t.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}cancelMoveAttempt(){this.jumpInConstruction=Nw.empty(),this.selected=Nw.empty(),this.updateBoard()}onClick(e){var t=this;return Ow(function*(){const n=t.canUserPlay("#click_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());const r=t.getState();if(r.getPieceAt(e)===t.getCurrentPlayer())return t.selected=Nw.of(e),t.jumpInConstruction=Nw.empty(),t.updateViewInfo(),Lw.SUCCESS;if(t.jumpInConstruction.isPresent())return t.constructJump(e);if(t.selected.isPresent())return t.selectNextCoord(e);if(r.isDropPhase()){const n=bK.of(e);return hZ(n.isSuccess(),"ConspirateursMove should be valid by construction"),t.chooseMove(n.get(),r)}return t.cancelMove(JW.MUST_CHOOSE_PLAYER_PIECE())})()}constructJump(e){var t=this;return Ow(function*(){const n=t.jumpInConstruction.get(),r=t.getState();if(e.equals(n.getEndingCoord()))return t.chooseMove(n,r);{const i=n.addJump(e);if(i.isFailure())return t.cancelMove(i.getReason());const s=t.rules.jumpLegality(i.get(),r);return s.isFailure()?t.cancelMove(s.getReason()):t.updateJump(i.get())}})()}updateJump(e){var t=this;return Ow(function*(){const n=t.getState();return t.rules.jumpHasPossibleNextTargets(e,n)?(t.jumpInConstruction=Nw.of(e),t.updateViewInfo(),Lw.SUCCESS):t.chooseMove(e,n)})()}selectNextCoord(e){var t=this;return Ow(function*(){const n=t.selected.get(),r=OK.of(n,e);if(r.isSuccess())return t.chooseMove(r.get(),t.getState());{const r=TK.of([n,e]);return r.isFailure()?t.cancelMove(r.getReason()):t.updateJump(r.get())}})()}}return e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-conspirateurs"]],features:[Go],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1",3,"id",4,"ngFor","ngForOf"],["class","base no-fill highlighted mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0",3,"id"],[1,"base","mid-stroke","player1",3,"id"],[1,"base","no-fill","highlighted","mid-stroke"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,UK,2,1,"g",1),la(2,VK,2,5,"g",1),la(3,BK,1,4,"circle",2),la(4,$K,1,4,"circle",3),la(5,zK,1,4,"rect",4),ga(6,"polyline",5),pa()),2&e&&(Ts(1),ha("ngForOf",t.viewInfo.boardInfo),Ts(1),ha("ngForOf",t.ALL_SHELTERS),Ts(1),ha("ngForOf",t.range(t.viewInfo.sidePieces[0])),Ts(1),ha("ngForOf",t.range(t.viewInfo.sidePieces[1])),Ts(1),ha("ngIf",t.viewInfo.dropPhase),Ts(1),ra("points",t.viewInfo.lastMoveArrow))},directives:[tf,rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class GK{constructor(e,t){this.owner=e,this.otherPieceType=t}static of(e,t){return e===TZ.ZERO?t?GK.ZERO_SECOND:GK.ZERO_FIRST:e===TZ.ONE?t?GK.ONE_SECOND:GK.ONE_FIRST:GK.EMPTY}toString(){return`DiamPiece(${this.owner}, ${this.otherPieceType})`}}GK.encoder=bZ.tuple([TZ.numberEncoder,bZ.booleanEncoder],e=>[e.owner,e.otherPieceType],e=>GK.of(e[0],e[1])),GK.EMPTY=new GK(IZ.NONE,!1),GK.ZERO_FIRST=new GK(TZ.ZERO,!1),GK.ZERO_SECOND=new GK(TZ.ZERO,!0),GK.ONE_FIRST=new GK(TZ.ONE,!1),GK.ONE_SECOND=new GK(TZ.ONE,!0),GK.PLAYER_PIECES=[GK.ZERO_FIRST,GK.ZERO_SECOND,GK.ONE_FIRST,GK.ONE_SECOND];class ZK extends aj{constructor(e,t){if(super(),this.target=e,this.piece=t,t===GK.EMPTY)throw new Error("Cannot drop an empty piece")}isDrop(){return!0}getTarget(){return this.target}equals(e){return!(this.target!==e.target||this.piece!==e.piece)}toString(){return`DiamMoveDrop(${this.target}, ${this.piece})`}}ZK.encoder=bZ.tuple([bZ.numberEncoder(7),GK.encoder],e=>[e.target,e.piece],e=>new ZK(e[0],e[1]));class qK extends aj{constructor(e,t){super(),this.start=e,this.moveDirection=t}static fromRepresentation(e,t){return new qK(new GW(e.x,3-e.y),t)}isDrop(){return!1}getTarget(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}equals(e){return!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}toString(){return`DiamMoveShift(${this.start}, ${this.moveDirection})`}}qK.encoder=bZ.tuple([GW.numberEncoder(8,4),bZ.booleanEncoder],e=>[e.start,"clockwise"===e.moveDirection],e=>new qK(e[0],e[1]?"clockwise":"counterclockwise"));const WK=bZ.disjunction(ZK.encoder,qK.encoder,e=>e.isDrop());let jK=(()=>{class e{}return e.NO_MORE_PIECES_OF_THIS_TYPE=()=>$localize`You do not have any pieces of this type anymore.`,e.SPACE_IS_FULL=()=>$localize`You cannot play here: this space is already full.`,e.TARGET_STACK_TOO_HIGH=()=>$localize`You cannot add more pieces to the target stack, as it will contain more than 4 pieces.`,e.MUST_SHIFT_TO_NEIGHBOR=()=>$localize`To perform a shift, you must move the pieces to a neighboring space.`,e.MUST_SELECT_PIECE_FIRST=()=>$localize`You must first select either a piece from the side, or a stack of pieces to shift on the board.`,e})(),YK=(()=>{class e extends sj{constructor(e,t,n){super(e,n),this.remainingPieces=t}static getInitialState(){const t=GK.EMPTY;return new e([[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t]],[4,4,4,4],0)}static fromRepresentation(t,n){const r=t.reverse(),i=[4,4,4,4];for(let s=0;s<e.HEIGHT;s++)for(let t=0;t<e.WIDTH;t++){const n=r[s][t];r[s][t]!==GK.EMPTY&&i[e.pieceIndex(n)]--}return hZ(i.every(e=>e>=0),"Invalid DiamState representation uses too many pieces"),new e(r,i,n)}static pieceIndex(e){switch(e){case GK.ZERO_FIRST:return 0;case GK.ZERO_SECOND:return 1;case GK.ONE_FIRST:return 2;default:return Tw.expectToBe(e,GK.ONE_SECOND),3}}getRemainingPiecesOf(t){return this.remainingPieces[e.pieceIndex(t)]}getStackHeight(t){let n=0;for(let r=0;r<e.HEIGHT&&this.getPieceAtXY(t,r)!==GK.EMPTY;r++)n++;return n}}return e.WIDTH=8,e.HEIGHT=4,e})();class KK extends mj{constructor(){super(YK)}static get(){return KK.singleton.isAbsent()&&(KK.singleton=Nw.of(new KK)),KK.singleton.get()}applyLegalMove(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}applyLegalDrop(e,t){const n=NZ.copyBiArray(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;const r=NZ.copyImmutableArray(t.remainingPieces);return r[YK.pieceIndex(e.piece)]-=1,new YK(n,r,t.turn+1)}applyLegalShift(e,t){const n=NZ.copyBiArray(t.board),r=e.getTarget();let i=t.getStackHeight(r),s=e.start.y;for(;s<YK.HEIGHT&&t.getPieceAtXY(e.start.x,s)!==GK.EMPTY;)n[i][r]=t.getPieceAtXY(e.start.x,s),n[s][e.start.x]=GK.EMPTY,i++,s++;return new YK(n,t.remainingPieces,t.turn+1)}isLegal(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}isDropLegal(e,t){return e.piece.owner!==t.getCurrentPlayer()?Rw.failure(JW.MUST_CHOOSE_PLAYER_PIECE()):0===t.getRemainingPiecesOf(e.piece)?Rw.failure(jK.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}dropHeightValidity(e,t){return t.getStackHeight(e.target)===YK.HEIGHT?Rw.failure(jK.SPACE_IS_FULL()):Rw.success(void 0)}isShiftLegal(e,t){return t.getPieceAt(e.start).owner!==t.getCurrentPlayer()?Rw.failure(JW.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(e,t)}shiftHeightValidity(e,t){const n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>YK.HEIGHT?Rw.failure(jK.TARGET_STACK_TOO_HIGH()):Rw.success(void 0)}getGameStatus(e){const t=this.findHighestAlignment(e.gameState);if(t.isPresent()){const n=e.gameState.getPieceAt(t.get());return hZ(n.owner.isPlayer(),"highest alignment is owned by a player"),gj.getVictory(n.owner)}return gj.ONGOING}findHighestAlignment(e){for(let t=0;t<YK.WIDTH/2;t++)for(let n=YK.HEIGHT-1;n>0;n--){const r=e.getPieceAtXY(t,n),i=e.getPieceAtXY(t+YK.WIDTH/2,n);if(r!==GK.EMPTY&&r===i)return Nw.of(new GW(t,n))}return Nw.empty()}pieceCanMove(e,t){return!!this.isShiftLegal(new qK(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new qK(t,"counterclockwise"),e).isSuccess()}}KK.singleton=Nw.empty();class QK extends ej{getListMoves(e){const t=e.gameState,n=this.getListDrops(t),r=this.getListShifts(t);return n.concat(r)}getListShifts(e){const t=[],n=this.getShiftSources(e);for(const r of n)for(const n of[new qK(r,"clockwise"),new qK(r,"counterclockwise")])KK.get().shiftHeightValidity(n,e).isSuccess()&&t.push(n);return t}getListDrops(e){const t=this.getRemainingPiecesForCurrentPlayer(e),n=[];for(let r=0;r<YK.WIDTH;r++)for(const i of t){const t=new ZK(r,i);KK.get().dropHeightValidity(t,e).isSuccess()&&n.push(t)}return n}getRemainingPiecesForCurrentPlayer(e){const t=[];for(const n of GK.PLAYER_PIECES)this.currentPlayerCanDropPiece(e,n)&&t.push(n);return t}currentPlayerCanDropPiece(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}getShiftSources(e){const t=[],n=e.getCurrentPlayer();for(let r=0;r<YK.HEIGHT;r++)for(let i=0;i<YK.WIDTH;i++)e.getPieceAtXY(i,r).owner===n&&t.push(new GW(i,r));return t}getBoardValue(e){const t=KK.get().getGameStatus(e);return new tj(t.isEndGame?t.toBoardValue():0)}}const XK=GK.EMPTY,JK=GK.ZERO_FIRST,eQ=GK.ZERO_SECOND,tQ=GK.ONE_FIRST,nQ=GK.ONE_SECOND;class rQ{constructor(){this.tutorial=[_j.informational($localize`Initial board and player pieces`,$localize`Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right.`,YK.getInitialState()),_j.fromMove($localize`Goal of the game`,$localize`At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>Do it!`,YK.fromRepresentation([[XK,XK,XK,XK,XK,XK,XK,XK],[XK,XK,XK,XK,XK,XK,XK,XK],[XK,XK,XK,XK,tQ,XK,XK,XK],[JK,XK,XK,XK,JK,XK,XK,XK]],3),[new ZK(0,GK.ONE_FIRST)],$localize`Congratulations, you won!`,$localize`Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board.`),_j.fromMove($localize`Types of move`,$localize`You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more  than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board.`,YK.fromRepresentation([[XK,XK,XK,XK,XK,XK,XK,XK],[XK,XK,XK,XK,nQ,XK,XK,XK],[XK,XK,XK,XK,JK,XK,XK,XK],[tQ,XK,XK,XK,eQ,XK,XK,XK]],4),[qK.fromRepresentation(new GW(4,3),"counterclockwise"),qK.fromRepresentation(new GW(4,3),"clockwise"),qK.fromRepresentation(new GW(4,2),"counterclockwise"),qK.fromRepresentation(new GW(4,2),"clockwise")],$localize`Congratulations!`,$localize`Failed, try to move one of your piece that is already on the board.`),_j.fromMove($localize`Special case`,$localize`It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!`,YK.fromRepresentation([[XK,XK,XK,XK,JK,XK,XK,XK],[XK,XK,XK,XK,nQ,XK,XK,JK],[XK,XK,XK,XK,JK,XK,XK,nQ],[XK,tQ,XK,XK,eQ,XK,XK,tQ]],8),[qK.fromRepresentation(new GW(4,2),"counterclockwise")],$localize`Congratulations!`,$localize`Failed, try to shift a stack of pieces to the left.`)]}}function iQ(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"path",6),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onSpaceClick(t)}),pa(),fa(2,"path",7),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onSpaceClick(t)}),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa();Ts(1),Ta("id","click_",e,""),ha("ngClass",n.viewInfo.boardInfo[e].spaceClasses),ra("d",n.BOARD_PATHS[e]),Ts(1),ha("ngClass",n.viewInfo.boardInfo[e].spaceClasses),ra("d",n.DECORATION_PATHS[e])}}function sQ(e,t){if(1&e){const e=va();_n(),fa(0,"g",9),Ea("click",function(){const t=Gt(e).$implicit,n=Sa().$implicit;return Sa().onPieceInGameClick(n,t.y)}),ga(1,"use",10),ga(2,"use",11),pa()}if(2&e){const e=t.$implicit;Ia("id","click_",Sa().$implicit,"_",e.y,""),ha("ngClass",e.foregroundClasses),Ts(1),ha("ngClass",e.backgroundClasses),ra("x",e.drawPosition.x)("y",e.drawPosition.y),Ts(1),ra("x",e.drawPosition.x)("y",e.drawPosition.y)}}function oQ(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,sQ,3,8,"g",8),pa()),2&e){const e=t.$implicit,n=Sa();Ts(1),ha("ngForOf",n.viewInfo.boardInfo[e].pieces)}}function aQ(e,t){if(1&e){const e=va();_n(),fa(0,"g",12),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onRemainingPieceClick(t.actualPiece)}),ga(1,"use",10),ga(2,"use",11),pa()}if(2&e){const e=t.$implicit;Ia("id","piece_",e.actualPiece.owner.value,"_",e.actualPiece.otherPieceType?1:0,""),ha("ngClass",e.foregroundClasses),Ts(1),ha("ngClass",e.backgroundClasses),ra("x",e.drawPosition.x)("y",e.drawPosition.y),Ts(1),ra("x",e.drawPosition.x)("y",e.drawPosition.y)}}const lQ=function(){return[0,1,2,3,4,5,6,7]},cQ=function(){return[2,1,3,0,4,7,5,6]};class uQ extends ZW{constructor(e){super(e),this.BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],this.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],this.selected=Nw.empty(),this.viewInfo={boardInfo:[],remainingPieces:[]},this.rules=KK.get(),this.availableMinimaxes=[new QK(this.rules,"DiamDummyMinimax")],this.encoder=WK,this.tutorial=(new rQ).tutorial}ngOnInit(){this.updateBoard()}onSpaceClick(e){var t=this;return Ow(function*(){const n=t.canUserPlay("#click_"+e);return n.isFailure()?t.cancelMove(n.getReason()):t.onSpaceClickAfterCheck(e)})()}onSpaceClickAfterCheck(e){var t=this;return Ow(function*(){if(t.selected.isPresent()){const n=t.selected.get();let r;if("pieceFromReserve"===n.type)r=new ZK(e,n.piece);else if((n.position.x+1)%YK.WIDTH===e)r=new qK(n.position,"clockwise");else{if((n.position.x+(YK.WIDTH-1))%YK.WIDTH!==e)return t.cancelMove(jK.MUST_SHIFT_TO_NEIGHBOR());r=new qK(n.position,"counterclockwise")}return t.chooseMove(r,t.getState())}return t.cancelMove(jK.MUST_SELECT_PIECE_FIRST())})()}onPieceInGameClick(e,t){var n=this;return Ow(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);return r.isFailure()?n.cancelMove(r.getReason()):n.getState().getPieceAtXY(e,t).owner===n.getCurrentPlayer()?(n.selected=Nw.of({type:"pieceFromBoard",position:new GW(e,t)}),n.updateViewInfo(),Lw.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(JW.MUST_CHOOSE_PLAYER_PIECE())})()}onRemainingPieceClick(e){var t=this;return Ow(function*(){const n=t.canUserPlay(t.getPieceId(e));return n.isFailure()?t.cancelMove(n.getReason()):e.owner===t.getCurrentPlayer()?(t.selected=Nw.of({type:"pieceFromReserve",piece:e}),t.updateViewInfo(),Lw.SUCCESS):t.cancelMove(JW.MUST_CHOOSE_PLAYER_PIECE())})()}getPieceId(e){return"#piece_"+e.owner.value+"_"+(e.otherPieceType?1:0)}updateBoard(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}getLastMovedFromDrop(e,t){const n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),r=e.getTarget(),i=t.getStackHeight(e.getTarget()),s=this.getDrawPositionOnBoard(r,i),o=new GW(r,i);return[{start:Nw.empty(),end:o,startDrawPosition:n,endDrawPosition:s}]}getLastMovedFromShift(e,t){const n=e.start.x,r=e.getTarget();let i=t.getStackHeight(r);const s=[];for(let o=e.start.y;o<YK.HEIGHT&&t.getPieceAtXY(n,o)!==GK.EMPTY;o++,i++)s.push({start:Nw.of(new GW(n,o)),end:new GW(r,i),startDrawPosition:this.getDrawPositionOnBoard(n,o),endDrawPosition:this.getDrawPositionOnBoard(r,i)});return s}updateViewInfo(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}updateBoardInfo(){for(let e=0;e<YK.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}showLastMove(){this.showLastMoveOnSpaces(),this.showLastMoveOnPieces()}showLastMoveOnSpaces(){const e=this.rules.node.move;hZ(e.isPresent(),"showLastMoveOnSpaces called without a last move");const t=e.get();for(let n=0;n<YK.WIDTH;n++){const e=[];t.isDrop()?t.getTarget()===n&&e.push("moved"):(t.getTarget()===n||t.start.x===n)&&e.push("moved"),this.viewInfo.boardInfo[n].spaceClasses=e}}showLastMoveOnPieces(){const e=this.rules.node.move;hZ(e.isPresent(),"showLastMoveOnPieces called without a last move");const t=e.get(),n=this.getPreviousState();let r=[];r=t.isDrop()?this.getLastMovedFromDrop(t,n):this.getLastMovedFromShift(t,n);for(const i of r)this.viewInfo.boardInfo[i.end.x].pieces[i.end.y].foregroundClasses.push("last-move")}updateRemainingPiecesInfo(){const e=this.getCurrentPlayer();this.viewInfo.remainingPieces=[];const t=this.isPlayerTurn();for(const n of GK.PLAYER_PIECES){const r=this.getState().getRemainingPiecesOf(n);for(let i=0;i<r;i++){const s=[];this.isTopPieceOfReserveAndSelected(i,r,n)&&s.push("selected"),t&&i===r-1&&n.owner===e&&s.push("clickable-hover"),this.viewInfo.remainingPieces.push({backgroundClasses:["player"+n.owner.value+(n.otherPieceType?"-alternate":"")],foregroundClasses:s,y:i,drawPosition:this.getDrawPositionRemainingPiece(n,i),actualPiece:n})}}}isTopPieceOfReserveAndSelected(e,t,n){if(this.selected.isPresent()){const r=this.selected.get();return"pieceFromReserve"===r.type&&r.piece===n&&e===t-1}return!1}getDrawPositionRemainingPiece(e,t){let n,r;return n=e.owner===TZ.ZERO?-100:600,r=e.otherPieceType?100:450,new GW(n,r).getNext(new UW(0,-t*uQ.PIECE_HEIGHT))}getPieces(e){const t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),r=[];for(let i=0;i<YK.HEIGHT;i++){const s=this.getState().getPieceAtXY(e,i),o=new GW(e,i);if(s!==GK.EMPTY){const a=[];this.pieceFromBoardIsSelected(e,i)&&a.push("selected"),this.isVictory(e,i,t)&&a.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),o)&&a.push("clickable-hover"),r.push({backgroundClasses:["player"+s.owner.value+(s.otherPieceType?"-alternate":"")],foregroundClasses:a,y:i,drawPosition:this.getDrawPositionOnBoard(e,i),actualPiece:s})}}return r}pieceFromBoardIsSelected(e,t){if(this.selected.isPresent()){const n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}isVictory(e,t,n){if(n.isPresent()){const r=n.get();return r.x%4==e%4&&r.y===t}return!1}getDrawPositionOnBoard(e,t){return uQ.CENTER[e].getNext(new UW(0,-t*uQ.PIECE_HEIGHT))}cancelMoveAttempt(){this.selected=Nw.empty(),this.updateBoard()}}uQ.CENTER=[new GW(40,160),new GW(100,50),new GW(255,2),new GW(400,50),new GW(460,160),new GW(400,270),new GW(255,320),new GW(100,270)],uQ.PIECE_HEIGHT=36,uQ.\u0275fac=function(e){return new(e||uQ)(ua(cZ))},uQ.\u0275cmp=Je({type:uQ,selectors:[["app-diam"]],features:[Go],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 1.4319358,16.913484 V 49.329973 H 1.482219 A 39.498175,14.141265 0 0 0 40.938372,63.011675 39.498175,14.141265 0 0 0 80.394523,49.329973 h 0.06885 V 16.913484 h -0.02864 A 39.769348,14.114049 0 0 1 40.941466,29.431707 39.769348,14.114049 0 0 1 1.4481812,16.913484 Z"],["cx","40.952408","cy","15.225397","rx","39.769348","ry","14.11405"],[4,"ngFor","ngForOf"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),fa(1,"defs"),fa(2,"g",1),ga(3,"path",2),ga(4,"ellipse",3),pa(),pa(),la(5,iQ,3,5,"g",4),la(6,oQ,2,1,"g",4),la(7,aQ,3,8,"g",5),pa()),2&e&&(Ts(5),ha("ngForOf",wu(3,lQ)),Ts(1),ha("ngForOf",wu(4,cQ)),Ts(1),ha("ngForOf",t.viewInfo.remainingPieces))},directives:[tf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class hQ{constructor(e,t){this.offset=e,this.constant=t}static fromTwoCoords(e,t){const n=e.x,r=t.x,i=e.y,s=t.y,o=n+i,a=r+s;return n===r&&i!==s&&o!==a?Nw.of(hQ.constantQ(n)):n!==r&&i===s&&o!==a?Nw.of(hQ.constantR(i)):n!==r&&i!==s&&o===a?Nw.of(hQ.constantS(o)):Nw.empty()}static constantQ(e){return new hQ(e,"q")}static constantR(e){return new hQ(e,"r")}static constantS(e){return new hQ(e,"s")}static areOnSameLine(e){if(e.length<2)return!0;const t=hQ.fromTwoCoords(e[0],e[1]);if(t.isAbsent())return!1;const n=t.get();for(const r of e.slice(2))if(!1===n.contains(r))return!1;return!0}toString(){return`Line(${this.constant}, ${this.offset})`}equals(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}contains(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}getDirection(){switch(this.constant){case"q":return jW.DOWN;case"r":return jW.RIGHT;case"s":return jW.DOWN_LEFT}}}class dQ extends sj{constructor(e,t,n,r,i,s){super(t,e),this.board=t,this.width=n,this.height=r,this.excludedCases=i,this.empty=s,hZ(this.excludedCases.length<this.height/2+1,"Invalid excluded cases specification for HexagonalGameState.")}static neighbors(e,t){return[new GW(e.x+t,e.y-t),new GW(e.x+t,e.y),new GW(e.x-t,e.y+t),new GW(e.x-t,e.y),new GW(e.x,e.y+t),new GW(e.x,e.y-t)]}setAt(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}equalsT(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedCases.length!==e.excludedCases.length)return!1;for(let n=0;n<this.excludedCases.length;n++)if(this.excludedCases[n]!==e.excludedCases[n])return!1;for(const n of this.allCoords())if(!1===t(this.getPieceAt(n),e.getPieceAt(n)))return!1;return!0}allCoords(){const e=[];return this.forEachCoord(t=>{e.push(t)}),e}allLines(){const e=[];for(let t=0;t<this.width;t++)e.push(hQ.constantQ(t));for(let t=0;t<this.height;t++)e.push(hQ.constantR(t));for(let t=this.excludedCases.length;t<this.height+this.excludedCases.length;t++)e.push(hQ.constantS(t));return e}getEntranceOnLine(e){let t,n;switch(e.constant){case"q":return n=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new GW(e.offset,n));case"r":return t=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new GW(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new GW(e.offset,0):new GW(this.width-1,e.offset-this.width+1))}}findEntranceFrom(e,t){const n=e.getDirection();let r=t;for(let s=0;s<Math.max(this.width,this.height);s++){if(this.isOnBoard(r))return r;r=r.getNext(n)}const i=uZ.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(i.getReason())}}class fQ{constructor(e,t,n){this.owner=e,this.size=t,this.source=n}static append(e,t){return new fQ(e.owner,e.size+t.size,e.source||t.source)}getValue(){return fQ.encoder.encodeNumber(this)}getOwner(){return this.owner}belongsTo(e){return this.owner===e}containsSource(){return this.source}isEmpty(){return 0===this.size}getSize(){return this.size}toString(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}}fQ.sizeEncoder=bZ.numberEncoder(49),fQ.encoder=bZ.tuple([bZ.booleanEncoder,TZ.numberEncoder,fQ.sizeEncoder],e=>[e.source,e.owner,e.size],e=>new fQ(e[1],e[2],e[0])),fQ.MAX_SIZE=49,fQ.EMPTY=new fQ(IZ.NONE,0,!1),fQ.UNREACHABLE=new fQ(IZ.NONE,-1,!1),fQ.PLAYER_ZERO=new fQ(TZ.ZERO,1,!1),fQ.PLAYER_ONE=new fQ(TZ.ONE,1,!1),fQ.SOURCE=new fQ(IZ.NONE,1,!0);let pQ=(()=>{class e extends dQ{constructor(t,n,r){super(n,t,e.WIDTH,e.HEIGHT,e.EXCLUDED_SPACES,fQ.EMPTY),this.alreadyPassed=r}static balancedBoard(){const e=fQ.UNREACHABLE,t=fQ.PLAYER_ZERO,n=fQ.PLAYER_ONE,r=fQ.SOURCE;return[[e,e,t,n,n,n,t,t,n,r,n],[e,n,n,t,t,t,n,n,t,n,n],[n,n,n,n,t,r,n,t,t,t,t],[t,t,n,t,t,n,n,n,t,t,e],[t,r,t,n,n,t,t,t,n,e,e]]}static isOnBoard(t){return!t.isNotInRange(e.WIDTH,e.HEIGHT)&&e.balancedBoard()[t.y][t.x]!==fQ.UNREACHABLE}static getInitialState(){return new e(e.balancedBoard(),0,!1)}getAllPieces(){const t=[];for(let n=0;n<e.HEIGHT;n++)for(let r=0;r<e.WIDTH;r++){const e=new GW(r,n);this.isOnBoard(e)&&!1===this.getPieceAt(e).isEmpty()&&t.push(e)}return t}numberOfNeighbors(e){return dQ.neighbors(e,1).filter(e=>this.isOnBoard(e)&&!1===this.getPieceAt(e).isEmpty()).length}setAtUnsafe(t,n){const r=NZ.copyBiArray(this.board);return r[t.y][t.x]=n,new e(r,this.turn,this.alreadyPassed)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==fQ.UNREACHABLE}}return e.WIDTH=11,e.HEIGHT=5,e.EXCLUDED_SPACES=[2,1],e})();class gQ extends hY{constructor(e,t){super(e,t)}static of(e,t){if(-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y)return gQ.PASS;if(!pQ.isOnBoard(e))throw new Error("Starting coord of DvonnMove must be on the board, not at "+e.toString());if(!pQ.isOnBoard(t))throw new Error("End coord of DvonnMove must be on the board, not at "+e.toString());if(e.y===t.y)return new gQ(e,t);if(e.x===t.x)return new gQ(e,t);if(e.x+e.y===t.x+t.y)return new gQ(e,t);throw new Error("Invalid move")}toString(){return this===gQ.PASS?"DvonnMove.PASS":"DvonnMove("+this.coord+"->"+this.end+")"}length(){return this.coord.y===this.end.y?Math.abs(this.coord.x-this.end.x):Math.abs(this.coord.y-this.end.y)}equals(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}}gQ.PASS=new gQ(new GW(-1,-1),new GW(-2,-2)),gQ.encoder=new class extends bZ{maxValue(){return 42148}encodeNumber(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}decodeNumber(e){if(e<0)return gQ.PASS;const t=e%16,n=(e=e/16|0)%16,r=(e=e/16|0)%16;return new gQ(new GW((e=e/16|0)%16,r),new GW(n,t))}};let mQ=(()=>{class e{}return e.NOT_PLAYER_PIECE=()=>$localize`You must select a piece or a stack of your color.`,e.EMPTY_STACK=()=>$localize`You must select a stack.`,e.TOO_MANY_NEIGHBORS=()=>$localize`This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors.`,e.CANT_REACH_TARGET=()=>$localize`This stack cannot move because it could never land on another piece.`,e.INVALID_MOVE_LENGTH=()=>$localize`A stack must always be moved by as many spaces as there are pieces in the stack.`,e.EMPTY_TARGET_STACK=()=>$localize`The stack must land on an occupied space.`,e})();class yQ extends mj{static getGameStatus(e){const t=e.gameState,n=yQ.getScores(t);return 0===yQ.getMovablePieces(t).length?n[0]>n[1]?gj.ZERO_WON:n[0]<n[1]?gj.ONE_WON:gj.DRAW:gj.ONGOING}static getMovablePieces(e){return yQ.getFreePieces(e).filter(t=>yQ.pieceHasTarget(e,t))}static getFreePieces(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6)}static pieceHasTarget(e,t){const n=e.getPieceAt(t).getSize();return void 0!==dQ.neighbors(t,n).find(t=>e.isOnBoard(t)&&!e.getPieceAt(t).isEmpty())}static pieceTargets(e,t){const n=e.getPieceAt(t).getSize();return dQ.neighbors(t,n).filter(t=>e.isOnBoard(t)&&!1===e.getPieceAt(t).isEmpty())}static getScores(e){let t=0,n=0;return e.getAllPieces().map(r=>{const i=e.getPieceAt(r);i.belongsTo(TZ.ZERO)?t+=i.getSize():i.belongsTo(TZ.ONE)&&(n+=i.getSize())}),[t,n]}isMovablePiece(e,t){hZ(e.isOnBoard(t),"piece is not on the board");const n=e.getPieceAt(t);return n.getSize()<1?Lw.failure(mQ.EMPTY_STACK()):n.belongsTo(e.getCurrentPlayer())?e.numberOfNeighbors(t)>=6?Lw.failure(mQ.TOO_MANY_NEIGHBORS()):yQ.pieceHasTarget(e,t)?Lw.SUCCESS:Lw.failure(mQ.CANT_REACH_TARGET()):Lw.failure(mQ.NOT_PLAYER_PIECE())}canOnlyPass(e){return 0===yQ.getMovablePieces(e).length}sourceCoords(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).containsSource())}markPiecesConnectedTo(e,t,n){dQ.neighbors(t,1).forEach(t=>{e.isOnBoard(t)&&!n[t.y][t.x]&&!e.getPieceAt(t).isEmpty()&&(n[t.y][t.x]=!0,this.markPiecesConnectedTo(e,t,n))})}removeDisconnectedPieces(e){const t=NZ.createTable(pQ.WIDTH,pQ.HEIGHT,!1);this.sourceCoords(e).forEach(n=>{t[n.y][n.x]=!0,this.markPiecesConnectedTo(e,n,t)});let n=e;return n.getAllPieces().forEach(e=>{t[e.y][e.x]||(n=n.setAt(e,fQ.EMPTY))}),n}applyLegalMove(e,t,n){if(e===gQ.PASS)return new pQ(t.board,t.turn+1,!0);{const n=t.getPieceAt(e.coord),r=t.getPieceAt(e.end),i=t.setAt(e.coord,fQ.EMPTY).setAt(e.end,fQ.append(n,r));return this.removeDisconnectedPieces(new pQ(i.board,t.turn+1,!1))}}isLegal(e,t){if(0===yQ.getMovablePieces(t).length)return e!==gQ.PASS||t.alreadyPassed?Rw.failure(JW.MUST_PASS()):Rw.success(void 0);if(e===gQ.PASS)return Rw.failure(JW.CANNOT_PASS());const n=this.isMovablePiece(t,e.coord);if(n.isFailure())return n.toFailedFallible();const r=t.getPieceAt(e.coord);return e.length()!==r.getSize()?Rw.failure(mQ.INVALID_MOVE_LENGTH()):t.getPieceAt(e.end).isEmpty()?Rw.failure(mQ.EMPTY_TARGET_STACK()):Rw.success(void 0)}getGameStatus(e){return yQ.getGameStatus(e)}}class vQ extends ej{getListMoves(e){const t=e.move,n=e.gameState,r=[];return yQ.getMovablePieces(n).forEach(e=>yQ.pieceTargets(n,e).forEach(t=>{const n=gQ.of(e,t);r.push(n)})),0===r.length&&!1===t.equalsValue(gQ.PASS)&&r.push(gQ.PASS),r}getBoardValue(e){const t=e.gameState,n=yQ.getScores(t);return 0===yQ.getMovablePieces(t).length?new tj(n[0]>n[1]?Number.MIN_SAFE_INTEGER:n[0]<n[1]?Number.MAX_SAFE_INTEGER:0):new tj(n[0]-n[1])}}class CQ extends vQ{getListMoves(e){const t=e.gameState,n=super.getListMoves(e),r=t.getCurrentPlayer().getOpponent();return NZ.sortByDescending(n,e=>{hZ(e!==gQ.PASS,"Cannot sort with DvonnMove.PASS");const n=t.getPieceAt(e.end);return n.belongsTo(r)?n.getSize():0}),n}getBoardValue(e){const t=yQ.getGameStatus(e);if(t.isEndGame)return new tj(t.toBoardValue());const n=e.gameState,r=yQ.getScores(n),i=n.getAllPieces(),s=i.length,o=i.filter(e=>n.getPieceAt(e).belongsTo(TZ.ZERO)).length,a=i.filter(e=>n.getPieceAt(e).belongsTo(TZ.ONE)).length;return new tj((a*r[1]-o*r[0])/s)}}const _Q=fQ.EMPTY,EQ=fQ.UNREACHABLE,wQ=fQ.SOURCE,PQ=fQ.PLAYER_ZERO,SQ=fQ.PLAYER_ONE,bQ=new fQ(TZ.ZERO,2,!1),OQ=new fQ(TZ.ONE,2,!1),TQ=new fQ(TZ.ZERO,4,!1),IQ=new fQ(TZ.ONE,4,!1);class kQ{constructor(){this.tutorial=[_j.anyMove($localize`Moving`,$localize`At Dvonn, each hexagonal space contains a stack of pieces.
        If no number is indicated on a stack, it means that it only contains one piece.
        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.
        The owner of a stack is the one that has a piece at the top of the stack.
        Only the owner of a stack can move it.
        A stack cannot be moved if it is surrounded by 6 other stacks.
        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.
        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.
        Therefore, there are six possible directions.
        The player with dark pieces starts.<br/><br/>
        You're playing Dark, click on a stack and move it by one space.`,pQ.getInitialState(),gQ.of(new GW(2,0),new GW(3,0)),$localize`Congratulations!`),_j.fromPredicate($localize`Disconnection`,$localize`Pieces with a lightning strike are called "sources".
        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>
        You're playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!`,new pQ([[EQ,EQ,SQ,wQ,_Q,_Q,_Q,_Q,_Q,_Q,_Q],[EQ,_Q,PQ,_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q],[_Q,_Q,IQ,_Q,_Q,_Q,_Q,SQ,wQ,_Q,_Q],[_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q,EQ],[_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q,EQ,EQ]],0,!1),gQ.of(new GW(2,1),new GW(2,0)),(e,t,n)=>e.end.equals(new GW(3,0))?Lw.failure($localize`You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it.`):(hZ(e.end.equals(new GW(2,0)),"player made an impossible move"),Lw.SUCCESS),$localize`Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!
        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.
        Disconnected stacks will not be visible at the next turn.`),_j.fromPredicate($localize`Moving on a source`,$localize`You are allowed to move your stacks on any other stack.
        This means that you can take control of a source by moving one of your stack on top of it.
        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>
        You're playing Dark and you can take control of a source, do it!`,new pQ([[EQ,EQ,wQ,SQ,_Q,_Q,_Q,_Q,_Q,_Q,_Q],[EQ,PQ,PQ,_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q],[_Q,SQ,PQ,SQ,_Q,_Q,PQ,OQ,wQ,_Q,_Q],[_Q,_Q,SQ,_Q,_Q,_Q,_Q,_Q,_Q,_Q,EQ],[_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q,EQ,EQ]],0,!1),gQ.of(new GW(2,1),new GW(2,0)),(e,t,n)=>e.end.equals(new GW(2,0))?Lw.SUCCESS:Lw.failure($localize`You have not taken possession of a source, try again.`),$localize`Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!`),_j.informational($localize`Passing`,$localize`It can happen that you have no possible move to make.
        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>
        This is a situation that occurs here for Dark.`,new pQ([[EQ,EQ,wQ,_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q],[EQ,_Q,bQ,_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q],[_Q,_Q,OQ,_Q,_Q,_Q,_Q,OQ,wQ,TQ,_Q],[_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q,EQ],[_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q,EQ,EQ]],0,!1)),_j.fromMove($localize`End of the game`,$localize`When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>
        Make your last move.`,new pQ([[EQ,EQ,wQ,_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q],[EQ,_Q,PQ,_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q],[_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q,wQ,TQ,_Q],[_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q,EQ],[_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q,_Q,EQ,EQ]],0,!1),[gQ.of(new GW(2,1),new GW(2,0))],$localize`Congratulations, you won 6 - 0!`,$localize`Bad idea, by moving on the source you would have won a point.`)]}}function AQ(e,t){if(1&e&&(_n(),ga(0,"circle",10)),2&e){const e=Sa().$implicit,t=Sa().$implicit,n=Sa();ha("ngClass",n.getPieceClasses(e)),ra("cx",n.getCenterAt(t).x)("cy",n.getCenterAt(t).y)("r",n.SPACE_SIZE)}}function MQ(e,t){if(1&e&&(_n(),ga(0,"polygon",11)),2&e){const e=Sa().$implicit,t=Sa().$implicit,n=Sa();ra("transform",1===e.getSize()?"translate("+(n.getCenterAt(t).x-18)+" "+(n.getCenterAt(t).y-16)+") scale(0.10)":"translate("+(n.getCenterAt(t).x-3)+" "+(n.getCenterAt(t).y-12)+") scale(0.07)")}}function NQ(e,t){if(1&e){const e=va();_n(),fa(0,"text",12),Ea("click",function(){Gt(e);const t=Sa(2).$implicit;return Sa().onClick(t.x,t.y)}),Qa(1),pa()}if(2&e){const e=Sa().$implicit,t=Sa().$implicit,n=Sa();ra("x",e.containsSource()?n.getCenterAt(t).x-7:n.getCenterAt(t).x)("y",n.getCenterAt(t).y),Ts(1),Xa(e.getSize())}}function RQ(e,t){if(1&e){const e=va();_n(),fa(0,"g",5),Ea("click",function(){Gt(e);const t=Sa().$implicit;return Sa().onClick(t.x,t.y)}),ga(1,"polyline",6),la(2,AQ,1,4,"circle",7),la(3,MQ,1,1,"polygon",8),la(4,NQ,2,3,"text",9),pa()}if(2&e){const e=t.$implicit,n=Sa().$implicit,r=Sa();Ia("id","click_",n.x,"_",n.y,""),Ts(1),ra("points",r.getHexaCoordsAt(n)),Ts(1),ha("ngIf",e.getSize()>0),Ts(1),ha("ngIf",e.containsSource()),Ts(1),ha("ngIf",e.getSize()>1)}}const xQ=function(e){return[e]};function DQ(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,RQ,5,6,"g",4),pa()),2&e){const e=t.$implicit,n=Sa();Ts(1),ha("ngForOf",Pu(1,xQ,n.state.getPieceAt(e)))}}function LQ(e,t){if(1&e&&(_n(),fa(0,"text",16),Qa(1),pa()),2&e){const e=Sa().$implicit,t=Sa();ra("x",t.getCenterAt(e.coord).x)("y",t.getCenterAt(e.coord).y),Ts(1),Xa(e.caseContent.getSize())}}function FQ(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"polyline",13),ga(2,"circle",14),la(3,LQ,2,3,"text",15),pa()),2&e){const e=t.$implicit,n=Sa();Ts(1),ra("points",n.getHexaCoordsAt(e.coord)),Ts(1),Ia("id","captured_",e.coord.x,"_",e.coord.y,""),ha("ngClass",n.getPieceClasses(e.caseContent)),ra("cx",n.getCenterAt(e.coord).x)("cy",n.getCenterAt(e.coord).y)("r",n.SPACE_SIZE),Ts(1),ha("ngIf",e.caseContent.getSize()>1)}}function UQ(e,t){if(1&e&&(_n(),ma(0),ga(1,"polyline",17),ga(2,"polyline",17),ya()),2&e){const e=Sa();Ts(1),ra("points",e.getHexaCoordsAt(e.lastMove.get().coord)),Ts(1),ra("points",e.getHexaCoordsAt(e.lastMove.get().end))}}function VQ(e,t){if(1&e&&(_n(),ga(0,"polyline",18)),2&e){const e=Sa();ra("points",e.getHexaCoordsAt(e.chosen.get()))}}let BQ=(()=>{class e extends qW{constructor(e){super(e),this.lastMove=Nw.empty(),this.chosen=Nw.empty(),this.disconnecteds=[],this.rules=new yQ(pQ),this.availableMinimaxes=[new vQ(this.rules,"DvonnMinimax"),new CQ(this.rules,"DvonnMinimaxMaximizeStacks")],this.encoder=gQ.encoder,this.tutorial=(new kQ).tutorial,this.SPACE_SIZE=30,this.canPass=!1,this.scores=Nw.of(yQ.getScores(this.rules.node.gameState)),this.hexaLayout=new YW(1.5*this.SPACE_SIZE,new GW(-this.SPACE_SIZE,2*this.SPACE_SIZE),QW.INSTANCE),this.state=this.rules.node.gameState,this.hexaBoard=this.rules.node.gameState.board}hideLastMove(){this.lastMove=Nw.empty()}updateBoard(){this.cancelMoveAttempt(),this.state=this.rules.node.gameState,this.lastMove=this.rules.node.move,this.disconnecteds=[],this.lastMove.isPresent()?this.calculateDisconnecteds():this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=Nw.of(yQ.getScores(this.state))}calculateDisconnecteds(){const e=this.rules.node.mother.get().gameState,t=this.rules.node.gameState;for(let n=0;n<t.board.length;n++)for(let r=0;r<t.board[n].length;r++){const i=new GW(r,n);if(!0===t.isOnBoard(i)&&!1===i.equals(this.lastMove.get().coord)){const s=t.getPieceAt(i),o=e.getPieceAt(i);if(s.isEmpty()&&!o.isEmpty()){const e={coord:new GW(r,n),caseContent:o};this.disconnecteds.push(e)}}}}cancelMoveAttempt(){this.chosen=Nw.empty()}pass(){var e=this;return Ow(function*(){return hZ(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield e.chooseMove(gQ.PASS,e.rules.node.gameState)})()}onClick(e,t){var n=this;return Ow(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);return r.isFailure()?n.cancelMove(r.getReason()):n.chosen.isAbsent()?n.choosePiece(e,t):n.chosen.equalsValue(new GW(e,t))?(n.cancelMoveAttempt(),Lw.SUCCESS):yield n.chooseDestination(e,t)})()}choosePiece(e,t){const n=new GW(e,t),r=this.rules.isMovablePiece(this.rules.node.gameState,n);return r.isSuccess()?(this.chosen=Nw.of(n),Lw.SUCCESS):this.cancelMove(r.getReason())}chooseDestination(e,t){var n=this;return Ow(function*(){const r=n.chosen.get(),i=new GW(e,t),s=gQ.of(r,i);return n.chooseMove(s,n.rules.node.gameState)})()}getPieceClasses(e){if(e.containsSource()&&1===e.getSize())return["other-piece","dashed-stroke"];const t=this.getPlayerClass(e.getOwner());return e.containsSource()?[t,"other-piece-stroke","dashed-stroke"]:[t]}}return e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-dvonn"]],features:[Go],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"ngClass",4,"ngIf"],["class","other-piece-light","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"other-piece-light"],["dy","13",1,"text-center","text-medium",3,"click"],[1,"base","mid-stroke","captured"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-big","dy","17",4,"ngIf"],["dy","17",1,"text-center","text-big"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","selected"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,DQ,2,3,"g",1),la(2,FQ,4,8,"g",1),la(3,UQ,3,2,"ng-container",2),la(4,VQ,1,1,"polyline",3),pa()),2&e&&(Ts(1),ha("ngForOf",t.state.allCoords()),Ts(1),ha("ngForOf",t.disconnecteds),Ts(1),ha("ngIf",t.lastMove.isPresent()),Ts(1),ha("ngIf",t.chosen.isPresent()))},directives:[tf,rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();var $Q=(()=>(function(e){e[e.NONE=0]="NONE",e[e.SMALL=1]="SMALL",e[e.MEDIUM=2]="MEDIUM",e[e.BIG=3]="BIG"}($Q||($Q={})),$Q))();class zQ{constructor(e){this.value=e}static of(e){switch(e){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}static ofSizeAndPlayer(e,t){return t===TZ.ZERO&&e===$Q.BIG?zQ.BIG_DARK:t===TZ.ZERO&&e===$Q.MEDIUM?zQ.MEDIUM_DARK:t===TZ.ZERO&&e===$Q.SMALL?zQ.SMALL_DARK:t===TZ.ONE&&e===$Q.BIG?zQ.BIG_LIGHT:t===TZ.ONE&&e===$Q.MEDIUM?zQ.MEDIUM_LIGHT:t===TZ.ONE&&e===$Q.SMALL?zQ.SMALL_LIGHT:zQ.NONE}getPlayer(){switch(this){case zQ.SMALL_DARK:case zQ.MEDIUM_DARK:case zQ.BIG_DARK:return TZ.ZERO;case zQ.SMALL_LIGHT:case zQ.MEDIUM_LIGHT:case zQ.BIG_LIGHT:return TZ.ONE;default:return IZ.NONE}}getSize(){switch(this){case zQ.BIG_DARK:case zQ.BIG_LIGHT:return $Q.BIG;case zQ.MEDIUM_DARK:case zQ.MEDIUM_LIGHT:return $Q.MEDIUM;case zQ.SMALL_DARK:case zQ.SMALL_LIGHT:return $Q.SMALL;default:return Tw.expectToBe(this,zQ.NONE),$Q.NONE}}belongsTo(e){return this.getPlayer()===e}equals(e){return this===e}toString(){switch(this){case zQ.BIG_DARK:return"BIG_DARK";case zQ.BIG_LIGHT:return"BIG_LIGHT";case zQ.MEDIUM_DARK:return"MEDIUM_DARK";case zQ.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case zQ.SMALL_DARK:return"SMALL_DARK";case zQ.SMALL_LIGHT:return"SMALL_LIGHT";default:return Tw.expectToBe(this,zQ.NONE),"EMPTY"}}}zQ.SMALL_DARK=new zQ(0),zQ.SMALL_LIGHT=new zQ(1),zQ.MEDIUM_DARK=new zQ(2),zQ.MEDIUM_LIGHT=new zQ(3),zQ.BIG_DARK=new zQ(4),zQ.BIG_LIGHT=new zQ(5),zQ.NONE=new zQ(6);class HQ extends sj{constructor(e,t,n){super(e,t),this.remainingPieces=n}static getInitialState(){const e=new GQ(IZ.NONE,IZ.NONE,IZ.NONE).encode(),t=NZ.createTable(3,3,e),n=NZ.mapBiArray(t,e=>GQ.decode(e));return new HQ(n,0,[zQ.BIG_DARK,zQ.BIG_DARK,zQ.BIG_LIGHT,zQ.BIG_LIGHT,zQ.MEDIUM_DARK,zQ.MEDIUM_DARK,zQ.MEDIUM_LIGHT,zQ.MEDIUM_LIGHT,zQ.SMALL_DARK,zQ.SMALL_DARK,zQ.SMALL_LIGHT,zQ.SMALL_LIGHT])}getRemainingPieces(){return NZ.copyImmutableArray(this.remainingPieces)}getRemainingPiecesOfPlayer(e){return this.getRemainingPieces().filter(t=>t.getPlayer()===e)}pieceBelongsToCurrentPlayer(e){return e.belongsTo(this.getCurrentPlayer())}isDroppable(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}isInRemainingPieces(e){return this.remainingPieces.some(t=>t===e)}getPlayerRemainingPieces(){return this.remainingPieces.filter(e=>this.pieceBelongsToCurrentPlayer(e))}}class GQ{constructor(e,t,n){this.small=e,this.medium=t,this.big=n}static decode(e){hZ(e%1==0,"EncapsuleCase must be encoded as integer: "+e),hZ(e>=0,"To small representation for EncapsuleCase: "+e),hZ(e<=26,"To big representation for EncapsuleCase: "+e);const t=TZ.numberEncoder.decodeNumber(e%3);e-=t.value;const n=TZ.numberEncoder.decodeNumber((e/=3)%3);e-=n.value;const r=TZ.numberEncoder.decodeNumber(e/=3);return new GQ(t,n,r)}isEmpty(){return this.small===IZ.NONE&&this.medium===IZ.NONE&&this.big===IZ.NONE}toList(){const e=[];return this.small.isPlayer()&&e.push(zQ.ofSizeAndPlayer($Q.SMALL,this.small)),this.medium.isPlayer()&&e.push(zQ.ofSizeAndPlayer($Q.MEDIUM,this.medium)),this.big.isPlayer()&&e.push(zQ.ofSizeAndPlayer($Q.BIG,this.big)),e}toOrderedPieceNames(){const e=zQ.ofSizeAndPlayer($Q.SMALL,this.small),t=zQ.ofSizeAndPlayer($Q.MEDIUM,this.medium),n=zQ.ofSizeAndPlayer($Q.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}getBiggest(){return this.big===TZ.ZERO?zQ.BIG_DARK:this.big===TZ.ONE?zQ.BIG_LIGHT:this.medium===TZ.ZERO?zQ.MEDIUM_DARK:this.medium===TZ.ONE?zQ.MEDIUM_LIGHT:this.small===TZ.ZERO?zQ.SMALL_DARK:this.small===TZ.ONE?zQ.SMALL_LIGHT:zQ.NONE}tryToSuperposePiece(e){const t=this.getBiggest().getSize();if(e===zQ.NONE)throw new Error("Cannot move EMPTY on a space");return e.getSize()>t?Nw.of(this.put(e)):Nw.empty()}removeBiggest(){const e=this.getBiggest();if(e===zQ.NONE)throw new Error("Cannot removed piece from empty space");let t;const n=e.getSize();switch(n){case $Q.BIG:t=new GQ(this.small,this.medium,IZ.NONE);break;case $Q.MEDIUM:t=new GQ(this.small,IZ.NONE,IZ.NONE);break;default:Tw.expectToBe(n,$Q.SMALL),t=new GQ(IZ.NONE,IZ.NONE,IZ.NONE)}return{removedCase:t,removedPiece:e}}put(e){if(e===zQ.NONE)throw new Error("Cannot put NONE on space");const t=e.getPlayer(),n=e.getSize();switch(n){case $Q.BIG:return new GQ(this.small,this.medium,t);case $Q.MEDIUM:return hZ(this.big===IZ.NONE,"Cannot put a piece on top of a bigger one"),new GQ(this.small,t,this.big);default:return Tw.expectToBe(n,$Q.SMALL),hZ(this.big===IZ.NONE,"Cannot put a piece on top of a bigger one"),hZ(this.medium===IZ.NONE,"Cannot put a piece on top of a bigger one"),new GQ(t,this.medium,this.big)}}encode(){return this.small.value+3*this.medium.value+9*this.big.value}belongsTo(e){return this.getBiggest().getPlayer()===e}toString(){const e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}GQ.EMPTY=new GQ(IZ.NONE,IZ.NONE,IZ.NONE);let ZQ=(()=>{class e{}return e.PIECE_OUT_OF_STOCK=()=>$localize`You do not have pieces of this type anymore.`,e.INVALID_PLACEMENT=()=>$localize`You must put your piece on an empty square or on a smaller piece.`,e.NOT_DROPPABLE=()=>$localize`You must pick your piece among the remaining ones.`,e.INVALID_PIECE_SELECTED=()=>$localize`You must pick one of your remaining pieces or one piece on the board that is the biggest of its square.`,e.SAME_DEST_AS_ORIGIN=()=>$localize`You must select a different landing square than the square where the move originates from.`,e.END_YOUR_MOVE=()=>$localize`You are performing a move, you must select a landing square.`,e})();class qQ extends mj{static isVictory(e){const t=e.getCopiedBoard();for(const n of qQ.LINES){const e=qQ.isVictoriousLine([t[n[0].y][n[0].x],t[n[1].y][n[1].x],t[n[2].y][n[2].x]]);if(e.isPresent())return e}return Nw.empty()}static isVictoriousLine(e){const t=e.map(e=>e.getBiggest()).map(e=>e.getPlayer());return t[0]===IZ.NONE?Nw.empty():t[0]===t[1]&&t[1]===t[2]?Nw.of(t[0]):Nw.empty()}static isLegal(e,t){let n;if(Iw(!1,e.toString()),e.isDropping()){if(n=e.piece.get(),!1===t.pieceBelongsToCurrentPlayer(n))return Rw.failure(JW.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.isInRemainingPieces(n))return Rw.failure(ZQ.PIECE_OUT_OF_STOCK())}else{const r=e.startingCoord.get();if(n=t.getPieceAt(r).getBiggest(),!1===t.pieceBelongsToCurrentPlayer(n))return Rw.failure(JW.MUST_CHOOSE_PLAYER_PIECE())}const r=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return r.isPresent()?Rw.success(r.get()):Rw.failure(ZQ.INVALID_PLACEMENT())}isLegal(e,t){return qQ.isLegal(e,t)}applyLegalMove(e,t,n){const r=t.getCopiedBoard();let i=t.getRemainingPieces();const s=t.turn+1;let o;if(r[e.landingCoord.y][e.landingCoord.x]=GQ.decode(n.encode()),e.isDropping()){o=e.piece.get();const t=i.indexOf(o);i=i.slice(0,t).concat(i.slice(t+1))}else{const t=e.startingCoord.get(),n=r[t.y][t.x].encode(),i=GQ.decode(n).removeBiggest();r[t.y][t.x]=GQ.decode(i.removedCase.encode()),o=i.removedPiece}return new HQ(r,s,i)}static getGameStatus(e){const t=qQ.isVictory(e.gameState);return t.isPresent()?gj.getVictory(t.get()):gj.ONGOING}getGameStatus(e){return qQ.getGameStatus(e)}}qQ.LINES=[[new GW(0,0),new GW(0,1),new GW(0,2)],[new GW(1,0),new GW(1,1),new GW(1,2)],[new GW(2,0),new GW(2,1),new GW(2,2)],[new GW(0,0),new GW(1,0),new GW(2,0)],[new GW(0,1),new GW(1,1),new GW(2,1)],[new GW(0,2),new GW(1,2),new GW(2,2)],[new GW(0,0),new GW(1,1),new GW(2,2)],[new GW(0,2),new GW(1,1),new GW(2,0)]];class WQ extends aj{constructor(e,t,n){super(),this.startingCoord=e,this.landingCoord=t,this.piece=n}static fromMove(e,t){if(e.equals(t))throw new Error("Starting coord and landing coord must be separate coords");return new WQ(Nw.of(e),t,Nw.empty())}static fromDrop(e,t){return new WQ(Nw.empty(),t,Nw.of(e))}isDropping(){return this.startingCoord.isAbsent()}equals(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}toString(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}WQ.encoder=new class extends bZ{maxValue(){return 161}encodeNumber(e){const t=e.landingCoord.x,n=e.landingCoord.y;if(e.isDropping()){const r=0;return 18*e.piece.get().value+6*t+2*n+r}{const r=1,i=e.startingCoord.get().y;return 54*e.startingCoord.get().x+18*i+6*t+2*n+r}}decodeNumber(e){const t=e%2;e-=t;const n=(e/=2)%3;e-=n;const r=(e/=3)%3;e-=r,e/=3;const i=new GW(r,n);if(0===t){const t=zQ.of(e);return WQ.fromDrop(t,i)}{const t=e%3;e-=t;const n=new GW((e/=3)%3,t);return WQ.fromMove(n,i)}}};class jQ extends ej{getBoardValue(e){const t=qQ.getGameStatus(e);return new tj(t.toBoardValue())}getListMoves(e){const t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getCurrentPlayer(),s=nj.toComparableObjectSet(n.getPlayerRemainingPieces());for(let o=0;o<3;o++)for(let e=0;e<3;e++){const a=new GW(e,o);for(const e of s){const r=WQ.fromDrop(e,a);qQ.isLegal(r,n).isSuccess()&&t.push(r)}if(r[o][e].belongsTo(i))for(let e=0;e<3;e++)for(let r=0;r<3;r++){const i=new GW(r,e);if(!i.equals(a)){const e=WQ.fromMove(a,i);qQ.isLegal(e,n).isSuccess()&&t.push(e)}}}return t}}const YQ=new GQ(IZ.NONE,IZ.NONE,IZ.NONE),KQ=new GQ(TZ.ZERO,IZ.NONE,IZ.NONE),QQ=new GQ(IZ.NONE,TZ.ZERO,IZ.NONE),XQ=new GQ(IZ.NONE,IZ.NONE,TZ.ZERO),JQ=new GQ(TZ.ONE,IZ.NONE,IZ.NONE),eX=new GQ(IZ.NONE,IZ.NONE,TZ.ONE),tX=new GQ(TZ.ONE,TZ.ZERO,IZ.NONE),nX=new GQ(TZ.ZERO,TZ.ZERO,IZ.NONE);class rX{constructor(){this.tutorial=[_j.informational($localize`Goal of the game`,$localize`The goal of Encapsule is to align three of your pieces.
        Here, we have a victory of the dark player.`,new HQ([[KQ,JQ,eX],[YQ,QQ,YQ],[YQ,YQ,XQ]],0,[zQ.SMALL_DARK,zQ.MEDIUM_DARK,zQ.BIG_DARK,zQ.SMALL_LIGHT,zQ.MEDIUM_LIGHT,zQ.MEDIUM_LIGHT,zQ.BIG_LIGHT])),_j.anyMove($localize`Putting a piece`,$localize`This is the initial board. You're playing Dark.<br/><br/>
        Pick one of your piece on the side of the board and put it on the board.`,HQ.getInitialState(),WQ.fromDrop(zQ.SMALL_DARK,new GW(1,1)),$localize`Congratulations!`),_j.fromMove($localize`Moving`,$localize`Another possible action is to move one of your pieces that is already on the board.<br/><br/>
        Click on your dark piece and then on any empty square of the board.`,new HQ([[KQ,eX,YQ],[YQ,YQ,YQ],[YQ,YQ,YQ]],0,[]),[WQ.fromMove(new GW(0,0),new GW(2,0)),WQ.fromMove(new GW(0,0),new GW(0,1)),WQ.fromMove(new GW(0,0),new GW(1,1)),WQ.fromMove(new GW(0,0),new GW(2,1)),WQ.fromMove(new GW(0,0),new GW(0,2)),WQ.fromMove(new GW(0,0),new GW(1,2)),WQ.fromMove(new GW(0,0),new GW(2,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),_j.fromPredicate($localize`Particularity`,$localize`At Encapsule, pieces encapsulate each other.
        It is therefore possible to have up to three pieces per square!
        However, only the biggest piece of each square counts:
        you cannot win with a piece that is "hidden" by a bigger piece.
        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.
        Finally, you cannot encapsulate a piece with a smaller piece.
        You're playing Dark and you can win now in various ways.<br/><br/>
        Try to win by making a move, and not by putting a new piece on the board.`,new HQ([[tX,YQ,JQ],[nX,eX,eX],[YQ,YQ,YQ]],0,[zQ.MEDIUM_DARK,zQ.BIG_DARK,zQ.MEDIUM_LIGHT,zQ.MEDIUM_LIGHT]),WQ.fromMove(new GW(0,1),new GW(0,2)),(e,t,n)=>{if(e.landingCoord.equals(new GW(0,2))){if(e.isDropping())return Lw.failure($localize`You won, but the exercise is to win while moving a piece!`);if(e.startingCoord.equalsValue(new GW(0,1)))return Lw.SUCCESS}return Lw.failure($localize`Failed. Try again.`)},$localize`Congratulations!`)]}}function iX(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"circle",5),Ea("click",function(){const t=Gt(e),n=t.$implicit,r=t.index;return Sa().onPieceClick(0,n,r)}),pa(),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa();Ts(1),Ta("id","piece_0_",e.toString(),""),ha("ngClass",r.getSidePieceClasses(e,n)),ra("r",r.getPieceRadius(e))("cx",r.getPieceLeftX(0,n)+r.getPieceRadius(e))("cy",r.SPACE_SIZE/2)}}function sX(e,t){if(1&e){const e=va();_n(),fa(0,"circle",8),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().onBoardClick(t,n)}),pa()}if(2&e){const e=t.$implicit,n=Sa().index,r=Sa().index,i=Sa();ha("ngClass",i.getPieceClasses(e)),ra("r",i.getPieceRadius(e))("cx",i.SPACE_SIZE*n+i.STROKE_WIDTH+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.STROKE_WIDTH+i.SPACE_SIZE/2)}}function oX(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",6),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onBoardClick(t,n)}),pa(),la(2,sX,1,4,"circle",7),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();Ts(1),Ia("id","click_",n,"_",r,""),ha("ngClass",i.getRectClasses(n,r)),ra("x",i.SPACE_SIZE*n+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),Ts(1),ha("ngForOf",i.getListPieces(e))}}function aX(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,oX,3,8,"g",2),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}function lX(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",9),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onBoardClick(t.x,t.y)}),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa();Ts(1),ra("x",n.SPACE_SIZE*e.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*e.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function cX(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"circle",5),Ea("click",function(){const t=Gt(e),n=t.$implicit,r=t.index;return Sa().onPieceClick(1,n,r)}),pa(),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa();Ts(1),Ta("id","piece_1_",e.toString(),""),ha("ngClass",r.getSidePieceClasses(e,n)),ra("r",r.getPieceRadius(e))("cx",r.getPieceLeftX(1,n)+r.getPieceRadius(e))("cy",r.SPACE_SIZE/2)}}let uX=(()=>{class e extends tY{constructor(e){super(e),this.INTER_PIECE_SPACE=20,this.lastLandingCoord=Nw.empty(),this.lastStartingCoord=Nw.empty(),this.chosenCoord=Nw.empty(),this.chosenPiece=Nw.empty(),this.remainingPieceLeftX=[],this.rules=new qQ(HQ),this.availableMinimaxes=[new jQ(this.rules,"EncapsuleMinimax")],this.encoder=WQ.encoder,this.tutorial=(new rX).tutorial,this.updateBoard()}updateBoard(){this.board=this.rules.node.gameState.getCopiedBoard();const e=this.rules.node.move;this.calculateLeftX(),e.isPresent()?(this.lastLandingCoord=Nw.of(e.get().landingCoord),this.lastStartingCoord=e.get().startingCoord):(this.lastLandingCoord=Nw.empty(),this.lastStartingCoord=Nw.empty())}getListPieces(e){return e.toList()}getRemainingPieces(e){return this.rules.node.gameState.getRemainingPiecesOfPlayer(TZ.of(e))}onBoardClick(e,t){var n=this;return Ow(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=new GW(e,t),s=n.rules.node.gameState;if(n.chosenCoord.isAbsent()){if(n.chosenCoord=Nw.of(i),n.chosenPiece.isPresent()){const e=WQ.fromDrop(n.chosenPiece.get(),i);return n.chooseMove(e,n.rules.node.gameState)}return!1===s.getPieceAt(i).belongsTo(s.getCurrentPlayer())?n.cancelMove(ZQ.INVALID_PIECE_SELECTED()):Lw.SUCCESS}if(n.chosenCoord.equalsValue(i))return n.cancelMove(ZQ.SAME_DEST_AS_ORIGIN());{const e=WQ.fromMove(n.chosenCoord.get(),i);return n.chooseMove(e,n.rules.node.gameState)}})()}cancelMoveAttempt(){this.chosenCoord=Nw.empty(),this.chosenPiece=Nw.empty(),this.chosenPieceIndex=-1}onPieceClick(e,t,n){var r=this;return Ow(function*(){const i=r.canUserPlay("#piece_"+e+"_"+t.toString());return i.isFailure()?r.cancelMove(i.getReason()):!1===r.rules.node.gameState.isDroppable(t)?r.cancelMove(ZQ.NOT_DROPPABLE()):r.chosenCoord.isAbsent()?(r.chosenPiece=Nw.of(t),r.chosenPieceIndex=n,Lw.SUCCESS):r.cancelMove(ZQ.END_YOUR_MOVE())})()}getRectClasses(e,t){return this.isSelected(e,t)?"moved":""}isSelected(e,t){const n=new GW(e,t);return!(!this.lastStartingCoord.equalsValue(n)&&!this.lastLandingCoord.equalsValue(n))}getPieceClasses(e){return[this.getPieceStrokeClass(e)]}getPieceStrokeClass(e){const t=e.getPlayer();return hZ(t.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+t.value+"-stroke"}getPieceRadius(e){switch(e.getSize()){case $Q.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case $Q.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return Tw.expectToBe(e.getSize(),$Q.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}getHighlightedCases(){const e=[];return this.chosenCoord.isPresent()&&e.push(this.chosenCoord.get()),e}getSidePieceClasses(e,t){const n=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex===t&&n.push("clickable "),n}isSelectedPiece(e){return this.chosenPiece.equalsValue(e)}calculateLeftX(){this.remainingPieceLeftX=[];for(let e=0;e<=1;e++){this.remainingPieceLeftX.push([]);const t=this.getRemainingPieces(e);for(let n=0;n<t.length;n++)if(0===n)this.remainingPieceLeftX[e].push(0);else{const r=this.remainingPieceLeftX[e][n-1],i=2*this.getPieceRadius(t[n-1]);this.remainingPieceLeftX[e].push(r+i+this.INTER_PIECE_SPACE)}}}getPieceLeftX(e,t){return this.remainingPieceLeftX[e][t]}}return e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-encapsule"]],features:[Go],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 520 520","preserveAspectRatio","xMidYMid meet"],["remainingCasePlayerZero",""],[4,"ngFor","ngForOf"],["boardDiv",""],["remainingCasePlayerOne",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","highlighted",3,"click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),fa(1,"g",null,1),la(3,iX,2,5,"g",2),pa(),fa(4,"g",null,3),la(6,aX,2,1,"g",2),la(7,lX,2,4,"g",2),pa(),fa(8,"g",null,4),la(10,cX,2,5,"g",2),pa(),pa()),2&e&&(Ts(1),ra("transform","translate("+t.STROKE_WIDTH+", 0)"),Ts(2),ha("ngForOf",t.getRemainingPieces(0)),Ts(1),ra("transform","translate("+(260-1.5*t.SPACE_SIZE-t.STROKE_WIDTH)+", "+t.SPACE_SIZE+")"),Ts(2),ha("ngForOf",t.board),Ts(1),ha("ngForOf",t.getHighlightedCases()),Ts(1),ra("transform","translate("+t.STROKE_WIDTH+", "+(2*t.STROKE_WIDTH+4*t.SPACE_SIZE)+")"),Ts(2),ha("ngForOf",t.getRemainingPieces(1)))},directives:[tf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class hX extends lj{constructor(e,t,n,r,i){if(super(e,t),this.movedPieces=n,this.stepSize=r,this.direction=i,this.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+this.coord.toString()+".");if(n<1)throw new Error("Must select minimum one piece (got "+n+").");if(r<1)throw new Error("Step size must be minimum one (got "+r+").");if(r>n)throw new Error("Cannot move a phalanx further than its size (got step size "+r+" for "+n+" pieces).")}toString(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}equals(e){return this===e||!(!this.coord.equals(e.coord)||this.movedPieces!==e.movedPieces||this.stepSize!==e.stepSize)&&this.direction.equals(e.direction)}}hX.encoder=new class extends bZ{maxValue(){return 122303}encodeNumber(e){const t=e.direction.toInt();return 8*e.coord.x*7*13*12+8*e.coord.y*7*13+8*(e.movedPieces-1)*7+8*(e.stepSize-1)+t}decodeNumber(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");const t=e%8;e-=t;const n=(e/=8)%7;e-=n;const r=(e/=7)%13;e-=r;const i=(e/=13)%12;e-=i;const s=e/=12,o=$W.factory.fromInt(t);return new hX(s,i,r+1,n+1,o.get())}};class dX extends sj{static getInitialState(){const e=IZ.NONE,t=IZ.ZERO,n=IZ.ONE;return new dX([[n,n,n,n,n,n,n,n,n,n,n,n,n,n],[n,n,n,n,n,n,n,n,n,n,n,n,n,n],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t]],0)}count(e,t){let n=0;for(let r=0;r<14;r++)this.board[t][r]===e&&n++;return n}doesOwnPiece(e){for(let t=0;t<12;t++)for(let n=0;n<14;n++)if(this.board[t][n]===e)return!0;return!1}}let fX=(()=>{class e{}return e.PHALANX_IS_LEAVING_BOARD=()=>$localize`The move distance of your phalanx puts it out of the board.`,e.SOMETHING_IN_PHALANX_WAY=()=>$localize`There is something in the way of your phalanx.`,e.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=()=>$localize`Your phalanx must be bigger than the one you are capturing.`,e.SQUARE_NOT_ALIGNED_WITH_SELECTED=()=>$localize`This square is not aligned with the selected piece.`,e.SINGLE_PIECE_MUST_MOVE_BY_ONE=()=>$localize`A single piece can only move by one square.`,e.SINGLE_PIECE_CANNOT_CAPTURE=()=>$localize`A single piece cannot make a capture.`,e.SQUARE_NOT_ALIGNED_WITH_PHALANX=()=>$localize`This square is not aligned with the direction of the phalanx.`,e.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=()=>$localize`A phalanx can't contain pieces outside of the board.`,e.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE=()=>$localize`A phalanx cannot contain an empty square.`,e.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=()=>$localize`A phalanx cannot contain a piece of the opponent.`,e})();class pX extends mj{static isLegal(e,t){const n=this.getPhalanxValidity(t,e);if(n.isFailure())return Rw.failure(n.getReason());const r=this.getLandingStatus(t,e);if(r.isFailure())return r;const i=NZ.copyBiArray(r.get()),s=t.getCurrentOpponent(),o=pX.getCaptureValidity(t,i,e,s);return o.isFailure()?o:Rw.success(o.get())}static getPhalanxValidity(e,t){let n=t.coord,r=0;const i=e.getCurrentOpponent();for(;r<t.movedPieces;){if(n.isNotInRange(14,12))return Lw.failure(fX.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());const s=e.getPieceAt(n);if(s===IZ.NONE)return Lw.failure(fX.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(s===i)return Lw.failure(fX.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());n=n.getNext(t.direction,1),r++}return Lw.SUCCESS}static getLandingStatus(e,t){const n=e.getCopiedBoard(),r=e.getCurrentPlayer();let i=t.coord,s=t.coord.getNext(t.direction,t.movedPieces),o=0;for(;o+1<t.stepSize;){if(n[i.y][i.x]=IZ.NONE,n[s.y][s.x]=r,s.isNotInRange(14,12))return Rw.failure(fX.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(s).isPlayer())return Rw.failure(fX.SOMETHING_IN_PHALANX_WAY());o++,s=s.getNext(t.direction,1),i=i.getNext(t.direction,1)}return s.isNotInRange(14,12)?Rw.failure(fX.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(s)===r?Rw.failure(JW.CANNOT_SELF_CAPTURE()):(n[i.y][i.x]=IZ.NONE,n[s.y][s.x]=r,Rw.success(n))}static getCaptureValidity(e,t,n,r){let i=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),s=0;for(;i.isInRange(14,12)&&e.getPieceAt(i)===r;){if(s>0&&(t[i.y][i.x]=IZ.NONE),s++,s>=n.movedPieces)return Rw.failure(fX.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(n.direction,1)}return Rw.success(t)}isLegal(e,t){return pX.isLegal(e,t)}applyLegalMove(e,t,n){return new dX(n,t.turn+1)}getGameStatus(e){const t=e.gameState,n=t.count(TZ.ZERO,0),r=t.count(TZ.ONE,11);if(t.turn%2==0){if(n>r)return gj.ZERO_WON}else if(r>n)return gj.ONE_WON;return!1===t.doesOwnPiece(TZ.ZERO)?gj.ONE_WON:!1===t.doesOwnPiece(TZ.ONE)?gj.ZERO_WON:gj.ONGOING}}class gX extends ej{static getListMoves(e){const t=e.gameState.getCurrentPlayer(),n=e.gameState.getCurrentOpponent(),r=IZ.NONE;let i=[];const s=e.gameState;let o;for(let a=0;a<12;a++)for(let e=0;e<14;e++){const l=new GW(e,a);if(s.getPieceAt(l)===t)for(const c of $W.DIRECTIONS){let u=1,h=l.getNext(c,1);for(;h.isInRange(14,12)&&s.getPieceAt(h)===t;)u+=1,h=h.getNext(c,1);let d=1;for(;h.isInRange(14,12)&&d<=u&&s.getPieceAt(h)===r;)o=new hX(e,a,u,d,c),i=this.addMove(i,o,s),d++,h=h.getNext(c,1);h.isInRange(14,12)&&d<=u&&s.getPieceAt(h)===n&&(o=new hX(e,a,u,d,c),i=this.addMove(i,o,s))}}return i}static addMove(e,t,n){return pX.isLegal(t,n).isSuccess()&&e.push(t),e}getListMoves(e){const t=gX.getListMoves(e);return NZ.sortByDescending(t,e=>e.stepSize),t}getBoardValue(e){const t=this.ruler.getGameStatus(e);return new tj(t.isEndGame?t.toBoardValue():this.getPieceCountPlusRowDomination(e.gameState))}getPieceCountPlusRowDomination(e){let t=0;for(let n=0;n<12;n++){let r=0;const i=[0,0];for(let s=0;s<14;s++){const o=new GW(s,n),a=e.getPieceAt(o);if(a.isPlayer()){const n=a.getScoreModifier();t+=2002*n,i[a.value]=n,r+=n;for(const r of[$W.UP_LEFT,$W.UP,$W.UP_RIGHT]){let i=o.getNext(r,1);for(;i.isInRange(14,12)&&e.getPieceAt(i)===a;)t+=1*n,i=i.getNext(r,1)}}}0!==r&&(t+=Math.abs(r)/r*2),t+=1*i.reduce((e,t)=>e+t)}return t}}class mX extends ej{getListMoves(e){const t=gX.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}orderMovesByPhalanxSizeAndFilter(e,t){return NZ.sortByDescending(e,e=>e.movedPieces),e.length>40?e.filter(e=>!!this.moveIsCapture(e,t)||e.movedPieces*Math.random()>1):e}moveIsCapture(e,t){const n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}getBoardValue(e){const t=this.ruler.getGameStatus(e);return new tj(t.isEndGame?t.toBoardValue():this.getPieceCountThenSupportThenAdvancement(e.gameState))}getPieceCountThenSupportThenAdvancement(e){let t=0;for(let n=0;n<12;n++)for(let r=0;r<14;r++){const i=new GW(r,n),s=e.getPieceAt(i);if(s.isPlayer()){let r,o;s===TZ.ZERO?(r=12-n,o=[$W.UP_LEFT,$W.UP,$W.UP_RIGHT]):(r=n+1,o=[$W.DOWN_LEFT,$W.DOWN,$W.DOWN_RIGHT]);const a=s.getScoreModifier();t+=r*a,t+=149629*a;for(const n of o){let r=i.getNext(n,1);for(;r.isInRange(14,12)&&e.getPieceAt(r)===s;)t+=337*a,r=r.getNext(n,1)}}}return t}}class yX extends gX{constructor(){super(...arguments),this.DOMINANCE_FACTOR=20,this.DEFENSE_FACTOR=5,this.TERRITORY_FACTOR=2,this.OFFENSE_FACTOR=10,this.CENTER_FACTOR=5,this.MOBILITY_FACTOR=.12}getDominance(e){let t=0;for(let n=0;n<12;n++)for(let r=0;r<14;r++){const i=e.getPieceAt(new GW(r,n));i.isPlayer()&&(t+=i.getScoreModifier())}return t*this.DOMINANCE_FACTOR}getDefense(e){let t=0;for(let n=0;n<14;n++)e.getPieceAt(new GW(n,11))===TZ.ZERO&&(t+=TZ.ZERO.getScoreModifier()),e.getPieceAt(new GW(n,0))===TZ.ONE&&(t+=TZ.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}getTerritory(e){let t=0;for(let n=0;n<12;n++)for(let r=0;r<14;r++){const i=e.getPieceAt(new GW(r,n));if(i.isPlayer()){for(let s=-1;s<=1;s++)for(let o=-1;o<=1;o++){const a=new GW(r+s,n+o);if(a.isInRange(14,12)){const n=e.getPieceAt(a);(n===i||n===IZ.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}getOffense(e){let t=0;for(let n=0;n<14;n++)e.getPieceAt(new GW(n,0))===TZ.ZERO&&(t+=TZ.ZERO.getScoreModifier()),e.getPieceAt(new GW(n,11))===TZ.ONE&&(t+=TZ.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}getCenter(e){let t=0;for(let n=0;n<12;n++)for(let r=0;r<14;r++){const i=e.getPieceAt(new GW(r,n));i.isPlayer()&&(t+=i.getScoreModifier()*Math.sqrt((r-6.5)*(r-6.5)))}return t*this.CENTER_FACTOR}getMobility(e){let t=0,n=0,r=0;for(let i=0;i<12;i++)for(let s=0;s<14;s++){const o=new GW(s,i),a=e.getPieceAt(o);if(a.isPlayer())for(const i of $W.DIRECTIONS){let s=1,l=o.getNext(i,1);for(;l.isInRange(14,12)&&e.getPieceAt(l)===a;)s+=1,l=l.getNext(i,1);let c=1;for(;l.isInRange(14,12)&&c<=s&&e.getPieceAt(l)===IZ.NONE;)c++,l=l.getNext(i,1);t+=c*c*a.getScoreModifier(),a===TZ.ZERO?n=Math.max(n,c):a===TZ.ONE&&(r=Math.max(r,c))}}return(t+n*TZ.ZERO.getScoreModifier()+r*TZ.ONE.getScoreModifier())*this.MOBILITY_FACTOR}getBoardValue(e){const t=e.gameState,n=this.ruler.getGameStatus(e);if(n.isEndGame)return new tj(n.toBoardValue());const r=this.getDominance(t),i=this.getDefense(t),s=this.getTerritory(t),o=this.getCenter(t),a=this.getOffense(t),l=this.getMobility(t);return new tj(r+i+s+o+a+l)}}const vX=IZ.NONE,CX=IZ.ZERO,_X=IZ.ONE;class EX{constructor(){this.tutorial=[_j.informational($localize`Initial board`,$localize`This is the initial board of Epaminondas.
        The top line is the starting line of Light.
        The bottom line is the starting line of Dark.`,dX.getInitialState()),_j.informational($localize`Goal of the game (1/2)`,$localize`After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line
        than the number of pieces the opponent has on the player's starting line, the player wins.
        Here, it's Dark's turn to play: Dark has therefore won.`,new dX([[vX,vX,vX,vX,vX,CX,vX,vX,_X,_X,_X,_X,_X,_X],[vX,vX,vX,vX,vX,CX,vX,vX,vX,vX,vX,vX,_X,_X],[vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,_X,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,CX,CX,CX,CX,vX,vX,vX]],0)),_j.informational($localize`Goal of the game (2/2)`,$localize`Here, it is Light's turn.
        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line.`,new dX([[vX,vX,vX,vX,vX,CX,vX,vX,vX,vX,_X,_X,_X,_X],[vX,vX,vX,vX,vX,CX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,_X,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,_X,_X,vX,vX,vX,CX,CX,vX,CX,CX,CX,CX]],1)),_j.fromPredicate($localize`Moving a piece`,$localize`Here is the starting board. Dark plays first.
        Let's start with moving a single piece:
        <ol>
            <li>Click on a piece.</li>
            <li>Click on a empty neighboring square.</li>
        </ol>`,dX.getInitialState(),new hX(0,10,1,1,$W.UP),(e,t,n)=>1===e.movedPieces?Lw.SUCCESS:Lw.failure($localize`Congratulations, you are in advance. But this is not the exercise here, try again.`),$localize`This is how you move a single piece.`),_j.fromPredicate($localize`Moving a phalanx`,$localize`Let us now see how to move multiple pieces along a line, which is called a phalanx:
        <ol>
            <li>Click on the first piece of the phalanx.</li>
            <li>Click on the last piece of the phalanx.</li>
            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>
        </ol><br/>
        Move a phalanx!`,dX.getInitialState(),new hX(0,11,2,1,$W.UP),(e,t,n)=>e.movedPieces>1?Lw.SUCCESS:Lw.failure($localize`Failed! You moved only one piece.`),$localize`Congratulations!
        The moved pieces can be horizontally, vertically, or diagonally aligned.
        The move should be made along this axis, forward or backwards.
        There can be no opponent nor holes in the phalanx.`),_j.fromMove($localize`Capture`,$localize`In order to capture pieces of the opponent:
        <ol>
            <li>It must be aligned with the phalanx you are moving.</li>
            <li>It must be strictly shorter than your phalanx.</li>
            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>
        </ol><br/>
        Capture a phalanx.`,new dX([[vX,vX,vX,vX,vX,vX,vX,vX,_X,_X,_X,_X,_X,_X],[vX,vX,vX,vX,vX,vX,_X,vX,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,_X,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,_X,vX,_X,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,_X,_X,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,_X,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,CX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,CX,vX,vX,vX,vX,_X,vX,vX,vX,vX,vX,vX],[vX,vX,CX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,CX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX,vX],[vX,vX,vX,vX,vX,vX,vX,CX,CX,CX,CX,CX,CX,CX]],0),[new hX(2,10,4,2,$W.UP)],$localize`Congratulations, you made it!
        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment.`,$localize`Failed, you have not captured the phalanx.`)]}}function wX(e,t){if(1&e){const e=va();_n(),fa(0,"circle",4),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().onClick(t,n)}),pa()}if(2&e){const e=Sa().index,t=Sa().index,n=Sa();ha("ngClass",n.getPieceClasses(e,t)),ra("cx",n.SPACE_SIZE*e+n.STROKE_WIDTH+n.SPACE_SIZE/2)("cy",n.SPACE_SIZE*t+n.STROKE_WIDTH+n.SPACE_SIZE/2)("r",n.SPACE_SIZE/2-n.STROKE_WIDTH)}}function PX(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",2),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),pa(),la(2,wX,1,4,"circle",3),pa()}if(2&e){const e=t.index,n=Sa().index,r=Sa();Ts(1),Ia("id","click_",e,"_",n,""),ha("ngClass",r.getRectClasses(e,n)),ra("x",r.SPACE_SIZE*e+r.STROKE_WIDTH)("y",r.SPACE_SIZE*n+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),Ts(1),ha("ngIf",r.board[n][e]!==r.NONE)}}function SX(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,PX,3,8,"g",1),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}function bX(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",5),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t.x,t.y)}),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa();Ts(1),ra("x",n.SPACE_SIZE*e.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*e.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let OX=(()=>{class e extends tY{constructor(e){super(e),this.NONE=IZ.NONE,this.firstPiece=Nw.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=Nw.empty(),this.phalanxDirection=Nw.empty(),this.phalanxMiddles=[],this.moveds=[],this.captureds=[],this.rules=new pX(dX),this.availableMinimaxes=[new gX(this.rules,"Normal"),new mX(this.rules,"Positional"),new yX(this.rules,"Attack")],this.encoder=hX.encoder,this.tutorial=(new EX).tutorial,this.updateBoard()}updateBoard(){this.firstPiece=Nw.empty(),this.lastPiece=Nw.empty(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.board=this.rules.node.gameState.getCopiedBoard()}showPreviousMove(){const e=this.rules.node.move.get();let t=e.coord;this.moveds=[t];for(let i=1;i<e.stepSize+e.movedPieces;i++)t=t.getNext(e.direction,1),this.moveds.push(t);const n=this.rules.node.mother.get(),r=n.gameState.getCurrentOpponent();for(;t.isInRange(14,12)&&n.gameState.getPieceAt(t)===r;)this.captureds.push(t),t=t.getNext(e.direction,1)}onClick(e,t){var n=this;return Ow(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);return r.isFailure()?n.cancelMove(r.getReason()):n.firstPiece.isAbsent()?n.firstClick(e,t):n.lastPiece.isAbsent()?n.secondClick(e,t):n.thirdClick(e,t)})()}firstClick(e,t){var n=this;return Ow(function*(){const r=n.rules.node.gameState.getCurrentOpponent(),i=n.rules.node.gameState.getCurrentPlayer();switch(n.board[t][e]){case i:return n.firstPiece=Nw.of(new GW(e,t)),n.validExtensions=n.getValidExtensions(i),n.phalanxValidLandings=n.getPhalanxValidLandings(),Lw.SUCCESS;case r:return n.cancelMove(JW.CANNOT_CHOOSE_OPPONENT_PIECE());default:return Tw.expectToBe(n.board[t][e],IZ.NONE),n.cancelMove(JW.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())}})()}hidePreviousMove(){this.captureds=[],this.moveds=[]}getValidExtensions(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}getFirstPieceExtensions(e){const t=[];for(const n of $W.DIRECTIONS){let r=this.firstPiece.get().getNext(n,1);for(;r.isInRange(14,12)&&this.board[r.y][r.x]===e;)t.push(r),r=r.getNext(n,1)}return t}getPhalanxValidExtensions(e){let t=$W.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get();const n=this.lastPiece.get().getNext(t,1),r=this.getExtensionsToward(n,t,e);t=t.getOpposite();const i=this.firstPiece.get().getNext(t,1),s=this.getExtensionsToward(i,t,e);return r.concat(s)}getExtensionsToward(e,t,n){const r=[];for(;e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r.push(e),e=e.getNext(t,1);return r}getPhalanxValidLandings(){if(this.lastPiece.isPresent()){const e=this.firstPiece.get(),t=this.lastPiece.get(),n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y),i=Math.max(n,r)+1;let s=$W.factory.fromMove(e,t).get();const o=t.getNext(s,1),a=this.getLandingsToward(o,s,i);s=s.getOpposite();const l=e.getNext(s,1);return this.getLandingsToward(l,s,i).concat(a)}return this.getNeighboringEmptyCases()}getNeighboringEmptyCases(){const e=[];for(const t of $W.DIRECTIONS){const n=this.firstPiece.get().getNext(t,1);n.isInRange(14,12)&&this.board[n.y][n.x]===IZ.NONE&&e.push(n)}return e}getLandingsToward(e,t,n){const r=this.rules.node.gameState.getCurrentPlayer(),i=this.rules.node.gameState.getCurrentOpponent(),s=[];for(;e.isInRange(14,12)&&s.length<n&&this.board[e.y][e.x]!==r;){if(this.board[e.y][e.x]===i)return this.getPhalanxLength(e,t,i)<n&&s.push(e),s;s.push(e),e=e.getNext(t,1)}return s}getPhalanxLength(e,t,n){let r=0;for(;e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r++,e=e.getNext(t,1);return r}cancelMoveAttempt(){this.firstPiece=Nw.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=Nw.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}secondClick(e,t){var n=this;return Ow(function*(){const r=new GW(e,t),i=n.firstPiece.get();if(r.equals(i))return n.cancelMoveAttempt(),Lw.SUCCESS;const s=n.rules.node.gameState.getCurrentOpponent(),o=n.rules.node.gameState.getCurrentPlayer();if(!r.isAlignedWith(i))return n.cancelMove(fX.SQUARE_NOT_ALIGNED_WITH_SELECTED());const a=r.getDistance(i),l=i.getDirectionToward(r).get();switch(n.board[t][e]){case IZ.NONE:return 1===a?n.tryMove(new hX(i.x,i.y,1,1,l)):n.cancelMove(fX.SINGLE_PIECE_MUST_MOVE_BY_ONE());case s:return n.cancelMove(fX.SINGLE_PIECE_CANNOT_CAPTURE());default:Tw.expectToBe(n.board[t][e],o);const c=new hX(i.x,i.y,a,1,l),u=pX.getPhalanxValidity(n.rules.node.gameState,c);return u.isFailure()?n.cancelMove(u.getReason()):(n.lastPiece=Nw.of(r),n.validExtensions=n.getValidExtensions(o),n.phalanxValidLandings=n.getPhalanxValidLandings(),n.phalanxMiddles=i.getCoordsToward(r),n.phalanxDirection=Nw.of(l),Lw.SUCCESS)}})()}thirdClick(e,t){var n=this;return Ow(function*(){const r=n.rules.node.gameState.getCurrentPlayer(),i=new GW(e,t);if(n.firstPiece.equalsValue(i))return n.moveFirstPiece(r);if(n.lastPiece.equalsValue(i))return n.moveLastPiece(r);const s=n.firstPiece.get(),o=n.lastPiece.get();if(!i.isAlignedWith(s))return n.cancelMove(fX.SQUARE_NOT_ALIGNED_WITH_PHALANX());let a=$W.factory.fromMove(s,o).get();const l=$W.factory.fromMove(s,i).get();if(a===l.getOpposite()&&(n.firstPiece=Nw.of(o),n.lastPiece=Nw.of(s),a=l),a!==l)return n.cancelMove(fX.SQUARE_NOT_ALIGNED_WITH_PHALANX());if(n.board[t][e]===r){n.lastPiece=Nw.of(i);const e=n.firstPiece.get().getDistance(i)+1,t=new hX(n.firstPiece.get().x,n.firstPiece.get().y,e,1,a),s=pX.getPhalanxValidity(n.rules.node.gameState,t);return s.isFailure()?n.cancelMove(s.getReason()):(n.phalanxMiddles=n.firstPiece.get().getCoordsToward(n.lastPiece.get()),n.validExtensions=n.getValidExtensions(r),n.phalanxValidLandings=n.getPhalanxValidLandings(),Lw.SUCCESS)}{const e=n.firstPiece.get().getDistance(n.lastPiece.get())+1,t=n.lastPiece.get().getDistance(i),r=new hX(n.firstPiece.get().x,n.firstPiece.get().y,e,t,a);return n.tryMove(r)}})()}moveFirstPiece(e){var t=this;return Ow(function*(){return t.firstPiece=Nw.of(t.firstPiece.get().getNext(t.phalanxDirection.get(),1)),t.firstPiece.equals(t.lastPiece)?yield t.moveOnlyPiece(e):(t.phalanxMiddles=t.phalanxMiddles.slice(1),t.validExtensions=t.getPhalanxValidExtensions(e)),t.phalanxValidLandings=t.getPhalanxValidLandings(),Lw.SUCCESS})()}moveLastPiece(e){var t=this;return Ow(function*(){return t.lastPiece=Nw.of(t.lastPiece.get().getPrevious(t.phalanxDirection.get(),1)),t.firstPiece.equals(t.lastPiece)?t.moveOnlyPiece(e):(t.phalanxMiddles=t.firstPiece.get().getCoordsToward(t.lastPiece.get()),t.validExtensions=t.getPhalanxValidExtensions(e),t.phalanxValidLandings=t.getPhalanxValidLandings(),Lw.SUCCESS)})()}moveOnlyPiece(e){var t=this;return Ow(function*(){return t.lastPiece=Nw.empty(),t.validExtensions=t.getFirstPieceExtensions(e),t.phalanxDirection=Nw.empty(),t.phalanxMiddles=[],t.phalanxValidLandings=t.getPhalanxValidLandings(),Lw.SUCCESS})()}tryMove(e){const t=this.rules.node.gameState;return this.cancelMove(),this.chooseMove(e,t)}getPieceClasses(e,t){const n=this.getPlayerClass(this.board[t][e]);return this.getPieceStrokeClasses(e,t).concat([n])}getPieceStrokeClasses(e,t){const n=new GW(e,t);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(n)||this.lastPiece.equalsValue(n)||this.phalanxMiddles.some(e=>e.equals(n))?["highlighted"]:[]}getRectClasses(e,t){const n=new GW(e,t);return this.captureds.some(e=>e.equals(n))?["captured"]:this.moveds.some(e=>e.equals(n))?["moved"]:[]}getHighlightedCoords(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}getCurrentPlayerPieces(){const e=[],t=this.rules.node.gameState.getCurrentPlayer();for(let n=0;n<this.board.length;n++)for(let r=0;r<this.board[n].length;r++)this.board[n][r]===t&&e.push(new GW(r,n));return e}}return e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-epaminondas"]],features:[Go],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable",3,"click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,SX,2,1,"g",1),la(2,bX,2,4,"g",1),pa()),2&e&&(Ts(1),ha("ngForOf",t.board),Ts(1),ha("ngForOf",t.getHighlightedCoords()))},directives:[tf,Jd,rf],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();function TX(e){return new class extends PZ{encode(t){return t.isPresent()?e.encode(t.get()):null}decode(t){return null===t?Nw.empty():Nw.of(e.decode(t))}}}class IX{constructor(e){if(e.length<4)throw new Error("Cannot create a GipfCapture with less than 4 captured pieces");if(!1===hQ.areOnSameLine(e))throw new Error("Cannot create a GipfCapture with pieces that are not on the same line");this.capturedSpaces=NZ.copyImmutableArray(e).sort((e,t)=>{if(e.x===t.x){if(e.y===t.y)throw new Error("Cannot create a GipfCapture with duplicate cases");return e.y>t.y?1:-1}return e.x>t.x?1:-1});let t=Nw.empty();for(const n of this.capturedSpaces){if(t.isPresent()&&1!==t.get().getDistance(n))throw new Error("Cannot create a GipfCapture with non-consecutive cases");t=Nw.of(n)}}toString(){let e="";for(const t of this.capturedSpaces)""!==e&&(e+=","),e+=t.toString();return e}size(){return this.capturedSpaces.length}forEach(e){this.capturedSpaces.forEach(e)}contains(e){for(let t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}intersectsWith(e){return this.capturedSpaces.some(t=>e.contains(t))}getLine(){return hQ.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}equals(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(let t=0;t<this.capturedSpaces.length;t++)if(!this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}IX.encoder=new class extends PZ{encode(e){return e.capturedSpaces.map(e=>GW.encoder.encode(e))}decode(e){return new IX(e.map(e=>GW.encoder.decode(e)))}};class kX{constructor(e,t){this.coord=e,this.direction=t}toString(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}equals(e){return!!this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}kX.encoder=new class extends PZ{constructor(){super(...arguments),this.optionalDirectionEncoder=TX(jW.encoder)}encode(e){return{coord:GW.encoder.encode(e.coord),direction:this.optionalDirectionEncoder.encode(e.direction)}}decode(e){const t=e;return hZ(null!=t.coord,"Invalid encoded GipfPlacement"),new kX(GW.encoder.decode(t.coord),this.optionalDirectionEncoder.decode(t.direction))}};class AX extends aj{constructor(e,t,n){super(),this.placement=e,this.initialCaptures=t,this.finalCaptures=n}toString(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}equals(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===NZ.compareArray(this.initialCaptures,e.initialCaptures)||!1===NZ.compareArray(this.finalCaptures,e.finalCaptures))}encode(){return AX.encoder.encode(this)}decode(e){return AX.encoder.decode(e)}}AX.encoder=new class extends SZ{encodeMove(e){const t={placement:kX.encoder.encode(e.placement)};return e.initialCaptures.map((e,n)=>{t["initialCapture"+n]=IX.encoder.encode(e)}),e.finalCaptures.map((e,n)=>{t["finalCapture"+n]=IX.encoder.encode(e)}),t}decodeMove(e){const t=e;return hZ(null!=t.placement,"Invalid encoded GipfMove"),new AX(kX.encoder.decode(t.placement),this.decodeArray(t,"initialCapture",IX.encoder.decode),this.decodeArray(t,"finalCapture",IX.encoder.decode))}decodeArray(e,t,n){const r=[];for(let i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}};class MX extends dQ{constructor(e,t,n,r){super(t,e,7,7,[3,2,1],WW.EMPTY),this.sidePieces=n,this.capturedPieces=r}static getInitialState(){const e=WW.EMPTY,t=WW.UNREACHABLE,n=WW.ZERO,r=WW.ONE;return new MX([[t,t,t,r,e,e,n],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[n,e,e,e,e,e,r],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[r,e,e,n,t,t,t]],0,[12,12],[0,0])}equals(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&NZ.compareTable(this.board,e.board)}getNumberOfPiecesToPlace(e){return this.sidePieces[e.value]}getNumberOfPiecesCaptured(e){return this.capturedPieces[e.value]}setAtUnsafe(e,t){const n=NZ.copyBiArray(this.board);return n[e.y][e.x]=t,new MX(n,this.turn,this.sidePieces,this.capturedPieces)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==WW.UNREACHABLE}}let NX=(()=>{class e{}return e.CAPTURE_MUST_BE_ALIGNED=()=>$localize`You can only capture when 4 or more of your pieces are aligned, and it is not the case.`,e.INVALID_CAPTURED_PIECES=()=>$localize`You must select a valid capture that contains 4 pieces or more.`,e.MISSING_CAPTURES=()=>$localize`There are still possible captures to be done.`,e.PLACEMENT_NOT_ON_BORDER=()=>$localize`Pieces must be inserted in spaces on the edge of the board.`,e.INVALID_PLACEMENT_DIRECTION=()=>$localize`You must select a valid placement direction.`,e.PLACEMENT_WITHOUT_DIRECTION=()=>$localize`You must select a placement with a direction alongside the insertion space.`,e.PLACEMENT_ON_COMPLETE_LINE=()=>$localize`You cannot place a piece on a complete line.`,e.AMBIGUOUS_CAPTURE_COORD=()=>$localize`This piece belongs to two captures. Please select another piece in the capture you'd like to make.`,e.CLICK_FURTHER_THAN_ONE_COORD=()=>$localize`You must click on an arrow to select your destination.`,e.NO_DIRECTIONS_AVAILABLE=()=>$localize`You cannot insert a piece here, as all lines are full. Select another space.`,e})();class RX extends mj{applyLegalMove(e,t,n){return new MX(n.board,n.turn+1,n.sidePieces,n.capturedPieces)}static applyCaptures(e,t){let n=t;return e.forEach(e=>{n=RX.applyCapture(e,n)}),n}static applyCapture(e,t){const n=t.getCurrentPlayer();let r=t;const i=[t.sidePieces[0],t.sidePieces[1]],s=[t.capturedPieces[0],t.capturedPieces[1]];return e.forEach(e=>{const o=t.getPieceAt(e);r=r.setAt(e,WW.EMPTY),o.is(n)?i[n.value]+=1:s[n.value]+=1}),new MX(r.board,t.turn,i,s)}static getPlacements(e){const t=[];return XW.INSTANCE.getAllBorders(e).forEach(n=>{e.getPieceAt(n)===WW.EMPTY?t.push(new kX(n,Nw.empty())):RX.getAllDirectionsForEntrance(e,n).forEach(r=>{!1===RX.isLineComplete(e,n,r)&&t.push(new kX(n,Nw.of(r)))})}),t}static isLineComplete(e,t,n){return RX.nextGapInLine(e,t,n).isAbsent()}static nextGapInLine(e,t,n){for(let r=t;e.isOnBoard(r);r=r.getNext(n))if(e.getPieceAt(r)===WW.EMPTY)return Nw.of(r);return Nw.empty()}static applyPlacement(e,t){const n=t.getCurrentPlayer();let r=t,i=WW.ofPlayer(t.getCurrentPlayer());if(e.direction.isAbsent()){const n=e.coord;if(t.getPieceAt(n)!==WW.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");r=r.setAt(n,i)}else for(let o=e.coord;r.isOnBoard(o)&&i!==WW.EMPTY;o=o.getNext(e.direction.get())){const e=t.getPieceAt(o);r=r.setAt(o,i),i=e}const s=[t.sidePieces[0],t.sidePieces[1]];return s[n.value]-=1,new MX(r.board,t.turn,s,t.capturedPieces)}getPiecesMoved(e,t,n){const r=RX.applyCaptures(t,e);if(n.direction.isAbsent())return[n.coord];{const e=n.direction.get(),t=[];t.push(n.coord);let i=n.coord.getNext(e);for(;r.isOnBoard(i)&&r.getPieceAt(i)!==WW.EMPTY;)t.push(i),i=i.getNext(e);return hZ(r.isOnBoard(i)&&r.getPieceAt(i)===WW.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),t.push(i),t}}static getAllDirectionsForEntrance(e,t){if(XW.INSTANCE.isTopLeftCorner(e,t))return[jW.RIGHT,jW.DOWN,jW.UP_RIGHT];if(XW.INSTANCE.isTopCorner(e,t))return[jW.DOWN,jW.DOWN_LEFT,jW.RIGHT];if(XW.INSTANCE.isTopRightCorner(e,t))return[jW.DOWN_LEFT,jW.DOWN,jW.LEFT];if(XW.INSTANCE.isBottomLeftCorner(e,t))return[jW.UP_RIGHT,jW.UP,jW.RIGHT];if(XW.INSTANCE.isBottomCorner(e,t))return[jW.UP,jW.LEFT,jW.UP_RIGHT];if(XW.INSTANCE.isBottomRightCorner(e,t))return[jW.LEFT,jW.UP,jW.DOWN_LEFT];if(XW.INSTANCE.isOnTopLeftBorder(e,t))return[jW.RIGHT,jW.DOWN];if(XW.INSTANCE.isOnLeftBorder(e,t))return[jW.UP_RIGHT,jW.RIGHT];if(XW.INSTANCE.isOnBottomLeftBorder(e,t))return[jW.UP,jW.UP_RIGHT];if(XW.INSTANCE.isOnBottomRightBorder(e,t))return[jW.LEFT,jW.UP];if(XW.INSTANCE.isOnRightBorder(e,t))return[jW.LEFT,jW.DOWN_LEFT];if(XW.INSTANCE.isOnTopRightBorder(e,t))return[jW.DOWN_LEFT,jW.DOWN];throw new Error("not a border")}isLegal(e,t){const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toFailedFallible();const r=RX.applyCaptures(e.initialCaptures,t),i=this.noMoreCapturesValidity(r);if(i.isFailure())return i.toFailedFallible();const s=this.placementValidity(r,e.placement);if(s.isFailure())return s.toFailedFallible();const o=RX.applyPlacement(e.placement,r),a=this.capturesValidity(o,e.finalCaptures);if(a.isFailure())return a.toFailedFallible();const l=RX.applyCaptures(e.finalCaptures,o),c=this.noMoreCapturesValidity(l);return c.isFailure()?c.toFailedFallible():Rw.success(l)}capturesValidity(e,t){let n=e;for(const r of t){const e=this.captureValidity(n,r);if(e.isFailure())return e;n=RX.applyCapture(r,n)}return Lw.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer(),r=RX.getLinePortionWithFourPiecesOfPlayer(e,n,t.getLine());if(r.isAbsent())return Lw.failure(NX.CAPTURE_MUST_BE_ALIGNED());const i=r.get();return RX.getCapturable(e,i).equals(t)?Lw.SUCCESS:Lw.failure(NX.INVALID_CAPTURED_PIECES())}static getLinePortionsWithFourPiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(r=>{const i=RX.getLinePortionWithFourPiecesOfPlayer(e,t,r);i.isPresent()&&n.push(i.get())}),n}static getLinePortionWithFourPiecesOfPlayer(e,t,n){let r=0;const i=e.getEntranceOnLine(n),s=n.getDirection();let o=i;for(let a=i;e.isOnBoard(a);a=a.getNext(s))if(e.getPieceAt(a).is(t)?(0===r&&(o=a),r+=1):r=0,4===r)return Nw.of({0:o,1:a,2:s});return Nw.empty()}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===RX.getLinePortionsWithFourPiecesOfPlayer(e,t).length?Lw.SUCCESS:Lw.failure(NX.MISSING_CAPTURES())}placementValidity(e,t){const n=this.placementCoordValidity(e,t.coord);if(n.isFailure())return n;if(e.getPieceAt(t.coord)!==WW.EMPTY){if(t.direction.isAbsent())return Lw.failure(NX.PLACEMENT_WITHOUT_DIRECTION());if(RX.isLineComplete(e,t.coord,t.direction.get()))return Lw.failure(NX.PLACEMENT_ON_COMPLETE_LINE());for(const n of RX.getAllDirectionsForEntrance(e,t.coord))if(n===t.direction.get())return Lw.SUCCESS;return Lw.failure(NX.INVALID_PLACEMENT_DIRECTION())}return Lw.SUCCESS}placementCoordValidity(e,t){return XW.INSTANCE.isOnBorder(e,t)?Lw.SUCCESS:Lw.failure(NX.PLACEMENT_NOT_ON_BORDER())}static getCapturable(e,t){const n=[],r=t[0],i=t[1],s=t[2],o=s.getOpposite();let a=r.getNext(o);for(;e.isOnBoard(a)&&e.getPieceAt(a)!==WW.EMPTY;)n.push(a),a=a.getNext(o);for(let l=r;!l.equals(i);l=l.getNext(s))n.push(l);for(let l=i;e.isOnBoard(l)&&e.getPieceAt(l)!==WW.EMPTY;l=l.getNext(s))n.push(l);return new IX(n)}static getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return RX.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(t=>{n.push(RX.getCapturable(e,t))}),n}static getPlayerScore(e,t){const n=e.getNumberOfPiecesToPlace(t);if(0===n&&0===RX.getPossibleCaptures(e).length)return Nw.empty();const r=e.getNumberOfPiecesCaptured(t);return Nw.of(n+3*r)}static isGameOver(e){const t=RX.getPlayerScore(e,TZ.ZERO),n=RX.getPlayerScore(e,TZ.ONE);return t.isAbsent()||n.isAbsent()}getGameStatus(e){const t=e.gameState,n=RX.getPlayerScore(t,TZ.ZERO),r=RX.getPlayerScore(t,TZ.ONE);return n.isAbsent()?gj.ONE_WON:r.isAbsent()?gj.ZERO_WON:gj.ONGOING}}class xX extends ej{static getPossibleCaptureCombinationsFromPossibleCaptures(e){const t=xX.computeIntersections(e);let n=[[]];return e.forEach((e,r)=>{if(0===t[r].length)n.forEach(e=>{e.push(r)});else{const e=[],i=t[r].some(e=>e>r);for(const s of n)!0===s.some(e=>t[r].some(t=>e===t))?e.push(NZ.copyImmutableArray(s)):i?(e.push(NZ.copyImmutableArray(s)),s.push(r),e.push(NZ.copyImmutableArray(s))):(s.push(r),e.push(NZ.copyImmutableArray(s)));n=e}}),n.map(t=>t.map(t=>e[t]))}static computeIntersections(e){const t=[];return e.forEach((n,r)=>{t.push([]),e.forEach((e,i)=>{r!==i&&n.intersectsWith(e)&&t[r].push(i)})}),t}getBoardValue(e){const t=e.gameState,n=RX.getPlayerScore(t,TZ.ZERO),r=RX.getPlayerScore(t,TZ.ONE);return n.isAbsent()?new tj(TZ.ONE.getVictoryValue()):r.isAbsent()?new tj(TZ.ZERO.getVictoryValue()):new tj(n.get()-r.get())}getListMoves(e){return this.getListMoveFromState(e.gameState)}getListMoveFromState(e){const t=[];return RX.isGameOver(e)||this.getPossibleCaptureCombinations(e).forEach(n=>{const r=RX.applyCaptures(n,e);RX.getPlacements(r).forEach(e=>{const i=RX.applyPlacement(e,r);this.getPossibleCaptureCombinations(i).forEach(r=>{const i=new AX(e,n,r);t.push(i)})})}),t}getPossibleCaptureCombinations(e){const t=RX.getPossibleCaptures(e);return xX.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}class DX{constructor(e,t,n,r,i,s){this.source=e,this.destination=t,this.x1=n,this.y1=r,this.x2=i,this.y2=s}}const LX=WW.UNREACHABLE,FX=WW.EMPTY,UX=WW.ZERO,VX=WW.ONE;class BX{constructor(){this.tutorial=[_j.informational($localize`Goal of the game`,$localize`The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.
        This is the initial board.
        Each player has 12 pieces on the side and 3 pieces on the board.
        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.
        The first player plays with the dark pieces, the second player plays with the light pieces.`,MX.getInitialState()),_j.anyMove($localize`Pushing`,$localize`Pieces can only enter the board through the edges. To insert a new piece:
        <ol>
            <li>Click on a space on the edge of the board.</li>
            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>
        </ol>
        You cannot push when a line is full.<br/><br/>
        You're playing Dark, insert a piece.`,MX.getInitialState(),new AX(new kX(new GW(3,0),Nw.of(jW.DOWN)),[],[]),$localize`Congratulations!`),_j.fromMove($localize`Capture (1/3)`,$localize`To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.
        There are multiple important aspects of a capture:
        <ol>
            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>
            <li>As soon as there is an empty space on the line, the capture stops.</li>
            <li>Your own pieces that are captured go back to your stock.
                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>
            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.
                This means that a turn happens in three phases:
                <ol type="A">
                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>
                    <li>Make your insertion.</li>
                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>
                </ol>
            </li>
        </ol><br/>
        You're playing Dark, you can make a capture, do it.`,new MX([[LX,LX,LX,UX,VX,FX,FX],[LX,LX,FX,FX,FX,FX,FX],[LX,FX,FX,FX,FX,FX,FX],[UX,UX,UX,FX,FX,FX,FX],[VX,FX,FX,FX,FX,FX,LX],[FX,FX,FX,VX,FX,LX,LX],[FX,FX,FX,VX,LX,LX,LX]],42,[8,8],[0,0]),[new AX(new kX(new GW(0,3),Nw.of(jW.RIGHT)),[],[new IX([new GW(0,3),new GW(1,3),new GW(2,3),new GW(3,3)])])],$localize`Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.
        Let's now see how captures can really be useful.`,$localize`Failed!`),_j.fromMove($localize`Capture (2/3)`,$localize`Here, there are three different ways of capturing.
        <ol>
          <li>One way does not capture any of your opponent's pieces.</li>
          <li>Another way captures one of your opponent's pieces.</li>
          <li>The last way captures two of your opponent's pieces.</li>
        </ol>
        <br/><br/>
        Pick the last one.`,new MX([[LX,LX,LX,FX,FX,FX,FX],[LX,LX,FX,VX,FX,FX,FX],[LX,FX,FX,UX,FX,FX,FX],[UX,UX,UX,VX,FX,FX,FX],[FX,FX,FX,UX,FX,FX,LX],[FX,FX,FX,UX,FX,LX,LX],[FX,FX,FX,VX,LX,LX,LX]],42,[8,4],[2,3]),[new AX(new kX(new GW(0,3),Nw.of(jW.RIGHT)),[],[new IX([new GW(3,1),new GW(3,2),new GW(3,3),new GW(3,4),new GW(3,5),new GW(3,6)])])],$localize`Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.
        The most you can get is 3 per capture.`,$localize`Failed, the best capture was taking 2 of your opponent's pieces`),_j.fromMove($localize`Capture (3/3)`,$localize`Here, you must capture at the beginning of your turn.
        This is due to a move of your opponent at the previous turn
        (even though this is a fictitious board for pedagogical purpose).
        After your capture, by performing the right move you can even capture two more of your opponent's pieces!
        Keep it mind that the most useful in a capture is to take your opponent's pieces.`,new MX([[LX,LX,LX,UX,FX,FX,UX],[LX,LX,FX,UX,FX,FX,UX],[LX,UX,UX,FX,UX,VX,UX],[FX,FX,FX,UX,FX,FX,UX],[FX,FX,FX,UX,FX,FX,LX],[UX,UX,UX,VX,VX,LX,LX],[FX,FX,FX,UX,LX,LX,LX]],42,[8,4],[2,3]),[new AX(new kX(new GW(3,6),Nw.of(jW.UP)),[new IX([new GW(6,0),new GW(6,1),new GW(6,2),new GW(6,3)])],[new IX([new GW(0,5),new GW(1,5),new GW(2,5),new GW(3,5),new GW(4,5)]),new IX([new GW(1,2),new GW(2,2),new GW(3,2),new GW(4,2),new GW(5,2)])]),new AX(new kX(new GW(4,6),Nw.of(jW.UP)),[new IX([new GW(6,0),new GW(6,1),new GW(6,2),new GW(6,3)])],[new IX([new GW(0,5),new GW(1,5),new GW(2,5),new GW(3,5),new GW(4,5)]),new IX([new GW(3,0),new GW(3,1),new GW(3,2),new GW(3,3),new GW(3,4)])]),new AX(new kX(new GW(3,6),Nw.of(jW.UP)),[new IX([new GW(6,0),new GW(6,1),new GW(6,2),new GW(6,3)])],[new IX([new GW(1,2),new GW(2,2),new GW(3,2),new GW(4,2),new GW(5,2)]),new IX([new GW(0,5),new GW(1,5),new GW(2,5),new GW(3,5),new GW(4,5)])])],$localize`Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces.`,$localize`Failed, the best capture takes 2 of your opponent's pieces.`)]}}function $X(e,t){if(1&e&&(_n(),ga(0,"circle",11)),2&e){const e=Sa().$implicit,t=Sa();ha("ngClass",t.getPieceClass(e)),ra("cx",t.getCenterAt(e).x)("cy",t.getCenterAt(e).y)("r",t.SPACE_SIZE)}}function zX(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"g",8),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t)}),ga(2,"polyline",9),la(3,$X,1,4,"circle",10),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa();Ts(1),Ia("id","click_",e.x,"_",e.y,""),Ts(1),Ia("id","case_",e.x,"_",e.y,""),ha("ngClass",n.getSpaceClass(e)),ra("points",n.getHexaCoordsAt(e)),Ts(1),ha("ngIf",n.isPiece(e))}}function HX(e,t){if(1&e){const e=va();_n(),fa(0,"polyline",14),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).onClick(t)}),pa()}if(2&e){const e=t.$implicit;ra("points",Sa(2).getHexaCoordsAt(e))}}function GX(e,t){if(1&e&&(_n(),fa(0,"g",12),la(1,HX,1,1,"polyline",13),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e.capturedSpaces)}}function ZX(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"line",15),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t.destination)}),pa(),pa()}if(2&e){const e=t.$implicit;Ts(1),ra("x1",e.x1)("y1",e.y1)("x2",e.x2)("y2",e.y2)}}function qX(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"circle",16),pa()),2&e){const e=t.$implicit,n=Sa().$implicit,r=Sa();Ts(1),Ia("id","piece_",n,"_",e,""),ha("ngClass",r.getSidePieceClass(n)),ra("cx",10+e*r.SPACE_SIZE*.5)("cy",10+(r.SPACE_SIZE+10)*n)("r",.5*r.SPACE_SIZE)}}function WX(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,qX,2,6,"g",5),pa()),2&e){const e=t.$implicit,n=Sa();Ts(1),ha("ngForOf",n.getPlayerSidePieces(e))}}function jX(e,t){if(1&e&&(_n(),ga(0,"line",17)),2&e){const e=Sa();ra("x1",e.inserted.get().x1)("y1",e.inserted.get().y1)("x2",e.inserted.get().x2)("y2",e.inserted.get().y2)}}const YX=function(){return[0,1]};let KX=(()=>{class e extends qW{constructor(t){super(t),this.inserted=Nw.empty(),this.arrows=[],this.captured=[],this.moved=[],this.movePhase=e.PHASE_PLACEMENT_COORD,this.possibleCaptures=[],this.initialCaptures=[],this.placement=Nw.empty(),this.placementEntrance=Nw.empty(),this.finalCaptures=[],this.scores=Nw.of([0,0]),this.rules=new RX(MX),this.availableMinimaxes=[new xX(this.rules,"GipfMinimax")],this.encoder=AX.encoder,this.tutorial=(new BX).tutorial,this.SPACE_SIZE=40,this.constructedState=this.rules.node.gameState,this.hexaLayout=new YW(1.5*this.SPACE_SIZE,new GW(2*this.SPACE_SIZE,0),XW.INSTANCE)}updateBoard(){this.showLastMove(),this.cancelMoveAttempt(),this.moveToInitialCaptureOrPlacementPhase()}showLastMove(){this.inserted=Nw.empty();const e=this.rules.node.move;if(e.isPresent()&&e.get().placement.direction.isPresent()){const t=e.get().placement;this.inserted=Nw.of(this.arrowTowards(t.coord,t.direction.get()))}this.cancelMoveAttempt()}arrowTowards(e,t){const n=e.getNext(t.getOpposite()),r=this.getCenterAt(e),i=this.getCenterAt(n);return new DX(n,e,i.x,i.y,r.x,r.y)}markCapture(e){e.forEach(e=>{this.captured.push(e)})}getAllCoords(){return this.constructedState.allCoords()}getPlayerSidePieces(e){const t=this.constructedState.getNumberOfPiecesToPlace(TZ.of(e)),n=[];for(let r=0;r<t;r+=1)n.push(r);return n}isPiece(e){return this.getPiece(e)!==WW.EMPTY}getPiece(e){return this.constructedState.getPieceAt(e)}onClick(t){var n=this;return Ow(function*(){const r=n.canUserPlay("#click_"+t.x+"_"+t.y);if(r.isFailure())return n.cancelMove(r.getReason());switch(n.movePhase){case e.PHASE_INITIAL_CAPTURE:case e.PHASE_FINAL_CAPTURE:return n.selectCapture(t);case e.PHASE_PLACEMENT_COORD:return n.selectPlacementCoord(t);default:Tw.expectToBe(n.movePhase,e.PHASE_PLACEMENT_DIRECTION);const r=n.placementEntrance.get();if(!1===r.isAlignedWith(t))return n.cancelMove(NX.INVALID_PLACEMENT_DIRECTION());if(1!==r.getDistance(t))return n.cancelMove(NX.CLICK_FURTHER_THAN_ONE_COORD());const i=jW.factory.fromMove(r,t);return n.selectPlacementDirection(i.toOptional())}})()}selectCapture(t){var n=this;return Ow(function*(){const r=[];if(n.possibleCaptures.forEach(e=>{e.contains(t)&&r.push(e)}),r.length>1)return n.cancelMove(NX.AMBIGUOUS_CAPTURE_COORD());if(0===r.length)return n.cancelMove(NX.MISSING_CAPTURES());const i=r[0];return n.constructedState=RX.applyCapture(i,n.constructedState),n.markCapture(i),n.possibleCaptures=RX.getPossibleCaptures(n.constructedState),n.movePhase===e.PHASE_INITIAL_CAPTURE?(n.initialCaptures.push(i),0===n.possibleCaptures.length?n.moveToPlacementPhase():Lw.SUCCESS):(Tw.expectToBe(n.movePhase,e.PHASE_FINAL_CAPTURE),n.finalCaptures.push(i),0===n.possibleCaptures.length?n.tryMove(n.initialCaptures,n.placement.get(),n.finalCaptures):Lw.SUCCESS)})()}moveToPlacementPhase(){return this.movePhase=e.PHASE_PLACEMENT_COORD,Lw.SUCCESS}moveToInitialCaptureOrPlacementPhase(){return this.possibleCaptures=RX.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?e.PHASE_PLACEMENT_COORD:e.PHASE_INITIAL_CAPTURE,Lw.SUCCESS}moveToFinalCapturePhaseOrTryMove(){var t=this;return Ow(function*(){return t.possibleCaptures=RX.getPossibleCaptures(t.constructedState),0===t.possibleCaptures.length?t.tryMove(t.initialCaptures,t.placement.get(),t.finalCaptures):(t.movePhase=e.PHASE_FINAL_CAPTURE,Lw.SUCCESS)})()}computeArrows(e){this.arrows=[];for(const t of RX.getAllDirectionsForEntrance(this.constructedState,e))if(!1===RX.isLineComplete(this.constructedState,e,t)){const n=e.getNext(t),r=this.getCenterAt(e),i=this.getCenterAt(n);this.arrows.push(new DX(e,n,r.x,r.y,i.x,i.y))}}selectPlacementCoord(t){var n=this;return Ow(function*(){const r=n.rules.placementCoordValidity(n.constructedState,t);return r.isFailure()?n.cancelMove(r.getReason()):(n.placementEntrance=Nw.of(t),n.constructedState.getPieceAt(t)===WW.EMPTY?n.selectPlacementDirection(Nw.empty()):(n.movePhase=e.PHASE_PLACEMENT_DIRECTION,n.computeArrows(t),0===n.arrows.length&&n.cancelMove(NX.NO_DIRECTIONS_AVAILABLE()),Lw.SUCCESS))})()}selectPlacementDirection(e){var t=this;return Ow(function*(){t.placement=Nw.of(new kX(t.placementEntrance.get(),e));const n=t.rules.placementValidity(t.constructedState,t.placement.get());return n.isFailure()?t.cancelMove(n.getReason()):(t.arrows=[],t.constructedState=RX.applyPlacement(t.placement.get(),t.constructedState),t.moveToFinalCapturePhaseOrTryMove())})()}tryMove(e,t,n){var r=this;return Ow(function*(){const i=new AX(t,e,n);return yield r.chooseMove(i,r.rules.node.gameState,r.scores.get())})()}cancelMoveAttempt(){this.constructedState=this.rules.node.gameState,this.captured=[],this.moved=[];const e=this.rules.node.move;if(e.isPresent()){const t=e.get(),n=this.rules.node.mother.get().gameState;t.initialCaptures.forEach(e=>this.markCapture(e)),t.finalCaptures.forEach(e=>this.markCapture(e)),this.moved=this.rules.getPiecesMoved(n,t.initialCaptures,t.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=Nw.empty(),this.placement=Nw.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}getSpaceClass(e){return this.captured.some(t=>t.equals(e))?"captured":this.moved.some(t=>t.equals(e))?"moved":""}getPieceClass(e){const t=this.getPiece(e);return this.getPlayerClass(TZ.of(t.value))}getSidePieceClass(e){return this.getPlayerClass(TZ.of(e))}}return e.PHASE_INITIAL_CAPTURE=0,e.PHASE_PLACEMENT_COORD=1,e.PHASE_PLACEMENT_DIRECTION=2,e.PHASE_FINAL_CAPTURE=3,e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-gipf"]],features:[Go],decls:11,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -12 708 854","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved","moved-stroke"],[4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),fa(1,"defs"),fa(2,"marker",1),ga(3,"polygon",2),pa(),fa(4,"marker",3),ga(5,"polygon",4),pa(),pa(),la(6,zX,4,7,"g",5),la(7,GX,2,1,"g",6),la(8,ZX,2,4,"g",5),la(9,WX,2,1,"g",5),la(10,jX,1,4,"line",7),pa()),2&e&&(Ts(6),ha("ngForOf",t.getAllCoords()),Ts(1),ha("ngForOf",t.possibleCaptures),Ts(1),ha("ngForOf",t.arrows),Ts(1),ha("ngForOf",wu(5,YX)),Ts(1),ha("ngIf",t.inserted.isPresent()))},directives:[tf,rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class QX extends lj{equals(e){return this===e||this.coord.equals(e.coord)}toString(){return this===QX.PASS?"GoMove.PASS":this===QX.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}QX.PASS=new QX(-1,0),QX.ACCEPT=new QX(-2,0),QX.PASS_NUMBER=-1,QX.ACCEPT_NUMBER=-2,QX.encoder=new class extends bZ{maxValue(){return 360}encodeNumber(e){return 19*e.coord.y+e.coord.x}decodeNumber(e){if(e===QX.PASS_NUMBER)return QX.PASS;const t=e%19;return new QX(t,(e-t)/19)}};class XX{constructor(e,t){this.player=e,this.type=t}equals(e){return e===this}toString(){switch(this){case XX.DARK:return"GoPiece.DARK";case XX.LIGHT:return"GoPiece.LIGHT";case XX.EMPTY:return"GoPiece.EMPTY";case XX.DEAD_DARK:return"GoPiece.DEAD_DARK";case XX.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case XX.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return hZ(this===XX.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}static pieceBelongTo(e,t){return t===e.player&&"territory"!==e.type}static ofPlayer(e){return e===TZ.ZERO?XX.DARK:XX.LIGHT}isOccupied(){return[XX.DARK,XX.LIGHT,XX.DEAD_DARK,XX.DEAD_LIGHT].includes(this)}isEmpty(){return[XX.DARK_TERRITORY,XX.LIGHT_TERRITORY,XX.EMPTY].includes(this)}isDead(){return[XX.DEAD_DARK,XX.DEAD_LIGHT].includes(this)}isTerritory(){return[XX.DARK_TERRITORY,XX.LIGHT_TERRITORY].includes(this)}getOwner(){return this.player}nonTerritory(){return hZ(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),XX.EMPTY}}XX.DARK=new XX(TZ.ZERO,"alive"),XX.LIGHT=new XX(TZ.ONE,"alive"),XX.EMPTY=new XX(IZ.NONE,"empty"),XX.DEAD_DARK=new XX(TZ.ZERO,"dead"),XX.DEAD_LIGHT=new XX(TZ.ONE,"dead"),XX.DARK_TERRITORY=new XX(IZ.NONE,"territory"),XX.LIGHT_TERRITORY=new XX(IZ.NONE,"territory");var JX=(()=>(function(e){e.PLAYING="PLAYING",e.PASSED="PASSED",e.COUNTING="COUNTING",e.ACCEPT="ACCEPT",e.FINISHED="FINISHED"}(JX||(JX={})),JX))();let eJ=(()=>{class e extends sj{constructor(e,t,n,r,i){super(e,n),this.captured=t,this.koCoord=r,this.phase=i}static getInitialState(){const t=e.getStartingBoard();return new e(t,[0,0],0,Nw.empty(),JX.PLAYING)}getCapturedCopy(){return[this.captured[0],this.captured[1]]}static getStartingBoard(){return NZ.createTable(e.WIDTH,e.HEIGHT,XX.EMPTY)}copy(){return new e(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}isDead(e){return this.getPieceAt(e).isDead()}isTerritory(e){return this.getPieceAt(e).isTerritory()}}return e.WIDTH=13,e.HEIGHT=13,e})(),tJ=(()=>{class e{constructor(e){this.color=e}selfContains(e){return this.getCoords().some(t=>t.equals(e))}static insertAsEntryPoint(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}return e.VERBOSE=!1,e})();class nJ extends tJ{constructor(e,t,n,r,i,s){super(e),this.emptyCoords=t,this.darkCoords=n,this.lightCoords=r,this.deadDarkCoords=i,this.deadLightCoords=s}getCoords(){return this.color===XX.DARK?this.darkCoords:this.color===XX.LIGHT?this.lightCoords:this.color===XX.DEAD_DARK?this.deadDarkCoords:this.color===XX.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}contains(e){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(t=>t.equals(e))}addPawn(e,t){switch(hZ(!1===this.contains(e),"This group already contains "+e.toString()),t){case XX.DARK:this.darkCoords=tJ.insertAsEntryPoint(this.darkCoords,e);break;case XX.LIGHT:this.lightCoords=tJ.insertAsEntryPoint(this.lightCoords,e);break;case XX.DEAD_DARK:this.deadDarkCoords=tJ.insertAsEntryPoint(this.deadDarkCoords,e);break;case XX.DEAD_LIGHT:this.deadLightCoords=tJ.insertAsEntryPoint(this.deadLightCoords,e);break;default:Tw.expectToBeMultiple(t,[XX.EMPTY,XX.DARK_TERRITORY,XX.LIGHT_TERRITORY]),this.emptyCoords=tJ.insertAsEntryPoint(this.emptyCoords,e)}}isMonoWrapped(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}getWrapper(){const e=new hj;e.set(XX.EMPTY,this.emptyCoords.length),e.set(XX.DARK,this.darkCoords.length+this.deadLightCoords.length),e.set(XX.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),e.put(this.color.nonTerritory(),0);const t=e.filter((e,t)=>t>0);if(1===t.size())return t.getByIndex(0).key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}getNeighborsEntryPoints(){const e=[];return this.color!==XX.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==XX.DARK&&this.darkCoords.length>0&&e.push(this.darkCoords[0]),this.color!==XX.LIGHT&&this.lightCoords.length>0&&e.push(this.lightCoords[0]),this.color!==XX.DEAD_DARK&&this.deadDarkCoords.length>0&&e.push(this.deadDarkCoords[0]),this.color!==XX.DEAD_LIGHT&&this.deadLightCoords.length>0&&e.push(this.deadLightCoords[0]),e}}class rJ extends class{getGroupDatas(e,t){Iw(tJ.VERBOSE,"GroupDatas.getGroupDatas("+e+", "+t+")");const n=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,n)}_getGroupDatas(e,t,n){Iw(tJ.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:n,coord:e}});const r=t[e.y][e.x];if(n.addPawn(e,r),r===n.color)for(const i of this.getDirections()){const r=e.getNext(i);r.isInRange(t[0].length,t.length)&&(n.contains(r)||(n=this._getGroupDatas(r,t,n)))}return n}}{getNewInstance(e){return new nJ(e,[],[],[],[],[])}getDirections(){return zW.ORTHOGONALS}}let iJ=(()=>{class e{}return e.ILLEGAL_KO=()=>$localize`This move is a ko, you must play somewhere else before you can play in this intersection again.`,e.CANNOT_PASS_AFTER_PASSED_PHASE=()=>$localize`We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn.`,e.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=()=>$localize`You cannot accept before the counting phase.`,e.OCCUPIED_INTERSECTION=()=>$localize`This intersection is already occupied.`,e.CANNOT_COMMIT_SUICIDE=()=>$localize`You cannot commit suicide.`,e})(),sJ=(()=>{class e extends mj{static isLegal(t,n){const r=!1;if(Iw(e.VERBOSE||r,{isLegal:{move:t,state:n}}),e.isPass(t)){const t=n.phase===JX.PLAYING,i=n.phase===JX.PASSED;return Iw(e.VERBOSE||r,"GoRules.isLegal at "+n.phase+(t||i?" forbid":" allowed")+" passing on "+n.getCopiedBoard()),t||i?Rw.success([]):Rw.failure(iJ.CANNOT_PASS_AFTER_PASSED_PHASE())}if(e.isAccept(t)){const e=n.phase===JX.ACCEPT;return n.phase===JX.COUNTING||e?Rw.success([]):Rw.failure(iJ.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return e.isOccupied(t.coord,n.getCopiedBoard())?(Iw(e.VERBOSE||r,"GoRules.isLegal: move is marking"),e.isLegalDeadMarking(t,n)?Rw.success([]):Rw.failure(iJ.OCCUPIED_INTERSECTION())):(Iw(e.VERBOSE||r,"GoRules.isLegal: move is normal stuff: "+t.toString()),e.isLegalNormalMove(t,n))}static getNewKo(e,t,n){if(1===n.length){const r=n[0],i=e.coord,s=t[i.y][i.x],o=(new rJ).getGroupDatas(i,t),a=o.emptyCoords,l=XX.pieceBelongTo(s,TZ.ZERO)?o.darkCoords:o.lightCoords;if(1===a.length&&a[0].equals(r)&&1===l.length)return Nw.of(r)}return Nw.empty()}static markTerritoryAndCount(t){Iw(e.VERBOSE,{markTerritoryAndCount:{state:t}});const n=t.getCopiedBoard(),r=e.getTerritoryLikeGroup(t),i=t.getCapturedCopy();for(const e of r){const t=e.getWrapper();if(t===XX.LIGHT){i[1]+=e.emptyCoords.length;for(const t of e.getCoords())n[t.y][t.x]=XX.LIGHT_TERRITORY}else{hZ(t===XX.DARK,"territory should be wrapped by dark or light, not by "+t.toString()),i[0]+=e.emptyCoords.length;for(const t of e.getCoords())n[t.y][t.x]=XX.DARK_TERRITORY}}return new eJ(n,i,t.turn,t.koCoord,t.phase)}static removeAndSubstractTerritory(e){const t=e.getCopiedBoard(),n=e.getCapturedCopy();let r;for(let i=0;i<e.board.length;i++)for(let s=0;s<e.board[0].length;s++)r=t[i][s],r===XX.DARK_TERRITORY?(t[i][s]=XX.EMPTY,n[0]=n[0]-1):r===XX.LIGHT_TERRITORY&&(t[i][s]=XX.EMPTY,n[1]=n[1]-1);return new eJ(t,n,e.turn,e.koCoord,e.phase)}static getEmptyZones(t){return e.getGroupsDatasWhere(t.getCopiedBoard(),e=>e.isEmpty())}static getGroupsDatasWhere(e,t){const n=[];let r,i,s;const o=new rJ;for(let a=0;a<e.length;a++)for(let l=0;l<e[0].length;l++)r=new GW(l,a),s=e[a][l],t(s)&&(n.some(e=>e.selfContains(r))||(i=o.getGroupDatas(r,e),n.push(i)));return n}static addDeadToScore(e){const t=e.getCapturedCopy();let n,r=t[1],i=t[0];for(let s=0;s<e.board.length;s++)for(let t=0;t<e.board[0].length;t++)n=e.getPieceAtXY(t,s),n===XX.DEAD_DARK?r++:n===XX.DEAD_LIGHT&&i++;return[i,r]}static switchAliveness(e,t){const n=t.getCopiedBoard();hZ(!1===n[e.y][e.x].isEmpty(),"Can't switch emptyness aliveness");const r=(new rJ).getGroupDatas(e,n),i=t.getCapturedCopy();switch(r.color){case XX.DEAD_DARK:i[1]-=2*r.deadDarkCoords.length;for(const e of r.deadDarkCoords)n[e.y][e.x]=XX.DARK;break;case XX.DEAD_LIGHT:i[0]-=2*r.deadLightCoords.length;for(const e of r.deadLightCoords)n[e.y][e.x]=XX.LIGHT;break;case XX.LIGHT:i[0]+=2*r.lightCoords.length;for(const e of r.lightCoords)n[e.y][e.x]=XX.DEAD_LIGHT;break;default:Tw.expectToBe(r.color,XX.DARK),i[1]+=2*r.darkCoords.length;for(const e of r.darkCoords)n[e.y][e.x]=XX.DEAD_DARK}return new eJ(n,i,t.turn,t.koCoord,t.phase)}static getGameStatus(e){const t=e.gameState;return t.phase===JX.FINISHED?t.captured[0]>t.captured[1]?gj.ZERO_WON:t.captured[1]>t.captured[0]?gj.ONE_WON:gj.DRAW:gj.ONGOING}static isPass(e){return e.equals(QX.PASS)}static isAccept(e){return e.equals(QX.ACCEPT)}static isLegalDeadMarking(t,n){return e.isOccupied(t.coord,n.getCopiedBoard())&&(n.phase===JX.COUNTING||n.phase===JX.ACCEPT)}static isLegalNormalMove(t,n){const r=n.getCopiedBoard();if(e.isKo(t,n))return Rw.failure(iJ.ILLEGAL_KO());[JX.COUNTING,JX.ACCEPT].includes(n.phase)&&(n=e.resurrectStones(n));const i=e.getCaptureState(t,n);if(oJ.isCapturing(i))return Rw.success(i.capturedCoords);{r[t.coord.y][t.coord.x]=n.turn%2==0?XX.DARK:XX.LIGHT;const e=0===(new rJ).getGroupDatas(t.coord,r).emptyCoords.length;return r[t.coord.y][t.coord.x]=XX.EMPTY,e?Rw.failure(iJ.CANNOT_COMMIT_SUICIDE()):Rw.success([])}}static isOccupied(e,t){return t[e.y][e.x].isOccupied()}static isKo(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}static getCaptureState(t,n){Iw(e.VERBOSE||!1,{getCaptureState:{move:t,state:n}});const r=new oJ;let i;for(const s of zW.ORTHOGONALS)i=e.getCapturedInDirection(t.coord,s,n),i.length>0&&r.capturedCoords.every(e=>!i[0].equals(e))&&(r.capturedCoords=r.capturedCoords.concat(i));return r}static getCapturedInDirection(t,n,r){const i=r.getCopiedBoard(),s=t.getNext(n);if(s.isInRange(r.board[0].length,r.board.length)&&i[s.y][s.x]===(r.turn%2==0?XX.LIGHT:XX.DARK)){Iw(e.VERBOSE||!1,"a group could be captured");const t=(new rJ).getGroupDatas(s,i);if(e.isCapturableGroup(t,r.koCoord))return Iw(e.VERBOSE||!1,{neightbooringGroupCoord:t.getCoords(),message:"is capturable"}),t.getCoords()}return[]}static isCapturableGroup(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}static getTerritoryLikeGroup(t){return e.getEmptyZones(t).filter(e=>e.isMonoWrapped())}static applyPass(t){const n=t.getCopiedBoard(),r=t.getCapturedCopy(),i=t.turn;let s,o;return t.phase===JX.PASSED?(s=JX.COUNTING,o=new eJ(n,r,i+1,Nw.empty(),s),o=e.markTerritoryAndCount(o)):(hZ(t.phase===JX.PLAYING,"Cannot pass in counting phase!"),s=JX.PASSED,o=new eJ(n,r,i+1,Nw.empty(),s)),o}static applyLegalAccept(e){const t=e.getCopiedBoard();let n;return n=e.phase===JX.COUNTING?JX.ACCEPT:JX.FINISHED,new eJ(t,e.getCapturedCopy(),e.turn+1,Nw.empty(),n)}static applyNormalLegalMove(t,n,r){let i;Iw(e.VERBOSE,{applyNormalLegal:{currentState:n,legalMove:t,status}}),i=[JX.COUNTING,JX.ACCEPT].includes(n.phase)?e.resurrectStones(n):n.copy();const s=t.coord.x,o=t.coord.y,a=i.getCopiedBoard(),l=i.turn,c=XX.ofPlayer(i.getCurrentPlayer()),u=l+1;a[o][s]=c;for(const e of r)a[e.y][e.x]=XX.EMPTY;const h=e.getNewKo(t,a,r),d=i.getCapturedCopy();return d[c.player.value]+=r.length,new eJ(a,d,u,h,JX.PLAYING)}static resurrectStones(t){for(let n=0;n<t.board.length;n++)for(let r=0;r<t.board[0].length;r++)t.getPieceAtXY(r,n).isDead()&&(t=e.switchAliveness(new GW(r,n),t));return e.removeAndSubstractTerritory(t)}static applyDeadMarkingMove(t,n){Iw(e.VERBOSE,{applyDeadMarkingMove:{legalMove:t,state:n}});const r=e.removeAndSubstractTerritory(n),i=e.switchAliveness(t.coord,r),s=new eJ(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,Nw.empty(),JX.COUNTING);return e.markTerritoryAndCount(s)}isLegal(t,n){return e.isLegal(t,n)}applyLegalMove(t,n,r){return Iw(e.VERBOSE,{applyLegalMove:{legalMove:t,state:n,status:r}}),e.isPass(t)?(Iw(e.VERBOSE,"GoRules.applyLegalMove: isPass"),e.applyPass(n)):e.isAccept(t)?(Iw(e.VERBOSE,"GoRules.applyLegalMove: isAccept"),e.applyLegalAccept(n)):e.isLegalDeadMarking(t,n)?(Iw(e.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),e.applyDeadMarkingMove(t,n)):(Iw(e.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),e.applyNormalLegalMove(t,n,r))}getGameStatus(t){return e.getGameStatus(t)}}return e.VERBOSE=!1,e})();class oJ{constructor(){this.capturedCoords=[]}static isCapturing(e){return e.capturedCoords.length>0}}class aJ extends ej{getListMoves(e){Iw(sJ.VERBOSE||!1,"GoRules.getListMoves");const t=e.gameState,n=this.getPlayingMovesList(t);if(t.phase===JX.PLAYING||t.phase===JX.PASSED)return n.push(QX.PASS),n;{Iw(sJ.VERBOSE||!1,"GoRules.getListMoves in counting phase");const e=this.getCountingMovesList(t);return 0===e.length?[QX.ACCEPT]:e}}getPlayingMovesList(e){const t=[];let n;for(let r=0;r<e.board.length;r++)for(let i=0;i<e.board[0].length;i++)n=new QX(i,r),e.getPieceAt(n.coord)===XX.EMPTY&&sJ.isLegal(n,e).isSuccess()&&t.push(n);return t}getCountingMovesList(e){const t=[],n=this.getCorrectBoard(e).getCopiedBoard(),r=sJ.getGroupsDatasWhere(n,e=>e!==XX.EMPTY);for(const i of r){const r=i.getCoords()[0],s=n[r.y][r.x];if(e.getPieceAt(r)!==s){const e=new QX(r.x,r.y);return t.push(e),t}}return t}getCorrectBoard(e){const t=this.mapBoard(e.getCopiedBoard(),e=>e===XX.DARK?XX.DEAD_DARK:e===XX.LIGHT?XX.DEAD_LIGHT:e.isTerritory()?XX.EMPTY:e),n=new eJ(t,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),r=sJ.getTerritoryLikeGroup(n);return this.setAliveUniqueWrapper(n,r)}mapBoard(e,t){for(let n=0;n<e.length;n++)for(let r=0;r<e[0].length;r++)e[n][r]=t(e[n][r]);return e}setAliveUniqueWrapper(e,t){let n,r=e.copy();for(const i of t){n=i.deadDarkCoords.concat(i.deadLightCoords);for(const e of n)r.isDead(e)&&(r=sJ.switchAliveness(e,r))}return r}getBoardValue(e){const t=e.gameState,n=sJ.getGameStatus(e);if(n.isEndGame)return new tj(n.toBoardValue());Iw(sJ.VERBOSE||!1,"GoRules.getBoardValue");const r=sJ.markTerritoryAndCount(t),i=r.getCapturedCopy(),s=this.getDeadStones(r);return new tj(i[1]+2*s[0]-(i[0]+2*s[1]))}getDeadStones(e){const t=[0,0];for(let n=0;n<e.board.length;n++)for(let r=0;r<e.board[0].length;r++){const i=e.getPieceAtXY(r,n);"dead"===i.type&&(t[i.player.value]=t[i.player.value]+1)}return t}}const lJ=XX.LIGHT,cJ=XX.DARK,uJ=XX.DEAD_LIGHT,hJ=XX.LIGHT_TERRITORY,dJ=XX.DARK_TERRITORY,fJ=XX.EMPTY;class pJ{constructor(){this.tutorial=[_j.informational($localize`Preliminary information`,$localize`The game of Go is played on a board called a Goban, and the stones are placed on the intersections.
        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.
        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).
        For this tutorial, we will use a smaller board for pedagogical purposes.`,eJ.getInitialState()),_j.informational($localize`Goal of the game`,$localize`The goal of the game is to have the most points at the end of the game.
        We call "territories" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.
        Here, Dark has 9 territories on the left, and Light has 8 on the right.
        The top part belongs to no one.
        Each player's score at the end of the game is the sum of that player's territories and captures.`,new eJ([[fJ,cJ,fJ,fJ,lJ,lJ],[fJ,cJ,fJ,fJ,lJ,fJ],[fJ,cJ,cJ,lJ,lJ,fJ],[fJ,fJ,cJ,lJ,fJ,fJ],[fJ,fJ,cJ,lJ,fJ,fJ],[fJ,fJ,cJ,lJ,fJ,fJ]],[0,0],0,Nw.empty(),JX.PLAYING)),_j.fromMove($localize`Simple capture`,$localize`An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).
        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.
        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>
        The light piece only has one liberty left, play there.`,new eJ([[fJ,fJ,fJ,fJ,fJ],[fJ,fJ,cJ,fJ,fJ],[fJ,cJ,lJ,fJ,fJ],[fJ,fJ,cJ,fJ,fJ],[fJ,fJ,fJ,fJ,fJ]],[0,0],0,Nw.empty(),JX.PLAYING),[new QX(3,2)],$localize`Congratulations, you have earned one point.`,$localize`Failed, try again by playing on one of the intersections directly next to the light stone.`),_j.fromMove($localize`Capturing multiple stones`,$localize`Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>
        The light group here only has one liberty left, capture it.`,new eJ([[fJ,cJ,fJ,fJ,fJ],[cJ,lJ,fJ,fJ,fJ],[cJ,lJ,lJ,cJ,fJ],[fJ,cJ,cJ,fJ,fJ],[fJ,fJ,fJ,fJ,fJ]],[0,0],0,Nw.empty(),JX.PLAYING),[new QX(2,1)],$localize`Congratulations, you have earned three points and formed a territory.`,$localize`Failed, you have not captured the group. Play on the last liberty of that group.`),_j.informational($localize`Suicide`,$localize`In Go, suicide is forbidden.
        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.
        Here, the top left intersection is a suicide for Light.
        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player.`,new eJ([[fJ,cJ,fJ,fJ,fJ],[cJ,fJ,fJ,fJ,fJ],[cJ,fJ,fJ,fJ,lJ],[lJ,cJ,fJ,lJ,fJ],[fJ,lJ,fJ,lJ,cJ]],[0,0],0,Nw.empty(),JX.PLAYING)),_j.informational($localize`Life and death (death)`,$localize`From the capture rule follows the life and death notion:
        dead stones are stones that are definitely capturable (without losing anything else).
        Alive stones are stones that can never be captured.
        From the capture rule, Dark can play inside Light's territory and make a capture.
        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).
        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories.`,new eJ([[fJ,fJ,fJ,fJ,fJ],[cJ,cJ,cJ,fJ,fJ],[lJ,lJ,cJ,fJ,fJ],[fJ,lJ,cJ,fJ,fJ],[lJ,lJ,cJ,fJ,fJ]],[0,0],0,Nw.empty(),JX.PLAYING)),_j.informational($localize`Life and death (eyes)`,$localize`Here, Light cannot play on the top left, nor on the bottom left.
        Light will never be able to capture Dark.
        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive.`,new eJ([[fJ,cJ,lJ,fJ,fJ],[lJ,cJ,lJ,fJ,fJ],[cJ,cJ,lJ,fJ,fJ],[lJ,cJ,lJ,fJ,fJ],[fJ,cJ,lJ,fJ,fJ]],[0,0],0,Nw.empty(),JX.PLAYING)),_j.informational($localize`Seki`,$localize`If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.
        Similarly, if Light plays on the middle line, Dark will capture Light.
        In other words, there is no point in playing on the middle line.
        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral.`,new eJ([[fJ,lJ,cJ,fJ,lJ,cJ,fJ],[fJ,lJ,cJ,cJ,lJ,cJ,fJ],[fJ,lJ,cJ,cJ,lJ,cJ,fJ],[fJ,lJ,cJ,cJ,lJ,cJ,fJ],[fJ,lJ,cJ,lJ,lJ,cJ,fJ],[fJ,lJ,cJ,lJ,lJ,cJ,fJ],[fJ,lJ,cJ,fJ,lJ,cJ,fJ]],[0,0],0,Nw.empty(),JX.PLAYING)),_j.fromMove($localize`Ko`,$localize`A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>
        Capture the light stone.`,new eJ([[fJ,fJ,fJ,fJ,fJ,fJ,fJ],[fJ,fJ,fJ,fJ,fJ,fJ,fJ],[fJ,fJ,fJ,cJ,lJ,fJ,fJ],[fJ,fJ,cJ,lJ,fJ,lJ,fJ],[fJ,fJ,fJ,cJ,lJ,fJ,fJ],[fJ,fJ,fJ,fJ,fJ,fJ,fJ],[fJ,fJ,fJ,fJ,fJ,fJ,fJ]],[0,0],0,Nw.empty(),JX.PLAYING),[new QX(4,3)],$localize`Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.
        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.
        This rule is called the Ko.
        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after.`,$localize`Failed!`),_j.fromMove($localize`End of the game`,$localize`When a player feels that there is no advantage to putting a new stone, that player can pass a turn.
        The game phase stops when both players pass consecutively, and we move on to the counting phase.
        The dead groups are then marked by clicking on them.
        Every intersection in a player's territory earns that player a point.
        The winner is the one with most points.<br/><br/>
        A last stone is dead, mark it.`,new eJ([[lJ,cJ,cJ,cJ,cJ,cJ,dJ,dJ,dJ],[lJ,lJ,lJ,lJ,cJ,cJ,cJ,dJ,dJ],[lJ,hJ,lJ,lJ,cJ,uJ,uJ,cJ,dJ],[cJ,lJ,lJ,lJ,lJ,cJ,dJ,dJ,dJ],[fJ,lJ,hJ,lJ,cJ,cJ,uJ,cJ,dJ],[lJ,hJ,lJ,lJ,cJ,cJ,cJ,cJ,cJ],[lJ,lJ,cJ,cJ,cJ,lJ,lJ,cJ,lJ],[cJ,cJ,cJ,lJ,lJ,lJ,hJ,lJ,lJ],[dJ,dJ,cJ,cJ,cJ,lJ,lJ,hJ,hJ]],[0,0],0,Nw.empty(),JX.COUNTING),[new QX(0,3)],$localize`Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.
        The intersections where the prisoners are count as Dark's territory
        Light has 8 territories and 1 prisoner.
        The end result is therefore 18 - 9 for Dark.`,$localize`Failed, try again.`)]}}function gJ(e,t){if(1&e&&(_n(),ga(0,"circle",10)),2&e){const e=Sa(2).index,t=Sa().index;ra("cx",25+50*e)("cy",25+50*t)("r",22)}}function mJ(e,t){if(1&e){const e=va();_n(),fa(0,"line",11),Ea("click",function(){Gt(e);const t=Sa(2).index,n=Sa().index;return Sa().onClick(t,n)}),pa()}if(2&e){const e=Sa(2).index,t=Sa().index;ra("x1",50*e)("y1",50*t)("x2",50+50*e)("y2",50+50*t)}}function yJ(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"circle",7),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().onClick(t,n)}),pa(),la(2,gJ,1,3,"circle",8),la(3,mJ,1,4,"line",9),pa()}if(2&e){const e=Sa().index,t=Sa().index,n=Sa();Ts(1),ha("ngClass",n.getSpaceClass(e,t)),ra("cx",25+50*e)("cy",25+50*t)("r",22),Ts(1),ha("ngIf",n.isLastCase(e,t)),Ts(1),ha("ngIf",n.isDead(e,t))}}function vJ(e,t){if(1&e){const e=va();_n(),fa(0,"circle",15),Ea("click",function(){Gt(e);const t=Sa(2).index,n=Sa().index;return Sa().onClick(t,n)}),pa()}if(2&e){const e=Sa(2),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();ra("cx",25+50*t)("cy",25+50*r)("r",10)("class",n===i.GoPiece.LIGHT_TERRITORY?"player1":"player0")}}function CJ(e,t){if(1&e){const e=va();_n(),fa(0,"rect",12),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().onClick(t,n)}),pa(),fa(1,"line",13),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().onClick(t,n)}),pa(),fa(2,"line",13),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().onClick(t,n)}),pa(),la(3,vJ,1,4,"circle",14)}if(2&e){const e=Sa().index,t=Sa().index,n=Sa();Ia("id","click_",e,"_",t,""),ra("x",50*e)("y",50*t),Ts(1),ra("x1",50*e)("y1",25+50*t)("x2",50+50*e)("y2",25+50*t),Ts(1),ra("x1",25+50*e)("y1",50*t)("x2",25+50*e)("y2",50+50*t),Ts(1),ha("ngIf",n.isTerritory(e,t))}}function _J(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,yJ,4,6,"g",5),la(2,CJ,4,13,"ng-template",null,6,Ku),pa()),2&e){const e=t.index,n=ca(3),r=Sa().index,i=Sa();Ts(1),ha("ngIf",i.caseIsFull(e,r))("ngIfElse",n)}}function EJ(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,_J,4,2,"g",2),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}function wJ(e,t){if(1&e&&(_n(),ga(0,"rect",16)),2&e){const e=Sa();ra("x",12.5+50*e.ko.get().x)("y",12.5+50*e.ko.get().y)}}function PJ(e,t){if(1&e){const e=va();_n(),fa(0,"circle",17),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t.x,t.y)}),pa()}if(2&e){const e=t.$implicit;ra("cx",25+50*e.x)("cy",25+50*e.y)("r",7)}}let SJ=(()=>{class e extends tY{constructor(e){super(e),this.ko=Nw.empty(),this.last=Nw.empty(),this.captures=[],this.GoPiece=XX,this.scores=Nw.of([0,0]),this.rules=new sJ(eJ),this.availableMinimaxes=[new aJ(this.rules,"GoMinimax")],this.encoder=QX.encoder,this.tutorial=(new pJ).tutorial,this.canPass=!0,this.updateBoard()}onClick(e,t){var n=this;return Ow(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());n.last=Nw.empty();const i=new QX(e,t);return n.chooseMove(i,n.rules.node.gameState,n.scores.get())})()}updateBoard(){Iw(e.VERBOSE,"updateBoard");const t=this.rules.node.gameState,n=this.rules.node.move,r=t.phase;this.board=t.getCopiedBoard(),this.scores=Nw.of(t.getCapturedCopy()),this.ko=t.koCoord,n.isPresent()?this.showCaptures():this.captures=[],this.last=n.map(e=>e.coord),this.canPass=r!==JX.FINISHED}showCaptures(){const e=this.rules.node.mother.get().gameState;this.captures=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[0].length;n++){const r=new GW(n,t),i=!1===e.getPieceAt(r).isEmpty(),s=this.board[t][n]===XX.EMPTY,o=!1===this.ko.equalsValue(r);i&&s&&o&&this.captures.push(r)}}pass(){var e=this;return Ow(function*(){const t=e.rules.node.gameState.phase;return t===JX.PLAYING||t===JX.PASSED?e.onClick(QX.PASS.coord.x,QX.PASS.coord.y):(hZ(t===JX.COUNTING||t===JX.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(QX.ACCEPT.coord.x,QX.ACCEPT.coord.y))})()}getSpaceClass(e,t){const n=this.rules.node.gameState.getPieceAtXY(e,t);return this.getPlayerClass(n.getOwner())}caseIsFull(e,t){return this.rules.node.gameState.getPieceAtXY(e,t)!==XX.EMPTY&&!this.isTerritory(e,t)}isLastCase(e,t){if(this.last.isPresent()){const n=this.last.get();return e===n.x&&t===n.y}return!1}isDead(e,t){return this.rules.node.gameState.isDead(new GW(e,t))}isTerritory(e,t){return this.rules.node.gameState.isTerritory(new GW(e,t))}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-go"]],features:[Go],decls:5,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["width","25","height","25","class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke highlighted",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","highlighted"],[1,"base","no-fill","captured-stroke",3,"click"],["width","50","height","50","fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],["width","25","height","25",1,"captured-stroke","mid-stroke","no-fill"],[1,"captured",3,"click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),ga(1,"rect",1),la(2,EJ,2,1,"g",2),la(3,wJ,1,2,"rect",3),la(4,PJ,1,3,"circle",4),pa()),2&e&&(ra("viewBox","0 -3 "+50*t.board.length+" "+(6+50*t.board.length)),Ts(1),ra("width",50*t.board.length)("height",50*t.board.length),Ts(1),ha("ngForOf",t.board),Ts(1),ha("ngIf",t.ko.isPresent()),Ts(1),ha("ngForOf",t.captures))},directives:[tf,rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class bJ{constructor(e,t,n){this.value=e,this.name=t,this.rgb=n}static of(e){switch(e){case 0:return bJ.ANY;case 1:return bJ.ORANGE;case 2:return bJ.BLUE;case 3:return bJ.PURPLE;case 4:return bJ.PINK;case 5:return bJ.YELLOW;case 6:return bJ.RED;case 7:return bJ.GREEN;default:return Tw.expectToBe(e,8,"Invalid value "+e+" for KamisadoColor"),bJ.BROWN}}}bJ.ANY=new bJ(0,"any","#000"),bJ.ORANGE=new bJ(1,"orange","#d67421"),bJ.BLUE=new bJ(2,"blue","#006bac"),bJ.PURPLE=new bJ(3,"purple","#6f3787"),bJ.PINK=new bJ(4,"pink","#d2719e"),bJ.YELLOW=new bJ(5,"yellow","#e2c200"),bJ.RED=new bJ(6,"red","#d23339"),bJ.GREEN=new bJ(7,"green","#009157"),bJ.BROWN=new bJ(8,"brown","#562500");class OJ{constructor(e,t){this.player=e,this.color=t}static of(e,t){return new OJ(e,bJ.of(t))}static createPlayerColors(e){return{ORANGE:new OJ(e,bJ.ORANGE),BLUE:new OJ(e,bJ.BLUE),PURPLE:new OJ(e,bJ.PURPLE),PINK:new OJ(e,bJ.PINK),YELLOW:new OJ(e,bJ.YELLOW),RED:new OJ(e,bJ.RED),GREEN:new OJ(e,bJ.GREEN),BROWN:new OJ(e,bJ.BROWN)}}equals(e){return e.player===this.player&&e.color===this.color}isEmpty(){return this.player.equals(IZ.NONE)}belongsTo(e){return this.player===e}}OJ.EMPTY=new OJ(IZ.NONE,bJ.ANY),OJ.ZERO=OJ.createPlayerColors(TZ.ZERO),OJ.ONE=OJ.createPlayerColors(TZ.ONE);class TJ{static getColorAt(e,t){return TJ.COLORS[t][e]}static getInitialBoard(){const e=OJ.EMPTY;return[[1,2,3,4,5,6,7,8].map(e=>OJ.of(TZ.ONE,e)),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(e=>OJ.of(TZ.ZERO,e))]}static isEmptyAt(e,t){return e[t.y][t.x].equals(OJ.EMPTY)}static allPieceCoords(e){const t=[];for(let n=0;n<e.length;n++)for(let r=0;r<e[n].length;r++){const i=new GW(r,n);TJ.isEmptyAt(e,i)||t.push(i)}return t}}TJ.INITIAL=TJ.getInitialBoard(),TJ.SIZE=8,TJ.COLORS=NZ.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],bJ.of);class IJ extends aj{constructor(){super()}isPieceMove(){return!1}length(){return 0}equals(e){return this===e}toString(){return"KamisadoMove(PASS)"}}IJ.PASS=new IJ;class kJ extends hY{constructor(e,t){super(e,t)}static of(e,t){if(e.isNotInRange(TJ.SIZE,TJ.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+e.toString());if(t.isNotInRange(TJ.SIZE,TJ.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+t.toString());return new kJ(e,t)}isPieceMove(){return!0}equals(e){return e===this||!!e.isPieceMove()&&!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}toString(){return"KamisadoMove("+this.coord+"->"+this.end+")"}}var AJ;!function(e){e.PASS=IJ.PASS,e.of=function(e,t){return kJ.of(e,t)},e.encoder=new class extends bZ{maxValue(){return 34952}encodeNumber(e){return e.isPieceMove()?4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y:0}decodeNumber(t){if(0===t)return e.PASS;const n=t%16,r=(t=t/16|0)%16,i=(t=t/16|0)%16;return e.of(new GW((t=t/16|0)%16,i),new GW(r,n))}}}(AJ||(AJ={}));class MJ extends sj{constructor(e,t,n,r,i){super(NZ.copyBiArray(i),e),this.colorToPlay=t,this.coordToPlay=n,this.alreadyPassed=r}static getInitialState(){return new MJ(0,bJ.ANY,Nw.empty(),!1,TJ.INITIAL)}}let NJ=(()=>{class e{}return e.NOT_RIGHT_COLOR=()=>$localize`This piece is not of the color you have to play.`,e.DIRECTION_NOT_ALLOWED=()=>$localize`You can only move forward, orthogonally or diagonally.`,e.MOVE_BLOCKED=()=>$localize`This move is blocked by another piece.`,e.PLAY_WITH_SELECTED_PIECE=()=>$localize`You must play with the selected piece.`,e})();class RJ extends mj{static getColorMatchingPiece(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new GW(0,7),new GW(1,7),new GW(2,7),new GW(3,7),new GW(4,7),new GW(5,7),new GW(6,7),new GW(7,7)]}static getMovablePieces(e){return RJ.getColorMatchingPiece(e).filter(t=>{for(const n of this.playerDirections(e.getCurrentPlayer())){const r=t.getNext(n);if(e.isOnBoard(r)&&TJ.isEmptyAt(e.board,r))return!0}return!1})}static playerDirections(e){return e===TZ.ONE?[$W.DOWN,$W.DOWN_LEFT,$W.DOWN_RIGHT]:[$W.UP,$W.UP_LEFT,$W.UP_RIGHT]}static directionAllowedForPlayer(e,t){return t===TZ.ZERO?e.y<0:e.y>0}static getListMovesFromState(e){const t=RJ.getMovablePieces(e);return 0===t.length?(hZ(!1===e.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[AJ.PASS]):RJ.getListMovesFromNonBlockedState(e,t)}static getListMovesFromNonBlockedState(e,t){const n=[],r=e.getCurrentPlayer();for(const i of t)for(const t of RJ.playerDirections(r))for(let r=1;r<TJ.SIZE;r++){const s=i.getNext(t,r);if(!e.isOnBoard(s)||!TJ.isEmptyAt(e.board,s))break;{const e=AJ.of(i,s);n.push(e)}}return n}static mustPass(e){return 0===this.getMovablePieces(e).length}static getFurthestPiecePositions(e){let t=7,n=0;return TJ.allPieceCoords(e.board).forEach(r=>{const i=e.getPieceAt(r);hZ(i!==OJ.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),i.player===TZ.ONE?n=Math.max(n,r.y):t=Math.min(t,r.y)}),[t,n]}static isLegal(e,t){if(e.isPieceMove()){const n=e.coord,r=e.end,i=t.colorToPlay,s=t.getPieceAt(n);if(!s.belongsTo(t.getCurrentPlayer()))return Rw.failure(JW.MUST_CHOOSE_PLAYER_PIECE());if(i!==bJ.ANY&&s.color!==i)return Rw.failure(NJ.NOT_RIGHT_COLOR());if(!t.getPieceAt(r).isEmpty())return Rw.failure(JW.MUST_CLICK_ON_EMPTY_SPACE());const o=$W.factory.fromMove(n,r);if(o.isFailure())return Rw.failure(NJ.DIRECTION_NOT_ALLOWED());const a=o.get();if(!RJ.directionAllowedForPlayer(a,t.getCurrentPlayer()))return Rw.failure(NJ.DIRECTION_NOT_ALLOWED());let l=n;for(;!l.equals(r);)if(l=l.getNext(a),!t.getPieceAt(l).isEmpty())return Rw.failure(NJ.MOVE_BLOCKED());return Rw.success(void 0)}return this.isLegalPass(t)}static isLegalPass(e){return this.mustPass(e)&&!e.alreadyPassed?Rw.success(void 0):Rw.failure(JW.CANNOT_PASS())}nextCoordToPlay(e,t){return Nw.ofNullable(TJ.allPieceCoords(e.board).find(n=>{const r=e.getPieceAt(n);return r.player===e.getCurrentOpponent()&&r.color===t}))}applyLegalMove(e,t,n){if(e.isPieceMove()){const n=e.coord,r=e.end,i=t.getCopiedBoard();i[r.y][r.x]=i[n.y][n.x],i[n.y][n.x]=OJ.EMPTY;const s=TJ.getColorAt(r.x,r.y),o=this.nextCoordToPlay(t,s);return new MJ(t.turn+1,s,o,!1,i)}{const e=this.nextCoordToPlay(t,t.colorToPlay);return new MJ(t.turn+1,t.colorToPlay,e,!0,t.board)}}isLegal(e,t){return RJ.isLegal(e,t)}getGameStatus(e){const t=e.gameState,n=t.getCurrentPlayer();if(RJ.mustPass(t)&&t.alreadyPassed)return gj.getDefeat(n);const[r,i]=RJ.getFurthestPiecePositions(t);return 7===i?gj.ONE_WON:0===r?gj.ZERO_WON:gj.ONGOING}}class xJ extends ej{getListMoves(e){const t=RJ.getListMovesFromState(e.gameState);return NZ.sortByDescending(t,e=>e.length()),t}getBoardValue(e){const t=e.gameState,n=t.getCurrentPlayer();if(RJ.mustPass(t)&&t.alreadyPassed)return new tj(n.getDefeatValue());const[r,i]=RJ.getFurthestPiecePositions(t);return new tj(7===i?TZ.ONE.getVictoryValue():0===r?TZ.ZERO.getVictoryValue():i-(7-r))}}const DJ=OJ.EMPTY,LJ=OJ.ZERO.ORANGE,FJ=OJ.ONE.ORANGE,UJ=OJ.ZERO.BLUE,VJ=OJ.ONE.BLUE,BJ=OJ.ZERO.PURPLE,$J=OJ.ONE.PURPLE,zJ=OJ.ZERO.PINK,HJ=OJ.ONE.PINK,GJ=OJ.ZERO.YELLOW,ZJ=OJ.ONE.YELLOW,qJ=OJ.ZERO.RED,WJ=OJ.ONE.RED,jJ=OJ.ZERO.GREEN,YJ=OJ.ONE.GREEN,KJ=OJ.ZERO.BROWN,QJ=OJ.ONE.BROWN;class XJ{constructor(){this.tutorial=[_j.informational($localize`Goal of the game`,$localize`At Kamisado, there are two ways to win the game:
        either by moving one of your pieces on the opponent's starting line,
        or by forcing the opponent to make a move that blocks the entire game.
        Here, Dark wins because its brown piece is on Light's starting line, on the top left.`,new MJ(5,bJ.ORANGE,Nw.empty(),!1,[[KJ,VJ,$J,HJ,ZJ,WJ,YJ,QJ],[DJ,DJ,DJ,DJ,DJ,DJ,DJ,DJ],[DJ,DJ,DJ,DJ,DJ,DJ,DJ,DJ],[DJ,DJ,DJ,DJ,DJ,DJ,DJ,DJ],[DJ,DJ,DJ,FJ,DJ,DJ,DJ,DJ],[DJ,DJ,DJ,DJ,DJ,DJ,DJ,DJ],[DJ,DJ,DJ,DJ,DJ,DJ,DJ,DJ],[DJ,jJ,qJ,GJ,zJ,BJ,UJ,LJ]])).withPreviousMove(AJ.of(new GW(0,7),new GW(0,0))),_j.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
        At Kamisado, pieces can only move forward, vertically or diagonally.
        You're playing first, with dark pieces, you can make your first move.<br/><br/>
        Click on the piece of your choice and click on the landing square.`,MJ.getInitialState(),AJ.of(new GW(7,7),new GW(3,3)),$localize`Perfect! Note that each of your piece has a different color.`),_j.fromMove($localize`Moving`,$localize`Let us now consider the move of Light, after the blue piece has been moved by Dark.
        All moves after the initial move must be made from the piece that corresponds to the color
        of the square upon which the last move ended.
        Here, the last move ended on the pink square, hence the pink piece must move.
        It is already selected, you do not have to click on it.<br/><br/>
        Move it on a blue square.`,new MJ(1,bJ.PINK,Nw.of(new GW(3,0)),!1,[[FJ,VJ,$J,HJ,ZJ,WJ,YJ,QJ],[DJ,DJ,DJ,DJ,DJ,DJ,DJ,DJ],[DJ,DJ,DJ,DJ,DJ,DJ,DJ,DJ],[DJ,DJ,DJ,DJ,DJ,DJ,DJ,DJ],[DJ,DJ,DJ,DJ,DJ,DJ,DJ,DJ],[DJ,DJ,DJ,DJ,DJ,DJ,UJ,DJ],[DJ,DJ,DJ,DJ,DJ,DJ,DJ,DJ],[KJ,jJ,qJ,GJ,zJ,BJ,DJ,LJ]]),[AJ.of(new GW(3,0),new GW(3,6)),AJ.of(new GW(3,0),new GW(4,1))],$localize`Congratulations!`,$localize`You have not moved your pink piece on a blue square!`).withPreviousMove(AJ.of(new GW(6,7),new GW(6,5))),_j.informational($localize`Stuck situation`,$localize`Dark moved to another pink square, hence you have to move your pink piece again.
        However, your pink piece is stuck! In this case, you must pass your turn.
        Dark will now have to play by moving its pink piece.`,new MJ(1,bJ.PINK,Nw.of(new GW(3,6)),!1,[[FJ,VJ,$J,DJ,ZJ,WJ,YJ,QJ],[DJ,DJ,DJ,DJ,DJ,DJ,DJ,DJ],[DJ,DJ,DJ,DJ,DJ,DJ,DJ,DJ],[DJ,DJ,DJ,DJ,DJ,DJ,DJ,DJ],[DJ,DJ,DJ,DJ,DJ,DJ,DJ,UJ],[DJ,DJ,DJ,DJ,DJ,DJ,DJ,DJ],[DJ,DJ,DJ,HJ,DJ,DJ,DJ,DJ],[KJ,jJ,qJ,GJ,zJ,BJ,DJ,LJ]])).withPreviousMove(AJ.of(new GW(6,5),new GW(7,4))),_j.fromMove($localize`Victory by blocking`,$localize`At any time, if a player blocks the entire game, that player loses.
        In other words, if a player forces its opponent to move a piece that the opponent cannot move,
        and the player cannot move its own piece of the same color, then that player loses.
        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>
        Try to make this move.`,new MJ(2,bJ.RED,Nw.of(new GW(2,4)),!1,[[DJ,VJ,$J,DJ,DJ,WJ,DJ,DJ],[DJ,DJ,DJ,ZJ,DJ,DJ,DJ,DJ],[DJ,DJ,DJ,HJ,DJ,$J,DJ,DJ],[DJ,DJ,DJ,GJ,DJ,DJ,DJ,DJ],[DJ,DJ,qJ,DJ,DJ,DJ,DJ,DJ],[DJ,DJ,DJ,DJ,DJ,DJ,YJ,DJ],[FJ,DJ,DJ,DJ,DJ,zJ,DJ,QJ],[KJ,jJ,DJ,DJ,DJ,DJ,UJ,LJ]]),[AJ.of(new GW(2,4),new GW(0,2))],$localize`Perfect!
         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.
         Your orange piece will be stuck and you will have to pass your turn.
         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.
         In this case, the last player to have moved a piece loses.
         Here, your opponent will have moved its green piece last, you therefore win!`,$localize`Failed!`).withPreviousMove(AJ.of(new GW(4,0),new GW(3,1)))]}}function JJ(e,t){if(1&e&&(_n(),ga(0,"circle",8)),2&e){const e=Sa(),t=e.$implicit,n=e.index,r=Sa().index,i=Sa();ha("ngClass",i.piecePlayerClass(t)),ra("cx",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+r*i.SPACE_SIZE)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function e1(e,t){if(1&e&&(_n(),ga(0,"rect",9)),2&e){const e=Sa(),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();ra("x",i.SPACE_SIZE/2+t*i.SPACE_SIZE-i.SPACE_SIZE/8)("y",i.SPACE_SIZE/2+r*i.SPACE_SIZE-i.SPACE_SIZE/8)("rx",i.isPlayerZero(n)?i.SPACE_SIZE:0)("ry",i.isPlayerZero(n)?i.SPACE_SIZE:0)("width",i.SPACE_SIZE/4)("height",i.SPACE_SIZE/4)("fill",i.pieceColor(n))}}function t1(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"g",4),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),ga(2,"rect",5),la(3,JJ,1,4,"circle",6),la(4,e1,1,7,"rect",7),pa(),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();Ts(1),Ia("id","click_",n,"_",r,""),Ts(1),ra("x",n*i.SPACE_SIZE)("y",r*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)("fill",i.backgroundColor(n,r)),Ts(1),ha("ngIf",e!==i.UNOCCUPIED),Ts(1),ha("ngIf",e!==i.UNOCCUPIED)}}function n1(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,t1,5,9,"g",1),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}function r1(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"rect",10),ga(2,"rect",10),pa()),2&e){const e=Sa();Ts(1),ra("x",e.lastPieceMove.get().coord.x*e.SPACE_SIZE)("y",e.lastPieceMove.get().coord.y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE),Ts(1),ra("x",e.lastPieceMove.get().end.x*e.SPACE_SIZE)("y",e.lastPieceMove.get().end.y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function i1(e,t){if(1&e&&(_n(),ga(0,"circle",11)),2&e){const e=Sa();ra("cx",e.SPACE_SIZE/2+e.chosen.get().x*e.SPACE_SIZE)("cy",e.SPACE_SIZE/2+e.chosen.get().y*e.SPACE_SIZE)("r",e.SPACE_SIZE/2-e.STROKE_WIDTH)}}let s1=(()=>{class e extends tY{constructor(e){super(e),this.UNOCCUPIED=OJ.EMPTY,this.lastMove=Nw.empty(),this.lastPieceMove=Nw.empty(),this.chosen=Nw.empty(),this.chosenAutomatically=!1,this.rules=new RJ(MJ),this.availableMinimaxes=[new xJ(this.rules,"KamisadoMinimax")],this.encoder=AJ.encoder,this.tutorial=(new XJ).tutorial,this.canPass=!1,this.updateBoard()}backgroundColor(e,t){return TJ.getColorAt(e,t).rgb}isPlayerZero(e){return e.player===TZ.ZERO}pieceColor(e){return e.color.rgb}piecePlayerClass(e){return this.getPlayerClass(e.player)}updateBoard(){const e=this.rules.node.gameState;if(this.board=e.getCopiedBoard(),this.lastMove=this.rules.node.move,this.lastPieceMove=Nw.empty(),this.lastMove.isPresent()){const e=this.lastMove.get();e.isPieceMove()&&(this.lastPieceMove=Nw.of(e))}this.canPass=RJ.mustPass(e);const t=this.rules.getGameStatus(this.rules.node)!==gj.ONGOING;this.canPass||e.coordToPlay.isAbsent()||t?(this.chosenAutomatically=!1,this.chosen=Nw.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}pass(){var e=this;return Ow(function*(){return hZ(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(AJ.PASS,e.rules.node.gameState)})()}onClick(e,t){var n=this;return Ow(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=new GW(e,t);if(n.canPass)return n.cancelMove(JW.MUST_PASS());if(n.chosen.isAbsent())return n.choosePiece(e,t);if(!1===n.chosenAutomatically&&n.chosen.equalsValue(i))return n.cancelMoveAttempt(),Lw.SUCCESS;{const r=n.rules.node.gameState.getPieceAtXY(e,t),s=n.rules.node.gameState.getCurrentPlayer();return r.belongsTo(s)?n.chosenAutomatically?n.cancelMove(NJ.PLAY_WITH_SELECTED_PIECE()):(n.chosen=Nw.of(i),Lw.SUCCESS):yield n.chooseDestination(e,t)}})()}choosePiece(e,t){const n=this.rules.node.gameState.getPieceAtXY(e,t),r=this.rules.node.gameState.getCurrentOpponent();return n.belongsTo(r)?this.cancelMove(JW.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=Nw.of(new GW(e,t)),Lw.SUCCESS)}chooseDestination(e,t){var n=this;return Ow(function*(){const r=n.chosen.get(),i=new GW(e,t),s=AJ.of(r,i);return n.chooseMove(s,n.rules.node.gameState)})()}cancelMoveAttempt(){this.chosenAutomatically||(this.chosen=Nw.empty())}}return e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-kamisado"]],features:[Go],decls:4,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill highlighted",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","highlighted"],["id","selectedPiece",1,"base","mid-stroke","no-fill","highlighted"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,n1,2,1,"g",1),la(2,r1,3,8,"g",2),la(3,i1,1,3,"circle",3),pa()),2&e&&(ra("viewBox",t.getViewBox()),Ts(1),ha("ngForOf",t.board),Ts(1),ha("ngIf",t.lastPieceMove.isPresent()),Ts(1),ha("ngIf",t.chosen.isPresent()))},directives:[tf,rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),o1=(()=>{class e extends sj{static getInitialState(){const t=IZ.NONE,n=IZ.ZERO,r=IZ.ONE;return new e([[t,n,n,n,n,n,n,t],[r,t,t,t,t,t,t,r],[r,t,t,t,t,t,t,r],[r,t,t,t,t,t,t,r],[r,t,t,t,t,t,t,r],[r,t,t,t,t,t,t,r],[r,t,t,t,t,t,t,r],[t,n,n,n,n,n,n,t]],0)}static isOnBoard(t){return t.isInRange(e.SIZE,e.SIZE)}}return e.SIZE=8,e})();class a1 extends hY{constructor(e,t,n){super(e,t),this.direction=n,this.direction=$W.factory.fromMove(e,t).get()}static of(e,t){const n=$W.factory.fromMove(e,t);return n.isFailure()?Rw.failure(n.getReason()):e.isNotInRange(o1.SIZE,o1.SIZE)?Rw.failure("start coord is not in range"):t.isNotInRange(o1.SIZE,o1.SIZE)?Rw.failure("end coord is not in range"):Rw.success(new a1(e,t,n.get()))}equals(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}toString(){return"LinesOfActionMove("+this.coord+"->"+this.end+")"}encode(){return a1.encoder.encode(this)}decode(e){return a1.encoder.decode(e)}}a1.encoder=hY.getEncoder(o1.SIZE,o1.SIZE,(e,t)=>a1.of(e,t).get());let l1=(()=>{class e{}return e.INVALID_MOVE_LENGTH=()=>$localize`Your move should have a length equal to the number of pieces that exist on the same line.`,e.CANNOT_JUMP_OVER_OPPONENT=()=>$localize`You cannot jump over the opponent's pieces.`,e.PIECE_CANNOT_MOVE=()=>$localize`This piece has no possible move, select another one.`,e.INVALID_DIRECTION=()=>$localize`A move must be orthogonal or diagonal.`,e})();class c1 extends mj{static getListMovesFromState(e){const t=[];if(c1.getVictory(e).isPresent())return t;for(let n=0;n<o1.SIZE;n++)for(let r=0;r<o1.SIZE;r++){const i=new GW(r,n);if(e.getPieceAt(i).isPlayer())for(const n of c1.possibleTargets(e,i)){const e=a1.of(i,n).get();t.push(e)}}return t}static getNumberOfGroups(e){const t=NZ.createTable(o1.SIZE,o1.SIZE,-1),n=[0,0];let r=0;for(let i=0;i<o1.SIZE;i++)for(let s=0;s<o1.SIZE;s++)if(-1===t[i][s]){const o=e.getPieceAt(new GW(s,i));o.isPlayer()&&(r+=1,c1.markGroupStartingAt(e,t,new GW(s,i),r),n[o.value]+=1)}return n}static markGroupStartingAt(e,t,n,r){const i=[n],s=e.getPieceAt(n);for(;i.length>0;){const n=Tw.getNonNullable(i.pop());if(-1===t[n.y][n.x]){const o=e.getPieceAt(n);if(o===s){t[n.y][n.x]=r;for(const t of $W.DIRECTIONS){const r=n.getNext(t);e.isOnBoard(r)&&i.push(r)}}else o===IZ.NONE&&(t[n.y][n.x]=0)}}}applyLegalMove(e,t,n){const r=t.getCopiedBoard();return r[e.coord.y][e.coord.x]=IZ.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer(),new o1(r,t.turn+1)}static isLegal(e,t){return t.getPieceAt(e.coord)!==t.getCurrentPlayer()?Rw.failure(JW.MUST_CHOOSE_PLAYER_PIECE()):e.length()!==this.numberOfPiecesOnLine(t,e.coord,e.direction)?Rw.failure(l1.INVALID_MOVE_LENGTH()):e.coord.getCoordsToward(e.end).some(e=>t.getPieceAt(e)===t.getCurrentOpponent())?Rw.failure(l1.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.end)===t.getCurrentPlayer()?Rw.failure(JW.CANNOT_SELF_CAPTURE()):Rw.success(void 0)}isLegal(e,t){return c1.isLegal(e,t)}static numberOfPiecesOnLine(e,t,n){let r=0;for(const i of c1.getLineCoords(t,n))e.getPieceAt(i).isPlayer()&&(r+=1);return r}static getLineCoords(e,t){const n=c1.getEntranceAndForwardDirection(e,t);let r=n[0];const i=n[1],s=[];for(;o1.isOnBoard(r);)s.push(r),r=r.getNext(i);return s}static getEntranceAndForwardDirection(e,t){switch(t){case $W.UP:case $W.DOWN:return[new GW(e.x,0),$W.DOWN];case $W.LEFT:case $W.RIGHT:return[new GW(0,e.y),$W.RIGHT];case $W.UP_RIGHT:case $W.DOWN_LEFT:return[new GW(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),$W.UP_RIGHT];default:return Tw.expectToBeMultiple(t,[$W.UP_LEFT,$W.DOWN_RIGHT]),[new GW(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),$W.DOWN_RIGHT]}}static getVictory(e){const[t,n]=c1.getNumberOfGroups(e);return 1===t&&1===n?Nw.of(IZ.NONE):1===t?Nw.of(TZ.ZERO):1===n?Nw.of(TZ.ONE):Nw.empty()}static possibleTargets(e,t){const n=[];for(const r of $W.DIRECTIONS){const i=c1.numberOfPiecesOnLine(e,t,r),s=t.getNext(r,i);if(e.isOnBoard(s)){const r=a1.of(t,s).get();c1.isLegal(r,e).isSuccess()&&n.push(s)}}return n}getGameStatus(e){const t=e.gameState,[n,r]=c1.getNumberOfGroups(t);return 1===n&&r>1?gj.ZERO_WON:n>1&&1===r?gj.ONE_WON:gj.ONGOING}}class u1 extends ej{getListMoves(e){return c1.getListMovesFromState(e.gameState)}getBoardValue(e){const t=e.gameState,[n,r]=c1.getNumberOfGroups(t);return new tj(1===n&&r>1?TZ.ZERO.getVictoryValue():n>1&&1===r?TZ.ONE.getVictoryValue():100/n*TZ.ZERO.getScoreModifier()+100/r*TZ.ONE.getScoreModifier())}}const h1=IZ.NONE,d1=IZ.ZERO,f1=IZ.ONE;class p1{constructor(){this.tutorial=[_j.informational($localize`Goal of the game`,$localize`At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.
        Here, Dark wins the game:
        Dark's pieces are forming a single group, while Light's pieces form three groups.`,new o1([[h1,h1,h1,h1,h1,h1,h1,h1],[f1,h1,h1,h1,d1,h1,h1,f1],[h1,h1,d1,d1,f1,h1,h1,h1],[h1,h1,h1,d1,h1,h1,h1,h1],[h1,h1,h1,h1,h1,h1,h1,h1],[h1,h1,h1,h1,h1,h1,h1,h1],[h1,h1,h1,h1,h1,h1,h1,h1],[h1,h1,h1,h1,h1,h1,h1,h1]],0)),_j.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
         Moves can be made orthogonally or diagonally.
         The length of a move is equal to the number of pieces that are on the line of the move.
         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>
         You're playing Dark, make the first move!`,o1.getInitialState(),a1.of(new GW(1,7),new GW(1,5)).get(),$localize`Congratulations!`),_j.fromMove($localize`Jumping`,$localize`During a move, it is possible to jump above your own pieces.
        But it is forbidden to jump over the opponent's pieces.<br/><br/>
        You're playing Dark, make a jump over one of your pieces on the following board.`,new o1([[h1,h1,h1,h1,h1,h1,h1,h1],[h1,h1,f1,d1,d1,h1,h1,h1],[h1,h1,h1,h1,h1,h1,h1,h1],[h1,h1,h1,h1,h1,h1,h1,h1],[h1,h1,h1,h1,h1,h1,h1,h1],[h1,h1,h1,h1,h1,h1,h1,h1],[h1,h1,h1,h1,h1,h1,h1,f1],[h1,h1,h1,h1,h1,h1,h1,d1]],0),[a1.of(new GW(3,1),new GW(6,1)).get()],$localize`Congratulations!`,$localize`Failed. You did not jump over one of your pieces.`),_j.fromMove($localize`Moving`,$localize`Here is a different board. Pick the dark piece in the middle (line 4, column 4)
        and observe its possible moves.
        Horizontally, this piece can move only of one square because it is the only piece on this line.
        Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.
        But it can only go up, as below it the landing square is occupied by one of your pieces.
        Diagonally, only one move is possible: on the diagonal that contains three pieces,
        only in the direction where it does not jump over one of the opponent's pieces.
        On the other diagonal, there are too many pieces to end the move on the board.<br/><br/>
        Make one of these moves.`,new o1([[h1,h1,h1,h1,h1,h1,f1,h1],[h1,h1,h1,h1,h1,d1,h1,h1],[h1,h1,h1,h1,f1,h1,h1,h1],[h1,h1,h1,d1,h1,h1,h1,h1],[h1,h1,h1,h1,h1,h1,h1,f1],[h1,h1,h1,h1,h1,f1,h1,f1],[h1,h1,h1,d1,h1,h1,f1,f1],[h1,h1,h1,d1,h1,h1,h1,h1]],0),[a1.of(new GW(3,3),new GW(3,0)).get(),a1.of(new GW(3,3),new GW(0,0)).get(),a1.of(new GW(3,3),new GW(2,3)).get(),a1.of(new GW(3,3),new GW(4,3)).get()],$localize`Congratulations!`,$localize`Failed. This was not one of the expected moves.`),_j.fromPredicate($localize`Capturing`,$localize`If a move ends on an opponent's piece, it is captured and removed from the board.
        However, a move cannot end on one of the player's pieces.
        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!
        If a player has only one piece, that player wins the game.<br/><br/>
        On the following board, try to capture one piece with Dark.`,new o1([[h1,d1,h1,d1,d1,d1,d1,h1],[f1,h1,h1,h1,h1,h1,h1,f1],[h1,h1,d1,h1,f1,h1,h1,h1],[f1,h1,h1,h1,h1,h1,h1,f1],[f1,h1,h1,h1,h1,h1,h1,f1],[f1,h1,h1,h1,h1,h1,h1,f1],[f1,h1,h1,h1,h1,h1,h1,f1],[h1,d1,d1,d1,d1,d1,d1,h1]],0),a1.of(new GW(2,2),new GW(4,2)).get(),(e,t,n)=>t.getPieceAt(e.end)===IZ.ONE?Lw.SUCCESS:Lw.failure($localize`Failed!`),$localize`Congratulations!`),_j.fromMove($localize`Tie`,$localize`In the special case where a move ends up connecting all pieces of both player, simultaneously,
        then the game ends up with a tie.<br/><br/>
        You're playing Dark, force the tie in one move.`,new o1([[h1,h1,h1,h1,h1,h1,h1,h1],[h1,h1,h1,h1,h1,h1,h1,h1],[d1,h1,h1,d1,f1,d1,h1,h1],[h1,h1,h1,d1,h1,h1,h1,f1],[h1,h1,h1,h1,h1,h1,h1,f1],[h1,h1,h1,h1,h1,h1,h1,f1],[h1,h1,h1,h1,h1,h1,h1,f1],[h1,h1,h1,h1,h1,h1,h1,h1]],0),[a1.of(new GW(0,2),new GW(4,2)).get()],$localize`Congratulations!`,$localize`Failed!`)]}}function g1(e,t){if(1&e&&(_n(),ga(0,"circle",3)),2&e){const e=Sa().index,t=Sa().index,n=Sa();ha("ngClass",n.getPieceClasses(e,t)),ra("cx",n.SPACE_SIZE/2+e*n.SPACE_SIZE)("cy",n.SPACE_SIZE/2+t*n.SPACE_SIZE)("r",n.SPACE_SIZE/2-n.STROKE_WIDTH)}}function m1(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"g",2),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),ga(2,"rect",3),la(3,g1,1,4,"circle",4),pa(),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();Ts(1),Ia("id","click_",n,"_",r,""),Ts(1),ha("ngClass",i.getSquareClasses(n,r)),ra("x",n*i.SPACE_SIZE)("y",r*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),Ts(1),ha("ngIf",e!==i.EMPTY)}}function y1(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,m1,4,8,"g",1),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}function v1(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",5),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t.x,t.y)}),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa();Ts(1),ra("x",e.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",e.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}let C1=(()=>{class e extends tY{constructor(e){super(e),this.INDICATOR_SIZE=20,this.EMPTY=IZ.NONE,this.targets=[],this.selected=Nw.empty(),this.lastMove=Nw.empty(),this.captured=Nw.empty(),this.rules=new c1(o1),this.availableMinimaxes=[new u1(this.rules,"LinesOfActionMinimax")],this.encoder=a1.encoder,this.tutorial=(new p1).tutorial,this.updateBoard()}onClick(e,t){var n=this;return Ow(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=new GW(e,t);if(n.selected.isPresent()){if(n.getState().getPieceAt(i)===n.getState().getCurrentPlayer())return n.select(i);{const r=a1.of(n.selected.get(),new GW(e,t));return r.isSuccess()?n.chooseMove(r.get(),n.rules.node.gameState):n.cancelMove(l1.INVALID_DIRECTION())}}return n.select(i)})()}select(e){var t=this;return Ow(function*(){return t.getState().getPieceAt(e)!==t.getState().getCurrentPlayer()?t.cancelMove(JW.MUST_CHOOSE_PLAYER_PIECE()):(t.selected=Nw.of(e),t.targets=c1.possibleTargets(t.rules.node.gameState,t.selected.get()),0===t.targets.length?t.cancelMove(l1.PIECE_CANNOT_MOVE()):Lw.SUCCESS)})()}getState(){return this.rules.node.gameState}getPreviousState(){return this.rules.node.mother.get().gameState}updateBoard(){if(this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){const e=this.lastMove.get();this.captured=this.getPreviousState().getPieceAt(e.end).isPlayer()?Nw.of(e.end):Nw.empty()}}cancelMoveAttempt(){this.selected=Nw.empty(),this.targets=[]}getSquareClasses(e,t){const n=new GW(e,t);if(this.lastMove.isPresent()){const e=this.lastMove.get().coord,t=this.lastMove.get().end;if(this.captured.isPresent()&&n.equals(this.captured.get()))return["captured"];if(n.equals(e)||n.equals(t))return["moved"]}return[]}getPieceClasses(e,t){const n=this.board[t][e],r=new GW(e,t),i=[this.getPlayerClass(n)];return this.selected.isPresent()&&this.selected.get().equals(r)&&i.push("selected"),i}}return e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-linesofaction"]],features:[Go],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"indicator",3,"click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,y1,2,1,"g",1),la(2,v1,2,4,"g",1),pa()),2&e&&(Ts(1),ha("ngForOf",t.board),Ts(1),ha("ngForOf",t.targets))},directives:[tf,Jd,rf],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class _1 extends lj{constructor(e,t,n,r={top:0,bottom:0,left:0,right:0}){super(e.x,e.y),this.direction=t,this.orientation=n,this.captures=r}toString(){return`LodestoneMove(${this.coord.toString()}, ${this.direction}, ${this.orientation}, { top: ${this.captures.top}, bottom: ${this.captures.bottom}, left: ${this.captures.left}, right: ${this.captures.right} })`}equals(e){return this===e||!(!1===this.coord.equals(e.coord)||this.orientation!==e.orientation||this.direction!==e.direction||this.captures.top!==e.captures.top||this.captures.bottom!==e.captures.bottom||this.captures.left!==e.captures.left||this.captures.right!==e.captures.right)}}_1.encoder=new class extends SZ{encodeMove(e){return{coord:GW.encoder.encode(e.coord),direction:e.direction,orientation:e.orientation,captures:e.captures}}decodeMove(e){const t=e;return hZ(null!=t.coord,"Invalid encoded LodestoneMove"),hZ(null!=t.direction,"Invalid encoded LodestoneMove"),hZ(null!=t.orientation,"Invalid encoded LodestoneMove"),hZ(null!=t.captures,"Invalid encoded LodestoneMove"),new _1(GW.encoder.decode(t.coord),t.direction,t.orientation,t.captures)}};let E1=(()=>{class e{}return e.MUST_FLIP_LODESTONE=()=>$localize`You must flip your lodestone before putting it back on the board.`,e.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES=()=>$localize`As long as there are pressure plates, you must place all the pieces that you have captured on them.`,e.TARGET_IS_CRUMBLED=()=>$localize`You must place your lodestone on a non-crumbled square!`,e.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE=()=>$localize`You placed too many captures on the same pressure plate, which has not enough space left.`,e.MUST_PLACE_CAPTURES=()=>$localize`You must place your captures on the pressure plates, on the side of the board.`,e.NO_CAPTURES_TO_PLACE_YET=()=>$localize`You cannot place any capture now, you must first place your lodestone on the board!`,e})();class w1{constructor(e){this.unreachable=e}isLodestone(){return!1}isPlayerPiece(){return!1}isEmpty(){return!0}isUnreachable(){return this.unreachable}equals(e){return this===e}}w1.UNREACHABLE=new w1(!0),w1.EMPTY=new w1(!1);class P1{constructor(e){this.owner=e}static of(e){return e===TZ.ZERO?P1.ZERO:P1.ONE}isLodestone(){return!1}isPlayerPiece(){return!0}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}P1.ZERO=new P1(TZ.ZERO),P1.ONE=new P1(TZ.ONE);class S1{constructor(e,t,n){this.owner=e,this.direction=t,this.orientation=n}static of(e,t){return S1.LODESTONES[e.value][t.direction][t.orientation]}isLodestone(){return!0}isPlayerPiece(){return!1}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}S1.LODESTONES={0:{push:{diagonal:new S1(TZ.ZERO,"push","diagonal"),orthogonal:new S1(TZ.ZERO,"push","orthogonal")},pull:{diagonal:new S1(TZ.ZERO,"pull","diagonal"),orthogonal:new S1(TZ.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new S1(TZ.ONE,"push","diagonal"),orthogonal:new S1(TZ.ONE,"push","orthogonal")},pull:{diagonal:new S1(TZ.ONE,"pull","diagonal"),orthogonal:new S1(TZ.ONE,"pull","orthogonal")}}};class b1{constructor(e,t){this.width=e,this.pieces=t}remainingSpaces(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}addCaptured(e,t){if(this.pieces.length+t>=this.width)return 5===this.width?b1.EMPTY_3.addCaptured(e,t+this.pieces.length-5):(hZ(this.pieces.length+t===3,"should never put more pieces than the plate can support"),Nw.empty());{const n=NZ.copyImmutableArray(this.pieces);for(let r=0;r<t;r++)n.push(P1.of(e));return Nw.of(new b1(this.width,n))}}getPieceAt(e){return e<this.pieces.length?this.pieces[e]:w1.EMPTY}}b1.POSITIONS=["top","bottom","left","right"],b1.EMPTY_5=new b1(5,[]),b1.EMPTY_3=new b1(3,[]);let O1=(()=>{class e extends sj{constructor(e,t,n,r){super(e,t),this.lodestones=n,this.pressurePlates=r}static getInitialState(){const t=w1.EMPTY,n=P1.ZERO,r=P1.ONE;return new e([[t,t,n,r,n,r,t,t],[t,n,r,n,r,n,r,t],[n,r,n,r,n,r,n,r],[r,n,r,t,t,n,r,n],[n,r,n,t,t,r,n,r],[r,n,r,n,r,n,r,n],[t,r,n,r,n,r,n,t],[t,t,r,n,r,n,t,t]],0,new hj,{top:Nw.of(b1.EMPTY_5),bottom:Nw.of(b1.EMPTY_5),left:Nw.of(b1.EMPTY_5),right:Nw.of(b1.EMPTY_5)})}withBoard(t){return new e(t,this.turn,this.lodestones,this.pressurePlates)}remainingSpaces(){const e=this.remainingSpacesDetails();return e.top+e.bottom+e.left+e.right}remainingSpacesDetails(){const e={top:0,bottom:0,left:0,right:0};for(const t of b1.POSITIONS){const n=this.pressurePlates[t];n.isPresent()&&(e[t]=n.get().remainingSpaces())}return e}numberOfPieces(){const t=[0,0];for(let n=0;n<e.SIZE;n++)for(let r=0;r<e.SIZE;r++){const e=this.getPieceAtXY(r,n);e.isPlayerPiece()&&(t[e.owner.value]+=1)}return t}getScores(){const e=this.numberOfPieces();return[24-e[1],24-e[0]]}nextLodestoneDirection(){const e=this.getCurrentPlayer(),t=this.lodestones.get(e);if(!t.isPresent())return Nw.empty();{const e=this.getPieceAt(t.get());switch(hZ(e.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+t.get()),e.direction){case"push":return Nw.of("pull");case"pull":return Nw.of("push")}}}}return e.SIZE=8,e})();class T1 extends mj{constructor(){super(O1)}static get(){return T1.singleton.isAbsent()&&(T1.singleton=Nw.of(new T1)),T1.singleton.get()}applyLegalMove(e,t,n){const r=t.getCurrentPlayer(),i=r.getOpponent(),s=NZ.copyBiArray(n.board),o=t.lodestones.getCopy();o.put(r,e.coord);const a={...t.pressurePlates};return this.updatePressurePlates(s,a,o,i,e.captures),new O1(s,t.turn+1,o,a)}updatePressurePlates(e,t,n,r,i){for(const s of b1.POSITIONS)t[s]=this.updatePressurePlate(e,s,t[s],n,r,i[s])}updatePressurePlate(e,t,n,r,i,s){if(n.isPresent()){const o=n.get().addCaptured(i,s),a=T1.THREATENED_COORD_RANGE.get(t).get();return o.isAbsent()?(this.removePressurePlate(e,a.startForBigPlate,a.direction,r),this.removePressurePlate(e,a.startForSmallPlate,a.direction,r)):o.get().width<n.get().width&&this.removePressurePlate(e,a.startForBigPlate,a.direction,r),o}return n}removePressurePlate(e,t,n,r){for(let i=t;i.isInRange(O1.SIZE,O1.SIZE);i=i.getNext(n)){for(const e of TZ.PLAYERS)r.get(e).equalsValue(i)&&r.delete(e);e[i.y][i.x]=w1.UNREACHABLE}}isLegal(e,t){const n=this.isLegalWithoutCaptures(t,e.coord,e.direction);if(n.isFailure())return Rw.failure(n.getReason());const r=this.applyMoveWithoutPlacingCaptures(t,e.coord,e);if(e.captures.top+e.captures.bottom+e.captures.left+e.captures.right!==Math.min(r.captures.length,t.remainingSpaces()))return Rw.failure(E1.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());for(const i of b1.POSITIONS){const n=t.pressurePlates[i];if(n.isPresent()&&n.get().remainingSpaces()<e.captures[i])return Rw.failure(E1.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}return Rw.success(r)}applyMoveWithoutPlacingCaptures(e,t,n){let r;const i=NZ.copyBiArray(e.board),s=e.lodestones.get(e.getCurrentPlayer());if(s.isPresent()){const e=s.get();i[e.y][e.x]=w1.EMPTY}return r="pull"===n.direction?this.applyPull(e,i,t,n.orientation):this.applyPush(e,i,t,n.orientation),r.board[t.y][t.x]=S1.of(e.getCurrentPlayer(),n),r.moved.push(t),r}applyPull(e,t,n,r){const i=e.getCurrentPlayer(),s=i.getOpponent(),o=[],a=[],l="diagonal"===r?$W.DIAGONALS:$W.ORTHOGONALS;for(const c of l)for(let r=n.getNext(c);e.isOnBoard(r);r=r.getNext(c)){const n=t[r.y][r.x],l=r.getNext(c);if(e.isOnBoard(l)){const e=t[l.y][l.x];e.isPlayerPiece()&&e.owner===i&&(n.isEmpty()?(a.push(r),t[r.y][r.x]=e,a.push(l),t[l.y][l.x]=w1.EMPTY):n.isPlayerPiece()&&n.owner===s&&(o.push(r),t[r.y][r.x]=e,a.push(l),t[l.y][l.x]=w1.EMPTY))}}return{board:t,captures:o,moved:a}}applyPush(e,t,n,r){const i=e.getCurrentPlayer().getOpponent(),s=[],o=[],a="diagonal"===r?$W.DIAGONALS:$W.ORTHOGONALS;for(const l of a)for(let r=n.getNext(l,O1.SIZE);!1===r.equals(n);r=r.getPrevious(l))if(e.isOnBoard(r)){const n=t[r.y][r.x];if(n.isPlayerPiece()&&n.owner===i){const i=r.getNext(l);if(e.isOnBoard(i)){const e=t[i.y][i.x];e.isUnreachable()?(s.push(r),t[r.y][r.x]=w1.EMPTY):e.isEmpty()&&(o.push(i),t[i.y][i.x]=n,o.push(r),t[r.y][r.x]=w1.EMPTY)}else s.push(r),t[r.y][r.x]=w1.EMPTY}}return{board:t,captures:s,moved:o}}isLegalWithoutCaptures(e,t,n){const r=this.isTargetLegal(e,t);if(r.isFailure())return r;const i=e.nextLodestoneDirection();return!1===(i.isAbsent()||i.equalsValue(n))?Lw.failure(E1.MUST_FLIP_LODESTONE()):Lw.SUCCESS}isTargetLegal(e,t){const n=e.getPieceAt(t);if(n.isUnreachable())return Lw.failure(E1.TARGET_IS_CRUMBLED());if(n.isPlayerPiece())return Lw.failure(JW.MUST_CLICK_ON_EMPTY_SQUARE());const r=e.getCurrentPlayer();return n.isLodestone()&&n.owner!==r?Lw.failure(JW.MUST_CLICK_ON_EMPTY_SQUARE()):Lw.SUCCESS}getGameStatus(e){const t=e.gameState.numberOfPieces();return 0===t[0]&&0===t[1]?gj.DRAW:0===t[0]?gj.ONE_WON:0===t[1]?gj.ZERO_WON:gj.ONGOING}}T1.THREATENED_COORD_RANGE=hj.from({top:{startForBigPlate:new GW(0,0),startForSmallPlate:new GW(0,1),direction:$W.RIGHT},bottom:{startForBigPlate:new GW(0,O1.SIZE-1),startForSmallPlate:new GW(0,O1.SIZE-2),direction:$W.RIGHT},left:{startForBigPlate:new GW(0,0),startForSmallPlate:new GW(1,0),direction:$W.DOWN},right:{startForBigPlate:new GW(O1.SIZE-1,0),startForSmallPlate:new GW(O1.SIZE-2,0),direction:$W.DOWN}}),T1.singleton=Nw.empty();class I1 extends ej{getListMoves(e){const t=e.gameState;return this.flatMapEmptyCoords(t,e=>{const n=[];for(const r of this.nextDirection(t)){const i=["diagonal","orthogonal"];for(const s of i){const i=T1.get().applyMoveWithoutPlacingCaptures(t,e,{direction:r,orientation:s}).captures.length;for(const o of this.captureCombinations(t,i))n.push(new _1(e,r,s,o))}}return n})}captureCombinations(e,t){if(0===t)return new rj([{top:0,bottom:0,left:0,right:0}]);{const n=new rj,r=e.remainingSpacesDetails(),i=this.captureCombinations(e,t-1);for(const e of i)e.top+1<=r.top&&n.add({...e,top:e.top+1}),e.bottom+1<=r.bottom&&n.add({...e,bottom:e.bottom+1}),e.left+1<=r.left&&n.add({...e,left:e.left+1}),e.right+1<=r.right&&n.add({...e,right:e.right+1});return 0===n.size()?i:n}}flatMapEmptyCoords(e,t){let n=[];for(let r=0;r<O1.SIZE;r++)for(let i=0;i<O1.SIZE;i++){const s=new GW(i,r),o=e.getPieceAt(s);(o.isEmpty()&&!1===o.isUnreachable()||o.isLodestone()&&o.owner===e.getCurrentPlayer())&&(n=n.concat(t(s)))}return n}nextDirection(e){const t=e.nextLodestoneDirection();return t.isPresent()?[t.get()]:["push","pull"]}getBoardValue(e){const t=e.gameState.getScores();let n;return n=24===t[0]&&24!==t[1]?TZ.ZERO.getVictoryValue():24!==t[0]&&24===t[1]?TZ.ONE.getVictoryValue():t[0]*TZ.ZERO.getScoreModifier()+t[1]*TZ.ONE.getScoreModifier(),new tj(n)}}const k1=w1.UNREACHABLE,A1=w1.EMPTY,M1=P1.ZERO,N1=P1.ONE,R1=S1.of(TZ.ONE,{direction:"push",orientation:"orthogonal"}),x1={top:Nw.of(b1.EMPTY_5),bottom:Nw.of(b1.EMPTY_5),left:Nw.of(b1.EMPTY_5),right:Nw.of(b1.EMPTY_5)};class D1{constructor(){this.tutorial=[_j.informational($localize`Board and aim of the game`,$localize`Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone.`,O1.getInitialState()),_j.forClick($localize`Selecting a lodestone`,$localize`To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally.`,O1.getInitialState(),["#lodestone_push_diagonal"],$localize`Congratulations!`,$localize`This is not the right lodestone, try again.`),_j.informational($localize`The repelling lodestone`,$localize`Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured.`,O1.getInitialState()),_j.informational($localize`The attracting lodestone`,$localize`When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it.`,O1.getInitialState()),_j.informational($localize`Flipping the lodestone`,$localize`Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn.`,O1.getInitialState()),_j.fromPredicate($localize`Capturing`,$localize`To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates.`,O1.getInitialState(),new _1(new GW(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),(e,t,n)=>32===n.remainingSpaces()?Lw.failure($localize`You have not captured any of the opponent's pieces, try again!`):Lw.SUCCESS,"Congratulations!"),_j.fromPredicate($localize`Crumbling a first pressure plate`,$localize`When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble.`,new O1([[A1,A1,A1,A1,N1,A1,A1,A1],[A1,A1,M1,A1,A1,N1,A1,A1],[A1,A1,R1,A1,A1,A1,A1,M1],[A1,A1,A1,A1,N1,A1,A1,M1],[A1,A1,A1,A1,A1,M1,A1,A1],[A1,A1,A1,A1,A1,A1,A1,A1],[A1,A1,A1,A1,A1,A1,A1,A1],[A1,A1,A1,A1,A1,A1,A1,A1]],0,new hj([{key:TZ.ONE,value:new GW(2,2)}]),{...x1,top:b1.EMPTY_5.addCaptured(TZ.ONE,4)}),new _1(new GW(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),(e,t,n)=>5===n.pressurePlates.top.get().width?Lw.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble!`):Lw.SUCCESS,"Congratulations!"),_j.fromPredicate($localize`Crumbling a second pressure plate`,$localize`Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble.`,new O1([[k1,k1,k1,k1,k1,k1,k1,k1],[A1,A1,A1,A1,A1,A1,A1,A1],[A1,A1,A1,A1,A1,A1,A1,M1],[A1,A1,A1,A1,A1,M1,A1,M1],[A1,R1,A1,A1,N1,A1,A1,A1],[A1,A1,A1,A1,A1,A1,A1,A1],[A1,A1,A1,A1,N1,A1,A1,A1],[A1,A1,A1,A1,A1,A1,A1,A1]],0,new hj([{key:TZ.ONE,value:new GW(1,4)}]),{...x1,top:b1.EMPTY_3.addCaptured(TZ.ONE,2)}),new _1(new GW(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),(e,t,n)=>n.pressurePlates.top.isPresent()?Lw.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble a second time!`):Lw.SUCCESS,"Congratulations!"),_j.informational($localize`Minimal board`,$localize`After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board.`,new O1([[k1,k1,k1,k1,k1,k1,k1,k1],[k1,k1,k1,k1,k1,k1,k1,k1],[k1,k1,M1,N1,A1,A1,k1,k1],[k1,k1,R1,N1,A1,A1,k1,k1],[k1,k1,A1,M1,M1,A1,k1,k1],[k1,k1,M1,A1,A1,A1,k1,k1],[k1,k1,k1,k1,k1,k1,k1,k1],[k1,k1,k1,k1,k1,k1,k1,k1]],0,new hj([{key:TZ.ONE,value:new GW(2,3)}]),{top:Nw.empty(),bottom:Nw.empty(),left:Nw.empty(),right:Nw.empty()})),_j.fromMove($localize`Making the lodestone fall`,$localize`If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!`,new O1([[A1,A1,A1,A1,A1,A1,A1,A1],[A1,A1,A1,A1,A1,N1,A1,A1],[A1,A1,A1,R1,A1,A1,M1,A1],[A1,A1,M1,M1,N1,A1,A1,M1],[A1,A1,A1,A1,A1,M1,A1,A1],[A1,A1,M1,A1,A1,A1,A1,A1],[A1,A1,N1,A1,A1,A1,A1,A1],[A1,A1,A1,A1,A1,A1,A1,A1]],0,new hj([{key:TZ.ONE,value:new GW(3,2)}]),{...x1,top:b1.EMPTY_5.addCaptured(TZ.ONE,4)}),[new _1(new GW(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize`Congratulations! At your next turn, you will be allowed to place your lodestone on any side.`,$localize`Failed, try again.`),_j.fromMove($localize`End of the game`,$localize`In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!`,new O1([[k1,k1,k1,k1,k1,k1,k1,k1],[k1,k1,k1,k1,k1,k1,k1,k1],[k1,N1,M1,N1,A1,A1,k1,k1],[k1,N1,R1,A1,N1,A1,k1,k1],[k1,A1,A1,M1,M1,A1,k1,k1],[k1,N1,M1,A1,N1,A1,k1,k1],[k1,A1,A1,A1,M1,A1,k1,k1],[k1,k1,k1,k1,k1,k1,k1,k1]],0,new hj([{key:TZ.ONE,value:new GW(2,3)}]),{top:Nw.empty(),bottom:b1.EMPTY_3.addCaptured(TZ.ZERO,2),left:Nw.of(b1.EMPTY_3),right:Nw.empty()}),[new _1(new GW(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize`Congratulations, you won!`,$localize`This is not the winning move. Try again.`)]}}function L1(e,t){if(1&e&&(_n(),ga(0,"circle",10)),2&e){const e=Sa(2),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();Ia("id","piece_",t,"_",r,""),ha("ngClass",n.pieceClasses),ra("r",i.PIECE_RADIUS)("cx",i.SPACE_SIZE*t+i.STROKE_WIDTH+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.STROKE_WIDTH+i.SPACE_SIZE/2)}}function F1(e,t){if(1&e&&(_n(),ga(0,"polygon",15)),2&e){const e=Sa().$implicit,t=Sa(3).$implicit,n=Sa(2);aa("transform","rotate(",90*e,")"),ha("ngClass",t.lodestone.movingClass),ra("points",n.TRIANGLE_OUT)}}function U1(e,t){if(1&e&&(_n(),ga(0,"polygon",15)),2&e){const e=Sa().$implicit,t=Sa(3).$implicit,n=Sa(2);aa("transform","rotate(",90*e,")"),ha("ngClass",t.lodestone.movingClass),ra("points",n.TRIANGLE_IN)}}function V1(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,F1,1,3,"polygon",14),la(2,U1,1,3,"polygon",14),pa()),2&e){const e=Sa(3).$implicit;Ts(1),ha("ngIf","push"===e.lodestone.direction),Ts(1),ha("ngIf","pull"===e.lodestone.direction)}}const B1=function(){return[0,1,2,3]};function $1(e,t){if(1&e&&(_n(),fa(0,"g",11),ga(1,"circle",12),ga(2,"circle",13),fa(3,"g"),la(4,V1,3,2,"g",1),pa(),pa()),2&e){const e=Sa(2),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();ra("transform",i.getSquareTransform(t,r)),Ts(1),ha("ngClass",n.lodestone.selectedClass),ra("r",i.PIECE_RADIUS),Ts(1),ha("ngClass",n.lodestone.pieceClasses),ra("r",i.PIECE_RADIUS/4),Ts(1),aa("transform","rotate(","diagonal"===n.lodestone.orientation?45:0,")"),Ts(1),ha("ngForOf",wu(7,B1))}}function z1(e,t){if(1&e){const e=va();_n(),fa(0,"g",6),Ea("click",function(){Gt(e);const t=Sa().$implicit;return Sa(2).selectCoord(t.coord)}),ga(1,"rect",7),la(2,L1,1,6,"circle",8),la(3,$1,5,8,"g",9),pa()}if(2&e){const e=Sa(),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();Ia("id","square_",t,"_",r,""),Ts(1),ha("ngClass",n.squareClasses),ra("x",i.SPACE_SIZE*t+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),Ts(1),ha("ngIf",n.hasPiece),Ts(1),ha("ngIf",n.lodestone)}}function H1(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,z1,4,9,"g",5),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngIf",!1===e.crumbled)}}function G1(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,H1,2,1,"g",1),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}function Z1(e,t){if(1&e&&(_n(),fa(0,"g",16),ga(1,"circle",17),pa()),2&e){const e=t.$implicit,n=t.index,r=Sa();Ta("id","capture_",n,""),ra("transform",r.getCaptureTransform(n)),Ts(1),ha("ngClass",e.pieceClasses),ra("r",r.PIECE_RADIUS)}}function q1(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"polygon",15),pa()),2&e){const e=t.$implicit,n=Sa().$implicit,r=Sa();Ts(1),aa("transform","rotate(",90*e,")"),ha("ngClass",n.movingClass),ra("points","push"===n.direction?r.TRIANGLE_OUT:r.TRIANGLE_IN)}}function W1(e,t){if(1&e){const e=va();_n(),fa(0,"g",6),Ea("click",function(){const t=Gt(e).$implicit;return Sa().selectLodestone(t)}),ga(1,"circle",12),ga(2,"circle",13),fa(3,"g"),la(4,q1,2,3,"g",1),pa(),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa();Ia("id","lodestone_",e.direction,"_",e.orientation,""),ra("transform",r.getAvailableLodestoneTransform(n)),Ts(1),ha("ngClass",e.selectedClass),ra("r",r.PIECE_RADIUS),Ts(1),ha("ngClass",e.pieceClasses),ra("r",r.PIECE_RADIUS/4),Ts(1),aa("transform","rotate(","diagonal"===e.orientation?45:0,")"),Ts(1),ha("ngForOf",wu(9,B1))}}function j1(e,t){if(1&e&&(_n(),ga(0,"circle",10)),2&e){const e=Sa(),t=e.index,n=e.$implicit,r=Sa().$implicit,i=Sa();Ia("id","platePiece_",r.position,"_",t,""),ha("ngClass",n.pieceClasses),ra("r",i.PIECE_RADIUS)("cx",i.SPACE_SIZE*n.coord.x+i.STROKE_WIDTH+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n.coord.y+i.STROKE_WIDTH+i.SPACE_SIZE/2)}}function Y1(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"g",6),Ea("click",function(){const t=Gt(e),n=t.$implicit,r=t.index,i=Sa().$implicit;return Sa().onPressurePlateClick(n.temporary,i.position,r)}),ga(2,"rect",18),la(3,j1,1,6,"circle",8),pa(),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().$implicit,i=Sa();ra("transform",i.getPressurePlateTransform(r.position)),Ts(1),Ia("id","plate_",r.position,"_",n,""),Ts(1),Ia("id","plateSquare_",r.position,"_",n,""),ha("ngClass",e.squareClasses),ra("x",i.SPACE_SIZE*e.coord.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*e.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),Ts(1),ha("ngIf",e.hasPiece)}}function K1(e,t){if(1&e&&(_n(),fa(0,"g",16),la(1,Y1,4,11,"g",1),pa()),2&e){const e=t.$implicit;Ta("id","pressurePlate_",e.position,""),Ts(1),ha("ngForOf",e.coords)}}function Q1(e,t){if(1&e&&(_n(),ga(0,"rect",19)),2&e){const e=Sa();Ia("id","selection_",e.viewInfo.selected.get().x,"_",e.viewInfo.selected.get().y,""),ra("x",e.SPACE_SIZE*e.viewInfo.selected.get().x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.viewInfo.selected.get().y+e.STROKE_WIDTH)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}class X1 extends ZW{constructor(e){super(e),this.viewInfo={availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:Nw.empty(),pressurePlateShift:{top:new UW(0,0),left:new UW(0,0),right:new UW(0,0),bottom:new UW(0,0)}},this.stateAfterPlacingLodestone=Nw.empty(),this.lastInfos=Nw.empty(),this.capturesToPlace=0,this.selectedCoord=Nw.empty(),this.selectedLodestone=Nw.empty(),this.captures={top:0,bottom:0,left:0,right:0},this.rules=T1.get(),this.tutorial=(new D1).tutorial,this.availableMinimaxes=[new I1(this.rules,"LodestoneDummyMinimax")],this.encoder=_1.encoder,this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH);const t=.8*this.PIECE_RADIUS,n=.3*this.PIECE_RADIUS,r=.2*this.PIECE_RADIUS;this.TRIANGLE_OUT=`${t},0 ${n},${r} ${n},-${r}`,this.TRIANGLE_IN=`${n},0 ${t},${n} ${t},-${n}`,this.displayedState=this.rules.node.gameState,this.scores=Nw.of([0,0])}ngOnInit(){this.updateBoard()}selectCoord(e){var t=this;return Ow(function*(){const n=t.canUserPlay("#square_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());if(t.capturesToPlace>0)return t.cancelMove(E1.MUST_PLACE_CAPTURES());const r=T1.get().isTargetLegal(t.getState(),e);return r.isFailure()?t.cancelMove(r.getReason()):t.selectedLodestone.isPresent()?(t.selectedCoord=Nw.of(e),t.putLodestone()):(t.selectedCoord=Nw.of(e),t.updateViewInfo(),Lw.SUCCESS)})()}selectLodestone(e){var t=this;return Ow(function*(){const n=t.canUserPlay("#lodestone_"+e.direction+"_"+e.orientation);if(n.isFailure())return t.cancelMove(n.getReason());hZ(0===t.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed");const r=t.getCurrentPlayer();return t.selectedLodestone=Nw.of(S1.of(r,e)),t.selectedCoord.isPresent()?t.putLodestone():(t.updateViewInfo(),Lw.SUCCESS)})()}putLodestone(){var e=this;return Ow(function*(){hZ(e.selectedCoord.isPresent(),"coord should have been selected"),hZ(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),n=e.selectedLodestone.get(),r=e.getState();hZ(T1.get().isLegalWithoutCaptures(r,t,n.direction).isSuccess(),"Lodestone component should only allow creation of legal moves");const i=T1.get().applyMoveWithoutPlacingCaptures(r,t,n);return e.lastInfos=Nw.of(i),e.capturesToPlace=Math.min(i.captures.length,r.remainingSpaces()),0===e.capturesToPlace?e.applyMove():(e.displayedState=e.displayedState.withBoard(i.board),e.stateAfterPlacingLodestone=Nw.of(e.displayedState),e.updateViewInfo(),Lw.SUCCESS)})()}applyMove(){var e=this;return Ow(function*(){hZ(e.selectedCoord.isPresent(),"coord should have been selected"),hZ(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),n=e.selectedLodestone.get(),r=new _1(t,n.direction,n.orientation,e.captures);return e.chooseMove(r,e.getState())})()}onPressurePlateClick(e,t,n){return e?this.deselectPressurePlate(t,n):this.selectPressurePlate(t,n)}selectPressurePlate(e,t){var n=this;return Ow(function*(){const r=n.canUserPlay("#plate_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());if(0===n.capturesToPlace)return n.cancelMove(E1.NO_CAPTURES_TO_PLACE_YET());n.capturesToPlace--,n.captures[e]++;const i=n.stateAfterPlacingLodestone.get(),s=n.getCurrentPlayer().getOpponent(),o=NZ.copyBiArray(i.board),a={...i.pressurePlates},l=i.lodestones.getCopy();return T1.get().updatePressurePlates(o,a,l,s,n.captures),n.displayedState=new O1(o,i.turn,l,a),0===n.capturesToPlace?n.applyMove():(n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),Lw.SUCCESS)})()}deselectPressurePlate(e,t){var n=this;return Ow(function*(){const r=n.canUserPlay("#plate_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());n.capturesToPlace++,n.captures[e]--;const i=n.stateAfterPlacingLodestone.get(),s=n.getCurrentPlayer().getOpponent(),o=NZ.copyBiArray(i.board),a={...i.pressurePlates},l=i.lodestones.getCopy();return T1.get().updatePressurePlates(o,a,l,s,n.captures),n.displayedState=new O1(o,i.turn,l,a),n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),Lw.SUCCESS})()}updateBoard(){this.cancelMoveAttempt(),this.rules.node.move.isPresent()&&this.showLastMove(),this.scores=Nw.of(this.getState().getScores())}cancelMoveAttempt(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=Nw.empty(),this.lastInfos=Nw.empty();const e=this.displayedState.lodestones.get(this.getCurrentPlayer());if(e.isPresent()){const t=NZ.copyBiArray(this.displayedState.board);t[e.get().y][e.get().x]=w1.EMPTY,this.displayedState=this.displayedState.withBoard(t)}this.selectedCoord=Nw.empty(),this.selectedLodestone=Nw.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}updateViewInfo(){const e=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(e),this.viewInfo.opponentClass=this.getPlayerClass(e.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}showBoard(){this.viewInfo.boardInfo=[];for(let e=0;e<O1.SIZE;e++){this.viewInfo.boardInfo.push([]);for(let t=0;t<O1.SIZE;t++){const n=new GW(t,e);this.viewInfo.boardInfo[e].push(this.getSquareInfo(n))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:Nw.empty()}getSquareInfo(e){const t=this.displayedState.getPieceAt(e),n={coord:e,squareClasses:[],crumbled:t.isUnreachable(),hasPiece:t.isPlayerPiece(),pieceClasses:[]};return t.isPlayerPiece()&&(n.pieceClasses=[this.getPlayerClass(t.owner)]),t.isLodestone()&&(n.lodestone={direction:t.direction,pieceClasses:[this.getPlayerClass(t.owner)],selectedClass:"",movingClass:"",orientation:t.orientation},n.lodestone.movingClass=this.getPlayerClass("push"===t.direction?t.owner.getOpponent():t.owner)),n}showAvailableLodestones(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{const e=this.getState().getCurrentPlayer(),t=this.getState().nextLodestoneDirection();if(t.isPresent()){const n=t.get();this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:n,orientation:"orthogonal"}),this.nextLodestone(e,{direction:n,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"push",orientation:"diagonal"}),this.nextLodestone(e,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"pull",orientation:"diagonal"})]}}showCapturesToPlace(){const e=this.getCurrentPlayer().getOpponent();this.viewInfo.capturesToPlace=[];for(let t=0;t<this.capturesToPlace;t++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(e)]})}nextLodestone(e,t){const n=S1.of(e,t),r={direction:n.direction,orientation:n.orientation,pieceClasses:[this.getPlayerClass(n.owner)],movingClass:"",selectedClass:""};return r.movingClass=this.getPlayerClass("push"===n.direction?n.owner.getOpponent():n.owner),this.selectedLodestone.equalsValue(n)&&(r.selectedClass="selected"),r}showPressurePlates(){this.viewInfo.pressurePlates=[];for(const e of b1.POSITIONS){const t=[],n=this.displayedState.pressurePlates[e];if(n.isPresent()){const r=X1.PRESSURE_PLATES_POSITIONS.get(e).get(),i=n.get().width;let s=5===i?r.startForBigPlate:r.startForSmallPlate;for(let e=0;e<i;e++){s=s.getNext(r.direction);const i=n.get().getPieceAt(e);let o="";i.isPlayerPiece()&&(o=this.getPlayerClass(i.owner)),t.push({coord:s,hasPiece:i.isPlayerPiece(),pieceClasses:[o],squareClasses:[],temporary:!1})}}this.viewInfo.pressurePlates.push({position:e,coords:t})}}showLastMove(){const e=this.rules.node.mother.get().gameState,t=this.rules.node.move.get();this.lastInfos=Nw.of(T1.get().applyMoveWithoutPlacingCaptures(e,t.coord,t)),this.updateViewInfo();const n=this.getState();this.showPressurePlateDifferences(e,n,!1)}showPressurePlateDifferences(e,t,n){for(const r of b1.POSITIONS)this.showPressurePlateDifference(e.pressurePlates[r],t.pressurePlates[r],r,n)}showPressurePlateDifference(e,t,n,r){if(e.isPresent()&&t.isPresent()){const i=e.get(),s=t.get(),o=Tw.getNonNullable(this.viewInfo.pressurePlates.find(e=>e.position===n));if(i.width===s.width)for(let e=0;e<s.width;e++){const t=i.getPieceAt(e),n=s.getPieceAt(e);!1===t.equals(n)&&(o.coords[e].squareClasses.push("moved"),o.coords[e].temporary=r,r&&o.coords[e].pieceClasses.push("semi-transparent"))}else for(const e of o.coords)e.squareClasses.push("moved")}}showMovedAndCaptured(e){for(const t of e.moved)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("moved");for(const t of e.captures)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("captured")}computePressurePlateShift(){const e=this.displayedState,t=this.getPressurePlateShift(e.pressurePlates.left),n=this.getPressurePlateShift(e.pressurePlates.right),r=this.getPressurePlateShift(e.pressurePlates.top),i=this.getPressurePlateShift(e.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new GW(.5*(t-n),0),this.viewInfo.pressurePlateShift.bottom=new GW(.5*(t-n),0),this.viewInfo.pressurePlateShift.left=new GW(0,.5*(r-i)),this.viewInfo.pressurePlateShift.right=new GW(0,.5*(r-i))}getPressurePlateShift(e){return e.isAbsent()?2:3===e.get().width?1:0}getSquareTransform(e,t){return`translate(${e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2}, ${t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getCaptureTransform(e){return`translate(${(e+(O1.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getAvailableLodestoneTransform(e){return`translate(${(e+(O1.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getPressurePlateTransform(e){return`translate(${this.viewInfo.pressurePlateShift[e].x*this.SPACE_SIZE}, ${this.viewInfo.pressurePlateShift[e].y*this.SPACE_SIZE})`}}X1.PRESSURE_PLATE_EXTRA_SHIFT=.2,X1.PRESSURE_PLATES_POSITIONS=hj.from({top:{startForBigPlate:new GW(.5,-1-X1.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new GW(1.5,0-X1.PRESSURE_PLATE_EXTRA_SHIFT),direction:$W.RIGHT},bottom:{startForBigPlate:new GW(.5,8+X1.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new GW(1.5,7+X1.PRESSURE_PLATE_EXTRA_SHIFT),direction:$W.RIGHT},left:{startForBigPlate:new GW(-1-X1.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new GW(0-X1.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:$W.DOWN},right:{startForBigPlate:new GW(8+X1.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new GW(7+X1.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:$W.DOWN}}),X1.\u0275fac=function(e){return new(e||X1)(ua(cZ))},X1.\u0275cmp=Je({type:X1,selectors:[["app-lodestone"]],features:[Go],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected",3,"id"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,G1,2,1,"g",1),la(2,Z1,2,4,"g",2),la(3,W1,5,10,"g",3),la(4,K1,2,2,"g",2),la(5,Q1,1,6,"rect",4),pa()),2&e&&(Ts(1),ha("ngForOf",t.viewInfo.boardInfo),Ts(1),ha("ngForOf",t.viewInfo.capturesToPlace),Ts(1),ha("ngForOf",t.viewInfo.availableLodestones),Ts(1),ha("ngForOf",t.viewInfo.pressurePlates),Ts(1),ha("ngIf",t.viewInfo.selected.isPresent()))},directives:[tf,rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let J1=(()=>{class e{}return e.START_COORD_OUT_OF_RANGE=()=>$localize`Start coord cannot be out of range`,e.END_COORD_OUT_OF_RANGE=()=>$localize`End coord cannot be out of range`,e.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP=()=>$localize`Pawns must move one step diagonally.`,e.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS=()=>$localize`Drones must move one or two steps in any direction.`,e})();class e0 extends hY{constructor(e,t,n){super(e,t),this.calledTheClock=n}static from(e,t,n=!1){if(e.isNotInRange(4,8))return Rw.failure(J1.START_COORD_OUT_OF_RANGE());if(t.isNotInRange(4,8))return Rw.failure(J1.END_COORD_OUT_OF_RANGE());if(t.equals(e))return Rw.failure(JW.MOVE_CANNOT_BE_STATIC());const r=$W.factory.fromDelta(t.x-e.x,t.y-e.y);return r.isFailure()?Rw.failure(r.getReason()):Rw.success(new e0(e,t,n))}toString(){return"MartianChessMove(("+this.coord.x+", "+this.coord.y+") -> ("+this.end.x+", "+this.end.y+")"+(this.calledTheClock?", CALL_THE_CLOCK":"")+")"}equals(e){return!1!==this.coord.equals(e.coord)&&!1!==this.end.equals(e.end)&&this.calledTheClock===e.calledTheClock}isValidForPawn(){const e=Math.abs(this.coord.x-this.end.x),t=Math.abs(this.coord.y-this.end.y);return 1===e&&1===t}isValidForDrone(){return this.coord.getDistance(this.end)<=2}isUndoneBy(e){if(e.isAbsent())return!1;const t=e.get();return t.end.equals(this.coord)&&t.coord.equals(this.end)}}e0.encoder=bZ.tuple([GW.numberEncoder(4,8),GW.numberEncoder(4,8),bZ.booleanEncoder],e=>[e.coord,e.end,e.calledTheClock],e=>e0.from(e[0],e[1],e[2]).get());class t0{constructor(e){this.value=e}static tryMerge(e,t){hZ(e!==t0.EMPTY&&t!==t0.EMPTY,"tryMerge cannot be called with empty pieces");const n=e.value+t.value;return 2===n||3===n?Nw.of(t0.from(n)):Nw.empty()}static from(e){return e===t0.DRONE.value?t0.DRONE:(Tw.expectToBe(e,t0.QUEEN.value),t0.QUEEN)}getValue(){return this.value}equals(e){return this.getValue()===e.getValue()}}t0.EMPTY=new t0(0),t0.PAWN=new t0(1),t0.DRONE=new t0(2),t0.QUEEN=new t0(3);class n0 extends ej{constructor(e,t){super(e,t),this.ruler=e}getListMoves(e){const t=e.gameState,n=t.getCurrentPlayer(),r=t.getPlayerTerritory(n);let i=[];for(const s of r)for(let e=0;e<4;e++)switch(t.getPieceAtXY(e,s)){case t0.PAWN:i=i.concat(this.getMovesForPawnAt(t,e,s));break;case t0.DRONE:i=i.concat(this.getMovesForDroneAt(t,e,s));break;case t0.QUEEN:i=i.concat(this.getMovesForQueenAt(t,e,s))}return i}getMovesForPawnAt(e,t,n){const r=new GW(t,n),i=[];for(const s of $W.DIAGONALS){const e=r.getNext(s);e.isInRange(4,8)&&i.push(e)}return this.addLegalMoves(e,r,i)}addLegalMoves(e,t,n){const r=[],i=e.getPieceAt(t),s=!1===e.isTherePieceOnPlayerSide(t0.DRONE),o=!1===e.isTherePieceOnPlayerSide(t0.QUEEN),a=e.lastMove;for(const l of n){const n=e.getPieceAt(l);if(n===t0.EMPTY)this.add(r,e0.from(t,l).get(),a);else if(e.isInPlayerTerritory(l)){const e=t0.tryMerge(n,i);if(e.isPresent()){const n=e.get(),i=e0.from(t,l).get();(n===t0.DRONE&&s||n===t0.QUEEN&&o)&&this.add(r,i,a)}}else this.add(r,e0.from(t,l).get(),a)}return r}add(e,t,n){!1===t.isUndoneBy(n)&&e.push(t)}getMovesForDroneAt(e,t,n){const r=new GW(t,n),i=this.getLandingCoordsForLinearMove(r,e,2);return this.addLegalMoves(e,r,i)}getLandingCoordsForLinearMove(e,t,n){const r=[];for(const i of $W.DIRECTIONS){let s=1,o=e.getNext(i,s),a=t.tryToGetPieceAt(o),l=a.equalsValue(t0.EMPTY);for(;l;)r.push(o),s++,o=e.getNext(i,s),a=t.tryToGetPieceAt(o),l=a.equalsValue(t0.EMPTY)&&s<n;a.isPresent()&&r.push(o)}return r}getMovesForQueenAt(e,t,n){const r=new GW(t,n),i=this.getLandingCoordsForQueen(r,e);return this.addLegalMoves(e,r,i)}getLandingCoordsForQueen(e,t){return this.getLandingCoordsForLinearMove(e,t,8)}getBoardValue(e){const t=this.ruler.getGameStatus(e);let n;if(t.isEndGame)n=t.toBoardValue();else{const t=e.gameState.getScoreOf(TZ.ZERO);n=e.gameState.getScoreOf(TZ.ONE)-t}return new tj(n)}}class r0{constructor(e){this.captures=e,e.makeImmutable()}static from(e){const t=new hj;for(const n of e)r0.addToMap(t,n);return new r0(t)}static addToMap(e,t){const n=e.get(t);n.isPresent()?e.replace(t,n.get()+1):e.set(t,1)}toValue(){let e=0;return this.captures.forEach(t=>{e+=t.key.getValue()*t.value}),e}add(e){const t=this.captures.getCopy();return r0.addToMap(t,e),new r0(t)}}class i0 extends sj{constructor(e,t,n=Nw.empty(),r=Nw.empty(),i){super(e,t),this.lastMove=n,this.countDown=r,null==i&&(i=new hj([{key:TZ.ZERO,value:r0.from([])},{key:TZ.ONE,value:r0.from([])}])),i.makeImmutable(),this.captured=i}static getInitialState(){const e=t0.EMPTY,t=t0.PAWN,n=t0.DRONE,r=t0.QUEEN;return new i0([[r,r,n,e],[r,n,t,e],[n,t,t,e],[e,e,e,e],[e,e,e,e],[e,t,t,n],[e,t,n,r],[e,n,r,r]],0,Nw.empty())}getPlayerTerritory(e){return e===TZ.ZERO?i0.PLAYER_ZERO_TERRITORY:i0.PLAYER_ONE_TERRITORY}isTherePieceOnPlayerSide(e){const t=this.getCurrentPlayer(),n=this.getPlayerTerritory(t);for(const r of n)for(let t=0;t<4;t++)if(this.getPieceAtXY(t,r)===e)return!0;return!1}getScoreOf(e){return this.captured.get(e).get().toValue()}getEmptyTerritory(){return this.isTerritoryEmpty(TZ.ZERO)?Nw.of(TZ.ZERO):this.isTerritoryEmpty(TZ.ONE)?Nw.of(TZ.ONE):Nw.empty()}isTerritoryEmpty(e){const t=this.getPlayerTerritory(e);for(const n of t)for(let e=0;e<4;e++)if(this.getPieceAtXY(e,n)!==t0.EMPTY)return!1;return!0}isInOpponentTerritory(e){const t=this.getCurrentOpponent();return this.getPlayerTerritory(t).contains(e.y)}isInPlayerTerritory(e){const t=this.getCurrentPlayer();return this.getPlayerTerritory(t).contains(e.y)}getCapturesOf(e){const t=this.captured.get(TZ.fromTurn(e)).get();return[t.captures.get(t0.PAWN).getOrElse(0),t.captures.get(t0.DRONE).getOrElse(0),t.captures.get(t0.QUEEN).getOrElse(0)]}}i0.PLAYER_ZERO_TERRITORY=new rj([0,1,2,3]),i0.PLAYER_ONE_TERRITORY=new rj([4,5,6,7]);let s0=(()=>{class e{}return e.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY=()=>$localize`You must pick a piece from your side of the board in order to move it.`,e.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT=()=>$localize`This is not a valid promotion nor a valid capture.`,e.CANNOT_UNDO_LAST_MOVE=()=>$localize`You cannot perform a move that is the reverse of the previous one.`,e})();class o0 extends mj{applyLegalMove(e,t,n){const r=t.getCopiedBoard();r[e.coord.y][e.coord.x]=t0.EMPTY,r[e.end.y][e.end.x]=n.finalPiece;const i=n.score;let s=t.countDown;if(s.isPresent())if(this.isCapture(e,t))s=o0.STARTING_COUNT_DOWN;else{const e=t.countDown.get();s=Nw.of(e-1)}return e.calledTheClock&&(s=o0.STARTING_COUNT_DOWN),new i0(r,t.turn+1,Nw.of(e),s,i)}isLegal(e,t){this.assertNonDoubleClockCall(e,t);const n=this.isLegalMove(e,t);if(n.isFailure())return Rw.failure(n.getReason());if(e.isUndoneBy(t.lastMove))return Rw.failure(s0.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(e,t))return this.isLegalFieldPromotion(e,t);const r=t.getPieceAt(e.coord),i=t.captured.getCopy();if(this.isCapture(e,t)){const n=t.getCurrentPlayer();let r=i.get(n).get();const s=t.getPieceAt(e.end);r=r.add(s),i.replace(n,r),i.makeImmutable()}return Rw.success({finalPiece:r,score:i})}assertNonDoubleClockCall(e,t){hZ(!1===(t.countDown.isPresent()&&e.calledTheClock),"Should not call the clock twice")}isCapture(e,t){const n=t.isInOpponentTerritory(e.end),r=t.getPieceAt(e.end)!==t0.EMPTY;return n&&r}isFieldPromotion(e,t){const n=t.isInPlayerTerritory(e.end),r=t.getPieceAt(e.end)!==t0.EMPTY;return n&&r}isLegalFieldPromotion(e,t){const n=this.getPromotedPiece(e,t);if(n.isAbsent())return Rw.failure(s0.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());const r=n.get();if(t.isTherePieceOnPlayerSide(r))return Rw.failure(s0.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());{const e={finalPiece:r,score:t.captured.getCopy()};return Rw.success(e)}}isLegalMove(e,t){if(!1===t.isInPlayerTerritory(e.coord))return Rw.failure(s0.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());const n=t.getPieceAt(e.coord);if(n===t0.EMPTY)return Rw.failure(JW.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===t0.PAWN)return e.isValidForPawn()?Rw.success(void 0):Rw.failure(J1.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(n===t0.DRONE&&!1===e.isValidForDrone())return Rw.failure(J1.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());for(const r of e.coord.getUntil(e.end))if(t.getPieceAt(r)!==t0.EMPTY)return Rw.failure(JW.SOMETHING_IN_THE_WAY());return Rw.success(void 0)}getPromotedPiece(e,t){const n=t.getPieceAt(e.coord),r=t.getPieceAt(e.end);return t0.tryMerge(n,r)}getGameStatus(e){const t=e.gameState;if(t.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(t,gj.DRAW);if(t.getEmptyTerritory().isPresent()){const e=t.getCurrentOpponent(),n=gj.getVictory(e);return this.getGameStatusScoreVictoryOr(t,n)}return gj.ONGOING}getGameStatusScoreVictoryOr(e,t){const n=e.getScoreOf(TZ.ZERO),r=e.getScoreOf(TZ.ONE);return n>r?gj.ZERO_WON:r>n?gj.ONE_WON:t}}o0.STARTING_COUNT_DOWN=Nw.of(7);let a0=(()=>{class e{}return e.YOU_DID_NOT_CAPTURE_ANY_PIECE=()=>$localize`Failed, you did not capture any piece.`,e})();const l0=t0.EMPTY,c0=t0.PAWN,u0=t0.DRONE,h0=t0.QUEEN,d0=()=>$localize`This is not a field promotion!`;class f0{constructor(){this.tutorial=[_j.informational($localize`Goal of the game`,$localize`At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal.`,i0.getInitialState()),_j.informational($localize`The pieces`,$localize`The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>`,i0.getInitialState()),_j.fromPredicate($localize`Moving pawns`,$localize`Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn.`,i0.getInitialState(),e0.from(new GW(1,2),new GW(2,3)).get(),(e,t,n)=>n.getPieceAt(e.end)===t0.PAWN?Lw.SUCCESS:Lw.failure($localize`This is not a pawn!`),$localize`Congratulations!`),_j.fromPredicate($localize`Moving drones`,$localize`Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone.`,i0.getInitialState(),e0.from(new GW(2,0),new GW(3,0)).get(),(e,t,n)=>n.getPieceAt(e.end)===t0.DRONE?Lw.SUCCESS:Lw.failure($localize`This is not a drone!`),$localize`Congratulations!`),_j.fromPredicate($localize`Moving queens`,$localize`Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen.`,new i0([[u0,c0,l0,l0],[h0,l0,l0,l0],[l0,l0,l0,l0],[l0,l0,h0,l0],[l0,l0,l0,l0],[l0,l0,l0,l0],[l0,l0,l0,l0],[h0,u0,c0,l0]],0),e0.from(new GW(2,3),new GW(2,7)).get(),(e,t,n)=>n.getPieceAt(e.end)===t0.QUEEN?Lw.SUCCESS:Lw.failure($localize`This is not a queen!`),$localize`Congratulations!`),_j.fromMove($localize`Capture`,$localize`When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it.`,new i0([[u0,c0,c0,l0],[l0,l0,l0,l0],[h0,l0,l0,l0],[l0,l0,l0,l0],[l0,l0,c0,l0],[l0,l0,l0,l0],[l0,l0,l0,l0],[l0,u0,c0,l0]],0),[e0.from(new GW(0,2),new GW(2,4)).get()],$localize`Congratulations! By capturing that pawn, you won one point.`,a0.YOU_DID_NOT_CAPTURE_ANY_PIECE()),_j.fromMove($localize`Field Promotion (1/2)`,$localize`It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it.`,new i0([[l0,l0,l0,h0],[l0,c0,l0,l0],[l0,l0,c0,l0],[l0,l0,l0,l0],[l0,l0,l0,l0],[l0,l0,l0,h0],[l0,l0,u0,l0],[l0,c0,l0,l0]],0),[e0.from(new GW(1,1),new GW(2,2)).get(),e0.from(new GW(2,2),new GW(1,1)).get()],$localize`Congratulations!`,d0()),_j.fromPredicate($localize`Field Promotion (2/2)`,$localize`The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it.`,new i0([[c0,l0,l0,l0],[l0,l0,l0,l0],[l0,l0,l0,l0],[l0,l0,l0,l0],[l0,l0,l0,l0],[l0,l0,l0,l0],[l0,l0,u0,l0],[l0,c0,l0,l0]],1),e0.from(new GW(1,7),new GW(2,6)).get(),(e,t,n)=>n.getPieceAt(e.end)===t0.QUEEN?Lw.SUCCESS:Lw.failure(d0()),$localize`Congratulations!`),_j.fromPredicate($localize`Call the clock`,$localize`When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You're playing Dark. Call the clock and perform a move.`,i0.getInitialState(),e0.from(new GW(2,2),new GW(3,3),!0).get(),(e,t,n)=>e.calledTheClock?Lw.SUCCESS:Lw.failure($localize`You did not call the clock!`),$localize`Congratulations!`),_j.fromMove($localize`Restarting the clock`,$localize`If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You are playing Dark, do a capture to restart the countdown.`,new i0([[l0,l0,l0,l0],[l0,c0,l0,l0],[l0,l0,l0,l0],[l0,l0,l0,l0],[l0,l0,l0,l0],[l0,l0,l0,c0],[l0,l0,u0,l0],[l0,c0,l0,l0]],14,Nw.empty(),Nw.of(1)),[e0.from(new GW(1,1),new GW(2,2)).get()],$localize`Congratulations!`,$localize`This is not a capture, the game is now over, please retry!`),_j.anyMove($localize`End game (by clock)`,$localize`When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You are playing Dark, do the last move.`,new i0([[l0,l0,l0,h0],[l0,c0,l0,l0],[l0,l0,l0,l0],[l0,l0,l0,l0],[l0,l0,l0,l0],[u0,l0,l0,l0],[l0,l0,l0,l0],[l0,u0,l0,l0]],14,Nw.empty(),Nw.of(1)),e0.from(new GW(1,1),new GW(2,2)).get(),$localize`Congratulations!`),_j.fromPredicate($localize`End by emptyness`,$localize`When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!`,new i0([[l0,l0,l0,h0],[l0,c0,l0,l0],[l0,l0,l0,l0],[l0,l0,l0,l0],[l0,l0,c0,l0],[l0,l0,l0,l0],[l0,l0,l0,l0],[l0,l0,l0,l0]],1),e0.from(new GW(2,4),new GW(1,3)).get(),(e,t,n)=>3===e.end.y?Lw.SUCCESS:Lw.failure($localize`Your piece is still in you territory!`),$localize`Congratulations!`)]}}function p0(e,t){if(1&e&&(_n(),ga(0,"g",20)),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();Ba(n.style),Ia("mainShapeId","pawn_",e,"_",t,""),ha("pieceClasses",n.getPieceClasses(e,t))}}function g0(e,t){if(1&e&&(_n(),ga(0,"g",21)),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();Ba(n.style),Ia("mainShapeId","drone_",e,"_",t,""),ha("pieceClasses",n.getPieceClasses(e,t))}}function m0(e,t){if(1&e&&(_n(),ga(0,"g",22)),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();Ba(n.style),Ia("mainShapeId","queen_",e,"_",t,""),ha("pieceClasses",n.getPieceClasses(e,t))}}function y0(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,p0,1,5,"g",17),la(2,g0,1,5,"g",18),la(3,m0,1,5,"g",19),pa()),2&e){const e=Sa(),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();ra("transform",i.getPieceLocation(t,r)),Ts(1),ha("ngIf",n===i.pieces.PAWN),Ts(1),ha("ngIf",n===i.pieces.DRONE),Ts(1),ha("ngIf",n===i.pieces.QUEEN)}}function v0(e,t){if(1&e){const e=va();_n(),fa(0,"g",15),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),ga(1,"rect",16),la(2,y0,4,4,"g",14),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();Ia("id","click_",n,"_",r,""),ra("transform","translate(0,  "+(r<=3?0:2*i.STROKE_WIDTH)+")"),Ts(1),Ia("id","square_",n,"_",r,""),ha("ngClass",i.getSquareClasses(n,r)),ra("x",n*i.SPACE_SIZE)("y",r*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),Ts(1),ha("ngIf",e!==i.pieces.EMPTY)}}function C0(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",23),Ea("click",function(){const t=Gt(e).$implicit;return Sa(3).onClick(t.x,t.y)}),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa(3);Ts(1),Ia("id","indicator_",e.x,"_",e.y,""),ra("transform","translate(0,  "+(e.y<=3?0:2*n.STROKE_WIDTH)+")")("x",e.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",e.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}function _0(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,C0,2,7,"g",1),pa()),2&e){const e=Sa(2);Ts(1),ha("ngForOf",e.selectedPieceInfo.get().legalLandings)}}function E0(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,v0,3,11,"g",13),la(2,_0,2,1,"g",14),pa()),2&e){const e=t.$implicit,n=Sa();ra("transform","translate("+n.SPACE_SIZE+", 0)"),Ts(1),ha("ngForOf",e),Ts(1),ha("ngIf",n.selectedPieceInfo.isPresent())}}function w0(e,t){if(1&e&&(_n(),fa(0,"text",24),Qa(1),pa()),2&e){const e=Sa();ha("ngClass","player"+e.getCurrentPlayer().value)("ngClass",e.getClockCircleClasses()),ra("x",.5*e.SPACE_SIZE)("y",.5*e.SPACE_SIZE),Ts(1),Xa(e.countDown.get())}}function P0(e,t){if(1&e&&(_n(),ga(0,"polyline",25)),2&e){const e=Sa();ha("ngClass",e.getClockCircleClasses()),ra("points",e.clockNeedlesPoints)}}const S0=function(e){return[e]};function b0(e,t){if(1&e){const e=va();_n(),ma(0),fa(1,"g",28),Ea("click",function(){const t=Gt(e).index;return Sa(2).chooseStyle(t)}),pa(),ya()}if(2&e){const e=t.$implicit,n=t.index,r=Sa(2);Ts(1),Ba(e.style),ha("id",e.name)("pieceClasses",Pu(5,S0,"player"+r.getCurrentPlayer().value)),ra("transform","translate(0, "+-(n+1)*r.SPACE_SIZE+")")}}function O0(e,t){if(1&e&&(_n(),fa(0,"g",26),ga(1,"rect",27),la(2,b0,2,7,"ng-container",1),pa()),2&e){const e=Sa();Ts(1),ra("x",0)("y",-e.listOfStyles.length*e.SPACE_SIZE)("width",1*e.SPACE_SIZE)("height",e.listOfStyles.length*e.SPACE_SIZE),Ts(1),ha("ngForOf",e.listOfStyles)}}function T0(e,t){if(1&e&&(_n(),fa(0,"text",34),Qa(1),pa()),2&e){const e=Sa(2).$implicit,t=Sa().$implicit,n=Sa();ha("ngClass","player"+(0===t?1:0)),ra("x",n.SPACE_SIZE/2)("y",n.SPACE_SIZE/2),Ts(1),Xa(e+" x ")}}function I0(e,t){if(1&e&&(_n(),ga(0,"g",35)),2&e){const e=Sa(3).$implicit;Ba(Sa().style),ha("pieceClasses",Pu(3,S0,"player"+(0===e?1:0)))}}function k0(e,t){if(1&e&&(_n(),ga(0,"g",36)),2&e){const e=Sa(3).$implicit;Ba(Sa().style),ha("pieceClasses",Pu(3,S0,"player"+(0===e?1:0)))}}function A0(e,t){if(1&e&&(_n(),ga(0,"g",37)),2&e){const e=Sa(3).$implicit;Ba(Sa().style),ha("pieceClasses",Pu(3,S0,"player"+(0===e?1:0)))}}function M0(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,T0,2,4,"text",30),fa(2,"g",29),la(3,I0,1,5,"g",31),la(4,k0,1,5,"g",32),la(5,A0,1,5,"g",33),pa(),pa()),2&e){const e=Sa(),t=e.index,n=e.$implicit,r=Sa().$implicit,i=Sa();ra("transform","translate(0, "+2*t*i.SPACE_SIZE+")"),Ts(1),ha("ngIf",n>1),Ts(1),Ia("id","piece_",t,"_player_",r,""),ra("transform","translate("+i.SPACE_SIZE+", 0)"),Ts(1),ha("ngIf",0===t),Ts(1),ha("ngIf",1===t),Ts(1),ha("ngIf",2===t)}}function N0(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,M0,6,8,"g",14),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngIf",e>0)}}function R0(e,t){if(1&e&&(_n(),fa(0,"g"),fa(1,"g",29),la(2,N0,2,1,"g",1),pa(),pa()),2&e){const e=t.$implicit,n=Sa();Ts(1),Ta("id","capture_of_player_",e,""),ra("transform","scale(0.5, 0.5) translate("+-n.SPACE_SIZE/2+", "+(n.SPACE_SIZE/2+e*(10*n.SPACE_SIZE+4*n.STROKE_WIDTH))+")"),Ts(1),ha("ngForOf",n.state.getCapturesOf(e))}}const x0=function(){return[0,1]};let D0=(()=>{class e extends tY{constructor(t){super(t),this.INDICATOR_SIZE=20,this.LEFT=e.SPACE_SIZE/-4+e.STROKE_WIDTH/-2,this.UP=-e.STROKE_WIDTH/2,this.WIDTH=6.5*e.SPACE_SIZE+e.STROKE_WIDTH,this.HEIGHT=8*e.SPACE_SIZE+3*e.STROKE_WIDTH,this.MartianChessComponent=e,this.style={shape:"Circle",points:"Horizontal Points"},this.pieces=t0,this.selectedPieceInfo=Nw.empty(),this.countDown=Nw.empty(),this.callTheClock=!1,this.displayModePanel=!1,this.listOfStyles=[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}],this.rules=new o0(i0),this.availableMinimaxes=[new n0(this.rules,"Martian Chess Dummy Minimax")],this.SPACE_SIZE=e.SPACE_SIZE,this.configCogTransformation=this.getConfigCogTransformation(),this.configViewTranslation=this.getConfigViewTranslation(),this.clockNeedlesPoints=this.getClockNeedlesPoints(),this.encoder=e0.encoder,this.tutorial=(new f0).tutorial,this.scores=Nw.of([0,0]),this.updateBoard()}static getRegularPolygon(t,n=0){const r=e.getRegularPolygonCoords(t,n);return e.mapCoordsToString(r)}static getNPointedStar(t,n){const r=this.getNPointedStarCoords(t,n);return e.mapCoordsToString(r)}static getNPointedStarCoords(t,n){const r=[],i=.5*e.SPACE_SIZE,s=.5*e.SPACE_SIZE;t*=2;for(let o=0;o<t;o++){const a=(o*(360/t)+n)/180*Math.PI,l=o%2==0?e.SPACE_SIZE/2:e.SPACE_SIZE/6,c=i+.8*l*Math.cos(a),u=s+.8*l*Math.sin(a);r.push(new GW(c,u))}return r}static getRegularPolygonCoords(t,n=0){const r=[],i=.5*e.SPACE_SIZE,s=.5*e.SPACE_SIZE;for(let o=0;o<t;o++){const a=(o*(360/t)-90)/180*Math.PI,l=.5*e.SPACE_SIZE,c=i+.8*l*Math.cos(a),u=s+.8*l*Math.sin(a)+n;r.push(new GW(c,u))}return r}static mapCoordsToString(e){let t="";for(const n of e)t+=n.x+", "+n.y+" ";return t}static getRadius(e){return this.SPACE_SIZE*e/10}getConfigViewTranslation(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}getConfigCogTransformation(){const e=this.STROKE_WIDTH,t=(this.SPACE_SIZE-e)/40;return"translate("+1*e+", "+1*e+") scale("+t+" "+t+")"}getClockNeedlesPoints(){const e=.5*this.SPACE_SIZE;return e+" "+.1*this.SPACE_SIZE+", "+e+" "+e+", "+.75*this.SPACE_SIZE+" "+e}updateBoard(){this.state=this.rules.node.gameState,this.board=this.state.board;const e=this.state.getScoreOf(TZ.ZERO),t=this.state.getScoreOf(TZ.ONE);this.countDown=this.state.countDown,this.scores=Nw.of([e,t])}getPieceLocation(e,t){return"translate("+this.SPACE_SIZE*e+", "+this.SPACE_SIZE*t+")"}getPieceClasses(e,t){const n=new GW(e,t),r=[];return r.push(t<=3?"player0":"player1"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(n)&&r.push("highlighted"),this.rules.node.move.isPresent()&&this.rules.node.move.get().end.equals(n)&&this.rules.node.mother.get().gameState.getPieceAt(n)!==t0.EMPTY&&this.rules.node.gameState.isInOpponentTerritory(new GW(0,t))&&r.push("highlighted"),r}onClick(e,t){var n=this;return Ow(function*(){n.displayModePanel=!1;const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=new GW(e,t);return n.selectedPieceInfo.isPresent()?n.secondClick(i):n.firstClick(i)})()}firstClick(e){var t=this;return Ow(function*(){return t.isOneOfUsersPieces(e)?t.selectAsFirstPiece(e):(t.cancelMoveAttempt(),Lw.SUCCESS)})()}selectAsFirstPiece(e){var t=this;return Ow(function*(){const n=t.getLegalLandings(e);return t.selectedPieceInfo=Nw.of({selectedPiece:e,legalLandings:n}),Lw.SUCCESS})()}getLegalLandings(e){const t=this.state.getPieceAt(e);let n;return n=t===t0.PAWN?$W.DIAGONALS.map(t=>e.getNext(t)):this.getValidLinearLandingSquareUntil(e,t===t0.DRONE?2:8),n.filter(t=>{const n=e0.from(e,t);return!!n.isSuccess()&&this.rules.isLegal(n.get(),this.getState()).isSuccess()})}getValidLinearLandingSquareUntil(e,t){return $W.DIRECTIONS.flatMap(n=>{const r=[];let i=e.getNext(n),s=1;for(;i.isInRange(4,8)&&s<=t&&(r.push(i),this.getState().getPieceAt(i)===t0.EMPTY);)i=i.getNext(n),s++;return r})}secondClick(e){var t=this;return Ow(function*(){const n=t.selectedPieceInfo.get();if(n.selectedPiece.equals(e))return t.cancelMoveAttempt(),Lw.SUCCESS;if(n.legalLandings.some(t=>t.equals(e))){const r=e0.from(n.selectedPiece,e,t.callTheClock);hZ(r.isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!");const i=t.rules.node.gameState;return t.chooseMove(r.get(),i)}if(t.isOneOfUsersPieces(e))return t.selectAsFirstPiece(e);{const r=e0.from(n.selectedPiece,e,t.callTheClock);return r.isSuccess()?t.chooseMove(r.get(),t.getState()):t.cancelMove(r.getReason())}})()}isOneOfUsersPieces(e){return this.state.getPieceAt(e)!==t0.EMPTY&&this.state.isInPlayerTerritory(e)}cancelMoveAttempt(){this.selectedPieceInfo=Nw.empty(),this.callTheClock=!1}onClockClick(){var e=this;return Ow(function*(){const t=e.canUserPlay("#clockOrCountDownView");return t.isFailure()?e.cancelMove(t.getReason()):(e.getState().countDown.isAbsent()&&(e.callTheClock=!e.callTheClock),Lw.SUCCESS)})()}getClockCircleClasses(){const e=["base"];return this.callTheClock&&e.push("highlighted"),this.getCurrentPlayer()===TZ.ZERO?e.push("player0-stroke"):e.push("player1-stroke"),e}getSquareClasses(e,t){const n=new GW(e,t),r=["base"];if(this.rules.node.move.isPresent()){const e=this.rules.node,i=e.move.get();i.coord.equals(n)?r.push("moved"):i.end.equals(n)&&(e.mother.get().gameState.getPieceAt(n)===t0.EMPTY||e.gameState.isInOpponentTerritory(new GW(0,t))?r.push("moved"):r.push("captured"))}return r}onModeCogClick(){this.displayModePanel=!this.displayModePanel}chooseStyle(e){this.style=this.listOfStyles[e].style,this.displayModePanel=!1}}return e.SPACE_SIZE=100,e.STROKE_WIDTH=8,e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-martian-chess"]],features:[Go],decls:15,vars:25,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","canal",3,"ngClass"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,E0,3,3,"g",1),fa(2,"g",2),Ea("click",function(){return t.onClockClick()}),ga(3,"rect",3),ga(4,"circle",4),la(5,w0,2,5,"text",5),la(6,P0,1,2,"polyline",6),pa(),ga(7,"line",7),fa(8,"g",8),fa(9,"g",9),Ea("click",function(){return t.onModeCogClick()}),ga(10,"rect",3),ga(11,"path",10),pa(),la(12,O0,3,5,"g",11),pa(),fa(13,"g",12),la(14,R0,3,3,"g",1),pa(),pa()),2&e&&(ra("viewBox",t.LEFT+" "+t.UP+" "+t.WIDTH+" "+t.HEIGHT),Ts(1),ha("ngForOf",t.board),Ts(1),ra("transform","translate("+5.25*t.SPACE_SIZE+", 0)"),Ts(1),ra("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),Ts(1),ha("ngClass",t.getClockCircleClasses()),ra("cx",.5*t.SPACE_SIZE)("cy",.5*t.SPACE_SIZE)("r",.4*t.SPACE_SIZE),Ts(1),ha("ngIf",t.countDown.isPresent()),Ts(1),ha("ngIf",t.countDown.isAbsent()),Ts(1),ha("ngClass","player"+t.getCurrentPlayer().value),ra("x1",t.SPACE_SIZE)("y1",5*t.SPACE_SIZE+8)("x2",5*t.SPACE_SIZE)("y2",5*t.SPACE_SIZE+8)("stroke-width",2*t.STROKE_WIDTH),Ts(1),ra("transform",t.configViewTranslation),Ts(2),ra("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),Ts(1),ha("ngClass","player"+t.getCurrentPlayer().value),ra("transform",t.configCogTransformation),Ts(1),ha("ngIf",t.displayModePanel),Ts(2),ha("ngForOf",wu(24,x0)))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();const L0=Number.MAX_SAFE_INTEGER,F0=Number.MIN_SAFE_INTEGER;class U0 extends sj{constructor(e,t){super(NZ.copyBiArray(U0.initialBoard),e),this.turn=e,this.location=t}static getInitialState(){return new U0(0,new GW(0,0))}}U0.BOARD_0=[[6,4,3,1],[4,4,3,1],[3,3,2,0],[1,1,0,0]],U0.BOARD_1=[[0,+L0,-1,-1],[1,2,+L0,-1],[+F0,3,4,-1],[-1,+F0,+F0,-1]],U0.BOARD_2=[[0,+L0,-1,-1],[+L0,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],U0.BOARD_3=[[0,1,+F0,-1],[1,+F0,-1,-1],[+F0,-1,-1,-1],[-1,-1,-1,-1]],U0.BOARD_4=[[0,1,+F0,-1],[1,+F0,-1,-1],[+F0,-1,-1,-1],[-1,-1,-1,1]],U0.initialBoard=U0.BOARD_0;class V0 extends mj{static getGameStatus(e){const t=e.gameState,n=t.getPieceAt(t.location);return n===TZ.ZERO.getVictoryValue()?gj.ZERO_WON:n===TZ.ONE.getVictoryValue()?gj.ONE_WON:t.location.equals(new GW(3,3))?0===n?gj.DRAW:n>0?gj.ONE_WON:gj.ZERO_WON:gj.ONGOING}applyLegalMove(e,t,n){const r=new GW(t.location.x+(!0===e.right?1:0),t.location.y+(!1===e.right?1:0));return new U0(t.turn+1,r)}isLegal(e,t){const n=t.location,r=t.getCopiedBoard();return n.x+1===r[0].length&&!0===e.right||n.y+1===r.length&&!1===e.right?Rw.failure("incorrect move"):Rw.success(void 0)}getGameStatus(e){return V0.getGameStatus(e)}}class B0 extends aj{constructor(e){super(),this.right=e}equals(e){return this===e||this.right===e.right}toString(){return this.right?"Move RIGHT":"Move DOWN"}}B0.RIGHT=new B0(!0),B0.DOWN=new B0(!1),B0.encoder=new class extends bZ{maxValue(){return 1}decodeNumber(e){return 0===e?B0.RIGHT:B0.DOWN}encodeNumber(e){return e.right?0:1}};class $0 extends ej{getBoardValue(e){const t=V0.getGameStatus(e);if(t.isEndGame)return new tj(t.toBoardValue());const n=e.gameState;return new tj(n.getPieceAt(n.location))}getListMoves(e){const t=[],n=e.gameState;return n.location.x<3&&t.push(B0.RIGHT),n.location.y<3&&t.push(B0.DOWN),t}}function z0(e,t){1&e&&(ma(0),Qa(1,"("),ya())}function H0(e,t){1&e&&(ma(0),Qa(1,")"),ya())}function G0(e,t){if(1&e&&(fa(0,"td"),la(1,z0,2,0,"ng-container",3),Qa(2),la(3,H0,2,0,"ng-container",3),pa()),2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();Ts(1),ha("ngIf",i.coord.x===n&&i.coord.y===r),Ts(1),Ja(" ",e," "),Ts(1),ha("ngIf",i.coord.x===n&&i.coord.y===r)}}function Z0(e,t){if(1&e&&(fa(0,"tr"),la(1,G0,4,3,"td",0),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}let q0=(()=>{class e extends tY{constructor(e){super(e),this.coord=new GW(-1,-1),this.rules=new V0(U0),this.availableMinimaxes=[new $0(this.rules,"MinimaxTestingMinimax")],this.encoder=B0.encoder}chooseRight(){var e=this;return Ow(function*(){const t=e.canUserPlay("#click_right");return t.isFailure()?e.cancelMove(t.getReason()):e.chooseMove(B0.RIGHT,e.rules.node.gameState)})()}chooseDown(){var e=this;return Ow(function*(){const t=e.canUserPlay("#click_down");return t.isFailure()?e.cancelMove(t.getReason()):e.chooseMove(B0.DOWN,e.rules.node.gameState)})()}updateBoard(){const e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.coord=e.location}}return e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-minimax-testing"]],features:[Go],decls:8,vars:2,consts:[[4,"ngFor","ngForOf"],["id","click_right",3,"click"],["id","click_down",3,"click"],[4,"ngIf"]],template:function(e,t){1&e&&(fa(0,"table"),la(1,Z0,2,1,"tr",0),fa(2,"div",1),Ea("click",function(){return t.chooseRight()}),Qa(3," goRight "),pa(),fa(4,"div",2),Ea("click",function(){return t.chooseDown()}),Qa(5," goDown "),pa(),fa(6,"div"),Qa(7),pa(),pa()),2&e&&(Ts(1),ha("ngForOf",t.board),Ts(6),Ja(" ",t.coord," "))},directives:[tf,rf],encapsulation:2}),e})();class W0 extends sj{static getInitialState(){const e=NZ.createTable(7,6,IZ.NONE);return new W0(e,0)}}class j0 extends aj{constructor(e){super(),this.x=e}static of(e){switch(e){case 0:return j0.ZERO;case 1:return j0.ONE;case 2:return j0.TWO;case 3:return j0.THREE;case 4:return j0.FOUR;case 5:return j0.FIVE;case 6:return j0.SIX;default:throw new Error("Invalid P4Move")}}equals(e){return this===e}toString(){return"P4Move("+this.x+")"}}j0.ZERO=new j0(0),j0.ONE=new j0(1),j0.TWO=new j0(2),j0.THREE=new j0(3),j0.FOUR=new j0(4),j0.FIVE=new j0(5),j0.SIX=new j0(6),j0.encoder=new class extends bZ{maxValue(){return 6}encodeNumber(e){return e.x}decodeNumber(e){return j0.of(e)}};let Y0=(()=>{class e{}return e.COLUMN_IS_FULL=()=>$localize`Please put your piece in an incomplete column.`,e})(),K0=(()=>{class e extends mj{static getVictoriousCoords(t){const n=[];for(let r=0;r<7;r++)for(let i=5;-1!==i&&t.board[i][r].isPlayer();i--){const s=e.getSquareScore(t.board,new GW(r,i));(s===TZ.ZERO.getVictoryValue()||s===TZ.ONE.getVictoryValue())&&n.push(new GW(r,i))}return n}static getBoardValueFromScratch(t){Iw(e.VERBOSE,{P4Rules_getBoardValueFromScratch:{state:t}});let n=0;for(let r=0;r<7;r++)for(let i=5;-1!==i&&t.board[i][r].isPlayer();i--){const s=e.getSquareScore(t.board,new GW(r,i));if(pj.getScoreStatus(s)!==uj.DEFAULT)return Iw(e.VERBOSE,{preVictoryOrVictory:{state:t,tmpScore:s,coord:{x:r,y:i}}}),new tj(s);n+=s}return new tj(n)}static getLowestUnoccupiedCase(e,t){let n=0;for(;n<6&&e[n][t]===IZ.NONE;)n++;return n-1}static getNumberOfFreeSpacesAndAllies(e,t,n,r,i){let s=0,o=0,a=!0,l=new GW(t.x+n.x,t.y+n.y);for(;l.isInRange(7,6)&&3!==s;){const t=e[l.y][l.x];if(t===r)return[s,o];t===i&&a?o++:a=!1,t!==r&&t!==i&&s++,l=l.getNext(n)}return[s,o]}static getOpponent(e,t){const n=e[t.y][t.x];return hZ(n.isPlayer(),"getOpponent should not be called with PlayerOrNone.NONE"),n===TZ.ONE?TZ.ZERO:TZ.ONE}static getSquareScore(t,n){Iw(e.VERBOSE,"getSquareScore(board, "+n.x+", "+n.y+") called"),Iw(e.VERBOSE,t);let r=0;const i=e.getOpponent(t,n),s=i.getOpponent(),o=new hj,a=new hj;for(const l of $W.DIRECTIONS){const r=e.getNumberOfFreeSpacesAndAllies(t,n,l,i,s);o.set(l,r[0]),a.set(l,r[1])}for(const l of[$W.UP,$W.UP_RIGHT,$W.RIGHT,$W.DOWN_RIGHT]){const i=a.get(l).get()+a.get(l.getOpposite()).get();if(i>2)return Iw(e.VERBOSE,{text:"there is some kind of victory here ("+n.x+", "+n.y+")\nline allies : "+i+"\n",board:t}),s.getVictoryValue();const c=o.get(l).get()+o.get(l.getOpposite()).get();3===c?r+=2:c>3&&(r+=c-2)}return r*s.getScoreModifier()}static getListMoves(t){Iw(e.VERBOSE,{context:"P4Rules.getListMoves",node:t});const n=t.gameState,r=[];for(let e=0;e<7;e++)if(n.getPieceAtXY(e,0)===IZ.NONE){const t=j0.of(e);r.push(t)}return r}static getBoardValue(t){return Iw(e.VERBOSE,{text:"P4Rules.getBoardValue called",board:t.getCopiedBoard()}),e.getBoardValueFromScratch(t)}applyLegalMove(t,n,r){const i=t.x,s=n.getCopiedBoard(),o=e.getLowestUnoccupiedCase(s,i),a=n.turn;return s[o][i]=n.getCurrentPlayer(),new W0(s,a+1)}isLegal(t,n){return Iw(e.VERBOSE,{context:"P4Rules.isLegal",move:t.toString(),state:n}),n.getPieceAtXY(t.x,0).isPlayer()?Rw.failure(Y0.COLUMN_IS_FULL()):Rw.success(void 0)}getGameStatus(t){const n=t.gameState;for(let r=0;r<7;r++)for(let t=5;t>=0&&n.board[t][r].isPlayer();t--){const i=e.getSquareScore(n.board,new GW(r,t));if(pj.getScoreStatus(i)===uj.VICTORY)return gj.getVictory(n.getCurrentOpponent())}return 42===n.turn?gj.DRAW:gj.ONGOING}}return e.VERBOSE=!1,e})();class Q0 extends ej{getListMoves(e){return K0.getListMoves(e)}getBoardValue(e){const t=e.gameState;return Iw(K0.VERBOSE,{text:"P4Rules instance methods getBoardValue called",board:t.getCopiedBoard()}),K0.getBoardValue(t)}}const X0=IZ.NONE,J0=IZ.ZERO,e2=IZ.ONE;class t2{constructor(){this.tutorial=[_j.informational($localize`Goal of the game`,$localize`The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.
        The first player plays Dark, the second plays Light.
        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally).`,W0.getInitialState()),_j.anyMove($localize`Dropping a piece`,$localize`Click on any space in any column.`,W0.getInitialState(),j0.THREE,$localize`As you can see, the piece falls at the bottom of the column.`),_j.fromMove($localize`Victory`,$localize`You're playing Dark.
        Place your piece so that you create a horizontal alignment of 4 of your pieces.`,new W0([[X0,X0,X0,X0,X0,X0,X0],[X0,X0,X0,X0,X0,X0,X0],[X0,X0,X0,X0,X0,X0,X0],[X0,X0,X0,e2,X0,X0,X0],[X0,X0,X0,e2,X0,X0,X0],[X0,X0,J0,J0,J0,e2,X0]],0),[j0.of(1)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`),_j.fromMove($localize`Other victory`,$localize`You can also align 4 pieces diagonally or vertically.`,new W0([[X0,X0,X0,X0,X0,X0,X0],[X0,X0,X0,X0,X0,X0,X0],[X0,X0,X0,X0,X0,X0,X0],[X0,X0,X0,J0,e2,X0,X0],[X0,X0,J0,J0,e2,X0,X0],[X0,J0,e2,J0,J0,X0,X0]],0),[j0.of(3),j0.of(4)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`)]}}function n2(e,t){if(1&e&&(_n(),ga(0,"circle",8)),2&e){const e=Sa().index,t=Sa().index,n=Sa();ha("ngClass",n.getSquareFillClass(e,t)),ra("cx",n.SPACE_SIZE*e+n.SPACE_SIZE/2)("cy",n.SPACE_SIZE*t+n.SPACE_SIZE/2)("r",n.SPACE_SIZE/2-n.STROKE_WIDTH)}}function r2(e,t){if(1&e){const e=va();_n(),fa(0,"g",5),Ea("click",function(){const t=Gt(e).index;return Sa(2).onClick(t)}),ga(1,"rect",6),la(2,n2,1,4,"circle",7),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();Ta("id","click_",n,""),Ts(1),ra("x",i.SPACE_SIZE*n)("y",i.SPACE_SIZE*r)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),Ts(1),ha("ngIf",e!==i.EMPTY)}}function i2(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,r2,3,6,"g",4),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}function s2(e,t){if(1&e&&(_n(),ga(0,"rect",9)),2&e){const e=Sa();ra("x",e.SPACE_SIZE*e.last.get().x)("y",e.SPACE_SIZE*e.last.get().y)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function o2(e,t){if(1&e&&(_n(),ga(0,"rect",10)),2&e){const e=t.$implicit,n=Sa();Ia("id","victory_coord_",e.x,"_",e.y,""),ra("x",n.SPACE_SIZE*e.x)("y",n.SPACE_SIZE*e.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let a2=(()=>{class e extends tY{constructor(e){super(e),this.EMPTY=IZ.NONE,this.victoryCoords=[],this.rules=new K0(W0),this.availableMinimaxes=[new Q0(this.rules,"P4Minimax")],this.encoder=j0.encoder,this.tutorial=(new t2).tutorial,this.updateBoard()}onClick(e){var t=this;return Ow(function*(){const n=t.canUserPlay("#click_"+e);if(n.isFailure())return t.cancelMove(n.getReason());const r=j0.of(e);return yield t.chooseMove(r,t.rules.node.gameState)})()}updateBoard(){const e=this.rules.node.gameState,t=this.rules.node.move;this.victoryCoords=K0.getVictoriousCoords(e),this.board=e.board,t.isPresent()?this.showLastMove():this.hideLastMove()}showLastMove(){const e=this.rules.node.move,t=K0.getLowestUnoccupiedCase(this.rules.node.gameState.board,e.get().x)+1;this.last=Nw.of(new GW(e.get().x,t))}hideLastMove(){this.last=Nw.empty()}getSquareFillClass(e,t){return[this.getPlayerClass(this.board[t][e])]}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-p4"]],features:[Go],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,i2,2,1,"g",1),la(2,s2,1,4,"rect",2),la(3,o2,1,6,"rect",3),pa()),2&e&&(Ts(1),ha("ngForOf",t.board),Ts(1),ha("ngIf",t.last.isPresent()),Ts(1),ha("ngForOf",t.victoryCoords))},directives:[tf,rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class l2 extends lj{constructor(e,t,n,r=!1){if(super(e,t),this.blockTurned=n,this.turnedClockwise=r,this.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+this.coord.toString())}static withRotation(e,t,n,r){if(n<0||3<n)throw new Error("This block do not exist: "+n);return new l2(e,t,Nw.of(n),r)}static rotationless(e,t){return new l2(e,t,Nw.empty())}toString(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}equals(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}l2.encoder=new class extends SZ{encodeMove(e){const t={coord:GW.encoder.encode(e.coord)};return e.blockTurned.isPresent()&&(t.blockTurned=e.blockTurned.get(),t.turnedClockwise=e.turnedClockwise),t}decodeMove(e){const t=e,n=GW.encoder.decode(t.coord),r=Nw.ofNullable(t.blockTurned);if(r.isPresent()){const e=t.turnedClockwise;return l2.withRotation(n.x,n.y,r.get(),e)}return l2.rotationless(n.x,n.y)}};let c2=(()=>{class e{}return e.CANNOT_ROTATE_NEUTRAL_BLOCK=()=>$localize`If the quadrant to turn is neutral, please just use move without rotation.`,e.MUST_CHOOSE_BLOCK_TO_ROTATE=()=>$localize`No quadrant is neutral, you must pick a quadrant to rotate.`,e})();class u2 extends sj{constructor(e,t){super(e,t),this.neutralBlocks=this.getBlocksNeutralities()}static getInitialState(){const e=NZ.createTable(6,6,IZ.NONE);return new u2(e,0)}getBlocksNeutralities(){const e=[];for(let t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}getBlockNeutrality(e){const t=u2.getBlockCenter(e),n=this.getPieceAt(t.getNext($W.UP,1)),r=this.getPieceAt(t.getNext($W.UP_LEFT,1));return this.getPieceAt(t.getNext($W.RIGHT,1))===n&&this.getPieceAt(t.getNext($W.DOWN,1))===n&&this.getPieceAt(t.getNext($W.LEFT,1))===n&&this.getPieceAt(t.getNext($W.UP_RIGHT,1))===r&&this.getPieceAt(t.getNext($W.DOWN_RIGHT,1))===r&&this.getPieceAt(t.getNext($W.DOWN_LEFT,1))===r}static getBlockCenter(e){return new GW(1+(e%2==0?0:3),1+(e<2?0:3))}applyLegalDrop(e){const t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new u2(t,this.turn)}applyLegalMove(e){const t=this.applyLegalDrop(e),n=t.getCopiedBoard();if(e.blockTurned.isPresent()){const r=u2.getBlockCenter(e.blockTurned.get());if(e.turnedClockwise)for(const e of u2.ROTATION_MAP){const i=e[0].getNext(r),s=e[1].getNext(r),o=t.getPieceAt(i);n[s.y][s.x]=o}else for(const e of u2.ROTATION_MAP){const i=e[1].getNext(r),s=e[0].getNext(r),o=t.getPieceAt(i);n[s.y][s.x]=o}}return new u2(n,this.turn+1)}blockIsNeutral(e){return this.neutralBlocks.includes(e)}}u2.ROTATION_MAP=[[new GW(-1,-1),new GW(1,-1)],[new GW(0,-1),new GW(1,0)],[new GW(1,-1),new GW(1,1)],[new GW(1,0),new GW(0,1)],[new GW(1,1),new GW(-1,1)],[new GW(0,1),new GW(-1,0)],[new GW(-1,1),new GW(-1,-1)],[new GW(-1,0),new GW(0,-1)]];class h2 extends mj{static get(){return h2.singleton.isAbsent()&&(h2.singleton=Nw.of(new h2(u2))),h2.singleton.get()}applyLegalMove(e,t,n){return t.applyLegalMove(e)}isLegal(e,t){if(t.getPieceAt(e.coord).isPlayer())return Rw.failure(JW.MUST_LAND_ON_EMPTY_SPACE());const n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return Rw.failure(c2.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){const t=e.blockTurned.get();if(n.neutralBlocks.includes(t))return Rw.failure(c2.CANNOT_ROTATE_NEUTRAL_BLOCK())}return Rw.success(void 0)}getVictoryCoords(e){let t=[];for(const n of h2.VICTORY_SOURCE){const r=e.getPieceAt(n[0]),i=[n[0]];if(r.isPlayer()){let s=n[0].getNext(n[1]),o=!0;for(let t=0;t<3&&o;t++)e.getPieceAt(s)!==r?o=!1:(i.push(s),s=s.getNext(n[1]));if(o&&(e.getPieceAt(s)===r&&(i.push(s),t=t.concat(i)),n[2])){const s=n[0].getPrevious(n[1],1);e.getPieceAt(s)===r&&(i.push(s),t=t.concat(i))}}}return t}getGameStatus(e){const t=e.gameState,n=this.getVictoryCoords(t),r=[!1,!1];for(let i=0;i<n.length;i+=5)r[t.getPieceAt(n[i]).value]=!0;return!0===r[0]?!0===r[1]?gj.DRAW:gj.ZERO_WON:!0===r[1]?gj.ONE_WON:36===t.turn?gj.DRAW:gj.ONGOING}}h2.singleton=Nw.empty(),h2.VICTORY_SOURCE=[[new GW(1,0),new UW(1,1),!1],[new GW(0,1),new UW(1,1),!1],[new GW(4,0),new UW(-1,1),!1],[new GW(5,1),new UW(-1,1),!1],[new GW(1,1),new UW(1,1),!0],[new GW(4,1),new UW(-1,1),!0],[new GW(0,1),new UW(0,1),!0],[new GW(1,1),new UW(0,1),!0],[new GW(2,1),new UW(0,1),!0],[new GW(3,1),new UW(0,1),!0],[new GW(4,1),new UW(0,1),!0],[new GW(5,1),new UW(0,1),!0],[new GW(1,0),new UW(1,0),!0],[new GW(1,1),new UW(1,0),!0],[new GW(1,2),new UW(1,0),!0],[new GW(1,3),new UW(1,0),!0],[new GW(1,4),new UW(1,0),!0],[new GW(1,5),new UW(1,0),!0]];class d2 extends ej{getListMoves(e){const t=[],n=e.gameState.neutralBlocks;if(0===e.gameState.turn)return d2.FIRST_TURN_MOVES;const r=this.getLegalDrops(e.gameState);for(const i of r){const r=l2.rotationless(i.x,i.y),s=e.gameState.applyLegalDrop(r),o=this.getLegalRotations(s,n);for(const e of o)t.push(l2.withRotation(i.x,i.y,e[0],e[1]));0===s.neutralBlocks.length==0&&t.push(r)}return t}getLegalDrops(e){const t=[];for(let n=0;n<6;n++)for(let r=0;r<6;r++){const i=new GW(r,n);e.getPieceAt(i)===IZ.NONE&&t.push(i)}return t}getLegalRotations(e,t){const n=0===e.neutralBlocks.length,r=[];for(let i=0;i<4;i++)!1===e.blockIsNeutral(i)&&(t.includes(i)?n&&r.push([i,!0]):r.push([i,!0],[i,!1]));return r}getBoardValue(e){return new tj(h2.get().getGameStatus(e).toBoardValue())}}d2.FIRST_TURN_MOVES=[l2.rotationless(0,0),l2.rotationless(1,0),l2.rotationless(2,0),l2.rotationless(0,1),l2.rotationless(1,1),l2.rotationless(0,2)];const f2=IZ.NONE,p2=IZ.ZERO,g2=IZ.ONE;class m2{constructor(){this.tutorial=[_j.informational($localize`Initial board`,$localize`The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate.`,u2.getInitialState()),_j.informational($localize`Goal of the game`,$localize`The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins.`,new u2([[p2,f2,f2,p2,g2,f2],[p2,g2,f2,f2,f2,f2],[p2,f2,g2,f2,f2,f2],[p2,f2,f2,f2,f2,g2],[p2,f2,f2,f2,g2,f2],[f2,f2,f2,f2,f2,f2]],10)).withPreviousMove(l2.withRotation(0,0,0,!1)),_j.fromPredicate($localize`Simple move`,$localize`At their turn, players put a piece on the board and possibly rotate one quadrant.
        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.
        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>
        Do it.`,new u2([[f2,f2,f2,f2,f2,f2],[f2,p2,f2,f2,g2,f2],[f2,f2,f2,f2,f2,f2],[f2,f2,f2,f2,f2,f2],[f2,g2,f2,f2,p2,f2],[f2,f2,f2,f2,f2,f2]],10),l2.rotationless(2,2),(e,t,n)=>e.blockTurned.isPresent()?Lw.failure($localize`You have made a move with a rotation. This tutorial step is about moves without rotations!`):Lw.SUCCESS,$localize`Congratulations!`),_j.fromPredicate($localize`Move with rotation`,$localize`After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>
        Click on one of them and see the rotation!`,new u2([[f2,f2,f2,f2,f2,f2],[f2,p2,f2,f2,g2,f2],[f2,f2,f2,f2,f2,f2],[f2,f2,f2,f2,f2,f2],[f2,g2,f2,f2,p2,f2],[f2,f2,f2,f2,f2,f2]],10),l2.withRotation(0,0,0,!0),(e,t,n)=>e.blockTurned.isPresent()?Lw.SUCCESS:Lw.failure($localize`You made a move without rotation, try again!`),$localize`Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation.`)]}}function y2(e,t){if(1&e){const e=va();_n(),ma(0),fa(1,"circle",9),Ea("click",function(){const t=Gt(e).$implicit,n=Sa().$implicit,r=Sa().index,i=Sa().index;return Sa().onClick(3*r+t,3*i+n)}),pa(),ya()}if(2&e){const e=t.$implicit,n=Sa().$implicit,r=Sa(),i=r.index,s=r.$implicit,o=Sa(),a=o.index,l=o.$implicit,c=Sa();Ts(1),Ia("id","click_",3*i+e,"_",3*a+n,""),ha("ngClass",c.getSquareClasses(3*i+e,3*a+n)),ra("cx",s+2*c.STROKE_WIDTH+(e+.5)*c.SPACE_SIZE)("cy",l+2*c.STROKE_WIDTH+(n+.5)*c.SPACE_SIZE)("r",(c.SPACE_SIZE-c.STROKE_WIDTH)/2)}}const v2=function(){return[0,1,2]};function C2(e,t){1&e&&(_n(),ma(0),la(1,y2,2,6,"ng-container",3),ya()),2&e&&(Ts(1),ha("ngForOf",wu(1,v2)))}function _2(e,t){if(1&e&&(_n(),ma(0),ga(1,"rect",8),la(2,C2,2,2,"ng-container",3),ya()),2&e){const e=t.$implicit,n=t.index,r=Sa(),i=r.index,s=r.$implicit,o=Sa();Ts(1),ha("ngClass",o.getBlockClasses(n,i)),ra("x",o.STROKE_WIDTH+e)("y",o.STROKE_WIDTH+s)("rx",3*o.STROKE_WIDTH)("ry",3*o.STROKE_WIDTH)("width",o.BLOCK_WIDTH)("height",o.BLOCK_WIDTH),Ts(1),ha("ngForOf",wu(8,v2))}}const E2=function(e){return[0,e]};function w2(e,t){if(1&e&&(_n(),ma(0),la(1,_2,3,9,"ng-container",3),ya()),2&e){const e=Sa();Ts(1),ha("ngForOf",Pu(1,E2,e.BLOCK_SEPARATION))}}function P2(e,t){if(1&e&&(_n(),ga(0,"circle",10)),2&e){const e=Sa();Ia("id","currentDrop_",e.currentDrop.get().x,"_",e.currentDrop.get().y,""),ha("ngClass",e.getPlayerClass(e.rules.node.gameState.getCurrentPlayer())),ra("cx",e.getCenter(e.currentDrop.get().x))("cy",e.getCenter(e.currentDrop.get().y))("r",(e.SPACE_SIZE-e.STROKE_WIDTH)/2)}}function S2(e,t){if(1&e){const e=va();_n(),fa(0,"path",11),Ea("click",function(){const t=Gt(e).$implicit;return Sa().rotate(t)}),pa()}if(2&e){const e=t.$implicit,n=Sa();Ia("id","rotate_",e[1],"_",e[2]?"clockwise":"counterclockwise",""),ra("d",e[0])("stroke-width",2*n.STROKE_WIDTH)}}function b2(e,t){if(1&e&&(_n(),ga(0,"circle",12)),2&e){const e=t.$implicit,n=Sa();Ia("id","victoryCoord_",e.x,"_",e.y,""),ha("ngClass",n.getSquareClasses(e.x,e.y)),ra("cx",n.getCenter(e.x))("cy",n.getCenter(e.y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)("stroke-width",n.STROKE_WIDTH)}}function O2(e,t){if(1&e){const e=va();_n(),fa(0,"g",13),Ea("click",function(){return Gt(e),Sa().skipRotation()}),ga(1,"circle",14),ga(2,"line",15),pa()}if(2&e){const e=Sa();Ts(1),ra("cx",e.BLOCK_SEPARATION)("cy",e.BLOCK_SEPARATION)("r",.75*e.SPACE_SIZE)("stroke-width",2*e.STROKE_WIDTH),Ts(1),ra("x1",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("y1",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("x2",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("y2",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("stroke-width",2*e.STROKE_WIDTH)}}let T2=(()=>{class e extends tY{constructor(e){super(e),this.arrows=[],this.victoryCoords=[],this.rules=new h2(u2),this.availableMinimaxes=[new d2(this.rules,"PentagoMinimax")],this.encoder=l2.encoder,this.tutorial=(new m2).tutorial,this.BLOCK_WIDTH=3*this.SPACE_SIZE+2*this.STROKE_WIDTH,this.BLOCK_SEPARATION=this.BLOCK_WIDTH+2*this.STROKE_WIDTH,this.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*this.SPACE_SIZE,this.ARROWS=this.generateArrowsCoord(),this.updateBoard()}updateBoard(){this.board=this.rules.node.gameState.getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.rules.node.gameState),this.showLastMove()}showLastMove(){const e=this.rules.node.move;if(this.cancelMoveAttempt(),e.isAbsent())this.hidePreviousMove();else{const t=e.get();this.movedBlock=t.blockTurned;const n=new GW(t.coord.x%3-1,t.coord.y%3-1);if(t.blockTurned.isPresent()&&!1===n.equals(new GW(0,0))&&this.coordBelongToBlock(t)){let e;e=t.turnedClockwise?Tw.getNonNullable(u2.ROTATION_MAP.find(e=>e[0].equals(n)))[1]:Tw.getNonNullable(u2.ROTATION_MAP.find(e=>e[1].equals(n)))[0];const r=t.blockTurned.get();e=e.getNext(new UW(r%2==0?1:4,r<2?1:4),1),this.lastDrop=Nw.of(e)}else this.lastDrop=Nw.of(t.coord)}}coordBelongToBlock(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}hidePreviousMove(){this.lastDrop=Nw.empty(),this.movedBlock=Nw.empty(),this.victoryCoords=[]}generateArrowsCoord(){const e=2*this.BLOCK_SEPARATION,t=this.SPACE_SIZE,n=.5*this.SPACE_SIZE;return[["M "+n+" 0 q "+t+" -"+t+" "+2*t+" 0",0,!0],["M 0 "+n+" q -"+t+" "+t+" 0 "+2*t,0,!1],["M "+e+" "+n+" q "+t+" "+t+" 0 "+2*t,1,!0],["M "+(e-n)+" 0 q -"+t+" -"+t+" -"+2*t+" 0",1,!1],["M 0 "+(e-n)+" q -"+t+" -"+t+" 0 -"+2*t,2,!0],["M "+n+" "+e+" q "+t+" "+t+" "+2*t+" 0",2,!1],["M "+(e-n)+" "+e+" q -"+t+" "+t+" -"+2*t+" 0",3,!0],["M "+e+" "+(e-n)+"  q "+t+" -"+t+" 0 -"+2*t,3,!1]]}cancelMoveAttempt(){this.arrows=[],this.currentDrop=Nw.empty(),this.canSkipRotation=!1}onClick(e,t){var n=this;return Ow(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());if(n.board[t][e].isPlayer())return n.cancelMove(JW.MUST_LAND_ON_EMPTY_SPACE());const i=l2.rotationless(e,t),s=n.rules.node.gameState,o=s.applyLegalDrop(i);if(4===o.neutralBlocks.length)return n.chooseMove(i,s);const a=n.rules.getGameStatus(n.rules.node);return n.canSkipRotation=o.neutralBlocks.length>0&&!1===a.isEndGame,n.currentDrop=Nw.of(new GW(e,t)),n.displayArrows(o.neutralBlocks),Lw.SUCCESS})()}getCenter(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}displayArrows(e){this.arrows=[];for(let t=0;t<4;t++)if(!1===e.includes(t)){const e=this.ARROWS.filter(e=>e[1]===t);this.arrows=this.arrows.concat(e)}}getBlockClasses(e,t){return this.movedBlock.equalsValue(e+2*t)?["moved"]:[]}getSquareClasses(e,t){const n=[],r=this.getPlayerClass(this.board[t][e]);return n.push(r),this.lastDrop.equalsValue(new GW(e,t))&&n.push("last-move"),n}rotate(e){var t=this;return Ow(function*(){const n=t.canUserPlay("#rotate_"+e[1]+"_"+(e[2]?"clockwise":"counterclockwise"));if(n.isFailure())return t.cancelMove(n.getReason());const r=t.currentDrop.get(),i=l2.withRotation(r.x,r.y,e[1],e[2]);return t.chooseMove(i,t.rules.node.gameState)})()}skipRotation(){var e=this;return Ow(function*(){const t=e.canUserPlay("#skipRotation");if(t.isFailure())return e.cancelMove(t.getReason());const n=e.currentDrop.get(),r=l2.rotationless(n.x,n.y);return e.chooseMove(r,e.rules.node.gameState)})()}}return e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-pentago"]],features:[Go],decls:9,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-60 -60 780 780"],["id","arrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#arrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#arrowhead)",1,"no-fill",3,"id","click"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),fa(1,"defs"),fa(2,"marker",1),ga(3,"polygon",2),pa(),pa(),la(4,w2,2,3,"ng-container",3),la(5,P2,1,6,"circle",4),la(6,S2,1,4,"path",5),la(7,b2,1,7,"circle",6),la(8,O2,3,9,"g",7),pa()),2&e&&(Ts(4),ha("ngForOf",Pu(5,E2,t.BLOCK_SEPARATION)),Ts(1),ha("ngIf",t.currentDrop.isPresent()),Ts(1),ha("ngForOf",t.arrows),Ts(1),ha("ngForOf",t.victoryCoords),Ts(1),ha("ngIf",t.canSkipRotation))},directives:[tf,rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class I2 extends GW{constructor(e,t,n){if(super(e,t),this.z=n,e<0||e>3)throw new Error(`PylosCoord: Invalid X: ${e}.`);if(t<0||t>3)throw new Error(`PylosCoord: Invalid Y: ${t}.`);if(n<0||n>3)throw new Error(`PylosCoord: Invalid Z: ${n}.`);const r=4-n;if(this.isNotInRange(r,r))throw new Error(this.toString()+" is not in range.")}static encodeOptional(e){let t;return t=e.isPresent()?I2.encode(e.get())+1:0,t}static encode(e){return 16*e.x+4*e.y+e.z}static decodeToOptional(e){return 0===e?Nw.empty():Nw.of(I2.decode(e-1))}static decode(e){const t=e%4;e-=t;const n=(e/=4)%4;return e-=n,new I2(e/=4,n,t)}toString(){return"PylosCoord"+this.toShortString()}toShortString(){return"("+this.x+", "+this.y+", "+this.z+")"}equals(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}isUpperThan(e){return this.z>e.z}getLowerPieces(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");const e=this.z-1;return[new I2(this.x,this.y,e),new I2(this.x+1,this.y,e),new I2(this.x,this.y+1,e),new I2(this.x+1,this.y+1,e)]}getHigherCoords(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");const e=this.z+1,t=new GW(this.x-1,this.y-1),n=new GW(this.x,this.y-1),r=new GW(this.x-1,this.y),i=new GW(this.x,this.y),s=4-e;return[t,n,r,i].filter(e=>e.isInRange(s,s)).map(t=>new I2(t.x,t.y,e))}getNextValid(e){const t=new GW(this.x,this.y).getNext(e),n=4-this.z;return t.isNotInRange(n,n)?Nw.empty():Nw.of(new I2(t.x,t.y,this.z))}}class k2 extends aj{constructor(e,t,n,r){super(),this.startingCoord=e,this.landingCoord=t,this.firstCapture=n,this.secondCapture=r}static fromClimb(e,t,n){const r=Nw.of(e),i=k2.checkCaptures(n),s=new k2(r,t,i.firstCapture,i.secondCapture);if(!t.isUpperThan(e))throw new Error("PylosMove: When piece move it must move upward.");return s}static checkCaptures(e){let t=Nw.empty(),n=Nw.empty();if(e.length>0&&(t=Nw.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=Nw.of(e[1]),e[1].isUpperThan(e[0])&&(t=Nw.of(e[1]),n=Nw.of(e[0])),e.length>2)throw new Error("PylosMove: can't capture that much piece.")}return{firstCapture:t,secondCapture:n}}static fromDrop(e,t){const n=Nw.empty(),r=k2.checkCaptures(t);return new k2(n,e,r.firstCapture,r.secondCapture)}static changeCapture(e,t){const n=k2.checkCaptures(t);return new k2(e.startingCoord,e.landingCoord,n.firstCapture,n.secondCapture)}isClimb(){return this.startingCoord.isPresent()}toString(){const e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}equals(e){return e===this||!!(this.startingCoord.equals(e.startingCoord)&&this.landingCoord.equals(e.landingCoord)&&this.firstCapture.equals(e.firstCapture)&&this.secondCapture.equals(e.secondCapture))}}k2.encoder=new class extends bZ{maxValue(){return 17575999}encodeNumber(e){const t=I2.encode(e.landingCoord),n=I2.encodeOptional(e.startingCoord),r=I2.encodeOptional(e.firstCapture);return 270400*I2.encodeOptional(e.secondCapture)+4160*r+64*n+t}decodeNumber(e){const t=I2.decode(e%64);e-=e%64;const n=I2.decodeToOptional((e/=64)%65);e-=e%65;const r=I2.decodeToOptional((e/=65)%65);e-=e%65;const i=I2.decodeToOptional(e/=65);return new k2(n,t,r,i)}};class A2 extends ij{constructor(e,t){super(t),this.boards=e}static getInitialState(){const e=NZ.createTable(4,4,IZ.NONE),t=NZ.createTable(3,3,IZ.NONE),n=NZ.createTable(2,2,IZ.NONE);return new A2([e,t,n,[[IZ.NONE]]],0)}static getLevelRange(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return Tw.expectToBe(e,2),[0,1]}}getPieceAt(e){return this.boards[e.z][e.y][e.x]}applyLegalMove(e,t=!0){const n=[];let r;return n.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&n.push({coord:e.startingCoord.get(),value:IZ.NONE}),e.firstCapture.isPresent()&&n.push({coord:e.firstCapture.get(),value:IZ.NONE}),e.secondCapture.isPresent()&&n.push({coord:e.secondCapture.get(),value:IZ.NONE}),r=t?this.turn+1:this.turn,this.setBoardAts(n,r)}setBoardAts(e,t){const n=[NZ.copyBiArray(this.boards[0]),NZ.copyBiArray(this.boards[1]),NZ.copyBiArray(this.boards[2]),NZ.copyBiArray(this.boards[3])];for(const r of e){const e=r.coord;n[e.z][e.y][e.x]=r.value}return new A2(n,t)}isLandable(e){if(this.getPieceAt(e).isPlayer())return!1;if(0===e.z)return!0;const t=e.getLowerPieces();for(const n of t)if(this.getPieceAt(n)===IZ.NONE)return!1;return!0}isSupporting(e){if(3===e.z)return!1;const t=e.getHigherCoords();for(const n of t)if(this.getPieceAt(n).isPlayer())return!0;return!1}getPiecesRepartition(){const e={};e[IZ.NONE.value]=0,e[TZ.ZERO.value]=0,e[TZ.ONE.value]=0;for(let t=0;t<3;t++)for(let n=0;n<4-t;n++)for(let r=0;r<4-t;r++){const i=new I2(r,n,t),s=this.getPieceAt(i);e[s.value]=1+e[s.value]}return e}removeCoord(e){return this.setBoardAts([{coord:e,value:IZ.NONE}],this.turn)}applyDrop(e){const t={coord:e,value:this.getCurrentPlayer()};return this.setBoardAts([t],this.turn)}getFreeToMoves(){const e=[],t=this.getCurrentPlayer();for(let n=0;n<=2;n++){const r=A2.getLevelRange(n);for(const i of r)for(const s of r){const r=new I2(s,i,n);this.getPieceAt(r).equals(t)&&!1===this.isSupporting(r)&&e.push(r)}}return e}}let M2=(()=>{class e{}return e.MUST_MOVE_UPWARD=()=>$localize`You must move your pieces upward.`,e.SHOULD_HAVE_SUPPORTING_PIECES=()=>$localize`Your piece must land on the board or on 4 other pieces.`,e.CANNOT_MOVE_SUPPORTING_PIECE=()=>$localize`You cannot move a supporting piece.`,e.CANNOT_CAPTURE=()=>$localize`You cannot capture.`,e.INVALID_FIRST_CAPTURE=()=>$localize`Your first capture is invalid.`,e.INVALID_SECOND_CAPTURE=()=>$localize`Your second capture is invalid.`,e})();class N2 extends mj{static getStateInfo(e){const t=[],n=[];for(let r=0;r<3;r++)for(let i=0;i<4-r;i++)for(let s=0;s<4-r;s++){const o=new I2(s,i,r);e.getPieceAt(o)===e.getCurrentPlayer()&&!1===e.isSupporting(o)&&t.push(o),e.isLandable(o)&&n.push(o)}return{freeToMove:t,landable:n}}static getClimbingMoves(e){const t=[];for(const n of e.freeToMove)for(const r of e.landable)if(r.isUpperThan(n)&&!1===r.getLowerPieces().some(e=>n.equals(e))){const e=k2.fromClimb(n,r,[]);t.push(e)}return t}static getDropMoves(e){const t=[];for(const n of e.landable){const e=k2.fromDrop(n,[]);t.push(e)}return t}static canCapture(e,t){const n=e.getCurrentPlayer();for(const r of[zW.UP,zW.DOWN]){const i=t.getNextValid(r);if(i.isPresent()&&e.getPieceAt(i.get())===n)for(const t of[zW.LEFT,zW.RIGHT]){const s=i.get().getNextValid(t);if(s.isPresent()&&e.getPieceAt(s.get())===n){const t=r.getOpposite(),i=s.get().getNextValid(t).get();if(e.getPieceAt(i)===n)return!0}}}return!1}static getPossibleCaptures(e){const t=new rj,n=e.getFreeToMoves();for(const r of n){t.add(new rj([r]));const n=e.removeCoord(r).getFreeToMoves();for(const e of n){const n=new rj([r,e]);t.add(n)}}return t}static applyLegalMove(e,t,n){return t.applyLegalMove(e)}static isValidCapture(e,t,n){const r=e.getCurrentPlayer();return!(!n.equals(t.landingCoord)&&e.getPieceAt(n)!==r)&&0===n.getHigherCoords().filter(n=>e.getPieceAt(n).isPlayer()&&!1===n.equals(t.firstCapture.get())).length}static getGameStatus(e){const t=e.gameState.getPiecesRepartition();return 15===t[TZ.ZERO.value]?gj.ONE_WON:15===t[TZ.ONE.value]?gj.ZERO_WON:gj.ONGOING}applyLegalMove(e,t,n){return N2.applyLegalMove(e,t,n)}isLegal(e,t){const n=this.isLegalStartingCoord(e,t);if(n.isFailure())return Rw.failure(n.getReason());const r=n.get(),i=this.isLegalLandingCoord(e,r);if(i.isFailure())return Rw.failure(i.getReason());const s=i.get(),o=this.isLegalCaptures(e,s);return o.isFailure()?o:Rw.success(void 0)}isLegalStartingCoord(e,t){const n=t.getCurrentOpponent();if(e.startingCoord.isPresent()){const r=e.startingCoord.get(),i=t.getPieceAt(r);if(i===n)return Rw.failure(JW.CANNOT_CHOOSE_OPPONENT_PIECE());if(i===IZ.NONE)return Rw.failure(JW.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===r.getHigherCoords().filter(e=>t.getPieceAt(e).isPlayer()).length){const n=t.removeCoord(e.startingCoord.get());return Rw.success(n)}return Rw.failure(M2.CANNOT_MOVE_SUPPORTING_PIECE())}return Rw.success(t)}isLegalLandingCoord(e,t){return t.getPieceAt(e.landingCoord).isPlayer()?Rw.failure(JW.MUST_LAND_ON_EMPTY_SPACE()):t.isLandable(e.landingCoord)?Rw.success(t.applyDrop(e.landingCoord)):Rw.failure(M2.SHOULD_HAVE_SUPPORTING_PIECES())}isLegalCaptures(e,t){if(e.firstCapture.isAbsent())return Rw.success(void 0);if(!1===N2.canCapture(t,e.landingCoord))return Rw.failure(M2.CANNOT_CAPTURE());if(N2.isValidCapture(t,e,e.firstCapture.get())){const n=t.removeCoord(e.firstCapture.get());return e.secondCapture.isAbsent()||N2.isValidCapture(n,e,e.secondCapture.get())?Rw.success(void 0):Rw.failure(M2.INVALID_SECOND_CAPTURE())}return Rw.failure(M2.INVALID_FIRST_CAPTURE())}getGameStatus(e){return N2.getGameStatus(e)}}class R2 extends ej{static getListMoves(e){const t=e.gameState,n=[],r=N2.getStateInfo(t),i=N2.getClimbingMoves(r),s=N2.getDropMoves(r),o=i.concat(s);for(const a of o){const e=t.applyLegalMove(a,!1);let r=new rj;N2.canCapture(e,a.landingCoord)?r=N2.getPossibleCaptures(e):n.push(a);for(const t of r){const e=k2.changeCapture(a,t.toList());n.push(e)}}return n}getListMoves(e){return R2.getListMoves(e)}getBoardValue(e){const t=N2.getGameStatus(e);if(t.isEndGame)return new tj(t.toBoardValue());{const t=e.gameState.getPiecesRepartition();return new tj(t[TZ.ZERO.value]-t[TZ.ONE.value])}}}class x2 extends R2{static countStoneUsed(e){let t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}static sumMoveEmplacementByValue(e){let t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}getListMoves(e){const t=R2.getListMoves(e);return this.orderMoves(t)}orderMoves(e){return e.sort((e,t)=>{const n=12*x2.countStoneUsed(e),r=12*x2.countStoneUsed(t);return n+x2.sumMoveEmplacementByValue(e)-(r+x2.sumMoveEmplacementByValue(t))})}}const D2=IZ.NONE,L2=IZ.ZERO,F2=IZ.ONE;class U2{constructor(){this.tutorial=[_j.informational($localize`Goal of the game`,$localize`At Pylos, the goal is to be the last to play.
        To do this, you have to save up your pieces.
        As soon as a player puts its last piece, that player loses the game immediately.
        Here is what the initial board looks like, it is a board of 4 x 4 squares.
        This board will become a pyramid, little by little.
        It will be filled by the pieces of your stock. Each player has 15 pieces.`,A2.getInitialState()),_j.anyMove($localize`Dropping a piece`,$localize`When it is your turn, you can always drop one of your piece on an empty square.
        The gray squares are where you can drop your pieces.<br/><br/>
        Click on one of the squares to drop a piece there.`,A2.getInitialState(),k2.fromDrop(new I2(1,1,0),[]),$localize`There you go, as simple as that.`),_j.fromMove($localize`Climbing`,$localize`When 4 pieces form a square, it is possible to put a fifth piece on top.
        However, when that happens, you can save a piece by climbing instead of dropping a piece.
        To climb:
        <ol>
            <li>Click on one of your free pieces, which should be lower than the landing square.</li>
            <li>Click on an empty landing square, higher than your selected piece.</li>
        </ol><br/>
        Go ahead, climb!`,new A2([[[L2,F2,D2,D2],[F2,L2,D2,D2],[D2,D2,D2,D2],[D2,D2,D2,L2]],[[D2,D2,D2],[D2,D2,D2],[D2,D2,D2]],[[D2,D2],[D2,D2]],[[D2]]],0),[k2.fromClimb(new I2(3,3,0),new I2(0,0,1),[])],$localize`Congratulations!<br/>
        Some important notes:
        <ol>
            <li>You cannot move a piece that is directly below another one.</li>
            <li>Of course, you cannot move the opponent's pieces.</li>
            <li>You can only climb when the landing square is higher than the starting square.</li>
        </ol>`,$localize`Failed!`),_j.fromMove($localize`Square (1/2)`,$localize`When the piece you just moved or dropped is the fourth one of a square of your color,
        you can choose anywhere on the board one or two of your pieces.
        These pieces will be removed from the board, allowing you to save up one or two pieces.
        A chosen piece must not be directly below another piece.
        A chosen piece can be the piece you just placed.
        You're playing Dark.<br/><br/>
        Form a square, then click twice on one of the four pieces to remove only that one.`,new A2([[[L2,L2,D2,D2],[D2,L2,D2,D2],[D2,D2,D2,D2],[D2,D2,D2,D2]],[[D2,D2,D2],[D2,D2,D2],[D2,D2,D2]],[[D2,D2],[D2,D2]],[[D2]]],0),[k2.fromDrop(new I2(0,1,0),[new I2(0,0,0)]),k2.fromDrop(new I2(0,1,0),[new I2(0,1,0)]),k2.fromDrop(new I2(0,1,0),[new I2(1,0,0)]),k2.fromDrop(new I2(0,1,0),[new I2(1,1,0)])],$localize`Congratulations, you have saved up one piece.`,$localize`Failed!`),_j.fromPredicate($localize`Square (2/2)`,$localize`You're playing Dark.<br/><br/>
        Do like in the previous step, but this time click on two different pieces.`,new A2([[[L2,L2,D2,D2],[D2,L2,D2,D2],[D2,D2,D2,D2],[D2,D2,D2,D2]],[[D2,D2,D2],[D2,D2,D2],[D2,D2,D2]],[[D2,D2],[D2,D2]],[[D2]]],0),k2.fromDrop(new I2(0,1,0),[new I2(0,0,0),new I2(1,0,0)]),(e,t,n)=>e.secondCapture.isPresent()?Lw.SUCCESS:e.firstCapture.isPresent()?Lw.failure($localize`Failed, you only captured one piece.`):Lw.failure(a0.YOU_DID_NOT_CAPTURE_ANY_PIECE()),$localize`Congratulations, you have saved up two pieces.`)]}}function V2(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"circle",4),pa()),2&e){const e=t.$implicit,n=Sa().$implicit,r=Sa();Ts(1),Ia("id","piece_",n,"_",e,""),ha("ngClass",r.getPlayerPieceClass(n)),ra("cx",.5*r.SPACE_SIZE+(800-r.SPACE_SIZE)/14*e)("cy",860+(r.SPACE_SIZE+10)*n)("r",r.SPACE_SIZE/2-r.STROKE_WIDTH)}}function B2(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,V2,2,6,"g",1),pa()),2&e){const e=t.$implicit,n=Sa();Ts(1),ha("ngForOf",n.getPlayerSidePieces(e))}}function $2(e,t){if(1&e){const e=va();_n(),fa(0,"circle",8),Ea("click",function(){Gt(e);const t=Sa(2).$implicit,n=Sa().$implicit,r=Sa().$implicit;return Sa().onPieceClick(t,n,r)}),pa()}if(2&e){const e=Sa(2).$implicit,t=Sa().$implicit,n=Sa().$implicit,r=Sa();ka("id","piece_",e,"_",t,"_",n,""),ha("ngClass",r.getPieceClasses(e,t,n)),ra("r",r.getPieceRadius(n)-r.STROKE_WIDTH)("cx",r.getPieceCx(e,t,n))("cy",r.getPieceCy(e,t,n))}}function z2(e,t){if(1&e){const e=va();_n(),fa(0,"rect",8),Ea("click",function(){Gt(e);const t=Sa(2).$implicit,n=Sa().$implicit,r=Sa().$implicit;return Sa().onDrop(t,n,r)}),pa()}if(2&e){const e=Sa(2).$implicit,t=Sa().$implicit,n=Sa().$implicit,r=Sa();ka("id","drop_",e,"_",t,"_",n,""),ha("ngClass",r.getSquareClasses(e,t,n)),ra("width",2*r.getPieceRadius(n))("height",2*r.getPieceRadius(n))("x",r.getPieceCx(e,t,n)-r.getPieceRadius(n))("y",r.getPieceCy(e,t,n)-r.getPieceRadius(n))}}function H2(e,t){if(1&e&&(_n(),ma(0),la(1,$2,1,7,"circle",6),la(2,z2,1,8,"ng-template",null,7,Ku),ya()),2&e){const e=ca(3),t=Sa().$implicit,n=Sa().$implicit,r=Sa().$implicit,i=Sa();Ts(1),ha("ngIf",i.isOccupied(t,n,r))("ngIfElse",e)}}function G2(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,H2,4,2,"ng-container",5),pa()),2&e){const e=t.$implicit,n=Sa().$implicit,r=Sa().$implicit,i=Sa();Ts(1),ha("ngIf",i.mustDraw(e,n,r))}}function Z2(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,G2,2,1,"g",1),pa()),2&e){const e=Sa().$implicit,t=Sa();Ts(1),ha("ngForOf",t.getLevelRange(e))}}function q2(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,Z2,2,1,"g",1),pa()),2&e){const e=t.$implicit,n=Sa();Ts(1),ha("ngForOf",n.getLevelRange(e))}}function W2(e,t){if(1&e&&(_n(),ga(0,"rect",9)),2&e){const e=Sa();ka("id","highCapture_",e.highCapture.get().x,"_",e.highCapture.get().y,"_",e.highCapture.get().z,""),ra("width",2*e.getPieceRadius(e.highCapture.get().z))("height",2*e.getPieceRadius(e.highCapture.get().z))("x",e.getPieceCx(e.highCapture.get().x,e.highCapture.get().y,e.highCapture.get().z)-e.getPieceRadius(e.highCapture.get().z))("y",e.getPieceCy(e.highCapture.get().x,e.highCapture.get().y,e.highCapture.get().z)-e.getPieceRadius(e.highCapture.get().z))}}const j2=function(){return[0,1]},Y2=function(){return[0,1,2]};let K2=(()=>{class e extends ZW{constructor(e){super(e),this.lastLandingCoord=Nw.empty(),this.lastStartingCoord=Nw.empty(),this.lastFirstCapture=Nw.empty(),this.lastSecondCapture=Nw.empty(),this.highCapture=Nw.empty(),this.chosenStartingCoord=Nw.empty(),this.chosenLandingCoord=Nw.empty(),this.chosenFirstCapture=Nw.empty(),this.lastMove=Nw.empty(),this.remainingPieces={0:15,1:15},this.rules=new N2(A2),this.availableMinimaxes=[new R2(this.rules,"PylosMinimax"),new x2(this.rules,"PylosOrderedMinimax")],this.encoder=k2.encoder,this.tutorial=(new U2).tutorial,this.SPACE_SIZE=this.getPieceRadius(0),this.updateBoard()}getLevelRange(e){return A2.getLevelRange(e)}mustDraw(e,t,n){const r=new I2(e,t,n);return!!(this.constructedState.getPieceAt(r).isPlayer()||this.justClimbed(r)||this.isCaptured(r))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(r)}isCaptured(e){return this.chosenFirstCapture.equalsValue(e)}onPieceClick(e,t,n){var r=this;return Ow(function*(){const i=r.canUserPlay("#piece_"+e+"_"+t+"_"+n);if(i.isFailure())return r.cancelMove(i.getReason());const s=new I2(e,t,n);return r.state.getPieceAt(s)===r.state.getCurrentOpponent()?r.cancelMove(JW.CANNOT_CHOOSE_OPPONENT_PIECE()):r.isSupporting(s)?r.cancelMove(M2.CANNOT_MOVE_SUPPORTING_PIECE()):r.chosenLandingCoord.isAbsent()?r.onClimbClick(s):r.onCaptureClick(s)})()}isSupporting(e){return this.constructedState.isSupporting(e)}onClimbClick(e){var t=this;return Ow(function*(){return t.chosenStartingCoord=Nw.of(e),t.constructedState=t.constructedState.removeCoord(e),Lw.SUCCESS})()}onCaptureClick(e){var t=this;return Ow(function*(){return t.chosenFirstCapture.isAbsent()?(t.chosenFirstCapture=Nw.of(e),t.constructedState=t.constructedState.removeCoord(e),Lw.SUCCESS):t.chosenFirstCapture.equalsValue(e)?t.concludeMoveWithCapture([t.chosenFirstCapture.get()]):t.concludeMoveWithCapture([t.chosenFirstCapture.get(),e])})()}concludeMoveWithCapture(e){var t=this;return Ow(function*(){let n;return n=t.chosenStartingCoord.isAbsent()?k2.fromDrop(t.chosenLandingCoord.get(),e):k2.fromClimb(t.chosenStartingCoord.get(),t.chosenLandingCoord.get(),e),t.tryMove(n,t.state)})()}tryMove(e,t){var n=this;return Ow(function*(){return n.cancelMove(),n.chooseMove(e,t)})()}cancelMoveAttempt(){this.constructedState=this.state,this.chosenStartingCoord=Nw.empty(),this.chosenLandingCoord=Nw.empty(),this.chosenFirstCapture=Nw.empty()}onDrop(e,t,n){var r=this;return Ow(function*(){const i=r.canUserPlay("#drop_"+e+"_"+t+"_"+n);if(i.isFailure())return r.cancelMove(i.getReason());const s=new I2(e,t,n);return N2.canCapture(r.constructedState,s)?(r.chosenLandingCoord=Nw.of(s),r.constructedState=r.constructedState.applyDrop(s),Lw.SUCCESS):r.isCapturelessMoveFinished(s)?(r.chosenLandingCoord=Nw.of(s),r.concludeMoveWithCapture([])):r.cancelMove(M2.MUST_MOVE_UPWARD())})()}isCapturelessMoveFinished(e){return!!this.chosenStartingCoord.isAbsent()||e.isUpperThan(this.chosenStartingCoord.get())}getSquareClasses(e,t,n){const r=new I2(e,t,n);if(this.lastMove.isPresent()){const e=this.lastMove.get();if(e.firstCapture.equalsValue(r)||e.secondCapture.equalsValue(r))return["captured"];if(r.equals(e.landingCoord)||e.startingCoord.equalsValue(r))return["moved"]}else if(this.justClimbed(r))return["moved"];return[]}justClimbed(e){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(e)}getPieceRadius(e){return 90+5*e}getPieceCx(e,t,n){return 100+100*n+200*e}getPieceCy(e,t,n){return 100+100*n+200*t}isOccupied(e,t,n){const r=new I2(e,t,n);if(this.justClimbed(r))return!1;const i=this.rules.node.gameState.getPieceAt(r).isPlayer(),s=this.chosenLandingCoord.equalsValue(r);return i||s}getPieceClasses(e,t,n){const r=new I2(e,t,n),i=[this.getPieceFillClass(r)];return(this.lastLandingCoord.equalsValue(r)||this.lastStartingCoord.equalsValue(r))&&i.push("highlighted"),(this.chosenStartingCoord.equalsValue(r)||this.chosenLandingCoord.equalsValue(r))&&i.push("selected"),this.chosenFirstCapture.equalsValue(r)&&i.push("pre-captured"),i}getPieceFillClass(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerPieceClass(this.state.getPieceAt(e).value)}getPlayerPieceClass(e){return this.getPlayerClass(TZ.of(e))}getPlayerSidePieces(e){const t=this.remainingPieces[e],n=[];for(let r=0;r<t;r++)n.push(r);return n}updateBoard(){this.state=this.rules.node.gameState,this.constructedState=this.state,this.lastMove=this.rules.node.move;const e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=Nw.empty(),this.cancelMoveAttempt(),this.lastMove.isPresent()?this.showLastMove():this.hideLastMove()}showLastMove(){const e=this.lastMove.get();this.lastLandingCoord=Nw.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.mustDrawCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}hideLastMove(){this.lastStartingCoord=Nw.empty(),this.lastLandingCoord=Nw.empty(),this.lastFirstCapture=Nw.empty(),this.lastSecondCapture=Nw.empty()}mustDrawCoord(e){return this.mustDraw(e.x,e.y,e.z)}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-pylos"]],features:[Go],decls:5,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 1021","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["x","0","y","0","width","800","height","800",1,"base"],["class","base captured",3,"id",4,"ngIf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base",3,"id","ngClass","click"],[1,"base","captured",3,"id"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,B2,2,1,"g",1),ga(2,"rect",2),la(3,q2,2,1,"g",1),la(4,W2,1,7,"rect",3),pa()),2&e&&(Ts(1),ha("ngForOf",wu(3,j2)),Ts(2),ha("ngForOf",wu(4,Y2)),Ts(1),ha("ngIf",t.highCapture.isPresent()))},directives:[tf,rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class Q2{constructor(e){this.value=e}static fromInt(e){if(0<=e&&e<=15)return Q2.pieces[e];if(16===e)return Q2.EMPTY;throw new Error("Invalid piece ("+e+")")}equals(e){return this===e}toString(){return"QuartoPiece("+this.value+")"}isRectangle(){return this.value%4<2}}Q2.AAAA=new Q2(0),Q2.AAAB=new Q2(1),Q2.AABA=new Q2(2),Q2.AABB=new Q2(3),Q2.ABAA=new Q2(4),Q2.ABAB=new Q2(5),Q2.ABBA=new Q2(6),Q2.ABBB=new Q2(7),Q2.BAAA=new Q2(8),Q2.BAAB=new Q2(9),Q2.BABA=new Q2(10),Q2.BABB=new Q2(11),Q2.BBAA=new Q2(12),Q2.BBAB=new Q2(13),Q2.BBBA=new Q2(14),Q2.BBBB=new Q2(15),Q2.EMPTY=new Q2(16),Q2.pieces=[Q2.AAAA,Q2.AAAB,Q2.AABA,Q2.AABB,Q2.ABAA,Q2.ABAB,Q2.ABBA,Q2.ABBB,Q2.BAAA,Q2.BAAB,Q2.BABA,Q2.BABB,Q2.BBAA,Q2.BBAB,Q2.BBBA,Q2.BBBB];class X2 extends lj{constructor(e,t,n){super(e,t),this.piece=n}toString(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}equals(e){return this===e||!!e.coord.equals(this.coord)&&this.piece===e.piece}}X2.encoder=new class extends bZ{maxValue(){return 496}encodeNumber(e){return 128*e.coord.x+32*e.coord.y+e.piece.value}decodeNumber(e){const t=e%32;e-=t;const n=(e/=32)%4;return e-=n,new X2(e/=4,n,Q2.fromInt(t))}};class J2 extends sj{constructor(e,t,n){super(e,t),this.pieceInHand=n}static getInitialState(){const e=NZ.createTable(4,4,Q2.EMPTY);return new J2(e,0,Q2.AAAA)}static isGivable(e,t,n){return e!==n&&!1===J2.isAlreadyOnBoard(e,t)}static isAlreadyOnBoard(e,t){for(let n=0;n<4;n++)for(let r=0;r<4;r++)if(t[n][r]===e)return!0;return!1}getRemainingPieces(){const e=Q2.pieces,t=[];for(const n of e)J2.isGivable(n,this.board,this.pieceInHand)&&t.push(n);return t}}let e3=(()=>{class e{}return e.MUST_GIVE_A_PIECE=()=>$localize`You must give a piece.`,e.PIECE_ALREADY_ON_BOARD=()=>$localize`That piece is already on the board.`,e.CANNOT_GIVE_PIECE_IN_HAND=()=>$localize`You cannot give the piece that was in your hands.`,e})();class t3{constructor(e){this.subCriterion=[Nw.empty(),Nw.empty(),Nw.empty(),Nw.empty()],this.subCriterion[0]=Nw.of(8==(8&e.value)),this.subCriterion[1]=Nw.of(4==(4&e.value)),this.subCriterion[2]=Nw.of(2==(2&e.value)),this.subCriterion[3]=Nw.of(1==(1&e.value))}mergeWith(e){let t=4;for(let n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=Nw.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}mergeWithQuartoPiece(e){const t=new t3(e);return this.mergeWith(t)}areAllAbsent(){for(let e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}match(e){for(let t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}matchPiece(e){return this.match(new t3(e))}toString(){return"Criterion{"+this.subCriterion.map(e=>e.isPresent()?e.get()?"1":"0":"x").join(" ")+"}"}}class n3{constructor(e,t){this.initialCoord=e,this.direction=t}allCoords(){const e=[];for(let t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}class r3 extends mj{static isOccupied(e){return e!==Q2.EMPTY}static isLegal(e,t){const n=e.coord.x,r=e.coord.y,i=e.piece,s=t.getCopiedBoard(),o=t.pieceInHand;return r3.isOccupied(s[r][n])?Lw.failure(JW.MUST_LAND_ON_EMPTY_SPACE()):i===Q2.EMPTY?15===t.turn?Lw.SUCCESS:Lw.failure(e3.MUST_GIVE_A_PIECE()):J2.isAlreadyOnBoard(i,s)?Lw.failure(e3.PIECE_ALREADY_ON_BOARD()):o===i?Lw.failure(e3.CANNOT_GIVE_PIECE_IN_HAND()):Lw.SUCCESS}isLegal(e,t){return r3.isLegal(e,t).toFallible(void 0)}applyLegalMove(e,t){const n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.pieceInHand,new J2(n,t.turn+1,e.piece)}static updateBoardStatus(e,t,n){return n.score===uj.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:uj.VICTORY,sensitiveSquares:new TY}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}static isThereAVictoriousLine(e,t){let n=e.initialCoord,r=t.getPieceAt(n);const i=new t3(r);for(let s=0;s<3&&!1!==r3.isOccupied(r)&&!i.areAllAbsent();s++)n=n.getNext(e.direction,1),r=t.getPieceAt(n),i.mergeWithQuartoPiece(r);return!(!r3.isOccupied(r)||i.areAllAbsent())}static searchForVictoryOrPreVictoryInLine(e,t,n){const r=r3.getLineInfos(e,t,n);if(r.boardStatus.isPresent())return r.boardStatus.get();const i=r.commonCriterion,s=r.sensitiveCoord;if(i.isPresent()&&!1===i.get().areAllAbsent()){if(s.isAbsent())return{score:uj.VICTORY,sensitiveSquares:new TY};{i.get().matchPiece(t.pieceInHand)&&(n.score=uj.PRE_VICTORY);const e=s.get();n.sensitiveSquares.add(e)}}return n}static getLineInfos(e,t,n){let r=Nw.empty(),i=Nw.empty(),s=e.initialCoord;for(let o=0;o<4;o++){const o=t.getPieceAt(s);if(o===Q2.EMPTY){if(!r.isAbsent())return{sensitiveCoord:Nw.of(s),commonCriterion:i,boardStatus:Nw.of(n)};r=Nw.of(s)}else i.isAbsent()?(i=Nw.of(new t3(o)),Iw(r3.VERBOSE,"set commonCrit to "+i.toString())):(i.get().mergeWithQuartoPiece(o),Iw(r3.VERBOSE,"update commonCrit: "+i.toString()));s=s.getNext(e.direction,1)}return{commonCriterion:i,sensitiveCoord:r,boardStatus:Nw.empty()}}static scoreToGameStatus(e,t){const n=TZ.of(t%2);return e===uj.VICTORY?gj.getDefeat(n):16===t?gj.DRAW:gj.ONGOING}getGameStatus(e){const t=e.gameState;let n={score:uj.DEFAULT,sensitiveSquares:new TY};for(const r of r3.lines)if(n=r3.updateBoardStatus(r,t,n),n.score===uj.VICTORY)return r3.scoreToGameStatus(n.score,t.turn);return r3.scoreToGameStatus(n.score,t.turn)}getVictoriousCoords(e){for(const t of r3.lines)if(r3.isThereAVictoriousLine(t,e))return t.allCoords();return[]}}r3.VERBOSE=!1,r3.lines=[new n3(new GW(0,0),$W.DOWN),new n3(new GW(1,0),$W.DOWN),new n3(new GW(2,0),$W.DOWN),new n3(new GW(3,0),$W.DOWN),new n3(new GW(0,0),$W.RIGHT),new n3(new GW(0,1),$W.RIGHT),new n3(new GW(0,2),$W.RIGHT),new n3(new GW(0,3),$W.RIGHT),new n3(new GW(0,0),$W.DOWN_RIGHT),new n3(new GW(0,3),$W.UP_RIGHT)];class i3 extends ej{static scoreToBoardValue(e,t){if(e===uj.DEFAULT)return new tj(0);{const n=TZ.of(t%2);return new tj(e===uj.PRE_VICTORY?n.getPreVictory():n.getDefeatValue())}}getListMoves(e){const t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getRemainingPieces(),s=n.pieceInHand;let o;for(let a=0;a<4;a++)for(let e=0;e<4;e++)if(r[a][e]===Q2.EMPTY){if(o=n.getCopiedBoard(),o[a][e]=s,15===n.turn){const n=new X2(e,a,Q2.EMPTY);return t.push(n),t}for(const n of i){const r=new X2(e,a,n);t.push(r)}}return t}getBoardValue(e){const t=e.gameState;let n={score:uj.DEFAULT,sensitiveSquares:new TY};for(const r of r3.lines)if(n=r3.updateBoardStatus(r,t,n),n.score===uj.VICTORY)break;return i3.scoreToBoardValue(n.score,t.turn)}}const s3=Q2.AABA,o3=Q2.AABB,a3=Q2.ABAA,l3=Q2.ABAB,c3=Q2.ABBA,u3=Q2.BAAA,h3=Q2.BAAB,d3=Q2.BABB,f3=Q2.BBAA,p3=Q2.BBAB,g3=Q2.BBBA,m3=Q2.BBBB,y3=Q2.EMPTY;class v3{constructor(){this.tutorial=[_j.informational($localize`Goal of the game`,$localize`Quarto is an alignment game.
        The goal is to align four pieces that have at least one common aspect:
        <ul>
          <li>their color (light or dark),</li>
          <li>their size (big or small),</li>
          <li>their pattern (empty or dotted),</li>
          <li>their shape (round or square).</li>
        </ul>
        Here, we have a board with a victory by an alignment of dark pieces.`,new J2([[g3,f3,a3,s3],[y3,y3,y3,y3],[y3,y3,y3,y3],[y3,y3,y3,y3]],7,Q2.ABAB)),_j.anyMove($localize`Placement`,$localize`Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,
        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.
        If you prefer, the order of these two steps can be reversed.
        Keep in mind that the second click confirms the move.<br/><br/>
        Make a move.`,new J2([[g3,o3,c3,y3],[y3,y3,y3,y3],[y3,u3,y3,y3],[y3,y3,y3,y3]],7,Q2.ABAA),new X2(2,2,Q2.BAAB),$localize`Perfect!`),_j.fromMove($localize`Situation`,$localize`We have here a tricky situation.<br/><br/>
        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move.`,new J2([[m3,g3,p3,y3],[a3,d3,f3,y3],[l3,u3,h3,y3],[y3,y3,y3,y3]],7,Q2.AABA),[new X2(3,3,Q2.AABB)],$localize`Well done!`,$localize`Failed!`)]}}function C3(e,t){if(1&e&&(_n(),ga(0,"rect",11)),2&e){const e=Sa(2),t=e.$implicit,n=e.index,r=Sa().index,i=Sa();ha("ngClass",i.getPieceClasses(t.value)),ra("x",i.SPACE_SIZE*n+(i.SPACE_SIZE/2-i.getPieceSize(t.value)))("y",i.SPACE_SIZE*r+(i.SPACE_SIZE/2-i.getPieceSize(t.value)))("width",2*i.getPieceSize(t.value))("height",2*i.getPieceSize(t.value))}}function _3(e,t){if(1&e&&(_n(),ga(0,"circle",11)),2&e){const e=Sa(2),t=e.$implicit,n=e.index,r=Sa().index,i=Sa();ha("ngClass",i.getPieceClasses(t.value)),ra("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.getPieceSize(t.value))}}function E3(e,t){if(1&e&&(_n(),ga(0,"circle")),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();ra("cx",n.SPACE_SIZE*e+n.SPACE_SIZE/2)("cy",n.SPACE_SIZE*t+n.SPACE_SIZE/2)("r",10)}}function w3(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,C3,1,5,"rect",9),la(2,_3,1,4,"ng-template",null,10,Ku),la(4,E3,1,3,"circle",3),pa()),2&e){const e=ca(3),t=Sa().$implicit,n=Sa(2);Ts(1),ha("ngIf",t.isRectangle())("ngIfElse",e),Ts(3),ha("ngIf",n.pieceHasDot(t.value))}}function P3(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",8),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().chooseCoord(t,n)}),pa(),la(2,w3,5,3,"g",3),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();Ts(1),Ia("id","chooseCoord_",n,"_",r,""),ha("ngClass",i.getSquareClasses(n,r)),ra("x",i.SPACE_SIZE*n)("y",i.SPACE_SIZE*r)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),Ts(1),ha("ngIf",e!==i.EMPTY)}}function S3(e,t){if(1&e&&(_n(),fa(0,"g",null,7),la(2,P3,3,8,"g",2),pa()),2&e){const e=t.$implicit;Ts(2),ha("ngForOf",e)}}function b3(e,t){if(1&e&&(_n(),ga(0,"rect",15)),2&e){const e=Sa(2);ha("ngClass",e.getPieceClasses(e.pieceInHand.value)),ra("x",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("y",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function O3(e,t){if(1&e&&(_n(),ga(0,"circle",11)),2&e){const e=Sa(2);ha("ngClass",e.getPieceClasses(e.pieceInHand.value)),ra("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",e.getPieceSize(e.pieceInHand.value))}}function T3(e,t){if(1&e&&(_n(),ga(0,"circle")),2&e){const e=Sa(2);ra("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",10)}}function I3(e,t){if(1&e&&(_n(),fa(0,"g",null,12),ga(2,"rect",13),la(3,b3,1,5,"rect",14),la(4,O3,1,4,"ng-template",null,10,Ku),la(6,T3,1,3,"circle",3),pa()),2&e){const e=ca(5),t=Sa();ra("transform","translate("+t.chosen.get().x*t.SPACE_SIZE+" "+t.chosen.get().y*t.SPACE_SIZE+")"),Ts(2),ra("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),Ts(1),ha("ngIf",t.pieceInHand.isRectangle())("ngIfElse",e),Ts(3),ha("ngIf",t.pieceHasDot(t.pieceInHand.value))}}function k3(e,t){if(1&e&&(_n(),fa(0,"g",null,16),ga(2,"rect",17),pa()),2&e){const e=t.$implicit,n=Sa();Ts(2),ra("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)("transform","translate("+e.x*n.SPACE_SIZE+" "+e.y*n.SPACE_SIZE+")")}}function A3(e,t){if(1&e&&(_n(),ga(0,"rect",11)),2&e){const e=Sa(2);ha("ngClass",e.getPieceClasses(e.pieceInHand.value)),ra("x",0)("y",.75*e.SPACE_SIZE)("transform","translate("+-e.getPieceSize(e.pieceInHand.value)+", "+-e.getPieceSize(e.pieceInHand.value)+")")("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function M3(e,t){if(1&e&&(_n(),ga(0,"circle",19)),2&e){const e=Sa(2);ha("ngClass",e.getPieceClasses(e.pieceInHand.value)),ra("cy",.75*e.SPACE_SIZE)("r",e.getPieceSize(e.pieceInHand.value))}}function N3(e,t){1&e&&(_n(),ga(0,"circle",20)),2&e&&ra("cy",.75*Sa(2).SPACE_SIZE)("r",10)}function R3(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,A3,1,6,"rect",9),la(2,M3,1,3,"ng-template",null,10,Ku),la(4,N3,1,2,"circle",18),pa()),2&e){const e=ca(3),t=Sa();Ts(1),ha("ngIf",t.pieceInHand.isRectangle())("ngIfElse",e),Ts(3),ha("ngIf",t.pieceHasDot(t.pieceInHand.value))}}function x3(e,t){if(1&e&&(_n(),ga(0,"rect",27)),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();ra("x",n.SPACE_SIZE*e)("y",n.SPACE_SIZE*t)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function D3(e,t){if(1&e&&(_n(),ga(0,"rect",11)),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();ha("ngClass",n.getPieceClasses(4*t+e)),ra("x",n.SPACE_SIZE*e+n.SPACE_SIZE/2-n.getPieceSize(4*t+e))("y",n.SPACE_SIZE*t+n.SPACE_SIZE/2-n.getPieceSize(4*t+e))("width",2*n.getPieceSize(4*t+e))("height",2*n.getPieceSize(4*t+e))}}function L3(e,t){if(1&e&&(_n(),ga(0,"circle",11)),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();ha("ngClass",n.getPieceClasses(4*t+e)),ra("cx",n.SPACE_SIZE*e+n.SPACE_SIZE/2)("cy",n.SPACE_SIZE*t+n.SPACE_SIZE/2)("r",n.getPieceSize(4*t+e))}}function F3(e,t){if(1&e&&(_n(),ga(0,"circle")),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();ra("cx",n.SPACE_SIZE*e+n.SPACE_SIZE/2)("cy",n.SPACE_SIZE*t+n.SPACE_SIZE/2)("r",10)}}function U3(e,t){if(1&e){const e=va();_n(),fa(0,"g",25),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().choosePiece(4*n+t)}),la(1,x3,1,4,"rect",26),la(2,D3,1,5,"rect",9),la(3,L3,1,4,"ng-template",null,10,Ku),la(5,F3,1,3,"circle",3),pa()}if(2&e){const e=ca(4),t=Sa().index,n=Sa().index,r=Sa();Ta("id","choosePiece_",4*n+t,""),Ts(1),ha("ngIf",r.pieceToGive.value===4*n+t),Ts(1),ha("ngIf",(4*n+t)%4<2)("ngIfElse",e),Ts(3),ha("ngIf",r.pieceHasDot(4*n+t))}}function V3(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,U3,6,5,"g",24),pa()),2&e){const e=t.index,n=Sa().index,r=Sa();Ts(1),ha("ngIf",r.isRemaining(4*n+e))}}function B3(e,t){if(1&e&&(_n(),fa(0,"g",null,21),ga(2,"rect",22,23),la(4,V3,2,1,"g",2),pa()),2&e){const e=t.$implicit,n=Sa();ra("transform","translate(0 "+6.5*n.SPACE_SIZE+")"),Ts(2),ra("x",-.125*n.SPACE_SIZE)("y",-.125*n.SPACE_SIZE)("width",4.25*n.SPACE_SIZE)("height",4.25*n.SPACE_SIZE),Ts(2),ha("ngForOf",e)}}let $3=(()=>{class e extends tY{constructor(e){super(e),this.EMPTY=Q2.EMPTY,this.chosen=Nw.empty(),this.lastMove=Nw.empty(),this.pieceInHand=Q2.EMPTY,this.pieceToGive=Q2.EMPTY,this.victoriousCoords=[],this.rules=new r3(J2),this.availableMinimaxes=[new i3(this.rules,"QuartoMinimax")],this.encoder=X2.encoder,this.tutorial=(new v3).tutorial,this.pieceInHand=this.rules.node.gameState.pieceInHand,this.updateBoard()}updateBoard(){const e=this.rules.node.gameState,t=this.rules.node.move;this.board=e.getCopiedBoard(),this.chosen=Nw.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=t.map(e=>e.coord)}chooseCoord(e,t){var n=this;return Ow(function*(){const r=n.canUserPlay("#chooseCoord_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());if(n.hideLastMove(),n.board[t][e]===Q2.EMPTY){if(n.showPieceInHandOnBoard(e,t),15===n.rules.node.gameState.turn){const r=new X2(e,t,Q2.EMPTY);return n.chooseMove(r,n.rules.node.gameState)}if(n.pieceToGive===Q2.EMPTY)return Lw.SUCCESS;{const r=new X2(e,t,n.pieceToGive);return n.chooseMove(r,n.rules.node.gameState)}}return n.cancelMove(JW.MUST_CLICK_ON_EMPTY_SPACE())})()}choosePiece(e){var t=this;return Ow(function*(){const n=t.canUserPlay("#choosePiece_"+e);if(n.isFailure())return t.cancelMove(n.getReason());if(t.hideLastMove(),t.pieceToGive=Q2.fromInt(e),t.chosen.isAbsent())return Lw.SUCCESS;{const e=t.chosen.get(),n=new X2(e.x,e.y,t.pieceToGive);return t.chooseMove(n,t.rules.node.gameState)}})()}hideLastMove(){this.lastMove=Nw.empty()}cancelMoveAttempt(){this.hideLastMove(),this.pieceToGive=Q2.EMPTY}showPieceInHandOnBoard(e,t){this.chosen=Nw.of(new GW(e,t))}isRemaining(e){return J2.isGivable(Q2.fromInt(e),this.board,this.pieceInHand)}getSquareClasses(e,t){const n=new GW(e,t);return this.lastMove.equalsValue(n)?["moved"]:[]}getPieceClasses(e){const t=[];return t.push(e%2==0?"player0":"player1"),t}getPieceSize(e){return e<8?40:25}pieceHasDot(e){return e!==Q2.EMPTY.value&&e%8<4}}return e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-quarto"]],features:[Go],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],["chosenPiece",""],["id","highlight","x","0","y","0",1,"base","highlighted","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],[3,"id","click",4,"ngIf"],[3,"id","click"],["class","base highlighted",4,"ngIf"],[1,"base","highlighted"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),fa(1,"g",1),la(2,S3,3,1,"g",2),la(3,I3,7,6,"g",3),la(4,k3,3,3,"g",2),fa(5,"g",null,4),ga(7,"rect",5,6),la(9,R3,5,3,"g",3),pa(),la(10,B3,5,6,"g",2),pa(),pa()),2&e&&(ra("viewBox","0 0 "+4.25*t.SPACE_SIZE+" "+10.75*t.SPACE_SIZE),Ts(2),ha("ngForOf",t.board),Ts(1),ha("ngIf",t.chosen.isPresent()),Ts(1),ha("ngForOf",t.victoriousCoords),Ts(1),ra("transform","translate("+2*t.SPACE_SIZE+", "+4.5*t.SPACE_SIZE+")"),Ts(2),ra("width",1.5*t.SPACE_SIZE)("height",1.5*t.SPACE_SIZE)("transform","translate("+-.75*t.SPACE_SIZE+", 0)"),Ts(2),ha("ngIf",t.chosen.isAbsent()),Ts(1),ha("ngForOf",t.board))},directives:[tf,rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),z3=(()=>{class e{}return e.NO_INSIDE_CLICK=()=>$localize`You must pick a space from the edge of the board.`,e})();class H3 extends lj{constructor(e,t,n){super(e,t),this.direction=n;const r=H3.isValidCoord(this.coord);if(r.isFailure())throw new Error(r.getReason());if(0===e&&n===zW.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===e&&n===zW.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===t&&n===zW.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===t&&n===zW.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.")}static isValidCoord(e){return e.isNotInRange(5,5)?Lw.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&4!==e.x&&0!==e.y&&4!==e.y?Lw.failure(z3.NO_INSIDE_CLICK()):Lw.SUCCESS}toString(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}equals(e){return e===this||!!e.coord.equals(this.coord)&&e.direction===this.direction}}H3.encoder=new class extends bZ{maxValue(){return 128}encodeNumber(e){const t=e.direction.toInt();return 20*e.coord.x+4*e.coord.y+t}decodeNumber(e){const t=zW.factory.fromInt(e%4).get();e-=e%4;const n=(e/=4)%5;return e-=e%5,new H3(e/=5,n,t)}};class G3 extends sj{static getInitialState(){const e=NZ.createTable(5,5,IZ.NONE);return new G3(e,0)}applyLegalMove(e){const t=this.getCopiedBoard(),n=this.turn+1;let r=e.coord,i=e.coord.getNext(e.direction);for(;i.isInRange(5,5);)t[r.y][r.x]=t[i.y][i.x],r=r.getNext(e.direction),i=i.getNext(e.direction);return t[r.y][r.x]=this.getCurrentPlayer(),new G3(t,n)}}class Z3 extends mj{static getVerticalCoords(e){const t=e.gameState.getCurrentOpponent(),n=[];for(let r=0;r<5;r++)e.gameState.getPieceAtXY(0,r)!==t&&n.push(new GW(0,r)),e.gameState.getPieceAtXY(4,r)!==t&&n.push(new GW(4,r));return n}static getHorizontalCenterCoords(e){const t=e.gameState.getCurrentOpponent(),n=[];for(let r=1;r<4;r++)e.gameState.getPieceAtXY(r,0)!==t&&n.push(new GW(r,0)),e.gameState.getPieceAtXY(r,4)!==t&&n.push(new GW(r,4));return n}static getPossibleDirections(e){const t=[];return 0!==e.x&&t.push(zW.LEFT),0!==e.y&&t.push(zW.UP),4!==e.x&&t.push(zW.RIGHT),4!==e.y&&t.push(zW.DOWN),t}static getLinesSums(e){const t={};t[TZ.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[TZ.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(let n=0;n<5;n++)for(let r=0;r<5;r++){const i=e.getPieceAtXY(r,n);if(i.isPlayer()){const e=i.value;t[e].columns[r]=t[e].columns[r]+1,t[e].rows[n]=t[e].rows[n]+1,r===n&&(t[e].diagonals[0]=t[e].diagonals[0]+1),r+n===4&&(t[e].diagonals[1]=t[e].diagonals[1]+1)}}return t}static getVictoriousCoords(e){const t=Z3.getLinesSums(e),n=[];for(let r=0;r<2;r++){for(let e=0;e<5;e++){if(5===t[r].columns[e])for(let t=0;t<5;t++)n.push(new GW(e,t));if(5===t[r].rows[e])for(let t=0;t<5;t++)n.push(new GW(t,e))}if(5===t[r].diagonals[0])for(let e=0;e<5;e++)n.push(new GW(e,e));if(5===t[r].diagonals[1])for(let e=0;e<5;e++)n.push(new GW(e,4-e))}return n}static getFullestLine(e){const t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max(...t)}applyLegalMove(e,t,n){return Z3.applyLegalMove(e,t,n)}static applyLegalMove(e,t,n){return t.applyLegalMove(e)}isLegal(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?Rw.failure(JW.CANNOT_CHOOSE_OPPONENT_PIECE()):Rw.success(void 0)}getGameStatus(e){const t=e.gameState,n=Z3.getLinesSums(t),r=Z3.getFullestLine(n[TZ.ZERO.value]),i=Z3.getFullestLine(n[TZ.ONE.value]),s=t.getCurrentPlayer();return 5===r&&(s===TZ.ZERO||i<5)?gj.ZERO_WON:5===i?gj.ONE_WON:gj.ONGOING}}class q3 extends ej{getListMoves(e){const t=[],n=Z3.getVerticalCoords(e),r=Z3.getHorizontalCenterCoords(e).concat(n);for(const i of r){const e=Z3.getPossibleDirections(i);for(const n of e){const e=new H3(i.x,i.y,n);t.push(e)}}return t}getBoardValue(e){const t=e.gameState,n=Z3.getLinesSums(t),r=Z3.getFullestLine(n[TZ.ZERO.value]),i=Z3.getFullestLine(n[TZ.ONE.value]),s=t.getCurrentPlayer();return new tj(5===r&&(s===TZ.ZERO||i<5)?TZ.ZERO.getVictoryValue():5===i?TZ.ONE.getVictoryValue():i-r)}}class W3{static getArrowTransform(e,t,n){let r,i,s;switch(n){case zW.UP:r=0,i=-1,s=-90;break;case zW.DOWN:r=0,i=1,s=90;break;case zW.LEFT:r=-1,i=0,s=180;break;default:Tw.expectToBe(n,zW.RIGHT),r=1,i=0,s=0}return[`translate(${t.x*e+e/2+r*e/4} ${t.y*e+e/2+i*e/4})`,"scale(2.5)",`rotate(${s})`].join(" ")}}const j3=IZ.NONE,Y3=IZ.ZERO,K3=IZ.ONE;class Q3{constructor(){this.tutorial=[_j.informational($localize`Goal of the game.`,$localize`At Quixo, the goal is to align 5 of your pieces.
        The first player plays with dark pieces, the second with light pieces.
        The board is made of 25 spaces spread over a 5x5 square.
        Every piece has a neutral side, a light side, and a dark side.`,G3.getInitialState()),_j.fromMove($localize`What a move looks like (without animation)`,$localize`When it is your turn:
        <ol>
            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.
                You can only choose a piece from the edge of the board.</li>
            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>
        </ol>
        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.
        Once on the other side, all pieces will move by one space in the opposing direction.
        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>
        For example, take the bottom right neutral piece, and move it to the left (you're playing Light).`,new G3([[j3,j3,j3,j3,j3],[j3,j3,j3,j3,j3],[j3,j3,j3,j3,j3],[j3,j3,j3,j3,j3],[Y3,Y3,Y3,Y3,j3]],1),[new H3(4,4,zW.LEFT)],$localize`See how the four dark pieces have been moved one space to the right.
        The neutral piece has been move 4 pieces to the left and has become light.`,$localize`Failed!`),_j.fromMove($localize`Victory`,$localize`You already know everything you need in order to play, but there is one last particularity.
        If you create a line of 5 of your pieces, you win.
        If you create a line of 5 of your opponent's pieces, you lose.
        If you create both, you lose too!<br/><br/>
        You can win with this board, try it.
        You're playing Light.`,new G3([[j3,K3,j3,K3,K3],[j3,Y3,Y3,j3,Y3],[K3,K3,K3,Y3,K3],[Y3,j3,Y3,K3,K3],[K3,Y3,j3,K3,Y3]],31),[new H3(3,0,zW.DOWN)],$localize`Congratulations, you won!`,$localize`Failed!`)]}}function X3(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"circle",4),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onBoardClick(t,n)}),pa(),pa()}if(2&e){const e=t.index,n=Sa().index,r=Sa();Ts(1),Ia("id","click_",e,"_",n,""),ha("ngClass",r.getPieceClasses(e,n)),ra("cx",50+100*e)("cy",50+100*n)}}function J3(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,X3,2,5,"g",2),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}function e4(e,t){if(1&e){const e=va();_n(),fa(0,"use",6),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).chooseDirection(t)}),pa()}if(2&e){const e=t.$implicit,n=Sa(2);Ta("id","chooseDirection_",e,""),ra("transform",n.getArrowTransform(n.chosenCoord.get(),e))}}function t4(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,e4,1,2,"use",5),pa()),2&e){const e=Sa();Ts(1),ha("ngForOf",e.getPossiblesDirections())}}let n4=(()=>{class e extends tY{constructor(e){super(e),this.lastMoveCoord=Nw.empty(),this.chosenCoord=Nw.empty(),this.victoriousCoords=[],this.rules=new Z3(G3),this.availableMinimaxes=[new q3(this.rules,"QuixoMinimax")],this.encoder=H3.encoder,this.tutorial=(new Q3).tutorial,this.updateBoard()}updateBoard(){this.state=this.rules.node.gameState,this.board=this.state.board,this.lastMoveCoord=this.rules.node.move.map(e=>e.coord),this.victoriousCoords=Z3.getVictoriousCoords(this.state)}cancelMoveAttempt(){this.chosenCoord=Nw.empty()}getPieceClasses(e,t){const n=new GW(e,t),r=[];return r.push(this.getPlayerClass(this.board[t][e])),this.chosenCoord.equalsValue(n)?r.push("selected"):this.lastMoveCoord.equalsValue(n)&&r.push("last-move"),this.victoriousCoords.some(e=>e.equals(n))&&r.push("victory-stroke"),r}onBoardClick(e,t){const n=this.canUserPlay("#click_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());const r=new GW(e,t),i=H3.isValidCoord(r);return i.isFailure()?this.cancelMove(i.getReason()):this.board[t][e]===this.state.getCurrentOpponent()?this.cancelMove(JW.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord=Nw.of(r),Lw.SUCCESS)}getPossiblesDirections(){const e=[],t=this.chosenCoord.get();return 4!==t.x&&e.push("RIGHT"),0!==t.x&&e.push("LEFT"),4!==t.y&&e.push("DOWN"),0!==t.y&&e.push("UP"),e}chooseDirection(e){var t=this;return Ow(function*(){const n=t.canUserPlay("#chooseDirection_"+e);return n.isFailure()?t.cancelMove(n.getReason()):(t.chosenDirection=zW.factory.fromString(e).get(),yield t.tryMove())})()}tryMove(){var e=this;return Ow(function*(){const t=e.chosenCoord.get(),n=new H3(t.x,t.y,e.chosenDirection);return e.cancelMove(),e.chooseMove(n,e.rules.node.gameState)})()}getArrowTransform(e,t){return W3.getArrowTransform(this.SPACE_SIZE,e,zW.factory.fromString(t).get())}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-quixo"]],features:[Go],decls:5,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 500 500","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -3.5, 10 0, 0 3.5"],[4,"ngFor","ngForOf"],[4,"ngIf"],["r","45",1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",3,"id","click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),fa(1,"defs"),ga(2,"polygon",1),pa(),la(3,J3,2,1,"g",2),la(4,t4,2,1,"g",3),pa()),2&e&&(Ts(3),ha("ngForOf",t.board),Ts(1),ha("ngIf",t.chosenCoord.isPresent()))},directives:[tf,rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),r4=(()=>{class e extends sj{static getInitialState(){const t=NZ.createTable(e.BOARD_WIDTH,e.BOARD_HEIGHT,IZ.NONE);return t[3][3]=TZ.ZERO,t[4][4]=TZ.ZERO,t[3][4]=TZ.ONE,t[4][3]=TZ.ONE,new e(t,0)}static getNeighboringPawnLike(e,t,n,r){let i;const s=[];for(let o=-1;o<2;o++)for(let a=-1;a<2;a++)i=new GW(n+a,r+o),i.isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[i.y][i.x]===t&&s.push(i);return s}countScore(){const t=[0,0];for(let n=0;n<e.BOARD_HEIGHT;n++)for(let r=0;r<e.BOARD_WIDTH;r++){const e=this.board[n][r];e.isPlayer()&&(t[e.value]+=1)}return t}}return e.BOARD_WIDTH=8,e.BOARD_HEIGHT=8,e})();class i4 extends lj{equals(e){return e===this||e.coord.equals(this.coord)}toString(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}i4.encoder=new class extends bZ{maxValue(){return(r4.BOARD_HEIGHT-1)*r4.BOARD_WIDTH+(r4.BOARD_WIDTH-1)}encodeNumber(e){return e.coord.y*r4.BOARD_WIDTH+e.coord.x}decodeNumber(e){const t=e%r4.BOARD_WIDTH;return new i4(t,(e-t)/r4.BOARD_WIDTH)}},i4.PASS=new i4(-1,-1),i4.PASS_NUMBER=i4.encoder.encodeNumber(i4.PASS);let s4=(()=>{class e{}return e.NO_ELEMENT_SWITCHED=()=>$localize`Your move should switch at least one piece.`,e})();class o4{constructor(e,t){this.move=e,this.switched=t}}let a4=(()=>{class e extends mj{static getGameStatus(t){const n=t.gameState;if(!1===e.isGameEnded(n))return gj.ONGOING;const r=n.countScore(),i=r[1]-r[0];return i<0?gj.ZERO_WON:i>0?gj.ONE_WON:gj.DRAW}applyLegalMove(e,t,n){const r=t.turn,i=t.getCurrentPlayer(),s=t.getCopiedBoard();if(e.equals(i4.PASS))return new r4(s,r+1);for(const o of n)s[o.y][o.x]=i;return s[e.coord.y][e.coord.x]=i,new r4(s,r+1)}static getAllSwitcheds(t,n,r){const i=[],s=n.getOpponent();for(const o of $W.DIRECTIONS){const a=t.coord.getNext(o);if(a.isInRange(r4.BOARD_WIDTH,r4.BOARD_HEIGHT)&&r[a.y][a.x]===s){const t=e.getSandwicheds(n,o,a,r);for(const e of t)i.push(e)}}return i}static getSandwicheds(e,t,n,r){const i=[n];let s=n.getNext(t);for(;s.isInRange(r4.BOARD_WIDTH,r4.BOARD_HEIGHT);){const n=r[s.y][s.x];if(n===e)return i;if(n===IZ.NONE)return[];i.push(s),s=s.getNext(t)}return[]}static isGameEnded(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}getGameStatus(t){return e.getGameStatus(t)}static playerCanOnlyPass(e){const t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(i4.PASS)}static nextPlayerCantOnlyPass(e){const t=e.getCopiedBoard(),n=new r4(t,e.turn+1);return this.playerCanOnlyPass(n)}static getListMoves(t){const n=[];let r;const i=t.getCurrentPlayer(),s=t.getCurrentOpponent();for(let o=0;o<8;o++)for(let a=0;a<8;a++)if(t.getPieceAtXY(a,o)===IZ.NONE&&(r=t.getCopiedBoard(),r4.getNeighboringPawnLike(r,s,a,o).length>0)){const s=new i4(a,o),l=e.getAllSwitcheds(s,i,r);if(l.length>0){for(const e of l)hZ(i!==t.getPieceAt(e),e+"was already switched!"),r[e.y][e.x]=i;r[o][a]=i,n.push(new o4(s,l.length))}}return 0===n.length&&n.push(new o4(i4.PASS,0)),n}isLegal(t,n){if(t.equals(i4.PASS))return e.playerCanOnlyPass(n)?Rw.success([]):Rw.failure(JW.MUST_PASS());if(n.getPieceAt(t.coord).isPlayer())return Iw(e.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),Rw.failure(JW.MUST_CLICK_ON_EMPTY_SPACE());const r=n.getCopiedBoard(),i=e.getAllSwitcheds(t,n.getCurrentPlayer(),r);return Iw(e.VERBOSE,"ReversiRules.isLegal: "+i.length+" element(s) switched"),0===i.length?Rw.failure(s4.NO_ELEMENT_SWITCHED()):Rw.success(i)}}return e.VERBOSE=!1,e})();class l4 extends ej{getBoardValue(e){const t=a4.getGameStatus(e);if(t.isEndGame)return tj.fromWinner(t.winner);const n=e.gameState.getCopiedBoard();let r=0,i=0;for(let s=0;s<r4.BOARD_HEIGHT;s++)for(let e=0;e<r4.BOARD_WIDTH;e++){const t=(0===e||e===r4.BOARD_WIDTH-1?4:1)*(0===s||s===r4.BOARD_HEIGHT-1?4:1);n[s][e]===TZ.ZERO&&(r+=t),n[s][e]===TZ.ONE&&(i+=t)}return r*=TZ.ZERO.getScoreModifier(),i*=TZ.ONE.getScoreModifier(),new tj(i+r)}getListMoves(e){const t=a4.getListMoves(e.gameState);return NZ.sortByDescending(t,e=>l4.bestCoords.some(t=>e.move.coord.equals(t))?100:e.switched),t.map(e=>e.move)}}l4.bestCoords=[new GW(0,0),new GW(0,r4.BOARD_HEIGHT-1),new GW(r4.BOARD_WIDTH-1,0),new GW(r4.BOARD_WIDTH-1,r4.BOARD_HEIGHT-1)];const c4=IZ.NONE,u4=IZ.ZERO,h4=IZ.ONE;class d4{constructor(){this.tutorial=[_j.informational($localize`Goal of the game`,$localize`At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.
        When one piece is flipped, its owner changes.
        The player owning the most pieces at the end of the game wins.
        Here, Dark has 28 points and Light has 36, hence Light wins.`,new r4([[u4,u4,u4,u4,u4,u4,u4,u4],[u4,h4,h4,h4,h4,h4,h4,u4],[u4,h4,h4,h4,h4,h4,h4,u4],[u4,h4,h4,h4,h4,h4,h4,u4],[u4,h4,h4,h4,h4,h4,h4,u4],[u4,h4,h4,h4,h4,h4,h4,u4],[u4,h4,h4,h4,h4,h4,h4,u4],[u4,u4,u4,u4,u4,u4,u4,u4]],60)),_j.anyMove($localize`Capture (1/2)`,$localize`At the beginning of the game, pieces are placed as shown here.
        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>
        Do any move by clicking to put your piece
        Dark plays first.`,r4.getInitialState(),new i4(2,4),$localize`Congratulations!`),_j.fromMove($localize`Capture (2/2)`,$localize`A move can also capture a bigger line, and more than one lines at a time
        You're playing light here.<br/><br/>
        Play on the bottom left to see an example.`,new r4([[c4,c4,c4,c4,c4,c4,c4,c4],[c4,c4,c4,c4,c4,c4,c4,c4],[c4,c4,c4,c4,c4,c4,c4,c4],[c4,c4,c4,c4,h4,c4,c4,c4],[c4,c4,c4,u4,c4,c4,c4,c4],[c4,c4,u4,c4,c4,c4,c4,c4],[u4,u4,c4,c4,c4,c4,c4,c4],[c4,u4,h4,u4,h4,u4,c4,c4]],1),[new i4(0,7)],$localize`Congratulations!`,$localize`Lower and more to the left, please.`),_j.informational($localize`Passing a turn`,$localize`If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass
        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way.`,new r4([[h4,u4,u4,u4,u4,u4,h4,u4],[u4,h4,h4,h4,h4,h4,h4,u4],[u4,h4,h4,h4,h4,h4,h4,u4],[u4,h4,h4,h4,h4,h4,h4,u4],[u4,h4,h4,h4,h4,h4,h4,u4],[u4,h4,h4,h4,h4,h4,h4,u4],[h4,h4,h4,h4,h4,h4,c4,c4],[u4,u4,u4,u4,u4,u4,c4,c4]],60))]}}function f4(e,t){if(1&e&&(_n(),ga(0,"circle",4)),2&e){const e=Sa().index,t=Sa().index,n=Sa();ha("ngClass",n.getPieceClass(e,t)),ra("r",n.SPACE_SIZE/2-n.STROKE_WIDTH)("cx",n.SPACE_SIZE*e+n.SPACE_SIZE/2)("cy",n.SPACE_SIZE*t+n.SPACE_SIZE/2)}}function p4(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",2),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),pa(),la(2,f4,1,4,"circle",3),pa()}if(2&e){const e=t.index,n=Sa().index,r=Sa();Ts(1),Ia("id","click_",e,"_",n,""),ha("ngClass",r.getRectClasses(e,n)),ra("x",r.SPACE_SIZE*e)("y",r.SPACE_SIZE*n)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),Ts(1),ha("ngIf",r.board[n][e]!==r.EMPTY)}}function g4(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,p4,3,8,"g",1),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}let m4=(()=>{class e extends tY{constructor(e){super(e),this.EMPTY=IZ.NONE,this.lastMove=new GW(-2,-2),this.captureds=[],this.scores=Nw.of([2,2]),this.rules=new a4(r4),this.availableMinimaxes=[new l4(this.rules,"ReversiMinimax")],this.encoder=i4.encoder,this.tutorial=(new d4).tutorial,this.canPass=!1,this.updateBoard()}onClick(e,t){var n=this;return Ow(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=new i4(e,t);return yield n.chooseMove(i,n.rules.node.gameState,n.scores.get())})()}updateBoard(){const e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.captureds=[],this.rules.node.move.isPresent()?this.showPreviousMove():this.lastMove=new GW(-2,-2),this.scores=Nw.of(e.countScore()),this.canPass=a4.playerCanOnlyPass(e)}showPreviousMove(){this.lastMove=this.rules.node.move.get().coord;const e=this.rules.node.gameState.getCurrentPlayer(),t=this.rules.node.gameState.getCurrentOpponent();for(const n of $W.DIRECTIONS){let r=this.lastMove.getNext(n,1);for(;r.isInRange(r4.BOARD_WIDTH,r4.BOARD_HEIGHT)&&this.rules.node.gameState.getPieceAt(r)===t&&this.rules.node.mother.get().gameState.getPieceAt(r)===e;)this.captureds.push(r),r=r.getNext(n,1)}}getRectClasses(e,t){const n=new GW(e,t);return this.captureds.some(e=>e.equals(n))?["captured"]:n.equals(this.lastMove)?["moved"]:[]}getPieceClass(e,t){return this.getPlayerClass(this.board[t][e])}pass(){var e=this;return Ow(function*(){return hZ(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(i4.PASS.coord.x,i4.PASS.coord.y)})()}}return e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-reversi"]],features:[Go],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,g4,2,1,"g",1),pa()),2&e&&(ra("viewBox","0 -4 "+8*t.SPACE_SIZE+" "+(10+8*t.SPACE_SIZE)),Ts(1),ha("ngForOf",t.board))},directives:[tf,Jd,rf],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),y4=(()=>{class e extends JY{static getInitialState(){const t=WW.UNREACHABLE,n=WW.ZERO,r=WW.ONE,i=WW.EMPTY;return new e([[t,t,n,r,i,i,i,n,r,t,t],[t,i,i,i,i,i,i,i,i,i,t],[r,i,i,i,i,i,i,i,i,i,n],[n,i,i,i,i,i,i,i,i,i,r],[t,i,i,i,i,i,i,i,i,i,t],[t,t,r,n,i,i,i,r,n,t,t]],0)}}return e.HEIGHT=6,e.WIDTH=11,e})(),v4=(()=>{class e{}return e.CAN_ONLY_REBOUND_ON_BLACK=()=>$localize`You can only rebound on dark spaces.`,e.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=()=>$localize`You can only rebound on empty spaces.`,e.MUST_CHOOSE_PYRAMID_FIRST=()=>$localize`You must pick one of your pyramids first.`,e.MUST_CHOOSE_OWN_PYRAMID=()=>$localize`You must pick one of your pyramids.`,e.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=()=>$localize`Those two spaces are not neighbors.`,e.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=()=>$localize`Those two spaces have no intermediary neighbor.`,e})();class C4 extends hY{constructor(e,t){super(e,t)}static checkDistanceAndLocation(e,t){const n=Math.abs(e.x-t.x)+Math.abs(e.y-t.y);if(0===n)return Lw.failure(JW.MOVE_CANNOT_BE_STATIC());if(1===n){const n=XY.getFakeNeighbors(e);if(t.equals(n))return Lw.failure(v4.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return Lw.failure($localize`You can move one or two spaces, not ${n}.`);if(XY.isSpaceDark(e))return Lw.failure(v4.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return Lw.failure(v4.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return Lw.SUCCESS}static from(e,t){if(!e.isInRange(y4.WIDTH,y4.HEIGHT))throw new Error("Move must start inside the board not at "+e.toString()+".");if(!t.isInRange(y4.WIDTH,y4.HEIGHT))throw new Error("Move must end inside the board not at "+t.toString()+".");const n=C4.checkDistanceAndLocation(e,t);return n.isFailure()?n.toFailedFallible():Rw.success(new C4(e,t))}isSimpleStep(){return Math.abs(this.coord.x-this.end.x)+Math.abs(this.coord.y-this.end.y)===1}equals(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}toString(){return"SaharaMove("+this.coord+"->"+this.end+")"}}C4.encoder=new class extends bZ{maxValue(){return 396*y4.WIDTH+66*y4.HEIGHT+6*y4.WIDTH+y4.HEIGHT}encodeNumber(e){return 396*e.coord.x+66*e.coord.y+6*e.end.x+e.end.y}decodeNumber(e){const t=e%6;e-=t;const n=(e/=6)%11;e-=n;const r=(e/=11)%6;return e-=r,C4.from(new GW(e/=6,r),new GW(n,t)).get()}};let _4=(()=>{class e extends mj{static getStartingCoords(e,t){const n=[];for(let r=0;r<y4.HEIGHT;r++)for(let i=0;i<y4.WIDTH;i++)e[r][i].is(t)&&n.push(new GW(i,r));return n}static getBoardValuesFor(t,n){const r=e.getStartingCoords(t,n),i=[];for(const e of r){const n=JY.getEmptyNeighbors(t,e,WW.EMPTY).length;if(0===n)return[0];i.push(n)}return i.sort((e,t)=>e-t)}applyLegalMove(t,n,r){Iw(e.VERBOSE,"Legal move "+t.toString()+" applied");const i=n.getCopiedBoard();return i[t.end.y][t.end.x]=i[t.coord.y][t.coord.x],i[t.coord.y][t.coord.x]=WW.EMPTY,new y4(i,n.turn+1)}isLegal(e,t){if(t.getPieceAt(e.coord).value!==t.getCurrentPlayer().value)return Rw.failure(JW.CANNOT_CHOOSE_OPPONENT_PIECE());if(t.getPieceAt(e.end)!==WW.EMPTY)return Rw.failure(JW.MUST_LAND_ON_EMPTY_SPACE());const n=XY.getCommonNeighbor(e.coord,e.end);return n.isPresent()?t.getPieceAt(n.get())===WW.EMPTY?Rw.success(void 0):Rw.failure(v4.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):Rw.success(void 0)}getGameStatus(t){const n=t.gameState.getCopiedBoard(),r=e.getBoardValuesFor(n,TZ.ZERO),i=e.getBoardValuesFor(n,TZ.ONE);return e.getGameStatusFromFreedoms(r,i)}getLandingCoords(e,t){const n=t=>t.isInRange(y4.WIDTH,y4.HEIGHT)&&e[t.y][t.x]===WW.EMPTY,r=new rj(XY.getNeighbors(t).filter(n));if(!0===XY.isSpaceDark(t))return r.toList();{const e=new rj(r.toList());for(const t of r){const r=XY.getNeighbors(t).filter(n);for(const t of r)e.add(t)}return e.toList()}}static getGameStatusFromFreedoms(e,t){return 0===e[0]?gj.ONE_WON:0===t[0]?gj.ZERO_WON:gj.ONGOING}}return e.VERBOSE=!1,e})();class E4 extends ej{getListMoves(e){const t=[],n=e.gameState.getCopiedBoard(),r=e.gameState.getCurrentPlayer(),i=_4.getStartingCoords(n,r);for(const s of i){const e=JY.getEmptyNeighbors(n,s,WW.EMPTY);for(const r of e){const e=C4.from(s,r).get();if(n[r.y][r.x]=n[s.y][s.x],n[s.y][s.x]=WW.EMPTY,t.push(e),(r.y+r.x)%2==0){const e=JY.getEmptyNeighbors(n,r,WW.EMPTY);for(const i of e)if(!i.equals(s)){const e=C4.from(s,i).get();n[i.y][i.x]=n[r.y][r.x],n[r.y][r.x]=WW.EMPTY,t.push(e),n[r.y][r.x]=n[i.y][i.x],n[i.y][i.x]=WW.EMPTY}}n[s.y][s.x]=n[r.y][r.x],n[r.y][r.x]=WW.EMPTY}}return t}getBoardValue(e){const t=e.gameState.getCopiedBoard(),n=_4.getBoardValuesFor(t,TZ.ZERO),r=_4.getBoardValuesFor(t,TZ.ONE),i=_4.getGameStatusFromFreedoms(n,r);if(i.isEndGame)return tj.fromWinner(i.winner);let s=0;for(;s<6&&n[s]===r[s];)s++;return new tj(r[s%6]-n[s%6])}}const w4=WW.UNREACHABLE,P4=WW.ZERO,S4=WW.ONE,b4=WW.EMPTY;class O4{constructor(){this.tutorial=[_j.informational($localize`Initial board`,$localize`Shr is played on a board where each space is a triangle.
        Each player has six pyramids.`,y4.getInitialState()),_j.informational($localize`Goal of the game`,$localize`At Shr, the goal of the game is to immobilize one of the opponent's pyramids.
        To do so, you have to occupy all neighboring space of that pyramid.
        Here, Light has lost because its leftmost pyramid is immobilized.`,new y4([[w4,w4,b4,b4,S4,b4,b4,P4,S4,w4,w4],[w4,b4,b4,b4,b4,b4,b4,b4,b4,b4,w4],[S4,P4,b4,b4,b4,b4,b4,b4,b4,b4,P4],[P4,b4,b4,b4,b4,b4,b4,b4,b4,b4,S4],[w4,b4,b4,b4,b4,b4,b4,b4,b4,b4,w4],[w4,w4,S4,P4,b4,b4,b4,S4,P4,w4,w4]],3)),_j.fromPredicate($localize`Simple step`,$localize`To immobilize your opponent, you have to move your pyramids.
        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).
        You're the first player, playing with the dark pyramids.
        <ol>
            <li>Click on one of your pyramids.</li>
            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>
        </ol><br/>
        Do any simple step.`,y4.getInitialState(),C4.from(new GW(2,0),new GW(2,1)).get(),(e,t,n)=>e.isSimpleStep()?Lw.SUCCESS:Lw.failure($localize`You have made a double step, which is good but it is the next exercise!`),$localize`Congratulations!`),_j.fromPredicate($localize`Double step`,$localize`When a pyramid shares its vertices with dark spaces, it can move one or two steps.
        To do so:
        <ol>
            <li>Click on the pyramid to move.</li>
            <li>Click on one of the 6 destinations that you can reach in two steps:
                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.
        </ol>`,y4.getInitialState(),C4.from(new GW(7,0),new GW(5,0)).get(),(e,t,n)=>e.isSimpleStep()?Lw.failure($localize`Failed! You have made a single step.`):Lw.SUCCESS,$localize`Congratulations!`)]}}function T4(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"polygon",7),pa()),2&e){const e=Sa().index,t=Sa().index,n=Sa();Ts(1),ha("ngClass",n.getPlayerClassFor(e,t)),ra("points",n.getPyramidCoordinate(e,t))}}function I4(e,t){if(1&e&&(_n(),ga(0,"polygon",10)),2&e){const e=Sa(2).index,t=Sa().index;ra("points",Sa().getTriangleCoordinate(e,t))}}function k4(e,t){if(1&e&&(_n(),ga(0,"polygon",11)),2&e){const e=Sa(2).index,t=Sa().index;ra("points",Sa().getTriangleCoordinate(e,t))}}function A4(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,I4,1,1,"polygon",8),la(2,k4,1,1,"polygon",9),pa()),2&e){const e=Sa().index,t=Sa().index;Ts(1),ha("ngIf",(e+t)%2==1),Ts(1),ha("ngIf",(e+t)%2==0)}}function M4(e,t){if(1&e){const e=va();_n(),fa(0,"g",5),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),la(1,T4,2,2,"g",6),la(2,A4,3,2,"g",6),pa()}if(2&e){const e=t.$implicit;Ia("id","click_",t.index,"_",Sa().index,""),Ts(1),ha("ngIf",e.isPlayer()),Ts(1),ha("ngIf",2===e.value)}}function N4(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,M4,3,4,"g",4),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}function R4(e,t){if(1&e&&(_n(),ga(0,"polygon",14)),2&e){const e=t.$implicit,n=Sa(2);Ia("id","possible_landing_",e.x,"_",e.y,""),ra("points",n.getTriangleCoordinate(e.x,e.y))}}function x4(e,t){if(1&e&&(_n(),ga(0,"polygon",15)),2&e){const e=Sa(2);Ia("id","chosen_coord_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),ra("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y))}}function D4(e,t){if(1&e&&(_n(),ma(0),la(1,R4,1,3,"polygon",12),la(2,x4,1,3,"polygon",13),ya()),2&e){const e=Sa();Ts(1),ha("ngForOf",e.possibleLandings),Ts(1),ha("ngIf",e.chosenCoord.isPresent())}}function L4(e,t){if(1&e&&(_n(),ma(0),ga(1,"polygon",16),ga(2,"polygon",16),ya()),2&e){const e=Sa(2);Ts(1),ra("points",e.getTriangleCoordinate(e.lastCoord.get().x,e.lastCoord.get().y)),Ts(1),ra("points",e.getTriangleCoordinate(e.lastMoved.get().x,e.lastMoved.get().y))}}function F4(e,t){1&e&&(_n(),la(0,L4,3,2,"ng-container",6)),2&e&&ha("ngIf",Sa().lastMoved.isPresent())}let U4=(()=>{class e extends jY{constructor(e){super(e),this.lastCoord=Nw.empty(),this.lastMoved=Nw.empty(),this.chosenCoord=Nw.empty(),this.possibleLandings=[],this.rules=new _4(y4),this.availableMinimaxes=[new E4(this.rules,"SaharaMinimax")],this.encoder=C4.encoder,this.tutorial=(new O4).tutorial,this.updateBoard()}cancelMoveAttempt(){this.possibleLandings=[],this.chosenCoord=Nw.empty()}onClick(e,t){var n=this;return Ow(function*(){const r=n.canUserPlay("#click_"+e+"_"+t);if(r.isFailure())return n.cancelMove(r.getReason());const i=n.rules.node.gameState.getCurrentPlayer(),s=WW.ofPlayer(i);return n.chosenCoord.isAbsent()||n.board[t][e]===s?n.choosePiece(e,t):n.chooseLandingCoord(e,t)})()}choosePiece(e,t){if(this.board[t][e]===WW.EMPTY)return this.cancelMove(v4.MUST_CHOOSE_PYRAMID_FIRST());if(this.board[t][e].is(TZ.fromTurn(this.getTurn()))){const n=new GW(e,t);return this.selectPiece(n),Lw.SUCCESS}return this.cancelMove(v4.MUST_CHOOSE_OWN_PYRAMID())}selectPiece(e){this.chosenCoord=Nw.of(e),this.possibleLandings=this.rules.getLandingCoords(this.board,e)}chooseLandingCoord(e,t){var n=this;return Ow(function*(){const r=new GW(e,t),i=C4.from(n.chosenCoord.get(),r);return i.isFailure()?n.cancelMove(i.getReason()):yield n.chooseMove(i.get(),n.rules.node.gameState)})()}updateBoard(){const e=this.rules.node.move;this.lastCoord=e.map(e=>e.coord),this.lastMoved=e.map(e=>e.end),this.board=this.rules.node.gameState.board}getPlayerClassFor(e,t){return this.getPlayerClass(TZ.of(this.board[t][e].value))}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-sahara"]],features:[Go],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],["class","base no-fill small-stroke highlighted",3,"id",4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected",3,"id",4,"ngIf"],[1,"base","no-fill","small-stroke","highlighted",3,"id"],[1,"base","no-fill","small-stroke","selected",3,"id"],[1,"base","no-fill","small-stroke","moved-stroke"]],template:function(e,t){if(1&e&&(_n(),fa(0,"svg",0),la(1,N4,2,1,"g",1),la(2,D4,3,2,"ng-container",2),la(3,F4,1,1,"ng-template",null,3,Ku),pa()),2&e){const e=ca(4);Ts(1),ha("ngForOf",t.board),Ts(1),ha("ngIf",t.chosenCoord.isPresent())("ngIfElse",e)}},directives:[tf,rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class V4 extends lj{constructor(e,t,n,r){super(e,t),this.x=e,this.y=t,this.moveDirection=n,this.landingOrientation=r,this.checkValidity()}checkValidity(){const e=this.coord.isInRange(5,5);if(this.isRotation()){if(!e)throw new Error("Cannot rotate piece outside the board: "+this.toString()+".")}else if(this.coord.getNext(this.moveDirection.get()).isNotInRange(5,5)){if(!e)throw new Error("SiamMove should end or start on the board: "+this.toString()+".");if(this.moveDirection.get()!==this.landingOrientation)throw new Error("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+this.toString()+".")}}isRotation(){return this.moveDirection.isAbsent()}equals(e){return this===e||!(!this.coord.equals(e.coord)||!1===this.moveDirection.equals(e.moveDirection))&&this.landingOrientation===e.landingOrientation}toString(){const e=this.moveDirection.isAbsent()?"-":this.moveDirection.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}isInsertion(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}V4.encoder=new class extends bZ{maxValue(){return 2408}encodeNumber(e){const t=e.coord.y+1,n=e.coord.x+1,r=e.moveDirection.isAbsent()?4:e.moveDirection.get().toInt();return 245*e.landingOrientation.toInt()+49*r+7*n+t}decodeNumber(e){const t=e%7;e-=t;const n=(e/=7)%7;e-=n;const r=(e/=7)%5,i=4===r?Nw.empty():zW.factory.fromInt(r).toOptional();e-=r;const s=zW.factory.fromInt(e/=5).get();return new V4(n-1,t-1,i,s)}};class B4{constructor(e){this.value=e}static decode(e){switch(e){case 0:return B4.EMPTY;case 1:return B4.LIGHT_UP;case 2:return B4.LIGHT_RIGHT;case 3:return B4.LIGHT_DOWN;case 4:return B4.LIGHT_LEFT;case 5:return B4.DARK_UP;case 6:return B4.DARK_RIGHT;case 7:return B4.DARK_DOWN;case 8:return B4.DARK_LEFT;case 9:return B4.MOUNTAIN}}belongTo(e){return e===TZ.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}isEmptyOrMountain(){return 0===this.value||9===this.value}isPiece(){return!this.isEmptyOrMountain()}getOwner(){return 1<=this.value&&this.value<=4?TZ.ZERO:5<=this.value&&this.value<=8?TZ.ONE:IZ.NONE}getOptionalDirection(){switch(this.value){case 0:return Nw.empty();case 1:case 5:return Nw.of(zW.UP);case 2:case 6:return Nw.of(zW.RIGHT);case 3:case 7:return Nw.of(zW.DOWN);case 4:case 8:return Nw.of(zW.LEFT);default:return Tw.expectToBe(this.value,9),Nw.empty()}}static of(e,t){return t===TZ.ZERO?e===zW.UP?B4.LIGHT_UP:e===zW.RIGHT?B4.LIGHT_RIGHT:e===zW.DOWN?B4.LIGHT_DOWN:B4.LIGHT_LEFT:e===zW.UP?B4.DARK_UP:e===zW.RIGHT?B4.DARK_RIGHT:e===zW.DOWN?B4.DARK_DOWN:B4.DARK_LEFT}getDirection(){return this.getOptionalDirection().get()}toString(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return Tw.expectToBe(this.value,9),"MOUNTAIN"}}}B4.EMPTY=new B4(0),B4.LIGHT_UP=new B4(1),B4.LIGHT_RIGHT=new B4(2),B4.LIGHT_DOWN=new B4(3),B4.LIGHT_LEFT=new B4(4),B4.DARK_UP=new B4(5),B4.DARK_RIGHT=new B4(6),B4.DARK_DOWN=new B4(7),B4.DARK_LEFT=new B4(8),B4.MOUNTAIN=new B4(9);class $4 extends sj{static getInitialState(){const e=NZ.createTable(5,5,B4.EMPTY);return e[2][1]=B4.MOUNTAIN,e[2][2]=B4.MOUNTAIN,e[2][3]=B4.MOUNTAIN,new $4(e,0)}countPlayerPawn(){let e=0;for(let t=0;t<5;t++)for(let n=0;n<5;n++)this.board[t][n].belongTo(this.getCurrentPlayer())&&e++;return e}}let z4=(()=>{class e{}return e.CANNOT_INSERT_WHEN_SELECTED=()=>$localize`You cannot insert a piece when you have already selected a piece.`,e.NO_REMAINING_PIECE_TO_INSERT=()=>$localize`You cannot insert a piece, all your pieces are already on the board.`,e.NOT_ENOUGH_FORCE_TO_PUSH=()=>$localize`You do not have enough strength to push.`,e.MUST_MOVE_OR_ROTATE=()=>$localize`You must move or rotate your piece.`,e.ILLEGAL_PUSH=()=>$localize`Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board.`,e.MUST_INSERT_OR_CHOOSE_YOUR_PIECE=()=>$localize`You should insert or choose one of your pieces!`,e})();class H4{constructor(e,t){this.resultingBoard=e,this.moved=t}}let G4=(()=>{class e extends mj{isLegal(t,n){if(Iw(e.VERBOSE,{SiamRules_isLegal:{move:t,state:n}}),!t.isInsertion()&&!n.getPieceAt(t.coord).belongTo(n.getCurrentPlayer()))return Rw.failure(JW.MUST_CHOOSE_PLAYER_PIECE());if(t.isRotation())return Iw(e.VERBOSE,"Move is rotation"),this.isLegalRotation(t,n);{let r;if(t.isInsertion()){Iw(e.VERBOSE,"Move is insertion");const i=this.isLegalInsertion(t.coord,n);if(i.legal.isFailure())return Rw.failure(i.legal.getReason());r=i.insertedPiece}else Iw(e.VERBOSE,"Move is forward"),r=n.getPieceAt(t.coord);return e.isLegalForwarding(t,n,r)}}isLegalInsertion(t,n){const r=n.countPlayerPawn(),i=n.getCurrentPlayer(),s=r<5?Lw.SUCCESS:Lw.failure(z4.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:e.getInsertedPiece(t,i),legal:s}}static getInsertedPiece(e,t){return B4.of(-1===e.x?zW.RIGHT:-1===e.y?zW.DOWN:5===e.x?zW.LEFT:zW.UP,t)}static isLegalForwarding(t,n,r){Iw(e.VERBOSE,{isLegalForwarding:{move:t.toString(),state:n,firstPiece:r}});const i=[];let s=B4.of(t.landingOrientation,n.getCurrentPlayer());const o=t.moveDirection.get();let a=t.coord.getNext(o);if(a.isInRange(5,5)&&n.getPieceAt(a)!==B4.EMPTY&&!1===e.isStraight(r,t))return Iw(e.VERBOSE,"Illegal push because not straight or not pushing anything or leaving the board"),Rw.failure(z4.ILLEGAL_PUSH());let l=Nw.of(o);const c=o.getOpposite();let u=0;const h=n.getCopiedBoard();t.coord.isInRange(5,5)&&(h[t.coord.y][t.coord.x]=B4.EMPTY,i.push(t.coord));let d=a.isInRange(5,5)&&s!==B4.EMPTY;for(;d;){l.equalsValue(o)?u++:l.equalsValue(c)&&u--,Iw(e.VERBOSE,{totalForce:u,movingPiece:s,landingCoord:a});const t=h[a.y][a.x];t===B4.MOUNTAIN&&(u-=.9),h[a.y][a.x]=s,i.push(a),s=t,a=a.getNext(o),l=s.getOptionalDirection(),d=a.isInRange(5,5)&&s!==B4.EMPTY&&u>0}return a.isNotInRange(5,5)&&(Iw(e.VERBOSE,"This movement would push "+s+" outside the board"),l.equalsValue(o)?u++:l.equalsValue(c)&&u--),u<=0?(Iw(e.VERBOSE,"This move is an illegal push: "+h),Rw.failure(z4.NOT_ENOUGH_FORCE_TO_PUSH())):(Iw(e.VERBOSE,"This move is a legal push: "+h),Rw.success(new H4(h,i)))}static isStraight(e,t){const n=e.getDirection();return t.moveDirection.equalsValue(n)&&n===t.landingOrientation}isLegalRotation(t,n){Iw(e.VERBOSE,{isLegalRotation:{rotation:t,state:n}});const r=t.coord,i=n.getPieceAt(r),s=n.getCurrentPlayer();if(i.getDirection()===t.landingOrientation)return Rw.failure(z4.MUST_MOVE_OR_ROTATE());const o=n.getCopiedBoard();return o[r.y][r.x]=B4.of(t.landingOrientation,s),Rw.success(new H4(o,[r]))}applyLegalMove(e,t,n){const r=NZ.copyBiArray(n.resultingBoard);return new $4(r,t.turn+1)}static getBoardValueInfo(t,n){const r=e.getMountainsRowsAndColumns(n),i=r.rows,s=r.columns,o=e.getWinner(n,t,r.nbMountain);if(o.isPlayer())return o===TZ.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};{const t=e.getPushers(n,s,i);let r=Number.MAX_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER;const a=n.getCurrentPlayer();for(const e of t)e.coord.isInRange(5,5)?n.getPieceAt(e.coord).belongTo(TZ.ZERO)?r=Math.min(r,e.distance):o=Math.min(o,e.distance):a===TZ.ZERO?r=Math.min(r,e.distance):o=Math.min(o,e.distance);return{shortestZero:r,shortestOne:o,boardValue:e.getScoreFromShortestDistances(r,o,a)}}}static getScoreFromShortestDistances(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);const r=6-e,i=6-t;return r===i?n.getScoreModifier():r>i?-10*(r+1)+(i+1):10*(i+1)-(r+1)}static getMountainsRowsAndColumns(e){const t=[],n=[];let r=0;for(let i=0;i<5;i++)for(let s=0;s<5;s++)e.getPieceAtXY(s,i)===B4.MOUNTAIN&&(t.includes(i)||t.push(i),n.includes(s)||n.push(s),r++);return{rows:t,columns:n,nbMountain:r}}static getWinner(t,n,r){return 2===r?e.getPusher(t,n.get()):IZ.NONE}static getPusher(t,n){const r=n.coord;let i;i=r.isInRange(5,5)?t.getPieceAt(r.getNext(n.landingOrientation)):e.getInsertedPiece(r,t.getCurrentOpponent());const s=i.getDirection(),o=e.getPusherCoord(t,s,r),a=t.getPieceAt(o).getOwner();return Iw(e.VERBOSE,r.toString()+" belong to "+t.getCurrentOpponent().value+", "+o.toString()+" belong to "+a.value+", "+a.value+" win"),a}static getPusherCoord(e,t,n){let r=n.getNext(t),i=n;for(;r.isInRange(5,5);){n=r,r=r.getNext(t);const s=e.getPieceAt(n);s!==B4.MOUNTAIN&&s.getDirection()===t&&(i=n)}return i}static getPushers(t,n,r){Iw(e.VERBOSE,{getPushers:{state:t,mountainsColumn:n,mountainsRow:r}});let i=[];const s=[];for(const e of n){let t=zW.DOWN,n=new GW(e,4);s.push({direction:t,fallingCoord:n}),t=zW.UP,n=new GW(e,0),s.push({direction:t,fallingCoord:n})}for(const e of r){let t=zW.LEFT,n=new GW(0,e);s.push({direction:t,fallingCoord:n}),t=zW.RIGHT,n=new GW(4,e),s.push({direction:t,fallingCoord:n})}for(const o of s)i=e.addPotentialDirectionPusher(t,o.fallingCoord,o.direction,i);return i}static addPotentialDirectionPusher(t,n,r,i){const s=e.getLineClosestPusher(t,n,r);if(s.isAbsent())return i;const o=s.get(),a=o.distance;return Iw(e.VERBOSE,"new closest challenger"),i.push({coord:o.coord,distance:a}),i}static getLineClosestPusher(t,n,r){Iw(e.VERBOSE,{getDirectionClosestPusher:{state:t,fallingCoord:n,direction:r.toString()}});const i=r.getOpposite();let s=1,o=t.getPieceAt(n),a=n,l=Nw.empty(),c=!1,u=!1,h=0;for(;a.isInRange(5,5)&&!1===c;){const e=t.getPieceAt(a);if(e.isEmptyOrMountain())e===B4.MOUNTAIN?(h+=.9,u=!0):s++;else{const t=e.getDirection();t===r?u&&(h-=1,h<=0&&(c=!0,a=a.getNext(r))):t===i?(h+=1,u||s++):u?(l=Nw.of(a),o!==B4.EMPTY&&s++):s++}o=e,a=a.getPrevious(r)}if(!1===c&&l.isPresent())for(s++,h-=1;!1===a.equals(l.get());)a=a.getNext(r),s--;return a.isNotInRange(5,5)&&(h-=1,5===t.countPlayerPawn())||h>0?Nw.empty():Nw.of({distance:s,coord:a})}static getPushingInsertions(e){const t=[],n=e.getCurrentPlayer(),r=[],i=[];for(let s=0;s<5;s++)r.push(new V4(-1,s,Nw.of(zW.RIGHT),zW.RIGHT)),i.push(B4.of(zW.RIGHT,n)),r.push(new V4(5,s,Nw.of(zW.LEFT),zW.LEFT)),i.push(B4.of(zW.LEFT,n)),r.push(new V4(s,-1,Nw.of(zW.DOWN),zW.DOWN)),i.push(B4.of(zW.DOWN,n)),r.push(new V4(s,5,Nw.of(zW.UP),zW.UP)),i.push(B4.of(zW.UP,n));for(let s=0;s<r.length;s++)this.isLegalForwarding(r[s],e,i[s]).isSuccess()&&t.push(r[s]);return t}static getDerapingInsertions(e){const t=[],n=e.getCurrentPlayer();let r,i,s;for(let o=1;o<=3;o++)r=new V4(-1,o,Nw.of(zW.RIGHT),zW.UP),i=B4.of(zW.UP,n),s=this.isLegalForwarding(r,e,i),s.isSuccess()&&(t.push(r),r=new V4(-1,o,Nw.of(zW.RIGHT),zW.DOWN),i=B4.of(zW.DOWN,n),s=this.isLegalForwarding(r,e,i),t.push(r)),r=new V4(5,o,Nw.of(zW.LEFT),zW.UP),i=B4.of(zW.UP,n),s=this.isLegalForwarding(r,e,i),s.isSuccess()&&(t.push(r),r=new V4(5,o,Nw.of(zW.LEFT),zW.DOWN),i=B4.of(zW.DOWN,n),s=this.isLegalForwarding(r,e,i),t.push(r));for(let o=1;o<=3;o++)r=new V4(o,-1,Nw.of(zW.DOWN),zW.LEFT),i=B4.of(zW.LEFT,n),s=this.isLegalForwarding(r,e,i),s.isSuccess()&&(t.push(r),r=new V4(o,-1,Nw.of(zW.DOWN),zW.RIGHT),i=B4.of(zW.RIGHT,n),s=this.isLegalForwarding(r,e,i),t.push(r)),r=new V4(o,5,Nw.of(zW.UP),zW.LEFT),i=B4.of(zW.LEFT,n),s=this.isLegalForwarding(r,e,i),s.isSuccess()&&(t.push(r),r=new V4(o,5,Nw.of(zW.UP),zW.RIGHT),i=B4.of(zW.RIGHT,n),s=this.isLegalForwarding(r,e,i),t.push(r));return t}static getCoordDirection(e,t,n){const r=new GW(t,n);return this.getInsertedPiece(r,e.getCurrentPlayer()).getDirection()}static getMovesFrom(t,n,r,i){const s=[],o=n.getDirection();for(const a of zW.ORTHOGONALS){if(a!==o){const e=new V4(r,i,Nw.empty(),a);s.push(e)}let l;l=new GW(r+a.x,i+a.y).isInRange(5,5)?zW.ORTHOGONALS:[a];for(const o of l){const l=new V4(r,i,Nw.of(a),o);e.isLegalForwarding(l,t,n).isSuccess()&&s.push(l)}}return s}getGameStatus(t){const n=e.getMountainsRowsAndColumns(t.gameState),r=e.getWinner(t.gameState,t.move,n.nbMountain);return r.isPlayer()?gj.getVictory(r):gj.ONGOING}}return e.VERBOSE=!1,e})();class Z4 extends ej{getBoardValue(e){return new tj(G4.getBoardValueInfo(e.move,e.gameState).boardValue)}getListMoves(e){let t=[];const n=e.gameState.getCurrentPlayer();for(let r=0;r<5;r++)for(let i=0;i<5;i++){const s=e.gameState.getPieceAtXY(i,r);s.belongTo(n)&&(t=t.concat(G4.getMovesFrom(e.gameState,s,i,r)))}return e.gameState.countPlayerPawn()<5&&(t=t.concat(G4.getPushingInsertions(e.gameState)),t=t.concat(G4.getDerapingInsertions(e.gameState))),Iw(G4.VERBOSE,{getListMovesResult:t}),t}}const q4=B4.EMPTY,W4=B4.MOUNTAIN,j4=B4.LIGHT_UP,Y4=B4.LIGHT_LEFT,K4=B4.LIGHT_RIGHT,Q4=B4.LIGHT_DOWN,X4=B4.DARK_UP,J4=B4.DARK_LEFT,e5=B4.DARK_RIGHT,t5=B4.DARK_DOWN;class n5{constructor(){this.tutorial=[_j.informational($localize`Goal of the game`,$localize`The goal at Siam is to be the first to push a mountain out of the board.
        The initial board contains three mountains, and no pieces are initially on the board.
        During its turn, a player can do one of the following three actions:
        <ol>
            <li>Put a new piece on the board.</li>
            <li>Change the orientation of one of its piece, and optionally move it.</li>
            <li>Take one of its pieces out of the board.</li>
        </ol>`,$4.getInitialState()),_j.anyMove($localize`Inserting a piece`,$localize`Each player has 5 pieces in total.
        As long as you do not have 5 pieces on the board, you can insert new pieces. To do so:
        <ol>
            <li>Click on one of the big arrows alongside the board.</li>
            <li>Click on one of the small arrows that appeared on the landing square of your piece.
                This is the direction in which your piece will be oriented.</li>
        </ol><br/>
        Insert a piece on the board.`,$4.getInitialState(),new V4(2,-1,Nw.of(zW.DOWN),zW.DOWN),$localize`Congratulations!`),_j.fromMove($localize`Moving a piece`,$localize`We will distinguish here "moving" and "pushing".
        A move is made from a piece's square to an empty neighboring square, horizontally or vertically.
        During that move, you can also move the piece out of the board.
        To move a piece:
        <ol>
            <li>Click on it.</li>
            <li>Click on one of the 4 arrows to pick the direction in which it will move.
                You can also click on the middle dot to change the piece's orientation without moving it.</li>
            <li>Click on one of the 4 arrows on the landing square to pick its orientation.</li>
        </ol><br/>
        Try to move the piece that is on the board one square upwards and to orient it downwards.`,new $4([[q4,q4,q4,q4,q4],[q4,q4,q4,q4,q4],[q4,W4,W4,W4,q4],[q4,q4,q4,q4,q4],[q4,q4,j4,q4,q4]],0),[new V4(2,4,Nw.of(zW.UP),zW.DOWN)],$localize`Congratulations, you made a side-slip!`,$localize`Failed!`),_j.fromMove($localize`Moving a piece out of the board`,$localize`To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>
        Get that piece out of the board!`,new $4([[q4,q4,q4,q4,q4],[q4,q4,q4,q4,q4],[q4,W4,W4,W4,q4],[q4,q4,q4,q4,q4],[q4,q4,j4,q4,q4]],0),[new V4(2,4,Nw.of(zW.DOWN),zW.DOWN)],$localize`Congratulations, even if in this context it was not a useful move.`,$localize`Failed, the piece is still on the board.`),_j.fromMove($localize`Pushing`,$localize`When the landing square of your move is occupied, we use the term "push".
        In order to push, multiple conditions must hold:
        <ol>
            <li>Your piece must already be oriented in the direction of the push.</li>
            <li>The number of the pieces (opponent's or not) that are facing yours (called the resistants)
                must be smaller than the number of pieces that are oriented in the same direction as the push, yourself included (the pushers).</li>
            <li>The number of mountains on that line must be smaller or equal to the difference between the pushers and the resistants.</li>
        </ol>
        Your piece on the top right cannot push because there is one mountain too much.
        Your piece on the bottom right can push.<br/><br/>
        Do it.`,new $4([[K4,W4,W4,J4,Y4],[q4,q4,q4,q4,q4],[q4,q4,q4,W4,q4],[q4,q4,q4,q4,q4],[q4,q4,e5,J4,Y4]],0),[new V4(4,4,Nw.of(zW.LEFT),zW.LEFT)],$localize`Congratulations!`,$localize`Failed!`),_j.fromMove($localize`Victory`,$localize`The game ends when a mountain is pushed out of the board.
        If you pushed it and nobody is in front of you, you're the winner.
        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.
        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>
        You have two ways of ending the game here: you can either win, or lose. Choose correctly!`,new $4([[q4,q4,q4,q4,q4],[q4,q4,q4,q4,q4],[W4,X4,Y4,q4,Q4],[q4,q4,q4,q4,t5],[q4,q4,q4,q4,W4]],0),[new V4(2,2,Nw.of(zW.LEFT),zW.LEFT)],$localize`Congratulations, you won!`,$localize`Failed, you lost.`)]}}function r5(e,t){if(1&e){const e=va();_n(),fa(0,"use",7),Ea("click",function(){const t=Gt(e).$implicit;return Sa(3).insertAt(t.x,t.y)}),pa()}if(2&e){const e=t.$implicit,n=Sa(3);Ia("id","insertAt_",e.x,"_",e.y,""),ra("transform",n.getInsertionArrowTransform(e.x+1,e.y+1,e.dir))}}const i5=function(e,t){return{dir:"DOWN",x:e,y:t}},s5=function(e){return{dir:"UP",x:e,y:5}},o5=function(e,t){return{dir:"RIGHT",x:e,y:t}},a5=function(e){return{dir:"LEFT",x:5,y:e}},l5=function(e,t,n,r){return[e,t,n,r]};function c5(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,r5,1,3,"use",6),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",bu(11,l5,Su(1,i5,e,-1),Pu(4,s5,e),Su(6,o5,-1,e),Pu(9,a5,e)))}}const u5=function(){return[0,1,2,3,4]};function h5(e,t){1&e&&(_n(),ma(0),la(1,c5,2,16,"g",5),ya()),2&e&&(Ts(1),ha("ngForOf",wu(1,u5)))}function d5(e,t){if(1&e){const e=va();_n(),fa(0,"use",13),Ea("click",function(){const t=Gt(e).$implicit;return Sa(5).chooseDirection(t)}),pa()}if(2&e){const e=t.$implicit,n=Sa(3).index,r=Sa().index,i=Sa();Ta("id","chooseDirection_",e,""),ra("transform",i.getArrowTransform(n+1,r+1,e))}}const f5=function(){return["RIGHT","DOWN","LEFT","UP"]};function p5(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"circle",11),Ea("click",function(){return Gt(e),Sa(4).chooseDirection("")}),pa(),la(2,d5,1,2,"use",12),pa()}if(2&e){const e=Sa(2).index,t=Sa().index,n=Sa();Ts(1),ra("cx",(e+1)*n.SPACE_SIZE+n.SPACE_SIZE/2)("cy",(t+1)*n.SPACE_SIZE+n.SPACE_SIZE/2),Ts(1),ha("ngForOf",wu(3,f5))}}function g5(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"use",10),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().clickPiece(t,n)}),pa(),la(2,p5,3,4,"g",4),pa()}if(2&e){const e=Sa(),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();Ts(1),Ia("id","clickPiece_",t,"_",r,""),ha("ngClass",i.getPieceClasses(n)),ra("transform",i.getPieceTransform(t,r)),Ts(1),ha("ngIf",i.choosingDirection(t,r))}}function m5(e,t){if(1&e){const e=va();_n(),fa(0,"use",14),Ea("click",function(){Gt(e);const t=Sa().index,n=Sa().index;return Sa().clickPiece(t,n)}),pa()}if(2&e){const e=Sa().index,t=Sa().index,n=Sa();ra("transform","translate("+(e+1)*n.SPACE_SIZE+" "+(t+1)*n.SPACE_SIZE+")")}}function y5(e,t){if(1&e){const e=va();_n(),fa(0,"use",13),Ea("click",function(){const t=Gt(e).$implicit;return Sa(4).chooseOrientation(t)}),pa()}if(2&e){const e=t.$implicit,n=Sa(2).index,r=Sa().index,i=Sa();Ta("id","chooseOrientation_",e,""),ra("transform",i.getArrowTransform(n+1,r+1,e))}}function v5(e,t){1&e&&(_n(),fa(0,"g"),la(1,y5,1,2,"use",12),pa()),2&e&&(Ts(1),ha("ngForOf",wu(1,f5)))}function C5(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",8),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().insertAt(t,n)}),pa(),la(2,g5,3,5,"g",4),la(3,m5,1,1,"use",9),la(4,v5,2,2,"g",4),pa()}if(2&e){const e=t.$implicit,n=t.index,r=Sa().index,i=Sa();Ts(1),Ia("id","insertAt_",n,"_",r,""),ha("ngClass",i.getSquareClasses(n,r)),ra("x",i.SPACE_SIZE*(n+1))("y",i.SPACE_SIZE*(r+1))("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),Ts(1),ha("ngIf",e.isPiece()),Ts(1),ha("ngIf",i.isMountain(e)),Ts(1),ha("ngIf",i.choosingOrientation(n,r))}}function _5(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,C5,5,10,"g",5),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}let E5=(()=>{class e extends tY{constructor(e){super(e),this.lastMove=Nw.empty(),this.chosenCoord=Nw.empty(),this.landingCoord=Nw.empty(),this.chosenDirection=Nw.empty(),this.chosenOrientation=Nw.empty(),this.movedPieces=[],this.rules=new G4($4),this.availableMinimaxes=[new Z4(this.rules,"SiamMinimax")],this.encoder=V4.encoder,this.tutorial=(new n5).tutorial,this.updateBoard()}updateBoard(){if(Iw(e.VERBOSE,"updateBoard"),this.board=this.rules.node.gameState.board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){const e=this.rules.node.mother.get().gameState;this.movedPieces=this.rules.isLegal(this.lastMove.get(),e).get().moved}else this.movedPieces=[]}cancelMoveAttempt(){this.chosenCoord=Nw.empty(),this.chosenDirection=Nw.empty(),this.landingCoord=Nw.empty(),this.chosenOrientation=Nw.empty()}clickPiece(e,t){const n=this.canUserPlay("#clickPiece_"+e+"_"+t);return n.isFailure()?this.cancelMove(n.getReason()):this.board[t][e].getOwner()!==this.getCurrentPlayer()?this.cancelMove(JW.MUST_CHOOSE_PLAYER_PIECE()):(this.chosenCoord=Nw.of(new GW(e,t)),Lw.SUCCESS)}chooseDirection(t){var n=this;return Ow(function*(){Iw(e.VERBOSE,"SiamComponent.chooseDirection("+t+")");const r=n.canUserPlay("#chooseDirection_"+t);if(r.isFailure())return n.cancelMove(r.getReason());if(""===t)n.chosenDirection=Nw.empty(),n.landingCoord=n.chosenCoord;else{const r=zW.factory.fromString(t).get();if(n.chosenDirection=Nw.of(r),n.landingCoord=Nw.of(n.chosenCoord.get().getNext(r)),n.landingCoord.get().isNotInRange(5,5))return Iw(e.VERBOSE,"orientation and direction should be the same: "+r),n.chosenOrientation=Nw.of(r),yield n.tryMove()}return Lw.SUCCESS})()}chooseOrientation(t){var n=this;return Ow(function*(){Iw(e.VERBOSE,"SiamComponent.chooseOrientation("+t+")");const r=n.canUserPlay("#chooseOrientation_"+t);return r.isFailure()?n.cancelMove(r.getReason()):(n.chosenOrientation=Nw.of(zW.factory.fromString(t).get()),yield n.tryMove())})()}insertAt(t,n){var r=this;return Ow(function*(){Iw(e.VERBOSE,"SiamComponent.insertAt("+t+", "+n+")");const i=r.canUserPlay("#insertAt_"+t+"_"+n);if(i.isFailure())return r.cancelMove(i.getReason());if(r.chosenCoord.isPresent())return r.cancelMove(z4.CANNOT_INSERT_WHEN_SELECTED());{const e=new GW(t,n);if(r.getState().isOnBoard(e)&&r.getState().getPieceAtXY(t,n).isEmptyOrMountain())return r.cancelMove(z4.MUST_INSERT_OR_CHOOSE_YOUR_PIECE());r.chosenCoord=Nw.of(e);const i=G4.getCoordDirection(r.getState(),t,n);return r.chosenDirection=Nw.of(i),r.landingCoord=Nw.of(r.chosenCoord.get().getNext(i)),Lw.SUCCESS}})()}tryMove(){var e=this;return Ow(function*(){const t=e.chosenCoord.get(),n=new V4(t.x,t.y,e.chosenDirection,e.chosenOrientation.get());return e.cancelMove(),yield e.chooseMove(n,e.rules.node.gameState)})()}isMountain(e){return e===B4.MOUNTAIN}choosingOrientation(t,n){const r=new GW(t,n);return!!(this.chosenCoord.isPresent()&&this.landingCoord.equalsValue(r)&&this.chosenOrientation.isAbsent())&&(Iw(e.VERBOSE,"choosing orientation now"),!0)}choosingDirection(t,n){const r=new GW(t,n);return!!(this.chosenCoord.equalsValue(r)&&this.chosenDirection.isAbsent()&&this.landingCoord.isAbsent()&&this.chosenOrientation.isAbsent())&&(Iw(e.VERBOSE,"choosing direction now"),!0)}getInsertionArrowTransform(e,t,n){const r=`rotate(${90*(zW.factory.fromString(n).get().toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",r].join(" ")}getPieceTransform(e,t){const n=`rotate(${90*(this.board[t][e].getDirection().toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return["translate("+(e+1)*this.SPACE_SIZE+", "+(t+1)*this.SPACE_SIZE+")",n].join(" ")}getArrowTransform(e,t,n){return W3.getArrowTransform(this.SPACE_SIZE,new GW(e,t),zW.factory.fromString(n).get())}getPieceClasses(e){return[this.getPlayerClass(e.getOwner())]}getSquareClasses(e,t){const n=new GW(e,t);return this.movedPieces.some(e=>e.equals(n))?["moved"]:[]}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-siam"]],features:[Go],decls:7,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 700 700","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 93, 90 50, 70 50, 70 7, 27.5 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngIf"],[4,"ngFor","ngForOf"],[0,"xlink","href","#arrow","class","base mid-stroke",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","click"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#mountain","fill","brown",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],["id","chooseDirection_","r","8",1,"arrow","selected-fill","no-stroke",3,"click"],["class","arrow selected-fill no-stroke",0,"xlink","href","#triangle",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"arrow","selected-fill","no-stroke",3,"id","click"],[0,"xlink","href","#mountain","fill","brown",3,"click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),fa(1,"defs"),ga(2,"polygon",1),ga(3,"polygon",2),ga(4,"polygon",3),pa(),la(5,h5,2,2,"ng-container",4),la(6,_5,2,1,"g",5),pa()),2&e&&(Ts(5),ha("ngIf",t.isPlayerTurn()),Ts(1),ha("ngForOf",t.board))},directives:[rf,tf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})(),w5=(()=>{class e{}return e.NO_MOVEMENT_BEFORE_TURN_40=()=>$localize`You cannot move yet. Pick a space where you will put a new piece.`,e.MUST_CUT=()=>$localize`Several groups are of the same size, you must pick the one to keep.`,e.CANNOT_CHOOSE_TO_KEEP=()=>$localize`You cannot choose which part to keep when one is smaller than the other.`,e.CAN_NO_LONGER_DROP=()=>$localize`You cannot put new pieces anymore. Pick a piece to move.`,e.MUST_CAPTURE_BIGGEST_GROUPS=()=>$localize`You must choose one of the biggest groups to keep it.`,e.CANNOT_KEEP_EMPTY_COORD=()=>$localize`You cannot pick an empty space. Pick one of the biggest groups.`,e.MUST_DROP_NEXT_TO_OTHER_PIECE=()=>$localize`You must put this piece next to another piece.`,e})();class P5 extends ij{constructor(e,t,n){super(t),this.pieces=e;const r=this.getCalculatedScale();this.pieces=r.pieces,this.width=r.width,this.height=r.height,this.offset=n??r.offset,this.pieces.makeImmutable()}static getInitialState(){return P5.fromRepresentation([[TZ.ZERO.value],[TZ.ONE.value]],0)}static fromRepresentation(e,t,n){const r=new dj;for(let i=0;i<e.length;i++)for(let t=0;t<e[0].length;t++)e[i][t]!==IZ.NONE.value&&r.set(new GW(t,i),TZ.of(e[i][t]));return new P5(r,t,n)}static deplacePiece(e,t){const n=e.pieces.getCopy();return n.delete(t.start.get()),n.set(t.landing,e.getCurrentPlayer()),n}static getGroups(e,t){let n=new dj,r=0;for(const o of jW.factory.all){const i=t.getNext(o,1);n=P5.putCoordInGroup(e,i,n,""+r),r++}const i=n.reverse(),s=new rj;for(let o=0;o<i.size();o++)s.add(i.getByIndex(o).value);return s}static putCoordInGroup(e,t,n,r){if(e.get(t).isPresent()&&n.get(t).isAbsent()){n.set(t,r);for(const i of jW.factory.all){const s=t.getNext(i,1);n=P5.putCoordInGroup(e,s,n,r)}}return n}getCalculatedScale(){let e=Number.MAX_SAFE_INTEGER,t=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER;for(const o of this.pieces.listKeys())e=Math.min(o.x,e),t=Math.max(o.x,t),n=Math.min(o.y,n),r=Math.max(o.y,r);let i=new dj;const s=new UW(-e,-n);if(0!==e||0!==n)for(const o of this.pieces.listKeys()){const e=this.pieces.delete(o),t=o.getNext(s);i.set(t,e)}else i=this.pieces;return{width:t+1-e,height:r+1-n,pieces:i,offset:s}}toRepresentation(){const e=NZ.createTable(this.width,this.height,IZ.NONE.value);for(const t of this.pieces.listKeys()){const n=this.getPieceAt(t).value;e[t.y][t.x]=n}return e}isIllegalLandingZone(e,t){return this.pieces.containsKey(e)?Lw.failure(JW.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?Lw.SUCCESS:Lw.failure(w5.MUST_DROP_NEXT_TO_OTHER_PIECE())}isCoordConnected(e,t){for(const n of jW.factory.all){const r=e.getNext(n,1);if(this.pieces.containsKey(r)&&!1===t.equalsValue(r))return!0}return!1}isOnBoard(e){return this.pieces.containsKey(e)}getPieceAt(e){return this.isOnBoard(e)?this.pieces.get(e).get():IZ.NONE}applyLegalDrop(e){const t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new P5(t,this.turn+1)}applyLegalDeplacement(e,t){const n=P5.deplacePiece(this,e);let r=new dj;if(t.size()>0){r=new dj;for(const e of t)r.set(e,n.get(e).get())}else r=n.getCopy();return new P5(r,this.turn+1)}countPieces(){const e=this.pieces.reverse(),t=e.get(TZ.ZERO).getOrElse(new TY),n=e.get(TZ.ONE).getOrElse(new TY);return[t.size(),n.size()]}switchPiece(e){const t=this.pieces.getCopy(),n=this.getPieceAt(e);if(n.isPlayer())return t.replace(e,n.getOpponent()),new P5(t,this.turn,this.offset);uZ.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:e.toString()})}equals(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}class S5 extends aj{constructor(e,t,n){if(super(),this.start=e,this.landing=t,this.keep=n,e.equalsValue(t))throw new Error("Deplacement cannot be static!");if(e.isPresent()&&e.equals(n))throw new Error("Cannot keep starting coord, since it will always be empty after move!")}static fromDrop(e){return new S5(Nw.empty(),e,Nw.empty())}static fromMovement(e,t){return new S5(Nw.of(e),t,Nw.empty())}static fromCut(e,t,n){return new S5(Nw.of(e),t,Nw.of(n))}isDrop(){return this.start.isAbsent()}isCut(){return this.keep.isPresent()}toString(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}equals(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}S5.encoder=new class extends SZ{encodeMove(e){return{start:e.start.isPresent()?GW.encoder.encode(e.start.get()):null,landing:GW.encoder.encode(e.landing),keep:e.keep.isPresent()?GW.encoder.encode(e.keep.get()):null}}decodeMove(e){const t=e;if("object"!=typeof e)throw new Error("Invalid encodedMove of type "+typeof e+"!");const n=GW.encoder.decode(t.landing);if(null==t.start)return S5.fromDrop(n);const r=GW.encoder.decode(t.start);if(null==t.keep)return S5.fromMovement(r,n);{const e=GW.encoder.decode(t.keep);return S5.fromCut(r,n,e)}}};class b5 extends mj{constructor(){super(...arguments),this.VERBOSE=!1}applyLegalMove(e,t,n){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,n)}isLegal(e,t){Iw(this.VERBOSE,{called:"SixRules.isLegal",move:e,state:t});const n=t.isIllegalLandingZone(e.landing,e.start);return n.isFailure()?n.toFailedFallible():t.turn<40?this.isLegalDrop(e,t):b5.isLegalPhaseTwoMove(e,t)}static getLegalLandings(e){const t=new TY;for(const n of e.pieces.listKeys())for(const r of jW.factory.all){const i=n.getNext(r,1);e.getPieceAt(i)===IZ.NONE&&t.add(i)}return t.toList()}isLegalDrop(e,t){return!1===e.isDrop()?Rw.failure(w5.NO_MOVEMENT_BEFORE_TURN_40()):Rw.success(t.pieces.getKeySet())}static isLegalPhaseTwoMove(e,t){if(e.isDrop())return Rw.failure(w5.CAN_NO_LONGER_DROP());switch(t.getPieceAt(e.start.get())){case IZ.NONE:return Rw.failure(JW.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());case t.getCurrentOpponent():return Rw.failure(JW.CANNOT_CHOOSE_OPPONENT_PIECE())}const n=P5.deplacePiece(t,e),r=P5.getGroups(n,e.start.get());if(b5.isSplit(r)){const t=this.getBiggerGroups(r);return 1===t.size()?e.keep.isPresent()?Rw.failure(w5.CANNOT_CHOOSE_TO_KEEP()):Rw.success(t.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,t,n)}return Rw.success(new TY)}static isSplit(e){return e.size()>1}static getBiggerGroups(e){let t=0,n=new rj;for(const r of e){const e=r.size();e>t?(t=e,n=new rj([r])):e===t&&n.add(r)}return n}static moveKeepBiggerGroup(e,t,n){if(e.isAbsent())return Rw.failure(w5.MUST_CUT());if(n.get(e.get()).isAbsent())return Rw.failure(w5.CANNOT_KEEP_EMPTY_COORD());const r=e.get();for(const i of t)if(i.contains(r))return Rw.success(i);return Rw.failure(w5.MUST_CAPTURE_BIGGEST_GROUPS())}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();let r=[];if(e.move.isPresent()&&(r=this.getShapeVictory(e.move.get(),t)),6===r.length)return gj.getVictory(n);if(t.turn>39){const e=t.countPieces(),n=e[0],r=e[1];return n<6&&r<6?n<r?gj.ONE_WON:r<n?gj.ZERO_WON:gj.DRAW:n<6?gj.getDefeat(TZ.ZERO):r<6?gj.getDefeat(TZ.ONE):gj.ONGOING}return gj.ONGOING}startSearchingVictorySources(){Iw(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}getShapeVictory(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();const n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const r=t.landing.getNext(n.offset,1);switch(Iw(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}searchVictoryOnlyForCircle(e,t,n){Iw(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});const r=n.getCurrentOpponent(),i=[t];let s=t.getNext(jW.factory.all[e],1);for(;i.length<6;){if(n.getPieceAt(s)!==r)return[];const t=(e+i.length)%6;i.push(s),s=s.getNext(jW.factory.all[t],1)}return i}searchVictoryOnlyForLine(e,t,n){const r=n.getCurrentOpponent();let i=jW.factory.all[e],s=t.getNext(i,1);const o=[t];let a=!1;for(;o.length<6;){if(n.getPieceAt(s)===r)o.push(s);else{if(a)return[];a=!0,i=i.getOpposite(),s=s.getNext(i,o.length)}s=s.getNext(i,1)}return o}searchVictoryOnlyForTriangleCorner(e,t,n){Iw(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});const r=n.getCurrentOpponent();let i=jW.factory.all[e];const s=[t];let o=t.getNext(i,1);for(;s.length<6;){if(n.getPieceAt(o)!==r)return[];s.length%2==0&&(i=jW.factory.all[(e+s.length)%6]),s.push(o),o=o.getNext(i,1)}return s}searchVictoryOnlyForTriangleEdge(e,t,n){Iw(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});const r=n.getCurrentOpponent();let i=jW.factory.all[e];const s=[t];let o=t.getNext(i,1);for(;s.length<6;){if(n.getPieceAt(o)!==r)return[];s.push(o),s.length%2==0&&(i=jW.factory.all[(e+s.length)%6]),o=o.getNext(i,1)}return s}}class O5 extends ej{calculateBoardValue(e,t){this.startSearchingVictorySources();let n={status:uj.DEFAULT,victory:Nw.empty(),preVictory:Nw.empty(),sum:0};for(;this.hasNextVictorySource();){const r=this.getNextVictorySource();let i;if(i=n.status===uj.PRE_VICTORY?this.searchVictoryOnly(r,e,t):this.getBoardInfo(r,e,t,n),i.status===uj.VICTORY)return i;n={status:i.status,victory:Nw.empty(),preVictory:i.preVictory,sum:n.sum+i.sum}}return n}}class T5 extends tj{constructor(e,t){super(e),this.value=e,this.preVictory=t}}class I5 extends O5{constructor(){super(...arguments),this.VERBOSE=!1}static get(){if(I5.singleton.isAbsent()){const e=new b5(P5);I5.singleton=Nw.of(new I5(e,"SixMinimax"))}return I5.singleton.get()}getListMoves(e){const t=I5.get(),n=e.getOwnValue(t);if(n.preVictory.isPresent())return e.gameState.turn<40?this.createForcedDrop(n):this.createForcedDeplacement(e,n);const r=b5.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrop(r):this.getListDeplacement(e.gameState,r)}createForcedDrop(e){Iw(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:e});const t=[],n=S5.fromDrop(e.preVictory.get());return t.push(n),t}createForcedDeplacement(e,t){Iw(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:e});const n=this.getSafelyMovablePieceOrFirstOne(e),r=[t.preVictory.get()];return this.getDeplacementFrom(e.gameState,n,r)}getDeplacementFrom(e,t,n){const r=[];for(const i of t)for(const t of n){const n=S5.fromMovement(i,t);if(e.isCoordConnected(t,Nw.of(i))){const s=P5.deplacePiece(e,n),o=P5.getGroups(s,n.start.get());if(b5.isSplit(o))for(const e of o){const n=e.getAnyElement().get(),s=S5.fromCut(i,t,n);r.push(s)}else r.push(n)}}return r}getSafelyMovablePieceOrFirstOne(e){const t=e.gameState,n=t.pieces.reverse(),r=t.getCurrentPlayer(),i=n.get(r).get(),s=i.getAnyElement().get(),o=[];for(const a of i)!1===this.isPieceBlockingAVictory(t,a)&&o.push(a);return new TY(0===o.length?[s]:o)}isPieceBlockingAVictory(e,t){const n=e.switchPiece(t),r=S5.fromDrop(t);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,r,n).status===uj.VICTORY)return!0;return!1}getListDrop(e){const t=[];for(const n of e){const e=S5.fromDrop(n);t.push(e)}return t}getListDeplacement(e,t){const n=e.getCurrentPlayer(),r=e.pieces.reverse().get(n).get();return this.getDeplacementFrom(e,r,t)}getBoardValue(e){const t=e.move,n=e.gameState,r=n.getCurrentOpponent(),i=r.getVictoryValue();let s={status:uj.DEFAULT,victory:Nw.empty(),preVictory:Nw.empty(),sum:0};t.isPresent()&&(s=this.calculateBoardValue(t.get(),n));let o=Nw.empty();if(s.status===uj.DEFAULT&&s.preVictory.isPresent()&&(o=Nw.of(s.preVictory.get())),s.status===uj.VICTORY)return new T5(i,Nw.empty());if(n.turn>39){const e=n.countPieces(),t=e[0],r=e[1];return t<6&&r<6?new T5(t<r?TZ.ONE.getVictoryValue():r<t?TZ.ZERO.getVictoryValue():0,Nw.empty()):t<6?new T5(TZ.ZERO.getDefeatValue(),Nw.empty()):r<6?new T5(TZ.ONE.getDefeatValue(),Nw.empty()):new T5(t-r,o)}return new T5(s.status===uj.PRE_VICTORY?r.getPreVictory():s.sum*r.getScoreModifier(),o)}startSearchingVictorySources(){Iw(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const r=t.landing.getNext(n.offset,1);switch(Iw(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}searchVictoryOnlyForCircle(e,t,n){Iw(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});const r=n.getCurrentOpponent(),i=[t];let s=t.getNext(jW.factory.all[e],1);for(;i.length<6;){if(n.getPieceAt(s)!==r)return{status:uj.PRE_VICTORY,victory:Nw.empty(),preVictory:Nw.empty(),sum:0};const t=(e+i.length)%6;i.push(s),s=s.getNext(jW.factory.all[t],1)}return{status:uj.VICTORY,victory:Nw.of(i),preVictory:Nw.empty(),sum:0}}searchVictoryOnlyForLine(e,t,n){const r=n.getCurrentOpponent();let i=jW.factory.all[e],s=t.getNext(i,1);const o=[t];let a=!1;for(;o.length<6;){if(n.getPieceAt(s)===r)o.push(s);else{if(a)return{status:uj.PRE_VICTORY,victory:Nw.empty(),preVictory:Nw.empty(),sum:0};a=!0,i=i.getOpposite(),s=s.getNext(i,o.length-1)}s=s.getNext(i,1)}return{status:uj.VICTORY,victory:Nw.of(o),preVictory:Nw.empty(),sum:0}}searchVictoryOnlyForTriangleCorner(e,t,n){Iw(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});const r=n.getCurrentOpponent();let i=jW.factory.all[e];const s=[t];let o=t.getNext(i,1);for(;s.length<6;){if(n.getPieceAt(o)!==r)return{status:uj.PRE_VICTORY,victory:Nw.empty(),preVictory:Nw.empty(),sum:0};s.length%2==0&&(i=jW.factory.all[(e+s.length)%6]),s.push(o),o=o.getNext(i,1)}return{status:uj.VICTORY,victory:Nw.of(s),preVictory:Nw.empty(),sum:0}}searchVictoryOnlyForTriangleEdge(e,t,n){Iw(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});const r=n.getCurrentOpponent();let i=jW.factory.all[e];const s=[t];let o=t.getNext(i,1);for(;s.length<6;){if(n.getPieceAt(o)!==r)return{status:uj.PRE_VICTORY,victory:Nw.empty(),preVictory:Nw.empty(),sum:0};s.push(o),s.length%2==0&&(i=jW.factory.all[(e+s.length)%6]),o=o.getNext(i,1)}return{status:uj.VICTORY,victory:Nw.of(s),preVictory:Nw.empty(),sum:0}}getBoardInfo(e,t,n,r){Iw(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:e,move:t,state:n,boardInfo:r});const i=t.landing.getNext(n.offset,1);switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,i,n,r);case"LINE":return this.getBoardInfoForLine(e.index,i,n,r);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,i,n,r);default:return this.getBoardInfoForTriangleEdge(e.index,i,n,r)}}getBoardInfoForCircle(e,t,n,r){Iw(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:e,lastDrop:t,state:n,boardInfo:r});const i=n.getCurrentPlayer(),s=[t];let o=t.getNext(jW.factory.all[e],1),a=0,l=Nw.empty();for(;s.length<6;){const t=n.getPieceAt(o);if(t===i)return r;const c=(e+s.length)%6;s.push(o);const u=jW.factory.all[c];t===IZ.NONE?(a+=.16,l=Nw.of(o)):a++,o=o.getNext(u,1)}return this.getBoardInfoResult(a,l,s,r)}getBoardInfoResult(e,t,n,r){let i=r.preVictory;if(4.16===e){if(Iw(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(t))return{status:uj.PRE_VICTORY,victory:Nw.empty(),preVictory:Nw.empty(),sum:0};i=t}else if(5===e)return{status:uj.VICTORY,victory:Nw.of(n),preVictory:Nw.empty(),sum:0};return{status:r.status,victory:Nw.empty(),preVictory:i,sum:r.sum+e}}getBoardInfoForLine(e,t,n,r){Iw(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:e,lastDrop:t,state:n,boardInfo:r});const i=jW.factory.all[e];let s=t.getPrevious(i,5),o=[],a=[],l=Nw.empty();for(let p=0;p<6;p++){const e=this.updateEncounterAndReturnLastEmpty(n,s,a);e.isPresent()&&(l=e),o.push(s),s=s.getNext(i,1)}let c=r.status,u=r.preVictory,h=0,d=0;for(;h<6;){const e=a.reduce((e,t)=>e+t);if(6===e)return{status:uj.VICTORY,victory:Nw.of(o),preVictory:Nw.empty(),sum:0};5.16===e&&c===uj.DEFAULT&&(u.isPresent()?(hZ(!1===u.equals(l),"Impossible to have point aligned with differents line to a same point"),c=uj.PRE_VICTORY):u=l),d=Math.max(d,e),o=o.slice(1,6),o.push(s),a=a.slice(1,6);const t=this.updateEncounterAndReturnLastEmpty(n,s,a);t.isPresent()&&(l=t),h++,s=s.getNext(i,1)}const f={status:c,victory:Nw.of(o),preVictory:u,sum:d};return this.getBoardInfoResult(d,l,o,f)}updateEncounterAndReturnLastEmpty(e,t,n){const r=e.getCurrentPlayer();switch(e.getPieceAt(t)){case r:return n.push(-7),Nw.empty();case IZ.NONE:return n.push(.16),Nw.of(t);default:return n.push(1),Nw.empty()}}getBoardInfoForTriangleCorner(e,t,n,r){Iw(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:e,lastDrop:t,state:n,boardInfo:r});const i=n.getCurrentPlayer();let s=jW.factory.all[e];const o=[t];let a=t.getNext(s,1),l=0,c=Nw.empty();for(;o.length<6;){const t=n.getPieceAt(a);if(t===i)return r;t===IZ.NONE?(l+=.16,c=Nw.of(a)):l++,o.length%2==0&&(s=jW.factory.all[(e+o.length)%6]),o.push(a),a=a.getNext(s,1)}return this.getBoardInfoResult(l,c,o,r)}getBoardInfoForTriangleEdge(e,t,n,r){Iw(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:e,lastDrop:t,state:n,boardInfo:r});const i=n.getCurrentPlayer();let s=jW.factory.all[e];const o=[t];let a=t.getNext(s,1),l=0,c=Nw.empty();for(;o.length<6;){const t=n.getPieceAt(a);if(t===i)return r;t===IZ.NONE?(l+=.16,c=Nw.of(a)):l++,o.push(a),o.length%2==0&&(s=jW.factory.all[(e+o.length)%6]),a=a.getNext(s,1)}return this.getBoardInfoResult(l,c,o,r)}}I5.singleton=Nw.empty();const k5=IZ.NONE.value,A5=TZ.ZERO.value,M5=TZ.ONE.value;let N5=(()=>{class e{}return e.MOVEMENT_NOT_DISCONNECTING=()=>$localize`This move does not disconnect your opponent's pieces. Try again with another piece.`,e.MOVEMENT_SELF_DISCONNECTING=()=>$localize`You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!`,e})();class R5{constructor(){this.tutorial=[_j.informational($localize`Six`,$localize`Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.
        Each player has 21 pieces, with one for each player already on the board.
        The goal of the game is to form one of the three winning shapes with your pieces.`,P5.getInitialState()),_j.fromMove($localize`Victory (line)`,$localize`On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>
        Find the victory. You're playing Dark.`,P5.fromRepresentation([[A5,M5,M5,M5,M5,A5],[k5,A5,M5,k5,A5,k5],[M5,M5,A5,k5,k5,k5],[k5,k5,A5,k5,k5,k5],[k5,A5,k5,k5,k5,k5],[A5,k5,k5,k5,k5,k5]],0),[S5.fromDrop(new GW(3,2))],$localize`Congratulations!`,$localize`Failed!`),_j.fromMove($localize`Victory (circle)`,$localize`On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,P5.fromRepresentation([[k5,k5,k5,M5,k5,k5],[k5,k5,M5,M5,A5,A5],[k5,M5,k5,A5,M5,k5],[M5,A5,A5,A5,A5,M5]],0),[S5.fromDrop(new GW(5,2))],$localize`Congratulations! Note that if a piece is inside the circle, it does not change anything.`,$localize`Failed!`),_j.fromMove($localize`Victory (triangle)`,$localize`On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,P5.fromRepresentation([[k5,k5,k5,M5,k5,k5],[k5,A5,M5,A5,A5,A5],[k5,A5,k5,A5,A5,k5],[M5,M5,M5,k5,M5,k5]],0),[S5.fromDrop(new GW(3,3))],$localize`Congratulations!`,$localize`Failed!`),_j.fromPredicate($localize`Second phase`,$localize`After 40 turns, your pieces have all been placed and we move on to the second phase of the game.
        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.
        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>
        You're playing Dark. Make a move that disconnects one of your opponent's pieces.`,P5.fromRepresentation([[k5,k5,k5,k5,k5,k5,k5,M5,k5],[k5,k5,k5,k5,k5,k5,A5,k5,k5],[k5,k5,k5,k5,A5,A5,A5,k5,k5],[k5,k5,k5,k5,M5,M5,k5,M5,A5],[k5,A5,M5,M5,A5,A5,M5,k5,k5],[A5,A5,A5,A5,M5,M5,M5,A5,k5],[M5,M5,A5,k5,M5,M5,A5,k5,k5],[k5,A5,k5,A5,A5,k5,k5,k5,k5],[M5,M5,M5,M5,k5,k5,k5,k5,k5],[k5,A5,k5,M5,k5,k5,k5,k5,k5]],40),S5.fromMovement(new GW(6,1),new GW(5,1)),(e,t,n)=>{const r=n.countPieces();return 19===r[0]?18===r[1]?Lw.SUCCESS:Lw.failure(N5.MOVEMENT_NOT_DISCONNECTING()):Lw.failure(N5.MOVEMENT_SELF_DISCONNECTING())},$localize`Congratulations, your opponent now has one piece less and you're closer to victory!`),_j.fromPredicate($localize`Victory by disconnection`,$localize`During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.
        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.
        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>
        Here, you're playing Dark and you can win. Do it!`,P5.fromRepresentation([[k5,k5,k5,k5,k5,M5],[k5,k5,k5,k5,A5,M5],[k5,k5,k5,M5,A5,A5],[k5,k5,A5,k5,M5,A5],[M5,M5,k5,k5,k5,A5],[A5,M5,k5,k5,k5,k5],[A5,k5,k5,k5,k5,k5]],40),S5.fromMovement(new GW(2,3),new GW(3,3)),(e,t,n)=>e.start.equalsValue(new GW(2,3))?Lw.SUCCESS:Lw.failure(N5.MOVEMENT_NOT_DISCONNECTING()),$localize`Congratulations, you won!`),_j.fromPredicate($localize`Special disconnection`,$localize`During a disconnection, two or more groups could have the same size,
        in which case you will have to click on the group you wish to keep.<br/><br/>
        You're playing Dark, play such a move!`,P5.fromRepresentation([[k5,k5,k5,k5,k5,M5],[k5,k5,k5,k5,A5,M5],[k5,k5,k5,M5,A5,A5],[A5,k5,A5,k5,k5,M5],[M5,M5,k5,k5,k5,k5],[A5,A5,k5,k5,k5,k5],[A5,k5,k5,k5,k5,k5]],40),S5.fromCut(new GW(2,3),new GW(2,5),new GW(2,5)),(e,t,n)=>e.keep.isAbsent()?Lw.failure($localize`This move has not cut the board in two equal halves.`):n.getPieceAt(e.landing.getNext(n.offset))===IZ.NONE?Lw.failure($localize`Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again.`):Lw.SUCCESS,$localize`Congratulations, you won!`)]}}function x5(e,t){if(1&e){const e=va();_n(),fa(0,"polyline",10),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onPieceClick(t)}),pa()}if(2&e){const e=t.$implicit,n=Sa();Ia("id","piece_",e.x,"_",e.y,""),ha("ngClass",n.getPieceClass(e)),ra("points",n.getHexaCoordsAt(e))}}function D5(e,t){if(1&e){const e=va();_n(),fa(0,"polyline",11),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onNeighborClick(t)}),pa()}if(2&e){const e=t.$implicit,n=Sa();Ia("id","neighbor_",e.x,"_",e.y,""),ra("points",n.getHexaCoordsAt(e))}}function L5(e,t){if(1&e){const e=va();_n(),fa(0,"polyline",10),Ea("click",function(){Gt(e);const t=Sa();return t.onPieceClick(t.chosenLanding.get())}),pa()}if(2&e){const e=Sa();Ia("id","chosenLanding_",e.chosenLanding.get().x,"_",e.chosenLanding.get().y,""),ha("ngClass",e.getPlayerClass(e.state.getCurrentPlayer())),ra("points",e.getHexaCoordsAt(e.chosenLanding.get()))}}function F5(e,t){if(1&e&&(_n(),ga(0,"polyline",12)),2&e){const e=t.$implicit,n=Sa();Ia("id","disconnected_",e.x,"_",e.y,""),ra("points",n.getHexaCoordsAt(e))}}function U5(e,t){if(1&e){const e=va();_n(),fa(0,"polyline",13),Ea("click",function(){Gt(e);const t=Sa();return t.onNeighborClick(t.leftCoord.get())}),pa()}if(2&e){const e=Sa();Ia("id","leftCoord_",e.leftCoord.get().x,"_",e.leftCoord.get().y,""),ra("points",e.getHexaCoordsAt(e.leftCoord.get()))}}function V5(e,t){if(1&e){const e=va();_n(),fa(0,"polyline",14),Ea("click",function(){Gt(e);const t=Sa();return t.onPieceClick(t.lastDrop.get())}),pa()}if(2&e){const e=Sa();Ia("id","lastDrop_",e.lastDrop.get().x,"_",e.lastDrop.get().y,""),ra("points",e.getHexaCoordsAt(e.lastDrop.get()))}}function B5(e,t){if(1&e){const e=va();_n(),fa(0,"polyline",15),Ea("click",function(){Gt(e);const t=Sa();return t.onPieceClick(t.selectedPiece.get())}),pa()}if(2&e){const e=Sa();Ia("id","selectedPiece_",e.selectedPiece.get().x,"_",e.selectedPiece.get().y,""),ha("ngClass",e.getSelectedPieceClass()),ra("points",e.getHexaCoordsAt(e.selectedPiece.get()))}}function $5(e,t){if(1&e&&(_n(),ga(0,"polyline",16)),2&e){const e=t.$implicit,n=Sa();Ia("id","victoryCoord_",e.x,"_",e.y,""),ra("points",n.getHexaCoordsAt(e))}}function z5(e,t){if(1&e){const e=va();_n(),fa(0,"g",19),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).onPieceClick(t)}),ga(1,"polyline",20),pa()}if(2&e){const e=t.$implicit,n=Sa(2);Ts(1),Ia("id","cuttable_",e.x,"_",e.y,""),ra("points",n.getHexaCoordsAt(e))}}function H5(e,t){if(1&e&&(_n(),fa(0,"g",17),la(1,z5,2,3,"g",18),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}let G5=(()=>{class e extends qW{constructor(e){super(e),this.disconnecteds=[],this.cuttableGroups=[],this.leftCoord=Nw.empty(),this.lastDrop=Nw.empty(),this.selectedPiece=Nw.empty(),this.chosenLanding=Nw.empty(),this.nextClickShouldSelectGroup=!1,this.rules=new b5(P5),this.availableMinimaxes=[new I5(this.rules,"SixMinimax")],this.encoder=S5.encoder,this.tutorial=(new R5).tutorial,this.SPACE_SIZE=30,this.hexaLayout=new YW(1.5*this.SPACE_SIZE,new GW(2*this.SPACE_SIZE,0),XW.INSTANCE),this.updateBoard()}cancelMoveAttempt(){this.selectedPiece=Nw.empty(),this.chosenLanding=Nw.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}updateBoard(){this.state=this.rules.node.gameState,this.rules.node.move.isPresent()?this.showLastMove():(this.leftCoord=Nw.empty(),this.lastDrop=Nw.empty(),this.victoryCoords=[],this.disconnecteds=[]),this.pieces=this.state.pieces.listKeys(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}getViewBox(){const e=this.mapAbstractCoordToCornerCoords(),t=this.getLimits(e);return t.minX-this.STROKE_WIDTH/2+" "+(t.minY-this.STROKE_WIDTH/2)+" "+(this.STROKE_WIDTH+t.maxX-t.minX)+" "+(this.STROKE_WIDTH+t.maxY-t.minY)}mapAbstractCoordToCornerCoords(){const e=this.pieces.concat(this.disconnecteds).concat(this.neighbors).map(e=>this.hexaLayout.getHexaCoordsAt(e));let t=[];for(const n of e)t=t.concat(n);return t}getLimits(e){let t=Number.MIN_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER;for(const s of e)s.x<r&&(r=s.x),s.y<i&&(i=s.y),t=Math.max(t,s.x),n=Math.max(n,s.y);return{minX:r,minY:i,maxX:t,maxY:n}}showLastMove(){const e=this.rules.node.move.get();this.lastDrop=Nw.of(e.landing.getNext(this.state.offset,1)),this.leftCoord=!1===e.isDrop()?Nw.of(e.start.get().getNext(this.state.offset,1)):Nw.empty();const t=this.rules.node.gameState;this.rules.getGameStatus(this.rules.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,t)),this.disconnecteds=this.getDisconnected()}getDisconnected(){const e=this.rules.node.mother.get().gameState.pieces.listKeys(),t=this.rules.node.gameState.pieces.listKeys(),n=[];for(const i of e)!1===this.rules.node.move.get().start.equalsValue(i)&&!1===t.some(e=>e.equals(i.getNext(this.state.offset,1)))&&n.push(i.getNext(this.state.offset,1));const r=this.lastDrop.get();return!1===this.pieces.some(e=>e.equals(r))&&!1===t.some(e=>e.equals(r))&&n.push(r),n}getEmptyNeighbors(){let e=b5.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){const t=this.chosenLanding.get();e=e.filter(e=>!1===e.equals(t))}return e}getPieceClass(e){const t=this.rules.node.gameState.getPieceAt(e);return this.getPlayerClass(t)}onPieceClick(e){var t=this;return Ow(function*(){const n=t.canUserPlay("#piece_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());if(t.state.turn<40)return t.cancelMove(w5.NO_MOVEMENT_BEFORE_TURN_40());if(t.chosenLanding.isAbsent())return t.state.getPieceAt(e)===t.state.getCurrentOpponent()?t.cancelMove(JW.CANNOT_CHOOSE_OPPONENT_PIECE()):(t.selectedPiece=Nw.of(e),Lw.SUCCESS);{const n=S5.fromCut(t.selectedPiece.get(),t.chosenLanding.get(),e);return t.chooseMove(n,t.state)}})()}onNeighborClick(e){var t=this;return Ow(function*(){const n=t.canUserPlay("#neighbor_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());if(t.nextClickShouldSelectGroup)return t.cancelMove(w5.MUST_CUT());if(t.state.turn<40)return t.chooseMove(S5.fromDrop(e),t.state);if(t.selectedPiece.isAbsent())return t.cancelMove(w5.CAN_NO_LONGER_DROP());{const n=S5.fromMovement(t.selectedPiece.get(),e),r=b5.isLegalPhaseTwoMove(n,t.state);return t.neededCutting(r)?(t.chosenLanding=Nw.of(e),t.moveVirtuallyPiece(),t.showCuttable(),t.nextClickShouldSelectGroup=!0,Lw.SUCCESS):t.chooseMove(n,t.state)}})()}neededCutting(e){return e.isFailure()&&e.getReason()===w5.MUST_CUT()}moveVirtuallyPiece(){const e=this.selectedPiece.get();this.pieces=this.pieces.filter(t=>!1===t.equals(e)),this.neighbors=this.getEmptyNeighbors()}showCuttable(){const e=S5.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),t=P5.deplacePiece(this.state,e),n=P5.getGroups(t,e.start.get()),r=b5.getBiggerGroups(n);this.cuttableGroups=[];for(const i of r)this.cuttableGroups.push(i.toList())}getSelectedPieceClass(){return this.chosenLanding.isPresent()?"moved":"selected"}}return e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-six"]],features:[Go],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured",3,"id",4,"ngFor","ngForOf"],["class","base round moved mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round highlighted mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured",3,"id"],[1,"base","round","moved","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","highlighted","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["stroke-linecap","round",1,"no-fill",3,"id"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,x5,1,4,"polyline",1),la(2,D5,1,3,"polyline",2),la(3,L5,1,4,"polyline",3),la(4,F5,1,3,"polyline",4),la(5,U5,1,3,"polyline",5),la(6,V5,1,3,"polyline",6),la(7,B5,1,4,"polyline",7),la(8,$5,1,3,"polyline",8),la(9,H5,2,1,"g",9),pa()),2&e&&(ra("viewBox",t.viewBox),Ts(1),ha("ngForOf",t.pieces),Ts(1),ha("ngForOf",t.neighbors),Ts(1),ha("ngIf",t.chosenLanding.isPresent()),Ts(1),ha("ngForOf",t.disconnecteds),Ts(1),ha("ngIf",t.leftCoord.isPresent()),Ts(1),ha("ngIf",t.lastDrop.isPresent()),Ts(1),ha("ngIf",t.selectedPiece.isPresent()),Ts(1),ha("ngForOf",t.victoryCoords),Ts(1),ha("ngForOf",t.cuttableGroups))},directives:[tf,rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class Z5 extends fY{static of(e,t){return new Z5(e,t)}static from(e,t){try{const n=new Z5(e,t);return Rw.success(n)}catch(n){return Rw.failure(n.message)}}getMaximalDistance(){return 9}}Z5.encoder=hY.getEncoder(9,9,Z5.of);const q5={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:TZ.ZERO};class W5 extends vY{static getInitialState(){const e=mY.UNOCCUPIED,t=mY.INVADERS,n=mY.DEFENDERS;return new W5([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,n,e,e,e,e],[t,e,e,e,n,e,e,e,t],[t,t,n,n,mY.PLAYER_ONE_KING,n,n,t,t],[t,e,e,e,n,e,e,e,t],[e,e,e,e,n,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}from(e,t){return new W5(e,t)}}class j5 extends _Y{constructor(){super(W5,q5,Z5.of)}static get(){return null==j5.singleton&&(j5.singleton=new j5),pj.ruler=this.singleton,j5.singleton}}const Y5=mY.UNOCCUPIED,K5=mY.INVADERS,Q5=mY.DEFENDERS,X5=mY.PLAYER_ONE_KING;class J5{constructor(){this.tutorial=[_j.informational($localize`Goal of the game`,$localize`Tablut is a strategy game that was played by the Vikings.
        The goal of the game is different for each player.
        The attacker plays first. Its pieces (dark) are close to the edges.
        Its goal is to capture the king, which is in the center of the board.
        The defender plays second. Its pieces (light) are in the middle.
        Its goal is to move the king on one of the 4 thrones in the corners.
        Note that the square in which the king starts, in the center of the board, is also a throne.`,W5.getInitialState()),_j.anyMove($localize`Moving`,$localize`All pieces move the same way.
        Similarly to a rook in chess, a piece can move:
        <ol>
            <li>By as many squares as you want.</li>
            <li>Without going over another piece or stopping on another piece.</li>
            <li>Horizontally or vertically.</li>
            <li>Only the king can land on a throne.</li>
        </ol>
        To move a piece, click on it and then on its landing square.<br/><br/>
        You're playing Dark, do the first move.`,W5.getInitialState(),Z5.of(new GW(4,1),new GW(1,1)),$localize`Congratulations!`),_j.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it.`,new W5([[Y5,Y5,Y5,K5,K5,K5,Y5,Y5,Y5],[Y5,Y5,Y5,Y5,K5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,Y5,Q5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,K5,Q5,Y5,Y5,Y5,K5],[K5,K5,Q5,Q5,X5,Q5,Q5,K5,K5],[Y5,Y5,Y5,Y5,Q5,Y5,Y5,Y5,K5],[Y5,Y5,Y5,Y5,Q5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,Y5,K5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,K5,K5,K5,Y5,Y5,Y5]],1),[Z5.of(new GW(2,4),new GW(2,3)),Z5.of(new GW(4,2),new GW(3,2))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),_j.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it.`,new W5([[Y5,Y5,Y5,K5,K5,K5,Y5,Y5,Y5],[Y5,Y5,Y5,Y5,K5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,Y5,Q5,Y5,Y5,Y5,Y5],[Y5,Y5,Q5,Y5,X5,Y5,Q5,Y5,K5],[K5,K5,Y5,Q5,Y5,Q5,Q5,K5,K5],[Y5,Y5,Y5,Y5,Q5,Y5,Y5,Y5,K5],[Y5,Y5,Y5,Y5,Q5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,Y5,K5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,K5,K5,K5,Y5,Y5,Y5]],12),[Z5.of(new GW(1,4),new GW(2,4))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),_j.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough.
        For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.
        This also works if the king is on the throne.<br/><br/>
        Capture the king.`,new W5([[Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5],[Y5,K5,Y5,Y5,Y5,Y5,Y5,Y5,Y5],[K5,X5,Y5,K5,Y5,Y5,Y5,Y5,Y5],[Y5,K5,Y5,Y5,Y5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5]],72),[Z5.of(new GW(3,4),new GW(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),_j.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board.
        Note that the king cannot be captured next to a throne.<br/><br/>
        Capture the king.`,new W5([[Y5,Y5,K5,X5,K5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,K5,Y5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5],[Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5,Y5]],72),[Z5.of(new GW(3,3),new GW(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed!`)]}}function e6(e,t){1&e&&(_n(),ga(0,"polyline",8))}function t6(e,t){1&e&&(_n(),ga(0,"polyline",9))}function n6(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,e6,1,0,"polyline",6),la(2,t6,1,0,"ng-template",null,7,Ku),pa()),2&e){const e=ca(3),t=Sa().index,n=Sa().index,r=Sa();Ts(1),ha("ngIf",r.isCentralThrone(t,n))("ngIfElse",e)}}function r6(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"line",10),ga(2,"line",10),ga(3,"line",10),ga(4,"line",10),ga(5,"line",10),pa()),2&e){const e=Sa(2).index,t=Sa().index,n=Sa();Ts(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.04*n.SPACE_SIZE)("x2",.5*n.SPACE_SIZE)("y2",.96*n.SPACE_SIZE),Ts(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.1*n.SPACE_SIZE)("y2",.6*n.SPACE_SIZE),Ts(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.9*n.SPACE_SIZE)("y2",.6*n.SPACE_SIZE),Ts(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.4*n.SPACE_SIZE)("x2",.15*n.SPACE_SIZE)("y2",.75*n.SPACE_SIZE),Ts(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.4*n.SPACE_SIZE)("x2",.85*n.SPACE_SIZE)("y2",.75*n.SPACE_SIZE)}}function i6(e,t){if(1&e&&(_n(),ga(0,"polyline",15)),2&e){const e=Sa(3).index,t=Sa().index;ha("ngClass",Sa().viewInfo.pieceClasses[t][e])}}function s6(e,t){if(1&e&&(_n(),ga(0,"line",10),ga(1,"line",10),ga(2,"line",10),ga(3,"line",10)),2&e){const e=Sa(3).index,t=Sa().index,n=Sa();ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.5*n.SPACE_SIZE)("y1",.04*n.SPACE_SIZE)("x2",.5*n.SPACE_SIZE)("y2",.96*n.SPACE_SIZE),Ts(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.04*n.SPACE_SIZE)("y1",.5*n.SPACE_SIZE)("x2",.96*n.SPACE_SIZE)("y2",.5*n.SPACE_SIZE),Ts(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.2*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.8*n.SPACE_SIZE)("y2",.8*n.SPACE_SIZE),Ts(1),ha("ngClass",n.viewInfo.pieceClasses[t][e]),ra("x1",.8*n.SPACE_SIZE)("y1",.2*n.SPACE_SIZE)("x2",.2*n.SPACE_SIZE)("y2",.8*n.SPACE_SIZE)}}function o6(e,t){if(1&e&&(_n(),la(0,i6,1,1,"polyline",13),la(1,s6,4,20,"ng-template",null,14,Ku)),2&e){const e=ca(2),t=Sa(2).index,n=Sa().index;ha("ngIf",Sa().isKing(t,n))("ngIfElse",e)}}function a6(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"circle",10),la(2,r6,6,25,"g",11),la(3,o6,3,2,"ng-template",null,12,Ku),pa()),2&e){const e=ca(4),t=Sa().index,n=Sa().index,r=Sa();Ts(1),ha("ngClass",r.viewInfo.pieceClasses[n][t]),ra("r",r.SPACE_SIZE/2-r.STROKE_WIDTH)("cx",.5*r.SPACE_SIZE)("cy",.5*r.SPACE_SIZE),Ts(1),ha("ngIf",r.isInvader(t,n))("ngIfElse",e)}}function l6(e,t){if(1&e){const e=va();_n(),fa(0,"g",3),Ea("click",function(){const t=Gt(e).index,n=Sa().index;return Sa().onClick(t,n)}),ga(1,"rect",4),la(2,n6,4,2,"g",5),la(3,a6,5,6,"g",5),pa()}if(2&e){const e=t.index,n=Sa().index,r=Sa();Ia("id","click_",e,"_",n,""),ra("transform","translate("+r.SPACE_SIZE*e+", "+r.SPACE_SIZE*n+")"),Ts(1),ha("ngClass",r.getRectClasses(e,n)),ra("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),Ts(1),ha("ngIf",r.board[n][e]===r.EMPTY&&r.isThrone(e,n)),Ts(1),ha("ngIf",r.board[n][e]!==r.EMPTY)}}function c6(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,l6,4,8,"g",2),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}function u6(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",16),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t.x,t.y)}),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa();Ts(1),Ia("id","click_",e.x,"_",e.y,""),ra("x",n.SPACE_SIZE*e.x)("y",n.SPACE_SIZE*e.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let h6=(()=>{class e extends wY{constructor(e){super(e,!1,Z5.from),this.rules=j5.get(),this.availableMinimaxes=[new PY(this.rules,"DummyBot"),new IY(this.rules,"Piece > Influence"),new kY(this.rules,"Piece > Control"),new AY(this.rules,"Escape > Piece > Control")],this.encoder=Z5.encoder,this.tutorial=(new J5).tutorial,this.updateBoard()}}return e.\u0275fac=function(t){return new(t||e)(ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["app-tablut"]],features:[Go],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15",1,"base"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60, 10 20",1,"base"],[1,"base",3,"ngClass"],[4,"ngIf","ngIfElse"],["defender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,c6,2,1,"g",1),la(2,u6,2,6,"g",1),pa()),2&e&&(ra("viewBox",t.getViewBox()),Ts(1),ha("ngForOf",t.board),Ts(1),ha("ngForOf",t.getClickables()))},directives:[tf,Jd,rf],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e})();class d6{}d6.PLACEMENT_AFTER_INITIAL_PHASE=()=>$localize`You cannot put a new ring after the tenth turn.`,d6.NO_MARKERS_IN_INITIAL_PHASE=()=>$localize`You cannot put a marker in a ring before placing all of your rings.`,d6.MISSING_CAPTURES=NX.MISSING_CAPTURES,d6.MOVE_DIRECTION_INVALID=()=>$localize`The direction of your move is invalid: a move is made along a straight line.`,d6.CAN_ONLY_CAPTURE_YOUR_MARKERS=()=>$localize`You can only capture your own markers.`,d6.SHOULD_SELECT_PLAYER_RING=()=>$localize`You must pick one of your own rings to move.`,d6.SHOULD_END_MOVE_ON_EMPTY_SPACE=()=>$localize`Your ring must land on an empty space.`,d6.MOVE_SHOULD_NOT_PASS_ABOVE_RING=()=>$localize`A ring can only jump over markers or empty spaces, not over another ring.`,d6.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=()=>$localize`Your ring must land on the first empty space after a group of markers.`,d6.AMBIGUOUS_CAPTURE_COORD=NX.AMBIGUOUS_CAPTURE_COORD,d6.CAPTURE_SHOULD_TAKE_RING=()=>$localize`When you capture markers, you must take one of your ring as well by clicking on it.`;class f6{constructor(e,t){this.player=e,this.isRing=t}static of(e,t){return e===IZ.NONE?f6.EMPTY:t?f6.RINGS[e.value]:f6.MARKERS[e.value]}equals(e){return this===e}flip(){return hZ(!1===this.isRing,"cannot flip a ring (it should never happen)"),hZ(this.player.isPlayer(),"cannot flip a non-player piece"),f6.of(this.player.getOpponent(),this.isRing)}toString(){switch(this){case f6.UNREACHABLE:return"NONE";case f6.EMPTY:return"EMPTY";case f6.MARKER_ZERO:return"MARKER_ZERO";case f6.MARKER_ONE:return"MARKER_ONE";case f6.RING_ZERO:return"RING_ZERO";default:return Tw.expectToBe(this,f6.RING_ONE),"RING_ONE"}}}f6.encoder=bZ.tuple([TZ.numberEncoder,bZ.booleanEncoder],e=>[e.player,e.isRing],e=>f6.of(e[0],e[1])),f6.UNREACHABLE=new f6(IZ.NONE,!1),f6.EMPTY=new f6(IZ.NONE,!1),f6.MARKER_ZERO=new f6(TZ.ZERO,!1),f6.MARKER_ONE=new f6(TZ.ONE,!1),f6.MARKERS=[f6.MARKER_ZERO,f6.MARKER_ONE],f6.RING_ZERO=new f6(TZ.ZERO,!0),f6.RING_ONE=new f6(TZ.ONE,!0),f6.RINGS=[f6.RING_ZERO,f6.RING_ONE];let p6=(()=>{class e extends dQ{constructor(t,n,r){super(r,t,e.SIZE,e.SIZE,[6,4,3,2,1],f6.EMPTY),this.sideRings=n}static getInitialState(){const t=f6.EMPTY,n=f6.UNREACHABLE;return new e([[n,n,n,n,n,n,t,t,t,t,n],[n,n,n,n,t,t,t,t,t,t,t],[n,n,n,t,t,t,t,t,t,t,t],[n,n,t,t,t,t,t,t,t,t,t],[n,t,t,t,t,t,t,t,t,t,t],[n,t,t,t,t,t,t,t,t,t,n],[t,t,t,t,t,t,t,t,t,t,n],[t,t,t,t,t,t,t,t,t,n,n],[t,t,t,t,t,t,t,t,n,n,n],[t,t,t,t,t,t,t,n,n,n,n],[n,t,t,t,t,n,n,n,n,n,n]],[5,5],0)}isInitialPlacementPhase(){return this.turn<10}countScores(){return this.turn<10?[0,0]:this.sideRings}equals(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&NZ.compareTable(this.board,e.board)}getRingCoords(e){const t=[];return this.forEachCoord((n,r)=>{r.isRing&&r.player===e&&t.push(n)}),t}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==f6.UNREACHABLE}setAtUnsafe(t,n){const r=NZ.copyBiArray(this.board);return r[t.y][t.x]=n,new e(r,this.sideRings,this.turn)}}return e.SIZE=11,e})();class g6 extends IX{constructor(e,t){if(super(e),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");this.ringTaken=Nw.ofNullable(t)}static of(e,t,n){const r=[],i=jW.factory.fromMove(e,t).get();for(let s=e;!1===s.equals(t);s=s.getNext(i))r.push(s);return r.push(t),new g6(r,n)}setRingTaken(e){return new g6(this.capturedSpaces,e)}equals(e){return!(!1===super.equals(e)||!1===this.ringTaken.equals(e.ringTaken))}}g6.encoder=new class extends PZ{encode(e){return{captured:e.capturedSpaces.map(e=>GW.encoder.encode(e)),ringTaken:GW.encoder.encode(e.ringTaken.get())}}decode(e){const t=e;return hZ(null!=t.captured&&null!=t.ringTaken,"Invalid encoded YinshCapture"),new g6(t.captured.map(e=>GW.encoder.decode(e)),GW.encoder.decode(t.ringTaken))}};class m6 extends aj{constructor(e,t,n,r){super(),this.initialCaptures=e,this.start=t,this.end=n,this.finalCaptures=r}isInitialPlacement(){return this.end.isAbsent()}equals(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===NZ.compareArray(this.initialCaptures,e.initialCaptures)||!1===NZ.compareArray(this.finalCaptures,e.finalCaptures))}toString(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}}m6.coordOptionalEncoder=TX(GW.encoder),m6.encoder=new class extends SZ{encodeMove(e){const t={moveStart:GW.encoder.encode(e.start),moveEnd:m6.coordOptionalEncoder.encode(e.end)};return e.initialCaptures.map((e,n)=>{t["initialCapture"+n]=g6.encoder.encode(e)}),e.finalCaptures.map((e,n)=>{t["finalCapture"+n]=g6.encoder.encode(e)}),t}decodeMove(e){const t=e;return hZ(null!=t.moveStart,"Invalid encoded YinshMove"),new m6(this.decodeArray(t,"initialCapture",g6.encoder.decode),GW.encoder.decode(t.moveStart),m6.coordOptionalEncoder.decode(t.moveEnd),this.decodeArray(t,"finalCapture",g6.encoder.decode))}decodeArray(e,t,n){const r=[];for(let i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}};class y6 extends ej{getBoardValue(e){const t=this.ruler.getGameStatus(e);return t.isEndGame?tj.fromWinner(t.winner):new tj(e.gameState.sideRings[0]*TZ.ZERO.getScoreModifier()+e.gameState.sideRings[1]*TZ.ONE.getScoreModifier())}getListMoves(e){const t=[],n=e.gameState;if(n.isInitialPlacementPhase())for(const[r,i]of n.getCoordsAndContents())i===f6.EMPTY&&t.push(new m6([],r,Nw.empty(),[]));else{const e=this.ruler;this.getPossibleCaptureCombinations(n).forEach(r=>{const i=e.applyCaptures(r,n);this.getRingMoves(i).forEach(n=>{const s=e.applyRingMoveAndFlip(n.start,n.end,i);this.getPossibleCaptureCombinations(s).forEach(e=>{const i=new m6(r,n.start,Nw.of(n.end),e);t.push(i)})})})}return t}getPossibleCaptureCombinations(e){const t=this.ruler.getPossibleCaptures(e),n=this.getRingCoords(e);return xX.getPossibleCaptureCombinationsFromPossibleCaptures(t).map(e=>class{static getCombinations(e,t){return hZ(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(e=>this.getPermutations(e)).reduce((e,t)=>e.concat(t))}static getPermutations(e){const t=e.length,n=[e.slice()],r=new Array(t).fill(0);let i=1;for(;i<t;)if(r[i]<i){const t=i%2&&r[i],s=e[i];e[i]=e[t],e[t]=s,++r[i],i=1,n.push(e.slice())}else r[i]=0,++i;return n}static getSubsetsOfSize(e,t){return function t(n,r){if(r>=e.length||n<1)return[[]];{const i=[];for(;r<=e.length-n;){const s=e[r];for(const e of t(n-1,r+1))e.push(s),i.push(e);++r}return i}}(t,0)}}.getCombinations(n,e.length).map(t=>e.map((e,n)=>new g6(e.capturedSpaces,t[n])))).reduce((e,t)=>e.concat(t),[])}getRingMoves(e){const t=this.ruler,n=[];for(const r of this.getRingCoords(e))for(const i of t.getRingTargets(e,r))n.push({start:r,end:i});return n}getRingCoords(e){const t=e.getCurrentPlayer().value,n=[];return e.forEachCoord((e,r)=>{r===f6.RINGS[t]&&n.push(e)}),n}}class v6 extends mj{applyLegalMove(e,t,n){return new p6(n.board,n.sideRings,n.turn+1)}applyCaptures(e,t){let n=t;return e.forEach(e=>{n=this.applyCapture(e,n)}),n}applyCapture(e,t){const n=this.applyCaptureWithoutTakingRing(t,e);return this.takeRing(new p6(n,t.sideRings,t.turn),e.ringTaken.get())}takeRing(e,t){const n=e.getCurrentPlayer().value,r=e.setAt(t,f6.EMPTY).board,i=[e.sideRings[0],e.sideRings[1]];return i[n]+=1,new p6(r,i,e.turn)}applyCaptureWithoutTakingRing(e,t){return t.forEach(t=>{e=e.setAt(t,f6.EMPTY)}),e.board}ringSelectionValidity(e,t){const n=e.getCurrentPlayer().value;return e.getPieceAt(t)===f6.RINGS[n]?Lw.SUCCESS:Lw.failure(d6.CAPTURE_SHOULD_TAKE_RING())}applyRingMoveAndFlip(e,t,n){const r=n.getCurrentPlayer().value;let i=n.setAt(e,f6.MARKERS[r]);i=i.setAt(t,f6.RINGS[r]);const s=jW.factory.fromMove(e,t).get();for(let o=e.getNext(s);!1===o.equals(t);o=o.getNext(s)){const e=i.getPieceAt(o);e!==f6.EMPTY&&(i=i.setAt(o,e.flip()))}return i}isLegal(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return Rw.failure(d6.NO_MARKERS_IN_INITIAL_PHASE());const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toFailedFallible();const r=this.applyCaptures(e.initialCaptures,t),i=this.moveValidity(r,e.start,e.end.get());if(i.isFailure())return i.toFailedFallible();const s=this.applyRingMoveAndFlip(e.start,e.end.get(),r),o=this.capturesValidity(s,e.finalCaptures);if(o.isFailure())return o.toFailedFallible();const a=this.applyCaptures(e.finalCaptures,s),l=this.noMoreCapturesValidity(a);return l.isFailure()?l.toFailedFallible():Rw.success(a)}initialPlacementValidity(e,t){if(!0!==e.isInitialPlacementPhase())return Rw.failure(d6.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==f6.EMPTY)return Rw.failure(JW.MUST_CLICK_ON_EMPTY_SPACE());const n=e.getCurrentPlayer(),r=[e.sideRings[0],e.sideRings[1]];r[n.value]-=1;const i=e.setAt(t,f6.of(n,!0)).board,s=new p6(i,r,e.turn);return Rw.success(s)}moveStartValidity(e,t){const n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==f6.RINGS[n]?Lw.failure(d6.SHOULD_SELECT_PLAYER_RING()):Lw.SUCCESS}moveValidity(e,t,n){const r=this.moveStartValidity(e,t);if(r.isFailure())return r;if(e.getPieceAt(n)!==f6.EMPTY)return Lw.failure(d6.SHOULD_END_MOVE_ON_EMPTY_SPACE());const i=jW.factory.fromMove(t,n);if(i.isFailure())return Lw.failure(d6.MOVE_DIRECTION_INVALID());const s=i.get();let o=!1;for(let a=t.getNext(s);!1===a.equals(n);a=a.getNext(s)){const t=e.getPieceAt(a);if(t===f6.EMPTY){if(o)return Lw.failure(d6.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(t.isRing)return Lw.failure(d6.MOVE_SHOULD_NOT_PASS_ABOVE_RING());o=!0}}return Lw.SUCCESS}capturesValidity(e,t){let n=e;for(const r of t){const e=this.captureValidity(n,r);if(e.isFailure())return e;n=this.applyCapture(r,n)}return Lw.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer().value;for(const r of t.capturedSpaces)if(e.getPieceAt(r)!==f6.MARKERS[n])return Lw.failure(d6.CAN_ONLY_CAPTURE_YOUR_MARKERS());return e.getPieceAt(t.ringTaken.get())!==f6.RINGS[n]?Lw.failure(d6.CAPTURE_SHOULD_TAKE_RING()):Lw.SUCCESS}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?Lw.SUCCESS:Lw.failure(d6.MISSING_CAPTURES())}getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(r=>{const i=this.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,r);i.isPresent()&&n.push(i.get())}),n}getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,n){let r=0;const i=e.getEntranceOnLine(n),s=n.getDirection();let o,a=i;for(o=i;e.isOnBoard(o);o=o.getNext(s)){const n=e.getPieceAt(o);if(n.player===t&&!1===n.isRing)0===r&&(a=o),r+=1;else{if(r>=5)break;r=0}}return r>=5?Nw.of({start:a,end:o,dir:s}):Nw.empty()}getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(e=>{for(let t=e.start;t.getDistance(e.end)>=5;t=t.getNext(e.dir))n.push(g6.of(t,t.getNext(e.dir,4)))}),n}getRingTargets(e,t){const n=[];for(const r of jW.factory.all){let i=!1;for(let s=t.getNext(r);e.isOnBoard(s);s=s.getNext(r)){const t=e.getPieceAt(s);if(t===f6.EMPTY){if(n.push(s),i)break}else{if(t.isRing)break;i=!0}}}return n}getGameStatus(e){return e.gameState.isInitialPlacementPhase()?gj.ONGOING:e.gameState.sideRings[0]>=3?gj.ZERO_WON:e.gameState.sideRings[1]>=3?gj.ONE_WON:gj.ONGOING}}const C6=f6.EMPTY,_6=f6.UNREACHABLE,E6=f6.MARKER_ZERO,w6=f6.RING_ZERO,P6=f6.MARKER_ONE,S6=f6.RING_ONE;let b6=(()=>{class e{}return e.MUST_ALIGN_FIVE=()=>$localize`Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time.`,e.MUST_CAPTURE_TWO=()=>$localize`Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again.`,e})();class O6{constructor(){this.tutorial=[_j.informational($localize`Goal of the game`,$localize`The goal at Yinsh is to capture three rings in total.
        The rings taken are shown on the top left for the dark player,
        and on the bottom right for the light player. Here, Dark won the game.
        Note that on the board you have two types of pieces for each player:
        rings (empty circles) and markers (full circles).`,new p6([[_6,_6,_6,_6,_6,_6,C6,C6,C6,C6,_6],[_6,_6,_6,_6,C6,C6,C6,C6,C6,C6,C6],[_6,_6,_6,E6,S6,C6,C6,C6,C6,C6,C6],[_6,_6,C6,E6,C6,S6,C6,P6,C6,C6,C6],[_6,C6,w6,P6,C6,C6,S6,E6,C6,C6,C6],[_6,C6,C6,E6,P6,C6,C6,C6,C6,C6,_6],[C6,C6,C6,E6,C6,C6,C6,S6,C6,C6,_6],[C6,C6,C6,P6,E6,w6,C6,C6,C6,_6,_6],[C6,C6,C6,C6,C6,C6,C6,C6,_6,_6,_6],[C6,C6,C6,C6,C6,C6,C6,_6,_6,_6,_6],[_6,C6,C6,C6,C6,_6,_6,_6,_6,_6,_6]],[3,1],20)),_j.anyMove($localize`Initial board and placement phase`,$localize`The initial board is empty.
        At the beginning of the game, each player puts one of its ring on the board at their turn.
        This phase stops when all rings have been placed on the board.
        Put one of your ring on the board by clicking the space where you want to place it.`,new p6(p6.getInitialState().board,[5,5],0),new m6([],new GW(5,5),Nw.empty(),[]),$localize`Congratulations!`),_j.anyMove($localize`Putting a marker`,$localize`Once the initial phase is done and all rings are on the board, you need to place markers on the board.
        To do so, put a marker in a ring by clicking on that ring.
        Then, the ring must be moved in a straight line, in any direction.
        A ring cannot pass through other rings during its move.
        If it goes over a group of markers, your move must stop at the first empty space after that group.
        All markers in the group are then flipped and their color change.<br/><br/>
        You're playing Dark, do a move.`,new p6([[_6,_6,_6,_6,_6,_6,C6,C6,C6,C6,_6],[_6,_6,_6,_6,C6,C6,C6,C6,C6,C6,C6],[_6,_6,_6,S6,C6,C6,C6,C6,C6,C6,C6],[_6,_6,S6,C6,C6,S6,C6,C6,C6,C6,C6],[_6,C6,w6,P6,C6,C6,S6,C6,C6,C6,C6],[_6,C6,C6,P6,C6,C6,C6,C6,C6,C6,_6],[C6,C6,C6,C6,w6,C6,C6,S6,C6,C6,_6],[C6,C6,C6,C6,C6,w6,C6,C6,C6,_6,_6],[C6,C6,C6,w6,C6,C6,C6,_6,_6,_6,_6],[C6,C6,C6,C6,C6,C6,C6,_6,_6,_6,_6],[_6,C6,C6,C6,C6,_6,_6,_6,_6,_6,_6]],[0,0],20),new m6([],new GW(2,4),Nw.of(new GW(4,4)),[]),$localize`Congratulations!`),_j.fromPredicate($localize`Getting a ring by aligning 5 markers`,$localize`Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.
        To do so, you need to align 5 markers of your color.
        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.
        You will then have one more point.
        You must capture when you can.<br/><br/>
        You're playing Dark, perform a capture!`,new p6([[_6,_6,_6,_6,_6,_6,C6,C6,C6,C6,_6],[_6,_6,_6,_6,C6,C6,C6,C6,C6,C6,C6],[_6,_6,_6,S6,C6,C6,C6,C6,C6,C6,C6],[_6,_6,S6,C6,C6,S6,C6,C6,C6,C6,C6],[_6,C6,E6,E6,w6,P6,P6,C6,C6,C6,C6],[_6,C6,C6,S6,C6,C6,C6,C6,C6,C6,_6],[C6,C6,C6,C6,w6,C6,C6,S6,C6,C6,_6],[C6,C6,C6,C6,C6,w6,C6,C6,C6,_6,_6],[C6,C6,C6,w6,C6,C6,C6,w6,_6,_6,_6],[C6,C6,C6,C6,C6,C6,C6,_6,_6,_6,_6],[_6,C6,C6,C6,C6,_6,_6,_6,_6,_6,_6]],[0,0],20),new m6([],new GW(4,4),Nw.of(new GW(7,4)),[g6.of(new GW(2,4),new GW(6,4),new GW(7,4))]),(e,t,n)=>1===n.sideRings[TZ.ZERO.value]?Lw.SUCCESS:Lw.failure(b6.MUST_ALIGN_FIVE()),$localize`Congratulations!`),_j.fromPredicate($localize`Compound captures`,$localize`During a turn, you could have to choose between multiple captures,
        or you could even capture multiple times!
        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>
        Here, you can capture two rings, do it!`,new p6([[_6,_6,_6,_6,_6,_6,C6,C6,C6,C6,_6],[_6,_6,_6,_6,w6,C6,C6,S6,S6,w6,C6],[_6,_6,_6,w6,C6,C6,P6,S6,C6,w6,C6],[_6,_6,C6,w6,C6,C6,C6,C6,C6,S6,C6],[_6,C6,C6,C6,C6,E6,C6,C6,S6,C6,C6],[_6,C6,C6,C6,E6,E6,C6,P6,C6,C6,_6],[C6,C6,C6,E6,C6,E6,C6,C6,C6,C6,_6],[C6,C6,E6,C6,C6,E6,C6,C6,C6,_6,_6],[C6,E6,C6,C6,C6,E6,C6,C6,_6,_6,_6],[C6,C6,C6,C6,C6,E6,C6,_6,_6,_6,_6],[_6,C6,C6,C6,C6,_6,_6,_6,_6,_6,_6]],[0,0],10),new m6([g6.of(new GW(5,4),new GW(1,8),new GW(3,2)),g6.of(new GW(5,9),new GW(5,5),new GW(3,3))],new GW(4,1),Nw.of(new GW(4,2)),[]),(e,t,n)=>2===n.sideRings[TZ.ZERO.value]?Lw.SUCCESS:Lw.failure(b6.MUST_CAPTURE_TWO()),$localize`Congratulations!`)]}}function T6(e,t){if(1&e&&(_n(),ga(0,"circle",9)),2&e){const e=Sa(2).$implicit,t=Sa(2);ra("cx",e.center.x)("cy",e.center.y)("r",t.viewInfo.ringOuterSize)}}function I6(e,t){if(1&e&&(_n(),ga(0,"circle",10)),2&e){const e=Sa(2),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();Ia("id","ring_",t,"_",r,""),ha("ngClass",n.ringClasses),ra("cx",n.center.x)("cy",n.center.y)("r",i.viewInfo.ringMidSize)}}function k6(e,t){if(1&e&&(_n(),ga(0,"circle",9)),2&e){const e=Sa(2).$implicit,t=Sa(2);ra("cx",e.center.x)("cy",e.center.y)("r",t.viewInfo.ringInnerSize)}}function A6(e,t){if(1&e&&(_n(),ga(0,"circle",11)),2&e){const e=Sa(2),t=e.index,n=e.$implicit,r=Sa().index,i=Sa();Ia("id","marker_",t,"_",r,""),ha("ngClass",n.markerClasses),ra("cx",n.center.x)("cy",n.center.y)("r",i.viewInfo.markerSize)}}function M6(e,t){if(1&e){const e=va();_n(),fa(0,"g",3),Ea("click",function(){Gt(e);const t=Sa().$implicit;return Sa(2).onClick(t.coord)}),ga(1,"polyline",4),fa(2,"g",5),la(3,T6,1,3,"circle",6),la(4,I6,1,6,"circle",7),la(5,k6,1,3,"circle",6),la(6,A6,1,6,"circle",8),pa(),pa()}if(2&e){const e=Sa(),t=e.index,n=e.$implicit,r=Sa().index;Ia("id","click_",t,"_",r,""),Ts(1),Ia("id","space_",t,"_",r,""),ha("ngClass",n.spaceClasses),ra("points",n.coordinates),Ts(1),Ia("id","pieceGroup_",t,"_",r,""),ha("ngClass",n.removedClass),Ts(1),ha("ngIf",n.isRing),Ts(1),ha("ngIf",n.isRing),Ts(1),ha("ngIf",n.isRing),Ts(1),ha("ngIf",n.isMarker)}}function N6(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,M6,7,13,"g",2),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngIf",null!=e)}}function R6(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,N6,2,1,"g",1),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}function x6(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"polyline",12),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t)}),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa();Ts(1),Ia("id","selected_",e.x,"_",e.y,""),ra("points",n.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function D6(e,t){if(1&e){const e=va();_n(),fa(0,"polyline",14),Ea("click",function(){Gt(e);const t=Sa().$implicit;return Sa().onClick(t)}),pa()}if(2&e){const e=Sa().$implicit,t=Sa();Ia("id","selectable_",e.x,"_",e.y,""),ra("points",t.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function L6(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,D6,1,3,"polyline",13),pa()),2&e){const e=Sa();Ts(1),ha("ngIf",e.isPlayerTurn())}}function F6(e,t){if(1&e){const e=va();_n(),fa(0,"g"),fa(1,"rect",15),Ea("click",function(){const t=Gt(e).$implicit;return Sa().onClick(t)}),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa();Ts(1),ra("x",n.viewInfo.spaceInfo[e.y][e.x].center.x-n.viewInfo.indicatorSize/2)("y",n.viewInfo.spaceInfo[e.y][e.x].center.y-n.viewInfo.indicatorSize/2)("width",n.viewInfo.indicatorSize)("height",n.viewInfo.indicatorSize)}}function U6(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"circle",16),ga(2,"circle",9),ga(3,"circle",17),pa()),2&e){const e=t.index,n=Sa().$implicit,r=Sa();Ts(1),Ia("id","player_",n,"_sideRing_",e+1,""),ra("cx",(0===n?0:1050)+1.2*(0===n?1:-1)*r.viewInfo.ringOuterSize*(e+1))("cy",0===n?300:1260)("r",r.viewInfo.ringOuterSize),Ts(1),ra("cx",(0===n?0:1050)+1.2*(0===n?1:-1)*r.viewInfo.ringOuterSize*(e+1))("cy",0===n?300:1260)("r",r.viewInfo.ringInnerSize),Ts(1),ha("ngClass",r.viewInfo.sideRingClass[n]),ra("cx",(0===n?0:1050)+1.2*(0===n?1:-1)*r.viewInfo.ringOuterSize*(e+1))("cy",0===n?300:1260)("r",r.viewInfo.ringMidSize)}}const V6=function(){return[]};function B6(e,t){if(1&e&&(_n(),fa(0,"g"),la(1,U6,4,12,"g",1),pa()),2&e){const e=t.$implicit,n=Sa();Ts(1),ha("ngForOf",wu(1,V6).constructor(n.viewInfo.sideRings[e]))}}const $6=function(){return[0,1]};class z6 extends qW{constructor(e){super(e),this.movePhase="MOVE_START",this.moveStart=Nw.empty(),this.moveEnd=Nw.empty(),this.currentlyMoved=[],this.currentCapture=Nw.empty(),this.initialCaptures=[],this.finalCaptures=[],this.possibleCaptures=[],this.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:z6.MARKER_SIZE,ringOuterSize:z6.RING_OUTER_SIZE,ringMidSize:z6.RING_MID_SIZE,ringInnerSize:z6.RING_INNER_SIZE,indicatorSize:z6.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},this.scores=Nw.of([0,0]),this.rules=new v6(p6),this.availableMinimaxes=[new y6(this.rules,"YinshMinimax")],this.encoder=m6.encoder,this.tutorial=(new O6).tutorial,this.hexaLayout=new YW(1.5*z6.RING_OUTER_SIZE,new GW(2*z6.RING_OUTER_SIZE,0),XW.INSTANCE),this.constructedState=this.rules.node.gameState,this.constructedState.allCoords().forEach(e=>{null==this.viewInfo.spaceInfo[e.y]&&(this.viewInfo.spaceInfo[e.y]=[]),this.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:this.getHexaCoordsAt(e),center:this.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}})}updateBoard(){this.cancelMoveAttempt(),this.scores=Nw.of(this.rules.node.gameState.countScores())}updateViewInfo(){this.constructedState.allCoords().forEach(e=>{this.viewInfo.spaceInfo[e.y][e.x].spaceClasses=this.getSpaceClasses(e);const t=this.constructedState.getPieceAt(e);this.viewInfo.spaceInfo[e.y][e.x].removedClass="",this.setRingInfo(e,t),this.setMarkerInfo(e,t)});for(const e of TZ.PLAYERS)this.viewInfo.sideRings[e.value]=this.constructedState.sideRings[e.value];switch(this.showCurrentMoveCaptures(),this.showLastMove(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];for(const e of this.possibleCaptures)for(const t of e.capturedSpaces)this.viewInfo.selectableCoords.push(t);break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.rules.node.gameState.isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}showCurrentMoveCaptures(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());for(const e of this.initialCaptures)this.markCurrentCapture(e);for(const e of this.finalCaptures)this.markCurrentCapture(e)}getSpaceClasses(e){return this.currentlyMoved.some(t=>t.equals(e))?["moved"]:[]}setRingInfo(e,t){if(t.isRing){const n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[n+"-stroke"]}else this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[]}setMarkerInfo(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==f6.EMPTY&&(!t.isRing||t.isRing&&this.moveStart.equalsValue(e))){const n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[n]}}cancelMoveAttempt(){this.constructedState=this.rules.node.gameState,this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=Nw.empty(),this.moveStart=Nw.empty(),this.moveEnd=Nw.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}showLastMove(){const e=this.rules.node.move;if(e.isPresent()){const t=e.get();if(t.isInitialPlacement())this.viewInfo.spaceInfo[t.start.y][t.start.x].spaceClasses=["moved"];else{for(const n of this.coordsBetween(t.start,t.end.get()))this.viewInfo.spaceInfo[n.y][n.x].spaceClasses=["moved"];const e=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();t.initialCaptures.forEach(t=>this.showLastMoveCapture(t,e)),t.finalCaptures.forEach(t=>this.showLastMoveCapture(t,e))}}}coordsBetween(e,t){const n=[],r=jW.factory.fromMove(e,t).get();for(let i=e;!i.equals(t);i=i.getNext(r))this.constructedState.getPieceAt(i)!==f6.EMPTY&&n.push(i),n.push(t);return n}showLastMoveCapture(e,t){for(const n of e.capturedSpaces)this.viewInfo.spaceInfo[n.y][n.x].spaceClasses=["captured"],t&&this.markRemovedMarker(n,this.rules.node.gameState.getCurrentPlayer().getOpponent());this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured"],t&&this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer().getOpponent())}moveToInitialCaptureOrMovePhase(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),Lw.SUCCESS}onClick(e){var t=this;return Ow(function*(){const n=t.canUserPlay("#click_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());switch(t.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_FIRST":return t.selectCaptureFirstCoord(e);case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_LAST":return t.selectCaptureLastCoord(e);case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":return t.selectRing(e);case"MOVE_START":return t.selectMoveStart(e);case"MOVE_END":return t.selectMoveEnd(e)}})()}selectCaptureFirstCoord(e){var t=this;return Ow(function*(){const n=[];if(t.possibleCaptures.forEach(t=>{t.contains(e)&&n.push(t)}),n.length>1)t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(n);else{if(0===n.length)return t.cancelMove(d6.MISSING_CAPTURES());t.selectCapture(n[0])}return Lw.SUCCESS})()}moveToCaptureSelectLast(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;for(const t of e)for(const e of t.capturedSpaces)this.viewInfo.selectableCoords.push(e);"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(Tw.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}selectCaptureLastCoord(e){var t=this;return Ow(function*(){const n=[];return t.possibleCaptures.forEach(t=>{t.contains(e)&&n.push(t)}),n.length>1?t.cancelMove(d6.AMBIGUOUS_CAPTURE_COORD()):0===n.length?t.cancelMove(d6.MISSING_CAPTURES()):t.selectCapture(n[0])})()}selectCapture(e){return this.currentCapture=Nw.of(e),this.constructedState=new p6(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(hZ("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),Lw.SUCCESS}markCurrentCapture(e){for(const t of e.capturedSpaces)this.viewInfo.selectedCoords.push(t),this.markRemovedMarker(t,this.rules.node.gameState.getCurrentPlayer());e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer()))}markRemovedMarker(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setMarkerInfo(e,f6.MARKERS[t.value])}markRemovedRing(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setRingInfo(e,f6.RINGS[t.value])}selectRing(e){var t=this;return Ow(function*(){const n=t.rules.ringSelectionValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.constructedState=t.rules.takeRing(t.constructedState,e);const r=t.currentCapture.get().setRingTaken(e);return"INITIAL_CAPTURE_SELECT_RING"===(t.currentCapture=Nw.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase)?(t.initialCaptures.push(r),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),Lw.SUCCESS)):(Tw.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(r),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),Lw.SUCCESS))})()}moveToMovePhase(){return this.movePhase="MOVE_START",this.updateViewInfo(),Lw.SUCCESS}tryMove(){var e=this;return Ow(function*(){const t=new m6(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures);return yield e.chooseMove(t,e.rules.node.gameState,e.scores.get())})()}selectMoveStart(e){var t=this;return Ow(function*(){if(t.constructedState.isInitialPlacementPhase()){const n=t.rules.initialPlacementValidity(t.constructedState,e);return n.isFailure()?t.cancelMove(n.getReason()):(t.moveStart=Nw.of(e),t.tryMove())}{const n=t.rules.moveStartValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.moveStart=Nw.of(e),t.movePhase="MOVE_END",t.updateViewInfo()}return Lw.SUCCESS})()}selectMoveEnd(e){var t=this;return Ow(function*(){const n=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e);return n.isFailure()?t.cancelMove(n.getReason()):(t.moveEnd=Nw.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.moveStart.get(),e,t.constructedState),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove())})()}moveToFinalCapturePhaseOrTryMove(){var e=this;return Ow(function*(){return e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),Lw.SUCCESS)})()}}function H6(e,t){if(1&e&&(fa(0,"option",5),Qa(1),pa()),2&e){const e=t.$implicit;ha("value",e.urlName),Ts(1),Xa(e.name)}}z6.RING_OUTER_SIZE=40,z6.RING_MID_SIZE=34,z6.RING_INNER_SIZE=28,z6.MARKER_SIZE=z6.RING_INNER_SIZE,z6.INDICATOR_SIZE=10,z6.\u0275fac=function(e){return new(e||z6)(ua(cZ))},z6.\u0275cmp=Je({type:z6,selectors:[["app-yinsh"]],features:[Go],decls:6,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected",3,"id","click"],["pointer-events","fill","class","base no-fill capturable","stroke-linecap","round",3,"id","click",4,"ngIf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable",3,"id","click"],[1,"indicator",3,"click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(_n(),fa(0,"svg",0),la(1,R6,2,1,"g",1),la(2,x6,2,3,"g",1),la(3,L6,2,1,"g",1),la(4,F6,2,4,"g",1),la(5,B6,2,2,"g",1),pa()),2&e&&(Ts(1),ha("ngForOf",t.viewInfo.spaceInfo),Ts(1),ha("ngForOf",t.viewInfo.selectedCoords),Ts(1),ha("ngForOf",t.viewInfo.selectableCoords),Ts(1),ha("ngForOf",t.viewInfo.targets),Ts(1),ha("ngForOf",wu(5,$6)))},directives:[tf,rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let G6=(()=>{class e{}return e.ABALONE=()=>$localize`Use simple mechanics to push 6 of the opponent's pieces out of the board!`,e.APAGOS=()=>$localize`Very simple game, but, will you be able to win everytime?`,e.AWALE=()=>$localize`The international version of the famous African strategy game!`,e.BRANDHUB=()=>$localize`The Irish version of the Tafl game family!`,e.COERCEO=()=>$localize`Get rid of all of your opponent's pieces on a board that shrinks little by little!`,e.CONSPIRATEURS=()=>$localize`Hide all of your pieces before your opponent does, or risk to be discovered!`,e.DIAM=()=>$localize`Drop your pieces and move them around to align two pieces of the same color across the board to win!`,e.DVONN=()=>$localize`Stack your pieces and control as many stacks as you can to win!`,e.ENCAPSULE=()=>$localize`An enhanced tic-tac-toe where piece can encapsule other and prevent them to win.`,e.EPAMINONDAS=()=>$localize`An antiquity-war inspired game. Be the first to pierce your opponent's lines!`,e.GIPF=()=>$localize`A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!`,e.GO=()=>$localize`The oldest strategy game still practiced widely. A territory control game.`,e.KAMISADO=()=>$localize`Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!`,e.LINES_OF_ACTION=()=>$localize`Regroup your pieces to win. But your possible moves will often change!`,e.LODESTONE=()=>$localize`Push and crush your opponent's pieces using magnetic forces!`,e.MARTIAN_CHESS=()=>$localize`Win points by capturing pieces, but you only control pieces on your side of the board!`,e.P4=()=>$localize`The classical 4 in a row game!`,e.PENTAGO=()=>$localize`Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!`,e.PYLOS=()=>$localize`Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!`,e.QUARTO=()=>$localize`Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!`,e.QUIXO=()=>$localize`Align 5 of your pieces on a board where pieces slide!`,e.REVERSI=()=>$localize`Sandwich your opponent's pieces to dominate the board!`,e.SAHARA=()=>$localize`Immobilize one of your opponent's pyramids before your opponent does!`,e.SIAM=()=>$localize`Be the first to push a mountain out of the board!`,e.SIX=()=>$localize`Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!`,e.TABLUT=()=>$localize`The Viking board game! Invaders must capture the king, defender must make him escape!`,e.YINSH=()=>$localize`Align your pieces to score points, but beware, pieces can flip!`,e})(),Z6=(()=>{class e{constructor(e,t,n,r,i,s=!0){this.name=e,this.urlName=t,this.component=n,this.creationDate=r,this.description=i,this.display=s}}return e.ALL_GAMES=()=>[new e("MinimaxTesting","MinimaxTesting",q0,new Date("1970-01-01"),"",!1),new e($localize`Four in a Row`,"P4",a2,new Date("2018-08-28"),G6.P4()),new e($localize`Awal`,"Awale",uY,new Date("2018-11-29"),G6.AWALE()),new e($localize`Quarto`,"Quarto",$3,new Date("2018-12-09"),G6.QUARTO()),new e($localize`Tablut`,"Tablut",h6,new Date("2018-12-27"),G6.TABLUT()),new e($localize`Reversi`,"Reversi",m4,new Date("2019-01-16"),G6.REVERSI()),new e($localize`Go`,"Go",SJ,new Date("2019-12-21"),G6.GO()),new e($localize`Encapsule`,"Encapsule",uX,new Date("2019-12-30"),G6.ENCAPSULE()),new e($localize`Siam`,"Siam",E5,new Date("2020-01-11"),G6.SIAM()),new e($localize`Sahara`,"Sahara",U4,new Date("2020-02-29"),G6.SAHARA()),new e($localize`Pylos`,"Pylos",K2,new Date("2020-10-02"),G6.PYLOS()),new e($localize`Kamisado`,"Kamisado",s1,new Date("2020-10-03"),G6.KAMISADO()),new e($localize`Quixo`,"Quixo",n4,new Date("2020-10-15"),G6.QUIXO()),new e($localize`Dvonn`,"Dvonn",BQ,new Date("2020-10-21"),G6.DVONN()),new e($localize`Epaminondas`,"Epaminondas",OX,new Date("2021-01-16"),G6.EPAMINONDAS()),new e($localize`Gipf`,"Gipf",KX,new Date("2021-02-22"),G6.GIPF()),new e($localize`Coerceo`,"Coerceo",wK,new Date("2021-03-21"),G6.COERCEO()),new e($localize`Six`,"Six",G5,new Date("2021-04-08"),G6.SIX()),new e($localize`Lines of Action`,"LinesOfAction",C1,new Date("2021-04-28"),G6.LINES_OF_ACTION()),new e($localize`Pentago`,"Pentago",T2,new Date("2021-05-23"),G6.PENTAGO()),new e($localize`Abalone`,"Abalone",Vj,new Date("2021-07-13"),G6.ABALONE()),new e($localize`Yinsh`,"Yinsh",z6,new Date("2021-07-31"),G6.YINSH()),new e($localize`Apagos`,"Apagos",eY,new Date("2021-11-04"),G6.APAGOS()),new e($localize`Diam`,"Diam",uQ,new Date("2021-11-30"),G6.DIAM()),new e($localize`Brandhub`,"Brandhub",WY,new Date("2021-12-07"),G6.BRANDHUB()),new e($localize`Conspirateurs`,"Conspirateurs",HK,new Date("2021-12-30"),G6.CONSPIRATEURS()),new e($localize`Lodestone`,"Lodestone",X1,new Date("2022-06-24"),G6.LODESTONE()),new e($localize`Martian Chess`,"MartianChess",D0,new Date("2022-07-01"),G6.MARTIAN_CHESS())].sort((e,t)=>e.name.localeCompare(t.name)),e})(),q6=(()=>{class e{constructor(){this.games=Z6.ALL_GAMES().filter(e=>!0===e.display),this.pickGame=new xu}onChange(e){this.pickGame.emit(e.target.value)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Je({type:e,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){let e;return e=$localize`Pick a game`,[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],e,[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"select",1),Ea("change",function(e){return t.onChange(e)}),fa(2,"option",2),sc(3,3),pa(),la(4,H6,2,2,"option",4),pa(),pa()),2&e&&(Ts(4),ha("ngForOf",t.games))},directives:[Og,Ag,tf],encapsulation:2}),e})();function W6(e,t){if(1&e){const e=va();fa(0,"div",26),fa(1,"div",27),Ea("click",function(){return Gt(e),Sa().closeInfo()}),pa(),fa(2,"div",28),fa(3,"header",29),fa(4,"p",30),Qa(5),pa(),fa(6,"button",31),Ea("click",function(){return Gt(e),Sa().closeInfo()}),pa(),pa(),fa(7,"section",32),fa(8,"div",6),fa(9,"div",33),fa(10,"p",34),ga(11,"img",35),pa(),pa(),fa(12,"div",7),fa(13,"div",13),Qa(14),pa(),pa(),pa(),fa(15,"div",6),fa(16,"div",33),fa(17,"a",36),Ea("click",function(){Gt(e);const t=Sa();return t.createGame(t.gameInfoDetails.get().urlName)}),ga(18,"fa-icon",37),Qa(19,"\xa0"),fa(20,"span"),sc(21,38),pa(),pa(),pa(),fa(22,"div",33),fa(23,"a",36),Ea("click",function(){Gt(e);const t=Sa();return t.createLocalGame(t.gameInfoDetails.get().urlName)}),ga(24,"fa-icon",37),Qa(25,"\xa0"),fa(26,"span"),sc(27,39),pa(),pa(),pa(),fa(28,"div",33),fa(29,"a",36),Ea("click",function(){Gt(e);const t=Sa();return t.createTutorial(t.gameInfoDetails.get().urlName)}),ga(30,"fa-icon",37),Qa(31,"\xa0"),fa(32,"span"),sc(33,40),pa(),pa(),pa(),pa(),pa(),pa(),pa()}if(2&e){const e=Sa();Ts(5),Xa(e.gameInfoDetails.get().name),Ts(6),Ia("src","assets/images/",e.theme,"/",e.gameInfoDetails.get().urlName,".png",Ci),Ts(3),Ja(" ",e.gameInfoDetails.get().description," "),Ts(4),ha("icon",e.iconOnlineGame),Ts(6),ha("icon",e.iconLocalGame),Ts(6),ha("icon",e.iconTutorial)}}function j6(e,t){if(1&e){const e=va();fa(0,"div",8),fa(1,"div",9),fa(2,"p",10),Qa(3),pa(),pa(),fa(4,"div",42),fa(5,"figure",34),fa(6,"img",43),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).openInfo(t)}),pa(),fa(7,"figcaption",44),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).openInfo(t)}),fa(8,"div",45),Qa(9,"?"),pa(),pa(),fa(10,"figcaption",46),fa(11,"a",47),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).createGame(t.urlName)}),ga(12,"fa-icon",37),pa(),fa(13,"a",48),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).createLocalGame(t.urlName)}),ga(14,"fa-icon",37),pa(),fa(15,"a",49),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).createTutorial(t.urlName)}),ga(16,"fa-icon",37),pa(),pa(),pa(),pa(),fa(17,"div",50),Qa(18),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa(2);Ts(3),Xa(e.name),Ts(3),Ta("id","image_",e.urlName,""),Ia("src","assets/images/",n.theme,"/",e.urlName,".png",Ci),Ts(5),Ta("id","playOnline_",e.urlName,""),Ts(1),ha("icon",n.iconOnlineGame),Ts(1),Ta("id","playLocally_",e.urlName,""),Ts(1),ha("icon",n.iconLocalGame),Ts(1),Ta("id","startTutorial_",e.urlName,""),Ts(1),ha("icon",n.iconTutorial),Ts(2),Ja(" ",e.description," ")}}function Y6(e,t){if(1&e&&(fa(0,"div",7),la(1,j6,19,11,"div",41),pa()),2&e){const e=t.$implicit;Ts(1),ha("ngForOf",e)}}let K6=(()=>{class e{constructor(e,t){this.router=e,this.numberOfColumns=4,this.games=[],this.iconOnlineGame=jZ,this.iconLocalGame=qZ,this.iconTutorial=GZ,this.gameInfoDetails=Nw.empty(),this.theme=t.getTheme();const n=Z6.ALL_GAMES().filter(e=>!0===e.display);let r=0;for(let i=0;i<n.length;i++)i<this.numberOfColumns&&this.games.push([]),this.games[r].push(n[i]),r=(r+1)%this.numberOfColumns}createGame(e){var t=this;return Ow(function*(){return t.router.navigate(["/play",e])})()}createLocalGame(e){var t=this;return Ow(function*(){return t.router.navigate(["/local",e])})()}createTutorial(e){return this.router.navigate(["/tutorial",e])}openInfo(e){this.gameInfoDetails=Nw.of(e)}closeInfo(){this.gameInfoDetails=Nw.empty()}}return e.\u0275fac=function(t){return new(t||e)(ua(gC),ua(HZ))},e.\u0275cmp=Je({type:e,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){let e,t,n,r,i,s,o,a,l,c,u,h,d,f;return e=$localize`EveryBoard`,t=$localize`EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn.`,n=$localize`Play online`,r=$localize`Create an online game`,i=$localize`See the game list`,s=$localize`Play offline`,o=$localize`Play`,a=$localize`Learn`,l=$localize`Play online`,c=$localize`Play offline`,u=$localize`Learn the rules`,h=$localize`Play online`,d=$localize`Play offline`,f=$localize`Learn the rules`,[[1,"hero"],[1,"hero-body"],[1,"title"],e,[1,"subtitle"],t,[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],n,[1,"card-content"],[1,"content"],["id","createOnlineGame","routerLink","/play",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],r,["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],i,s,[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],o,["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],a,["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],l,c,u,["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",h,1,"button",3,"id","click"],["data-tooltip",d,1,"button",3,"id","click"],["data-tooltip",f,1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,t){1&e&&(fa(0,"section",0),fa(1,"div",1),fa(2,"p",2),sc(3,3),pa(),fa(4,"p",4),rc(5,5),ga(6,"br"),ic(),pa(),pa(),fa(7,"div",6),fa(8,"div",7),fa(9,"div",8),fa(10,"header",9),fa(11,"p",10),sc(12,11),pa(),pa(),fa(13,"div",12),fa(14,"div",13),fa(15,"button",14),sc(16,15),pa(),fa(17,"button",16),sc(18,17),pa(),pa(),pa(),pa(),pa(),fa(19,"div",7),fa(20,"div",8),fa(21,"header",9),fa(22,"p",10),sc(23,18),pa(),pa(),fa(24,"div",12),fa(25,"div",19),fa(26,"button",20),sc(27,21),pa(),fa(28,"button",22),sc(29,23),pa(),pa(),pa(),pa(),pa(),pa(),la(30,W6,34,7,"div",24),fa(31,"div",6),la(32,Y6,2,1,"div",25),pa(),pa()),2&e&&(Ts(30),ha("ngIf",t.gameInfoDetails.isPresent()),Ts(2),ha("ngForOf",t.games))},directives:[yC,rf,tf,wW],encapsulation:2}),e})(),Q6=(()=>{class e{constructor(e){this.element=e}ngAfterViewInit(){this.element.nativeElement.focus()}}return e.\u0275fac=function(t){return new(t||e)(ua(Pc))},e.\u0275dir=st({type:e,selectors:[["","autofocus",""]]}),e})(),X6=(()=>{class e{constructor(e){this.shown=!1,this.input=e.nativeElement.parentNode.previousSibling,e.nativeElement.addEventListener("click",e=>{this.toggle()})}toggle(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}return e.\u0275fac=function(t){return new(t||e)(ua(Pc))},e.\u0275dir=st({type:e,selectors:[["","toggleVisibility",""]]}),e})();function J6(e,t){if(1&e&&(fa(0,"div",29),fa(1,"div",30),sc(2,31),pa(),fa(3,"div",32),Qa(4),pa(),pa()),2&e){const e=Sa();Ts(4),Xa(e.errorMessage)}}const e8=function(){return["/register"]},t8=function(){return["/reset-password"]};let n8=(()=>{class e{constructor(e,t){this.router=e,this.connectedUserService=t,this.faEye=WZ,this.loginForm=new og({email:new sg,password:new sg})}ngOnInit(){var e=this;this.userSubscription=this.connectedUserService.subscribeToUser(function(){var t=Ow(function*(t){t!==mZ.NOT_CONNECTED&&(yield e.redirect())});return function(e){return t.apply(this,arguments)}}())}loginWithEmail(e){var t=this;return Ow(function*(){const n=yield t.connectedUserService.doEmailLogin(e.email,e.password);n.isFailure()&&(t.errorMessage=n.getReason())})()}loginWithGoogle(){var e=this;return Ow(function*(){const t=yield e.connectedUserService.doGoogleLogin();t.isFailure()&&(e.errorMessage=t.getReason())})()}redirect(){var e=this;return Ow(function*(){return e.router.navigate(["/lobby"])})()}canLogin(){return!(""===(this.loginForm.value.email??"")||""===(this.loginForm.value.password??""))}ngOnDestroy(){this.userSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(ua(gC),ua(yZ))},e.\u0275cmp=Je({type:e,selectors:[["app-login"]],decls:49,vars:8,consts:function(){let e,t,n,r,i,s,o,a,l,c,u,h;return e=$localize`Log in`,t=$localize`Email`,n=$localize`Email`,r=$localize`Password`,i=$localize`Password`,s=$localize`Log in`,o=$localize`Log in with Google`,a=$localize`No account?`,l=$localize`Register`,c=$localize`Forgot your password?`,u=$localize`Reset your password`,h=$localize`Connection error`,[[1,"box"],[1,"title"],e,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],t,[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",n,"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],r,[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",i,"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],s,["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],o,["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],a,[3,"routerLink"],l,c,u,["role","alert",1,"message","is-danger"],[1,"message-header"],h,["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"p",1),sc(2,2),pa(),fa(3,"form",3),fa(4,"div",4),fa(5,"div",5),fa(6,"label",6),sc(7,7),pa(),pa(),fa(8,"div",8),fa(9,"div",9),fa(10,"div",10),ga(11,"input",11),pa(),pa(),pa(),pa(),fa(12,"div",4),fa(13,"div",5),fa(14,"label",12),sc(15,13),pa(),pa(),fa(16,"div",8),fa(17,"div",9),fa(18,"div",14),ga(19,"input",15),fa(20,"span",16),ga(21,"fa-icon",17),pa(),pa(),pa(),pa(),pa(),fa(22,"div",4),ga(23,"div",5),fa(24,"div",8),fa(25,"div",9),fa(26,"div",10),fa(27,"button",18),Ea("click",function(){return t.loginWithEmail(t.loginForm.value)}),sc(28,19),pa(),pa(),pa(),pa(),pa(),fa(29,"div",4),ga(30,"div",5),fa(31,"div",8),fa(32,"div",9),fa(33,"div",10),fa(34,"button",20),Ea("click",function(){return t.loginWithGoogle()}),sc(35,21),pa(),pa(),pa(),pa(),pa(),la(36,J6,5,1,"div",22),fa(37,"p",23),ma(38),sc(39,24),ya(),Qa(40,"\xa0 "),fa(41,"a",25),sc(42,26),pa(),pa(),fa(43,"p",23),ma(44),sc(45,27),ya(),Qa(46,"\xa0 "),fa(47,"a",25),sc(48,28),pa(),pa(),pa(),pa()),2&e&&(Ts(3),ha("formGroup",t.loginForm),Ts(18),ha("icon",t.faEye),Ts(6),ha("disabled",!t.canLogin()),Ts(9),ha("ngIf",t.errorMessage),Ts(5),ha("routerLink",wu(6,e8)),Ts(6),ha("routerLink",wu(7,t8)))},directives:[pg,Lp,_g,sp,Dp,wg,Q6,Ng,wW,X6,rf,vC],encapsulation:2}),e})(),r8=(()=>{class e{constructor(e){this.userDAO=e}subscribeToActiveUsers(t){Iw(e.VERBOSE,"ActiveUsersService.subscribeToActiveUsers");let n=[];const r=new xZ(r=>{Iw(e.VERBOSE,"our DAO gave us "+r.length+" new user(s)"),n=this.sort(n.concat(...r)),t(n)},r=>{let i=n;Iw(e.VERBOSE,"our DAO updated "+r.length+" user(s)");for(const e of r)i.forEach(t=>{t.id===e.id&&(t.data=e.data)}),i=this.sort(i);n=i,t(n)},e=>{n=n.filter(t=>!e.some(e=>e.id===t.id)),t(n)});return this.userDAO.observingWhere([["state","==","online"],["verified","==",!0]],r)}sort(e){return e.sort((e,t)=>{const n=Tw.getNonNullable(e.data).lastUpdateTime,r=Tw.getNonNullable(n).seconds,i=Tw.getNonNullable(t.data).lastUpdateTime;return r-Tw.getNonNullable(i).seconds})}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Or(dZ))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),i8=(()=>{class e{constructor(e){this.partDAO=e}subscribeToActiveParts(e){let t=[];const n=new xZ(n=>{t=t.concat(...n),e(t)},n=>{const r=t;for(const e of n)r.forEach(t=>{t.id===e.id&&(t.data=e.data)});t=r,e(t)},n=>{const r=[];for(const e of t)n.some(t=>t.id===e.id)||r.push(e);t=r,e(t)});return this.partDAO.observingWhere([["result","==",vZ.UNACHIEVED.value]],n)}userHasActivePart(e){var t=this;return Ow(function*(){const n=yield t.partDAO.findWhere([["playerZero","==",e],["result","==",vZ.UNACHIEVED.value]]),r=yield t.partDAO.findWhere([["playerOne","==",e],["result","==",vZ.UNACHIEVED.value]]);return n.length>0||r.length>0})()}}return e.\u0275fac=function(t){return new(t||e)(Or(RZ))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"any"}),e})(),s8=(()=>{class e{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}navigateToOnlineGameCreation(){var e=this;return Ow(function*(){yield e.router.navigate(["/play",e.selectedGame])})()}}return e.\u0275fac=function(t){return new(t||e)(ua(gC))},e.\u0275cmp=Je({type:e,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){let e;return e=$localize`Create an online game`,[[3,"pickGame"],["id","playOnline",1,"button","is-primary","is-fullwidth",3,"disabled","click"],e]},template:function(e,t){1&e&&(fa(0,"app-pick-game",0),Ea("pickGame",function(e){return t.pickGame(e)}),pa(),fa(1,"button",1),Ea("click",function(){return t.navigateToOnlineGameCreation()}),sc(2,2),pa()),2&e&&(Ts(1),ha("disabled",!t.selectedGame))},directives:[q6],encapsulation:2}),e})(),o8=(()=>{class e{transform(e){return xd(1e3*e.seconds,"HH:mm:ss","en-US")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=ot({name:"firebaseDate",type:e,pure:!0}),e})();const a8=["chatDiv"];function l8(e,t){1&e&&(ma(0),sc(1,5),ya())}function c8(e,t){1&e&&sc(0,6),2&e&&(oc(Sa().unreadMessagesText),ac(0))}function u8(e,t){if(1&e){const e=va();fa(0,"button",11),Ea("click",function(){return Gt(e),Sa(2).scrollToBottom()}),Qa(1),pa()}if(2&e){const e=Sa(2);Ts(1),Ja("",e.unreadMessagesText," \u2193")}}function h8(e,t){if(1&e&&(fa(0,"p"),Qa(1),ku(2,"firebaseDate"),fa(3,"b",12),Qa(4),pa(),fa(5,"span",13),Qa(6),pa(),pa()),2&e){const e=t.$implicit;Ts(1),Ja(" [",Au(2,3,e.postedTime),"] "),Ts(3),Ja("",e.sender.name," : "),Ts(2),Xa(e.content)}}function d8(e,t){if(1&e){const e=va();fa(0,"div"),la(1,u8,2,1,"button",7),fa(2,"div",8,9),Ea("scroll",function(){return Gt(e),Sa().updateCurrentScrollPosition()}),la(4,h8,7,5,"p",10),pa(),pa()}if(2&e){const e=Sa();Ts(1),ha("ngIf",e.showUnreadMessagesButton),Ts(3),ha("ngForOf",e.chat)}}const f8=function(){return{standalone:!0}};function p8(e,t){if(1&e){const e=va();fa(0,"form",14),Ea("onSubmit",function(){return Gt(e),Sa().sendMessage()}),fa(1,"div",15),fa(2,"div",16),fa(3,"input",17,18),Ea("ngModelChange",function(t){return Gt(e),Sa().userMessage=t}),pa(),fa(5,"p",19),Qa(6),pa(),pa(),fa(7,"div",20),fa(8,"button",21),Ea("click",function(){return Gt(e),Sa().sendMessage()}),ga(9,"fa-icon",22),pa(),pa(),pa(),fa(10,"div",23),fa(11,"p"),fa(12,"strong"),sc(13,24),pa(),pa(),pa(),pa()}if(2&e){const e=ca(4),t=Sa();Ts(3),ha("ngModel",t.userMessage)("ngModelOptions",wu(4,f8)),Ts(3),Ja("",e.value.length,"/128"),Ts(3),ha("icon",t.faReply)}}let g8=(()=>{class e{constructor(t,n){this.chatService=t,this.connectedUserService=n,this.userMessage="",this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=YZ,this.isNearBottom=!0,this.notYetScrolled=!0,Iw(e.VERBOSE,"ChatComponent constructor")}ngOnInit(){Iw(e.VERBOSE,`ChatComponent.ngOnInit for chat ${this.chatId}`),hZ(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}ngAfterViewChecked(){this.scrollToBottomIfNeeded()}loadChatContent(){const e=e=>{this.updateMessages(e.flatMap(e=>null==e.data.postedTime?[]:[e.data]))},t=new xZ(e,e,()=>{});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,t)}updateMessages(e){this.chat=this.chat.concat(e);const t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}updateUnreadMessagesText(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize`no new message`,this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize`1 new message`:$localize`${e} new messages`}scrollToBottomIfNeeded(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}updateCurrentScrollPosition(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}scrollToBottom(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}scrollTo(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}sendMessage(){var e=this;return Ow(function*(){const t=e.userMessage;e.userMessage="";const n=e.connectedUserService.user.get().toMinimalUser();yield e.chatService.sendMessage(e.chatId,n,t,e.turn)})()}ngOnDestroy(){this.chatSubscription.unsubscribe()}switchChatVisibility(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(oZ),ua(yZ))},e.\u0275cmp=Je({type:e,selectors:[["app-chat"]],viewQuery:function(e,t){if(1&e&&Wu(a8,5),2&e){let e;qu(e=ju())&&(t.chatDiv=e.first)}},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){let e,t,n,r;return e=$localize`Hide chat`,t=$localize`Show chat (${"\ufffd0\ufffd"}:INTERPOLATION:)`,n=$localize`Type your message here`,r=$localize`Be polite`,[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],e,t,["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",n,"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],r]},template:function(e,t){if(1&e&&(fa(0,"div"),fa(1,"button",0),Ea("click",function(){return t.switchChatVisibility()}),la(2,l8,2,0,"ng-container",1),la(3,c8,1,1,"ng-template",null,2,Ku),pa(),la(5,d8,5,2,"div",3),la(6,p8,14,5,"form",4),pa()),2&e){const e=ca(4);Ts(2),ha("ngIf",t.visible)("ngIfElse",e),Ts(3),ha("ngIf",t.visible),Ts(1),ha("ngIf",t.visible)}},directives:[rf,tf,pg,Lp,ug,sp,xg,Dp,fg,wW],pipes:[o8],encapsulation:2}),e})();function m8(e,t){if(1&e&&(ma(0),Qa(1),ya()),2&e){const e=Sa().$implicit;Ts(1),Xa(e.data.playerOne.name)}}function y8(e,t){1&e&&(ma(0),sc(1,26),ya())}function v8(e,t){if(1&e){const e=va();fa(0,"tr",22),Ea("click",function(){const t=Gt(e).$implicit;return Sa(2).joinGame(t.id,t.data.typeGame)}),fa(1,"td",23),Qa(2),pa(),fa(3,"td",23),Qa(4),pa(),fa(5,"td",23),la(6,m8,2,1,"ng-container",24),la(7,y8,2,0,"ng-template",null,25,Ku),pa(),fa(9,"td",23),Qa(10),pa(),pa()}if(2&e){const e=t.$implicit,n=t.index,r=ca(8);Ta("id","part_",n,""),Ts(2),Xa(e.data.typeGame),Ts(2),Xa(e.data.playerZero.name),Ts(2),ha("ngIf",e.data.playerOne)("ngIfElse",r),Ts(4),Xa(e.data.turn)}}function C8(e,t){if(1&e&&(fa(0,"div",13),fa(1,"div",14),fa(2,"table",15),fa(3,"thead"),fa(4,"tr"),fa(5,"th",16),sc(6,17),pa(),fa(7,"th",16),sc(8,18),pa(),fa(9,"th",16),sc(10,19),pa(),fa(11,"th",16),sc(12,20),pa(),pa(),pa(),fa(13,"tbody"),la(14,v8,11,6,"tr",21),pa(),pa(),pa(),pa()),2&e){const e=Sa();Ts(14),ha("ngForOf",e.activeParts)}}function _8(e,t){1&e&&(fa(0,"div",27),ga(1,"app-online-game-selection",28),pa())}function E8(e,t){if(1&e&&(fa(0,"li",39),Qa(1),ku(2,"firebaseDate"),pa()),2&e){const e=Sa().$implicit;Oa("id",e.data.username),Ts(1),el("",e.data.username,": ",Au(2,3,e.data.lastUpdateTime),"")}}function w8(e,t){if(1&e&&(ma(0),la(1,E8,3,5,"li",38),ya()),2&e){const e=t.$implicit;Ts(1),ha("ngIf",e.data.lastUpdateTime)}}function P8(e,t){if(1&e&&(fa(0,"div",29),fa(1,"div",30),fa(2,"div",31),ga(3,"app-chat",32),pa(),pa(),fa(4,"div",33),fa(5,"div",34),fa(6,"p"),sc(7,35),pa(),fa(8,"ul",36),la(9,w8,2,1,"ng-container",37),pa(),pa(),pa(),pa()),2&e){const e=Sa();Ts(3),ha("turn",-1),Ts(6),ha("ngForOf",e.activeUsers)}}let S8=(()=>{class e{constructor(e,t,n){this.router=e,this.activeUsersService=t,this.activePartsService=n,this.activeUsers=[],this.activeParts=[],this.currentTab="games"}ngOnInit(){Iw(e.VERBOSE,"lobbyComponent.ngOnInit"),this.activeUsersSubscription=this.activeUsersService.subscribeToActiveUsers(e=>{this.activeUsers=e}),this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(e=>{this.activeParts=e})}ngOnDestroy(){Iw(e.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activeUsersSubscription.unsubscribe(),this.activePartsSubscription.unsubscribe()}joinGame(e,t){var n=this;return Ow(function*(){yield n.router.navigate(["/play",t,e])})()}selectTab(e){this.currentTab=e}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(gC),ua(r8),ua(i8))},e.\u0275cmp=Je({type:e,selectors:[["app-lobby"]],decls:14,vars:3,consts:function(){let e,t,n,r,i,s,o,a,l;return e=$localize`Games`,t=$localize`Create`,n=$localize`Chat`,r=$localize`Game`,i=$localize`First player`,s=$localize`Second player`,o=$localize`Turn`,a=$localize`Waiting for opponent`,l=$localize`Connected users:`,[[1,"tabs","is-centered"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],e,["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"click"],t,["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],n,["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],r,i,s,o,[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],a,["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],["id","chatContainerDiv",1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"],[1,"column","is-3","is-hidden"],["id","onlineUsers",1,"box"],l,["id","activeUsersList"],[4,"ngFor","ngForOf"],[3,"id",4,"ngIf"],[3,"id"]]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"ul"),fa(2,"li",1),fa(3,"a",2),Ea("click",function(){return t.selectTab("games")}),sc(4,3),pa(),pa(),fa(5,"li",4),fa(6,"a",5),Ea("click",function(){return t.selectTab("create")}),sc(7,6),pa(),pa(),fa(8,"li",7),fa(9,"a",8),Ea("click",function(){return t.selectTab("chat")}),sc(10,9),pa(),pa(),pa(),pa(),la(11,C8,15,1,"div",10),la(12,_8,2,0,"div",11),la(13,P8,10,2,"div",12)),2&e&&(Ts(11),ha("ngIf","games"===t.currentTab),Ts(1),ha("ngIf","create"===t.currentTab),Ts(1),ha("ngIf","chat"===t.currentTab))},directives:[Jd,rf,tf,s8,g8],pipes:[o8],encapsulation:2}),e})(),b8=(()=>{class e{constructor(e){this.route=e,this.message=e.snapshot.paramMap.get("message")??$localize`This page does not exist.`}}return e.\u0275fac=function(t){return new(t||e)(ua(Wy))},e.\u0275cmp=Je({type:e,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){let e;return e=$localize`Not found`,[[1,"message","is-danger"],[1,"message-header"],e,[1,"message-body"]]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"div",1),sc(2,2),pa(),fa(3,"div",3),Qa(4),pa(),pa()),2&e&&(Ts(4),Xa(t.message))},encapsulation:2}),e})();function O8(e,t){}let T8=(()=>{class e{constructor(t){this.viewContainerRef=t,Iw(e.VERBOSE,"GameIncluderComponent constructor")}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(au))},e.\u0275cmp=Je({type:e,selectors:[["app-game-includer"]],decls:1,vars:0,template:function(e,t){1&e&&la(0,O8,0,0,"ng-template")},encapsulation:2}),e})(),I8=(()=>{class e{static NO_MATCHING_GAME(e){return $localize`This game (${e}) does not exist.`}}return e.NOT_YOUR_TURN=()=>$localize`It is not your turn!`,e.NO_CLONING_FEATURE=()=>$localize`You cannot clone a game. This feature might be implemented later.`,e})(),k8=(()=>{class e{constructor(t,n,r,i,s){this.componentFactoryResolver=t,this.actRoute=n,this.connectedUserService=r,this.router=i,this.messageDisplayer=s,this.players=[Nw.empty(),Nw.empty()],this.observerRole=IZ.NONE,this.endGame=!1,this.Player=TZ,Iw(e.VERBOSE,"GameWrapper.constructed: "+(null!=this.gameIncluder))}getMatchingComponent(t){return Iw(e.VERBOSE,"GameWrapper.getMatchingComponent"),Nw.ofNullable(Z6.ALL_GAMES().find(e=>e.urlName===t)).map(e=>e.component)}afterGameIncluderViewInit(){var t=this;return Ow(function*(){Iw(e.VERBOSE,"GameWrapper.afterGameIncluderViewInit");const n=yield t.createGameComponent();return n&&t.gameComponent.rules.setInitialBoard(),n})()}createGameComponent(){var t=this;return Ow(function*(){Iw(e.VERBOSE,"GameWrapper.createGameComponent");const n=Tw.getNonNullable(t.actRoute.snapshot.paramMap.get("compo")),r=t.getMatchingComponent(n);if(r.isAbsent())return yield t.router.navigate(["/notFound",I8.NO_MATCHING_GAME(n)],{skipLocationChange:!0}),!1;hZ(null!=t.gameIncluder,"GameIncluder should be present");const i=t.componentFactoryResolver.resolveComponentFactory(r.get()),s=t.gameIncluder.viewContainerRef.createComponent(i);return t.gameComponent=s.instance,t.gameComponent.chooseMove=(e,n,r)=>t.receiveValidMove(e,n,r),t.gameComponent.canUserPlay=e=>t.onUserClick(e),t.gameComponent.isPlayerTurn=()=>t.isPlayerTurn(),t.gameComponent.cancelMoveOnWrapper=e=>{t.onCancelMove(e)},t.canPass=t.gameComponent.canPass,!0})()}receiveValidMove(t,n,r){var i=this;return Ow(function*(){if(Iw(e.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:t,state:n,scores:r}}),!i.isPlayerTurn())return Lw.failure(I8.NOT_YOUR_TURN());if(i.endGame)return Lw.failure($localize`The game has ended.`);const s=i.gameComponent.rules.isLegal(t,n);return s.isFailure()?(i.gameComponent.cancelMove(s.getReason()),Lw.ofFallible(s)):(i.gameComponent.cancelMoveAttempt(),yield i.onLegalUserMove(t,r),Iw(e.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),Lw.SUCCESS)})()}onUserClick(e){if(this.observerRole===IZ.NONE){const e=I8.NO_CLONING_FEATURE();return Lw.failure(e)}return this.isPlayerTurn()?Lw.SUCCESS:Lw.failure(I8.NOT_YOUR_TURN())}onCancelMove(e){}isPlayerTurn(){if(this.observerRole===IZ.NONE||null==this.gameComponent)return!1;const t=this.gameComponent.rules.node.gameState.turn,n=t%2,r=this.getPlayer();return Iw(e.VERBOSE,{isPlayerTurn:{turn:t,players:this.players,player:r,observer:this.observerRole,areYouPlayer:this.players[n].isPresent()&&Mw(this.players[n].get(),r),isThereAPlayer:this.players[n]}}),!this.players[n].isPresent()||this.players[n].equalsValue(r)}getBoardHighlight(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.rules.node.gameState.turn%2+"-bg"]:[]}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(Cc),ua(Wy),ua(yZ),ua(gC),ua(cZ))},e.\u0275cmp=Je({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){if(1&e&&Wu(T8,5),2&e){let e;qu(e=ju())&&(t.gameIncluder=e.first)}},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();class A8{constructor(e,t,n){this.added=e,this.modified=t,this.removed=n}static from(e,t){const n=new A8({},{},{});if(null==e)return n.added={...t},n;if(null==t)return n.removed={...e},n;const r=Object.keys(e),i=Object.keys(t),s=r.filter(e=>!1===i.includes(e)),o=r.filter(e=>i.includes(e)),a=i.filter(e=>!1===r.includes(e));return n.addNewKeys(a,t),n.addCommonKeys(o,t,e),n.addRemovedKeys(s,e),n}static differs(e,t){return A8.from(e,t).countChanges()>0}addNewKeys(e,t){for(const n of e)null!=t[n]&&(this.added[n]=t[n])}addCommonKeys(e,t,n){for(const r of e)this.addCommonKey(r,n[r],t[r])}addCommonKey(e,t,n){if(null==n)null!=t&&(this.removed[e]=t);else if(null==t)this.added[e]=n;else if(["string","boolean","number"].includes(typeof t))t!==n&&(this.modified[e]=n);else if(Array.isArray(t)){if(!Array.isArray(n))throw new Error("Thing should not change type");t.length===n.length?this.addCommonKeyList(e,t,n):this.modified[e]=n}else{hZ("object"==typeof t,`ObjectDifference: expected JSON, but got a ${typeof t} in ${e}`),hZ("object"==typeof n,`ObjectDifference: expected JSON, but got a ${typeof n} in ${e}`);const r=A8.from(t,n);r.countChanges()>0&&(this.modified[e]=r)}}addCommonKeyList(e,t,n){let r=!0;for(let i=0;r&&i<t.length;i++)typeof t[i]==typeof n[i]&&"object"==typeof t[i]?A8.differs(t[i],n[i])&&(r=!1,this.modified[e]=n):t[i]!==n[i]&&(r=!1,this.modified[e]=n)}addRemovedKeys(e,t){for(const n of e)this.removed[n]=t[n]}countChanges(){const e=Object.keys(this.removed).length,t=Object.keys(this.modified).length;return Object.keys(this.added).length+t+e}isPresent(e){return null!=this.added[e]?{state:"added",present:!0}:null!=this.modified[e]?{state:"modified",present:!0}:null!=this.removed[e]?{state:"removed",present:!0}:{state:null,present:!1}}}function M8(e){return 1e3*e.seconds+e.nanoseconds/1e6}function N8(e,t){return M8(t)-M8(e)}function R8(e){return R((t,n)=>{Y(e).subscribe(new x(n,()=>n.complete(),p)),!n.closed&&t.subscribe(n)})}let x8=(()=>{class e{transform(e){const t=e%60,n=(e-t)%3600/60,r=(e-60*n-t)/3600,i=[];if(r>1?i.push($localize`${r} hours`):1===r&&i.push($localize`1 hour`),n>1?i.push($localize`${n} minutes`):1===n&&i.push($localize`1 minute`),t>1?i.push($localize`${t} seconds`):1===t&&i.push($localize`1 second`),0===i.length)return $localize`0 seconds`;if(1===i.length)return i[0];{const e=i.slice(0,-1).join(", "),t=i.slice(-1)[0];return $localize`${e} and ${t}`}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=ot({name:"humanDuration",type:e,pure:!0}),e})();function D8(e,t){if(1&e&&(ma(0),Qa(1),ya()),2&e){const e=Sa(3);Ts(1),Xa(e.viewInfo.chosenOpponent)}}function L8(e,t){1&e&&sc(0,44)}function F8(e,t){if(1&e&&(fa(0,"div",45),fa(1,"div",8),fa(2,"label",46),ma(3),sc(4,47),ya(),fa(5,"output"),Qa(6),ku(7,"humanDuration"),pa(),pa(),fa(8,"div",37),ga(9,"input",48),pa(),pa(),fa(10,"div",8),fa(11,"label",49),rc(12,50),ga(13,"output"),ku(14,"humanDuration"),ic(),pa(),fa(15,"div",37),ga(16,"input",51),pa(),pa(),pa()),2&e){const e=Sa(3);Ts(6),Xa(Au(7,2,e.viewInfo.maximalMoveDuration||0)),Ts(8),oc(Au(14,4,e.viewInfo.totalPartDuration||0)),ac(12)}}function U8(e,t){1&e&&(fa(0,"div"),rc(1,52),ga(2,"br"),ic(),pa())}function V8(e,t){1&e&&(fa(0,"button",64),sc(1,65),pa())}function B8(e,t){if(1&e){const e=va();fa(0,"tr",60),Ea("click",function(){const t=Gt(e).$implicit;return Sa(4).selectOpponent(t)}),fa(1,"td",61),Qa(2),pa(),fa(3,"td",62),la(4,V8,2,0,"button",63),pa(),pa()}if(2&e){const e=t.$implicit,n=Sa(4);Ta("id","presenceOf_",e,""),ha("ngClass",n.viewInfo.candidateClasses[e]),Ts(1),ha("id",n.viewInfo.chosenOpponent===e?"selected_"+e:"candidate_"+e),Ts(1),Xa(e),Ts(2),ha("ngIf",n.viewInfo.chosenOpponent!==e)}}function $8(e,t){if(1&e&&(ma(0),sc(1,53),ya(),fa(2,"div",54),fa(3,"table",55),fa(4,"thead"),fa(5,"tr"),fa(6,"th",56),sc(7,57),pa(),fa(8,"th",56),sc(9,58),pa(),pa(),pa(),fa(10,"tbody"),la(11,B8,5,5,"tr",59),pa(),pa(),pa()),2&e){const e=Sa(3);Ts(11),ha("ngForOf",e.viewInfo.candidates)}}function z8(e,t){if(1&e){const e=va();fa(0,"button",66),Ea("click",function(){return Gt(e),Sa(3).changeConfig()}),sc(1,67),pa()}}function H8(e,t){if(1&e){const e=va();fa(0,"div"),fa(1,"h1",4),sc(2,5),pa(),fa(3,"form",6),fa(4,"fieldset",7),fa(5,"div",8),fa(6,"label",9),sc(7,10),pa(),fa(8,"div",11),fa(9,"button",12),Ea("click",function(){return Gt(e),Sa(2).selectFirstPlayer("RANDOM")}),sc(10,13),pa(),fa(11,"button",14),Ea("click",function(){return Gt(e),Sa(2).selectFirstPlayer("CREATOR")}),sc(12,15),pa(),fa(13,"button",16),Ea("click",function(){return Gt(e),Sa(2).selectFirstPlayer("CHOSEN_PLAYER")}),la(14,D8,2,1,"ng-container",17),la(15,L8,1,0,"ng-template",null,18,Ku),pa(),pa(),pa(),fa(17,"div",8),fa(18,"label",9),sc(19,19),pa(),fa(20,"div",11),fa(21,"div",20),Ea("click",function(){return Gt(e),Sa(2).selectPartType("STANDARD")}),fa(22,"div",21),fa(23,"span"),sc(24,22),pa(),pa(),fa(25,"div",23),fa(26,"div",24),fa(27,"div",25),fa(28,"p"),ma(29),sc(30,26),ya(),fa(31,"strong"),Qa(32),ku(33,"humanDuration"),pa(),ga(34,"br"),ma(35),rc(36,27),ga(37,"strong"),ku(38,"humanDuration"),ic(),ya(),pa(),pa(),pa(),pa(),pa(),fa(39,"div",28),Ea("click",function(){return Gt(e),Sa(2).selectPartType("BLITZ")}),fa(40,"div",21),fa(41,"span"),sc(42,29),pa(),pa(),fa(43,"div",23),fa(44,"div",24),fa(45,"div",25),fa(46,"p"),ma(47),sc(48,30),ya(),fa(49,"strong"),Qa(50),ku(51,"humanDuration"),pa(),ga(52,"br"),ma(53),rc(54,31),ga(55,"strong"),ku(56,"humanDuration"),ic(),ya(),pa(),pa(),pa(),pa(),pa(),fa(57,"button",32),Ea("click",function(){return Gt(e),Sa(2).selectPartType("CUSTOM")}),sc(58,33),pa(),pa(),pa(),la(59,F8,17,6,"div",34),fa(60,"div",8),fa(61,"label",35),sc(62,36),pa(),fa(63,"div",37),la(64,U8,3,0,"div",17),la(65,$8,12,1,"ng-template",null,38,Ku),pa(),pa(),pa(),fa(67,"div",8),fa(68,"div",11),fa(69,"button",39),Ea("click",function(){return Gt(e),Sa(2).proposeConfig()}),sc(70,40),pa(),la(71,z8,2,0,"button",41),fa(72,"button",42),Ea("click",function(){return Gt(e),Sa(2).cancelGameCreation()}),sc(73,43),pa(),pa(),pa(),pa(),pa()}if(2&e){const e=ca(16),t=ca(66),n=Sa(2);Ts(3),ha("formGroup",n.configFormGroup),Ts(1),ha("disabled",!n.viewInfo.canEditConfig),Ts(5),ha("ngClass",n.viewInfo.firstPlayerClasses.RANDOM),Ts(2),ha("ngClass",n.viewInfo.firstPlayerClasses.CREATOR),Ts(2),ha("ngClass",n.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),Ts(1),ha("ngIf",n.viewInfo.chosenOpponent)("ngIfElse",e),Ts(7),ha("ngClass",n.viewInfo.partTypeClasses.STANDARD),Ts(11),Xa(Au(33,19,n.partType.NORMAL_MOVE_DURATION)),Ts(6),oc(Au(38,21,n.partType.NORMAL_PART_DURATION)),ac(36),Ts(1),ha("ngClass",n.viewInfo.partTypeClasses.BLITZ),Ts(11),Xa(Au(51,23,n.partType.BLITZ_MOVE_DURATION)),Ts(6),oc(Au(56,25,n.partType.BLITZ_PART_DURATION)),ac(54),Ts(1),ha("ngClass",n.viewInfo.partTypeClasses.CUSTOM),Ts(2),ha("ngIf",n.viewInfo.showCustomTime),Ts(5),ha("ngIf",0===n.viewInfo.candidates.length)("ngIfElse",t),Ts(5),ha("disabled",!n.viewInfo.canProposeConfig),Ts(2),ha("ngIf",n.viewInfo.canReviewConfig)}}function G8(e,t){if(1&e&&(fa(0,"div",74),fa(1,"p"),rc(2,75),ga(3,"br"),ic(),pa(),pa()),2&e){const e=Sa(3);Ts(3),oc(e.viewInfo.creator),ac(2)}}function Z8(e,t){if(1&e&&(fa(0,"span"),sc(1,81),pa()),2&e){const e=Sa(4);Ts(1),oc(e.viewInfo.creator),ac(1)}}function q8(e,t){1&e&&(fa(0,"span"),sc(1,82),pa())}function W8(e,t){1&e&&(fa(0,"span"),sc(1,83),pa())}function j8(e,t){if(1&e){const e=va();fa(0,"div",74),fa(1,"p"),sc(2,76),pa(),fa(3,"ul"),fa(4,"li"),la(5,Z8,2,1,"span",2),la(6,q8,2,0,"span",2),la(7,W8,2,0,"span",2),pa(),fa(8,"li"),rc(9,77),ga(10,"strong"),ku(11,"humanDuration"),ic(),pa(),fa(12,"li"),rc(13,78),ga(14,"strong"),ku(15,"humanDuration"),ic(),pa(),pa(),fa(16,"button",79),Ea("click",function(){return Gt(e),Sa(3).acceptConfig()}),sc(17,80),pa(),pa()}if(2&e){const e=Sa(3);Ts(2),oc(e.viewInfo.creator)(e.viewInfo.partTypeName),ac(2),Ts(3),ha("ngIf","CREATOR"===e.viewInfo.firstPlayer),Ts(1),ha("ngIf","CHOSEN_PLAYER"===e.viewInfo.firstPlayer),Ts(1),ha("ngIf","RANDOM"===e.viewInfo.firstPlayer),Ts(4),oc(Au(11,7,e.viewInfo.maximalMoveDuration||0)),ac(9),Ts(4),oc(Au(15,9,e.viewInfo.totalPartDuration||0)),ac(13)}}function Y8(e,t){if(1&e&&(fa(0,"div"),fa(1,"div",68),fa(2,"div",69),fa(3,"p"),sc(4,70),pa(),pa(),fa(5,"div",71),la(6,G8,4,1,"div",72),la(7,j8,18,11,"ng-template",null,73,Ku),pa(),pa(),pa()),2&e){const e=ca(8),t=Sa(2);Ts(6),ha("ngIf",t.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function K8(e,t){if(1&e&&(ma(0),sc(1,86),ya()),2&e){const e=Sa(3);Ts(1),oc(e.viewInfo.creator),ac(1)}}function Q8(e,t){if(1&e&&sc(0,87),2&e){const e=Sa(3);oc(e.viewInfo.creator)(e.viewInfo.chosenOpponent),ac(0)}}function X8(e,t){if(1&e&&(fa(0,"div",68),fa(1,"div",69),fa(2,"p"),sc(3,84),pa(),pa(),fa(4,"div",71),fa(5,"p"),la(6,K8,2,1,"ng-container",17),la(7,Q8,1,2,"ng-template",null,85,Ku),pa(),pa(),pa()),2&e){const e=ca(8),t=Sa(2);Ts(6),ha("ngIf",t.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function J8(e,t){if(1&e&&(fa(0,"div",1),la(1,H8,74,27,"div",2),la(2,Y8,9,2,"div",2),la(3,X8,9,2,"div",3),pa()),2&e){const e=Sa();Ts(1),ha("ngIf",e.viewInfo.userIsCreator),Ts(1),ha("ngIf",e.viewInfo.userIsChosenOpponent),Ts(1),ha("ngIf",e.viewInfo.userIsObserver)}}class e7{constructor(e,t,n,r,i,s,o,l){this.router=e,this.connectedUserService=t,this.gameService=n,this.configRoomService=r,this.chatService=i,this.userService=s,this.formBuilder=o,this.messageDisplayer=l,this.partType=EZ,this.gameStartNotification=new xu,this.gameStarted=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentConfigRoom=null,this.candidates=[],this.ngUnsubscribe=new A,this.allUserInterval=Nw.empty(),this.ownTokenInterval=Nw.empty(),this.selfSubscription=new a,this.configRoomSubscription=new a,this.candidatesSubscription=new a,this.allDocDeleted=!1,Iw(e7.VERBOSE,"PartCreationComponent constructed")}ngOnInit(){var e=this;return Ow(function*(){Iw(e7.VERBOSE,"PartCreationComponent.ngOnInit"),e.checkInputs(),e.createForms();const t=yield e.configRoomService.joinGame(e.partId);if(t.isFailure()){const n=t.getReason();e.messageDisplayer.criticalMessage(n)}else yield e.updateUserDocWithObservedPart(),yield e.startSendingPresenceTokens(),e.subscribeToConfigRoomDoc(),e.subscribeToFormElements(),Iw(e7.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds")})()}checkInputs(){const e=this.connectedUserService.user;hZ(e.isPresent()&&e.get()!==mZ.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),hZ(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}createForms(){this.configFormGroup=this.formBuilder.group({firstPlayer:[_Z.RANDOM.value,hp.required],maximalMoveDuration:[EZ.NORMAL_MOVE_DURATION,hp.required],partType:["STANDARD",hp.required],totalPartDuration:[EZ.NORMAL_PART_DURATION,hp.required],chosenOpponent:["",hp.required]})}updateUserDocWithObservedPart(){return Iw(e7.VERBOSE,"updateUserDocWithObservedPart of '"+this.partId+"'"),this.connectedUserService.updateObservedPart(this.partId)}subscribeToConfigRoomDoc(){var e=this;const t=function(){var t=Ow(function*(t){yield e.onCurrentConfigRoomUpdate(t)});return function(e){return t.apply(this,arguments)}}(),n=function(){var t=Ow(function*(t){yield e.onCandidatesUpdate(t)});return function(e){return t.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,t),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,n)}getForm(e){return Tw.getNonNullable(this.configFormGroup.get(e))}subscribeToFormElements(){this.getForm("chosenOpponent").valueChanges.pipe(R8(this.ngUnsubscribe)).subscribe(e=>{void 0!==this.viewInfo.chosenOpponent&&(this.viewInfo.candidateClasses[this.viewInfo.chosenOpponent]=[]),this.viewInfo.candidateClasses[e]=["is-selected"],this.viewInfo.chosenOpponent=e;const t=Tw.getNonNullable(this.currentConfigRoom).partStatus;this.viewInfo.canProposeConfig=t!==wZ.CONFIG_PROPOSED.value&&""!==e}),this.getForm("partType").valueChanges.pipe(R8(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.partTypeClasses[this.viewInfo.partType]=[],this.viewInfo.partTypeClasses[e]=["is-primary","is-selected"],this.viewInfo.partType=e,this.viewInfo.showCustomTime="CUSTOM"===e}),this.getForm("maximalMoveDuration").valueChanges.pipe(R8(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.maximalMoveDuration=e}),this.getForm("totalPartDuration").valueChanges.pipe(R8(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.totalPartDuration=e}),this.getForm("firstPlayer").valueChanges.pipe(R8(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.firstPlayerClasses[this.viewInfo.firstPlayer]=[],this.viewInfo.firstPlayerClasses[e]=["is-primary","is-selected"],this.viewInfo.firstPlayer=e})}updateViewInfo(){const e=Tw.getNonNullable(this.currentConfigRoom),t=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=e.partStatus===wZ.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=e.partStatus!==wZ.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=t.id===e.creator.id,this.viewInfo.userIsChosenOpponent=t.id===e.chosenOpponent?.id,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=e.partStatus!==wZ.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=e.creator.name,this.viewInfo.candidates=this.candidates.map(e=>e.name),t.id===e.creator.id?this.setDataForCreator(e):(this.viewInfo.maximalMoveDuration=e.maximalMoveDuration,this.viewInfo.totalPartDuration=e.totalPartDuration,this.viewInfo.partType=e.partType,this.viewInfo.chosenOpponent=e.chosenOpponent?.name,this.viewInfo.firstPlayer=e.firstPlayer),e.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize`custom`;break;case"BLITZ":this.viewInfo.partTypeName=$localize`blitz`;break;case"STANDARD":this.viewInfo.partTypeName=$localize`standard`}}setDataForCreator(e){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration??e.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration??e.totalPartDuration;let t=this.viewInfo.chosenOpponent;null==t||""===t?t=e.chosenOpponent?.name??"":!1===this.candidates.some(e=>e.name===t)&&(t=""),this.getForm("chosenOpponent").setValue(t)}selectFirstPlayer(e){this.getForm("firstPlayer").setValue(e)}selectPartType(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(EZ.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(EZ.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(EZ.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(EZ.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}selectOpponent(e){var t=this;return Ow(function*(){Iw(e7.VERBOSE,"PartCreationComponent.setChosenOpponent("+e+")");const n=t.getUserFromName(e);return t.configRoomService.setChosenOpponent(t.partId,n)})()}getUserFromName(e){const t=this.candidates.find(t=>t.name===e);return Tw.getNonNullable(t)}changeConfig(){var e=this;return Ow(function*(){return e.configRoomService.reviewConfig(e.partId)})()}proposeConfig(){var e=this;return Ow(function*(){const t=e.getForm("chosenOpponent").value,n=e.getForm("partType").value,r=e.getForm("maximalMoveDuration").value,i=e.getForm("firstPlayer").value,s=e.getForm("totalPartDuration").value,o=e.getUserFromName(t);return e.configRoomService.proposeConfig(e.partId,o,EZ.of(n),r,_Z.of(i),s)})()}cancelGameCreation(){var e=this;return Ow(function*(){e.allDocDeleted=!0,yield e.connectedUserService.removeObservedPart(),Iw(e7.VERBOSE,"PartCreationComponent.cancelGameCreation"),yield e.chatService.deleteChat(e.partId),Iw(e7.VERBOSE,"PartCreationComponent.cancelGameCreation: chat deleted"),yield e.gameService.deletePart(e.partId),Iw(e7.VERBOSE,"PartCreationComponent.cancelGameCreation: chat and part deleted"),yield e.configRoomService.deleteConfigRoom(e.partId,e.candidates),Iw(e7.VERBOSE,"PartCreationComponent.cancelGameCreation: chat, part, and configRoom deleted")})()}onCurrentConfigRoomUpdate(e){var t=this;return Ow(function*(){if(Iw(e7.VERBOSE,{PartCreationComponent_onCurrentConfigRoomUpdate:{before:JSON.stringify(t.currentConfigRoom),then:JSON.stringify(e)}}),e.isAbsent())return Iw(e7.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: LAST UPDATE : the game is cancelled"),t.onGameCancelled();if(t.chosenOpponentJustLeft(e.get())){const e=Tw.getNonNullable(t.currentConfigRoom),n=Tw.getNonNullable(e.chosenOpponent).name;t.messageDisplayer.infoMessage($localize`${n} left the game, please pick another opponent.`)}t.currentConfigRoom=e.get(),t.allUserInterval.isAbsent()&&(yield t.observePlayers()),t.updateViewInfo(),t.isGameStarted()&&(Iw(e7.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: the game has started"),t.onGameStarted())})()}onCandidatesUpdate(e){var t=this;return Ow(function*(){t.candidates=e,t.updateViewInfo()})()}chosenOpponentJustLeft(e){return null!=this.currentConfigRoom&&(null!=this.currentConfigRoom.chosenOpponent&&null==e.chosenOpponent)}onGameCancelled(){var e=this;return Ow(function*(){Iw(e7.VERBOSE,"PartCreationComponent.onGameCancelled"),e.messageDisplayer.infoMessage($localize`The game has been canceled!`),yield e.router.navigate(["/lobby"])})()}isGameStarted(){return Tw.getNonNullable(this.currentConfigRoom).partStatus===wZ.PART_STARTED.value}onGameStarted(){const e=Tw.getNonNullable(this.currentConfigRoom);Iw(e7.VERBOSE,{partCreationComponent_onGameStarted:{configRoom:e}}),this.gameStartNotification.emit(e),this.gameStarted=!0,Iw(e7.VERBOSE,"PartCreationComponent.onGameStarted finished")}observePlayers(){var e=this;return Ow(function*(){hZ(e.allUserInterval.isAbsent(),"Cannot observe players multiple times");const t=e.connectedUserService.user.get().id;e.allUserInterval=Nw.of(window.setInterval(Ow(function*(){const n=Tw.getNonNullable(e.currentConfigRoom),r=e.lastToken;t===n.creator.id?yield e.checkCandidatesTokensFreshness(r):yield e.checkCreatorTokenFreshness(r)}),e7.TOKEN_INTERVAL))})()}checkCreatorTokenFreshness(e){var t=this;return Ow(function*(){const n=Tw.getNonNullable(t.currentConfigRoom);(yield t.didUserTimeout(n.creator.id,e))&&(yield t.destroyDocIfPartDidNotStart())})()}destroyDocIfPartDidNotStart(){var e=this;return Ow(function*(){hZ(!1==(Tw.getNonNullable(e.currentConfigRoom).partStatus===wZ.PART_STARTED.value),"Should not try to cancelGameCreation when part started!"),hZ(!1===e.allDocDeleted,"Should not delete doc twice"),yield e.cancelGameCreation()})()}checkCandidatesTokensFreshness(e){var t=this;return Ow(function*(){for(const n of t.candidates)(yield t.didUserTimeout(n.id,e))&&(yield t.removeCandidateFromLobby(n))})()}didUserTimeout(e,t){var n=this;return Ow(function*(){const r=yield n.userService.getUserLastUpdateTime(e);return r.isAbsent()?(uZ.logError("PartCreationComponent","found no user while observing "+e+" !"),!0):N8(r.get(),t)>e7.TOKEN_TIMEOUT})()}removeCandidateFromLobby(e){var t=this;return Ow(function*(){const n=Tw.getNonNullable(t.currentConfigRoom);return e.id===n.chosenOpponent?.id&&(yield t.configRoomService.reviewConfigAndRemoveChosenOpponent(t.partId)),t.configRoomService.removeCandidate(t.partId,e)})()}startSendingPresenceTokens(){var e=this;return Ow(function*(){yield e.connectedUserService.sendPresenceToken(),hZ(e.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),e.ownTokenInterval=Nw.of(window.setInterval(()=>{e.connectedUserService.sendPresenceToken()},e7.TOKEN_INTERVAL));const t=e.connectedUserService.user.get().id;e.selfSubscription=e.userService.observeUser(t,t=>{hZ(t.isPresent(),"connected user should exist");const n=t.get();null!=n.lastUpdateTime&&(e.lastToken=n.lastUpdateTime)})})()}stopSendingPresenceTokensAndObservingUsersIfNeeded(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=Nw.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}acceptConfig(){return Iw(e7.VERBOSE,"PartCreationComponent.acceptConfig"),this.gameService.acceptConfig(this.partId,Tw.getNonNullable(this.currentConfigRoom))}ngOnDestroy(){var e=this;return Ow(function*(){Iw(e7.VERBOSE,"PartCreationComponent.ngOnDestroy"),e.ngUnsubscribe.next(),e.ngUnsubscribe.complete(),e.configRoomSubscription.unsubscribe(),e.candidatesSubscription.unsubscribe(),e.stopSendingPresenceTokensAndObservingUsersIfNeeded();const t=e.connectedUserService.user.get();!0!==e.gameStarted&&(null===e.currentConfigRoom?Iw(e7.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"):!0===e.allDocDeleted?Iw(e7.VERBOSE,"PartCreationComponent.ngOnDestroy: part has already been deleted"):t.id===e.currentConfigRoom.creator.id?(Iw(e7.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),yield e.cancelGameCreation()):(Iw(e7.VERBOSE,"PartCreationComponent.ngOnDestroy: you are about to cancel game joining"),yield e.connectedUserService.removeObservedPart(),yield e.configRoomService.cancelJoining(e.partId)))})()}}function t7(e,t){if(1&e){const e=va();fa(0,"button",3),Ea("click",function(){return Gt(e),Sa().addTime()}),sc(1,4),pa()}if(2&e){const e=Sa();Ts(1),oc(e.timeToAdd),ac(1)}}e7.VERBOSE=!1,e7.TOKEN_INTERVAL=5e3,e7.TOKEN_TIMEOUT=2*e7.TOKEN_INTERVAL,e7.\u0275fac=function(e){return new(e||e7)(ua(gC),ua(yZ),ua(FZ),ua(LZ),ua(oZ),ua(fZ),ua(Ug),ua(cZ))},e7.\u0275cmp=Je({type:e7,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){let e,t,n,r,i,s,o,a,l,c,u,h,d,f,p,g,m,y,v,C,_,E,w,P,S,b,O,T,I,k,A,M,N,R,x,D;return e=$localize`Game creation`,t=$localize`First player`,n=$localize`Random`,r=$localize`You`,i=$localize`Game type`,s=$localize`Standard`,o=$localize`Maximal turn duration: `,a=$localize`Maximal game duration: ${"\ufffd#37\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#37\ufffd"}:CLOSE_TAG_STRONG:`,l=$localize`Blitz`,c=$localize`Maximal turn duration: `,u=$localize`Maximal game duration: ${"\ufffd#55\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#55\ufffd"}:CLOSE_TAG_STRONG:`,h=$localize`Custom`,d=$localize`Opponents`,f=$localize`Propose configuration`,p=$localize`Cancel game`,g=$localize`The opponent`,m=$localize`Maximal turn duration: `,y=$localize`Maximal game duration: ${"\ufffd#13\ufffd"}:START_TAG_OUTPUT:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#13\ufffd"}:CLOSE_TAG_OUTPUT:`,v=$localize`Potential opponents that join the game will appear here.${"\ufffd#2\ufffd\ufffd/#2\ufffd"}:LINE_BREAK:Wait for an opponent to join, so that you can pick one.`,C=$localize`Click on the opponent against which you would like to play.`,_=$localize`Name`,E=$localize`Actions`,w=$localize`Pick`,P=$localize`Change configuration`,S=$localize`Configuration proposal`,b=$localize`You have been selected as the opponent.${"\ufffd#3\ufffd\ufffd/#3\ufffd"}:LINE_BREAK: ${"\ufffd0\ufffd"}:INTERPOLATION: is modifying the configuration.`,O=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: proposes to play a ${"\ufffd1\ufffd"}:INTERPOLATION_1: game`,T=$localize`a turn lasts at most ${"\ufffd#10\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#10\ufffd"}:CLOSE_TAG_STRONG:`,I=$localize`the game lasts at most ${"\ufffd#14\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#14\ufffd"}:CLOSE_TAG_STRONG:`,k=$localize`Accept and start`,A=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: plays first`,M=$localize`you play first`,N=$localize`the first player is selected randomly`,R=$localize`One moment...`,x=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: is configuring the game.`,D=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has proposed a configuration to ${"\ufffd1\ufffd"}:INTERPOLATION_1:.`,[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],e,[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],t,[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],n,["id","firstPlayerCreator",1,"button",3,"ngClass","click"],r,["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],i,["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],s,["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],o,a,["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],l,c,u,["id","partTypeCustom",1,"button",3,"ngClass","click"],h,["id","customTime",4,"ngIf"],[1,"label"],d,[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],f,["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],p,g,["id","customTime"],["for","maximalMoveDuration",1,"label"],m,["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],y,["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],v,C,["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],_,E,[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],w,["id","reviewConfig",1,"button",3,"click"],P,[1,"message","is-primary"],[1,"message-header"],S,[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],b,O,T,I,["id","acceptConfig",1,"button","is-primary",3,"click"],k,A,M,N,R,["proposalSent",""],x,D]},template:function(e,t){1&e&&la(0,J8,4,3,"div",0),2&e&&ha("ngIf",t.viewInfo)},directives:[rf,pg,Lp,_g,Jd,sp,yg,Dp,wg,tf],pipes:[x8],encapsulation:2});let n7=(()=>{class e{constructor(){this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new xu,this.addTimeToOpponent=new xu,this.cssClasses=e.SAFE_TIME}ngOnInit(){Iw(e.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}setDuration(t){if(Iw(e.VERBOSE,this.debugName+".set("+t+"ms)"),this.started)throw new Error("Should not set a chrono that has already been started ("+this.debugName+")!");this.isSet=!0,this.changeDuration(t)}changeDuration(e){let t=!1;!1===this.isPaused&&(this.pause(),t=!0),this.remainingMs=e,this.displayDuration(),t&&this.resume()}displayDuration(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}start(){if(Iw(e.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),!1===this.isSet)throw new Error("Should not start a chrono that has not been set!");if(this.started)throw new Error("Should not start chrono that has already been started ("+this.debugName+")");this.started=!0,this.resume()}resume(){if(Iw(e.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),!1===this.isPaused||!1===this.started)throw new Error("Should only resume chrono that are started and paused!");this.startTime=Date.now();const t=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(()=>{this.onEndReached()},t),this.countSeconds()}onEndReached(){Iw(e.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}countSeconds(){this.timeoutHandleSec=window.setTimeout(()=>{this.updateShownTime()},1e3)}isIdle(){return!1===this.started||this.isPaused}pause(){if(Iw(e.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),!this.started)throw new Error("Should not pause not started chrono ("+this.debugName+")");if(this.isPaused)throw new Error("Should not pause already paused chrono ("+this.debugName+")");this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}stop(){if(Iw(e.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),!1===this.started)throw new Error("Should only stop chrono that are started!");this.pause(),this.started=!1,this.isSet=!1}isStarted(){return this.started}getTimeClass(){return!1===this.active?e.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?e.DANGER_TIME_ODD:e.DANGER_TIME_EVEN:e.SAFE_TIME}updateShownTime(){const e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}clearTimeouts(){Iw(e.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}addTime(){this.addTimeToOpponent.emit()}ngOnDestroy(){this.clearTimeouts()}}return e.VERBOSE=!1,e.DANGER_TIME_EVEN="has-background-danger has-text-white",e.DANGER_TIME_ODD="has-background-warning has-text-white",e.PASSIVE_STYLE="has-text-passive is-italic",e.SAFE_TIME="",e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Je({type:e,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){let e;return e=$localize`Add ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],e]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"p",1),Qa(2),ku(3,"number"),pa(),la(4,t7,2,1,"button",2),pa()),2&e&&(ha("ngClass",t.getTimeClass()),Ts(2),el("",t.displayedMinute,":",function(e,t,n,r){const i=e+20,s=zt(),o=Rt(s,i);return Nu(s,Mu(s,i)?Iu(s,Jt(),t,o.transform,n,r,o):o.transform(n,r))}(3,4,t.displayedSec,"2.0-0"),""),Ts(2),ha("ngIf",t.canAddTime))},directives:[Jd,rf],pipes:[af],encapsulation:2}),e})();const r7=["partCreation"],i7=["chatComponent"],s7=["chronoZeroGlobal"],o7=["chronoOneGlobal"],a7=["chronoZeroTurn"],l7=["chronoOneTurn"];function c7(e,t){if(1&e){const e=va();fa(0,"app-part-creation",5,6),Ea("gameStartNotification",function(t){return Gt(e),Sa().startGame(t)}),pa()}2&e&&ha("partId",Sa().currentPartId)}function u7(e,t){1&e&&(ma(0),sc(1,40),ya())}function h7(e,t){if(1&e&&(ma(0),sc(1,41),ya()),2&e){const e=Sa(4);Ts(1),oc(null==e.currentPlayer?null:e.currentPlayer.name),ac(1)}}function d7(e,t){if(1&e&&(fa(0,"p",37),la(1,u7,2,0,"ng-container",38),la(2,h7,2,1,"ng-template",null,39,Ku),pa()),2&e){const e=ca(3),t=Sa(3);Ts(1),ha("ngIf",(null==t.currentPlayer?null:t.currentPlayer.name)===t.getPlayer().name)("ngIfElse",e)}}function f7(e,t){if(1&e&&(fa(0,"div",33),fa(1,"p",34),sc(2,35),pa(),la(3,d7,4,2,"p",36),pa()),2&e){const e=Sa(2);Ts(2),oc(e.currentPart.getTurn()+1),ac(2),Ts(1),ha("ngIf",!1===e.endGame)}}function p7(e,t){if(1&e&&(fa(0,"p",42),Qa(1),pa()),2&e){const e=Sa(2);ha("ngClass",e.getPlayerNameClass(e.Player.ZERO)),Ts(1),Xa(e.players[0].get().name)}}function g7(e,t){if(1&e&&(fa(0,"p",43),sc(1,44),pa()),2&e){const e=Sa(2);Ts(1),oc(e.gameComponent.scores.get()[0]),ac(1)}}function m7(e,t){if(1&e&&(fa(0,"p",45),Qa(1),pa()),2&e){const e=Sa(2);ha("ngClass",e.getPlayerNameClass(e.Player.ONE)),Ts(1),Xa(e.players[1].get().name)}}function y7(e,t){if(1&e&&(fa(0,"p",46),sc(1,47),pa()),2&e){const e=Sa(2);Ts(1),oc(e.gameComponent.scores.get()[1]),ac(1)}}function v7(e,t){if(1&e){const e=va();fa(0,"button",56),Ea("click",function(){return Gt(e),Sa(3).resign()}),sc(1,57),pa()}}function C7(e,t){if(1&e){const e=va();fa(0,"button",58),Ea("click",function(){return Gt(e),Sa(3).proposeDraw()}),sc(1,59),pa()}}function _7(e,t){if(1&e){const e=va();fa(0,"button",60),Ea("click",function(){return Gt(e),Sa(3).acceptDraw()}),sc(1,61),pa()}}function E7(e,t){if(1&e){const e=va();fa(0,"button",62),Ea("click",function(){return Gt(e),Sa(3).refuseDraw()}),sc(1,63),pa()}}function w7(e,t){if(1&e){const e=va();fa(0,"button",64),Ea("click",function(){return Gt(e),Sa(3).gameComponent.pass()}),sc(1,65),pa()}}function P7(e,t){if(1&e){const e=va();fa(0,"button",66),Ea("click",function(){return Gt(e),Sa(3).acceptTakeBack()}),sc(1,67),pa()}}function S7(e,t){if(1&e){const e=va();fa(0,"button",68),Ea("click",function(){return Gt(e),Sa(3).refuseTakeBack()}),sc(1,69),pa()}}function b7(e,t){if(1&e){const e=va();fa(0,"button",70),Ea("click",function(){return Gt(e),Sa(3).askTakeBack()}),sc(1,71),pa()}}function O7(e,t){if(1&e&&(ma(0),la(1,v7,2,0,"button",48),la(2,C7,2,0,"button",49),la(3,_7,2,0,"button",50),la(4,E7,2,0,"button",51),la(5,w7,2,0,"button",52),la(6,P7,2,0,"button",53),la(7,S7,2,0,"button",54),la(8,b7,2,0,"button",55),ya()),2&e){const e=Sa(2);Ts(1),ha("ngIf",e.canResign()),Ts(1),ha("ngIf",e.canProposeDraw()),Ts(1),ha("ngIf",!1===e.endGame&&e.isOpponentWaitingForDrawResponse()),Ts(1),ha("ngIf",!1===e.endGame&&e.isOpponentWaitingForDrawResponse()),Ts(1),ha("ngIf",!1===e.endGame&&e.isPlaying()&&e.gameComponent.canPass&&(null==e.currentPlayer?null:e.currentPlayer.name)===e.getPlayer().name),Ts(1),ha("ngIf",!1===e.endGame&&e.isOpponentWaitingForTakeBackResponse()),Ts(1),ha("ngIf",!1===e.endGame&&e.isOpponentWaitingForTakeBackResponse()),Ts(1),ha("ngIf",!1===e.endGame&&!1===e.isOpponentWaitingForTakeBackResponse()&&e.canAskTakeBack())}}function T7(e,t){1&e&&(fa(0,"div"),fa(1,"p",73),sc(2,74),pa(),pa())}function I7(e,t){1&e&&(fa(0,"p",78),sc(1,79),pa())}function k7(e,t){1&e&&(fa(0,"p",80),sc(1,81),pa())}function A7(e,t){1&e&&(fa(0,"p",82),sc(1,83),pa())}function M7(e,t){if(1&e&&(fa(0,"div"),la(1,I7,2,0,"p",75),la(2,k7,2,0,"p",76),la(3,A7,2,0,"p",77),pa()),2&e){const e=Sa(3);Ts(1),ha("ngIf",e.currentPart.getDrawAccepter().name===e.getPlayer().name),Ts(1),ha("ngIf",e.currentPart.getDrawAccepter().name!==e.getPlayer().name&&e.isPlaying()),Ts(1),ha("ngIf",!1===e.isPlaying())}}function N7(e,t){1&e&&(fa(0,"p",86),sc(1,87),pa())}function R7(e,t){1&e&&(fa(0,"p",88),sc(1,89),pa())}function x7(e,t){if(1&e&&(fa(0,"p",88),sc(1,90),pa()),2&e){const e=Sa(4);Ts(1),oc(e.currentPart.getWinner().get().name),ac(1)}}function D7(e,t){if(1&e&&(fa(0,"div"),la(1,N7,2,0,"p",84),la(2,R7,2,0,"p",85),la(3,x7,2,1,"p",85),pa()),2&e){const e=Sa(3);Ts(1),ha("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),Ts(1),ha("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),Ts(1),ha("ngIf",!1===e.isPlaying())}}function L7(e,t){if(1&e&&(fa(0,"p",86),sc(1,91),pa()),2&e){const e=Sa(4);Ts(1),oc(e.currentPart.getLoser().get().name),ac(1)}}function F7(e,t){1&e&&(fa(0,"p",88),sc(1,92),pa())}function U7(e,t){if(1&e&&(fa(0,"p",88),sc(1,93),pa()),2&e){const e=Sa(4);Ts(1),oc(e.currentPart.getLoser().get().name),ac(1)}}function V7(e,t){if(1&e&&(fa(0,"div"),la(1,L7,2,1,"p",84),la(2,F7,2,0,"p",85),la(3,U7,2,1,"p",85),pa()),2&e){const e=Sa(3);Ts(1),ha("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),Ts(1),ha("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),Ts(1),ha("ngIf",!1===e.isPlaying())}}function B7(e,t){1&e&&(fa(0,"p",95),sc(1,96),pa())}function $7(e,t){if(1&e&&(fa(0,"p",95),sc(1,97),pa()),2&e){const e=Sa(4);Ts(1),oc(e.currentPart.getLoser().get().name),ac(1)}}function z7(e,t){if(1&e&&(fa(0,"div"),la(1,B7,2,0,"p",94),la(2,$7,2,1,"p",94),pa()),2&e){const e=Sa(3);Ts(1),ha("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),Ts(1),ha("ngIf",!1===e.isPlaying()||e.currentPart.getWinner().get().name===e.getPlayer().name)}}function H7(e,t){if(1&e&&(fa(0,"div",72),ga(1,"hr"),la(2,T7,3,0,"div",26),la(3,M7,4,3,"div",26),la(4,D7,4,3,"div",26),la(5,V7,4,3,"div",26),la(6,z7,3,2,"div",26),pa()),2&e){const e=Sa(2);Ts(2),ha("ngIf",e.currentPart.isHardDraw()),Ts(1),ha("ngIf",e.currentPart.isAgreedDraw()),Ts(1),ha("ngIf",e.currentPart.isWin()),Ts(1),ha("ngIf",e.currentPart.isTimeout()),Ts(1),ha("ngIf",e.currentPart.isResign())}}function G7(e,t){1&e&&(fa(0,"button",98),sc(1,99),pa())}function Z7(e,t){if(1&e){const e=va();fa(0,"button",100),Ea("click",function(){return Gt(e),Sa(2).proposeRematch()}),sc(1,101),pa()}}function q7(e,t){if(1&e){const e=va();fa(0,"button",102),Ea("click",function(){return Gt(e),Sa(2).acceptRematch()}),sc(1,103),pa()}}function W7(e,t){if(1&e){const e=va();fa(0,"div",7),fa(1,"div",8),fa(2,"div",9),la(3,f7,4,2,"div",10),fa(4,"div",11),la(5,p7,2,2,"p",12),la(6,g7,2,1,"p",13),fa(7,"app-count-down",14,15),Ea("outOfTimeAction",function(){Gt(e);const t=Sa();return t.reachedOutOfTime(t.Player.ZERO)})("addTimeToOpponent",function(){return Gt(e),Sa().addGlobalTime()}),pa(),fa(9,"app-count-down",16,17),Ea("outOfTimeAction",function(){Gt(e);const t=Sa();return t.reachedOutOfTime(t.Player.ZERO)})("addTimeToOpponent",function(){return Gt(e),Sa().addTurnTime()}),pa(),pa(),fa(11,"p",18),sc(12,19),pa(),fa(13,"div",11),la(14,m7,2,2,"p",20),la(15,y7,2,1,"p",21),fa(16,"app-count-down",22,23),Ea("outOfTimeAction",function(){Gt(e);const t=Sa();return t.reachedOutOfTime(t.Player.ONE)})("addTimeToOpponent",function(){return Gt(e),Sa().addGlobalTime()}),pa(),fa(18,"app-count-down",24,25),Ea("outOfTimeAction",function(){Gt(e);const t=Sa();return t.reachedOutOfTime(t.Player.ONE)})("addTimeToOpponent",function(){return Gt(e),Sa().addTurnTime()}),pa(),pa(),ga(20,"hr"),la(21,O7,9,8,"ng-container",26),la(22,H7,7,5,"div",27),la(23,G7,2,0,"button",28),la(24,Z7,2,0,"button",29),la(25,q7,2,0,"button",30),pa(),pa(),fa(26,"div",31),fa(27,"div",32),ga(28,"app-game-includer"),pa(),pa(),pa()}if(2&e){const e=Sa();Ts(3),ha("ngIf",e.currentPart),Ts(2),ha("ngIf",e.players[0].isPresent()),Ts(1),ha("ngIf",e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),Ts(1),ha("dangerTimeLimit",6e4)("active",null!=e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.observerRole===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),Ts(2),ha("dangerTimeLimit",15e3)("active",null!=e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.observerRole===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),Ts(5),ha("ngIf",e.players[1].isPresent()),Ts(1),ha("ngIf",e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),Ts(1),ha("dangerTimeLimit",6e4)("active",null!=e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.observerRole===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),Ts(2),ha("dangerTimeLimit",15e3)("active",null!=e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.observerRole===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),Ts(3),ha("ngIf",e.isPlaying()),Ts(1),ha("ngIf",e.endGame),Ts(1),ha("ngIf",e.endGame),Ts(1),ha("ngIf",e.endGame&&e.isPlaying()&&!1===e.rematchProposed),Ts(1),ha("ngIf",e.endGame&&e.isPlaying()&&e.rematchProposed&&e.opponentProposedRematch),Ts(1),ha("ngClass",e.getBoardHighlight())}}let j7=(()=>{class e{}return e.NO_MATCHING_PART=()=>$localize`The game you tried to join does not exist.`,e})();class Y7{constructor(e){this.value=e}}Y7.PRE_START_DOC=new Y7("PRE_START_DOC"),Y7.STARTING_DOC=new Y7("STARTING_DOC"),Y7.DUPLICATE=new Y7("DUPLICATE"),Y7.MOVE_WITHOUT_TIME=new Y7("MOVE_WITHOUT_TIME"),Y7.MOVE=new Y7("MOVE"),Y7.REQUEST=new Y7("REQUEST"),Y7.END_GAME=new Y7("END_GAME"),Y7.END_GAME_WITHOUT_TIME=new Y7("END_GAME_WITHOUT_TIME"),Y7.ACCEPT_TAKE_BACK_WITHOUT_TIME=new Y7("ACCEPT_TAKE_BACK_WITHOUT_TIME");let K7=(()=>{class e extends k8{constructor(t,n,r,i,s,o,l){super(t,n,s,r,i),this.userService=o,this.gameService=l,this.gameStarted=!1,this.opponent=null,this.rematchProposed=!1,this.opponentProposedRematch=!1,this.hasUserPlayed=[!1,!1],this.msToSubstract=[0,0],this.opponentSubscription=new a,this.partSubscription=new a,this.OFFLINE_FONT_COLOR={color:"lightgrey"},this.globalTimeMessage=$localize`5 minutes`,this.turnTimeMessage=$localize`30 seconds`,Iw(e.VERBOSE,"OnlineGameWrapperComponent constructed")}extractPartIdFromURL(){return Tw.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}extractGameNameFromURL(){return Tw.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}isPlaying(){return this.observerRole.isPlayer()}getPlayer(){return this.authUser.toMinimalUser()}isPlayer(e){return this.observerRole===e}isOpponent(e){return this.observerRole!==e}redirectIfPartOrGameIsInvalid(){var e=this;return Ow(function*(){const t=e.extractGameNameFromURL();if(Z6.ALL_GAMES().some(e=>e.urlName===t)){if((yield e.gameService.getPartValidity(e.currentPartId,t)).isFailure()){e.routerEventsSub.unsubscribe();const t=j7.NO_MATCHING_PART();yield e.router.navigate(["/notFound",t],{skipLocationChange:!0})}}else{e.routerEventsSub.unsubscribe();const n=I8.NO_MATCHING_GAME(t);yield e.router.navigate(["/notFound",n],{skipLocationChange:!0})}})()}setCurrentPartIdOrRedirect(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}ngOnInit(){var t=this;return Ow(function*(){Iw(e.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),t.routerEventsSub=t.router.events.subscribe(function(){var e=Ow(function*(e){e instanceof $m&&(yield t.setCurrentPartIdOrRedirect())});return function(t){return e.apply(this,arguments)}}()),t.userSub=t.connectedUserService.subscribeToUser(e=>{t.authUser=e}),yield t.setCurrentPartIdOrRedirect(),Iw(e.VERBOSE,"OnlineGameWrapperComponent.ngOnInit done")})()}startGame(t){var n=this;return Ow(function*(){Iw(e.VERBOSE,"OnlineGameWrapperComponent.startGame"),hZ(!1===n.gameStarted,"Should not start already started game"),n.configRoom=t,n.gameStarted=!0,window.setTimeout(Ow(function*(){hZ(yield n.afterGameIncluderViewInit(),"Game should be created successfully, otherwise part-creation would have redirected"),n.startPart()}),1)})()}startPart(){var t=this;Iw(e.VERBOSE,"OnlineGameWrapperComponent.startPart"),this.partSubscription=this.gameService.subscribeToChanges(this.currentPartId,function(){var e=Ow(function*(e){hZ(e.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),yield t.onCurrentPartUpdate(e.get())});return function(t){return e.apply(this,arguments)}}())}onCurrentPartUpdate(t){var n=this;return Ow(function*(){const r=new CZ(n.currentPartId,t);Iw(e.VERBOSE,{OnlineGameWrapperComponent_onCurrentPartUpdate:{before:n.currentPart,then:t.data,before_part_turn:r.data.turn,before_state_turn:n.gameComponent.rules.node.gameState.turn,nbPlayedMoves:r.data.listMoves.length}});const i=n.getUpdateType(r),s=t.turn;Iw(e.VERBOSE,i===Y7.REQUEST?"UpdateType: Request("+Tw.getNonNullable(r.data.request).code+") ("+s+")":"UpdateType: "+i.value+"("+s+")");const o=n.currentPart;switch(n.currentPart=r,i){case Y7.REQUEST:return yield n.onRequest(Tw.getNonNullable(r.data.request),o);case Y7.ACCEPT_TAKE_BACK_WITHOUT_TIME:return void(n.currentPart=o);case Y7.DUPLICATE:return;case Y7.END_GAME_WITHOUT_TIME:return void(n.currentPart=o);case Y7.END_GAME:return n.applyEndGame();case Y7.MOVE_WITHOUT_TIME:return void(n.currentPart=o);case Y7.MOVE:return n.msToSubstract=n.getLastUpdateTime(o,r,i),n.doNewMoves(r);case Y7.PRE_START_DOC:const e=null==n.currentPart||null!=n.currentPart.data.beginning;return void hZ(null==o||null==o.data.beginning||e,"old part had no beginning time or new part has, we did not expect this!");default:return hZ(i===Y7.STARTING_DOC,"Unexpected update type "+i),n.setChronos(),n.setPlayersDatas(r),n.startCountDownFor(TZ.ZERO)}})()}getUpdateType(t){const n=A8.from(null!=this.currentPart?this.currentPart.data:null,t.data);Iw(e.VERBOSE,{diff:n});const r=n.countChanges();if(0===r)return Y7.DUPLICATE;if(t.data.request){const e=null!=n.removed.lastUpdateTime;return"TakeBackAccepted"===t.data.request.code&&e?Y7.ACCEPT_TAKE_BACK_WITHOUT_TIME:Y7.REQUEST}if(this.isMove(n,r))return 1===t.data.turn?null==t.data.lastUpdateTime?Y7.MOVE_WITHOUT_TIME:Y7.MOVE:null==n.modified.lastUpdateTime?Y7.MOVE_WITHOUT_TIME:Y7.MOVE;if(null==t.data.beginning)return Y7.PRE_START_DOC;if(t.data.result!==vZ.UNACHIEVED.value){const e=null==n.modified.lastUpdateTime;return null!=n.modified.turn&&e?Y7.END_GAME_WITHOUT_TIME:Y7.END_GAME}return hZ(null!=t.data.beginning&&0===t.data.listMoves.length,"Unexpected update: "+JSON.stringify(n)),Y7.STARTING_DOC}isMove(e,t){if(null!=e.modified.listMoves&&null!=e.modified.turn){const n=3;return t===(e.isPresent("lastUpdateTime").present?1:0)+(e.isPresent("scorePlayerZero").present?1:0)+(e.isPresent("scorePlayerOne").present?1:0)+(e.isPresent("remainingMsForZero").present?1:0)+(e.isPresent("remainingMsForOne").present?1:0)+(null==e.removed.request?0:1)+n}return!1}getLastUpdateTime(e,t,n){const r=this.getMoreRecentTime(e),i=this.getMoreRecentTime(t);hZ(null!=r,"oldTime should not be null"),hZ(null!=i,"updateTime should not be null");const s=TZ.fromTurn(e.data.turn);return this.getTimeUsedForLastTurn(Tw.getNonNullable(r),Tw.getNonNullable(i),n,s)}getMoreRecentTime(e){return e.data.lastUpdateTime??e.data.beginning}getTimeUsedForLastTurn(e,t,n,r){const i=N8(e,t),s=[0,0];return s[r.value]=i,s}setChronos(){Iw(e.VERBOSE,"onlineGameWrapperComponent.setChronos()"),this.chronoZeroGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoOneGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoZeroTurn.setDuration(1e3*this.configRoom.maximalMoveDuration),this.chronoOneTurn.setDuration(1e3*this.configRoom.maximalMoveDuration)}didUserPlay(e){return this.hasUserPlayed[e.value]}doNewMoves(t){Iw(e.VERBOSE,"OnlineGameWrapperComponent.doNewMoves"),this.switchPlayer();const n=NZ.copyImmutableArray(t.data.listMoves),r=this.gameComponent.rules;for(;r.node.gameState.turn<n.length;){const e=r.node.gameState.turn,t=this.gameComponent.encoder.decode(n[e]),i=r.isLegal(t,r.node.gameState),s="We received an incorrect db move: "+t.toString()+" in "+n+" at turn "+e+'because "'+i.getReasonOr("")+'"';hZ(i.isSuccess(),s),r.choose(t)}this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get(),this.gameComponent.updateBoard()}switchPlayer(){Iw(e.VERBOSE,"OnlineGameWrapperComponent.switchPlayer");const t=TZ.fromTurn(this.currentPart.data.turn);this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get();const n=t.getOpponent();this.didUserPlay(n)&&this.pauseCountDownsFor(n),this.didUserPlay(t)?(Iw(e.VERBOSE,"OnlineGameWrapperComponent.onCurrentPartUpdate: changing current player"),this.resumeCountDownFor(t)):this.startCountDownFor(t)}resetChronoFor(e){this.pauseCountDownsFor(e),this.resumeCountDownFor(e)}applyEndGame(){const t=this.currentPart,n=TZ.fromTurn(t.data.turn);this.endGame=!0,[vZ.VICTORY,vZ.HARD_DRAW].some(e=>e.value===t.data.result)?this.doNewMoves(this.currentPart):(hZ(!0===[vZ.RESIGN,vZ.TIMEOUT,vZ.HARD_DRAW,vZ.AGREED_DRAW_BY_ZERO,vZ.AGREED_DRAW_BY_ONE].some(e=>e.value===t.data.result),"Unknown type of end game ("+t.data.result+")"),Iw(e.VERBOSE,"endGame est true et winner est "+t.getWinner())),this.stopCountdownsFor(n)}notifyDraw(e,t){return this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.observerRole,e,[0,0],t,!0)}notifyTimeoutVictory(e,t,n,r){var i=this;return Ow(function*(){i.endGame=!0;const s=i.currentPart.setWinnerAndLoser(e,r);i.currentPart=s,yield i.gameService.notifyTimeout(i.currentPartId,t,n,e,r)})()}notifyVictory(t,n){Iw(e.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");const r=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);return r===gj.ONE_WON?this.currentPart=this.currentPart.setWinnerAndLoser(this.players[1].get(),this.players[0].get()):(hZ(r===gj.ZERO_WON,"impossible to get a victory without winner!"),this.currentPart=this.currentPart.setWinnerAndLoser(this.players[0].get(),this.players[1].get())),this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.observerRole,t,[0,0],n,!1,this.currentPart.getWinner().get(),this.currentPart.getLoser().get())}canAskTakeBack(){return hZ(this.isPlaying(),"Non playing should not call canAskTakeBack"),!(null==this.currentPart||this.currentPart.data.turn<=this.observerRole.value||this.currentPart.data.request&&"TakeBackRefused"===this.currentPart.data.request.code&&this.observerRole.isPlayer()&&this.currentPart.data.request.data.player===this.observerRole.getOpponent().value)&&this.getTakeBackRequester()===IZ.NONE}isOpponentWaitingForTakeBackResponse(){const e=this.getTakeBackRequester();return!!e.isPlayer()&&this.isOpponent(e)}getTakeBackRequester(){if(null==this.currentPart)return IZ.NONE;const e=this.currentPart.data.request;return e&&"TakeBackAsked"===e.code?kZ.getPlayer(e):IZ.NONE}canProposeDraw(){return hZ(this.isPlaying(),"Non playing should not call canProposeDraw"),!(this.endGame||null==this.currentPart||this.currentPart.data.request&&"DrawRefused"===this.currentPart.data.request.code&&this.observerRole.isPlayer()&&kZ.getPlayer(this.currentPart.data.request)===this.observerRole.getOpponent()||this.isOpponentWaitingForDrawResponse())&&this.getDrawRequester()===IZ.NONE}isOpponentWaitingForDrawResponse(){const e=this.getDrawRequester();return e!==IZ.NONE&&this.isOpponent(e)}getDrawRequester(){if(null==this.currentPart)return IZ.NONE;const e=this.currentPart.data.request;return e&&"DrawProposed"===e.code?kZ.getPlayer(e):IZ.NONE}onRequest(t,n){var r=this;return Ow(function*(){switch(Iw(e.VERBOSE,{called:"OnlineGameWrapper.onRequest(",request:t,oldPart:n}),t.code){case"TakeBackAsked":case"TakeBackRefused":case"DrawProposed":case"DrawRefused":break;case"TakeBackAccepted":r.takeBackTo(r.currentPart.data.turn);break;case"RematchProposed":r.rematchProposed=!0;const n=kZ.getPlayer(t).getOpponent();r.isPlayer(n)&&(Iw(e.VERBOSE,"ton adversaire te propose une revanche"),r.opponentProposedRematch=!0);break;case"RematchAccepted":yield r.router.navigate(["/nextGameLoading"]),yield r.router.navigate(["/play",kZ.getTypeGame(t),kZ.getPartId(t)]);break;case"AddTurnTime":const i=3e4,s=TZ.of(t.data.player);r.addTurnTimeTo(s,i);break;case"AddGlobalTime":const o=3e5,a=TZ.of(t.data.player);r.addGlobalTimeTo(a,o);break;default:Tw.expectToBe(t.code,"DrawAccepted","Unknown RequestType : "+t.code+" for "+JSON.stringify(t)),yield r.acceptDraw()}})()}takeBackTo(t){if(Iw(e.VERBOSE,"OnlineGameWrapperComponent.takeBackTo"),this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.gameComponent.rules.node.gameState.turn===t)this.switchPlayer();else{this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get();const e=TZ.fromTurn(t);this.resetChronoFor(e)}this.gameComponent.updateBoard()}setPlayersDatas(t){Iw(e.VERBOSE,{OnlineGameWrapper_setPlayersDatas:t}),this.players=[Nw.of(t.data.playerZero),Nw.ofNullable(t.data.playerOne)],hZ(null!=t.data.playerOne,"should not setPlayersDatas when players data is not received"),this.currentPlayer=this.players[t.data.turn%2].get();let n=Nw.empty();if(this.players[0].get().id===this.authUser.id?(this.observerRole=TZ.ZERO,n=this.players[1]):this.players[1].get().id===this.authUser.id?(this.observerRole=TZ.ONE,n=this.players[0]):this.observerRole=IZ.NONE,n.isPresent()){const e=e=>{hZ(e.isPresent(),"opponent was deleted, what sorcery is this"),this.opponent={id:n.get().id,name:Tw.getNonNullable(e.get().username)}};this.opponentSubscription=this.userService.observeUser(n.get().id,e)}}onLegalUserMove(t,n){var r=this;return Ow(function*(){if(Iw(e.VERBOSE,"dans OnlineGameWrapperComponent.onLegalUserMove"),!r.isOpponentWaitingForTakeBackResponse())return r.updateDBBoard(t,r.msToSubstract,n);r.gameComponent.message("You must answer to take back request")})()}updateDBBoard(t,n,r){var i=this;return Ow(function*(){const s=i.gameComponent.encoder.encodeMove(t);Iw(e.VERBOSE,"OnlineGameWrapperComponent.updateDBBoard("+t.toString()+", "+r+")"),i.gameComponent.rules.choose(t);const o=i.gameComponent.rules.getGameStatus(i.gameComponent.rules.node);return o.isEndGame?o===gj.DRAW?i.notifyDraw(s,r):i.notifyVictory(s,r):i.gameService.updateDBBoard(i.currentPartId,i.observerRole,s,n,r)})()}resign(){var t=this;return Ow(function*(){Iw(e.VERBOSE,"OnlineGameWrapperComponent.resign");const n=t.getLastIndex(),r=t.observerRole,i=t.getPlayer(),s=t.players[(t.observerRole.value+1)%2].get();yield t.gameService.resign(t.currentPartId,n,r,s,i)})()}getLastIndex(){return this.currentPart.data.lastUpdate.index}reachedOutOfTime(t){var n=this;return Ow(function*(){Iw(e.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+t+")");const r=n.getLastIndex(),i=n.observerRole;if(n.stopCountdownsFor(t),t===n.observerRole){const e=Tw.getNonNullable(n.opponent);yield n.notifyTimeoutVictory(e,i,r,n.authUser.toMinimalUser())}else if(hZ(!1===n.endGame,"time might be better handled in the future"),n.opponentIsOffline()){const e=Tw.getNonNullable(n.opponent);yield n.notifyTimeoutVictory(n.authUser.toMinimalUser(),i,t.value,e),n.endGame=!0}})()}acceptRematch(){var e=this;return Ow(function*(){hZ(e.isPlaying(),"Non playing should not call acceptRematch");const t=new CZ(e.currentPartId,e.currentPart.data);return yield e.gameService.acceptRematch(t,e.getLastIndex(),e.observerRole),!0})()}proposeRematch(){var e=this;return Ow(function*(){return hZ(e.isPlaying(),"Non playing should not call proposeRematch"),yield e.gameService.proposeRematch(e.currentPartId,e.getLastIndex(),e.observerRole),!0})()}proposeDraw(){return hZ(this.isPlaying(),"Non playing should not call proposeDraw"),this.gameService.proposeDraw(this.currentPartId,this.getLastIndex(),this.observerRole)}acceptDraw(){return hZ(this.isPlaying(),"Non playing should not call acceptDraw"),this.gameService.acceptDraw(this.currentPartId,this.getLastIndex(),this.observerRole)}refuseDraw(){return hZ(this.isPlaying(),"Non playing should not call refuseDraw"),this.gameService.refuseDraw(this.currentPartId,this.getLastIndex(),this.observerRole)}askTakeBack(){return hZ(this.isPlaying(),"Non playing should not call askTakeBack"),this.gameService.askTakeBack(this.currentPartId,this.getLastIndex(),this.observerRole)}acceptTakeBack(){var e=this;return Ow(function*(){hZ(e.isPlaying(),"Non playing should not call acceptTakeBack");const t=e.observerRole;yield e.gameService.acceptTakeBack(e.currentPartId,e.currentPart,t,e.msToSubstract),e.msToSubstract=[0,0]})()}refuseTakeBack(){return hZ(this.isPlaying(),"Non playing should not call refuseTakeBack"),this.gameService.refuseTakeBack(this.currentPartId,this.getLastIndex(),this.observerRole)}startCountDownFor(t){Iw(e.VERBOSE,"dans OnlineGameWrapperComponent.startCountDownFor("+t.toString()+") (turn "+this.currentPart.data.turn+")"),this.hasUserPlayed[t.value]=!0,t===TZ.ZERO?(this.chronoZeroGlobal.start(),this.chronoZeroTurn.start()):(this.chronoOneGlobal.start(),this.chronoOneTurn.start())}resumeCountDownFor(t,n=!0){let r;Iw(e.VERBOSE,"dans OnlineGameWrapperComponent.resumeCountDownFor("+t.toString()+") (turn "+this.currentPart.data.turn+")"),t===TZ.ZERO?(this.chronoZeroGlobal.changeDuration(Tw.getNonNullable(this.currentPart.data.remainingMsForZero)),this.chronoZeroGlobal.resume(),r=this.chronoZeroTurn):(this.chronoOneGlobal.changeDuration(Tw.getNonNullable(this.currentPart.data.remainingMsForOne)),this.chronoOneGlobal.resume(),r=this.chronoOneTurn),n?(r.setDuration(1e3*this.configRoom.maximalMoveDuration),r.start()):r.resume()}pauseCountDownsFor(t,n=!0){let r;Iw(e.VERBOSE,"dans OnlineGameWrapperComponent.pauseCountDownFor("+t.value+") (turn "+this.currentPart.data.turn+")"),t===TZ.ZERO?(this.chronoZeroGlobal.pause(),r=this.chronoZeroTurn):(this.chronoOneGlobal.pause(),r=this.chronoOneTurn),n?r.stop():r.pause()}stopCountdownsFor(t){Iw(e.VERBOSE,"cdc::stopCountDownsFor("+t.toString()+") (turn "+this.currentPart.data.turn+")"),t===TZ.ZERO?(this.chronoZeroGlobal.isStarted()&&this.chronoZeroGlobal.stop(),this.chronoZeroTurn.isStarted()&&this.chronoZeroTurn.stop()):(this.chronoOneGlobal.isStarted()&&this.chronoOneGlobal.stop(),this.chronoOneTurn.isStarted()&&this.chronoOneTurn.stop())}getPlayerNameClass(e){return this.opponentIsOffline()?"has-text-grey-light":e===TZ.ZERO?"has-text-white":"has-text-black"}opponentIsOffline(){return!1}canResign(){return hZ(this.isPlaying(),"Non playing should not call canResign"),!(!0===this.endGame||null==this.opponent)}addGlobalTime(){const e=this.observerRole,t=this.getLastIndex();return this.gameService.addGlobalTime(this.currentPartId,t,this.currentPart.data,e)}addTurnTime(){return this.gameService.addTurnTime(this.observerRole,this.getLastIndex(),this.currentPartId)}addTurnTimeTo(e,t){const n=TZ.fromTurn(this.currentPart.getTurn());this.pauseCountDownsFor(n,!1),e===TZ.ZERO?this.chronoZeroTurn.changeDuration(this.chronoZeroTurn.remainingMs+t):this.chronoOneTurn.changeDuration(this.chronoOneTurn.remainingMs+t),this.resumeCountDownFor(n,!1)}addGlobalTimeTo(e,t){e===TZ.ZERO?this.chronoZeroGlobal.changeDuration(this.chronoZeroGlobal.remainingMs+t):this.chronoOneGlobal.changeDuration(this.chronoOneGlobal.remainingMs+t)}ngOnDestroy(){Iw(e.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy"),this.routerEventsSub.unsubscribe(),this.userSub.unsubscribe(),!0===this.gameStarted&&(this.opponentSubscription.unsubscribe(),this.partSubscription.unsubscribe()),Iw(e.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy finished")}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(Cc),ua(Wy),ua(gC),ua(cZ),ua(yZ),ua(fZ),ua(FZ))},e.\u0275cmp=Je({type:e,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){if(1&e&&(Wu(r7,5),Wu(i7,5),Wu(s7,5),Wu(o7,5),Wu(a7,5),Wu(l7,5)),2&e){let e;qu(e=ju())&&(t.partCreation=e.first),qu(e=ju())&&(t.chatComponent=e.first),qu(e=ju())&&(t.chronoZeroGlobal=e.first),qu(e=ju())&&(t.chronoOneGlobal=e.first),qu(e=ju())&&(t.chronoZeroTurn=e.first),qu(e=ju())&&(t.chronoOneTurn=e.first)}},features:[Go],decls:5,vars:4,consts:function(){let e,t,n,r,i,s,o,a,l,c,u,h,d,f,p,g,m,y,v,C,_,E,w,P,S,b,O,T,I;return e=$localize`vs.`,t=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,n=$localize`It is your turn.`,r=$localize`It is ${"\ufffd0\ufffd"}:INTERPOLATION:'s turn.`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,s=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`Resign`,a=$localize`Propose a draw`,l=$localize`Accept draw`,c=$localize`Reject draw`,u=$localize`Pass a turn`,h=$localize`Accept take back`,d=$localize`Reject take back`,f=$localize`Ask to take back one move`,p=$localize`Draw`,g=$localize`You agreed to draw.`,m=$localize`Your draw proposal has been accepted.`,y=$localize`Players agreed to draw.`,v=$localize`You won.`,C=$localize`You lost.`,_=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won.`,E=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit. You won.`,w=$localize`You reached your time limit.`,P=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit.`,S=$localize`You resigned.`,b=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has resigned.`,O=$localize`Go back to the game list`,T=$localize`Propose to play again`,I=$localize`Accept to play again`,[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],e,["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],[4,"ngIf"],["class","block","id","winnerIndicator",4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","proposeRematchButton","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["class","button is-fullwidth is-warning","id","acceptRematchButton",3,"click",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","turnIndicator",1,"block"],[1,"subtitle"],t,["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],n,r,["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],i,["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],s,["class","button is-fullwidth mb-1","id","resignButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","proposeDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","refuseDrawButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","passButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptTakeBackButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","color","warn","id","refuseTakeBackButton",3,"click",4,"ngIf"],["class","button is-fullwidth","id","askTakeBackButton",3,"click",4,"ngIf"],["id","resignButton",1,"button","is-fullwidth","mb-1",3,"click"],o,["id","proposeDrawButton",1,"button","is-fullwidth","mb-1",3,"click"],a,["id","acceptDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],l,["id","refuseDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],c,["id","passButton",1,"button","is-fullwidth","mb-1",3,"click"],u,["id","acceptTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],h,["color","warn","id","refuseTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],d,["id","askTakeBackButton",1,"button","is-fullwidth",3,"click"],f,["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],p,["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],g,["id","yourOpponentAgreedToDrawIndicator",1,"title"],m,["id","playersAgreedToDraw",1,"title"],y,["class","title","id","youWonIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],v,[1,"title"],C,_,E,w,P,["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],S,b,["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],O,["id","proposeRematchButton",1,"button","is-fullwidth","mb-1",3,"click"],T,["id","acceptRematchButton",1,"button","is-fullwidth","is-warning",3,"click"],I]},template:function(e,t){1&e&&(la(0,c7,2,1,"app-part-creation",0),la(1,W7,29,27,"div",1),fa(2,"div",2),fa(3,"div",3),ga(4,"app-chat",4),pa(),pa()),2&e&&(ha("ngIf",!1===t.gameStarted),Ts(1),ha("ngIf",t.gameStarted),Ts(3),ha("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},directives:[rf,g8,e7,n7,Jd,T8,yC],encapsulation:2}),e})();function Q7(e,t){if(1&e&&(fa(0,"option",25),Qa(1),pa()),2&e){const e=t.$implicit;ha("value",e.name),Ts(1),Xa(e.name)}}function X7(e,t){if(1&e&&(fa(0,"option",25),sc(1,29),pa()),2&e){const e=t.$implicit;ha("value",e),Ts(1),oc(e),ac(1)}}const J7=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function e9(e,t){if(1&e){const e=va();fa(0,"select",26),Ea("ngModelChange",function(t){return Gt(e),Sa(2).aiDepths[0]=t})("change",function(){Gt(e);const t=Sa(2);return t.updatePlayer(t.Player.ZERO)}),fa(1,"option",27),sc(2,28),pa(),la(3,X7,2,2,"option",16),pa()}2&e&&(ha("ngModel",Sa(2).aiDepths[0]),Ts(3),ha("ngForOf",wu(2,J7)))}function t9(e,t){if(1&e&&(fa(0,"p",30),sc(1,31),pa()),2&e){const e=Sa(2);Ts(1),oc(e.gameComponent.scores.get()[0]),ac(1)}}function n9(e,t){if(1&e&&(fa(0,"option",25),Qa(1),pa()),2&e){const e=t.$implicit;ha("value",e.name),Ts(1),Xa(e.name)}}function r9(e,t){if(1&e&&(fa(0,"option",25),sc(1,34),pa()),2&e){const e=t.$implicit;ha("value",e),Ts(1),oc(e),ac(1)}}function i9(e,t){if(1&e){const e=va();fa(0,"select",32),Ea("ngModelChange",function(t){return Gt(e),Sa(2).aiDepths[1]=t})("change",function(){Gt(e);const t=Sa(2);return t.updatePlayer(t.Player.ONE)}),fa(1,"option",27),sc(2,33),pa(),la(3,r9,2,2,"option",16),pa()}2&e&&(ha("ngModel",Sa(2).aiDepths[1]),Ts(3),ha("ngForOf",wu(2,J7)))}function s9(e,t){if(1&e&&(fa(0,"p",35),sc(1,36),pa()),2&e){const e=Sa(2);Ts(1),oc(e.gameComponent.scores.get()[1]),ac(1)}}function o9(e,t){if(1&e&&(fa(0,"h4"),sc(1,40),pa()),2&e){const e=Sa(3);Ts(1),oc(e.winner.get()),ac(1)}}function a9(e,t){1&e&&(fa(0,"h4",41),sc(1,42),pa())}function l9(e,t){if(1&e&&(fa(0,"div",37),la(1,o9,2,1,"h4",38),la(2,a9,2,0,"h4",39),pa()),2&e){const e=Sa(2);Ts(1),ha("ngIf",e.winner.isPresent()),Ts(1),ha("ngIf",e.winner.isAbsent())}}function c9(e,t){if(1&e){const e=va();fa(0,"div",6),fa(1,"div",7),fa(2,"p",8),sc(3,9),pa(),pa(),fa(4,"div",10),fa(5,"div",11),fa(6,"div",12),fa(7,"select",13),Ea("change",function(){Gt(e);const t=Sa();return t.updatePlayer(t.Player.ZERO)})("ngModelChange",function(t){return Gt(e),Sa().playerSelection[0]=t}),fa(8,"option",14),sc(9,15),pa(),la(10,Q7,2,2,"option",16),pa(),pa(),fa(11,"div",12),la(12,e9,4,3,"select",17),pa(),la(13,t9,2,1,"p",18),pa(),fa(14,"div",19),fa(15,"div",12),fa(16,"select",20),Ea("change",function(){Gt(e);const t=Sa();return t.updatePlayer(t.Player.ONE)})("ngModelChange",function(t){return Gt(e),Sa().playerSelection[1]=t}),fa(17,"option",14),sc(18,21),pa(),la(19,n9,2,2,"option",16),pa(),pa(),fa(20,"div",12),la(21,i9,4,3,"select",22),pa(),la(22,s9,2,1,"p",23),pa(),pa(),la(23,l9,3,2,"div",24),pa()}if(2&e){const e=Sa();Ts(3),oc(e.gameComponent.rules.node.gameState.turn+1),ac(3),Ts(4),ha("ngModel",e.playerSelection[0]),Ts(3),ha("ngForOf",e.gameComponent.availableMinimaxes),Ts(2),ha("ngIf",!1===e.players[0].equalsValue("human")),Ts(1),ha("ngIf",e.gameComponent.scores.isPresent()),Ts(3),ha("ngModel",e.playerSelection[1]),Ts(3),ha("ngForOf",e.gameComponent.availableMinimaxes),Ts(2),ha("ngIf",!1===e.players[1].equalsValue("human")),Ts(1),ha("ngIf",e.gameComponent.scores.isPresent()),Ts(1),ha("ngIf",e.endGame)}}function u9(e,t){if(1&e&&(ma(0),Qa(1),ga(2,"br"),ya()),2&e){const e=t.$implicit,n=Sa(3);Ts(1),Ja(" ",e.name+": "+e.getBoardValue(n.gameComponent.rules.node)," ")}}function h9(e,t){if(1&e&&(ma(0),la(1,u9,3,1,"ng-container",48),Qa(2),ga(3,"br"),Qa(4),ga(5,"br"),ya()),2&e){const e=Sa(2);Ts(1),ha("ngForOf",e.gameComponent.availableMinimaxes),Ts(1),Ja(" Created ",e.getCreatedNodes()," nodes."),Ts(2),Ja(" Minimax time: ",e.getMinimaxTime(),"ms.")}}function d9(e,t){if(1&e){const e=va();fa(0,"button",49),Ea("click",function(){return Gt(e),Sa(2).gameComponent.pass()}),sc(1,50),pa()}}function f9(e,t){if(1&e){const e=va();fa(0,"button",51),Ea("click",function(){return Gt(e),Sa(2).takeBack()}),sc(1,52),pa()}}function p9(e,t){if(1&e){const e=va();fa(0,"div",43),la(1,h9,6,3,"ng-container",38),la(2,d9,2,0,"button",44),la(3,f9,2,0,"button",45),fa(4,"button",46),Ea("click",function(){return Gt(e),Sa().restartGame()}),sc(5,47),pa(),pa()}if(2&e){const e=Sa();Ts(1),ha("ngIf",e.gameComponent.rules.node.move),Ts(1),ha("ngIf",!1===e.endGame&&e.gameComponent.canPass),Ts(1),ha("ngIf",e.canTakeBack())}}let g9=(()=>{class e extends k8{constructor(t,n,r,i,s,o){super(t,n,r,i,s),this.cdr=o,this.aiDepths=["0","0"],this.playerSelection=["human","human"],this.winner=Nw.empty(),this.botTimeOut=1e3,this.players=[Nw.of(this.playerSelection[0]),Nw.of(this.playerSelection[1])],this.observerRole=TZ.ZERO,Iw(e.VERBOSE,"LocalGameWrapper.constructor")}getCreatedNodes(){return fj.createdNodes}getMinimaxTime(){return fj.minimaxTime}ngAfterViewInit(){var e=this;setTimeout(Ow(function*(){(yield e.afterGameIncluderViewInit())&&(e.restartGame(),e.cdr.detectChanges())}),1)}updatePlayer(e){this.players[e.value]=Nw.of(this.playerSelection[e.value]),this.proposeAIToPlay()}onLegalUserMove(t){var n=this;return Ow(function*(){Iw(e.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),n.gameComponent.rules.choose(t),n.updateBoard(),n.proposeAIToPlay()})()}updateBoard(){this.gameComponent.updateBoard();const e=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer()&&(this.winner=Nw.of($localize`Player ${e.winner.value+1}`)))}proposeAIToPlay(){var e=this;const t=this.getPlayingAI();t.isPresent()&&window.setTimeout(Ow(function*(){yield e.doAIMove(t.get())}),this.botTimeOut)}getPlayingAI(){if(this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node).isEndGame)return Nw.empty();const e=this.gameComponent.rules.node.gameState.turn%2;return"0"===this.aiDepths[e]?Nw.empty():Nw.ofNullable(this.gameComponent.availableMinimaxes.find(t=>this.players[e].isPresent()&&this.players[e].get()===t.name))}doAIMove(e){var t=this;return Ow(function*(){const n=t.gameComponent.rules;hZ(n.getGameStatus(n.node)===gj.ONGOING,"AI should not try to play when game is over!");const r=Number.parseInt(t.aiDepths[n.node.gameState.turn%2%2]),i=n.node.findBestMove(r,e,!0);return n.choose(i)?(t.updateBoard(),t.cdr.detectChanges(),t.proposeAIToPlay(),Lw.SUCCESS):(t.messageDisplayer.criticalMessage($localize`The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!`),uZ.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:i.toString()}))})()}canTakeBack(){return this.gameComponent.rules.node.gameState.turn>0}takeBack(){this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.isAITurn()&&(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get()),this.gameComponent.updateBoard()}isAITurn(){return this.getPlayingAI().isPresent()}restartGame(){const e=this.gameComponent.rules.stateType.getInitialState();this.gameComponent.rules.node=new pj(e),this.gameComponent.updateBoard(),this.endGame=!1,this.winner=Nw.empty(),this.proposeAIToPlay()}getPlayer(){return"human"}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(Cc),ua(Wy),ua(yZ),ua(gC),ua(cZ),ua(Yc))},e.\u0275cmp=Je({type:e,selectors:[["app-local-game-wrapper"]],features:[Go],decls:7,vars:3,consts:function(){let e,t,n,r,i,s,o,a,l,c,u,h,d,f;return e=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,t=$localize`Human`,n=$localize`Human`,r=$localize`Pick the level`,i=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,s=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`Pick the level`,a=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,l=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,c=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won`,u=$localize`Draw`,h=$localize`Start a new game`,d=$localize`Pass a turn`,f=$localize`Take back move`,[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],e,["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],t,[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],n,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["class","block","id","gameResult",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],r,i,["id","scoreOne",1,"block"],s,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],o,a,["id","scoreZero",1,"block"],l,["id","gameResult",1,"block"],[4,"ngIf"],["id","draw",4,"ngIf"],c,["id","draw"],u,[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],h,[4,"ngFor","ngForOf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],d,["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],f]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"div",1),la(2,c9,24,10,"div",2),la(3,p9,6,3,"div",3),pa(),fa(4,"div",4),fa(5,"div",5),ga(6,"app-game-includer"),pa(),pa(),pa()),2&e&&(Ts(2),ha("ngIf",t.gameComponent),Ts(1),ha("ngIf",t.gameComponent),Ts(1),ha("ngClass",t.getBoardHighlight()))},directives:[rf,Jd,T8,bg,Dp,fg,Og,Ag,tf],encapsulation:2,changeDetection:0}),e})(),m9=(()=>{class e{}return e.STEP_FINISHED=()=>$localize`Step finished!`,e.INFORMATIONAL_STEP=()=>$localize`This step is not expecting any move from your part.`,e})();function y9(e,t){if(1&e&&(fa(0,"div",20),fa(1,"div",21),sc(2,22),pa(),fa(3,"div",23),Qa(4),pa(),pa()),2&e){const e=Sa();Ts(4),Xa(e.currentReason.get())}}function v9(e,t){if(1&e){const e=va();fa(0,"button",24),Ea("click",function(){return Gt(e),Sa().retry()}),sc(1,25),pa()}}function C9(e,t){1&e&&(ma(0),sc(1,30),ya())}function _9(e,t){1&e&&(ma(0),sc(1,31),ya())}function E9(e,t){if(1&e&&la(0,_9,2,0,"ng-container",27),2&e){Sa();const e=ca(5),t=Sa();ha("ngIf",t.stepFinished&&t.stepFinished[t.stepIndex])("ngIfElse",e)}}function w9(e,t){1&e&&(ma(0),sc(1,32),ya())}function P9(e,t){if(1&e){const e=va();fa(0,"button",26),Ea("click",function(){return Gt(e),Sa().next()}),la(1,C9,2,0,"ng-container",27),la(2,E9,1,2,"ng-template",null,28,Ku),la(4,w9,2,0,"ng-template",null,29,Ku),pa()}if(2&e){const e=ca(3),t=Sa();Ts(1),ha("ngIf",t.steps[t.stepIndex]&&t.steps[t.stepIndex].isInformation())("ngIfElse",e)}}function S9(e,t){if(1&e){const e=va();fa(0,"button",33),Ea("click",function(){return Gt(e),Sa().start()}),sc(1,34),pa()}}function b9(e,t){if(1&e){const e=va();fa(0,"button",35),Ea("click",function(){return Gt(e),Sa().playLocally()}),sc(1,36),pa()}}function O9(e,t){if(1&e){const e=va();fa(0,"button",37),Ea("click",function(){return Gt(e),Sa().createGame()}),sc(1,38),pa()}}function T9(e,t){if(1&e){const e=va();fa(0,"button",39),Ea("click",function(){return Gt(e),Sa().showSolution()}),sc(1,40),pa()}}function I9(e,t){if(1&e&&(ma(0),fa(1,"option",42),Qa(2),pa(),ya()),2&e){const e=Sa(),t=e.index,n=e.$implicit;Ts(1),Ta("id","step_",t,""),ha("value",t),Ts(1),Xa(n.title)}}function k9(e,t){1&e&&(ma(0),Qa(1,"v "),ya())}function A9(e,t){1&e&&Qa(0,"x ")}function M9(e,t){if(1&e&&(fa(0,"option",43),la(1,k9,2,0,"ng-container",27),la(2,A9,1,0,"ng-template",null,44,Ku),fa(4,"span",45),Qa(5),pa(),pa()),2&e){const e=ca(3),t=Sa(),n=t.index,r=t.$implicit,i=Sa();ha("value",n),Ts(1),ha("ngIf",i.stepFinished[n])("ngIfElse",e),Ts(3),Ta("id","step_",n,""),Ts(1),Xa(r.title)}}function N9(e,t){if(1&e&&(ma(0),la(1,I9,3,3,"ng-container",27),la(2,M9,6,5,"ng-template",null,41,Ku),ya()),2&e){const e=t.index,n=ca(3),r=Sa();Ts(1),ha("ngIf",e===r.stepIndex)("ngIfElse",n)}}let R9=(()=>{class e extends k8{constructor(t,n,r,i,s,o){super(t,n,o,r,i),this.cdr=s,this.connectedUserService=o,this.COMPLETED_TUTORIAL_MESSAGE=$localize`Congratulations, you completed the tutorial.`,this.steps=[],this.successfulSteps=0,this.stepIndex=-1,this.currentMessage="",this.currentReason=Nw.empty(),this.moveAttemptMade=!1,this.stepFinished=[],this.tutorialOver=!1,Iw(e.VERBOSE,"TutorialGameWrapperComponent.constructor"),this.observerRole=TZ.ZERO}getNumberOfSteps(){return this.steps.length}getCurrentStepTitle(){return this.steps.length>0?this.steps[this.stepIndex].title:""}ngAfterViewInit(){var t=this;return Ow(function*(){Iw(e.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),(yield t.afterGameIncluderViewInit())&&t.start()})()}start(){this.startTutorial(this.gameComponent.tutorial)}startTutorial(t){Iw(e.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:t}}),this.steps=t,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}getCompletionArray(){return this.steps.map(()=>!1)}changeStep(e){this.showStep(Number.parseInt(e.target.value,10))}showStep(t){Iw(e.VERBOSE,"tutorialGameWrapperComponent.showStep("+t+")"),this.moveAttemptMade=!1,this.stepFinished[t]=!1,this.updateSuccessCount(),this.stepIndex=t;const n=this.steps[this.stepIndex];this.currentMessage=n.instruction,this.currentReason=Nw.empty(),this.gameComponent.rules.node=new pj(n.state,Nw.empty(),n.previousMove),this.gameComponent.updateBoard(),this.cdr.detectChanges()}onLegalUserMove(t){var n=this;return Ow(function*(){Iw(e.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:t}});const r=n.steps[n.stepIndex];if(hZ(n.gameComponent.rules.choose(t),"It should be impossible to call onLegalUserMove with an illegal move"),Iw(e.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),n.gameComponent.updateBoard(),n.moveAttemptMade=!0,r.isPredicate()){const e=n.gameComponent.rules.node.mother.get().gameState,i=n.gameComponent.rules.node.gameState,s=Tw.getNonNullable(r.predicate)(t,e,i);s.isSuccess()?n.showStepSuccess(r.getSuccessMessage()):n.currentReason=Nw.of(s.getReason())}else if(r.isAnyMove())Iw(e.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),n.showStepSuccess(r.getSuccessMessage());else{hZ(r.isMove(),"cannot reach here with a click step");const i=r;i.acceptedMoves.some(e=>e.equals(t))?(Iw(e.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),n.showStepSuccess(i.getSuccessMessage())):(Iw(e.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),n.currentReason=Nw.of(i.getFailureMessage()))}n.cdr.detectChanges()})()}retry(){Iw(e.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}onUserClick(t){if(Iw(e.VERBOSE,"tutorialGameWrapper.onUserClick("+t+")"),this.currentReason=Nw.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return Lw.failure(m9.STEP_FINISHED());const n=this.steps[this.stepIndex];return n.isClick()?(this.gameComponent.updateBoard(),this.moveAttemptMade=!0,Tw.getNonNullable(n.acceptedClicks).some(e=>e===t)?this.showStepSuccess(n.getSuccessMessage()):this.currentMessage=n.getFailureMessage(),Lw.SUCCESS):n.isMove()||n.isPredicate()||n.isAnyMove()?(window.setTimeout(()=>{this.cdr.detectChanges()},10),Lw.SUCCESS):Lw.failure(m9.INFORMATIONAL_STEP())}onCancelMove(t){Iw(e.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+t+")"),void 0!==t&&(this.currentReason=Nw.of(t)),this.cdr.detectChanges()}showStepSuccess(t){Iw(e.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=t,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}updateSuccessCount(){let e=0;for(const t of this.stepFinished)t&&e++;this.successfulSteps=e}next(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{let e=(this.stepIndex+1)%this.steps.length;for(;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}showSolution(){var t=this;return Ow(function*(){Iw(e.VERBOSE,"tutorialGameWrapper.showSolution()");const n=t.steps[t.stepIndex];hZ(n.hasSolution(),"step must have solution");const r=n,i=r.getSolution();i instanceof aj?(t.showStep(t.stepIndex),t.gameComponent.rules.choose(i),t.gameComponent.updateBoard()):(t.showStep(t.stepIndex),window.document.querySelector(i).dispatchEvent(new Event("click"))),t.currentMessage=r.getSuccessMessage(),t.moveAttemptMade=!0,t.cdr.detectChanges()})()}playLocally(){var e=this;return Ow(function*(){const t=Tw.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/local",t])})()}createGame(){var e=this;return Ow(function*(){const t=Tw.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/play",t])})()}getPlayer(){return"tutorial-player"}}return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(ua(Cc),ua(Wy),ua(gC),ua(cZ),ua(Yc),ua(yZ))},e.\u0275cmp=Je({type:e,selectors:[["app-tutorial-game-wrapper"]],features:[Go],decls:22,vars:15,consts:function(){let e,t,n,r,i,s,o,a,l;return e=$localize`Failure`,t=$localize`Try again`,n=$localize`Ok`,r=$localize`Continue`,i=$localize`Skip`,s=$localize`Try again`,o=$localize`Play locally`,a=$localize`Create an online game`,l=$localize`See solution`,[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["role","alert",1,"message","is-danger"],[1,"message-header"],e,["id","currentReason",1,"message-body"],["id","retryButton",1,"button","mr-3",3,"click"],t,["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],n,r,i,["id","restartButton",1,"button",3,"click"],s,["id","playLocallyButton",1,"button",3,"click"],o,["id","playOnlineButton",1,"button",3,"click"],a,["id","showSolutionButton",1,"button",3,"click"],l,["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"div",1),fa(2,"div",2),ga(3,"progress",3),fa(4,"div",4),fa(5,"p",5),Qa(6),pa(),ga(7,"p",6),pa(),la(8,y9,5,1,"div",7),fa(9,"div",8),la(10,v9,2,0,"button",9),la(11,P9,6,2,"button",10),la(12,S9,2,0,"button",11),la(13,b9,2,0,"button",12),la(14,O9,2,0,"button",13),la(15,T9,2,0,"button",14),fa(16,"div",15),fa(17,"select",16),Ea("change",function(e){return t.changeStep(e)}),la(18,N9,4,2,"ng-container",17),pa(),pa(),pa(),pa(),pa(),fa(19,"div",18),fa(20,"div",19),ga(21,"app-game-includer"),pa(),pa(),pa()),2&e&&(Ts(3),ra("value",t.successfulSteps)("max",t.getNumberOfSteps()),Ts(3),tl("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),Ts(1),ha("innerHTML",t.currentMessage,vi),Ts(1),ha("ngIf",t.currentReason.isPresent()),Ts(2),ha("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),Ts(1),ha("ngIf",!1===t.tutorialOver),Ts(1),ha("ngIf",t.tutorialOver),Ts(1),ha("ngIf",t.tutorialOver),Ts(1),ha("ngIf",t.tutorialOver),Ts(1),ha("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),Ts(3),ha("ngForOf",t.steps),Ts(1),ha("ngClass",t.getBoardHighlight()))},directives:[rf,tf,Jd,T8,Og,Ag],encapsulation:2,changeDetection:0}),e})();function x9(e,t){if(1&e&&(fa(0,"div",35),fa(1,"div",36),sc(2,37),pa(),fa(3,"div",38),Qa(4),pa(),pa()),2&e){const e=Sa();Ts(4),Xa(e.errorMessage)}}const D9=function(){return["/login"]};let L9=(()=>{class e{constructor(e,t){this.authService=e,this.router=t,this.faEye=WZ,this.registrationForm=new og({email:new sg,username:new sg,password:new sg})}registerWithEmail(){var e=this;return Ow(function*(){const t=e.registrationForm.value.username,n=e.registrationForm.value.email,r=e.registrationForm.value.password;if(null==t||null==n||null==r)e.errorMessage=$localize`There are missing fields in the registration form, please check that you filled in all fields.`;else{const i=yield e.authService.doRegister(t,n,r);if(i.isSuccess()){const t=yield e.authService.sendEmailVerification();t.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=t.getReason()}else e.errorMessage=i.getReason()}})()}registerWithGoogle(){var e=this;return Ow(function*(){const t=yield e.authService.doGoogleLogin();t.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=t.getReason()})()}getPasswordHelpClass(){const e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}canRegister(){const e=this.registrationForm.value.password??"";return!(""===(this.registrationForm.value.email??"")||""===(this.registrationForm.value.username??"")||""===e||e.length<6)}}return e.\u0275fac=function(t){return new(t||e)(ua(yZ),ua(gC))},e.\u0275cmp=Je({type:e,selectors:[["app-register"]],decls:56,vars:7,consts:function(){let e,t,n,r,i,s,o,a,l,c,u,h,d,f;return e=$localize`Registering`,t=$localize`Email`,n=$localize`Email`,r=$localize`A confirmation email will be sent to validate your account.`,i=$localize`Username`,s=$localize`Username`,o=$localize`Password`,a=$localize`Password`,l=$localize`The password should be at least 6 characters long`,c=$localize`Register`,u=$localize`Register with Google`,h=$localize`Have an account?`,d=$localize`Log in`,f=$localize`Registration error`,[[1,"box"],[1,"title"],e,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],t,[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",n,"type","email","autofocus","","required","",1,"input"],[1,"help"],r,["for","username",1,"label"],i,["id","username","formControlName","username","name","username","placeholder",s,"type","text","required","",1,"input"],["for","password",1,"label"],o,[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",a,"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],l,["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],c,[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],u,[1,"help","level-right"],h,[3,"routerLink"],d,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],f,["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"p",1),sc(2,2),pa(),fa(3,"form",3),fa(4,"div",4),fa(5,"div",5),fa(6,"label",6),sc(7,7),pa(),pa(),fa(8,"div",8),fa(9,"div",9),fa(10,"div",10),ga(11,"input",11),fa(12,"p",12),sc(13,13),pa(),pa(),pa(),pa(),pa(),fa(14,"div",4),fa(15,"div",5),fa(16,"label",14),sc(17,15),pa(),pa(),fa(18,"div",8),fa(19,"div",9),fa(20,"div",10),ga(21,"input",16),pa(),pa(),pa(),pa(),fa(22,"div",4),fa(23,"div",5),fa(24,"label",17),sc(25,18),pa(),pa(),fa(26,"div",8),fa(27,"div",9),fa(28,"div",19),ga(29,"input",20),fa(30,"span",21),ga(31,"fa-icon",22),pa(),fa(32,"p",23),sc(33,24),pa(),pa(),pa(),pa(),pa(),fa(34,"div",4),ga(35,"div",5),fa(36,"div",8),fa(37,"div",9),fa(38,"div",10),fa(39,"button",25),Ea("click",function(){return t.registerWithEmail()}),sc(40,26),pa(),pa(),pa(),pa(),pa(),fa(41,"div",4),ga(42,"div",5),fa(43,"div",27),la(44,x9,5,1,"div",28),pa(),pa(),fa(45,"div",4),ga(46,"div",5),fa(47,"div",8),fa(48,"button",29),Ea("click",function(){return t.registerWithGoogle()}),sc(49,30),pa(),pa(),pa(),fa(50,"p",31),ma(51),sc(52,32),ya(),Qa(53,"\xa0 "),fa(54,"a",33),sc(55,34),pa(),pa(),pa(),pa()),2&e&&(Ts(3),ha("formGroup",t.registrationForm),Ts(28),ha("icon",t.faEye),Ts(1),ha("ngClass",t.getPasswordHelpClass()),Ts(7),ha("disabled",!t.canRegister()),Ts(5),ha("ngIf",t.errorMessage),Ts(10),ha("routerLink",wu(6,D9)))},directives:[pg,Lp,_g,sp,Dp,wg,Q6,Ng,wW,X6,Jd,rf,vC],encapsulation:2}),e})(),F9=(()=>{class e{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}playLocally(){var e=this;return Ow(function*(){yield e.router.navigate(["local/"+e.selectedGame])})()}}return e.\u0275fac=function(t){return new(t||e)(ua(gC))},e.\u0275cmp=Je({type:e,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){let e;return e=$localize`Play offline`,[[3,"pickGame"],["id","playLocally",1,"button","is-primary","is-fullwidth",3,"disabled","click"],e]},template:function(e,t){1&e&&(fa(0,"app-pick-game",0),Ea("pickGame",function(e){return t.pickGame(e)}),pa(),fa(1,"button",1),Ea("click",function(){return t.playLocally()}),sc(2,2),pa()),2&e&&(Ts(1),ha("disabled",!t.selectedGame))},directives:[q6],encapsulation:2}),e})(),U9=(()=>{class e{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}launchTutorial(){var e=this;return Ow(function*(){yield e.router.navigate(["/tutorial/",e.selectedGame])})()}}return e.\u0275fac=function(t){return new(t||e)(ua(gC))},e.\u0275cmp=Je({type:e,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){let e;return e=$localize`Learn the rules`,[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],e]},template:function(e,t){1&e&&(fa(0,"app-pick-game",0),Ea("pickGame",function(e){return t.pickGame(e)}),pa(),fa(1,"button",1),Ea("click",function(){return t.launchTutorial()}),sc(2,2),pa()),2&e&&(Ts(1),ha("disabled",!t.selectedGame))},directives:[q6],encapsulation:2}),e})(),V9=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Je({type:e,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){let e;return e=$localize`The replay game is loading, please wait, it should not take long.`,[e]},template:function(e,t){1&e&&(fa(0,"p"),sc(1,0),pa())},encapsulation:2}),e})();function B9(e,t){if(1&e&&(_n(),ga(0,"polygon",4)),2&e){const e=Sa();ha("id",e.mainShapeId)("ngClass",e.pieceClasses),ra("points",e.MartianChessQueenComponent.HEPTAGON)}}function $9(e,t){if(1&e&&(_n(),ga(0,"polygon",4)),2&e){const e=Sa();ha("id",e.mainShapeId)("ngClass",e.pieceClasses),ra("points",e.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function z9(e,t){if(1&e&&(_n(),ga(0,"circle",5)),2&e){const e=Sa();ha("id",e.mainShapeId)("ngClass",e.pieceClasses),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function H9(e,t){if(1&e&&(ma(0),_n(),ga(1,"circle",6),ga(2,"circle",6),ga(3,"circle",6),ya()),2&e){const e=Sa();Ts(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(3)),Ts(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),Ts(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function G9(e,t){if(1&e&&(_n(),fa(0,"g"),ga(1,"circle",7),ga(2,"circle",7),ga(3,"circle",7),pa()),2&e){const e=Sa();Ts(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.45*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),Ts(1),ra("cx",.45*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),Ts(1),ra("cx",.55*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function Z9(e,t){if(1&e&&(_n(),fa(0,"g",8),ga(1,"circle",9),ga(2,"circle",9),ga(3,"circle",9),pa()),2&e){const e=Sa();ha("ngClass",e.pieceClasses),Ts(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE-3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),Ts(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),Ts(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE+3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}class q9{constructor(){this.MartianChessQueenComponent=q9,this.MartianChessComponent=D0,this.horizontalDotsRadius=D0.SPACE_SIZE/15}}function W9(e,t){if(1&e&&(_n(),ga(0,"polygon",4)),2&e){const e=Sa();ha("id",e.mainShapeId)("ngClass",e.pieceClasses),ra("points",e.MartianChessDroneComponent.PENTAGON)}}function j9(e,t){if(1&e&&(_n(),ga(0,"polygon",4)),2&e){const e=Sa();ha("id",e.mainShapeId)("ngClass",e.pieceClasses),ra("points",e.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function Y9(e,t){if(1&e&&(_n(),ga(0,"circle",5)),2&e){const e=Sa();ha("id",e.mainShapeId)("ngClass",e.pieceClasses),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function K9(e,t){if(1&e&&(ma(0),_n(),ga(1,"circle",6),ga(2,"circle",6),ya()),2&e){const e=Sa();Ts(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),Ts(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function Q9(e,t){if(1&e&&(_n(),fa(0,"g",7),ga(1,"circle",8),ga(2,"circle",8),pa()),2&e){const e=Sa();ha("ngClass",e.pieceClasses),Ts(1),ra("cx",.4*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),Ts(1),ra("cx",.6*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function X9(e,t){if(1&e&&(_n(),fa(0,"g",7),ga(1,"circle",9),ga(2,"circle",9),pa()),2&e){const e=Sa();ha("ngClass",e.pieceClasses),Ts(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE-2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),Ts(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE+2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}q9.HEPTAGON=D0.getRegularPolygon(7),q9.EIGHT_POINTED_STAR=D0.getNPointedStar(8,0),q9.\u0275fac=function(e){return new(e||q9)},q9.\u0275cmp=Je({type:q9,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(la(0,B9,1,3,"polygon",0),la(1,$9,1,3,"polygon",0),la(2,z9,1,5,"circle",1),la(3,H9,4,9,"ng-container",2),la(4,G9,4,9,"g",2),la(5,Z9,4,10,"g",3)),2&e&&(ha("ngIf","Polygon"===t.style.shape),Ts(1),ha("ngIf","Star"===t.style.shape),Ts(1),ha("ngIf","Circle"===t.style.shape),Ts(1),ha("ngIf","Concentric Circles"===t.style.points),Ts(1),ha("ngIf","Dots"===t.style.points),Ts(1),ha("ngIf","Horizontal Points"===t.style.points))},directives:[rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class J9{constructor(){this.MartianChessComponent=D0,this.MartianChessDroneComponent=J9,this.horizontalDotsRadius=D0.SPACE_SIZE/15}}function eee(e,t){if(1&e&&(_n(),ga(0,"polygon",5)),2&e){const e=Sa();ha("id",e.mainShapeId)("ngClass",e.pieceClasses),ra("points",e.MartianChessPawnComponent.TRIANGLE)}}function tee(e,t){if(1&e&&(_n(),ga(0,"polygon",5)),2&e){const e=Sa();ha("id",e.mainShapeId)("ngClass",e.pieceClasses),ra("points",e.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function nee(e,t){if(1&e&&(_n(),ga(0,"circle",6)),2&e){const e=Sa();ha("id",e.mainShapeId)("ngClass",e.pieceClasses),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function ree(e,t){if(1&e&&(_n(),ga(0,"circle",7)),2&e){const e=Sa();ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE+e.getConcreteTriangleYOffset())("r",e.MartianChessComponent.getRadius(1))}}function iee(e,t){if(1&e&&(_n(),ga(0,"circle",8)),2&e){const e=Sa();ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function see(e,t){if(1&e&&(_n(),fa(0,"g",9),ga(1,"circle",10),pa()),2&e){const e=Sa();ha("ngClass",e.pieceClasses),Ts(1),ra("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}J9.FOUR_POINTED_STAR_VERTICAL=D0.getNPointedStar(4,0),J9.PENTAGON=D0.getRegularPolygon(5),J9.\u0275fac=function(e){return new(e||J9)},J9.\u0275cmp=Je({type:J9,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(la(0,W9,1,3,"polygon",0),la(1,j9,1,3,"polygon",0),la(2,Y9,1,5,"circle",1),la(3,K9,3,6,"ng-container",2),la(4,Q9,3,7,"g",3),la(5,X9,3,7,"g",3)),2&e&&(ha("ngIf","Polygon"===t.style.shape),Ts(1),ha("ngIf","Star"===t.style.shape),Ts(1),ha("ngIf","Circle"===t.style.shape),Ts(1),ha("ngIf","Concentric Circles"===t.style.points),Ts(1),ha("ngIf","Dots"===t.style.points),Ts(1),ha("ngIf","Horizontal Points"===t.style.points))},directives:[rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class oee{constructor(){this.MartianChessComponent=D0,this.MartianChessPawnComponent=oee,this.horizontalDotsRadius=D0.SPACE_SIZE/15}static getTriangle(){return D0.getRegularPolygon(3,oee.TRIANGLE_Y_OFFSET)}static yOffsetForVerticalCentering(){const e=D0.getRegularPolygonCoords(3).map(e=>e.y);return(e.reduce((e,t)=>Math.min(e,t))+(100-e.reduce((e,t)=>Math.max(e,t))))/4}getConcreteTriangleYOffset(){return"Polygon"===this.style.shape?oee.TRIANGLE_Y_OFFSET:0}}oee.FOUR_POINTED_STAR_DIAGONAL=D0.getNPointedStar(4,45),oee.TRIANGLE_Y_OFFSET=oee.yOffsetForVerticalCentering(),oee.TRIANGLE=oee.getTriangle(),oee.\u0275fac=function(e){return new(e||oee)},oee.\u0275cmp=Je({type:oee,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(la(0,eee,1,3,"polygon",0),la(1,tee,1,3,"polygon",0),la(2,nee,1,5,"circle",1),la(3,ree,1,3,"circle",2),la(4,iee,1,3,"circle",3),la(5,see,2,4,"g",4)),2&e&&(ha("ngIf","Polygon"===t.style.shape),Ts(1),ha("ngIf","Star"===t.style.shape),Ts(1),ha("ngIf","Circle"===t.style.shape),Ts(1),ha("ngIf","Concentric Circles"===t.style.points),Ts(1),ha("ngIf","Dots"===t.style.points),Ts(1),ha("ngIf","Horizontal Points"===t.style.points))},directives:[rf,Jd],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});const aee={apiKey:"AIzaSyAt5QHXLnm2Uf9X7VN6XPPiSaipoh3oRHo",authDomain:"firestore-c9d47.firebaseapp.com",databaseURL:"https://firestore-c9d47.firebaseio.com",projectId:"firestore-c9d47",storageBucket:"firestore-c9d47.appspot.com",messagingSenderId:"936588361631",appId:"1:936588361631:web:2c059886d8d427edbac7aa"};let lee=(()=>{class e{constructor(e){this.authService=e}canActivate(){var e=this;return Ow(function*(){return new Promise(t=>{e.userSub=e.authService.subscribeToUser(function(){var n=Ow(function*(n){yield e.evaluateUserPermission(n).then(t)});return function(e){return n.apply(this,arguments)}}())})})()}ngOnDestroy(){this.userSub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(Or(yZ))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),cee=(()=>{class e extends lee{constructor(e,t){super(e),this.router=t}evaluateUserPermission(e){var t=this;return Ow(function*(){return!1===e.isConnected()?t.router.parseUrl("/login"):!1!==e.verified||t.router.parseUrl("/verify-account")})()}}return e.\u0275fac=function(t){return new(t||e)(Or(yZ),Or(gC))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function uee(e,t){1&e&&(fa(0,"p",20),sc(1,21),pa())}function hee(e,t){if(1&e){const e=va();fa(0,"div",7),fa(1,"p",8),sc(2,9),pa(),fa(3,"div",10),fa(4,"p",11),sc(5,12),pa(),fa(6,"button",13),Ea("click",function(){return Gt(e),Sa().finalizeEmailVerification()}),sc(7,14),pa(),pa(),fa(8,"div",15),fa(9,"p",11),sc(10,16),pa(),fa(11,"button",17),Ea("click",function(){return Gt(e),Sa().sendEmailVerification()}),sc(12,18),pa(),pa(),la(13,uee,2,0,"p",19),pa()}if(2&e){const e=Sa();Ts(2),oc(e.emailAddress),ac(2),Ts(11),ha("ngIf",e.success)}}function dee(e,t){if(1&e){const e=va();fa(0,"div",24),fa(1,"div",8),sc(2,25),pa(),fa(3,"form",26),fa(4,"div",27),fa(5,"div",28),ga(6,"input",29),pa(),fa(7,"div",28),fa(8,"button",30),Ea("click",function(){Gt(e);const t=Sa(2);return t.pickUsername(t.usernameForm.value)}),sc(9,31),pa(),pa(),pa(),pa(),pa()}if(2&e){const e=Sa(2);Ts(3),ha("formGroup",e.usernameForm)}}const fee=function(){return["/lobby"]};function pee(e,t){1&e&&(fa(0,"div",32),rc(1,33),ga(2,"a",34),ic(),pa()),2&e&&(Ts(2),ha("routerLink",wu(1,fee)))}function gee(e,t){if(1&e&&(ma(0),la(1,dee,10,1,"div",22),la(2,pee,3,2,"div",23),ya()),2&e){const e=Sa();Ts(1),ha("ngIf",!e.success),Ts(1),ha("ngIf",e.success)}}function mee(e,t){if(1&e&&(fa(0,"div",35),fa(1,"div",36),Qa(2),pa(),pa()),2&e){const e=Sa();Ts(2),Xa(e.errorMessage)}}let yee=(()=>{class e{constructor(e,t){this.authService=e,this.router=t,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new og({username:new sg})}ngOnInit(){var e=this;return Ow(function*(){e.userSub=e.authService.subscribeToUser(function(){var t=Ow(function*(t){e.emailAddress=t.email.get(),t.username.isAbsent()?e.verificationType="enter-username":(e.verificationType="send-email",!0===e.triedToFinalize&&!1===t.verified&&(e.errorMessage=$localize`You have not verified your email! Click on the link in the verification email.`),!0===t.verified&&(yield e.router.navigate(["/lobby"])))});return function(e){return t.apply(this,arguments)}}())})()}pickUsername(e){var t=this;return Ow(function*(){const n=yield t.authService.setUsername(e.username);n.isSuccess()?t.success=!0:t.errorMessage=n.getReason()})()}sendEmailVerification(){var e=this;return Ow(function*(){const t=yield e.authService.sendEmailVerification();t.isSuccess()?e.success=!0:e.errorMessage=t.getReason()})()}finalizeEmailVerification(){var e=this;return Ow(function*(){e.triedToFinalize=!0,yield e.authService.reloadUser(),window.open(window.location.href,"_self")})()}ngOnDestroy(){null!=this.userSub&&null!=this.userSub.unsubscribe&&this.userSub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(ua(yZ),ua(gC))},e.\u0275cmp=Je({type:e,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){let e,t,n,r,i,s,o,a,l,c,u;return e=$localize`Account verification`,t=$localize`In order to finalize your account, you must click on the link that you should have received on your email address (${"\ufffd0\ufffd"}:INTERPOLATION:). The email could be in your spam folder.`,n=$localize`Once you have verified your email, click on the following button:`,r=$localize`Finalize email verification`,i=$localize`If you have not received the verification email, click on the following button:`,s=$localize`Send verification email again`,o=$localize`The email has been sent`,a=$localize`In order to finalize your account, you must choose a username.`,l=$localize`Username`,c=$localize`Pick username`,u=$localize`Your account has now been finalized, you can go back to the ${"\ufffd#2\ufffd"}:START_LINK:list of games${"\ufffd/#2\ufffd"}:CLOSE_LINK:.`,[[1,"box"],[1,"message","is-info"],[1,"message-header"],e,["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],t,[1,"block","level-left"],[1,"level-item"],n,["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],r,[1,"level-left"],i,["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],s,["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],o,["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],a,[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",l,"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],c,["id","success",1,"message-body"],u,[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"div",1),fa(2,"div",2),sc(3,3),pa(),la(4,hee,14,2,"div",4),la(5,gee,3,2,"ng-container",5),pa(),la(6,mee,3,1,"div",6),pa()),2&e&&(Ts(4),ha("ngIf","send-email"===t.verificationType),Ts(1),ha("ngIf","enter-username"===t.verificationType),Ts(1),ha("ngIf",t.errorMessage))},directives:[rf,pg,Lp,_g,sp,Ng,Dp,wg,vC],encapsulation:2}),e})(),vee=(()=>{class e extends lee{constructor(e,t){super(e),this.router=t}evaluateUserPermission(e){var t=this;return Ow(function*(){return!1===e.isConnected()?t.router.parseUrl("/login"):!e.verified||t.router.parseUrl("/")})()}}return e.\u0275fac=function(t){return new(t||e)(Or(yZ),Or(gC))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Cee=(()=>{class e extends lee{constructor(e,t){super(e),this.router=t}evaluateUserPermission(e){var t=this;return Ow(function*(){return!1===e.isConnected()||t.router.parseUrl("/")})()}}return e.\u0275fac=function(t){return new(t||e)(Or(yZ),Or(gC))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function _ee(e,t){1&e&&(fa(0,"p",12),sc(1,13),pa())}function Eee(e,t){if(1&e&&(fa(0,"div",14),fa(1,"div",15),sc(2,16),pa(),fa(3,"div",17),Qa(4),pa(),pa()),2&e){const e=Sa();Ts(4),Xa(e.errorMessage.get())}}const wee=function(){return{standalone:!0}};let Pee=(()=>{class e{constructor(e){this.authService=e,this.success=!1,this.errorMessage=Nw.empty(),this.email=""}resetPassword(){var e=this;return Ow(function*(){hZ(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=Nw.empty(),e.success=!1;const t=yield e.authService.sendPasswordResetEmail(e.email);t.isSuccess()?e.success=!0:e.errorMessage=Nw.of(t.getReason())})()}}return e.\u0275fac=function(t){return new(t||e)(ua(yZ))},e.\u0275cmp=Je({type:e,selectors:[["app-reset-password"]],decls:12,vars:6,consts:function(){let e,t,n,r,i,s;return e=$localize`Password reset`,t=$localize`Email`,n=$localize`An email will be sent with instruction to reset your password.`,r=$localize`Reset password`,i=$localize`The email has been sent, please follow the instructions from that email.`,s=$localize`Error`,[[1,"box"],[1,"title"],e,[1,"field"],[1,"control"],["id","email","name","email","placeholder",t,"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],n,["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],r,["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],i,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],s,["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"p",1),sc(2,2),pa(),fa(3,"div",3),fa(4,"div",4),fa(5,"input",5),Ea("ngModelChange",function(e){return t.email=e}),pa(),fa(6,"p",6),sc(7,7),pa(),la(8,_ee,2,0,"p",8),pa(),pa(),fa(9,"button",9),Ea("click",function(){return t.resetPassword()}),sc(10,10),pa(),la(11,Eee,5,1,"div",11),pa()),2&e&&(Ts(5),ha("ngModel",t.email)("ngModelOptions",wu(5,wee)),Ts(3),ha("ngIf",t.success),Ts(1),ha("disabled",""===t.email),Ts(2),ha("ngIf",t.errorMessage.isPresent()))},directives:[sp,Q6,Ng,Dp,fg,rf],encapsulation:2}),e})();function See(e,t){if(1&e&&(fa(0,"option",13),Qa(1),pa()),2&e){const e=t.$implicit,n=Sa();ha("value",e.value)("selected",e.value===n.currentTheme),Ts(1),Ja(" ",e.name," ")}}function bee(e,t){if(1&e&&(fa(0,"option",13),Qa(1),pa()),2&e){const e=t.$implicit,n=Sa();ha("value",e.value)("selected",e.value===n.currentLanguage),Ts(1),Ja(" ",e.name," ")}}let Oee=(()=>{class e{constructor(e,t){this.userSettingsService=e,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize`Light`},{value:"dark",name:$localize`Dark`}],this.currentTheme=t.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}changeLanguage(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}changeTheme(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}reload(){window.open(window.location.href,"_self")}}return e.\u0275fac=function(t){return new(t||e)(ua(zZ),ua(HZ))},e.\u0275cmp=Je({type:e,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){let e,t,n;return e=$localize`User settings`,t=$localize`Theme`,n=$localize`Language`,[[1,"box"],[1,"title"],e,[1,"field"],["for","theme",1,"label"],t,[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],n,["id","language",3,"change"],[3,"value","selected"]]},template:function(e,t){1&e&&(fa(0,"div",0),fa(1,"p",1),sc(2,2),pa(),fa(3,"div",3),fa(4,"label",4),sc(5,5),pa(),fa(6,"div",6),fa(7,"div",7),fa(8,"select",8),Ea("change",function(e){return t.changeTheme(e)}),la(9,See,2,3,"option",9),pa(),pa(),pa(),pa(),fa(10,"div",3),fa(11,"label",10),sc(12,11),pa(),fa(13,"div",6),fa(14,"div",7),fa(15,"select",12),Ea("change",function(e){return t.changeLanguage(e)}),la(16,bee,2,3,"option",9),pa(),pa(),pa(),pa(),pa()),2&e&&(Ts(9),ha("ngForOf",t.availableThemes),Ts(7),ha("ngForOf",t.availableLanguages))},directives:[tf,Og,Ag],encapsulation:2}),e})(),Tee=(()=>{class e{}return e.ALREADY_INGAME=()=>$localize`You are already in a game. Finish it or cancel it first.`,e})(),Iee=(()=>{class e{constructor(e,t,n,r,i,s){this.route=e,this.router=t,this.connectedUserService=n,this.messageDisplayer=r,this.activePartsService=i,this.gameService=s}ngOnInit(){var e=this;return Ow(function*(){yield e.createGameAndRedirectOrShowError(e.extractGameFromURL())})()}extractGameFromURL(){return Tw.getNonNullable(this.route.snapshot.paramMap.get("compo"))}createGameAndRedirectOrShowError(e){var t=this;return Ow(function*(){const n=t.connectedUserService.user.get();hZ(n.isConnected(),"User must be connected and have a username to reach this page");const r=n.toMinimalUser();if(!1===t.gameExists(e))return yield t.router.navigate(["/notFound",I8.NO_MATCHING_GAME(e)],{skipLocationChange:!0}),!1;if(yield t.canCreateOnlineGame(r)){const n=yield t.gameService.createPartConfigRoomAndChat(e);return yield t.router.navigate(["/play",e,n]),!0}return t.messageDisplayer.infoMessage(Tee.ALREADY_INGAME()),yield t.router.navigate(["/lobby"]),!1})()}gameExists(e){return Nw.ofNullable(Z6.ALL_GAMES().find(t=>t.urlName===e)).isPresent()}canCreateOnlineGame(e){var t=this;return Ow(function*(){return!1===(yield t.activePartsService.userHasActivePart(e))})()}}return e.\u0275fac=function(t){return new(t||e)(ua(Wy),ua(gC),ua(yZ),ua(cZ),ua(i8),ua(FZ))},e.\u0275cmp=Je({type:e,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){let e;return e=$localize`Creating online game, please wait, it should not take long.`,[e]},template:function(e,t){1&e&&(fa(0,"p"),sc(1,0),pa())},encapsulation:2}),e})();!function(e,t,n){!function(e,t,n){"string"!=typeof t&&(n=t,t=e[cl.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),sl[t]=e,n&&(sl[t][cl.ExtraData]=n)}(e,void 0,void 0)}(Sw());const kee=[{path:"login",component:n8},{path:"lobby",component:S8,canActivate:[cee]},{path:"settings",component:Oee},{path:"register",component:L9,canActivate:[Cee]},{path:"reset-password",component:Pee,canActivate:[Cee]},{path:"notFound/:message",component:b8},{path:"nextGameLoading",component:V9,canActivate:[cee]},{path:"verify-account",component:yee,canActivate:[vee]},{path:"play",component:s8,canActivate:[cee]},{path:"play/:compo",component:Iee,canActivate:[cee]},{path:"play/:compo/:id",component:K7,canActivate:[cee]},{path:"local",component:F9},{path:"local/:compo",component:g9},{path:"tutorial",component:U9},{path:"tutorial/:compo",component:R9},{path:"",component:K6},{path:"**",component:b8}];class Aee{static app(){return function(e,...t){return{ngModule:EB,providers:[{provide:yB,useFactory:_B(e),multi:!0,deps:[vh,zo,lB,...t]}]}}(()=>wB(aee))}static firestore(){return function(e,...t){return{ngModule:zG,providers:[{provide:UG,useFactory:VG(e),multi:!0,deps:[vh,zo,lB,mB,[new Nr,PG],[new Nr,t$],...t]}]}}(()=>{const e=YG();e.toJSON();return e})}static auth(){return function(e,...t){return{ngModule:IG,providers:[{provide:SG,useFactory:bG(e),multi:!0,deps:[vh,zo,lB,mB,[new Nr,t$],...t]}]}}(()=>{const e=AG();return e})}}let Mee=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=rt({type:e,bootstrap:[FW]}),e.\u0275inj=Se({providers:[yZ,FZ,LZ,fZ,oZ,HZ,{provide:oh,useValue:$Z.getLocale()}],imports:[[Aee.app(),Aee.firestore(),Aee.auth(),Zf,Em,AC.forRoot(kee,{useHash:!1}),Fg,Lg,ww,PW]]}),e})();!function(e,t,n){const r=e.\u0275cmp;r.directiveDefs=()=>t.map(et),r.pipeDefs=()=>n.map(tt)}(D0,[tf,Jd,rf,oee,J9,q9],[]);"undefined"!=typeof window&&window,"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self;"undefined"!=typeof global&&global;class Nee{constructor(e){this.digits=e}static zero(){return new Nee([0])}static one(){return new Nee([1])}clone(){return new Nee(this.digits.slice())}add(e){const t=this.clone();return t.addToSelf(e),t}addToSelf(e){const t=Math.max(this.digits.length,e.digits.length);let n=0;for(let r=0;r<t;r++){let t=n;r<this.digits.length&&(t+=this.digits[r]),r<e.digits.length&&(t+=e.digits[r]),t>=10?(this.digits[r]=t-10,n=1):(this.digits[r]=t,n=0)}n>0&&(this.digits[t]=1)}toString(){let e="";for(let t=this.digits.length-1;t>=0;t--)e+=this.digits[t];return e}}class Ree{constructor(e){this.powerOfTwos=[e]}getValue(){return this.powerOfTwos[0]}multiplyBy(e){const t=Nee.zero();return this.multiplyByAndAddTo(e,t),t}multiplyByAndAddTo(e,t){for(let n=0;0!==e;e>>>=1,n++)if(1&e){const e=this.getMultipliedByPowerOfTwo(n);t.addToSelf(e)}}getMultipliedByPowerOfTwo(e){for(let t=this.powerOfTwos.length;t<=e;t++){const e=this.powerOfTwos[t-1];this.powerOfTwos[t]=e.add(e)}return this.powerOfTwos[e]}}class xee{constructor(e){this.base=e,this.exponents=[new Ree(Nee.one())]}toThePowerOf(e){for(let t=this.exponents.length;t<=e;t++){const e=this.exponents[t-1].multiplyBy(this.base);this.exponents[t]=new Ree(e)}return this.exponents[e]}}function Dee(e){const t=function(e){let t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r>=55296&&r<=56319&&e.length>n+1){const t=e.charCodeAt(n+1);t>=56320&&t<=57343&&(n++,r=(r-55296<<10)+t-56320+65536)}r<=127?t.push(r):r<=2047?t.push(r>>6&31|192,63&r|128):r<=65535?t.push(r>>12|224,r>>6&63|128,63&r|128):r<=2097151&&t.push(r>>18&7|240,r>>12&63|128,r>>6&63|128,63&r|128)}return t}(e);let n=Lee(t,0),r=Lee(t,102072);return 0==n&&(0==r||1==r)&&(n^=319790063,r^=-1801410264),[n,r]}function Lee(e,t){let n,r=2654435769,i=2654435769;const s=e.length;for(n=0;n+12<=s;n+=12){r=Vee(r,Hee(e,n,Uee.Little)),i=Vee(i,Hee(e,n+4,Uee.Little));const s=Fee(r,i,t=Vee(t,Hee(e,n+8,Uee.Little)));r=s[0],i=s[1],t=s[2]}return r=Vee(r,Hee(e,n,Uee.Little)),i=Vee(i,Hee(e,n+4,Uee.Little)),t=Vee(t,s),Fee(r,i,t=Vee(t,Hee(e,n+8,Uee.Little)<<8))[2]}function Fee(e,t,n){return e=$ee(e,t),e=$ee(e,n),e^=n>>>13,t=$ee(t,n),t=$ee(t,e),t^=e<<8,n=$ee(n,e),n=$ee(n,t),n^=t>>>13,e=$ee(e,t),e=$ee(e,n),e^=n>>>12,t=$ee(t,n),t=$ee(t,e),t^=e<<16,n=$ee(n,e),n=$ee(n,t),n^=t>>>5,e=$ee(e,t),e=$ee(e,n),e^=n>>>3,t=$ee(t,n),t=$ee(t,e),t^=e<<10,n=$ee(n,e),n=$ee(n,t),[e,t,n^=t>>>15]}var Uee=(()=>((Uee=Uee||{})[Uee.Little=0]="Little",Uee[Uee.Big=1]="Big",Uee))();function Vee(e,t){return Bee(e,t)[1]}function Bee(e,t){const n=(65535&e)+(65535&t),r=(e>>>16)+(t>>>16)+(n>>>16);return[r>>>16,r<<16|65535&n]}function $ee(e,t){const n=(65535&e)-(65535&t);return(e>>16)-(t>>16)+(n>>16)<<16|65535&n}function zee(e,t){return t>=e.length?0:e[t]}function Hee(e,t,n){let r=0;if(n===Uee.Big)for(let i=0;i<4;i++)r+=zee(e,t+i)<<24-8*i;else for(let i=0;i<4;i++)r+=zee(e,t+i)<<8*i;return r}const Gee=new xee(256);function Zee(e,t,n,r,i=[]){const s={},o={},a=function(e,t){const{text:n,block:r}=qee(e,t);if(void 0===r)return{text:n};{const[e,...t]=r.split("\u241f"),[i,s]=e.split("@@",2);let[o,a]=i.split("|",2);return void 0===a&&(a=o,o=void 0),""===a&&(a=void 0),{text:n,meaning:o,description:a,customId:s,legacyIds:t}}}(e[0],e.raw[0]),l=[a.text],c=[];let u=a.text;for(let f=1;f<e.length;f++){const{text:n,block:r=Wee(f)}=qee(e[f],e.raw[f]);u+=`{$${r}}${n}`,void 0!==t&&(s[r]=t[f-1],o[r]=i[f-1]),c.push(r),l.push(n)}const h=a.customId||function(e,t=""){let n=Dee(e);if(t){const e=Dee(t);n=function(e,t){const n=e[0],r=t[0],i=Bee(e[1],t[1]),s=i[0],o=i[1];return[Vee(Vee(n,r),s),o]}(function(e,t){const n=e[0],r=e[1];return[n<<1|r>>>31,r<<1|n>>>31]}(n),e)}return function(e,t){const n=Gee.toThePowerOf(0).multiplyBy(t);return Gee.toThePowerOf(4).multiplyByAndAddTo(e,n),n.toString()}(2147483647&n[0],n[1])}(u,a.meaning||""),d=a.legacyIds?a.legacyIds.filter(e=>e!==h):[];return{id:h,legacyIds:d,substitutions:s,substitutionLocations:o,text:u,customId:a.customId,meaning:a.meaning||"",description:a.description||"",messageParts:l,messagePartLocations:r,placeholderNames:c,location:n}}function qee(e,t){if(":"!==t.charAt(0))return{text:e};{const n=function(e,t){for(let n=1,r=1;n<e.length;n++,r++)if("\\"===t[r])r++;else if(":"===e[n])return n;throw new Error(`Unterminated $localize metadata block in "${t}".`)}(e,t);return{block:e.substring(1,n),text:e.substring(n+1)}}}function Wee(e){return 1===e?"PH":"PH_"+(e-1)}Object.keys({useClass:null}),Object.keys({useFactory:null}),Object.keys({useValue:null}),Object.keys({useExisting:null});class jee extends Error{constructor(e){super(`No translation found for ${Kee(e)}.`),this.parsedMessage=e,this.type="MissingTranslationError"}}function Yee(e,t){return Object.defineProperty(e,"raw",{value:t}),e}function Kee(e){const t=e.meaning&&` - "${e.meaning}"`,n=e.legacyIds&&e.legacyIds.length>0?` [${e.legacyIds.map(e=>`"${e}"`).join(", ")}]`:"";return`"${e.id}"${n} ("${e.text}"${t})`}function Qee(e,t){try{return function(e,t,n){const r=Zee(t,n);let i=e[r.id];if(void 0!==r.legacyIds)for(let s=0;s<r.legacyIds.length&&void 0===i;s++)i=e[r.legacyIds[s]];if(void 0===i)throw new jee(r);return[i.messageParts,i.placeholderNames.map(e=>{if(r.substitutions.hasOwnProperty(e))return r.substitutions[e];throw new Error(`There is a placeholder name mismatch with the translation provided for the message ${Kee(r)}.\nThe translation contains a placeholder with name ${e}, which does not exist in the message.`)})]}($localize.TRANSLATIONS,e,t)}catch(n){return console.warn(n.message),[e,t]}}function Xee(){(function(){if(Ah)throw new Error("Cannot enable prod mode after platform setup.");kh=!1})(),Hf().bootstrapModule(Mee).catch(e=>console.error(e))}const Jee=$Z.getLocale();"en"!==Jee?fetch("/assets/"+Jee+".json").then(e=>e.ok?e.json():{locale:"en",translations:{}}).then(e=>{(function(e){$localize.translate||($localize.translate=Qee),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(e).forEach(t=>{$localize.TRANSLATIONS[t]=function(e){const t=e.split(/{\$([^}]*)}/),n=[t[0]],r=[];for(let s=1;s<t.length-1;s+=2)r.push(t[s]),n.push(`${t[s+1]}`);const i=n.map(e=>":"===e.charAt(0)?"\\"+e:e);return{text:e,messageParts:Yee(n,i),placeholderNames:r}}(e[t])})})(e.translations),$localize.locale=e.locale,Xee()}).catch(function(e){console.log(e)}):Xee()}},function(e){e(e.s=6607)}]);