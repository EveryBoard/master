(self.webpackChunkeveryboard=self.webpackChunkeveryboard||[]).push([[179],{1584:(Au,y0,Ns)=>{"use strict";let m1=null,d3=1;const jo=Symbol("SIGNAL");function j1(r){const e=m1;return m1=r,e}function ks(r){if((!Rs(r)||r.dirty)&&(r.dirty||r.lastCleanEpoch!==d3)){if(!r.producerMustRecompute(r)&&!at(r))return r.dirty=!1,void(r.lastCleanEpoch=d3);r.producerRecomputeValue(r),r.dirty=!1,r.lastCleanEpoch=d3}}function at(r){n2(r);for(let e=0;e<r.producerNode.length;e++){const t=r.producerNode[e],n=r.producerLastReadVersion[e];if(n!==t.version||(ks(t),n!==t.version))return!0}return!1}function N1(r,e){if(function m4(r){r.liveConsumerNode??=[],r.liveConsumerIndexOfThis??=[]}(r),n2(r),1===r.liveConsumerNode.length)for(let n=0;n<r.producerNode.length;n++)N1(r.producerNode[n],r.producerIndexOfThis[n]);const t=r.liveConsumerNode.length-1;if(r.liveConsumerNode[e]=r.liveConsumerNode[t],r.liveConsumerIndexOfThis[e]=r.liveConsumerIndexOfThis[t],r.liveConsumerNode.length--,r.liveConsumerIndexOfThis.length--,e<r.liveConsumerNode.length){const n=r.liveConsumerIndexOfThis[e],i=r.liveConsumerNode[e];n2(i),i.producerIndexOfThis[n]=e}}function Rs(r){return r.consumerIsAlwaysLive||(r?.liveConsumerNode?.length??0)>0}function n2(r){r.producerNode??=[],r.producerIndexOfThis??=[],r.producerLastReadVersion??=[]}let Zd=null;function re(r){return"function"==typeof r}function he(r){const t=r(n=>{Error.call(n),n.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const be=he(r=>function(t){r(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((n,i)=>`${i+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function De(r,e){if(r){const t=r.indexOf(e);0<=t&&r.splice(t,1)}}class Ue{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const o of t)o.remove(this);else t.remove(this);const{initialTeardown:n}=this;if(re(n))try{n()}catch(o){e=o instanceof be?o.errors:[o]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const o of i)try{E1(o)}catch(s){e=e??[],s instanceof be?e=[...e,...s.errors]:e.push(s)}}if(e)throw new be(e)}}add(e){var t;if(e&&e!==this)if(this.closed)E1(e);else{if(e instanceof Ue){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&De(t,e)}remove(e){const{_finalizers:t}=this;t&&De(t,e),e instanceof Ue&&e._removeParent(this)}}Ue.EMPTY=(()=>{const r=new Ue;return r.closed=!0,r})();const At=Ue.EMPTY;function r2(r){return r instanceof Ue||r&&"closed"in r&&re(r.remove)&&re(r.add)&&re(r.unsubscribe)}function E1(r){re(r)?r():r.unsubscribe()}const qn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},ei={setTimeout(r,e,...t){const{delegate:n}=ei;return n?.setTimeout?n.setTimeout(r,e,...t):setTimeout(r,e,...t)},clearTimeout(r){const{delegate:e}=ei;return(e?.clearTimeout||clearTimeout)(r)},delegate:void 0};function g3(r){ei.setTimeout(()=>{const{onUnhandledError:e}=qn;if(!e)throw r;e(r)})}function p3(){}const S0=_4("C",void 0,void 0);function _4(r,e,t){return{kind:r,value:e,error:t}}let I1=null;function ec(r){if(qn.useDeprecatedSynchronousErrorHandling){const e=!I1;if(e&&(I1={errorThrown:!1,error:null}),r(),e){const{errorThrown:t,error:n}=I1;if(I1=null,t)throw n}}else r()}class Iu extends Ue{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,r2(e)&&e.add(this)):this.destination=kse}static create(e,t,n){return new Bv(e,t,n)}next(e){this.isStopped?Wv(function Zo(r){return _4("N",r,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Wv(function Nu(r){return _4("E",void 0,r)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Wv(S0,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const $v=Function.prototype.bind;function Gv(r,e){return $v.call(r,e)}class Nse{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){Xd(n)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){Xd(n)}else Xd(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Xd(t)}}}class Bv extends Iu{constructor(e,t,n){let i;if(super(),re(e)||!e)i={next:e??void 0,error:t??void 0,complete:n??void 0};else{let o;this&&qn.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Gv(e.next,o),error:e.error&&Gv(e.error,o),complete:e.complete&&Gv(e.complete,o)}):i=e}this.destination=new Nse(i)}}function Xd(r){qn.useDeprecatedSynchronousErrorHandling?function Uv(r){qn.useDeprecatedSynchronousErrorHandling&&I1&&(I1.errorThrown=!0,I1.error=r)}(r):g3(r)}function Wv(r,e){const{onStoppedNotification:t}=qn;t&&ei.setTimeout(()=>t(r,e))}const kse={closed:!0,next:p3,error:function Ise(r){throw r},complete:p3},qv="function"==typeof Symbol&&Symbol.observable||"@@observable";function $l(r){return r}function kR(r){return 0===r.length?$l:1===r.length?r[0]:function(t){return r.reduce((n,i)=>i(n),t)}}let Pr=(()=>{class r{constructor(t){t&&(this._subscribe=t)}lift(t){const n=new r;return n.source=this,n.operator=t,n}subscribe(t,n,i){const o=function Lse(r){return r&&r instanceof Iu||function xse(r){return r&&re(r.next)&&re(r.error)&&re(r.complete)}(r)&&r2(r)}(t)?t:new Bv(t,n,i);return ec(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return new(n=RR(n))((i,o)=>{const s=new Bv({next:a=>{try{t(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(t)}[qv](){return this}pipe(...t){return kR(t)(this)}toPromise(t){return new(t=RR(t))((n,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>n(o))})}}return r.create=e=>new r(e),r})();function RR(r){var e;return null!==(e=r??qn.Promise)&&void 0!==e?e:Promise}const zse=he(r=>function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let xs=(()=>{class r extends Pr{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const n=new xR(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new zse}next(t){ec(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(t)}})}error(t){ec(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){ec(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:n,isStopped:i,observers:o}=this;return n||i?At:(this.currentObservers=null,o.push(t),new Ue(()=>{this.currentObservers=null,De(o,t)}))}_checkFinalizedStatuses(t){const{hasError:n,thrownError:i,isStopped:o}=this;n?t.error(i):o&&t.complete()}asObservable(){const t=new Pr;return t.source=this,t}}return r.create=(e,t)=>new xR(e,t),r})();class xR extends xs{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}error(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:At}}class Yo extends xs{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}function LR(r){return re(r?.lift)}function o2(r){return e=>{if(LR(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function gi(r,e,t,n,i){return new Dse(r,e,t,n,i)}class Dse extends Iu{constructor(e,t,n,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function jn(r,e){return o2((t,n)=>{let i=0;t.subscribe(gi(n,o=>{n.next(r.call(e,o,i++))}))})}const zR="https://g.co/ng/security#xss";class ge extends Error{constructor(e,t){super(function O0(r,e){return`NG0${Math.abs(r)}${e?": "+e:""}`}(e,t)),this.code=e}}function c1(r){for(let e in r)if(r[e]===c1)return e;throw Error("Could not find renamed property on target object.")}function Hse(r,e){for(const t in e)e.hasOwnProperty(t)&&!r.hasOwnProperty(t)&&(r[t]=e[t])}function pi(r){if("string"==typeof r)return r;if(Array.isArray(r))return"["+r.map(pi).join(", ")+"]";if(null==r)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;const e=r.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function jv(r,e){return null==r||""===r?null===e?"":e:null==e||""===e?r:r+" "+e}const Fse=c1({__forward_ref__:c1});function k1(r){return r.__forward_ref__=k1,r.toString=function(){return pi(this())},r}function Ht(r){return Qd(r)?r():r}function Qd(r){return"function"==typeof r&&r.hasOwnProperty(Fse)&&r.__forward_ref__===k1}function Zv(r){return r&&!!r.\u0275providers}const ku=c1({\u0275cmp:c1}),Yv=c1({\u0275dir:c1}),Kv=c1({\u0275pipe:c1}),HR=c1({\u0275mod:c1}),m3=c1({\u0275fac:c1}),Ru=c1({__NG_ELEMENT_ID__:c1}),FR=c1({__NG_ENV_ID__:c1});function Xt(r){return"string"==typeof r?r:null==r?"":String(r)}function Xv(r,e){throw new ge(-201,!1)}function Ft(r,e,t,n){throw new Error(`ASSERTION ERROR: ${r}`+(null==n?"":` [Expected=> ${t} ${n} ${e} <=Actual]`))}function xe(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function s2(r){return{providers:r.providers||[],imports:r.imports||[]}}function Jd(r){return UR(r,th)||UR(r,$R)}function UR(r,e){return r.hasOwnProperty(e)?r[e]:null}function eh(r){return r&&(r.hasOwnProperty(Qv)||r.hasOwnProperty(Yse))?r[Qv]:null}const th=c1({\u0275prov:c1}),Qv=c1({\u0275inj:c1}),$R=c1({ngInjectableDef:c1}),Yse=c1({ngInjectorDef:c1});var Mn=function(r){return r[r.Default=0]="Default",r[r.Host=1]="Host",r[r.Self=2]="Self",r[r.SkipSelf=4]="SkipSelf",r[r.Optional=8]="Optional",r}(Mn||{});let Jv;function GR(){return Jv}function To(r){const e=Jv;return Jv=r,e}function BR(r,e,t){const n=Jd(r);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:t&Mn.Optional?null:void 0!==e?e:void Xv()}const R1=globalThis;class Qe{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=xe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const xu={},iy="__NG_DI_FLAG__",nh="ngTempTokenPath",Qse=/\n/gm,qR="__source";let T0;function v4(r){const e=T0;return T0=r,e}function tae(r,e=Mn.Default){if(void 0===T0)throw new ge(-203,!1);return null===T0?BR(r,void 0,e):T0.get(r,e&Mn.Optional?null:void 0,e)}function Ae(r,e=Mn.Default){return(GR()||tae)(Ht(r),e)}function Le(r,e=Mn.Default){return Ae(r,rh(e))}function rh(r){return typeof r>"u"||"number"==typeof r?r:0|(r.optional&&8)|(r.host&&1)|(r.self&&2)|(r.skipSelf&&4)}function oy(r){const e=[];for(let t=0;t<r.length;t++){const n=Ht(r[t]);if(Array.isArray(n)){if(0===n.length)throw new ge(900,!1);let i,o=Mn.Default;for(let s=0;s<n.length;s++){const a=n[s],c=nae(a);"number"==typeof c?-1===c?i=a.token:o|=c:i=a}e.push(Ae(i,o))}else e.push(Ae(n))}return e}function Lu(r,e){return r[iy]=e,r.prototype[iy]=e,r}function nae(r){return r[iy]}function _3(r){return{toString:r}.toString()}var ih=function(r){return r[r.OnPush=0]="OnPush",r[r.Default=1]="Default",r}(ih||{}),Ca=function(r){return r[r.Emulated=0]="Emulated",r[r.None=2]="None",r[r.ShadowDom=3]="ShadowDom",r}(Ca||{});const tc={},Kn=[];var Z1=function(r){return r[r.None=0]="None",r[r.SignalBased=1]="SignalBased",r[r.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",r}(Z1||{});function ZR(r,e,t){let n=r.length;for(;;){const i=r.indexOf(e,t);if(-1===i)return i;if(0===i||r.charCodeAt(i-1)<=32){const o=e.length;if(i+o===n||r.charCodeAt(i+o)<=32)return i}t=i+1}}function sy(r,e,t){let n=0;for(;n<t.length;){const i=t[n];if("number"==typeof i){if(0!==i)break;n++;const o=t[n++],s=t[n++],a=t[n++];r.setAttribute(e,s,a,o)}else{const o=i,s=t[++n];KR(o)?r.setProperty(e,o,s):r.setAttribute(e,o,s),n++}}return n}function YR(r){return 3===r||4===r||6===r}function KR(r){return 64===r.charCodeAt(0)}function zu(r,e){if(null!==e&&0!==e.length)if(null===r||0===r.length)r=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){const i=e[n];"number"==typeof i?t=i:0===t||XR(r,t,i,null,-1===t||2===t?e[++n]:null)}}return r}function XR(r,e,t,n,i){let o=0,s=r.length;if(-1===e)s=-1;else for(;o<r.length;){const a=r[o++];if("number"==typeof a){if(a===e){s=-1;break}if(a>e){s=o-1;break}}}for(;o<r.length;){const a=r[o];if("number"==typeof a)break;if(a===t){if(null===n)return void(null!==i&&(r[o+1]=i));if(n===r[o+1])return void(r[o+2]=i)}o++,null!==n&&o++,null!==i&&o++}-1!==s&&(r.splice(s,0,e),o=s+1),r.splice(o++,0,t),null!==n&&r.splice(o++,0,n),null!==i&&r.splice(o++,0,i)}const QR="ng-template";function oae(r,e,t){let n=0,i=!0;for(;n<r.length;){let o=r[n++];if("string"==typeof o&&i){const s=r[n++];if(t&&"class"===o&&-1!==ZR(s.toLowerCase(),e,0))return!0}else{if(1===o){for(;n<r.length&&"string"==typeof(o=r[n++]);)if(o.toLowerCase()===e)return!0;return!1}"number"==typeof o&&(i=!1)}}return!1}function JR(r){return 4===r.type&&r.value!==QR}function sae(r,e,t){return e===(4!==r.type||t?r.value:QR)}function aae(r,e,t){let n=4;const i=r.attrs||[],o=function uae(r){for(let e=0;e<r.length;e++)if(YR(r[e]))return e;return r.length}(i);let s=!1;for(let a=0;a<e.length;a++){const c=e[a];if("number"!=typeof c){if(!s)if(4&n){if(n=2|1&n,""!==c&&!sae(r,c,t)||""===c&&1===e.length){if(va(n))return!1;s=!0}}else{const l=8&n?c:e[++a];if(8&n&&null!==r.attrs){if(!oae(r.attrs,l,t)){if(va(n))return!1;s=!0}continue}const f=cae(8&n?"class":c,i,JR(r),t);if(-1===f){if(va(n))return!1;s=!0;continue}if(""!==l){let g;g=f>o?"":i[f+1].toLowerCase();const y=8&n?g:null;if(y&&-1!==ZR(y,l,0)||2&n&&l!==g){if(va(n))return!1;s=!0}}}}else{if(!s&&!va(n)&&!va(c))return!1;if(s&&va(c))continue;s=!1,n=c|1&n}}return va(n)||s}function va(r){return 0==(1&r)}function cae(r,e,t,n){if(null===e)return-1;let i=0;if(n||!t){let o=!1;for(;i<e.length;){const s=e[i];if(s===r)return i;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===s)break;if(0===s){i+=4;continue}}i+=o?1:2}return-1}return function fae(r,e){let t=r.indexOf(4);if(t>-1)for(t++;t<r.length;){const n=r[t];if("number"==typeof n)return-1;if(n===e)return t;t++}return-1}(e,r)}function ex(r,e,t=!1){for(let n=0;n<e.length;n++)if(aae(r,e[n],t))return!0;return!1}function dae(r,e){e:for(let t=0;t<e.length;t++){const n=e[t];if(r.length===n.length){for(let i=0;i<r.length;i++)if(r[i]!==n[i])continue e;return!0}}return!1}function tx(r,e){return r?":not("+e.trim()+")":e}function hae(r){let e=r[0],t=1,n=2,i="",o=!1;for(;t<r.length;){let s=r[t];if("string"==typeof s)if(2&n){const a=r[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&n?i+="."+s:4&n&&(i+=" "+s);else""!==i&&!va(s)&&(e+=tx(o,i),i=""),n=s,o=o||!va(n);t++}return""!==i&&(e+=tx(o,i)),e}function $e(r){return _3(()=>{const e=rx(r),t={...e,decls:r.decls,vars:r.vars,template:r.template,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,onPush:r.changeDetection===ih.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&r.dependencies||null,getStandaloneInjector:null,signals:r.signals??!1,data:r.data||{},encapsulation:r.encapsulation||Ca.Emulated,styles:r.styles||Kn,_:null,schemas:r.schemas||null,tView:null,id:""};ix(t);const n=r.dependencies;return t.directiveDefs=oh(n,!1),t.pipeDefs=oh(n,!0),t.id=function vae(r){let e=0;const t=[r.selectors,r.ngContentSelectors,r.hostVars,r.hostAttrs,r.consts,r.vars,r.decls,r.encapsulation,r.standalone,r.signals,r.exportAs,JSON.stringify(r.inputs),JSON.stringify(r.outputs),Object.getOwnPropertyNames(r.type.prototype),!!r.contentQueries,!!r.viewQuery].join("|");for(const i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function mae(r){return pn(r)||mi(r)}function _ae(r){return null!==r}function N2(r){return _3(()=>({type:r.type,bootstrap:r.bootstrap||Kn,declarations:r.declarations||Kn,imports:r.imports||Kn,exports:r.exports||Kn,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null}))}function nx(r,e){if(null==r)return tc;const t={};for(const n in r)if(r.hasOwnProperty(n)){const i=r[n];let o,s,a=Z1.None;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o):(o=i,s=i),e?(t[o]=a!==Z1.None?[n,a]:n,e[o]=s):t[o]=n}return t}function Dt(r){return _3(()=>{const e=rx(r);return ix(e),e})}function I2(r){return{type:r.type,name:r.name,factory:null,pure:!1!==r.pure,standalone:!0===r.standalone,onDestroy:r.type.prototype.ngOnDestroy||null}}function pn(r){return r[ku]||null}function mi(r){return r[Yv]||null}function a2(r){return r[Kv]||null}function k2(r,e){const t=r[HR]||null;if(!t&&!0===e)throw new Error(`Type ${pi(r)} does not have '\u0275mod' property.`);return t}function rx(r){const e={};return{type:r.type,providersResolver:null,factory:null,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:r.inputs||tc,exportAs:r.exportAs||null,standalone:!0===r.standalone,signals:!0===r.signals,selectors:r.selectors||Kn,viewQuery:r.viewQuery||null,features:r.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:nx(r.inputs,e),outputs:nx(r.outputs),debugInfo:null}}function ix(r){r.features?.forEach(e=>e(r))}function oh(r,e){if(!r)return null;const t=e?a2:mae;return()=>("function"==typeof r?r():r).map(n=>t(n)).filter(_ae)}const Sr=0,He=1,bt=2,zr=3,ya=4,R2=5,Ma=6,A0=7,x1=8,ro=9,nc=10,en=11,Du=12,ox=13,b0=14,mr=15,Vu=16,w0=17,rc=18,Hu=19,sx=20,M4=21,sh=22,Gl=23,Qt=25,ay=1,ic=7,N0=9,Dr=10;var cy=function(r){return r[r.None=0]="None",r[r.HasTransplantedViews=2]="HasTransplantedViews",r}(cy||{});function x2(r){return Array.isArray(r)&&"object"==typeof r[ay]}function L2(r){return Array.isArray(r)&&!0===r[ay]}function ly(r){return 0!=(4&r.flags)}function Bl(r){return r.componentOffset>-1}function ch(r){return 1==(1&r.flags)}function Ea(r){return!!r.template}function uy(r){return 0!=(512&r[bt])}function Wl(r,e){return r.hasOwnProperty(m3)?r[m3]:null}class Pae{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function ux(r,e,t,n){null!==e?e.applyValueToInputSignal(e,n):r[t]=n}function c2(){return fx}function fx(r){return r.type.prototype.ngOnChanges&&(r.setInput=Oae),Sae}function Sae(){const r=hx(this),e=r?.current;if(e){const t=r.previous;if(t===tc)r.previous=e;else for(let n in e)t[n]=e[n];r.current=null,this.ngOnChanges(e)}}function Oae(r,e,t,n,i){const o=this.declaredInputs[n],s=hx(r)||function Tae(r,e){return r[dx]=e}(r,{previous:tc,current:null}),a=s.current||(s.current={}),c=s.previous,l=c[o];a[o]=new Pae(l&&l.currentValue,t,c===tc),ux(r,e,i,t)}c2.ngInherit=!0;const dx="__ngSimpleChanges__";function hx(r){return r[dx]||null}const oc=function(r,e,t){},gx="svg";let mx=!1;function L1(r){for(;Array.isArray(r);)r=r[Sr];return r}function Uu(r,e){return L1(e[r])}function io(r,e){return L1(e[r.index])}function $u(r,e){return r.data[e]}function I0(r,e){return r[e]}function Xo(r,e){const t=e[r];return x2(t)?t:t[Sr]}function py(r){return 128==(128&r[bt])}function sc(r,e){return null==e?null:r[e]}function _x(r){r[w0]=0}function kae(r){1024&r[bt]||(r[bt]|=1024,py(r)&&Gu(r))}function vx(r){return 9216&r[bt]||r[Gl]?.dirty}function my(r){vx(r)?Gu(r):64&r[bt]&&(function bae(){return mx}()?(r[bt]|=1024,Gu(r)):r[nc].changeDetectionScheduler?.notify())}function Gu(r){r[nc].changeDetectionScheduler?.notify();let e=ql(r);for(;null!==e&&!(8192&e[bt])&&(e[bt]|=8192,py(e));)e=ql(e)}function lh(r,e){if(256==(256&r[bt]))throw new ge(911,!1);null===r[M4]&&(r[M4]=[]),r[M4].push(e)}function ql(r){const e=r[zr];return L2(e)?e[zr]:e}const Bt={lFrame:wx(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Mx(){return Bt.bindingsEnabled}function k0(){return null!==Bt.skipHydrationRootTNode}function ye(){return Bt.lFrame.lView}function Vn(){return Bt.lFrame.tView}function te(r){return Bt.lFrame.contextLView=r,r[x1]}function ne(r){return Bt.lFrame.contextLView=null,r}function _1(){let r=Ex();for(;null!==r&&64===r.type;)r=r.parent;return r}function Ex(){return Bt.lFrame.currentTNode}function Bu(){const r=Bt.lFrame,e=r.currentTNode;return r.isParent?e:e.parent}function ac(r,e){const t=Bt.lFrame;t.currentTNode=r,t.isParent=e}function Cy(){return Bt.lFrame.isParent}function vy(){Bt.lFrame.isParent=!1}function oo(){const r=Bt.lFrame;let e=r.bindingRootIndex;return-1===e&&(e=r.bindingRootIndex=r.tView.bindingStartIndex),e}function C3(){return Bt.lFrame.bindingIndex}function cc(){return Bt.lFrame.bindingIndex++}function v3(r){const e=Bt.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+r,t}function Ox(r){Bt.lFrame.inI18n=r}function Gae(r,e){const t=Bt.lFrame;t.bindingIndex=t.bindingRootIndex=r,yy(e)}function yy(r){Bt.lFrame.currentDirectiveIndex=r}function Tx(){return Bt.lFrame.currentQueryIndex}function Ey(r){Bt.lFrame.currentQueryIndex=r}function Wae(r){const e=r[He];return 2===e.type?e.declTNode:1===e.type?r[R2]:null}function Ax(r,e,t){if(t&Mn.SkipSelf){let i=e,o=r;for(;!(i=i.parent,null!==i||t&Mn.Host||(i=Wae(o),null===i||(o=o[b0],10&i.type))););if(null===i)return!1;e=i,r=o}const n=Bt.lFrame=bx();return n.currentTNode=e,n.lView=r,!0}function Py(r){const e=bx(),t=r[He];Bt.lFrame=e,e.currentTNode=t.firstChild,e.lView=r,e.tView=t,e.contextLView=r,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function bx(){const r=Bt.lFrame,e=null===r?null:r.child;return null===e?wx(r):e}function wx(r){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return null!==r&&(r.child=e),e}function Nx(){const r=Bt.lFrame;return Bt.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}const Ix=Nx;function Sy(){const r=Nx();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function z2(){return Bt.lFrame.selectedIndex}function jl(r){Bt.lFrame.selectedIndex=r}function Y1(){const r=Bt.lFrame;return $u(r.tView,r.selectedIndex)}function N(){Bt.lFrame.currentNamespace=gx}let Rx=!0;function uh(){return Rx}function E4(r){Rx=r}function fh(r,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){const o=r.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=o;s&&(r.contentHooks??=[]).push(-t,s),a&&((r.contentHooks??=[]).push(t,a),(r.contentCheckHooks??=[]).push(t,a)),c&&(r.viewHooks??=[]).push(-t,c),l&&((r.viewHooks??=[]).push(t,l),(r.viewCheckHooks??=[]).push(t,l)),null!=u&&(r.destroyHooks??=[]).push(t,u)}}function dh(r,e,t){xx(r,e,3,t)}function hh(r,e,t,n){(3&r[bt])===t&&xx(r,e,t,n)}function Oy(r,e){let t=r[bt];(3&t)===e&&(t&=16383,t+=1,r[bt]=t)}function xx(r,e,t,n){const o=n??-1,s=e.length-1;let a=0;for(let c=void 0!==n?65535&r[w0]:0;c<s;c++)if("number"==typeof e[c+1]){if(a=e[c],null!=n&&a>=n)break}else e[c]<0&&(r[w0]+=65536),(a<o||-1==o)&&(Xae(r,t,e,c),r[w0]=(4294901760&r[w0])+c+2),c++}function Lx(r,e){oc(4,r,e);const t=j1(null);try{e.call(r)}finally{j1(t),oc(5,r,e)}}function Xae(r,e,t,n){const i=t[n]<0,o=t[n+1],a=r[i?-t[n]:t[n]];i?r[bt]>>14<r[w0]>>16&&(3&r[bt])===e&&(r[bt]+=16384,Lx(a,o)):Lx(a,o)}const R0=-1;class Wu{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function Ay(r){return r!==R0}function qu(r){return 32767&r}function ju(r,e){let t=function nce(r){return r>>16}(r),n=e;for(;t>0;)n=n[b0],t--;return n}let by=!0;function gh(r){const e=by;return by=r,e}const zx=255,Dx=5;let rce=0;const lc={};function ph(r,e){const t=Vx(r,e);if(-1!==t)return t;const n=e[He];n.firstCreatePass&&(r.injectorIndex=e.length,wy(n.data,r),wy(e,null),wy(n.blueprint,null));const i=mh(r,e),o=r.injectorIndex;if(Ay(i)){const s=qu(i),a=ju(i,e),c=a[He].data;for(let l=0;l<8;l++)e[o+l]=a[s+l]|c[s+l]}return e[o+8]=i,o}function wy(r,e){r.push(0,0,0,0,0,0,0,0,e)}function Vx(r,e){return-1===r.injectorIndex||r.parent&&r.parent.injectorIndex===r.injectorIndex||null===e[r.injectorIndex+8]?-1:r.injectorIndex}function mh(r,e){if(r.parent&&-1!==r.parent.injectorIndex)return r.parent.injectorIndex;let t=0,n=null,i=e;for(;null!==i;){if(n=Wx(i),null===n)return R0;if(t++,i=i[b0],-1!==n.injectorIndex)return n.injectorIndex|t<<16}return R0}function Ny(r,e,t){!function ice(r,e,t){let n;"string"==typeof t?n=t.charCodeAt(0)||0:t.hasOwnProperty(Ru)&&(n=t[Ru]),null==n&&(n=t[Ru]=rce++);const i=n&zx;e.data[r+(i>>Dx)]|=1<<i}(r,e,t)}function Hx(r,e,t){if(t&Mn.Optional||void 0!==r)return r;Xv()}function Fx(r,e,t,n){if(t&Mn.Optional&&void 0===n&&(n=null),!(t&(Mn.Self|Mn.Host))){const i=r[ro],o=To(void 0);try{return i?i.get(e,n,t&Mn.Optional):BR(e,n,t&Mn.Optional)}finally{To(o)}}return Hx(n,0,t)}function Ux(r,e,t,n=Mn.Default,i){if(null!==r){if(2048&e[bt]&&!(n&Mn.Self)){const s=function lce(r,e,t,n,i){let o=r,s=e;for(;null!==o&&null!==s&&2048&s[bt]&&!(512&s[bt]);){const a=$x(o,s,t,n|Mn.Self,lc);if(a!==lc)return a;let c=o.parent;if(!c){const l=s[sx];if(l){const u=l.get(t,lc,n);if(u!==lc)return u}c=Wx(s),s=s[b0]}o=c}return i}(r,e,t,n,lc);if(s!==lc)return s}const o=$x(r,e,t,n,lc);if(o!==lc)return o}return Fx(e,t,n,i)}function $x(r,e,t,n,i){const o=function ace(r){if("string"==typeof r)return r.charCodeAt(0)||0;const e=r.hasOwnProperty(Ru)?r[Ru]:void 0;return"number"==typeof e?e>=0?e&zx:cce:e}(t);if("function"==typeof o){if(!Ax(e,r,n))return n&Mn.Host?Hx(i,0,n):Fx(e,t,n,i);try{let s;if(s=o(n),null!=s||n&Mn.Optional)return s;Xv()}finally{Ix()}}else if("number"==typeof o){let s=null,a=Vx(r,e),c=R0,l=n&Mn.Host?e[mr][R2]:null;for((-1===a||n&Mn.SkipSelf)&&(c=-1===a?mh(r,e):e[a+8],c!==R0&&Bx(n,!1)?(s=e[He],a=qu(c),e=ju(c,e)):a=-1);-1!==a;){const u=e[He];if(Gx(o,a,u.data)){const f=sce(a,e,t,s,n,l);if(f!==lc)return f}c=e[a+8],c!==R0&&Bx(n,e[He].data[a+8]===l)&&Gx(o,a,e)?(s=u,a=qu(c),e=ju(c,e)):a=-1}}return i}function sce(r,e,t,n,i,o){const s=e[He],a=s.data[r+8],u=_h(a,s,t,null==n?Bl(a)&&by:n!=s&&0!=(3&a.type),i&Mn.Host&&o===a);return null!==u?Zl(e,s,u,a):lc}function _h(r,e,t,n,i){const o=r.providerIndexes,s=e.data,a=1048575&o,c=r.directiveStart,u=o>>20,g=i?a+u:r.directiveEnd;for(let y=n?a:a+u;y<g;y++){const S=s[y];if(y<c&&t===S||y>=c&&S.type===t)return y}if(i){const y=s[c];if(y&&Ea(y)&&y.type===t)return c}return null}function Zl(r,e,t,n){let i=r[t];const o=e.data;if(function Qae(r){return r instanceof Wu}(i)){const s=i;s.resolving&&function $se(r,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${r}`:"";throw new ge(-200,`Circular dependency in DI detected for ${r}${t}`)}(function Jn(r){return"function"==typeof r?r.name||r.toString():"object"==typeof r&&null!=r&&"function"==typeof r.type?r.type.name||r.type.toString():Xt(r)}(o[t]));const a=gh(s.canSeeViewProviders);s.resolving=!0;const l=s.injectImpl?To(s.injectImpl):null;Ax(r,n,Mn.Default);try{i=r[t]=s.factory(void 0,o,r,n),e.firstCreatePass&&t>=n.directiveStart&&function Kae(r,e,t){const{ngOnChanges:n,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(n){const s=fx(e);(t.preOrderHooks??=[]).push(r,s),(t.preOrderCheckHooks??=[]).push(r,s)}i&&(t.preOrderHooks??=[]).push(0-r,i),o&&((t.preOrderHooks??=[]).push(r,o),(t.preOrderCheckHooks??=[]).push(r,o))}(t,o[t],e)}finally{null!==l&&To(l),gh(a),s.resolving=!1,Ix()}}return i}function Gx(r,e,t){return!!(t[e+(r>>Dx)]&1<<r)}function Bx(r,e){return!(r&Mn.Self||r&Mn.Host&&e)}class _i{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return Ux(this._tNode,this._lView,e,rh(n),t)}}function cce(){return new _i(_1(),ye())}function z1(r){return _3(()=>{const e=r.prototype.constructor,t=e[m3]||Iy(e),n=Object.prototype;let i=Object.getPrototypeOf(r.prototype).constructor;for(;i&&i!==n;){const o=i[m3]||Iy(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function Iy(r){return Qd(r)?()=>{const e=Iy(Ht(r));return e&&e()}:Wl(r)}function Wx(r){const e=r[He],t=e.type;return 2===t?e.declTNode:1===t?r[R2]:null}const D0="__parameters__";function H0(r,e,t){return _3(()=>{const n=function ky(r){return function(...t){if(r){const n=r(...t);for(const i in n)this[i]=n[i]}}}(e);function i(...o){if(this instanceof i)return n.apply(this,o),this;const s=new i(...o);return a.annotation=s,a;function a(c,l,u){const f=c.hasOwnProperty(D0)?c[D0]:Object.defineProperty(c,D0,{value:[]})[D0];for(;f.length<=u;)f.push(null);return(f[u]=f[u]||[]).push(s),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=r,i.annotationCls=i,i})}function U0(r,e){r.forEach(t=>Array.isArray(t)?U0(t,e):e(t))}function jx(r,e,t){e>=r.length?r.push(t):r.splice(e,0,t)}function vh(r,e){return e>=r.length-1?r.pop():r.splice(e,1)[0]}function Qo(r,e,t){let n=$0(r,e);return n>=0?r[1|n]=t:(n=~n,function Zx(r,e,t,n){let i=r.length;if(i==e)r.push(t,n);else if(1===i)r.push(n,r[0]),r[0]=t;else{for(i--,r.push(r[i-1],r[i]);i>e;)r[i]=r[i-2],i--;r[e]=t,r[e+1]=n}}(r,n,e,t)),n}function xy(r,e){const t=$0(r,e);if(t>=0)return r[1|t]}function $0(r,e){return function Yx(r,e,t){let n=0,i=r.length>>t;for(;i!==n;){const o=n+(i-n>>1),s=r[o<<t];if(e===s)return o<<t;s>e?i=o:n=o+1}return~(i<<t)}(r,e,1)}const Jo=Lu(H0("Optional"),8),Eh=Lu(H0("SkipSelf"),4),Yl=new Qe("ENVIRONMENT_INITIALIZER"),Jx=new Qe("INJECTOR",-1),Dy=new Qe("INJECTOR_DEF_TYPES");class Sh{get(e,t=xu){if(t===xu){const n=new Error(`NullInjectorError: No provider for ${pi(e)}!`);throw n.name="NullInjectorError",n}return t}}function Ice(...r){return{\u0275providers:eL(0,r),\u0275fromNgModule:!0}}function eL(r,...e){const t=[],n=new Set;let i;const o=s=>{t.push(s)};return U0(e,s=>{const a=s;Th(a,o,[],n)&&(i||=[],i.push(a))}),void 0!==i&&tL(i,o),t}function tL(r,e){for(let t=0;t<r.length;t++){const{ngModule:n,providers:i}=r[t];Vy(i,o=>{e(o,n)})}}function Th(r,e,t,n){if(!(r=Ht(r)))return!1;let i=null,o=eh(r);const s=!o&&pn(r);if(o||s){if(s&&!s.standalone)return!1;i=r}else{const c=r.ngModule;if(o=eh(c),!o)return!1;i=c}const a=n.has(i);if(s){if(a)return!1;if(n.add(i),s.dependencies){const c="function"==typeof s.dependencies?s.dependencies():s.dependencies;for(const l of c)Th(l,e,t,n)}}else{if(!o)return!1;{if(null!=o.imports&&!a){let l;n.add(i);try{U0(o.imports,u=>{Th(u,e,t,n)&&(l||=[],l.push(u))})}finally{}void 0!==l&&tL(l,e)}if(!a){const l=Wl(i)||(()=>new i);e({provide:i,useFactory:l,deps:Kn},i),e({provide:Dy,useValue:i,multi:!0},i),e({provide:Yl,useValue:()=>Ae(i),multi:!0},i)}const c=o.providers;if(null!=c&&!a){const l=r;Vy(c,u=>{e(u,l)})}}}return i!==r&&void 0!==r.providers}function Vy(r,e){for(let t of r)Zv(t)&&(t=t.\u0275providers),Array.isArray(t)?Vy(t,e):e(t)}const kce=c1({provide:String,useValue:c1});function Hy(r){return null!==r&&"object"==typeof r&&kce in r}function Kl(r){return"function"==typeof r}const Fy=new Qe("Set Injector scope."),Ah={},xce={};let Uy;function bh(){return void 0===Uy&&(Uy=new Sh),Uy}class es{}class B0 extends es{get destroyed(){return this._destroyed}constructor(e,t,n,i){super(),this.parent=t,this.source=n,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Gy(e,s=>this.processProvider(s)),this.records.set(Jx,W0(void 0,this)),i.has("environment")&&this.records.set(es,W0(void 0,this));const o=this.records.get(Fy);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(Dy,Kn,Mn.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=v4(this),n=To(void 0);try{return e()}finally{v4(t),To(n)}}get(e,t=xu,n=Mn.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(FR))return e[FR](this);n=rh(n);const o=v4(this),s=To(void 0);try{if(!(n&Mn.SkipSelf)){let c=this.records.get(e);if(void 0===c){const l=function Hce(r){return"function"==typeof r||"object"==typeof r&&r instanceof Qe}(e)&&Jd(e);c=l&&this.injectableDefInScope(l)?W0($y(e),Ah):null,this.records.set(e,c)}if(null!=c)return this.hydrate(e,c)}return(n&Mn.Self?bh():this.parent).get(e,t=n&Mn.Optional&&t===xu?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[nh]=a[nh]||[]).unshift(pi(e)),o)throw a;return function rae(r,e,t,n){const i=r[nh];throw e[qR]&&i.unshift(e[qR]),r.message=function iae(r,e,t,n=null){r=r&&"\n"===r.charAt(0)&&"\u0275"==r.charAt(1)?r.slice(2):r;let i=pi(e);if(Array.isArray(e))i=e.map(pi).join(" -> ");else if("object"==typeof e){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):pi(a)))}i=`{${o.join(", ")}}`}return`${t}${n?"("+n+")":""}[${i}]: ${r.replace(Qse,"\n  ")}`}("\n"+r.message,i,t,n),r.ngTokenPath=i,r[nh]=null,r}(a,e,"R3InjectorError",this.source)}throw a}finally{To(s),v4(o)}}resolveInjectorInitializers(){const e=v4(this),t=To(void 0);try{const i=this.get(Yl,Kn,Mn.Self);for(const o of i)o()}finally{v4(e),To(t)}}toString(){const e=[],t=this.records;for(const n of t.keys())e.push(pi(n));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ge(205,!1)}processProvider(e){let t=Kl(e=Ht(e))?e:Ht(e&&e.provide);const n=function zce(r){return Hy(r)?W0(void 0,r.useValue):W0(iL(r),Ah)}(e);if(!Kl(e)&&!0===e.multi){let i=this.records.get(t);i||(i=W0(void 0,Ah,!0),i.factory=()=>oy(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,n)}hydrate(e,t){return t.value===Ah&&(t.value=xce,t.value=t.factory()),"object"==typeof t.value&&t.value&&function Vce(r){return null!==r&&"object"==typeof r&&"function"==typeof r.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Ht(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function $y(r){const e=Jd(r),t=null!==e?e.factory:Wl(r);if(null!==t)return t;if(r instanceof Qe)throw new ge(204,!1);if(r instanceof Function)return function Lce(r){if(r.length>0)throw new ge(204,!1);const t=function Zse(r){return r&&(r[th]||r[$R])||null}(r);return null!==t?()=>t.factory(r):()=>new r}(r);throw new ge(204,!1)}function iL(r,e,t){let n;if(Kl(r)){const i=Ht(r);return Wl(i)||$y(i)}if(Hy(r))n=()=>Ht(r.useValue);else if(function rL(r){return!(!r||!r.useFactory)}(r))n=()=>r.useFactory(...oy(r.deps||[]));else if(function nL(r){return!(!r||!r.useExisting)}(r))n=()=>Ae(Ht(r.useExisting));else{const i=Ht(r&&(r.useClass||r.provide));if(!function Dce(r){return!!r.deps}(r))return Wl(i)||$y(i);n=()=>new i(...oy(r.deps))}return n}function W0(r,e,t=!1){return{factory:r,value:e,multi:t?[]:void 0}}function Gy(r,e){for(const t of r)Array.isArray(t)?Gy(t,e):t&&Zv(t)?Gy(t.\u0275providers,e):e(t)}function P4(r,e){r instanceof B0&&r.assertNotDestroyed();const n=v4(r),i=To(void 0);try{return e()}finally{v4(n),To(i)}}function cL(r,e=null,t=null,n){const i=lL(r,e,t,n);return i.resolveInjectorInitializers(),i}function lL(r,e=null,t=null,n,i=new Set){const o=[t||Kn,Ice(r)];return n=n||("object"==typeof r?void 0:pi(r)),new B0(o,e||bh(),n||null,i)}let qy,Li=(()=>{class r{static#e=this.THROW_IF_NOT_FOUND=xu;static#t=this.NULL=new Sh;static create(t,n){if(Array.isArray(t))return cL({name:""},n,t,"");{const i=t.name??"";return cL({name:i},t.parent,t.providers,i)}}static#n=this.\u0275prov=xe({token:r,providedIn:"any",factory:()=>Ae(Jx)});static#r=this.__NG_ELEMENT_ID__=-1}return r})();function O4(){if(void 0!==qy)return qy;if(typeof document<"u")return document;throw new ge(210,!1)}const Nh=new Qe("AppId",{providedIn:"root",factory:()=>Zce}),Zce="ng",fL=new Qe("Platform Initializer"),y3=new Qe("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),dL=new Qe("AnimationModuleType"),hL=new Qe("CSP nonce",{providedIn:"root",factory:()=>O4().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function ts(r){return r instanceof Function?r():r}function xh(r){return 128==(128&r.flags)}var b4=function(r){return r[r.Important=1]="Important",r[r.DashCase=2]="DashCase",r}(b4||{});const i3e=/^>|^->|<!--|-->|--!>|<!-$/g,o3e=/(<|>)/g,s3e="\u200b$1\u200b";const Xy=new Map;let a3e=0;const Jy="__ngContext__";function D2(r,e){x2(e)?(r[Jy]=e[Hu],function l3e(r){Xy.set(r[Hu],r)}(e)):r[Jy]=e}let eM;function tM(r,e){return eM(r,e)}function j0(r,e,t,n,i){if(null!=n){let o,s=!1;L2(n)?o=n:x2(n)&&(s=!0,n=n[Sr]);const a=L1(n);0===r&&null!==t?null==i?LL(e,t,a):Xl(e,t,a,i||null,!0):1===r&&null!==t?Xl(e,t,a,i||null,!0):2===r?Uh(e,a,s):3===r&&e.destroyNode(a),null!=o&&function b3e(r,e,t,n,i){const o=t[ic];o!==L1(t)&&j0(e,r,n,o,i);for(let a=Dr;a<t.length;a++){const c=t[a];$h(c[He],c,r,e,n,o)}}(e,r,o,t,i)}}function zh(r,e){return r.createText(e)}function IL(r,e,t){r.setValue(e,t)}function nM(r,e){return r.createComment(function PL(r){return r.replace(i3e,e=>e.replace(o3e,s3e))}(e))}function Dh(r,e,t){return r.createElement(e,t)}function kL(r,e){e[nc].changeDetectionScheduler?.notify(),$h(r,e,e[en],2,null,null)}function RL(r,e){const t=r[N0],n=t.indexOf(e);t.splice(n,1)}function e7(r,e){if(r.length<=Dr)return;const t=Dr+e,n=r[t];if(n){const i=n[Vu];null!==i&&i!==r&&RL(i,n),e>0&&(r[t-1][ya]=n[ya]);const o=vh(r,Dr+e);!function C3e(r,e){kL(r,e),e[Sr]=null,e[R2]=null}(n[He],n);const s=o[rc];null!==s&&s.detachView(o[He]),n[zr]=null,n[ya]=null,n[bt]&=-129}return n}function Vh(r,e){if(!(256&e[bt])){const t=e[en];t.destroyNode&&$h(r,e,t,3,null,null),function y3e(r){let e=r[Du];if(!e)return rM(r[He],r);for(;e;){let t=null;if(x2(e))t=e[Du];else{const n=e[Dr];n&&(t=n)}if(!t){for(;e&&!e[ya]&&e!==r;)x2(e)&&rM(e[He],e),e=e[zr];null===e&&(e=r),x2(e)&&rM(e[He],e),t=e&&e[ya]}e=t}}(e)}}function rM(r,e){if(!(256&e[bt])){e[bt]&=-129,e[bt]|=256,e[Gl]&&function Gt(r){if(n2(r),Rs(r))for(let e=0;e<r.producerNode.length;e++)N1(r.producerNode[e],r.producerIndexOfThis[e]);r.producerNode.length=r.producerLastReadVersion.length=r.producerIndexOfThis.length=0,r.liveConsumerNode&&(r.liveConsumerNode.length=r.liveConsumerIndexOfThis.length=0)}(e[Gl]),function S3e(r,e){let t;if(null!=r&&null!=(t=r.destroyHooks))for(let n=0;n<t.length;n+=2){const i=e[t[n]];if(!(i instanceof Wu)){const o=t[n+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=i[o[s]],c=o[s+1];oc(4,a,c);try{c.call(a)}finally{oc(5,a,c)}}else{oc(4,i,o);try{o.call(i)}finally{oc(5,i,o)}}}}}(r,e),function P3e(r,e){const t=r.cleanup,n=e[A0];if(null!==t)for(let o=0;o<t.length-1;o+=2)if("string"==typeof t[o]){const s=t[o+3];s>=0?n[s]():n[-s].unsubscribe(),o+=2}else t[o].call(n[t[o+1]]);null!==n&&(e[A0]=null);const i=e[M4];if(null!==i){e[M4]=null;for(let o=0;o<i.length;o++)(0,i[o])()}}(r,e),1===e[He].type&&e[en].destroy();const t=e[Vu];if(null!==t&&L2(e[zr])){t!==e[zr]&&RL(t,e);const n=e[rc];null!==n&&n.detachView(r)}!function u3e(r){Xy.delete(r[Hu])}(e)}}function iM(r,e,t){return xL(r,e.parent,t)}function xL(r,e,t){let n=e;for(;null!==n&&40&n.type;)n=(e=n).parent;if(null===n)return t[Sr];{const{componentOffset:i}=n;if(i>-1){const{encapsulation:o}=r.data[n.directiveStart+i];if(o===Ca.None||o===Ca.Emulated)return null}return io(n,t)}}function Xl(r,e,t,n,i){r.insertBefore(e,t,n,i)}function LL(r,e,t){r.appendChild(e,t)}function zL(r,e,t,n,i){null!==n?Xl(r,e,t,n,i):LL(r,e,t)}function Hh(r,e){return r.parentNode(e)}function DL(r,e,t){return HL(r,e,t)}function VL(r,e,t){return 40&r.type?io(r,t):null}let oM,Gh,Bh,HL=VL;function FL(r,e){HL=r,oM=e}function Fh(r,e,t,n){const i=iM(r,n,e),o=e[en],a=DL(n.parent||e[R2],n,e);if(null!=i)if(Array.isArray(t))for(let c=0;c<t.length;c++)zL(o,i,t[c],a,!1);else zL(o,i,t,a,!1);void 0!==oM&&oM(o,n,e,t,i)}function t7(r,e){if(null!==e){const t=e.type;if(3&t)return io(e,r);if(4&t)return sM(-1,r[e.index]);if(8&t){const n=e.child;if(null!==n)return t7(r,n);{const i=r[e.index];return L2(i)?sM(-1,i):L1(i)}}if(32&t)return tM(e,r)()||L1(r[e.index]);{const n=UL(r,e);return null!==n?Array.isArray(n)?n[0]:t7(ql(r[mr]),n):t7(r,e.next)}}return null}function UL(r,e){return null!==e?r[mr][R2].projection[e.projection]:null}function sM(r,e){const t=Dr+r+1;if(t<e.length){const n=e[t],i=n[He].firstChild;if(null!==i)return t7(n,i)}return e[ic]}function Uh(r,e,t){const n=Hh(r,e);n&&function O3e(r,e,t,n){r.removeChild(e,t,n)}(r,n,e,t)}function aM(r,e,t,n,i,o,s){for(;null!=t;){const a=n[t.index],c=t.type;if(s&&0===e&&(a&&D2(L1(a),n),t.flags|=2),32!=(32&t.flags))if(8&c)aM(r,e,t.child,n,i,o,!1),j0(e,r,i,a,o);else if(32&c){const l=tM(t,n);let u;for(;u=l();)j0(e,r,i,u,o);j0(e,r,i,a,o)}else 16&c?GL(r,e,n,t,i,o):j0(e,r,i,a,o);t=s?t.projectionNext:t.next}}function $h(r,e,t,n,i,o){aM(t,n,r.firstChild,e,i,o,!1)}function GL(r,e,t,n,i,o){const s=t[mr],c=s[R2].projection[n.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)j0(e,r,i,c[l],o);else{let l=c;const u=s[zr];xh(n)&&(l.flags|=128),aM(r,e,l,u,i,o,!0)}}function BL(r,e,t){""===t?r.removeAttribute(e,"class"):r.setAttribute(e,"class",t)}function WL(r,e,t){const{mergedAttrs:n,classes:i,styles:o}=t;null!==n&&sy(r,e,n),null!==i&&BL(r,e,i),null!==o&&function N3e(r,e,t){r.setAttribute(e,"style",t)}(r,e,o)}function Z0(r){return function cM(){if(void 0===Gh&&(Gh=null,R1.trustedTypes))try{Gh=R1.trustedTypes.createPolicy("angular",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return Gh}()?.createHTML(r)||r}function lM(){if(void 0===Bh&&(Bh=null,R1.trustedTypes))try{Bh=R1.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return Bh}function qL(r){return lM()?.createHTML(r)||r}function ZL(r){return lM()?.createScriptURL(r)||r}class Ql{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${zR})`}}class x3e extends Ql{getTypeName(){return"HTML"}}class L3e extends Ql{getTypeName(){return"Style"}}class z3e extends Ql{getTypeName(){return"Script"}}class D3e extends Ql{getTypeName(){return"URL"}}class V3e extends Ql{getTypeName(){return"ResourceURL"}}function ns(r){return r instanceof Ql?r.changingThisBreaksApplicationSecurity:r}function uc(r,e){const t=function H3e(r){return r instanceof Ql&&r.getTypeName()||null}(r);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${zR})`)}return t===e}function YL(r){const e=new q3e(r);return function j3e(){try{return!!(new window.DOMParser).parseFromString(Z0(""),"text/html")}catch{return!1}}()?new W3e(e):e}class W3e{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(Z0(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class q3e{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const t=this.inertDocument.createElement("template");return t.innerHTML=Z0(e),t}}const Z3e=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Wh(r){return(r=String(r)).match(Z3e)?r:"unsafe:"+r}function M3(r){const e={};for(const t of r.split(","))e[t]=!0;return e}function n7(...r){const e={};for(const t of r)for(const n in t)t.hasOwnProperty(n)&&(e[n]=!0);return e}const KL=M3("area,br,col,hr,img,wbr"),XL=M3("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),QL=M3("rp,rt"),uM=n7(KL,n7(XL,M3("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),n7(QL,M3("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),n7(QL,XL)),fM=M3("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),JL=n7(fM,M3("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),M3("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Y3e=M3("script,style,template");class K3e{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let i=this.checkClobberedElement(t,t.nextSibling);if(i){t=i;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!uM.hasOwnProperty(t))return this.sanitizedSomething=!0,!Y3e.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const n=e.attributes;for(let i=0;i<n.length;i++){const o=n.item(i),s=o.name,a=s.toLowerCase();if(!JL.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let c=o.value;fM[a]&&(c=Wh(c)),this.buf.push(" ",s,'="',ez(c),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();uM.hasOwnProperty(t)&&!KL.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(ez(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const X3e=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Q3e=/([^\#-~ |!])/g;function ez(r){return r.replace(/&/g,"&amp;").replace(X3e,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(Q3e,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let qh;function tz(r,e){let t=null;try{qh=qh||YL(r);let n=e?String(e):"";t=qh.getInertBodyElement(n);let i=5,o=n;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,n=o,o=t.innerHTML,t=qh.getInertBodyElement(n)}while(n!==o);return Z0((new K3e).sanitizeChildren(dM(t)||t))}finally{if(t){const n=dM(t)||t;for(;n.firstChild;)n.removeChild(n.firstChild)}}}function dM(r){return"content"in r&&function J3e(r){return r.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===r.nodeName}(r)?r.content:null}var Ls=function(r){return r[r.NONE=0]="NONE",r[r.HTML=1]="HTML",r[r.STYLE=2]="STYLE",r[r.SCRIPT=3]="SCRIPT",r[r.URL=4]="URL",r[r.RESOURCE_URL=5]="RESOURCE_URL",r}(Ls||{});function r7(r){const e=i7();return e?qL(e.sanitize(Ls.HTML,r)||""):uc(r,"HTML")?qL(ns(r)):tz(O4(),Xt(r))}function jh(r){const e=i7();return e?e.sanitize(Ls.URL,r)||"":uc(r,"URL")?ns(r):Wh(Xt(r))}function nz(r){const e=i7();if(e)return ZL(e.sanitize(Ls.RESOURCE_URL,r)||"");if(uc(r,"ResourceURL"))return ZL(ns(r));throw new ge(904,!1)}function i7(){const r=ye();return r&&r[nc].sanitizer}class iz{}let oz=()=>null;function yM(r,e,t=!1){return oz(r,e,t)}class h4e{}class cz{}class p4e{resolveComponentFactory(e){throw function g4e(r){const e=Error(`No component factory found for ${pi(r)}.`);return e.ngComponent=r,e}(e)}}let Jh=(()=>{class r{static#e=this.NULL=new p4e}return r})();function m4e(){return X0(_1(),ye())}function X0(r,e){return new V2(io(r,e))}let V2=(()=>{class r{constructor(t){this.nativeElement=t}static#e=this.__NG_ELEMENT_ID__=m4e}return r})();function _4e(r){return r instanceof V2?r.nativeElement:r}class PM{}let fc=(()=>{class r{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function C4e(){const r=ye(),t=Xo(_1().index,r);return(x2(t)?t:r)[en]}()}return r})(),v4e=(()=>{class r{static#e=this.\u0275prov=xe({token:r,providedIn:"root",factory:()=>null})}return r})();const SM={};function eg(r){return!!function OM(r){return null!==r&&("function"==typeof r||"object"==typeof r)}(r)&&(Array.isArray(r)||!(r instanceof Map)&&Symbol.iterator in r)}class fz{constructor(){}supports(e){return eg(e)}create(e){return new S4e(e)}}const P4e=(r,e)=>e;class S4e{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||P4e}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,i=0,o=null;for(;t||n;){const s=!n||t&&t.currentIndex<hz(n,i,o)?t:n,a=hz(s,i,o),c=s.currentIndex;if(s===n)i--,n=n._nextRemoved;else if(t=t._next,null==s.previousIndex)i++;else{o||(o=[]);const l=a-i,u=c-i;if(l!=u){for(let g=0;g<l;g++){const y=g<o.length?o[g]:o[g]=0,S=y+g;u<=S&&S<l&&(o[g]=y+1)}o[s.previousIndex]=u-l}}a!==c&&e(s,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!eg(e))throw new ge(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let i,o,s,t=this._itHead,n=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),null!==t&&Object.is(t.trackById,s)?(n&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)):(t=this._mismatch(t,o,s,a),n=!0),t=t._next}else i=0,function E4e(r,e){if(Array.isArray(r))for(let t=0;t<r.length;t++)e(r[t]);else{const t=r[Symbol.iterator]();let n;for(;!(n=t.next()).done;)e(n.value)}}(e,a=>{s=this._trackByFn(i,a),null!==t&&Object.is(t.trackById,s)?(n&&(t=this._verifyReinsertion(t,a,s,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,s,i),n=!0),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,i){let o;return null===e?o=this._itTail:(o=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,i))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new O4e(t,n),o,i),e}_verifyReinsertion(e,t,n,i){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==o?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const i=e._prevRemoved,o=e._nextRemoved;return null===i?this._removalsHead=o:i._nextRemoved=o,null===o?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const i=null===t?this._itHead:t._next;return e._next=i,e._prev=t,null===i?this._itTail=e:i._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new dz),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new dz),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class O4e{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class T4e{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class dz{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new T4e,this.map.set(t,n)),n.add(e)}get(e,t){const i=this.map.get(e);return i?i.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function hz(r,e,t){const n=r.previousIndex;if(null===n)return n;let i=0;return t&&n<t.length&&(i=t[n]),n+e+i}function pz(){return new TM([new fz])}let TM=(()=>{class r{static#e=this.\u0275prov=xe({token:r,providedIn:"root",factory:pz});constructor(t){this.factories=t}static create(t,n){if(null!=n){const i=n.factories.slice();t=t.concat(i)}return new r(t)}static extend(t){return{provide:r,useFactory:n=>r.create(t,n||pz()),deps:[[r,new Eh,new Jo]]}}find(t){const n=this.factories.find(i=>i.supports(t));if(null!=n)return n;throw new ge(901,!1)}}return r})();function a7(r,e,t,n,i=!1){for(;null!==t;){const o=e[t.index];null!==o&&n.push(L1(o)),L2(o)&&_z(o,n);const s=t.type;if(8&s)a7(r,e,t.child,n);else if(32&s){const a=tM(t,e);let c;for(;c=a();)n.push(c)}else if(16&s){const a=UL(e,t);if(Array.isArray(a))n.push(...a);else{const c=ql(e[mr]);a7(c[He],c,a,n,!0)}}t=i?t.projectionNext:t.next}return n}function _z(r,e){for(let t=Dr;t<r.length;t++){const n=r[t],i=n[He].firstChild;null!==i&&a7(n[He],n,i,e)}r[ic]!==r[Sr]&&e.push(r[ic])}let Cz=[];const R4e={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{},consumerIsAlwaysLive:!0,consumerMarkedDirty:r=>{Gu(r.lView)},consumerOnSignalRead(){this.lView[Gl]=this}};function vz(r){return Mz(r[Du])}function yz(r){return Mz(r[ya])}function Mz(r){for(;null!==r&&!L2(r);)r=r[ya];return r}function AM(r){return r.ngOriginalError}class E3{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&AM(e);for(;t&&AM(t);)t=AM(t);return t||null}}const Pz=new Qe("",{providedIn:"root",factory:()=>Le(E3).handleError.bind(void 0)}),Oz=new Qe("",{providedIn:"root",factory:()=>!1}),tn={};function m(r=1){wz(Vn(),ye(),z2()+r,!1)}function wz(r,e,t,n){if(!n)if(3==(3&e[bt])){const o=r.preOrderCheckHooks;null!==o&&dh(e,o,t)}else{const o=r.preOrderHooks;null!==o&&hh(e,o,0,t)}jl(t)}function G(r,e=Mn.Default){const t=ye();return null===t?Ae(r,e):Ux(_1(),t,Ht(r),e)}function Iz(r,e,t,n,i,o){const s=j1(null);try{let a=null;i&Z1.SignalBased&&(a=e[n][jo]),null!==a&&void 0!==a.transformFn&&(o=a.transformFn(o)),i&Z1.HasDecoratorInputTransform&&(o=r.inputTransforms[n].call(e,o)),null!==r.setInput?r.setInput(e,a,o,t,n):ux(e,a,n,o)}finally{j1(s)}}function rg(r,e,t,n,i,o,s,a,c,l,u){const f=e.blueprint.slice();return f[Sr]=i,f[bt]=204|n,(null!==l||r&&2048&r[bt])&&(f[bt]|=2048),_x(f),f[zr]=f[b0]=r,f[x1]=t,f[nc]=s||r&&r[nc],f[en]=a||r&&r[en],f[ro]=c||r&&r[ro]||null,f[R2]=o,f[Hu]=function c3e(){return a3e++}(),f[Ma]=u,f[sx]=l,f[mr]=2==e.type?r[mr]:f,f}function Q0(r,e,t,n,i){let o=r.data[e];if(null===o)o=bM(r,e,t,n,i),function $ae(){return Bt.lFrame.inI18n}()&&(o.flags|=32);else if(64&o.type){o.type=t,o.value=n,o.attrs=i;const s=Bu();o.injectorIndex=null===s?-1:s.injectorIndex}return ac(o,!0),o}function bM(r,e,t,n,i){const o=Ex(),s=Cy(),c=r.data[e]=function Z4e(r,e,t,n,i,o){let s=e?e.injectorIndex:-1,a=0;return k0()&&(a|=128),{type:t,index:n,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,t,e,n,i);return null===r.firstChild&&(r.firstChild=c),null!==o&&(s?null==o.child&&null!==c.parent&&(o.child=c):null===o.next&&(o.next=c,c.prev=o)),c}function c7(r,e,t,n){if(0===t)return-1;const i=e.length;for(let o=0;o<t;o++)e.push(n),r.blueprint.push(n),r.data.push(null);return i}function kz(r,e,t,n,i){const o=z2(),s=2&n;try{jl(-1),s&&e.length>Qt&&wz(r,e,Qt,!1),oc(s?2:0,i),t(n,i)}finally{jl(o),oc(s?3:1,i)}}function wM(r,e,t){if(ly(e)){const n=j1(null);try{const o=e.directiveEnd;for(let s=e.directiveStart;s<o;s++){const a=r.data[s];a.contentQueries&&a.contentQueries(1,t[s],s)}}finally{j1(n)}}}function NM(r,e,t){Mx()&&(function tle(r,e,t,n){const i=t.directiveStart,o=t.directiveEnd;Bl(t)&&function cle(r,e,t){const n=io(e,r),i=Rz(t);let s=16;t.signals?s=4096:t.onPush&&(s=64);const a=ig(r,rg(r,i,null,s,n,e,null,r[nc].rendererFactory.createRenderer(n,t),null,null,null));r[e.index]=a}(e,t,r.data[i+t.componentOffset]),r.firstCreatePass||ph(t,e),D2(n,e);const s=t.initialInputs;for(let a=i;a<o;a++){const c=r.data[a],l=Zl(e,r,a,t);D2(l,e),null!==s&&lle(0,a-i,l,c,0,s),Ea(c)&&(Xo(t.index,e)[x1]=Zl(e,r,a,t))}}(r,e,t,io(t,e)),64==(64&t.flags)&&Vz(r,e,t))}function IM(r,e,t=io){const n=e.localNames;if(null!==n){let i=e.index+1;for(let o=0;o<n.length;o+=2){const s=n[o+1],a=-1===s?t(e,r):r[s];r[i++]=a}}}function Rz(r){const e=r.tView;return null===e||e.incompleteFirstPass?r.tView=kM(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts,r.id):e}function kM(r,e,t,n,i,o,s,a,c,l,u){const f=Qt+n,g=f+i,y=function $4e(r,e){const t=[];for(let n=0;n<e;n++)t.push(n<r?null:tn);return t}(f,g),S="function"==typeof l?l():l;return y[He]={type:r,blueprint:y,template:t,queries:null,viewQuery:a,declTNode:e,data:y.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:g,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:c,consts:S,incompleteFirstPass:!1,ssrId:u}}let xz=()=>null;function Lz(r,e,t,n,i){for(let o in e){if(!e.hasOwnProperty(o))continue;const s=e[o];if(void 0===s)continue;n??={};let a,c=Z1.None;Array.isArray(s)?(a=s[0],c=s[1]):a=s;let l=o;if(null!==i){if(!i.hasOwnProperty(o))continue;l=i[o]}0===r?zz(n,t,l,a,c):zz(n,t,l,a)}return n}function zz(r,e,t,n,i){let o;r.hasOwnProperty(t)?(o=r[t]).push(e,n):o=r[t]=[e,n],void 0!==i&&o.push(i)}function rs(r,e,t,n,i,o,s,a){const c=io(e,t);let u,l=e.inputs;!a&&null!=l&&(u=l[n])?(DM(r,t,u,n,i),Bl(e)&&function X4e(r,e){const t=Xo(e,r);16&t[bt]||(t[bt]|=64)}(t,e.index)):3&e.type&&(n=function K4e(r){return"class"===r?"className":"for"===r?"htmlFor":"formaction"===r?"formAction":"innerHtml"===r?"innerHTML":"readonly"===r?"readOnly":"tabindex"===r?"tabIndex":r}(n),i=null!=s?s(i,e.value||"",n):i,o.setProperty(c,n,i))}function RM(r,e,t,n){if(Mx()){const i=null===n?null:{"":-1},o=function rle(r,e){const t=r.directiveRegistry;let n=null,i=null;if(t)for(let o=0;o<t.length;o++){const s=t[o];if(ex(e,s.selectors,!1))if(n||(n=[]),Ea(s))if(null!==s.findHostDirectiveDefs){const a=[];i=i||new Map,s.findHostDirectiveDefs(s,a,i),n.unshift(...a,s),xM(r,e,a.length)}else n.unshift(s),xM(r,e,0);else i=i||new Map,s.findHostDirectiveDefs?.(s,n,i),n.push(s)}return null===n?null:[n,i]}(r,t);let s,a;null===o?s=a=null:[s,a]=o,null!==s&&Dz(r,e,t,s,i,a),i&&function ile(r,e,t){if(e){const n=r.localNames=[];for(let i=0;i<e.length;i+=2){const o=t[e[i+1]];if(null==o)throw new ge(-301,!1);n.push(e[i],o)}}}(t,n,i)}t.mergedAttrs=zu(t.mergedAttrs,t.attrs)}function Dz(r,e,t,n,i,o){for(let l=0;l<n.length;l++)Ny(ph(t,e),r,n[l].type);!function sle(r,e,t){r.flags|=1,r.directiveStart=e,r.directiveEnd=e+t,r.providerIndexes=e}(t,r.data.length,n.length);for(let l=0;l<n.length;l++){const u=n[l];u.providersResolver&&u.providersResolver(u)}let s=!1,a=!1,c=c7(r,e,n.length,null);for(let l=0;l<n.length;l++){const u=n[l];t.mergedAttrs=zu(t.mergedAttrs,u.hostAttrs),ale(r,t,e,c,u),ole(c,u,i),null!==u.contentQueries&&(t.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(t.flags|=64);const f=u.type.prototype;!s&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((r.preOrderHooks??=[]).push(t.index),s=!0),!a&&(f.ngOnChanges||f.ngDoCheck)&&((r.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}!function Y4e(r,e,t){const i=e.directiveEnd,o=r.data,s=e.attrs,a=[];let c=null,l=null;for(let u=e.directiveStart;u<i;u++){const f=o[u],g=t?t.get(f):null,S=g?g.outputs:null;c=Lz(0,f.inputs,u,c,g?g.inputs:null),l=Lz(1,f.outputs,u,l,S);const I=null===c||null===s||JR(e)?null:ule(c,u,s);a.push(I)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}(r,t,o)}function Vz(r,e,t){const n=t.directiveStart,i=t.directiveEnd,o=t.index,s=function Bae(){return Bt.lFrame.currentDirectiveIndex}();try{jl(o);for(let a=n;a<i;a++){const c=r.data[a],l=e[a];yy(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&nle(c,l)}}finally{jl(-1),yy(s)}}function nle(r,e){null!==r.hostBindings&&r.hostBindings(1,e)}function xM(r,e,t){e.componentOffset=t,(r.components??=[]).push(e.index)}function ole(r,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=r;Ea(e)&&(t[""]=r)}}function ale(r,e,t,n,i){r.data[n]=i;const o=i.factory||(i.factory=Wl(i.type)),s=new Wu(o,Ea(i),G);r.blueprint[n]=s,t[n]=s,function J4e(r,e,t,n,i){const o=i.hostBindings;if(o){let s=r.hostBindingOpCodes;null===s&&(s=r.hostBindingOpCodes=[]);const a=~e.index;(function ele(r){let e=r.length;for(;e>0;){const t=r[--e];if("number"==typeof t&&t<0)return t}return 0})(s)!=a&&s.push(a),s.push(t,n,o)}}(r,e,n,c7(r,t,i.hostVars,tn),i)}function LM(r,e,t,n,i,o,s){if(null==o)r.removeAttribute(e,i,t);else{const a=null==s?Xt(o):s(o,n||"",i);r.setAttribute(e,i,a,t)}}function lle(r,e,t,n,i,o){const s=o[e];if(null!==s)for(let a=0;a<s.length;)Iz(n,t,s[a++],s[a++],s[a++],s[a++])}function ule(r,e,t){let n=null,i=0;for(;i<t.length;){const o=t[i];if(0!==o)if(5!==o){if("number"==typeof o)break;if(r.hasOwnProperty(o)){null===n&&(n=[]);const s=r[o];for(let a=0;a<s.length;a+=3)if(s[a]===e){n.push(o,s[a+1],s[a+2],t[i+1]);break}}i+=2}else i+=2;else i+=4}return n}function Hz(r,e,t,n){return[r,!0,0,e,null,n,null,t,null,null]}function Fz(r,e){const t=r.contentQueries;if(null!==t){const n=j1(null);try{for(let i=0;i<t.length;i+=2){const s=t[i+1];if(-1!==s){const a=r.data[s];Ey(t[i]),a.contentQueries(2,e[s],s)}}}finally{j1(n)}}}function ig(r,e){return r[Du]?r[ox][ya]=e:r[Du]=e,r[ox]=e,e}function zM(r,e,t){Ey(0);const n=j1(null);try{e(r,t)}finally{j1(n)}}function Uz(r){return r[A0]||(r[A0]=[])}function $z(r){return r.cleanup||(r.cleanup=[])}function og(r,e){const t=r[ro],n=t?t.get(E3,null):null;n&&n.handleError(e)}function DM(r,e,t,n,i){for(let o=0;o<t.length;){const s=t[o++],a=t[o++],c=t[o++];Iz(r.data[s],e[s],n,a,c,i)}}function P3(r,e,t){const n=Uu(e,r);IL(r[en],n,t)}function hle(r,e,t,n){const i=e[bt];if(256==(256&i))return;e[nc].inlineEffectRunner?.flush(),Py(e);let s=null,a=null;(function gle(r){return 2!==r.type})(r)&&(a=function N4e(r){return r[Gl]??function I4e(r){const e=Cz.pop()??Object.create(R4e);return e.lView=r,e}(r)}(e),s=function Ul(r){return r&&(r.nextProducerIndex=0),j1(r)}(a));try{_x(e),function Sx(r){return Bt.lFrame.bindingIndex=r}(r.bindingStartIndex),null!==t&&kz(r,e,t,2,n);const c=3==(3&i);if(c){const f=r.preOrderCheckHooks;null!==f&&dh(e,f,null)}else{const f=r.preOrderHooks;null!==f&&hh(e,f,0,null),Oy(e,0)}if(function ple(r){for(let e=vz(r);null!==e;e=yz(e)){if(!(e[bt]&cy.HasTransplantedViews))continue;const t=e[N0];for(let n=0;n<t.length;n++){kae(t[n])}}}(e),Bz(e,0),null!==r.contentQueries&&Fz(r,e),c){const f=r.contentCheckHooks;null!==f&&dh(e,f)}else{const f=r.contentHooks;null!==f&&hh(e,f,1),Oy(e,1)}!function U4e(r,e){const t=r.hostBindingOpCodes;if(null!==t)try{for(let n=0;n<t.length;n++){const i=t[n];if(i<0)jl(~i);else{const o=i,s=t[++n],a=t[++n];Gae(s,o),a(2,e[o])}}}finally{jl(-1)}}(r,e);const l=r.components;null!==l&&qz(e,l,0);const u=r.viewQuery;if(null!==u&&zM(2,u,n),c){const f=r.viewCheckHooks;null!==f&&dh(e,f)}else{const f=r.viewHooks;null!==f&&hh(e,f,2),Oy(e,2)}if(!0===r.firstUpdatePass&&(r.firstUpdatePass=!1),e[sh]){for(const f of e[sh])f();e[sh]=null}e[bt]&=-73}catch(c){throw Gu(e),c}finally{null!==a&&(function St(r,e){if(j1(e),r&&void 0!==r.producerNode&&void 0!==r.producerIndexOfThis&&void 0!==r.producerLastReadVersion){if(Rs(r))for(let t=r.nextProducerIndex;t<r.producerNode.length;t++)N1(r.producerNode[t],r.producerIndexOfThis[t]);for(;r.producerNode.length>r.nextProducerIndex;)r.producerNode.pop(),r.producerLastReadVersion.pop(),r.producerIndexOfThis.pop()}}(a,s),function k4e(r){r.lView[Gl]!==r&&(r.lView=null,Cz.push(r))}(a)),Sy()}}function Bz(r,e){for(let t=vz(r);null!==t;t=yz(t))for(let n=Dr;n<t.length;n++)Wz(t[n],e)}function mle(r,e,t){Wz(Xo(e,r),t)}function Wz(r,e){py(r)&&HM(r,e)}function HM(r,e){const n=r[He],i=r[bt],o=r[Gl];let s=!!(0===e&&16&i);if(s||=!!(64&i&&0===e),s||=!!(1024&i),s||=!(!o?.dirty||!at(o)),o&&(o.dirty=!1),r[bt]&=-9217,s)hle(n,r,n.template,r[x1]);else if(8192&i){Bz(r,1);const a=n.components;null!==a&&qz(r,a,1)}}function qz(r,e,t){for(let n=0;n<e.length;n++)mle(r,e[n],t)}function l7(r){for(r[nc].changeDetectionScheduler?.notify();r;){r[bt]|=64;const e=ql(r);if(uy(r)&&!e)return r;r=e}return null}class u7{get rootNodes(){const e=this._lView,t=e[He];return a7(t,e,t.firstChild,[])}constructor(e,t,n=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=n,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[x1]}set context(e){this._lView[x1]=e}get destroyed(){return 256==(256&this._lView[bt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[zr];if(L2(e)){const t=e[8],n=t?t.indexOf(this):-1;n>-1&&(e7(e,n),vh(t,n))}this._attachedToViewContainer=!1}Vh(this._lView[He],this._lView)}onDestroy(e){lh(this._lView,e)}markForCheck(){l7(this._cdRefInjectingView||this._lView)}detach(){this._lView[bt]&=-129}reattach(){my(this._lView),this._lView[bt]|=128}detectChanges(){this._lView[bt]|=1024,function VM(r,e=!0){const t=r[nc],n=t.rendererFactory;n.begin?.();try{!function dle(r){HM(r,0);let e=0;for(;vx(r);){if(100===e)throw new ge(103,!1);e++,HM(r,1)}}(r)}catch(o){throw e&&og(r,o),o}finally{n.end?.(),t.inlineEffectRunner?.flush()}}(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ge(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,kL(this._lView[He],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ge(902,!1);this._appRef=e,my(this._lView)}}let zs=(()=>{class r{static#e=this.__NG_ELEMENT_ID__=_le}return r})();function _le(r){return function Cle(r,e,t){if(Bl(r)&&!t){const n=Xo(r.index,e);return new u7(n,n)}return 47&r.type?new u7(e[mr],e):null}(_1(),ye(),16==(16&r))}let sg=(()=>{class r{static#e=this.__NG_ELEMENT_ID__=Ele;static#t=this.__NG_ENV_ID__=t=>t}return r})();class Mle extends sg{constructor(e){super(),this._lView=e}onDestroy(e){return lh(this._lView,e),()=>function _y(r,e){if(null===r[M4])return;const t=r[M4].indexOf(e);-1!==t&&r[M4].splice(t,1)}(this._lView,e)}}function Ele(){return new Mle(ye())}const jz=new Set;function Jl(r){jz.has(r)||(jz.add(r),performance?.mark?.("mark_feature_usage",{detail:{feature:r}}))}function FM(r){return e=>{setTimeout(r,void 0,e)}}const l1=class ble extends xs{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){let i=e,o=t||(()=>null),s=n;if(e&&"object"==typeof e){const c=e;i=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=FM(o),i&&(i=FM(i)),s&&(s=FM(s)));const a=super.subscribe({next:i,error:o,complete:s});return e instanceof Ue&&e.add(a),a}};function Zz(...r){}class bn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new l1(!1),this.onMicrotaskEmpty=new l1(!1),this.onStable=new l1(!1),this.onError=new l1(!1),typeof Zone>"u")throw new ge(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!n&&t,i.shouldCoalesceRunChangeDetection=n,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function wle(){const r="function"==typeof R1.requestAnimationFrame;let e=R1[r?"requestAnimationFrame":"setTimeout"],t=R1[r?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function kle(r){const e=()=>{!function Ile(r){r.isCheckStableRunning||-1!==r.lastRequestAnimationFrameId||(r.lastRequestAnimationFrameId=r.nativeRequestAnimationFrame.call(R1,()=>{r.fakeTopEventTask||(r.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{r.lastRequestAnimationFrameId=-1,$M(r),r.isCheckStableRunning=!0,UM(r),r.isCheckStableRunning=!1},void 0,()=>{},()=>{})),r.fakeTopEventTask.invoke()}),$M(r))}(r)};r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,i,o,s,a)=>{if(function Rle(r){return!(!Array.isArray(r)||1!==r.length)&&!0===r[0].data?.__ignore_ng_zone__}(a))return t.invokeTask(i,o,s,a);try{return Yz(r),t.invokeTask(i,o,s,a)}finally{(r.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||r.shouldCoalesceRunChangeDetection)&&e(),Kz(r)}},onInvoke:(t,n,i,o,s,a,c)=>{try{return Yz(r),t.invoke(i,o,s,a,c)}finally{r.shouldCoalesceRunChangeDetection&&e(),Kz(r)}},onHasTask:(t,n,i,o)=>{t.hasTask(i,o),n===i&&("microTask"==o.change?(r._hasPendingMicrotasks=o.microTask,$M(r),UM(r)):"macroTask"==o.change&&(r.hasPendingMacrotasks=o.macroTask))},onHandleError:(t,n,i,o)=>(t.handleError(i,o),r.runOutsideAngular(()=>r.onError.emit(o)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!bn.isInAngularZone())throw new ge(909,!1)}static assertNotInAngularZone(){if(bn.isInAngularZone())throw new ge(909,!1)}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,i){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,Nle,Zz,Zz);try{return o.runTask(s,t,n)}finally{o.cancelTask(s)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const Nle={};function UM(r){if(0==r._nesting&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function $M(r){r.hasPendingMicrotasks=!!(r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&-1!==r.lastRequestAnimationFrameId)}function Yz(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function Kz(r){r._nesting--,UM(r)}class Xz{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new l1,this.onMicrotaskEmpty=new l1,this.onStable=new l1,this.onError=new l1}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,i){return e.apply(t,n)}}var e6=function(r){return r[r.EarlyRead=0]="EarlyRead",r[r.Write=1]="Write",r[r.MixedReadWrite=2]="MixedReadWrite",r[r.Read=3]="Read",r}(e6||{});const Qz={destroy(){}};function eD(r,e){!e&&function By(r){if(!GR()&&!function eae(){return T0}())throw new ge(-203,!1)}();const t=e?.injector??Le(Li);if(!function T4(r){return"browser"===(r??Le(Li)).get(y3)}(t))return Qz;Jl("NgAfterNextRender");const n=t.get(f7),i=n.handler??=new nD,o=e?.phase??e6.MixedReadWrite,s=()=>{i.unregister(c),a()},a=t.get(sg).onDestroy(s),c=new tD(t,o,()=>{s(),r()});return i.register(c),{destroy:s}}class tD{constructor(e,t,n){this.phase=t,this.callbackFn=n,this.zone=e.get(bn),this.errorHandler=e.get(E3,null,{optional:!0})}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}}class nD{constructor(){this.executingCallbacks=!1,this.buckets={[e6.EarlyRead]:new Set,[e6.Write]:new Set,[e6.MixedReadWrite]:new Set,[e6.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){let e=!1;this.executingCallbacks=!0;for(const t of Object.values(this.buckets))for(const n of t)e=!0,n.invoke();this.executingCallbacks=!1;for(const t of this.deferredCallbacks)this.buckets[t.phase].add(t);return this.deferredCallbacks.clear(),e}destroy(){for(const e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}}let f7=(()=>{class r{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){const t=[...this.internalCallbacks];this.internalCallbacks.length=0;for(const i of t)i();return!!this.handler?.execute()||t.length>0}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static#e=this.\u0275prov=xe({token:r,providedIn:"root",factory:()=>new r})}return r})();function zle(r,e){const t=Xo(e,r),n=t[He];!function Dle(r,e){for(let t=e.length;t<r.blueprint.length;t++)e.push(r.blueprint[t])}(n,t);const i=t[Sr];null!==i&&null===t[Ma]&&(t[Ma]=yM(i,t[ro])),GM(n,t,t[x1])}function GM(r,e,t){Py(e);try{const n=r.viewQuery;null!==n&&zM(1,n,t);const i=r.template;null!==i&&kz(r,e,i,1,t),r.firstCreatePass&&(r.firstCreatePass=!1),r.staticContentQueries&&Fz(r,e),r.staticViewQueries&&zM(2,r.viewQuery,t);const o=r.components;null!==o&&function Vle(r,e){for(let t=0;t<e.length;t++)zle(r,e[t])}(e,o)}catch(n){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),n}finally{e[bt]&=-5,Sy()}}function ag(r,e,t){let n=t?r.styles:null,i=t?r.classes:null,o=0;if(null!==e)for(let s=0;s<e.length;s++){const a=e[s];"number"==typeof a?o=a:1==o?i=jv(i,a):2==o&&(n=jv(n,a+": "+e[++s]+";"))}t?r.styles=n:r.stylesWithoutHost=n,t?r.classes=i:r.classesWithoutHost=i}class rD extends Jh{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=pn(e);return new d7(t,this.ngModule)}}function iD(r){const e=[];for(const t in r){if(!r.hasOwnProperty(t))continue;const n=r[t];void 0!==n&&e.push({propName:Array.isArray(n)?n[0]:n,templateName:t})}return e}class Fle{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){n=rh(n);const i=this.injector.get(e,SM,n);return i!==SM||t===SM?i:this.parentInjector.get(e,t,n)}}class d7 extends cz{get inputs(){const e=this.componentDef,t=e.inputTransforms,n=iD(e.inputs);if(null!==t)for(const i of n)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return n}get outputs(){return iD(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function gae(r){return r.map(hae).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,n,i){let o=(i=i||this.ngModule)instanceof es?i:i?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const s=o?new Fle(e,o):e,a=s.get(PM,null);if(null===a)throw new ge(407,!1);const f={rendererFactory:a,sanitizer:s.get(v4e,null),inlineEffectRunner:null,afterRenderEventManager:s.get(f7,null),changeDetectionScheduler:s.get(iz,null)},g=a.createRenderer(null,this.componentDef),y=this.componentDef.selectors[0][0]||"div",S=n?function G4e(r,e,t,n){const o=n.get(Oz,!1)||t===Ca.ShadowDom,s=r.selectRootElement(e,o);return function B4e(r){xz(r)}(s),s}(g,n,this.componentDef.encapsulation,s):Dh(g,y,function Hle(r){const e=r.toLowerCase();return"svg"===e?gx:"math"===e?"math":null}(y));let I=512;this.componentDef.signals?I|=4096:this.componentDef.onPush||(I|=16);let R=null;null!==S&&(R=yM(S,s,!0));const U=kM(0,null,null,1,0,null,null,null,null,null,null),$=rg(null,U,null,I,null,null,f,g,s,null,R);let oe,_e;Py($);try{const Te=this.componentDef;let Fe,mt=null;Te.findHostDirectiveDefs?(Fe=[],mt=new Map,Te.findHostDirectiveDefs(Te,Fe,mt),Fe.push(Te)):Fe=[Te];const rn=function $le(r,e){const t=r[He],n=Qt;return r[n]=e,Q0(t,n,2,"#host",null)}($,S),a1=function Gle(r,e,t,n,i,o,s){const a=i[He];!function Ble(r,e,t,n){for(const i of r)e.mergedAttrs=zu(e.mergedAttrs,i.hostAttrs);null!==e.mergedAttrs&&(ag(e,e.mergedAttrs,!0),null!==t&&WL(n,t,e))}(n,r,e,s);let c=null;null!==e&&(c=yM(e,i[ro]));const l=o.rendererFactory.createRenderer(e,t);let u=16;t.signals?u=4096:t.onPush&&(u=64);const f=rg(i,Rz(t),null,u,i[r.index],r,o,l,null,null,c);return a.firstCreatePass&&xM(a,r,n.length-1),ig(i,f),i[r.index]=f}(rn,S,Te,Fe,$,f,g);_e=$u(U,Qt),S&&function qle(r,e,t,n){if(n)sy(r,t,["ng-version","17.1.0"]);else{const{attrs:i,classes:o}=function pae(r){const e=[],t=[];let n=1,i=2;for(;n<r.length;){let o=r[n];if("string"==typeof o)2===i?""!==o&&e.push(o,r[++n]):8===i&&t.push(o);else{if(!va(i))break;i=o}n++}return{attrs:e,classes:t}}(e.selectors[0]);i&&sy(r,t,i),o&&o.length>0&&BL(r,t,o.join(" "))}}(g,Te,S,n),void 0!==t&&function jle(r,e,t){const n=r.projection=[];for(let i=0;i<e.length;i++){const o=t[i];n.push(null!=o?Array.from(o):null)}}(_e,this.ngContentSelectors,t),oe=function Wle(r,e,t,n,i,o){const s=_1(),a=i[He],c=io(s,i);Dz(a,i,s,t,null,n);for(let u=0;u<t.length;u++)D2(Zl(i,a,s.directiveStart+u,s),i);Vz(a,i,s),c&&D2(c,i);const l=Zl(i,a,s.directiveStart+s.componentOffset,s);if(r[x1]=i[x1]=l,null!==o)for(const u of o)u(l,e);return wM(a,s,r),l}(a1,Te,Fe,mt,$,[Zle]),GM(U,$,null)}finally{Sy()}return new Ule(this.componentType,oe,X0(_e,$),$,_e)}}class Ule extends h4e{constructor(e,t,n,i,o){super(),this.location=n,this._rootLView=i,this._tNode=o,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new u7(i,void 0,!1),this.componentType=e}setInput(e,t){const n=this._tNode.inputs;let i;if(null!==n&&(i=n[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const o=this._rootLView;DM(o[He],o,i,e,t),this.previousInputValues.set(e,t),l7(Xo(this._tNode.index,o))}}get injector(){return new _i(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function Zle(){const r=_1();fh(ye()[He],r)}function We(r){let e=function oD(r){return Object.getPrototypeOf(r.prototype).constructor}(r.type),t=!0;const n=[r];for(;e;){let i;if(Ea(r))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ge(903,!1);i=e.\u0275dir}if(i){if(t){n.push(i);const s=r;s.inputs=cg(r.inputs),s.inputTransforms=cg(r.inputTransforms),s.declaredInputs=cg(r.declaredInputs),s.outputs=cg(r.outputs);const a=i.hostBindings;a&&Jle(r,a);const c=i.viewQuery,l=i.contentQueries;if(c&&Xle(r,c),l&&Qle(r,l),Yle(r,i),Hse(r.outputs,i.outputs),Ea(i)&&i.data.animation){const u=r.data;u.animation=(u.animation||[]).concat(i.data.animation)}}const o=i.features;if(o)for(let s=0;s<o.length;s++){const a=o[s];a&&a.ngInherit&&a(r),a===We&&(t=!1)}}e=Object.getPrototypeOf(e)}!function Kle(r){let e=0,t=null;for(let n=r.length-1;n>=0;n--){const i=r[n];i.hostVars=e+=i.hostVars,i.hostAttrs=zu(i.hostAttrs,t=zu(t,i.hostAttrs))}}(n)}function Yle(r,e){for(const t in e.inputs){if(!e.inputs.hasOwnProperty(t)||r.inputs.hasOwnProperty(t))continue;const n=e.inputs[t];if(void 0!==n&&(r.inputs[t]=n,r.declaredInputs[t]=e.declaredInputs[t],null!==e.inputTransforms)){const i=Array.isArray(n)?n[0]:n;if(!e.inputTransforms.hasOwnProperty(i))continue;r.inputTransforms??={},r.inputTransforms[i]=e.inputTransforms[i]}}}function cg(r){return r===tc?{}:r===Kn?[]:r}function Xle(r,e){const t=r.viewQuery;r.viewQuery=t?(n,i)=>{e(n,i),t(n,i)}:e}function Qle(r,e){const t=r.contentQueries;r.contentQueries=t?(n,i,o)=>{e(n,i,o),t(n,i,o)}:e}function Jle(r,e){const t=r.hostBindings;r.hostBindings=t?(n,i)=>{e(n,i),t(n,i)}:e}function lD(r){const e=r.inputConfig,t={};for(const n in e)if(e.hasOwnProperty(n)){const i=e[n];Array.isArray(i)&&i[3]&&(t[n]=i[3])}r.inputTransforms=t}function e8(r,e){return!e||null===e.firstChild||xh(r)}function C7(r,e,t,n=!0){const i=e[He];if(function M3e(r,e,t,n){const i=Dr+n,o=t.length;n>0&&(t[i-1][ya]=e),n<o-Dr?(e[ya]=t[i],jx(t,Dr+n,e)):(t.push(e),e[ya]=null),e[zr]=t;const s=e[Vu];null!==s&&t!==s&&function E3e(r,e){const t=r[N0];e[mr]!==e[zr][zr][mr]&&(r[bt]|=cy.HasTransplantedViews),null===t?r[N0]=[e]:t.push(e)}(s,e);const a=e[rc];null!==a&&a.insertView(r),my(e),e[bt]|=128}(i,e,r,t),n){const s=sM(t,r),a=e[en],c=Hh(a,r[ic]);null!==c&&function v3e(r,e,t,n,i,o){n[Sr]=i,n[R2]=e,$h(r,n,t,1,i,o)}(i,r[R2],a,e,c,s)}const o=e[Ma];null!==o&&null!==o.firstChild&&(o.firstChild=null)}let is=(()=>{class r{static#e=this.__NG_ELEMENT_ID__=T6e}return r})();function T6e(){return vD(_1(),ye())}const A6e=is,_D=class extends A6e{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return X0(this._hostTNode,this._hostLView)}get injector(){return new _i(this._hostTNode,this._hostLView)}get parentInjector(){const e=mh(this._hostTNode,this._hostLView);if(Ay(e)){const t=ju(e,this._hostLView),n=qu(e);return new _i(t[He].data[n+8],t)}return new _i(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=CD(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-Dr}createEmbeddedView(e,t,n){let i,o;"number"==typeof n?i=n:null!=n&&(i=n.index,o=n.injector);const a=e.createEmbeddedViewImpl(t||{},o,null);return this.insertImpl(a,i,e8(this._hostTNode,null)),a}createComponent(e,t,n,i,o){const s=e&&!function Zu(r){return"function"==typeof r}(e);let a;if(s)a=t;else{const S=t||{};a=S.index,n=S.injector,i=S.projectableNodes,o=S.environmentInjector||S.ngModuleRef}const c=s?e:new d7(pn(e)),l=n||this.parentInjector;if(!o&&null==c.ngModule){const I=(s?l:this.parentInjector).get(es,null);I&&(o=I)}pn(c.componentType??{});const y=c.create(l,i,null,o);return this.insertImpl(y.hostView,a,e8(this._hostTNode,null)),y}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,n){const i=e._lView;if(function Iae(r){return L2(r[zr])}(i)){const a=this.indexOf(e);if(-1!==a)this.detach(a);else{const c=i[zr],l=new _D(c,c[R2],c[zr]);l.detach(l.indexOf(e))}}const o=this._adjustIndex(t),s=this._lContainer;return C7(s,i,o,n),e.attachToViewContainerRef(),jx(KM(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=CD(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=e7(this._lContainer,t);n&&(vh(KM(this._lContainer),t),Vh(n[He],n))}detach(e){const t=this._adjustIndex(e,-1),n=e7(this._lContainer,t);return n&&null!=vh(KM(this._lContainer),t)?new u7(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function CD(r){return r[8]}function KM(r){return r[8]||(r[8]=[])}function vD(r,e){let t;const n=e[r.index];return L2(n)?t=n:(t=Hz(n,e,null,r),e[r.index]=t,ig(e,t)),yD(t,e,r,n),new _D(t,r,e)}let yD=function ED(r,e,t,n){if(r[ic])return;let i;i=8&t.type?L1(n):function b6e(r,e){const t=r[en],n=t.createComment(""),i=io(e,r);return Xl(t,Hh(t,i),n,function T3e(r,e){return r.nextSibling(e)}(t,i),!1),n}(e,t),r[ic]=i},XM=()=>!1;function hc(r,e,t){return r[e]=t}function ti(r,e,t){return!Object.is(r[e],t)&&(r[e]=t,!0)}function t6(r,e,t,n){const i=ti(r,e,t);return ti(r,e+1,n)||i}function z(r,e,t,n,i,o,s,a){const c=ye(),l=Vn(),u=r+Qt,f=l.firstCreatePass?function k6e(r,e,t,n,i,o,s,a,c){const l=e.consts,u=Q0(e,r,4,s||null,sc(l,a));RM(e,t,u,sc(l,c)),fh(e,u);const f=u.tView=kM(2,u,n,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return null!==e.queries&&(e.queries.template(e,u),f.queries=e.queries.embeddedTView(u)),u}(u,l,c,e,t,n,i,o,s):l.data[u];ac(f,!1);const g=PD(l,c,f,r);uh()&&Fh(l,c,g,f),D2(g,c);const y=Hz(g,c,g,f);return c[u]=y,ig(c,y),function MD(r,e,t){return XM(r,e,t)}(y,f,c),ch(f)&&NM(l,c,f),null!=s&&IM(c,f,a),z}let PD=function SD(r,e,t,n){return E4(!0),e[en].createComment("")};function w(r,e,t,n){const i=ye();return ti(i,cc(),e)&&(Vn(),function dc(r,e,t,n,i,o){const s=io(r,e);LM(e[en],s,o,r.value,t,n,i)}(Y1(),i,r,e,t,n)),w}function c8(r,e,t,n){return ti(r,cc(),t)?e+Xt(t)+n:tn}function l8(r,e,t,n,i,o){const a=t6(r,C3(),t,i);return v3(2),a?e+Xt(t)+n+Xt(i)+o:tn}function u8(r,e,t,n,i,o,s,a){const l=function hg(r,e,t,n,i){const o=t6(r,e,t,n);return ti(r,e+2,i)||o}(r,C3(),t,i,s);return v3(3),l?e+Xt(t)+n+Xt(i)+o+Xt(s)+a:tn}function f8(r,e,t,n,i,o,s,a,c,l){const f=function Ds(r,e,t,n,i,o){const s=t6(r,e,t,n);return t6(r,e+2,i,o)||s}(r,C3(),t,i,s,c);return v3(4),f?e+Xt(t)+n+Xt(i)+o+Xt(s)+a+Xt(c)+l:tn}function vg(r,e){return r<<17|e<<2}function N4(r){return r>>17&32767}function sE(r){return 2|r}function r6(r){return(131068&r)>>2}function aE(r,e){return-131069&r|e<<2}function cE(r){return 1|r}function nV(r,e,t,n){const i=r[t+1],o=null===e;let s=n?N4(i):r6(i),a=!1;for(;0!==s&&(!1===a||o);){const l=r[s+1];m0e(r[s],e)&&(a=!0,r[s+1]=n?cE(l):sE(l)),s=n?N4(l):r6(l)}a&&(r[t+1]=n?sE(i):cE(i))}function m0e(r,e){return null===r||null==e||(Array.isArray(r)?r[1]:r)===e||!(!Array.isArray(r)||"string"!=typeof e)&&$0(r,e)>=0}const vi={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function rV(r){return r.substring(vi.key,vi.keyEnd)}function _0e(r){return r.substring(vi.value,vi.valueEnd)}function oV(r,e){const t=vi.textEnd;let n=vi.key=m8(r,e,t);return t===n?-1:(n=vi.keyEnd=function M0e(r,e,t){let n;for(;e<t&&(45===(n=r.charCodeAt(e))||95===n||(-33&n)>=65&&(-33&n)<=90||n>=48&&n<=57);)e++;return e}(r,n,t),n=aV(r,n,t),n=vi.value=m8(r,n,t),n=vi.valueEnd=function E0e(r,e,t){let n=-1,i=-1,o=-1,s=e,a=s;for(;s<t;){const c=r.charCodeAt(s++);if(59===c)return a;34===c||39===c?a=s=cV(r,c,s,t):e===s-4&&85===o&&82===i&&76===n&&40===c?a=s=cV(r,41,s,t):c>32&&(a=s),o=i,i=n,n=-33&c}return a}(r,n,t),aV(r,n,t))}function m8(r,e,t){for(;e<t&&r.charCodeAt(e)<=32;)e++;return e}function aV(r,e,t,n){return(e=m8(r,e,t))<t&&e++,e}function cV(r,e,t,n){let i=-1,o=t;for(;o<n;){const s=r.charCodeAt(o++);if(s==e&&92!==i)return o;i=92==s&&92===i?0:s}throw new Error}function v(r,e,t){const n=ye();return ti(n,cc(),e)&&rs(Vn(),Y1(),n,r,e,n[en],t,!1),v}function lE(r,e,t,n,i){const s=i?"class":"style";DM(r,t,e.inputs[s],s,n)}function yg(r,e){return function Pa(r,e,t,n){const i=ye(),o=Vn(),s=v3(2);o.firstUpdatePass&&fV(o,r,s,n),e!==tn&&ti(i,s,e)&&hV(o,o.data[z2()],i,i[en],r,i[s+1]=function k0e(r,e){return null==r||""===r||("string"==typeof e?r+=e:"object"==typeof r&&(r=pi(ns(r)))),r}(e,t),n,s)}(r,e,null,!0),yg}function l2(r){!function Sa(r,e,t,n){const i=Vn(),o=v3(2);i.firstUpdatePass&&fV(i,null,o,n);const s=ye();if(t!==tn&&ti(s,o,t)){const a=i.data[z2()];if(pV(a,n)&&!uV(i,o)){let c=n?a.classesWithoutHost:a.stylesWithoutHost;null!==c&&(t=jv(c,t||"")),lE(i,a,s,t,n)}else!function I0e(r,e,t,n,i,o,s,a){i===tn&&(i=Kn);let c=0,l=0,u=0<i.length?i[0]:null,f=0<o.length?o[0]:null;for(;null!==u||null!==f;){const g=c<i.length?i[c+1]:void 0,y=l<o.length?o[l+1]:void 0;let I,S=null;u===f?(c+=2,l+=2,g!==y&&(S=f,I=y)):null===f||null!==u&&u<f?(c+=2,S=u):(l+=2,S=f,I=y),null!==S&&hV(r,e,t,n,S,I,s,a),u=c<i.length?i[c]:null,f=l<o.length?o[l]:null}}(i,a,s,s[en],s[o+1],s[o+1]=function w0e(r,e,t){if(null==t||""===t)return Kn;const n=[],i=ns(t);if(Array.isArray(i))for(let o=0;o<i.length;o++)r(n,i[o],!0);else if("object"==typeof i)for(const o in i)i.hasOwnProperty(o)&&r(n,o,i[o]);else"string"==typeof i&&e(n,i);return n}(r,e,t),n,o)}}(dV,P0e,r,!1)}function P0e(r,e){for(let t=function v0e(r){return function sV(r){vi.key=0,vi.keyEnd=0,vi.value=0,vi.valueEnd=0,vi.textEnd=r.length}(r),oV(r,m8(r,0,vi.textEnd))}(e);t>=0;t=oV(e,t))dV(r,rV(e),_0e(e))}function uV(r,e){return e>=r.expandoStartIndex}function fV(r,e,t,n){const i=r.data;if(null===i[t+1]){const o=i[z2()],s=uV(r,t);pV(o,n)&&null===e&&!s&&(e=!1),e=function O0e(r,e,t,n){const i=function My(r){const e=Bt.lFrame.currentDirectiveIndex;return-1===e?null:r[e]}(r);let o=n?e.residualClasses:e.residualStyles;if(null===i)0===(n?e.classBindings:e.styleBindings)&&(t=P7(t=uE(null,r,e,t,n),e.attrs,n),o=null);else{const s=e.directiveStylingLast;if(-1===s||r[s]!==i)if(t=uE(i,r,e,t,n),null===o){let c=function T0e(r,e,t){const n=t?e.classBindings:e.styleBindings;if(0!==r6(n))return r[N4(n)]}(r,e,n);void 0!==c&&Array.isArray(c)&&(c=uE(null,r,e,c[1],n),c=P7(c,e.attrs,n),function A0e(r,e,t,n){r[N4(t?e.classBindings:e.styleBindings)]=n}(r,e,n,c))}else o=function b0e(r,e,t){let n;const i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++)n=P7(n,r[o].hostAttrs,t);return P7(n,e.attrs,t)}(r,e,n)}return void 0!==o&&(n?e.residualClasses=o:e.residualStyles=o),t}(i,o,e,n),function g0e(r,e,t,n,i,o){let s=o?e.classBindings:e.styleBindings,a=N4(s),c=r6(s);r[n]=t;let u,l=!1;if(Array.isArray(t)?(u=t[1],(null===u||$0(t,u)>0)&&(l=!0)):u=t,i)if(0!==c){const g=N4(r[a+1]);r[n+1]=vg(g,a),0!==g&&(r[g+1]=aE(r[g+1],n)),r[a+1]=function d0e(r,e){return 131071&r|e<<17}(r[a+1],n)}else r[n+1]=vg(a,0),0!==a&&(r[a+1]=aE(r[a+1],n)),a=n;else r[n+1]=vg(c,0),0===a?a=n:r[c+1]=aE(r[c+1],n),c=n;l&&(r[n+1]=sE(r[n+1])),nV(r,u,n,!0),nV(r,u,n,!1),function p0e(r,e,t,n,i){const o=i?r.residualClasses:r.residualStyles;null!=o&&"string"==typeof e&&$0(o,e)>=0&&(t[n+1]=cE(t[n+1]))}(e,u,r,n,o),s=vg(a,c),o?e.classBindings=s:e.styleBindings=s}(i,o,e,t,s,n)}}function uE(r,e,t,n,i){let o=null;const s=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<s&&(o=e[a],n=P7(n,o.hostAttrs,i),o!==r);)a++;return null!==r&&(t.directiveStylingLast=a),n}function P7(r,e,t){const n=t?1:2;let i=-1;if(null!==e)for(let o=0;o<e.length;o++){const s=e[o];"number"==typeof s?i=s:i===n&&(Array.isArray(r)||(r=void 0===r?[]:["",r]),Qo(r,s,!!t||e[++o]))}return void 0===r?null:r}function dV(r,e,t){Qo(r,e,ns(t))}function hV(r,e,t,n,i,o,s,a){if(!(3&e.type))return;const c=r.data,l=c[a+1],u=function h0e(r){return 1==(1&r)}(l)?gV(c,e,t,i,r6(l),s):void 0;Mg(u)||(Mg(o)||function f0e(r){return 2==(2&r)}(l)&&(o=gV(c,null,t,i,a,s)),function w3e(r,e,t,n,i){if(e)i?r.addClass(t,n):r.removeClass(t,n);else{let o=-1===n.indexOf("-")?void 0:b4.DashCase;null==i?r.removeStyle(t,n,o):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=b4.Important),r.setStyle(t,n,i,o))}}(n,s,Uu(z2(),t),i,o))}function gV(r,e,t,n,i,o){const s=null===e;let a;for(;i>0;){const c=r[i],l=Array.isArray(c),u=l?c[1]:c,f=null===u;let g=t[i+1];g===tn&&(g=f?Kn:void 0);let y=f?xy(g,n):u===n?g:void 0;if(l&&!Mg(y)&&(y=xy(c,n)),Mg(y)&&(a=y,s))return a;const S=r[i+1];i=s?N4(S):r6(S)}if(null!==e){let c=o?e.residualClasses:e.residualStyles;null!=c&&(a=xy(c,n))}return a}function Mg(r){return void 0!==r}function pV(r,e){return 0!=(r.flags&(e?8:16))}function M(r,e,t,n){const i=ye(),o=Vn(),s=Qt+r,a=i[en],c=o.firstCreatePass?function t8e(r,e,t,n,i,o){const s=e.consts,c=Q0(e,r,2,n,sc(s,i));return RM(e,t,c,sc(s,o)),null!==c.attrs&&ag(c,c.attrs,!1),null!==c.mergedAttrs&&ag(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(s,o,i,e,t,n):o.data[s],l=vV(o,i,c,a,e,r);i[s]=l;const u=ch(c);return ac(c,!0),WL(a,l,c),32!=(32&c.flags)&&uh()&&Fh(o,i,l,c),0===function Rae(){return Bt.lFrame.elementDepthCount}()&&D2(l,i),function xae(){Bt.lFrame.elementDepthCount++}(),u&&(NM(o,i,c),wM(o,c,i)),null!==n&&IM(i,c),M}function P(){let r=_1();Cy()?vy():(r=r.parent,ac(r,!1));const e=r;(function zae(r){return Bt.skipHydrationRootTNode===r})(e)&&function Fae(){Bt.skipHydrationRootTNode=null}(),function Lae(){Bt.lFrame.elementDepthCount--}();const t=Vn();return t.firstCreatePass&&(fh(t,r),ly(r)&&t.queries.elementEnd(r)),null!=e.classesWithoutHost&&function ece(r){return 0!=(8&r.flags)}(e)&&lE(t,e,ye(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function tce(r){return 0!=(16&r.flags)}(e)&&lE(t,e,ye(),e.stylesWithoutHost,!1),P}function V(r,e,t,n){return M(r,e,t,n),P(),V}let vV=(r,e,t,n,i,o)=>(E4(!0),Dh(n,i,function kx(){return Bt.lFrame.currentNamespace}()));function jt(r,e,t){const n=ye(),i=Vn(),o=r+Qt,s=i.firstCreatePass?function i8e(r,e,t,n,i){const o=e.consts,s=sc(o,n),a=Q0(e,r,8,"ng-container",s);return null!==s&&ag(a,s,!0),RM(e,t,a,sc(o,i)),null!==e.queries&&e.queries.elementStart(e,a),a}(o,i,n,e,t):i.data[o];ac(s,!0);const a=MV(i,n,s,r);return n[o]=a,uh()&&Fh(i,n,a,s),D2(a,n),ch(s)&&(NM(i,n,s),wM(i,s,n)),null!=t&&IM(n,s),jt}function Zt(){let r=_1();const e=Vn();return Cy()?vy():(r=r.parent,ac(r,!1)),e.firstCreatePass&&(fh(e,r),ly(r)&&e.queries.elementEnd(r)),Zt}let MV=(r,e,t,n)=>(E4(!0),nM(e[en],""));function de(){return ye()}function pE(r,e,t){const n=ye();return ti(n,cc(),e)&&rs(Vn(),Y1(),n,r,e,n[en],t,!0),pE}const i6=void 0;var c8e=["en",[["a","p"],["AM","PM"],i6],[["AM","PM"],i6,i6],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],i6,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],i6,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",i6,"{1} 'at' {0}",i6],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function a8e(r){const t=Math.floor(Math.abs(r)),n=r.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}];let _8={};function so(r){const e=function u8e(r){return r.toLowerCase().replace(/_/g,"-")}(r);let t=SV(e);if(t)return t;const n=e.split("-")[0];if(t=SV(n),t)return t;if("en"===n)return c8e;throw new ge(701,!1)}function SV(r){return r in _8||(_8[r]=R1.ng&&R1.ng.common&&R1.ng.common.locales&&R1.ng.common.locales[r]),_8[r]}var D1=function(r){return r[r.LocaleId=0]="LocaleId",r[r.DayPeriodsFormat=1]="DayPeriodsFormat",r[r.DayPeriodsStandalone=2]="DayPeriodsStandalone",r[r.DaysFormat=3]="DaysFormat",r[r.DaysStandalone=4]="DaysStandalone",r[r.MonthsFormat=5]="MonthsFormat",r[r.MonthsStandalone=6]="MonthsStandalone",r[r.Eras=7]="Eras",r[r.FirstDayOfWeek=8]="FirstDayOfWeek",r[r.WeekendRange=9]="WeekendRange",r[r.DateFormat=10]="DateFormat",r[r.TimeFormat=11]="TimeFormat",r[r.DateTimeFormat=12]="DateTimeFormat",r[r.NumberSymbols=13]="NumberSymbols",r[r.NumberFormats=14]="NumberFormats",r[r.CurrencyCode=15]="CurrencyCode",r[r.CurrencySymbol=16]="CurrencySymbol",r[r.CurrencyName=17]="CurrencyName",r[r.Currencies=18]="Currencies",r[r.Directionality=19]="Directionality",r[r.PluralCase=20]="PluralCase",r[r.ExtraData=21]="ExtraData",r}(D1||{});const f8e=["zero","one","two","few","many"],C8="en-US",Eg={marker:"element"},Pg={marker:"ICU"};var wo=function(r){return r[r.SHIFT=2]="SHIFT",r[r.APPEND_EAGERLY=1]="APPEND_EAGERLY",r[r.COMMENT=2]="COMMENT",r}(wo||{});let OV=C8;function TV(r){(function Oo(r,e){null==r&&Ft(e,r,null,"!=")})(r,"Expected localeId to be defined"),"string"==typeof r&&(OV=r.toLowerCase().replace(/_/g,"-"))}function AV(r,e,t){const n=e.insertBeforeIndex,i=Array.isArray(n)?n[0]:n;return null===i?VL(r,0,t):L1(t[i])}function bV(r,e,t,n,i){const o=e.insertBeforeIndex;if(Array.isArray(o)){let s=n,a=null;if(3&e.type||(a=s,s=i),null!==s&&-1===e.componentOffset)for(let c=1;c<o.length;c++)Xl(r,s,t[o[c]],a,!1)}}function wV(r,e){if(r.push(e),r.length>1)for(let t=r.length-2;t>=0;t--){const n=r[t];NV(n)||p8e(n,e)&&null===m8e(n)&&_8e(n,e.index)}}function NV(r){return!(64&r.type)}function p8e(r,e){return NV(e)||r.index>e.index}function m8e(r){const e=r.insertBeforeIndex;return Array.isArray(e)?e[0]:e}function _8e(r,e){const t=r.insertBeforeIndex;Array.isArray(t)?t[0]=e:(FL(AV,bV),r.insertBeforeIndex=e)}function S7(r,e){const t=r.data[e];return null===t||"string"==typeof t?null:t.hasOwnProperty("currentCaseLViewIndex")?t:t.value}function y8e(r,e,t){const n=bM(r,t,64,null,null);return wV(e,n),n}function Sg(r,e){const t=e[r.currentCaseLViewIndex];return null===t?t:t<0?~t:t}function IV(r){return r>>>17}function kV(r){return(131070&r)>>>1}let O7=0,T7=0;function xV(r,e,t,n){const i=t[en];let s,o=null;for(let a=0;a<e.length;a++){const c=e[a];if("string"==typeof c){const l=e[++a];null===t[l]&&(t[l]=zh(i,c))}else if("number"==typeof c)switch(1&c){case 0:const l=IV(c);let u,f;if(null===o&&(o=l,s=Hh(i,n)),l===o?(u=n,f=s):(u=null,f=L1(t[l])),null!==f){const I=kV(c);Xl(i,f,t[I],u,!1);const U=S7(r,I);if(null!==U&&"object"==typeof U){const $=Sg(U,t);null!==$&&xV(r,U.create[$],t,t[U.anchorIdx])}}break;case 1:const y=e[++a],S=e[++a];LM(i,Uu(c>>>1,t),null,null,y,S,null)}else switch(c){case Pg:const l=e[++a],u=e[++a];null===t[u]&&D2(t[u]=nM(i,l),t);break;case Eg:const f=e[++a],g=e[++a];null===t[g]&&D2(t[g]=Dh(i,f,null),t)}}}function LV(r,e,t,n,i){for(let o=0;o<t.length;o++){const s=t[o],a=t[++o];if(s&i){let c="";for(let l=o+1;l<=o+a;l++){const u=t[l];if("string"==typeof u)c+=u;else if("number"==typeof u)if(u<0)c+=Xt(e[n-u]);else{const f=u>>>2;switch(3&u){case 1:const g=t[++l],y=t[++l],S=r.data[f];"string"==typeof S?LM(e[en],e[f],null,S,g,c,y):rs(r,S,e,g,c,e[en],y,!1);break;case 0:const I=e[f];null!==I&&IL(e[en],I,c);break;case 2:O8e(r,S7(r,f),e,c);break;case 3:zV(r,S7(r,f),n,e)}}}}else{const c=t[o+1];if(c>0&&3==(3&c)){const u=S7(r,c>>>2);e[u.currentCaseLViewIndex]<0&&zV(r,u,n,e)}}o+=a}}function zV(r,e,t,n){let i=n[e.currentCaseLViewIndex];if(null!==i){let o=O7;i<0&&(i=n[e.currentCaseLViewIndex]=~i,o=-1),LV(r,n,e.update[i],t,o)}}function O8e(r,e,t,n){const i=function T8e(r,e){let t=r.cases.indexOf(e);if(-1===t)switch(r.type){case 1:{const n=function d8e(r,e){const t=function PV(r){return so(r)[D1.PluralCase]}(e)(parseInt(r,10)),n=f8e[t];return void 0!==n?n:"other"}(e,function g8e(){return OV}());t=r.cases.indexOf(n),-1===t&&"other"!==n&&(t=r.cases.indexOf("other"));break}case 0:t=r.cases.indexOf("other")}return-1===t?null:t}(e,n);if(Sg(e,t)!==i&&(DV(r,e,t),t[e.currentCaseLViewIndex]=null===i?null:~i,null!==i)){const s=t[e.anchorIdx];s&&xV(r,e.create[i],t,s)}}function DV(r,e,t){let n=Sg(e,t);if(null!==n){const i=e.remove[n];for(let o=0;o<i.length;o++){const s=i[o];if(s>0){const a=Uu(s,t);null!==a&&Uh(t[en],a)}else DV(r,S7(r,~s),t)}}}function A8e(){const r=[];let t,n,e=-1;function o(a,c){e=0;const l=Sg(a,c);n=null!==l?a.remove[l]:Kn}function s(){if(e<n.length){const a=n[e++];return a>0?t[a]:(r.push(e,n),o(t[He].data[~a],t),s())}return 0===r.length?null:(n=r.pop(),e=r.pop(),s())}return function i(a,c){for(t=c;r.length;)r.pop();return o(a.value,c),s}}const Og=/\ufffd(\d+):?\d*\ufffd/gi,w8e=/\ufffd(\d+)\ufffd/,HV=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,A7="\ufffd",N8e=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,I8e=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,k8e=/\uE500/g;function FV(r,e,t,n,i,o,s){const a=c7(r,n,1,null);let c=a<<wo.SHIFT,l=Bu();e===l&&(l=null),null===l&&(c|=wo.APPEND_EAGERLY),s&&(c|=wo.COMMENT,function _3e(r){void 0===eM&&(eM=r())}(A8e)),i.push(c,null===o?"":o);const u=bM(r,a,s?32:1,null===o?"":o,null);wV(t,u);const f=u.index;return ac(u,!1),null!==l&&e!==l&&function v8e(r,e){let t=r.insertBeforeIndex;null===t?(FL(AV,bV),t=r.insertBeforeIndex=[null,e]):(function C4(r,e,t){r!=e&&Ft(t,r,e,"==")}(Array.isArray(t),!0,"Expecting array here"),t.push(e))}(l,f),u}function L8e(r,e,t,n,i,o,s){const a=s.match(Og),c=FV(r,e,t,o,n,a?null:s,!1);a&&b7(i,s,c.index,null,0,null)}function b7(r,e,t,n,i,o){const s=r.length,a=s+1;r.push(null,null);const c=s+2,l=e.split(Og);let u=0;for(let f=0;f<l.length;f++){const g=l[f];if(1&f){const y=i+parseInt(g,10);r.push(-1-y),u|=UV(y)}else""!==g&&r.push(g)}return r.push(t<<2|(n?1:0)),n&&r.push(n,o),r[s]=u,r[a]=r.length-c,u}function UV(r){return 1<<Math.min(r,31)}function $V(r){let e,o,t="",n=0,i=!1;for(;null!==(e=N8e.exec(r));)i?e[0]===`${A7}/*${o}${A7}`&&(n=e.index,i=!1):(t+=r.substring(n,e.index+e[0].length),o=e[1],i=!0);return t+=r.slice(n),t}function GV(r,e,t,n,i,o){let s=0;const a={type:i.type,currentCaseLViewIndex:c7(r,e,1,null),anchorIdx:o,cases:[],create:[],remove:[],update:[]};(function G8e(r,e,t){r.push(UV(e.mainBinding),2,-1-e.mainBinding,t<<2|2)})(t,i,o),function C8e(r,e,t){const n=r.data[e];null===n?r.data[e]=t:n.value=t}(r,o,a);const c=i.values;for(let l=0;l<c.length;l++){const u=c[l],f=[];for(let g=0;g<u.length;g++){const y=u[g];if("string"!=typeof y){const S=f.push(y)-1;u[g]=`\x3c!--\ufffd${S}\ufffd--\x3e`}}s=U8e(r,a,e,t,n,i.cases[l],u.join(""),f)|s}s&&function B8e(r,e,t){r.push(e,1,t<<2|3)}(t,s,o)}function F8e(r){const e=[],t=[];let n=1,i=0;const o=mE(r=r.replace(HV,function(s,a,c){return n="select"===c?0:1,i=parseInt(a.slice(1),10),""}));for(let s=0;s<o.length;){let a=o[s++].trim();1===n&&(a=a.replace(/\s*(?:=)?(\w+)\s*/,"$1")),a.length&&e.push(a);const c=mE(o[s++]);e.length>t.length&&t.push(c)}return{type:n,mainBinding:i,cases:e,values:t}}function mE(r){if(!r)return[];let e=0;const t=[],n=[],i=/[{}]/g;let o;for(i.lastIndex=0;o=i.exec(r);){const a=o.index;if("}"==o[0]){if(t.pop(),0==t.length){const c=r.substring(e,a);HV.test(c)?n.push(F8e(c)):n.push(c),e=a+1}}else{if(0==t.length){const c=r.substring(e,a);n.push(c),e=a+1}t.push("{")}}const s=r.substring(e);return n.push(s),n}function U8e(r,e,t,n,i,o,s,a){const c=[],l=[],u=[];e.cases.push(o),e.create.push(c),e.remove.push(l),e.update.push(u);const g=YL(O4()).getInertBodyElement(s),y=dM(g)||g;return y?BV(r,e,t,n,c,l,u,y,i,a,0):0}function BV(r,e,t,n,i,o,s,a,c,l,u){let f=0,g=a.firstChild;for(;g;){const y=c7(r,t,1,null);switch(g.nodeType){case Node.ELEMENT_NODE:const S=g,I=S.tagName.toLowerCase();if(uM.hasOwnProperty(I)){_E(i,Eg,I,c,y),r.data[y]=I;const oe=S.attributes;for(let _e=0;_e<oe.length;_e++){const Te=oe.item(_e),Fe=Te.name.toLowerCase();Te.value.match(Og)?JL.hasOwnProperty(Fe)&&b7(s,Te.value,y,Te.name,0,fM[Fe]?Wh:null):W8e(i,y,Te)}f=BV(r,e,t,n,i,o,s,g,y,l,u+1)|f,WV(o,y,u)}break;case Node.TEXT_NODE:const R=g.textContent||"",U=R.match(Og);_E(i,null,U?"":R,c,y),WV(o,y,u),U&&(f=b7(s,R,y,null,0,null)|f);break;case Node.COMMENT_NODE:const $=w8e.exec(g.textContent||"");if($){const _e=l[parseInt($[1],10)];_E(i,Pg,"",c,y),GV(r,t,n,c,_e,y),$8e(o,y,u)}}g=g.nextSibling}return f}function WV(r,e,t){0===t&&r.push(e)}function $8e(r,e,t){0===t&&(r.push(~e),r.push(e))}function _E(r,e,t,n,i){null!==e&&r.push(e),r.push(t,i,function M8e(r,e,t){return r|e<<17|t<<1}(0,n,i))}function W8e(r,e,t){r.push(e<<1|1,t.name,t.value)}function No(r,e,t=-1){const n=Vn(),i=ye(),o=Qt+r,s=sc(n.consts,e),a=Bu();n.firstCreatePass&&function x8e(r,e,t,n,i,o){const s=Bu(),a=[],c=[],l=[[]];i=function H8e(r,e){if(function V8e(r){return-1===r}(e))return $V(r);{const t=r.indexOf(`:${e}${A7}`)+2+e.toString().length,n=r.search(new RegExp(`${A7}\\/\\*\\d+:${e}${A7}`));return $V(r.substring(t,n))}}(i,o);const u=function R8e(r){return r.replace(k8e," ")}(i).split(I8e);for(let f=0;f<u.length;f++){let g=u[f];if(1&f){const y=47===g.charCodeAt(0),I=(g.charCodeAt(y?1:0),Qt+Number.parseInt(g.substring(y?2:1)));if(y)l.shift(),ac(Bu(),!1);else{const R=y8e(r,l[0],I);l.unshift([]),ac(R,!0)}}else{const y=mE(g);for(let S=0;S<y.length;S++){let I=y[S];if(1&S){const R=I;if("object"!=typeof R)throw new Error(`Unable to parse ICU expression in "${i}" message.`);GV(r,t,c,e,R,FV(r,s,l[0],t,a,"",!0).index)}else""!==I&&L8e(r,s,l[0],a,c,t,I)}}}r.data[n]={create:a,update:c}}(n,null===a?0:a.index,i,o,s,t),2===n.type?i[mr][bt]|=32:i[bt]|=32;const c=n.data[o],u=xL(n,a===i[R2]?null:a,i);(function S8e(r,e,t,n){const i=r[en];for(let o=0;o<e.length;o++){const s=e[o++],a=e[o],l=(s&wo.APPEND_EAGERLY)===wo.APPEND_EAGERLY,u=s>>>wo.SHIFT;let f=r[u];null===f&&(f=r[u]=(s&wo.COMMENT)===wo.COMMENT?i.createComment(a):zh(i,a)),l&&null!==t&&Xl(i,t,f,n,!1)}})(i,c.create,u,a&&8&a.type?i[a.index]:null),Ox(!0)}function Io(){Ox(!1)}function ae(r,e,t){No(r,e,t),Io()}function Un(r){return function E8e(r){r&&(O7|=1<<Math.min(T7,31)),T7++}(ti(ye(),cc(),r)),Un}function Zn(r){!function P8e(r,e,t){if(T7>0){const n=r.data[t];LV(r,e,Array.isArray(n)?n:n.update,C3()-T7-1,O7)}O7=0,T7=0}(Vn(),ye(),r+Qt)}function w7(r){return!!r&&"function"==typeof r.then}function jV(r){return!!r&&"function"==typeof r.subscribe}function W(r,e,t,n){const i=ye(),o=Vn(),s=_1();return function YV(r,e,t,n,i,o,s){const a=ch(n),l=r.firstCreatePass&&$z(r),u=e[x1],f=Uz(e);let g=!0;if(3&n.type||s){const I=io(n,e),R=s?s(I):I,U=f.length,$=s?_e=>s(L1(_e[n.index])):n.index;let oe=null;if(!s&&a&&(oe=function n5e(r,e,t,n){const i=r.cleanup;if(null!=i)for(let o=0;o<i.length-1;o+=2){const s=i[o];if(s===t&&i[o+1]===n){const a=e[A0],c=i[o+2];return a.length>c?a[c]:null}"string"==typeof s&&(o+=2)}return null}(r,e,i,n.index)),null!==oe)(oe.__ngLastListenerFn__||oe).__ngNextListenerFn__=o,oe.__ngLastListenerFn__=o,g=!1;else{o=XV(n,e,u,o,!1);const _e=t.listen(R,i,o);f.push(o,_e),l&&l.push(i,$,U,U+1)}}else o=XV(n,e,u,o,!1);const y=n.outputs;let S;if(g&&null!==y&&(S=y[i])){const I=S.length;if(I)for(let R=0;R<I;R+=2){const Te=e[S[R]][S[R+1]].subscribe(o),Fe=f.length;f.push(o,Te),l&&l.push(i,n.index,Fe,-(Fe+1))}}}(o,i,i[en],s,r,e,n),W}function KV(r,e,t,n){try{return oc(6,e,t),!1!==t(n)}catch(i){return og(r,i),!1}finally{oc(7,e,t)}}function XV(r,e,t,n,i){return function o(s){if(s===Function)return n;l7(r.componentOffset>-1?Xo(r.index,e):e);let c=KV(e,t,n,s),l=o.__ngNextListenerFn__;for(;l;)c=KV(e,t,l,s)&&c,l=l.__ngNextListenerFn__;return i&&!1===c&&s.preventDefault(),c}}function p(r=1){return function qae(r){return(Bt.lFrame.contextLView=function Cx(r,e){for(;r>0;)e=e[b0],r--;return e}(r,Bt.lFrame.contextLView))[x1]}(r)}function r5e(r,e){let t=null;const n=function lae(r){const e=r.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(r);for(let i=0;i<e.length;i++){const o=e[i];if("*"!==o){if(null===n?ex(r,o,!0):dae(n,o))return i}else t=i}return t}function Tg(r,e,t){return En(r,"",e,"",t),Tg}function En(r,e,t,n,i){const o=ye(),s=c8(o,e,t,n);return s!==tn&&rs(Vn(),Y1(),o,r,s,o[en],i,!1),En}function Ce(r,e,t,n,i,o,s){const a=ye(),c=l8(a,e,t,n,i,o);return c!==tn&&rs(Vn(),Y1(),a,r,c,a[en],s,!1),Ce}function Hr(r,e,t,n,i,o,s,a,c){const l=ye(),u=u8(l,e,t,n,i,o,s,a);return u!==tn&&rs(Vn(),Y1(),l,r,u,l[en],c,!1),Hr}function Ag(r,e,t,n,i,o,s,a,c,l,u){const f=ye(),g=f8(f,e,t,n,i,o,s,a,c,l);return g!==tn&&rs(Vn(),Y1(),f,r,g,f[en],u,!1),Ag}function i5e(){return this._results[Symbol.iterator]()}class CE{static#e=Symbol.iterator;get changes(){return this._changes??=new l1}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const t=CE.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=i5e)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;const n=function Ao(r){return r.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function gce(r,e,t){if(r.length!==e.length)return!1;for(let n=0;n<r.length;n++){let i=r[n],o=e[n];if(t&&(i=t(i),o=t(o)),o!==i)return!1}return!0}(this._results,n,t))&&(this._results=n,this.length=n.length,this.last=n[this.length-1],this.first=n[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}let S3=(()=>{class r{static#e=this.__NG_ELEMENT_ID__=a5e}return r})();const o5e=S3,s5e=class extends o5e{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,n){const i=function _7(r,e,t,n){const i=e.tView,a=rg(r,i,t,4096&r[bt]?4096:16,null,e,null,null,null,n?.injector??null,n?.dehydratedView??null);a[Vu]=r[e.index];const l=r[rc];return null!==l&&(a[rc]=l.createEmbeddedView(i)),GM(i,a,t),a}(this._declarationLView,this._declarationTContainer,e,{injector:t,dehydratedView:n});return new u7(i)}};function a5e(){return bg(_1(),ye())}function bg(r,e){return 4&r.type?new s5e(e,r,X0(r,e)):null}class vE{constructor(e){this.queryList=e,this.matches=null}clone(){return new vE(this.queryList)}setDirty(){this.queryList.setDirty()}}class yE{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,i=[];for(let o=0;o<n;o++){const s=t.getByIndex(o);i.push(this.queries[s.indexInDeclarationView].clone())}return new yE(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==lH(e,t).matches&&this.queries[t].setDirty()}}class oH{constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class ME{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const i=null!==t?t.length:0,o=this.getByIndex(n).embeddedTView(e,i);o&&(o.indexInDeclarationView=n,null!==t?t.push(o):t=[o])}return null!==t?new ME(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class EE{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new EE(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let i=0;i<n.length;i++){const o=n[i];this.matchTNodeWithReadOption(e,t,c5e(t,o)),this.matchTNodeWithReadOption(e,t,_h(t,e,o,!1,!1))}else n===S3?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,_h(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const i=this.metadata.read;if(null!==i)if(i===V2||i===is||i===S3&&4&t.type)this.addMatch(t.index,-2);else{const o=_h(t,e,i,!1,!1);null!==o&&this.addMatch(t.index,o)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function c5e(r,e){const t=r.localNames;if(null!==t)for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1];return null}function u5e(r,e,t,n){return-1===t?function l5e(r,e){return 11&r.type?X0(r,e):4&r.type?bg(r,e):null}(e,r):-2===t?function f5e(r,e,t){return t===V2?X0(e,r):t===S3?bg(e,r):t===is?vD(e,r):void 0}(r,e,n):Zl(r,r[He],t,e)}function sH(r,e,t,n){const i=e[rc].queries[n];if(null===i.matches){const o=r.data,s=t.matches,a=[];for(let c=0;c<s.length;c+=2){const l=s[c];a.push(l<0?null:u5e(e,o[l],s[c+1],t.metadata.read))}i.matches=a}return i.matches}function PE(r,e,t,n){const i=r.queries.getByIndex(t),o=i.matches;if(null!==o){const s=sH(r,e,i,t);for(let a=0;a<o.length;a+=2){const c=o[a];if(c>0)n.push(s[a/2]);else{const l=o[a+1],u=e[-c];for(let f=Dr;f<u.length;f++){const g=u[f];g[Vu]===g[zr]&&PE(g[He],g,l,n)}if(null!==u[N0]){const f=u[N0];for(let g=0;g<f.length;g++){const y=f[g];PE(y[He],y,l,n)}}}}}return n}function lH(r,e){return r.queries.getByIndex(e)}function O3(r,e,t){const n=Vn();n.firstCreatePass&&(function cH(r,e,t){null===r.queries&&(r.queries=new ME),r.queries.track(new EE(e,t))}(n,new oH(r,e,t),-1),2==(2&e)&&(n.staticViewQueries=!0)),function aH(r,e,t){const n=new CE(4==(4&t));(function j4e(r,e,t,n){const i=Uz(e);i.push(t),r.firstCreatePass&&$z(r).push(n,i.length-1)})(r,e,n,n.destroy),null===e[rc]&&(e[rc]=new yE),e[rc].queries.push(new vE(n))}(n,ye(),e)}function pc(r){const e=ye(),t=Vn(),n=Tx();Ey(n+1);const i=lH(t,n);if(r.dirty&&function Nae(r){return 4==(4&r[bt])}(e)===(2==(2&i.metadata.flags))){if(null===i.matches)r.reset([]);else{const o=i.crossesNgTemplate?PE(t,e,n,[]):sH(t,e,i,n);r.reset(o,_4e),r.notifyOnChanges()}return!0}return!1}function mc(){return function d5e(r,e){return r[rc].queries[e].queryList}(ye(),Tx())}function Pn(r){return I0(function Uae(){return Bt.lFrame.contextLView}(),Qt+r)}function st(r,e=""){const t=ye(),n=Vn(),i=r+Qt,o=n.firstCreatePass?Q0(n,i,1,e,null):n.data[i],s=yH(n,t,o,e,r);t[i]=s,uh()&&Fh(n,t,s,o),ac(o,!1)}let yH=(r,e,t,n,i)=>(E4(!0),zh(e[en],n));function mn(r){return ri("",r,""),mn}function ri(r,e,t){const n=ye(),i=c8(n,r,e,t);return i!==tn&&P3(n,z2(),i),ri}function SE(r,e,t,n,i){const o=ye(),s=l8(o,r,e,t,n,i);return s!==tn&&P3(o,z2(),s),SE}function OE(r,e,t,n,i,o,s){const a=ye(),c=u8(a,r,e,t,n,i,o,s);return c!==tn&&P3(a,z2(),c),OE}function TE(r,e,t,n,i){if(r=Ht(r),Array.isArray(r))for(let o=0;o<r.length;o++)TE(r[o],e,t,n,i);else{const o=Vn(),s=ye(),a=_1();let c=Kl(r)?r:Ht(r.provide);const l=iL(r),u=1048575&a.providerIndexes,f=a.directiveStart,g=a.providerIndexes>>20;if(Kl(r)||!r.multi){const y=new Wu(l,i,G),S=bE(c,e,i?u:u+g,f);-1===S?(Ny(ph(a,s),o,c),AE(o,r,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(y),s.push(y)):(t[S]=y,s[S]=y)}else{const y=bE(c,e,u+g,f),S=bE(c,e,u,u+g),R=S>=0&&t[S];if(i&&!R||!i&&!(y>=0&&t[y])){Ny(ph(a,s),o,c);const U=function w5e(r,e,t,n,i){const o=new Wu(r,t,G);return o.multi=[],o.index=e,o.componentProviders=0,AH(o,i,n&&!t),o}(i?b5e:A5e,t.length,i,n,l);!i&&R&&(t[S].providerFactory=U),AE(o,r,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(U),s.push(U)}else AE(o,r,y>-1?y:S,AH(t[i?S:y],l,!i&&n));!i&&n&&R&&t[S].componentProviders++}}}function AE(r,e,t,n){const i=Kl(e),o=function Rce(r){return!!r.useClass}(e);if(i||o){const c=(o?Ht(e.useClass):e).prototype.ngOnDestroy;if(c){const l=r.destroyHooks||(r.destroyHooks=[]);if(!i&&e.multi){const u=l.indexOf(t);-1===u?l.push(t,[n,c]):l[u+1].push(n,c)}else l.push(t,c)}}}function AH(r,e,t){return t&&r.componentProviders++,r.multi.push(e)-1}function bE(r,e,t,n){for(let i=t;i<n;i++)if(e[i]===r)return i;return-1}function A5e(r,e,t,n){return wE(this.multi,[])}function b5e(r,e,t,n){const i=this.multi;let o;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=Zl(t,t[He],this.providerFactory.index,n);o=a.slice(0,s),wE(i,o);for(let c=s;c<a.length;c++)o.push(a[c])}else o=[],wE(i,o);return o}function wE(r,e){for(let t=0;t<r.length;t++)e.push((0,r[t])());return e}function lr(r,e=[]){return t=>{t.providersResolver=(n,i)=>function T5e(r,e,t){const n=Vn();if(n.firstCreatePass){const i=Ea(r);TE(t,n.data,n.blueprint,i,!0),TE(e,n.data,n.blueprint,i,!1)}}(n,i?i(r):r,e)}}class o6{}class bH{}class NE extends o6{constructor(e,t,n){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new rD(this);const i=k2(e);this._bootstrapComponents=ts(i.bootstrap),this._r3Injector=lL(e,t,[{provide:o6,useValue:this},{provide:Jh,useValue:this.componentFactoryResolver},...n],pi(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class IE extends bH{constructor(e){super(),this.moduleType=e}create(e){return new NE(this.moduleType,e,[])}}class wH extends o6{constructor(e){super(),this.componentFactoryResolver=new rD(this),this.instance=null;const t=new B0([...e.providers,{provide:o6,useValue:this},{provide:Jh,useValue:this.componentFactoryResolver}],e.parent||bh(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function kE(r,e,t=null){return new wH({providers:r,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let k5e=(()=>{class r{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const n=eL(0,t.type),i=n.length>0?kE([n],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=xe({token:r,providedIn:"environment",factory:()=>new r(Ae(es))})}return r})();function wg(r){Jl("NgStandalone"),r.getStandaloneInjector=e=>e.get(k5e).getOrCreateStandaloneInjector(r)}function T3(r,e,t){const n=r.\u0275cmp;n.directiveDefs=oh(e,!1),n.pipeDefs=oh(t,!0)}function ur(r,e,t){const n=oo()+r,i=ye();return i[n]===tn?hc(i,n,t?e.call(t):e()):function v7(r,e){return r[e]}(i,n)}function Oa(r,e,t,n){return VH(ye(),oo(),r,e,t,n)}function N7(r,e){const t=r[e];return t===tn?void 0:t}function VH(r,e,t,n,i,o){const s=e+t;return ti(r,s,i)?hc(r,s+1,o?n.call(o,i):n(i)):N7(r,s+1)}function Ta(r,e){const t=Vn();let n;const i=r+Qt;t.firstCreatePass?(n=function K5e(r,e){if(e)for(let t=e.length-1;t>=0;t--){const n=e[t];if(r===n.name)return n}}(e,t.pipeRegistry),t.data[i]=n,n.onDestroy&&(t.destroyHooks??=[]).push(i,n.onDestroy)):n=t.data[i];const o=n.factory||(n.factory=Wl(n.type)),a=To(G);try{const c=gh(!1),l=o();return gh(c),function g5e(r,e,t,n){t>=r.data.length&&(r.data[t]=null,r.blueprint[t]=null),e[t]=n}(t,ye(),i,l),l}finally{To(a)}}function _c(r,e,t){const n=r+Qt,i=ye(),o=I0(i,n);return I7(i,n)?VH(i,oo(),e,o.transform,t,o):o.transform(t)}function GH(r,e,t,n){const i=r+Qt,o=ye(),s=I0(o,i);return I7(o,i)?function HH(r,e,t,n,i,o,s){const a=e+t;return t6(r,a,i,o)?hc(r,a+2,s?n.call(s,i,o):n(i,o)):N7(r,a+2)}(o,oo(),e,s.transform,t,n,s):s.transform(t,n)}function I7(r,e){return r[He].data[e].pure}function wn(r,e){return bg(r,e)}class M8{constructor(e){this.full=e;const t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}}const Mue=new M8("17.1.0");let oF=(()=>{class r{log(t){console.log(t)}warn(t){console.warn(t)}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"platform"})}return r})();class Eue{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let sF=(()=>{class r{compileModuleSync(t){return new IE(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const n=this.compileModuleSync(t),o=ts(k2(t).declarations).reduce((s,a)=>{const c=pn(a);return c&&s.push(new d7(c)),s},[]);return new Eue(n,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),E8=(()=>{class r{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Yo(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();const fF=new Qe(""),xg=new Qe("");let UE,HE=(()=>{class r{constructor(t,n,i){this._ngZone=t,this.registry=n,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,UE||(function Yue(r){UE=r}(i),i.addToWindow(n)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{bn.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb()}});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(n=>!n.updateCb||!n.updateCb(t)||(clearTimeout(n.timeoutId),!1))}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,n,i){let o=-1;n&&n>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),t()},n)),this._callbacks.push({doneCb:t,timeoutId:o,updateCb:i})}whenStable(t,n,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,n,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,n,i){return[]}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(bn),Ae(FE),Ae(xg))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})(),FE=(()=>{class r{constructor(){this._applications=new Map}registerApplication(t,n){this._applications.set(t,n)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,n=!0){return UE?.findTestabilityInTree(this,t,n)??null}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"platform"})}return r})();const $E=new Qe("Application Initializer");let GE=(()=>{class r{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,n)=>{this.resolve=t,this.reject=n}),this.appInits=Le($E,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const i of this.appInits){const o=i();if(w7(o))t.push(o);else if(jV(o)){const s=new Promise((a,c)=>{o.subscribe({complete:a,error:c})});t.push(s)}}const n=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{n()}).catch(i=>{this.reject(i)}),0===t.length&&n(),this.initialized=!0}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();const BE=new Qe("appBootstrapListener");function gF(r,e){return Array.isArray(e)?e.reduce(gF,r):{...r,...e}}let I4=(()=>{class r{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Le(Pz),this.afterRenderEffectManager=Le(f7),this.componentTypes=[],this.components=[],this.isStable=Le(E8).hasPendingTasks.pipe(jn(t=>!t)),this._injector=Le(es)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,n){const i=t instanceof cz;if(!this._injector.get(GE).done)throw!i&&function y4(r){const e=pn(r)||mi(r)||a2(r);return null!==e&&e.standalone}(t),new ge(405,!1);let s;s=i?t:this._injector.get(Jh).resolveComponentFactory(t),this.componentTypes.push(s.componentType);const a=function Xue(r){return r.isBoundToModule}(s)?void 0:this._injector.get(o6),l=s.create(Li.NULL,[],n||s.selector,a),u=l.location.nativeElement,f=l.injector.get(fF,null);return f?.registerApplication(u),l.onDestroy(()=>{this.detachView(l.hostView),Lg(this.components,l),f?.unregisterApplication(u)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new ge(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{try{this.afterRenderEffectManager.execute()}catch(t){this.internalErrorHandler(t)}this._runningTick=!1}}attachView(t){const n=t;this._views.push(n),n.attachToAppRef(this)}detachView(t){const n=t;Lg(this._views,n),n.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const n=this._injector.get(BE,[]);[...this._bootstrapListeners,...n].forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Lg(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ge(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Lg(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}let Jue=(()=>{class r{constructor(){this.zone=Le(bn),this.applicationRef=Le(I4)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function e7e(){const r=Le(bn),e=Le(E3);return t=>r.runOutsideAngular(()=>e.handleError(t))}let n7e=(()=>{class r{constructor(){this.subscription=new Ue,this.initialized=!1,this.zone=Le(bn),this.pendingTasks=Le(E8)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{bn.assertNotInAngularZone(),queueMicrotask(()=>{null!==t&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{bn.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();const Cc=new Qe("LocaleId",{providedIn:"root",factory:()=>Le(Cc,Mn.Optional|Mn.SkipSelf)||function r7e(){return typeof $localize<"u"&&$localize.locale||C8}()}),WE=new Qe("PlatformDestroyListeners");let CF=(()=>{class r{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,n){const i=function xle(r="zone.js",e){return"noop"===r?new Xz:"zone.js"===r?new bn(e):r}(n?.ngZone,function _F(r){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:r?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:r?.runCoalescing??!1}}({eventCoalescing:n?.ngZoneEventCoalescing,runCoalescing:n?.ngZoneRunCoalescing}));return i.run(()=>{const o=function I5e(r,e,t){return new NE(r,e,t)}(t.moduleType,this.injector,function mF(r){return[{provide:bn,useFactory:r},{provide:Yl,multi:!0,useFactory:()=>{const e=Le(Jue,{optional:!0});return()=>e.initialize()}},{provide:Yl,multi:!0,useFactory:()=>{const e=Le(n7e);return()=>{e.initialize()}}},{provide:Pz,useFactory:e7e}]}(()=>i)),s=o.injector.get(E3,null);return i.runOutsideAngular(()=>{const a=i.onError.subscribe({next:c=>{s.handleError(c)}});o.onDestroy(()=>{Lg(this._modules,o),a.unsubscribe()})}),function hF(r,e,t){try{const n=t();return w7(n)?n.catch(i=>{throw e.runOutsideAngular(()=>r.handleError(i)),i}):n}catch(n){throw e.runOutsideAngular(()=>r.handleError(n)),n}}(s,i,()=>{const a=o.injector.get(GE);return a.runInitializers(),a.donePromise.then(()=>(TV(o.injector.get(Cc,C8)||C8),this._moduleDoBootstrap(o),o))})})}bootstrapModule(t,n=[]){const i=gF({},n);return function Kue(r,e,t){const n=new IE(t);return Promise.resolve(n)}(0,0,t).then(o=>this.bootstrapModuleFactory(o,i))}_moduleDoBootstrap(t){const n=t.injector.get(I4);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(i=>n.bootstrap(i));else{if(!t.instance.ngDoBootstrap)throw new ge(-403,!1);t.instance.ngDoBootstrap(n)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ge(404,!1);this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n());const t=this._injector.get(WE,null);t&&(t.forEach(n=>n()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(Li))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"platform"})}return r})(),k4=null;const vF=new Qe("AllowMultipleToken");function yF(r,e,t=[]){const n=`Platform: ${e}`,i=new Qe(n);return(o=[])=>{let s=qE();if(!s||s.injector.get(vF,!1)){const a=[...t,...o,{provide:i,useValue:!0}];r?r(a):function s7e(r){if(k4&&!k4.get(vF,!1))throw new ge(400,!1);(function dF(){!function zv(r){Zd=r}(()=>{throw new ge(600,!1)})})(),k4=r;const e=r.get(CF);(function EF(r){r.get(fL,null)?.forEach(t=>t())})(r)}(function MF(r=[],e){return Li.create({name:e,providers:[{provide:Fy,useValue:"platform"},{provide:WE,useValue:new Set([()=>k4=null])},...r]})}(a,n))}return function a7e(r){const e=qE();if(!e)throw new ge(401,!1);return e}()}}function qE(){return k4?.get(CF)??null}const h7e=yF(null,"core",[]);let g7e=(()=>{class r{constructor(t){}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(I4))};static#t=this.\u0275mod=N2({type:r});static#n=this.\u0275inj=s2({})}return r})();function S8(r){return"boolean"==typeof r?r:null!=r&&"false"!==r}let JE=null;function R4(){return JE}class B7e{}const zi=new Qe("DocumentToken");let eP=(()=>{class r{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:()=>Le(q7e),providedIn:"platform"})}return r})();const W7e=new Qe("Location Initialized");let q7e=(()=>{class r extends eP{constructor(){super(),this._doc=Le(zi),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return R4().getBaseHref(this._doc)}onPopState(t){const n=R4().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",t,!1),()=>n.removeEventListener("popstate",t)}onHashChange(t){const n=R4().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",t,!1),()=>n.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,n,i){this._history.pushState(t,n,i)}replaceState(t,n,i){this._history.replaceState(t,n,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:()=>new r,providedIn:"platform"})}return r})();function tP(r,e){if(0==r.length)return e;if(0==e.length)return r;let t=0;return r.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?r+e.substring(1):1==t?r+e:r+"/"+e}function qF(r){const e=r.match(/#|\?|$/),t=e&&e.index||r.length;return r.slice(0,t-("/"===r[t-1]?1:0))+r.slice(t)}function A3(r){return r&&"?"!==r[0]?"?"+r:r}let a6=(()=>{class r{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:()=>Le(ZF),providedIn:"root"})}return r})();const jF=new Qe("appBaseHref");let ZF=(()=>{class r extends a6{constructor(t,n){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=n??this._platformLocation.getBaseHrefFromDOM()??Le(zi).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return tP(this._baseHref,t)}path(t=!1){const n=this._platformLocation.pathname+A3(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${n}${i}`:n}pushState(t,n,i,o){const s=this.prepareExternalUrl(i+A3(o));this._platformLocation.pushState(t,n,s)}replaceState(t,n,i,o){const s=this.prepareExternalUrl(i+A3(o));this._platformLocation.replaceState(t,n,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(eP),Ae(jF,8))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),j7e=(()=>{class r extends a6{constructor(t,n){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=n&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let n=this._platformLocation.hash;return null==n&&(n="#"),n.length>0?n.substring(1):n}prepareExternalUrl(t){const n=tP(this._baseHref,t);return n.length>0?"#"+n:n}pushState(t,n,i,o){let s=this.prepareExternalUrl(i+A3(o));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.pushState(t,n,s)}replaceState(t,n,i,o){let s=this.prepareExternalUrl(i+A3(o));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.replaceState(t,n,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(eP),Ae(jF,8))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})(),z7=(()=>{class r{constructor(t){this._subject=new l1,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const n=this._locationStrategy.getBaseHref();this._basePath=function K7e(r){if(new RegExp("^(https?:)?//").test(r)){const[,t]=r.split(/\/\/[^\/]+/);return t}return r}(qF(YF(n))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,n=""){return this.path()==this.normalize(t+A3(n))}normalize(t){return r.stripTrailingSlash(function Y7e(r,e){if(!r||!e.startsWith(r))return e;const t=e.substring(r.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,YF(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,n="",i=null){this._locationStrategy.pushState(i,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+A3(n)),i)}replaceState(t,n="",i=null){this._locationStrategy.replaceState(i,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+A3(n)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)})),()=>{const n=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(n,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",n){this._urlChangeListeners.forEach(i=>i(t,n))}subscribe(t,n,i){return this._subject.subscribe({next:t,error:n,complete:i})}static#e=this.normalizeQueryParams=A3;static#t=this.joinWithSlash=tP;static#n=this.stripTrailingSlash=qF;static#r=this.\u0275fac=function(n){return new(n||r)(Ae(a6))};static#i=this.\u0275prov=xe({token:r,factory:()=>function Z7e(){return new z7(Ae(a6))}(),providedIn:"root"})}return r})();function YF(r){return r.replace(/\/index.html$/,"")}var Bg=function(r){return r[r.Decimal=0]="Decimal",r[r.Percent=1]="Percent",r[r.Currency=2]="Currency",r[r.Scientific=3]="Scientific",r}(Bg||{}),co=function(r){return r[r.Format=0]="Format",r[r.Standalone=1]="Standalone",r}(co||{}),P1=function(r){return r[r.Narrow=0]="Narrow",r[r.Abbreviated=1]="Abbreviated",r[r.Wide=2]="Wide",r[r.Short=3]="Short",r}(P1||{}),os=function(r){return r[r.Short=0]="Short",r[r.Medium=1]="Medium",r[r.Long=2]="Long",r[r.Full=3]="Full",r}(os||{}),Fr=function(r){return r[r.Decimal=0]="Decimal",r[r.Group=1]="Group",r[r.List=2]="List",r[r.PercentSign=3]="PercentSign",r[r.PlusSign=4]="PlusSign",r[r.MinusSign=5]="MinusSign",r[r.Exponential=6]="Exponential",r[r.SuperscriptingExponent=7]="SuperscriptingExponent",r[r.PerMille=8]="PerMille",r[r.Infinity=9]="Infinity",r[r.NaN=10]="NaN",r[r.TimeSeparator=11]="TimeSeparator",r[r.CurrencyDecimal=12]="CurrencyDecimal",r[r.CurrencyGroup=13]="CurrencyGroup",r}(Fr||{});function Wg(r,e){return Fs(so(r)[D1.DateFormat],e)}function qg(r,e){return Fs(so(r)[D1.TimeFormat],e)}function jg(r,e){return Fs(so(r)[D1.DateTimeFormat],e)}function Hs(r,e){const t=so(r),n=t[D1.NumberSymbols][e];if(typeof n>"u"){if(e===Fr.CurrencyDecimal)return t[D1.NumberSymbols][Fr.Decimal];if(e===Fr.CurrencyGroup)return t[D1.NumberSymbols][Fr.Group]}return n}function XF(r){if(!r[D1.ExtraData])throw new Error(`Missing extra locale data for the locale "${r[D1.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Fs(r,e){for(let t=e;t>-1;t--)if(typeof r[t]<"u")return r[t];throw new Error("Locale data API: locale data undefined")}function rP(r){const[e,t]=r.split(":");return{hours:+e,minutes:+t}}const ufe=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,D7={},ffe=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var b3=function(r){return r[r.Short=0]="Short",r[r.ShortGMT=1]="ShortGMT",r[r.Long=2]="Long",r[r.Extended=3]="Extended",r}(b3||{}),e1=function(r){return r[r.FullYear=0]="FullYear",r[r.Month=1]="Month",r[r.Date=2]="Date",r[r.Hours=3]="Hours",r[r.Minutes=4]="Minutes",r[r.Seconds=5]="Seconds",r[r.FractionalSeconds=6]="FractionalSeconds",r[r.Day=7]="Day",r}(e1||{}),t1=function(r){return r[r.DayPeriods=0]="DayPeriods",r[r.Days=1]="Days",r[r.Months=2]="Months",r[r.Eras=3]="Eras",r}(t1||{});function QF(r,e,t,n){let i=function yfe(r){if(tU(r))return r;if("number"==typeof r&&!isNaN(r))return new Date(r);if("string"==typeof r){if(r=r.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(r)){const[i,o=1,s=1]=r.split("-").map(a=>+a);return Zg(i,o-1,s)}const t=parseFloat(r);if(!isNaN(r-t))return new Date(t);let n;if(n=r.match(ufe))return function Mfe(r){const e=new Date(0);let t=0,n=0;const i=r[8]?e.setUTCFullYear:e.setFullYear,o=r[8]?e.setUTCHours:e.setHours;r[9]&&(t=Number(r[9]+r[10]),n=Number(r[9]+r[11])),i.call(e,Number(r[1]),Number(r[2])-1,Number(r[3]));const s=Number(r[4]||0)-t,a=Number(r[5]||0)-n,c=Number(r[6]||0),l=Math.floor(1e3*parseFloat("0."+(r[7]||0)));return o.call(e,s,a,c,l),e}(n)}const e=new Date(r);if(!tU(e))throw new Error(`Unable to convert "${r}" into a date`);return e}(r);e=w3(t,e)||e;let a,s=[];for(;e;){if(a=ffe.exec(e),!a){s.push(e);break}{s=s.concat(a.slice(1));const u=s.pop();if(!u)break;e=u}}let c=i.getTimezoneOffset();n&&(c=eU(n,c),i=function vfe(r,e,t){const n=t?-1:1,i=r.getTimezoneOffset();return function Cfe(r,e){return(r=new Date(r.getTime())).setMinutes(r.getMinutes()+e),r}(r,n*(eU(e,i)-i))}(i,n,!0));let l="";return s.forEach(u=>{const f=function _fe(r){if(oP[r])return oP[r];let e;switch(r){case"G":case"GG":case"GGG":e=V1(t1.Eras,P1.Abbreviated);break;case"GGGG":e=V1(t1.Eras,P1.Wide);break;case"GGGGG":e=V1(t1.Eras,P1.Narrow);break;case"y":e=ii(e1.FullYear,1,0,!1,!0);break;case"yy":e=ii(e1.FullYear,2,0,!0,!0);break;case"yyy":e=ii(e1.FullYear,3,0,!1,!0);break;case"yyyy":e=ii(e1.FullYear,4,0,!1,!0);break;case"Y":e=Qg(1);break;case"YY":e=Qg(2,!0);break;case"YYY":e=Qg(3);break;case"YYYY":e=Qg(4);break;case"M":case"L":e=ii(e1.Month,1,1);break;case"MM":case"LL":e=ii(e1.Month,2,1);break;case"MMM":e=V1(t1.Months,P1.Abbreviated);break;case"MMMM":e=V1(t1.Months,P1.Wide);break;case"MMMMM":e=V1(t1.Months,P1.Narrow);break;case"LLL":e=V1(t1.Months,P1.Abbreviated,co.Standalone);break;case"LLLL":e=V1(t1.Months,P1.Wide,co.Standalone);break;case"LLLLL":e=V1(t1.Months,P1.Narrow,co.Standalone);break;case"w":e=iP(1);break;case"ww":e=iP(2);break;case"W":e=iP(1,!0);break;case"d":e=ii(e1.Date,1);break;case"dd":e=ii(e1.Date,2);break;case"c":case"cc":e=ii(e1.Day,1);break;case"ccc":e=V1(t1.Days,P1.Abbreviated,co.Standalone);break;case"cccc":e=V1(t1.Days,P1.Wide,co.Standalone);break;case"ccccc":e=V1(t1.Days,P1.Narrow,co.Standalone);break;case"cccccc":e=V1(t1.Days,P1.Short,co.Standalone);break;case"E":case"EE":case"EEE":e=V1(t1.Days,P1.Abbreviated);break;case"EEEE":e=V1(t1.Days,P1.Wide);break;case"EEEEE":e=V1(t1.Days,P1.Narrow);break;case"EEEEEE":e=V1(t1.Days,P1.Short);break;case"a":case"aa":case"aaa":e=V1(t1.DayPeriods,P1.Abbreviated);break;case"aaaa":e=V1(t1.DayPeriods,P1.Wide);break;case"aaaaa":e=V1(t1.DayPeriods,P1.Narrow);break;case"b":case"bb":case"bbb":e=V1(t1.DayPeriods,P1.Abbreviated,co.Standalone,!0);break;case"bbbb":e=V1(t1.DayPeriods,P1.Wide,co.Standalone,!0);break;case"bbbbb":e=V1(t1.DayPeriods,P1.Narrow,co.Standalone,!0);break;case"B":case"BB":case"BBB":e=V1(t1.DayPeriods,P1.Abbreviated,co.Format,!0);break;case"BBBB":e=V1(t1.DayPeriods,P1.Wide,co.Format,!0);break;case"BBBBB":e=V1(t1.DayPeriods,P1.Narrow,co.Format,!0);break;case"h":e=ii(e1.Hours,1,-12);break;case"hh":e=ii(e1.Hours,2,-12);break;case"H":e=ii(e1.Hours,1);break;case"HH":e=ii(e1.Hours,2);break;case"m":e=ii(e1.Minutes,1);break;case"mm":e=ii(e1.Minutes,2);break;case"s":e=ii(e1.Seconds,1);break;case"ss":e=ii(e1.Seconds,2);break;case"S":e=ii(e1.FractionalSeconds,1);break;case"SS":e=ii(e1.FractionalSeconds,2);break;case"SSS":e=ii(e1.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=Kg(b3.Short);break;case"ZZZZZ":e=Kg(b3.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Kg(b3.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=Kg(b3.Long);break;default:return null}return oP[r]=e,e}(u);l+=f?f(i,t,c):"''"===u?"'":u.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function Zg(r,e,t){const n=new Date(0);return n.setFullYear(r,e,t),n.setHours(0,0,0),n}function w3(r,e){const t=function Q7e(r){return so(r)[D1.LocaleId]}(r);if(D7[t]=D7[t]||{},D7[t][e])return D7[t][e];let n="";switch(e){case"shortDate":n=Wg(r,os.Short);break;case"mediumDate":n=Wg(r,os.Medium);break;case"longDate":n=Wg(r,os.Long);break;case"fullDate":n=Wg(r,os.Full);break;case"shortTime":n=qg(r,os.Short);break;case"mediumTime":n=qg(r,os.Medium);break;case"longTime":n=qg(r,os.Long);break;case"fullTime":n=qg(r,os.Full);break;case"short":const i=w3(r,"shortTime"),o=w3(r,"shortDate");n=Yg(jg(r,os.Short),[i,o]);break;case"medium":const s=w3(r,"mediumTime"),a=w3(r,"mediumDate");n=Yg(jg(r,os.Medium),[s,a]);break;case"long":const c=w3(r,"longTime"),l=w3(r,"longDate");n=Yg(jg(r,os.Long),[c,l]);break;case"full":const u=w3(r,"fullTime"),f=w3(r,"fullDate");n=Yg(jg(r,os.Full),[u,f])}return n&&(D7[t][e]=n),n}function Yg(r,e){return e&&(r=r.replace(/\{([^}]+)}/g,function(t,n){return null!=e&&n in e?e[n]:t})),r}function Aa(r,e,t="-",n,i){let o="";(r<0||i&&r<=0)&&(i?r=1-r:(r=-r,o=t));let s=String(r);for(;s.length<e;)s="0"+s;return n&&(s=s.slice(s.length-e)),o+s}function ii(r,e,t=0,n=!1,i=!1){return function(o,s){let a=function hfe(r,e){switch(r){case e1.FullYear:return e.getFullYear();case e1.Month:return e.getMonth();case e1.Date:return e.getDate();case e1.Hours:return e.getHours();case e1.Minutes:return e.getMinutes();case e1.Seconds:return e.getSeconds();case e1.FractionalSeconds:return e.getMilliseconds();case e1.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${r}".`)}}(r,o);if((t>0||a>-t)&&(a+=t),r===e1.Hours)0===a&&-12===t&&(a=12);else if(r===e1.FractionalSeconds)return function dfe(r,e){return Aa(r,3).substring(0,e)}(a,e);const c=Hs(s,Fr.MinusSign);return Aa(a,e,c,n,i)}}function V1(r,e,t=co.Format,n=!1){return function(i,o){return function gfe(r,e,t,n,i,o){switch(t){case t1.Months:return function tfe(r,e,t){const n=so(r),o=Fs([n[D1.MonthsFormat],n[D1.MonthsStandalone]],e);return Fs(o,t)}(e,i,n)[r.getMonth()];case t1.Days:return function efe(r,e,t){const n=so(r),o=Fs([n[D1.DaysFormat],n[D1.DaysStandalone]],e);return Fs(o,t)}(e,i,n)[r.getDay()];case t1.DayPeriods:const s=r.getHours(),a=r.getMinutes();if(o){const l=function ofe(r){const e=so(r);return XF(e),(e[D1.ExtraData][2]||[]).map(n=>"string"==typeof n?rP(n):[rP(n[0]),rP(n[1])])}(e),u=function sfe(r,e,t){const n=so(r);XF(n);const o=Fs([n[D1.ExtraData][0],n[D1.ExtraData][1]],e)||[];return Fs(o,t)||[]}(e,i,n),f=l.findIndex(g=>{if(Array.isArray(g)){const[y,S]=g,I=s>=y.hours&&a>=y.minutes,R=s<S.hours||s===S.hours&&a<S.minutes;if(y.hours<S.hours){if(I&&R)return!0}else if(I||R)return!0}else if(g.hours===s&&g.minutes===a)return!0;return!1});if(-1!==f)return u[f]}return function J7e(r,e,t){const n=so(r),o=Fs([n[D1.DayPeriodsFormat],n[D1.DayPeriodsStandalone]],e);return Fs(o,t)}(e,i,n)[s<12?0:1];case t1.Eras:return function nfe(r,e){return Fs(so(r)[D1.Eras],e)}(e,n)[r.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${t}`)}}(i,o,r,e,t,n)}}function Kg(r){return function(e,t,n){const i=-1*n,o=Hs(t,Fr.MinusSign),s=i>0?Math.floor(i/60):Math.ceil(i/60);switch(r){case b3.Short:return(i>=0?"+":"")+Aa(s,2,o)+Aa(Math.abs(i%60),2,o);case b3.ShortGMT:return"GMT"+(i>=0?"+":"")+Aa(s,1,o);case b3.Long:return"GMT"+(i>=0?"+":"")+Aa(s,2,o)+":"+Aa(Math.abs(i%60),2,o);case b3.Extended:return 0===n?"Z":(i>=0?"+":"")+Aa(s,2,o)+":"+Aa(Math.abs(i%60),2,o);default:throw new Error(`Unknown zone width "${r}"`)}}}const pfe=0,Xg=4;function JF(r){return Zg(r.getFullYear(),r.getMonth(),r.getDate()+(Xg-r.getDay()))}function iP(r,e=!1){return function(t,n){let i;if(e){const o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,s=t.getDate();i=1+Math.floor((s+o)/7)}else{const o=JF(t),s=function mfe(r){const e=Zg(r,pfe,1).getDay();return Zg(r,0,1+(e<=Xg?Xg:Xg+7)-e)}(o.getFullYear()),a=o.getTime()-s.getTime();i=1+Math.round(a/6048e5)}return Aa(i,r,Hs(n,Fr.MinusSign))}}function Qg(r,e=!1){return function(t,n){return Aa(JF(t).getFullYear(),r,Hs(n,Fr.MinusSign),e)}}const oP={};function eU(r,e){r=r.replace(/:/g,"");const t=Date.parse("Jan 01, 1970 00:00:00 "+r)/6e4;return isNaN(t)?e:t}function tU(r){return r instanceof Date&&!isNaN(r.valueOf())}const Efe=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function lP(r){const e=parseInt(r);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+r);return e}function oU(r,e){e=encodeURIComponent(e);for(const t of r.split(";")){const n=t.indexOf("="),[i,o]=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}const fP=/\s+/,sU=[];let zt=(()=>{class r{constructor(t,n){this._ngEl=t,this._renderer=n,this.initialClasses=sU,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(fP):sU}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(fP):t}ngDoCheck(){for(const n of this.initialClasses)this._updateState(n,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const n of t)this._updateState(n,!0);else if(null!=t)for(const n of Object.keys(t))this._updateState(n,!!t[n]);this._applyStateDiff()}_updateState(t,n){const i=this.stateMap.get(t);void 0!==i?(i.enabled!==n&&(i.changed=!0,i.enabled=n),i.touched=!0):this.stateMap.set(t,{enabled:n,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const n=t[0],i=t[1];i.changed?(this._toggleClass(n,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(n,!1),this.stateMap.delete(n)),i.touched=!1}}_toggleClass(t,n){(t=t.trim()).length>0&&t.split(fP).forEach(i=>{n?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static#e=this.\u0275fac=function(n){return new(n||r)(G(V2),G(fc))};static#t=this.\u0275dir=Dt({type:r,selectors:[["","ngClass",""]],inputs:{klass:[Z1.None,"class","klass"],ngClass:"ngClass"},standalone:!0})}return r})();class Lfe{constructor(e,t,n,i){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Nt=(()=>{class r{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,n,i){this._viewContainer=t,this._template=n,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const n=this._viewContainer;t.forEachOperation((i,o,s)=>{if(null==i.previousIndex)n.createEmbeddedView(this._template,new Lfe(i.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)n.remove(null===o?void 0:o);else if(null!==o){const a=n.get(o);n.move(a,s),cU(a,i)}});for(let i=0,o=n.length;i<o;i++){const a=n.get(i).context;a.index=i,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{cU(n.get(i.currentIndex),i)})}static ngTemplateContextGuard(t,n){return!0}static#e=this.\u0275fac=function(n){return new(n||r)(G(is),G(S3),G(TM))};static#t=this.\u0275dir=Dt({type:r,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return r})();function cU(r,e){r.context.$implicit=e.item}let Tt=(()=>{class r{constructor(t,n){this._viewContainer=t,this._context=new zfe,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){lU("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){lU("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,n){return!0}static#e=this.\u0275fac=function(n){return new(n||r)(G(is),G(S3))};static#t=this.\u0275dir=Dt({type:r,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return r})();class zfe{constructor(){this.$implicit=null,this.ngIf=null}}function lU(r,e){if(e&&!e.createEmbeddedView)throw new Error(`${r} must be a TemplateRef, but received '${pi(e)}'.`)}let dU=(()=>{class r{constructor(t){this._locale=t}transform(t,n,i){if(!function gP(r){return!(null==r||""===r||r!=r)}(t))return null;i=i||this._locale;try{return function bfe(r,e,t){return function aP(r,e,t,n,i,o,s=!1){let a="",c=!1;if(isFinite(r)){let l=function Nfe(r){let n,i,o,s,a,e=Math.abs(r)+"",t=0;for((i=e.indexOf("."))>-1&&(e=e.replace(".","")),(o=e.search(/e/i))>0?(i<0&&(i=o),i+=+e.slice(o+1),e=e.substring(0,o)):i<0&&(i=e.length),o=0;"0"===e.charAt(o);o++);if(o===(a=e.length))n=[0],i=1;else{for(a--;"0"===e.charAt(a);)a--;for(i-=o,n=[],s=0;o<=a;o++,s++)n[s]=Number(e.charAt(o))}return i>22&&(n=n.splice(0,21),t=i-1,i=1),{digits:n,exponent:t,integerLen:i}}(r);s&&(l=function wfe(r){if(0===r.digits[0])return r;const e=r.digits.length-r.integerLen;return r.exponent?r.exponent+=2:(0===e?r.digits.push(0,0):1===e&&r.digits.push(0),r.integerLen+=2),r}(l));let u=e.minInt,f=e.minFrac,g=e.maxFrac;if(o){const $=o.match(Efe);if(null===$)throw new Error(`${o} is not a valid digit info`);const oe=$[1],_e=$[3],Te=$[5];null!=oe&&(u=lP(oe)),null!=_e&&(f=lP(_e)),null!=Te?g=lP(Te):null!=_e&&f>g&&(g=f)}!function Ife(r,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let n=r.digits,i=n.length-r.integerLen;const o=Math.min(Math.max(e,i),t);let s=o+r.integerLen,a=n[s];if(s>0){n.splice(Math.max(r.integerLen,s));for(let f=s;f<n.length;f++)n[f]=0}else{i=Math.max(0,i),r.integerLen=1,n.length=Math.max(1,s=o+1),n[0]=0;for(let f=1;f<s;f++)n[f]=0}if(a>=5)if(s-1<0){for(let f=0;f>s;f--)n.unshift(0),r.integerLen++;n.unshift(1),r.integerLen++}else n[s-1]++;for(;i<Math.max(0,o);i++)n.push(0);let c=0!==o;const l=e+r.integerLen,u=n.reduceRight(function(f,g,y,S){return S[y]=(g+=f)<10?g:g-10,c&&(0===S[y]&&y>=l?S.pop():c=!1),g>=10?1:0},0);u&&(n.unshift(u),r.integerLen++)}(l,f,g);let y=l.digits,S=l.integerLen;const I=l.exponent;let R=[];for(c=y.every($=>!$);S<u;S++)y.unshift(0);for(;S<0;S++)y.unshift(0);S>0?R=y.splice(S,y.length):(R=y,y=[0]);const U=[];for(y.length>=e.lgSize&&U.unshift(y.splice(-e.lgSize,y.length).join(""));y.length>e.gSize;)U.unshift(y.splice(-e.gSize,y.length).join(""));y.length&&U.unshift(y.join("")),a=U.join(Hs(t,n)),R.length&&(a+=Hs(t,i)+R.join("")),I&&(a+=Hs(t,Fr.Exponential)+"+"+I)}else a=Hs(t,Fr.Infinity);return a=r<0&&!c?e.negPre+a+e.negSuf:e.posPre+a+e.posSuf,a}(r,function cP(r,e="-"){const t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},n=r.split(";"),i=n[0],o=n[1],s=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],a=s[0],c=s[1]||"";t.posPre=a.substring(0,a.indexOf("#"));for(let u=0;u<c.length;u++){const f=c.charAt(u);"0"===f?t.minFrac=t.maxFrac=u+1:"#"===f?t.maxFrac=u+1:t.posSuf+=f}const l=a.split(",");if(t.gSize=l[1]?l[1].length:0,t.lgSize=l[2]||l[1]?(l[2]||l[1]).length:0,o){const u=i.length-t.posPre.length-t.posSuf.length,f=o.indexOf("#");t.negPre=o.substring(0,f).replace(/'/g,""),t.negSuf=o.slice(f+u).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}(function nP(r,e){return so(r)[D1.NumberFormats][e]}(e,Bg.Decimal),Hs(e,Fr.MinusSign)),e,Fr.Group,Fr.Decimal,t)}(function pP(r){if("string"==typeof r&&!isNaN(Number(r)-parseFloat(r)))return Number(r);if("number"!=typeof r)throw new Error(`${r} is not a number`);return r}(t),i,n)}catch(o){throw function ba(r,e){return new ge(2100,!1)}()}}static#e=this.\u0275fac=function(n){return new(n||r)(G(Cc,16))};static#t=this.\u0275pipe=I2({name:"number",type:r,pure:!0,standalone:!0})}return r})();let a9e=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275mod=N2({type:r});static#n=this.\u0275inj=s2({})}return r})();const hU="browser";function gU(r){return"server"===r}let d9e=(()=>{class r{static#e=this.\u0275prov=xe({token:r,providedIn:"root",factory:()=>function f9e(r){return r===hU}(Le(y3))?new h9e(Le(zi),window):new p9e})}return r})();class h9e{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){const t=function g9e(r,e){const t=r.getElementById(e)||r.getElementsByName(e)[0];if(t)return t;if("function"==typeof r.createTreeWalker&&r.body&&"function"==typeof r.body.attachShadow){const n=r.createTreeWalker(r.body,NodeFilter.SHOW_ELEMENT);let i=n.currentNode;for(;i;){const o=i.shadowRoot;if(o){const s=o.getElementById(e)||o.querySelector(`[name="${e}"]`);if(s)return s}i=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(n-o[0],i-o[1])}}class p9e{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}}class pU{}class V9e extends B7e{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class CP extends V9e{static makeCurrent(){!function G7e(r){JE||(JE=r)}(new CP)}onAndCancel(e,t,n){return e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function H9e(){return F7=F7||document.querySelector("base"),F7?F7.getAttribute("href"):null}();return null==t?null:function F9e(r){return new URL(r,document.baseURI).pathname}(t)}resetBaseElement(){F7=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return oU(document.cookie,e)}}let F7=null,$9e=(()=>{class r{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();const vP=new Qe("EventManagerPlugins");let vU=(()=>{class r{constructor(t,n){this._zone=n,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,n,i){return this._findPluginFor(n).addEventListener(t,n,i)}getZone(){return this._zone}_findPluginFor(t){let n=this._eventNameToPlugin.get(t);if(n)return n;if(n=this._plugins.find(o=>o.supports(t)),!n)throw new ge(5101,!1);return this._eventNameToPlugin.set(t,n),n}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(vP),Ae(bn))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();class yU{constructor(e){this._doc=e}}const yP="ng-app-id";let MU=(()=>{class r{constructor(t,n,i,o={}){this.doc=t,this.appId=n,this.nonce=i,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=gU(o),this.resetHostNodes()}addStyles(t){for(const n of t)1===this.changeUsageCount(n,1)&&this.onStyleAdded(n)}removeStyles(t){for(const n of t)this.changeUsageCount(n,-1)<=0&&this.onStyleRemoved(n)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(n=>n.remove()),t.clear());for(const n of this.getAllStyles())this.onStyleRemoved(n);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const n of this.getAllStyles())this.addStyleToHost(t,n)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const n of this.hostNodes)this.addStyleToHost(n,t)}onStyleRemoved(t){const n=this.styleRef;n.get(t)?.elements?.forEach(i=>i.remove()),n.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${yP}="${this.appId}"]`);if(t?.length){const n=new Map;return t.forEach(i=>{null!=i.textContent&&n.set(i.textContent,i)}),n}return null}changeUsageCount(t,n){const i=this.styleRef;if(i.has(t)){const o=i.get(t);return o.usage+=n,o.usage}return i.set(t,{usage:n,elements:[]}),n}getStyleElement(t,n){const i=this.styleNodesInDOM,o=i?.get(n);if(o?.parentNode===t)return i.delete(n),o.removeAttribute(yP),o;{const s=this.doc.createElement("style");return this.nonce&&s.setAttribute("nonce",this.nonce),s.textContent=n,this.platformIsServer&&s.setAttribute(yP,this.appId),t.appendChild(s),s}}addStyleToHost(t,n){const i=this.getStyleElement(t,n),o=this.styleRef,s=o.get(n)?.elements;s?s.push(i):o.set(n,{elements:[i],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(zi),Ae(Nh),Ae(hL,8),Ae(y3))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();const MP={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},EP=/%COMP%/g,q9e=new Qe("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!0});function PU(r,e){return e.map(t=>t.replace(EP,r))}let PP=(()=>{class r{constructor(t,n,i,o,s,a,c,l=null){this.eventManager=t,this.sharedStylesHost=n,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=gU(a),this.defaultRenderer=new SP(t,s,c,this.platformIsServer)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;this.platformIsServer&&n.encapsulation===Ca.ShadowDom&&(n={...n,encapsulation:Ca.Emulated});const i=this.getOrCreateRenderer(t,n);return i instanceof OU?i.applyToHost(t):i instanceof OP&&i.applyStyles(),i}getOrCreateRenderer(t,n){const i=this.rendererByCompId;let o=i.get(n.id);if(!o){const s=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,f=this.platformIsServer;switch(n.encapsulation){case Ca.Emulated:o=new OU(c,l,n,this.appId,u,s,a,f);break;case Ca.ShadowDom:return new K9e(c,l,t,n,s,a,this.nonce,f);default:o=new OP(c,l,n,u,s,a,f)}i.set(n.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(vU),Ae(MU),Ae(Nh),Ae(q9e),Ae(zi),Ae(y3),Ae(bn),Ae(hL))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();class SP{constructor(e,t,n,i){this.eventManager=e,this.doc=t,this.ngZone=n,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(MP[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(SU(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(SU(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?this.doc.querySelector(e):e;if(!n)throw new ge(-5104,!1);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,i){if(i){t=i+":"+t;const o=MP[i];o?e.setAttributeNS(o,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const i=MP[n];i?e.removeAttributeNS(i,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,i){i&(b4.DashCase|b4.Important)?e.style.setProperty(t,n,i&b4.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&b4.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){null!=e&&(e[t]=n)}setValue(e,t){e.nodeValue=t}listen(e,t,n){if("string"==typeof e&&!(e=R4().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(n))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function SU(r){return"TEMPLATE"===r.tagName&&void 0!==r.content}class K9e extends SP{constructor(e,t,n,i,o,s,a,c){super(e,o,s,c),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=PU(i.id,i.styles);for(const u of l){const f=document.createElement("style");a&&f.setAttribute("nonce",a),f.textContent=u,this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class OP extends SP{constructor(e,t,n,i,o,s,a,c){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?PU(c,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class OU extends OP{constructor(e,t,n,i,o,s,a,c){const l=i+"-"+n.id;super(e,t,n,o,s,a,c,l),this.contentAttr=function j9e(r){return"_ngcontent-%COMP%".replace(EP,r)}(l),this.hostAttr=function Z9e(r){return"_nghost-%COMP%".replace(EP,r)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}let X9e=(()=>{class r extends yU{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,i){return t.addEventListener(n,i,!1),()=>this.removeEventListener(t,n,i)}removeEventListener(t,n,i){return t.removeEventListener(n,i)}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(zi))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();const TU=["alt","control","meta","shift"],Q9e={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},J9e={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey};let ede=(()=>{class r extends yU{constructor(t){super(t)}supports(t){return null!=r.parseEventName(t)}addEventListener(t,n,i){const o=r.parseEventName(n),s=r.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>R4().onAndCancel(t,o.domEventName,s))}static parseEventName(t){const n=t.toLowerCase().split("."),i=n.shift();if(0===n.length||"keydown"!==i&&"keyup"!==i)return null;const o=r._normalizeKey(n.pop());let s="",a=n.indexOf("code");if(a>-1&&(n.splice(a,1),s="code."),TU.forEach(l=>{const u=n.indexOf(l);u>-1&&(n.splice(u,1),s+=l+".")}),s+=o,0!=n.length||0===o.length)return null;const c={};return c.domEventName=i,c.fullKey=s,c}static matchEventFullKeyCode(t,n){let i=Q9e[t.key]||t.key,o="";return n.indexOf("code.")>-1&&(i=t.code,o="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),TU.forEach(s=>{s!==i&&(0,J9e[s])(t)&&(o+=s+".")}),o+=i,o===n)}static eventCallback(t,n,i){return o=>{r.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>n(o))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(zi))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();const bU=[{provide:y3,useValue:hU},{provide:fL,useValue:function tde(){CP.makeCurrent()},multi:!0},{provide:zi,useFactory:function rde(){return function jce(r){qy=r}(document),document},deps:[]}],ide=yF(h7e,"browser",bU),ode=new Qe(""),wU=[{provide:xg,useClass:class U9e{addToWindow(e){R1.getAngularTestability=(n,i=!0)=>{const o=e.findTestabilityInTree(n,i);if(null==o)throw new ge(5103,!1);return o},R1.getAllAngularTestabilities=()=>e.getAllTestabilities(),R1.getAllAngularRootElements=()=>e.getAllRootElements(),R1.frameworkStabilizers||(R1.frameworkStabilizers=[]),R1.frameworkStabilizers.push(n=>{const i=R1.getAllAngularTestabilities();let o=i.length;const s=function(){o--,0==o&&n()};i.forEach(a=>{a.whenStable(s)})})}findTestabilityInTree(e,t,n){return null==t?null:e.getTestability(t)??(n?R4().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:fF,useClass:HE,deps:[bn,FE,xg]},{provide:HE,useClass:HE,deps:[bn,FE,xg]}],NU=[{provide:Fy,useValue:"root"},{provide:E3,useFactory:function nde(){return new E3},deps:[]},{provide:vP,useClass:X9e,multi:!0,deps:[zi,bn,y3]},{provide:vP,useClass:ede,multi:!0,deps:[zi]},PP,MU,vU,{provide:PM,useExisting:PP},{provide:pU,useClass:$9e,deps:[]},[]];let IU=(()=>{class r{constructor(t){}static withServerTransition(t){return{ngModule:r,providers:[{provide:Nh,useValue:t.appId}]}}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(ode,12))};static#t=this.\u0275mod=N2({type:r});static#n=this.\u0275inj=s2({providers:[...NU,...wU],imports:[a9e,g7e]})}return r})(),kU=(()=>{class r{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(zi))};static#t=this.\u0275prov=xe({token:r,factory:function(n){let i=null;return i=n?new n:function ade(){return new kU(Ae(zi))}(),i},providedIn:"root"})}return r})();typeof window<"u"&&window;let LU=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:function(n){let i=null;return i=n?new(n||r):Ae(zU),i},providedIn:"root"})}return r})(),zU=(()=>{class r extends LU{constructor(t){super(),this._doc=t}sanitize(t,n){if(null==n)return null;switch(t){case Ls.NONE:return n;case Ls.HTML:return uc(n,"HTML")?ns(n):tz(this._doc,String(n)).toString();case Ls.STYLE:return uc(n,"Style")?ns(n):n;case Ls.SCRIPT:if(uc(n,"Script"))return ns(n);throw new ge(5200,!1);case Ls.URL:return uc(n,"URL")?ns(n):Wh(String(n));case Ls.RESOURCE_URL:if(uc(n,"ResourceURL"))return ns(n);throw new ge(5201,!1);default:throw new ge(5202,!1)}}bypassSecurityTrustHtml(t){return function F3e(r){return new x3e(r)}(t)}bypassSecurityTrustStyle(t){return function U3e(r){return new L3e(r)}(t)}bypassSecurityTrustScript(t){return function $3e(r){return new z3e(r)}(t)}bypassSecurityTrustUrl(t){return function G3e(r){return new D3e(r)}(t)}bypassSecurityTrustResourceUrl(t){return function B3e(r){return new V3e(r)}(t)}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(zi))};static#t=this.\u0275prov=xe({token:r,factory:function(n){let i=null;return i=n?new n:function fde(r){return new zU(r.get(zi))}(Ae(Li)),i},providedIn:"root"})}return r})();function np(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]])}return t}function L4(r){return this instanceof L4?(this.v=r,this):new L4(r)}function UU(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=r[Symbol.asyncIterator];return e?e.call(r):(r=function NP(r){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(r),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(o){t[o]=r[o]&&function(s){return new Promise(function(a,c){!function i(o,s,a,c){Promise.resolve(c).then(function(l){o({value:l,done:a})},s)}(a,c,(s=r[o](s)).done,s.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const $U=r=>r&&"number"==typeof r.length&&"function"!=typeof r;function GU(r){return re(r?.then)}function BU(r){return re(r[qv])}function WU(r){return Symbol.asyncIterator&&re(r?.[Symbol.asyncIterator])}function qU(r){return new TypeError(`You provided ${null!==r&&"object"==typeof r?"an invalid object":`'${r}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const jU=function kde(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function ZU(r){return re(r?.[jU])}function YU(r){return function FU(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=t.apply(r,e||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(g){n[g]&&(i[g]=function(y){return new Promise(function(S,I){o.push([g,y,S,I])>1||a(g,y)})})}function a(g,y){try{!function c(g){g.value instanceof L4?Promise.resolve(g.value.v).then(l,u):f(o[0][2],g)}(n[g](y))}catch(S){f(o[0][3],S)}}function l(g){a("next",g)}function u(g){a("throw",g)}function f(g,y){g(y),o.shift(),o.length&&a(o[0][0],o[0][1])}}(this,arguments,function*(){const t=r.getReader();try{for(;;){const{value:n,done:i}=yield L4(t.read());if(i)return yield L4(void 0);yield yield L4(n)}}finally{t.releaseLock()}})}function KU(r){return re(r?.getReader)}function vc(r){if(r instanceof Pr)return r;if(null!=r){if(BU(r))return function Rde(r){return new Pr(e=>{const t=r[qv]();if(re(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(r);if($U(r))return function xde(r){return new Pr(e=>{for(let t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()})}(r);if(GU(r))return function Lde(r){return new Pr(e=>{r.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,g3)})}(r);if(WU(r))return XU(r);if(ZU(r))return function zde(r){return new Pr(e=>{for(const t of r)if(e.next(t),e.closed)return;e.complete()})}(r);if(KU(r))return function Dde(r){return XU(YU(r))}(r)}throw qU(r)}function XU(r){return new Pr(e=>{(function Vde(r,e){var t,n,i,o;return function VU(r,e,t,n){return new(t||(t=Promise))(function(o,s){function a(u){try{l(n.next(u))}catch(f){s(f)}}function c(u){try{l(n.throw(u))}catch(f){s(f)}}function l(u){u.done?o(u.value):function i(o){return o instanceof t?o:new t(function(s){s(o)})}(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=UU(r);!(n=yield t.next()).done;)if(e.next(n.value),e.closed)return}catch(s){i={error:s}}finally{try{n&&!n.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})})(r,e).catch(t=>e.error(t))})}function N3(r,e,t,n=0,i=!1){const o=e.schedule(function(){t(),i?r.add(this.schedule(null,n)):this.unsubscribe()},n);if(r.add(o),!i)return o}function rp(r,e=0){return o2((t,n)=>{t.subscribe(gi(n,i=>N3(n,r,()=>n.next(i),e),()=>N3(n,r,()=>n.complete(),e),i=>N3(n,r,()=>n.error(i),e)))})}function ip(r,e=0){return o2((t,n)=>{n.add(r.schedule(()=>t.subscribe(n),e))})}function QU(r,e){if(!r)throw new Error("Iterable cannot be null");return new Pr(t=>{N3(t,e,()=>{const n=r[Symbol.asyncIterator]();N3(t,e,()=>{n.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function Mi(r,e){return e?function Bde(r,e){if(null!=r){if(BU(r))return function Hde(r,e){return vc(r).pipe(ip(e),rp(e))}(r,e);if($U(r))return function Ude(r,e){return new Pr(t=>{let n=0;return e.schedule(function(){n===r.length?t.complete():(t.next(r[n++]),t.closed||this.schedule())})})}(r,e);if(GU(r))return function Fde(r,e){return vc(r).pipe(ip(e),rp(e))}(r,e);if(WU(r))return QU(r,e);if(ZU(r))return function $de(r,e){return new Pr(t=>{let n;return N3(t,e,()=>{n=r[jU](),N3(t,e,()=>{let i,o;try{({value:i,done:o}=n.next())}catch(s){return void t.error(s)}o?t.complete():t.next(i)},0,!0)}),()=>re(n?.return)&&n.return()})}(r,e);if(KU(r))return function Gde(r,e){return QU(YU(r),e)}(r,e)}throw qU(r)}(r,e):vc(r)}const{isArray:Wde}=Array,{getPrototypeOf:qde,prototype:jde,keys:Zde}=Object;function JU(r){if(1===r.length){const e=r[0];if(Wde(e))return{args:e,keys:null};if(function Yde(r){return r&&"object"==typeof r&&qde(r)===jde}(e)){const t=Zde(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:r,keys:null}}function IP(r){return r[r.length-1]}function e$(r){return re(IP(r))?r.pop():void 0}function op(r){return function Kde(r){return r&&re(r.schedule)}(IP(r))?r.pop():void 0}const{isArray:Xde}=Array;function t$(r){return jn(e=>function Qde(r,e){return Xde(e)?r(...e):r(e)}(r,e))}function n$(r,e){return r.reduce((t,n,i)=>(t[n]=e[i],t),{})}let r$=(()=>{class r{constructor(t,n){this._renderer=t,this._elementRef=n,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(t,n){this._renderer.setProperty(this._elementRef.nativeElement,t,n)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static#e=this.\u0275fac=function(n){return new(n||r)(G(fc),G(V2))};static#t=this.\u0275dir=Dt({type:r})}return r})(),c6=(()=>{class r extends r${static#e=this.\u0275fac=(()=>{let t;return function(i){return(t||(t=z1(r)))(i||r)}})();static#t=this.\u0275dir=Dt({type:r,features:[We]})}return r})();const yc=new Qe("NgValueAccessor"),ehe={provide:yc,useExisting:k1(()=>sp),multi:!0};let sp=(()=>{class r extends c6{writeValue(t){this.setProperty("checked",t)}static#e=this.\u0275fac=(()=>{let t;return function(i){return(t||(t=z1(r)))(i||r)}})();static#t=this.\u0275dir=Dt({type:r,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(n,i){1&n&&W("change",function(s){return i.onChange(s.target.checked)})("blur",function(){return i.onTouched()})},features:[lr([ehe]),We]})}return r})();const the={provide:yc,useExisting:k1(()=>wa),multi:!0},rhe=new Qe("CompositionEventMode");let wa=(()=>{class r extends r${constructor(t,n,i){super(t,n),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function nhe(){const r=R4()?R4().getUserAgent():"";return/android (\d+)/.test(r.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static#e=this.\u0275fac=function(n){return new(n||r)(G(fc),G(V2),G(rhe,8))};static#t=this.\u0275dir=Dt({type:r,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,i){1&n&&W("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[lr([the]),We]})}return r})();function z4(r){return null==r||("string"==typeof r||Array.isArray(r))&&0===r.length}function i$(r){return null!=r&&"number"==typeof r.length}const H2=new Qe("NgValidators"),D4=new Qe("NgAsyncValidators"),ihe=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class $7{static min(e){return function o$(r){return e=>{if(z4(e.value)||z4(r))return null;const t=parseFloat(e.value);return!isNaN(t)&&t<r?{min:{min:r,actual:e.value}}:null}}(e)}static max(e){return function s$(r){return e=>{if(z4(e.value)||z4(r))return null;const t=parseFloat(e.value);return!isNaN(t)&&t>r?{max:{max:r,actual:e.value}}:null}}(e)}static required(e){return a$(e)}static requiredTrue(e){return c$(e)}static email(e){return function l$(r){return z4(r.value)||ihe.test(r.value)?null:{email:!0}}(e)}static minLength(e){return function u$(r){return e=>z4(e.value)||!i$(e.value)?null:e.value.length<r?{minlength:{requiredLength:r,actualLength:e.value.length}}:null}(e)}static maxLength(e){return f$(e)}static pattern(e){return function d$(r){if(!r)return ap;let e,t;return"string"==typeof r?(t="","^"!==r.charAt(0)&&(t+="^"),t+=r,"$"!==r.charAt(r.length-1)&&(t+="$"),e=new RegExp(t)):(t=r.toString(),e=r),n=>{if(z4(n.value))return null;const i=n.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}(e)}static nullValidator(e){return null}static compose(e){return C$(e)}static composeAsync(e){return v$(e)}}function a$(r){return z4(r.value)?{required:!0}:null}function c$(r){return!0===r.value?null:{required:!0}}function f$(r){return e=>i$(e.value)&&e.value.length>r?{maxlength:{requiredLength:r,actualLength:e.value.length}}:null}function ap(r){return null}function h$(r){return null!=r}function g$(r){return w7(r)?Mi(r):r}function p$(r){let e={};return r.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function m$(r,e){return e.map(t=>t(r))}function _$(r){return r.map(e=>function ohe(r){return!r.validate}(e)?e:t=>e.validate(t))}function C$(r){if(!r)return null;const e=r.filter(h$);return 0==e.length?null:function(t){return p$(m$(t,e))}}function kP(r){return null!=r?C$(_$(r)):null}function v$(r){if(!r)return null;const e=r.filter(h$);return 0==e.length?null:function(t){return function Jde(...r){const e=e$(r),{args:t,keys:n}=JU(r),i=new Pr(o=>{const{length:s}=t;if(!s)return void o.complete();const a=new Array(s);let c=s,l=s;for(let u=0;u<s;u++){let f=!1;vc(t[u]).subscribe(gi(o,g=>{f||(f=!0,l--),a[u]=g},()=>c--,void 0,()=>{(!c||!f)&&(l||o.next(n?n$(n,a):a),o.complete())}))}});return e?i.pipe(t$(e)):i}(m$(t,e).map(g$)).pipe(jn(p$))}}function RP(r){return null!=r?v$(_$(r)):null}function y$(r,e){return null===r?[e]:Array.isArray(r)?[...r,e]:[r,e]}function M$(r){return r._rawValidators}function E$(r){return r._rawAsyncValidators}function xP(r){return r?Array.isArray(r)?r:[r]:[]}function cp(r,e){return Array.isArray(r)?r.includes(e):r===e}function P$(r,e){const t=xP(e);return xP(r).forEach(i=>{cp(t,i)||t.push(i)}),t}function S$(r,e){return xP(e).filter(t=>!cp(r,t))}class O${constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=kP(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=RP(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class lo extends O${get formDirective(){return null}get path(){return null}}class V4 extends O${constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class T${constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Mc=(()=>{class r extends T${constructor(t){super(t)}static#e=this.\u0275fac=function(n){return new(n||r)(G(V4,2))};static#t=this.\u0275dir=Dt({type:r,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,i){2&n&&yg("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[We]})}return r})(),H4=(()=>{class r extends T${constructor(t){super(t)}static#e=this.\u0275fac=function(n){return new(n||r)(G(lo,10))};static#t=this.\u0275dir=Dt({type:r,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,i){2&n&&yg("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[We]})}return r})();const G7="VALID",up="INVALID",T8="PENDING",B7="DISABLED";function DP(r){return(fp(r)?r.validators:r)||null}function VP(r,e){return(fp(e)?e.asyncValidators:r)||null}function fp(r){return null!=r&&!Array.isArray(r)&&"object"==typeof r}function b$(r,e,t){const n=r.controls;if(!(e?Object.keys(n):n).length)throw new ge(1e3,"");if(!n[t])throw new ge(1001,"")}function w$(r,e,t){r._forEachChild((n,i)=>{if(void 0===t[i])throw new ge(1002,"")})}class dp{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===G7}get invalid(){return this.status===up}get pending(){return this.status==T8}get disabled(){return this.status===B7}get enabled(){return this.status!==B7}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(P$(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(P$(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(S$(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(S$(e,this._rawAsyncValidators))}hasValidator(e){return cp(this._rawValidators,e)}hasAsyncValidator(e){return cp(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=T8,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=B7,this.errors=null,this._forEachChild(n=>{n.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=G7,this._forEachChild(n=>{n.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===G7||this.status===T8)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?B7:G7}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=T8,this._hasOwnPendingAsyncValidator=!0;const t=g$(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((n,i)=>n&&n._find(i),this)}getError(e,t){const n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new l1,this.statusChanges=new l1}_calculateStatus(){return this._allControlsDisabled()?B7:this.errors?up:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(T8)?T8:this._anyControlsHaveStatus(up)?up:G7}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){fp(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function lhe(r){return Array.isArray(r)?kP(r):r||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function uhe(r){return Array.isArray(r)?RP(r):r||null}(this._rawAsyncValidators)}}class Ec extends dp{constructor(e,t,n){super(DP(t),VP(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,n={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){w$(this,0,e),Object.keys(e).forEach(n=>{b$(this,!0,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(n=>{const i=this.controls[n];i&&i.patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,i)=>{n.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,n)=>!!n._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[t,n]of Object.entries(this.controls))if(this.contains(t)&&e(n))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,n,i)=>((n.enabled||this.disabled)&&(t[i]=n.value),t))}_reduceChildren(e,t){let n=e;return this._forEachChild((i,o)=>{n=t(n,i,o)}),n}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}class N$ extends Ec{}const l6=new Qe("CallSetDisabledState",{providedIn:"root",factory:()=>W7}),W7="always";function hp(r,e){return[...e.path,r]}function q7(r,e,t=W7){HP(r,e),e.valueAccessor.writeValue(r.value),(r.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(r.disabled),function dhe(r,e){e.valueAccessor.registerOnChange(t=>{r._pendingValue=t,r._pendingChange=!0,r._pendingDirty=!0,"change"===r.updateOn&&I$(r,e)})}(r,e),function ghe(r,e){const t=(n,i)=>{e.valueAccessor.writeValue(n),i&&e.viewToModelUpdate(n)};r.registerOnChange(t),e._registerOnDestroy(()=>{r._unregisterOnChange(t)})}(r,e),function hhe(r,e){e.valueAccessor.registerOnTouched(()=>{r._pendingTouched=!0,"blur"===r.updateOn&&r._pendingChange&&I$(r,e),"submit"!==r.updateOn&&r.markAsTouched()})}(r,e),function fhe(r,e){if(e.valueAccessor.setDisabledState){const t=n=>{e.valueAccessor.setDisabledState(n)};r.registerOnDisabledChange(t),e._registerOnDestroy(()=>{r._unregisterOnDisabledChange(t)})}}(r,e)}function gp(r,e,t=!0){const n=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(n),e.valueAccessor.registerOnTouched(n)),mp(r,e),r&&(e._invokeOnDestroyCallbacks(),r._registerOnCollectionChange(()=>{}))}function pp(r,e){r.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function HP(r,e){const t=M$(r);null!==e.validator?r.setValidators(y$(t,e.validator)):"function"==typeof t&&r.setValidators([t]);const n=E$(r);null!==e.asyncValidator?r.setAsyncValidators(y$(n,e.asyncValidator)):"function"==typeof n&&r.setAsyncValidators([n]);const i=()=>r.updateValueAndValidity();pp(e._rawValidators,i),pp(e._rawAsyncValidators,i)}function mp(r,e){let t=!1;if(null!==r){if(null!==e.validator){const i=M$(r);if(Array.isArray(i)&&i.length>0){const o=i.filter(s=>s!==e.validator);o.length!==i.length&&(t=!0,r.setValidators(o))}}if(null!==e.asyncValidator){const i=E$(r);if(Array.isArray(i)&&i.length>0){const o=i.filter(s=>s!==e.asyncValidator);o.length!==i.length&&(t=!0,r.setAsyncValidators(o))}}}const n=()=>{};return pp(e._rawValidators,n),pp(e._rawAsyncValidators,n),t}function I$(r,e){r._pendingDirty&&r.markAsDirty(),r.setValue(r._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1}function k$(r,e){HP(r,e)}function UP(r,e){if(!r.hasOwnProperty("model"))return!1;const t=r.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}function R$(r,e){r._syncPendingControls(),e.forEach(t=>{const n=t.control;"submit"===n.updateOn&&n._pendingChange&&(t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function $P(r,e){if(!e)return null;let t,n,i;return Array.isArray(e),e.forEach(o=>{o.constructor===wa?t=o:function _he(r){return Object.getPrototypeOf(r.constructor)===c6}(o)?n=o:i=o}),i||n||t||null}const vhe={provide:lo,useExisting:k1(()=>Z7)},j7=Promise.resolve();let Z7=(()=>{class r extends lo{constructor(t,n,i){super(),this.callSetDisabledState=i,this.submitted=!1,this._directives=new Set,this.ngSubmit=new l1,this.form=new Ec({},kP(t),RP(n))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){j7.then(()=>{const n=this._findContainer(t.path);t.control=n.registerControl(t.name,t.control),q7(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){j7.then(()=>{const n=this._findContainer(t.path);n&&n.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){j7.then(()=>{const n=this._findContainer(t.path),i=new Ec({});k$(i,t),n.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){j7.then(()=>{const n=this._findContainer(t.path);n&&n.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,n){j7.then(()=>{this.form.get(t.path).setValue(n)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,R$(this.form,this._directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static#e=this.\u0275fac=function(n){return new(n||r)(G(H2,10),G(D4,10),G(l6,8))};static#t=this.\u0275dir=Dt({type:r,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(n,i){1&n&&W("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{options:[Z1.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[lr([vhe]),We]})}return r})();function x$(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}function L$(r){return"object"==typeof r&&null!==r&&2===Object.keys(r).length&&"value"in r&&"disabled"in r}const ko=class extends dp{constructor(e=null,t,n){super(DP(t),VP(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),fp(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=L$(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){x$(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){x$(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){L$(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},Ehe={provide:V4,useExisting:k1(()=>Y7)},V$=Promise.resolve();let Y7=(()=>{class r extends V4{constructor(t,n,i,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this.control=new ko,this._registered=!1,this.name="",this.update=new l1,this._parent=t,this._setValidators(n),this._setAsyncValidators(i),this.valueAccessor=$P(0,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const n=t.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),UP(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){q7(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){V$.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const n=t.isDisabled.currentValue,i=0!==n&&S8(n);V$.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?hp(t,this._parent):[t]}static#e=this.\u0275fac=function(n){return new(n||r)(G(lo,9),G(H2,10),G(D4,10),G(yc,10),G(zs,8),G(l6,8))};static#t=this.\u0275dir=Dt({type:r,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[Z1.None,"disabled","isDisabled"],model:[Z1.None,"ngModel","model"],options:[Z1.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[lr([Ehe]),We,c2]})}return r})(),F4=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275dir=Dt({type:r,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}return r})();const Phe={provide:yc,useExisting:k1(()=>GP),multi:!0};let GP=(()=>{class r extends c6{writeValue(t){this.setProperty("value",t??"")}registerOnChange(t){this.onChange=n=>{t(""==n?null:parseFloat(n))}}static#e=this.\u0275fac=(()=>{let t;return function(i){return(t||(t=z1(r)))(i||r)}})();static#t=this.\u0275dir=Dt({type:r,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(n,i){1&n&&W("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},features:[lr([Phe]),We]})}return r})(),H$=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275mod=N2({type:r});static#n=this.\u0275inj=s2({})}return r})();const The={provide:yc,useExisting:k1(()=>_p),multi:!0};let _p=(()=>{class r extends c6{writeValue(t){this.setProperty("value",parseFloat(t))}registerOnChange(t){this.onChange=n=>{t(""==n?null:parseFloat(n))}}static#e=this.\u0275fac=(()=>{let t;return function(i){return(t||(t=z1(r)))(i||r)}})();static#t=this.\u0275dir=Dt({type:r,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(n,i){1&n&&W("change",function(s){return i.onChange(s.target.value)})("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},features:[lr([The]),We]})}return r})();const BP=new Qe("NgModelWithFormControlWarning"),Ahe={provide:V4,useExisting:k1(()=>WP)};let WP=(()=>{class r extends V4{set isDisabled(t){}static#e=this._ngModelWarningSentOnce=!1;constructor(t,n,i,o,s){super(),this._ngModelWarningConfig=o,this.callSetDisabledState=s,this.update=new l1,this._ngModelWarningSent=!1,this._setValidators(t),this._setAsyncValidators(n),this.valueAccessor=$P(0,i)}ngOnChanges(t){if(this._isControlChanged(t)){const n=t.form.previousValue;n&&gp(n,this,!1),q7(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}UP(t,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&gp(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_isControlChanged(t){return t.hasOwnProperty("form")}static#t=this.\u0275fac=function(n){return new(n||r)(G(H2,10),G(D4,10),G(yc,10),G(BP,8),G(l6,8))};static#n=this.\u0275dir=Dt({type:r,selectors:[["","formControl",""]],inputs:{form:[Z1.None,"formControl","form"],isDisabled:[Z1.None,"disabled","isDisabled"],model:[Z1.None,"ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[lr([Ahe]),We,c2]})}return r})();const bhe={provide:lo,useExisting:k1(()=>U4)};let U4=(()=>{class r extends lo{constructor(t,n,i){super(),this.callSetDisabledState=i,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new l1,this._setValidators(t),this._setAsyncValidators(n)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(mp(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const n=this.form.get(t.path);return q7(n,t,this.callSetDisabledState),n.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),n}getControl(t){return this.form.get(t.path)}removeControl(t){gp(t.control||null,t,!1),function Che(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,n){this.form.get(t.path).setValue(n)}onSubmit(t){return this.submitted=!0,R$(this.form,this.directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const n=t.control,i=this.form.get(t.path);n!==i&&(gp(n||null,t),(r=>r instanceof ko)(i)&&(q7(i,t,this.callSetDisabledState),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const n=this.form.get(t.path);k$(n,t),n.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const n=this.form.get(t.path);n&&function phe(r,e){return mp(r,e)}(n,t)&&n.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){HP(this.form,this),this._oldForm&&mp(this._oldForm,this)}_checkFormPresent(){}static#e=this.\u0275fac=function(n){return new(n||r)(G(H2,10),G(D4,10),G(l6,8))};static#t=this.\u0275dir=Dt({type:r,selectors:[["","formGroup",""]],hostBindings:function(n,i){1&n&&W("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{form:[Z1.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[lr([bhe]),We,c2]})}return r})();const Ihe={provide:V4,useExisting:k1(()=>u6)};let u6=(()=>{class r extends V4{set isDisabled(t){}static#e=this._ngModelWarningSentOnce=!1;constructor(t,n,i,o,s){super(),this._ngModelWarningConfig=s,this._added=!1,this.name=null,this.update=new l1,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(n),this._setAsyncValidators(i),this.valueAccessor=$P(0,o)}ngOnChanges(t){this._added||this._setUpControl(),UP(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return hp(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static#t=this.\u0275fac=function(n){return new(n||r)(G(lo,13),G(H2,10),G(D4,10),G(yc,10),G(BP,8))};static#n=this.\u0275dir=Dt({type:r,selectors:[["","formControlName",""]],inputs:{name:[Z1.None,"formControlName","name"],isDisabled:[Z1.None,"disabled","isDisabled"],model:[Z1.None,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[lr([Ihe]),We,c2]})}return r})();const khe={provide:yc,useExisting:k1(()=>Cp),multi:!0};function $$(r,e){return null==r?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${r}: ${e}`.slice(0,50))}let Cp=(()=>{class r extends c6{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const i=$$(this._getOptionId(t),t);this.setProperty("value",i)}registerOnChange(t){this.onChange=n=>{this.value=this._getOptionValue(n),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const n of this._optionMap.keys())if(this._compareWith(this._optionMap.get(n),t))return n;return null}_getOptionValue(t){const n=function Rhe(r){return r.split(":")[0]}(t);return this._optionMap.has(n)?this._optionMap.get(n):t}static#e=this.\u0275fac=(()=>{let t;return function(i){return(t||(t=z1(r)))(i||r)}})();static#t=this.\u0275dir=Dt({type:r,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,i){1&n&&W("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[lr([khe]),We]})}return r})(),A8=(()=>{class r{constructor(t,n,i){this._element=t,this._renderer=n,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue($$(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(n){return new(n||r)(G(V2),G(fc),G(Cp,9))};static#t=this.\u0275dir=Dt({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return r})();const xhe={provide:yc,useExisting:k1(()=>ZP),multi:!0};function G$(r,e){return null==r?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${r}: ${e}`.slice(0,50))}let ZP=(()=>{class r extends c6{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let n;if(this.value=t,Array.isArray(t)){const i=t.map(o=>this._getOptionId(o));n=(o,s)=>{o._setSelected(i.indexOf(s.toString())>-1)}}else n=(i,o)=>{i._setSelected(!1)};this._optionMap.forEach(n)}registerOnChange(t){this.onChange=n=>{const i=[],o=n.selectedOptions;if(void 0!==o){const s=o;for(let a=0;a<s.length;a++){const l=this._getOptionValue(s[a].value);i.push(l)}}else{const s=n.options;for(let a=0;a<s.length;a++){const c=s[a];if(c.selected){const l=this._getOptionValue(c.value);i.push(l)}}}this.value=i,t(i)}}_registerOption(t){const n=(this._idCounter++).toString();return this._optionMap.set(n,t),n}_getOptionId(t){for(const n of this._optionMap.keys())if(this._compareWith(this._optionMap.get(n)._value,t))return n;return null}_getOptionValue(t){const n=function Lhe(r){return r.split(":")[0]}(t);return this._optionMap.has(n)?this._optionMap.get(n)._value:t}static#e=this.\u0275fac=(()=>{let t;return function(i){return(t||(t=z1(r)))(i||r)}})();static#t=this.\u0275dir=Dt({type:r,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,i){1&n&&W("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[lr([xhe]),We]})}return r})(),b8=(()=>{class r{constructor(t,n,i){this._element=t,this._renderer=n,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(G$(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(G$(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(n){return new(n||r)(G(V2),G(fc),G(ZP,9))};static#t=this.\u0275dir=Dt({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return r})();let f6=(()=>{class r{constructor(){this._validator=ap}ngOnChanges(t){if(this.inputName in t){const n=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(n),this._validator=this._enabled?this.createValidator(n):ap,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return null!=t}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275dir=Dt({type:r,features:[c2]})}return r})();const Vhe={provide:H2,useExisting:k1(()=>$4),multi:!0},Hhe={provide:H2,useExisting:k1(()=>YP),multi:!0};let $4=(()=>{class r extends f6{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=S8,this.createValidator=t=>a$}enabled(t){return t}static#e=this.\u0275fac=(()=>{let t;return function(i){return(t||(t=z1(r)))(i||r)}})();static#t=this.\u0275dir=Dt({type:r,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(n,i){2&n&&w("required",i._enabled?"":null)},inputs:{required:"required"},features:[lr([Vhe]),We]})}return r})(),YP=(()=>{class r extends $4{constructor(){super(...arguments),this.createValidator=t=>c$}static#e=this.\u0275fac=(()=>{let t;return function(i){return(t||(t=z1(r)))(i||r)}})();static#t=this.\u0275dir=Dt({type:r,selectors:[["input","type","checkbox","required","","formControlName",""],["input","type","checkbox","required","","formControl",""],["input","type","checkbox","required","","ngModel",""]],hostVars:1,hostBindings:function(n,i){2&n&&w("required",i._enabled?"":null)},features:[lr([Hhe]),We]})}return r})();const $he={provide:H2,useExisting:k1(()=>KP),multi:!0};let KP=(()=>{class r extends f6{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=t=>function B$(r){return"number"==typeof r?r:parseInt(r,10)}(t),this.createValidator=t=>f$(t)}static#e=this.\u0275fac=(()=>{let t;return function(i){return(t||(t=z1(r)))(i||r)}})();static#t=this.\u0275dir=Dt({type:r,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(n,i){2&n&&w("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[lr([$he]),We]})}return r})(),X$=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275mod=N2({type:r});static#n=this.\u0275inj=s2({imports:[H$]})}return r})();class Q$ extends dp{constructor(e,t,n){super(DP(t),VP(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,n={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(e,t={}){let n=this._adjustIndex(e);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,n={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){w$(this,0,e),e.forEach((n,i)=>{b$(this,!1,i),this.at(i).setValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((n,i)=>{this.at(i)&&this.at(i).patchValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,n)=>!!n._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,n)=>{e(t,n)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}}function J$(r){return!!r&&(void 0!==r.asyncValidators||void 0!==r.validators||void 0!==r.updateOn)}let Bhe=(()=>{class r{constructor(){this.useNonNullable=!1}get nonNullable(){const t=new r;return t.useNonNullable=!0,t}group(t,n=null){const i=this._reduceControls(t);let o={};return J$(n)?o=n:null!==n&&(o.validators=n.validator,o.asyncValidators=n.asyncValidator),new Ec(i,o)}record(t,n=null){const i=this._reduceControls(t);return new N$(i,n)}control(t,n,i){let o={};return this.useNonNullable?(J$(n)?o=n:(o.validators=n,o.asyncValidators=i),new ko(t,{...o,nonNullable:!0})):new ko(t,n,i)}array(t,n,i){const o=t.map(s=>this._createControl(s));return new Q$(o,n,i)}_reduceControls(t){const n={};return Object.keys(t).forEach(i=>{n[i]=this._createControl(t[i])}),n}_createControl(t){return t instanceof ko||t instanceof dp?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Whe=(()=>{class r{static withConfig(t){return{ngModule:r,providers:[{provide:l6,useValue:t.callSetDisabledState??W7}]}}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275mod=N2({type:r});static#n=this.\u0275inj=s2({imports:[X$]})}return r})(),qhe=(()=>{class r{static withConfig(t){return{ngModule:r,providers:[{provide:BP,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:l6,useValue:t.callSetDisabledState??W7}]}}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275mod=N2({type:r});static#n=this.\u0275inj=s2({imports:[X$]})}return r})();function eG(r,e,t,n,i,o,s){try{var a=r[o](s),c=a.value}catch(l){return void t(l)}a.done?e(c):Promise.resolve(c).then(n,i)}function E(r){return function(){var e=this,t=arguments;return new Promise(function(n,i){var o=r.apply(e,t);function s(c){eG(o,n,i,s,a,"next",c)}function a(c){eG(o,n,i,s,a,"throw",c)}s(void 0)})}}function Wt(...r){return Mi(r,op(r))}function F2(r,e,t=1/0){return re(e)?F2((n,i)=>jn((o,s)=>e(n,o,i,s))(vc(r(n,i))),t):("number"==typeof e&&(t=e),o2((n,i)=>function jhe(r,e,t,n,i,o,s,a){const c=[];let l=0,u=0,f=!1;const g=()=>{f&&!c.length&&!l&&e.complete()},y=I=>l<n?S(I):c.push(I),S=I=>{o&&e.next(I),l++;let R=!1;vc(t(I,u++)).subscribe(gi(e,U=>{i?.(U),o?y(U):e.next(U)},()=>{R=!0},void 0,()=>{if(R)try{for(l--;c.length&&l<n;){const U=c.shift();s?N3(e,s,()=>S(U)):S(U)}g()}catch(U){e.error(U)}}))};return r.subscribe(gi(e,y,()=>{f=!0,g()})),()=>{a?.()}}(n,i,r,t)))}function w8(r,e){return re(e)?F2(r,e,1):F2(r,1)}function I3(r,e){return o2((t,n)=>{let i=0;t.subscribe(gi(n,o=>r.call(e,o,i++)&&n.next(o)))})}function K7(r){return o2((e,t)=>{try{e.subscribe(t)}finally{t.add(r)}})}function Na(r,e){return o2((t,n)=>{let i=null,o=0,s=!1;const a=()=>s&&!i&&n.complete();t.subscribe(gi(n,c=>{i?.unsubscribe();let l=0;const u=o++;vc(r(c,u)).subscribe(i=gi(n,f=>n.next(e?e(c,f,u,l++):f),()=>{i=null,a()}))},()=>{s=!0,a()}))})}class vp{}class yp{}class Us{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const n=t.indexOf(":");if(n>0){const i=t.slice(0,n),o=i.toLowerCase(),s=t.slice(n+1).trim();this.maybeSetNormalizedName(i,o),this.headers.has(o)?this.headers.get(o).push(s):this.headers.set(o,[s])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,n)=>{this.setHeaderEntries(n,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,n])=>{this.setHeaderEntries(t,n)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Us?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Us;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Us?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const i=("a"===e.op?this.headers.get(t):void 0)||[];i.push(...n),this.headers.set(t,i);break;case"d":const o=e.value;if(o){let s=this.headers.get(t);if(!s)return;s=s.filter(a=>-1===o.indexOf(a)),0===s.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const n=(Array.isArray(t)?t:[t]).map(o=>o.toString()),i=e.toLowerCase();this.headers.set(i,n),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Zhe{encodeKey(e){return tG(e)}encodeValue(e){return tG(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Khe=/%(\d[a-f0-9])/gi,Xhe={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function tG(r){return encodeURIComponent(r).replace(Khe,(e,t)=>Xhe[t]??e)}function Mp(r){return`${r}`}class G4{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Zhe,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Yhe(r,e){const t=new Map;return r.length>0&&r.replace(/^\?/,"").split("&").forEach(i=>{const o=i.indexOf("="),[s,a]=-1==o?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,o)),e.decodeValue(i.slice(o+1))],c=t.get(s)||[];c.push(a),t.set(s,c)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t],i=Array.isArray(n)?n.map(Mp):[Mp(n)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const i=e[n];Array.isArray(i)?i.forEach(o=>{t.push({param:n,value:o,op:"a"})}):t.push({param:n,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new G4({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(Mp(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let n=this.map.get(e.param)||[];const i=n.indexOf(Mp(e.value));-1!==i&&n.splice(i,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Qhe{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function nG(r){return typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer}function rG(r){return typeof Blob<"u"&&r instanceof Blob}function iG(r){return typeof FormData<"u"&&r instanceof FormData}class X7{constructor(e,t,n,i){let o;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Jhe(r){switch(r){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==n?n:null,o=i):o=n,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),this.transferCache=o.transferCache),this.headers||(this.headers=new Us),this.context||(this.context=new Qhe),this.params){const s=this.params.toString();if(0===s.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+s}}else this.params=new G4,this.urlWithParams=t}serializeBody(){return null===this.body?null:nG(this.body)||rG(this.body)||iG(this.body)||function ege(r){return typeof URLSearchParams<"u"&&r instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof G4?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||iG(this.body)?null:rG(this.body)?this.body.type||null:nG(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof G4?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,n=e.url||this.url,i=e.responseType||this.responseType,o=void 0!==e.body?e.body:this.body,s=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,l=e.params||this.params;const u=e.context??this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((f,g)=>f.set(g,e.setHeaders[g]),c)),e.setParams&&(l=Object.keys(e.setParams).reduce((f,g)=>f.set(g,e.setParams[g]),l)),new X7(t,n,o,{params:l,headers:c,context:u,reportProgress:a,responseType:i,withCredentials:s})}}var B4=function(r){return r[r.Sent=0]="Sent",r[r.UploadProgress=1]="UploadProgress",r[r.ResponseHeader=2]="ResponseHeader",r[r.DownloadProgress=3]="DownloadProgress",r[r.Response=4]="Response",r[r.User=5]="User",r}(B4||{});class XP{constructor(e,t=Q7.Ok,n="OK"){this.headers=e.headers||new Us,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class Ep extends XP{constructor(e={}){super(e),this.type=B4.ResponseHeader}clone(e={}){return new Ep({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class d6 extends XP{constructor(e={}){super(e),this.type=B4.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new d6({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class N8 extends XP{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}var Q7=function(r){return r[r.Continue=100]="Continue",r[r.SwitchingProtocols=101]="SwitchingProtocols",r[r.Processing=102]="Processing",r[r.EarlyHints=103]="EarlyHints",r[r.Ok=200]="Ok",r[r.Created=201]="Created",r[r.Accepted=202]="Accepted",r[r.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",r[r.NoContent=204]="NoContent",r[r.ResetContent=205]="ResetContent",r[r.PartialContent=206]="PartialContent",r[r.MultiStatus=207]="MultiStatus",r[r.AlreadyReported=208]="AlreadyReported",r[r.ImUsed=226]="ImUsed",r[r.MultipleChoices=300]="MultipleChoices",r[r.MovedPermanently=301]="MovedPermanently",r[r.Found=302]="Found",r[r.SeeOther=303]="SeeOther",r[r.NotModified=304]="NotModified",r[r.UseProxy=305]="UseProxy",r[r.Unused=306]="Unused",r[r.TemporaryRedirect=307]="TemporaryRedirect",r[r.PermanentRedirect=308]="PermanentRedirect",r[r.BadRequest=400]="BadRequest",r[r.Unauthorized=401]="Unauthorized",r[r.PaymentRequired=402]="PaymentRequired",r[r.Forbidden=403]="Forbidden",r[r.NotFound=404]="NotFound",r[r.MethodNotAllowed=405]="MethodNotAllowed",r[r.NotAcceptable=406]="NotAcceptable",r[r.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",r[r.RequestTimeout=408]="RequestTimeout",r[r.Conflict=409]="Conflict",r[r.Gone=410]="Gone",r[r.LengthRequired=411]="LengthRequired",r[r.PreconditionFailed=412]="PreconditionFailed",r[r.PayloadTooLarge=413]="PayloadTooLarge",r[r.UriTooLong=414]="UriTooLong",r[r.UnsupportedMediaType=415]="UnsupportedMediaType",r[r.RangeNotSatisfiable=416]="RangeNotSatisfiable",r[r.ExpectationFailed=417]="ExpectationFailed",r[r.ImATeapot=418]="ImATeapot",r[r.MisdirectedRequest=421]="MisdirectedRequest",r[r.UnprocessableEntity=422]="UnprocessableEntity",r[r.Locked=423]="Locked",r[r.FailedDependency=424]="FailedDependency",r[r.TooEarly=425]="TooEarly",r[r.UpgradeRequired=426]="UpgradeRequired",r[r.PreconditionRequired=428]="PreconditionRequired",r[r.TooManyRequests=429]="TooManyRequests",r[r.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",r[r.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",r[r.InternalServerError=500]="InternalServerError",r[r.NotImplemented=501]="NotImplemented",r[r.BadGateway=502]="BadGateway",r[r.ServiceUnavailable=503]="ServiceUnavailable",r[r.GatewayTimeout=504]="GatewayTimeout",r[r.HttpVersionNotSupported=505]="HttpVersionNotSupported",r[r.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",r[r.InsufficientStorage=507]="InsufficientStorage",r[r.LoopDetected=508]="LoopDetected",r[r.NotExtended=510]="NotExtended",r[r.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",r}(Q7||{});function QP(r,e){return{body:e,headers:r.headers,context:r.context,observe:r.observe,params:r.params,reportProgress:r.reportProgress,responseType:r.responseType,withCredentials:r.withCredentials,transferCache:r.transferCache}}let tge=(()=>{class r{constructor(t){this.handler=t}request(t,n,i={}){let o;if(t instanceof X7)o=t;else{let c,l;c=i.headers instanceof Us?i.headers:new Us(i.headers),i.params&&(l=i.params instanceof G4?i.params:new G4({fromObject:i.params})),o=new X7(t,n,void 0!==i.body?i.body:null,{headers:c,context:i.context,params:l,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache})}const s=Wt(o).pipe(w8(c=>this.handler.handle(c)));if(t instanceof X7||"events"===i.observe)return s;const a=s.pipe(I3(c=>c instanceof d6));switch(i.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return a.pipe(jn(c=>{if(null!==c.body&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return a.pipe(jn(c=>{if(null!==c.body&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return a.pipe(jn(c=>{if(null!==c.body&&"string"!=typeof c.body)throw new Error("Response is not a string.");return c.body}));default:return a.pipe(jn(c=>c.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(t,n={}){return this.request("DELETE",t,n)}get(t,n={}){return this.request("GET",t,n)}head(t,n={}){return this.request("HEAD",t,n)}jsonp(t,n){return this.request("JSONP",t,{params:(new G4).append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,n={}){return this.request("OPTIONS",t,n)}patch(t,n,i={}){return this.request("PATCH",t,QP(i,n))}post(t,n,i={}){return this.request("POST",t,QP(i,n))}put(t,n,i={}){return this.request("PUT",t,QP(i,n))}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(vp))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();function sG(r,e){return e(r)}function sge(r,e){return(t,n)=>e.intercept(t,{handle:i=>r(i,n)})}const cge=new Qe(""),J7=new Qe(""),aG=new Qe(""),cG=new Qe("");function lge(){let r=null;return(e,t)=>{null===r&&(r=(Le(cge,{optional:!0})??[]).reduceRight(sge,sG));const n=Le(E8),i=n.add();return r(e,t).pipe(K7(()=>n.remove(i)))}}let lG=(()=>{class r extends vp{constructor(t,n){super(),this.backend=t,this.injector=n,this.chain=null,this.pendingTasks=Le(E8);const i=Le(cG,{optional:!0});this.backend=i??t}handle(t){if(null===this.chain){const i=Array.from(new Set([...this.injector.get(J7),...this.injector.get(aG,[])]));this.chain=i.reduceRight((o,s)=>function age(r,e,t){return(n,i)=>P4(t,()=>e(n,o=>r(o,i)))}(o,s,this.injector),sG)}const n=this.pendingTasks.add();return this.chain(t,i=>this.backend.handle(i)).pipe(K7(()=>this.pendingTasks.remove(n)))}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(yp),Ae(es))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();const gge=/^\)\]\}',?\n/;let fG=(()=>{class r{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new ge(-2800,!1);const n=this.xhrFactory;return(n.\u0275loadImpl?Mi(n.\u0275loadImpl()):Wt(null)).pipe(Na(()=>new Pr(o=>{const s=n.build();if(s.open(t.method,t.urlWithParams),t.withCredentials&&(s.withCredentials=!0),t.headers.forEach((I,R)=>s.setRequestHeader(I,R.join(","))),t.headers.has("Accept")||s.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const I=t.detectContentTypeHeader();null!==I&&s.setRequestHeader("Content-Type",I)}if(t.responseType){const I=t.responseType.toLowerCase();s.responseType="json"!==I?I:"text"}const a=t.serializeBody();let c=null;const l=()=>{if(null!==c)return c;const I=s.statusText||"OK",R=new Us(s.getAllResponseHeaders()),U=function pge(r){return"responseURL"in r&&r.responseURL?r.responseURL:/^X-Request-URL:/m.test(r.getAllResponseHeaders())?r.getResponseHeader("X-Request-URL"):null}(s)||t.url;return c=new Ep({headers:R,status:s.status,statusText:I,url:U}),c},u=()=>{let{headers:I,status:R,statusText:U,url:$}=l(),oe=null;R!==Q7.NoContent&&(oe=typeof s.response>"u"?s.responseText:s.response),0===R&&(R=oe?Q7.Ok:0);let _e=R>=200&&R<300;if("json"===t.responseType&&"string"==typeof oe){const Te=oe;oe=oe.replace(gge,"");try{oe=""!==oe?JSON.parse(oe):null}catch(Fe){oe=Te,_e&&(_e=!1,oe={error:Fe,text:oe})}}_e?(o.next(new d6({body:oe,headers:I,status:R,statusText:U,url:$||void 0})),o.complete()):o.error(new N8({error:oe,headers:I,status:R,statusText:U,url:$||void 0}))},f=I=>{const{url:R}=l(),U=new N8({error:I,status:s.status||0,statusText:s.statusText||"Unknown Error",url:R||void 0});o.error(U)};let g=!1;const y=I=>{g||(o.next(l()),g=!0);let R={type:B4.DownloadProgress,loaded:I.loaded};I.lengthComputable&&(R.total=I.total),"text"===t.responseType&&s.responseText&&(R.partialText=s.responseText),o.next(R)},S=I=>{let R={type:B4.UploadProgress,loaded:I.loaded};I.lengthComputable&&(R.total=I.total),o.next(R)};return s.addEventListener("load",u),s.addEventListener("error",f),s.addEventListener("timeout",f),s.addEventListener("abort",f),t.reportProgress&&(s.addEventListener("progress",y),null!==a&&s.upload&&s.upload.addEventListener("progress",S)),s.send(a),o.next({type:B4.Sent}),()=>{s.removeEventListener("error",f),s.removeEventListener("abort",f),s.removeEventListener("load",u),s.removeEventListener("timeout",f),t.reportProgress&&(s.removeEventListener("progress",y),null!==a&&s.upload&&s.upload.removeEventListener("progress",S)),s.readyState!==s.DONE&&s.abort()}})))}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(pU))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();const tS=new Qe("XSRF_ENABLED"),dG=new Qe("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),hG=new Qe("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class gG{}let Cge=(()=>{class r{constructor(t,n,i){this.doc=t,this.platform=n,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=oU(t,this.cookieName),this.lastCookieString=t),this.lastToken}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(zi),Ae(y3),Ae(dG))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();function vge(r,e){const t=r.url.toLowerCase();if(!Le(tS)||"GET"===r.method||"HEAD"===r.method||t.startsWith("http://")||t.startsWith("https://"))return e(r);const n=Le(gG).getToken(),i=Le(hG);return null!=n&&!r.headers.has(i)&&(r=r.clone({headers:r.headers.set(i,n)})),e(r)}var W4=function(r){return r[r.Interceptors=0]="Interceptors",r[r.LegacyInterceptors=1]="LegacyInterceptors",r[r.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",r[r.NoXsrfProtection=3]="NoXsrfProtection",r[r.JsonpSupport=4]="JsonpSupport",r[r.RequestsMadeViaParent=5]="RequestsMadeViaParent",r[r.Fetch=6]="Fetch",r}(W4||{});function yge(...r){const e=[tge,fG,lG,{provide:vp,useExisting:lG},{provide:yp,useExisting:fG},{provide:J7,useValue:vge,multi:!0},{provide:tS,useValue:!0},{provide:gG,useClass:Cge}];for(const t of r)e.push(...t.\u0275providers);return function Oh(r){return{\u0275providers:r}}(e)}const pG=new Qe("LEGACY_INTERCEPTOR_FN");function Mge(){return function h6(r,e){return{\u0275kind:r,\u0275providers:e}}(W4.LegacyInterceptors,[{provide:pG,useFactory:lge},{provide:J7,useExisting:pG,multi:!0}])}let Ege=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275mod=N2({type:r});static#n=this.\u0275inj=s2({providers:[yge(Mge())]})}return r})();function nS(...r){const e=op(r),t=e$(r),{args:n,keys:i}=JU(r);if(0===n.length)return Mi([],e);const o=new Pr(function wge(r,e,t=$l){return n=>{EG(e,()=>{const{length:i}=r,o=new Array(i);let s=i,a=i;for(let c=0;c<i;c++)EG(e,()=>{const l=Mi(r[c],e);let u=!1;l.subscribe(gi(n,f=>{o[c]=f,u||(u=!0,a--),a||n.next(t(o.slice()))},()=>{--s||n.complete()}))},n)},n)}}(n,e,i?s=>n$(i,s):$l));return t?o.pipe(t$(t)):o}function EG(r,e,t){r?N3(t,r,e):e()}const Sp=he(r=>function(){r(this),this.name="EmptyError",this.message="no elements in sequence"});function ef(r=1/0){return F2($l,r)}function rS(...r){return function Nge(){return ef(1)}()(Mi(r,op(r)))}function PG(r){return new Pr(e=>{vc(r()).subscribe(e)})}function Op(r,e){const t=re(r)?r:()=>r,n=i=>i.error(t());return new Pr(e?i=>e.schedule(n,0,i):n)}const k3=new Pr(r=>r.complete());function iS(){return o2((r,e)=>{let t=null;r._refCount++;const n=gi(e,void 0,void 0,void 0,()=>{if(!r||r._refCount<=0||0<--r._refCount)return void(t=null);const i=r._connection,o=t;t=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});r.subscribe(n),n.closed||(t=r.connect())})}class SG extends Pr{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,LR(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ue;const t=this.getSubject();e.add(this.source.subscribe(gi(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ue.EMPTY)}return e}refCount(){return iS()(this)}}function I8(r){return r<=0?()=>k3:o2((e,t)=>{let n=0;e.subscribe(gi(t,i=>{++n<=r&&(t.next(i),r<=n&&t.complete())}))})}function Tp(r){return o2((e,t)=>{let n=!1;e.subscribe(gi(t,i=>{n=!0,t.next(i)},()=>{n||t.next(r),t.complete()}))})}function OG(r=Rge){return o2((e,t)=>{let n=!1;e.subscribe(gi(t,i=>{n=!0,t.next(i)},()=>n?t.complete():t.error(r())))})}function Rge(){return new Sp}function g6(r,e){const t=arguments.length>=2;return n=>n.pipe(r?I3((i,o)=>r(i,o,n)):$l,I8(1),t?Tp(e):OG(()=>new Sp))}function u2(r,e,t){const n=re(r)||e||t?{next:r,error:e,complete:t}:r;return n?o2((i,o)=>{var s;null===(s=n.subscribe)||void 0===s||s.call(n);let a=!0;i.subscribe(gi(o,c=>{var l;null===(l=n.next)||void 0===l||l.call(n,c),o.next(c)},()=>{var c;a=!1,null===(c=n.complete)||void 0===c||c.call(n),o.complete()},c=>{var l;a=!1,null===(l=n.error)||void 0===l||l.call(n,c),o.error(c)},()=>{var c,l;a&&(null===(c=n.unsubscribe)||void 0===c||c.call(n)),null===(l=n.finalize)||void 0===l||l.call(n)}))}):$l}function k8(r){return o2((e,t)=>{let o,n=null,i=!1;n=e.subscribe(gi(t,void 0,void 0,s=>{o=vc(r(s,k8(r)(e))),n?(n.unsubscribe(),n=null,o.subscribe(t)):i=!0})),i&&(n.unsubscribe(),n=null,o.subscribe(t))})}function oS(r){return r<=0?()=>k3:o2((e,t)=>{let n=[];e.subscribe(gi(t,i=>{n.push(i),r<n.length&&n.shift()},()=>{for(const i of n)t.next(i);t.complete()},void 0,()=>{n=null}))})}function R8(r){return o2((e,t)=>{vc(r).subscribe(gi(t,()=>t.complete(),p3)),!t.closed&&e.subscribe(t)})}const un="primary",tf=Symbol("RouteTitle");class Vge{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function x8(r){return new Vge(r)}function Hge(r,e,t){const n=t.path.split("/");if(n.length>r.length||"full"===t.pathMatch&&(e.hasChildren()||n.length<r.length))return null;const i={};for(let o=0;o<n.length;o++){const s=n[o],a=r[o];if(s.startsWith(":"))i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:r.slice(0,n.length),posParams:i}}function Pc(r,e){const t=r?sS(r):void 0,n=e?sS(e):void 0;if(!t||!n||t.length!=n.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!TG(r[i],e[i]))return!1;return!0}function sS(r){return[...Object.keys(r),...Object.getOwnPropertySymbols(r)]}function TG(r,e){if(Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;const t=[...r].sort(),n=[...e].sort();return t.every((i,o)=>n[o]===i)}return r===e}function q4(r){return function bge(r){return!!r&&(r instanceof Pr||re(r.lift)&&re(r.subscribe))}(r)?r:w7(r)?Mi(Promise.resolve(r)):Wt(r)}const Uge={exact:function wG(r,e,t){if(!p6(r.segments,e.segments)||!Ap(r.segments,e.segments,t)||r.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children)if(!r.children[n]||!wG(r.children[n],e.children[n],t))return!1;return!0},subset:NG},AG={exact:function $ge(r,e){return Pc(r,e)},subset:function Gge(r,e){return Object.keys(e).length<=Object.keys(r).length&&Object.keys(e).every(t=>TG(r[t],e[t]))},ignored:()=>!0};function bG(r,e,t){return Uge[t.paths](r.root,e.root,t.matrixParams)&&AG[t.queryParams](r.queryParams,e.queryParams)&&!("exact"===t.fragment&&r.fragment!==e.fragment)}function NG(r,e,t){return IG(r,e,e.segments,t)}function IG(r,e,t,n){if(r.segments.length>t.length){const i=r.segments.slice(0,t.length);return!(!p6(i,t)||e.hasChildren()||!Ap(i,t,n))}if(r.segments.length===t.length){if(!p6(r.segments,t)||!Ap(r.segments,t,n))return!1;for(const i in e.children)if(!r.children[i]||!NG(r.children[i],e.children[i],n))return!1;return!0}{const i=t.slice(0,r.segments.length),o=t.slice(r.segments.length);return!!(p6(r.segments,i)&&Ap(r.segments,i,n)&&r.children[un])&&IG(r.children[un],e,o,n)}}function Ap(r,e,t){return e.every((n,i)=>AG[t](r[i].parameters,n.parameters))}class L8{constructor(e=new C1([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap??=x8(this.queryParams),this._queryParamMap}toString(){return qge.serialize(this)}}class C1{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return bp(this)}}class nf{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=x8(this.parameters),this._parameterMap}toString(){return xG(this)}}function p6(r,e){return r.length===e.length&&r.every((t,n)=>t.path===e[n].path)}let z8=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:()=>new aS,providedIn:"root"})}return r})();class aS{parse(e){const t=new rpe(e);return new L8(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${rf(e.root,!0)}`,n=function Yge(r){const e=Object.entries(r).map(([t,n])=>Array.isArray(n)?n.map(i=>`${wp(t)}=${wp(i)}`).join("&"):`${wp(t)}=${wp(n)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${n}${"string"==typeof e.fragment?`#${function jge(r){return encodeURI(r)}(e.fragment)}`:""}`}}const qge=new aS;function bp(r){return r.segments.map(e=>xG(e)).join("/")}function rf(r,e){if(!r.hasChildren())return bp(r);if(e){const t=r.children[un]?rf(r.children[un],!1):"",n=[];return Object.entries(r.children).forEach(([i,o])=>{i!==un&&n.push(`${i}:${rf(o,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function Wge(r,e){let t=[];return Object.entries(r.children).forEach(([n,i])=>{n===un&&(t=t.concat(e(i,n)))}),Object.entries(r.children).forEach(([n,i])=>{n!==un&&(t=t.concat(e(i,n)))}),t}(r,(n,i)=>i===un?[rf(r.children[un],!1)]:[`${i}:${rf(n,!1)}`]);return 1===Object.keys(r.children).length&&null!=r.children[un]?`${bp(r)}/${t[0]}`:`${bp(r)}/(${t.join("//")})`}}function kG(r){return encodeURIComponent(r).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function wp(r){return kG(r).replace(/%3B/gi,";")}function cS(r){return kG(r).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Np(r){return decodeURIComponent(r)}function RG(r){return Np(r.replace(/\+/g,"%20"))}function xG(r){return`${cS(r.path)}${function Zge(r){return Object.entries(r).map(([e,t])=>`;${cS(e)}=${cS(t)}`).join("")}(r.parameters)}`}const Kge=/^[^\/()?;#]+/;function lS(r){const e=r.match(Kge);return e?e[0]:""}const Xge=/^[^\/()?;=#]+/,Jge=/^[^=?&#]+/,tpe=/^[^&#]+/;class rpe{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new C1([],{}):new C1([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[un]=new C1(e,t)),n}parseSegment(){const e=lS(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new ge(4009,!1);return this.capture(e),new nf(Np(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function Qge(r){const e=r.match(Xge);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const i=lS(this.remaining);i&&(n=i,this.capture(n))}e[Np(t)]=Np(n)}parseQueryParam(e){const t=function epe(r){const e=r.match(Jge);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const s=function npe(r){const e=r.match(tpe);return e?e[0]:""}(this.remaining);s&&(n=s,this.capture(n))}const i=RG(t),o=RG(n);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=lS(this.remaining),i=this.remaining[n.length];if("/"!==i&&")"!==i&&";"!==i)throw new ge(4010,!1);let o;n.indexOf(":")>-1?(o=n.slice(0,n.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=un);const s=this.parseChildren();t[o]=1===Object.keys(s).length?s[un]:new C1([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new ge(4011,!1)}}function LG(r){return r.segments.length>0?new C1([],{[un]:r}):r}function zG(r){const e={};for(const[n,i]of Object.entries(r.children)){const o=zG(i);if(n===un&&0===o.segments.length&&o.hasChildren())for(const[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[n]=o)}return function ipe(r){if(1===r.numberOfChildren&&r.children[un]){const e=r.children[un];return new C1(r.segments.concat(e.segments),e.children)}return r}(new C1(r.segments,e))}function m6(r){return r instanceof L8}function DG(r){let e;const i=LG(function t(o){const s={};for(const c of o.children){const l=t(c);s[c.outlet]=l}const a=new C1(o.url,s);return o===r&&(e=a),a}(r.root));return e??i}function VG(r,e,t,n){let i=r;for(;i.parent;)i=i.parent;if(0===e.length)return uS(i,i,i,t,n);const o=function spe(r){if("string"==typeof r[0]&&1===r.length&&"/"===r[0])return new FG(!0,0,r);let e=0,t=!1;const n=r.reduce((i,o,s)=>{if("object"==typeof o&&null!=o){if(o.outlets){const a={};return Object.entries(o.outlets).forEach(([c,l])=>{a[c]="string"==typeof l?l.split("/"):l}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return"string"!=typeof o?[...i,o]:0===s?(o.split("/").forEach((a,c)=>{0==c&&"."===a||(0==c&&""===a?t=!0:".."===a?e++:""!=a&&i.push(a))}),i):[...i,o]},[]);return new FG(t,e,n)}(e);if(o.toRoot())return uS(i,i,new C1([],{}),t,n);const s=function ape(r,e,t){if(r.isAbsolute)return new kp(e,!0,0);if(!t)return new kp(e,!1,NaN);if(null===t.parent)return new kp(t,!0,0);const n=Ip(r.commands[0])?0:1;return function cpe(r,e,t){let n=r,i=e,o=t;for(;o>i;){if(o-=i,n=n.parent,!n)throw new ge(4005,!1);i=n.segments.length}return new kp(n,!1,i-o)}(t,t.segments.length-1+n,r.numberOfDoubleDots)}(o,i,r),a=s.processChildren?af(s.segmentGroup,s.index,o.commands):UG(s.segmentGroup,s.index,o.commands);return uS(i,s.segmentGroup,a,t,n)}function Ip(r){return"object"==typeof r&&null!=r&&!r.outlets&&!r.segmentPath}function sf(r){return"object"==typeof r&&null!=r&&r.outlets}function uS(r,e,t,n,i){let s,o={};n&&Object.entries(n).forEach(([c,l])=>{o[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`}),s=r===e?t:HG(r,e,t);const a=LG(zG(s));return new L8(a,o,i)}function HG(r,e,t){const n={};return Object.entries(r.children).forEach(([i,o])=>{n[i]=o===e?t:HG(o,e,t)}),new C1(r.segments,n)}class FG{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&Ip(n[0]))throw new ge(4003,!1);const i=n.find(sf);if(i&&i!==n.at(-1))throw new ge(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class kp{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function UG(r,e,t){if(r??=new C1([],{}),0===r.segments.length&&r.hasChildren())return af(r,e,t);const n=function upe(r,e,t){let n=0,i=e;const o={match:!1,pathIndex:0,commandIndex:0};for(;i<r.segments.length;){if(n>=t.length)return o;const s=r.segments[i],a=t[n];if(sf(a))break;const c=`${a}`,l=n<t.length-1?t[n+1]:null;if(i>0&&void 0===c)break;if(c&&l&&"object"==typeof l&&void 0===l.outlets){if(!GG(c,l,s))return o;n+=2}else{if(!GG(c,{},s))return o;n++}i++}return{match:!0,pathIndex:i,commandIndex:n}}(r,e,t),i=t.slice(n.commandIndex);if(n.match&&n.pathIndex<r.segments.length){const o=new C1(r.segments.slice(0,n.pathIndex),{});return o.children[un]=new C1(r.segments.slice(n.pathIndex),r.children),af(o,0,i)}return n.match&&0===i.length?new C1(r.segments,{}):n.match&&!r.hasChildren()?fS(r,e,t):n.match?af(r,0,i):fS(r,e,t)}function af(r,e,t){if(0===t.length)return new C1(r.segments,{});{const n=function lpe(r){return sf(r[0])?r[0].outlets:{[un]:r}}(t),i={};if(Object.keys(n).some(o=>o!==un)&&r.children[un]&&1===r.numberOfChildren&&0===r.children[un].segments.length){const o=af(r.children[un],e,t);return new C1(r.segments,o.children)}return Object.entries(n).forEach(([o,s])=>{"string"==typeof s&&(s=[s]),null!==s&&(i[o]=UG(r.children[o],e,s))}),Object.entries(r.children).forEach(([o,s])=>{void 0===n[o]&&(i[o]=s)}),new C1(r.segments,i)}}function fS(r,e,t){const n=r.segments.slice(0,e);let i=0;for(;i<t.length;){const o=t[i];if(sf(o)){const c=fpe(o.outlets);return new C1(n,c)}if(0===i&&Ip(t[0])){n.push(new nf(r.segments[e].path,$G(t[0]))),i++;continue}const s=sf(o)?o.outlets[un]:`${o}`,a=i<t.length-1?t[i+1]:null;s&&a&&Ip(a)?(n.push(new nf(s,$G(a))),i+=2):(n.push(new nf(s,{})),i++)}return new C1(n,{})}function fpe(r){const e={};return Object.entries(r).forEach(([t,n])=>{"string"==typeof n&&(n=[n]),null!==n&&(e[t]=fS(new C1([],{}),0,n))}),e}function $G(r){const e={};return Object.entries(r).forEach(([t,n])=>e[t]=`${n}`),e}function GG(r,e,t){return r==t.path&&Pc(e,t.parameters)}const cf="imperative";var Hn=function(r){return r[r.NavigationStart=0]="NavigationStart",r[r.NavigationEnd=1]="NavigationEnd",r[r.NavigationCancel=2]="NavigationCancel",r[r.NavigationError=3]="NavigationError",r[r.RoutesRecognized=4]="RoutesRecognized",r[r.ResolveStart=5]="ResolveStart",r[r.ResolveEnd=6]="ResolveEnd",r[r.GuardsCheckStart=7]="GuardsCheckStart",r[r.GuardsCheckEnd=8]="GuardsCheckEnd",r[r.RouteConfigLoadStart=9]="RouteConfigLoadStart",r[r.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",r[r.ChildActivationStart=11]="ChildActivationStart",r[r.ChildActivationEnd=12]="ChildActivationEnd",r[r.ActivationStart=13]="ActivationStart",r[r.ActivationEnd=14]="ActivationEnd",r[r.Scroll=15]="Scroll",r[r.NavigationSkipped=16]="NavigationSkipped",r}(Hn||{});class Sc{constructor(e,t){this.id=e,this.url=t}}class Rp extends Sc{constructor(e,t,n="imperative",i=null){super(e,t),this.type=Hn.NavigationStart,this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Oc extends Sc{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=Hn.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}var $s=function(r){return r[r.Redirect=0]="Redirect",r[r.SupersededByNewNavigation=1]="SupersededByNewNavigation",r[r.NoDataFromResolver=2]="NoDataFromResolver",r[r.GuardRejected=3]="GuardRejected",r}($s||{}),xp=function(r){return r[r.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",r[r.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",r}(xp||{});class D8 extends Sc{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=Hn.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class V8 extends Sc{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=Hn.NavigationSkipped}}class Lp extends Sc{constructor(e,t,n,i){super(e,t),this.error=n,this.target=i,this.type=Hn.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class BG extends Sc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=Hn.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class dpe extends Sc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=Hn.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class hpe extends Sc{constructor(e,t,n,i,o){super(e,t),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=o,this.type=Hn.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class gpe extends Sc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=Hn.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ppe extends Sc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=Hn.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class mpe{constructor(e){this.route=e,this.type=Hn.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class _pe{constructor(e){this.route=e,this.type=Hn.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Cpe{constructor(e){this.snapshot=e,this.type=Hn.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class vpe{constructor(e){this.snapshot=e,this.type=Hn.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ype{constructor(e){this.snapshot=e,this.type=Hn.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Mpe{constructor(e){this.snapshot=e,this.type=Hn.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class WG{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n,this.type=Hn.Scroll}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class dS{}class hS{constructor(e){this.url=e}}class Epe{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new lf,this.attachRef=null}}let lf=(()=>{class r{constructor(){this.contexts=new Map}onChildOutletCreated(t,n){const i=this.getOrCreateContext(t);i.outlet=n,this.contexts.set(t,i)}onChildOutletDestroyed(t){const n=this.getContext(t);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let n=this.getContext(t);return n||(n=new Epe,this.contexts.set(t,n)),n}getContext(t){return this.contexts.get(t)||null}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();class qG{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=gS(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){const t=gS(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=pS(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return pS(e,this._root).map(t=>t.value)}}function gS(r,e){if(r===e.value)return e;for(const t of e.children){const n=gS(r,t);if(n)return n}return null}function pS(r,e){if(r===e.value)return[e];for(const t of e.children){const n=pS(r,t);if(n.length)return n.unshift(e),n}return[]}class Ia{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function H8(r){const e={};return r&&r.children.forEach(t=>e[t.value.outlet]=t),e}class jG extends qG{constructor(e,t){super(e),this.snapshot=t,CS(this,e)}toString(){return this.snapshot.toString()}}function ZG(r){const e=function Ppe(r){const o=new _S([],{},{},"",{},un,r,null,{});return new YG("",new Ia(o,[]))}(r),t=new Yo([new nf("",{})]),n=new Yo({}),i=new Yo({}),o=new Yo({}),s=new Yo(""),a=new uo(t,n,o,s,i,un,r,e.root);return a.snapshot=e.root,new jG(new Ia(a,[]),e)}class uo{constructor(e,t,n,i,o,s,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=n,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(jn(l=>l[tf]))??Wt(void 0),this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(jn(e=>x8(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(jn(e=>x8(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function mS(r,e,t="emptyOnly"){let n;const{routeConfig:i}=r;return n=null===e||"always"!==t&&""!==i?.path&&(e.component||e.routeConfig?.loadComponent)?{params:{...r.params},data:{...r.data},resolve:{...r.data,...r._resolvedData??{}}}:{params:{...e.params,...r.params},data:{...e.data,...r.data},resolve:{...r.data,...e.data,...i?.data,...r._resolvedData}},i&&XG(i)&&(n.resolve[tf]=i.title),n}class _S{get title(){return this.data?.[tf]}constructor(e,t,n,i,o,s,a,c,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=x8(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=x8(this.queryParams),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class YG extends qG{constructor(e,t){super(t),this.url=e,CS(this,t)}toString(){return KG(this._root)}}function CS(r,e){e.value._routerState=r,e.children.forEach(t=>CS(r,t))}function KG(r){const e=r.children.length>0?` { ${r.children.map(KG).join(", ")} } `:"";return`${r.value}${e}`}function vS(r){if(r.snapshot){const e=r.snapshot,t=r._futureSnapshot;r.snapshot=t,Pc(e.queryParams,t.queryParams)||r.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&r.fragmentSubject.next(t.fragment),Pc(e.params,t.params)||r.paramsSubject.next(t.params),function Fge(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(!Pc(r[t],e[t]))return!1;return!0}(e.url,t.url)||r.urlSubject.next(t.url),Pc(e.data,t.data)||r.dataSubject.next(t.data)}else r.snapshot=r._futureSnapshot,r.dataSubject.next(r._futureSnapshot.data)}function yS(r,e){const t=Pc(r.params,e.params)&&function Bge(r,e){return p6(r,e)&&r.every((t,n)=>Pc(t.parameters,e[n].parameters))}(r.url,e.url);return t&&!(!r.parent!=!e.parent)&&(!r.parent||yS(r.parent,e.parent))}function XG(r){return"string"==typeof r.title||null===r.title}let MS=(()=>{class r{constructor(){this.activated=null,this._activatedRoute=null,this.name=un,this.activateEvents=new l1,this.deactivateEvents=new l1,this.attachEvents=new l1,this.detachEvents=new l1,this.parentContexts=Le(lf),this.location=Le(is),this.changeDetector=Le(zs),this.environmentInjector=Le(es),this.inputBinder=Le(zp,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:n,previousValue:i}=t.name;if(n)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ge(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ge(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ge(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,n){this.activated=t,this._activatedRoute=n,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,n){if(this.isActivated)throw new ge(4013,!1);this._activatedRoute=t;const i=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new Spe(t,a,i.injector);this.activated=i.createComponent(s,{index:i.length,injector:c,environmentInjector:n??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275dir=Dt({type:r,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[c2]})}return r})();class Spe{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===uo?this.route:e===lf?this.childContexts:this.parent.get(e,t)}}const zp=new Qe("");let QG=(()=>{class r{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:n}=t,i=nS([n.queryParams,n.params,n.data]).pipe(Na(([o,s,a],c)=>(a={...o,...s,...a},0===c?Wt(a):Promise.resolve(a)))).subscribe(o=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==n||null===n.component)return void this.unsubscribeFromRouteData(t);const s=function $7e(r){const e=pn(r);if(!e)return null;const t=new d7(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(n.component);if(s)for(const{templateName:a}of s.inputs)t.activatedComponentRef.setInput(a,o[a]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,i)}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();function uf(r,e,t){if(t&&r.shouldReuseRoute(e.value,t.value.snapshot)){const n=t.value;n._futureSnapshot=e.value;const i=function Tpe(r,e,t){return e.children.map(n=>{for(const i of t.children)if(r.shouldReuseRoute(n.value,i.value.snapshot))return uf(r,n,i);return uf(r,n)})}(r,e,t);return new Ia(n,i)}{if(r.shouldAttach(e.value)){const o=r.retrieve(e.value);if(null!==o){const s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>uf(r,a)),s}}const n=function Ape(r){return new uo(new Yo(r.url),new Yo(r.params),new Yo(r.queryParams),new Yo(r.fragment),new Yo(r.data),r.outlet,r.component,r)}(e.value),i=e.children.map(o=>uf(r,o));return new Ia(n,i)}}const ES="ngNavigationCancelingError";function JG(r,e){const{redirectTo:t,navigationBehaviorOptions:n}=m6(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=eB(!1,$s.Redirect,e);return i.url=t,i.navigationBehaviorOptions=n,i}function eB(r,e,t){const n=new Error("NavigationCancelingError: "+(r||""));return n[ES]=!0,n.cancellationCode=e,t&&(n.url=t),n}function tB(r){return r&&r[ES]}let nB=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275cmp=$e({type:r,selectors:[["ng-component"]],standalone:!0,features:[wg],decls:1,vars:0,template:function(n,i){1&n&&V(0,"router-outlet")},dependencies:[MS],encapsulation:2})}return r})();function PS(r){const e=r.children&&r.children.map(PS),t=e?{...r,children:e}:{...r};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==un&&(t.component=nB),t}function Tc(r){return r.outlet||un}function ff(r){if(!r)return null;if(r.routeConfig?._injector)return r.routeConfig._injector;for(let e=r.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class Lpe{constructor(e,t,n,i,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),vS(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const i=H8(t);e.children.forEach(o=>{const s=o.value.outlet;this.deactivateRoutes(o,i[s],n),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,n)})}deactivateRoutes(e,t,n){const i=e.value,o=t?t.value:null;if(i===o)if(i.component){const s=n.getContext(i.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,n);else o&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,o=H8(e);for(const s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(n&&n.outlet){const s=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,o=H8(e);for(const s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,t,n){const i=H8(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],n),this.forwardEvent(new Mpe(o.value.snapshot))}),e.children.length&&this.forwardEvent(new vpe(e.value.snapshot))}activateRoutes(e,t,n){const i=e.value,o=t?t.value:null;if(vS(i),i===o)if(i.component){const s=n.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,n);else if(i.component){const s=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),vS(a.route.value),this.activateChildRoutes(e,null,s.children)}else{const a=ff(i.snapshot);s.attachRef=null,s.route=i,s.injector=a,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}}else this.activateChildRoutes(e,null,n)}}class rB{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Dp{constructor(e,t){this.component=e,this.route=t}}function zpe(r,e,t){const n=r._root;return df(n,e?e._root:null,t,[n.value])}function F8(r,e){const t=Symbol(),n=e.get(r,t);return n===t?"function"!=typeof r||function jse(r){return null!==Jd(r)}(r)?e.get(r):r:n}function df(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=H8(e);return r.children.forEach(s=>{(function Vpe(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=r.value,s=e?e.value:null,a=t?t.getContext(r.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){const c=function Hpe(r,e,t){if("function"==typeof t)return t(r,e);switch(t){case"pathParamsChange":return!p6(r.url,e.url);case"pathParamsOrQueryParamsChange":return!p6(r.url,e.url)||!Pc(r.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!yS(r,e)||!Pc(r.queryParams,e.queryParams);default:return!yS(r,e)}}(s,o,o.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new rB(n)):(o.data=s.data,o._resolvedData=s._resolvedData),df(r,e,o.component?a?a.children:null:t,n,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Dp(a.outlet.component,s))}else s&&hf(e,a,i),i.canActivateChecks.push(new rB(n)),df(r,null,o.component?a?a.children:null:t,n,i)})(s,o[s.value.outlet],t,n.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>hf(a,t.getContext(s),i)),i}function hf(r,e,t){const n=H8(r),i=r.value;Object.entries(n).forEach(([o,s])=>{hf(s,i.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new Dp(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function gf(r){return"function"==typeof r}function iB(r){return r instanceof Sp||"EmptyError"===r?.name}const Vp=Symbol("INITIAL_VALUE");function U8(){return Na(r=>nS(r.map(e=>e.pipe(I8(1),function kge(...r){const e=op(r);return o2((t,n)=>{(e?rS(r,t,e):rS(r,t)).subscribe(n)})}(Vp)))).pipe(jn(e=>{for(const t of e)if(!0!==t){if(t===Vp)return Vp;if(!1===t||t instanceof L8)return t}return!0}),I3(e=>e!==Vp),I8(1)))}function oB(r){return function Rse(...r){return kR(r)}(u2(e=>{if(m6(e))throw JG(0,e)}),jn(e=>!0===e))}class SS{constructor(e){this.segmentGroup=e||null}}class OS extends Error{constructor(e){super(),this.urlTree=e}}function $8(r){return Op(new SS(r))}class ome{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let n=[],i=t.root;for(;;){if(n=n.concat(i.segments),0===i.numberOfChildren)return Wt(n);if(i.numberOfChildren>1||!i.children[un])return Op(new ge(4e3,!1));i=i.children[un]}}applyRedirectCommands(e,t,n){const i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n);if(t.startsWith("/"))throw new OS(i);return i}applyRedirectCreateUrlTree(e,t,n,i){const o=this.createSegmentGroup(e,t.root,n,i);return new L8(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return Object.entries(e).forEach(([i,o])=>{if("string"==typeof o&&o.startsWith(":")){const a=o.substring(1);n[i]=t[a]}else n[i]=o}),n}createSegmentGroup(e,t,n,i){const o=this.createSegments(e,t.segments,n,i);let s={};return Object.entries(t.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(e,c,n,i)}),new C1(o,s)}createSegments(e,t,n,i){return t.map(o=>o.path.startsWith(":")?this.findPosParam(e,o,i):this.findOrReturn(o,n))}findPosParam(e,t,n){const i=n[t.path.substring(1)];if(!i)throw new ge(4001,!1);return i}findOrReturn(e,t){let n=0;for(const i of t){if(i.path===e.path)return t.splice(n),i;n++}return e}}const TS={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function sme(r,e,t,n,i){const o=AS(r,e,t);return o.matched?(n=function wpe(r,e){return r.providers&&!r._injector&&(r._injector=kE(r.providers,e,`Route: ${r.path}`)),r._injector??e}(e,n),function nme(r,e,t,n){const i=e.canMatch;return i&&0!==i.length?Wt(i.map(s=>{const a=F8(s,r);return q4(function Wpe(r){return r&&gf(r.canMatch)}(a)?a.canMatch(e,t):P4(r,()=>a(e,t)))})).pipe(U8(),oB()):Wt(!0)}(n,e,t).pipe(jn(s=>!0===s?o:{...TS}))):Wt(o)}function AS(r,e,t){if("**"===e.path)return function ame(r){return{matched:!0,parameters:r.at(-1)?.parameters??{},consumedSegments:r,remainingSegments:[],positionalParamSegments:{}}}(t);if(""===e.path)return"full"===e.pathMatch&&(r.hasChildren()||t.length>0)?{...TS}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const i=(e.matcher||Hge)(t,r,e);if(!i)return{...TS};const o={};Object.entries(i.posParams??{}).forEach(([a,c])=>{o[a]=c.path});const s=i.consumed.length>0?{...o,...i.consumed[i.consumed.length-1].parameters}:o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function sB(r,e,t,n){return t.length>0&&function ume(r,e,t){return t.some(n=>Hp(r,e,n)&&Tc(n)!==un)}(r,t,n)?{segmentGroup:new C1(e,lme(n,new C1(t,r.children))),slicedSegments:[]}:0===t.length&&function fme(r,e,t){return t.some(n=>Hp(r,e,n))}(r,t,n)?{segmentGroup:new C1(r.segments,cme(r,t,n,r.children)),slicedSegments:t}:{segmentGroup:new C1(r.segments,r.children),slicedSegments:t}}function cme(r,e,t,n){const i={};for(const o of t)if(Hp(r,e,o)&&!n[Tc(o)]){const s=new C1([],{});i[Tc(o)]=s}return{...n,...i}}function lme(r,e){const t={};t[un]=e;for(const n of r)if(""===n.path&&Tc(n)!==un){const i=new C1([],{});t[Tc(n)]=i}return t}function Hp(r,e,t){return(!(r.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class gme{}class _me{constructor(e,t,n,i,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=n,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new ome(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new ge(4002,`'${e.segmentGroup}'`)}recognize(){const e=sB(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(jn(t=>{const n=new _S([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},un,this.rootComponentType,null,{}),i=new Ia(n,t),o=new YG("",i),s=function ope(r,e,t=null,n=null){return VG(DG(r),e,t,n)}(n,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),this.inheritParamsAndData(o._root,null),{state:o,tree:s}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,un).pipe(k8(n=>{if(n instanceof OS)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof SS?this.noMatchError(n):n}))}inheritParamsAndData(e,t){const n=e.value,i=mS(n,t,this.paramsInheritanceStrategy);n.params=Object.freeze(i.params),n.data=Object.freeze(i.data),e.children.forEach(o=>this.inheritParamsAndData(o,n))}processSegmentGroup(e,t,n,i){return 0===n.segments.length&&n.hasChildren()?this.processChildren(e,t,n):this.processSegment(e,t,n,n.segments,i,!0).pipe(jn(o=>o instanceof Ia?[o]:[]))}processChildren(e,t,n){const i=[];for(const o of Object.keys(n.children))"primary"===o?i.unshift(o):i.push(o);return Mi(i).pipe(w8(o=>{const s=n.children[o],a=function Rpe(r,e){const t=r.filter(n=>Tc(n)===e);return t.push(...r.filter(n=>Tc(n)!==e)),t}(t,o);return this.processSegmentGroup(e,a,s,o)}),function Lge(r,e){return o2(function xge(r,e,t,n,i){return(o,s)=>{let a=t,c=e,l=0;o.subscribe(gi(s,u=>{const f=l++;c=a?r(c,u,f):(a=!0,u),n&&s.next(c)},i&&(()=>{a&&s.next(c),s.complete()})))}}(r,e,arguments.length>=2,!0))}((o,s)=>(o.push(...s),o)),Tp(null),function zge(r,e){const t=arguments.length>=2;return n=>n.pipe(r?I3((i,o)=>r(i,o,n)):$l,oS(1),t?Tp(e):OG(()=>new Sp))}(),F2(o=>{if(null===o)return $8(n);const s=aB(o);return function Cme(r){r.sort((e,t)=>e.value.outlet===un?-1:t.value.outlet===un?1:e.value.outlet.localeCompare(t.value.outlet))}(s),Wt(s)}))}processSegment(e,t,n,i,o,s){return Mi(t).pipe(w8(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,n,i,o,s).pipe(k8(c=>{if(c instanceof SS)return Wt(null);throw c}))),g6(a=>!!a),k8(a=>{if(iB(a))return function hme(r,e,t){return 0===e.length&&!r.children[t]}(n,i,o)?Wt(new gme):$8(n);throw a}))}processSegmentAgainstRoute(e,t,n,i,o,s,a){return function dme(r,e,t,n){return!!(Tc(r)===n||n!==un&&Hp(e,t,r))&&AS(e,r,t).matched}(n,i,o,s)?void 0===n.redirectTo?this.matchSegmentAgainstRoute(e,i,n,o,s):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,n,o,s):$8(i):$8(i)}expandSegmentAgainstRouteUsingRedirect(e,t,n,i,o,s){const{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:u}=AS(t,i,o);if(!a)return $8(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const f=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,f).pipe(F2(g=>this.processSegment(e,n,t,g.concat(u),s,!1)))}matchSegmentAgainstRoute(e,t,n,i,o){const s=sme(t,n,i,e);return"**"===n.path&&(t.children={}),s.pipe(Na(a=>a.matched?this.getChildConfig(e=n._injector??e,n,i).pipe(Na(({routes:c})=>{const l=n._loadedInjector??e,{consumedSegments:u,remainingSegments:f,parameters:g}=a,y=new _S(u,g,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,function yme(r){return r.data||{}}(n),Tc(n),n.component??n._loadedComponent??null,n,function Mme(r){return r.resolve||{}}(n)),{segmentGroup:S,slicedSegments:I}=sB(t,u,f,c);if(0===I.length&&S.hasChildren())return this.processChildren(l,c,S).pipe(jn(U=>null===U?null:new Ia(y,U)));if(0===c.length&&0===I.length)return Wt(new Ia(y,[]));const R=Tc(n)===o;return this.processSegment(l,c,S,I,R?un:o,!0).pipe(jn(U=>new Ia(y,U instanceof Ia?[U]:[])))})):$8(t)))}getChildConfig(e,t,n){return t.children?Wt({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Wt({routes:t._loadedRoutes,injector:t._loadedInjector}):function tme(r,e,t,n){const i=e.canLoad;return void 0===i||0===i.length?Wt(!0):Wt(i.map(s=>{const a=F8(s,r);return q4(function Upe(r){return r&&gf(r.canLoad)}(a)?a.canLoad(e,t):P4(r,()=>a(e,t)))})).pipe(U8(),oB())}(e,t,n).pipe(F2(i=>i?this.configLoader.loadChildren(e,t).pipe(u2(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):function ime(r){return Op(eB(!1,$s.GuardRejected))}())):Wt({routes:[],injector:e})}}function vme(r){const e=r.value.routeConfig;return e&&""===e.path}function aB(r){const e=[],t=new Set;for(const n of r){if(!vme(n)){e.push(n);continue}const i=e.find(o=>n.value.routeConfig===o.value.routeConfig);void 0!==i?(i.children.push(...n.children),t.add(i)):e.push(n)}for(const n of t){const i=aB(n.children);e.push(new Ia(n.value,i))}return e.filter(n=>!t.has(n))}function cB(r){const e=r.children.map(t=>cB(t)).flat();return[r,...e]}function bS(r){return Na(e=>{const t=r(e);return t?Mi(t).pipe(jn(()=>e)):Wt(e)})}let lB=(()=>{class r{buildTitle(t){let n,i=t.root;for(;void 0!==i;)n=this.getResolvedTitleForRoute(i)??n,i=i.children.find(o=>o.outlet===un);return n}getResolvedTitleForRoute(t){return t.data[tf]}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:()=>Le(Ame),providedIn:"root"})}return r})(),Ame=(()=>{class r extends lB{constructor(t){super(),this.title=t}updateTitle(t){const n=this.buildTitle(t);void 0!==n&&this.title.setTitle(n)}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(kU))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();const G8=new Qe("",{providedIn:"root",factory:()=>({})}),B8=new Qe("ROUTES");let wS=(()=>{class r{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Le(sF)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Wt(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const n=q4(t.loadComponent()).pipe(jn(uB),u2(o=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=o}),K7(()=>{this.componentLoaders.delete(t)})),i=new SG(n,()=>new xs).pipe(iS());return this.componentLoaders.set(t,i),i}loadChildren(t,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return Wt({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);const o=function bme(r,e,t,n){return q4(r.loadChildren()).pipe(jn(uB),F2(i=>i instanceof bH||Array.isArray(i)?Wt(i):Mi(e.compileModuleAsync(i))),jn(i=>{n&&n(r);let o,s,a=!1;return Array.isArray(i)?(s=i,!0):(o=i.create(t).injector,s=o.get(B8,[],{optional:!0,self:!0}).flat()),{routes:s.map(PS),injector:o}}))}(n,this.compiler,t,this.onLoadEndListener).pipe(K7(()=>{this.childrenLoaders.delete(n)})),s=new SG(o,()=>new xs).pipe(iS());return this.childrenLoaders.set(n,s),s}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function uB(r){return function wme(r){return r&&"object"==typeof r&&"default"in r}(r)?r.default:r}let NS=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:()=>Le(Nme),providedIn:"root"})}return r})(),Nme=(()=>{class r{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,n){return t}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();const fB=new Qe(""),dB=new Qe("");function Ime(r,e,t){const n=r.get(dB),i=r.get(zi);return r.get(bn).runOutsideAngular(()=>{if(!i.startViewTransition||n.skipNextTransition)return n.skipNextTransition=!1,Promise.resolve();let o;const s=new Promise(l=>{o=l}),a=i.startViewTransition(()=>(o(),function kme(r){return new Promise(e=>{eD(e,{injector:r})})}(r))),{onViewTransitionCreated:c}=n;return c&&P4(r,()=>c({transition:a,from:e,to:t})),s})}let Fp=(()=>{class r{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new xs,this.transitionAbortSubject=new xs,this.configLoader=Le(wS),this.environmentInjector=Le(es),this.urlSerializer=Le(z8),this.rootContexts=Le(lf),this.location=Le(z7),this.inputBindingEnabled=null!==Le(zp,{optional:!0}),this.titleStrategy=Le(lB),this.options=Le(G8,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=Le(NS),this.createViewTransition=Le(fB,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Wt(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=i=>this.events.next(new _pe(i)),this.configLoader.onLoadStartListener=i=>this.events.next(new mpe(i))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const n=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:n})}setupNavigations(t,n,i){return this.transitions=new Yo({id:0,currentUrlTree:n,currentRawUrl:n,extractedUrl:this.urlHandlingStrategy.extract(n),urlAfterRedirects:this.urlHandlingStrategy.extract(n),rawUrl:n,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:cf,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(I3(o=>0!==o.id),jn(o=>({...o,extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Na(o=>{this.currentTransition=o;let s=!1,a=!1;return Wt(o).pipe(u2(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Na(c=>{const l=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!l&&"reload"!==(c.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const f="";return this.events.next(new V8(c.id,this.urlSerializer.serialize(c.rawUrl),f,xp.IgnoredSameUrlNavigation)),c.resolve(null),k3}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return Wt(c).pipe(Na(f=>{const g=this.transitions?.getValue();return this.events.next(new Rp(f.id,this.urlSerializer.serialize(f.extractedUrl),f.source,f.restoredState)),g!==this.transitions?.getValue()?k3:Promise.resolve(f)}),function Eme(r,e,t,n,i,o){return F2(s=>function pme(r,e,t,n,i,o,s="emptyOnly"){return new _me(r,e,t,n,i,s,o).recognize()}(r,e,t,n,s.extractedUrl,i,o).pipe(jn(({state:a,tree:c})=>({...s,targetSnapshot:a,urlAfterRedirects:c}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),u2(f=>{o.targetSnapshot=f.targetSnapshot,o.urlAfterRedirects=f.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:f.urlAfterRedirects};const g=new BG(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(g)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){const{id:f,extractedUrl:g,source:y,restoredState:S,extras:I}=c,R=new Rp(f,this.urlSerializer.serialize(g),y,S);this.events.next(R);const U=ZG(this.rootComponentType).snapshot;return this.currentTransition=o={...c,targetSnapshot:U,urlAfterRedirects:g,extras:{...I,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=g,Wt(o)}{const f="";return this.events.next(new V8(c.id,this.urlSerializer.serialize(c.extractedUrl),f,xp.IgnoredByUrlHandlingStrategy)),c.resolve(null),k3}}),u2(c=>{const l=new dpe(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),jn(c=>(this.currentTransition=o={...c,guards:zpe(c.targetSnapshot,c.currentSnapshot,this.rootContexts)},o)),function jpe(r,e){return F2(t=>{const{targetSnapshot:n,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return 0===s.length&&0===o.length?Wt({...t,guardsResult:!0}):function Zpe(r,e,t,n){return Mi(r).pipe(F2(i=>function eme(r,e,t,n,i){const o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return o&&0!==o.length?Wt(o.map(a=>{const c=ff(e)??i,l=F8(a,c);return q4(function Bpe(r){return r&&gf(r.canDeactivate)}(l)?l.canDeactivate(r,e,t,n):P4(c,()=>l(r,e,t,n))).pipe(g6())})).pipe(U8()):Wt(!0)}(i.component,i.route,t,e,n)),g6(i=>!0!==i,!0))}(s,n,i,r).pipe(F2(a=>a&&function Fpe(r){return"boolean"==typeof r}(a)?function Ype(r,e,t,n){return Mi(e).pipe(w8(i=>rS(function Xpe(r,e){return null!==r&&e&&e(new Cpe(r)),Wt(!0)}(i.route.parent,n),function Kpe(r,e){return null!==r&&e&&e(new ype(r)),Wt(!0)}(i.route,n),function Jpe(r,e,t){const n=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>function Dpe(r){const e=r.routeConfig?r.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:r,guards:e}:null}(s)).filter(s=>null!==s).map(s=>PG(()=>Wt(s.guards.map(c=>{const l=ff(s.node)??t,u=F8(c,l);return q4(function Gpe(r){return r&&gf(r.canActivateChild)}(u)?u.canActivateChild(n,r):P4(l,()=>u(n,r))).pipe(g6())})).pipe(U8())));return Wt(o).pipe(U8())}(r,i.path,t),function Qpe(r,e,t){const n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||0===n.length)return Wt(!0);const i=n.map(o=>PG(()=>{const s=ff(e)??t,a=F8(o,s);return q4(function $pe(r){return r&&gf(r.canActivate)}(a)?a.canActivate(e,r):P4(s,()=>a(e,r))).pipe(g6())}));return Wt(i).pipe(U8())}(r,i.route,t))),g6(i=>!0!==i,!0))}(n,o,r,e):Wt(a)),jn(a=>({...t,guardsResult:a})))})}(this.environmentInjector,c=>this.events.next(c)),u2(c=>{if(o.guardsResult=c.guardsResult,m6(c.guardsResult))throw JG(0,c.guardsResult);const l=new hpe(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),I3(c=>!!c.guardsResult||(this.cancelNavigationTransition(c,"",$s.GuardRejected),!1)),bS(c=>{if(c.guards.canActivateChecks.length)return Wt(c).pipe(u2(l=>{const u=new gpe(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),Na(l=>{let u=!1;return Wt(l).pipe(function Pme(r,e){return F2(t=>{const{targetSnapshot:n,guards:{canActivateChecks:i}}=t;if(!i.length)return Wt(t);const o=new Set(i.map(c=>c.route)),s=new Set;for(const c of o)if(!s.has(c))for(const l of cB(c))s.add(l);let a=0;return Mi(s).pipe(w8(c=>o.has(c)?function Sme(r,e,t,n){const i=r.routeConfig,o=r._resolve;return void 0!==i?.title&&!XG(i)&&(o[tf]=i.title),function Ome(r,e,t,n){const i=sS(r);if(0===i.length)return Wt({});const o={};return Mi(i).pipe(F2(s=>function Tme(r,e,t,n){const i=ff(e)??n,o=F8(r,i);return q4(o.resolve?o.resolve(e,t):P4(i,()=>o(e,t)))}(r[s],e,t,n).pipe(g6(),u2(a=>{o[s]=a}))),oS(1),function Dge(r){return jn(()=>r)}(o),k8(s=>iB(s)?k3:Op(s)))}(o,r,e,n).pipe(jn(s=>(r._resolvedData=s,r.data=mS(r,r.parent,t).resolve,null)))}(c,n,r,e):(c.data=mS(c,c.parent,r).resolve,Wt(void 0))),u2(()=>a++),oS(1),F2(c=>a===s.size?Wt(t):k3))})}(this.paramsInheritanceStrategy,this.environmentInjector),u2({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(l,"",$s.NoDataFromResolver)}}))}),u2(l=>{const u=new ppe(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}))}),bS(c=>{const l=u=>{const f=[];u.routeConfig?.loadComponent&&!u.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(u.routeConfig).pipe(u2(g=>{u.component=g}),jn(()=>{})));for(const g of u.children)f.push(...l(g));return f};return nS(l(c.targetSnapshot.root)).pipe(Tp(null),I8(1))}),bS(()=>this.afterPreactivation()),Na(()=>{const{currentSnapshot:c,targetSnapshot:l}=o,u=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return u?Mi(u).pipe(jn(()=>o)):Wt(o)}),jn(c=>{const l=function Ope(r,e,t){const n=uf(r,e._root,t?t._root:void 0);return new jG(n,e)}(t.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o={...c,targetRouterState:l},this.currentNavigation.targetRouterState=l,o}),u2(()=>{this.events.next(new dS)}),((r,e,t,n)=>jn(i=>(new Lpe(e,i.targetRouterState,i.currentRouterState,t,n).activate(r),i)))(this.rootContexts,t.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),I8(1),u2({next:c=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Oc(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{s=!0}}),R8(this.transitionAbortSubject.pipe(u2(c=>{throw c}))),K7(()=>{!s&&!a&&this.cancelNavigationTransition(o,"",$s.SupersededByNewNavigation),this.currentNavigation?.id===o.id&&(this.currentNavigation=null)}),k8(c=>{if(a=!0,tB(c))this.events.next(new D8(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),function bpe(r){return tB(r)&&m6(r.url)}(c)?this.events.next(new hS(c.url)):o.resolve(!1);else{this.events.next(new Lp(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0));try{o.resolve(t.errorHandler(c))}catch(l){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(l)}}return k3}))}))}cancelNavigationTransition(t,n,i){const o=new D8(t.id,this.urlSerializer.serialize(t.extractedUrl),n,i);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Rme(r){return r!==cf}let xme=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:()=>Le(zme),providedIn:"root"})}return r})();class Lme{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let zme=(()=>{class r extends Lme{static#e=this.\u0275fac=(()=>{let t;return function(i){return(t||(t=z1(r)))(i||r)}})();static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),hB=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:()=>Le(Dme),providedIn:"root"})}return r})(),Dme=(()=>{class r extends hB{constructor(){super(...arguments),this.location=Le(z7),this.urlSerializer=Le(z8),this.options=Le(G8,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=Le(NS),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new L8,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=ZG(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(n=>{"popstate"===n.type&&t(n.url,n.state)})}handleRouterEvent(t,n){if(t instanceof Rp)this.stateMemento=this.createStateMemento();else if(t instanceof V8)this.rawUrlTree=n.initialUrl;else if(t instanceof BG){if("eager"===this.urlUpdateStrategy&&!n.extras.skipLocationChange){const i=this.urlHandlingStrategy.merge(n.finalUrl,n.initialUrl);this.setBrowserUrl(i,n)}}else t instanceof dS?(this.currentUrlTree=n.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(n.finalUrl,n.initialUrl),this.routerState=n.targetRouterState,"deferred"===this.urlUpdateStrategy&&(n.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,n))):t instanceof D8&&(t.code===$s.GuardRejected||t.code===$s.NoDataFromResolver)?this.restoreHistory(n):t instanceof Lp?this.restoreHistory(n,!0):t instanceof Oc&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,n){const i=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(i)||n.extras.replaceUrl){const s={...n.extras.state,...this.generateNgRouterState(n.id,this.browserPageId)};this.location.replaceState(i,"",s)}else{const o={...n.extras.state,...this.generateNgRouterState(n.id,this.browserPageId+1)};this.location.go(i,"",o)}}restoreHistory(t,n=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-this.browserPageId;0!==o?this.location.historyGo(o):this.currentUrlTree===t.finalUrl&&0===o&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,n){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:n}:{navigationId:t}}static#e=this.\u0275fac=(()=>{let t;return function(i){return(t||(t=z1(r)))(i||r)}})();static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var pf=function(r){return r[r.COMPLETE=0]="COMPLETE",r[r.FAILED=1]="FAILED",r[r.REDIRECTING=2]="REDIRECTING",r}(pf||{});function gB(r,e){r.events.pipe(I3(t=>t instanceof Oc||t instanceof D8||t instanceof Lp||t instanceof V8),jn(t=>t instanceof Oc||t instanceof V8?pf.COMPLETE:t instanceof D8&&(t.code===$s.Redirect||t.code===$s.SupersededByNewNavigation)?pf.REDIRECTING:pf.FAILED),I3(t=>t!==pf.REDIRECTING),I8(1)).subscribe(()=>{e()})}function Vme(r){throw r}const Hme={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Fme={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Xn=(()=>{class r{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=Le(oF),this.stateManager=Le(hB),this.options=Le(G8,{optional:!0})||{},this.pendingTasks=Le(E8),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=Le(Fp),this.urlSerializer=Le(z8),this.location=Le(z7),this.urlHandlingStrategy=Le(NS),this._events=new xs,this.errorHandler=this.options.errorHandler||Vme,this.navigated=!1,this.routeReuseStrategy=Le(xme),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=Le(B8,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!Le(zp,{optional:!0}),this.eventsSubscription=new Ue,this.isNgZoneEnabled=Le(bn)instanceof bn&&bn.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(n=>{try{const i=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(null!==i&&null!==o)if(this.stateManager.handleRouterEvent(n,o),n instanceof D8&&n.code!==$s.Redirect&&n.code!==$s.SupersededByNewNavigation)this.navigated=!0;else if(n instanceof Oc)this.navigated=!0;else if(n instanceof hS){const s=this.urlHandlingStrategy.merge(n.url,i.currentRawUrl),a={info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Rme(i.source)};this.scheduleNavigation(s,cf,null,a,{resolve:i.resolve,reject:i.reject,promise:i.promise})}(function $me(r){return!(r instanceof dS||r instanceof hS)})(n)&&this._events.next(n)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),cf,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,n)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",n)},0)})}navigateToSyncWithBrowser(t,n,i){const o={replaceUrl:!0},s=i?.navigationId?i:null;if(i){const c={...i};delete c.navigationId,delete c.\u0275routerPageId,0!==Object.keys(c).length&&(o.state=c)}const a=this.parseUrl(t);this.scheduleNavigation(a,n,s,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(PS),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,n={}){const{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:c}=n,l=c?this.currentUrlTree.fragment:s;let f,u=null;switch(a){case"merge":u={...this.currentUrlTree.queryParams,...o};break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=o||null}null!==u&&(u=this.removeEmptyProps(u));try{f=DG(i?i.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),f=this.currentUrlTree.root}return VG(f,t,u,l??null)}navigateByUrl(t,n={skipLocationChange:!1}){const i=m6(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,cf,null,n)}navigate(t,n={skipLocationChange:!1}){return function Ume(r){for(let e=0;e<r.length;e++)if(null==r[e])throw new ge(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,n),n)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,n){let i;if(i=!0===n?{...Hme}:!1===n?{...Fme}:n,m6(t))return bG(this.currentUrlTree,t,i);const o=this.parseUrl(t);return bG(this.currentUrlTree,o,i)}removeEmptyProps(t){return Object.entries(t).reduce((n,[i,o])=>(null!=o&&(n[i]=o),n),{})}scheduleNavigation(t,n,i,o,s){if(this.disposed)return Promise.resolve(!1);let a,c,l;s?(a=s.resolve,c=s.reject,l=s.promise):l=new Promise((f,g)=>{a=f,c=g});const u=this.pendingTasks.add();return gB(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:n,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(f=>Promise.reject(f))}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Ac=(()=>{class r{constructor(t,n,i,o,s,a){this.router=t,this.route=n,this.tabIndexAttribute=i,this.renderer=o,this.el=s,this.locationStrategy=a,this.href=null,this.commands=null,this.onChanges=new xs,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const c=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===c||"area"===c,this.isAnchorElement?this.subscription=t.events.subscribe(l=>{l instanceof Oc&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,n,i,o,s){return!!(null===this.urlTree||this.isAnchorElement&&(0!==t||n||i||o||s||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const t=null===this.href?null:function rz(r,e,t){return function i4e(r,e){return"src"===e&&("embed"===r||"frame"===r||"iframe"===r||"media"===r||"script"===r)||"href"===e&&("base"===r||"link"===r)?nz:jh}(e,t)(r)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(t,n){const i=this.renderer,o=this.el.nativeElement;null!==n?i.setAttribute(o,t,n):i.removeAttribute(o,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static#e=this.\u0275fac=function(n){return new(n||r)(G(Xn),G(uo),function Ch(r){return function oce(r,e){if("class"===e)return r.classes;if("style"===e)return r.styles;const t=r.attrs;if(t){const n=t.length;let i=0;for(;i<n;){const o=t[i];if(YR(o))break;if(0===o)i+=2;else if("number"==typeof o)for(i++;i<n&&"string"==typeof t[i];)i++;else{if(o===e)return t[i+1];i+=2}}}return null}(_1(),r)}("tabindex"),G(fc),G(V2),G(a6))};static#t=this.\u0275dir=Dt({type:r,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(n,i){1&n&&W("click",function(s){return i.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&n&&w("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[Z1.HasDecoratorInputTransform,"preserveFragment","preserveFragment",S8],skipLocationChange:[Z1.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",S8],replaceUrl:[Z1.HasDecoratorInputTransform,"replaceUrl","replaceUrl",S8],routerLink:"routerLink"},standalone:!0,features:[lD,c2]})}return r})();class pB{}let Wme=(()=>{class r{constructor(t,n,i,o,s){this.router=t,this.injector=i,this.preloadingStrategy=o,this.loader=s}setUpPreloading(){this.subscription=this.router.events.pipe(I3(t=>t instanceof Oc),w8(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,n){const i=[];for(const o of n){o.providers&&!o._injector&&(o._injector=kE(o.providers,t,`Route: ${o.path}`));const s=o._injector??t,a=o._loadedInjector??s;(o.loadChildren&&!o._loadedRoutes&&void 0===o.canLoad||o.loadComponent&&!o._loadedComponent)&&i.push(this.preloadConfig(s,o)),(o.children||o._loadedRoutes)&&i.push(this.processRoutes(a,o.children??o._loadedRoutes))}return Mi(i).pipe(ef())}preloadConfig(t,n){return this.preloadingStrategy.preload(n,()=>{let i;i=n.loadChildren&&void 0===n.canLoad?this.loader.loadChildren(t,n):Wt(null);const o=i.pipe(F2(s=>null===s?Wt(void 0):(n._loadedRoutes=s.routes,n._loadedInjector=s.injector,this.processRoutes(s.injector??t,s.routes))));return n.loadComponent&&!n._loadedComponent?Mi([o,this.loader.loadComponent(n)]).pipe(ef()):o})}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(Xn),Ae(sF),Ae(es),Ae(pB),Ae(wS))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();const IS=new Qe("");let mB=(()=>{class r{constructor(t,n,i,o,s={}){this.urlSerializer=t,this.transitions=n,this.viewportScroller=i,this.zone=o,this.options=s,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},s.scrollPositionRestoration||="disabled",s.anchorScrolling||="disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Rp?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Oc?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof V8&&t.code===xp.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof WG&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,n){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new WG(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,n))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(n){!function Nz(){throw new Error("invalid")}()};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();function bc(r,e){return{\u0275kind:r,\u0275providers:e}}function CB(){const r=Le(Li);return e=>{const t=r.get(I4);if(e!==t.components[0])return;const n=r.get(Xn),i=r.get(vB);1===r.get(kS)&&n.initialNavigation(),r.get(yB,null,Mn.Optional)?.setUpPreloading(),r.get(IS,null,Mn.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const vB=new Qe("",{factory:()=>new xs}),kS=new Qe("",{providedIn:"root",factory:()=>1}),yB=new Qe("");function Yme(r){return bc(0,[{provide:yB,useExisting:Wme},{provide:pB,useExisting:r}])}function Xme(r){return bc(9,[{provide:fB,useValue:Ime},{provide:dB,useValue:{skipNextTransition:!!r?.skipInitialTransition,...r}}])}const MB=new Qe("ROUTER_FORROOT_GUARD"),Qme=[z7,{provide:z8,useClass:aS},Xn,lf,{provide:uo,useFactory:function _B(r){return r.routerState.root},deps:[Xn]},wS,[]];let Jme=(()=>{class r{constructor(t){}static forRoot(t,n){return{ngModule:r,providers:[Qme,[],{provide:B8,multi:!0,useValue:t},{provide:MB,useFactory:r_e,deps:[[Xn,new Jo,new Eh]]},{provide:G8,useValue:n||{}},n?.useHash?{provide:a6,useClass:j7e}:{provide:a6,useClass:ZF},{provide:IS,useFactory:()=>{const r=Le(d9e),e=Le(bn),t=Le(G8),n=Le(Fp),i=Le(z8);return t.scrollOffset&&r.setOffset(t.scrollOffset),new mB(i,n,r,e,t)}},n?.preloadingStrategy?Yme(n.preloadingStrategy).\u0275providers:[],n?.initialNavigation?i_e(n):[],n?.bindToComponentInputs?bc(8,[QG,{provide:zp,useExisting:QG}]).\u0275providers:[],n?.enableViewTransitions?Xme().\u0275providers:[],[{provide:EB,useFactory:CB},{provide:BE,multi:!0,useExisting:EB}]]}}static forChild(t){return{ngModule:r,providers:[{provide:B8,multi:!0,useValue:t}]}}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(MB,8))};static#t=this.\u0275mod=N2({type:r});static#n=this.\u0275inj=s2({})}return r})();function r_e(r){return"guarded"}function i_e(r){return["disabled"===r.initialNavigation?bc(3,[{provide:$E,multi:!0,useFactory:()=>{const e=Le(Xn);return()=>{e.setUpLocationChangeListener()}}},{provide:kS,useValue:2}]).\u0275providers:[],"enabledBlocking"===r.initialNavigation?bc(2,[{provide:kS,useValue:0},{provide:$E,multi:!0,deps:[Li],useFactory:e=>{const t=e.get(W7e,Promise.resolve());return()=>t.then(()=>new Promise(n=>{const i=e.get(Xn),o=e.get(vB);gB(i,()=>{n(!0)}),e.get(Fp).afterPreactivation=()=>(n(!0),o.closed?Wt(void 0):o),i.initialNavigation()}))}}]).\u0275providers:[]]}const EB=new Qe("");var qt=function(r){return r[r.State=0]="State",r[r.Transition=1]="Transition",r[r.Sequence=2]="Sequence",r[r.Group=3]="Group",r[r.Animate=4]="Animate",r[r.Keyframes=5]="Keyframes",r[r.Style=6]="Style",r[r.Trigger=7]="Trigger",r[r.Reference=8]="Reference",r[r.AnimateChild=9]="AnimateChild",r[r.AnimateRef=10]="AnimateRef",r[r.Query=11]="Query",r[r.Stagger=12]="Stagger",r}(qt||{});const R3="*";function PB(r){return{type:qt.Style,styles:r,offset:null}}class mf{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class SB{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,i=0;const o=this.players.length;0==o?queueMicrotask(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++t==o&&this._onFinish()}),s.onDestroy(()=>{++n==o&&this._onDestroy()}),s.onStart(()=>{++i==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(n=>{const i=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(i)})}getPosition(){const e=this.players.reduce((t,n)=>null===t||n.totalTime>t.totalTime?n:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}function OB(r){return new ge(3e3,!1)}function j4(r){switch(r.length){case 0:return new mf;case 1:return r[0];default:return new SB(r)}}function TB(r,e,t=new Map,n=new Map){const i=[],o=[];let s=-1,a=null;if(e.forEach(c=>{const l=c.get("offset"),u=l==s,f=u&&a||new Map;c.forEach((g,y)=>{let S=y,I=g;if("offset"!==y)switch(S=r.normalizePropertyName(S,i),I){case"!":I=t.get(y);break;case R3:I=n.get(y);break;default:I=r.normalizeStyleValue(y,S,I,i)}f.set(S,I)}),u||o.push(f),a=f,s=l}),i.length)throw function k_e(r){return new ge(3502,!1)}();return o}function xS(r,e,t,n){switch(e){case"start":r.onStart(()=>n(t&&LS(t,"start",r)));break;case"done":r.onDone(()=>n(t&&LS(t,"done",r)));break;case"destroy":r.onDestroy(()=>n(t&&LS(t,"destroy",r)))}}function LS(r,e,t){const o=zS(r.element,r.triggerName,r.fromState,r.toState,e||r.phaseName,t.totalTime??r.totalTime,!!t.disabled),s=r._data;return null!=s&&(o._data=s),o}function zS(r,e,t,n,i="",o=0,s){return{element:r,triggerName:e,fromState:t,toState:n,phaseName:i,totalTime:o,disabled:!!s}}function ss(r,e,t){let n=r.get(e);return n||r.set(e,n=t),n}function AB(r){const e=r.indexOf(":");return[r.substring(1,e),r.slice(e+1)]}const B_e=typeof document>"u"?null:document.documentElement;function DS(r){const e=r.parentNode||r.host||null;return e===B_e?null:e}let _6=null,bB=!1;function wB(r,e){for(;e;){if(e===r)return!0;e=DS(e)}return!1}function NB(r,e,t){if(t)return Array.from(r.querySelectorAll(e));const n=r.querySelector(e);return n?[n]:[]}let VS=(()=>{class r{validateStyleProperty(t){return function q_e(r){_6||(_6=function j_e(){return typeof document<"u"?document.body:null}()||{},bB=!!_6.style&&"WebkitAppearance"in _6.style);let e=!0;return _6.style&&!function W_e(r){return"ebkit"==r.substring(1,6)}(r)&&(e=r in _6.style,!e&&bB&&(e="Webkit"+r.charAt(0).toUpperCase()+r.slice(1)in _6.style)),e}(t)}matchesElement(t,n){return!1}containsElement(t,n){return wB(t,n)}getParentElement(t){return DS(t)}query(t,n,i){return NB(t,n,i)}computeStyle(t,n,i){return i||""}animate(t,n,i,o,s,a=[],c){return new mf(i,o)}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})(),HS=(()=>{class r{static#e=this.NOOP=new VS}return r})();class FS{}const Y_e=1e3,US="ng-enter",Up="ng-leave",$p="ng-trigger",Gp=".ng-trigger",kB="ng-animating",$S=".ng-animating";function x3(r){if("number"==typeof r)return r;const e=r.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:GS(parseFloat(e[1]),e[2])}function GS(r,e){return"s"===e?r*Y_e:r}function Bp(r,e,t){return r.hasOwnProperty("duration")?r:function X_e(r,e,t){let i,o=0,s="";if("string"==typeof r){const a=r.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(OB()),{duration:0,delay:0,easing:""};i=GS(parseFloat(a[1]),a[2]);const c=a[3];null!=c&&(o=GS(parseFloat(c),a[4]));const l=a[5];l&&(s=l)}else i=r;if(!t){let a=!1,c=e.length;i<0&&(e.push(function u_e(){return new ge(3100,!1)}()),a=!0),o<0&&(e.push(function f_e(){return new ge(3101,!1)}()),a=!0),a&&e.splice(c,0,OB())}return{duration:i,delay:o,easing:s}}(r,e,t)}function wc(r,e,t){e.forEach((n,i)=>{const o=WS(i);t&&!t.has(i)&&t.set(i,r.style[o]),r.style[o]=n})}function C6(r,e){e.forEach((t,n)=>{const i=WS(n);r.style[i]=""})}function _f(r){return Array.isArray(r)?1==r.length?r[0]:function s_e(r,e=null){return{type:qt.Sequence,steps:r,options:e}}(r):r}const BS=new RegExp("{{\\s*(.+?)\\s*}}","g");function xB(r){let e=[];if("string"==typeof r){let t;for(;t=BS.exec(r);)e.push(t[1]);BS.lastIndex=0}return e}function Cf(r,e,t){const n=`${r}`,i=n.replace(BS,(o,s)=>{let a=e[s];return null==a&&(t.push(function h_e(r){return new ge(3003,!1)}()),a=""),a.toString()});return i==n?r:i}const eCe=/-+([a-z0-9])/g;function WS(r){return r.replace(eCe,(...e)=>e[1].toUpperCase())}function as(r,e,t){switch(e.type){case qt.Trigger:return r.visitTrigger(e,t);case qt.State:return r.visitState(e,t);case qt.Transition:return r.visitTransition(e,t);case qt.Sequence:return r.visitSequence(e,t);case qt.Group:return r.visitGroup(e,t);case qt.Animate:return r.visitAnimate(e,t);case qt.Keyframes:return r.visitKeyframes(e,t);case qt.Style:return r.visitStyle(e,t);case qt.Reference:return r.visitReference(e,t);case qt.AnimateChild:return r.visitAnimateChild(e,t);case qt.AnimateRef:return r.visitAnimateRef(e,t);case qt.Query:return r.visitQuery(e,t);case qt.Stagger:return r.visitStagger(e,t);default:throw function g_e(r){return new ge(3004,!1)}()}}function qS(r,e){return window.getComputedStyle(r)[e]}const rCe=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class LB extends FS{normalizePropertyName(e,t){return WS(e)}normalizeStyleValue(e,t,n,i){let o="";const s=n.toString().trim();if(rCe.has(t)&&0!==n&&"0"!==n)if("number"==typeof n)o="px";else{const a=n.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&i.push(function p_e(r,e){return new ge(3005,!1)}())}return s+o}}const Wp="*";const qp=new Set(["true","1"]),jp=new Set(["false","0"]);function zB(r,e){const t=qp.has(r)||jp.has(r),n=qp.has(e)||jp.has(e);return(i,o)=>{let s=r==Wp||r==i,a=e==Wp||e==o;return!s&&t&&"boolean"==typeof i&&(s=i?qp.has(r):jp.has(r)),!a&&n&&"boolean"==typeof o&&(a=o?qp.has(e):jp.has(e)),s&&a}}const aCe=new RegExp("s*:selfs*,?","g");function jS(r,e,t,n){return new cCe(r).build(e,t,n)}class cCe{constructor(e){this._driver=e}build(e,t,n){const i=new fCe(t);return this._resetContextStyleTimingState(i),as(this,_f(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,i=t.depCount=0;const o=[],s=[];return"@"==e.name.charAt(0)&&t.errors.push(function m_e(){return new ge(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),a.type==qt.State){const c=a,l=c.name;l.toString().split(/\s*,\s*/).forEach(u=>{c.name=u,o.push(this.visitState(c,t))}),c.name=l}else if(a.type==qt.Transition){const c=this.visitTransition(a,t);n+=c.queryCount,i+=c.depCount,s.push(c)}else t.errors.push(function __e(){return new ge(3007,!1)}())}),{type:qt.Trigger,name:e.name,states:o,transitions:s,queryCount:n,depCount:i,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),i=e.options&&e.options.params||null;if(n.containsDynamicStyles){const o=new Set,s=i||{};n.styles.forEach(a=>{a instanceof Map&&a.forEach(c=>{xB(c).forEach(l=>{s.hasOwnProperty(l)||o.add(l)})})}),o.size&&t.errors.push(function C_e(r,e){return new ge(3008,!1)}(0,o.values()))}return{type:qt.State,name:e.name,style:n,options:i?{params:i}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=as(this,_f(e.animation),t),i=function iCe(r,e){const t=[];return"string"==typeof r?r.split(/\s*,\s*/).forEach(n=>function oCe(r,e,t){if(":"==r[0]){const c=function sCe(r,e){switch(r){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(function b_e(r){return new ge(3016,!1)}()),"* => *"}}(r,t);if("function"==typeof c)return void e.push(c);r=c}const n=r.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(function A_e(r){return new ge(3015,!1)}()),e;const i=n[1],o=n[2],s=n[3];e.push(zB(i,s)),"<"==o[0]&&(i!=Wp||s!=Wp)&&e.push(zB(s,i))}(n,t,e)):t.push(r),t}(e.expr,t.errors);return{type:qt.Transition,matchers:i,animation:n,queryCount:t.queryCount,depCount:t.depCount,options:v6(e.options)}}visitSequence(e,t){return{type:qt.Sequence,steps:e.steps.map(n=>as(this,n,t)),options:v6(e.options)}}visitGroup(e,t){const n=t.currentTime;let i=0;const o=e.steps.map(s=>{t.currentTime=n;const a=as(this,s,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:qt.Group,steps:o,options:v6(e.options)}}visitAnimate(e,t){const n=function hCe(r,e){if(r.hasOwnProperty("duration"))return r;if("number"==typeof r)return ZS(Bp(r,e).duration,0,"");const t=r;if(t.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=ZS(0,0,"");return o.dynamic=!0,o.strValue=t,o}const i=Bp(t,e);return ZS(i.duration,i.delay,i.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let i,o=e.styles?e.styles:PB({});if(o.type==qt.Keyframes)i=this.visitKeyframes(o,t);else{let s=e.styles,a=!1;if(!s){a=!0;const l={};n.easing&&(l.easing=n.easing),s=PB(l)}t.currentTime+=n.duration+n.delay;const c=this.visitStyle(s,t);c.isEmptyStep=a,i=c}return t.currentAnimateTimings=null,{type:qt.Animate,timings:n,style:i,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[],i=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of i)"string"==typeof a?a===R3?n.push(a):t.errors.push(new ge(3002,!1)):n.push(new Map(Object.entries(a)));let o=!1,s=null;return n.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(s=a.get("easing"),a.delete("easing")),!o))for(let c of a.values())if(c.toString().indexOf("{{")>=0){o=!0;break}}),{type:qt.Style,styles:n,easing:s,offset:e.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let i=t.currentTime,o=t.currentTime;n&&o>0&&(o-=n.duration+n.delay),e.styles.forEach(s=>{"string"!=typeof s&&s.forEach((a,c)=>{const l=t.collectedStyles.get(t.currentQuerySelector),u=l.get(c);let f=!0;u&&(o!=i&&o>=u.startTime&&i<=u.endTime&&(t.errors.push(function y_e(r,e,t,n,i){return new ge(3010,!1)}()),f=!1),o=u.startTime),f&&l.set(c,{startTime:o,endTime:i}),t.options&&function J_e(r,e,t){const n=e.params||{},i=xB(r);i.length&&i.forEach(o=>{n.hasOwnProperty(o)||t.push(function d_e(r){return new ge(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const n={type:qt.Keyframes,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function M_e(){return new ge(3011,!1)}()),n;let o=0;const s=[];let a=!1,c=!1,l=0;const u=e.steps.map(U=>{const $=this._makeStyleAst(U,t);let oe=null!=$.offset?$.offset:function dCe(r){if("string"==typeof r)return null;let e=null;if(Array.isArray(r))r.forEach(t=>{if(t instanceof Map&&t.has("offset")){const n=t;e=parseFloat(n.get("offset")),n.delete("offset")}});else if(r instanceof Map&&r.has("offset")){const t=r;e=parseFloat(t.get("offset")),t.delete("offset")}return e}($.styles),_e=0;return null!=oe&&(o++,_e=$.offset=oe),c=c||_e<0||_e>1,a=a||_e<l,l=_e,s.push(_e),$});c&&t.errors.push(function E_e(){return new ge(3012,!1)}()),a&&t.errors.push(function P_e(){return new ge(3200,!1)}());const f=e.steps.length;let g=0;o>0&&o<f?t.errors.push(function S_e(){return new ge(3202,!1)}()):0==o&&(g=1/(f-1));const y=f-1,S=t.currentTime,I=t.currentAnimateTimings,R=I.duration;return u.forEach((U,$)=>{const oe=g>0?$==y?1:g*$:s[$],_e=oe*R;t.currentTime=S+I.delay+_e,I.duration=_e,this._validateStyleAst(U,t),U.offset=oe,n.styles.push(U)}),n}visitReference(e,t){return{type:qt.Reference,animation:as(this,_f(e.animation),t),options:v6(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:qt.AnimateChild,options:v6(e.options)}}visitAnimateRef(e,t){return{type:qt.AnimateRef,animation:this.visitReference(e.animation,t),options:v6(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,i=e.options||{};t.queryCount++,t.currentQuery=e;const[o,s]=function lCe(r){const e=!!r.split(/\s*,\s*/).find(t=>":self"==t);return e&&(r=r.replace(aCe,"")),r=r.replace(/@\*/g,Gp).replace(/@\w+/g,t=>Gp+"-"+t.slice(1)).replace(/:animating/g,$S),[r,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+o:o,ss(t.collectedStyles,t.currentQuerySelector,new Map);const a=as(this,_f(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:qt.Query,selector:o,limit:i.limit||0,optional:!!i.optional,includeSelf:s,animation:a,originalSelector:e.selector,options:v6(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function O_e(){return new ge(3013,!1)}());const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:Bp(e.timings,t.errors,!0);return{type:qt.Stagger,animation:as(this,_f(e.animation),t),timings:n,options:null}}}class fCe{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function v6(r){return r?(r={...r}).params&&(r.params=function uCe(r){return r?{...r}:null}(r.params)):r={},r}function ZS(r,e,t){return{duration:r,delay:e,easing:t}}function YS(r,e,t,n,i,o,s=null,a=!1){return{type:1,element:r,keyframes:e,preStyleProps:t,postStyleProps:n,duration:i,delay:o,totalTime:i+o,easing:s,subTimeline:a}}class Zp{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const mCe=new RegExp(":enter","g"),CCe=new RegExp(":leave","g");function KS(r,e,t,n,i,o=new Map,s=new Map,a,c,l=[]){return(new vCe).buildKeyframes(r,e,t,n,i,o,s,a,c,l)}class vCe{buildKeyframes(e,t,n,i,o,s,a,c,l,u=[]){l=l||new Zp;const f=new XS(e,t,l,i,o,u,[]);f.options=c;const g=c.delay?x3(c.delay):0;f.currentTimeline.delayNextStep(g),f.currentTimeline.setStyles([s],null,f.errors,c),as(this,n,f);const y=f.timelines.filter(S=>S.containsAnimation());if(y.length&&a.size){let S;for(let I=y.length-1;I>=0;I--){const R=y[I];if(R.element===t){S=R;break}}S&&!S.allowOnlyTimelineStyles()&&S.setStyles([a],null,f.errors,c)}return y.length?y.map(S=>S.buildKeyframes()):[YS(t,[],[],[],0,g,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const i=t.createSubContext(e.options),o=t.currentTimeline.currentTime,s=this._visitSubInstructions(n,i,i.options);o!=s&&t.transformIntoNewTimeline(s)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,n),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,n){for(const i of e){const o=i?.delay;if(o){const s="number"==typeof o?o:x3(Cf(o,i?.params??{},t.errors));n.delayNextStep(s)}}}_visitSubInstructions(e,t,n){let o=t.currentTimeline.currentTime;const s=null!=n.duration?x3(n.duration):null,a=null!=n.delay?x3(n.delay):null;return 0!==s&&e.forEach(c=>{const l=t.appendInstructionToTimeline(c,s,a);o=Math.max(o,l.duration+l.delay)}),o}visitReference(e,t){t.updateOptions(e.options,!0),as(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let i=t;const o=e.options;if(o&&(o.params||o.delay)&&(i=t.createSubContext(o),i.transformIntoNewTimeline(),null!=o.delay)){i.previousNode.type==qt.Style&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=Yp);const s=x3(o.delay);i.delayNextStep(s)}e.steps.length&&(e.steps.forEach(s=>as(this,s,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>n&&i.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let i=t.currentTimeline.currentTime;const o=e.options&&e.options.delay?x3(e.options.delay):0;e.steps.forEach(s=>{const a=t.createSubContext(e.options);o&&a.delayNextStep(o),as(this,s,a),i=Math.max(i,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(s=>t.currentTimeline.mergeTimelineCollectedStyles(s)),t.transformIntoNewTimeline(i),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return Bp(t.params?Cf(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),i=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),i.snapshotCurrentStyles());const o=e.style;o.type==qt.Keyframes?this.visitKeyframes(o,t):(t.incrementTime(n.duration),this.visitStyle(o,t),i.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,i=t.currentAnimateTimings;!i&&n.hasCurrentStyleProperties()&&n.forwardFrame();const o=i&&i.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(o):n.setStyles(e.styles,o,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,i=t.currentTimeline.duration,o=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(c=>{a.forwardTime((c.offset||0)*o),a.setStyles(c.styles,c.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(i+o),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,i=e.options||{},o=i.delay?x3(i.delay):0;o&&(t.previousNode.type===qt.Style||0==n&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=Yp);let s=n;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=a.length;let c=null;a.forEach((l,u)=>{t.currentQueryIndex=u;const f=t.createSubContext(e.options,l);o&&f.delayNextStep(o),l===t.element&&(c=f.currentTimeline),as(this,e.animation,f),f.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,f.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(s),c&&(t.currentTimeline.mergeTimelineCollectedStyles(c),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,i=t.currentTimeline,o=e.timings,s=Math.abs(o.duration),a=s*(t.currentQueryTotal-1);let c=s*t.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":c=a-c;break;case"full":c=n.currentStaggerTime}const u=t.currentTimeline;c&&u.delayNextStep(c);const f=u.currentTime;as(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=i.currentTime-f+(i.startTime-n.currentTimeline.startTime)}}const Yp={};class XS{constructor(e,t,n,i,o,s,a,c){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=i,this._leaveClassName=o,this.errors=s,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Yp,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=c||new Kp(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let i=this.options;null!=n.duration&&(i.duration=x3(n.duration)),null!=n.delay&&(i.delay=x3(n.delay));const o=n.params;if(o){let s=i.params;s||(s=this.options.params={}),Object.keys(o).forEach(a=>{(!t||!s.hasOwnProperty(a))&&(s[a]=Cf(o[a],s,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(i=>{n[i]=t[i]})}}return e}createSubContext(e=null,t,n){const i=t||this.element,o=new XS(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,n||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(e),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(e){return this.previousNode=Yp,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const i={duration:t??e.duration,delay:this.currentTimeline.currentTime+(n??0)+e.delay,easing:""},o=new yCe(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(o),i}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,i,o,s){let a=[];if(i&&a.push(this.element),e.length>0){e=(e=e.replace(mCe,"."+this._enterClassName)).replace(CCe,"."+this._leaveClassName);let l=this._driver.query(this.element,e,1!=n);0!==n&&(l=n<0?l.slice(l.length+n,l.length):l.slice(0,n)),a.push(...l)}return!o&&0==a.length&&s.push(function T_e(r){return new ge(3014,!1)}()),a}}class Kp{constructor(e,t,n,i){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=i,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new Kp(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,n]of this._globalTimelineStyles)this._backFill.set(t,n||R3),this._currentKeyframe.set(t,R3);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,i){t&&this._previousKeyframe.set("easing",t);const o=i&&i.params||{},s=function MCe(r,e){const t=new Map;let n;return r.forEach(i=>{if("*"===i){n??=e.keys();for(let o of n)t.set(o,R3)}else for(let[o,s]of i)t.set(o,s)}),t}(e,this._globalTimelineStyles);for(let[a,c]of s){const l=Cf(c,o,n);this._pendingStyles.set(a,l),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??R3),this._updateStyle(a,l)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,n)=>{const i=this._styleSummary.get(n);(!i||t.time>i.time)&&this._updateStyle(n,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((a,c)=>{const l=new Map([...this._backFill,...a]);l.forEach((u,f)=>{"!"===u?e.add(f):u===R3&&t.add(f)}),n||l.set("offset",c/this.duration),i.push(l)});const o=[...e.values()],s=[...t.values()];if(n){const a=i[0],c=new Map(a);a.set("offset",0),c.set("offset",1),i=[a,c]}return YS(this.element,i,o,s,this.duration,this.startTime,this.easing,!1)}}class yCe extends Kp{constructor(e,t,n,i,o,s,a=!1){super(e,t,s.delay),this.keyframes=n,this.preStyleProps=i,this.postStyleProps=o,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:i}=this.timings;if(this._stretchStartingKeyframe&&t){const o=[],s=n+t,a=t/s,c=new Map(e[0]);c.set("offset",0),o.push(c);const l=new Map(e[0]);l.set("offset",HB(a)),o.push(l);const u=e.length-1;for(let f=1;f<=u;f++){let g=new Map(e[f]);const y=g.get("offset");g.set("offset",HB((t+y*n)/s)),o.push(g)}n=s,t=0,i="",e=o}return YS(this.element,e,this.preStyleProps,this.postStyleProps,n,t,i,!0)}}function HB(r,e=3){const t=Math.pow(10,e-1);return Math.round(r*t)/t}function FB(r,e,t,n,i,o,s,a,c,l,u,f,g){return{type:0,element:r,triggerName:e,isRemovalTransition:i,fromState:t,fromStyles:o,toState:n,toStyles:s,timelines:a,queriedElements:c,preStyleProps:l,postStyleProps:u,totalTime:f,errors:g}}const QS={};class UB{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,i){return function ECe(r,e,t,n,i){return r.some(o=>o(e,t,n,i))}(this.ast.matchers,e,t,n,i)}buildStyles(e,t,n){let i=this._stateStyles.get("*");return void 0!==e&&(i=this._stateStyles.get(e?.toString())||i),i?i.buildStyles(t,n):new Map}build(e,t,n,i,o,s,a,c,l,u){const f=[],g=this.ast.options&&this.ast.options.params||QS,S=this.buildStyles(n,a&&a.params||QS,f),I=c&&c.params||QS,R=this.buildStyles(i,I,f),U=new Set,$=new Map,oe=new Map,_e="void"===i,Te={params:$B(I,g),delay:this.ast.options?.delay},Fe=u?[]:KS(e,t,this.ast.animation,o,s,S,R,Te,l,f);let mt=0;return Fe.forEach(rn=>{mt=Math.max(rn.duration+rn.delay,mt)}),f.length?FB(t,this._triggerName,n,i,_e,S,R,[],[],$,oe,mt,f):(Fe.forEach(rn=>{const a1=rn.element,dn=ss($,a1,new Set);rn.preStyleProps.forEach(f3=>dn.add(f3));const Gd=ss(oe,a1,new Set);rn.postStyleProps.forEach(f3=>Gd.add(f3)),a1!==t&&U.add(a1)}),FB(t,this._triggerName,n,i,_e,S,R,Fe,[...U.values()],$,oe,mt))}}function $B(r,e){const t={...e};return Object.entries(r).forEach(([n,i])=>{null!=i&&(t[n]=i)}),t}class PCe{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n=new Map,i=$B(e,this.defaultParams);return this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((s,a)=>{s&&(s=Cf(s,i,t));const c=this.normalizer.normalizePropertyName(a,t);s=this.normalizer.normalizeStyleValue(a,c,s,t),n.set(a,s)})}),n}}class OCe{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states=new Map,t.states.forEach(i=>{this.states.set(i.name,new PCe(i.style,i.options&&i.options.params||{},n))}),GB(this.states,"true","1"),GB(this.states,"false","0"),t.transitions.forEach(i=>{this.transitionFactories.push(new UB(e,i,this.states))}),this.fallbackTransition=function TCe(r,e,t){return new UB(r,{type:qt.Transition,animation:{type:qt.Sequence,steps:[],options:null},matchers:[(s,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,i){return this.transitionFactories.find(s=>s.match(e,t,n,i))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function GB(r,e,t){r.has(e)?r.has(t)||r.set(t,r.get(e)):r.has(t)&&r.set(e,r.get(t))}const ACe=new Zp;class bCe{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const n=[],o=jS(this._driver,t,n,[]);if(n.length)throw function R_e(r){return new ge(3503,!1)}();this._animations.set(e,o)}_buildPlayer(e,t,n){const i=e.element,o=TB(this._normalizer,e.keyframes,t,n);return this._driver.animate(i,o,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const i=[],o=this._animations.get(e);let s;const a=new Map;if(o?(s=KS(this._driver,t,o,US,Up,new Map,new Map,n,ACe,i),s.forEach(u=>{const f=ss(a,u.element,new Map);u.postStyleProps.forEach(g=>f.set(g,null))})):(i.push(function x_e(){return new ge(3300,!1)}()),s=[]),i.length)throw function L_e(r){return new ge(3504,!1)}();a.forEach((u,f)=>{u.forEach((g,y)=>{u.set(y,this._driver.computeStyle(f,y,R3))})});const l=j4(s.map(u=>{const f=a.get(u.element);return this._buildPlayer(u,new Map,f)}));return this._playersById.set(e,l),l.onDestroy(()=>this.destroy(e)),this.players.push(l),l}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function z_e(r){return new ge(3301,!1)}();return t}listen(e,t,n,i){const o=zS(t,"","","");return xS(this._getPlayer(e),n,o,i),()=>{}}command(e,t,n,i){if("register"==n)return void this.register(e,i[0]);if("create"==n)return void this.create(e,t,i[0]||{});const o=this._getPlayer(e);switch(n){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e)}}}const BB="ng-animate-queued",JS="ng-animate-disabled",RCe=[],WB={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},xCe={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},ka="__ng_removed";class eO{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function VCe(r){return r??null}(n?e.value:e),n){const{value:o,...s}=e;this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(i=>{null==n[i]&&(n[i]=t[i])})}}}const vf="void",tO=new eO(vf);class LCe{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Gs(t,this._hostClassName)}listen(e,t,n,i){if(!this._triggers.has(t))throw function D_e(r,e){return new ge(3302,!1)}();if(null==n||0==n.length)throw function V_e(r){return new ge(3303,!1)}();if(!function HCe(r){return"start"==r||"done"==r}(n))throw function H_e(r,e){return new ge(3400,!1)}();const o=ss(this._elementListeners,e,[]),s={name:t,phase:n,callback:i};o.push(s);const a=ss(this._engine.statesByElement,e,new Map);return a.has(t)||(Gs(e,$p),Gs(e,$p+"-"+t),a.set(t,tO)),()=>{this._engine.afterFlush(()=>{const c=o.indexOf(s);c>=0&&o.splice(c,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function F_e(r){return new ge(3401,!1)}();return t}trigger(e,t,n,i=!0){const o=this._getTrigger(t),s=new nO(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(Gs(e,$p),Gs(e,$p+"-"+t),this._engine.statesByElement.set(e,a=new Map));let c=a.get(t);const l=new eO(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&c&&l.absorbOptions(c.options),a.set(t,l),c||(c=tO),l.value!==vf&&c.value===l.value){if(!function $Ce(r,e){const t=Object.keys(r),n=Object.keys(e);if(t.length!=n.length)return!1;for(let i=0;i<t.length;i++){const o=t[i];if(!e.hasOwnProperty(o)||r[o]!==e[o])return!1}return!0}(c.params,l.params)){const I=[],R=o.matchStyles(c.value,c.params,I),U=o.matchStyles(l.value,l.params,I);I.length?this._engine.reportError(I):this._engine.afterFlush(()=>{C6(e,R),wc(e,U)})}return}const g=ss(this._engine.playersByElement,e,[]);g.forEach(I=>{I.namespaceId==this.id&&I.triggerName==t&&I.queued&&I.destroy()});let y=o.matchTransition(c.value,l.value,e,l.params),S=!1;if(!y){if(!i)return;y=o.fallbackTransition,S=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:y,fromState:c,toState:l,player:s,isFallbackTransition:S}),S||(Gs(e,BB),s.onStart(()=>{W8(e,BB)})),s.onDone(()=>{let I=this.players.indexOf(s);I>=0&&this.players.splice(I,1);const R=this._engine.playersByElement.get(e);if(R){let U=R.indexOf(s);U>=0&&R.splice(U,1)}}),this.players.push(s),g.push(s),s}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(i=>i.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,Gp,!0);n.forEach(i=>{if(i[ka])return;const o=this._engine.fetchNamespacesByElement(i);o.size?o.forEach(s=>s.triggerLeaveAnimation(i,t,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(e,t,n,i){const o=this._engine.statesByElement.get(e),s=new Map;if(o){const a=[];if(o.forEach((c,l)=>{if(s.set(l,c.value),this._triggers.has(l)){const u=this.trigger(e,l,vf,i);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,s),n&&j4(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const i=new Set;t.forEach(o=>{const s=o.name;if(i.has(s))return;i.add(s);const c=this._triggers.get(s).fallbackTransition,l=n.get(s)||tO,u=new eO(vf),f=new nO(this.id,s,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:s,transition:c,fromState:l,toState:u,player:f,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let i=!1;if(n.totalAnimations){const o=n.players.length?n.playersByQueriedElement.get(e):[];if(o&&o.length)i=!0;else{let s=e;for(;s=s.parentNode;)if(n.statesByElement.get(s)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(e),i)n.markElementAsRemoved(this.id,e,!1,t);else{const o=e[ka];(!o||o===WB)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){Gs(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const i=n.player;if(i.destroyed)return;const o=n.element,s=this._elementListeners.get(o);s&&s.forEach(a=>{if(a.name==n.triggerName){const c=zS(o,n.triggerName,n.fromState.value,n.toState.value);c._data=e,xS(n.player,a.phase,c,a.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):t.push(n)}),this._queue=[],t.sort((n,i)=>{const o=n.transition.ast.depCount,s=i.transition.ast.depCount;return 0==o||0==s?o-s:this._engine.driver.containsElement(n.element,i.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class zCe{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(i,o)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new LCe(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList,i=this.namespacesByHostElement;if(n.length-1>=0){let s=!1,a=this.driver.getParentElement(t);for(;a;){const c=i.get(a);if(c){const l=n.indexOf(c);n.splice(l+1,0,e),s=!0;break}a=this.driver.getParentElement(a)}s||n.unshift(e)}else n.push(e);return i.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let i=this._namespaceLookup[e];i&&i.register(t,n)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const n=this._fetchNamespace(e);this.namespacesByHostElement.delete(n.hostElement);const i=this._namespaceList.indexOf(n);i>=0&&this._namespaceList.splice(i,1),n.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n)for(let i of n.values())if(i.namespaceId){const o=this._fetchNamespace(i.namespaceId);o&&t.add(o)}return t}trigger(e,t,n,i){if(Xp(t)){const o=this._fetchNamespace(e);if(o)return o.trigger(t,n,i),!0}return!1}insertNode(e,t,n,i){if(!Xp(t))return;const o=t[ka];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const s=this.collectedLeaveElements.indexOf(t);s>=0&&this.collectedLeaveElements.splice(s,1)}if(e){const s=this._fetchNamespace(e);s&&s.insertNode(t,n)}i&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Gs(e,JS)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),W8(e,JS))}removeNode(e,t,n){if(Xp(t)){const i=e?this._fetchNamespace(e):null;i?i.removeNode(t,n):this.markElementAsRemoved(e,t,!1,n);const o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,n)}else this._onRemovalComplete(t,n)}markElementAsRemoved(e,t,n,i,o){this.collectedLeaveElements.push(t),t[ka]={namespaceId:e,setForRemoval:i,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:o}}listen(e,t,n,i,o){return Xp(t)?this._fetchNamespace(e).listen(t,n,i,o):()=>{}}_buildInstruction(e,t,n,i,o){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,i,e.fromState.options,e.toState.options,t,o)}destroyInnerAnimations(e){let t=this.driver.query(e,Gp,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,$S,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return j4(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[ka];if(t&&t.setForRemoval){if(e[ka]=WB,t.namespaceId){this.destroyInnerAnimations(e);const n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(JS)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,i)=>this._balanceNamespaceList(n,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Gs(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let i=0;i<n.length;i++)n[i]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?j4(t).onDone(()=>{n.forEach(i=>i())}):n.forEach(i=>i())}}reportError(e){throw function U_e(r){return new ge(3402,!1)}()}_flushAnimations(e,t){const n=new Zp,i=[],o=new Map,s=[],a=new Map,c=new Map,l=new Map,u=new Set;this.disabledNodes.forEach(ht=>{u.add(ht);const Ot=this.driver.query(ht,".ng-animate-queued",!0);for(let Lt=0;Lt<Ot.length;Lt++)u.add(Ot[Lt])});const f=this.bodyNode,g=Array.from(this.statesByElement.keys()),y=ZB(g,this.collectedEnterElements),S=new Map;let I=0;y.forEach((ht,Ot)=>{const Lt=US+I++;S.set(Ot,Lt),ht.forEach(Dn=>Gs(Dn,Lt))});const R=[],U=new Set,$=new Set;for(let ht=0;ht<this.collectedLeaveElements.length;ht++){const Ot=this.collectedLeaveElements[ht],Lt=Ot[ka];Lt&&Lt.setForRemoval&&(R.push(Ot),U.add(Ot),Lt.hasAnimation?this.driver.query(Ot,".ng-star-inserted",!0).forEach(Dn=>U.add(Dn)):$.add(Ot))}const oe=new Map,_e=ZB(g,Array.from(U));_e.forEach((ht,Ot)=>{const Lt=Up+I++;oe.set(Ot,Lt),ht.forEach(Dn=>Gs(Dn,Lt))}),e.push(()=>{y.forEach((ht,Ot)=>{const Lt=S.get(Ot);ht.forEach(Dn=>W8(Dn,Lt))}),_e.forEach((ht,Ot)=>{const Lt=oe.get(Ot);ht.forEach(Dn=>W8(Dn,Lt))}),R.forEach(ht=>{this.processLeaveNode(ht)})});const Te=[],Fe=[];for(let ht=this._namespaceList.length-1;ht>=0;ht--)this._namespaceList[ht].drainQueuedTransitions(t).forEach(Lt=>{const Dn=Lt.player,Jr=Lt.element;if(Te.push(Dn),this.collectedEnterElements.length){const no=Jr[ka];if(no&&no.setForMove){if(no.previousTriggersValues&&no.previousTriggersValues.has(Lt.triggerName)){const v0=no.previousTriggersValues.get(Lt.triggerName),pa=this.statesByElement.get(Lt.element);if(pa&&pa.has(Lt.triggerName)){const Sv=pa.get(Lt.triggerName);Sv.value=v0,pa.set(Lt.triggerName,Sv)}}return void Dn.destroy()}}const Kt=!f||!this.driver.containsElement(f,Jr),ws=oe.get(Jr),Vl=S.get(Jr),Er=this._buildInstruction(Lt,n,Vl,ws,Kt);if(Er.errors&&Er.errors.length)return void Fe.push(Er);if(Kt)return Dn.onStart(()=>C6(Jr,Er.fromStyles)),Dn.onDestroy(()=>wc(Jr,Er.toStyles)),void i.push(Dn);if(Lt.isFallbackTransition)return Dn.onStart(()=>C6(Jr,Er.fromStyles)),Dn.onDestroy(()=>wc(Jr,Er.toStyles)),void i.push(Dn);const bse=[];Er.timelines.forEach(no=>{no.stretchStartingKeyframe=!0,this.disabledNodes.has(no.element)||bse.push(no)}),Er.timelines=bse,n.append(Jr,Er.timelines),s.push({instruction:Er,player:Dn,element:Jr}),Er.queriedElements.forEach(no=>ss(a,no,[]).push(Dn)),Er.preStyleProps.forEach((no,v0)=>{if(no.size){let pa=c.get(v0);pa||c.set(v0,pa=new Set),no.forEach((Sv,pR)=>pa.add(pR))}}),Er.postStyleProps.forEach((no,v0)=>{let pa=l.get(v0);pa||l.set(v0,pa=new Set),no.forEach((Sv,pR)=>pa.add(pR))})});if(Fe.length){const ht=[];Fe.forEach(Ot=>{ht.push(function $_e(r,e){return new ge(3505,!1)}())}),Te.forEach(Ot=>Ot.destroy()),this.reportError(ht)}const mt=new Map,rn=new Map;s.forEach(ht=>{const Ot=ht.element;n.has(Ot)&&(rn.set(Ot,Ot),this._beforeAnimationBuild(ht.player.namespaceId,ht.instruction,mt))}),i.forEach(ht=>{const Ot=ht.element;this._getPreviousPlayers(Ot,!1,ht.namespaceId,ht.triggerName,null).forEach(Dn=>{ss(mt,Ot,[]).push(Dn),Dn.destroy()})});const a1=R.filter(ht=>KB(ht,c,l)),dn=new Map;jB(dn,this.driver,$,l,R3).forEach(ht=>{KB(ht,c,l)&&a1.push(ht)});const f3=new Map;y.forEach((ht,Ot)=>{jB(f3,this.driver,new Set(ht),c,"!")}),a1.forEach(ht=>{const Ot=dn.get(ht),Lt=f3.get(ht);dn.set(ht,new Map([...Ot?.entries()??[],...Lt?.entries()??[]]))});const Tu=[],Bd=[],Wd={};s.forEach(ht=>{const{element:Ot,player:Lt,instruction:Dn}=ht;if(n.has(Ot)){if(u.has(Ot))return Lt.onDestroy(()=>wc(Ot,Dn.toStyles)),Lt.disabled=!0,Lt.overrideTotalTime(Dn.totalTime),void i.push(Lt);let Jr=Wd;if(rn.size>1){let ws=Ot;const Vl=[];for(;ws=ws.parentNode;){const Er=rn.get(ws);if(Er){Jr=Er;break}Vl.push(ws)}Vl.forEach(Er=>rn.set(Er,Jr))}const Kt=this._buildAnimation(Lt.namespaceId,Dn,mt,o,f3,dn);if(Lt.setRealPlayer(Kt),Jr===Wd)Tu.push(Lt);else{const ws=this.playersByElement.get(Jr);ws&&ws.length&&(Lt.parentPlayer=j4(ws)),i.push(Lt)}}else C6(Ot,Dn.fromStyles),Lt.onDestroy(()=>wc(Ot,Dn.toStyles)),Bd.push(Lt),u.has(Ot)&&i.push(Lt)}),Bd.forEach(ht=>{const Ot=o.get(ht.element);if(Ot&&Ot.length){const Lt=j4(Ot);ht.setRealPlayer(Lt)}}),i.forEach(ht=>{ht.parentPlayer?ht.syncPlayerEvents(ht.parentPlayer):ht.destroy()});for(let ht=0;ht<R.length;ht++){const Ot=R[ht],Lt=Ot[ka];if(W8(Ot,Up),Lt&&Lt.hasAnimation)continue;let Dn=[];if(a.size){let Kt=a.get(Ot);Kt&&Kt.length&&Dn.push(...Kt);let ws=this.driver.query(Ot,$S,!0);for(let Vl=0;Vl<ws.length;Vl++){let Er=a.get(ws[Vl]);Er&&Er.length&&Dn.push(...Er)}}const Jr=Dn.filter(Kt=>!Kt.destroyed);Jr.length?FCe(this,Ot,Jr):this.processLeaveNode(Ot)}return R.length=0,Tu.forEach(ht=>{this.players.push(ht),ht.onDone(()=>{ht.destroy();const Ot=this.players.indexOf(ht);this.players.splice(Ot,1)}),ht.play()}),Tu}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,i,o){let s=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(s=a)}else{const a=this.playersByElement.get(e);if(a){const c=!o||o==vf;a.forEach(l=>{l.queued||!c&&l.triggerName!=i||s.push(l)})}}return(n||i)&&(s=s.filter(a=>!(n&&n!=a.namespaceId||i&&i!=a.triggerName))),s}_beforeAnimationBuild(e,t,n){const o=t.element,s=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const c of t.timelines){const l=c.element,u=l!==o,f=ss(n,l,[]);this._getPreviousPlayers(l,u,s,a,t.toState).forEach(y=>{const S=y.getRealPlayer();S.beforeDestroy&&S.beforeDestroy(),y.destroy(),f.push(y)})}C6(o,t.fromStyles)}_buildAnimation(e,t,n,i,o,s){const a=t.triggerName,c=t.element,l=[],u=new Set,f=new Set,g=t.timelines.map(S=>{const I=S.element;u.add(I);const R=I[ka];if(R&&R.removedBeforeQueried)return new mf(S.duration,S.delay);const U=I!==c,$=function UCe(r){const e=[];return YB(r,e),e}((n.get(I)||RCe).map(mt=>mt.getRealPlayer())).filter(mt=>!!mt.element&&mt.element===I),oe=o.get(I),_e=s.get(I),Te=TB(this._normalizer,S.keyframes,oe,_e),Fe=this._buildPlayer(S,Te,$);if(S.subTimeline&&i&&f.add(I),U){const mt=new nO(e,a,I);mt.setRealPlayer(Fe),l.push(mt)}return Fe});l.forEach(S=>{ss(this.playersByQueriedElement,S.element,[]).push(S),S.onDone(()=>function DCe(r,e,t){let n=r.get(e);if(n){if(n.length){const i=n.indexOf(t);n.splice(i,1)}0==n.length&&r.delete(e)}return n}(this.playersByQueriedElement,S.element,S))}),u.forEach(S=>Gs(S,kB));const y=j4(g);return y.onDestroy(()=>{u.forEach(S=>W8(S,kB)),wc(c,t.toStyles)}),f.forEach(S=>{ss(i,S,[]).push(y)}),y}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new mf(e.duration,e.delay)}}class nO{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new mf,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,n)=>{t.forEach(i=>xS(e,n,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){ss(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function Xp(r){return r&&1===r.nodeType}function qB(r,e){const t=r.style.display;return r.style.display=e??"none",t}function jB(r,e,t,n,i){const o=[];t.forEach(c=>o.push(qB(c)));const s=[];n.forEach((c,l)=>{const u=new Map;c.forEach(f=>{const g=e.computeStyle(l,f,i);u.set(f,g),(!g||0==g.length)&&(l[ka]=xCe,s.push(l))}),r.set(l,u)});let a=0;return t.forEach(c=>qB(c,o[a++])),s}function ZB(r,e){const t=new Map;if(r.forEach(a=>t.set(a,[])),0==e.length)return t;const i=new Set(e),o=new Map;function s(a){if(!a)return 1;let c=o.get(a);if(c)return c;const l=a.parentNode;return c=t.has(l)?l:i.has(l)?1:s(l),o.set(a,c),c}return e.forEach(a=>{const c=s(a);1!==c&&t.get(c).push(a)}),t}function Gs(r,e){r.classList?.add(e)}function W8(r,e){r.classList?.remove(e)}function FCe(r,e,t){j4(t).onDone(()=>r.processLeaveNode(e))}function YB(r,e){for(let t=0;t<r.length;t++){const n=r[t];n instanceof SB?YB(n.players,e):e.push(n)}}function KB(r,e,t){const n=t.get(r);if(!n)return!1;let i=e.get(r);return i?n.forEach(o=>i.add(o)):e.set(r,n),t.delete(r),!0}class yf{constructor(e,t,n){this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(i,o)=>{},this._transitionEngine=new zCe(e.body,t,n),this._timelineEngine=new bCe(e.body,t,n),this._transitionEngine.onRemovalComplete=(i,o)=>this.onRemovalComplete(i,o)}registerTrigger(e,t,n,i,o){const s=e+"-"+i;let a=this._triggerCache[s];if(!a){const c=[],u=jS(this._driver,o,c,[]);if(c.length)throw function I_e(r,e){return new ge(3404,!1)}();a=function SCe(r,e,t){return new OCe(r,e,t)}(i,u,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(t,i,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,i){this._transitionEngine.insertNode(e,t,n,i)}onRemove(e,t,n){this._transitionEngine.removeNode(e,t,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,i){if("@"==n.charAt(0)){const[o,s]=AB(n);this._timelineEngine.command(o,t,s,i)}else this._transitionEngine.trigger(e,t,n,i)}listen(e,t,n,i,o){if("@"==n.charAt(0)){const[s,a]=AB(n);return this._timelineEngine.listen(s,t,a,o)}return this._transitionEngine.listen(e,t,n,i,o)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}let BCe=(()=>{class r{static#e=this.initialStylesByElement=new WeakMap;constructor(t,n,i){this._element=t,this._startStyles=n,this._endStyles=i,this._state=0;let o=r.initialStylesByElement.get(t);o||r.initialStylesByElement.set(t,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&wc(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(wc(this._element,this._initialStyles),this._endStyles&&(wc(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(r.initialStylesByElement.delete(this._element),this._startStyles&&(C6(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(C6(this._element,this._endStyles),this._endStyles=null),wc(this._element,this._initialStyles),this._state=3)}}return r})();function rO(r){let e=null;return r.forEach((t,n)=>{(function WCe(r){return"display"===r||"position"===r})(n)&&(e=e||new Map,e.set(n,t))}),e}class XB{constructor(e,t,n,i){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map;const t=()=>this._onFinish();this.domPlayer.addEventListener("finish",t),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",t)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(n=>{t.push(Object.fromEntries(n))}),t}_triggerWebAnimation(e,t,n){return e.animate(this._convertKeyframesToObject(t),n)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,i)=>{"offset"!==i&&e.set(i,this._finished?n:qS(this.element,i))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class QB{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return wB(e,t)}getParentElement(e){return DS(e)}query(e,t,n){return NB(e,t,n)}computeStyle(e,t,n){return qS(e,t)}animate(e,t,n,i,o,s=[]){const c={duration:n,delay:i,fill:0==i?"both":"forwards"};o&&(c.easing=o);const l=new Map,u=s.filter(y=>y instanceof XB);(function tCe(r,e){return 0===r||0===e})(n,i)&&u.forEach(y=>{y.currentSnapshot.forEach((S,I)=>l.set(I,S))});let f=function Q_e(r){return r.length?r[0]instanceof Map?r:r.map(e=>new Map(Object.entries(e))):[]}(t).map(y=>new Map(y));f=function nCe(r,e,t){if(t.size&&e.length){let n=e[0],i=[];if(t.forEach((o,s)=>{n.has(s)||i.push(s),n.set(s,o)}),i.length)for(let o=1;o<e.length;o++){let s=e[o];i.forEach(a=>s.set(a,qS(r,a)))}}return e}(e,f,l);const g=function GCe(r,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=rO(e[0]),e.length>1&&(n=rO(e[e.length-1]))):e instanceof Map&&(t=rO(e)),t||n?new BCe(r,t,n):null}(e,f);return new XB(e,f,c,g)}}const JB="@.disabled";class eW{constructor(e,t,n,i){this.namespaceId=e,this.delegate=t,this.engine=n,this._onDestroy=i,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,i=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,i)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,i){this.delegate.setAttribute(e,t,n,i)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,i){this.delegate.setStyle(e,t,n,i)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==JB?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class qCe extends eW{constructor(e,t,n,i,o){super(t,n,i,o),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==JB?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.slice(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const i=function jCe(r){switch(r){case"body":return document.body;case"document":return document;case"window":return window;default:return r}}(e);let o=t.slice(1),s="";return"@"!=o.charAt(0)&&([o,s]=function ZCe(r){const e=r.indexOf(".");return[r.substring(0,e),r.slice(e+1)]}(o)),this.engine.listen(this.namespaceId,i,o,s,a=>{this.factory.scheduleListenerCallback(a._data||-1,n,a)})}return this.delegate.listen(e,t,n)}}class YCe{constructor(e,t,n){this.delegate=e,this.engine=t,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,t.onRemovalComplete=(i,o)=>{const s=o?.parentNode(i);s&&o.removeChild(s,i)}}createRenderer(e,t){const i=this.delegate.createRenderer(e,t);if(!e||!t?.data?.animation){const l=this._rendererCache;let u=l.get(i);return u||(u=new eW("",i,this.engine,()=>l.delete(i)),l.set(i,u)),u}const o=t.id,s=t.id+"-"+this._currentId;this._currentId++,this.engine.register(s,e);const a=l=>{Array.isArray(l)?l.forEach(a):this.engine.registerTrigger(o,s,e,l.name,l)};return t.data.animation.forEach(a),new qCe(this,s,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,t,n){if(e>=0&&e<this._microtaskId)return void this._zone.run(()=>t(n));const i=this._animationCallbacksBuffer;0==i.length&&queueMicrotask(()=>{this._zone.run(()=>{i.forEach(o=>{const[s,a]=o;s(a)}),this._animationCallbacksBuffer=[]})}),i.push([t,n])}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}let KCe=(()=>{class r extends yf{constructor(t,n,i,o){super(t,n,i)}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(n){return new(n||r)(Ae(zi),Ae(HS),Ae(FS),Ae(I4))};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac})}return r})();const tW=[{provide:FS,useFactory:function XCe(){return new LB}},{provide:yf,useClass:KCe},{provide:PM,useFactory:function QCe(r,e,t){return new YCe(r,e,t)},deps:[PP,yf,bn]}],iO=[{provide:HS,useFactory:()=>new QB},{provide:dL,useValue:"BrowserAnimations"},...tW],nW=[{provide:HS,useClass:VS},{provide:dL,useValue:"NoopAnimations"},...tW];let JCe=(()=>{class r{static withConfig(t){return{ngModule:r,providers:t.disableAnimations?nW:iO}}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275mod=N2({type:r});static#n=this.\u0275inj=s2({providers:iO,imports:[IU]})}return r})();const rW=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=63&i|128):55296==(64512&i)&&n+1<r.length&&56320==(64512&r.charCodeAt(n+1))?(i=65536+((1023&i)<<10)+(1023&r.charCodeAt(++n)),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=63&i|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=63&i|128)}return e},iW={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const o=r[i],s=i+1<r.length,a=s?r[i+1]:0,c=i+2<r.length,l=c?r[i+2]:0;let g=(15&a)<<2|l>>6,y=63&l;c||(y=64,s||(g=64)),n.push(t[o>>2],t[(3&o)<<4|a>>4],t[g],t[y])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(rW(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=r[t++];e[n++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const c=((7&i)<<18|(63&r[t++])<<12|(63&r[t++])<<6|63&r[t++])-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(1023&c))}else{const o=r[t++],s=r[t++];e[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const o=t[r.charAt(i++)],a=i<r.length?t[r.charAt(i)]:0;++i;const l=i<r.length?t[r.charAt(i)]:64;++i;const f=i<r.length?t[r.charAt(i)]:64;if(++i,null==o||null==a||null==l||null==f)throw new rve;n.push(o<<2|a>>4),64!==l&&(n.push(a<<4&240|l>>2),64!==f&&n.push(l<<6&192|f))}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class rve extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Jp=function(r){return function(r){const e=rW(r);return iW.encodeByteArray(e,!0)}(r).replace(/\./g,"")},em=function(r){try{return iW.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},tm=()=>{try{return function sve(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const r=process.env.__FIREBASE_DEFAULTS__;return r?JSON.parse(r):void 0})()||(()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&em(r[1]);return e&&JSON.parse(e)})()}catch(r){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`)}},sW=r=>{var e,t;return null===(t=null===(e=tm())||void 0===e?void 0:e.emulatorHosts)||void 0===t?void 0:t[r]},aW=()=>{var r;return null===(r=tm())||void 0===r?void 0:r.config},cW=r=>{var e;return null===(e=tm())||void 0===e?void 0:e[`_${r}`]};class lW{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function Di(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}class Nc extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Nc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Mf.prototype.create)}}class Mf{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?function yve(r,e){return r.replace(Mve,(t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`})}(o,n):"Error";return new Nc(i,`${this.serviceName}: ${s} (${i}).`,n)}}const Mve=/\{\$([^}]+)}/g;function rm(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const o=r[i],s=e[i];if(fW(o)&&fW(s)){if(!rm(o,s))return!1}else if(o!==s)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function fW(r){return null!==r&&"object"==typeof r}function Ef(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Pf(r){const e={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,o]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function Sf(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}class Sve{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function Ove(r,e){if("object"!=typeof r||null===r)return!1;for(const t of e)if(t in r&&"function"==typeof r[t])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=sO),void 0===i.error&&(i.error=sO),void 0===i.complete&&(i.complete=sO);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function sO(){}function oi(r){return r&&r._delegate?r._delegate:r}class y6{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const M6="[DEFAULT]";class Ive{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new lW;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e?.identifier),i=null!==(t=e?.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(o){if(i)return null;throw o}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function Rve(r){return"EAGER"===r.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:M6})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=M6){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){var e=this;return E(function*(){const t=Array.from(e.instances.values());yield Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(e=M6){return this.instances.has(e)}getOptions(e=M6){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[o,s]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(o)&&s.resolve(i);return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),o=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;o.add(e),this.onInitCallbacks.set(i,o);const s=this.instances.get(i);return s&&e(s,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===M6?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}var r;return n||null}normalizeInstanceIdentifier(e=M6){return this.component?this.component.multipleInstances?e:M6:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class xve{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Ive(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const cO=[];var Fn=function(r){return r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT",r}(Fn||{});const dW={debug:Fn.DEBUG,verbose:Fn.VERBOSE,info:Fn.INFO,warn:Fn.WARN,error:Fn.ERROR,silent:Fn.SILENT},Lve=Fn.INFO,zve={[Fn.DEBUG]:"log",[Fn.VERBOSE]:"log",[Fn.INFO]:"info",[Fn.WARN]:"warn",[Fn.ERROR]:"error"},Dve=(r,e,...t)=>{if(e<r.logLevel)return;const n=(new Date).toISOString(),i=zve[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${n}]  ${r.name}:`,...t)};class lO{constructor(e){this.name=e,this._logLevel=Lve,this._logHandler=Dve,this._userLogHandler=null,cO.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Fn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?dW[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Fn.DEBUG,...e),this._logHandler(this,Fn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Fn.VERBOSE,...e),this._logHandler(this,Fn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Fn.INFO,...e),this._logHandler(this,Fn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Fn.WARN,...e),this._logHandler(this,Fn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Fn.ERROR,...e),this._logHandler(this,Fn.ERROR,...e)}}const Vve=(r,e)=>e.some(t=>r instanceof t);let hW,gW;const pW=new WeakMap,uO=new WeakMap,mW=new WeakMap,fO=new WeakMap,dO=new WeakMap;let hO={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return uO.get(r);if("objectStoreNames"===e)return r.objectStoreNames||mW.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Z4(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function Wve(r){return"function"==typeof r?function Bve(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Fve(){return gW||(gW=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply(gO(this),e),Z4(pW.get(this))}:function(...e){return Z4(r.apply(gO(this),e))}:function(e,...t){const n=r.call(gO(this),e,...t);return mW.set(n,e.sort?e.sort():[e]),Z4(n)}}(r):(r instanceof IDBTransaction&&function $ve(r){if(uO.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",s),r.removeEventListener("abort",s)},o=()=>{t(),i()},s=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",o),r.addEventListener("error",s),r.addEventListener("abort",s)});uO.set(r,e)}(r),Vve(r,function Hve(){return hW||(hW=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,hO):r)}function Z4(r){if(r instanceof IDBRequest)return function Uve(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",o),r.removeEventListener("error",s)},o=()=>{t(Z4(r.result)),i()},s=()=>{n(r.error),i()};r.addEventListener("success",o),r.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&pW.set(t,r)}).catch(()=>{}),dO.set(e,r),e}(r);if(fO.has(r))return fO.get(r);const e=Wve(r);return e!==r&&(fO.set(r,e),dO.set(e,r)),e}const gO=r=>dO.get(r),jve=["get","getKey","getAll","getAllKeys","count"],Zve=["put","add","delete","clear"],pO=new Map;function _W(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(pO.get(e))return pO.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=Zve.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!jve.includes(t))return;const o=function(){var s=E(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let u=l.store;return n&&(u=u.index(c.shift())),(yield Promise.all([u[t](...c),i&&l.done]))[0]});return function(c){return s.apply(this,arguments)}}();return pO.set(e,o),o}!function Gve(r){hO=r(hO)}(r=>({...r,get:(e,t,n)=>_W(e,t)||r.get(e,t,n),has:(e,t)=>!!_W(e,t)||r.has(e,t)}));class Yve{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function Kve(r){const e=r.getComponent();return"VERSION"===e?.type}(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}return null}).filter(t=>t).join(" ")}}const mO="@firebase/app",E6=new lO("@firebase/app"),im="[DEFAULT]",Eye={[mO]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},P6=new Map,om=new Map;function Pye(r,e){try{r.container.addComponent(e)}catch(t){E6.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function q8(r){const e=r.name;if(om.has(e))return E6.debug(`There were multiple attempts to register component ${e}.`),!1;om.set(e,r);for(const t of P6.values())Pye(t,r);return!0}function sm(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}const L3=new Mf("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Oye{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new y6("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw L3.create("app-deleted",{appName:this._name})}}const j8="10.7.1";function vW(r,e={}){let t=r;"object"!=typeof e&&(e={name:e});const n=Object.assign({name:im,automaticDataCollectionEnabled:!1},e),i=n.name;if("string"!=typeof i||!i)throw L3.create("bad-app-name",{appName:String(i)});if(t||(t=aW()),!t)throw L3.create("no-options");const o=P6.get(i);if(o){if(rm(t,o.options)&&rm(n,o.config))return o;throw L3.create("duplicate-app",{appName:i})}const s=new xve(i);for(const c of om.values())s.addComponent(c);const a=new Oye(t,n,s);return P6.set(i,a),a}function _O(r=im){const e=P6.get(r);if(!e&&r===im&&aW())return vW();if(!e)throw L3.create("no-app",{appName:r});return e}function yW(){return Array.from(P6.values())}function cs(r,e,t){var n;let i=null!==(n=Eye[r])&&void 0!==n?n:r;t&&(i+=`-${t}`);const o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){const a=[`Unable to register library "${i}" with version "${e}":`];return o&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void E6.warn(a.join(" "))}q8(new y6(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const Tye="firebase-heartbeat-database",Aye=1,Of="firebase-heartbeat-store";let vO=null;function MW(){return vO||(vO=function qve(r,e,{blocked:t,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(r,e),a=Z4(s);return n&&s.addEventListener("upgradeneeded",c=>{n(Z4(s.result),c.oldVersion,c.newVersion,Z4(s.transaction),c)}),t&&s.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}(Tye,Aye,{upgrade:(r,e)=>{0===e&&r.createObjectStore(Of)}}).catch(r=>{throw L3.create("idb-open",{originalErrorMessage:r.message})})),vO}function yO(){return(yO=E(function*(r){try{return yield(yield MW()).transaction(Of).objectStore(Of).get(PW(r))}catch(e){if(e instanceof Nc)E6.warn(e.message);else{const t=L3.create("idb-get",{originalErrorMessage:e?.message});E6.warn(t.message)}}})).apply(this,arguments)}function EW(r,e){return MO.apply(this,arguments)}function MO(){return(MO=E(function*(r,e){try{const n=(yield MW()).transaction(Of,"readwrite");yield n.objectStore(Of).put(e,PW(r)),yield n.done}catch(t){if(t instanceof Nc)E6.warn(t.message);else{const n=L3.create("idb-set",{originalErrorMessage:t?.message});E6.warn(n.message)}}})).apply(this,arguments)}function PW(r){return`${r.name}!${r.options.appId}`}class Iye{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Rye(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}triggerHeartbeat(){var e=this;return E(function*(){var t,n;const o=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=SW();if((null!=(null===(t=e._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||(e._heartbeatsCache=yield e._heartbeatsCachePromise,null!=(null===(n=e._heartbeatsCache)||void 0===n?void 0:n.heartbeats)))&&e._heartbeatsCache.lastSentHeartbeatDate!==s&&!e._heartbeatsCache.heartbeats.some(a=>a.date===s))return e._heartbeatsCache.heartbeats.push({date:s,agent:o}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(a=>{const c=new Date(a.date).valueOf();return Date.now()-c<=2592e6}),e._storage.overwrite(e._heartbeatsCache)})()}getHeartbeatsHeader(){var e=this;return E(function*(){var t;if(null===e._heartbeatsCache&&(yield e._heartbeatsCachePromise),null==(null===(t=e._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===e._heartbeatsCache.heartbeats.length)return"";const n=SW(),{heartbeatsToSend:i,unsentEntries:o}=function kye(r,e=1024){const t=[];let n=r.slice();for(const i of r){const o=t.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),OW(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),OW(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}(e._heartbeatsCache.heartbeats),s=Jp(JSON.stringify({version:2,heartbeats:i}));return e._heartbeatsCache.lastSentHeartbeatDate=n,o.length>0?(e._heartbeatsCache.heartbeats=o,yield e._storage.overwrite(e._heartbeatsCache)):(e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache)),s})()}}function SW(){return(new Date).toISOString().substring(0,10)}class Rye{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return E(function*(){return!!function _ve(){try{return"object"==typeof indexedDB}catch{return!1}}()&&function Cve(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e((null===(o=i.error)||void 0===o?void 0:o.message)||"")}}catch(t){e(t)}})}().then(()=>!0).catch(()=>!1)})()}read(){var e=this;return E(function*(){if(yield e._canUseIndexedDBPromise){const n=yield function bye(r){return yO.apply(this,arguments)}(e.app);return n?.heartbeats?n:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(e){var t=this;return E(function*(){var n;if(yield t._canUseIndexedDBPromise){const o=yield t.read();return EW(t.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})()}add(e){var t=this;return E(function*(){var n;if(yield t._canUseIndexedDBPromise){const o=yield t.read();return EW(t.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}})()}}function OW(r){return Jp(JSON.stringify({version:2,heartbeats:r})).length}!function xye(r){q8(new y6("platform-logger",e=>new Yve(e),"PRIVATE")),q8(new y6("heartbeat",e=>new Iye(e),"PRIVATE")),cs(mO,"0.9.25",r),cs(mO,"0.9.25","esm2017"),cs("fire-js","")}(""),cs("firebase","10.7.1","app");class Dye extends Ue{constructor(e,t){super()}schedule(e,t=0){return this}}const am={setInterval(r,e,...t){const{delegate:n}=am;return n?.setInterval?n.setInterval(r,e,...t):setInterval(r,e,...t)},clearInterval(r){const{delegate:e}=am;return(e?.clearInterval||clearInterval)(r)},delegate:void 0};class TW extends Dye{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var n;if(this.closed)return this;this.state=e;const i=this.id,o=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,n=0){return am.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&am.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i,n=!1;try{this.work(e)}catch(o){n=!0,i=o||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,De(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const EO={now:()=>(EO.delegate||Date).now(),delegate:void 0};class Tf{constructor(e,t=Tf.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}Tf.now=EO.now;class AW extends Tf{constructor(e,t=Tf.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}const Fye=new class Hye extends AW{}(class Vye extends TW{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,n=0){return null!=n&&n>0||null==n&&this.delay>0?super.requestAsyncId(e,t,n):(e.flush(this),0)}}),Uye=new AW(TW),cm=new M8("ANGULARFIRE2_VERSION");function bW(r,e,t){if(e){if(1===e.length)return e[0];const o=e.filter(s=>s.app===t);if(1===o.length)return o[0]}return t.container.getProvider(r).getImmediate({optional:!0})}const PO=(r,e)=>{const t=e?[e]:yW(),n=[];return t.forEach(i=>{i.container.getProvider(r).instances.forEach(s=>{n.includes(s)||n.push(s)})}),n};class wW{constructor(){return PO($ye)}}const $ye="app-check";function Z8(){}class NW{zone;delegate;constructor(e,t=Fye){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,n){const i=this.zone;return this.delegate.schedule(function(s){i.runGuarded(()=>{e.apply(this,[s])})},t,n)}}class Gye{zone;task=null;constructor(e){this.zone=e}call(e,t){const n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Z8,{},Z8,Z8)),t.pipe(u2({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let SO=(()=>{class r{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new NW(Zone.current)),this.insideAngular=t.run(()=>new NW(Zone.current,Uye)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(n){return new(n||r)(Ae(bn))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Y8(){const r=globalThis.\u0275AngularFireScheduler;if(!r)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return r}function S6(r){return Y8().ngZone.run(()=>r())}function Wye(r){return function qye(r){return function(t){return(t=t.lift(new Gye(r.ngZone))).pipe(ip(r.outsideAngular),rp(r.insideAngular))}}(Y8())(r)}const jye=(r,e)=>function(){const n=arguments;return e&&setTimeout(()=>{"scheduled"===e.state&&e.invoke()},10),S6(()=>r.apply(void 0,n))},K1=(r,e)=>function(){let t;const n=arguments;for(let o=0;o<arguments.length;o++)"function"==typeof n[o]&&(e&&(t||=S6(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Z8,{},Z8,Z8))),n[o]=jye(n[o],t));const i=function Bye(r){return Y8().ngZone.runOutsideAngular(()=>r())}(()=>r.apply(this,n));if(!e){if(i instanceof Pr){const o=Y8();return i.pipe(ip(o.outsideAngular),rp(o.insideAngular))}return S6(()=>i)}return i instanceof Pr?i.pipe(Wye):i instanceof Promise?S6(()=>new Promise((o,s)=>i.then(a=>S6(()=>o(a)),a=>S6(()=>s(a))))):"function"==typeof i&&t?function(){return setTimeout(()=>{t&&"scheduled"===t.state&&t.invoke()},10),i.apply(this,arguments)}:S6(()=>i)};class Af{constructor(e){return e}}class OO{constructor(){return yW()}}const TO=new Qe("angularfire2._apps"),Yye={provide:Af,useFactory:function Zye(r){return r&&1===r.length?r[0]:new Af(_O())},deps:[[new Jo,TO]]},Kye={provide:OO,deps:[[new Jo,TO]]};function Xye(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new Af(n)}}let Qye=(()=>{class r{constructor(t){cs("angularfire",cm.full,"core"),cs("angularfire",cm.full,"app"),cs("angular",Mue.full,t.toString())}static \u0275fac=function(n){return new(n||r)(Ae(y3))};static \u0275mod=N2({type:r});static \u0275inj=s2({providers:[Yye,Kye]})}return r})();const eMe=K1(vW,!0);const tMe=function IW(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},kW=new Mf("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),lm=new lO("@firebase/auth");function um(r,...e){lm.logLevel<=Fn.ERROR&&lm.error(`Auth (${j8}): ${r}`,...e)}function Ro(r,...e){throw AO(r,...e)}function ls(r,...e){return AO(r,...e)}function RW(r,e,t){const n=Object.assign(Object.assign({},tMe()),{[e]:t});return new Mf("auth","Firebase",n).create(e,{appName:r.name})}function AO(r,...e){if("string"!=typeof r){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return kW.create(r,...e)}function Ge(r,e,...t){if(!r)throw AO(e,...t)}function Ic(r){const e="INTERNAL ASSERTION FAILED: "+r;throw um(e),new Error(e)}function z3(r,e){r||Ic(e)}function bf(){var r;return typeof self<"u"&&(null===(r=self.location)||void 0===r?void 0:r.href)||""}function xW(){var r;return typeof self<"u"&&(null===(r=self.location)||void 0===r?void 0:r.protocol)||null}function rMe(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function bO(){return"http:"===xW()||"https:"===xW()}()||function gve(){const r="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof r&&void 0!==r.id}()||"connection"in navigator))||navigator.onLine}class wf{constructor(e,t){this.shortDelay=e,this.longDelay=t,z3(t>e,"Short delay should be less than long delay!"),this.isMobile=function dve(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Di())}()||function pve(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()}get(){return rMe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function wO(r,e){z3(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class LW{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void Ic("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void Ic("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void Ic("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const oMe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},sMe=new wf(3e4,6e4);function X1(r,e){return r.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:r.tenantId}):e}function Q1(r,e,t,n){return NO.apply(this,arguments)}function NO(){return(NO=E(function*(r,e,t,n,i={}){return zW(r,i,E(function*(){let o={},s={};n&&("GET"===e?s=n:o={body:JSON.stringify(n)});const a=Ef(Object.assign({key:r.config.apiKey},s)).slice(1),c=yield r._getAdditionalHeaders();return c["Content-Type"]="application/json",r.languageCode&&(c["X-Firebase-Locale"]=r.languageCode),LW.fetch()(DW(r,r.config.apiHost,t,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},o))}))})).apply(this,arguments)}function zW(r,e,t){return IO.apply(this,arguments)}function IO(){return(IO=E(function*(r,e,t){r._canInitEmulator=!1;const n=Object.assign(Object.assign({},oMe),e);try{const i=new cMe(r),o=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();const s=yield o.json();if("needConfirmation"in s)throw Nf(r,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{const a=o.ok?s.errorMessage:s.error.message,[c,l]=a.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===c)throw Nf(r,"credential-already-in-use",s);if("EMAIL_EXISTS"===c)throw Nf(r,"email-already-in-use",s);if("USER_DISABLED"===c)throw Nf(r,"user-disabled",s);const u=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw RW(r,u,l);Ro(r,u)}}catch(i){if(i instanceof Nc)throw i;Ro(r,"network-request-failed",{message:String(i)})}})).apply(this,arguments)}function D3(r,e,t,n){return kO.apply(this,arguments)}function kO(){return(kO=E(function*(r,e,t,n,i={}){const o=yield Q1(r,e,t,n,i);return"mfaPendingCredential"in o&&Ro(r,"multi-factor-auth-required",{_serverResponse:o}),o})).apply(this,arguments)}function DW(r,e,t,n){const i=`${e}${t}?${n}`;return r.config.emulator?wO(r.config,i):`${r.config.apiScheme}://${i}`}function aMe(r){switch(r){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class cMe{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(ls(this.auth,"network-request-failed")),sMe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Nf(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const i=ls(r,e,n);return i.customData._tokenResponse=t,i}function HW(r){return void 0!==r&&void 0!==r.enterprise}class FW{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return aMe(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}function UW(r,e){return xO.apply(this,arguments)}function xO(){return(xO=E(function*(r,e){return Q1(r,"GET","/v2/recaptchaConfig",X1(r,e))})).apply(this,arguments)}function LO(){return(LO=E(function*(r,e){return Q1(r,"POST","/v1/accounts:delete",e)})).apply(this,arguments)}function DO(){return(DO=E(function*(r,e){return Q1(r,"POST","/v1/accounts:lookup",e)})).apply(this,arguments)}function If(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function VO(){return(VO=E(function*(r,e=!1){const t=oi(r),n=yield t.getIdToken(e),i=fm(n);Ge(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const o="object"==typeof i.firebase?i.firebase:void 0,s=o?.sign_in_provider;return{claims:i,token:n,authTime:If(HO(i.auth_time)),issuedAtTime:If(HO(i.iat)),expirationTime:If(HO(i.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}})).apply(this,arguments)}function HO(r){return 1e3*Number(r)}function fm(r){const[e,t,n]=r.split(".");if(void 0===e||void 0===t||void 0===n)return um("JWT malformed, contained fewer than 3 sections"),null;try{const i=em(t);return i?JSON.parse(i):(um("Failed to decode base64 JWT payload"),null)}catch(i){return um("Caught error parsing JWT payload as JSON",i?.toString()),null}}function V3(r,e){return FO.apply(this,arguments)}function FO(){return(FO=E(function*(r,e,t=!1){if(t)return e;try{return yield e}catch(n){throw n instanceof Nc&&function pMe({code:r}){return"auth/user-disabled"===r||"auth/user-token-expired"===r}(n)&&r.auth.currentUser===r&&(yield r.auth.signOut()),n}})).apply(this,arguments)}class mMe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}{this.errorBackoff=3e4;const i=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){var t=this;if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(E(function*(){yield t.iteration()}),n)}iteration(){var e=this;return E(function*(){try{yield e.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===t?.code&&e.schedule(!0))}e.schedule()})()}}class $W{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=If(this.lastLoginAt),this.creationTime=If(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function kf(r){return UO.apply(this,arguments)}function UO(){return UO=E(function*(r){var e;const t=r.auth,n=yield r.getIdToken(),i=yield V3(r,function dMe(r,e){return DO.apply(this,arguments)}(t,{idToken:n}));Ge(i?.users.length,t,"internal-error");const o=i.users[0];r._notifyReloadListener(o);const s=null!==(e=o.providerUserInfo)&&void 0!==e&&e.length?function vMe(r){return r.map(e=>{var{providerId:t}=e,n=np(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}(o.providerUserInfo):[],a=function CMe(r,e){return[...r.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}(r.providerData,s),u=!!r.isAnonymous&&!(r.email&&o.passwordHash||a?.length),f={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new $W(o.createdAt,o.lastLoginAt),isAnonymous:u};Object.assign(r,f)}),UO.apply(this,arguments)}function $O(){return($O=E(function*(r){const e=oi(r);yield kf(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})).apply(this,arguments)}function GO(){return(GO=E(function*(r,e){const t=yield zW(r,{},E(function*(){const n=Ef({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=r.config,s=DW(r,i,"/v1/token",`key=${o}`),a=yield r._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",LW.fetch()(s,{method:"POST",headers:a,body:n})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})).apply(this,arguments)}function BO(){return(BO=E(function*(r,e){return Q1(r,"POST","/v2/accounts:revokeToken",X1(r,e))})).apply(this,arguments)}class Rf{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ge(e.idToken,"internal-error"),Ge(typeof e.idToken<"u","internal-error"),Ge(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):function gMe(r){const e=fm(r);return Ge(e,"internal-error"),Ge(typeof e.exp<"u","internal-error"),Ge(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}getToken(e,t=!1){var n=this;return E(function*(){return Ge(!n.accessToken||n.refreshToken,e,"user-token-expired"),t||!n.accessToken||n.isExpired?n.refreshToken?(yield n.refresh(e,n.refreshToken),n.accessToken):null:n.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(e,t){var n=this;return E(function*(){const{accessToken:i,refreshToken:o,expiresIn:s}=yield function yMe(r,e){return GO.apply(this,arguments)}(e,t);n.updateTokensAndExpiration(i,o,Number(s))})()}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:o}=t,s=new Rf;return n&&(Ge("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),i&&(Ge("string"==typeof i,"internal-error",{appName:e}),s.accessToken=i),o&&(Ge("number"==typeof o,"internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Rf,this.toJSON())}_performRefresh(){return Ic("not implemented")}}function Y4(r,e){Ge("string"==typeof r||typeof r>"u","internal-error",{appName:e})}class O6{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,o=np(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new mMe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new $W(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){var t=this;return E(function*(){const n=yield V3(t,t.stsTokenManager.getToken(t.auth,e));return Ge(n,t.auth,"internal-error"),t.accessToken!==n&&(t.accessToken=n,yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)),n})()}getIdTokenResult(e){return function hMe(r){return VO.apply(this,arguments)}(this,e)}reload(){return function _Me(r){return $O.apply(this,arguments)}(this)}_assign(e){this!==e&&(Ge(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new O6(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ge(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){var n=this;return E(function*(){let i=!1;e.idToken&&e.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(e),i=!0),t&&(yield kf(n)),yield n.auth._persistUserIfCurrent(n),i&&n.auth._notifyListenersIfCurrent(n)})()}delete(){var e=this;return E(function*(){const t=yield e.getIdToken();return yield V3(e,function uMe(r,e){return LO.apply(this,arguments)}(e.auth,{idToken:t})),e.stsTokenManager.clearRefreshToken(),e.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,o,s,a,c,l,u;const f=null!==(n=t.displayName)&&void 0!==n?n:void 0,g=null!==(i=t.email)&&void 0!==i?i:void 0,y=null!==(o=t.phoneNumber)&&void 0!==o?o:void 0,S=null!==(s=t.photoURL)&&void 0!==s?s:void 0,I=null!==(a=t.tenantId)&&void 0!==a?a:void 0,R=null!==(c=t._redirectEventId)&&void 0!==c?c:void 0,U=null!==(l=t.createdAt)&&void 0!==l?l:void 0,$=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:oe,emailVerified:_e,isAnonymous:Te,providerData:Fe,stsTokenManager:mt}=t;Ge(oe&&mt,e,"internal-error");const rn=Rf.fromJSON(this.name,mt);Ge("string"==typeof oe,e,"internal-error"),Y4(f,e.name),Y4(g,e.name),Ge("boolean"==typeof _e,e,"internal-error"),Ge("boolean"==typeof Te,e,"internal-error"),Y4(y,e.name),Y4(S,e.name),Y4(I,e.name),Y4(R,e.name),Y4(U,e.name),Y4($,e.name);const a1=new O6({uid:oe,auth:e,email:g,emailVerified:_e,displayName:f,isAnonymous:Te,photoURL:S,phoneNumber:y,tenantId:I,stsTokenManager:rn,createdAt:U,lastLoginAt:$});return Fe&&Array.isArray(Fe)&&(a1.providerData=Fe.map(dn=>Object.assign({},dn))),R&&(a1._redirectEventId=R),a1}static _fromIdTokenResponse(e,t,n=!1){return E(function*(){const i=new Rf;i.updateFromServerResponse(t);const o=new O6({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return yield kf(o),o})()}}const GW=new Map;function H3(r){z3(r instanceof Function,"Expected a class definition");let e=GW.get(r);return e?(z3(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,GW.set(r,e),e)}const BW=(()=>{class r{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return E(function*(){return!0})()}_set(t,n){var i=this;return E(function*(){i.storage[t]=n})()}_get(t){var n=this;return E(function*(){const i=n.storage[t];return void 0===i?null:i})()}_remove(t){var n=this;return E(function*(){delete n.storage[t]})()}_addListener(t,n){}_removeListener(t,n){}}return r.type="NONE",r})();function dm(r,e,t){return`firebase:${r}:${e}:${t}`}class X8{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=dm(this.userKey,i.apiKey,o),this.fullPersistenceKey=dm("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){var e=this;return E(function*(){const t=yield e.persistence._get(e.fullUserKey);return t?O6._fromJSON(e.auth,t):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){var t=this;return E(function*(){if(t.persistence===e)return;const n=yield t.getCurrentUser();return yield t.removeCurrentUser(),t.persistence=e,n?t.setCurrentUser(n):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,n="authUser"){return E(function*(){if(!t.length)return new X8(H3(BW),e,n);const i=(yield Promise.all(t.map(function(){var l=E(function*(u){if(yield u._isAvailable())return u});return function(u){return l.apply(this,arguments)}}()))).filter(l=>l);let o=i[0]||H3(BW);const s=dm(n,e.config.apiKey,e.name);let a=null;for(const l of t)try{const u=yield l._get(s);if(u){const f=O6._fromJSON(e,u);l!==o&&(a=f),o=l;break}}catch{}const c=i.filter(l=>l._shouldAllowMigration);return o._shouldAllowMigration&&c.length?(o=c[0],a&&(yield o._set(s,a.toJSON())),yield Promise.all(t.map(function(){var l=E(function*(u){if(u!==o)try{yield u._remove(s)}catch{}});return function(u){return l.apply(this,arguments)}}())),new X8(o,e,n)):new X8(o,e,n)})()}}function WW(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ZW(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(qW(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(KW(e))return"Blackberry";if(XW(e))return"Webos";if(WO(e))return"Safari";if((e.includes("chrome/")||jW(e))&&!e.includes("edge/"))return"Chrome";if(YW(e))return"Android";{const n=r.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===n?.length)return n[1]}return"Other"}function qW(r=Di()){return/firefox\//i.test(r)}function WO(r=Di()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function jW(r=Di()){return/crios\//i.test(r)}function ZW(r=Di()){return/iemobile/i.test(r)}function YW(r=Di()){return/android/i.test(r)}function KW(r=Di()){return/blackberry/i.test(r)}function XW(r=Di()){return/webos/i.test(r)}function hm(r=Di()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function QW(r=Di()){return hm(r)||YW(r)||XW(r)||KW(r)||/windows phone/i.test(r)||ZW(r)}function JW(r,e=[]){let t;switch(r){case"Browser":t=WW(Di());break;case"Worker":t=`${WW(Di())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${j8}/${n}`}class OMe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=o=>new Promise((s,a)=>{try{s(e(o))}catch(c){a(c)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){var t=this;return E(function*(){if(t.auth.currentUser===e)return;const n=[];try{for(const i of t.queue)yield i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const o of n)try{o()}catch{}throw t.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})()}}function qO(){return(qO=E(function*(r,e={}){return Q1(r,"GET","/v2/passwordPolicy",X1(r,e))})).apply(this,arguments)}class bMe{constructor(e){var t,n,i,o;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(o=e.forceUpgradeOnSignin)&&void 0!==o&&o,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,i,o,s,a;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=null===(t=c.meetsMinPasswordLength)||void 0===t||t),c.isValid&&(c.isValid=null===(n=c.meetsMaxPasswordLength)||void 0===n||n),c.isValid&&(c.isValid=null===(i=c.containsLowercaseLetter)||void 0===i||i),c.isValid&&(c.isValid=null===(o=c.containsUppercaseLetter)||void 0===o||o),c.isValid&&(c.isValid=null===(s=c.containsNumericCharacter)||void 0===s||s),c.isValid&&(c.isValid=null===(a=c.containsNonAlphanumericCharacter)||void 0===a||a),c}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}class wMe{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new eq(this),this.idTokenSubscription=new eq(this),this.beforeStateQueue=new OMe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=kW,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){var n=this;return t&&(this._popupRedirectResolver=H3(t)),this._initializationPromise=this.queue(E(function*(){var i,o;if(!n._deleted&&(n.persistenceManager=yield X8.create(n,e),!n._deleted)){if(null!==(i=n._popupRedirectResolver)&&void 0!==i&&i._shouldInitProactively)try{yield n._popupRedirectResolver._initialize(n)}catch{}yield n.initializeCurrentUser(t),n.lastNotifiedUid=(null===(o=n.currentUser)||void 0===o?void 0:o.uid)||null,!n._deleted&&(n._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var e=this;return E(function*(){if(e._deleted)return;const t=yield e.assertedPersistence.getCurrentUser();if(e.currentUser||t){if(e.currentUser&&t&&e.currentUser.uid===t.uid)return e._currentUser._assign(t),void(yield e.currentUser.getIdToken());yield e._updateCurrentUser(t,!0)}})()}initializeCurrentUser(e){var t=this;return E(function*(){var n;const i=yield t.assertedPersistence.getCurrentUser();let o=i,s=!1;if(e&&t.config.authDomain){yield t.getOrInitRedirectPersistenceManager();const a=null===(n=t.redirectUser)||void 0===n?void 0:n._redirectEventId,c=o?._redirectEventId,l=yield t.tryRedirectSignIn(e);(!a||a===c)&&l?.user&&(o=l.user,s=!0)}if(!o)return t.directlySetCurrentUser(null);if(!o._redirectEventId){if(s)try{yield t.beforeStateQueue.runMiddleware(o)}catch(a){o=i,t._popupRedirectResolver._overrideRedirectResult(t,()=>Promise.reject(a))}return o?t.reloadAndSetCurrentUserOrClear(o):t.directlySetCurrentUser(null)}return Ge(t._popupRedirectResolver,t,"argument-error"),yield t.getOrInitRedirectPersistenceManager(),t.redirectUser&&t.redirectUser._redirectEventId===o._redirectEventId?t.directlySetCurrentUser(o):t.reloadAndSetCurrentUserOrClear(o)})()}tryRedirectSignIn(e){var t=this;return E(function*(){let n=null;try{n=yield t._popupRedirectResolver._completeRedirectFn(t,e,!0)}catch{yield t._setRedirectUser(null)}return n})()}reloadAndSetCurrentUserOrClear(e){var t=this;return E(function*(){try{yield kf(e)}catch(n){if("auth/network-request-failed"!==n?.code)return t.directlySetCurrentUser(null)}return t.directlySetCurrentUser(e)})()}useDeviceLanguage(){this.languageCode=function iMe(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}()}_delete(){var e=this;return E(function*(){e._deleted=!0})()}updateCurrentUser(e){var t=this;return E(function*(){const n=e?oi(e):null;return n&&Ge(n.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(n&&n._clone(t))})()}_updateCurrentUser(e,t=!1){var n=this;return E(function*(){if(!n._deleted)return e&&Ge(n.tenantId===e.tenantId,n,"tenant-id-mismatch"),t||(yield n.beforeStateQueue.runMiddleware(e)),n.queue(E(function*(){yield n.directlySetCurrentUser(e),n.notifyAuthListeners()}))})()}signOut(){var e=this;return E(function*(){return yield e.beforeStateQueue.runMiddleware(null),(e.redirectPersistenceManager||e._popupRedirectResolver)&&(yield e._setRedirectUser(null)),e._updateCurrentUser(null,!0)})()}setPersistence(e){var t=this;return this.queue(E(function*(){yield t.assertedPersistence.setPersistence(H3(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){var t=this;return E(function*(){t._getPasswordPolicyInternal()||(yield t._updatePasswordPolicy());const n=t._getPasswordPolicyInternal();return n.schemaVersion!==t.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(t._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var e=this;return E(function*(){const t=yield function TMe(r){return qO.apply(this,arguments)}(e),n=new bMe(t);null===e.tenantId?e._projectPasswordPolicy=n:e._tenantPasswordPolicies[e.tenantId]=n})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Mf("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}revokeAccessToken(e){var t=this;return E(function*(){if(t.currentUser){const n=yield t.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};null!=t.tenantId&&(i.tenantId=t.tenantId),yield function MMe(r,e){return BO.apply(this,arguments)}(t,i)}})()}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}_setRedirectUser(e,t){var n=this;return E(function*(){const i=yield n.getOrInitRedirectPersistenceManager(t);return null===e?i.removeCurrentUser():i.setCurrentUser(e)})()}getOrInitRedirectPersistenceManager(e){var t=this;return E(function*(){if(!t.redirectPersistenceManager){const n=e&&H3(e)||t._popupRedirectResolver;Ge(n,t,"argument-error"),t.redirectPersistenceManager=yield X8.create(t,[H3(n._redirectPersistence)],"redirectUser"),t.redirectUser=yield t.redirectPersistenceManager.getCurrentUser()}return t.redirectPersistenceManager})()}_redirectUserForId(e){var t=this;return E(function*(){var n,i;return t._isInitialized&&(yield t.queue(E(function*(){}))),(null===(n=t._currentUser)||void 0===n?void 0:n._redirectEventId)===e?t._currentUser:(null===(i=t.redirectUser)||void 0===i?void 0:i._redirectEventId)===e?t.redirectUser:null})()}_persistUserIfCurrent(e){var t=this;return E(function*(){if(e===t.currentUser)return t.queue(E(function*(){return t.directlySetCurrentUser(e)}))})()}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const o="function"==typeof t?t:t.next.bind(t);let s=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ge(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),"function"==typeof t){const c=e.addObserver(t,n,i);return()=>{s=!0,c()}}{const c=e.addObserver(t);return()=>{s=!0,c()}}}directlySetCurrentUser(e){var t=this;return E(function*(){t.currentUser&&t.currentUser!==e&&t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh(),t.currentUser=e,e?yield t.assertedPersistence.setCurrentUser(e):yield t.assertedPersistence.removeCurrentUser()})()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ge(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=JW(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var e=this;return E(function*(){var t;const n={"X-Client-Version":e.clientVersion};e.app.options.appId&&(n["X-Firebase-gmpid"]=e.app.options.appId);const i=yield null===(t=e.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();i&&(n["X-Firebase-Client"]=i);const o=yield e._getAppCheckToken();return o&&(n["X-Firebase-AppCheck"]=o),n})()}_getAppCheckToken(){var e=this;return E(function*(){var t;const n=yield null===(t=e.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken();return n?.error&&function nMe(r,...e){lm.logLevel<=Fn.WARN&&lm.warn(`Auth (${j8}): ${r}`,...e)}(`Error while retrieving App Check token: ${n.error}`),n?.token})()}}function Ur(r){return oi(r)}class eq{constructor(e){this.auth=e,this.observer=null,this.addObserver=function Pve(r,e){const t=new Sve(r,e);return t.subscribe.bind(t)}(t=>this.observer=t)}get next(){return Ge(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function jO(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=i=>{const o=ls("internal-error");o.customData=i,t(o)},n.type="text/javascript",n.charset="UTF-8",function NMe(){var r,e;return null!==(e=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==e?e:document}().appendChild(n)})}function tq(r){return`__${r}${Math.floor(1e6*Math.random())}`}class nq{constructor(e){this.type="recaptcha-enterprise",this.auth=Ur(e)}verify(e="verify",t=!1){var n=this;return E(function*(){function o(){return o=E(function*(a){if(!t){if(null==a.tenantId&&null!=a._agentRecaptchaConfig)return a._agentRecaptchaConfig.siteKey;if(null!=a.tenantId&&void 0!==a._tenantRecaptchaConfigs[a.tenantId])return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(function(){var c=E(function*(l,u){UW(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(void 0!==f.recaptchaKey){const g=new FW(f);return null==a.tenantId?a._agentRecaptchaConfig=g:a._tenantRecaptchaConfigs[a.tenantId]=g,l(g.siteKey)}u(new Error("recaptcha Enterprise site key undefined"))}).catch(f=>{u(f)})});return function(l,u){return c.apply(this,arguments)}}())}),o.apply(this,arguments)}function s(a,c,l){const u=window.grecaptcha;HW(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(f=>{c(f)}).catch(()=>{c("NO_RECAPTCHA")})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((a,c)=>{(function i(a){return o.apply(this,arguments)})(n.auth).then(l=>{if(!t&&HW(window.grecaptcha))s(l,a,c);else{if(typeof window>"u")return void c(new Error("RecaptchaVerifier is only supported in browser"));jO("https://www.google.com/recaptcha/enterprise.js?render="+l).then(()=>{s(l,a,c)}).catch(u=>{c(u)})}}).catch(l=>{c(l)})})})()}}function rq(r,e,t){return ZO.apply(this,arguments)}function ZO(){return(ZO=E(function*(r,e,t,n=!1){const i=new nq(r);let o;try{o=yield i.verify(t)}catch{o=yield i.verify(t,!0)}const s=Object.assign({},e);return Object.assign(s,n?{captchaResp:o}:{captchaResponse:o}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s})).apply(this,arguments)}function xf(r,e,t,n){return YO.apply(this,arguments)}function YO(){return YO=E(function*(r,e,t,n){var i;if(null!==(i=r._getRecaptchaConfig())&&void 0!==i&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=yield rq(r,e,t,"getOobCode"===t);return n(r,o)}return n(r,e).catch(function(){var o=E(function*(s){if("auth/missing-recaptcha-token"===s.code){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=yield rq(r,e,t,"getOobCode"===t);return n(r,a)}return Promise.reject(s)});return function(s){return o.apply(this,arguments)}}())}),YO.apply(this,arguments)}function iq(r,e,t){const n=Ur(r);Ge(n._canInitEmulator,n,"emulator-config-failed"),Ge(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!!t?.disableWarnings,o=oq(e),{host:s,port:a}=function DMe(r){const e=oq(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:sq(n.substr(o.length+1))}}{const[o,s]=n.split(":");return{host:o,port:sq(s)}}}(e);n.config.emulator={url:`${o}//${s}${null===a?"":`:${a}`}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function VMe(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",r):r())}()}function oq(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function sq(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}class XO{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ic("not implemented")}_getIdTokenResponse(e){return Ic("not implemented")}_linkToIdToken(e,t){return Ic("not implemented")}_getReauthenticationResolver(e){return Ic("not implemented")}}function FMe(r,e){return eT.apply(this,arguments)}function eT(){return(eT=E(function*(r,e){return Q1(r,"POST","/v1/accounts:signUp",e)})).apply(this,arguments)}function $Me(r,e){return nT.apply(this,arguments)}function nT(){return(nT=E(function*(r,e){return D3(r,"POST","/v1/accounts:signInWithPassword",X1(r,e))})).apply(this,arguments)}function gm(r,e){return rT.apply(this,arguments)}function rT(){return(rT=E(function*(r,e){return Q1(r,"POST","/v1/accounts:sendOobCode",X1(r,e))})).apply(this,arguments)}function iT(){return(iT=E(function*(r,e){return gm(r,e)})).apply(this,arguments)}function BMe(r,e){return oT.apply(this,arguments)}function oT(){return(oT=E(function*(r,e){return gm(r,e)})).apply(this,arguments)}function cT(){return(cT=E(function*(r,e){return D3(r,"POST","/v1/accounts:signInWithEmailLink",X1(r,e))})).apply(this,arguments)}function lT(){return(lT=E(function*(r,e){return D3(r,"POST","/v1/accounts:signInWithEmailLink",X1(r,e))})).apply(this,arguments)}class Lf extends XO{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Lf(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Lf(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){var t=this;return E(function*(){switch(t.signInMethod){case"password":return xf(e,{returnSecureToken:!0,email:t._email,password:t._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",$Me);case"emailLink":return function jMe(r,e){return cT.apply(this,arguments)}(e,{email:t._email,oobCode:t._password});default:Ro(e,"internal-error")}})()}_linkToIdToken(e,t){var n=this;return E(function*(){switch(n.signInMethod){case"password":return xf(e,{idToken:t,returnSecureToken:!0,email:n._email,password:n._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",FMe);case"emailLink":return function ZMe(r,e){return lT.apply(this,arguments)}(e,{idToken:t,email:n._email,oobCode:n._password});default:Ro(e,"internal-error")}})()}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}function F3(r,e){return uT.apply(this,arguments)}function uT(){return(uT=E(function*(r,e){return D3(r,"POST","/v1/accounts:signInWithIdp",X1(r,e))})).apply(this,arguments)}class Q8 extends XO{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Q8(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ro("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,o=np(t,["providerId","signInMethod"]);if(!n||!i)return null;const s=new Q8(n,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){return F3(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,F3(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,F3(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ef(t)}return e}}class Df{constructor(e){var t,n,i,o,s,a;const c=Pf(Sf(e)),l=null!==(t=c.apiKey)&&void 0!==t?t:null,u=null!==(n=c.oobCode)&&void 0!==n?n:null,f=function tEe(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=c.mode)&&void 0!==i?i:null);Ge(l&&u&&f,"argument-error"),this.apiKey=l,this.operation=f,this.code=u,this.continueUrl=null!==(o=c.continueUrl)&&void 0!==o?o:null,this.languageCode=null!==(s=c.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function nEe(r){const e=Pf(Sf(r)).link,t=e?Pf(Sf(e)).deep_link_id:null,n=Pf(Sf(r)).deep_link_id;return(n?Pf(Sf(n)).link:null)||n||t||e||r}(e);try{return new Df(t)}catch{return null}}}let cq=(()=>{class r{constructor(){this.providerId=r.PROVIDER_ID}static credential(t,n){return Lf._fromEmailAndPassword(t,n)}static credentialWithLink(t,n){const i=Df.parseLink(n);return Ge(i,"argument-error"),Lf._fromEmailAndCode(t,i.code,i.tenantId)}}return r.PROVIDER_ID="password",r.EMAIL_PASSWORD_SIGN_IN_METHOD="password",r.EMAIL_LINK_SIGN_IN_METHOD="emailLink",r})();class K4{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class lq extends K4{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}let rEe=(()=>{class r extends lq{constructor(){super("google.com"),this.addScope("profile")}static credential(t,n){return Q8._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:n})}static credentialFromResult(t){return r.credentialFromTaggedObject(t)}static credentialFromError(t){return r.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:n,oauthAccessToken:i}=t;if(!n&&!i)return null;try{return r.credential(n,i)}catch{return null}}}return r.GOOGLE_SIGN_IN_METHOD="google.com",r.PROVIDER_ID="google.com",r})();function uq(r,e){return mT.apply(this,arguments)}function mT(){return(mT=E(function*(r,e){return D3(r,"POST","/v1/accounts:signUp",X1(r,e))})).apply(this,arguments)}class Bs{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,n,i=!1){return E(function*(){const o=yield O6._fromIdTokenResponse(e,n,i),s=fq(n);return new Bs({user:o,providerId:s,_tokenResponse:n,operationType:t})})()}static _forOperation(e,t,n){return E(function*(){yield e._updateTokensIfNecessary(n,!0);const i=fq(n);return new Bs({user:e,providerId:i,_tokenResponse:n,operationType:t})})()}}function fq(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}class mm extends Nc{constructor(e,t,n,i){var o;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,mm.prototype),this.customData={appName:e.name,tenantId:null!==(o=e.tenantId)&&void 0!==o?o:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new mm(e,t,n,i)}}function dq(r,e,t,n){return("reauthenticate"===e?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(o=>{throw"auth/multi-factor-auth-required"===o.code?mm._fromErrorAndOperation(r,o,e,n):o})}function yT(){return(yT=E(function*(r,e,t=!1){const n=yield V3(r,e._linkToIdToken(r.auth,yield r.getIdToken()),t);return Bs._forOperation(r,"link",n)})).apply(this,arguments)}function ET(){return(ET=E(function*(r,e,t=!1){const{auth:n}=r,i="reauthenticate";try{const o=yield V3(r,dq(n,i,e,r),t);Ge(o.idToken,n,"internal-error");const s=fm(o.idToken);Ge(s,n,"internal-error");const{sub:a}=s;return Ge(r.uid===a,n,"user-mismatch"),Bs._forOperation(r,i,o)}catch(o){throw"auth/user-not-found"===o?.code&&Ro(n,"user-mismatch"),o}})).apply(this,arguments)}function pq(r,e){return PT.apply(this,arguments)}function PT(){return(PT=E(function*(r,e,t=!1){const n="signIn",i=yield dq(r,n,e),o=yield Bs._fromIdTokenResponse(r,n,i);return t||(yield r._updateCurrentUser(o.user)),o})).apply(this,arguments)}function OT(){return(OT=E(function*(r,e){return pq(Ur(r),e)})).apply(this,arguments)}function Cm(r,e,t){var n;Ge((null===(n=t.url)||void 0===n?void 0:n.length)>0,r,"invalid-continue-uri"),Ge(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,r,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(Ge(t.iOS.bundleId.length>0,r,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(Ge(t.android.packageName.length>0,r,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function RT(r){return xT.apply(this,arguments)}function xT(){return(xT=E(function*(r){const e=Ur(r);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})).apply(this,arguments)}function lEe(r,e,t){return LT.apply(this,arguments)}function LT(){return(LT=E(function*(r,e,t){const n=Ur(r),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Cm(n,i,t),yield xf(n,i,"getOobCode",BMe)})).apply(this,arguments)}function fEe(r,e,t){return FT.apply(this,arguments)}function FT(){return(FT=E(function*(r,e,t){const n=Ur(r),s=yield xf(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",uq).catch(c=>{throw"auth/password-does-not-meet-requirements"===c.code&&RT(r),c}),a=yield Bs._fromIdTokenResponse(n,"signIn",s);return yield n._updateCurrentUser(a.user),a})).apply(this,arguments)}function dEe(r,e,t){return function ST(r,e){return OT.apply(this,arguments)}(oi(r),cq.credential(e,t)).catch(function(){var n=E(function*(i){throw"auth/password-does-not-meet-requirements"===i.code&&RT(r),i});return function(i){return n.apply(this,arguments)}}())}function gEe(r,e){return WT.apply(this,arguments)}function WT(){return WT=E(function*(r,e){const t=oi(r),i={requestType:"VERIFY_EMAIL",idToken:yield r.getIdToken()};e&&Cm(t.auth,i,e);const{email:o}=yield function GMe(r,e){return iT.apply(this,arguments)}(t.auth,i);o!==r.email&&(yield r.reload())}),WT.apply(this,arguments)}function jT(){return(jT=E(function*(r,e){return Q1(r,"POST","/v1/accounts:update",e)})).apply(this,arguments)}function mEe(r,e){return ZT.apply(this,arguments)}function ZT(){return ZT=E(function*(r,{displayName:e,photoURL:t}){if(void 0===e&&void 0===t)return;const n=oi(r),o={idToken:yield n.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},s=yield V3(n,function pEe(r,e){return jT.apply(this,arguments)}(n.auth,o));n.displayName=s.displayName||null,n.photoURL=s.photoUrl||null;const a=n.providerData.find(({providerId:c})=>"password"===c);a&&(a.displayName=n.displayName,a.photoURL=n.photoURL),yield n._updateTokensIfNecessary(s)}),ZT.apply(this,arguments)}function SEe(r,e,t,n){return oi(r).onAuthStateChanged(e,t,n)}const vm="__sak";class _q{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(vm,"1"),this.storage.removeItem(vm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const kEe=(()=>{class r extends _q{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,n)=>this.onStorageEvent(t,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function wEe(){const r=Di();return WO(r)||hm(r)}()&&function SMe(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=QW(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),o=this.localCache[n];i!==o&&t(n,o,i)}}onStorageEvent(t,n=!1){if(!t.key)return void this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});const i=t.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(i);if(t.newValue!==a)null!==t.newValue?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!n)return}const o=()=>{const a=this.storage.getItem(i);!n&&this.localCache[i]===a||this.notifyListeners(i,a)},s=this.storage.getItem(i);!function PMe(){return function mve(){const r=Di();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}()&&10===document.documentMode}()||s===t.newValue||t.newValue===t.oldValue?o():setTimeout(o,10)}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const o of Array.from(i))o(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:i}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,n){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(t,n){var i=()=>super._set,o=this;return E(function*(){yield i().call(o,t,n),o.localCache[t]=JSON.stringify(n)})()}_get(t){var n=()=>super._get,i=this;return E(function*(){const o=yield n().call(i,t);return i.localCache[t]=JSON.stringify(o),o})()}_remove(t){var n=()=>super._remove,i=this;return E(function*(){yield n().call(i,t),delete i.localCache[t]})()}}return r.type="LOCAL",r})(),Cq=(()=>{class r extends _q{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,n){}_removeListener(t,n){}}return r.type="SESSION",r})();let xEe=(()=>{class r{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const n=this.receivers.find(o=>o.isListeningto(t));if(n)return n;const i=new r(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){var n=this;return E(function*(){const i=t,{eventId:o,eventType:s,data:a}=i.data,c=n.handlersMap[s];if(!c?.size)return;i.ports[0].postMessage({status:"ack",eventId:o,eventType:s});const l=Array.from(c).map(function(){var f=E(function*(g){return g(i.origin,a)});return function(g){return f.apply(this,arguments)}}()),u=yield function REe(r){return Promise.all(r.map(function(){var e=E(function*(t){try{return{fulfilled:!0,value:yield t}}catch(n){return{fulfilled:!1,reason:n}}});return function(t){return e.apply(this,arguments)}}()))}(l);i.ports[0].postMessage({status:"done",eventId:o,eventType:s,response:u})})()}_subscribe(t,n){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(n)}_unsubscribe(t,n){this.handlersMap[t]&&n&&this.handlersMap[t].delete(n),(!n||0===this.handlersMap[t].size)&&delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return r.receivers=[],r})();function ym(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(10*Math.random());return r+t}class LEe{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,n=50){var i=this;return E(function*(){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let s,a;return new Promise((c,l)=>{const u=ym("",20);o.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:o,onMessage(g){const y=g;if(y.data.eventId===u)switch(y.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(y.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"))}}},i.handlers.add(a),o.port1.addEventListener("message",a.onMessage),i.target.postMessage({eventType:e,eventId:u,data:t},[o.port2])}).finally(()=>{a&&i.removeMessageHandler(a)})})()}}function si(){return window}function nA(){return typeof si().WorkerGlobalScope<"u"&&"function"==typeof si().importScripts}function rA(){return(rA=E(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const vq="firebaseLocalStorageDb",Mm="firebaseLocalStorage",yq="fbase_key";class Hf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Em(r,e){return r.transaction([Mm],e?"readwrite":"readonly").objectStore(Mm)}function iA(){const r=indexedDB.open(vq,1);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(Mm,{keyPath:yq})}catch(i){t(i)}}),r.addEventListener("success",E(function*(){const n=r.result;n.objectStoreNames.contains(Mm)?e(n):(n.close(),yield function UEe(){const r=indexedDB.deleteDatabase(vq);return new Hf(r).toPromise()}(),e(yield iA()))}))})}function Mq(r,e,t){return oA.apply(this,arguments)}function oA(){return(oA=E(function*(r,e,t){const n=Em(r,!0).put({[yq]:e,value:t});return new Hf(n).toPromise()})).apply(this,arguments)}function sA(){return(sA=E(function*(r,e){const t=Em(r,!1).get(e),n=yield new Hf(t).toPromise();return void 0===n?null:n.value})).apply(this,arguments)}function Eq(r,e){const t=Em(r,!0).delete(e);return new Hf(t).toPromise()}const WEe=(()=>{class r{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var t=this;return E(function*(){return t.db||(t.db=yield iA()),t.db})()}_withRetries(t){var n=this;return E(function*(){let i=0;for(;;)try{const o=yield n._openDb();return yield t(o)}catch(o){if(i++>3)throw o;n.db&&(n.db.close(),n.db=void 0)}})()}initializeServiceWorkerMessaging(){var t=this;return E(function*(){return nA()?t.initializeReceiver():t.initializeSender()})()}initializeReceiver(){var t=this;return E(function*(){t.receiver=xEe._getInstance(function HEe(){return nA()?self:null}()),t.receiver._subscribe("keyChanged",function(){var n=E(function*(i,o){return{keyProcessed:(yield t._poll()).includes(o.key)}});return function(i,o){return n.apply(this,arguments)}}()),t.receiver._subscribe("ping",function(){var n=E(function*(i,o){return["keyChanged"]});return function(i,o){return n.apply(this,arguments)}}())})()}initializeSender(){var t=this;return E(function*(){var n,i;if(t.activeServiceWorker=yield function DEe(){return rA.apply(this,arguments)}(),!t.activeServiceWorker)return;t.sender=new LEe(t.activeServiceWorker);const o=yield t.sender._send("ping",{},800);o&&null!==(n=o[0])&&void 0!==n&&n.fulfilled&&null!==(i=o[0])&&void 0!==i&&i.value.includes("keyChanged")&&(t.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(t){var n=this;return E(function*(){if(n.sender&&n.activeServiceWorker&&function VEe(){var r;return(null===(r=navigator?.serviceWorker)||void 0===r?void 0:r.controller)||null}()===n.activeServiceWorker)try{yield n.sender._send("keyChanged",{key:t},n.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return E(function*(){try{if(!indexedDB)return!1;const t=yield iA();return yield Mq(t,vm,"1"),yield Eq(t,vm),!0}catch{}return!1})()}_withPendingWrite(t){var n=this;return E(function*(){n.pendingWrites++;try{yield t()}finally{n.pendingWrites--}})()}_set(t,n){var i=this;return E(function*(){return i._withPendingWrite(E(function*(){return yield i._withRetries(o=>Mq(o,t,n)),i.localCache[t]=n,i.notifyServiceWorker(t)}))})()}_get(t){var n=this;return E(function*(){const i=yield n._withRetries(o=>function $Ee(r,e){return sA.apply(this,arguments)}(o,t));return n.localCache[t]=i,i})()}_remove(t){var n=this;return E(function*(){return n._withPendingWrite(E(function*(){return yield n._withRetries(i=>Eq(i,t)),delete n.localCache[t],n.notifyServiceWorker(t)}))})()}_poll(){var t=this;return E(function*(){const n=yield t._withRetries(s=>{const a=Em(s,!1).getAll();return new Hf(a).toPromise()});if(!n)return[];if(0!==t.pendingWrites)return[];const i=[],o=new Set;if(0!==n.length)for(const{fbase_key:s,value:a}of n)o.add(s),JSON.stringify(t.localCache[s])!==JSON.stringify(a)&&(t.notifyListeners(s,a),i.push(s));for(const s of Object.keys(t.localCache))t.localCache[s]&&!o.has(s)&&(t.notifyListeners(s,null),i.push(s));return i})()}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const o of Array.from(i))o(n)}startPolling(){var t=this;this.stopPolling(),this.pollTimer=setInterval(E(function*(){return t._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,n){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return r.type="LOCAL",r})();function A6(r,e){return e?H3(e):(Ge(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}tq("rcb"),new wf(3e4,6e4);class pA extends XO{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return F3(e,this._buildIdpRequest())}_linkToIdToken(e,t){return F3(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return F3(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function aPe(r){return pq(r.auth,new pA(r),r.bypassAuthState)}function cPe(r){const{auth:e,user:t}=r;return Ge(t,e,"internal-error"),function gq(r,e){return ET.apply(this,arguments)}(t,new pA(r),r.bypassAuthState)}function lPe(r){return mA.apply(this,arguments)}function mA(){return(mA=E(function*(r){const{auth:e,user:t}=r;return Ge(t,e,"internal-error"),function vT(r,e){return yT.apply(this,arguments)}(t,new pA(r),r.bypassAuthState)})).apply(this,arguments)}class Sq{constructor(e,t,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){var e=this;return new Promise(function(){var t=E(function*(n,i){e.pendingPromise={resolve:n,reject:i};try{e.eventManager=yield e.resolver._initialize(e.auth),yield e.onExecution(),e.eventManager.registerConsumer(e)}catch(o){e.reject(o)}});return function(n,i){return t.apply(this,arguments)}}())}onAuthEvent(e){var t=this;return E(function*(){const{urlResponse:n,sessionId:i,postBody:o,tenantId:s,error:a,type:c}=e;if(a)return void t.reject(a);const l={auth:t.auth,requestUri:n,sessionId:i,tenantId:s||void 0,postBody:o||void 0,user:t.user,bypassAuthState:t.bypassAuthState};try{t.resolve(yield t.getIdpTask(c)(l))}catch(u){t.reject(u)}})()}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return aPe;case"linkViaPopup":case"linkViaRedirect":return lPe;case"reauthViaPopup":case"reauthViaRedirect":return cPe;default:Ro(this.auth,"internal-error")}}resolve(e){z3(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){z3(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const uPe=new wf(2e3,1e4);function fPe(r,e,t){return _A.apply(this,arguments)}function _A(){return(_A=E(function*(r,e,t){const n=Ur(r);!function K8(r,e,t){if(!(e instanceof t))throw t.name!==e.constructor.name&&Ro(r,"argument-error"),RW(r,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(r,e,K4);const i=A6(n,t);return new yA(n,"signInViaPopup",e,i).executeNotNull()})).apply(this,arguments)}let yA=(()=>{class r extends Sq{constructor(t,n,i,o,s){super(t,n,o,s),this.provider=i,this.authWindow=null,this.pollId=null,r.currentPopupAction&&r.currentPopupAction.cancel(),r.currentPopupAction=this}executeNotNull(){var t=this;return E(function*(){const n=yield t.execute();return Ge(n,t.auth,"internal-error"),n})()}onExecution(){var t=this;return E(function*(){z3(1===t.filter.length,"Popup operations only handle one event");const n=ym();t.authWindow=yield t.resolver._openPopup(t.auth,t.provider,t.filter[0],n),t.authWindow.associatedEvent=n,t.resolver._originValidation(t.auth).catch(i=>{t.reject(i)}),t.resolver._isIframeWebStorageSupported(t.auth,i=>{i||t.reject(ls(t.auth,"web-storage-unsupported"))}),t.pollUserCancellation()})()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(ls(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,r.currentPopupAction=null}pollUserCancellation(){const t=()=>{var n,i;this.pollId=null!==(i=null===(n=this.authWindow)||void 0===n?void 0:n.window)&&void 0!==i&&i.closed?window.setTimeout(()=>{this.pollId=null,this.reject(ls(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(t,uPe.get())};t()}}return r.currentPopupAction=null,r})();const dPe="pendingRedirect",Ff=new Map;class hPe extends Sq{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}execute(){var e=()=>super.execute,t=this;return E(function*(){let n=Ff.get(t.auth._key());if(!n){try{const o=(yield function gPe(r,e){return MA.apply(this,arguments)}(t.resolver,t.auth))?yield e().call(t):null;n=()=>Promise.resolve(o)}catch(i){n=()=>Promise.reject(i)}Ff.set(t.auth._key(),n)}return t.bypassAuthState||Ff.set(t.auth._key(),()=>Promise.resolve(null)),n()})()}onAuthEvent(e){var t=()=>super.onAuthEvent,n=this;return E(function*(){if("signInViaRedirect"===e.type)return t().call(n,e);if("unknown"!==e.type){if(e.eventId){const i=yield n.auth._redirectUserForId(e.eventId);if(i)return n.user=i,t().call(n,e);n.resolve(null)}}else n.resolve(null)})()}onExecution(){return E(function*(){})()}cleanUp(){}}function MA(){return(MA=E(function*(r,e){const t=function Tq(r){return dm(dPe,r.config.apiKey,r.name)}(e),n=function Oq(r){return H3(r._redirectPersistence)}(r);if(!(yield n._isAvailable()))return!1;const i="true"===(yield n._get(t));return yield n._remove(t),i})).apply(this,arguments)}function pPe(r,e){Ff.set(r._key(),e)}function Aq(r,e){return bA.apply(this,arguments)}function bA(){return(bA=E(function*(r,e,t=!1){const n=Ur(r),i=A6(n,e),s=yield new hPe(n,i,t).execute();return s&&!t&&(delete s.user._redirectEventId,yield n._persistUserIfCurrent(s.user),yield n._setRedirectUser(null,e)),s})).apply(this,arguments)}class yPe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function MPe(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Nq(r);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Nq(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(ls(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(wq(e))}saveEventToCache(e){this.cachedEventUids.add(wq(e)),this.lastProcessedEventTime=Date.now()}}function wq(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function Nq({type:r,error:e}){return"unknown"===r&&"auth/no-auth-event"===e?.code}function NA(){return(NA=E(function*(r,e={}){return Q1(r,"GET","/v1/projects",e)})).apply(this,arguments)}const PPe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,SPe=/^https?/;function IA(){return IA=E(function*(r){if(r.config.emulator)return;const{authorizedDomains:e}=yield function EPe(r){return NA.apply(this,arguments)}(r);for(const t of e)try{if(TPe(t))return}catch{}Ro(r,"unauthorized-domain")}),IA.apply(this,arguments)}function TPe(r){const e=bf(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const s=new URL(r);return""===s.hostname&&""===n?"chrome-extension:"===t&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===t&&s.hostname===n}if(!SPe.test(t))return!1;if(PPe.test(r))return n===r;const i=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}const APe=new wf(3e4,6e4);function Iq(){const r=si().___jsl;if(r?.H)for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}let Sm=null;const NPe=new wf(5e3,15e3),IPe="__/auth/iframe",kPe="emulator/auth/iframe",RPe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},xPe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function LPe(r){const e=r.config;Ge(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?wO(e,kPe):`https://${r.config.authDomain}/${IPe}`,n={apiKey:e.apiKey,appName:r.name,v:j8},i=xPe.get(r.config.apiHost);i&&(n.eid=i);const o=r._getFrameworks();return o.length&&(n.fw=o.join(",")),`${t}?${Ef(n).slice(1)}`}function kA(){return kA=E(function*(r){const e=yield function wPe(r){return Sm=Sm||function bPe(r){return new Promise((e,t)=>{var n,i,o;function s(){Iq(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Iq(),t(ls(r,"network-request-failed"))},timeout:APe.get()})}if(null!==(i=null===(n=si().gapi)||void 0===n?void 0:n.iframes)&&void 0!==i&&i.Iframe)e(gapi.iframes.getContext());else{if(null===(o=si().gapi)||void 0===o||!o.load){const a=tq("iframefcb");return si()[a]=()=>{gapi.load?s():t(ls(r,"network-request-failed"))},jO(`https://apis.google.com/js/api.js?onload=${a}`).catch(c=>t(c))}s()}}).catch(e=>{throw Sm=null,e})}(r),Sm}(r),t=si().gapi;return Ge(t,r,"internal-error"),e.open({where:document.body,url:LPe(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:RPe,dontclear:!0},n=>new Promise(function(){var i=E(function*(o,s){yield n.restyle({setHideOnLeave:!1});const a=ls(r,"network-request-failed"),c=si().setTimeout(()=>{s(a)},NPe.get());function l(){si().clearTimeout(c),o(n)}n.ping(l).then(l,()=>{s(a)})});return function(o,s){return i.apply(this,arguments)}}()))}),kA.apply(this,arguments)}const DPe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class kq{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const BPe="__/auth/handler",WPe="emulator/auth/handler",qPe=encodeURIComponent("fac");function Rq(r,e,t,n,i,o){return RA.apply(this,arguments)}function RA(){return(RA=E(function*(r,e,t,n,i,o){Ge(r.config.authDomain,r,"auth-domain-config-required"),Ge(r.config.apiKey,r,"invalid-api-key");const s={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:j8,eventId:i};if(e instanceof K4){e.setDefaultLanguage(r.languageCode),s.providerId=e.providerId||"",function Eve(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,f]of Object.entries(o||{}))s[u]=f}if(e instanceof lq){const u=e.getScopes().filter(f=>""!==f);u.length>0&&(s.scopes=u.join(","))}r.tenantId&&(s.tid=r.tenantId);const a=s;for(const u of Object.keys(a))void 0===a[u]&&delete a[u];const c=yield r._getAppCheckToken(),l=c?`#${qPe}=${encodeURIComponent(c)}`:"";return`${function jPe({config:r}){return r.emulator?wO(r,WPe):`https://${r.authDomain}/${BPe}`}(r)}?${Ef(a).slice(1)}${l}`})).apply(this,arguments)}const xA="webStorageSupport",YPe=class ZPe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Cq,this._completeRedirectFn=Aq,this._overrideRedirectResult=pPe}_openPopup(e,t,n,i){var o=this;return E(function*(){var s;z3(null===(s=o.eventManagers[e._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()");const a=yield Rq(e,t,n,bf(),i);return function $Pe(r,e,t,n=500,i=600){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let a="";const c=Object.assign(Object.assign({},DPe),{width:n.toString(),height:i.toString(),top:o,left:s}),l=Di().toLowerCase();t&&(a=jW(l)?"_blank":t),qW(l)&&(e=e||"http://localhost",c.scrollbars="yes");const u=Object.entries(c).reduce((g,[y,S])=>`${g}${y}=${S},`,"");if(function EMe(r=Di()){var e;return hm(r)&&!(null===(e=window.navigator)||void 0===e||!e.standalone)}(l)&&"_self"!==a)return function GPe(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}(e||"",a),new kq(null);const f=window.open(e||"",a,u);Ge(f,r,"popup-blocked");try{f.focus()}catch{}return new kq(f)}(e,a,ym())})()}_openRedirect(e,t,n,i){var o=this;return E(function*(){return yield o._originValidation(e),function zEe(r){si().location.href=r}(yield Rq(e,t,n,bf(),i)),new Promise(()=>{})})()}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(z3(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}initAndGetManager(e){var t=this;return E(function*(){const n=yield function zPe(r){return kA.apply(this,arguments)}(e),i=new yPe(e);return n.register("authEvent",o=>(Ge(o?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:i},t.iframes[e._key()]=n,i})()}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(xA,{type:xA},i=>{var o;const s=null===(o=i?.[0])||void 0===o?void 0:o[xA];void 0!==s&&t(!!s),Ro(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function OPe(r){return IA.apply(this,arguments)}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return QW()||WO()||hm()}};var zq="@firebase/auth";class KPe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}getToken(e){var t=this;return E(function*(){return t.assertAuthConfigured(),yield t.auth._initializationPromise,t.auth.currentUser?{accessToken:yield t.auth.currentUser.getIdToken(e)}:null})()}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ge(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const eSe=cW("authIdTokenMaxAge")||300;let Vq=null;const tSe=r=>function(){var e=E(function*(t){const n=t&&(yield t.getIdTokenResult()),i=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>eSe)return;const o=n?.token;Vq!==o&&(Vq=o,yield fetch(r,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))});return function(t){return e.apply(this,arguments)}}();function nSe(r=_O()){const e=sm(r,"auth");if(e.isInitialized())return e.getImmediate();const t=function LMe(r,e){const t=sm(r,"auth");if(t.isInitialized()){const i=t.getImmediate();if(rm(t.getOptions(),e??{}))return i;Ro(i,"already-initialized")}return t.initialize({options:e})}(r,{popupRedirectResolver:YPe,persistence:[WEe,kEe,Cq]}),n=cW("authTokenSyncURL");if(n){const o=tSe(n);(function PEe(r,e,t){oi(r).beforeAuthStateChanged(e,t)})(t,o,()=>o(t.currentUser)),function EEe(r,e,t,n){oi(r).onIdTokenChanged(e,t,n)}(t,s=>o(s))}const i=sW("auth");return i&&iq(t,`http://${i}`),t}!function QPe(r){q8(new y6("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=n.options;Ge(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:s,authDomain:a,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:JW(r)},l=new wMe(n,i,o,c);return function zMe(r,e){const t=e?.persistence||[],n=(Array.isArray(t)?t:[t]).map(H3);e?.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e?.popupRedirectResolver)}(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),q8(new y6("auth-internal",e=>{const t=Ur(e.getProvider("auth").getImmediate());return new KPe(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),cs(zq,"1.5.1",function XPe(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(r)),cs(zq,"1.5.1","esm2017")}("Browser");class Tm{constructor(e){return e}}class Fq{constructor(){return PO("auth")}}const zA=new Qe("angularfire2.auth-instances");function iSe(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new Tm(n)}}const oSe={provide:Fq,deps:[[new Jo,zA]]},sSe={provide:Tm,useFactory:function rSe(r,e){const t=bW("auth",r,e);return t&&new Tm(t)},deps:[[new Jo,zA],Af]};let aSe=(()=>{class r{constructor(){cs("angularfire",cm.full,"auth")}static \u0275fac=function(n){return new(n||r)};static \u0275mod=N2({type:r});static \u0275inj=s2({providers:[sSe,oSe]})}return r})();const uSe=K1(fEe,!0),fSe=K1(nSe,!0),dSe=K1(SEe,!0),hSe=K1(gEe,!0),gSe=K1(lEe,!0),pSe=K1(dEe,!0),mSe=K1(fPe,!0),_Se=K1(mEe,!0);var nt,CSe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ra={},DA=DA||{},Jt=CSe||self;function Am(r){var e=typeof r;return"array"==(e="object"!=e?e:r?Array.isArray(r)?"array":e:"null")||"object"==e&&"number"==typeof r.length}function Uf(r){var e=typeof r;return"object"==e&&null!=r||"function"==e}var VA="closure_uid_"+(1e9*Math.random()>>>0),ySe=0;function MSe(r,e,t){return r.call.apply(r.bind,arguments)}function ESe(r,e,t){if(!r)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),r.apply(e,i)}}return function(){return r.apply(e,arguments)}}function U2(r,e,t){return(U2=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?MSe:ESe).apply(null,arguments)}function bm(r,e){var t=Array.prototype.slice.call(arguments,1);return function(){var n=t.slice();return n.push.apply(n,arguments),r.apply(this,n)}}function Vi(r,e){function t(){}t.prototype=e.prototype,r.$=e.prototype,r.prototype=new t,r.prototype.constructor=r,r.ac=function(n,i,o){for(var s=Array(arguments.length-2),a=2;a<arguments.length;a++)s[a-2]=arguments[a];return e.prototype[i].apply(n,s)}}function X4(){this.s=this.s,this.o=this.o}X4.prototype.s=!1,X4.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function vSe(r){Object.prototype.hasOwnProperty.call(r,VA)&&r[VA]||(r[VA]=++ySe)}(this)},X4.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Uq=Array.prototype.indexOf?function(r,e){return Array.prototype.indexOf.call(r,e,void 0)}:function(r,e){if("string"==typeof r)return"string"!=typeof e||1!=e.length?-1:r.indexOf(e,0);for(let t=0;t<r.length;t++)if(t in r&&r[t]===e)return t;return-1};function HA(r){const e=r.length;if(0<e){const t=Array(e);for(let n=0;n<e;n++)t[n]=r[n];return t}return[]}function $q(r,e){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(Am(n)){const i=r.length||0,o=n.length||0;r.length=i+o;for(let s=0;s<o;s++)r[i+s]=n[s]}else r.push(n)}}function $2(r,e){this.type=r,this.g=this.target=e,this.defaultPrevented=!1}$2.prototype.h=function(){this.defaultPrevented=!0};var SSe=function(){if(!Jt.addEventListener||!Object.defineProperty)return!1;var r=!1,e=Object.defineProperty({},"passive",{get:function(){r=!0}});try{const t=()=>{};Jt.addEventListener("test",t,e),Jt.removeEventListener("test",t,e)}catch{}return r}();function $f(r){return/^[\s\xa0]*$/.test(r)}function wm(){var r=Jt.navigator;return r&&(r=r.userAgent)?r:""}function kc(r){return-1!=wm().indexOf(r)}function FA(r){return FA[" "](r),r}FA[" "]=function(){};var $A,r,TSe=kc("Opera"),J8=kc("Trident")||kc("MSIE"),Gq=kc("Edge"),UA=Gq||J8,Bq=kc("Gecko")&&!(-1!=wm().toLowerCase().indexOf("webkit")&&!kc("Edge"))&&!(kc("Trident")||kc("MSIE"))&&!kc("Edge"),ASe=-1!=wm().toLowerCase().indexOf("webkit")&&!kc("Edge");function Wq(){var r=Jt.document;return r?r.documentMode:void 0}e:{var GA="",BA=(r=wm(),Bq?/rv:([^\);]+)(\)|;)/.exec(r):Gq?/Edge\/([\d\.]+)/.exec(r):J8?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(r):ASe?/WebKit\/(\S+)/.exec(r):TSe?/(?:Version)[ \/]?(\S+)/.exec(r):void 0);if(BA&&(GA=BA?BA[1]:""),J8){var WA=Wq();if(null!=WA&&WA>parseFloat(GA)){$A=String(WA);break e}}$A=GA}var bSe=Jt.document&&J8&&(Wq()||parseInt($A,10))||void 0;function Gf(r,e){if($2.call(this,r?r.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,r){var t=this.type=r.type,n=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:null;if(this.target=r.target||r.srcElement,this.g=e,e=r.relatedTarget){if(Bq){e:{try{FA(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=r.fromElement:"mouseout"==t&&(e=r.toElement);this.relatedTarget=e,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=r.button,this.key=r.key||"",this.ctrlKey=r.ctrlKey,this.altKey=r.altKey,this.shiftKey=r.shiftKey,this.metaKey=r.metaKey,this.pointerId=r.pointerId||0,this.pointerType="string"==typeof r.pointerType?r.pointerType:wSe[r.pointerType]||"",this.state=r.state,this.i=r,r.defaultPrevented&&Gf.$.h.call(this)}}Vi(Gf,$2);var wSe={2:"touch",3:"pen",4:"mouse"};Gf.prototype.h=function(){Gf.$.h.call(this);var r=this.i;r.preventDefault?r.preventDefault():r.returnValue=!1};var Bf="closure_listenable_"+(1e6*Math.random()|0),NSe=0;function ISe(r,e,t,n,i){this.listener=r,this.proxy=null,this.src=e,this.type=t,this.capture=!!n,this.la=i,this.key=++NSe,this.fa=this.ia=!1}function Nm(r){r.fa=!0,r.listener=null,r.proxy=null,r.src=null,r.la=null}function jA(r,e,t){for(const n in r)e.call(t,r[n],n,r)}function jq(r){const e={};for(const t in r)e[t]=r[t];return e}const Zq="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Yq(r,e){let t,n;for(let i=1;i<arguments.length;i++){for(t in n=arguments[i],n)r[t]=n[t];for(let o=0;o<Zq.length;o++)t=Zq[o],Object.prototype.hasOwnProperty.call(n,t)&&(r[t]=n[t])}}function Im(r){this.src=r,this.g={},this.h=0}function ZA(r,e){var t=e.type;if(t in r.g){var o,n=r.g[t],i=Uq(n,e);(o=0<=i)&&Array.prototype.splice.call(n,i,1),o&&(Nm(e),0==r.g[t].length&&(delete r.g[t],r.h--))}}function YA(r,e,t,n){for(var i=0;i<r.length;++i){var o=r[i];if(!o.fa&&o.listener==e&&o.capture==!!t&&o.la==n)return i}return-1}Im.prototype.add=function(r,e,t,n,i){var o=r.toString();(r=this.g[o])||(r=this.g[o]=[],this.h++);var s=YA(r,e,n,i);return-1<s?(e=r[s],t||(e.ia=!1)):((e=new ISe(e,this.src,o,!!n,i)).ia=t,r.push(e)),e};var KA="closure_lm_"+(1e6*Math.random()|0),XA={};function Kq(r,e,t,n,i){if(n&&n.once)return Qq(r,e,t,n,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Kq(r,e[o],t,n,i);return null}return t=tb(t),r&&r[Bf]?r.O(e,t,Uf(n)?!!n.capture:!!n,i):Xq(r,e,t,!1,n,i)}function Xq(r,e,t,n,i,o){if(!e)throw Error("Invalid event type");var s=Uf(i)?!!i.capture:!!i,a=JA(r);if(a||(r[KA]=a=new Im(r)),(t=a.add(e,t,n,s,o)).proxy)return t;if(n=function RSe(){const e=xSe;return function r(t){return e.call(r.src,r.listener,t)}}(),t.proxy=n,n.src=r,n.listener=t,r.addEventListener)SSe||(i=s),void 0===i&&(i=!1),r.addEventListener(e.toString(),n,i);else if(r.attachEvent)r.attachEvent(ej(e.toString()),n);else{if(!r.addListener||!r.removeListener)throw Error("addEventListener and attachEvent are unavailable.");r.addListener(n)}return t}function Qq(r,e,t,n,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Qq(r,e[o],t,n,i);return null}return t=tb(t),r&&r[Bf]?r.P(e,t,Uf(n)?!!n.capture:!!n,i):Xq(r,e,t,!0,n,i)}function Jq(r,e,t,n,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Jq(r,e[o],t,n,i);else n=Uf(n)?!!n.capture:!!n,t=tb(t),r&&r[Bf]?(r=r.i,(e=String(e).toString())in r.g&&-1<(t=YA(o=r.g[e],t,n,i))&&(Nm(o[t]),Array.prototype.splice.call(o,t,1),0==o.length&&(delete r.g[e],r.h--))):r&&(r=JA(r))&&(e=r.g[e.toString()],r=-1,e&&(r=YA(e,t,n,i)),(t=-1<r?e[r]:null)&&QA(t))}function QA(r){if("number"!=typeof r&&r&&!r.fa){var e=r.src;if(e&&e[Bf])ZA(e.i,r);else{var t=r.type,n=r.proxy;e.removeEventListener?e.removeEventListener(t,n,r.capture):e.detachEvent?e.detachEvent(ej(t),n):e.addListener&&e.removeListener&&e.removeListener(n),(t=JA(e))?(ZA(t,r),0==t.h&&(t.src=null,e[KA]=null)):Nm(r)}}}function ej(r){return r in XA?XA[r]:XA[r]="on"+r}function xSe(r,e){if(r.fa)r=!0;else{e=new Gf(e,this);var t=r.listener,n=r.la||r.src;r.ia&&QA(r),r=t.call(n,e)}return r}function JA(r){return(r=r[KA])instanceof Im?r:null}var eb="__closure_events_fn_"+(1e9*Math.random()>>>0);function tb(r){return"function"==typeof r?r:(r[eb]||(r[eb]=function(e){return r.handleEvent(e)}),r[eb])}function Hi(){X4.call(this),this.i=new Im(this),this.S=this,this.J=null}function f2(r,e){var t,n=r.J;if(n)for(t=[];n;n=n.J)t.push(n);if(r=r.S,n=e.type||e,"string"==typeof e)e=new $2(e,r);else if(e instanceof $2)e.target=e.target||r;else{var i=e;Yq(e=new $2(n,r),i)}if(i=!0,t)for(var o=t.length-1;0<=o;o--){var s=e.g=t[o];i=km(s,n,!0,e)&&i}if(i=km(s=e.g=r,n,!0,e)&&i,i=km(s,n,!1,e)&&i,t)for(o=0;o<t.length;o++)i=km(s=e.g=t[o],n,!1,e)&&i}function km(r,e,t,n){if(!(e=r.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.fa&&s.capture==t){var a=s.listener,c=s.la||s.src;s.ia&&ZA(r.i,s),i=!1!==a.call(c,n)&&i}}return i&&!n.defaultPrevented}Vi(Hi,X4),Hi.prototype[Bf]=!0,Hi.prototype.removeEventListener=function(r,e,t,n){Jq(this,r,e,t,n)},Hi.prototype.N=function(){if(Hi.$.N.call(this),this.i){var e,r=this.i;for(e in r.g){for(var t=r.g[e],n=0;n<t.length;n++)Nm(t[n]);delete r.g[e],r.h--}}this.J=null},Hi.prototype.O=function(r,e,t,n){return this.i.add(String(r),e,!1,t,n)},Hi.prototype.P=function(r,e,t,n){return this.i.add(String(r),e,!0,t,n)};var nb=Jt.JSON.stringify;function zSe(){var r=rb;let e=null;return r.g&&(e=r.g,r.g=r.g.next,r.g||(r.h=null),e.next=null),e}var tj=new class LSe{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new VSe,r=>r.reset());class VSe{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function HSe(r){var e=1;r=r.split(":");const t=[];for(;0<e&&r.length;)t.push(r.shift()),e--;return r.length&&t.push(r.join(":")),t}function FSe(r){Jt.setTimeout(()=>{throw r},0)}let Wf,qf=!1,rb=new class DSe{constructor(){this.h=this.g=null}add(e,t){const n=tj.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},nj=()=>{const r=Jt.Promise.resolve(void 0);Wf=()=>{r.then(USe)}};var USe=()=>{for(var r;r=zSe();){try{r.h.call(r.g)}catch(t){FSe(t)}var e=tj;e.j(r),100>e.h&&(e.h++,r.next=e.g,e.g=r)}qf=!1};function Rm(r,e){Hi.call(this),this.h=r||1,this.g=e||Jt,this.j=U2(this.qb,this),this.l=Date.now()}function ib(r){r.ga=!1,r.T&&(r.g.clearTimeout(r.T),r.T=null)}function ob(r,e,t){if("function"==typeof r)t&&(r=U2(r,t));else{if(!r||"function"!=typeof r.handleEvent)throw Error("Invalid listener argument");r=U2(r.handleEvent,r)}return 2147483647<Number(e)?-1:Jt.setTimeout(r,e||0)}function rj(r){r.g=ob(()=>{r.g=null,r.i&&(r.i=!1,rj(r))},r.j);const e=r.h;r.h=null,r.m.apply(null,e)}Vi(Rm,Hi),(nt=Rm.prototype).ga=!1,nt.T=null,nt.qb=function(){if(this.ga){var r=Date.now()-this.l;0<r&&r<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-r):(this.T&&(this.g.clearTimeout(this.T),this.T=null),f2(this,"tick"),this.ga&&(ib(this),this.start()))}},nt.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},nt.N=function(){Rm.$.N.call(this),ib(this),delete this.g};class $Se extends X4{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:rj(this)}N(){super.N(),this.g&&(Jt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function jf(r){X4.call(this),this.h=r,this.g={}}Vi(jf,X4);var ij=[];function oj(r,e,t,n){Array.isArray(t)||(t&&(ij[0]=t.toString()),t=ij);for(var i=0;i<t.length;i++){var o=Kq(e,t[i],n||r.handleEvent,!1,r.h||r);if(!o)break;r.g[o.key]=o}}function sj(r){jA(r.g,function(e,t){this.g.hasOwnProperty(t)&&QA(e)},r),r.g={}}function xm(){this.g=!0}function e5(r,e,t,n){r.info(function(){return"XMLHTTP TEXT ("+e+"): "+function qSe(r,e){if(!r.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(r=0;r<t.length;r++)if(Array.isArray(t[r])){var n=t[r];if(!(2>n.length)){var i=n[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return nb(t)}catch{return e}}(r,t)+(n?" "+n:"")})}jf.prototype.N=function(){jf.$.N.call(this),sj(this)},jf.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},xm.prototype.Ea=function(){this.g=!1},xm.prototype.info=function(){};var b6={},aj=null;function Lm(){return aj=aj||new Hi}function cj(r){$2.call(this,b6.Ta,r)}function Zf(r){const e=Lm();f2(e,new cj(e))}function lj(r,e){$2.call(this,b6.STAT_EVENT,r),this.stat=e}function fo(r){const e=Lm();f2(e,new lj(e,r))}function uj(r,e){$2.call(this,b6.Ua,r),this.size=e}function Yf(r,e){if("function"!=typeof r)throw Error("Fn must not be null and must be a function");return Jt.setTimeout(function(){r()},e)}b6.Ta="serverreachability",Vi(cj,$2),b6.STAT_EVENT="statevent",Vi(lj,$2),b6.Ua="timingevent",Vi(uj,$2);var zm={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},fj={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function sb(){}function hj(){}sb.prototype.h=null;var lb,Kf={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function ab(){$2.call(this,"d")}function cb(){$2.call(this,"c")}function Dm(){}function Xf(r,e,t,n){this.l=r,this.j=e,this.m=t,this.W=n||1,this.U=new jf(this),this.P=jSe,this.V=new Rm(r=UA?125:void 0),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new gj}function gj(){this.i=null,this.g="",this.h=!1}Vi(ab,$2),Vi(cb,$2),Vi(Dm,sb),Dm.prototype.g=function(){return new XMLHttpRequest},Dm.prototype.i=function(){return{}},lb=new Dm;var jSe=45e3,pj={},ub={};function fb(r,e,t){r.L=1,r.A=Um(U3(e)),r.u=t,r.S=!0,mj(r,null)}function mj(r,e){r.G=Date.now(),Qf(r),r.B=U3(r.A);var t=r.B,n=r.W;Array.isArray(n)||(n=[String(n)]),Tj(t.i,"t",n),r.o=0,t=r.l.J,r.h=new gj,r.g=Kj(r.l,t?e:null,!r.u),0<r.O&&(r.M=new $Se(U2(r.Pa,r,r.g),r.O)),oj(r.U,r.g,"readystatechange",r.nb),e=r.I?jq(r.I):{},r.u?(r.v||(r.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",r.g.ha(r.B,r.v,r.u,e)):(r.v="GET",r.g.ha(r.B,r.v,null,e)),Zf(),function GSe(r,e,t,n,i,o){r.info(function(){if(r.g)if(o)for(var s="",a=o.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var f=u.split("_");s=2<=f.length&&"type"==f[1]?s+(u+"=")+l+"&":s+(u+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+n+") [attempt "+i+"]: "+e+"\n"+t+"\n"+s})}(r.j,r.v,r.B,r.m,r.W,r.u)}function _j(r){return!!r.g&&"GET"==r.v&&2!=r.L&&r.l.Ha}function Cj(r,e,t){let i,n=!0;for(;!r.J&&r.o<t.length;){if(i=ZSe(r,t),i==ub){4==e&&(r.s=4,fo(14),n=!1),e5(r.j,r.m,null,"[Incomplete Response]");break}if(i==pj){r.s=4,fo(15),e5(r.j,r.m,t,"[Invalid Chunk]"),n=!1;break}e5(r.j,r.m,i,null),db(r,i)}_j(r)&&0!=r.o&&(r.h.g=r.h.g.slice(r.o),r.o=0),4!=e||0!=t.length||r.h.h||(r.s=1,fo(16),n=!1),r.i=r.i&&n,n?0<t.length&&!r.ba&&(r.ba=!0,(e=r.l).g==r&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),vb(e),e.M=!0,fo(11))):(e5(r.j,r.m,t,"[Invalid Chunked Response]"),w6(r),Jf(r))}function ZSe(r,e){var t=r.o,n=e.indexOf("\n",t);return-1==n?ub:(t=Number(e.substring(t,n)),isNaN(t)?pj:(n+=1)+t>e.length?ub:(e=e.slice(n,n+t),r.o=n+t,e))}function Qf(r){r.Y=Date.now()+r.P,vj(r,r.P)}function vj(r,e){if(null!=r.C)throw Error("WatchDog timer not null");r.C=Yf(U2(r.lb,r),e)}function Vm(r){r.C&&(Jt.clearTimeout(r.C),r.C=null)}function Jf(r){0==r.l.H||r.J||qj(r.l,r)}function w6(r){Vm(r);var e=r.M;e&&"function"==typeof e.sa&&e.sa(),r.M=null,ib(r.V),sj(r.U),r.g&&(e=r.g,r.g=null,e.abort(),e.sa())}function db(r,e){try{var t=r.l;if(0!=t.H&&(t.g==r||hb(t.i,r)))if(!r.K&&hb(t.i,r)&&3==t.H){try{var n=t.Ja.g.parse(e)}catch{n=null}if(Array.isArray(n)&&3==n.length){var i=n;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<r.G))break e;jm(t),Wm(t)}Cb(t),fo(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&0==t.A&&!t.v&&(t.v=Yf(U2(t.ib,t),6e3));if(1>=wj(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else I6(t,11)}else if((r.K||t.g==r)&&jm(t),!$f(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(t.V=l[0],l=l[1],2==t.H)if("c"==l[0]){t.K=l[1],t.pa=l[2];const u=l[3];null!=u&&(t.ra=u,t.l.info("VER="+t.ra));const f=l[4];null!=f&&(t.Ga=f,t.l.info("SVER="+t.Ga));const g=l[5];null!=g&&"number"==typeof g&&0<g&&(t.L=n=1.5*g,t.l.info("backChannelRequestTimeoutMs_="+n)),n=t;const y=r.g;if(y){const S=y.g?y.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(S){var o=n.i;o.g||-1==S.indexOf("spdy")&&-1==S.indexOf("quic")&&-1==S.indexOf("h2")||(o.j=o.l,o.g=new Set,o.h&&(gb(o,o.h),o.h=null))}if(n.F){const I=y.g?y.g.getResponseHeader("X-HTTP-Session-Id"):null;I&&(n.Da=I,J1(n.I,n.F,I))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-r.G,t.l.info("Handshake RTT: "+t.S+"ms"));var s=r;if((n=t).wa=Yj(n,n.J?n.pa:null,n.Y),s.K){Nj(n.i,s);var a=s,c=n.L;c&&a.setTimeout(c),a.C&&(Vm(a),Qf(a)),n.g=s}else Bj(n);0<t.j.length&&qm(t)}else"stop"!=l[0]&&"close"!=l[0]||I6(t,7);else 3==t.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?I6(t,7):_b(t):"noop"!=l[0]&&t.h&&t.h.Aa(l),t.A=0)}Zf()}catch{}}function yj(r,e){if(r.forEach&&"function"==typeof r.forEach)r.forEach(e,void 0);else if(Am(r)||"string"==typeof r)Array.prototype.forEach.call(r,e,void 0);else for(var t=function KSe(r){if(r.ta&&"function"==typeof r.ta)return r.ta();if(!r.Z||"function"!=typeof r.Z){if(typeof Map<"u"&&r instanceof Map)return Array.from(r.keys());if(!(typeof Set<"u"&&r instanceof Set)){if(Am(r)||"string"==typeof r){var e=[];r=r.length;for(var t=0;t<r;t++)e.push(t);return e}e=[],t=0;for(const n in r)e[t++]=n;return e}}}(r),n=function YSe(r){if(r.Z&&"function"==typeof r.Z)return r.Z();if(typeof Map<"u"&&r instanceof Map||typeof Set<"u"&&r instanceof Set)return Array.from(r.values());if("string"==typeof r)return r.split("");if(Am(r)){for(var e=[],t=r.length,n=0;n<t;n++)e.push(r[n]);return e}for(n in e=[],t=0,r)e[t++]=r[n];return e}(r),i=n.length,o=0;o<i;o++)e.call(void 0,n[o],t&&t[o],r)}(nt=Xf.prototype).setTimeout=function(r){this.P=r},nt.nb=function(r){r=r.target;const e=this.M;e&&3==Rc(r)?e.l():this.Pa(r)},nt.Pa=function(r){try{if(r==this.g)e:{const u=Rc(this.g);var e=this.g.Ia();if(this.g.da(),!(3>u)&&(3!=u||UA||this.g&&(this.h.h||this.g.ja()||Vj(this.g)))){this.J||4!=u||7==e||Zf(),Vm(this);var t=this.g.da();this.ca=t;t:if(_j(this)){var n=Vj(this.g);r="";var i=n.length,o=4==Rc(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){w6(this),Jf(this);var s="";break t}this.h.i=new Jt.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,r+=this.h.i.decode(n[e],{stream:o&&e==i-1});n.length=0,this.h.g+=r,this.o=0,s=this.h.g}else s=this.g.ja();if(this.i=200==t,function BSe(r,e,t,n,i,o,s){r.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+o+" "+s})}(this.j,this.v,this.B,this.m,this.W,u,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$f(a)){var l=a;break t}}l=null}if(!(t=l)){this.i=!1,this.s=3,fo(12),w6(this),Jf(this);break e}e5(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,db(this,t)}this.S?(Cj(this,u,s),UA&&this.i&&3==u&&(oj(this.U,this.V,"tick",this.mb),this.V.start())):(e5(this.j,this.m,s,null),db(this,s)),4==u&&w6(this),this.i&&!this.J&&(4==u?qj(this.l,this):(this.i=!1,Qf(this)))}else(function gOe(r){const e={};r=(r.g&&2<=Rc(r)&&r.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<r.length;n++){if($f(r[n]))continue;var t=HSe(r[n]);const i=t[0];if("string"!=typeof(t=t[1]))continue;t=t.trim();const o=e[i]||[];e[i]=o,o.push(t)}!function kSe(r,e){for(const t in r)e.call(void 0,r[t],t,r)}(e,function(n){return n.join(", ")})})(this.g),400==t&&0<s.indexOf("Unknown SID")?(this.s=3,fo(12)):(this.s=0,fo(13)),w6(this),Jf(this)}}}catch{}},nt.mb=function(){if(this.g){var r=Rc(this.g),e=this.g.ja();this.o<e.length&&(Vm(this),Cj(this,r,e),this.i&&4!=r&&Qf(this))}},nt.cancel=function(){this.J=!0,w6(this)},nt.lb=function(){this.C=null;const r=Date.now();0<=r-this.Y?(function WSe(r,e){r.info(function(){return"TIMEOUT: "+e})}(this.j,this.B),2!=this.L&&(Zf(),fo(17)),w6(this),this.s=2,Jf(this)):vj(this,this.Y-r)};var Mj=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function N6(r){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,r instanceof N6){this.h=r.h,Hm(this,r.j),this.s=r.s,this.g=r.g,Fm(this,r.m),this.l=r.l;var e=r.i,t=new n9;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),Ej(this,t),this.o=r.o}else r&&(e=String(r).match(Mj))?(this.h=!1,Hm(this,e[1]||"",!0),this.s=e9(e[2]||""),this.g=e9(e[3]||"",!0),Fm(this,e[4]),this.l=e9(e[5]||"",!0),Ej(this,e[6]||"",!0),this.o=e9(e[7]||"")):(this.h=!1,this.i=new n9(null,this.h))}function U3(r){return new N6(r)}function Hm(r,e,t){r.j=t?e9(e,!0):e,r.j&&(r.j=r.j.replace(/:$/,""))}function Fm(r,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);r.m=e}else r.m=null}function Ej(r,e,t){e instanceof n9?(r.i=e,function rOe(r,e){e&&!r.j&&(Q4(r),r.i=null,r.g.forEach(function(t,n){var i=n.toLowerCase();n!=i&&(Sj(this,n),Tj(this,i,t))},r)),r.j=e}(r.i,r.h)):(t||(e=t9(e,tOe)),r.i=new n9(e,r.h))}function J1(r,e,t){r.i.set(e,t)}function Um(r){return J1(r,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),r}function e9(r,e){return r?e?decodeURI(r.replace(/%25/g,"%2525")):decodeURIComponent(r):""}function t9(r,e,t){return"string"==typeof r?(r=encodeURI(r).replace(e,QSe),t&&(r=r.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),r):null}function QSe(r){return"%"+((r=r.charCodeAt(0))>>4&15).toString(16)+(15&r).toString(16)}N6.prototype.toString=function(){var r=[],e=this.j;e&&r.push(t9(e,Pj,!0),":");var t=this.g;return(t||"file"==e)&&(r.push("//"),(e=this.s)&&r.push(t9(e,Pj,!0),"@"),r.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&r.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&r.push("/"),r.push(t9(t,"/"==t.charAt(0)?eOe:JSe,!0))),(t=this.i.toString())&&r.push("?",t),(t=this.o)&&r.push("#",t9(t,nOe)),r.join("")};var Pj=/[#\/\?@]/g,JSe=/[#\?:]/g,eOe=/[#\?]/g,tOe=/[#\?@]/g,nOe=/#/g;function n9(r,e){this.h=this.g=null,this.i=r||null,this.j=!!e}function Q4(r){r.g||(r.g=new Map,r.h=0,r.i&&function XSe(r,e){if(r){r=r.split("&");for(var t=0;t<r.length;t++){var n=r[t].indexOf("="),i=null;if(0<=n){var o=r[t].substring(0,n);i=r[t].substring(n+1)}else o=r[t];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(r.i,function(e,t){r.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function Sj(r,e){Q4(r),e=t5(r,e),r.g.has(e)&&(r.i=null,r.h-=r.g.get(e).length,r.g.delete(e))}function Oj(r,e){return Q4(r),e=t5(r,e),r.g.has(e)}function Tj(r,e,t){Sj(r,e),0<t.length&&(r.i=null,r.g.set(t5(r,e),HA(t)),r.h+=t.length)}function t5(r,e){return e=String(e),r.j&&(e=e.toLowerCase()),e}(nt=n9.prototype).add=function(r,e){Q4(this),this.i=null,r=t5(this,r);var t=this.g.get(r);return t||this.g.set(r,t=[]),t.push(e),this.h+=1,this},nt.forEach=function(r,e){Q4(this),this.g.forEach(function(t,n){t.forEach(function(i){r.call(e,i,n,this)},this)},this)},nt.ta=function(){Q4(this);const r=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let n=0;n<e.length;n++){const i=r[n];for(let o=0;o<i.length;o++)t.push(e[n])}return t},nt.Z=function(r){Q4(this);let e=[];if("string"==typeof r)Oj(this,r)&&(e=e.concat(this.g.get(t5(this,r))));else{r=Array.from(this.g.values());for(let t=0;t<r.length;t++)e=e.concat(r[t])}return e},nt.set=function(r,e){return Q4(this),this.i=null,Oj(this,r=t5(this,r))&&(this.h-=this.g.get(r).length),this.g.set(r,[e]),this.h+=1,this},nt.get=function(r,e){return r&&0<(r=this.Z(r)).length?String(r[0]):e},nt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const r=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var n=e[t];const o=encodeURIComponent(String(n)),s=this.Z(n);for(n=0;n<s.length;n++){var i=o;""!==s[n]&&(i+="="+encodeURIComponent(String(s[n]))),r.push(i)}}return this.i=r.join("&")};var iOe=class{constructor(r,e){this.g=r,this.map=e}};function Aj(r){this.l=r||oOe,r=Jt.PerformanceNavigationTiming?0<(r=Jt.performance.getEntriesByType("navigation")).length&&("hq"==r[0].nextHopProtocol||"h2"==r[0].nextHopProtocol):!!(Jt.g&&Jt.g.Ka&&Jt.g.Ka()&&Jt.g.Ka().dc),this.j=r?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var oOe=10;function bj(r){return!!r.h||!!r.g&&r.g.size>=r.j}function wj(r){return r.h?1:r.g?r.g.size:0}function hb(r,e){return r.h?r.h==e:!!r.g&&r.g.has(e)}function gb(r,e){r.g?r.g.add(e):r.h=e}function Nj(r,e){r.h&&r.h==e?r.h=null:r.g&&r.g.has(e)&&r.g.delete(e)}function Ij(r){if(null!=r.h)return r.i.concat(r.h.F);if(null!=r.g&&0!==r.g.size){let e=r.i;for(const t of r.g.values())e=e.concat(t.F);return e}return HA(r.i)}Aj.prototype.cancel=function(){if(this.i=Ij(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const r of this.g.values())r.cancel();this.g.clear()}};var sOe=class{stringify(r){return Jt.JSON.stringify(r,void 0)}parse(r){return Jt.JSON.parse(r,void 0)}};function aOe(){this.g=new sOe}function cOe(r,e,t){const n=t||"";try{yj(r,function(i,o){let s=i;Uf(i)&&(s=nb(i)),e.push(n+o+"="+encodeURIComponent(s))})}catch(i){throw e.push(n+"type="+encodeURIComponent("_badmap")),i}}function $m(r,e,t,n,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(n)}catch{}}function r9(r){this.l=r.ec||null,this.j=r.ob||!1}function Gm(r,e){Hi.call(this),this.F=r,this.u=e,this.m=void 0,this.readyState=pb,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Vi(r9,sb),r9.prototype.g=function(){return new Gm(this.l,this.j)},r9.prototype.i=function(r){return function(){return r}}({}),Vi(Gm,Hi);var pb=0;function kj(r){r.j.read().then(r.Xa.bind(r)).catch(r.ka.bind(r))}function i9(r){r.readyState=4,r.l=null,r.j=null,r.A=null,o9(r)}function o9(r){r.onreadystatechange&&r.onreadystatechange.call(r)}(nt=Gm.prototype).open=function(r,e){if(this.readyState!=pb)throw this.abort(),Error("Error reopening a connection");this.C=r,this.B=e,this.readyState=1,o9(this)},nt.send=function(r){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};r&&(e.body=r),(this.F||Jt).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},nt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,i9(this)),this.readyState=pb},nt.$a=function(r){if(this.g&&(this.l=r,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=r.headers,this.readyState=2,o9(this)),this.g&&(this.readyState=3,o9(this),this.g)))if("arraybuffer"===this.responseType)r.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Jt.ReadableStream<"u"&&"body"in r){if(this.j=r.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;kj(this)}else r.text().then(this.Za.bind(this),this.ka.bind(this))},nt.Xa=function(r){if(this.g){if(this.u&&r.value)this.response.push(r.value);else if(!this.u){var e=r.value?r.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!r.done}))&&(this.response=this.responseText+=e)}r.done?i9(this):o9(this),3==this.readyState&&kj(this)}},nt.Za=function(r){this.g&&(this.response=this.responseText=r,i9(this))},nt.Ya=function(r){this.g&&(this.response=r,i9(this))},nt.ka=function(){this.g&&i9(this)},nt.setRequestHeader=function(r,e){this.v.append(r,e)},nt.getResponseHeader=function(r){return this.h&&this.h.get(r.toLowerCase())||""},nt.getAllResponseHeaders=function(){if(!this.h)return"";const r=[],e=this.h.entries();for(var t=e.next();!t.done;)r.push((t=t.value)[0]+": "+t[1]),t=e.next();return r.join("\r\n")},Object.defineProperty(Gm.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(r){this.m=r?"include":"same-origin"}});var uOe=Jt.JSON.parse;function Tr(r){Hi.call(this),this.headers=new Map,this.u=r||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Rj,this.L=this.M=!1}Vi(Tr,Hi);var Rj="",fOe=/^https?$/i,dOe=["POST","PUT"];function xj(r,e){r.h=!1,r.g&&(r.l=!0,r.g.abort(),r.l=!1),r.j=e,r.m=5,Lj(r),Bm(r)}function Lj(r){r.F||(r.F=!0,f2(r,"complete"),f2(r,"error"))}function zj(r){if(r.h&&typeof DA<"u"&&(!r.C[1]||4!=Rc(r)||2!=r.da()))if(r.v&&4==Rc(r))ob(r.La,0,r);else if(f2(r,"readystatechange"),4==Rc(r)){r.h=!1;try{const s=r.da();e:switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var n;if(n=0===s){var i=String(r.I).match(Mj)[1]||null;!i&&Jt.self&&Jt.self.location&&(i=Jt.self.location.protocol.slice(0,-1)),n=!fOe.test(i?i.toLowerCase():"")}t=n}if(t)f2(r,"complete"),f2(r,"success");else{r.m=6;try{var o=2<Rc(r)?r.g.statusText:""}catch{o=""}r.j=o+" ["+r.da()+"]",Lj(r)}}finally{Bm(r)}}}function Bm(r,e){if(r.g){Dj(r);const t=r.g,n=r.C[0]?()=>{}:null;r.g=null,r.C=null,e||f2(r,"ready");try{t.onreadystatechange=n}catch{}}}function Dj(r){r.g&&r.L&&(r.g.ontimeout=null),r.A&&(Jt.clearTimeout(r.A),r.A=null)}function Rc(r){return r.g?r.g.readyState:0}function Vj(r){try{if(!r.g)return null;if("response"in r.g)return r.g.response;switch(r.K){case Rj:case"text":return r.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in r.g)return r.g.mozResponseArrayBuffer}return null}catch{return null}}function Hj(r){let e="";return jA(r,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function mb(r,e,t){e:{for(n in t){var n=!1;break e}n=!0}n||(t=Hj(t),"string"==typeof r?null!=t&&encodeURIComponent(String(t)):J1(r,e,t))}function s9(r,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[r]||e}function Fj(r){this.Ga=0,this.j=[],this.l=new xm,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=s9("failFast",!1,r),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=s9("baseRetryDelayMs",5e3,r),this.hb=s9("retryDelaySeedMs",1e4,r),this.eb=s9("forwardChannelMaxRetries",2,r),this.xa=s9("forwardChannelRequestTimeoutMs",2e4,r),this.va=r&&r.xmlHttpFactory||void 0,this.Ha=r&&r.useFetchStreams||!1,this.L=void 0,this.J=r&&r.supportsCrossDomainXhr||!1,this.K="",this.i=new Aj(r&&r.concurrentRequestLimit),this.Ja=new aOe,this.P=r&&r.fastHandshake||!1,this.O=r&&r.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=r&&r.bc||!1,r&&r.Ea&&this.l.Ea(),r&&r.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&r&&r.detectBufferingProxy||!1,this.qa=void 0,r&&r.longPollingTimeout&&0<r.longPollingTimeout&&(this.qa=r.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function _b(r){if(Uj(r),3==r.H){var e=r.W++,t=U3(r.I);if(J1(t,"SID",r.K),J1(t,"RID",e),J1(t,"TYPE","terminate"),a9(r,t),(e=new Xf(r,r.l,e)).L=2,e.A=Um(U3(t)),t=!1,Jt.navigator&&Jt.navigator.sendBeacon)try{t=Jt.navigator.sendBeacon(e.A.toString(),"")}catch{}!t&&Jt.Image&&((new Image).src=e.A,t=!0),t||(e.g=Kj(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Qf(e)}Zj(r)}function Wm(r){r.g&&(vb(r),r.g.cancel(),r.g=null)}function Uj(r){Wm(r),r.u&&(Jt.clearTimeout(r.u),r.u=null),jm(r),r.i.cancel(),r.m&&("number"==typeof r.m&&Jt.clearTimeout(r.m),r.m=null)}function qm(r){if(!bj(r.i)&&!r.m){r.m=!0;var e=r.Na;Wf||nj(),qf||(Wf(),qf=!0),rb.add(e,r),r.C=0}}function $j(r,e){var t;t=e?e.m:r.W++;const n=U3(r.I);J1(n,"SID",r.K),J1(n,"RID",t),J1(n,"AID",r.V),a9(r,n),r.o&&r.s&&mb(n,r.o,r.s),t=new Xf(r,r.l,t,r.C+1),null===r.o&&(t.I=r.s),e&&(r.j=e.F.concat(r.j)),e=Gj(r,t,1e3),t.setTimeout(Math.round(.5*r.xa)+Math.round(.5*r.xa*Math.random())),gb(r.i,t),fb(t,n,e)}function a9(r,e){r.na&&jA(r.na,function(t,n){J1(e,n,t)}),r.h&&yj({},function(t,n){J1(e,n,t)})}function Gj(r,e,t){t=Math.min(r.j.length,t);var n=r.h?U2(r.h.Va,r.h,r):null;e:{var i=r.j;let o=-1;for(;;){const s=["count="+t];-1==o?0<t?(o=i[0].g,s.push("ofs="+o)):o=0:s.push("ofs="+o);let a=!0;for(let c=0;c<t;c++){let l=i[c].g;const u=i[c].map;if(l-=o,0>l)o=Math.max(0,i[c].g-100),a=!1;else try{cOe(u,s,"req"+l+"_")}catch{n&&n(u)}}if(a){n=s.join("&");break e}}}return r=r.j.splice(0,t),e.F=r,n}function Bj(r){if(!r.g&&!r.u){r.ba=1;var e=r.Ma;Wf||nj(),qf||(Wf(),qf=!0),rb.add(e,r),r.A=0}}function Cb(r){return!(r.g||r.u||3<=r.A||(r.ba++,r.u=Yf(U2(r.Ma,r),jj(r,r.A)),r.A++,0))}function vb(r){null!=r.B&&(Jt.clearTimeout(r.B),r.B=null)}function Wj(r){r.g=new Xf(r,r.l,"rpc",r.ba),null===r.o&&(r.g.I=r.s),r.g.O=0;var e=U3(r.wa);J1(e,"RID","rpc"),J1(e,"SID",r.K),J1(e,"AID",r.V),J1(e,"CI",r.G?"0":"1"),!r.G&&r.qa&&J1(e,"TO",r.qa),J1(e,"TYPE","xmlhttp"),a9(r,e),r.o&&r.s&&mb(e,r.o,r.s),r.L&&r.g.setTimeout(r.L);var t=r.g;r=r.pa,t.L=1,t.A=Um(U3(e)),t.u=null,t.S=!0,mj(t,r)}function jm(r){null!=r.v&&(Jt.clearTimeout(r.v),r.v=null)}function qj(r,e){var t=null;if(r.g==e){jm(r),vb(r),r.g=null;var n=2}else{if(!hb(r.i,e))return;t=e.F,Nj(r.i,e),n=1}if(0!=r.H)if(e.i)if(1==n){t=e.u?e.u.length:0,e=Date.now()-e.G;var i=r.C;f2(n=Lm(),new uj(n,t)),qm(r)}else Bj(r);else if(3==(i=e.s)||0==i&&0<e.ca||!(1==n&&function pOe(r,e){return!(wj(r.i)>=r.i.j-(r.m?1:0)||(r.m?(r.j=e.F.concat(r.j),0):1==r.H||2==r.H||r.C>=(r.cb?0:r.eb)||(r.m=Yf(U2(r.Na,r,e),jj(r,r.C)),r.C++,0)))}(r,e)||2==n&&Cb(r)))switch(t&&0<t.length&&(e=r.i,e.i=e.i.concat(t)),i){case 1:I6(r,5);break;case 4:I6(r,10);break;case 3:I6(r,6);break;default:I6(r,2)}}function jj(r,e){let t=r.ab+Math.floor(Math.random()*r.hb);return r.isActive()||(t*=2),t*e}function I6(r,e){if(r.l.info("Error code "+e),2==e){var t=null;r.h&&(t=null);var n=U2(r.pb,r);t||(t=new N6("//www.google.com/images/cleardot.gif"),Jt.location&&"http"==Jt.location.protocol||Hm(t,"https"),Um(t)),function lOe(r,e){const t=new xm;if(Jt.Image){const n=new Image;n.onload=bm($m,t,n,"TestLoadImage: loaded",!0,e),n.onerror=bm($m,t,n,"TestLoadImage: error",!1,e),n.onabort=bm($m,t,n,"TestLoadImage: abort",!1,e),n.ontimeout=bm($m,t,n,"TestLoadImage: timeout",!1,e),Jt.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=r}else e(!1)}(t.toString(),n)}else fo(2);r.H=0,r.h&&r.h.za(e),Zj(r),Uj(r)}function Zj(r){if(r.H=0,r.ma=[],r.h){const e=Ij(r.i);(0!=e.length||0!=r.j.length)&&($q(r.ma,e),$q(r.ma,r.j),r.i.i.length=0,HA(r.j),r.j.length=0),r.h.ya()}}function Yj(r,e,t){var n=t instanceof N6?U3(t):new N6(t);if(""!=n.g)e&&(n.g=e+"."+n.g),Fm(n,n.m);else{var i=Jt.location;n=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var o=new N6(null);n&&Hm(o,n),e&&(o.g=e),i&&Fm(o,i),t&&(o.l=t),n=o}return e=r.Da,(t=r.F)&&e&&J1(n,t,e),J1(n,"VER",r.ra),a9(r,n),n}function Kj(r,e,t){if(e&&!r.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Tr(r.Ha&&!r.va?new r9({ob:t}):r.va)).Oa(r.J),e}function Xj(){}function Zm(){if(J8&&!(10<=Number(bSe)))throw Error("Environmental error: no available transport.")}function us(r,e){Hi.call(this),this.g=new Fj(e),this.l=r,this.h=e&&e.messageUrlParams||null,r=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(r?r["X-Client-Protocol"]="webchannel":r={"X-Client-Protocol":"webchannel"}),this.g.s=r,r=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(r?r["X-WebChannel-Content-Type"]=e.messageContentType:r={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(r?r["X-WebChannel-Client-Profile"]=e.Ca:r={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=r,(r=e&&e.cc)&&!$f(r)&&(this.g.o=r),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!$f(e)&&(this.g.F=e,null!==(r=this.h)&&e in r&&e in(r=this.h)&&delete r[e]),this.j=new n5(this)}function Qj(r){ab.call(this),r.__headers__&&(this.headers=r.__headers__,this.statusCode=r.__status__,delete r.__headers__,delete r.__status__);var e=r.__sm__;if(e){e:{for(const t in e){r=t;break e}r=void 0}(this.i=r)&&(r=this.i,e=null!==e&&r in e?e[r]:void 0),this.data=e}else this.data=r}function Jj(){cb.call(this),this.status=1}function n5(r){this.g=r}function xa(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function yb(r,e,t){t||(t=0);var n=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)n[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)n[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var o=r.g[3],s=(e=r.g[0])+(o^(t=r.g[1])&((i=r.g[2])^o))+n[0]+3614090360&4294967295;s=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=t+(s<<7&4294967295|s>>>25))+((s=o+(i^e&(t^i))+n[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=i+(t^o&(e^t))+n[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=t+(e^i&(o^e))+n[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=e+(o^t&(i^o))+n[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^e&(t^i))+n[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=i+(t^o&(e^t))+n[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=t+(e^i&(o^e))+n[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=e+(o^t&(i^o))+n[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^e&(t^i))+n[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=i+(t^o&(e^t))+n[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=t+(e^i&(o^e))+n[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=e+(o^t&(i^o))+n[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^e&(t^i))+n[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=i+(t^o&(e^t))+n[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=t+(e^i&(o^e))+n[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=e+(i^o&(t^i))+n[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=o+(t^i&(e^t))+n[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=i+(e^t&(o^e))+n[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=t+(o^e&(i^o))+n[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=e+(i^o&(t^i))+n[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=o+(t^i&(e^t))+n[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=i+(e^t&(o^e))+n[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=t+(o^e&(i^o))+n[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=e+(i^o&(t^i))+n[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=o+(t^i&(e^t))+n[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=i+(e^t&(o^e))+n[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=t+(o^e&(i^o))+n[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=e+(i^o&(t^i))+n[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=o+(t^i&(e^t))+n[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=i+(e^t&(o^e))+n[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=t+(o^e&(i^o))+n[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=e+(t^i^o)+n[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=o+(e^t^i)+n[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^e^t)+n[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=t+(i^o^e)+n[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=e+(t^i^o)+n[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=o+(e^t^i)+n[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^e^t)+n[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=t+(i^o^e)+n[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=e+(t^i^o)+n[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=o+(e^t^i)+n[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^e^t)+n[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=t+(i^o^e)+n[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=e+(t^i^o)+n[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=o+(e^t^i)+n[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^e^t)+n[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=t+(i^o^e)+n[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=e+(i^(t|~o))+n[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=o+(t^(e|~i))+n[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=i+(e^(o|~t))+n[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=t+(o^(i|~e))+n[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=e+(i^(t|~o))+n[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=o+(t^(e|~i))+n[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=i+(e^(o|~t))+n[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=t+(o^(i|~e))+n[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=e+(i^(t|~o))+n[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=o+(t^(e|~i))+n[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=i+(e^(o|~t))+n[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=t+(o^(i|~e))+n[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((o=(e=t+((s=e+(i^(t|~o))+n[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=o+(t^(e|~i))+n[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((i=o+((s=i+(e^(o|~t))+n[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~e))+n[9]+3951481745&4294967295,r.g[0]=r.g[0]+e&4294967295,r.g[1]=r.g[1]+(i+(s<<21&4294967295|s>>>11))&4294967295,r.g[2]=r.g[2]+i&4294967295,r.g[3]=r.g[3]+o&4294967295}function u1(r,e){this.h=e;for(var t=[],n=!0,i=r.length-1;0<=i;i--){var o=0|r[i];n&&o==e||(t[i]=o,n=!1)}this.g=t}(nt=Tr.prototype).Oa=function(r){this.M=r},nt.ha=function(r,e,t,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+r);e=e?e.toUpperCase():"GET",this.I=r,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():lb.g(),this.C=function dj(r){return r.h||(r.h=r.i())}(this.u?this.u:lb),this.g.onreadystatechange=U2(this.La,this);try{this.G=!0,this.g.open(e,String(r),!0),this.G=!1}catch(o){return void xj(this,o)}if(r=t||"",t=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var i in n)t.set(i,n[i]);else{if("function"!=typeof n.keys||"function"!=typeof n.get)throw Error("Unknown input type for opt_headers: "+String(n));for(const o of n.keys())t.set(o,n.get(o))}n=Array.from(t.keys()).find(o=>"content-type"==o.toLowerCase()),i=Jt.FormData&&r instanceof Jt.FormData,!(0<=Uq(dOe,e))||n||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[o,s]of t)this.g.setRequestHeader(o,s);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Dj(this),0<this.B&&((this.L=function hOe(r){return J8&&"number"==typeof r.timeout&&void 0!==r.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=U2(this.ua,this)):this.A=ob(this.ua,this.B,this)),this.v=!0,this.g.send(r),this.v=!1}catch(o){xj(this,o)}},nt.ua=function(){typeof DA<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,f2(this,"timeout"),this.abort(8))},nt.abort=function(r){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=r||7,f2(this,"complete"),f2(this,"abort"),Bm(this))},nt.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Bm(this,!0)),Tr.$.N.call(this)},nt.La=function(){this.s||(this.G||this.v||this.l?zj(this):this.kb())},nt.kb=function(){zj(this)},nt.isActive=function(){return!!this.g},nt.da=function(){try{return 2<Rc(this)?this.g.status:-1}catch{return-1}},nt.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},nt.Wa=function(r){if(this.g){var e=this.g.responseText;return r&&0==e.indexOf(r)&&(e=e.substring(r.length)),uOe(e)}},nt.Ia=function(){return this.m},nt.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(nt=Fj.prototype).ra=8,nt.H=1,nt.Na=function(r){if(this.m)if(this.m=null,1==this.H){if(!r){this.W=Math.floor(1e5*Math.random()),r=this.W++;const i=new Xf(this,this.l,r);let o=this.s;if(this.U&&(o?(o=jq(o),Yq(o,this.U)):o=this.U),null!==this.o||this.O||(i.I=o,o=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){var n=this.j[t];if(void 0===(n="__data__"in n.map&&"string"==typeof(n=n.map.__data__)?n.length:void 0))break;if(4096<(e+=n)){e=t;break e}if(4096===e||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=Gj(this,i,e),J1(t=U3(this.I),"RID",r),J1(t,"CVER",22),this.F&&J1(t,"X-HTTP-Session-Id",this.F),a9(this,t),o&&(this.O?e="headers="+encodeURIComponent(String(Hj(o)))+"&"+e:this.o&&mb(t,this.o,o)),gb(this.i,i),this.bb&&J1(t,"TYPE","init"),this.P?(J1(t,"$req",e),J1(t,"SID","null"),i.aa=!0,fb(i,t,null)):fb(i,t,e),this.H=2}}else 3==this.H&&(r?$j(this,r):0==this.j.length||bj(this.i)||$j(this))},nt.Ma=function(){if(this.u=null,Wj(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var r=2*this.S;this.l.info("BP detection timer enabled: "+r),this.B=Yf(U2(this.jb,this),r)}},nt.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,fo(10),Wm(this),Wj(this))},nt.ib=function(){null!=this.v&&(this.v=null,Wm(this),Cb(this),fo(19))},nt.pb=function(r){r?(this.l.info("Successfully pinged google.com"),fo(2)):(this.l.info("Failed to ping google.com"),fo(1))},nt.isActive=function(){return!!this.h&&this.h.isActive(this)},(nt=Xj.prototype).Ba=function(){},nt.Aa=function(){},nt.za=function(){},nt.ya=function(){},nt.isActive=function(){return!0},nt.Va=function(){},Zm.prototype.g=function(r,e){return new us(r,e)},Vi(us,Hi),us.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var r=this.g,e=this.l,t=this.h||void 0;fo(0),r.Y=e,r.na=t||{},r.G=r.aa,r.I=Yj(r,null,r.Y),qm(r)},us.prototype.close=function(){_b(this.g)},us.prototype.u=function(r){var e=this.g;if("string"==typeof r){var t={};t.__data__=r,r=t}else this.v&&((t={}).__data__=nb(r),r=t);e.j.push(new iOe(e.fb++,r)),3==e.H&&qm(e)},us.prototype.N=function(){this.g.h=null,delete this.j,_b(this.g),delete this.g,us.$.N.call(this)},Vi(Qj,ab),Vi(Jj,cb),Vi(n5,Xj),n5.prototype.Ba=function(){f2(this.g,"a")},n5.prototype.Aa=function(r){f2(this.g,new Qj(r))},n5.prototype.za=function(r){f2(this.g,new Jj)},n5.prototype.ya=function(){f2(this.g,"b")},Vi(xa,function mOe(){this.blockSize=-1}),xa.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},xa.prototype.j=function(r,e){void 0===e&&(e=r.length);for(var t=e-this.blockSize,n=this.m,i=this.h,o=0;o<e;){if(0==i)for(;o<=t;)yb(this,r,o),o+=this.blockSize;if("string"==typeof r){for(;o<e;)if(n[i++]=r.charCodeAt(o++),i==this.blockSize){yb(this,n),i=0;break}}else for(;o<e;)if(n[i++]=r[o++],i==this.blockSize){yb(this,n),i=0;break}}this.h=i,this.i+=e},xa.prototype.l=function(){var r=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);r[0]=128;for(var e=1;e<r.length-8;++e)r[e]=0;var t=8*this.i;for(e=r.length-8;e<r.length;++e)r[e]=255&t,t/=256;for(this.j(r),r=Array(16),e=t=0;4>e;++e)for(var n=0;32>n;n+=8)r[t++]=this.g[e]>>>n&255;return r};var _Oe={};function Mb(r){return-128<=r&&128>r?function OSe(r,e){var t=_Oe;return Object.prototype.hasOwnProperty.call(t,r)?t[r]:t[r]=e(r)}(r,function(e){return new u1([0|e],0>e?-1:0)}):new u1([0|r],0>r?-1:0)}function xc(r){if(isNaN(r)||!isFinite(r))return r5;if(0>r)return d2(xc(-r));for(var e=[],t=1,n=0;r>=t;n++)e[n]=r/t|0,t*=Eb;return new u1(e,0)}var Eb=4294967296,r5=Mb(0),Pb=Mb(1),tZ=Mb(16777216);function $3(r){if(0!=r.h)return!1;for(var e=0;e<r.g.length;e++)if(0!=r.g[e])return!1;return!0}function Ws(r){return-1==r.h}function d2(r){for(var e=r.g.length,t=[],n=0;n<e;n++)t[n]=~r.g[n];return new u1(t,~r.h).add(Pb)}function Ym(r,e){return r.add(d2(e))}function Km(r,e){for(;(65535&r[e])!=r[e];)r[e+1]+=r[e]>>>16,r[e]&=65535,e++}function c9(r,e){this.g=r,this.h=e}function Xm(r,e){if($3(e))throw Error("division by zero");if($3(r))return new c9(r5,r5);if(Ws(r))return e=Xm(d2(r),e),new c9(d2(e.g),d2(e.h));if(Ws(e))return e=Xm(r,d2(e)),new c9(d2(e.g),e.h);if(30<r.g.length){if(Ws(r)||Ws(e))throw Error("slowDivide_ only works with positive integers.");for(var t=Pb,n=e;0>=n.X(r);)t=nZ(t),n=nZ(n);var i=i5(t,1),o=i5(n,1);for(n=i5(n,2),t=i5(t,2);!$3(n);){var s=o.add(n);0>=s.X(r)&&(i=i.add(t),o=s),n=i5(n,1),t=i5(t,1)}return e=Ym(r,i.R(e)),new c9(i,e)}for(i=r5;0<=r.X(e);){for(t=Math.max(1,Math.floor(r.ea()/e.ea())),n=48>=(n=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,n-48),s=(o=xc(t)).R(e);Ws(s)||0<s.X(r);)s=(o=xc(t-=n)).R(e);$3(o)&&(o=Pb),i=i.add(o),r=Ym(r,s)}return new c9(i,r)}function nZ(r){for(var e=r.g.length+1,t=[],n=0;n<e;n++)t[n]=r.D(n)<<1|r.D(n-1)>>>31;return new u1(t,r.h)}function i5(r,e){var t=e>>5;e%=32;for(var n=r.g.length-t,i=[],o=0;o<n;o++)i[o]=0<e?r.D(o+t)>>>e|r.D(o+t+1)<<32-e:r.D(o+t);return new u1(i,r.h)}(nt=u1.prototype).ea=function(){if(Ws(this))return-d2(this).ea();for(var r=0,e=1,t=0;t<this.g.length;t++){var n=this.D(t);r+=(0<=n?n:Eb+n)*e,e*=Eb}return r},nt.toString=function(r){if(2>(r=r||10)||36<r)throw Error("radix out of range: "+r);if($3(this))return"0";if(Ws(this))return"-"+d2(this).toString(r);for(var e=xc(Math.pow(r,6)),t=this,n="";;){var i=Xm(t,e).g,o=((0<(t=Ym(t,i.R(e))).g.length?t.g[0]:t.h)>>>0).toString(r);if($3(t=i))return o+n;for(;6>o.length;)o="0"+o;n=o+n}},nt.D=function(r){return 0>r?0:r<this.g.length?this.g[r]:this.h},nt.X=function(r){return Ws(r=Ym(this,r))?-1:$3(r)?0:1},nt.abs=function(){return Ws(this)?d2(this):this},nt.add=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0,i=0;i<=e;i++){var o=n+(65535&this.D(i))+(65535&r.D(i)),s=(o>>>16)+(this.D(i)>>>16)+(r.D(i)>>>16);n=s>>>16,t[i]=(s&=65535)<<16|(o&=65535)}return new u1(t,-2147483648&t[t.length-1]?-1:0)},nt.R=function(r){if($3(this)||$3(r))return r5;if(Ws(this))return Ws(r)?d2(this).R(d2(r)):d2(d2(this).R(r));if(Ws(r))return d2(this.R(d2(r)));if(0>this.X(tZ)&&0>r.X(tZ))return xc(this.ea()*r.ea());for(var e=this.g.length+r.g.length,t=[],n=0;n<2*e;n++)t[n]=0;for(n=0;n<this.g.length;n++)for(var i=0;i<r.g.length;i++){var o=this.D(n)>>>16,s=65535&this.D(n),a=r.D(i)>>>16,c=65535&r.D(i);t[2*n+2*i]+=s*c,Km(t,2*n+2*i),t[2*n+2*i+1]+=o*c,Km(t,2*n+2*i+1),t[2*n+2*i+1]+=s*a,Km(t,2*n+2*i+1),t[2*n+2*i+2]+=o*a,Km(t,2*n+2*i+2)}for(n=0;n<e;n++)t[n]=t[2*n+1]<<16|t[2*n];for(n=e;n<2*e;n++)t[n]=0;return new u1(t,0)},nt.gb=function(r){return Xm(this,r).h},nt.and=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)&r.D(n);return new u1(t,this.h&r.h)},nt.or=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)|r.D(n);return new u1(t,this.h|r.h)},nt.xor=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)^r.D(n);return new u1(t,this.h^r.h)},Zm.prototype.createWebChannel=Zm.prototype.g,us.prototype.send=us.prototype.u,us.prototype.open=us.prototype.m,us.prototype.close=us.prototype.close,zm.NO_ERROR=0,zm.TIMEOUT=8,zm.HTTP_ERROR=6,fj.COMPLETE="complete",hj.EventType=Kf,Kf.OPEN="a",Kf.CLOSE="b",Kf.ERROR="c",Kf.MESSAGE="d",Hi.prototype.listen=Hi.prototype.O,Tr.prototype.listenOnce=Tr.prototype.P,Tr.prototype.getLastError=Tr.prototype.Sa,Tr.prototype.getLastErrorCode=Tr.prototype.Ia,Tr.prototype.getStatus=Tr.prototype.da,Tr.prototype.getResponseJson=Tr.prototype.Wa,Tr.prototype.getResponseText=Tr.prototype.ja,Tr.prototype.send=Tr.prototype.ha,Tr.prototype.setWithCredentials=Tr.prototype.Oa,xa.prototype.digest=xa.prototype.l,xa.prototype.reset=xa.prototype.reset,xa.prototype.update=xa.prototype.j,u1.prototype.add=u1.prototype.add,u1.prototype.multiply=u1.prototype.R,u1.prototype.modulo=u1.prototype.gb,u1.prototype.compare=u1.prototype.X,u1.prototype.toNumber=u1.prototype.ea,u1.prototype.toString=u1.prototype.toString,u1.prototype.getBits=u1.prototype.D,u1.fromNumber=xc,u1.fromString=function eZ(r,e){if(0==r.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==r.charAt(0))return d2(eZ(r.substring(1),e));if(0<=r.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=xc(Math.pow(e,8)),n=r5,i=0;i<r.length;i+=8){var o=Math.min(8,r.length-i),s=parseInt(r.substring(i,i+o),e);8>o?(o=xc(Math.pow(e,o)),n=n.R(o).add(xc(s))):n=(n=n.R(t)).add(xc(s))}return n};var COe=Ra.createWebChannelTransport=function(){return new Zm},vOe=Ra.getStatEventTarget=function(){return Lm()},Sb=Ra.ErrorCode=zm,yOe=Ra.EventType=fj,MOe=Ra.Event=b6,rZ=Ra.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Qm=(Ra.FetchXmlHttpFactory=r9,Ra.WebChannel=hj),EOe=Ra.XhrIo=Tr,POe=Ra.Md5=xa,o5=Ra.Integer=u1;const iZ="@firebase/firestore";class Fi{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Fi.UNAUTHENTICATED=new Fi(null),Fi.GOOGLE_CREDENTIALS=new Fi("google-credentials-uid"),Fi.FIRST_PARTY=new Fi("first-party-uid"),Fi.MOCK_USER=new Fi("mock-user");let s5="10.7.0";const J4=new lO("@firebase/firestore");function a5(){return J4.logLevel}function Pe(r,...e){if(J4.logLevel<=Fn.DEBUG){const t=e.map(Ob);J4.debug(`Firestore (${s5}): ${r}`,...t)}}function $r(r,...e){if(J4.logLevel<=Fn.ERROR){const t=e.map(Ob);J4.error(`Firestore (${s5}): ${r}`,...t)}}function fs(r,...e){if(J4.logLevel<=Fn.WARN){const t=e.map(Ob);J4.warn(`Firestore (${s5}): ${r}`,...t)}}function Ob(r){if("string"==typeof r)return r;try{return JSON.stringify(r)}catch{return r}}function ft(r="Unexpected state"){const e=`FIRESTORE (${s5}) INTERNAL ASSERTION FAILED: `+r;throw $r(e),new Error(e)}function gt(r,e){r||ft()}function je(r,e){return r}const ue={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Oe extends Nc{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ei{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class oZ{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class SOe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Fi.UNAUTHENTICATED))}shutdown(){}}class OOe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class TOe{constructor(e){this.t=e,this.currentUser=Fi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var n=this;let i=this.i;const o=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve();let s=new Ei;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ei,e.enqueueRetryable(()=>o(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(E(function*(){yield l.promise,yield o(n.currentUser)}))},c=l=>{Pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):(Pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ei)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(Pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(gt("string"==typeof n.accessToken),new oZ(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return gt(null===e||"string"==typeof e),new Fi(e)}}class AOe{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Fi.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class bOe{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new AOe(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Fi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class sZ{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class wOe{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const n=o=>{null!=o.error&&Pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const s=o.token!==this.R;return this.R=o.token,Pe("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{Pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?i(o):Pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(gt("string"==typeof t.token),this.R=t.token,new sZ(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function NOe(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}class aZ{static newId(){const t=62*Math.floor(256/62);let n="";for(;n.length<20;){const i=NOe(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<t&&(n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[o]%62))}return n}}function Yt(r,e){return r<e?-1:r>e?1:0}function c5(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}class _r{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Oe(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Oe(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Oe(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Oe(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return _r.fromMillis(Date.now())}static fromDate(e){return _r.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new _r(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Yt(this.nanoseconds,e.nanoseconds):Yt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class vt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new vt(e)}static min(){return new vt(new _r(0,0))}static max(){return new vt(new _r(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class l9{constructor(e,t,n){void 0===t?t=0:t>e.length&&ft(),void 0===n?n=e.length-t:n>e.length-t&&ft(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===l9.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof l9?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const o=e.get(i),s=t.get(i);if(o<s)return-1;if(o>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class $n extends l9{construct(e,t,n){return new $n(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Oe(ue.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new $n(t)}static emptyPath(){return new $n([])}}const IOe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class fr extends l9{construct(e,t,n){return new fr(e,t,n)}static isValidIdentifier(e){return IOe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),fr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new fr(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const o=()=>{if(0===n.length)throw new Oe(ue.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;i<e.length;){const a=e[i];if("\\"===a){if(i+1===e.length)throw new Oe(ue.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if("\\"!==c&&"."!==c&&"`"!==c)throw new Oe(ue.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(n+=a,i++):(o(),i++)}if(o(),s)throw new Oe(ue.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new fr(t)}static emptyPath(){return new fr([])}}class Ye{constructor(e){this.path=e}static fromPath(e){return new Ye($n.fromString(e))}static fromName(e){return new Ye($n.fromString(e).popFirst(5))}static empty(){return new Ye($n.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===$n.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return $n.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ye(new $n(e.slice()))}}function uZ(r){return new ds(r.readTime,r.key,-1)}class ds{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new ds(vt.min(),Ye.empty(),-1)}static max(){return new ds(vt.max(),Ye.empty(),-1)}}function Ab(r,e){let t=r.readTime.compareTo(e.readTime);return 0!==t?t:(t=Ye.comparator(r.documentKey,e.documentKey),0!==t?t:Yt(r.largestBatchId,e.largestBatchId))}const fZ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class xOe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function el(r){return bb.apply(this,arguments)}function bb(){return bb=E(function*(r){if(r.code!==ue.FAILED_PRECONDITION||r.message!==fZ)throw r;Pe("LocalStore","Unexpectedly lost primary lease")}),bb.apply(this,arguments)}class se{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ft(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new se((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof se?t:se.resolve(t)}catch(t){return se.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):se.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):se.reject(t)}static resolve(e){return new se((t,n)=>{t(e)})}static reject(e){return new se((t,n)=>{n(e)})}static waitFor(e){return new se((t,n)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},c=>n(c))}),s=!0,o===i&&t()})}static or(e){let t=se.resolve(!1);for(const n of e)t=t.next(i=>i?se.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,o)=>{n.push(t.call(this,i,o))}),this.waitFor(n)}static mapArray(e,t){return new se((n,i)=>{const o=e.length,s=new Array(o);let a=0;for(let c=0;c<o;c++){const l=c;t(e[l]).next(u=>{s[l]=u,++a,a===o&&n(s)},u=>i(u))}})}static doWhile(e,t){return new se((n,i)=>{const o=()=>{!0===e()?t().next(()=>{o()},i):n()};o()})}}function tl(r){return"IndexedDbTransactionError"===r.name}let hs=(()=>{class r{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.se(i),this.oe=i=>n.writeSequenceNumber(i))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}return r._e=-1,r})();function f9(r){return null==r}function d9(r){return 0===r&&1/r==-1/0}function yZ(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function nl(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function MZ(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}class H1{constructor(e,t){this.comparator=e,this.root=t||h2.EMPTY}insert(e,t){return new H1(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,h2.BLACK,null,null))}remove(e){return new H1(this.comparator,this.root.remove(e,this.comparator).copy(null,null,h2.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new t_(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new t_(this.root,e,this.comparator,!1)}getReverseIterator(){return new t_(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new t_(this.root,e,this.comparator,!0)}}class t_{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?n(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(0===o){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class h2{constructor(e,t,n,i,o){this.key=e,this.value=t,this.color=n??h2.RED,this.left=i??h2.EMPTY,this.right=o??h2.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,o){return new h2(e??this.key,t??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===o?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return h2.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return h2.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,h2.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,h2.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ft();const e=this.left.check();if(e!==this.right.check())throw ft();return e+(this.isRed()?0:1)}}h2.EMPTY=null,h2.RED=!0,h2.BLACK=!1,h2.EMPTY=new class{constructor(){this.size=0}get key(){throw ft()}get value(){throw ft()}get color(){throw ft()}get left(){throw ft()}get right(){throw ft()}copy(e,t,n,i,o){return this}insert(e,t,n){return new h2(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class v1{constructor(e){this.comparator=e,this.data=new H1(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new EZ(this.data.getIterator())}getIteratorFrom(e){return new EZ(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof v1)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=n.getNext().key;if(0!==this.comparator(i,o))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new v1(this.comparator);return t.data=e,t}}class EZ{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class xo{constructor(e){this.fields=e,e.sort(fr.comparator)}static empty(){return new xo([])}unionWith(e){let t=new v1(fr.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new xo(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return c5(this.fields,e.fields,(t,n)=>t.isEqual(n))}}class PZ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Pi{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new PZ("Invalid base64 string: "+o):o}}(e);return new Pi(t)}static fromUint8Array(e){const t=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new Pi(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Yt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Pi.EMPTY_BYTE_STRING=new Pi("");const rTe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function rl(r){if(gt(!!r),"string"==typeof r){let e=0;const t=rTe.exec(r);if(gt(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Ar(r.seconds),nanos:Ar(r.nanos)}}function Ar(r){return"number"==typeof r?r:"string"==typeof r?Number(r):0}function G3(r){return"string"==typeof r?Pi.fromBase64String(r):Pi.fromUint8Array(r)}function n_(r){var e,t;return"server_timestamp"===(null===(t=((null===(e=r?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function r_(r){const e=r.mapValue.fields.__previous_value__;return n_(e)?r_(e):e}function h9(r){const e=rl(r.mapValue.fields.__local_write_time__.timestampValue);return new _r(e.seconds,e.nanos)}class iTe{constructor(e,t,n,i,o,s,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}}class L6{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new L6("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof L6&&e.projectId===this.projectId&&e.database===this.database}}const il={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function ol(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?n_(r)?4:AZ(r)?9007199254740991:10:ft()}function zc(r,e){if(r===e)return!0;const t=ol(r);if(t!==ol(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return h9(r).isEqual(h9(e));case 3:return function(i,o){if("string"==typeof i.timestampValue&&"string"==typeof o.timestampValue&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const s=rl(i.timestampValue),a=rl(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return o=e,G3(r.bytesValue).isEqual(G3(o.bytesValue));case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,o){return Ar(i.geoPointValue.latitude)===Ar(o.geoPointValue.latitude)&&Ar(i.geoPointValue.longitude)===Ar(o.geoPointValue.longitude)}(r,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Ar(i.integerValue)===Ar(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const s=Ar(i.doubleValue),a=Ar(o.doubleValue);return s===a?d9(s)===d9(a):isNaN(s)&&isNaN(a)}return!1}(r,e);case 9:return c5(r.arrayValue.values||[],e.arrayValue.values||[],zc);case 10:return function(i,o){const s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(yZ(s)!==yZ(a))return!1;for(const c in s)if(s.hasOwnProperty(c)&&(void 0===a[c]||!zc(s[c],a[c])))return!1;return!0}(r,e);default:return ft()}var o}function g9(r,e){return void 0!==(r.values||[]).find(t=>zc(t,e))}function sl(r,e){if(r===e)return 0;const t=ol(r),n=ol(e);if(t!==n)return Yt(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Yt(r.booleanValue,e.booleanValue);case 2:return function(o,s){const a=Ar(o.integerValue||o.doubleValue),c=Ar(s.integerValue||s.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(r,e);case 3:return SZ(r.timestampValue,e.timestampValue);case 4:return SZ(h9(r),h9(e));case 5:return Yt(r.stringValue,e.stringValue);case 6:return function(o,s){const a=G3(o),c=G3(s);return a.compareTo(c)}(r.bytesValue,e.bytesValue);case 7:return function(o,s){const a=o.split("/"),c=s.split("/");for(let l=0;l<a.length&&l<c.length;l++){const u=Yt(a[l],c[l]);if(0!==u)return u}return Yt(a.length,c.length)}(r.referenceValue,e.referenceValue);case 8:return function(o,s){const a=Yt(Ar(o.latitude),Ar(s.latitude));return 0!==a?a:Yt(Ar(o.longitude),Ar(s.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return function(o,s){const a=o.values||[],c=s.values||[];for(let l=0;l<a.length&&l<c.length;++l){const u=sl(a[l],c[l]);if(u)return u}return Yt(a.length,c.length)}(r.arrayValue,e.arrayValue);case 10:return function(o,s){if(o===il.mapValue&&s===il.mapValue)return 0;if(o===il.mapValue)return 1;if(s===il.mapValue)return-1;const a=o.fields||{},c=Object.keys(a),l=s.fields||{},u=Object.keys(l);c.sort(),u.sort();for(let f=0;f<c.length&&f<u.length;++f){const g=Yt(c[f],u[f]);if(0!==g)return g;const y=sl(a[c[f]],l[u[f]]);if(0!==y)return y}return Yt(c.length,u.length)}(r.mapValue,e.mapValue);default:throw ft()}}function SZ(r,e){if("string"==typeof r&&"string"==typeof e&&r.length===e.length)return Yt(r,e);const t=rl(r),n=rl(e),i=Yt(t.seconds,n.seconds);return 0!==i?i:Yt(t.nanos,n.nanos)}function d5(r){return Ib(r)}function Ib(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=rl(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?G3(r.bytesValue).toBase64():"referenceValue"in r?Ye.fromName(r.referenceValue).toString():"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(const o of t.values||[])i?i=!1:n+=",",n+=Ib(o);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let i="{",o=!0;for(const s of n)o?o=!1:i+=",",i+=`${s}:${Ib(t.fields[s])}`;return i+"}"}(r.mapValue):ft()}function z6(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function kb(r){return!!r&&"integerValue"in r}function p9(r){return!!r&&"arrayValue"in r}function OZ(r){return!!r&&"nullValue"in r}function TZ(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function s_(r){return!!r&&"mapValue"in r}function m9(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&"object"==typeof r.timestampValue)return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return nl(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=m9(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=m9(r.arrayValue.values[t]);return e}return Object.assign({},r)}function AZ(r){return"__max__"===(((r.mapValue||{}).fields||{}).__type__||{}).stringValue}class g2{constructor(e){this.value=e}static empty(){return new g2({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!s_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=m9(t)}setAll(e){let t=fr.emptyPath(),n={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,n,i),n={},i=[],t=a.popLast()}s?n[a.lastSegment()]=m9(s):i.push(a.lastSegment())});const o=this.getFieldsMap(t);this.applyChanges(o,n,i)}delete(e){const t=this.field(e.popLast());s_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return zc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];s_(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){nl(t,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new g2(m9(this.value))}}function NZ(r){const e=[];return nl(r.fields,(t,n)=>{const i=new fr([t]);if(s_(n)){const o=NZ(n.mapValue).fields;if(0===o.length)e.push(i);else for(const s of o)e.push(i.child(s))}else e.push(i)}),new xo(e)}class er{constructor(e,t,n,i,o,s,a){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new er(e,0,vt.min(),vt.min(),vt.min(),g2.empty(),0)}static newFoundDocument(e,t,n,i){return new er(e,1,t,vt.min(),n,i,0)}static newNoDocument(e,t){return new er(e,2,t,vt.min(),vt.min(),g2.empty(),0)}static newUnknownDocument(e,t){return new er(e,3,t,vt.min(),vt.min(),g2.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(vt.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=g2.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=g2.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=vt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof er&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new er(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class al{constructor(e,t){this.position=e,this.inclusive=t}}function IZ(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const o=e[i],s=r.position[i];if(n=o.field.isKeyField()?Ye.comparator(Ye.fromName(s.referenceValue),t.key):sl(s,t.data.field(o.field)),"desc"===o.dir&&(n*=-1),0!==n)break}return n}function kZ(r,e){if(null===r)return null===e;if(null===e||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!zc(r.position[t],e.position[t]))return!1;return!0}class _9{constructor(e,t="asc"){this.field=e,this.dir=t}}function aTe(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}class RZ{}class Nn extends RZ{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new cTe(e,t,n):"array-contains"===t?new fTe(e,n):"in"===t?new HZ(e,n):"not-in"===t?new dTe(e,n):"array-contains-any"===t?new hTe(e,n):new Nn(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new lTe(e,n):new uTe(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(sl(t,this.value)):null!==t&&ol(this.value)===ol(t)&&this.matchesComparison(sl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ft()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class f1 extends RZ{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new f1(e,t)}matches(e){return h5(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function h5(r){return"and"===r.op}function xb(r){return function xZ(r){for(const e of r.filters)if(e instanceof f1)return!1;return!0}(r)&&h5(r)}function Lb(r){if(r instanceof Nn)return r.field.canonicalString()+r.op.toString()+d5(r.value);if(xb(r))return r.filters.map(e=>Lb(e)).join(",");{const e=r.filters.map(t=>Lb(t)).join(",");return`${r.op}(${e})`}}function LZ(r,e){return r instanceof Nn?(n=r,(i=e)instanceof Nn&&n.op===i.op&&n.field.isEqual(i.field)&&zc(n.value,i.value)):r instanceof f1?function(n,i){return i instanceof f1&&n.op===i.op&&n.filters.length===i.filters.length&&n.filters.reduce((o,s,a)=>o&&LZ(s,i.filters[a]),!0)}(r,e):void ft();var n,i}function DZ(r){return r instanceof Nn?`${(t=r).field.canonicalString()} ${t.op} ${d5(t.value)}`:r instanceof f1?function(t){return t.op.toString()+" {"+t.getFilters().map(DZ).join(" ,")+"}"}(r):"Filter";var t}class cTe extends Nn{constructor(e,t,n){super(e,t,n),this.key=Ye.fromName(n.referenceValue)}matches(e){const t=Ye.comparator(e.key,this.key);return this.matchesComparison(t)}}class lTe extends Nn{constructor(e,t){super(e,"in",t),this.keys=VZ(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class uTe extends Nn{constructor(e,t){super(e,"not-in",t),this.keys=VZ(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function VZ(r,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(n=>Ye.fromName(n.referenceValue))}class fTe extends Nn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return p9(t)&&g9(t.arrayValue,this.value)}}class HZ extends Nn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&g9(this.value.arrayValue,t)}}class dTe extends Nn{constructor(e,t){super(e,"not-in",t)}matches(e){if(g9(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!g9(this.value.arrayValue,t)}}class hTe extends Nn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!p9(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>g9(this.value.arrayValue,n))}}class gTe{constructor(e,t=null,n=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.ce=null}}function zb(r,e=null,t=[],n=[],i=null,o=null,s=null){return new gTe(r,e,t,n,i,o,s)}function D6(r){const e=je(r);if(null===e.ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>Lb(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>{return(o=n).field.canonicalString()+o.dir;var o}).join(","),f9(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>d5(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>d5(n)).join(",")),e.ce=t}return e.ce}function C9(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!aTe(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!LZ(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!kZ(r.startAt,e.startAt)&&kZ(r.endAt,e.endAt)}function a_(r){return Ye.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length}class B3{constructor(e,t=null,n=[],i=[],o=null,s="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=c,this.le=null,this.he=null,this.Pe=null}}function g5(r){return new B3(r)}function GZ(r){return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.explicitOrderBy.length||1===r.explicitOrderBy.length&&r.explicitOrderBy[0].field.isKeyField())}function Db(r){return null!==r.collectionGroup}function p5(r){const e=je(r);if(null===e.le){e.le=[];const t=new Set;for(const o of e.explicitOrderBy)e.le.push(o),t.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new v1(fr.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.le.push(new _9(o,n))}),t.has(fr.keyField().canonicalString())||e.le.push(new _9(fr.keyField(),n))}return e.le}function ho(r){const e=je(r);return e.he||(e.he=function BZ(r,e){if("F"===r.limitType)return zb(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>new _9(i.field,"desc"===i.dir?"asc":"desc"));const t=r.endAt?new al(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new al(r.startAt.position,r.startAt.inclusive):null;return zb(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}(e,p5(r))),e.he}function Vb(r,e){const t=r.filters.concat([e]);return new B3(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function l_(r,e,t){return new B3(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function v9(r,e){return C9(ho(r),ho(e))&&r.limitType===e.limitType}function WZ(r){return`${D6(ho(r))}|lt:${r.limitType}`}function m5(r){return`Query(target=${function(t){let n=t.path.canonicalString();return null!==t.collectionGroup&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>DZ(i)).join(", ")}]`),f9(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>{return`${(s=i).field.canonicalString()} (${s.dir})`;var s}).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>d5(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>d5(i)).join(",")),`Target(${n})`}(ho(r))}; limitType=${r.limitType})`}function y9(r,e){return e.isFoundDocument()&&function(n,i){const o=i.key.path;return null!==n.collectionGroup?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):Ye.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(r,e)&&function(n,i){for(const o of p5(n))if(!o.field.isKeyField()&&null===i.data.field(o.field))return!1;return!0}(r,e)&&function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0}(r,e)&&(i=e,!((n=r).startAt&&!function(s,a,c){const l=IZ(s,a,c);return s.inclusive?l<=0:l<0}(n.startAt,p5(n),i)||n.endAt&&!function(s,a,c){const l=IZ(s,a,c);return s.inclusive?l>=0:l>0}(n.endAt,p5(n),i)));var n,i}function jZ(r){return(e,t)=>{let n=!1;for(const i of p5(r)){const o=pTe(i,e,t);if(0!==o)return o;n=n||i.field.isKeyField()}return 0}}function pTe(r,e,t){const n=r.field.isKeyField()?Ye.comparator(e.key,t.key):function(o,s,a){const c=s.data.field(o),l=a.data.field(o);return null!==c&&null!==l?sl(c,l):ft()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return ft()}}class W3{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[i,o]of n)if(this.equalsFn(i,e))return o}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){nl(this.inner,(t,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return MZ(this.inner)}size(){return this.innerSize}}const mTe=new H1(Ye.comparator);function Lo(){return mTe}const ZZ=new H1(Ye.comparator);function M9(...r){let e=ZZ;for(const t of r)e=e.insert(t.key,t);return e}function YZ(r){let e=ZZ;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Dc(){return E9()}function KZ(){return E9()}function E9(){return new W3(r=>r.toString(),(r,e)=>r.isEqual(e))}const _Te=new H1(Ye.comparator),CTe=new v1(Ye.comparator);function sn(...r){let e=CTe;for(const t of r)e=e.add(t);return e}const vTe=new v1(Yt);function XZ(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:d9(e)?"-0":e}}function QZ(r){return{integerValue:""+r}}function JZ(r,e){return function hZ(r){return"number"==typeof r&&Number.isInteger(r)&&!d9(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}(e)?QZ(e):XZ(r,e)}class u_{constructor(){this._=void 0}}function yTe(r,e,t){return r instanceof _5?function(i,o){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&n_(o)&&(o=r_(o)),o&&(s.fields.__previous_value__=o),{mapValue:s}}(t,e):r instanceof V6?tY(r,e):r instanceof H6?nY(r,e):function(i,o){const s=eY(i,o),a=rY(s)+rY(i.Ie);return kb(s)&&kb(i.Ie)?QZ(a):XZ(i.serializer,a)}(r,e)}function MTe(r,e,t){return r instanceof V6?tY(r,e):r instanceof H6?nY(r,e):t}function eY(r,e){return r instanceof C5?kb(n=e)||(o=n)&&"doubleValue"in o?e:{integerValue:0}:null;var n,o}class _5 extends u_{}class V6 extends u_{constructor(e){super(),this.elements=e}}function tY(r,e){const t=iY(e);for(const n of r.elements)t.some(i=>zc(i,n))||t.push(n);return{arrayValue:{values:t}}}class H6 extends u_{constructor(e){super(),this.elements=e}}function nY(r,e){let t=iY(e);for(const n of r.elements)t=t.filter(i=>!zc(i,n));return{arrayValue:{values:t}}}class C5 extends u_{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function rY(r){return Ar(r.integerValue||r.doubleValue)}function iY(r){return p9(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}class P9{constructor(e,t){this.field=e,this.transform=t}}class PTe{constructor(e,t){this.version=e,this.transformResults=t}}class dr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new dr}static exists(e){return new dr(void 0,e)}static updateTime(e){return new dr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function f_(r,e){return void 0!==r.updateTime?e.isFoundDocument()&&e.version.isEqual(r.updateTime):void 0===r.exists||r.exists===e.isFoundDocument()}class d_{}function oY(r,e){if(!r.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return r.isNoDocument()?new y5(r.key,dr.none()):new v5(r.key,r.data,dr.none());{const t=r.data,n=g2.empty();let i=new v1(fr.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);null===s&&o.length>1&&(o=o.popLast(),s=t.field(o)),null===s?n.delete(o):n.set(o,s),i=i.add(o)}return new q3(r.key,n,new xo(i.toArray()),dr.none())}}function STe(r,e,t){r instanceof v5?function(i,o,s){const a=i.value.clone(),c=cY(i.fieldTransforms,o,s.transformResults);a.setAll(c),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(r,e,t):r instanceof q3?function(i,o,s){if(!f_(i.precondition,o))return void o.convertToUnknownDocument(s.version);const a=cY(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(aY(i)),c.setAll(a),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(r,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function S9(r,e,t,n){return r instanceof v5?function(o,s,a,c){if(!f_(o.precondition,s))return a;const l=o.value.clone(),u=lY(o.fieldTransforms,c,s);return l.setAll(u),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(r,e,t,n):r instanceof q3?function(o,s,a,c){if(!f_(o.precondition,s))return a;const l=lY(o.fieldTransforms,c,s),u=s.data;return u.setAll(aY(o)),u.setAll(l),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),null===a?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(f=>f.field))}(r,e,t,n):(a=t,f_(r.precondition,s=e)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a);var s,a}function OTe(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),o=eY(n.transform,i||null);null!=o&&(null===t&&(t=g2.empty()),t.set(n.field,o))}return t||null}function sY(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(n=r.fieldTransforms)&&void 0===i||n&&i&&c5(n,i,(o,s)=>function ETe(r,e){return r.field.isEqual(e.field)&&(i=e.transform,(n=r.transform)instanceof V6&&i instanceof V6||n instanceof H6&&i instanceof H6?c5(n.elements,i.elements,zc):n instanceof C5&&i instanceof C5?zc(n.Ie,i.Ie):n instanceof _5&&i instanceof _5);var n,i}(o,s))))&&(0===r.type?r.value.isEqual(e.value):1!==r.type||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask));var n,i}class v5 extends d_{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class q3 extends d_{constructor(e,t,n,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function aY(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function cY(r,e,t){const n=new Map;gt(r.length===t.length);for(let i=0;i<t.length;i++){const o=r[i],s=o.transform,a=e.data.field(o.field);n.set(o.field,MTe(s,a,t[i]))}return n}function lY(r,e,t){const n=new Map;for(const i of r){const o=i.transform,s=t.data.field(i.field);n.set(i.field,yTe(o,s,e))}return n}class y5 extends d_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Fb extends d_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Ub{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&STe(o,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=S9(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=S9(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=KZ();return this.mutations.forEach(i=>{const o=e.get(i.key),s=o.overlayedDocument;let a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;const c=oY(s,a);null!==c&&n.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(vt.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),sn())}isEqual(e){return this.batchId===e.batchId&&c5(this.mutations,e.mutations,(t,n)=>sY(t,n))&&c5(this.baseMutations,e.baseMutations,(t,n)=>sY(t,n))}}class $b{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){gt(e.mutations.length===n.length);let i=function(){return _Te}();const o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,n[s].version);return new $b(e,t,n,i)}}class Gb{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class ATe{constructor(e,t){this.count=e,this.unchangedNames=t}}var ai,Gn;function fY(r){if(void 0===r)return $r("GRPC error has no .code"),ue.UNKNOWN;switch(r){case ai.OK:return ue.OK;case ai.CANCELLED:return ue.CANCELLED;case ai.UNKNOWN:return ue.UNKNOWN;case ai.DEADLINE_EXCEEDED:return ue.DEADLINE_EXCEEDED;case ai.RESOURCE_EXHAUSTED:return ue.RESOURCE_EXHAUSTED;case ai.INTERNAL:return ue.INTERNAL;case ai.UNAVAILABLE:return ue.UNAVAILABLE;case ai.UNAUTHENTICATED:return ue.UNAUTHENTICATED;case ai.INVALID_ARGUMENT:return ue.INVALID_ARGUMENT;case ai.NOT_FOUND:return ue.NOT_FOUND;case ai.ALREADY_EXISTS:return ue.ALREADY_EXISTS;case ai.PERMISSION_DENIED:return ue.PERMISSION_DENIED;case ai.FAILED_PRECONDITION:return ue.FAILED_PRECONDITION;case ai.ABORTED:return ue.ABORTED;case ai.OUT_OF_RANGE:return ue.OUT_OF_RANGE;case ai.UNIMPLEMENTED:return ue.UNIMPLEMENTED;case ai.DATA_LOSS:return ue.DATA_LOSS;default:return ft()}}(Gn=ai||(ai={}))[Gn.OK=0]="OK",Gn[Gn.CANCELLED=1]="CANCELLED",Gn[Gn.UNKNOWN=2]="UNKNOWN",Gn[Gn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Gn[Gn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Gn[Gn.NOT_FOUND=5]="NOT_FOUND",Gn[Gn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Gn[Gn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Gn[Gn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Gn[Gn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Gn[Gn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Gn[Gn.ABORTED=10]="ABORTED",Gn[Gn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Gn[Gn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Gn[Gn.INTERNAL=13]="INTERNAL",Gn[Gn.UNAVAILABLE=14]="UNAVAILABLE",Gn[Gn.DATA_LOSS=15]="DATA_LOSS";const bTe=new o5([4294967295,4294967295],0);function hY(r){const e=function dY(){return new TextEncoder}().encode(r),t=new POe;return t.update(e),new Uint8Array(t.digest())}function gY(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new o5([t,n],0),new o5([i,o],0)]}class Bb{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new O9(`Invalid padding: ${t}`);if(n<0)throw new O9(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new O9(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new O9(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ee=o5.fromNumber(this.Te)}de(e,t,n){let i=e.add(t.multiply(o5.fromNumber(n)));return 1===i.compare(bTe)&&(i=new o5([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const t=hY(e),[n,i]=gY(t);for(let o=0;o<this.hashCount;o++){const s=this.de(n,i,o);if(!this.Ae(s))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new Bb(o,i,t);return n.forEach(a=>s.insert(a)),s}insert(e){if(0===this.Te)return;const t=hY(e),[n,i]=gY(t);for(let o=0;o<this.hashCount;o++){const s=this.de(n,i,o);this.Re(s)}}Re(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class O9 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class T9{constructor(e,t,n,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,A9.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new T9(vt.min(),i,new H1(Yt),Lo(),sn())}}class A9{constructor(e,t,n,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new A9(n,t,sn(),sn(),sn())}}class g_{constructor(e,t,n,i){this.Ve=e,this.removedTargetIds=t,this.key=n,this.me=i}}class pY{constructor(e,t){this.targetId=e,this.fe=t}}class mY{constructor(e,t,n=Pi.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class _Y{constructor(){this.ge=0,this.pe=vY(),this.ye=Pi.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=sn(),t=sn(),n=sn();return this.pe.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:ft()}}),new A9(this.ye,this.we,e,t,n)}Fe(){this.Se=!1,this.pe=vY()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,gt(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class wTe{constructor(e){this.Le=e,this.ke=new Map,this.qe=Lo(),this.Qe=CY(),this.Ke=new H1(Yt)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,t=>{const n=this.ze(t);switch(e.state){case 0:this.je(t)&&n.Ce(e.resumeToken);break;case 1:n.Ne(),n.be||n.Fe(),n.Ce(e.resumeToken);break;case 2:n.Ne(),n.be||this.removeTarget(t);break;case 3:this.je(t)&&(n.Be(),n.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),n.Ce(e.resumeToken));break;default:ft()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach((n,i)=>{this.je(i)&&t(i)})}Je(e){const t=e.targetId,n=e.fe.count,i=this.Ye(t);if(i){const o=i.target;if(a_(o))if(0===n){const s=new Ye(o.path);this.We(t,s,er.newNoDocument(s,vt.min()))}else gt(1===n);else{const s=this.Ze(t);if(s!==n){const a=this.Xe(e),c=a?this.et(a,e,s):1;0!==c&&(this.He(t),this.Ke=this.Ke.insert(t,2===c?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}Xe(e){const t=e.fe.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=t;let s,a;try{s=G3(n).toUint8Array()}catch(c){if(c instanceof PZ)return fs("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new Bb(s,i,o)}catch(c){return fs(c instanceof O9?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return 0===a.Te?null:a}et(e,t,n){return t.fe.count===n-this.rt(e,t.targetId)?0:2}rt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let i=0;return n.forEach(o=>{const s=this.Le.nt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.We(t,o,null),i++)}),i}it(e){const t=new Map;this.ke.forEach((o,s)=>{const a=this.Ye(s);if(a){if(o.current&&a_(a.target)){const c=new Ye(a.target.path);null!==this.qe.get(c)||this.st(s,c)||this.We(s,c,er.newNoDocument(c,e))}o.De&&(t.set(s,o.ve()),o.Fe())}});let n=sn();this.Qe.forEach((o,s)=>{let a=!0;s.forEachWhile(c=>{const l=this.Ye(c);return!l||"TargetPurposeLimboResolution"===l.purpose||(a=!1,!1)}),a&&(n=n.add(o))}),this.qe.forEach((o,s)=>s.setReadTime(e));const i=new T9(e,t,this.Ke,this.qe,n);return this.qe=Lo(),this.Qe=CY(),this.Ke=new H1(Yt),i}Ue(e,t){if(!this.je(e))return;const n=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,n),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}We(e,t,n){if(!this.je(e))return;const i=this.ze(e);this.st(e,t)?i.Me(t,1):i.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),n&&(this.qe=this.qe.insert(t,n))}removeTarget(e){this.ke.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new _Y,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new v1(Yt),this.Qe=this.Qe.insert(e,t)),t}je(e){const t=null!==this.Ye(e);return t||Pe("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.ke.get(e);return t&&t.be?null:this.Le._t(e)}He(e){this.ke.set(e,new _Y),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}st(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function CY(){return new H1(Ye.comparator)}function vY(){return new H1(Ye.comparator)}const NTe={asc:"ASCENDING",desc:"DESCENDING"},ITe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},kTe={and:"AND",or:"OR"};class RTe{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Wb(r,e){return r.useProto3Json||f9(e)?e:{value:e}}function M5(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function yY(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function xTe(r,e){return M5(r,e.toTimestamp())}function Gr(r){return gt(!!r),vt.fromTimestamp(function(t){const n=rl(t);return new _r(n.seconds,n.nanos)}(r))}function qb(r,e){return(n=r,new $n(["projects",n.projectId,"databases",n.database])).child("documents").child(e).canonicalString();var n}function MY(r){const e=$n.fromString(r);return gt(NY(e)),e}function b9(r,e){return qb(r.databaseId,e.path)}function Vc(r,e){const t=MY(e);if(t.get(1)!==r.databaseId.projectId)throw new Oe(ue.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new Oe(ue.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new Ye(PY(t))}function jb(r,e){return qb(r.databaseId,e)}function w9(r){return new $n(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function PY(r){return gt(r.length>4&&"documents"===r.get(4)),r.popFirst(5)}function SY(r,e,t){return{name:b9(r,e),fields:t.value.mapValue.fields}}function TY(r,e){return{documents:[jb(r,e.path)]}}function Yb(r,e){const t={structuredQuery:{}},n=e.path;null!==e.collectionGroup?(t.parent=jb(r,n),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=jb(r,n.popLast()),t.structuredQuery.from=[{collectionId:n.lastSegment()}]);const i=function(c){if(0!==c.length)return wY(f1.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(c){if(0!==c.length)return c.map(l=>{return{field:cl((f=l).field),direction:HTe(f.dir)};var f})}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const s=Wb(r,e.limit);return null!==s&&(t.structuredQuery.limit=s),e.startAt&&(t.structuredQuery.startAt={before:(c=e.startAt).inclusive,values:c.position}),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),t;var c}function AY(r){let e=function EY(r){const e=MY(r);return 4===e.length?$n.emptyPath():PY(e)}(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){gt(1===n);const u=t.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let o=[];t.where&&(o=function(f){const g=bY(f);return g instanceof f1&&xb(g)?g.getFilters():[g]}(t.where));let s=[];t.orderBy&&(s=t.orderBy.map(g=>{return new _9(E5((S=g).field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction));var S}));let a=null;t.limit&&(a=function(f){let g;return g="object"==typeof f?f.value:f,f9(g)?null:g}(t.limit));let c=null;var f;t.startAt&&(c=new al((f=t.startAt).values||[],!!f.before));let l=null;return t.endAt&&(l=function(f){return new al(f.values||[],!f.before)}(t.endAt)),function $Z(r,e,t,n,i,o,s,a){return new B3(r,e,t,n,i,o,s,a)}(e,i,s,o,a,"F",c,l)}function bY(r){return void 0!==r.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=E5(t.unaryFilter.field);return Nn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=E5(t.unaryFilter.field);return Nn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=E5(t.unaryFilter.field);return Nn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=E5(t.unaryFilter.field);return Nn.create(s,"!=",{nullValue:"NULL_VALUE"});default:return ft()}}(r):void 0!==r.fieldFilter?Nn.create(E5((t=r).fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ft()}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==r.compositeFilter?function(t){return f1.create(t.compositeFilter.filters.map(n=>bY(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ft()}}(t.compositeFilter.op))}(r):ft();var t}function HTe(r){return NTe[r]}function FTe(r){return ITe[r]}function UTe(r){return kTe[r]}function cl(r){return{fieldPath:r.canonicalString()}}function E5(r){return fr.fromServerFormat(r.fieldPath)}function wY(r){return r instanceof Nn?function(t){if("=="===t.op){if(TZ(t.value))return{unaryFilter:{field:cl(t.field),op:"IS_NAN"}};if(OZ(t.value))return{unaryFilter:{field:cl(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(TZ(t.value))return{unaryFilter:{field:cl(t.field),op:"IS_NOT_NAN"}};if(OZ(t.value))return{unaryFilter:{field:cl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cl(t.field),op:FTe(t.op),value:t.value}}}(r):r instanceof f1?function(t){const n=t.getFilters().map(i=>wY(i));return 1===n.length?n[0]:{compositeFilter:{op:UTe(t.op),filters:n}}}(r):ft()}function $Te(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function NY(r){return r.length>=4&&"projects"===r.get(0)&&"databases"===r.get(2)}class j3{constructor(e,t,n,i,o=vt.min(),s=vt.min(),a=Pi.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new j3(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new j3(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new j3(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new j3(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class IY{constructor(e){this.ut=e}}function Kb(r){const e=AY({parent:r.parent,structuredQuery:r.structuredQuery});return"LAST"===r.limitType?l_(e,e.limit,"L"):e}class G6{constructor(){}ht(e,t){this.Pt(e,t),t.It()}Pt(e,t){if("nullValue"in e)this.Tt(t,5);else if("booleanValue"in e)this.Tt(t,10),t.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(t,15),t.Et(Ar(e.integerValue));else if("doubleValue"in e){const n=Ar(e.doubleValue);isNaN(n)?this.Tt(t,13):(this.Tt(t,15),d9(n)?t.Et(0):t.Et(n))}else if("timestampValue"in e){const n=e.timestampValue;this.Tt(t,20),"string"==typeof n?t.dt(n):(t.dt(`${n.seconds||""}`),t.Et(n.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,t),this.Rt(t);else if("bytesValue"in e)this.Tt(t,30),t.Vt(G3(e.bytesValue)),this.Rt(t);else if("referenceValue"in e)this.ft(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Tt(t,45),t.Et(n.latitude||0),t.Et(n.longitude||0)}else"mapValue"in e?AZ(e)?this.Tt(t,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,t),this.Rt(t)):"arrayValue"in e?(this.yt(e.arrayValue,t),this.Rt(t)):ft()}At(e,t){this.Tt(t,25),this.wt(e,t)}wt(e,t){t.dt(e)}gt(e,t){const n=e.fields||{};this.Tt(t,55);for(const i of Object.keys(n))this.At(i,t),this.Pt(n[i],t)}yt(e,t){const n=e.values||[];this.Tt(t,50);for(const i of n)this.Pt(i,t)}ft(e,t){this.Tt(t,37),Ye.fromName(e).path.forEach(n=>{this.Tt(t,60),this.wt(n,t)})}Tt(e,t){e.Et(t)}Rt(e){e.Et(2)}}G6.St=new G6;class KTe{constructor(){this.on=new nw}addToCollectionParentIndex(e,t){return this.on.add(t),se.resolve()}getCollectionParents(e,t){return se.resolve(this.on.getEntries(t))}addFieldIndex(e,t){return se.resolve()}deleteFieldIndex(e,t){return se.resolve()}deleteAllFieldIndexes(e){return se.resolve()}createTargetIndexes(e,t){return se.resolve()}getDocumentsMatchingTarget(e,t){return se.resolve(null)}getIndexType(e,t){return se.resolve(0)}getFieldIndexes(e,t){return se.resolve([])}getNextCollectionGroupToUpdate(e){return se.resolve(null)}getMinOffset(e,t){return se.resolve(ds.min())}getMinOffsetFromCollectionGroup(e,t){return se.resolve(ds.min())}updateCollectionGroup(e,t,n){return se.resolve()}updateIndexEntries(e,t){return se.resolve()}}class nw{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new v1($n.comparator),o=!i.has(n);return this.index[t]=i.add(n),o}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new v1($n.comparator)).toArray()}}new Uint8Array(0);class B2{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new B2(e,B2.DEFAULT_COLLECTION_PERCENTILE,B2.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}B2.DEFAULT_COLLECTION_PERCENTILE=10,B2.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,B2.DEFAULT=new B2(41943040,B2.DEFAULT_COLLECTION_PERCENTILE,B2.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),B2.DISABLED=new B2(-1,0,0);class W6{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new W6(0)}static Nn(){return new W6(-1)}}class nAe{constructor(){this.changes=new W3(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,er.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?se.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class oAe{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class iK{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==n&&S9(n.mutation,i,xo.empty(),_r.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,sn()).next(()=>n))}getLocalViewOfDocuments(e,t,n=sn()){const i=Dc();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(o=>{let s=M9();return o.forEach((a,c)=>{s=s.insert(a,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){const n=Dc();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,sn()))}populateOverlays(e,t,n){const i=[];return n.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,n,i){let o=Lo();const s=E9(),a=E9();return t.forEach((c,l)=>{const u=n.get(l.key);i.has(l.key)&&(void 0===u||u.mutation instanceof q3)?o=o.insert(l.key,l):void 0!==u?(s.set(l.key,u.mutation.getFieldMask()),S9(u.mutation,l,u.mutation.getFieldMask(),_r.now())):s.set(l.key,xo.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((l,u)=>s.set(l,u)),t.forEach((l,u)=>{var f;return a.set(l,new oAe(u,null!==(f=s.get(l))&&void 0!==f?f:null))}),a))}recalculateAndSaveOverlays(e,t){const n=E9();let i=new H1((s,a)=>s-a),o=sn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(const a of s)a.keys().forEach(c=>{const l=t.get(c);if(null===l)return;let u=n.get(c)||xo.empty();u=a.applyToLocalView(l,u),n.set(c,u);const f=(i.get(a.batchId)||sn()).add(c);i=i.insert(a.batchId,f)})}).next(()=>{const s=[],a=i.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,u=c.value,f=KZ();u.forEach(g=>{if(!o.has(g)){const y=oY(t.get(g),n.get(g));null!==y&&f.set(g,y),o=o.add(g)}}),s.push(this.documentOverlayCache.saveOverlays(e,l,f))}return se.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return Ye.isDocumentKey((s=t).path)&&null===s.collectionGroup&&0===s.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Db(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i);var s}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(o=>{const s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-o.size):se.resolve(Dc());let a=-1,c=o;return s.next(l=>se.forEach(l,(u,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),o.get(u)?se.resolve():this.remoteDocumentCache.getEntry(e,u).next(g=>{c=c.insert(u,g)}))).next(()=>this.populateOverlays(e,l,o)).next(()=>this.computeViews(e,c,l,sn())).next(u=>({batchId:a,changes:YZ(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ye(t)).next(n=>{let i=M9();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const o=t.collectionGroup;let s=M9();return this.indexManager.getCollectionParents(e,o).next(a=>se.forEach(a,c=>{const l=(f=t,g=c.child(o),new B3(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt));var f,g;return this.getDocumentsMatchingCollectionQuery(e,l,n,i).next(u=>{u.forEach((f,g)=>{s=s.insert(f,g)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,o,i))).next(s=>{o.forEach((c,l)=>{const u=l.getKey();null===s.get(u)&&(s=s.insert(u,er.newInvalidDocument(u)))});let a=M9();return s.forEach((c,l)=>{const u=o.get(c);void 0!==u&&S9(u.mutation,l,xo.empty(),_r.now()),y9(t,l)&&(a=a.insert(c,l))}),a})}}class sAe{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,t){return se.resolve(this.ur.get(t))}saveBundleMetadata(e,t){return this.ur.set(t.id,{id:(i=t).id,version:i.version,createTime:Gr(i.createTime)}),se.resolve();var i}getNamedQuery(e,t){return se.resolve(this.cr.get(t))}saveNamedQuery(e,t){return this.cr.set(t.name,{name:(i=t).name,query:Kb(i.bundledQuery),readTime:Gr(i.readTime)}),se.resolve();var i}}class aAe{constructor(){this.overlays=new H1(Ye.comparator),this.lr=new Map}getOverlay(e,t){return se.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Dc();return se.forEach(t,i=>this.getOverlay(e,i).next(o=>{null!==o&&n.set(i,o)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,o)=>{this.lt(e,t,o)}),se.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.lr.get(n);return void 0!==i&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.lr.delete(n)),se.resolve()}getOverlaysForCollection(e,t,n){const i=Dc(),o=t.length+1,s=new Ye(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===o&&c.largestBatchId>n&&i.set(c.getKey(),c)}return se.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let o=new H1((l,u)=>l-u);const s=this.overlays.getIterator();for(;s.hasNext();){const l=s.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>n){let u=o.get(l.largestBatchId);null===u&&(u=Dc(),o=o.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const a=Dc(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=i)););return se.resolve(a)}lt(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const s=this.lr.get(i.largestBatchId).delete(n.key);this.lr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(n.key,new Gb(t,n));let o=this.lr.get(t);void 0===o&&(o=sn(),this.lr.set(t,o)),this.lr.set(t,o.add(n.key))}}class rw{constructor(){this.hr=new v1($i.Pr),this.Ir=new v1($i.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,t){const n=new $i(e,t);this.hr=this.hr.add(n),this.Ir=this.Ir.add(n)}Er(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.dr(new $i(e,t))}Ar(e,t){e.forEach(n=>this.removeReference(n,t))}Rr(e){const t=new Ye(new $n([])),n=new $i(t,e),i=new $i(t,e+1),o=[];return this.Ir.forEachInRange([n,i],s=>{this.dr(s),o.push(s.key)}),o}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const t=new Ye(new $n([])),n=new $i(t,e),i=new $i(t,e+1);let o=sn();return this.Ir.forEachInRange([n,i],s=>{o=o.add(s.key)}),o}containsKey(e){const t=new $i(e,0),n=this.hr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class $i{constructor(e,t){this.key=e,this.gr=t}static Pr(e,t){return Ye.comparator(e.key,t.key)||Yt(e.gr,t.gr)}static Tr(e,t){return Yt(e.gr,t.gr)||Ye.comparator(e.key,t.key)}}class cAe{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.pr=1,this.yr=new v1($i.Pr)}checkEmpty(e){return se.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const o=this.pr;this.pr++;const s=new Ub(o,t,n,i);this.mutationQueue.push(s);for(const a of i)this.yr=this.yr.add(new $i(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return se.resolve(s)}lookupMutationBatch(e,t){return se.resolve(this.wr(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.Sr(t+1),o=i<0?0:i;return se.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return se.resolve(0===this.mutationQueue.length?-1:this.pr-1)}getAllMutationBatches(e){return se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new $i(t,0),i=new $i(t,Number.POSITIVE_INFINITY),o=[];return this.yr.forEachInRange([n,i],s=>{const a=this.wr(s.gr);o.push(a)}),se.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new v1(Yt);return t.forEach(i=>{const o=new $i(i,0),s=new $i(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([o,s],a=>{n=n.add(a.gr)})}),se.resolve(this.br(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let o=n;Ye.isDocumentKey(o)||(o=o.child(""));const s=new $i(new Ye(o),0);let a=new v1(Yt);return this.yr.forEachWhile(c=>{const l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.gr)),!0)},s),se.resolve(this.br(a))}br(e){const t=[];return e.forEach(n=>{const i=this.wr(n);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){gt(0===this.Dr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.yr;return se.forEach(t.mutations,i=>{const o=new $i(i.key,t.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=n})}Fn(e){}containsKey(e,t){const n=new $i(t,0),i=this.yr.firstAfterOrEqual(n);return se.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return se.resolve()}Dr(e,t){return this.Sr(e)}Sr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}wr(e){const t=this.Sr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class lAe{constructor(e){this.Cr=e,this.docs=new H1(Ye.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),o=i?i.size:0,s=this.Cr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return se.resolve(n?n.document.mutableCopy():er.newInvalidDocument(t))}getEntries(e,t){let n=Lo();return t.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():er.newInvalidDocument(i))}),se.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let o=Lo();const s=t.path,a=new Ye(s.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:l,value:{document:u}}=c.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||Ab(uZ(u),n)<=0||(i.has(u.key)||y9(t,u))&&(o=o.insert(u.key,u.mutableCopy()))}return se.resolve(o)}getAllFromCollectionGroup(e,t,n,i){ft()}vr(e,t){return se.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new uAe(this)}getSize(e){return se.resolve(this.size)}}class uAe extends nAe{constructor(e){super(),this._r=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this._r.addEntry(e,i)):this._r.removeEntry(n)}),se.waitFor(t)}getFromCache(e,t){return this._r.getEntry(e,t)}getAllFromCache(e,t){return this._r.getEntries(e,t)}}class fAe{constructor(e){this.persistence=e,this.Fr=new W3(t=>D6(t),C9),this.lastRemoteSnapshotVersion=vt.min(),this.highestTargetId=0,this.Mr=0,this.Or=new rw,this.targetCount=0,this.Nr=W6.On()}forEachTarget(e,t){return this.Fr.forEach((n,i)=>t(i)),se.resolve()}getLastRemoteSnapshotVersion(e){return se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return se.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),se.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Mr&&(this.Mr=t),se.resolve()}kn(e){this.Fr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Nr=new W6(t),this.highestTargetId=t),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,t){return this.kn(t),this.targetCount+=1,se.resolve()}updateTargetData(e,t){return this.kn(t),se.resolve()}removeTargetData(e,t){return this.Fr.delete(t.target),this.Or.Rr(t.targetId),this.targetCount-=1,se.resolve()}removeTargets(e,t,n){let i=0;const o=[];return this.Fr.forEach((s,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.Fr.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),se.waitFor(o).next(()=>i)}getTargetCount(e){return se.resolve(this.targetCount)}getTargetData(e,t){const n=this.Fr.get(t)||null;return se.resolve(n)}addMatchingKeys(e,t,n){return this.Or.Er(t,n),se.resolve()}removeMatchingKeys(e,t,n){this.Or.Ar(t,n);const i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),se.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Or.Rr(t),se.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Or.mr(t);return se.resolve(n)}containsKey(e,t){return se.resolve(this.Or.containsKey(t))}}class iw{constructor(e,t){this.Br={},this.overlays={},this.Lr=new hs(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new fAe(this),this.indexManager=new KTe,this.remoteDocumentCache=new lAe(n=>this.referenceDelegate.Qr(n)),this.serializer=new IY(t),this.Kr=new sAe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new aAe,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Br[e.toKey()];return n||(n=new cAe(t,this.referenceDelegate),this.Br[e.toKey()]=n),n}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,t,n){Pe("MemoryPersistence","Starting transaction:",e);const i=new dAe(this.Lr.next());return this.referenceDelegate.$r(),n(i).next(o=>this.referenceDelegate.Ur(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Wr(e,t){return se.or(Object.values(this.Br).map(n=>()=>n.containsKey(e,t)))}}class dAe extends xOe{constructor(e){super(),this.currentSequenceNumber=e}}class E_{constructor(e){this.persistence=e,this.Gr=new rw,this.zr=null}static jr(e){return new E_(e)}get Hr(){if(this.zr)return this.zr;throw ft()}addReference(e,t,n){return this.Gr.addReference(n,t),this.Hr.delete(n.toString()),se.resolve()}removeReference(e,t,n){return this.Gr.removeReference(n,t),this.Hr.add(n.toString()),se.resolve()}markPotentiallyOrphaned(e,t){return this.Hr.add(t.toString()),se.resolve()}removeTarget(e,t){this.Gr.Rr(t.targetId).forEach(i=>this.Hr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Hr.add(o.toString()))}).next(()=>n.removeTargetData(e,t))}$r(){this.zr=new Set}Ur(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return se.forEach(this.Hr,n=>{const i=Ye.fromPath(n);return this.Jr(e,i).next(o=>{o||t.removeEntry(i,vt.min())})}).next(()=>(this.zr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Jr(e,t).next(n=>{n?this.Hr.delete(t.toString()):this.Hr.add(t.toString())})}Qr(e){return 0}Jr(e,t){return se.or([()=>se.resolve(this.Gr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Wr(e,t)])}}class cw{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.ki=n,this.qi=i}static Qi(e,t){let n=sn(),i=sn();for(const o of t.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new cw(e,t.fromCache,n,i)}}class gAe{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class sK{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,t){this.Gi=e,this.indexManager=t,this.Ki=!0}getDocumentsMatchingQuery(e,t,n,i){const o={result:null};return this.zi(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ji(e,t,i,n).next(s=>{o.result=s})}).next(()=>{if(o.result)return;const s=new gAe;return this.Hi(e,t,s).next(a=>{if(o.result=a,this.$i)return this.Ji(e,t,s,a.size)})}).next(()=>o.result)}Ji(e,t,n,i){return n.documentReadCount<this.Ui?(a5()<=Fn.DEBUG&&Pe("QueryEngine","SDK will not create cache indexes for query:",m5(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),se.resolve()):(a5()<=Fn.DEBUG&&Pe("QueryEngine","Query:",m5(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Wi*i?(a5()<=Fn.DEBUG&&Pe("QueryEngine","The SDK decides to create cache indexes for query:",m5(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ho(t))):se.resolve())}zi(e,t){if(GZ(t))return se.resolve(null);let n=ho(t);return this.indexManager.getIndexType(e,n).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=l_(t,null,"F"),n=ho(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const s=sn(...o);return this.Gi.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,n).next(c=>{const l=this.Yi(t,a);return this.Zi(t,l,s,c.readTime)?this.zi(e,l_(t,null,"F")):this.Xi(e,l,t,c)}))})))}ji(e,t,n,i){return GZ(t)||i.isEqual(vt.min())?se.resolve(null):this.Gi.getDocuments(e,n).next(o=>{const s=this.Yi(t,o);return this.Zi(t,s,n,i)?se.resolve(null):(a5()<=Fn.DEBUG&&Pe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),m5(t)),this.Xi(e,s,t,function lZ(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=vt.fromTimestamp(1e9===n?new _r(t+1,0):new _r(t,n));return new ds(i,Ye.empty(),e)}(i,-1)).next(a=>a))})}Yi(e,t){let n=new v1(jZ(e));return t.forEach((i,o)=>{y9(e,o)&&(n=n.add(o))}),n}Zi(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const o="F"===e.limitType?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Hi(e,t,n){return a5()<=Fn.DEBUG&&Pe("QueryEngine","Using full collection scan to execute query:",m5(t)),this.Gi.getDocumentsMatchingQuery(e,t,ds.min(),n)}Xi(e,t,n,i){return this.Gi.getDocumentsMatchingQuery(e,n,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}}class pAe{constructor(e,t,n,i){this.persistence=e,this.es=t,this.serializer=i,this.ts=new H1(Yt),this.ns=new W3(o=>D6(o),C9),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(n)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new iK(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ts))}}function cK(r,e){return lw.apply(this,arguments)}function lw(){return lw=E(function*(r,e){const t=je(r);return yield t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,t.os(e),t.mutationQueue.getAllMutationBatches(n))).next(o=>{const s=[],a=[];let c=sn();for(const l of i){s.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of o){a.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return t.localDocuments.getDocuments(n,c).next(l=>({_s:l,removedBatchIds:s,addedBatchIds:a}))})})}),lw.apply(this,arguments)}function lK(r){const e=je(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.qr.getLastRemoteSnapshotVersion(t))}function CAe(r,e){const t=je(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function b5(r,e,t){return uw.apply(this,arguments)}function uw(){return uw=E(function*(r,e,t){const n=je(r),i=n.ts.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield n.persistence.runTransaction("Release target",o,s=>n.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!tl(s))throw s;Pe("LocalStore",`Failed to update sequence numbers for target ${e}: ${s}`)}n.ts=n.ts.remove(e),n.ns.delete(i.target)}),uw.apply(this,arguments)}function O_(r,e,t){const n=je(r);let i=vt.min(),o=sn();return n.persistence.runTransaction("Execute query","readwrite",s=>function(c,l,u){const f=je(c),g=f.ns.get(u);return void 0!==g?se.resolve(f.ts.get(g)):f.qr.getTargetData(l,u)}(n,s,ho(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,n.qr.getMatchingKeysForTargetId(s,a.targetId).next(c=>{o=c})}).next(()=>n.es.getDocumentsMatchingQuery(s,e,t?i:vt.min(),t?o:sn())).next(a=>(function hK(r,e,t){let n=r.rs.get(e)||vt.min();t.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),r.rs.set(e,n)}(n,function qZ(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}(e),a),{documents:a,ls:o})))}class pw{constructor(){this.activeTargetIds=function Hb(){return vTe}()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class mK{constructor(){this.eo=new pw,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,t,n){this.no[e]=t}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new pw,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class MAe{ro(e){}shutdown(){}}class _K{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){Pe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){Pe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let b_=null;function _w(){return null===b_?b_=268435456+Math.round(2147483648*Math.random()):b_++,"0x"+b_.toString(16)}const EAe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class PAe{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}const W2="WebChannelConnection";class SAe extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.mo=n+"://"+t.host,this.fo=`projects/${i}/databases/${o}`,this.po="(default)"===this.databaseId.database?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get yo(){return!1}wo(t,n,i,o,s){const a=_w(),c=this.So(t,n);Pe("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);const l={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(l,o,s),this.Do(t,c,l,i).then(u=>(Pe("RestConnection",`Received RPC '${t}' ${a}: `,u),u),u=>{throw fs("RestConnection",`RPC '${t}' ${a} failed with error: `,u,"url: ",c,"request:",i),u})}Co(t,n,i,o,s,a){return this.wo(t,n,i,o,s)}bo(t,n,i){t["X-Goog-Api-Client"]="gl-js/ fire/"+s5,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((o,s)=>t[s]=o),i&&i.headers.forEach((o,s)=>t[s]=o)}So(t,n){return`${this.mo}/v1/${n}:${EAe[t]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,t,n,i){const o=_w();return new Promise((s,a)=>{const c=new EOe;c.setWithCredentials(!0),c.listenOnce(yOe.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Sb.NO_ERROR:const u=c.getResponseJson();Pe(W2,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(u)),s(u);break;case Sb.TIMEOUT:Pe(W2,`RPC '${e}' ${o} timed out`),a(new Oe(ue.DEADLINE_EXCEEDED,"Request time out"));break;case Sb.HTTP_ERROR:const f=c.getStatus();if(Pe(W2,`RPC '${e}' ${o} failed with status:`,f,"response text:",c.getResponseText()),f>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);const y=g?.error;if(y&&y.status&&y.message){const S=function(R){const U=R.toLowerCase().replace(/_/g,"-");return Object.values(ue).indexOf(U)>=0?U:ue.UNKNOWN}(y.status);a(new Oe(S,y.message))}else a(new Oe(ue.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new Oe(ue.UNAVAILABLE,"Connection failed."));break;default:ft()}}finally{Pe(W2,`RPC '${e}' ${o} completed.`)}});const l=JSON.stringify(i);Pe(W2,`RPC '${e}' ${o} sending request:`,i),c.send(t,"POST",l,n,15)})}vo(e,t,n){const i=_w(),o=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=COe(),a=vOe(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.bo(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;const u=o.join("");Pe(W2,`Creating RPC '${e}' stream ${i}: ${u}`,c);const f=s.createWebChannel(u,c);let g=!1,y=!1;const S=new PAe({co:R=>{y?Pe(W2,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(g||(Pe(W2,`Opening RPC '${e}' stream ${i} transport.`),f.open(),g=!0),Pe(W2,`RPC '${e}' stream ${i} sending:`,R),f.send(R))},lo:()=>f.close()}),I=(R,U,$)=>{R.listen(U,oe=>{try{$(oe)}catch(_e){setTimeout(()=>{throw _e},0)}})};return I(f,Qm.EventType.OPEN,()=>{y||Pe(W2,`RPC '${e}' stream ${i} transport opened.`)}),I(f,Qm.EventType.CLOSE,()=>{y||(y=!0,Pe(W2,`RPC '${e}' stream ${i} transport closed`),S.Ro())}),I(f,Qm.EventType.ERROR,R=>{y||(y=!0,fs(W2,`RPC '${e}' stream ${i} transport errored:`,R),S.Ro(new Oe(ue.UNAVAILABLE,"The operation could not be completed")))}),I(f,Qm.EventType.MESSAGE,R=>{var U;if(!y){const $=R.data[0];gt(!!$);const _e=$.error||(null===(U=$[0])||void 0===U?void 0:U.error);if(_e){Pe(W2,`RPC '${e}' stream ${i} received error:`,_e);const Te=_e.status;let Fe=function(a1){const dn=ai[a1];if(void 0!==dn)return fY(dn)}(Te),mt=_e.message;void 0===Fe&&(Fe=ue.INTERNAL,mt="Unknown error status: "+Te+" with message "+_e.message),y=!0,S.Ro(new Oe(Fe,mt)),f.close()}else Pe(W2,`RPC '${e}' stream ${i} received:`,$),S.Vo($)}}),I(a,MOe.STAT_EVENT,R=>{R.stat===rZ.PROXY?Pe(W2,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===rZ.NOPROXY&&Pe(W2,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{S.Ao()},0),S}}function w_(){return typeof document<"u"?document:null}function V9(r){return new RTe(r,!0)}class Cw{constructor(e,t,n=1e3,i=1.5,o=6e4){this.si=e,this.timerId=t,this.Fo=n,this.Mo=i,this.xo=o,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const t=Math.floor(this.Oo+this.qo()),n=Math.max(0,Date.now()-this.Bo),i=Math.max(0,t-n);i>0&&Pe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){null!==this.No&&(this.No.skipDelay(),this.No=null)}cancel(){null!==this.No&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class vK{constructor(e,t,n,i,o,s,a,c){this.si=e,this.Ko=n,this.$o=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new Cw(e,t)}jo(){return 1===this.state||5===this.state||this.Ho()}Ho(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Jo()}stop(){var e=this;return E(function*(){e.jo()&&(yield e.close(0))})()}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&null===this.Wo&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}Xo(){var e=this;return E(function*(){if(e.Ho())return e.close(0)})()}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}close(e,t){var n=this;return E(function*(){n.t_(),n.n_(),n.zo.cancel(),n.Uo++,4!==e?n.zo.reset():t&&t.code===ue.RESOURCE_EXHAUSTED?($r(t.toString()),$r("Using maximum backoff delay to prevent overloading the backend."),n.zo.Lo()):t&&t.code===ue.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.r_(),n.stream.close(),n.stream=null),n.state=e,yield n.listener.Io(t)})()}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),t=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Uo===t&&this.s_(n,i)},n=>{e(()=>{const i=new Oe(ue.UNKNOWN,"Fetching auth token failed: "+n.message);return this.o_(i)})})}s_(e,t){const n=this.i_(this.Uo);this.stream=this.__(e,t),this.stream.ho(()=>{n(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{n(()=>this.o_(i))}),this.stream.onMessage(i=>{n(()=>this.onMessage(i))})}Jo(){var e=this;this.state=5,this.zo.ko(E(function*(){e.state=0,e.start()}))}o_(e){return Pe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return t=>{this.si.enqueueAndForget(()=>this.Uo===e?t():(Pe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class OAe extends vK{constructor(e,t,n,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,s),this.serializer=o}__(e,t){return this.connection.vo("Listen",e,t)}onMessage(e){this.zo.reset();const t=function zTe(r,e){let t;if("targetChange"in e){const n="NO_CHANGE"===(l=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===l?1:"REMOVE"===l?2:"CURRENT"===l?3:"RESET"===l?4:ft(),i=e.targetChange.targetIds||[],o=function(l,u){return l.useProto3Json?(gt(void 0===u||"string"==typeof u),Pi.fromBase64String(u||"")):(gt(void 0===u||u instanceof Uint8Array),Pi.fromUint8Array(u||new Uint8Array))}(r,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(l){const u=void 0===l.code?ue.UNKNOWN:fY(l.code);return new Oe(u,l.message||"")}(s);t=new mY(n,i,o,a||null)}else if("documentChange"in e){const n=e.documentChange,i=Vc(r,n.document.name),o=Gr(n.document.updateTime),s=n.document.createTime?Gr(n.document.createTime):vt.min(),a=new g2({mapValue:{fields:n.document.fields}}),c=er.newFoundDocument(i,o,s,a);t=new g_(n.targetIds||[],n.removedTargetIds||[],c.key,c)}else if("documentDelete"in e){const n=e.documentDelete,i=Vc(r,n.document),o=n.readTime?Gr(n.readTime):vt.min(),s=er.newNoDocument(i,o);t=new g_([],n.removedTargetIds||[],s.key,s)}else if("documentRemove"in e){const n=e.documentRemove,i=Vc(r,n.document);t=new g_([],n.removedTargetIds||[],i,null)}else{if(!("filter"in e))return ft();{const n=e.filter,{count:i=0,unchangedNames:o}=n,s=new ATe(i,o);t=new pY(n.targetId,s)}}var l;return t}(this.serializer,e),n=function(o){if(!("targetChange"in o))return vt.min();const s=o.targetChange;return s.targetIds&&s.targetIds.length?vt.min():s.readTime?Gr(s.readTime):vt.min()}(e);return this.listener.a_(t,n)}u_(e){const t={};t.database=w9(this.serializer),t.addTarget=function(o,s){let a;const c=s.target;if(a=a_(c)?{documents:TY(o,c)}:{query:Yb(o,c)},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=yY(o,s.resumeToken);const l=Wb(o,s.expectedCount);null!==l&&(a.expectedCount=l)}else if(s.snapshotVersion.compareTo(vt.min())>0){a.readTime=M5(o,s.snapshotVersion.toTimestamp());const l=Wb(o,s.expectedCount);null!==l&&(a.expectedCount=l)}return a}(this.serializer,e);const n=function VTe(r,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ft()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);n&&(t.labels=n),this.e_(t)}c_(e){const t={};t.database=w9(this.serializer),t.removeTarget=e,this.e_(t)}}class TAe extends vK{constructor(e,t,n,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,s),this.serializer=o,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,t){return this.connection.vo("Write",e,t)}onMessage(e){if(gt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const t=function DTe(r,e){return r&&r.length>0?(gt(void 0!==e),r.map(t=>function(i,o){let s=Gr(i.updateTime?i.updateTime:o);return s.isEqual(vt.min())&&(s=Gr(o)),new PTe(s,i.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),n=Gr(e.commitTime);return this.listener.I_(n,t)}return gt(!e.writeResults||0===e.writeResults.length),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=w9(this.serializer),this.e_(e)}P_(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>function N9(r,e){let t;if(e instanceof v5)t={update:SY(r,e.key,e.value)};else if(e instanceof y5)t={delete:b9(r,e.key)};else if(e instanceof q3)t={update:SY(r,e.key,e.data),updateMask:$Te(e.fieldMask)};else{if(!(e instanceof Fb))return ft();t={verify:b9(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(o,s){const a=s.transform;if(a instanceof _5)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof V6)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof H6)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof C5)return{fieldPath:s.field.canonicalString(),increment:a.Ie};throw ft()}(0,n))),e.precondition.isNone||(t.currentDocument=void 0!==(o=e.precondition).updateTime?{updateTime:xTe(r,o.updateTime)}:void 0!==o.exists?{exists:o.exists}:ft()),t;var o}(this.serializer,n))};this.e_(t)}}class AAe extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new Oe(ue.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,t,n){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.wo(e,t,n,i,o)).catch(i=>{throw"FirebaseError"===i.name?(i.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Oe(ue.UNKNOWN,i.toString())})}Co(e,t,n,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Co(e,t,n,o,s,i)).catch(o=>{throw"FirebaseError"===o.name?(o.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Oe(ue.UNKNOWN,o.toString())})}terminate(){this.d_=!0}}class wAe{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){0===this.V_&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){"Online"===this.state?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,"Online"===e&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?($r(t),this.f_=!1):Pe("OnlineStateTracker",t)}S_(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}}class NAe{constructor(e,t,n,i,o){var s=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=o,this.F_.ro(a=>{n.enqueueAndForget(E(function*(){var c;dl(s)&&(Pe("RemoteStore","Restarting streams for network reachability change."),yield(c=E(function*(u){const f=je(u);f.C_.add(4),yield w5(f),f.M_.set("Unknown"),f.C_.delete(4),yield H9(f)}),function l(u){return c.apply(this,arguments)})(s))}))}),this.M_=new wAe(n,i)}}function H9(r){return yw.apply(this,arguments)}function yw(){return yw=E(function*(r){if(dl(r))for(const e of r.v_)yield e(!0)}),yw.apply(this,arguments)}function w5(r){return Mw.apply(this,arguments)}function Mw(){return Mw=E(function*(r){for(const e of r.v_)yield e(!1)}),Mw.apply(this,arguments)}function N_(r,e){const t=je(r);t.D_.has(e.targetId)||(t.D_.set(e.targetId,e),Sw(t)?Pw(t):I5(t).Ho()&&Ew(t,e))}function F9(r,e){const t=je(r),n=I5(t);t.D_.delete(e),n.Ho()&&yK(t,e),0===t.D_.size&&(n.Ho()?n.Zo():dl(t)&&t.M_.set("Unknown"))}function Ew(r,e){if(r.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(vt.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}I5(r).u_(e)}function yK(r,e){r.x_.Oe(e),I5(r).c_(e)}function Pw(r){r.x_=new wTe({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>r.D_.get(e)||null,nt:()=>r.datastore.serializer.databaseId}),I5(r).start(),r.M_.g_()}function Sw(r){return dl(r)&&!I5(r).jo()&&r.D_.size>0}function dl(r){return 0===je(r).C_.size}function MK(r){r.x_=void 0}function IAe(r){return Ow.apply(this,arguments)}function Ow(){return Ow=E(function*(r){r.D_.forEach((e,t)=>{Ew(r,e)})}),Ow.apply(this,arguments)}function kAe(r,e){return Tw.apply(this,arguments)}function Tw(){return Tw=E(function*(r,e){MK(r),Sw(r)?(r.M_.w_(e),Pw(r)):r.M_.set("Unknown")}),Tw.apply(this,arguments)}function RAe(r,e,t){return Aw.apply(this,arguments)}function Aw(){return Aw=E(function*(r,e,t){if(r.M_.set("Online"),e instanceof mY&&2===e.state&&e.cause)try{yield(n=E(function*(o,s){const a=s.cause;for(const c of s.targetIds)o.D_.has(c)&&(yield o.remoteSyncer.rejectListen(c,a),o.D_.delete(c),o.x_.removeTarget(c))}),function i(o,s){return n.apply(this,arguments)})(r,e)}catch(n){Pe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),yield I_(r,n)}else if(e instanceof g_?r.x_.$e(e):e instanceof pY?r.x_.Je(e):r.x_.Ge(e),!t.isEqual(vt.min()))try{const n=yield lK(r.localStore);t.compareTo(n)>=0&&(yield function(o,s){const a=o.x_.it(s);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const u=o.D_.get(l);u&&o.D_.set(l,u.withResumeToken(c.resumeToken,s))}}),a.targetMismatches.forEach((c,l)=>{const u=o.D_.get(c);if(!u)return;o.D_.set(c,u.withResumeToken(Pi.EMPTY_BYTE_STRING,u.snapshotVersion)),yK(o,c);const f=new j3(u.target,c,l,u.sequenceNumber);Ew(o,f)}),o.remoteSyncer.applyRemoteEvent(a)}(r,t))}catch(n){Pe("RemoteStore","Failed to raise snapshot:",n),yield I_(r,n)}var n}),Aw.apply(this,arguments)}function I_(r,e,t){return bw.apply(this,arguments)}function bw(){return bw=E(function*(r,e,t){if(!tl(e))throw e;r.C_.add(1),yield w5(r),r.M_.set("Offline"),t||(t=()=>lK(r.localStore)),r.asyncQueue.enqueueRetryable(E(function*(){Pe("RemoteStore","Retrying IndexedDB access"),yield t(),r.C_.delete(1),yield H9(r)}))}),bw.apply(this,arguments)}function EK(r,e){return e().catch(t=>I_(r,t,e))}function N5(r){return ww.apply(this,arguments)}function ww(){return ww=E(function*(r){const e=je(r),t=hl(e);let n=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;xAe(e);)try{const i=yield CAe(e.localStore,n);if(null===i){0===e.b_.length&&t.Zo();break}n=i.batchId,LAe(e,i)}catch(i){yield I_(e,i)}PK(e)&&SK(e)}),ww.apply(this,arguments)}function xAe(r){return dl(r)&&r.b_.length<10}function LAe(r,e){r.b_.push(e);const t=hl(r);t.Ho()&&t.h_&&t.P_(e.mutations)}function PK(r){return dl(r)&&!hl(r).jo()&&r.b_.length>0}function SK(r){hl(r).start()}function zAe(r){return Nw.apply(this,arguments)}function Nw(){return Nw=E(function*(r){hl(r).E_()}),Nw.apply(this,arguments)}function DAe(r){return Iw.apply(this,arguments)}function Iw(){return Iw=E(function*(r){const e=hl(r);for(const t of r.b_)e.P_(t.mutations)}),Iw.apply(this,arguments)}function VAe(r,e,t){return kw.apply(this,arguments)}function kw(){return kw=E(function*(r,e,t){const n=r.b_.shift(),i=$b.from(n,e,t);yield EK(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),yield N5(r)}),kw.apply(this,arguments)}function HAe(r,e){return Rw.apply(this,arguments)}function Rw(){return Rw=E(function*(r,e){var t;e&&hl(r).h_&&(yield(t=E(function*(i,o){if(function uY(r){switch(r){default:return ft();case ue.CANCELLED:case ue.UNKNOWN:case ue.DEADLINE_EXCEEDED:case ue.RESOURCE_EXHAUSTED:case ue.INTERNAL:case ue.UNAVAILABLE:case ue.UNAUTHENTICATED:return!1;case ue.INVALID_ARGUMENT:case ue.NOT_FOUND:case ue.ALREADY_EXISTS:case ue.PERMISSION_DENIED:case ue.FAILED_PRECONDITION:case ue.ABORTED:case ue.OUT_OF_RANGE:case ue.UNIMPLEMENTED:case ue.DATA_LOSS:return!0}}(a=o.code)&&a!==ue.ABORTED){const s=i.b_.shift();hl(i).Yo(),yield EK(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,o)),yield N5(i)}var a}),function n(i,o){return t.apply(this,arguments)})(r,e)),PK(r)&&SK(r)}),Rw.apply(this,arguments)}function OK(r,e){return xw.apply(this,arguments)}function xw(){return xw=E(function*(r,e){const t=je(r);t.asyncQueue.verifyOperationInProgress(),Pe("RemoteStore","RemoteStore received new credentials");const n=dl(t);t.C_.add(3),yield w5(t),n&&t.M_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.C_.delete(3),yield H9(t)}),xw.apply(this,arguments)}function zw(){return zw=E(function*(r,e){const t=je(r);e?(t.C_.delete(2),yield H9(t)):e||(t.C_.add(2),yield w5(t),t.M_.set("Unknown"))}),zw.apply(this,arguments)}function I5(r){return r.O_||(r.O_=function(t,n,i){const o=je(t);return o.A_(),new OAe(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(r.datastore,r.asyncQueue,{ho:IAe.bind(null,r),Io:kAe.bind(null,r),a_:RAe.bind(null,r)}),r.v_.push(function(){var e=E(function*(t){t?(r.O_.Yo(),Sw(r)?Pw(r):r.M_.set("Unknown")):(yield r.O_.stop(),MK(r))});return function(t){return e.apply(this,arguments)}}())),r.O_}function hl(r){return r.N_||(r.N_=function(t,n,i){const o=je(t);return o.A_(),new TAe(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(r.datastore,r.asyncQueue,{ho:zAe.bind(null,r),Io:HAe.bind(null,r),T_:DAe.bind(null,r),I_:VAe.bind(null,r)}),r.v_.push(function(){var e=E(function*(t){t?(r.N_.Yo(),yield N5(r)):(yield r.N_.stop(),r.b_.length>0&&(Pe("RemoteStore",`Stopping write stream with ${r.b_.length} pending writes`),r.b_=[]))});return function(t){return e.apply(this,arguments)}}())),r.N_}class Dw{constructor(e,t,n,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new Ei,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,o){const s=Date.now()+n,a=new Dw(e,t,s,i,o);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Oe(ue.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function k5(r,e){if($r("AsyncQueue",`${e}: ${r}`),tl(r))return new Oe(ue.UNAVAILABLE,`${e}: ${r}`);throw r}class R5{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Ye.comparator(t.key,n.key):(t,n)=>Ye.comparator(t.key,n.key),this.keyedMap=M9(),this.sortedSet=new H1(this.comparator)}static emptySet(e){return new R5(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof R5)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new R5;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class TK{constructor(){this.B_=new H1(Ye.comparator)}track(e){const t=e.doc.key,n=this.B_.get(t);n?0!==e.type&&3===n.type?this.B_=this.B_.insert(t,e):3===e.type&&1!==n.type?this.B_=this.B_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.B_=this.B_.remove(t):1===e.type&&2===n.type?this.B_=this.B_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):ft():this.B_=this.B_.insert(t,e)}L_(){const e=[];return this.B_.inorderTraversal((t,n)=>{e.push(n)}),e}}class x5{constructor(e,t,n,i,o,s,a,c,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,i,o){const s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new x5(e,t,R5.emptySet(t),s,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&v9(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}class FAe{constructor(){this.k_=void 0,this.listeners=[]}}class UAe{constructor(){this.queries=new W3(e=>WZ(e),v9),this.onlineState="Unknown",this.q_=new Set}}function Vw(r,e){return Hw.apply(this,arguments)}function Hw(){return Hw=E(function*(r,e){const t=je(r),n=e.query;let i=!1,o=t.queries.get(n);if(o||(i=!0,o=new FAe),i)try{o.k_=yield t.onListen(n)}catch(s){const a=k5(s,`Initialization of query '${m5(e.query)}' failed`);return void e.onError(a)}t.queries.set(n,o),o.listeners.push(e),e.Q_(t.onlineState),o.k_&&e.K_(o.k_)&&$w(t)}),Hw.apply(this,arguments)}function Fw(r,e){return Uw.apply(this,arguments)}function Uw(){return Uw=E(function*(r,e){const t=je(r),n=e.query;let i=!1;const o=t.queries.get(n);if(o){const s=o.listeners.indexOf(e);s>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length)}if(i)return t.queries.delete(n),t.onUnlisten(n)}),Uw.apply(this,arguments)}function $Ae(r,e){const t=je(r);let n=!1;for(const i of e){const s=t.queries.get(i.query);if(s){for(const a of s.listeners)a.K_(i)&&(n=!0);s.k_=i}}n&&$w(t)}function GAe(r,e,t){const n=je(r),i=n.queries.get(e);if(i)for(const o of i.listeners)o.onError(t);n.queries.delete(e)}function $w(r){r.q_.forEach(e=>{e.next()})}class Gw{constructor(e,t,n){this.query=e,this.U_=t,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=n||{}}K_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)3!==i.type&&n.push(i);e=new x5(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.W_?this.z_(e)&&(this.U_.next(e),t=!0):this.j_(e,this.onlineState)&&(this.H_(e),t=!0),this.G_=e,t}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let t=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),t=!0),t}j_(e,t){return!e.fromCache||(!this.options.J_||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}z_(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}H_(e){e=x5.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}class wK{constructor(e){this.key=e}}class NK{constructor(e){this.key=e}}class IK{constructor(e,t){this.query=e,this.ia=t,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=sn(),this.mutatedKeys=sn(),this._a=jZ(e),this.aa=new R5(this._a)}get ua(){return this.ia}ca(e,t){const n=t?t.la:new TK,i=t?t.aa:this.aa;let o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1;const c="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,f)=>{const g=i.get(u),y=y9(this.query,f)?f:null,S=!!g&&this.mutatedKeys.has(g.key),I=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let R=!1;g&&y?g.data.isEqual(y.data)?S!==I&&(n.track({type:3,doc:y}),R=!0):this.ha(g,y)||(n.track({type:2,doc:y}),R=!0,(c&&this._a(y,c)>0||l&&this._a(y,l)<0)&&(a=!0)):!g&&y?(n.track({type:0,doc:y}),R=!0):g&&!y&&(n.track({type:1,doc:g}),R=!0,(c||l)&&(a=!0)),R&&(y?(s=s.add(y),o=I?o.add(u):o.delete(u)):(s=s.delete(u),o=o.delete(u)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const u="F"===this.query.limitType?s.last():s.first();s=s.delete(u.key),o=o.delete(u.key),n.track({type:1,doc:u})}return{aa:s,la:n,Zi:a,mutatedKeys:o}}ha(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const o=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const s=e.la.L_();s.sort((u,f)=>function(y,S){const I=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ft()}};return I(y)-I(S)}(u.type,f.type)||this._a(u.doc,f.doc)),this.Pa(n),i=null!=i&&i;const a=t&&!i?this.Ia():[],c=0===this.oa.size&&this.current&&!i?1:0,l=c!==this.sa;return this.sa=c,0!==s.length||l?{snapshot:new x5(this.query,e.aa,o,s,e.mutatedKeys,0===c,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ta:a}:{Ta:a}}Q_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({aa:this.aa,la:new TK,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(t=>this.ia=this.ia.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.ia=this.ia.delete(t)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=sn(),this.aa.forEach(n=>{this.Ea(n.key)&&(this.oa=this.oa.add(n.key))});const t=[];return e.forEach(n=>{this.oa.has(n)||t.push(new NK(n))}),this.oa.forEach(n=>{e.has(n)||t.push(new wK(n))}),t}da(e){this.ia=e.ls,this.oa=sn();const t=this.ca(e.documents);return this.applyChanges(t,!0)}Aa(){return x5.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,0===this.sa,this.hasCachedResults)}}class qAe{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class jAe{constructor(e){this.key=e,this.Ra=!1}}class ZAe{constructor(e,t,n,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Va={},this.ma=new W3(a=>WZ(a),v9),this.fa=new Map,this.ga=new Set,this.pa=new H1(Ye.comparator),this.ya=new Map,this.wa=new rw,this.Sa={},this.ba=new Map,this.Da=W6.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return!0===this.Ca}}function YAe(r,e){return Bw.apply(this,arguments)}function Bw(){return Bw=E(function*(r,e){const t=function hN(r){const e=je(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=kK.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ibe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=QAe.bind(null,e),e.Va.a_=$Ae.bind(null,e.eventManager),e.Va.Fa=GAe.bind(null,e.eventManager),e}(r);let n,i;const o=t.ma.get(e);if(o)n=o.targetId,t.sharedClientState.addLocalQueryTarget(n),i=o.view.Aa();else{const s=yield function A5(r,e){const t=je(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.qr.getTargetData(n,e).next(o=>o?(i=o,se.resolve(i)):t.qr.allocateTargetId(n).next(s=>(i=new j3(e,s,"TargetPurposeListen",n.currentSequenceNumber),t.qr.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.ts.get(n.targetId);return(null===i||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ts=t.ts.insert(n.targetId,n),t.ns.set(e,n.targetId)),n})}(t.localStore,ho(e)),a=t.sharedClientState.addLocalQueryTarget(s.targetId);n=s.targetId,i=yield function Ww(r,e,t,n,i){return qw.apply(this,arguments)}(t,e,n,"current"===a,s.resumeToken),t.isPrimaryClient&&N_(t.remoteStore,s)}return i}),Bw.apply(this,arguments)}function qw(){return qw=E(function*(r,e,t,n,i){r.va=(f,g,y)=>{return(S=E(function*(R,U,$,oe){let _e=U.view.ca($);_e.Zi&&(_e=yield O_(R.localStore,U.query,!1).then(({documents:rn})=>U.view.ca(rn,_e)));const Te=oe&&oe.targetChanges.get(U.targetId),Fe=oe&&null!=oe.targetMismatches.get(U.targetId),mt=U.view.applyChanges(_e,R.isPrimaryClient,Te,Fe);return nN(R,U.targetId,mt.Ta),mt.snapshot}),function I(R,U,$,oe){return S.apply(this,arguments)})(r,f,g,y);var S};const o=yield O_(r.localStore,e,!0),s=new IK(e,o.ls),a=s.ca(o.documents),c=A9.createSynthesizedTargetChangeForCurrentChange(t,n&&"Offline"!==r.onlineState,i),l=s.applyChanges(a,r.isPrimaryClient,c);nN(r,t,l.Ta);const u=new qAe(e,t,s);return r.ma.set(e,u),r.fa.has(t)?r.fa.get(t).push(e):r.fa.set(t,[e]),l.snapshot}),qw.apply(this,arguments)}function KAe(r,e){return jw.apply(this,arguments)}function jw(){return jw=E(function*(r,e){const t=je(r),n=t.ma.get(e),i=t.fa.get(n.targetId);if(i.length>1)return t.fa.set(n.targetId,i.filter(o=>!v9(o,e))),void t.ma.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(n.targetId),t.sharedClientState.isActiveQueryTarget(n.targetId)||(yield b5(t.localStore,n.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(n.targetId),F9(t.remoteStore,n.targetId),L5(t,n.targetId)}).catch(el))):(L5(t,n.targetId),yield b5(t.localStore,n.targetId,!0))}),jw.apply(this,arguments)}function Zw(){return Zw=E(function*(r,e,t){const n=function gN(r){const e=je(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=JAe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ebe.bind(null,e),e}(r);try{const i=yield function(s,a){const c=je(s),l=_r.now(),u=a.reduce((y,S)=>y.add(S.key),sn());let f,g;return c.persistence.runTransaction("Locally write mutations","readwrite",y=>{let S=Lo(),I=sn();return c.ss.getEntries(y,u).next(R=>{S=R,S.forEach((U,$)=>{$.isValidDocument()||(I=I.add(U))})}).next(()=>c.localDocuments.getOverlayedDocuments(y,S)).next(R=>{f=R;const U=[];for(const $ of a){const oe=OTe($,f.get($.key).overlayedDocument);null!=oe&&U.push(new q3($.key,oe,NZ(oe.value.mapValue),dr.exists(!0)))}return c.mutationQueue.addMutationBatch(y,l,U,a)}).next(R=>{g=R;const U=R.applyToLocalDocumentSet(f,I);return c.documentOverlayCache.saveOverlays(y,R.batchId,U)})}).then(()=>({batchId:g.batchId,changes:YZ(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,a,c){let l=s.Sa[s.currentUser.toKey()];l||(l=new H1(Yt)),l=l.insert(a,c),s.Sa[s.currentUser.toKey()]=l}(n,i.batchId,t),yield Z3(n,i.changes),yield N5(n.remoteStore)}catch(i){const o=k5(i,"Failed to persist write");t.reject(o)}}),Zw.apply(this,arguments)}function kK(r,e){return Yw.apply(this,arguments)}function Yw(){return Yw=E(function*(r,e){const t=je(r);try{const n=yield function _Ae(r,e){const t=je(r),n=e.snapshotVersion;let i=t.ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const s=t.ss.newChangeBuffer({trackRemovals:!0});i=t.ts;const a=[];e.targetChanges.forEach((u,f)=>{const g=i.get(f);if(!g)return;a.push(t.qr.removeMatchingKeys(o,u.removedDocuments,f).next(()=>t.qr.addMatchingKeys(o,u.addedDocuments,f)));let y=g.withSequenceNumber(o.currentSequenceNumber);var I,R,U;null!==e.targetMismatches.get(f)?y=y.withResumeToken(Pi.EMPTY_BYTE_STRING,vt.min()).withLastLimboFreeSnapshotVersion(vt.min()):u.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(u.resumeToken,n)),i=i.insert(f,y),R=y,U=u,(0===(I=g).resumeToken.approximateByteSize()||R.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=3e8||U.addedDocuments.size+U.modifiedDocuments.size+U.removedDocuments.size>0)&&a.push(t.qr.updateTargetData(o,y))});let c=Lo(),l=sn();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,u))}),a.push(function uK(r,e,t){let n=sn(),i=sn();return t.forEach(o=>n=n.add(o)),e.getEntries(r,n).next(o=>{let s=Lo();return t.forEach((a,c)=>{const l=o.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(vt.min())?(e.removeEntry(a,c.readTime),s=s.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||0===c.version.compareTo(l.version)&&l.hasPendingWrites?(e.addEntry(c),s=s.insert(a,c)):Pe("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{us:s,cs:i}})}(o,s,e.documentUpdates).next(u=>{c=u.us,l=u.cs})),!n.isEqual(vt.min())){const u=t.qr.getLastRemoteSnapshotVersion(o).next(f=>t.qr.setTargetsMetadata(o,o.currentSequenceNumber,n));a.push(u)}return se.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,c,l)).next(()=>c)}).then(o=>(t.ts=i,o))}(t.localStore,e);e.targetChanges.forEach((i,o)=>{const s=t.ya.get(o);s&&(gt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.Ra=!0:i.modifiedDocuments.size>0?gt(s.Ra):i.removedDocuments.size>0&&(gt(s.Ra),s.Ra=!1))}),yield Z3(t,n,e)}catch(n){yield el(n)}}),Yw.apply(this,arguments)}function RK(r,e,t){const n=je(r);if(n.isPrimaryClient&&0===t||!n.isPrimaryClient&&1===t){const i=[];n.ma.forEach((o,s)=>{const a=s.view.Q_(e);a.snapshot&&i.push(a.snapshot)}),function(s,a){const c=je(s);c.onlineState=a;let l=!1;c.queries.forEach((u,f)=>{for(const g of f.listeners)g.Q_(a)&&(l=!0)}),l&&$w(c)}(n.eventManager,e),i.length&&n.Va.a_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function QAe(r,e,t){return Kw.apply(this,arguments)}function Kw(){return Kw=E(function*(r,e,t){const n=je(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.ya.get(e),o=i&&i.key;if(o){let s=new H1(Ye.comparator);s=s.insert(o,er.newNoDocument(o,vt.min()));const a=sn().add(o),c=new T9(vt.min(),new Map,new H1(Yt),s,a);yield kK(n,c),n.pa=n.pa.remove(o),n.ya.delete(e),rN(n)}else yield b5(n.localStore,e,!1).then(()=>L5(n,e,t)).catch(el)}),Kw.apply(this,arguments)}function JAe(r,e){return Xw.apply(this,arguments)}function Xw(){return Xw=E(function*(r,e){const t=je(r),n=e.batch.batchId;try{const i=yield function mAe(r,e){const t=je(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=t.ss.newChangeBuffer({trackRemovals:!0});return function(a,c,l,u){const f=l.batch,g=f.keys();let y=se.resolve();return g.forEach(S=>{y=y.next(()=>u.getEntry(c,S)).next(I=>{const R=l.docVersions.get(S);gt(null!==R),I.version.compareTo(R)<0&&(f.applyToRemoteDocument(I,l),I.isValidDocument()&&(I.setReadTime(l.commitVersion),u.addEntry(I)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(c,f))}(t,n,e,o).next(()=>o.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(a){let c=sn();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}(t.localStore,e);tN(t,n,null),eN(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),yield Z3(t,i)}catch(i){yield el(i)}}),Xw.apply(this,arguments)}function ebe(r,e,t){return Qw.apply(this,arguments)}function Qw(){return Qw=E(function*(r,e,t){const n=je(r);try{const i=yield function(s,a){const c=je(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let u;return c.mutationQueue.lookupMutationBatch(l,a).next(f=>(gt(null!==f),u=f.keys(),c.mutationQueue.removeMutationBatch(l,f))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,u,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,u)).next(()=>c.localDocuments.getDocuments(l,u))})}(n.localStore,e);tN(n,e,t),eN(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),yield Z3(n,i)}catch(i){yield el(i)}}),Qw.apply(this,arguments)}function eN(r,e){(r.ba.get(e)||[]).forEach(t=>{t.resolve()}),r.ba.delete(e)}function tN(r,e,t){const n=je(r);let i=n.Sa[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),n.Sa[n.currentUser.toKey()]=i}}function L5(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.fa.get(e))r.ma.delete(n),t&&r.Va.Fa(n,t);r.fa.delete(e),r.isPrimaryClient&&r.wa.Rr(e).forEach(n=>{r.wa.containsKey(n)||xK(r,n)})}function xK(r,e){r.ga.delete(e.path.canonicalString());const t=r.pa.get(e);null!==t&&(F9(r.remoteStore,t),r.pa=r.pa.remove(e),r.ya.delete(t),rN(r))}function nN(r,e,t){for(const n of t)n instanceof wK?(r.wa.addReference(n.key,e),nbe(r,n)):n instanceof NK?(Pe("SyncEngine","Document no longer in limbo: "+n.key),r.wa.removeReference(n.key,e),r.wa.containsKey(n.key)||xK(r,n.key)):ft()}function nbe(r,e){const t=e.key,n=t.path.canonicalString();r.pa.get(t)||r.ga.has(n)||(Pe("SyncEngine","New document in limbo: "+t),r.ga.add(n),rN(r))}function rN(r){for(;r.ga.size>0&&r.pa.size<r.maxConcurrentLimboResolutions;){const e=r.ga.values().next().value;r.ga.delete(e);const t=new Ye($n.fromString(e)),n=r.Da.next();r.ya.set(n,new jAe(t)),r.pa=r.pa.insert(t,n),N_(r.remoteStore,new j3(ho(g5(t.path)),n,"TargetPurposeLimboResolution",hs._e))}}function Z3(r,e,t){return iN.apply(this,arguments)}function iN(){return iN=E(function*(r,e,t){const n=je(r),i=[],o=[],s=[];var a;n.ma.isEmpty()||(n.ma.forEach((a,c)=>{s.push(n.va(c,e,t).then(l=>{if((l||t)&&n.isPrimaryClient&&n.sharedClientState.updateQueryState(c.targetId,l?.fromCache?"not-current":"current"),l){i.push(l);const u=cw.Qi(c.targetId,l);o.push(u)}}))}),yield Promise.all(s),n.Va.a_(i),yield(a=E(function*(l,u){const f=je(l);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>se.forEach(u,y=>se.forEach(y.ki,S=>f.persistence.referenceDelegate.addReference(g,y.targetId,S)).next(()=>se.forEach(y.qi,S=>f.persistence.referenceDelegate.removeReference(g,y.targetId,S)))))}catch(g){if(!tl(g))throw g;Pe("LocalStore","Failed to update sequence numbers: "+g)}for(const g of u){const y=g.targetId;if(!g.fromCache){const S=f.ts.get(y),R=S.withLastLimboFreeSnapshotVersion(S.snapshotVersion);f.ts=f.ts.insert(y,R)}}}),function c(l,u){return a.apply(this,arguments)})(n.localStore,o))}),iN.apply(this,arguments)}function rbe(r,e){return oN.apply(this,arguments)}function oN(){return oN=E(function*(r,e){const t=je(r);if(!t.currentUser.isEqual(e)){Pe("SyncEngine","User change. New user:",e.toKey());const n=yield cK(t.localStore,e);t.currentUser=e,(o=t).ba.forEach(a=>{a.forEach(c=>{c.reject(new Oe(ue.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),o.ba.clear(),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield Z3(t,n._s)}var o}),oN.apply(this,arguments)}function ibe(r,e){const t=je(r),n=t.ya.get(e);if(n&&n.Ra)return sn().add(n.key);{let i=sn();const o=t.fa.get(e);if(!o)return i;for(const s of o){const a=t.ma.get(s);i=i.unionWith(a.view.ua)}return i}}class k_{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return E(function*(){t.serializer=V9(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return function aK(r,e,t,n){return new pAe(r,e,t,n)}(this.persistence,new sK,e.initialUser,this.serializer)}createPersistence(e){return new iw(E_.jr,this.serializer)}createSharedClientState(e){return new mK}terminate(){var e=this;return E(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class z5{initialize(e,t){var n=this;return E(function*(){n.localStore||(n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=i=>RK(n.syncEngine,i,1),n.remoteStore.remoteSyncer.handleCredentialChange=rbe.bind(null,n.syncEngine),yield function Lw(r,e){return zw.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient))})()}createEventManager(e){return new UAe}createDatastore(e){const t=V9(e.databaseInfo.databaseId),n=new SAe(e.databaseInfo);return new AAe(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return n=this.localStore,i=this.datastore,o=e.asyncQueue,s=t=>RK(this.syncEngine,t,0),a=_K.D()?new _K:new MAe,new NAe(n,i,o,s,a);var n,i,o,s,a}createSyncEngine(e,t){return function(i,o,s,a,c,l,u){const f=new ZAe(i,o,s,a,c,l);return u&&(f.Ca=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=E(function*(n){const i=je(n);Pe("RemoteStore","RemoteStore shutting down."),i.C_.add(5),yield w5(i),i.F_.shutdown(),i.M_.set("Unknown")}),function t(n){return e.apply(this,arguments)})(this.remoteStore);var e}}class R_{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):$r("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class _be{constructor(e,t,n,i){var o=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Fi.UNAUTHENTICATED,this.clientId=aZ.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,function(){var s=E(function*(a){Pe("FirestoreClient","Received user=",a.uid),yield o.authCredentialListener(a),o.user=a});return function(a){return s.apply(this,arguments)}}()),this.appCheckCredentials.start(n,s=>(Pe("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}getConfiguration(){var e=this;return E(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Oe(ue.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new Ei;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(E(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(n){const i=k5(n,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function x_(r,e){return pN.apply(this,arguments)}function pN(){return pN=E(function*(r,e){r.asyncQueue.verifyOperationInProgress(),Pe("FirestoreClient","Initializing OfflineComponentProvider");const t=yield r.getConfiguration();yield e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(function(){var i=E(function*(o){n.isEqual(o)||(yield cK(e.localStore,o),n=o)});return function(o){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}),pN.apply(this,arguments)}function mN(r,e){return _N.apply(this,arguments)}function _N(){return _N=E(function*(r,e){r.asyncQueue.verifyOperationInProgress();const t=yield function CN(r){return vN.apply(this,arguments)}(r);Pe("FirestoreClient","Initializing OnlineComponentProvider");const n=yield r.getConfiguration();yield e.initialize(t,n),r.setCredentialChangeListener(i=>OK(e.remoteStore,i)),r.setAppCheckTokenChangeListener((i,o)=>OK(e.remoteStore,o)),r._onlineComponents=e}),_N.apply(this,arguments)}function vN(){return vN=E(function*(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){Pe("FirestoreClient","Using user provided OfflineComponentProvider");try{yield x_(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function FK(r){return"FirebaseError"===r.name?r.code===ue.FAILED_PRECONDITION||r.code===ue.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||22===r.code||20===r.code||11===r.code}(t))throw t;fs("Error using user provided cache. Falling back to memory cache: "+t),yield x_(r,new k_)}}else Pe("FirestoreClient","Using default OfflineComponentProvider"),yield x_(r,new k_);return r._offlineComponents}),vN.apply(this,arguments)}function L_(r){return yN.apply(this,arguments)}function yN(){return yN=E(function*(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(Pe("FirestoreClient","Using user provided OnlineComponentProvider"),yield mN(r,r._uninitializedComponentsProvider._online)):(Pe("FirestoreClient","Using default OnlineComponentProvider"),yield mN(r,new z5))),r._onlineComponents}),yN.apply(this,arguments)}function V5(r){return EN.apply(this,arguments)}function EN(){return EN=E(function*(r){const e=yield L_(r),t=e.eventManager;return t.onListen=YAe.bind(null,e.syncEngine),t.onUnlisten=KAe.bind(null,e.syncEngine),t}),EN.apply(this,arguments)}function qK(r){const e={};return void 0!==r.timeoutSeconds&&(e.timeoutSeconds=r.timeoutSeconds),e}const jK=new Map;function PN(r,e,t){if(!t)throw new Oe(ue.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function ZK(r){if(!Ye.isDocumentKey(r))throw new Oe(ue.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function YK(r){if(Ye.isDocumentKey(r))throw new Oe(ue.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function z_(r){if(void 0===r)return"undefined";if(null===r)return"null";if("string"==typeof r)return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if("number"==typeof r||"boolean"==typeof r)return""+r;if("object"==typeof r){if(r instanceof Array)return"an array";{const e=(n=r).constructor?n.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var n;return"function"==typeof r?"a function":ft()}function In(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new Oe(ue.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=z_(r);throw new Oe(ue.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}class XK{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Oe(ue.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Oe(ue.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function bbe(r,e,t,n){if(!0===e&&!0===n)throw new Oe(ue.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=qK(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(o){if(void 0!==o.timeoutSeconds){if(isNaN(o.timeoutSeconds))throw new Oe(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new Oe(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new Oe(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class U9{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new XK({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Oe(ue.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Oe(ue.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new XK(e),void 0!==e.credentials&&(this._authCredentials=function(n){if(!n)return new SOe;switch(n.type){case"firstParty":return new bOe(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Oe(ue.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=jK.get(t);n&&(Pe("ComponentProvider","Removing Datastore"),jK.delete(t),n.terminate())}(this),Promise.resolve()}}function QK(r,e,t,n={}){var i;const o=(r=In(r,U9))._getSettings(),s=`${e}:${t}`;if("firestore.googleapis.com"!==o.host&&o.host!==s&&fs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),r._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),n.mockUserToken){let a,c;if("string"==typeof n.mockUserToken)a=n.mockUserToken,c=Fi.MOCK_USER;else{a=function fve(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=r.iat||0,o=r.sub||r.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},r);return[Jp(JSON.stringify({alg:"none",type:"JWT"})),Jp(JSON.stringify(s)),""].join(".")}(n.mockUserToken,null===(i=r._app)||void 0===i?void 0:i.options.projectId);const l=n.mockUserToken.sub||n.mockUserToken.user_id;if(!l)throw new Oe(ue.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Fi(l)}r._authCredentials=new OOe(new oZ(a,c))}}class p2{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new p2(this.firestore,e,this._query)}}class Br{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Hc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Br(this.firestore,e,this._key)}}class Hc extends p2{constructor(e,t,n){super(e,t,g5(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Br(this.firestore,null,new Ye(e))}withConverter(e){return new Hc(this.firestore,e,this._path)}}function wbe(r,e,...t){if(r=oi(r),PN("collection","path",e),r instanceof U9){const n=$n.fromString(e,...t);return YK(n),new Hc(r,null,n)}{if(!(r instanceof Br||r instanceof Hc))throw new Oe(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child($n.fromString(e,...t));return YK(n),new Hc(r.firestore,null,n)}}function JK(r,e,...t){if(r=oi(r),1===arguments.length&&(e=aZ.newId()),PN("doc","path",e),r instanceof U9){const n=$n.fromString(e,...t);return ZK(n),new Br(r,null,new Ye(n))}{if(!(r instanceof Br||r instanceof Hc))throw new Oe(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child($n.fromString(e,...t));return ZK(n),new Br(r.firestore,r instanceof Hc?r.converter:null,new Ye(n))}}class Nbe{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new Cw(this,"async_queue_retry"),this.iu=()=>{const t=w_();t&&Pe("AsyncQueue","Visibility state changed to "+t.visibilityState),this.zo.Qo()};const e=w_();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const t=w_();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const t=new Ei;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}_u(){var e=this;return E(function*(){if(0!==e.Ya.length){try{yield e.Ya[0](),e.Ya.shift(),e.zo.reset()}catch(t){if(!tl(t))throw t;Pe("AsyncQueue","Operation failed with retryable error: "+t)}e.Ya.length>0&&e.zo.ko(()=>e._u())}})()}ou(e){const t=this.Ja.then(()=>(this.tu=!0,e().catch(n=>{throw this.eu=n,this.tu=!1,$r("INTERNAL UNHANDLED ERROR: ",function(s){let a=s.message||"";return s.stack&&(a=s.stack.includes(s.message)?s.stack:s.message+"\n"+s.stack),a}(n)),n}).then(n=>(this.tu=!1,n))));return this.Ja=t,t}enqueueAfterDelay(e,t,n){this.su(),this.ru.indexOf(e)>-1&&(t=0);const i=Dw.createAndSchedule(this,e,t,n,o=>this.au(o));return this.Xa.push(i),i}su(){this.eu&&ft()}verifyOperationInProgress(){}uu(){var e=this;return E(function*(){let t;do{t=e.Ja,yield t}while(t!==e.Ja)})()}cu(e){for(const t of this.Xa)if(t.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.Xa)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const t=this.Xa.indexOf(e);this.Xa.splice(t,1)}}function SN(r){return function(t,n){if("object"!=typeof t||null===t)return!1;const i=t;for(const o of["next","error","complete"])if(o in i&&"function"==typeof i[o])return!0;return!1}(r)}class F1 extends U9{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new Nbe,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||tX(this),this._firestoreClient.terminate()}}function kbe(r,e){const n="string"==typeof r?r:e||"(default)",i=sm("object"==typeof r?r:_O(),"firestore").getImmediate({identifier:n});if(!i._initialized){const o=(r=>{const e=sW("firestore");if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return"["===e[0]?[e.substring(1,t-1),n]:[e.substring(0,t),n]})();o&&QK(i,...o)}return i}function Wr(r){return r._firestoreClient||tX(r),r._firestoreClient.verifyNotTerminated(),r._firestoreClient}function tX(r){var e,t,n;const i=r._freezeSettings(),o=(c=(null===(e=r._app)||void 0===e?void 0:e.options.appId)||"",new iTe(r._databaseId,c,r._persistenceKey,(u=i).host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,qK(u.experimentalLongPollingOptions),u.useFetchStreams));var c,u;r._firestoreClient=new _be(r._authCredentials,r._appCheckCredentials,r._queue,o),null!==(t=i.localCache)&&void 0!==t&&t._offlineComponentProvider&&null!==(n=i.localCache)&&void 0!==n&&n._onlineComponentProvider&&(r._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}class j6{constructor(e){this._byteString=e}static fromBase64String(e){try{return new j6(Pi.fromBase64String(e))}catch(t){throw new Oe(ue.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new j6(Pi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class H5{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Oe(ue.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new fr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class D_{constructor(e){this._methodName=e}}class ON{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Oe(ue.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Oe(ue.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Yt(this._lat,e._lat)||Yt(this._long,e._long)}}const xbe=/^__.*__$/;class Lbe{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new q3(e,this.data,this.fieldMask,t,this.fieldTransforms):new v5(e,this.data,t,this.fieldTransforms)}}class iX{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new q3(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function oX(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ft()}}class V_{constructor(e,t,n,i,o,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===o&&this.Pu(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new V_(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Tu({path:n,du:!1});return i.Au(e),i}Ru(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Tu({path:n,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return F_(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(0===e.length)throw this.mu("Document fields must not be empty");if(oX(this.Iu)&&xbe.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class zbe{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||V9(e)}pu(e,t,n,i=!1){return new V_({Iu:e,methodName:t,gu:n,path:fr.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function F5(r){const e=r._freezeSettings(),t=V9(r._databaseId);return new zbe(r._databaseId,!!e.ignoreUndefinedProperties,t)}function TN(r,e,t,n,i,o={}){const s=r.pu(o.merge||o.mergeFields?2:0,e,t,i);bN("Data must be an object, but it was:",s,n);const a=uX(n,s);let c,l;if(o.merge)c=new xo(s.fieldMask),l=s.fieldTransforms;else if(o.mergeFields){const u=[];for(const f of o.mergeFields){const g=B9(e,f,t);if(!s.contains(g))throw new Oe(ue.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);dX(u,g)||u.push(g)}c=new xo(u),l=s.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,l=s.fieldTransforms;return new Lbe(new g2(a),c,l)}class G9 extends D_{_toFieldTransform(e){if(2!==e.Iu)throw e.mu(1===e.Iu?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof G9}}class AN extends D_{_toFieldTransform(e){return new P9(e.path,new _5)}isEqual(e){return e instanceof AN}}function Z6(r,e){if(fX(r=oi(r)))return bN("Unsupported field value:",e,r),uX(r,e);if(r instanceof D_)return function(n,i){if(!oX(i.Iu))throw i.mu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(r,e),null;if(void 0===r&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.du&&4!==e.Iu)throw e.mu("Nested arrays are not supported");return function(n,i){const o=[];let s=0;for(const a of n){let c=Z6(a,i.Vu(s));null==c&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(r,e)}return function(n,i){if(null===(n=oi(n)))return{nullValue:"NULL_VALUE"};if("number"==typeof n)return JZ(i.serializer,n);if("boolean"==typeof n)return{booleanValue:n};if("string"==typeof n)return{stringValue:n};if(n instanceof Date){const o=_r.fromDate(n);return{timestampValue:M5(i.serializer,o)}}if(n instanceof _r){const o=new _r(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:M5(i.serializer,o)}}if(n instanceof ON)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof j6)return{bytesValue:yY(i.serializer,n._byteString)};if(n instanceof Br){const o=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(o))throw i.mu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:qb(n.firestore._databaseId||i.databaseId,n._key.path)}}throw i.mu(`Unsupported field value: ${z_(n)}`)}(r,e)}function uX(r,e){const t={};return MZ(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):nl(r,(n,i)=>{const o=Z6(i,e.Eu(n));null!=o&&(t[n]=o)}),{mapValue:{fields:t}}}function fX(r){return!("object"!=typeof r||null===r||r instanceof Array||r instanceof Date||r instanceof _r||r instanceof ON||r instanceof j6||r instanceof Br||r instanceof D_)}function bN(r,e,t){if(!fX(t)||"object"!=typeof(i=t)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const n=z_(t);throw e.mu("an object"===n?r+" a custom object":r+" "+n)}var i}function B9(r,e,t){if((e=oi(e))instanceof H5)return e._internalPath;if("string"==typeof e)return H_(r,e);throw F_("Field path arguments must be of type string or ",r,!1,void 0,t)}const Fbe=new RegExp("[~\\*/\\[\\]]");function H_(r,e,t){if(e.search(Fbe)>=0)throw F_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new H5(...e.split("."))._internalPath}catch{throw F_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function F_(r,e,t,n,i){const o=n&&!n.isEmpty(),s=void 0!==i;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${n}`),s&&(c+=` in document ${i}`),c+=")"),new Oe(ue.INVALID_ARGUMENT,a+r+c)}function dX(r,e){return r.some(t=>t.isEqual(e))}class wN{constructor(e,t,n,i,o){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Br(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Ube(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(U_("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Ube extends wN{data(){return super.data()}}function U_(r,e){return"string"==typeof e?H_(r,e):e instanceof H5?e._internalPath:e._delegate._internalPath}function hX(r){if("L"===r.limitType&&0===r.explicitOrderBy.length)throw new Oe(ue.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class NN{}class IN extends NN{}function $be(r,e,...t){let n=[];e instanceof NN&&n.push(e),n=n.concat(t),function(o){const s=o.filter(c=>c instanceof U5).length,a=o.filter(c=>c instanceof W9).length;if(s>1||s>0&&a>0)throw new Oe(ue.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)r=i._apply(r);return r}class W9 extends IN{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new W9(e,t,n)}_apply(e){const t=this._parse(e);return _X(e._query,t),new p2(e.firestore,e.converter,Vb(e._query,t))}_parse(e){const t=F5(e.firestore);return function(o,s,a,c,l,u,f){let g;if(l.isKeyField()){if("array-contains"===u||"array-contains-any"===u)throw new Oe(ue.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if("in"===u||"not-in"===u){mX(f,u);const y=[];for(const S of f)y.push(pX(c,o,S));g={arrayValue:{values:y}}}else g=pX(c,o,f)}else"in"!==u&&"not-in"!==u&&"array-contains-any"!==u||mX(f,u),g=function lX(r,e,t,n=!1){return Z6(t,r.pu(n?4:3,e))}(a,"where",f,"in"===u||"not-in"===u);return Nn.create(l,u,g)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}function Gbe(r,e,t){const n=e,i=U_("where",r);return W9._create(i,n,t)}class U5 extends NN{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new U5(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return 1===t.length?t[0]:f1.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(i,o){let s=i;const a=o.getFlattenedFilters();for(const c of a)_X(s,c),s=Vb(s,c)}(e._query,t),new p2(e.firestore,e.converter,Vb(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class kN extends IN{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new kN(e,t)}_apply(e){const t=function(i,o,s){if(null!==i.startAt)throw new Oe(ue.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new Oe(ue.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new _9(o,s)}(e._query,this._field,this._direction);return new p2(e.firestore,e.converter,function(i,o){const s=i.explicitOrderBy.concat([o]);return new B3(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function Bbe(r,e="asc"){const t=e,n=U_("orderBy",r);return kN._create(n,t)}class $_ extends IN{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new $_(e,t,n)}_apply(e){return new p2(e.firestore,e.converter,l_(e._query,this._limit,this._limitType))}}function Wbe(r){return function KK(r,e){if(e<=0)throw new Oe(ue.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${e}.`)}("limit",r),$_._create("limit",r,"F")}function pX(r,e,t){if("string"==typeof(t=oi(t))){if(""===t)throw new Oe(ue.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Db(e)&&-1!==t.indexOf("/"))throw new Oe(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child($n.fromString(t));if(!Ye.isDocumentKey(n))throw new Oe(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return z6(r,new Ye(n))}if(t instanceof Br)return z6(r,t._key);throw new Oe(ue.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${z_(t)}.`)}function mX(r,e){if(!Array.isArray(r)||0===r.length)throw new Oe(ue.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function _X(r,e){const t=function(i,o){for(const s of i)for(const a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(r.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new Oe(ue.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class qbe{convertValue(e,t="none"){switch(ol(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ar(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(G3(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw ft()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return nl(e,(i,o)=>{n[i]=this.convertValue(o,t)}),n}convertGeoPoint(e){return new ON(Ar(e.latitude),Ar(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=r_(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(h9(e));default:return null}}convertTimestamp(e){const t=rl(e);return new _r(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=$n.fromString(e);gt(NY(n));const i=new L6(n.get(1),n.get(3)),o=new Ye(n.popFirst(5));return i.isEqual(t)||$r(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}function RN(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class Y6{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class $5 extends wN{constructor(e,t,n,i,o,s){super(e,t,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new W_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(U_("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class W_ extends $5{data(e={}){return super.data(e)}}class G5{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Y6(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new W_(this._firestore,this._userDataWriter,n.key,n,new Y6(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Oe(ue.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>({type:"added",doc:new W_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Y6(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:s++}))}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||3!==a.type).map(a=>{const c=new W_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Y6(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,u=-1;return 0!==a.type&&(l=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),1!==a.type&&(s=s.add(a.doc),u=s.indexOf(a.doc.key)),{type:Zbe(a.type),doc:c,oldIndex:l,newIndex:u}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Zbe(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ft()}}function Ybe(r){r=In(r,Br);const e=In(r.firestore,F1);return function BK(r,e,t={}){const n=new Ei;return r.asyncQueue.enqueueAndForget(E(function*(){return function(o,s,a,c,l){const u=new R_({next:g=>{s.enqueueAndForget(()=>Fw(o,f));const y=g.docs.has(a);!y&&g.fromCache?l.reject(new Oe(ue.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&g.fromCache&&c&&"server"===c.source?l.reject(new Oe(ue.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(g)},error:g=>l.reject(g)}),f=new Gw(g5(a.path),u,{includeMetadataChanges:!0,J_:!0});return Vw(o,f)}(yield V5(r),r.asyncQueue,e,t,n)})),n.promise}(Wr(e),r._key).then(t=>xN(e,r,t))}class gl extends qbe{constructor(e){super(),this.firestore=e}convertBytes(e){return new j6(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Br(this.firestore,null,t)}}function Kbe(r){r=In(r,p2);const e=In(r.firestore,F1),t=Wr(e),n=new gl(e);return hX(r._query),function WK(r,e,t={}){const n=new Ei;return r.asyncQueue.enqueueAndForget(E(function*(){return function(o,s,a,c,l){const u=new R_({next:g=>{s.enqueueAndForget(()=>Fw(o,f)),g.fromCache&&"server"===c.source?l.reject(new Oe(ue.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(g)},error:g=>l.reject(g)}),f=new Gw(a,u,{includeMetadataChanges:!0,J_:!0});return Vw(o,f)}(yield V5(r),r.asyncQueue,e,t,n)})),n.promise}(t,r._query).then(i=>new G5(e,n,r,i))}function Xbe(r,e,t){r=In(r,Br);const n=In(r.firestore,F1),i=RN(r.converter,e,t);return q9(n,[TN(F5(n),"setDoc",r._key,i,null!==r.converter,t).toMutation(r._key,dr.none())])}function Qbe(r,e,t,...n){r=In(r,Br);const i=In(r.firestore,F1),o=F5(i);let s;return s="string"==typeof(e=oi(e))||e instanceof H5?function cX(r,e,t,n,i,o){const s=r.pu(1,e,t),a=[B9(e,n,t)],c=[i];if(o.length%2!=0)throw new Oe(ue.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<o.length;g+=2)a.push(B9(e,o[g])),c.push(o[g+1]);const l=[],u=g2.empty();for(let g=a.length-1;g>=0;--g)if(!dX(l,a[g])){const y=a[g];let S=c[g];S=oi(S);const I=s.Ru(y);if(S instanceof G9)l.push(y);else{const R=Z6(S,I);null!=R&&(l.push(y),u.set(y,R))}}const f=new xo(l);return new iX(u,f,s.fieldTransforms)}(o,"updateDoc",r._key,e,t,n):function aX(r,e,t,n){const i=r.pu(1,e,t);bN("Data must be an object, but it was:",i,n);const o=[],s=g2.empty();nl(n,(c,l)=>{const u=H_(e,c,t);l=oi(l);const f=i.Ru(u);if(l instanceof G9)o.push(u);else{const g=Z6(l,f);null!=g&&(o.push(u),s.set(u,g))}});const a=new xo(o);return new iX(s,a,i.fieldTransforms)}(o,"updateDoc",r._key,e),q9(i,[s.toMutation(r._key,dr.exists(!0))])}function Jbe(r){return q9(In(r.firestore,F1),[new y5(r._key,dr.none())])}function ewe(r,e){const t=In(r.firestore,F1),n=JK(r),i=RN(r.converter,e);return q9(t,[TN(F5(r.firestore),"addDoc",n._key,i,null!==r.converter,{}).toMutation(n._key,dr.exists(!1))]).then(()=>n)}function twe(r,...e){var t,n,i;r=oi(r);let o={includeMetadataChanges:!1},s=0;"object"!=typeof e[s]||SN(e[s])||(o=e[s],s++);const a={includeMetadataChanges:o.includeMetadataChanges};if(SN(e[s])){const f=e[s];e[s]=null===(t=f.next)||void 0===t?void 0:t.bind(f),e[s+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),e[s+2]=null===(i=f.complete)||void 0===i?void 0:i.bind(f)}let c,l,u;if(r instanceof Br)l=In(r.firestore,F1),u=g5(r._key.path),c={next:f=>{e[s]&&e[s](xN(l,r,f))},error:e[s+1],complete:e[s+2]};else{const f=In(r,p2);l=In(f.firestore,F1),u=f._query;const g=new gl(l);c={next:y=>{e[s]&&e[s](new G5(l,g,f,y))},error:e[s+1],complete:e[s+2]},hX(r._query)}return function(g,y,S,I){const R=new R_(I),U=new Gw(y,R,S);return g.asyncQueue.enqueueAndForget(E(function*(){return Vw(yield V5(g),U)})),()=>{R.Na(),g.asyncQueue.enqueueAndForget(E(function*(){return Fw(yield V5(g),U)}))}}(Wr(l),u,a,c)}function q9(r,e){return function(n,i){const o=new Ei;return n.asyncQueue.enqueueAndForget(E(function*(){return function XAe(r,e,t){return Zw.apply(this,arguments)}(yield function MN(r){return L_(r).then(e=>e.syncEngine)}(n),i,o)})),o.promise}(Wr(r),e)}function xN(r,e,t){const n=t.docs.get(e._key),i=new gl(r);return new $5(r,i,e._key,n,new Y6(t.hasPendingWrites,t.fromCache),e.converter)}function Fc(){return new AN("serverTimestamp")}!function(e,t=!0){s5=j8,q8(new y6("firestore",(n,{instanceIdentifier:i,options:o})=>{const s=n.getProvider("app").getImmediate(),a=new F1(new TOe(n.getProvider("auth-internal")),new wOe(n.getProvider("app-check-internal")),function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new Oe(ue.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new L6(l.options.projectId,u)}(s,i),s);return o=Object.assign({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),cs(iZ,"4.4.0",e),cs(iZ,"4.4.0","esm2017")}();class pl{constructor(e){return e}}const EX="firestore",zN=new Qe("angularfire2.firestore-instances");function mwe(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new pl(n)}}const _we={provide:class gwe{constructor(){return PO(EX)}},deps:[[new Jo,zN]]},Cwe={provide:pl,useFactory:function pwe(r,e){const t=bW(EX,r,e);return t&&new pl(t)},deps:[[new Jo,zN],Af]};let vwe=(()=>{class r{constructor(){cs("angularfire",cm.full,"fst")}static \u0275fac=function(n){return new(n||r)};static \u0275mod=N2({type:r});static \u0275inj=s2({providers:[Cwe,_we]})}return r})();const Mwe=K1(ewe,!0),Ewe=K1(wbe,!0),Swe=K1(Jbe,!0),j9=K1(JK,!0),Owe=K1(Ybe,!0),Twe=K1(Kbe,!0),Awe=K1(kbe,!0),bwe=K1(Wbe,!0),PX=K1(twe,!0),wwe=K1(Bbe,!0),Z_=K1($be,!0),Nwe=K1(Xbe,!0),Iwe=K1(Qbe,!0),kwe=K1(Gbe,!0),qr=void 0,xwe=["fr",[["AM","PM"],qr,qr],qr,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],qr,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],qr,[["av. J.-C.","ap. J.-C."],qr,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1}, {0}","{1} '\xe0' {0}",qr],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BYN:[qr,"\u0440."],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[qr,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[qr,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[qr,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[qr,"\xa5"],KMF:[qr,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[qr,"$C"],NZD:["$NZ","$"],PHP:[qr,"\u20b1"],RHD:["$RH"],RON:[qr,"L"],RWF:[qr,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[qr,"$T"],TTD:["$TT","$"],TWD:[qr,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[qr,"$"],XPF:["FCFP"],ZMW:[qr,"Kw"]},"ltr",function Rwe(r){const t=Math.floor(Math.abs(r)),n=r.toString().replace(/^[^.]*\.?/,"").length,i=parseInt(r.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 0===t||1===t?1:0===i&&0!==t&&t%1e6==0&&0===n||!(i>=0&&i<=5)?4:5}];function SX(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function dt(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?SX(Object(t),!0).forEach(function(n){Si(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):SX(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function Y_(r){return(Y_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(r)}function OX(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Si(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function DN(r,e){return function Hwe(r){if(Array.isArray(r))return r}(r)||function Uwe(r,e){var t=null==r?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var s,a,n=[],i=!0,o=!1;try{for(t=t.call(r);!(i=(s=t.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(c){o=!0,a=c}finally{try{!i&&null!=t.return&&t.return()}finally{if(o)throw a}}return n}}(r,e)||TX(r,e)||function Gwe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y9(r){return function Vwe(r){if(Array.isArray(r))return VN(r)}(r)||function Fwe(r){if(typeof Symbol<"u"&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||TX(r)||function $we(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function TX(r,e){if(r){if("string"==typeof r)return VN(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if("Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t)return Array.from(r);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return VN(r,e)}}function VN(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}var AX=function(){},HN={},bX={},wX=null,NX={mark:AX,measure:AX};try{typeof window<"u"&&(HN=window),typeof document<"u"&&(bX=document),typeof MutationObserver<"u"&&(wX=MutationObserver),typeof performance<"u"&&(NX=performance)}catch{}var Q_,J_,eC,tC,nC,IX=(HN.navigator||{}).userAgent,kX=void 0===IX?"":IX,ml=HN,tr=bX,RX=wX,X_=NX,Y3=!!tr.documentElement&&!!tr.head&&"function"==typeof tr.addEventListener&&"function"==typeof tr.createElement,xX=~kX.indexOf("MSIE")||~kX.indexOf("Trident/"),K3="___FONT_AWESOME___",LX="fa",zX="svg-inline--fa",K6="data-fa-i2svg",UN="data-fa-pseudo-element",Wwe="data-fa-pseudo-element-pending",$N="data-prefix",GN="data-icon",DX="fontawesome-i2svg",qwe="async",jwe=["HTML","HEAD","STYLE","SCRIPT"],VX=function(){try{return!0}catch{return!1}}(),nr="classic",br="sharp",BN=[nr,br];function K9(r){return new Proxy(r,{get:function(t,n){return n in t?t[n]:t[nr]}})}var X9=K9((Si(Q_={},nr,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit",fakd:"kit","fa-kit":"kit","fa-kit-duotone":"kit"}),Si(Q_,br,{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light",fast:"thin","fa-thin":"thin"}),Q_)),Q9=K9((Si(J_={},nr,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),Si(J_,br,{solid:"fass",regular:"fasr",light:"fasl",thin:"fast"}),J_)),J9=K9((Si(eC={},nr,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),Si(eC,br,{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light",fast:"fa-thin"}),eC)),Zwe=K9((Si(tC={},nr,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),Si(tC,br,{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl","fa-thin":"fast"}),tC)),Ywe=/fa(s|r|l|t|d|b|k|ss|sr|sl|st)?[\-\ ]/,HX="fa-layers-text",Kwe=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,Xwe=K9((Si(nC={},nr,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),Si(nC,br,{900:"fass",400:"fasr",300:"fasl",100:"fast"}),nC)),FX=[1,2,3,4,5,6,7,8,9,10],Qwe=FX.concat([11,12,13,14,15,16,17,18,19,20]),Jwe=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],X6={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},ed=new Set;Object.keys(Q9[nr]).map(ed.add.bind(ed)),Object.keys(Q9[br]).map(ed.add.bind(ed));var eNe=[].concat(BN,Y9(ed),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",X6.GROUP,X6.SWAP_OPACITY,X6.PRIMARY,X6.SECONDARY]).concat(FX.map(function(r){return"".concat(r,"x")})).concat(Qwe.map(function(r){return"w-".concat(r)})),td=ml.FontAwesomeConfig||{};tr&&"function"==typeof tr.querySelector&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(r){var e=DN(r,2),n=e[1],i=function nNe(r){return""===r||"false"!==r&&("true"===r||r)}(function tNe(r){var e=tr.querySelector("script["+r+"]");if(e)return e.getAttribute(r)}(e[0]));null!=i&&(td[n]=i)});var UX={styleDefault:"solid",familyDefault:"classic",cssPrefix:LX,replacementClass:zX,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};td.familyPrefix&&(td.cssPrefix=td.familyPrefix);var B5=dt(dt({},UX),td);B5.autoReplaceSvg||(B5.observeMutations=!1);var _t={};Object.keys(UX).forEach(function(r){Object.defineProperty(_t,r,{enumerable:!0,set:function(t){B5[r]=t,nd.forEach(function(n){return n(_t)})},get:function(){return B5[r]}})}),Object.defineProperty(_t,"familyPrefix",{enumerable:!0,set:function(e){B5.cssPrefix=e,nd.forEach(function(t){return t(_t)})},get:function(){return B5.cssPrefix}}),ml.FontAwesomeConfig=_t;var nd=[],Uc={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1},sNe="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function rd(){for(var r=12,e="";r-- >0;)e+=sNe[62*Math.random()|0];return e}function W5(r){for(var e=[],t=(r||[]).length>>>0;t--;)e[t]=r[t];return e}function WN(r){return r.classList?W5(r.classList):(r.getAttribute("class")||"").split(" ").filter(function(e){return e})}function $X(r){return"".concat(r).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function rC(r){return Object.keys(r||{}).reduce(function(e,t){return e+"".concat(t,": ").concat(r[t].trim(),";")},"")}function qN(r){return r.size!==Uc.size||r.x!==Uc.x||r.y!==Uc.y||r.rotate!==Uc.rotate||r.flipX||r.flipY}var uNe=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-thin: normal 100 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-counter-scale, 0.25));\n          transform: scale(var(--fa-counter-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(var(--fa-li-width, 2em) * -1);\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  -webkit-animation-name: fa-beat;\n          animation-name: fa-beat;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  -webkit-animation-name: fa-bounce;\n          animation-name: fa-bounce;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  -webkit-animation-name: fa-fade;\n          animation-name: fa-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  -webkit-animation-name: fa-beat-fade;\n          animation-name: fa-beat-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  -webkit-animation-name: fa-flip;\n          animation-name: fa-flip;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  -webkit-animation-name: fa-shake;\n          animation-name: fa-shake;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 2s);\n          animation-duration: var(--fa-animation-duration, 2s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));\n          animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    -webkit-animation-delay: -1ms;\n            animation-delay: -1ms;\n    -webkit-animation-duration: 1ms;\n            animation-duration: 1ms;\n    -webkit-animation-iteration-count: 1;\n            animation-iteration-count: 1;\n    -webkit-transition-delay: 0s;\n            transition-delay: 0s;\n    -webkit-transition-duration: 0s;\n            transition-duration: 0s;\n  }\n}\n@-webkit-keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@-webkit-keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@-webkit-keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@-webkit-keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@-webkit-keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@-webkit-keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  -webkit-transform: rotate(var(--fa-rotate-angle, none));\n          transform: rotate(var(--fa-rotate-angle, none));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';function GX(){var r=LX,e=zX,t=_t.cssPrefix,n=_t.replacementClass,i=uNe;if(t!==r||n!==e){var o=new RegExp("\\.".concat(r,"\\-"),"g"),s=new RegExp("\\--".concat(r,"\\-"),"g"),a=new RegExp("\\.".concat(e),"g");i=i.replace(o,".".concat(t,"-")).replace(s,"--".concat(t,"-")).replace(a,".".concat(n))}return i}var BX=!1;function jN(){_t.autoAddCss&&!BX&&(function oNe(r){if(r&&Y3){var e=tr.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=r;for(var t=tr.head.childNodes,n=null,i=t.length-1;i>-1;i--){var o=t[i],s=(o.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(s)>-1&&(n=o)}tr.head.insertBefore(e,n)}}(GX()),BX=!0)}var fNe={mixout:function(){return{dom:{css:GX,insertCss:jN}}},hooks:function(){return{beforeDOMElementCreation:function(){jN()},beforeI2svg:function(){jN()}}}},X3=ml||{};X3[K3]||(X3[K3]={}),X3[K3].styles||(X3[K3].styles={}),X3[K3].hooks||(X3[K3].hooks={}),X3[K3].shims||(X3[K3].shims=[]);var za=X3[K3],WX=[],iC=!1;function id(r){var e=r.tag,t=r.attributes,n=void 0===t?{}:t,i=r.children,o=void 0===i?[]:i;return"string"==typeof r?$X(r):"<".concat(e," ").concat(function aNe(r){return Object.keys(r||{}).reduce(function(e,t){return e+"".concat(t,'="').concat($X(r[t]),'" ')},"").trim()}(n),">").concat(o.map(id).join(""),"</").concat(e,">")}function qX(r,e,t){if(r&&r[e]&&r[e][t])return{prefix:e,iconName:t,icon:r[e][t]}}Y3&&((iC=(tr.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(tr.readyState))||tr.addEventListener("DOMContentLoaded",function r(){tr.removeEventListener("DOMContentLoaded",r),iC=1,WX.map(function(e){return e()})}));var ZN=function(e,t,n,i){var c,l,u,o=Object.keys(e),s=o.length,a=void 0!==i?function(e,t){return function(n,i,o,s){return e.call(t,n,i,o,s)}}(t,i):t;for(void 0===n?(c=1,u=e[o[0]]):(c=0,u=n);c<s;c++)u=a(u,e[l=o[c]],l,e);return u};function YN(r){var e=function pNe(r){for(var e=[],t=0,n=r.length;t<n;){var i=r.charCodeAt(t++);if(i>=55296&&i<=56319&&t<n){var o=r.charCodeAt(t++);56320==(64512&o)?e.push(((1023&i)<<10)+(1023&o)+65536):(e.push(i),t--)}else e.push(i)}return e}(r);return 1===e.length?e[0].toString(16):null}function jX(r){return Object.keys(r).reduce(function(e,t){var n=r[t];return n.icon?e[n.iconName]=n.icon:e[t]=n,e},{})}function KN(r,e){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipHooks,i=void 0!==n&&n,o=jX(e);"function"!=typeof za.hooks.addPack||i?za.styles[r]=dt(dt({},za.styles[r]||{}),o):za.hooks.addPack(r,jX(e)),"fas"===r&&KN("fa",e)}var oC,sC,aC,q5=za.styles,_Ne=za.shims,CNe=(Si(oC={},nr,Object.values(J9[nr])),Si(oC,br,Object.values(J9[br])),oC),XN=null,ZX={},YX={},KX={},XX={},QX={},vNe=(Si(sC={},nr,Object.keys(X9[nr])),Si(sC,br,Object.keys(X9[br])),sC);var JX=function(){var e=function(o){return ZN(q5,function(s,a,c){return s[c]=ZN(a,o,{}),s},{})};ZX=e(function(i,o,s){return o[3]&&(i[o[3]]=s),o[2]&&o[2].filter(function(c){return"number"==typeof c}).forEach(function(c){i[c.toString(16)]=s}),i}),YX=e(function(i,o,s){return i[s]=s,o[2]&&o[2].filter(function(c){return"string"==typeof c}).forEach(function(c){i[c]=s}),i}),QX=e(function(i,o,s){var a=o[2];return i[s]=s,a.forEach(function(c){i[c]=s}),i});var t="far"in q5||_t.autoFetchSvg,n=ZN(_Ne,function(i,o){var s=o[0],a=o[1],c=o[2];return"far"===a&&!t&&(a="fas"),"string"==typeof s&&(i.names[s]={prefix:a,iconName:c}),"number"==typeof s&&(i.unicodes[s.toString(16)]={prefix:a,iconName:c}),i},{names:{},unicodes:{}});KX=n.names,XX=n.unicodes,XN=cC(_t.styleDefault,{family:_t.familyDefault})};function QN(r,e){return(ZX[r]||{})[e]}function Q6(r,e){return(QX[r]||{})[e]}function eQ(r){return KX[r]||{prefix:null,iconName:null}}function Cl(){return XN}(function iNe(r){nd.push(r)})(function(r){XN=cC(r.styleDefault,{family:_t.familyDefault})}),JX();var JN=function(){return{prefix:null,iconName:null,rest:[]}};function cC(r){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).family,n=void 0===t?nr:t;return Q9[n][r]||Q9[n][X9[n][r]]||(r in za.styles?r:null)||null}var tQ=(Si(aC={},nr,Object.keys(J9[nr])),Si(aC,br,Object.keys(J9[br])),aC);function lC(r){var e,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).skipLookups,i=void 0!==n&&n,o=(Si(e={},nr,"".concat(_t.cssPrefix,"-").concat(nr)),Si(e,br,"".concat(_t.cssPrefix,"-").concat(br)),e),s=null,a=nr;(r.includes(o[nr])||r.some(function(l){return tQ[nr].includes(l)}))&&(a=nr),(r.includes(o[br])||r.some(function(l){return tQ[br].includes(l)}))&&(a=br);var c=r.reduce(function(l,u){var f=function MNe(r,e){var t=e.split("-"),n=t[0],i=t.slice(1).join("-");return n!==r||""===i||function yNe(r){return~eNe.indexOf(r)}(i)?null:i}(_t.cssPrefix,u);if(q5[u]?(u=CNe[a].includes(u)?Zwe[a][u]:u,s=u,l.prefix=u):vNe[a].indexOf(u)>-1?(s=u,l.prefix=cC(u,{family:a})):f?l.iconName=f:u!==_t.replacementClass&&u!==o[nr]&&u!==o[br]&&l.rest.push(u),!i&&l.prefix&&l.iconName){var g="fa"===s?eQ(l.iconName):{},y=Q6(l.prefix,l.iconName);g.prefix&&(s=null),l.iconName=g.iconName||y||l.iconName,l.prefix=g.prefix||l.prefix,"far"===l.prefix&&!q5.far&&q5.fas&&!_t.autoFetchSvg&&(l.prefix="fas")}return l},JN());return(r.includes("fa-brands")||r.includes("fab"))&&(c.prefix="fab"),(r.includes("fa-duotone")||r.includes("fad"))&&(c.prefix="fad"),!c.prefix&&a===br&&(q5.fass||_t.autoFetchSvg)&&(c.prefix="fass",c.iconName=Q6(c.prefix,c.iconName)||c.iconName),("fa"===c.prefix||"fa"===s)&&(c.prefix=Cl()||"fas"),c}var SNe=function(){function r(){(function Lwe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")})(this,r),this.definitions={}}return function zwe(r,e,t){e&&OX(r.prototype,e),t&&OX(r,t),Object.defineProperty(r,"prototype",{writable:!1})}(r,[{key:"add",value:function(){for(var t=this,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];var s=i.reduce(this._pullDefinitions,{});Object.keys(s).forEach(function(a){t.definitions[a]=dt(dt({},t.definitions[a]||{}),s[a]),KN(a,s[a]);var c=J9[nr][a];c&&KN(c,s[a]),JX()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(t,n){var i=n.prefix&&n.iconName&&n.icon?{0:n}:n;return Object.keys(i).map(function(o){var s=i[o],a=s.prefix,c=s.iconName,l=s.icon,u=l[2];t[a]||(t[a]={}),u.length>0&&u.forEach(function(f){"string"==typeof f&&(t[a][f]=l)}),t[a][c]=l}),t}}]),r}(),nQ=[],j5={},Z5={},ONe=Object.keys(Z5);function eI(r,e){for(var t=arguments.length,n=new Array(t>2?t-2:0),i=2;i<t;i++)n[i-2]=arguments[i];return(j5[r]||[]).forEach(function(s){e=s.apply(null,[e].concat(n))}),e}function J6(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];(j5[r]||[]).forEach(function(o){o.apply(null,t)})}function Q3(){var r=arguments[0],e=Array.prototype.slice.call(arguments,1);return Z5[r]?Z5[r].apply(null,e):void 0}function tI(r){"fa"===r.prefix&&(r.prefix="fas");var e=r.iconName,t=r.prefix||Cl();if(e)return e=Q6(t,e)||e,qX(rQ.definitions,t,e)||qX(za.styles,t,e)}var rQ=new SNe,bNe={i2svg:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Y3?(J6("beforeI2svg",e),Q3("pseudoElements2svg",e),Q3("i2svg",e)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.autoReplaceSvgRoot;!1===_t.autoReplaceSvg&&(_t.autoReplaceSvg=!0),_t.observeMutations=!0,function hNe(r){Y3&&(iC?setTimeout(r,0):WX.push(r))}(function(){NNe({autoReplaceSvgRoot:t}),J6("watch",e)})}},gs={noAuto:function(){_t.autoReplaceSvg=!1,_t.observeMutations=!1,J6("noAuto")},config:_t,dom:bNe,parse:{icon:function(e){if(null===e)return null;if("object"===Y_(e)&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:Q6(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&2===e.length){var t=0===e[1].indexOf("fa-")?e[1].slice(3):e[1],n=cC(e[0]);return{prefix:n,iconName:Q6(n,t)||t}}if("string"==typeof e&&(e.indexOf("".concat(_t.cssPrefix,"-"))>-1||e.match(Ywe))){var i=lC(e.split(" "),{skipLookups:!0});return{prefix:i.prefix||Cl(),iconName:Q6(i.prefix,i.iconName)||i.iconName}}if("string"==typeof e){var o=Cl();return{prefix:o,iconName:Q6(o,e)||e}}}},library:rQ,findIconDefinition:tI,toHtml:id},NNe=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).autoReplaceSvgRoot,n=void 0===t?tr:t;(Object.keys(za.styles).length>0||_t.autoFetchSvg)&&Y3&&_t.autoReplaceSvg&&gs.dom.i2svg({node:n})};function uC(r,e){return Object.defineProperty(r,"abstract",{get:e}),Object.defineProperty(r,"html",{get:function(){return r.abstract.map(function(n){return id(n)})}}),Object.defineProperty(r,"node",{get:function(){if(Y3){var n=tr.createElement("div");return n.innerHTML=r.html,n.children}}}),r}function nI(r){var e=r.icons,t=e.main,n=e.mask,i=r.prefix,o=r.iconName,s=r.transform,a=r.symbol,c=r.title,l=r.maskId,u=r.titleId,f=r.extra,g=r.watchable,y=void 0!==g&&g,S=n.found?n:t,I=S.width,R=S.height,U="fak"===i,$=[_t.replacementClass,o?"".concat(_t.cssPrefix,"-").concat(o):""].filter(function(a1){return-1===f.classes.indexOf(a1)}).filter(function(a1){return""!==a1||!!a1}).concat(f.classes).join(" "),oe={children:[],attributes:dt(dt({},f.attributes),{},{"data-prefix":i,"data-icon":o,class:$,role:f.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(I," ").concat(R)})},_e=U&&!~f.classes.indexOf("fa-fw")?{width:"".concat(I/R*16*.0625,"em")}:{};y&&(oe.attributes[K6]=""),c&&(oe.children.push({tag:"title",attributes:{id:oe.attributes["aria-labelledby"]||"title-".concat(u||rd())},children:[c]}),delete oe.attributes.title);var Te=dt(dt({},oe),{},{prefix:i,iconName:o,main:t,mask:n,maskId:l,transform:s,symbol:a,styles:dt(dt({},_e),f.styles)}),Fe=n.found&&t.found?Q3("generateAbstractMask",Te)||{children:[],attributes:{}}:Q3("generateAbstractIcon",Te)||{children:[],attributes:{}},rn=Fe.attributes;return Te.children=Fe.children,Te.attributes=rn,a?function kNe(r){var t=r.iconName,n=r.children,i=r.attributes,o=r.symbol,s=!0===o?"".concat(r.prefix,"-").concat(_t.cssPrefix,"-").concat(t):o;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:dt(dt({},i),{},{id:s}),children:n}]}]}(Te):function INe(r){var e=r.children,t=r.main,n=r.mask,i=r.attributes,o=r.styles,s=r.transform;if(qN(s)&&t.found&&!n.found){var l={x:t.width/t.height/2,y:.5};i.style=rC(dt(dt({},o),{},{"transform-origin":"".concat(l.x+s.x/16,"em ").concat(l.y+s.y/16,"em")}))}return[{tag:"svg",attributes:i,children:e}]}(Te)}function iQ(r){var e=r.content,t=r.width,n=r.height,i=r.transform,o=r.title,s=r.extra,a=r.watchable,c=void 0!==a&&a,l=dt(dt(dt({},s.attributes),o?{title:o}:{}),{},{class:s.classes.join(" ")});c&&(l[K6]="");var u=dt({},s.styles);qN(i)&&(u.transform=function lNe(r){var e=r.transform,t=r.width,i=r.height,o=void 0===i?16:i,s=r.startCentered,a=void 0!==s&&s,c="";return c+=a&&xX?"translate(".concat(e.x/16-(void 0===t?16:t)/2,"em, ").concat(e.y/16-o/2,"em) "):a?"translate(calc(-50% + ".concat(e.x/16,"em), calc(-50% + ").concat(e.y/16,"em)) "):"translate(".concat(e.x/16,"em, ").concat(e.y/16,"em) "),(c+="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "))+"rotate(".concat(e.rotate,"deg) ")}({transform:i,startCentered:!0,width:t,height:n}),u["-webkit-transform"]=u.transform);var f=rC(u);f.length>0&&(l.style=f);var g=[];return g.push({tag:"span",attributes:l,children:[e]}),o&&g.push({tag:"span",attributes:{class:"sr-only"},children:[o]}),g}var rI=za.styles;function iI(r){var e=r[0],t=r[1],o=DN(r.slice(4),1)[0];return{found:!0,width:e,height:t,icon:Array.isArray(o)?{tag:"g",attributes:{class:"".concat(_t.cssPrefix,"-").concat(X6.GROUP)},children:[{tag:"path",attributes:{class:"".concat(_t.cssPrefix,"-").concat(X6.SECONDARY),fill:"currentColor",d:o[0]}},{tag:"path",attributes:{class:"".concat(_t.cssPrefix,"-").concat(X6.PRIMARY),fill:"currentColor",d:o[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:o}}}}var xNe={found:!1,width:512,height:512};function oI(r,e){var t=e;return"fa"===e&&null!==_t.styleDefault&&(e=Cl()),new Promise(function(n,i){if(Q3("missingIconAbstract"),"fa"===t){var s=eQ(r)||{};r=s.iconName||r,e=s.prefix||e}if(r&&e&&rI[e]&&rI[e][r])return n(iI(rI[e][r]));(function LNe(r,e){!VX&&!_t.showMissingIcons&&r&&console.error('Icon with name "'.concat(r,'" and prefix "').concat(e,'" is missing.'))})(r,e),n(dt(dt({},xNe),{},{icon:_t.showMissingIcons&&r&&Q3("missingIconAbstract")||{}}))})}var oQ=function(){},sI=_t.measurePerformance&&X_&&X_.mark&&X_.measure?X_:{mark:oQ,measure:oQ},od='FA "6.5.1"',sQ=function(e){sI.mark("".concat(od," ").concat(e," ends")),sI.measure("".concat(od," ").concat(e),"".concat(od," ").concat(e," begins"),"".concat(od," ").concat(e," ends"))},aI={begin:function(e){return sI.mark("".concat(od," ").concat(e," begins")),function(){return sQ(e)}},end:sQ},fC=function(){};function aQ(r){return"string"==typeof(r.getAttribute?r.getAttribute(K6):null)}function FNe(r){return tr.createElementNS("http://www.w3.org/2000/svg",r)}function UNe(r){return tr.createElement(r)}function cQ(r){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ceFn,n=void 0===t?"svg"===r.tag?FNe:UNe:t;if("string"==typeof r)return tr.createTextNode(r);var i=n(r.tag);return Object.keys(r.attributes||[]).forEach(function(s){i.setAttribute(s,r.attributes[s])}),(r.children||[]).forEach(function(s){i.appendChild(cQ(s,{ceFn:n}))}),i}var dC={replace:function(e){var t=e[0];if(t.parentNode)if(e[1].forEach(function(i){t.parentNode.insertBefore(cQ(i),t)}),null===t.getAttribute(K6)&&_t.keepOriginalSource){var n=tr.createComment(function $Ne(r){var e=" ".concat(r.outerHTML," ");return"".concat(e,"Font Awesome fontawesome.com ")}(t));t.parentNode.replaceChild(n,t)}else t.remove()},nest:function(e){var t=e[0],n=e[1];if(~WN(t).indexOf(_t.replacementClass))return dC.replace(e);var i=new RegExp("".concat(_t.cssPrefix,"-.*"));if(delete n[0].attributes.id,n[0].attributes.class){var o=n[0].attributes.class.split(" ").reduce(function(a,c){return c===_t.replacementClass||c.match(i)?a.toSvg.push(c):a.toNode.push(c),a},{toNode:[],toSvg:[]});n[0].attributes.class=o.toSvg.join(" "),0===o.toNode.length?t.removeAttribute("class"):t.setAttribute("class",o.toNode.join(" "))}var s=n.map(function(a){return id(a)}).join("\n");t.setAttribute(K6,""),t.innerHTML=s}};function lQ(r){r()}function uQ(r,e){var t="function"==typeof e?e:fC;if(0===r.length)t();else{var n=lQ;_t.mutateApproach===qwe&&(n=ml.requestAnimationFrame||lQ),n(function(){var i=function HNe(){return!0===_t.autoReplaceSvg?dC.replace:dC[_t.autoReplaceSvg]||dC.replace}(),o=aI.begin("mutate");r.map(i),o(),t()})}}var cI=!1;function fQ(){cI=!0}function lI(){cI=!1}var hC=null;function dQ(r){if(RX&&_t.observeMutations){var e=r.treeCallback,t=void 0===e?fC:e,n=r.nodeCallback,i=void 0===n?fC:n,o=r.pseudoElementsCallback,s=void 0===o?fC:o,a=r.observeMutationsRoot,c=void 0===a?tr:a;hC=new RX(function(l){if(!cI){var u=Cl();W5(l).forEach(function(f){if("childList"===f.type&&f.addedNodes.length>0&&!aQ(f.addedNodes[0])&&(_t.searchPseudoElements&&s(f.target),t(f.target)),"attributes"===f.type&&f.target.parentNode&&_t.searchPseudoElements&&s(f.target.parentNode),"attributes"===f.type&&aQ(f.target)&&~Jwe.indexOf(f.attributeName))if("class"===f.attributeName&&function DNe(r){var e=r.getAttribute?r.getAttribute($N):null,t=r.getAttribute?r.getAttribute(GN):null;return e&&t}(f.target)){var g=lC(WN(f.target)),S=g.iconName;f.target.setAttribute($N,g.prefix||u),S&&f.target.setAttribute(GN,S)}else(function VNe(r){return r&&r.classList&&r.classList.contains&&r.classList.contains(_t.replacementClass)})(f.target)&&i(f.target)})}}),Y3&&hC.observe(c,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function hQ(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0},t=function WNe(r){var e=r.getAttribute("data-prefix"),t=r.getAttribute("data-icon"),n=void 0!==r.innerText?r.innerText.trim():"",i=lC(WN(r));return i.prefix||(i.prefix=Cl()),e&&t&&(i.prefix=e,i.iconName=t),i.iconName&&i.prefix||(i.prefix&&n.length>0&&(i.iconName=function ENe(r,e){return(YX[r]||{})[e]}(i.prefix,r.innerText)||QN(i.prefix,YN(r.innerText))),!i.iconName&&_t.autoFetchSvg&&r.firstChild&&r.firstChild.nodeType===Node.TEXT_NODE&&(i.iconName=r.firstChild.data)),i}(r),n=t.iconName,i=t.prefix,o=t.rest,s=function qNe(r){var e=W5(r.attributes).reduce(function(i,o){return"class"!==i.name&&"style"!==i.name&&(i[o.name]=o.value),i},{}),t=r.getAttribute("title"),n=r.getAttribute("data-fa-title-id");return _t.autoA11y&&(t?e["aria-labelledby"]="".concat(_t.replacementClass,"-title-").concat(n||rd()):(e["aria-hidden"]="true",e.focusable="false")),e}(r),a=eI("parseNodeAttributes",{},r),c=e.styleParser?function BNe(r){var e=r.getAttribute("style"),t=[];return e&&(t=e.split(";").reduce(function(n,i){var o=i.split(":"),s=o[0],a=o.slice(1);return s&&a.length>0&&(n[s]=a.join(":").trim()),n},{})),t}(r):[];return dt({iconName:n,title:r.getAttribute("title"),titleId:r.getAttribute("data-fa-title-id"),prefix:i,transform:Uc,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:o,styles:c,attributes:s}},a)}var ZNe=za.styles;function gQ(r){var e="nest"===_t.autoReplaceSvg?hQ(r,{styleParser:!1}):hQ(r);return~e.extra.classes.indexOf(HX)?Q3("generateLayersText",r,e):Q3("generateSvgReplacementMutation",r,e)}var vl=new Set;function pQ(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Y3)return Promise.resolve();var t=tr.documentElement.classList,n=function(f){return t.add("".concat(DX,"-").concat(f))},i=function(f){return t.remove("".concat(DX,"-").concat(f))},o=_t.autoFetchSvg?vl:BN.map(function(u){return"fa-".concat(u)}).concat(Object.keys(ZNe));o.includes("fa")||o.push("fa");var s=[".".concat(HX,":not([").concat(K6,"])")].concat(o.map(function(u){return".".concat(u,":not([").concat(K6,"])")})).join(", ");if(0===s.length)return Promise.resolve();var a=[];try{a=W5(r.querySelectorAll(s))}catch{}if(!(a.length>0))return Promise.resolve();n("pending"),i("complete");var c=aI.begin("onTree"),l=a.reduce(function(u,f){try{var g=gQ(f);g&&u.push(g)}catch(y){VX||"MissingIcon"===y.name&&console.error(y)}return u},[]);return new Promise(function(u,f){Promise.all(l).then(function(g){uQ(g,function(){n("active"),n("complete"),i("pending"),"function"==typeof e&&e(),c(),u()})}).catch(function(g){c(),f(g)})})}function YNe(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;gQ(r).then(function(t){t&&uQ([t],e)})}function KNe(r){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e||{}).icon?e:tI(e||{}),i=t.mask;return i&&(i=(i||{}).icon?i:tI(i||{})),r(n,dt(dt({},t),{},{mask:i}))}}BN.map(function(r){vl.add("fa-".concat(r))}),Object.keys(X9[nr]).map(vl.add.bind(vl)),Object.keys(X9[br]).map(vl.add.bind(vl)),vl=Y9(vl);var XNe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,i=void 0===n?Uc:n,o=t.symbol,s=void 0!==o&&o,a=t.mask,c=void 0===a?null:a,l=t.maskId,u=void 0===l?null:l,f=t.title,g=void 0===f?null:f,y=t.titleId,S=void 0===y?null:y,I=t.classes,R=void 0===I?[]:I,U=t.attributes,$=void 0===U?{}:U,oe=t.styles,_e=void 0===oe?{}:oe;if(e){var Te=e.prefix,Fe=e.iconName,mt=e.icon;return uC(dt({type:"icon"},e),function(){return J6("beforeDOMElementCreation",{iconDefinition:e,params:t}),_t.autoA11y&&(g?$["aria-labelledby"]="".concat(_t.replacementClass,"-title-").concat(S||rd()):($["aria-hidden"]="true",$.focusable="false")),nI({icons:{main:iI(mt),mask:c?iI(c.icon):{found:!1,width:null,height:null,icon:{}}},prefix:Te,iconName:Fe,transform:dt(dt({},Uc),i),symbol:s,title:g,maskId:u,titleId:S,extra:{attributes:$,styles:_e,classes:R}})})}},QNe={mixout:function(){return{icon:KNe(XNe)}},hooks:function(){return{mutationObserverCallbacks:function(t){return t.treeCallback=pQ,t.nodeCallback=YNe,t}}},provides:function(e){e.i2svg=function(t){var n=t.node,o=t.callback;return pQ(void 0===n?tr:n,void 0===o?function(){}:o)},e.generateSvgReplacementMutation=function(t,n){var i=n.iconName,o=n.title,s=n.titleId,a=n.prefix,c=n.transform,l=n.symbol,u=n.mask,f=n.maskId,g=n.extra;return new Promise(function(y,S){Promise.all([oI(i,a),u.iconName?oI(u.iconName,u.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(I){var R=DN(I,2);y([t,nI({icons:{main:R[0],mask:R[1]},prefix:a,iconName:i,transform:c,symbol:l,maskId:f,title:o,titleId:s,extra:g,watchable:!0})])}).catch(S)})},e.generateAbstractIcon=function(t){var l,n=t.children,i=t.attributes,o=t.main,s=t.transform,c=rC(t.styles);return c.length>0&&(i.style=c),qN(s)&&(l=Q3("generateAbstractTransformGrouping",{main:o,transform:s,containerWidth:o.width,iconWidth:o.width})),n.push(l||o.icon),{children:n,attributes:i}}}},JNe={mixout:function(){return{layer:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.classes,o=void 0===i?[]:i;return uC({type:"layer"},function(){J6("beforeDOMElementCreation",{assembler:t,params:n});var s=[];return t(function(a){Array.isArray(a)?a.map(function(c){s=s.concat(c.abstract)}):s=s.concat(a.abstract)}),[{tag:"span",attributes:{class:["".concat(_t.cssPrefix,"-layers")].concat(Y9(o)).join(" ")},children:s}]})}}}},eIe={mixout:function(){return{counter:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.title,o=void 0===i?null:i,s=n.classes,a=void 0===s?[]:s,c=n.attributes,l=void 0===c?{}:c,u=n.styles,f=void 0===u?{}:u;return uC({type:"counter",content:t},function(){return J6("beforeDOMElementCreation",{content:t,params:n}),function RNe(r){var e=r.content,t=r.title,n=r.extra,i=dt(dt(dt({},n.attributes),t?{title:t}:{}),{},{class:n.classes.join(" ")}),o=rC(n.styles);o.length>0&&(i.style=o);var s=[];return s.push({tag:"span",attributes:i,children:[e]}),t&&s.push({tag:"span",attributes:{class:"sr-only"},children:[t]}),s}({content:t.toString(),title:o,extra:{attributes:l,styles:f,classes:["".concat(_t.cssPrefix,"-layers-counter")].concat(Y9(a))}})})}}}},tIe={mixout:function(){return{text:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.transform,o=void 0===i?Uc:i,s=n.title,a=void 0===s?null:s,c=n.classes,l=void 0===c?[]:c,u=n.attributes,f=void 0===u?{}:u,g=n.styles,y=void 0===g?{}:g;return uC({type:"text",content:t},function(){return J6("beforeDOMElementCreation",{content:t,params:n}),iQ({content:t,transform:dt(dt({},Uc),o),title:a,extra:{attributes:f,styles:y,classes:["".concat(_t.cssPrefix,"-layers-text")].concat(Y9(l))}})})}}},provides:function(e){e.generateLayersText=function(t,n){var i=n.title,o=n.transform,s=n.extra,a=null,c=null;if(xX){var l=parseInt(getComputedStyle(t).fontSize,10),u=t.getBoundingClientRect();a=u.width/l,c=u.height/l}return _t.autoA11y&&!i&&(s.attributes["aria-hidden"]="true"),Promise.resolve([t,iQ({content:t.innerHTML,width:a,height:c,transform:o,title:i,extra:s,watchable:!0})])}}},nIe=new RegExp('"',"ug"),mQ=[1105920,1112319];function _Q(r,e){var t="".concat(Wwe).concat(e.replace(":","-"));return new Promise(function(n,i){if(null!==r.getAttribute(t))return n();var s=W5(r.children).filter(function(mt){return mt.getAttribute(UN)===e})[0],a=ml.getComputedStyle(r,e),c=a.getPropertyValue("font-family").match(Kwe),l=a.getPropertyValue("font-weight"),u=a.getPropertyValue("content");if(s&&!c)return r.removeChild(s),n();if(c&&"none"!==u&&""!==u){var f=a.getPropertyValue("content"),g=~["Sharp"].indexOf(c[2])?br:nr,y=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(c[2])?Q9[g][c[2].toLowerCase()]:Xwe[g][l],S=function rIe(r){var e=r.replace(nIe,""),t=function mNe(r,e){var i,t=r.length,n=r.charCodeAt(e);return n>=55296&&n<=56319&&t>e+1&&(i=r.charCodeAt(e+1))>=56320&&i<=57343?1024*(n-55296)+i-56320+65536:n}(e,0),n=t>=mQ[0]&&t<=mQ[1],i=2===e.length&&e[0]===e[1];return{value:YN(i?e[0]:e),isSecondary:n||i}}(f),I=S.value,R=S.isSecondary,U=c[0].startsWith("FontAwesome"),$=QN(y,I),oe=$;if(U){var _e=function PNe(r){var e=XX[r],t=QN("fas",r);return e||(t?{prefix:"fas",iconName:t}:null)||{prefix:null,iconName:null}}(I);_e.iconName&&_e.prefix&&($=_e.iconName,y=_e.prefix)}if(!$||R||s&&s.getAttribute($N)===y&&s.getAttribute(GN)===oe)n();else{r.setAttribute(t,oe),s&&r.removeChild(s);var Te=function jNe(){return{iconName:null,title:null,titleId:null,prefix:null,transform:Uc,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}(),Fe=Te.extra;Fe.attributes[UN]=e,oI($,y).then(function(mt){var rn=nI(dt(dt({},Te),{},{icons:{main:mt,mask:JN()},prefix:y,iconName:oe,extra:Fe,watchable:!0})),a1=tr.createElementNS("http://www.w3.org/2000/svg","svg");"::before"===e?r.insertBefore(a1,r.firstChild):r.appendChild(a1),a1.outerHTML=rn.map(function(dn){return id(dn)}).join("\n"),r.removeAttribute(t),n()}).catch(i)}}else n()})}function iIe(r){return Promise.all([_Q(r,"::before"),_Q(r,"::after")])}function oIe(r){return!(r.parentNode===document.head||~jwe.indexOf(r.tagName.toUpperCase())||r.getAttribute(UN)||r.parentNode&&"svg"===r.parentNode.tagName)}function CQ(r){if(Y3)return new Promise(function(e,t){var n=W5(r.querySelectorAll("*")).filter(oIe).map(iIe),i=aI.begin("searchPseudoElements");fQ(),Promise.all(n).then(function(){i(),lI(),e()}).catch(function(){i(),lI(),t()})})}var vQ=!1,yQ=function(e){return e.toLowerCase().split(" ").reduce(function(n,i){var o=i.toLowerCase().split("-"),s=o[0],a=o.slice(1).join("-");if(s&&"h"===a)return n.flipX=!0,n;if(s&&"v"===a)return n.flipY=!0,n;if(a=parseFloat(a),isNaN(a))return n;switch(s){case"grow":n.size=n.size+a;break;case"shrink":n.size=n.size-a;break;case"left":n.x=n.x-a;break;case"right":n.x=n.x+a;break;case"up":n.y=n.y-a;break;case"down":n.y=n.y+a;break;case"rotate":n.rotate=n.rotate+a}return n},{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0})},uI={x:0,y:0,width:"100%",height:"100%"};function MQ(r){return r.attributes&&(r.attributes.fill||!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(r.attributes.fill="black"),r}function lIe(r){return"g"===r.tag?r.children:[r]}var uIe={hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-mask"),o=i?lC(i.split(" ").map(function(s){return s.trim()})):JN();return o.prefix||(o.prefix=Cl()),t.mask=o,t.maskId=n.getAttribute("data-fa-mask-id"),t}}},provides:function(e){e.generateAbstractMask=function(t){var n=t.children,i=t.attributes,o=t.main,s=t.mask,a=t.maskId,u=o.icon,g=s.icon,y=function cNe(r){var e=r.transform,n=r.iconWidth,i={transform:"translate(".concat(r.containerWidth/2," 256)")},o="translate(".concat(32*e.x,", ").concat(32*e.y,") "),s="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),a="rotate(".concat(e.rotate," 0 0)");return{outer:i,inner:{transform:"".concat(o," ").concat(s," ").concat(a)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}({transform:t.transform,containerWidth:s.width,iconWidth:o.width}),S={tag:"rect",attributes:dt(dt({},uI),{},{fill:"white"})},I=u.children?{children:u.children.map(MQ)}:{},R={tag:"g",attributes:dt({},y.inner),children:[MQ(dt({tag:u.tag,attributes:dt(dt({},u.attributes),y.path)},I))]},U={tag:"g",attributes:dt({},y.outer),children:[R]},$="mask-".concat(a||rd()),oe="clip-".concat(a||rd()),_e={tag:"mask",attributes:dt(dt({},uI),{},{id:$,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[S,U]},Te={tag:"defs",children:[{tag:"clipPath",attributes:{id:oe},children:lIe(g)},_e]};return n.push(Te,{tag:"rect",attributes:dt({fill:"currentColor","clip-path":"url(#".concat(oe,")"),mask:"url(#".concat($,")")},uI)}),{children:n,attributes:i}}}};!function TNe(r,e){var t=e.mixoutsTo;nQ=r,j5={},Object.keys(Z5).forEach(function(n){-1===ONe.indexOf(n)&&delete Z5[n]}),nQ.forEach(function(n){var i=n.mixout?n.mixout():{};if(Object.keys(i).forEach(function(s){"function"==typeof i[s]&&(t[s]=i[s]),"object"===Y_(i[s])&&Object.keys(i[s]).forEach(function(a){t[s]||(t[s]={}),t[s][a]=i[s][a]})}),n.hooks){var o=n.hooks();Object.keys(o).forEach(function(s){j5[s]||(j5[s]=[]),j5[s].push(o[s])})}n.provides&&n.provides(Z5)})}([fNe,QNe,JNe,eIe,tIe,{hooks:function(){return{mutationObserverCallbacks:function(t){return t.pseudoElementsCallback=CQ,t}}},provides:function(e){e.pseudoElements2svg=function(t){var n=t.node;_t.searchPseudoElements&&CQ(void 0===n?tr:n)}}},{mixout:function(){return{dom:{unwatch:function(){fQ(),vQ=!0}}}},hooks:function(){return{bootstrap:function(){dQ(eI("mutationObserverCallbacks",{}))},noAuto:function(){!function GNe(){hC&&hC.disconnect()}()},watch:function(t){var n=t.observeMutationsRoot;vQ?lI():dQ(eI("mutationObserverCallbacks",{observeMutationsRoot:n}))}}}},{mixout:function(){return{parse:{transform:function(t){return yQ(t)}}}},hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-transform");return i&&(t.transform=yQ(i)),t}}},provides:function(e){e.generateAbstractTransformGrouping=function(t){var n=t.main,i=t.transform,s=t.iconWidth,a={transform:"translate(".concat(t.containerWidth/2," 256)")},c="translate(".concat(32*i.x,", ").concat(32*i.y,") "),l="scale(".concat(i.size/16*(i.flipX?-1:1),", ").concat(i.size/16*(i.flipY?-1:1),") "),u="rotate(".concat(i.rotate," 0 0)"),y={outer:a,inner:{transform:"".concat(c," ").concat(l," ").concat(u)},path:{transform:"translate(".concat(s/2*-1," -256)")}};return{tag:"g",attributes:dt({},y.outer),children:[{tag:"g",attributes:dt({},y.inner),children:[{tag:n.icon.tag,children:n.icon.children,attributes:dt(dt({},n.icon.attributes),y.path)}]}]}}}},uIe,{provides:function(e){var t=!1;ml.matchMedia&&(t=ml.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){var n=[],i={fill:"currentColor"},o={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};n.push({tag:"path",attributes:dt(dt({},i),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var s=dt(dt({},o),{},{attributeName:"opacity"}),a={tag:"circle",attributes:dt(dt({},i),{},{cx:"256",cy:"364",r:"28"}),children:[]};return t||a.children.push({tag:"animate",attributes:dt(dt({},o),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:dt(dt({},s),{},{values:"1;0;1;1;0;1;"})}),n.push(a),n.push({tag:"path",attributes:dt(dt({},i),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:t?[]:[{tag:"animate",attributes:dt(dt({},s),{},{values:"1;0;0;0;0;1;"})}]}),t||n.push({tag:"path",attributes:dt(dt({},i),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:dt(dt({},s),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:n}}}},{hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-symbol");return t.symbol=null!==i&&(""===i||i),t}}}}],{mixoutsTo:gs});var gIe=gs.parse,pIe=gs.icon;const mIe=["*"],vIe=r=>{const e={[`fa-${r.animation}`]:null!=r.animation&&!r.animation.startsWith("spin"),"fa-spin":"spin"===r.animation||"spin-reverse"===r.animation,"fa-spin-pulse":"spin-pulse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-spin-reverse":"spin-reverse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-pulse":"spin-pulse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-fw":r.fixedWidth,"fa-border":r.border,"fa-inverse":r.inverse,"fa-layers-counter":r.counter,"fa-flip-horizontal":"horizontal"===r.flip||"both"===r.flip,"fa-flip-vertical":"vertical"===r.flip||"both"===r.flip,[`fa-${r.size}`]:null!==r.size,[`fa-rotate-${r.rotate}`]:null!==r.rotate,[`fa-pull-${r.pull}`]:null!==r.pull,[`fa-stack-${r.stackItemSize}`]:null!=r.stackItemSize};return Object.keys(e).map(t=>e[t]?t:null).filter(t=>t)};let EIe=(()=>{class r{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),PIe=(()=>{class r{constructor(){this.definitions={}}addIcons(...t){for(const n of t){n.prefix in this.definitions||(this.definitions[n.prefix]={}),this.definitions[n.prefix][n.iconName]=n;for(const i of n.icon[2])"string"==typeof i&&(this.definitions[n.prefix][i]=n)}}addIconPacks(...t){for(const n of t){const i=Object.keys(n).map(o=>n[o]);this.addIcons(...i)}}getIconDefinition(t,n){return t in this.definitions&&n in this.definitions[t]?this.definitions[t][n]:null}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),SIe=(()=>{class r{constructor(){this.stackItemSize="1x"}ngOnChanges(t){if("size"in t)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275dir=Dt({type:r,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},standalone:!0,features:[c2]})}return r})(),OIe=(()=>{class r{constructor(t,n){this.renderer=t,this.elementRef=n}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(t){"size"in t&&(null!=t.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${t.size.currentValue}`),null!=t.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${t.size.previousValue}`))}static#e=this.\u0275fac=function(n){return new(n||r)(G(fc),G(V2))};static#t=this.\u0275cmp=$e({type:r,selectors:[["fa-stack"]],inputs:{size:"size"},standalone:!0,features:[c2,wg],ngContentSelectors:mIe,decls:1,vars:0,template:function(n,i){1&n&&(function QV(r){const e=ye()[mr][R2];if(!e.projection){const n=e.projection=function yh(r,e){const t=[];for(let n=0;n<r;n++)t.push(e);return t}(r?r.length:1,null),i=n.slice();let o=e.child;for(;null!==o;){const s=r?r5e(o,r):0;null!==s&&(i[s]?i[s].projectionNext=o:n[s]=o,i[s]=o),o=o.next}}}(),function JV(r,e=0,t){const n=ye(),i=Vn(),o=Q0(i,Qt+r,16,null,t||null);null===o.projection&&(o.projection=e),vy(),(!n[Ma]||k0())&&32!=(32&o.flags)&&function A3e(r,e,t){GL(e[en],0,e,t,iM(r,t,e),DL(t.parent||e[R2],t,e))}(i,n,o)}(0))},encapsulation:2})}return r})(),e0=(()=>{class r{set spin(t){this.animation=t?"spin":void 0}set pulse(t){this.animation=t?"spin-pulse":void 0}constructor(t,n,i,o,s){this.sanitizer=t,this.config=n,this.iconLibrary=i,this.stackItem=o,this.classes=[],null!=s&&null==o&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(t){if(null!=this.icon||null!=this.config.fallbackIcon){if(t){const i=this.findIconDefinition(null!=this.icon?this.icon:this.config.fallbackIcon);if(null!=i){const o=this.buildParams();this.renderIcon(i,o)}}}else(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})()}render(){this.ngOnChanges({})}findIconDefinition(t){const n=((r,e)=>(r=>void 0!==r.prefix&&void 0!==r.iconName)(r)?r:"string"==typeof r?{prefix:e,iconName:r}:{prefix:r[0],iconName:r[1]})(t,this.config.defaultPrefix);return"icon"in n?n:this.iconLibrary.getIconDefinition(n.prefix,n.iconName)??((r=>{throw new Error(`Could not find icon with iconName=${r.iconName} and prefix=${r.prefix} in the icon library.`)})(n),null)}buildParams(){const t={flip:this.flip,animation:this.animation,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},n="string"==typeof this.transform?gIe.transform(this.transform):this.transform;return{title:this.title,transform:n,classes:[...vIe(t),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(t,n){const i=pIe(t,n);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(i.html.join("\n"))}static#e=this.\u0275fac=function(n){return new(n||r)(G(LU),G(EIe),G(PIe),G(SIe,8),G(OIe,8))};static#t=this.\u0275cmp=$e({type:r,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(n,i){2&n&&(pE("innerHTML",i.renderedIconHTML,r7),w("title",i.title))},inputs:{icon:"icon",title:"title",animation:"animation",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},standalone:!0,features:[c2,wg],decls:0,vars:0,template:function(n,i){},encapsulation:2})}return r})(),TIe=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275mod=N2({type:r});static#n=this.\u0275inj=s2({})}return r})();function EQ(r,e){if(null!=r&&null!=e&&"object"==typeof r){if(null!=r.equals)return r.equals(e);{const t=r,n=e;for(const i of Object.keys(t)){if(!(i in n))return!1;if(!1===EQ(t[i],n[i]))return!1}return!0}}return r===e}function fI(r){return null==r||function AIe(r){return"object"==typeof r&&null!=r&&null!=r.equals}(r)||function RIe(r){return"string"==typeof r||"number"==typeof r||"boolean"==typeof r||null===r}(r)||function bIe(r){if("object"==typeof r){for(const e in r)if(null!=r[e]&&!1===fI(r[e]))return!1;return null!=r&&r.constructor.prototype===Object.prototype}return!1}(r)}function zo(r,e){if(fI(r)&&fI(e))return EQ(r,e);throw new Error(`Comparing non comparable objects: ${r.constructor.name} and ${e.constructor.name}`)}class ke{static fromFunctions(e,t){return new class extends ke{encode(n){return e(n)}decode(n){return t(n)}}}static identity(){function e(t){return t}return ke.fromFunctions(e,e)}static constant(e,t){return new class extends ke{encode(n){return e}decode(n){return t}}}static tuple(e,t,n){return new class extends ke{encode(i){const o=t(i),s={};return Object.keys(o).forEach(a=>{s[a]=e[a].encode(o[a])}),s}decode(i){const o={};return Object.keys(e).reverse().forEach(s=>{o[s]=e[s].decode(i[s])}),n(Object.values(o))}}}static disjunction(e,t){return L.assert(e.length===t.length,"typePredicates and encoders should have same length"),new class extends ke{encode(n){let i=0;for(const o of e){if(!0===o(n))return{type:i,encoded:t[i].encode(n)};i++}}decode(n){const i=L.getNonNullable(n).type,o=L.getNonNullable(n).encoded;return t[i].decode(o)}}}static list(e){return new class extends ke{encode(t){return t.map(n=>{const i=e.encode(n);return L.assert(!1===Array.isArray(i),"This encoder should not encode as array"),i})}decode(t){return t.map(e.decode)}}}}class h{value;static of(e){return new h(e)}static ofNullable(e){return null==e?h.empty():h.of(e)}static empty(){return new h(null)}static getEncoder(e){return new class extends ke{encode(t){return t.isPresent()?e.encode(t.get()):null}decode(t){return null===t?h.empty():h.of(e.decode(t))}}}constructor(e){this.value=e}isPresent(){return null!=this.value}isAbsent(){return null==this.value}get(){if(this.isPresent())return this.value;throw new Error("Value is absent")}getOrElse(e){return this.isPresent()?this.value:e}equals(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&zo(this.value,e.value)}equalsValue(e){return this.equals(h.of(e))}toString(){return this.isAbsent()?"MGPOptional.empty()":`MGPOptional.of(${this.value})`}map(e){return this.isPresent()?h.of(e(this.get())):h.empty()}}class X{static success(e){return new wIe(e)}static failure(e){return new NIe(e)}constructor(){}equals(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&zo(this.get(),e.get())}}class wIe extends X{value;__nominal;constructor(e){super(),this.value=e}isSuccess(){return!0}isFailure(){return!1}get(){return this.value}getReason(){throw new Error("Cannot get failure reason from a success")}getReasonOr(e){return e}toOptional(){return h.of(this.value)}toString(){return`MGPFallible.success(${this.value})`}}class NIe extends X{reason;__nominal;constructor(e){super(),this.reason=e}isSuccess(){return!1}isFailure(){return!0}get(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}getReason(){return this.reason}getReasonOr(e){return this.getReason()}toOptional(){return h.empty()}toString(){return`MGPFallible.failure(${this.reason})`}toOtherFallible(){return X.failure(this.reason)}}var A;!function(r){r.SUCCESS=X.success(void 0),r.ofFallible=function e(n){return n.isSuccess()?r.SUCCESS:r.failure(n.getReason())},r.failure=function t(n){return X.failure(n)}}(A||(A={}));class t0{collectionName;firestore;collection;subDAOs={};constructor(e,t){this.collectionName=e,this.firestore=t;this.collection=Ewe(t,this.collectionName).withConverter({fromFirestore:i=>i.data(),toFirestore:i=>i})}create(e){var t=this;return E(function*(){return(yield Mwe(t.collection,e)).id})()}read(e){var t=this;return E(function*(){const n=yield Owe(j9(t.collection,e));return n.exists()?h.of(L.getNonNullable(n.data())):h.empty()})()}exists(e){var t=this;return E(function*(){return(yield t.read(e)).isPresent()})()}update(e,t){var n=this;return E(function*(){return Iwe(j9(n.collection,e),t)})()}delete(e){return Swe(j9(this.collection,e))}set(e,t){return Nwe(j9(this.collection,e),t)}subscribeToChanges(e,t){return new Ue(PX(j9(this.collection,e),n=>{t(h.ofNullable(n.data()))}))}findWhere(e,t,n){var i=this;return E(function*(){const o=i.constructQuery(e,t,n);return(yield Twe(o)).docs.map(a=>({id:a.id,data:a.data()}))})()}observingWhere(e,t,n){const i=this.constructQuery(e,n);return new Ue(PX(i,o=>{const s=[],a=[],c=[];o.docChanges().forEach(l=>{const u={id:l.doc.id,data:l.doc.data()};switch(l.type){case"added":s.push(u);break;case"modified":a.push(u);break;case"removed":c.push(u)}}),s.length>0&&(Ne.display("FirestoreDAO","subscription","firebase gave us "+s.length+" NEW "+this.collectionName),t.onDocumentCreated(s)),a.length>0&&(Ne.display("FirestoreDAO","subscription","firebase gave us "+a.length+" MODIFIED "+this.collectionName),t.onDocumentModified(a)),c.length>0&&(Ne.display("FirestoreDAO","subscription","firebase gave us "+c.length+" DELETED "+this.collectionName),t.onDocumentDeleted(c))}))}constructQuery(e,t,n){let i=Z_(this.collection);null!=t&&(i=Z_(i,wwe(t))),null!=n&&(i=Z_(i,bwe(n)));for(const o of e)i=Z_(i,kwe(o[0],o[1],o[2]));return i}subCollectionDAO(e,t){const n=`${this.collection.path}/${e}/${t}`;if(n in this.subDAOs)return this.subDAOs[n];{const i=new class extends t0{constructor(o){super(n,o)}}(this.firestore);return this.subDAOs[n]=i,i}}}let IIe=(()=>{class r extends t0{constructor(t){super("errors",t)}static \u0275fac=function(n){return new(n||r)(Ae(pl))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var kIe=Ns(1);let Ut=(()=>{class r{infoMessage(t){this.message(t,"is-info")}gameMessage(t){this.message(t,"is-warning")}criticalMessage(t){this.message(t,"is-danger")}message(t,n){const i=this.getDurationInMs(t);this.toast(t,n,i)}toast(t,n,i){(0,kIe.toast)({message:t,duration:i,type:n,position:"top-center",closeOnClick:!0,dismissible:!0})}getDurationInMs(t){const o=60*t.split(" ").length*1e3/150;return Math.max(o,3e3)}static \u0275fac=function(n){return new(n||r)};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();class Gi{errorDAO;router;messageDisplayer;static singleton=h.empty();static setSingletonInstance(e){Gi.singleton=h.of(e)}static logErrorAndFail(e,t,n){throw Gi.logError(e,t,n),new Error(`${e}: ${t} (extra data: ${JSON.stringify(n)})`)}static logError(e,t,n){if(this.singleton.isAbsent())throw new Error(`${e}: ${t} (extra data: ${JSON.stringify(n)})`);return this.singleton.get().logError(e,t,n),A.failure(e+": "+t)}constructor(e,t,n){this.errorDAO=e,this.router=t,this.messageDisplayer=n,Gi.setSingletonInstance(this)}findErrors(e,t,n,i){return this.errorDAO.findWhere(void 0===i?[["component","==",e],["route","==",t],["message","==",n]]:[["component","==",e],["route","==",t],["message","==",n],["data","==",i]])}logError(e,t,n){var i=this;return E(function*(){i.messageDisplayer.criticalMessage($localize`An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible.`);const o=i.router.url,s=yield i.findErrors(e,o,t,n);if(0===s.length){const a={component:e,route:o,message:t,firstEncounter:Fc(),lastEncounter:Fc(),occurences:1};null!=n&&(a.data=n),yield i.errorDAO.create(a)}else{const a=s[0].id,c=s[0].data;yield i.errorDAO.update(a,{lastEncounter:Fc(),occurences:c.occurences+1})}})()}static \u0275fac=function(t){return new(t||Gi)(Ae(IIe),Ae(Xn),Ae(Ut))};static \u0275prov=xe({token:Gi,factory:Gi.\u0275fac,providedIn:"root"})}class Ne{static enableLog(e,t,n){const i=localStorage.getItem("verbosity");let o={};null!=i&&(o=JSON.parse(i)),void 0===n?o[t]=e:o[t+"."+n]=e;const s=Ne.getStringified(o);localStorage.setItem("verbosity",s)}static getStringified(e){try{return JSON.stringify(e)}catch{return"recursive and not stringifiable!"}}static isVerbose(e){const t=localStorage.getItem("verbosity");if(null==t)return[!1,!1];try{const n=JSON.parse(t);return null==n[e]?[!1,!1]:(L.assert(Array.isArray(n[e]),`malformed verbosity levels for ${e}: ${n[e]}`),n[e])}catch{throw new Error(`malformed verbosity object: ${t}`)}}static isMethodVerboseEntry(e,t){return Ne.isVerbose(e)[0]||Ne.isVerbose(e+"."+t)[0]}static isMethodVerboseExit(e,t){return Ne.isVerbose(e)[1]||Ne.isVerbose(e+"."+t)[1]}static display(e,t,n){Ne.isMethodVerboseEntry(e,t)&&console.log(`${e}.${t}: ${n}`)}static log(e){const t=e.name;for(const n of Object.getOwnPropertyNames(e.prototype)){const i=Object.getOwnPropertyDescriptor(e.prototype,n),o=L.getNonNullable(i);L.assert(o.value instanceof Function,"cannot add logging to properties that are not methods!");const a=o.value;o.value=function(...c){if(Ne.isMethodVerboseEntry(t,n)){const u=Array.from(c).map(Ne.getStringified).join(", ");console.log(`> ${t}.${n}(${u})`)}const l=a.apply(this,c);return Ne.isMethodVerboseExit(t,n)&&console.log(`< ${t}.${n} -> ${Ne.getStringified(l)}`),l},Object.defineProperty(e.prototype,n,o)}}}window.enableLog=Ne.enableLog;class L{static expectToBe(e,t,n){if(e!==t)throw void 0!==n?new Error(n):new Error(`A default switch case did not observe the correct value, expected ${t}, but got ${e} instead.`)}static expectToBeMultiple(e,t){let n=!1;for(const i of t)if(e===i){n=!0;break}if(!1===n)throw new Error(`A default switch case did not observe the correct value, expected a value among ${t}, but got ${e} instead.`)}static getNonNullable(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}static assert(e,t){if(!1===e)throw Gi.logError("Assertion failure",t),new Error(`Assertion failure: ${t}`)}static identity(e){return e}}let dI=class Ov extends t0{constructor(e){super("chats",e)}static \u0275fac=function(t){return new(t||Ov)(Ae(pl))};static \u0275prov=xe({token:Ov,factory:Ov.\u0275fac,providedIn:"root"})};dI=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],dI);let PQ=(()=>class r{static CANNOT_SEND_MESSAGE=()=>$localize`You're not allowed to send a message here.`;static FORBIDDEN_MESSAGE=()=>$localize`This message is forbidden.`})(),Y5=class Tv{chatDAO;constructor(e){this.chatDAO=e}addMessage(e,t){var n=this;return E(function*(){return n.chatDAO.subCollectionDAO(e,"messages").create(t)})()}getLastMessages(e,t){var n=this;return E(function*(){return n.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",t)})()}subscribeToMessages(e,t){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],t,"postedTime")}deleteChat(e){var t=this;return E(function*(){return t.chatDAO.delete(e)})()}createNewChat(e){var t=this;return E(function*(){return t.chatDAO.set(e,{})})()}sendMessage(e,t,n,i){var o=this;return E(function*(){if(!1===o.userCanSendMessage(t.name,e))return A.failure(PQ.CANNOT_SEND_MESSAGE());if(o.isForbiddenMessage(n))return A.failure(PQ.FORBIDDEN_MESSAGE());const s={content:n,sender:t,postedTime:Fc(),currentTurn:i};return yield o.addMessage(e,s),A.SUCCESS})()}userCanSendMessage(e,t){return""!==e}isForbiddenMessage(e){return""===e}static \u0275fac=function(t){return new(t||Tv)(Ae(dI))};static \u0275prov=xe({token:Tv,factory:Tv.\u0275fac,providedIn:"root"})};function hn(r,e,t){if(!1===r)throw void 0!==t&&console.log(t),Gi.logError("Assertion failure",e),new Error(`Assertion failure: ${e}`)}var hI;Y5=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],Y5);let sd=class Av extends t0{static#e=hI=this;static COLLECTION_NAME="users";constructor(e){super(hI.COLLECTION_NAME,e)}static \u0275fac=function(t){return new(t||Av)(Ae(pl))};static \u0275prov=xe({token:Av,factory:Av.\u0275fac,providedIn:"root"})};sd=hI=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],sd);let K5=(()=>{class r{userDAO;constructor(t){this.userDAO=t}usernameIsAvailable(t){var n=this;return E(function*(){return 0===(yield n.userDAO.findWhere([["username","==",t]])).length})()}setUsername(t,n){var i=this;return E(function*(){yield i.userDAO.update(t,{username:n})})()}markAsVerified(t){var n=this;return E(function*(){yield n.userDAO.update(t,{verified:!0})})()}observeUserOnServer(t,n){return this.userDAO.subscribeToChanges(t,i=>{i.isPresent()&&null===i.get().lastUpdateTime||n(i)})}getUserLastUpdateTime(t){var n=this;return E(function*(){const i=yield n.userDAO.read(t);if(i.isAbsent())return h.empty();{const o=i.get().lastUpdateTime;return hn(null!=o,"should not receive a lastUpdateTime equal to null"),h.of(o)}})()}updatePresenceToken(t){return this.userDAO.update(t,{lastUpdateTime:Fc()})}getServerTime(t){var n=this;return E(function*(){return new Promise(i=>{let o=!1;const a=n.userDAO.subscribeToChanges(t,c=>{null==c.get().lastUpdateTime?o=!0:o&&(a.unsubscribe(),i(c.get().lastUpdateTime))});n.updatePresenceToken(t)})})()}static \u0275fac=function(n){return new(n||r)(Ae(sd))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();class SQ extends xs{constructor(e=1/0,t=1/0,n=EO){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:n,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:s}=this;t||(n.push(e),!i&&n.push(o.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:i}=this,o=i.slice();for(let s=0;s<o.length&&!e.closed;s+=n?1:2)e.next(o[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:i}=this,o=(i?1:2)*e;if(e<1/0&&o<n.length&&n.splice(0,n.length-o),!i){const s=t.now();let a=0;for(let c=1;c<n.length&&n[c]<=s;c+=2)a=c;a&&n.splice(0,a+1)}}}let ad=(()=>class r{static YOU_ARE_ALREADY_PLAYING=()=>$localize`You are already playing in another game.`;static YOU_ARE_ALREADY_CREATING=()=>$localize`You are already the creator of another game.`;static YOU_ARE_ALREADY_CHOSEN_OPPONENT=()=>$localize`You are already the chosen opponent in another game.`;static YOU_ARE_ALREADY_CANDIDATE=()=>$localize`You are already candidate in another game.`;static YOU_ARE_ALREADY_OBSERVING=()=>$localize`You are already observing another game.`})();class yl{static createUserWithEmailAndPassword(e,t,n){return uSe(e,t,n)}static sendEmailVerification(e){return hSe(e)}static sendPasswordResetEmail(e,t){return gSe(e,t)}static signInWithEmailAndPassword(e,t,n){return E(function*(){return(yield pSe(e,t,n)).user})()}static signInWithPopup(e,t){return E(function*(){return(yield mSe(e,t)).user})()}static updateProfile(e,t){return _Se(e,t)}}class n0{id;email;username;verified;static NOT_CONNECTED=new n0("",h.empty(),h.empty(),!1);constructor(e,t,n,i){this.id=e,this.email=t,this.username=n,this.verified=i}isConnected(){return this.email.isPresent()}toMinimalUser(){return{id:this.id,name:this.username.get()}}equals(e){return this.id===e.id&&this.email.equals(e.email)&&this.username.equals(e.username)&&this.verified===e.verified}}let hr=class bv{userDAO;userService;auth;authSubscription;user=h.empty();userRS;userObs;userSubscription=new Ue;constructor(e,t,n){var i=this;this.userDAO=e,this.userService=t,this.auth=n,this.userRS=new SQ(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new Ue(dSe(this.auth,function(){var o=E(function*(s){null==s?(Ne.display("ConnectedUserService","subscription","User is not connected"),i.userSubscription.unsubscribe(),i.userRS.next(n0.NOT_CONNECTED),i.user=h.empty()):(hn(i.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),i.userSubscription=i.userDAO.subscribeToChanges(s.uid,a=>{if(a.isPresent()){const c=a.get(),l=c.username;Ne.display("ConnectedUserService","subscription",`User ${l} is connected, and the verified status is ${i.emailVerified(s)}`);const u=!0===i.emailVerified(s)&&null!=l;if(!0===u&&!1===c.verified)return i.userService.markAsVerified(s.uid);const f=new n0(s.uid,h.ofNullable(s.email),h.ofNullable(l),u);!1===i.user.equalsValue(f)&&(i.user=h.of(f),i.userRS.next(f))}}))});return function(s){return o.apply(this,arguments)}}()))}emailVerified(e){return e.emailVerified}sendPasswordResetEmail(e){var t=this;return E(function*(){try{return yield yl.sendPasswordResetEmail(t.auth,e),A.SUCCESS}catch(n){return t.catchFirebaseError(n)}})()}doRegister(e,t,n){var i=this;return E(function*(){return(yield i.userService.usernameIsAvailable(e))?i.registerAfterUsernameCheck(e,t,n):X.failure($localize`This username is already in use.`)})()}registerAfterUsernameCheck(e,t,n){var i=this;return E(function*(){try{const o=yield yl.createUserWithEmailAndPassword(i.auth,t,n);yield yl.signInWithEmailAndPassword(i.auth,t,n);const s=L.getNonNullable(o.user);return yield i.createUser(s.uid,e),X.success(s)}catch(o){return i.catchFirebaseError(o)}})()}catchFirebaseError(e){if(e instanceof Nc)return X.failure(this.mapFirebaseError(e));throw e}mapFirebaseError(e){switch(e.code){case"auth/email-already-in-use":return $localize`This email address is already in use.`;case"auth/invalid-email":return $localize`This email address is invalid.`;case"auth/user-not-found":case"auth/wrong-password":return $localize`You have entered invalid credentials.`;case"auth/invalid-credential":return $localize`The credential is invalid or has expired, please try again.`;case"auth/weak-password":return $localize`Your password is too weak, please use a stronger password.`;case"auth/too-many-requests":return $localize`There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later.`;case"auth/popup-closed-by-user":return $localize`You closed the authentication popup without finalizing your log in.`;case"auth/popup-blocked":return $localize`The authentication popup was blocked. Try again after disabling popup blocking.`;default:return Gi.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}sendEmailVerification(){var e=this;return E(function*(){const t=h.ofNullable(e.auth.currentUser);if(!t.isPresent())return Gi.logError("ConnectedUserService","Unlogged users cannot request for email verification");if(e.emailVerified(t.get()))return Gi.logError("ConnectedUserService","Verified users should not ask email verification after being verified");try{return yield yl.sendEmailVerification(t.get()),A.SUCCESS}catch(n){return e.catchFirebaseError(n)}})()}doEmailLogin(e,t){var n=this;return E(function*(){try{return yield yl.signInWithEmailAndPassword(n.auth,e,t),A.SUCCESS}catch(i){return n.catchFirebaseError(i)}})()}createUser(e,t){var n=this;return E(function*(){null==t?yield n.userDAO.set(e,{verified:!1,currentGame:null}):yield n.userDAO.set(e,{username:t,verified:!1,currentGame:null})})()}doGoogleLogin(){var e=this;return E(function*(){return A.ofFallible(yield e.registerOrLoginWithGoogle())})()}registerOrLoginWithGoogle(){var e=this;return E(function*(){try{const t=new rEe;t.addScope("profile"),t.addScope("email");const n=yield yl.signInWithPopup(e.auth,t);return!1===(yield e.userDAO.exists(n.uid))&&(yield e.createUser(n.uid)),X.success(n)}catch(t){return e.catchFirebaseError(t)}})()}disconnect(){var e=this;return E(function*(){return h.ofNullable(e.auth.currentUser).isPresent()?(yield e.auth.signOut(),A.SUCCESS):A.failure("Cannot disconnect a non-connected user")})()}subscribeToUser(e){return this.userObs.subscribe(e)}setUsername(e){var t=this;return E(function*(){if(""===e)return A.failure($localize`Your username may not be empty.`);try{if(!1===(yield t.userService.usernameIsAvailable(e)))return A.failure($localize`This username is already in use, please select a different one.`);const i=L.getNonNullable(t.auth.currentUser);return yield yl.updateProfile(i,{displayName:e}),yield t.userService.setUsername(i.uid,e),yield t.userService.markAsVerified(i.uid),yield t.reloadUser(),A.SUCCESS}catch(n){return t.catchFirebaseError(n)}})()}setPicture(e){var t=this;return E(function*(){try{const n=L.getNonNullable(t.auth.currentUser);return yield yl.updateProfile(n,{photoURL:e}),A.SUCCESS}catch(n){return t.catchFirebaseError(n)}})()}reloadUser(){var e=this;return E(function*(){const t=L.getNonNullable(e.auth.currentUser);yield t.getIdToken(!0),yield t.reload()})()}sendPresenceToken(){return hn(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}static \u0275fac=function(t){return new(t||bv)(Ae(sd),Ae(K5),Ae(Tm))};static \u0275prov=xe({token:bv,factory:bv.\u0275fac,providedIn:"root"})};hr=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],hr);class rr{value;static HARD_DRAW=new rr(0);static RESIGN=new rr(1);static VICTORY=new rr(3);static TIMEOUT=new rr(4);static UNACHIEVED=new rr(5);static AGREED_DRAW_BY_ZERO=new rr(6);static AGREED_DRAW_BY_ONE=new rr(7);constructor(e){this.value=e}}class gC{id;data;constructor(e,t){this.id=e,this.data=t}getTurn(){return this.data.turn}isHardDraw(){return this.data.result===rr.HARD_DRAW.value}isAgreedDraw(){return this.data.result===rr.AGREED_DRAW_BY_ZERO.value||this.data.result===rr.AGREED_DRAW_BY_ONE.value}getDrawAccepter(){return this.data.result===rr.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(hn(this.data.result===rr.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),L.getNonNullable(this.data.playerOne))}isWin(){return this.data.result===rr.VICTORY.value}isTimeout(){return this.data.result===rr.TIMEOUT.value}isResign(){return this.data.result===rr.RESIGN.value}getWinner(){return h.ofNullable(this.data.winner)}getLoser(){return h.ofNullable(this.data.loser)}setWinnerAndLoser(e,t){return new gC(this.id,{...this.data,winner:e,loser:t})}}class m2{value;constructor(e){this.value=e}static CREATOR=new m2("CREATOR");static RANDOM=new m2("RANDOM");static CHOSEN_PLAYER=new m2("CHOSEN_PLAYER");static of(e){switch(e){case"CREATOR":return m2.CREATOR;case"RANDOM":return m2.RANDOM;default:return hn("CHOSEN_PLAYER"===e,"Invalid value for FirstPlayer: "+e+"."),m2.CHOSEN_PLAYER}}}class Bi{value;constructor(e){this.value=e}static STANDARD=new Bi("STANDARD");static BLITZ=new Bi("BLITZ");static CUSTOM=new Bi("CUSTOM");static NORMAL_MOVE_DURATION=120;static NORMAL_PART_DURATION=1800;static BLITZ_MOVE_DURATION=30;static BLITZ_PART_DURATION=900;static of(e){switch(e){case"STANDARD":return Bi.STANDARD;case"BLITZ":return Bi.BLITZ;case"CUSTOM":return Bi.CUSTOM;default:throw new Error("Invalid part type: "+e+".")}}}class _2{value;constructor(e){this.value=e}static PART_CREATED=new _2(0);static CONFIG_PROPOSED=new _2(2);static PART_STARTED=new _2(3);static PART_FINISHED=new _2(4)}class gI{static NONE=new gI;value=2;constructor(){}isPlayer(){return!1}toString(){return"PLAYER_NONE"}equals(e){return this===e}getValue(){return this.value}}class O{value;static encoder=ke.tuple([ke.identity()],e=>[e.getValue()],e=>O.of(e[0]));static ZERO=new O(0);static ONE=new O(1);static PLAYERS=[O.ZERO,O.ONE];static of(e){return 0===e?O.ZERO:(L.expectToBe(e,1),O.ONE)}static ofTurn(e){return e%2==0?O.ZERO:O.ONE}constructor(e){this.value=e}isPlayer(){return!0}toString(){return this===O.ZERO?"PLAYER_ZERO":(L.expectToBe(this,O.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}equals(e){return this===e}getScoreModifier(){return 0===this.value?-1:1}getPreVictory(){return this.getVictoryValue()-this.getScoreModifier()}getVictoryValue(){return this===O.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}getOpponent(){return this===O.ZERO?O.ONE:(L.expectToBe(this,O.ONE),O.ZERO)}getValue(){return this.value}}var B;!function(r){r.ZERO=O.ZERO,r.ONE=O.ONE,r.NONE=gI.NONE,r.encoder=new class extends ke{encode(e){return e.getValue()}decode(e){return 2===e?r.NONE:(L.assert(0===e||1===e,"Invalid encoded player: "+e),O.of(e))}}}(B||(B={}));let cd=class wv extends t0{constructor(e){super("parts",e)}static \u0275fac=function(t){return new(t||wv)(Ae(pl))};static \u0275prov=xe({token:wv,factory:wv.\u0275fac,providedIn:"root"})};cd=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],cd);class pC{onDocumentCreated;onDocumentModified;onDocumentDeleted;constructor(e,t,n){this.onDocumentCreated=e,this.onDocumentModified=t,this.onDocumentDeleted=n}}let pI=(()=>{class r{partDAO;constructor(t){this.partDAO=t}eventsCollection(t){return this.partDAO.subCollectionDAO(t,"events")}addEvent(t,n){return this.eventsCollection(t).create(n)}addMove(t,n,i){return this.addEvent(t,{eventType:"Move",time:Fc(),user:n,move:i})}addRequest(t,n,i){return this.addEvent(t,{eventType:"Request",time:Fc(),user:n,requestType:i})}addReply(t,n,i,o,s=null){return this.addEvent(t,{eventType:"Reply",time:Fc(),user:n,reply:i,requestType:o,data:s})}addAction(t,n,i){return this.addEvent(t,{eventType:"Action",time:Fc(),user:n,action:i})}startGame(t,n){return this.addAction(t,n,"StartGame")}subscribeToEvents(t,n){const i=new pC(o=>{const s=o.map(a=>a.data).filter(a=>null!=a.time);s.length>0&&n(s)},o=>{n(o.map(s=>s.data))},()=>{});return this.eventsCollection(t).observingWhere([],i,"time")}static \u0275fac=function(n){return new(n||r)(Ae(cd))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();class C2{__nominal}class an{x;static encoder=ke.tuple([ke.identity()],e=>[e.x],e=>an.of(e[0]));static ZERO=new an(0);static ONE=new an(1);static TWO=new an(2);static THREE=new an(3);static of(e){switch(e){case 0:return an.ZERO;case 1:return an.ONE;case 2:return an.TWO;default:return hn(3===e,"Invalid Apagos Coord "+e),an.THREE}}constructor(e){this.x=e}equals(e){return this.x===e.x}}let X5=(()=>class r{static PIECE_SHOULD_MOVE_DOWNWARD=()=>$localize`Pieces should only move downward!`;static CANNOT_LAND_ON_A_FULL_SQUARE=()=>$localize`That square is already full, you cannot put a piece in it!`;static NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=()=>$localize`You have no pieces in that square, select one that contains at least one of your pieces!`;static NO_PIECE_REMAINING_TO_DROP=()=>$localize`There are no remaining pieces of that color to drop!`;static NO_POSSIBLE_TRANSFER_REMAINS=()=>$localize`There is no possible transfer from that square!`})();class ir extends C2{landing;piece;starting;static ALL_MOVES=[new ir(an.ZERO,h.of(O.ZERO),h.empty()),new ir(an.ONE,h.of(O.ZERO),h.empty()),new ir(an.TWO,h.of(O.ZERO),h.empty()),new ir(an.THREE,h.of(O.ZERO),h.empty()),new ir(an.ZERO,h.of(O.ONE),h.empty()),new ir(an.ONE,h.of(O.ONE),h.empty()),new ir(an.TWO,h.of(O.ONE),h.empty()),new ir(an.THREE,h.of(O.ONE),h.empty()),new ir(an.TWO,h.empty(),h.of(an.THREE)),new ir(an.ONE,h.empty(),h.of(an.THREE)),new ir(an.ZERO,h.empty(),h.of(an.THREE)),new ir(an.ONE,h.empty(),h.of(an.TWO)),new ir(an.ZERO,h.empty(),h.of(an.TWO)),new ir(an.ZERO,h.empty(),h.of(an.ONE))];static encoder=ke.tuple([an.encoder,h.getEncoder(O.encoder),h.getEncoder(an.encoder)],e=>[e.landing,e.piece,e.starting],e=>new ir(e[0],e[1],e[2]));static drop(e,t){return L.getNonNullable(ir.ALL_MOVES.find(i=>i.landing.equals(e)&&i.piece.equalsValue(t)&&i.starting.equals(h.empty())))}static transfer(e,t){if(e.x<=t.x)return X.failure(X5.PIECE_SHOULD_MOVE_DOWNWARD());const n=L.getNonNullable(ir.ALL_MOVES.find(i=>i.landing.equals(t)&&i.piece.equals(h.empty())&&i.starting.equals(h.of(e))));return X.success(n)}constructor(e,t,n){super(),this.landing=e,this.piece=t,this.starting=n}isDrop(){return this.piece.isPresent()}toString(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}equals(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}class mC{turn;constructor(e){this.turn=e}getCurrentPlayer(){return O.ofTurn(this.turn)}getCurrentOpponent(){return this.turn%2==1?O.ZERO:O.ONE}}class OQ{static toComparableObjectSet(e){const t=[];return e.forEach(n=>{!1===t.some(i=>i.equals(n))&&t.push(n)}),t}static toComparableSet(e){const t=[];return e.forEach(n=>{!1===t.some(i=>zo(i,n))&&t.push(n)}),t}}class ct{values;constructor(e){this.values=void 0===e?[]:OQ.toComparableSet(e)}equals(e){if(e.size()!==this.size())return!1;for(const t of this)if(!1===e.contains(t))return!1;return!0}toString(){let e="";for(const t of this)e+=null==t?"null, ":t.toString()+", ";return"["+e.slice(0,-2)+"]"}add(e){return!this.contains(e)&&(this.values.push(e),!0)}remove(e){for(let t=0;t<this.values.length;t++)if(zo(this.values[t],e))return this.values.splice(t,1),!0;return!1}addAll(e){for(const t of e)this.add(t)}union(e){const t=new ct(this.toList());return t.addAll(e),t}contains(e){for(const t of this.values)if(zo(t,e))return!0;return!1}size(){return this.values.length}toList(){const e=[];for(const t of this)e.push(t);return e}getAnyElement(){return this.size()>0?h.of(this.values[0]):h.empty()}isEmpty(){return 0===this.values.length}hasElements(){return!1===this.isEmpty()}map(e){const t=[];for(const n of this.values)t.push(e(n));return new ct(t)}flatMap(e){const t=new ct;for(const n of this)t.addAll(e(n));return t}filter(e){const t=new ct;for(const n of this)e(n)&&t.add(n);return t}findAnyCommonElement(e){for(const t of e)if(this.contains(t))return h.of(t);return h.empty()}intersection(e){const t=new ct;for(const n of e)this.contains(n)&&t.add(n);return t}getMissingElementFrom(e){for(const t of e)if(!1===this.contains(t))return h.of(t);return h.empty()}[Symbol.iterator](){return this.values.values()}}class fn{map;isImmutable;static from(e){const t=Object.keys(e),n=new fn;for(const i of t)n.set(i,e[i]);return n}constructor(e=[],t=!1){this.map=e,this.isImmutable=t}makeImmutable(){this.isImmutable=!0}get(e){for(const t of this.map)if(zo(t.key,e))return h.of(t.value);return h.empty()}getAnyPair(){return this.size()>0?h.of(this.map[0]):h.empty()}forEach(e){for(const t of this.map)e(t)}putAll(e){this.assertImmutability("putAll");for(const t of e.map)this.put(t.key,t.value)}assertImmutability(e){L.assert(!1===this.isImmutable,"Cannot call "+e+" on immutable map!")}put(e,t){this.assertImmutability("put");for(const n of this.map)if(zo(n.key,e)){const i=n.value;return n.value=t,h.of(i)}return this.map.push({key:e,value:t}),h.empty()}containsKey(e){return this.map.some(t=>zo(t.key,e))}size(){return this.map.length}listKeys(){return this.map.map(e=>e.key)}listValues(){return this.map.map(e=>e.value)}getKeySet(){return new ct(this.listKeys())}filter(e){const t=new fn;for(const n of this.map)e(n.key,n.value)&&t.set(n.key,n.value);return t}replace(e,t){if(this.assertImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}set(e,t){if(this.assertImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}delete(e){this.assertImmutability("delete");for(let t=0;t<this.map.length;t++)if(zo(this.map[t].key,e)){const i=this.map[t].value,o=this.map.slice(0,t),s=this.map.slice(t+1);return this.map=o.concat(s),i}throw new Error('No Value to delete for key "'+e.toString()+'"!')}getCopy(){const e=new this.constructor;for(const t of this.listKeys())e.set(t,this.get(t).get());return e}equals(e){const t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;for(const i of t){const o=this.get(i).get(),s=e.get(i);if(hn(s.isPresent(),"value is absent in a map even though its key is present!"),!1===zo(o,s.get()))return!1}return!0}}class Q5 extends fn{reverse(){const e=new Q5;for(const t of this.listKeys()){const n=this.get(t).get();if(e.containsKey(n))e.get(n).get().add(t);else{const i=new ct;i.add(t),e.set(n,i)}}return e}}class yt{static create(e,t){const n=[];for(let i=0;i<e;i++)n.push(t);return n}static copy(e){return e.map(t=>t)}static sortByDescending(e,t){e.sort((n,i)=>{const o=t(n),s=t(i);return o<s?1:o>s?-1:0})}static equals(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===zo(e[n],t[n]))return!1;return!0}static isPrefix(e,t){return!(e.length>t.length)&&yt.equals(e,t.slice(0,e.length))}static range(e){const t=[];for(let n=0;n<e;n++)t.push(n);return t}static smallerFirst(e,t){return e-t}static getRandomElement(e){return L.assert(e.length>0,"ArrayUtils.getRandomElement must be called on an array containing elements"),e[Math.floor(Math.random()*e.length)]}static maximumsBy(e,t){let n=[],i=-1/0;for(const o of e){const s=t(o);s>=i&&(s>i&&(n=[]),i=s,n.push(o))}return n}static count(e,t){let n=0;for(const i of e)zo(i,t)&&n++;return n}static isLessThan(e,t){L.assert(e.length>0&&t.length>0,"ArrayUtils.isLessThan/isGreaterThan should have two non-empty list as parameter");const n=Math.min(e.length,t.length);for(let i=0;i<n;i++)if(t[i]!==e[i])return e[i]<t[i];return!1}static isGreaterThan(e,t){return yt.isLessThan(t,e)}static min(e,t){return yt.isLessThan(e,t)?e:t}static max(e,t){return yt.isGreaterThan(e,t)?e:t}}class it{static sum(e){let t=0;for(const n of e)for(const i of n)t+=i;return t}static add(e,t){const n=e[0].length,i=e.length;L.assert(i===t.length,"Table should have same height"),L.assert(n===t[0].length,"Table should have same width");const o=it.create(n,i,0);for(let s=0;s<i;s++)for(let a=0;a<n;a++)o[s][a]=e[s][a]+t[s][a];return o}static create(e,t,n){const i=[];for(let o=0;o<t;o++)i.push(yt.create(e,n));return i}static map(e,t){return e.map(n=>n.map(t))}static copy(e){return it.map(e,t=>t)}static compare(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===yt.equals(e[n],t[n]))return!1;return!0}}class TQ{content=new fn;get(e){const t=this.content.get(e.y);return t.isAbsent()?h.empty():t.get().get(e.x)}set(e,t){const n=this.content.get(e.y);let i;n.isPresent()?i=n.get():(i=new fn,this.content.set(e.y,i)),i.set(e.x,t)}[Symbol.iterator](){const e=[],t=this.content.getKeySet().toList();t.sort(yt.smallerFirst);for(const n of t){const i=this.content.get(n).get(),o=i.getKeySet().toList();o.sort(yt.smallerFirst);for(const s of o){const a=i.get(s).get();e.push({x:s,y:n,content:a})}}return e.values()}}class HIe{static create(e,t,n,i){const o=[];for(let s=0;s<e;s++)o.push(it.create(t,n,i));return o}}class ld{containing;static from(e,t,n){if(e+t>n)return X.failure("invalid starting space");const i=new fn([{key:O.ZERO,value:e},{key:O.ONE,value:t},{key:B.NONE,value:n}]);i.makeImmutable();const o=new ld(i);return X.success(o)}constructor(e){this.containing=e}isFull(){const e=this.count(O.ZERO),t=this.count(O.ONE);return this.count(B.NONE)<=e+t}count(e){return this.containing.get(e).get()}addPiece(e){let t=this.count(O.ZERO),n=this.count(O.ONE);const i=this.count(B.NONE);return e===O.ZERO?t++:n++,ld.from(t,n,i).get()}substractPiece(e){let t=this.count(O.ZERO),n=this.count(O.ONE);const i=this.count(B.NONE);return e===O.ZERO?t--:n--,ld.from(t,n,i).get()}getDominatingPlayer(){const e=this.count(O.ZERO),t=this.count(O.ONE);return e>t?O.ZERO:t>e?O.ONE:B.NONE}equals(e){return this.containing.equals(e.containing)}}class U1 extends fn{static of(e,t){return new U1([{key:O.ZERO,value:e},{key:O.ONE,value:t}])}static ofSingle(e,t){return U1.of([e],[t])}add(e,t,n){const i=yt.copy(this.get(e).get());return i[t]+=n,this.put(e,i)}concat(e){const t=this.get(O.ZERO).get(),n=this.get(O.ONE).get(),i=e.get(O.ZERO).get(),o=e.get(O.ONE).get();return U1.of(t.concat(i),n.concat(o))}}class J3{map;static ofValues(e,t){const n=new fn([{key:O.ZERO,value:e},{key:O.ONE,value:t}]);return new J3(n)}constructor(e){this.map=e}makeImmutable(){return this.map.makeImmutable()}equals(e){return this.map.equals(e.map)}get(e){return this.map.get(e).get()}put(e,t){return this.map.put(e,t).get()}}class we extends J3{static of(e,t){const n=new fn([{key:O.ZERO,value:e},{key:O.ONE,value:t}]);return new we(n)}add(e,t){const n=this.get(e);return this.map.put(e,n+t)}toTable(){return U1.ofSingle(this.get(O.ZERO),this.get(O.ONE))}getCopy(){return new we(this.map.getCopy())}}class e4 extends mC{board;remaining;static fromRepresentation(e,t,n,i){const o=[];for(let a=0;a<4;a++){const f=ld.from(t[0][a],t[1][a],t[2][a]).get();o.push(f)}const s=we.of(n,i);return new e4(e,o,s)}constructor(e,t,n){super(e),this.board=t,this.remaining=n,this.remaining.makeImmutable()}getPieceAt(e){return this.board[e.x]}updateAt(e,t){const n=[];for(let o=0;o<4;o++)n.push(e.x===o?t:this.board[o]);const i=this.getRemainingCopy();return new e4(this.turn,n,i)}getRemainingCopy(){return this.remaining.getCopy()}getRemaining(e){return this.remaining.get(e)}equals(e){return this.turn===e.turn&&yt.equals(e.board,this.board)&&this.remaining.equals(e.remaining)}}class q{title;instruction;state;static fromMove(e,t,n,i,o,s){return new FIe(e,t,n,i,o,s)}static forClick(e,t,n,i,o,s){return new $Ie(e,t,n,i,o,s)}static anyMove(e,t,n,i,o){return new UIe(e,t,n,i,o)}static fromPredicate(e,t,n,i,o,s){return new GIe(e,t,n,i,o,s)}static informational(e,t,n){return new BIe(e,t,n)}previousMove=h.empty();constructor(e,t,n){this.title=e,this.instruction=t,this.state=n}isMove(){return!1}isAnyMove(){return!1}isClick(){return!1}isPredicate(){return!1}isInformation(){return!1}hasSolution(){return!1}withPreviousMove(e){return this.previousMove=h.of(e),this}}class _C extends q{successMessage;constructor(e,t,n,i){super(e,t,n),this.successMessage=i}hasSolution(){return!0}getSuccessMessage(){return this.successMessage}}class FIe extends _C{acceptedMoves;failureMessage;constructor(e,t,n,i,o,s){super(e,t,n,o),this.acceptedMoves=i,this.failureMessage=s,hn(i.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational")}isMove(){return!0}getSolution(){return this.acceptedMoves[0]}getFailureMessage(){return this.failureMessage}}class UIe extends _C{solutionMove;constructor(e,t,n,i,o){super(e,t,n,o),this.solutionMove=i}getSolution(){return this.solutionMove}isAnyMove(){return!0}}class $Ie extends _C{acceptedClicks;failureMessage;constructor(e,t,n,i,o,s){super(e,t,n,o),this.acceptedClicks=i,this.failureMessage=s}isClick(){return!0}getSolution(){return this.acceptedClicks[0]}getFailureMessage(){return this.failureMessage}}class GIe extends _C{solutionMove;predicate;constructor(e,t,n,i,o,s){super(e,t,n,s),this.solutionMove=i,this.predicate=o}getSolution(){return this.solutionMove}isPredicate(){return!0}}class BIe extends q{isInformation(){return!0}}class Bn{}class gn{metrics;static max(e,t){const n=yt.max(e.metrics,t.metrics);return gn.multiMetric(n)}static min(e,t){const n=yt.min(e.metrics,t.metrics);return gn.multiMetric(n)}static VICTORIES=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER];static isVictory(e){return e===Number.MAX_SAFE_INTEGER||e===Number.MIN_SAFE_INTEGER}static isPreVictory(e){return e===Number.MAX_SAFE_INTEGER-1||e===Number.MIN_SAFE_INTEGER+1}static ofSingle(e,t){return gn.ofMultiple([e],[t])}static ofPlayerNumberMap(e){return gn.ofSingle(e.get(O.ZERO),e.get(O.ONE))}static ofMultiple(e,t){L.assert(e.length===t.length,"both player should have the same number of metric"),L.assert(e.length>=1,"scores list should be filled");const n=[];for(let i=0;i<e.length;i++){const o=e[i]*O.ZERO.getScoreModifier(),s=t[i]*O.ONE.getScoreModifier();n.push(o+s)}return new gn(n)}static of(e){return new gn([e])}static multiMetric(e){return new gn(e)}static isLessThan(e,t){return yt.isLessThan(e.metrics,t.metrics)}static isGreaterThan(e,t){return yt.isGreaterThan(e.metrics,t.metrics)}constructor(e){this.metrics=e}toMaximum(){const t=yt.create(this.metrics.length,Number.MAX_SAFE_INTEGER);return gn.multiMetric(t)}toMinimum(){const t=yt.create(this.metrics.length,Number.MIN_SAFE_INTEGER);return gn.multiMetric(t)}equals(e){return yt.equals(this.metrics,e.metrics)}}class ve{isEndGame;winner;static ZERO_WON=new ve(!0,O.ZERO);static ONE_WON=new ve(!0,O.ONE);static DRAW=new ve(!0,B.NONE);static ONGOING=new ve(!1,B.NONE);static getVictory(e){return e===O.ZERO?ve.ZERO_WON:ve.ONE_WON}static getDefeat(e){return e===O.ZERO?ve.ONE_WON:ve.ZERO_WON}constructor(e,t){this.isEndGame=e,this.winner=t}toBoardValue(){return this.winner.isPlayer()?gn.of(this.winner.getVictoryValue()):gn.of(0)}}var mI;let AQ=(()=>class r{static createdNodes=0})(),ps=class{static#e=mI=this;gameState;parent;previousMove;static ID=0;id;children=new fn;cache=new fn;constructor(e,t=h.empty(),n=h.empty()){this.gameState=e,this.parent=t,this.previousMove=n,this.id=mI.ID++,AQ.createdNodes++}getChild(e){return this.children.get(e)}hasChildren(){return this.getChildren().length>0}getChildren(){return this.children.listValues()}addChild(e){L.assert(e.previousMove.isPresent(),"GameNode: addChild expects a node with a previous move"),this.children.set(e.previousMove.get(),e)}printDot(e,t,n,i=0,o=0,s=h.empty()){0===i&&console.log("digraph G {");const a=e.getGameStatus(this,s);let c="white";if(a.isEndGame)switch(a.winner){case O.ZERO:c="#994d00";break;case O.ONE:c="#ffc34d";break;default:c="grey"}let l=`#${this.gameState.turn}: ${this.id}`;t&&(l+=` - ${t(this)}`),console.log(`    node_${o} [label="${l}", style=filled, fillcolor="${c}"];`);let u=o+1;if(void 0===n||i<n)for(const f of this.children.listValues())console.log(`    node_${o} -> node_${u} [label="${f.previousMove.get()}"];`),u=f.printDot(e,t,n,i+1,u);return 0===i&&console.log("}"),u}getCache(e){return this.cache.get(e)}setCache(e,t){this.cache.containsKey(e)?this.cache.replace(e,t):this.cache.set(e,t)}};ps=mI=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],ps);class bQ{constructor(){}choose(e,t,n){Ne.display("Rules","choose",t.toString()+" was proposed");const i=this.isLegal(t,e.gameState,n);if(i.isFailure())return Ne.display("Rules","choose","Move is illegal: "+i.getReason()),X.failure(i.getReason());const o=e.getChild(t);if(o.isPresent())return L.assert(i.isSuccess(),"Rules.choose: Move is illegal: "+i.getReasonOr("")),Ne.display("Rules","choose","and this proposed move is found in the list, so it is legal"),X.success(o.get());const s=this.applyLegalMove(t,e.gameState,n,i.get()),a=new ps(s,h.of(e),h.of(t));return X.success(a)}getInitialNode(e){const t=this.getInitialState(e);return new ps(t)}getDefaultRulesConfig(){const e=this.getRulesConfigDescription();return e.isPresent()?h.of(e.get().getDefaultConfig().config):h.empty()}}class Da extends bQ{}class wr extends bQ{getRulesConfigDescription(){return h.empty()}}class Va extends wr{static PIECES_PER_PLAYER=10;static singleton=h.empty();static get(){return Va.singleton.isAbsent()&&(Va.singleton=h.of(new Va)),Va.singleton.get()}getInitialState(){return e4.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],Va.PIECES_PER_PLAYER,Va.PIECES_PER_PLAYER)}applyLegalMove(e,t,n,i){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}applyLegalDrop(e,t){const n=t.getRemainingCopy();n.add(e.piece.get(),-1);const i=new e4(t.turn+1,t.board,n),o=e.piece.get(),s=i.getPieceAt(e.landing).addPiece(o);if(e.landing===an.THREE)return i.updateAt(e.landing,s);{const a=an.of(e.landing.x+1),c=i.getPieceAt(a);return i.updateAt(e.landing,c).updateAt(a,s)}}applyLegalTransfer(e,t){const n=t.getCurrentPlayer(),i=e.starting.get(),o=t.getPieceAt(i).substractPiece(n),s=t.getPieceAt(e.landing).addPiece(n);let a=t.updateAt(i,o);return a=a.updateAt(e.landing,s),new e4(a.turn+1,a.board,a.remaining)}isLegal(e,t){return t.getPieceAt(e.landing).isFull()?A.failure(X5.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}isLegalDrop(e,t){return t.getRemaining(e.piece.get())<=0?A.failure(X5.NO_PIECE_REMAINING_TO_DROP()):A.SUCCESS}isLegalSlideDown(e,t){const n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?A.failure(X5.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):A.SUCCESS}getGameStatus(e){const t=e.gameState;for(let i=0;i<4;i++)if(!1===t.getPieceAt(an.of(i)).isFull())return ve.ONGOING;const n=t.getPieceAt(an.THREE).getDominatingPlayer();return L.assert(n.isPlayer(),"winner can only be a player if the game is finished"),ve.getVictory(n)}}let pe=(()=>class r{static YOU_DID_NOT_CAPTURE_ANY_PIECE=()=>$localize`Failed, you did not capture any piece.`;static END_OF_THE_GAME=()=>$localize`End of the game`;static CONGRATULATIONS=()=>$localize`Congratulations!`;static CONGRATULATIONS_YOU_WON=()=>$localize`Congratulations, you won!`;static FAILED_TRY_AGAIN=()=>$localize`Failed, try again.`})();class qIe extends Bn{tutorial=[q.informational($localize`Initial board and object of the game`,$localize`At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!`,Va.get().getInitialState()),q.anyMove($localize`Drop`,$localize`There are two kinds of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right.<br/><br/>You're playing Light. Drop a piece on one of those three squares.`,e4.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),ir.drop(an.ZERO,O.ZERO),pe.CONGRATULATIONS()),q.fromPredicate($localize`Transfer`,$localize`The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from a higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!`,e4.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),ir.transfer(an.TWO,an.ZERO).get(),(e,t,n)=>e.isDrop()?A.failure($localize`This move is a drop, please do a transfer!`):A.SUCCESS,pe.CONGRATULATIONS()),q.fromPredicate($localize`Victory`,$localize`When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!`,e4.fromRepresentation(3,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),ir.drop(an.TWO,O.ONE),(e,t,n)=>e.isDrop()?e.piece.equalsValue(O.ONE)?A.SUCCESS:A.failure($localize`You actively made your opponent win!`):A.failure($localize`Wrong choice, your opponent will win in the next turn no matter which piece is dropped!`),pe.CONGRATULATIONS())]}class _I{static gcd(e,t){return 0===t?Math.abs(e):_I.gcd(t,e%t)}}class $t{x;y;constructor(e,t){this.x=e,this.y=t}equals(e){return this.x===e.x&&this.y===e.y}isSingleOrthogonalStep(){const e=Math.abs(this.x)+Math.abs(this.y)===1;return this.isOrthogonal()&&e}isOrthogonal(){return 0===this.x||0===this.y}isDiagonal(){return 0!==this.x&&0!==this.y}isDiagonalOfLength(e){return Math.abs(this.x)===e&&Math.abs(this.y)===e}toMinimalVector(){const e=_I.gcd(this.x,this.y);return new $t(this.x/e,this.y/e)}combine(e,t=1){return new $t(this.x+t*e.x,this.y+t*e.y)}toString(){return"("+this.x+", "+this.y+")"}}class CI extends $t{isDown(){return 1===this.y}isUp(){return-1===this.y}isLeft(){return-1===this.x}isRight(){return 1===this.x}toInt(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}toString(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}class vI{from(e,t){for(const n of this.all)if(n.x===e&&n.y===t)return X.success(n);return X.failure("Invalid x and y in direction construction")}fromDelta(e,t){return 0===e&&0===t?X.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.from(Math.sign(e),Math.sign(t)):X.failure(jIe.DIRECTION_MUST_BE_LINEAR())}fromMove(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}fromString(e){switch(e){case"UP":return this.from(0,-1);case"RIGHT":return this.from(1,0);case"DOWN":return this.from(0,1);case"LEFT":return this.from(-1,0);case"UP_LEFT":return this.from(-1,-1);case"UP_RIGHT":return this.from(1,-1);case"DOWN_LEFT":return this.from(-1,1);case"DOWN_RIGHT":return this.from(1,1);default:return X.failure(`Invalid direction string ${e}`)}}fromInt(e){switch(e){case 0:return this.from(0,-1);case 1:return this.from(1,0);case 2:return this.from(0,1);case 3:return this.from(-1,0);case 4:return this.from(-1,-1);case 5:return this.from(1,-1);case 6:return this.from(-1,1);case 7:return this.from(1,1);default:return X.failure(`Invalid int direction: ${e}`)}}}class me extends CI{static UP=new me(0,-1);static UP_RIGHT=new me(1,-1);static RIGHT=new me(1,0);static DOWN_RIGHT=new me(1,1);static DOWN=new me(0,1);static DOWN_LEFT=new me(-1,1);static LEFT=new me(-1,0);static UP_LEFT=new me(-1,-1);static factory=new class extends vI{all=[me.UP,me.UP_RIGHT,me.RIGHT,me.DOWN_RIGHT,me.DOWN,me.DOWN_LEFT,me.LEFT,me.UP_LEFT]};static DIRECTIONS=me.factory.all;static DIAGONALS=[me.UP_RIGHT,me.DOWN_RIGHT,me.DOWN_LEFT,me.UP_LEFT];static ORTHOGONALS=[me.UP,me.RIGHT,me.DOWN,me.LEFT];static encoder=ke.fromFunctions(e=>e.toString(),e=>(hn("string"==typeof e,"Invalid encoded direction"),me.factory.fromString(e).get()));constructor(e,t){super(e,t)}getOpposite(){return me.factory.from(-this.x,-this.y).get()}}class Ie extends CI{static UP=new Ie(0,-1);static RIGHT=new Ie(1,0);static DOWN=new Ie(0,1);static LEFT=new Ie(-1,0);static factory=new class extends vI{all=[Ie.UP,Ie.RIGHT,Ie.DOWN,Ie.LEFT];from(e,t){return 0===e&&-1===t?X.success(Ie.UP):1===e&&0===t?X.success(Ie.RIGHT):0===e&&1===t?X.success(Ie.DOWN):-1===e&&0===t?X.success(Ie.LEFT):X.failure("Invalid orthogonal from x and y")}};static ORTHOGONALS=Ie.factory.all;static encoder=ke.fromFunctions(e=>e.toString(),e=>(hn("string"==typeof e,"Invalid encoded orthogonal"),Ie.factory.fromString(e).get()));constructor(e,t){super(e,t)}getOpposite(){return Ie.factory.from(-this.x,-this.y).get()}rotateClockwise(){return Ie.factory.from(-this.y,this.x).get()}}let jIe=(()=>class r{static DIRECTION_MUST_BE_LINEAR=()=>$localize`You must move in a straight line! You can only move orthogonally or diagonally!`})();class go{static OUT_OF_RANGE(e){return`The coordinate ${e.toString()} is not on the board`}}class _ extends $t{static getEncoder(e){return ke.tuple([ke.identity(),ke.identity()],t=>[t.x,t.y],t=>e(t[0],t[1]))}static encoder=_.getEncoder((e,t)=>new _(e,t));constructor(e,t){super(e,t)}getNext(e,t){const n=this.combine(e,t);return new _(n.x,n.y)}getPrevious(e,t){return this.getNext(e,-(t=t??1))}getLeft(e){return new _(this.x+e.y,this.y+-e.x)}getRight(e){return new _(this.x+-e.y,this.y+e.x)}isInRange(e,t){return!(this.x<0||this.y<0||e<=this.x||t<=this.y)}isNotInRange(e,t){return this.x<0||this.y<0||e<=this.x||t<=this.y}getDirectionToward(e){return me.factory.fromMove(this,e)}getOrthogonalDistance(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}getDistance(e){if(!1===e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");const t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}isHexagonallyAlignedWith(e){const t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}isAlignedWith(e){const t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}isNeighborWith(e){return!!this.isAlignedWith(e)&&1===this.getDistance(e)}getVectorToward(e){return new $t(e.x-this.x,e.y-this.y)}toVector(){return new $t(this.x,this.y)}getCoordsToward(e){if(L.assert(e.isAlignedWith(this),"Should only call getCoordsTowards on aligned coords"),e.equals(this))return[];const t=this.getDirectionToward(e).get();let n=this.getNext(t,1);const i=[];for(;!1===n.equals(e);)i.push(n),n=n.getNext(t,1);return i}getAllCoordsToward(e){let t=[this];if(!1===this.equals(e)){const n=this.getCoordsToward(e);t=t.concat(n).concat(e)}return t}equals(e){return this===e||e.x===this.x&&e.y===this.y}compareTo(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}toSVGPoint(){return this.x+","+this.y}scale(e,t){return new _(this.x*e,this.y*t)}}class wQ{getPlayerClass(e){switch(e){case O.ZERO:return"player0-fill";case O.ONE:return"player1-fill";default:return L.expectToBe(e,B.NONE),""}}}class ud extends wQ{SPACE_SIZE=100;STROKE_WIDTH=8;SMALL_STROKE_WIDTH=2;ArrayUtils=yt;getSVGTranslation(e,t){return"translate("+e+", "+t+")"}}class NQ extends wQ{activatedRoute;constructor(e){super(),this.activatedRoute=e}getGameName(){return L.getNonNullable(this.activatedRoute.snapshot.paramMap.get("compo"))}}let $c=class mR extends ud{messageDisplayer;encoder;Player=O;rules;node;config=h.empty();availableAIs;canPass=!1;scores=h.empty();imagesLocation="assets/images/";hasAsymmetricBoard=!1;rotation="";tutorial;isPlayerTurn;chooseMove;canUserPlay;cancelMoveOnWrapper;pointOfView=O.ZERO;interactive=!1;animationOngoing=!1;constructor(e){super(),this.messageDisplayer=e}getPointOfView(){return this.pointOfView}setPointOfView(e){this.pointOfView=e,this.hasAsymmetricBoard&&(this.rotation="rotate("+180*e.getValue()+")")}setInteractive(e){this.interactive=e}isInteractive(){return this.interactive}cancelMove(e){var t=this;return E(function*(){return t.cancelMoveAttempt(),t.cancelMoveOnWrapper(e),t.node.previousMove.isPresent()&&(yield t.showLastMove(t.node.previousMove.get(),t.getConfig())),null==e?A.SUCCESS:(t.messageDisplayer.gameMessage(e),A.failure(e))})()}cancelMoveAttempt(){}pass(){var e=this;return E(function*(){return Gi.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name})})()}getTurn(){return this.node.gameState.turn}getCurrentPlayer(){return this.node.gameState.getCurrentPlayer()}getCurrentOpponent(){return this.node.gameState.getCurrentOpponent()}getState(){return this.node.gameState}getPreviousState(){return this.node.parent.get().gameState}setRulesAndNode(e){const t=Vt.getByUrlName(e).get(),n=t.getRulesConfig();this.rules=t.rules,this.node=this.rules.getInitialNode(n),this.tutorial=t.tutorial.tutorial}getConfig(){return this.config}getTranslation(e){return this.getTranslationXY(e.x,e.y)}getTranslationXY(e,t){return`translate(${e*this.SPACE_SIZE} ${t*this.SPACE_SIZE})`}static \u0275fac=function(t){return new(t||mR)(G(Ut))};static \u0275cmp=$e({type:mR,selectors:[["ng-component"]],features:[We],decls:0,vars:0,template:function(t,n){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})};$c=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],$c);let J5=(()=>{class r extends $c{hexaLayout;hexaBoard;getHexaPoints(){return this.hexaLayout.getHexaPoints()}getCenterAtXY(t,n){const i=new _(t,n);return this.getCenterAt(i)}getCenterAt(t){return this.hexaLayout.getCenterAt(t)}getHexaCenterTranslation(t){return this.getHexaCenterTranslationAtXY(t.x,t.y)}getHexaCenterTranslationAtXY(t,n){const i=this.getCenterAtXY(t,n);return`translate(${i.x}, ${i.y})`}static \u0275fac=(()=>{let t;return function(i){return(t||(t=z1(r)))(i||r)}})();static \u0275cmp=$e({type:r,selectors:[["ng-component"]],features:[We],decls:0,vars:0,template:function(n,i){},encapsulation:2})}return r})();class Ee{player;reachable;static ZERO=new Ee(O.ZERO,!0);static ONE=new Ee(O.ONE,!0);static EMPTY=new Ee(B.NONE,!0);static UNREACHABLE=new Ee(B.NONE,!1);static ofPlayer(e){return e===O.ZERO?Ee.ZERO:(L.expectToBe(e,O.ONE),Ee.ONE)}constructor(e,t){this.player=e,this.reachable=t}equals(e){return this.player.equals(e.player)&&this.reachable===e.reachable}is(e){return this.player===e}isPlayer(){return this===Ee.ZERO||this===Ee.ONE}isReachable(){return this.reachable}getPlayer(){return this.player}}class Se extends CI{static UP=new Se(0,-1);static LEFT=new Se(-1,0);static UP_RIGHT=new Se(1,-1);static DOWN_LEFT=new Se(-1,1);static RIGHT=new Se(1,0);static DOWN=new Se(0,1);static factory=new class extends vI{all=[Se.UP,Se.UP_RIGHT,Se.RIGHT,Se.DOWN,Se.DOWN_LEFT,Se.LEFT]};static encoder=ke.fromFunctions(e=>{switch(e){case Se.UP:return 0;case Se.UP_RIGHT:return 1;case Se.RIGHT:return 2;case Se.DOWN:return 3;case Se.DOWN_LEFT:return 4;default:return 5}},e=>(L.assert(0<=e&&e<=5,"Invalid encoded number for HexaDirection "+e),Se.factory.all[e]));static getAngle(e){switch(e){case Se.UP:return 0;case Se.UP_RIGHT:return 60;case Se.RIGHT:return 120;case Se.DOWN:return 180;case Se.DOWN_LEFT:return 240;default:return L.expectToBe(e,Se.LEFT),300}}constructor(e,t){super(e,t)}getOpposite(){return Se.factory.from(-this.x,-this.y).get()}}class IQ{startAngle;conversionMatrix;inverseConversionMatrix}class CC extends IQ{static INSTANCE=new CC;startAngle=.5;conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5];inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3];constructor(){super()}}class jr extends IQ{static INSTANCE=new jr;startAngle=0;conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)];inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3];constructor(){super()}isOnBorder(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}isOnTopRightBorder(e,t){return 0===t.y}isOnRightBorder(e,t){return t.x===e.width-1}isOnLeftBorder(e,t){return 0===t.x}isOnBottomLeftBorder(e,t){return t.y===e.height-1}isOnTopLeftBorder(e,t){return null!=e.excludedSpaces[t.y]?t.x===e.excludedSpaces[t.y]:t.y===e.excludedSpaces.length&&0===t.x}isOnBottomRightBorder(e,t){return null!=e.excludedSpaces[e.height-1-t.y]?e.width-1-t.x===e.excludedSpaces[e.height-1-t.y]:e.height-1-t.y===e.excludedSpaces.length&&t.x===e.width-1}getAllBorders(e){const t=[];return e.forEachCoord((n,i)=>{this.isOnBorder(e,n)&&t.push(n)}),t}isTopCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}isTopLeftCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isTopRightCorner(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}isBottomCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}isBottomLeftCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isBottomRightCorner(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}class eu{size;origin;orientation;constructor(e,t,n){this.size=e,this.origin=t,this.orientation=n}getCenterAt(e){const t=this.orientation.conversionMatrix;return new _(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}getCornerOffset(e){const t=2*Math.PI*(this.orientation.startAngle+e)/6;return new _(this.size*Math.cos(t),this.size*Math.sin(t))}getHexaPointsList(){const e=[];for(let t=0;t<6;t+=1){const n=this.getCornerOffset(t);e.push(new _(n.x,n.y))}return e}getHexaPoints(){return this.getHexaPointsList().map(t=>t.toSVGPoint()).join(" ")}getIsoPoints(e,t){L.assert(this.orientation===jr.INSTANCE,"HexaLayout.getIsoPoints can only be used with flat orientation");const n=this.getCenterAt(e),i=this.getCornerOffset(0),o=this.getCornerOffset(1),s=this.getCornerOffset(2),a=this.getCornerOffset(3);return[[new _(n.x+a.x,n.y+a.y),new _(n.x+a.x,n.y+a.y+t),new _(n.x+s.x,n.y+s.y+t),new _(n.x+s.x,n.y+s.y)],[new _(n.x+i.x,n.y+i.y),new _(n.x+i.x,n.y+i.y+t),new _(n.x+o.x,n.y+o.y+t),new _(n.x+s.x,n.y+s.y+t),new _(n.x+s.x,n.y+s.y),new _(n.x+o.x,n.y+o.y)],[new _(n.x+a.x,n.y+a.y),new _(n.x+a.x,n.y+a.y+t),new _(n.x+s.x,n.y+s.y+t),new _(n.x+o.x,n.y+o.y+t),new _(n.x+i.x,n.y+i.y+t),new _(n.x+i.x,n.y+i.y),new _(n.x+o.x,n.y+o.y),new _(n.x+s.x,n.y+s.y)]]}}let Me=(()=>class r{static MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT=()=>$localize`You have selected a piece of the opponent. You must pick one of your pieces.`;static MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=()=>$localize`You have selected an empty space, you must select one of your own pieces.`;static MUST_CLICK_ON_EMPTY_SPACE=()=>$localize`You must click on an empty space.`;static MUST_CLICK_ON_EMPTY_SQUARE=()=>$localize`You must click on an empty square.`;static SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE=()=>$localize`Your landing space should be empty or contain a piece of the opponent.`;static CANNOT_SELF_CAPTURE=()=>$localize`You cannot capture your own pieces.`;static CANNOT_PASS=()=>$localize`You cannot pass your turn.`;static MUST_LAND_ON_EMPTY_SPACE=()=>$localize`You must drop your piece on an empty space.`;static MUST_PASS=()=>$localize`You must pass your turn.`;static MOVE_CANNOT_BE_STATIC=()=>$localize`You must choose different starting and ending coordinates.`;static SOMETHING_IN_THE_WAY=()=>$localize`There is a piece between the piece you chose and its landing space.`;static MUST_MOVE_ON_NEIGHBOR=()=>$localize`You must move on a direct neighboring space.`})(),Ml=(()=>class r{static CANNOT_MOVE_MORE_THAN_THREE_PIECES=()=>$localize`You cannot move more than 3 of your pieces!`;static NOT_ENOUGH_PIECE_TO_PUSH=()=>$localize`You don't have enough pieces to push that group!`;static CANNOT_PUSH_YOUR_OWN_PIECES=()=>$localize`You cannot push this piece because it is blocked by one of yours!`;static MUST_ONLY_TRANSLATE_YOUR_PIECES=()=>$localize`This line contains pieces of your opponent or empty spaces, which is forbidden.`;static TRANSLATION_IMPOSSIBLE=()=>$localize`This move is impossible, some landing spaces are occupied.`;static LINE_AND_COORD_NOT_ALIGNED=()=>$localize`This space is not aligned with the current line.`})();class $1 extends mC{board;constructor(e,t){super(t),this.board=e}getPieceAt(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}has(e,t){return this.isOnBoard(e)&&zo(this.getPieceAt(e),t)}setPieceAt(e,t,n){const i=this.getCopiedBoard();return i[e.y][e.x]=t,n(this,i)}tryToGetPieceAt(e){return this.isOnBoard(e)?h.of(this.board[e.y][e.x]):h.empty()}isOnBoard(e){return e.isInRange(this.board[0].length,this.board.length)}getPieceAtXY(e,t){return this.getPieceAt(new _(e,t))}getOptionalPieceAtXY(e,t){const n=new _(e,t);return this.isOnBoard(n)?h.of(this.getPieceAt(n)):h.empty()}forEachCoord(e){for(const{coord:t,content:n}of this.getCoordsAndContents())e(t,n)}getCoordsAndContents(){const e=[];for(let t=0;t<this.getHeight();t++)for(let n=0;n<this.board[t].length;n++){const i=new _(n,t);this.isOnBoard(i)&&e.push({coord:i,content:this.getPieceAt(i)})}return e}getCopiedBoard(){return it.copy(this.board)}toMap(){const e=[];for(let t=0;t<this.getHeight();t++)for(let n=0;n<this.getWidth();n++){const i=new _(n,t);e.push({key:i,value:this.getPieceAt(i)})}return e}getWidth(){return this.board[0].length}getHeight(){return this.board.length}isHorizontalEdge(e){const t=this.getHeight()-1;return 0===e.y||e.y===t}isVerticalEdge(e){const t=this.getWidth()-1;return 0===e.x||e.x===t}isEdge(e){return this.isHorizontalEdge(e)||this.isVerticalEdge(e)}isCorner(e){return this.isHorizontalEdge(e)&&this.isVerticalEdge(e)}[Symbol.iterator](){const e=[];for(const t of this.board)e.push(...t);return e.values()}}class qs extends wr{static singleton=h.empty();static get(){return qs.singleton.isAbsent()&&(qs.singleton=h.of(new qs)),qs.singleton.get()}getInitialState(){const e=Ee.EMPTY,t=Ee.UNREACHABLE,n=Ee.ZERO,i=Ee.ONE;return new js([[t,t,t,t,i,i,i,i,i],[t,t,t,i,i,i,i,i,i],[t,t,e,e,i,i,i,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,n,n,n,e,e,t,t],[n,n,n,n,n,n,t,t,t],[n,n,n,n,n,t,t,t,t]],0)}static isLegalRealPush(e,t,n,i,o){let s=0;const a=Ee.ofPlayer(n.getCurrentOpponent()),c=Ee.ofPlayer(n.getCurrentPlayer());for(;s<i&&n.isOnBoard(e)&&n.getPieceAt(e)===a;)s++,e=e.getNext(t.dir);return i<=s?X.failure(Ml.NOT_ENOUGH_PIECE_TO_PUSH()):js.isOnBoard(e)&&(n.getPieceAt(e)===Ee.EMPTY&&(o[e.y][e.x]=a),n.getPieceAt(e)===c)?X.failure(Ml.CANNOT_PUSH_YOUR_OWN_PIECES()):X.success(o)}applyLegalMove(e,t,n,i){return new js(i,t.turn+1)}isLegal(e,t){const n=this.getFirstPieceValidity(e,t);return n.isFailure()?n.toOtherFallible():e.isSingleCoord()?this.isLegalPush(e,t):this.isLegalSideStep(e,t)}getFirstPieceValidity(e,t){const n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===Ee.ofPlayer(t.getCurrentOpponent())?A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):A.SUCCESS}isLegalPush(e,t){let n=1,i=e.coord.getNext(e.dir);const o=Ee.ofPlayer(t.getCurrentPlayer()),s=Ee.EMPTY,a=t.getCopiedBoard();for(a[e.coord.y][e.coord.x]=s;n<=3&&t.isOnBoard(i)&&t.getPieceAt(i)===o;)n++,i=i.getNext(e.dir);return n>3?X.failure(Ml.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===js.isOnBoard(i)||(a[i.y][i.x]=o,t.getPieceAt(i)===s)?X.success(a):qs.isLegalRealPush(i,e,t,n,a)}isLegalSideStep(e,t){let n=e.lastPiece.get();const i=e.coord.getDirectionToward(n).get();n=n.getNext(i);let o=e.coord;const s=Ee.ofPlayer(t.getCurrentPlayer()),a=t.getCopiedBoard();for(;!1===o.equals(n)&&js.isOnBoard(o);){if(t.getPieceAt(o)!==s)return X.failure(Ml.MUST_ONLY_TRANSLATE_YOUR_PIECES());const c=o.getNext(e.dir);if(a[o.y][o.x]=Ee.EMPTY,js.isOnBoard(c)){if(t.isPiece(c))return X.failure(Ml.TRANSLATION_IMPOSSIBLE());t.getPieceAt(c)===Ee.EMPTY&&(a[c.y][c.x]=s)}o=o.getNext(i)}return X.success(a)}getGameStatus(e){const t=e.gameState.getScores();return 5<t.get(O.ZERO)?ve.ZERO_WON:5<t.get(O.ONE)?ve.ONE_WON:ve.ONGOING}}class js extends $1{static isOnBoard(e){return e.isInRange(9,9)&&qs.get().getInitialState().getPieceAt(e)!==Ee.UNREACHABLE}isPiece(e){return this.getPieceAt(e).isPlayer()}getScores(){const e=we.of(14,14);for(const t of this.getCoordsAndContents()){const n=t.content;if(n.isPlayer()){const i=n.getPlayer();e.add(i.getOpponent(),-1)}}return e}}class Nr extends C2{static getFallibleEncoder(e){return ke.tuple([_.encoder],t=>[t.coord],t=>e(t[0]).get())}static getEncoder(e){return ke.tuple([_.encoder],t=>[t.coord],t=>e(t[0]))}coord;constructor(e,t){super(),this.coord=new _(e,t)}equals(e){return this===e||this.coord.equals(e.coord)}}class v2 extends Nr{dir;lastPiece;static encoder=ke.tuple([_.encoder,Se.encoder,h.getEncoder(_.encoder)],e=>[e.coord,e.dir,e.lastPiece],e=>new v2(e[0],e[1],e[2]));static ofSingleCoord(e,t){return L.assert(e.isInRange(9,9),go.OUT_OF_RANGE(e)),new v2(e,t,h.empty())}static ofDoubleCoord(e,t,n){const i=[e,t];yt.sortByDescending(i,v2.sortCoord);const o=i[1].getDirectionToward(i[0]).get(),s=Se.factory.fromDelta(o.x,o.y);L.assert(s.isSuccess(),"Invalid direction");const a=s.get(),c=i[1].getDistance(i[0]);return L.assert(c<=2,"Distance between first coord and last coord is too big"),a.equals(n)?v2.ofSingleCoord(i[1],n):a.getOpposite().equals(n)?v2.ofSingleCoord(i[0],n):new v2(i[1],n,h.of(i[0]))}static sortCoord(e){return 9*e.y+e.x}constructor(e,t,n){super(e.x,e.y),this.dir=t,this.lastPiece=n}toString(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}isSingleCoord(){return this.lastPiece.isAbsent()}equals(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}class kn{name;moveGenerator;rules;explorationParameter=Math.sqrt(2);maxGameLength=8;availableOptions=[];constructor(e,t,n){this.name=e,this.moveGenerator=t,this.rules=n;for(let i=1;i<10;i++)this.availableOptions.push({name:i*i+" seconds",maxSeconds:i*i})}chooseNextMove(e,t,n){L.assert(!1===this.rules.getGameStatus(e,n).isEndGame,"cannot search from a finished game");const i=e.gameState.getCurrentPlayer(),o=Date.now(),s=Date.now()+1e3*t.maxSeconds;let a=0;for(;Date.now()<s;){const f=this.expand(this.select({node:e,path:[e]}),n),g=this.simulate(f.node,s,n);this.backpropagate(f.path,this.winScore(g,i)),a++}Ne.display("MCTS","chooseNextMove","root winRatio: "+this.winRatio(e)),Ne.display("MCTS","chooseNextMove","children winRatio: "+e.getChildren().map(f=>f.id+": "+this.winRatio(f)));const c=yt.maximumsBy(e.getChildren(),f=>this.winRatio(f)),l=yt.getRandomElement(c),u=(Date.now()-o)/1e3;return Ne.display("MCTS","chooseNextMove",`Computed ${a} in ${u} (rate: ${a/u} it/s)`),Ne.display("MCTS","chooseNextMove","Best child has a win ratio of: "+this.winRatio(l)),l.previousMove.get()}winScore(e,t){switch(e){case ve.DRAW:case ve.ONGOING:return.5;default:return e.winner===t?1:0}}ucb(e,t){const n=this.simulations(e);return 0===t||0===n?Number.MAX_SAFE_INTEGER:this.wins(e)/n+this.explorationParameter*Math.sqrt(Math.log(t)/n)}winRatio(e){const t=this.simulations(e);return 0===this.simulations(e)?1:this.wins(e)/t}wins(e){return this.getCounterFromCache(e,"wins")}simulations(e){return this.getCounterFromCache(e,"simulations")}getCounterFromCache(e,t){const n=e.getCache(t);return n.isPresent()?n.get():(e.setCache(t,0),0)}select(e){const t=e.node;if(Ne.display("MCTS","select","Exploring node: "+t.id),t.hasChildren()){const n=this.simulations(t);Ne.display("MCTS","select","UCB values: "+t.getChildren().map(s=>s.id+": "+this.ucb(t,n)));const i=yt.maximumsBy(t.getChildren(),s=>this.ucb(s,n)),o=yt.getRandomElement(i);return Ne.display("MCTS","select","selecting children "+o.id),this.select({node:o,path:e.path.concat([o])})}return Ne.display("MCTS","select","this is a leaf node, we select it"),e}expand(e,t){if(this.rules.getGameStatus(e.node,t).isEndGame)return e;const n=e.node,i=this.moveGenerator.getListMoves(n,t);L.assert(i.length>0,`${this.name}: move generator did not return any move on a non-finished game: ${this.moveGenerator.constructor.name}`);for(const s of i)n.addChild(this.play(n,s,t));const o=yt.getRandomElement(n.getChildren());return{node:o,path:e.path.concat([o])}}simulate(e,t,n){Ne.display("MCTS","simulate","simulate from node which has a last move of "+e.previousMove.get().toString());let i=e,o=0;for(;o<this.maxGameLength&&Date.now()<t;){const s=this.rules.getGameStatus(i,n);if(s.isEndGame)return Ne.display("MCTS","simulate",`end game in ${o} steps, winner is ${s.winner}`),s;o++,i=this.playRandomStep(i,n)}return ve.ONGOING}playRandomStep(e,t){const n=yt.getRandomElement(this.moveGenerator.getListMoves(e,t));return this.play(e,n,t)}play(e,t,n){const i=this.rules.isLegal(t,e.gameState,n);L.assert(i.isSuccess(),"heuristic returned illegal move");const o=this.rules.applyLegalMove(t,e.gameState,n,i.get());return new ps(o,h.of(e),h.of(t))}backpropagate(e,t){for(const n of e)this.addSimulationResult(n,t),Ne.display("MCTS","backpropagate","backpropagate to node which now has "+this.wins(n)/this.simulations(n))}addSimulationResult(e,t){const n=this.simulations(e)+1,i=this.wins(e)+t;e.setCache("wins",i),e.setCache("simulations",n)}getInfo(e){return`wins/simulations=${this.getCounterFromCache(e,"wins")}/${this.getCounterFromCache(e,"simulations")}`}}class Ha{}class or extends Ha{getBoardValue(e,t){const n=this.getMetrics(e,t);return gn.ofMultiple(n.get(O.ZERO).get(),n.get(O.ONE).get())}}class yI extends or{getMetrics(e,t){return U1.ofSingle(0,0)}}class cn{name;rules;heuristic;moveGenerator;random=!1;prune=!0;availableOptions=[];constructor(e,t,n,i){this.name=e,this.rules=t,this.heuristic=n,this.moveGenerator=i;for(let o=1;o<10;o++)this.availableOptions.push({name:`Level ${o}`,maxDepth:o})}toString(){return this.name}chooseNextMove(e,t,n){L.assert(!1===this.rules.getGameStatus(e,n).isEndGame,"Minimax has been asked to choose a move from a finished game");const i=this.getExpectedExtremum(e,n);let o=this.alphaBeta(e,t.maxDepth,i.toMinimum(),i.toMaximum(),n);for(;o.gameState.turn>e.gameState.turn+1;)o=o.parent.get();return o.previousMove.get()}alphaBeta(e,t,n,i,o){if(t<1)return e;if(this.rules.getGameStatus(e,o).isEndGame)return e;const s=this.getPossibleMoves(e,o);L.assert(s.size()>0,"Minimax "+this.name+" should give move, received none!");const a=this.getBestChildren(e,s,t,n,i,o),c=this.getBestChildAmong(a),l=this.getScore(c,o);return this.setScore(e,l),c}getPossibleMoves(e,t){const n=this.getMoves(e);if(n.isAbsent()){const i=this.moveGenerator.getListMoves(e,t);return this.setMoves(e,new ct(i)),new ct(i)}return n.get()}getBestChildren(e,t,n,i,o,s){let a=[];const c=e.gameState.getCurrentPlayer();let l=this.getExpectedExtremum(e,s);const u=c===O.ZERO?gn.isLessThan:gn.isGreaterThan;for(const f of t){const g=this.getOrCreateChild(e,f,s),y=this.alphaBeta(g,n-1,i,o,s),S=this.getScore(y,s);if(u(S,l)||0===a.length?(l=S,a=[y]):S.equals(l)&&a.push(y),this.prune&&u(l,c===O.ZERO?i:o))break;c===O.ZERO?o=gn.min(l,o):i=gn.max(l,i)}return a}getExpectedExtremum(e,t){const n=this.getScore(e,t);return e.gameState.getCurrentPlayer()===O.ZERO?n.toMaximum():n.toMinimum()}getBestChildAmong(e){return this.random?yt.getRandomElement(e):e[0]}getOrCreateChild(e,t,n){const i=e.getChild(t);if(i.isAbsent()){const o=this.rules.isLegal(t,e.gameState,n),s=t.toString();L.assert(o.isSuccess(),'The minimax "'+this.name+'" has proposed an illegal move ('+s+"), refusal reason: "+o.getReasonOr("")+" this should not happen.");const a=this.rules.applyLegalMove(t,e.gameState,n,o.get()),c=new ps(a,h.of(e),h.of(t));return e.addChild(c),this.setScore(c,this.computeBoardValue(c,n)),c}return i.get()}setScore(e,t){e.setCache(this.name+"-score",t)}getScore(e,t){const n=e.getCache(this.name+"-score");if(n.isPresent())return n.get();{const i=this.computeBoardValue(e,t);return this.setScore(e,i),i}}computeBoardValue(e,t){const n=this.rules.getGameStatus(e,t);return n.isEndGame?n.toBoardValue():this.heuristic.getBoardValue(e,t)}setMoves(e,t){e.setCache(this.name+"-moves",t)}getMoves(e){return e.getCache(this.name+"-moves")}getInfo(e,t){return"BoardValue="+this.heuristic.getBoardValue(e,t).metrics}}class YIe extends or{getMetrics(e,t){return e.gameState.getScores().toTable()}}class Yn{}let KIe=(()=>class r{static aiTime=0})();class kQ extends Yn{getListMoves(e,t){const n=[],i=e.gameState,o=i.getCurrentPlayer();for(let s=0;s<9;s++)for(let a=0;a<9;a++){const c=new _(a,s);if(!1!==i.getPieceAt(c).is(o))for(const l of Se.factory.all){const u=v2.ofSingleCoord(c,l);if(this.isAcceptablePush(u,i)){n.push(u);for(const f of Se.factory.all)for(let g=1;g<=2&&!f.equals(l);g++){const y=c.getNext(f,g);if(!js.isOnBoard(y))break;{const S=v2.ofDoubleCoord(c,y,l);qs.get().isLegal(S,i).isSuccess()&&n.push(S)}}}}}return new ct(n).toList()}isAcceptablePush(e,t){const n=t.getScores(),i=qs.get().isLegal(e,t);if(i.isSuccess()){const o=t.getCurrentOpponent(),a=new js(i.get(),t.turn+1).getScores();return!(n.get(o)<a.get(o))}return!1}}function XIe(r,e){if(1&r){const t=de();N(),M(0,"circle",6),W("click",function(){te(t);const i=p(2).index,o=p().index;return ne(p().onPieceClick(i,o))}),P()}if(2&r){const t=p(2).index,n=p().index,i=p();Ce("id","piece_",t,"_",n,""),v("ngClass",i.getPieceClasses(t,n)),w("r",.5*i.SPACE_SIZE)}}function QIe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"polygon",4),W("click",function(){te(t);const i=p().index,o=p().index;return ne(p().onSpaceClick(i,o))}),P(),z(2,XIe,1,4,"circle",5),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();w("transform",s.getHexaCenterTranslationAtXY(n,o)),m(),Ce("id","space_",n,"_",o,""),v("ngClass",s.getSquareClasses(n,o)),w("points",s.getHexaPoints()),m(),v("ngIf",s.isPiece(i))}}function JIe(r,e){if(1&r&&(N(),M(0,"g"),z(1,QIe,3,6,"g",3),P()),2&r){const t=e.$implicit,n=p(2);m(),v("ngIf",n.isBoard(t))}}function eke(r,e){if(1&r&&(N(),M(0,"g"),z(1,JIe,2,1,"g",1),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function tke(r,e){if(1&r&&(N(),M(0,"g"),V(1,"polygon",7)(2,"circle",8),P()),2&r){const t=e.$implicit,n=p();w("transform",n.getHexaCenterTranslation(t.coord)),m(),Ce("id","space_",t.coord.x,"_",t.coord.y,""),v("ngClass",n.getSquareClasses(t.coord.x,t.coord.y)),w("points",n.getHexaPoints()),m(),Ce("id","piece_",t.coord.x,"_",t.coord.y,""),v("ngClass",t.pieceClasses),w("r",.5*n.SPACE_SIZE)}}function nke(r,e){if(1&r){const t=de();N(),M(0,"g",9),V(1,"line",10),M(2,"polygon",11),W("click",function(){const o=te(t).$implicit;return ne(p().chooseDirection(o.dir))}),P()()}if(2&r){const t=e.$implicit;Ag("id","arrow_",t.start.x,"_",t.start.y,"_to_",t.landing.x,"_",t.landing.y,""),m(),En("id","line_",t.dir.toString(),""),w("x1",t.startCenter.x)("y1",t.startCenter.y)("x2",t.landingCenter.x)("y2",t.landingCenter.y),m(),En("id","direction_",t.dir.toString(),""),w("transform",t.transformation)}}class rke{start;startCenter;landing;landingCenter;dir;transformation;constructor(e,t,n,i,o,s){this.start=e,this.startCenter=t,this.landing=n,this.landingCenter=i,this.dir=o,this.transformation=s}}let ike=(()=>{class r extends J5{moveds=[];captureds=[];directions=[];selecteds=[];constructor(t){super(t),this.setRulesAndNode("Abalone"),this.availableAIs=[new cn($localize`Score`,this.rules,new YIe,new kQ),new kn($localize`MCTS`,new kQ,this.rules)],this.encoder=v2.encoder,this.scores=h.of(we.of(0,0)),this.SPACE_SIZE=30,this.hexaLayout=new eu(this.SPACE_SIZE,new _(-8*this.SPACE_SIZE,2*this.SPACE_SIZE),CC.INSTANCE)}updateBoard(t){var n=this;return E(function*(){n.hexaBoard=n.getState().getCopiedBoard(),n.scores=h.of(n.getState().getScores())})()}hideLastMove(){this.moveds=[],this.captureds=[]}cancelMoveAttempt(){this.directions=[],this.selecteds=[]}showLastMove(t){var n=this;return E(function*(){t.isSingleCoord()?n.showPushingMove(t):n.showSideStepMove(t)})()}showPushingMove(t){const n=this.getPreviousState();let i=t.coord;for(this.moveds=[i],i=i.getNext(t.dir);js.isOnBoard(i)&&n.isPiece(i);)this.moveds.push(i),i=i.getNext(t.dir);if(js.isOnBoard(i))this.moveds.push(i);else{const o=i.getPrevious(t.dir),s=n.getPieceAt(o);this.captureds=[{coord:i,pieceClasses:[this.getPlayerClass(s.getPlayer())]}]}}showSideStepMove(t){let n=t.lastPiece.get();const i=t.coord.getDirectionToward(n).get();n=n.getNext(i);let o=t.coord;for(;!1===o.equals(n);){this.moveds.push(o);const s=o.getNext(t.dir);if(js.isOnBoard(s))this.moveds.push(s);else{const a=this.getPreviousState().getCurrentPlayer();this.captureds.push({coord:s,pieceClasses:[this.getPlayerClass(a)]})}o=o.getNext(i)}}onPieceClick(t,n){var i=this;return E(function*(){const o=yield i.canUserPlay("#piece_"+t+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=i.getState().getCurrentOpponent();return i.hexaBoard[n][t].is(s)?i.opponentClick(t,n):0===i.selecteds.length?i.firstClick(t,n):1===i.selecteds.length?i.secondClick(t,n):i.thirdClick(t,n)})()}opponentClick(t,n){var i=this;return E(function*(){return(yield i.tryChoosingDirection(t,n)).isSuccess()?A.SUCCESS:i.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())})()}firstClick(t,n){var i=this;return E(function*(){return i.selecteds=[new _(t,n)],i.showPossibleDirections(),A.SUCCESS})()}showPossibleDirections(){this.directions=[],L.assert(this.selecteds.length>0,"do not call showPossibleDirections if there is no selected piece"),this.showDirection()}showDirection(){const t=this.getState();for(const n of Se.factory.all){const i=this.getArrowPath(n);let o;if(o=1===this.selecteds.length?v2.ofSingleCoord(i.start,n):v2.ofDoubleCoord(i.start,i.end,n),this.rules.isLegal(o,t).isSuccess()){const a=this.getCenterAt(i.pointed),c=a.x+" "+a.y,g="rotate("+(Se.getAngle(n)+150)+" "+c+") translate("+c+")",y=new rke(i.start,this.getCenterAt(i.start),i.pointed,this.getCenterAt(i.pointed),n,g);this.directions.push(y)}}}getArrowPath(t){let n=this.selecteds[0],i=this.selecteds[this.selecteds.length-1];if(this.selecteds.length>1&&n.getDirectionToward(i).get().equals(t.getOpposite())){const o=n;n=i,i=o}return{start:n,end:i,pointed:this.getPointed(n,i,t)}}getPointed(t,n,i){if(1===this.selecteds.length||t.getDirectionToward(n).get().equals(i)){const s=this.getState(),a=s.getCurrentPlayer();let c=n;for(;s.isOnBoard(c)&&s.getPieceAt(c).is(a);)c=c.getNext(i,1);return c}return t.getNext(i,1)}isBoard(t){return t!==Ee.UNREACHABLE}isPiece(t){return t!==Ee.EMPTY}secondClick(t,n){var i=this;return E(function*(){const o=i.selecteds[0],s=new _(t,n);if(s.equals(o))return i.cancelMoveAttempt(),A.SUCCESS;if(!1===s.isHexagonallyAlignedWith(o))return i.cancelMoveAttempt(),i.firstClick(t,n);const a=s.getDistance(o);if(a>2)return i.cancelMove(Ml.CANNOT_MOVE_MORE_THAN_THREE_PIECES());const c=o.getDirectionToward(s).get();i.selecteds=[o];for(let l=0;l<a;l++)i.selecteds.push(o.getNext(c,l+1));if(3===i.selecteds.length){const l=i.selecteds[1],u=i.getState().getCurrentPlayer();if(!1===i.hexaBoard[l.y][l.x].is(u))return i.cancelMoveAttempt(),i.firstClick(t,n)}return i.showPossibleDirections(),A.SUCCESS})()}thirdClick(t,n){var i=this;return E(function*(){const o=new _(t,n),s=i.selecteds[0];if(o.equals(s))return i.deselectExtremity(!0);const a=i.selecteds[i.selecteds.length-1];return o.equals(a)?i.deselectExtremity(!1):3===i.selecteds.length&&o.equals(i.selecteds[1])?(i.cancelMoveAttempt(),A.SUCCESS):i.tryExtension(o,s,a)})()}tryExtension(t,n,i){var o=this;return E(function*(){const s=me.factory.fromMove(n,t);if(s.isSuccess()){const c=me.factory.fromMove(i,t);if(s.equals(c)){const l=n.getDistance(t),u=i.getDistance(t);return 2===Math.max(l,u)?(o.selecteds.push(t),yt.sortByDescending(o.selecteds,v2.sortCoord),o.showPossibleDirections(),A.SUCCESS):o.cancelMove(Ml.CANNOT_MOVE_MORE_THAN_THREE_PIECES())}}const a=yield o.cancelMove(Ml.LINE_AND_COORD_NOT_ALIGNED());return yield o.firstClick(t.x,t.y),a})()}deselectExtremity(t){var n=this;return E(function*(){return n.selecteds=n.selecteds.slice(t?1:0,t?void 0:-1),n.showPossibleDirections(),A.SUCCESS})()}chooseDirection(t){var n=this;return E(function*(){const i=yield n.canUserPlay("#direction_"+t.toString());return i.isFailure()?n.cancelMove(i.getReason()):n._chooseDirection(t)})()}_chooseDirection(t){var n=this;return E(function*(){const i=n.selecteds[0];if(1===n.selecteds.length){const o=v2.ofSingleCoord(i,t);return n.chooseMove(o)}{const s=v2.ofDoubleCoord(i,n.selecteds[n.selecteds.length-1],t);return n.chooseMove(s)}})()}onSpaceClick(t,n){var i=this;return E(function*(){const o=yield i.canUserPlay("#space_"+t+"_"+n);return o.isFailure()?i.cancelMove(o.getReason()):i.tryChoosingDirection(t,n)})()}tryChoosingDirection(t,n){var i=this;return E(function*(){const o=new _(t,n);for(const s of i.directions)if(s.landing.equals(o))return i._chooseDirection(s.dir);return A.failure("not a direction")})()}getSquareClasses(t,n){const i=new _(t,n),o=[];return this.moveds.some(s=>s.equals(i))&&o.push("moved-fill"),o}getPieceClasses(t,n){const i=new _(t,n),o=this.hexaBoard[n][t].getPlayer(),s=[this.getPlayerClass(o)];return this.selecteds.some(a=>a.equals(i))&&s.push("selected-stroke"),s}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-abalone"]],features:[We],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["cx","0","cy","0","class","base",3,"id","ngClass","click",4,"ngIf"],["cx","0","cy","0",1,"base",3,"id","ngClass","click"],["stroke-linecap","round",1,"base","captured-fill",3,"id","ngClass"],["cx","0","cy","0",1,"base","semi-transparent",3,"id","ngClass"],[3,"id"],[1,"arrow","click-delegator",3,"id"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(n,i){1&n&&(N(),M(0,"svg",0),z(1,eke,2,1,"g",1)(2,tke,3,9,"g",1)(3,nke,3,11,"g",2),P()),2&n&&(m(),v("ngForOf",i.hexaBoard),m(),v("ngForOf",i.captureds),m(),v("ngForOf",i.directions))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();class MI extends Yn{getListMoves(e,t){const n=e.gameState;return ir.ALL_MOVES.filter(function i(o){return Va.get().isLegal(o,n).isSuccess()})}}class oke extends or{getMetrics(e,t){const n=U1.of([0,0,0,0],[0,0,0,0]);for(let i=0;i<4;i++){const o=e.gameState.board[3-i].getDominatingPlayer();o.isPlayer()&&n.add(o,i,1)}return n}}class ske extends or{getMetrics(e,t){const n=e.gameState.board[3].getDominatingPlayer(),i=U1.of([0],[0]);return n.isPlayer()&&i.add(n,0,1),i}}function ake(r,e){if(1&r&&(N(),V(0,"circle",5)),2&r){const t=e.$implicit,n=p();w("cx",n.getRemainingPieceCx(t))("cy",n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function cke(r,e){if(1&r&&(N(),V(0,"circle",6)),2&r){const t=e.$implicit,n=p();w("cx",n.BOARD_WIDTH-n.getRemainingPieceCx(t))("cy",n.BOARD_HEIGHT-n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function lke(r,e){if(1&r){const t=de();N(),M(0,"polygon",9),W("click",function(){te(t);const i=p().index,o=p();return ne(o.onArrowClick(i,o.PlayerOrNone.ZERO))}),P()}if(2&r){const t=p().index,n=p();En("id","dropArrow_zero_",t,""),v("ngClass",n.getArrowClasses(t,n.PlayerOrNone.ZERO)),w("points",n.ARROW_COORD)("transform","translate("+n.SPACE_SIZE/2+" "+-n.SPACE_SIZE/2+")")}}function uke(r,e){if(1&r){const t=de();N(),M(0,"polygon",9),W("click",function(){te(t);const i=p().index,o=p();return ne(o.onArrowClick(i,o.PlayerOrNone.ONE))}),P()}if(2&r){const t=p().index,n=p();En("id","dropArrow_one_",t,""),v("ngClass",n.getArrowClasses(t,n.PlayerOrNone.ONE)),w("points",n.ARROW_COORD)("transform","translate(0 "+-n.SPACE_SIZE/2+")")}}function fke(r,e){if(1&r){const t=de();N(),jt(0),M(1,"circle",10),W("click",function(){te(t);const i=p().index;return ne(p().onSquareClick(i))}),P(),Zt()}if(2&r){const t=e.$implicit,n=p(),i=n.index,o=n.$implicit,s=p();m(),Hr("id","square_",i,"_piece_",t,"_out_of_",o.count(s.PlayerOrNone.NONE),""),v("ngClass",s.getPieceClasses(i,t,o)),w("cx",s.getCircleCenter(i,t,o).x)("cy",s.getCircleCenter(i,t,o).y)}}function dke(r,e){if(1&r){const t=de();N(),M(0,"g"),z(1,lke,1,4,"polygon",7)(2,uke,1,4,"polygon",7),M(3,"rect",8),W("click",function(){const o=te(t).index;return ne(p().onSquareClick(o))}),P(),z(4,fke,2,6,"ng-container",4),P()}if(2&r){const t=e.$implicit,n=e.index,i=p();w("transform",i.getBlockTransform(n)),m(),v("ngIf",i.canDisplayArrow(n,i.PlayerOrNone.ZERO)),m(),v("ngIf",i.canDisplayArrow(n,i.PlayerOrNone.ONE)),m(),En("id","square_",n,""),v("ngClass",i.getSquareClasses(n)),w("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),m(),v("ngForOf",i.ArrayUtils.range(t.count(i.PlayerOrNone.NONE)))}}let hke=(()=>{class r extends $c{PlayerOrNone=B;BOARD_WIDTH=4*this.SPACE_SIZE;BOARD_HEIGHT=4.5*this.SPACE_SIZE;board;remainingZero;remainingOne;ARROW_COORD=r.getArrowCoord();PIECES_PER_PLAYER=Va.PIECES_PER_PLAYER;PIECE_RADIUS;movedSquare;selectedPiece=h.empty();leftPiece=h.empty();droppedPiece=h.empty();displayableArrow=[];static getArrowCoord(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}constructor(t){super(t),this.setRulesAndNode("Apagos"),this.availableAIs=[new cn($localize`Rightmost Focus`,this.rules,new ske,new MI),new cn($localize`Full Board`,this.rules,new oke,new MI),new kn($localize`MCTS`,new MI,this.rules)],this.encoder=ir.encoder,this.hasAsymmetricBoard=!0,this.PIECE_RADIUS=2*this.SPACE_SIZE/(this.PIECES_PER_PLAYER+.5)}cancelMoveAttempt(){this.selectedPiece=h.empty(),this.showPossibleDrops()}updateBoard(t){var n=this;return E(function*(){const i=n.getState();n.board=i.board,n.remainingZero=i.remaining.get(O.ZERO),n.remainingOne=i.remaining.get(O.ONE),n.hideLastMove(),n.showPossibleDrops()})()}hideLastMove(){this.movedSquare=[],this.droppedPiece=h.empty(),this.leftPiece=h.empty(),this.selectedPiece=h.empty()}showLastMove(t){var n=this;return E(function*(){t.isDrop()?n.showLastDrop(t):n.showLastTransfer(t)})()}showLastDrop(t){const n=t.piece.get();let i=t.landing.x;this.movedSquare=[i],3!==t.landing.x&&(i+=1,this.movedSquare.push(i));const s=this.getLowestPlayerPiece(this.board[i],n);this.droppedPiece=h.of({square:i,piece:s})}getLowestPlayerPiece(t,n){const i=t.count(n);return n===O.ZERO?i-1:t.count(B.NONE)-i}showLastTransfer(t){const n=this.getPreviousState(),i=n.getCurrentPlayer(),o=t.starting.get().x,a=this.getLowestPlayerPiece(n.board[o],i);this.leftPiece=h.of({square:o,piece:a});const c=t.landing.x,u=this.getLowestPlayerPiece(this.board[c],i);this.droppedPiece=h.of({square:c,piece:u})}showPossibleDrops(){this.displayableArrow=[];const t=this.getState();for(let n=0;n<4;n++)!1===t.board[n].isFull()&&(t.remaining.get(O.ZERO)>0&&this.displayableArrow.push({x:n,player:O.ZERO}),t.remaining.get(O.ONE)>0&&this.displayableArrow.push({x:n,player:O.ONE}))}getCircleCenter(t,n,i){const o=this.SPACE_SIZE/2,s=this.SPACE_SIZE/2;if(1===i.count(B.NONE))return new _(o,s);const a=i.count(B.NONE),c=2*n*Math.PI/a-Math.PI/2,l=.3*this.SPACE_SIZE,u=l*Math.cos(c),f=l*Math.sin(c);return new _(o+u,s+f)}canDisplayArrow(t,n){return this.displayableArrow.some(i=>i.x===t&&i.player.equals(n))}getArrowClasses(t,n){return[this.getPlayerClass(n)]}getBlockTransform(t){return"translate("+t*this.SPACE_SIZE+", "+((3-t)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}getSquareClasses(t){const n=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===t?n.push("selected-stroke"):this.movedSquare.includes(t)&&n.push("last-move-stroke"),n}onArrowClick(t,n){var i=this;return E(function*(){const o=n===O.ZERO?"zero":"one",s=yield i.canUserPlay("#dropArrow_"+o+"_"+t);if(s.isFailure())return i.cancelMove(s.getReason());const a=an.of(t);if(i.selectedPiece.isPresent()){const c=i.selectedPiece.get().square,l=ir.transfer(an.of(c),a).get();return i.chooseMove(l)}{const c=ir.drop(a,n);return i.chooseMove(c)}})()}getPieceClasses(t,n,i){const o={square:t,piece:n},s=[];let a=i.count(O.ZERO),c=i.count(O.ONE);if(this.selectedPiece.equalsValue(o))s.push("selected-stroke");else if(this.droppedPiece.equalsValue(o))s.push("last-move-stroke");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===t){if(this.leftPiece.get().piece===n)return s.push("captured-stroke"),s;this.getState().getCurrentOpponent()===O.ZERO?a++:c++}const l=i.count(B.NONE)-(c+a),u=this.getPieceColor(n,a,l);return""!==u&&s.push(u),s}getPieceColor(t,n,i){return t<n?"player0-fill":t<n+i?"":"player1-fill"}onSquareClick(t){var n=this;return E(function*(){const i=yield n.canUserPlay("#square_"+t);if(i.isFailure())return n.cancelMove(i.getReason());if(n.selectedPiece.isPresent()&&n.selectedPiece.get().square===t)return n.cancelMoveAttempt(),A.SUCCESS;const o=n.getState().getCurrentPlayer(),s=n.board[t];return s.count(o)<=0?n.cancelMove(X5.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(n.selectedPiece=h.of({square:t,piece:n.getLowestPlayerPiece(s,o)}),0===n.showAndGetPossibleTranfers().length?n.cancelMove(X5.NO_POSSIBLE_TRANSFER_REMAINS()):A.SUCCESS)})()}showAndGetPossibleTranfers(){this.displayableArrow=[];let t=this.selectedPiece.get().square-1;const n=this.getState().getCurrentPlayer();for(;0<=t;)!1===this.board[t].isFull()&&this.displayableArrow.push({x:t,player:n}),t--;return this.displayableArrow}getRemainingPieceCx(t){return(t+.5)*this.PIECE_RADIUS*1.5}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-apagos"]],features:[We],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1-fill",4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1-fill"],[1,"base","mid-stroke","player0-fill"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(n,i){1&n&&(N(),M(0,"svg",0)(1,"g"),z(2,ake,1,3,"circle",1)(3,cke,1,3,"circle",2),P(),M(4,"g",3),z(5,dke,5,8,"g",4),P()()),2&n&&(w("viewBox",-i.STROKE_WIDTH/2+" "+-i.STROKE_WIDTH/2+" "+(i.BOARD_WIDTH+i.STROKE_WIDTH)+" "+(i.BOARD_HEIGHT+i.STROKE_WIDTH)),m(),w("transform","rotate("+180*i.getPointOfView().getValue()+" "+i.BOARD_WIDTH/2+" "+i.BOARD_HEIGHT/2+")"),m(),v("ngForOf",i.ArrayUtils.range(i.remainingOne)),m(),v("ngForOf",i.ArrayUtils.range(i.remainingZero)),m(2),v("ngForOf",i.board))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();class G1 extends $1{scores;static of(e,t){return new G1(t,e.turn,e.getScoresCopy())}constructor(e,t,n){super(e,t),this.scores=n}setPieceAt(e,t){return super.setPieceAt(e,t,G1.of)}feedStore(e){const t=this.getScoresCopy();return t.add(e,1),new G1(this.getCopiedBoard(),this.turn,t)}feed(e){return this.addPieceAt(e,1)}addPieceAt(e,t){const n=this.getPieceAt(e);return this.setPieceAt(e,n+t)}getTotalRemainingSeeds(){return it.sum(this.board)}getScoresCopy(){return this.scores.getCopy()}capture(e,t){const n=this.getPieceAt(t),i=this.getScoresCopy();return i.add(e,n),new G1(this.getCopiedBoard(),this.turn,i).setPieceAt(t,0)}equals(e){return!1!==it.compare(this.board,e.board)&&!1!==this.scores.equals(e.scores)&&this.turn===e.turn}getCurrentPlayerY(){return this.getCurrentOpponent().getValue()}getOpponentY(){return this.getCurrentPlayer().getValue()}}class d1{x;static encoder=ke.tuple([ke.identity()],e=>[e.x],e=>d1.of(e[0]));static of(e){return L.assert(0<=e,"MancalaDistribution should be a positive integer!"),new d1(e)}constructor(e){this.x=e}equals(e){return e===this||e.x===this.x}}class S1 extends C2{distributions;static encoder=ke.tuple([ke.list(d1.encoder)],e=>[e.distributions],e=>S1.of(e[0][0],e[0].slice(1)));static of(e,t=[]){const n=[e];return n.push(...t),new S1(n)}constructor(e){super(),this.distributions=e,L.assert(e.length>0,"Move should have distribution ")}add(e){return S1.of(this.distributions[0],this.distributions.slice(1).concat(e))}toString(){return"MancalaMove(["+this.distributions.map(t=>t.x).join(", ")+"])"}equals(e){return yt.equals(this.distributions,e.distributions)}getFirstDistribution(){return this.distributions[0]}[Symbol.iterator](){return this.distributions.values()}}let fd=(()=>class r{static MUST_DISTRIBUTE_YOUR_OWN_HOUSES=()=>$localize`You must distribute one of your houses.`;static MUST_CHOOSE_NON_EMPTY_HOUSE=()=>$localize`You should choose a non-empty house to distribute.`;static SHOULD_DISTRIBUTE=()=>$localize`You should feed but you do not.`})();class Rn extends Da{capturableValues;static FEED_ORIGINAL_HOUSE=()=>$localize`Feed original house`;static MUST_FEED=()=>$localize`Must feed`;static PASS_BY_PLAYER_STORE=()=>$localize`Pass by player store`;static MULTIPLE_SOW=()=>$localize`Must continue distribution after last seed ends in store`;static CYCLICAL_LAP=()=>$localize`Continue distribution until capture or empty house`;static SEEDS_BY_HOUSE=()=>$localize`Seeds by house`;static FAKE_STORE_COORD=new Q5([{key:O.ZERO,value:new _(-1,-1)},{key:O.ONE,value:new _(2,2)}]);static isStarving(e,t){let n=0;const i=e.getOpponent().getValue();for(;n<t[0].length;)if(t[i][n++]>0)return!1;return!0}static getEmptyDistributionResult(e){return{capturedSum:0,captureMap:it.create(e.getWidth(),2,0),endsUpInStore:!1,filledCoords:[],passedByStoreNTimes:0,resultingState:e}}static getInitialState(e){const t=e.get(),n=it.create(t.width,2,t.seedsByHouse);return new G1(n,0,we.of(0,0))}constructor(e){super(),this.capturableValues=e}isLegal(e,t,n){const i=n.get(),o=t.getCurrentPlayerY();let s=!0;for(const a of e){L.assert(s,"Cannot play after non kalah move");const c=this.isLegalDistribution(a,t,i);if(c.isFailure())return A.ofFallible(c);{const l=Rn.getEmptyDistributionResult(t);t=this.distributeHouse(a.x,o,l,i).resultingState,s=c.get()}}if(i.mustContinueDistributionAfterStore&&L.assert(!1===s,"Must continue playing after kalah move"),i.mustFeed){const a=t.getCurrentOpponent(),c=Rn.isStarving(a,t.board),l=this.canDistribute(t.getCurrentPlayer(),t,i);if(c&&l)return A.failure(fd.SHOULD_DISTRIBUTE())}return A.SUCCESS}getInitialState(e){const t=e.get(),n=it.create(t.width,2,t.seedsByHouse);return new G1(n,0,we.of(0,0))}isLegalDistribution(e,t,n){const i=t.getCurrentPlayerY();if(0===t.getPieceAtXY(e.x,i))return X.failure(fd.MUST_CHOOSE_NON_EMPTY_HOUSE());const o=this.distributeMove(S1.of(e),t,n),s=Rn.isStarving(o.resultingState.getCurrentPlayer(),o.resultingState.board);return X.success(o.endsUpInStore&&!1===s)}distributeMove(e,t,n){const i=t.getCurrentPlayer(),o=t.getCurrentPlayerY(),s=[];let a={capturedSum:0,captureMap:it.create(n.width,2,0),endsUpInStore:!1,passedByStoreNTimes:0,filledCoords:[],resultingState:t};for(const c of e){let l=new _(c.x,o),u=!0;for(;u;)a=this.distributeHouse(l.x,l.y,a,n),a.resultingState.getScoresCopy().add(i,a.passedByStoreNTimes),s.push(...a.filledCoords),a.passedByStoreNTimes+=a.passedByStoreNTimes,l=a.filledCoords[a.filledCoords.length-1],u=!(!n.continueLapUntilCaptureOrEmptyHouse||!1!==a.endsUpInStore)&&!1===this.isHouseCapturableOrEmpty(l,a.resultingState)}return{endsUpInStore:a.endsUpInStore,filledCoords:s,passedByStoreNTimes:a.passedByStoreNTimes,resultingState:a.resultingState,capturedSum:0,captureMap:a.captureMap}}isHouseCapturableOrEmpty(e,t){const n=t.getPieceAt(e);return 1===n||this.capturableValues.some(i=>i===n)}mustMonsoon(e,t){const n=e.getCopiedBoard(),i=e.getCurrentOpponent(),o=e.getCurrentPlayer();if(t.mustFeed){if(Rn.isStarving(o,n)&&!1===this.canDistribute(i,e,t))return[i]}else{if(Rn.isStarving(i,n))return[o];if(Rn.isStarving(o,n))return[i]}return[]}getGameStatus(e,t){const n=e.gameState,s=e.gameState.getWidth()*t.get().seedsByHouse;return n.scores.get(O.ZERO)>s?ve.ZERO_WON:n.scores.get(O.ONE)>s?ve.ONE_WON:n.scores.get(O.ZERO)===s&&n.scores.get(O.ONE)===s?ve.DRAW:ve.ONGOING}applyLegalMove(e,t,n,i){const o=this.distributeMove(e,t,n.get()),s=this.applyCapture(o,n.get());let a=s.resultingState;const c=this.mustMonsoon(a,n.get());return 1===c.length?a=this.monsoon(c[0],s).resultingState:2===c.length&&(a=this.sharedMonsoon(s).resultingState),new G1(a.board,a.turn+1,a.scores)}distributeHouse(e,t,n,i){let o=new _(e,t);const s=new _(e,t);let a=n.resultingState.getPieceAt(s),c=n.resultingState.setPieceAt(s,0);const l=c.getCurrentPlayer(),u=[];let f=0,g=!1,y=!1,S=0;for(;a>0;){g=y,y=!1;const I=this.getNextCoord(o,g,n.resultingState,i);if(y=I.isAbsent(),y)f++,c=c.feedStore(l),a--,u.push(Rn.FAKE_STORE_COORD.get(l).get());else if(o=I.get(),!1===s.equals(o)||i.feedOriginalHouse){const R=this.getDropResult(a,c,o);c=R.resultingState,n.captureMap=it.add(n.captureMap,R.captureMap),S+=R.capturedSum,u.push(o),a--}}return{filledCoords:u,passedByStoreNTimes:f,endsUpInStore:y,resultingState:c,capturedSum:S,captureMap:n.captureMap}}getDropResult(e,t,n){return{capturedSum:0,captureMap:it.create(t.getWidth(),2,0),resultingState:t.feed(n)}}getNextCoord(e,t,n,i){const o=n.getCurrentPlayer();return 0===e.y?e.x===n.getWidth()-1?i.passByPlayerStore&&o===O.ONE&&!1===t?h.empty():h.of(new _(e.x,1)):h.of(new _(e.x+1,0)):0===e.x?i.passByPlayerStore&&o===O.ZERO&&!1===t?h.empty():h.of(new _(0,0)):h.of(new _(e.x-1,1))}doesDistribute(e,t,n,i){const o=n.board;let s;return s=0===t?n.getWidth()-(e+1):e+1,s+(i.passByPlayerStore?1:0)<=o[t][e]}canDistribute(e,t,n){for(let i=0;i<t.getWidth();i++)if(this.doesDistribute(i,e.getOpponent().getValue(),t,n))return!0;return!1}monsoon(e,t){const n=t.resultingState,i=it.create(n.getWidth(),2,0),o=n.getScoresCopy(),s=n.getTotalRemainingSeeds(),a=it.add(t.captureMap,n.board);return o.add(e,s),{capturedSum:s,captureMap:a,resultingState:new G1(i,n.turn,o)}}sharedMonsoon(e){const t=e.resultingState,n=it.create(t.getWidth(),2,0),i=t.getScoresCopy(),o=t.getTotalRemainingSeeds(),s=it.add(e.captureMap,t.board);return i.add(O.ZERO,Math.floor(o/2)),i.add(O.ONE,Math.floor(o/2)),{capturedSum:o,captureMap:s,resultingState:new G1(n,t.turn,i)}}}class h1{static range(e,t){return n=>null==n?A.failure($localize`This value is mandatory`):n<e?A.failure($localize`${n} is too small, the minimum is ${e}`):t<n?A.failure($localize`${n} is too big, the maximum is ${t}`):A.SUCCESS}}let Wi=(()=>class r{static WIDTH=()=>$localize`Width`;static HEIGHT=()=>$localize`Height`})();class RQ{value;title;validator;constructor(e,t,n){this.value=e,this.title=t,this.validator=n}}class g1 extends RQ{constructor(e,t,n){super(e,t,n)}}class Qn extends RQ{constructor(e,t){super(e,t)}}class po{defaultConfigDescription;nonDefaultStandardConfigs;defaultConfig;constructor(e,t=[]){this.defaultConfigDescription=e,this.nonDefaultStandardConfigs=t;const n={};for(const o of this.getFields())n[o]=e.config[o].value;this.defaultConfig={name:e.name,config:n};const i=new ct(Object.keys(e.config));for(const o of t){const s=new ct(Object.keys(o.config));L.assert(s.equals(i),`Field missing in ${o.name()} config!`)}}getStandardConfigs(){return[this.defaultConfig].concat(this.nonDefaultStandardConfigs)}getDefaultConfig(){return this.defaultConfig}getFields(){return Object.keys(this.defaultConfigDescription.config)}getNonDefaultStandardConfigs(){return this.nonDefaultStandardConfigs}getI18nName(e){return this.defaultConfigDescription.config[e].title()}getConfig(e){return this.getStandardConfigs().filter(n=>n.name()===e)[0].config}getValidator(e){return L.assert(e in this.defaultConfigDescription.config,e+" is not a validator!"),this.defaultConfigDescription.config[e].validator}}class gke{static GOBAN=new po({name:()=>$localize`Default`,config:{width:new g1(19,Wi.WIDTH,h1.range(1,99)),height:new g1(19,Wi.HEIGHT,h1.range(1,99))}})}class Zs extends Rn{static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new po({name:()=>$localize`Awal`,config:{feedOriginalHouse:new Qn(!1,Rn.FEED_ORIGINAL_HOUSE),mustFeed:new Qn(!0,Rn.MUST_FEED),passByPlayerStore:new Qn(!1,Rn.PASS_BY_PLAYER_STORE),mustContinueDistributionAfterStore:new Qn(!1,Rn.MULTIPLE_SOW),continueLapUntilCaptureOrEmptyHouse:new Qn(!1,Rn.CYCLICAL_LAP),seedsByHouse:new g1(4,Rn.SEEDS_BY_HOUSE,h1.range(1,99)),width:new g1(6,Wi.WIDTH,h1.range(1,99))}});static get(){return Zs.singleton.isAbsent()&&(Zs.singleton=h.of(new Zs([2,3]))),Zs.singleton.get()}getRulesConfigDescription(){return h.of(Zs.RULES_CONFIG_DESCRIPTION)}applyCapture(e,t){const n=e.filledCoords,i=n[n.length-1];return this.captureIfLegal(i.x,i.y,e.resultingState,t)}capture(e,t,n,i){const o=n.getCurrentPlayerY();L.assert(t!==o,"AwaleRules.capture cannot capture the players house");let s=n,a=s.getOptionalPieceAtXY(e,t),c=0;const l=it.create(i.width,2,0);if(a.get()<2||a.get()>3)return{capturedSum:0,captureMap:l,resultingState:n};let u=-1,f=-1;const g=n.getCurrentPlayer();g===O.ONE&&(u=1,f=n.getWidth());do{l[t][e]=a.get(),c+=a.get(),s=s.capture(g,new _(e,t)),a=s.getOptionalPieceAtXY(e+=u,t)}while(e!==f&&(a.equalsValue(2)||a.equalsValue(3)));return{capturedSum:c,captureMap:l,resultingState:s}}captureIfLegal(e,t,n,i){const o=n.getCurrentPlayer(),s={capturedSum:0,resultingState:n,captureMap:it.create(n.getWidth(),2,0)};if(t===o.getValue()){const a=this.capture(e,t,n,i),c=Rn.isStarving(o.getOpponent(),a.resultingState.board);return a.capturedSum>0&&c?s:a}return s}}class EI extends Yn{rules;constructor(e){super(),this.rules=e}getListMoves(e,t){const n=[],i=e.gameState,o=i.getCurrentPlayerY();for(let s=0;s<i.getWidth();s++)if(i.getPieceAtXY(s,o)>0){const a=S1.of(d1.of(s));t.get().mustContinueDistributionAfterStore?n.push(...this.getPossibleMoveContinuations(i,s,o,a,t.get())):this.rules.isLegal(a,i,t).isSuccess()&&n.push(a)}return n}getPossibleMoveContinuations(e,t,n,i,o){const s=[],a=Rn.getEmptyDistributionResult(e),c=this.rules.distributeHouse(t,n,a,o),l=c.resultingState,f=!1===Rn.isStarving(l.getCurrentPlayer(),l.board);if(c.endsUpInStore&&f){for(let g=0;g<l.getWidth();g++)if(l.getPieceAtXY(g,n)>0){const y=i.add(d1.of(g));s.push(...this.getPossibleMoveContinuations(l,g,n,y,o))}return s}return[i]}}class pke extends EI{constructor(){super(Zs.get())}}class Ys{left;up;width;height;static fromLimits(e,t,n,i){return new Ys(e,n,t-e,i-n)}static fromHexa(e,t,n){const i=e.flatMap(u=>t.getCenterAt(u)),o=Ys.getLimits(i);return new Ys(o.minX-n/2,o.minY-n/2,n+o.maxX-o.minX,n+o.maxY-o.minY)}static getLimits(e){let t=Number.MIN_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER;for(const s of e)i=Math.min(i,s.x),o=Math.min(o,s.y),t=Math.max(t,s.x),n=Math.max(n,s.y);return{minX:i,minY:o,maxX:t,maxY:n}}constructor(e,t,n,i){this.left=e,this.up=t,this.width=n,this.height=i}center(){return new _(this.left+this.width/2,this.up+this.height/2)}bottom(){return this.up+this.height}right(){return this.left+this.width}expandAbove(e){return this.expand(0,0,e,0)}expandBelow(e){return this.expand(0,0,0,e)}expandLeft(e){return this.expand(e,0,0,0)}expandRight(e){return this.expand(0,e,0,0)}expand(e,t,n,i){return new Ys(this.left-e,this.up-n,this.width+e+t,this.height+n+i)}containingAtLeast(e){const t=Math.min(this.left,e.left),n=Math.max(this.right(),e.right()),i=Math.min(this.up,e.up),o=Math.max(this.bottom(),e.bottom());return Ys.fromLimits(t,n,i,o)}toSVGString(){return`${this.left} ${this.up} ${this.width} ${this.height}`}}class mke{static getArrowTransform(e,t,n){let i,o,s;switch(n){case Ie.UP:i=1,o=0,s=-90;break;case Ie.DOWN:i=1,o=2,s=90;break;case Ie.LEFT:i=0,o=1,s=180;break;default:L.expectToBe(n,Ie.RIGHT),i=2,o=1,s=0}return[`scale( ${e/300} ${t/300} )`,`translate(${100*i} ${100*o})`,"rotate("+s+" 50 50)"].join(" ")}}let y2=(()=>{class r extends $c{board;getWidth(){return this.getState().getWidth()}getHeight(){return this.getState().getHeight()}getViewBox(){const t=this.getWidth()*this.SPACE_SIZE,n=this.getHeight()*this.SPACE_SIZE,i=.5*this.STROKE_WIDTH;return Ys.fromLimits(0,t,0,n).expand(i,i,i,i)}static \u0275fac=(()=>{let t;return function(i){return(t||(t=z1(r)))(i||r)}})();static \u0275cmp=$e({type:r,selectors:[["ng-component"]],features:[We],decls:0,vars:0,template:function(n,i){},encapsulation:2})}return r})();function xQ(r){return 1e3*r.seconds+r.nanoseconds/1e6}function LQ(r,e){return xQ(e)-xQ(r)}class vC{static sleep(e){return E(function*(){return new Promise(t=>{window.setTimeout(t,e)})})()}}class _ke extends or{getMetrics(e,t){return e.gameState.getScoresCopy().toTable()}}class Cke extends cn{constructor(e,t){super($localize`Score`,e,new _ke,t)}}let PI=(()=>{class r extends y2{cdr;static TIMEOUT_BETWEEN_SEEDS=100;static TIMEOUT_BETWEEN_LAPS=1e3;MGPOptional=h;lastDistributedHouses=[];currentMove=h.empty();captured=it.create(6,2,0);droppedInStore=we.of(0,0);filledCoords=[];constructedState;opponentMoveIsBeingAnimated=!1;constructor(t,n){super(t),this.cdr=n,this.hasAsymmetricBoard=!0,this.scores=h.of(we.of(0,0))}getMancalaViewBox(){return-this.STROKE_WIDTH/2+" "+-this.STROKE_WIDTH/2+" "+(this.getViewBoxWidth()+this.STROKE_WIDTH)+" "+(2*this.SPACE_SIZE+50)}getViewBoxWidth(){return 60+(2+this.getState().getWidth())*this.SPACE_SIZE}showLastMove(t){var n=this;return E(function*(){n.droppedInStore=we.of(0,0);const i=n.getPreviousState(),o=n.getConfig().get(),s=n.rules.distributeMove(t,i,o);n.filledCoords=s.filledCoords;let a=n.rules.applyCapture(s,o);n.captured=a.captureMap;const c=i.getCurrentPlayerY();n.lastDistributedHouses=t.distributions.map(u=>new _(u.x,c)),n.rules.mustMonsoon(a.resultingState,o).length>0&&(a=n.rules.monsoon(O.ZERO,a),n.captured=a.captureMap),n.changeVisibleState(n.getState())})()}updateBoard(t){var n=this;return E(function*(){const i=n.getState();if(t){n.opponentMoveIsBeingAnimated=!0,n.animationOngoing=!0,L.assert(n.node.parent.isPresent(),"triggerAnimation in store should be false at first turn"),n.changeVisibleState(n.node.parent.get().gameState);let o=0;const s=n.node.previousMove.get();for(const a of s)yield n.showSimpleDistribution(a),o+1<s.distributions.length&&(yield vC.sleep(r.TIMEOUT_BETWEEN_LAPS)),o++;n.opponentMoveIsBeingAnimated=!1,n.animationOngoing=!1}n.scores=h.of(i.getScoresCopy()),n.changeVisibleState(i)})()}onClick(t,n){var i=this;return E(function*(){const o=yield i.canUserPlay("#click_"+t+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());if(!0===i.animationOngoing)return A.SUCCESS;{i.animationOngoing=!0;const s=yield i.onLegalClick(t,n);return i.animationOngoing=!1,s}})()}onLegalClick(t,n){var i=this;return E(function*(){return n===i.getState().getCurrentPlayer().getValue()?i.cancelMove(fd.MUST_DISTRIBUTE_YOUR_OWN_HOUSES()):(i.updateOrCreateCurrentMove(t),0===i.constructedState.getPieceAtXY(t,n)?i.cancelMove(fd.MUST_CHOOSE_NON_EMPTY_HOUSE()):i.continueMoveConstruction(t))})()}continueMoveConstruction(t){var n=this;return E(function*(){const i=yield n.showSimpleDistribution(d1.of(t)),o=n.getConfig().get();if(i.endsUpInStore&&o.mustContinueDistributionAfterStore){const s=n.constructedState.getCurrentPlayer();return Rn.isStarving(s,i.resultingState.board)?n.chooseMove(n.currentMove.get()):A.SUCCESS}return n.chooseMove(n.currentMove.get())})()}showSimpleDistribution(t){var n=this;return E(function*(){const i=n.constructedState,o=i.getCurrentPlayerY(),s=new _(t.x,o);n.lastDistributedHouses.push(s);const a=n.getConfig().get();yield n.showSeedBySeed(s,i,a);const c=Rn.getEmptyDistributionResult(i);return n.rules.distributeHouse(t.x,o,c,a)})()}showSeedBySeed(t,n,i){var o=this;return E(function*(){const s=t;let a=!0,c={currentDropIsStore:!1,houseToDistribute:t,resultingState:n,seedsInHand:0};for(;a;){for(c.seedsInHand=c.resultingState.getPieceAt(c.houseToDistribute),c.resultingState=c.resultingState.setPieceAt(c.houseToDistribute,0),o.changeVisibleState(c.resultingState),yield vC.sleep(r.TIMEOUT_BETWEEN_SEEDS);c.seedsInHand>0;)c=yield o.showSeedDrop(c,i,s);if(c.currentDropIsStore||!1===i.continueLapUntilCaptureOrEmptyHouse)a=!1;else{const l=c.resultingState.getPieceAt(c.houseToDistribute);a=1!==l&&4!==l,a&&(yield vC.sleep(r.TIMEOUT_BETWEEN_LAPS))}}})()}showSeedDrop(t,n,i){var o=this;return E(function*(){const s=t.resultingState.getCurrentPlayer(),a=o.rules.getNextCoord(t.houseToDistribute,t.currentDropIsStore,t.resultingState,n),c=a.isAbsent();let l=t.seedsInHand,u=t.resultingState,f=t.houseToDistribute;if(c)l--,o.filledCoords.push(Rn.FAKE_STORE_COORD.get(s).get()),o.droppedInStore.add(s,1),u=u.feedStore(s);else if(f=a.get(),!1===i.equals(f)||n.feedOriginalHouse){const g=o.rules.getDropResult(l,u,f);u=g.resultingState,o.captured=it.add(o.captured,g.captureMap),o.filledCoords.push(f),l--}return o.changeVisibleState(u),l>0&&(yield vC.sleep(r.TIMEOUT_BETWEEN_SEEDS)),{houseToDistribute:f,currentDropIsStore:c,seedsInHand:l,resultingState:u}})()}hideLastMove(){let t;t=this.config.isPresent()?this.config.get().width:6,this.captured=it.create(t,2,0),this.filledCoords=[],this.lastDistributedHouses=[],this.changeVisibleState(this.getState())}cancelMoveAttempt(){this.currentMove=h.empty(),this.droppedInStore=we.of(0,0),this.filledCoords=[],this.lastDistributedHouses=[],this.changeVisibleState(this.getState())}getSpaceClasses(t,n){const i=new _(t,n),o=this.getSpaceOwner(i),s=this.getPlayerClass(o);return this.getStoreOwner(i).isAbsent()&&this.captured[n][t]>0?["captured-fill","moved-stroke"]:this.lastDistributedHouses.some(a=>a.equals(i))?["last-move-stroke",s]:this.filledCoords.some(a=>a.equals(i))?["moved-stroke",s]:[s]}getStoreOwner(t){return Rn.FAKE_STORE_COORD.reverse().get(t)}getSpaceOwner(t){const n=this.getStoreOwner(t);return n.isPresent()?n.get().getAnyElement().get():O.of((t.y+1)%2)}getPieceCx(t){return 80+100*(t+1)}getPieceCy(t){return 60+120*t}getPieceTransform(t,n){return"translate("+this.getPieceCx(t)+", "+this.getPieceCy(n)+")"}getPieceRotation(){return"rotate("+180*this.getPointOfView().getValue()+")"}getHouseSecondaryContent(t,n){const i=this.getPreviousStableState().getPieceAtXY(t,n),s=this.constructedState.getPieceAtXY(t,n)-i;return this.captured[n][t]>0?h.of("-"+this.captured[n][t]):s>0?h.of("+"+s):s<0?h.of(""+s):h.empty()}getStoreContent(t){return this.scores.get().get(t)+this.droppedInStore.get(t)}getStoreSecondaryContent(t){const n=this.getPreviousStableState().scores.get(t),o=this.constructedState.scores.get(t)-n;return o>0?h.of("+"+o):h.empty()}getPreviousStableState(){return this.opponentMoveIsBeingAnimated?(L.assert(this.getTurn()>0,"Kalah: Should not animate move at turn 0"),this.node.parent.get().gameState):!0===this.constructedState.equals(this.getState())&&this.node.parent.isPresent()?this.node.parent.get().gameState:this.getState()}onStoreClick(t){var n=this;return E(function*(){const i=yield n.canUserPlay("#store_player_"+t.getValue());return i.isFailure()?n.cancelMove(i.getReason()):n.cancelMove(fd.MUST_DISTRIBUTE_YOUR_OWN_HOUSES())})()}changeVisibleState(t){this.constructedState=t,this.board=this.constructedState.board,this.cdr.detectChanges()}createAIs(t){return[new Cke(this.rules,t),new kn($localize`MCTS`,t,this.rules)]}updateOrCreateCurrentMove(t){if(this.currentMove.isAbsent())this.hideLastMove(),this.currentMove=h.of(this.generateMove(t));else{const n=this.addToMove(t);this.currentMove=h.of(n)}}generateMove(t){return S1.of(d1.of(t))}addToMove(t){return this.currentMove.get().add(d1.of(t))}}return r})();const vke=["app-numbered-circle",""];function yke(r,e){if(1&r&&(N(),M(0,"text",3),st(1),P()),2&r){const t=p();Ce("id","secondary_message_",t.x,"_",t.y,""),w("x",15)("y",31)("transform",t.rotation),m(),ri(" ",t.secondaryContent.get()," ")}}let SI=(()=>{class r{x;y;spaceClasses;content;secondaryContent;rotation;static \u0275fac=function(n){return new(n||r)};static \u0275cmp=$e({type:r,selectors:[["","app-numbered-circle",""]],inputs:{x:"x",y:"y",spaceClasses:"spaceClasses",content:"content",secondaryContent:"secondaryContent",rotation:"rotation"},attrs:vke,decls:4,vars:10,consts:[["r","45",1,"base",3,"id","ngClass"],[1,"text-big","text-center",3,"id"],["class","text-20 text-center",3,"id",4,"ngIf"],[1,"text-20","text-center",3,"id"]],template:function(n,i){1&n&&(N(),V(0,"circle",0),M(1,"text",1),st(2),P(),z(3,yke,2,6,"text",2)),2&n&&(Ce("id","circle_",i.x,"_",i.y,""),v("ngClass",i.spaceClasses),m(),Ce("id","number_",i.x,"_",i.y,""),w("x",0)("y",16)("transform",i.rotation),m(),ri(" ",i.content," "),m(),v("ngIf",i.secondaryContent.isPresent()))},dependencies:[zt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();function Mke(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"g",8),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();m(),Ce("id","click_",n,"_",i,""),v("x",n)("y",i)("content",t)("spaceClasses",o.getSpaceClasses(n,i))("rotation",o.getPieceRotation())("secondaryContent",o.getHouseSecondaryContent(n,i)),w("transform",o.getPieceTransform(n,i))}}function Eke(r,e){if(1&r&&(N(),M(0,"g"),z(1,Mke,2,9,"g",2),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}let Pke=(()=>{class r extends PI{constructor(t,n){super(t,n),this.setRulesAndNode("Awale"),this.availableAIs=this.createAIs(new pke),this.encoder=S1.encoder}static \u0275fac=function(n){return new(n||r)(G(Ut),G(zs))};static \u0275cmp=$e({type:r,selectors:[["app-awale-component"]],features:[We],decls:8,vars:21,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0","ry","115","rx","115","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","120","y1","120","y2","120",1,"base"],["x1","120","y1","0","x2","120","y2","240",1,"base"],["y1","0","y2","240",1,"base"],["id","store_player_0","app-numbered-circle","","transform","translate(60 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["id","store_player_1","app-numbered-circle","",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["app-numbered-circle","",3,"id","x","y","content","spaceClasses","rotation","secondaryContent","click"]],template:function(n,i){1&n&&(N(),M(0,"svg",0),V(1,"rect",1),z(2,Eke,2,1,"g",2),V(3,"line",3)(4,"line",4)(5,"line",5),M(6,"g",6),W("click",function(){return i.onStoreClick(i.Player.ZERO)}),P(),M(7,"g",7),W("click",function(){return i.onStoreClick(i.Player.ONE)}),P()()),2&n&&(w("viewBox",i.getMancalaViewBox())("transform",i.rotation),m(),w("width",i.getViewBoxWidth())("height",240),m(),v("ngForOf",i.board),m(),w("x2",i.getViewBoxWidth()-120),m(2),w("x1",i.getViewBoxWidth()-120)("x2",i.getViewBoxWidth()-120),m(),v("x",-1)("y",-1)("content",i.getStoreContent(i.Player.ZERO))("spaceClasses",i.getSpaceClasses(-1,-1))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ZERO)),m(),v("x",2)("y",2)("content",i.getStoreContent(i.Player.ONE))("spaceClasses",i.getSpaceClasses(2,2))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ONE)),w("transform","translate("+(i.getViewBoxWidth()-60)+" 120)"))},dependencies:[Nt,SI],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})(),ms=(()=>class r{static intro(t,n){return q.informational(t,$localize`${t} is a Mancala. Mancala is the name of a family of board games that dates back at least to the third century. Mancalas are games of distribution (sowing) and capture. Their goal is to capture the most seeds. The spaces in Mancalas are called the houses. The ones on the extreme left and right are called the stores, they contain the seeds that each player captured. As you are playing Dark, the 6 houses on the bottom are yours.`,n)}static sowing(t){const n=t.getPieceAtXY(5,1);return L.assert(4===n,"(5, 1) should contain 4 seed"),q.fromMove($localize`Sowing`,$localize`The main move in Mancala games is sowing, let's see how seeds are sown. As you are playing Dark, the 6 houses on the bottom are yours.<br/><br>Click on the rightmost bottom house to sow the seeds it contains: they will be sown clockwise, one seed per house.<br/><br/>Click on the rightmost house!`,t,[S1.of(d1.of(5))],$localize`Look at the 4 houses that follow clockwise the one you picked, they now contain one more seed. This is how seeds are sown: one by one from the house next to the one they come from, clockwise.`,$localize`Failed. Choose the rightmost house on the bottom.`)}static YOU_DID_NOT_CAPTURE_ANY_SEEDS=()=>$localize`Failed. You did not capture anything. Try again.`})();const OI=Zs.get().getDefaultRulesConfig();class Ske extends Bn{gameName=$localize`Awal`;tutorial=[ms.intro(this.gameName,Zs.get().getInitialState(OI)),q.informational($localize`Awal`,$localize`Bonus fact: Awal is the most common of all Mancalas.`,Zs.get().getInitialState(OI)),ms.sowing(Zs.get().getInitialState(OI)),q.anyMove($localize`Big sowing`,$localize`When there are enough seeds to make a full turn, something else happens.<br/><br/> You're playing Dark. Sow the house that contains 12 seeds.`,new G1([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,we.of(0,0)),S1.of(d1.of(1)),$localize`See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds).`),q.fromMove($localize`Simple capture`,$localize`After sowing, if the last seed falls in an opponent's house and if there are now two or three seeds in this house, the player captures these two or three seeds.<br/><br/>You're playing Dark, do a capture!`,new G1([[0,1,0,0,1,0],[2,0,0,0,1,0]],0,we.of(0,0)),[S1.of(d1.of(0))],$localize`Well done! This was a simple capture, now let us see how to make multiple captures.`,ms.YOU_DID_NOT_CAPTURE_ANY_SEEDS()),q.fromMove($localize`Multiple captures`,$localize`By sowing from your leftmost house, you will end in the opponent's second leftmost house, which now contains 2 seeds, so this will be a capture. But now, the house right before it contains 3 seeds, which is also capturable, so, that house will get captured as well!<br/><br/>You're playing Dark, do a capture!`,new G1([[2,1,0,0,1,0],[2,0,0,0,1,0]],0,we.of(0,0)),[S1.of(d1.of(0))],$localize`Nice, you win 3 points from the first house, and 2 from the second!`,ms.YOU_DID_NOT_CAPTURE_ANY_SEEDS()),q.fromMove($localize`Interrupted capture`,$localize`By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>You're playing Dark, do a capture!`,new G1([[1,0,1,0,0,1],[3,0,0,0,1,0]],0,we.of(0,0)),[S1.of(d1.of(0))],$localize`Notice that because the second house was not capturable, the capture was interrupted and you have not captured the first house.`,ms.YOU_DID_NOT_CAPTURE_ANY_SEEDS()),q.fromMove($localize`Capture on the other side only`,$localize`You're playing Dark. Try to capture the two leftmost houses of the opponent.`,new G1([[2,2,0,0,1,0],[1,3,0,0,0,0]],0,we.of(0,0)),[S1.of(d1.of(1))],$localize`Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!`,$localize`You have only captured one house, try again!`),q.fromMove($localize`Do not starve`,$localize`You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>You're playing Dark. Try it.`,new G1([[1,1,1,1,1,0],[5,0,0,1,0,0]],0,we.of(0,0)),[S1.of(d1.of(0))],$localize`Sadly, you cannot capture here, otherwise the opponent could not play after you. When this happens, the move can be made, but no capture takes place!`,pe.FAILED_TRY_AGAIN()),q.anyMove($localize`Feeding is mandatory`,$localize`You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>You're playing Dark. Give a seed to your opponent!`,new G1([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,we.of(0,0)),S1.of(d1.of(3)),$localize`Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you. It is often a good way to have easy captures!`),q.anyMove(pe.END_OF_THE_GAME(),$localize`A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>You're playing Dark, sow the leftmost house.`,new G1([[4,4,3,2,1,0],[1,0,0,0,0,0]],0,we.of(23,10)),S1.of(d1.of(0)),$localize`Also, as soon as on player cannot play, the other player captures all the seeds in its own side. Here, it was the first player's turn, and the second player has taken all the remaining seeds.`)]}const on=Ee.EMPTY,ci=Ee.UNREACHABLE,Ks=Ee.ZERO,tu=Ee.ONE;class Oke extends Bn{tutorial=[q.informational($localize`Initial board and object of the game`,$localize`At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!`,qs.get().getInitialState()),q.anyMove($localize`Moving a piece`,$localize`At each turn, move one, two, or three pieces either along their line, or on their side.
        For your moves you can therefore choose between up to 6 directions.
        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).
        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>
        You're playing Dark, make any move!`,qs.get().getInitialState(),v2.ofSingleCoord(new _(2,6),Se.UP),pe.CONGRATULATIONS()),q.fromMove($localize`Pushing`,$localize`To push one opponent piece, you must move at least two of your pieces.
        To push two opponent pieces, you must move three of your pieces.
        If one of your pieces is in the way, it will be impossible to push.
        You cannot move more than three pieces.<br/><br/>
        Only one push towards the right is possible here, find it. (You're playing Dark).`,new js([[ci,ci,ci,ci,on,Ks,Ks,tu,tu],[ci,ci,ci,on,on,on,on,on,on],[ci,ci,on,Ks,Ks,Ks,tu,Ks,on],[ci,on,on,on,on,on,on,on,on],[on,on,on,on,Ks,Ks,Ks,tu,tu],[on,on,on,on,on,on,on,on,ci],[on,on,on,on,Ks,tu,on,ci,ci],[on,on,on,Ks,on,on,ci,ci,ci],[on,on,Ks,on,on,ci,ci,ci,ci]],0),[v2.ofSingleCoord(new _(4,4),Se.RIGHT)],$localize`Congratulations! You know everything you need to start a game!`,pe.FAILED_TRY_AGAIN())]}class Fa extends Rn{static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new po({name:()=>$localize`Ba-awa`,config:{feedOriginalHouse:new Qn(!0,Rn.FEED_ORIGINAL_HOUSE),mustFeed:new Qn(!1,Rn.MUST_FEED),passByPlayerStore:new Qn(!1,Rn.PASS_BY_PLAYER_STORE),mustContinueDistributionAfterStore:new Qn(!1,Rn.MULTIPLE_SOW),continueLapUntilCaptureOrEmptyHouse:new Qn(!0,Rn.CYCLICAL_LAP),seedsByHouse:new g1(4,Rn.SEEDS_BY_HOUSE,h1.range(1,99)),width:new g1(6,Wi.WIDTH,h1.range(1,99)),splitFinalSeedsEvenly:new Qn(!1,()=>$localize`Split final seeds evenly`)}},[{name:()=>$localize`Even Ba-awa`,config:{feedOriginalHouse:!0,mustFeed:!1,passByPlayerStore:!1,mustContinueDistributionAfterStore:!1,continueLapUntilCaptureOrEmptyHouse:!0,seedsByHouse:4,width:6,splitFinalSeedsEvenly:!0}}]);static get(){return Fa.singleton.isAbsent()&&(Fa.singleton=h.of(new Fa([4]))),Fa.singleton.get()}getRulesConfigDescription(){return h.of(Fa.RULES_CONFIG_DESCRIPTION)}applyCapture(e){const t=it.copy(e.captureMap),n=e.filledCoords[e.filledCoords.length-1];if(!1===e.endsUpInStore&&4===e.resultingState.getPieceAt(n)){const o=e.resultingState.getCurrentPlayer();e.capturedSum+=4,t[n.y][n.x]+=4,e.resultingState=e.resultingState.capture(o,n)}return{capturedSum:e.capturedSum,captureMap:t,resultingState:e.resultingState}}getDropResult(e,t,n){let i=t.feed(n);const o=i.getPieceAt(n),s=it.create(t.getWidth(),2,0);if(4===o&&e>1){s[n.y][n.x]=4;const a=O.of(n.y).getOpponent();return i=i.capture(a,n),{capturedSum:4,captureMap:s,resultingState:i}}return{capturedSum:0,captureMap:s,resultingState:i}}mustMonsoon(e,t){const n=super.mustMonsoon(e,t);return n.length>0?n:e.getTotalRemainingSeeds()<=8?t.splitFinalSeedsEvenly?[O.ZERO,O.ONE]:[O.ZERO]:[]}}class Tke extends EI{constructor(){super(Fa.get())}}function Ake(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"g",8),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();m(),Ce("id","click_",n,"_",i,""),v("x",n)("y",i)("content",t)("spaceClasses",o.getSpaceClasses(n,i))("rotation",o.getPieceRotation())("secondaryContent",o.getHouseSecondaryContent(n,i)),w("transform",o.getPieceTransform(n,i))}}function bke(r,e){if(1&r&&(N(),M(0,"g"),z(1,Ake,2,9,"g",2),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}let wke=(()=>{class r extends PI{constructor(t,n){super(t,n),this.setRulesAndNode("BaAwa"),this.availableAIs=this.createAIs(new Tke),this.encoder=S1.encoder}static \u0275fac=function(n){return new(n||r)(G(Ut),G(zs))};static \u0275cmp=$e({type:r,selectors:[["app-ba-awa-component"]],features:[We],decls:8,vars:21,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0","ry","115","rx","115","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","120","y1","120","y2","120",1,"base"],["x1","120","y1","0","x2","120","y2","240",1,"base"],["y1","0","y2","240",1,"base"],["id","store_player_0","app-numbered-circle","","transform","translate(60 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["id","store_player_1","app-numbered-circle","",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["app-numbered-circle","",3,"id","x","y","content","spaceClasses","rotation","secondaryContent","click"]],template:function(n,i){1&n&&(N(),M(0,"svg",0),V(1,"rect",1),z(2,bke,2,1,"g",2),V(3,"line",3)(4,"line",4)(5,"line",5),M(6,"g",6),W("click",function(){return i.onStoreClick(i.Player.ZERO)}),P(),M(7,"g",7),W("click",function(){return i.onStoreClick(i.Player.ONE)}),P()()),2&n&&(w("viewBox",i.getMancalaViewBox())("transform",i.rotation),m(),w("width",i.getViewBoxWidth())("height",240),m(),v("ngForOf",i.board),m(),w("x2",i.getViewBoxWidth()-120),m(2),w("x1",i.getViewBoxWidth()-120)("x2",i.getViewBoxWidth()-120),m(),v("x",-1)("y",-1)("content",i.getStoreContent(i.Player.ZERO))("spaceClasses",i.getSpaceClasses(-1,-1))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ZERO)),m(),v("x",2)("y",2)("content",i.getStoreContent(i.Player.ONE))("spaceClasses",i.getSpaceClasses(2,2))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ONE)),w("transform","translate("+(i.getViewBoxWidth()-60)+" 120)"))},dependencies:[Nt,SI],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const zQ=Fa.get().getDefaultRulesConfig();class Nke extends Bn{gameName=$localize`Ba-awa`;tutorial=[ms.intro(this.gameName,Fa.get().getInitialState(zQ)),q.informational($localize`Ba-awa`,$localize`Bonus fact: Ba-awa, also called Adi, is played mainly in Ghana.`,Fa.get().getInitialState(zQ)),ms.sowing(new G1([[4,4,4,4,4,4],[4,0,4,4,4,4]],0,we.of(0,0))),q.fromMove($localize`Multiple laps sowing`,$localize`However, the distribution only stops when the last seed is dropped in a house that contains zero or three seeds (before drop).<br/><br/>You're playing Dark, do such a move!`,new G1([[0,2,4,0,0,0],[0,0,0,5,0,0]],0,we.of(0,0)),[S1.of(d1.of(3))],$localize`So, after landing in the house with 2 seeds (then 3), a second lap has been started.`,pe.FAILED_TRY_AGAIN()),q.fromMove($localize`Captures during distribution (1/2)`,$localize`If, during some distribution, you pass by one of your houses that contains 3 seeds, and drop a fourth seed, you capture the house immediately, then continue the distribution!<br/><br/>You're playing Dark, do such a move!`,new G1([[0,8,0,0,0,0],[0,0,3,2,0,0]],0,we.of(0,0)),[S1.of(d1.of(3))],$localize`Congratulations, you captured 4 seeds.`,ms.YOU_DID_NOT_CAPTURE_ANY_SEEDS()),q.fromMove($localize`Captures during distribution (2/2)`,$localize`If, during some distribution, you pass by one house of the opponent that contains 3 seeds, and drop a fourth seed, the opponent captures the house immediately, while you continue to distribute.<br/><br/>You're playing Dark, do such a move!`,new G1([[0,3,0,0,8,0],[3,0,1,0,0,0]],0,we.of(0,0)),[S1.of(d1.of(0))],$localize`There it is, the opponent captured 4 seeds.`,ms.YOU_DID_NOT_CAPTURE_ANY_SEEDS()),q.fromMove($localize`Captures`,$localize`Though, if your very last seed is dropped in a house of the opponent that contains 3 seeds (4 with your seed), you capture it immediately!<br/><br/>You're playing Dark, do such a move!`,new G1([[0,1,1,3,8,0],[2,7,2,0,0,0]],0,we.of(0,0)),[S1.of(d1.of(0))],$localize`Congratulations, you captured 4 seeds.`,ms.YOU_DID_NOT_CAPTURE_ANY_SEEDS()),q.fromMove(pe.END_OF_THE_GAME(),$localize`At the end of a turn, if the number of seeds reaches 8 or less, the first player (Dark) captures the remaining seeds.<br/><br/>You're playing Dark, end the game by capturing!`,new G1([[0,1,1,3,0,0],[1,0,2,0,0,4]],0,we.of(0,0)),[S1.of(d1.of(2))],$localize`There it is, you captured all remaining seeds.`,ms.YOU_DID_NOT_CAPTURE_ANY_SEEDS())]}class q2 extends C2{first;second;static getFallibleEncoder(e){return ke.tuple([_.encoder,_.encoder],t=>[t.first,t.second],t=>e(t[0],t[1]).get())}static getEncoder(e){return ke.tuple([_.encoder,_.encoder],t=>[t.first,t.second],t=>e(t[0],t[1]))}constructor(e,t){super(),this.first=e,this.second=t}getFirst(){return this.first}getSecond(){return this.second}getCoords(){return[this.first,this.second]}}class Do extends q2{constructor(e,t){if(super(e,t),e.equals(t))throw new Error(Me.MOVE_CANNOT_BE_STATIC())}length(){return this.getStart().getDistance(this.getEnd())}getDirection(){return me.factory.fromMove(this.getStart(),this.getEnd())}getStart(){return this.getFirst()}getEnd(){return this.getSecond()}getMovedOverCoords(){return this.getStart().getAllCoordsToward(this.getEnd())}equals(e){return this===e||!1!==this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}toString(){return`${this.getStart().toString()} -> ${this.getEnd().toString()}`}}let yC=(()=>class r{static LANDING_ON_OCCUPIED_SQUARE=()=>$localize`You cannot land on an occupied square.`;static THRONE_IS_LEFT_FOR_GOOD=()=>$localize`Once you left the central throne, you cannot return to it.`;static SOLDIERS_CANNOT_SIT_ON_THRONE=()=>$localize`Soldiers cannot sit on the throne.`;static MOVE_MUST_BE_ORTHOGONAL=()=>$localize`Tafl moves must be orthogonal.`})();class nu extends Do{static isValidDirection(e,t){const n=e.getDirectionToward(t);return n.isFailure()||n.get().isDiagonal()?A.failure(yC.MOVE_MUST_BE_ORTHOGONAL()):A.SUCCESS}constructor(e,t){super(e,t);const n=this.getMaximalDistance();L.assert(e.isInRange(n,n),"Starting coord of TaflMove must be on the board, not at "+e.toString()+"."),L.assert(t.isInRange(n,n),"Landing coord of TaflMove must be on the board, not at "+t.toString()+".")}toString(){return"TaflMove("+this.getStart()+"->"+this.getEnd()+")"}}class _s extends nu{static encoder=q2.getFallibleEncoder(_s.from);static from(e,t){const n=nu.isValidDirection(e,t);return n.isFailure()?n.toOtherFallible():X.success(new _s(e,t))}getMaximalDistance(){return 7}}class O1{value;static NONE=new O1("NONE");static OPPONENT=new O1("OPPONENT");static PLAYER=new O1("PLAYER");constructor(e){this.value=e}}class It{owner;king;static UNOCCUPIED=new It(B.NONE,!1);static PLAYER_ONE_KING=new It(B.ONE,!0);static PLAYER_ONE_PAWN=new It(B.ONE,!1);static PLAYER_ZERO_KING=new It(B.ZERO,!0);static PLAYER_ZERO_PAWN=new It(B.ZERO,!1);constructor(e,t){this.owner=e,this.king=t}isKing(){return this.king}getOwner(){return this.owner}}let r0=class extends Yn{rules;constructor(e){super(),this.rules=e}getListMoves(e,t){const n=e.gameState,i=n.getCurrentPlayer(),o=this.rules.getPlayerListMoves(i,n,t.get());return this.orderMoves(n,o,t.get())}orderMoves(e,t,n){const i=this.rules.getKingCoord(e).get(),o=this.rules.getInvader(n);return e.getCurrentPlayer()===o?yt.sortByDescending(t,s=>-s.getEnd().getOrthogonalDistance(i)):yt.sortByDescending(t,s=>s.getStart().equals(i)?this.rules.isExternalThrone(e,s.getEnd())?2:1:0),t}};r0=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],r0);class MC{directThreats;mover;constructor(e,t){this.directThreats=e,this.mover=t}equals(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}class DQ extends MC{directThreat;constructor(e,t){super(new ct([e]),t),this.directThreat=e}}class kke extends ct{valueMap;constructor(e){if(super(),this.valueMap=[],this.values=[],void 0!==e)for(const t of e)this.add(t)}add(e){const t=this.toFields(e);let n=this.valueMap;for(const o of t[0])void 0===n[o]&&(n[o]=[]),n=n[o];const i=t[1];return void 0===n[i]&&(n[i]=!0,this.values.push(e),!0)}contains(e){const t=this.toFields(e);let n=this.valueMap;for(const o of t[0]){if(void 0===n[o])return!1;n=n[o]}return void 0!==n[t[1]]}[Symbol.iterator](){return this.values.values()}}class sr extends kke{toFields(e){return[[e.y],e.x]}}class VQ extends or{rules;constructor(e){super(),this.rules=e}getMetrics(e,t){const n=e.gameState,i=t.get(),o=this.rules.getPlayerListPawns(O.ZERO,n).length,s=this.rules.getPlayerListPawns(O.ONE,n).length,a=this.rules.getInvader(i),c=[1,2][a.getValue()],l=[2,1][a.getValue()];return U1.ofSingle(o*c,s*l)}}class HQ extends VQ{getBoardValue(e,t){const n=this.rules.getGameStatus(e,t);if(n.isEndGame)return n.toBoardValue();const i=e.gameState,o=It.UNOCCUPIED,s=this.getPiecesMap(i),a=this.getThreatMap(e,s),c=this.filterThreatMap(a,i);let l=0,u=0,f=0;for(const g of O.PLAYERS)for(const y of s.get(g).get())if(c.get(y).isPresent())l+=g.getScoreModifier();else{u+=g.getScoreModifier();let S=0;for(const I of Ie.ORTHOGONALS){let R=y.getNext(I,1);for(;i.isOnBoard(R)&&i.getPieceAt(R)===o;)S++,R=R.getNext(I,1)}f+=S*g.getScoreModifier()}return gn.multiMetric([u,l,f])}getPiecesMap(e){const t=It.UNOCCUPIED,n=[],i=[];for(let s=0;s<e.getHeight();s++)for(let a=0;a<e.getWidth();a++){const c=new _(a,s);e.getPieceAt(c)!==t&&(e.getAbsoluteOwner(c)===O.ZERO?n.push(c):i.push(c))}return new fn([{key:O.ZERO,value:new sr(n)},{key:O.ONE,value:new sr(i)}])}getThreatMap(e,t){const n=new fn;for(const i of O.PLAYERS)for(const o of t.get(i).get()){const s=this.getThreats(o,e.gameState);this.isThreatReal(o,e.gameState,s)&&n.set(o,new ct(s))}return n}getThreats(e,t){const n=t.getAbsoluteOwner(e);L.assert(n.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");const i=n.getOpponent(),o=[];for(const s of Ie.ORTHOGONALS){const a=e.getPrevious(s,1);if(this.isAThreat(a,t,i)){const c=[];for(const l of Ie.ORTHOGONALS){if(l===s.getOpposite())continue;let u=e.getNext(s,1);for(;t.isOnBoard(u)&&t.getPieceAt(u)===It.UNOCCUPIED;)u=u.getNext(l);t.isOnBoard(u)&&t.getAbsoluteOwner(u)===i&&!1===e.getNext(s,1).equals(u)&&c.push(u)}o.push(new DQ(a,new sr(c)))}}return o}isAThreat(e,t,n){return!1!==t.isOnBoard(e)&&(t.getAbsoluteOwner(e)===n||!!this.rules.isThrone(t,e)&&(n===O.ONE||t.getPieceAt(e)===It.UNOCCUPIED))}isThreatReal(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;for(const i of n)if(i.mover.size()>0)return!0;return!1}filterThreatMap(e,t){const n=new fn,i=e.listKeys(),o=i.filter(a=>t.getAbsoluteOwner(a)===t.getCurrentPlayer()),s=new sr(i.filter(a=>t.getAbsoluteOwner(a)===t.getCurrentOpponent()));for(const a of o){const c=e.get(a).get(),l=[];for(const u of c)if(!1===s.contains(u.directThreat)){const f=[];for(const g of u.mover)!1===s.contains(g)&&f.push(g);f.length>0&&l.push(new DQ(u.directThreat,new sr(f)))}l.length>0&&n.set(a,new ct(l))}for(const a of s){const c=e.get(a).get();n.set(a,c)}return n}}class Rke extends cn{constructor(e){super($localize`Pieces > Influence`,e,new HQ(e),new r0(e))}}class xke extends cn{constructor(e){super($localize`Pieces`,e,new VQ(e),new r0(e))}}class FQ extends HQ{getBoardValue(e,t){const n=this.getControlScoreAndPieceScores(e,t);return gn.multiMetric([n.safeScore,n.threatenedScore,n.controlScore])}getControlScoreAndPieceScores(e,t){const n=e.gameState,i=this.getPiecesMap(n),o=this.getThreatMap(e,i),s=this.filterThreatMap(o,n),a={safeScore:0,threatenedScore:0,controlScore:0};for(const c of O.PLAYERS){const l=new sr;for(const u of i.get(c).get())if(s.get(u).isPresent())a.threatenedScore+=c.getScoreModifier();else{a.safeScore+=c.getScoreModifier();for(const f of Ie.ORTHOGONALS){let g=u.getNext(f,1);for(;n.isOnBoard(g)&&n.getPieceAt(g)===It.UNOCCUPIED;)l.add(g),g=g.getNext(f,1)}}for(const u of l){const f=this.getControlledPieceValue(u,n);a.controlScore+=c.getScoreModifier()*f}}return a}getControlledPieceValue(e,t){let n=1;return t.isHorizontalEdge(e)&&(n*=t.getWidth()),t.isVerticalEdge(e)&&(n*=t.getWidth()),n}}class Lke extends cn{constructor(e){super($localize`Pieces > Control`,e,new FQ(e),new r0(e))}}class zke extends FQ{getBoardValue(e,t){const n=this.getControlScoreAndPieceScores(e,t),i=this.getStepForEscapeMetric(e.gameState);return gn.multiMetric([i,n.safeScore,n.threatenedScore,n.controlScore])}getStepForEscapeMetric(e){const t=e.getPieceAt(this.rules.getKingCoord(e).get()).getOwner(),n=this.getStepForEscape(e)*t.getScoreModifier();return-1===n?t.getOpponent().getPreVictory():-1*n}getStepForEscape(e){const t=this.rules.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(-1)}_getStepForEscape(e,t,n,i){const o=this.getNextGen(e,n,i);return 0===o.length?h.empty():o.some(s=>this.rules.isExternalThrone(e,s))?h.of(t):(t++,i.push(...o),this._getStepForEscape(e,t,o,i))}getNextGen(e,t,n){const i=[];for(const o of t)for(const s of Ie.ORTHOGONALS){let a=o.getNext(s,1);for(;e.isOnBoard(a)&&e.getPieceAt(a)===It.UNOCCUPIED;)n.every(c=>!1===c.equals(a))&&i.push(a),a=a.getNext(s,1)}return i}}class Dke extends cn{constructor(e){super($localize`Escape > Pieces > Control`,e,new zke(e),new r0(e))}}class TI extends y2{generateMove;viewInfo={pieceClasses:[]};EMPTY=It.UNOCCUPIED;capturedCoords=[];passedByCoords=[];chosen=h.empty();constructor(e,t){super(e),this.generateMove=t}updateBoard(e){var t=this;return E(function*(){t.board=t.getState().getCopiedBoard(),t.updateViewInfo()})()}showLastMove(e){var t=this;return E(function*(){const n=t.getPreviousState(),i=t.getState().getCurrentOpponent();for(const o of Ie.ORTHOGONALS){const s=e.getEnd().getNext(o,1);if(n.isOnBoard(s)){const c=n.getRelativeOwner(i,s)===O1.OPPONENT,u=t.getState().getPieceAt(s)===It.UNOCCUPIED;c&&u&&t.capturedCoords.push(s)}}t.passedByCoords=e.getMovedOverCoords()})()}hideLastMove(){this.capturedCoords=[],this.passedByCoords=[]}updateViewInfo(){const e=[];this.board=this.getState().getCopiedBoard();for(let t=0;t<this.getHeight();t++){const n=[];for(let i=0;i<this.getWidth();i++){let o=[];o=this.board[t][i].getOwner()===B.NONE?[""]:this.getPieceClasses(i,t),n.push(o)}e.push(n)}this.viewInfo={pieceClasses:e}}onClick(e,t){var n=this;return E(function*(){const i=yield n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const o=new _(e,t);return n.chosen.equalsValue(o)?(n.cancelMoveAttempt(),A.SUCCESS):n.chosen.isAbsent()||n.pieceBelongsToCurrentPlayer(o)?n.choosePiece(o):n.chooseDestination(e,t)})()}chooseDestination(e,t){var n=this;return E(function*(){const i=n.chosen.get(),o=new _(e,t),s=n.generateMove(i,o);return s.isSuccess()?yield n.chooseMove(s.get()):n.cancelMove(s.getReason())})()}choosePiece(e){var t=this;return E(function*(){return t.board[e.y][e.x]===It.UNOCCUPIED?t.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):!1===t.pieceBelongsToCurrentPlayer(e)?t.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(t.chosen=h.of(e),t.updateViewInfo(),A.SUCCESS)})()}pieceBelongsToCurrentPlayer(e){const t=this.getState(),n=t.getCurrentPlayer();return t.getRelativeOwner(n,e)===O1.PLAYER}cancelMoveAttempt(){this.chosen=h.empty(),this.updateViewInfo()}isThrone(e,t){const n=this.getState();return this.rules.isThrone(n,new _(e,t))}isCentralThrone(e,t){return this.getState().isCentralThrone(new _(e,t))}getPieceClasses(e,t){const n=[],i=new _(e,t),o=this.getState().getAbsoluteOwner(i);return n.push(this.getPlayerClass(o)),this.chosen.equalsValue(i)&&n.push("selected-stroke"),n}getRectClasses(e,t){const n=[],i=new _(e,t);return this.capturedCoords.some(o=>o.equals(i))?n.push("captured-fill"):this.passedByCoords.some(o=>o.equals(i))&&n.push("moved-fill"),n}getClickables(){const e=[];for(let t=0;t<this.getHeight();t++)for(let n=0;n<this.board[t].length;n++){const i=new _(n,t);this.isClickable(i)&&e.push(i)}return e}isClickable(e){return this.interactive&&this.pieceBelongsToCurrentPlayer(e)}isInvader(e,t){return this.board[t][e]===It.PLAYER_ZERO_PAWN}isKing(e,t){return this.board[t][e].isKing()}createAIs(){const e=new r0(this.rules);return[new xke(this.rules),new Rke(this.rules),new Lke(this.rules),new Dke(this.rules),new kn($localize`MCTS`,e,this.rules)]}}function Vke(r,e){1&r&&(N(),V(0,"polygon",8))}function Hke(r,e){1&r&&(N(),V(0,"rect",9))}function Fke(r,e){if(1&r&&(N(),M(0,"g"),z(1,Vke,1,0,"polygon",6)(2,Hke,1,0,"ng-template",null,7,wn),P()),2&r){const t=Pn(3),n=p().index,i=p().index,o=p();m(),v("ngIf",o.isCentralThrone(n,i))("ngIfElse",t)}}function Uke(r,e){if(1&r&&(N(),M(0,"g"),V(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),P()),2&r){const t=p(2).index,n=p().index,i=p();m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function $ke(r,e){if(1&r&&(N(),V(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;v("ngClass",p().viewInfo.pieceClasses[n][t])}}function Gke(r,e){if(1&r&&(N(),V(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function Bke(r,e){if(1&r&&(N(),z(0,$ke,1,1,"polyline",14)(1,Gke,4,20,"ng-template",null,15,wn)),2&r){const t=Pn(2),n=p(2).index,i=p().index;v("ngIf",p().isKing(n,i))("ngIfElse",t)}}function Wke(r,e){if(1&r&&(N(),M(0,"g"),V(1,"circle",10),z(2,Uke,6,25,"g",11)(3,Bke,3,2,"ng-template",null,12,wn),P()),2&r){const t=Pn(4),n=p().index,i=p().index,o=p();m(),Ce("id","piece_",n,"_",i,""),v("ngClass",o.viewInfo.pieceClasses[i][n]),w("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)("cx",.5*o.SPACE_SIZE)("cy",.5*o.SPACE_SIZE),m(),v("ngIf",o.isInvader(n,i))("ngIfElse",t)}}function qke(r,e){if(1&r){const t=de();N(),M(0,"g",3),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),V(1,"rect",4),z(2,Fke,4,2,"g",5)(3,Wke,5,8,"g",5),P()}if(2&r){const t=e.index,n=p().index,i=p();Ce("id","click_",t,"_",n,""),w("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),m(),Ce("id","space_",t,"_",n,""),v("ngClass",i.getRectClasses(t,n)),w("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),m(),v("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),m(),v("ngIf",i.board[n][t]!==i.EMPTY)}}function jke(r,e){if(1&r&&(N(),M(0,"g"),z(1,qke,4,10,"g",2),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function Zke(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"rect",17),W("click",function(){const o=te(t).$implicit;return ne(p().onClick(o.x,o.y))}),P()()}if(2&r){const t=e.$implicit,n=p();m(),Ce("id","click_",t.x,"_",t.y,""),w("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let Yke=(()=>{class r extends TI{constructor(t){super(t,_s.from),this.setRulesAndNode("Brandhub"),this.availableAIs=this.createAIs(),this.encoder=_s.encoder}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-brandhub"]],features:[We],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(N(),M(0,"svg",0),z(1,jke,2,1,"g",1)(2,Zke,2,6,"g",1),P()),2&n&&(w("viewBox",i.getViewBox().toSVGString()),m(),v("ngForOf",i.board),m(),v("ngForOf",i.getClickables()))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();class M2 extends $1{isCentralThrone(e){return e.equals(this.getCentralThrone())}getCentralThrone(){const e=(this.getSize()-1)/2;return new _(e,e)}getRelativeOwner(e,t){const n=this.getAbsoluteOwner(t);let i;return i=n===B.NONE?O1.NONE:e===n?O1.PLAYER:O1.OPPONENT,i}getAbsoluteOwner(e){return this.getPieceAt(e).getOwner()}getSize(){return this.getHeight()}}let qi=(()=>class r extends Da{generateMove;static CASTLE_IS_LEFT_FOR_GOOD=()=>$localize`Central throne is left for good`;static EDGE_ARE_KING_S_ENNEMY=()=>$localize`Edges are king's ennemy`;static CENTRAL_THRONE_CAN_SURROUND_KING=()=>$localize`Central throne can surround king`;static KING_FAR_FROM_HOME_CAN_BE_SANDWICHED=()=>$localize`King far from home can be sandwiched`;static INVADER_STARTS=()=>$localize`Invader starts`;constructor(t){super(),this.generateMove=t}isLegal(t,n,i){const o=i.get(),s=n.getCurrentPlayer(),a=this.getMoveValidity(s,t,n,o);return a.isFailure()?A.failure(a.getReason()):A.SUCCESS}getMoveValidity(t,n,i,o){const s=i.getRelativeOwner(t,n.getStart());if(s===O1.NONE)return A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s===O1.OPPONENT)return A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(i.getRelativeOwner(t,n.getEnd())!==O1.NONE)return A.failure(yC.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(i,n.getEnd())){if(!i.getPieceAt(n.getStart()).isKing())return A.failure(yC.SOLDIERS_CANNOT_SIT_ON_THRONE());if(i.isCentralThrone(n.getEnd())&&o.castleIsLeftForGood)return A.failure(yC.THRONE_IS_LEFT_FOR_GOOD())}const c=n.getStart().getDirectionToward(n.getEnd()).get(),l=n.getStart().getOrthogonalDistance(n.getEnd());let u=n.getStart().getNext(c);for(let f=1;f<l;f++){if(i.getPieceAt(u)!==It.UNOCCUPIED)return A.failure(Me.SOMETHING_IN_THE_WAY());u=u.getNext(c)}return A.SUCCESS}isThrone(t,n){return!!this.isExternalThrone(t,n)||t.isCentralThrone(n)}isExternalThrone(t,n){return t.isCorner(n)}tryCapture(t,n,i,o,s){const a=n.getNext(i);return!1===o.isOnBoard(a)||o.getRelativeOwner(t,a)!==O1.OPPONENT?h.empty():o.getPieceAt(a).isKing()?this.captureKing(t,n,i,o,s):this.capturePawn(t,n,i,o)}captureKing(t,n,i,o,s){const a=n.getNext(i),{backCoord:c,back:l,backInRange:u,left:f,leftCoord:g,right:y,rightCoord:S}=this.getSurroundings(a,i,t,o);return!1===u?this.captureKingAgainstTheWall(f,y,a,s):l===O1.NONE&&this.isThrone(o,c)?this.captureKingAgainstThrone(o,c,a,f,y,s):l===O1.PLAYER?this.captureKingWithAtLeastASandwich(o,a,f,g,y,S,s):h.empty()}getSurroundings(t,n,i,o){const s=t.getNext(n),a=o.isOnBoard(s),c=a?o.getRelativeOwner(i,s):O1.NONE,l=t.getLeft(n),f=o.isOnBoard(l)?o.getRelativeOwner(i,l):O1.NONE,g=t.getRight(n);return{backCoord:s,back:c,backInRange:a,leftCoord:l,left:f,rightCoord:g,right:o.isOnBoard(g)?o.getRelativeOwner(i,g):O1.NONE}}captureKingAgainstTheWall(t,n,i,o){let s=t===O1.PLAYER?1:0;return s+=n===O1.PLAYER?1:0,2===s&&o.edgesAreKingsEnnemy?h.of(i):h.empty()}captureKingAgainstThrone(t,n,i,o,s,a){if(this.isExternalThrone(t,n)){if(a.kingFarFromHomeCanBeSandwiched)return h.of(i)}else if(a.centralThroneCanSurroundKing&&(o===O1.PLAYER||s===O1.PLAYER))return h.of(i);return h.empty()}capturePawn(t,n,i,o){const s=n.getNext(i),a=s.getNext(i);let c=O1.NONE;return o.isOnBoard(a)&&(c=o.getRelativeOwner(t,a)),c===O1.NONE?!1===this.isThrone(o,a)?(Ne.display("TaflRules","capturePawn","cannot capture a pawn without an ally; "+s+"threatened by "+t+"'s pawn in "+n+" coming from this direction ("+i.x+", "+i.y+")cannot capture a pawn without an ally behind"),h.empty()):(Ne.display("TaflRules","capturePawn","pawn captured by 1 opponent and 1 throne; "+s+"threatened by "+t+"'s pawn in "+n+" coming from this direction ("+i.x+", "+i.y+")"),h.of(s)):c===O1.PLAYER?(Ne.display("TaflRules","capturePawn","pawn captured by 2 opponents; "+s+"threatened by "+t+"'s pawn in "+n+" coming from this direction ("+i.x+", "+i.y+")"),h.of(s)):(Ne.display("TaflRules","capturePawn","no captures; "+s+"threatened by "+t+"'s pawn in "+n+" coming from this direction ("+i.x+", "+i.y+")"),h.empty())}captureKingWithAtLeastASandwich(t,n,i,o,s,a,c){if(!1===this.kingTouchCentralThrone(t,n)&&c.kingFarFromHomeCanBeSandwiched)return h.of(n);const l=c.centralThroneCanSurroundKing,u=this.isThrone(t,o),f=i===O1.PLAYER||u&&l,g=this.isThrone(t,a);return f&&(s===O1.PLAYER||g&&l)?h.of(n):h.empty()}kingTouchCentralThrone(t,n){const i=t.getCentralThrone();return n.getOrthogonalDistance(i)<=1}applyLegalMove(t,n,i,o){const s=n.turn,a=n.getCopiedBoard(),c=n.getCurrentPlayer(),l=t.getStart(),u=t.getEnd();a[u.y][u.x]=a[l.y][l.x],a[l.y][l.x]=It.UNOCCUPIED;for(const f of Ie.ORTHOGONALS){const g=this.tryCapture(c,t.getEnd(),f,n,i.get());g.isPresent()&&(a[g.get().y][g.get().x]=It.UNOCCUPIED)}return new M2(a,s+1)}getGameStatus(t,n){const i=t.gameState,o=n.get(),s=this.getWinner(i,o);return s.isPresent()?ve.getVictory(s.get()):ve.ONGOING}getWinner(t,n){const i=this.getKingCoord(t);if(i.isAbsent())return Ne.display("TaflRules","getWinner","The king is dead, victory to invader"),h.of(this.getInvader(n));const o=i.get();return this.isExternalThrone(t,o)?(Ne.display("TaflRules","getWinner","The king escape, victory to defender"),h.of(this.getDefender(n))):this.isPlayerImmobilized(O.ZERO,t,n)?(Ne.display("TaflRules","getWinner","Zero has no move, victory to one"),h.of(O.ONE)):this.isPlayerImmobilized(O.ONE,t,n)?(Ne.display("TaflRules","getWinner","One has no move, victory to zero"),h.of(O.ZERO)):(Ne.display("TaflRules","getWinner","no victory"),h.empty())}getKingCoord(t){const n=t.getSize();for(let i=0;i<n;i++)for(let o=0;o<n;o++)if(t.getPieceAtXY(o,i).isKing())return h.of(new _(o,i));return h.empty()}getInvader(t){return t.invaderStarts?O.ZERO:O.ONE}getDefender(t){return this.getInvader(t).getOpponent()}isPlayerImmobilized(t,n,i){return 0===this.getPlayerListMoves(t,n,i).length}getPlayerListMoves(t,n,i){const o=[],s=this.getPlayerListPawns(t,n);for(const a of s){const c=this.getPossibleDestinations(a,n,i);for(const l of c){const u=this.generateMove(a,l).get();o.push(u)}}return o}getPlayerListPawns(t,n){const i=n.getSize(),o=[];for(let s=0;s<i;s++)for(let a=0;a<i;a++){const c=new _(a,s);n.getAbsoluteOwner(c)===t&&o.push(c)}return o}getPossibleDestinations(t,n,i){const o=[];let s;for(const a of Ie.ORTHOGONALS){s=t.getNext(a,1);let c=!1;for(;n.isOnBoard(s)&&!1===c;)n.getAbsoluteOwner(s)===B.NONE?this.isExternalThrone(n,s)?n.getPieceAt(t).isKing()&&o.push(s):n.isCentralThrone(s)?n.getPieceAt(t).isKing()&&!1===i.castleIsLeftForGood&&o.push(s):o.push(s):c=!0,s=s.getNext(a,1)}return o}})();class Gc extends qi{static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new po({name:()=>$localize`Brandhub`,config:{castleIsLeftForGood:new Qn(!0,qi.CASTLE_IS_LEFT_FOR_GOOD),edgesAreKingsEnnemy:new Qn(!1,qi.EDGE_ARE_KING_S_ENNEMY),centralThroneCanSurroundKing:new Qn(!0,qi.CENTRAL_THRONE_CAN_SURROUND_KING),kingFarFromHomeCanBeSandwiched:new Qn(!0,qi.KING_FAR_FROM_HOME_CAN_BE_SANDWICHED),invaderStarts:new Qn(!0,qi.INVADER_STARTS)}});static get(){return Gc.singleton.isAbsent()&&(Gc.singleton=h.of(new Gc)),Gc.singleton.get()}constructor(){super(_s.from)}getInitialState(e){const t=It.UNOCCUPIED;let n=It.PLAYER_ZERO_PAWN,i=It.PLAYER_ONE_PAWN,o=It.PLAYER_ONE_KING;return!1===e.get().invaderStarts&&(n=It.PLAYER_ONE_PAWN,i=It.PLAYER_ZERO_PAWN,o=It.PLAYER_ZERO_KING),new M2([[t,t,t,n,t,t,t],[t,t,t,n,t,t,t],[t,t,t,i,t,t,t],[n,n,i,o,i,n,n],[t,t,t,i,t,t,t],[t,t,t,n,t,t,t],[t,t,t,n,t,t,t]],0)}getRulesConfigDescription(){return h.of(Gc.RULES_CONFIG_DESCRIPTION)}}const j=It.UNOCCUPIED,p1=It.PLAYER_ZERO_PAWN,Vo=It.PLAYER_ONE_PAWN,dd=It.PLAYER_ONE_KING,UQ=Gc.get().getDefaultRulesConfig();class Kke extends Bn{tutorial=[q.informational($localize`Goal of the game`,$localize`Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,Gc.get().getInitialState(UQ)),q.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,Gc.get().getInitialState(UQ),_s.from(new _(3,1),new _(1,1)).get(),pe.CONGRATULATIONS()),q.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new M2([[j,j,j,p1,j,j,j],[j,j,j,p1,j,j,j],[p1,j,j,Vo,j,j,j],[j,j,Vo,dd,Vo,p1,p1],[j,j,p1,j,j,j,j],[j,j,j,Vo,j,p1,j],[j,j,j,p1,j,j,j]],1),[_s.from(new _(3,5),new _(2,5)).get()],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),q.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new M2([[j,j,j,p1,j,j,j],[j,j,p1,j,j,j,j],[j,j,j,Vo,j,j,j],[p1,Vo,j,j,Vo,p1,p1],[j,Vo,j,j,j,j,j],[j,p1,j,dd,j,p1,j],[j,j,j,p1,j,j,j]],12),[_s.from(new _(2,1),new _(3,1)).get(),_s.from(new _(3,0),new _(3,1)).get()],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),q.fromMove($localize`Capturing the king on his throne`,$localize`To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>You're playing Dark. Capture the king.`,new M2([[j,j,j,j,j,j,j],[j,j,j,Vo,j,j,j],[j,j,j,p1,j,j,j],[j,p1,j,dd,p1,j,j],[j,j,j,p1,j,j,j],[j,Vo,j,j,j,j,j],[j,j,j,j,j,j,j]],72),[_s.from(new _(1,3),new _(2,3)).get()],pe.CONGRATULATIONS_YOU_WON(),$localize`Failed, you let the king run away.`),q.fromMove($localize`Capturing the king next to his throne`,$localize`Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>You're playing Dark. Capture the king.`,new M2([[j,j,p1,j,j,j,j],[j,j,j,p1,j,j,j],[j,j,j,dd,p1,j,j],[j,p1,Vo,j,Vo,j,j],[j,j,j,p1,j,j,j],[j,j,j,j,j,j,j],[j,j,j,j,j,j,j]],72),[_s.from(new _(2,0),new _(2,2)).get()],$localize`The king is dead, long live the king. Congratulations, you won.`,pe.FAILED_TRY_AGAIN()),q.fromMove($localize`Capturing the king far from his throne`,$localize`When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>You're playing Dark. Capture the king.`,new M2([[j,j,j,j,j,j,j],[j,j,j,j,j,j,j],[j,p1,j,p1,j,j,j],[p1,j,j,j,Vo,j,j],[j,j,j,Vo,j,j,j],[j,j,j,j,j,j,j],[j,dd,j,p1,j,j,j]],72),[_s.from(new _(3,6),new _(2,6)).get()],$localize`The king is dead, long live the king. Congratulations, you won.`,pe.FAILED_TRY_AGAIN())]}class hd extends $1{}class Bc extends Nr{static of(e){return new Bc(e.x,e.y)}static encoder=Nr.getEncoder(Bc.of);constructor(e,t){super(e,t)}toString(){return"ConnectSixFirstMove("+this.coord.x+", "+this.coord.y+")"}}class t4 extends q2{static encoder=q2.getEncoder(t4.of);static of(e,t){return L.assert(!1===e.equals(t),"COORDS_SHOULD_BE_DIFFERENT"),new t4(e,t)}toString(){return"ConnectSixDrops("+this.getFirst().toString()+", "+this.getSecond().toString()+")"}equals(e){const t=this.getFirst(),n=e.getFirst(),i=this.getSecond(),o=e.getSecond();return!(!t.equals(n)||!i.equals(o))||!(!t.equals(o)||!i.equals(n))}}var AI;!function(r){r.isFirstMove=function e(n){return n instanceof Bc},r.isDrop=function t(n){return n instanceof t4},r.encoder=ke.disjunction([r.isFirstMove,r.isDrop],[Bc.encoder,t4.encoder])}(AI||(AI={}));class o0{getOwner;N;constructor(e,t){this.getOwner=e,this.N=t}getBoardValue(e){let t=0;for(const n of e.getCoordsAndContents()){const o=n.coord;if(this.getOwner(n.content,e).isPlayer()){const s=this.getSquareScore(e,o);if(gn.VICTORIES.some(a=>a===s))return gn.of(s);t+=s}}return gn.of(t)}getSquareScore(e,t){const n=e.getPieceAt(t),i=this.getOwner(n,e);L.assert(i.isPlayer(),"getSquareScore should not be called with PlayerOrNone.NONE piece");const o=new fn,s=new fn;for(const c of me.DIRECTIONS){const l=this.getNumberOfFreeSpacesAndAllies(e,t,c,i);o.set(c,l[0]),s.set(c,l[1])}return this.getScoreFromDirectionAlliesAndFreeSpaces(s,o)*i.getScoreModifier()}getScoreFromDirectionAlliesAndFreeSpaces(e,t){let n=0;for(const i of[me.UP,me.UP_RIGHT,me.RIGHT,me.DOWN_RIGHT]){const o=e.get(i).get(),s=e.get(i.getOpposite()).get();if(this.N<=o+s+1)return Number.MAX_SAFE_INTEGER;const u=t.get(i).get()+t.get(i.getOpposite()).get();this.N<=u+1&&(n+=2+u-this.N)}return n}getNumberOfFreeSpacesAndAllies(e,t,n,i){let o=0,s=0,a=!0,c=new _(t.x+n.x,t.y+n.y),l=1;const u=i.getOpponent();for(;e.isOnBoard(c)&&l<this.N;){const f=e.getPieceAt(c);if(this.getOwner(f,e)===u)return[o,s];this.getOwner(f,e)===i&&a?s++:a=!1,f!==u&&f!==i&&o++,c=c.getNext(n),l++}return[o,s]}getVictoriousCoord(e){const t=[];for(const n of e.getCoordsAndContents())if(this.getOwner(n.content,e).isPlayer()){const i=n.coord,o=this.getSquareScore(e,i);gn.isVictory(o)&&(o===O.ZERO.getVictoryValue()||o===O.ONE.getVictoryValue())&&t.push(i)}return t}}class mo extends Da{static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=gke.GOBAN;static get(){return mo.singleton.isAbsent()&&(mo.singleton=h.of(new mo)),mo.singleton.get()}static CONNECT_SIX_HELPER=new o0(L.identity,6);static getVictoriousCoords(e){return mo.CONNECT_SIX_HELPER.getVictoriousCoord(e)}getRulesConfigDescription(){return h.of(mo.RULES_CONFIG_DESCRIPTION)}getInitialState(e){const t=it.create(e.get().width,e.get().height,B.NONE);return new hd(t,0)}applyLegalMove(e,t,n,i){return e instanceof t4?this.applyLegalDrops(e,t):this.applyLegalFirstMove(e,t)}applyLegalDrops(e,t){const n=t.getCurrentPlayer(),i=e.getFirst(),o=e.getSecond(),s=t.getCopiedBoard();return s[i.y][i.x]=n,s[o.y][o.x]=n,new hd(s,t.turn+1)}applyLegalFirstMove(e,t){const n=t.getCurrentPlayer(),i=t.getCopiedBoard();return i[e.coord.y][e.coord.x]=n,new hd(i,t.turn+1)}isLegal(e,t){return e instanceof Bc?(L.assert(0===t.turn,"ConnectSixFirstMove should only be used at first move"),!1===t.isOnBoard(e.coord)?A.failure(go.OUT_OF_RANGE(e.coord)):A.SUCCESS):(L.assert(t.turn>0,"ConnectSixDrops should only be used after first move"),!1===t.isOnBoard(e.getFirst())?A.failure(go.OUT_OF_RANGE(e.getFirst())):!1===t.isOnBoard(e.getSecond())?A.failure(go.OUT_OF_RANGE(e.getSecond())):this.isLegalDrops(e,t))}isLegalDrops(e,t){return t.getPieceAt(e.getFirst()).isPlayer()||t.getPieceAt(e.getSecond()).isPlayer()?A.failure(Me.MUST_CLICK_ON_EMPTY_SQUARE()):A.SUCCESS}getGameStatus(e){const t=e.gameState;return mo.CONNECT_SIX_HELPER.getVictoriousCoord(t).length>0?ve.getVictory(t.getCurrentOpponent()):181===t.turn?ve.DRAW:ve.ONGOING}}class E2{static getHoshis(e,t){const n=[],i=E2.getHorizontalCenter(e),o=E2.getVerticalCenter(t),s=E2.getHorizontalLeft(e),a=E2.getVerticalUp(t),c=E2.getHorizontalRight(e),l=E2.getVerticalDown(t);return 12<t&&t%2==1&&n.push(new _(s,o),new _(c,o)),12<e&&e%2==1&&n.push(new _(i,a),new _(i,l)),e%2==1&&t%2==1&&n.push(new _(i,o)),n.push(new _(s,a),new _(s,l),new _(c,a),new _(c,l)),n}static getHorizontalLeft(e){return e<12?2:3}static getHorizontalCenter(e){return Math.floor(e/2)}static getHorizontalRight(e){return e-(E2.getHorizontalLeft(e)+1)}static getVerticalUp(e){return e<12?2:3}static getVerticalCenter(e){return Math.floor(e/2)}static getVerticalDown(e){return e-(E2.getVerticalUp(e)+1)}}let bI=(()=>{class r extends y2{hoshis=[];createHoshis(){const t=this.getHeight(),n=this.getWidth();this.hoshis=E2.getHoshis(n,t)}static \u0275fac=(()=>{let t;return function(i){return(t||(t=z1(r)))(i||r)}})();static \u0275cmp=$e({type:r,selectors:[["ng-component"]],features:[We],decls:0,vars:0,template:function(n,i){},encapsulation:2})}return r})();class $Q extends Yn{getListMoves(e,t){return 0===e.gameState.turn?this.getFirstMove(e.gameState):this.getListDrops(e)}getFirstMove(e){const t=e.getWidth(),n=e.getHeight(),i=Math.floor(t/2),o=Math.floor(n/2),s=new _(i,o);return[Bc.of(s)]}getListDrops(e){const t=this.getAvailableCoords(e.gameState),n=[];for(const i of t){const o=e.gameState.getCopiedBoard();o[i.y][i.x]=e.gameState.getCurrentPlayer();const s=new hd(o,e.gameState.turn),a=this.getAvailableCoords(s);for(const c of a){const l=t4.of(i,c);n.push(l)}}return new ct(n).toList()}getAvailableCoords(e){const t=this.getUsefulCoordsMap(e),n=[];for(const i of e.getCoordsAndContents()){const o=i.coord;!0===t[o.y][o.x]&&!1===i.content.isPlayer()&&n.push(o)}return n}getUsefulCoordsMap(e){const t=e.getWidth(),n=e.getHeight(),i=it.create(t,n,!1);for(const o of e.getCoordsAndContents())o.content.isPlayer()&&this.addNeighboringCoord(i,o.coord);return i}addNeighboringCoord(e,t){const i=e[0].length,o=e.length,s=Math.max(0,t.x-1),a=Math.max(0,t.y-1),c=Math.min(i-1,t.x+1),l=Math.min(o-1,t.y+1);for(let u=a;u<=l;u++)for(let f=s;f<=c;f++)e[u][f]=!0}}class Xke extends Ha{getBoardValue(e,t){const n=e.gameState;let i=0;for(const o of n.getCoordsAndContents())o.content.isPlayer()&&(i+=mo.CONNECT_SIX_HELPER.getSquareScore(n,o.coord));return gn.of(i)}}class Qke extends cn{constructor(){super($localize`Alignment`,mo.get(),new Xke,new $Q)}}function Jke(r,e){if(1&r&&(N(),V(0,"circle",6)),2&r){const t=p().index,n=p().index,i=p();Ce("id","piece_",t,"_",n,""),v("ngClass",i.getSpaceClass(t,n)),w("cx",.5*i.SPACE_SIZE+i.SPACE_SIZE*t)("cy",.5*i.SPACE_SIZE+i.SPACE_SIZE*n)("r",.44*i.SPACE_SIZE)}}function eRe(r,e){if(1&r&&(N(),M(0,"g"),z(1,Jke,1,6,"circle",5),P()),2&r){const t=e.$implicit;m(),v("ngIf",t.isPlayer())}}function tRe(r,e){if(1&r&&(N(),M(0,"g"),z(1,eRe,2,1,"g",3),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function nRe(r,e){if(1&r){const t=de();N(),M(0,"circle",7),W("click",function(){te(t);const i=p();return ne(i.onClick(i.droppedCoord.get()))}),P()}if(2&r){const t=p();v("ngClass",t.getSpaceClass(t.droppedCoord.get().x,t.droppedCoord.get().y)),w("cx",.5*t.SPACE_SIZE+t.SPACE_SIZE*t.droppedCoord.get().x)("cy",.5*t.SPACE_SIZE+t.SPACE_SIZE*t.droppedCoord.get().y)("r",.44*t.SPACE_SIZE)}}let GQ=(()=>{class r extends bI{droppedCoord=h.empty();lastMoved=[];victoryCoords=[];constructor(t){super(t),this.setRulesAndNode("ConnectSix"),this.availableAIs=[new Qke,new kn($localize`MCTS`,new $Q,this.rules)],this.encoder=AI.encoder}updateBoard(t){var n=this;return E(function*(){const i=n.getState();n.board=i.getCopiedBoard(),n.victoryCoords=mo.getVictoriousCoords(i),n.createHoshis()})()}showLastMove(t){var n=this;return E(function*(){n.lastMoved=t instanceof Bc?[t.coord]:[t.getFirst(),t.getSecond()]})()}hideLastMove(){this.lastMoved=[]}onClick(t){var n=this;return E(function*(){const i=t.x,o=t.y,s=yield n.canUserPlay("#click_"+i+"_"+o);if(s.isFailure())return n.cancelMove(s.getReason());const a=new _(i,o);if(0===n.getState().turn){const c=Bc.of(a);return n.chooseMove(c)}if(n.getState().getPieceAt(a).isPlayer())return n.cancelMove(Me.MUST_CLICK_ON_EMPTY_SQUARE());if(n.droppedCoord.isPresent()){if(n.droppedCoord.equalsValue(a))return n.droppedCoord=h.empty(),A.SUCCESS;{const c=t4.of(n.droppedCoord.get(),a);return n.chooseMove(c)}}return n.droppedCoord=h.of(a),A.SUCCESS})()}getSpaceClass(t,n){const i=new _(t,n),o=this.getState().getPieceAt(i),s=[];return this.droppedCoord.equalsValue(i)?(s.push(this.getPlayerClass(this.getState().getCurrentPlayer())),s.push("highlighted-stroke")):(s.push(this.getPlayerClass(o)),this.victoryCoords.some(a=>a.equals(i))&&s.push("victory-stroke"),this.lastMoved.some(a=>a.equals(i))&&s.push("last-move-stroke")),s}cancelMoveAttempt(){this.droppedCoord=h.empty()}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-connect-six"]],features:[We],decls:5,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["app-blank-goban","",3,"width","height","clickCallBack"],["id","pieces"],[4,"ngFor","ngForOf"],["id","dropped","class","base moved-stroke",3,"ngClass","click",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"base",3,"id","ngClass"],["id","dropped",1,"base","moved-stroke",3,"ngClass","click"]],template:function(n,i){1&n&&(N(),M(0,"svg",0)(1,"g",1),W("clickCallBack",function(s){return i.onClick(s)}),P(),M(2,"g",2),z(3,tRe,2,1,"g",3),P(),z(4,nRe,1,4,"circle",4),P()),2&n&&(w("viewBox",i.getViewBox().toSVGString()),m(),v("width",i.getState().getWidth())("height",i.getState().getHeight()),m(2),v("ngForOf",i.board),m(),v("ngIf",i.droppedCoord.isPresent()))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const x=B.NONE,P2=B.ZERO,ji=B.ONE,BQ=mo.get().getDefaultRulesConfig();class rRe extends Bn{tutorial=[q.informational($localize`Initial board and object of the game`,$localize`Connect Six is played on a 19x19 board, on which stones are put on the intersections. The aim of the game is to align 6 of your pieces.`,mo.get().getInitialState(BQ)),q.anyMove($localize`First turn`,$localize`On the first turn, the first player plays only one piece.<br/><br/>You're playing Dark, place your first piece by clicking on an intersection.`,mo.get().getInitialState(BQ),Bc.of(new _(9,9)),pe.CONGRATULATIONS()),q.anyMove($localize`Next turns`,$localize`On all following turns, the players play two pieces.<br/><br/>You're playing Light, do the winning move.`,new hd([[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,ji,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,P2,x,ji,P2,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,P2,P2,x,x,ji,x,x,x,x,x,x],[x,x,x,x,x,x,x,ji,P2,P2,P2,P2,ji,x,x,x,x,x,x],[x,x,x,x,x,x,ji,P2,P2,P2,P2,ji,x,x,x,x,x,x,x],[x,x,x,x,x,x,ji,x,ji,P2,ji,ji,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,P2,ji,P2,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,ji,x,ji,x,P2,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,ji,ji,x,ji,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,ji,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,P2,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x]],20),t4.of(new _(4,11),new _(5,10)),pe.CONGRATULATIONS())]}let n4=(()=>class r{static SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=()=>$localize`Your piece should land on a neighboring square.`;static CANNOT_DROP_AFTER_TURN_40=()=>$localize`You cannot drop a piece during the moving phase.`;static CANNOT_MOVE_BEFORE_TURN_40=()=>$localize`You cannot move a piece before both players have dropped all of their pieces.`;static MUST_JUMP_OVER_PIECES=()=>$localize`A jump must be made over a piece, not over an empty square.`;static MUST_DROP_IN_CENTRAL_ZONE=()=>$localize`A drop must occur in the central zone of the board.`;static INVALID_JUMP=()=>$localize`A jump must land two squares from its original position, and be done in a straight line in any direction.`;static SAME_LOCATION_VISITED_IN_JUMP=()=>$localize`You are visiting the same location twice in a move, you are not allowed to do so.`})();class El extends Nr{static encoder=Nr.getEncoder(El.of);static of(e){return new El(e)}constructor(e){super(e.x,e.y)}toString(){return`ConspirateursMoveDrop(${this.coord.toString()})`}equals(e){return!!Oi.isDrop(e)&&this.coord.equals(e.coord)}}class Pl extends Do{static encoder=q2.getFallibleEncoder(Pl.from);static from(e,t){return e.isAlignedWith(t)&&1===e.getDistance(t)?X.success(new Pl(e,t)):X.failure(n4.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP())}constructor(e,t){super(e,t)}toString(){return`ConspirateursMoveSimple(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(e){return!!Oi.isSimple(e)&&super.equals(e)}}class Ua extends C2{coords;static encoder=ke.tuple([ke.list(_.encoder)],e=>[yt.copy(e.coords)],e=>Ua.from(e[0]).get());static from(e){if(e.length<2)return X.failure("ConspirateursMoveJump requires at least one jump, so two coords");for(let n=1;n<e.length;n++)if(e[n-1].getDirectionToward(e[n]).isFailure()||2!==e[n-1].getDistance(e[n]))return X.failure(n4.INVALID_JUMP());return new sr(e).size()===e.length?X.success(new Ua(e)):X.failure(n4.SAME_LOCATION_VISITED_IN_JUMP())}constructor(e){super(),this.coords=e}addJump(e){const t=yt.copy(this.coords);return t.push(e),Ua.from(t)}getStartingCoord(){return this.coords[0]}getEndingCoord(){return this.coords[this.coords.length-1]}getLandingCoords(){return this.coords.slice(1)}getJumpedOverCoords(){const e=[];for(let t=1;t<this.coords.length;t++){const n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}toString(){return`ConspirateursMoveJump(${this.coords.map(t=>t.toString()).reduce((t,n)=>t+" -> "+n)})`}equals(e){return!(Oi.isSimple(e)||Oi.isDrop(e)||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}}var Oi;!function(r){r.isDrop=function e(i){return i instanceof El},r.isSimple=function t(i){return i instanceof Pl},r.isJump=function n(i){return i instanceof Ua},r.encoder=ke.disjunction([r.isDrop,r.isSimple,r.isJump],[El.encoder,Pl.encoder,Ua.encoder])}(Oi||(Oi={}));class y1 extends $1{static WIDTH=17;static HEIGHT=17;static CENTRAL_ZONE_TOP_LEFT=new _(4,6);static CENTRAL_ZONE_BOTTOM_RIGHT=new _(12,10);static SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16];static ALL_SHELTERS=new ct(y1.SHELTERS_INDICES.flatMap(e=>[new _(e,0),new _(e,y1.HEIGHT-1),new _(0,e),new _(y1.WIDTH-1,e)])).toList();isShelter(e){return this.isVerticalEdge(e)?y1.SHELTERS_INDICES.some(t=>e.y===t):!!this.isHorizontalEdge(e)&&y1.SHELTERS_INDICES.some(t=>e.x===t)}isCentralZone(e){return y1.CENTRAL_ZONE_TOP_LEFT.x<=e.x&&e.x<=y1.CENTRAL_ZONE_BOTTOM_RIGHT.x&&y1.CENTRAL_ZONE_TOP_LEFT.y<=e.y&&e.y<=y1.CENTRAL_ZONE_BOTTOM_RIGHT.y}isDropPhase(){return this.turn<40}getSidePieces(){return this.turn%2==0?we.of(20-this.turn/2,20-this.turn/2):we.of(20-(this.turn-1)/2-1,20-(this.turn-1)/2)}}class Ho extends wr{static singleton=h.empty();static get(){return Ho.singleton.isAbsent()&&(Ho.singleton=h.of(new Ho)),Ho.singleton.get()}getInitialState(){const e=it.create(y1.WIDTH,y1.HEIGHT,B.NONE);return new y1(e,0)}applyLegalMove(e,t,n,i){const o=t.getCopiedBoard();if(Oi.isDrop(e))o[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(Oi.isSimple(e))o[e.getStart().y][e.getStart().x]=B.NONE,o[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer();else{const s=e.getStartingCoord(),a=e.getEndingCoord();o[s.y][s.x]=B.NONE,o[a.y][a.x]=t.getCurrentPlayer()}return new y1(o,t.turn+1)}isLegal(e,t){return Oi.isDrop(e)?this.dropLegality(e,t):Oi.isSimple(e)?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}dropLegality(e,t){return L.assert(t.isOnBoard(e.coord),"Move out of board"),40<=t.turn?A.failure(n4.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord).isPlayer()?A.failure(Me.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?A.failure(n4.MUST_DROP_IN_CENTRAL_ZONE()):A.SUCCESS}simpleMoveLegality(e,t){const n=t.isOnBoard(e.getStart()),i=t.isOnBoard(e.getEnd());if(L.assert(n&&i,"Move out of board"),t.turn<40)return A.failure(n4.CANNOT_MOVE_BEFORE_TURN_40());const o=t.getPieceAt(e.getStart());return o===B.NONE?A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):o===t.getCurrentOpponent()?A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):t.getPieceAt(e.getEnd()).isPlayer()?A.failure(Me.MUST_LAND_ON_EMPTY_SPACE()):A.SUCCESS}jumpLegality(e,t){for(const i of e.coords)if(!1===t.isOnBoard(i))return X.failure(go.OUT_OF_RANGE(i));if(t.turn<40)return A.failure(n4.CANNOT_MOVE_BEFORE_TURN_40());const n=t.getPieceAt(e.getStartingCoord());if(n===B.NONE)return A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===t.getCurrentOpponent())return A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());for(const i of e.getJumpedOverCoords())if(t.getPieceAt(i)===B.NONE)return A.failure(n4.MUST_JUMP_OVER_PIECES());for(const i of e.getLandingCoords())if(t.getPieceAt(i).isPlayer())return A.failure(Me.MUST_LAND_ON_EMPTY_SPACE());return A.SUCCESS}jumpTargetsFrom(e,t){const n=[new _(t.x+2,t.y),new _(t.x-2,t.y),new _(t.x,t.y+2),new _(t.x,t.y-2),new _(t.x+2,t.y+2),new _(t.x+2,t.y-2),new _(t.x-2,t.y+2),new _(t.x-2,t.y-2)],i=[];for(const o of n)e.isOnBoard(o)&&Ua.from([t,o]).isSuccess()&&i.push(o);return i}nextJumps(e,t){const n=e.getEndingCoord(),i=[];for(const o of this.jumpTargetsFrom(t,n)){const s=e.addJump(o);s.isSuccess()&&this.jumpLegality(s.get(),t).isSuccess()&&i.push(s.get())}return i}jumpHasPossibleNextTargets(e,t){return this.nextJumps(e,t).length>0}getGameStatus(e){const t=e.gameState,n=we.of(0,0);for(const i of y1.ALL_SHELTERS){const o=t.getPieceAt(i);if(o.isPlayer()&&(n.add(o,1),20===n.get(o)))return ve.getVictory(o)}return ve.ONGOING}}const C=B.NONE,Ct=B.ZERO,pt=B.ONE;class iRe extends Bn{tutorial=[q.informational($localize`Board and aim of the game`,$localize`Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially.`,Ho.get().getInitialState()),q.anyMove($localize`Initial phase`,$localize`In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>You're playing Dark, drop one of your piece in the central zone.`,Ho.get().getInitialState(),El.of(new _(7,7)),pe.CONGRATULATIONS()),q.fromPredicate($localize`Simple move`,$localize`Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move.`,new y1([[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,Ct,Ct,pt,pt,Ct,Ct,pt,Ct,pt,C,C,C,C],[C,C,C,C,Ct,pt,Ct,pt,Ct,Ct,Ct,Ct,pt,C,C,C,C],[C,C,C,C,Ct,pt,C,C,C,C,C,pt,Ct,C,C,C,C],[C,C,C,C,pt,Ct,Ct,pt,pt,pt,Ct,Ct,Ct,C,C,C,C],[C,C,C,C,pt,Ct,pt,pt,pt,pt,pt,pt,Ct,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]],40),Pl.from(new _(4,6),new _(3,5)).get(),(e,t,n)=>Oi.isSimple(e)?A.SUCCESS:A.failure($localize`You have made a jump, not a simple move. Try again!`),pe.CONGRATULATIONS()),q.fromPredicate($localize`Jumps`,$localize`The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful).`,new y1([[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,Ct,Ct,pt,pt,Ct,Ct,pt,Ct,pt,C,C,C,C],[C,C,C,C,Ct,pt,Ct,pt,Ct,Ct,Ct,Ct,pt,C,C,C,C],[C,C,C,C,Ct,pt,C,C,C,C,C,pt,Ct,C,C,C,C],[C,C,C,C,pt,Ct,Ct,pt,pt,pt,Ct,Ct,Ct,C,C,C,C],[C,C,C,C,pt,Ct,pt,pt,pt,pt,pt,pt,Ct,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]],40),Ua.from([new _(6,7),new _(6,5)]).get(),(e,t,n)=>Oi.isJump(e)?A.SUCCESS:A.failure($localize`You have not performed a jump. Try again!`),pe.CONGRATULATIONS()),q.fromMove($localize`Chaining jumps in a single move`,$localize`Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it.`,new y1([[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,pt,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,pt,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,pt,C,C,C,C,C,C,C,C,C],[C,C,C,C,Ct,Ct,C,pt,Ct,Ct,pt,Ct,pt,C,C,C,C],[C,C,C,C,Ct,C,Ct,pt,Ct,Ct,Ct,Ct,pt,C,C,C,C],[C,C,C,C,Ct,pt,C,C,C,C,C,pt,Ct,C,C,C,C],[C,C,C,C,pt,Ct,Ct,pt,pt,pt,Ct,Ct,Ct,C,C,C,C],[C,C,C,C,pt,Ct,pt,pt,pt,pt,pt,pt,Ct,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C],[C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C]],40),[Ua.from([new _(8,6),new _(6,4),new _(6,2),new _(6,0)]).get()],$localize`Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does.`,$localize`You have not performed a triple jump. Try again!`)]}let gd=(()=>class r{static NO_MORE_PIECES_OF_THIS_TYPE=()=>$localize`You do not have any pieces of this type anymore.`;static SPACE_IS_FULL=()=>$localize`You cannot play here: this space is already full.`;static TARGET_STACK_TOO_HIGH=()=>$localize`You cannot add more pieces to the target stack, as it will contain more than 4 pieces.`;static MUST_SHIFT_TO_NEIGHBOR=()=>$localize`To perform a shift, you must move the pieces to a neighboring space.`;static MUST_SELECT_PIECE_FIRST=()=>$localize`You must first select either a piece from the side, or a stack of pieces to shift on the board.`})();class _n{owner;otherPieceType;static encoder=ke.tuple([B.encoder,ke.identity()],e=>[e.owner,e.otherPieceType],e=>_n.of(e[0],e[1]));static EMPTY=new _n(B.NONE,!1);static ZERO_FIRST=new _n(O.ZERO,!1);static ZERO_SECOND=new _n(O.ZERO,!0);static ONE_FIRST=new _n(O.ONE,!1);static ONE_SECOND=new _n(O.ONE,!0);static PLAYER_PIECES=[_n.ZERO_FIRST,_n.ZERO_SECOND,_n.ONE_FIRST,_n.ONE_SECOND];static of(e,t){return e===O.ZERO?t?_n.ZERO_SECOND:_n.ZERO_FIRST:e===O.ONE?t?_n.ONE_SECOND:_n.ONE_FIRST:_n.EMPTY}constructor(e,t){this.owner=e,this.otherPieceType=t}toString(){return`DiamPiece(${this.owner}, ${this.otherPieceType})`}equals(e){return this===e}}class WQ extends C2{isDrop(){return this instanceof Sl}isShift(){return this instanceof S2}}class Sl extends WQ{target;piece;static encoder=ke.tuple([ke.identity(),_n.encoder],e=>[e.target,e.piece],e=>new Sl(e[0],e[1]));constructor(e,t){if(super(),this.target=e,this.piece=t,t===_n.EMPTY)throw new Error("Cannot drop an empty piece")}getTarget(){return this.target}equals(e){return e instanceof Sl&&!(this.target!==e.target||this.piece!==e.piece)}toString(){return`DiamMoveDrop(${this.target}, ${this.piece})`}}class S2 extends WQ{start;moveDirection;static encoder=ke.tuple([_.encoder,ke.identity()],e=>[e.start,"clockwise"===e.moveDirection],e=>new S2(e[0],e[1]?"clockwise":"counterclockwise"));static ofRepresentation(e,t){return new S2(new _(e.x,3-e.y),t)}constructor(e,t){super(),this.start=e,this.moveDirection=t}getTarget(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}equals(e){return e instanceof S2&&!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}toString(){return`DiamMoveShift(${this.start}, ${this.moveDirection})`}}const oRe=ke.disjunction([r=>r.isDrop(),r=>r.isShift()],[Sl.encoder,S2.encoder]);let gr=(()=>{class r extends $1{remainingPieces;static WIDTH=8;static HEIGHT=4;static ofRepresentation(t,n){const i=t.reverse(),o=[4,4,4,4];for(let s=0;s<r.HEIGHT;s++)for(let a=0;a<r.WIDTH;a++)i[s][a]!==_n.EMPTY&&o[r.pieceIndex(i[s][a])]--;return hn(o.every(s=>0<=s),"Invalid DiamState representation uses too many pieces"),new r(i,o,n)}static pieceIndex(t){switch(t){case _n.ZERO_FIRST:return 0;case _n.ZERO_SECOND:return 1;case _n.ONE_FIRST:return 2;default:return L.expectToBe(t,_n.ONE_SECOND),3}}constructor(t,n,i){super(t,i),this.remainingPieces=n}getRemainingPiecesOf(t){return this.remainingPieces[r.pieceIndex(t)]}getStackHeight(t){let n=0;for(let i=0;i<r.HEIGHT&&this.getPieceAtXY(t,i)!==_n.EMPTY;i++)n++;return n}}return r})();class r4 extends wr{static singleton=h.empty();static get(){return r4.singleton.isAbsent()&&(r4.singleton=h.of(new r4)),r4.singleton.get()}getInitialState(){const e=_n.EMPTY;return new gr([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}applyLegalMove(e,t,n,i){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}applyLegalDrop(e,t){const n=it.copy(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;const i=yt.copy(t.remainingPieces);return i[gr.pieceIndex(e.piece)]-=1,new gr(n,i,t.turn+1)}applyLegalShift(e,t){const n=it.copy(t.board),i=e.getTarget();let o=t.getStackHeight(i),s=e.start.y;for(;s<gr.HEIGHT&&t.getPieceAtXY(e.start.x,s)!==_n.EMPTY;)n[o][i]=t.getPieceAtXY(e.start.x,s),n[s][e.start.x]=_n.EMPTY,o++,s++;return new gr(n,t.remainingPieces,t.turn+1)}isLegal(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}isDropLegal(e,t){return L.assert(e.target<gr.WIDTH,"DiamMoveDrop out of board"),L.assert(e.piece.owner!==B.NONE,"DiamMoveDrop cannot contain an empty piece"),e.piece.owner===t.getCurrentOpponent()?A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):0===t.getRemainingPiecesOf(e.piece)?A.failure(gd.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}dropHeightValidity(e,t){return t.getStackHeight(e.target)===gr.HEIGHT?A.failure(gd.SPACE_IS_FULL()):A.SUCCESS}isShiftLegal(e,t){const n=t.getPieceAt(e.start);return n.owner===B.NONE?A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n.owner===t.getCurrentOpponent()?A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):this.shiftHeightValidity(e,t)}shiftHeightValidity(e,t){const n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>gr.HEIGHT?A.failure(gd.TARGET_STACK_TOO_HIGH()):A.SUCCESS}getGameStatus(e){const t=this.findHighestAlignment(e.gameState);if(t.isPresent()){const n=e.gameState.getPieceAt(t.get());return L.assert(n.owner.isPlayer(),"highest alignment is owned by a player"),ve.getVictory(n.owner)}return ve.ONGOING}findHighestAlignment(e){for(let t=0;t<gr.WIDTH/2;t++)for(let n=gr.HEIGHT-1;n>0;n--){const i=e.getPieceAtXY(t,n),o=e.getPieceAtXY(t+gr.WIDTH/2,n);if(i!==_n.EMPTY&&i===o)return h.of(new _(t,n))}return h.empty()}pieceCanMove(e,t){return!!this.isShiftLegal(new S2(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new S2(t,"counterclockwise"),e).isSuccess()}}const qe=_n.EMPTY,ru=_n.ZERO_FIRST,qQ=_n.ZERO_SECOND,EC=_n.ONE_FIRST,wI=_n.ONE_SECOND;class sRe{tutorial=[q.informational($localize`Initial board and player pieces`,$localize`Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right.`,r4.get().getInitialState()),q.fromMove($localize`Goal of the game`,$localize`At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>You're playing Light, win the game!`,gr.ofRepresentation([[qe,qe,qe,qe,qe,qe,qe,qe],[qe,qe,qe,qe,qe,qe,qe,qe],[qe,qe,qe,qe,EC,qe,qe,qe],[ru,qe,qe,qe,ru,qe,qe,qe]],3),[new Sl(0,_n.ONE_FIRST)],pe.CONGRATULATIONS_YOU_WON(),$localize`Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board.`),q.fromMove($localize`Types of move`,$localize`You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board.`,gr.ofRepresentation([[qe,qe,qe,qe,qe,qe,qe,qe],[qe,qe,qe,qe,wI,qe,qe,qe],[qe,qe,qe,qe,ru,qe,qe,qe],[EC,qe,qe,qe,qQ,qe,qe,qe]],4),[S2.ofRepresentation(new _(4,3),"counterclockwise"),S2.ofRepresentation(new _(4,3),"clockwise"),S2.ofRepresentation(new _(4,2),"counterclockwise"),S2.ofRepresentation(new _(4,2),"clockwise")],pe.CONGRATULATIONS(),$localize`Failed, try to move one of your piece that is already on the board.`),q.fromMove($localize`Special case`,$localize`It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!`,gr.ofRepresentation([[qe,qe,qe,qe,ru,qe,qe,qe],[qe,qe,qe,qe,wI,qe,qe,ru],[qe,qe,qe,qe,ru,qe,qe,wI],[qe,EC,qe,qe,qQ,qe,qe,EC]],8),[S2.ofRepresentation(new _(4,2),"counterclockwise")],pe.CONGRATULATIONS(),$localize`Failed, try to shift a stack of pieces to the left.`)]}let jQ=(()=>{class r extends $c{SPACE_SIZE=100;board;getTriangleCornerCoords(t,n){return(t+n)%2==0?this.getUpwardCoordinate():this.getDownwardCoordinate()}getTrianglePoints(t,n){const i=this.getTriangleCornerCoords(t,n);return this.mapCoordsToPoints(i)}getTriangleTranslationCoord(t,n){return new _(.5*t*this.SPACE_SIZE,n*this.SPACE_SIZE)}getTriangleTranslation(t,n){const i=this.getTriangleTranslationCoord(t,n);return"translate("+i.x+", "+i.y+")"}getDownwardCoordinate(){const n=this.SPACE_SIZE/2,i=this.SPACE_SIZE,s=this.SPACE_SIZE,a=new _(0,0);return[a,new _(n,s),new _(i,0),a]}getUpwardCoordinate(){const n=this.SPACE_SIZE/2,i=this.SPACE_SIZE,s=this.SPACE_SIZE,a=new _(0,s);return[a,new _(n,0),new _(i,s),a]}getPyramidPoints(t,n){return(t+n)%2==1?this.getDownwardPyramidPoints():this.getUpwardPyramidPoints()}getDownwardPyramidCoords(){const t=this.SPACE_SIZE,n=this.SPACE_SIZE/2,i=new _(0,0),o=new _(t,0),s=new _(n,t),a=new _(n,n);return[i,s,a,i,a,o,i,o,s,a,o]}getDownwardPyramidPoints(){const t=this.getDownwardPyramidCoords();return this.mapCoordsToPoints(t)}mapCoordsToPoints(t){return t.map(n=>n.toSVGPoint()).join(", ")}getUpwardPyramidCoords(){const t=this.SPACE_SIZE/2,n=this.SPACE_SIZE,i=new _(0,n),o=new _(n,n),s=new _(t,0),a=new _(t,t);return[i,s,a,i,a,o,i,o,s,a,o]}getUpwardPyramidPoints(){const t=this.getUpwardPyramidCoords();return this.mapCoordsToPoints(t)}static \u0275fac=(()=>{let t;return function(i){return(t||(t=z1(r)))(i||r)}})();static \u0275cmp=$e({type:r,selectors:[["ng-component"]],features:[We],decls:0,vars:0,template:function(n,i){},encapsulation:2})}return r})(),pd=(()=>class r{static INVALID_DISTANCE=()=>$localize`Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is.`;static NOT_ENOUGH_TILES_TO_EXCHANGE=()=>$localize`You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it.`;static FIRST_CLICK_SHOULD_NOT_BE_NULL=()=>$localize`Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles.`;static CANNOT_CAPTURE_FROM_EMPTY=()=>$localize`You cannot capture from an empty space.`})();class Xs{static getNeighbors(e){let t;const n=new _(e.x-1,e.y),i=new _(e.x+1,e.y);return t=(e.x+e.y)%2==1?[n,i,new _(e.x,e.y-1)]:[n,i,new _(e.x,e.y+1)],t}static getFakeNeighbors(e){return new _(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}static getCommonNeighbor(e,t){const n=Xs.getNeighbors(e),i=Xs.getNeighbors(t);let o=0;for(;o<n.length;){const s=n[o];let a=0;for(;a<i.length;){if(s.equals(i[a]))return h.of(s);a++}o++}return h.empty()}static isSpaceDark(e){return(e.x+e.y)%2==0}}class s0 extends $1{static getEmptyNeighbors(e,t,n){const i=[];for(const o of Xs.getNeighbors(t))o.isInRange(e[0].length,e.length)&&e[o.y][o.x]===n&&i.push(o);return i}getEmptyNeighbors(e,t){return s0.getEmptyNeighbors(this.board,e,t)}}var Wc;let Ti=class extends s0{static#e=Wc=this;tiles;captures;static NEIGHBORS_TILES_DIRECTIONS=[new $t(0,-2),new $t(3,-1),new $t(3,1),new $t(0,2),new $t(-3,1),new $t(-3,-1)];static getTilesUpperLeftCoord(e){const t=e.x-e.x%3;let n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new _(t,n)}static isOnBoard(e){return e.isInRange(15,10)}static getPresentNeighborEntrances(e){return[new _(e.x+1,e.y-1),new _(e.x+3,e.y+0),new _(e.x+3,e.y+1),new _(e.x+1,e.y+2),new _(e.x-1,e.y+1),new _(e.x-1,e.y+0)].filter(Wc.isOnBoard)}constructor(e,t,n,i){super(e,t),this.tiles=n,this.captures=i,n.makeImmutable(),i.makeImmutable()}applyLegalMovement(e){const t=e.getStart(),n=e.getEnd(),i=this.getCopiedBoard();return i[n.y][n.x]=Ee.ofPlayer(this.getCurrentPlayer()),i[t.y][t.x]=Ee.EMPTY,new Wc(i,this.turn,this.tiles,this.captures)}doMovementCaptures(e){const t=this.getCapturedNeighbors(e.getEnd());let n=this;for(const i of t)n=n.capture(i);return n}getCapturedNeighbors(e){const t=this.getCurrentOpponent();return Xs.getNeighbors(e).filter(i=>!i.isNotInRange(15,10)&&!!this.getPieceAt(i).is(t)&&this.isSurrounded(i))}isSurrounded(e){return 0===this.getEmptyNeighbors(e,Ee.EMPTY).length}capture(e){const t=this.getCopiedBoard(),n=this.captures.getCopy();return t[e.y][e.x]=Ee.EMPTY,n.add(this.getCurrentPlayer(),1),new Wc(t,this.turn,this.tiles,n)}removeTilesIfNeeded(e,t){let n=this;const i=Wc.getTilesUpperLeftCoord(e);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){n=this.deconnectTile(i,t);const o=Wc.getPresentNeighborEntrances(i);for(const s of o){const a=n.getPieceAt(s);a===Ee.EMPTY?n=n.removeTilesIfNeeded(s,t):a.is(this.getCurrentOpponent())&&n.isSurrounded(s)&&(n=n.capture(s))}}return n}isTileEmpty(e){L.assert(this.getPieceAt(e)!==Ee.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(let t=0;t<2;t++)for(let n=0;n<3;n++){const i=e.getNext(new $t(n,t),1);if(this.getPieceAt(i)!==Ee.EMPTY)return!1}return!0}isDeconnectable(e){const t=this.getPresentNeighborTilesRelativeIndices(e);if(t.length>3)return!1;let n=0;for(let i=1;i<t.length;i++)!1===this.areNeighbor(t[i-1],t[i])&&(n+=1);return!1===this.areNeighbor(t[0],t[t.length-1])&&(n+=1),n<=1}areNeighbor(e,t){return e+1===t||0===e&&5===t}getPresentNeighborTilesRelativeIndices(e){const t=[];let n=h.empty();for(let i=0;i<6;i++){const s=e.getNext(Wc.NEIGHBORS_TILES_DIRECTIONS[i],1);Wc.isOnBoard(s)&&this.getPieceAt(s)!==Ee.UNREACHABLE&&(n.isAbsent()&&(n=h.of(i)),t.push(i-n.get()))}return t}deconnectTile(e,t){const n=this.getCopiedBoard(),i=e.x,o=e.y;for(let a=0;a<2;a++)for(let c=0;c<3;c++)n[o+a][i+c]=Ee.UNREACHABLE;const s=this.tiles.getCopy();return t&&s.add(this.getCurrentPlayer(),1),new Wc(n,this.turn,s,this.captures)}getLegalLandings(e){const t=[];for(const n of Ai.STEPS){const i=e.getNext(n.direction,1);this.isOnBoard(i)&&this.getPieceAt(i)===Ee.EMPTY&&t.push(i)}return t}getPiecesByFreedom(){const e=U1.of([0,0,0,0],[0,0,0,0]);for(let t=0;t<10;t++)for(let n=0;n<15;n++){const i=this.board[t][n];if(i.isPlayer()){const o=i.getPlayer(),s=this.getEmptyNeighbors(new _(n,t),Ee.EMPTY).length;e.add(o,s,1)}}return e}};Ti=Wc=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],Ti);class Ai{direction;str;static LEFT=new Ai(new $t(-2,0),"LEFT");static UP_LEFT=new Ai(me.UP_LEFT,"UP_LEFT");static UP_RIGHT=new Ai(me.UP_RIGHT,"UP_RIGHT");static RIGHT=new Ai(new $t(2,0),"RIGHT");static DOWN_LEFT=new Ai(me.DOWN_LEFT,"DOWN_LEFT");static DOWN_RIGHT=new Ai(me.DOWN_RIGHT,"DOWN_RIGHT");static STEPS=[Ai.LEFT,Ai.UP_LEFT,Ai.UP_RIGHT,Ai.RIGHT,Ai.DOWN_LEFT,Ai.DOWN_RIGHT];static ofCoords(e,t){const n=e.getVectorToward(t),i=Ai.STEPS.findIndex(o=>o.direction.equals(n));return L.assert(-1!==i,pd.INVALID_DISTANCE()),Ai.STEPS[i]}constructor(e,t){this.direction=e,this.str=t}}class O2 extends Do{static encoder=Do.getEncoder(O2.of);static of(e,t){const n=Ai.ofCoords(e,t);return O2.ofMovement(e,n)}static ofMovement(e,t){L.assert(Ti.isOnBoard(e),"Starting coord cannot be out of range (width: 15, height: 10).");const n=new _(e.x+t.direction.x,e.y+t.direction.y);return L.assert(Ti.isOnBoard(n),"Landing coord cannot be out of range (width: 15, height: 10)."),new O2(e,n)}constructor(e,t){super(e,t)}toString(){return"CoerceoRegularMove("+this.getStart().toString()+" > "+this.getEnd().toString()+")"}equals(e){return!Tl.isTileExchange(e)&&super.equals(e)}}class Ol extends Nr{static encoder=Nr.getEncoder(Ol.of);static of(e){return L.assert(Ti.isOnBoard(e),"Captured coord cannot be out of range (width: 15, height: 10)."),new Ol(e)}constructor(e){super(e.x,e.y)}toString(){return"CoerceoTileExchangeMove("+this.coord.x+", "+this.coord.y+")"}equals(e){return!!Tl.isTileExchange(e)&&e.coord.equals(this.coord)}}var Tl;!function(r){r.isNormalMove=function e(n){return n instanceof O2},r.isTileExchange=function t(n){return n instanceof Ol},r.encoder=ke.disjunction([r.isNormalMove,r.isTileExchange],[O2.encoder,Ol.encoder])}(Tl||(Tl={}));class cRe extends or{getMetrics(e,t){const n=e.gameState,i=n.getPiecesByFreedom(),o=this.getPiecesScore(i),s=2*n.captures.get(O.ZERO)+o[0],a=2*n.captures.get(O.ONE)+o[1];return U1.ofSingle(s,a)}getPiecesScore(e){return[this.getPlayerPiecesScore(e.get(O.ZERO).get()),this.getPlayerPiecesScore(e.get(O.ONE).get())]}getPlayerPiecesScore(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}}class NI extends Yn{getListMoves(e,t){let n=this.getListExchanges(e);return n=n.concat(this.getListMovement(e)),n}getListExchanges(e){const t=[],n=e.gameState,i=n.getCurrentPlayer(),o=Ee.ofPlayer(n.getCurrentOpponent());if(n.tiles.get(i)<2)return t;for(const s of n.getCoordsAndContents())if(s.content===o){const a=Ol.of(s.coord);t.push(a)}return t}getListMovement(e){const t=[],n=e.gameState,i=n.getCurrentPlayer();for(const o of n.getCoordsAndContents()){const s=o.coord;if(o.content.is(i)){const a=n.getLegalLandings(s);for(const c of a){const l=O2.of(s,c);t.push(l)}}}return t}}class lRe extends or{getMetrics(e,t){const n=e.gameState,i=this.getPiecesMap(n),o=this.getThreatMap(n,i),s=this.filterThreatMap(o,n),u=U1.of([0,0,0],[0,0,0]);for(const f of O.PLAYERS){for(const g of i.get(f).get())s.get(g).isPresent()?u.add(f,1,1):u.add(f,0,1);u.add(f,2,n.tiles.get(f))}return u}getPiecesMap(e){const t=new fn,n=[],i=[];for(const o of e.getCoordsAndContents()){const s=o.coord,a=e.getPieceAt(s);a===Ee.ZERO?n.push(s):a===Ee.ONE&&i.push(s)}return t.set(O.ZERO,new sr(n)),t.set(O.ONE,new sr(i)),t}getThreatMap(e,t){const n=new fn;for(const i of O.PLAYERS)for(const o of t.get(i).get()){const s=this.getThreat(o,e);s.isPresent()&&n.set(o,s.get())}return n}getThreat(e,t){const i=t.getPieceAt(e).getPlayer().getOpponent();let o=h.empty(),s=h.empty(),a=[];const c=Xs.getNeighbors(e).filter(Ti.isOnBoard);for(const l of c){const u=t.getPieceAt(l);if(u.is(i))a.push(l),this.tileCouldBeRemovedThisTurn(l,t,i)&&(s=h.of(l));else if(u===Ee.EMPTY){if(o.isPresent())return h.empty();o=h.of(l)}}if(o.isPresent()){const l=[];for(const u of Ai.STEPS){const f=o.get().getNext(u.direction,1);Ti.isOnBoard(f)&&t.getPieceAt(f).is(i)&&!1===a.some(g=>g.equals(f))&&l.push(f)}if(l.length>0)return h.of(new MC(new sr(a),new sr(l)))}if(s.isPresent()){a=a.filter(u=>u.equals(s.get()));const l=new sr(a);return h.of(new MC(l,new sr([s.get()])))}return h.empty()}tileCouldBeRemovedThisTurn(e,t,n){const i=n.getOpponent();if(!1===t.isDeconnectable(e))return!1;let s=h.empty();const a=Ti.getTilesUpperLeftCoord(e);for(let c=0;c<2;c++)for(let l=0;l<3;l++){const u=a.getNext(new $t(l,c),1);if(t.getPieceAt(u).is(n)){if(!this.pieceCouldLeaveTheTile(u,t))return!1;s=h.of(u)}else if(t.getPieceAt(u).is(i))return!1}return s.isPresent()}pieceCouldLeaveTheTile(e,t){const n=Ti.getTilesUpperLeftCoord(e);for(const i of Ai.STEPS){const o=e.getNext(i.direction,1),s=Ti.getTilesUpperLeftCoord(o);if(!1===n.equals(s)&&Ti.isOnBoard(o)&&t.getPieceAt(o)===Ee.EMPTY)return!0}return!1}filterThreatMap(e,t){const n=new fn,i=e.listKeys(),o=i.filter(a=>t.getPieceAt(a).is(t.getCurrentPlayer())),s=new sr(i.filter(a=>t.getPieceAt(a).is(t.getCurrentOpponent())));for(const a of o){const c=e.get(a).get();let l=h.empty();for(const u of c.directThreats)if(!1===s.contains(u)){const f=[];for(const g of c.mover)!1===s.contains(g)&&f.push(g);f.length>0&&(l=h.of(new MC(c.directThreats,new sr(f))))}l.isPresent()&&n.set(a,l.get())}for(const a of s){const c=e.get(a).get();n.set(a,c)}return n}}class uRe extends NI{getListMoves(e,t){const n=super.getListMoves(e,t);return this.putCaptureFirst(e,n)}putCaptureFirst(e,t){return yt.sortByDescending(t,n=>this.moveCapturesList(e,n).length),t}moveCapturesList(e,t){return Tl.isTileExchange(t)?[t.coord]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.getStart(),!0).getCapturedNeighbors(t.getEnd())}}function fRe(r,e){if(1&r&&(N(),V(0,"polygon",7)),2&r){const t=p().index,n=p().index,i=p();Ce("id","space_",t,"_",n,""),v("ngClass",i.getSpaceClass(t,n)),w("points",i.getTrianglePoints(t,n))("transform",i.getTriangleInHexTranslation(t,n))}}function dRe(r,e){if(1&r){const t=de();N(),M(0,"g",5),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),z(1,fRe,1,5,"polygon",6),P()}if(2&r){const t=e.index,n=p().index,i=p();Ce("id","click_",t,"_",n,""),m(),v("ngIf",i.mustDraw(t,n))}}function hRe(r,e){if(1&r&&(N(),M(0,"g"),z(1,dRe,2,3,"g",4),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function gRe(r,e){if(1&r&&(N(),V(0,"polygon",9)),2&r){const t=p().index,n=p().index,i=p();Ce("id","pyramid_",t,"_",n,""),v("ngClass",i.getPyramidClass(t,n)),w("points",i.getPyramidPoints(t,n))("transform",i.getTriangleInHexTranslation(t,n))}}function pRe(r,e){if(1&r){const t=de();N(),M(0,"g",5),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),z(1,gRe,1,5,"polygon",8),P()}if(2&r){const t=e.index,n=p().index,i=p();Ce("id","click_",t,"_",n,""),m(),v("ngIf",i.isPyramid(t,n))}}function mRe(r,e){if(1&r&&(N(),M(0,"g"),z(1,pRe,2,3,"g",4),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function _Re(r,e){if(1&r){const t=de();N(),M(0,"rect",12),W("click",function(){const o=te(t).$implicit;return ne(p(2).onClick(o.x,o.y))}),P()}if(2&r){const t=e.$implicit,n=p(2);w("x",n.SPACE_SIZE/2-n.INDICATOR_SIZE/2)("y",n.getIndicatorY(t))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)("transform",n.getTriangleInHexTranslation(t.x,t.y))}}function CRe(r,e){if(1&r&&(N(),M(0,"g"),V(1,"polygon",10),z(2,_Re,1,5,"rect",11),P()),2&r){const t=p();m(),Ce("id","selected_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),w("points",t.getTrianglePoints(t.chosenCoord.get().x,t.chosenCoord.get().y))("transform",t.getTriangleInHexTranslation(t.chosenCoord.get().x,t.chosenCoord.get().y)),m(),v("ngForOf",t.possibleLandings)}}function vRe(r,e){if(1&r&&(N(),V(0,"polygon",14)),2&r){const t=p(2);Ce("id","last_start_",t.lastStart.get().x,"_",t.lastStart.get().y,""),w("points",t.getTrianglePoints(t.lastStart.get().x,t.lastStart.get().y))("transform",t.getTriangleInHexTranslation(t.lastStart.get().x,t.lastStart.get().y))}}function yRe(r,e){if(1&r&&(N(),V(0,"polygon",14)),2&r){const t=p(2);Ce("id","last_end_",t.lastEnd.get().x,"_",t.lastEnd.get().y,""),w("points",t.getTrianglePoints(t.lastEnd.get().x,t.lastEnd.get().y))("transform",t.getTriangleInHexTranslation(t.lastEnd.get().x,t.lastEnd.get().y))}}function MRe(r,e){if(1&r&&(N(),z(0,vRe,1,4,"polygon",13)(1,yRe,1,4,"polygon",13)),2&r){const t=p();v("ngIf",t.lastStart.isPresent()),m(),v("ngIf",t.lastEnd.isPresent())}}const ERe=r=>["base",r];function PRe(r,e){if(1&r&&(N(),M(0,"g",16),V(1,"polygon",17),M(2,"text",18),st(3),P()()),2&r){const t=p().$implicit,n=p();v("id","tilesCount"+t.getValue()),w("transform",n.getTilesCountTranslation(t)),m(),v("ngClass",Oa(7,ERe,"player"+t.getValue()+"-fill")),w("points",n.getTilesCountCoordinate())("stroke",n.lastTurnWasTilesExchange(t)?"yellow":"black"),m(),w("font-size",n.SPACE_SIZE/2),m(),mn(n.tiles.get(t))}}function SRe(r,e){if(1&r&&(N(),M(0,"g"),z(1,PRe,4,9,"g",15),P()),2&r){const t=e.$implicit,n=p();m(),v("ngIf",n.mustShowTilesOf(t))}}let ORe=(()=>{class r extends jQ{state;tiles=we.of(0,0);NONE=Ee.UNREACHABLE;INDICATOR_SIZE=10;chosenCoord=h.empty();lastStart=h.empty();lastEnd=h.empty();possibleLandings=[];constructor(t){super(t),this.setRulesAndNode("Coerceo"),this.availableAIs=[new cn($localize`Pieces > Threats > Tiles`,this.rules,new lRe,new uRe),new cn($localize`Captures > Freedom`,this.rules,new cRe,new NI),new kn($localize`MCTS`,new NI,this.rules)],this.encoder=Tl.encoder,this.scores=h.of(we.of(0,0))}updateBoard(t){var n=this;return E(function*(){n.chosenCoord=h.empty(),n.state=n.getState(),n.scores=h.of(n.state.captures),n.tiles=n.state.tiles,n.board=n.getState().board})()}showHighlight(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}cancelMoveAttempt(){this.chosenCoord=h.empty(),this.possibleLandings=[]}showLastMove(t){var n=this;return E(function*(){t instanceof O2&&(n.lastStart=h.of(t.getStart()),n.lastEnd=h.of(t.getEnd()))})()}hideLastMove(){this.lastStart=h.empty(),this.lastEnd=h.empty()}onClick(t,n){var i=this;return E(function*(){const o=yield i.canUserPlay("#click_"+t+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new _(t,n),a=i.state.getCurrentPlayer();return i.chosenCoord.equalsValue(s)?(i.cancelMoveAttempt(),A.SUCCESS):i.chosenCoord.isAbsent()||i.state.getPieceAt(s).is(a)?i.firstClick(s):i.secondClick(s)})()}firstClick(t){var n=this;return E(function*(){const i=n.state.getPieceAt(t);if(i.is(n.state.getCurrentOpponent())){const o=Ol.of(t);return n.chooseMove(o)}return i.is(n.state.getCurrentPlayer())?(n.chosenCoord=h.of(t),n.showHighlight(),A.SUCCESS):n.cancelMove(pd.FIRST_CLICK_SHOULD_NOT_BE_NULL())})()}secondClick(t){var n=this;return E(function*(){if(n.possibleLandings.some(i=>i.equals(t))){const i=O2.of(n.chosenCoord.get(),t);return n.chooseMove(i)}return n.cancelMove(pd.INVALID_DISTANCE())})()}isPyramid(t,n){return this.board[n][t].isPlayer()||this.wasOpponent(t,n)}wasOpponent(t,n){const i=this.node.parent;if(i.isPresent()){const o=i.get().gameState.getCurrentOpponent();return i.get().gameState.getPieceAtXY(t,n).is(o)}return!1}getPyramidClass(t,n){const i=this.board[n][t];return i.isPlayer()?this.getPlayerClass(i.getPlayer()):"captured-fill"}mustDraw(t,n){return this.board[n][t]!==Ee.UNREACHABLE||this.wasRemoved(t,n)}wasRemoved(t,n){const o=this.node.parent;if(this.board[n][t]===Ee.UNREACHABLE&&o.isPresent()){const s=o.get().gameState.getPieceAtXY(t,n);return s===Ee.EMPTY||s.is(o.get().gameState.getCurrentPlayer())}return!1}getSpaceClass(t,n){return this.wasRemoved(t,n)?"captured-alternate-fill":(t+n)%2==1?"background":"background2"}getTilesCountCoordinate(){return"-15, -40, 35, -40, 60, 10, 35, 60, -15, 60, -40, 10, -15, -40"}mustShowTilesOf(t){return this.tiles.get(t)>0||this.lastTurnWasTilesExchange(t)}lastTurnWasTilesExchange(t){return!this.node.parent.isAbsent()&&this.getPreviousState().tiles.get(t)>this.tiles.get(t)}getIndicatorY(t){const n=this.INDICATOR_SIZE/2,i=this.SPACE_SIZE/2;return(t.x+t.y)%2==0?n+i:n+i-30}getTriangleInHexTranslation(t,n){const i=this.getTriangleTranslationCoord(t,n),o=i.x+2*Math.floor(t/3)*this.STROKE_WIDTH;let s=i.y;return Math.floor(t/3)%2==0?s+=2*Math.floor(n/2)*this.STROKE_WIDTH:(s+=2*Math.abs(Math.floor((n-1)/2))*this.STROKE_WIDTH,s+=this.STROKE_WIDTH),"translate("+o+", "+s+")"}getTilesCountTranslation(t){let n,i;return t===O.ZERO?(n=-.05,i=-.1):(n=7.5,i=9.45),n*=this.SPACE_SIZE,i*=this.SPACE_SIZE,"translate("+n+", "+i+")"}getViewBox(){const s=this.STROKE_WIDTH/2;return new Ys(0,0,8.5*this.SPACE_SIZE+2*this.STROKE_WIDTH,10.5*this.SPACE_SIZE+2*this.STROKE_WIDTH).expand(s,s,s,s)}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-coerceo"]],features:[We],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base normal-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","normal-stroke",3,"id","ngClass"],["class","base small-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"id","ngClass"],[1,"base","no-fill","normal-stroke","selected-stroke",3,"id"],["class","base-no-fill indicator clickable-fill",3,"click",4,"ngFor","ngForOf"],[1,"base-no-fill","indicator","clickable-fill",3,"click"],["class","base no-fill normal-stroke last-move-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","normal-stroke","last-move-stroke",3,"id"],[3,"id",4,"ngIf"],[3,"id"],["stroke-linecap","round",3,"ngClass"],["id","playerZeroTilesCount","x","-5","y","5",1,"text-giant"]],template:function(n,i){if(1&n&&(N(),M(0,"svg",0),z(1,hRe,2,1,"g",1)(2,mRe,2,1,"g",1)(3,CRe,3,5,"g",2)(4,MRe,2,2,"ng-template",null,3,wn)(6,SRe,2,1,"g",1),P()),2&n){const o=Pn(5);w("viewBox",i.getViewBox().toSVGString()),m(),v("ngForOf",i.board),m(),v("ngForOf",i.board),m(),v("ngIf",i.chosenCoord.isPresent())("ngIfElse",o),m(3),v("ngForOf",i.Player.PLAYERS)}},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();var iu;let md=class extends wr{static#e=iu=this;static singleton=h.empty();static get(){return iu.singleton.isAbsent()&&(iu.singleton=h.of(new iu)),iu.singleton.get()}getInitialState(){const e=Ee.EMPTY,t=Ee.UNREACHABLE,n=Ee.ZERO,i=Ee.ONE;return new Ti([[t,t,t,t,t,t,n,e,n,t,t,t,t,t,t],[t,t,t,e,e,n,e,e,e,n,e,e,t,t,t],[e,i,e,i,e,e,n,e,n,e,e,i,e,i,e],[i,e,e,e,i,e,e,e,e,e,i,e,e,e,i],[e,i,e,i,e,e,e,e,e,e,e,i,e,i,e],[e,n,e,n,e,e,e,e,e,e,e,n,e,n,e],[n,e,e,e,n,e,e,e,e,e,n,e,e,e,n],[e,n,e,n,e,e,i,e,i,e,e,n,e,n,e],[t,t,t,e,e,i,e,e,e,i,e,e,t,t,t],[t,t,t,t,t,t,i,e,i,t,t,t,t,t,t]],0,we.of(0,0),we.of(0,0))}applyLegalMove(e,t,n,i){return Tl.isTileExchange(e)?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}applyLegalTileExchange(e,t){const n=t.getCopiedBoard(),i=e.coord;n[i.y][i.x]=Ee.EMPTY;const o=t.getCurrentPlayer(),s=t.captures.getCopy();s.add(o,1);const a=t.tiles.getCopy();a.add(o,-2);const l=new Ti(n,t.turn,a,s).removeTilesIfNeeded(i,!1);return new Ti(l.getCopiedBoard(),l.turn+1,l.tiles,l.captures)}applyLegalMovement(e,t){const o=t.applyLegalMovement(e).removeTilesIfNeeded(e.getStart(),!0).doMovementCaptures(e);return new Ti(o.board,t.turn+1,o.tiles,o.captures)}isLegal(e,t){return Tl.isTileExchange(e)?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}isLegalTileExchange(e,t){if(t.tiles.get(t.getCurrentPlayer())<2)return A.failure(pd.NOT_ENOUGH_TILES_TO_EXCHANGE());const n=t.getPieceAt(e.coord);return n===Ee.UNREACHABLE||n===Ee.EMPTY?A.failure(pd.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?A.failure(Me.CANNOT_SELF_CAPTURE()):A.SUCCESS}isLegalMovement(e,t){L.assert(t.getPieceAt(e.getStart())!==Ee.UNREACHABLE,"Cannot start with a coord outside the board "+e.getStart().toString()+"."),L.assert(t.getPieceAt(e.getEnd())!==Ee.UNREACHABLE,"Cannot end with a coord outside the board "+e.getEnd().toString()+".");const n=t.getPieceAt(e.getStart());return n===Ee.EMPTY?A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n.is(t.getCurrentOpponent())?A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):t.getPieceAt(e.getEnd()).is(t.getCurrentPlayer())?A.failure(Me.MUST_LAND_ON_EMPTY_SPACE()):A.SUCCESS}getGameStatus(e){const t=e.gameState;return 18<=t.captures.get(O.ZERO)?ve.ZERO_WON:18<=t.captures.get(O.ONE)?ve.ONE_WON:ve.ONGOING}};md=iu=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],md);const ee=Ee.EMPTY,k=Ee.UNREACHABLE,r1=Ee.ZERO,Sn=Ee.ONE;class ARe extends Bn{tutorial=[q.informational($localize`Board and goal of the game`,$localize`Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.
         The triangles are the spaces on which pieces move during the game.
         The tiles can be removed from the board (you will see how later).
         The dark pieces belong to the first player and can only move on the dark spaces,
         while the light pieces belong to the second player and can only move on the light spaces.
         The goal of the game is to capture all of the opponent's pieces.`,md.get().getInitialState()),q.anyMove($localize`Move`,$localize`To move a piece, you need to:
        <ol>
          <li>Click on one of your pieces.</li>
          <li>Click on one of the triangular space highlighted in yellow.</li>
        </ol>
        You can pass through the opponent's pieces.<br/><br/>
        You're playing first, hence you're playing Dark.
        Perform any move.`,md.get().getInitialState(),O2.of(new _(3,5),new _(5,5)),$localize`Congratulations! Let's see captures now.`),q.fromMove($localize`Captures`,$localize`Every piece has three neighboring triangular spaces (2 on the sides).
        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!
        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>
        You're playing Light, make a capture.`,new Ti([[k,k,k,k,k,k,r1,ee,r1,k,k,k,k,k,k],[k,k,k,r1,ee,ee,ee,ee,ee,r1,ee,ee,k,k,k],[ee,Sn,ee,Sn,r1,Sn,ee,ee,r1,ee,ee,Sn,ee,Sn,ee],[Sn,ee,ee,ee,ee,ee,ee,ee,ee,ee,Sn,ee,ee,ee,Sn],[ee,Sn,ee,Sn,ee,ee,ee,ee,ee,ee,ee,Sn,ee,Sn,ee],[ee,r1,ee,r1,ee,ee,ee,ee,ee,ee,ee,r1,ee,r1,ee],[r1,ee,ee,ee,r1,ee,ee,ee,ee,ee,r1,ee,ee,ee,r1],[ee,r1,ee,r1,ee,ee,Sn,ee,Sn,ee,ee,r1,ee,r1,ee],[k,k,k,ee,ee,Sn,ee,ee,ee,Sn,ee,ee,k,k,k],[k,k,k,k,k,k,Sn,ee,Sn,k,k,k,k,k,k]],3,we.of(0,0),we.of(0,0)),[O2.of(new _(5,2),new _(4,1)),O2.of(new _(3,4),new _(4,3))],pe.CONGRATULATIONS(),$localize`Failed, you have not captured any piece.`),q.fromMove($localize`Gain a tile`,$localize`When a tile is empty, it can become removable from the board.
        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.
        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.
        For example, here, the topmost dark piece will not disconnect its tile when leaving it.
        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>
        You're playing Dark, perform a move that lets you gain two tiles.`,new Ti([[k,k,k,k,k,k,ee,ee,ee,k,k,k,k,k,k],[k,k,k,k,k,k,Sn,ee,ee,k,k,k,k,k,k],[ee,ee,ee,k,k,k,ee,ee,ee,k,k,k,k,k,k],[ee,ee,Sn,ee,ee,ee,ee,r1,ee,k,k,k,k,k,k],[ee,ee,ee,Sn,ee,ee,ee,ee,ee,k,k,k,k,k,k],[ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,r1,k,k,k],[ee,ee,r1,ee,ee,Sn,ee,ee,ee,ee,r1,ee,ee,ee,r1],[ee,ee,ee,ee,ee,ee,Sn,ee,Sn,ee,ee,r1,ee,r1,ee],[k,k,k,ee,ee,Sn,ee,ee,ee,Sn,ee,ee,k,k,k],[k,k,k,k,k,k,Sn,ee,Sn,k,k,k,k,k,k]],2,we.of(0,0),we.of(0,0)),[O2.of(new _(2,6),new _(4,6)),O2.of(new _(2,6),new _(3,5)),O2.of(new _(2,6),new _(3,7))],pe.CONGRATULATIONS(),$localize`Failed, you have not gained the two tiles that you could, try again!`),q.fromMove($localize`Exchanging a tile`,$localize`When you have a tile, you can see it on the left of the board.
        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.
        This will cost you two tiles.
        If any tiles are removed during that turn, nobody will get them.<br/><br/>
        You're playing Light, gain some time and capture the last piece to win directly!`,new Ti([[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,ee,ee,r1,k,k,k,k,k,k,k,k,k],[k,k,k,ee,ee,ee,ee,ee,ee,k,k,k,k,k,k],[k,k,k,ee,ee,ee,Sn,ee,Sn,k,k,k,k,k,k],[k,k,k,ee,ee,Sn,ee,ee,ee,k,k,k,k,k,k],[k,k,k,k,k,k,Sn,ee,Sn,k,k,k,k,k,k]],1,we.of(0,2),we.of(0,0)),[Ol.of(new _(5,5))],pe.CONGRATULATIONS(),$localize`It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!`),q.fromMove($localize`Special capture`,$localize`When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!
        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>
        A move that demonstrates both of these things can be done on this board by Light. Try it!`,new Ti([[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,ee,ee,r1,k,k,k,k,k,k],[k,k,k,ee,ee,r1,ee,ee,ee,k,k,k,k,k,k],[k,k,k,ee,r1,Sn,ee,Sn,ee,k,k,k,k,k,k],[k,k,k,ee,Sn,r1,ee,ee,ee,k,k,k,k,k,k],[k,k,k,ee,ee,Sn,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k]],1,we.of(0,0),we.of(0,0)),[O2.of(new _(7,6),new _(6,5)),O2.of(new _(7,6),new _(8,5))],$localize`Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.
        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space.`,pe.FAILED_TRY_AGAIN())]}class ZQ extends Yn{getListMoves(e,t){return e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState)}getListMovesDrop(e){const t=[],n=y1.CENTRAL_ZONE_TOP_LEFT,i=y1.CENTRAL_ZONE_BOTTOM_RIGHT;for(let o=n.y;o<=i.y;o++)for(let s=n.x;s<=i.x;s++)e.getPieceAtXY(s,o)===B.NONE&&t.push(El.of(new _(s,o)));return t}getListMovesAfterDrop(e){let t=[];const n=e.getCurrentPlayer();for(const i of e.getCoordsAndContents())i.content===n&&(t=t.concat(this.getListSimpleMoves(e,i.coord)),t=t.concat(this.getListJumps(e,i.coord)));return t}getListSimpleMoves(e,t){const n=[],i=[new _(t.x+1,t.y),new _(t.x-1,t.y),new _(t.x,t.y+1),new _(t.x,t.y-1),new _(t.x+1,t.y+1),new _(t.x+1,t.y-1),new _(t.x-1,t.y+1),new _(t.x-1,t.y-1)].filter(o=>e.isOnBoard(o));for(const o of i){const s=Pl.from(t,o);s.isSuccess()&&Ho.get().simpleMoveLegality(s.get(),e).isSuccess()&&n.push(s.get())}return n}getListJumps(e,t){const n=new ct;for(const i of Ho.get().jumpTargetsFrom(e,t)){const o=Ua.from([t,i]).get();Ho.get().jumpLegality(o,e).isSuccess()&&(n.add(o),n.addAll(this.getListJumpStartingFrom(e,o)))}return n.toList()}getListJumpStartingFrom(e,t){const n=Ho.get().nextJumps(t,e),i=new ct(n);for(const o of n)i.addAll(this.getListJumpStartingFrom(e,o));return i}}class bRe extends or{getMetrics(e,t){const n=e.gameState,i=U1.of([0,0],[0,0]);for(const a of n.getCoordsAndContents()){const c=a.coord,l=a.content;if(l.isPlayer())if(n.isShelter(c))i.add(l,0,1);else{let u=n.getWidth()+n.getHeight();for(const f of y1.ALL_SHELTERS)if(n.getPieceAt(f)===B.NONE){const g=c.getOrthogonalDistance(f);u=Math.min(u,g)}i.add(l,1,-u)}}return i}}class wRe extends ZQ{getListMoves(e,t){return this.sortByNumberOfJumps(super.getListMoves(e,t))}sortByNumberOfJumps(e){return e.sort((t,n)=>{const i=Oi.isDrop(t)?1:Oi.isSimple(t)?2:t.coords.length;return(Oi.isDrop(n)?1:Oi.isSimple(n)?2:n.coords.length)-i})}}class NRe extends cn{constructor(){super($localize`Jump`,Ho.get(),new bRe,new wRe)}}function IRe(r,e){if(1&r){const t=de();N(),M(0,"rect",9),W("click",function(){te(t);const i=p().$implicit;return ne(p(2).onClick(i.coord))}),P()}if(2&r){const t=p().$implicit,n=p(2);w("x",1.5*n.STROKE_WIDTH+n.SPACE_SIZE*t.coord.x+n.STROKE_WIDTH)("y",1.5*n.STROKE_WIDTH+n.SPACE_SIZE*t.coord.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE-3*n.STROKE_WIDTH)("height",n.SPACE_SIZE-3*n.STROKE_WIDTH)}}function kRe(r,e){if(1&r){const t=de();N(),M(0,"circle",6),W("click",function(){te(t);const i=p().$implicit;return ne(p(2).onClick(i.coord))}),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();Ce("id","piece_",n,"_",o,""),v("ngClass",i.pieceClasses),w("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE*n+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*o+s.STROKE_WIDTH+s.SPACE_SIZE/2)}}function RRe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"rect",6),W("click",function(){const o=te(t).$implicit;return ne(p(2).onClick(o.coord))}),P(),z(2,IRe,1,4,"rect",7)(3,kRe,1,6,"circle",8),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();m(),Ce("id","click_",n,"_",i,""),v("ngClass",t.squareClasses),w("x",o.SPACE_SIZE*n+o.STROKE_WIDTH)("y",o.SPACE_SIZE*i+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),m(),v("ngIf",t.isShelter),m(),v("ngIf",t.hasPieceToDraw)}}function xRe(r,e){if(1&r&&(N(),M(0,"g"),z(1,RRe,4,9,"g",1),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function LRe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"rect",10),W("click",function(){const o=te(t).$implicit;return ne(p().onClick(o))}),P()()}if(2&r){const t=e.$implicit,n=p();m(),v("ngClass",n.viewInfo.boardInfo[t.y][t.x].shelterClasses),w("x",n.SPACE_SIZE*t.x+2.5*n.STROKE_WIDTH)("y",n.SPACE_SIZE*t.y+2.5*n.STROKE_WIDTH)("width",n.SPACE_SIZE-3*n.STROKE_WIDTH)("height",n.SPACE_SIZE-3*n.STROKE_WIDTH)}}function zRe(r,e){if(1&r&&(N(),V(0,"circle",11)),2&r){const t=e.$implicit,n=p();En("id","sidePiece_0_",t,""),w("cx",-n.PIECE_RADIUS)("cy",1670-t*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function DRe(r,e){if(1&r&&(N(),V(0,"circle",12)),2&r){const t=e.$implicit,n=p();En("id","sidePiece_1_",t,""),w("cx",1715+n.PIECE_RADIUS)("cy",1670-t*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function VRe(r,e){if(1&r&&(N(),V(0,"rect",13)),2&r){const t=p();w("x",t.SPACE_SIZE*t.CENTRAL_ZONE_START.x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.CENTRAL_ZONE_START.y+t.STROKE_WIDTH)("width",t.CENTRAL_ZONE_SIZE.x*t.SPACE_SIZE)("height",t.CENTRAL_ZONE_SIZE.y*t.SPACE_SIZE)}}let HRe=(()=>{class r extends $c{PIECE_RADIUS;ALL_SHELTERS=y1.ALL_SHELTERS;CENTRAL_ZONE_START=y1.CENTRAL_ZONE_TOP_LEFT;CENTRAL_ZONE_SIZE=new $t(y1.CENTRAL_ZONE_BOTTOM_RIGHT.x-y1.CENTRAL_ZONE_TOP_LEFT.x+1,y1.CENTRAL_ZONE_BOTTOM_RIGHT.y-y1.CENTRAL_ZONE_TOP_LEFT.y+1);viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:we.of(20,20)};selected=h.empty();jumpInConstruction=h.empty();constructor(t){super(t),this.setRulesAndNode("Conspirateurs"),this.availableAIs=[new NRe,new kn($localize`MCTS`,new ZQ,this.rules)],this.encoder=Oi.encoder,this.PIECE_RADIUS=this.SPACE_SIZE/2-this.STROKE_WIDTH}updateBoard(t){var n=this;return E(function*(){n.updateViewInfo()})()}updateViewInfo(){const t=this.getState();this.viewInfo.dropPhase=t.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(let n=0;n<t.getHeight();n++){this.viewInfo.boardInfo.push([]);for(let i=0;i<t.getWidth();i++){const o=new _(i,n),s=t.getPieceAt(o),a={coord:o,squareClasses:[],shelterClasses:["no-fill"],pieceClasses:[this.getPlayerClass(s)],hasPieceToDraw:s.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[n].push(a)}}this.viewInfo.sidePieces=t.getSidePieces(),this.updateSelected(),this.updateShelterHighlights()}updateSelected(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){const t=this.jumpInConstruction.get(),n=t.getStartingCoord(),i=t.getEndingCoord();this.viewInfo.boardInfo[n.y][n.x].hasPieceToDraw=!1,this.viewInfo.boardInfo[i.y][i.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected-stroke"],this.viewInfo.boardInfo[i.y][i.x].hasPieceToDraw=!0;for(const o of t.coords)this.viewInfo.boardInfo[o.y][o.x].squareClasses.push("moved-fill")}else{const t=this.selected.get();this.viewInfo.boardInfo[t.y][t.x].pieceClasses.push("selected-stroke")}}updateShelterHighlights(){const t=this.getState(),n=Ho.get().getGameStatus(this.node),i=!0===n.isEndGame;for(const o of y1.ALL_SHELTERS){const s=this.viewInfo.boardInfo[o.y][o.x],a=t.getPieceAt(o),c=!1===i&&a.isPlayer();(i&&a===n.winner||c)&&(s.shelterClasses.push("selectable-stroke"),s.pieceClasses.push("victory-stroke"),s.squareClasses.push("victory-fill"))}}showLastMove(t){var n=this;return E(function*(){if(Oi.isDrop(t))n.viewInfo.boardInfo[t.coord.y][t.coord.x].squareClasses.push("moved-fill");else if(Oi.isSimple(t))n.viewInfo.boardInfo[t.getStart().y][t.getStart().x].squareClasses.push("moved-fill"),n.viewInfo.boardInfo[t.getEnd().y][t.getEnd().x].squareClasses.push("moved-fill");else{n.viewInfo.lastMoveArrow="";for(const i of t.coords)n.viewInfo.boardInfo[i.y][i.x].squareClasses.push("moved-fill"),n.viewInfo.lastMoveArrow+=i.x*n.SPACE_SIZE+n.SPACE_SIZE/2+n.STROKE_WIDTH,n.viewInfo.lastMoveArrow+=" ",n.viewInfo.lastMoveArrow+=i.y*n.SPACE_SIZE+n.SPACE_SIZE/2+n.STROKE_WIDTH,n.viewInfo.lastMoveArrow+=" "}})()}hideLastMove(){}cancelMoveAttempt(){var t=this;return E(function*(){t.jumpInConstruction=h.empty(),t.selected=h.empty(),yield t.updateBoard(!1)})()}onClick(t){var n=this;return E(function*(){const i=yield n.canUserPlay("#click_"+t.x+"_"+t.y);if(i.isFailure())return n.cancelMove(i.getReason());const o=n.getState(),s=o.getPieceAt(t);if(o.getPieceAt(t)===n.getCurrentPlayer())return n.selected.equalsValue(t)?yield n.cancelMoveAttempt():(n.selected=h.of(t),n.jumpInConstruction=h.empty()),n.updateViewInfo(),A.SUCCESS;if(n.jumpInConstruction.isPresent())return n.constructJump(t);if(n.selected.isPresent())return n.selectNextCoord(t);if(o.isDropPhase()){const a=El.of(t);return n.chooseMove(a)}return n.cancelMove(s===B.NONE?Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY():Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())})()}constructJump(t){var n=this;return E(function*(){const i=n.jumpInConstruction.get(),o=n.getState();if(t.equals(i.getEndingCoord()))return n.chooseMove(i);{const s=i.addJump(t);if(s.isFailure())return n.cancelMove(s.getReason());const a=n.rules.jumpLegality(s.get(),o);return a.isFailure()?n.cancelMove(a.getReason()):n.updateJump(s.get())}})()}updateJump(t){var n=this;return E(function*(){const i=n.getState();return n.rules.jumpHasPossibleNextTargets(t,i)?(n.jumpInConstruction=h.of(t),n.updateViewInfo(),A.SUCCESS):n.chooseMove(t)})()}selectNextCoord(t){var n=this;return E(function*(){const i=n.selected.get(),o=Pl.from(i,t);if(o.isSuccess())return n.chooseMove(o.get());{const s=Ua.from([i,t]);return s.isFailure()?n.cancelMove(s.getReason()):n.updateJump(s.get())}})()}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-conspirateurs"]],features:[We],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1-fill",3,"id",4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke big-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0-fill",3,"id"],[1,"base","mid-stroke","player1-fill",3,"id"],[1,"base","no-fill","selectable-stroke","big-stroke"]],template:function(n,i){1&n&&(N(),M(0,"svg",0),z(1,xRe,2,1,"g",1)(2,LRe,2,5,"g",1)(3,zRe,1,4,"circle",2)(4,DRe,1,4,"circle",3)(5,VRe,1,4,"rect",4),V(6,"polyline",5),P()),2&n&&(m(),v("ngForOf",i.viewInfo.boardInfo),m(),v("ngForOf",i.ALL_SHELTERS),m(),v("ngForOf",i.ArrayUtils.range(i.viewInfo.sidePieces.get(i.Player.ZERO))),m(),v("ngForOf",i.ArrayUtils.range(i.viewInfo.sidePieces.get(i.Player.ONE))),m(),v("ngIf",i.viewInfo.dropPhase),m(),w("points",i.viewInfo.lastMoveArrow))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})(),a0=(()=>class r{static CANNOT_MOVE_WITH_BALL=()=>$localize`You cannot move the piece holding the ball.`;static MUST_MOVE_BY_ONE_ORTHOGONAL_SPACE=()=>$localize`You must move by exactly one orthogonal space.`;static PASS_PATH_OBSTRUCTED=()=>$localize`The path of this pass is obstructed.`;static PASS_MUST_BE_IN_STRAIGHT_LINE=()=>$localize`A pass must be done in a straight line, orthogonally or diagonally.`;static CAN_ONLY_DO_ONE_PASS=()=>$localize`You can only perform one pass per turn.`;static CAN_ONLY_TRANSLATE_TWICE=()=>$localize`You can only perform two translations per turn, not three.`;static CANNOT_PASS_TO_OPPONENT=()=>$localize`You cannot pass the ball to the opponent. You must pick one of your pieces.`})();class Fo extends Do{static encoder=q2.getFallibleEncoder(Fo.from);static from(e,t){return me.factory.fromMove(e,t).isFailure()?X.failure(a0.PASS_MUST_BE_IN_STRAIGHT_LINE()):X.success(new Fo(e,t))}constructor(e,t){super(e,t)}equals(e){return e instanceof Fo&&super.equals(e)}}class j2 extends Do{static encoder=q2.getFallibleEncoder(j2.from);static from(e,t){return e.getVectorToward(t).isSingleOrthogonalStep()?X.success(new j2(e,t)):X.failure(a0.MUST_MOVE_BY_ONE_ORTHOGONAL_SPACE())}constructor(e,t){super(e,t)}equals(e){return e instanceof j2&&super.equals(e)}}function II(r){return r instanceof j2}function FRe(r){return r instanceof Fo}class Z2 extends C2{first;second;third;static subMoveEncoder=ke.disjunction([II,FRe],[j2.encoder,Fo.encoder]);static subMoveOptionalEncoder=h.getEncoder(Z2.subMoveEncoder);static encoder=ke.tuple([Z2.subMoveEncoder,Z2.subMoveOptionalEncoder,Z2.subMoveOptionalEncoder],e=>[e.first,e.second,e.third],e=>new Z2(e[0],e[1],e[2]));static countPassesAndTranslations(e,t){e instanceof Fo?t.passes++:t.translations++}constructor(e,t,n){super(),this.first=e,this.second=t,this.third=n,n.isPresent()&&L.assert(t.isPresent(),"DiaballikMove should have two first actions to have a third one");const i={passes:0,translations:0};Z2.countPassesAndTranslations(e,i),t.isPresent()&&Z2.countPassesAndTranslations(t.get(),i),n.isPresent()&&Z2.countPassesAndTranslations(n.get(),i),L.assert(i.passes<=1,"DiaballikMove should have at most one pass"),L.assert(i.translations<=2,"DiaballikMove should have at most two translations")}toString(){return`DiaballikMove(${this.first.toString()}, ${this.second.toString()}, ${this.third.toString()})`}equals(e){return!(!1===this.first.equals(e.first)||!1===this.second.equals(e.second)||!1===this.third.equals(e.third))}getSubMoves(){const e=[this.first];return this.second.isPresent()&&e.push(this.second.get()),this.third.isPresent()&&e.push(this.third.get()),e}}class Zi{owner;holdsBall;static NONE=new Zi(B.NONE,!1);static ZERO=new Zi(O.ZERO,!1);static ZERO_WITH_BALL=new Zi(O.ZERO,!0);static ONE=new Zi(O.ONE,!1);static ONE_WITH_BALL=new Zi(O.ONE,!0);constructor(e,t){this.owner=e,this.holdsBall=t}equals(e){return this===e}}class ou extends $1{equals(e){return it.compare(this.board,e.board)}}class YQ{winner;constructor(e){this.winner=e}}class kI extends YQ{coord;constructor(e,t){super(e),this.coord=t}}class KQ extends YQ{allLoserPieces;opponentPiecesInContact;constructor(e,t,n){super(e.getOpponent()),this.allLoserPieces=t,this.opponentPiecesInContact=n}}class Cs extends wr{static singleton=h.empty();static get(){return Cs.singleton.isAbsent()&&(Cs.singleton=h.of(new Cs)),Cs.singleton.get()}getInitialState(){const e=Zi.ZERO,n=Zi.ONE,o=Zi.NONE;return new ou([[n,n,n,Zi.ONE_WITH_BALL,n,n,n],[o,o,o,o,o,o,o],[o,o,o,o,o,o,o],[o,o,o,o,o,o,o],[o,o,o,o,o,o,o],[o,o,o,o,o,o,o],[e,e,e,Zi.ZERO_WITH_BALL,e,e,e]],0)}isLegal(e,t){let n=t;for(const i of e.getSubMoves()){const o=i.getStart();if(!1===t.isOnBoard(o))return X.failure(go.OUT_OF_RANGE(o));const s=i.getEnd();if(!1===t.isOnBoard(s))return X.failure(go.OUT_OF_RANGE(s));const a=this.isLegalSubMove(n,i);if(a.isFailure())return a;n=a.get()}return X.success(n)}isLegalSubMove(e,t){return t instanceof j2?this.isLegalTranslation(e,t):this.isLegalPass(e,t)}isLegalTranslation(e,t){const n=t.getStart(),i=e.getPieceAt(n);if(i.owner===B.NONE)return X.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i.owner===e.getCurrentOpponent())return X.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(!0===i.holdsBall)return X.failure(a0.CANNOT_MOVE_WITH_BALL());const o=t.getEnd();if(e.getPieceAt(o).owner.isPlayer())return X.failure(Me.MUST_LAND_ON_EMPTY_SPACE());const s=e.getCopiedBoard();s[n.y][n.x]=Zi.NONE,s[o.y][o.x]=i;const a=new ou(s,e.turn);return X.success(a)}isLegalPass(e,t){const n=t.getStart(),i=e.getPieceAt(n);if(i.owner===B.NONE)return X.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i.owner===e.getCurrentOpponent())return X.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());L.assert(i.holdsBall,"DiaballikRules: cannot pass without the ball");const o=t.getEnd(),s=e.getPieceAt(o);if(s.owner===B.NONE)return X.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s.owner===e.getCurrentOpponent())return X.failure(a0.CANNOT_PASS_TO_OPPONENT());const a=me.factory.fromMove(n,o).get();for(let g=n.getNext(a);!1===g.equals(o);g=g.getNext(a))if(e.getPieceAt(g)!==Zi.NONE)return X.failure(a0.PASS_PATH_OBSTRUCTED());const l=e.getCopiedBoard(),u=l[n.y][n.x];return l[n.y][n.x]=l[o.y][o.x],l[o.y][o.x]=u,X.success(new ou(l,e.turn))}applyLegalMove(e,t,n,i){return new ou(i.board,t.turn+1)}getGameStatus(e){const n=this.getVictoryOrDefeatCoords(e.gameState);return n.isPresent()?ve.getVictory(n.get().winner):ve.ONGOING}getVictoryOrDefeatCoords(e){const t=this.getBallCoordInRow(e,0,O.ZERO);if(t.isPresent())return h.of(new kI(O.ZERO,t.get()));const n=this.getBallCoordInRow(e,e.getHeight()-1,O.ONE);return n.isPresent()?h.of(new kI(O.ONE,n.get())):this.getBlockerAndCoords(e)}getBallCoordInRow(e,t,n){for(let i=0;i<e.getHeight();i++){const o=e.getPieceAtXY(i,t);if(!0===o.holdsBall&&o.owner===n)return h.of(new _(i,t))}return h.empty()}getBlockerAndCoords(e){const t=J3.ofValues(this.getBlockerCoords(e,O.ZERO),this.getBlockerCoords(e,O.ONE));return t.get(O.ZERO).isPresent()&&t.get(O.ONE).isPresent()?t.get(e.getCurrentPlayer()):t.get(O.ZERO).isPresent()?t.get(O.ZERO):t.get(O.ONE).isPresent()?t.get(O.ONE):h.empty()}getBlockerCoords(e,t){const n=new ct,i=[];for(let o=0;o<e.getWidth();o++){const s=this.getConnectedPieceCoord(o,n,e,t);if(!s.isPresent())return h.empty();i.push(s.get())}return n.size()>=3?h.of(new KQ(t,i,n.toList())):h.empty()}getConnectedPieceCoord(e,t,n,i){for(let o=0;o<n.getHeight();o++){const s=new _(e,o);if(n.getPieceAt(s).owner===i)return this.isConnectedOnTheLeft(s,n,i)?(this.addConnectedOpponents(s,t,n,i),h.of(s)):h.empty()}return h.empty()}isConnectedOnTheLeft(e,t,n){if(0===e.x)return!0;for(const i of[me.LEFT,me.UP_LEFT,me.DOWN_LEFT]){const o=e.getNext(i);if(t.isOnBoard(o)&&t.getPieceAt(o).owner===n)return!0}return!1}addConnectedOpponents(e,t,n,i){for(const o of Ie.factory.all){const s=e.getNext(o);n.isOnBoard(s)&&n.getPieceAt(s).owner===i.getOpponent()&&t.add(s)}}}class URe extends or{getMetrics(e,t){const n=e.gameState,i=new U1;for(const o of n.getCoordsAndContents()){const s=o.content;s.holdsBall&&(s.owner===O.ZERO?i.set(O.ZERO,[n.getHeight()-1-o.coord.y]):i.set(O.ONE,[o.coord.y]))}return i}}class XQ extends cn{constructor(e,t){super(e,Cs.get(),new URe,t)}}class su{subMoves;stateBefore;stateAfterSubMoves;hasPass;translations;static finalize(e){return e.finalize()}constructor(e,t,n){this.subMoves=e,this.stateBefore=t,this.stateAfterSubMoves=n,L.assert(this.subMoves.length<=3,"DiaballikMoveInConstruction can have at most 3 submoves");let i=!1,o=0;for(const s of e)s instanceof Fo?(L.assert(!1===i,"DiaballikMoveInConstruction can have at most one pass"),i=!0):(L.assert(o<2,"DiaballikMoveInConstruction can have at most two translations"),o++);this.hasPass=i,this.translations=o}equals(e){return yt.equals(this.subMoves,e.subMoves)}addIfLegal(e,t){const n=Cs.get().isLegalSubMove(this.stateAfterSubMoves,e);if(n.isSuccess()){const i=this.subMoves.concat([e]);this.sortIfNeeded(i);const o=new su(i,this.stateBefore,n.get());t.push(o)}}sortIfNeeded(e){const t=this.getFirstTranslationIndex(e);if(t.isAbsent())return;const n=t.get();if(n+1>=e.length||!1===II(e[n+1]))return;const i=e[n],o=new ct(i.getCoords()),s=e[n+1],a=new ct(s.getCoords());o.intersection(a).size()>0||i.getStart().compareTo(s.getStart())>0&&(e[n]=s,e[n+1]=i)}getFirstTranslationIndex(e){for(let t=0;t<e.length;t++)if(II(e[t]))return h.of(t);return h.empty()}getPassEnd(){for(const e of this.subMoves)if(e instanceof Fo)return h.of(e.getEnd());return h.empty()}passPathContains(e){for(const t of this.subMoves)if(t instanceof Fo)return t.getStart().getCoordsToward(t.getEnd()).some(i=>i.equals(e));return!1}getPreviousTranslation(){for(const e of this.subMoves)if(e instanceof j2)return h.of(e);return h.empty()}hasOppositeTranslation(e,t){if(this.translations>0){const n=this.getPreviousTranslation().get();return n.getStart().equals(t)&&n.getEnd().equals(e)}return!1}finalize(){L.assert(this.subMoves.length>0,"DiaballikMoveInConstruction can only be finalized if it contains something");const e=this.subMoves[0];let t=h.empty();this.subMoves.length>1&&(t=h.of(this.subMoves[1]));let n=h.empty();this.subMoves.length>2&&(n=h.of(this.subMoves[2]));const i=new Z2(e,t,n);return L.assert(Cs.get().isLegal(i,this.stateBefore).isSuccess(),"DiaballikMoveGenerator should only generate legal moves"),i}}class PC extends Yn{avoidDuplicates;constructor(e=!0){super(),this.avoidDuplicates=e}getListMoves(e,t){let i=[new su([],e.gameState,e.gameState)];const o=new ct;for(let s=0;s<3;s++){let a=[];for(const c of i){const l=this.addAllPossibleSubMoves(c);o.addAll(new ct(l.map(su.finalize))),a=a.concat(l)}i=a}return this.removeDuplicates(e.gameState,o,t)}removeDuplicates(e,t,n){if(!1===this.avoidDuplicates)return t.toList();const i=new ct,o=[],s=Cs.get();for(const a of t){const c=Cs.get().isLegal(a,e),l=s.applyLegalMove(a,e,n,c.get());!1===i.contains(l)&&(o.push(a),i.add(l))}return o}addAllPossibleSubMoves(e){const t=e.stateAfterSubMoves,n=t.getCurrentPlayer(),i=[];for(const o of t.getCoordsAndContents()){const s=o.coord,a=o.content;if(a.owner===n)if(a.holdsBall&&!1===e.hasPass)for(const c of this.getPassEnds(t,o.coord)){const l=Fo.from(s,c).get();e.addIfLegal(l,i)}else if(e.translations<2)for(const l of this.getTranslationEnds(t,o.coord))if(!1===e.hasOppositeTranslation(o.coord,l)||!1===this.avoidDuplicates){let f=!0;if(e.hasPass){const g=e.getPassEnd().equalsValue(s),y=e.passPathContains(l);f=g||y}if(f||!1===this.avoidDuplicates){const g=j2.from(s,l).get();e.addIfLegal(g,i)}}}return i}getPassEnds(e,t){const n=e.getCurrentPlayer(),i=[];for(const o of me.factory.all){let s=t.getNext(o);for(;e.isOnBoard(s);){const a=e.getPieceAt(s);if(a.owner===n){i.push(s);break}if(a.owner!==B.NONE)break;s=s.getNext(o)}}return i}getTranslationEnds(e,t){const n=[];for(const i of Ie.factory.all){const o=t.getNext(i);e.isOnBoard(o)&&e.getPieceAt(o).owner===B.NONE&&n.push(o)}return n}}class QQ{x1;y1;x2;y2;constructor(e,t,n,i){this.x1=e,this.y1=t,this.x2=n,this.y2=i}}class RI extends PC{moveLength;constructor(e,t=!0){super(t),this.moveLength=e,L.assert(1<=e&&e<=3,"Diaballik moves should be of length [1,3]")}getListMoves(e,t){let i=[new su([],e.gameState,e.gameState)];for(let o=0;o<this.moveLength;o++){let s=[];for(const a of i)s=s.concat(this.addAllPossibleSubMoves(a));i=s}return i.map(su.finalize)}}function $Re(r,e){if(1&r&&(N(),V(0,"circle",10)),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();Ce("id","piece_",n,"_",o,""),v("ngClass",s.getPieceClasses(n,o,i)),w("r",42)("cx",s.SPACE_SIZE/2)("cy",s.SPACE_SIZE/2)}}function GRe(r,e){if(1&r&&(N(),V(0,"circle",10)),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();Ce("id","ball_",n,"_",o,""),v("ngClass",s.getBallClasses(n,o,i)),w("r",22)("cx",s.SPACE_SIZE/2)("cy",s.SPACE_SIZE/2)}}function BRe(r,e){if(1&r){const t=de();N(),M(0,"g",9),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),V(1,"rect",10),z(2,$Re,1,6,"circle",11)(3,GRe,1,6,"circle",11),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();Ce("id","click_",n,"_",i,""),w("transform",o.getTranslationXY(n,i)),m(),Ce("id","space_",n,"_",i,""),v("ngClass",o.getSpaceClasses(n,i)),w("x",0)("y",0)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),m(),v("ngIf",t.owner.isPlayer()),m(),v("ngIf",t.holdsBall)}}function WRe(r,e){if(1&r&&(N(),M(0,"g"),z(1,BRe,4,12,"g",8),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function qRe(r,e){if(1&r&&(N(),V(0,"line",12)),2&r){const t=e.$implicit;w("x1",t.x1)("y1",t.y1)("x2",t.x2)("y2",t.y2)}}function jRe(r,e){if(1&r){const t=de();N(),M(0,"rect",13),W("click",function(){const o=te(t).$implicit;return ne(p().onClick(o.x,o.y))}),P()}if(2&r){const t=e.$implicit,n=p();Ce("id","indicator_",t.x,"_",t.y,""),w("transform",n.getTranslation(t))("x",n.SPACE_SIZE/2-n.INDICATOR_SIZE/2)("y",n.SPACE_SIZE/2-n.INDICATOR_SIZE/2)("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}function ZRe(r,e){if(1&r&&(N(),M(0,"g")(1,"g",14),V(2,"rect",15)(3,"circle",16)(4,"rect",15)(5,"line",17),M(6,"text",18),st(7),P()(),M(8,"g",19),V(9,"rect",15)(10,"circle",16)(11,"circle",16)(12,"rect",15)(13,"circle",16)(14,"line",17),M(15,"text",20),st(16),P()()()),2&r){const t=p();m(),w("transform",t.getTranslationXY(0,t.HEIGHT+.3)+" scale(0.5)"),m(),w("x",0)("y",0)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),m(),v("ngClass",t.getPlayerClass(t.getCurrentPlayer())),w("r",42)("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2),m(),w("x",t.SPACE_SIZE)("y",0)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),m(),w("x1",t.SPACE_SIZE/2)("y1",t.SPACE_SIZE/2)("x2",t.SPACE_SIZE+t.SPACE_SIZE/2)("y2",t.SPACE_SIZE/2),m(),w("x",2.3*t.SPACE_SIZE)("y",t.SPACE_SIZE/2)("font-size",t.SPACE_SIZE/2),m(),mn(t.translationsMade),m(),w("transform",t.getTranslationXY(t.WIDTH-1,t.HEIGHT+.3)+" scale(0.5)"),m(),w("x",0)("y",0)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),m(),v("ngClass",t.getPlayerClass(t.getCurrentPlayer())),w("r",42)("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2),m(),v("ngClass",t.getPlayerClass(t.getCurrentPlayer())),w("r",22)("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2),m(),w("x",t.SPACE_SIZE)("y",0)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),m(),v("ngClass",t.getPlayerClass(t.getCurrentPlayer())),w("r",42)("cx",t.SPACE_SIZE+t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2),m(),w("x1",t.SPACE_SIZE/2)("y1",t.SPACE_SIZE/2)("x2",t.SPACE_SIZE+t.SPACE_SIZE/2)("y2",t.SPACE_SIZE/2),m(),w("x",-.6*t.SPACE_SIZE)("y",t.SPACE_SIZE/2)("font-size",t.SPACE_SIZE/2),m(),mn(t.hasMadePass?1:0)}}function YRe(r,e){if(1&r){const t=de();N(),M(0,"g",21),W("click",function(){return te(t),ne(p().done())}),V(1,"circle",22)(2,"polygon",23),P()}if(2&r){const t=p();w("transform",t.getTranslationXY(t.WIDTH/2,t.HEIGHT+.5)),m(),w("cx",t.STROKE_WIDTH/2)("cy",t.STROKE_WIDTH/2)("r",t.SPACE_SIZE/2.5)}}let KRe=(()=>{class r extends y2{stateInConstruction;WIDTH;HEIGHT;INDICATOR_SIZE=20;victoryCoord=h.empty();loserCoords=[];blockedLines=[];indicators=[];currentSelection=h.empty();hasMadePass=!1;translationsMade=0;subMoves=[];highlightedBallCoords=[];highlightedPiecesCoords=[];moveGenerator=new PC(!1);constructor(t){super(t),this.setRulesAndNode("Diaballik"),this.hasAsymmetricBoard=!0,this.WIDTH=this.getState().getWidth(),this.HEIGHT=this.getState().getHeight(),this.encoder=Z2.encoder,this.availableAIs=[new XQ($localize`AllMoves`,new PC(!0)),new kn($localize`MCTS`,this.moveGenerator,this.rules),new kn($localize`MCTS (3 only)`,new RI(3,!1),this.rules),new kn($localize`MCTS (without dups)`,new PC(!0),this.rules),new kn($localize`MCTS (3, no dups)`,new RI(3,!1),this.rules)];for(let n=1;n<=3;n++)this.availableAIs.push(new XQ($localize`Distance (${n})`,new RI(n)))}updateBoard(t){var n=this;return E(function*(){const i=n.node.gameState;n.board=i.board,n.stateInConstruction=i;const o=n.rules.getVictoryOrDefeatCoords(i);if(n.victoryCoord=h.empty(),n.loserCoords=[],n.blockedLines=[],o.isPresent()){const s=o.get();if(s instanceof kI)n.victoryCoord=h.of(s.coord);else if(s instanceof KQ){n.loserCoords=s.allLoserPieces;const a=s.winner===O.ZERO?0:n.SPACE_SIZE;for(const c of s.opponentPiecesInContact){const l=c.x*n.SPACE_SIZE,u=c.y*n.SPACE_SIZE+a,f=new QQ(l,u,l+n.SPACE_SIZE,u);n.blockedLines.push(f)}}}})()}showLastMove(t){var n=this;return E(function*(){for(const i of t.getSubMoves())n.showSubMove(i)})()}showSubMove(t){t instanceof j2?this.highlightedPiecesCoords.push(t.getStart(),t.getEnd()):(L.assert(t instanceof Fo,"DiaballikMove can only be a translation or a pass"),this.highlightedBallCoords.push(t.getStart(),t.getEnd()))}hideLastMove(){this.highlightedPiecesCoords=[],this.highlightedBallCoords=[]}cancelMoveAttempt(){this.stateInConstruction=this.getState(),this.currentSelection=h.empty(),this.hasMadePass=!1,this.translationsMade=0,this.subMoves=[],this.indicators=[],this.highlightedPiecesCoords=[],this.highlightedBallCoords=[]}getSpaceClasses(t,n){const i=new _(t,n),o=[];return this.highlightedPiecesCoords.some(s=>s.equals(i))&&o.push("moved-fill"),this.highlightedBallCoords.some(s=>s.equals(i))&&o.push("moved-fill"),o}getPieceClasses(t,n,i){const o=new _(t,n),s=[this.getPlayerClass(i.owner)];return this.highlightedPiecesCoords.some(a=>a.equals(o))&&s.push("last-move-stroke"),!1===i.holdsBall&&this.currentSelection.equalsValue(new _(t,n))&&s.push("selected-stroke"),this.victoryCoord.equalsValue(o)&&s.push("victory-stroke"),this.loserCoords.some(a=>a.equals(o))&&s.push("defeat-stroke"),s}getBallClasses(t,n,i){const o=new _(t,n),s=[this.getPlayerClass(i.owner)];return this.highlightedBallCoords.some(a=>a.equals(o))&&s.push("last-move-stroke"),this.currentSelection.equalsValue(new _(t,n))&&s.push("selected-stroke"),s}addSubMove(t,n){var i=this;return E(function*(){if(i.currentSelection=h.empty(),i.indicators=[],i.subMoves.push(t),i.stateInConstruction=n,3===i.subMoves.length){const o=new Z2(i.subMoves[0],h.of(i.subMoves[1]),h.of(i.subMoves[2]));return i.chooseMove(o)}return i.showSubMove(t),A.SUCCESS})()}onClick(t,n){var i=this;return E(function*(){const o=yield i.canUserPlay("#click_"+t+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new _(t,n);return i.onLegalClick(s)})()}onLegalClick(t){const n=this.stateInConstruction.getPieceAt(t);if(0===this.subMoves.length&&this.hideLastMove(),this.currentSelection.isPresent()){const i=this.currentSelection.get();return i.equals(t)?(this.currentSelection=h.empty(),this.indicators=[],0===this.subMoves.length?this.cancelMove():A.SUCCESS):this.stateInConstruction.getPieceAt(i).holdsBall?this.performPass(i,t):this.performTranslation(i,t)}return n.owner===this.getCurrentPlayer()?this.hasMadePass&&n.holdsBall?this.cancelMove(a0.CAN_ONLY_DO_ONE_PASS()):2===this.translationsMade&&!1===n.holdsBall?this.cancelMove(a0.CAN_ONLY_TRANSLATE_TWICE()):(this.currentSelection=h.of(t),this.indicators=n.holdsBall?this.moveGenerator.getPassEnds(this.stateInConstruction,t):this.moveGenerator.getTranslationEnds(this.stateInConstruction,t),A.SUCCESS):this.cancelMove(n.owner===B.NONE?Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY():Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())}performPass(t,n){const i=Fo.from(t,n);if(i.isSuccess()){const o=this.rules.isLegalPass(this.stateInConstruction,i.get());return o.isSuccess()?(this.hasMadePass=!0,this.addSubMove(i.get(),o.get())):this.cancelMove(o.getReason())}return this.cancelMove(i.getReason())}performTranslation(t,n){const i=j2.from(t,n);if(i.isSuccess()){const o=this.rules.isLegalTranslation(this.stateInConstruction,i.get());return o.isSuccess()?(this.translationsMade++,this.addSubMove(i.get(),o.get())):this.cancelMove(o.getReason())}return this.cancelMove(i.getReason())}showDoneButton(){return this.interactive&&this.subMoves.length>=1}done(){var t=this;return E(function*(){const n=yield t.canUserPlay("#done");if(n.isFailure())return t.cancelMove(n.getReason());let i=h.empty();t.subMoves.length>=2&&(i=h.of(t.subMoves[1]));const o=new Z2(t.subMoves[0],i,h.empty());return t.chooseMove(o)})()}getBoardRotation(){return`rotate(${180*this.getPointOfView().getValue()} ${(this.getState().getWidth()*this.SPACE_SIZE+this.STROKE_WIDTH)/2} ${(this.getState().getHeight()*this.SPACE_SIZE+this.STROKE_WIDTH)/2})`}getViewBox(){return super.getViewBox().expand(0,0,this.SPACE_SIZE,this.SPACE_SIZE)}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-diaballik"]],features:[We],decls:10,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],[4,"ngFor","ngForOf"],["class","defeat-stroke normal-stroke",4,"ngFor","ngForOf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["id","done",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"defeat-stroke","normal-stroke"],[1,"indicator",3,"id","click"],["id","translationCountIndicator"],[1,"base"],[1,"base",3,"ngClass"],["marker-end","url(#arrowhead)",1,"arrow"],["id","translationCount",1,"base-no-stroke","text-giant"],["id","passCountIndicator"],["id","passCount",1,"base-no-stroke","text-giant"],["id","done",3,"click"],["fill","green",1,"base-no-fill","small-stroke"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","black",1,"base-no-fill","small-stroke"]],template:function(n,i){1&n&&(N(),M(0,"svg",0)(1,"defs")(2,"marker",1),V(3,"polygon",2),P()(),M(4,"g"),z(5,WRe,2,1,"g",3)(6,qRe,1,4,"line",4)(7,jRe,1,7,"rect",5),P(),z(8,ZRe,17,50,"g",6)(9,YRe,3,4,"g",7),P()),2&n&&(w("viewBox",i.getViewBox().toSVGString()),m(4),w("transform",i.getBoardRotation()),m(),v("ngForOf",i.stateInConstruction.board),m(),v("ngForOf",i.blockedLines),m(),v("ngForOf",i.indicators),m(),v("ngIf",i.isInteractive()),m(),v("ngIf",i.showDoneButton()))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const Qs=Zi.ZERO,JQ=Zi.ZERO_WITH_BALL,Js=Zi.ONE,eJ=Zi.ONE_WITH_BALL,lt=Zi.NONE;class XRe extends Bn{tutorial=[q.informational($localize`Goal of the game`,$localize`The goal of Diaballik is to bring your ball, represented by the small circle, into the home line of the opponent (i.e, its starting position). The ball is currently being held by your center piece.`,Cs.get().getInitialState()),q.fromMove($localize`Translations`,$localize`During a turn, you are allowed up to three actions, including at most two translations. A translation is an orthogonal step of any piece that does not hold the ball.<br/><br/>Move your leftmost piece by one step. Once you are done, click on the green button that will appear on the bottom right of the board to indicate that you are done with your turn.`,Cs.get().getInitialState(),[new Z2(j2.from(new _(0,6),new _(0,5)).get(),h.empty(),h.empty())],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),q.fromMove($localize`Pass`,$localize`Another action that you are allowed to do at most once per turn is a pass. You can pass the ball by clicking on the piece that holds the ball, then on another one of your piece that can receive it. A pass must be made in a straight line along an unobstructed path.<br/><br/>Here, playing Dark, you can make two moves and a pass to win the game, do it!`,new ou([[Js,Js,Js,eJ,lt,Js,Js],[lt,lt,lt,Qs,lt,lt,lt],[lt,lt,lt,lt,lt,lt,lt],[lt,lt,lt,lt,lt,lt,lt],[JQ,lt,lt,Js,lt,lt,lt],[lt,lt,lt,lt,lt,lt,lt],[lt,Qs,Qs,lt,Qs,Qs,Qs]],0),[new Z2(j2.from(new _(3,1),new _(4,1)).get(),h.of(j2.from(new _(4,1),new _(4,0)).get()),h.of(Fo.from(new _(0,4),new _(4,0)).get()))],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),q.fromMove($localize`Blocking the opponent`,$localize`There is a special anti-game rule. If a player forms a contiguous line, with one piece in each column, they block the opponent from reaching their home line. If the opponent is in contact with three pieces in this case, they win instantaneously.<br/><br/>Here, playing Light, your opponent is blocking you and you already have two pieces in contact with their line. If you can connect a third piece, you win. Do it!`,new ou([[Js,Js,Js,lt,lt,lt,lt],[Js,lt,lt,lt,lt,lt,eJ],[lt,lt,lt,lt,lt,lt,lt],[lt,lt,lt,lt,lt,lt,lt],[Qs,Js,lt,lt,lt,lt,lt],[lt,Qs,lt,Js,lt,lt,lt],[lt,lt,Qs,JQ,Qs,Qs,Qs]],1),[new Z2(j2.from(new _(0,1),new _(0,2)).get(),h.of(j2.from(new _(0,2),new _(0,3)).get()),h.empty())],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN())]}class tJ extends Yn{getListMoves(e,t){const n=e.gameState,i=this.getListDrops(n),o=this.getListShifts(n);return i.concat(o)}getListShifts(e){const t=[],n=this.getShiftSources(e);for(const i of n)for(const o of[new S2(i,"clockwise"),new S2(i,"counterclockwise")])r4.get().shiftHeightValidity(o,e).isSuccess()&&t.push(o);return t}getListDrops(e){const t=this.getRemainingPiecesForCurrentPlayer(e),n=[];for(let i=0;i<gr.WIDTH;i++)for(const o of t){const s=new Sl(i,o);r4.get().dropHeightValidity(s,e).isSuccess()&&n.push(s)}return n}getRemainingPiecesForCurrentPlayer(e){const t=[];for(const n of _n.PLAYER_PIECES)this.currentPlayerCanDropPiece(e,n)&&t.push(n);return t}currentPlayerCanDropPiece(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}getShiftSources(e){const t=[],n=e.getCurrentPlayer();for(let i=0;i<gr.HEIGHT;i++)for(let o=0;o<gr.WIDTH;o++)e.getPieceAtXY(o,i).owner===n&&t.push(new _(o,i));return t}}function QRe(r,e){if(1&r){const t=de();N(),M(0,"g",6)(1,"path",7),W("click",function(){const o=te(t).$implicit;return ne(p().onSpaceClick(o))}),P(),M(2,"path",8),W("click",function(){const o=te(t).$implicit;return ne(p().onSpaceClick(o))}),P()()}if(2&r){const t=e.$implicit,n=p();En("id","board_space_",t,""),m(),En("id","click_",t,""),v("ngClass",n.viewInfo.boardInfo[t].spaceClasses),w("d",n.BOARD_PATHS[t]),m(),v("ngClass",n.viewInfo.boardInfo[t].spaceClasses),w("d",n.DECORATION_PATHS[t])}}function JRe(r,e){if(1&r){const t=de();N(),M(0,"g",10),W("click",function(){const o=te(t).$implicit,s=p().$implicit;return ne(p().onPieceInGameClick(s,o.y))}),V(1,"use",11)(2,"use",12),P()}if(2&r){const t=e.$implicit;Ce("id","click_",p().$implicit,"_",t.y,""),v("ngClass",t.foregroundClasses),m(),v("ngClass",t.backgroundClasses),w("x",t.drawPosition.x)("y",t.drawPosition.y),m(),w("x",t.drawPosition.x)("y",t.drawPosition.y)}}function exe(r,e){if(1&r&&(N(),M(0,"g"),z(1,JRe,3,8,"g",9),P()),2&r){const t=e.$implicit,n=p();m(),v("ngForOf",n.viewInfo.boardInfo[t].pieces)}}function txe(r,e){if(1&r){const t=de();N(),M(0,"g",14),W("click",function(){const i=te(t),o=i.$implicit,s=i.index;return ne(p(2).onRemainingPieceClick(o.actualPiece,s))}),V(1,"use",11)(2,"use",12),P()}if(2&r){const t=e.$implicit,n=e.index;Hr("id","piece_",t.actualPiece.owner.toString(),"_",t.actualPiece.otherPieceType?1:0,"_",n,""),v("ngClass",t.foregroundClasses),m(),v("ngClass",t.backgroundClasses),w("x",t.drawPosition.x)("y",t.drawPosition.y),m(),w("x",t.drawPosition.x)("y",t.drawPosition.y)}}function nxe(r,e){if(1&r&&(N(),M(0,"g"),z(1,txe,3,9,"g",13),P()),2&r){const t=e.$implicit,n=p();m(),v("ngForOf",n.viewInfo.remainingPieces.get(t).get())}}const rxe=()=>[0,1,2,3,4,5,6,7],ixe=()=>[2,1,3,0,4,7,5,6];class c0 extends $c{static CENTER=[new _(40,160),new _(100,50),new _(255,2),new _(400,50),new _(460,160),new _(400,270),new _(255,320),new _(100,270)];static PIECE_HEIGHT=36;BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"];DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"];selected=h.empty();viewInfo={boardInfo:[],remainingPieces:new fn([{key:O.ZERO,value:[]},{key:O.ONE,value:[]}])};constructor(e){super(e),this.setRulesAndNode("Diam"),this.availableAIs=[new cn($localize`Dummy`,this.rules,new yI,new tJ),new kn($localize`MCTS`,new tJ,this.rules)],this.encoder=oRe}onSpaceClick(e){var t=this;return E(function*(){const n=yield t.canUserPlay("#click_"+e);return n.isFailure()?t.cancelMove(n.getReason()):t.onSpaceClickAfterCheck(e)})()}onSpaceClickAfterCheck(e){var t=this;return E(function*(){if(t.selected.isPresent()){const n=t.selected.get();let i;if("pieceFromReserve"===n.type)i=new Sl(e,n.piece);else if((n.position.x+1)%gr.WIDTH===e)i=new S2(n.position,"clockwise");else{if((n.position.x+(gr.WIDTH-1))%gr.WIDTH!==e)return t.cancelMove(gd.MUST_SHIFT_TO_NEIGHBOR());i=new S2(n.position,"counterclockwise")}return t.chooseMove(i)}return t.cancelMove(gd.MUST_SELECT_PIECE_FIRST())})()}onPieceInGameClick(e,t){var n=this;return E(function*(){const i=yield n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const o=new _(e,t);return n.getState().getPieceAt(o).owner===n.getCurrentPlayer()?(n.isSelected(null,o)?yield n.cancelMoveAttempt():n.selected=h.of({type:"pieceFromBoard",position:o}),n.updateViewInfo(),A.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())})()}onRemainingPieceClick(e,t){var n=this;return E(function*(){const i=yield n.canUserPlay(n.getPieceId(e,t));return i.isFailure()?n.cancelMove(i.getReason()):e.owner===n.getCurrentOpponent()?n.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(n.selected=n.isSelected(e)?h.empty():h.of({type:"pieceFromReserve",piece:e}),n.updateViewInfo(),A.SUCCESS)})()}getPieceId(e,t){return"#piece_"+e.owner.toString()+"_"+(e.otherPieceType?1:0)+"_"+t}isSelected(e,t){return!this.selected.isAbsent()&&(null==e&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(t):this.selected.get().piece===e)}updateBoard(e){var t=this;return E(function*(){t.updateViewInfo()})()}getLastMovedFromDrop(e,t){const n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),i=e.getTarget(),o=t.getStackHeight(e.getTarget()),s=this.getDrawPositionOnBoard(i,o),a=new _(i,o);return[{start:h.empty(),end:a,startDrawPosition:n,endDrawPosition:s}]}getLastMovedFromShift(e,t){const n=e.start.x,i=e.getTarget();let o=t.getStackHeight(i);const s=[];for(let a=e.start.y;a<gr.HEIGHT&&t.getPieceAtXY(n,a)!==_n.EMPTY;a++,o++)s.push({start:h.of(new _(n,a)),end:new _(i,o),startDrawPosition:this.getDrawPositionOnBoard(n,a),endDrawPosition:this.getDrawPositionOnBoard(i,o)});return s}updateViewInfo(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}updateBoardInfo(){for(let e=0;e<gr.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}showLastMove(e){var t=this;return E(function*(){t.showLastMoveOnSpaces(e),t.showLastMoveOnPieces(e)})()}hideLastMove(){}showLastMoveOnSpaces(e){for(let t=0;t<gr.WIDTH;t++){const n=[];if(e.isDrop())e.getTarget()===t&&n.push("moved-fill");else{const i=e;(i.getTarget()===t||i.start.x===t)&&n.push("moved-fill")}this.viewInfo.boardInfo[t].spaceClasses=n}}showLastMoveOnPieces(e){const t=this.getPreviousState();let n=[];n=e.isDrop()?this.getLastMovedFromDrop(e,t):this.getLastMovedFromShift(e,t);for(const i of n)this.viewInfo.boardInfo[i.end.x].pieces[i.end.y].foregroundClasses.push("last-move-stroke")}updateRemainingPiecesInfo(){const e=this.getCurrentPlayer();this.viewInfo.remainingPieces=new fn([{key:O.ZERO,value:[]},{key:O.ONE,value:[]}]);const t=this.isPlayerTurn();for(const n of _n.PLAYER_PIECES){const i=this.getState().getRemainingPiecesOf(n);for(let o=0;o<i;o++){const s=[];this.isTopPieceOfReserveAndSelected(o,i,n)&&s.push("selected-stroke"),t&&o===i-1&&n.owner===e&&s.push("clickable-stroke-hover");const a=this.viewInfo.remainingPieces.get(n.owner).get(),c=[];c.push(n.otherPieceType?"player"+n.owner.getValue()+"-alternate-fill":"player"+n.owner.getValue()+"-fill"),a.push({backgroundClasses:c,foregroundClasses:s,y:o,drawPosition:this.getDrawPositionRemainingPiece(n,o),actualPiece:n}),this.viewInfo.remainingPieces.put(n.owner,a)}}}isTopPieceOfReserveAndSelected(e,t,n){if(this.selected.isPresent()){const i=this.selected.get();return"pieceFromReserve"===i.type&&i.piece===n&&e===t-1}return!1}getDrawPositionRemainingPiece(e,t){let n,i;return n=e.owner===O.ZERO?-100:600,i=e.otherPieceType?100:450,new _(n,i).getNext(new $t(0,-t*c0.PIECE_HEIGHT))}getPieces(e){const t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),i=[];for(let o=0;o<gr.HEIGHT;o++){const s=this.getState().getPieceAtXY(e,o),a=new _(e,o);if(s!==_n.EMPTY){const c=[];this.pieceFromBoardIsSelected(e,o)&&c.push("selected-stroke"),this.isVictory(e,o,t)&&c.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),a)&&c.push("clickable-stroke-hover"),i.push({backgroundClasses:["player"+s.owner.getValue()+(s.otherPieceType?"-alternate-fill":"-fill")],foregroundClasses:c,y:o,drawPosition:this.getDrawPositionOnBoard(e,o),actualPiece:s})}}return i}pieceFromBoardIsSelected(e,t){if(this.selected.isPresent()){const n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}isVictory(e,t,n){if(n.isPresent()){const i=n.get();return i.x%4==e%4&&i.y===t}return!1}getDrawPositionOnBoard(e,t){return c0.CENTER[e].getNext(new $t(0,-t*c0.PIECE_HEIGHT))}cancelMoveAttempt(){var e=this;return E(function*(){e.selected=h.empty(),yield e.updateBoard(!1)})()}static \u0275fac=function(t){return new(t||c0)(G(Ut))};static \u0275cmp=$e({type:c0,selectors:[["app-diam"]],features:[We],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 15 v 35 A 40 15, 0, 0, 0, 80 50 v -35 A 40 15, 0, 0, 0, 0 15 Z"],["cx","40","cy","15","rx","40","ry","15"],[3,"id",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"id"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(t,n){1&t&&(N(),M(0,"svg",0)(1,"defs")(2,"g",1),V(3,"path",2)(4,"ellipse",3),P()(),z(5,QRe,3,6,"g",4)(6,exe,2,1,"g",5)(7,nxe,2,1,"g",5),P()),2&t&&(m(5),v("ngForOf",ur(3,rxe)),m(),v("ngForOf",ur(4,ixe)),m(),v("ngForOf",n.Player.PLAYERS))},dependencies:[zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}class vs{offset;constant;static fromTwoCoords(e,t){const n=e.x,i=t.x,o=e.y,s=t.y,a=n+o,c=i+s;return n===i&&o!==s&&a!==c?h.of(vs.constantQ(n)):n!==i&&o===s&&a!==c?h.of(vs.constantR(o)):n!==i&&o!==s&&a===c?h.of(vs.constantS(a)):h.empty()}static constantQ(e){return new vs(e,"q")}static constantR(e){return new vs(e,"r")}static constantS(e){return new vs(e,"s")}static areOnSameLine(e){if(e.length<2)return!0;const t=vs.fromTwoCoords(e[0],e[1]);if(t.isAbsent())return!1;const n=t.get();for(const i of e.slice(2))if(!1===n.contains(i))return!1;return!0}constructor(e,t){this.offset=e,this.constant=t}toString(){return`Line(${this.constant}, ${this.offset})`}equals(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}contains(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}getDirection(){switch(this.constant){case"q":return Se.DOWN;case"r":return Se.RIGHT;case"s":return Se.DOWN_LEFT}}}class xI extends $1{width;height;excludedSpaces;empty;constructor(e,t,n,i,o,s){super(t,e),this.width=n,this.height=i,this.excludedSpaces=o,this.empty=s,hn(this.excludedSpaces.length<this.height/2+1,"Invalid excluded spaces specification for HexagonalGameState.")}setAt(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}equalsT(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedSpaces.length!==e.excludedSpaces.length)return!1;for(let n=0;n<this.excludedSpaces.length;n++)if(this.excludedSpaces[n]!==e.excludedSpaces[n])return!1;for(const n of this.allCoords())if(!1===t(this.getPieceAt(n),e.getPieceAt(n)))return!1;return!0}allCoords(){const e=[];return this.forEachCoord(t=>{e.push(t)}),e}allLines(){const e=[];for(let t=0;t<this.width;t++)e.push(vs.constantQ(t));for(let t=0;t<this.height;t++)e.push(vs.constantR(t));for(let t=this.excludedSpaces.length;t<this.height+this.excludedSpaces.length;t++)e.push(vs.constantS(t));return e}getEntranceOnLine(e){let t,n;switch(e.constant){case"q":return n=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new _(e.offset,n));case"r":return t=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new _(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new _(e.offset,0):new _(this.width-1,e.offset-this.width+1))}}findEntranceFrom(e,t){const n=e.getDirection();let i=t;for(let s=0;s<Math.max(this.width,this.height);s++){if(this.isOnBoard(i))return i;i=i.getNext(n)}const o=Gi.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(o.getReason())}}class bi{static getNeighbors(e,t=1){const n=[];for(const i of Se.factory.all)n.push(e.getNext(i,t));return n}static areNeighbors(e,t){for(const n of Se.factory.all)if(e.getNext(n).equals(t))return!0;return!1}}class T1{owner;size;source;static encoder=ke.tuple([ke.identity(),O.encoder,ke.identity()],e=>[e.source,e.owner,e.size],e=>new T1(e[1],e[2],e[0]));static MAX_SIZE=49;static EMPTY=new T1(B.NONE,0,!1);static UNREACHABLE=new T1(B.NONE,-1,!1);static PLAYER_ZERO=new T1(O.ZERO,1,!1);static PLAYER_ONE=new T1(O.ONE,1,!1);static SOURCE=new T1(B.NONE,1,!0);static append(e,t){return new T1(e.owner,e.size+t.size,e.source||t.source)}constructor(e,t,n){this.owner=e,this.size=t,this.source=n}getOwner(){return this.owner}belongsTo(e){return this.owner===e}containsSource(){return this.source}isEmpty(){return 0===this.size}hasPieces(){return!1===this.isEmpty()}getSize(){return this.size}toString(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}equals(e){return this.owner===e.owner&&this.size===e.size&&this.source===e.source}}let ea=(()=>{class r extends xI{alreadyPassed;static WIDTH=11;static HEIGHT=5;static EXCLUDED_SPACES=[2,1];static balancedBoard(){const t=T1.UNREACHABLE,n=T1.PLAYER_ZERO,i=T1.PLAYER_ONE,o=T1.SOURCE;return[[t,t,n,i,i,i,n,n,i,o,i],[t,i,i,n,n,n,i,i,n,i,i],[i,i,i,i,n,o,i,n,n,n,n],[n,n,i,n,n,i,i,i,n,n,t],[n,o,n,i,i,n,n,n,i,t,t]]}static isOnBoard(t){return!t.isNotInRange(r.WIDTH,r.HEIGHT)&&r.balancedBoard()[t.y][t.x]!==T1.UNREACHABLE}constructor(t,n,i){super(n,t,r.WIDTH,r.HEIGHT,r.EXCLUDED_SPACES,T1.EMPTY),this.alreadyPassed=i}getAllPieces(){const t=[];for(let n=0;n<r.HEIGHT;n++)for(let i=0;i<r.WIDTH;i++){const o=new _(i,n);this.isOnBoard(o)&&this.getPieceAt(o).hasPieces()&&t.push(o)}return t}numberOfNeighbors(t){return bi.getNeighbors(t,1).filter(o=>this.isOnBoard(o)&&this.getPieceAt(o).hasPieces()).length}setAtUnsafe(t,n){const i=it.copy(this.board);return i[t.y][t.x]=n,new r(i,this.turn,this.alreadyPassed)}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==T1.UNREACHABLE}}return r})(),l0=(()=>class r{static NOT_PLAYER_PIECE=()=>$localize`You must select a piece or a stack of your color.`;static EMPTY_STACK=()=>$localize`You must select a stack.`;static TOO_MANY_NEIGHBORS=()=>$localize`This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors.`;static CANT_REACH_TARGET=()=>$localize`This stack cannot move because it could never land on another piece.`;static INVALID_MOVE_LENGTH=()=>$localize`A stack must always be moved by as many spaces as there are pieces in the stack.`;static EMPTY_TARGET_STACK=()=>$localize`The stack must land on an occupied space.`;static MUST_MOVE_IN_STRAIGHT_LINE=()=>$localize`A stack must move in a straight line.`})();class Ir extends Do{static PASS=new Ir(new _(-1,-1),new _(-2,-2));static encoder=q2.getFallibleEncoder(Ir.from);constructor(e,t){super(e,t)}static from(e,t){return-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y?X.success(Ir.PASS):!1===ea.isOnBoard(e)?X.failure("Starting coord of DvonnMove must be on the board, not at "+e.toString()):!1===ea.isOnBoard(t)?X.failure("End coord of DvonnMove must be on the board, not at "+e.toString()):e.y===t.y||e.x===t.x||e.x+e.y===t.x+t.y?X.success(new Ir(e,t)):X.failure(l0.MUST_MOVE_IN_STRAIGHT_LINE())}toString(){return this===Ir.PASS?"DvonnMove.PASS":"DvonnMove("+this.getStart()+"->"+this.getEnd()+")"}length(){return this.getStart().y===this.getEnd().y?Math.abs(this.getStart().x-this.getEnd().x):(this.getStart(),this.getEnd(),Math.abs(this.getStart().y-this.getEnd().y))}}class Zr extends wr{static singleton=h.empty();static get(){return Zr.singleton.isAbsent()&&(Zr.singleton=h.of(new Zr)),Zr.singleton.get()}getInitialState(){return new ea(ea.balancedBoard(),0,!1)}static getGameStatus(e){const t=e.gameState,n=Zr.getScores(t);if(0===Zr.getMovablePieces(t).length){const i=n.get(O.ZERO),o=n.get(O.ONE);return i>o?ve.ZERO_WON:i<o?ve.ONE_WON:ve.DRAW}return ve.ONGOING}static getMovablePieces(e){return Zr.getFreePieces(e).filter(t=>Zr.pieceHasTarget(e,t))}static getFreePieces(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6)}static pieceHasTarget(e,t){const n=e.getPieceAt(t).getSize();return void 0!==bi.getNeighbors(t,n).find(o=>e.isOnBoard(o)&&e.getPieceAt(o).hasPieces())}static pieceTargets(e,t){const n=e.getPieceAt(t).getSize();return bi.getNeighbors(t,n).filter(o=>e.isOnBoard(o)&&e.getPieceAt(o).hasPieces())}static getScores(e){let t=0,n=0;return e.getAllPieces().map(i=>{const o=e.getPieceAt(i);o.belongsTo(O.ZERO)?t+=o.getSize():o.belongsTo(O.ONE)&&(n+=o.getSize())}),we.of(t,n)}isMovablePiece(e,t){L.assert(e.isOnBoard(t),"piece is not on the board");const n=e.getPieceAt(t);return n.getSize()<1?A.failure(l0.EMPTY_STACK()):!1===n.belongsTo(e.getCurrentPlayer())?A.failure(l0.NOT_PLAYER_PIECE()):6<=e.numberOfNeighbors(t)?A.failure(l0.TOO_MANY_NEIGHBORS()):!1===Zr.pieceHasTarget(e,t)?A.failure(l0.CANT_REACH_TARGET()):A.SUCCESS}canOnlyPass(e){return 0===Zr.getMovablePieces(e).length}sourceCoords(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).containsSource())}markPiecesConnectedTo(e,t,n){bi.getNeighbors(t,1).forEach(i=>{e.isOnBoard(i)&&!1===n[i.y][i.x]&&e.getPieceAt(i).hasPieces()&&(n[i.y][i.x]=!0,this.markPiecesConnectedTo(e,i,n))})}removeDisconnectedPieces(e){const t=it.create(ea.WIDTH,ea.HEIGHT,!1);this.sourceCoords(e).forEach(i=>{t[i.y][i.x]=!0,this.markPiecesConnectedTo(e,i,t)});let n=e;return n.getAllPieces().forEach(i=>{!1===t[i.y][i.x]&&(n=n.setAt(i,T1.EMPTY))}),n}applyLegalMove(e,t,n,i){if(e===Ir.PASS)return new ea(t.board,t.turn+1,!0);{const o=t.getPieceAt(e.getStart()),s=t.getPieceAt(e.getEnd()),a=t.setAt(e.getStart(),T1.EMPTY).setAt(e.getEnd(),T1.append(o,s));return this.removeDisconnectedPieces(new ea(a.board,t.turn+1,!1))}}isLegal(e,t,n){if(0===Zr.getMovablePieces(t).length)return e===Ir.PASS&&!1===t.alreadyPassed?A.SUCCESS:A.failure(Me.MUST_PASS());if(e===Ir.PASS)return A.failure(Me.CANNOT_PASS());const i=this.isMovablePiece(t,e.getStart());if(i.isFailure())return i;const o=t.getPieceAt(e.getStart());return e.length()!==o.getSize()?X.failure(l0.INVALID_MOVE_LENGTH()):t.getPieceAt(e.getEnd()).isEmpty()?X.failure(l0.EMPTY_TARGET_STACK()):X.success(void 0)}getGameStatus(e){return Zr.getGameStatus(e)}}const ie=T1.EMPTY,pr=T1.UNREACHABLE,Al=T1.SOURCE,au=T1.PLAYER_ZERO,cu=T1.PLAYER_ONE,oxe=new T1(O.ZERO,2,!1),LI=new T1(O.ONE,2,!1),nJ=new T1(O.ZERO,4,!1),sxe=new T1(O.ONE,4,!1);class axe extends Bn{tutorial=[q.anyMove($localize`Moving`,$localize`At Dvonn, each hexagonal space contains a stack of pieces.
        If no number is indicated on a stack, it means that it only contains one piece.
        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.
        The owner of a stack is the one that has a piece at the top of the stack.
        Only the owner of a stack can move it.
        A stack cannot be moved if it is surrounded by 6 other stacks.
        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.
        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.
        Therefore, there are six possible directions.
        The player with dark pieces starts.<br/><br/>
        You're playing Dark, click on a stack and move it by one space.`,Zr.get().getInitialState(),Ir.from(new _(2,0),new _(3,0)).get(),pe.CONGRATULATIONS()),q.fromPredicate($localize`Disconnection`,$localize`Pieces with a lightning strike are called "sources".
        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>
        You're playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!`,new ea([[pr,pr,cu,Al,ie,ie,ie,ie,ie,ie,ie],[pr,ie,au,ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,sxe,ie,ie,ie,ie,cu,Al,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,pr],[ie,ie,ie,ie,ie,ie,ie,ie,ie,pr,pr]],0,!1),Ir.from(new _(2,1),new _(2,0)).get(),(e,t,n)=>e.getEnd().equals(new _(3,0))?A.failure($localize`You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it.`):(hn(e.getEnd().equals(new _(2,0)),"player made an impossible move"),A.SUCCESS),$localize`Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!
        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.
        Disconnected stacks will not be visible at the next turn.`),q.fromPredicate($localize`Moving on a source`,$localize`You are allowed to move your stacks on any other stack.
        This means that you can take control of a source by moving one of your stack on top of it.
        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>
        You're playing Dark and you can take control of a source, do it!`,new ea([[pr,pr,Al,cu,ie,ie,ie,ie,ie,ie,ie],[pr,au,au,ie,ie,ie,ie,ie,ie,ie,ie],[ie,cu,au,cu,ie,ie,au,LI,Al,ie,ie],[ie,ie,cu,ie,ie,ie,ie,ie,ie,ie,pr],[ie,ie,ie,ie,ie,ie,ie,ie,ie,pr,pr]],0,!1),Ir.from(new _(2,1),new _(2,0)).get(),(e,t,n)=>e.getEnd().equals(new _(2,0))?A.SUCCESS:A.failure($localize`You have not taken possession of a source, try again.`),$localize`Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!`),q.informational($localize`Passing`,$localize`It can happen that you have no possible move to make.
        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>
        This is a situation that occurs here for Dark.`,new ea([[pr,pr,Al,ie,ie,ie,ie,ie,ie,ie,ie],[pr,ie,oxe,ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,LI,ie,ie,ie,ie,LI,Al,nJ,ie],[ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,pr],[ie,ie,ie,ie,ie,ie,ie,ie,ie,pr,pr]],0,!1)),q.fromMove(pe.END_OF_THE_GAME(),$localize`When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>You're playing Dark, make your last move.`,new ea([[pr,pr,Al,ie,ie,ie,ie,ie,ie,ie,ie],[pr,ie,au,ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie,Al,nJ,ie],[ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,pr],[ie,ie,ie,ie,ie,ie,ie,ie,ie,pr,pr]],0,!1),[Ir.from(new _(2,1),new _(2,0)).get()],$localize`Congratulations, you won 6 - 0!`,$localize`Bad idea, by moving on the source you would have won a point.`)]}class cxe extends or{getMetrics(e,t){return Zr.getScores(e.gameState).toTable()}}class rJ extends Yn{getListMoves(e,t){const n=e.previousMove,i=e.gameState,o=[];return Zr.getMovablePieces(i).forEach(s=>Zr.pieceTargets(i,s).forEach(a=>{const c=Ir.from(s,a).get();o.push(c)})),0===o.length&&!1===n.equalsValue(Ir.PASS)&&o.push(Ir.PASS),o}}class iJ extends rJ{getListMoves(e,t){const n=e.gameState,i=super.getListMoves(e,t),o=n.getCurrentOpponent();return yt.sortByDescending(i,s=>{hn(s!==Ir.PASS,"Cannot sort with DvonnMove.PASS");const a=n.getPieceAt(s.getEnd());return a.belongsTo(o)?a.getSize():0}),i}}class lxe extends or{getMetrics(e,t){const n=e.gameState,i=Zr.getScores(n),o=new U1,s=n.getAllPieces(),a=s.length;for(const c of O.PLAYERS){const l=s.filter(f=>n.getPieceAt(f).belongsTo(c)).length,u=i.get(c);o.set(c,[u*l/a])}return o}}function uxe(r,e){if(1&r&&(N(),V(0,"circle",11)),2&r){const t=p().$implicit,n=p().$implicit,i=p();Ce("id","piece_",n.x,"_",n.y,""),v("ngClass",i.getPieceClasses(t)),w("r",i.SPACE_SIZE)}}function fxe(r,e){1&r&&(N(),V(0,"polygon",12)),2&r&&w("transform",1===p().$implicit.getSize()?"translate(-18, -16) scale(0.10)":"translate(-3, -12) scale(0.07)")}function dxe(r,e){if(1&r){const t=de();N(),M(0,"text",13),W("click",function(){te(t);const i=p(2).$implicit;return ne(p().onClick(i.x,i.y))}),st(1),P()}if(2&r){const t=p().$implicit;w("x",t.containsSource()?-7:0),m(),mn(t.getSize())}}function hxe(r,e){if(1&r){const t=de();N(),M(0,"g",6),W("click",function(){te(t);const i=p().$implicit;return ne(p().onClick(i.x,i.y))}),V(1,"polygon",7),z(2,uxe,1,4,"circle",8)(3,fxe,1,1,"polygon",9)(4,dxe,2,2,"text",10),P()}if(2&r){const t=e.$implicit,n=p().$implicit,i=p();Ce("id","click_",n.x,"_",n.y,""),w("transform",i.getHexaCenterTranslation(n)),m(),w("points",i.getHexaPoints()),m(),v("ngIf",t.getSize()>0),m(),v("ngIf",t.containsSource()),m(),v("ngIf",t.getSize()>1)}}const gxe=r=>[r];function pxe(r,e){if(1&r&&(N(),M(0,"g"),z(1,hxe,5,7,"g",5),P()),2&r){const t=e.$implicit,n=p();m(),v("ngForOf",Oa(1,gxe,n.state.getPieceAt(t)))}}function mxe(r,e){if(1&r&&(N(),M(0,"text",18),st(1),P()),2&r){const t=p().$implicit,n=p();w("x",n.getCenterAt(t.coord).x)("y",n.getCenterAt(t.coord).y),m(),mn(t.spaceContent.getSize())}}function _xe(r,e){if(1&r&&(N(),M(0,"g",14),V(1,"polygon",15)(2,"circle",16),z(3,mxe,2,3,"text",17),P()),2&r){const t=e.$implicit,n=p();Ce("id","disconnected_",t.coord.x,"_",t.coord.y,""),m(),w("points",n.getHexaPoints())("transform",n.getHexaCenterTranslation(t.coord)),m(),Ce("id","captured_",t.coord.x,"_",t.coord.y,""),v("ngClass",n.getPieceClasses(t.spaceContent)),w("cx",n.getCenterAt(t.coord).x)("cy",n.getCenterAt(t.coord).y)("r",n.SPACE_SIZE),m(),v("ngIf",t.spaceContent.getSize()>1)}}function Cxe(r,e){if(1&r&&(N(),jt(0),V(1,"polygon",19)(2,"polygon",19),Zt()),2&r){const t=p();m(),w("points",t.getHexaPoints())("transform",t.getHexaCenterTranslation(t.lastMove.get().getStart())),m(),w("points",t.getHexaPoints())("transform",t.getHexaCenterTranslation(t.lastMove.get().getEnd()))}}function vxe(r,e){if(1&r&&(N(),V(0,"polygon",20)),2&r){const t=p();Ce("id","chosen_",t.chosen.get().x,"_",t.chosen.get().y,""),w("transform",t.getHexaCenterTranslation(t.chosen.get()))("points",t.getHexaPoints())}}let yxe=(()=>{class r extends J5{lastMove=h.empty();chosen=h.empty();disconnecteds=[];state;constructor(t){super(t),this.setRulesAndNode("Dvonn"),this.availableAIs=[new cn($localize`Stacks`,this.rules,new lxe,new iJ),new cn($localize`Score`,this.rules,new cxe,new iJ),new kn($localize`MCTS`,new rJ,this.rules)],this.encoder=Ir.encoder,this.scores=h.of(Zr.getScores(this.getState())),this.SPACE_SIZE=30,this.hexaLayout=new eu(1.5*this.SPACE_SIZE,new _(-this.SPACE_SIZE,2*this.SPACE_SIZE),CC.INSTANCE),this.state=this.getState(),this.hexaBoard=this.getState().board}hideLastMove(){this.lastMove=h.empty()}updateBoard(t){var n=this;return E(function*(){n.state=n.getState(),n.disconnecteds=[],n.canPass=n.rules.canOnlyPass(n.state),n.scores=h.of(Zr.getScores(n.state))})()}showLastMove(t){var n=this;return E(function*(){n.lastMove=h.of(t);const i=n.getPreviousState(),o=n.getState();for(let s=0;s<o.getHeight();s++)for(let a=0;a<o.board[s].length;a++){const c=new _(a,s);if(!0===o.isOnBoard(c)&&!1===c.equals(n.lastMove.get().getStart())){const l=o.getPieceAt(c),u=i.getPieceAt(c);if(l.isEmpty()&&u.hasPieces()){const g={coord:new _(a,s),spaceContent:u};n.disconnecteds.push(g)}}}})()}cancelMoveAttempt(){this.chosen=h.empty()}pass(){var t=this;return E(function*(){return L.assert(t.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield t.chooseMove(Ir.PASS)})()}onClick(t,n){var i=this;return E(function*(){const o=yield i.canUserPlay("#click_"+t+"_"+n);return o.isFailure()?i.cancelMove(o.getReason()):i.chosen.isAbsent()?i.choosePiece(t,n):i.chosen.equalsValue(new _(t,n))?(i.cancelMoveAttempt(),A.SUCCESS):yield i.chooseDestination(t,n)})()}choosePiece(t,n){var i=this;return E(function*(){const o=new _(t,n),s=i.rules.isMovablePiece(i.getState(),o);return s.isSuccess()?(i.chosen=h.of(o),A.SUCCESS):i.cancelMove(s.getReason())})()}chooseDestination(t,n){var i=this;return E(function*(){const o=i.getState(),s=i.chosen.get(),a=new _(t,n),c=Ir.from(s,a);return c.isFailure()?i.rules.isMovablePiece(o,a).isSuccess()?i.choosePiece(t,n):i.cancelMove(c.getReason()):i.rules.isLegal(c.get(),o,i.config).isFailure()&&i.rules.isMovablePiece(o,a).isSuccess()?i.choosePiece(t,n):i.chooseMove(c.get())})()}getPieceClasses(t){if(t.containsSource()&&1===t.getSize())return["nonplayer-fill","dashed-stroke"];const n=this.getPlayerClass(t.getOwner());return t.containsSource()?[n,"nonplayer-stroke","dashed-stroke"]:[n]}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-dvonn"]],features:[We],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["cx","0","cy","0","class","base mid-stroke",3,"id","ngClass",4,"ngIf"],["class","nonplayer-light-fill","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["y","0","class","text-center text-medium","dy","13",3,"click",4,"ngIf"],["cx","0","cy","0",1,"base","mid-stroke",3,"id","ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"nonplayer-light-fill"],["y","0","dy","13",1,"text-center","text-medium",3,"click"],[3,"id"],[1,"base","mid-stroke","captured-fill"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-medium","dy","13",4,"ngIf"],["dy","13",1,"text-center","text-medium"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(n,i){1&n&&(N(),M(0,"svg",0),z(1,pxe,2,3,"g",1)(2,_xe,4,11,"g",2)(3,Cxe,3,4,"ng-container",3)(4,vxe,1,4,"polygon",4),P()),2&n&&(m(),v("ngForOf",i.state.allCoords()),m(),v("ngForOf",i.disconnecteds),m(),v("ngIf",i.lastMove.isPresent()),m(),v("ngIf",i.chosen.isPresent()))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();var B1=function(r){return r[r.NONE=0]="NONE",r[r.SMALL=1]="SMALL",r[r.MEDIUM=2]="MEDIUM",r[r.BIG=3]="BIG",r}(B1||{});class Je{value;static encoder=ke.tuple([ke.identity()],e=>[e.value],e=>Je.of(e[0]));static SMALL_DARK=new Je(0);static SMALL_LIGHT=new Je(1);static MEDIUM_DARK=new Je(2);static MEDIUM_LIGHT=new Je(3);static BIG_DARK=new Je(4);static BIG_LIGHT=new Je(5);static NONE=new Je(6);static of(e){switch(e){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}static ofSizeAndPlayer(e,t){return t===O.ZERO&&e===B1.BIG?Je.BIG_DARK:t===O.ZERO&&e===B1.MEDIUM?Je.MEDIUM_DARK:t===O.ZERO&&e===B1.SMALL?Je.SMALL_DARK:t===O.ONE&&e===B1.BIG?Je.BIG_LIGHT:t===O.ONE&&e===B1.MEDIUM?Je.MEDIUM_LIGHT:t===O.ONE&&e===B1.SMALL?Je.SMALL_LIGHT:Je.NONE}constructor(e){this.value=e}getPlayer(){switch(this){case Je.SMALL_DARK:case Je.MEDIUM_DARK:case Je.BIG_DARK:return O.ZERO;case Je.SMALL_LIGHT:case Je.MEDIUM_LIGHT:case Je.BIG_LIGHT:return O.ONE;default:return B.NONE}}getSize(){switch(this){case Je.BIG_DARK:case Je.BIG_LIGHT:return B1.BIG;case Je.MEDIUM_DARK:case Je.MEDIUM_LIGHT:return B1.MEDIUM;case Je.SMALL_DARK:case Je.SMALL_LIGHT:return B1.SMALL;default:return L.expectToBe(this,Je.NONE),B1.NONE}}belongsTo(e){return this.getPlayer()===e}equals(e){return this===e}toString(){switch(this){case Je.BIG_DARK:return"BIG_DARK";case Je.BIG_LIGHT:return"BIG_LIGHT";case Je.MEDIUM_DARK:return"MEDIUM_DARK";case Je.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case Je.SMALL_DARK:return"SMALL_DARK";case Je.SMALL_LIGHT:return"SMALL_LIGHT";default:return L.expectToBe(this,Je.NONE),"EMPTY"}}}class Yi extends C2{startingCoord;landingCoord;piece;static encoder=ke.tuple([h.getEncoder(_.encoder),_.encoder,h.getEncoder(Je.encoder)],e=>[e.startingCoord,e.landingCoord,e.piece],e=>new Yi(e[0],e[1],e[2]));constructor(e,t,n){super(),this.startingCoord=e,this.landingCoord=t,this.piece=n}static ofMove(e,t){return L.assert(!1===e.equals(t),"Starting coord and landing coord must be separate coords"),new Yi(h.of(e),t,h.empty())}static ofDrop(e,t){return new Yi(h.empty(),t,h.of(e))}isDropping(){return this.startingCoord.isAbsent()}equals(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}toString(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}let _d=(()=>class r{static PIECE_OUT_OF_STOCK=()=>$localize`You do not have pieces of this type anymore.`;static INVALID_PLACEMENT=()=>$localize`You must put your piece on an empty square or on a smaller piece.`;static NOT_DROPPABLE=()=>$localize`You must pick your piece among the remaining ones.`;static INVALID_PIECE_SELECTED=()=>$localize`You must pick one of your remaining pieces or one piece on the board that is the biggest of its square.`;static END_YOUR_MOVE=()=>$localize`You are performing a move, you must select a landing square.`})();class Cd extends $1{remainingPieces;constructor(e,t,n){super(e,t),this.remainingPieces=n}getRemainingPieces(){return yt.copy(this.remainingPieces)}getRemainingPiecesOfPlayer(e){return this.getRemainingPieces().filter(t=>t.getPlayer()===e)}pieceBelongsToCurrentPlayer(e){return e.belongsTo(this.getCurrentPlayer())}isDroppable(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}isInRemainingPieces(e){return this.remainingPieces.some(t=>t===e)}getPlayerRemainingPieces(){return this.remainingPieces.filter(e=>this.pieceBelongsToCurrentPlayer(e))}}class T2{small;medium;big;static EMPTY=new T2(B.NONE,B.NONE,B.NONE);constructor(e,t,n){this.small=e,this.medium=t,this.big=n}isEmpty(){return this.small===B.NONE&&this.medium===B.NONE&&this.big===B.NONE}toList(){const e=[];return this.small.isPlayer()&&e.push(Je.ofSizeAndPlayer(B1.SMALL,this.small)),this.medium.isPlayer()&&e.push(Je.ofSizeAndPlayer(B1.MEDIUM,this.medium)),this.big.isPlayer()&&e.push(Je.ofSizeAndPlayer(B1.BIG,this.big)),e}toOrderedPieceNames(){const e=Je.ofSizeAndPlayer(B1.SMALL,this.small),t=Je.ofSizeAndPlayer(B1.MEDIUM,this.medium),n=Je.ofSizeAndPlayer(B1.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}getBiggest(){return this.big===O.ZERO?Je.BIG_DARK:this.big===O.ONE?Je.BIG_LIGHT:this.medium===O.ZERO?Je.MEDIUM_DARK:this.medium===O.ONE?Je.MEDIUM_LIGHT:this.small===O.ZERO?Je.SMALL_DARK:this.small===O.ONE?Je.SMALL_LIGHT:Je.NONE}tryToSuperposePiece(e){const t=this.getBiggest().getSize();if(e===Je.NONE)throw new Error("Cannot move EMPTY on a space");return e.getSize()>t?h.of(this.put(e)):h.empty()}removeBiggest(){const e=this.getBiggest();if(e===Je.NONE)throw new Error("Cannot removed piece from empty space");let t;const n=e.getSize();switch(n){case B1.BIG:t=new T2(this.small,this.medium,B.NONE);break;case B1.MEDIUM:t=new T2(this.small,B.NONE,B.NONE);break;default:L.expectToBe(n,B1.SMALL),t=new T2(B.NONE,B.NONE,B.NONE)}return{removedSpace:t,removedPiece:e}}put(e){if(e===Je.NONE)throw new Error("Cannot put NONE on space");const t=e.getPlayer(),n=e.getSize();switch(n){case B1.BIG:return new T2(this.small,this.medium,t);case B1.MEDIUM:return hn(this.big===B.NONE,"Cannot put a piece on top of a bigger one"),new T2(this.small,t,this.big);default:return L.expectToBe(n,B1.SMALL),hn(this.big===B.NONE,"Cannot put a piece on top of a bigger one"),hn(this.medium===B.NONE,"Cannot put a piece on top of a bigger one"),new T2(t,this.medium,this.big)}}belongsTo(e){return this.getBiggest().getPlayer()===e}toString(){const e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}var $a;let lu=class extends wr{static#e=$a=this;static singleton=h.empty();static get(){return $a.singleton.isAbsent()&&($a.singleton=h.of(new $a)),$a.singleton.get()}getInitialState(){const e=new T2(B.NONE,B.NONE,B.NONE),t=it.create(3,3,e);return new Cd(t,0,[Je.BIG_DARK,Je.BIG_DARK,Je.BIG_LIGHT,Je.BIG_LIGHT,Je.MEDIUM_DARK,Je.MEDIUM_DARK,Je.MEDIUM_LIGHT,Je.MEDIUM_LIGHT,Je.SMALL_DARK,Je.SMALL_DARK,Je.SMALL_LIGHT,Je.SMALL_LIGHT])}static LINES=[[new _(0,0),new _(0,1),new _(0,2)],[new _(1,0),new _(1,1),new _(1,2)],[new _(2,0),new _(2,1),new _(2,2)],[new _(0,0),new _(1,0),new _(2,0)],[new _(0,1),new _(1,1),new _(2,1)],[new _(0,2),new _(1,2),new _(2,2)],[new _(0,0),new _(1,1),new _(2,2)],[new _(0,2),new _(1,1),new _(2,0)]];static isVictory(e){const t=e.getCopiedBoard();for(const n of $a.LINES){const o=$a.isVictoriousLine([t[n[0].y][n[0].x],t[n[1].y][n[1].x],t[n[2].y][n[2].x]]);if(o.isPresent())return o}return h.empty()}static isVictoriousLine(e){const n=e.map(i=>i.getBiggest()).map(i=>i.getPlayer());return n[0]===B.NONE?h.empty():n[0]===n[1]&&n[1]===n[2]?h.of(n[0]):h.empty()}static isLegal(e,t){let n;if(e.isDropping()){n=e.piece.get();const s=n.getPlayer();if(s===B.NONE)return X.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s===t.getCurrentOpponent())return X.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(!1===t.isInRemainingPieces(n))return X.failure(_d.PIECE_OUT_OF_STOCK())}else{const s=e.startingCoord.get();n=t.getPieceAt(s).getBiggest();const c=n.getPlayer();if(c===B.NONE)return X.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(c===t.getCurrentOpponent())return X.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())}const o=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return o.isPresent()?X.success(o.get()):X.failure(_d.INVALID_PLACEMENT())}isLegal(e,t){return $a.isLegal(e,t)}applyLegalMove(e,t,n,i){const o=t.getCopiedBoard();let s=t.getRemainingPieces();const a=t.turn+1;let c;if(o[e.landingCoord.y][e.landingCoord.x]=i,e.isDropping()){c=e.piece.get();const u=s.indexOf(c);s=s.slice(0,u).concat(s.slice(u+1))}else{const u=e.startingCoord.get(),g=o[u.y][u.x].removeBiggest();o[u.y][u.x]=g.removedSpace,c=g.removedPiece}return new Cd(o,a,s)}static getGameStatus(e){const n=$a.isVictory(e.gameState);return n.isPresent()?ve.getVictory(n.get()):ve.ONGOING}getGameStatus(e){return $a.getGameStatus(e)}};lu=$a=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],lu);class oJ extends Yn{getListMoves(e,t){const n=[],i=e.gameState,o=i.getCopiedBoard(),s=i.getCurrentPlayer(),a=OQ.toComparableObjectSet(i.getPlayerRemainingPieces());for(let c=0;c<3;c++)for(let l=0;l<3;l++){const u=new _(l,c);for(const f of a){const g=Yi.ofDrop(f,u);lu.isLegal(g,i).isSuccess()&&n.push(g)}if(o[c][l].belongsTo(s))for(let f=0;f<3;f++)for(let g=0;g<3;g++){const y=new _(g,f);if(!1===y.equals(u)){const S=Yi.ofMove(u,y);lu.isLegal(S,i).isSuccess()&&n.push(S)}}}return n}}function Exe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"circle",5),W("click",function(){const i=te(t),o=i.$implicit,s=i.index,a=p().$implicit;return ne(p().onPieceClick(a.getValue(),o,s))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().$implicit,o=p();m(),Hr("id","piece_",i.getValue(),"_",t.toString(),"_",n,""),v("ngClass",o.getSidePieceClasses(t,n)),w("transform","rotate("+180*(o.getPointOfView().getValue()+i.getValue())+" "+o.CENTER+" "+o.CENTER+")")("r",o.getPieceRadius(t))("cx",o.getRemainingPieceCenterCoord(i,n).x)("cy",o.getRemainingPieceCenterCoord(i,n).y)}}function Pxe(r,e){if(1&r&&(N(),M(0,"g",null,4),z(2,Exe,2,8,"g",1),P()),2&r){const t=e.$implicit,n=p();m(2),v("ngForOf",n.getRemainingPieces(t))}}function Sxe(r,e){if(1&r){const t=de();N(),M(0,"circle",8),W("click",function(){te(t);const i=p().index,o=p().index;return ne(p().onBoardClick(i,o))}),P()}if(2&r){const t=e.$implicit,n=p().index,i=p().index,o=p();v("ngClass",o.getPieceClasses(t)),w("r",o.getPieceRadius(t))("cx",o.getPieceCenter(n))("cy",o.getPieceCenter(i))}}function Oxe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"rect",6),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onBoardClick(o,s))}),P(),z(2,Sxe,1,4,"circle",7),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();m(),Ce("id","click_",n,"_",i,""),v("ngClass",o.getRectClasses(n,i)),w("x",o.SPACE_SIZE*n+o.STROKE_WIDTH)("y",o.SPACE_SIZE*i+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),m(),v("ngForOf",o.getListPieces(t))}}function Txe(r,e){if(1&r&&(N(),M(0,"g"),z(1,Oxe,3,8,"g",1),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function Axe(r,e){if(1&r){const t=de();N(),M(0,"rect",9),W("click",function(){te(t);const i=p();return ne(i.onBoardClick(i.chosenCoord.get().x,i.chosenCoord.get().y))}),P()}if(2&r){const t=p();Ce("id","chosenCoord_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),w("x",t.SPACE_SIZE*t.chosenCoord.get().x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.chosenCoord.get().y+t.STROKE_WIDTH)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}let bxe=(()=>{class r extends y2{CENTER=this.getPieceCenter(1);UPLEFT=-(this.SPACE_SIZE+.5*this.STROKE_WIDTH);WIDTH=5*this.SPACE_SIZE+3*this.STROKE_WIDTH;lastLandingCoord=h.empty();lastStartingCoord=h.empty();chosenCoord=h.empty();chosenPiece=h.empty();chosenPieceIndex;remainingPieceCenterCoords=new fn;constructor(t){super(t),this.setRulesAndNode("Encapsule"),this.availableAIs=[new cn($localize`Dummy`,this.rules,new yI,new oJ),new kn($localize`MCTS`,new oJ,this.rules)],this.encoder=Yi.encoder}showLastMove(t){var n=this;return E(function*(){n.lastLandingCoord=h.of(t.landingCoord),n.lastStartingCoord=t.startingCoord})()}hideLastMove(){this.lastLandingCoord=h.empty(),this.lastStartingCoord=h.empty()}updateBoard(t){var n=this;return E(function*(){const i=n.getState();n.board=i.getCopiedBoard(),n.calculateLeftPieceCoords()})()}getListPieces(t){return t.toList()}getRemainingPieces(t){return this.getState().getRemainingPiecesOfPlayer(t)}onBoardClick(t,n){var i=this;return E(function*(){const o=yield i.canUserPlay("#click_"+t+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new _(t,n),a=i.getState();if(i.chosenCoord.isAbsent()){if(i.chosenCoord=h.of(s),i.chosenPiece.isPresent()){const c=Yi.ofDrop(i.chosenPiece.get(),s);return i.chooseMove(c)}return!1===a.getPieceAt(s).belongsTo(a.getCurrentPlayer())?i.cancelMove(_d.INVALID_PIECE_SELECTED()):A.SUCCESS}if(i.chosenCoord.equalsValue(s))return i.cancelMoveAttempt(),A.SUCCESS;{const c=Yi.ofMove(i.chosenCoord.get(),s);return i.chooseMove(c)}})()}cancelMoveAttempt(){this.chosenCoord=h.empty(),this.chosenPiece=h.empty(),this.chosenPieceIndex=h.empty()}onPieceClick(t,n,i){var o=this;return E(function*(){const s="#piece_"+t+"_"+n.toString()+"_"+i,a=yield o.canUserPlay(s);return a.isFailure()?o.cancelMove(a.getReason()):!1===o.getState().isDroppable(n)?o.cancelMove(_d.NOT_DROPPABLE()):o.chosenCoord.isAbsent()?(o.chosenPiece.equalsValue(n)&&o.chosenPieceIndex.equalsValue(i)?(o.chosenPiece=h.empty(),o.chosenPieceIndex=h.empty()):(o.chosenPiece=h.of(n),o.chosenPieceIndex=h.of(i)),A.SUCCESS):o.cancelMove(_d.END_YOUR_MOVE())})()}getRectClasses(t,n){return this.isSelected(t,n)?"moved-fill":""}isSelected(t,n){const i=new _(t,n);return!(!this.lastStartingCoord.equalsValue(i)&&!this.lastLandingCoord.equalsValue(i))}getPieceClasses(t){return[this.getPieceStrokeClass(t)]}getPieceCenter(t){return this.SPACE_SIZE*t+this.STROKE_WIDTH+this.SPACE_SIZE/2}getPieceStrokeClass(t){const n=t.getPlayer();return hn(n.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+n.getValue()+"-stroke"}getPieceRadius(t){switch(t.getSize()){case B1.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case B1.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return L.expectToBe(t.getSize(),B1.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}getSidePieceClasses(t,n){const i=this.getPieceClasses(t);return this.isSelectedPiece(t)&&this.chosenPieceIndex.equalsValue(n)&&i.push("selected-stroke"),i}isSelectedPiece(t){return this.chosenPiece.equalsValue(t)}calculateLeftPieceCoords(){this.remainingPieceCenterCoords=new fn;for(const t of O.PLAYERS){const n=[],i=this.getRemainingPieces(t);for(let o=0;o<i.length;o++){let s,a=0,c=0;o<=2?(s=new _(2-o,3),c=this.STROKE_WIDTH):(s=new _(-1,5-o),a=-this.STROKE_WIDTH);const l=this.getPieceCenter(s.x),u=this.getPieceCenter(s.y);n.push(new _(l+a,u+c))}this.remainingPieceCenterCoords.set(t,n)}}getRemainingPieceCenterCoord(t,n){return this.remainingPieceCenterCoords.get(t).get()[n]}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-encapsule"]],features:[We],decls:6,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected-stroke","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingPieces",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected-stroke",3,"id","click"]],template:function(n,i){1&n&&(N(),M(0,"svg",0),z(1,Pxe,3,1,"g",1),M(2,"g",null,2),z(4,Txe,2,1,"g",1)(5,Axe,1,6,"rect",3),P()()),2&n&&(w("viewBox",i.UPLEFT+" "+i.UPLEFT+" "+i.WIDTH+" "+i.WIDTH),m(),v("ngForOf",i.Player.PLAYERS),m(3),v("ngForOf",i.board),m(),v("ngIf",i.chosenCoord.isPresent()))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const _o=new T2(B.NONE,B.NONE,B.NONE),sJ=new T2(O.ZERO,B.NONE,B.NONE),wxe=new T2(B.NONE,O.ZERO,B.NONE),Nxe=new T2(B.NONE,B.NONE,O.ZERO),aJ=new T2(O.ONE,B.NONE,B.NONE),SC=new T2(B.NONE,B.NONE,O.ONE),Ixe=new T2(O.ONE,O.ZERO,B.NONE),kxe=new T2(O.ZERO,O.ZERO,B.NONE);class Rxe extends Bn{tutorial=[q.informational($localize`Goal of the game`,$localize`The goal of Encapsule is to align three of your pieces.
        Here, we have a victory of the dark player.`,new Cd([[sJ,aJ,SC],[_o,wxe,_o],[_o,_o,Nxe]],0,[Je.SMALL_DARK,Je.MEDIUM_DARK,Je.BIG_DARK,Je.SMALL_LIGHT,Je.MEDIUM_LIGHT,Je.MEDIUM_LIGHT,Je.BIG_LIGHT])),q.anyMove($localize`Putting a piece`,$localize`This is the initial board.<br/><br/>
        You're playing Dark. Pick one of your piece on the side of the board and put it on the board.`,lu.get().getInitialState(),Yi.ofDrop(Je.SMALL_DARK,new _(1,1)),pe.CONGRATULATIONS()),q.fromMove($localize`Moving`,$localize`Another possible action is to move one of your pieces that is already on the board.<br/><br/>
        You're playing Dark, click on your piece already on the board and then on any empty square of the board.`,new Cd([[sJ,SC,_o],[_o,_o,_o],[_o,_o,_o]],0,[]),[Yi.ofMove(new _(0,0),new _(2,0)),Yi.ofMove(new _(0,0),new _(0,1)),Yi.ofMove(new _(0,0),new _(1,1)),Yi.ofMove(new _(0,0),new _(2,1)),Yi.ofMove(new _(0,0),new _(0,2)),Yi.ofMove(new _(0,0),new _(1,2)),Yi.ofMove(new _(0,0),new _(2,2))],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),q.fromPredicate($localize`Particularity`,$localize`At Encapsule, pieces encapsulate each other.
        It is therefore possible to have up to three pieces per square!
        However, only the biggest piece of each square counts:
        you cannot win with a piece that is "hidden" by a bigger piece.
        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.
        Finally, you cannot encapsulate a piece with a smaller piece.
        Here, Dark can win now in various ways.<br/><br/>
        You're playing Dark, try to win by making a move, and not by putting a new piece on the board.`,new Cd([[Ixe,_o,aJ],[kxe,SC,SC],[_o,_o,_o]],0,[Je.MEDIUM_DARK,Je.BIG_DARK,Je.MEDIUM_LIGHT,Je.MEDIUM_LIGHT]),Yi.ofMove(new _(0,1),new _(0,2)),(e,t,n)=>{if(e.landingCoord.equals(new _(0,2))){if(e.isDropping())return A.failure($localize`You won, but the exercise is to win while moving a piece!`);if(e.startingCoord.equalsValue(new _(0,1)))return A.SUCCESS}return A.failure(pe.FAILED_TRY_AGAIN())},pe.CONGRATULATIONS())]}class ta extends Nr{movedPieces;stepSize;direction;static encoder=ke.tuple([_.encoder,ke.identity(),ke.identity(),me.encoder],e=>[e.coord,e.movedPieces,e.stepSize,e.direction],e=>new ta(e[0].x,e[0].y,e[1],e[2],e[3]));constructor(e,t,n,i,o){super(e,t),this.movedPieces=n,this.stepSize=i,this.direction=o,L.assert(n>0,"Must select minimum one piece (got "+n+")."),L.assert(i>0,"Step size must be minimum one (got "+i+")."),L.assert(i<=n,"Cannot move a phalanx further than its size (got step size "+i+" for "+n+" pieces).")}toString(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}equals(e){return this===e||!1!==this.coord.equals(e.coord)&&this.movedPieces===e.movedPieces&&this.stepSize===e.stepSize&&this.direction.equals(e.direction)}}class vd extends $1{countRow(e,t){let n=0;for(let i=0;i<this.getWidth();i++)this.board[t][i]===e&&n++;return n}count(e){let t=0;for(const n of this.getCoordsAndContents())n.content===e&&t++;return t}doesOwnPiece(e){for(const t of this.getCoordsAndContents())if(t.content===e)return!0;return!1}}let na=(()=>class r{static PHALANX_IS_LEAVING_BOARD=()=>$localize`The move distance of your phalanx puts it out of the board.`;static SOMETHING_IN_PHALANX_WAY=()=>$localize`There is something in the way of your phalanx.`;static PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=()=>$localize`Your phalanx must be bigger than the one you are capturing.`;static SQUARE_NOT_ALIGNED_WITH_SELECTED=()=>$localize`This square is not aligned with the selected piece.`;static SINGLE_PIECE_MUST_MOVE_BY_ONE=()=>$localize`A single piece can only move by one square.`;static SINGLE_PIECE_CANNOT_CAPTURE=()=>$localize`A single piece cannot make a capture.`;static SQUARE_NOT_ALIGNED_WITH_PHALANX=()=>$localize`This square is not aligned with the direction of the phalanx.`;static PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=()=>$localize`A phalanx can't contain pieces outside of the board.`;static PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE=()=>$localize`A phalanx cannot contain an empty square.`;static PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=()=>$localize`A phalanx cannot contain a piece of the opponent.`})();class wi extends Da{static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new po({name:()=>$localize`Epaminondas`,config:{width:new g1(14,Wi.WIDTH,h1.range(1,99)),emptyRows:new g1(8,()=>$localize`Number of empty rows`,h1.range(1,99)),rowsOfSoldiers:new g1(2,()=>$localize`Number of soldier rows`,h1.range(1,99))}});static get(){return wi.singleton.isAbsent()&&(wi.singleton=h.of(new wi)),wi.singleton.get()}static isLegal(e,t){const n=this.getPhalanxValidity(t,e);if(n.isFailure())return X.failure(n.getReason());const i=this.getLandingStatus(t,e);if(i.isFailure())return i;const o=it.copy(i.get()),s=t.getCurrentOpponent(),a=wi.getCaptureValidity(t,o,e,s);return a.isFailure()?a:X.success(a.get())}static getPhalanxValidity(e,t){let n=t.coord;if(!1===e.isOnBoard(n))return A.failure(go.OUT_OF_RANGE(n));let i=0;const o=e.getCurrentOpponent();for(;i<t.movedPieces;){if(!1===e.isOnBoard(n))return A.failure(na.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());const s=e.getPieceAt(n);if(s===B.NONE)return A.failure(na.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(s===o)return A.failure(na.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());n=n.getNext(t.direction,1),i++}return A.SUCCESS}static getLandingStatus(e,t){const n=e.getCopiedBoard(),i=e.getCurrentPlayer();let o=t.coord,s=t.coord.getNext(t.direction,t.movedPieces),a=0;for(;a+1<t.stepSize;){if(n[o.y][o.x]=B.NONE,n[s.y][s.x]=i,!1===e.isOnBoard(s))return X.failure(na.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(s).isPlayer())return X.failure(na.SOMETHING_IN_PHALANX_WAY());a++,s=s.getNext(t.direction,1),o=o.getNext(t.direction,1)}return!1===e.isOnBoard(s)?X.failure(na.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(s)===i?X.failure(Me.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):(n[o.y][o.x]=B.NONE,n[s.y][s.x]=i,X.success(n))}static getCaptureValidity(e,t,n,i){let o=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),s=0;for(;e.isOnBoard(o)&&e.getPieceAt(o)===i;){if(s>0&&(t[o.y][o.x]=B.NONE),s++,n.movedPieces<=s)return X.failure(na.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());o=o.getNext(n.direction,1)}return X.success(t)}getInitialState(e){const t=e.get(),n=B.NONE,i=B.ZERO,s=it.create(t.width,t.rowsOfSoldiers,B.ONE),a=it.create(t.width,t.emptyRows,n),c=it.create(t.width,t.rowsOfSoldiers,i),l=s.concat(a).concat(c);return new vd(l,0)}getRulesConfigDescription(){return h.of(wi.RULES_CONFIG_DESCRIPTION)}isLegal(e,t){return wi.isLegal(e,t)}applyLegalMove(e,t,n,i){return new vd(i,t.turn+1)}getGameStatus(e,t){const n=e.gameState,i=n.countRow(O.ZERO,0),o=n.getHeight(),s=n.countRow(O.ONE,o-1);if(n.turn%2==0){if(i>s)return ve.ZERO_WON}else if(s>i)return ve.ONE_WON;return!1===n.doesOwnPiece(O.ZERO)?ve.ONE_WON:!1===n.doesOwnPiece(O.ONE)?ve.ZERO_WON:ve.ONGOING}}class cJ extends Yn{getListMoves(e,t){const n=e.gameState.getCurrentPlayer(),i=e.gameState.getCurrentOpponent(),o=B.NONE;let s=[];const a=e.gameState;for(const c of a.getCoordsAndContents()){const l=c.coord;if(c.content===n){let u;for(const f of me.DIRECTIONS){let g=1,y=l.getNext(f,1);for(;a.isOnBoard(y)&&a.getPieceAt(y)===n;)g+=1,y=y.getNext(f,1);let S=1;for(;a.isOnBoard(y)&&S<=g&&a.getPieceAt(y)===o;)u=new ta(l.x,l.y,g,S,f),s=this.addMove(s,u,a),S++,y=y.getNext(f,1);a.isOnBoard(y)&&S<=g&&a.getPieceAt(y)===i&&(u=new ta(l.x,l.y,g,S,f),s=this.addMove(s,u,a))}}}return s}addMove(e,t,n){return wi.isLegal(t,n).isSuccess()&&e.push(t),e}}class lJ extends Ha{}class xxe extends lJ{DOMINANCE_FACTOR=20;DEFENSE_FACTOR=5;TERRITORY_FACTOR=2;OFFENSE_FACTOR=10;CENTER_FACTOR=5;MOBILITY_FACTOR=.12;getBoardValue(e,t){const n=e.gameState,i=this.getDominance(n),o=this.getDefense(n),s=this.getTerritory(n),a=this.getCenter(n),c=this.getOffense(n),l=this.getMobility(n);return gn.of(i+o+s+a+c+l)}getDominance(e){let t=0;for(const n of e.getCoordsAndContents())n.content.isPlayer()&&(t+=n.content.getScoreModifier());return t*this.DOMINANCE_FACTOR}getDefense(e){let t=0;const n=e.getWidth(),i=e.getHeight();for(let o=0;o<n;o++)e.getPieceAtXY(o,i-1)===O.ZERO&&(t+=O.ZERO.getScoreModifier()),e.getPieceAtXY(o,0)===O.ONE&&(t+=O.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}getTerritory(e){let t=0;for(const n of e.getCoordsAndContents()){const i=n.content;if(i.isPlayer()){for(let o=-1;o<=1;o++)for(let s=-1;s<=1;s++){const a=n.coord.getNext(new _(o,s),1);if(e.isOnBoard(a)){const c=e.getPieceAt(a);(c===i||c===B.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}getOffense(e){let t=0;const n=e.getWidth(),i=e.getHeight();for(let o=0;o<n;o++)e.getPieceAtXY(o,0)===O.ZERO&&(t+=O.ZERO.getScoreModifier()),e.getPieceAtXY(o,i-1)===O.ONE&&(t+=O.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}getCenter(e){let t=0;const i=(e.getWidth()-1)/2;for(const o of e.getCoordsAndContents()){const s=o.content;s.isPlayer()&&(t+=s.getScoreModifier()*Math.abs(o.coord.x-i))}return t*this.CENTER_FACTOR}getMobility(e){let t=0,n=0,i=0;for(const o of e.getCoordsAndContents()){const s=o.coord,a=o.content;if(a.isPlayer())for(const c of me.DIRECTIONS){let l=1,u=s.getNext(c,1);for(;e.isOnBoard(u)&&e.getPieceAt(u)===a;)l+=1,u=u.getNext(c,1);let f=1;for(;e.isOnBoard(u)&&f<=l&&e.getPieceAt(u)===B.NONE;)f++,u=u.getNext(c,1);t+=f*f*a.getScoreModifier(),a===O.ZERO?n=Math.max(n,f):a===O.ONE&&(i=Math.max(i,f))}}return(t+n*O.ZERO.getScoreModifier()+i*O.ONE.getScoreModifier())*this.MOBILITY_FACTOR}}class zI extends cJ{getListMoves(e,t){const n=super.getListMoves(e,t);return this.orderMovesByPhalanxSizeAndFilter(n,e.gameState)}orderMovesByPhalanxSizeAndFilter(e,t){return yt.sortByDescending(e,n=>n.movedPieces),e.length>40?e.filter(i=>!!this.moveIsCapture(i,t)||i.movedPieces*Math.random()>1):e}moveIsCapture(e,t){const n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}}class Lxe extends cn{constructor(){super($localize`Attack`,wi.get(),new xxe,new zI)}}class zxe extends Ha{getBoardValue(e,t){return gn.of(this.getPieceCountThenSupportThenAdvancement(e.gameState))}getPieceCountThenSupportThenAdvancement(e){const t=e.getWidth(),n=e.getHeight(),o=28*t+1,a=444*o+1;let c=0;for(const l of e.getCoordsAndContents()){const u=l.coord,f=l.content;if(f.isPlayer()){let g,y;f===O.ZERO?(g=n-u.y,y=[me.UP_LEFT,me.UP,me.UP_RIGHT]):(g=u.y+1,y=[me.DOWN_LEFT,me.DOWN,me.DOWN_RIGHT]);const S=f.getScoreModifier();c+=g*S,c+=a*S;for(const I of y){let R=u.getNext(I,1);for(;e.isOnBoard(R)&&e.getPieceAt(R)===f;)c+=S*o,R=R.getNext(I,1)}}}return c}}class Dxe extends cn{constructor(){super($localize`Positional`,wi.get(),new zxe,new zI)}}class Vxe extends lJ{getBoardValue(e,t){const n=e.gameState.getWidth(),i=e.gameState.getHeight();let o=0,s=0,a=0,c=0;for(let l=0;l<i;l++){let u=0;const f=we.of(0,0);for(let g=0;g<n;g++){const y=new _(g,l),S=e.gameState.getPieceAt(y);if(S.isPlayer()){const I=S.getScoreModifier();o+=I,f.put(S,I),u+=I;for(const R of[me.UP_LEFT,me.UP,me.UP_RIGHT]){let U=y.getNext(R,1);for(;e.gameState.isOnBoard(U)&&e.gameState.getPieceAt(U)===S;)s+=I,U=U.getNext(R,1)}}}0!==u&&(a+=Math.abs(u)/u),c+=f.get(O.ZERO)+f.get(O.ONE)}return gn.multiMetric([o,a,s,c])}}class Hxe extends cn{constructor(){super($localize`Piece > Row Domination > Alignement > Row Presence`,wi.get(),new Vxe,new zI)}}function Fxe(r,e){if(1&r){const t=de();N(),M(0,"circle",4),W("click",function(){te(t);const i=p().index,o=p().index;return ne(p().onClick(i,o))}),P()}if(2&r){const t=p().index,n=p().index,i=p();v("ngClass",i.getPieceClasses(t,n)),w("cx",i.SPACE_SIZE/2)("cy",i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function Uxe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"rect",2),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),P(),z(2,Fxe,1,4,"circle",3),P()}if(2&r){const t=e.index,n=p().index,i=p();w("transform",i.getTranslationXY(t,n)),m(),Ce("id","click_",t,"_",n,""),v("ngClass",i.getRectClasses(t,n)),w("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),m(),v("ngIf",i.board[n][t]!==i.NONE)}}function $xe(r,e){if(1&r&&(N(),M(0,"g"),z(1,Uxe,3,7,"g",1),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function Gxe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"rect",5),W("click",function(){const o=te(t).$implicit;return ne(p().onClick(o.x,o.y))}),P()()}if(2&r){const t=e.$implicit,n=p();m(),w("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let Bxe=(()=>{class r extends y2{NONE=B.NONE;firstPiece=h.empty();validExtensions=[];phalanxValidLandings=[];lastPiece=h.empty();phalanxDirection=h.empty();phalanxMiddles=[];moveds=[];capturedCoords=[];constructor(t){super(t),this.setRulesAndNode("Epaminondas"),this.availableAIs=[new Hxe,new Dxe,new Lxe,new kn($localize`MCTS`,new cJ,this.rules)],this.encoder=ta.encoder,this.hasAsymmetricBoard=!0}updateBoard(t){var n=this;return E(function*(){n.firstPiece=h.empty(),n.lastPiece=h.empty(),n.hideLastMove(),n.board=n.getState().getCopiedBoard(),n.scores=n.getScores()})()}getScores(){const t=this.getState(),n=we.of(t.count(O.ZERO),t.count(O.ONE));return h.of(n)}showLastMove(t){var n=this;return E(function*(){let i=t.coord;n.moveds=[i];for(let a=1;a<t.stepSize+t.movedPieces;a++)i=i.getNext(t.direction,1),n.moveds.push(i);const o=n.node.parent.get(),s=o.gameState.getCurrentOpponent();for(;o.gameState.isOnBoard(i)&&o.gameState.getPieceAt(i)===s;)n.capturedCoords.push(i),i=i.getNext(t.direction,1)})()}onClick(t,n){var i=this;return E(function*(){const o=yield i.canUserPlay("#click_"+t+"_"+n);return o.isFailure()?i.cancelMove(o.getReason()):i.firstPiece.isAbsent()?i.firstClick(t,n):i.lastPiece.isAbsent()?i.secondClick(t,n):i.thirdClick(t,n)})()}firstClick(t,n){var i=this;return E(function*(){const o=i.getState().getCurrentOpponent(),s=i.getState().getCurrentPlayer();switch(i.board[n][t]){case s:return i.firstPiece=h.of(new _(t,n)),i.validExtensions=i.getValidExtensions(s),i.phalanxValidLandings=i.getPhalanxValidLandings(),A.SUCCESS;case o:return i.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());default:return L.expectToBe(i.board[n][t],B.NONE),i.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())}})()}hideLastMove(){this.capturedCoords=[],this.moveds=[]}getValidExtensions(t){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(t):this.getFirstPieceExtensions(t)}getFirstPieceExtensions(t){const n=[];for(const i of me.DIRECTIONS){let o=this.firstPiece.get().getNext(i,1);for(;this.getState().isOnBoard(o)&&this.board[o.y][o.x]===t;)n.push(o),o=o.getNext(i,1)}return n}getPhalanxValidExtensions(t){let n=me.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get();const i=this.lastPiece.get().getNext(n,1),o=this.getExtensionsToward(i,n,t);n=n.getOpposite();const s=this.firstPiece.get().getNext(n,1),a=this.getExtensionsToward(s,n,t);return o.concat(a)}getExtensionsToward(t,n,i){const o=[];for(;this.getState().isOnBoard(t)&&this.board[t.y][t.x]===i;)o.push(t),t=t.getNext(n,1);return o}getPhalanxValidLandings(){if(this.lastPiece.isPresent()){const t=this.firstPiece.get(),n=this.lastPiece.get(),i=Math.abs(t.x-n.x),o=Math.abs(t.y-n.y),s=Math.max(i,o)+1;let a=me.factory.fromMove(t,n).get();const c=n.getNext(a,1),l=this.getLandingsToward(c,a,s);a=a.getOpposite();const u=t.getNext(a,1);return this.getLandingsToward(u,a,s).concat(l)}return this.getNeighboringEmptySpaces()}getNeighboringEmptySpaces(){const t=[];for(const n of me.DIRECTIONS){const i=this.firstPiece.get().getNext(n,1);this.getState().isOnBoard(i)&&this.board[i.y][i.x]===B.NONE&&t.push(i)}return t}getLandingsToward(t,n,i){const o=this.getState().getCurrentPlayer(),s=this.getState().getCurrentOpponent(),a=[];for(;this.getState().isOnBoard(t)&&a.length<i&&this.board[t.y][t.x]!==o;){if(this.board[t.y][t.x]===s)return this.getPhalanxLength(t,n,s)<i&&a.push(t),a;a.push(t),t=t.getNext(n,1)}return a}getPhalanxLength(t,n,i){let o=0;for(;this.getState().isOnBoard(t)&&this.board[t.y][t.x]===i;)o++,t=t.getNext(n,1);return o}cancelMoveAttempt(){this.firstPiece=h.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=h.empty(),this.phalanxMiddles=[],this.hideLastMove()}secondClick(t,n){var i=this;return E(function*(){const o=new _(t,n),s=i.firstPiece.get();if(o.equals(s))return i.cancelMoveAttempt(),A.SUCCESS;const a=i.getState().getCurrentOpponent(),c=i.getState().getCurrentPlayer();if(!1===o.isAlignedWith(s))return i.cancelMove(na.SQUARE_NOT_ALIGNED_WITH_SELECTED());const l=o.getDistance(s),u=s.getDirectionToward(o).get();switch(i.board[n][t]){case B.NONE:return 1===l?i.chooseMove(new ta(s.x,s.y,1,1,u)):i.cancelMove(na.SINGLE_PIECE_MUST_MOVE_BY_ONE());case a:return i.cancelMove(na.SINGLE_PIECE_CANNOT_CAPTURE());default:L.expectToBe(i.board[n][t],c);const f=new ta(s.x,s.y,l,1,u),g=i.getState(),y=wi.getPhalanxValidity(g,f);return y.isFailure()?i.cancelMove(y.getReason()):(i.lastPiece=h.of(o),i.validExtensions=i.getValidExtensions(c),i.phalanxValidLandings=i.getPhalanxValidLandings(),i.phalanxMiddles=s.getCoordsToward(o),i.phalanxDirection=h.of(u),A.SUCCESS)}})()}thirdClick(t,n){var i=this;return E(function*(){const o=i.getState().getCurrentPlayer(),s=new _(t,n);if(i.firstPiece.equalsValue(s))return i.moveFirstPiece(o);if(i.lastPiece.equalsValue(s))return i.moveLastPiece(o);const a=i.firstPiece.get(),c=i.lastPiece.get();if(!1===s.isAlignedWith(a))return i.cancelMove(na.SQUARE_NOT_ALIGNED_WITH_PHALANX());let l=me.factory.fromMove(a,c).get();const u=me.factory.fromMove(a,s).get();if(l===u.getOpposite()&&(i.firstPiece=h.of(c),i.lastPiece=h.of(a),l=u),l!==u)return i.cancelMove(na.SQUARE_NOT_ALIGNED_WITH_PHALANX());if(i.board[n][t]===o)return i.thirdClickOnPlayerPiece(s,l,o);{const f=i.firstPiece.get().getDistance(i.lastPiece.get())+1,g=i.lastPiece.get().getDistance(s),y=new ta(i.firstPiece.get().x,i.firstPiece.get().y,f,g,l);return i.chooseMove(y)}})()}thirdClickOnPlayerPiece(t,n,i){var o=this;return E(function*(){o.lastPiece=h.of(t);const s=o.firstPiece.get().getDistance(t)+1,a=new ta(o.firstPiece.get().x,o.firstPiece.get().y,s,1,n),c=wi.getPhalanxValidity(o.node.gameState,a);return c.isFailure()?o.cancelMove(c.getReason()):(o.phalanxMiddles=o.firstPiece.get().getCoordsToward(o.lastPiece.get()),o.validExtensions=o.getValidExtensions(i),o.phalanxValidLandings=o.getPhalanxValidLandings(),A.SUCCESS)})()}moveFirstPiece(t){var n=this;return E(function*(){return n.firstPiece=h.of(n.firstPiece.get().getNext(n.phalanxDirection.get(),1)),n.firstPiece.equals(n.lastPiece)?yield n.moveOnlyPiece(t):(n.phalanxMiddles=n.phalanxMiddles.slice(1),n.validExtensions=n.getPhalanxValidExtensions(t)),n.phalanxValidLandings=n.getPhalanxValidLandings(),A.SUCCESS})()}moveLastPiece(t){var n=this;return E(function*(){return n.lastPiece=h.of(n.lastPiece.get().getPrevious(n.phalanxDirection.get(),1)),n.firstPiece.equals(n.lastPiece)?n.moveOnlyPiece(t):(n.phalanxMiddles=n.firstPiece.get().getCoordsToward(n.lastPiece.get()),n.validExtensions=n.getPhalanxValidExtensions(t),n.phalanxValidLandings=n.getPhalanxValidLandings(),A.SUCCESS)})()}moveOnlyPiece(t){var n=this;return E(function*(){return n.lastPiece=h.empty(),n.validExtensions=n.getFirstPieceExtensions(t),n.phalanxDirection=h.empty(),n.phalanxMiddles=[],n.phalanxValidLandings=n.getPhalanxValidLandings(),A.SUCCESS})()}getPieceClasses(t,n){const i=this.getPlayerClass(this.board[n][t]);return this.getPieceStrokeClasses(t,n).concat([i])}getPieceStrokeClasses(t,n){const i=new _(t,n);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(i)||this.lastPiece.equalsValue(i)||this.phalanxMiddles.some(o=>o.equals(i))?["selected-stroke"]:[]}getRectClasses(t,n){const i=new _(t,n);return this.capturedCoords.some(o=>o.equals(i))?["captured-fill"]:this.moveds.some(o=>o.equals(i))?["moved-fill"]:[]}getHighlightedCoords(){return!1===this.interactive?[]:this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}getCurrentPlayerPieces(){const t=[],i=this.getState().getCurrentPlayer();for(let o=0;o<this.getHeight();o++)for(let s=0;s<this.getWidth();s++)this.board[o][s]===i&&t.push(new _(s,o));return t}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-epaminondas"]],features:[We],decls:3,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["x","0","y","0",1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable-stroke",3,"click"]],template:function(n,i){1&n&&(N(),M(0,"svg",0),z(1,$xe,2,1,"g",1)(2,Gxe,2,4,"g",1),P()),2&n&&(w("viewBox",i.getViewBox().toSVGString())("transform",i.rotation),m(),v("ngForOf",i.board),m(),v("ngForOf",i.getHighlightedCoords()))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const T=B.NONE,ar=B.ZERO,i1=B.ONE,DI=wi.get().getDefaultRulesConfig();class Wxe extends Bn{tutorial=[q.informational($localize`Initial board`,$localize`This is the initial board of Epaminondas.
        The top line is the starting line of Light.
        The bottom line is the starting line of Dark.`,wi.get().getInitialState(DI)),q.informational($localize`Goal of the game (1/2)`,$localize`After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line
        than the number of pieces the opponent has on the player's starting line, the player wins.
        Here, it's Dark's turn to play: Dark has therefore won.`,new vd([[T,T,T,T,T,ar,T,T,i1,i1,i1,i1,i1,i1],[T,T,T,T,T,ar,T,T,T,T,T,T,i1,i1],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,i1,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,ar,ar,ar,ar,T,T,T]],0)),q.informational($localize`Goal of the game (2/2)`,$localize`Here, it is Light's turn.
        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line.`,new vd([[T,T,T,T,T,ar,T,T,T,T,i1,i1,i1,i1],[T,T,T,T,T,ar,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,i1,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,i1,i1,T,T,T,ar,ar,T,ar,ar,ar,ar]],1)),q.fromPredicate($localize`Moving a piece`,$localize`Here is the starting board. Dark plays first.
        Let's start with moving a single piece:
        <ol>
            <li>Click on a piece.</li>
            <li>Click on a empty neighboring square.</li>
        </ol><br/>You're playing Dark, move a piece.`,wi.get().getInitialState(DI),new ta(0,10,1,1,me.UP),(e,t,n)=>1===e.movedPieces?A.SUCCESS:A.failure($localize`Congratulations, you are in advance. But this is not the exercise here, try again.`),$localize`This is how you move a single piece.`),q.fromPredicate($localize`Moving a phalanx`,$localize`Let us now see how to move multiple pieces along a line, which is called a phalanx:
        <ol>
            <li>Click on the first piece of the phalanx.</li>
            <li>Click on the last piece of the phalanx.</li>
            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>
        </ol><br/>
        You're playing Dark, Move a phalanx!`,wi.get().getInitialState(DI),new ta(0,11,2,1,me.UP),(e,t,n)=>e.movedPieces>1?A.SUCCESS:A.failure($localize`Failed! You moved only one piece.`),$localize`Congratulations! The moved pieces can be horizontally, vertically, or diagonally aligned. The move should be made along this axis, forward or backwards. There can be no opponent nor holes in the phalanx.`),q.fromMove($localize`Captures`,$localize`In order to capture pieces of the opponent:
        <ol>
            <li>It must be aligned with the phalanx you are moving.</li>
            <li>It must be strictly shorter than your phalanx.</li>
            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>
        </ol><br/>
        You're playing Dark, capture a phalanx.`,new vd([[T,T,T,T,T,T,T,T,i1,i1,i1,i1,i1,i1],[T,T,T,T,T,T,i1,T,T,T,T,T,T,T],[T,T,T,T,T,i1,T,T,T,T,T,T,T,T],[T,T,i1,T,i1,T,T,T,T,T,T,T,T,T],[T,T,i1,i1,T,T,T,T,T,T,T,T,T,T],[T,T,i1,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,T,T,T,T,T,T,T],[T,T,ar,T,T,T,T,T,T,T,T,T,T,T],[T,T,ar,T,T,T,T,i1,T,T,T,T,T,T],[T,T,ar,T,T,T,T,T,T,T,T,T,T,T],[T,T,ar,T,T,T,T,T,T,T,T,T,T,T],[T,T,T,T,T,T,T,ar,ar,ar,ar,ar,ar,ar]],0),[new ta(2,10,4,2,me.UP)],$localize`Congratulations, you made it!
        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment.`,$localize`Failed, you have not captured the phalanx.`)]}class Ki{static encoder=ke.tuple([ke.list(_.encoder)],e=>[e.capturedSpaces],e=>new Ki(e[0]));static listEncoder=ke.list(Ki.encoder);capturedSpaces;constructor(e){L.assert(4<=e.length,"Cannot create a GipfCapture with less than 4 captured pieces"),L.assert(vs.areOnSameLine(e),"Cannot create a GipfCapture with pieces that are not on the same line"),this.capturedSpaces=yt.copy(e).sort((n,i)=>n.x===i.x?(L.assert(n.y!==i.y,"Cannot create a GipfCapture with duplicate coords"),n.y>i.y?1:-1):n.x>i.x?1:-1);let t=h.empty();for(const n of this.capturedSpaces)L.assert(t.isAbsent()||1===t.get().getDistance(n),"Cannot create a GipfCapture with non-consecutive coords"),t=h.of(n)}toString(){let e="";for(const t of this.capturedSpaces)""!==e&&(e+=","),e+=t.toString();return e}size(){return this.capturedSpaces.length}forEach(e){this.capturedSpaces.forEach(e)}contains(e){for(let t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}intersectsWith(e){return this.capturedSpaces.some(t=>e.contains(t))}getLine(){return vs.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}equals(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(let t=0;t<this.capturedSpaces.length;t++)if(!1===this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}class OC{static getPossibleCaptureCombinationsFromPossibleCaptures(e){const t=OC.computeIntersections(e);let n=[[]];return e.forEach((i,o)=>{if(0===t[o].length)n.forEach(s=>{s.push(o)});else{const s=[],a=t[o].some(c=>c>o);for(const c of n)!0===c.some(u=>t[o].some(f=>u===f))?s.push(yt.copy(c)):a?(s.push(yt.copy(c)),c.push(o),s.push(yt.copy(c))):(c.push(o),s.push(yt.copy(c)));n=s}}),n.map(i=>i.map(o=>e[o]))}static computeIntersections(e){const t=[];return e.forEach((n,i)=>{t.push([]),e.forEach((o,s)=>{i!==s&&n.intersectsWith(o)&&t[i].push(s)})}),t}}class ra{coord;direction;static encoder=ke.tuple([_.encoder,h.getEncoder(Se.encoder)],e=>[e.coord,e.direction],e=>new ra(e[0],e[1]));constructor(e,t){this.coord=e,this.direction=t}toString(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}equals(e){return!1!==this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}class Ga extends C2{placement;initialCaptures;finalCaptures;static encoder=ke.tuple([ra.encoder,Ki.listEncoder,Ki.listEncoder],e=>[e.placement,e.initialCaptures,e.finalCaptures],e=>new Ga(e[0],e[1],e[2]));constructor(e,t,n){super(),this.placement=e,this.initialCaptures=t,this.finalCaptures=n}toString(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}equals(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===yt.equals(this.initialCaptures,e.initialCaptures)||!1===yt.equals(this.finalCaptures,e.finalCaptures))}}class i4 extends xI{sidePieces;capturedPieces;constructor(e,t,n,i){super(t,e,7,7,[3,2,1],Ee.EMPTY),this.sidePieces=n,this.capturedPieces=i}equals(e){return this.turn===e.turn&&!1!==this.sidePieces.equals(e.sidePieces)&&!1!==this.capturedPieces.equals(e.capturedPieces)&&it.compare(this.board,e.board)}getNumberOfPiecesToPlace(e){return this.sidePieces.get(e)}getNumberOfPiecesCaptured(e){return this.capturedPieces.get(e)}setAtUnsafe(e,t){const n=it.copy(this.board);return n[e.y][e.x]=t,new i4(n,this.turn,this.sidePieces,this.capturedPieces)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Ee.UNREACHABLE}}let ia=(()=>class r{static CAPTURE_MUST_BE_ALIGNED=()=>$localize`You can only capture when 4 or more of your pieces are aligned, and it is not the case.`;static INVALID_CAPTURED_PIECES=()=>$localize`You must select a valid capture that contains 4 pieces or more.`;static MISSING_CAPTURES=()=>$localize`There are still possible captures to be done.`;static PLACEMENT_NOT_ON_BORDER=()=>$localize`Pieces must be inserted in spaces on the edge of the board.`;static INVALID_PLACEMENT_DIRECTION=()=>$localize`You must select a valid placement direction.`;static PLACEMENT_WITHOUT_DIRECTION=()=>$localize`You must select a placement with a direction alongside the insertion space.`;static PLACEMENT_ON_COMPLETE_LINE=()=>$localize`You cannot place a piece on a complete line.`;static AMBIGUOUS_CAPTURE_COORD=()=>$localize`This piece belongs to two captures. Please select another piece in the capture you'd like to make.`;static NO_DIRECTIONS_AVAILABLE=()=>$localize`You cannot insert a piece here, as all lines are full. Select another space.`})();class nn extends wr{static singleton=h.empty();static get(){return nn.singleton.isAbsent()&&(nn.singleton=h.of(new nn)),nn.singleton.get()}getInitialState(){const e=Ee.EMPTY,t=Ee.UNREACHABLE,n=Ee.ZERO,i=Ee.ONE;return new i4([[t,t,t,i,e,e,n],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[n,e,e,e,e,e,i],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[i,e,e,n,t,t,t]],0,we.of(12,12),we.of(0,0))}applyLegalMove(e,t,n,i){return new i4(i.board,i.turn+1,i.sidePieces,i.capturedPieces)}static applyCaptures(e,t){let n=t;return e.forEach(i=>{n=nn.applyCapture(i,n)}),n}static applyCapture(e,t){const n=t.getCurrentPlayer();let i=t;const o=t.sidePieces.getCopy(),s=t.capturedPieces.getCopy();return e.forEach(a=>{const c=t.getPieceAt(a);i=i.setAt(a,Ee.EMPTY),c.is(n)?o.add(n,1):s.add(n,1)}),new i4(i.board,t.turn,o,s)}static getPlacements(e){const t=[];return jr.INSTANCE.getAllBorders(e).forEach(n=>{e.getPieceAt(n)===Ee.EMPTY?t.push(new ra(n,h.empty())):nn.getAllDirectionsForEntrance(e,n).forEach(i=>{!1===nn.isLineComplete(e,n,i)&&t.push(new ra(n,h.of(i)))})}),t}static isLineComplete(e,t,n){return nn.nextGapInLine(e,t,n).isAbsent()}static nextGapInLine(e,t,n){for(let i=t;e.isOnBoard(i);i=i.getNext(n))if(e.getPieceAt(i)===Ee.EMPTY)return h.of(i);return h.empty()}static applyPlacement(e,t){const n=t.getCurrentPlayer();let i=t,o=Ee.ofPlayer(t.getCurrentPlayer());if(e.direction.isAbsent()){const a=e.coord;if(t.getPieceAt(a)!==Ee.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");i=i.setAt(a,o)}else for(let a=e.coord;i.isOnBoard(a)&&o!==Ee.EMPTY;a=a.getNext(e.direction.get())){const c=t.getPieceAt(a);i=i.setAt(a,o),o=c}const s=t.sidePieces.getCopy();return s.add(n,-1),new i4(i.board,t.turn,s,t.capturedPieces)}getPiecesMoved(e,t,n){const i=nn.applyCaptures(t,e);if(n.direction.isAbsent())return[n.coord];{const o=n.direction.get(),s=[];s.push(n.coord);let a=n.coord.getNext(o);for(;i.isOnBoard(a)&&i.getPieceAt(a)!==Ee.EMPTY;)s.push(a),a=a.getNext(o);return L.assert(i.isOnBoard(a)&&i.getPieceAt(a)===Ee.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),s.push(a),s}}static getAllDirectionsForEntrance(e,t){if(jr.INSTANCE.isTopLeftCorner(e,t))return[Se.RIGHT,Se.DOWN,Se.UP_RIGHT];if(jr.INSTANCE.isTopCorner(e,t))return[Se.DOWN,Se.DOWN_LEFT,Se.RIGHT];if(jr.INSTANCE.isTopRightCorner(e,t))return[Se.DOWN_LEFT,Se.DOWN,Se.LEFT];if(jr.INSTANCE.isBottomLeftCorner(e,t))return[Se.UP_RIGHT,Se.UP,Se.RIGHT];if(jr.INSTANCE.isBottomCorner(e,t))return[Se.UP,Se.LEFT,Se.UP_RIGHT];if(jr.INSTANCE.isBottomRightCorner(e,t))return[Se.LEFT,Se.UP,Se.DOWN_LEFT];if(jr.INSTANCE.isOnTopLeftBorder(e,t))return[Se.RIGHT,Se.DOWN];if(jr.INSTANCE.isOnLeftBorder(e,t))return[Se.UP_RIGHT,Se.RIGHT];if(jr.INSTANCE.isOnBottomLeftBorder(e,t))return[Se.UP,Se.UP_RIGHT];if(jr.INSTANCE.isOnBottomRightBorder(e,t))return[Se.LEFT,Se.UP];if(jr.INSTANCE.isOnRightBorder(e,t))return[Se.LEFT,Se.DOWN_LEFT];if(jr.INSTANCE.isOnTopRightBorder(e,t))return[Se.DOWN_LEFT,Se.DOWN];throw new Error("not a border")}isLegal(e,t){const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toOtherFallible();const i=nn.applyCaptures(e.initialCaptures,t),o=this.noMoreCapturesValidity(i);if(o.isFailure())return o.toOtherFallible();const s=this.placementValidity(i,e.placement);if(s.isFailure())return s.toOtherFallible();const a=nn.applyPlacement(e.placement,i),c=this.capturesValidity(a,e.finalCaptures);if(c.isFailure())return c.toOtherFallible();const l=nn.applyCaptures(e.finalCaptures,a),u=this.noMoreCapturesValidity(l);return u.isFailure()?u.toOtherFallible():X.success(l)}capturesValidity(e,t){let n=e;for(const i of t){const o=this.captureValidity(n,i);if(o.isFailure())return o;n=nn.applyCapture(i,n)}return A.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer(),i=nn.getLinePortionWithFourPiecesOfPlayer(e,n,t.getLine());if(i.isAbsent())return A.failure(ia.CAPTURE_MUST_BE_ALIGNED());const o=i.get();return nn.getCapturable(e,o).equals(t)?A.SUCCESS:A.failure(ia.INVALID_CAPTURED_PIECES())}static getLinePortionsWithFourPiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(i=>{const o=nn.getLinePortionWithFourPiecesOfPlayer(e,t,i);o.isPresent()&&n.push(o.get())}),n}static getLinePortionWithFourPiecesOfPlayer(e,t,n){let i=0;const o=e.getEntranceOnLine(n),s=n.getDirection();let a=o;for(let c=o;e.isOnBoard(c);c=c.getNext(s))if(e.getPieceAt(c).is(t)?(0===i&&(a=c),i+=1):i=0,4===i)return h.of({0:a,1:c,2:s});return h.empty()}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===nn.getLinePortionsWithFourPiecesOfPlayer(e,t).length?A.SUCCESS:A.failure(ia.MISSING_CAPTURES())}placementValidity(e,t){const n=this.placementCoordValidity(e,t.coord);if(n.isFailure())return n;if(e.getPieceAt(t.coord)!==Ee.EMPTY){if(t.direction.isAbsent())return A.failure(ia.PLACEMENT_WITHOUT_DIRECTION());if(nn.isLineComplete(e,t.coord,t.direction.get()))return A.failure(ia.PLACEMENT_ON_COMPLETE_LINE());for(const i of nn.getAllDirectionsForEntrance(e,t.coord))if(i===t.direction.get())return A.SUCCESS;return A.failure(ia.INVALID_PLACEMENT_DIRECTION())}return A.SUCCESS}placementCoordValidity(e,t){return jr.INSTANCE.isOnBorder(e,t)?A.SUCCESS:A.failure(ia.PLACEMENT_NOT_ON_BORDER())}static getCapturable(e,t){const n=[],i=t[0],o=t[1],s=t[2],a=s.getOpposite();let c=i.getNext(a);for(;e.isOnBoard(c)&&e.getPieceAt(c)!==Ee.EMPTY;)n.push(c),c=c.getNext(a);for(let l=i;!1===l.equals(o);l=l.getNext(s))n.push(l);for(let l=o;e.isOnBoard(l)&&e.getPieceAt(l)!==Ee.EMPTY;l=l.getNext(s))n.push(l);return new Ki(n)}static getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return nn.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(i=>{n.push(nn.getCapturable(e,i))}),n}static getPlayerScore(e,t){const n=e.getNumberOfPiecesToPlace(t);if(0===n&&0===nn.getPossibleCaptures(e).length)return h.empty();const i=e.getNumberOfPiecesCaptured(t);return h.of(n+3*i)}static isGameOver(e){const t=nn.getPlayerScore(e,O.ZERO),n=nn.getPlayerScore(e,O.ONE);return t.isAbsent()||n.isAbsent()}getGameStatus(e){const t=e.gameState,n=nn.getPlayerScore(t,O.ZERO),i=nn.getPlayerScore(t,O.ONE);return n.isAbsent()?ve.ONE_WON:i.isAbsent()?ve.ZERO_WON:ve.ONGOING}}class uJ extends QQ{source;destination;constructor(e,t,n,i,o,s){super(n,i,o,s),this.source=e,this.destination=t}}class fJ extends Yn{getListMoves(e,t){const n=e.gameState,i=[];return nn.isGameOver(n)||this.getPossibleCaptureCombinations(n).forEach(o=>{const s=nn.applyCaptures(o,n);nn.getPlacements(s).forEach(a=>{const c=nn.applyPlacement(a,s);this.getPossibleCaptureCombinations(c).forEach(l=>{const u=new Ga(a,o,l);i.push(u)})})}),i}getPossibleCaptureCombinations(e){const t=nn.getPossibleCaptures(e);return OC.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}class qxe extends or{getMetrics(e,t){const n=e.gameState;return U1.ofSingle(nn.getPlayerScore(n,O.ZERO).get(),nn.getPlayerScore(n,O.ONE).get())}}function jxe(r,e){if(1&r&&(N(),V(0,"circle",13)),2&r){const t=p().$implicit,n=p();v("ngClass",n.getPieceClass(t)),w("r",n.SPACE_SIZE)}}function Zxe(r,e){if(1&r){const t=de();N(),M(0,"g",10),W("click",function(){const o=te(t).$implicit;return ne(p().onClick(o))}),V(1,"polygon",11),z(2,jxe,1,2,"circle",12),P()}if(2&r){const t=e.$implicit,n=p();Ce("id","click_",t.x,"_",t.y,""),w("transform",n.getHexaCenterTranslation(t)),m(),Ce("id","space_",t.x,"_",t.y,""),v("ngClass",n.getSpaceClass(t)),w("points",n.getHexaPoints()),m(),v("ngIf",n.isPiece(t))}}function Yxe(r,e){if(1&r){const t=de();N(),M(0,"polygon",16),W("click",function(){const o=te(t).$implicit;return ne(p(2).onClick(o))}),P()}if(2&r){const t=e.$implicit,n=p(2);w("points",n.getHexaPoints())("transform",n.getHexaCenterTranslation(t))}}function Kxe(r,e){if(1&r&&(N(),M(0,"g",14),z(1,Yxe,1,2,"polygon",15),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t.capturedSpaces)}}function Xxe(r,e){if(1&r&&(N(),V(0,"line",17)),2&r){const t=e.$implicit;w("x1",t.x1)("y1",t.y1)("x2",t.x2)("y2",t.y2)}}function Qxe(r,e){if(1&r&&(N(),M(0,"g"),V(1,"circle",18),P()),2&r){const t=e.$implicit,n=p().$implicit,i=p();m(),Ce("id","piece_",n.getValue(),"_",t,""),v("ngClass",i.getPlayerClass(n)),w("cx",i.getRemainingPieceCx(n,t))("cy",i.getRemainingPieceCy(n))("r",.5*i.SPACE_SIZE)}}function Jxe(r,e){if(1&r&&(N(),M(0,"g"),z(1,Qxe,2,6,"g",8),P()),2&r){const t=e.$implicit,n=p();m(),v("ngForOf",n.getPlayerSidePieces(t))}}function eLe(r,e){if(1&r&&(N(),V(0,"line",19)),2&r){const t=p();w("x1",t.inserted.get().x1)("y1",t.inserted.get().y1)("x2",t.inserted.get().x2)("y2",t.inserted.get().y2)}}let tLe=(()=>{class r extends J5{static PHASE_INITIAL_CAPTURE=0;static PHASE_PLACEMENT_COORD=1;static PHASE_PLACEMENT_DIRECTION=2;static PHASE_FINAL_CAPTURE=3;inserted=h.empty();arrows=[];captured=[];moved=[];hexagonWidth=this.SPACE_SIZE;sharedHexagonX=Math.cos(30)*this.hexagonWidth*.5;boardWidth=this.hexagonWidth+6*(this.hexagonWidth-this.sharedHexagonX)+3*this.STROKE_WIDTH/2;boardHeight=7*this.hexagonWidth+4.5*this.STROKE_WIDTH;movePhase=r.PHASE_PLACEMENT_COORD;constructedState;possibleCaptures=[];initialCaptures=[];placement=h.empty();placementEntrance=h.empty();finalCaptures=[];constructor(t){super(t),this.setRulesAndNode("Gipf"),this.availableAIs=[new cn($localize`Score`,this.rules,new qxe,new fJ),new kn($localize`MCTS`,new fJ,this.rules)],this.encoder=Ga.encoder,this.hasAsymmetricBoard=!0,this.scores=h.of(we.of(0,0)),this.SPACE_SIZE=40,this.constructedState=this.getState(),this.hexaLayout=new eu(1.5*this.SPACE_SIZE,new _(this.hexagonWidth/2+3*this.STROKE_WIDTH/4,-this.hexagonWidth),jr.INSTANCE)}updateBoard(t){var n=this;return E(function*(){n.constructedState=n.getState(),n.captured=[],n.moved=[],n.initialCaptures=[],n.finalCaptures=[],n.placementEntrance=h.empty(),n.placement=h.empty(),n.arrows=[],n.moveToInitialCaptureOrPlacementPhase()})()}showLastMove(t){var n=this;return E(function*(){const i=n.getPreviousState();if(t.initialCaptures.forEach(o=>n.markCapture(o)),t.finalCaptures.forEach(o=>n.markCapture(o)),n.moved=n.rules.getPiecesMoved(i,t.initialCaptures,t.placement),n.inserted=h.empty(),t.placement.direction.isPresent()){const o=t.placement;n.inserted=h.of(n.arrowTowards(o.coord,o.direction.get()))}})()}arrowTowards(t,n){const i=t.getNext(n.getOpposite()),o=this.getCenterAt(t),s=this.getCenterAt(i);return new uJ(i,t,s.x,s.y,o.x,o.y)}markCapture(t){t.forEach(n=>{this.captured.push(n)})}getAllCoords(){return this.constructedState.allCoords()}getPlayerSidePieces(t){const n=this.constructedState.getNumberOfPiecesToPlace(t),i=[];for(let o=0;o<n;o+=1)i.push(o);return i}isPiece(t){return this.getPiece(t)!==Ee.EMPTY}getPiece(t){return this.constructedState.getPieceAt(t)}onClick(t){var n=this;return E(function*(){const i=yield n.canUserPlay("#click_"+t.x+"_"+t.y);if(i.isFailure())return n.cancelMove(i.getReason());switch(n.movePhase){case r.PHASE_INITIAL_CAPTURE:case r.PHASE_FINAL_CAPTURE:return n.selectCapture(t);case r.PHASE_PLACEMENT_COORD:return n.selectPlacementCoord(t);default:return L.expectToBe(n.movePhase,r.PHASE_PLACEMENT_DIRECTION),n.selectPlacementDirectionOrPlacementCoord(t)}})()}selectCapture(t){var n=this;return E(function*(){const i=[];if(n.possibleCaptures.forEach(s=>{s.contains(t)&&i.push(s)}),i.length>1)return n.cancelMove(ia.AMBIGUOUS_CAPTURE_COORD());if(0===i.length)return n.cancelMove(ia.MISSING_CAPTURES());const o=i[0];return n.constructedState=nn.applyCapture(o,n.constructedState),n.markCapture(o),n.possibleCaptures=nn.getPossibleCaptures(n.constructedState),n.movePhase===r.PHASE_INITIAL_CAPTURE?(n.initialCaptures.push(o),0===n.possibleCaptures.length?n.moveToPlacementPhase():A.SUCCESS):(L.expectToBe(n.movePhase,r.PHASE_FINAL_CAPTURE),n.finalCaptures.push(o),0===n.possibleCaptures.length?n.tryMove(n.initialCaptures,n.placement.get(),n.finalCaptures):A.SUCCESS)})()}moveToPlacementPhase(){return this.movePhase=r.PHASE_PLACEMENT_COORD,A.SUCCESS}moveToInitialCaptureOrPlacementPhase(){return this.possibleCaptures=nn.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?r.PHASE_PLACEMENT_COORD:r.PHASE_INITIAL_CAPTURE,A.SUCCESS}moveToFinalCapturePhaseOrTryMove(){var t=this;return E(function*(){return t.possibleCaptures=nn.getPossibleCaptures(t.constructedState),0===t.possibleCaptures.length?t.tryMove(t.initialCaptures,t.placement.get(),t.finalCaptures):(t.movePhase=r.PHASE_FINAL_CAPTURE,A.SUCCESS)})()}computeArrows(t){this.arrows=[];for(const n of nn.getAllDirectionsForEntrance(this.constructedState,t))if(!1===nn.isLineComplete(this.constructedState,t,n)){const i=t.getNext(n),o=this.getCenterAt(t),s=this.getCenterAt(i);this.arrows.push(new uJ(t,i,o.x,o.y,s.x,s.y))}}selectPlacementCoord(t){var n=this;return E(function*(){const i=n.rules.placementCoordValidity(n.constructedState,t);return i.isFailure()?n.cancelMove(i.getReason()):n.placementEntrance.equalsValue(t)?(n.cancelMoveAttempt(),A.SUCCESS):(n.placementEntrance=h.of(t),n.constructedState.getPieceAt(t)===Ee.EMPTY?n.selectPlacementDirection(h.empty()):(n.movePhase=r.PHASE_PLACEMENT_DIRECTION,n.computeArrows(t),0===n.arrows.length&&(yield n.cancelMove(ia.NO_DIRECTIONS_AVAILABLE())),A.SUCCESS))})()}selectPlacementDirection(t){var n=this;return E(function*(){n.placement=h.of(new ra(n.placementEntrance.get(),t));const i=n.rules.placementValidity(n.constructedState,n.placement.get());return i.isFailure()?n.cancelMove(i.getReason()):(n.arrows=[],n.constructedState=nn.applyPlacement(n.placement.get(),n.constructedState),n.moveToFinalCapturePhaseOrTryMove())})()}selectPlacementDirectionOrPlacementCoord(t){var n=this;return E(function*(){const i=n.placementEntrance.get();if(!1===i.isAlignedWith(t)||1!==i.getDistance(t))return n.selectPlacementCoord(t);const o=Se.factory.fromMove(i,t);return n.selectPlacementDirection(o.toOptional())})()}tryMove(t,n,i){const o=new Ga(n,t,i);return this.chooseMove(o)}cancelMoveAttempt(){this.constructedState=this.getState(),this.captured=[],this.moved=[],this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=h.empty(),this.placement=h.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}hideLastMove(){this.arrows=[],this.inserted=h.empty()}getSpaceClass(t){return this.captured.some(n=>n.equals(t))?"captured-fill":this.moved.some(n=>n.equals(t))?"moved-fill":""}getPieceClass(t){const n=this.getPiece(t);return this.getPlayerClass(n.getPlayer())}getRemainingPieceCy(t){return t===O.ONE?25:this.boardHeight-25}getRemainingPieceCx(t,n){const i=20+n*this.SPACE_SIZE*.5;return t===O.ONE?i:this.boardWidth-(15+i)}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-gipf"]],features:[We],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved-fill","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],["class","arrow click-delegator","marker-end","url(#arrowhead)",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke click-delegator","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["cx","0","cy","0","class","base",3,"ngClass",4,"ngIf"],["cx","0","cy","0",1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow","click-delegator"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke","click-delegator"]],template:function(n,i){1&n&&(N(),M(0,"svg",0)(1,"defs")(2,"marker",1),V(3,"polygon",2),P(),M(4,"marker",3),V(5,"polygon",4),P()(),z(6,Zxe,3,8,"g",5)(7,Kxe,2,1,"g",6)(8,Xxe,1,4,"line",7)(9,Jxe,2,1,"g",8)(10,eLe,1,4,"line",9),P()),2&n&&(w("viewBox",-i.STROKE_WIDTH+" 0 "+i.boardWidth+" "+i.boardHeight)("transform",i.rotation),m(6),v("ngForOf",i.getAllCoords()),m(),v("ngForOf",i.possibleCaptures),m(),v("ngForOf",i.arrows),m(),v("ngForOf",i.Player.PLAYERS),m(),v("ngIf",i.inserted.isPresent()))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();class Yr extends Nr{static PASS=new Yr(-1,0);static ACCEPT=new Yr(-2,0);static encoder=Nr.getEncoder(Yr.of);static of(e){return new Yr(e.x,e.y)}toString(){return this===Yr.PASS?"GoMove.PASS":this===Yr.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}class Ke{player;type;static DARK=new Ke(O.ZERO,"alive");static LIGHT=new Ke(O.ONE,"alive");static EMPTY=new Ke(B.NONE,"empty");static DEAD_DARK=new Ke(O.ZERO,"dead");static DEAD_LIGHT=new Ke(O.ONE,"dead");static DARK_TERRITORY=new Ke(O.ZERO,"territory");static LIGHT_TERRITORY=new Ke(O.ONE,"territory");constructor(e,t){this.player=e,this.type=t}equals(e){return e===this}toString(){switch(this){case Ke.DARK:return"GoPiece.DARK";case Ke.LIGHT:return"GoPiece.LIGHT";case Ke.EMPTY:return"GoPiece.EMPTY";case Ke.DEAD_DARK:return"GoPiece.DEAD_DARK";case Ke.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case Ke.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return L.assert(this===Ke.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}static pieceBelongTo(e,t){return t===e.player&&"territory"!==e.type}static ofPlayer(e){return e===O.ZERO?Ke.DARK:Ke.LIGHT}isOccupied(){return"alive"===this.type||"dead"===this.type}isEmpty(){return"territory"===this.type||"empty"===this.type}isDead(){return"dead"===this.type}isTerritory(){return"territory"===this.type}getOwner(){return this.player}nonTerritory(){return L.assert(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),Ke.EMPTY}}var Cn=function(r){return r.PLAYING="PLAYING",r.PASSED="PASSED",r.COUNTING="COUNTING",r.ACCEPT="ACCEPT",r.FINISHED="FINISHED",r}(Cn||{});class kr extends $1{koCoord;captured;phase;constructor(e,t,n,i,o){super(e,n),this.captured=t,this.koCoord=i,this.phase=o}getCapturedCopy(){return this.captured.getCopy()}static getStartingBoard(e){return it.create(e.width,e.height,Ke.EMPTY)}copy(){return new kr(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}isDead(e){return this.getPieceAt(e).isDead()}isTerritory(e){return this.getPieceAt(e).isTerritory()}}let VI=class{getGroupDatas(e,t){const i=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,i)}_getGroupDatas(e,t,n){const i=t[e.y][e.x];if(n.addPawn(e,i),i===n.color)for(const o of this.getDirections()){const s=e.getNext(o);s.isInRange(t[0].length,t.length)&&!1===n.contains(s)&&(n=this._getGroupDatas(s,t,n))}return n}};VI=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],VI);class uu{color;constructor(e){this.color=e}selfContains(e){return this.getCoords().some(n=>n.equals(e))}static insertAsEntryPoint(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}class iLe extends uu{emptyCoords;darkCoords;lightCoords;deadDarkCoords;deadLightCoords;constructor(e,t,n,i,o,s){super(e),this.emptyCoords=t,this.darkCoords=n,this.lightCoords=i,this.deadDarkCoords=o,this.deadLightCoords=s}getCoords(){return this.color===Ke.DARK?this.darkCoords:this.color===Ke.LIGHT?this.lightCoords:this.color===Ke.DEAD_DARK?this.deadDarkCoords:this.color===Ke.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}contains(e){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(n=>n.equals(e))}addPawn(e,t){switch(hn(!1===this.contains(e),"This group already contains "+e.toString()),t){case Ke.DARK:this.darkCoords=uu.insertAsEntryPoint(this.darkCoords,e);break;case Ke.LIGHT:this.lightCoords=uu.insertAsEntryPoint(this.lightCoords,e);break;case Ke.DEAD_DARK:this.deadDarkCoords=uu.insertAsEntryPoint(this.deadDarkCoords,e);break;case Ke.DEAD_LIGHT:this.deadLightCoords=uu.insertAsEntryPoint(this.deadLightCoords,e);break;default:L.expectToBeMultiple(t,[Ke.EMPTY,Ke.DARK_TERRITORY,Ke.LIGHT_TERRITORY]),this.emptyCoords=uu.insertAsEntryPoint(this.emptyCoords,e)}}isMonoWrapped(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}getWrapper(){const e=new fn;e.set(Ke.EMPTY,this.emptyCoords.length),e.set(Ke.DARK,this.darkCoords.length+this.deadLightCoords.length),e.set(Ke.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),e.put(this.color.nonTerritory(),0);const t=e.filter((n,i)=>i>0);return L.assert(1===t.size(),"Can't call getWrapper on non-mono-wrapped group"),t.getAnyPair().get().key}getNeighborsEntryPoints(){const e=[];return this.color!==Ke.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==Ke.DARK&&this.darkCoords.length>0&&e.push(this.darkCoords[0]),this.color!==Ke.LIGHT&&this.lightCoords.length>0&&e.push(this.lightCoords[0]),this.color!==Ke.DEAD_DARK&&this.deadDarkCoords.length>0&&e.push(this.deadDarkCoords[0]),this.color!==Ke.DEAD_LIGHT&&this.deadLightCoords.length>0&&e.push(this.deadLightCoords[0]),e}}class yd extends VI{getNewInstance(e){return new iLe(e,[],[],[],[],[])}getDirections(){return Ie.ORTHOGONALS}}let Md=(()=>class r{static ILLEGAL_KO=()=>$localize`This move is a ko, you must play somewhere else before you can play in this intersection again.`;static CANNOT_PASS_AFTER_PASSED_PHASE=()=>$localize`We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn.`;static CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=()=>$localize`You cannot accept before the counting phase.`;static OCCUPIED_INTERSECTION=()=>$localize`This intersection is already occupied.`;static CANNOT_COMMIT_SUICIDE=()=>$localize`You cannot commit suicide.`})();var vn;let Ba=class extends Da{static#e=vn=this;static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new po({name:()=>$localize`19 x 19`,config:{width:new g1(19,Wi.WIDTH,h1.range(1,99)),height:new g1(19,Wi.HEIGHT,h1.range(1,99)),handicap:new g1(0,()=>$localize`Handicap`,h1.range(0,9))}},[{name:()=>$localize`13 x 13`,config:{width:13,height:13,handicap:0}},{name:()=>$localize`9 x 9`,config:{width:9,height:9,handicap:0}}]);static get(){return vn.singleton.isAbsent()&&(vn.singleton=h.of(new vn)),vn.singleton.get()}getInitialState(e){const t=e.get(),n=kr.getStartingBoard(t);let i=0;const o=E2.getHorizontalLeft(t.width),s=E2.getHorizontalRight(t.width),a=E2.getVerticalUp(t.height),c=E2.getVerticalDown(t.height),l=E2.getHorizontalCenter(t.width),u=E2.getVerticalCenter(t.height),f=[new _(o,a),new _(s,c),new _(s,a),new _(o,c),new _(l,u),new _(l,a),new _(l,c),new _(o,u),new _(s,u)];1<=t.handicap&&(i=1);for(let g=0;g<t.handicap;g++){const y=f[g];n[y.y][y.x]=Ke.DARK}return new kr(n,we.of(0,0),i,h.empty(),Cn.PLAYING)}static isLegal(e,t){if(vn.isPass(e)){const n=t.phase===Cn.PLAYING,i=t.phase===Cn.PASSED;return Ne.display("GoRules","isLegal","at "+t.phase+(n||i?" forbid":" allowed")+" passing on "+t.getCopiedBoard()),n||i?X.success([]):X.failure(Md.CANNOT_PASS_AFTER_PASSED_PHASE())}return vn.isAccept(e)?t.phase===Cn.COUNTING||t.phase===Cn.ACCEPT?X.success([]):X.failure(Md.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE()):vn.isOccupied(e.coord,t.getCopiedBoard())?(Ne.display("GoRules","isLegal","move is marking"),vn.isLegalDeadMarking(e,t)?X.success([]):X.failure(Md.OCCUPIED_INTERSECTION())):(Ne.display("GoRules","isLegal","move is normal stuff: "+e.toString()),vn.isLegalNormalMove(e,t))}static getNewKo(e,t,n){if(1===n.length){const i=n[0],o=e.coord,s=t[o.y][o.x],c=(new yd).getGroupDatas(o,t),l=c.emptyCoords,u=Ke.pieceBelongTo(s,O.ZERO)?c.darkCoords:c.lightCoords;if(1===l.length&&l[0].equals(i)&&1===u.length)return h.of(i)}return h.empty()}static markTerritoryAndCount(e){const t=e.getCopiedBoard(),n=vn.getTerritoryLikeGroup(e),i=e.getCapturedCopy();for(const o of n){const s=o.getWrapper();if(s===Ke.LIGHT){i.add(O.ONE,o.emptyCoords.length);for(const a of o.getCoords())t[a.y][a.x]=Ke.LIGHT_TERRITORY}else{L.assert(s===Ke.DARK,"territory should be wrapped by dark or light, not by "+s.toString()),i.add(O.ZERO,o.emptyCoords.length);for(const a of o.getCoords())t[a.y][a.x]=Ke.DARK_TERRITORY}}return new kr(t,i,e.turn,e.koCoord,e.phase)}static removeAndSubstractTerritory(e){const t=e.getCopiedBoard(),n=e.getCapturedCopy();for(const i of e.getCoordsAndContents()){const o=i.coord;if(i.content.isTerritory()){t[o.y][o.x]=Ke.EMPTY;const s=i.content.getOwner();n.add(s,-1)}}return new kr(t,n,e.turn,e.koCoord,e.phase)}static getEmptyZones(e){return vn.getGroupsDatasWhere(e.getCopiedBoard(),t=>t.isEmpty())}static getGroupsDatasWhere(e,t){const n=[];let i,o,s;const a=new yd;for(let c=0;c<e.length;c++)for(let l=0;l<e[0].length;l++)i=new _(l,c),s=e[c][l],t(s)&&!1===n.some(u=>u.selfContains(i))&&(o=a.getGroupDatas(i,e),n.push(o));return n}static addDeadToScore(e){const t=e.getCapturedCopy();let o,n=t.get(O.ONE),i=t.get(O.ZERO);for(let s=0;s<e.getHeight();s++)for(let a=0;a<e.getWidth();a++)o=e.getPieceAtXY(a,s),o===Ke.DEAD_DARK?n++:o===Ke.DEAD_LIGHT&&i++;return[i,n]}static switchAliveness(e,t){const n=t.getCopiedBoard();L.assert(n[e.y][e.x].isOccupied(),"Can't switch emptyness aliveness");const s=(new yd).getGroupDatas(e,n),a=t.getCapturedCopy();switch(s.color){case Ke.DEAD_DARK:a.add(O.ONE,-2*s.deadDarkCoords.length);for(const c of s.deadDarkCoords)n[c.y][c.x]=Ke.DARK;break;case Ke.DEAD_LIGHT:a.add(O.ZERO,-2*s.deadLightCoords.length);for(const c of s.deadLightCoords)n[c.y][c.x]=Ke.LIGHT;break;case Ke.LIGHT:a.add(O.ZERO,2*s.lightCoords.length);for(const c of s.lightCoords)n[c.y][c.x]=Ke.DEAD_LIGHT;break;default:L.expectToBe(s.color,Ke.DARK),a.add(O.ONE,2*s.darkCoords.length);for(const c of s.darkCoords)n[c.y][c.x]=Ke.DEAD_DARK}return new kr(n,a,t.turn,t.koCoord,t.phase)}static getGameStatus(e){const t=e.gameState;if(t.phase===Cn.FINISHED){const n=t.captured.get(O.ZERO),i=t.captured.get(O.ONE);return i<n?ve.ZERO_WON:n<i?ve.ONE_WON:ve.DRAW}return ve.ONGOING}static isPass(e){return e.equals(Yr.PASS)}static isAccept(e){return e.equals(Yr.ACCEPT)}static isLegalDeadMarking(e,t){return vn.isOccupied(e.coord,t.getCopiedBoard())&&(t.phase===Cn.COUNTING||t.phase===Cn.ACCEPT)}static isLegalNormalMove(e,t){const n=t.getCopiedBoard();if(vn.isKo(e,t))return X.failure(Md.ILLEGAL_KO());[Cn.COUNTING,Cn.ACCEPT].includes(t.phase)&&(t=vn.resurrectStones(t));const i=vn.getCaptureState(e,t);if(hJ.isCapturing(i))return X.success(i.capturedCoords);{n[e.coord.y][e.coord.x]=t.turn%2==0?Ke.DARK:Ke.LIGHT;const a=0===(new yd).getGroupDatas(e.coord,n).emptyCoords.length;return n[e.coord.y][e.coord.x]=Ke.EMPTY,a?X.failure(Md.CANNOT_COMMIT_SUICIDE()):X.success([])}}static isOccupied(e,t){return t[e.y][e.x].isOccupied()}static isKo(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}static getCaptureState(e,t){const n=new hJ;let i;for(const o of Ie.ORTHOGONALS)i=vn.getCapturedInDirection(e.coord,o,t),i.length>0&&n.capturedCoords.every(s=>!1===i[0].equals(s))&&(n.capturedCoords=n.capturedCoords.concat(i));return n}static getCapturedInDirection(e,t,n){const i=n.getCopiedBoard(),o=e.getNext(t);if(o.isInRange(n.getWidth(),n.getHeight())&&i[o.y][o.x]===(n.turn%2==0?Ke.LIGHT:Ke.DARK)){Ne.display("GoRules","getCapturedInDirection","a group could be captured");const c=(new yd).getGroupDatas(o,i);if(vn.isCapturableGroup(c,n.koCoord))return Ne.display("GoRules","getCapturedInDirection",{neightbooringGroupCoord:c.getCoords(),message:"is capturable"}),c.getCoords()}return[]}static isCapturableGroup(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}static getTerritoryLikeGroup(e){return vn.getEmptyZones(e).filter(n=>n.isMonoWrapped())}static applyPass(e){const t=e.getCopiedBoard(),n=e.getCapturedCopy(),i=e.turn;let o,s;return e.phase===Cn.PASSED?(o=Cn.COUNTING,s=new kr(t,n,i+1,h.empty(),o),s=vn.markTerritoryAndCount(s)):(L.assert(e.phase===Cn.PLAYING,"Cannot pass in counting phase!"),o=Cn.PASSED,s=new kr(t,n,i+1,h.empty(),o)),s}static applyLegalAccept(e){const t=e.getCopiedBoard();let n;return n=e.phase===Cn.COUNTING?Cn.ACCEPT:Cn.FINISHED,new kr(t,e.getCapturedCopy(),e.turn+1,h.empty(),n)}static applyNormalLegalMove(e,t,n){let i;i=[Cn.COUNTING,Cn.ACCEPT].includes(t.phase)?vn.resurrectStones(t):t.copy();const o=e.coord.x,s=e.coord.y,a=i.getCopiedBoard(),c=i.turn,l=i.getCurrentPlayer(),u=Ke.ofPlayer(l),f=c+1;a[s][o]=u;for(const S of n)a[S.y][S.x]=Ke.EMPTY;const g=vn.getNewKo(e,a,n),y=i.getCapturedCopy();return y.add(l,n.length),new kr(a,y,f,g,Cn.PLAYING)}static resurrectStones(e){for(let t=0;t<e.getHeight();t++)for(let n=0;n<e.getWidth();n++)e.getPieceAtXY(n,t).isDead()&&(e=vn.switchAliveness(new _(n,t),e));return vn.removeAndSubstractTerritory(e)}static applyDeadMarkingMove(e,t){const n=vn.removeAndSubstractTerritory(t),i=vn.switchAliveness(e.coord,n),o=new kr(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,h.empty(),Cn.COUNTING);return vn.markTerritoryAndCount(o)}isLegal(e,t){return vn.isLegal(e,t)}applyLegalMove(e,t,n,i){return vn.isPass(e)?(Ne.display("GoRules","applyLegalMove","isPass"),vn.applyPass(t)):vn.isAccept(e)?(Ne.display("GoRules","applyLegalMove","isAccept"),vn.applyLegalAccept(t)):vn.isLegalDeadMarking(e,t)?(Ne.display("GoRules","applyLegalMove","isDeadMarking"),vn.applyDeadMarkingMove(e,t)):(Ne.display("GoRules","applyLegalMove","else it is normal move"),vn.applyNormalLegalMove(e,t,i))}getGameStatus(e){return vn.getGameStatus(e)}getRulesConfigDescription(){return h.of(vn.RULES_CONFIG_DESCRIPTION)}};Ba=vn=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],Ba);class hJ{capturedCoords=[];static isCapturing(e){return e.capturedCoords.length>0}}const Xe=Ke.LIGHT,Be=Ke.DARK,HI=Ke.DEAD_LIGHT,fu=Ke.LIGHT_TERRITORY,oa=Ke.DARK_TERRITORY,ce=Ke.EMPTY,sLe=Ba.get().getDefaultRulesConfig();class aLe extends Bn{tutorial=[q.informational($localize`Preliminary information`,$localize`The game of Go is played on a board called a Goban, and the stones are placed on the intersections.
        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.
        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).
        For this tutorial, we will use a smaller board for pedagogical purposes.`,Ba.get().getInitialState(sLe)),q.informational($localize`Goal of the game`,$localize`The goal of the game is to have the most points at the end of the game.
        We call "territories" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.
        Here, Dark has 9 territories on the left, and Light has 8 on the right.
        The top part belongs to no one.
        Each player's score at the end of the game is the sum of that player's territories and captures.`,new kr([[ce,Be,ce,ce,Xe,Xe],[ce,Be,ce,ce,Xe,ce],[ce,Be,Be,Xe,Xe,ce],[ce,ce,Be,Xe,ce,ce],[ce,ce,Be,Xe,ce,ce],[ce,ce,Be,Xe,ce,ce]],we.of(0,0),0,h.empty(),Cn.PLAYING)),q.fromMove($localize`Simple capture`,$localize`An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).
        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.
        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>
        You're playing Dark. The light piece on the board only has one liberty left, play there.`,new kr([[ce,ce,ce,ce,ce],[ce,ce,Be,ce,ce],[ce,Be,Xe,ce,ce],[ce,ce,Be,ce,ce],[ce,ce,ce,ce,ce]],we.of(0,0),0,h.empty(),Cn.PLAYING),[new Yr(3,2)],$localize`Congratulations, you have earned one point.`,$localize`Failed, try again by playing on one of the intersections directly next to the light stone.`),q.fromMove($localize`Capturing multiple stones`,$localize`Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>
        You're playing Dark. The light group here only has one liberty left, capture it.`,new kr([[ce,Be,ce,ce,ce],[Be,Xe,ce,ce,ce],[Be,Xe,Xe,Be,ce],[ce,Be,Be,ce,ce],[ce,ce,ce,ce,ce]],we.of(0,0),0,h.empty(),Cn.PLAYING),[new Yr(2,1)],$localize`Congratulations, you have earned three points and formed a territory.`,$localize`Failed, you have not captured the group. Play on the last liberty of that group.`),q.informational($localize`Suicide`,$localize`In Go, suicide is forbidden.
        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.
        Here, the top left intersection is a suicide for Light.
        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player.`,new kr([[ce,Be,ce,ce,ce],[Be,ce,ce,ce,ce],[Be,ce,ce,ce,Xe],[Xe,Be,ce,Xe,ce],[ce,Xe,ce,Xe,Be]],we.of(0,0),0,h.empty(),Cn.PLAYING)),q.informational($localize`Life and death (death)`,$localize`From the capture rule follows the life and death notion:
        dead stones are stones that are definitely capturable (without losing anything else).
        Alive stones are stones that can never be captured.
        From the capture rule, Dark can play inside Light's territory and make a capture.
        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).
        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories.`,new kr([[ce,ce,ce,ce,ce],[Be,Be,Be,ce,ce],[Xe,Xe,Be,ce,ce],[ce,Xe,Be,ce,ce],[Xe,Xe,Be,ce,ce]],we.of(0,0),0,h.empty(),Cn.PLAYING)),q.informational($localize`Life and death (eyes)`,$localize`Here, Light cannot play on the top left, nor on the bottom left.
        Light will never be able to capture Dark.
        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive.`,new kr([[ce,Be,Xe,ce,ce],[Xe,Be,Xe,ce,ce],[Be,Be,Xe,ce,ce],[Xe,Be,Xe,ce,ce],[ce,Be,Xe,ce,ce]],we.of(0,0),0,h.empty(),Cn.PLAYING)),q.informational($localize`Seki`,$localize`If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.
        Similarly, if Light plays on the middle line, Dark will capture Light.
        In other words, there is no point in playing on the middle line.
        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral.`,new kr([[ce,Xe,Be,ce,Xe,Be,ce],[ce,Xe,Be,Be,Xe,Be,ce],[ce,Xe,Be,Be,Xe,Be,ce],[ce,Xe,Be,Be,Xe,Be,ce],[ce,Xe,Be,Xe,Xe,Be,ce],[ce,Xe,Be,Xe,Xe,Be,ce],[ce,Xe,Be,ce,Xe,Be,ce]],we.of(0,0),0,h.empty(),Cn.PLAYING)),q.fromMove($localize`Ko`,$localize`A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>
        You're playing Dark, capture the light stone.`,new kr([[ce,ce,ce,ce,ce,ce,ce],[ce,ce,ce,ce,ce,ce,ce],[ce,ce,ce,Be,Xe,ce,ce],[ce,ce,Be,Xe,ce,Xe,ce],[ce,ce,ce,Be,Xe,ce,ce],[ce,ce,ce,ce,ce,ce,ce],[ce,ce,ce,ce,ce,ce,ce]],we.of(0,0),0,h.empty(),Cn.PLAYING),[new Yr(4,3)],$localize`Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.
        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.
        This rule is called the Ko.
        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after.`,pe.FAILED_TRY_AGAIN()),q.fromMove(pe.END_OF_THE_GAME(),$localize`When a player feels that there is no advantage to putting a new stone, that player can pass a turn.
        The game phase stops when both players pass consecutively, and we move on to the counting phase.
        The dead groups are then marked by clicking on them.
        Every intersection in a player's territory earns that player a point.
        The winner is the one with most points.<br/><br/>
        You're playing Dark. A last stone is dead, mark it.`,new kr([[Xe,Be,Be,Be,Be,Be,oa,oa,oa],[Xe,Xe,Xe,Xe,Be,Be,Be,oa,oa],[Xe,fu,Xe,Xe,Be,HI,HI,Be,oa],[Be,Xe,Xe,Xe,Xe,Be,oa,oa,oa],[ce,Xe,fu,Xe,Be,Be,HI,Be,oa],[Xe,fu,Xe,Xe,Be,Be,Be,Be,Be],[Xe,Xe,Be,Be,Be,Xe,Xe,Be,Xe],[Be,Be,Be,Xe,Xe,Xe,fu,Xe,Xe],[oa,oa,Be,Be,Be,Xe,Xe,fu,fu]],we.of(0,0),0,h.empty(),Cn.COUNTING),[new Yr(0,3)],$localize`Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.
        The intersections where the prisoners are count as Dark's territory
        Light has 8 territories and 1 prisoner.
        The end result is therefore 18 - 9 for Dark.`,pe.FAILED_TRY_AGAIN())]}class cLe extends or{getMetrics(e,t){const n=Ba.markTerritoryAndCount(e.gameState),i=n.getCapturedCopy(),o=this.getDeadStones(n);return U1.ofSingle(i.get(O.ZERO)+2*o.get(O.ONE),i.get(O.ONE)+2*o.get(O.ZERO))}getDeadStones(e){const t=we.of(0,0);for(const n of e.getCoordsAndContents()){const i=n.content;"dead"===i.type&&t.add(i.player,1)}return t}}let TC=class extends Yn{getListMoves(e,t){const n=e.gameState,i=this.getPlayingMovesList(n);if(n.phase===Cn.PLAYING||n.phase===Cn.PASSED)return i.push(Yr.PASS),i;{const o=this.getCountingMovesList(n);return 0===o.length?[Yr.ACCEPT]:o}}getPlayingMovesList(e){const t=[];let n;for(const i of e.getCoordsAndContents()){const o=i.coord,s=i.content;n=new Yr(o.x,o.y),s===Ke.EMPTY&&Ba.isLegal(n,e).isSuccess()&&t.push(n)}return t}getCountingMovesList(e){const t=[],n=this.getCorrectBoard(e).getCopiedBoard(),i=Ba.getGroupsDatasWhere(n,o=>o!==Ke.EMPTY);for(const o of i){const s=o.getCoords()[0],a=n[s.y][s.x];if(e.getPieceAt(s)!==a){const l=new Yr(s.x,s.y);return t.push(l),t}}return t}getCorrectBoard(e){const n=this.mapBoard(e.getCopiedBoard(),s=>s===Ke.DARK?Ke.DEAD_DARK:s===Ke.LIGHT?Ke.DEAD_LIGHT:s.isTerritory()?Ke.EMPTY:s),i=new kr(n,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),o=Ba.getTerritoryLikeGroup(i);return this.setAliveUniqueWrapper(i,o)}mapBoard(e,t){const n=[];for(let i=0;i<e.length;i++){n[i]=[];for(let o=0;o<e[0].length;o++)n[i][o]=t(e[i][o])}return n}setAliveUniqueWrapper(e,t){let i,n=e.copy();for(const o of t){i=o.deadDarkCoords.concat(o.deadLightCoords);for(const s of i)n.isDead(s)&&(n=Ba.switchAliveness(s,n))}return n}};function fLe(r,e){if(1&r&&(N(),V(0,"circle",11)),2&r){const t=p(2).$implicit,n=p();w("cx",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.coord.x)("cy",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.coord.y)("r",.44*n.SPACE_SIZE)}}function dLe(r,e){if(1&r){const t=de();N(),M(0,"line",12),W("click",function(){te(t);const i=p(2).$implicit;return ne(p().onClick(i.coord))}),P()}if(2&r){const t=p(2).$implicit,n=p();w("x1",n.SPACE_SIZE*t.coord.x)("y1",n.SPACE_SIZE*t.coord.y)("x2",n.SPACE_SIZE+n.SPACE_SIZE*t.coord.x)("y2",n.SPACE_SIZE+n.SPACE_SIZE*t.coord.y)}}function hLe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"circle",8),W("click",function(){te(t);const i=p().$implicit;return ne(p().onClick(i.coord))}),P(),z(2,fLe,1,3,"circle",9)(3,dLe,1,4,"line",10),P()}if(2&r){const t=p().$implicit,n=p();m(),v("ngClass",n.getSpaceClass(t.coord)),w("cx",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.coord.x)("cy",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.coord.y)("r",.44*n.SPACE_SIZE),m(),v("ngIf",n.isLastSpace(t.coord)),m(),v("ngIf",n.isDead(t.coord))}}function gLe(r,e){if(1&r){const t=de();N(),M(0,"circle",14),W("click",function(){te(t);const i=p(2).$implicit;return ne(p().onClick(i.coord))}),P()}if(2&r){const t=p(2).$implicit,n=p();w("cx",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.coord.x)("cy",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.coord.y)("r",.2*n.SPACE_SIZE)("class",t.content===n.GoPiece.LIGHT_TERRITORY?"player1-fill":"player0-fill")}}function pLe(r,e){if(1&r&&(N(),z(0,gLe,1,4,"circle",13)),2&r){const t=p().$implicit;v("ngIf",p().isTerritory(t.coord))}}function mLe(r,e){if(1&r&&(N(),M(0,"g"),z(1,hLe,4,6,"g",6)(2,pLe,1,1,"ng-template",null,7,wn),P()),2&r){const t=e.$implicit,n=Pn(3),i=p();m(),v("ngIf",i.spaceIsFull(t.coord))("ngIfElse",n)}}function _Le(r,e){if(1&r&&(N(),V(0,"rect",15)),2&r){const t=p();w("width",.5*t.SPACE_SIZE)("height",.5*t.SPACE_SIZE)("x",.25*t.SPACE_SIZE+t.SPACE_SIZE*t.ko.get().x)("y",.25*t.SPACE_SIZE+t.SPACE_SIZE*t.ko.get().y)}}function CLe(r,e){if(1&r){const t=de();N(),M(0,"circle",16),W("click",function(){const o=te(t).$implicit;return ne(p().onClick(o))}),P()}if(2&r){const t=e.$implicit,n=p();w("cx",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.x)("cy",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.y)("r",.14*n.SPACE_SIZE)}}TC=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],TC);let AC=class _R extends bI{boardInfo;ko=h.empty();last=h.empty();captures=[];GoPiece=Ke;constructor(e){super(e),this.setRulesAndNode("Go"),this.availableAIs=[new cn($localize`Minimax`,Ba.get(),new cLe,new TC),new kn($localize`MCTS`,new TC,this.rules)],this.encoder=Yr.encoder,this.canPass=!0,this.scores=h.of(we.of(0,0))}showLastMove(e){var t=this;return E(function*(){t.last=h.of(e.coord),t.showCaptures()})()}hideLastMove(){this.captures=[],this.last=h.empty()}onClick(e){var t=this;return E(function*(){const n=e.x,i=e.y,o=yield t.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return t.cancelMove(o.getReason());t.last=h.empty();const s=new Yr(n,i);return t.chooseMove(s)})()}updateBoard(e){var t=this;return E(function*(){const n=t.getState(),i=n.phase;t.board=n.getCopiedBoard(),t.scores=h.of(n.getCapturedCopy()),t.ko=n.koCoord,t.canPass=i!==Cn.FINISHED,t.createHoshis()})()}showCaptures(){const e=this.getPreviousState();this.captures=[];for(let t=0;t<this.getHeight();t++)for(let n=0;n<this.getWidth();n++){const i=new _(n,t),o=e.getPieceAt(i).isOccupied(),s=this.board[t][n]===Ke.EMPTY,a=!1===this.ko.equalsValue(i);o&&s&&a&&this.captures.push(i)}}pass(){var e=this;return E(function*(){const t=e.getState().phase;return t===Cn.PLAYING||t===Cn.PASSED?e.onClick(Yr.PASS.coord):(L.assert(t===Cn.COUNTING||t===Cn.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(Yr.ACCEPT.coord))})()}getSpaceClass(e){const n=this.getState().getPieceAt(e);return this.getPlayerClass(n.getOwner())}spaceIsFull(e){return this.getState().getPieceAt(e)!==Ke.EMPTY&&!1===this.isTerritory(e)}isLastSpace(e){return this.last.equalsValue(e)}isDead(e){return this.getState().isDead(e)}isTerritory(e){return this.getState().isTerritory(e)}static \u0275fac=function(t){return new(t||_R)(G(Ut))};static \u0275cmp=$e({type:_R,selectors:[["app-go"]],features:[We],decls:6,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["app-blank-goban","",3,"width","height","clickCallBack"],["id","piece_ko_territory_markers_and_dead_stones"],[4,"ngFor","ngForOf"],["class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured-fill",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base",3,"ngClass","click"],["class","base no-fill last-move-stroke",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","captured-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],[1,"captured-stroke","mid-stroke","no-fill"],[1,"captured-fill",3,"click"]],template:function(t,n){1&t&&(N(),M(0,"svg",0)(1,"g",1),W("clickCallBack",function(o){return n.onClick(o)}),P(),M(2,"g",2),z(3,mLe,4,2,"g",3),P(),z(4,_Le,1,4,"rect",4)(5,CLe,1,3,"circle",5),P()),2&t&&(w("viewBox",n.getViewBox().toSVGString()),m(),v("width",n.getState().getWidth())("height",n.getState().getHeight()),m(2),v("ngForOf",n.getState().getCoordsAndContents()),m(),v("ngIf",n.ko.isPresent()),m(),v("ngForOf",n.captures))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})};AC=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],AC);const xn=Ee.UNREACHABLE,tt=Ee.EMPTY,cr=Ee.ZERO,qc=Ee.ONE;class vLe extends Bn{tutorial=[q.informational($localize`Goal of the game`,$localize`The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.
        This is the initial board.
        Each player has 12 pieces on the side and 3 pieces on the board.
        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.
        The first player plays with the dark pieces, the second player plays with the light pieces.`,nn.get().getInitialState()),q.anyMove($localize`Pushing`,$localize`Pieces can only enter the board through the edges. To insert a new piece:
        <ol>
            <li>Click on a space on the edge of the board.</li>
            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>
        </ol>
        You cannot push when a line is full.<br/><br/>
        You're playing Dark, insert a piece.`,nn.get().getInitialState(),new Ga(new ra(new _(3,0),h.of(Se.DOWN)),[],[]),pe.CONGRATULATIONS()),q.fromMove($localize`Captures (1/3)`,$localize`To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.
        There are multiple important aspects of a capture:
        <ol>
            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>
            <li>As soon as there is an empty space on the line, the capture stops.</li>
            <li>Your own pieces that are captured go back to your stock.
                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>
            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.
                This means that a turn happens in three phases:
                <ol type="A">
                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>
                    <li>Make your insertion.</li>
                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>
                </ol>
            </li>
        </ol><br/>
        You're playing Dark, you can make a capture, do it.`,new i4([[xn,xn,xn,cr,qc,tt,tt],[xn,xn,tt,tt,tt,tt,tt],[xn,tt,tt,tt,tt,tt,tt],[cr,cr,cr,tt,tt,tt,tt],[qc,tt,tt,tt,tt,tt,xn],[tt,tt,tt,qc,tt,xn,xn],[tt,tt,tt,qc,xn,xn,xn]],42,we.of(8,8),we.of(0,0)),[new Ga(new ra(new _(0,3),h.of(Se.RIGHT)),[],[new Ki([new _(0,3),new _(1,3),new _(2,3),new _(3,3)])])],$localize`Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.
        Let's now see how captures can really be useful.`,pe.FAILED_TRY_AGAIN()),q.fromMove($localize`Captures (2/3)`,$localize`Here, there are three different ways for Dark to capture.
        <ol>
          <li>One way does not capture any of your opponent's pieces.</li>
          <li>Another way captures one of your opponent's pieces.</li>
          <li>The last way captures two of your opponent's pieces.</li>
        </ol>
        <br/>
        You're playing Dark, capture the most pieces from your opponent.`,new i4([[xn,xn,xn,tt,tt,tt,tt],[xn,xn,tt,qc,tt,tt,tt],[xn,tt,tt,cr,tt,tt,tt],[cr,cr,cr,qc,tt,tt,tt],[tt,tt,tt,cr,tt,tt,xn],[tt,tt,tt,cr,tt,xn,xn],[tt,tt,tt,qc,xn,xn,xn]],42,we.of(8,4),we.of(2,3)),[new Ga(new ra(new _(0,3),h.of(Se.RIGHT)),[],[new Ki([new _(3,1),new _(3,2),new _(3,3),new _(3,4),new _(3,5),new _(3,6)])])],$localize`Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.
        The most you can get is 3 per capture.`,$localize`Failed, the best capture was taking 2 of your opponent's pieces`),q.fromMove($localize`Captures (3/3)`,$localize`Here, you must capture at the beginning of your turn.
        This is due to a move of your opponent at the previous turn
        (even though this is a fictitious board for pedagogical purpose).
        After your capture, by performing the right move you can even capture two more of your opponent's pieces!
        Keep it mind that the most useful in a capture is to take your opponent's pieces.<br/><br/>
        You're playing Dark, capture the most pieces from your opponent.`,new i4([[xn,xn,xn,cr,tt,tt,cr],[xn,xn,tt,cr,tt,tt,cr],[xn,cr,cr,tt,cr,qc,cr],[tt,tt,tt,cr,tt,tt,cr],[tt,tt,tt,cr,tt,tt,xn],[cr,cr,cr,qc,qc,xn,xn],[tt,tt,tt,cr,xn,xn,xn]],42,we.of(3,4),we.of(2,3)),[new Ga(new ra(new _(3,6),h.of(Se.UP)),[new Ki([new _(6,0),new _(6,1),new _(6,2),new _(6,3)])],[new Ki([new _(0,5),new _(1,5),new _(2,5),new _(3,5),new _(4,5)]),new Ki([new _(1,2),new _(2,2),new _(3,2),new _(4,2),new _(5,2)])]),new Ga(new ra(new _(4,6),h.of(Se.UP)),[new Ki([new _(6,0),new _(6,1),new _(6,2),new _(6,3)])],[new Ki([new _(0,5),new _(1,5),new _(2,5),new _(3,5),new _(4,5)]),new Ki([new _(3,0),new _(3,1),new _(3,2),new _(3,3),new _(3,4)])]),new Ga(new ra(new _(3,6),h.of(Se.UP)),[new Ki([new _(6,0),new _(6,1),new _(6,2),new _(6,3)])],[new Ki([new _(1,2),new _(2,2),new _(3,2),new _(4,2),new _(5,2)]),new Ki([new _(0,5),new _(1,5),new _(2,5),new _(3,5),new _(4,5)])])],$localize`Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces.`,$localize`Failed, the best capture takes 2 of your opponent's pieces.`)]}let Cr=(()=>class r{static CANNOT_DROP_PIECE_YOU_DONT_HAVE=()=>"You cannot drop a piece that you do not have in your reserve.";static QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS=()=>$localize`The queen bee can only move to one of its direct neighbors.`;static BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS=()=>$localize`The beetle can only move to one of its direct neighbors.`;static GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE=()=>$localize`The grasshopper must move in a straight line.`;static GRASSHOPPER_MUST_JUMP_OVER_PIECES=()=>$localize`The grasshopper must jump over other pieces, without any empty spaces.`;static SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES=()=>$localize`The spider must move on neighboring spaces.`;static SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT=()=>$localize`The spider can only move around pieces that are in direct contact with it.`;static SPIDER_CANNOT_BACKTRACK=()=>$localize`The spider cannot go twice through the same space in the same move.`;static QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE=()=>$localize`The queen bee must be placed on the board before moving a piece.`;static THIS_PIECE_CANNOT_CLIMB=()=>$localize`Only the beetle is allowed to climb over other pieces.`;static CANNOT_DISCONNECT_HIVE=()=>$localize`You are not allowed to split the hive.`;static MUST_BE_ABLE_TO_SLIDE=()=>$localize`This piece must be able to slide to its destination.`;static MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN=()=>$localize`You must place your queen bee at this turn!`;static CANNOT_DROP_NEXT_TO_OPPONENT=()=>$localize`You cannot drop a piece next to one of your opponent's stack.`;static MUST_DROP_ON_EMPTY_SPACE=()=>$localize`You must always drop your piece on an empty space.`;static MUST_BE_CONNECTED_TO_HIVE=()=>$localize`The piece you are dropping must be connected to the hive.`})();const yLe=ke.fromFunctions(r=>r,r=>r);class li{owner;kind;static encoder=ke.tuple([O.encoder,yLe],e=>[e.owner,e.kind],e=>new li(e[0],e[1]));constructor(e,t){this.owner=e,this.kind=t}toString(){return`${this.kind}_${this.owner.toString()}`}equals(e){return this.owner===e.owner&&this.kind===e.kind}}class o4{pieces;static EMPTY=new o4([]);constructor(e){this.pieces=e}equals(e){return this.size()===e.size()&&yt.equals(this.pieces,e.pieces)}isEmpty(){return 0===this.pieces.length}hasPieces(){return!1===this.isEmpty()}add(e){return new o4([e,...this.pieces])}topPiece(){return L.assert(this.hasPieces(),"HivePieceStack: cannot get top piece of an empty stack"),this.pieces[0]}removeTopPiece(){const e=[...this.pieces];return e.shift(),new o4(e)}size(){return this.pieces.length}}class Wa extends Nr{piece;static encoder=ke.tuple([li.encoder,_.encoder],e=>[e.piece,e.coord],e=>new Wa(e[0],e[1].x,e[1].y));static of(e,t){return new Wa(e,t.x,t.y)}constructor(e,t,n){super(t,n),this.piece=e}toString(){return`HiveDrop(${this.piece.toString()}, ${this.coord.toString()})`}equals(e){return e instanceof Wa&&this.piece.equals(e.piece)&&this.coord.equals(e.coord)}}class Co extends Do{static encoder=q2.getFallibleEncoder(Co.from);static from(e,t){return e.equals(t)?X.failure(Me.MOVE_CANNOT_BE_STATIC()):X.success(new Co(e,t))}constructor(e,t){super(e,t)}toString(){return`HiveMoveCoordToCoord(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(e){return!(e instanceof jc)&&e instanceof Co&&this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}class jc extends Co{coords;static encoder=ke.tuple([_.encoder,_.encoder,_.encoder,_.encoder],e=>e.coords,e=>new jc(e));static ofCoords(e){return new jc(e)}constructor(e){super(e[0],e[3]),this.coords=e}toString(){return`HiveMoveSpider(${this.coords.map(t=>t.toString()).join(", ")})`}equals(e){return e instanceof jc&&this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}class du extends C2{static encoder=ke.constant("HiveMovePass",new du);toString(){return"HiveMovePass"}equals(e){return e instanceof du}}function MLe(r){return r instanceof Wa}function ELe(r){return r instanceof jc}function PLe(r){return r instanceof Co}function SLe(r){return r instanceof du}var Ni;!function(r){r.PASS=new du,r.drop=function e(i,o){return Wa.of(i,o)},r.move=function t(i,o){return Co.from(i,o)},r.spiderMove=function n(i){return jc.ofCoords(i)},r.encoder=ke.disjunction([MLe,ELe,PLe,SLe],[Wa.encoder,jc.encoder,Co.encoder,du.encoder])}(Ni||(Ni={}));class qa{static INSTANCES=h.empty();static of(e){return qa.INSTANCES.isAbsent()&&(qa.INSTANCES=h.of({QueenBee:FI.get(),Beetle:UI.get(),Grasshopper:$I.get(),Spider:bC.get(),SoldierAnt:GI.get()})),qa.INSTANCES.get()[e.kind]}checkEmptyDestination(e,t){return t.getAt(e.getEnd()).hasPieces()?A.failure(Cr.THIS_PIECE_CANNOT_CLIMB()):A.SUCCESS}canSlideBetweenNeighbors(e,t,n){const i=new ct(bi.getNeighbors(t)),o=new ct(bi.getNeighbors(n)),s=i.intersection(o);for(const a of s)if(e.getAt(a).isEmpty())return!0;return!1}}class FI extends qa{static INSTANCE=h.empty();static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=h.of(new FI)),this.INSTANCE.get()}moveValidity(e,t){return!1===bi.areNeighbors(e.getStart(),e.getEnd())?A.failure(Cr.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):!1===this.canSlideBetweenNeighbors(t,e.getStart(),e.getEnd())?A.failure(Cr.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=[];for(const i of bi.getNeighbors(e))t.getAt(i).isEmpty()&&n.push(Co.from(e,i).get());return n}}class UI extends qa{static INSTANCE=h.empty();static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=h.of(new UI)),this.INSTANCE.get()}moveValidity(e,t){return!1===bi.areNeighbors(e.getStart(),e.getEnd())?A.failure(Cr.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):A.SUCCESS}getPotentialMoves(e,t){const n=[];for(const i of bi.getNeighbors(e))n.push(Co.from(e,i).get());return n}}class $I extends qa{static INSTANCE=h.empty();static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=h.of(new $I)),this.INSTANCE.get()}moveValidity(e,t){if(Se.factory.fromMove(e.getStart(),e.getEnd()).isFailure())return A.failure(Cr.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE());const i=e.getStart().getCoordsToward(e.getEnd());if(0===i.length)return A.failure(Cr.GRASSHOPPER_MUST_JUMP_OVER_PIECES());for(const o of i)if(t.getAt(o).isEmpty())return A.failure(Cr.GRASSHOPPER_MUST_JUMP_OVER_PIECES());return this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=[];for(const i of Se.factory.all){const o=e.getNext(i);if(t.getAt(o).hasPieces()){let s=o;for(;t.getAt(s).hasPieces();)s=s.getNext(i);n.push(Co.from(e,s).get())}}return n}}class bC extends qa{static INSTANCE=h.empty();static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=h.of(new bC)),this.INSTANCE.get()}prefixLegality(e,t){const n=new ct,i=t.update().setAt(e[0],o4.EMPTY).increaseTurnAndFinalizeUpdate();for(let o=1;o<e.length;o++){if(i.getAt(e[o]).hasPieces())return A.failure(Cr.THIS_PIECE_CANNOT_CLIMB());if(!1===bi.areNeighbors(e[o-1],e[o]))return A.failure(Cr.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES());if(!1===i.haveCommonNeighbor(e[o],e[o-1]))return A.failure(Cr.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT());if(!1===this.canSlideBetweenNeighbors(i,e[o-1],e[o]))return A.failure(Cr.MUST_BE_ABLE_TO_SLIDE());if(n.contains(e[o]))return A.failure(Cr.SPIDER_CANNOT_BACKTRACK());n.add(e[o])}return A.SUCCESS}moveValidity(e,t){L.assert(e instanceof jc,"HiveSpiderRules: move should be a spider move");const i=this.prefixLegality(e.coords,t);return i.isFailure()?i:this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=t.update().setAt(e,o4.EMPTY).increaseTurnAndFinalizeUpdate();let i=[[e]];for(let a=0;a<3;a++)i=i.flatMap(c=>this.nextMoveStep(n,c));return new ct(i.map(function o(a){return jc.ofCoords(a)})).toList()}nextMoveStep(e,t){const n=t[t.length-1];return new ct(bi.getNeighbors(n)).filter(function i(s){return!e.getAt(s).hasPieces()&&void 0===t.find(a=>s.equals(a))&&e.haveCommonNeighbor(s,n)}).toList().map(s=>[...t,s])}}class GI extends qa{static INSTANCE=h.empty();static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=h.of(new GI)),this.INSTANCE.get()}pathExists(e,t,n){const i=new ct,o=[t];for(;o.length>0;){const s=o.pop();if(!i.contains(s)){if(i.add(s),s.equals(n))return!0;for(const a of bi.getNeighbors(s)){const c=e.getAt(a).isEmpty(),l=e.getOccupiedNeighbors(a).size()>0,u=this.canSlideBetweenNeighbors(e,s,a);c&&l&&u&&o.push(a)}}}return!1}moveValidity(e,t){return!1===this.pathExists(t,e.getStart(),e.getEnd())?A.failure(Cr.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=new ct;for(const i of t.occupiedSpaces())if(!i.equals(e))for(const o of t.emptyNeighbors(i))n.add(Co.from(e,o).get());return n.toList()}}class gJ extends mC{pieces;width;height;constructor(e,t){super(t),this.pieces=e;const n=this.computeScale();this.width=n.width,this.height=n.height,this.pieces.makeImmutable()}getPieces(){return this.pieces}getPieceCoords(){return this.pieces.listKeys()}computeScale(){let e=Number.MAX_SAFE_INTEGER,t=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER;for(const o of this.pieces.listKeys())e=Math.min(o.x,e),t=Math.max(o.x,t),n=Math.min(o.y,n),i=Math.max(o.y,i);return{width:t+1-e,height:i+1-n}}isOnBoard(e){return this.pieces.containsKey(e)}getOccupiedNeighbors(e){return new ct(bi.getNeighbors(e)).filter(n=>this.pieces.get(n).isPresent())}getGroups(){const e=new ct,t=new ct;return this.pieces.forEach(n=>{if(!1===e.contains(n.key)){const i=new ct,o=new ct([n.key]);for(;o.hasElements();){const s=o.getAnyElement().get();o.remove(s),e.add(s),i.add(s),o.addAll(this.getOccupiedNeighbors(s).filter(a=>!1===e.contains(a)))}t.add(i)}}),t}}class wC{pieces;static getInitial(){const e=new fn;for(const t of O.PLAYERS)e.set(new li(t,"QueenBee"),1),e.set(new li(t,"Beetle"),2),e.set(new li(t,"Spider"),2),e.set(new li(t,"Grasshopper"),3),e.set(new li(t,"SoldierAnt"),3);return e.makeImmutable(),new wC(e)}constructor(e){this.pieces=e}equals(e){return this.pieces.equals(e.pieces)}getQuantity(e){return this.pieces.get(e).get()}hasRemaining(e){return this.getQuantity(e)>0}getAny(e){for(const t of this.pieces.listKeys())if(t.owner===e&&this.hasRemaining(t))return h.of(t);return h.empty()}remove(e){const t=this.pieces.get(e).get();L.assert(t>0,"HiveRemainingPieces cannot remove a non-remainingPiece");const n=this.pieces.getCopy();return n.replace(e,t-1),new wC(n)}toListOfStacks(){const e=[];return this.pieces.forEach(t=>{const n=[];for(let i=0;i<t.value;i++)n.push(t.key);e.push(new o4(n))}),e}getPlayerPieces(e){const t=[];return this.pieces.forEach(n=>{n.key.owner===e&&n.value>0&&t.push(n.key)}),t}}class Ed{pieces;remainingPieces;queenBees;turn;static of(e){return new Ed(e.pieces,e.remainingPieces,e.queenBees,e.turn)}constructor(e,t,n,i){this.pieces=e,this.remainingPieces=t,this.queenBees=n,this.turn=i}setAt(e,t){const n=this.queenBees.getCopy();for(const o of O.PLAYERS)n.get(o).equalsValue(e)&&n.delete(o);for(const o of t.pieces)"QueenBee"===o.kind&&n.put(o.owner,e);const i=this.pieces.getCopy();return t.isEmpty()?i.delete(e):i.put(e,t),new Ed(i,this.remainingPieces,n,this.turn)}removeRemainingPiece(e){return new Ed(this.pieces,this.remainingPieces.remove(e),this.queenBees,this.turn)}increaseTurnAndFinalizeUpdate(){return new vo(this.pieces,this.remainingPieces,this.queenBees,this.turn+1)}}class vo extends gJ{remainingPieces;queenBees;static fromRepresentation(e,t,n=new $t(0,0)){const i=new Q5;let o=wC.getInitial();const s=new fn;for(let a=0;a<e.length;a++)for(let c=0;c<e[0].length;c++)if(e[a][c].length>0){const l=new _(c,a).getNext(n,1);i.set(l,new o4(e[a][c]));const u=h.ofNullable(e[a][c].find(f=>"QueenBee"===f.kind));u.isPresent()&&s.set(u.get().owner,l);for(const f of e[a][c])o=o.remove(f)}return new vo(i,o,s,t)}constructor(e,t,n,i){super(e,i),this.remainingPieces=t,this.queenBees=n,this.queenBees=n.getCopy();for(const o of n.listKeys()){const s=n.get(o).get();this.queenBees.replace(o,s)}this.queenBees.makeImmutable()}update(){return Ed.of(this)}equals(e){return this.pieces.equals(e.pieces)&&this.remainingPieces.equals(e.remainingPieces)&&this.queenBees.equals(e.queenBees)&&this.turn===e.turn}getAt(e){return this.isOnBoard(e)?this.pieces.get(e).get():o4.EMPTY}queenBeeLocation(e){return this.queenBees.get(e)}hasQueenBeeOnBoard(e){return this.queenBeeLocation(e).isPresent()}numberOfNeighbors(e){let t=0;for(const n of bi.getNeighbors(e))this.getAt(n).hasPieces()&&(t+=1);return t}isDisconnected(){return this.getGroups().size()>1}occupiedSpaces(){return this.pieces.listKeys()}emptyNeighbors(e){const t=[];for(const n of bi.getNeighbors(e))this.getAt(n).isEmpty()&&t.push(n);return t}haveCommonNeighbor(e,t){const n=this.getOccupiedNeighbors(e),i=this.getOccupiedNeighbors(t);return n.findAnyCommonElement(i).isPresent()}}class Xi extends wr{static singleton=h.empty();static get(){return Xi.singleton.isAbsent()&&(Xi.singleton=h.of(new Xi)),Xi.singleton.get()}getInitialState(){return vo.fromRepresentation([],0)}applyLegalMove(e,t,n,i){return e instanceof Wa?this.applyLegalDrop(e,t):e instanceof Co?this.applyLegalMoveCoordToCoord(e,t):t.update().increaseTurnAndFinalizeUpdate()}applyLegalDrop(e,t){const n=t.getAt(e.coord);return t.update().setAt(e.coord,n.add(e.piece)).removeRemainingPiece(e.piece).increaseTurnAndFinalizeUpdate()}applyLegalMoveCoordToCoord(e,t){const n=t.getAt(e.getStart()),i=t.getAt(e.getEnd());return t.update().setAt(e.getStart(),n.removeTopPiece()).setAt(e.getEnd(),i.add(n.topPiece())).increaseTurnAndFinalizeUpdate()}isLegal(e,t){return e instanceof Wa?this.isLegalDrop(e,t):e instanceof Co?this.isLegalMoveCoordToCoord(e,t):this.shouldPass(t)?A.SUCCESS:A.failure(Me.CANNOT_PASS())}isLegalMoveCoordToCoord(e,t){if(!1===t.queenBeeLocation(t.getCurrentPlayer()).isPresent())return A.failure(Cr.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE());const n=t.getAt(e.getStart());if(n.isEmpty())return A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());const i=n.topPiece();if(i.owner===t.getCurrentOpponent())return A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());const o=qa.of(i).moveValidity(e,t);if(o.isFailure())return o;const s=t.update().setAt(e.getStart(),n.removeTopPiece()).increaseTurnAndFinalizeUpdate();if(s.isDisconnected())return A.failure(Cr.CANNOT_DISCONNECT_HIVE());const a=e.getEnd();return 0===s.numberOfNeighbors(a)?A.failure(Cr.CANNOT_DISCONNECT_HIVE()):A.SUCCESS}mustPlaceQueenBee(e){return 6<=e.turn&&!1===e.hasQueenBeeOnBoard(e.getCurrentPlayer())}isLegalDrop(e,t){const n=t.getCurrentPlayer();if(e.piece.owner===n.getOpponent())return A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(!1===t.remainingPieces.hasRemaining(e.piece))return A.failure(Cr.CANNOT_DROP_PIECE_YOU_DONT_HAVE());if("QueenBee"!==e.piece.kind&&this.mustPlaceQueenBee(t))return A.failure(Cr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());const i=this.checkNeighborValidity(e,t);return i.isFailure()?i:t.getAt(e.coord).hasPieces()?A.failure(Cr.MUST_DROP_ON_EMPTY_SPACE()):A.SUCCESS}checkNeighborValidity(e,t){const n=t.getCurrentPlayer();let i=!1;for(const o of bi.getNeighbors(e.coord)){const s=t.getAt(o);if(s.hasPieces()&&(i=!0,1!==t.turn&&s.topPiece().owner===n.getOpponent()))return A.failure(Cr.CANNOT_DROP_NEXT_TO_OPPONENT())}return 0!==t.turn&&!1===i?A.failure(Cr.MUST_BE_CONNECTED_TO_HIVE()):A.SUCCESS}getPossibleDropLocations(e){const t=e.getCurrentPlayer();if(0===e.turn)return new ct([new _(0,0)]);if(1===e.turn)return new ct(bi.getNeighbors(new _(0,0)));const n=e.remainingPieces.getAny(t);if(n.isAbsent())return new ct;const i=n.get(),o=new ct;for(const s of e.occupiedSpaces())if(e.getAt(s).topPiece().owner===t)for(const a of e.emptyNeighbors(s)){const c=Wa.of(i,a);this.isLegalDrop(c,e).isSuccess()&&o.add(a)}return o}getPossibleMovesFrom(e,t){const n=e.getCurrentPlayer(),i=new ct,o=e.getAt(t).topPiece();if(o.owner===n)for(const s of qa.of(o).getPotentialMoves(t,e))this.isLegalMoveCoordToCoord(s,e).isSuccess()&&i.add(s);return i}getPossibleMovesOnBoard(e){const t=new ct;for(const n of e.occupiedSpaces())t.addAll(this.getPossibleMovesFrom(e,n));return t}shouldPass(e){return 0===this.getPossibleDropLocations(e).size()&&0===this.getPossibleMovesOnBoard(e).size()}getGameStatus(e){const t=e.gameState,n=we.of(0,0);for(const s of O.PLAYERS){const a=t.queenBeeLocation(s);a.isPresent()&&n.put(s,t.numberOfNeighbors(a.get()))}const i=n.get(O.ZERO),o=n.get(O.ONE);return 6===i&&6===o?ve.DRAW:6===i?ve.getVictory(O.ONE):6===o?ve.getVictory(O.ZERO):ve.ONGOING}}class OLe extends or{getMetrics(e,t){const n=this.queenBeeMobility(e.gameState,O.ZERO),i=this.queenBeeMobility(e.gameState,O.ONE);return U1.ofSingle(n,i)}queenBeeMobility(e,t){const n=e.queenBeeLocation(t);return n.isPresent()?Xi.get().getPossibleMovesFrom(e,n.get()).size():0}}class pJ extends Yn{getListMoves(e,t){const n=this.getListDrops(e.gameState),i=this.getListOfOnBoardMoves(e.gameState),o=n.concat(i);return 0===o.length?[Ni.PASS]:o}getListOfOnBoardMoves(e){return Xi.get().getPossibleMovesOnBoard(e).toList()}getListDrops(e){const t=[],n=e.getCurrentPlayer(),i=new li(n,"QueenBee");for(const o of Xi.get().getPossibleDropLocations(e))if(Xi.get().mustPlaceQueenBee(e))t.push(Ni.drop(i,o));else for(const s of e.remainingPieces.getPlayerPieces(e.getCurrentPlayer()))t.push(Ni.drop(s,o));return t}}function TLe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"polygon",4),W("click",function(){const o=te(t).$implicit;return ne(p().selectSpace(o.x,o.y))}),P()()}if(2&r){const t=e.$implicit,n=p();m(),Ce("id","space_",t.x,"_",t.y,""),v("ngClass",t.content.spaceClasses),w("points",n.getHexaPoints())("transform",n.getHexaCenterTranslationAtXY(t.x,t.y))}}function ALe(r,e){if(1&r){const t=de();N(),M(0,"polygon",6),W("click",function(){te(t);const i=p().$implicit;return ne(p().selectSpace(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p();Ce("id","stroke_",t.x,"_",t.y,""),v("ngClass",t.content.strokeClasses),w("points",n.getHexaPoints())("transform",n.getHexaCenterTranslationAtXY(t.x,t.y))}}function bLe(r,e){if(1&r&&(N(),M(0,"g"),z(1,ALe,1,5,"polygon",5),P()),2&r){const t=e.$implicit;m(),v("ngIf",t.content.strokeClasses.length>0)}}function wLe(r,e){if(1&r){const t=de();N(),M(0,"polygon",8),W("click",function(){te(t);const i=p().$implicit;return ne(p().selectSpace(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p();Ce("id","stroke_",t.x,"_",t.y,""),w("points",n.getHexaPoints())("transform",n.getHexaCenterTranslationAtXY(t.x,t.y))}}function NLe(r,e){if(1&r&&(N(),M(0,"g"),z(1,wLe,1,4,"polygon",7),P()),2&r){const t=e.$implicit;m(),v("ngIf",t.content.selected)}}function ILe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"g",9),W("click",function(){const o=te(t).$implicit;return ne(p(2).selectStack(o.x,o.y))}),P()()}if(2&r){const t=e.$implicit,n=p().index,i=p();m(),Ce("id","piece_",t.x,"_",t.y,""),v("piece",t.content.piece)("x",0)("y",0)("pieceHeight",i.PIECE_HEIGHT)("hexaLayout",i.hexaLayout)("layer",n),w("transform",i.getHexaCenterTranslationAtXY(t.x,t.y))}}function kLe(r,e){if(1&r){const t=de();N(),M(0,"polygon",6),W("click",function(){te(t);const i=p().$implicit;return ne(p(2).selectStack(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p().index,i=p();Ce("id","stroke_",t.x,"_",t.y,""),v("ngClass",t.content.strokeClasses),w("points",i.getHexaPoints())("transform","translate(0 "+-(n+1)*i.PIECE_HEIGHT+")")}}function RLe(r,e){if(1&r&&(N(),M(0,"g"),z(1,kLe,1,5,"polygon",5),P()),2&r){const t=e.$implicit;w("transform",p(2).getHexaCenterTranslationAtXY(t.x,t.y)),m(),v("ngIf",t.content.strokeClasses.length>0)}}function xLe(r,e){if(1&r&&(N(),M(0,"g"),z(1,ILe,2,9,"g",1)(2,RLe,2,2,"g",1),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t),m(),v("ngForOf",t)}}function LLe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"g",10),W("click",function(){const o=te(t).$implicit;return ne(p(2).selectRemaining(o))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p(2);w("transform",i.getHexaCenterTranslationAtXY(0,0)),m(),En("id","remainingPiece_",t.toString(),""),v("piece",t)("pieceHeight",i.PIECE_HEIGHT)("x",0)("y",0)("layer",n)("hexaLayout",i.hexaLayout),w("transform",i.getRemainingPieceTransform(t))}}function zLe(r,e){if(1&r&&(N(),M(0,"g"),z(1,LLe,2,9,"g",1),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t.pieces)}}function DLe(r,e){if(1&r&&(N(),V(0,"polygon",11)),2&r){const t=p();w("points",t.getHexaPoints())("transform",t.getRemainingPieceHighlightTransform(t.selectedRemaining.get()))}}function VLe(r,e){if(1&r&&(N(),V(0,"g",13)),2&r){const t=e.$implicit,n=e.index,i=p(2);En("id","inspectedStack_",n,""),v("piece",t)("pieceHeight",i.PIECE_HEIGHT)("x",0)("y",0)("hexaLayout",i.hexaLayout)("layer",6*n),w("transform",i.inspectedStackTransform)}}function HLe(r,e){if(1&r&&(N(),M(0,"g"),z(1,VLe,1,8,"g",12),P()),2&r){const t=p();m(),v("ngForOf",t.inspectedStack.get().pieces.slice().reverse())}}class mJ extends TQ{highlighted=[];initialize(e){this.set(e,{spaceClasses:[],strokeClasses:[],selected:!1})}highlightFill(e,t){this.highlighted.push(e),this.get(e).map(n=>n.spaceClasses.push(t))}highlightStroke(e,t){this.highlighted.push(e),this.get(e).map(n=>n.strokeClasses.push(t))}select(e){this.highlighted.push(e),this.get(e).map(t=>t.selected=!0)}clearHighlights(){for(const e of this.highlighted)this.get(e).map(t=>{t.strokeClasses=[],t.spaceClasses=[],t.selected=!1});this.highlighted=[]}}class FLe extends TQ{highlighted=[];initialize(e,t){this.set(e,{piece:t,strokeClasses:[]})}highlight(e,t){this.highlighted.push(e),this.get(e).map(n=>n.strokeClasses.push(t))}clearHighlights(){for(const e of this.highlighted)this.get(e).map(t=>{t.strokeClasses=[]});this.highlighted=[]}}let _J=(()=>{class r extends J5{ORIGIN=new _(0,0);remainingStacks=[];layers=[];ground=new mJ;inspectedStack=h.empty();inspectedStackCoord=h.empty();selectedRemaining=h.empty();selectedStart=h.empty();selectedSpiderCoords=[];PIECE_HEIGHT;boardViewBox;viewBox;inspectedStackTransform;constructor(t){super(t),this.setRulesAndNode("Hive"),this.availableAIs=[new cn($localize`Minimax`,Xi.get(),new OLe,new pJ),new kn($localize`MCTS`,new pJ,this.rules)],this.encoder=Ni.encoder,this.SPACE_SIZE=30,this.PIECE_HEIGHT=this.SPACE_SIZE/3,this.hexaLayout=new eu(1.5*this.SPACE_SIZE,new _(2*this.SPACE_SIZE,0),jr.INSTANCE)}updateBoard(t){var n=this;return E(function*(){n.layers=[];for(const o of n.getState().occupiedSpaces()){const s=n.getState().getAt(o),a=o.x,c=o.y;for(let l=0;l<s.size();l++){l in n.layers||(n.layers[l]=new FLe);const u=s.pieces[s.size()-1-l];n.layers[l].initialize(new _(a,c),u)}}n.ground=n.getGround(),n.computeViewBox(),n.remainingStacks=n.getState().remainingPieces.toListOfStacks(),n.canPass=Xi.get().shouldPass(n.getState());const i=Xi.get().getGameStatus(n.node);switch(i){case ve.ONGOING:break;case ve.DRAW:n.highlight(n.getState().queenBeeLocation(O.ZERO).get(),"victory-stroke"),n.highlight(n.getState().queenBeeLocation(O.ONE).get(),"victory-stroke");break;default:const s=i.winner.getOpponent();n.highlight(n.getState().queenBeeLocation(s).get(),"victory-stroke")}})()}highlight(t,n){const i=this.getState().getAt(t).size();i-1 in this.layers&&this.layers[i-1].highlight(t,n)}pass(){var t=this;return E(function*(){return L.assert(t.canPass,"HiveComponent: pass() can only be called if canPass is true"),yield t.chooseMove(Ni.PASS)})()}computeViewBox(){const t=this.getPieceCoords().union(this.getAllNeighbors()).toList();t.push(new _(0,0)),this.boardViewBox=Ys.fromHexa(t,this.hexaLayout,this.STROKE_WIDTH);const n=new Ys(this.getRemainingPieceTransformAsCoord(new li(O.ZERO,"QueenBee")).x,0,4*this.SPACE_SIZE*5,0),i=5.5*this.SPACE_SIZE;let o=0;this.getState().remainingPieces.getAny(O.ZERO).isPresent()&&(o=i);let s=0;this.getState().remainingPieces.getAny(O.ONE).isPresent()&&(s=i);const a=this.boardViewBox.containingAtLeast(n).expandAbove(o).expandBelow(s);if(this.inspectedStack.isPresent()){const c=new _(a.right()+this.SPACE_SIZE,a.center().y),l=this.inspectedStack.get().size();this.inspectedStackTransform=`translate(${c.x} ${c.y+3*(l-1)*this.PIECE_HEIGHT})`,this.viewBox=a.expand(0,5*this.SPACE_SIZE,0,0).toSVGString()}else this.viewBox=a.toSVGString()}getPieceCoords(){return this.getState().pieces.getKeySet()}getGround(){const t=new mJ;for(const n of this.getAllNeighbors())t.initialize(n);return t}getAllNeighbors(){const t=new ct;for(const n of this.getPieceCoords())t.addAll(new ct(this.getState().emptyNeighbors(n)));return t.isEmpty()&&t.add(new _(0,0)),t}clearHighlights(){for(const t of this.layers)t.clearHighlights();this.ground.clearHighlights()}cancelMoveAttempt(){this.clearHighlights(),this.selectedStart=h.empty(),this.selectedRemaining=h.empty(),this.selectedSpiderCoords=[],this.inspectedStack=h.empty(),this.computeViewBox()}showLastMove(t){var n=this;return E(function*(){for(const i of n.getLastMoveCoords(t))n.highlight(i,"last-move-stroke"),n.ground.highlightStroke(i,"last-move-stroke"),n.ground.highlightFill(i,"moved-fill")})()}hideLastMove(){}getLastMoveCoords(t){let n=[];return t instanceof Wa?n=[t.coord]:t instanceof Co&&(n=[t.getStart(),t.getEnd()]),n}getRemainingPieceTransformAsCoord(t){const n=this.getRemainingPieceShift(t),i=this.boardViewBox.center().x+n*this.SPACE_SIZE*4;let o;return o=t.owner===this.getPointOfView()?this.boardViewBox.bottom()+4*this.SPACE_SIZE:this.boardViewBox.up-3*this.SPACE_SIZE,new _(i,o)}getRemainingPieceTransform(t){const n=this.getRemainingPieceTransformAsCoord(t);return`translate(${n.x} ${n.y})`}getRemainingPieceHighlightTransform(t){const n=this.getRemainingPieceTransformAsCoord(t),i=this.getState().remainingPieces.getQuantity(t);return`translate(${n.x} ${n.y-this.PIECE_HEIGHT*i})`}getRemainingPieceShift(t){switch(t.kind){case"QueenBee":return-2.5;case"Beetle":return-1.5;case"Grasshopper":return-.5;case"Spider":return.5;default:return L.expectToBe(t.kind,"SoldierAnt"),1.5}}selectRemaining(t){var n=this;return E(function*(){const i=yield n.canUserPlay(`#remainingPiece_${t.toString()}`);if(i.isFailure())return n.cancelMove(i.getReason());if(t.owner===n.getCurrentOpponent())return n.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if("QueenBee"!==t.kind&&Xi.get().mustPlaceQueenBee(n.getState()))return n.cancelMove(Cr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());if(n.selectedRemaining.equalsValue(t))n.cancelMoveAttempt();else{n.cancelMoveAttempt(),n.selectedRemaining=h.of(t),n.clearHighlights();const o=Xi.get().getPossibleDropLocations(n.getState()).toList();for(const s of o)n.ground.highlightStroke(s,"clickable-stroke")}return A.SUCCESS})()}selectStack(t,n){var i=this;return E(function*(){return yield i.select(new _(t,n),"piece")})()}selectSpace(t,n){var i=this;return E(function*(){return yield i.select(new _(t,n),"space")})()}select(t,n){var i=this;return E(function*(){const o=yield i.canUserPlay(`#${n}_${t.x}_${t.y}`);if(o.isFailure())return i.cancelMove(o.getReason());const s=i.getState(),a=s.getAt(t);if(i.selectedRemaining.isPresent()){const c=Ni.drop(i.selectedRemaining.get(),t);return i.chooseMove(c)}if(i.selectedStart.isPresent()){const c=s.getAt(i.selectedStart.get()).topPiece();return i.selectedStart.equalsValue(t)?i.cancelMove():i.selectTarget(t,c)}return 0===a.size()?i.cancelMove():i.selectStart(t,a)})()}selectTarget(t,n){var i=this;return E(function*(){if("Spider"===n.kind)return i.selectNextSpiderSpace(t);{const o=Ni.move(i.selectedStart.get(),t);return hn(o.isSuccess(),"Hive: the only forbidden moves are static moves"),i.chooseMove(o.get())}})()}selectStart(t,n){var i=this;return E(function*(){const o=i.getState(),s=n.topPiece();return s.owner===o.getCurrentOpponent()?1===n.size()?i.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):i.inspectedStack.isPresent()?(i.cancelMoveAttempt(),i.clearHighlights(),A.SUCCESS):(i.highlight(t,"selected-stroke"),i.inspectedStack=h.of(n),i.inspectedStackCoord=h.of(t),i.computeViewBox(),A.SUCCESS):(i.cancelMoveAttempt(),i.clearHighlights(),"QueenBee"!==s.kind&&Xi.get().mustPlaceQueenBee(o)?i.cancelMove(Cr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN()):(i.selectedStart=h.of(t),i.highlight(t,"selected-stroke"),"Spider"===s.kind&&i.selectedSpiderCoords.push(i.selectedStart.get()),n.size()>1&&(i.inspectedStack=h.of(n),i.inspectedStackCoord=h.of(t),i.computeViewBox()),i.highlightNextPossibleCoords(t),A.SUCCESS))})()}highlightNextPossibleCoords(t){for(const n of this.getNextPossibleCoords(t))this.highlight(n,"clickable-stroke"),this.ground.highlightStroke(n,"clickable-stroke")}getNextPossibleCoords(t){const n=this.getState(),i=n.getAt(t).topPiece(),o=Xi.get().getPossibleMovesFrom(n,t);return"Spider"===i.kind?o.filter(a=>yt.isPrefix(this.selectedSpiderCoords,a.coords)).map(a=>a.coords[this.selectedSpiderCoords.length]).toList():o.map(s=>s.getEnd()).toList()}selectNextSpiderSpace(t){var n=this;return E(function*(){if(n.selectedSpiderCoords.push(t),4===n.selectedSpiderCoords.length){const o=Ni.spiderMove(n.selectedSpiderCoords);return n.chooseMove(o)}const i=bC.get().prefixLegality(n.selectedSpiderCoords,n.getState());if(i.isFailure())return n.cancelMove(i.getReason());n.clearHighlights(),n.highlight(n.selectedStart.get(),"selected-stroke");for(const o of n.selectedSpiderCoords)n.ground.select(o);return n.highlightNextPossibleCoords(n.selectedStart.get()),A.SUCCESS})()}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-hive"]],features:[We],decls:9,vars:9,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","remaining_highlight","class","base no-fill small-stroke selected-stroke",4,"ngIf"],[4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke","ngClass","selected-stroke",3,"id","click",4,"ngIf"],["ngClass","selected-stroke",1,"base","no-fill","small-stroke",3,"id","click"],["app-hive-piece","",3,"id","piece","x","y","pieceHeight","hexaLayout","layer","click"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","layer","hexaLayout","click"],["id","remaining_highlight",1,"base","no-fill","small-stroke","selected-stroke"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer",4,"ngFor","ngForOf"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer"]],template:function(n,i){1&n&&(N(),M(0,"svg",0),z(1,TLe,2,5,"g",1)(2,bLe,2,1,"g",1)(3,NLe,2,1,"g",1)(4,xLe,3,2,"g",1)(5,zLe,2,1,"g",1),M(6,"g"),z(7,DLe,1,2,"polygon",2),P(),z(8,HLe,2,1,"g",3),P()),2&n&&(w("viewBox",i.viewBox),m(),v("ngForOf",i.ground),m(),v("ngForOf",i.ground),m(),v("ngForOf",i.ground),m(),v("ngForOf",i.layers),m(),v("ngForOf",i.remainingStacks),m(),w("transform",i.getHexaCenterTranslation(i.ORIGIN)),m(),v("ngIf",i.selectedRemaining.isPresent()),m(),v("ngIf",i.inspectedStack.isPresent()))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const Zc=new li(O.ZERO,"QueenBee"),u0=new li(O.ZERO,"Beetle"),hu=new li(O.ZERO,"Grasshopper"),NC=new li(O.ZERO,"Spider"),IC=new li(O.ZERO,"SoldierAnt"),f0=new li(O.ONE,"QueenBee"),ys=new li(O.ONE,"Beetle"),BI=new li(O.ONE,"Grasshopper"),WI=new li(O.ONE,"Spider"),Pd=new li(O.ONE,"SoldierAnt");class ULe extends Bn{tutorial=[q.informational($localize`Hive`,$localize`Hive is a game without a board, where pieces are placed on the side of each other, in a contiguous block called the hive. Each player has 11 pieces, representing various insects.`,vo.fromRepresentation([[[f0],[ys],[WI],[hu]],[[hu],[],[IC],[]],[[IC],[],[],[]]],8)),q.informational($localize`Object of the game`,$localize`The object of the game at Hive is to surround the opponent's queen. Once the queen is surrounded by 6 pieces, no matter the owner of these pieces, the game ends. The player with a queen that is not surrounded wins. In case both queens are fully surrounded at the same turn, it is a draw. Here, Dark won.`,vo.fromRepresentation([[[],[ys],[NC]],[[Pd],[f0],[Zc]],[[hu],[u0],[]]],7)),q.anyMove($localize`Placing the first and second piece`,$localize`There are two types of actions: drops and moves. Initially, the board is empty, so we will have to put (drop) pieces on the board. For the first piece dropped on the board, there is no placement restriction: you can choose any piece and put in on the board. The second piece, put by Light, will need to be put in a neighboring space of the first piece. To drop a piece on the board, select the piece of your choice in your remaining pieces (below the board), and then click on the space you want to drop it on.<br/><br/>You're playing Dark and starting the game, put any piece on the board.`,Xi.get().getInitialState(),Ni.drop(u0,new _(0,0)),pe.CONGRATULATIONS()),q.anyMove($localize`Placing pieces after the second turn`,$localize`After the second turn, you are still allowed to place pieces any time you want, as long as you respect two conditions: <ol><li>your piece must be connected to the hive, and</li><li>the space on which you drop your piece must not touch a stack of the opponent.</li></ol><br/><br/>You're playing Dark, drop a piece on the board.`,vo.fromRepresentation([[[ys],[hu]]],2),Ni.drop(Zc,new _(2,0)),pe.CONGRATULATIONS()),q.fromMove($localize`Moving pieces: the queen bee`,$localize`Once you have placed you queen bee on the board, you can move your pieces. You must place your queen bee on the board as your fourth piece at the latest. Each creature moves in a different way, and moves should respect two restrictions:<ol><li>the hive must always remain fully connected, and</li><li>pieces should be able to physically slide to their destination (except for the beetle and grasshopper as we will see later).</li></ol>The queen bee can move to any of its empty neighbors. To move a piece, click on it and then click on its destination. The possible destinations are highlighted.<br/><br/>You are playing Dark, move your queen bee.`,vo.fromRepresentation([[[],[NC],[BI],[f0],[ys]],[[ys],[Zc],[u0],[],[]]],4),[Ni.move(new _(1,1),new _(0,2)).get(),Ni.move(new _(1,1),new _(1,2)).get()],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),q.fromMove($localize`Moving the beetle`,$localize`The beetle moves like the queen bee, but it is allowed to climb on top of other pieces! Therefore, it need not adhere to the sliding restriction. Note that you are not allowed to drop the beetle on top of another piece in the drop phase, this can only be achieved when moving a beetle already on the board. A piece with a beetle on top is not allowed to move. A stack is considered to be of the player who has the beetle of the top.<br/><br/>You're playing Dark, block your opponent's queen by moving on top of it!`,vo.fromRepresentation([[[Zc],[f0],[u0]],[[ys],[],[]]],6),[Ni.move(new _(2,0),new _(1,0)).get()],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),q.forClick($localize`Inspecting stacks`,$localize`When pieces are stacked together, you are allowed to inspect the stack to see which pieces are under the beetle. This works with opponent-controlled stacks too. To do so, you can simply click on any stack to see their composition.<br/><br/>You're playing Dark and your opponent has a beetle on top of one of your piece, click on it.`,vo.fromRepresentation([[[ys,Zc],[f0],[u0]]],2),["#piece_0_0"],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),q.fromMove($localize`Moving the grasshopper`,$localize`The grasshopper jumps over one or more pieces in a straight line, and stops at the first empty space encountered. It cannot jump over empty spaces, and can only move through jumps. Because it jumps, it does not adhere to the sliding restriction.<br/><br/>You're playing Dark. Jump over three pieces with your grasshopper!`,vo.fromRepresentation([[[hu],[Zc],[ys],[Pd]],[[BI],[],[],[]]],6),[Ni.move(new _(0,0),new _(4,0)).get()],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),q.fromPredicate($localize`Moving the soldier ant`,$localize`The soldier ant is a powerful piece: it can move anywhere in the hive as long as it respects the sliding and the one hive restrictions!<br/><br/>You're playing Dark. Your queen bee is stuck, move your soldier ant to free up your queen!`,vo.fromRepresentation([[[],[IC],[f0]],[[],[Zc],[ys]],[[Pd],[WI],[]]],6),Ni.move(new _(1,0),new _(3,1)).get(),(e,t,n)=>e.equals(Ni.move(new _(1,0),new _(0,1)).get())?A.failure($localize`You have not freed your queen, try again!`):A.SUCCESS,pe.CONGRATULATIONS()),q.anyMove($localize`Moving the spider`,$localize`Finally, the spider can move exactly 3 spaces at a time. It is not allowed to go twice through the same space in a move. As the spider crawls around other pieces, it can only move around pieces that are in direct contact with it. This means that the spider is not allowed to temporarily split the hive. For example, here, Dark's spider cannot go on the left as its first move. To do a spider move, select a spider and click on the three spaces that compose the move.<br/><br/>You're playing Dark, move your spider!`,vo.fromRepresentation([[[],[NC],[WI],[ys]],[[],[],[],[u0]],[[ys],[],[],[Pd]],[[IC],[],[hu],[]],[[Zc],[BI],[],[]]],6),Ni.spiderMove([new _(1,0),new _(1,1),new _(2,1),new _(2,2)]),pe.CONGRATULATIONS()),q.informational($localize`Restrictions`,$localize`Let us clarify the two restrictions during moves.<ol><li>All pieces of the hive should always be connected in a way that there is a single hive. It can be the case that your piece disconnects from the hive when you slide it, but after the move there should be only one hive.</li><li>Except grasshoppers and beetles, all moves should be done by sliding the piece without disturbing the rest of the hive.</li></ol>Observe here how the queen bee is stuck, as it is not possible to slide it without moving one of the other pieces. Moreover, moving it would split the hive in two.`,vo.fromRepresentation([[[],[NC],[]],[[],[Zc],[ys]],[[Pd],[],[]]],6)),q.informational($localize`Passing your turn`,$localize`Finally, it is possible that you are not able to do any move: when it is the case, you must pass your turn. Here, Dark must pass: the queen bee cannot move without disconnecting the hive, the beetle is stuck beneath another beetle, and a dropped piece would be in contact with an opponent's piece.`,vo.fromRepresentation([[[ys,u0],[Zc],[f0]]],4))]}class Ms extends nu{static encoder=q2.getFallibleEncoder(Ms.from);static from(e,t){const n=nu.isValidDirection(e,t);return n.isFailure()?n.toOtherFallible():X.success(new Ms(e,t))}getMaximalDistance(){return 11}}class Yc extends qi{static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new po({name:()=>$localize`Hnefatafl`,config:{castleIsLeftForGood:new Qn(!1,qi.CASTLE_IS_LEFT_FOR_GOOD),edgesAreKingsEnnemy:new Qn(!0,qi.EDGE_ARE_KING_S_ENNEMY),centralThroneCanSurroundKing:new Qn(!1,qi.CENTRAL_THRONE_CAN_SURROUND_KING),kingFarFromHomeCanBeSandwiched:new Qn(!1,qi.KING_FAR_FROM_HOME_CAN_BE_SANDWICHED),invaderStarts:new Qn(!0,qi.INVADER_STARTS)}});static get(){return Yc.singleton.isAbsent()&&(Yc.singleton=h.of(new Yc)),Yc.singleton.get()}constructor(){super(Ms.from)}getInitialState(e){const t=It.UNOCCUPIED;let n=It.PLAYER_ZERO_PAWN,i=It.PLAYER_ONE_PAWN,o=It.PLAYER_ONE_KING;return!1===e.get().invaderStarts&&(n=It.PLAYER_ONE_PAWN,i=It.PLAYER_ZERO_PAWN,o=It.PLAYER_ZERO_KING),new M2([[t,t,t,n,n,n,n,n,t,t,t],[t,t,t,t,t,n,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t],[n,t,t,t,t,i,t,t,t,t,n],[n,t,t,t,i,i,i,t,t,t,n],[n,n,t,i,i,o,i,i,t,n,n],[n,t,t,t,i,i,i,t,t,t,n],[n,t,t,t,t,i,t,t,t,t,n],[t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,n,t,t,t,t,t],[t,t,t,n,n,n,n,n,t,t,t]],0)}getRulesConfigDescription(){return h.of(Yc.RULES_CONFIG_DESCRIPTION)}}const b=It.UNOCCUPIED,kt=It.PLAYER_ZERO_PAWN,vr=It.PLAYER_ONE_PAWN,kC=It.PLAYER_ONE_KING,CJ=Yc.get().getDefaultRulesConfig();class $Le extends Bn{tutorial=[q.informational($localize`Goal of the game`,$localize`Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,Yc.get().getInitialState(CJ)),q.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,Yc.get().getInitialState(CJ),Ms.from(new _(5,1),new _(1,1)).get(),pe.CONGRATULATIONS()),q.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new M2([[b,b,b,b,kt,kt,kt,kt,b,b,b],[b,b,b,b,b,kt,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[kt,b,b,b,b,vr,b,b,b,b,kt],[kt,b,b,kt,vr,vr,vr,b,b,b,kt],[kt,kt,b,vr,vr,kC,vr,vr,b,kt,kt],[kt,b,b,b,vr,vr,vr,b,b,b,kt],[kt,b,b,b,b,vr,b,b,b,b,kt],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,kt,b,b,b,b,b],[b,b,b,kt,kt,kt,kt,kt,b,b,b]],1),[Ms.from(new _(5,3),new _(3,3)).get()],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`).withPreviousMove(Ms.from(new _(3,0),new _(3,4)).get()),q.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new M2([[b,b,b,kt,kt,kt,kt,kt,b,b,b],[b,vr,b,b,b,kt,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,vr,b,b,b,b,kt],[kt,b,b,b,b,vr,vr,b,b,b,kt],[kt,kt,kC,b,vr,b,vr,vr,b,b,kt],[b,b,kt,b,b,vr,vr,b,b,b,kt],[kt,b,b,b,b,vr,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,kt,b,b,b,b,b,b,b,b,b],[b,b,b,kt,kt,kt,kt,b,kt,b,b]],12),[Ms.from(new _(3,0),new _(3,5)).get(),Ms.from(new _(3,10),new _(3,5)).get()],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),q.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new M2([[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,kt,b,b,b,b,b,b,b,b,b],[kt,kC,b,kt,b,b,b,b,b,b,b],[b,kt,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b]],72),[Ms.from(new _(3,4),new _(2,4)).get()],pe.CONGRATULATIONS_YOU_WON(),$localize`Failed, you let the king run away.`),q.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new M2([[b,b,kt,kC,kt,b,b,b,b,b,b],[b,b,b,b,b,b,vr,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,kt,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b]],72),[Ms.from(new _(3,3),new _(3,1)).get()],$localize`The king is dead, long live the king. Congratulations, you won.`,pe.FAILED_TRY_AGAIN())]}function GLe(r,e){1&r&&(N(),V(0,"polygon",8))}function BLe(r,e){1&r&&(N(),V(0,"rect",9))}function WLe(r,e){if(1&r&&(N(),M(0,"g"),z(1,GLe,1,0,"polygon",6)(2,BLe,1,0,"ng-template",null,7,wn),P()),2&r){const t=Pn(3),n=p().index,i=p().index,o=p();m(),v("ngIf",o.isCentralThrone(n,i))("ngIfElse",t)}}function qLe(r,e){if(1&r&&(N(),M(0,"g"),V(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),P()),2&r){const t=p(2).index,n=p().index,i=p();m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function jLe(r,e){if(1&r&&(N(),V(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;v("ngClass",p().viewInfo.pieceClasses[n][t])}}function ZLe(r,e){if(1&r&&(N(),V(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function YLe(r,e){if(1&r&&(N(),z(0,jLe,1,1,"polyline",14)(1,ZLe,4,20,"ng-template",null,15,wn)),2&r){const t=Pn(2),n=p(2).index,i=p().index;v("ngIf",p().isKing(n,i))("ngIfElse",t)}}function KLe(r,e){if(1&r&&(N(),M(0,"g"),V(1,"circle",10),z(2,qLe,6,25,"g",11)(3,YLe,3,2,"ng-template",null,12,wn),P()),2&r){const t=Pn(4),n=p().index,i=p().index,o=p();m(),Ce("id","piece_",n,"_",i,""),v("ngClass",o.viewInfo.pieceClasses[i][n]),w("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)("cx",.5*o.SPACE_SIZE)("cy",.5*o.SPACE_SIZE),m(),v("ngIf",o.isInvader(n,i))("ngIfElse",t)}}function XLe(r,e){if(1&r){const t=de();N(),M(0,"g",3),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),V(1,"rect",4),z(2,WLe,4,2,"g",5)(3,KLe,5,8,"g",5),P()}if(2&r){const t=e.index,n=p().index,i=p();Ce("id","click_",t,"_",n,""),w("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),m(),Ce("id","space_",t,"_",n,""),v("ngClass",i.getRectClasses(t,n)),w("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),m(),v("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),m(),v("ngIf",i.board[n][t]!==i.EMPTY)}}function QLe(r,e){if(1&r&&(N(),M(0,"g"),z(1,XLe,4,10,"g",2),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function JLe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"rect",17),W("click",function(){const o=te(t).$implicit;return ne(p().onClick(o.x,o.y))}),P()()}if(2&r){const t=e.$implicit,n=p();m(),Ce("id","click_",t.x,"_",t.y,""),w("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let eze=(()=>{class r extends TI{constructor(t){super(t,Ms.from),this.setRulesAndNode("Hnefatafl"),this.availableAIs=this.createAIs(),this.encoder=Ms.encoder}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-hnefatafl"]],features:[We],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(N(),M(0,"svg",0),z(1,QLe,2,1,"g",1)(2,JLe,2,6,"g",1),P()),2&n&&(w("viewBox",i.getViewBox().toSVGString()),m(),v("ngForOf",i.board),m(),v("ngForOf",i.getClickables()))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();class Uo extends Rn{static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new po({name:()=>$localize`Kalah`,config:{feedOriginalHouse:new Qn(!0,Rn.FEED_ORIGINAL_HOUSE),mustFeed:new Qn(!1,Rn.MUST_FEED),passByPlayerStore:new Qn(!0,Rn.PASS_BY_PLAYER_STORE),mustContinueDistributionAfterStore:new Qn(!0,Rn.MULTIPLE_SOW),continueLapUntilCaptureOrEmptyHouse:new Qn(!1,Rn.CYCLICAL_LAP),seedsByHouse:new g1(4,Rn.SEEDS_BY_HOUSE,h1.range(1,99)),width:new g1(6,Wi.WIDTH,h1.range(1,99))}});static get(){return Uo.singleton.isAbsent()&&(Uo.singleton=h.of(new Uo([]))),Uo.singleton.get()}getRulesConfigDescription(){return h.of(Uo.RULES_CONFIG_DESCRIPTION)}applyCapture(e){const t=e.resultingState,n={capturedSum:0,captureMap:it.create(6,2,0),resultingState:t};if(e.endsUpInStore)return n;{const i=e.filledCoords[e.filledCoords.length-1],o=e.resultingState.getCurrentPlayerY(),s=e.resultingState.getOpponentY(),a=e.resultingState.getPieceAt(i),c=e.resultingState.getPieceAtXY(i.x,s);if(i.y===o&&1===a&&c>0){const l=t.getCopiedBoard(),u=l[0][i.x]+l[1][i.x],f=it.create(t.getWidth(),2,0);f[0][i.x]=l[0][i.x],f[1][i.x]=l[1][i.x];const g=t.getCurrentPlayer();let y=t.capture(g,i);const I=new _(i.x,(i.y+1)%2);return y=y.capture(g,I),{capturedSum:u,captureMap:f,resultingState:y}}return n}}}class tze extends EI{constructor(){super(Uo.get())}}function nze(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"g",8),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();m(),Ce("id","click_",n,"_",i,""),v("x",n)("y",i)("content",t)("spaceClasses",o.getSpaceClasses(n,i))("rotation",o.getPieceRotation())("secondaryContent",o.getHouseSecondaryContent(n,i)),w("transform",o.getPieceTransform(n,i))}}function rze(r,e){if(1&r&&(N(),M(0,"g"),z(1,nze,2,9,"g",2),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}let ize=(()=>{class r extends PI{constructor(t,n){super(t,n),this.setRulesAndNode("Kalah"),this.availableAIs=this.createAIs(new tze),this.encoder=S1.encoder}static \u0275fac=function(n){return new(n||r)(G(Ut),G(zs))};static \u0275cmp=$e({type:r,selectors:[["app-kalah-component"]],features:[We],decls:8,vars:21,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0","ry","115","rx","115","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","120","y1","120","y2","120",1,"base"],["x1","120","y1","0","x2","120","y2","240",1,"base"],["y1","0","y2","240",1,"base"],["id","store_player_0","app-numbered-circle","","transform","translate(60 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["id","store_player_1","app-numbered-circle","",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["app-numbered-circle","",3,"id","x","y","content","spaceClasses","rotation","secondaryContent","click"]],template:function(n,i){1&n&&(N(),M(0,"svg",0),V(1,"rect",1),z(2,rze,2,1,"g",2),V(3,"line",3)(4,"line",4)(5,"line",5),M(6,"g",6),W("click",function(){return i.onStoreClick(i.Player.ZERO)}),P(),M(7,"g",7),W("click",function(){return i.onStoreClick(i.Player.ONE)}),P()()),2&n&&(w("viewBox",i.getMancalaViewBox())("transform",i.rotation),m(),w("width",i.getViewBoxWidth())("height",240),m(),v("ngForOf",i.board),m(),w("x2",i.getViewBoxWidth()-120),m(2),w("x1",i.getViewBoxWidth()-120)("x2",i.getViewBoxWidth()-120),m(),v("x",-1)("y",-1)("content",i.getStoreContent(i.Player.ZERO))("spaceClasses",i.getSpaceClasses(-1,-1))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ZERO)),m(),v("x",2)("y",2)("content",i.getStoreContent(i.Player.ONE))("spaceClasses",i.getSpaceClasses(2,2))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ONE)),w("transform","translate("+(i.getViewBoxWidth()-60)+" 120)"))},dependencies:[Nt,SI],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"],changeDetection:0})}return r})();const Sd=Uo.get().getDefaultRulesConfig();class oze extends Bn{gameName=$localize`Kalah`;tutorial=[ms.intro(this.gameName,Uo.get().getInitialState(Sd)),q.informational($localize`Kalah`,$localize`Bonus fact: Kalah has been created in the U.S.A in 1940 by William Julius Champion Jr.`,Uo.get().getInitialState(Sd)),ms.sowing(Uo.get().getInitialState(Sd)),q.forClick($localize`The Kalah (1/2)`,$localize`The houses on the extreme left and right, unaligned with the others, are the Kalah. Yours is on the left, the opponent's on the right. When sowing, before passing from your leftmost house to the leftmost house of the opponent, you must drop one seed in your Kalah, but you won't have to drop seed in your opponent's Kalah. When you make a capture, the captured seeds are put in your Kalah.<br/><br/>You're playing Dark. Make a move that passes through your Kalah then feeds opponent's houses.`,Uo.get().getInitialState(Sd),["#click_0_1","#click_1_1","#click_2_1"],$localize`As you see, three houses have been fed in addition to your Kalah.`,$localize`Failed. Choose the three leftmost house on the bottom.`),q.fromPredicate($localize`The Kalah (2/2)`,$localize`When ending in the Kalah, you must distribute again.<br/><br/>You're playing Dark, play the house that ends up in the Kalah then do a second distribution!`,Uo.get().getInitialState(Sd),S1.of(d1.of(3),[d1.of(1)]),(e,t,n)=>1===e.distributions.length?A.failure($localize`This move only distributed one house, do one distribution that ends in the Kalah, then do a second one!`):A.SUCCESS,pe.CONGRATULATIONS()),q.fromPredicate($localize`Captures`,$localize`When the last seed of a distribution ends up in one of your empty houses, if the opposite house is filled, then you capture both houses. On this board, such a move is possible.<br/><br/>You're playing Dark, do a capture!`,new G1([[0,4,4,4,4,4],[0,2,0,2,4,0]],4,we.of(0,0)),S1.of(d1.of(1),[d1.of(0),d1.of(3)]),(e,t,n)=>0===n.getPieceAtXY(1,0)?A.SUCCESS:A.failure($localize`You did not capture, try again!`),pe.CONGRATULATIONS()),q.fromMove(pe.END_OF_THE_GAME(),$localize`At any moment, when one player has more than 24 seeds in their Kalah, they win. That can happen before the board is empty, but, there is also a second way. When you don't have any seed in your houses, the game is over and your opponent takes all the remaining seeds from their houses. Here, your opponent just need one more point to win and will get it next turn if you allow it.<br/><br/>You're playing Dark, win!`,new G1([[0,0,0,0,2,0],[2,0,0,0,0,1]],0,we.of(19,24)),[S1.of(d1.of(5))],$localize`Since there is no longer seeds in the opponent houses, all your seeds have been captured by you. Congratulations, you won!`,$localize`Failed, you gave the opponent a seed! Try again.`)]}class Ln{value;name;rgb;static ANY=new Ln(0,"any","#000");static ORANGE=new Ln(1,"orange","#d67421");static BLUE=new Ln(2,"blue","#006bac");static PURPLE=new Ln(3,"purple","#6f3787");static PINK=new Ln(4,"pink","#d2719e");static YELLOW=new Ln(5,"yellow","#e2c200");static RED=new Ln(6,"red","#d23339");static GREEN=new Ln(7,"green","#009157");static BROWN=new Ln(8,"brown","#562500");static of(e){switch(e){case 0:return Ln.ANY;case 1:return Ln.ORANGE;case 2:return Ln.BLUE;case 3:return Ln.PURPLE;case 4:return Ln.PINK;case 5:return Ln.YELLOW;case 6:return Ln.RED;case 7:return Ln.GREEN;default:return L.expectToBe(e,8,"Invalid value "+e+" for KamisadoColor"),Ln.BROWN}}constructor(e,t,n){this.value=e,this.name=t,this.rgb=n}}class On{player;color;constructor(e,t){this.player=e,this.color=t}static EMPTY=new On(B.NONE,Ln.ANY);static of(e,t){return new On(e,Ln.of(t))}static createPlayerColors(e){return{ORANGE:new On(e,Ln.ORANGE),BLUE:new On(e,Ln.BLUE),PURPLE:new On(e,Ln.PURPLE),PINK:new On(e,Ln.PINK),YELLOW:new On(e,Ln.YELLOW),RED:new On(e,Ln.RED),GREEN:new On(e,Ln.GREEN),BROWN:new On(e,Ln.BROWN)}}static ZERO=On.createPlayerColors(O.ZERO);static ONE=On.createPlayerColors(O.ONE);equals(e){return e.player===this.player&&e.color===this.color}isEmpty(){return this.player.equals(B.NONE)}belongsTo(e){return this.player===e}}class $o{static INITIAL=$o.getInitialBoard();static SIZE=8;static COLORS=it.map([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],Ln.of);static getColorAt(e,t){return $o.COLORS[t][e]}static getInitialBoard(){const e=On.EMPTY;return[[1,2,3,4,5,6,7,8].map(t=>On.of(O.ONE,t)),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(t=>On.of(O.ZERO,t))]}static isEmptyAt(e,t){return e[t.y][t.x].equals(On.EMPTY)}static allPieceCoords(e){const t=[];for(let n=0;n<e.length;n++)for(let i=0;i<e[n].length;i++){const o=new _(i,n);!1===$o.isEmptyAt(e,o)&&t.push(o)}return t}}class s4 extends $1{colorToPlay;coordToPlay;alreadyPassed;static isOnBoard(e){return e.isInRange($o.SIZE,$o.SIZE)}constructor(e,t,n,i,o){super(it.copy(o),e),this.colorToPlay=t,this.coordToPlay=n,this.alreadyPassed=i}}class gu extends C2{static PASS=new gu;static encoder=ke.constant("PASS",gu.PASS);constructor(){super()}length(){return 0}equals(e){return this===e}toString(){return"KamisadoMove(PASS)"}}class pu extends Do{static encoder=q2.getEncoder(pu.of);static of(e,t){return L.assert(s4.isOnBoard(e),"Starting coord of KamisadoMove must be on the board, not at "+e.toString()),L.assert(s4.isOnBoard(t),"End coord of KamisadoMove must be on the board, not at "+t.toString()),new pu(e,t)}constructor(e,t){super(e,t)}equals(e){return e===this||!!Ii.isPiece(e)&&!1!==e.getStart().equals(this.getStart())&&e.getEnd().equals(this.getEnd())}toString(){return"KamisadoMove("+this.getStart()+"->"+this.getEnd()+")"}}function sze(r){return r instanceof gu}var Ii;!function(r){r.PASS=gu.PASS,r.of=function e(n,i){return pu.of(n,i)},r.isPiece=function t(n){return n instanceof pu},r.encoder=ke.disjunction([r.isPiece,sze],[pu.encoder,gu.encoder])}(Ii||(Ii={}));let Od=(()=>class r{static NOT_RIGHT_COLOR=()=>$localize`This piece is not of the color you have to play.`;static DIRECTION_NOT_ALLOWED=()=>$localize`You can only move forward, orthogonally or diagonally.`;static MOVE_BLOCKED=()=>$localize`This move is blocked by another piece.`;static PLAY_WITH_SELECTED_PIECE=()=>$localize`You must play with the selected piece.`})();class A2 extends wr{static singleton=h.empty();static get(){return A2.singleton.isAbsent()&&(A2.singleton=h.of(new A2)),A2.singleton.get()}getInitialState(){return new s4(0,Ln.ANY,h.empty(),!1,$o.INITIAL)}static getColorMatchingPiece(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new _(0,7),new _(1,7),new _(2,7),new _(3,7),new _(4,7),new _(5,7),new _(6,7),new _(7,7)]}static getMovablePieces(e){return A2.getColorMatchingPiece(e).filter(t=>{for(const n of this.playerDirections(e.getCurrentPlayer())){const i=t.getNext(n);if(e.isOnBoard(i)&&$o.isEmptyAt(e.board,i))return!0}return!1})}static playerDirections(e){return e===O.ONE?[me.DOWN,me.DOWN_LEFT,me.DOWN_RIGHT]:[me.UP,me.UP_LEFT,me.UP_RIGHT]}static directionAllowedForPlayer(e,t){return t===O.ZERO?e.y<0:e.y>0}static mustPass(e){return 0===this.getMovablePieces(e).length}static getFurthestPiecePositions(e){let t=7,n=0;return $o.allPieceCoords(e.board).forEach(i=>{const o=e.getPieceAt(i);L.assert(o!==On.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),o.player===O.ONE?n=Math.max(n,i.y):t=Math.min(t,i.y)}),we.of(t,n)}static isLegal(e,t){if(Ii.isPiece(e)){const n=e.getStart(),i=e.getEnd(),o=t.colorToPlay,s=t.getPieceAt(n);if(s.isEmpty())return A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s.belongsTo(t.getCurrentOpponent()))return A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(o!==Ln.ANY&&s.color!==o)return A.failure(Od.NOT_RIGHT_COLOR());if(!1===t.getPieceAt(i).isEmpty())return A.failure(Me.MUST_CLICK_ON_EMPTY_SPACE());const c=me.factory.fromMove(n,i);if(c.isFailure())return A.failure(Od.DIRECTION_NOT_ALLOWED());const l=c.get();if(!1===A2.directionAllowedForPlayer(l,t.getCurrentPlayer()))return A.failure(Od.DIRECTION_NOT_ALLOWED());let u=n;for(;!1===u.equals(i);)if(u=u.getNext(l),!1===t.getPieceAt(u).isEmpty())return A.failure(Od.MOVE_BLOCKED());return A.SUCCESS}return this.isLegalPass(t)}static isLegalPass(e){return this.mustPass(e)&&!1===e.alreadyPassed?A.SUCCESS:A.failure(Me.CANNOT_PASS())}nextCoordToPlay(e,t){return h.ofNullable($o.allPieceCoords(e.board).find(n=>{const i=e.getPieceAt(n);return i.player===e.getCurrentOpponent()&&i.color===t}))}applyLegalMove(e,t,n,i){if(Ii.isPiece(e)){const o=e.getStart(),s=e.getEnd(),a=t.getCopiedBoard();a[s.y][s.x]=a[o.y][o.x],a[o.y][o.x]=On.EMPTY;const c=$o.getColorAt(s.x,s.y),l=this.nextCoordToPlay(t,c);return new s4(t.turn+1,c,l,!1,a)}{const o=this.nextCoordToPlay(t,t.colorToPlay);return new s4(t.turn+1,t.colorToPlay,o,!0,t.board)}}isLegal(e,t){return A2.isLegal(e,t)}getGameStatus(e){const t=e.gameState,n=t.getCurrentPlayer();if(A2.mustPass(t)&&t.alreadyPassed)return ve.getDefeat(n);const i=A2.getFurthestPiecePositions(t);return 7===i.get(O.ONE)?ve.ONE_WON:0===i.get(O.ZERO)?ve.ZERO_WON:ve.ONGOING}}class aze extends or{getMetrics(e,t){const i=A2.getFurthestPiecePositions(e.gameState);return U1.ofSingle(7-i.get(O.ZERO),i.get(O.ONE))}}class vJ extends Yn{getListMoves(e,t){const n=e.gameState,i=A2.getMovablePieces(n);if(0===i.length)return L.assert(!1===n.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[Ii.PASS];{const o=this.getListMovesFromNonBlockedState(n,i);return yt.sortByDescending(o,s=>s.length()),o}}getListMovesFromNonBlockedState(e,t){const n=[],i=e.getCurrentPlayer();for(const o of t)for(const s of A2.playerDirections(i))for(let a=1;a<$o.SIZE;a++){const c=o.getNext(s,a);if(!e.isOnBoard(c)||!$o.isEmptyAt(e.board,c))break;{const l=Ii.of(o,c);n.push(l)}}return n}}function cze(r,e){if(1&r&&(N(),V(0,"circle",8)),2&r){const t=p(),n=t.$implicit,i=t.index,o=p().index,s=p();v("ngClass",s.piecePlayerClass(n)),w("cx",s.SPACE_SIZE/2+i*s.SPACE_SIZE)("cy",s.SPACE_SIZE/2+o*s.SPACE_SIZE)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function lze(r,e){if(1&r&&(N(),V(0,"rect",9)),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();w("x",s.SPACE_SIZE/2+n*s.SPACE_SIZE-s.SPACE_SIZE/8)("y",s.SPACE_SIZE/2+o*s.SPACE_SIZE-s.SPACE_SIZE/8)("rx",s.isPlayerZero(i)?s.SPACE_SIZE:0)("ry",s.isPlayerZero(i)?s.SPACE_SIZE:0)("width",s.SPACE_SIZE/4)("height",s.SPACE_SIZE/4)("fill",s.pieceColor(i))}}function uze(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"g",4),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),V(2,"rect",5),z(3,cze,1,4,"circle",6)(4,lze,1,7,"rect",7),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();m(),Ce("id","click_",n,"_",i,""),m(),w("x",n*o.SPACE_SIZE)("y",i*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE)("fill",o.backgroundColor(n,i)),m(),v("ngIf",t!==o.UNOCCUPIED),m(),v("ngIf",t!==o.UNOCCUPIED)}}function fze(r,e){if(1&r&&(N(),M(0,"g"),z(1,uze,5,9,"g",1),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function dze(r,e){if(1&r&&(N(),M(0,"g"),V(1,"rect",10)(2,"rect",10),P()),2&r){const t=p();m(),Ce("id","last_move_start_",t.lastPieceMove.get().getStart().x,"_",t.lastPieceMove.get().getStart().y,""),w("x",t.lastPieceMove.get().getStart().x*t.SPACE_SIZE)("y",t.lastPieceMove.get().getStart().y*t.SPACE_SIZE)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),m(),Ce("id","last_move_start_",t.lastPieceMove.get().getEnd().x,"_",t.lastPieceMove.get().getEnd().y,""),w("x",t.lastPieceMove.get().getEnd().x*t.SPACE_SIZE)("y",t.lastPieceMove.get().getEnd().y*t.SPACE_SIZE)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function hze(r,e){if(1&r&&(N(),V(0,"circle",11)),2&r){const t=p();w("cx",t.SPACE_SIZE/2+t.chosen.get().x*t.SPACE_SIZE)("cy",t.SPACE_SIZE/2+t.chosen.get().y*t.SPACE_SIZE)("r",t.SPACE_SIZE/2-t.STROKE_WIDTH)}}let gze=(()=>{class r extends y2{UNOCCUPIED=On.EMPTY;lastMove=h.empty();lastPieceMove=h.empty();chosen=h.empty();chosenAutomatically=!1;constructor(t){super(t),this.setRulesAndNode("Kamisado"),this.availableAIs=[new cn($localize`Minimax`,A2.get(),new aze,new vJ),new kn($localize`MCTS`,new vJ,this.rules)],this.encoder=Ii.encoder,this.hasAsymmetricBoard=!0}backgroundColor(t,n){return $o.getColorAt(t,n).rgb}isPlayerZero(t){return t.player===O.ZERO}pieceColor(t){return t.color.rgb}piecePlayerClass(t){return this.getPlayerClass(t.player)}updateBoard(t){var n=this;return E(function*(){const i=n.getState();n.board=i.getCopiedBoard(),n.canPass=A2.mustPass(i);const o=n.rules.getGameStatus(n.node)!==ve.ONGOING;n.canPass||i.coordToPlay.isAbsent()||o?(n.chosenAutomatically=!1,n.chosen=h.empty()):(n.chosenAutomatically=!0,n.chosen=i.coordToPlay)})()}showLastMove(t){var n=this;return E(function*(){Ii.isPiece(t)&&(n.lastPieceMove=h.of(t))})()}hideLastMove(){this.lastPieceMove=h.empty()}pass(){var t=this;return E(function*(){return hn(t.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),t.chooseMove(Ii.PASS)})()}onClick(t,n){var i=this;return E(function*(){const o=yield i.canUserPlay("#click_"+t+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new _(t,n);if(i.canPass)return i.cancelMove(Me.MUST_PASS());if(i.chosen.isAbsent())return i.choosePiece(t,n);if(!1===i.chosenAutomatically&&i.chosen.equalsValue(s))return i.cancelMoveAttempt(),A.SUCCESS;{const a=i.getState().getPieceAtXY(t,n),c=i.getState().getCurrentPlayer();return a.belongsTo(c)?i.chosenAutomatically?i.cancelMove(Od.PLAY_WITH_SELECTED_PIECE()):(i.chosen=h.of(s),A.SUCCESS):yield i.chooseDestination(t,n)}})()}choosePiece(t,n){var i=this;return E(function*(){const o=i.getState().getPieceAtXY(t,n),s=i.getState().getCurrentOpponent();return o.belongsTo(s)?i.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(i.chosen=h.of(new _(t,n)),A.SUCCESS)})()}chooseDestination(t,n){var i=this;return E(function*(){const o=i.chosen.get(),s=new _(t,n),a=Ii.of(o,s);return i.chooseMove(a)})()}cancelMoveAttempt(){!1===this.chosenAutomatically&&(this.chosen=h.empty())}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-kamisado"]],features:[We],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill selected-stroke",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","last-move-stroke",3,"id"],["id","selectedPiece",1,"base","mid-stroke","no-fill","selected-stroke"]],template:function(n,i){1&n&&(N(),M(0,"svg",0),z(1,fze,2,1,"g",1)(2,dze,3,12,"g",2)(3,hze,1,3,"circle",3),P()),2&n&&(w("viewBox",i.getViewBox().toSVGString())("transform",i.rotation),m(),v("ngForOf",i.board),m(),v("ngIf",i.lastPieceMove.isPresent()),m(),v("ngIf",i.chosen.isPresent()))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const Y=On.EMPTY,RC=On.ZERO.ORANGE,xC=On.ONE.ORANGE,LC=On.ZERO.BLUE,zC=On.ONE.BLUE,qI=On.ZERO.PURPLE,Td=On.ONE.PURPLE,DC=On.ZERO.PINK,VC=On.ONE.PINK,HC=On.ZERO.YELLOW,FC=On.ONE.YELLOW,UC=On.ZERO.RED,$C=On.ONE.RED,GC=On.ZERO.GREEN,BC=On.ONE.GREEN,WC=On.ZERO.BROWN,qC=On.ONE.BROWN;class pze extends Bn{tutorial=[q.informational($localize`Goal of the game`,$localize`At Kamisado, there are two ways to win the game:
        either by moving one of your pieces on the opponent's starting line,
        or by forcing the opponent to make a move that blocks the entire game.
        Here, Dark wins because its brown piece is on Light's starting line, on the top left.`,new s4(5,Ln.ORANGE,h.empty(),!1,[[WC,zC,Td,VC,FC,$C,BC,qC],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,xC,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,GC,UC,HC,DC,qI,LC,RC]])).withPreviousMove(Ii.of(new _(0,7),new _(0,0))),q.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
        At Kamisado, pieces can only move forward, vertically or diagonally.
        You're playing first, with dark pieces, you can make your first move.<br/><br/>
        You're playing Dark, click on the piece of your choice and click on a landing square.`,A2.get().getInitialState(),Ii.of(new _(7,7),new _(3,3)),$localize`Perfect! Note that each of your piece has a different color.`),q.fromMove($localize`Moving`,$localize`Let us now consider the move of Light, after the blue piece has been moved by Dark.
        All moves after the initial move must be made from the piece that corresponds to the color
        of the square upon which the last move ended.
        Here, the last move ended on the pink square, hence the pink piece must move.
        It is already selected, you do not have to click on it.<br/><br/>
        You're playing Light, move your piece on a blue square.`,new s4(1,Ln.PINK,h.of(new _(3,0)),!1,[[xC,zC,Td,VC,FC,$C,BC,qC],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,LC,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[WC,GC,UC,HC,DC,qI,Y,RC]]),[Ii.of(new _(3,0),new _(3,6)),Ii.of(new _(3,0),new _(4,1))],pe.CONGRATULATIONS(),$localize`You have not moved your pink piece on a blue square!`).withPreviousMove(Ii.of(new _(6,7),new _(6,5))),q.informational($localize`Stuck situation`,$localize`Dark moved to another pink square, hence you have to move your pink piece again.
        However, your pink piece is stuck! In this case, you must pass your turn.
        Dark will now have to play by moving its pink piece.`,new s4(1,Ln.PINK,h.of(new _(3,6)),!1,[[xC,zC,Td,Y,FC,$C,BC,qC],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,LC],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,VC,Y,Y,Y,Y],[WC,GC,UC,HC,DC,qI,Y,RC]])).withPreviousMove(Ii.of(new _(6,5),new _(7,4))),q.fromMove($localize`Victory by blocking`,$localize`At any time, if a player blocks the entire game, that player loses.
        In other words, if a player forces its opponent to move a piece that the opponent cannot move,
        and the player cannot move its own piece of the same color, then that player loses.
        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>
        You're playing Dark, analyze the board and make the winning move.`,new s4(2,Ln.RED,h.of(new _(2,4)),!1,[[Y,zC,Td,Y,Y,$C,Y,Y],[Y,Y,Y,FC,Y,Y,Y,Y],[Y,Y,Y,VC,Y,Td,Y,Y],[Y,Y,Y,HC,Y,Y,Y,Y],[Y,Y,UC,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,BC,Y],[xC,Y,Y,Y,Y,DC,Y,qC],[WC,GC,Y,Y,Y,Y,LC,RC]]),[Ii.of(new _(2,4),new _(0,2))],$localize`Perfect!
         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.
         Your orange piece will be stuck and you will have to pass your turn.
         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.
         In this case, the last player to have moved a piece loses.
         Here, your opponent will have moved its green piece last, you therefore win!`,pe.FAILED_TRY_AGAIN()).withPreviousMove(Ii.of(new _(4,0),new _(3,1)))]}let yJ=(()=>{class r extends y2{getParallelogramCoords(t){const n=t.parallelogramHeight,i=n*t.horizontalWidthRatio,o=n*t.offsetRatio,s=i,c=i-o,l=n,u=-o,f=n;return[new _(0,0),new _(s,0),new _(c,l),new _(u,f)]}getCoordTranslation(t,n,i,o){const s=o.parallelogramHeight;return new _(t*(s*o.horizontalWidthRatio)+o.offsetRatio*s*(o.abstractBoardSize-n),n*s-o.pieceHeightRatio*s*i)}static \u0275fac=(()=>{let t;return function(i){return(t||(t=z1(r)))(i||r)}})();static \u0275cmp=$e({type:r,selectors:[["ng-component"]],features:[We],decls:0,vars:0,template:function(n,i){},encapsulation:2})}return r})(),a4=(()=>class r{static CANNOT_GO_BACKWARD=()=>$localize`You cannot go backward with normal pieces!`;static CANNOT_CAPTURE_EMPTY_SPACE=()=>$localize`You cannot capture an empty square, nor jump over it!`;static CANNOT_SKIP_CAPTURE=()=>$localize`You must capture when it is possible!`;static MUST_FINISH_CAPTURING=()=>$localize`You must finish this capture!`;static THIS_PIECE_CANNOT_MOVE=()=>$localize`This piece cannot move!`;static CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL=()=>$localize`A capture should be a double diagonal step. Look at the green indicators to help you!`;static MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL=()=>$localize`You must move in a single diagonal step!`;static CANNOT_CAPTURE_TWICE_THE_SAME_COORD=()=>$localize`You cannot jump over the same square several times!`})();class b2{player;isOfficer;static ZERO=new b2(O.ZERO,!1);static ONE=new b2(O.ONE,!1);static ZERO_OFFICER=new b2(O.ZERO,!0);static ONE_OFFICER=new b2(O.ONE,!0);static getPlayerOfficer(e){return e===O.ZERO?b2.ZERO_OFFICER:b2.ONE_OFFICER}constructor(e,t){this.player=e,this.isOfficer=t}toString(){switch(this){case b2.ZERO:return"u";case b2.ONE:return"v";case b2.ZERO_OFFICER:return"O";default:return L.expectToBe(this,b2.ONE_OFFICER),"X"}}equals(e){return this===e}}class Go{pieces;static EMPTY=new Go([]);constructor(e){this.pieces=e}isEmpty(){return 0===this.pieces.length}isCommandedBy(e){return!this.isEmpty()&&this.getCommander().player===e}getCommander(){return this.pieces[0]}getPiecesUnderCommander(){return new Go(this.pieces.slice(1))}capturePiece(e){return new Go(this.pieces.concat(e))}addStackBelow(e){let t=this;for(const n of e.pieces)t=t.capturePiece(n);return t}getStackSize(){return this.pieces.length}promoteCommander(){let e=this.getCommander();if(e.isOfficer)return this;{e=b2.getPlayerOfficer(e.player);const t=this.getPiecesUnderCommander();return new Go([e]).addStackBelow(t)}}get(e){return this.pieces[e]}toString(e){let t=e-this.getStackSize(),n="";for(;t>0;)n+="_",t--;for(const i of this.pieces)n+=i.toString();return n}}let Kr=(()=>{class r extends $1{static SIZE=7;static of(t,n){return new r(t,n)}static isNotOnBoard(t){return t.isNotInRange(r.SIZE,r.SIZE)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}getStacksOf(t){const n=[];for(let i=0;i<r.SIZE;i++)for(let o=0;o<r.SIZE;o++)this.getPieceAtXY(o,i).isCommandedBy(t)&&n.push(new _(o,i));return n}set(t,n){const i=this.getCopiedBoard();return i[t.y][t.x]=n,new r(i,this.turn)}remove(t){return this.set(t,Go.EMPTY)}incrementTurn(){return new r(this.getCopiedBoard(),this.turn+1)}getFinishLineOf(t){return t===O.ZERO?0:r.SIZE-1}toString(){let t=1;for(let i=0;i<r.SIZE;i++)for(let o=0;o<r.SIZE;o++){const s=this.getPieceAtXY(o,i).getStackSize();t=Math.max(t,s)}const n=[];for(let i=0;i<r.SIZE;i++){const o=[];for(let s=0;s<r.SIZE;s++)o.push(this.getPieceAtXY(s,i).toString(t));n.push(o.join(" "))}return n.join("\n")}}return r})();class mze extends ct{equals(e){if(e.size()!==this.size())return!1;for(let t=0;t<this.size();t++)if(!1===zo(e.get(t),this.get(t)))return!1;return!0}get(e){return L.assert(e<this.values.length,"MGPUniqueList: index out of bounds: "+e),this.values[e]}getFromEnd(e){return L.assert(e<this.values.length,"MGPUniqueList: index (from end) out of bounds: "+e),this.get(this.values.length-1-e)}}class ui extends C2{isStep;static of(e,t){return new ui(e,t)}static fromCapture(e){const t=ui.getSteppedOverCoords(e);return t.isSuccess()?X.success(new ui(e,!1)):X.failure(t.getReason())}static getSteppedOverCoords(e){let t=h.empty();const n=new ct;for(const i of e){if(Kr.isNotOnBoard(i))return X.failure(go.OUT_OF_RANGE(i));if(t.isPresent()){const o=t.get();if(!1===o.getVectorToward(i).isDiagonalOfLength(2))return X.failure(a4.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL());const a=o.getCoordsToward(i)[0];if(n.contains(a))return X.failure(a4.CANNOT_CAPTURE_TWICE_THE_SAME_COORD());n.add(a)}t=h.of(i)}return X.success(n)}static fromStep(e,t){return Kr.isNotOnBoard(e)?X.failure(go.OUT_OF_RANGE(e)):Kr.isNotOnBoard(t)?X.failure(go.OUT_OF_RANGE(t)):!1===e.getVectorToward(t).isDiagonalOfLength(1)?X.failure(a4.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL()):X.success(new ui([e,t],!0))}static encoder=ke.tuple([ke.list(_.encoder),ke.identity()],e=>[e.coords.toList(),e.isStep],e=>ui.of(e[0],e[1]));coords;constructor(e,t){super(),this.isStep=t,this.coords=new mze(e)}toString(){return"LascaMove("+this.coords.toList().map(n=>n.toString()).join(", ")+")"}getRelation(e){const t=this.coords.size(),n=e.coords.size(),i=Math.min(t,n);for(let o=0;o<i;o++)if(!1===this.coords.toList()[o].equals(e.coords.toList()[o]))return"INEQUALITY";return t===n?"EQUALITY":"PREFIX"}equals(e){return"EQUALITY"===this.getRelation(e)}isPrefix(e){return"PREFIX"===this.getRelation(e)}getStartingCoord(){return this.coords.get(0)}getEndingCoord(){return this.coords.getFromEnd(0)}getCapturedCoords(){return ui.getSteppedOverCoords(this.coords.toList())}concatenate(e){const t=this.getEndingCoord(),n=e.coords.toList()[0];hn(t.equals(n),"should not concatenate non-touching move");const i=this.coords.toList(),o=yt.copy(i),s=e.coords.toList(),a=yt.copy(s).slice(1);return ui.fromCapture(o.concat(a)).get()}}class Es extends wr{static singleton=h.empty();static get(){return Es.singleton.isAbsent()&&(Es.singleton=h.of(new Es)),Es.singleton.get()}getInitialState(){const e=new Go([b2.ZERO]),t=new Go([b2.ONE]),n=Go.EMPTY;return new Kr([[t,n,t,n,t,n,t],[n,t,n,t,n,t,n],[t,n,t,n,t,n,t],[n,n,n,n,n,n,n],[e,n,e,n,e,n,e],[n,e,n,e,n,e,n],[e,n,e,n,e,n,e]],0)}getCaptures(e){const t=e.getCurrentPlayer();return this.getCapturesOf(e,t)}getCapturesOf(e,t){const n=[],i=e.getStacksOf(t);for(const o of i)n.push(...this.getPieceCaptures(e,o));return n}getPieceCaptures(e,t){let n=[];const s=e.getPieceAt(t).getCommander().player.getOpponent(),a=this.getPieceDirections(e,t),c=e.getPieceAt(t);for(const l of a){const u=t.getNext(l,1);if(Kr.isOnBoard(u)&&e.getPieceAt(u).isCommandedBy(s)){const f=u.getNext(l,1);if(Kr.isOnBoard(f)&&e.getPieceAt(f).isEmpty()){const g=e.remove(t).remove(u).set(f,c),y=ui.fromCapture([t,f]).get(),S=this.getPieceCaptures(g,f);if(0===S.length)n=n.concat(y);else{const I=S.map(R=>y.concatenate(R));n=n.concat(I)}}}}return n}getPieceDirections(e,t){const o=e.getPieceAt(t).getCommander().player.getScoreModifier(),s=[me.factory.fromDelta(-1,o).get(),me.factory.fromDelta(1,o).get()];return e.getPieceAt(t).getCommander().isOfficer&&s.push(me.factory.fromDelta(-1,-o).get(),me.factory.fromDelta(1,-o).get()),s}getSteps(e){const t=e.getCurrentPlayer();return this.getStepsOf(e,t)}getStepsOf(e,t){const n=[],i=e.getStacksOf(t);for(const o of i)n.push(...this.getPieceSteps(e,o));return n}getPieceSteps(e,t){const n=[],i=this.getPieceDirections(e,t);for(const o of i){const s=t.getNext(o,1);if(Kr.isOnBoard(s)&&e.getPieceAt(s).isEmpty()){const a=ui.fromStep(t,s).get();n.push(a)}}return n}applyLegalMove(e,t,n,i){const o=e.getStartingCoord(),s=e.getEndingCoord();let a=t.getPieceAt(o),c=t.remove(o);if(!1===e.isStep)for(const l of e.getCapturedCoords().get()){const u=t.getPieceAt(l),f=u.getCommander();a=a.capturePiece(f);const g=u.getPiecesUnderCommander();c=c.set(l,g)}if(c=c.set(s,a),s.y===t.getFinishLineOf(t.getCurrentPlayer())){const l=a.promoteCommander();c=c.set(s,l)}return c.incrementTurn()}isLegal(e,t){const n=e.getStartingCoord();if(t.getPieceAt(n).isEmpty())return A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());const i=t.getPieceAt(n),o=t.getCurrentOpponent();if(i.isCommandedBy(o))return A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());const s=e.coords.get(1);if(!1===i.getCommander().isOfficer&&n.getDirectionToward(s).get().y===o.getScoreModifier())return A.failure(a4.CANNOT_GO_BACKWARD());if(!1===t.getPieceAt(s).isEmpty())return A.failure(Me.MUST_LAND_ON_EMPTY_SPACE());const a=this.getCaptures(t);return e.isStep?a.length>0?A.failure(a4.CANNOT_SKIP_CAPTURE()):A.SUCCESS:this.isLegalCapture(e,t,a)}isLegalCapture(e,t,n){const i=t.getCurrentPlayer(),o=e.getCapturedCoords().get();for(const s of o){const a=t.getPieceAt(s);if(a.isCommandedBy(i))return A.failure(Me.CANNOT_SELF_CAPTURE());if(a.isEmpty())return A.failure(a4.CANNOT_CAPTURE_EMPTY_SPACE())}return n.some(s=>s.equals(e))?A.SUCCESS:A.failure(a4.MUST_FINISH_CAPTURING())}getGameStatus(e){const t=e.gameState;return this.getCaptures(t).length>0||this.getSteps(t).length>0?ve.ONGOING:ve.getVictory(t.getCurrentOpponent())}}class MJ extends or{getMetrics(e,t){return this.getControlScore(e)}getControlScore(e){const t=e.gameState,n=U1.of([0],[0]);for(const i of O.PLAYERS)n.add(i,0,this.getNumberOfMobileCoords(t,i));return n}getNumberOfMobileCoords(e,t){const i=this.getCapturesAndSteps(e,t).map(s=>s.getStartingCoord());return new ct(i).size()}getCapturesAndSteps(e,t){const n=Es.get().getCapturesOf(e,t),i=Es.get().getStepsOf(e,t);return n.concat(i)}}class _ze extends Yn{getListMoves(e,t){const n=Es.get().getCaptures(e.gameState);return n.length>0?n:Es.get().getSteps(e.gameState)}}class Cze extends MJ{getMetrics(e,t){const n=this.getControlScore(e),i=this.getDominatedPieceScore(e);return n.concat(i)}getDominatedPieceScore(e){const t=U1.of([0],[0]),n=e.gameState,i=n.getWidth(),o=n.getHeight();for(let s=0;s<o;s++)for(let a=0;a<i;a++){const c=n.getPieceAtXY(a,s);if(c.getStackSize()>0){const l=c.getStackSize();let u=0;const f=c.getCommander().player;for(;u<l&&c.get(u).player===f;)u++;t.add(f,0,u)}}return t}}function vze(r,e){if(1&r&&(N(),V(0,"circle",15)),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().$implicit,s=p(2);Hr("id","square_",o.x,"_",o.y,"_piece_",n,"_officer_symbol"),v("ngClass",i.classes),w("cx",.4*s.SPACE_SIZE)("cy",.575*s.SPACE_SIZE)("r",.045*s.SPACE_SIZE)}}function yze(r,e){if(1&r&&(N(),M(0,"g",12),V(1,"use",13),z(2,vze,1,7,"circle",14),P()),2&r){const t=e.$implicit,n=e.index,i=p().$implicit;w("transform",p(2).getPieceTranslation(n)),m(),Hr("id","square_",i.x,"_",i.y,"_piece_",n,""),v("ngClass",t.classes),m(),v("ngIf",t.isOfficer)}}function Mze(r,e){if(1&r){const t=de();N(),M(0,"g",8)(1,"g",9),W("click",function(){const o=te(t).$implicit;return ne(p(2).onClick(o.x,o.y))}),V(2,"polygon",10),z(3,yze,3,6,"g",11),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();Ce("id","square_at_",n,"_",i,""),m(),Ce("id","coord_",t.x,"_",t.y,""),w("transform",o.getTranslationAtXYZ(n,i,0)),m(),Ce("id","square_",t.x,"_",t.y,""),v("ngClass",t.squareClasses),w("points",o.getParallelogramPoints()),m(),v("ngForOf",t.pieceInfos)}}function Eze(r,e){if(1&r&&(N(),M(0,"g"),z(1,Mze,4,10,"g",7),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}let Pze=(()=>{class r extends yJ{THICKNESS=40;mode={horizontalWidthRatio:1.2,offsetRatio:.4,pieceHeightRatio:1,parallelogramHeight:100,abstractBoardSize:Kr.SIZE};LEFT=0;UP=-this.SPACE_SIZE;basicWidth=this.mode.abstractBoardSize*this.mode.parallelogramHeight;WIDTH=this.basicWidth*(this.mode.horizontalWidthRatio+this.mode.offsetRatio);HEIGHT=this.basicWidth+this.THICKNESS+this.STROKE_WIDTH-this.UP;CX=this.WIDTH/2;CY=(this.HEIGHT+this.UP)/2;adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]};currentMoveClicks=[];capturedCoords=[];legalMoves=[];moveGenerator=new _ze;constructor(t){super(t),this.setRulesAndNode("Lasca"),this.availableAIs=[new cn($localize`Control`,this.rules,new MJ,this.moveGenerator),new cn($localize`Control and Domination`,this.rules,new Cze,this.moveGenerator),new kn($localize`MCTS`,this.moveGenerator,this.rules)],this.encoder=ui.encoder,this.hasAsymmetricBoard=!0}updateBoard(t){var n=this;return E(function*(){const i=n.getState();n.board=i.getCopiedBoard(),n.legalMoves=n.moveGenerator.getListMoves(n.node,n.config),n.createAdaptedBoardFrom(i),n.showPossibleMoves(),n.rotateAdaptedBoardIfNeeded()})()}createAdaptedBoardFrom(t){this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]};for(let o=0;o<Kr.SIZE;o++){const s=[];for(let a=0;a<Kr.SIZE;a++){const c=this.getSpaceInfo(t,a,o);s.push(c)}this.adaptedBoard.spaceInfo.push(s)}const i=h.ofNullable(this.currentMoveClicks[this.currentMoveClicks.length-1]);if(i.isPresent()){const o=i.get();for(const s of this.getSpaceInfoAt(o).pieceInfos)s.classes.push("selected-stroke");this.showPossibleLandings(o,t)}for(const o of this.capturedCoords)this.getSpaceInfoAt(o).squareClasses.push("captured-fill");for(const o of this.currentMoveClicks)this.getSpaceInfoAt(o).squareClasses.push("moved-fill")}getSpaceInfo(t,n,i){const o=t.getPieceAtXY(n,i),s=[];for(let a=o.getStackSize()-1;0<=a;a--){const c=o.get(a);s.push({classes:[this.getPlayerClass(c.player)],isOfficer:c.isOfficer})}return{pieceInfos:s,x:n,y:i,squareClasses:[]}}showLastMove(t){var n=this;return E(function*(){n.showLastCapture(t),n.showSteppedOnCoord(t)})()}showLastCapture(t){if(!1===t.isStep){const n=t.getCapturedCoords();L.assert(n.isSuccess(),"Last move is a capture yet has illegal jumps !?");for(const i of n.get())this.getSpaceInfoAt(i).squareClasses.push("captured-fill")}}showSteppedOnCoord(t){for(const n of t.coords)this.getSpaceInfoAt(n).squareClasses.push("moved-fill")}showPossibleMoves(){if(this.interactive)for(const t of this.legalMoves){const n=t.getStartingCoord();this.getSpaceInfoAt(n).squareClasses.push("selectable-fill")}}getSpaceInfoAt(t){if(this.getPointOfView()===O.ONE&&this.adaptedBoard.isAlreadySwitched){const n=Kr.SIZE-1,i=new _(n-t.x,n-t.y);return this.adaptedBoard.spaceInfo[i.y][i.x]}return this.adaptedBoard.spaceInfo[t.y][t.x]}rotateAdaptedBoardIfNeeded(){if(this.getPointOfView()===O.ONE){const t=[];for(let n=0;n<Kr.SIZE;n++){t[Kr.SIZE-1-n]=[];for(let i=0;i<Kr.SIZE;i++)t[Kr.SIZE-1-n][Kr.SIZE-1-i]=this.getSpaceInfoAt(new _(i,n))}this.adaptedBoard={isAlreadySwitched:!0,spaceInfo:t}}}hideLastMove(){this.createAdaptedBoardFrom(this.getState()),this.rotateAdaptedBoardIfNeeded()}onClick(t,n){var i=this;return E(function*(){const o=yield i.canUserPlay("#coord_"+t+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new _(t,n),a=i.getState().getPieceAt(s),c=i.getState().getCurrentOpponent();return a.isCommandedBy(c)?i.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):0===i.currentMoveClicks.length?i.trySelectingPiece(s):i.moveClick(s)})()}cancelMoveAttempt(){this.currentMoveClicks=[],this.capturedCoords=[],this.createAdaptedBoardFrom(this.getState()),this.showPossibleMoves(),this.rotateAdaptedBoardIfNeeded()}moveClick(t){var n=this;return E(function*(){if(t.equals(n.currentMoveClicks[0]))return n.cancelMoveAttempt(),A.SUCCESS;const i=n.getState().getPieceAt(t),o=n.getState().getCurrentPlayer();if(i.isCommandedBy(o))return n.cancelMoveAttempt(),n.trySelectingPiece(t);if(1===n.currentMoveClicks.length&&n.currentMoveClicks[0].getVectorToward(t).isDiagonalOfLength(1)){const a=ui.fromStep(n.currentMoveClicks[0],t).get();return n.chooseMove(a)}return n.capture(t)})()}capture(t){var n=this;return E(function*(){const o=n.currentMoveClicks[n.currentMoveClicks.length-1],s=o.getVectorToward(t);if(s.isDiagonalOfLength(2)){const a=new _(o.x+s.x/2,o.y+s.y/2);n.capturedCoords.push(a),n.currentMoveClicks.push(t);const c=ui.fromCapture(n.currentMoveClicks).get();return n.legalMoves.some(l=>l.isPrefix(c))?n.applyPartialCapture():n.chooseMove(c)}return n.cancelMove(a4.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL())})()}applyPartialCapture(){let t=this.getState().remove(this.currentMoveClicks[0]),n=this.getState().getPieceAt(this.currentMoveClicks[0]);for(const o of this.capturedCoords){const s=this.getState().getPieceAt(o),a=s.getCommander(),c=s.getPiecesUnderCommander();t=t.set(o,c),n=n.capturePiece(a)}return t=t.set(this.currentMoveClicks[this.currentMoveClicks.length-1],n),this.createAdaptedBoardFrom(t),this.rotateAdaptedBoardIfNeeded(),A.SUCCESS}trySelectingPiece(t){var n=this;return E(function*(){return n.getState().getPieceAt(t).isEmpty()?n.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n.selectPiece(t)})()}selectPiece(t){var n=this;return E(function*(){return n.capturedCoords=[],n.legalMoves.some(i=>i.getStartingCoord().equals(t))?(n.currentMoveClicks=[t],n.hideLastMove(),A.SUCCESS):n.cancelMove(a4.THIS_PIECE_CANNOT_MOVE())})()}showPossibleLandings(t,n){const i=this.rules.getPieceCaptures(n,t);if(0===i.length){const o=this.rules.getPieceSteps(n,t);for(const s of o)this.getSpaceInfoAt(s.getEndingCoord()).squareClasses.push("selectable-fill")}else{const o=i.map(s=>s.coords.get(1));for(const s of o)this.getSpaceInfoAt(s).squareClasses.push("capturable-fill")}}getTranslationAtXYZ(t,n,i){const o=this.getCoordTranslation(t,n,i,this.mode);return"translate("+o.x+" "+o.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForLasca().map(n=>n.x+", "+n.y).join(" ")}getParallelogramCoordsForLasca(){return this.getParallelogramCoords(this.mode)}getParallelogramCenter(){const t=this.getParallelogramCoordsForLasca();return this.getParallelogramCenterOf(t[0],t[1],t[2],t[3])}getParallelogramCenterOf(t,n,i,o){const s=Math.max(t.x,n.x,i.x,o.x),a=Math.max(t.y,n.y,i.y,o.y),c=Math.min(t.x,n.x,i.x,o.x),l=Math.min(t.y,n.y,i.y,o.y);return new _((s-c)/2,(a-l)/2)}getRightEdge(){const t=this.basicWidth*this.mode.horizontalWidthRatio,n=this.basicWidth*this.mode.offsetRatio;return[n+t,0,n+t,this.THICKNESS,t,this.basicWidth+this.THICKNESS,t,this.basicWidth].join(" ")}getPieceTranslation(t){return"translate(0 "+(this.getParallelogramCenter().y-32.5-t*(.15*this.SPACE_SIZE))+")"}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-lasca"]],features:[We],decls:8,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 25 v 15 a 40 25, 0, 0, 0, 80 0 v -15 a 40 25, 0, 0, 0, -80 0 Z"],["cx","40","cy","25","rx","40","ry","25"],[4,"ngFor","ngForOf"],["x","0",1,"base"],[1,"base"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[3,"id","click"],[1,"base",3,"id","ngClass"],["pointer-events","fill","class","base mid-small-stroke",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base","mid-small-stroke"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"id","ngClass"],[3,"id","ngClass",4,"ngIf"],[3,"id","ngClass"]],template:function(n,i){1&n&&(N(),M(0,"svg",0)(1,"defs")(2,"g",1),V(3,"path",2)(4,"ellipse",3),P()(),z(5,Eze,2,1,"g",4),V(6,"rect",5)(7,"polygon",6),P()),2&n&&(w("viewBox",i.LEFT+" "+i.UP+" "+i.WIDTH+" "+i.HEIGHT),m(5),v("ngForOf",i.adaptedBoard.spaceInfo),m(),w("y",i.basicWidth)("width",i.basicWidth*i.mode.horizontalWidthRatio)("height",i.THICKNESS),m(),w("points",i.getRightEdge()))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const EJ=b2.ZERO,jI=b2.ONE,Xr=new Go([EJ]),W1=new Go([jI]),Sze=new Go([EJ,jI]),Oze=new Go([b2.ZERO_OFFICER,jI]),Z=Go.EMPTY;class Tze extends Bn{tutorial=[q.informational($localize`Lasca: origins`,$localize`Lasca is a game based on draughts created in 1911 by Emanuel Lasker, chess world champion. It's played on a 7x7 board, each player has 11 pieces.`,Es.get().getInitialState()),q.informational($localize`Goal of the game`,$localize`The goal of Lasca is, like for draughts, to render the opponent unable to move, either by capturing all his pieces, either by blocking them.`,Es.get().getInitialState()),q.anyMove($localize`Steps`,$localize`A simple step is made by one diagonal move forward, left or right. Click on the chosen piece, then on its landing square.<br/><br/>You are playing Dark, do the first move.`,Es.get().getInitialState(),ui.fromStep(new _(4,4),new _(3,3)).get(),pe.CONGRATULATIONS()),q.anyMove($localize`Captures`,$localize`A capture happens when you jump diagonally over an opponent piece to land right behind it. You have to capture when you can. It is the case here, so click on the piece that must capture, and then on its landing square.<br/><br/>You're playing Dark, go ahead.`,Kr.of([[W1,Z,Z,Z,W1,Z,W1],[Z,Z,Z,W1,Z,W1,Z],[Z,Z,W1,Z,W1,Z,W1],[Z,W1,Z,Z,Z,Z,Z],[Xr,Z,Xr,Z,Xr,Z,Xr],[Z,Xr,Z,Xr,Z,Xr,Z],[Xr,Z,Xr,Z,Xr,Z,Xr]],2),ui.fromCapture([new _(2,4),new _(0,2)]).get(),$localize`Congratulations, notice that the captured piece was not removed from the board, but put below the capturing pieces.`),q.anyMove($localize`Multiple captures`,$localize`If, after the beginning of your capture, the piece that you just moved can capture another piece, it has to capture until it can no longer capture. To do so, you must then click again on the next landing square. Note that, you cannot jump twice over the same stack.<br/><br/>You are playing Dark, a double capture is possible, go ahead.`,Kr.of([[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[W1,Z,Z,Z,W1,Z,W1],[Z,W1,Z,W1,Z,W1,Z],[Z,Z,W1,Z,W1,Z,W1],[Z,W1,Z,Z,Z,Z,Z],[Z,Z,Xr,Z,Xr,Z,Xr]],2),ui.fromCapture([new _(2,6),new _(0,4),new _(2,2)]).get(),pe.CONGRATULATIONS()),q.informational($localize`Minority capture is allowed`,$localize`If you have several capture choices, you are allowed to choose any of them. For example if one choice is to capture one piece, and the other choice is to capture two pieces, you can choose either.`,Kr.of([[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,W1,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,W1,Z,W1,Z,Z,Z],[Z,Z,Xr,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z]],2)),q.fromMove($localize`Promotion`,$localize`When a stack reaches the last line, its commander becomes an officer, and gains the ability to go backward, which is illegal for the other pieces! One of your piece could be promoted now.<br/><br/>You're playing Dark. Do it.`,Kr.of([[Z,Z,Z,Z,Z,Z,W1],[Z,Z,Z,Sze,Z,W1,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Xr,Z,Xr,Z,Xr]],2),[ui.fromStep(new _(3,1),new _(2,0)).get(),ui.fromStep(new _(3,1),new _(4,0)).get()],pe.CONGRATULATIONS(),$localize`You did not choose the correct stack, and got no promotion.`),q.fromMove($localize`Officer move`,$localize`Officers can move and capture backward as well as forward.<br/><br/>You're playing Dark, move your officier!`,Kr.of([[Z,Z,Z,Z,Oze,Z,W1],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,W1,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Xr,Z,Xr,Z,Xr]],2),[ui.fromStep(new _(4,0),new _(3,1)).get(),ui.fromStep(new _(4,0),new _(5,1)).get()],pe.CONGRATULATIONS(),$localize`You did not move your officer.`)]}let Y2=(()=>{class r extends $1{static SIZE=8;static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}}return r})();class yo extends Do{direction;static encoder=q2.getFallibleEncoder(yo.from);static from(e,t){const n=me.factory.fromMove(e,t);return n.isFailure()?X.failure(n.getReason()):e.isNotInRange(Y2.SIZE,Y2.SIZE)?X.failure("start coord is not in range"):t.isNotInRange(Y2.SIZE,Y2.SIZE)?X.failure("end coord is not in range"):X.success(new yo(e,t,n.get()))}constructor(e,t,n){super(e,t),this.direction=n,this.direction=me.factory.fromMove(e,t).get()}toString(){return"LinesOfActionMove("+this.getStart()+"->"+this.getEnd()+")"}}let ZI=(()=>class r{static INVALID_MOVE_LENGTH=()=>$localize`Your move should have a length equal to the number of pieces that exist on the same line.`;static CANNOT_JUMP_OVER_OPPONENT=()=>$localize`You cannot jump over the opponent's pieces.`;static PIECE_CANNOT_MOVE=()=>$localize`This piece has no possible move, select another one.`})();class ki extends wr{static singleton=h.empty();static get(){return ki.singleton.isAbsent()&&(ki.singleton=h.of(new ki)),ki.singleton.get()}getInitialState(){const e=B.NONE,t=B.ZERO,n=B.ONE;return new Y2([[e,t,t,t,t,t,t,e],[n,e,e,e,e,e,e,n],[n,e,e,e,e,e,e,n],[n,e,e,e,e,e,e,n],[n,e,e,e,e,e,e,n],[n,e,e,e,e,e,e,n],[n,e,e,e,e,e,e,n],[e,t,t,t,t,t,t,e]],0)}static getNumberOfGroups(e){const t=it.create(Y2.SIZE,Y2.SIZE,-1),n=we.of(0,0);let i=0;for(const o of e.getCoordsAndContents())-1===t[o.coord.y][o.coord.x]&&o.content.isPlayer()&&(i+=1,ki.markGroupStartingAt(e,t,o.coord,i),n.add(o.content,1));return n}static markGroupStartingAt(e,t,n,i){const o=[n],s=e.getPieceAt(n);for(;o.length>0;){const a=L.getNonNullable(o.pop());if(-1===t[a.y][a.x]){const c=e.getPieceAt(a);if(c===s){t[a.y][a.x]=i;for(const l of me.DIRECTIONS){const u=a.getNext(l);e.isOnBoard(u)&&o.push(u)}}else c===B.NONE&&(t[a.y][a.x]=0)}}}applyLegalMove(e,t,n,i){const o=t.getCopiedBoard();return o[e.getStart().y][e.getStart().x]=B.NONE,o[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer(),new Y2(o,t.turn+1)}static isLegal(e,t){const n=t.getPieceAt(e.getStart());return n===B.NONE?A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===t.getCurrentOpponent()?A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):e.length()!==this.numberOfPiecesOnLine(t,e.getStart(),e.direction)?A.failure(ZI.INVALID_MOVE_LENGTH()):e.getStart().getCoordsToward(e.getEnd()).some(i=>t.getPieceAt(i)===t.getCurrentOpponent())?A.failure(ZI.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.getEnd())===t.getCurrentPlayer()?A.failure(Me.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):A.SUCCESS}isLegal(e,t){return ki.isLegal(e,t)}static numberOfPiecesOnLine(e,t,n){let i=0;for(const o of ki.getLineCoords(t,n))e.getPieceAt(o).isPlayer()&&(i+=1);return i}static getLineCoords(e,t){const n=ki.getEntranceAndForwardDirection(e,t);let i=n[0];const o=n[1],s=[];for(;Y2.isOnBoard(i);)s.push(i),i=i.getNext(o);return s}static getEntranceAndForwardDirection(e,t){switch(t){case me.UP:case me.DOWN:return[new _(e.x,0),me.DOWN];case me.LEFT:case me.RIGHT:return[new _(0,e.y),me.RIGHT];case me.UP_RIGHT:case me.DOWN_LEFT:return[new _(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),me.UP_RIGHT];default:return L.expectToBeMultiple(t,[me.UP_LEFT,me.DOWN_RIGHT]),[new _(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),me.DOWN_RIGHT]}}static getVictory(e){const t=ki.getNumberOfGroups(e),n=t.get(O.ZERO),i=t.get(O.ONE);return 1===n&&1===i?h.of(B.NONE):1===n?h.of(O.ZERO):1===i?h.of(O.ONE):h.empty()}static possibleTargets(e,t){const n=[];for(const i of me.DIRECTIONS){const o=ki.numberOfPiecesOnLine(e,t,i),s=t.getNext(i,o);if(e.isOnBoard(s)){const a=yo.from(t,s).get();ki.isLegal(a,e).isSuccess()&&n.push(s)}}return n}getGameStatus(e){const n=ki.getNumberOfGroups(e.gameState),i=n.get(O.ZERO),o=n.get(O.ONE);return 1===i&&o>1?ve.ZERO_WON:i>1&&1===o?ve.ONE_WON:ve.ONGOING}}class Aze extends or{getMetrics(e,t){const i=ki.getNumberOfGroups(e.gameState);return U1.ofSingle(100/i.get(O.ZERO),100/i.get(O.ONE))}}class PJ extends Yn{getListMoves(e,t){const n=e.gameState,i=[];if(ki.getVictory(n).isPresent())return i;for(let o=0;o<Y2.SIZE;o++)for(let s=0;s<Y2.SIZE;s++){const a=new _(s,o);if(n.getPieceAt(a).isPlayer())for(const l of ki.possibleTargets(n,a)){const u=yo.from(a,l).get();i.push(u)}}return i}}function bze(r,e){if(1&r&&(N(),V(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();Ce("id","piece_",t,"_",n,""),v("ngClass",i.getPieceClasses(t,n)),w("cx",i.SPACE_SIZE/2+t*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function wze(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"g",3),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),V(2,"rect",4),z(3,bze,1,6,"circle",5),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();m(),Ce("id","click_",n,"_",i,""),m(),Ce("id","space_",n,"_",i,""),v("ngClass",o.getSquareClasses(n,i)),w("x",n*o.SPACE_SIZE)("y",i*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),m(),v("ngIf",t!==o.EMPTY)}}function Nze(r,e){if(1&r&&(N(),M(0,"g"),z(1,wze,4,10,"g",1),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function Ize(r,e){if(1&r){const t=de();N(),M(0,"rect",6),W("click",function(){const o=te(t).$implicit;return ne(p().onClick(o.x,o.y))}),P()}if(2&r){const t=e.$implicit,n=p();w("x",t.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",t.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}let kze=(()=>{class r extends y2{INDICATOR_SIZE=20;EMPTY=B.NONE;targets=[];state;selected=h.empty();lastMoved=[];captured=h.empty();constructor(t){super(t),this.setRulesAndNode("LinesOfAction"),this.availableAIs=[new cn($localize`Minimax`,this.rules,new Aze,new PJ),new kn($localize`MCTS`,new PJ,this.rules)],this.encoder=yo.encoder}onClick(t,n){var i=this;return E(function*(){const o=yield i.canUserPlay("#click_"+t+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new _(t,n);if(i.selected.equalsValue(s))return i.cancelMoveAttempt(),A.SUCCESS;const a=i.getState().getCurrentPlayer();return i.selected.isAbsent()||i.getState().getPieceAt(s)===a?i.select(s):i.concludeMove(s)})()}concludeMove(t){var n=this;return E(function*(){const i=yo.from(n.selected.get(),t);return i.isSuccess()?n.chooseMove(i.get()):n.cancelMove(i.getReason())})()}select(t){var n=this;return E(function*(){const i=n.getState().getPieceAt(t);return i===B.NONE?n.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):i===n.getState().getCurrentOpponent()?n.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(n.selected=h.of(t),n.targets=ki.possibleTargets(n.getState(),n.selected.get()),0===n.targets.length?n.cancelMove(ZI.PIECE_CANNOT_MOVE()):A.SUCCESS)})()}updateBoard(t){var n=this;return E(function*(){n.cancelMoveAttempt(),n.board=n.getState().board})()}showLastMove(t){var n=this;return E(function*(){n.getPreviousState().getPieceAt(t.getEnd()).isPlayer()&&(n.captured=h.of(t.getEnd()));const i=t.getStart(),o=t.getEnd();n.lastMoved=[i,o]})()}hideLastMove(){this.captured=h.empty(),this.lastMoved=[]}cancelMoveAttempt(){this.selected=h.empty(),this.targets=[]}getSquareClasses(t,n){const i=new _(t,n);return this.captured.equalsValue(i)?["captured-fill"]:this.lastMoved.some(o=>o.equals(i))?["moved-fill"]:[]}getPieceClasses(t,n){const i=this.board[n][t],o=new _(t,n),s=[this.getPlayerClass(i)];return this.selected.isPresent()&&this.selected.get().equals(o)&&s.push("selected-stroke"),s}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-linesofaction"]],features:[We],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"indicator",3,"click"]],template:function(n,i){1&n&&(N(),M(0,"svg",0),z(1,Nze,2,1,"g",1)(2,Ize,1,4,"rect",2),P()),2&n&&(w("viewBox",i.getViewBox().toSVGString()),m(),v("ngForOf",i.board),m(),v("ngForOf",i.targets))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const F=B.NONE,A1=B.ZERO,M1=B.ONE;class Rze{tutorial=[q.informational($localize`Goal of the game`,$localize`At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.
        Here, Dark wins the game:
        Dark's pieces are forming a single group, while Light's pieces form three groups.`,new Y2([[F,F,F,F,F,F,F,F],[M1,F,F,F,A1,F,F,M1],[F,F,A1,A1,M1,F,F,F],[F,F,F,A1,F,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F]],0)),q.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
         Moves can be made orthogonally or diagonally.
         The length of a move is equal to the number of pieces that are on the line of the move.
         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>
         You're playing Dark, make the first move!`,ki.get().getInitialState(),yo.from(new _(1,7),new _(1,5)).get(),pe.CONGRATULATIONS()),q.fromMove($localize`Jumping`,$localize`During a move, it is possible to jump above your own pieces.
        But it is forbidden to jump over the opponent's pieces.<br/><br/>
        You're playing Dark, make a jump over one of your pieces on the following board.`,new Y2([[F,F,F,F,F,F,F,F],[F,F,M1,A1,A1,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,M1],[F,F,F,F,F,F,F,A1]],0),[yo.from(new _(3,1),new _(6,1)).get()],pe.CONGRATULATIONS(),$localize`Failed. You did not jump over one of your pieces.`),q.fromMove($localize`Moving`,$localize`Here is a different board. Pick the dark piece in the middle (line 4, column 4)
        and observe its possible moves.
        <ul>
            <li>Horizontally, this piece can move only of one square because it is the only piece on this line.</li>
            <li>Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.
                But it can only go up, as below it the landing square is occupied by one of your pieces.</li>
            <li>Diagonally, only one move is possible: on the diagonal that contains three pieces,
                only in the direction where it does not jump over one of the opponent's pieces.
                On the other diagonal, there are too many pieces to end the move on the board.</li>
        </ul><br/>
        You're playing Dark, make one of these moves.`,new Y2([[F,F,F,F,F,F,M1,F],[F,F,F,F,F,A1,F,F],[F,F,F,F,M1,F,F,F],[F,F,F,A1,F,F,F,F],[F,F,F,F,F,F,F,M1],[F,F,F,F,F,M1,F,M1],[F,F,F,A1,F,F,M1,M1],[F,F,F,A1,F,F,F,F]],0),[yo.from(new _(3,3),new _(3,0)).get(),yo.from(new _(3,3),new _(0,0)).get(),yo.from(new _(3,3),new _(2,3)).get(),yo.from(new _(3,3),new _(4,3)).get()],pe.CONGRATULATIONS(),$localize`Failed. This was not one of the expected moves.`),q.fromPredicate($localize`Captures`,$localize`If a move ends on an opponent's piece, it is captured and removed from the board.
        However, a move cannot end on one of the player's pieces.
        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!
        If a player has only one piece, that player wins the game.<br/><br/>
        On the following board, try to capture one piece with Dark.`,new Y2([[F,A1,F,A1,A1,A1,A1,F],[M1,F,F,F,F,F,F,M1],[F,F,A1,F,M1,F,F,F],[M1,F,F,F,F,F,F,M1],[M1,F,F,F,F,F,F,M1],[M1,F,F,F,F,F,F,M1],[M1,F,F,F,F,F,F,M1],[F,A1,A1,A1,A1,A1,A1,F]],0),yo.from(new _(2,2),new _(4,2)).get(),(e,t,n)=>t.getPieceAt(e.getEnd())===B.ONE?A.SUCCESS:A.failure(pe.FAILED_TRY_AGAIN()),pe.CONGRATULATIONS()),q.fromMove($localize`Tie`,$localize`In the special case where a move ends up connecting all pieces of both player, simultaneously,
        then the game ends up with a tie.<br/><br/>
        You're playing Dark, force the tie in one move.`,new Y2([[F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F],[A1,F,F,A1,M1,A1,F,F],[F,F,F,A1,F,F,F,M1],[F,F,F,F,F,F,F,M1],[F,F,F,F,F,F,F,M1],[F,F,F,F,F,F,F,M1],[F,F,F,F,F,F,F,F]],0),[yo.from(new _(0,2),new _(4,2)).get()],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN())]}class ja extends Nr{direction;orientation;captures;static encoder=new class extends ke{encode(e){return{coord:_.encoder.encode(e.coord),direction:e.direction,orientation:e.orientation,captures:e.captures}}decode(e){const t=e;return hn(null!=t.coord,"Invalid encoded LodestoneMove"),hn(null!=t.direction,"Invalid encoded LodestoneMove"),hn(null!=t.orientation,"Invalid encoded LodestoneMove"),hn(null!=t.captures,"Invalid encoded LodestoneMove"),new ja(_.encoder.decode(t.coord),t.direction,t.orientation,t.captures)}};constructor(e,t,n,i={top:0,bottom:0,left:0,right:0}){super(e.x,e.y),this.direction=t,this.orientation=n,this.captures=i}toString(){return`LodestoneMove(${this.coord.toString()}, ${this.direction}, ${this.orientation}, { top: ${this.captures.top}, bottom: ${this.captures.bottom}, left: ${this.captures.left}, right: ${this.captures.right} })`}equals(e){return this===e||!(!1===this.coord.equals(e.coord)||this.orientation!==e.orientation||this.direction!==e.direction||this.captures.top!==e.captures.top||this.captures.bottom!==e.captures.bottom||this.captures.left!==e.captures.left||this.captures.right!==e.captures.right)}}class Mo{unreachable;static UNREACHABLE=new Mo(!0);static EMPTY=new Mo(!1);owner=B.NONE;constructor(e){this.unreachable=e}isLodestone(){return!1}isPlayerPiece(){return!1}isEmpty(){return!0}isUnreachable(){return this.unreachable}equals(e){return this===e}}class Kc{owner;static ZERO=new Kc(O.ZERO);static ONE=new Kc(O.ONE);static of(e){return e===O.ZERO?Kc.ZERO:Kc.ONE}constructor(e){this.owner=e}isLodestone(){return!1}isPlayerPiece(){return!0}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}class yr{owner;direction;orientation;static ZERO_PUSH_DIAGONAL=new yr(O.ZERO,"push","diagonal");static ZERO_PUSH_ORTHOGONAL=new yr(O.ZERO,"push","orthogonal");static ZERO_PULL_DIAGONAL=new yr(O.ZERO,"pull","diagonal");static ZERO_PULL_ORTHOGONAL=new yr(O.ZERO,"pull","orthogonal");static ONE_PUSH_DIAGONAL=new yr(O.ONE,"push","diagonal");static ONE_PUSH_ORTHOGONAL=new yr(O.ONE,"push","orthogonal");static ONE_PULL_DIAGONAL=new yr(O.ONE,"pull","diagonal");static ONE_PULL_ORTHOGONAL=new yr(O.ONE,"pull","orthogonal");static LODESTONES={0:{push:{diagonal:yr.ZERO_PUSH_DIAGONAL,orthogonal:yr.ZERO_PUSH_ORTHOGONAL},pull:{diagonal:yr.ZERO_PULL_DIAGONAL,orthogonal:yr.ZERO_PULL_ORTHOGONAL}},1:{push:{diagonal:yr.ONE_PUSH_DIAGONAL,orthogonal:yr.ONE_PUSH_ORTHOGONAL},pull:{diagonal:yr.ONE_PULL_DIAGONAL,orthogonal:yr.ONE_PULL_ORTHOGONAL}}};constructor(e,t,n){this.owner=e,this.direction=t,this.orientation=n}static of(e,t){return yr.LODESTONES[e.getValue()][t.direction][t.orientation]}isLodestone(){return!0}isPlayerPiece(){return!1}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}class Eo{plates;static of(e){let t=[];for(const n of e){const i=new c4(n,[]);t=t.concat(i)}return new Eo(t)}constructor(e){this.plates=e}getCrumbledPlates(){const e=[];for(const t of this.plates){if(0!==t.getRemainingSpaces())return e;e.push(t)}return e}getCurrentPlate(){for(const e of this.plates)if(e.getRemainingSpaces()>0)return h.of(e);return h.empty()}getFollowingPlates(){const e=[];let t=!1;for(const n of this.plates)t?e.push(n):n.getRemainingSpaces()>0&&(t=!0);return e}getCurrentPlateWidth(){const e=this.getCurrentPlate(),t=new c4(0,[]);return e.getOrElse(t).width}getGroupRemainingSpaces(){return this.plates.map(n=>n.getRemainingSpaces()).reduce((n,i)=>n+i)}addCaptured(e,t){if(0===t)return this;const n=this.getGroupRemainingSpaces();L.assert(t<=n,`should never put more pieces than the plate can support (${n} > ${t})`);const i=this.getCrumbledPlates(),o=this.getCurrentPlate().get(),s=this.getFollowingPlates(),a=yt.copy(o.getPiecesCopy()),c=Math.min(t,o.getRemainingSpaces());for(let f=0;f<c;f++)a.push(Kc.of(e)),t--;const l=new c4(o.width,a);return new Eo(i.concat(l).concat(s)).addCaptured(e,t)}getFillablePlateIndex(){let e=0;for(const t of this.plates){if(t.getRemainingSpaces()>0)return e;e++}return-1}}let c4=(()=>class r{width;pieces;static POSITIONS=["top","bottom","left","right"];constructor(t,n){this.width=t,this.pieces=n}getPieceAt(t){return t<this.pieces.length?this.pieces[t]:Mo.EMPTY}getRemainingSpaces(){return this.width-this.pieces.length}getPiecesCopy(){return yt.copy(this.pieces)}})();var jC;!function(r){r.getInitialLodestonePressurePlates=function e(t){const n={};for(const i of c4.POSITIONS)n[i]=Eo.of(t);return n}}(jC||(jC={}));class b1 extends $1{lodestones;pressurePlates;static SIZE=8;static NUMBER_OF_PIECES=24;static INITIAL_PRESSURE_PLATES=jC.getInitialLodestonePressurePlates([5,3]);constructor(e,t,n,i){super(e,t),this.lodestones=n,this.pressurePlates=i}withBoard(e){return new b1(e,this.turn,this.lodestones,this.pressurePlates)}remainingSpaces(){const e=this.remainingSpacesDetails();return e.top+e.bottom+e.left+e.right}remainingSpacesDetails(){const e={top:0,bottom:0,left:0,right:0};for(const t of c4.POSITIONS){const n=this.pressurePlates[t];e[t]=-1===n.getFillablePlateIndex()?0:n.getGroupRemainingSpaces()}return e}numberOfPieces(){const e=we.of(0,0);for(let t=0;t<b1.SIZE;t++)for(let n=0;n<b1.SIZE;n++){const i=this.getPieceAtXY(n,t);i.isPlayerPiece()&&e.add(i.owner,1)}return e}getScores(){const e=this.numberOfPieces();return we.of(b1.NUMBER_OF_PIECES-e.get(O.ONE),b1.NUMBER_OF_PIECES-e.get(O.ZERO))}nextLodestoneDirection(){const e=this.getCurrentPlayer(),t=this.lodestones.get(e);if(!t.isPresent())return h.empty();{const n=this.getPieceAt(t.get());switch(hn(n.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+t.get()),n.direction){case"push":return h.of("pull");case"pull":return h.of("push")}}}}let mu=(()=>class r{static MUST_FLIP_LODESTONE=()=>$localize`You must flip your lodestone before putting it back on the board.`;static MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES=()=>$localize`As long as there are pressure plates, you must place all the pieces that you have captured on them.`;static TARGET_IS_CRUMBLED=()=>$localize`You must place your lodestone on a non-crumbled square!`;static TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE=()=>$localize`You placed too many captures on the same pressure plate, which has not enough space left.`;static MUST_PLACE_CAPTURES=()=>$localize`You must place your captures on the pressure plates, on the side of the board.`;static NO_CAPTURES_TO_PLACE_YET=()=>$localize`You cannot place any capture now, you must first place your lodestone on the board!`})();class fi extends wr{static THREATENED_COORD_RANGE=fn.from({top:{start:e=>new _(0,e),direction:me.RIGHT},bottom:{start:e=>new _(0,b1.SIZE-(e+1)),direction:me.RIGHT},left:{start:e=>new _(e,0),direction:me.DOWN},right:{start:e=>new _(b1.SIZE-(e+1),0),direction:me.DOWN}});static singleton=h.empty();static get(){return fi.singleton.isAbsent()&&(fi.singleton=h.of(new fi)),fi.singleton.get()}getInitialState(){const e=Mo.EMPTY,t=Kc.ZERO,n=Kc.ONE,i=[[e,e,t,n,t,n,e,e],[e,t,n,t,n,t,n,e],[t,n,t,n,t,n,t,n],[n,t,n,e,e,t,n,t],[t,n,t,e,e,n,t,n],[n,t,n,t,n,t,n,t],[e,n,t,n,t,n,t,e],[e,e,n,t,n,t,e,e]],o=jC.getInitialLodestonePressurePlates([5,3]);return new b1(i,0,new fn,o)}applyLegalMove(e,t,n,i){const o=t.getCurrentPlayer(),s=o.getOpponent(),a=it.copy(i.board),c=t.lodestones.getCopy();c.put(o,e.coord);const l={...t.pressurePlates};return this.updatePressurePlates(a,l,c,s,e.captures),new b1(a,t.turn+1,c,l)}updatePressurePlates(e,t,n,i,o){for(const s of c4.POSITIONS)t[s]=this.updatePressurePlate(e,s,t[s],n,i,o[s])}updatePressurePlate(e,t,n,i,o,s){if(n.getCurrentPlate().isPresent()){const a=n.addCaptured(o,s),c=fi.THREATENED_COORD_RANGE.get(t).get(),l=a.getCrumbledPlates().length;for(let u=0;u<l;u++)this.removePressurePlate(e,c.start(u,a.plates[u].width),c.direction,i);return a}return n}removePressurePlate(e,t,n,i){for(let o=t;o.isInRange(b1.SIZE,b1.SIZE);o=o.getNext(n)){for(const s of O.PLAYERS)i.get(s).equalsValue(o)&&i.delete(s);e[o.y][o.x]=Mo.UNREACHABLE}}isLegal(e,t){const n=this.isLegalWithoutCaptures(t,e.coord,e.direction);if(n.isFailure())return X.failure(n.getReason());const i=this.applyMoveWithoutPlacingCaptures(t,e.coord,e);if(e.captures.top+e.captures.bottom+e.captures.left+e.captures.right!==Math.min(i.captures.length,t.remainingSpaces()))return X.failure(mu.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());for(const a of c4.POSITIONS)if(t.pressurePlates[a].getGroupRemainingSpaces()<e.captures[a])return X.failure(mu.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE());return X.success(i)}applyMoveWithoutPlacingCaptures(e,t,n){let i;const o=it.copy(e.board),s=e.lodestones.get(e.getCurrentPlayer());if(s.isPresent()){const a=s.get();o[a.y][a.x]=Mo.EMPTY}return i="pull"===n.direction?this.applyPull(e,o,t,n.orientation):this.applyPush(e,o,t,n.orientation),i.board[t.y][t.x]=yr.of(e.getCurrentPlayer(),n),i.moved.push(t),i}applyPull(e,t,n,i){const o=e.getCurrentPlayer(),s=o.getOpponent(),a=[],c=[],l="diagonal"===i?me.DIAGONALS:me.ORTHOGONALS;for(const u of l)for(let f=n.getNext(u);e.isOnBoard(f);f=f.getNext(u)){const g=t[f.y][f.x],y=f.getNext(u);if(e.isOnBoard(y)){const S=t[y.y][y.x];S.isPlayerPiece()&&S.owner===o&&(g.isEmpty()?(c.push(f),t[f.y][f.x]=S,c.push(y),t[y.y][y.x]=Mo.EMPTY):g.isPlayerPiece()&&g.owner===s&&(a.push(f),t[f.y][f.x]=S,c.push(y),t[y.y][y.x]=Mo.EMPTY))}}return{board:t,captures:a,moved:c}}applyPush(e,t,n,i){const s=e.getCurrentPlayer().getOpponent(),a=[],c=[],l="diagonal"===i?me.DIAGONALS:me.ORTHOGONALS;for(const u of l)for(let g=n.getNext(u,b1.SIZE);!1===g.equals(n);g=g.getPrevious(u))if(e.isOnBoard(g)){const y=t[g.y][g.x];if(y.isPlayerPiece()&&y.owner===s){const S=g.getNext(u);if(e.isOnBoard(S)){const I=t[S.y][S.x];I.isUnreachable()?(a.push(g),t[g.y][g.x]=Mo.EMPTY):I.isEmpty()&&(c.push(S),t[S.y][S.x]=y,c.push(g),t[g.y][g.x]=Mo.EMPTY)}else a.push(g),t[g.y][g.x]=Mo.EMPTY}}return{board:t,captures:a,moved:c}}isLegalWithoutCaptures(e,t,n){const i=this.isTargetLegal(e,t);if(i.isFailure())return i;const o=e.nextLodestoneDirection();return!1===(o.isAbsent()||o.equalsValue(n))?A.failure(mu.MUST_FLIP_LODESTONE()):A.SUCCESS}isTargetLegal(e,t){const n=e.getPieceAt(t);if(n.isUnreachable())return A.failure(mu.TARGET_IS_CRUMBLED());if(n.isPlayerPiece())return A.failure(Me.MUST_CLICK_ON_EMPTY_SQUARE());const i=e.getCurrentPlayer();return n.isLodestone()&&n.owner!==i?A.failure(Me.MUST_CLICK_ON_EMPTY_SQUARE()):A.SUCCESS}getGameStatus(e){const n=e.gameState.numberOfPieces(),i=n.get(O.ZERO),o=n.get(O.ONE);return 0===i&&0===o?ve.DRAW:0===i?ve.ONE_WON:0===o?ve.ZERO_WON:ve.ONGOING}}const Re=Mo.UNREACHABLE,J=Mo.EMPTY,Rr=Kc.ZERO,K2=Kc.ONE,Ad=yr.ONE_PUSH_ORTHOGONAL,YI=b1.INITIAL_PRESSURE_PLATES;class xze extends Bn{tutorial=[q.informational($localize`Board and aim of the game`,$localize`Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone.`,fi.get().getInitialState()),q.forClick($localize`Selecting a lodestone`,$localize`To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally.`,fi.get().getInitialState(),["#lodestone_push_diagonal_PLAYER_ZERO"],pe.CONGRATULATIONS(),$localize`This is not the right lodestone, try again.`),q.informational($localize`The repelling lodestone`,$localize`Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured.`,fi.get().getInitialState()),q.informational($localize`The attracting lodestone`,$localize`When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it.`,fi.get().getInitialState()),q.informational($localize`Flipping the lodestone`,$localize`Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn.`,fi.get().getInitialState()),q.fromPredicate($localize`Captures`,$localize`To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates.`,fi.get().getInitialState(),new ja(new _(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),(e,t,n)=>32===n.remainingSpaces()?A.failure(pe.YOU_DID_NOT_CAPTURE_ANY_PIECE()):A.SUCCESS,pe.CONGRATULATIONS()),q.fromPredicate($localize`Crumbling a first pressure plate`,$localize`When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble.`,new b1([[J,J,J,J,K2,J,J,J],[J,J,Rr,J,J,K2,J,J],[J,J,Ad,J,J,J,J,Rr],[J,J,J,J,K2,J,J,Rr],[J,J,J,J,J,Rr,J,J],[J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J]],0,new fn([{key:O.ONE,value:new _(2,2)}]),{...YI,top:Eo.of([5,3]).addCaptured(O.ONE,4)}),new ja(new _(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),(e,t,n)=>5===n.pressurePlates.top.getCurrentPlateWidth()?A.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble!`):A.SUCCESS,pe.CONGRATULATIONS()),q.fromPredicate($localize`Crumbling a second pressure plate`,$localize`Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble.`,new b1([[Re,Re,Re,Re,Re,Re,Re,Re],[J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,Rr],[J,J,J,J,J,Rr,J,Rr],[J,Ad,J,J,K2,J,J,J],[J,J,J,J,J,J,J,J],[J,J,J,J,K2,J,J,J],[J,J,J,J,J,J,J,J]],0,new fn([{key:O.ONE,value:new _(1,4)}]),{...YI,top:Eo.of([5,3]).addCaptured(O.ONE,7)}),new ja(new _(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),(e,t,n)=>n.pressurePlates.top.getCurrentPlate().isPresent()?A.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble a second time!`):A.SUCCESS,pe.CONGRATULATIONS()),q.informational($localize`Minimal board`,$localize`After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board.`,new b1([[Re,Re,Re,Re,Re,Re,Re,Re],[Re,Re,Re,Re,Re,Re,Re,Re],[Re,Re,Rr,K2,J,J,Re,Re],[Re,Re,Ad,K2,J,J,Re,Re],[Re,Re,J,Rr,Rr,J,Re,Re],[Re,Re,Rr,J,J,J,Re,Re],[Re,Re,Re,Re,Re,Re,Re,Re],[Re,Re,Re,Re,Re,Re,Re,Re]],0,new fn([{key:O.ONE,value:new _(2,3)}]),{top:Eo.of([5,3]).addCaptured(O.ZERO,8),bottom:Eo.of([5,3]).addCaptured(O.ZERO,8),left:Eo.of([5,3]).addCaptured(O.ZERO,8),right:Eo.of([5,3]).addCaptured(O.ZERO,8)})),q.fromMove($localize`Making the lodestone fall`,$localize`If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!`,new b1([[J,J,J,J,J,J,J,J],[J,J,J,J,J,K2,J,J],[J,J,J,Ad,J,J,Rr,J],[J,J,Rr,Rr,K2,J,J,Rr],[J,J,J,J,J,Rr,J,J],[J,J,Rr,J,J,J,J,J],[J,J,K2,J,J,J,J,J],[J,J,J,J,J,J,J,J]],0,new fn([{key:O.ONE,value:new _(3,2)}]),{...YI,top:Eo.of([5,3]).addCaptured(O.ZERO,4)}),[new ja(new _(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize`Congratulations! At your next turn, you will be allowed to place your lodestone on any side.`,pe.FAILED_TRY_AGAIN()),q.fromMove(pe.END_OF_THE_GAME(),$localize`In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!`,new b1([[Re,Re,Re,Re,Re,Re,Re,Re],[Re,Re,Re,Re,Re,Re,Re,Re],[Re,K2,Rr,K2,J,J,Re,Re],[Re,K2,Ad,J,K2,J,Re,Re],[Re,J,J,Rr,Rr,J,Re,Re],[Re,K2,Rr,J,K2,J,Re,Re],[Re,J,J,J,Rr,J,Re,Re],[Re,Re,Re,Re,Re,Re,Re,Re]],0,new fn([{key:O.ONE,value:new _(2,3)}]),{top:Eo.of([5,3]).addCaptured(O.ZERO,8),bottom:Eo.of([5,3]).addCaptured(O.ZERO,7),left:Eo.of([5,3]).addCaptured(O.ZERO,5),right:Eo.of([5,3]).addCaptured(O.ZERO,8)}),[new ja(new _(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],pe.CONGRATULATIONS_YOU_WON(),$localize`This is not the winning move. Try again.`)]}class SJ extends Yn{getListMoves(e,t){const n=e.gameState;return this.flatMapEmptyCoords(n,i=>{const o=[];for(const s of this.nextDirection(n)){const a=["diagonal","orthogonal"];for(const c of a){const f=fi.get().applyMoveWithoutPlacingCaptures(n,i,{direction:s,orientation:c}).captures.length;for(const g of this.captureCombinations(n,f))o.push(new ja(i,s,c,g))}}return o})}captureCombinations(e,t){if(0===t)return new ct([{top:0,bottom:0,left:0,right:0}]);{const n=new ct,i=e.remainingSpacesDetails(),o=this.captureCombinations(e,t-1);for(const s of o)s.top+1<=i.top&&n.add({...s,top:s.top+1}),s.bottom+1<=i.bottom&&n.add({...s,bottom:s.bottom+1}),s.left+1<=i.left&&n.add({...s,left:s.left+1}),s.right+1<=i.right&&n.add({...s,right:s.right+1});return 0===n.size()?o:n}}flatMapEmptyCoords(e,t){let n=[];for(let i=0;i<b1.SIZE;i++)for(let o=0;o<b1.SIZE;o++){const s=new _(o,i),a=e.getPieceAt(s);(a.isEmpty()&&!1===a.isUnreachable()||a.isLodestone()&&a.owner===e.getCurrentPlayer())&&(n=n.concat(t(s)))}return n}nextDirection(e){const t=e.nextLodestoneDirection();return t.isPresent()?[t.get()]:["push","pull"]}}class Lze extends or{getMetrics(e,t){return e.gameState.getScores().toTable()}}function zze(r,e){if(1&r&&(N(),V(0,"rect",10)),2&r){const t=p().$implicit,n=p(2);v("ngClass",t.squareClasses),w("x",0)("y",0)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function Dze(r,e){if(1&r&&(N(),M(0,"g",11),V(1,"polygon",12)(2,"polygon",13),P()),2&r){const t=p().$implicit;m(),v("ngClass",t.squareClasses),m(),v("ngClass",t.squareClasses)}}function Vze(r,e){if(1&r&&(N(),V(0,"circle",14)),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();Ce("id","piece_",n,"_",o,""),v("ngClass",i.pieceClasses),w("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE/2)("cy",s.SPACE_SIZE/2)}}function Hze(r,e){if(1&r&&(N(),V(0,"g",15)),2&r){const t=p(),i=t.$implicit;Ce("id","lodestone_",t.index,"_",p().index,""),v("lodestoneInfo",i.lodestone),w("class",i.isCrumbled?"semi-transparent":"")}}function Fze(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"g",5),W("click",function(){const o=te(t).$implicit;return ne(p(2).selectCoord(o.coord))}),z(2,zze,1,5,"rect",6)(3,Dze,3,2,"g",7)(4,Vze,1,6,"circle",8)(5,Hze,1,4,"g",9),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();m(),Ce("id","square_",n,"_",i,""),w("transform",o.getSVGTranslation(o.SPACE_SIZE*n,o.SPACE_SIZE*i)),m(),v("ngIf",!1===t.isCrumbled),m(),v("ngIf",t.isCrumbled),m(),v("ngIf",t.hasPieceToDraw&&void 0===t.lodestone),m(),v("ngIf",t.lodestone)}}function Uze(r,e){if(1&r&&(N(),M(0,"g"),z(1,Fze,6,7,"g",1),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function $ze(r,e){if(1&r&&(N(),M(0,"g",16),V(1,"circle",17),P()),2&r){const t=e.$implicit,n=e.index,i=p();En("id","capture_",n,""),w("transform",i.getCaptureTransform(n)),m(),v("ngClass",t.pieceClasses),w("r",i.PIECE_RADIUS)}}function Gze(r,e){if(1&r){const t=de();N(),M(0,"g",20),W("click",function(){const o=te(t).$implicit;return ne(p(2).selectLodestone(o))}),P()}if(2&r){const t=e.$implicit,n=e.index,i=p(2);Hr("id","lodestone_",t.direction,"_",t.orientation,"_",t.owner.toString(),""),v("lodestoneInfo",t),w("transform",i.getAvailableLodestoneTransform(n))}}function Bze(r,e){if(1&r&&(N(),M(0,"g",18),z(1,Gze,1,5,"g",19),P()),2&r){const t=p();m(),v("ngForOf",t.viewInfo.availableLodestones)}}function Wze(r,e){if(1&r&&(N(),V(0,"circle",14)),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().$implicit,s=p().$implicit,a=p();Hr("id","platePiece_",s.groupPosition,"_",o.plateIndex,"_",n,""),v("ngClass",i.pieceClasses),w("r",a.PIECE_RADIUS)("cx",a.SPACE_SIZE*i.coord.x+a.SPACE_SIZE/2)("cy",a.SPACE_SIZE*i.coord.y+a.SPACE_SIZE/2)}}function qze(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"g",5),W("click",function(){const i=te(t),o=i.$implicit,s=i.index,a=p().$implicit,c=p().$implicit,l=p();return ne(o.temporary?l.onTemporaryPressurePlateClick(c.groupPosition,a.plateIndex,s):l.onPressurePlateClick(c.groupPosition,a.plateIndex,s))}),V(2,"rect",14),z(3,Wze,1,7,"circle",8),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().$implicit,o=p().$implicit,s=p();m(),Hr("id","plate_",o.groupPosition,"_",i.plateIndex,"_",n,""),m(),Hr("id","plateSquare_",o.groupPosition,"_",i.plateIndex,"_",n,""),v("ngClass",t.squareClasses),w("x",s.SPACE_SIZE*t.coord.x)("y",s.SPACE_SIZE*t.coord.y)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE)("rx",.2*s.SPACE_SIZE)("ry",.2*s.SPACE_SIZE),m(),v("ngIf",t.hasPiece)}}function jze(r,e){if(1&r&&(N(),M(0,"g",16),z(1,qze,4,14,"g",1),P()),2&r){const t=e.$implicit;Ce("id","pressurePlate_",p().$implicit.groupPosition,"_",t.plateIndex,""),m(),v("ngForOf",t.coords)}}function Zze(r,e){if(1&r&&(N(),M(0,"g",16),z(1,jze,2,3,"g",2),P()),2&r){const t=e.$implicit;En("id","pressurePlateGroup_",t.groupPosition,""),m(),v("ngForOf",t.plateInfos)}}function Yze(r,e){if(1&r&&(N(),V(0,"rect",21)),2&r){const t=p();Ce("id","selection_",t.viewInfo.selected.get().x,"_",t.viewInfo.selected.get().y,""),w("x",t.SPACE_SIZE*t.viewInfo.selected.get().x)("y",t.SPACE_SIZE*t.viewInfo.selected.get().y)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}class sa extends $c{static PRESSURE_PLATE_EXTRA_SHIFT=.2;static PRESSURE_PLATES_POSITIONS=fn.from({top:{start:(e,t)=>new _((8-t)/2,-(e+1)*(1+sa.PRESSURE_PLATE_EXTRA_SHIFT)),direction:me.RIGHT},bottom:{start:(e,t)=>new _((8-t)/2,8+sa.PRESSURE_PLATE_EXTRA_SHIFT+e*(1+sa.PRESSURE_PLATE_EXTRA_SHIFT)),direction:me.RIGHT},left:{start:(e,t)=>new _(-(1+sa.PRESSURE_PLATE_EXTRA_SHIFT)*(1+e),(8-t)/2),direction:me.DOWN},right:{start:(e,t)=>new _(8+sa.PRESSURE_PLATE_EXTRA_SHIFT+e*(1+sa.PRESSURE_PLATE_EXTRA_SHIFT),(8-t)/2),direction:me.DOWN}});PIECE_RADIUS;viewInfo={availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlateGroupInfos:[],selected:h.empty()};viewBox;platesGroupSize;boardSize;displayedState;stateAfterPlacingLodestone=h.empty();lastInfos=h.empty();capturesToPlace=0;selectedCoord=h.empty();selectedLodestone=h.empty();captures={top:0,bottom:0,left:0,right:0};constructor(e){super(e),this.setRulesAndNode("Lodestone"),this.availableAIs=[new cn($localize`Score`,this.rules,new Lze,new SJ),new kn($localize`MCTS`,new SJ,this.rules)],this.encoder=ja.encoder,this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH),this.displayedState=this.getState(),this.scores=h.of(we.of(0,0))}getViewBox(){const n=this.boardSize+2*this.platesGroupSize;return new Ys(-this.platesGroupSize,-(this.platesGroupSize+this.SPACE_SIZE+this.STROKE_WIDTH),n,n+2*(this.SPACE_SIZE+this.STROKE_WIDTH))}selectCoord(e){var t=this;return E(function*(){const n=yield t.canUserPlay("#square_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());if(t.capturesToPlace>0)return t.cancelMove(mu.MUST_PLACE_CAPTURES());const i=fi.get().isTargetLegal(t.getState(),e);return i.isFailure()?t.cancelMove(i.getReason()):(t.hideLastMove(),t.selectedCoord.equalsValue(e)?t.cancelMove():(t.selectedCoord=h.of(e),t.selectedLodestone.isPresent()?t.putLodestone():(t.updateViewInfo(),A.SUCCESS)))})()}selectLodestone(e){var t=this;return E(function*(){const n=t.getCurrentPlayer().toString(),i="#lodestone_"+e.direction+"_"+e.orientation+"_"+n,o=yield t.canUserPlay(i);if(o.isFailure())return t.cancelMove(o.getReason());t.hideLastMove(),L.assert(0===t.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed");const s=t.getCurrentPlayer(),a=yr.of(s,e);return t.selectedLodestone.equalsValue(a)?t.cancelMove():(t.selectedLodestone=h.of(a),t.selectedCoord.isPresent()?t.putLodestone():(t.updateViewInfo(),A.SUCCESS))})()}hideLastMove(){this.lastInfos=h.of({board:this.getState().getCopiedBoard(),captures:[],moved:[]}),this.updateViewInfo()}putLodestone(){var e=this;return E(function*(){L.assert(e.selectedCoord.isPresent(),"coord should have been selected"),L.assert(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),n=e.selectedLodestone.get(),i=e.getState(),o=fi.get().isLegalWithoutCaptures(i,t,n.direction);L.assert(o.isSuccess(),"Lodestone component should only allow creation of legal moves");const s=fi.get().applyMoveWithoutPlacingCaptures(i,t,n);return e.lastInfos=h.of(s),e.capturesToPlace=Math.min(s.captures.length,i.remainingSpaces()),0===e.capturesToPlace?e.applyMove():(e.displayedState=e.displayedState.withBoard(s.board),e.stateAfterPlacingLodestone=h.of(e.displayedState),e.updateViewInfo(),A.SUCCESS)})()}applyMove(){var e=this;return E(function*(){L.assert(e.selectedCoord.isPresent(),"coord should have been selected"),L.assert(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),n=e.selectedLodestone.get(),i=new ja(t,n.direction,n.orientation,e.captures);return e.chooseMove(i)})()}onPressurePlateClick(e,t,n){var i=this;return E(function*(){const o="#plate_"+e+"_"+t+"_"+n,s=yield i.canUserPlay(o);return s.isFailure()?i.cancelMove(s.getReason()):i.selectPressurePlate(e)})()}onTemporaryPressurePlateClick(e,t,n){var i=this;return E(function*(){const o="#plate_"+e+"_"+t+"_"+n,s=yield i.canUserPlay(o);return s.isFailure()?i.cancelMove(s.getReason()):i.deselectPressurePlate(e)})()}selectPressurePlate(e){var t=this;return E(function*(){if(0===t.capturesToPlace)return t.cancelMove(mu.NO_CAPTURES_TO_PLACE_YET());t.capturesToPlace--,t.captures[e]++;const n=t.stateAfterPlacingLodestone.get(),i=t.getCurrentOpponent(),o=it.copy(n.board),s={...n.pressurePlates},a=n.lodestones.getCopy();return fi.get().updatePressurePlates(o,s,a,i,t.captures),t.displayedState=new b1(o,n.turn,a,s),0===t.capturesToPlace?t.applyMove():(t.updateViewInfo(),t.showPressurePlateDifferences(t.getState(),t.displayedState,!0),A.SUCCESS)})()}deselectPressurePlate(e){var t=this;return E(function*(){t.capturesToPlace++,t.captures[e]--;const n=t.stateAfterPlacingLodestone.get(),i=t.getCurrentOpponent(),o=it.copy(n.board),s={...n.pressurePlates},a=n.lodestones.getCopy();return fi.get().updatePressurePlates(o,s,a,i,t.captures),t.displayedState=new b1(o,n.turn,a,s),t.updateViewInfo(),t.showPressurePlateDifferences(t.getState(),t.displayedState,!0),A.SUCCESS})()}updateBoard(e){var t=this;return E(function*(){t.cancelMoveAttempt(),t.scores=h.of(t.getState().getScores()),t.boardSize=t.getState().board.length*t.SPACE_SIZE;const n=t.getState().pressurePlates.top.plates.length;t.platesGroupSize=n*(1.2*t.SPACE_SIZE)})()}cancelMoveAttempt(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=h.empty(),this.lastInfos=h.empty();const e=this.displayedState.lodestones.get(this.getCurrentPlayer());if(e.isPresent()){const t=it.copy(this.displayedState.board);t[e.get().y][e.get().x]=Mo.EMPTY,this.displayedState=this.displayedState.withBoard(t)}this.selectedCoord=h.empty(),this.selectedLodestone=h.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}updateViewInfo(){const t=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(t),this.viewInfo.opponentClass=this.getPlayerClass(t.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}showBoard(){this.viewInfo.boardInfo=[];for(let e=0;e<b1.SIZE;e++){this.viewInfo.boardInfo.push([]);for(let t=0;t<b1.SIZE;t++){const n=new _(t,e);this.viewInfo.boardInfo[e].push(this.getSquareInfo(n))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.isCrumbled(this.selectedCoord.get())?this.selectedCoord:h.empty()}getSquareInfo(e){const t=this.displayedState.getPieceAt(e),n=this.getLodestoneInfo(e),i={coord:e,squareClasses:[],isCrumbled:this.isCrumbled(e),hasPieceToDraw:void 0!==n,pieceClasses:[],lodestone:n};if(t.isPlayerPiece())i.hasPieceToDraw=!0,i.pieceClasses=[this.getPlayerClass(t.owner)];else if(i.isCrumbled)return this.getCrumbledSquareInfo(e,i);return i}getCrumbledSquareInfo(e,t){const n=this.getPreCaptureInfo();if(n.isAbsent())return t;const i=this.getPieceThatCrumbledLastEndOfTurn(e,n.get().preCaptureState,n.get().preCaptureMove);if(i.isPresent()){const o=i.get().owner;t.hasPieceToDraw=!0,t.pieceClasses=[this.getPlayerClass(o),"semi-transparent"]}return t}getPreCaptureInfo(){return this.selectedCoord.isPresent()&&this.selectedLodestone.isPresent()?h.of({preCaptureMove:new ja(this.selectedCoord.get(),this.selectedLodestone.get().direction,this.selectedLodestone.get().orientation),preCaptureState:this.getState()}):this.node.previousMove.isPresent()?h.of({preCaptureMove:this.node.previousMove.get(),preCaptureState:this.getPreviousState()}):h.empty()}getLodestoneInfo(e){if(this.displayedState.getPieceAt(e).isLodestone())return this.getLodestoneInfoAt(this.displayedState,e);if(this.isCrumbled(e)&&this.getPreCaptureInfo().isPresent()){if(this.selectedCoord.equalsValue(e)){const i=this.selectedLodestone.get();return this.getLodestoneInfoFromLodestone(i)}if(this.wasLastMoveLodestone(e))return this.getDroppedThenCrumbedLodestoneInfo(this.node.previousMove.get());if(this.isCrumbledLodestone(e))return this.getCrumbledLodestoneInfo(e)}}getDroppedThenCrumbedLodestoneInfo(e){const t={direction:e.direction,orientation:e.orientation},n=yr.of(this.getCurrentOpponent(),t);return this.getLodestoneInfoFromLodestone(n)}getCrumbledLodestoneInfo(e){const t=this.getPreviousState().getPieceAt(e);return L.assert(t.isLodestone(),"getCrumbledLodestoneInfo should only be called with coord that contain crumbled lodestone!"),this.getLodestoneInfoFromLodestone(t)}getLodestoneInfoFromLodestone(e){const t={direction:e.direction,movingClass:"",orientation:e.orientation,owner:e.owner,selectedClass:""};return t.movingClass=this.getPlayerClass("push"===e.direction?e.owner.getOpponent():e.owner),t}wasLastMoveLodestone(e){return!!this.node.parent.isPresent()&&this.node.previousMove.get().coord.equals(e)}isCrumbledLodestone(e){if(this.node.parent.isPresent()){if(this.selectedLodestone.isPresent())return!1;{const t=this.node.parent.get().gameState,n=t.getPieceAt(e);return n.isLodestone()&&n.owner===t.getCurrentOpponent()}}return!1}getLodestoneInfoAt(e,t){const n=e.getPieceAt(t);return L.assert(n.isLodestone(),"piece should be lodestone"),this.getLodestoneInfoFromLodestone(n)}getPieceThatCrumbledLastEndOfTurn(e,t,n){const s=this.rules.applyMoveWithoutPlacingCaptures(t,n.coord,{direction:n.direction,orientation:n.orientation}).board[e.y][e.x],a=!1===s.isEmpty(),c=!1===s.isUnreachable();return a&&c?h.of(s):h.empty()}isCrumbled(e){return this.displayedState.getPieceAt(e).isUnreachable()}showAvailableLodestones(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{const e=this.getState().getCurrentPlayer(),t=this.getState().nextLodestoneDirection();if(t.isPresent()){const n=t.get();this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:n,orientation:"orthogonal"}),this.nextLodestone(e,{direction:n,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"push",orientation:"diagonal"}),this.nextLodestone(e,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"pull",orientation:"diagonal"})]}}showCapturesToPlace(){const e=this.getCurrentOpponent();this.viewInfo.capturesToPlace=[];for(let t=0;t<this.capturesToPlace;t++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(e)]})}nextLodestone(e,t){const n=yr.of(e,t),i=this.getLodestoneInfoFromLodestone(n);return this.selectedLodestone.equalsValue(n)&&(i.selectedClass="selected-stroke"),i}showPressurePlates(){this.viewInfo.pressurePlateGroupInfos=[];for(const e of c4.POSITIONS){const t=this.getPressurePlateGroupInfo(e);this.viewInfo.pressurePlateGroupInfos.push(t)}}getPressurePlateGroupInfo(e){const t={groupPosition:e,plateInfos:[]},n=this.displayedState.pressurePlates[e];let i=0;for(const o of n.plates){const s=this.getPressurePlateInfo(o,e,i);t.plateInfos.push(s),i++}return t}getPressurePlateInfo(e,t,n){const i={plateIndex:n,coords:[]},o=e.width;for(let s=0;s<o;s++){const a=this.getPressurePlateCoordInfo(e,t,n,s);i.coords.push(a)}return i}getPressurePlateCoordInfo(e,t,n,i){const o=e.getPieceAt(i);let s="";o.isPlayerPiece()&&(s=this.getPlayerClass(o.owner));const a=sa.PRESSURE_PLATES_POSITIONS.get(t).get();return{coord:a.start(n,e.width).getNext(a.direction,i),hasPiece:o.isPlayerPiece(),pieceClasses:[s],squareClasses:[],temporary:!1}}showLastMove(e){var t=this;return E(function*(){const n=t.getPreviousState();t.lastInfos=h.of(fi.get().applyMoveWithoutPlacingCaptures(n,e.coord,e)),t.updateViewInfo();const i=t.getState();t.showPressurePlateDifferences(n,i,!1)})()}showPressurePlateDifferences(e,t,n){for(const i of c4.POSITIONS){const o=e.pressurePlates[i].plates.length;for(let s=0;s<o;s++)this.showPressurePlateDifference(e.pressurePlates[i].plates[s],t.pressurePlates[i].plates[s],i,s,n)}}showPressurePlateDifference(e,t,n,i,o){const c=this.viewInfo.pressurePlateGroupInfos.filter(l=>l.groupPosition===n)[0].plateInfos[i];for(let l=0;l<e.width;l++){const u=e.getPieceAt(l),f=t.getPieceAt(l);!1===u.equals(f)&&(c.coords[l].squareClasses.push("moved-fill"),c.coords[l].temporary=o,o&&c.coords[l].pieceClasses.push("semi-transparent"))}}showMovedAndCaptured(e){for(const t of e.moved)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("moved-fill");for(const t of e.captures)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("captured-fill")}getCaptureTransform(e){return`translate(${(e+(b1.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.SPACE_SIZE/2}, ${-(this.platesGroupSize+.5*this.SPACE_SIZE+this.STROKE_WIDTH)})`}getAvailableLodestoneTransform(e){return`translate(${(e+(b1.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE}, ${this.boardSize+this.platesGroupSize+this.STROKE_WIDTH})`}static \u0275fac=function(t){return new(t||sa)(G(Ut))};static \u0275cmp=$e({type:sa,selectors:[["app-lodestone"]],features:[We],decls:6,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],["id","availableLodestones",4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click"],["class","base lodestone_square",3,"ngClass",4,"ngIf"],["class","lodestone_crumbled_square",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["app-lodestone-lodestone","",3,"id","lodestoneInfo",4,"ngIf"],[1,"base","lodestone_square",3,"ngClass"],[1,"lodestone_crumbled_square"],["points","0,0     42,0    17,25    67,75    42,100   0,100   0,0",1,"base",3,"ngClass"],["points","100,0   58,0    35,25    85,75    58,100 100,100 100,0",1,"base",3,"ngClass"],[1,"base",3,"id","ngClass"],["app-lodestone-lodestone","",3,"id","lodestoneInfo"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["id","availableLodestones"],["app-lodestone-lodestone","",3,"id","lodestoneInfo","click",4,"ngFor","ngForOf"],["app-lodestone-lodestone","",3,"id","lodestoneInfo","click"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(t,n){1&t&&(N(),M(0,"svg",0),z(1,Uze,2,1,"g",1)(2,$ze,2,4,"g",2)(3,Bze,2,1,"g",3)(4,Zze,2,2,"g",2)(5,Yze,1,6,"rect",4),P()),2&t&&(w("viewBox",n.getViewBox().toSVGString()),m(),v("ngForOf",n.viewInfo.boardInfo),m(),v("ngForOf",n.viewInfo.capturesToPlace),m(),v("ngIf",n.isInteractive),m(),v("ngForOf",n.viewInfo.pressurePlateGroupInfos),m(),v("ngIf",n.viewInfo.selected.isPresent()))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}class wt{value;static EMPTY=new wt(0);static PAWN=new wt(1);static DRONE=new wt(2);static QUEEN=new wt(3);static tryMerge(e,t){hn(e!==wt.EMPTY&&t!==wt.EMPTY,"tryMerge cannot be called with empty pieces");const i=e.value+t.value;return 2===i||3===i?h.of(wt.of(i)):h.empty()}static of(e){return e===wt.DRONE.value?wt.DRONE:(L.expectToBe(e,wt.QUEEN.value),wt.QUEEN)}constructor(e){this.value=e}getValue(){return this.value}equals(e){return this.getValue()===e.getValue()}}class d0{captures;static of(e){const t=new fn;for(const n of e)d0.addToMap(t,n);return new d0(t)}static addToMap(e,t){const n=e.get(t);n.isPresent()?e.replace(t,n.get()+1):e.set(t,1)}constructor(e){this.captures=e,e.makeImmutable()}toValue(){let e=0;return this.captures.forEach(t=>{e+=t.key.getValue()*t.value}),e}add(e){const t=this.captures.getCopy();return d0.addToMap(t,e),new d0(t)}}class q1 extends $1{lastMove;countDown;static WIDTH=4;static HEIGHT=8;static PLAYER_ZERO_TERRITORY=new ct([4,5,6,7]);static PLAYER_ONE_TERRITORY=new ct([0,1,2,3]);static isOnBoard(e){return e.isInRange(q1.WIDTH,q1.HEIGHT)}captured;constructor(e,t,n=h.empty(),i=h.empty(),o){super(e,t),this.lastMove=n,this.countDown=i,null==o&&(o=new fn([{key:O.ZERO,value:d0.of([])},{key:O.ONE,value:d0.of([])}])),o.makeImmutable(),this.captured=o}getPlayerTerritory(e){return e===O.ZERO?q1.PLAYER_ZERO_TERRITORY:q1.PLAYER_ONE_TERRITORY}isTherePieceOnPlayerSide(e){const t=this.getCurrentPlayer(),n=this.getPlayerTerritory(t);for(const i of n)for(let o=0;o<q1.WIDTH;o++)if(this.getPieceAtXY(o,i)===e)return!0;return!1}getScoreOf(e){return this.captured.get(e).get().toValue()}getEmptyTerritory(){return this.isTerritoryEmpty(O.ZERO)?h.of(O.ZERO):this.isTerritoryEmpty(O.ONE)?h.of(O.ONE):h.empty()}isTerritoryEmpty(e){const t=this.getPlayerTerritory(e);for(const n of t)for(let i=0;i<q1.WIDTH;i++)if(this.getPieceAtXY(i,n)!==wt.EMPTY)return!1;return!0}isInOpponentTerritory(e){const t=this.getCurrentOpponent();return this.getPlayerTerritory(t).contains(e.y)}isInPlayerTerritory(e){const t=this.getCurrentPlayer();return this.getPlayerTerritory(t).contains(e.y)}getCapturesOf(e){const t=this.captured.get(e).get();return[t.captures.get(wt.PAWN).getOrElse(0),t.captures.get(wt.DRONE).getOrElse(0),t.captures.get(wt.QUEEN).getOrElse(0)]}}let ZC=(()=>class r{static START_COORD_OUT_OF_RANGE=()=>$localize`Start coord cannot be out of range`;static END_COORD_OUT_OF_RANGE=()=>$localize`End coord cannot be out of range`;static PAWN_MUST_MOVE_ONE_DIAGONAL_STEP=()=>$localize`Pawns must move one step diagonally.`;static DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS=()=>$localize`Drones must move one or two steps in any direction.`})();class Qr extends Do{calledTheClock;static encoder=ke.tuple([_.encoder,_.encoder,ke.identity()],e=>[e.getStart(),e.getEnd(),e.calledTheClock],e=>Qr.from(e[0],e[1],e[2]).get());static from(e,t,n=!1){if(!1===q1.isOnBoard(e))return X.failure(ZC.START_COORD_OUT_OF_RANGE());if(!1===q1.isOnBoard(t))return X.failure(ZC.END_COORD_OUT_OF_RANGE());if(t.equals(e))return X.failure(Me.MOVE_CANNOT_BE_STATIC());const i=me.factory.fromDelta(t.x-e.x,t.y-e.y);return i.isFailure()?X.failure(i.getReason()):X.success(new Qr(e,t,n))}constructor(e,t,n){super(e,t),this.calledTheClock=n}toString(){const e=this.calledTheClock?", CALL_THE_CLOCK":"";return"MartianChessMove(("+this.getStart().x+", "+this.getStart().y+") -> ("+this.getEnd().x+", "+this.getEnd().y+")"+e+")"}equals(e){return!1!==super.equals(e)&&this.calledTheClock===e.calledTheClock}isValidForPawn(){return this.getStart().getVectorToward(this.getEnd()).isDiagonalOfLength(1)}isValidForDrone(){return this.getStart().getDistance(this.getEnd())<=2}isUndoneBy(e){if(e.isAbsent())return!1;const t=e.get();return t.getEnd().equals(this.getStart())&&t.getStart().equals(this.getEnd())}}let YC=(()=>class r{static MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY=()=>$localize`You must pick a piece from your side of the board in order to move it.`;static CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT=()=>$localize`This is not a valid promotion nor a valid capture.`;static CANNOT_UNDO_LAST_MOVE=()=>$localize`You cannot perform a move that is the reverse of the previous one.`})();class Ps extends wr{static STARTING_COUNT_DOWN=h.of(7);static singleton=h.empty();static get(){return Ps.singleton.isAbsent()&&(Ps.singleton=h.of(new Ps)),Ps.singleton.get()}getInitialState(){const e=wt.EMPTY,t=wt.PAWN,n=wt.DRONE,i=wt.QUEEN;return new q1([[i,i,n,e],[i,n,t,e],[n,t,t,e],[e,e,e,e],[e,e,e,e],[e,t,t,n],[e,t,n,i],[e,n,i,i]],0,h.empty())}applyLegalMove(e,t,n,i){const o=t.getCopiedBoard();o[e.getStart().y][e.getStart().x]=wt.EMPTY;const s=i.finalPiece;o[e.getEnd().y][e.getEnd().x]=s;const a=i.score;let c=t.countDown;if(c.isPresent())if(this.isCapture(e,t))c=Ps.STARTING_COUNT_DOWN;else{const u=t.countDown.get();c=h.of(u-1)}return e.calledTheClock&&(c=Ps.STARTING_COUNT_DOWN),new q1(o,t.turn+1,h.of(e),c,a)}isLegal(e,t){this.assertNonDoubleClockCall(e,t);const n=this.isLegalMove(e,t);if(n.isFailure())return n.toOtherFallible();if(e.isUndoneBy(t.lastMove))return X.failure(YC.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(e,t))return this.isLegalFieldPromotion(e,t);const i=t.getPieceAt(e.getStart()),o=t.captured.getCopy();if(this.isCapture(e,t)){const a=t.getCurrentPlayer();let c=o.get(a).get();const l=t.getPieceAt(e.getEnd());c=c.add(l),o.replace(a,c),o.makeImmutable()}return X.success({finalPiece:i,score:o})}assertNonDoubleClockCall(e,t){const n=t.countDown.isPresent();L.assert(!1===(n&&e.calledTheClock),"Should not call the clock twice")}isCapture(e,t){const n=t.isInOpponentTerritory(e.getEnd()),i=t.getPieceAt(e.getEnd())!==wt.EMPTY;return n&&i}isFieldPromotion(e,t){const n=t.isInPlayerTerritory(e.getEnd()),i=t.getPieceAt(e.getEnd())!==wt.EMPTY;return n&&i}isLegalFieldPromotion(e,t){const n=this.getPromotedPiece(e,t);if(n.isAbsent())return X.failure(YC.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());const i=n.get();if(t.isTherePieceOnPlayerSide(i))return X.failure(YC.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());{const o={finalPiece:i,score:t.captured.getCopy()};return X.success(o)}}isLegalMove(e,t){if(!1===t.isInPlayerTerritory(e.getStart()))return A.failure(YC.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());const i=t.getPieceAt(e.getStart());if(i===wt.EMPTY)return A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i===wt.PAWN)return e.isValidForPawn()?A.SUCCESS:A.failure(ZC.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(i===wt.DRONE&&!1===e.isValidForDrone())return A.failure(ZC.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());for(const o of e.getStart().getCoordsToward(e.getEnd()))if(t.getPieceAt(o)!==wt.EMPTY)return A.failure(Me.SOMETHING_IN_THE_WAY());return A.SUCCESS}getPromotedPiece(e,t){const n=t.getPieceAt(e.getStart()),i=t.getPieceAt(e.getEnd());return wt.tryMerge(n,i)}getGameStatus(e){const t=e.gameState;if(t.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(t,ve.DRAW);if(t.getEmptyTerritory().isPresent()){const i=t.getCurrentOpponent(),o=ve.getVictory(i);return this.getGameStatusScoreVictoryOr(t,o)}return ve.ONGOING}getGameStatusScoreVictoryOr(e,t){const n=e.getScoreOf(O.ZERO),i=e.getScoreOf(O.ONE);return n>i?ve.ZERO_WON:i>n?ve.ONE_WON:t}}const K=wt.EMPTY,X2=wt.PAWN,l4=wt.DRONE,u4=wt.QUEEN;class Kze extends Bn{tutorial=[q.informational($localize`Goal of the game`,$localize`At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal.`,Ps.get().getInitialState()),q.informational($localize`The pieces`,$localize`The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>`,Ps.get().getInitialState()),q.fromPredicate($localize`Moving pawns`,$localize`Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn.`,Ps.get().getInitialState(),Qr.from(new _(2,5),new _(1,4)).get(),(e,t,n)=>n.getPieceAt(e.getEnd())===wt.PAWN?A.SUCCESS:A.failure($localize`This is not a pawn!`),pe.CONGRATULATIONS()),q.fromPredicate($localize`Moving drones`,$localize`Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone.`,Ps.get().getInitialState(),Qr.from(new _(1,7),new _(0,7)).get(),(e,t,n)=>n.getPieceAt(e.getEnd())===wt.DRONE?A.SUCCESS:A.failure($localize`This is not a drone!`),pe.CONGRATULATIONS()),q.fromPredicate($localize`Moving queens`,$localize`Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Light, move a queen.`,new q1([[l4,X2,K,K],[u4,K,K,K],[K,K,K,K],[K,K,u4,K],[K,K,K,K],[K,K,K,K],[K,K,K,K],[u4,l4,X2,K]],1),Qr.from(new _(2,3),new _(2,7)).get(),(e,t,n)=>n.getPieceAt(e.getEnd())===wt.QUEEN?A.SUCCESS:A.failure($localize`This is not a queen!`),pe.CONGRATULATIONS()),q.fromMove($localize`Captures`,$localize`When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Light, do it.`,new q1([[l4,X2,X2,K],[K,K,K,K],[u4,K,K,K],[K,K,K,K],[K,K,X2,K],[K,K,K,K],[K,K,K,K],[K,l4,X2,K]],1),[Qr.from(new _(0,2),new _(2,4)).get()],$localize`Congratulations! By capturing that pawn, you won one point.`,pe.YOU_DID_NOT_CAPTURE_ANY_PIECE()),q.fromMove($localize`Field Promotion (1/2)`,$localize`It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Light. Do it.`,new q1([[K,K,K,u4],[K,X2,K,K],[K,K,X2,K],[K,K,K,K],[K,K,K,K],[K,K,K,u4],[K,K,l4,K],[K,X2,K,K]],1),[Qr.from(new _(1,1),new _(2,2)).get(),Qr.from(new _(2,2),new _(1,1)).get()],pe.CONGRATULATIONS(),$localize`This is not a field promotion!`),q.fromPredicate($localize`Field Promotion (2/2)`,$localize`The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it.`,new q1([[X2,K,K,K],[K,K,K,K],[K,K,K,K],[K,K,K,K],[K,K,K,K],[K,K,K,K],[K,K,l4,K],[K,X2,K,K]],0),Qr.from(new _(1,7),new _(2,6)).get(),(e,t,n)=>n.getPieceAt(e.getEnd())===wt.QUEEN?A.SUCCESS:A.failure($localize`This is not a field promotion!`),pe.CONGRATULATIONS()),q.fromPredicate($localize`Call the clock`,$localize`When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You're playing Dark. Call the clock and perform a move.`,Ps.get().getInitialState(),Qr.from(new _(1,5),new _(0,4),!0).get(),(e,t,n)=>e.calledTheClock?A.SUCCESS:A.failure($localize`You did not call the clock!`),pe.CONGRATULATIONS()),q.fromMove($localize`Restarting the clock`,$localize`If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You're playing Dark, do a capture to restart the countdown.`,new q1([[K,K,K,K],[K,X2,K,K],[K,K,K,K],[K,K,K,K],[K,K,K,K],[K,K,K,X2],[K,K,l4,K],[K,u4,K,K]],16,h.empty(),h.of(1)),[Qr.from(new _(1,7),new _(1,1)).get()],pe.CONGRATULATIONS(),$localize`This is not a capture, the game is now over, please retry!`),q.anyMove($localize`End game (by clock)`,$localize`When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You're playing Light, do the last move.`,new q1([[K,K,K,u4],[K,X2,K,K],[K,K,K,K],[K,K,K,K],[K,K,K,K],[l4,K,K,K],[K,K,K,K],[K,l4,K,K]],15,h.empty(),h.of(1)),Qr.from(new _(1,1),new _(2,2)).get(),pe.CONGRATULATIONS()),q.fromPredicate($localize`End by emptyness`,$localize`When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!`,new q1([[K,K,K,u4],[K,X2,K,K],[K,K,K,K],[K,K,K,K],[K,K,X2,K],[K,K,K,K],[K,K,K,K],[K,K,K,K]],0),Qr.from(new _(2,4),new _(1,3)).get(),(e,t,n)=>3===e.getEnd().y?A.SUCCESS:A.failure($localize`Your piece is still in you territory!`),pe.CONGRATULATIONS())]}class OJ extends Yn{getListMoves(e,t){const n=e.gameState,i=n.getCurrentPlayer(),o=n.getPlayerTerritory(i);let s=[];for(const a of o)for(let c=0;c<q1.WIDTH;c++)switch(n.getPieceAtXY(c,a)){case wt.PAWN:s=s.concat(this.getMovesForPawnAt(n,c,a));break;case wt.DRONE:s=s.concat(this.getMovesForDroneAt(n,c,a));break;case wt.QUEEN:s=s.concat(this.getMovesForQueenAt(n,c,a))}return s}getMovesForPawnAt(e,t,n){const i=new _(t,n),o=[];for(const s of me.DIAGONALS){const a=i.getNext(s);q1.isOnBoard(a)&&o.push(a)}return this.addLegalMoves(e,i,o)}addLegalMoves(e,t,n){const i=[],o=e.getPieceAt(t),s=!1===e.isTherePieceOnPlayerSide(wt.DRONE),a=!1===e.isTherePieceOnPlayerSide(wt.QUEEN),c=e.lastMove;for(const l of n){const u=e.getPieceAt(l);if(u===wt.EMPTY)this.add(i,Qr.from(t,l).get(),c);else if(e.isInPlayerTerritory(l)){const f=wt.tryMerge(u,o);if(f.isPresent()){const g=f.get(),y=Qr.from(t,l).get();(g===wt.DRONE&&s||g===wt.QUEEN&&a)&&this.add(i,y,c)}}else this.add(i,Qr.from(t,l).get(),c)}return i}add(e,t,n){!1===t.isUndoneBy(n)&&e.push(t)}getMovesForDroneAt(e,t,n){const i=new _(t,n),o=this.getLandingCoordsForLinearMove(i,e,2);return this.addLegalMoves(e,i,o)}getLandingCoordsForLinearMove(e,t,n){const i=[];for(const o of me.DIRECTIONS){let s=1,a=e.getNext(o,s),c=t.tryToGetPieceAt(a),l=c.equalsValue(wt.EMPTY);for(;l;)i.push(a),s++,a=e.getNext(o,s),c=t.tryToGetPieceAt(a),l=c.equalsValue(wt.EMPTY)&&s<n;c.isPresent()&&i.push(a)}return i}getMovesForQueenAt(e,t,n){const i=new _(t,n),o=this.getLandingCoordsForQueen(i,e);return this.addLegalMoves(e,i,o)}getLandingCoordsForQueen(e,t){return this.getLandingCoordsForLinearMove(e,t,q1.HEIGHT)}}class Xze extends or{getMetrics(e,t){const n=e.gameState.getScoreOf(O.ZERO),i=e.gameState.getScoreOf(O.ONE);return U1.ofSingle(n,i)}}function Qze(r,e){if(1&r&&(N(),V(0,"g",19)),2&r){const t=p(2).index,n=p().index,i=p();l2(i.style),Ce("mainShapeId","pawn_",t,"_",n,""),v("pieceClasses",i.getPieceClasses(t,n))}}function Jze(r,e){if(1&r&&(N(),V(0,"g",20)),2&r){const t=p(2).index,n=p().index,i=p();l2(i.style),Ce("mainShapeId","drone_",t,"_",n,""),v("pieceClasses",i.getPieceClasses(t,n))}}function eDe(r,e){if(1&r&&(N(),V(0,"g",21)),2&r){const t=p(2).index,n=p().index,i=p();l2(i.style),Ce("mainShapeId","queen_",t,"_",n,""),v("pieceClasses",i.getPieceClasses(t,n))}}function tDe(r,e){if(1&r&&(N(),M(0,"g"),z(1,Qze,1,5,"g",16)(2,Jze,1,5,"g",17)(3,eDe,1,5,"g",18),P()),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();w("transform",s.getPieceLocation(n,o)),m(),v("ngIf",i===s.pieces.PAWN),m(),v("ngIf",i===s.pieces.DRONE),m(),v("ngIf",i===s.pieces.QUEEN)}}function nDe(r,e){if(1&r){const t=de();N(),M(0,"g",14),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),V(1,"rect",15),z(2,tDe,4,4,"g",13),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();Ce("id","click_",n,"_",i,""),w("transform",o.getPieceTranslation(i)),m(),Ce("id","square_",n,"_",i,""),v("ngClass",o.getSquareClasses(n,i)),w("x",n*o.SPACE_SIZE)("y",i*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),m(),v("ngIf",t!==o.pieces.EMPTY)}}function rDe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"rect",22),W("click",function(){const o=te(t).$implicit;return ne(p(3).onClick(o.x,o.y))}),P()()}if(2&r){const t=e.$implicit,n=p(3);m(),Ce("id","indicator_",t.x,"_",t.y,""),w("transform",n.getPieceTranslation(t.y))("x",t.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",t.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}function iDe(r,e){if(1&r&&(N(),M(0,"g"),z(1,rDe,2,7,"g",1),P()),2&r){const t=p(2);m(),v("ngForOf",t.selectedPieceInfo.get().legalLandings)}}function oDe(r,e){if(1&r&&(N(),M(0,"g"),z(1,nDe,3,11,"g",12)(2,iDe,2,1,"g",13),P()),2&r){const t=e.$implicit,n=p();m(),v("ngForOf",t),m(),v("ngIf",n.selectedPieceInfo.isPresent())}}function sDe(r,e){if(1&r&&(N(),M(0,"text",23),st(1),P()),2&r){const t=p();v("ngClass","player"+t.getCurrentPlayer().getValue())("ngClass",t.getClockCircleClasses()),w("x",.5*t.SPACE_SIZE)("y",.5*t.SPACE_SIZE),m(),mn(t.countDown.get())}}function aDe(r,e){if(1&r&&(N(),V(0,"polyline",24)),2&r){const t=p();v("ngClass",t.getClockCircleClasses()),w("points",t.clockNeedlesPoints)}}const KC=r=>[r];function cDe(r,e){if(1&r){const t=de();N(),jt(0),M(1,"g",27),W("click",function(){const o=te(t).index;return ne(p(2).chooseStyle(o))}),P(),Zt()}if(2&r){const t=e.$implicit,n=e.index,i=p(2);m(),l2(t.style),v("id",t.name)("pieceClasses",Oa(5,KC,"player"+i.getCurrentPlayer().getValue()+"-fill")),w("transform","translate(0, "+-(n+1)*i.SPACE_SIZE+")")}}function lDe(r,e){if(1&r&&(N(),M(0,"g",25),V(1,"rect",26),z(2,cDe,2,7,"ng-container",1),P()),2&r){const t=p();m(),w("x",0)("y",-t.listOfStyles.length*t.SPACE_SIZE)("width",1*t.SPACE_SIZE)("height",t.listOfStyles.length*t.SPACE_SIZE),m(),v("ngForOf",t.listOfStyles)}}function uDe(r,e){if(1&r&&(N(),M(0,"text",33),st(1),P()),2&r){const t=p(2).$implicit,n=p().$implicit,i=p();v("ngClass",i.getPlayerClass(n)),w("x",i.SPACE_SIZE/2)("y",i.SPACE_SIZE/2),m(),mn(t+" x ")}}function fDe(r,e){if(1&r&&(N(),V(0,"g",34)),2&r){const t=p(3).$implicit,n=p();l2(n.style),v("pieceClasses",Oa(3,KC,n.getPlayerClass(t)))}}function dDe(r,e){if(1&r&&(N(),V(0,"g",35)),2&r){const t=p(3).$implicit,n=p();l2(n.style),v("pieceClasses",Oa(3,KC,n.getPlayerClass(t)))}}function hDe(r,e){if(1&r&&(N(),V(0,"g",36)),2&r){const t=p(3).$implicit,n=p();l2(n.style),v("pieceClasses",Oa(3,KC,n.getPlayerClass(t)))}}function gDe(r,e){if(1&r&&(N(),M(0,"g"),z(1,uDe,2,4,"text",29),M(2,"g",28),z(3,fDe,1,5,"g",30)(4,dDe,1,5,"g",31)(5,hDe,1,5,"g",32),P()()),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().$implicit,s=p();w("transform","translate(0, "+2*n*s.SPACE_SIZE+")"),m(),v("ngIf",i>1),m(),Ce("id","piece_",n,"_player_",o.getValue(),""),w("transform","translate("+s.SPACE_SIZE+", 0)"),m(),v("ngIf",0===n),m(),v("ngIf",1===n),m(),v("ngIf",2===n)}}function pDe(r,e){if(1&r&&(N(),M(0,"g"),z(1,gDe,6,8,"g",13),P()),2&r){const t=e.$implicit;m(),v("ngIf",t>0)}}function mDe(r,e){if(1&r&&(N(),M(0,"g")(1,"g",28),z(2,pDe,2,1,"g",1),P()()),2&r){const t=e.$implicit,n=p();m(),En("id","capture_of_player_",t.getValue(),""),w("transform",n.getCapturesTransformation(t)),m(),v("ngForOf",n.state.getCapturesOf(t))}}let Po=(()=>{class r extends y2{static SPACE_SIZE=100;static STROKE_WIDTH=8;INDICATOR_SIZE=20;HORIZONTAL_CENTER=.5*q1.WIDTH*r.SPACE_SIZE;UNSTROKED_HEIGHT=q1.HEIGHT*r.SPACE_SIZE;VERTICAL_CENTER=.5*this.UNSTROKED_HEIGHT+r.STROKE_WIDTH;LEFT=r.SPACE_SIZE/-4+r.STROKE_WIDTH/-2;UNSTROKED_WIDTH=q1.WIDTH*r.SPACE_SIZE;UP=-r.STROKE_WIDTH/2;WIDTH=this.UNSTROKED_WIDTH+2.5*r.SPACE_SIZE+r.STROKE_WIDTH;HEIGHT=this.UNSTROKED_HEIGHT+3*r.STROKE_WIDTH;MartianChessComponent=r;style={shape:"Circle",points:"Horizontal Points"};pieces=wt;state;configViewTranslation;configCogTransformation;selectedPieceInfo=h.empty();lastMoved=[];captured=h.empty();promoted=h.empty();countDown=h.empty();callTheClock=!1;displayModePanel=!1;listOfStyles=[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}];clockNeedlesPoints;static getRegularPolygon(t,n=0){const i=r.getRegularPolygonCoords(t,n);return r.mapCoordsToString(i)}static getNPointedStar(t,n){const i=this.getNPointedStarCoords(t,n);return r.mapCoordsToString(i)}static getNPointedStarCoords(t,n){const i=[],o=.5*r.SPACE_SIZE,s=.5*r.SPACE_SIZE;t*=2;for(let a=0;a<t;a++){const l=(a*(360/t)+n)/180*Math.PI,u=a%2==0?r.SPACE_SIZE/2:r.SPACE_SIZE/6,f=o+.8*u*Math.cos(l),g=s+.8*u*Math.sin(l);i.push(new _(f,g))}return i}static getRegularPolygonCoords(t,n=0){const i=[],o=.5*r.SPACE_SIZE,s=.5*r.SPACE_SIZE;for(let a=0;a<t;a++){const l=(a*(360/t)-90)/180*Math.PI,u=.5*r.SPACE_SIZE,f=o+.8*u*Math.cos(l),g=s+.8*u*Math.sin(l)+n;i.push(new _(f,g))}return i}static mapCoordsToString(t){let n="";for(const i of t)n+=i.x+", "+i.y+" ";return n}static getRadius(t){return this.SPACE_SIZE*t/10}constructor(t){super(t),this.setRulesAndNode("MartianChess"),this.availableAIs=[new cn($localize`Score`,this.rules,new Xze,new OJ),new kn($localize`MCTS`,new OJ,this.rules)],this.encoder=Qr.encoder,this.hasAsymmetricBoard=!0,this.scores=h.of(we.of(0,0)),this.SPACE_SIZE=r.SPACE_SIZE,this.configCogTransformation=this.getConfigCogTransformation(),this.configViewTranslation=this.getConfigViewTranslation(),this.clockNeedlesPoints=this.getClockNeedlesPoints()}getConfigViewTranslation(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}getConfigCogTransformation(){const t=this.STROKE_WIDTH,i=(this.SPACE_SIZE-t)/40;return"translate("+1*t+", "+1*t+") scale("+i+" "+i+")"}getClockNeedlesPoints(){const t=.5*this.SPACE_SIZE;return t+" "+.1*this.SPACE_SIZE+", "+t+" "+t+", "+.75*this.SPACE_SIZE+" "+t}updateBoard(t){var n=this;return E(function*(){n.state=n.getState(),n.board=n.state.board;const i=n.state.getScoreOf(O.ZERO),o=n.state.getScoreOf(O.ONE);n.countDown=n.state.countDown,n.scores=h.of(we.of(i,o))})()}showLastMove(t){var n=this;return E(function*(){n.lastMoved=t.getCoords();const i=t.getEnd(),s=n.node.parent.get().gameState.getPieceAt(i)!==wt.EMPTY,a=n.node.gameState.isInPlayerTerritory(i);s&&(a?n.captured=h.of(i):n.promoted=h.of(i))})()}hideLastMove(){this.lastMoved=[],this.captured=h.empty(),this.promoted=h.empty()}getPieceLocation(t,n){return"translate("+this.SPACE_SIZE*t+", "+this.SPACE_SIZE*n+")"}getPieceClasses(t,n){const i=new _(t,n),o=[];return o.push(n>3?"player0-fill":"player1-fill"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(i)&&o.push("selected-stroke"),this.promoted.equalsValue(i)&&o.push("last-move-stroke"),o}onClick(t,n){var i=this;return E(function*(){i.displayModePanel=!1;const o=yield i.canUserPlay("#click_"+t+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new _(t,n);return i.selectedPieceInfo.isPresent()?i.secondClick(s):i.firstClick(s)})()}firstClick(t){var n=this;return E(function*(){return n.isOneOfUsersPieces(t)?n.selectAsFirstPiece(t):(n.cancelMoveAttempt(),A.SUCCESS)})()}selectAsFirstPiece(t){var n=this;return E(function*(){const i=n.getLegalLandings(t);return n.selectedPieceInfo=h.of({selectedPiece:t,legalLandings:i}),A.SUCCESS})()}getLegalLandings(t){const n=this.state.getPieceAt(t);let i;return i=n===wt.PAWN?me.DIAGONALS.map(o=>t.getNext(o)):this.getValidLinearLandingSquareUntil(t,n===wt.DRONE?2:q1.HEIGHT),i.filter(o=>{const s=Qr.from(t,o);return!!s.isSuccess()&&this.rules.isLegal(s.get(),this.getState()).isSuccess()})}getValidLinearLandingSquareUntil(t,n){return me.DIRECTIONS.flatMap(i=>{const o=[];let s=t.getNext(i),a=1;for(;q1.isOnBoard(s)&&a<=n&&(o.push(s),this.getState().getPieceAt(s)===wt.EMPTY);)s=s.getNext(i),a++;return o})}secondClick(t){var n=this;return E(function*(){const i=n.selectedPieceInfo.get();if(i.selectedPiece.equals(t))return n.cancelMoveAttempt(),A.SUCCESS;if(i.legalLandings.some(o=>o.equals(t))){const o=Qr.from(i.selectedPiece,t,n.callTheClock);return L.assert(o.isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!"),n.chooseMove(o.get())}if(n.isOneOfUsersPieces(t))return n.selectAsFirstPiece(t);{const o=Qr.from(i.selectedPiece,t,n.callTheClock);return o.isSuccess()?n.chooseMove(o.get()):n.cancelMove(o.getReason())}})()}isOneOfUsersPieces(t){return this.state.getPieceAt(t)!==wt.EMPTY&&this.state.isInPlayerTerritory(t)}cancelMoveAttempt(){this.selectedPieceInfo=h.empty(),this.callTheClock=!1}onClockClick(){var t=this;return E(function*(){const n=yield t.canUserPlay("#clockOrCountDownView");return n.isFailure()?t.cancelMove(n.getReason()):(t.getState().countDown.isAbsent()&&(t.callTheClock=!1===t.callTheClock),A.SUCCESS)})()}getClockCircleClasses(){const t=["base"];return this.callTheClock&&t.push("selected-stroke"),this.getCurrentPlayer()===O.ZERO?t.push("player0-stroke"):t.push("player1-stroke"),t}getSquareClasses(t,n){const i=new _(t,n),o=["base"];return this.captured.equalsValue(i)?o.push("captured-fill"):this.lastMoved.some(s=>s.equals(i))&&o.push("moved-fill"),o}onModeCogClick(){this.displayModePanel=!1===this.displayModePanel}chooseStyle(t){this.style=this.listOfStyles[t].style,this.displayModePanel=!1}getPieceTranslation(t){return"translate(0, "+(t<=3?0:2*this.STROKE_WIDTH)+")"}getBoardTransformation(){return"translate("+this.SPACE_SIZE+", 0) rotate("+180*this.getPointOfView().getValue()+" "+this.HORIZONTAL_CENTER+" "+this.VERTICAL_CENTER+")"}getCapturesTransformation(t){const i=-this.SPACE_SIZE/2;let o=this.SPACE_SIZE/2;return t===this.getPointOfView()&&(o+=10*this.SPACE_SIZE+4*this.STROKE_WIDTH),"scale(0.5, 0.5) translate("+i+", "+o+")"}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-martian-chess"]],features:[We],decls:15,vars:19,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(n,i){1&n&&(N(),M(0,"svg",0)(1,"g"),z(2,oDe,3,2,"g",1),P(),M(3,"g",2),W("click",function(){return i.onClockClick()}),V(4,"rect",3)(5,"circle",4),z(6,sDe,2,5,"text",5)(7,aDe,1,2,"polyline",6),P(),M(8,"g",7)(9,"g",8),W("click",function(){return i.onModeCogClick()}),V(10,"rect",3)(11,"path",9),P(),z(12,lDe,3,5,"g",10),P(),M(13,"g",11),z(14,mDe,3,3,"g",1),P()()),2&n&&(w("viewBox",i.LEFT+" "+i.UP+" "+i.WIDTH+" "+i.HEIGHT),m(),w("transform",i.getBoardTransformation()),m(),v("ngForOf",i.board),m(),w("transform","translate("+5.25*i.SPACE_SIZE+", 0)"),m(),w("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),m(),v("ngClass",i.getClockCircleClasses()),w("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE)("r",.4*i.SPACE_SIZE),m(),v("ngIf",i.countDown.isPresent()),m(),v("ngIf",i.countDown.isAbsent()),m(),w("transform",i.configViewTranslation),m(2),w("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),m(),v("ngClass",i.getPlayerClass(i.getCurrentPlayer())),w("transform",i.configCogTransformation),m(),v("ngIf",i.displayModePanel),m(2),v("ngForOf",i.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();class XC extends $1{}let _De=(()=>class r{static COLUMN_IS_FULL=()=>$localize`Please put your piece in an incomplete column.`})();var bl;let Xc=class extends Da{static#e=bl=this;static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new po({name:()=>$localize`Four in a Row`,config:{width:new g1(7,Wi.WIDTH,h1.range(1,99)),height:new g1(6,Wi.HEIGHT,h1.range(1,99))}});static get(){return bl.singleton.isAbsent()&&(bl.singleton=h.of(new bl)),bl.singleton.get()}P4_HELPER;constructor(){super(),this.P4_HELPER=new o0(L.identity,4)}getRulesConfigDescription(){return h.of(bl.RULES_CONFIG_DESCRIPTION)}getInitialState(e){const t=it.create(e.get().width,e.get().height,B.NONE);return new XC(t,0)}applyLegalMove(e,t,n,i){const o=e.x,s=t.getCopiedBoard(),a=bl.get().getLowestUnoccupiedSpace(s,o),c=t.turn;return s[a][o]=t.getCurrentPlayer(),new XC(s,c+1)}isLegal(e,t){return t.getPieceAtXY(e.x,0).isPlayer()?A.failure(_De.COLUMN_IS_FULL()):A.SUCCESS}getGameStatus(e){const t=e.gameState;if(this.P4_HELPER.getVictoriousCoord(t).length>0)return ve.getVictory(t.getCurrentOpponent());const i=t.getWidth(),o=t.getHeight();return t.turn===i*o?ve.DRAW:ve.ONGOING}getVictoriousCoords(e){return this.P4_HELPER.getVictoriousCoord(e)}getLowestUnoccupiedSpace(e,t){let n=0;const i=e.length;for(;n<i&&e[n][t]===B.NONE;)n++;return n-1}};Xc=bl=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],Xc);class Qc extends C2{x;static encoder=ke.tuple([ke.identity()],e=>[e.x],e=>Qc.of(e[0]));static of(e){return L.assert(0<=e,"P4Move should be a positive integer!"),new Qc(e)}constructor(e){super(),this.x=e}equals(e){return this.x===e.x}toString(){return"P4Move("+this.x+")"}}let QC=class extends Yn{getListMoves(e,t){const i=e.gameState.getWidth(),o=Math.floor((i-1)/2);return this.getUnorderedListMoves(e,t).sort((s,a)=>Math.abs(s.x-o)-Math.abs(a.x-o))}getUnorderedListMoves(e,t){const n=e.gameState,i=[];for(let o=0;o<n.getWidth();o++)if(n.getPieceAtXY(o,0)===B.NONE){const s=Qc.of(o);i.push(s)}return i}};QC=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],QC);class yDe extends Ha{getBoardValue(e,t){const n=e.gameState;let i=0;for(let o=0;o<n.getWidth();o++)for(let s=n.getHeight()-1;-1!==s&&n.board[s][o].isPlayer();s--)i+=Xc.get().P4_HELPER.getSquareScore(n,new _(o,s));return gn.of(i)}}class MDe extends QC{getListMoves(e,t){const n=(e.gameState.getWidth()-1)/2;return super.getListMoves(e,t).sort(function i(o,s){return Math.abs(o.x-n)-Math.abs(s.x-n)})}}class EDe extends cn{constructor(){super($localize`Minimax`,Xc.get(),new yDe,new MDe)}}function PDe(r,e){if(1&r&&(N(),V(0,"circle",8)),2&r){const t=p().index,n=p().index,i=p();v("ngClass",i.getSquareFillClass(t,n)),w("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function SDe(r,e){if(1&r){const t=de();N(),M(0,"g",5),W("click",function(){const o=te(t).index;return ne(p(2).onClick(o))}),V(1,"rect",6),z(2,PDe,1,4,"circle",7),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();En("id","click_",n,""),m(),w("x",o.SPACE_SIZE*n)("y",o.SPACE_SIZE*i)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),m(),v("ngIf",t!==o.EMPTY)}}function ODe(r,e){if(1&r&&(N(),M(0,"g"),z(1,SDe,3,6,"g",4),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function TDe(r,e){if(1&r&&(N(),V(0,"rect",9)),2&r){const t=p();w("x",t.SPACE_SIZE*t.last.get().x)("y",t.SPACE_SIZE*t.last.get().y)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function ADe(r,e){if(1&r&&(N(),V(0,"rect",10)),2&r){const t=e.$implicit,n=p();Ce("id","victory_coord_",t.x,"_",t.y,""),w("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let bDe=(()=>{class r extends y2{EMPTY=B.NONE;last;victoryCoords=[];constructor(t){super(t),this.setRulesAndNode("P4"),this.availableAIs=[new EDe,new kn($localize`MCTS`,new QC,this.rules)],this.encoder=Qc.encoder}onClick(t){var n=this;return E(function*(){const i=yield n.canUserPlay("#click_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const o=Qc.of(t);return yield n.chooseMove(o)})()}updateBoard(t){var n=this;return E(function*(){const i=n.getState();n.victoryCoords=Xc.get().getVictoriousCoords(i),n.board=i.board})()}showLastMove(t,n){var i=this;return E(function*(){const o=i.getState(),s=Xc.get().getLowestUnoccupiedSpace(o.board,t.x)+1;i.last=h.of(new _(t.x,s))})()}hideLastMove(){this.last=h.empty()}getSquareFillClass(t,n){return[this.getPlayerClass(this.board[n][t])]}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-p4"]],features:[We],decls:4,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move-stroke","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(n,i){1&n&&(N(),M(0,"svg",0),z(1,ODe,2,1,"g",1)(2,TDe,1,4,"rect",2)(3,ADe,1,6,"rect",3),P()),2&n&&(w("viewBox",i.getViewBox().toSVGString()),m(),v("ngForOf",i.board),m(),v("ngIf",i.last.isPresent()),m(),v("ngForOf",i.victoryCoords))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const ut=B.NONE,f4=B.ZERO,_u=B.ONE,TJ=Xc.get().getDefaultRulesConfig();class wDe extends Bn{tutorial=[q.informational($localize`Goal of the game`,$localize`The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.
        The first player plays Dark, the second plays Light.
        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally).`,Xc.get().getInitialState(TJ)),q.anyMove($localize`Dropping a piece`,$localize`Click on any space in any column.`,Xc.get().getInitialState(TJ),Qc.of(3),$localize`As you can see, the piece falls at the bottom of the column.`),q.fromMove($localize`Victory`,$localize`You're playing Dark.
        Place your piece so that you create a horizontal alignment of 4 of your pieces.`,new XC([[ut,ut,ut,ut,ut,ut,ut],[ut,ut,ut,ut,ut,ut,ut],[ut,ut,ut,ut,ut,ut,ut],[ut,ut,ut,_u,ut,ut,ut],[ut,ut,ut,_u,ut,ut,ut],[ut,ut,f4,f4,f4,_u,ut]],0),[Qc.of(1)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`),q.fromMove($localize`Other victory`,$localize`You can also align 4 pieces diagonally or vertically.`,new XC([[ut,ut,ut,ut,ut,ut,ut],[ut,ut,ut,ut,ut,ut,ut],[ut,ut,ut,ut,ut,ut,ut],[ut,ut,ut,f4,_u,ut,ut],[ut,ut,f4,f4,_u,ut,ut],[ut,f4,_u,f4,f4,ut,ut]],0),[Qc.of(3),Qc.of(4)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`)]}class Mr extends $1{static SIZE=6;static ROTATION_MAP=[[new _(-1,-1),new _(1,-1)],[new _(0,-1),new _(1,0)],[new _(1,-1),new _(1,1)],[new _(1,0),new _(0,1)],[new _(1,1),new _(-1,1)],[new _(0,1),new _(-1,0)],[new _(-1,1),new _(-1,-1)],[new _(-1,0),new _(0,-1)]];static isOnBoard(e){return e.isInRange(Mr.SIZE,Mr.SIZE)}neutralBlocks;constructor(e,t){super(e,t),this.neutralBlocks=this.getBlocksNeutralities()}getBlocksNeutralities(){const e=[];for(let t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}getBlockNeutrality(e){const t=Mr.getBlockCenter(e),n=this.getPieceAt(t.getNext(me.UP,1)),i=this.getPieceAt(t.getNext(me.UP_LEFT,1));return this.getPieceAt(t.getNext(me.RIGHT,1))===n&&this.getPieceAt(t.getNext(me.DOWN,1))===n&&this.getPieceAt(t.getNext(me.LEFT,1))===n&&this.getPieceAt(t.getNext(me.UP_RIGHT,1))===i&&this.getPieceAt(t.getNext(me.DOWN_RIGHT,1))===i&&this.getPieceAt(t.getNext(me.DOWN_LEFT,1))===i}static getBlockCenter(e){return new _(1+(e%2==0?0:3),1+(e<2?0:3))}applyLegalDrop(e){const t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new Mr(t,this.turn)}applyLegalMove(e){const t=this.applyLegalDrop(e),n=t.getCopiedBoard();if(e.blockTurned.isPresent()){const o=Mr.getBlockCenter(e.blockTurned.get()).toVector();if(e.turnedClockwise)for(const s of Mr.ROTATION_MAP){const a=s[0].getNext(o),c=s[1].getNext(o),l=t.getPieceAt(a);n[c.y][c.x]=l}else for(const s of Mr.ROTATION_MAP){const a=s[1].getNext(o),c=s[0].getNext(o),l=t.getPieceAt(a);n[c.y][c.x]=l}}return new Mr(n,this.turn+1)}blockIsNeutral(e){return this.neutralBlocks.includes(e)}}class di extends Nr{blockTurned;turnedClockwise;static encoder=ke.tuple([_.encoder,h.getEncoder(ke.identity()),ke.identity()],e=>[e.coord,e.blockTurned,e.turnedClockwise],e=>di.of(e[0],e[1],e[2]));static of(e,t,n){return new di(e.x,e.y,t,n)}static withRotation(e,t,n,i){return L.assert(0<=n&&n<=3,"This block does not exist: "+n),new di(e,t,h.of(n),i)}static rotationless(e,t){return new di(e,t,h.empty())}constructor(e,t,n,i=!1){super(e,t),this.blockTurned=n,this.turnedClockwise=i,L.assert(Mr.isOnBoard(this.coord),"The board is a "+Mr.SIZE+" space wide square, invalid coord: "+this.coord.toString())}toString(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}equals(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}class JC extends Yn{static FIRST_TURN_MOVES=[di.rotationless(0,0),di.rotationless(1,0),di.rotationless(2,0),di.rotationless(0,1),di.rotationless(1,1),di.rotationless(0,2)];getListMoves(e,t){const n=[],i=e.gameState.neutralBlocks;if(0===e.gameState.turn)return JC.FIRST_TURN_MOVES;const o=this.getLegalDrops(e.gameState);for(const s of o){const a=di.rotationless(s.x,s.y),c=e.gameState.applyLegalDrop(a),l=this.getLegalRotations(c,i);for(const f of l)n.push(di.withRotation(s.x,s.y,f[0],f[1]));0===c.neutralBlocks.length==0&&n.push(a)}return n}getLegalDrops(e){const t=[];for(let n=0;n<Mr.SIZE;n++)for(let i=0;i<Mr.SIZE;i++){const o=new _(i,n);e.getPieceAt(o)===B.NONE&&t.push(o)}return t}getLegalRotations(e,t){const n=0===e.neutralBlocks.length,i=[];for(let o=0;o<4;o++)!1===e.blockIsNeutral(o)&&(t.includes(o)?n&&i.push([o,!0]):i.push([o,!0],[o,!1]));return i}}function NDe(r,e){if(1&r){const t=de();N(),M(0,"circle",12),W("click",function(){const o=te(t).$implicit,s=p().$implicit,a=p().index,c=p().index;return ne(p().onClick(3*a+o,3*c+s))}),P()}if(2&r){const t=e.$implicit,n=p().$implicit,i=p(),o=i.index,s=i.$implicit,a=p(),c=a.index,l=a.$implicit,u=p();Ce("id","click_",3*o+t,"_",3*c+n,""),v("ngClass",u.getSquareClasses(3*o+t,3*c+n)),w("cx",s+2*u.STROKE_WIDTH+(t+.5)*u.SPACE_SIZE)("cy",l+2*u.STROKE_WIDTH+(n+.5)*u.SPACE_SIZE)("r",(u.SPACE_SIZE-u.STROKE_WIDTH)/2)}}const AJ=()=>[0,1,2];function IDe(r,e){1&r&&(N(),jt(0),z(1,NDe,1,6,"circle",11),Zt()),2&r&&(m(),v("ngForOf",ur(1,AJ)))}function kDe(r,e){if(1&r&&(N(),jt(0),V(1,"rect",10),z(2,IDe,2,2,"ng-container",4),Zt()),2&r){const t=e.$implicit,n=e.index,i=p(),o=i.index,s=i.$implicit,a=p();m(),v("ngClass",a.getBlockClasses(n,o)),w("x",a.STROKE_WIDTH+t)("y",a.STROKE_WIDTH+s)("rx",3*a.STROKE_WIDTH)("ry",3*a.STROKE_WIDTH)("width",a.BLOCK_WIDTH)("height",a.BLOCK_WIDTH),m(),v("ngForOf",ur(8,AJ))}}const bJ=r=>[0,r];function RDe(r,e){if(1&r&&(N(),jt(0),z(1,kDe,3,9,"ng-container",4),Zt()),2&r){const t=p();m(),v("ngForOf",Oa(1,bJ,t.BLOCK_SEPARATION))}}function xDe(r,e){if(1&r&&(N(),V(0,"circle",13)),2&r){const t=p();Ce("id","currentDrop_",t.currentDrop.get().x,"_",t.currentDrop.get().y,""),v("ngClass",t.getPlayerClass(t.getCurrentPlayer())),w("cx",t.getCenter(t.currentDrop.get().x))("cy",t.getCenter(t.currentDrop.get().y))("r",(t.SPACE_SIZE-t.STROKE_WIDTH)/2)}}function LDe(r,e){if(1&r){const t=de();N(),M(0,"path",14),W("click",function(){const o=te(t).$implicit;return ne(p().rotate(o))}),P()}if(2&r){const t=e.$implicit,n=p();Ce("id","rotate_",t.blockIndex,"_",t.clockwise?"clockwise":"counterclockwise",""),w("d",t.path)("stroke-width",2*n.STROKE_WIDTH)}}function zDe(r,e){if(1&r&&(N(),V(0,"path",15)),2&r){const t=p();Ce("id","last_rotation_",t.lastRotation.get().blockIndex,"_",t.lastRotation.get().clockwise?"clockwise":"counterclockwise",""),w("d",t.lastRotation.get().path)("stroke-width",2*t.STROKE_WIDTH)}}function DDe(r,e){if(1&r&&(N(),V(0,"circle",16)),2&r){const t=e.$implicit,n=p();Ce("id","victoryCoord_",t.x,"_",t.y,""),v("ngClass",n.getSquareClasses(t.x,t.y)),w("cx",n.getCenter(t.x))("cy",n.getCenter(t.y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)("stroke-width",n.STROKE_WIDTH)}}function VDe(r,e){if(1&r){const t=de();N(),M(0,"g",17),W("click",function(){return te(t),ne(p().skipRotation())}),V(1,"circle",18)(2,"line",19),P()}if(2&r){const t=p();m(),w("cx",t.BLOCK_SEPARATION)("cy",t.BLOCK_SEPARATION)("r",.75*t.SPACE_SIZE)("stroke-width",2*t.STROKE_WIDTH),m(),w("x1",t.BLOCK_SEPARATION-t.DIAGONAL_BAR_OFFSET)("y1",t.BLOCK_SEPARATION+t.DIAGONAL_BAR_OFFSET)("x2",t.BLOCK_SEPARATION+t.DIAGONAL_BAR_OFFSET)("y2",t.BLOCK_SEPARATION-t.DIAGONAL_BAR_OFFSET)("stroke-width",2*t.STROKE_WIDTH)}}let HDe=(()=>{class r extends y2{BLOCK_WIDTH;BLOCK_SEPARATION;DIAGONAL_BAR_OFFSET;arrows=[];victoryCoords=[];canSkipRotation;currentDrop=h.empty();movedBlock=h.empty();lastDrop=h.empty();lastRotation=h.empty();ARROWS;constructor(t){super(t),this.setRulesAndNode("Pentago"),this.availableAIs=[new cn($localize`Dummy`,this.rules,new yI,new JC),new kn($localize`MCTS`,new JC,this.rules)],this.encoder=di.encoder,this.BLOCK_WIDTH=3*this.SPACE_SIZE+2*this.STROKE_WIDTH,this.BLOCK_SEPARATION=this.BLOCK_WIDTH+2*this.STROKE_WIDTH,this.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*this.SPACE_SIZE,this.ARROWS=this.generateArrowsCoord()}updateBoard(t){var n=this;return E(function*(){n.board=n.getState().getCopiedBoard(),n.victoryCoords=n.rules.getVictoryCoords(n.getState()),n.lastDrop=h.empty(),n.lastRotation=h.empty()})()}showLastMove(t){var n=this;return E(function*(){n.cancelMoveAttempt(),n.movedBlock=t.blockTurned;const i=new _(t.coord.x%3-1,t.coord.y%3-1);if(t.blockTurned.isPresent()&&(n.showLastRotation(t),!1===i.equals(new _(0,0))&&n.coordBelongToBlock(t)))return n.showLastDrop(t,i);n.lastDrop=h.of(t.coord)})()}showLastRotation(t){if(t.blockTurned.isPresent()){const n=t.blockTurned.get(),i=this.ARROWS.filter(o=>o.blockIndex===n&&o.clockwise===t.turnedClockwise)[0];this.lastRotation=h.of(i)}}showLastDrop(t,n){let i;i=t.turnedClockwise?L.getNonNullable(Mr.ROTATION_MAP.find(l=>l[0].equals(n)))[1]:L.getNonNullable(Mr.ROTATION_MAP.find(l=>l[1].equals(n)))[0];const o=t.blockTurned.get(),c=new _(o%2==0?1:4,o<2?1:4);i=i.getNext(c,1),this.lastDrop=h.of(i)}coordBelongToBlock(t){return t.blockTurned.equalsValue(2*(t.coord.y<3?0:1)+(t.coord.x<3?0:1))}hideLastMove(){this.lastDrop=h.empty(),this.movedBlock=h.empty(),this.lastRotation=h.empty(),this.victoryCoords=[]}generateArrowsCoord(){const t=2*this.BLOCK_SEPARATION,i=this.SPACE_SIZE,o=t-i,s=2*i,a=.5*this.SPACE_SIZE;return[{path:"M "+a+" 0 q  "+i+" -"+i+"  "+s+"  0",blockIndex:0,clockwise:!0},{path:"M 0 "+a+" q -"+i+"  "+i+"  0  "+s,blockIndex:0,clockwise:!1},{path:"M "+t+" "+a+" q  "+i+"  "+i+"  0  "+s,blockIndex:1,clockwise:!0},{path:"M "+o+" 0 q -"+i+" -"+i+" -"+s+"  0",blockIndex:1,clockwise:!1},{path:"M 0 "+o+" q -"+i+" -"+i+"  0 -"+s,blockIndex:2,clockwise:!0},{path:"M "+a+" "+t+" q  "+i+"  "+i+"  "+s+"  0",blockIndex:2,clockwise:!1},{path:"M "+o+" "+t+" q -"+i+"  "+i+" -"+s+"  0",blockIndex:3,clockwise:!0},{path:"M "+t+" "+o+" q  "+i+" -"+i+"  0 -"+s,blockIndex:3,clockwise:!1}]}cancelMoveAttempt(){this.arrows=[],this.currentDrop=h.empty(),this.canSkipRotation=!1}onClick(t,n){var i=this;return E(function*(){const o=yield i.canUserPlay("#click_"+t+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());if(i.hideLastMove(),i.board[n][t].isPlayer())return i.cancelMove(Me.MUST_LAND_ON_EMPTY_SPACE());const s=di.rotationless(t,n),c=i.getState().applyLegalDrop(s);if(4===c.neutralBlocks.length)return i.chooseMove(s);const l=i.rules.getGameStatus(i.node);return i.canSkipRotation=c.neutralBlocks.length>0&&!1===l.isEndGame,i.currentDrop=h.of(new _(t,n)),i.displayArrows(c.neutralBlocks),A.SUCCESS})()}getCenter(t){return(t<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(t%3+.5)*this.SPACE_SIZE}displayArrows(t){this.arrows=[];for(let n=0;n<4;n++)if(!1===t.includes(n)){const i=this.ARROWS.filter(o=>o.blockIndex===n);this.arrows=this.arrows.concat(i)}}getBlockClasses(t,n){return this.movedBlock.equalsValue(t+2*n)?["last-move-stroke"]:[]}getSquareClasses(t,n){const i=[],o=this.getPlayerClass(this.board[n][t]);return i.push(o),this.lastDrop.equalsValue(new _(t,n))&&i.push("last-move-stroke"),i}rotate(t){var n=this;return E(function*(){const i=t.clockwise?"clockwise":"counterclockwise",o=yield n.canUserPlay("#rotate_"+t.blockIndex+"_"+i);if(o.isFailure())return n.cancelMove(o.getReason());const s=n.currentDrop.get(),a=di.withRotation(s.x,s.y,t.blockIndex,t.clockwise);return n.chooseMove(a)})()}skipRotation(){var t=this;return E(function*(){const n=yield t.canUserPlay("#skipRotation");if(n.isFailure())return t.cancelMove(n.getReason());const i=t.currentDrop.get(),o=di.rotationless(i.x,i.y);return t.chooseMove(o)})()}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-pentago"]],features:[We],decls:13,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-60 -60 780 780"],["id","bluearrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],["id","movedarrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto",1,"last-move-fill"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#bluearrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","no-fill last-move-stroke","marker-end","url(#movedarrowhead)",3,"id",4,"ngIf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["class","base","pointer-events","fill",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#bluearrowhead)",1,"no-fill",3,"id","click"],["marker-end","url(#movedarrowhead)",1,"no-fill","last-move-stroke",3,"id"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(n,i){1&n&&(N(),M(0,"svg",0)(1,"defs")(2,"marker",1),V(3,"polygon",2),P()(),M(4,"defs")(5,"marker",3),V(6,"polygon",2),P()(),z(7,RDe,2,3,"ng-container",4)(8,xDe,1,6,"circle",5)(9,LDe,1,4,"path",6)(10,zDe,1,4,"path",7)(11,DDe,1,7,"circle",8)(12,VDe,3,9,"g",9),P()),2&n&&(m(7),v("ngForOf",Oa(6,bJ,i.BLOCK_SEPARATION)),m(),v("ngIf",i.currentDrop.isPresent()),m(),v("ngForOf",i.arrows),m(),v("ngIf",i.lastRotation.isPresent()),m(),v("ngForOf",i.victoryCoords),m(),v("ngIf",i.canSkipRotation))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})(),wJ=(()=>class r{static CANNOT_ROTATE_NEUTRAL_BLOCK=()=>$localize`If the quadrant to turn is neutral, please just use move without rotation.`;static MUST_CHOOSE_BLOCK_TO_ROTATE=()=>$localize`No quadrant is neutral, you must pick a quadrant to rotate.`})();class wl extends wr{static singleton=h.empty();static get(){return wl.singleton.isAbsent()&&(wl.singleton=h.of(new wl)),wl.singleton.get()}getInitialState(){const e=it.create(Mr.SIZE,Mr.SIZE,B.NONE);return new Mr(e,0)}static VICTORY_SOURCE=[[new _(1,0),new $t(1,1),!1],[new _(0,1),new $t(1,1),!1],[new _(4,0),new $t(-1,1),!1],[new _(5,1),new $t(-1,1),!1],[new _(1,1),new $t(1,1),!0],[new _(4,1),new $t(-1,1),!0],[new _(0,1),new $t(0,1),!0],[new _(1,1),new $t(0,1),!0],[new _(2,1),new $t(0,1),!0],[new _(3,1),new $t(0,1),!0],[new _(4,1),new $t(0,1),!0],[new _(5,1),new $t(0,1),!0],[new _(1,0),new $t(1,0),!0],[new _(1,1),new $t(1,0),!0],[new _(1,2),new $t(1,0),!0],[new _(1,3),new $t(1,0),!0],[new _(1,4),new $t(1,0),!0],[new _(1,5),new $t(1,0),!0]];applyLegalMove(e,t,n,i){return t.applyLegalMove(e)}isLegal(e,t){if(t.getPieceAt(e.coord).isPlayer())return A.failure(Me.MUST_LAND_ON_EMPTY_SPACE());const n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return A.failure(wJ.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){const i=e.blockTurned.get();if(n.neutralBlocks.includes(i))return A.failure(wJ.CANNOT_ROTATE_NEUTRAL_BLOCK())}return A.SUCCESS}getVictoryCoords(e){let t=[];for(const n of wl.VICTORY_SOURCE){const i=e.getPieceAt(n[0]),o=[n[0]];if(i.isPlayer()){let s=n[0].getNext(n[1]),a=!0;for(let c=0;c<3&&a;c++)e.getPieceAt(s)!==i?a=!1:(o.push(s),s=s.getNext(n[1]));if(a&&(e.getPieceAt(s)===i&&(o.push(s),t=t.concat(o)),n[2])){const c=n[0].getPrevious(n[1],1);e.getPieceAt(c)===i&&(o.push(c),t=t.concat(o))}}}return t}getGameStatus(e){const t=e.gameState,n=this.getVictoryCoords(t),i=J3.ofValues(!1,!1);for(let o=0;o<n.length;o+=5)i.put(t.getPieceAt(n[o]),!0);return!0===i.get(O.ZERO)?!0===i.get(O.ONE)?ve.DRAW:ve.ZERO_WON:!0===i.get(O.ONE)?ve.ONE_WON:t.turn===Mr.SIZE*Mr.SIZE?ve.DRAW:ve.ONGOING}}const Ve=B.NONE,Jc=B.ZERO,d4=B.ONE;class FDe{tutorial=[q.informational($localize`Initial board`,$localize`The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate.`,wl.get().getInitialState()),q.informational($localize`Goal of the game`,$localize`The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins.`,new Mr([[Jc,Ve,Ve,Jc,d4,Ve],[Jc,d4,Ve,Ve,Ve,Ve],[Jc,Ve,d4,Ve,Ve,Ve],[Jc,Ve,Ve,Ve,Ve,d4],[Jc,Ve,Ve,Ve,d4,Ve],[Ve,Ve,Ve,Ve,Ve,Ve]],10)).withPreviousMove(di.withRotation(0,0,0,!1)),q.fromPredicate($localize`Simple move`,$localize`At their turn, players put a piece on the board and possibly rotate one quadrant. As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant. To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>You're playing Dark, do a simple move.`,new Mr([[Ve,Ve,Ve,Ve,Ve,Ve],[Ve,Jc,Ve,Ve,d4,Ve],[Ve,Ve,Ve,Ve,Ve,Ve],[Ve,Ve,Ve,Ve,Ve,Ve],[Ve,d4,Ve,Ve,Jc,Ve],[Ve,Ve,Ve,Ve,Ve,Ve]],10),di.rotationless(2,2),(e,t,n)=>e.blockTurned.isPresent()?A.failure($localize`You have made a move with a rotation. This tutorial step is about moves without rotations!`):A.SUCCESS,pe.CONGRATULATIONS()),q.fromPredicate($localize`Move with rotation`,$localize`After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>
        You're playing Dark, place a piece on a quadrant and do a rotation!`,new Mr([[Ve,Ve,Ve,Ve,Ve,Ve],[Ve,Jc,Ve,Ve,d4,Ve],[Ve,Ve,Ve,Ve,Ve,Ve],[Ve,Ve,Ve,Ve,Ve,Ve],[Ve,d4,Ve,Ve,Jc,Ve],[Ve,Ve,Ve,Ve,Ve,Ve]],10),di.withRotation(0,0,0,!0),(e,t,n)=>e.blockTurned.isPresent()?A.SUCCESS:A.failure($localize`You made a move without rotation, try again!`),$localize`Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation.`)]}class bd extends $1{captures;constructor(e,t,n){super(e,n),this.captures=t}}class Ss extends Da{static RULES_CONFIG_DESCRIPTION=new po({name:()=>$localize`Default`,config:{width:new g1(19,Wi.WIDTH,h1.range(1,99)),height:new g1(19,Wi.HEIGHT,h1.range(1,99)),capturesNeededToWin:new g1(10,()=>$localize`Captured stones needed to win`,h1.range(1,123456)),nInARow:new g1(5,()=>$localize`Number of aligned pieces needed to win`,h1.range(3,99)),sizeOfSandwich:new g1(2,()=>$localize`Size of captures`,h1.range(1,99))}});static singleton=h.empty();static get(){return Ss.singleton.isAbsent()&&(Ss.singleton=h.of(new Ss)),Ss.singleton.get()}getInitialState(e){const t=e.get(),n=it.create(t.width,t.height,B.NONE),i=Math.floor(t.width/2);return n[Math.floor(t.height/2)][i]=B.ONE,new bd(n,we.of(0,0),0)}getRulesConfigDescription(){return h.of(Ss.RULES_CONFIG_DESCRIPTION)}isLegal(e,t){return!1===t.isOnBoard(e.coord)?A.failure(go.OUT_OF_RANGE(e.coord)):t.getPieceAt(e.coord).isPlayer()?A.failure(Me.MUST_CLICK_ON_EMPTY_SQUARE()):A.SUCCESS}applyLegalMove(e,t,n,i){const o=t.getCurrentPlayer(),s=t.getCopiedBoard();s[e.coord.y][e.coord.x]=o;const a=this.getCaptures(e.coord,t,n.get(),o);for(const l of a)s[l.y][l.x]=B.NONE;const c=t.captures.getCopy();return c.add(o,a.length),new bd(s,c,t.turn+1)}getCaptures(e,t,n,i){const o=i.getOpponent(),s=[],a=n.sizeOfSandwich;for(const c of me.factory.all){let l=1,u=e.getNext(c,l);const f=[u];for(;t.has(u,o)&&l<a;)l++,u=u.getNext(c,1),f.push(u);const g=e.getNext(c,a+1);t.has(u,o)&&l===a&&t.has(g,i)&&s.push(...f)}return s}getGameStatus(e,t){const n=e.gameState,i=n.getCurrentOpponent();return t.get().capturesNeededToWin<=n.captures.get(i)||this.getHelper(t).getVictoriousCoord(n).length>0?ve.getVictory(i):this.stillHaveEmptySquare(n)?ve.ONGOING:ve.DRAW}getHelper(e){if(e.isPresent())return new o0(L.identity,e.get().nInARow);{const t=Ss.RULES_CONFIG_DESCRIPTION.getDefaultConfig().config;return new o0(L.identity,t.nInARow)}}stillHaveEmptySquare(e){const t=e.getWidth(),n=e.getHeight();for(let i=0;i<n;i++)for(let o=0;o<t;o++)if(e.board[i][o]===B.NONE)return!0;return!1}}class aa extends Nr{static encoder=Nr.getEncoder(aa.of);static of(e){return new aa(e.x,e.y)}constructor(e,t){super(e,t)}toString(){return`PenteMove(${this.coord.x}, ${this.coord.y})`}}class NJ extends Yn{getListMoves(e,t){const i=[];return e.gameState.forEachCoord((o,s)=>{!1===s.isPlayer()&&i.push(aa.of(o))}),i}}class UDe extends Ha{getBoardValue(e,t){return Ss.get().getHelper(t).getBoardValue(e.gameState)}}function $De(r,e){if(1&r&&(N(),V(0,"circle",6)),2&r){const t=p().$implicit,n=p();Ce("id","piece_",t.coord.x,"_",t.coord.y,""),v("ngClass",n.getSpaceClass(t.coord)),w("cx",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.coord.x)("cy",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.coord.y)("r",.44*n.SPACE_SIZE)}}function GDe(r,e){if(1&r){const t=de();N(),M(0,"g",4),W("click",function(){const o=te(t).$implicit;return ne(p().onClick(o.coord))}),z(1,$De,1,6,"circle",5),P()}if(2&r){const t=e.$implicit;Ce("id","click_",t.coord.x,"_",t.coord.y,""),m(),v("ngIf",t.content.isPlayer())}}function BDe(r,e){if(1&r){const t=de();N(),M(0,"circle",7),W("click",function(){const o=te(t).$implicit;return ne(p().onClick(o))}),P()}if(2&r){const t=e.$implicit,n=p();Ce("id","capture_",t.x,"_",t.y,""),w("cx",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.x)("cy",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.y)("r",.14*n.SPACE_SIZE)}}let IJ=(()=>{class r extends bI{lastMoved=h.empty();victoryCoords=[];captured=[];constructor(t){super(t),this.setRulesAndNode("Pente"),this.availableAIs=[new cn($localize`Alignment`,this.rules,new UDe,new NJ),new kn($localize`MCTS`,new NJ,this.rules)],this.encoder=aa.encoder,this.scores=h.of(we.of(0,0))}updateBoard(t){var n=this;return E(function*(){const i=n.getState();n.board=i.board,n.scores=h.of(n.getState().captures);const o=n.getConfig();n.victoryCoords=n.rules.getHelper(o).getVictoriousCoord(i),n.createHoshis()})()}showLastMove(t){var n=this;return E(function*(){n.lastMoved=h.of(t.coord);const i=n.getCurrentOpponent();n.captured=Ss.get().getCaptures(t.coord,n.getPreviousState(),n.getConfig().get(),i)})()}hideLastMove(){this.captured=[],this.lastMoved=h.empty()}onClick(t){var n=this;return E(function*(){const i=yield n.canUserPlay("#click_"+t.x+"_"+t.y);return i.isFailure()?n.cancelMove(i.getReason()):n.chooseMove(aa.of(t))})()}getSpaceClass(t){const n=this.getState().getPieceAt(t),i=[];return i.push(this.getPlayerClass(n)),this.victoryCoords.some(o=>o.equals(t))&&i.push("victory-stroke"),this.lastMoved.equalsValue(t)&&i.push("last-move-stroke"),i}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-new-game"]],features:[We],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["app-blank-goban","",3,"width","height","clickCallBack"],[3,"id","click",4,"ngFor","ngForOf"],["class","captured-fill",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"captured-fill",3,"id","click"]],template:function(n,i){1&n&&(N(),M(0,"svg",0)(1,"g",1),W("clickCallBack",function(s){return i.onClick(s)}),P(),z(2,GDe,2,3,"g",2)(3,BDe,1,5,"circle",3),P()),2&n&&(w("viewBox",i.getViewBox().toSVGString()),m(),v("width",i.getState().getWidth())("height",i.getState().getHeight()),m(),v("ngForOf",i.getState().getCoordsAndContents()),m(),v("ngForOf",i.captured))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const d=B.NONE,e3=B.ZERO,Za=B.ONE,kJ=Ss.get().getDefaultRulesConfig();class WDe extends Bn{tutorial=[q.informational($localize`Initial board and object of the game`,$localize`Pente is played on a 19x19 board, on which the pieces are put on the intersections of the squares. The object of the game is to align 5 of your pieces, or to capture 10 pieces of your opponent. Initially, a piece of the second player is in the center location of the board.`,Ss.get().getInitialState(kJ)),q.anyMove($localize`Dropping a piece`,$localize`At your turn, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,Ss.get().getInitialState(kJ),aa.of(new _(9,8)),pe.CONGRATULATIONS()),q.fromMove($localize`Captures`,$localize`You can capture exactly two pieces of your opponent by sandwiching them between two of your pieces.<br/><br/>You're playing Light and you can capture, do it!`,new bd([[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,e3,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,Za,e3,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,Za,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d]],we.of(0,0),3),[aa.of(new _(9,6))],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),q.fromMove($localize`Placing in a sandwich position`,$localize`You can safely place a piece next to another of your piece in what would look like a sandwich from the opponent's pieces. This is a safe move.<br/><br/>You're playing Light and have the opportunity to do such a move here, do it!`,new bd([[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,Za,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,Za,e3,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,Za,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d]],we.of(0,0),4),[aa.of(new _(9,7))],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),q.fromMove($localize`Victory`,$localize`Remember, to win you can either align 5 or your pieces, or capture 10 pieces of your opponent. Here, as Light, you have already captured 8 pieces and you only need two more to win.<br/><br/>You're playing Light, you can win in two ways. Win!`,new bd([[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,Za,d,d,e3,e3,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,e3,d,e3,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,Za,e3,e3,e3,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,Za,Za,Za,Za,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d]],we.of(8,8),7),[aa.of(new _(9,6)),aa.of(new _(8,9)),aa.of(new _(13,9))],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN())]}class wd extends _{z;static getCoord3DEncoder(e){return ke.tuple([ke.identity(),ke.identity(),ke.identity()],t=>[t.x,t.y,t.z],t=>e(t[0],t[1],t[2]))}static of(e,t,n){return new wd(e,t,n)}constructor(e,t,n){super(e,t),this.z=n}toString(){return"Coord3D"+this.toShortString()}toShortString(){return"("+this.x+", "+this.y+", "+this.z+")"}equals(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}isHigherThan(e){return this.z>e.z}}class yn extends wd{static coordEncoder=wd.getCoord3DEncoder(yn.of);static optionalEncoder=h.getEncoder(yn.coordEncoder);static of(e,t,n){return new yn(e,t,n)}constructor(e,t,n){super(e,t,n),L.assert(0<=e&&e<=3,`PylosCoord: Invalid X: ${e}.`),L.assert(0<=t&&t<=3,`PylosCoord: Invalid Y: ${t}.`),L.assert(0<=n&&n<=3,`PylosCoord: Invalid Z: ${n}.`);const i=4-n;L.assert(this.isInRange(i,i),this.toString()+" is not in range.")}toString(){return"PylosCoord"+this.toShortString()}getLowerPieces(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");const e=this.z-1;return[new yn(this.x,this.y,e),new yn(this.x+1,this.y,e),new yn(this.x,this.y+1,e),new yn(this.x+1,this.y+1,e)]}getHigherCoords(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");const e=this.z+1,t=new _(this.x-1,this.y-1),n=new _(this.x,this.y-1),i=new _(this.x-1,this.y),o=new _(this.x,this.y),s=4-e;return[t,n,i,o].filter(a=>a.isInRange(s,s)).map(a=>new yn(a.x,a.y,e))}getNextValid(e){const t=new _(this.x,this.y).getNext(e),n=4-this.z;return t.isNotInRange(n,n)?h.empty():h.of(new yn(t.x,t.y,this.z))}}let Nl=(()=>class r{static MUST_MOVE_UPWARD=()=>$localize`You must move your pieces upward.`;static SHOULD_HAVE_SUPPORTING_PIECES=()=>$localize`Your piece must land on the board or on 4 other pieces.`;static CANNOT_MOVE_SUPPORTING_PIECE=()=>$localize`You cannot move a supporting piece.`;static CANNOT_CAPTURE=()=>$localize`You cannot capture.`;static INVALID_FIRST_CAPTURE=()=>$localize`Your first capture is invalid.`;static INVALID_SECOND_CAPTURE=()=>$localize`Your second capture is invalid.`})(),RJ=(()=>class r{static MUST_CAPTURE_MAXIMUM_TWO_PIECES=()=>$localize`You must capture one or two pieces, not more.`})();class xr extends C2{startingCoord;landingCoord;firstCapture;secondCapture;static encoder=ke.tuple([yn.optionalEncoder,yn.coordEncoder,yn.optionalEncoder,yn.optionalEncoder],e=>[e.startingCoord,e.landingCoord,e.firstCapture,e.secondCapture],e=>xr.of(e[0],e[1],e[2],e[3]));static ofClimb(e,t,n){const i=h.of(e),o=xr.checkCaptures(n),s=new xr(i,t,o.firstCapture,o.secondCapture);return L.assert(t.isHigherThan(e),Nl.MUST_MOVE_UPWARD()),s}static checkCaptures(e){let t=h.empty(),n=h.empty();if(e.length>0&&(t=h.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=h.of(e[1]),e[1].isHigherThan(e[0])&&(t=h.of(e[1]),n=h.of(e[0])),e.length>2)throw new Error(RJ.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:t,secondCapture:n}}static ofDrop(e,t){const n=h.empty(),i=xr.checkCaptures(t);return new xr(n,e,i.firstCapture,i.secondCapture)}static changeCapture(e,t){const n=xr.checkCaptures(t);return new xr(e.startingCoord,e.landingCoord,n.firstCapture,n.secondCapture)}static of(e,t,n,i){return new xr(e,t,n,i)}constructor(e,t,n,i){super(),this.startingCoord=e,this.landingCoord=t,this.firstCapture=n,this.secondCapture=i}isClimb(){return this.startingCoord.isPresent()}toString(){const e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}equals(e){return e===this||!(!1===this.startingCoord.equals(e.startingCoord)||!1===this.landingCoord.equals(e.landingCoord)||!1===this.firstCapture.equals(e.firstCapture)||!1===this.secondCapture.equals(e.secondCapture))}}class Il extends mC{boards;static getLevelRange(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return L.expectToBe(e,2),[0,1]}}constructor(e,t){super(t),this.boards=e}getPieceAt(e){return this.boards[e.z][e.y][e.x]}applyLegalMove(e,t=!0){const n=[];let i;return n.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&n.push({coord:e.startingCoord.get(),value:B.NONE}),e.firstCapture.isPresent()&&n.push({coord:e.firstCapture.get(),value:B.NONE}),e.secondCapture.isPresent()&&n.push({coord:e.secondCapture.get(),value:B.NONE}),i=t?this.turn+1:this.turn,this.setBoardAtCoords(n,i)}setBoardAtCoords(e,t){const n=[it.copy(this.boards[0]),it.copy(this.boards[1]),it.copy(this.boards[2]),it.copy(this.boards[3])];for(const i of e){const o=i.coord;n[o.z][o.y][o.x]=i.value}return new Il(n,t)}isLandable(e){if(this.getPieceAt(e).isPlayer())return!1;if(0===e.z)return!0;const t=e.getLowerPieces();for(const n of t)if(this.getPieceAt(n)===B.NONE)return!1;return!0}isSupporting(e){if(3===e.z)return!1;const t=e.getHigherCoords();for(const n of t)if(this.getPieceAt(n).isPlayer())return!0;return!1}getPiecesRepartition(){const e=we.of(0,0);for(let t=0;t<3;t++)for(let n=0;n<4-t;n++)for(let i=0;i<4-t;i++){const o=new yn(i,n,t),s=this.getPieceAt(o);s.isPlayer()&&e.add(s,1)}return e}removePieceAt(e){return this.setBoardAtCoords([{coord:e,value:B.NONE}],this.turn)}dropCurrentPlayersPieceAt(e){const t={coord:e,value:this.getCurrentPlayer()};return this.setBoardAtCoords([t],this.turn)}getFreeToMoves(){const e=[],t=this.getCurrentPlayer();for(let n=0;n<=2;n++){const i=Il.getLevelRange(n);for(const o of i)for(const s of i){const a=new yn(s,o,n);this.getPieceAt(a).equals(t)&&!1===this.isSupporting(a)&&e.push(a)}}return e}}class Qi extends wr{static singleton=h.empty();static get(){return Qi.singleton.isAbsent()&&(Qi.singleton=h.of(new Qi)),Qi.singleton.get()}getInitialState(){const e=it.create(4,4,B.NONE),t=it.create(3,3,B.NONE),n=it.create(2,2,B.NONE);return new Il([e,t,n,[[B.NONE]]],0)}static getStateInfo(e){const t=[],n=[];for(let i=0;i<3;i++)for(let o=0;o<4-i;o++)for(let s=0;s<4-i;s++){const a=new yn(s,o,i);e.getPieceAt(a)===e.getCurrentPlayer()&&!1===e.isSupporting(a)&&t.push(a),e.isLandable(a)&&n.push(a)}return{freeToMove:t,landable:n}}static getClimbingMoves(e){const t=[];for(const n of e.freeToMove)for(const i of e.landable)if(i.isHigherThan(n)&&!1===i.getLowerPieces().some(o=>n.equals(o))){const o=xr.ofClimb(n,i,[]);t.push(o)}return t}static getDropMoves(e){const t=[];for(const n of e.landable){const i=xr.ofDrop(n,[]);t.push(i)}return t}static canCapture(e,t){const n=e.getCurrentPlayer();for(const i of[Ie.UP,Ie.DOWN]){const o=t.getNextValid(i);if(o.isPresent()&&e.getPieceAt(o.get())===n)for(const s of[Ie.LEFT,Ie.RIGHT]){const a=o.get().getNextValid(s);if(a.isPresent()&&e.getPieceAt(a.get())===n){const c=i.getOpposite(),l=a.get().getNextValid(c).get();if(e.getPieceAt(l)===n)return!0}}}return!1}static getPossibleCaptures(e){const t=new ct,n=e.getFreeToMoves();for(const i of n){t.add(new ct([i]));const s=e.removePieceAt(i).getFreeToMoves();for(const a of s){const c=new ct([i,a]);t.add(c)}}return t}static isValidCapture(e,t,n){const i=e.getCurrentPlayer();return(!1!==n.equals(t.landingCoord)||e.getPieceAt(n)===i)&&0===n.getHigherCoords().filter(s=>e.getPieceAt(s).isPlayer()&&!1===s.equals(t.firstCapture.get())).length}static getGameStatus(e){const t=e.gameState.getPiecesRepartition();return 15===t.get(O.ZERO)?ve.ONE_WON:15===t.get(O.ONE)?ve.ZERO_WON:ve.ONGOING}applyLegalMove(e,t,n,i){return t.applyLegalMove(e)}isLegal(e,t){const n=this.isLegalStartingCoord(e,t);if(n.isFailure())return n.toOtherFallible();const i=n.get(),o=this.isLegalLandingCoord(e,i);if(o.isFailure())return o.toOtherFallible();const s=o.get(),a=this.isLegalCaptures(e,s);return a.isFailure()?a:A.SUCCESS}isLegalStartingCoord(e,t){const n=t.getCurrentOpponent();if(e.startingCoord.isPresent()){const i=e.startingCoord.get(),o=t.getPieceAt(i);if(o===n)return X.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(o===B.NONE)return X.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===i.getHigherCoords().filter(a=>t.getPieceAt(a).isPlayer()).length){const a=t.removePieceAt(e.startingCoord.get());return X.success(a)}return X.failure(Nl.CANNOT_MOVE_SUPPORTING_PIECE())}return X.success(t)}isLegalLandingCoord(e,t){return t.getPieceAt(e.landingCoord).isPlayer()?X.failure(Me.MUST_LAND_ON_EMPTY_SPACE()):t.isLandable(e.landingCoord)?X.success(t.dropCurrentPlayersPieceAt(e.landingCoord)):X.failure(Nl.SHOULD_HAVE_SUPPORTING_PIECES())}isLegalCaptures(e,t){if(e.firstCapture.isAbsent())return A.SUCCESS;if(!1===Qi.canCapture(t,e.landingCoord))return A.failure(Nl.CANNOT_CAPTURE());if(Qi.isValidCapture(t,e,e.firstCapture.get())){const n=t.removePieceAt(e.firstCapture.get());return e.secondCapture.isAbsent()||Qi.isValidCapture(n,e,e.secondCapture.get())?A.SUCCESS:A.failure(Nl.INVALID_SECOND_CAPTURE())}return A.failure(Nl.INVALID_FIRST_CAPTURE())}getGameStatus(e){return Qi.getGameStatus(e)}}class xJ extends Yn{getListMoves(e,t){const n=e.gameState,i=[],o=Qi.getStateInfo(n),s=Qi.getClimbingMoves(o),a=Qi.getDropMoves(o),c=s.concat(a);for(const l of c){const u=n.applyLegalMove(l,!1);let f=new ct;Qi.canCapture(u,l.landingCoord)?f=Qi.getPossibleCaptures(u):i.push(l);for(const g of f){const y=xr.changeCapture(l,g.toList());i.push(y)}}return i}}class qDe extends xJ{getListMoves(e,t){const n=super.getListMoves(e,t);return this.orderMoves(n)}orderMoves(e){return e.sort((t,n)=>{const i=12*this.countStoneUsed(t),o=12*this.countStoneUsed(n);return i+this.sumMoveEmplacementByValue(t)-(o+this.sumMoveEmplacementByValue(n))})}countStoneUsed(e){let t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}sumMoveEmplacementByValue(e){let t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}}class jDe extends or{getMetrics(e,t){return e.gameState.getPiecesRepartition().toTable()}}function ZDe(r,e){if(1&r&&(N(),V(0,"circle",8)),2&r){const t=e.$implicit,n=p().$implicit,i=p();Ce("id","piece_",n.getValue(),"_",t,""),v("ngClass",i.getPlayerClass(n)),w("cx",i.SPACE_SIZE/4+t/15*(i.boardWidth-i.SPACE_SIZE/4))("cy",i.getPiecesCyForPlayer(n))("r",i.SPACE_SIZE/4-i.STROKE_WIDTH)}}function YDe(r,e){if(1&r&&(N(),M(0,"g"),z(1,ZDe,1,6,"circle",7),P()),2&r){const t=e.$implicit,n=p();m(),v("ngForOf",n.getPlayerSidePieces(t))}}function KDe(r,e){if(1&r){const t=de();N(),M(0,"circle",12),W("click",function(){te(t);const i=p(2).$implicit,o=p().$implicit,s=p().$implicit;return ne(p().onPieceClick(i,o,s))}),P()}if(2&r){const t=p(2).$implicit,n=p().$implicit,i=p().$implicit,o=p();Hr("id","piece_",t,"_",n,"_",i,""),v("ngClass",o.getPieceClasses(t,n,i)),w("r",o.getPieceRadius(i)-o.STROKE_WIDTH)("cx",o.getPieceCx(t,n,i))("cy",o.getPieceCy(t,n,i))}}function XDe(r,e){if(1&r){const t=de();N(),M(0,"rect",12),W("click",function(){te(t);const i=p(3).$implicit,o=p().$implicit,s=p().$implicit;return ne(p().onDrop(i,o,s))}),P()}if(2&r){const t=p(3).$implicit,n=p().$implicit,i=p().$implicit,o=p();Hr("id","drop_",t,"_",n,"_",i,""),v("ngClass",o.getSquareClasses(t,n,i)),w("width",2*o.getPieceRadius(i))("height",2*o.getPieceRadius(i))("x",o.getPieceCx(t,n,i)-o.getPieceRadius(i))("y",o.getPieceCy(t,n,i)-o.getPieceRadius(i))}}function QDe(r,e){if(1&r&&(N(),z(0,XDe,1,8,"rect",13)),2&r){const t=p(2).$implicit,n=p().$implicit,i=p().$implicit;v("ngIf",p().mustDisplayLandingCoord(t,n,i))}}function JDe(r,e){if(1&r&&(N(),jt(0),z(1,KDe,1,7,"circle",10)(2,QDe,1,1,"ng-template",null,11,wn),Zt()),2&r){const t=Pn(3),n=p().$implicit,i=p().$implicit,o=p().$implicit,s=p();m(),v("ngIf",s.isOccupied(n,i,o))("ngIfElse",t)}}function eVe(r,e){if(1&r&&(N(),M(0,"g"),z(1,JDe,4,2,"ng-container",9),P()),2&r){const t=e.$implicit,n=p().$implicit,i=p().$implicit,o=p();m(),v("ngIf",o.mustDraw(t,n,i))}}function tVe(r,e){if(1&r&&(N(),M(0,"g"),z(1,eVe,2,1,"g",1),P()),2&r){const t=p().$implicit,n=p();m(),v("ngForOf",n.getLevelRange(t))}}function nVe(r,e){if(1&r&&(N(),M(0,"g"),z(1,tVe,2,1,"g",1),P()),2&r){const t=e.$implicit,n=p();m(),v("ngForOf",n.getLevelRange(t))}}function rVe(r,e){if(1&r&&(N(),V(0,"rect",14)),2&r){const t=p();Hr("id","highCapture_",t.highCapture.get().x,"_",t.highCapture.get().y,"_",t.highCapture.get().z,""),w("width",2*t.getPieceRadius(t.highCapture.get().z))("height",2*t.getPieceRadius(t.highCapture.get().z))("x",t.getPieceCxByCoord(t.highCapture.get())-t.getPieceRadius(t.highCapture.get().z))("y",t.getPieceCyByCoord(t.highCapture.get())-t.getPieceRadius(t.highCapture.get().z))}}function iVe(r,e){if(1&r){const t=de();N(),M(0,"g",15),W("click",function(){return te(t),ne(p().validateCapture())}),V(1,"circle",16)(2,"polygon",17),P()}if(2&r){const t=p();w("transform","translate("+4*t.SPACE_SIZE+" "+4*t.SPACE_SIZE+")"),m(),v("ngClass",t.getCaptureValidationButtonClasses()),w("cx",t.STROKE_WIDTH/2)("cy",t.STROKE_WIDTH/2)("r",t.SPACE_SIZE/2)}}function oVe(r,e){if(1&r){const t=de();N(),M(0,"g",18),W("click",function(){const o=te(t).$implicit;return ne(p().onPieceClick(o.x,o.y,o.z))}),V(1,"line",19)(2,"line",19),P()}if(2&r){const t=e.$implicit,n=p();Hr("id","capturable_",t.x,"_",t.y,"_",t.z,""),w("transform","translate("+n.getPieceCxByCoord(t)+" "+n.getPieceCyByCoord(t)+")"),m(),w("x1",-.25*n.getPieceRadius(t.z))("y1",-.25*n.getPieceRadius(t.z))("x2",.25*n.getPieceRadius(t.z))("y2",.25*n.getPieceRadius(t.z)),m(),w("x1",.25*n.getPieceRadius(t.z))("y1",-.25*n.getPieceRadius(t.z))("x2",-.25*n.getPieceRadius(t.z))("y2",.25*n.getPieceRadius(t.z))}}const sVe=()=>[0,1,2];let aVe=(()=>{class r extends $c{boardWidth=4*this.SPACE_SIZE+this.STROKE_WIDTH;pieceRowHeight=this.SPACE_SIZE/2;boardHeight=this.boardWidth+2*this.pieceRowHeight;state;constructedState;lastLandingCoord=h.empty();lastStartingCoord=h.empty();lastFirstCapture=h.empty();lastSecondCapture=h.empty();highCapture=h.empty();capturables=[];chosenStartingCoord=h.empty();chosenLandingCoord=h.empty();chosenFirstCapture=h.empty();chosenSecondCapture=h.empty();captured=[];lastMoved=[];remainingPieces=we.of(15,15);constructor(t){super(t),this.setRulesAndNode("Pylos"),this.availableAIs=[new cn($localize`Minimax`,this.rules,new jDe,new qDe),new kn($localize`MCTS`,new xJ,this.rules)],this.encoder=xr.encoder,this.hasAsymmetricBoard=!0}getPiecesCyForPlayer(t){return t===O.ONE?this.pieceRowHeight/2:this.boardWidth+1.5*this.pieceRowHeight}getLevelRange(t){return Il.getLevelRange(t)}mustDraw(t,n,i){const o=new yn(t,n,i);return!!(this.constructedState.getPieceAt(o).isPlayer()||this.justClimbed(o)||this.isCaptured(o))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(o)}isCaptured(t){return this.chosenFirstCapture.equalsValue(t)||this.chosenSecondCapture.equalsValue(t)}onPieceClick(t,n,i){var o=this;return E(function*(){const s=yield o.canUserPlay("#piece_"+t+"_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new yn(t,n,i);return o.state.getPieceAt(a)===o.state.getCurrentOpponent()?o.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):o.chosenStartingCoord.equalsValue(a)?(o.cancelMoveAttempt(),A.SUCCESS):o.chosenLandingCoord.isPresent()?o.isSupporting(a,o.constructedState)?o.cancelMove(Nl.CANNOT_MOVE_SUPPORTING_PIECE()):o.onCaptureClick(a):o.isSupporting(a,o.getState())?o.cancelMove(Nl.CANNOT_MOVE_SUPPORTING_PIECE()):o.onClimbClick(a)})()}isSupporting(t,n){return n.isSupporting(t)}onClimbClick(t){var n=this;return E(function*(){return n.chosenStartingCoord=h.of(t),n.constructedState=n.constructedState.removePieceAt(t),A.SUCCESS})()}onCaptureClick(t){var n=this;return E(function*(){return n.chosenFirstCapture.equalsValue(t)?(n.chosenFirstCapture=h.empty(),n.constructedState=n.constructedState.dropCurrentPlayersPieceAt(t),n.updateCapturableList(),A.SUCCESS):n.chosenSecondCapture.equalsValue(t)?(n.chosenSecondCapture=h.empty(),n.constructedState=n.constructedState.dropCurrentPlayersPieceAt(t),n.updateCapturableList(),A.SUCCESS):n.chosenFirstCapture.isAbsent()?(n.chosenFirstCapture=h.of(t),n.constructedState=n.constructedState.removePieceAt(t),n.updateCapturableList(),A.SUCCESS):n.chosenSecondCapture.isAbsent()?(n.chosenSecondCapture=h.of(t),n.constructedState=n.constructedState.removePieceAt(t),n.updateCapturableList(),A.SUCCESS):n.cancelMove(RJ.MUST_CAPTURE_MAXIMUM_TWO_PIECES())})()}updateCapturableList(){this.capturables=this.constructedState.getFreeToMoves()}getCaptureValidationButtonClasses(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}validateCapture(){var t=this;return E(function*(){const n=yield t.canUserPlay("#capture_validation");return n.isFailure()?t.cancelMove(n.getReason()):t.chosenFirstCapture.isAbsent()&&t.chosenSecondCapture.isAbsent()?A.SUCCESS:t.chosenFirstCapture.isPresent()&&t.chosenSecondCapture.isAbsent()?t.concludeMoveWithCapture([t.chosenFirstCapture.get()]):t.chosenFirstCapture.isAbsent()&&t.chosenSecondCapture.isPresent()?t.concludeMoveWithCapture([t.chosenSecondCapture.get()]):t.concludeMoveWithCapture([t.chosenFirstCapture.get(),t.chosenSecondCapture.get()])})()}concludeMoveWithCapture(t){var n=this;return E(function*(){if(n.chosenStartingCoord.isAbsent()){const i=xr.ofDrop(n.chosenLandingCoord.get(),t);return n.chooseMove(i)}{const i=xr.ofClimb(n.chosenStartingCoord.get(),n.chosenLandingCoord.get(),t);return n.chooseMove(i)}})()}cancelMoveAttempt(){this.constructedState=this.state,this.chosenStartingCoord=h.empty(),this.chosenLandingCoord=h.empty(),this.chosenFirstCapture=h.empty(),this.chosenSecondCapture=h.empty(),this.capturables=[]}onDrop(t,n,i){var o=this;return E(function*(){const s=yield o.canUserPlay("#drop_"+t+"_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new yn(t,n,i);return Qi.canCapture(o.constructedState,a)?(o.chosenLandingCoord=h.of(a),o.constructedState=o.constructedState.dropCurrentPlayersPieceAt(a),o.updateCapturableList(),A.SUCCESS):(o.chosenLandingCoord=h.of(a),o.concludeMoveWithCapture([]))})()}getSquareClasses(t,n,i){const o=new yn(t,n,i);return this.captured.some(s=>s.equalsValue(o))?["captured-fill"]:this.lastMoved.some(s=>s.equals(o))||this.justClimbed(o)?["moved-fill"]:[]}justClimbed(t){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(t)}getPieceRadius(t){return this.SPACE_SIZE*(.45+.025*t)}getPieceCx(t,n,i){return this.SPACE_SIZE/2+.5*i*this.SPACE_SIZE+t*this.SPACE_SIZE}getPieceCy(t,n,i){return this.SPACE_SIZE/2+.5*i*this.SPACE_SIZE+n*this.SPACE_SIZE}getPieceCxByCoord(t){return this.getPieceCx(t.x,t.y,t.z)}getPieceCyByCoord(t){return this.getPieceCy(t.x,t.y,t.z)}isOccupied(t,n,i){const o=new yn(t,n,i);if(this.justClimbed(o))return!1;const s=this.getState().getPieceAt(o).isPlayer(),a=this.chosenLandingCoord.equalsValue(o);return s||a}getPieceClasses(t,n,i){const o=new yn(t,n,i),s=[this.getPieceFillClass(o)];return(this.lastLandingCoord.equalsValue(o)||this.lastStartingCoord.equalsValue(o))&&s.push("last-move-stroke"),(this.chosenStartingCoord.equalsValue(o)||this.chosenLandingCoord.equalsValue(o))&&s.push("selected-stroke"),this.isCaptured(o)&&s.push("pre-captured-fill"),s}getPieceFillClass(t){return this.chosenLandingCoord.equalsValue(t)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(t))}getPlayerSidePieces(t){const n=this.remainingPieces.get(t),i=[];for(let o=0;o<n;o++)i.push(o);return i}updateBoard(t){var n=this;return E(function*(){n.state=n.getState(),n.constructedState=n.state;const i=n.state.getPiecesRepartition();n.remainingPieces=we.of(15-i.get(O.ZERO),15-i.get(O.ONE)),n.highCapture=h.empty(),n.cancelMoveAttempt(),n.hideLastMove()})()}showLastMove(t){var n=this;return E(function*(){n.lastStartingCoord=t.startingCoord,n.lastLandingCoord=h.of(t.landingCoord),n.lastFirstCapture=t.firstCapture,n.lastSecondCapture=t.secondCapture,n.lastFirstCapture.isPresent()&&!1===n.mustDrawCoord(n.lastFirstCapture.get())&&(n.highCapture=n.lastFirstCapture),n.captured=[t.firstCapture,t.secondCapture],n.lastMoved=[t.landingCoord],t.startingCoord.isPresent()&&n.lastMoved.push(t.startingCoord.get())})()}hideLastMove(){this.lastStartingCoord=h.empty(),this.lastLandingCoord=h.empty(),this.lastFirstCapture=h.empty(),this.lastSecondCapture=h.empty(),this.highCapture=h.empty(),this.lastMoved=[],this.captured=[]}mustDrawCoord(t){return this.mustDraw(t.x,t.y,t.z)}mustDisplayLandingCoord(t,n,i){return!this.chosenStartingCoord.isPresent()||!!this.chosenStartingCoord.get().equals(new yn(t,n,i))||this.chosenStartingCoord.get().z<i}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-pylos"]],features:[We],decls:10,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured-fill small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","captured-fill","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id","click"],["stroke-width","8","stroke","red"]],template:function(n,i){1&n&&(N(),M(0,"svg",0)(1,"g"),z(2,YDe,2,1,"g",1),P(),M(3,"g",null,2),V(5,"rect",3),z(6,nVe,2,1,"g",1)(7,rVe,1,7,"rect",4)(8,iVe,3,5,"g",5)(9,oVe,3,12,"g",6),P()()),2&n&&(w("viewBox","0 0 "+i.boardWidth+" "+i.boardHeight),m(),w("transform","rotate("+180*i.getPointOfView().getValue()+" "+i.boardWidth/2+" "+i.boardHeight/2+")"),m(),v("ngForOf",i.Player.PLAYERS),m(),w("transform","translate("+i.STROKE_WIDTH/2+" "+(i.STROKE_WIDTH/2+i.pieceRowHeight)+")"),m(2),w("width",4*i.SPACE_SIZE)("height",4*i.SPACE_SIZE),m(),v("ngForOf",ur(10,sVe)),m(),v("ngIf",i.highCapture.isPresent()),m(),v("ngIf",i.chosenLandingCoord.isPresent()),m(),v("ngForOf",i.capturables))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const Ze=B.NONE,h4=B.ZERO,LJ=B.ONE;class cVe extends Bn{tutorial=[q.informational($localize`Goal of the game`,$localize`At Pylos, the goal is to be the last to play.
        To do this, you have to save up your pieces.
        As soon as a player puts its last piece, that player loses the game immediately.
        Here is what the initial board looks like, it is a board of 4 x 4 squares.
        This board will become a pyramid, little by little.
        It will be filled by the pieces of your stock. Each player has 15 pieces.`,Qi.get().getInitialState()),q.anyMove($localize`Dropping a piece`,$localize`When it is your turn, you can always drop one of your piece on an empty square.
        The gray squares are where you can drop your pieces.<br/><br/>
        Click on one of the squares to drop a piece there.`,Qi.get().getInitialState(),xr.ofDrop(new yn(1,1,0),[]),$localize`There you go, as simple as that.`),q.fromMove($localize`Climbing`,$localize`When 4 pieces form a square, it is possible to put a fifth piece on top.
        However, when that happens, you can save a piece by climbing instead of dropping a piece.
        To climb:
        <ol>
            <li>Click on one of your free pieces, which should be lower than the landing square.</li>
            <li>Click on an empty landing square, higher than your selected piece.</li>
        </ol><br/>
        You're playing Dark, go ahead and climb!`,new Il([[[h4,LJ,Ze,Ze],[LJ,h4,Ze,Ze],[Ze,Ze,Ze,Ze],[Ze,Ze,Ze,h4]],[[Ze,Ze,Ze],[Ze,Ze,Ze],[Ze,Ze,Ze]],[[Ze,Ze],[Ze,Ze]],[[Ze]]],0),[xr.ofClimb(new yn(3,3,0),new yn(0,0,1),[])],$localize`Congratulations!<br/>
        Some important notes:
        <ol>
            <li>You cannot move a piece that is directly below another one.</li>
            <li>Of course, you cannot move the opponent's pieces.</li>
            <li>You can only climb when the landing square is higher than the starting square.</li>
        </ol>`,pe.FAILED_TRY_AGAIN()),q.fromMove($localize`Square (1/2)`,$localize`When the piece you just moved or dropped is the fourth one of a square of your color,
        you can choose anywhere on the board one or two of your pieces.
        These pieces will be removed from the board, allowing you to save up one or two pieces.
        A chosen piece must not be directly below another piece.
        A chosen piece can be the piece you just placed.<br/><br/>
        You're playing Dark. Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move.`,new Il([[[h4,h4,Ze,Ze],[Ze,h4,Ze,Ze],[Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze]],[[Ze,Ze,Ze],[Ze,Ze,Ze],[Ze,Ze,Ze]],[[Ze,Ze],[Ze,Ze]],[[Ze]]],0),[xr.ofDrop(new yn(0,1,0),[new yn(0,0,0)]),xr.ofDrop(new yn(0,1,0),[new yn(0,1,0)]),xr.ofDrop(new yn(0,1,0),[new yn(1,0,0)]),xr.ofDrop(new yn(0,1,0),[new yn(1,1,0)])],$localize`Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece.`,pe.FAILED_TRY_AGAIN()),q.fromPredicate($localize`Square (2/2)`,$localize`You're playing Dark.<br/><br/>
        Do like in the previous step, but this time click on two different pieces before validating.`,new Il([[[h4,h4,Ze,Ze],[Ze,h4,Ze,Ze],[Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze]],[[Ze,Ze,Ze],[Ze,Ze,Ze],[Ze,Ze,Ze]],[[Ze,Ze],[Ze,Ze]],[[Ze]]],0),xr.ofDrop(new yn(0,1,0),[new yn(0,0,0),new yn(1,0,0)]),(e,t,n)=>e.secondCapture.isPresent()?A.SUCCESS:e.firstCapture.isPresent()?A.failure($localize`Failed, you only captured one piece.`):A.failure(pe.YOU_DID_NOT_CAPTURE_ANY_PIECE()),$localize`Congratulations, you have saved up two pieces.`)]}class ot{value;static AAAA=new ot(0);static AAAB=new ot(1);static AABA=new ot(2);static AABB=new ot(3);static ABAA=new ot(4);static ABAB=new ot(5);static ABBA=new ot(6);static ABBB=new ot(7);static BAAA=new ot(8);static BAAB=new ot(9);static BABA=new ot(10);static BABB=new ot(11);static BBAA=new ot(12);static BBAB=new ot(13);static BBBA=new ot(14);static BBBB=new ot(15);static EMPTY=new ot(16);static pieces=[ot.AAAA,ot.AAAB,ot.AABA,ot.AABB,ot.ABAA,ot.ABAB,ot.ABBA,ot.ABBB,ot.BAAA,ot.BAAB,ot.BABA,ot.BABB,ot.BBAA,ot.BBAB,ot.BBBA,ot.BBBB];static encoder=ke.fromFunctions(e=>e.value,ot.ofInt);static ofInt(e){if(0<=e&&e<=15)return ot.pieces[e];if(16===e)return ot.EMPTY;throw new Error("Invalid piece ("+e+")")}constructor(e){this.value=e}equals(e){return this===e}toString(){return"QuartoPiece("+this.value+")"}isRectangle(){return this.value%4<2}}class t3 extends Nr{piece;static encoder=ke.tuple([_.encoder,ot.encoder],e=>[e.coord,e.piece],e=>new t3(e[0].x,e[0].y,e[1]));constructor(e,t,n){super(e,t),this.piece=n}toString(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}equals(e){return this===e||!1!==e.coord.equals(this.coord)&&this.piece===e.piece}}class n3 extends $1{pieceInHand;constructor(e,t,n){super(e,t),this.pieceInHand=n}static isGivable(e,t,n){return e!==n&&!1===n3.isAlreadyOnBoard(e,t)}static isAlreadyOnBoard(e,t){for(let n=0;n<4;n++)for(let i=0;i<4;i++)if(t[n][i]===e)return!0;return!1}getRemainingPieces(){const e=ot.pieces,t=[];for(const n of e)n3.isGivable(n,this.board,this.pieceInHand)&&t.push(n);return t}}var o1=function(r){return r.VICTORY="VICTORY",r.PRE_VICTORY="PRE_VICTORY",r.DEFAULT="DEFAULT",r}(o1||{});let KI=(()=>class r{static MUST_GIVE_A_PIECE=()=>$localize`You must give a piece.`;static PIECE_ALREADY_ON_BOARD=()=>$localize`That piece is already on the board.`;static CANNOT_GIVE_PIECE_IN_HAND=()=>$localize`You cannot give the piece that was in your hands.`})();class Nd{subCriterion=[h.empty(),h.empty(),h.empty(),h.empty()];constructor(e){this.subCriterion[0]=h.of(8==(8&e.value)),this.subCriterion[1]=h.of(4==(4&e.value)),this.subCriterion[2]=h.of(2==(2&e.value)),this.subCriterion[3]=h.of(1==(1&e.value))}mergeWith(e){let t=4;for(let n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=h.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}mergeWithQuartoPiece(e){const t=new Nd(e);return this.mergeWith(t)}areAllAbsent(){for(let e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}match(e){for(let t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}matchPiece(e){return this.match(new Nd(e))}toString(){return"Criterion{"+this.subCriterion.map(e=>e.isPresent()?e.get()?"1":"0":"x").join(" ")+"}"}}class r3{initialCoord;direction;constructor(e,t){this.initialCoord=e,this.direction=t}allCoords(){const e=[];for(let t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}class Ri extends wr{static singleton=h.empty();static get(){return Ri.singleton.isAbsent()&&(Ri.singleton=h.of(new Ri)),Ri.singleton.get()}getInitialState(){const e=it.create(4,4,ot.EMPTY);return new n3(e,0,ot.AAAA)}static lines=[new r3(new _(0,0),me.DOWN),new r3(new _(1,0),me.DOWN),new r3(new _(2,0),me.DOWN),new r3(new _(3,0),me.DOWN),new r3(new _(0,0),me.RIGHT),new r3(new _(0,1),me.RIGHT),new r3(new _(0,2),me.RIGHT),new r3(new _(0,3),me.RIGHT),new r3(new _(0,0),me.DOWN_RIGHT),new r3(new _(0,3),me.UP_RIGHT)];static isOccupied(e){return e!==ot.EMPTY}static isLegal(e,t){const n=e.coord.x,i=e.coord.y,o=e.piece,s=t.getCopiedBoard(),a=t.pieceInHand;return Ri.isOccupied(s[i][n])?A.failure(Me.MUST_LAND_ON_EMPTY_SPACE()):o===ot.EMPTY?15===t.turn?A.SUCCESS:A.failure(KI.MUST_GIVE_A_PIECE()):n3.isAlreadyOnBoard(o,s)?A.failure(KI.PIECE_ALREADY_ON_BOARD()):a===o?A.failure(KI.CANNOT_GIVE_PIECE_IN_HAND()):A.SUCCESS}isLegal(e,t){return Ri.isLegal(e,t)}applyLegalMove(e,t,n,i){const o=t.getCopiedBoard();return o[e.coord.y][e.coord.x]=t.pieceInHand,new n3(o,t.turn+1,e.piece)}static updateBoardStatus(e,t,n){return n.score===o1.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:o1.VICTORY,sensitiveSquares:new sr}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}static isThereAVictoriousLine(e,t){let n=e.initialCoord,i=t.getPieceAt(n);const o=new Nd(i);for(let s=0;s<3&&!1!==Ri.isOccupied(i)&&!o.areAllAbsent();s++)n=n.getNext(e.direction,1),i=t.getPieceAt(n),o.mergeWithQuartoPiece(i);return!(!Ri.isOccupied(i)||!1!==o.areAllAbsent())}static searchForVictoryOrPreVictoryInLine(e,t,n){const i=Ri.getLineInfos(e,t,n);if(i.boardStatus.isPresent())return i.boardStatus.get();const o=i.commonCriterion,s=i.sensitiveCoord;if(o.isPresent()&&!1===o.get().areAllAbsent()){if(s.isAbsent())return{score:o1.VICTORY,sensitiveSquares:new sr};{o.get().matchPiece(t.pieceInHand)&&(n.score=o1.PRE_VICTORY);const a=s.get();n.sensitiveSquares.add(a)}}return n}static getLineInfos(e,t,n){let i=h.empty(),o=h.empty(),s=e.initialCoord;for(let a=0;a<4;a++){const c=t.getPieceAt(s);if(c===ot.EMPTY){if(!i.isAbsent())return{sensitiveCoord:h.of(s),commonCriterion:o,boardStatus:h.of(n)};i=h.of(s)}else o.isAbsent()?(o=h.of(new Nd(c)),Ne.display("QuartoRules","getLineInfos","set commonCrit to "+o.toString())):(o.get().mergeWithQuartoPiece(c),Ne.display("QuartoRules","getLineInfos","update commonCrit: "+o.toString()));s=s.getNext(e.direction,1)}return{commonCriterion:o,sensitiveCoord:i,boardStatus:h.empty()}}static scoreToGameStatus(e,t){const n=O.of(t%2);return e===o1.VICTORY?ve.getDefeat(n):16===t?ve.DRAW:ve.ONGOING}getGameStatus(e){const t=e.gameState;let n={score:o1.DEFAULT,sensitiveSquares:new sr};for(const i of Ri.lines)if(n=Ri.updateBoardStatus(i,t,n),n.score===o1.VICTORY)return Ri.scoreToGameStatus(n.score,t.turn);return Ri.scoreToGameStatus(n.score,t.turn)}getVictoriousCoords(e){for(const t of Ri.lines)if(Ri.isThereAVictoriousLine(t,e))return t.allCoords();return[]}}class lVe extends Ha{scoreToBoardValue(e,t){if(e===o1.DEFAULT)return gn.of(0);{L.assert(e===o1.PRE_VICTORY,"QuartoHeuristic score can only be pre-victory or default");const n=O.of(t%2);return gn.of(n.getPreVictory())}}getBoardValue(e,t){const n=e.gameState;let i={score:o1.DEFAULT,sensitiveSquares:new sr};for(const o of Ri.lines)i=Ri.updateBoardStatus(o,n,i);return this.scoreToBoardValue(i.score,n.turn)}}class zJ extends Yn{getListMoves(e,t){const n=[],i=e.gameState,o=i.getCopiedBoard(),s=i.getRemainingPieces(),a=i.pieceInHand;let c;for(let l=0;l<4;l++)for(let u=0;u<4;u++)if(o[l][u]===ot.EMPTY){if(c=i.getCopiedBoard(),c[l][u]=a,15===i.turn){const f=new t3(u,l,ot.EMPTY);return n.push(f),n}for(const f of s){const g=new t3(u,l,f);n.push(g)}}return n}}function uVe(r,e){if(1&r&&(N(),V(0,"rect",13)),2&r){const t=p(2),n=t.$implicit,i=t.index,o=p().index,s=p();v("ngClass",s.getPieceClasses(n.value)),w("x",s.SPACE_SIZE*i+(s.SPACE_SIZE/2-s.getPieceSize(n.value)))("y",s.SPACE_SIZE*o+(s.SPACE_SIZE/2-s.getPieceSize(n.value)))("width",2*s.getPieceSize(n.value))("height",2*s.getPieceSize(n.value))}}function fVe(r,e){if(1&r&&(N(),V(0,"circle",13)),2&r){const t=p(2),n=t.$implicit,i=t.index,o=p().index,s=p();v("ngClass",s.getPieceClasses(n.value)),w("cx",s.SPACE_SIZE*i+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*o+s.SPACE_SIZE/2)("r",s.getPieceSize(n.value))}}function dVe(r,e){if(1&r&&(N(),V(0,"circle")),2&r){const t=p(2).index,n=p().index,i=p();w("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",10)}}function hVe(r,e){if(1&r&&(N(),M(0,"g"),z(1,uVe,1,5,"rect",11)(2,fVe,1,4,"ng-template",null,12,wn)(4,dVe,1,3,"circle",10),P()),2&r){const t=Pn(3),n=p().$implicit,i=p(2);m(),v("ngIf",n.isRectangle())("ngIfElse",t),m(3),v("ngIf",i.pieceHasDot(n.value))}}function gVe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"rect",9),W("click",function(){const o=te(t).index,s=p().index;return ne(p().chooseCoord(o,s))}),P(),z(2,hVe,5,3,"g",10),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();m(),Ce("id","chooseCoord_",n,"_",i,""),v("ngClass",o.getSquareClasses(n,i)),w("x",o.SPACE_SIZE*n)("y",o.SPACE_SIZE*i)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),m(),v("ngIf",t!==o.EMPTY)}}function pVe(r,e){if(1&r&&(N(),M(0,"g",null,8),z(2,gVe,3,8,"g",2),P()),2&r){const t=e.$implicit;m(2),v("ngForOf",t)}}function mVe(r,e){if(1&r&&(N(),V(0,"rect",18)),2&r){const t=p(2);v("ngClass",t.getPieceClasses(t.pieceInHand.value)),w("x",t.SPACE_SIZE/2-t.getPieceSize(t.pieceInHand.value))("y",t.SPACE_SIZE/2-t.getPieceSize(t.pieceInHand.value))("width",2*t.getPieceSize(t.pieceInHand.value))("height",2*t.getPieceSize(t.pieceInHand.value))}}function _Ve(r,e){if(1&r&&(N(),V(0,"circle",13)),2&r){const t=p(2);v("ngClass",t.getPieceClasses(t.pieceInHand.value)),w("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2)("r",t.getPieceSize(t.pieceInHand.value))}}function CVe(r,e){if(1&r&&(N(),V(0,"circle")),2&r){const t=p(2);w("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2)("r",10)}}function vVe(r,e){if(1&r){const t=de();N(),M(0,"g",14,15),W("click",function(){return te(t),ne(p().deselectDroppedPiece())}),V(2,"rect",16),z(3,mVe,1,5,"rect",17)(4,_Ve,1,4,"ng-template",null,12,wn)(6,CVe,1,3,"circle",10),P()}if(2&r){const t=Pn(5),n=p();Ce("id","droppedPiece_",n.chosen.get().x,"_",n.chosen.get().y,""),w("transform","translate("+n.chosen.get().x*n.SPACE_SIZE+" "+n.chosen.get().y*n.SPACE_SIZE+")"),m(2),w("width",n.SPACE_SIZE)("height",n.SPACE_SIZE),m(),v("ngIf",n.pieceInHand.isRectangle())("ngIfElse",t),m(3),v("ngIf",n.pieceHasDot(n.pieceInHand.value))}}function yVe(r,e){if(1&r&&(N(),M(0,"g",null,19),V(2,"rect",20),P()),2&r){const t=e.$implicit,n=p();m(2),w("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)("transform","translate("+t.x*n.SPACE_SIZE+" "+t.y*n.SPACE_SIZE+")")}}function MVe(r,e){if(1&r&&(N(),V(0,"rect",13)),2&r){const t=p(2);v("ngClass",t.getPieceClasses(t.pieceInHand.value)),w("x",0)("y",.75*t.SPACE_SIZE)("transform","translate("+-t.getPieceSize(t.pieceInHand.value)+", "+-t.getPieceSize(t.pieceInHand.value)+")")("width",2*t.getPieceSize(t.pieceInHand.value))("height",2*t.getPieceSize(t.pieceInHand.value))}}function EVe(r,e){if(1&r&&(N(),V(0,"circle",23)),2&r){const t=p(2);v("ngClass",t.getPieceClasses(t.pieceInHand.value)),w("cy",.75*t.SPACE_SIZE)("r",t.getPieceSize(t.pieceInHand.value))}}function PVe(r,e){1&r&&(N(),V(0,"circle",24)),2&r&&w("cy",.75*p(2).SPACE_SIZE)("r",10)}function SVe(r,e){if(1&r&&(N(),M(0,"g",21),z(1,MVe,1,6,"rect",11)(2,EVe,1,3,"ng-template",null,12,wn)(4,PVe,1,2,"circle",22),P()),2&r){const t=Pn(3),n=p();m(),v("ngIf",n.pieceInHand.isRectangle())("ngIfElse",t),m(3),v("ngIf",n.pieceHasDot(n.pieceInHand.value))}}function OVe(r,e){if(1&r&&(N(),V(0,"rect",29)),2&r){const t=p(2).index,n=p().index,i=p();En("id","chosenPiece_",4*n+t,""),w("x",i.SPACE_SIZE*t)("y",i.SPACE_SIZE*n)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function TVe(r,e){if(1&r&&(N(),V(0,"rect",13)),2&r){const t=p(2).index,n=p().index,i=p();v("ngClass",i.getPieceClasses(4*n+t)),w("x",i.SPACE_SIZE*t+i.SPACE_SIZE/2-i.getPieceSize(4*n+t))("y",i.SPACE_SIZE*n+i.SPACE_SIZE/2-i.getPieceSize(4*n+t))("width",2*i.getPieceSize(4*n+t))("height",2*i.getPieceSize(4*n+t))}}function AVe(r,e){if(1&r&&(N(),V(0,"circle",13)),2&r){const t=p(2).index,n=p().index,i=p();v("ngClass",i.getPieceClasses(4*n+t)),w("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",i.getPieceSize(4*n+t))}}function bVe(r,e){if(1&r&&(N(),V(0,"circle")),2&r){const t=p(2).index,n=p().index,i=p();w("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",10)}}function wVe(r,e){if(1&r){const t=de();N(),M(0,"g",14),W("click",function(){te(t);const i=p().index,o=p().index;return ne(p().choosePiece(4*o+i))}),z(1,OVe,1,5,"rect",28)(2,TVe,1,5,"rect",11)(3,AVe,1,4,"ng-template",null,12,wn)(5,bVe,1,3,"circle",10),P()}if(2&r){const t=Pn(4),n=p().index,i=p().index,o=p();En("id","choosePiece_",4*i+n,""),m(),v("ngIf",o.pieceToGive.equalsValue(o.QuartoPiece.ofInt(4*i+n))),m(),v("ngIf",(4*i+n)%4<2)("ngIfElse",t),m(3),v("ngIf",o.pieceHasDot(4*i+n))}}function NVe(r,e){if(1&r&&(N(),M(0,"g"),z(1,wVe,6,5,"g",3),P()),2&r){const t=e.index,n=p().index,i=p();m(),v("ngIf",i.isRemaining(4*n+t))}}function IVe(r,e){if(1&r&&(N(),M(0,"g",null,25),V(2,"rect",26,27),z(4,NVe,2,1,"g",2),P()),2&r){const t=e.$implicit,n=p();w("transform","translate(0 "+6.5*n.SPACE_SIZE+")"),m(2),w("x",-.125*n.SPACE_SIZE)("y",-.125*n.SPACE_SIZE)("width",4.25*n.SPACE_SIZE)("height",4.25*n.SPACE_SIZE),m(2),v("ngForOf",t)}}let kVe=(()=>{class r extends y2{EMPTY=ot.EMPTY;QuartoPiece=ot;chosen=h.empty();lastMove=h.empty();pieceInHand=ot.EMPTY;pieceToGive=h.empty();victoriousCoords=[];constructor(t){super(t),this.setRulesAndNode("Quarto"),this.availableAIs=[new cn($localize`Minimax`,this.rules,new lVe,new zJ),new kn($localize`MCTS`,new zJ,this.rules)],this.encoder=t3.encoder,this.pieceInHand=this.getState().pieceInHand}updateBoard(t){var n=this;return E(function*(){const i=n.getState();n.board=i.getCopiedBoard(),n.chosen=h.empty(),n.pieceInHand=i.pieceInHand,n.victoriousCoords=n.rules.getVictoriousCoords(i)})()}chooseCoord(t,n){var i=this;return E(function*(){const o=yield i.canUserPlay("#chooseCoord_"+t+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());if(i.hideLastMove(),i.board[n][t]===ot.EMPTY){if(i.showPieceInHandOnBoard(t,n),15===i.getState().turn){const s=new t3(t,n,ot.EMPTY);return i.chooseMove(s)}if(i.pieceToGive.isAbsent())return A.SUCCESS;{const s=new t3(t,n,i.pieceToGive.get());return i.chooseMove(s)}}return i.cancelMove(Me.MUST_CLICK_ON_EMPTY_SPACE())})()}choosePiece(t){var n=this;return E(function*(){const i=yield n.canUserPlay("#choosePiece_"+t);if(i.isFailure())return n.cancelMove(i.getReason());if(n.hideLastMove(),n.pieceToGive.equalsValue(ot.ofInt(t)))return n.cancelMoveAttempt(),A.SUCCESS;if(n.pieceToGive=h.of(ot.ofInt(t)),n.chosen.isAbsent())return A.SUCCESS;{const o=n.chosen.get(),s=new t3(o.x,o.y,n.pieceToGive.get());return n.chooseMove(s)}})()}showLastMove(t,n){var i=this;return E(function*(){i.lastMove=h.of(t.coord)})()}hideLastMove(){this.lastMove=h.empty()}cancelMoveAttempt(){this.hideLastMove(),this.pieceToGive=h.empty(),this.chosen=h.empty()}deselectDroppedPiece(){var t=this;return E(function*(){const n=t.chosen.getOrElse(new _(404,404)),i="#droppedPiece_"+n.x+"_"+n.y,o=yield t.canUserPlay(i);return o.isFailure()?t.cancelMove(o.getReason()):(t.cancelMoveAttempt(),A.SUCCESS)})()}showPieceInHandOnBoard(t,n){this.chosen=h.of(new _(t,n))}isRemaining(t){return n3.isGivable(ot.ofInt(t),this.board,this.pieceInHand)}getSquareClasses(t,n){const i=new _(t,n);return this.lastMove.equalsValue(i)?["moved-fill"]:[]}getPieceClasses(t){const n=[];return n.push(t%2==0?"player0-fill":"player1-fill"),n}getPieceSize(t){return t<8?40:25}pieceHasDot(t){return t!==ot.EMPTY.value&&t%8<4}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-quarto"]],features:[We],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],["id","pieceInHand",4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],[4,"ngIf"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","selected","x","0","y","0",1,"base","selected-stroke","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["id","pieceInHand"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected-stroke",3,"id",4,"ngIf"],[1,"base","selected-stroke",3,"id"]],template:function(n,i){1&n&&(N(),M(0,"svg",0)(1,"g",1),z(2,pVe,3,1,"g",2)(3,vVe,7,8,"g",3)(4,yVe,3,3,"g",2),M(5,"g",null,4),V(7,"rect",5,6),z(9,SVe,5,3,"g",7),P(),z(10,IVe,5,6,"g",2),P()()),2&n&&(w("viewBox","0 0 "+4.25*i.SPACE_SIZE+" "+10.75*i.SPACE_SIZE),m(2),v("ngForOf",i.board),m(),v("ngIf",i.chosen.isPresent()),m(),v("ngForOf",i.victoriousCoords),m(),w("transform","translate("+2*i.SPACE_SIZE+", "+4.5*i.SPACE_SIZE+")"),m(2),w("width",1.5*i.SPACE_SIZE)("height",1.5*i.SPACE_SIZE)("transform","translate("+-.75*i.SPACE_SIZE+", 0)"),m(2),v("ngIf",i.chosen.isAbsent()&&i.pieceInHand!==i.EMPTY),m(),v("ngForOf",i.board))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const RVe=ot.AABA,xVe=ot.AABB,DJ=ot.ABAA,LVe=ot.ABAB,zVe=ot.ABBA,VJ=ot.BAAA,DVe=ot.BAAB,VVe=ot.BABB,HJ=ot.BBAA,HVe=ot.BBAB,XI=ot.BBBA,FVe=ot.BBBB,n1=ot.EMPTY;class UVe extends Bn{tutorial=[q.informational($localize`Goal of the game`,$localize`Quarto is an alignment game.
        The goal is to align four pieces that have at least one common aspect:
        <ul>
          <li>their color (light or dark),</li>
          <li>their size (big or small),</li>
          <li>their pattern (empty or dotted),</li>
          <li>their shape (round or square).</li>
        </ul>
        Here, we have a board with a victory by an alignment of dark pieces.
        Note that the pieces are not owned by any player.`,new n3([[XI,HJ,DJ,RVe],[n1,n1,n1,n1],[n1,n1,n1,n1],[n1,n1,n1,n1]],7,ot.ABAB)),q.anyMove($localize`Placement`,$localize`Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,
        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.
        If you prefer, the order of these two steps can be reversed.
        Keep in mind that the second click confirms the move.<br/><br/>
        Make a move.`,new n3([[XI,xVe,zVe,n1],[n1,n1,n1,n1],[n1,VJ,n1,n1],[n1,n1,n1,n1]],7,ot.ABAA),new t3(2,2,ot.BAAB),$localize`Perfect!`),q.fromMove($localize`Situation`,$localize`We have here a tricky situation.<br/><br/>
        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move.`,new n3([[FVe,XI,HVe,n1],[DJ,VVe,HJ,n1],[LVe,VJ,DVe,n1],[n1,n1,n1,n1]],7,ot.AABA),[new t3(3,3,ot.AABB)],$localize`Well done!`,$localize`Failed! Your opponent can either align:<ul><li>the squares horizontally on the third line or vertically on the third column,</li><li>small pieces horizontally on the first line or vertically on the second or third column,</li><li>empty pieces horizontally on the first line or vertically on the first column,</li><li>clear pieces diagonally.</li></ul>`)]}class h0 extends Nr{direction;static encoder=ke.tuple([_.encoder,Ie.encoder],e=>[e.coord,e.direction],e=>new h0(e[0].x,e[0].y,e[1]));constructor(e,t,n){super(e,t),this.direction=n}toString(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}equals(e){return e===this||!1!==e.coord.equals(this.coord)&&e.direction===this.direction}}class Cu extends $1{applyLegalMove(e){const t=this.getCopiedBoard(),n=this.turn+1;let i=e.coord,o=e.coord.getNext(e.direction);for(;this.isOnBoard(o);)t[i.y][i.x]=t[o.y][o.x],i=i.getNext(e.direction),o=o.getNext(e.direction);return t[i.y][i.x]=this.getCurrentPlayer(),new Cu(t,n)}}let $Ve=(()=>class r{static NO_INSIDE_CLICK=()=>$localize`You must pick a space from the edge of the board.`})();class kl extends fn{add(e,t){const n=this.get(e).get();return this.put(e,n+t)}addOrSet(e,t){return this.containsKey(e)?this.add(e,t):(this.set(e,t),h.of(t))}}class Ji extends Da{static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new po({name:()=>$localize`Quixo`,config:{width:new g1(5,Wi.WIDTH,h1.range(1,99)),height:new g1(5,Wi.HEIGHT,h1.range(1,99))}});static QUIXO_HELPER=new o0(L.identity,5);static getVerticalCoords(e){const t=e.gameState.getCurrentOpponent(),n=[],i=e.gameState;for(let o=0;o<i.getHeight();o++)i.getPieceAtXY(0,o)!==t&&n.push(new _(0,o)),i.getPieceAtXY(i.getWidth()-1,o)!==t&&n.push(new _(i.getWidth()-1,o));return n}static getHorizontalCenterCoords(e){const t=e.gameState.getCurrentOpponent(),n=[],i=e.gameState;for(let o=1;o<i.getWidth()-1;o++)i.getPieceAtXY(o,0)!==t&&n.push(new _(o,0)),i.getPieceAtXY(o,i.getHeight()-1)!==t&&n.push(new _(o,i.getHeight()-1));return n}static getLinesSums(e){const t=J3.ofValues(new fn([{key:"columns",value:new kl},{key:"rows",value:new kl},{key:"ascendingDiagonal",value:new kl},{key:"descendingDiagonal",value:new kl}]),new fn([{key:"columns",value:new kl},{key:"rows",value:new kl},{key:"ascendingDiagonal",value:new kl},{key:"descendingDiagonal",value:new kl}]));for(const n of e.getCoordsAndContents()){const i=n.content,o=n.coord.x,s=n.coord.y;i.isPlayer()&&(t.get(i).get("columns").get().addOrSet(o,1),t.get(i).get("rows").get().addOrSet(s,1),t.get(i).get("ascendingDiagonal").get().addOrSet(o+s,1),t.get(i).get("descendingDiagonal").get().addOrSet(o-s,1))}return t}static getVictoriousCoords(e){return Ji.QUIXO_HELPER.getVictoriousCoord(e)}static getFullestLine(e){let t=e.get("columns").get().listValues();return t=t.concat(e.get("rows").get().listValues()),t=t.concat(e.get("ascendingDiagonal").get().listValues()),t=t.concat(e.get("descendingDiagonal").get().listValues()),Math.max(...t)}static get(){return Ji.singleton.isAbsent()&&(Ji.singleton=h.of(new Ji)),Ji.singleton.get()}getRulesConfigDescription(){return h.of(Ji.RULES_CONFIG_DESCRIPTION)}getInitialState(e){const t=it.create(e.get().width,e.get().height,B.NONE);return new Cu(t,0)}getPossibleDirections(e,t){const n=[];return 0!==t.x&&n.push(Ie.LEFT),0!==t.y&&n.push(Ie.UP),t.x!==e.getWidth()-1&&n.push(Ie.RIGHT),t.y!==e.getHeight()-1&&n.push(Ie.DOWN),n}isValidCoord(e,t){return L.assert(e.isOnBoard(t),"Invalid coord for QuixoMove: "+t.toString()+" is outside the board."),0!==t.x&&t.x!==e.getWidth()-1&&0!==t.y&&t.y!==e.getHeight()-1?A.failure($Ve.NO_INSIDE_CLICK()):A.SUCCESS}assertDirectionValidity(e,t){const n=e.coord.x,i=e.coord.y,o=e.direction;L.assert(n!==t.getWidth()-1||o!==Ie.RIGHT,"Invalid direction: pawn on the right side can't be moved to the right."),L.assert(i!==t.getHeight()-1||o!==Ie.DOWN,"Invalid direction: pawn on the bottom side can't be moved down."),L.assert(0!==n||o!==Ie.LEFT,"Invalid direction: pawn on the left side can't be moved to the left."),L.assert(0!==i||o!==Ie.UP,"Invalid direction: pawn on the top side can't be moved up.")}applyLegalMove(e,t,n,i){return t.applyLegalMove(e)}isLegal(e,t){const n=this.isValidCoord(t,e.coord);return n.isFailure()?n:(this.assertDirectionValidity(e,t),t.getPieceAt(e.coord)===t.getCurrentOpponent()?A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):A.SUCCESS)}getGameStatus(e){const t=e.gameState,i=Ji.QUIXO_HELPER.getVictoriousCoord(t).map(s=>t.getPieceAt(s)),o=new ct(i);return 0===o.size()?ve.ONGOING:1===o.size()?ve.getVictory(o.getAnyElement().get()):ve.getVictory(t.getCurrentPlayer())}}class FJ extends Yn{getListMoves(e,t){const n=e.gameState,i=[],o=Ji.getVerticalCoords(e),a=Ji.getHorizontalCenterCoords(e).concat(o);for(const c of a){const l=Ji.get().getPossibleDirections(n,c);for(const u of l){const f=new h0(c.x,c.y,u);i.push(f)}}return i}}class GVe extends or{getMetrics(e,t){const i=Ji.getLinesSums(e.gameState),o=Ji.getFullestLine(i.get(O.ZERO)),s=Ji.getFullestLine(i.get(O.ONE));return U1.ofSingle(o,s)}}function BVe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"circle",4),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onBoardClick(o,s))}),P()()}if(2&r){const t=e.index,n=p().index,i=p();m(),Ce("id","click_",t,"_",n,""),v("ngClass",i.getPieceClasses(t,n)),w("r",.45*i.SPACE_SIZE)("cx",(t+.5)*i.SPACE_SIZE)("cy",(n+.5)*i.SPACE_SIZE)}}function WVe(r,e){if(1&r&&(N(),M(0,"g"),z(1,BVe,2,6,"g",2),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function qVe(r,e){if(1&r){const t=de();N(),M(0,"use",6),W("click",function(){const o=te(t).$implicit;return ne(p(2).chooseDirection(o))}),P()}if(2&r){const t=e.$implicit,n=p(2);En("id","chooseDirection_",t,""),w("transform",n.getArrowTransform(t))}}function jVe(r,e){if(1&r&&(N(),M(0,"g"),z(1,qVe,1,2,"use",5),P()),2&r){const t=p();m(),v("ngForOf",t.getPossiblesDirections())}}let ZVe=(()=>{class r extends y2{QuixoState=Cu;state;lastMoveCoord=h.empty();chosenCoord=h.empty();chosenDirection;victoriousCoords=[];constructor(t){super(t),this.setRulesAndNode("Quixo"),this.availableAIs=[new cn($localize`Minimax`,this.rules,new GVe,new FJ),new kn($localize`MCTS`,new FJ,this.rules)],this.encoder=h0.encoder}showLastMove(t){var n=this;return E(function*(){n.lastMoveCoord=h.of(t.coord)})()}hideLastMove(){this.lastMoveCoord=h.empty()}updateBoard(t){var n=this;return E(function*(){n.state=n.getState(),n.board=n.state.board,n.victoriousCoords=Ji.getVictoriousCoords(n.state)})()}cancelMoveAttempt(){this.chosenCoord=h.empty()}getPieceClasses(t,n){const i=new _(t,n),s=[];return s.push(this.getPlayerClass(this.board[n][t])),this.chosenCoord.equalsValue(i)?s.push("selected-stroke"):this.lastMoveCoord.equalsValue(i)&&s.push("last-move-stroke"),this.victoriousCoords.some(a=>a.equals(i))&&s.push("victory-stroke"),s}onBoardClick(t,n){var i=this;return E(function*(){const o=yield i.canUserPlay("#click_"+t+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new _(t,n),a=i.getState(),c=i.rules.isValidCoord(a,s);return c.isFailure()?i.cancelMove(c.getReason()):i.board[n][t]===i.state.getCurrentOpponent()?i.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(i.chosenCoord.equalsValue(s)?i.cancelMoveAttempt():i.chosenCoord=h.of(s),A.SUCCESS)})()}getPossiblesDirections(){const t=[],n=this.chosenCoord.get(),i=this.getState();return n.x<i.getWidth()-1&&t.push(Ie.RIGHT),0<n.x&&t.push(Ie.LEFT),n.y<i.getHeight()-1&&t.push(Ie.DOWN),0<n.y&&t.push(Ie.UP),t}chooseDirection(t){var n=this;return E(function*(){const i=yield n.canUserPlay("#chooseDirection_"+t.toString());return i.isFailure()?n.cancelMove(i.getReason()):(n.chosenDirection=t,yield n.tryMove())})()}tryMove(){var t=this;return E(function*(){const n=t.chosenCoord.get(),i=new h0(n.x,n.y,t.chosenDirection);return t.chooseMove(i)})()}getArrowTransform(t){const n=this.getState(),i=n.getWidth()*this.SPACE_SIZE,o=n.getHeight()*this.SPACE_SIZE;return mke.getArrowTransform(i,o,t)}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-quixo"]],features:[We],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(n,i){1&n&&(N(),M(0,"svg",0)(1,"defs"),V(2,"polygon",1),P(),z(3,WVe,2,1,"g",2)(4,jVe,2,1,"g",3),P()),2&n&&(w("viewBox",i.getViewBox().toSVGString()),m(3),v("ngForOf",i.board),m(),v("ngIf",i.chosenCoord.isPresent()))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const w1=B.NONE,ca=B.ZERO,Ya=B.ONE,YVe=Ji.get().getDefaultRulesConfig();class KVe extends Bn{tutorial=[q.informational($localize`Goal of the game.`,$localize`At Quixo, the goal is to align 5 of your pieces.
        The first player plays with dark pieces, the second with light pieces.
        The board is made of 25 spaces spread over a 5x5 square.
        Every piece has a neutral side, a light side, and a dark side.`,Ji.get().getInitialState(YVe)),q.fromMove($localize`What a move looks like (without animation)`,$localize`When it is your turn:
        <ol>
            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.
                You can only choose a piece from the edge of the board.</li>
            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>
        </ol>
        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.
        Once on the other side, all pieces will move by one space in the opposing direction.
        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>
        For example, take the bottom right neutral piece, and move it to the left (you're playing Light).`,new Cu([[w1,w1,w1,w1,w1],[w1,w1,w1,w1,w1],[w1,w1,w1,w1,w1],[w1,w1,w1,w1,w1],[ca,ca,ca,ca,w1]],1),[new h0(4,4,Ie.LEFT)],$localize`See how the four dark pieces have been moved one space to the right.
        The neutral piece has been move 4 pieces to the left and has become light.`,pe.FAILED_TRY_AGAIN()),q.fromMove($localize`Victory`,$localize`You already know everything you need in order to play, but there is one last particularity.
        If you create a line of 5 of your pieces, you win.
        If you create a line of 5 of your opponent's pieces, you lose.
        If you create both, you lose too!<br/><br/>
        You can win with this board, try it.
        You're playing Light.`,new Cu([[w1,Ya,w1,Ya,Ya],[w1,ca,ca,w1,ca],[Ya,Ya,Ya,ca,Ya],[ca,w1,ca,Ya,Ya],[Ya,ca,w1,Ya,ca]],31),[new h0(3,0,Ie.DOWN)],pe.CONGRATULATIONS_YOU_WON(),pe.FAILED_TRY_AGAIN())]}class So extends Nr{static encoder=Nr.getEncoder(So.of);static PASS=new So(-1,-1);static of(e){return new So(e.x,e.y)}toString(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}class g0 extends $1{getNeighboringPawnLike(e,t){let n;const i=[];for(let o=-1;o<2;o++)for(let s=-1;s<2;s++)n=new _(t.x+s,t.y+o),this.isOnBoard(n)&&this.board[n.y][n.x]===e&&i.push(n);return i}countScore(){const e=we.of(0,0);for(const t of this.getCoordsAndContents()){const n=t.content;n.isPlayer()&&e.add(n,1)}return e}}let XVe=(()=>class r{static NO_ELEMENT_SWITCHED=()=>$localize`Your move should switch at least one piece.`})();var p0;class UJ{move;switched;constructor(e,t){this.move=e,this.switched=t}}let m0=class extends Da{static#e=p0=this;static singleton=h.empty();static get(){return p0.singleton.isAbsent()&&(p0.singleton=h.of(new p0)),p0.singleton.get()}static RULES_CONFIG_DESCRIPTION=new po({name:()=>$localize`Reversi`,config:{width:new g1(8,Wi.WIDTH,h1.range(3,99)),height:new g1(8,Wi.HEIGHT,h1.range(3,99))}});getRulesConfigDescription(){return h.of(p0.RULES_CONFIG_DESCRIPTION)}getInitialState(e){const t=e.get(),n=it.create(t.width,t.height,B.NONE),i=new _(Math.floor(t.width/2),Math.floor(t.height/2));return n[i.y-1][i.x-1]=O.ZERO,n[i.y][i.x]=O.ZERO,n[i.y-1][i.x]=O.ONE,n[i.y][i.x-1]=O.ONE,new g0(n,0)}applyLegalMove(e,t,n,i){const o=t.turn,s=t.getCurrentPlayer(),a=t.getCopiedBoard();if(e.equals(So.PASS))return new g0(a,o+1);for(const l of i)a[l.y][l.x]=s;return a[e.coord.y][e.coord.x]=s,new g0(a,o+1)}getAllSwitcheds(e,t,n){const i=[],o=t.getOpponent();for(const s of me.DIRECTIONS){const a=e.coord.getNext(s);if(n.isOnBoard(a)&&n.getPieceAt(a)===o){const c=this.getSandwicheds(t,s,a,n);for(const l of c)i.push(l)}}return i}getSandwicheds(e,t,n,i){const o=[n];let s=n.getNext(t);for(;i.isOnBoard(s);){const a=i.getPieceAt(s);if(a===e)return o;if(a===B.NONE)return[];o.push(s),s=s.getNext(t)}return[]}isGameEnded(e,t){return this.playerCanOnlyPass(e,t)&&this.nextPlayerCantOnlyPass(e,t)}getGameStatus(e,t){const n=e.gameState;if(!1===this.isGameEnded(n,t))return ve.ONGOING;const o=n.countScore(),s=o.get(O.ONE)-o.get(O.ZERO);return s<0?ve.ZERO_WON:s>0?ve.ONE_WON:ve.DRAW}playerCanOnlyPass(e,t){const n=this.getListMoves(e,t);return 1===n.length&&n[0].move.equals(So.PASS)}nextPlayerCantOnlyPass(e,t){const n=e.getCopiedBoard(),o=new g0(n,e.turn+1);return this.playerCanOnlyPass(o,t)}getListMoves(e,t){const n=[];let i;const o=e.getCurrentPlayer(),s=e.getCurrentOpponent();for(const a of e.getCoordsAndContents()){const c=a.coord;if(e.getPieceAt(c)===B.NONE&&(i=e.getCopiedBoard(),e.getNeighboringPawnLike(s,c).length>0)){const u=new So(c.x,c.y),f=this.getAllSwitcheds(u,o,e);if(f.length>0){for(const g of f)L.assert(o!==e.getPieceAt(g),g+"was already switched!"),i[g.y][g.x]=o;i[c.y][c.x]=o,n.push(new UJ(u,f.length))}}}return 0===n.length&&n.push(new UJ(So.PASS,0)),n}isLegal(e,t,n){if(e.equals(So.PASS))return this.playerCanOnlyPass(t,n)?X.success([]):X.failure(Me.CANNOT_PASS());if(t.getPieceAt(e.coord).isPlayer())return X.failure(Me.MUST_CLICK_ON_EMPTY_SPACE());const i=this.getAllSwitcheds(e,t.getCurrentPlayer(),t);return 0===i.length?X.failure(XVe.NO_ELEMENT_SWITCHED()):X.success(i)}};m0=p0=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],m0);class $J extends Yn{getListMoves(e,t){return m0.get().getListMoves(e.gameState,t).map(i=>i.move)}}class JVe extends or{getMetrics(e,t){const n=e.gameState,i=U1.of([0],[0]);for(const o of n.getCoordsAndContents()){const s=o.coord,a=o.content,u=(n.isVerticalEdge(s)?4:1)*(n.isHorizontalEdge(s)?4:1);a.isPlayer()&&i.add(a,0,u)}return i}}class eHe extends cn{constructor(){super($localize`Minimax`,m0.get(),new JVe,new $J)}}function tHe(r,e){if(1&r&&(N(),V(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();v("ngClass",i.getPieceClass(t,n)),w("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)}}function nHe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"rect",2),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),P(),z(2,tHe,1,4,"circle",3),P()}if(2&r){const t=e.index,n=p().index,i=p();m(),Ce("id","click_",t,"_",n,""),v("ngClass",i.getRectClasses(t,n)),w("x",i.SPACE_SIZE*t)("y",i.SPACE_SIZE*n)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),m(),v("ngIf",i.board[n][t]!==i.EMPTY)}}function rHe(r,e){if(1&r&&(N(),M(0,"g"),z(1,nHe,3,8,"g",1),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}let iHe=(()=>{class r extends y2{EMPTY=B.NONE;lastMove=h.empty();capturedCoords=[];constructor(t){super(t),this.setRulesAndNode("Reversi"),this.availableAIs=[new eHe,new kn($localize`MCTS`,new $J,this.rules)],this.encoder=So.encoder,this.scores=h.of(we.of(2,2))}onClick(t,n){var i=this;return E(function*(){const o=yield i.canUserPlay("#click_"+t+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new So(t,n);return yield i.chooseMove(s)})()}updateBoard(t){var n=this;return E(function*(){const i=n.getState();n.board=i.getCopiedBoard(),n.capturedCoords=[],n.scores=h.of(i.countScore()),n.canPass=n.rules.playerCanOnlyPass(i,n.config)})()}showLastMove(t){var n=this;return E(function*(){n.lastMove=h.of(t.coord);const i=n.getState().getCurrentPlayer(),o=n.getState().getCurrentOpponent();for(const s of me.DIRECTIONS){let a=t.coord.getNext(s,1);for(;n.getState().isOnBoard(a)&&n.getState().getPieceAt(a)===o&&n.getPreviousState().getPieceAt(a)===i;)n.capturedCoords.push(a),a=a.getNext(s,1)}})()}hideLastMove(){this.capturedCoords=[]}getRectClasses(t,n){const i=new _(t,n);return this.capturedCoords.some(o=>o.equals(i))?["captured-fill"]:this.lastMove.equalsValue(i)?["moved-fill"]:[]}getPieceClass(t,n){return this.getPlayerClass(this.board[n][t])}pass(){var t=this;return E(function*(){return L.assert(t.canPass,"ReversiComponent: pass() can only be called if canPass is true"),t.onClick(So.PASS.coord.x,So.PASS.coord.y)})()}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-reversi"]],features:[We],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(n,i){1&n&&(N(),M(0,"svg",0),z(1,rHe,2,1,"g",1),P()),2&n&&(w("viewBox",i.getViewBox().toSVGString()),m(),v("ngForOf",i.board))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const Mt=B.NONE,Et=B.ZERO,et=B.ONE,oHe=m0.get().getDefaultRulesConfig();class sHe extends Bn{tutorial=[q.informational($localize`Goal of the game`,$localize`At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.
        When one piece is flipped, its owner changes.
        The player owning the most pieces at the end of the game wins.
        Here, Dark has 28 points and Light has 36, hence Light wins.`,new g0([[Et,Et,Et,Et,Et,Et,Et,Et],[Et,et,et,et,et,et,et,Et],[Et,et,et,et,et,et,et,Et],[Et,et,et,et,et,et,et,Et],[Et,et,et,et,et,et,et,Et],[Et,et,et,et,et,et,et,Et],[Et,et,et,et,et,et,et,Et],[Et,Et,Et,Et,Et,Et,Et,Et]],60)),q.anyMove($localize`Captures (1/2)`,$localize`At the beginning of the game, pieces are placed as shown here.
        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>
        Do any move by clicking to put your piece
        Dark plays first.`,m0.get().getInitialState(oHe),new So(2,4),pe.CONGRATULATIONS()),q.fromMove($localize`Captures (2/2)`,$localize`A move can also capture a bigger line, and more than one line at a time<br/><br/>You're playing Light here. Play on the bottom left to see a capture.`,new g0([[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,et,Mt,Mt,Mt],[Mt,Mt,Mt,Et,Mt,Mt,Mt,Mt],[Mt,Mt,Et,Mt,Mt,Mt,Mt,Mt],[Et,Et,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Et,et,Et,et,Et,Mt,Mt]],1),[new So(0,7)],pe.CONGRATULATIONS(),$localize`Lower and more to the left, please.`),q.informational($localize`Passing a turn`,$localize`If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass
        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way.`,new g0([[et,Et,Et,Et,Et,Et,et,Et],[Et,et,et,et,et,et,et,Et],[Et,et,et,et,et,et,et,Et],[Et,et,et,et,et,et,et,Et],[Et,et,et,et,et,et,et,Et],[Et,et,et,et,et,et,et,Et],[et,et,et,et,et,et,Mt,Mt],[Et,Et,Et,Et,Et,Et,Mt,Mt]],60))]}let Rl=(()=>{class r extends s0{static HEIGHT=6;static WIDTH=11;static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}}return r})(),vu=(()=>class r{static CAN_ONLY_REBOUND_ON_BLACK=()=>$localize`You can only rebound on dark spaces.`;static CAN_ONLY_REBOUND_ON_EMPTY_SPACE=()=>$localize`You can only rebound on empty spaces.`;static MUST_CHOOSE_PYRAMID_FIRST=()=>$localize`You must pick one of your pyramids first.`;static MUST_CHOOSE_OWN_PYRAMID=()=>$localize`You must pick one of your pyramids.`;static THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=()=>$localize`Those two spaces are not neighbors.`;static THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=()=>$localize`Those two spaces have no intermediary neighbor.`})();class i3 extends Do{static encoder=q2.getFallibleEncoder(i3.from);static checkDistanceAndLocation(e,t){const n=e.getOrthogonalDistance(t);if(0===n)return A.failure(Me.MOVE_CANNOT_BE_STATIC());if(1===n){const i=Xs.getFakeNeighbors(e);if(t.equals(i))return A.failure(vu.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return A.failure($localize`You can move one or two spaces, not ${n}.`);if(Xs.isSpaceDark(e))return A.failure(vu.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return A.failure(vu.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return A.SUCCESS}static from(e,t){L.assert(Rl.isOnBoard(e),"Move must start inside the board not at "+e.toString()+"."),L.assert(Rl.isOnBoard(t),"Move must end inside the board not at "+t.toString()+".");const n=i3.checkDistanceAndLocation(e,t);return n.isFailure()?n.toOtherFallible():X.success(new i3(e,t))}constructor(e,t){super(e,t)}isSimpleStep(){return Math.abs(this.getStart().x-this.getEnd().x)+Math.abs(this.getStart().y-this.getEnd().y)===1}toString(){return"SaharaMove("+this.getStart()+"->"+this.getEnd()+")"}}var o3;let g4=class extends wr{static#e=o3=this;static singleton=h.empty();static get(){return o3.singleton.isAbsent()&&(o3.singleton=h.of(new o3)),o3.singleton.get()}getInitialState(){const e=Ee.UNREACHABLE,t=Ee.ZERO,n=Ee.ONE,i=Ee.EMPTY;return new Rl([[e,e,t,n,i,i,i,t,n,e,e],[e,i,i,i,i,i,i,i,i,i,e],[n,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,n],[e,i,i,i,i,i,i,i,i,i,e],[e,e,n,t,i,i,i,n,t,e,e]],0)}static getStartingCoords(e,t){const n=[];for(let i=0;i<Rl.HEIGHT;i++)for(let o=0;o<Rl.WIDTH;o++)e[i][o].is(t)&&n.push(new _(o,i));return n}static getBoardValuesFor(e,t){const n=o3.getStartingCoords(e,t),i=[];for(const o of n){const s=s0.getEmptyNeighbors(e,o,Ee.EMPTY).length;if(0===s)return[0,0,0,0,0,0];i.push(s)}return i.sort((o,s)=>o-s)}applyLegalMove(e,t,n,i){const o=t.getCopiedBoard();return o[e.getEnd().y][e.getEnd().x]=o[e.getStart().y][e.getStart().x],o[e.getStart().y][e.getStart().x]=Ee.EMPTY,new Rl(o,t.turn+1)}isLegal(e,t){if(!1===t.getPieceAt(e.getStart()).is(t.getCurrentPlayer()))return A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(t.getPieceAt(e.getEnd())!==Ee.EMPTY)return A.failure(Me.MUST_LAND_ON_EMPTY_SPACE());const o=Xs.getCommonNeighbor(e.getStart(),e.getEnd());return o.isPresent()?t.getPieceAt(o.get())===Ee.EMPTY?A.SUCCESS:A.failure(vu.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):A.SUCCESS}getGameStatus(e){const t=e.gameState.getCopiedBoard(),n=o3.getBoardValuesFor(t,O.ZERO),i=o3.getBoardValuesFor(t,O.ONE);return o3.getGameStatusFromFreedoms(n,i)}getLandingCoords(e,t){const n=o=>Rl.isOnBoard(o)&&e[o.y][o.x]===Ee.EMPTY,i=new ct(Xs.getNeighbors(t).filter(n));if(!0===Xs.isSpaceDark(t))return i.toList();{const o=new ct(i.toList());for(const s of i){const a=Xs.getNeighbors(s).filter(n);for(const c of a)o.add(c)}return o.toList()}}static getGameStatusFromFreedoms(e,t){return 0===e[0]?ve.ONE_WON:0===t[0]?ve.ZERO_WON:ve.ONGOING}};g4=o3=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],g4);class cHe extends or{getMetrics(e,t){const n=e.gameState.board,i=g4.getBoardValuesFor(n,O.ZERO),o=g4.getBoardValuesFor(n,O.ONE);return U1.of(i,o)}}class GJ extends Yn{getListMoves(e,t){const n=[],i=e.gameState.getCopiedBoard(),o=e.gameState.getCurrentPlayer(),s=g4.getStartingCoords(i,o);for(const a of s){const c=s0.getEmptyNeighbors(i,a,Ee.EMPTY);for(const l of c){const u=i3.from(a,l).get();if(i[l.y][l.x]=i[a.y][a.x],i[a.y][a.x]=Ee.EMPTY,n.push(u),(l.y+l.x)%2==0){const g=s0.getEmptyNeighbors(i,l,Ee.EMPTY);for(const y of g)if(!1===y.equals(a)){const S=i3.from(a,y).get();i[y.y][y.x]=i[l.y][l.x],i[l.y][l.x]=Ee.EMPTY,n.push(S),i[l.y][l.x]=i[y.y][y.x],i[y.y][y.x]=Ee.EMPTY}}i[a.y][a.x]=i[l.y][l.x],i[l.y][l.x]=Ee.EMPTY}}return n}}function lHe(r,e){if(1&r&&(N(),M(0,"g"),V(1,"polygon",7),P()),2&r){const t=p(2).index,n=p().index,i=p();m(),Ce("id","pyramid_",t,"_",n,""),v("ngClass",i.getPlayerClassFor(t,n)),w("points",i.getPyramidPoints(t,n))}}function uHe(r,e){if(1&r&&(N(),V(0,"polygon",10)),2&r){const t=p(3).index,n=p().index,i=p();Ce("id","triangle_",t,"_",n,""),w("points",i.getTrianglePoints(t,n))}}function fHe(r,e){if(1&r&&(N(),V(0,"polygon",11)),2&r){const t=p(3).index,n=p().index,i=p();Ce("id","triangle_",t,"_",n,""),w("points",i.getTrianglePoints(t,n))}}function dHe(r,e){if(1&r&&(N(),M(0,"g"),z(1,uHe,1,3,"polygon",8)(2,fHe,1,3,"polygon",9),P()),2&r){const t=p(2).index,n=p().index;m(),v("ngIf",(t+n)%2==1),m(),v("ngIf",(t+n)%2==0)}}function hHe(r,e){if(1&r&&(N(),M(0,"g"),z(1,lHe,2,4,"g",6)(2,dHe,3,2,"g",6),P()),2&r){const t=p().$implicit;m(),v("ngIf",t.isPlayer()),m(),v("ngIf",!1===t.isPlayer())}}function gHe(r,e){if(1&r){const t=de();N(),M(0,"g",5),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),z(1,hHe,3,2,"g",6),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();Ce("id","click_",n,"_",i,""),w("transform",o.getTriangleTranslation(n,i)),m(),v("ngIf",t.isReachable())}}function pHe(r,e){if(1&r&&(N(),M(0,"g"),z(1,gHe,2,4,"g",4),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function mHe(r,e){if(1&r&&(N(),V(0,"polygon",14)),2&r){const t=e.$implicit,n=p(2);Ce("id","possible_landing_",t.x,"_",t.y,""),w("points",n.getTrianglePoints(t.x,t.y))("transform",n.getTriangleTranslation(t.x,t.y))}}function _He(r,e){if(1&r&&(N(),V(0,"polygon",14)),2&r){const t=p(2);Ce("id","chosen_coord_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),w("points",t.getTrianglePoints(t.chosenCoord.get().x,t.chosenCoord.get().y))("transform",t.getTriangleTranslation(t.chosenCoord.get().x,t.chosenCoord.get().y))}}function CHe(r,e){if(1&r&&(N(),jt(0),z(1,mHe,1,4,"polygon",12)(2,_He,1,4,"polygon",13),Zt()),2&r){const t=p();m(),v("ngForOf",t.possibleLandings),m(),v("ngIf",t.chosenCoord.isPresent())}}function vHe(r,e){if(1&r&&(N(),jt(0),V(1,"polygon",15)(2,"polygon",15),Zt()),2&r){const t=p(2);m(),w("points",t.getTrianglePoints(t.lastCoord.get().x,t.lastCoord.get().y))("transform",t.getTriangleTranslation(t.lastCoord.get().x,t.lastCoord.get().y)),m(),w("points",t.getTrianglePoints(t.lastMoved.get().x,t.lastMoved.get().y))("transform",t.getTriangleTranslation(t.lastMoved.get().x,t.lastMoved.get().y))}}function yHe(r,e){1&r&&(N(),z(0,vHe,3,4,"ng-container",6)),2&r&&v("ngIf",p().lastMoved.isPresent())}let MHe=(()=>{class r extends jQ{lastCoord=h.empty();lastMoved=h.empty();chosenCoord=h.empty();possibleLandings=[];constructor(t){super(t),this.setRulesAndNode("Sahara"),this.availableAIs=[new cn($localize`Minimax`,this.rules,new cHe,new GJ),new kn($localize`MCTS`,new GJ,this.rules)],this.encoder=i3.encoder}showLastMove(t){var n=this;return E(function*(){n.lastCoord=h.of(t.getStart()),n.lastMoved=h.of(t.getEnd())})()}hideLastMove(){this.lastCoord=h.empty(),this.lastMoved=h.empty()}cancelMoveAttempt(){this.possibleLandings=[],this.chosenCoord=h.empty()}onClick(t,n){var i=this;return E(function*(){const o=yield i.canUserPlay("#click_"+t+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=i.getState().getCurrentPlayer(),a=Ee.ofPlayer(s);return i.chosenCoord.equalsValue(new _(t,n))?(i.cancelMoveAttempt(),A.SUCCESS):i.chosenCoord.isAbsent()||i.board[n][t]===a?i.choosePiece(t,n):i.chooseLandingCoord(t,n)})()}choosePiece(t,n){var i=this;return E(function*(){if(i.board[n][t]===Ee.EMPTY)return i.cancelMove(vu.MUST_CHOOSE_PYRAMID_FIRST());if(i.board[n][t].is(O.ofTurn(i.getTurn()))){const o=new _(t,n);return i.selectPiece(o),A.SUCCESS}return i.cancelMove(vu.MUST_CHOOSE_OWN_PYRAMID())})()}selectPiece(t){this.chosenCoord=h.of(t),this.possibleLandings=this.rules.getLandingCoords(this.board,t)}chooseLandingCoord(t,n){var i=this;return E(function*(){const o=new _(t,n),s=i3.from(i.chosenCoord.get(),o);return s.isFailure()?i.cancelMove(s.getReason()):yield i.chooseMove(s.get())})()}updateBoard(t){var n=this;return E(function*(){n.board=n.getState().board,console.table(it.map(n.board,i=>i.isPlayer()))})()}getPlayerClassFor(t,n){return this.getPlayerClass(this.board[n][t].getPlayer())}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-sahara"]],features:[We],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-3 -3 606 606","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass"],["class","base mid-stroke",3,"id",4,"ngIf"],["class","base mid-stroke background2",3,"id",4,"ngIf"],[1,"base","mid-stroke",3,"id"],[1,"base","mid-stroke","background2",3,"id"],["class","base no-fill mid-stroke selected-stroke",3,"id",4,"ngFor","ngForOf"],["class","base no-fill mid-stroke selected-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","mid-stroke","selected-stroke",3,"id"],[1,"base","no-fill","mid-stroke","moved-stroke"]],template:function(n,i){if(1&n&&(N(),M(0,"svg",0),z(1,pHe,2,1,"g",1)(2,CHe,3,2,"ng-container",2)(3,yHe,1,1,"ng-template",null,3,wn),P()),2&n){const o=Pn(4);m(),v("ngForOf",i.board),m(),v("ngIf",i.chosenCoord.isPresent())("ngIfElse",o)}},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const la=Ee.UNREACHABLE,yu=Ee.ZERO,Mu=Ee.ONE,ln=Ee.EMPTY;class EHe extends Bn{tutorial=[q.informational($localize`Initial board`,$localize`Shr is played on a board where each space is a triangle.
        Each player has six pyramids.`,g4.get().getInitialState()),q.informational($localize`Goal of the game`,$localize`At Shr, the goal of the game is to immobilize one of the opponent's pyramids.
        To do so, you have to occupy all neighboring space of that pyramid.
        Here, Light has lost because its leftmost pyramid is immobilized.`,new Rl([[la,la,ln,ln,Mu,ln,ln,yu,Mu,la,la],[la,ln,ln,ln,ln,ln,ln,ln,ln,ln,la],[Mu,yu,ln,ln,ln,ln,ln,ln,ln,ln,yu],[yu,ln,ln,ln,ln,ln,ln,ln,ln,ln,Mu],[la,ln,ln,ln,ln,ln,ln,ln,ln,ln,la],[la,la,Mu,yu,ln,ln,ln,Mu,yu,la,la]],3)),q.fromPredicate($localize`Simple step`,$localize`To immobilize your opponent, you have to move your pyramids.
        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).
        To perform a move:
        <ol>
            <li>Click on one of your pyramids.</li>
            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>
        </ol><br/>
        You're playing Dark, do any simple step.`,g4.get().getInitialState(),i3.from(new _(2,0),new _(2,1)).get(),(e,t,n)=>e.isSimpleStep()?A.SUCCESS:A.failure($localize`You have made a double step, which is good but it is the next exercise!`),pe.CONGRATULATIONS()),q.fromPredicate($localize`Double step`,$localize`When a pyramid shares its vertices with dark spaces, it can move one or two steps.
        To do so:
        <ol>
            <li>Click on the pyramid to move.</li>
            <li>Click on one of the 6 destinations that you can reach in two steps:
                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.
        </ol><br/>
        You're playing Dark, do a double step.`,g4.get().getInitialState(),i3.from(new _(7,0),new _(5,0)).get(),(e,t,n)=>e.isSimpleStep()?A.failure($localize`Failed! You have made a single step.`):A.SUCCESS,pe.CONGRATULATIONS())]}class Os extends Nr{x;y;direction;landingOrientation;static encoder=ke.tuple([ke.identity(),ke.identity(),h.getEncoder(Ie.encoder),Ie.encoder],e=>[e.x,e.y,e.direction,e.landingOrientation],e=>Os.of(e[0],e[1],e[2],e[3]));constructor(e,t,n,i){super(e,t),this.x=e,this.y=t,this.direction=n,this.landingOrientation=i}static of(e,t,n,i){return new Os(e,t,n,i)}isRotation(){return this.direction.isAbsent()}equals(e){return this===e||!1!==this.coord.equals(e.coord)&&!1!==this.direction.equals(e.direction)&&this.landingOrientation===e.landingOrientation}toString(){const e=this.direction.isAbsent()?"-":this.direction.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}}class xl extends $1{countCurrentPlayerPawn(){const e=this.getCurrentPlayer();return this.countPlayersPawn().get(e)}countPlayersPawn(){const e=we.of(0,0);for(const t of this.getCoordsAndContents())t.content.getOwner().isPlayer()&&e.add(t.content.getOwner(),1);return e}}class rt{value;owner;direction;static EMPTY=new rt(0,B.NONE,h.empty());static LIGHT_UP=new rt(1,B.ONE,h.of(Ie.UP));static LIGHT_RIGHT=new rt(2,B.ONE,h.of(Ie.RIGHT));static LIGHT_DOWN=new rt(3,B.ONE,h.of(Ie.DOWN));static LIGHT_LEFT=new rt(4,B.ONE,h.of(Ie.LEFT));static DARK_UP=new rt(5,B.ZERO,h.of(Ie.UP));static DARK_RIGHT=new rt(6,B.ZERO,h.of(Ie.RIGHT));static DARK_DOWN=new rt(7,B.ZERO,h.of(Ie.DOWN));static DARK_LEFT=new rt(8,B.ZERO,h.of(Ie.LEFT));static MOUNTAIN=new rt(9,B.NONE,h.empty());static decode(e){switch(e){case 0:return rt.EMPTY;case 1:return rt.LIGHT_UP;case 2:return rt.LIGHT_RIGHT;case 3:return rt.LIGHT_DOWN;case 4:return rt.LIGHT_LEFT;case 5:return rt.DARK_UP;case 6:return rt.DARK_RIGHT;case 7:return rt.DARK_DOWN;case 8:return rt.DARK_LEFT;case 9:return rt.MOUNTAIN}}static of(e,t){return t===O.ZERO?e===Ie.UP?rt.DARK_UP:e===Ie.RIGHT?rt.DARK_RIGHT:e===Ie.DOWN?rt.DARK_DOWN:rt.DARK_LEFT:e===Ie.UP?rt.LIGHT_UP:e===Ie.RIGHT?rt.LIGHT_RIGHT:e===Ie.DOWN?rt.LIGHT_DOWN:rt.LIGHT_LEFT}constructor(e,t,n){this.value=e,this.owner=t,this.direction=n}belongsTo(e){return this.owner.equals(e)}isEmptyOrMountain(){return this.owner===B.NONE}isPiece(){return!1===this.isEmptyOrMountain()}getOwner(){return this.owner}getOptionalDirection(){return this.direction}getDirection(){return this.getOptionalDirection().get()}toString(){switch(this){case rt.EMPTY:return"EMPTY";case rt.LIGHT_UP:return"LIGHT_UP";case rt.LIGHT_RIGHT:return"LIGHT_RIGHT";case rt.LIGHT_DOWN:return"LIGHT_DOWN";case rt.LIGHT_LEFT:return"LIGHT_LEFT";case rt.DARK_UP:return"DARK_UP";case rt.DARK_RIGHT:return"DARK_RIGHT";case rt.DARK_DOWN:return"DARK_DOWN";case rt.DARK_LEFT:return"DARK_LEFT";default:return L.expectToBe(this,rt.MOUNTAIN),"MOUNTAIN"}}}let Eu=(()=>class r{static NO_REMAINING_PIECE_TO_INSERT=()=>$localize`You cannot insert a piece, all your pieces are already on the board.`;static NOT_ENOUGH_FORCE_TO_PUSH=()=>$localize`You do not have enough strength to push.`;static MUST_MOVE_OR_ROTATE=()=>$localize`You must move or rotate your piece.`;static ILLEGAL_PUSH=()=>$localize`Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board.`;static MUST_SELECT_VALID_DESTINATION=()=>$localize`You must select a valid destination (highlighted on the board) for your piece`;static MUST_SELECT_ORIENTATION=()=>$localize`You should select the orientation of your piece by clicking on one of the arrows.`})();var _0;class BJ{resultingBoard;moved;constructor(e,t){this.resultingBoard=e,this.moved=t}}let Q2=class extends Da{static#e=_0=this;static singleton=h.empty();static get(){return _0.singleton.isAbsent()&&(_0.singleton=h.of(new _0)),_0.singleton.get()}static RULES_CONFIG_DESCRIPTION=new po({name:()=>$localize`Siam`,config:{width:new g1(5,Wi.WIDTH,h1.range(3,99)),height:new g1(5,Wi.HEIGHT,h1.range(3,99)),numberOfPiece:new g1(5,()=>$localize`Number of piece by player`,h1.range(1,99)),numberOfBonusMountain:new g1(2,()=>$localize`Number of bonus mountains`,h1.range(0,98))}});getRulesConfigDescription(){return h.of(_0.RULES_CONFIG_DESCRIPTION)}getInitialState(e){const t=e.get(),n=it.create(t.width,t.height,rt.EMPTY),i=Math.floor(t.height/2),o=Math.floor(t.width/2);n[i][o]=rt.MOUNTAIN,t.numberOfBonusMountain=Math.min(t.numberOfBonusMountain,t.width-1);let s=0;for(;s<t.numberOfBonusMountain;){const a=Math.ceil((s+1)/2);n[i][o+a]=rt.MOUNTAIN,s++,s<t.numberOfBonusMountain&&(n[i][o-a]=rt.MOUNTAIN,s++)}return new xl(n,0)}getMoveValidity(e,t){const n=!1===t.isOnBoard(e.coord);if(e.isRotation()){if(n)return X.failure($localize`Cannot rotate piece outside the board: ${e.toString()}`)}else if(!1===t.isOnBoard(e.coord.getNext(e.direction.get()))){if(n)return X.failure($localize`SiamMove should end or start on the board: ${e.toString()}`);if(e.direction.get()!==e.landingOrientation)return X.failure($localize`SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: ${e.toString()}`)}return A.SUCCESS}isInsertion(e,t){return-1===e.coord.x||e.coord.x===t.getWidth()||-1===e.coord.y||e.coord.y===t.getHeight()}isLegal(e,t,n){const i=this.getMoveValidity(e,t);if(i.isFailure())return i.toOtherFallible();if(!1===this.isInsertion(e,t)){const o=t.getPieceAt(e.coord);if(o===rt.EMPTY)return X.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(o.belongsTo(t.getCurrentOpponent()))return X.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())}if(e.isRotation())return this.isLegalRotation(e,t);{let o;if(this.isInsertion(e,t)){const s=this.isLegalInsertion(e.coord,t,n.get());if(s.legal.isFailure())return X.failure(s.legal.getReason());o=s.insertedPiece}else o=t.getPieceAt(e.coord);return this.isLegalForwarding(e,t,o)}}isLegalInsertion(e,t,n){const i=t.countCurrentPlayerPawn(),o=t.getCurrentPlayer(),s=i<n.numberOfPiece?A.SUCCESS:A.failure(Eu.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:this.getInsertedPiece(e,o,t.getWidth()),legal:s}}getInsertedPiece(e,t,n){return rt.of(-1===e.x?Ie.RIGHT:-1===e.y?Ie.DOWN:e.x===n?Ie.LEFT:Ie.UP,t)}isLegalForwarding(e,t,n){L.assert(n!==rt.MOUNTAIN&&n!==rt.EMPTY,"forwarding must be done with player piece");const i=[];let o=rt.of(e.landingOrientation,t.getCurrentPlayer());const s=e.direction.get();let a=e.coord.getNext(s);if(t.isOnBoard(a)&&t.getPieceAt(a)!==rt.EMPTY&&!1===this.isStraight(n,e))return X.failure(Eu.ILLEGAL_PUSH());let c=h.of(s);const l=s.getOpposite();let u=0;const f=t.getCopiedBoard();t.isOnBoard(e.coord)&&(f[e.coord.y][e.coord.x]=rt.EMPTY,i.push(e.coord));let g=t.isOnBoard(a)&&o!==rt.EMPTY;for(;g;){c.equalsValue(s)?u++:c.equalsValue(l)&&u--;const y=f[a.y][a.x];y===rt.MOUNTAIN&&(u-=.9),f[a.y][a.x]=o,i.push(a),o=y,a=a.getNext(s),c=o.getOptionalDirection(),g=t.isOnBoard(a)&&o!==rt.EMPTY&&u>0}return!1===t.isOnBoard(a)&&(c.equalsValue(s)?u++:c.equalsValue(l)&&u--),u<=0?X.failure(Eu.NOT_ENOUGH_FORCE_TO_PUSH()):X.success(new BJ(f,i))}isStraight(e,t){const n=e.getDirection();return t.direction.equalsValue(n)&&n===t.landingOrientation}isLegalRotation(e,t){const n=e.coord,i=t.getPieceAt(n),o=t.getCurrentPlayer();if(i.getDirection()===e.landingOrientation)return X.failure(Eu.MUST_MOVE_OR_ROTATE());const s=t.getCopiedBoard();return s[n.y][n.x]=rt.of(e.landingOrientation,o),X.success(new BJ(s,[n]))}applyLegalMove(e,t,n,i){const o=it.copy(i.resultingBoard);return new xl(o,t.turn+1)}getScoreFromShortestDistances(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);const i=6-e,o=6-t;return i===o?n.getScoreModifier():i>o?-10*(i+1)+(o+1):10*(o+1)-(i+1)}getMountainsRowsAndColumns(e){const t=[],n=[];let i=0;for(const o of e.getCoordsAndContents())o.content===rt.MOUNTAIN&&(!1===t.includes(o.coord.y)&&t.push(o.coord.y),!1===n.includes(o.coord.x)&&n.push(o.coord.x),i++);return{rows:t,columns:n,nbMountain:i}}getWinner(e,t,n,i){return n===i.numberOfBonusMountain?this.getPusher(e,t.get()):B.NONE}getPusher(e,t){const n=t.coord;let i;i=e.isOnBoard(n)?e.getPieceAt(n.getNext(t.landingOrientation)):this.getInsertedPiece(n,e.getCurrentOpponent(),e.getWidth());const o=i.getDirection(),s=this.getPusherCoord(e,o,n),a=e.getPieceAt(s).getOwner();return Ne.display("SiamRules","getPusher",n.toString()+" belong to "+e.getCurrentOpponent().getValue()+", "+s.toString()+" belong to "+a.getValue()+", "+a.getValue()+" win"),a}getPusherCoord(e,t,n){let i=n.getNext(t),o=n;for(;e.isOnBoard(i);){n=i,i=i.getNext(t);const s=e.getPieceAt(n);s!==rt.MOUNTAIN&&s.getDirection()===t&&(o=n)}return o}getPushers(e,t,n,i){let o=[];const s=[];for(const a of t){let c=Ie.DOWN,l=new _(a,i.height-1);s.push({direction:c,fallingCoord:l}),c=Ie.UP,l=new _(a,0),s.push({direction:c,fallingCoord:l})}for(const a of n){let c=Ie.LEFT,l=new _(0,a);s.push({direction:c,fallingCoord:l}),c=Ie.RIGHT,l=new _(i.width-1,a),s.push({direction:c,fallingCoord:l})}for(const a of s)o=this.addPotentialDirectionPusher(e,a.fallingCoord,a.direction,o,i);return o}addPotentialDirectionPusher(e,t,n,i,o){const s=this.getLineClosestPusher(e,t,n,o);if(s.isAbsent())return i;const a=s.get();return i.push({coord:a.coord,distance:a.distance}),i}getInitialLineInfo(e,t,n){return{resistance:n.getOpposite(),previousPiece:e.getPieceAt(t),closestPusher:{coord:t,distance:1},almostPusher:h.empty(),pusherFound:!1,mountainEncountered:!1,missingForce:0}}getLineClosestPusher(e,t,n,i){let o=this.getInitialLineInfo(e,t,n);for(;e.isOnBoard(o.closestPusher.coord)&&!1===o.pusherFound;)o=this.updateLineInfo(e,o,n);if(!1===o.pusherFound&&o.almostPusher.isPresent())for(o.closestPusher.distance++,o.missingForce-=1;!1===o.closestPusher.coord.equals(o.almostPusher.get());)o.closestPusher.coord=o.closestPusher.coord.getNext(n),o.closestPusher.distance--;return!1===e.isOnBoard(o.closestPusher.coord)&&(o.missingForce-=1,e.countCurrentPlayerPawn()===i.numberOfPiece)||o.missingForce>0?h.empty():h.of(o.closestPusher)}updateLineInfo(e,t,n){const i=e.getPieceAt(t.closestPusher.coord);if(i.isEmptyOrMountain())i===rt.MOUNTAIN?(t.missingForce+=.9,t.mountainEncountered=!0):t.closestPusher.distance++;else{const o=i.getDirection();o===n?t.mountainEncountered&&(t.missingForce-=1,t.missingForce<=0&&(t.pusherFound=!0,t.closestPusher.coord=t.closestPusher.coord.getNext(n))):o===t.resistance?(t.missingForce+=1,!1===t.mountainEncountered&&t.closestPusher.distance++):t.mountainEncountered?(t.almostPusher=h.of(t.closestPusher.coord),t.previousPiece!==rt.EMPTY&&t.closestPusher.distance++):t.closestPusher.distance++}return t.previousPiece=i,t.closestPusher.coord=t.closestPusher.coord.getPrevious(n),t}getInsertions(e,t){let n=[];const i=t.width-1,o=t.height-1;for(let s=1;s<i;s++)n=n.concat(this.getInsertionsAt(e,s,0,t)),n=n.concat(this.getInsertionsAt(e,s,o,t));for(let s=1;s<o;s++)n=n.concat(this.getInsertionsAt(e,0,s,t)),n=n.concat(this.getInsertionsAt(e,i,s,t));return n=n.concat(this.getInsertionsAt(e,0,0,t)),n=n.concat(this.getInsertionsAt(e,0,o,t)),n=n.concat(this.getInsertionsAt(e,i,0,t)),n=n.concat(this.getInsertionsAt(e,i,o,t)),n}getInsertionsAt(e,t,n,i){const o=[];for(const s of Ie.ORTHOGONALS){const a=new _(t,n).getPrevious(s);if(!1===e.isOnBoard(a))for(const c of Ie.ORTHOGONALS){const l=Os.of(a.x,a.y,h.of(s),c);L.assert(this.getMoveValidity(l,e).isSuccess(),"SiamRules.getInsertionsAt should only construct valid insertions"),this.isLegal(l,e,h.of(i)).isSuccess()&&o.push(l)}}return o}getMovesFrom(e,t,n,i){const o=new _(n,i);let s=this.getRotationMovesAt(o,t);for(const a of Ie.ORTHOGONALS){const c=o.getNext(a);s=s.concat(this.getForwardMovesBetween(e,o,c))}return s}getMovesBetween(e,t,n,i){return n.equals(i)?this.getRotationMovesAt(n,t):Ie.factory.fromMove(n,i).isSuccess()&&1===n.getDistance(i)?this.getForwardMovesBetween(e,n,i):[]}getRotationMovesAt(e,t){const n=[],i=t.getDirection();for(const o of Ie.ORTHOGONALS)if(o!==i){const s=Os.of(e.x,e.y,h.empty(),o);n.push(s)}return n}getForwardMovesBetween(e,t,n){const i=[];let o;const s=Ie.factory.fromMove(t,n).get(),a=e.getPieceAt(t);o=e.isOnBoard(n)?Ie.ORTHOGONALS:[s];for(const c of o){const l=Os.of(t.x,t.y,h.of(s),c);this.isLegalForwarding(l,e,a).isSuccess()&&i.push(l)}return i}getGameStatus(e,t){const n=this.getMountainsRowsAndColumns(e.gameState),i=this.getWinner(e.gameState,e.previousMove,n.nbMountain,t.get());return i.isPlayer()?ve.getVictory(i):ve.ONGOING}};Q2=_0=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],Q2);class WJ extends Yn{getListMoves(e,t){let n=[];const i=e.gameState.getCurrentPlayer();for(const o of e.gameState.getCoordsAndContents()){const s=o.content;s.belongsTo(i)&&(n=n.concat(Q2.get().getMovesFrom(e.gameState,s,o.coord.x,o.coord.y)))}if(e.gameState.countCurrentPlayerPawn()<t.get().numberOfPiece)for(const o of Q2.get().getInsertions(e.gameState,t.get()))if(o.direction.get().getOpposite()!==o.landingOrientation){if(e.gameState.isEdge(o.coord)&&o.direction.get()!==o.landingOrientation)continue;n.push(o)}return n}}class SHe extends Ha{getBoardValue(e,t){const n=this.getBoardValueInfo(e.gameState,t.get());return gn.of(n.boardValue)}getBoardValueInfo(e,t){const n=Q2.get().getMountainsRowsAndColumns(e),i=n.rows,o=n.columns,s=Q2.get().getPushers(e,o,i,t);let a=Number.MAX_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER;const l=e.getCurrentPlayer();for(const f of s)e.isOnBoard(f.coord)?e.getPieceAt(f.coord).belongsTo(O.ZERO)?a=Math.min(a,f.distance):c=Math.min(c,f.distance):l===O.ZERO?a=Math.min(a,f.distance):c=Math.min(c,f.distance);return{shortestZero:a,shortestOne:c,boardValue:Q2.get().getScoreFromShortestDistances(a,c,l)}}}class OHe extends cn{constructor(){super($localize`Minimax`,Q2.get(),new SHe,new WJ)}}function AHe(r,e){if(1&r){const t=de();N(),M(0,"use",11),W("click",function(){te(t);const i=p().index,o=p().index;return ne(p().clickSquare(i,o))}),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();Ce("id","piece_",n,"_",o,""),v("ngClass",s.getPieceClasses(n,o,i)),w("transform",s.getPiceRotation(n,o))}}function bHe(r,e){if(1&r){const t=de();N(),M(0,"use",12),W("click",function(){te(t);const i=p().index,o=p().index;return ne(p().clickSquare(i,o))}),P()}}function wHe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"rect",8),W("click",function(){const o=te(t).index,s=p().index;return ne(p().clickSquare(o,s))}),P(),z(2,AHe,1,4,"use",9)(3,bHe,1,0,"use",10),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();w("transform","translate("+n*o.SPACE_SIZE+" "+i*o.SPACE_SIZE+")"),m(),Ce("id","square_",n,"_",i,""),v("ngClass",o.getSquareClasses(n,i)),w("x",o.SPACE_SIZE*n*0)("y",o.SPACE_SIZE*i*0)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),m(),v("ngIf",t.isPiece()),m(),v("ngIf",o.isMountain(t))}}function NHe(r,e){if(1&r&&(N(),M(0,"g"),z(1,wHe,4,10,"g",4),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function IHe(r,e){if(1&r){const t=de();N(),M(0,"rect",15),W("click",function(){te(t);const i=p().$implicit;return ne(p().clickSquare(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p();Ce("id","square_",t.x,"_",t.y,""),v("ngClass",n.getSquareClasses(t.x,t.y)),w("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function kHe(r,e){if(1&r){const t=de();N(),M(0,"g"),z(1,IHe,1,7,"rect",13),M(2,"rect",14),W("click",function(){const o=te(t).$implicit;return ne(p().clickSquare(o.x,o.y))}),P()()}if(2&r){const t=e.$implicit,n=p();m(),v("ngIf",!1===n.getState().isOnBoard(t)),m(),w("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function RHe(r,e){if(1&r){const t=de();N(),M(0,"rect",16),W("click",function(){te(t);const i=p();return ne(i.clickSquare(i.selectedLanding.get().x,i.selectedLanding.get().y))}),P()}if(2&r){const t=p();w("x",t.SPACE_SIZE*t.selectedLanding.get().x)("y",t.SPACE_SIZE*t.selectedLanding.get().y)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function xHe(r,e){if(1&r){const t=de();N(),M(0,"rect",16),W("click",function(){te(t);const i=p();return ne(i.clickSquare(i.selectedPiece.get().x,i.selectedPiece.get().y))}),P()}if(2&r){const t=p();w("x",t.SPACE_SIZE*t.selectedPiece.get().x)("y",t.SPACE_SIZE*t.selectedPiece.get().y)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function LHe(r,e){if(1&r&&(N(),V(0,"use",19)),2&r){const t=e.$implicit,n=p().$implicit,i=p();Ce("id","remainingPieces_",n.getValue(),"_",t,""),v("ngClass",i.getRemainingPieceClasses(n,t)),w("transform",i.getRemainingPieceTransform(t,n))}}function zHe(r,e){if(1&r){const t=de();N(),M(0,"g",17),W("click",function(){const o=te(t).$implicit;return ne(p().selectPieceForInsertion(o))}),z(1,LHe,1,4,"use",18),P()}if(2&r){const t=e.$implicit,n=p();En("id","remainingPieces_",t.getValue(),""),m(),v("ngForOf",n.ArrayUtils.range(n.playerPieces(t)))}}function DHe(r,e){if(1&r){const t=de();N(),M(0,"use",22),W("click",function(){te(t);const i=p().$implicit;return ne(p().clickSquare(i.source.get().coord.x,i.source.get().coord.y))}),P()}if(2&r){const t=p().$implicit,n=p();v("ngClass",n.getPieceClasses(t.source.get().coord.x,t.source.get().coord.y,t.source.get().piece)),w("transform",n.getPieceTransform(t.source.get().coord.x,t.source.get().coord.y))}}function VHe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"use",20),W("click",function(){const o=te(t).$implicit;return ne(p().clickArrow(o))}),P(),z(2,DHe,1,2,"use",21),P()}if(2&r){const t=e.$implicit,n=p();m(),Hr("id","indicator_",t.target.x,"_",t.target.y,"_",t.direction.toString(),""),w("transform",n.getIndicatorTransform(t)),m(),v("ngIf",t.source.isPresent())}}let ev=class CR extends y2{SiamState=xl;lastMove=h.empty();movedPieces=[];selectedPiece=h.empty();selectedLanding=h.empty();orientations=[];clickableCoords=new ct;indicatorArrows=[];insertingPiece=!1;constructor(e){super(e),this.setRulesAndNode("Siam"),this.availableAIs=[new OHe,new kn($localize`MCTS`,new WJ,this.rules)],this.encoder=Os.encoder}getViewBox(){return super.getViewBox().expand(0,0,this.SPACE_SIZE,this.SPACE_SIZE)}updateBoard(e){var t=this;return E(function*(){const n=t.getState();t.board=n.board})()}showLastMove(e){var t=this;return E(function*(){t.lastMove=h.of(e);const n=t.getPreviousState(),i=t.getConfig();t.movedPieces=t.rules.isLegal(t.lastMove.get(),n,i).get().moved})()}hideLastMove(){this.lastMove=h.empty(),this.movedPieces=[]}cancelMoveAttempt(){this.insertingPiece=!1,this.selectedPiece=h.empty(),this.selectedLanding=h.empty(),this.orientations=[],this.clickableCoords=new ct,this.indicatorArrows=[]}selectPieceForInsertion(e){var t=this;return E(function*(){const n=yield t.canUserPlay("#remainingPieces_"+e.getValue());if(n.isFailure())return t.cancelMove(n.getReason());if(e===t.getCurrentOpponent())return t.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());if(t.insertingPiece)return t.cancelMoveAttempt(),A.SUCCESS;t.cancelMoveAttempt();const i=t.getConfig().get();for(const o of Q2.get().getInsertions(t.getState(),i)){const s=o.coord.getNext(o.direction.get());if(t.board[s.y][s.x]!==rt.EMPTY){const a={source:h.empty(),target:s,direction:o.direction.get(),move:o};t.indicatorArrows.push(a)}t.clickableCoords.add(s)}return t.insertingPiece=!0,A.SUCCESS})()}selectOrientation(e){var t=this;return E(function*(){const n=yield t.canUserPlay("#orientation_"+e.landingOrientation.toString());return n.isFailure()?t.cancelMove(n.getReason()):t.chooseMove(e)})()}clickSquare(e,t,n=!0){var i=this;return E(function*(){if(n){const s=yield i.canUserPlay("#square_"+e+"_"+t);if(s.isFailure())return i.cancelMove(s.getReason())}const o=new _(e,t);if(i.insertingPiece)return i.insertPiece(o);if(i.selectedLanding.isPresent())return i.cancelMoveAttempt(),A.SUCCESS;if(i.selectedPiece.isPresent()){i.selectedLanding=h.of(o);const s=Q2.get().getMovesBetween(i.getState(),i.getState().getPieceAt(i.selectedPiece.get()),i.selectedPiece.get(),o);return 0===s.length?i.changeMoveDestinationClick(o):i.performMoveOrShowOrientationArrows(s)}{L.assert(i.getState().isOnBoard(o),"SiamComponent: user clicked outside of board when it should not be possible");const s=i.board[t][e];return s.getOwner()===B.NONE?i.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):s.getOwner()!==i.getCurrentPlayer()?i.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):i.selectPiece(o,s)}})()}insertPiece(e){var t=this;return E(function*(){if(t.selectedLanding.isPresent())return yield t.cancelMove(Eu.MUST_SELECT_ORIENTATION()),A.SUCCESS;t.selectedLanding=h.of(e);const n=t.getConfig().get(),i=Q2.get().getInsertionsAt(t.getState(),e.x,e.y,n);return 0===i.length?t.changeMoveDestinationClick(e):t.performMoveOrShowOrientationArrows(i)})()}changeMoveDestinationClick(e){var t=this;return E(function*(){return t.cancelMoveAttempt(),t.getState().getPieceAt(e).getOwner()===t.getCurrentPlayer()?t.clickSquare(e.x,e.y,!1):t.cancelMove(Eu.MUST_SELECT_VALID_DESTINATION())})()}performMoveOrShowOrientationArrows(e){var t=this;return E(function*(){return L.assert(e.length>0,"SiamComponent.performMoveOrShowOrientationArrows expects at least one move"),1===e.length?t.chooseMove(e[0]):(t.clickableCoords=new ct,t.indicatorArrows=[],t.orientations=e,A.SUCCESS)})()}selectPiece(e,t){this.cancelMoveAttempt();const n=this.getState();this.selectedPiece=h.of(e);const i=Q2.get().getMovesFrom(n,t,e.x,e.y);for(const o of i)if(o.direction.isPresent()){const s=o.coord.getNext(o.direction.get());if(this.clickableCoords.add(s),n.isOnBoard(s)&&n.getPieceAt(s)!==rt.EMPTY){const a={source:h.of({coord:e,piece:t}),target:s,direction:o.direction.get(),move:o};this.indicatorArrows.push(a)}}else this.clickableCoords.add(o.coord);return A.SUCCESS}clickArrow(e){var t=this;return E(function*(){const n=yield t.canUserPlay("#indicator_"+e.target.x+"_"+e.target.y+"_"+e.move.landingOrientation);return n.isFailure()?t.cancelMove(n.getReason()):t.chooseMove(e.move)})()}isMountain(e){return e===rt.MOUNTAIN}getArrowTransform(e,t,n){const i=n.toInt()-2,o=this.getRotation(i);return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",o].join(" ")}getRotation(e){return`rotate(${90*e} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`}getPiceRotation(e,t){const i=this.board[t][e].getDirection().toInt()-2;return this.getRotation(i)}getPieceTransform(e,t){return this.getArrowTransform(e,t,this.board[t][e].getDirection())}getIndicatorTransform(e){const t=e.target.getPrevious(e.direction,.5);return this.getArrowTransform(t.x,t.y,e.direction)}getRemainingPieceTransform(e,t){const n=this.getConfig().get(),i=n.width/2,s=this.getState().countPlayersPawn().get(t),c=1+.5*(n.numberOfPiece-s-1);let l,u,f;return t===this.getPointOfView()?(l=i-c/2+.5*e,u=n.height,f=Ie.LEFT):(l=i+c/2-1-.5*e,u=-1,f=Ie.RIGHT),this.getArrowTransform(l,u,f)}getPieceClasses(e,t,n){const i=new _(e,t),o=[this.getPlayerClass(n.getOwner())];return this.selectedPiece.equalsValue(i)&&o.push("selected-stroke"),o}getSquareClasses(e,t){const n=new _(e,t);return this.movedPieces.some(i=>i.equals(n))?["moved-fill"]:[]}getRemainingPieceClasses(e,t){const n=[this.getPlayerClass(e)];return this.insertingPiece&&this.getCurrentPlayer()===e&&t===this.playerPieces(e)-1&&n.push("selected-stroke"),n}playerPieces(e){return this.getConfig().get().numberOfPiece-this.getState().countPlayersPawn().get(e)}static \u0275fac=function(t){return new(t||CR)(G(Ut))};static \u0275cmp=$e({type:CR,selectors:[["app-siam"]],features:[We],decls:12,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],["id","siamBoard"],[4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["app-siam-orientation-arrow","",3,"orientations","currentPlayer","config","moveEmitter"],[1,"base",3,"id","ngClass","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngIf"],[0,"xlink","href","#mountain","class","nonplayer-fill",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],[0,"xlink","href","#mountain",1,"nonplayer-fill",3,"click"],["class","base semi-transparent",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke","clickable-stroke",3,"click"],[1,"base","semi-transparent",3,"id","ngClass","click"],[1,"base","no-fill","small-stroke","selected-stroke",3,"click"],[3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass"],[0,"xlink","href","#arrow",1,"base","mid-stroke","indicator-fill",3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"ngClass","click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"ngClass","click"]],template:function(t,n){1&t&&(N(),M(0,"svg",0)(1,"defs"),V(2,"polygon",1)(3,"polygon",2),P(),M(4,"g",3),z(5,NHe,2,1,"g",4),P(),z(6,kHe,3,5,"g",4)(7,RHe,1,4,"rect",5)(8,xHe,1,4,"rect",5)(9,zHe,2,2,"g",6)(10,VHe,3,5,"g",4),M(11,"g",7),W("moveEmitter",function(o){return n.selectOrientation(o)}),P()()),2&t&&(w("viewBox",n.getViewBox().toSVGString()),m(5),v("ngForOf",n.board),m(),v("ngForOf",n.clickableCoords),m(),v("ngIf",n.selectedLanding.isPresent()),m(),v("ngIf",n.selectedPiece.isPresent()),m(),v("ngForOf",n.Player.PLAYERS),m(),v("ngForOf",n.indicatorArrows),m(),v("orientations",n.orientations)("currentPlayer",n.getCurrentPlayer())("config",n.getConfig().get()))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})};ev=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],ev);const ze=rt.EMPTY,Ts=rt.MOUNTAIN,HHe=rt.LIGHT_UP,QI=rt.LIGHT_LEFT,qJ=rt.LIGHT_RIGHT,FHe=rt.LIGHT_DOWN,JI=rt.DARK_UP,jJ=rt.DARK_LEFT,Pu=rt.DARK_RIGHT,UHe=rt.DARK_DOWN,ZJ=Q2.get().getDefaultRulesConfig();class $He extends Bn{tutorial=[q.informational($localize`Goal of the game`,$localize`The goal at Siam is to be the first to push a mountain out of the board. The initial board contains three mountains, and no pieces are initially on the board. During its turn, a player can do one of the following actions:<ol><li>Put a new piece on the board.</li><li>Change the orientation of one of its piece</li><li>Move one of its piece and optionally reorient it.</li><li>Take one of its pieces out of the board.</li></ol>`,Q2.get().getInitialState(ZJ)),q.anyMove($localize`Inserting a piece`,$localize`Each player has 5 pieces in total. As long as you have remaining pieces next to the board, you can insert new pieces. To do so:<ol><li>Click on one of your pieces from your reserve, next to board.</li><li>Click on one of the highlighted squares to select a landing for your piece.</li><li>Select an orientation for your piece by clicking on one of the arrows that appear on top of the board.</li></ol><br/>You're playing Dark, insert a piece on the board.`,Q2.get().getInitialState(ZJ),Os.of(2,-1,h.of(Ie.DOWN),Ie.DOWN),pe.CONGRATULATIONS()),q.fromMove($localize`Moving a piece`,$localize`We will distinguish here "moving" and "pushing". A move is made from a piece's square to an empty neighboring square, horizontally or vertically. You can also move a piece out of the board. To move a piece:<ol><li>Click on it.</li><li>Click on the square on which you want the piece to move. You can also click a second time on your piece to change its orientation without moving it.</li><li>Select the orientation of your piece by clicking one one of the arrows that appear on top of the board.</li></ol><br/>You're playing Dark. Try to move your piece that is already on the board one square upwards and to orient it to the left.`,new xl([[ze,ze,ze,ze,ze],[ze,ze,ze,ze,ze],[ze,Ts,Ts,Ts,ze],[ze,ze,ze,ze,ze],[ze,ze,JI,ze,ze]],0),[Os.of(2,4,h.of(Ie.UP),Ie.LEFT)],$localize`Congratulations, you made a side-slip!`,pe.FAILED_TRY_AGAIN()),q.fromMove($localize`Moving a piece out of the board`,$localize`To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/> You're playing Dark, get that piece out of the board!`,new xl([[ze,ze,ze,ze,ze],[ze,ze,ze,ze,ze],[ze,Ts,Ts,Ts,ze],[ze,ze,ze,ze,ze],[ze,ze,JI,ze,ze]],0),[Os.of(2,4,h.of(Ie.DOWN),Ie.DOWN)],$localize`Congratulations, even if in this context it was not a useful move.`,$localize`Failed, the piece is still on the board.`),q.fromMove($localize`Pushing (1/2)`,$localize`When the landing square of your move is occupied, we use the term "push". In order to push player pieces, the following conditions must hold:<ol><li>Your piece must already be oriented in the direction of the push.</li><li>Along the line that you are pushing, the number of pieces (yours or your opponent's) that are oriented in the same way as the push should be strictly greater than the number of pieces oriented in the opposite way.</li></ol>Look closely at the board. On the first row, you cannot push as there is exactly one piece in the opposite direction. On the second row, you can push because there are two pieces against one.<br/><br/>You're playing Dark. Vertically, you can push using your piece in the center, as there is no resistance on that axis. Do it.`,new xl([[ze,Pu,QI,ze,ze],[Pu,qJ,QI,ze,ze],[ze,ze,JI,ze,ze],[ze,ze,ze,ze,ze],[ze,ze,ze,ze,ze]],0),[Os.of(2,2,h.of(Ie.UP),Ie.UP)],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),q.fromMove($localize`Pushing (2/2)`,$localize`To be able to push a mountain, you need at least one pusher per mountain. Each resistant (pieces in the opposite way) cancel the force of one pusher. In short, if there is no mountain, you need strictly more pushers than resistants. If there is a mountain, you need at least as much pushers than there are resistants and mountains. On the following board, as Dark, you can push the mountain on the first row. On the second and third row, because of the resisting forces, you cannot push. On the fourth row, you can push as there is one more pusher than resistant pieces.<br/><br/>You're playing Dark, push on the fourth row it.`,new xl([[ze,ze,Pu,Ts,ze],[ze,ze,Pu,Ts,jJ],[ze,Pu,Ts,Ts,ze],[ze,Pu,qJ,QI,Ts],[ze,ze,ze,ze,ze]],0),[Os.of(1,3,h.of(Ie.RIGHT),Ie.RIGHT)],$localize`Congratulations! Note that this move made you lose the game, you will see why in the next step.`,pe.FAILED_TRY_AGAIN()),q.fromMove($localize`Victory`,$localize`The game ends when a mountain is pushed out of the board. If you pushed it and nobody is in front of you, you're the winner. However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain. However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>Here, playing Dark, you can push a mountain off the board and either win, or lose. Choose correctly!`,new xl([[ze,ze,ze,ze,ze],[ze,ze,ze,ze,ze],[Ts,HHe,jJ,ze,UHe],[ze,ze,ze,ze,FHe],[ze,ze,ze,ze,Ts]],0),[Os.of(2,2,h.of(Ie.LEFT),Ie.LEFT)],pe.CONGRATULATIONS_YOU_WON(),$localize`Failed, you lost.`)]}class Lr extends C2{start;landing;keep;static encoder=ke.tuple([h.getEncoder(_.encoder),_.encoder,h.getEncoder(_.encoder)],e=>[e.start,e.landing,e.keep],e=>Lr.of(e[0],e[1],e[2]));static of(e,t,n){return new Lr(e,t,n)}static ofDrop(e){return new Lr(h.empty(),e,h.empty())}static ofMovement(e,t){return new Lr(h.of(e),t,h.empty())}static ofCut(e,t,n){return new Lr(h.of(e),t,h.of(n))}constructor(e,t,n){super(),this.start=e,this.landing=t,this.keep=n,L.assert(!1===e.equalsValue(t),"Deplacement cannot be static!"),L.assert(e.isAbsent()||!1===e.equals(n),"Cannot keep starting coord, since it will always be empty after move!")}isDrop(){return this.start.isAbsent()}isCut(){return this.keep.isPresent()}toString(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}equals(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}let Ka=(()=>class r{static NO_MOVEMENT_BEFORE_TURN_40=()=>$localize`You cannot move yet. Pick a space where you will put a new piece.`;static MUST_CUT=()=>$localize`Several groups are of the same size, you must pick the one to keep.`;static CANNOT_CHOOSE_TO_KEEP=()=>$localize`You cannot choose which part to keep when one is smaller than the other.`;static CAN_NO_LONGER_DROP=()=>$localize`You cannot put new pieces anymore. Pick a piece to move.`;static MUST_CAPTURE_BIGGEST_GROUPS=()=>$localize`You must choose one of the biggest groups to keep it.`;static CANNOT_KEEP_EMPTY_COORD=()=>$localize`You cannot pick an empty space. Pick one of the biggest groups.`;static MUST_DROP_NEXT_TO_OTHER_PIECE=()=>$localize`You must put this piece next to another piece.`})();class Bo extends gJ{static ofRepresentation(e,t,n=new $t(0,0)){const i=new Q5;for(let o=0;o<e.length;o++)for(let s=0;s<e[0].length;s++)if(e[o][s]!==B.NONE){const a=new _(s,o).getNext(n);i.set(a,e[o][s])}return new Bo(i,t)}movePiece(e){const t=this.pieces.getCopy();return t.delete(e.start.get()),t.set(e.landing,this.getCurrentPlayer()),new Bo(t,this.turn)}toRepresentation(){const e=it.create(this.width,this.height,B.NONE);for(const t of this.pieces.listKeys()){const n=this.getPieceAt(t);e[t.y][t.x]=n}return e}isIllegalLandingZone(e,t){return this.pieces.containsKey(e)?A.failure(Me.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?A.SUCCESS:A.failure(Ka.MUST_DROP_NEXT_TO_OTHER_PIECE())}isCoordConnected(e,t){for(const n of bi.getNeighbors(e))if(this.pieces.containsKey(n)&&!1===t.equalsValue(n))return!0;return!1}getPieceAt(e){return this.isOnBoard(e)?this.pieces.get(e).get():B.NONE}applyLegalDrop(e){const t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new Bo(t,this.turn+1)}applyLegalDeplacement(e,t){const n=this.movePiece(e);if(t.size()>0){const i=new Q5;for(const o of t)i.set(o,n.getPieceAt(o));return new Bo(i,this.turn+1)}return new Bo(n.pieces,this.turn+1)}countPieces(){const e=this.pieces.reverse(),t=e.get(O.ZERO).getOrElse(new sr),n=e.get(O.ONE).getOrElse(new sr);return we.of(t.size(),n.size())}switchPiece(e){const t=this.pieces.getCopy(),n=this.getPieceAt(e);if(n.isPlayer())return t.replace(e,n.getOpponent()),new Bo(t,this.turn);Gi.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:e.toString()})}equals(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}var Ll;let s3=class extends wr{static#e=Ll=this;static singleton=h.empty();currentVictorySource;static get(){return Ll.singleton.isAbsent()&&(Ll.singleton=h.of(new Ll)),Ll.singleton.get()}getInitialState(){return Bo.ofRepresentation([[O.ZERO],[O.ONE]],0)}applyLegalMove(e,t,n,i){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,i)}isLegal(e,t){const n=t.isIllegalLandingZone(e.landing,e.start);return n.isFailure()?n.toOtherFallible():t.turn<40?this.isLegalDrop(e,t):Ll.isLegalPhaseTwoMove(e,t)}static getLegalLandings(e){const t=new sr;for(const n of e.getPieceCoords())for(const i of Se.factory.all){const o=n.getNext(i,1);e.getPieceAt(o)===B.NONE&&t.add(o)}return t.toList()}isLegalDrop(e,t){return!1===e.isDrop()?X.failure(Ka.NO_MOVEMENT_BEFORE_TURN_40()):X.success(new ct(t.getPieceCoords()))}static isLegalPhaseTwoMove(e,t){if(e.isDrop())return X.failure(Ka.CAN_NO_LONGER_DROP());const n=t.getPieceAt(e.start.get());if(n===B.NONE)return X.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===t.getCurrentOpponent())return X.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT());const i=t.movePiece(e),o=i.getGroups();if(Ll.isSplit(o)){const s=this.getLargestGroups(o);return 1===s.size()?e.keep.isPresent()?X.failure(Ka.CANNOT_CHOOSE_TO_KEEP()):X.success(s.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,s,i)}return X.success(new sr)}static isSplit(e){return e.size()>1}static getLargestGroups(e){let t=0,n=new ct;for(const i of e){const o=i.size();o>t?(t=o,n=new ct([i])):o===t&&n.add(i)}return n}static moveKeepBiggerGroup(e,t,n){if(e.isAbsent())return X.failure(Ka.MUST_CUT());if(n.getPieces().get(e.get()).isAbsent())return X.failure(Ka.CANNOT_KEEP_EMPTY_COORD());const i=e.get();for(const o of t)if(o.contains(i))return X.success(o);return X.failure(Ka.MUST_CAPTURE_BIGGEST_GROUPS())}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();let i=[];if(e.previousMove.isPresent()&&(i=this.getShapeVictory(e.previousMove.get(),t)),6===i.length)return ve.getVictory(n);if(t.turn>39){const o=t.countPieces(),s=o.get(O.ZERO),a=o.get(O.ONE);return s<6&&a<6?s<a?ve.ONE_WON:a<s?ve.ZERO_WON:ve.DRAW:s<6?ve.getDefeat(O.ZERO):a<6?ve.getDefeat(O.ONE):ve.ONGOING}return ve.ONGOING}startSearchingVictorySources(){this.currentVictorySource={typeSource:"LINE",index:-1}}getShapeVictory(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();const n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let t;switch(this.currentVictorySource.typeSource){case"LINE":t="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":t="TRIANGLE_EDGE";break;default:t="CIRCLE"}this.currentVictorySource={typeSource:t,index:0}}else{let t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const i=t.landing;switch(e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,i,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,i,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,i,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,i,n)}}searchVictoryOnlyForCircle(e,t,n){const i=n.getCurrentOpponent(),s=[t];let a=t.getNext(Se.factory.all[e],1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return[];const l=(e+s.length)%6;s.push(a),a=a.getNext(Se.factory.all[l],1)}return s}searchVictoryOnlyForLine(e,t,n){const i=n.getCurrentOpponent();let o=Se.factory.all[e],s=t.getNext(o,1);const a=[t];let c=!1;for(;a.length<6;){if(n.getPieceAt(s)===i)a.push(s);else{if(c)return[];c=!0,o=o.getOpposite(),s=s.getNext(o,a.length)}s=s.getNext(o,1)}return a}searchVictoryOnlyForTriangleCorner(e,t,n){const i=n.getCurrentOpponent();let o=Se.factory.all[e];const s=[t];let a=t.getNext(o,1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return[];s.length%2==0&&(o=Se.factory.all[(e+s.length)%6]),s.push(a),a=a.getNext(o,1)}return s}searchVictoryOnlyForTriangleEdge(e,t,n){const i=n.getCurrentOpponent();let o=Se.factory.all[e];const s=[t];let a=t.getNext(o,1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return[];s.push(a),s.length%2==0&&(o=Se.factory.all[(e+s.length)%6]),a=a.getNext(o,1)}return s}};s3=Ll=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],s3);class BHe extends Ha{calculateBoardValue(e,t){this.startSearchingVictorySources();const n={status:o1.DEFAULT,victory:h.empty(),preVictory:h.empty(),sum:0};for(;this.hasNextVictorySource();){const i=this.getNextVictorySource();let o;if(o=n.status===o1.PRE_VICTORY?this.searchVictoryOnly(i,e,t):this.getBoardInfo(i,e,t,n),o.status===o1.VICTORY)return o;n.status=o.status,n.sum=n.sum+o.sum,n.preVictory.isAbsent()&&(n.preVictory=o.preVictory)}return n}}class YJ extends BHe{VERBOSE=!1;currentVictorySource;getBoardValue(e,t){const n=e.previousMove,i=e.gameState,o=i.getCurrentOpponent(),s=o.getVictoryValue();let a={status:o1.DEFAULT,victory:h.empty(),preVictory:h.empty(),sum:0};if(n.isPresent()&&(a=this.calculateBoardValue(n.get(),i)),a.status===o1.VICTORY)return gn.of(s);if(i.turn>39){const c=i.countPieces();return gn.ofPlayerNumberMap(c)}return gn.of(a.status===o1.PRE_VICTORY?o.getPreVictory():a.sum*o.getScoreModifier())}startSearchingVictorySources(){this.currentVictorySource={typeSource:"LINE",index:-1}}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let t;switch(this.currentVictorySource.typeSource){case"LINE":t="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":t="TRIANGLE_EDGE";break;default:t="CIRCLE"}this.currentVictorySource={typeSource:t,index:0}}else{let t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const i=t.landing;switch(e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,i,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,i,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,i,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,i,n)}}searchVictoryOnlyForCircle(e,t,n){const i=n.getCurrentOpponent(),s=[t];let a=t.getNext(Se.factory.all[e],1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return{status:o1.PRE_VICTORY,victory:h.empty(),preVictory:h.empty(),sum:0};const l=(e+s.length)%6;s.push(a),a=a.getNext(Se.factory.all[l],1)}return{status:o1.VICTORY,victory:h.of(s),preVictory:h.empty(),sum:0}}searchVictoryOnlyForLine(e,t,n){const i=n.getCurrentOpponent();let o=Se.factory.all[e],s=t.getNext(o,1);const a=[t];let c=!1;for(;a.length<6;){if(n.getPieceAt(s)===i)a.push(s);else{if(c)return{status:o1.PRE_VICTORY,victory:h.empty(),preVictory:h.empty(),sum:0};c=!0,o=o.getOpposite(),s=s.getNext(o,a.length-1)}s=s.getNext(o,1)}return{status:o1.VICTORY,victory:h.of(a),preVictory:h.empty(),sum:0}}searchVictoryOnlyForTriangleCorner(e,t,n){const i=n.getCurrentOpponent();let o=Se.factory.all[e];const s=[t];let a=t.getNext(o,1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return{status:o1.PRE_VICTORY,victory:h.empty(),preVictory:h.empty(),sum:0};s.length%2==0&&(o=Se.factory.all[(e+s.length)%6]),s.push(a),a=a.getNext(o,1)}return{status:o1.VICTORY,victory:h.of(s),preVictory:h.empty(),sum:0}}searchVictoryOnlyForTriangleEdge(e,t,n){const i=n.getCurrentOpponent();let o=Se.factory.all[e];const s=[t];let a=t.getNext(o,1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return{status:o1.PRE_VICTORY,victory:h.empty(),preVictory:h.empty(),sum:0};s.push(a),s.length%2==0&&(o=Se.factory.all[(e+s.length)%6]),a=a.getNext(o,1)}return{status:o1.VICTORY,victory:h.of(s),preVictory:h.empty(),sum:0}}getBoardInfo(e,t,n,i){const o=t.landing;switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,o,n,i);case"LINE":return this.getBoardInfoForLine(e.index,o,n,i);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,o,n,i);default:return this.getBoardInfoForTriangleEdge(e.index,o,n,i)}}getBoardInfoForCircle(e,t,n,i){const o=n.getCurrentPlayer(),a=[t];let c=t.getNext(Se.factory.all[e],1),l=0,u=h.empty();for(;a.length<6;){const f=n.getPieceAt(c);if(f===o)return i;const g=(e+a.length)%6;a.push(c);const y=Se.factory.all[g];f===B.NONE?(l+=.16,u=h.of(c)):l++,c=c.getNext(y,1)}return this.getBoardInfoResult(l,u,a,i)}getBoardInfoResult(e,t,n,i){let o=i.preVictory;if(4.16===e){if(o.isPresent()&&!1===o.equals(t))return{status:o1.PRE_VICTORY,victory:h.empty(),preVictory:h.empty(),sum:0};o=t}else if(5===e)return{status:o1.VICTORY,victory:h.of(n),preVictory:h.empty(),sum:0};return{status:i.status,victory:h.empty(),preVictory:o,sum:i.sum+e}}getBoardInfoForLine(e,t,n,i){const o=Se.factory.all[e];let s=t.getPrevious(o,5),a=[],c=[],l=h.empty();for(let I=0;I<6;I++){const R=this.updateEncounterAndReturnLastEmpty(n,s,c);R.isPresent()&&(l=R),a.push(s),s=s.getNext(o,1)}let u=i.status,f=i.preVictory,g=0,y=0;for(;g<6;){const I=c.reduce((U,$)=>U+$);5.16===I&&u===o1.DEFAULT&&(f.isPresent()?(L.assert(!1===f.equals(l),"Impossible to have point aligned with different line to a same point"),u=o1.PRE_VICTORY):f=l),y=Math.max(y,I),a=a.slice(1,6),a.push(s),c=c.slice(1,6);const R=this.updateEncounterAndReturnLastEmpty(n,s,c);R.isPresent()&&(l=R),g++,s=s.getNext(o,1)}const S={status:u,victory:h.of(a),preVictory:f,sum:y};return this.getBoardInfoResult(y,l,a,S)}updateEncounterAndReturnLastEmpty(e,t,n){const i=e.getCurrentPlayer();switch(e.getPieceAt(t)){case i:return n.push(-7),h.empty();case B.NONE:return n.push(.16),h.of(t);default:return n.push(1),h.empty()}}getBoardInfoForTriangleCorner(e,t,n,i){const o=n.getCurrentPlayer();let s=Se.factory.all[e];const a=[t];let c=t.getNext(s,1),l=0,u=h.empty();for(;a.length<6;){const f=n.getPieceAt(c);if(f===o)return i;f===B.NONE?(l+=.16,u=h.of(c)):l++,a.length%2==0&&(s=Se.factory.all[(e+a.length)%6]),a.push(c),c=c.getNext(s,1)}return this.getBoardInfoResult(l,u,a,i)}getBoardInfoForTriangleEdge(e,t,n,i){const o=n.getCurrentPlayer();let s=Se.factory.all[e];const a=[t];let c=t.getNext(s,1),l=0,u=h.empty();for(;a.length<6;){const f=n.getPieceAt(c);if(f===o)return i;f===B.NONE?(l+=.16,u=h.of(c)):l++,a.push(c),a.length%2==0&&(s=Se.factory.all[(e+a.length)%6]),c=c.getNext(s,1)}return this.getBoardInfoResult(l,u,a,i)}}let tv=class extends Yn{getListMoves(e,t){const n=s3.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrops(n):this.getMovements(e.gameState,n)}getMovements(e,t){const n=e.getPieces().reverse(),i=e.getCurrentPlayer(),o=n.get(i).get();return this.getMovementsFrom(e,o,t)}getMovementsFrom(e,t,n){const i=[];for(const o of t)for(const s of n){const a=Lr.ofMovement(o,s);if(e.isCoordConnected(s,h.of(o))){const l=e.movePiece(a).getGroups();if(s3.isSplit(l)){const u=s3.getLargestGroups(l);if(1===u.size())i.push(Lr.ofMovement(o,s));else for(const f of u){const g=f.getAnyElement().get(),y=Lr.ofCut(o,s,g);i.push(y)}}else i.push(a)}}return i}getListDrops(e){const t=[];for(const n of e){const i=Lr.ofDrop(n);t.push(i)}return t}};tv=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],tv);class qHe extends tv{heuristic=new YJ;getMovements(e,t){const n=this.getSafelyMovablePieceOrFirstOne(e);return this.getMovementsFrom(e,n,t)}getSafelyMovablePieceOrFirstOne(e){const t=e.getPieces().reverse(),n=e.getCurrentPlayer(),i=t.get(n).get(),o=i.getAnyElement().get(),s=[];for(const a of i)!1===this.isPieceBlockingAVictory(e,a)&&s.push(a);return new sr(0===s.length?[o]:s)}isPieceBlockingAVictory(e,t){const n=e.switchPiece(t),i=Lr.ofDrop(t);for(this.heuristic.startSearchingVictorySources();this.heuristic.hasNextVictorySource();)if(this.heuristic.currentVictorySource=this.heuristic.getNextVictorySource(),this.heuristic.searchVictoryOnly(this.heuristic.currentVictorySource,i,n).status===o1.VICTORY)return!0;return!1}}function jHe(r,e){if(1&r){const t=de();N(),M(0,"polygon",10),W("click",function(){const o=te(t).$implicit;return ne(p().onPieceClick(o))}),P()}if(2&r){const t=e.$implicit,n=p();Ce("id","piece_",t.x,"_",t.y,""),v("ngClass",n.getPieceClass(t)),w("points",n.getHexaPoints())("transform",n.getHexaCenterTranslationAtXY(t.x,t.y))}}function ZHe(r,e){if(1&r){const t=de();N(),M(0,"polygon",11),W("click",function(){const o=te(t).$implicit;return ne(p().onNeighborClick(o))}),P()}if(2&r){const t=e.$implicit,n=p();Ce("id","neighbor_",t.x,"_",t.y,""),w("points",n.getHexaPoints())("transform",n.getHexaCenterTranslationAtXY(t.x,t.y))}}function YHe(r,e){if(1&r){const t=de();N(),M(0,"polygon",10),W("click",function(){te(t);const i=p();return ne(i.onPieceClick(i.chosenLanding.get()))}),P()}if(2&r){const t=p();Ce("id","chosenLanding_",t.chosenLanding.get().x,"_",t.chosenLanding.get().y,""),v("ngClass",t.getPlayerClass(t.state.getCurrentPlayer())),w("points",t.getHexaPoints())("transform",t.getHexaCenterTranslationAtXY(t.chosenLanding.get().x,t.chosenLanding.get().y))}}function KHe(r,e){if(1&r&&(N(),V(0,"polygon",12)),2&r){const t=e.$implicit,n=p();Ce("id","disconnected_",t.x,"_",t.y,""),w("points",n.getHexaPoints())("transform",n.getHexaCenterTranslationAtXY(t.x,t.y))}}function XHe(r,e){if(1&r){const t=de();N(),M(0,"polygon",13),W("click",function(){te(t);const i=p();return ne(i.onNeighborClick(i.leftCoord.get()))}),P()}if(2&r){const t=p();Ce("id","leftCoord_",t.leftCoord.get().x,"_",t.leftCoord.get().y,""),w("points",t.getHexaPoints())("transform",t.getHexaCenterTranslationAtXY(t.leftCoord.get().x,t.leftCoord.get().y))}}function QHe(r,e){if(1&r){const t=de();N(),M(0,"polygon",14),W("click",function(){te(t);const i=p();return ne(i.onPieceClick(i.lastDrop.get()))}),P()}if(2&r){const t=p();Ce("id","lastDrop_",t.lastDrop.get().x,"_",t.lastDrop.get().y,""),w("points",t.getHexaPoints())("transform",t.getHexaCenterTranslationAtXY(t.lastDrop.get().x,t.lastDrop.get().y))}}function JHe(r,e){if(1&r){const t=de();N(),M(0,"polygon",15),W("click",function(){te(t);const i=p();return ne(i.onPieceClick(i.selectedPiece.get()))}),P()}if(2&r){const t=p();Ce("id","selectedPiece_",t.selectedPiece.get().x,"_",t.selectedPiece.get().y,""),v("ngClass",t.getSelectedPieceClass()),w("points",t.getHexaPoints())("transform",t.getHexaCenterTranslationAtXY(t.selectedPiece.get().x,t.selectedPiece.get().y))}}function eFe(r,e){if(1&r&&(N(),V(0,"polygon",16)),2&r){const t=e.$implicit,n=p();Ce("id","victoryCoord_",t.x,"_",t.y,""),w("points",n.getHexaPoints())("transform",n.getHexaCenterTranslationAtXY(t.x,t.y))}}function tFe(r,e){if(1&r){const t=de();N(),M(0,"polygon",19),W("click",function(){const o=te(t).$implicit;return ne(p(2).onPieceClick(o))}),P()}if(2&r){const t=e.$implicit,n=p(2);Ce("id","cuttable_",t.x,"_",t.y,""),w("points",n.getHexaPoints())("transform",n.getHexaCenterTranslationAtXY(t.x,t.y))}}function nFe(r,e){if(1&r&&(N(),M(0,"g",17),z(1,tFe,1,4,"polygon",18),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}let rFe=(()=>{class r extends J5{state;pieces;disconnecteds=[];cuttableGroups=[];victoryCoords;neighbors;leftCoord=h.empty();lastDrop=h.empty();selectedPiece=h.empty();chosenLanding=h.empty();nextClickShouldSelectGroup=!1;constructor(t){super(t),this.setRulesAndNode("Six"),this.availableAIs=[new cn($localize`Minimax`,this.rules,new YJ,new qHe),new kn($localize`MCTS`,new tv,this.rules)],this.encoder=Lr.encoder,this.SPACE_SIZE=30,this.hexaLayout=new eu(1.5*this.SPACE_SIZE,new _(2*this.SPACE_SIZE,0),jr.INSTANCE)}cancelMoveAttempt(){var t=this;return E(function*(){t.selectedPiece=h.empty(),t.chosenLanding=h.empty(),t.cuttableGroups=[],t.nextClickShouldSelectGroup=!1,yield t.updateBoard(!1)})()}updateBoard(t){var n=this;return E(function*(){n.state=n.node.gameState,n.pieces=n.state.getPieceCoords(),n.neighbors=n.getEmptyNeighbors()})()}hideLastMove(){this.leftCoord=h.empty(),this.lastDrop=h.empty(),this.victoryCoords=[],this.disconnecteds=[]}getViewBox(){const t=this.pieces.concat(this.disconnecteds).concat(this.neighbors);return Ys.fromHexa(t,this.hexaLayout,this.STROKE_WIDTH).expandAbove(this.SPACE_SIZE+this.STROKE_WIDTH).expandBelow(this.SPACE_SIZE+this.STROKE_WIDTH).expandLeft(this.SPACE_SIZE+2*this.STROKE_WIDTH).expandRight(this.SPACE_SIZE+2*this.STROKE_WIDTH)}showLastMove(t){var n=this;return E(function*(){n.lastDrop=h.of(t.landing),n.leftCoord=!1===t.isDrop()?h.of(t.start.get()):h.empty();const i=n.getState();n.rules.getGameStatus(n.node).isEndGame&&(n.victoryCoords=n.rules.getShapeVictory(t,i)),n.disconnecteds=n.getDisconnected()})()}getDisconnected(){const t=this.getPreviousState().getPieceCoords(),n=this.getState().getPieceCoords(),i=[];for(const s of t)!1===this.node.previousMove.get().start.equalsValue(s)&&!1===n.some(c=>c.equals(s))&&i.push(s);const o=this.lastDrop.get();return!1===this.pieces.some(s=>s.equals(o))&&!1===n.some(s=>s.equals(o))&&i.push(o),i}getEmptyNeighbors(){let t=s3.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){const n=this.chosenLanding.get();t=t.filter(i=>!1===i.equals(n))}return t}getPieceClass(t){const n=this.getState().getPieceAt(t);return this.getPlayerClass(n)}onPieceClick(t){var n=this;return E(function*(){const i=yield n.canUserPlay("#piece_"+t.x+"_"+t.y);if(i.isFailure())return n.cancelMove(i.getReason());if(n.state.turn<40)return n.cancelMove(Ka.NO_MOVEMENT_BEFORE_TURN_40());if(n.chosenLanding.isAbsent())return n.state.getPieceAt(t)===n.state.getCurrentOpponent()?n.cancelMove(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):(n.selectedPiece=n.selectedPiece.equalsValue(t)?h.empty():h.of(t),A.SUCCESS);{const o=Lr.ofCut(n.selectedPiece.get(),n.chosenLanding.get(),t);return n.chooseMove(o)}})()}onNeighborClick(t){var n=this;return E(function*(){const i=yield n.canUserPlay("#neighbor_"+t.x+"_"+t.y);if(i.isFailure())return n.cancelMove(i.getReason());if(n.nextClickShouldSelectGroup)return n.cancelMove(Ka.MUST_CUT());if(n.state.turn<40)return n.chooseMove(Lr.ofDrop(t));if(n.selectedPiece.isAbsent())return n.cancelMove(Ka.CAN_NO_LONGER_DROP());{const o=Lr.ofMovement(n.selectedPiece.get(),t),s=s3.isLegalPhaseTwoMove(o,n.state);return n.neededCutting(s)?(n.chosenLanding=h.of(t),n.moveVirtuallyPiece(),n.showCuttable(),n.nextClickShouldSelectGroup=!0,A.SUCCESS):n.chooseMove(o)}})()}neededCutting(t){return t.isFailure()&&t.getReason()===Ka.MUST_CUT()}moveVirtuallyPiece(){const t=this.selectedPiece.get();this.pieces=this.pieces.filter(n=>!1===n.equals(t)),this.neighbors=this.getEmptyNeighbors()}showCuttable(){const t=Lr.ofMovement(this.selectedPiece.get(),this.chosenLanding.get()),i=this.state.movePiece(t).getGroups(),o=s3.getLargestGroups(i);this.cuttableGroups=[];for(const s of o)this.cuttableGroups.push(s.toList())}getSelectedPieceClass(){return this.chosenLanding.isPresent()?"moved-fill":"selected-stroke"}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-six"]],features:[We],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured-fill",3,"id",4,"ngFor","ngForOf"],["class","base round moved-fill mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move-stroke mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured-fill",3,"id"],[1,"base","round","moved-fill","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move-stroke","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","victory-stroke","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(n,i){1&n&&(N(),M(0,"svg",0),z(1,jHe,1,5,"polygon",1)(2,ZHe,1,4,"polygon",2)(3,YHe,1,5,"polygon",3)(4,KHe,1,4,"polygon",4)(5,XHe,1,4,"polygon",5)(6,QHe,1,4,"polygon",6)(7,JHe,1,5,"polygon",7)(8,eFe,1,4,"polygon",8)(9,nFe,2,1,"g",9),P()),2&n&&(w("viewBox",i.getViewBox().toSVGString()),m(),v("ngForOf",i.pieces),m(),v("ngForOf",i.neighbors),m(),v("ngIf",i.chosenLanding.isPresent()),m(),v("ngForOf",i.disconnecteds),m(),v("ngIf",i.leftCoord.isPresent()),m(),v("ngIf",i.lastDrop.isPresent()),m(),v("ngIf",i.selectedPiece.isPresent()),m(),v("ngForOf",i.victoryCoords),m(),v("ngForOf",i.cuttableGroups))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const le=B.NONE,Pt=O.ZERO,Rt=O.ONE;let ek=(()=>class r{static MOVEMENT_NOT_DISCONNECTING=()=>$localize`This move does not disconnect your opponent's pieces. Try again with another piece.`;static MOVEMENT_SELF_DISCONNECTING=()=>$localize`You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!`})();class iFe extends Bn{tutorial=[q.informational($localize`Six`,$localize`Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.
        Each player has 21 pieces, with one for each player already on the board.
        The goal of the game is to form one of the three winning shapes with your pieces.`,s3.get().getInitialState()),q.fromMove($localize`Victory (line)`,$localize`On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>
        Find the victory. You're playing Dark.`,Bo.ofRepresentation([[Pt,Rt,Rt,Rt,Rt,Pt],[le,Pt,Rt,le,Pt,le],[Rt,Rt,Pt,le,le,le],[le,le,Pt,le,le,le],[le,Pt,le,le,le,le],[Pt,le,le,le,le,le]],0),[Lr.ofDrop(new _(3,2))],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),q.fromMove($localize`Victory (circle)`,$localize`On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,Bo.ofRepresentation([[le,le,le,Rt,le,le],[le,le,Rt,Rt,Pt,Pt],[le,Rt,le,Pt,Rt,le],[Rt,Pt,Pt,Pt,Pt,Rt]],0),[Lr.ofDrop(new _(5,2))],$localize`Congratulations! Note that if a piece is inside the circle, it does not change anything.`,pe.FAILED_TRY_AGAIN()),q.fromMove($localize`Victory (triangle)`,$localize`On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,Bo.ofRepresentation([[le,le,le,Rt,le,le],[le,Pt,Rt,Pt,Pt,Pt],[le,Pt,le,Pt,Pt,le],[Rt,Rt,Rt,le,Rt,le]],0),[Lr.ofDrop(new _(3,3))],pe.CONGRATULATIONS(),pe.FAILED_TRY_AGAIN()),q.fromPredicate($localize`Second phase`,$localize`After 40 turns, your pieces have all been placed and we move on to the second phase of the game.
        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.
        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>
        You're playing Dark. Make a move that disconnects one of your opponent's pieces.`,Bo.ofRepresentation([[le,le,le,le,le,le,le,Rt,le],[le,le,le,le,le,le,Pt,le,le],[le,le,le,le,Pt,Pt,Pt,le,le],[le,le,le,le,Rt,Rt,le,Rt,Pt],[le,Pt,Rt,Rt,Pt,Pt,Rt,le,le],[Pt,Pt,Pt,Pt,Rt,Rt,Rt,Pt,le],[Rt,Rt,Pt,le,Rt,Rt,Pt,le,le],[le,Pt,le,Pt,Pt,le,le,le,le],[Rt,Rt,Rt,Rt,le,le,le,le,le],[le,Pt,le,Rt,le,le,le,le,le]],40),Lr.ofMovement(new _(6,1),new _(5,1)),(e,t,n)=>{const i=n.countPieces();return 19===i.get(O.ZERO)?18===i.get(O.ONE)?A.SUCCESS:A.failure(ek.MOVEMENT_NOT_DISCONNECTING()):A.failure(ek.MOVEMENT_SELF_DISCONNECTING())},$localize`Congratulations, your opponent now has one piece less and you're closer to victory!`),q.fromPredicate($localize`Victory by disconnection`,$localize`During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.
        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.
        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>
        Here, you're playing Dark and you can win. Do it!`,Bo.ofRepresentation([[le,le,le,le,le,Rt],[le,le,le,le,Pt,Rt],[le,le,le,Rt,Pt,Pt],[le,le,Pt,le,Rt,Pt],[Rt,Rt,le,le,le,Pt],[Pt,Rt,le,le,le,le],[Pt,le,le,le,le,le]],40),Lr.ofMovement(new _(2,3),new _(3,3)),(e,t,n)=>e.start.equalsValue(new _(2,3))?A.SUCCESS:A.failure(ek.MOVEMENT_NOT_DISCONNECTING()),pe.CONGRATULATIONS_YOU_WON()),q.fromPredicate($localize`Special disconnection`,$localize`During a disconnection, two or more groups could have the same size,
        in which case you will have to click on the group you wish to keep.<br/><br/>
        You're playing Dark, play such a move!`,Bo.ofRepresentation([[le,le,le,le,le,Rt],[le,le,le,le,Pt,Rt],[le,le,le,Rt,Pt,Pt],[Pt,le,Pt,le,le,Rt],[Rt,Rt,le,le,le,le],[Pt,Pt,le,le,le,le],[Pt,le,le,le,le,le]],40),Lr.ofCut(new _(2,3),new _(2,5),new _(2,5)),(e,t,n)=>e.keep.isAbsent()?A.failure($localize`This move has not cut the board in two equal halves.`):n.getPieceAt(e.landing)===B.NONE?A.failure($localize`Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again.`):A.SUCCESS,pe.CONGRATULATIONS_YOU_WON())]}class ua extends nu{static encoder=q2.getFallibleEncoder(ua.from);static from(e,t){const n=nu.isValidDirection(e,t);return n.isFailure()?n.toOtherFallible():X.success(new ua(e,t))}getMaximalDistance(){return 9}}function oFe(r,e){1&r&&(N(),V(0,"polygon",8))}function sFe(r,e){1&r&&(N(),V(0,"rect",9))}function aFe(r,e){if(1&r&&(N(),M(0,"g"),z(1,oFe,1,0,"polygon",6)(2,sFe,1,0,"ng-template",null,7,wn),P()),2&r){const t=Pn(3),n=p().index,i=p().index,o=p();m(),v("ngIf",o.isCentralThrone(n,i))("ngIfElse",t)}}function cFe(r,e){if(1&r&&(N(),M(0,"g"),V(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),P()),2&r){const t=p(2).index,n=p().index,i=p();m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function lFe(r,e){if(1&r&&(N(),V(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;v("ngClass",p().viewInfo.pieceClasses[n][t])}}function uFe(r,e){if(1&r&&(N(),V(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),m(),v("ngClass",i.viewInfo.pieceClasses[n][t]),w("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function fFe(r,e){if(1&r&&(N(),z(0,lFe,1,1,"polyline",14)(1,uFe,4,20,"ng-template",null,15,wn)),2&r){const t=Pn(2),n=p(2).index,i=p().index;v("ngIf",p().isKing(n,i))("ngIfElse",t)}}function dFe(r,e){if(1&r&&(N(),M(0,"g"),V(1,"circle",10),z(2,cFe,6,25,"g",11)(3,fFe,3,2,"ng-template",null,12,wn),P()),2&r){const t=Pn(4),n=p().index,i=p().index,o=p();m(),Ce("id","piece_",n,"_",i,""),v("ngClass",o.viewInfo.pieceClasses[i][n]),w("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)("cx",.5*o.SPACE_SIZE)("cy",.5*o.SPACE_SIZE),m(),v("ngIf",o.isInvader(n,i))("ngIfElse",t)}}function hFe(r,e){if(1&r){const t=de();N(),M(0,"g",3),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),V(1,"rect",4),z(2,aFe,4,2,"g",5)(3,dFe,5,8,"g",5),P()}if(2&r){const t=e.index,n=p().index,i=p();Ce("id","click_",t,"_",n,""),w("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),m(),Ce("id","space_",t,"_",n,""),v("ngClass",i.getRectClasses(t,n)),w("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),m(),v("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),m(),v("ngIf",i.board[n][t]!==i.EMPTY)}}function gFe(r,e){if(1&r&&(N(),M(0,"g"),z(1,hFe,4,10,"g",2),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function pFe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"rect",17),W("click",function(){const o=te(t).$implicit;return ne(p().onClick(o.x,o.y))}),P()()}if(2&r){const t=e.$implicit,n=p();m(),Ce("id","click_",t.x,"_",t.y,""),w("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let mFe=(()=>{class r extends TI{constructor(t){super(t,ua.from),this.setRulesAndNode("Tablut"),this.availableAIs=this.createAIs(),this.encoder=ua.encoder}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-tablut"]],features:[We],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(N(),M(0,"svg",0),z(1,gFe,2,1,"g",1)(2,pFe,2,6,"g",1),P()),2&n&&(w("viewBox",i.getViewBox().toSVGString()),m(),v("ngForOf",i.board),m(),v("ngForOf",i.getClickables()))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();class a3 extends qi{static singleton=h.empty();static RULES_CONFIG_DESCRIPTION=new po({name:()=>$localize`Tablut`,config:{castleIsLeftForGood:new Qn(!1,qi.CASTLE_IS_LEFT_FOR_GOOD),edgesAreKingsEnnemy:new Qn(!0,qi.EDGE_ARE_KING_S_ENNEMY),centralThroneCanSurroundKing:new Qn(!1,qi.CENTRAL_THRONE_CAN_SURROUND_KING),kingFarFromHomeCanBeSandwiched:new Qn(!1,qi.KING_FAR_FROM_HOME_CAN_BE_SANDWICHED),invaderStarts:new Qn(!0,qi.INVADER_STARTS)}});static get(){return a3.singleton.isAbsent()&&(a3.singleton=h.of(new a3)),a3.singleton.get()}constructor(){super(ua.from)}getInitialState(e){const t=It.UNOCCUPIED;let n=It.PLAYER_ZERO_PAWN,i=It.PLAYER_ONE_PAWN,o=It.PLAYER_ONE_KING;return!1===e.get().invaderStarts&&(n=It.PLAYER_ONE_PAWN,i=It.PLAYER_ZERO_PAWN,o=It.PLAYER_ZERO_KING),new M2([[t,t,t,n,n,n,t,t,t],[t,t,t,t,n,t,t,t,t],[t,t,t,t,i,t,t,t,t],[n,t,t,t,i,t,t,t,n],[n,n,i,i,o,i,i,n,n],[n,t,t,t,i,t,t,t,n],[t,t,t,t,i,t,t,t,t],[t,t,t,t,n,t,t,t,t],[t,t,t,n,n,n,t,t,t]],0)}getRulesConfigDescription(){return h.of(a3.RULES_CONFIG_DESCRIPTION)}}const H=It.UNOCCUPIED,zn=It.PLAYER_ZERO_PAWN,J2=It.PLAYER_ONE_PAWN,nv=It.PLAYER_ONE_KING,KJ=a3.get().getDefaultRulesConfig();class _Fe extends Bn{tutorial=[q.informational($localize`Goal of the game`,$localize`Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,a3.get().getInitialState(KJ)),q.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,a3.get().getInitialState(KJ),ua.from(new _(4,1),new _(1,1)).get(),pe.CONGRATULATIONS()),q.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new M2([[H,H,H,zn,zn,zn,H,H,H],[H,H,H,H,zn,H,H,H,H],[H,H,H,H,J2,H,H,H,H],[H,H,H,zn,J2,H,H,H,zn],[zn,zn,J2,J2,nv,J2,J2,zn,zn],[H,H,H,H,J2,H,H,H,zn],[H,H,H,H,J2,H,H,H,H],[H,H,H,H,zn,H,H,H,H],[H,H,H,zn,zn,zn,H,H,H]],1),[ua.from(new _(2,4),new _(2,3)).get(),ua.from(new _(4,2),new _(3,2)).get()],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),q.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new M2([[H,H,H,zn,zn,zn,H,H,H],[H,H,H,H,zn,H,H,H,H],[H,H,H,H,J2,H,H,H,H],[H,H,J2,H,nv,H,J2,H,zn],[zn,zn,H,J2,H,J2,J2,zn,zn],[H,H,H,H,J2,H,H,H,zn],[H,H,H,H,J2,H,H,H,H],[H,H,H,H,zn,H,H,H,H],[H,H,H,zn,zn,zn,H,H,H]],12),[ua.from(new _(1,4),new _(2,4)).get()],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),q.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new M2([[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,zn,H,H,H,H,H,H,H],[zn,nv,H,zn,H,H,H,H,H],[H,zn,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H]],72),[ua.from(new _(3,4),new _(2,4)).get()],pe.CONGRATULATIONS_YOU_WON(),$localize`Failed, you let the king run away.`),q.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new M2([[H,H,zn,nv,zn,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,zn,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H]],72),[ua.from(new _(3,3),new _(3,1)).get()],$localize`The king is dead, long live the king. Congratulations, you won.`,pe.FAILED_TRY_AGAIN())]}let As=(()=>{class r extends $1{static WIDTH=5;static isOnBoard(t){return t.isInRange(r.WIDTH,r.WIDTH)}isInDropPhase(){return this.turn<8}}return r})();class fa extends Nr{static encoder=Nr.getFallibleEncoder(fa.from);static from(e){return As.isOnBoard(e)?X.success(new fa(e.x,e.y)):X.failure(go.OUT_OF_RANGE(e))}toString(){return"TeekoMove"+this.coord.toString()}equals(e){return e instanceof fa&&super.equals(e)}}class da extends Do{static encoder=Do.getFallibleEncoder(da.from);static from(e,t){return!1===As.isOnBoard(e)?X.failure(go.OUT_OF_RANGE(e)):!1===As.isOnBoard(t)?X.failure(go.OUT_OF_RANGE(t)):e.equals(t)?X.failure(Me.MOVE_CANNOT_BE_STATIC()):X.success(new da(e,t))}toString(){return"TeekoMove("+this.getStart().toString()+" -> "+this.getEnd().toString()+")"}equals(e){return e instanceof da&&super.equals(e)}}var tk;!function(r){r.encoder=ke.disjunction([e=>e instanceof fa,e=>e instanceof da],[fa.encoder,da.encoder])}(tk||(tk={}));class ha extends Da{static singleton=h.empty();static get(){return ha.singleton.isAbsent()&&(ha.singleton=h.of(new ha)),ha.singleton.get()}static RULES_CONFIG_DESCRIPTION=new po({name:()=>$localize`Standard Teeko`,config:{teleport:new Qn(!1,()=>$localize`Piece can teleport`)}},[{name:()=>$localize`Teleport Teeko`,config:{teleport:!0}}]);static TEEKO_HELPER=new o0(L.identity,4);getRulesConfigDescription(){return h.of(ha.RULES_CONFIG_DESCRIPTION)}getInitialState(){const e=it.create(As.WIDTH,As.WIDTH,B.NONE);return new As(e,0)}isLegal(e,t,n){return t.isInDropPhase()?(L.assert(e instanceof fa,"Cannot translate in dropping phase !"),this.isLegalDrop(e,t)):(L.assert(e instanceof da,"Cannot drop in translation phase !"),this.isLegalTranslation(e,t,n.get()))}isLegalDrop(e,t){return t.getPieceAt(e.coord).isPlayer()?A.failure(Me.MUST_LAND_ON_EMPTY_SPACE()):A.SUCCESS}isLegalTranslation(e,t,n){const i=t.getPieceAt(e.getStart());return i===t.getCurrentOpponent()?A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT()):i===B.NONE?A.failure(Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):t.getPieceAt(e.getEnd()).isPlayer()?A.failure(Me.MUST_LAND_ON_EMPTY_SPACE()):!1===n.teleport&&!1===e.getStart().isNeighborWith(e.getEnd())?A.failure(Me.MUST_MOVE_ON_NEIGHBOR()):A.SUCCESS}applyLegalMove(e,t,n,i){return e instanceof fa?this.applyLegalDrop(e,t):this.applyLegalTranslation(e,t)}applyLegalDrop(e,t){const n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.getCurrentPlayer(),new As(n,t.turn+1)}applyLegalTranslation(e,t){const n=t.getCopiedBoard();return n[e.getStart().y][e.getStart().x]=B.NONE,n[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer(),new As(n,t.turn+1)}getGameStatus(e){const t=e.gameState;return this.getVictoryCoord(t).length>0?ve.getVictory(t.getCurrentOpponent()):ve.ONGOING}getLastCoord(e){return e instanceof fa?e.coord:e.getEnd()}getSquareInfo(e){const t=[],n=we.of(0,0);for(let i=0;i<As.WIDTH-1;i++)for(let o=0;o<As.WIDTH-1;o++){const s=new _(i,o),a=new _(i+1,o),c=new _(i,o+1),l=new _(i+1,o+1),u=[e.getPieceAt(s),e.getPieceAt(a),e.getPieceAt(c),e.getPieceAt(l)],f=yt.count(u,B.NONE),g=yt.count(u,B.ZERO),y=yt.count(u,B.ONE);f<4&&(4===g||4===y?t.push(s,a,c,l):n.add(g>0?O.ZERO:O.ONE,1))}return{score:n.get(O.ONE)-n.get(O.ZERO),victoriousCoords:t}}getVictoryCoord(e){const t=ha.TEEKO_HELPER.getVictoriousCoord(e),n=this.getSquareInfo(e).victoriousCoords;return t.concat(n)}}class CFe extends Ha{getBoardValue(e,t){const n=ha.TEEKO_HELPER.getBoardValue(e.gameState).metrics[0],i=ha.get().getSquareInfo(e.gameState);return gn.of(i.score+n)}}class XJ extends Yn{getListMoves(e,t){return e.gameState.isInDropPhase()?this.getListDrops(e.gameState):this.getListTranslations(e.gameState,t.get())}getListDrops(e){const t=[];for(const n of e.getCoordsAndContents()){const i=n.coord;if(!1===n.content.isPlayer()){const o=fa.from(i).get();t.push(o)}}return t}getListTranslations(e,t){const n=[],i=e.getCurrentPlayer(),o=this.getCoordsContaining(e,i);for(const s of o)for(const a of this.getPossibleTargets(e,s,t)){const c=da.from(s,a).get();n.push(c)}return n}getPossibleTargets(e,t,n){if(n.teleport)return this.getCoordsContaining(e,B.NONE);{const i=[];for(const o of me.factory.all){const s=t.getNext(o);As.isOnBoard(s)&&e.getPieceAt(s)===B.NONE&&i.push(s)}return i}}getCoordsContaining(e,t){const n=[];for(const i of e.getCoordsAndContents())i.content===t&&n.push(i.coord);return n}}function vFe(r,e){if(1&r&&(N(),V(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();Ce("id","piece_",t,"_",n,""),v("ngClass",i.getPieceClasses(t,n)),w("r",42)("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)}}function yFe(r,e){if(1&r){const t=de();N(),M(0,"g",3),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),V(1,"rect",4),z(2,vFe,1,6,"circle",5),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();Ce("id","click_",n,"_",i,""),m(),Ce("id","space_",n,"_",i,""),v("ngClass",o.getSpaceClasses(n,i)),w("x",o.SPACE_SIZE*n)("y",o.SPACE_SIZE*i)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),m(),v("ngIf",t.isPlayer())}}function MFe(r,e){if(1&r&&(N(),M(0,"g"),z(1,yFe,3,10,"g",2),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}let EFe=(()=>{class r extends y2{selected=h.empty();last=h.empty();moved=[];victory=[];constructor(t){super(t),this.setRulesAndNode("Teeko"),this.availableAIs=[new cn($localize`Minimax`,this.rules,new CFe,new XJ),new kn($localize`MCTS`,new XJ,this.rules)],this.encoder=tk.encoder}updateBoard(t){var n=this;return E(function*(){n.board=n.node.gameState.board})()}showLastMove(t){var n=this;return E(function*(){n.last=h.of(n.rules.getLastCoord(t)),n.moved=t instanceof da?[t.getStart(),t.getEnd()]:[],n.victory=n.rules.getVictoryCoord(n.getState())})()}hideLastMove(){var t=this;return E(function*(){t.last=h.empty(),t.moved=[],t.victory=[]})()}cancelMoveAttempt(){this.selected=h.empty()}onClick(t,n){var i=this;return E(function*(){const o=yield i.canUserPlay("#click_"+t+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=new _(t,n);if(i.getState().isInDropPhase()){const a=fa.from(s).get();return i.chooseMove(a)}if(i.selected.isPresent()){if(i.selected.equalsValue(s))return i.selected=h.empty(),A.SUCCESS;{const a=da.from(i.selected.get(),s).get();return i.chooseMove(a)}}{const a=i.getState().getCurrentPlayer(),c=i.getState().getPieceAt(s);return c===a?(i.selected=h.of(s),A.SUCCESS):i.cancelMove(c===B.NONE?Me.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY():Me.MUST_CHOOSE_OWN_PIECE_NOT_OPPONENT())}})()}getPieceClasses(t,n){const i=new _(t,n),s=[this.getPlayerClass(this.getState().getPieceAt(i))];return this.victory.some(a=>a.equals(i))?s.push("victory-stroke"):this.last.equalsValue(i)?s.push("last-move-stroke"):this.selected.equalsValue(i)&&s.push("selected-stroke"),s}getSpaceClasses(t,n){const i=new _(t,n);return this.moved.some(o=>o.equals(i))?["moved-fill"]:[]}static \u0275fac=function(n){return new(n||r)(G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-teeko"]],features:[We],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"]],template:function(n,i){1&n&&(N(),M(0,"svg",0),z(1,MFe,2,1,"g",1),P()),2&n&&(w("viewBox",i.getViewBox().toSVGString()),m(),v("ngForOf",i.board))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const Wn=B.NONE,zl=B.ZERO,Dl=B.ONE;class PFe extends Bn{tutorial=[q.informational($localize`Goal of the game`,$localize`The goal of the game is to align your 4 pieces, or to form a square with them.`,ha.get().getInitialState()),q.anyMove($localize`Dropping a piece`,$localize`During your first four turns, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,ha.get().getInitialState(),fa.from(new _(2,2)).get(),pe.CONGRATULATIONS()),q.anyMove($localize`Moving a piece`,$localize`Once all of your four pieces are placed on the board, you must now move one of your piece to an empty neighboring space, orthogonally or diagonally. The goal remains to be the first to create a line or a square.<br/><br/>You're playing Dark, move a piece.`,new As([[zl,Dl,Wn,Wn,Wn],[zl,zl,Wn,Wn,Wn],[Dl,Dl,Wn,Wn,Wn],[Dl,zl,Wn,Wn,Wn],[Wn,Wn,Wn,Wn,Wn]],8),da.from(new _(1,3),new _(2,2)).get(),pe.CONGRATULATIONS()),q.fromMove($localize`Victory`,$localize`In this board, you can win by creating a square.<br/><br/>You are playing Dark, win.`,new As([[Dl,Wn,Wn,Wn,Wn],[Dl,zl,Wn,zl,Wn],[Wn,zl,zl,Dl,Wn],[Wn,Dl,Wn,Wn,Wn],[Wn,Wn,Wn,Wn,Wn]],8),[da.from(new _(3,1),new _(2,1)).get()],$localize`Congratulations, you won! Remember that you can also win by creating a line.`,pe.FAILED_TRY_AGAIN())]}class w2{owner;tileId;constructor(e,t){this.owner=e,this.tileId=t}toString(){return`TrexoPiece(${this.owner.toString()}, ${this.tileId})`}}class hi{pieces;static EMPTY=hi.of([]);static of(e){let t=-1;for(const n of e)L.assert(t<n.tileId,"TrexoPieceStack: dropped turn should be ascending"),t=n.tileId;return new hi(e)}constructor(e){this.pieces=e}getHeight(){return this.pieces.length}getOwner(){const e=this.pieces.length;return 0===e?B.NONE:this.pieces[e-1].owner}getUpperTileId(){const e=this.pieces.length;return 0===e?-1:this.pieces[e-1].tileId}add(e){return hi.of(this.pieces.concat(e))}getPieceAt(e){return L.assert(e<this.pieces.length,"no element "+e+"in piece!"),this.pieces[e]}isGround(){return-1===this.getUpperTileId()}toString(){return"["+this.pieces.map(e=>"("+e.toString()+")").join(" ")+"]"}}let e2=(()=>{class r extends $1{static SIZE=10;static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}static of(t,n){L.assert(t.length===r.SIZE,"Invalid board dimensions");for(const i of t)L.assert(i.length===r.SIZE,"Invalid board dimensions");return new r(t,n)}drop(t,n){const i=this.getCopiedBoard(),o=new w2(n,this.turn);return i[t.y][t.x]=i[t.y][t.x].add(o),new r(i,this.turn)}incrementTurn(){return new r(this.getCopiedBoard(),this.turn+1)}toString(){return this.board.map(t=>"["+t.map(n=>"TrexoPieceStack.of("+n.toString()+")").join(", ")+"]").join("\n,")}getPieceAtXYZ(t,n,i){return this.getPieceAtXY(t,n).getPieceAt(i)}}return r})(),rv=(()=>class r{static NON_NEIGHBORING_SPACES=()=>$localize`Those two spaces are not neighbors!`;static NO_WAY_TO_DROP_IT_HERE=()=>$localize`There is no way to put a piece there!`;static CANNOT_DROP_ON_ONLY_ONE_PIECE=()=>$localize`You cannot drop on only one piece!`;static CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS=()=>$localize`You cannot drop a piece on uneven grounds!`})();class bs extends q2{static encoder=q2.getFallibleEncoder(bs.from);static from(e,t){return L.assert(e2.isOnBoard(e),`${e.toString()} is out of the TrexoBoard!`),L.assert(e2.isOnBoard(t),`${t.toString()} is out of the TrexoBoard!`),1===e.getOrthogonalDistance(t)?X.success(new bs(e,t)):X.failure(rv.NON_NEIGHBORING_SPACES())}constructor(e,t){super(e,t)}toString(){return this.getFirst().toString()+" && "+this.getSecond().toString()}equals(e){return this.getFirst().equals(e.getFirst())&&this.getSecond().equals(e.getSecond())}getZero(){return this.getFirst()}getOne(){return this.getSecond()}}class eo extends wr{static instance=h.empty();static get(){return eo.instance.isAbsent()&&(eo.instance=h.of(new eo)),eo.instance.get()}static getOwner(e){return e.getOwner()}static TREXO_HELPER=new o0(eo.getOwner,5);static getSquareScore(e,t){return eo.TREXO_HELPER.getSquareScore(e,t)}static getVictoriousCoords(e){const t=[],n=[],i=e.getCurrentOpponent();for(const o of e.toMap()){const s=o.key,a=e.getPieceAt(s).getOwner();if(a.isPlayer()){const c=eo.getSquareScore(e,s);gn.isVictory(c)&&(a===i?t.push(s):n.push(s))}}return n.length>0?n:t}getInitialState(){const e=it.create(e2.SIZE,e2.SIZE,hi.EMPTY);return new e2(e,0)}applyLegalMove(e,t,n,i){return t.drop(e.getZero(),O.ZERO).drop(e.getOne(),O.ONE).incrementTurn()}isLegal(e,t){return this.isUnevenGround(e,t)?A.failure(rv.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS()):this.landsOnOnlyOnePiece(e,t)?A.failure(rv.CANNOT_DROP_ON_ONLY_ONE_PIECE()):A.SUCCESS}isUnevenGround(e,t){const n=t.getPieceAt(e.getZero()),i=t.getPieceAt(e.getOne());return n.getHeight()!==i.getHeight()}landsOnOnlyOnePiece(e,t){const n=t.getPieceAt(e.getZero()),i=t.getPieceAt(e.getOne());return(-1!==n.getUpperTileId()||-1!==i.getUpperTileId())&&n.getUpperTileId()===i.getUpperTileId()}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();let i=!1;for(const o of t.toMap()){const s=o.key,a=t.getPieceAt(s).getOwner();if(a.isPlayer()){const c=eo.getSquareScore(t,s);if(gn.isVictory(c)){if(a!==n)return ve.getDefeat(n);i=!0}}}return i?ve.getVictory(n):ve.ONGOING}getLegalMoves(e){const t=[];for(const n of e.toMap()){const i=n.key;if(i.x+1<e2.SIZE){const o=new _(i.x+1,i.y);t.push(...this.getPossiblesMoves(e,i,o))}if(i.y+1<e2.SIZE){const o=new _(i.x,i.y+1);t.push(...this.getPossiblesMoves(e,i,o))}}return t}getPossiblesMoves(e,t,n){const i=e.getPieceAt(t),o=e.getPieceAt(n);let s;s=!i.isGround()&&i.getUpperTileId()===o.getUpperTileId();const a=i.getHeight()!==o.getHeight();return s||a?[]:[bs.from(t,n).get(),bs.from(n,t).get()]}}class SFe extends Ha{getBoardValue(e,t){let n=0;const i=e.gameState;for(const o of i.toMap())i.getPieceAt(o.key).getOwner().isPlayer()&&(n+=eo.getSquareScore(i,o.key));return gn.of(n)}}class QJ extends Yn{rules=eo.get();getListMoves(e,t){return this.rules.getLegalMoves(e.gameState)}}function OFe(r,e){if(1&r){const t=de();N(),M(0,"g")(1,"polygon",5),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),P()()}if(2&r){const t=e.index,n=p().index,i=p();m(),Ce("id","space_",t,"_",n,""),v("ngClass",i.getSpaceClasses(t,n)),w("points",i.getParallelogramPoints())("transform",i.getTranslationAtXYZ(t,n,0))}}function TFe(r,e){if(1&r&&(N(),M(0,"g"),z(1,OFe,2,5,"g",1),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function AFe(r,e){if(1&r){const t=de();N(),M(0,"g",8),W("click",function(){te(t);const i=p().index,o=p().index;return ne(p(2).onClick(i,o))}),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p().index,a=p();Hr("id","half_tile_",n,"_",o,"_",s,""),v("mode",a.mode)("coord",a.Coord3D.of(n,o,s))("mustDisplayHeight","2D"===a.chosenMode)("move",i.move.get())("pieceClasses",a.getPieceClasses(n,o,s)),w("transform",a.getTranslationAtXYZ(n,o,s+1))}}const JJ=r=>[r];function bFe(r,e){if(1&r){const t=de();N(),M(0,"g",9),W("click",function(){te(t);const i=p().index,o=p().index;return ne(p(2).onClick(i,o))}),P()}if(2&r){const t=p().index,n=p().index,i=p().index,o=p();Hr("id","dropped_piece_",t,"_",n,"_",i,""),v("mode",o.mode)("coord",o.Coord3D.of(t,n,i))("pieceClasses",Oa(7,JJ,o.currentOpponentClass)),w("transform",o.getTranslationAtXYZ(t,n,i+1))}}function wFe(r,e){if(1&r&&(N(),M(0,"g"),z(1,AFe,1,9,"g",6)(2,bFe,1,9,"g",7),P()),2&r){const t=e.$implicit;m(),v("ngIf",t.move.isPresent()),m(),v("ngIf",t.isDroppedPiece)}}function NFe(r,e){if(1&r&&(N(),M(0,"g"),z(1,wFe,3,2,"g",1),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function IFe(r,e){if(1&r&&(N(),M(0,"g"),z(1,NFe,2,1,"g",1),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}const kFe=()=>["player0-fill"];function RFe(r,e){if(1&r){const t=de();N(),M(0,"g",10),W("click",function(){return te(t),ne(p().switchToMode("3D"))}),P()}if(2&r){const t=p();v("mode",t.TrexoComponent.modeMap["3D"])("coord",t.Coord3D.of(10.5,8.5,0))("pieceClasses",ur(4,kFe)),w("transform",t.get3DSwitcherTransform())}}function xFe(r,e){if(1&r){const t=de();N(),M(0,"g",11),W("click",function(){return te(t),ne(p().switchToMode("2D"))}),P()}if(2&r){const t=p();v("mode",t.TrexoComponent.modeMap["2D"])("coord",t.Coord3D.of(12,9,0))("pieceClasses",Oa(4,JJ,t.currentPlayerClass)),w("transform",t.getTranslationAtXYZ(12,9,0))}}class s1 extends yJ{static STROKE_WIDTH;static INITIAL_PIECE_ON_BOARD={isDroppedPiece:!1,isPossibleClick:!1,move:h.empty()};static modeMap={"2D":{offsetRatio:0,horizontalWidthRatio:1,pieceHeightRatio:0,parallelogramHeight:100,abstractBoardSize:10},"3D":{offsetRatio:.4,horizontalWidthRatio:1.2,pieceHeightRatio:.2,parallelogramHeight:100,abstractBoardSize:10}};TrexoComponent=s1;left=-this.STROKE_WIDTH/2;Coord3D=wd;up=0;width;height;mode;chosenMode="3D";victoryCoords=[];lastMoved=[];droppedPiece=h.empty();possibleNextClicks=[];possibleMoves=[];pieceOnBoard=[];currentOpponentClass="player1";currentPlayerClass="player0";constructor(e){super(e),this.setRulesAndNode("Trexo"),this.availableAIs=[new cn($localize`Alignment`,this.rules,new SFe,new QJ),new kn($localize`MCTS`,new QJ,this.rules)],this.encoder=bs.encoder,s1.STROKE_WIDTH=this.STROKE_WIDTH,this.switchToMode("3D")}switchToMode(e){this.chosenMode=e,this.width=this.getViewBoxWidth(),this.up=this.getViewBoxUp(),this.height=this.getViewBoxHeight(),this.mode=s1.modeMap[e]}getViewBoxWidth(){const e=s1.modeMap["3D"],t=e2.SIZE;return"2D"===this.chosenMode?(t+1)*this.SPACE_SIZE+2*this.STROKE_WIDTH:t*(this.SPACE_SIZE*(e.horizontalWidthRatio+e.offsetRatio))+this.STROKE_WIDTH}getViewBoxHeight(){const t=e2.SIZE*this.SPACE_SIZE;return"2D"===this.chosenMode?t:this.STROKE_WIDTH+t+this.getHigherStackHeight()}getViewBoxUp(){if("2D"===this.chosenMode)return 0;{const e=this.getHigherStackHeight();return-(this.STROKE_WIDTH/2+e)}}getHigherStackHeight(){return(this.pieceOnBoard.length+1)*s1.modeMap[this.chosenMode].pieceHeightRatio*this.SPACE_SIZE}updateBoard(e){var t=this;return E(function*(){const n=t.getState();t.board=n.getCopiedBoard(),t.currentOpponentClass=t.getPlayerClass(n.getCurrentOpponent()),t.currentPlayerClass=t.getPlayerClass(n.getCurrentPlayer()),t.possibleMoves=t.rules.getLegalMoves(n),t.victoryCoords=eo.getVictoriousCoords(n),t.pieceOnBoard=t.get3DBoard(),t.height=t.getViewBoxHeight(),t.up=t.getViewBoxUp()})()}showLastMove(e,t){var n=this;return E(function*(){n.lastMoved=[e.getZero(),e.getOne()]})()}hideLastMove(){this.lastMoved=[]}get3DBoard(){const e=HIe.create(1,e2.SIZE,e2.SIZE,s1.INITIAL_PIECE_ON_BOARD);let t=1;for(let n=0;n<=t;n++)for(const i of this.getState().toMap()){const o=i.key,s=i.value.getHeight();if(t=Math.max(t,s),n<s){const a=this.extractMoveFromState(o.x,o.y,n);this.addMoveToArray(n,a,e)}}return e}extractMoveFromState(e,t,n){const i=this.getState().getPieceAtXYZ(e,t,n),o=new _(e,t);let s=new _(-2,-2);for(const a of me.ORTHOGONALS){const c=o.getNext(a);if(e2.isOnBoard(c)){const l=this.getState().getPieceAt(c);l.getHeight()>n&&l.getPieceAt(n).tileId===i.tileId&&(s=c)}}return i.owner===O.ZERO?bs.from(o,s).get():bs.from(s,o).get()}addMoveToArray(e,t,n){for(;n.length<=e;)n.push(it.create(e2.SIZE,e2.SIZE,s1.INITIAL_PIECE_ON_BOARD));n[e][t.getZero().y][t.getZero().x]={isDroppedPiece:!1,isPossibleClick:!1,move:h.of(t)},n[e][t.getOne().y][t.getOne().x]={isDroppedPiece:!1,isPossibleClick:!1,move:h.of(t)}}onClick(e,t){var n=this;return E(function*(){const i=yield n.canUserPlay("#space_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const o=new _(e,t);if(n.droppedPiece.isPresent()){const s=n.droppedPiece.get();if(n.droppedPiece.equalsValue(o))return yield n.cancelMoveAttempt(),A.SUCCESS;if(n.possibleNextClicks.some(a=>a.equals(o))){const a=n.getState().getCurrentPlayer()===O.ZERO,u=bs.from(a?o:s,a?s:o).get();return n.chooseMove(u)}n.deselectPiece()}return n.selectPiece(o)})()}deselectPiece(){const e=this.getState().getPieceAt(this.droppedPiece.get()).getHeight(),t=this.droppedPiece.get().y,n=this.droppedPiece.get().x;this.pieceOnBoard[e][t][n]=s1.INITIAL_PIECE_ON_BOARD;for(const i of this.possibleNextClicks)this.pieceOnBoard[e][i.y][i.x].isPossibleClick=!1}selectPiece(e){var t=this;return E(function*(){if(t.possibleMoves.some(n=>n.getZero().equals(e))){const n=t.getState().getPieceAt(e).getHeight();return t.pieceOnBoard.length<=n&&t.pieceOnBoard.push(it.create(e2.SIZE,e2.SIZE,s1.INITIAL_PIECE_ON_BOARD)),t.showDroppedPieceAndIndicators(e,n),A.SUCCESS}return t.cancelMove(rv.NO_WAY_TO_DROP_IT_HERE())})()}showDroppedPieceAndIndicators(e,t){this.droppedPiece=h.of(e),this.possibleNextClicks=this.getPossibleNextClicks(e);for(const n of this.possibleNextClicks)this.pieceOnBoard[t][n.y][n.x]={isDroppedPiece:!1,isPossibleClick:!0,move:h.empty()};this.pieceOnBoard[t][e.y][e.x]={isDroppedPiece:!0,isPossibleClick:!1,move:h.empty()}}getPossibleNextClicks(e){return this.possibleMoves.filter(n=>n.getZero().equals(e)).map(n=>n.getOne())}cancelMoveAttempt(){var e=this;return E(function*(){e.droppedPiece=h.empty(),e.possibleNextClicks=[],yield e.updateBoard(!1)})()}getPieceClasses(e,t,n){const i=new _(e,t),o=this.getState().getPieceAtXYZ(e,t,n).owner;let s=[this.getPlayerClass(o)];return s=s.concat(this.getSpaceClasses(e,t)),this.victoryCoords.some(a=>a.equals(i))&&s.push("victory-stroke"),this.lastMoved.some(a=>a.equals(i))&&s.push("last-move-stroke"),s}getSpaceClasses(e,t){for(const n of this.pieceOnBoard)if(n[t][e].isPossibleClick)return["darker"];return[]}getTranslationAtXYZ(e,t,n){const o=this.getCoordTranslation(e,t,n,s1.modeMap[this.chosenMode]);return"translate("+o.x+" "+o.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForTrexo().map(t=>t.x+" "+t.y).join(" ")}getParallelogramCoordsForTrexo(){return this.getParallelogramCoords(s1.modeMap[this.chosenMode])}get3DSwitcherTransform(){const e=s1.modeMap["3D"],t=e.horizontalWidthRatio+e.offsetRatio;return"translate("+(10+e.offsetRatio)*e.parallelogramHeight+", "+(9+(1-1/t)/2)*e.parallelogramHeight+") scale("+1/t+")"}static \u0275fac=function(t){return new(t||s1)(G(Ut))};static \u0275cmp=$e({type:s1,selectors:[["app-trexo"]],features:[We],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%"],[4,"ngFor","ngForOf"],["switchModeIndicator",""],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click",4,"ngIf","ngIfElse"],["switchTo2D",""],[1,"base",3,"id","ngClass","click"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click"],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click"],["mgp-trexo-half-piece","","id","switchTo2D",3,"mode","coord","pieceClasses","click"]],template:function(t,n){if(1&t&&(N(),M(0,"svg",0),z(1,TFe,2,1,"g",1)(2,IFe,2,1,"g",1),M(3,"g",null,2),z(5,RFe,1,5,"g",3)(6,xFe,1,6,"ng-template",null,4,wn),P()()),2&t){const i=Pn(7);w("viewBox",n.left+" "+n.up+" "+n.width+" "+n.height),m(),v("ngForOf",n.board),m(),v("ngForOf",n.pieceOnBoard),m(3),v("ngIf","2D"===n.chosenMode)("ngIfElse",i)}},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}const Q=hi.EMPTY,eee=hi.of([new w2(O.ONE,0)]),LFe=hi.of([new w2(O.ZERO,0)]),zFe=hi.of([new w2(O.ONE,1)]),tee=hi.of([new w2(O.ZERO,1)]),DFe=hi.of([new w2(O.ZERO,2)]),VFe=hi.of([new w2(O.ONE,2)]),HFe=hi.of([new w2(O.ZERO,0),new w2(O.ZERO,3)]),FFe=hi.of([new w2(O.ONE,1),new w2(O.ONE,3)]),UFe=hi.of([new w2(O.ZERO,4)]),$Fe=hi.of([new w2(O.ONE,4)]),GFe=hi.of([new w2(O.ZERO,5)]),BFe=hi.of([new w2(O.ONE,5)]),WFe=hi.of([new w2(O.ONE,6)]),qFe=hi.of([new w2(O.ZERO,6)]);class jFe extends Bn{tutorial=[q.informational($localize`Goal of the game`,$localize`At Trexo, the goal of the game is to align 5 pieces of your color in a vertical, horizontal or diagonal line. However, the players play with tiles that are constituted of two pieces, one from each player!`,eo.get().getInitialState()),q.anyMove($localize`Dropping a tile`,$localize`When you drop a tile, it needs to be on even ground, and it cannot be right on top of another tile. In others words, it needs to be either on the floor, or on two tiles at the same height. To drop a tile, just click on the square where you want to put the opponent side of the tile, then on the neighboring square where you want to put your piece.<br/><br/>You're playing Dark, put a tile on the board.`,eo.get().getInitialState(),bs.from(new _(4,4),new _(3,4)).get(),pe.CONGRATULATIONS()),q.fromMove($localize`Dropping a piece over other pieces`,$localize`You can put a tile on other tiles. For that you must respect two rules:<br/><ul><li>The two pieces must be at the same height.</li><li>You cannot drop your piece on only one other piece.</li></ul><br/>You're playing Dark, do such a move!`,new e2([[Q,Q,Q,eee,LFe,tee,zFe,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q]],7),[bs.from(new _(4,0),new _(5,0)).get(),bs.from(new _(5,0),new _(4,0)).get()],pe.CONGRATULATIONS(),$localize`Failed, you put that piece on the floor level, please put it on top of two pieces.`),q.fromPredicate($localize`Victory`,$localize`To win at Trexo, you need to align 5 of your pieces. Only the piece on top counts, the hidden piece are no longer threats, and a victory can include pieces on differents heights. Since you have to put the piece of your opponent first, if you create a victory for them, you lose, even if you aligned 5 of your pieces too.<br/><br/>You're playing Light, win.`,new e2([[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,GFe,Q,Q,Q,Q,Q,Q],[Q,Q,Q,BFe,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,eee,Q,Q,UFe,$Fe,Q],[Q,Q,Q,Q,HFe,FFe,tee,Q,Q,Q],[Q,Q,Q,Q,Q,DFe,WFe,qFe,Q,Q],[Q,Q,Q,Q,Q,VFe,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q]],7),bs.from(new _(2,0),new _(2,1)).get(),(e,t,n)=>eo.TREXO_HELPER.getSquareScore(n,e.getOne())===Number.MAX_SAFE_INTEGER?A.SUCCESS:A.failure(pe.FAILED_TRY_AGAIN()),pe.CONGRATULATIONS_YOU_WON())]}class Wo{static PLACEMENT_AFTER_INITIAL_PHASE=()=>$localize`You cannot put a new ring after the tenth turn.`;static NO_MARKERS_IN_INITIAL_PHASE=()=>$localize`You cannot put a marker in a ring before placing all of your rings.`;static MISSING_CAPTURES=ia.MISSING_CAPTURES;static MOVE_DIRECTION_INVALID=()=>$localize`The direction of your move is invalid: a move is made along a straight line.`;static CAN_ONLY_CAPTURE_YOUR_MARKERS=()=>$localize`You can only capture your own markers.`;static SHOULD_SELECT_PLAYER_RING=()=>$localize`You must pick one of your own rings to move.`;static SHOULD_END_MOVE_ON_EMPTY_SPACE=()=>$localize`Your ring must land on an empty space.`;static MOVE_SHOULD_NOT_PASS_ABOVE_RING=()=>$localize`A ring can only jump over markers or empty spaces, not over another ring.`;static MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=()=>$localize`Your ring must land on the first empty space after a group of markers.`;static AMBIGUOUS_CAPTURE_COORD=ia.AMBIGUOUS_CAPTURE_COORD;static CAPTURE_SHOULD_TAKE_RING=()=>$localize`When you capture markers, you must take one of your ring as well by clicking on it.`}class xt{player;isRing;static encoder=ke.tuple([B.encoder,ke.identity()],e=>[e.player,e.isRing],e=>xt.of(e[0],e[1]));static UNREACHABLE=new xt(B.NONE,!1);static EMPTY=new xt(B.NONE,!1);static MARKER_ZERO=new xt(O.ZERO,!1);static MARKER_ONE=new xt(O.ONE,!1);static MARKERS=J3.ofValues(xt.MARKER_ZERO,xt.MARKER_ONE);static RING_ZERO=new xt(O.ZERO,!0);static RING_ONE=new xt(O.ONE,!0);static RINGS=J3.ofValues(xt.RING_ZERO,xt.RING_ONE);static of(e,t){if(e===B.NONE)return xt.EMPTY;{const n=e;return t?xt.RINGS.get(n):xt.MARKERS.get(n)}}constructor(e,t){this.player=e,this.isRing=t}equals(e){return this===e}flip(){return hn(!1===this.isRing,"cannot flip a ring (it should never happen)"),hn(this.player.isPlayer(),"cannot flip a non-player piece"),xt.of(this.player.getOpponent(),this.isRing)}toString(){switch(this){case xt.UNREACHABLE:return"NONE";case xt.EMPTY:return"EMPTY";case xt.MARKER_ZERO:return"MARKER_ZERO";case xt.MARKER_ONE:return"MARKER_ONE";case xt.RING_ZERO:return"RING_ZERO";default:return L.expectToBe(this,xt.RING_ONE),"RING_ONE"}}}let Xa=(()=>{class r extends xI{sideRings;static SIZE=11;constructor(t,n,i){super(i,t,r.SIZE,r.SIZE,[6,4,3,2,1],xt.EMPTY),this.sideRings=n}isInitialPlacementPhase(){return this.turn<10}countScores(){return this.turn<10?we.of(0,0):this.sideRings}equals(t){return this===t||this.turn===t.turn&&!1!==this.sideRings.equals(t.sideRings)&&it.compare(this.board,t.board)}getRingCoords(t){const n=[];return this.forEachCoord((i,o)=>{o.isRing&&o.player===t&&n.push(i)}),n}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==xt.UNREACHABLE}setAtUnsafe(t,n){const i=it.copy(this.board);return i[t.y][t.x]=n,new r(i,this.sideRings,this.turn)}}return r})();class Qa extends Ki{static encoder=ke.tuple([ke.list(_.encoder),h.getEncoder(_.encoder)],e=>[e.capturedSpaces,e.ringTaken],e=>new Qa(e[0],e[1]));static of(e,t,n){const i=[],o=Se.factory.fromMove(e,t).get();for(let s=e;!1===s.equals(t);s=s.getNext(o))i.push(s);return i.push(t),new Qa(i,n)}ringTaken;constructor(e,t=h.empty()){if(super(e),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");this.ringTaken=t}setRingTaken(e){return new Qa(this.capturedSpaces,h.of(e))}equals(e){return!(!1===super.equals(e)||!1===this.ringTaken.equals(e.ringTaken))}}class c3 extends C2{initialCaptures;start;end;finalCaptures;static encoder=ke.tuple([ke.list(Qa.encoder),_.encoder,h.getEncoder(_.encoder),ke.list(Qa.encoder)],e=>[e.initialCaptures,e.start,e.end,e.finalCaptures],e=>new c3(e[0],e[1],e[2],e[3]));constructor(e,t,n,i){super(),this.initialCaptures=e,this.start=t,this.end=n,this.finalCaptures=i}isInitialPlacement(){return this.end.isAbsent()}equals(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===yt.equals(this.initialCaptures,e.initialCaptures)||!1===yt.equals(this.finalCaptures,e.finalCaptures))}toString(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}}class ZFe extends or{getMetrics(e,t){return e.gameState.sideRings.toTable()}}class YFe{static getCombinations(e,t){return hn(t<=e.length,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(n=>this.getPermutations(n)).reduce((n,i)=>n.concat(i))}static getPermutations(e){const t=e.length,n=[e.slice()],i=new Array(t).fill(0);let o=1;for(;o<t;)if(i[o]<o){const s=o%2&&i[o],a=e[o];e[o]=e[s],e[s]=a,++i[o],o=1,n.push(e.slice())}else i[o]=0,++o;return n}static getSubsetsOfSize(e,t){return function n(i,o){if(e.length<=o||i<1)return[[]];{const s=[];for(;o<=e.length-i;){const a=e[o];for(const c of n(i-1,o+1))c.push(a),s.push(c);++o}return s}}(t,0)}}class l3 extends wr{static singleton=h.empty();static get(){return l3.singleton.isAbsent()&&(l3.singleton=h.of(new l3)),l3.singleton.get()}getInitialState(){const e=xt.EMPTY,t=xt.UNREACHABLE;return new Xa([[t,t,t,t,t,t,e,e,e,e,t],[t,t,t,t,e,e,e,e,e,e,e],[t,t,t,e,e,e,e,e,e,e,e],[t,t,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,t,t],[e,e,e,e,e,e,e,e,t,t,t],[e,e,e,e,e,e,e,t,t,t,t],[t,e,e,e,e,t,t,t,t,t,t]],we.of(5,5),0)}applyLegalMove(e,t,n,i){return new Xa(i.board,i.sideRings,i.turn+1)}applyCaptures(e,t){let n=t;return e.forEach(i=>{n=this.applyCapture(i,n)}),n}applyCapture(e,t){const n=this.applyCaptureWithoutTakingRing(t,e);return this.takeRing(new Xa(n,t.sideRings,t.turn),e.ringTaken.get())}takeRing(e,t){const n=e.getCurrentPlayer(),i=e.setAt(t,xt.EMPTY).board,o=e.sideRings.getCopy();return o.add(n,1),new Xa(i,o,e.turn)}applyCaptureWithoutTakingRing(e,t){return t.forEach(n=>{e=e.setAt(n,xt.EMPTY)}),e.board}ringSelectionValidity(e,t){const n=e.getCurrentPlayer();return e.getPieceAt(t)===xt.RINGS.get(n)?A.SUCCESS:A.failure(Wo.CAPTURE_SHOULD_TAKE_RING())}applyRingMoveAndFlip(e,t,n){const i=n.getCurrentPlayer();let o=n.setAt(e,xt.MARKERS.get(i));o=o.setAt(t,xt.RINGS.get(i));const s=Se.factory.fromMove(e,t).get();for(let a=e.getNext(s);!1===a.equals(t);a=a.getNext(s)){const c=o.getPieceAt(a);c!==xt.EMPTY&&(o=o.setAt(a,c.flip()))}return o}isLegal(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return X.failure(Wo.NO_MARKERS_IN_INITIAL_PHASE());const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toOtherFallible();const i=this.applyCaptures(e.initialCaptures,t),o=this.moveValidity(i,e.start,e.end.get());if(o.isFailure())return o.toOtherFallible();const s=this.applyRingMoveAndFlip(e.start,e.end.get(),i),a=this.capturesValidity(s,e.finalCaptures);if(a.isFailure())return a.toOtherFallible();const c=this.applyCaptures(e.finalCaptures,s),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toOtherFallible():X.success(c)}initialPlacementValidity(e,t){if(!1===e.isInitialPlacementPhase())return X.failure(Wo.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==xt.EMPTY)return X.failure(Me.MUST_CLICK_ON_EMPTY_SPACE());const n=e.getCurrentPlayer(),i=e.sideRings.getCopy();i.add(n,-1);const o=e.setAt(t,xt.of(n,!0)).board,s=new Xa(o,i,e.turn);return X.success(s)}moveStartValidity(e,t){const n=e.getCurrentPlayer();return e.getPieceAt(t)===xt.RINGS.get(n)?A.SUCCESS:A.failure(Wo.SHOULD_SELECT_PLAYER_RING())}moveValidity(e,t,n){const i=this.moveStartValidity(e,t);if(i.isFailure())return i;if(e.getPieceAt(n)!==xt.EMPTY)return A.failure(Wo.SHOULD_END_MOVE_ON_EMPTY_SPACE());const o=Se.factory.fromMove(t,n);if(o.isFailure())return A.failure(Wo.MOVE_DIRECTION_INVALID());const s=o.get();let a=!1;for(let c=t.getNext(s);!1===c.equals(n);c=c.getNext(s)){const l=e.getPieceAt(c);if(l===xt.EMPTY){if(a)return A.failure(Wo.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(l.isRing)return A.failure(Wo.MOVE_SHOULD_NOT_PASS_ABOVE_RING());a=!0}}return A.SUCCESS}capturesValidity(e,t){let n=e;for(const i of t){const o=this.captureValidity(n,i);if(o.isFailure())return o;n=this.applyCapture(i,n)}return A.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer();for(const i of t.capturedSpaces)if(e.getPieceAt(i)!==xt.MARKERS.get(n))return A.failure(Wo.CAN_ONLY_CAPTURE_YOUR_MARKERS());return e.getPieceAt(t.ringTaken.get())!==xt.RINGS.get(n)?A.failure(Wo.CAPTURE_SHOULD_TAKE_RING()):A.SUCCESS}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?A.SUCCESS:A.failure(Wo.MISSING_CAPTURES())}getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(i=>{const o=this.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,i);o.isPresent()&&n.push(o.get())}),n}getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,n){let i=0;const o=e.getEntranceOnLine(n),s=n.getDirection();let c,a=o;for(c=o;e.isOnBoard(c);c=c.getNext(s)){const l=e.getPieceAt(c);if(l.player===t&&!1===l.isRing)0===i&&(a=c),i+=1;else{if(5<=i)break;i=0}}return 5<=i?h.of({start:a,end:c,dir:s}):h.empty()}getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(i=>{for(let o=i.start;5<=o.getDistance(i.end);o=o.getNext(i.dir))n.push(Qa.of(o,o.getNext(i.dir,4)))}),n}getRingTargets(e,t){const n=[];for(const i of Se.factory.all){let o=!1;for(let s=t.getNext(i);e.isOnBoard(s);s=s.getNext(i)){const a=e.getPieceAt(s);if(a===xt.EMPTY){if(n.push(s),o)break}else{if(a.isRing)break;o=!0}}}return n}getGameStatus(e){return e.gameState.isInitialPlacementPhase()?ve.ONGOING:3<=e.gameState.sideRings.get(O.ZERO)?ve.ZERO_WON:3<=e.gameState.sideRings.get(O.ONE)?ve.ONE_WON:ve.ONGOING}}class nee extends Yn{getListMoves(e,t){const n=[],i=e.gameState;if(i.isInitialPlacementPhase())for(const{coord:o,content:s}of i.getCoordsAndContents())s===xt.EMPTY&&n.push(new c3([],o,h.empty(),[]));else{const o=l3.get();this.getPossibleCaptureCombinations(i).forEach(s=>{const a=o.applyCaptures(s,i);this.getRingMoves(a).forEach(c=>{const l=o.applyRingMoveAndFlip(c.start,c.end,a);this.getPossibleCaptureCombinations(l).forEach(u=>{const f=new c3(s,c.start,h.of(c.end),u);n.push(f)})})})}return n}getPossibleCaptureCombinations(e){const n=l3.get().getPossibleCaptures(e),i=this.getRingCoords(e);return OC.getPossibleCaptureCombinationsFromPossibleCaptures(n).map(o=>YFe.getCombinations(i,o.length).map(s=>o.map((a,c)=>new Qa(a.capturedSpaces,h.of(s[c]))))).reduce((o,s)=>o.concat(s),[])}getRingMoves(e){const t=l3.get(),n=[];for(const i of this.getRingCoords(e))for(const o of t.getRingTargets(e,i))n.push({start:i,end:o});return n}getRingCoords(e){const t=e.getCurrentPlayer(),n=[];return e.forEachCoord((i,o)=>{o===xt.RINGS.get(t)&&n.push(i)}),n}}function KFe(r,e){if(1&r&&(N(),V(0,"circle",12)),2&r){const t=p(2).$implicit,n=p(2);w("cx",t.center.x)("cy",t.center.y)("r",n.viewInfo.ringOuterSize)}}function XFe(r,e){if(1&r&&(N(),V(0,"circle",13)),2&r){const t=p(2),n=t.index,i=t.$implicit,o=p().index,s=p();Ce("id","ring_",n,"_",o,""),v("ngClass",i.ringClasses),w("cx",i.center.x)("cy",i.center.y)("r",s.viewInfo.ringMidSize)}}function QFe(r,e){if(1&r&&(N(),V(0,"circle",12)),2&r){const t=p(2).$implicit,n=p(2);w("cx",t.center.x)("cy",t.center.y)("r",n.viewInfo.ringInnerSize)}}function JFe(r,e){if(1&r&&(N(),V(0,"circle",14)),2&r){const t=p(2),n=t.index,i=t.$implicit,o=p().index,s=p();Ce("id","marker_",n,"_",o,""),v("ngClass",i.markerClasses),w("cx",i.center.x)("cy",i.center.y)("r",s.viewInfo.markerSize)}}function eUe(r,e){if(1&r){const t=de();N(),M(0,"g",6),W("click",function(){te(t);const i=p().$implicit;return ne(p(2).onClick(i.coord))}),V(1,"polygon",7),M(2,"g",8),z(3,KFe,1,3,"circle",9)(4,XFe,1,6,"circle",10)(5,QFe,1,3,"circle",9)(6,JFe,1,6,"circle",11),P()()}if(2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();Ce("id","click_",n,"_",o,""),m(),Ce("id","space_",n,"_",o,""),v("ngClass",s.getSpaceClasses(n,o)),w("points",i.coordinates)("transform",s.getHexaCenterTranslationAtXY(n,o)),m(),Ce("id","pieceGroup_",n,"_",o,""),v("ngClass",i.removedClass),m(),v("ngIf",i.isRing),m(),v("ngIf",i.isRing),m(),v("ngIf",i.isRing),m(),v("ngIf",i.isMarker)}}function tUe(r,e){if(1&r&&(N(),M(0,"g"),z(1,eUe,7,14,"g",5),P()),2&r){const t=e.$implicit;m(),v("ngIf",null!=t)}}function nUe(r,e){if(1&r&&(N(),M(0,"g"),z(1,tUe,2,1,"g",1),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}function rUe(r,e){if(1&r){const t=de();N(),M(0,"polygon",15),W("click",function(){const o=te(t).$implicit;return ne(p().onClick(o))}),P()}if(2&r){const t=e.$implicit,n=p();Ce("id","selected_",t.x,"_",t.y,""),w("points",n.viewInfo.spaceInfo[t.y][t.x].coordinates)}}function iUe(r,e){if(1&r){const t=de();N(),M(0,"polygon",17),W("click",function(){const o=te(t).$implicit;return ne(p(2).onClick(o))}),P()}if(2&r){const t=e.$implicit,n=p(2);Ce("id","selectable_",t.x,"_",t.y,""),w("points",n.viewInfo.spaceInfo[t.y][t.x].coordinates)}}function oUe(r,e){if(1&r&&(N(),M(0,"g"),z(1,iUe,1,3,"polygon",16),P()),2&r){const t=p();m(),v("ngForOf",t.viewInfo.selectableCoords)}}function sUe(r,e){if(1&r){const t=de();N(),M(0,"rect",18),W("click",function(){const o=te(t).$implicit;return ne(p().onClick(o))}),P()}if(2&r){const t=e.$implicit,n=p();Ce("id","indicator_",t.x,"_",t.y,""),w("x",n.viewInfo.spaceInfo[t.y][t.x].center.x-n.viewInfo.indicatorSize/2)("y",n.viewInfo.spaceInfo[t.y][t.x].center.y-n.viewInfo.indicatorSize/2)("width",n.viewInfo.indicatorSize)("height",n.viewInfo.indicatorSize)}}function aUe(r,e){if(1&r&&(N(),M(0,"g"),V(1,"circle",19)(2,"circle",12)(3,"circle",20),P()),2&r){const t=e.index,n=p().$implicit,i=p();m(),Ce("id","player_",n.getValue(),"_sideRing_",t+1,""),w("cx",(n===i.Player.ZERO?15:1050)+1.2*(n===i.Player.ZERO?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",n===i.Player.ZERO?300:1260)("r",i.viewInfo.ringOuterSize),m(),w("cx",(n===i.Player.ZERO?15:1050)+1.2*(n===i.Player.ZERO?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",n===i.Player.ZERO?300:1260)("r",i.viewInfo.ringInnerSize),m(),v("ngClass",i.viewInfo.sideRingClass.get(n)),w("cx",(n===i.Player.ZERO?15:1050)+1.2*(n===i.Player.ZERO?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",n===i.Player.ZERO?300:1260)("r",i.viewInfo.ringMidSize)}}const cUe=()=>[];function lUe(r,e){if(1&r&&(N(),M(0,"g"),z(1,aUe,4,12,"g",1),P()),2&r){const t=e.$implicit,n=p();w("transform","rotate("+180*(n.getPointOfView().getValue()+1)+" 532.5 780)"),m(),v("ngForOf",ur(2,cUe).constructor(n.viewInfo.sideRings.get(t)))}}class ga extends J5{static RING_OUTER_SIZE=40;static RING_MID_SIZE=34;static RING_INNER_SIZE=28;static MARKER_SIZE=ga.RING_INNER_SIZE;static INDICATOR_SIZE=10;constructedState;movePhase="MOVE_START";lastMoved=[];lastCaptured=[];moveStart=h.empty();moveEnd=h.empty();currentlyMoved=[];currentCapture=h.empty();initialCaptures=[];finalCaptures=[];possibleCaptures=[];viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:ga.MARKER_SIZE,ringOuterSize:ga.RING_OUTER_SIZE,ringMidSize:ga.RING_MID_SIZE,ringInnerSize:ga.RING_INNER_SIZE,indicatorSize:ga.INDICATOR_SIZE,sideRings:we.of(5,5),sideRingClass:J3.ofValues("player0-stroke","player1-stroke")};constructor(e){super(e),this.setRulesAndNode("Yinsh"),this.availableAIs=[new cn($localize`Score`,this.rules,new ZFe,new nee),new kn($localize`MCTS`,new nee,this.rules)],this.encoder=c3.encoder,this.scores=h.of(we.of(0,0)),this.hexaLayout=new eu(1.5*ga.RING_OUTER_SIZE,new _(2*ga.RING_OUTER_SIZE,0),jr.INSTANCE),this.constructedState=this.getState(),this.constructedState.allCoords().forEach(t=>{null==this.viewInfo.spaceInfo[t.y]&&(this.viewInfo.spaceInfo[t.y]=[]),this.viewInfo.spaceInfo[t.y][t.x]={coord:t,coordinates:this.getHexaPoints(),center:this.getCenterAt(t),markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}})}updateBoard(e){var t=this;return E(function*(){const n=t.getState();t.constructedState=n,t.scores=h.of(n.countScores()),t.moveToInitialCaptureOrMovePhase()})()}updateViewInfo(){switch(this.constructedState.allCoords().forEach(e=>{const t=this.constructedState.getPieceAt(e);this.viewInfo.spaceInfo[e.y][e.x].removedClass="",this.setRingInfo(e,t),this.setMarkerInfo(e,t)}),this.viewInfo.sideRings=this.constructedState.sideRings,this.showCurrentMoveCaptures(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];for(const e of this.possibleCaptures)for(const t of e.capturedSpaces)this.viewInfo.selectableCoords.push(t);break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.getState().isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}showCurrentMoveCaptures(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());for(const e of this.initialCaptures)this.markCurrentCapture(e);for(const e of this.finalCaptures)this.markCurrentCapture(e)}getSpaceClasses(e,t){const n=new _(e,t);return this.currentlyMoved.concat(this.lastMoved).some(i=>i.equals(n))?["moved-fill"]:this.lastCaptured.some(i=>i.equals(n))?["captured-fill"]:[]}setRingInfo(e,t){t.isRing?(this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=["player"+t.player.getValue()+"-stroke"]):(this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[])}setMarkerInfo(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==xt.EMPTY&&(!1===t.isRing||this.moveStart.equalsValue(e))){const i=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[i]}}cancelMoveAttempt(){this.constructedState=this.getState(),this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=h.empty(),this.moveStart=h.empty(),this.moveEnd=h.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}showLastMove(e){var t=this;return E(function*(){if(e.isInitialPlacement())t.lastMoved=[e.start];else{t.lastMoved=t.coordsBetween(e.start,e.end.get());const n=t.currentCapture.isAbsent()&&0===t.initialCaptures.length&&t.moveStart.isAbsent();t.lastCaptured=[],e.initialCaptures.forEach(i=>t.showLastMoveCapture(i,n)),e.finalCaptures.forEach(i=>t.showLastMoveCapture(i,n))}})()}hideLastMove(){this.lastMoved=[],this.lastCaptured=[]}coordsBetween(e,t){return e.getAllCoordsToward(t)}showLastMoveCapture(e,t){for(const n of e.capturedSpaces)this.lastCaptured.push(n),t&&this.markRemovedMarker(n,this.getState().getCurrentOpponent());this.lastCaptured.push(e.ringTaken.get()),t&&this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentOpponent())}moveToInitialCaptureOrMovePhase(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),A.SUCCESS}onClick(e){var t=this;return E(function*(){const n=yield t.canUserPlay("#click_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());switch(t.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_FIRST":return t.selectCaptureFirstCoord(e);case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_LAST":return t.selectCaptureLastCoord(e);case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":return t.selectRing(e);case"MOVE_START":return t.selectMoveStart(e);case"MOVE_END":return t.selectMoveEnd(e)}})()}selectCaptureFirstCoord(e){var t=this;return E(function*(){const n=[];if(t.possibleCaptures.forEach(i=>{i.contains(e)&&n.push(i)}),n.length>1)t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(n);else{if(0===n.length)return t.cancelMove(Wo.MISSING_CAPTURES());t.selectCapture(n[0])}return A.SUCCESS})()}moveToCaptureSelectLast(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;for(const t of e)for(const n of t.capturedSpaces)this.viewInfo.selectableCoords.push(n);"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(L.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}selectCaptureLastCoord(e){var t=this;return E(function*(){const n=[];return t.possibleCaptures.forEach(i=>{i.contains(e)&&n.push(i)}),n.length>1?t.cancelMove(Wo.AMBIGUOUS_CAPTURE_COORD()):0===n.length?t.cancelMove(Wo.MISSING_CAPTURES()):t.selectCapture(n[0])})()}selectCapture(e){return this.currentCapture=h.of(e),this.constructedState=new Xa(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(hn("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),A.SUCCESS}markCurrentCapture(e){for(const t of e.capturedSpaces)this.viewInfo.selectedCoords.push(t),this.markRemovedMarker(t,this.getState().getCurrentPlayer());e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentPlayer()))}markRemovedMarker(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setMarkerInfo(e,xt.MARKERS.get(t))}markRemovedRing(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setRingInfo(e,xt.RINGS.get(t))}selectRing(e){var t=this;return E(function*(){const n=t.rules.ringSelectionValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.constructedState=t.rules.takeRing(t.constructedState,e);const i=t.currentCapture.get().setRingTaken(e);return"INITIAL_CAPTURE_SELECT_RING"===(t.currentCapture=h.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase)?(t.initialCaptures.push(i),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),A.SUCCESS)):(L.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(i),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),A.SUCCESS))})()}moveToMovePhase(){return this.movePhase="MOVE_START",this.updateViewInfo(),A.SUCCESS}tryMove(){var e=this;return E(function*(){const t=new c3(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures);return yield e.chooseMove(t)})()}selectMoveStart(e){var t=this;return E(function*(){if(t.constructedState.isInitialPlacementPhase()){const n=t.rules.initialPlacementValidity(t.constructedState,e);return n.isFailure()?t.cancelMove(n.getReason()):(t.moveStart=h.of(e),t.tryMove())}{const n=t.rules.moveStartValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.moveStart=h.of(e),t.movePhase="MOVE_END",t.updateViewInfo()}return A.SUCCESS})()}selectMoveEnd(e){var t=this;return E(function*(){if(t.moveStart.equalsValue(e))return t.cancelMoveAttempt(),A.SUCCESS;const n=xt.RINGS.get(t.getState().getCurrentPlayer());if(t.constructedState.getPieceAt(e)===n)return t.cancelMoveAttempt(),t.selectMoveStart(e);const i=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e);return i.isFailure()?t.cancelMove(i.getReason()):(t.moveEnd=h.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.moveStart.get(),e,t.constructedState),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove())})()}moveToFinalCapturePhaseOrTryMove(){var e=this;return E(function*(){return e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),A.SUCCESS)})()}static \u0275fac=function(t){return new(t||ga)(G(Ut))};static \u0275cmp=$e({type:ga,selectors:[["app-yinsh"]],features:[We],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected-stroke",3,"id","click"],["class","base no-fill capturable-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable-stroke",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(t,n){1&t&&(N(),M(0,"svg",0),z(1,nUe,2,1,"g",1)(2,rUe,1,3,"polygon",2)(3,oUe,2,1,"g",3)(4,sUe,1,6,"rect",4)(5,lUe,2,3,"g",1),P()),2&t&&(m(),v("ngForOf",n.viewInfo.spaceInfo),m(),v("ngForOf",n.viewInfo.selectedCoords),m(),v("ngIf",n.isPlayerTurn()),m(),v("ngForOf",n.viewInfo.targets),m(),v("ngForOf",n.Player.PLAYERS))},dependencies:[zt,Nt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}const D=xt.EMPTY,fe=xt.UNREACHABLE,t2=xt.MARKER_ZERO,to=xt.RING_ZERO,u3=xt.MARKER_ONE,xi=xt.RING_ONE;let ree=(()=>class r{static MUST_ALIGN_FIVE=()=>$localize`Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time.`;static MUST_CAPTURE_TWO=()=>$localize`Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again.`})();class uUe extends Bn{tutorial=[q.informational($localize`Goal of the game`,$localize`The goal at Yinsh is to capture three rings in total.
        The rings taken are shown on the top left for the dark player,
        and on the bottom right for the light player. Here, Dark won the game.
        Note that on the board you have two types of pieces for each player:
        rings (empty circles) and markers (full circles).`,new Xa([[fe,fe,fe,fe,fe,fe,D,D,D,D,fe],[fe,fe,fe,fe,D,D,D,D,D,D,D],[fe,fe,fe,t2,xi,D,D,D,D,D,D],[fe,fe,D,t2,D,xi,D,u3,D,D,D],[fe,D,to,u3,D,D,xi,t2,D,D,D],[fe,D,D,t2,u3,D,D,D,D,D,fe],[D,D,D,t2,D,D,D,xi,D,D,fe],[D,D,D,u3,t2,to,D,D,D,fe,fe],[D,D,D,D,D,D,D,D,fe,fe,fe],[D,D,D,D,D,D,D,fe,fe,fe,fe],[fe,D,D,D,D,fe,fe,fe,fe,fe,fe]],we.of(3,1),20)),q.anyMove($localize`Initial board and placement phase`,$localize`The initial board is empty.
        At the beginning of the game, each player puts one of its ring on the board at their turn.
        This phase stops when all rings have been placed on the board.<br/><br/>
        You're playing Dark, put one of your ring on the board by clicking the space where you want to place it.`,new Xa(l3.get().getInitialState().board,we.of(5,5),0),new c3([],new _(5,5),h.empty(),[]),pe.CONGRATULATIONS()),q.anyMove($localize`Putting a marker`,$localize`Once the initial phase is done and all rings are on the board, you need to place markers on the board.
        To do so, put a marker in a ring by clicking on that ring.
        Then, the ring must be moved in a straight line, in any direction.
        A ring cannot pass through other rings during its move.
        If it goes over a group of markers, your move must stop at the first empty space after that group.
        All markers in the group are then flipped and their color change.<br/><br/>
        You're playing Dark, do a move.`,new Xa([[fe,fe,fe,fe,fe,fe,D,D,D,D,fe],[fe,fe,fe,fe,D,D,D,D,D,D,D],[fe,fe,fe,xi,D,D,D,D,D,D,D],[fe,fe,xi,D,D,xi,D,D,D,D,D],[fe,D,to,u3,D,D,xi,D,D,D,D],[fe,D,D,u3,D,D,D,D,D,D,fe],[D,D,D,D,to,D,D,xi,D,D,fe],[D,D,D,D,D,to,D,D,D,fe,fe],[D,D,D,to,D,D,D,fe,fe,fe,fe],[D,D,D,D,D,D,D,fe,fe,fe,fe],[fe,D,D,D,D,fe,fe,fe,fe,fe,fe]],we.of(0,0),20),new c3([],new _(2,4),h.of(new _(4,4)),[]),pe.CONGRATULATIONS()),q.fromPredicate($localize`Getting a ring by aligning 5 markers`,$localize`Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.
        To do so, you need to align 5 markers of your color.
        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.
        You will then have one more point.
        You must capture when you can.<br/><br/>
        You're playing Dark, perform a capture!`,new Xa([[fe,fe,fe,fe,fe,fe,D,D,D,D,fe],[fe,fe,fe,fe,D,D,D,D,D,D,D],[fe,fe,fe,xi,D,D,D,D,D,D,D],[fe,fe,xi,D,D,xi,D,D,D,D,D],[fe,D,t2,t2,to,u3,u3,D,D,D,D],[fe,D,D,xi,D,D,D,D,D,D,fe],[D,D,D,D,to,D,D,xi,D,D,fe],[D,D,D,D,D,to,D,D,D,fe,fe],[D,D,D,to,D,D,D,to,fe,fe,fe],[D,D,D,D,D,D,D,fe,fe,fe,fe],[fe,D,D,D,D,fe,fe,fe,fe,fe,fe]],we.of(0,0),20),new c3([],new _(4,4),h.of(new _(7,4)),[Qa.of(new _(2,4),new _(6,4),h.of(new _(7,4)))]),(e,t,n)=>1===n.sideRings.get(O.ZERO)?A.SUCCESS:A.failure(ree.MUST_ALIGN_FIVE()),pe.CONGRATULATIONS()),q.fromPredicate($localize`Compound captures`,$localize`During a turn, you could have to choose between multiple captures,
        or you could even capture multiple times!
        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>
        Here, playing Dark, you can capture two rings, do it!`,new Xa([[fe,fe,fe,fe,fe,fe,D,D,D,D,fe],[fe,fe,fe,fe,to,D,D,xi,xi,to,D],[fe,fe,fe,to,D,D,u3,xi,D,to,D],[fe,fe,D,to,D,D,D,D,D,xi,D],[fe,D,D,D,D,t2,D,D,xi,D,D],[fe,D,D,D,t2,t2,D,u3,D,D,fe],[D,D,D,t2,D,t2,D,D,D,D,fe],[D,D,t2,D,D,t2,D,D,D,fe,fe],[D,t2,D,D,D,t2,D,D,fe,fe,fe],[D,D,D,D,D,t2,D,fe,fe,fe,fe],[fe,D,D,D,D,fe,fe,fe,fe,fe,fe]],we.of(0,0),10),new c3([Qa.of(new _(5,4),new _(1,8),h.of(new _(3,2))),Qa.of(new _(5,9),new _(5,5),h.of(new _(3,3)))],new _(4,1),h.of(new _(4,2)),[]),(e,t,n)=>2===n.sideRings.get(O.ZERO)?A.SUCCESS:A.failure(ree.MUST_CAPTURE_TWO()),pe.CONGRATULATIONS())]}function fUe(r,e){if(1&r&&(M(0,"option",5),st(1),P()),2&r){const t=e.$implicit;v("value",t.urlName),m(),mn(t.name)}}let Tn=(()=>class r{static ABALONE=()=>$localize`Use simple mechanics to push 6 of the opponent's pieces out of the board!`;static APAGOS=()=>$localize`Very simple game, but, will you be able to win everytime?`;static AWALE=()=>$localize`The most widespread of the Mancalas.`;static BA_AWA=()=>$localize`The most widespread multiple-lap Mancala.`;static BRANDHUB=()=>$localize`The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!`;static COERCEO=()=>$localize`Get rid of all of your opponent's pieces on a board that shrinks little by little!`;static CONNECT_SIX=()=>$localize`Put two pieces on the board at each turn, and be the first to align six pieces!`;static CONSPIRATEURS=()=>$localize`Hide all of your pieces before your opponent does, or risk to be discovered!`;static DIABALLIK=()=>$localize`Pass the ball up to the side of the opponent to win the game!`;static DIAM=()=>$localize`Drop your pieces and move them around to align two pieces of the same color across the board to win!`;static DVONN=()=>$localize`Stack your pieces and control as many stacks as you can to win!`;static ENCAPSULE=()=>$localize`An enhanced tic-tac-toe where piece can encapsule other and prevent them to win.`;static EPAMINONDAS=()=>$localize`An antiquity-war inspired game. Be the first to pierce your opponent's lines!`;static GIPF=()=>$localize`A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!`;static GO=()=>$localize`The oldest strategy game still practiced widely. A territory control game.`;static HIVE=()=>$localize`You are in charge of a hive full of insects. Use the abilities of your insects to block the opponent's queen in order to win!`;static HNEFATAFL=()=>$localize`The Viking board game! Invaders must capture the king, defender must make him escape!`;static KALAH=()=>$localize`A modern version of the famous African strategy game!`;static KAMISADO=()=>$localize`Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!`;static LASCA=()=>$localize`Similar to checkers, capture opponent's pieces, free your own, and immobilize your opponent to win the game!`;static LINES_OF_ACTION=()=>$localize`Regroup your pieces to win. But your possible moves will often change!`;static LODESTONE=()=>$localize`Push and crush your opponent's pieces using magnetic forces!`;static MARTIAN_CHESS=()=>$localize`Win points by capturing pieces, but you only control pieces on your side of the board!`;static P4=()=>$localize`The classical 4 in a row game!`;static PENTAGO=()=>$localize`Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!`;static PENTE=()=>$localize`You can align 5 pieces to win, or you can capture 10 pieces of your opponent to win!`;static PYLOS=()=>$localize`Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!`;static QUARTO=()=>$localize`Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!`;static QUIXO=()=>$localize`Align 5 of your pieces on a board where pieces slide!`;static REVERSI=()=>$localize`Sandwich your opponent's pieces to dominate the board!`;static SAHARA=()=>$localize`Immobilize one of your opponent's pyramids before your opponent does!`;static SIAM=()=>$localize`Be the first to push a mountain out of the board!`;static SIX=()=>$localize`Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!`;static TABLUT=()=>$localize`Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!`;static TEEKO=()=>$localize`Align your 4 pieces or form a square with them to win!`;static TREXO=()=>$localize`Align 5 pieces of your color in a row, but beware, the pieces can be put on top of other pieces!`;static YINSH=()=>$localize`Align your pieces to score points, but beware, pieces can flip!`})();class Vt{name;urlName;component;tutorial;rules;creationDate;description;display;static ALL_GAMES(){return[new Vt($localize`Four in a Row`,"P4",bDe,new wDe,Xc.get(),new Date("2018-08-28"),Tn.P4()),new Vt($localize`Awal`,"Awale",Pke,new Ske,Zs.get(),new Date("2018-11-29"),Tn.AWALE()),new Vt($localize`Quarto`,"Quarto",kVe,new UVe,Ri.get(),new Date("2018-12-09"),Tn.QUARTO()),new Vt($localize`Tablut`,"Tablut",mFe,new _Fe,a3.get(),new Date("2018-12-27"),Tn.TABLUT()),new Vt($localize`Reversi`,"Reversi",iHe,new sHe,m0.get(),new Date("2019-01-16"),Tn.REVERSI()),new Vt($localize`Go`,"Go",AC,new aLe,Ba.get(),new Date("2019-12-21"),Tn.GO()),new Vt($localize`Encapsule`,"Encapsule",bxe,new Rxe,lu.get(),new Date("2019-12-30"),Tn.ENCAPSULE()),new Vt($localize`Siam`,"Siam",ev,new $He,Q2.get(),new Date("2020-01-11"),Tn.SIAM()),new Vt($localize`Sahara`,"Sahara",MHe,new EHe,g4.get(),new Date("2020-02-29"),Tn.SAHARA()),new Vt($localize`Pylos`,"Pylos",aVe,new cVe,Qi.get(),new Date("2020-10-02"),Tn.PYLOS()),new Vt($localize`Kamisado`,"Kamisado",gze,new pze,A2.get(),new Date("2020-10-03"),Tn.KAMISADO()),new Vt($localize`Quixo`,"Quixo",ZVe,new KVe,Ji.get(),new Date("2020-10-15"),Tn.QUIXO()),new Vt($localize`Dvonn`,"Dvonn",yxe,new axe,Zr.get(),new Date("2020-10-21"),Tn.DVONN()),new Vt($localize`Epaminondas`,"Epaminondas",Bxe,new Wxe,wi.get(),new Date("2021-01-16"),Tn.EPAMINONDAS()),new Vt($localize`Gipf`,"Gipf",tLe,new vLe,nn.get(),new Date("2021-02-22"),Tn.GIPF()),new Vt($localize`Coerceo`,"Coerceo",ORe,new ARe,md.get(),new Date("2021-03-21"),Tn.COERCEO()),new Vt($localize`Six`,"Six",rFe,new iFe,s3.get(),new Date("2021-04-08"),Tn.SIX()),new Vt($localize`Lines of Action`,"LinesOfAction",kze,new Rze,ki.get(),new Date("2021-04-28"),Tn.LINES_OF_ACTION()),new Vt($localize`Pentago`,"Pentago",HDe,new FDe,wl.get(),new Date("2021-05-23"),Tn.PENTAGO()),new Vt($localize`Abalone`,"Abalone",ike,new Oke,qs.get(),new Date("2021-07-13"),Tn.ABALONE()),new Vt($localize`Yinsh`,"Yinsh",ga,new uUe,l3.get(),new Date("2021-07-31"),Tn.YINSH()),new Vt($localize`Apagos`,"Apagos",hke,new qIe,Va.get(),new Date("2021-11-04"),Tn.APAGOS()),new Vt($localize`Diam`,"Diam",c0,new sRe,r4.get(),new Date("2021-11-30"),Tn.DIAM()),new Vt($localize`Brandhub`,"Brandhub",Yke,new Kke,Gc.get(),new Date("2021-12-07"),Tn.BRANDHUB()),new Vt($localize`Conspirateurs`,"Conspirateurs",HRe,new iRe,Ho.get(),new Date("2021-12-30"),Tn.CONSPIRATEURS()),new Vt($localize`Lodestone`,"Lodestone",sa,new xze,fi.get(),new Date("2022-06-24"),Tn.LODESTONE()),new Vt($localize`Martian Chess`,"MartianChess",Po,new Kze,Ps.get(),new Date("2022-07-01"),Tn.MARTIAN_CHESS()),new Vt($localize`Hnefatafl`,"Hnefatafl",eze,new $Le,Yc.get(),new Date("2022-09-21"),Tn.HNEFATAFL()),new Vt($localize`Hive`,"Hive",_J,new ULe,Xi.get(),new Date("2023-04-02"),Tn.HIVE()),new Vt($localize`Trexo`,"Trexo",s1,new jFe,eo.get(),new Date("2023-04-23"),Tn.TREXO()),new Vt($localize`Lasca`,"Lasca",Pze,new Tze,Es.get(),new Date("2023-05-11"),Tn.LASCA()),new Vt($localize`Connect Six`,"ConnectSix",GQ,new rRe,mo.get(),new Date("2023-05-13"),Tn.CONNECT_SIX()),new Vt($localize`Pente`,"Pente",IJ,new WDe,Ss.get(),new Date("2023-05-20"),Tn.PENTE()),new Vt($localize`Teeko`,"Teeko",EFe,new PFe,ha.get(),new Date("2023-07-30"),Tn.TEEKO()),new Vt($localize`Kalah`,"Kalah",ize,new oze,Uo.get(),new Date("2023-09-07"),Tn.KALAH()),new Vt($localize`Diaballik`,"Diaballik",KRe,new XRe,Cs.get(),new Date("2023-11-18"),Tn.DIABALLIK()),new Vt($localize`Ba-awa`,"BaAwa",wke,new Nke,Fa.get(),new Date("2024-01-28"),Tn.BA_AWA())].sort((e,t)=>e.name.localeCompare(t.name))}static getByUrlName(e){const t=Vt.ALL_GAMES().filter(n=>n.urlName===e);return L.assert(t.length<=1,"There should only be one game matching $urlName!"),0===t.length?h.empty():h.of(t[0])}constructor(e,t,n,i,o,s,a,c=!0){this.name=e,this.urlName=t,this.component=n,this.tutorial=i,this.rules=o,this.creationDate=s,this.description=a,this.display=c}getRulesConfigDescription(){return this.rules.getRulesConfigDescription()}getRulesConfig(){const e=this.getRulesConfigDescription();return e.isPresent()?h.of(e.get().getDefaultConfig().config):h.empty()}}let nk=(()=>{class r{games=Vt.ALL_GAMES();pickGame=new l1;onChange(t){this.pickGame.emit(t.target.value)}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=$e({type:r,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:()=>{let t;return t=$localize`Pick a game`,[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],t,[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(n,i){1&n&&(M(0,"div",0)(1,"select",1),W("change",function(s){return i.onChange(s)}),M(2,"option",2),ae(3,3),P(),z(4,fUe,2,2,"option",4),P()()),2&n&&(m(4),v("ngForOf",i.games))},dependencies:[Nt,A8,b8],encapsulation:2})}return r})();class rk{static getGameDefaultConfig(e){const t=Vt.getByUrlName(e);return t.isPresent()?t.get().getRulesConfig():h.empty()}}let ik=class Nv extends t0{constructor(e){super("config-room",e)}static \u0275fac=function(t){return new(t||Nv)(Ae(pl))};static \u0275prov=xe({token:Nv,factory:Nv.\u0275fac,providedIn:"root"})};var ok;ik=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],ik);let Id=class Iv{static#e=ok=this;configRoomDAO;connectedUserService;static GAME_DOES_NOT_EXIST=()=>$localize`Game does not exist`;constructor(e,t){this.configRoomDAO=e,this.connectedUserService=t}addCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(t.id,t)}removeCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(t.id)}subscribeToChanges(e,t){return this.configRoomDAO.subscribeToChanges(e,t)}subscribeToCandidates(e,t){let n=[];const i=new pC(s=>{for(const a of s)n.push(a.data);t(n)},s=>{for(const a of s)n=n.map(c=>c.id===a.data.id?a.data:c);t(n)},s=>{for(const a of s)n=n.filter(c=>c.id!==a.data.id);t(n)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],i)}createInitialConfigRoom(e,t){var n=this;return E(function*(){const i=n.connectedUserService.user.get().toMinimalUser(),o={chosenOpponent:null,firstPlayer:m2.RANDOM.value,partType:Bi.STANDARD.value,partStatus:_2.PART_CREATED.value,maximalMoveDuration:Bi.NORMAL_MOVE_DURATION,totalPartDuration:Bi.NORMAL_PART_DURATION,creator:i,rulesConfig:rk.getGameDefaultConfig(t).getOrElse({})};return n.configRoomDAO.set(e,o)})()}joinGame(e){var t=this;return E(function*(){const n=t.connectedUserService.user.get().toMinimalUser(),i=yield t.configRoomDAO.read(e);return i.isAbsent()?A.failure(ok.GAME_DOES_NOT_EXIST()):(i.get().creator.id!==n.id&&(yield t.addCandidate(e,n)),A.SUCCESS)})()}cancelJoining(e){var t=this;return E(function*(){const n=t.connectedUserService.user.get().toMinimalUser(),i=yield t.configRoomDAO.read(e);if(!i.isAbsent()){const o=i.get(),s=[t.removeCandidate(e,n)];o.chosenOpponent?.id===n.id&&s.push(t.configRoomDAO.update(e,{chosenOpponent:null,partStatus:_2.PART_CREATED.value})),yield Promise.all(s)}})()}deleteConfigRoom(e,t){var n=this;return E(function*(){yield Promise.all(t.map(i=>n.removeCandidate(e,i))),yield n.configRoomDAO.delete(e)})()}proposeConfig(e,t,n,i,o,s,a){var c=this;return E(function*(){return c.configRoomDAO.update(e,{partStatus:_2.CONFIG_PROPOSED.value,chosenOpponent:t,partType:n.value,maximalMoveDuration:i,totalPartDuration:s,firstPlayer:o.value,rulesConfig:a.getOrElse({})})})()}setChosenOpponent(e,t){return this.configRoomDAO.update(e,{chosenOpponent:t})}reviewConfig(e){var t=this;return E(function*(){return t.configRoomDAO.update(e,{partStatus:_2.PART_CREATED.value})})()}reviewConfigAndRemoveChosenOpponent(e){var t=this;return E(function*(){return t.configRoomDAO.update(e,{partStatus:_2.PART_CREATED.value,chosenOpponent:null})})()}acceptConfig(e){return this.configRoomDAO.update(e,{partStatus:_2.PART_STARTED.value})}createConfigRoom(e,t){var n=this;return E(function*(){return n.configRoomDAO.set(e,t)})()}readConfigRoomById(e){var t=this;return E(function*(){return(yield t.configRoomDAO.read(e)).get()})()}static \u0275fac=function(t){return new(t||Iv)(Ae(ik),Ae(hr))};static \u0275prov=xe({token:Iv,factory:Iv.\u0275fac,providedIn:"root"})};Id=ok=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],Id);let Su=class kv{partDAO;gameEventService;connectedUserService;configRoomService;chatService;constructor(e,t,n,i,o){this.partDAO=e,this.gameEventService=t,this.connectedUserService=n,this.configRoomService=i,this.chatService=o}update(e,t){var n=this;return E(function*(){return n.partDAO.update(e,t)})()}getPartValidity(e,t){var n=this;return E(function*(){const i=yield n.partDAO.read(e);return i.isAbsent()?A.failure("NONEXISTENT_PART"):i.get().typeGame===t?A.SUCCESS:A.failure("WRONG_GAME_TYPE")})()}getUser(){return this.connectedUserService.user.get().toMinimalUser()}createUnstartedPart(e){const t=this.getUser();return this.partDAO.create({typeGame:e,playerZero:t,turn:-1,result:rr.UNACHIEVED.value})}createChat(e){return this.chatService.createNewChat(e)}createPartConfigRoomAndChat(e){var t=this;return E(function*(){const n=yield t.createUnstartedPart(e);return yield t.configRoomService.createInitialConfigRoom(n,e),yield t.createChat(n),n})()}getStartingConfig(e){let n,i,t=m2.of(e.firstPlayer);return t===m2.RANDOM&&(t=Math.random()<.5?m2.CREATOR:m2.CHOSEN_PLAYER),t===m2.CREATOR?(n=e.creator,i=L.getNonNullable(e.chosenOpponent)):(n=L.getNonNullable(e.chosenOpponent),i=e.creator),{playerZero:n,playerOne:i,turn:0,beginning:Fc()}}deletePart(e){return this.partDAO.delete(e)}acceptConfig(e,t){var n=this;return E(function*(){yield n.configRoomService.acceptConfig(e);const i=n.getStartingConfig(t);yield n.partDAO.update(e,i),yield n.gameEventService.startGame(e,n.getUser())})()}getPart(e){return this.partDAO.read(e)}subscribeToChanges(e,t){return this.partDAO.subscribeToChanges(e,t)}resign(e,t,n){var i=this;return E(function*(){const o={winner:t,loser:n,result:rr.RESIGN.value};yield i.partDAO.update(e,o),yield i.gameEventService.addAction(e,i.getUser(),"EndGame")})()}notifyTimeout(e,t,n){var i=this;return E(function*(){const o={winner:t,loser:n,result:rr.TIMEOUT.value};yield i.partDAO.update(e,o),yield i.gameEventService.addAction(e,i.getUser(),"EndGame")})()}proposeDraw(e){var t=this;return E(function*(){yield t.gameEventService.addRequest(e,t.getUser(),"Draw")})()}acceptDraw(e,t){var n=this;return E(function*(){yield n.gameEventService.addReply(e,n.getUser(),"Accept","Draw");const o={result:(t===O.ZERO?rr.AGREED_DRAW_BY_ZERO:rr.AGREED_DRAW_BY_ONE).value};yield n.partDAO.update(e,o),yield n.gameEventService.addAction(e,n.getUser(),"EndGame")})()}refuseDraw(e){var t=this;return E(function*(){yield t.gameEventService.addReply(e,t.getUser(),"Reject","Draw")})()}proposeRematch(e){var t=this;return E(function*(){yield t.gameEventService.addRequest(e,t.getUser(),"Rematch")})()}rejectRematch(e){var t=this;return E(function*(){yield t.gameEventService.addReply(e,t.getUser(),"Reject","Rematch")})()}acceptRematch(e){var t=this;return E(function*(){const n=L.getNonNullable(e.data),i=yield t.configRoomService.readConfigRoomById(e.id);let o;const s=t.getUser();let a;n.playerZero.id===s.id?(a=L.getNonNullable(n.playerOne),o=m2.CHOSEN_PLAYER):(a=n.playerZero,o=m2.CREATOR);const c={...i,firstPlayer:o.value,creator:s,chosenOpponent:a,partStatus:_2.PART_STARTED.value},l=t.getStartingConfig(c),u={typeGame:n.typeGame,result:rr.UNACHIEVED.value,...l},f=yield t.partDAO.create(u);yield t.configRoomService.createConfigRoom(f,c),yield t.createChat(f),yield t.gameEventService.addReply(e.id,t.getUser(),"Accept","Rematch",f),yield t.gameEventService.startGame(f,t.getUser())})()}askTakeBack(e){var t=this;return E(function*(){yield t.gameEventService.addRequest(e,t.getUser(),"TakeBack")})()}acceptTakeBack(e,t,n){var i=this;return E(function*(){let o=t-1;O.ofTurn(o).equals(n)&&o--;const s={turn:o};return yield i.gameEventService.addReply(e,i.getUser(),"Accept","TakeBack"),yield i.partDAO.update(e,s)})()}refuseTakeBack(e){var t=this;return E(function*(){yield t.gameEventService.addReply(e,t.getUser(),"Reject","TakeBack")})()}addGlobalTime(e){var t=this;return E(function*(){yield t.gameEventService.addAction(e,t.getUser(),"AddGlobalTime")})()}addTurnTime(e){var t=this;return E(function*(){yield t.gameEventService.addAction(e,t.getUser(),"AddTurnTime")})()}preparePartUpdate(e,t){var n=this;return E(function*(){let s={turn:(yield n.partDAO.read(e)).get().turn+1};return s=n.updateScore(s,t),s})()}updatePartUponMove(e,t){var n=this;return E(function*(){const i=yield n.preparePartUpdate(e,t);yield n.update(e,i)})()}drawPart(e,t){var n=this;return E(function*(){let i=yield n.preparePartUpdate(e,t);i={...i,result:rr.HARD_DRAW.value},yield n.update(e,i),yield n.gameEventService.addAction(e,n.getUser(),"EndGame")})()}endPartWithVictory(e,t,n,i){var o=this;return E(function*(){let s=yield o.preparePartUpdate(e,i);s={...s,winner:t,loser:n,result:rr.VICTORY.value},yield o.update(e,s),yield o.gameEventService.addAction(e,o.getUser(),"EndGame")})()}updateScore(e,t){return t.isPresent()?{...e,scorePlayerZero:t.get().get(O.ZERO),scorePlayerOne:t.get().get(O.ONE)}:e}static \u0275fac=function(t){return new(t||kv)(Ae(cd),Ae(pI),Ae(hr),Ae(Id),Ae(Y5))};static \u0275prov=xe({token:kv,factory:kv.\u0275fac,providedIn:"root"})};Su=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],Su);class kd{static getNavigatorLanguage(){return navigator.language}static getLocale(){const n=(localStorage.getItem("locale")??kd.getNavigatorLanguage()??"fr").slice(0,2).toLowerCase();return["en","fr"].some(i=>i===n)?n:"fr"}}let iee=(()=>{class r{changeTheme(t){localStorage.setItem("theme",t)}getTheme(){return h.ofNullable(localStorage.getItem("theme"))}changeLanguage(t){localStorage.setItem("locale",t.toLowerCase())}getLanguage(){return kd.getLocale()}static \u0275fac=function(n){return new(n||r)};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),iv=(()=>{class r{document;userSettingsService;theme;availableThemes=["dark","light"];constructor(t,n){this.document=t,this.userSettingsService=n;const i=this.getStoredTheme();i.isPresent()?this.loadTheme(i.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}getStoredTheme(){const t=this.userSettingsService.getTheme();if(t.isPresent()){const n=t.get();if(this.availableThemes.some(i=>i===n))return h.of(n)}return h.empty()}loadTheme(t){this.loadStyle(t+".css"),this.theme=t}loadStyle(t){const n=this.document.getElementsByTagName("head")[0],i=this.document.getElementById("theme");if(null!=i)i.href=t;else{const o=this.document.createElement("link");o.id="theme",o.rel="stylesheet",o.href=`${t}`,n.appendChild(o)}}getTheme(){return this.theme}static \u0275fac=function(n){return new(n||r)(Ae(zi),Ae(iee))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var bee={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256C0 376 82.7 476.8 194.2 504.5V334.2H141.4V256h52.8V222.3c0-87.1 39.4-127.5 125-127.5c16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1c-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287V510.1C413.8 494.8 512 386.9 512 256h0z"]},xee={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},Lee={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]},uk={prefix:"fas",iconName:"reply",icon:[512,512,[61714,"mail-reply"],"f3e5","M205 34.8c11.5 5.1 19 16.6 19 29.2v64H336c97.2 0 176 78.8 176 176c0 113.3-81.5 163.9-100.2 174.1c-2.5 1.4-5.3 1.9-8.1 1.9c-10.9 0-19.7-8.9-19.7-19.7c0-7.5 4.3-14.4 9.8-19.5c9.4-8.8 22.2-26.4 22.2-56.7c0-53-43-96-96-96H224v64c0 12.6-7.4 24.1-19 29.2s-25 3-34.4-5.4l-160-144C3.9 225.7 0 217.1 0 208s3.9-17.7 10.6-23.8l160-144c9.4-8.5 22.9-10.6 34.4-5.4z"]},$te={prefix:"fas",iconName:"flag",icon:[448,512,[127988,61725],"f024","M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"]},Pne={prefix:"fas",iconName:"repeat",icon:[512,512,[128257],"f363","M0 224c0 17.7 14.3 32 32 32s32-14.3 32-32c0-53 43-96 96-96H320v32c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l64-64c12.5-12.5 12.5-32.8 0-45.3l-64-64c-9.2-9.2-22.9-11.9-34.9-6.9S320 19.1 320 32V64H160C71.6 64 0 135.6 0 224zm512 64c0-17.7-14.3-32-32-32s-32 14.3-32 32c0 53-43 96-96 96H192V352c0-12.9-7.8-24.6-19.8-29.6s-25.7-2.2-34.9 6.9l-64 64c-12.5 12.5-12.5 32.8 0 45.3l64 64c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V448H352c88.4 0 160-71.6 160-160z"]},Ok={prefix:"fas",iconName:"eye",icon:[576,512,[128065],"f06e","M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"]},wie={prefix:"fas",iconName:"gear",icon:[512,512,[9881,"cog"],"f013","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"]},Rk={prefix:"fas",iconName:"backward-step",icon:[320,512,["step-backward"],"f048","M267.5 440.6c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4l-192 160L64 241V96c0-17.7-14.3-32-32-32S0 78.3 0 96V416c0 17.7 14.3 32 32 32s32-14.3 32-32V271l11.5 9.6 192 160z"]},Hie={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M256 64H384v64H256V64zM240 0c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h48v32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96v32H80c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H240c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H192V288H448v32H400c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H560c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H512V288h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V192h48c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48H240zM96 448V384H224v64H96zm320-64H544v64H416V384z"]},ooe={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zm0 416a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM48 304a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm464-48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM142.9 437A48 48 0 1 0 75 369.1 48 48 0 1 0 142.9 437zm0-294.2A48 48 0 1 0 75 75a48 48 0 1 0 67.9 67.9zM369.1 437A48 48 0 1 0 437 369.1 48 48 0 1 0 369.1 437z"]},Yk={prefix:"fas",iconName:"desktop",icon:[576,512,[128421,61704,"desktop-alt"],"f390","M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64H240l-10.7 32H160c-17.7 0-32 14.3-32 32s14.3 32 32 32H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H346.7L336 416H512c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64zM512 64V288H64V64H512z"]},Uoe={prefix:"fas",iconName:"book-open",icon:[576,512,[128214,128366],"f518","M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C93.5 32 46.3 45.3 18.1 56.1C6.8 60.5 0 71.7 0 83.8V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V83.8c0-12.1-6.8-23.3-18.1-27.6C529.7 45.3 482.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z"]};class qo{userDAO;userService;connectedUserService;static roleToMessage=new fn([{key:"Candidate",value:ad.YOU_ARE_ALREADY_CANDIDATE},{key:"ChosenOpponent",value:ad.YOU_ARE_ALREADY_CHOSEN_OPPONENT},{key:"Creator",value:ad.YOU_ARE_ALREADY_CREATING},{key:"Player",value:ad.YOU_ARE_ALREADY_PLAYING},{key:"Observer",value:ad.YOU_ARE_ALREADY_OBSERVING}]);authSubscription;userSubscription=new Ue;currentGame=h.empty();currentGameRS;currentGameObs;constructor(e,t,n){var i=this;this.userDAO=e,this.userService=t,this.connectedUserService=n,this.currentGameRS=new SQ(1),this.currentGameObs=this.currentGameRS.asObservable(),this.authSubscription=this.connectedUserService.subscribeToUser(function(){var o=E(function*(s){yield i.onUserUpdate(s)});return function(s){return o.apply(this,arguments)}}())}onUserUpdate(e){var t=this;return E(function*(){if(e===n0.NOT_CONNECTED)t.userSubscription.unsubscribe(),t.currentGame=h.empty(),t.currentGameRS.next(h.empty());else{t.userSubscription=t.userService.observeUserOnServer(e.id,i=>{hn(i.isPresent(),"Observing part service expected user to already have a document!");const o=i.get();t.onCurrentGameUpdate(o.currentGame)});const n=yield t.userDAO.read(e.id);t.currentGame=h.ofNullable(n.get().currentGame),t.currentGameRS.next(t.currentGame)}})()}onCurrentGameUpdate(e){const t=this.currentGame,n=null==e&&t.isAbsent(),i=null!=e&&t.equalsValue(e);!1===n&&!1===i&&(this.currentGame=h.ofNullable(e),this.currentGameRS.next(this.currentGame))}updateCurrentGame(e){if(hn(this.connectedUserService.user.isPresent(),"Should not call updateCurrentGame when not connected"),this.currentGame.isPresent()){const n={...this.currentGame.get(),...e};return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:n})}{const n=Object.keys({id:"id",role:"Candidate",typeGame:"P4"});for(const i of n)hn(null!=e[i],"field "+i+" should be set before updating currentGame");return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:e})}}removeCurrentGame(){return hn(this.connectedUserService.user.isPresent(),"Should not call removeCurrentGame when not connected"),this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:null})}subscribeToCurrentGame(e){return this.currentGameObs.subscribe(e)}canUserCreate(){if(this.currentGame.isAbsent())return A.SUCCESS;{const e=qo.roleToMessage.get(this.currentGame.get().role).get()();return A.failure(e)}}canUserJoin(e,t){if(this.currentGame.isAbsent()||this.currentGame.get().id===e)return A.SUCCESS;if(t&&"Observer"===this.currentGame.get().role)return A.SUCCESS;{const n=qo.roleToMessage.get(this.currentGame.get().role).get()();return A.failure(n)}}getCurrentGame(){return new Promise(e=>{let t=new Ue;t=this.currentGameObs.subscribe(n=>{e(n),t.unsubscribe()})})}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}static \u0275fac=function(t){return new(t||qo)(Ae(sd),Ae(K5),Ae(hr))};static \u0275prov=xe({token:qo,factory:qo.\u0275fac,providedIn:"root"})}function Nht(r,e){if(1&r&&(jt(0),ae(1,31),Zt()),2&r){const t=p(2);m(),Un(t.currentGame.get().typeGame)(null==t.currentGame.get().opponent?null:t.currentGame.get().opponent.name),Zn(1)}}function Iht(r,e){if(1&r&&(jt(0),ae(1,33),Zt()),2&r){const t=p(3);m(),Un(t.currentGame.get().typeGame)(null==t.currentGame.get().opponent?null:t.currentGame.get().opponent.name),Zn(1)}}function kht(r,e){if(1&r&&(jt(0),ae(1,34),Zt()),2&r){const t=p(3);m(),Un(t.currentGame.get().typeGame),Zn(1)}}function Rht(r,e){if(1&r&&z(0,Iht,2,2,"ng-container",27)(1,kht,2,1,"ng-template",null,32,wn),2&r){const t=Pn(2);v("ngIf",p(2).currentGame.get().opponent)("ngIfElse",t)}}function xht(r,e){if(1&r){const t=de();M(0,"a",29),W("click",function(){return te(t),ne(p().navigateToPart())}),z(1,Nht,2,2,"ng-container",27)(2,Rht,3,2,"ng-template",null,30,wn),P()}if(2&r){const t=Pn(3),n=p();m(),v("ngIf","Observer"===n.currentGame.get().role||"Candidate"===n.currentGame.get().role)("ngIfElse",t)}}function Lht(r,e){if(1&r&&(jt(0),V(1,"fa-icon",35),Zt()),2&r){const t=p();m(),v("icon",t.faSpinner)}}function zht(r,e){if(1&r){const t=de();jt(0),M(1,"div",10)(2,"a",37),st(3),P(),M(4,"div",13)(5,"a",38),ae(6,39),P(),M(7,"a",40),W("click",function(){return te(t),ne(p(2).logout())}),ae(8,41),P()()(),Zt()}if(2&r){const t=p(2);m(3),mn(t.username.get())}}const Dht=()=>["/register"],Vht=()=>["/login"];function Hht(r,e){1&r&&(M(0,"div",42)(1,"a",43)(2,"strong"),ae(3,44),P()(),M(4,"a",45),ae(5,46),P()()),2&r&&(m(),v("routerLink",ur(2,Dht)),m(3),v("routerLink",ur(3,Vht)))}function Fht(r,e){if(1&r&&z(0,zht,9,1,"ng-container",27)(1,Hht,6,4,"ng-template",null,36,wn),2&r){const t=Pn(2);v("ngIf",p().username.isPresent())("ngIfElse",t)}}const mse=()=>["/"],Uht=()=>["/play"],$ht=()=>["/lobby"],Ght=()=>["/local"],Bht=()=>["/tutorial"],Wht=()=>["/settings"];let qht=(()=>{class r{router;connectedUserService;currentGameService;userService;loading=!0;username=h.empty();faCog=wie;faSpinner=ooe;userSubscription;currentGameSubscription;showMenu=!1;currentGame=h.empty();constructor(t,n,i,o){this.router=t,this.connectedUserService=n,this.currentGameService=i,this.userService=o}ngOnInit(){this.userSubscription=this.connectedUserService.subscribeToUser(t=>{this.loading=!1,this.username=t.username.isPresent()?t.username:t.email}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(t=>{this.currentGame=t})}logout(){var t=this;return E(function*(){yield t.connectedUserService.disconnect(),yield t.router.navigate(["/"])})()}navigateToPart(){var t=this;return E(function*(){return t.router.navigate(["/play",t.currentGame.get().typeGame,t.currentGame.get().id])})()}ngOnDestroy(){this.userSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}static \u0275fac=function(n){return new(n||r)(G(Xn),G(hr),G(qo),G(K5))};static \u0275cmp=$e({type:r,selectors:[["app-header"]],decls:36,vars:20,consts:()=>{let t,n,i,o,s,a,c,l,u,f,g,y,S,I,R;return t=$localize`Home`,n=$localize`Play online`,i=$localize`Create a game`,o=$localize`Join a game`,s=$localize`Play offline`,a=$localize`Create a game`,c=$localize`Learn the rules`,l=$localize`Settings`,u=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: by ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,f=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: against ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,g=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: (waiting for opponent)`,y=$localize`Account`,S=$localize`Log out`,I=$localize`Register`,R=$localize`Log in`,[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["id","logo","src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],["id","home",1,"navbar-item",3,"routerLink"],t,[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],n,[1,"navbar-dropdown"],i,o,["id","playOffline",1,"navbar-link"],s,["id","playLocally",1,"navbar-item",3,"routerLink"],a,["id","tutorial",1,"navbar-item",3,"routerLink"],c,[1,"navbar-end"],["id","currentGameLink","class","navbar-item",3,"click",4,"ngIf"],["data-tooltip",l,1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],["id","currentGameLink",1,"navbar-item",3,"click"],["activeUser",""],u,["waitingForOpponent",""],f,g,[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","connectedUserName",1,"navbar-link"],["id","account","routerLink","/account",1,"navbar-item"],y,["id","logout",1,"navbar-item",3,"click"],S,[1,"buttons"],["id","register",1,"button","is-primary",3,"routerLink"],I,["id","login",1,"button","is-light",3,"routerLink"],R]},template:function(n,i){if(1&n&&(M(0,"nav",0)(1,"div",1)(2,"a",2),V(3,"img",3),P(),M(4,"a",4),W("click",function(){return i.showMenu=!i.showMenu}),V(5,"span",5)(6,"span",5)(7,"span",5),P()(),M(8,"div",6),W("click",function(){return i.showMenu=!i.showMenu}),M(9,"div",7)(10,"a",8),ae(11,9),P(),M(12,"div",10)(13,"a",11),ae(14,12),P(),M(15,"div",13)(16,"a",2),ae(17,14),P(),M(18,"a",2),ae(19,15),P()()(),M(20,"div",10)(21,"a",16),ae(22,17),P(),M(23,"div",13)(24,"a",18),ae(25,19),P(),M(26,"a",20),ae(27,21),P()()()(),M(28,"div",22),z(29,xht,4,2,"a",23),M(30,"a",24),V(31,"fa-icon",25),P(),M(32,"div",26),z(33,Lht,2,1,"ng-container",27)(34,Fht,3,2,"ng-template",null,28,wn),P()()()()),2&n){const o=Pn(35);m(2),v("routerLink",ur(13,mse)),m(2),v("ngClass",i.showMenu?"is-active":""),m(4),v("ngClass",i.showMenu?"is-active":""),m(2),v("routerLink",ur(14,mse)),m(6),v("routerLink",ur(15,Uht)),m(2),v("routerLink",ur(16,$ht)),m(6),v("routerLink",ur(17,Ght)),m(2),v("routerLink",ur(18,Bht)),m(3),v("ngIf",i.currentGame.isPresent()),m(),v("routerLink",ur(19,Wht)),m(),v("icon",i.faCog),m(2),v("ngIf",i.loading)("ngIfElse",o)}},dependencies:[zt,Tt,Ac,e0],encapsulation:2})}return r})(),jht=(()=>{class r{_themeService;_errorLoggerService;faTwitter=Lee;faFacebook=bee;faGithub=xee;constructor(t,n){this._themeService=t,this._errorLoggerService=n}static \u0275fac=function(n){return new(n||r)(G(iv),G(Gi))};static \u0275cmp=$e({type:r,selectors:[["app-root"]],decls:18,vars:3,consts:()=>{let t;return t=$localize`If you like ${"\ufffd#8\ufffd"}:START_TAG_STRONG:EveryBoard${"\ufffd/#8\ufffd"}:CLOSE_TAG_STRONG:, follow us!`,[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],t,["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoardGames"],["href","https://facebook.com/EveryBoard"]]},template:function(n,i){1&n&&(V(0,"app-header"),M(1,"main",0),V(2,"router-outlet"),P(),M(3,"footer",1)(4,"div",2)(5,"p")(6,"span"),No(7,3),V(8,"strong"),Io(),P(),st(9," \xa0 "),M(10,"a",4),V(11,"fa-icon",5),P(),st(12,"\xa0 "),M(13,"a",6),V(14,"fa-icon",5),P(),st(15,"\xa0 "),M(16,"a",7),V(17,"fa-icon",5),P()()()()),2&n&&(m(11),v("icon",i.faGithub),m(3),v("icon",i.faTwitter),m(3),v("icon",i.faFacebook))},dependencies:[MS,e0,qht],encapsulation:2})}return r})();function Zht(r,e){if(1&r){const t=de();M(0,"div",26)(1,"div",27),W("click",function(){return te(t),ne(p().closeInfo())}),P(),M(2,"div",28)(3,"header",29)(4,"p",30),st(5),P(),M(6,"button",31),W("click",function(){return te(t),ne(p().closeInfo())}),P()(),M(7,"section",32)(8,"div",6)(9,"div",33)(10,"p",34),V(11,"img",35),P()(),M(12,"div",7)(13,"div",13),st(14),P()()(),M(15,"div",6)(16,"div",33)(17,"a",36),W("click",function(){te(t);const i=p();return ne(i.createGame(i.gameInfoDetails.get().urlName))}),V(18,"fa-icon",37),st(19,"\xa0"),M(20,"span"),ae(21,38),P()()(),M(22,"div",33)(23,"a",36),W("click",function(){te(t);const i=p();return ne(i.createLocalGame(i.gameInfoDetails.get().urlName))}),V(24,"fa-icon",37),st(25,"\xa0"),M(26,"span"),ae(27,39),P()()(),M(28,"div",33)(29,"a",36),W("click",function(){te(t);const i=p();return ne(i.createTutorial(i.gameInfoDetails.get().urlName))}),V(30,"fa-icon",37),st(31,"\xa0"),M(32,"span"),ae(33,40),P()()()()()()()}if(2&r){const t=p();m(5),mn(t.gameInfoDetails.get().name),m(6),Ce("src","assets/images/",t.theme,"/",t.gameInfoDetails.get().urlName,".png",jh),m(3),ri(" ",t.gameInfoDetails.get().description," "),m(4),v("icon",t.iconOnlineGame),m(6),v("icon",t.iconLocalGame),m(6),v("icon",t.iconTutorial)}}function Yht(r,e){if(1&r){const t=de();M(0,"div",8)(1,"div",9)(2,"p",10),st(3),P()(),M(4,"div",42)(5,"figure",34)(6,"img",43),W("click",function(){const o=te(t).$implicit;return ne(p(2).openInfo(o))}),P(),M(7,"figcaption",44),W("click",function(){const o=te(t).$implicit;return ne(p(2).openInfo(o))}),M(8,"div",45),st(9,"?"),P()(),M(10,"figcaption",46)(11,"a",47),W("click",function(){const o=te(t).$implicit;return ne(p(2).createGame(o.urlName))}),V(12,"fa-icon",37),P(),M(13,"a",48),W("click",function(){const o=te(t).$implicit;return ne(p(2).createLocalGame(o.urlName))}),V(14,"fa-icon",37),P(),M(15,"a",49),W("click",function(){const o=te(t).$implicit;return ne(p(2).createTutorial(o.urlName))}),V(16,"fa-icon",37),P()()()(),M(17,"div",50),st(18),P()()}if(2&r){const t=e.$implicit,n=p(2);m(3),mn(t.name),m(3),En("id","image_",t.urlName,""),Ce("src","assets/images/",n.theme,"/",t.urlName,".png",jh),m(5),En("id","playOnline_",t.urlName,""),m(),v("icon",n.iconOnlineGame),m(),En("id","playLocally_",t.urlName,""),m(),v("icon",n.iconLocalGame),m(),En("id","startTutorial_",t.urlName,""),m(),v("icon",n.iconTutorial),m(2),ri(" ",t.description," ")}}function Kht(r,e){if(1&r&&(M(0,"div",7),z(1,Yht,19,11,"div",41),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}let Xht=(()=>{class r{router;messageDisplayer;currentGameService;numberOfColumns=5;games=[];theme;iconOnlineGame=Hie;iconLocalGame=Yk;iconTutorial=Uoe;gameInfoDetails=h.empty();constructor(t,n,i,o){this.router=t,this.messageDisplayer=n,this.currentGameService=i,this.theme=o.getTheme();const s=Vt.ALL_GAMES();let a=0;for(let c=0;c<s.length;c++)c<this.numberOfColumns&&this.games.push([]),this.games[a].push(s[c]),a=(a+1)%this.numberOfColumns}createGame(t){var n=this;return E(function*(){const i=n.currentGameService.canUserCreate();return i.isSuccess()?n.router.navigate(null==t?["/play"]:["/play",t]):(n.messageDisplayer.criticalMessage(i.getReason()),!1)})()}createLocalGame(t){var n=this;return E(function*(){return n.router.navigate(["/local",t])})()}createTutorial(t){return this.router.navigate(["/tutorial",t])}openInfo(t){this.gameInfoDetails=h.of(t)}closeInfo(){this.gameInfoDetails=h.empty()}static \u0275fac=function(n){return new(n||r)(G(Xn),G(Ut),G(qo),G(iv))};static \u0275cmp=$e({type:r,selectors:[["app-welcome"]],decls:33,vars:2,consts:()=>{let t,n,i,o,s,a,c,l,u,f,g,y,S,I;return t=$localize`EveryBoard`,n=$localize`EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn.`,i=$localize`Play online`,o=$localize`Create an online game`,s=$localize`See the game list`,a=$localize`Play offline`,c=$localize`Play`,l=$localize`Learn`,u=$localize`Play online`,f=$localize`Play offline`,g=$localize`Learn the rules`,y=$localize`Play online`,S=$localize`Play offline`,I=$localize`Learn the rules`,[[1,"hero"],[1,"hero-body"],[1,"title"],t,[1,"subtitle"],n,[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],i,[1,"card-content"],[1,"content"],["id","createOnlineGame",1,"button","is-medium","is-fullwidth","is-primary","mb-1",3,"click"],o,["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],s,a,[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],c,["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],l,["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],u,f,g,["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",y,1,"button",3,"id","click"],["data-tooltip",S,1,"button",3,"id","click"],["data-tooltip",I,1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(n,i){1&n&&(M(0,"section",0)(1,"div",1)(2,"p",2),ae(3,3),P(),M(4,"p",4),No(5,5),V(6,"br"),Io(),P()(),M(7,"div",6)(8,"div",7)(9,"div",8)(10,"header",9)(11,"p",10),ae(12,11),P()(),M(13,"div",12)(14,"div",13)(15,"button",14),W("click",function(){return i.createGame()}),ae(16,15),P(),M(17,"button",16),ae(18,17),P()()()()(),M(19,"div",7)(20,"div",8)(21,"header",9)(22,"p",10),ae(23,18),P()(),M(24,"div",12)(25,"div",19)(26,"button",20),ae(27,21),P(),M(28,"button",22),ae(29,23),P()()()()()(),z(30,Zht,34,7,"div",24),M(31,"div",6),z(32,Kht,2,1,"div",25),P()()),2&n&&(m(30),v("ngIf",i.gameInfoDetails.isPresent()),m(2),v("ngForOf",i.games))},dependencies:[Nt,Tt,Ac,e0],encapsulation:2})}return r})();const Qht=["board"];let Vd=(()=>class r{static NOT_YOUR_TURN=()=>$localize`It is not your turn!`;static GAME_HAS_ENDED=()=>$localize`This game has ended.`;static NO_MATCHING_GAME(t){return $localize`This game (${t}) does not exist.`}})(),Mv=(()=>{class r extends NQ{connectedUserService;router;messageDisplayer;boardRef=null;gameComponent;players=[h.empty(),h.empty()];role=B.NONE;endGame=!1;Player=O;constructor(t,n,i,o){super(t),this.connectedUserService=n,this.router=i,this.messageDisplayer=o}getMatchingComponent(t){return h.ofNullable(Vt.ALL_GAMES().find(i=>i.urlName===t)).map(i=>i.component)}createMatchingGameComponent(){var t=this;return E(function*(){const n=yield t.getMatchingComponentAndNavigateOutIfAbsent();if(n.isPresent()){const i=yield t.getConfig();return yield t.createGameComponent(n.get()),t.gameComponent.config=i,t.gameComponent.node=t.gameComponent.rules.getInitialNode(i),yield t.gameComponent.updateBoard(!1),!0}return!1})()}getMatchingComponentAndNavigateOutIfAbsent(){var t=this;return E(function*(){const n=t.getGameName(),i=t.getMatchingComponent(n);return i.isAbsent()?(yield t.router.navigate(["/notFound",Vd.NO_MATCHING_GAME(n)],{skipLocationChange:!0}),h.empty()):i})()}createGameComponent(t){var n=this;return E(function*(){L.assert(null!=n.boardRef,"Board element should be present");const i=L.getNonNullable(n.boardRef).createComponent(t);n.gameComponent=i.instance,n.gameComponent.chooseMove=o=>n.receiveValidMove(o),n.gameComponent.canUserPlay=o=>n.canUserPlay(o),n.gameComponent.isPlayerTurn=()=>n.isPlayerTurn(),n.gameComponent.cancelMoveOnWrapper=o=>n.onCancelMove(o),yield n.setRole(n.role)})()}setRole(t){var n=this;return E(function*(){n.role=t,n.gameComponent.setPointOfView(t===B.NONE?O.ZERO:t),yield n.updateBoardAndShowLastMove(!1)})()}receiveValidMove(t){var n=this;return E(function*(){const i=yield n.getConfig(),o=n.gameComponent.rules.isLegal(t,n.gameComponent.node.gameState,i);return o.isFailure()?(yield n.gameComponent.cancelMove(o.getReason()),A.ofFallible(o)):(n.gameComponent.cancelMoveAttempt(),yield n.onLegalUserMove(t),A.SUCCESS)})()}getConfig(){var t=this;return E(function*(){const n=t.getGameName();return rk.getGameDefaultConfig(n)})()}canUserPlay(t){var n=this;return E(function*(){return!1===n.isPlayerTurn()?A.failure(Vd.NOT_YOUR_TURN()):n.endGame?A.failure(Vd.GAME_HAS_ENDED()):A.SUCCESS})()}isPlayerTurn(){if(this.role===B.NONE||null==this.gameComponent)return!1;const n=this.gameComponent.getTurn()%2,i=this.getPlayer();return!this.players[n].isPresent()||this.players[n].equalsValue(i)}getBoardHighlight(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.getTurn()%2+"-bg"]:[]}updateBoardAndShowLastMove(t){var n=this;return E(function*(){if(n.gameComponent.cancelMoveAttempt(),n.gameComponent.hideLastMove(),n.gameComponent.node.previousMove.isPresent()){yield n.gameComponent.updateBoard(t);const i=n.gameComponent.node.previousMove.get(),o=yield n.getConfig();yield n.gameComponent.showLastMove(i,o)}else yield n.gameComponent.updateBoard(!1)})()}getRulesConfigDescription(){const t=this.getGameName();return this.getRulesConfigDescriptionByName(t)}getRulesConfigDescriptionByName(t){const n=Vt.getByUrlName(t);return n.isAbsent()?h.empty():n.get().getRulesConfigDescription()}static \u0275fac=function(n){return new(n||r)(G(uo),G(hr),G(Xn),G(Ut))};static \u0275cmp=$e({type:r,selectors:[["ng-component"]],viewQuery:function(n,i){if(1&n&&O3(Qht,5,is),2&n){let o;pc(o=mc())&&(i.boardRef=o.first)}},features:[We],decls:0,vars:0,template:function(n,i){},encapsulation:2})}return r})(),_se=(()=>class r{static STEP_FINISHED=()=>$localize`Step finished!`;static INFORMATIONAL_STEP=()=>$localize`This step is not expecting any move from your part.`})();function egt(r,e){if(1&r&&(M(0,"div",21)(1,"div",22),ae(2,23),P(),V(3,"div",24),P()),2&r){const t=p();m(3),v("innerHTML",t.currentReason.get(),r7)}}function tgt(r,e){if(1&r){const t=de();M(0,"button",25),W("click",function(){return te(t),ne(p().retry())}),ae(1,26),P()}}function ngt(r,e){1&r&&(jt(0),ae(1,31),Zt())}function rgt(r,e){1&r&&(jt(0),ae(1,32),Zt())}function igt(r,e){if(1&r&&z(0,rgt,2,0,"ng-container",28),2&r){p();const t=Pn(5),n=p();v("ngIf",n.stepFinished&&n.stepFinished[n.stepIndex])("ngIfElse",t)}}function ogt(r,e){1&r&&(jt(0),ae(1,33),Zt())}function sgt(r,e){if(1&r){const t=de();M(0,"button",27),W("click",function(){return te(t),ne(p().next())}),z(1,ngt,2,0,"ng-container",28)(2,igt,1,2,"ng-template",null,29,wn)(4,ogt,2,0,"ng-template",null,30,wn),P()}if(2&r){const t=Pn(3),n=p();m(),v("ngIf",n.steps[n.stepIndex]&&n.steps[n.stepIndex].isInformation())("ngIfElse",t)}}function agt(r,e){if(1&r){const t=de();M(0,"button",34),W("click",function(){return te(t),ne(p().start())}),ae(1,35),P()}}function cgt(r,e){if(1&r){const t=de();M(0,"button",36),W("click",function(){return te(t),ne(p().playLocally())}),ae(1,37),P()}}function lgt(r,e){if(1&r){const t=de();M(0,"button",38),W("click",function(){return te(t),ne(p().createGame())}),ae(1,39),P()}}function ugt(r,e){if(1&r){const t=de();M(0,"button",40),W("click",function(){return te(t),ne(p().showSolution())}),ae(1,41),P()}}function fgt(r,e){if(1&r&&(jt(0),M(1,"option",43),st(2),P(),Zt()),2&r){const t=p(),n=t.index,i=t.$implicit;m(),En("id","step_",n,""),v("value",n),m(),mn(i.title)}}function dgt(r,e){1&r&&(jt(0),st(1,"v "),Zt())}function hgt(r,e){1&r&&st(0,"x ")}function ggt(r,e){if(1&r&&(M(0,"option",44),z(1,dgt,2,0,"ng-container",28)(2,hgt,1,0,"ng-template",null,45,wn),M(4,"span",46),st(5),P()()),2&r){const t=Pn(3),n=p(),i=n.index,o=n.$implicit,s=p();v("value",i),m(),v("ngIf",s.stepFinished[i])("ngIfElse",t),m(3),En("id","step_",i,""),m(),mn(o.title)}}function pgt(r,e){if(1&r&&(jt(0),z(1,fgt,3,3,"ng-container",28)(2,ggt,6,5,"ng-template",null,42,wn),Zt()),2&r){const t=e.index,n=Pn(3),i=p();m(),v("ngIf",t===i.stepIndex)("ngIfElse",n)}}let Cse=(()=>class r{static COMPLETED_TUTORIAL_MESSAGE=()=>$localize`Congratulations, you completed the tutorial.`;static THIS_IS_A_DEMO=()=>$localize`You cannot click, this is a demo.`})(),nR=class vR extends Mv{cdr;steps=[];successfulSteps=0;stepIndex=-1;currentMessage="";currentReason=h.empty();moveAttemptMade=!1;stepFinished=[];tutorialOver=!1;constructor(e,t,n,i,o){super(e,o,t,n),this.cdr=i}getNumberOfSteps(){return this.steps.length}getCurrentStepTitle(){return this.steps.length>0?this.steps[this.stepIndex].title:""}ngAfterViewInit(){var e=this;return E(function*(){(yield e.createMatchingGameComponent())&&(yield e.start())})()}start(){var e=this;return E(function*(){const t=e.gameComponent.tutorial;yield e.startTutorial(t)})()}startTutorial(e){var t=this;return E(function*(){t.steps=e,t.tutorialOver=!1,t.stepFinished=t.getCompletionArray(),t.successfulSteps=0,yield t.showStep(0)})()}getCompletionArray(){return this.steps.map(()=>!1)}changeStep(e){var t=this;return E(function*(){const n=e.target;yield t.showStep(Number.parseInt(n.value,10))})()}showStep(e){var t=this;return E(function*(){t.moveAttemptMade=!1,t.stepFinished[e]=!1,t.updateSuccessCount(),t.stepIndex=e;const n=t.steps[t.stepIndex];t.currentMessage=n.instruction,t.currentReason=h.empty(),t.gameComponent.node=new ps(n.state,void 0,n.previousMove),yield t.setRole(t.gameComponent.getCurrentPlayer()),t.gameComponent.setInteractive(!1===n.isInformation()),t.cdr.detectChanges()})()}onLegalUserMove(e){var t=this;return E(function*(){const n=t.steps[t.stepIndex],i=yield t.getConfig(),o=t.gameComponent.rules.choose(t.gameComponent.node,e,i);if(L.assert(o.isSuccess(),"It should be impossible to call onLegalUserMove with an illegal move, but got "+o.getReasonOr("")),t.gameComponent.node=o.get(),yield t.updateBoardAndShowLastMove(!1),t.moveAttemptMade=!0,n.isPredicate()){const s=t.gameComponent.getPreviousState(),a=t.gameComponent.getState(),c=L.getNonNullable(n.predicate)(e,s,a);c.isSuccess()?t.showStepSuccess(n.getSuccessMessage()):t.currentReason=h.of(c.getReason())}else if(n.isAnyMove())Ne.display("TutorialGameWrapperComponent","onLegalUserMove","awaited move!"),t.showStepSuccess(n.getSuccessMessage());else if(n.isMove()){const s=n;s.acceptedMoves.some(a=>a.equals(e))?(Ne.display("TutorialGameWrapperComponent","onLegalUserMove","awaited move!"),t.showStepSuccess(s.getSuccessMessage())):(Ne.display("TutorialGameWrapperComponent","onLegalUserMove","not the move that was awaited."),t.currentReason=h.of(s.getFailureMessage()))}else L.assert(n.isClick(),"Here, we should have a click");t.cdr.detectChanges()})()}retry(){var e=this;return E(function*(){e.moveAttemptMade=!1,yield e.showStep(e.stepIndex)})()}canUserPlay(e){var t=this;return E(function*(){if(t.currentReason=h.empty(),t.stepFinished[t.stepIndex]||t.moveAttemptMade)return A.failure(_se.STEP_FINISHED());const n=t.steps[t.stepIndex];return n.isClick()?(yield t.updateBoardAndShowLastMove(!1),t.moveAttemptMade=!0,L.getNonNullable(n.acceptedClicks).some(i=>i===e)?t.showStepSuccess(n.getSuccessMessage()):t.currentMessage=n.getFailureMessage(),A.SUCCESS):n.isMove()||n.isPredicate()||n.isAnyMove()?A.SUCCESS:A.failure(_se.INFORMATIONAL_STEP())})()}onCancelMove(e){var t=this;return E(function*(){void 0!==e&&(t.currentReason=h.of(e)),t.cdr.detectChanges()})()}showStepSuccess(e){this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}updateSuccessCount(){let e=0;for(const t of this.stepFinished)t&&e++;this.successfulSteps=e}next(){var e=this;return E(function*(){if(e.steps[e.stepIndex].isInformation()&&(e.stepFinished[e.stepIndex]=!0,e.updateSuccessCount()),e.stepFinished.length===e.successfulSteps)e.currentMessage=Cse.COMPLETED_TUTORIAL_MESSAGE(),e.tutorialOver=!0;else{let t=(e.stepIndex+1)%e.steps.length;for(;!0===e.stepFinished[t];)t=(t+1)%e.steps.length;yield e.showStep(t)}})()}showSolution(){var e=this;return E(function*(){const t=e.steps[e.stepIndex];L.assert(t.hasSolution(),"step must have solution");const n=t,i=n.getSolution(),o=yield e.getConfig();i instanceof C2?(yield e.showStep(e.stepIndex),e.gameComponent.node=e.gameComponent.rules.choose(e.gameComponent.node,i,o).get(),yield e.updateBoardAndShowLastMove(!0)):(yield e.showStep(e.stepIndex),window.document.querySelector(i).dispatchEvent(new Event("click"))),e.currentMessage=n.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges()})()}playLocally(){var e=this;return E(function*(){const t=e.getGameName();yield e.router.navigate(["/local",t])})()}createGame(){var e=this;return E(function*(){const t=e.getGameName();yield e.router.navigate(["/play",t])})()}getPlayer(){return"tutorial-player"}static \u0275fac=function(t){return new(t||vR)(G(uo),G(Xn),G(Ut),G(zs),G(hr))};static \u0275cmp=$e({type:vR,selectors:[["app-tutorial-game-wrapper"]],features:[We],decls:23,vars:15,consts:()=>{let e,t,n,i,o,s,a,c,l;return e=$localize`Failure`,t=$localize`Try again`,n=$localize`Ok`,i=$localize`Continue`,o=$localize`Skip`,s=$localize`Try again`,a=$localize`Play locally`,c=$localize`Create an online game`,l=$localize`See solution`,[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["role","alert",1,"message","is-danger"],[1,"message-header"],e,["id","currentReason",1,"message-body",3,"innerHTML"],["id","retryButton",1,"button","mr-3",3,"click"],t,["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],n,i,o,["id","restartButton",1,"button",3,"click"],s,["id","playLocallyButton",1,"button",3,"click"],a,["id","playOnlineButton",1,"button",3,"click"],c,["id","showSolutionButton",1,"button",3,"click"],l,["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(t,n){1&t&&(M(0,"div",0)(1,"div",1)(2,"div",2),V(3,"progress",3),M(4,"div",4)(5,"p",5),st(6),P(),V(7,"p",6),P(),z(8,egt,4,1,"div",7),M(9,"div",8),z(10,tgt,2,0,"button",9)(11,sgt,6,2,"button",10)(12,agt,2,0,"button",11)(13,cgt,2,0,"button",12)(14,lgt,2,0,"button",13)(15,ugt,2,0,"button",14),M(16,"div",15)(17,"select",16),W("change",function(o){return n.changeStep(o)}),z(18,pgt,4,2,"ng-container",17),P()()()()(),M(19,"div",18)(20,"div",19),V(21,"div",null,20),P()()()),2&t&&(m(3),w("value",n.successfulSteps)("max",n.getNumberOfSteps()),m(3),OE("",n.getCurrentStepTitle()," [",n.stepIndex+1,"/",n.getNumberOfSteps(),"]"),m(),v("innerHTML",n.currentMessage,r7),m(),v("ngIf",n.currentReason.isPresent()),m(2),v("ngIf",!1===n.tutorialOver&&(n.stepFinished&&!0===n.stepFinished[n.stepIndex]||n.moveAttemptMade)),m(),v("ngIf",!1===n.tutorialOver),m(),v("ngIf",n.tutorialOver),m(),v("ngIf",n.tutorialOver),m(),v("ngIf",n.tutorialOver),m(),v("ngIf",n.moveAttemptMade&&!1===n.stepFinished[n.stepIndex]),m(3),v("ngForOf",n.steps),m(),v("ngClass",n.getBoardHighlight()))},dependencies:[zt,Nt,Tt,A8,b8],encapsulation:2,changeDetection:0})};nR=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],nR);const mgt=["board"];let vse=(()=>{class r extends Mv{cdr;demoNodeInfo;boardRef=null;gameComponentIsSetup=!1;constructor(t,n,i,o,s){super(t,n,i,o),this.cdr=s}ngAfterViewInit(){var t=this;return E(function*(){window.setTimeout(E(function*(){yield t.createMatchingGameComponent(),t.gameComponent.node=t.demoNodeInfo.node,t.gameComponent.setInteractive(!0),yield t.setRole(t.gameComponent.getCurrentPlayer()),t.cdr.detectChanges(),t.demoNodeInfo.click.isPresent()&&(L.getNonNullable(document.querySelector(t.demoNodeInfo.click.get())).dispatchEvent(new Event("click")),t.cdr.detectChanges()),t.gameComponentIsSetup=!0,yield t.setRole(B.NONE)}),1)})()}ngOnChanges(t){var n=this;return E(function*(){null!=n.gameComponent&&(n.gameComponent.node=n.demoNodeInfo.node,yield n.gameComponent.updateBoard(!1),n.cdr.detectChanges())})()}getGameName(){return this.demoNodeInfo.name}onLegalUserMove(t,n){return E(function*(){L.assert(!1,"DemoCardWrapper should not call applyLegalMove, as it does no move")})()}getPlayer(){return"no-player"}onCancelMove(t){return E(function*(){})()}canUserPlay(t){var n=this;return E(function*(){return n.gameComponentIsSetup?A.failure(Cse.THIS_IS_A_DEMO()):A.SUCCESS})()}static \u0275fac=function(n){return new(n||r)(G(uo),G(hr),G(Xn),G(Ut),G(zs))};static \u0275cmp=$e({type:r,selectors:[["app-demo-card"]],viewQuery:function(n,i){if(1&n&&O3(mgt,5,is),2&n){let o;pc(o=mc())&&(i.boardRef=o.first)}},inputs:{demoNodeInfo:"demoNodeInfo"},features:[We,c2],decls:2,vars:0,consts:[["board",""]],template:function(n,i){1&n&&V(0,"div",null,0)},encapsulation:2})}return r})();function _gt(r,e){if(1&r&&(M(0,"div",17)(1,"figure",18),V(2,"app-demo-card",19),P()()),2&r){const t=p().$implicit;m(2),v("demoNodeInfo",t)}}function Cgt(r,e){if(1&r&&(M(0,"div",20)(1,"figure",21),V(2,"app-demo-card",19),P()()),2&r){const t=p().$implicit;m(2),v("demoNodeInfo",t)}}function vgt(r,e){if(1&r&&(M(0,"div",12)(1,"div",13)(2,"p",14),st(3),P()(),z(4,_gt,3,1,"div",15)(5,Cgt,3,1,"ng-template",null,16,wn),P()),2&r){const t=e.$implicit,n=Pn(6),i=p(2);m(3),mn(t.name),m(),v("ngIf",i.squared.value)("ngIfElse",n)}}function ygt(r,e){if(1&r&&(M(0,"div",10),z(1,vgt,7,3,"div",11),P()),2&r){const t=e.$implicit;m(),v("ngForOf",t)}}let Mgt=(()=>{class r{numberOfColumns=new ko(5);squared=new ko(!0);columns=[];constructor(){this.fillColumns(this.numberOfColumns.value),this.numberOfColumns.valueChanges.subscribe(t=>{this.fillColumns(t)})}fillColumns(t){const n=Vt.ALL_GAMES();let i=0,o=0;this.columns=[];for(const s of n){const a=[],c=s.rules,l=s.tutorial.tutorial,u=s.getRulesConfig();for(const f of l){const g=this.getNodeFromStep(f,c,u);a.push(g)}for(const f of a)o<t&&this.columns.push([]),this.columns[i].push({name:s.urlName,node:f.node,click:f.click}),o++,i=(i+1)%t}}getNodeFromStep(t,n,i){if(t.hasSolution()){const o=t.getSolution();if("string"==typeof o)return{node:new ps(t.state),click:h.of(o)};{const s=o,a=n.isLegal(s,t.state,i),c=n.applyLegalMove(s,t.state,i,a.get()),l=new ps(t.state);return{node:new ps(c,h.of(l),h.of(s)),click:h.empty()}}}return{node:new ps(t.state),click:h.empty()}}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=$e({type:r,selectors:[["app-demo-page"]],decls:17,vars:4,consts:()=>{let t,n;return t=$localize`Number of columns: `,n=$localize`Squared`,[[1,"field"],["for","numberOfColumns",1,"label"],t,[1,"control"],["step","1","min","1","max","10","name","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary",3,"formControl"],[1,"checkbox"],["type","checkbox",3,"formControl"],n,[1,"columns"],["class","column",4,"ngFor","ngForOf"],[1,"column"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"card-header"],[1,"card-header-title"],["class","card-image game-card","style","height: 200px;",4,"ngIf","ngIfElse"],["nonSquared",""],[1,"card-image","game-card",2,"height","200px"],[1,"image",2,"height","100%"],[3,"demoNodeInfo"],[1,"card-image","game-card"],[1,"image"]]},template:function(n,i){1&n&&(M(0,"form")(1,"div",0)(2,"label",1),jt(3),ae(4,2),Zt(),M(5,"output"),st(6),P()(),M(7,"div",3),V(8,"input",4),P()(),M(9,"div",0)(10,"label",5),V(11,"input",6),st(12," \xa0"),jt(13),ae(14,7),Zt(),P()()(),M(15,"div",8),z(16,ygt,2,1,"div",9),P()),2&n&&(m(6),mn(i.numberOfColumns.value),m(2),v("formControl",i.numberOfColumns),m(3),v("formControl",i.squared),m(5),v("ngForOf",i.columns))},dependencies:[Nt,Tt,F4,wa,_p,sp,Mc,H4,WP,Z7,vse],encapsulation:2})}return r})(),rR=(()=>{class r{element;constructor(t){this.element=t}ngAfterViewInit(){this.element.nativeElement.focus()}static \u0275fac=function(n){return new(n||r)(G(V2))};static \u0275dir=Dt({type:r,selectors:[["","autofocus",""]]})}return r})(),yse=(()=>{class r{shown=!1;input;constructor(t){this.input=t.nativeElement.parentNode.previousSibling,t.nativeElement.addEventListener("click",n=>{this.toggle()})}toggle(){this.shown=!1===this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}static \u0275fac=function(n){return new(n||r)(G(V2))};static \u0275dir=Dt({type:r,selectors:[["","toggleVisibility",""]]})}return r})();function Egt(r,e){if(1&r&&(M(0,"div",29)(1,"div",30),ae(2,31),P(),M(3,"div",32),st(4),P()()),2&r){const t=p();m(4),mn(t.errorMessage)}}const Pgt=()=>["/register"],Sgt=()=>["/reset-password"];let Ogt=(()=>{class r{router;connectedUserService;faEye=Ok;errorMessage;loginForm=new Ec({email:new ko,password:new ko});userSubscription;constructor(t,n){this.router=t,this.connectedUserService=n}ngOnInit(){var t=this;this.userSubscription=this.connectedUserService.subscribeToUser(function(){var n=E(function*(i){i!==n0.NOT_CONNECTED&&(yield t.redirect())});return function(i){return n.apply(this,arguments)}}())}loginWithEmail(t){var n=this;return E(function*(){const i=yield n.connectedUserService.doEmailLogin(t.email,t.password);i.isFailure()&&(n.errorMessage=i.getReason())})()}loginWithGoogle(){var t=this;return E(function*(){const n=yield t.connectedUserService.doGoogleLogin();n.isFailure()&&(t.errorMessage=n.getReason())})()}redirect(){var t=this;return E(function*(){return t.router.navigate(["/lobby"])})()}canLogin(){return!(""===(this.loginForm.value.email??"")||""===(this.loginForm.value.password??""))}ngOnDestroy(){this.userSubscription.unsubscribe()}static \u0275fac=function(n){return new(n||r)(G(Xn),G(hr))};static \u0275cmp=$e({type:r,selectors:[["app-login"]],decls:49,vars:8,consts:()=>{let t,n,i,o,s,a,c,l,u,f,g,y;return t=$localize`Log in`,n=$localize`Email`,i=$localize`Email`,o=$localize`Password`,s=$localize`Password`,a=$localize`Log in`,c=$localize`Log in with Google`,l=$localize`No account?`,u=$localize`Register`,f=$localize`Forgot your password?`,g=$localize`Reset your password`,y=$localize`Connection error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",i,"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],o,[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",s,"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],a,["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],c,["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],l,[3,"routerLink"],u,f,g,["role","alert",1,"message","is-danger"],[1,"message-header"],y,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(M(0,"div",0)(1,"p",1),ae(2,2),P(),M(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),ae(7,7),P()(),M(8,"div",8)(9,"div",9)(10,"div",10),V(11,"input",11),P()()()(),M(12,"div",4)(13,"div",5)(14,"label",12),ae(15,13),P()(),M(16,"div",8)(17,"div",9)(18,"div",14),V(19,"input",15),M(20,"span",16),V(21,"fa-icon",17),P()()()()(),M(22,"div",4),V(23,"div",5),M(24,"div",8)(25,"div",9)(26,"div",10)(27,"button",18),W("click",function(){return i.loginWithEmail(i.loginForm.value)}),ae(28,19),P()()()()(),M(29,"div",4),V(30,"div",5),M(31,"div",8)(32,"div",9)(33,"div",10)(34,"button",20),W("click",function(){return i.loginWithGoogle()}),ae(35,21),P()()()()(),z(36,Egt,5,1,"div",22),M(37,"p",23),jt(38),ae(39,24),Zt(),st(40,"\xa0 "),M(41,"a",25),ae(42,26),P()(),M(43,"p",23),jt(44),ae(45,27),Zt(),st(46,"\xa0 "),M(47,"a",25),ae(48,28),P()()()()),2&n&&(m(3),v("formGroup",i.loginForm),m(18),v("icon",i.faEye),m(6),v("disabled",!i.canLogin()),m(9),v("ngIf",i.errorMessage),m(5),v("routerLink",ur(6,Pgt)),m(6),v("routerLink",ur(7,Sgt)))},dependencies:[Tt,Ac,F4,wa,Mc,H4,$4,U4,u6,e0,rR,yse],encapsulation:2})}return r})(),Tgt=(()=>{class r{partDAO;constructor(t){this.partDAO=t}subscribeToActiveParts(t){let n=[];const a=new pC(c=>{n=n.concat(...c),t(n)},c=>{const l=n;for(const u of c)l.forEach(f=>{f.id===u.id&&(f.data=u.data)});n=l,t(n)},c=>{const l=[];for(const u of n)c.every(f=>f.id!==u.id)&&l.push(u);n=l,t(n)});return this.partDAO.observingWhere([["result","==",rr.UNACHIEVED.value]],a)}static \u0275fac=function(n){return new(n||r)(Ae(cd))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Agt=(()=>{class r{transform(t){return QF(1e3*t.seconds,"HH:mm:ss","en-US")}static \u0275fac=function(n){return new(n||r)};static \u0275pipe=I2({name:"firestoreTime",type:r,pure:!0})}return r})();const wgt=["chatDiv"];function Ngt(r,e){1&r&&(jt(0),ae(1,5),Zt())}function Igt(r,e){1&r&&ae(0,6),2&r&&(Un(p().unreadMessagesText),Zn(0))}function kgt(r,e){if(1&r){const t=de();M(0,"button",11),W("click",function(){return te(t),ne(p(2).scrollToBottom())}),st(1),P()}if(2&r){const t=p(2);m(),ri("",t.unreadMessagesText," \u2193")}}function Rgt(r,e){if(1&r&&(M(0,"p"),st(1),Ta(2,"firestoreTime"),M(3,"b",12),st(4),P(),M(5,"span",13),st(6),P()()),2&r){const t=e.$implicit;m(),ri(" [",_c(2,3,t.postedTime),"] "),m(3),ri("",t.sender.name," : "),m(2),mn(t.content)}}function xgt(r,e){if(1&r){const t=de();M(0,"div"),z(1,kgt,2,1,"button",7),M(2,"div",8,9),W("scroll",function(){return te(t),ne(p().updateCurrentScrollPosition())}),z(4,Rgt,7,5,"p",10),P()()}if(2&r){const t=p();m(),v("ngIf",t.showUnreadMessagesButton),m(3),v("ngForOf",t.chat)}}const Lgt=()=>({standalone:!0});function zgt(r,e){if(1&r){const t=de();M(0,"form",14),W("onSubmit",function(){return te(t),ne(p().sendMessage())}),M(1,"div",15)(2,"div",16)(3,"input",17,18),W("ngModelChange",function(i){return te(t),ne(p().userMessage=i)}),P(),M(5,"p",19),st(6),P()(),M(7,"div",20)(8,"button",21),W("click",function(){return te(t),ne(p().sendMessage())}),V(9,"fa-icon",22),P()()(),M(10,"div",23)(11,"p")(12,"strong"),ae(13,24),P()()()()}if(2&r){const t=Pn(4),n=p();m(3),v("ngModel",n.userMessage)("ngModelOptions",ur(4,Lgt)),m(3),ri("",t.value.length,"/128"),m(3),v("icon",n.faReply)}}let Ev=class yR{chatService;connectedUserService;chatId;turn;userMessage="";connected=!1;chat=[];readMessages=0;unreadMessagesText="";showUnreadMessagesButton=!1;visible=!0;faReply=uk;isNearBottom=!0;notYetScrolled=!0;chatSubscription;chatDiv;constructor(e,t){this.chatService=e,this.connectedUserService=t}ngOnInit(){hn(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}ngAfterViewChecked(){this.scrollToBottomIfNeeded()}loadChatContent(){const e=n=>{this.updateMessages(n.flatMap(i=>null==i.data.postedTime?[]:[i.data]))},t=new pC(e,e,()=>{});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,t)}updateMessages(e){this.chat=this.chat.concat(e);const t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}updateUnreadMessagesText(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize`no new message`,this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize`1 new message`:$localize`${e} new messages`}scrollToBottomIfNeeded(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}updateCurrentScrollPosition(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}scrollToBottom(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}scrollTo(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}sendMessage(){var e=this;return E(function*(){const t=e.userMessage;e.userMessage="";const n=e.connectedUserService.user.get().toMinimalUser();yield e.chatService.sendMessage(e.chatId,n,t,e.turn)})()}ngOnDestroy(){this.chatSubscription.unsubscribe()}switchChatVisibility(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}static \u0275fac=function(t){return new(t||yR)(G(Y5),G(hr))};static \u0275cmp=$e({type:yR,selectors:[["app-chat"]],viewQuery:function(t,n){if(1&t&&O3(wgt,5),2&t){let i;pc(i=mc())&&(n.chatDiv=i.first)}},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:()=>{let e,t,n,i;return e=$localize`Hide chat`,t=$localize`Show chat (${"\ufffd0\ufffd"}:INTERPOLATION:)`,n=$localize`Type your message here`,i=$localize`Be polite`,[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],e,t,["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",n,"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],i]},template:function(t,n){if(1&t&&(M(0,"div")(1,"button",0),W("click",function(){return n.switchChatVisibility()}),z(2,Ngt,2,0,"ng-container",1)(3,Igt,1,1,"ng-template",null,2,wn),P(),z(5,xgt,5,2,"div",3)(6,zgt,14,5,"form",4),P()),2&t){const i=Pn(4);m(2),v("ngIf",n.visible)("ngIfElse",i),m(3),v("ngIf",n.visible),m(),v("ngIf",n.visible)}},dependencies:[Nt,Tt,F4,wa,Mc,H4,KP,Y7,Z7,e0,Agt],encapsulation:2})};Ev=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],Ev);let Mse=(()=>{class r{router;currentGameService;messageDisplayer;selectedGame;constructor(t,n,i){this.router=t,this.currentGameService=n,this.messageDisplayer=i}pickGame(t){this.selectedGame=t}navigateToOnlineGameCreation(){var t=this;return E(function*(){const n=t.currentGameService.canUserCreate();n.isSuccess()?yield t.router.navigate(["/play",t.selectedGame]):t.messageDisplayer.criticalMessage(n.getReason())})()}static \u0275fac=function(n){return new(n||r)(G(Xn),G(qo),G(Ut))};static \u0275cmp=$e({type:r,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:()=>{let t;return t=$localize`Create an online game`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(M(0,"app-pick-game",0),W("pickGame",function(s){return i.pickGame(s)}),P(),M(1,"button",1),W("click",function(){return i.navigateToOnlineGameCreation()}),ae(2,2),P()),2&n&&(m(),v("disabled",!i.selectedGame))},dependencies:[nk],encapsulation:2})}return r})();function Vgt(r,e){if(1&r&&(jt(0),st(1),Zt()),2&r){const t=p().$implicit;m(),mn(t.data.playerOne.name)}}function Hgt(r,e){1&r&&(jt(0),ae(1,27),Zt())}function Fgt(r,e){if(1&r){const t=de();M(0,"tr",22),W("click",function(){const o=te(t).$implicit;return ne(p(2).joinGame(o))}),M(1,"td",23),st(2),P(),M(3,"td",23),st(4),P(),M(5,"td",23),z(6,Vgt,2,1,"ng-container",24)(7,Hgt,2,0,"ng-template",null,25,wn),P(),M(9,"td",26),st(10),P()()}if(2&r){const t=e.$implicit,n=e.index,i=Pn(8);En("id","part_",n,""),m(2),mn(t.data.typeGame),m(2),mn(t.data.playerZero.name),m(2),v("ngIf",t.data.playerOne)("ngIfElse",i),m(4),mn(t.data.turn+1)}}function Ugt(r,e){if(1&r&&(M(0,"div",13)(1,"div",14)(2,"table",15)(3,"thead")(4,"tr")(5,"th",16),ae(6,17),P(),M(7,"th",16),ae(8,18),P(),M(9,"th",16),ae(10,19),P(),M(11,"th",16),ae(12,20),P()()(),M(13,"tbody"),z(14,Fgt,11,6,"tr",21),P()()()()),2&r){const t=p();m(14),v("ngForOf",t.activeParts)}}function $gt(r,e){1&r&&(M(0,"div",28),V(1,"app-online-game-selection",29),P())}function Ggt(r,e){1&r&&(M(0,"div",30)(1,"div",31)(2,"div",32),V(3,"app-chat",33),P()()()),2&r&&(m(3),v("turn",-1))}let iR=class MR{router;messageDisplayer;activePartsService;currentGameService;activeParts=[];activePartsSubscription;currentGameSubscription;currentTab="games";createTabClasses=[];constructor(e,t,n,i){this.router=e,this.messageDisplayer=t,this.activePartsService=n,this.currentGameService=i}ngOnInit(){this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(e=>{this.activeParts=e}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(e=>{this.createTabClasses=[],e.isPresent()&&(this.createTabClasses=["disabled-tab"])})}ngOnDestroy(){this.activePartsSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}joinGame(e){var t=this;return E(function*(){const n=e.id,i=e.data.typeGame,s=t.currentGameService.canUserJoin(n,null!=e.data.beginning);s.isSuccess()?yield t.router.navigate(["/play",i,n]):t.messageDisplayer.criticalMessage(s.getReason())})()}selectTab(e){if("create"===e){const t=this.currentGameService.canUserCreate();t.isSuccess()?this.currentTab=e:this.messageDisplayer.criticalMessage(t.getReason())}else this.currentTab=e}static \u0275fac=function(t){return new(t||MR)(G(Xn),G(Ut),G(Tgt),G(qo))};static \u0275cmp=$e({type:MR,selectors:[["app-lobby"]],decls:14,vars:4,consts:()=>{let e,t,n,i,o,s,a,c;return e=$localize`Games`,t=$localize`Create`,n=$localize`Chat`,i=$localize`Game`,o=$localize`First player`,s=$localize`Second player`,a=$localize`Turn`,c=$localize`Waiting for opponent`,[[1,"tabs","is-toggle","is-fullwidth"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],e,["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"ngClass","click"],t,["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],n,["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],i,o,s,a,[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],[1,"td","turn"],c,["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],[1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"]]},template:function(t,n){1&t&&(M(0,"div",0)(1,"ul")(2,"li",1)(3,"a",2),W("click",function(){return n.selectTab("games")}),ae(4,3),P()(),M(5,"li",4)(6,"a",5),W("click",function(){return n.selectTab("create")}),ae(7,6),P()(),M(8,"li",7)(9,"a",8),W("click",function(){return n.selectTab("chat")}),ae(10,9),P()()()(),z(11,Ugt,15,1,"div",10)(12,$gt,2,0,"div",11)(13,Ggt,4,1,"div",12)),2&t&&(m(6),v("ngClass",n.createTabClasses),m(5),v("ngIf","games"===n.currentTab),m(),v("ngIf","create"===n.currentTab),m(),v("ngIf","chat"===n.currentTab))},dependencies:[zt,Nt,Tt,Ev,Mse],encapsulation:2})};iR=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],iR);let Bgt=(()=>{class r{constructor(){}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=$e({type:r,selectors:[["app-account"]],decls:11,vars:0,consts:()=>{let t,n,i;return t=$localize`User settings`,n=$localize`If you forgot your password or want to change it, click on the following button:`,i=$localize`Reset password`,[[1,"hero-body"],[1,"title"],t,[1,"box"],[1,"block","level-left"],[1,"level-item"],n,["id","reset","routerLink","/reset-password",1,"button","is-primary","level-item","is-small"],i]},template:function(n,i){1&n&&(M(0,"div",0)(1,"p",1),ae(2,2),P()(),M(3,"div",3)(4,"p",1),st(5,"Resetting password"),P(),M(6,"div",4)(7,"p",5),ae(8,6),P(),M(9,"button",7),ae(10,8),P()()())},dependencies:[Ac],encapsulation:2})}return r})(),Ese=(()=>{class r{route;message;constructor(t){this.route=t,this.message=t.snapshot.paramMap.get("message")??$localize`This page does not exist.`}static \u0275fac=function(n){return new(n||r)(G(uo))};static \u0275cmp=$e({type:r,selectors:[["app-not-found"]],decls:5,vars:1,consts:()=>{let t;return t=$localize`Not found`,[[1,"message","is-danger"],[1,"message-header"],t,[1,"message-body"]]},template:function(n,i){1&n&&(M(0,"div",0)(1,"div",1),ae(2,2),P(),M(3,"div",3),st(4),P()()),2&n&&(m(4),mn(i.message))},encapsulation:2})}return r})();new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");const jgt=new Error("request for lock canceled");class Ygt{constructor(e,t=jgt){this._value=e,this._cancelError=t,this._weightedQueues=[],this._weightedWaiters=[]}acquire(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((t,n)=>{this._weightedQueues[e-1]||(this._weightedQueues[e-1]=[]),this._weightedQueues[e-1].push({resolve:t,reject:n}),this._dispatch()})}runExclusive(e,t=1){return function(r,e,t,n){return new(t||(t=Promise))(function(o,s){function a(u){try{l(n.next(u))}catch(f){s(f)}}function c(u){try{l(n.throw(u))}catch(f){s(f)}}function l(u){u.done?o(u.value):function i(o){return o instanceof t?o:new t(function(s){s(o)})}(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){const[n,i]=yield this.acquire(t);try{return yield e(n)}finally{i()}})}waitForUnlock(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise(t=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),this._weightedWaiters[e-1].push(t),this._dispatch()})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatch()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatch()}cancel(){this._weightedQueues.forEach(e=>e.forEach(t=>t.reject(this._cancelError))),this._weightedQueues=[]}_dispatch(){var e;for(let t=this._value;t>0;t--){const n=null===(e=this._weightedQueues[t-1])||void 0===e?void 0:e.shift();if(!n)continue;const i=this._value,o=t;this._value-=t,t=this._value+1,n.resolve([i,this._newReleaser(o)])}this._drainUnlockWaiters()}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){for(let e=this._value;e>0;e--)this._weightedWaiters[e-1]&&(this._weightedWaiters[e-1].forEach(t=>t()),this._weightedWaiters[e-1]=[])}}class Xgt{constructor(e){this._semaphore=new Ygt(1,e)}acquire(){return function(r,e,t,n){return new(t||(t=Promise))(function(o,s){function a(u){try{l(n.next(u))}catch(f){s(f)}}function c(u){try{l(n.throw(u))}catch(f){s(f)}}function l(u){u.done?o(u.value):function i(o){return o instanceof t?o:new t(function(s){s(o)})}(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){const[,e]=yield this._semaphore.acquire();return e})}runExclusive(e){return this._semaphore.runExclusive(()=>e())}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}let Sse=(()=>{class r{connectedUserService;static requestInfos={TakeBack:{requestType:"TakeBack",textForRequest:()=>$localize`Ask to take back one move`,textForReply:()=>$localize`Your opponent is asking for a take back.`,name:()=>$localize`take back`,icon:Rk},Draw:{requestType:"Draw",textForRequest:()=>$localize`Propose a draw`,textForReply:()=>$localize`Your opponent is proposing a draw.`,name:()=>$localize`draw`,icon:$te},Rematch:{requestType:"Rematch",textForRequest:()=>$localize`Propose a rematch`,textForReply:()=>$localize`Your opponent is proposing a rematch.`,name:()=>$localize`rematch`,icon:Pne}};requestAwaitingReply=h.empty();lastDeniedRequest=h.empty();forbiddenRequests=new ct;constructor(t){this.connectedUserService=t}onGameStart(){this.requestAwaitingReply=h.empty(),this.lastDeniedRequest=h.empty(),this.forbiddenRequests=new ct}onReceivedMove(){this.forbiddenRequests=new ct,this.lastDeniedRequest=h.empty()}onReceivedRequest(t){L.assert(this.requestAwaitingReply.isAbsent(),"Should not receive two requests in a row!"),this.requestAwaitingReply=h.of(t)}onReceivedReply(t){var n=this;return E(function*(){switch(n.requestAwaitingReply=h.empty(),t.reply){case"Accept":return!0;case"Reject":const i=n.connectedUserService.user.get().toMinimalUser();return t.user.id!==i.id&&(n.lastDeniedRequest=h.of(t.requestType),n.forbiddenRequests.add(t.requestType)),!1}})()}canMakeRequest(t){return!(this.requestAwaitingReply.isPresent()||this.forbiddenRequests.contains(t))}getUnrespondedRequestFrom(t){return this.requestAwaitingReply.isPresent()&&this.requestAwaitingReply.get().user.id===t.id?h.of(this.requestAwaitingReply.get().requestType):h.empty()}getCurrentRequest(){return this.requestAwaitingReply}deniedRequest(){return this.lastDeniedRequest}static \u0275fac=function(n){return new(n||r)(Ae(hr))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Jgt=(()=>{class r{turnClocks;globalClocks;allClocks;configRoom=h.empty();players=[h.empty(),h.empty()];takenGlobalTime=we.of(0,0);extraGlobalTime=we.of(0,0);availableTurnTime=we.of(0,0);lastMoveStartTimestamp=h.empty();setClocks(t,n){this.turnClocks=t,this.globalClocks=n,this.allClocks=t.concat(n)}onGameStart(t,n){this.configRoom=h.of(t),this.players=n;for(const i of O.PLAYERS)this.takenGlobalTime.put(i,0),this.extraGlobalTime.put(i,0),this.availableTurnTime.put(i,this.getMoveDurationInMs()),this.globalClocks[i.getValue()].setDuration(this.getPartDurationInMs()),this.turnClocks[i.getValue()].setDuration(this.getMoveDurationInMs());for(const i of this.allClocks)i.start(),i.pause()}getPartDurationInMs(){return 1e3*this.configRoom.get().totalPartDuration}getMoveDurationInMs(){return 1e3*this.configRoom.get().maximalMoveDuration}onReceivedAction(t){switch(t.action){case"AddTurnTime":this.addTurnTime(this.playerOfMinimalUser(t.user));break;case"AddGlobalTime":this.addGlobalTime(this.playerOfMinimalUser(t.user));break;case"StartGame":this.lastMoveStartTimestamp=h.of(t.time);break;case"EndGame":this.onGameEnd()}}playerOfMinimalUser(t){return this.players[0].equalsValue(t)?O.ZERO:(L.assert(this.players[1].equalsValue(t),"MinimalUser should match player one"),O.ONE)}onReceivedMove(t){const n=this.playerOfMinimalUser(t.user),i=t.time,o=this.getMillisecondsElapsedSinceLastMoveStart(i);this.lastMoveStartTimestamp=h.of(i),this.takenGlobalTime.add(n,o),this.availableTurnTime.add(n,-o);const s=n.getOpponent();this.availableTurnTime.put(s,this.getMoveDurationInMs());const a=this.takenGlobalTime.get(s),c=this.getPartDurationInMs()-a;this.globalClocks[s.getValue()].changeDuration(c)}getMillisecondsElapsedSinceLastMoveStart(t){return LQ(this.lastMoveStartTimestamp.get(),t)}onGameEnd(){for(const t of this.allClocks)t.isStarted()&&t.stop();this.updateClocks()}beforeEventsBatch(t){!1===t&&this.pauseAllClocks()}afterEventsBatch(t,n,i){if(this.updateClocks(),!1===t){const o=this.getMillisecondsElapsedSinceLastMoveStart(i);this.turnClocks[n.getValue()].subtract(o),this.globalClocks[n.getValue()].subtract(o),this.resumeClocks(n)}}resumeClocks(t){this.turnClocks[t.getValue()].resume(),this.globalClocks[t.getValue()].resume()}addTurnTime(t){this.availableTurnTime.add(t.getOpponent(),3e4)}addGlobalTime(t){this.extraGlobalTime.add(t.getOpponent(),3e5)}updateClocks(){for(const t of O.PLAYERS){this.turnClocks[t.getValue()].changeDuration(this.availableTurnTime.get(t));const n=this.takenGlobalTime.get(t),i=this.getPartDurationInMs()+this.extraGlobalTime.get(t)-n;this.globalClocks[t.getValue()].changeDuration(i)}}pauseAllClocks(){for(const t of this.allClocks)!1===t.isIdle()&&t.pause()}static \u0275fac=function(n){return new(n||r)};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function ept(r,e){if(1&r&&(M(0,"option",12),st(1),P()),2&r){const t=e.$implicit;v("value",t.name()),m(),ri(" ",t.name()," ")}}function tpt(r,e){if(1&r&&(M(0,"div",24)(1,"div",25),st(2),P()()),2&r){const t=p(2).$implicit,n=p(2);m(),En("id","",t,"_number_config_error"),m(),mn(n.getErrorMessage(t))}}function npt(r,e){if(1&r&&(M(0,"div",17)(1,"div",18)(2,"div",19),V(3,"input",20),M(4,"span",21),V(5,"i",22),P()(),z(6,tpt,3,2,"div",23),P()()),2&r){const t=p().$implicit,n=p(2);m(3),En("id","",t,"_number_config_input"),Tg("placeholder",n.rulesConfigDescription.getI18nName(t)),v("formControlName",t),m(3),v("ngIf",!1===n.isValid(t))}}function rpt(r,e){if(1&r&&(M(0,"div",17)(1,"div",18)(2,"div",26),V(3,"input",27),P()()()),2&r){const t=p().$implicit,n=p(2);m(3),En("id","",t,"_boolean_config_input"),Tg("placeholder",n.rulesConfigDescription.getI18nName(t)),v("formControlName",t)}}function ipt(r,e){if(1&r&&(M(0,"div",13)(1,"div",14)(2,"label",15),st(3),P()(),z(4,npt,7,4,"div",16)(5,rpt,4,3,"div",16),P()),2&r){const t=e.$implicit,n=p(2);En("id","",t,"_config"),m(3),mn(n.rulesConfigDescription.getI18nName(t)),m(),v("ngIf",n.isNumber(t)),m(),v("ngIf",n.isBoolean(t))}}function opt(r,e){1&r&&V(0,"app-demo-card",28),2&r&&v("demoNodeInfo",p(2).getConfigDemo())}function spt(r,e){if(1&r){const t=de();M(0,"div")(1,"p",1),ae(2,2),P(),M(3,"div",3)(4,"select",4),W("change",function(i){return te(t),ne(p().onChange(i))}),M(5,"option",5),st(6),P(),z(7,ept,2,2,"option",6),M(8,"option",7),ae(9,8),P()()(),M(10,"form",9)(11,"fieldset"),z(12,ipt,6,4,"div",10),P()(),z(13,opt,1,1,"app-demo-card",11),P()}if(2&r){const t=p();m(2),Un(t.gameName),Zn(2),m(2),v("disabled",!1===t.userIsCreator),m(),v("value",t.rulesConfigDescription.getDefaultConfig().name()),m(),ri(" ",t.rulesConfigDescription.getDefaultConfig().name()," "),m(),v("ngForOf",t.rulesConfigDescription.getNonDefaultStandardConfigs()),m(3),En("id","",t.getChosenConfigName(),"_values"),v("formGroup",t.rulesConfigForm),m(2),v("ngForOf",t.getFields()),m(),v("ngIf",void 0!==t.getConfigDemo())}}let Ose=(()=>{class r extends NQ{cdr;stateProvider;rulesConfigDescriptionOptional;rulesConfigDescription;rulesConfigToDisplay;userIsCreator;updateCallback=new l1;configDemo;rulesConfigForm=new Ec({});gameName;chosenConfigName="";constructor(t,n){super(t),this.cdr=n}getChosenConfigName(){return this.chosenConfigName}ngOnInit(){if(this.assertParamsAreCoherent(),this.gameName=this.getGameName(),!this.isCustomisable())return this.updateCallback.emit(h.of({}));{const t=this.rulesConfigDescription.getDefaultConfig();if(this.setChosenConfig(t.name()),this.userIsCreator)this.setConfigDemo(t.config);else{const n=L.getNonNullable(this.rulesConfigToDisplay);this.setConfigDemo(n)}}}setConfigDemo(t){if(this.stateProvider.isPresent()){const n=this.stateProvider.get(),i=new ps(n(h.of(t)));this.configDemo={click:h.empty(),name:this.gameName,node:i},this.cdr.detectChanges()}}getConfigDemo(){return this.configDemo}generateForm(t,n){const i={};Object.keys(t).forEach(o=>{const s=this.getRulesConfigDescriptionValue(o,t[o]);i[o]=this.getFormControl(s,n)}),this.rulesConfigForm=new Ec(i)}assertParamsAreCoherent(){!1===this.userIsCreator&&L.assert(null!=this.rulesConfigToDisplay,"Config should be provided to non-creator in RulesConfigurationComponent")}getRulesConfigDescriptionValue(t,n){return this.userIsCreator?n:L.getNonNullable(this.rulesConfigToDisplay)[t]}getFormControl(t,n){const i=new ko(t);return!1===n&&i.disable(),i.valueChanges.subscribe(()=>{this.onUpdate()}),i}onUpdate(){L.assert(this.userIsCreator,"Only creator should be able to modify rules config"),L.assert("Custom"===this.chosenConfigName,"Only Customifiable config should be modified!");const t={},n=this.rulesConfigDescription.getFields();for(const i of n){if(!this.isValid(i))return void this.updateCallback.emit(h.empty());t[i]=this.rulesConfigForm.controls[i].value}this.setConfigDemo(t),this.updateCallback.emit(h.of(t))}isNumber(t){return"number"==typeof this.rulesConfigDescription.getDefaultConfig().config[t]}isBoolean(t){return"boolean"==typeof this.rulesConfigDescription.getDefaultConfig().config[t]}isValid(t){const i=this.rulesConfigDescription.getDefaultConfig().config[t];if("number"==typeof i){const o=this.rulesConfigForm.controls[t].value;return this.rulesConfigDescription.getValidator(t)(o).isSuccess()}return L.expectToBe(typeof i,"boolean"),!0}getErrorMessage(t){const n=this.rulesConfigForm.controls[t].value;return this.rulesConfigDescription.getValidator(t)(n).getReason()}getFields(){return this.rulesConfigDescription.getFields()}onChange(t){this.setChosenConfig(t.target.value)}setChosenConfig(t){let n;this.chosenConfigName=t,"Custom"===this.chosenConfigName?(n=this.rulesConfigDescription.getDefaultConfig().config,this.generateForm(n,this.userIsCreator)):(n=this.rulesConfigDescription.getConfig(this.chosenConfigName),this.generateForm(n,!1),this.updateCallback.emit(h.of(n))),this.setConfigDemo(n)}isCustomisable(){return!this.rulesConfigDescriptionOptional.isAbsent()&&(L.assert(this.rulesConfigDescriptionOptional.get().getFields().length>0,"If rulesConfigDescriptionOptional is present it should have fields !"),this.rulesConfigDescription=this.rulesConfigDescriptionOptional.get(),!0)}static \u0275fac=function(n){return new(n||r)(G(uo),G(zs))};static \u0275cmp=$e({type:r,selectors:[["app-rules-configuration"]],inputs:{stateProvider:"stateProvider",rulesConfigDescriptionOptional:"rulesConfigDescriptionOptional",rulesConfigToDisplay:"rulesConfigToDisplay",userIsCreator:"userIsCreator"},outputs:{updateCallback:"updateCallback"},features:[We],decls:1,vars:1,consts:()=>{let t,n;return t=$localize`Configuration of your ${"\ufffd0\ufffd"}:INTERPOLATION: game`,n=$localize`Custom`,[[4,"ngIf"],[1,"title"],t,[1,"select","is-primary","is-fullwidth"],["id","ruleSelect",3,"disabled","change"],["selected","",3,"value"],[3,"value",4,"ngFor","ngForOf"],["value","Custom"],n,[3,"formGroup","id"],["class","field is-horizontal",3,"id",4,"ngFor","ngForOf"],["id","demoCard",3,"demoNodeInfo",4,"ngIf"],[3,"value"],[1,"field","is-horizontal",3,"id"],[1,"field-label","is-normal"],[1,"label"],["class","field-body",4,"ngIf"],[1,"field-body"],[1,"field"],[1,"control","has-icons-right"],["type","number","required","",1,"input",3,"id","formControlName","placeholder"],[1,"icon","is-small","is-right"],[1,"fas","fa-exclamation-triangle"],["class","message is-danger","role","alert",4,"ngIf"],["role","alert",1,"message","is-danger"],[1,"message-header",3,"id"],[1,"control"],["type","checkbox","required","",1,"checkbox",3,"id","formControlName","placeholder"],["id","demoCard",3,"demoNodeInfo"]]},template:function(n,i){1&n&&z(0,spt,14,9,"div",0),2&n&&v("ngIf",i.isCustomisable())},dependencies:[Nt,Tt,F4,A8,b8,wa,GP,sp,Mc,H4,$4,YP,U4,u6,vse],encapsulation:2})}return r})(),apt=(()=>{class r{transform(t){const n=t%60,i=(t-n)%3600/60,o=(t-60*i-n)/3600,s=[];if(o>1?s.push($localize`${o} hours`):1===o&&s.push($localize`1 hour`),i>1?s.push($localize`${i} minutes`):1===i&&s.push($localize`1 minute`),n>1?s.push($localize`${n} seconds`):1===n&&s.push($localize`1 second`),0===s.length)return $localize`0 seconds`;if(1===s.length)return s[0];{const a=s.slice(0,-1).join(", "),c=s.slice(-1)[0];return $localize`${a} and ${c}`}}static \u0275fac=function(n){return new(n||r)};static \u0275pipe=I2({name:"humanDuration",type:r,pure:!0})}return r})();var Hd;const lpt=["rulesConfigurationComponent"];function upt(r,e){if(1&r&&(jt(0),st(1),Zt()),2&r){const t=p(3);m(),mn(t.viewInfo.chosenOpponent)}}function fpt(r,e){1&r&&ae(0,45)}function dpt(r,e){if(1&r&&(M(0,"div",46)(1,"div",8)(2,"label",47),jt(3),ae(4,48),Zt(),M(5,"output"),st(6),Ta(7,"humanDuration"),P()(),M(8,"div",37),V(9,"input",49),P()(),M(10,"div",8)(11,"label",50),No(12,51),V(13,"output"),Ta(14,"humanDuration"),Io(),P(),M(15,"div",37),V(16,"input",52),P()()()),2&r){const t=p(3);m(6),mn(_c(7,2,t.viewInfo.maximalMoveDuration||0)),m(8),Un(_c(14,4,t.viewInfo.totalPartDuration||0)),Zn(12)}}function hpt(r,e){1&r&&(M(0,"div"),No(1,53),V(2,"br"),Io(),P())}function gpt(r,e){1&r&&(M(0,"button",65),ae(1,66),P())}function ppt(r,e){if(1&r){const t=de();M(0,"tr",61),W("click",function(){const o=te(t).$implicit;return ne(p(4).selectOpponent(o))}),M(1,"td",62),st(2),P(),M(3,"td",63),z(4,gpt,2,0,"button",64),P()()}if(2&r){const t=e.$implicit,n=p(4);En("id","presenceOf_",t,""),v("ngClass",n.viewInfo.candidateClasses[t]),m(),v("id",n.viewInfo.chosenOpponent===t?"selected_"+t:"candidate_"+t),m(),mn(t),m(2),v("ngIf",n.viewInfo.chosenOpponent!==t)}}function mpt(r,e){if(1&r&&(jt(0),ae(1,54),Zt(),M(2,"div",55)(3,"table",56)(4,"thead")(5,"tr")(6,"th",57),ae(7,58),P(),M(8,"th",57),ae(9,59),P()()(),M(10,"tbody"),z(11,ppt,5,5,"tr",60),P()()()),2&r){const t=p(3);m(11),v("ngForOf",t.viewInfo.candidates)}}function _pt(r,e){if(1&r){const t=de();M(0,"button",67),W("click",function(){return te(t),ne(p(3).changeConfig())}),ae(1,68),P()}}function Cpt(r,e){if(1&r){const t=de();M(0,"div")(1,"h1",4),ae(2,5),P(),M(3,"form",6)(4,"fieldset",7)(5,"div",8)(6,"label",9),ae(7,10),P(),M(8,"div",11)(9,"button",12),W("click",function(){return te(t),ne(p(2).selectFirstPlayer("RANDOM"))}),ae(10,13),P(),M(11,"button",14),W("click",function(){return te(t),ne(p(2).selectFirstPlayer("CREATOR"))}),ae(12,15),P(),M(13,"button",16),W("click",function(){return te(t),ne(p(2).selectFirstPlayer("CHOSEN_PLAYER"))}),z(14,upt,2,1,"ng-container",17)(15,fpt,1,0,"ng-template",null,18,wn),P()()(),M(17,"div",8)(18,"label",9),ae(19,19),P(),M(20,"div",11)(21,"div",20),W("click",function(){return te(t),ne(p(2).selectPartType("STANDARD"))}),M(22,"div",21)(23,"span"),ae(24,22),P()(),M(25,"div",23)(26,"div",24)(27,"div",25)(28,"p"),jt(29),ae(30,26),Zt(),M(31,"strong"),st(32),Ta(33,"humanDuration"),P(),V(34,"br"),jt(35),No(36,27),V(37,"strong"),Ta(38,"humanDuration"),Io(),Zt(),P()()()()(),M(39,"div",28),W("click",function(){return te(t),ne(p(2).selectPartType("BLITZ"))}),M(40,"div",21)(41,"span"),ae(42,29),P()(),M(43,"div",23)(44,"div",24)(45,"div",25)(46,"p"),jt(47),ae(48,30),Zt(),M(49,"strong"),st(50),Ta(51,"humanDuration"),P(),V(52,"br"),jt(53),No(54,31),V(55,"strong"),Ta(56,"humanDuration"),Io(),Zt(),P()()()()(),M(57,"button",32),W("click",function(){return te(t),ne(p(2).selectPartType("CUSTOM"))}),ae(58,33),P()()(),z(59,dpt,17,6,"div",34),M(60,"div",8)(61,"label",35),ae(62,36),P(),M(63,"div",37),z(64,hpt,3,0,"div",17)(65,mpt,12,1,"ng-template",null,38,wn),P()(),M(67,"app-rules-configuration",39),W("updateCallback",function(i){return te(t),ne(p(2).saveRulesConfig(i))}),P()(),M(68,"div",8)(69,"div",11)(70,"button",40),W("click",function(){return te(t),ne(p(2).proposeConfig())}),ae(71,41),P(),z(72,_pt,2,0,"button",42),M(73,"button",43),W("click",function(){return te(t),ne(p(2).cancelGameCreation())}),ae(74,44),P()()()()()}if(2&r){const t=Pn(16),n=Pn(66),i=p(2);m(3),v("formGroup",i.configFormGroup),m(),v("disabled",!i.viewInfo.canEditConfig),m(5),v("ngClass",i.viewInfo.firstPlayerClasses.RANDOM),m(2),v("ngClass",i.viewInfo.firstPlayerClasses.CREATOR),m(2),v("ngClass",i.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),m(),v("ngIf",i.viewInfo.chosenOpponent)("ngIfElse",t),m(7),v("ngClass",i.viewInfo.partTypeClasses.STANDARD),m(11),mn(_c(33,22,i.partType.NORMAL_MOVE_DURATION)),m(6),Un(_c(38,24,i.partType.NORMAL_PART_DURATION)),Zn(36),m(),v("ngClass",i.viewInfo.partTypeClasses.BLITZ),m(11),mn(_c(51,26,i.partType.BLITZ_MOVE_DURATION)),m(6),Un(_c(56,28,i.partType.BLITZ_PART_DURATION)),Zn(54),m(),v("ngClass",i.viewInfo.partTypeClasses.CUSTOM),m(2),v("ngIf",i.viewInfo.showCustomTime),m(5),v("ngIf",0===i.viewInfo.candidates.length)("ngIfElse",n),m(3),v("stateProvider",i.getStateProvider())("rulesConfigDescriptionOptional",i.rulesConfigDescription)("userIsCreator",!0),m(3),v("disabled",!(i.viewInfo.canProposeConfig&&i.rulesConfig.isPresent())),m(2),v("ngIf",i.viewInfo.canReviewConfig)}}function vpt(r,e){if(1&r&&(M(0,"div",75)(1,"p"),No(2,76),V(3,"br"),Io(),P()()),2&r){const t=p(3);m(3),Un(t.viewInfo.creator),Zn(2)}}function ypt(r,e){if(1&r&&(M(0,"span"),ae(1,83),P()),2&r){const t=p(4);m(),Un(t.viewInfo.creator),Zn(1)}}function Mpt(r,e){1&r&&(M(0,"span"),ae(1,84),P())}function Ept(r,e){1&r&&(M(0,"span"),ae(1,85),P())}function Ppt(r,e){if(1&r){const t=de();M(0,"div",75)(1,"p"),ae(2,77),P(),M(3,"ul")(4,"li"),z(5,ypt,2,1,"span",2)(6,Mpt,2,0,"span",2)(7,Ept,2,0,"span",2),P(),M(8,"li"),No(9,78),V(10,"strong"),Ta(11,"humanDuration"),Io(),P(),M(12,"li"),No(13,79),V(14,"strong"),Ta(15,"humanDuration"),Io(),P()(),V(16,"app-rules-configuration",80),M(17,"button",81),W("click",function(){return te(t),ne(p(3).acceptConfig())}),ae(18,82),P()()}if(2&r){const t=p(3);m(2),Un(t.viewInfo.creator)(t.viewInfo.partTypeName),Zn(2),m(3),v("ngIf","CREATOR"===t.viewInfo.firstPlayer),m(),v("ngIf","CHOSEN_PLAYER"===t.viewInfo.firstPlayer),m(),v("ngIf","RANDOM"===t.viewInfo.firstPlayer),m(4),Un(_c(11,11,t.viewInfo.maximalMoveDuration||0)),Zn(9),m(4),Un(_c(15,13,t.viewInfo.totalPartDuration||0)),Zn(13),m(),v("rulesConfigDescriptionOptional",t.rulesConfigDescription)("stateProvider",t.getStateProvider())("userIsCreator",!1)("rulesConfigToDisplay",null==t.currentConfigRoom?null:t.currentConfigRoom.rulesConfig)}}function Spt(r,e){if(1&r&&(M(0,"div")(1,"div",69)(2,"div",70)(3,"p"),ae(4,71),P()(),M(5,"div",72),z(6,vpt,4,1,"div",73)(7,Ppt,19,15,"ng-template",null,74,wn),P()()()),2&r){const t=Pn(8),n=p(2);m(6),v("ngIf",n.viewInfo.creatorIsModifyingConfig)("ngIfElse",t)}}function Opt(r,e){if(1&r&&(jt(0),ae(1,88),Zt()),2&r){const t=p(3);m(),Un(t.viewInfo.creator),Zn(1)}}function Tpt(r,e){if(1&r&&ae(0,89),2&r){const t=p(3);Un(t.viewInfo.creator)(t.viewInfo.chosenOpponent),Zn(0)}}function Apt(r,e){if(1&r&&(M(0,"div",69)(1,"div",70)(2,"p"),ae(3,86),P()(),M(4,"div",72)(5,"p"),z(6,Opt,2,1,"ng-container",17)(7,Tpt,1,2,"ng-template",null,87,wn),P()()()),2&r){const t=Pn(8),n=p(2);m(6),v("ngIf",n.viewInfo.creatorIsModifyingConfig)("ngIfElse",t)}}function bpt(r,e){if(1&r&&(M(0,"div",1),z(1,Cpt,75,30,"div",2)(2,Spt,9,2,"div",2)(3,Apt,9,2,"div",3),P()),2&r){const t=p();m(),v("ngIf",t.viewInfo.userIsCreator),m(),v("ngIf",t.viewInfo.userIsChosenOpponent),m(),v("ngIf",t.viewInfo.userIsObserver)}}let oR=class ER{static#e=Hd=this;router;activatedRoute;connectedUserService;currentGameService;gameService;configRoomService;chatService;userService;formBuilder;messageDisplayer;static TOKEN_INTERVAL=5e3;static TOKEN_TIMEOUT=1e4;partType=Bi;partId;rulesConfigDescription;gameStartNotification=new l1;rulesConfigurationComponent;gameStarted=!1;viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]};currentConfigRoom=null;candidates=[];ngUnsubscribe=new xs;allUserInterval=h.empty();ownTokenInterval=h.empty();lastToken;selfSubscription=new Ue;configRoomSubscription=Ue.EMPTY;candidatesSubscription=Ue.EMPTY;configFormGroup;allDocDeleted=!1;rulesConfig=h.empty();constructor(e,t,n,i,o,s,a,c,l,u){this.router=e,this.activatedRoute=t,this.connectedUserService=n,this.currentGameService=i,this.gameService=o,this.configRoomService=s,this.chatService=a,this.userService=c,this.formBuilder=l,this.messageDisplayer=u}ngOnInit(){var e=this;return E(function*(){e.checkInputs(),e.createForms();const t=yield e.configRoomService.joinGame(e.partId);if(t.isFailure()){const n=t.getReason();e.messageDisplayer.criticalMessage(n)}else yield e.startSendingPresenceTokens(),e.subscribeToConfigRoomDoc(),e.subscribeToFormElements()})()}checkInputs(){const e=this.connectedUserService.user;L.assert(e.isPresent(),"PartCreationComponent should not be called without connected user"),L.assert(e.get()!==n0.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),L.assert(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}createForms(){this.configFormGroup=this.formBuilder.group({firstPlayer:[m2.RANDOM.value,$7.required],maximalMoveDuration:[Bi.NORMAL_MOVE_DURATION,$7.required],partType:["STANDARD",$7.required],totalPartDuration:[Bi.NORMAL_PART_DURATION,$7.required],chosenOpponent:["",$7.required]})}updateUserDocWithCurrentGame(e){const t=this.getUserRoleInPart(e),n={id:this.partId,opponent:this.getOpponent(e),typeGame:this.getGameUrlName(),role:t};return this.currentGameService.updateCurrentGame(n)}getUserRoleInPart(e){const t=this.connectedUserService.user.get().id;return t===e.creator.id?"Creator":t===e.chosenOpponent?.id?"ChosenOpponent":"Candidate"}getOpponent(e){let t=null;return t=this.connectedUserService.user.get().id===e.creator.id?e.chosenOpponent:e.creator,t}subscribeToConfigRoomDoc(){var e=this;const t=function(){var i=E(function*(o){yield e.onCandidatesUpdate(o)});return function(s){return i.apply(this,arguments)}}(),n=function(){var i=E(function*(o){yield e.onCurrentConfigRoomUpdate(o),o.isPresent()&&e.candidatesSubscription===Ue.EMPTY&&(e.candidatesSubscription=e.configRoomService.subscribeToCandidates(e.partId,t))});return function(s){return i.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,n)}getForm(e){return L.getNonNullable(this.configFormGroup.get(e))}subscribeToFormElements(){this.getForm("chosenOpponent").valueChanges.pipe(R8(this.ngUnsubscribe)).subscribe(e=>{void 0!==this.viewInfo.chosenOpponent&&(this.viewInfo.candidateClasses[this.viewInfo.chosenOpponent]=[]),this.viewInfo.candidateClasses[e]=["is-selected"],this.viewInfo.chosenOpponent=e;const t=L.getNonNullable(this.currentConfigRoom).partStatus;this.viewInfo.canProposeConfig=t!==_2.CONFIG_PROPOSED.value&&""!==e}),this.getForm("partType").valueChanges.pipe(R8(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.partTypeClasses[this.viewInfo.partType]=[],this.viewInfo.partTypeClasses[e]=["is-primary","is-selected"],this.viewInfo.partType=e,this.viewInfo.showCustomTime="CUSTOM"===e}),this.getForm("maximalMoveDuration").valueChanges.pipe(R8(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.maximalMoveDuration=e}),this.getForm("totalPartDuration").valueChanges.pipe(R8(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.totalPartDuration=e}),this.getForm("firstPlayer").valueChanges.pipe(R8(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.firstPlayerClasses[this.viewInfo.firstPlayer]=[],this.viewInfo.firstPlayerClasses[e]=["is-primary","is-selected"],this.viewInfo.firstPlayer=e})}updateViewInfo(e){const t=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=e.partStatus===_2.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=e.partStatus!==_2.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userIsCreator(e),this.viewInfo.userIsChosenOpponent=t.id===e.chosenOpponent?.id,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=e.partStatus!==_2.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=e.creator.name,this.viewInfo.candidates=this.candidates.map(n=>n.name),this.userIsCreator(e)?this.setDataForCreator(e):(this.viewInfo.maximalMoveDuration=e.maximalMoveDuration,this.viewInfo.totalPartDuration=e.totalPartDuration,this.viewInfo.partType=e.partType,this.viewInfo.chosenOpponent=e.chosenOpponent?.name,this.viewInfo.firstPlayer=e.firstPlayer),e.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize`custom`;break;case"BLITZ":this.viewInfo.partTypeName=$localize`blitz`;break;case"STANDARD":this.viewInfo.partTypeName=$localize`standard`}}setDataForCreator(e){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration??e.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration??e.totalPartDuration;let t=this.viewInfo.chosenOpponent;null==t||""===t?t=e.chosenOpponent?.name??"":!1===this.candidates.some(i=>i.name===t)&&(t=""),this.getForm("chosenOpponent").setValue(t)}selectFirstPlayer(e){this.getForm("firstPlayer").setValue(e)}selectPartType(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(Bi.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Bi.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(Bi.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Bi.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}selectOpponent(e){var t=this;return E(function*(){const n=t.getUserFromName(e);yield Promise.all([t.currentGameService.updateCurrentGame({opponent:n}),t.configRoomService.setChosenOpponent(t.partId,n)])})()}getUserFromName(e){const t=this.candidates.find(n=>n.name===e);return L.getNonNullable(t)}changeConfig(){var e=this;return E(function*(){return e.configRoomService.reviewConfig(e.partId)})()}proposeConfig(){var e=this;return E(function*(){const t=e.getForm("chosenOpponent").value,n=e.getForm("partType").value,i=e.getForm("maximalMoveDuration").value,o=e.getForm("firstPlayer").value,s=e.getForm("totalPartDuration").value,a=e.getUserFromName(t);return e.configRoomService.proposeConfig(e.partId,a,Bi.of(n),i,m2.of(o),s,e.rulesConfig)})()}cancelGameCreation(){var e=this;return E(function*(){e.allDocDeleted=!0,yield e.currentGameService.removeCurrentGame(),Ne.display("PartCreationComponent","cancelGameCreation","observed part removed"),yield e.chatService.deleteChat(e.partId),Ne.display("PartCreationComponent","cancelGameCreation","chat deleted"),yield e.gameService.deletePart(e.partId),Ne.display("PartCreationComponent","cancelGameCreation","chat and part deleted"),yield e.configRoomService.deleteConfigRoom(e.partId,e.candidates),Ne.display("PartCreationComponent","cancelGameCreation","chat, part, and configRoom deleted")})()}onCurrentConfigRoomUpdate(e){var t=this;return E(function*(){if(e.isAbsent())return Ne.display("PartCreationComponent","onCurrentConfigRoomUpdate","LAST UPDATE : the game is cancelled"),t.onGameCanceled();{const n=t.currentConfigRoom,i=e.get();if(t.currentConfigRoom=i,t.rulesConfig.isAbsent()&&(t.rulesConfig=h.of(i.rulesConfig)),t.chosenOpponentJustLeft(n,i)&&t.userIsCreator(i)){const o=L.getNonNullable(n?.chosenOpponent).name;t.messageDisplayer.infoMessage($localize`${o} left the game, please pick another opponent.`),yield t.currentGameService.updateCurrentGame({opponent:null})}(t.userJustChosenAsOpponent(n,i)||t.allUserInterval.isAbsent())&&(yield t.updateUserDocWithCurrentGame(i)),t.allUserInterval.isAbsent()&&(yield t.observeNeededPlayers(i)),t.updateViewInfo(i),t.isGameStarted(i)&&(Ne.display("PartCreationComponent","onCurrentConfigRoomUpdate","the game has started"),t.onGameStarted())}})()}onCandidatesUpdate(e){var t=this;return E(function*(){t.candidates=e,t.updateViewInfo(L.getNonNullable(t.currentConfigRoom))})()}userJustChosenAsOpponent(e,t){if(this.isGameStarted(t))return!1;{const n=this.connectedUserService.user.get().id;return e?.chosenOpponent?.id!==n&&t.chosenOpponent?.id===n}}chosenOpponentJustLeft(e,t){return null!=e&&(null!=e.chosenOpponent&&null==t.chosenOpponent)}onGameCanceled(){var e=this;return E(function*(){e.messageDisplayer.infoMessage($localize`The game has been canceled!`),yield e.router.navigate(["/lobby"])})()}isGameStarted(e){return L.assert(null!=e,"configRoom should not be null (isGameStarted)"),L.getNonNullable(e).partStatus===_2.PART_STARTED.value}onGameStarted(){const e=L.getNonNullable(this.currentConfigRoom);this.gameStartNotification.emit(e),this.gameStarted=!0}observeNeededPlayers(e){var t=this;return E(function*(){L.assert(t.allUserInterval.isAbsent(),"Cannot observe players multiple times"),t.allUserInterval=h.of(window.setInterval(E(function*(){const n=t.lastToken;t.userIsCreator(e)?yield t.checkCandidatesTokensFreshness(n):yield t.checkCreatorTokenFreshness(n)}),Hd.TOKEN_INTERVAL))})()}userIsCreator(e){return this.connectedUserService.user.get().id===e.creator.id}checkCreatorTokenFreshness(e){var t=this;return E(function*(){const n=L.getNonNullable(t.currentConfigRoom);(yield t.didUserTimeout(n.creator.id,e))&&(yield t.destroyDocIfPartDidNotStart())})()}destroyDocIfPartDidNotStart(){var e=this;return E(function*(){const t=e.isGameStarted(e.currentConfigRoom);L.assert(!1===t,"Should not try to cancelGameCreation when part started!"),L.assert(!1===e.allDocDeleted,"Should not delete doc twice"),yield e.cancelGameCreation()})()}checkCandidatesTokensFreshness(e){var t=this;return E(function*(){for(const n of t.candidates)(yield t.didUserTimeout(n.id,e))&&(yield t.removeCandidateFromLobby(n))})()}didUserTimeout(e,t){var n=this;return E(function*(){const i=yield n.userService.getUserLastUpdateTime(e);return i.isAbsent()?(Gi.logError("PartCreationComponent","found no user while observing "+e+" !"),!0):LQ(i.get(),t)>Hd.TOKEN_TIMEOUT})()}removeCandidateFromLobby(e){var t=this;return E(function*(){const n=L.getNonNullable(t.currentConfigRoom);return e.id===n.chosenOpponent?.id&&(yield t.configRoomService.reviewConfigAndRemoveChosenOpponent(t.partId)),t.configRoomService.removeCandidate(t.partId,e)})()}startSendingPresenceTokens(){var e=this;return E(function*(){yield e.connectedUserService.sendPresenceToken(),L.assert(e.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),e.ownTokenInterval=h.of(window.setInterval(()=>{e.connectedUserService.sendPresenceToken()},Hd.TOKEN_INTERVAL));const t=e.connectedUserService.user.get().id;e.selfSubscription=e.userService.observeUserOnServer(t,n=>{L.assert(n.isPresent(),"connected user should exist"),e.lastToken=L.getNonNullable(n.get().lastUpdateTime)})})()}stopSendingPresenceTokensAndObservingUsersIfNeeded(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=h.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}acceptConfig(){return this.gameService.acceptConfig(this.partId,L.getNonNullable(this.currentConfigRoom))}saveRulesConfig(e){this.rulesConfig=e}getGameUrlName(){return L.getNonNullable(this.activatedRoute.snapshot.paramMap.get("compo"))}getStateProvider(){const e=this.getGameUrlName(),t=Vt.getByUrlName(e).get().rules;return h.of(i=>t.getInitialState(i))}ngOnDestroy(){var e=this;return E(function*(){if(e.ngUnsubscribe.next(),e.ngUnsubscribe.complete(),e.configRoomSubscription.unsubscribe(),e.candidatesSubscription.unsubscribe(),e.stopSendingPresenceTokensAndObservingUsersIfNeeded(),e.connectedUserService.user.isAbsent())return;const t=e.connectedUserService.user.get();!0!==e.gameStarted&&(null===e.currentConfigRoom?Ne.display("PartCreationComponent","ngOnDestroy","there is no part here"):!0===e.allDocDeleted?Ne.display("PartCreationComponent","ngOnDestroy","part has already been deleted"):t.id===e.currentConfigRoom.creator.id?(Ne.display("PartCreationComponent","ngOnDestroy","you(creator) about to cancel creation."),yield e.cancelGameCreation()):(Ne.display("PartCreationComponent","ngOnDestroy","you are about to cancel game joining"),yield e.currentGameService.removeCurrentGame(),yield e.configRoomService.cancelJoining(e.partId)))})()}static \u0275fac=function(t){return new(t||ER)(G(Xn),G(uo),G(hr),G(qo),G(Su),G(Id),G(Y5),G(K5),G(Bhe),G(Ut))};static \u0275cmp=$e({type:ER,selectors:[["app-part-creation"]],viewQuery:function(t,n){if(1&t&&O3(lpt,5),2&t){let i;pc(i=mc())&&(n.rulesConfigurationComponent=i.first)}},inputs:{partId:"partId",rulesConfigDescription:"rulesConfigDescription"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:()=>{let e,t,n,i,o,s,a,c,l,u,f,g,y,S,I,R,U,$,oe,_e,Te,Fe,mt,rn,a1,dn,Gd,f3,Tu,Bd,Wd,ht,Ot,Lt,Dn,Jr;return e=$localize`Game creation`,t=$localize`First player`,n=$localize`Random`,i=$localize`You`,o=$localize`Game type`,s=$localize`Standard`,a=$localize`Maximal turn duration: `,c=$localize`Maximal game duration: ${"\ufffd#37\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#37\ufffd"}:CLOSE_TAG_STRONG:`,l=$localize`Blitz`,u=$localize`Maximal turn duration: `,f=$localize`Maximal game duration: ${"\ufffd#55\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#55\ufffd"}:CLOSE_TAG_STRONG:`,g=$localize`Custom`,y=$localize`Opponents`,S=$localize`Propose configuration`,I=$localize`Cancel game`,R=$localize`The opponent`,U=$localize`Maximal turn duration: `,$=$localize`Maximal game duration: ${"\ufffd#13\ufffd"}:START_TAG_OUTPUT:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#13\ufffd"}:CLOSE_TAG_OUTPUT:`,oe=$localize`Potential opponents that join the game will appear here.${"\ufffd#2\ufffd\ufffd/#2\ufffd"}:LINE_BREAK:Wait for an opponent to join, so that you can pick one.`,_e=$localize`Click on the opponent against which you would like to play.`,Te=$localize`Name`,Fe=$localize`Actions`,mt=$localize`Pick`,rn=$localize`Change configuration`,a1=$localize`Configuration proposal`,dn=$localize`You have been selected as the opponent.${"\ufffd#3\ufffd\ufffd/#3\ufffd"}:LINE_BREAK: ${"\ufffd0\ufffd"}:INTERPOLATION: is modifying the configuration.`,Gd=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: proposes to play a ${"\ufffd1\ufffd"}:INTERPOLATION_1: game`,f3=$localize`a turn lasts at most ${"\ufffd#10\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#10\ufffd"}:CLOSE_TAG_STRONG:`,Tu=$localize`the game lasts at most ${"\ufffd#14\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#14\ufffd"}:CLOSE_TAG_STRONG:`,Bd=$localize`Accept and start`,Wd=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: plays first`,ht=$localize`you play first`,Ot=$localize`the first player is selected randomly`,Lt=$localize`One moment...`,Dn=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: is configuring the game.`,Jr=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has proposed a configuration to ${"\ufffd1\ufffd"}:INTERPOLATION_1:.`,[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],e,[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],t,[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],n,["id","firstPlayerCreator",1,"button",3,"ngClass","click"],i,["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],o,["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],s,["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],a,c,["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],l,u,f,["id","partTypeCustom",1,"button",3,"ngClass","click"],g,["id","customTime",4,"ngIf"],[1,"label"],y,[1,"control"],["chooseOpponent",""],["id","rulesConfigurationComponent",3,"stateProvider","rulesConfigDescriptionOptional","userIsCreator","updateCallback"],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],S,["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],I,R,["id","customTime"],["for","maximalMoveDuration",1,"label"],U,["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],$,["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],oe,_e,["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],Te,Fe,[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],mt,["id","reviewConfig",1,"button",3,"click"],rn,[1,"message","is-primary"],[1,"message-header"],a1,[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],dn,Gd,f3,Tu,[3,"rulesConfigDescriptionOptional","stateProvider","userIsCreator","rulesConfigToDisplay"],["id","acceptConfig",1,"button","is-primary",3,"click"],Bd,Wd,ht,Ot,Lt,["proposalSent",""],Dn,Jr]},template:function(t,n){1&t&&z(0,bpt,4,3,"div",0),2&t&&v("ngIf",n.viewInfo)},dependencies:[zt,Nt,Tt,F4,wa,_p,Mc,H4,U4,u6,Ose,apt],encapsulation:2})};var C0;function Npt(r,e){if(1&r){const t=de();M(0,"button",3),W("click",function(){return te(t),ne(p().addTime())}),ae(1,4),P()}if(2&r){const t=p();m(),Un(t.timeToAdd),Zn(1)}}oR=Hd=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],oR);let sR=class PR{static#e=C0=this;debugName;timeToAdd;dangerTimeLimit;active;canAddTime;remainingMs;displayedSec;displayedMinute;timeoutHandleGlobal=null;timeoutHandleSec=null;isPaused=!0;isSet=!1;started=!1;startTime;outOfTimeAction=new l1;addTimeToOpponent=new l1;static DANGER_TIME_EVEN="has-background-danger has-text-white";static DANGER_TIME_ODD="has-background-warning has-text-white";static PASSIVE_STYLE="has-text-passive is-italic";static SAFE_TIME="";cssClasses=C0.SAFE_TIME;setDuration(e){L.assert(!1===this.started,"Should not set a chrono that has already been started ("+this.debugName+")!"),this.isSet=!0,this.changeDuration(e)}changeDuration(e){L.assert(this.isPaused,"Should not change duration of a clock while it is running"),this.remainingMs=e,this.displayDuration()}subtract(e){this.changeDuration(this.remainingMs-e)}displayDuration(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}start(){L.assert(this.isSet,"Should not start a chrono that has not been set!"),L.assert(!1===this.started,"Should not start chrono that has already been started ("+this.debugName+")"),this.started=!0,this.resume()}resume(){L.assert(this.isPaused&&this.started,"Should only resume chrono that are started and paused!"),this.startTime=Date.now();const e=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(()=>{this.onEndReached()},e),this.countSeconds()}onEndReached(){this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}countSeconds(){this.timeoutHandleSec=window.setTimeout(()=>{this.updateShownTime()},1e3)}isIdle(){return!1===this.started||this.isPaused}pause(){L.assert(this.started,"Should not pause not started chrono ("+this.debugName+")"),L.assert(!1===this.isPaused,"Should not pause already paused chrono ("+this.debugName+")"),this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}stop(){L.assert(this.started,"Should only stop chrono that are started!"),!1===this.isPaused&&this.pause(),this.started=!1,this.isSet=!1}isStarted(){return this.started}getTimeClass(){return!1===this.active?C0.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?C0.DANGER_TIME_ODD:C0.DANGER_TIME_EVEN:C0.SAFE_TIME}updateShownTime(){const e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}clearTimeouts(){null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}addTime(){this.addTimeToOpponent.emit()}ngOnDestroy(){this.clearTimeouts()}static \u0275fac=function(t){return new(t||PR)};static \u0275cmp=$e({type:PR,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:()=>{let e;return e=$localize`Add ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],e]},template:function(t,n){1&t&&(M(0,"div",0)(1,"p",1),st(2),Ta(3,"number"),P(),z(4,Npt,2,1,"button",2),P()),2&t&&(v("ngClass",n.getTimeClass()),m(2),SE("",n.displayedMinute,":",GH(3,4,n.displayedSec,"2.0-0"),""),m(2),v("ngIf",n.canAddTime))},dependencies:[zt,Tt,dU],encapsulation:2})};sR=C0=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],sR);const kpt=["chronoZeroGlobal"],Rpt=["chronoOneGlobal"],xpt=["chronoZeroTurn"],Lpt=["chronoOneTurn"];function zpt(r,e){if(1&r){const t=de();M(0,"app-part-creation",5,6),W("gameStartNotification",function(i){return te(t),ne(p().startGame(i))}),P()}if(2&r){const t=p();v("partId",t.currentPartId)("rulesConfigDescription",t.getRulesConfigDescription())}}function Dpt(r,e){1&r&&(jt(0),M(1,"span",39),ae(2,40),P(),Zt())}function Vpt(r,e){if(1&r&&(M(0,"span",41),ae(1,42),P()),2&r){const t=p(4);m(),Un(null==t.currentUser?null:t.currentUser.name),Zn(1)}}function Hpt(r,e){if(1&r&&(M(0,"p",36),z(1,Dpt,3,0,"ng-container",37)(2,Vpt,2,1,"ng-template",null,38,wn),P()),2&r){const t=Pn(3),n=p(3);m(),v("ngIf",(null==n.currentUser?null:n.currentUser.name)===n.getPlayer().name)("ngIfElse",t)}}function Fpt(r,e){if(1&r&&(M(0,"div",32)(1,"p",33),ae(2,34),P(),z(3,Hpt,4,2,"p",35),P()),2&r){const t=p(2);m(2),Un(t.currentPart.getTurn()+1),Zn(2),m(),v("ngIf",!1===t.endGame)}}function Upt(r,e){if(1&r&&(M(0,"p",43),st(1),P()),2&r){const t=p(2);v("ngClass",t.getPlayerNameClass(t.Player.ZERO)),m(),mn(t.players[0].get().name)}}function $pt(r,e){if(1&r&&(M(0,"p",44),ae(1,45),P()),2&r){const t=p(2);m(),Un(t.gameComponent.scores.get().get(t.Player.ZERO)),Zn(1)}}function Gpt(r,e){if(1&r&&(M(0,"p",46),st(1),P()),2&r){const t=p(2);v("ngClass",t.getPlayerNameClass(t.Player.ONE)),m(),mn(t.players[1].get().name)}}function Bpt(r,e){if(1&r&&(M(0,"p",47),ae(1,48),P()),2&r){const t=p(2);m(),Un(t.gameComponent.scores.get().get(t.Player.ONE)),Zn(1)}}function Wpt(r,e){1&r&&(M(0,"div")(1,"p",50),ae(2,51),P()())}function qpt(r,e){1&r&&(M(0,"p",55),ae(1,56),P())}function jpt(r,e){1&r&&(M(0,"p",57),ae(1,58),P())}function Zpt(r,e){1&r&&(M(0,"p",59),ae(1,60),P())}function Ypt(r,e){if(1&r&&(M(0,"div"),z(1,qpt,2,0,"p",52)(2,jpt,2,0,"p",53)(3,Zpt,2,0,"p",54),P()),2&r){const t=p(3);m(),v("ngIf",t.currentPart.getDrawAccepter().name===t.getPlayer().name),m(),v("ngIf",t.currentPart.getDrawAccepter().name!==t.getPlayer().name&&t.isPlaying()),m(),v("ngIf",!1===t.isPlaying())}}function Kpt(r,e){1&r&&(M(0,"p",64),ae(1,65),P())}function Xpt(r,e){1&r&&(M(0,"p",66),ae(1,67),P())}function Qpt(r,e){if(1&r&&(M(0,"p",68),ae(1,69),P()),2&r){const t=p(4);m(),Un(t.currentPart.getWinner().get().name),Zn(1)}}function Jpt(r,e){if(1&r&&(M(0,"div"),z(1,Kpt,2,0,"p",61)(2,Xpt,2,0,"p",62)(3,Qpt,2,1,"p",63),P()),2&r){const t=p(3);m(),v("ngIf",t.currentPart.getWinner().get().name===t.getPlayer().name),m(),v("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),m(),v("ngIf",!1===t.isPlaying())}}function emt(r,e){if(1&r&&(M(0,"p",64),ae(1,70),P()),2&r){const t=p(4);m(),Un(t.currentPart.getLoser().get().name),Zn(1)}}function tmt(r,e){1&r&&(M(0,"p",68),ae(1,71),P())}function nmt(r,e){if(1&r&&(M(0,"p",68),ae(1,72),P()),2&r){const t=p(4);m(),Un(t.currentPart.getLoser().get().name),Zn(1)}}function rmt(r,e){if(1&r&&(M(0,"div"),z(1,emt,2,1,"p",61)(2,tmt,2,0,"p",63)(3,nmt,2,1,"p",63),P()),2&r){const t=p(3);m(),v("ngIf",t.currentPart.getWinner().get().name===t.getPlayer().name),m(),v("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),m(),v("ngIf",!1===t.isPlaying())}}function imt(r,e){1&r&&(M(0,"p",74),ae(1,75),P())}function omt(r,e){if(1&r&&(M(0,"p",74),ae(1,76),P()),2&r){const t=p(4);m(),Un(t.currentPart.getLoser().get().name),Zn(1)}}function smt(r,e){if(1&r&&(M(0,"div"),z(1,imt,2,0,"p",73)(2,omt,2,1,"p",73),P()),2&r){const t=p(3);m(),v("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),m(),v("ngIf",!1===t.isPlaying()||t.currentPart.getWinner().get().name===t.getPlayer().name)}}function amt(r,e){if(1&r&&(M(0,"div",49),V(1,"hr"),z(2,Wpt,3,0,"div",27)(3,Ypt,4,3,"div",27)(4,Jpt,4,3,"div",27)(5,rmt,4,3,"div",27)(6,smt,3,2,"div",27),P()),2&r){const t=p(2);m(2),v("ngIf",t.currentPart.isHardDraw()),m(),v("ngIf",t.currentPart.isAgreedDraw()),m(),v("ngIf",t.currentPart.isWin()),m(),v("ngIf",t.currentPart.isTimeout()),m(),v("ngIf",t.currentPart.isResign())}}function cmt(r,e){if(1&r){const t=de();jt(0),M(1,"button",85),W("click",function(){const o=te(t).$implicit;return ne(p(4).propose(o))}),st(2),V(3,"fa-icon",86),P(),Zt()}if(2&r){const t=e.$implicit,n=p(4);m(),En("id","propose",t,""),v("disabled",!1===n.requestAvailable(t)),m(),ri("",n.requestInfos[t].textForRequest(),"\xa0\xa0"),m(),v("icon",n.requestInfos[t].icon)}}function lmt(r,e){if(1&r){const t=de();jt(0),M(1,"button",80),W("click",function(){return te(t),ne(p(3).resign())}),ae(2,81),P(),M(3,"button",82),W("click",function(){return te(t),ne(p(3).gameComponent.pass())}),ae(4,83),P(),z(5,cmt,4,4,"ng-container",84),Zt()}if(2&r){const t=p(3);m(),v("disabled",!1===t.canResign()),m(2),v("disabled",!1===t.canPass()),m(2),v("ngForOf",t.allRequests)}}function umt(r,e){if(1&r){const t=de();M(0,"div",87)(1,"p"),st(2),V(3,"fa-icon",86),P(),M(4,"button",88),W("click",function(){return te(t),ne(p(3).accept())}),ae(5,89),P(),M(6,"button",90),W("click",function(){return te(t),ne(p(3).reject())}),ae(7,91),P()()}if(2&r){const t=p(3);m(2),ri(" ",t.requestInfos[t.getRequestAwaitingReplyFromUs().get()].textForReply(),"\xa0\xa0 "),m(),v("icon",t.requestInfos[t.getRequestAwaitingReplyFromUs().get()].icon)}}function fmt(r,e){if(1&r&&(M(0,"div",92)(1,"p")(2,"span"),No(3,93),V(4,"fa-icon",86),Io(),P()()()),2&r){const t=p(3);m(4),v("icon",t.requestInfos[t.deniedRequest().get()].icon),Un(t.requestInfos[t.deniedRequest().get()].name()),Zn(3)}}function dmt(r,e){if(1&r&&(M(0,"div",94)(1,"p")(2,"span"),No(3,95),V(4,"fa-icon",86),Io(),P()()()),2&r){const t=p(3);m(4),v("icon",t.requestInfos[t.getRequestAwaitingReplyFromOpponent().get()].icon),Un(t.requestInfos[t.getRequestAwaitingReplyFromOpponent().get()].name()),Zn(3)}}function hmt(r,e){if(1&r&&(jt(0),z(1,lmt,6,3,"ng-container",37)(2,umt,8,2,"ng-template",null,77,wn)(4,fmt,5,2,"div",78)(5,dmt,5,2,"div",79),Zt()),2&r){const t=Pn(3),n=p(2);m(),v("ngIf",!1===n.mustReply())("ngIfElse",t),m(3),v("ngIf",n.deniedRequest().isPresent()),m(),v("ngIf",n.getRequestAwaitingReplyFromOpponent().isPresent())}}function gmt(r,e){1&r&&(M(0,"button",96),ae(1,97),P())}function pmt(r,e){if(1&r){const t=de();M(0,"div",7)(1,"div",8)(2,"div",9),z(3,Fpt,4,2,"div",10),M(4,"div",11),z(5,Upt,2,2,"p",12)(6,$pt,2,1,"p",13),M(7,"app-count-down",14,15),W("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ZERO))})("addTimeToOpponent",function(){return te(t),ne(p().addGlobalTime())}),P(),M(9,"app-count-down",16,17),W("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ZERO))})("addTimeToOpponent",function(){return te(t),ne(p().addTurnTime())}),P()(),M(11,"p",18),ae(12,19),P(),M(13,"div",11),z(14,Gpt,2,2,"p",20)(15,Bpt,2,1,"p",21),M(16,"app-count-down",22,23),W("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ONE))})("addTimeToOpponent",function(){return te(t),ne(p().addGlobalTime())}),P(),M(18,"app-count-down",24,25),W("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ONE))})("addTimeToOpponent",function(){return te(t),ne(p().addTurnTime())}),P()(),V(20,"hr"),z(21,amt,7,5,"div",26)(22,hmt,6,4,"ng-container",27)(23,gmt,2,0,"button",28),P()(),M(24,"div",29)(25,"div",30),V(26,"div",null,31),P()()()}if(2&r){const t=p();m(3),v("ngIf",null!==t.currentPart),m(2),v("ngIf",t.players[0].isPresent()),m(),v("ngIf",null!==t.currentPart&&t.gameComponent&&t.gameComponent.scores.isPresent()),m(),v("dangerTimeLimit",6e4)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==0)("canAddTime",t.role===t.Player.ONE&&!1===t.endGame)("timeToAdd",t.globalTimeMessage),m(2),v("dangerTimeLimit",15e3)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==0)("canAddTime",t.role===t.Player.ONE&&!1===t.endGame)("timeToAdd",t.turnTimeMessage),m(5),v("ngIf",t.players[1].isPresent()),m(),v("ngIf",null!==t.currentPart&&t.gameComponent&&t.gameComponent.scores.isPresent()),m(),v("dangerTimeLimit",6e4)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==1)("canAddTime",t.role===t.Player.ZERO&&!1===t.endGame)("timeToAdd",t.globalTimeMessage),m(2),v("dangerTimeLimit",15e3)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==1)("canAddTime",t.role===t.Player.ZERO&&!1===t.endGame)("timeToAdd",t.turnTimeMessage),m(3),v("ngIf",t.endGame&&null!==t.currentPart),m(),v("ngIf",t.isPlaying()),m(),v("ngIf",t.endGame),m(),v("ngClass",t.getBoardHighlight())}}let aR=(()=>class r{static NO_MATCHING_PART=()=>$localize`The game you tried to join does not exist.`;static CANNOT_PLAY_AS_OBSERVER=()=>$localize`You are an observer in this game, you cannot play.`;static MUST_ANSWER_REQUEST=()=>$localize`You must answer your opponent's request.`})(),cR=class SR extends Mv{currentGameService;userService;gameService;gameEventService;timeManager;requestManager;chronoZeroGlobal;chronoOneGlobal;chronoZeroTurn;chronoOneTurn;currentPart=null;currentPartId;gameStarted=!1;opponent=null;authUser;currentUser=null;configRoom;currentGame=h.empty();userLinkedToThisPart=!0;routerEventsSubscription;userSubscription;partSubscription=new Ue;gameEventsSubscription=new Ue;currentGameSubscription=new Ue;OFFLINE_FONT_COLOR={color:"lightgrey"};globalTimeMessage=$localize`5 minutes`;turnTimeMessage=$localize`30 seconds`;requestInfos=Sse.requestInfos;allRequests=["TakeBack","Draw","Rematch"];constructor(e,t,n,i,o,s,a,c,l,u){super(e,t,n,i),this.currentGameService=o,this.userService=s,this.gameService=a,this.gameEventService=c,this.timeManager=l,this.requestManager=u}extractPartIdFromURL(){return L.getNonNullable(this.activatedRoute.snapshot.paramMap.get("id"))}isPlaying(){return this.role.isPlayer()}getPlayer(){return this.authUser.toMinimalUser()}redirectIfPartOrGameIsInvalid(){var e=this;return E(function*(){const t=e.getGameName();if(Vt.ALL_GAMES().some(i=>i.urlName===t)){if((yield e.gameService.getPartValidity(e.currentPartId,t)).isFailure()){e.routerEventsSubscription.unsubscribe();const o=aR.NO_MATCHING_PART();yield e.router.navigate(["/notFound",o],{skipLocationChange:!0})}}else{e.routerEventsSubscription.unsubscribe();const i=Vd.NO_MATCHING_GAME(t);yield e.router.navigate(["/notFound",i],{skipLocationChange:!0})}})()}setCurrentPartIdOrRedirect(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}ngOnInit(){var e=this;return E(function*(){e.routerEventsSubscription=e.router.events.subscribe(function(){var t=E(function*(n){n instanceof Oc&&(yield e.setCurrentPartIdOrRedirect())});return function(n){return t.apply(this,arguments)}}()),e.userSubscription=e.connectedUserService.subscribeToUser(t=>{e.authUser=t}),yield e.setCurrentPartIdOrRedirect(),e.currentGameSubscription=e.currentGameService.subscribeToCurrentGame(function(){var t=E(function*(n){yield e.onCurrentGameUpdate(n)});return function(n){return t.apply(this,arguments)}}())})()}onCurrentGameUpdate(e){var t=this;return E(function*(){if(e.isPresent()){const n=e.get();"Observer"===n.role||n.id===t.currentPartId?t.currentGame=e:(t.userLinkedToThisPart=!1,yield t.router.navigate(["/lobby"]))}else t.currentGame=h.empty()})()}startGame(e){var t=this;return E(function*(){L.assert(!1===t.gameStarted,"Should not start already started game"),t.configRoom=e,t.gameStarted=!0,window.setTimeout(E(function*(){const n=yield t.createMatchingGameComponent();t.timeManager.setClocks([t.chronoZeroTurn,t.chronoOneTurn],[t.chronoZeroGlobal,t.chronoOneGlobal]),L.assert(n,"Game should be created successfully, otherwise part-creation would have redirected"),L.assert(null!==t.gameComponent,"Game component should exist"),t.gameComponent.config=h.of(e.rulesConfig),yield t.startPart()}),2)})()}startPart(){var e=this;return E(function*(){const t=(yield e.gameService.getPart(e.currentPartId)).get();e.currentPart=new gC(e.currentPartId,t),e.partSubscription=e.gameService.subscribeToChanges(e.currentPartId,function(){var n=E(function*(i){L.assert(i.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.currentPart=new gC(e.currentPartId,i.get())});return function(i){return n.apply(this,arguments)}}()),e.subscribeToEvents()})()}onGameStart(){var e=this;return E(function*(){yield e.initializePlayersDatas(e.currentPart);const t=e.gameComponent.getTurn();L.assert(0===t,"turn should always be 0 upon game start"),e.timeManager.onGameStart(e.configRoom,e.players),e.requestManager.onGameStart()})()}subscribeToEvents(){var e=this;const t=new Xgt,n=function(){var i=E(function*(o){yield t.runExclusive(E(function*(){const s=o.filter(c=>"Move"===c.eventType).length;let a=0;e.beforeEventsBatch();for(const c of o)switch(c.eventType){case"Move":const l=a+1===s;yield e.onReceivedMove(c,l),a+=1;break;case"Request":e.requestManager.onReceivedRequest(c);break;case"Reply":(yield e.requestManager.onReceivedReply(c))&&(yield e.handleReply(c));break;default:L.expectToBe(c.eventType,"Action","Event should be an action"),e.timeManager.onReceivedAction(c),"EndGame"===c.action?yield e.onGameEnd():"StartGame"===c.action&&(yield e.onGameStart())}yield e.afterEventsBatch()}))});return function(s){return i.apply(this,arguments)}}();this.gameEventsSubscription=this.gameEventService.subscribeToEvents(this.currentPartId,n)}handleReply(e){var t=this;return E(function*(){switch(e.requestType){case"TakeBack":const n=t.timeManager.playerOfMinimalUser(e.user);yield t.takeBackToPreviousPlayerTurn(n.getOpponent());break;case"Rematch":yield t.router.navigate(["/nextGameLoading"]);const i=t.getGameName();yield t.router.navigate(["/play",i,e.data])}})()}onGameEnd(){var e=this;return E(function*(){yield e.currentGameService.removeCurrentGame(),e.gameComponent.setInteractive(!1),e.endGame=!0})()}onReceivedMove(e,t){var n=this;return E(function*(){const i=n.gameComponent.rules,o=n.gameComponent.getTurn(),s=n.gameComponent.encoder.decode(e.move),a=n.gameComponent.node.gameState,c=yield n.getConfig(),l=n.gameComponent.rules.isLegal(s,a,c),u="We received an incorrect db move: "+s.toString()+" at turn "+o+'because "'+l.getReasonOr("")+'"';L.assert(l.isSuccess(),u);const f=i.choose(n.gameComponent.node,s,c);if(L.assert(f.isSuccess(),"Chosen move should be legal after all checks, but it is not! Reason: "+f.getReasonOr("")),n.gameComponent.node=f.get(),n.role===B.NONE)yield n.updateBoardAndShowLastMove(t);else{const g=o%2!==n.role.getValue();yield n.updateBoardAndShowLastMove(g&&t)}n.setCurrentPlayerAccordingToCurrentTurn(),n.timeManager.onReceivedMove(e),n.requestManager.onReceivedMove()})()}setCurrentPlayerAccordingToCurrentTurn(){this.currentUser=this.players[this.gameComponent.getTurn()%2].get(),this.gameComponent.setInteractive(this.currentUser.name===this.getPlayer().name)}beforeEventsBatch(){this.timeManager.beforeEventsBatch(this.endGame)}afterEventsBatch(){var e=this;return E(function*(){const t=O.ofTurn(e.gameComponent.getTurn()),n=yield e.userService.getServerTime(e.connectedUserService.user.get().id);e.timeManager.afterEventsBatch(e.endGame,t,n)})()}takeBackToPreviousPlayerTurn(e){var t=this;return E(function*(){t.gameComponent.node=t.gameComponent.node.parent.get(),t.gameComponent.getCurrentPlayer()!==e&&(L.assert(t.gameComponent.getTurn()>0,"Should not allow player that never played to take back"),t.gameComponent.node=t.gameComponent.node.parent.get()),t.setCurrentPlayerAccordingToCurrentTurn();const n=0===t.gameComponent.getTurn();yield t.updateBoardAndShowLastMove(n)})()}canResign(){return L.assert(this.isPlaying(),"Non playing should not call canResign"),!0!==this.endGame&&null!=this.opponent}requestAvailable(e){switch(e){case"TakeBack":return this.canAskTakeBack();case"Draw":return this.canProposeDraw();default:return L.expectToBe(e,"Rematch"),this.endGame}}mustReply(){return this.getRequestAwaitingReplyFromUs().isPresent()}getRequestAwaitingReplyFromUs(){return L.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getUnrespondedRequestFrom(L.getNonNullable(this.opponent))}getRequestAwaitingReplyFromOpponent(){return L.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getUnrespondedRequestFrom(L.getNonNullable(this.currentUser))}deniedRequest(){return this.requestManager.deniedRequest()}canPass(){return L.assert(this.isPlaying(),"Non playing should not call canPass"),!this.endGame&&this.currentUser?.name===this.getPlayer().name&&this.gameComponent.canPass}canAskTakeBack(){return L.assert(this.isPlaying(),"Non playing should not call canAskTakeBack"),L.assert(null!=this.currentPart,"should not call canAskTakeBack when currentPart is not defined yet"),!(!0===this.endGame||L.getNonNullable(this.currentPart).data.turn<=this.role.getValue())&&this.requestManager.canMakeRequest("TakeBack")}canProposeDraw(){return L.assert(this.isPlaying(),"Non playing should not call canProposeDraw"),!this.endGame&&this.requestManager.canMakeRequest("Draw")}canUserPlay(e){var t=()=>super.canUserPlay,n=this;return E(function*(){if(n.role===B.NONE){const o=aR.CANNOT_PLAY_AS_OBSERVER();return A.failure(o)}const i=yield t().call(n,e);return i.isFailure()?i:n.mustReply()?A.failure(aR.MUST_ANSWER_REQUEST()):A.SUCCESS})()}initializePlayersDatas(e){var t=this;return E(function*(){t.players=[h.of(e.data.playerZero),h.ofNullable(e.data.playerOne)],L.assert(null!=e.data.playerOne,"should not initializePlayersDatas when players data is not received"),t.setCurrentPlayerAccordingToCurrentTurn(),yield t.setRealObserverRole()})()}setRealObserverRole(){var e=this;return E(function*(){e.players[0].equalsValue(e.getPlayer())?(yield e.setRole(O.ZERO),e.opponent=e.players[1].get()):e.players[1].equalsValue(e.getPlayer())?(yield e.setRole(O.ONE),e.opponent=e.players[0].get()):yield e.setRole(B.NONE),yield e.currentGameService.updateCurrentGame({...e.currentGame.get(),role:e.role===B.NONE?"Observer":"Player"})})()}onLegalUserMove(e){var t=this;return E(function*(){const n=t.gameComponent.node,i=t.gameComponent.rules,o=n.gameState,s=yield t.getConfig(),a=t.gameComponent.rules.isLegal(e,o,s);L.assert(a.isSuccess(),"onLegalUserMove called with an illegal move");const c=i.applyLegalMove(e,o,s,a.get()),l=new ps(c,h.of(n),h.of(e)),u=i.getGameStatus(l,s),f=t.gameComponent.encoder.encode(e),g=L.getNonNullable(t.currentUser);return yield t.gameEventService.addMove(t.currentPartId,g,f),t.updatePartWithStatusAndScores(u,t.gameComponent.scores)})()}updatePartWithStatusAndScores(e,t){var n=this;return E(function*(){return e.isEndGame?e===ve.DRAW?yield n.gameService.drawPart(n.currentPartId,t):(L.assert(e.winner.isPlayer(),"Non-draw end games should have a winner"),n.notifyVictory(e.winner,t)):n.gameService.updatePartUponMove(n.currentPartId,t)})()}notifyTimeoutVictory(e,t){var n=this;return E(function*(){yield n.gameService.notifyTimeout(n.currentPartId,e,t)})()}notifyVictory(e,t){var n=this;return E(function*(){const i=L.getNonNullable(n.currentPart),o=n.players[0].get(),s=n.players[1].get();n.currentPart=e===O.ONE?i.setWinnerAndLoser(s,o):i.setWinnerAndLoser(o,s),yield n.gameService.endPartWithVictory(n.currentPartId,n.currentPart.getWinner().get(),n.currentPart.getLoser().get(),t)})()}resign(){var e=this;return E(function*(){const t=e.getPlayer(),n=e.players[(e.role.getValue()+1)%2].get();yield e.gameService.resign(e.currentPartId,n,t)})()}reachedOutOfTime(e){var t=this;return E(function*(){if(!1===t.isPlaying())return;const n=L.getNonNullable(t.opponent);e===t.role?yield t.notifyTimeoutVictory(n,t.authUser.toMinimalUser()):yield t.notifyTimeoutVictory(t.authUser.toMinimalUser(),n)})()}propose(e){var t=this;return E(function*(){switch(L.assert(t.role.isPlayer(),"cannot propose request if not player"),e){case"Rematch":return t.gameService.proposeRematch(t.currentPartId);case"Draw":return t.gameService.proposeDraw(t.currentPartId);default:return L.expectToBe(e,"TakeBack"),t.gameService.askTakeBack(t.currentPartId)}})()}accept(){var e=this;return E(function*(){L.assert(e.role.isPlayer(),"cannot accept request if not player");const t=e.role,n=L.getNonNullable(e.currentPart),i=e.requestManager.getCurrentRequest().get().requestType;switch(i){case"Rematch":return e.gameService.acceptRematch(n);case"Draw":return e.gameService.acceptDraw(n.id,t);default:return L.expectToBe(i,"TakeBack"),e.gameService.acceptTakeBack(n.id,n.data.turn,t)}})()}reject(){var e=this;return E(function*(){L.assert(e.role.isPlayer(),"cannot reject request if not player");const t=e.requestManager.getCurrentRequest().get().requestType;switch(t){case"Rematch":return e.gameService.rejectRematch(e.currentPartId);case"Draw":return e.gameService.refuseDraw(e.currentPartId);default:return L.expectToBe(t,"TakeBack"),e.gameService.refuseTakeBack(e.currentPartId)}})()}getPlayerNameClass(e){return this.opponentIsOffline()?"has-text-grey-light":e===O.ZERO?"has-text-white":"has-text-black"}opponentIsOffline(){return!1}addGlobalTime(){return this.gameService.addGlobalTime(this.currentPartId)}addTurnTime(){return this.gameService.addTurnTime(this.currentPartId)}onCancelMove(e){var t=this;return E(function*(){if(t.gameComponent.node.previousMove.isPresent()){const n=t.gameComponent.node.previousMove.get(),i=yield t.getConfig();yield t.gameComponent.showLastMove(n,i)}})()}ngOnDestroy(){var e=this;return E(function*(){e.routerEventsSubscription.unsubscribe(),e.userSubscription.unsubscribe(),e.currentGameSubscription.unsubscribe(),!1===e.isPlaying()&&e.userLinkedToThisPart&&e.connectedUserService.user.isPresent()&&(yield e.currentGameService.removeCurrentGame()),!0===e.gameStarted&&(e.partSubscription.unsubscribe(),e.gameEventsSubscription.unsubscribe())})()}getConfig(){var e=this;return E(function*(){return h.of(e.configRoom.rulesConfig)})()}static \u0275fac=function(t){return new(t||SR)(G(uo),G(hr),G(Xn),G(Ut),G(qo),G(K5),G(Su),G(pI),G(Jgt),G(Sse))};static \u0275cmp=$e({type:SR,selectors:[["app-online-game-wrapper"]],viewQuery:function(t,n){if(1&t&&(O3(kpt,5),O3(Rpt,5),O3(xpt,5),O3(Lpt,5)),2&t){let i;pc(i=mc())&&(n.chronoZeroGlobal=i.first),pc(i=mc())&&(n.chronoOneGlobal=i.first),pc(i=mc())&&(n.chronoZeroTurn=i.first),pc(i=mc())&&(n.chronoOneTurn=i.first)}},features:[We],decls:5,vars:4,consts:()=>{let e,t,n,i,o,s,a,c,l,u,f,g,y,S,I,R,U,$,oe,_e,Te,Fe,mt,rn,a1;return e=$localize`vs.`,t=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,n=$localize`It is your turn.`,i=$localize`It is ${"\ufffd0\ufffd"}:INTERPOLATION:'s turn.`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,s=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,a=$localize`Draw`,c=$localize`You agreed to draw.`,l=$localize`Your draw proposal has been accepted.`,u=$localize`Players agreed to draw.`,f=$localize`You won.`,g=$localize`You lost.`,y=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won.`,S=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit. You won.`,I=$localize`You reached your time limit.`,R=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit.`,U=$localize`You resigned.`,$=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has resigned.`,oe=$localize`Resign`,_e=$localize`Pass a turn`,Te=$localize`Accept`,Fe=$localize`Reject`,mt=$localize`Your ${"\ufffd0\ufffd"}:INTERPOLATION: request has been rejected.${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,rn=$localize`Your request for a ${"\ufffd0\ufffd"}:INTERPOLATION: has been sent.${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,a1=$localize`Go back to the game list`,[["id","partCreation",3,"partId","rulesConfigDescription","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","rulesConfigDescription","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],e,["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],["class","block","id","winnerIndicator",4,"ngIf"],[4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","turnIndicator",1,"block"],[1,"subtitle"],t,["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],["id","playerTurn"],n,["id","opponentTurn"],i,["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],o,["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],s,["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],a,["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],c,["id","yourOpponentAgreedToDrawIndicator",1,"title"],l,["id","playersAgreedToDraw",1,"title"],u,["class","title","id","youWonIndicator",4,"ngIf"],["class","title","id","youLostIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],f,["id","youLostIndicator",1,"title"],g,[1,"title"],y,S,I,R,["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],U,$,["replyButtons",""],["id","requestRejected","class","notification is-danger",4,"ngIf"],["id","getRequestAwaitingReply","class","notification",4,"ngIf"],["id","resign",1,"button","is-fullwidth","mb-1","is-danger",3,"disabled","click"],oe,["id","pass",1,"button","is-fullwidth","mb-1","is-success",3,"disabled","click"],_e,[4,"ngFor","ngForOf"],[1,"button","is-fullwidth","mb-1",3,"id","disabled","click"],[3,"icon"],[1,"notification"],["id","accept",1,"button","is-fullwidth","mb-1","is-success",3,"click"],Te,["id","reject",1,"button","is-fullwidth","mb-1","is-danger",3,"click"],Fe,["id","requestRejected",1,"notification","is-danger"],mt,["id","getRequestAwaitingReply",1,"notification"],rn,["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],a1]},template:function(t,n){1&t&&(z(0,zpt,2,2,"app-part-creation",0)(1,pmt,28,25,"div",1),M(2,"div",2)(3,"div",3),V(4,"app-chat",4),P()()),2&t&&(v("ngIf",!1===n.gameStarted),m(),v("ngIf",n.gameStarted),m(3),v("chatId",n.currentPartId)("turn",null==n.currentPart?null:n.currentPart.getTurn()))},dependencies:[zt,Nt,Tt,Ac,e0,Ev,oR,sR],encapsulation:2})};var lR;function _mt(r,e){if(1&r&&(M(0,"option",28),st(1),P()),2&r){const t=e.$implicit;v("value",t.name),m(),mn(t.name)}}function Cmt(r,e){if(1&r&&(M(0,"option",28),ae(1,32),P()),2&r){const t=e.$implicit;v("value",t.name),m(),Un(t.name),Zn(1)}}function vmt(r,e){if(1&r){const t=de();M(0,"select",29),W("ngModelChange",function(i){return te(t),ne(p(3).aiOptions[0]=i)})("change",function(){te(t);const i=p(3);return ne(i.updatePlayer(i.Player.ZERO))}),M(1,"option",30),ae(2,31),P(),z(3,Cmt,2,2,"option",19),P()}if(2&r){const t=p(3);v("ngModel",t.aiOptions[0]),m(3),v("ngForOf",t.availableAIOptions(0))}}function ymt(r,e){if(1&r&&(M(0,"p",33),ae(1,34),P()),2&r){const t=p(3);m(),Un(t.gameComponent.scores.get().get(t.Player.ZERO)),Zn(1)}}function Mmt(r,e){if(1&r&&(M(0,"option",28),st(1),P()),2&r){const t=e.$implicit;v("value",t.name),m(),mn(t.name)}}function Emt(r,e){if(1&r&&(M(0,"option",28),ae(1,37),P()),2&r){const t=e.$implicit;v("value",t.name),m(),Un(t.name),Zn(1)}}function Pmt(r,e){if(1&r){const t=de();M(0,"select",35),W("ngModelChange",function(i){return te(t),ne(p(3).aiOptions[1]=i)})("change",function(){te(t);const i=p(3);return ne(i.updatePlayer(i.Player.ONE))}),M(1,"option",30),ae(2,36),P(),z(3,Emt,2,2,"option",19),P()}if(2&r){const t=p(3);v("ngModel",t.aiOptions[1]),m(3),v("ngForOf",t.availableAIOptions(1))}}function Smt(r,e){if(1&r&&(M(0,"p",38),ae(1,39),P()),2&r){const t=p(3);m(),Un(t.gameComponent.scores.get().get(t.Player.ONE)),Zn(1)}}function Omt(r,e){if(1&r&&(M(0,"h4",43),st(1),P()),2&r){const t=p(4);m(),mn(t.winnerMessage.get())}}function Tmt(r,e){1&r&&(M(0,"h4",44),ae(1,45),P())}function Amt(r,e){if(1&r&&(M(0,"div",40),z(1,Omt,2,1,"h4",41)(2,Tmt,2,0,"h4",42),P()),2&r){const t=p(3);m(),v("ngIf",t.winnerMessage.isPresent()),m(),v("ngIf",t.winnerMessage.isAbsent())}}function bmt(r,e){if(1&r){const t=de();M(0,"div",9)(1,"div",10)(2,"p",11),ae(3,12),P()(),M(4,"div",13)(5,"div",14)(6,"div",15)(7,"select",16),W("change",function(){te(t);const i=p(2);return ne(i.updatePlayer(i.Player.ZERO))})("ngModelChange",function(i){return te(t),ne(p(2).playerSelection[0]=i)}),M(8,"option",17),ae(9,18),P(),z(10,_mt,2,2,"option",19),P()(),M(11,"div",15),z(12,vmt,4,2,"select",20),P(),z(13,ymt,2,1,"p",21),P(),M(14,"div",22)(15,"div",15)(16,"select",23),W("change",function(){te(t);const i=p(2);return ne(i.updatePlayer(i.Player.ONE))})("ngModelChange",function(i){return te(t),ne(p(2).playerSelection[1]=i)}),M(17,"option",17),ae(18,24),P(),z(19,Mmt,2,2,"option",19),P()(),M(20,"div",15),z(21,Pmt,4,2,"select",25),P(),z(22,Smt,2,1,"p",26),P()(),z(23,Amt,3,2,"div",27),P()}if(2&r){const t=p(2);m(3),Un(t.gameComponent.getTurn()+1),Zn(3),m(4),v("ngModel",t.playerSelection[0]),m(3),v("ngForOf",t.gameComponent.availableAIs),m(2),v("ngIf",!1===t.players[0].equalsValue("human")),m(),v("ngIf",t.gameComponent.scores.isPresent()),m(3),v("ngModel",t.playerSelection[1]),m(3),v("ngForOf",t.gameComponent.availableAIs),m(2),v("ngIf",!1===t.players[1].equalsValue("human")),m(),v("ngIf",t.gameComponent.scores.isPresent()),m(),v("ngIf",t.endGame)}}function wmt(r,e){if(1&r){const t=de();M(0,"button",52),W("click",function(){return te(t),ne(p(3).gameComponent.pass())}),ae(1,53),P()}}function Nmt(r,e){if(1&r){const t=de();M(0,"button",54),W("click",function(){return te(t),ne(p(3).takeBack())}),ae(1,55),P()}}function Imt(r,e){if(1&r&&(jt(0),st(1),V(2,"br"),Zt()),2&r){const t=e.$implicit,n=p(4);m(),ri(" ",t.name+": "+t.getInfo(n.gameComponent.node,n.gameComponent.config)," ")}}function kmt(r,e){if(1&r&&(M(0,"div",56),z(1,Imt,3,1,"ng-container",57),st(2),V(3,"br"),st(4),V(5,"br"),P()),2&r){const t=p(3);m(),v("ngForOf",t.gameComponent.availableAIs),m(),ri(" Created ",t.getCreatedNodes()," nodes."),m(2),ri(" Minimax time: ",t.getMinimaxTime(),"ms.")}}function Rmt(r,e){if(1&r){const t=de();M(0,"div",46),z(1,wmt,2,0,"button",47)(2,Nmt,2,0,"button",48),M(3,"button",49),W("click",function(){return te(t),ne(p(2).restartGame())}),ae(4,50),P(),z(5,kmt,6,3,"div",51),P()}if(2&r){const t=p(2);m(),v("ngIf",!1===t.endGame&&t.gameComponent.canPass),m(),v("ngIf",t.canTakeBack()),m(3),v("ngIf",t.gameComponent.node.previousMove.isPresent()&&t.displayAIInfo())}}function xmt(r,e){if(1&r&&(M(0,"div")(1,"div",2)(2,"div",3),z(3,bmt,24,10,"div",4)(4,Rmt,6,3,"div",5),P(),M(5,"div",6)(6,"div",7),V(7,"div",null,8),P()()()()),2&r){const t=p();m(3),v("ngIf",t.gameComponent),m(),v("ngIf",t.gameComponent),m(),v("ngClass",t.getBoardHighlight())}}function Lmt(r,e){if(1&r){const t=de();M(0,"div",58)(1,"app-rules-configuration",59),W("updateCallback",function(i){return te(t),ne(p().updateConfig(i))}),P(),M(2,"div",60)(3,"div",61)(4,"div",62)(5,"div",63)(6,"button",64),W("click",function(){return te(t),ne(p().markConfigAsFilled())}),ae(7,65),P()()()()()()}if(2&r){const t=p();m(),v("stateProvider",t.getStateProvider())("rulesConfigDescriptionOptional",t.getRulesConfigDescription())("userIsCreator",!0),m(5),v("disabled",t.rulesConfig.isAbsent())}}cR=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],cR);let uR=class OR extends Mv{static#e=lR=this;cdr;static AI_TIMEOUT=1;aiOptions=["none","none"];playerSelection=["human","human"];winnerMessage=h.empty();displayAIMetrics=!1;configIsSet=!1;rulesConfig=h.empty();configBS=new Yo(h.empty());configObs=this.configBS.asObservable();constructor(e,t,n,i,o){super(e,t,n,i),this.cdr=o,this.players=[h.of(this.playerSelection[0]),h.of(this.playerSelection[1])],this.role=O.ZERO,this.setDefaultRulesConfig()}setDefaultRulesConfig(){const e=this.getGameName();this.rulesConfig=rk.getGameDefaultConfig(e)}getCreatedNodes(){return AQ.createdNodes}getMinimaxTime(){return KIe.aiTime}ngAfterViewInit(){var e=this;window.setTimeout(E(function*(){(yield e.createMatchingGameComponent())&&(yield e.restartGame(),e.cdr.detectChanges())}),1)}updatePlayer(e){var t=this;return E(function*(){t.players[e.getValue()]=h.of(t.playerSelection[e.getValue()]),"human"===t.playerSelection[1]&&"human"!==t.playerSelection[0]?(t.gameComponent.setInteractive(!1),yield t.setRole(O.ONE)):(t.gameComponent.setInteractive(!0),yield t.setRole(O.ZERO)),yield t.proposeAIToPlay()})()}onLegalUserMove(e){var t=this;return E(function*(){const n=yield t.getConfig();t.gameComponent.node=t.gameComponent.rules.choose(t.gameComponent.node,e,n).get(),yield t.proposeAIToPlay()})()}updateBoard(e){var t=this;return E(function*(){yield t.updateBoardAndShowLastMove(e);const n=yield t.getConfig(),i=t.gameComponent.rules.getGameStatus(t.gameComponent.node,n);if(!0===i.isEndGame&&(t.endGame=!0,i.winner.isPlayer())){const o=$localize`Player ${i.winner.getValue()+1}`,a=i.winner.getOpponent().getValue();t.winnerMessage=t.players[i.winner.getValue()].equalsValue("human")?t.players[a].equalsValue("human")?h.of($localize`${o} won`):h.of($localize`You won`):t.players[a].equalsValue("human")?h.of($localize`You lost`):h.of($localize`${t.players[i.winner.getValue()].get()} (Player ${i.winner.getValue()+1}) won`)}})()}proposeAIToPlay(){var e=this;return E(function*(){if(yield e.hasSelectedAI()){e.gameComponent.setInteractive(!1),yield e.updateBoard(!1);const t=e.getPlayingAI();t.isPresent()&&window.setTimeout(E(function*(){yield e.doAIMove(t.get().ai,t.get().options)}),lR.AI_TIMEOUT)}else e.gameComponent.setInteractive(!0),yield e.updateBoard(!1),e.cdr.detectChanges()})()}hasSelectedAI(){var e=this;return E(function*(){const t=yield e.getConfig();if(e.gameComponent.rules.getGameStatus(e.gameComponent.node,t).isEndGame)return!1;const n=e.gameComponent.getTurn()%2;return"human"!==e.playerSelection[n]})()}getPlayingAI(){const e=this.gameComponent.getTurn()%2,t=this.findAI(e);if(t.isPresent()){const n=t.get(),i=this.aiOptions[e];return h.ofNullable(n.availableOptions.find(s=>s.name===i)).map(s=>({ai:n,options:s}))}return h.empty()}findAI(e){return h.ofNullable(this.gameComponent.availableAIs.find(t=>this.players[e].equalsValue(t.name)))}getStateProvider(){const e=this.getGameName(),t=Vt.getByUrlName(e);return t.isPresent()?h.of(i=>t.get().rules.getInitialState(i)):h.empty()}doAIMove(e,t){var n=this;return E(function*(){const i=n.gameComponent.rules,o=yield n.getConfig(),s=i.getGameStatus(n.gameComponent.node,o);L.assert(s===ve.ONGOING,"AI should not try to play when game is over!");const a=e.chooseNextMove(n.gameComponent.node,t,o),c=i.choose(n.gameComponent.node,a,o);return c.isSuccess()?(n.gameComponent.node=c.get(),yield n.updateBoard(!0),n.cdr.detectChanges(),yield n.proposeAIToPlay(),A.SUCCESS):(n.messageDisplayer.criticalMessage($localize`The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!`),Gi.logError("LocalGameWrapper","AI chose illegal move",{game:n.getGameName(),name:e.name,move:a.toString(),reason:c.getReason()}))})()}availableAIOptions(e){return this.findAI(e).get().availableOptions}canTakeBack(){return this.players[0].equalsValue("human")?this.gameComponent.getTurn()>0:!!this.players[1].equalsValue("human")&&this.gameComponent.getTurn()>1}takeBack(){var e=this;return E(function*(){e.gameComponent.node=e.gameComponent.node.parent.get(),e.isAITurn()&&(L.assert(e.gameComponent.node.parent.isPresent(),"Cannot take back in first turn when AI is Player.ZERO"),e.gameComponent.node=e.gameComponent.node.parent.get()),yield e.updateBoardAndShowLastMove(!1)})()}isAITurn(){return this.getPlayingAI().isPresent()}restartGame(){var e=this;return E(function*(){const t=yield e.getConfig();e.gameComponent.node=e.gameComponent.rules.getInitialNode(t),e.gameComponent.hideLastMove(),yield e.gameComponent.updateBoard(!1),e.endGame=!1,e.winnerMessage=h.empty(),yield e.proposeAIToPlay()})()}getPlayer(){return"human"}onCancelMove(e){var t=this;return E(function*(){if(t.gameComponent.node.previousMove.isPresent()){const n=t.gameComponent.node.previousMove.get(),i=yield t.getConfig();yield t.gameComponent.showLastMove(n,i)}})()}getConfig(){var e=this;return E(function*(){let t=h.empty();const i=yield new Promise(o=>{t=h.of(e.configObs.subscribe(s=>{s.isPresent()&&o(s.get())}))});return t.get().unsubscribe(),h.of(i)})()}updateConfig(e){this.rulesConfig=e,e.isPresent()&&0===Object.keys(e.get()).length&&this.markConfigAsFilled()}isConfigSet(){return this.configIsSet}markConfigAsFilled(){this.configIsSet=!0,this.cdr.detectChanges(),this.configBS.next(this.rulesConfig)}displayAIInfo(){return"true"===localStorage.getItem("displayAIInfo")}static \u0275fac=function(t){return new(t||OR)(G(uo),G(hr),G(Xn),G(Ut),G(zs))};static \u0275cmp=$e({type:OR,selectors:[["app-local-game-wrapper"]],features:[We],decls:2,vars:2,consts:()=>{let e,t,n,i,o,s,a,c,l,u,f,g,y,S;return e=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,t=$localize`Human`,n=$localize`Human`,i=$localize`Pick the options`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION:`,s=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,a=$localize`Pick the options`,c=$localize`${"\ufffd0\ufffd"}:INTERPOLATION:`,l=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,u=$localize`Draw`,f=$localize`Start a new game`,g=$localize`Pass a turn`,y=$localize`Take back move`,S=$localize`Start with this config`,[[4,"ngIf"],["class","box",4,"ngIf"],[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["id","info","class","tile is-child box has-text-centered",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],e,["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],t,[3,"value",4,"ngFor","ngForOf"],["id","aiZeroLevelSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],n,["id","aiOneLevelSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],["id","gameResult","class","block",4,"ngIf"],[3,"value"],["id","aiZeroLevelSelect",3,"ngModel","ngModelChange","change"],["selected","","value","none"],i,o,["id","scoreZero",1,"block"],s,["id","aiOneLevelSelect",3,"ngModel","ngModelChange","change"],a,c,["id","scoreOne",1,"block"],l,["id","gameResult",1,"block"],["id","winner",4,"ngIf"],["id","draw",4,"ngIf"],["id","winner"],["id","draw"],u,[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],f,["id","AIInfo",4,"ngIf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],g,["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],y,["id","AIInfo"],[4,"ngFor","ngForOf"],[1,"box"],["id","rulesConfigComponent",3,"stateProvider","rulesConfigDescriptionOptional","userIsCreator","updateCallback"],[1,"field","is-horizontal"],[1,"field-body"],[1,"field"],[1,"control"],["id","startGameWithConfig",1,"button","is-primary","is-fullwidth",3,"disabled","click"],S]},template:function(t,n){1&t&&z(0,xmt,9,3,"div",0)(1,Lmt,8,4,"div",1),2&t&&(v("ngIf",n.isConfigSet()),m(),v("ngIf",!1===n.isConfigSet()))},dependencies:[zt,Nt,Tt,A8,b8,Cp,Mc,Y7,Ose],encapsulation:2,changeDetection:0})};function zmt(r,e){if(1&r&&(M(0,"div",35)(1,"div",36),ae(2,37),P(),M(3,"div",38),st(4),P()()),2&r){const t=p();m(4),mn(t.errorMessage)}}uR=lR=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ne.log],uR);const Dmt=()=>["/login"];let Vmt=(()=>{class r{connectedUserService;router;faEye=Ok;errorMessage;registrationForm=new Ec({email:new ko,username:new ko,password:new ko});constructor(t,n){this.connectedUserService=t,this.router=n}registerWithEmail(){var t=this;return E(function*(){const n=t.registrationForm.value.username,i=t.registrationForm.value.email,o=t.registrationForm.value.password;if(null==n||null==i||null==o)t.errorMessage=$localize`There are missing fields in the registration form, please check that you filled in all fields.`;else{const s=yield t.connectedUserService.doRegister(n,i,o);if(s.isSuccess()){const a=yield t.connectedUserService.sendEmailVerification();a.isSuccess()?yield t.router.navigate(["/verify-account"]):t.errorMessage=a.getReason()}else t.errorMessage=s.getReason()}})()}registerWithGoogle(){var t=this;return E(function*(){const n=yield t.connectedUserService.doGoogleLogin();n.isSuccess()?yield t.router.navigate(["/verify-account"]):t.errorMessage=n.getReason()})()}getPasswordHelpClass(){const t=this.registrationForm.value.password;return null==t||""===t?"":t.length<6?"is-danger":"is-success"}canRegister(){const t=this.registrationForm.value.password??"";return!(""===(this.registrationForm.value.email??"")||""===(this.registrationForm.value.username??"")||""===t||t.length<6)}static \u0275fac=function(n){return new(n||r)(G(hr),G(Xn))};static \u0275cmp=$e({type:r,selectors:[["app-register"]],decls:56,vars:7,consts:()=>{let t,n,i,o,s,a,c,l,u,f,g,y,S,I;return t=$localize`Registering`,n=$localize`Email`,i=$localize`Email`,o=$localize`A confirmation email will be sent to validate your account.`,s=$localize`Username`,a=$localize`Username`,c=$localize`Password`,l=$localize`Password`,u=$localize`The password should be at least 6 characters long`,f=$localize`Register`,g=$localize`Register with Google`,y=$localize`Have an account?`,S=$localize`Log in`,I=$localize`Registration error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",i,"type","email","autofocus","","required","",1,"input"],[1,"help"],o,["for","username",1,"label"],s,["id","username","formControlName","username","name","username","placeholder",a,"type","text","required","",1,"input"],["for","password",1,"label"],c,[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",l,"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],u,["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],f,[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],g,[1,"help","level-right"],y,[3,"routerLink"],S,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],I,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(M(0,"div",0)(1,"p",1),ae(2,2),P(),M(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),ae(7,7),P()(),M(8,"div",8)(9,"div",9)(10,"div",10),V(11,"input",11),M(12,"p",12),ae(13,13),P()()()()(),M(14,"div",4)(15,"div",5)(16,"label",14),ae(17,15),P()(),M(18,"div",8)(19,"div",9)(20,"div",10),V(21,"input",16),P()()()(),M(22,"div",4)(23,"div",5)(24,"label",17),ae(25,18),P()(),M(26,"div",8)(27,"div",9)(28,"div",19),V(29,"input",20),M(30,"span",21),V(31,"fa-icon",22),P(),M(32,"p",23),ae(33,24),P()()()()(),M(34,"div",4),V(35,"div",5),M(36,"div",8)(37,"div",9)(38,"div",10)(39,"button",25),W("click",function(){return i.registerWithEmail()}),ae(40,26),P()()()()(),M(41,"div",4),V(42,"div",5),M(43,"div",27),z(44,zmt,5,1,"div",28),P()(),M(45,"div",4),V(46,"div",5),M(47,"div",8)(48,"button",29),W("click",function(){return i.registerWithGoogle()}),ae(49,30),P()()(),M(50,"p",31),jt(51),ae(52,32),Zt(),st(53,"\xa0 "),M(54,"a",33),ae(55,34),P()()()()),2&n&&(m(3),v("formGroup",i.registrationForm),m(28),v("icon",i.faEye),m(),v("ngClass",i.getPasswordHelpClass()),m(7),v("disabled",!i.canRegister()),m(5),v("ngIf",i.errorMessage),m(10),v("routerLink",ur(6,Dmt)))},dependencies:[zt,Tt,Ac,F4,wa,Mc,H4,$4,U4,u6,e0,rR,yse],encapsulation:2})}return r})(),Hmt=(()=>{class r{router;selectedGame;constructor(t){this.router=t}pickGame(t){this.selectedGame=t}playLocally(){var t=this;return E(function*(){yield t.router.navigate(["local/"+t.selectedGame])})()}static \u0275fac=function(n){return new(n||r)(G(Xn))};static \u0275cmp=$e({type:r,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:()=>{let t;return t=$localize`Play offline`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(M(0,"app-pick-game",0),W("pickGame",function(s){return i.pickGame(s)}),P(),M(1,"button",1),W("click",function(){return i.playLocally()}),ae(2,2),P()),2&n&&(m(),v("disabled",!i.selectedGame))},dependencies:[nk],encapsulation:2})}return r})(),Fmt=(()=>{class r{router;selectedGame;constructor(t){this.router=t}pickGame(t){this.selectedGame=t}launchTutorial(){var t=this;return E(function*(){yield t.router.navigate(["/tutorial/",t.selectedGame])})()}static \u0275fac=function(n){return new(n||r)(G(Xn))};static \u0275cmp=$e({type:r,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:()=>{let t;return t=$localize`Learn the rules`,[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(M(0,"app-pick-game",0),W("pickGame",function(s){return i.pickGame(s)}),P(),M(1,"button",1),W("click",function(){return i.launchTutorial()}),ae(2,2),P()),2&n&&(m(),v("disabled",!i.selectedGame))},dependencies:[nk],encapsulation:2})}return r})(),Umt=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275cmp=$e({type:r,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:()=>{let t;return t=$localize`The replay game is loading, please wait, it should not take long.`,[t]},template:function(n,i){1&n&&(M(0,"p"),ae(1,0),P())},encapsulation:2})}return r})();function $mt(r,e){1&r&&(M(0,"p",20),ae(1,21),P())}function Gmt(r,e){if(1&r){const t=de();M(0,"div",7)(1,"p",8),ae(2,9),P(),M(3,"div",10)(4,"p",11),ae(5,12),P(),M(6,"button",13),W("click",function(){return te(t),ne(p().finalizeEmailVerification())}),ae(7,14),P()(),M(8,"div",15)(9,"p",11),ae(10,16),P(),M(11,"button",17),W("click",function(){return te(t),ne(p().sendEmailVerification())}),ae(12,18),P()(),z(13,$mt,2,0,"p",19),P()}if(2&r){const t=p();m(2),Un(t.emailAddress),Zn(2),m(11),v("ngIf",t.success)}}function Bmt(r,e){if(1&r){const t=de();M(0,"div",24)(1,"div",8),ae(2,25),P(),M(3,"form",26)(4,"div",27)(5,"div",28),V(6,"input",29),P(),M(7,"div",28)(8,"button",30),W("click",function(){te(t);const i=p(2);return ne(i.pickUsername(i.usernameForm.value))}),ae(9,31),P()()()()()}if(2&r){const t=p(2);m(3),v("formGroup",t.usernameForm)}}const Wmt=()=>["/lobby"];function qmt(r,e){1&r&&(M(0,"div",32),No(1,33),V(2,"a",34),Io(),P()),2&r&&(m(2),v("routerLink",ur(1,Wmt)))}function jmt(r,e){if(1&r&&(jt(0),z(1,Bmt,10,1,"div",22)(2,qmt,3,2,"div",23),Zt()),2&r){const t=p();m(),v("ngIf",!t.success),m(),v("ngIf",t.success)}}function Zmt(r,e){if(1&r&&(M(0,"div",35)(1,"div",36),st(2),P()()),2&r){const t=p();m(2),mn(t.errorMessage)}}let Ymt=(()=>{class r{connectedUserService;router;verificationType=null;success=!1;triedToFinalize=!1;errorMessage;emailAddress;userSubscription;usernameForm=new Ec({username:new ko});constructor(t,n){this.connectedUserService=t,this.router=n}ngOnInit(){var t=this;return E(function*(){t.userSubscription=t.connectedUserService.subscribeToUser(function(){var n=E(function*(i){t.emailAddress=i.email.get(),i.username.isAbsent()?t.verificationType="enter-username":(t.verificationType="send-email",!0===t.triedToFinalize&&!1===i.verified&&(t.errorMessage=$localize`You have not verified your email! Click on the link in the verification email.`),!0===i.verified&&(yield t.router.navigate(["/lobby"])))});return function(i){return n.apply(this,arguments)}}())})()}pickUsername(t){var n=this;return E(function*(){const i=yield n.connectedUserService.setUsername(t.username);i.isSuccess()?n.success=!0:n.errorMessage=i.getReason()})()}sendEmailVerification(){var t=this;return E(function*(){const n=yield t.connectedUserService.sendEmailVerification();n.isSuccess()?t.success=!0:t.errorMessage=n.getReason()})()}finalizeEmailVerification(){var t=this;return E(function*(){t.triedToFinalize=!0,yield t.connectedUserService.reloadUser(),window.open(window.location.href,"_self")})()}ngOnDestroy(){null!=this.userSubscription&&null!=this.userSubscription.unsubscribe&&this.userSubscription.unsubscribe()}static \u0275fac=function(n){return new(n||r)(G(hr),G(Xn))};static \u0275cmp=$e({type:r,selectors:[["app-verify-account"]],decls:7,vars:3,consts:()=>{let t,n,i,o,s,a,c,l,u,f,g;return t=$localize`Account verification`,n=$localize`In order to finalize your account, you must click on the link that you should have received on your email address (${"\ufffd0\ufffd"}:INTERPOLATION:). The email could be in your spam folder.`,i=$localize`Once you have verified your email, click on the following button:`,o=$localize`Finalize email verification`,s=$localize`If you have not received the verification email, click on the following button:`,a=$localize`Send verification email again`,c=$localize`The email has been sent`,l=$localize`In order to finalize your account, you must choose a username.`,u=$localize`Username`,f=$localize`Pick username`,g=$localize`Your account has now been finalized, you can go back to the ${"\ufffd#2\ufffd"}:START_LINK:list of games${"\ufffd/#2\ufffd"}:CLOSE_LINK:.`,[[1,"box"],[1,"message","is-info"],[1,"message-header"],t,["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],n,[1,"block","level-left"],[1,"level-item"],i,["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],o,[1,"level-left"],s,["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],a,["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],c,["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],l,[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",u,"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],f,["id","success",1,"message-body"],g,[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(M(0,"div",0)(1,"div",1)(2,"div",2),ae(3,3),P(),z(4,Gmt,14,2,"div",4)(5,jmt,3,2,"ng-container",5),P(),z(6,Zmt,3,1,"div",6),P()),2&n&&(m(4),v("ngIf","send-email"===i.verificationType),m(),v("ngIf","enter-username"===i.verificationType),m(),v("ngIf",i.errorMessage))},dependencies:[Tt,Ac,F4,wa,Mc,H4,$4,U4,u6],encapsulation:2})}return r})();function Kmt(r,e){1&r&&(M(0,"p",17),ae(1,18),P())}function Xmt(r,e){if(1&r&&(M(0,"div",19)(1,"div",20),ae(2,21),P(),M(3,"div",22),st(4),P()()),2&r){const t=p();m(4),mn(t.errorMessage.get())}}const Qmt=()=>({standalone:!0});let Jmt=(()=>{class r{connectedUserService;constructor(t){this.connectedUserService=t}success=!1;errorMessage=h.empty();email="";resetPassword(){var t=this;return E(function*(){hn(""!==t.email,"No email was entered, but it should not be possible to submit the form then!"),t.errorMessage=h.empty(),t.success=!1;const n=yield t.connectedUserService.sendPasswordResetEmail(t.email);n.isSuccess()?t.success=!0:t.errorMessage=h.of(n.getReason())})()}static \u0275fac=function(n){return new(n||r)(G(hr))};static \u0275cmp=$e({type:r,selectors:[["app-reset-password"]],decls:17,vars:6,consts:()=>{let t,n,i,o,s,a,c;return t=$localize`Password reset`,n=$localize`Email`,i=$localize`Email`,o=$localize`An email will be sent with instruction to reset your password.`,s=$localize`Reset password`,a=$localize`The email has been sent, please follow the instructions from that email.`,c=$localize`Error`,[[1,"box"],[1,"title"],t,[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","name","email","placeholder",i,"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],o,["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],s,["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],a,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],c,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(M(0,"div",0)(1,"p",1),ae(2,2),P(),M(3,"div",3)(4,"div",4)(5,"label",5),ae(6,6),P()(),M(7,"div",7)(8,"div",8)(9,"div",9)(10,"input",10),W("ngModelChange",function(s){return i.email=s}),P(),M(11,"p",11),ae(12,12),P(),z(13,Kmt,2,0,"p",13),P()()()(),M(14,"button",14),W("click",function(){return i.resetPassword()}),ae(15,15),P(),z(16,Xmt,5,1,"div",16),P()),2&n&&(m(10),v("ngModel",i.email)("ngModelOptions",ur(5,Qmt)),m(3),v("ngIf",i.success),m(),v("disabled",""===i.email),m(2),v("ngIf",i.errorMessage.isPresent()))},dependencies:[Tt,wa,Mc,$4,Y7,rR],encapsulation:2})}return r})();function e_t(r,e){if(1&r&&(M(0,"option",13),st(1),P()),2&r){const t=e.$implicit,n=p();v("value",t.value)("selected",t.value===n.currentTheme),m(),ri(" ",t.name," ")}}function t_t(r,e){if(1&r&&(M(0,"option",13),st(1),P()),2&r){const t=e.$implicit,n=p();v("value",t.value)("selected",t.value===n.currentLanguage),m(),ri(" ",t.name," ")}}let n_t=(()=>{class r{userSettingsService;availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}];availableThemes=[{value:"light",name:$localize`Light`},{value:"dark",name:$localize`Dark`}];currentTheme;currentLanguage;constructor(t,n){this.userSettingsService=t,this.currentTheme=n.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}changeLanguage(t){this.userSettingsService.changeLanguage(t.target.value),this.reload()}changeTheme(t){this.userSettingsService.changeTheme(t.target.value),this.reload()}reload(){window.open(window.location.href,"_self")}static \u0275fac=function(n){return new(n||r)(G(iee),G(iv))};static \u0275cmp=$e({type:r,selectors:[["app-settings"]],decls:17,vars:2,consts:()=>{let t,n,i;return t=$localize`User settings`,n=$localize`Theme`,i=$localize`Language`,[[1,"box"],[1,"title"],t,[1,"field"],["for","theme",1,"label"],n,[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],i,["id","language",3,"change"],[3,"value","selected"]]},template:function(n,i){1&n&&(M(0,"div",0)(1,"p",1),ae(2,2),P(),M(3,"div",3)(4,"label",4),ae(5,5),P(),M(6,"div",6)(7,"div",7)(8,"select",8),W("change",function(s){return i.changeTheme(s)}),z(9,e_t,2,3,"option",9),P()()()(),M(10,"div",3)(11,"label",10),ae(12,11),P(),M(13,"div",6)(14,"div",7)(15,"select",12),W("change",function(s){return i.changeLanguage(s)}),z(16,t_t,2,3,"option",9),P()()()()()),2&n&&(m(9),v("ngForOf",i.availableThemes),m(7),v("ngForOf",i.availableLanguages))},dependencies:[Nt,A8,b8],encapsulation:2})}return r})(),r_t=(()=>{class r{route;router;connectedUserService;currentGameService;messageDisplayer;gameService;constructor(t,n,i,o,s,a){this.route=t,this.router=n,this.connectedUserService=i,this.currentGameService=o,this.messageDisplayer=s,this.gameService=a}ngOnInit(){var t=this;return E(function*(){yield t.createGameAndRedirectOrShowError(t.extractGameFromURL())})()}extractGameFromURL(){return L.getNonNullable(this.route.snapshot.paramMap.get("compo"))}createGameAndRedirectOrShowError(t){var n=this;return E(function*(){if(hn(n.connectedUserService.user.get().isConnected(),"User must be connected and have a username to reach this page"),!1===n.gameExists(t))return yield n.router.navigate(["/notFound",Vd.NO_MATCHING_GAME(t)],{skipLocationChange:!0}),!1;const o=n.currentGameService.canUserCreate();if(o.isSuccess()){const s=yield n.gameService.createPartConfigRoomAndChat(t);return yield n.router.navigate(["/play",t,s]),!0}return n.messageDisplayer.infoMessage(o.getReason()),yield n.router.navigate(["/lobby"]),!1})()}gameExists(t){return h.ofNullable(Vt.ALL_GAMES().find(i=>i.urlName===t)).isPresent()}static \u0275fac=function(n){return new(n||r)(G(uo),G(Xn),G(hr),G(qo),G(Ut),G(Su))};static \u0275cmp=$e({type:r,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:()=>{let t;return t=$localize`Creating online game, please wait, it should not take long.`,[t]},template:function(n,i){1&n&&(M(0,"p"),ae(1,0),P())},encapsulation:2})}return r})();const i_t=["app-hive-piece",""];function o_t(r,e){1&r&&(N(),V(0,"path",10))}function s_t(r,e){1&r&&(N(),V(0,"path",11))}function a_t(r,e){1&r&&(N(),V(0,"path",12))}function c_t(r,e){1&r&&(N(),V(0,"path",13))}function l_t(r,e){1&r&&(N(),V(0,"path",14))}let u_t=(()=>{class r extends ud{piece;x;y;hexaLayout;layer;pieceHeight;hexaPoints="";pieceClass="";isoPointsLight="";isoPointsDark="";isoPointsStroke="";layerTransform="";hexaCenter=new _(0,0);ngAfterContentChecked(){const t=new _(this.x,this.y);this.pieceClass=this.getPlayerClass(this.piece.owner),this.hexaPoints=this.hexaLayout.getHexaPoints(),this.hexaCenter=new _(0,0);const i=this.hexaLayout.getIsoPoints(t,this.pieceHeight).map(o=>o.map(s=>s.toSVGPoint()).join(" "));this.isoPointsLight=i[0],this.isoPointsDark=i[1],this.isoPointsStroke=i[2],this.layerTransform=`translate(0 -${(this.layer+1)*this.pieceHeight})`}static \u0275fac=(()=>{let t;return function(i){return(t||(t=z1(r)))(i||r)}})();static \u0275cmp=$e({type:r,selectors:[["","app-hive-piece",""]],inputs:{piece:"piece",x:"x",y:"y",hexaLayout:"hexaLayout",layer:"layer",pieceHeight:"pieceHeight"},features:[We],attrs:i_t,decls:12,vars:14,consts:[["transform","translate(-60 0)"],[1,"hive_isoPointsLight","base","no-stroke","lighter",3,"ngClass"],[1,"hive_isoPointsDark","base","no-stroke","darker",3,"ngClass"],[1,"hive_isoPointsStroke","base","no-fill","small-stroke"],[1,"hive_hexaPoints","base","small-stroke",3,"ngClass"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z",4,"ngIf"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z",4,"ngIf"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z",4,"ngIf"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z",4,"ngIf"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z",4,"ngIf"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z"]],template:function(n,i){1&n&&(N(),M(0,"g")(1,"g",0),V(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),P(),V(5,"polygon",4),M(6,"g"),z(7,o_t,1,0,"path",5)(8,s_t,1,0,"path",6)(9,a_t,1,0,"path",7)(10,c_t,1,0,"path",8)(11,l_t,1,0,"path",9),P()()),2&n&&(w("transform",i.layerTransform),m(2),v("ngClass",i.pieceClass),w("points",i.isoPointsLight),m(),v("ngClass",i.pieceClass),w("points",i.isoPointsDark),m(),w("points",i.isoPointsStroke),m(),v("ngClass",i.pieceClass),w("points",i.hexaPoints),m(),w("transform","translate("+i.hexaCenter.x+" "+i.hexaCenter.y+")"),m(),v("ngIf","QueenBee"===i.piece.kind),m(),v("ngIf","Beetle"===i.piece.kind),m(),v("ngIf","Grasshopper"===i.piece.kind),m(),v("ngIf","Spider"===i.piece.kind),m(),v("ngIf","SoldierAnt"===i.piece.kind))},dependencies:[zt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const f_t=["app-lodestone-lodestone",""];function d_t(r,e){if(1&r&&(N(),V(0,"polygon",4)),2&r){const t=e.$implicit,n=p();Ag("id","lodestone_",n.lodestoneInfo.direction,"_",n.lodestoneInfo.orientation,"_",n.lodestoneInfo.owner.toString(),"_arrow_",t,""),v("ngClass",n.lodestoneInfo.movingClass),w("points","push"===n.lodestoneInfo.direction?n.TRIANGLE_OUT:n.TRIANGLE_IN)("transform",n.getArrowRotate(t))}}const h_t=()=>[0,1,2,3];let g_t=(()=>{class r extends ud{lodestoneInfo;PIECE_RADIUS;TRIANGLE_OUT;TRIANGLE_IN;constructor(){super(),this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH);const t=.8*this.PIECE_RADIUS,n=.3*this.PIECE_RADIUS,i=.2*this.PIECE_RADIUS;this.TRIANGLE_OUT=`${t},0 ${n},${i} ${n},-${i}`,this.TRIANGLE_IN=`${n},0 ${t},${n} ${t},-${n}`}getArrowRotate(t){let n=90*t;return"diagonal"===this.lodestoneInfo.orientation&&(n+=45),"rotate("+n+")"}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=$e({type:r,selectors:[["","app-lodestone-lodestone",""]],inputs:{lodestoneInfo:"lodestoneInfo"},features:[We],attrs:f_t,decls:4,vars:10,consts:[[1,"lodestone_wrapper"],["cx","0","cy","0",1,"lodestone_main_circle","base","black-fill",3,"id","ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","no-stroke",3,"id","ngClass"]],template:function(n,i){1&n&&(N(),M(0,"g",0),V(1,"circle",1)(2,"circle",2),z(3,d_t,1,7,"polygon",3),P()),2&n&&(w("transform",i.getSVGTranslation(i.SPACE_SIZE/2,i.SPACE_SIZE/2)),m(),Hr("id","lodestone_",i.lodestoneInfo.direction,"_",i.lodestoneInfo.orientation,"_",i.lodestoneInfo.owner.toString(),""),v("ngClass",i.lodestoneInfo.selectedClass),w("r",i.PIECE_RADIUS),m(),v("ngClass",i.getPlayerClass(i.lodestoneInfo.owner)),w("r",i.PIECE_RADIUS/4),m(),v("ngForOf",ur(9,h_t)))},dependencies:[zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const p_t=["app-martian-chess-queen",""];function m_t(r,e){if(1&r&&(N(),V(0,"polygon",4)),2&r){const t=p();v("id",t.mainShapeId)("ngClass",t.pieceClasses),w("points",t.MartianChessQueenComponent.HEPTAGON)}}function __t(r,e){if(1&r&&(N(),V(0,"polygon",4)),2&r){const t=p();v("id",t.mainShapeId)("ngClass",t.pieceClasses),w("points",t.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function C_t(r,e){if(1&r&&(N(),V(0,"circle",5)),2&r){const t=p();v("id",t.mainShapeId)("ngClass",t.pieceClasses),w("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function v_t(r,e){if(1&r&&(jt(0),N(),V(1,"circle",6)(2,"circle",6)(3,"circle",6),Zt()),2&r){const t=p();m(),w("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(3)),m(),w("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(2)),m(),w("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(1))}}function y_t(r,e){if(1&r&&(N(),M(0,"g"),V(1,"circle",7)(2,"circle",7)(3,"circle",7),P()),2&r){const t=p();m(),w("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.45*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),m(),w("cx",.45*t.MartianChessComponent.SPACE_SIZE)("cy",.55*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),m(),w("cx",.55*t.MartianChessComponent.SPACE_SIZE)("cy",.55*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function M_t(r,e){if(1&r&&(N(),M(0,"g",8),V(1,"circle",9)(2,"circle",9)(3,"circle",9),P()),2&r){const t=p();v("ngClass",t.pieceClasses),m(),w("cx",.5*t.MartianChessComponent.SPACE_SIZE-3*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),m(),w("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),m(),w("cx",.5*t.MartianChessComponent.SPACE_SIZE+3*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}class Fd{mainShapeId;pieceClasses;style;static HEPTAGON=Po.getRegularPolygon(7);static EIGHT_POINTED_STAR=Po.getNPointedStar(8,0);MartianChessQueenComponent=Fd;MartianChessComponent=Po;horizontalDotsRadius=Po.SPACE_SIZE/15;static \u0275fac=function(t){return new(t||Fd)};static \u0275cmp=$e({type:Fd,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:p_t,decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(t,n){1&t&&z(0,m_t,1,3,"polygon",0)(1,__t,1,3,"polygon",0)(2,C_t,1,5,"circle",1)(3,v_t,4,9,"ng-container",2)(4,y_t,4,9,"g",2)(5,M_t,4,10,"g",3),2&t&&(v("ngIf","Polygon"===n.style.shape),m(),v("ngIf","Star"===n.style.shape),m(),v("ngIf","Circle"===n.style.shape),m(),v("ngIf","Concentric Circles"===n.style.points),m(),v("ngIf","Dots"===n.style.points),m(),v("ngIf","Horizontal Points"===n.style.points))},dependencies:[zt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}const E_t=["app-martian-chess-drone",""];function P_t(r,e){if(1&r&&(N(),V(0,"polygon",4)),2&r){const t=p();v("id",t.mainShapeId)("ngClass",t.pieceClasses),w("points",t.MartianChessDroneComponent.PENTAGON)}}function S_t(r,e){if(1&r&&(N(),V(0,"polygon",4)),2&r){const t=p();v("id",t.mainShapeId)("ngClass",t.pieceClasses),w("points",t.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function O_t(r,e){if(1&r&&(N(),V(0,"circle",5)),2&r){const t=p();v("id",t.mainShapeId)("ngClass",t.pieceClasses),w("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function T_t(r,e){if(1&r&&(jt(0),N(),V(1,"circle",6)(2,"circle",6),Zt()),2&r){const t=p();m(),w("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(2)),m(),w("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(1))}}function A_t(r,e){if(1&r&&(N(),M(0,"g",7),V(1,"circle",8)(2,"circle",8),P()),2&r){const t=p();v("ngClass",t.pieceClasses),m(),w("cx",.4*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),m(),w("cx",.6*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function b_t(r,e){if(1&r&&(N(),M(0,"g",7),V(1,"circle",9)(2,"circle",9),P()),2&r){const t=p();v("ngClass",t.pieceClasses),m(),w("cx",.5*t.MartianChessComponent.SPACE_SIZE-2*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),m(),w("cx",.5*t.MartianChessComponent.SPACE_SIZE+2*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}class Ud{mainShapeId;pieceClasses;style;MartianChessComponent=Po;MartianChessDroneComponent=Ud;static FOUR_POINTED_STAR_VERTICAL=Po.getNPointedStar(4,0);static PENTAGON=Po.getRegularPolygon(5);horizontalDotsRadius=Po.SPACE_SIZE/15;static \u0275fac=function(t){return new(t||Ud)};static \u0275cmp=$e({type:Ud,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:E_t,decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(t,n){1&t&&z(0,P_t,1,3,"polygon",0)(1,S_t,1,3,"polygon",0)(2,O_t,1,5,"circle",1)(3,T_t,3,6,"ng-container",2)(4,A_t,3,7,"g",3)(5,b_t,3,7,"g",3),2&t&&(v("ngIf","Polygon"===n.style.shape),m(),v("ngIf","Star"===n.style.shape),m(),v("ngIf","Circle"===n.style.shape),m(),v("ngIf","Concentric Circles"===n.style.points),m(),v("ngIf","Dots"===n.style.points),m(),v("ngIf","Horizontal Points"===n.style.points))},dependencies:[zt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}const w_t=["app-martian-chess-pawn",""];function N_t(r,e){if(1&r&&(N(),V(0,"polygon",5)),2&r){const t=p();v("id",t.mainShapeId)("ngClass",t.pieceClasses),w("points",t.MartianChessPawnComponent.TRIANGLE)}}function I_t(r,e){if(1&r&&(N(),V(0,"polygon",5)),2&r){const t=p();v("id",t.mainShapeId)("ngClass",t.pieceClasses),w("points",t.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function k_t(r,e){if(1&r&&(N(),V(0,"circle",6)),2&r){const t=p();v("id",t.mainShapeId)("ngClass",t.pieceClasses),w("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function R_t(r,e){if(1&r&&(N(),V(0,"circle",7)),2&r){const t=p();w("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE+t.getConcreteTriangleYOffset())("r",t.MartianChessComponent.getRadius(1))}}function x_t(r,e){if(1&r&&(N(),V(0,"circle",8)),2&r){const t=p();w("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function L_t(r,e){if(1&r&&(N(),M(0,"g",9),V(1,"circle",10),P()),2&r){const t=p();v("ngClass",t.pieceClasses),m(),w("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}class p4{mainShapeId;pieceClasses;style;static FOUR_POINTED_STAR_DIAGONAL=Po.getNPointedStar(4,45);static TRIANGLE_Y_OFFSET=p4.yOffsetForVerticalCentering();static TRIANGLE=p4.getTriangle();MartianChessComponent=Po;MartianChessPawnComponent=p4;horizontalDotsRadius=Po.SPACE_SIZE/15;static getTriangle(){return Po.getRegularPolygon(3,p4.TRIANGLE_Y_OFFSET)}static yOffsetForVerticalCentering(){const t=Po.getRegularPolygonCoords(3).map(c=>c.y);return(t.reduce((c,l)=>Math.min(c,l))+(100-t.reduce((c,l)=>Math.max(c,l))))/4}getConcreteTriangleYOffset(){return"Polygon"===this.style.shape?p4.TRIANGLE_Y_OFFSET:0}static \u0275fac=function(t){return new(t||p4)};static \u0275cmp=$e({type:p4,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:w_t,decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(t,n){1&t&&z(0,N_t,1,3,"polygon",0)(1,I_t,1,3,"polygon",0)(2,k_t,1,5,"circle",1)(3,R_t,1,3,"circle",2)(4,x_t,1,3,"circle",3)(5,L_t,2,4,"g",4),2&t&&(v("ngIf","Polygon"===n.style.shape),m(),v("ngIf","Star"===n.style.shape),m(),v("ngIf","Circle"===n.style.shape),m(),v("ngIf","Concentric Circles"===n.style.points),m(),v("ngIf","Dots"===n.style.points),m(),v("ngIf","Horizontal Points"===n.style.points))},dependencies:[zt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}const z_t=["app-siam-orientation-arrow",""];function D_t(r,e){if(1&r){const t=de();N(),M(0,"use",2),W("click",function(){const o=te(t).$implicit;return ne(p().selectMove(o))}),P()}if(2&r){const t=e.$implicit,n=p();En("id","orientation_",t.landingOrientation,""),v("ngClass",n.getCurrentPlayerClass()),w("transform",n.getOrientationTransform(t.landingOrientation))}}let V_t=(()=>{class r extends ud{orientations;currentPlayer;config;moveEmitter=new l1;getCurrentPlayerClass(){return this.getPlayerClass(this.currentPlayer)}getOrientationTransform(t){const n=this.config,i=Math.min(n.width,n.height)/5,s=this.SPACE_SIZE/40*i,a=.5*s;let c=new _(n.width/2,n.height/2);c=c.getNext(me.LEFT,a),c=c.getNext(me.UP,a),c=c.getNext(t,s-i),c=c.scale(this.SPACE_SIZE,this.SPACE_SIZE);const l=90*(t.toInt()-2);return[`translate(${c.x}, ${c.y})`,`scale(${s})`,`rotate(${l} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`].join(" ")}selectMove(t){this.moveEmitter.emit(t)}static \u0275fac=(()=>{let t;return function(i){return(t||(t=z1(r)))(i||r)}})();static \u0275cmp=$e({type:r,selectors:[["","app-siam-orientation-arrow",""]],inputs:{orientations:"orientations",currentPlayer:"currentPlayer",config:"config"},outputs:{moveEmitter:"moveEmitter"},features:[We],attrs:z_t,decls:3,vars:1,consts:[["id","arrow","points","30 10, 30 50, 10 50, 50 90, 90 50, 70 50, 70 10"],["class","base mid-stroke semi-transparent",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke","semi-transparent",3,"id","ngClass","click"]],template:function(n,i){1&n&&(N(),M(0,"defs"),V(1,"polygon",0),P(),z(2,D_t,1,3,"use",1)),2&n&&(m(2),v("ngForOf",i.orientations))},dependencies:[zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();const H_t=["mgp-trexo-half-piece",""];function F_t(r,e){if(1&r&&(N(),V(0,"text",8)),2&r){const t=p();Hr("id","height_",t.coord.x,"_",t.coord.y,"_",t.coord.z,""),v("innerHTML",t.coord.z,r7)}}function U_t(r,e){if(1&r&&(N(),V(0,"polyline",9)),2&r){const t=p();v("ngClass",t.pieceClasses),w("points",t.getUpperHorizontalLine())}}function $_t(r,e){if(1&r&&(N(),M(0,"g"),V(1,"polyline",10)(2,"polyline",11),P()),2&r){const t=p();m(),v("ngClass",t.pieceClasses),w("points",t.getMiddleHorizontalLine()),m(),v("ngClass",t.pieceClasses),w("points",t.getLowerHorizontalLine())}}function G_t(r,e){if(1&r&&(N(),V(0,"polyline",12)),2&r){const t=p();v("ngClass",t.pieceClasses),w("points",t.getLeftDiagonalLine())}}function B_t(r,e){if(1&r&&(N(),M(0,"g"),V(1,"polyline",13)(2,"polyline",14),P()),2&r){const t=p();m(),v("ngClass",t.pieceClasses),w("points",t.getMiddleDiagonalLine()),m(),v("ngClass",t.pieceClasses),w("points",t.getRighterDiagonalLine())}}function W_t(r,e){if(1&r&&(N(),V(0,"polyline",15)),2&r){const t=p();v("ngClass",t.pieceClasses),w("points",t.getLeftVerticalLine())}}function q_t(r,e){if(1&r&&(N(),V(0,"polyline",16)),2&r){const t=p();v("ngClass",t.pieceClasses),w("points",t.getMiddleVerticalLine())}}function j_t(r,e){if(1&r&&(N(),V(0,"polyline",17)),2&r){const t=p();v("ngClass",t.pieceClasses),w("points",t.getRighterVerticalLine())}}class Pv{coord;move;pieceClasses;mode;mustDisplayHeight;static STROKE_OFFSET=s1.STROKE_WIDTH/2;mustForceStrokeDisplay(){return void 0===this.move||this.pieceClasses.some(e=>"victory-stroke"===e)||this.pieceClasses.some(e=>"last-move-stroke"===e)}get3DIsoSquarePoints(){const e=this.getParallelogramPoints();return this.mapCoordToPoints([e[0],e[1],e[4],e[6],e[5],e[2],e[0]])}getParallelogramPoints(){const e=this.mode.parallelogramHeight*this.mode.horizontalWidthRatio,t=this.mode.parallelogramHeight,n=this.mode.offsetRatio*this.mode.parallelogramHeight,i=this.mode.parallelogramHeight*this.mode.pieceHeightRatio,o=e,a=e-n,c=t,l=-n,u=t;return[new _(0,0),new _(o,0),new _(l,u),new _(a,c),new _(o,0+i),new _(l,u+i),new _(a,c+i)]}mapCoordToPoints(e){return e.map(t=>t.x+" "+t.y).join(" ")}getUpperHorizontalLineCoords(){const e=this.getParallelogramPoints(),t=e[0],n=e[1],o=new $t(-1*this.mode.offsetRatio*s1.STROKE_WIDTH,s1.STROKE_WIDTH),s=t.getNext(o),a=n.getNext(o);return[t,n,a,s]}getUpperHorizontalLine(){const e=this.getUpperHorizontalLineCoords();return this.mapCoordToPoints(e)}getMiddleHorizontalCoords(){const e=this.getParallelogramPoints(),t=e[2],n=e[3],o=new $t(-1*this.mode.offsetRatio*s1.STROKE_WIDTH,s1.STROKE_WIDTH);return[t.getNext(o,-1),n.getNext(o,-1),n,t]}getMiddleHorizontalLine(){const e=this.getMiddleHorizontalCoords();return this.mapCoordToPoints(e)}getLowerHorizontalLine(){const e=this.getParallelogramPoints(),t=e[5],n=e[6],i=new $t(0,s1.STROKE_WIDTH),o=t.getNext(i,-1),s=n.getNext(i,-1);return this.mapCoordToPoints([o,s,n,t])}getLeftDiagonalLine(){const e=this.getParallelogramPoints(),t=e[0],n=e[2],o=new $t(s1.STROKE_WIDTH,0),s=t.getNext(o,1),a=n.getNext(o,1);return this.mapCoordToPoints([t,s,a,n])}getMiddleDiagonalLine(){const e=this.getParallelogramPoints(),t=e[1],n=e[3],o=new $t(s1.STROKE_WIDTH,0),s=t.getNext(o,-1),a=n.getNext(o,-1);return this.mapCoordToPoints([s,t,n,a])}getRighterDiagonalLine(){const e=this.getParallelogramPoints(),t=e[4],n=e[6],o=new $t(0,s1.STROKE_WIDTH),s=t.getNext(o,-1),a=n.getNext(o,-1);return this.mapCoordToPoints([s,t,n,a])}getLeftVerticalLine(){const e=this.getParallelogramPoints(),t=e[2],n=e[5],o=new $t(s1.STROKE_WIDTH,0),s=t.getNext(o,1),a=n.getNext(o,1);return this.mapCoordToPoints([t,s,a,n])}getMiddleVerticalLine(){const e=this.getParallelogramPoints(),t=e[3],n=e[6],o=new $t(s1.STROKE_WIDTH,0),s=t.getNext(o,-1),a=n.getNext(o,-1);return this.mapCoordToPoints([s,t,n,a])}getRighterVerticalLine(){const e=this.getParallelogramPoints(),t=e[1],n=e[4],s=new $t(s1.STROKE_WIDTH,-s1.STROKE_WIDTH/this.mode.offsetRatio),a=t.getNext(s,-1),c=n.getNext(s,-1);return this.mapCoordToPoints([a,t,n,c])}getOtherCoord(){hn(null!=this.move,"Move should be set before calling getOtherCoord");const e=this.move;return e.getZero().equals(this.coord)?e.getOne():e.getZero()}isLeftHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.x===e.x-1}}isRightHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.x===e.x+1}}isTopHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.y===e.y-1}}isBottomHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.y===e.y+1}}static \u0275fac=function(t){return new(t||Pv)};static \u0275cmp=$e({type:Pv,selectors:[["","mgp-trexo-half-piece",""]],inputs:{coord:"coord",move:"move",pieceClasses:"pieceClasses",mode:"mode",mustDisplayHeight:"mustDisplayHeight"},attrs:H_t,decls:9,vars:13,consts:[[3,"id","ngClass"],["x","50","y","66","class","text-big text-center",3,"id","innerHTML",4,"ngIf"],["id","line_0_to_1","class","base manual-stroke",3,"ngClass",4,"ngIf"],[4,"ngIf"],["id","line_0_to_2","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_2_to_5","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_3_to_6","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_1_to_4","class","base manual-stroke",3,"ngClass",4,"ngIf"],["x","50","y","66",1,"text-big","text-center",3,"id","innerHTML"],["id","line_0_to_1",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_5_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_0_to_2",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_4_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_5",1,"base","manual-stroke",3,"ngClass"],["id","line_3_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_4",1,"base","manual-stroke",3,"ngClass"]],template:function(t,n){1&t&&(N(),V(0,"polyline",0),z(1,F_t,1,4,"text",1)(2,U_t,1,2,"polyline",2)(3,$_t,3,4,"g",3)(4,G_t,1,2,"polyline",4)(5,B_t,3,4,"g",3)(6,W_t,1,2,"polyline",5)(7,q_t,1,2,"polyline",6)(8,j_t,1,2,"polyline",7)),2&t&&(Hr("id","tile_",n.coord.x,"_",n.coord.y,"_",n.coord.z,""),v("ngClass",n.pieceClasses),w("points",n.get3DIsoSquarePoints()),m(),v("ngIf",n.mustDisplayHeight),m(),v("ngIf",!1===n.isBottomHalf()||n.mustForceStrokeDisplay()),m(),v("ngIf",!1===n.isTopHalf()||n.mustForceStrokeDisplay()),m(),v("ngIf",!1===n.isRightHalf()||n.mustForceStrokeDisplay()),m(),v("ngIf",!1===n.isLeftHalf()||n.mustForceStrokeDisplay()),m(),v("ngIf",n.isBottomHalf()||n.isLeftHalf()||n.mustForceStrokeDisplay()),m(),v("ngIf",n.isBottomHalf()||n.isRightHalf()||n.mustForceStrokeDisplay()),m(),v("ngIf",n.isTopHalf()||n.isRightHalf()||n.mustForceStrokeDisplay()))},dependencies:[zt,Tt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}const $d_firebaseConfig={apiKey:"AIzaSyAt5QHXLnm2Uf9X7VN6XPPiSaipoh3oRHo",authDomain:"firestore-c9d47.firebaseapp.com",databaseURL:"https://firestore-c9d47.firebaseio.com",projectId:"firestore-c9d47",storageBucket:"firestore-c9d47.appspot.com",messagingSenderId:"936588361631",appId:"1:936588361631:web:2c059886d8d427edbac7aa"};let fR=(()=>{class r{connectedUserService;userSubscription;constructor(t){this.connectedUserService=t}canActivate(){var t=this;return E(function*(){const n=yield new Promise(i=>{t.userSubscription=t.connectedUserService.subscribeToUser(function(){var o=E(function*(s){return i(yield t.evaluateUserPermission(s))});return function(s){return o.apply(this,arguments)}}())});return t.userSubscription.unsubscribe(),n})()}static \u0275fac=function(n){return new(n||r)(Ae(hr))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Ou=(()=>{class r extends fR{router;static evaluateUserPermission(t,n){return E(function*(){return!1===n.isConnected()?t.parseUrl("/login"):!1!==n.verified||t.parseUrl("/verify-account")})()}constructor(t,n){super(t),this.router=n}evaluateUserPermission(t){var n=this;return E(function*(){return r.evaluateUserPermission(n.router,t)})()}static \u0275fac=function(n){return new(n||r)(Ae(hr),Ae(Xn))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),dR=(()=>{class r{currentGameService;router;currentGameSubscription=h.empty();constructor(t,n){this.currentGameService=t,this.router=n}canActivate(t){var n=this;return E(function*(){const i=yield n.currentGameService.getCurrentGame();if(i.isAbsent())return!0;const o=i.get();return t.params.id===o.id||n.router.parseUrl("/play/"+o.typeGame+"/"+o.id)})()}static \u0275fac=function(n){return new(n||r)(Ae(qo),Ae(Xn))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Z_t=(()=>{class r extends fR{router;constructor(t,n){super(t),this.router=n}evaluateUserPermission(t){var n=this;return E(function*(){return!1===t.isConnected()?n.router.parseUrl("/login"):!t.verified||n.router.parseUrl("/")})()}static \u0275fac=function(n){return new(n||r)(Ae(hr),Ae(Xn))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Y_t=(()=>{class r extends fR{router;constructor(t,n){super(t),this.router=n}evaluateUserPermission(t){var n=this;return E(function*(){return!1===t.isConnected()||n.router.parseUrl("/")})()}static \u0275fac=function(n){return new(n||r)(Ae(hr),Ae(Xn))};static \u0275prov=xe({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();const K_t=["app-blank-goban",""];function X_t(r,e){if(1&r&&(N(),V(0,"circle",8)),2&r){const t=e.$implicit,n=p(3);Ce("id","hoshi_",t.x,"_",t.y,""),w("cx",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.x)("cy",.5*n.SPACE_SIZE+n.SPACE_SIZE*t.y)("r",.2*n.SPACE_SIZE)}}function Q_t(r,e){if(1&r){const t=de();N(),M(0,"g",4),W("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),V(1,"rect",5)(2,"line",6)(3,"line",6)(4,"g")(5,"g"),z(6,X_t,1,5,"circle",7),V(7,"g"),P()}if(2&r){const t=e.index,n=p().index,i=p();Ce("id","click_",t,"_",n,""),m(),w("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)("x",i.SPACE_SIZE*t)("y",i.SPACE_SIZE*n),m(),w("x1",i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE+i.SPACE_SIZE*n)("x2",i.SPACE_SIZE+i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+i.SPACE_SIZE*n),m(),w("x1",.5*i.SPACE_SIZE+i.SPACE_SIZE*t)("y1",i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+i.SPACE_SIZE*t)("y2",i.SPACE_SIZE+i.SPACE_SIZE*n),m(3),v("ngForOf",i.hoshis)}}function J_t(r,e){if(1&r&&(N(),M(0,"g"),z(1,Q_t,8,15,"g",3),P()),2&r){const t=p();m(),v("ngForOf",t.ArrayUtils.range(t.width))}}let hR=(()=>{class r extends ud{width;height;clickCallBack=new l1;hoshis=[];ngOnChanges(){return this.createHoshis()}onClick(t,n){return this.clickCallBack.emit(new _(t,n))}createHoshis(){this.hoshis=E2.getHoshis(this.width,this.height)}static \u0275fac=(()=>{let t;return function(i){return(t||(t=z1(r)))(i||r)}})();static \u0275cmp=$e({type:r,selectors:[["","app-blank-goban",""]],inputs:{width:"width",height:"height"},outputs:{clickCallBack:"clickCallBack"},features:[We,c2],attrs:K_t,decls:3,vars:3,consts:[["id","blank_board"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["fill-opacity","0",1,"base","no-stroke"],[1,"base"],["class","base-no-stroke click-delegator",3,"id",4,"ngFor","ngForOf"],[1,"base-no-stroke","click-delegator",3,"id"]],template:function(n,i){1&n&&(N(),M(0,"g",0),V(1,"rect",1),z(2,J_t,2,1,"g",2),P()),2&n&&(m(),w("width",i.width*i.SPACE_SIZE)("height",i.height*i.SPACE_SIZE),m(),v("ngForOf",i.ArrayUtils.range(i.height)))},dependencies:[Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.big-stroke[_ngcontent-%COMP%]{stroke-width:12}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.defeat-fill[_ngcontent-%COMP%]{fill:var(--defeat)}.defeat-stroke[_ngcontent-%COMP%]{stroke:var(--defeat)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})}return r})();!function Rfe(r,e,t){(function l8e(r,e,t){"string"!=typeof e&&(t=e,e=r[D1.LocaleId]),e=e.toLowerCase().replace(/_/g,"-"),_8[e]=r,t&&(_8[e][D1.ExtraData]=t)})(r,e,t)}(xwe);const eCt=[{path:"login",component:Ogt},{path:"lobby",component:iR,canActivate:[Ou]},{path:"account",component:Bgt,canActivate:[Ou]},{path:"settings",component:n_t},{path:"register",component:Vmt,canActivate:[Y_t]},{path:"reset-password",component:Jmt},{path:"notFound/:message",component:Ese},{path:"nextGameLoading",component:Umt,canActivate:[Ou]},{path:"verify-account",component:Ymt,canActivate:[Z_t]},{path:"play",component:Mse,canActivate:[Ou,dR]},{path:"play/:compo",component:r_t,canActivate:[Ou,dR]},{path:"play/:compo/:id",component:cR,canActivate:[Ou,dR]},{path:"local",component:Hmt},{path:"local/:compo",component:uR},{path:"tutorial",component:Fmt},{path:"tutorial/:compo",component:nR},{path:"",component:Xht},{path:"demo",component:Mgt},{path:"**",component:Ese}];class gR{static app(){return function Jye(r,...e){return{ngModule:Qye,providers:[{provide:TO,useFactory:Xye(r),multi:!0,deps:[bn,Li,SO,...e]}]}}(()=>eMe($d_firebaseConfig))}static firestore(){return function ywe(r,...e){return{ngModule:vwe,providers:[{provide:zN,useFactory:mwe(r),multi:!0,deps:[bn,Li,SO,OO,[new Jo,Fq],[new Jo,wW],...e]}]}}(()=>{const e=Awe();e.toJSON();return e})}static auth(){return function cSe(r,...e){return{ngModule:aSe,providers:[{provide:zA,useFactory:iSe(r),multi:!0,deps:[bn,Li,SO,OO,[new Jo,wW],...e]}]}}(()=>{const e=fSe();return e})}}let tCt=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275mod=N2({type:r,bootstrap:[jht]});static \u0275inj=s2({providers:[hr,Su,pI,Id,K5,Y5,iv,{provide:Cc,useValue:kd.getLocale()}],imports:[gR.app(),gR.firestore(),gR.auth(),IU,Ege,Jme.forRoot(eCt,{useHash:!1}),qhe,Whe,JCe,TIe]})}return r})();T3(GQ,function(){return[zt,Nt,Tt,hR]},[]),T3(AC,function(){return[zt,Nt,Tt,hR]},[]),T3(_J,function(){return[zt,Nt,Tt,u_t]},[]),T3(sa,function(){return[zt,Nt,Tt,g_t]},[]),T3(Po,function(){return[zt,Nt,Tt,Fd,Ud,p4]},[]),T3(IJ,function(){return[zt,Nt,Tt,hR]},[]),T3(ev,function(){return[zt,Nt,Tt,V_t]},[]),T3(s1,function(){return[zt,Nt,Tt,Pv]},[]);var nCt=Ns(522);function Tse(){ide().bootstrapModule(tCt).catch(r=>console.error(r))}const Ase=kd.getLocale();"en"!==Ase?fetch("/assets/"+Ase+".json").then(r=>r.ok?r.json():{locale:"en",translations:{}}).then(r=>{(0,nCt.XJ)(r.translations),$localize.locale=r.locale,Tse()}).catch(function(r){console.log(r)}):Tse()},1:function(Au,y0){!function(Ns){"use strict";function ma(St,at){var Gt=Object.keys(St);if(Object.getOwnPropertySymbols){var An=Object.getOwnPropertySymbols(St);at&&(An=An.filter(function(N1){return Object.getOwnPropertyDescriptor(St,N1).enumerable})),Gt.push.apply(Gt,An)}return Gt}function m1(St){for(var at,Gt=1;Gt<arguments.length;Gt++)at=null==arguments[Gt]?{}:arguments[Gt],Gt%2?ma(Object(at),!0).forEach(function(An){j1(St,An,at[An])}):Object.getOwnPropertyDescriptors?Object.defineProperties(St,Object.getOwnPropertyDescriptors(at)):ma(Object(at)).forEach(function(An){Object.defineProperty(St,An,Object.getOwnPropertyDescriptor(at,An))});return St}function _a(St,at){if(!(St instanceof at))throw new TypeError("Cannot call a class as a function")}function d3(St,at){for(var Gt,An=0;An<at.length;An++)(Gt=at[An]).enumerable=Gt.enumerable||!1,Gt.configurable=!0,"value"in Gt&&(Gt.writable=!0),Object.defineProperty(St,Gt.key,Gt)}function jo(St,at,Gt){return at&&d3(St.prototype,at),Gt&&d3(St,Gt),St}function j1(St,at,Gt){return at in St?Object.defineProperty(St,at,{value:Gt,enumerable:!0,configurable:!0,writable:!0}):St[at]=Gt,St}function Hl(){var St;return null!==(St=Fl)&&void 0!==St?St:document}var h3={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},Is=m1({},h3),ks={},Fl=null,Ja=function(St,at,Gt,An,N1){return"top-left"===St?"left:".concat(An,";top:").concat(at,";text-align:left;align-items:flex-start;"):"top-right"===St?"right:".concat(N1,";top:").concat(at,";text-align:right;align-items:flex-end;"):"top-center"===St?"top:".concat(at,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===St?"left:".concat(An,";bottom:").concat(Gt,";text-align:left;align-items:flex-start;"):"bottom-right"===St?"right:".concat(N1,";bottom:").concat(Gt,";text-align:right;align-items:flex-end;"):"bottom-center"===St?"bottom:".concat(Gt,";left:0;right:0;text-align:center;align-items:center;"):"center"===St?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0},M0=function(){function St(at){var Gt=this;_a(this,St),this.element=Hl().createElement("div"),this.opacity=at.opacity,this.type=at.type,this.animate=at.animate,this.dismissible=at.dismissible,this.closeOnClick=at.closeOnClick,this.message=at.message,this.duration=at.duration,this.pauseOnHover=at.pauseOnHover,this.offsetTop=at.offsetTop,this.offsetBottom=at.offsetBottom,this.offsetLeft=at.offsetLeft,this.offsetRight=at.offsetRight,this.extraClasses=at.extraClasses;var An="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),N1=["notification",this.extraClasses];if(this.type&&N1.push(this.type),this.animate&&this.animate.in){var Rs="animate__".concat(this.animate.in),n2=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";N1.push("animate__animated ".concat(Rs," ").concat(n2)),this.onAnimationEnd(function(){return Gt.element.classList.remove(Rs)})}if(this.element.className=N1.join(" "),this.dismissible){var m4=Hl().createElement("button");m4.className="delete",m4.addEventListener("click",function(){Gt.destroy()}),this.element.insertAdjacentElement("afterbegin",m4)}else An+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){Gt.destroy()}),this.element.setAttribute("style",An),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var E0=new Ul(function(){Gt.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){E0.pause()}),this.element.addEventListener("mouseout",function(){E0.resume()}))}return jo(St,[{key:"destroy",value:function(){var at=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){at.removeParent(at.element.parentNode),at.element.remove()})):(this.removeParent(this.element.parentNode),this.element.remove())}},{key:"removeParent",value:function(at){at&&1>=at.children.length&&(at.remove(),delete ks.position)}},{key:"onAnimationEnd",value:function(){var at=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},Gt={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var An in Gt)if(void 0!==this.element.style[An]){this.element.addEventListener(Gt[An],function(){return at()});break}}}]),St}(),Ul=function(){function St(at,Gt){_a(this,St),this.remaining=Gt,this.callback=at,this.resume()}return jo(St,[{key:"pause",value:function(){typeof document>"u"||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){typeof document>"u"||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),St}();Ns.resetDefaults=function(){Is=m1({},h3)},Ns.setDefaults=function(St){Is=m1(m1({},h3),St)},Ns.setDoc=function jd(St){for(var at in ks)ks[at].remove();ks={},Fl=St},Ns.toast=function bu(St){if(!St.message)throw new Error("message is required");var at=m1(m1({},Is),St),Gt=new M0(at),An=function qd(St,at,Gt,An,N1,Rs){if(ks.position)return ks.position;var n2=Hl().createElement("div");return n2.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+Ja(at,Gt,An,N1,Rs)),St.appendChild(n2),ks.position=n2,n2}(at.appendTo||Hl().body,at.position||Is.position,at.offsetTop||Is.offsetTop,at.offsetBottom||Is.offsetBottom,at.offsetLeft||Is.offsetLeft,at.offsetRight||Is.offsetRight);if(at.single)for(var N1=An.lastElementChild;N1;)An.removeChild(N1),N1=An.lastElementChild;An.appendChild(Gt.element)},Object.defineProperty(Ns,"__esModule",{value:!0})}(y0)},522:(Au,y0,Ns)=>{"use strict";Ns.d(y0,{XJ:()=>Vv,pQ:()=>P0});const ma=":",m1="|",_a="@@",d3="\u241f";let jo;function Ul(re){jo??=new TextEncoder;const he=jo.encode(re),be=new DataView(he.buffer,he.byteOffset,he.byteLength);let De=at(be,he.length,0),Ue=at(be,he.length,102072);return 0==De&&(0==Ue||1==Ue)&&(De^=319790063,Ue^=-1801410264),BigInt.asUintN(32,BigInt(De))<<BigInt(32)|BigInt.asUintN(32,BigInt(Ue))}function at(re,he,be){let De=2654435769,Ue=2654435769,At=0;const r2=he-12;for(;At<=r2;At+=12){De+=re.getUint32(At,!0),Ue+=re.getUint32(At+4,!0);const qn=Gt(De,Ue,be+=re.getUint32(At+8,!0));De=qn[0],Ue=qn[1],be=qn[2]}const E1=he-At;return be+=he,E1>=4?(De+=re.getUint32(At,!0),At+=4,E1>=8?(Ue+=re.getUint32(At,!0),At+=4,E1>=9&&(be+=re.getUint8(At++)<<8),E1>=10&&(be+=re.getUint8(At++)<<16),11===E1&&(be+=re.getUint8(At++)<<24)):(E1>=5&&(Ue+=re.getUint8(At++)),E1>=6&&(Ue+=re.getUint8(At++)<<8),7===E1&&(Ue+=re.getUint8(At++)<<16))):(E1>=1&&(De+=re.getUint8(At++)),E1>=2&&(De+=re.getUint8(At++)<<8),3===E1&&(De+=re.getUint8(At++)<<16)),Gt(De,Ue,be)[2]}function Gt(re,he,be){return re-=he,re-=be,he-=be,he-=re^=be>>>13,be-=re,be-=he^=re<<8,re-=he,re-=be^=he>>>13,he-=be,he-=re^=be>>>12,be-=re,be-=he^=re<<16,re-=he,re-=be^=he>>>5,he-=be,he-=re^=be>>>3,be-=re,be-=he^=re<<10,[re,he,be^=he>>>15]}function AR(re,he,be,De,Ue=[]){const At={},r2={},E1={},qn=function Rv(re,he){const{text:be,block:De}=Lv(re,he);if(void 0===De)return{text:be};{const[Ue,...At]=De.split(d3),[r2,E1]=Ue.split(_a,2);let[qn,ei]=r2.split(m1,2);return void 0===ei&&(ei=qn,qn=void 0),""===ei&&(ei=void 0),{text:be,meaning:qn,description:ei,customId:E1,legacyIds:At}}}(re[0],re.raw[0]),ei=[qn.text],g3=[];let p3=qn.text;for(let Zo=1;Zo<re.length;Zo++){const{messagePart:_4,placeholderName:I1=Zd(Zo),associatedMessageId:ec}=xv(re[Zo],re.raw[Zo]);p3+=`{$${I1}}${_4}`,void 0!==he&&(At[I1]=he[Zo-1],r2[I1]=Ue[Zo-1]),g3.push(I1),void 0!==ec&&(E1[I1]=ec),ei.push(_4)}const S0=qn.customId||function St(re,he=""){let be=Ul(re);return he&&(be=BigInt.asUintN(64,be<<BigInt(1))|be>>BigInt(63)&BigInt(1),be+=Ul(he)),BigInt.asUintN(63,be).toString()}(p3,qn.meaning||""),Nu=qn.legacyIds?qn.legacyIds.filter(Zo=>Zo!==S0):[];return{id:S0,legacyIds:Nu,substitutions:At,substitutionLocations:r2,text:p3,customId:qn.customId,meaning:qn.meaning||"",description:qn.description||"",messageParts:ei,messagePartLocations:De,placeholderNames:g3,associatedMessageIds:E1,location:be}}function xv(re,he){const{text:be,block:De}=Lv(re,he);if(void 0===De)return{messagePart:be};{const[Ue,At]=De.split(_a);return{messagePart:be,placeholderName:Ue,associatedMessageId:At}}}function Lv(re,he){if(he.charAt(0)!==ma)return{text:re};{const be=wu(re,he);return{block:re.substring(1,be),text:re.substring(be+1)}}}function Zd(re){return 1===re?"PH":"PH_"+(re-1)}function wu(re,he){for(let be=1,De=1;be<re.length;be++,De++)if("\\"===he[De])De++;else if(re[be]===ma)return be;throw new Error(`Unterminated $localize metadata block in "${he}".`)}class zv extends Error{constructor(he){super(`No translation found for ${Dv(he)}.`),this.parsedMessage=he,this.type="MissingTranslationError"}}function Kd(re,he){return Object.defineProperty(re,"raw",{value:he}),re}function Dv(re){const he=re.meaning&&` - "${re.meaning}"`,be=re.legacyIds&&re.legacyIds.length>0?` [${re.legacyIds.map(De=>`"${De}"`).join(", ")}]`:"";return`"${re.id}"${be} ("${re.text}"${he})`}function Vv(re){$localize.translate||($localize.translate=IR),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(re).forEach(he=>{$localize.TRANSLATIONS[he]=function wR(re){const he=re.split(/{\$([^}]*)}/),be=[he[0]],De=[];for(let At=1;At<he.length-1;At+=2)De.push(he[At]),be.push(`${he[At+1]}`);const Ue=be.map(At=>At.charAt(0)===ma?"\\"+At:At);return{text:re,messageParts:Kd(be,Ue),placeholderNames:De}}(re[he])})}function IR(re,he){try{return function bR(re,he,be){const De=AR(he,be);let Ue=re[De.id];if(void 0!==De.legacyIds)for(let At=0;At<De.legacyIds.length&&void 0===Ue;At++)Ue=re[De.legacyIds[At]];if(void 0===Ue)throw new zv(De);return[Ue.messageParts,Ue.placeholderNames.map(At=>{if(De.substitutions.hasOwnProperty(At))return De.substitutions[At];throw new Error(`There is a placeholder name mismatch with the translation provided for the message ${Dv(De)}.\nThe translation contains a placeholder with name ${At}, which does not exist in the message.`)})]}($localize.TRANSLATIONS,re,he)}catch(be){return console.warn(be.message),[re,he]}}const P0=function(re,...he){if(P0.translate){const De=P0.translate(re,he);re=De[0],he=De[1]}let be=Fv(re[0],re.raw[0]);for(let De=1;De<re.length;De++)be+=he[De-1]+Fv(re[De],re.raw[De]);return be},Hv=":";function Fv(re,he){return he.charAt(0)===Hv?re.substring(wu(re,he)+1):re}}},Au=>{Au(Au.s=1584)}]);